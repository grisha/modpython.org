<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">

<!-- $Id: directives.html,v 1.8 2000/06/20 15:02:04 grisha Exp $ -->

<html>
  <head>
    <title>Python Functions and Objects and Apache Configuration Directives</title>
  </head>

  <body bgcolor=white>
    <h1>Apache Configuration Directives</h1>

    <hr>

    <ul>
      <li><a href="#PythonDebug">PythonDebug</a>
      <li><a href="#PythonImport">PythonImport</a>
      <li><a href="#PythonInterpPerDirectory">PythonInterpPerDirectory</a>
      <li><a href="#PythonInterpreter">PythonInterpreter</a>
      <li><a href="#PythonNoReload">PythonNoReload</a>
      <li><a href="#PythonOption">PythonOption</a>
      <li><a href="#PythonPath">PythonPath</a>
	<br><br>
      <a href="#Handlers">Handlers</a>
	<br><br>
      <li><a href="#HandlerSyntax">Python*Handler Syntax</a>
      <li><a href="#PythonPostReadRequestHandler">PythonPostReadRequestHandler</a>
      <li><a href="#PythonTransHandler">PythonTransHandler</a>
      <li><a href="#PythonHeaderParserHandler">PythonHeaderParserHandler</a>
      <li><a href="#PythonAccessHandler">PythonAccessHandler</a>
      <li><a href="#PythonAuthenHandler">PythonAuthenHAndler</a>
      <li><a href="#PythonAuthzHandlerPath">PythonAuthzHandler</a>
      <li><a href="#PythonTypeHandler">PythonTypeHandler</a>
      <li><a href="#PythonFixupHandler">PythonFixupHandler</a>
      <li><a href="#PythonHandler">PythonHandler</a>
      <li><a href="#PythonLogHandler">PythonLogHandler</a>
    </ul>
    <hr>
    <p>
<h2><a name="PythonDebug">PythonDebug</a></h2>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Syntax" rel="Help">
<strong>Syntax:</strong></a> PythonDebug {On, Off}<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Default" rel="Help">
<strong>Default:</strong></A> PythonDebug Off<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Context" rel="Help">
<strong>Context:</strong></a> server config, virtual host, directory, htaccess<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Override" rel="Help">
<strong>Override:</strong></a> not None<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Module" rel="Help">
<strong>Module:</strong></a> mod_python.c

<p>
Normally, the traceback output resulting from uncaught Python errors
is sent to the error log. With PythonDebug On directive specified, the
output will be sent to the client (as well as the log), except when
the error is IOError while writing, in which case it will go to the
error log.
<p>
This directive is very useful during the development process. It is recommended
that you do not use it production environment as it may reveal to the client 
unintended, possibly sensitive security information.

<hr>

<h2><a name="PythonImport">PythonImport</a></h2>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Syntax" rel="Help">
<strong>Syntax:</strong></a> PythonImport <em>module ...</em><br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Context" rel="Help">
<strong>Context:</strong></a> directory<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Module" rel="Help">
<strong>Module:</strong></a> mod_python.c

<p>
Tells the server to import the Python module <em>module</em> at
process startup.  This is useful for initialization tasks that could
be time consuming and should not be done at the request processing
time, e.g. initializing a database connection.

<p>
The import takes place at child process initialization, so the
module will actually be imported once for every child process spawned.

<p>
Note that at the time when the import takes place, the configuration
is not completely read yet, so all other directives, including <a
href="#PythonInterpeter">PythonInterpreter</a> have no effect on the
behaviour of modules imported by this directive. Because of this limitation,
the use of this directive should be limited to situations where it is absolutely
necessary, and the recommended approach to one-time initializations should be 
to use the Python import mechanism.
<p>
The module will be
imported within the subinterpreter according with the directory name
specified by the &lt;Directory&gt; directive. For all other
subinterpreters, the module will not appear imported.

<hr>

<h2><a name="PythonInterpreter">PythonInterpreter</a></h2>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Syntax" rel="Help">
<strong>Syntax:</strong></a> PythonInterpreter <em>name</em><br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Context" rel="Help">
<strong>Context:</strong></a> server config, virtual host, directory, htaccess<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Override" rel="Help">
<strong>Override:</strong></a> not None<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Module" rel="Help">
<strong>Module:</strong></a> mod_python.c

<p>
Forces the subinterpreter name to be <em>name</em>, instead of the
name assigned by mod_python. Mod_python names subinterpreters by using
full path of a directory thereby guaranteeing uniqueness per directory. By using
this directive, scripts located in different directories and that would 
by default be executed in different
subinterpreters, can be forced to execute in the same subinterpreter.

<hr>

<h2><a name="PythonInterpPerDirectory">PythonInterpPerDirectory</a></h2>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Syntax" rel="Help">
<strong>Syntax:</strong></a> PythonInterpPerDirectory {On, Off}<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Default" rel="Help">
<strong>Default:</strong></A> PythonInterpPerDirectory Off<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Context" rel="Help">
<strong>Context:</strong></a> server config, virtual host, directory, htaccess<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Override" rel="Help">
<strong>Override:</strong></a> not None<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Module" rel="Help">
<strong>Module:</strong></a> mod_python.c

<p>
Instructs mod_python to name subinterpreters using the directory of
the file in the request (<code>request_rec->filename</code>) rather
than the directory in which the Python*Handler directive currently in effect
was encountered. This means that scripts in different directories will
execute in different subinterpreters as opposed to the default policy
where scripts effected by the same Handler directive execute in the
same subinterpreter, even if they are in different directories.
<p>
For example, assume there is a
<code>/directory/subdirectory</code>. <code>/directory</code> has an
.htaccess file with a PythonHandler directive.
<code>/directory/subdirectory</code> doesn't have an .htacess. By
default, scripts in <code>/directory</code> and
<code>/directory/subdirectory</code> would execute in the same
interpreter based on the directory where PythonHandler was encountered
(<code>/directory</code>).  With PythonInterpPerDirectory, there would
be two different interpreters, one for each directory.

<hr>

<h2><a name="PythonNoReload">PythonNoReload</a></h2>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Syntax" rel="Help">
<strong>Syntax:</strong></a> PythonNoReload {On, Off}<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Default" rel="Help">
<strong>Default:</strong></A> PythonNoReload Off<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Context" rel="Help">
<strong>Context:</strong></a> server config, virtual host, directory, htaccess<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Override" rel="Help">
<strong>Override:</strong></a> not None<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Module" rel="Help">
<strong>Module:</strong></a> mod_python.c

<p>
Instructs mod_python not to check the modification date of the module
file.  By default, mod_python checks the time-stamp of the file and
reloads the module if the module's file modification date is later
than the last import or reload.
<p>
This options is useful in production environment where the modules do
not change, it will save some processing time and give a small
performance gain.

<hr>
<h2><a name="PythonOption">PythonOption</a></h2>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Syntax" rel="Help">
<strong>Syntax:</strong></a> PythonOption key value<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Context" rel="Help">
<strong>Context:</strong></a> server config, virtual host, directory, htaccess<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Override" rel="Help">
<strong>Override:</strong></a> not None<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Module" rel="Help">
<strong>Module:</strong></a> mod_python.c

<p>
Assigns a key value pair to a table that can be later retrieved by the <code>
request.get_options()</code> function. This is useful to pass information
between the apache configuration files (httpd.conf, .htaccess, etc) and the Python
programs.

<hr>

<h2><a name="PythonPath">PythonPath</a></h2>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Syntax" rel="Help">
<strong>Syntax:</strong></a> PythonPath <em>path</em><br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Context" rel="Help">
<strong>Context:</strong></a> server config, virtual host, directory, htaccess<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Override" rel="Help">
<strong>Override:</strong></a> not None<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Module" rel="Help">
<strong>Module:</strong></a> mod_python.c

<p>
PythonPath directive sets the PythonPath. The path must be specified
in Python list notation, e.g.  
<pre> PythonPath "['/usr/local/lib/python1.5', '/usr/local/lib/site_python', '/some/other/place']".
</pre> 
The path specified in this directive will <em>replace</em> the path,
not <em>add</em> to it.  Note that this directive should not be used as a
security measure since the Python path is easily manipulated from
within the scripts.

<hr>
    <a name="Handlers"><h1>Handlers</h1></a>
<hr>

      <a name="HandlerSyntax">
	<h2>Python*Handler Directive Syntax</h2>
	All <b>Python*Handler</b> directives have the following syntax:
	
      <pre>Python*Handler <em>handler [handler] ...</em></pre>
      
      Where <em>handler</em> is a callable object (e.g. a function) that accepts a
      single argument - <em>request</em> object. Multiple handlers can be specified,
      in which case they will be called sequentially, from left to right.
      <p>
	A <em>handler</em> has the following syntax:
      <pre><em>module[::object] [module::[object]] ...</em></pre>
      
      Where <em>module</em> can be a full module name (package dot notation is
      accepted), and the optional <em>object</em> is the name of an object inside the
      module. 
      <p>
	<em>Object</em> can also contain dots, in which case it will be resolved
	from left to right. During resolution, if mod_python encounters an object of
	type &lt;class&gt;, it will try instantiate it passing it a single argument, a
	request object.
      <p>
	If no <em>object</em> is specified, then it will default to the directive
	of the handler, all lower case, with the word "Python" removed. E.g. the
	default <em>object</em> for <code>PythonAuthenHandler</code> would be 
	<code>authenhandler</code>.
      <p>
	Example: <pre>PythonAuthzHandler mypackage.mymodule::checkallowed</pre>
      <p>
	Side note: The &quot;::&quot; was chosen for performance reasons. In order
	for Python to use objects inside modules, the modules first need to be imported.
	However, if the separator were simply a &quot;.&quot;, it would involve a much
	more complex process of sequentially evaluating every word to determine whether
	it is a package, module, class etc. Using the (admittedly un-Python-like) 
	&quot;::&quot; takes the time consuming work of figuring out where the 
	module ends and the object inside of it begins away from mod_python resulting
	in a modest performance gain..
      <p>

      </a>

    <hr>

<h2><a name="PythonPostReadRequestHandler">PythonPostReadRequestHandler</a></h2>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Syntax" rel="Help">
<strong>Syntax:</strong></a> <a href="#HandlerSyntax"><em>Python*Handler syntax</em></a><br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Default" rel="Help">
<strong>Default:</strong></A> <code>None</code><br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Context" rel="Help">
<strong>Context:</strong></a> server config, virtual host, directory, htaccess<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Override" rel="Help">
<strong>Override:</strong></a> not None<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Module" rel="Help">
<strong>Module:</strong></a> mod_python.c

<p>
      This routine is called after the request has been read but before any
      other phases have been processed.  This is useful to make decisions
      based upon the input header fields.
<hr>
<h2><a name="PythonTransHandler">PythonTransHandler</a></h2>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Syntax" rel="Help">
<strong>Syntax:</strong></a> <a href="#HandlerSyntax"><em>Python*Handler syntax</em></a><br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Default" rel="Help">
<strong>Default:</strong></A> <code>None</code><br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Context" rel="Help">
<strong>Context:</strong></a> server config, virtual host, directory, htaccess<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Override" rel="Help">
<strong>Override:</strong></a> not None<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Module" rel="Help">
<strong>Module:</strong></a> mod_python.c

    <p>
      This routine gives allows for an opportunity to translate the
      URI into an actual filename, before the server's default rules 
      (Alias directives and the like) are followed.
    <hr>
<h2><a name="PythonHeaderParserHandler">PythonHeaderParserHandler</a></h2>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Syntax" rel="Help">
<strong>Syntax:</strong></a> <a href="#HandlerSyntax"><em>Python*Handler syntax</em></a><br>
    <a href="http://www.apache.org/docs/mod/directive-dict.html#Default" rel="Help">
<strong>Default:</strong></A> <code>None</code><br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Context" rel="Help">
<strong>Context:</strong></a> server config, virtual host, directory, htaccess<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Override" rel="Help">
<strong>Override:</strong></a> not None<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Module" rel="Help">
<strong>Module:</strong></a> mod_python.c

<p>
      This handler is called to give the module a chance to look at the request
      headers and take any appropriate specific actions early in the processing
      sequence.
<hr>
<h2><a name="PythonAccessHandler">PythonAccessHandler</a></h2>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Syntax" rel="Help">
<strong>Syntax:</strong></a> <a href="#HandlerSyntax"><em>Python*Handler syntax</em></a><br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Default" rel="Help">
<strong>Default:</strong></A> <code>None</code><br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Context" rel="Help">
<strong>Context:</strong></a> server config, virtual host, directory, htaccess<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Override" rel="Help">
<strong>Override:</strong></a> not None<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Module" rel="Help">
<strong>Module:</strong></a> mod_python.c

    <p>
      This routine is called to check for any module-specific restrictions placed
      upon the requested resource.
    <p>
      For example, this can be used to restrict access by IP number. To do so,
      you would return HTTP_FORBIDDEN or some such to indicate that access is not
      allowed.
<hr>
<h2><a name="PythonAuthenHandler">PythonAuthenHandler</a></h2>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Syntax" rel="Help">
<strong>Syntax:</strong></a> <a href="#HandlerSyntax"><em>Python*Handler syntax</em></a><br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Default" rel="Help">
<strong>Default:</strong></A> <code>None</code><br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Context" rel="Help">
<strong>Context:</strong></a> server config, virtual host, directory, htaccess<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Override" rel="Help">
<strong>Override:</strong></a> not None<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Module" rel="Help">
<strong>Module:</strong></a> mod_python.c

    <p>
      This routine is called to check the authentication information sent with
      the request (such as looking up the user in a database and verifying that
      the [encrypted] password sent matches the one in the database).
    <p>
      To obtain the username, use <code>req.connection.user</code>. To obtain
      the password entered by the user, use the <code>req.get_basic_auth_pw()</code>
      function.
    <p>
      A return of <code>apache.OK</code> means the authentication succeeded. A
      return of <code>apache.HTTP_UNAUTHORIZED</code> with most browser will 
      bring up the password dialog box again. A return of 
      <code>apache.HTTP_FORBIDDEN</code> will usually show the error on the
      browser and not bring up the password dialog again. <code>HTTP_FORBIDDEN</code>
      should be used when authentication succeeded, but the user is not permitted to
      access a particular URL.
    <p>
      An example authentication handler might look like this:
      <pre>
    def authenhandler(req):

        user = req.connection.user     
        pw = req.get_basic_auth_pw()
        if user == "spam" and pw == "eggs":
            return apache.OK
        else:
            return apache.HTTP_UNAUTHORIZED
    </pre>

<hr>
<h2><a name="PythonAuthzHandler">PythonAuthzHandler</a></h2>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Syntax" rel="Help">
<strong>Syntax:</strong></a> <a href="#HandlerSyntax"><em>Python*Handler syntax</em></a><br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Default" rel="Help">
<strong>Default:</strong></A> <code>None</code><br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Context" rel="Help">
<strong>Context:</strong></a> server config, virtual host, directory, htaccess<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Override" rel="Help">
<strong>Override:</strong></a> not None<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Module" rel="Help">
<strong>Module:</strong></a> mod_python.c
    
    <p>
      This routine is called to check to see if the resource being requested
      requires authorization.
<hr>
<h2><a name="PythonTypeHandler">PythonTypeHandler</a></h2>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Syntax" rel="Help">
<strong>Syntax:</strong></a> <a href="#HandlerSyntax"><em>Python*Handler syntax</em></a><br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Default" rel="Help">
<strong>Default:</strong></A> <code>None</code><br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Context" rel="Help">
<strong>Context:</strong></a> server config, virtual host, directory, htaccess<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Override" rel="Help">
<strong>Override:</strong></a> not None<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Module" rel="Help">
<strong>Module:</strong></a> mod_python.c

    <p>
      This routine is called to determine and/or set the various document type
      information bits, like Content-type (via r->content_type), language, et
      cetera.
<hr>
<h2><a name="PythonFixupHandler">PythonFixupHandler</a></h2>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Syntax" rel="Help">
<strong>Syntax:</strong></a> <a href="#HandlerSyntax"><em>Python*Handler syntax</em></a><br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Default" rel="Help">
<strong>Default:</strong></A> <code>None</code><br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Context" rel="Help">
<strong>Context:</strong></a> server config, virtual host, directory, htaccess<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Override" rel="Help">
<strong>Override:</strong></a> not None<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Module" rel="Help">
<strong>Module:</strong></a> mod_python.c
      
    <p>
      This routine is called to perform any module-specific fixing of header
      fields, et cetera.  It is invoked just before any content-handler.
<hr>
<h2><a name="PythonHandler">PythonHandler</a></h2>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Syntax" rel="Help">
<strong>Syntax:</strong></a> <a href="#HandlerSyntax"><em>Python*Handler syntax</em></a><br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Default" rel="Help">
<strong>Default:</strong></A> <code>None</code><br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Context" rel="Help">
<strong>Context:</strong></a> server config, virtual host, directory, htaccess<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Override" rel="Help">
<strong>Override:</strong></a> not None<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Module" rel="Help">
<strong>Module:</strong></a> mod_python.c
      
    <p>
      This is the main request handler. 99.99% of your applications will only
      provide this one handler. 

<hr>
<h2><a name="PythonLogHandler">PythonLogHandler</a></h2>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Syntax" rel="Help">
<strong>Syntax:</strong></a> <a href="#HandlerSyntax"><em>Python*Handler syntax</em></a><br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Default" rel="Help">
<strong>Default:</strong></A> <code>None</code><br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Context" rel="Help">
<strong>Context:</strong></a> server config, virtual host, directory, htaccess<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Override" rel="Help">
<strong>Override:</strong></a> not None<br>
<a href="http://www.apache.org/docs/mod/directive-dict.html#Module" rel="Help">
<strong>Module:</strong></a> mod_python.c
      
    <p>
      This routine is called to perform any module-specific logging activities
      over and above the normal server things.

    <hr>
<!-- Created: Sat May  6 21:05:39 EDT 2000 -->
<!-- hhmts start -->
Last modified: Tue Jun 20 09:55:56 EDT 2000
<!-- hhmts end -->
  </body>
</html>
