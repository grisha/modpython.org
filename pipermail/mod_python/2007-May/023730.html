<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Apache directory listing
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Apache%20directory%20listing&In-Reply-To=88e286470705281511s3ee1ee5cqffa67f500a463abb%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023720.html">
   <LINK REL="Next"  HREF="023732.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Apache directory listing</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Aaron Gallagher</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Apache%20directory%20listing&In-Reply-To=88e286470705281511s3ee1ee5cqffa67f500a463abb%40mail.gmail.com"
       TITLE="[mod_python] Apache directory listing">habnabit at gmail.com
       </A><BR>
    <I>Tue May 29 17:56:35 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="023720.html">[mod_python] Apache directory listing
</A></li>
        <LI>Next message: <A HREF="023732.html">[mod_python] Apache directory listing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23730">[ date ]</a>
              <a href="thread.html#23730">[ thread ]</a>
              <a href="subject.html#23730">[ subject ]</a>
              <a href="author.html#23730">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Okay, I had limited success with mod_autoindex, but unfortunately it  
seems to be impossible to have Apache autoindex the directory.  
Writing my own indexer was pretty simple and it's working well.

Now, though, I'm trying to figure out how to catch errors like 401  
and 403 errors and handle them within my fixuphandler. Is this  
possible? My fixuphandler is currently using the internal_redirect  
function to use a custom 404 page, but I'd like to potentially catch  
all of my errors without using the internal_redirect function.

My authenhandler returns 401 or 403 if there's a bad username or  
password, but it seems that it doesn't go to my fixuphandler but  
apache generates the error pages on its own. It seems like whenever I  
return an error code, apache generates an error page.

So, I guess my question is how I should catch every error to make  
custom error pages?

On May 28, 2007, at 3:11 PM, Graham Dumpleton wrote:

&gt;<i> BTW, SetHandler is only processed in typehandler phase. Thus if you
</I>&gt;<i> want to override that, you must be doing it in the fixuphandler phase.
</I>&gt;<i>
</I>&gt;<i> Also note that allowing automatic directory listings in mod_python can
</I>&gt;<i> cause issues if there are subdirectories which are also managed in
</I>&gt;<i> some way by mod_python. Can't remember whether there is an issue
</I>&gt;<i> logged about it or whether I ranted about it on one of the mailing
</I>&gt;<i> lists somewhere.
</I>&gt;<i>
</I>&gt;<i> Graham
</I>&gt;<i>
</I>&gt;<i> On 29/05/07, Graham Dumpleton &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">graham.dumpleton at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i> If a phase earlier than response handler phase is providing the
</I>&gt;&gt;<i> complete response, it should return apache.DONE and not apache.OK.
</I>&gt;&gt;<i> This will stop later phases running.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Graham
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On 28/05/07, Aaron Gallagher &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">habnabit at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i> &gt; I've just moved a lot of my code (including the code that checks to
</I>&gt;&gt;<i> &gt; see if a directory should have its contents listed) from a
</I>&gt;&gt;<i> &gt; PythonHandler into a PythonHeaderParserHandler, because after  
</I>&gt;&gt;<i> looking
</I>&gt;&gt;<i> &gt; at the response loop, I determined that PythonFixupHandler was
</I>&gt;&gt;<i> &gt; happening too late in the process.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; It's created some interesting new problems -- my calls to
</I>&gt;&gt;<i> &gt; req.internal_redirect aren't working, as the code was set up  
</I>&gt;&gt;<i> like this:
</I>&gt;&gt;<i> &gt; req.internal_redirect(...)
</I>&gt;&gt;<i> &gt; return apache.OK
</I>&gt;&gt;<i> &gt; I guess this isn't stopping the request, like it used to do. How
</I>&gt;&gt;<i> &gt; should I change my code to allow internal redirects?
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Also, all of your suggestions just act the same way as if I had  
</I>&gt;&gt;<i> just
</I>&gt;&gt;<i> &gt; done return apache.OK.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; On May 28, 2007, at 4:22 AM, Graham Dumpleton wrote:
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; &gt; On 28/05/07, Aaron Gallagher &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">habnabit at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i> &gt; &gt;&gt; Okay, I'll try that.
</I>&gt;&gt;<i> &gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt;&gt; But, what exactly is the purpose of a PythonFixupHandler? The
</I>&gt;&gt;<i> &gt; &gt;&gt; documentation doesn't have much to say, but I assume it's for  
</I>&gt;&gt;<i> doing
</I>&gt;&gt;<i> &gt; &gt;&gt; URL rewriting and redirection.
</I>&gt;&gt;<i> &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; Potentially. It is one of a number of phases and is a sort of  
</I>&gt;&gt;<i> catch
</I>&gt;&gt;<i> &gt; &gt; all or last chance phase before actual response handler is  
</I>&gt;&gt;<i> executed.
</I>&gt;&gt;<i> &gt; &gt; For a very technical description of the whole Apache request- 
</I>&gt;&gt;<i> response
</I>&gt;&gt;<i> &gt; &gt; loop see:
</I>&gt;&gt;<i> &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt;  <A HREF="http://www.fmc-modeling.org/projects/apache/html/">http://www.fmc-modeling.org/projects/apache/html/</A>
</I>&gt;&gt;<i> &gt; &gt; 4_4Request_Response_Loop.html
</I>&gt;&gt;<i> &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; If you really want to understand how Apache works, that whole  
</I>&gt;&gt;<i> document
</I>&gt;&gt;<i> &gt; &gt; is quite a good read, albeit probably more in depth than most  
</I>&gt;&gt;<i> people
</I>&gt;&gt;<i> &gt; &gt; would care for.
</I>&gt;&gt;<i> &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; Graham
</I>&gt;&gt;<i> &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt;&gt; On May 28, 2007, at 3:44 AM, Graham Dumpleton wrote:
</I>&gt;&gt;<i> &gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt; Arrgghh, mistook mime type for handler.
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt; Trying again, although not sure this will work, but might  
</I>&gt;&gt;<i> be able
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt; to say:
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;  req.handler = &quot;httpd/unix-directory&quot;
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;  return apache.DECLINED
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt; The reason this might not work is that mod_python registers
</I>&gt;&gt;<i> &gt; &gt;&gt; itself as
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt; a middle handler as does the autoindex module. Because the
</I>&gt;&gt;<i> &gt; &gt;&gt; autoindex
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt; module is inbuilt, it probably gets processed prior to  
</I>&gt;&gt;<i> mod_python
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt; handler so too late to do the above.
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt; Thus, your only choice would be to provide a fixuphandler  
</I>&gt;&gt;<i> which
</I>&gt;&gt;<i> &gt; &gt;&gt; undoes
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt; the SetHandler just for the request against the directory and
</I>&gt;&gt;<i> &gt; &gt;&gt; triggers
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt; autoindex instead. Ie.,
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;  def fixuphandler(req):
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;    if req.content_type = &quot;httpd/x-directory&quot;:
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;      req.handler = &quot;httpd/unix-directory&quot;
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;    return apache.OK
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt; Enable this using appropriate PythonFixupHandler directive.
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt; Graham
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt; On 28/05/07, Aaron Gallagher &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">habnabit at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;&gt; I get a 404 Not Found error.
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;&gt; On May 28, 2007, at 3:22 AM, Graham Dumpleton wrote:
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt; What happens if you return apache.DECLINED.
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt; Graham
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt; On 28/05/07, Aaron Gallagher &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">habnabit at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt; Is there a way to tell Apache to give a directory  
</I>&gt;&gt;<i> listing? I'm
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;&gt; using
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt; SetHandler on a directory, and in some cases, I don't need
</I>&gt;&gt;<i> &gt; &gt;&gt; to do
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt; any special
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt; handling, so I'd like Apache to just list the contents  
</I>&gt;&gt;<i> of the
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt; directory so
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt; that I don't have to write my own way of doing it.
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt; Just returning apache.OK has Apache send a document of  
</I>&gt;&gt;<i> MIME
</I>&gt;&gt;<i> &gt; &gt;&gt; time
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt; httpd/x-directory with content length 0.
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt; Aaron Gallagher
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt; &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">habnabit at gmail.com</A>&gt;
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt; _______________________________________________
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt; Mod_python mailing list
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;&gt; Aaron Gallagher
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;&gt; &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">habnabit at gmail.com</A>&gt;
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt;&gt; Aaron Gallagher
</I>&gt;&gt;<i> &gt; &gt;&gt; &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">habnabit at gmail.com</A>&gt;
</I>&gt;&gt;<i> &gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt;&gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Aaron Gallagher
</I>&gt;&gt;<i> &gt; &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">habnabit at gmail.com</A>&gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; _______________________________________________
</I>&gt;&gt;<i> &gt; Mod_python mailing list
</I>&gt;&gt;<i> &gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;&gt;<i> &gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i>
</I>
Aaron Gallagher
&lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">habnabit at gmail.com</A>&gt;


</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023720.html">[mod_python] Apache directory listing
</A></li>
	<LI>Next message: <A HREF="023732.html">[mod_python] Apache directory listing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23730">[ date ]</a>
              <a href="thread.html#23730">[ thread ]</a>
              <a href="subject.html#23730">[ subject ]</a>
              <a href="author.html#23730">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
