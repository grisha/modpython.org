<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Multiple loading of same module with winnt MPM
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Multiple%20loading%20of%20same%20module%20with%20winnt%20MPM&In-Reply-To=4641C2B6.7060302%40gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023583.html">
   <LINK REL="Next"  HREF="023586.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Multiple loading of same module with winnt MPM</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Multiple%20loading%20of%20same%20module%20with%20winnt%20MPM&In-Reply-To=4641C2B6.7060302%40gmail.com"
       TITLE="[mod_python] Multiple loading of same module with winnt MPM">graham.dumpleton at gmail.com
       </A><BR>
    <I>Wed May  9 18:00:47 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="023583.html">[mod_python] Multiple loading of same module with winnt MPM
</A></li>
        <LI>Next message: <A HREF="023586.html">[mod_python] Multiple loading of same module with winnt MPM
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23584">[ date ]</a>
              <a href="thread.html#23584">[ thread ]</a>
              <a href="subject.html#23584">[ subject ]</a>
              <a href="author.html#23584">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Post the snippet of PSP code you are doing the import from.

Post the Apache configuration snippet you are using so it can be seen
whether you are setting PythonPath to include a directory which
overlaps the document area and whether you are using Apache style
forward slashes in paths or Windows backwards slashes.

Post the snippets of the log files which show when the module is being
loaded so can see the paths it is being loaded under. Especially post
any warnings output about a path appearing in sys.path as well as
mod_python module importer path.

The only issue I know of with PSP and the new module importer is that
if you use 'import' rather than 'apache.import_module()', the 'import'
will always use standard Python module importer and not
'apache.import_module()'. Thus if you were trying to import a module
from the same directory it by default will not work. If you fiddled
PythonPath to include that directory, thus creating an overlap in the
two systems, it will import but thus may be imported separately by
both mechanisms.

To address this latter problem, PSP needs to be changed to fake up
some information in the page pseudo module so that it thinks it was
imported used mod_python importer in the first place and will thus map
'import' through to 'apache.import_module()' properly.

Graham

On 09/05/07, Michael Sanders &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">m.r.sanders at gmail.com</A>&gt; wrote:
&gt;<i> Environment:
</I>&gt;<i> - mod_python 3.3.1
</I>&gt;<i> - Apache 2.2.3 running on Windows XP
</I>&gt;<i> - PSP request handler
</I>&gt;<i>
</I>&gt;<i> [Issue 4] described at the following link still appears to be present in
</I>&gt;<i> mod_python 3.3.1:
</I>&gt;<i> <A HREF="http://www.dscpl.com.au/wiki/ModPython/Articles/ModuleImportingIsBroken#line-50">http://www.dscpl.com.au/wiki/ModPython/Articles/ModuleImportingIsBroken#line-50</A>
</I>&gt;<i>
</I>&gt;<i> I have a PSP file that imports a module using 'apache.import_module'. If
</I>&gt;<i> I re-start Apache and then fire two simultaneous requests at the PSP
</I>&gt;<i> file, mod_python loads the module twice. (The module in question when
</I>&gt;<i> imported  sets up a logging handler. The initial entry written by this
</I>&gt;<i> module to the log file is duplicated and subsequent calls to this
</I>&gt;<i> handler also give duplicate entries in the log file).
</I>&gt;<i>
</I>&gt;<i> If I import the module using the standard Python 'import', this problem
</I>&gt;<i> does not occur. Likewise, if I use the 'vampire.importModule' method,
</I>&gt;<i> the problem does not occur. The issue only happens when using
</I>&gt;<i> 'apache.import_module'.
</I>&gt;<i>
</I>&gt;<i> Has anyone else experienced this? Is there a fix?
</I>&gt;<i>
</I>&gt;<i> Many thanks,
</I>&gt;<i> Michael Sanders
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i>
</I></PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023583.html">[mod_python] Multiple loading of same module with winnt MPM
</A></li>
	<LI>Next message: <A HREF="023586.html">[mod_python] Multiple loading of same module with winnt MPM
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23584">[ date ]</a>
              <a href="thread.html#23584">[ thread ]</a>
              <a href="subject.html#23584">[ subject ]</a>
              <a href="author.html#23584">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
