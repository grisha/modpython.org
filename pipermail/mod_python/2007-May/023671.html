<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] python program versus handler
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20python%20program%20versus%20handler&In-Reply-To=20070522180554.GB12075%40asu.edu">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023668.html">
   <LINK REL="Next"  HREF="023673.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] python program versus handler</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Greg Fawcett</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20python%20program%20versus%20handler&In-Reply-To=20070522180554.GB12075%40asu.edu"
       TITLE="[mod_python] python program versus handler">greg at vig.co.nz
       </A><BR>
    <I>Tue May 22 18:25:16 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="023668.html">[mod_python] python program versus handler
</A></li>
        <LI>Next message: <A HREF="023673.html">[mod_python] python program versus handler
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23671">[ date ]</a>
              <a href="thread.html#23671">[ thread ]</a>
              <a href="subject.html#23671">[ subject ]</a>
              <a href="author.html#23671">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi David -

Before I start, I'm fairly new to mod_python, so my approach may not be
ideal - hopefully the wiser heads on this list can correct anything
stupid...

I decided not to go with publisher, because it seemed to include a lot of
functionality I didn't need, and I had this strange compulsion to use URLs
like &quot;message.view&quot;, where message is a module and view is a function within
the module. This has worked out quite nicely, with &quot;user.addform&quot; displaying
the form to add a user, &quot;user.add&quot; processing the add form fields, and
you'll guess what &quot;user.delete&quot; does. This allows me to keep all my code
relating to users in one module, which seems a good idea.

My handler is extremely simple - only 70 lines long, including comments. It
grabs the session information, initialises database connection, parses
req.uri to find the moduleName and actionName, and then...

    try:
        module=apache.import_module('vf_'+moduleName)
    except ImportError: # Only catch ImportError so syntax errors show
        apache.log_error('vfax.py could not find module
&quot;vf_%s&quot;'%(moduleName))
        return apache.HTTP_NOT_FOUND

    try:
        action=eval('module.'+actionName)
    except:
        apache.log_error('vfax.py could not find action &quot;%s&quot;'%(actionName))
        return apache.HTTP_NOT_FOUND

    apacheReturnCode=action(ft)


If someone tries to hack in via non-existant module names or functions, they
get a 404. One issue I found is that you have to take care with private
functions which should not be callable from outside the module - perhaps you
have a function formatDate() say, used by public functions in the user
module. This should not be available via the URL &quot;user.formatDate&quot;, or else
you are leaving yourself open to myriad security issues. I tried starting
their names with two underscores (so it became __formatDate(), but
&quot;user.__formatDate&quot; still worked. So I added a test in my handler for two
leading underscores and 404'd them too:

        if actionName[0:2]=='__':
            apache.log_error('vfax.py refused action &quot;%s&quot;'%(actionName))
            return apache.HTTP_NOT_FOUND

I'd be interested in those wiser head's comments on this - shouldn't a
function with two leading underscores not be callable from outside the
module?

Anyhow, the main point of this message is that writing your own handler is
not a big deal, as long as you are happy to manage issues like sessions and
URL parsing yourself. Publisher is probably a better idea for newcomers to
web development because it already handles many of the gotchas that may
leave your application vulnerable to the net nasties, but if you have some
experience, you have a lot more control and a faster application by writing
your own handler.

Cheers!
Greg.

On 23/05/07, David Bear &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">David.Bear at asu.edu</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> I'm trying to decide whether to use publisher or just use
</I>&gt;<i> AddHandler python-program
</I>&gt;<i>
</I>&gt;<i> I understand with publisher that all defined functions are callable in
</I>&gt;<i> the url. What happens though if I just use python-program as the
</I>&gt;<i> handler? Which functions are called? What happens the __name__?
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> David Bear
</I>&gt;<i> phone:  602-496-0424
</I>&gt;<i> fax:    602-496-0955
</I>&gt;<i> College of Public Programs/ASU
</I>&gt;<i> University Center Rm 622
</I>&gt;<i> 411 N Central
</I>&gt;<i> Phoenix, AZ 85007-0685
</I>&gt;<i> &quot;Beware the IP portfolio, everyone will be suspect of trespassing&quot;
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i>
</I>


-- 
Phone: +64 3 409 8165
Mobile: +64 21 333 291
Fax: +64 3 974 6810
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070523/900e1017/attachment-0001.html">http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070523/900e1017/attachment-0001.html</A>
</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023668.html">[mod_python] python program versus handler
</A></li>
	<LI>Next message: <A HREF="023673.html">[mod_python] python program versus handler
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23671">[ date ]</a>
              <a href="thread.html#23671">[ thread ]</a>
              <a href="subject.html#23671">[ subject ]</a>
              <a href="author.html#23671">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
