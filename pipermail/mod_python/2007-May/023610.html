<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] dot dot in the url
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20dot%20dot%20in%20the%20url&In-Reply-To=464554B7.90902%40rogerbinns.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023608.html">
   <LINK REL="Next"  HREF="023611.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] dot dot in the url</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20dot%20dot%20in%20the%20url&In-Reply-To=464554B7.90902%40rogerbinns.com"
       TITLE="[mod_python] dot dot in the url">graham.dumpleton at gmail.com
       </A><BR>
    <I>Sat May 12 02:13:20 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="023608.html">[mod_python] dot dot in the url
</A></li>
        <LI>Next message: <A HREF="023611.html">[mod_python] dot dot in the url
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23610">[ date ]</a>
              <a href="thread.html#23610">[ thread ]</a>
              <a href="subject.html#23610">[ subject ]</a>
              <a href="author.html#23610">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Someone who is more knowledgeable on this may want to comment, but the
RFC for what a URI is and how it should be interpreted gives special
meaning to '../' and './', and it specifically says how they are meant
to be deal with by a server before being interpreted. You appear to be
wanting to side step the RFC and ignore what the standard says and
have it interpreted your way which just seems wrong.

For example, the RFC says:

   The path segments &quot;.&quot; and &quot;..&quot;, also known as dot-segments, are
   defined for relative reference within the path name hierarchy.  They
   are intended for use at the beginning of a relative-path reference
   (Section 4.2) to indicate relative position within the hierarchical
   tree of names.  This is similar to their role within some operating
   systems' file directory structures to indicate the current directory
   and parent directory, respectively.  However, unlike in a file
   system, these dot-segments are only interpreted within the URI path
   hierarchy and are removed as part of the resolution process (Section
   5.2).

Note how it says that are removed as part of the resolution process.
It is the web server here that is doing the resolution process. Only
after that resolution process can it validly map it to a particular
handler. You only get the resolved path and that is how it is meant to
be.

For more details see:

  <A HREF="http://www.ietf.org/rfc/rfc2396.txt">http://www.ietf.org/rfc/rfc2396.txt</A>
  <A HREF="http://www.ietf.org/rfc/rfc3986.txt">http://www.ietf.org/rfc/rfc3986.txt</A>

You just seem to be going about this the wrong way. Why do you expect
a URI that resolves to be outside of the base URI for your handler to
still result in your handler being called? If it is important that it
isn't, you should be generating URIs that map to outside of your base
URI in the first place.

Graham

On 12/05/07, Roger Binns &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">rogerb at rogerbinns.com</A>&gt; wrote:
&gt;<i> -----BEGIN PGP SIGNED MESSAGE-----
</I>&gt;<i> Hash: SHA1
</I>&gt;<i>
</I>&gt;<i> Graham Dumpleton wrote:
</I>&gt;<i> &gt; If your web browser doesn't normalise it
</I>&gt;<i>
</I>&gt;<i> I am sending requests from my test harness which does not do
</I>&gt;<i> normalization.  In my case normalization effectively &quot;corrupts&quot; the data.
</I>&gt;<i>
</I>&gt;<i> &gt; then Apache will. Such
</I>&gt;<i> &gt; normalisation will be done before it even gets to mod_python.
</I>&gt;<i>
</I>&gt;<i> req.uri is normalized but req.unparsed_uri is as originally sent by the
</I>&gt;<i> client, so I use that.  The only remaining problem is that if the
</I>&gt;<i> normalized uri doesn't reference my handler then it isn't called.
</I>&gt;<i>
</I>&gt;<i> &lt;Location /api/v1/&gt;
</I>&gt;<i>  SetHandler python-program
</I>&gt;<i>  PythonHandler restapiv1::RestAPIV1.RequestHandler
</I>&gt;<i> &lt;/Location&gt;
</I>&gt;<i>
</I>&gt;<i> So I get called for /api/v1/widget/a/b/c/d/../../e but not for
</I>&gt;<i> /api/v1/widget/../../e/a/b/c/d
</I>&gt;<i>
</I>&gt;<i> &gt; You state want you want to happen, but why exactly do you want to do
</I>&gt;<i> &gt; this in the first place? What is the underlying reason?
</I>&gt;<i>
</I>&gt;<i> Exactly as I said.  It is a rest service and the names of items appear
</I>&gt;<i> as part of the URL.  eg You use PUT /api/v1/widget/foo to create a
</I>&gt;<i> widget named foo, GET to query it, DELETE to delete it etc.
</I>&gt;<i>
</I>&gt;<i> But because of this normalization done by Apache before deciding which
</I>&gt;<i> handler to call, that imposes an arbitrary constraint on names such that
</I>&gt;<i> they can't have ../ sequences that get up before the /api/v1/.  The
</I>&gt;<i> arbitrary constraint then has to be documented, tested, have friendly
</I>&gt;<i> information in user interfaces etc.  It is an ugly wart and I was hoping
</I>&gt;<i> it was unnecessary.
</I>&gt;<i>
</I>&gt;<i> Roger
</I>&gt;<i> -----BEGIN PGP SIGNATURE-----
</I>&gt;<i> Version: GnuPG v1.4.6 (GNU/Linux)
</I>&gt;<i>
</I>&gt;<i> iD8DBQFGRVS3mOOfHg372QQRAulYAJ90JYiXJ+FSkQzJPNpdlTCFJFSYvgCfbzw4
</I>&gt;<i> 1FKXPA+JqBzWAufEfSe13CA=
</I>&gt;<i> =ZdiB
</I>&gt;<i> -----END PGP SIGNATURE-----
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i>
</I></PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023608.html">[mod_python] dot dot in the url
</A></li>
	<LI>Next message: <A HREF="023611.html">[mod_python] dot dot in the url
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23610">[ date ]</a>
              <a href="thread.html#23610">[ thread ]</a>
              <a href="subject.html#23610">[ subject ]</a>
              <a href="author.html#23610">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
