<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Apache directory listing
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Apache%20directory%20listing&In-Reply-To=88e286470705281356j7698aca6u595b565824b71118%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023717.html">
   <LINK REL="Next"  HREF="023730.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Apache directory listing</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Apache%20directory%20listing&In-Reply-To=88e286470705281356j7698aca6u595b565824b71118%40mail.gmail.com"
       TITLE="[mod_python] Apache directory listing">graham.dumpleton at gmail.com
       </A><BR>
    <I>Mon May 28 18:11:31 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="023717.html">[mod_python] Apache directory listing
</A></li>
        <LI>Next message: <A HREF="023730.html">[mod_python] Apache directory listing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23720">[ date ]</a>
              <a href="thread.html#23720">[ thread ]</a>
              <a href="subject.html#23720">[ subject ]</a>
              <a href="author.html#23720">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>BTW, SetHandler is only processed in typehandler phase. Thus if you
want to override that, you must be doing it in the fixuphandler phase.

Also note that allowing automatic directory listings in mod_python can
cause issues if there are subdirectories which are also managed in
some way by mod_python. Can't remember whether there is an issue
logged about it or whether I ranted about it on one of the mailing
lists somewhere.

Graham

On 29/05/07, Graham Dumpleton &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">graham.dumpleton at gmail.com</A>&gt; wrote:
&gt;<i> If a phase earlier than response handler phase is providing the
</I>&gt;<i> complete response, it should return apache.DONE and not apache.OK.
</I>&gt;<i> This will stop later phases running.
</I>&gt;<i>
</I>&gt;<i> Graham
</I>&gt;<i>
</I>&gt;<i> On 28/05/07, Aaron Gallagher &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">habnabit at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt; I've just moved a lot of my code (including the code that checks to
</I>&gt;<i> &gt; see if a directory should have its contents listed) from a
</I>&gt;<i> &gt; PythonHandler into a PythonHeaderParserHandler, because after looking
</I>&gt;<i> &gt; at the response loop, I determined that PythonFixupHandler was
</I>&gt;<i> &gt; happening too late in the process.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; It's created some interesting new problems -- my calls to
</I>&gt;<i> &gt; req.internal_redirect aren't working, as the code was set up like this:
</I>&gt;<i> &gt; req.internal_redirect(...)
</I>&gt;<i> &gt; return apache.OK
</I>&gt;<i> &gt; I guess this isn't stopping the request, like it used to do. How
</I>&gt;<i> &gt; should I change my code to allow internal redirects?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Also, all of your suggestions just act the same way as if I had just
</I>&gt;<i> &gt; done return apache.OK.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; On May 28, 2007, at 4:22 AM, Graham Dumpleton wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt; On 28/05/07, Aaron Gallagher &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">habnabit at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt; &gt;&gt; Okay, I'll try that.
</I>&gt;<i> &gt; &gt;&gt;
</I>&gt;<i> &gt; &gt;&gt; But, what exactly is the purpose of a PythonFixupHandler? The
</I>&gt;<i> &gt; &gt;&gt; documentation doesn't have much to say, but I assume it's for doing
</I>&gt;<i> &gt; &gt;&gt; URL rewriting and redirection.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Potentially. It is one of a number of phases and is a sort of catch
</I>&gt;<i> &gt; &gt; all or last chance phase before actual response handler is executed.
</I>&gt;<i> &gt; &gt; For a very technical description of the whole Apache request-response
</I>&gt;<i> &gt; &gt; loop see:
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;  <A HREF="http://www.fmc-modeling.org/projects/apache/html/">http://www.fmc-modeling.org/projects/apache/html/</A>
</I>&gt;<i> &gt; &gt; 4_4Request_Response_Loop.html
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; If you really want to understand how Apache works, that whole document
</I>&gt;<i> &gt; &gt; is quite a good read, albeit probably more in depth than most people
</I>&gt;<i> &gt; &gt; would care for.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Graham
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;&gt; On May 28, 2007, at 3:44 AM, Graham Dumpleton wrote:
</I>&gt;<i> &gt; &gt;&gt;
</I>&gt;<i> &gt; &gt;&gt; &gt; Arrgghh, mistook mime type for handler.
</I>&gt;<i> &gt; &gt;&gt; &gt;
</I>&gt;<i> &gt; &gt;&gt; &gt; Trying again, although not sure this will work, but might be able
</I>&gt;<i> &gt; &gt;&gt; &gt; to say:
</I>&gt;<i> &gt; &gt;&gt; &gt;
</I>&gt;<i> &gt; &gt;&gt; &gt;  req.handler = &quot;httpd/unix-directory&quot;
</I>&gt;<i> &gt; &gt;&gt; &gt;  return apache.DECLINED
</I>&gt;<i> &gt; &gt;&gt; &gt;
</I>&gt;<i> &gt; &gt;&gt; &gt; The reason this might not work is that mod_python registers
</I>&gt;<i> &gt; &gt;&gt; itself as
</I>&gt;<i> &gt; &gt;&gt; &gt; a middle handler as does the autoindex module. Because the
</I>&gt;<i> &gt; &gt;&gt; autoindex
</I>&gt;<i> &gt; &gt;&gt; &gt; module is inbuilt, it probably gets processed prior to mod_python
</I>&gt;<i> &gt; &gt;&gt; &gt; handler so too late to do the above.
</I>&gt;<i> &gt; &gt;&gt; &gt;
</I>&gt;<i> &gt; &gt;&gt; &gt; Thus, your only choice would be to provide a fixuphandler which
</I>&gt;<i> &gt; &gt;&gt; undoes
</I>&gt;<i> &gt; &gt;&gt; &gt; the SetHandler just for the request against the directory and
</I>&gt;<i> &gt; &gt;&gt; triggers
</I>&gt;<i> &gt; &gt;&gt; &gt; autoindex instead. Ie.,
</I>&gt;<i> &gt; &gt;&gt; &gt;
</I>&gt;<i> &gt; &gt;&gt; &gt;  def fixuphandler(req):
</I>&gt;<i> &gt; &gt;&gt; &gt;    if req.content_type = &quot;httpd/x-directory&quot;:
</I>&gt;<i> &gt; &gt;&gt; &gt;      req.handler = &quot;httpd/unix-directory&quot;
</I>&gt;<i> &gt; &gt;&gt; &gt;    return apache.OK
</I>&gt;<i> &gt; &gt;&gt; &gt;
</I>&gt;<i> &gt; &gt;&gt; &gt; Enable this using appropriate PythonFixupHandler directive.
</I>&gt;<i> &gt; &gt;&gt; &gt;
</I>&gt;<i> &gt; &gt;&gt; &gt; Graham
</I>&gt;<i> &gt; &gt;&gt; &gt;
</I>&gt;<i> &gt; &gt;&gt; &gt; On 28/05/07, Aaron Gallagher &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">habnabit at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt; &gt;&gt; &gt;&gt; I get a 404 Not Found error.
</I>&gt;<i> &gt; &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt; &gt;&gt; &gt;&gt; On May 28, 2007, at 3:22 AM, Graham Dumpleton wrote:
</I>&gt;<i> &gt; &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt; What happens if you return apache.DECLINED.
</I>&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;
</I>&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt; Graham
</I>&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;
</I>&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt; On 28/05/07, Aaron Gallagher &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">habnabit at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt; Is there a way to tell Apache to give a directory listing? I'm
</I>&gt;<i> &gt; &gt;&gt; &gt;&gt; using
</I>&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt; SetHandler on a directory, and in some cases, I don't need
</I>&gt;<i> &gt; &gt;&gt; to do
</I>&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt; any special
</I>&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt; handling, so I'd like Apache to just list the contents of the
</I>&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt; directory so
</I>&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt; that I don't have to write my own way of doing it.
</I>&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt; Just returning apache.OK has Apache send a document of MIME
</I>&gt;<i> &gt; &gt;&gt; time
</I>&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt; httpd/x-directory with content length 0.
</I>&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt; Aaron Gallagher
</I>&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt; &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">habnabit at gmail.com</A>&gt;
</I>&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt; _______________________________________________
</I>&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt; Mod_python mailing list
</I>&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt; &gt;&gt; &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt; &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt; &gt;&gt; &gt;&gt; Aaron Gallagher
</I>&gt;<i> &gt; &gt;&gt; &gt;&gt; &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">habnabit at gmail.com</A>&gt;
</I>&gt;<i> &gt; &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt; &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt; &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt; &gt;&gt;
</I>&gt;<i> &gt; &gt;&gt; Aaron Gallagher
</I>&gt;<i> &gt; &gt;&gt; &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">habnabit at gmail.com</A>&gt;
</I>&gt;<i> &gt; &gt;&gt;
</I>&gt;<i> &gt; &gt;&gt;
</I>&gt;<i> &gt; &gt;&gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Aaron Gallagher
</I>&gt;<i> &gt; &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">habnabit at gmail.com</A>&gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Mod_python mailing list
</I>&gt;<i> &gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> &gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I></PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023717.html">[mod_python] Apache directory listing
</A></li>
	<LI>Next message: <A HREF="023730.html">[mod_python] Apache directory listing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23720">[ date ]</a>
              <a href="thread.html#23720">[ thread ]</a>
              <a href="subject.html#23720">[ subject ]</a>
              <a href="author.html#23720">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
