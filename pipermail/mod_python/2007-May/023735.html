<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Apache directory listing
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Apache%20directory%20listing&In-Reply-To=B3553137-1D32-4813-864A-8177E782B6A9%40gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023733.html">
   <LINK REL="Next"  HREF="023736.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Apache directory listing</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Apache%20directory%20listing&In-Reply-To=B3553137-1D32-4813-864A-8177E782B6A9%40gmail.com"
       TITLE="[mod_python] Apache directory listing">graham.dumpleton at gmail.com
       </A><BR>
    <I>Tue May 29 19:23:51 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="023733.html">[mod_python] Apache directory listing
</A></li>
        <LI>Next message: <A HREF="023736.html">[mod_python] Apache directory listing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23735">[ date ]</a>
              <a href="thread.html#23735">[ thread ]</a>
              <a href="subject.html#23735">[ subject ]</a>
              <a href="author.html#23735">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 30/05/07, Aaron Gallagher &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">habnabit at gmail.com</A>&gt; wrote:
&gt;<i> Also, I seem to actually be having bizarre problems with my
</I>&gt;<i> redirects. When I request /a/b/c/d/, my handler catches the bad URL
</I>&gt;<i> and executes this code:
</I>&gt;<i> req.internal_redirect('/?__404')
</I>&gt;<i> return apache.DONE
</I>&gt;<i>
</I>&gt;<i> What happens is I get a page that has a text/plain mime type with a
</I>&gt;<i> 200 response code that looks essentially like this (stripping out a
</I>&gt;<i> lot of HTML):
</I>&gt;<i> Page not found: /d/
</I>&gt;<i> Page not found: /c/d/
</I>&gt;<i> Page not found: /b/c/d/
</I>&gt;<i> Page not found: /a/b/c/d/
</I>&gt;<i>
</I>&gt;<i> I found that after the redirect, the handler (which is a
</I>&gt;<i> fixuphandler) doesn't recur, but return apache.DONE, and then another
</I>&gt;<i> handler is called. My only thought could be that this is intrinsic to
</I>&gt;<i> the fixuphandler, but that seems silly. Skipping the redirect and
</I>&gt;<i> just returning 404 seems to work, and it doesn't return four not
</I>&gt;<i> found pages.
</I>&gt;<i>
</I>&gt;<i> What do I need to do to fix this?
</I>
This is probably the problem with autoindex I briefly mentioned. To do
an index it actually does a sub request as far as the fixup handler
phase for every item which it might list in the index to determine if
it has access rights and should be listing it. If you have handlers
for these phases it will trigger them for the subrequest as well which
might cause issues. One can detect if such a handler is called in
subrequest by looking whether req.prev or req.main (cant remember
which), is not None.

When I get a chance to at least get directory index to week as you
indicate what you want, then we can start stepping through these
others issues.

Graham
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023733.html">[mod_python] Apache directory listing
</A></li>
	<LI>Next message: <A HREF="023736.html">[mod_python] Apache directory listing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23735">[ date ]</a>
              <a href="thread.html#23735">[ thread ]</a>
              <a href="subject.html#23735">[ subject ]</a>
              <a href="author.html#23735">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
