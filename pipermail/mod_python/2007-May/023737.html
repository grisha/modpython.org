<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Apache directory listing
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Apache%20directory%20listing&In-Reply-To=12B98D29-1414-4305-BF7F-24E5107E4438%40gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023736.html">
   <LINK REL="Next"  HREF="023738.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Apache directory listing</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Apache%20directory%20listing&In-Reply-To=12B98D29-1414-4305-BF7F-24E5107E4438%40gmail.com"
       TITLE="[mod_python] Apache directory listing">graham.dumpleton at gmail.com
       </A><BR>
    <I>Tue May 29 22:31:08 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="023736.html">[mod_python] Apache directory listing
</A></li>
        <LI>Next message: <A HREF="023738.html">[mod_python] Apache directory listing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23737">[ date ]</a>
              <a href="thread.html#23737">[ thread ]</a>
              <a href="subject.html#23737">[ subject ]</a>
              <a href="author.html#23737">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Sorry, that doesn't make any sense at all. Are you able to post the
code you are using? This is getting all too hard to follow when one
can only make assumptions about what you are doing.

Graham

On 30/05/07, Aaron Gallagher &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">habnabit at gmail.com</A>&gt; wrote:
&gt;<i> On May 29, 2007, at 4:23 PM, Graham Dumpleton wrote:
</I>&gt;<i>
</I>&gt;<i> &gt; On 30/05/07, Aaron Gallagher &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">habnabit at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt;&gt; Also, I seem to actually be having bizarre problems with my
</I>&gt;<i> &gt;&gt; redirects. When I request /a/b/c/d/, my handler catches the bad URL
</I>&gt;<i> &gt;&gt; and executes this code:
</I>&gt;<i> &gt;&gt; req.internal_redirect('/?__404')
</I>&gt;<i> &gt;&gt; return apache.DONE
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; What happens is I get a page that has a text/plain mime type with a
</I>&gt;<i> &gt;&gt; 200 response code that looks essentially like this (stripping out a
</I>&gt;<i> &gt;&gt; lot of HTML):
</I>&gt;<i> &gt;&gt; Page not found: /d/
</I>&gt;<i> &gt;&gt; Page not found: /c/d/
</I>&gt;<i> &gt;&gt; Page not found: /b/c/d/
</I>&gt;<i> &gt;&gt; Page not found: /a/b/c/d/
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; I found that after the redirect, the handler (which is a
</I>&gt;<i> &gt;&gt; fixuphandler) doesn't recur, but return apache.DONE, and then another
</I>&gt;<i> &gt;&gt; handler is called. My only thought could be that this is intrinsic to
</I>&gt;<i> &gt;&gt; the fixuphandler, but that seems silly. Skipping the redirect and
</I>&gt;<i> &gt;&gt; just returning 404 seems to work, and it doesn't return four not
</I>&gt;<i> &gt;&gt; found pages.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; What do I need to do to fix this?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; This is probably the problem with autoindex I briefly mentioned. To do
</I>&gt;<i> &gt; an index it actually does a sub request as far as the fixup handler
</I>&gt;<i> &gt; phase for every item which it might list in the index to determine if
</I>&gt;<i> &gt; it has access rights and should be listing it. If you have handlers
</I>&gt;<i> &gt; for these phases it will trigger them for the subrequest as well which
</I>&gt;<i> &gt; might cause issues. One can detect if such a handler is called in
</I>&gt;<i> &gt; subrequest by looking whether req.prev or req.main (cant remember
</I>&gt;<i> &gt; which), is not None.
</I>&gt;<i>
</I>&gt;<i> I just tried this, and whenever I tried to access req.prev or
</I>&gt;<i> req.main (even req.next), the request would be scrapped and a new one
</I>&gt;<i> created, that would get to the same point before starting again. I
</I>&gt;<i> would have thousands of lines of &quot;Debug: preparing to redirect&quot;
</I>&gt;<i> before I would just have to cancel the page from loading.
</I>&gt;<i>
</I>&gt;<i> &gt; When I get a chance to at least get directory index to week as you
</I>&gt;<i> &gt; indicate what you want, then we can start stepping through these
</I>&gt;<i> &gt; others issues.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Graham
</I>&gt;<i>
</I>&gt;<i> Aaron Gallagher
</I>&gt;<i> &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">habnabit at gmail.com</A>&gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I></PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023736.html">[mod_python] Apache directory listing
</A></li>
	<LI>Next message: <A HREF="023738.html">[mod_python] Apache directory listing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23737">[ date ]</a>
              <a href="thread.html#23737">[ thread ]</a>
              <a href="subject.html#23737">[ subject ]</a>
              <a href="author.html#23737">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
