From ppercot at free.fr  Tue Jun  1 11:25:47 2004
From: ppercot at free.fr (Patrick Percot)
Date: Tue Jun  1 04:26:40 2004
Subject: [mod_python] Reloading modified scripts
Message-ID: <20040601.102547.71084749.ppercot@free.fr>

Bonjour,

Despite  the presence  of "PythonAutoReload  On" in  my  httpd.conf, the
modified  files are  not handled  correctly.  I  need to  restart Apache
server to ensure that modified code is executed.

I'm using :

Apache 2.0.49
Python 2.3.3
mod_python 3.1.3

?+
PP
-- 
Groupe Morbihannais d'Utilisateurs de Logiciels Libres http://www.tuxbihan.org
Identifiant Jabber: pp@amessage.de
GPG fingerprint = 1A4F E154 3D2C A20E E4CA  A543 7951 C5C2 E44A A0B5

Patrick Percot.

From Edward.Diener at loyaltyworks.com  Tue Jun  1 13:18:04 2004
From: Edward.Diener at loyaltyworks.com (Diener, Edward)
Date: Tue Jun  1 12:17:49 2004
Subject: [mod_python] Nested PSP
Message-ID: <D6A13264B6839A4E9008015DA826D409021A1E@exchange.loyaltyworks.com>

Can special PSP tags be nested inside one another ? As an example, can I
have
<%= AListVariable[<%= AnotherVariable % >]% > ?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://modpython.org/pipermail/mod_python/attachments/20040601/b533ba34/attachment.html
From grisha at modpython.org  Tue Jun  1 14:06:50 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Tue Jun  1 13:07:08 2004
Subject: [mod_python] Nested PSP
In-Reply-To: <D6A13264B6839A4E9008015DA826D409021A1E@exchange.loyaltyworks.com>
References: <D6A13264B6839A4E9008015DA826D409021A1E@exchange.loyaltyworks.com>
Message-ID: <20040601130449.M18639@onyx.ispol.com>


I don't think so. Once the scanner sees a '<%=' it will look for a closing
'%>' and anything else is ignored.

I'm also not sure what that would accomplish, i.e. how is

<%= AListVariable[<%= AnotherVariable % >]%> ?

different from

<%= AListVariable[AnotherVariable] %> ?

Grisha

On Tue, 1 Jun 2004, Diener, Edward wrote:

> Can special PSP tags be nested inside one another ? As an example, can I
> have
> <%= AListVariable[<%= AnotherVariable % >]% > ?
>
From Edward.Diener at loyaltyworks.com  Tue Jun  1 15:00:10 2004
From: Edward.Diener at loyaltyworks.com (Diener, Edward)
Date: Tue Jun  1 14:00:02 2004
Subject: [mod_python] Nested PSP
Message-ID: <D6A13264B6839A4E9008015DA826D409021A20@exchange.loyaltyworks.com>

> -----Original Message-----
> From: Gregory (Grisha) Trubetskoy [mailto:grisha@modpython.org] 
> Sent: Tuesday, June 01, 2004 1:07 PM
> To: Diener, Edward
> Cc: mod_python@modpython.org
> Subject: Re: [mod_python] Nested PSP
> 
> 
> 
> I don't think so. Once the scanner sees a '<%=' it will look 
> for a closing '%>' and anything else is ignored.
> 
> I'm also not sure what that would accomplish, i.e. how is
> 
> <%= AListVariable[<%= AnotherVariable % >]%> ?
> 
> different from
> 
> <%= AListVariable[AnotherVariable] %> ?

You are correct. I sometimes forget that my <%= %> PSP statement can
include any Python expression to produce the value.

From eric at ericwalstad.com  Wed Jun  2 00:22:04 2004
From: eric at ericwalstad.com (Eric Walstad)
Date: Wed Jun  2 02:22:20 2004
Subject: [mod_python] Trouble spawning a long running process...
Message-ID: <200406012322.04788.eric@ericwalstad.com>

Hi all,

I'm attempting to spawn a process in my mod_python function.  I want to run a 
long-running script in a seperate process while returning the process id to 
the client quickly.  However, the spawned process goes zombie (defunct), I 
think when the mod_python function finishes sending the response to the 
client.  Here's how I'm spawning the process:
process_id = os.spawnl(os.P_NOWAIT, BUILDISO_COMMAND)
and when I check the status of the spawned process:
# ps ax
[...]
 4229 ?        S      0:00 /usr/sbin/httpd
 4237 ?        Z      0:00 [httpd] <defunct>
It is defunct.  (The parent is dead, long live the parent!)

Do any of you have advice for a good way to keep the user from having to wait 
for long processes to finish before seeing a response from mod_python?

I'm running Fedora Core 2, mod_python-3.1.3-1, python 2.3.3, apache 2.0.49
I'm not sure if it matters, but my .htaccess file for this little app contains 
only:
AddHandler python-program .py
PythonHandler mod_python.publisher
PythonDebug On

As a bit of background, the spawned script is creating an iso file approx 45MB 
for the client to download (later).  I have it working using:
commands.getstatusoutput(BUILDISO_COMMAND)
but that makes the user wait until the child process is complete.  I just want 
to keep the user from having to stare at a an empty, spinning browser while 
the iso is built.

Many thanks for your time, wisdom and suggestions.

Best regards,

Eric.
From grisha at modpython.org  Wed Jun  2 10:47:32 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Wed Jun  2 09:47:46 2004
Subject: [mod_python] Trouble spawning a long running process...
In-Reply-To: <200406012322.04788.eric@ericwalstad.com>
References: <200406012322.04788.eric@ericwalstad.com>
Message-ID: <20040602094532.B37604@onyx.ispol.com>



On Tue, 1 Jun 2004, Eric Walstad wrote:

> As a bit of background, the spawned script is creating an iso file
> approx 45MB for the client to download (later).  I have it working
> using: commands.getstatusoutput(BUILDISO_COMMAND) but that makes the
> user wait until the child process is complete.

You could probably make it not wait by appending an ampersand (&) to the
end of the command?

Grisha
From neel at mediapulse.com  Wed Jun  2 11:03:03 2004
From: neel at mediapulse.com (Michael C. Neel)
Date: Wed Jun  2 10:02:04 2004
Subject: [mod_python] Trouble spawning a long running process...
In-Reply-To: <20040602094532.B37604@onyx.ispol.com>
References: <200406012322.04788.eric@ericwalstad.com>
	<20040602094532.B37604@onyx.ispol.com>
Message-ID: <1086184983.4015.13.camel@mike.mediapulse.com>

On Wed, 2004-06-02 at 09:47, Gregory (Grisha) Trubetskoy wrote:

> On Tue, 1 Jun 2004, Eric Walstad wrote:
> 
> > As a bit of background, the spawned script is creating an iso file
> > approx 45MB for the client to download (later).  I have it working
> > using: commands.getstatusoutput(BUILDISO_COMMAND) but that makes the
> > user wait until the child process is complete.
> 
> You could probably make it not wait by appending an ampersand (&) to the
> end of the command?
> 



You could also look into send the client status info like the old NPH
cgi scripts did.  If it's possible, you could take an email address from
the user, and add the request to a queue stored in a database (or simply
lock a file when you append to the queue).  The have a cron job running
every minute or so that looks at the queue and builds the .iso and
emails the user when it's done.

Mike
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://modpython.org/pipermail/mod_python/attachments/20040602/bdfc123e/attachment.html
From gustavo.cordova at q-voz.com  Wed Jun  2 10:35:00 2004
From: gustavo.cordova at q-voz.com (=?iso-8859-1?Q?Gustavo_C=F3rdova_Avila?=)
Date: Wed Jun  2 10:36:36 2004
Subject: [mod_python] Trouble spawning a long running process...
In-Reply-To: <200406012322.04788.eric@ericwalstad.com>
Message-ID: <!~!UENERkVCMDkAAQACAAAAAAAAAAAAAAAAABgAAAAAAAAAo5mHXnRFkU2A7MLhj8g/IMKAAAAQAAAAyecB5bo0qk+qdjgNhxu7OQEAAAAA@q-voz.com>

> 
> Hi all,
> 
> I'm attempting to spawn a process in my mod_python function.  
> I want to run a long-running script in a seperate process
> while returning the process id to the client quickly. 
> However, the spawned process goes zombie (defunct), I 
> think when the mod_python function finishes sending the 
> response to the client.  Here's how I'm spawning the process:
> process_id = os.spawnl(os.P_NOWAIT, BUILDISO_COMMAND)
> and when I check the status of the spawned process:
> # ps ax
> [...]
>  4229 ?        S      0:00 /usr/sbin/httpd
>  4237 ?        Z      0:00 [httpd] <defunct>
> It is defunct.  (The parent is dead, long live the parent!)
> 
> Do any of you have advice for a good way to keep the user 
> from having to wait for long processes to finish before
> seeing a response from mod_python?

I had a problem like this in another life, albeit it was with CGI,
but the principal might be the same.  The child process needs to
detach from it's parent, you might need to do the double-fork
trick.

> 
> ...
> 
> As a bit of background, the spawned script is creating an iso 
> file approx 45MB for the client to download (later). 
>

No wonder.  My app was doing a massive mailing to some list
subscribers, using a decidedly unefficient algorithm to do the
sending.

> 
> Many thanks for your time, wisdom and suggestions.
> 
> Best regards,
> 
> Eric.
>

You're welcome, hope this helps.

-gus


From Edward.Diener at loyaltyworks.com  Wed Jun  2 13:12:45 2004
From: Edward.Diener at loyaltyworks.com (Diener, Edward)
Date: Wed Jun  2 12:12:30 2004
Subject: [mod_python] Redirecting to a new window
Message-ID: <D6A13264B6839A4E9008015DA826D409021A23@exchange.loyaltyworks.com>

When I call psp.redirect(some_url), the redirection occurs, I believe in
the same window to which my Python code is handling the form so that the
redirection replaces the previous content in the window. Is there a way
to redirect and tell the browser to open up a separate window while
keeping the current window open, or even of redirecting at another
parent window which is already open ?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://modpython.org/pipermail/mod_python/attachments/20040602/fe6b8d09/attachment.html
From grisha at modpython.org  Wed Jun  2 13:43:05 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Wed Jun  2 12:43:23 2004
Subject: [mod_python] Trouble spawning a long running process...
In-Reply-To: <200406012322.04788.eric@ericwalstad.com>
References: <200406012322.04788.eric@ericwalstad.com>
Message-ID: <20040602124105.M37604@onyx.ispol.com>



On Tue, 1 Jun 2004, Eric Walstad wrote:

> Do any of you have advice for a good way to keep the user from having to wait
> for long processes to finish before seeing a response from mod_python?

Here is another idea - instead of spawning, register it as a cleanup
(req.register_cleanup()). It will execute within the Apache process, but
after the request is processed, and shouldn't really interfere with
anything.

Grisha
From eric at ericwalstad.com  Wed Jun  2 11:27:38 2004
From: eric at ericwalstad.com (Eric Walstad)
Date: Wed Jun  2 13:27:43 2004
Subject: [mod_python] Trouble spawning a long running process...
In-Reply-To: <20040602124105.M37604@onyx.ispol.com>
References: <200406012322.04788.eric@ericwalstad.com>
	<20040602124105.M37604@onyx.ispol.com>
Message-ID: <200406021027.38991.eric@ericwalstad.com>

Hi Grisha and the gang...
On Wednesday 02 June 2004 09:43, Gregory (Grisha) Trubetskoy wrote:
> On Tue, 1 Jun 2004, Eric Walstad wrote:
> > Do any of you have advice for a good way to keep the user from having to
> > wait for long processes to finish before seeing a response from
> > mod_python?
>
> Here is another idea - instead of spawning, register it as a cleanup
> (req.register_cleanup()). It will execute within the Apache process, but
> after the request is processed, and shouldn't really interfere with
> anything.

Thanks to you, Mike and Gus for your replies.

req.register_cleanup() looks like a good match.  I doubt I would have ever 
found register_cleanup on my own!  Do you have any tips on how to tell when 
the cleanup process has completed?  I'm currently checking for the existence 
of the generated iso file, but there's a brief period where the file exists 
(os.path.exists) but has not been completely written yet.  That's probably 
not a problem, but might be if I try to  stream the file to the client while 
it's being written by mkisofs (that's my next hurdle).  Checking 
os.path.exists just feels like a bit of a hack, that's all.  Any thoughts?

If register_cleanup doesn't work, I'll give "nohup sudo 'mycommand' &" a try 
and live with the "exists" hack.

Thanks again for your help.

Best regards,

Eric.
From ccurvey at earthlink.net  Wed Jun  2 15:03:25 2004
From: ccurvey at earthlink.net (Chris Curvey)
Date: Wed Jun  2 13:50:13 2004
Subject: [mod_python] Redirecting to a new window
In-Reply-To: <D6A13264B6839A4E9008015DA826D409021A23@exchange.loyaltyworks.com>
References: <D6A13264B6839A4E9008015DA826D409021A23@exchange.loyaltyworks.com>
Message-ID: <40BE166D.9070406@earthlink.net>

You would have to do this on the original page, using JavaScript.

Diener, Edward wrote:

> When I call psp.redirect(some_url), the redirection occurs, I believe 
> in the same window to which my Python code is handling the form so 
> that the redirection replaces the previous content in the window. Is 
> there a way to redirect and tell the browser to open up a 
> separate window while keeping the current window open, or even of 
> redirecting at another parent window which is already open ?
>
>------------------------------------------------------------------------
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python
>  
>


From reed at intersiege.com  Wed Jun  2 14:58:14 2004
From: reed at intersiege.com (Reed L. O'Brien)
Date: Wed Jun  2 14:30:59 2004
Subject: [mod_python] Re: FreeBSD 4.9 | python 2.3.4 | apache 2.0.49 |
	mod_python 3.1.3
In-Reply-To: <000001c4473d$1d21ad60$6501a8c0@mali>
References: <000001c4473d$1d21ad60$6501a8c0@mali>
Message-ID: <c9l4fo$tbh$1@sea.gmane.org>

Compile without threads.

Perica Zivkovic wrote:
> Hi,
> 
> sorry for posting this but I checked all documentation and google and
> didn't find any help...
> 
> I installed FreeBSD 4.9 and on that clean install I installed from
> source (not ports) following:
> 
> 1. apache 2.0.49
> 2. python 2.3.4
> 3. mod_python 3.1.3 (configured with apxs...)
> 
> everithing was smooth and easy but...
> 
> I included "LoadModule ..." line provided to me by mod python install
> script and after I attempt to start apache I get this:
> 
> ----------------------------
> Syntax error on line 233 of /usr/local/apache2/conf/httpd.conf:
> Cannot load /usr/local/apache2/modules/mod_python.so into server:
> /usr/local/apache2/modules/mod_python.so: Undefined symbol
> "pthread_self"
> ----------------------------
> 
> I'm not posting this after first failed attempt... I tried to reinstall
> an do this three times but no luck...
> 
> Please help
> 
> grt.
> 
> Perica

From reed at intersiege.com  Wed Jun  2 15:31:34 2004
From: reed at intersiege.com (Reed L. O'Brien)
Date: Wed Jun  2 14:41:03 2004
Subject: [mod_python] Re: Anyone successfully running mod_python 3.1.3/PSP
	on FreeBSD?
In-Reply-To: <1082963982.30812.14.camel@tpk8.abo.fi>
References: <1082963982.30812.14.camel@tpk8.abo.fi>
Message-ID: <c9l6e9$4ek$1@sea.gmane.org>

Petter Holmstr?m wrote:

> Hello,
> 
> Is there anybody out there who's running mod_python 3.1.3/Python Server
> Pages successfully on FreeBSD? If so, how did you install it? What
> version of Python are you using? The reason I ask this is that I can't
> get it to work properly. I've installed both Python 2.3 and mod_python
> 3.1.3 from the Ports collection (on FreeBSD 5.2.1). "Ordinary"
> mod_python scripts work just fine, but everytime I try to use PSP I get
> this error message:
> 
> Mod_python error: "PythonHandler mod_python.psp"
> 
> Traceback (most recent call last):
> 
>   File "/usr/local/lib/python2.3/site-packages/mod_python/apache.py", line 287, in HandlerDispatch
>     log=debug)
> 
>   File "/usr/local/lib/python2.3/site-packages/mod_python/apache.py", line 457, in import_module
>     module = imp.load_module(mname, f, p, d)
> 
>   File "/usr/local/lib/python2.3/site-packages/mod_python/psp.py", line 20, in ?
>     import apache, Session, util, _psp
> 
>   File "/usr/local/lib/python2.3/site-packages/mod_python/Session.py", line 35, in ?
>     tempdir = tempfile.gettempdir()
> 
>   File "/usr/local/lib/python2.3/tempfile.py", line 242, in gettempdir
>     tempdir = _get_default_tempdir()
> 
>   File "/usr/local/lib/python2.3/tempfile.py", line 188, in _get_default_tempdir
>     raise IOError, (_errno.ENOENT,
> 
> IOError: [Errno 2] No usable temporary directory found in ['/tmp', '/var/tmp', '/usr/tmp', '/']
> 
Recompile Python without threads.
cd /usr/local/ports/python
make deinstall
make config
uncheck threads and -->OK
make reinstall

THen you will prolly have  to deinstall reinstall mod_python and 
reuncomment it in httpd.conf.  THen restart apache2. 
mod_python.publisher should work then.

Unfortunatley I need/want to use mpServlets 
(http://home.comcast.net/~d.popowich/mpservlets)
  but it fails on not being able to find module thread...  Any ideas on 
how to chase it down??

I don't know where it stems but trac and plone/zope run fine with 
threads compiled  even with huge stack.  Only fail I have seen is w/ mp. 
  Still a nice mod though.

Reed L. O'Brien
4.6692016090

> Now, I've read somewhere that this might have something to do with
> threads, but I haven't been able to find more information on the
> subject. I'd like to know whether this is an OS, an Apache, a mod_python
> or a python-bug, and how to fix it.
> 
> Thanks in advance,
> 
> -Petter-
> 
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From grisha at modpython.org  Wed Jun  2 15:56:15 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Wed Jun  2 14:56:25 2004
Subject: [mod_python] Trouble spawning a long running process...
In-Reply-To: <200406021027.38991.eric@ericwalstad.com>
References: <200406012322.04788.eric@ericwalstad.com>
	<20040602124105.M37604@onyx.ispol.com>
	<200406021027.38991.eric@ericwalstad.com>
Message-ID: <20040602145444.W41893@onyx.ispol.com>



On Wed, 2 Jun 2004, Eric Walstad wrote:

> req.register_cleanup() looks like a good match.  I doubt I would have ever
> found register_cleanup on my own!  Do you have any tips on how to tell when
> the cleanup process has completed?  I'm currently checking for the existence
> of the generated iso file, but there's a brief period where the file exists
> (os.path.exists) but has not been completely written yet.  That's probably
> not a problem, but might be if I try to  stream the file to the client while
> it's being written by mkisofs (that's my next hurdle).  Checking
> os.path.exists just feels like a bit of a hack, that's all.  Any thoughts?

Probably the easiest thing would be to write to a temporary file name and
rename it when its done.

Grisha
From grisha at modpython.org  Wed Jun  2 15:58:05 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Wed Jun  2 14:58:09 2004
Subject: [mod_python] Re: FreeBSD 4.9 | python 2.3.4 | apache 2.0.49 |
	mod_python 3.1.3
In-Reply-To: <c9l4fo$tbh$1@sea.gmane.org>
References: <000001c4473d$1d21ad60$6501a8c0@mali> <c9l4fo$tbh$1@sea.gmane.org>
Message-ID: <20040602145646.L41893@onyx.ispol.com>


There is also a wrokaround, it is documented in the mod_python FreeBSD
port, check out /usr/ports/www/mod_python3/pkg-message

Grisha

On Wed, 2 Jun 2004, Reed L. O'Brien wrote:

> Compile without threads.
>
> Perica Zivkovic wrote:
> > Hi,
> >
> > sorry for posting this but I checked all documentation and google and
> > didn't find any help...
> >
> > I installed FreeBSD 4.9 and on that clean install I installed from
> > source (not ports) following:
> >
> > 1. apache 2.0.49
> > 2. python 2.3.4
> > 3. mod_python 3.1.3 (configured with apxs...)
> >
> > everithing was smooth and easy but...
> >
> > I included "LoadModule ..." line provided to me by mod python install
> > script and after I attempt to start apache I get this:
> >
> > ----------------------------
> > Syntax error on line 233 of /usr/local/apache2/conf/httpd.conf:
> > Cannot load /usr/local/apache2/modules/mod_python.so into server:
> > /usr/local/apache2/modules/mod_python.so: Undefined symbol
> > "pthread_self"
> > ----------------------------
> >
> > I'm not posting this after first failed attempt... I tried to reinstall
> > an do this three times but no luck...
> >
> > Please help
> >
> > grt.
> >
> > Perica
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From reed at intersiege.com  Wed Jun  2 16:47:29 2004
From: reed at intersiege.com (Reed L. O'Brien)
Date: Wed Jun  2 15:47:38 2004
Subject: [mod_python] Re: FreeBSD 4.9 | python 2.3.4 | apache 2.0.49 |
	mod_python 3.1.3
In-Reply-To: <20040602145646.L41893@onyx.ispol.com>
References: <000001c4473d$1d21ad60$6501a8c0@mali> <c9l4fo$tbh$1@sea.gmane.org>
	<20040602145646.L41893@onyx.ispol.com>
Message-ID: <c9lasl$j48$1@sea.gmane.org>

You are so absolutely right Grisha:

I had that implemented in 4.9 but upgraded to 5.2.1 and forgot about it.
The work around is to add

LD_PRELOAD=/usr/lib/libc_r.so ## or libpthread.so
export LD_PRELOAD

in /usr/local/sbin/envvars

and restart apache
This worked in 5.2.1 just now as well.

Reed O'Brien
4.6692016090

Gregory (Grisha) Trubetskoy wrote:
> There is also a wrokaround, it is documented in the mod_python FreeBSD
> port, check out /usr/ports/www/mod_python3/pkg-message
> 
> Grisha
> 
> On Wed, 2 Jun 2004, Reed L. O'Brien wrote:
> 
> 
>>Compile without threads.
>>
>>Perica Zivkovic wrote:
>>
>>>Hi,
>>>
>>>sorry for posting this but I checked all documentation and google and
>>>didn't find any help...
>>>
>>>I installed FreeBSD 4.9 and on that clean install I installed from
>>>source (not ports) following:
>>>
>>>1. apache 2.0.49
>>>2. python 2.3.4
>>>3. mod_python 3.1.3 (configured with apxs...)
>>>
>>>everithing was smooth and easy but...
>>>
>>>I included "LoadModule ..." line provided to me by mod python install
>>>script and after I attempt to start apache I get this:
>>>
>>>----------------------------
>>>Syntax error on line 233 of /usr/local/apache2/conf/httpd.conf:
>>>Cannot load /usr/local/apache2/modules/mod_python.so into server:
>>>/usr/local/apache2/modules/mod_python.so: Undefined symbol
>>>"pthread_self"
>>>----------------------------
>>>
>>>I'm not posting this after first failed attempt... I tried to reinstall
>>>an do this three times but no luck...
>>>
>>>Please help
>>>
>>>grt.
>>>
>>>Perica
>>
>>_______________________________________________
>>Mod_python mailing list
>>Mod_python@modpython.org
>>http://mailman.modpython.org/mailman/listinfo/mod_python
>>

From Edward.Diener at loyaltyworks.com  Wed Jun  2 16:59:49 2004
From: Edward.Diener at loyaltyworks.com (Diener, Edward)
Date: Wed Jun  2 15:59:23 2004
Subject: [mod_python] Redirecting to a new window
Message-ID: <D6A13264B6839A4E9008015DA826D409021A24@exchange.loyaltyworks.com>

I couldn't understand your answer. From within my PSP page I have Python
code and need to be able to redirect to either another URL in the
current window or another URL in an already opened window within the
browser. Are you saying that Python can not do this but Javascript can ?
I find that depressing to believe. Surely Python should have as much
access to HTTP as Javascript does ? 

Maybe I should rephrase my question. How do I tell the browser to close
my current window and open a URL in another window from within Python ? 

> -----Original Message-----
> From: Chris Curvey [mailto:ccurvey@earthlink.net] 
> Sent: Wednesday, June 02, 2004 2:03 PM
> To: Diener, Edward; mod_python@modpython.org
> Subject: Re: [mod_python] Redirecting to a new window
> 
> 
> You would have to do this on the original page, using JavaScript.
> 
> Diener, Edward wrote:
> 
> > When I call psp.redirect(some_url), the redirection occurs, 
> I believe
> > in the same window to which my Python code is handling the form so 
> > that the redirection replaces the previous content in the 
> window. Is 
> > there a way to redirect and tell the browser to open up a 
> > separate window while keeping the current window open, or even of 
> > redirecting at another parent window which is already open ?
> >
> >-------------------------------------------------------------
> ----------
> >-
> >
> >_______________________________________________
> >Mod_python mailing list
> >Mod_python@modpython.org 
> >http://mailman.modpython.org/mailman/listinfo/mod_python
> >  
> >
> 
> 
> 

From nick at dd.revealed.net  Wed Jun  2 16:06:19 2004
From: nick at dd.revealed.net (Nick)
Date: Wed Jun  2 16:06:40 2004
Subject: [mod_python] Redirecting to a new window
In-Reply-To: <D6A13264B6839A4E9008015DA826D409021A24@exchange.loyaltyworks.com>
References: <D6A13264B6839A4E9008015DA826D409021A24@exchange.loyaltyworks.com>
Message-ID: <40BE333B.1090901@dd.revealed.net>

Diener, Edward wrote:

> Maybe I should rephrase my question. How do I tell the browser to close
> my current window and open a URL in another window from within Python ? 

Python is processed on the server, and can therefore only affect what the 
browser sees coming from the server.  This generally means the server 
response headers, HTML, and other content coming directly from the server.

If you want to control the client (that is, the browser), then you need to 
use a client/browser side technology to do that, such as Javascript.  The 
extent that Python can help you is only in that your Python code could 
generate the correct Javascript to control the browser in the way you want.

Nick
From eric at ericwalstad.com  Wed Jun  2 14:40:00 2004
From: eric at ericwalstad.com (Eric Walstad)
Date: Wed Jun  2 16:40:06 2004
Subject: [mod_python] Redirecting to a new window
In-Reply-To: <40BE333B.1090901@dd.revealed.net>
References: <D6A13264B6839A4E9008015DA826D409021A24@exchange.loyaltyworks.com>
	<40BE333B.1090901@dd.revealed.net>
Message-ID: <200406021340.00706.eric@ericwalstad.com>

Hi Edward,
On Wednesday 02 June 2004 13:06, Nick wrote:
> Diener, Edward wrote:
> > Maybe I should rephrase my question. How do I tell the browser to close
> > my current window and open a URL in another window from within Python ?

If I understand your question, you want a new window to pop up when the user 
clicks a link in their browser.  This can't be done directly with mod_python.  
The trick is to have your mod_python render a page that has either an anchor 
tag with a target attribute[1, 2] or java script that tells your browser to 
do something similar[3].  Remember, mod_python simply spews data to the 
client (browser).  Your browser has to figure out what to do with that data 
once it receives it.  For good reasons, mod_python cannot directly control 
the user's browser.  Think of it as writing mod_python code that writes code 
(html or javascript) that the client will interpret.

[1]<http://www.w3.org/TR/html401/present/frames.html#adef-target>
[2]<http://www.google.com/search?q=html+open+new+window>
[3]<http://www.google.com/search?q=javascript+open+new+window>

I hope that helps.

Best regards,

Eric.

From opera7 at gmx.net  Thu Jun  3 14:06:54 2004
From: opera7 at gmx.net (opera7)
Date: Thu Jun  3 06:05:56 2004
Subject: [mod_python] Wrong link for "download the full archive" ???
In-Reply-To: <Pine.BSF.4.55.0405281853160.39275@saint.ironport.com>
References: <Pine.BSF.4.55.0405281853160.39275@saint.ironport.com>
Message-ID: <125180115593.20040603130654@gmx.net>

Hello all,

KS> There is a link to "download the full raw archive" on
KS> the Mod_python archives page at -
KS> http://www.modpython.org/pipermail/mod_python/

KS> But this link downloads a 1.3 MB file and clearly
KS> doesn't have the entire content while the text
KS> beside the link claims it to be a 15MB file,

KS> -Krishna

Could someone fix that?

-- 
Best regards, dvska

From grisha at modpython.org  Thu Jun  3 11:47:32 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Thu Jun  3 10:47:48 2004
Subject: [mod_python] Wrong link for "download the full archive" ???
In-Reply-To: <125180115593.20040603130654@gmx.net>
References: <Pine.BSF.4.55.0405281853160.39275@saint.ironport.com>
	<125180115593.20040603130654@gmx.net>
Message-ID: <20040603104708.M67946@onyx.ispol.com>


I think it's fixed now :-)

sorry for the delay

Grisha

On Thu, 3 Jun 2004, opera7 wrote:

> Hello all,
>
> KS> There is a link to "download the full raw archive" on
> KS> the Mod_python archives page at -
> KS> http://www.modpython.org/pipermail/mod_python/
>
> KS> But this link downloads a 1.3 MB file and clearly
> KS> doesn't have the entire content while the text
> KS> beside the link claims it to be a 15MB file,
>
> KS> -Krishna
>
> Could someone fix that?
>
> --
> Best regards, dvska
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From dpopowich at mtrsd.k12.ma.us  Thu Jun  3 12:03:44 2004
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Thu Jun  3 11:04:52 2004
Subject: [mod_python] uploaded file names
Message-ID: <16575.15824.623590.67038@gargle.gargle.HOWL>


This is not really a mod_python question, but I figure a number of you
have had to deal with this.

On a windows client, let's say we have a file named:

  c:\foo\bar\baz

which is what a user specifies in an HTML INPUT file widget.

If the client is a mozilla browser the file name is returned as the
basename of whatever was specified, so 'baz'.  If the client is IE the
file name is returned as the full path name specified, so
r'c:\foo\bar\baz'.  Leave it to M$ to complicate matters.

This means I need to code my handler to expect either a basename or a
full pathname.  All I want is the basename.  Complicating the matter
is my handler is on a linux box, so my server-side python is compiled
to handle unix paths, not windows paths (so I can't use functions like
os.path.splitdrive).

My solution, which I fear may be braindead, is to do this to all
incoming filenames:

  filename = os.path.basename(filename.replace('\\', '/'))

This appears to work, but I'm wondering if anyone else has a better
solution.

Thanks,

Daniel

From nick at dd.revealed.net  Thu Jun  3 11:20:26 2004
From: nick at dd.revealed.net (Nick)
Date: Thu Jun  3 11:20:34 2004
Subject: [mod_python] uploaded file names
In-Reply-To: <16575.15824.623590.67038@gargle.gargle.HOWL>
References: <16575.15824.623590.67038@gargle.gargle.HOWL>
Message-ID: <40BF41BA.709@dd.revealed.net>

Daniel J. Popowich wrote:

> My solution, which I fear may be braindead, is to do this to all
> incoming filenames:
> 
>   filename = os.path.basename(filename.replace('\\', '/'))

You may want to test the user agent first for IE before replacing the \ 
wholesale, but in general I don't think people put backslashes in filenames. 
    Personally, I do:

try:
     filename[filename.rindex('\\') + 1:]
except ValueError:
     pass

Nick
From davidf at sjsoft.com  Thu Jun  3 18:31:32 2004
From: davidf at sjsoft.com (David Fraser)
Date: Thu Jun  3 11:31:23 2004
Subject: [mod_python] uploaded file names
In-Reply-To: <16575.15824.623590.67038@gargle.gargle.HOWL>
References: <16575.15824.623590.67038@gargle.gargle.HOWL>
Message-ID: <40BF4454.4070307@sjsoft.com>

Daniel J. Popowich wrote:

>This is not really a mod_python question, but I figure a number of you
>have had to deal with this.
>
>On a windows client, let's say we have a file named:
>
>  c:\foo\bar\baz
>
>which is what a user specifies in an HTML INPUT file widget.
>
>If the client is a mozilla browser the file name is returned as the
>basename of whatever was specified, so 'baz'.  If the client is IE the
>file name is returned as the full path name specified, so
>r'c:\foo\bar\baz'.  Leave it to M$ to complicate matters.
>
>This means I need to code my handler to expect either a basename or a
>full pathname.  All I want is the basename.  Complicating the matter
>is my handler is on a linux box, so my server-side python is compiled
>to handle unix paths, not windows paths (so I can't use functions like
>os.path.splitdrive).
>
>My solution, which I fear may be braindead, is to do this to all
>incoming filenames:
>
>  filename = os.path.basename(filename.replace('\\', '/'))
>
>This appears to work, but I'm wondering if anyone else has a better
>solution.
>
>Thanks,
>
>Daniel
>  
>
Hi Daniel

We've recently had exactly the same problem and solved it in a similar way:
      # IE submits the whole path. lets just get the filename in this case
      if "\\" in self.filename:
        self.filename = self.filename[self.filename.rfind("\\")+1:]
I reckon it should be classified as a [very mild] security vulnerability 
in IE that they do this - do I really want websites to know the file 
layout of my local system?
Anyway sorry but I don't think you're going to find a better solution... 
although I'd be interested if there was one...

David

From dpopowich at mtrsd.k12.ma.us  Thu Jun  3 12:34:53 2004
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Thu Jun  3 11:36:10 2004
Subject: [mod_python] uploaded file names
In-Reply-To: <40BF41BA.709@dd.revealed.net>
References: <16575.15824.623590.67038@gargle.gargle.HOWL>
	<40BF41BA.709@dd.revealed.net>
Message-ID: <16575.17693.879478.940442@gargle.gargle.HOWL>


Nick writes:
> Daniel J. Popowich wrote:
> 
> > My solution, which I fear may be braindead, is to do this to all
> > incoming filenames:
> > 
> >   filename = os.path.basename(filename.replace('\\', '/'))
> 
> You may want to test the user agent first for IE before replacing the \ 
> wholesale

Good point.

> but in general I don't think people put backslashes in filenames.

But you can't count on that and if the user uses the browse button to
find the file, then the path WILL have backslashes.

>     Personally, I do:
> 
> try:
>      filename[filename.rindex('\\') + 1:]
> except ValueError:
>      pass

Thanks,

Dan

From aplisson-modpython at stochastique.net  Thu Jun  3 19:06:46 2004
From: aplisson-modpython at stochastique.net (Adrien Plisson)
Date: Thu Jun  3 12:10:46 2004
Subject: [mod_python] uploaded file names
In-Reply-To: <16575.17693.879478.940442@gargle.gargle.HOWL>
References: <16575.15824.623590.67038@gargle.gargle.HOWL>	<40BF41BA.709@dd.revealed.net>
	<16575.17693.879478.940442@gargle.gargle.HOWL>
Message-ID: <40BF4C96.7050008@stochastique.net>

Daniel J. Popowich wrote:
 > Nick writes:
 >
 >>Daniel J. Popowich wrote:
 >>
 >>>My solution, which I fear may be braindead, is to do this to all
 >>>incoming filenames:
 >>>
 >>>  filename = os.path.basename(filename.replace('\\', '/'))
 >>
 >>You may want to test the user agent first for IE before replacing the \
 >>wholesale
 >
 > Good point.

I don't think so...

IE does not only ship with windows but may also be installed on Macintosh
systems. The macintosh does not use '\' as a path separator (it uses ':' if I
remember correctly).

-- 
rien



From krishna at ironport.com  Thu Jun  3 15:46:20 2004
From: krishna at ironport.com (Krishna Srinivasan)
Date: Thu Jun  3 17:46:29 2004
Subject: [mod_python] Session Cleanups - Still a mystery
Message-ID: <20040603144329.X1153@saint.ironport.com>


Greetings.

Can someone please explain how exactly sessions are cleaned up ?
I am seeing a constant increase in the /tmp/mp_sess.dbm though
I believe I am doing a 'delete' (and cleanup).

I had posted this question some days back, here :
http://modpython.org/pipermail/mod_python/2004-May/015706.html

For each session, whenever a user does some action (which internally
involves creating objects and storing them in the session dictionary),
I do a "req.sess.save".
[Where req.sess = Session.Session()]

And then when they do a 'logout' - I do this :
req.sess.delete()

However,  the size of mp_sess.dbm in /tmp is on the rise
always. Can someone please tell me what else I should be doing ?

I store everything in a simple dictionary.
req.sess["mydict"] = <mydictionary>
The 'mydictionary' object keeps expanding based on user-actions.
I even do a 'del' to remove objects from this 'mydictionary'
object to keep the space down.

System - FreeBSD 4.7 - Apache 2.0.48 - Python 2.2.3 - ModPy 3.1.3

Please let me know how to fix this.

Thanks,
Krishna.

From nttaylor at cs.uchicago.edu  Thu Jun  3 18:29:46 2004
From: nttaylor at cs.uchicago.edu (Noel Taylor)
Date: Thu Jun  3 18:29:48 2004
Subject: [mod_python] relative paths in psp
Message-ID: <Pine.LNX.4.58.0406031720400.2810@swank.cs.uchicago.edu>


Hello all,

I'm trying to embed python in html using mod_python.

I've gotten it up and running successfully, but I have a question about
opening files and relative paths from within the embedded python script.

If myfile.psp is as follows:

<html>
<%
f = open('insertthis.html','rb').read()
req.write(f)
%>
</html>

I get a "no such file" error on 'insertthis.html', which is not such a
mystery since displaying sys.path reveals it as:

/usr/lib/python23.zip/usr/lib/python2.3/usr/lib/python2.3/plat-linux2/usr/lib/python2.3/lib-tk/usr/lib/python2.3/lib-dynload/usr/lib/python2.3/site-packages

So I can make the above code work if I use an absolute path, but is there
any way to make it work using a relative path, where '.' is understood to
be the directory where the .psp file is located?

with thanks,

nttaylor
From terry.macdonald at dsl.pipex.com  Fri Jun  4 01:54:59 2004
From: terry.macdonald at dsl.pipex.com (Terry MacDonald)
Date: Thu Jun  3 19:55:17 2004
Subject: [mod_python] uploaded file names
In-Reply-To: <40BF4C96.7050008@stochastique.net>
References: <16575.15824.623590.67038@gargle.gargle.HOWL>
	<40BF41BA.709@dd.revealed.net>
	<16575.17693.879478.940442@gargle.gargle.HOWL>
	<40BF4C96.7050008@stochastique.net>
Message-ID: <1086306898.14370.10.camel@bigmac.taumu.com>

Using IE is bad enough but if you have a Mac and you are using IE then
you deserve to have sites not work for you!

 ;3)


 Plisson wrote:
> Daniel J. Popowich wrote:
>  > Nick writes:
>  >
>  >>Daniel J. Popowich wrote:
>  >>
>  >>>My solution, which I fear may be braindead, is to do this to all
>  >>>incoming filenames:
>  >>>
>  >>>  filename = os.path.basename(filename.replace('\\', '/'))
>  >>
>  >>You may want to test the user agent first for IE before replacing the \
>  >>wholesale
>  >
>  > Good point.
> 
> I don't think so...
> 
> IE does not only ship with windows but may also be installed on Macintosh
> systems. The macintosh does not use '\' as a path separator (it uses ':' if I
> remember correctly).
-- 
Terry
Registered Linux User # 311806
www.taumu.com


From grisha at modpython.org  Thu Jun  3 21:35:32 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Thu Jun  3 20:35:42 2004
Subject: [mod_python] Session Cleanups - Still a mystery
In-Reply-To: <20040603144329.X1153@saint.ironport.com>
References: <20040603144329.X1153@saint.ironport.com>
Message-ID: <20040603203245.A77407@onyx.ispol.com>


Session cleanups should happen randomly with about 1 in 1000 chance (1 out
of 1000 session requests will trigger a cleanup). During a cleanup, all
expired sessions should get deleted from the dmb.

How big is the dmb getting that you are concerned with space?

Grisha

On Thu, 3 Jun 2004, Krishna Srinivasan wrote:

>
> Greetings.
>
> Can someone please explain how exactly sessions are cleaned up ?
> I am seeing a constant increase in the /tmp/mp_sess.dbm though
> I believe I am doing a 'delete' (and cleanup).
>
> I had posted this question some days back, here :
> http://modpython.org/pipermail/mod_python/2004-May/015706.html
>
> For each session, whenever a user does some action (which internally
> involves creating objects and storing them in the session dictionary),
> I do a "req.sess.save".
> [Where req.sess = Session.Session()]
>
> And then when they do a 'logout' - I do this :
> req.sess.delete()
>
> However,  the size of mp_sess.dbm in /tmp is on the rise
> always. Can someone please tell me what else I should be doing ?
>
> I store everything in a simple dictionary.
> req.sess["mydict"] = <mydictionary>
> The 'mydictionary' object keeps expanding based on user-actions.
> I even do a 'del' to remove objects from this 'mydictionary'
> object to keep the space down.
>
> System - FreeBSD 4.7 - Apache 2.0.48 - Python 2.2.3 - ModPy 3.1.3
>
> Please let me know how to fix this.
>
> Thanks,
> Krishna.
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From krishna at ironport.com  Thu Jun  3 20:17:45 2004
From: krishna at ironport.com (Krishna Srinivasan)
Date: Thu Jun  3 22:17:34 2004
Subject: [mod_python] Session Cleanups - Still a mystery
In-Reply-To: <20040603203245.A77407@onyx.ispol.com>
References: <20040603144329.X1153@saint.ironport.com>
	<20040603203245.A77407@onyx.ispol.com>
Message-ID: <20040603173706.M17210@saint.ironport.com>


Greetings.

When I said "cleanup", I meant session-deletion
when I explicitly call "sess.invalidate()".
(I apologize for the confusion).

I wrote some print(to file) statements into the
Session.py file and tested my app. Just one user(me),
doing one set of transactions - one login, few actions,
logout.

I find that when I call "sess.invalidate()" the code
goes all the way to "do_delete()" and then fails in
the try-clause (due to KeyError). 'self._sid' is not
there in the dbm. Why is this failing ? I see that
the code just does a 'pass' on that (key)error.

And I put in a print to show my session-id when it's
new - however, during one session, I get back two prints
- so there are two sessions. Could it be because of a
request to a different server for, say, an image ??
[Just a guess]

Here is one more question, I cannot read the
values of the dict from a python cli.

prompt> cd /tmp
prompt> python
>>> import bsddb
>>> a = bsddb.hashopen("mp_sess.dbm", "r")
>>> a.keys()
['55d6151503a8bb61251ce6027fbc065dd', 'afea89bd5eb5d836ec4939615dffa8b22']
>>> a['55d6151503a8bb61251ce6027fbc065dd']
Traceback (most recent call last):
  File "<stdin>", line 1, in ?
  KeyError: 55d6151503a8bb61251ce6027fbc065dd
>>>

However, I could say something like,
>>> a.first()
And I get back a pickled-object as str.
[I could keep doing a.next() too and it works]

Am I doing something wrong here ??

> Session cleanups should happen randomly

Thanks, I finally did RTFM and figured that out.
(and how to set it to a different number if I need to
via Session.CLEANUP_CHANCE)

> How big is the dmb getting that you are concerned with space?

Like I said, my problem is session-deletion is not getting
done properly. And since I store large-objects in the
session-dictionary, it gets large. And that's how I
noticed.

Looking forward to helpful suggestions/hints,

Thanks,
Krishna.





On Thu, 3 Jun 2004, Gregory (Grisha) Trubetskoy wrote:

> Date: Thu, 3 Jun 2004 20:35:32 -0400 (EDT)
> From: "Gregory (Grisha) Trubetskoy" <grisha@modpython.org>
> To: Krishna Srinivasan <krishna@ironport.com>
> Cc: Modpython <Mod_python@modpython.org>
> Subject: Re: [mod_python] Session Cleanups - Still a mystery
>
>
> Session cleanups should happen randomly with about 1 in 1000 chance (1 out
> of 1000 session requests will trigger a cleanup). During a cleanup, all
> expired sessions should get deleted from the dmb.
>
> How big is the dmb getting that you are concerned with space?
>
> Grisha
>
> On Thu, 3 Jun 2004, Krishna Srinivasan wrote:
>
> >
> > Greetings.
> >
> > Can someone please explain how exactly sessions are cleaned up ?
> > I am seeing a constant increase in the /tmp/mp_sess.dbm though
> > I believe I am doing a 'delete' (and cleanup).
> >
> > I had posted this question some days back, here :
> > http://modpython.org/pipermail/mod_python/2004-May/015706.html
> >
> > For each session, whenever a user does some action (which internally
> > involves creating objects and storing them in the session dictionary),
> > I do a "req.sess.save".
> > [Where req.sess = Session.Session()]
> >
> > And then when they do a 'logout' - I do this :
> > req.sess.delete()
> >
> > However,  the size of mp_sess.dbm in /tmp is on the rise
> > always. Can someone please tell me what else I should be doing ?
> >
> > I store everything in a simple dictionary.
> > req.sess["mydict"] = <mydictionary>
> > The 'mydictionary' object keeps expanding based on user-actions.
> > I even do a 'del' to remove objects from this 'mydictionary'
> > object to keep the space down.
> >
> > System - FreeBSD 4.7 - Apache 2.0.48 - Python 2.2.3 - ModPy 3.1.3
> >
> > Please let me know how to fix this.
> >
> > Thanks,
> > Krishna.
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
>
From jryan at qutang.net  Fri Jun  4 21:21:41 2004
From: jryan at qutang.net (Justin Ryan)
Date: Fri Jun  4 21:21:48 2004
Subject: [mod_python] mod_python / mod_php4 w/apache 2
Message-ID: <B2E5D0F4-B68E-11D8-A6A9-000D93AD1DB8@qutang.net>

Hola, Como Estas ;)

I'm trying to get php 4.3.7 and mod_python 3.1.3 working together under 
apache 2.0.48.

I built php with:

   ./configure --with-pgsql --with-apxs2
   make; make install

mod_python:

   ./configure
   make; make install

Both modules load and seem to work ok alone, but if I load both modules 
(regardless of order), I get 'the document contains no data' from my 
browser.

I experienced conflicts between mod_python and php before, but I 
thought the situation had improved under apache2.

Any help is much appreciated!

Cheers,

~=JR

From jryan at qutang.net  Fri Jun  4 22:40:54 2004
From: jryan at qutang.net (Justin Ryan)
Date: Fri Jun  4 22:40:57 2004
Subject: mod_python on OSX/Panther (was Re: [mod_python] mod_python / mod_php4
	w/apache 2)
In-Reply-To: <B2E5D0F4-B68E-11D8-A6A9-000D93AD1DB8@qutang.net>
References: <B2E5D0F4-B68E-11D8-A6A9-000D93AD1DB8@qutang.net>
Message-ID: <C41F9BC8-B699-11D8-A6A9-000D93AD1DB8@qutang.net>

Ok sorry, it looks like my first round of tests were a bit misleading...

looks like my installation of mod_python is taking apache2 down.  I can 
have both php / mod_python or just mod_python loaded, with no handlers 
registered, and everything works fine..

If I define a handlermodule (even mod_python.publisher, for 
simplicity's sake), I get this error trying to load any url (even 
/index.htm).

[Fri Jun 04 21:30:46 2004] [error] make_obcallback: could not import 
mod_python.apache.ImportError: No module named mod_python.apache

I'm running on Mac OS X P anther 10.3.3, using apache2 from the stable 
release of fink, mod_python built from source against apple's python.

FWIW, I would be using the system apache/php but I can't build 
mod_python 2.7.10 against apple's python for some reason.

Cheers,

~=JR

On Jun 4, 2004, at 8:21 PM, Justin Ryan wrote:

> Hola, Como Estas ;)
>
> I'm trying to get php 4.3.7 and mod_python 3.1.3 working together 
> under apache 2.0.48.
>
> I built php with:
>
>   ./configure --with-pgsql --with-apxs2
>   make; make install
>
> mod_python:
>
>   ./configure
>   make; make install
>
> Both modules load and seem to work ok alone, but if I load both 
> modules (regardless of order), I get 'the document contains no data' 
> from my browser.
>
> I experienced conflicts between mod_python and php before, but I 
> thought the situation had improved under apache2.
>
> Any help is much appreciated!
>
> Cheers,
>
> ~=JR
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From nick at dd.revealed.net  Sat Jun  5 00:00:25 2004
From: nick at dd.revealed.net (Nick)
Date: Sat Jun  5 00:00:19 2004
Subject: mod_python on OSX/Panther (was Re: [mod_python] mod_python /
	mod_php4 w/apache 2)
In-Reply-To: <C41F9BC8-B699-11D8-A6A9-000D93AD1DB8@qutang.net>
References: <B2E5D0F4-B68E-11D8-A6A9-000D93AD1DB8@qutang.net>
	<C41F9BC8-B699-11D8-A6A9-000D93AD1DB8@qutang.net>
Message-ID: <1086408025.1050.9.camel@nick>

On Fri, 2004-06-04 at 21:40, Justin Ryan wrote:
> If I define a handlermodule (even mod_python.publisher, for 
> simplicity's sake), I get this error trying to load any url (even 
> /index.htm).

I identified this bug a couple weeks ago.  Basically if you define
PythonHandlerModule and there is no connection handler, then it bombs
out looking for one.  The fix right now is to define each handler you
need separately and refer to the same module for each.

Nick

From jryan at qutang.net  Sat Jun  5 00:33:09 2004
From: jryan at qutang.net (Justin Ryan)
Date: Sat Jun  5 00:33:13 2004
Subject: mod_python on OSX/Panther (was Re: [mod_python] mod_python /
	mod_php4 w/apache 2)
In-Reply-To: <1086408025.1050.9.camel@nick>
References: <B2E5D0F4-B68E-11D8-A6A9-000D93AD1DB8@qutang.net>
	<C41F9BC8-B699-11D8-A6A9-000D93AD1DB8@qutang.net>
	<1086408025.1050.9.camel@nick>
Message-ID: <72BB0FEA-B6A9-11D8-A6A9-000D93AD1DB8@qutang.net>

Oh.  Look.  It worked! :)

On Jun 4, 2004, at 11:00 PM, Nick wrote:

> On Fri, 2004-06-04 at 21:40, Justin Ryan wrote:
>> If I define a handlermodule (even mod_python.publisher, for
>> simplicity's sake), I get this error trying to load any url (even
>> /index.htm).
>
> I identified this bug a couple weeks ago.  Basically if you define
> PythonHandlerModule and there is no connection handler, then it bombs
> out looking for one.  The fix right now is to define each handler you
> need separately and refer to the same module for each.
>
> Nick
>
>

From jryan at qutang.net  Sun Jun  6 00:25:34 2004
From: jryan at qutang.net (Justin Ryan)
Date: Sun Jun  6 00:25:58 2004
Subject: mod_python on OSX/Panther (was Re: [mod_python] mod_python /
	mod_php4 w/apache 2)
In-Reply-To: <72BB0FEA-B6A9-11D8-A6A9-000D93AD1DB8@qutang.net>
References: <B2E5D0F4-B68E-11D8-A6A9-000D93AD1DB8@qutang.net>
	<C41F9BC8-B699-11D8-A6A9-000D93AD1DB8@qutang.net>
	<1086408025.1050.9.camel@nick>
	<72BB0FEA-B6A9-11D8-A6A9-000D93AD1DB8@qutang.net>
Message-ID: <8D9FF601-B771-11D8-A6A9-000D93AD1DB8@qutang.net>

Ok, wait.. That kept it from erroring on all requests, but when I try 
to access a .pt file (using PSE, of course), I get the same 
jibba-jabba.

so, in my httpd.conf I have:

     <IfModule mod_python.c>
     PythonPath "sys.path + 
['/Users/justinryan/.src/core/live/python/lib']"
     PythonHandler pse.handler
     AddHandler python-program .pt
     </IfModule>

and in error_log I get:

[Sat Jun 05 23:16:30 2004] [error] make_obcallback: could not import 
mod_python.apache.
ImportError: No module named mod_python.apache

I changed it to say:

PythonHandler mod_python.publisher
AddHandler python-program .py

and I stuck a file 'modpythontest.py' that just has:

def test(req, var):
	return "Variable: %s" % var

Same deal..

:-/

On Jun 4, 2004, at 11:33 PM, Justin Ryan wrote:

> Oh.  Look.  It worked! :)

From pf_moore at yahoo.co.uk  Mon Jun  7 00:20:46 2004
From: pf_moore at yahoo.co.uk (Paul Moore)
Date: Sun Jun  6 18:30:41 2004
Subject: [mod_python] How do I split up the URI in a request handler?
Message-ID: <vfi4xr9d.fsf@yahoo.co.uk>

In section 3.3 of the manual, at the end ("Some food for thought"), it
points out that the name of the Python file in the URL
http://myserver/mywebdir/myscript.py is not relevant to what Python
function gets called. I understand that, and I see that the handler
needs to parse the URL in order to get access to the filename
"myscript.py" should I require it for any reason.

The req.uri attribute gives me "/mywebdir/myscript.py". But how do I
find that my handler is being called "from" /mywebdir, to know how
much of the URI to strip off the front?

It seems to me that this is a pretty basic requirement for URI
parsing, so I'm assuming that I am missing something straightforward.
But for the life of me, I can't see it :-( This is causing a problem
for me in the mod_python support in MoinMoin, so I'd appreciate any
pointers.

Thanks,
Paul.
-- 
This signature intentionally left blank

From grisha at modpython.org  Sun Jun  6 20:35:59 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Sun Jun  6 19:36:10 2004
Subject: [mod_python] How do I split up the URI in a request handler?
In-Reply-To: <vfi4xr9d.fsf@yahoo.co.uk>
References: <vfi4xr9d.fsf@yahoo.co.uk>
Message-ID: <20040606193159.P28531@onyx.ispol.com>


The answer to this is not as simple as it would seem it should be, because
"/mywebdir" could be a directory such that DocumentRoot + "/mywedir" would
give you the path on disk, but it could also be an alias, in which case
there is no way to know what directory you're in...

But assuming you don't use aliases, req.filename will tell you what
directory you're in.

Also you may want to take a look at the publisher.py code, it deals with
that same issue.

Grisha

On Sun, 6 Jun 2004, Paul Moore wrote:

> In section 3.3 of the manual, at the end ("Some food for thought"), it
> points out that the name of the Python file in the URL
> http://myserver/mywebdir/myscript.py is not relevant to what Python
> function gets called. I understand that, and I see that the handler
> needs to parse the URL in order to get access to the filename
> "myscript.py" should I require it for any reason.
>
> The req.uri attribute gives me "/mywebdir/myscript.py". But how do I
> find that my handler is being called "from" /mywebdir, to know how
> much of the URI to strip off the front?
>
> It seems to me that this is a pretty basic requirement for URI
> parsing, so I'm assuming that I am missing something straightforward.
> But for the life of me, I can't see it :-( This is causing a problem
> for me in the mod_python support in MoinMoin, so I'd appreciate any
> pointers.
>
> Thanks,
> Paul.
> --
> This signature intentionally left blank
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From dpopowich at mtrsd.k12.ma.us  Sun Jun  6 22:47:53 2004
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Sun Jun  6 21:49:51 2004
Subject: [mod_python] MultiViews and mod_python
Message-ID: <16579.51529.790382.138590@gargle.gargle.HOWL>


If content negotiation is being used (mod_negotiation) and a directory
has MultiViews turned on with the Options directive, then certain
handlers will not work: you will get a 404 error and you will see
something like this in your apache error log:

    [Sun Jun 06 20:44:44 2004] [error] [client 127.0.0.1] Negotiation:
    discovered file(s) matching request: /some/dir/foo

This can happen with handlers that allow the requests to reference
files without a full filename.  Typically, this will be handlers that
don't require the file extension so as to allow "clean" URLs.  For
example, when using the publisher handler, if I have a module named
foo.py that has a function named bar defined, then these two requests
should both work:

   http://myhost/some/dir/foo.py/bar
   http://myhost/some/dir/foo/bar

But if /some/dir has MultiViews on (or a parent directory has it on
and it's not explicitly turned off in a subdirectory) then only the
first one will work, the second will generate a 404 error.

The only solution seems to be to explicitly turn off MultiViews:

    <Directory /some/dir>
      Options -MultiViews
      SetHandler mod_python
      PythonHandler mod_python.publisher
    </Directory>

This is the behaviour I'm witnessing.  Should this be correct?  Why is
mod_negotiation poking its nose in where it's not wanted, i.e., in a
directory using SetHandler?

Daniel

From gnb at itga.com.au  Mon Jun  7 12:53:05 2004
From: gnb at itga.com.au (Gregory Bond)
Date: Sun Jun  6 21:53:40 2004
Subject: [mod_python] mod_python / mod_php4 w/apache 2 
In-Reply-To: Your message of Fri, 04 Jun 2004 20:21:41 -0500.
Message-ID: <200406070153.LAA19154@lightning.itga.com.au>

Is this the same problem as with MySQL?  (mentioned in the FAQ:

http://www.modpython.org/FAQ/faqw.py?req=show&file=faq02.013.htp
)

From jgentil at sebistar.net  Mon Jun  7 00:30:24 2004
From: jgentil at sebistar.net (Jon-Pierre Gentil)
Date: Mon Jun  7 00:30:27 2004
Subject: [mod_python] Question.
Message-ID: <40C3EF60.30708@sebistar.net>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

My program imports other modules.  I wish to place these modules outside
of the area that Apache can "serve" them, so that a malicious or curious
user cannot enter, for example,  www.foo.com/modulecode.py and either
view or execute the module.  Is there a way to move these below my
documentroot and have mod_apache still import them?

Thanks!

- --
::  Jon-Pierre Gentil
::  PGP Key ID 0xA21BC30E
::  Jabber: jgentil@jabber.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iEYEARECAAYFAkDD72AACgkQOrVFmaIbww6R1wCgkkU6cVvdh9AFn7WUTbClO2W6
n3gAn2fGVvHecniNAC4MqoVT23vpFy2r
=b6c2
-----END PGP SIGNATURE-----
From ppercot at free.fr  Mon Jun  7 11:22:01 2004
From: ppercot at free.fr (Patrick Percot)
Date: Mon Jun  7 04:23:09 2004
Subject: [mod_python] Question.
In-Reply-To: <40C3EF60.30708@sebistar.net>
References: <40C3EF60.30708@sebistar.net>
Message-ID: <20040607.102201.79476498.ppercot@free.fr>

On Sun, 06 Jun 2004 23:30:24 -0500, Jon-Pierre Gentil <jgentil@sebistar.net> wrote

> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
> 

Hi,

> My program imports other modules.  I wish to place these modules outside
> of the area that Apache can "serve" them, so that a malicious or curious
> user cannot enter, for example,  www.foo.com/modulecode.py and either
> view or execute the module.  Is there a way to move these below my
> documentroot and have mod_apache still import them? 

You can add this in your httpd.conf

	<Files *>
		PythonPath "sys.path + ['/path/to/my/hidden/modules']"
	</Files>

And store your code in this path (/path/to/my/hidden/modules). 

You can also add a .htaccess  file in all the directories you don't want
Apache to display the content. Put these lines in .htaccess :

Order Allow,Deny
Deny from All

?+
PP
-- 
Groupe Morbihannais d'Utilisateurs de Logiciels Libres http://www.tuxbihan.org
Identifiant Jabber: pp@amessage.de
GPG fingerprint = 1A4F E154 3D2C A20E E4CA  A543 7951 C5C2 E44A A0B5

Patrick Percot.

From Paul.Moore at atosorigin.com  Mon Jun  7 13:52:34 2004
From: Paul.Moore at atosorigin.com (Moore, Paul)
Date: Mon Jun  7 07:52:37 2004
Subject: [mod_python] Re: How do I split up the URI in a request handler?
Message-ID: <16E1010E4581B049ABC51D4975CEDB8803060ECA@UKDCX001.uk.int.atosorigin.com>

Gregory (Grisha) Trubetskoy wrote:

> The answer to this is not as simple as it would seem it should be,
> because "/mywebdir" could be a directory such that DocumentRoot +
> "/mywedir" would give you the path on disk, but it could also be an
> alias, in which case there is no way to know what directory you're
> in...
>
> But assuming you don't use aliases, req.filename will tell you what
> directory you're in.

In my case, the problem is that I *am* using an alias. The background
is that MoinMoin includes mod_python support now. However, MoinMoin
URLs are of the form

    http://server.name/wiki/PageName

Here, "wiki" is an alias set up to point to the MoinMoin instance
directory, and PageName is the name of the page to display. In order
for the MoinMoin code to figure out the page, it needs to be able to
split the URL up into the "script" (/wiki) and the "path" (/PageName).
I suspect that this is because the original version of MoinMoin used
CGI, so the "script" was /whatever/path/you/want/moin.cgi and the path
can come from the standard CGI PATH_INFO variable.

Actually, I think I have a solution. Rather than using a Directory, I
can just use a Location. If I do that, the path_info attribute is
"correct" (ie, it includes everything after the part of the URL which
names the location).

So I have

<Location /wiki>
    # Use mod_python as handler
    SetHandler python-program

    # set the path to the MoinMoin package and to the moin_config.py
    PythonPath "['D:/Moin/dbawiki']+sys.path"

    # choose the ModPy Request class as handler
    PythonHandler MoinMoin.request::RequestModPy.run
</Location>

This seems to work as required. (I'm not 100% sure why, as MoinMoin
seems to be using SCRIPT_PATH, which is empty, but hey, if it works...

Paul.


__________________________________________________________________________
This e-mail and the documents attached are confidential and intended 
solely for the addressee; it may also be privileged. If you receive this 
e-mail in error, please notify the sender immediately and destroy it.
As its integrity cannot be secured on the Internet, the Atos Origin group 
liability cannot be triggered for the message content. Although the 
sender endeavours to maintain a computer virus-free network, the sender 
does not warrant that this transmission is virus-free and will not be 
liable for any damages resulting from any virus transmitted.
__________________________________________________________________________

From nick at dd.revealed.net  Mon Jun  7 09:19:37 2004
From: nick at dd.revealed.net (Nick)
Date: Mon Jun  7 09:21:48 2004
Subject: [mod_python] Re: How do I split up the URI in a request handler?
In-Reply-To: <16E1010E4581B049ABC51D4975CEDB8803060ECA@UKDCX001.uk.int.atosorigin.com>
References: <16E1010E4581B049ABC51D4975CEDB8803060ECA@UKDCX001.uk.int.atosorigin.com>
Message-ID: <40C46B69.2030903@dd.revealed.net>

Not sure if mod_python provides this, but apache provides a CGI variable 
PATH_TRANSLATED that should map to the file system.

Nick
From list at joreybump.com  Mon Jun  7 10:29:38 2004
From: list at joreybump.com (Jorey Bump)
Date: Mon Jun  7 09:29:44 2004
Subject: [mod_python] Question.
In-Reply-To: <20040607.102201.79476498.ppercot@free.fr>
References: <40C3EF60.30708@sebistar.net>
	<20040607.102201.79476498.ppercot@free.fr>
Message-ID: <40C46DC2.70302@joreybump.com>

Patrick Percot wrote:

> On Sun, 06 Jun 2004 23:30:24 -0500, Jon-Pierre Gentil <jgentil@sebistar.net> wrote
> 
>>My program imports other modules.  I wish to place these modules outside
>>of the area that Apache can "serve" them, so that a malicious or curious
>>user cannot enter, for example,  www.foo.com/modulecode.py and either
>>view or execute the module.  Is there a way to move these below my
>>documentroot and have mod_apache still import them? 
> 
> 
> You can add this in your httpd.conf
> 
> 	<Files *>
> 		PythonPath "sys.path + ['/path/to/my/hidden/modules']"
> 	</Files>
> 
> And store your code in this path (/path/to/my/hidden/modules). 
> 
> You can also add a .htaccess  file in all the directories you don't want
> Apache to display the content. Put these lines in .htaccess :
> 
> Order Allow,Deny
> Deny from All

In some circumstances, it may be appropriate to simply put your modules 
where other third party modules are placed. This is typically 
/usr/lib/pythonX.X/site-packages/. Then it's already in your path and 
available for import. Name your packages carefully to avoid conflicts. 
Naturally, you need admin privileges to do this.
From nick at dd.revealed.net  Mon Jun  7 09:57:38 2004
From: nick at dd.revealed.net (Nick)
Date: Mon Jun  7 09:58:20 2004
Subject: mod_python on OSX/Panther (was Re: [mod_python] mod_python /
	mod_php4 w/apache 2)
In-Reply-To: <8D9FF601-B771-11D8-A6A9-000D93AD1DB8@qutang.net>
References: <B2E5D0F4-B68E-11D8-A6A9-000D93AD1DB8@qutang.net>
	<C41F9BC8-B699-11D8-A6A9-000D93AD1DB8@qutang.net>
	<1086408025.1050.9.camel@nick>
	<72BB0FEA-B6A9-11D8-A6A9-000D93AD1DB8@qutang.net>
	<8D9FF601-B771-11D8-A6A9-000D93AD1DB8@qutang.net>
Message-ID: <40C47452.1000507@dd.revealed.net>

It looks like either a mod_python installation problem, or else Python is 
not looking in your site-packages directory under the python lib.  The 
indication here is that Python can't import apache from mod_python, which is 
the apache.py file under mod_python directory in site-packages.

Nick

Justin Ryan wrote:

> and in error_log I get:
> 
> [Sat Jun 05 23:16:30 2004] [error] make_obcallback: could not import 
> mod_python.apache.
> ImportError: No module named mod_python.apache

From grisha at modpython.org  Mon Jun  7 13:51:34 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Mon Jun  7 12:52:02 2004
Subject: [mod_python] Re: How do I split up the URI in a request handler?
In-Reply-To: <40C46B69.2030903@dd.revealed.net>
References: <16E1010E4581B049ABC51D4975CEDB8803060ECA@UKDCX001.uk.int.atosorigin.com>
	<40C46B69.2030903@dd.revealed.net>
Message-ID: <20040607124935.N46070@onyx.ispol.com>


PATH_TRANSLATED gets its value from req.filename

Grisha

On Mon, 7 Jun 2004, Nick wrote:

> Not sure if mod_python provides this, but apache provides a CGI variable
> PATH_TRANSLATED that should map to the file system.
>
> Nick
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From abes at cns.nyu.edu  Mon Jun  7 14:58:56 2004
From: abes at cns.nyu.edu (Abraham Schneider)
Date: Mon Jun  7 14:02:11 2004
Subject: [mod_python] super doesn't seem to always work with import
Message-ID: <40C4ACE0.1080209@cns.nyu.edu>

Hi. I'm currently using the latest version of mod_python (3.1.3) 
w/Apache 2.x on a debian box (I compiled the sources, as the stable 
branch). I've run across a problem, which I think is due to modpython 
(and if not, figure out what in python I'm doing wrong), and I'm hoping 
someone might have some insight into how to fix it.

I have a base class 'base_object' which inherits object. My class 
hierarchy includes several levels of abstraction and sometimes also 
involves multiple inheritence. Because of this I use:

super(classname, self).__init__(*args, **kwargs)

to initialize all my classes. I will (seemingly randomly) get a type 
error (that obj is an instance of classname, and not parentclass, where 
the error is reported for invocation of the super in the parent class) 
if a class is in a different module than the parent class. I can easily 
get rid of this error by simply moving the child class into the same module.

Another way to get around this problem is to use the:

parentclass.__init__(self, *args, **kwargs)

form, but only if I do: 'from moduleX import parentclass' (so I don't 
use the form 'moduleX.parentclass.__init__' -- otherwise I'll get a 
similiar error as above).

Some extra details: I'm using the default handler (i.e. 'SetHandler 
mod_python'), and using 'apache.import_modules' to load all of my modules.

Thanks!

Abe

From jgentil at sebistar.net  Mon Jun  7 14:13:36 2004
From: jgentil at sebistar.net (Jon-Pierre Gentil)
Date: Mon Jun  7 14:13:41 2004
Subject: [mod_python] Question #2
Message-ID: <40C4B050.70302@sebistar.net>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

I wish to thank those who answered my original question.

I now have another.  When using the publisher handler, or anything else
that uses FieldStorage,  how do I distinguish from POST and GET
parameters?  It is vital that I do so.  Will I have to manually
read/parse the URL for GET parameters, and manually re-read from the
client and parse the POST parameters?

Thanks.

- --
::  Jon-Pierre Gentil
::  PGP Key ID 0xA21BC30E
::  Jabber: jgentil@jabber.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iEYEARECAAYFAkDEsFAACgkQOrVFmaIbww4FlQCguHc44zJfcbuWuCBwHaJlyyh0
Ph8AoITCIaq+1HjMzSC/2Z4uPTOZ+9W3
=cKv4
-----END PGP SIGNATURE-----
From ppercot at free.fr  Mon Jun  7 21:25:58 2004
From: ppercot at free.fr (Patrick Percot)
Date: Mon Jun  7 14:55:22 2004
Subject: [mod_python] Question #2
In-Reply-To: <40C4B050.70302@sebistar.net>
References: <40C4B050.70302@sebistar.net>
Message-ID: <20040607.202558.96860051.ppercot@free.fr>

On Mon, 07 Jun 2004 13:13:36 -0500, Jon-Pierre Gentil <jgentil@sebistar.net> wrote

> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
> 
> I wish to thank those who answered my original question.
> 
> I now have another.  When using the publisher handler, or anything else
> that uses FieldStorage,  how do I distinguish from POST and GET
> parameters?  It is vital that I do so.  Will I have to manually
> read/parse the URL for GET parameters, and manually re-read from the
> client and parse the POST parameters? 

Use req.method to get the method. 

?+
PP
-- 
Groupe Morbihannais d'Utilisateurs de Logiciels Libres http://www.tuxbihan.org
Identifiant Jabber: pp@amessage.de
GPG fingerprint = 1A4F E154 3D2C A20E E4CA  A543 7951 C5C2 E44A A0B5

Patrick Percot.

From stefan.oberbichler at umit.at  Mon Jun  7 23:27:17 2004
From: stefan.oberbichler at umit.at (Stefan Oberbichler)
Date: Mon Jun  7 16:27:30 2004
Subject: [mod_python] UnpickleableError
Message-ID: <40C4CFA5.9000700@umit.at>

hi,

i am trying to save an object of a class in the session dictionary. its 
a simple
class, which makes a connection to  a firebird db.
But trying to save (req.session.save()) these variables i get an 
"UnpickleableError: Cannot pickle objects"

help please

bye
stefan

From gnb at itga.com.au  Tue Jun  8 11:16:33 2004
From: gnb at itga.com.au (Gregory Bond)
Date: Mon Jun  7 20:16:39 2004
Subject: [mod_python] UnpickleableError 
In-Reply-To: Your message of Mon, 07 Jun 2004 22:27:17 +0200.
Message-ID: <200406080016.KAA10754@lightning.itga.com.au>


stefan.oberbichler@umit.at said:
> class, which makes a connection to  a firebird db. But trying to save
> (req.session.save()) these variables i get an  "UnpickleableError:
> Cannot pickle objects" 

I'm assuming your object cointains a socket connection to the database.  This
is not pickle-able - no open file objects are.  (Which makes sense when you
think about it!)

You need to make sure the connection is not pickled but is re-created when the
object is un-pickled.  See the python module documentation on the pickle
funtions (Section 3.14.5.1 in the library reference in my copy).


From jgentil at sebistar.net  Tue Jun  8 01:14:31 2004
From: jgentil at sebistar.net (Jon-Pierre Gentil)
Date: Tue Jun  8 01:14:36 2004
Subject: [mod_python] Bug?
Message-ID: <40C54B37.7030403@sebistar.net>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

I am curious...why is os.curdir() /?  Is there a way to have the cwd be
whatever the DocumentRoot is?

Thanks.


- --
::  Jon-Pierre Gentil
::  PGP Key ID 0xA21BC30E
::  Jabber: jgentil@jabber.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iEYEARECAAYFAkDFSzcACgkQOrVFmaIbww4SzwCgtyQcUeosXFYDuAuzDCGlETMm
7xMAnRVJvhYGBD6aQqtnK68q+XG2U705
=/4DS
-----END PGP SIGNATURE-----
From gnb at itga.com.au  Tue Jun  8 16:43:31 2004
From: gnb at itga.com.au (Gregory Bond)
Date: Tue Jun  8 01:43:42 2004
Subject: [mod_python] Bug? 
In-Reply-To: Your message of Tue, 08 Jun 2004 00:14:31 -0500.
Message-ID: <200406080543.PAA03884@lightning.itga.com.au>


jgentil@sebistar.net said:
> I am curious...why is os.curdir() /?

Because a threaded apache might have several mod_python apps running 
concurrently and they can't all have their own CWD! 

And there is not necessarily a 1-1 relationship between URLs and directories.


From krishna at ironport.com  Tue Jun  8 20:16:39 2004
From: krishna at ironport.com (Krishna Srinivasan)
Date: Fri Jun 11 10:48:07 2004
Subject: [mod_python] ModPython on FreeBSD - install process 
Message-ID: <20040608191038.E17210@saint.ironport.com>


Greetings.

Are the following steps correct for a clean install ?

- Install python with option '--without-threads'
- Install apache (no special options)
- Install mod_python with apxs and python
options during 'configure' (pointing to
the right locations)
- setenv LD_PRELOAD to '/usr/lib/libc_r.so'

This is what I did but still got
the "PyThread_Delete" error.

[I managed to get away with a different
mod_python.so from a different but
similar config machine].

FreeBSD 4.9, Python 2.2.3, Apache 2.0.48, ModPy 3.1.3

Is there something else that needs to be done ?
Please let me know,

thanks,
Krishna.

From bje at apnic.net  Wed Jun  9 22:14:24 2004
From: bje at apnic.net (Byron Ellacott)
Date: Fri Jun 11 10:51:48 2004
Subject: [mod_python] mod_python doing weird things to import
Message-ID: <Pine.LNX.4.44.0406092038110.15571-200000@durian.apnic.net>

(Apache/2.0.47 mod_python/3.1.3 Python/2.3.3)

I've been beating my head against a bug for a few days now.  It looks
like there's something strange happening when mod_python imports
modules that are parts of packages.  To sum up:

I keep the modules I develop under a namespace of "bje.<foo>" - just
because I prefer to keep them distinct in some respect.  I have a
module called "bje.pframe" that is my web framework; right now I've
pared it right down to just print some debug as text/plain and return
apache.OK.  I have a module called "bje.budgetweb" that is the web
application proper; it uses bje.pframe for certain things.  And
finally, there's bje.budget, which is a library used by bje.budgetweb
(and bje.budgetcli, down the road).

So, trimmed down, bje.budgetweb is:
------
import bje.budget
import bje.pframe

def handler(req):
    app = bje.pframe.PFrameApp({}, {})
    app.handler(req)
------

And bje.pframe is:
------
from mod_python import apache
from mod_python import util

class PFrameApp:
    def __init__(self, views, actions):
	self.views = views
	self.actions = actions

    def handler(self, req):
	req.content_type = 'text/plain'
	req.write('Filename: %s\n' % req.filename)
	return apache.OK

def authenhandler(req):
    if req.user == 'test' and req.get_basic_auth_pw() == 'test':
	return apache.OK
    else:
	return apache.HTTP_UNAUTHORIZED
------

There's a bit more in them, but none of it is called right now.  The
trouble is, I get an AttributeError exception: 'module' object has no
attribute 'pframe', in bje.budgetweb, where it tries to call
bje.pframe.PFrameApp().

Adding debugging to output dir(bje) shows:
__*__
budget

No pframe!  Despite the "import bje.pframe" !  Checking
sys.modules.has_key('bje.pframe') shows True.

These modules are configured via a <Location /budget> block.  There's
a PythonHandler of bje.budgetweb, and a PythonAuthenHandler of
bje.pframe.

If I disable the PythonAuthenHandler, the problem goes away: dir(bje)
includes "pframe" and the bje.pframe.PFrameApp() call succeeds.

For my particular case, this isn't a big deal: I'm not going to do
authentication the way I had originally intended anyway.  But it seems
to point out a bug in mod_python's import code, when it's importing
from packages.  It's not compatible with python's import statement!

Looking at the source, it seems the trouble is in apache.py's
import_module().  When it uses imp.load_module(), it winds up loading
modules 'bje' and 'bje.pframe,' creating sys.modules[] entries for
both.  Subsequent loads of bje.pframe (such as, via "import
bje.pframe") will then of course return the sys.modules[] entry
instead of reloading it.  This is all correct behaviour, /except/
import_module() has not set "bje.pframe" == sys.modules['bje.pframe'].

I would consider this a bug in mod_python.  You may not agree, though,
so I can at best suggest that a fix for it would be to setattr() each
subsequently loaded module into its parent.  I've attached a patch
against 3.1.3 that does just that.

The other solution would be for me to add "bje.pframe =
sys.modules['bje.pframe']" after the import, or to use mod_python's
import_module() method instead of the import keyword, but I don't
really want to do either of those. :)

-- 
bje
-------------- next part --------------
diff -c old/apache.py new/apache.py
*** old/apache.py	Wed Jun  9 21:10:05 2004
--- new/apache.py	Wed Jun  9 21:12:35 2004
***************
*** 449,460 ****
--- 449,464 ----
                  s = "mod_python: (Re)importing module '%s'" % module_name
              _apache.log_error(s, APLOG_NOERRNO|APLOG_NOTICE)
  
+         parent = None
          parts = module_name.split('.')
          for i in range(len(parts)):
              f, p, d = imp.find_module(parts[i], path)
              try:
                  mname = ".".join(parts[:i+1])
                  module = imp.load_module(mname, f, p, d)
+                 if parent:
+                     setattr(parent, parts[i], module)
+                 parent = module
              finally:
                  if f: f.close()
              if hasattr(module, "__path__"):
From gdamjan at mail.net.mk  Thu Jun 10 17:47:57 2004
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jun 11 11:05:48 2004
Subject: [mod_python] Dumping the request object
Message-ID: <20040610144757.GA16871@legolas.on.net.mk>

I think at one point in time, on this list, there was some python code
that would dump most of the contents of the req object ... I was
searching the website, google and the faq but couldn't find it.


Sorry if its somewhere obvious.



-- 
damjan | ??????
This is my jabber ID --> damjan@bagra.net.mk <-- not my mail address!!!
From krishna at ironport.com  Wed Jun  9 13:44:46 2004
From: krishna at ironport.com (Krishna Srinivasan)
Date: Fri Jun 11 11:12:26 2004
Subject: [mod_python] ModPython on FreeBSD - install process 
Message-ID: <20040609124433.R17210@saint.ironport.com>


Greetings.

Are the following steps correct for a clean install ?

- Install python with option '--without-threads'
- Install apache (no special options)
- Install mod_python with apxs and python
options during 'configure' (pointing to
the right locations)
- setenv LD_PRELOAD to '/usr/lib/libc_r.so'

This is what I did but still got
the "PyThread_Delete" error.

[I managed to get away with a different
mod_python.so from a different but
similar config machine].

FreeBSD 4.9, Python 2.2.3, Apache 2.0.48, ModPy 3.1.3

Is there something else that needs to be done ?
Please let me know,

thanks,
Krishna.

From krishna at ironport.com  Wed Jun  9 13:44:21 2004
From: krishna at ironport.com (Krishna Srinivasan)
Date: Fri Jun 11 11:12:53 2004
Subject: [mod_python] Apache bloating up... 
Message-ID: <20040609124413.M17210@saint.ironport.com>


Greetings.

I have been running modpython on FreeBSD and
am using Sessions and after 5 days, I see that
apache process have bloated up so much.

Here is the result of a 'ps'.

myprompt> ps -auxwww | grep httpd
root    91669  0.0  0.3  4676 1404  ??  Ss   Fri10AM   0:19.63 /usr/local/apache2/bin/httpd -k start
nobody  91670  0.0  0.0 160592    0  ??  I    Fri10AM   0:45.10 /usr/local/apache2/bin/httpd -k start
nobody  91671  0.0  0.0 119660    0  ??  I    Fri10AM   0:31.95 /usr/local/apache2/bin/httpd -k start
nobody  91672  0.0  0.0 150408    0  ??  I    Fri10AM   0:44.50 /usr/local/apache2/bin/httpd -k start
nobody  91673  0.0  0.0 142168    0  ??  I    Fri10AM   0:41.49 /usr/local/apache2/bin/httpd -k start
nobody  91674  0.0  0.0 168092    0  ??  I    Fri10AM   0:51.81 /usr/local/apache2/bin/httpd -k start
nobody  91675  0.0 23.9 148500 124096  ??  I    Fri10AM   0:45.54 /usr/local/apache2/bin/httpd -k start
nobody  53978  0.0  0.0 137308    0  ??  I    Fri12PM   0:33.51 /usr/local/apache2/bin/httpd -k start
nobody  71837  0.0  0.0 148896    0  ??  I    Fri01PM   0:44.87 /usr/local/apache2/bin/httpd -k start
nobody  73291  0.0  0.0 144080    0  ??  I    Fri01PM   0:40.64 /usr/local/apache2/bin/httpd -k start
myprompt>

System - FreeBSD 4.9 - Apache 2.0.48 - Python 2.2.3 - ModPy 3.1.3
[Using ModPy Publisher handler]

When I start apache, it's about 4.5 Megs and after
the first request comes in, it goes to 15-20 Megs
and stays between 15-25 for a while. This is per
process. Why does it go up by so much ???

Could anyone please please explain what's going on ?

Many thanks in advance,
Krishna.

PS - I have also attached my previous emails where I am
seeing my /tmp/mp_sess.dbm just go up ! I am doubting
if that has anything to do with apache itself
becoming so huge !




---------- Forwarded message ----------
Date: Thu, 3 Jun 2004 19:17:45 -0700 (PDT)
From: Krishna Srinivasan <krishna@ironport.com>
To: "Gregory (Grisha) Trubetskoy" <grisha@modpython.org>
Cc: Modpython <Mod_python@modpython.org>
Subject: Re: [mod_python] Session Cleanups - Still a mystery


Greetings.

When I said "cleanup", I meant session-deletion
when I explicitly call "sess.invalidate()".
(I apologize for the confusion).

I wrote some print(to file) statements into the
Session.py file and tested my app. Just one user(me),
doing one set of transactions - one login, few actions,
logout.

I find that when I call "sess.invalidate()" the code
goes all the way to "do_delete()" and then fails in
the try-clause (due to KeyError). 'self._sid' is not
there in the dbm. Why is this failing ? I see that
the code just does a 'pass' on that (key)error.

And I put in a print to show my session-id when it's
new - however, during one session, I get back two prints
- so there are two sessions. Could it be because of a
request to a different server for, say, an image ??
[Just a guess]

Here is one more question, I cannot read the
values of the dict from a python cli.

prompt> cd /tmp
prompt> python
>>> import bsddb
>>> a = bsddb.hashopen("mp_sess.dbm", "r")
>>> a.keys()
['55d6151503a8bb61251ce6027fbc065dd', 'afea89bd5eb5d836ec4939615dffa8b22']
>>> a['55d6151503a8bb61251ce6027fbc065dd']
Traceback (most recent call last):
  File "<stdin>", line 1, in ?
  KeyError: 55d6151503a8bb61251ce6027fbc065dd
>>>

However, I could say something like,
>>> a.first()
And I get back a pickled-object as str.
[I could keep doing a.next() too and it works]

Am I doing something wrong here ??

> Session cleanups should happen randomly

Thanks, I finally did RTFM and figured that out.
(and how to set it to a different number if I need to
via Session.CLEANUP_CHANCE)

> How big is the dmb getting that you are concerned with space?

Like I said, my problem is session-deletion is not getting
done properly. And since I store large-objects in the
session-dictionary, it gets large. And that's how I
noticed.

Looking forward to helpful suggestions/hints,

Thanks,
Krishna.





On Thu, 3 Jun 2004, Gregory (Grisha) Trubetskoy wrote:

> Date: Thu, 3 Jun 2004 20:35:32 -0400 (EDT)
> From: "Gregory (Grisha) Trubetskoy" <grisha@modpython.org>
> To: Krishna Srinivasan <krishna@ironport.com>
> Cc: Modpython <Mod_python@modpython.org>
> Subject: Re: [mod_python] Session Cleanups - Still a mystery
>
>
> Session cleanups should happen randomly with about 1 in 1000 chance (1 out
> of 1000 session requests will trigger a cleanup). During a cleanup, all
> expired sessions should get deleted from the dmb.
>
> How big is the dmb getting that you are concerned with space?
>
> Grisha
>
> On Thu, 3 Jun 2004, Krishna Srinivasan wrote:
>
> >
> > Greetings.
> >
> > Can someone please explain how exactly sessions are cleaned up ?
> > I am seeing a constant increase in the /tmp/mp_sess.dbm though
> > I believe I am doing a 'delete' (and cleanup).
> >
> > I had posted this question some days back, here :
> > http://modpython.org/pipermail/mod_python/2004-May/015706.html
> >
> > For each session, whenever a user does some action (which internally
> > involves creating objects and storing them in the session dictionary),
> > I do a "req.sess.save".
> > [Where req.sess = Session.Session()]
> >
> > And then when they do a 'logout' - I do this :
> > req.sess.delete()
> >
> > However,  the size of mp_sess.dbm in /tmp is on the rise
> > always. Can someone please tell me what else I should be doing ?
> >
> > I store everything in a simple dictionary.
> > req.sess["mydict"] = <mydictionary>
> > The 'mydictionary' object keeps expanding based on user-actions.
> > I even do a 'del' to remove objects from this 'mydictionary'
> > object to keep the space down.
> >
> > System - FreeBSD 4.7 - Apache 2.0.48 - Python 2.2.3 - ModPy 3.1.3
> >
> > Please let me know how to fix this.
> >
> > Thanks,
> > Krishna.
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
>
From krishna at ironport.com  Tue Jun  8 19:42:32 2004
From: krishna at ironport.com (Krishna Srinivasan)
Date: Fri Jun 11 11:15:55 2004
Subject: [mod_python] Apache bloating up...
Message-ID: <20040608183702.H17210@saint.ironport.com>


Greetings.

I have been running modpython on FreeBSD and
am using Sessions and after 5 days, I see that
apache process have bloated up so much.

Here is the result of a 'ps'.

myprompt> ps -auxwww | grep httpd
root    91669  0.0  0.3  4676 1404  ??  Ss   Fri10AM   0:19.63 /usr/local/apache2/bin/httpd -k start
nobody  91670  0.0  0.0 160592    0  ??  I    Fri10AM   0:45.10 /usr/local/apache2/bin/httpd -k start
nobody  91671  0.0  0.0 119660    0  ??  I    Fri10AM   0:31.95 /usr/local/apache2/bin/httpd -k start
nobody  91672  0.0  0.0 150408    0  ??  I    Fri10AM   0:44.50 /usr/local/apache2/bin/httpd -k start
nobody  91673  0.0  0.0 142168    0  ??  I    Fri10AM   0:41.49 /usr/local/apache2/bin/httpd -k start
nobody  91674  0.0  0.0 168092    0  ??  I    Fri10AM   0:51.81 /usr/local/apache2/bin/httpd -k start
nobody  91675  0.0 23.9 148500 124096  ??  I    Fri10AM   0:45.54 /usr/local/apache2/bin/httpd -k start
nobody  53978  0.0  0.0 137308    0  ??  I    Fri12PM   0:33.51 /usr/local/apache2/bin/httpd -k start
nobody  71837  0.0  0.0 148896    0  ??  I    Fri01PM   0:44.87 /usr/local/apache2/bin/httpd -k start
nobody  73291  0.0  0.0 144080    0  ??  I    Fri01PM   0:40.64 /usr/local/apache2/bin/httpd -k start
myprompt>

System - FreeBSD 4.9 - Apache 2.0.48 - Python 2.2.3 - ModPy 3.1.3
[Using ModPy Publisher handler]

When I start apache, it's about 4.5 Megs and after
the first request comes in, it goes to 15-20 Megs
and stays between 15-25 for a while. This is per
process. Why does it go up by so much ???

Could anyone please please explain what's going on ?

Many thanks in advance,
Krishna.

PS - I have also attached my previous emails where I am
seeing my /tmp/mp_sess.dbm just go up ! I am doubting
if that has anything to do with apache itself
becoming so huge !




---------- Forwarded message ----------
Date: Thu, 3 Jun 2004 19:17:45 -0700 (PDT)
From: Krishna Srinivasan <krishna@ironport.com>
To: "Gregory (Grisha) Trubetskoy" <grisha@modpython.org>
Cc: Modpython <Mod_python@modpython.org>
Subject: Re: [mod_python] Session Cleanups - Still a mystery


Greetings.

When I said "cleanup", I meant session-deletion
when I explicitly call "sess.invalidate()".
(I apologize for the confusion).

I wrote some print(to file) statements into the
Session.py file and tested my app. Just one user(me),
doing one set of transactions - one login, few actions,
logout.

I find that when I call "sess.invalidate()" the code
goes all the way to "do_delete()" and then fails in
the try-clause (due to KeyError). 'self._sid' is not
there in the dbm. Why is this failing ? I see that
the code just does a 'pass' on that (key)error.

And I put in a print to show my session-id when it's
new - however, during one session, I get back two prints
- so there are two sessions. Could it be because of a
request to a different server for, say, an image ??
[Just a guess]

Here is one more question, I cannot read the
values of the dict from a python cli.

prompt> cd /tmp
prompt> python
>>> import bsddb
>>> a = bsddb.hashopen("mp_sess.dbm", "r")
>>> a.keys()
['55d6151503a8bb61251ce6027fbc065dd', 'afea89bd5eb5d836ec4939615dffa8b22']
>>> a['55d6151503a8bb61251ce6027fbc065dd']
Traceback (most recent call last):
  File "<stdin>", line 1, in ?
  KeyError: 55d6151503a8bb61251ce6027fbc065dd
>>>

However, I could say something like,
>>> a.first()
And I get back a pickled-object as str.
[I could keep doing a.next() too and it works]

Am I doing something wrong here ??

> Session cleanups should happen randomly

Thanks, I finally did RTFM and figured that out.
(and how to set it to a different number if I need to
via Session.CLEANUP_CHANCE)

> How big is the dmb getting that you are concerned with space?

Like I said, my problem is session-deletion is not getting
done properly. And since I store large-objects in the
session-dictionary, it gets large. And that's how I
noticed.

Looking forward to helpful suggestions/hints,

Thanks,
Krishna.





On Thu, 3 Jun 2004, Gregory (Grisha) Trubetskoy wrote:

> Date: Thu, 3 Jun 2004 20:35:32 -0400 (EDT)
> From: "Gregory (Grisha) Trubetskoy" <grisha@modpython.org>
> To: Krishna Srinivasan <krishna@ironport.com>
> Cc: Modpython <Mod_python@modpython.org>
> Subject: Re: [mod_python] Session Cleanups - Still a mystery
>
>
> Session cleanups should happen randomly with about 1 in 1000 chance (1 out
> of 1000 session requests will trigger a cleanup). During a cleanup, all
> expired sessions should get deleted from the dmb.
>
> How big is the dmb getting that you are concerned with space?
>
> Grisha
>
> On Thu, 3 Jun 2004, Krishna Srinivasan wrote:
>
> >
> > Greetings.
> >
> > Can someone please explain how exactly sessions are cleaned up ?
> > I am seeing a constant increase in the /tmp/mp_sess.dbm though
> > I believe I am doing a 'delete' (and cleanup).
> >
> > I had posted this question some days back, here :
> > http://modpython.org/pipermail/mod_python/2004-May/015706.html
> >
> > For each session, whenever a user does some action (which internally
> > involves creating objects and storing them in the session dictionary),
> > I do a "req.sess.save".
> > [Where req.sess = Session.Session()]
> >
> > And then when they do a 'logout' - I do this :
> > req.sess.delete()
> >
> > However,  the size of mp_sess.dbm in /tmp is on the rise
> > always. Can someone please tell me what else I should be doing ?
> >
> > I store everything in a simple dictionary.
> > req.sess["mydict"] = <mydictionary>
> > The 'mydictionary' object keeps expanding based on user-actions.
> > I even do a 'del' to remove objects from this 'mydictionary'
> > object to keep the space down.
> >
> > System - FreeBSD 4.7 - Apache 2.0.48 - Python 2.2.3 - ModPy 3.1.3
> >
> > Please let me know how to fix this.
> >
> > Thanks,
> > Krishna.
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
>
From bart at wsisiz.edu.pl  Tue Jun  8 16:09:37 2004
From: bart at wsisiz.edu.pl (Bartlomiej Rymarski)
Date: Fri Jun 11 11:29:55 2004
Subject: [mod_python] Uploading files with 2.7.10
Message-ID: <Pine.LNX.4.58LT.0406081459410.17190@oceanic.wsisiz.edu.pl>

Hello, 

I wrote a script that uploads a file to the server using mod_python 3.1.3, 
everything works fine, until I've tried to put the script on the main 
server which uses mod_python 2.7.10 (apache 2.6.x).

Here is the function responsible for uploading files.

#v+ 
def add(req, file_up):
   name_up = file_up.filename
   data = file_up.file.read(5*1024*1024) # limit to 5 MB

   localfile = open(file_up, "wb")
   localfile.write(data)
   localfile.close()
#v- 

As I said, this code works perfectly fine with mod_python 3.1.3. With 
2.7.10 I'm getting this error:

#v+
Mod_python error: "PythonHandler mod_python.publisher"

Traceback (most recent call last):

  File "/usr/local/lib/python2.3/site-packages/mod_python/apache.py", line 
193, in Dispatch
    result = object(req)

  File "/usr/local/lib/python2.3/site-packages/mod_python/publisher.py", 
line 104, in handler
    val = File(field)

  File "/usr/local/lib/python2.3/site-packages/mod_python/publisher.py", 
line 308, in __init__
    for m in field.file.__methods__:

AttributeError: 'file' object has no attribute '__methods__'
#v-

Is there any way to fix it?

Thanks in advance.

-- 
Bartek Rymarski <bart@wsisiz.edu.pl>
$ %blow
bash: fg: %blow: no such job
From ppercot at free.fr  Fri Jun 11 18:29:09 2004
From: ppercot at free.fr (Patrick Percot)
Date: Fri Jun 11 11:30:23 2004
Subject: [mod_python] Reloading modified scripts
In-Reply-To: <20040601.102547.71084749.ppercot@free.fr>
References: <20040601.102547.71084749.ppercot@free.fr>
Message-ID: <20040611.172909.31638770.ppercot@free.fr>

On Tue, 01 Jun 2004 10:25:47 +0200 (CEST), Patrick Percot <ppercot@free.fr> wrote

> Bonjour,
> 
> Despite  the presence  of "PythonAutoReload  On" in  my  httpd.conf, the
> modified  files are  not handled  correctly.  I  need to  restart Apache
> server to ensure that modified code is executed. 

I apologize for  the multipost if this mail arrives twice  (I sent it 24
hours ago, but it is not yet returned back to me). 

First of all : Thanks, Elan for your help. 


I  found a  better solution,  maybe you  can try  it and  tell me  if it
works for you. 

It appears that some directives, such as those :

		PythonDebug On
		PythonAutoReload On
		PythonOption Hello World

have to appear included in this directive :

	<Files *>
		PythonPath "sys.path + ['/var/www/lhassa/web2'] + ['/var/www/lhassa']"
		PythonDebug On
		PythonAutoReload On
		PythonOption Hello World
	</Files>

to be really activated.

Demonstration with this uggly small piece of code :

<code>
        ret = "<br/>Config :<br/>"
        conf = self._req.get_config()
        for key in conf.keys() :
            ret = ret + "Cnf : " + key + " = " + conf[key] + "<br/>"
        ret = ret + "<br/>Options :<br/>"
        options = self._req.get_options()
        for key in options.keys() :
            ret = ret + "Opt : " + key + " = " + options[key] + "<br/>"
</code>

that returns :

<output>
Config :
Cnf : PythonPath = sys.path + ['/var/www/lhassa/web2'] + ['/var/www/lhassa']
Cnf : PythonDebug = 1
Cnf : PythonAutoReload = 1

Options :
Opt : Hello = World
</output>

When those variables are included in <Files *> directive, and returns :

<output>
Config :
Cnf : PythonPath = sys.path + ['/var/www/lhassa/web2'] + ['/var/www/lhassa']

Options :
</output>

when they are not. 

Notice that my PythonPath directive was yet included in the <Files *> directive. 


Find below an extract from the documentation (the Files directive is not
mentioned) :

<extract>
5.4.10 PythonOption

Syntax: PythonOption key value
Context: server config, virtual host, directory, htaccess
Override: not None
Module: mod_python.c

Assigns a key value  pair to a table that can be  later retrieved by the
req.get_options() function.  This is useful to  pass information between
the  apache configuration  files  (httpd.conf, .htaccess,  etc) and  the
Python programs.
</extract>

Hope it helps.


?+
PP
-- 
Groupe Morbihannais d'Utilisateurs de Logiciels Libres http://www.tuxbihan.org
Identifiant Jabber: pp@amessage.de
GPG fingerprint = 1A4F E154 3D2C A20E E4CA  A543 7951 C5C2 E44A A0B5

Patrick Percot.

From ppercot at free.fr  Thu Jun 10 20:07:52 2004
From: ppercot at free.fr (Patrick Percot)
Date: Fri Jun 11 11:35:07 2004
Subject: [mod_python] Reloading modified scripts
In-Reply-To: <20040601.102547.71084749.ppercot@free.fr>
References: <20040601.102547.71084749.ppercot@free.fr>
Message-ID: <20040610.190752.34765673.ppercot@free.fr>

On Tue, 01 Jun 2004 10:25:47 +0200 (CEST), Patrick Percot <ppercot@free.fr> wrote

> Bonjour,
> 
> Despite  the presence  of "PythonAutoReload  On" in  my  httpd.conf, the
> modified  files are  not handled  correctly.  I  need to  restart Apache
> server to ensure that modified code is executed. 

First of all : Thanks, Elan for your help. 


I  found a  better solution,  maybe you  can try  it and  tell me  if it
works for you. 

It appears that some directives, such as those :

		PythonDebug On
		PythonAutoReload On
		PythonOption Hello World

have to appear included in this directive :

	<Files *>
		PythonPath "sys.path + ['/var/www/lhassa/web2'] + ['/var/www/lhassa']"
		PythonDebug On
		PythonAutoReload On
		PythonOption Hello World
	</Files>

to be really activated.

Demonstration with this uggly small piece of code :

<code>
        ret = "<br/>Config :<br/>"
        conf = self._req.get_config()
        for key in conf.keys() :
            ret = ret + "Cnf : " + key + " = " + conf[key] + "<br/>"
        ret = ret + "<br/>Options :<br/>"
        options = self._req.get_options()
        for key in options.keys() :
            ret = ret + "Opt : " + key + " = " + options[key] + "<br/>"
</code>

that returns :

<output>
Config :
Cnf : PythonPath = sys.path + ['/var/www/lhassa/web2'] + ['/var/www/lhassa']
Cnf : PythonDebug = 1
Cnf : PythonAutoReload = 1

Options :
Opt : Hello = World
</output>

When those variables are included in <Files *> directive, and returns :

<output>
Config :
Cnf : PythonPath = sys.path + ['/var/www/lhassa/web2'] + ['/var/www/lhassa']

Options :
</output>

when they are not. 

Notice that my PythonPath directive was yet included in the <Files *> directive. 


Find below an extract from the documentation :

<extract>
5.4.10 PythonOption

Syntax: PythonOption key value
Context: server config, virtual host, directory, htaccess
Override: not None
Module: mod_python.c

Assigns a key value  pair to a table that can be  later retrieved by the
req.get_options() function.  This is useful to  pass information between
the  apache configuration  files  (httpd.conf, .htaccess,  etc) and  the
Python programs.
</extract>

Hope it helps.


?+
PP
-- 
Groupe Morbihannais d'Utilisateurs de Logiciels Libres http://www.tuxbihan.org
Identifiant Jabber: pp@amessage.de
GPG fingerprint = 1A4F E154 3D2C A20E E4CA  A543 7951 C5C2 E44A A0B5

Patrick Percot.

From arnaudsj at mac.com  Fri Jun 11 12:02:22 2004
From: arnaudsj at mac.com (=?ISO-8859-1?Q?S=E9bastien_Arnaud?=)
Date: Fri Jun 11 12:02:37 2004
Subject: [mod_python] problems with mod_python 3.1.3 with Apache 2.0.48
	under OS X server 10.3.4
Message-ID: <B92A81A5-BBC0-11D8-B3A7-003065966802@mac.com>

Hi,

I wondered if anybody had any trouble with mod_python under OS X Server 
10.3.4 (Panther)?

I compiled from source apache 2.0.48 via fink and compiled without any 
trouble mod_python. Nevertheless when I try to access a simple "Hello, 
World!" file, using the mod_python.publisher I get the following error 
in apache2 error_logs:

[Thu Jun 10 14:50:27 2004] [notice] caught SIGTERM, shutting down
[Thu Jun 10 14:50:30 2004] [notice] mod_python: Creating 32 session 
mutexes based on 6 max processes and 25 max threads.
[Thu Jun 10 14:50:30 2004] [notice] Apache/2.0.48 (Unix) 
mod_python/3.1.3 Python/2.3 configured -- resuming normal operations
[Thu Jun 10 14:50:55 2004] [notice] mod_python: (Re)importing module 
'mod_python.publisher'
[Thu Jun 10 14:50:57 2004] [notice] child pid 29534 exit signal Bus 
error (10)

Any subsequent attempts to call the same file (http://localhost/) 
results in the repetition of this line:
[Thu Jun 10 14:50:55 2004] [notice] mod_python: (Re)importing module 
'mod_python.publisher'
[Thu Jun 10 14:50:57 2004] [notice] child pid 29534 exit signal Bus 
error (10)

Thank you in advance for your help. I attached my apache2 conf file, 
which is very small and minimalistic for now.

Cheers,

S?bastien

"apache2.conf":

Listen 8080
ServerRoot /sw/var/apache2
ServerName localhost
DocumentRoot /sw/var/apache2/htdocs/python
User  nobody
Group nobody
LoadModule python_module /sw/lib/apache2/modules/mod_python.so
MaxRequestsPerChild 0
ErrorLog logs/error_log

<Directory />
     Options FollowSymLinks
     AllowOverride None
</Directory>

<Directory /sw/var/apache2/htdocs/python/>
         SetHandler mod_python
         PythonHandler mod_python.publisher
         PythonDebug On
</Directory>

<IfModule prefork.c>
MaxClients       150
StartServers     5
MinSpareServers  5
MaxSpareServers 10
</IfModule>

<IfModule worker.c>
StartServers         2
MaxClients         150
MinSpareThreads     25
MaxSpareThreads     75
ThreadsPerChild     25
MaxRequestsPerChild  0
</IfModule>

-------------- next part --------------
A non-text attachment was scrubbed...
Name: PGP.sig
Type: application/pgp-signature
Size: 155 bytes
Desc: This is a digitally signed message part
Url : http://modpython.org/pipermail/mod_python/attachments/20040611/65779ffc/PGP.bin
From jgentil at sebistar.net  Tue Jun  8 11:57:14 2004
From: jgentil at sebistar.net (Jon-Pierre Gentil)
Date: Fri Jun 11 12:52:19 2004
Subject: [mod_python] Bug?
In-Reply-To: <200406080543.PAA03884@lightning.itga.com.au>
References: <200406080543.PAA03884@lightning.itga.com.au>
Message-ID: <40C5E1DA.4000504@sebistar.net>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Gregory Bond wrote:

>>I am curious...why is os.curdir() /?
>
>
> Because a threaded apache might have several mod_python apps running
> concurrently and they can't all have their own CWD!

I don't really see why threading makes a difference for the CWD.  A
thread doesn't care any more than a fork about the CWD.

> And there is not necessarily a 1-1 relationship between URLs and
directories.

No, but there IS a known DocumentRoot at the time of execution.  I was
curious as to why the CWD was set to / instead of DocumentRoot.  I'm
currently doing this for each and every function:
os.chdir(req.document_root()).  A bit annoying to have to copy the code
over and over again.  I was just wondering if it could be a part of the
publisher code, mayhaps with a new PythonOption flag to keep backwards
compatability.

- --
::  Jon-Pierre Gentil
::  PGP Key ID 0xA21BC30E
::  Jabber: jgentil@jabber.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iEYEARECAAYFAkDF4doACgkQOrVFmaIbww4kEACfS58czSl1NrWzlzpudHA/Dki0
TFsAnRr4AdhR03DahuLOn7bcKuyHNlzb
=iZor
-----END PGP SIGNATURE-----
From jryan at qutang.net  Tue Jun  8 17:33:17 2004
From: jryan at qutang.net (Justin Ryan)
Date: Fri Jun 11 14:59:43 2004
Subject: mod_python on OSX/Panther (was Re: [mod_python] mod_python /
	mod_php4 w/apache 2)
In-Reply-To: <40C47452.1000507@dd.revealed.net>
References: <B2E5D0F4-B68E-11D8-A6A9-000D93AD1DB8@qutang.net>
	<C41F9BC8-B699-11D8-A6A9-000D93AD1DB8@qutang.net>
	<1086408025.1050.9.camel@nick>
	<72BB0FEA-B6A9-11D8-A6A9-000D93AD1DB8@qutang.net>
	<8D9FF601-B771-11D8-A6A9-000D93AD1DB8@qutang.net>
	<40C47452.1000507@dd.revealed.net>
Message-ID: <745E2FE8-B993-11D8-B662-000D93AD1DB8@qutang.net>

Nick - thanks..

As you suggested on IM, I added the directory containing the mod_python 
module to PythonPath in my httpd.conf.  I even went so far as to 
rebuild mod_python against fink's python b/c psycopg needs threading.

The only thing that I noticed of any significance is that when I first 
tried your fix of putting the pythonpath in, I'm pretty sure the 
error_log message changed from an ImportError to an error about 
PyThread_somethingorother.  Not 100% sure, but this error (which also 
occurs w/ cmdline python) eventually led me to rebuild against fink 
python.

So, to sum up my current setup:

Darwin OSX/Panther 10.3.3
apache2 + python23 from fink.sf.net
mod_python 3.1.3 from modpython.org

./configure --with-python=/sw/bin/python --with-apxs2=/sw/sbin/apxs2
make
sudo make install

-=JR

On Jun 7, 2004, at 8:57 AM, Nick wrote:

> It looks like either a mod_python installation problem, or else Python 
> is not looking in your site-packages directory under the python lib.  
> The indication here is that Python can't import apache from 
> mod_python, which is the apache.py file under mod_python directory in 
> site-packages.
>
> Nick
>
> Justin Ryan wrote:
>
>> and in error_log I get:
>> [Sat Jun 05 23:16:30 2004] [error] make_obcallback: could not import 
>> mod_python.apache.
>> ImportError: No module named mod_python.apache
>
>

From grisha at modpython.org  Fri Jun 11 18:48:26 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jun 11 17:48:35 2004
Subject: [mod_python] ModPython on FreeBSD - install process 
In-Reply-To: <20040609124433.R17210@saint.ironport.com>
References: <20040609124433.R17210@saint.ironport.com>
Message-ID: <20040611174701.X27352@onyx.ispol.com>


I don't see any reason why you should compile Python without threads on
FreeBSD.

The easiest way to install mod_python on FreeBSD is to do it from the
ports collection IMO.

Grisha

On Wed, 9 Jun 2004, Krishna Srinivasan wrote:

>
> Greetings.
>
> Are the following steps correct for a clean install ?
>
> - Install python with option '--without-threads'
> - Install apache (no special options)
> - Install mod_python with apxs and python
> options during 'configure' (pointing to
> the right locations)
> - setenv LD_PRELOAD to '/usr/lib/libc_r.so'
>
> This is what I did but still got
> the "PyThread_Delete" error.
>
> [I managed to get away with a different
> mod_python.so from a different but
> similar config machine].
>
> FreeBSD 4.9, Python 2.2.3, Apache 2.0.48, ModPy 3.1.3
>
> Is there something else that needs to be done ?
> Please let me know,
>
> thanks,
> Krishna.
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From grisha at modpython.org  Fri Jun 11 19:00:03 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jun 11 18:00:13 2004
Subject: [mod_python] Bug?
In-Reply-To: <40C5E1DA.4000504@sebistar.net>
References: <200406080543.PAA03884@lightning.itga.com.au>
	<40C5E1DA.4000504@sebistar.net>
Message-ID: <20040611175518.Q27352@onyx.ispol.com>


Changing current working directory is not thread-safe because if thread A
assumes that the cwd is /x and thread B changes it to /y then thread A
will be in trouble. So calling chdir() in a multithreaded program is a
no-no.

All mutlithreaded programs do not relay on current working directories for
anything. Apache can't use the DocumentRoot because there can be more than
one DocumentRoot in a single httpd process.

HTH,

Grisha

On Tue, 8 Jun 2004, Jon-Pierre Gentil wrote:

> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
>
> Gregory Bond wrote:
>
> >>I am curious...why is os.curdir() /?
> >
> >
> > Because a threaded apache might have several mod_python apps running
> > concurrently and they can't all have their own CWD!
>
> I don't really see why threading makes a difference for the CWD.  A
> thread doesn't care any more than a fork about the CWD.
>
> > And there is not necessarily a 1-1 relationship between URLs and
> directories.
>
> No, but there IS a known DocumentRoot at the time of execution.  I was
> curious as to why the CWD was set to / instead of DocumentRoot.  I'm
> currently doing this for each and every function:
> os.chdir(req.document_root()).  A bit annoying to have to copy the code
> over and over again.  I was just wondering if it could be a part of the
> publisher code, mayhaps with a new PythonOption flag to keep backwards
> compatability.
>
> - --
> ::  Jon-Pierre Gentil
> ::  PGP Key ID 0xA21BC30E
> ::  Jabber: jgentil@jabber.org
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v1.2.4 (GNU/Linux)
> Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org
>
> iEYEARECAAYFAkDF4doACgkQOrVFmaIbww4kEACfS58czSl1NrWzlzpudHA/Dki0
> TFsAnRr4AdhR03DahuLOn7bcKuyHNlzb
> =iZor
> -----END PGP SIGNATURE-----
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From sleach at netlojix.com  Fri Jun 11 16:45:37 2004
From: sleach at netlojix.com (Sean Leach)
Date: Fri Jun 11 18:45:40 2004
Subject: [mod_python] ModPython on FreeBSD - install process
In-Reply-To: <20040611174701.X27352@onyx.ispol.com>
References: <20040609124433.R17210@saint.ironport.com>
	<20040611174701.X27352@onyx.ispol.com>
Message-ID: <40CA3611.8060405@netlojix.com>

Here is what we have done many times with Python, FreeBSD, Apache2, 
ModPython (we prefer source on apache and mod_python on BSD over port 
version)

1. Install python2.3 via ports (simple make install)
2. Install apache2 via source with:

./configure --enable-threads --enable-ssl <and whatever mods you need>

3. Install mod_python3.1.3 via source with:

./configure  --with-python=/usr/local/bin/python \ 
--with-apxs=/usr/local/apache2/bin/apxs

Make install's all around, and it works fine.  Have done this with 
FreeBSD 4.7, 4.8, 4.9, 5.2 etc.

i.e. nothing special...

Hope that helps,
Sean

Gregory (Grisha) Trubetskoy wrote:
> 
> I don't see any reason why you should compile Python without threads on
> FreeBSD.
> 
> The easiest way to install mod_python on FreeBSD is to do it from the
> ports collection IMO.
> 
> Grisha
> 
> On Wed, 9 Jun 2004, Krishna Srinivasan wrote:
> 
> 
>>Greetings.
>>
>>Are the following steps correct for a clean install ?
>>
>>- Install python with option '--without-threads'
>>- Install apache (no special options)
>>- Install mod_python with apxs and python
>>options during 'configure' (pointing to
>>the right locations)
>>- setenv LD_PRELOAD to '/usr/lib/libc_r.so'
>>
>>This is what I did but still got
>>the "PyThread_Delete" error.
>>
>>[I managed to get away with a different
>>mod_python.so from a different but
>>similar config machine].
>>
>>FreeBSD 4.9, Python 2.2.3, Apache 2.0.48, ModPy 3.1.3
>>
>>Is there something else that needs to be done ?
>>Please let me know,
>>
>>thanks,
>>Krishna.
>>
>>_______________________________________________
>>Mod_python mailing list
>>Mod_python@modpython.org
>>http://mailman.modpython.org/mailman/listinfo/mod_python
>>
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

-- 
From krishna at ironport.com  Fri Jun 11 19:20:07 2004
From: krishna at ironport.com (Krishna Srinivasan)
Date: Fri Jun 11 21:18:30 2004
Subject: [mod_python] ModPython on FreeBSD - install process 
In-Reply-To: <20040611174701.X27352@onyx.ispol.com>
References: <20040609124433.R17210@saint.ironport.com>
	<20040611174701.X27352@onyx.ispol.com>
Message-ID: <20040611181826.C31141@saint.ironport.com>


> I don't see any reason why you should compile Python without threads on
> FreeBSD.
> The easiest way to install mod_python on FreeBSD is to do it from the
> ports collection IMO.

Thanks. Will try that.

On another note, apologies for double posting my two emails.
They were being bounced and I wasn't sure if it made it.

Thanks,
Krishna.

From indrek at inversion.ee  Mon Jun 14 18:43:16 2004
From: indrek at inversion.ee (Indrek =?ISO-8859-1?Q?J=E4rve?=)
Date: Mon Jun 14 10:37:47 2004
Subject: [mod_python] Returning HTTP_MULTI_STATUS from a custom handler
Message-ID: <1087224196.19670.11.camel@hercules.dustbite.org>

Hi,

I'm currently working on creating a WebDAV implementation in mod_python.
To achieve this, I've written a custom request handler which does the
work required for each request and returns the defined status code
according to WebDAV spec. However, whenever I try to return
apache.HTTP_MULTI_STATUS (required by some response types), something
funky happens. A standard apache "internal error occured" gets appended
to the client output, and apache return code gets changed to 200. It's
rather easy to duplicate, a minimal handler like below reproduces it on
my Suse 9.0/mod_python 3.0 box.

TestPublisher.py:

from mod_python import apache

def handler(req):
    req.content_type = 'text/plain; charset=UTF-8"
    req.write('hi!')
    return apache.HTTP_MULTI_STATUS

Am I doing something awfully wrong or is this a general problem?

Regards,
Indrek

From gdamjan at mail.net.mk  Mon Jun 14 18:24:01 2004
From: gdamjan at mail.net.mk (Damjan)
Date: Mon Jun 14 11:24:04 2004
Subject: [mod_python] Returning HTTP_MULTI_STATUS from a custom handler
In-Reply-To: <1087224196.19670.11.camel@hercules.dustbite.org>
References: <1087224196.19670.11.camel@hercules.dustbite.org>
Message-ID: <20040614152401.GB26186@legolas.on.net.mk>

> I'm currently working on creating a WebDAV implementation in mod_python.

I obviously don't know what are your plans, but I have a suggestion.
Apache2 already has builtin WebDAV support, what you can do is a
mod_python auth handler that implements some inteligent ACL system and a
admin interface to manage the system. 

And yes, you can use mod_dav and mod_python-3.1.3 together. (there were
some problems with older mod_python versions).

-- 
damjan | ??????
This is my jabber ID --> damjan@bagra.net.mk <-- not my mail address!!!
From indrek at inversion.ee  Mon Jun 14 19:50:59 2004
From: indrek at inversion.ee (Indrek =?ISO-8859-1?Q?J=E4rve?=)
Date: Mon Jun 14 11:45:36 2004
Subject: [mod_python] Returning HTTP_MULTI_STATUS from a custom handler
In-Reply-To: <20040614152401.GB26186@legolas.on.net.mk>
References: <1087224196.19670.11.camel@hercules.dustbite.org>
	<20040614152401.GB26186@legolas.on.net.mk>
Message-ID: <1087228259.19672.27.camel@hercules.dustbite.org>

On Mon, 2004-06-14 at 18:24, Damjan wrote:
> > I'm currently working on creating a WebDAV implementation in mod_python.
> 
> I obviously don't know what are your plans, but I have a suggestion.
> Apache2 already has builtin WebDAV support, what you can do is a
> mod_python auth handler that implements some inteligent ACL system and a
> admin interface to manage the system. 

Sadly this is not possible, as the filestructure that will be served
over WebDAV will mostly come from an SQL database and all the changes
have to be recorded there too.

As a side-note, I just tested this on mod_python 3.1 too and the
behaviour is the same.

Regards,
Indrek

From grisha at modpython.org  Mon Jun 14 14:24:19 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Mon Jun 14 13:24:42 2004
Subject: [mod_python] Returning HTTP_MULTI_STATUS from a custom handler
In-Reply-To: <1087224196.19670.11.camel@hercules.dustbite.org>
References: <1087224196.19670.11.camel@hercules.dustbite.org>
Message-ID: <20040614131555.R82681@onyx.ispol.com>


Indrek

If you want Apache to handle the error, you return it the error code. This
will result in the behaviour you are seeing (an error page and a status of
200).

If you do not want Apache to handle the error (and in your case you do
not), then set req.status yourself, write the necessary output (e.g. some
html describing the error)  if any, and return apache.OK.

So the code you're looking for is:

def handler(req):
    req.status = apache.HTTP_MULTI_STATUS
    req.content_type = 'text/plain; charset=UTF-8"
    req.write('hi!')
    return apache.OK

This may seem confusing at first, but if you think about it it actually
makes pretty good sense. :-)

Grisha

On Mon, 14 Jun 2004, Indrek [ISO-8859-1] J?rve wrote:

> Hi,
>
> I'm currently working on creating a WebDAV implementation in mod_python.
> To achieve this, I've written a custom request handler which does the
> work required for each request and returns the defined status code
> according to WebDAV spec. However, whenever I try to return
> apache.HTTP_MULTI_STATUS (required by some response types), something
> funky happens. A standard apache "internal error occured" gets appended
> to the client output, and apache return code gets changed to 200. It's
> rather easy to duplicate, a minimal handler like below reproduces it on
> my Suse 9.0/mod_python 3.0 box.
>
> TestPublisher.py:
>
> from mod_python import apache
>
> def handler(req):
>     req.content_type = 'text/plain; charset=UTF-8"
>     req.write('hi!')
>     return apache.HTTP_MULTI_STATUS
>
> Am I doing something awfully wrong or is this a general problem?
>
> Regards,
> Indrek
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From indrek at inversion.ee  Mon Jun 14 21:38:22 2004
From: indrek at inversion.ee (Indrek =?ISO-8859-1?Q?J=E4rve?=)
Date: Mon Jun 14 13:32:49 2004
Subject: [mod_python] Returning HTTP_MULTI_STATUS from a custom handler
In-Reply-To: <20040614131555.R82681@onyx.ispol.com>
References: <1087224196.19670.11.camel@hercules.dustbite.org>
	<20040614131555.R82681@onyx.ispol.com>
Message-ID: <1087234701.29233.5.camel@hercules.dustbite.org>

Grisha,

Thanks, that did it!
Maybe this behaviour should be explained in a bit more detail in the
documentation for the future users? While now knowing this I can
semi-understand it from "Overview of a Request Handler" and "Request
Object/Request Members", it still seems a bit vague ;)

Regards,
Indrek

On Mon, 2004-06-14 at 20:24, Gregory (Grisha) Trubetskoy wrote:
> Indrek
> 
> If you want Apache to handle the error, you return it the error code. This
> will result in the behaviour you are seeing (an error page and a status of
> 200).
> 
> If you do not want Apache to handle the error (and in your case you do
> not), then set req.status yourself, write the necessary output (e.g. some
> html describing the error)  if any, and return apache.OK.
> 
> So the code you're looking for is:
> 
> def handler(req):
>     req.status = apache.HTTP_MULTI_STATUS
>     req.content_type = 'text/plain; charset=UTF-8"
>     req.write('hi!')
>     return apache.OK
> 
> This may seem confusing at first, but if you think about it it actually
> makes pretty good sense. :-)
> 
> Grisha

From nick at dd.revealed.net  Mon Jun 14 13:37:23 2004
From: nick at dd.revealed.net (Nick)
Date: Mon Jun 14 13:37:47 2004
Subject: [mod_python] Returning HTTP_MULTI_STATUS from a custom handler
In-Reply-To: <1087234701.29233.5.camel@hercules.dustbite.org>
References: <1087224196.19670.11.camel@hercules.dustbite.org>	<20040614131555.R82681@onyx.ispol.com>
	<1087234701.29233.5.camel@hercules.dustbite.org>
Message-ID: <40CDE253.1050702@dd.revealed.net>

Good point, there.  I needed to do something similar a while ago, and after 
trial and error I figured it out.  It might be a helpful FAQ item.

Nick

Indrek J?rve wrote:

> Grisha,
> 
> Thanks, that did it!
> Maybe this behaviour should be explained in a bit more detail in the
> documentation for the future users? While now knowing this I can
> semi-understand it from "Overview of a Request Handler" and "Request
> Object/Request Members", it still seems a bit vague ;)
> 
> Regards,
> Indrek
> 
> On Mon, 2004-06-14 at 20:24, Gregory (Grisha) Trubetskoy wrote:
> 
>>Indrek
>>
>>If you want Apache to handle the error, you return it the error code. This
>>will result in the behaviour you are seeing (an error page and a status of
>>200).
>>
>>If you do not want Apache to handle the error (and in your case you do
>>not), then set req.status yourself, write the necessary output (e.g. some
>>html describing the error)  if any, and return apache.OK.
>>
>>So the code you're looking for is:
>>
>>def handler(req):
>>    req.status = apache.HTTP_MULTI_STATUS
>>    req.content_type = 'text/plain; charset=UTF-8"
>>    req.write('hi!')
>>    return apache.OK
>>
>>This may seem confusing at first, but if you think about it it actually
>>makes pretty good sense. :-)
>>
>>Grisha
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From jgentil at sebistar.net  Tue Jun 15 01:59:11 2004
From: jgentil at sebistar.net (Jon-Pierre Gentil)
Date: Mon Jun 21 09:31:38 2004
Subject: [mod_python] Unicode?
Message-ID: <40CE902F.7060008@sebistar.net>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

How can the output be encoded in UTF-8?  The publisher breaks on this:

=============
Mod_python error: "PythonHandler mod_python.publisher"

Traceback (most recent call last):

  File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line
299, in HandlerDispatch
    result = object(req)

  File "/usr/lib/python2.3/site-packages/mod_python/publisher.py", line
143, in handler
    result = str(result)

UnicodeEncodeError: 'ascii' codec can't encode characters in position
2144-2145: ordinal not in range(128)
==============

Why does it re-encode it?

Thanks.

- --
::  Jon-Pierre Gentil
::  PGP Key ID 0xA21BC30E
::  Jabber: jgentil@jabber.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iEYEARECAAYFAkDOkC8ACgkQOrVFmaIbww4Q0ACgrRbkv5lB/TzGH3e90JXiGVCQ
tiIAoJ34/UJLMr0FvJSul3WyKX7FbA5Q
=/C/W
-----END PGP SIGNATURE-----
From reed at intersiege.com  Tue Jun 15 12:09:52 2004
From: reed at intersiege.com (Reed L. O'Brien)
Date: Mon Jun 21 09:31:39 2004
Subject: [mod_python] modifying psp_site
Message-ID: <can3fb$sci$1@sea.gmane.org>

I have been tasked to make a web interface to search (swish-e) and index 
of pdf's.  I have never done any programming (but have done some 
scripting) so I apologize in advance for any questions that may seen 
like common sense.  I feel like there will be many of them as this is 
very humbling to me.

I chose python to develop (and learn to program with) for numerous 
reasons.  I quickly found mod_python and chose that.  I saw the example 
site and thought it would be a nice simple site to modify (tries to 
conceal leeching noises).  I have it all up and running and somewhat 
modified but have reached an impass.

I have modified the three pages to be search, results and help.  I 
modified search_page.html to have text input and submit calls:

<form action="results/performSearch" method="POST">

I added it as a value passed (required by) to results (continued after 
bad code):

def results(req, searchWords):
     return _any_page(req, 'results')
 

 
         #def performSearch(searchWords):

     # make sure the user provided all the parameters
     if not (searchWords):
         return " Nothing to search for. Nothing Found."
 

     # do the search
     handle = SwishE.new('/usr/local/swish-e/index.swish-e')
     search = handle.search('')
     results = search.execute(searchWords)
     return [r.getproperty('swishdocpath') for r in results]

also I have the following in results_page.html:

<% print results %>


I have tried with it as a call to performSearch and directly to search. 
  I have tried with different indentations.  I have also tried including 
it in the page return, but either the page returns:

name error results not defined  ## wiith the <%psp%> tag in html
or:
as a blank formatted results page with a broken menu and images.

I could keep playing around but I figured it was time to put down my 
pride and ask the experts.  Any help is appreciated.

TIA
reed (very newb programmer)

PS If (when) I get this working I will gladly roll it up  with a demo 
index and put it up as an example site with the original.

PSS:
FreeBSD 5.2.1
mod_python 3.1.3
python 2.3.4
SwishE 0.4


From reed at intersiege.com  Tue Jun 15 13:55:11 2004
From: reed at intersiege.com (Reed L. O'Brien)
Date: Mon Jun 21 09:31:39 2004
Subject: [mod_python] modifying psp_site
Message-ID: <40CF29EF.60603@intersiege.com>

This amy appear twice.  I usually post through gmane but my post hasn't 
shown so I am directly submitting this to the list. Sorry twice if it 
becomes redundant.

I have been tasked to make a web interface to search (swish-e) and index 
of pdf's.  I have never done any programming (but have done some 
scripting) so I apologize in advance for any questions that may seen 
like common sense.  I feel like there will be many of them as this is 
very humbling to me.

I chose python to develop (and learn to program with) for numerous 
reasons.  I quickly found mod_python and chose that.  I saw the example 
site and thought it would be a nice simple site to modify (tries to 
conceal leeching noises).  I have it all up and running and somewhat 
modified but have reached an impass.

I have modified the three pages to be search, results and help.  I 
modified search_page.html to have text input and submit calls:

<form action="results/performSearch" method="POST">

I added it as a value passed (required by) to results (continued after 
bad code):

def results(req, searchWords):
    return _any_page(req, 'results')



        #def performSearch(searchWords):

    # make sure the user provided all the parameters
    if not (searchWords):
        return " Nothing to search for. Nothing Found."


    # do the search
    handle = SwishE.new('/usr/local/swish-e/index.swish-e')
    search = handle.search('')
    results = search.execute(searchWords)
    return [r.getproperty('swishdocpath') for r in results]

also I have the following in results_page.html:

<% print results %>


I have tried with it as a call to performSearch and directly to search. 
 I have tried with different indentations.  I have also tried including 
it in the page return, but either the page returns:

name error results not defined  ## wiith the <%psp%> tag in html
or:
as a blank formatted results page with a broken menu and images.

I could keep playing around but I figured it was time to put down my 
pride and ask the experts.  Any help is appreciated.

TIA
reed (very newb programmer)

PS If (when) I get this working I will gladly roll it up  with a demo 
index and put it up as an example site with the original.

PSS:
FreeBSD 5.2.1
mod_python 3.1.3
python 2.3.4
SwishE 0.4


From mn at momentummedia.com  Tue Jun 15 18:06:26 2004
From: mn at momentummedia.com (Mark Nye)
Date: Mon Jun 21 09:31:40 2004
Subject: [mod_python] using req object with Publisher
Message-ID: <1087333586.5415.25.camel@ibook.momentummedia.com>

Quick question from a newbie modpython user...

Suppose I'm using Publisher to read GET or POST data, but would like to
begin writing back to the browser immediately instead of collecting my
entire page output in a string and returning it all at the end. (Maybe
I'm looping through a long db result set, for example.) Does it make
sense to do something like this:


from mod_python import apache

def myhandler(req, myvar1=None, myvar2=None):
	req.content_type = "text/html"
	req.send_http_header()
	req.write("my html") # of course I'd be doing more here
	raise apache.SERVER_RETURN, apache.OK
	return


Or would anyone suggest a different approach? Thanks!

Mark

From cwfitzhu at rockwellcollins.com  Tue Jun 15 18:42:21 2004
From: cwfitzhu at rockwellcollins.com (cwfitzhu@rockwellcollins.com)
Date: Mon Jun 21 09:31:42 2004
Subject: [mod_python] Question about Session management - can't find dirpath
Message-ID: <OF3E668B98.DB0E9BBD-ON85256EB4.007703E5-85256EB4.00785E89@crnotes2.rockwellcollins.com>

I saw that someone else had this problem, but didn't see any responses so 
i don't know if anyone knows what is going on, but I figured I would ask. 

The following is the traceback.
When you point the browser to Login.py/loadPage:

def loadPage(req, retry=False):
    # check if new session
    sess = Session.Session(req, secret=SECRET_CODE)
    #load a template
    template = psp.PSP(req, filename="LoginPage.tmpl")
    #load dynamic variables from the database into template to
    if retry == True:
        pageData['TextField'] = LOGIN_RETRY_MESSAGE
    # if Retry - notify user of failed login attempt
    #create HTML page
    template.run(pageData)
    return
You get the following error....
I can't really track it down because the session code is all wrapped up 
with the apache code, so I can't do unit testing or anything. 
Has anyone else seen a problem like this?

Mod_python error: "PythonHandler mod_python.publisher"

Traceback (most recent call last):

  File "C:\PYTHON23\Lib\site-packages\mod_python\apache.py", line 299, in 
HandlerDispatch
    result = object(req)

  File "C:\PYTHON23\Lib\site-packages\mod_python\publisher.py", line 136, 
in handler
    result = util.apply_fs_data(object, req.form, req=req)

  File "C:\PYTHON23\Lib\site-packages\mod_python\util.py", line 361, in 
apply_fs_data
    return object(**args)

  File "C:/Program Files/Apache Group/Apache2/htdocs\Login.py", line 24, 
in loadPage
    sess = Session(req, secret=SECRET_CODE)

  File "C:\PYTHON23\Lib\site-packages\mod_python\Session.py", line 386, in 
Session
    timeout=timeout, lock=lock)

  File "C:\PYTHON23\Lib\site-packages\mod_python\Session.py", line 358, in 
__init__
    timeout=timeout, lock=lock)

  File "C:\PYTHON23\Lib\site-packages\mod_python\Session.py", line 132, in 
__init__
    Cookie.add_cookie(self._req, self.make_cookie())

  File "C:\PYTHON23\Lib\site-packages\mod_python\Session.py", line 160, in 
make_cookie
    c.path = dirpath[len(docroot):]

TypeError: unsubscriptable object

Cary FitzHugh

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://modpython.org/pipermail/mod_python/attachments/20040615/aa0fbf60/attachment.html
From mn at momentummedia.com  Wed Jun 16 15:32:04 2004
From: mn at momentummedia.com (Mark Nye)
Date: Mon Jun 21 09:32:04 2004
Subject: [mod_python] using req object with Publisher
Message-ID: <1087410724.5404.10.camel@ibook.momentummedia.com>

Quick modpython newbie question...

Suppose that I'm using Publisher to collect GET or POST data, but that I
want to begin writing back to the browser immediately, instead of
collecting my output in a string and returning it all at the end. (Maybe
I'm looping through a large db result set, for example.) Does it make
sense to do something like this:

from mod_python import apache

def myhandler(req, myvar1=None, myvar2=None):
	req.content_type = "text/html"
	req.send_http_header()
	req.write("my html") # of course I'd have more here
	raise apache.SERVER_RETURN, apache.OK
	return

Or might anyone suggest a better approach? Thanks!

best,
Mark Nye

Momentum Media
Ithaca, NY

From gdamjan at mail.net.mk  Fri Jun 18 20:07:41 2004
From: gdamjan at mail.net.mk (Damjan)
Date: Mon Jun 21 09:32:15 2004
Subject: [mod_python] How to get the URI base of a mod_python app
Message-ID: <20040618170741.GA4848@legolas.on.net.mk>

I have a mod_python app setup like this:

Alias /mptest /home/www/mptest
<Directory /home/www/mptest>
  SetHandler mod_python
  PythonDebug On
  PythonHandler mptest
</Directory>

Offcourse the "/mptest" alias could be changed any time..

I'd like to get the URI base in my app no mather what the URL
was when the app was called (for ex. the app can be invoked with
/mptest/aaa/cccc/bbbbb?...).

I currently use this hack, but I'm not sure if it's the most accurate
way:

	i = req.uri.replace(req.path_info,'').rindex('/')
	uri_base = req.uri[:i].decode('utf-8')


-- 
damjan | ??????
This is my jabber ID --> damjan@bagra.net.mk <-- not my mail address!!!
From grisha at ispol.com  Mon Jun 21 10:30:13 2004
From: grisha at ispol.com (Gregory (Grisha) Trubetskoy)
Date: Mon Jun 21 09:32:51 2004
Subject: [mod_python] test
Message-ID: <20040621092957.F11566@onyx.ispol.com>


please ignore


From ravishekhar at gmail.com  Mon Jun 21 14:46:46 2004
From: ravishekhar at gmail.com (Ravi Shekhar)
Date: Mon Jun 21 13:46:48 2004
Subject: [mod_python] httpd/unix-directory instead of index page
Message-ID: <5e3bfe8d0406211046351eadd6@mail.gmail.com>

Hi everyone,

I've set up a handler() function in index.py that looks at the req.uri
parameter and decides what to serve based on that. My problem is that
when I visit http://localhost ,I get a mime type error that I don't
know how to fix. It says "You have chosen to open http://localhost/
which is a: httpd/unix-directory" and pops up the save file dialog.
However, when I visit http://localhost/index.py, everything works as
it should. It's probably something obvious, but I'm not sure what I'm
doing wrong.

This is the relavent block in my httpd.conf

DirectoryIndex index.py index.html
<Directory /var/www/html>
        SetHandler python-program
        PythonAuthenHandler authenticator
        PythonHandler index
        PythonDebug On
        AuthType Basic
        AuthName "Restricted"
        Require valid-user
</Directory>

And my handler function (for now) is quite simple.

def handler(req):
        req.write(str(req.unparsed_uri))
        return apache.OK

I'm running Linux 2.6.6 on Fedora Core 2. Thanks, I really appreciate the help.

Ravi
From reedobrien at acm.org  Mon Jun 21 15:05:36 2004
From: reedobrien at acm.org (Reed L. O'Brien)
Date: Mon Jun 21 14:10:52 2004
Subject: [mod_python] Re: httpd/unix-directory instead of index page
In-Reply-To: <5e3bfe8d0406211046351eadd6@mail.gmail.com>
References: <5e3bfe8d0406211046351eadd6@mail.gmail.com>
Message-ID: <cb780o$li1$1@sea.gmane.org>


Ravi Shekhar wrote:
> Hi everyone,
> 
> I've set up a handler() function in index.py that looks at the req.uri
> parameter and decides what to serve based on that. My problem is that
> when I visit http://localhost ,I get a mime type error that I don't
> know how to fix. It says "You have chosen to open http://localhost/
> which is a: httpd/unix-directory" and pops up the save file dialog.
> However, when I visit http://localhost/index.py, everything works as
> it should. It's probably something obvious, but I'm not sure what I'm
> doing wrong.
> 
> This is the relavent block in my httpd.conf
> 
> DirectoryIndex index.py index.html
> <Directory /var/www/html>
>         SetHandler python-program
>         PythonAuthenHandler authenticator
>         PythonHandler index
>         PythonDebug On
>         AuthType Basic
>         AuthName "Restricted"
>         Require valid-user
> </Directory>
> 
> And my handler function (for now) is quite simple.
> 
> def handler(req):
Maybe add req.content_type = "text/plain"  # or text/html #######
>         req.write(str(req.unparsed_uri))
>         return apache.OK
> 
> I'm running Linux 2.6.6 on Fedora Core 2. Thanks, I really appreciate the help.
> 
> Ravi

cheers,
reed

-- 



reed
4.6692016090

From alucard at kanux.com  Mon Jun 21 15:22:06 2004
From: alucard at kanux.com (Juan Hernandez)
Date: Mon Jun 21 14:22:12 2004
Subject: [mod_python] ImportError: No module named mptest
Message-ID: <40D7274E.3020008@kanux.com>

Hi there...

    This is my first question to this mailing list and I guess it's a 
pretty stupid one... I haven't found a solution to it. I'm trying to 
insta ll mod_python inmy slackware machine, my apache was built from 
source -it's not tar.gz package- and I'm getting this error:

-------

Mod_python error: "PythonHandler mptest"

Traceback (most recent call last):

  File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 181, in Dispatch
    module = import_module(module_name, _req)

  File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 332, in import_module
    f, p, d = imp.find_module(parts[i], path)

ImportError: No module named mptest
------
And here's my apache virtual domain directive

NameVirtualHost 10.73.219.156

<VirtualHost 10.73.219.156>
    ServerName webmail.domain.com.ve
    ServerAlias www.domain.com.ve
    ServerAlias domain.com.ve
    DocumentRoot /home/domain
    ErrorLog /var/log/apache/webmail.domain.com.ve-error_log
    CustomLog /var/log/apache/webmail.domain.com.ve-access_log combined
</VirtualHost>

<Directory /home/webmail/python/>
AddHandler python-program .py
PythonHandler mptest
PythonDebug On
</Directory>

-----
All I have been able to find is that, is that in version 2.7.7 there was 
a misspelled word that causes this and, that it was fixed in 2.8.8 and 
I'm using 2.7.10 with apache 1.3.31

Thanks a lot for your time

Juan
From ravishekhar at gmail.com  Mon Jun 21 15:26:58 2004
From: ravishekhar at gmail.com (Ravi Shekhar)
Date: Mon Jun 21 14:27:00 2004
Subject: [mod_python] Re: httpd/unix-directory instead of index page
In-Reply-To: <cb780o$li1$1@sea.gmane.org>
References: <5e3bfe8d0406211046351eadd6@mail.gmail.com>
	<cb780o$li1$1@sea.gmane.org>
Message-ID: <5e3bfe8d040621112616e396a7@mail.gmail.com>

> Maybe add req.content_type = "text/plain"  # or text/html #######
> >         req.write(str(req.unparsed_uri))
> >         return apache.OK
> 
> cheers,
> reed

Yeah that fixed it. I'm suprised I didn't think of it. Thanks

Ravi
From reedobrien at acm.org  Mon Jun 21 15:34:43 2004
From: reedobrien at acm.org (Reed L. O'Brien)
Date: Mon Jun 21 14:34:26 2004
Subject: [mod_python] Re: modifying psp_site
In-Reply-To: <40CF29EF.60603@intersiege.com>
References: <40CF29EF.60603@intersiege.com>
Message-ID: <cb79nc$ql6$1@sea.gmane.org>

####I am now here. The formcalls results

<form action="results" method="POST">

####results is as follows

def results(req, searchWords):
      if not (searchWords):
          #req.write
          answer = "<H2>Nothing to search for. Nothing Found</H2>"
 

      handle = SwishE.new('/usr/local/swish-e/index.swish-e')
      search = handle.search('')
      results = search.execute(searchWords)
      files = [r.getproperty('swishdocpath') for r in results]
 

      #req.write
      answer = "The files found are: %s" % files

      return _any_page(req, 'results')

#####So when the results_template.html

<p>
<h3>Search Results</h3>

<p>
  <%answer%>

#####it inserts

Mod_python error: "PythonHandler mod_python.publisher"

Traceback (most recent call last):

   File "/usr/local/lib/python2.3/site-packages/mod_python/apache.py", 
line 299, in HandlerDispatch
     result = object(req)

   File 
"/usr/local/lib/python2.3/site-packages/mod_python/publisher.py", line 
143, in handler
     result = str(result)

   File "/usr/local/lib/python2.3/site-packages/mod_python/psp.py", line 
228, in __str__
     self.run()

   File "/usr/local/lib/python2.3/site-packages/mod_python/psp.py", line 
208, in run
     exec code in global_scope

   File "/usr/local/www/data/python/templates/main_frame.html", line 12, 
in ?
     %>

   File "/usr/local/lib/python2.3/site-packages/mod_python/psp.py", line 
228, in __str__
     self.run()

   File "/usr/local/lib/python2.3/site-packages/mod_python/psp.py", line 
208, in run
     exec code in global_scope

   File "/usr/local/www/data/python/templates/results_body.html", line 
1, in ?

NameError: name 'answer' is not defined

I don't know why it is not defined.  If I call req.write direct in 
results() it will spit out answer and the the html from the template as 
plain text tags included.

I have tried calling the function in psp tags to no avail.  searchWords 
is then undefined.  I guess what I need to know is how to pass those 
variable to the html templates.  DO I need to import something, within 
psp tags, in the html template?

TIA



Reed L. O'Brien wrote:

>
> 
> PSS:
> FreeBSD 5.2.1
> mod_python 3.1.3
> python 2.3.4
> SwishE 0.4


-- 


reed
4.6692016090

From Antonio at Memora.com  Mon Jun 21 19:14:50 2004
From: Antonio at Memora.com (Antonio Rodriguez)
Date: Mon Jun 21 18:14:50 2004
Subject: [mod_python] OSX 10.3 and Apache 1.3 Bus Error(10)
Message-ID: <69F6187F-C3D0-11D8-B4F5-000A95AC6C3C@Memora.com>

Hello all,

I'm trying to build mod_python for OSX for development. I've used it in  
production on linux and its been great. But since all of us at work  
have gotten groovy Apple laptops, I wanted to re-create our  
environment.

So, build environment:

>  * Stock OSX 10.3 (Panther)
>  * Apache/1.3.29 (Darwin) (stock build)
>  * mod_python/2.7.10 Python/2.3 (using stock Apple python)

For the build I wanted to use the Apple python even though its built  
with threads (on linux I've had no issues with mod_python with a  
threaded python so long as I dont run threaded code) because its what's  
there. The good news is that the configure test for threads on 2.3  
fails so no warning is issued.

That said, I had to make two changes to the src/Makefile. First I had  
to add -DEAPI to the gcc options (which I've had to do on linux for a  
while, why don't we make this part of the standard build file?). Then--  
and here is the questionable part-- I had to change the include for the  
python static library (libpython2.3.a) to point to:

> LIBS=-lm  /System/Library/Frameworks/Python.framework/Python -ldl

from:

> /System/Library/Frameworks/Python.framework/Versions/2.3/lib/ 
> python2.3/config/libpython2.3.a   -ldl

which was what configure chose.

I think this is the right thing to do as Apple has a sort of weird  
default python.

That said, when I try to run the test example from the docs, I get this  
in the apache error log:

> [Mon Jun 21 17:50:21 2004] [notice] child pid 3206 exit signal Bus  
> error (10)

Which I presume means that the apache child is seg-faulting for some  
reason.

Now, here is my question: is anyone out there using mod_python in this  
configuration on OSX? I know that we should be using apache2 but OSX  
(as well as Debian my production environment) is running way behind the  
ball on apache2 so I'm trying to build for 1.3. If anyone can point me  
in the right direction, I'm glad to take on the task of trying to build  
a package for OSX that people can use without having to go through the  
build process.

Thanks,

Antonio

From Antonio at Memora.com  Tue Jun 22 19:25:23 2004
From: Antonio at Memora.com (Antonio Rodriguez)
Date: Tue Jun 22 18:26:00 2004
Subject: [mod_python] OSX 10.3 and Apache 1.3 Bus Error(10) [future of mp
	on ap.1.3?]
In-Reply-To: <01017790-C490-11D8-8BA8-000D93AD1DB8@gnubia.net>
References: <69F6187F-C3D0-11D8-B4F5-000A95AC6C3C@Memora.com>
	<01017790-C490-11D8-8BA8-000D93AD1DB8@gnubia.net>
Message-ID: <0DA75105-C49B-11D8-B4F5-000A95AC6C3C@Memora.com>

Justin,

Good idea. I'd be happy to start a wiki on mod_python/OSX integration,  
or if a wiki already exists, to start a wiki page. If someone knows of  
an appropriate wiki, please just let me know where to start posting. If  
I don't hear from anyone, I'm happy to start it/ host it.

> I haven't tried using this new python to build mod_python 2.7 against  
> apache 1.3 from panther because I'd rather use apache2.  I'd rather  
> run it out of daemontools anyway.


I take it in the end you got it to work? Only on apache2? Also, am I to  
assume that mod_python 3 is all that anyone cares about? That is, is  
mod_python  like subversion, another reason for all of us to go to  
apache2?

AR




On Jun 22, 2004, at 5:06 PM, Justin Ryan wrote:

> Antonio,
>
> I feel your pain.  I spent about 3 weeks trying to get mod_python  
> working on my new powerbook.  I first tried (much like yourself) to  
> build against apache and python2.3 from panther, but got errors trying  
> to link against libpython2.3.a (which did not exist on my system).
>
> I tried installing python about every way possible for OSX.  moved  
> apple's python aside and installed MacPython.  Installed python from  
> fink and darwinports.  From source into /usr/local.  Eventually, I  
> decided that not using apple's python was causing more grief than it  
> was helping, so I decided to rebuild and install over the original  
> python (I tarred up /Library/Frameworks/Python.Framework - and I  
> suggest you do the same ;p).
>
> So, although I would really have rather not, I built apple's python  
> from source (in fact, I upgraded to 2.3.4).  just ./configure  
> --prefix=/usr --enable-framework --enable-shared --enable-threads.
>
> I'm not 100% sure if everything is in place on panther to build python  
> exactly as apple did (with all of the pyobjc stuff linked to cocoa and  
> whatnot).  i don't use that stuff, so I haven't tested it, but there  
> is a ton of documentation in the Mac/OSX directory of the python  
> source tree.
>
> I haven't tried using this new python to build mod_python 2.7 against  
> apache 1.3 from panther because I'd rather use apache2.  I'd rather  
> run it out of daemontools anyway.
>
> I noticed that there are a few of us with a mix of success/failure  
> running mod_python on osx.  perhaps we should compile a howto and/or  
> start a wiki.
>
> Cheers!
>
> -=JR
>
> On Jun 21, 2004, at 5:14 PM, Antonio Rodriguez wrote:
>
>> Hello all,
>>
>> I'm trying to build mod_python for OSX for development. I've used it  
>> in production on linux and its been great. But since all of us at  
>> work have gotten groovy Apple laptops, I wanted to re-create our  
>> environment.
>>
>> So, build environment:
>>
>>>  * Stock OSX 10.3 (Panther)
>>>  * Apache/1.3.29 (Darwin) (stock build)
>>>  * mod_python/2.7.10 Python/2.3 (using stock Apple python)
>>
>> For the build I wanted to use the Apple python even though its built  
>> with threads (on linux I've had no issues with mod_python with a  
>> threaded python so long as I dont run threaded code) because its  
>> what's there. The good news is that the configure test for threads on  
>> 2.3 fails so no warning is issued.
>>
>> That said, I had to make two changes to the src/Makefile. First I had  
>> to add -DEAPI to the gcc options (which I've had to do on linux for a  
>> while, why don't we make this part of the standard build file?).  
>> Then-- and here is the questionable part-- I had to change the  
>> include for the python static library (libpython2.3.a) to point to:
>>
>>> LIBS=-lm  /System/Library/Frameworks/Python.framework/Python -ldl
>>
>> from:
>>
>>> /System/Library/Frameworks/Python.framework/Versions/2.3/lib/ 
>>> python2.3/config/libpython2.3.a   -ldl
>>
>> which was what configure chose.
>>
>> I think this is the right thing to do as Apple has a sort of weird  
>> default python.
>>
>> That said, when I try to run the test example from the docs, I get  
>> this in the apache error log:
>>
>>> [Mon Jun 21 17:50:21 2004] [notice] child pid 3206 exit signal Bus  
>>> error (10)
>>
>> Which I presume means that the apache child is seg-faulting for some  
>> reason.
>>
>> Now, here is my question: is anyone out there using mod_python in  
>> this configuration on OSX? I know that we should be using apache2 but  
>> OSX (as well as Debian my production environment) is running way  
>> behind the ball on apache2 so I'm trying to build for 1.3. If anyone  
>> can point me in the right direction, I'm glad to take on the task of  
>> trying to build a package for OSX that people can use without having  
>> to go through the build process.
>>
>> Thanks,
>>
>> Antonio
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>
>
>

From sharky at codezone.ath.cx  Wed Jun 23 23:55:28 2004
From: sharky at codezone.ath.cx (Sharky @ Code Zone)
Date: Wed Jun 23 17:52:02 2004
Subject: [mod_python] servlets and sessions tutorial...
Message-ID: <1088027728.11658.11.camel@sharkylandia.homelinux.net>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: smiley-10.png
Type: image/png
Size: 848 bytes
Desc: not available
Url : http://modpython.org/pipermail/mod_python/attachments/20040623/92331561/smiley-10.png
From alucard at kanux.com  Wed Jun 23 19:26:07 2004
From: alucard at kanux.com (Juan Hernandez)
Date: Wed Jun 23 18:26:12 2004
Subject: [mod_python] ImportError: No module named mptest
In-Reply-To: <40D7274E.3020008@kanux.com>
References: <40D7274E.3020008@kanux.com>
Message-ID: <40DA037F.5000104@kanux.com>

Any Ideas? I haven't got any anser :(

Juan Hernandez wrote:

> Hi there...
>
>    This is my first question to this mailing list and I guess it's a 
> pretty stupid one... I haven't found a solution to it. I'm trying to 
> insta ll mod_python inmy slackware machine, my apache was built from 
> source -it's not tar.gz package- and I'm getting this error:
>
> -------
>
> Mod_python error: "PythonHandler mptest"
>
> Traceback (most recent call last):
>
>  File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 
> 181, in Dispatch
>    module = import_module(module_name, _req)
>
>  File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 
> 332, in import_module
>    f, p, d = imp.find_module(parts[i], path)
>
> ImportError: No module named mptest
> ------
> And here's my apache virtual domain directive
>
> NameVirtualHost 10.73.219.156
>
> <VirtualHost 10.73.219.156>
>    ServerName webmail.domain.com.ve
>    ServerAlias www.domain.com.ve
>    ServerAlias domain.com.ve
>    DocumentRoot /home/domain
>    ErrorLog /var/log/apache/webmail.domain.com.ve-error_log
>    CustomLog /var/log/apache/webmail.domain.com.ve-access_log combined
> </VirtualHost>
>
> <Directory /home/webmail/python/>
> AddHandler python-program .py
> PythonHandler mptest
> PythonDebug On
> </Directory>
>
> -----
> All I have been able to find is that, is that in version 2.7.7 there 
> was a misspelled word that causes this and, that it was fixed in 2.8.8 
> and I'm using 2.7.10 with apache 1.3.31
>
> Thanks a lot for your time
>
> Juan
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python


From sharky at codezone.ath.cx  Thu Jun 24 00:43:18 2004
From: sharky at codezone.ath.cx (Sharky @ Code Zone)
Date: Wed Jun 23 18:40:01 2004
Subject: [mod_python] ImportError: No module named mptest
In-Reply-To: <40DA037F.5000104@kanux.com>
References: <40D7274E.3020008@kanux.com>  <40DA037F.5000104@kanux.com>
Message-ID: <1088030598.11658.21.camel@sharkylandia.homelinux.net>

1? where do you have your mptest.py? (directory)? 
    /home/domain ???
    /home/webmail/python/  ?????

2? what is the url to your mptest?
    http://webmail.domain.com.ve/python   ????

I think that is only your httpd.conf config that its wrong. maybe
something like:
<VirtualHost 10.73.219.156>
   ServerName webmail.domain.com.ve
   ServerAlias www.domain.com.ve
   ServerAlias domain.com.ve
   DocumentRoot /home/domain
   ErrorLog /var/log/apache/webmail.domain.com.ve-error_log
   CustomLog /var/log/apache/webmail.domain.com.ve-access_log combined
</VirtualHost>

<Directory /home/domain/python/>
AddHandler python-program .py
PythonHandler mptest
PythonDebug On
</Directory>

And your mptest.py must be in: /home/domain/python/

Un saludo
Sharky @ PTNet



A Qua, 2004-06-23 ?s 23:26, Juan Hernandez escreveu:

> Any Ideas? I haven't got any anser :(
> 
> Juan Hernandez wrote:
> 
> > Hi there...
> >
> >    This is my first question to this mailing list and I guess it's a 
> > pretty stupid one... I haven't found a solution to it. I'm trying to 
> > insta ll mod_python inmy slackware machine, my apache was built from 
> > source -it's not tar.gz package- and I'm getting this error:
> >
> > -------
> >
> > Mod_python error: "PythonHandler mptest"
> >
> > Traceback (most recent call last):
> >
> >  File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 
> > 181, in Dispatch
> >    module = import_module(module_name, _req)
> >
> >  File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 
> > 332, in import_module
> >    f, p, d = imp.find_module(parts[i], path)
> >
> > ImportError: No module named mptest
> > ------
> > And here's my apache virtual domain directive
> >
> > NameVirtualHost 10.73.219.156
> >
> > <VirtualHost 10.73.219.156>
> >    ServerName webmail.domain.com.ve
> >    ServerAlias www.domain.com.ve
> >    ServerAlias domain.com.ve
> >    DocumentRoot /home/domain
> >    ErrorLog /var/log/apache/webmail.domain.com.ve-error_log
> >    CustomLog /var/log/apache/webmail.domain.com.ve-access_log combined
> > </VirtualHost>
> >
> > <Directory /home/webmail/python/>
> > AddHandler python-program .py
> > PythonHandler mptest
> > PythonDebug On
> > </Directory>
> >
> > -----
> > All I have been able to find is that, is that in version 2.7.7 there 
> > was a misspelled word that causes this and, that it was fixed in 2.8.8 
> > and I'm using 2.7.10 with apache 1.3.31
> >
> > Thanks a lot for your time
> >
> > Juan
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://modpython.org/pipermail/mod_python/attachments/20040623/880d9bb1/attachment.html
From python at dan-olsen.net  Wed Jun 23 17:42:33 2004
From: python at dan-olsen.net (Dan Olsen)
Date: Wed Jun 23 18:42:41 2004
Subject: [mod_python] mod_python and xml parsing
Message-ID: <40DA0759.5010309@dan-olsen.net>

I was wondering if anyone could help me figure out how to do some xml 
parsing with mod_python.  The code I have is:

#####################################
from mod_python import apache
import xml.dom.minidom
import urllib

def crazy(req, url):
    sock = urllib.urlopen( url )
    indata = sock.read()
    sock.close()
    dom = parse(indata)
    return "<html>PASS</html>"

#####################################

The output that I get when I try to run the script in my browser is:

#####################################

Mod_python error: "PythonHandler mod_python.publisher"

Traceback (most recent call last):

File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 193, 
in Dispatch
result = object(req)

File "/usr/lib/python2.3/site-packages/mod_python/publisher.py", line 
171, in handler
result = apply(object, (), args)

File "/web/htdocs/python/rose.py", line 9, in crazy

File "/usr/lib/python2.3/site-packages/_xmlplus/dom/minidom.py", line 
1908, in parse
return expatbuilder.parse(file)

AttributeError: 'module' object has no attribute 'parse'

######################################

Can anyone help me figure out what I am doing wrong? I have tried 
tweaking the code a little bit but with no luck.  Is there some 
documentation out there that I can read about mod_python and parsing XML?

-- Dan Olsen


From ppercot at free.fr  Thu Jun 24 01:42:57 2004
From: ppercot at free.fr (Patrick Percot)
Date: Wed Jun 23 18:43:02 2004
Subject: [mod_python] ImportError: No module named mptest
In-Reply-To: <40DA037F.5000104@kanux.com>
References: <40D7274E.3020008@kanux.com>
	<40DA037F.5000104@kanux.com>
Message-ID: <20040624.004257.130242326.ppercot@free.fr>

On Wed, 23 Jun 2004 18:26:07 -0400, Juan Hernandez <alucard@kanux.com> wrote

> Any Ideas? I haven't got any anser :(

Hum, perhaps ... 


[..Zapp? 27 lignes et 849 caract?res..]

> >
> > NameVirtualHost 10.73.219.156
> >
> > <VirtualHost 10.73.219.156>
> >    ServerName webmail.domain.com.ve
> >    ServerAlias www.domain.com.ve
> >    ServerAlias domain.com.ve
> >    DocumentRoot /home/domain
> >    ErrorLog /var/log/apache/webmail.domain.com.ve-error_log
> >    CustomLog /var/log/apache/webmail.domain.com.ve-access_log combined
> > </VirtualHost>
> >
> > <Directory /home/webmail/python/>
> > AddHandler python-program .py
> > PythonHandler mptest

Remove this -->>> PythonDebug On

And add those lines :
	<Files *>
		PythonPath "sys.path + ['/home/webmail/python']"
		PythonDebug On
	</Files>
> > </Directory>

Tell me if it works for you. 

[..Zapp? 21 lignes et 598 caract?res..]

?+
PP
-- 
Groupe Morbihannais d'Utilisateurs de Logiciels Libres http://www.tuxbihan.org
Identifiant Jabber: pp@amessage.de
GPG fingerprint = 1A4F E154 3D2C A20E E4CA  A543 7951 C5C2 E44A A0B5

Patrick Percot.

From jgentil at sebistar.net  Wed Jun 23 19:34:07 2004
From: jgentil at sebistar.net (Jon-Pierre Gentil)
Date: Wed Jun 23 19:34:11 2004
Subject: [mod_python] Unicode support?
Message-ID: <40DA136F.2020205@sebistar.net>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1


How can the output be encoded in UTF-8?  The publisher breaks on this:

=============
Mod_python error: "PythonHandler mod_python.publisher"

Traceback (most recent call last):

  File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line
299, in HandlerDispatch
    result = object(req)

  File "/usr/lib/python2.3/site-packages/mod_python/publisher.py", line
143, in handler
    result = str(result)

UnicodeEncodeError: 'ascii' codec can't encode characters in position
2144-2145: ordinal not in range(128)
==============

Why does it re-encode it?



- --
::  Jon-Pierre Gentil
::  PGP Key ID 0xA21BC30E
::  Jabber: jgentil@jabber.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iEYEARECAAYFAkDaE2EACgkQOrVFmaIbww47AQCgiZSNxeMj+QcqwnuP0BPF2611
jwYAmwb92K9WDhbqrbZLBJXs1MiASYMr
=iNAa
-----END PGP SIGNATURE-----
From mateusz at ant.gliwice.pl  Thu Jun 24 05:09:28 2004
From: mateusz at ant.gliwice.pl (Mateusz Korniak)
Date: Wed Jun 23 22:03:31 2004
Subject: [mod_python] Unicode support?
In-Reply-To: <40DA136F.2020205@sebistar.net>
References: <40DA136F.2020205@sebistar.net>
Message-ID: <40DA37D8.4020503@ant.gliwice.pl>

Jon-Pierre Gentil wrote:

>=============
>Mod_python error: "PythonHandler mod_python.publisher"
>
>Traceback (most recent call last):
>
>  File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line
>299, in HandlerDispatch
>    result = object(req)
>
>  File "/usr/lib/python2.3/site-packages/mod_python/publisher.py", line
>143, in handler
>    result = str(result)
>
>UnicodeEncodeError: 'ascii' codec can't encode characters in position
>2144-2145: ordinal not in range(128)
>==============
>
>Why does it re-encode it?
>  
>
I assume result is unicode string, so str() tries to convert it to local 
representation, which may be 'ascii' for mod_python.

Try:
result = result.encode("utf-8")

Mateusz Korniak


From alucard at kanux.com  Thu Jun 24 01:03:22 2004
From: alucard at kanux.com (Juan Hernandez)
Date: Thu Jun 24 00:03:29 2004
Subject: [mod_python] ImportError: No module named mptest
In-Reply-To: <20040624.004257.130242326.ppercot@free.fr>
References: <40D7274E.3020008@kanux.com>	<40DA037F.5000104@kanux.com>
	<20040624.004257.130242326.ppercot@free.fr>
Message-ID: <40DA528A.3060507@kanux.com>

Hi there again,

     Thanks for all the answers but, I bet that I still don't understand 
many things in this new module I'm trying to use, I'm, just a PHP 
programmer really looking into python and I know it rocks... Let me ask 
you guys a few questions before going further.

This one above  is the local domain where I want the mod_python to work
=====
NameVirtualHost 10.73.219.156

<VirtualHost 10.73.219.156>
    ServerName webmail.domain.com.ve
    ServerAlias www.domain.com.ve
    ServerAlias domain.com.ve
    DocumentRoot /home/webmail
    ErrorLog /var/log/apache/webmail.domain.com.ve-error_log
    CustomLog /var/log/apache/webmail.domain.com.ve-access_log combined
</VirtualHost>
=====

And, after all the documentation I read, this is how -as a apache 
module- I load it into that specific domain -let's mention that I'm 
using the setup before all the answers I got from the list-

=====

<Directory /home/webmail/python/>
AddHandler python-program .py
PythonHandler mptest
PythonDebug On
</Directory>
=====
There are some things that I dont understand here...
- PythonHandler mptest <<--- What is this? Some people tell me that I 
have to have it inside /home/webmail/python/, something like index.php 
or in this case, mptest.py?? or is it a function or some kind or value 
called from mod_python's includes or conf files? because I've read that 
this error is caused by some misspelled word in version 2.7.7 and I'm 
using 2.7.10 where i'ts supoused to be fixed.

=====

Mod_python error: "PythonHandler mptest"

Traceback (most recent call last):

  File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 181, in Dispatch
    module = import_module(module_name, _req)

  File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 332, in import_module
    f, p, d = imp.find_module(parts[i], path)


ImportError: No module named mptest

=====

PythonHandler mptest <<-- where does it come from? if it's a file... how 
come it's not in my system?

Thanks a lot for this help... I know how hard is to discuss stuff with 
newbies hehehe

Juan

From sharky at codezone.ath.cx  Thu Jun 24 10:17:18 2004
From: sharky at codezone.ath.cx (Sharky (PTNet))
Date: Thu Jun 24 04:16:59 2004
Subject: [mod_python] servlets and sessions tutorial...
In-Reply-To: <40DA1342.3040902@intersiege.com>
References: <1088027728.11658.11.camel@sharkylandia.homelinux.net>
	<40DA1342.3040902@intersiege.com>
Message-ID: <43534.195.124.18.133.1088065038.squirrel@195.124.18.133>

Yes, many times...    :(

> have you tried restarting apache?
>
>
> Sharky @ Code Zone wrote:
>
>> Hi,
>>
>>     I have install mod_python and servlets to begin building some web
>> python aplications.
>>
>>     I try read servlets tutorial but when i go to sessions tutorial
>> (page 13) have some errors and the browser dont stop loading...
>>
>>     You can see tutorial working at
>> http://sharky.homelinux.net/mps_tutorial/
>>     You can see sutorial sessions error at
>> http://sharky.homelinux.net/mps_tutorial/sessions
>>
>> Thanks for all
>> Sharky @ PTNet
>>
>> PS.: Sorry my english, i'm from Portugal :P
>>
>>------------------------------------------------------------------------
>>
>>_______________________________________________
>>Mod_python mailing list
>>Mod_python@modpython.org
>>http://mailman.modpython.org/mailman/listinfo/mod_python
>>
>>
>

From sharky at codezone.ath.cx  Thu Jun 24 10:55:59 2004
From: sharky at codezone.ath.cx (Sharky (PTNet))
Date: Thu Jun 24 04:55:38 2004
Subject: [mod_python] servlets and sessions tutorial...
In-Reply-To: <43534.195.124.18.133.1088065038.squirrel@195.124.18.133>
References: <1088027728.11658.11.camel@sharkylandia.homelinux.net>
	<40DA1342.3040902@intersiege.com>
	<43534.195.124.18.133.1088065038.squirrel@195.124.18.133>
Message-ID: <37586.195.124.18.133.1088067359.squirrel@195.124.18.133>

Maybe this error tell you anything?

Mod_python error: "PythonHandler mod_python.servlet"

Traceback (most recent call last):

  File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 299,
in HandlerDispatch
    result = object(req)

  File "/usr/lib/python2.3/site-packages/mod_python/servlet.py", line
1454, in handler
    servlet.prep()

  File "/home/sharky/public_html/mps_tutorial/_TutorialBase.py", line 28,
in prep
    HTMLPage.prep(self)

  File "/usr/lib/python2.3/site-packages/mod_python/servlet.py", line 593,
in prep
    timeout=self.session_timeout)

  File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 389,
in Session
    timeout=timeout, lock=lock)

  File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 294,
in __init__
    timeout=timeout, lock=lock)

  File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 124,
in __init__
    if self.load():

  File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 185,
in load
    dict = self.do_load()

  File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 315,
in do_load
    dbm = self._get_dbm()

  File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 302,
in _get_dbm
    result = self._dbmtype.open(self._dbmfile, 'c')

  File "/usr/lib/python2.3/anydbm.py", line 80, in open
    raise error, "db type could not be determined"

error: db type could not be determined


> Yes, many times...    :(
>
>> have you tried restarting apache?
>>
>>
>> Sharky @ Code Zone wrote:
>>
>>> Hi,
>>>
>>>     I have install mod_python and servlets to begin building some web
>>> python aplications.
>>>
>>>     I try read servlets tutorial but when i go to sessions tutorial
>>> (page 13) have some errors and the browser dont stop loading...
>>>
>>>     You can see tutorial working at
>>> http://sharky.homelinux.net/mps_tutorial/
>>>     You can see sutorial sessions error at
>>> http://sharky.homelinux.net/mps_tutorial/sessions
>>>
>>> Thanks for all
>>> Sharky @ PTNet
>>>
>>> PS.: Sorry my english, i'm from Portugal :P
>>>
>>>------------------------------------------------------------------------
>>>
>>>_______________________________________________
>>>Mod_python mailing list
>>>Mod_python@modpython.org
>>>http://mailman.modpython.org/mailman/listinfo/mod_python
>>>
>>>
>>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From jgentil at sebistar.net  Thu Jun 24 09:44:56 2004
From: jgentil at sebistar.net (Jon-Pierre Gentil)
Date: Thu Jun 24 09:45:05 2004
Subject: [mod_python] Unicode support?
In-Reply-To: <40DA37D8.4020503@ant.gliwice.pl>
References: <40DA136F.2020205@sebistar.net> <40DA37D8.4020503@ant.gliwice.pl>
Message-ID: <40DADAD8.4050504@sebistar.net>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Mateusz Korniak wrote:

>> =============
>> Mod_python error: "PythonHandler mod_python.publisher"
>>
>> Traceback (most recent call last):
>>
>>  File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line
>> 299, in HandlerDispatch
>>    result = object(req)
>>
>>  File "/usr/lib/python2.3/site-packages/mod_python/publisher.py", line
>> 143, in handler
>>    result = str(result)
>>
>> UnicodeEncodeError: 'ascii' codec can't encode characters in position
>> 2144-2145: ordinal not in range(128)
>> ==============
>>
>> Why does it re-encode it?
>>
>>
> I assume result is unicode string, so str() tries to convert it to local
> representation, which may be 'ascii' for mod_python.
>
> Try:
> result = result.encode("utf-8")

My point is that the code is in publisher.py, inside mod_python.  I'm
not going to change the code of mod_python, at least without making a
patch for it... and consulting the developers.  I understand the process
of converting unicode strings, I just wish that mod_python wouldn't do
it at all.




- --
::  Jon-Pierre Gentil
::  PGP Key ID 0xA21BC30E
::  Jabber: jgentil@jabber.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iEYEARECAAYFAkDa2tcACgkQOrVFmaIbww4JEgCguZw5KQ8i9oKa+b5OUyOPoMhX
lUYAn1glRzTnX9MnIUKXSPdpeMBpl/5l
=gssa
-----END PGP SIGNATURE-----
From dpopowich at mtrsd.k12.ma.us  Thu Jun 24 10:41:24 2004
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Thu Jun 24 10:00:49 2004
Subject: [mod_python] servlets and sessions tutorial...
In-Reply-To: <37586.195.124.18.133.1088067359.squirrel@195.124.18.133>
References: <1088027728.11658.11.camel@sharkylandia.homelinux.net>
	<40DA1342.3040902@intersiege.com>
	<43534.195.124.18.133.1088065038.squirrel@195.124.18.133>
	<37586.195.124.18.133.1088067359.squirrel@195.124.18.133>
Message-ID: <16602.55812.55002.618935@gargle.gargle.HOWL>


> >>>     I have install mod_python and servlets to begin building some web
> >>> python aplications.
> >>>
> >>>     I try read servlets tutorial but when i go to sessions tutorial
> >>> (page 13) have some errors and the browser dont stop loading...
> >>>
> >>>     You can see tutorial working at
> >>> http://sharky.homelinux.net/mps_tutorial/
> >>>     You can see sutorial sessions error at
> >>> http://sharky.homelinux.net/mps_tutorial/sessions

The session support in servlets is built directly on top of standard
mod_python sessions.  I've seen sessions hang like this for a number
of reasons.  Some times it's apache, which you say you've restarted.

I'm wondering if you have a corrupted dbm file.  Look in /tmp for a
file named mp_sess.dbm.  Remove it and see if that cleans things up
for you.

Daniel




From nick at dd.revealed.net  Thu Jun 24 10:14:30 2004
From: nick at dd.revealed.net (Nick)
Date: Thu Jun 24 10:14:39 2004
Subject: [mod_python] Unicode support?
In-Reply-To: <40DADAD8.4050504@sebistar.net>
References: <40DA136F.2020205@sebistar.net> <40DA37D8.4020503@ant.gliwice.pl>
	<40DADAD8.4050504@sebistar.net>
Message-ID: <40DAE1C6.5070408@dd.revealed.net>

Jon-Pierre Gentil wrote:
>>Try:
>>result = result.encode("utf-8")
> 
> 
> My point is that the code is in publisher.py, inside mod_python.  I'm
> not going to change the code of mod_python, at least without making a
> patch for it... and consulting the developers.  I understand the process
> of converting unicode strings, I just wish that mod_python wouldn't do
> it at all.

It may be apache that's doing the encoding.  Check your apache config and 
turn off UTF-8, unless you really need unicode support then that won't help ;-)

Nick
From mateusz at ant.gliwice.pl  Thu Jun 24 17:22:35 2004
From: mateusz at ant.gliwice.pl (Mateusz Korniak)
Date: Thu Jun 24 10:16:34 2004
Subject: [mod_python] Unicode support?
In-Reply-To: <40DA4B7D.8070901@sebistar.net>
References: <40DA136F.2020205@sebistar.net> <40DA37D8.4020503@ant.gliwice.pl>
	<40DA4B7D.8070901@sebistar.net>
Message-ID: <40DAE3AB.3030906@ant.gliwice.pl>

Jon-Pierre Gentil wrote:

>Mateusz Korniak wrote:
>  
>
>>>=============
>>>Mod_python error: "PythonHandler mod_python.publisher"
>>>
>>>Traceback (most recent call last):
>>>
>>> File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line
>>>299, in HandlerDispatch
>>>   result = object(req)
>>>
>>> File "/usr/lib/python2.3/site-packages/mod_python/publisher.py", line
>>>143, in handler
>>>   result = str(result)
>>>
>>>UnicodeEncodeError: 'ascii' codec can't encode characters in position
>>>2144-2145: ordinal not in range(128)
>>>==============
>>>
>>>Why does it re-encode it?
>>>
>>>      
>>>
>My point is that the code is in publisher.py, inside mod_python.
>
Right. My fault.

>I'm
>not going to change the code of mod_python, at least without making a
>patch for it... and consulting the developers.  I understand the process
>of converting unicode strings, I just wish that mod_python wouldn't do
>it at all.
>  
>
So, how would You expect unicode result to be octed-represented by
default in that case ?


MMK


From ross at karchner.com  Thu Jun 24 11:30:37 2004
From: ross at karchner.com (Ross M Karchner)
Date: Thu Jun 24 10:30:41 2004
Subject: [mod_python] Unicode support?
In-Reply-To: <40DADAD8.4050504@sebistar.net>
References: <40DA136F.2020205@sebistar.net> <40DA37D8.4020503@ant.gliwice.pl>
	<40DADAD8.4050504@sebistar.net>
Message-ID: <40DAE58D.6090401@karchner.com>

Maybe you need to change Apache's and/or Python's default character sets?

See the "Your Application and Unicode" and "Browser Behavior" sections 
on this page:
http://dalchemy.com/opensource/unicodedoc/

Perhaps someone who knows more about this kind of stuff can comment on 
that articles applicability to mod_python.

-Ross

(Jon-Pierre- apologies that you got this twice)


Jon-Pierre Gentil wrote:

>My point is that the code is in publisher.py, inside mod_python.  I'm
>not going to change the code of mod_python, at least without making a
>patch for it... and consulting the developers.  I understand the process
>of converting unicode strings, I just wish that mod_python wouldn't do
>it at all.
>
>  
>
From grisha at modpython.org  Thu Jun 24 11:50:40 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Thu Jun 24 10:50:47 2004
Subject: [mod_python] using req object with Publisher
In-Reply-To: <1087333586.5415.25.camel@ibook.momentummedia.com>
References: <1087333586.5415.25.camel@ibook.momentummedia.com>
Message-ID: <20040624104839.T81620@onyx.ispol.com>


Certainly, why not? And I think it will work just fine without the raise 
statement at the end.

Also, unless you're on Apache 1.3, the send_http_header() does nothing, so 
you probably don't need it either.

Grisha

On Tue, 15 Jun 2004, Mark Nye wrote:

> Quick question from a newbie modpython user...
>
> Suppose I'm using Publisher to read GET or POST data, but would like to
> begin writing back to the browser immediately instead of collecting my
> entire page output in a string and returning it all at the end. (Maybe
> I'm looping through a long db result set, for example.) Does it make
> sense to do something like this:
>
>
> from mod_python import apache
>
> def myhandler(req, myvar1=None, myvar2=None):
> 	req.content_type = "text/html"
> 	req.send_http_header()
> 	req.write("my html") # of course I'd be doing more here
> 	raise apache.SERVER_RETURN, apache.OK
> 	return
>
>
> Or would anyone suggest a different approach? Thanks!
>
> Mark
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From sharky at codezone.ath.cx  Thu Jun 24 17:20:35 2004
From: sharky at codezone.ath.cx (Sharky (PTNet))
Date: Thu Jun 24 11:20:25 2004
Subject: [mod_python] servlets and sessions tutorial...
In-Reply-To: <16602.55812.55002.618935@gargle.gargle.HOWL>
References: <1088027728.11658.11.camel@sharkylandia.homelinux.net>
	<40DA1342.3040902@intersiege.com>
	<43534.195.124.18.133.1088065038.squirrel@195.124.18.133>
	<37586.195.124.18.133.1088067359.squirrel@195.124.18.133>
	<16602.55812.55002.618935@gargle.gargle.HOWL>
Message-ID: <38972.195.124.18.133.1088090435.squirrel@195.124.18.133>

>
>> >>>     I have install mod_python and servlets to begin building some
>> web
>> >>> python aplications.
>> >>>
>> >>>     I try read servlets tutorial but when i go to sessions tutorial
>> >>> (page 13) have some errors and the browser dont stop loading...
>> >>>
>> >>>     You can see tutorial working at
>> >>> http://sharky.homelinux.net/mps_tutorial/
>> >>>     You can see sutorial sessions error at
>> >>> http://sharky.homelinux.net/mps_tutorial/sessions
>
> The session support in servlets is built directly on top of standard
> mod_python sessions.  I've seen sessions hang like this for a number
> of reasons.  Some times it's apache, which you say you've restarted.
>
> I'm wondering if you have a corrupted dbm file.  Look in /tmp for a
> file named mp_sess.dbm.  Remove it and see if that cleans things up
> for you.
>
> Daniel
>

rm /tmp/mp_sess.dbm  (have 0 bytes)
/etc/rc.d/rc.httpd restart

browse to link http://sharky.homelinux.net/mps_tutorial/sessions and works
fine the first time (apparently)...
It generate another /tmp/mp_sess.dbm  with 0 bytes, browser stop loading but
when i look to apache error log i see this:

[Thu Jun 24 16:14:41 2004] [error] [client 195.124.18.133] PythonHandler
mod_python.servlet: Traceback (most recent call last):, referer:
http://sharky.homelinux.net/mps_tutorial/
[Thu Jun 24 16:14:41 2004] [error] [client 195.124.18.133] PythonHandler
mod_python.servlet:   File
"/usr/lib/python2.3/site-packages/mod_python/apache.py", line 299, in
HandlerDispatch\n    result = object(req), referer:
http://sharky.homelinux.net/mps_tutorial/
[Thu Jun 24 16:14:41 2004] [error] [client 195.124.18.133] PythonHandler
mod_python.servlet:   File
"/usr/lib/python2.3/site-packages/mod_python/servlet.py", line 1462, in
handler\n    servlet._finally(), referer:
http://sharky.homelinux.net/mps_tutorial/
[Thu Jun 24 16:14:41 2004] [error] [client 195.124.18.133] PythonHandler
mod_python.servlet:   File
"/usr/lib/python2.3/site-packages/mod_python/servlet.py", line 688, in
_finally\n    self.__cleanup_session(), referer:
http://sharky.homelinux.net/mps_tutorial/
[Thu Jun 24 16:14:41 2004] [error] [client 195.124.18.133] PythonHandler
mod_python.servlet:   File
"/usr/lib/python2.3/site-packages/mod_python/servlet.py", line 386, in
__cleanup_session\n    self.session.save(), referer:
http://sharky.homelinux.net/mps_tutorial/
[Thu Jun 24 16:14:41 2004] [error] [client 195.124.18.133] PythonHandler
mod_python.servlet:   File
"/usr/lib/python2.3/site-packages/mod_python/Session.py", line 204, in
save\n    self.do_save(dict), referer:
http://sharky.homelinux.net/mps_tutorial/
[Thu Jun 24 16:14:41 2004] [error] [client 195.124.18.133] PythonHandler
mod_python.servlet:   File
"/usr/lib/python2.3/site-packages/mod_python/Session.py", line 327, in
do_save\n    dbm = self._get_dbm(), referer:
http://sharky.homelinux.net/mps_tutorial/
[Thu Jun 24 16:14:41 2004] [error] [client 195.124.18.133] PythonHandler
mod_python.servlet:   File
"/usr/lib/python2.3/site-packages/mod_python/Session.py", line 302, in
_get_dbm\n    result = self._dbmtype.open(self._dbmfile, 'c'), referer:
http://sharky.homelinux.net/mps_tutorial/
[Thu Jun 24 16:14:41 2004] [error] [client 195.124.18.133] PythonHandler
mod_python.servlet:   File "/usr/lib/python2.3/anydbm.py", line 83, in
open\n    return mod.open(file, flag, mode), referer:
http://sharky.homelinux.net/mps_tutorial/
[Thu Jun 24 16:14:41 2004] [error] [client 195.124.18.133] PythonHandler
mod_python.servlet:   File "/usr/lib/python2.3/dbhash.py", line 16, in
open\n    return bsddb.hashopen(file, flag, mode), referer:
http://sharky.homelinux.net/mps_tutorial/
[Thu Jun 24 16:14:41 2004] [error] [client 195.124.18.133] PythonHandler
mod_python.servlet:   File "/usr/lib/python2.3/bsddb/__init__.py", line
192, in hashopen\n    d.open(file, db.DB_HASH, flags, mode), referer:
http://sharky.homelinux.net/mps_tutorial/
[Thu Jun 24 16:14:41 2004] [error] [client 195.124.18.133] PythonHandler
mod_python.servlet: DBInvalidArgError: (22, 'Invalid argument'), referer:
http://sharky.homelinux.net/mps_tutorial/






> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From jgentil at sebistar.net  Thu Jun 24 11:58:37 2004
From: jgentil at sebistar.net (Jon-Pierre Gentil)
Date: Thu Jun 24 11:58:41 2004
Subject: [mod_python] Unicode support?
In-Reply-To: <40DAE1C6.5070408@dd.revealed.net>
References: <40DA136F.2020205@sebistar.net> <40DA37D8.4020503@ant.gliwice.pl>
	<40DADAD8.4050504@sebistar.net> <40DAE1C6.5070408@dd.revealed.net>
Message-ID: <40DAFA2D.2050601@sebistar.net>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Nick wrote:
> Jon-Pierre Gentil wrote:
>
>>> Try:
>>> result = result.encode("utf-8")
>>
>>
>>
>> My point is that the code is in publisher.py, inside mod_python.  I'm
>> not going to change the code of mod_python, at least without making a
>> patch for it... and consulting the developers.  I understand the process
>> of converting unicode strings, I just wish that mod_python wouldn't do
>> it at all.
>
>
> It may be apache that's doing the encoding.  Check your apache config
> and turn off UTF-8, unless you really need unicode support then that
> won't help ;-)

It's not, though.  It's done in mod_python, in the Publisher, line 143
of publisher.py.  :)  If I use my own handler it works great, I can
output UTF-8 or UTF-16 or any other character set.  For some reason the
publisher tries to convert it to ascii.

- --
::  Jon-Pierre Gentil
::  PGP Key ID 0xA21BC30E
::  Jabber: jgentil@jabber.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iEYEARECAAYFAkDa+i0ACgkQOrVFmaIbww7CTQCglDP/lxhKYhiMDwXBr0p7QZHm
Wt4An3BGn7k2W4w5puKNk4XdDl6ZFkih
=Kq0k
-----END PGP SIGNATURE-----
From jgentil at sebistar.net  Thu Jun 24 12:00:06 2004
From: jgentil at sebistar.net (Jon-Pierre Gentil)
Date: Thu Jun 24 12:00:08 2004
Subject: [mod_python] Unicode support?
In-Reply-To: <40DAE58D.6090401@karchner.com>
References: <40DA136F.2020205@sebistar.net>
	<40DA37D8.4020503@ant.gliwice.pl>	<40DADAD8.4050504@sebistar.net>
	<40DAE58D.6090401@karchner.com>
Message-ID: <40DAFA86.8090302@sebistar.net>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Ross M Karchner wrote:
> Maybe you need to change Apache's and/or Python's default character sets?
>
> See the "Your Application and Unicode" and "Browser Behavior" sections
> on this page:
> http://dalchemy.com/opensource/unicodedoc/
>
> Perhaps someone who knows more about this kind of stuff can comment on
> that articles applicability to mod_python.

I may try sys.setdefaultencoding("utf-8"), and see if that causes the
str() function to return a unicode string.

> (Jon-Pierre- apologies that you got this twice)

Its quite alright, I wish they'd set the "Reply-To:" header to reply to
the mailing list.  :-/

- --
::  Jon-Pierre Gentil
::  PGP Key ID 0xA21BC30E
::  Jabber: jgentil@jabber.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iEYEARECAAYFAkDa+oYACgkQOrVFmaIbww4d+QCfUHWg+8UNVu7smh1KAWc8gwGl
RdAAn3RsqoMRxUazH2kRLAL6UXkDWz8X
=ir4i
-----END PGP SIGNATURE-----
From manfred.stienstra at dwerg.net  Thu Jun 24 23:07:50 2004
From: manfred.stienstra at dwerg.net (Manfred Stienstra)
Date: Thu Jun 24 16:07:53 2004
Subject: [mod_python] mod_python and xml parsing
In-Reply-To: <40DA0759.5010309@dan-olsen.net>
References: <40DA0759.5010309@dan-olsen.net>
Message-ID: <1088107670.13505.2.camel@ack.dwerg.net>

On Thu, 2004-06-24 at 00:42, Dan Olsen wrote:
> from mod_python import apache
> import xml.dom.minidom
> import urllib
> 
> def crazy(req, url):
>     sock = urllib.urlopen( url )
>     indata = sock.read()
>     sock.close()
>     dom = parse(indata)
>     return "<html>PASS</html>"

> Can anyone help me figure out what I am doing wrong? I have tried 
> tweaking the code a little bit but with no luck.  Is there some 
> documentation out there that I can read about mod_python and parsing XML?

The function parse is not defined. You probably want something like
xml.dom.minidom.parseString(indata).

Manfred

From python at dan-olsen.net  Thu Jun 24 15:13:15 2004
From: python at dan-olsen.net (Dan Olsen)
Date: Thu Jun 24 16:13:25 2004
Subject: [mod_python] mod_python and xml parsing
In-Reply-To: <1088107670.13505.2.camel@ack.dwerg.net>
References: <40DA0759.5010309@dan-olsen.net>
	<1088107670.13505.2.camel@ack.dwerg.net>
Message-ID: <40DB35DB.7080400@dan-olsen.net>

That's a typo I used

from xml.dom.minidom import parse, parseString

I can get it to work if you just run it under python on my local 
machine.  It's when I run it under mod_python I get the error:

AttributeError: 'module' object has no attribute 'parse'

Any other ideas of what could be wrong?

Dan


Manfred Stienstra declared on 06/24/2004 02:07 PM:

>On Thu, 2004-06-24 at 00:42, Dan Olsen wrote:
>  
>
>>from mod_python import apache
>>import xml.dom.minidom
>>import urllib
>>
>>def crazy(req, url):
>>    sock = urllib.urlopen( url )
>>    indata = sock.read()
>>    sock.close()
>>    dom = parse(indata)
>>    return "<html>PASS</html>"
>>    
>>
>
>  
>
>>Can anyone help me figure out what I am doing wrong? I have tried 
>>tweaking the code a little bit but with no luck.  Is there some 
>>documentation out there that I can read about mod_python and parsing XML?
>>    
>>
>
>The function parse is not defined. You probably want something like
>xml.dom.minidom.parseString(indata).
>
>Manfred
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python
>  
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://modpython.org/pipermail/mod_python/attachments/20040624/027b1f9f/attachment.html
From manfred.stienstra at dwerg.net  Thu Jun 24 23:29:30 2004
From: manfred.stienstra at dwerg.net (Manfred Stienstra)
Date: Thu Jun 24 16:29:37 2004
Subject: [mod_python] mod_python and xml parsing
In-Reply-To: <40DB35DB.7080400@dan-olsen.net>
References: <40DA0759.5010309@dan-olsen.net>
	<1088107670.13505.2.camel@ack.dwerg.net>
	<40DB35DB.7080400@dan-olsen.net>
Message-ID: <1088108970.13505.7.camel@ack.dwerg.net>

On Thu, 2004-06-24 at 22:13, Dan Olsen wrote:
> Any other ideas of what could be wrong?

Look in the 

/usr/lib/python2.3/xml/dom

or equivalent directory to see if the module is properly installed. If
this is the case you should check if the system path is set properly in
the mod_python session. Also check if the script works on the server
commandline.

> > > Is there some documentation out there that I can read about mod_python and parsing XML.

All the documentation for the xml modules are in the standard python
documentation on python.org

Manfred

From python at dan-olsen.net  Thu Jun 24 15:44:05 2004
From: python at dan-olsen.net (Dan Olsen)
Date: Thu Jun 24 16:44:15 2004
Subject: [mod_python] mod_python and xml parsing
In-Reply-To: <1088108970.13505.7.camel@ack.dwerg.net>
References: <40DA0759.5010309@dan-olsen.net>	<1088107670.13505.2.camel@ack.dwerg.net>	<40DB35DB.7080400@dan-olsen.net>
	<1088108970.13505.7.camel@ack.dwerg.net>
Message-ID: <40DB3D15.40204@dan-olsen.net>

The script works on the server command line.  As far as I can tell the 
module is installed properly.  Seeing how it works on the command line I 
would think it should work in mod_python.  The system path is also correct.

Dan

Manfred Stienstra declared on 06/24/2004 02:29 PM:

>On Thu, 2004-06-24 at 22:13, Dan Olsen wrote:
>  
>
>>Any other ideas of what could be wrong?
>>    
>>
>
>Look in the 
>
>/usr/lib/python2.3/xml/dom
>
>or equivalent directory to see if the module is properly installed. If
>this is the case you should check if the system path is set properly in
>the mod_python session. Also check if the script works on the server
>commandline.
>
>  
>
>>>>Is there some documentation out there that I can read about mod_python and parsing XML.
>>>>        
>>>>
>
>All the documentation for the xml modules are in the standard python
>documentation on python.org
>
>Manfred
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python
>  
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://modpython.org/pipermail/mod_python/attachments/20040624/01b2b2bc/attachment.html
From gnb at itga.com.au  Fri Jun 25 10:42:40 2004
From: gnb at itga.com.au (Gregory Bond)
Date: Thu Jun 24 19:42:56 2004
Subject: [mod_python] servlets and sessions tutorial... 
In-Reply-To: Your message of Thu, 24 Jun 2004 16:20:35 +0100.
Message-ID: <200406242342.JAA08595@lightning.itga.com.au>


sharky@codezone.ath.cx said:
> It generate another /tmp/mp_sess.dbm  with 0 bytes, browser stop
> loading but 

Disk full? (for /tmp, disk full might be swap space full or vm exhausted or 
whatever)?  Quota exceeded?

Check the appropriate messages file (/var/log/messages on most machines).

From grisha at modpython.org  Thu Jun 24 21:54:27 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Thu Jun 24 20:54:36 2004
Subject: [mod_python] Unicode support?
In-Reply-To: <40DAFA2D.2050601@sebistar.net>
References: <40DA136F.2020205@sebistar.net> <40DA37D8.4020503@ant.gliwice.pl>
	<40DADAD8.4050504@sebistar.net> <40DAE1C6.5070408@dd.revealed.net>
	<40DAFA2D.2050601@sebistar.net>
Message-ID: <20040624203042.E81620@onyx.ispol.com>



On Thu, 24 Jun 2004, Jon-Pierre Gentil wrote:

>> and turn off UTF-8, unless you really need unicode support then that
>> won't help ;-)
>
> It's not, though.  It's done in mod_python, in the Publisher, line 143
> of publisher.py.  :)  If I use my own handler it works great, I can
> output UTF-8 or UTF-16 or any other character set.  For some reason the
> publisher tries to convert it to ascii.

I'm somewhat unicode illeterate, so this is probably why I never ran into 
any problems with this.

But here is an idea - str() simply calls the object's __str__ method - so 
why not subclass unicode and implement a __str__ that would produce UTF?

Something like this:


class MyUnicode(unicode):

     def __str__(self):
         return self.encode('utf-8')

def unicode(req):

     req.content_type = 'text/html; charset=UTF-8'

     return MyUnicode(u"Hello\u1234World!")



Grisha
From eric at ericwalstad.com  Thu Jun 24 21:37:25 2004
From: eric at ericwalstad.com (Eric Walstad)
Date: Thu Jun 24 23:37:29 2004
Subject: [mod_python] Servlets and templates and SimpleTAL (oh my!)
Message-ID: <200406242037.25778.eric@ericwalstad.com>

Hi all,

A recent post to this list made me look into Servlets again and now I'm 
interested in trying them. ?I currently use SimpleTAL for templating. ?I'm 
familiar with TAL/METAL from my Zope days and like using it. ?Daniel 
Popowich, in the Servlets tutorial, advocates using HyperText (I think), 
which seems to embed the presentation pretty firmly into the logic of the web 
app. ?I like keeping the presentation separate from the logic as much as 
possible. ?I'm curious to know if anyone has used SimpleTAL with Servlets or 
can offer insight on this mixture to someone with no Python Servlet 
experience.

Thanks for your time and thoughts.

Eric.

From manfred.stienstra at dwerg.net  Fri Jun 25 10:09:11 2004
From: manfred.stienstra at dwerg.net (Manfred Stienstra)
Date: Fri Jun 25 03:09:17 2004
Subject: [mod_python] mod_python and xml parsing
In-Reply-To: <40DB3D15.40204@dan-olsen.net>
References: <40DA0759.5010309@dan-olsen.net>
	<1088107670.13505.2.camel@ack.dwerg.net>	<40DB35DB.7080400@dan-olsen.net>
	<1088108970.13505.7.camel@ack.dwerg.net> <40DB3D15.40204@dan-olsen.net>
Message-ID: <1088147351.13067.1.camel@ack.dwerg.net>

On Thu, 2004-06-24 at 22:44, Dan Olsen wrote:
> The script works on the server command line.  As far as I can tell the
> module is installed properly.  Seeing how it works on the command line
> I would think it should work in mod_python.  The system path is also
> correct.

How did you install python? Are there multiple installations or just
one?

Manfred

From sharky at codezone.ath.cx  Fri Jun 25 10:26:15 2004
From: sharky at codezone.ath.cx (Sharky (PTNet))
Date: Fri Jun 25 04:25:50 2004
Subject: [mod_python] servlets and sessions tutorial...
In-Reply-To: <200406242342.JAA08595@lightning.itga.com.au>
References: Your message of Thu, 24 Jun 2004 16:20:35 +0100.
	<200406242342.JAA08595@lightning.itga.com.au>
Message-ID: <29571.195.124.18.133.1088151975.squirrel@195.124.18.133>

>
> sharky@codezone.ath.cx said:
>> It generate another /tmp/mp_sess.dbm  with 0 bytes, browser stop
>> loading but
>
> Disk full? (for /tmp, disk full might be swap space full or vm exhausted
> or
> whatever)?  Quota exceeded?
>

Don?t have quota limitations and have lots of space... dont have any hda
error and no messages in /var/log/messages or /var/log/syslog...
sharky@codezone:~$ df -h
Filesystem            Size  Used Avail Use% Mounted on
/dev/hda1             3.0G  1.6G  1.3G  55% /
/dev/hda2              46M  8.2M   35M  19% /boot
/dev/hda3             463M   92M  347M  21% /var
/dev/hdb1             5.2G  2.4G  2.5G  48% /home

> Check the appropriate messages file (/var/log/messages on most machines).
>
>

From ppercot at free.fr  Fri Jun 25 12:07:13 2004
From: ppercot at free.fr (Patrick Percot)
Date: Fri Jun 25 05:07:20 2004
Subject: [mod_python] servlets and sessions tutorial...
In-Reply-To: <29571.195.124.18.133.1088151975.squirrel@195.124.18.133>
References: <200406242342.JAA08595@lightning.itga.com.au>
	<29571.195.124.18.133.1088151975.squirrel@195.124.18.133>
Message-ID: <20040625.110713.77024232.ppercot@free.fr>

On Fri, 25 Jun 2004 09:26:15 +0100 (WEST), "Sharky (PTNet)" <sharky@codezone.ath.cx> wrote

> >
> > sharky@codezone.ath.cx said:
> >> It generate another /tmp/mp_sess.dbm  with 0 bytes, browser stop
> >> loading but
> >
> > Disk full? (for /tmp, disk full might be swap space full or vm exhausted
> > or
> > whatever)?  Quota exceeded?
> >
> 
> Don?t have quota limitations and have lots of space... dont have any hda
> error and no messages in /var/log/messages or /var/log/syslog...
> sharky@codezone:~$ df -h
> Filesystem            Size  Used Avail Use% Mounted on
> /dev/hda1             3.0G  1.6G  1.3G  55% /
> /dev/hda2              46M  8.2M   35M  19% /boot
> /dev/hda3             463M   92M  347M  21% /var
> /dev/hdb1             5.2G  2.4G  2.5G  48% /home

You have also to test the free inodes :

$ df -i

Because you can have a lot of free space, but no more inodes. 

?+
PP
-- 
Groupe Morbihannais d'Utilisateurs de Logiciels Libres http://www.tuxbihan.org
Identifiant Jabber: pp@amessage.de
GPG fingerprint = 1A4F E154 3D2C A20E E4CA  A543 7951 C5C2 E44A A0B5

Patrick Percot.

From sharky at codezone.ath.cx  Fri Jun 25 11:38:32 2004
From: sharky at codezone.ath.cx (Sharky (PTNet))
Date: Fri Jun 25 05:38:06 2004
Subject: [mod_python] servlets and sessions tutorial...
In-Reply-To: <20040625.110713.77024232.ppercot@free.fr>
References: <200406242342.JAA08595@lightning.itga.com.au>
	<29571.195.124.18.133.1088151975.squirrel@195.124.18.133>
	<20040625.110713.77024232.ppercot@free.fr>
Message-ID: <52874.195.124.18.133.1088156312.squirrel@195.124.18.133>

> On Fri, 25 Jun 2004 09:26:15 +0100 (WEST), "Sharky (PTNet)"
> <sharky@codezone.ath.cx> wrote
>
>> >
>> > sharky@codezone.ath.cx said:
>> >> It generate another /tmp/mp_sess.dbm  with 0 bytes, browser stop
>> >> loading but
>> >
>> > Disk full? (for /tmp, disk full might be swap space full or vm
>> exhausted
>> > or
>> > whatever)?  Quota exceeded?
>> >
>>
>> Don?t have quota limitations and have lots of space... dont have any hda
>> error and no messages in /var/log/messages or /var/log/syslog...
>> sharky@codezone:~$ df -h
>> Filesystem            Size  Used Avail Use% Mounted on
>> /dev/hda1             3.0G  1.6G  1.3G  55% /
>> /dev/hda2              46M  8.2M   35M  19% /boot
>> /dev/hda3             463M   92M  347M  21% /var
>> /dev/hdb1             5.2G  2.4G  2.5G  48% /home
>
> You have also to test the free inodes :
>
> $ df -i
>
> Because you can have a lot of free space, but no more inodes.
root@codezone:/home/vqadmin/html/config# df -i
Filesystem            Inodes   IUsed   IFree IUse% Mounted on
/dev/hda1             822016  118859  703157   15% /
/dev/hda2              12048      34   12014    1% /boot
/dev/hda3             122880    4763  118117    4% /var
/dev/hdb1            1406272   57921 1348351    5% /home

>
> ?+
> PP
> --
> Groupe Morbihannais d'Utilisateurs de Logiciels Libres
> http://www.tuxbihan.org
> Identifiant Jabber: pp@amessage.de
> GPG fingerprint = 1A4F E154 3D2C A20E E4CA  A543 7951 C5C2 E44A A0B5
>
> Patrick Percot.
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From John.Ertl at fnmoc.navy.mil  Fri Jun 25 08:25:46 2004
From: John.Ertl at fnmoc.navy.mil (Ertl, John)
Date: Fri Jun 25 10:19:49 2004
Subject: [mod_python] Mod_python Doc-style help
Message-ID: <E338ADD616B66043824B9ABF5CA6EF2332C20E@lanexc107p.fnmoc.navy.mil>

All,
The all to common "I am new to mod_python".  I have been using the ZSI SOAP
module for a simple RPC style web service that uses AsCGI for the dispatch.
I have been given the chance to work on a Virtual server that allows me to
use mod_python without messing up everyone else.   I have the simple example
of mod_python and ZSI working but now I want to look at turning the RPC
style web service into a doc-style service.   What I can't figure out is how
do I get to the soap body?   If any of you are familiar with ZSI I assume I
could use ParsedSoap but I am not sure what to do ParsedSoap on.  Is there a
better way to make a web service with mod_python?   In the little I have
read mod_python looks very promising but I just am just not able to link the
pieces together. 

Any ideas or simple examples would be appreciated.
Thanks,

John Ertl
From dpopowich at mtrsd.k12.ma.us  Fri Jun 25 11:57:06 2004
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Fri Jun 25 10:58:20 2004
Subject: [mod_python] Servlets and templates and SimpleTAL (oh my!)
In-Reply-To: <200406242037.25778.eric@ericwalstad.com>
References: <200406242037.25778.eric@ericwalstad.com>
Message-ID: <16604.15683.105843.245582@gargle.gargle.HOWL>


Eric Walstad writes:
> ...?Daniel Popowich, in the Servlets tutorial, advocates using
> HyperText (I think), which seems to embed the presentation pretty
> firmly into the logic of the web app. ?I like keeping the
> presentation separate from the logic as much as possible. ?

I quote the tutorial: "True confessions: I hate writing HTML. So, I
have always used packages like HTMLgen or HyperText."

To be clear, I'm advocating using packages like HyperText over writing
HTML strings, NOT embedding presentation into logic.  In fact, I make
rather strong statements in the README that comes with servlets
advocating the separation of code and content.

For tutorial purposes, it was too difficult to do anything other than
include the content in the servlet files, however, you will notice
that the content is always seperated from the logic and, typically, is
stored as a string at the end of the file.  This string could just as
easily have come from a database or template files.

Also, my view of HTML, and by extension, HyperText, is as a GUI widget
set.  DIVs and SPANs become containers whereby you can apply text
style and other display characteristics.  This is not too unlike a box
widget in tkinter or wxpython: create a widget, apply attributes,
stuff content into it.  In general, I don't think of HyperText objects
that manage page layout or forms (INPUTs generating buttons,
checkboxes, etc.) as content, but as logic!  Certainly, if you were
writing a tkinter app, that would be the case.

> I'm curious to know if anyone has used SimpleTAL with Servlets or
> can offer insight on this mixture to someone with no Python Servlet
> experience.

Anyway, as to your question about using a templating tool with
Servlets.  Why not?  You can store your content anywhere and using,
perhaps, PATHINFO as a lookup key, retrieve your content from a
database or directory hierarchy which is removed from your application
files. 

As an example, I have used servlets to write a fairly comprehensive
content management system: users (teachers/staff of a public school
system) with little or no experience with HTML and administrators with
even less experience maintaining a web server can log in to my web app
and maintain the website completely on-line.  It maintains a common
look & feel across a district of seven schools plus the
superintendent's office.  The logic is in a half-dozen or so python
files and the content is stored in a directory hierarchy outside of my
documentroot.  I use path_info (see Servlet doc) as a relative path
from the school's content root directory.  The files have meta
information stored with them (not unlike templates) which is applied
to the content and then returned via my app.

I should perhaps add a templating example to the tutorial; it would be
something like this: a file would exist (exmple.tpl) with the content
of the BODY and have tags or some such which would be replaced with
information collected from a form.  The servlet (template.mps) would,
on a GET, produce a form (HyperText widgets) and on a POST would read
the example.tpl, apply the data collected from the POST and return the
processed template as the content.

Hope this helps.

Cheers,

Daniel Popowich




From eric at ericwalstad.com  Fri Jun 25 09:23:56 2004
From: eric at ericwalstad.com (Eric Walstad)
Date: Fri Jun 25 11:24:00 2004
Subject: [mod_python] Servlets and templates and SimpleTAL (oh my!)
In-Reply-To: <16604.15683.105843.245582@gargle.gargle.HOWL>
References: <200406242037.25778.eric@ericwalstad.com>
	<16604.15683.105843.245582@gargle.gargle.HOWL>
Message-ID: <200406250823.57097.eric@ericwalstad.com>

Hi Daniel,
On Friday 25 June 2004 07:57 am, Daniel J. Popowich wrote:
> Eric Walstad writes:
> > ...?Daniel Popowich, in the Servlets tutorial, advocates using
> > HyperText (I think), which seems to embed the presentation pretty
> > firmly into the logic of the web app. ?I like keeping the
> > presentation separate from the logic as much as possible. ?
>
> I quote the tutorial: "True confessions: I hate writing HTML. So, I
> have always used packages like HTMLgen or HyperText."
[...]
I meant no offense, nor was I inferring poor design.  I'm sorry if it sounded 
that way.  I took a cursory look at Sharky's copy of your tutorial, liked 
your work and wanted to find out if others were using it in the way I was 
considering.

> > I'm curious to know if anyone has used SimpleTAL with Servlets or
> > can offer insight on this mixture to someone with no Python Servlet
> > experience.
>
> Anyway, as to your question about using a templating tool with
> Servlets.  Why not?  You can store your content anywhere and using,
> perhaps, PATHINFO as a lookup key, retrieve your content from a
> database or directory hierarchy which is removed from your application
> files.
[...]
> I should perhaps add a templating example to the tutorial; it would be
> something like this: a file would exist (exmple.tpl) with the content
> of the BODY and have tags or some such which would be replaced with
> information collected from a form.  The servlet (template.mps) would,
> on a GET, produce a form (HyperText widgets) and on a POST would read
> the example.tpl, apply the data collected from the POST and return the
> processed template as the content.
>
> Hope this helps.
It does, thank you.  I'm going to give Servlets a whirl.

Best regards,

Eric.

From alucard at kanux.com  Fri Jun 25 12:28:04 2004
From: alucard at kanux.com (Juan Hernandez)
Date: Fri Jun 25 11:28:15 2004
Subject: [mod_python] ImportError: No module named mptest
In-Reply-To: <40DA528A.3060507@kanux.com>
References: <40D7274E.3020008@kanux.com>	<40DA037F.5000104@kanux.com>
	<20040624.004257.130242326.ppercot@free.fr>
	<40DA528A.3060507@kanux.com>
Message-ID: <1088177284.19041.6.camel@alucard.kanux.com>

any ideas? hehe
Thanks
On Thu, 2004-06-24 at 00:03, Juan Hernandez wrote:
> Hi there again,
> 
>      Thanks for all the answers but, I bet that I still don't understand 
> many things in this new module I'm trying to use, I'm, just a PHP 
> programmer really looking into python and I know it rocks... Let me ask 
> you guys a few questions before going further.
> 
> This one above  is the local domain where I want the mod_python to work
> =====
> NameVirtualHost 10.73.219.156
> 
> <VirtualHost 10.73.219.156>
>     ServerName webmail.domain.com.ve
>     ServerAlias www.domain.com.ve
>     ServerAlias domain.com.ve
>     DocumentRoot /home/webmail
>     ErrorLog /var/log/apache/webmail.domain.com.ve-error_log
>     CustomLog /var/log/apache/webmail.domain.com.ve-access_log combined
> </VirtualHost>
> =====
> 
> And, after all the documentation I read, this is how -as a apache 
> module- I load it into that specific domain -let's mention that I'm 
> using the setup before all the answers I got from the list-
> 
> =====
> 
> <Directory /home/webmail/python/>
> AddHandler python-program .py
> PythonHandler mptest
> PythonDebug On
> </Directory>
> =====
> There are some things that I dont understand here...
> - PythonHandler mptest <<--- What is this? Some people tell me that I 
> have to have it inside /home/webmail/python/, something like index.php 
> or in this case, mptest.py?? or is it a function or some kind or value 
> called from mod_python's includes or conf files? because I've read that 
> this error is caused by some misspelled word in version 2.7.7 and I'm 
> using 2.7.10 where i'ts supoused to be fixed.
> 
> =====
> 
> Mod_python error: "PythonHandler mptest"
> 
> Traceback (most recent call last):
> 
>   File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 181, in Dispatch
>     module = import_module(module_name, _req)
> 
>   File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 332, in import_module
>     f, p, d = imp.find_module(parts[i], path)
> 
> 
> ImportError: No module named mptest
> 
> =====
> 
> PythonHandler mptest <<-- where does it come from? if it's a file... how 
> come it's not in my system?
> 
> Thanks a lot for this help... I know how hard is to discuss stuff with 
> newbies hehehe
> 
> Juan
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From vmanera at manord.com  Fri Jun 25 18:30:39 2004
From: vmanera at manord.com (Manera, Villiam)
Date: Fri Jun 25 11:34:08 2004
Subject: [mod_python] Windows mod-python apache problem
Message-ID: <52DC70C1C1575C418CB033523A29CF1401A76936@exchange2000.manord.com>

Some program not well tested may go in loop, or cause apache to work for
many minutes (10-20) with 100% use of cpu.<?xml:namespace prefix = o ns =
"urn:schemas-microsoft-com:office:office" />

 

When this happened all the other apache process stay waiting this one or run
very very very very slowly.

 

The problem is to find which module/program is running with 100% of cpu.
With task manager I can see  only the apache program but which of the 50
thread is using the cpu?  And more important which mod_python module is
managed by this thread.

 

I can see something with www.../status:  which module/program is waiting for
the reply .... but isn't enough

 

Someone may help me?

 <mailto:mod_python@modpython.org> 

Villiam 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://modpython.org/pipermail/mod_python/attachments/20040625/dded755a/attachment.html
From ppercot at free.fr  Fri Jun 25 18:45:48 2004
From: ppercot at free.fr (Patrick Percot)
Date: Fri Jun 25 11:45:54 2004
Subject: [mod_python] ImportError: No module named mptest
In-Reply-To: <1088177284.19041.6.camel@alucard.kanux.com>
References: <20040624.004257.130242326.ppercot@free.fr>
	<40DA528A.3060507@kanux.com>
	<1088177284.19041.6.camel@alucard.kanux.com>
Message-ID: <20040625.174548.23008276.ppercot@free.fr>

On Fri, 25 Jun 2004 11:28:04 -0400, Juan Hernandez <alucard@kanux.com> wrote

> any ideas? hehe

I will answer all your questions by the famous RTFM :)

And the f... manual is here :

http://modpython.org/live/current/doc-html/tut-what-it-do.html

[..Zapp? 78 lignes et 2747 caract?res..]


?+
PP
-- 
Groupe Morbihannais d'Utilisateurs de Logiciels Libres http://www.tuxbihan.org
Identifiant Jabber: pp@amessage.de
GPG fingerprint = 1A4F E154 3D2C A20E E4CA  A543 7951 C5C2 E44A A0B5

Patrick Percot.

From dpopowich at mtrsd.k12.ma.us  Fri Jun 25 15:52:13 2004
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Fri Jun 25 14:53:32 2004
Subject: [mod_python] Servlets and templates and SimpleTAL (oh my!)
In-Reply-To: <200406250823.57097.eric@ericwalstad.com>
References: <200406242037.25778.eric@ericwalstad.com>
	<16604.15683.105843.245582@gargle.gargle.HOWL>
	<200406250823.57097.eric@ericwalstad.com>
Message-ID: <16604.29789.373862.260556@gargle.gargle.HOWL>


Eric Walstad writes:
> I meant no offense, nor was I inferring poor design.  I'm sorry if
> it sounded that way.  I took a cursory look at Sharky's copy of your
> tutorial, liked your work and wanted to find out if others were
> using it in the way I was considering.

Honestly, no offense was taken.  I just wanted to make sure that
anyone reading this thread (now or months from now in the archives)
would read a counterpoint, because I, like you, strive to separate
code from content and want to make sure that servlets is seen as a
tool to achieve that end.

>> Hope this helps.
> It does, thank you.  I'm going to give Servlets a whirl.

Great.  If you have any questions don't hesitate to ask.

Cheers,

Daniel

From conrad at hep.caltech.edu  Sat Jun 26 09:36:22 2004
From: conrad at hep.caltech.edu (Conrad Steenberg)
Date: Sat Jun 26 11:36:27 2004
Subject: [mod_python] Mod_python Doc-style help
In-Reply-To: <E338ADD616B66043824B9ABF5CA6EF2332C20E@lanexc107p.fnmoc.navy.mil>
References: <E338ADD616B66043824B9ABF5CA6EF2332C20E@lanexc107p.fnmoc.navy.mil>
Message-ID: <1088264182.2483.9.camel@localhost.localdomain>

Hi John

I'm using this snippet in a mod_python-based server (clarens.sf.net):

try:
  import ZSI
  from ZSI import ParsedSoap, SoapWriter, TC, ZSI_SCHEMA_URI, \
    FaultFromFaultMessage, _child_elements, Fault
except:
  ZSI=None


        try:
          ps = ParsedSoap(data)
          method=ps.body_root.localName
          arg_data = _child_elements(ps.body_root)
          if len(arg_data) == 0:
            arg = []
          else:
            tc = TC.Any()
            arg = [ tc.parse(e, ps) for e in arg_data ]
          decoded=[str(method),arg]
        except ZSI.ParseException, e:
          write_response_soap(req,build_fault_soap_exception(req,e))
          return apache.OK


I.e. the method name would be in "method" and the arguments in "arg". I
don't know if this would work for a doc-style service...

The two methods referenced in the exception handler are:

def write_response_soap(req,message,code=apache.OK):
 req.content_type='text/xml; charset="utf-8"'
 req.headers_out['Server'] = "Clarens Apache/ZSI SOAP server %s"%_version
 req.send_http_header()
 req.write(message)

and 

def build_fault_soap(req,call,code,message):
  return ZSI.Fault(code,message).AsSOAP()

Cheers

Conrad

On Fri, 2004-06-25 at 07:25, Ertl, John wrote:
> All,
> The all to common "I am new to mod_python".  I have been using the ZSI SOAP
> module for a simple RPC style web service that uses AsCGI for the dispatch.
> I have been given the chance to work on a Virtual server that allows me to
> use mod_python without messing up everyone else.   I have the simple example
> of mod_python and ZSI working but now I want to look at turning the RPC
> style web service into a doc-style service.   What I can't figure out is how
> do I get to the soap body?   If any of you are familiar with ZSI I assume I
> could use ParsedSoap but I am not sure what to do ParsedSoap on.  Is there a
> better way to make a web service with mod_python?   In the little I have
> read mod_python looks very promising but I just am just not able to link the
> pieces together. 
> 
> Any ideas or simple examples would be appreciated.
> Thanks,
> 
> John Ertl
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
-- 
Conrad Steenberg <conrad@hep.caltech.edu>
From conrad at hep.caltech.edu  Sat Jun 26 09:44:26 2004
From: conrad at hep.caltech.edu (Conrad Steenberg)
Date: Sat Jun 26 11:44:31 2004
Subject: [mod_python] Mod_python Doc-style help
In-Reply-To: <1088264182.2483.9.camel@localhost.localdomain>
References: <E338ADD616B66043824B9ABF5CA6EF2332C20E@lanexc107p.fnmoc.navy.mil>
	<1088264182.2483.9.camel@localhost.localdomain>
Message-ID: <1088264666.2483.11.camel@localhost.localdomain>

On Sat, 2004-06-26 at 08:36, Conrad Steenberg wrote:
> Hi John
> 
> I'm using this snippet in a mod_python-based server (clarens.sf.net):
> 
> try:
>   import ZSI
>   from ZSI import ParsedSoap, SoapWriter, TC, ZSI_SCHEMA_URI, \
>     FaultFromFaultMessage, _child_elements, Fault
> except:
>   ZSI=None
> 
> 
>         try:
>           ps = ParsedSoap(data)

Btw, "data" above is the message body received from the client.

>           method=ps.body_root.localName
>           arg_data = _child_elements(ps.body_root)
>           if len(arg_data) == 0:
>             arg = []
>           else:
>             tc = TC.Any()
>             arg = [ tc.parse(e, ps) for e in arg_data ]
>           decoded=[str(method),arg]
>         except ZSI.ParseException, e:
>           write_response_soap(req,build_fault_soap_exception(req,e))
>           return apache.OK
> 
> 
> I.e. the method name would be in "method" and the arguments in "arg". I
> don't know if this would work for a doc-style service...
> 
> The two methods referenced in the exception handler are:
> 
> def write_response_soap(req,message,code=apache.OK):
>  req.content_type='text/xml; charset="utf-8"'
>  req.headers_out['Server'] = "Clarens Apache/ZSI SOAP server %s"%_version
>  req.send_http_header()
>  req.write(message)
> 
> and 
> 
> def build_fault_soap(req,call,code,message):
>   return ZSI.Fault(code,message).AsSOAP()
> 
> Cheers
> 
> Conrad
> 
> On Fri, 2004-06-25 at 07:25, Ertl, John wrote:
> > All,
> > The all to common "I am new to mod_python".  I have been using the ZSI SOAP
> > module for a simple RPC style web service that uses AsCGI for the dispatch.
> > I have been given the chance to work on a Virtual server that allows me to
> > use mod_python without messing up everyone else.   I have the simple example
> > of mod_python and ZSI working but now I want to look at turning the RPC
> > style web service into a doc-style service.   What I can't figure out is how
> > do I get to the soap body?   If any of you are familiar with ZSI I assume I
> > could use ParsedSoap but I am not sure what to do ParsedSoap on.  Is there a
> > better way to make a web service with mod_python?   In the little I have
> > read mod_python looks very promising but I just am just not able to link the
> > pieces together. 
> > 
> > Any ideas or simple examples would be appreciated.
> > Thanks,
> > 
> > John Ertl
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
-- 
Conrad Steenberg <conrad@hep.caltech.edu>
From gnb at itga.com.au  Mon Jun 28 11:05:24 2004
From: gnb at itga.com.au (Gregory Bond)
Date: Sun Jun 27 20:05:30 2004
Subject: [mod_python] servlets and sessions tutorial... 
In-Reply-To: Your message of Fri, 25 Jun 2004 11:07:13 +0200.
Message-ID: <200406280005.KAA27951@lightning.itga.com.au>


ppercot@free.fr said:
> You have also to test the free inodes : 

Sharky has already replied to this, but in general this wouldn't be an
out-of-inodes problem, because the file exists (i.e. the new inode allocated) 
but it is zero size (which might mean out of disk space / quota).

And it takes a very very unusual setup to run out of inodes with 50% space 
free.... (/var/spool/news being the canonical case, but no-one seems to have 
one of those any more!)



From dpopowich at mtrsd.k12.ma.us  Mon Jun 28 10:18:04 2004
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Mon Jun 28 09:19:20 2004
Subject: [mod_python] servlets and sessions tutorial... 
In-Reply-To: <200406280005.KAA27951@lightning.itga.com.au>
References: <200406280005.KAA27951@lightning.itga.com.au>
Message-ID: <16608.6796.745650.699487@gargle.gargle.HOWL>


> ppercot@free.fr said:
> > You have also to test the free inodes : 
> 
> Sharky has already replied to this, but in general this wouldn't be an
> out-of-inodes problem, because the file exists (i.e. the new inode allocated) 
> but it is zero size (which might mean out of disk space / quota).
> 
> And it takes a very very unusual setup to run out of inodes with 50% space 
> free.... (/var/spool/news being the canonical case, but no-one seems to have 
> one of those any more!)
> 

I worked with Sharky on this and the problem was with a conflict of
BDB libraries between python and apache.  This was confirmed with a
script that simulated session saving which worked fine from the
command line, but broke via apache.  It turned out to be a bad
symbolic link for a shared library.  After fixing the symlink
everything worked fine.

Daniel


From sharky at codezone.ath.cx  Mon Jun 28 16:11:56 2004
From: sharky at codezone.ath.cx (Sharky @ Code Zone)
Date: Mon Jun 28 10:07:54 2004
Subject: [mod_python] servlets and sessions tutorial...
In-Reply-To: <16604.18070.521420.73375@gargle.gargle.HOWL>
References: <1088027728.11658.11.camel@sharkylandia.homelinux.net>
	<40DA1342.3040902@intersiege.com>
	<43534.195.124.18.133.1088065038.squirrel@195.124.18.133>
	<37586.195.124.18.133.1088067359.squirrel@195.124.18.133>
	<16602.55812.55002.618935@gargle.gargle.HOWL>
	<38972.195.124.18.133.1088090435.squirrel@195.124.18.133>
	<16603.2057.824403.233528@gargle.gargle.HOWL>
	<1088115115.18954.1.camel@sharkylandia.homelinux.net>
	<1088115499.18951.5.camel@sharkylandia.homelinux.net>
	<48992.195.124.18.133.1088174131.squirrel@195.124.18.133>
	<16604.15874.317862.822237@gargle.gargle.HOWL>
	<27333.195.124.18.133.1088176866.squirrel@195.124.18.133>
	<16604.18070.521420.73375@gargle.gargle.HOWL>
Message-ID: <1088431915.8788.9.camel@sharkylandia.homelinux.net>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: smiley-10.png
Type: image/png
Size: 848 bytes
Desc: not available
Url : http://modpython.org/pipermail/mod_python/attachments/20040628/46053bc0/smiley-10.png
From John.Ertl at fnmoc.navy.mil  Mon Jun 28 08:34:21 2004
From: John.Ertl at fnmoc.navy.mil (Ertl, John)
Date: Mon Jun 28 10:28:08 2004
Subject: [mod_python] Mod_python Doc-style help
Message-ID: <E338ADD616B66043824B9ABF5CA6EF2332C215@lanexc107p.fnmoc.navy.mil>

Conrad,

Thank you for the response and the example.  As luck would have it my system
is down for the next two days but I am excited to give your example a try.
Thank you again.

John Ertl 

-----Original Message-----
From: Conrad Steenberg [mailto:conrad@hep.caltech.edu]
Sent: Saturday, June 26, 2004 08:44
To: mod_python user mailing list
Subject: Re: [mod_python] Mod_python Doc-style help

On Sat, 2004-06-26 at 08:36, Conrad Steenberg wrote:
> Hi John
>
> I'm using this snippet in a mod_python-based server (clarens.sf.net):
>
> try:
>   import ZSI
>   from ZSI import ParsedSoap, SoapWriter, TC, ZSI_SCHEMA_URI, \
>     FaultFromFaultMessage, _child_elements, Fault
> except:
>   ZSI=None
>
>
>         try:
>           ps = ParsedSoap(data)

Btw, "data" above is the message body received from the client.

>           method=ps.body_root.localName
>           arg_data = _child_elements(ps.body_root)
>           if len(arg_data) == 0:
>             arg = []
>           else:
>             tc = TC.Any()
>             arg = [ tc.parse(e, ps) for e in arg_data ]
>           decoded=[str(method),arg]
>         except ZSI.ParseException, e:
>           write_response_soap(req,build_fault_soap_exception(req,e))
>           return apache.OK
>
>
> I.e. the method name would be in "method" and the arguments in "arg". I
> don't know if this would work for a doc-style service...
>
> The two methods referenced in the exception handler are:
>
> def write_response_soap(req,message,code=apache.OK):
>  req.content_type='text/xml; charset="utf-8"'
>  req.headers_out['Server'] = "Clarens Apache/ZSI SOAP server %s"%_version
>  req.send_http_header()
>  req.write(message)
>
> and
>
> def build_fault_soap(req,call,code,message):
>   return ZSI.Fault(code,message).AsSOAP()
>
> Cheers
>
> Conrad
>
> On Fri, 2004-06-25 at 07:25, Ertl, John wrote:
> > All,
> > The all to common "I am new to mod_python".  I have been using the ZSI
SOAP
> > module for a simple RPC style web service that uses AsCGI for the
dispatch.
> > I have been given the chance to work on a Virtual server that allows me
to
> > use mod_python without messing up everyone else.   I have the simple
example
> > of mod_python and ZSI working but now I want to look at turning the RPC
> > style web service into a doc-style service.   What I can't figure out is
how
> > do I get to the soap body?   If any of you are familiar with ZSI I
assume I
> > could use ParsedSoap but I am not sure what to do ParsedSoap on.  Is
there a
> > better way to make a web service with mod_python?   In the little I have
> > read mod_python looks very promising but I just am just not able to link
the
> > pieces together.
> >
> > Any ideas or simple examples would be appreciated.
> > Thanks,
> >
> > John Ertl
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
--
Conrad Steenberg <conrad@hep.caltech.edu>
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python
From python at dan-olsen.net  Tue Jun 29 11:59:16 2004
From: python at dan-olsen.net (Dan Olsen)
Date: Tue Jun 29 12:59:24 2004
Subject: [mod_python] mod_python and xml parsing
In-Reply-To: <1088147351.13067.1.camel@ack.dwerg.net>
References: <40DA0759.5010309@dan-olsen.net>
	<1088107670.13505.2.camel@ack.dwerg.net>
	<40DB35DB.7080400@dan-olsen.net>
	<1088108970.13505.7.camel@ack.dwerg.net>
	<40DB3D15.40204@dan-olsen.net>
	<1088147351.13067.1.camel@ack.dwerg.net>
Message-ID: <1088528356.40e19fe4c83a4@dan-olsen.net>

Quoting Manfred Stienstra <manfred.stienstra@dwerg.net>:

> On Thu, 2004-06-24 at 22:44, Dan Olsen wrote:
> > The script works on the server command line.  As far as I can tell the
> > module is installed properly.  Seeing how it works on the command line
> > I would think it should work in mod_python.  The system path is also
> > correct.
>
> How did you install python? Are there multiple installations or just
> one?

I just had the Fedora Core 2 installer install Python when I installed the OS>

Dan


