<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Server address
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Server%20address&In-Reply-To=9bad843d0808310839m496eb958n3fceb998ae742506%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025610.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Server address</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Server%20address&In-Reply-To=9bad843d0808310839m496eb958n3fceb998ae742506%40mail.gmail.com"
       TITLE="[mod_python] Server address">graham.dumpleton at gmail.com
       </A><BR>
    <I>Sun Aug 31 19:32:39 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="025610.html">[mod_python] Server address
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25611">[ date ]</a>
              <a href="thread.html#25611">[ thread ]</a>
              <a href="subject.html#25611">[ subject ]</a>
              <a href="author.html#25611">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>2008/9/1 Tiago Becker &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">tiagobecker at gmail.com</A>&gt;:
&gt;<i> Oh, cool, i didnt know that req.construct_url() would do the trick, thanks a
</I>&gt;<i> lot!
</I>&gt;<i>
</I>&gt;&gt;<i> In web applications I would regard it as bad practice to hard wire
</I>&gt;&gt;<i> into configuration files URLs for the same site which incorporate the
</I>&gt;&gt;<i> name of the site, which seems to be what you are doing here.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Ok, i can take your word for that, but could you elaborate on why is it a
</I>&gt;<i> bad practice? Since the url would be supplied (spelling?) by apache itself.
</I>&gt;<i> I dont see whats wrong with that.
</I>
If you are doing it for all HTML href attributes of link elements for
inter site links it is bad because it prohibits ability to save down a
related set of pages from a site and then browse them offline. If the
links are just path relative, then this would work.

That is just one example. Not knowing exactly how you are using them,
hard to comment more.

Graham

&gt;<i> It's not that i would write myVar = '<A HREF="http://hostname">http://hostname</A> etc' on my cfg (this i
</I>&gt;<i> can see it would be wrong)
</I>&gt;<i>
</I>&gt;<i> on php i would do myVar = $_SERVER['hostname'] or something like it
</I>&gt;<i>
</I>&gt;<i> I just want to know why because I don't understand your reasons for saying
</I>&gt;<i> that... Maybe i coded in php for far too long :-)
</I>&gt;<i>
</I>&gt;<i> Sorry about the reply stuff and thank you for you patience :-D
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Sun, Aug 31, 2008 at 6:56 AM, Graham Dumpleton
</I>&gt;<i> &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">graham.dumpleton at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 2008/8/31 Graham Dumpleton &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">graham.dumpleton at gmail.com</A>&gt;:
</I>&gt;&gt;<i> &gt; ---------- Forwarded message ----------
</I>&gt;&gt;<i> &gt; From: Tiago Becker &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">tiagobecker at gmail.com</A>&gt;
</I>&gt;&gt;<i> &gt; Date: 2008/8/31
</I>&gt;&gt;<i> &gt; Subject: Re: [mod_python] Server address
</I>&gt;&gt;<i> &gt; To: Graham Dumpleton &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">graham.dumpleton at gmail.com</A>&gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Well, i will probably use more than one .py file... I dont want to
</I>&gt;&gt;<i> &gt; copy all the configuration on each file...
</I>&gt;&gt;<i> &gt; Besides, i work with 5 other developers, each one with their own
</I>&gt;&gt;<i> &gt; virtual server and having to configurate every developer enviroment
</I>&gt;&gt;<i> &gt; seems too much trouble to maintain..
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Well, i could import my CFG file inside the function, that would make
</I>&gt;&gt;<i> &gt; the request available (i think :-))... i just wanted to know if there
</I>&gt;&gt;<i> &gt; was any other way to do it.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; The fact is that im coming from php where i had a global cfg file for
</I>&gt;&gt;<i> &gt; all the url configurations.. All i want with that is to have a config
</I>&gt;&gt;<i> &gt; file that will get the urls (and others variables) needed so no one
</I>&gt;&gt;<i> &gt; has to worry about that.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> PHP is hardly the indicator of good practice.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> In web applications I would regard it as bad practice to hard wire
</I>&gt;&gt;<i> into configuration files URLs for the same site which incorporate the
</I>&gt;&gt;<i> name of the site, which seems to be what you are doing here.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The configuration file can contain an absolute path to a page, but it
</I>&gt;&gt;<i> should not be a fully formed HTTP address. Any code generating a
</I>&gt;&gt;<i> response which requires a fully formed HTTP address should take that
</I>&gt;&gt;<i> absolute path and feed it into req.construct_url(). This maps to an
</I>&gt;&gt;<i> internal Apache function which will fill it out to be a fully formed
</I>&gt;&gt;<i> HTTP address with all the correct hostname and port information as
</I>&gt;&gt;<i> matches what the original request to the site used.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> In other words, if you do things the correct way of using
</I>&gt;&gt;<i> req.construct_url() you don't need to hardwire your hostname into your
</I>&gt;&gt;<i> global configuration files.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> If for some reason the code generating the response doesn't have
</I>&gt;&gt;<i> access to the request object, then you should be looking at Python
</I>&gt;&gt;<i> features such as thread locals to stash away some request information
</I>&gt;&gt;<i> that can then be accessed by code directly which otherwise didn't get
</I>&gt;&gt;<i> passed the request object. This would allow it then to get hold of the
</I>&gt;&gt;<i> request object and call the construct_url() function.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> That all said, why do you even need a fully formed HTTP address? If
</I>&gt;&gt;<i> you are including that in pages for the same site then that also could
</I>&gt;&gt;<i> be considered bad practice. You should just use an absolute, or better
</I>&gt;&gt;<i> still a relative path, in any href attributes of a HTML anchor tag,
</I>&gt;&gt;<i> not a full formed HTTP address.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &gt; Re-reading my post, i saw that i wasnt clear enough :-)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I knew what you wanted. I questioned it because it seemed to be a poor
</I>&gt;&gt;<i> way of doing it.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> BTW, please use reply-all and keep followups on mailing list.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Graham
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &gt; Thanks for you answers and your patience with my 'english' :-)
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; On Fri, Aug 29, 2008 at 8:47 PM, Graham Dumpleton
</I>&gt;&gt;<i> &gt; &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">graham.dumpleton at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; 2008/8/30 Tiago Becker &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">tiagobecker at gmail.com</A>&gt;:
</I>&gt;&gt;<i> &gt;&gt; &gt; Hello guys!
</I>&gt;&gt;<i> &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt;&gt; &gt; Im trying to make my own framework for mod python, because none of
</I>&gt;&gt;<i> &gt;&gt; &gt; the
</I>&gt;&gt;<i> &gt;&gt; &gt; available suited my needs.
</I>&gt;&gt;<i> &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt;&gt; &gt; Im trying to get the server address, without the request object, but
</I>&gt;&gt;<i> &gt;&gt; &gt; i
</I>&gt;&gt;<i> &gt;&gt; &gt; couldnt find in the documentation.. is that possible?
</I>&gt;&gt;<i> &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt;&gt; &gt; Heres why i need it: i import apache and a configuration file, but
</I>&gt;&gt;<i> &gt;&gt; &gt; that
</I>&gt;&gt;<i> &gt;&gt; &gt; config need to know the server address.. as i import the files prior
</I>&gt;&gt;<i> &gt;&gt; &gt; to the
</I>&gt;&gt;<i> &gt;&gt; &gt; function that handles the request, i dont have the req object...
</I>&gt;&gt;<i> &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt;&gt; &gt; from mod_python import apache
</I>&gt;&gt;<i> &gt;&gt; &gt; import sys, os
</I>&gt;&gt;<i> &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt;&gt; &gt; #my cfg
</I>&gt;&gt;<i> &gt;&gt; &gt; CFG = apache.import_module('cfg/cfg')
</I>&gt;&gt;<i> &gt;&gt; &gt; CFG.LOCAL_PATH = os.path.dirname( __file__ )
</I>&gt;&gt;<i> &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt;&gt; &gt; ..other imports etc
</I>&gt;&gt;<i> &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt;&gt; &gt; def index(req):
</I>&gt;&gt;<i> &gt;&gt; &gt;     #this is ther var i would like to get outside the function
</I>&gt;&gt;<i> &gt;&gt; &gt;     CFG.URL = '<A HREF="http://'">http://'</A> + req.hostname
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; Sounds like you are going about it the wrong way. Can you give a
</I>&gt;&gt;<i> &gt;&gt; better reason why you need it.
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; First off, the only server details you can get outside of the context
</I>&gt;&gt;<i> &gt;&gt; of a request are those for the main server. If requests are handled
</I>&gt;&gt;<i> &gt;&gt; within the context of a VirtualHost then you can't do it. For main
</I>&gt;&gt;<i> &gt;&gt; server details do:
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt;  from mod_python import apache
</I>&gt;&gt;<i> &gt;&gt;  print apache.main_server.server_hostname
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; Documentation at:
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt;  <A HREF="http://www.modpython.org/live/current/doc-html/pyapi-apmem.html">http://www.modpython.org/live/current/doc-html/pyapi-apmem.html</A>
</I>&gt;&gt;<i> &gt;&gt;  <A HREF="http://www.modpython.org/live/current/doc-html/pyapi-mpserver.html">http://www.modpython.org/live/current/doc-html/pyapi-mpserver.html</A>
</I>&gt;&gt;<i> &gt;&gt;  <A HREF="http://www.modpython.org/live/current/doc-html/pyapi-mpsrv-mem.html">http://www.modpython.org/live/current/doc-html/pyapi-mpsrv-mem.html</A>
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; If you need to construct URLs for use inside of a request, you should
</I>&gt;&gt;<i> &gt;&gt; use:
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt;  req.construct_url('/some/path')
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; Documetation at:
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt;  <A HREF="http://www.modpython.org/live/current/doc-html/pyapi-mprequest-meth.html">http://www.modpython.org/live/current/doc-html/pyapi-mprequest-meth.html</A>
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; Graham
</I>&gt;&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i>
</I></PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025610.html">[mod_python] Server address
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25611">[ date ]</a>
              <a href="thread.html#25611">[ thread ]</a>
              <a href="subject.html#25611">[ subject ]</a>
              <a href="author.html#25611">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
