<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Server address
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Server%20address&In-Reply-To=88e286470808302321w2b47cdh4fea0d24874c62a0%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025608.html">
   <LINK REL="Next"  HREF="025610.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Server address</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Server%20address&In-Reply-To=88e286470808302321w2b47cdh4fea0d24874c62a0%40mail.gmail.com"
       TITLE="[mod_python] Server address">graham.dumpleton at gmail.com
       </A><BR>
    <I>Sun Aug 31 05:56:15 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="025608.html">[mod_python] Server address
</A></li>
        <LI>Next message: <A HREF="025610.html">[mod_python] Server address
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25609">[ date ]</a>
              <a href="thread.html#25609">[ thread ]</a>
              <a href="subject.html#25609">[ subject ]</a>
              <a href="author.html#25609">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>2008/8/31 Graham Dumpleton &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">graham.dumpleton at gmail.com</A>&gt;:
&gt;<i> ---------- Forwarded message ----------
</I>&gt;<i> From: Tiago Becker &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">tiagobecker at gmail.com</A>&gt;
</I>&gt;<i> Date: 2008/8/31
</I>&gt;<i> Subject: Re: [mod_python] Server address
</I>&gt;<i> To: Graham Dumpleton &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">graham.dumpleton at gmail.com</A>&gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Well, i will probably use more than one .py file... I dont want to
</I>&gt;<i> copy all the configuration on each file...
</I>&gt;<i> Besides, i work with 5 other developers, each one with their own
</I>&gt;<i> virtual server and having to configurate every developer enviroment
</I>&gt;<i> seems too much trouble to maintain..
</I>&gt;<i>
</I>&gt;<i> Well, i could import my CFG file inside the function, that would make
</I>&gt;<i> the request available (i think :-))... i just wanted to know if there
</I>&gt;<i> was any other way to do it.
</I>&gt;<i>
</I>&gt;<i> The fact is that im coming from php where i had a global cfg file for
</I>&gt;<i> all the url configurations.. All i want with that is to have a config
</I>&gt;<i> file that will get the urls (and others variables) needed so no one
</I>&gt;<i> has to worry about that.
</I>
PHP is hardly the indicator of good practice.

In web applications I would regard it as bad practice to hard wire
into configuration files URLs for the same site which incorporate the
name of the site, which seems to be what you are doing here.

The configuration file can contain an absolute path to a page, but it
should not be a fully formed HTTP address. Any code generating a
response which requires a fully formed HTTP address should take that
absolute path and feed it into req.construct_url(). This maps to an
internal Apache function which will fill it out to be a fully formed
HTTP address with all the correct hostname and port information as
matches what the original request to the site used.

In other words, if you do things the correct way of using
req.construct_url() you don't need to hardwire your hostname into your
global configuration files.

If for some reason the code generating the response doesn't have
access to the request object, then you should be looking at Python
features such as thread locals to stash away some request information
that can then be accessed by code directly which otherwise didn't get
passed the request object. This would allow it then to get hold of the
request object and call the construct_url() function.

That all said, why do you even need a fully formed HTTP address? If
you are including that in pages for the same site then that also could
be considered bad practice. You should just use an absolute, or better
still a relative path, in any href attributes of a HTML anchor tag,
not a full formed HTTP address.

&gt;<i> Re-reading my post, i saw that i wasnt clear enough :-)
</I>
I knew what you wanted. I questioned it because it seemed to be a poor
way of doing it.

BTW, please use reply-all and keep followups on mailing list.

Graham

&gt;<i> Thanks for you answers and your patience with my 'english' :-)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Fri, Aug 29, 2008 at 8:47 PM, Graham Dumpleton
</I>&gt;<i> &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">graham.dumpleton at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 2008/8/30 Tiago Becker &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">tiagobecker at gmail.com</A>&gt;:
</I>&gt;&gt;<i> &gt; Hello guys!
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Im trying to make my own framework for mod python, because none of the
</I>&gt;&gt;<i> &gt; available suited my needs.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Im trying to get the server address, without the request object, but i
</I>&gt;&gt;<i> &gt; couldnt find in the documentation.. is that possible?
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Heres why i need it: i import apache and a configuration file, but that
</I>&gt;&gt;<i> &gt; config need to know the server address.. as i import the files prior to the
</I>&gt;&gt;<i> &gt; function that handles the request, i dont have the req object...
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; from mod_python import apache
</I>&gt;&gt;<i> &gt; import sys, os
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; #my cfg
</I>&gt;&gt;<i> &gt; CFG = apache.import_module('cfg/cfg')
</I>&gt;&gt;<i> &gt; CFG.LOCAL_PATH = os.path.dirname( __file__ )
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; ..other imports etc
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; def index(req):
</I>&gt;&gt;<i> &gt;     #this is ther var i would like to get outside the function
</I>&gt;&gt;<i> &gt;     CFG.URL = '<A HREF="http://'">http://'</A> + req.hostname
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Sounds like you are going about it the wrong way. Can you give a
</I>&gt;&gt;<i> better reason why you need it.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> First off, the only server details you can get outside of the context
</I>&gt;&gt;<i> of a request are those for the main server. If requests are handled
</I>&gt;&gt;<i> within the context of a VirtualHost then you can't do it. For main
</I>&gt;&gt;<i> server details do:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  from mod_python import apache
</I>&gt;&gt;<i>  print apache.main_server.server_hostname
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Documentation at:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  <A HREF="http://www.modpython.org/live/current/doc-html/pyapi-apmem.html">http://www.modpython.org/live/current/doc-html/pyapi-apmem.html</A>
</I>&gt;&gt;<i>  <A HREF="http://www.modpython.org/live/current/doc-html/pyapi-mpserver.html">http://www.modpython.org/live/current/doc-html/pyapi-mpserver.html</A>
</I>&gt;&gt;<i>  <A HREF="http://www.modpython.org/live/current/doc-html/pyapi-mpsrv-mem.html">http://www.modpython.org/live/current/doc-html/pyapi-mpsrv-mem.html</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> If you need to construct URLs for use inside of a request, you should use:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  req.construct_url('/some/path')
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Documetation at:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  <A HREF="http://www.modpython.org/live/current/doc-html/pyapi-mprequest-meth.html">http://www.modpython.org/live/current/doc-html/pyapi-mprequest-meth.html</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Graham
</I>&gt;<i>
</I></PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025608.html">[mod_python] Server address
</A></li>
	<LI>Next message: <A HREF="025610.html">[mod_python] Server address
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25609">[ date ]</a>
              <a href="thread.html#25609">[ thread ]</a>
              <a href="subject.html#25609">[ subject ]</a>
              <a href="author.html#25609">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
