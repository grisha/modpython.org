<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Secure Sessions patch
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Secure%20Sessions%20patch&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022804.html">
   <LINK REL="Next"  HREF="022814.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Secure Sessions patch</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Secure%20Sessions%20patch&In-Reply-To="
       TITLE="[mod_python] Secure Sessions patch">grahamd at dscpl.com.au
       </A><BR>
    <I>Mon Dec 18 05:33:36 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="022804.html">[mod_python] mysql python compilation failed
</A></li>
        <LI>Next message: <A HREF="022814.html">[mod_python] Re: Secure Sessions patch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22806">[ date ]</a>
              <a href="thread.html#22806">[ thread ]</a>
              <a href="subject.html#22806">[ subject ]</a>
              <a href="author.html#22806">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Daniel Adler wrote ..
&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> I saw there was a discussion on this topic already:
</I>&gt;<i> <A HREF="http://www.modpython.org/pipermail/mod_python/2006-May/021260.html">http://www.modpython.org/pipermail/mod_python/2006-May/021260.html</A>
</I>&gt;<i> and came up with the same wish -
</I>&gt;<i> I want to force a session cookie to be explicitly created for https.
</I>&gt;<i> 
</I>&gt;<i> I have added a &quot;secure&quot; parameter to the session class constructors.
</I>&gt;<i> If it is set AND req.is_https(), the cookie will be created wiht &quot;secure&quot;
</I>&gt;<i> set.
</I>&gt;<i> 
</I>&gt;<i> A diff of session.py in release 3.2.10 with this feature is available on
</I>&gt;<i> <A HREF="http://neoscientists.org/~plex/mod_python_3_2_10_session_with_secure_cookie.diff">http://neoscientists.org/~plex/mod_python_3_2_10_session_with_secure_cookie.diff</A>
</I>
I'd suggest that an explicit argument to Session.Session() is probably
not the best way of doing this. I am also dubious of it only being set
if HTTPS is used as that suggests that if first access is not via HTTPS,
that one could then continue to access the site thereafter without it
needing it to be HTTPS which defeats the purpose of having it in the
first place as you want to probably force it to be HTTPS always and not
allow HTTP at all.

In place of an argument to Session.Session(), a PythonOption setting
would possibly be more appropriate and would then be similar with how
other aspects of cookies are configured for sessions. For example:

  PythonOption mod_python.session.secure: 1

By being an option it is easier to apply it to the complete URL
namespace for an application, especially if application is coded poorly
and doesn't have all session creation performed in one place only, or
you can't modify the code for the application easily.

In being set this way, 'secure' should also perhaps always be set,
regardless of whether HTTPS is used. The outcome of this is that the
client would never send the cookie back if it wasn't HTTPS, thus result
would be always being pushed back to the login form (session creation
point) if not HTTPS, thereby clearly indicating that something is wrong
and also not inadvertently still letting someone in by accident through
HTTP.

Another possible issue is whether through Session instance it should be
possible to access the cookie properties and interrogate if the cookie
for a session had the 'secure' attribute. If you don't have a means of
validating that it was secure cookie, then someone could modify the
cookie on the client side, remove the secure attribute and change from
using HTTPS to HTTP and possibly start to reveal information in traffic
that you didn't want to be revealed.

On the latter point, one could argue that setting the PythonOption
should also be a trigger for the Session class to perform a validation
and always reject any cookie that doesn't have the 'secure' flag,
presuming that the 'secure' flag is actually sent back with the cookie
by the client.

Thus, I can seem merit in what you are trying to achieve, but it perhaps
needs some more thought as to how it should be achieved to ensure that
there aren't back doors in the way it is done.

Graham


</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022804.html">[mod_python] mysql python compilation failed
</A></li>
	<LI>Next message: <A HREF="022814.html">[mod_python] Re: Secure Sessions patch
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22806">[ date ]</a>
              <a href="thread.html#22806">[ thread ]</a>
              <a href="subject.html#22806">[ subject ]</a>
              <a href="author.html#22806">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
