<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] fixuphandler problem with mod_python-3.3.0b
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20fixuphandler%20problem%20with%20mod_python-3.3.0b&In-Reply-To=4596B011.6010809%40wanadoo.fr">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022907.html">
   <LINK REL="Next"  HREF="022910.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] fixuphandler problem with mod_python-3.3.0b</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20fixuphandler%20problem%20with%20mod_python-3.3.0b&In-Reply-To=4596B011.6010809%40wanadoo.fr"
       TITLE="[mod_python] fixuphandler problem with mod_python-3.3.0b">grahamd at dscpl.com.au
       </A><BR>
    <I>Sat Dec 30 21:19:53 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="022907.html">[mod_python] [SPAM] fixuphandler problem with mod_python-3.3.0b
</A></li>
        <LI>Next message: <A HREF="022910.html">[mod_python] fixuphandler problem with mod_python-3.3.0b
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22908">[ date ]</a>
              <a href="thread.html#22908">[ thread ]</a>
              <a href="subject.html#22908">[ subject ]</a>
              <a href="author.html#22908">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Read description of import_module() in:

   <A HREF="http://www.modpython.org/live/mod_python-3.3.0b/doc-html/pyapi-">http://www.modpython.org/live/mod_python-3.3.0b/doc-html/pyapi-</A> 
apmeth.html

How 3.3.0b treats Python packages is a bit different.

Your error and configuration suggests that what you had previously was:

   ./fixuphandler/  # directory
       __init__.py # package init file.
       fixuphandler.py # handler file in directory
           fixuphandler() # handler function in file

A little messy, but the important thing is that it only worked before  
because you
had fixuphandler directory organised as a Python package with an  
__init__.py
file and mod_python had automatically add the parent handler  
directory into
sys.path. In 3.3.0b, it doesn't add the parent handler directory into  
sys.path as
that causes various problems. The new importer instead works out  
where to
import things from in a different way. On consequence of this though  
is that
stuff organised as Python packages in a parent handler directory will  
not be
found.

You have a few options.

1. Move 'fixuphandler' directory outside of document root and using  
PythonPath
to say where the parent directory of that directory now is.

2. If 'fixuphandler/__init__.py' is empty, then delete that file and  
change
configuration to:

   PythonFixupHandler fixuphandler/fixuphandler

3. Remove 'fixuphandler/__init__.py' again, but use explicit  
reference to handler
file:

   PythonFixupHandler ~/fixuphandler/fixuphandler.py

If you had stuff in 'fixuphandler/__init__.py' and you expect it to  
be executed, then
you can only do 1 as is. You might want to reconsider restructuring  
your files
though anyway.

BTW, if you do not have a 'fixuphandler/.htaccess' which has:

   deny from all

then easy for a user to access stuff in 'fixuphandler' directory that  
they shouldn't.
Ie. they could use URL of:

   fixuphandler/fixuphandler.py/fixuphandler

and mod_python.publisher will call the fixuphandler a second time. If  
it was
doing session stuff, that would cause a deadlock.

If the only thing in 'fixuphandler' directory is 'fixuphandler.py',  
you would perhaps
be better off moving 'fixuphandler.py' to the parent directory and  
call it '_handlers.py'.
Because it now has a leading underscore, mod_python.publisher should  
ignore
it and not allow it to be accessed. The configuration would then be:

   PythonFixupHandler _handlers

or:

   PythonFixupHandler ~/_handlers.py

Anyway, read through the documentation I reference, noting that  
import_module()
is what is used to load modules for the Python*Handler directives.

Graham

On 31/12/2006, at 5:29 AM, m.banaouas wrote:

&gt;<i> hi,
</I>&gt;<i> I encouter a problem with mod_python-3.3.0b after installed it with  
</I>&gt;<i> mod_python-3.3.0b.win32-py2.4-Apache2.2.exe.
</I>&gt;<i>
</I>&gt;<i> my fixuphandler in not founded anymore, although it's always there  
</I>&gt;<i> (D:/mydir/fixuphandler.py).
</I>&gt;<i> after installing again mod_python-3.2.10, every thing works fine  
</I>&gt;<i> again.
</I>&gt;<i> Here in the browser output (PythonDebug On):
</I>&gt;<i>
</I>&gt;<i> MOD_PYTHON ERROR
</I>&gt;<i>
</I>&gt;<i> ProcessId:      3520
</I>&gt;<i> Interpreter:    'MACHIN.domaine.local'
</I>&gt;<i>
</I>&gt;<i> ServerName:     'MACHIN.domaine.local'
</I>&gt;<i> DocumentRoot:   'C:/Apache/htdocs'
</I>&gt;<i>
</I>&gt;<i> URI:            '/mydir/api'
</I>&gt;<i> Location:       None
</I>&gt;<i> Directory:      'D:/mydir/'
</I>&gt;<i> Filename:       'D:/mydir/api'
</I>&gt;<i> PathInfo:       ''
</I>&gt;<i>
</I>&gt;<i> Phase:          'PythonFixupHandler'
</I>&gt;<i> Handler:        'fixuphandler.fixuphandler'
</I>&gt;<i>
</I>&gt;<i> Traceback (most recent call last):
</I>&gt;<i>
</I>&gt;<i>  File &quot;C:\Python\Lib\site-packages\mod_python\importer.py&quot;, line  
</I>&gt;<i> 1537, in HandlerDispatch
</I>&gt;<i>    default=default_handler, arg=req, silent=hlist.silent)
</I>&gt;<i>
</I>&gt;<i>  File &quot;C:\Python\Lib\site-packages\mod_python\importer.py&quot;, line  
</I>&gt;<i> 1202, in _process_target
</I>&gt;<i>    module = import_module(module_name, path=path)
</I>&gt;<i>
</I>&gt;<i>  File &quot;C:\Python\Lib\site-packages\mod_python\importer.py&quot;, line  
</I>&gt;<i> 304, in import_module
</I>&gt;<i>    return __import__(module_name, {}, {}, ['*'])
</I>&gt;<i>
</I>&gt;<i> ImportError: No module named fixuphandler.fixuphandler
</I>&gt;<i>
</I>&gt;<i> and here is my httpd.conf contribution:
</I>&gt;<i> ---
</I>&gt;<i> Alias /mydir &quot;D:/mydir&quot;
</I>&gt;<i>
</I>&gt;<i> &lt;Directory D:/mydir&gt;
</I>&gt;<i>    Allow from All
</I>&gt;<i>    SetHandler mod_python
</I>&gt;<i>    PythonFixupHandler fixuphandler.fixuphandler
</I>&gt;<i>    PythonHandler mod_python.publisher
</I>&gt;<i>    PythonDebug On
</I>&gt;<i> &lt;/Directory&gt;
</I>&gt;<i> ---
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I></PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022907.html">[mod_python] [SPAM] fixuphandler problem with mod_python-3.3.0b
</A></li>
	<LI>Next message: <A HREF="022910.html">[mod_python] fixuphandler problem with mod_python-3.3.0b
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22908">[ date ]</a>
              <a href="thread.html#22908">[ thread ]</a>
              <a href="subject.html#22908">[ subject ]</a>
              <a href="author.html#22908">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
