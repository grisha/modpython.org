<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] eliminating last foo.py from url?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20eliminating%20last%20foo.py%20from%20url%3F&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022811.html">
   <LINK REL="Next"  HREF="022817.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] eliminating last foo.py from url?</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20eliminating%20last%20foo.py%20from%20url%3F&In-Reply-To="
       TITLE="[mod_python] eliminating last foo.py from url?">grahamd at dscpl.com.au
       </A><BR>
    <I>Mon Dec 18 18:47:17 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="022811.html">[mod_python] How to deal with old cached data showing?
</A></li>
        <LI>Next message: <A HREF="022817.html">[mod_python] eliminating last foo.py from url?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22815">[ date ]</a>
              <a href="thread.html#22815">[ thread ]</a>
              <a href="subject.html#22815">[ subject ]</a>
              <a href="author.html#22815">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Mark Harrison wrote ..
&gt;<i> Graham Dumpleton wrote:
</I>&gt;<i> &gt; Mark Harrison wrote ..
</I>&gt;<i> &gt;&gt; Mark Harrison wrote:
</I>&gt;<i> &gt;&gt;&gt; So, I've pretty much copied the standard directory configuration,
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; &lt;Directory &quot;/apache/htdocs/appserv&quot;&gt;
</I>&gt;<i> &gt;&gt;&gt;         AddHandler mod_python .py
</I>&gt;<i> &gt;&gt;&gt;         PythonHandler appserv
</I>&gt;<i> &gt;&gt;&gt;         PythonDebug On
</I>&gt;<i> &gt;&gt;&gt; &lt;/Directory&gt;
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; and I can reference my service by <A HREF="http://foo.com/appserv/appserv.py">http://foo.com/appserv/appserv.py</A>
</I>&gt;<i> &gt;&gt;&gt; (or any other .py in that directory, of course).
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; How can I make it such that I can reference with the trailing foo.py?
</I>&gt;<i> &gt;&gt; Alias seems to be the key...
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; &lt;Directory &quot;/Users/mh/mp/htdocs/xmlrpc/x1&quot;&gt;
</I>&gt;<i> &gt;&gt;    AddHandler mod_python .py
</I>&gt;<i> &gt;&gt;    PythonHandler x1
</I>&gt;<i> &gt;&gt; &lt;/Directory&gt;
</I>&gt;<i> &gt;&gt; Alias /x1 /Users/mh/mp/htdocs/xmlrpc/x1/.py
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; As indicated in previous response on list, the DirectoryIndex directive
</I>&gt;<i> is more
</I>&gt;<i> &gt; appropriate for having directory access mapped to a mod_python handler
</I>&gt;<i> when
</I>&gt;<i> &gt; you are using AddHandler rather than SetHandler. I would recommend against
</I>&gt;<i> &gt; trying to fiddle things with an Alias directive as it will not work for
</I>&gt;<i> subdirectories
</I>&gt;<i> &gt; and that your left hand side doesn't use a trailing slash may cause other
</I>&gt;<i> issues
</I>&gt;<i> &gt; as well with base url determination and relative URLs in HTML files which
</I>&gt;<i> can
</I>&gt;<i> &gt; cause problems with your web application.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Why can't you use the following?
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt;   &lt;Directory &quot;/Users/mh/mp/htdocs/xmlrpc/x1&quot;&gt;
</I>&gt;<i> &gt;      AddHandler mod_python .py
</I>&gt;<i> &gt;      PythonHandler x1
</I>&gt;<i> &gt;      # Value to DirectoryIndex should be anything with .py
</I>&gt;<i> &gt;      # extension, it does not actually have to exist.
</I>&gt;<i> &gt;      DirectoryIndex index.py
</I>&gt;<i> &gt;   &lt;/Directory&gt;
</I>&gt;<i> 
</I>&gt;<i> It's probably me being clueless, but no matter what I fiddle with I always
</I>&gt;<i> get a &quot;301 Moved Permanently&quot; result.
</I>&gt;<i> 
</I>&gt;<i> I've got a pretty pared-down httpd.conf, so I don't think I'm
</I>&gt;<i> getting any unexpected interactions from other modules.
</I>&gt;<i> 
</I>
Based on fact that your directory has xmlrpc in the path and that you are
actually seeing the the 301 HTTP response, I am going to guess that you
aren't using a web browser but an XML-RPC client. If this is the case then
you are most likely seeing the 301 response because you are using a URL
which doesn't have the trailing slash on it. Ie.,

  /x1/

If you use the trailing slash, does it then work?

The reason the slash is required is that Apache does what is called trailing
slash redirection by default. That is, whenever you use a URL which maps
to a physical directory, it will send back a redirect response telling the client
to send the request again but this time with the trailing slash appended.
It does this to ensure that the base URL for any index file is correct and that
relative page references in a HTML based index page resolve correctly.

Since you are setting the PythonPath directive to where your module file is
potentially installed anyway, you are possibly just better of using:

  # Move your stuff out of the document tree and you will not need this.

  &lt;Directory &quot;/Users/mh/mp/htdocs/xmlrpc/x1&quot;&gt;
     deny from all
  &lt;/Directory&gt;

  # Use Location instead of Directory.

  &lt;Location /x1&gt;
     # The PythonPath may have to be adjusted.
     PythonPath &quot;sys.path+['/Users/mh/mp/htdocs/xmlrpc','/Users/mh/mp/htdocs/xmlrpc/x1']&quot;
     SetHandler mod_python
     PythonHandler x1
  &lt;/Directory&gt;

By using Location directive, and with location itself not having trailing slash,
Apache will not do trailing slash redirection and just pass any request starting
with /x1 through to your handler.

Graham

&gt;<i> ServerRoot &quot;/Users/mh/mp&quot;
</I>&gt;<i> 
</I>&gt;<i> Listen 9000
</I>&gt;<i> StartServers 2
</I>&gt;<i> 
</I>&gt;<i> ErrorLog logs/error_log
</I>&gt;<i> LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b&quot; common
</I>&gt;<i> CustomLog logs/access_log common
</I>&gt;<i> 
</I>&gt;<i> LoadModule python_module modules/mod_python.so
</I>&gt;<i> PythonPath &quot;sys.path+['/Users/mh/mp/htdocs/xmlrpc','/Users/mh/mp/htdocs/xmlrpc/x1']&quot;
</I>&gt;<i> 
</I>&gt;<i> DocumentRoot &quot;/Users/mh/mp/htdocs&quot;
</I>&gt;<i> 
</I>&gt;<i> &lt;Location /mpinfo&gt;
</I>&gt;<i>    SetHandler mod_python
</I>&gt;<i>    PythonHandler mod_python.testhandler
</I>&gt;<i> &lt;/Location&gt;
</I>&gt;<i> 
</I>&gt;<i> &lt;Directory &quot;/Users/mh/mp/htdocs/xmlrpc/x1&quot;&gt;
</I>&gt;<i>    #SetHandler mod_python &lt;--also tried this
</I>&gt;<i>    AddHandler mod_python .py
</I>&gt;<i>    PythonHandler x1
</I>&gt;<i>    DirectoryIndex index.py
</I>&gt;<i> &lt;/Directory&gt;
</I>&gt;<i> 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt;   Alias /x1 /Users/mh/mp/htdocs/xmlrpc/x1
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Did you read the article referenced in prior replies? Namely:
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt;   <A HREF="http://www.dscpl.com.au/wiki/ModPython/Articles/SetHandlerVersusAddHandler">http://www.dscpl.com.au/wiki/ModPython/Articles/SetHandlerVersusAddHandler</A>
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; and which talks about using DirectoryIndex when using AddHandler.
</I>&gt;<i> 
</I>&gt;<i> I did read this, and it seems to make sense... I just couldn't get
</I>&gt;<i> it to work :-(
</I>&gt;<i> 
</I>&gt;<i> Any clues appreciated!
</I>
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022811.html">[mod_python] How to deal with old cached data showing?
</A></li>
	<LI>Next message: <A HREF="022817.html">[mod_python] eliminating last foo.py from url?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22815">[ date ]</a>
              <a href="thread.html#22815">[ thread ]</a>
              <a href="subject.html#22815">[ subject ]</a>
              <a href="author.html#22815">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
