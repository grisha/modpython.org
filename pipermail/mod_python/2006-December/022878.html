<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] example of the PythonImport directive
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20example%20of%20the%20PythonImport%20directive&In-Reply-To=4591B8D4.9010109%40wanadoo.fr">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022877.html">
   <LINK REL="Next"  HREF="022884.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] example of the PythonImport directive</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20example%20of%20the%20PythonImport%20directive&In-Reply-To=4591B8D4.9010109%40wanadoo.fr"
       TITLE="[mod_python] example of the PythonImport directive">grahamd at dscpl.com.au
       </A><BR>
    <I>Tue Dec 26 19:45:46 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="022877.html">[mod_python] example of the PythonImport directive
</A></li>
        <LI>Next message: <A HREF="022884.html">[mod_python] example of the PythonImport directive
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22878">[ date ]</a>
              <a href="thread.html#22878">[ thread ]</a>
              <a href="subject.html#22878">[ subject ]</a>
              <a href="author.html#22878">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On 27/12/2006, at 11:05 AM, m.banaouas wrote:

&gt;<i> hi,
</I>&gt;<i> Can anyone give me an example of how the PythonImport directive/ 
</I>&gt;<i> code works?
</I>&gt;<i> I expect to use it to pre-open an sql database connexion, keep it  
</I>&gt;<i> opened and make it accessible from later requests.
</I>&gt;<i> thanks for any suggestion
</I>
Presuming you are using mod_python 3.3.0b, as per documentation at:

   <A HREF="http://www.modpython.org/live/mod_python-3.3.0b/doc-html/dir-other-">http://www.modpython.org/live/mod_python-3.3.0b/doc-html/dir-other-</A> 
pimp.html

use:

   PythonImport module::function interpreter_name

Change names as appropriate.

Do the database initialisation within function() inside the module,  
not at global
scope because if done at global scope and it fails and raises an  
exception it
will cause import of module to fail and only way around that is an  
Apache
restart.

By doing it within the function, although it may still fail, a  
handler which requires
the database stuff can always call the function still with it doing  
nothing if it did
previously work at time of PythonImport, otherwise it would do  
delayed database
initialisation at time of first request. If it still fails, handle  
can test for that and
return an appropriate error page.

Note that the module should not be a candidate for reloading if you  
are caching
data at global scope such as database connection pool, unless you  
have specifically
coded the module to be safe in the face of automatic module reloading.

If you aren't using 3.3.0b, although you might get something going by  
having it
done at global scope, it will not be reliable and also may suffer  
problems
because of old importer bugs.

Graham
</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022877.html">[mod_python] example of the PythonImport directive
</A></li>
	<LI>Next message: <A HREF="022884.html">[mod_python] example of the PythonImport directive
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22878">[ date ]</a>
              <a href="thread.html#22878">[ thread ]</a>
              <a href="subject.html#22878">[ subject ]</a>
              <a href="author.html#22878">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
