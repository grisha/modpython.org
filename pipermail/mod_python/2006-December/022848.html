<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Protecting Image-Directory's with PythonAccessHandler
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Protecting%20Image-Directory%27s%20with%20PythonAccessHandler&In-Reply-To=20061221223718.2fc4a594%40rita.prakti.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022832.html">
   <LINK REL="Next"  HREF="022833.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Protecting Image-Directory's with PythonAccessHandler</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Jim Gallacher</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Protecting%20Image-Directory%27s%20with%20PythonAccessHandler&In-Reply-To=20061221223718.2fc4a594%40rita.prakti.org"
       TITLE="[mod_python] Protecting Image-Directory's with PythonAccessHandler">jpg at jgassociates.ca
       </A><BR>
    <I>Fri Dec 22 09:17:10 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="022832.html">[mod_python] Protecting Image-Directory's with PythonAccessHandler
</A></li>
        <LI>Next message: <A HREF="022833.html">[mod_python] focus on shared hosting?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22848">[ date ]</a>
              <a href="thread.html#22848">[ thread ]</a>
              <a href="subject.html#22848">[ subject ]</a>
              <a href="author.html#22848">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Marcus Werner wrote:
&gt;<i> Hi everyone,
</I>&gt;<i> 
</I>&gt;<i> I'm working on a Debian-Stable Box with mod_python 2.7.10 and Python
</I>&gt;<i> 2.3 (yes I know its both 'stale', but I've got no choice) and I would
</I>&gt;<i> like to know _how_ I can protect an images-directory with an 
</I>&gt;<i> PythonAccessHandler together with my application-/session-based
</I>&gt;<i> authentification. A bonus would be If I could decide access to specific
</I>&gt;<i> images bases on user-permissions. 
</I>&gt;<i> 
</I>&gt;<i> I know this is a tricky problem, and in PHP you would have to place the
</I>&gt;<i> images somewhere inaccessible from the web and stream them through php
</I>&gt;<i> to the client, after checking the credentials. If we assume mod_php is
</I>&gt;<i> tuned to serve this fast the performance should be fair, but there is
</I>&gt;<i> still a small performance-loss because the image is streamed
</I>&gt;<i> through the PHP-Interpreter.
</I>&gt;<i> 
</I>&gt;<i> Now mod_python seems to dodge this elegantly by introducing the
</I>&gt;<i> AccessHandler, but so far I haven't been able to produce
</I>&gt;<i> something like this, since the documentation regarding those special
</I>&gt;<i> Handler is really sparse.
</I>&gt;<i> 
</I>&gt;<i> If you want to attract more user you really need some examples
</I>&gt;<i> regarding things wich are impossible, difficult or perfomance-costly 
</I>&gt;<i> in other languages/frameworks.
</I>
Yes, but if we had more users we'd just get more demands for better 
documentation. ;)

&gt;<i> Especially for those Python*Handlers, you need _way_more_ examples, so
</I>&gt;<i> it's obvious why,where and when to use those Handlers. They are a huge
</I>&gt;<i> bonus, but regarding the documentation they haven't received the
</I>&gt;<i> attention they deserve.
</I>&gt;<i> 
</I>&gt;<i> I'm going to hold a 30-minutes presentation on mod_python 3 Weeks
</I>&gt;<i> from now during a seminar about scripting-languages for Web-Engineering
</I>&gt;<i> and  I would like to show at least _one_ convincing example why and
</I>&gt;<i> where to use those _special_ handlers. So far I don't know what to tell
</I>&gt;<i> my fellow students about thist part of mod_python. Afaik it seems like
</I>&gt;<i> I'm the first guy ever doing a presentation about mod_python.
</I>
The documentation is an acknowledged weakness. Writing *good* 
documentation takes time, which is a resource we seem to be lacking 
right now. I definitely want to create a document which explains the 
apache processing phases. I may even try to throw together an 
rum-and-eggnog fueled document over the holidays. :)

&gt;<i> I'm going to set up a more recent version of mod_python on a private
</I>&gt;<i> box tonight so if you have a solution/small example wich works on a more
</I>&gt;<i> recent version of mod_python: fire away. 
</I>
Using the AccessHandler is dead easy. (Note that I've never used 
mod_python 2.x so I have no idea how well this will work there. 
Furthermore I'm using 3.3.0b.)

Stick the following in the directory you want to protect:

.htaccess
---------
PythonAccessHandler foo


foo.py
------
&quot;&quot;&quot;Restricts access to files with txt file extension&quot;&quot;&quot;

from mod_python import apache
import os

def accesshandler(req):
     req.log_error('accesshandler called for %s' % req.filename)
     if os.path.splitext(req.filename)[1] == '.txt':
         return apache.OK
     else:
         return apache.HTTP_FORBIDDEN


If you want to restrict access based on user credentials, you really 
should do it with PythonAuthzHandler. The authorization phase happens 
after the access phase and the authentication phase.

Unfortunately I need to speed out the door so I can't offer any further 
help right now. My presence on the mailing list will be spotty over the 
next couple of days.

Jim
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022832.html">[mod_python] Protecting Image-Directory's with PythonAccessHandler
</A></li>
	<LI>Next message: <A HREF="022833.html">[mod_python] focus on shared hosting?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22848">[ date ]</a>
              <a href="thread.html#22848">[ thread ]</a>
              <a href="subject.html#22848">[ subject ]</a>
              <a href="author.html#22848">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
