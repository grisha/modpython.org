<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Lifecycle of mod_python instances
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Lifecycle%20of%20mod_python%20instances&In-Reply-To=20021101072016.M33334%40metation.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013143.html">
   <LINK REL="Next"  HREF="013145.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Lifecycle of mod_python instances</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Conrad Steenberg</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Lifecycle%20of%20mod_python%20instances&In-Reply-To=20021101072016.M33334%40metation.com"
       TITLE="[mod_python] Lifecycle of mod_python instances">conrad at hep.caltech.edu
       </A><BR>
    <I>Fri Nov  1 14:39:55 EST 2002</I>
    <P><UL>
        <LI>Previous message: <A HREF="013143.html">[mod_python] Lifecycle of mod_python instances
</A></li>
        <LI>Next message: <A HREF="013145.html">[mod_python] mod_python on AIX
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13144">[ date ]</a>
              <a href="thread.html#13144">[ thread ]</a>
              <a href="subject.html#13144">[ subject ]</a>
              <a href="author.html#13144">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi

Just my 2c: 

Using Berkeley DB works great for small things like counters and other
small pieces of persistent data. It is already installed on most
systems, so all you need is the Python binding from
<A HREF="http://pybsddb.sourceforge.net/">http://pybsddb.sourceforge.net/</A>

You can open a connection to the DB and store it as a global variable in
your mod_python script when the script is imported - i.e. not within the
handler. You can use e.g. cookies to identify connections.

HTH

COnrad

On Thu, 2002-10-31 at 23:20, J&#248;rgen Fr&#248;jk Kj&#230;rsgaard wrote:
&gt;<i> On Thu, 31 Oct 2002 17:04:30 -0500, Antonio L Rodriguez wrote
</I>&gt;<i> &gt; Forgive me if this is more of an apache process question, but I 
</I>&gt;<i> &gt; couldn't find it covered clearly in the docs.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; When apache boots up (on *NIX) its starts a bunch of children 
</I>&gt;<i> &gt; processes. Does each child have its own separate image of mod_python 
</I>&gt;<i> &gt; execution space that is totally separate from the other images?
</I>&gt;<i> 
</I>&gt;<i> Correct. Apache 1.3 starts a process per simultaneous request it can handle.
</I>&gt;<i> Apache 2.0 is capable of running in threaded mode where the threads share
</I>&gt;<i> memory and thus can have global shared variables. I have no experience with
</I>&gt;<i> 2.0 so far, though. See the documentation for Apache, in particular
</I>&gt;<i> <A HREF="http://httpd.apache.org/docs/mod/core.html#maxclients">http://httpd.apache.org/docs/mod/core.html#maxclients</A> for 1.3 and
</I>&gt;<i> <A HREF="http://httpd.apache.org/docs-2.0/mod/mpm_common.html#maxclients">http://httpd.apache.org/docs-2.0/mod/mpm_common.html#maxclients</A> for 2.0.
</I>&gt;<i> 
</I>&gt;<i> &gt; That is, if I define a global var to measure hit counts in a script 
</I>&gt;<i> &gt; and then I see this var dance up and down as each of the child 
</I>&gt;<i> &gt; processes handles the request, do I infer correctly that there are 
</I>&gt;<i> &gt; separate python interpreters living inside of each child process?
</I>&gt;<i> 
</I>&gt;<i> Exactly. You never know which process the next request will hit.
</I>&gt;<i> 
</I>&gt;<i> &gt; If this is so, I'd be curious how people do global data structures 
</I>&gt;<i> &gt; in this model, i.e. a database connection pool.
</I>&gt;<i> 
</I>&gt;<i> Truely global data with Apache 1.3 requires some kind of shared memory, which
</I>&gt;<i> isn't supported by mod_python. I use one database connection per child. This
</I>&gt;<i> works well, but of cause, if you configure your Apache to run with a lot of
</I>&gt;<i> idle children, you'll have a lot of idle connections. If your database system
</I>&gt;<i> has a limit as to how many simultaneous connections it can handle, be sure you
</I>&gt;<i> don't hit that limit. Raise it or limit the number of Apache processes.
</I>&gt;<i> 
</I>&gt;<i> /jfk
</I>&gt;<i> 
</I>&gt;<i> --
</I>&gt;<i> J&#248;rgen Fr&#248;jk Kj&#230;rsgaard
</I>&gt;<i> Metation ApS - the system integrators
</I>&gt;<i> Kystvejen 29 - DK 8000 &#197;rhus C - www.metation.com
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://www.modpython.org/mailman/listinfo/mod_python">http://www.modpython.org/mailman/listinfo/mod_python</A>
</I>-- 
*-----------------------------------------*
|<i> Conrad Steenberg                        |
</I>|<i> Caltech, Mail Code 356-48               |
</I>|<i> Pasadena, CA, 91125                     |
</I>|<i> e-mail: <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">conrad at hep.caltech.edu</A>          |
</I>|<i> Tel: (626) 395-8758                     |
</I>*-----------------------------------------*



</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013143.html">[mod_python] Lifecycle of mod_python instances
</A></li>
	<LI>Next message: <A HREF="013145.html">[mod_python] mod_python on AIX
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13144">[ date ]</a>
              <a href="thread.html#13144">[ thread ]</a>
              <a href="subject.html#13144">[ subject ]</a>
              <a href="author.html#13144">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
