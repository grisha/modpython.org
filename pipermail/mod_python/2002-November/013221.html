<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> SV: SV: SV: [mod_python] Problem with mod_python3.0(beta4),python2.2.1and apache 2.0.43
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=SV%3A%20SV%3A%20SV%3A%20%5Bmod_python%5D%20Problem%20with%20mod_python3.0%28beta4%29%2Cpython2.2.1and%20apache%202.0.43&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013227.html">
   <LINK REL="Next"  HREF="013222.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>SV: SV: SV: [mod_python] Problem with mod_python3.0(beta4),python2.2.1and apache 2.0.43</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Morten Tryfoss</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=SV%3A%20SV%3A%20SV%3A%20%5Bmod_python%5D%20Problem%20with%20mod_python3.0%28beta4%29%2Cpython2.2.1and%20apache%202.0.43&In-Reply-To="
       TITLE="SV: SV: SV: [mod_python] Problem with mod_python3.0(beta4),python2.2.1and apache 2.0.43">Morten.Tryfoss at 1880nummeropplysning.no
       </A><BR>
    <I>Thu Nov 28 19:16:07 EST 2002</I>
    <P><UL>
        <LI>Previous message: <A HREF="013227.html">[mod_python] ANNOUNCE: Mod_python 3.0.1
</A></li>
        <LI>Next message: <A HREF="013222.html">[mod_python] some remarks, a few questions and
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13221">[ date ]</a>
              <a href="thread.html#13221">[ thread ]</a>
              <a href="subject.html#13221">[ subject ]</a>
              <a href="author.html#13221">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is the strace output from apache when it segfaults:

[pid  1577] &lt;... accept resumed&gt; {sin_family=AF_INET6, sin6_port=htons(3101), inet_pton(AF_INET6, &quot;::ffff:62.73.255.77&quot;, &amp;sin6_addr), sin6_flowinfo=0, sin6_scope_id=0}, [28]) = 8
[pid  1577] getsockname(8, {sin_family=AF_INET6, sin6_port=htons(80), inet_pton(AF_INET6, &quot;::ffff:212.125.195.9&quot;, &amp;sin6_addr), sin6_flowinfo=0, sin6_scope_id=0}, [28]) = 0
[pid  1577] fcntl64(8, F_GETFL)         = 0x2 (flags O_RDWR)
[pid  1577] fcntl64(8, F_SETFL, O_RDWR|O_NONBLOCK) = 0
[pid  1577] read(8, 0x81a0f50, 8000)    = -1 EAGAIN (Resource temporarily unavailable)
[pid  1577] poll([{fd=8, events=POLLIN, revents=POLLIN}], 1, 300000) = 1
[pid  1577] read(8, &quot;GET / HTTP/1.1\r\nAccept: image/gi&quot;..., 8000) = 288
[pid  1577] gettimeofday({1038506716, 88342}, NULL) = 0
[pid  1577] stat64(&quot;/usr/local/apache/htdocs/&quot;, {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
[pid  1577] stat64(&quot;/usr/local/apache/htdocs/dses/login/login.py&quot;, {st_mode=S_IFREG|0444, st_size=4285, ...}) = 0
[pid  1577] stat64(&quot;/usr/local/apache/htdocs/dses/login/login.py&quot;, {st_mode=S_IFREG|0444, st_size=4285, ...}) = 0
[pid  1577] stat64(&quot;/usr/local/apache/htdocs/dses/login/login.py&quot;, {st_mode=S_IFREG|0444, st_size=4285, ...}) = 0
[pid  1577] stat64(&quot;/usr/local/apache/htdocs/dses/login/login.p&quot;, 0xbfffda6c) = -1 ENOENT (No such file or directory)
[pid  1577] --- SIGSEGV (Segmentation fault) ---
[pid  1574] &lt;... select resumed&gt; )      = ? ERESTARTNOHAND (To be restarted)
[pid  1574] --- SIGCHLD (Child exited) ---
[pid  1574] select(0, NULL, NULL, NULL, {0, 720000}) = 0 (Timeout)
[pid  1574] wait4(-1, [WIFSIGNALED(s) &amp;&amp; WTERMSIG(s) == SIGSEGV], WNOHANG|WUNTRACED, NULL) = 1577
[pid  1574] gettimeofday({1038506716, 808246}, NULL) = 0
[pid  1574] write(7, &quot;[Thu Nov 28 19:05:16 2002] [noti&quot;..., 87) = 87

Any thoughts?

Morten

-----Opprinnelig melding-----
Fra: Gregory (Grisha) Trubetskoy [mailto:<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">grisha at modpython.org</A>]
Sendt: 5. november 2002 21:38
Til: Morten Tryfoss
Emne: Re: SV: SV: [mod_python] Problem with
mod_python3.0(beta4),python2.2.1and apache 2.0.43



It's impossible to tell what's going on based on these logs... What would
really help me track the problem down is knowing which line(s) of Python
code in your scripts cause this. You can try writing something to the logs
throughout the code to see where exactly it segfaults.

On Tue, 5 Nov 2002, Morten Tryfoss wrote:

&gt;<i> Now I've tried to upgrade Python, and it still segfaults.
</I>&gt;<i>
</I>&gt;<i> Here's some lines from apache's error_log:
</I>&gt;<i>
</I>&gt;<i> [Tue Nov 05 20:51:21 2002] [notice] child pid 29905 exit signal Segmentation fault (11)
</I>&gt;<i> [Tue Nov 05 20:51:56 2002] [info] (104)Connection reset by peer: core_output_filter: writing data to the network
</I>&gt;<i> [Tue Nov 05 20:51:56 2002] [info] (32)Broken pipe: core_output_filter: writing data to the network
</I>&gt;<i> [Tue Nov 05 20:53:08 2002] [notice] child pid 29995 exit signal Segmentation fault (11)
</I>&gt;<i> [Tue Nov 05 20:56:24 2002] [info] (104)Connection reset by peer: core_output_filter: writing data to the network
</I>&gt;<i> [Tue Nov 05 20:56:24 2002] [info] (32)Broken pipe: core_output_filter: writing data to the network
</I>&gt;<i>
</I>&gt;<i> Is it possible that the scripts are the reason for this? (It worked fine on earlier versions of apache/mod_python).
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Morten
</I>&gt;<i>
</I>&gt;<i> -----Opprinnelig melding-----
</I>&gt;<i> Fra: Gregory (Grisha) Trubetskoy [mailto:<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">grisha at modpython.org</A>]
</I>&gt;<i> Sendt: 5. november 2002 20:20
</I>&gt;<i> Til: Morten Tryfoss
</I>&gt;<i> Kopi: <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mod_python at modpython.org</A>
</I>&gt;<i> Emne: Re: SV: [mod_python] Problem with mod_python3.0(beta4),
</I>&gt;<i> python2.2.1and apache 2.0.43
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> The first thing I would try is upgrading to Python 2.2.2. If that doesn't
</I>&gt;<i> solve it, then you need to try to figure out a way to replicate this
</I>&gt;<i> issue, which is easier said than done. So far I haven't had any segfault
</I>&gt;<i> reports for BETA4, so I have no other info to relate this to.
</I>&gt;<i>
</I>&gt;<i> Grisha
</I>&gt;<i>
</I>&gt;<i> On Tue, 5 Nov 2002, Morten Tryfoss wrote:
</I>&gt;<i>
</I>&gt;<i> &gt; SuSE Linux 8.0 (2.4.18)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Morten
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; -----Opprinnelig melding-----
</I>&gt;<i> &gt; Fra: Gregory (Grisha) Trubetskoy [mailto:<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">grisha at modpython.org</A>]
</I>&gt;<i> &gt; Sendt: 5. november 2002 19:49
</I>&gt;<i> &gt; Til: Morten Tryfoss
</I>&gt;<i> &gt; Emne: Re: [mod_python] Problem with mod_python3.0(beta4), python
</I>&gt;<i> &gt; 2.2.1and apache 2.0.43
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Morten - what's your operating system?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; On Tue, 5 Nov 2002, Morten Tryfoss wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; I start my server up, and everything works ok. But after av while(when
</I>&gt;<i> &gt; &gt; the number of clients raise) some of the apache childs segfaults. Users
</I>&gt;<i> &gt; &gt; who are running on their persistent connections may still use the
</I>&gt;<i> &gt; &gt; server, but new connections are dropped. Any thoughts of what may be
</I>&gt;<i> &gt; &gt; wrong?
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Currently I'm running apache 1.3.x, but some part of my scripts performs
</I>&gt;<i> &gt; &gt; poorly. Running them on apache 2.0 improved a lot (as long as the server
</I>&gt;<i> &gt; &gt; didn't crash).
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Morten Tryfoss
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; _______________________________________________
</I>&gt;<i> &gt; &gt; Mod_python mailing list
</I>&gt;<i> &gt; &gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> &gt; &gt; <A HREF="http://www.modpython.org/mailman/listinfo/mod_python">http://www.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Mod_python mailing list
</I>&gt;<i> &gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> &gt; <A HREF="http://www.modpython.org/mailman/listinfo/mod_python">http://www.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://www.modpython.org/mailman/listinfo/mod_python">http://www.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i>
</I>


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013227.html">[mod_python] ANNOUNCE: Mod_python 3.0.1
</A></li>
	<LI>Next message: <A HREF="013222.html">[mod_python] some remarks, a few questions and
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13221">[ date ]</a>
              <a href="thread.html#13221">[ thread ]</a>
              <a href="subject.html#13221">[ subject ]</a>
              <a href="author.html#13221">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
