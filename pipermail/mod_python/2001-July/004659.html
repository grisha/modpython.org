<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] example test fails-- how to convince apache to search the correct path for python modules?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20example%20test%20fails--%20how%20to%20convince%20apache%20to%20search%20the%20correct%20path%20for%20python%20modules%3F&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004658.html">
   <LINK REL="Next"  HREF="004660.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] example test fails-- how to convince apache to search the correct path for python modules?</H1>
    <B>polygnwnd</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20example%20test%20fails--%20how%20to%20convince%20apache%20to%20search%20the%20correct%20path%20for%20python%20modules%3F&In-Reply-To="
       TITLE="[mod_python] example test fails-- how to convince apache to search the correct path for python modules?">polygnwnd at yahoo.com
       </A><BR>
    <I>Tue Jul 24 20:20:06 EST 2001</I>
    <P><UL>
        <LI>Previous message: <A HREF="004658.html">[mod_python] (no subject)
</A></li>
        <LI>Next message: <A HREF="004660.html">[mod_python] example test fails-- how to convince apache to search the correct path for python modules?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4659">[ date ]</a>
              <a href="thread.html#4659">[ thread ]</a>
              <a href="subject.html#4659">[ subject ]</a>
              <a href="author.html#4659">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<table border=0 width="100%"><tr><td>
<!--beginarticle-->
<PRE>Well, I am interested in mod_python, but am having a
hard time getting it to work. I notice
that my specific problem has come up on both Windows
and Linux and I cannot find a working
solution in the mail archives (maybe I overlooked
something?). 

What I &quot;know&quot;...

Platform: Linux 2.4 kernel, atop old, but vanilla
Debian

All packages used here are installed below
/home/polygnwnd/httpd:
  Python: python/2.0.1/(bin, lib, etc.)
  Apache: apache/1.3.20/(bin,libexec, etc.)

Configured options:
  Python: --without-threads
  Apache: --enable-module=rewrite
--enable-shared=rewrite
  mod_python:
--with-apxs=/home/polygnwnd/httpd/apache/1.3.20/bin/apxs
\
             
--with-python=/home/polygnwnd/src/httpd/python/2.0.1
              # I pointed with-python to the python
src build dir, makes configure happy

An strace on the httpd process reveals many
unsuccessful attempts to access
the system python library. The result:

  stat(&quot;/usr/lib/python2.0/mod_python&quot;, 0xbfffeaec) =
-1 ENOENT (No such file or directory)
  open(&quot;/usr/lib/python2.0/mod_python.so&quot;, O_RDONLY) =
-1 ENOENT (No such file or directory)
  open(&quot;/usr/lib/python2.0/mod_pythonmodule.so&quot;,
O_RDONLY) = -1 ENOENT (No such file or directory)
  open(&quot;/usr/lib/python2.0/mod_python.py&quot;, O_RDONLY) =
-1 ENOENT (No such file or directory)
  open(&quot;/usr/lib/python2.0/mod_python.pyc&quot;, O_RDONLY)
= -1 ENOENT (No such file or directory)
  stat(&quot;/usr/lib/python2.0/plat-linux2/mod_python&quot;,
0xbfffeaec) = -1 ENOENT (No such file or directory)
  open(&quot;/usr/lib/python2.0/plat-linux2/mod_python.so&quot;,
O_RDONLY) = -1 ENOENT (No such file or directory)
 
open(&quot;/usr/lib/python2.0/plat-linux2/mod_pythonmodule.so&quot;,
O_RDONLY) = -1 ENOENT (No such file or directory)
  open(&quot;/usr/lib/python2.0/plat-linux2/mod_python.py&quot;,
O_RDONLY) = -1 ENOENT (No such file or directory)
 
open(&quot;/usr/lib/python2.0/plat-linux2/mod_python.pyc&quot;,
O_RDONLY) = -1 ENOENT (No such file or directory)
  stat(&quot;/usr/lib/python2.0/lib-tk/mod_python&quot;,
0xbfffeaec) = -1 ENOENT (No such file or directory)
  stat(&quot;/usr/lib/python2.0/site-packages/mod_python&quot;,
0xbfffeaec) = -1 ENOENT (No such file or directory)
 
open(&quot;/usr/lib/python2.0/site-packages/mod_python.so&quot;,
O_RDONLY) = -1 ENOENT (No such file or directory)
 
open(&quot;/usr/lib/python2.0/site-packages/mod_pythonmodule.so&quot;,
O_RDONLY) = -1 ENOENT (No such file or directory)
 
open(&quot;/usr/lib/python2.0/site-packages/mod_python.py&quot;,
O_RDONLY) = -1 ENOENT (No such file or directory)
 
open(&quot;/usr/lib/python2.0/site-packages/mod_python.pyc&quot;,
O_RDONLY) = -1 ENOENT (Nosuch file or directory)
  write(2, &quot;make_obcallback(): could not imp&quot;..., 55)
= 55
  write(2, &quot;make_obcallback(): could not cal&quot;..., 40)
= 40
  time(NULL)                              = 996027790
  write(15, &quot;[Wed Jul 25 03:23:10 2001] [erro&quot;...,
115) = 115
  alarm(300)                              = 0
  alarm(0)                                = 300
  alarm(300)                              = 0
  alarm(0)                                = 300
  alarm(300)                              = 0
  alarm(0)                                = 300
  write(4, &quot;HTTP/1.1 500 Internal Server Err&quot;..., 843)
= 843

This is odd because my system python version is 1.5
and I have a special version in a private 
directory which I specified (as above) at compile
time.

grepping apache (incl. mod_python.so) and python
binaries for &quot;/usr/lib&quot; did not reveal anything of
immediate
interest. Recompiling with python 2.1 renders
essentially the same result (substitude &quot;2.1&quot; for
&quot;2.0&quot; in the
trace output).

The problem is obviously something like the PYTHONPATH
not being set properly. 

  -Setting the PythonPath (as was suggested in a prior
exchange) seems ineffective-- strace behaviour was not

   changed (in fact specifying an arbitrary string set
for the PythonPath directive did not appear in trace
output).
  
  -setting the PYTHONPATH variable in the shell before
starting httpd had no effect

  -using the specially compiled python shell to try
&quot;from mod_python import apache&quot; failed when it could
   not find the &quot;_apache&quot; module, leading me to
believe it did find the mod_python module. I did this
   experiment using the same permissions as httpd, and
have tried experimentally running httpd with my own 
   permissions without success.

The mod_python.so file is 2.7MB with python 2.0 and
1.5MB with 2.1, leading me to believe it is being
linked
properly-- I have scrutinized the build process for
errors and not seen anything interesting. Thus I find
myself
among the ranks of unhappy people looking at:

  [Wed Jul 25 04:03:20 2001] [info] Server built: Jul
25 2001 00:55:54
  make_obcallback(): could not import
mod_python.apache.
  make_obcallback(): could not call init.
  [Wed Jul 25 04:03:22 2001] [error] [client
192.168.0.0.2] python_handler: make_ob
  callback returned no obCallBack!

I look forward to being able to move out of
AOLserver-land (filters and threading are coming to
Apache. yay). 
Any clues?

cheers,
jamie



__________________________________________________
Do You Yahoo!?
Make international calls for as low as $.04/minute with Yahoo! Messenger
<A HREF="http://phonecard.yahoo.com/">http://phonecard.yahoo.com/</A>

</PRE>
<!--endarticle-->
</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004658.html">[mod_python] (no subject)
</A></li>
	<LI>Next message: <A HREF="004660.html">[mod_python] example test fails-- how to convince apache to search the correct path for python modules?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4659">[ date ]</a>
              <a href="thread.html#4659">[ thread ]</a>
              <a href="subject.html#4659">[ subject ]</a>
              <a href="author.html#4659">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
