<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Function sequence error
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Function%20sequence%20error&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008343.html">
   <LINK REL="Next"  HREF="008345.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
<table border=0 width="100%"><tr><td valign="top">
   <H1>[mod_python] Function sequence error</H1>
    <B>aaron mayerson</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Function%20sequence%20error&In-Reply-To="
       TITLE="[mod_python] Function sequence error">a_mayerson at yahoo.com
       </A><BR>
    <I>Tue Jul 17 20:12:05 EST 2001</I>
    <P><UL>
        <LI>Previous message: <A HREF="008343.html">[mod_python] Import errors in 2.7.5
</A></li>
        <LI>Next message: <A HREF="008345.html">[mod_python] Dispatch() returned nothing (?)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8344">[ date ]</a>
              <a href="thread.html#8344">[ thread ]</a>
              <a href="subject.html#8344">[ subject ]</a>
              <a href="author.html#8344">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Greetings,

  I have a script that works from the command line but
not with mod_python and apache.  I've looked elsewhere
and found that this error relates to the odbc calls
being called out of order.
  I'm not exactly sure why the heck the calls would be
out of order when running through mod_python and
apache and not when run from the command line. 
Anybody have a clue as to why this is happening?
  Thanks for the help...

The error:

Mod_python error: &quot;PythonHandler stats&quot;

Traceback (most recent call last):

  File &quot;d:\python21\lib\mod_python\apache.py&quot;, line
181, in Dispatch

  File &quot;d:\python21\lib\mod_python\apache.py&quot;, line
364, in import_module

  File &quot;c:/program files/apache
group/apache/htdocs/python/\stats.py&quot;, line 7, in ?
    db = mx.DriverConnect('DSN=stats')

InternalError: ('S1010', 0, '[Microsoft][ODBC Driver
Manager] Function sequence error', 5806)

The code:

import sping.PIL as pid
import mx.ODBC.Windows as mx
from os import chdir



db = mx.DriverConnect('DSN=stats')
cur = db.cursor()
cur.execute('select * from address_count')
values = cur.fetchall()
cur.close()
db.close()

hits = 0
for value in values:
    hits += value[1]

canvas = pid.PILCanvas(size=(600,
(len(values)*15)+15))
canvas.defaultLineWidth = 7.5
canvas.defaultLineColor = pid.red
y1 = 15
x1 = 100
y2 = 15
for value in values:
    x2 = 100 + (3000 * (float(value[1])/hits))
    canvas.drawLine(x1, y1, x2, y2)
    canvas.drawString(value[0], 5, (y1+2.5),
pid.Font(face=&quot;monospaced&quot;,size=10),
                      color=pid.black)
    canvas.drawString(str(value[1]), (x2+10),
(y1+2.5), pid.Font(face=&quot;monospaced&quot;,size=10),
                      color=pid.black)
    y1 += 15
    y2 += 15

canvas.flush()
chdir(r'c:\program files\apache
group\apache\htdocs\python')
canvas.save('hits', format='gif')

__________________________________________________
Do You Yahoo!?
Get personalized email addresses from Yahoo! Mail
<A HREF="http://personal.mail.yahoo.com/">http://personal.mail.yahoo.com/</A>

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008343.html">[mod_python] Import errors in 2.7.5
</A></li>
	<LI>Next message: <A HREF="008345.html">[mod_python] Dispatch() returned nothing (?)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8344">[ date ]</a>
              <a href="thread.html#8344">[ thread ]</a>
              <a href="subject.html#8344">[ subject ]</a>
              <a href="author.html#8344">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
