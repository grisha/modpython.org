<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] sys.path problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20sys.path%20problem&In-Reply-To=88e286470802201742o2af32aecw41ffc31b1d6258c1%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024861.html">
   <LINK REL="Next"  HREF="024863.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] sys.path problem</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>AJ Coon</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20sys.path%20problem&In-Reply-To=88e286470802201742o2af32aecw41ffc31b1d6258c1%40mail.gmail.com"
       TITLE="[mod_python] sys.path problem">ajcoon at gmail.com
       </A><BR>
    <I>Wed Feb 20 21:23:49 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="024861.html">[mod_python] sys.path problem
</A></li>
        <LI>Next message: <A HREF="024863.html">[mod_python] sys.path problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24862">[ date ]</a>
              <a href="thread.html#24862">[ thread ]</a>
              <a href="subject.html#24862">[ subject ]</a>
              <a href="author.html#24862">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Graham,

I'm not using PythonPath anywhere, though my handlers both make
sys.path.append() calls to add various library paths needed by each.
Inconveniently, each of these handlers use different versions of some of the
same libraries.  It's a bit of a mess, but this all worked fine on 3.1.3.
Now that I upgraded to 3.3.1 (and changed nothing else), it's broken.
Rolling back seems the obvious choice, but I think what I'm trying to do
*is* do-able, no?


As you requested, I have included my configuration below.  I'm just
developing on a workstation and DNS is managed by /etc/hosts, hence the
.localdomain host names.  Without further adieu:

<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">aj at aj-5150</A>:~$ cat cat /etc/apache2/mods-enabled/mod_python.load
LoadModule python_module /usr/lib/apache2/modules/mod_python.so

<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">aj at aj-5150</A>:~$ cat /etc/apache2/sites-enabled/000-handlera
&lt;VirtualHost handlera.localdomain&gt;
    DocumentRoot /var/handlerA/www
    ScriptAlias /handlerA/ &quot;/var/handlerA/www/handlerA_root&quot;

    &lt;Directory &quot;/var/handlerA/www/handlerA_root&quot;&gt;
    SetHandler mod_python
    PythonHandler handlerA
    PythonDebug On
    PythonAutoReload On
    PythonOption CACHE Off
    &lt;/Directory&gt;

    ServerName handlera.localdomain

    ErrorLog /var/log/apache2/handlerA-error_log
    CustomLog /var/log/apache2/handlerA-access_log combined
&lt;/VirtualHost&gt;

<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">aj at aj-5150</A>:~$ cat /etc/apache2/sites-enabled/001-handlerb
&lt;VirtualHost handlerb.localdomain&gt;
    DocumentRoot /var/handlerB/www
    ScriptAlias /handlerB/ &quot;/var/handlerB/www/handlerB_root&quot;

    &lt;Directory &quot;/var/handlerB/www/handlerB_root&quot;&gt;
    SetHandler mod_python
    PythonHandler handlerB
    PythonDebug On
    PythonAutoReload On
    PythonOption CACHE Off
    &lt;/Directory&gt;

    ServerName handlerb.localdomain

    ErrorLog /var/log/apache2/handlerB-error_log
    CustomLog /var/log/apache2/handlerB-access_log combined
&lt;/VirtualHost&gt;

<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">aj at aj-5150</A>:~$ cat /var/handlerA/www/.htaccess
PythonInterpreter InterpA
Options -Indexes

<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">aj at aj-5150</A>:~$ cat /var/handlerB/www/.htaccess
PythonInterpreter InterpB
Options -Indexes


I hope this makes things more clear.  I hope I'm not asking for the
impossible.

-aj



On Wed, Feb 20, 2008 at 8:42 PM, Graham Dumpleton &lt;
<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">graham.dumpleton at gmail.com</A>&gt; wrote:

&gt;<i> Don't use PythonPath directive. Instead, read about the new module
</I>&gt;<i> importer in mod_python 3.3.1 which avoids these sort of problems. See
</I>&gt;<i> documentation for 'import_module()' in:
</I>&gt;<i>
</I>&gt;<i>   <A HREF="http://www.modpython.org/live/current/doc-html/pyapi-apmeth.html">http://www.modpython.org/live/current/doc-html/pyapi-apmeth.html</A>
</I>&gt;<i>
</I>&gt;<i> To explain better, would need to see the exact configuration you are
</I>&gt;<i> using for mod_python.
</I>&gt;<i>
</I>&gt;<i> Graham
</I>&gt;<i>
</I>&gt;<i> On 21/02/2008, AJ Coon &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">ajcoon at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt; Hello,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I have an issue with two different handlers running on the same apache
</I>&gt;<i> &gt; server.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; They seem to be &quot;sharing&quot; (read: overwriting each other's) sys.path.
</I>&gt;<i>  I'm
</I>&gt;<i> &gt; printing the output of sys.path before any of my import statements in
</I>&gt;<i> each
</I>&gt;<i> &gt; handler to verify this.  It seems like I can make several requests to
</I>&gt;<i> &gt; handler &quot;A&quot; with no problem, but then if handler &quot;B&quot; is called, and then
</I>&gt;<i> &gt; subsequently handler &quot;A&quot; is called again, sys.path has been overwritten
</I>&gt;<i> by
</I>&gt;<i> &gt; handler &quot;B&quot; for handler &quot;A&quot;.  Ugh.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; - Each handler is defined in its own virtual host in apache.
</I>&gt;<i> &gt; - Each handler is named differently (i.e. PythonHandler handlerA,
</I>&gt;<i> &gt; PythonHandler handlerB)
</I>&gt;<i> &gt; - Each handler runs in its own sub-directory (i.e. /var/handlerA,
</I>&gt;<i> &gt; /var/handlerB)
</I>&gt;<i> &gt;  - In the doc root of each handler's virtual host, I have a .htaccess
</I>&gt;<i> file
</I>&gt;<i> &gt; that contains a PythonInterpreter directive, defining a different named
</I>&gt;<i> &gt; interpreter to be used (i.e. PythonInterpreter InterpA,
</I>&gt;<i> PythonInterpreter
</I>&gt;<i> &gt; InterpB)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; How can I ensure that each handler has its own sys.path that is not
</I>&gt;<i> affected
</I>&gt;<i> &gt; by the other handler, ever?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I am running on the following stack:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Apache/2.0.54 (Debian GNU/Linux) mod_python/3.3.1 Python/2.3.5
</I>&gt;<i> &gt; mod_ssl/2.0.54 OpenSSL/0.9.7e
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Thanks,
</I>&gt;<i> &gt; -aj
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt;  Mod_python mailing list
</I>&gt;<i> &gt;  <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> &gt;  <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20080220/c7bd8201/attachment-0001.html">http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20080220/c7bd8201/attachment-0001.html</A>
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024861.html">[mod_python] sys.path problem
</A></li>
	<LI>Next message: <A HREF="024863.html">[mod_python] sys.path problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24862">[ date ]</a>
              <a href="thread.html#24862">[ thread ]</a>
              <a href="subject.html#24862">[ subject ]</a>
              <a href="author.html#24862">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
