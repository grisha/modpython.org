<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Authorization problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Authorization%20problem&In-Reply-To=20080204102217.HM.0000000000000I9%40dvaras.bos-mail-wwl14.lycos.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024803.html">
   <LINK REL="Next"  HREF="024804.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Authorization problem</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Authorization%20problem&In-Reply-To=20080204102217.HM.0000000000000I9%40dvaras.bos-mail-wwl14.lycos.com"
       TITLE="[mod_python] Authorization problem">graham.dumpleton at gmail.com
       </A><BR>
    <I>Mon Feb  4 17:15:02 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="024803.html">[mod_python] Authorization problem
</A></li>
        <LI>Next message: <A HREF="024804.html">[mod_python] Import error on multiple interpreters
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24810">[ date ]</a>
              <a href="thread.html#24810">[ thread ]</a>
              <a href="subject.html#24810">[ subject ]</a>
              <a href="author.html#24810">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>It would help if you told us what you expected to happen and what
actually happens, including any errors. Most people aren't going to
want to take your code and actually run it to try and work that out.
Even doing this might be hard anyway as one would have to assume how
you expected it to work. So, we can assist you in debugging it for
yourself, but you will need to explain the problem properly.

Graham

On 05/02/2008, vytas dvaras &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">dvaras at lycos.com</A>&gt; wrote:
&gt;<i> Hello everyone,
</I>&gt;<i>
</I>&gt;<i> I was trying to do an application with mod_python, that allows to use it's
</I>&gt;<i> resources only to logged in users:
</I>&gt;<i>
</I>&gt;<i> I have:
</I>&gt;<i> 1. One html page with login, password input fields and a submit button.
</I>&gt;<i> 2. python script (that uses mod_python) and does something
</I>&gt;<i>
</I>&gt;<i> I would like to do so, that if the user is not logged in - he/she is
</I>&gt;<i> redirected back to login page each time she/he tries to access any function
</I>&gt;<i> without logging in.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I used the example #1 from:
</I>&gt;<i> <A HREF="http://wiki.apache.org/mod_python/Session_use_with_classes?highlight=%28CategoryExamples%29">http://wiki.apache.org/mod_python/Session_use_with_classes?highlight=%28CategoryExamples%29</A>
</I>&gt;<i>
</I>&gt;<i> The problem is that my script &quot;enhancements&quot; don't work as expected. I was
</I>&gt;<i> trying to solve this problem for some time, but at last I came to a
</I>&gt;<i> conclusion that a help from somebody else is really needed :)
</I>&gt;<i>
</I>&gt;<i> index.html:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  Login:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  Password:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _sessions.py:
</I>&gt;<i> from mod_python import apache, util, Session
</I>&gt;<i>
</I>&gt;<i> def handler(req):
</I>&gt;<i>  #login = req.form.getfirst('vardas') #this does't work here
</I>&gt;<i>
</I>&gt;<i>  # but I would like to make a session after I authenticate a user
</I>&gt;<i>  if not hasattr(req, 'session'):
</I>&gt;<i>  req.session = Session.Session(req)
</I>&gt;<i>  return apache.OK
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> aha.py:
</I>&gt;<i> from mod_python import apache, util, Session
</I>&gt;<i> from time import time
</I>&gt;<i>
</I>&gt;<i> _tags = (1,2,3,4)
</I>&gt;<i>
</I>&gt;<i> class ExampleSession:
</I>&gt;<i>  def __call__(self, req):
</I>&gt;<i>
</I>&gt;<i>  # these lines work, but the session IS allready created
</I>&gt;<i>  login = req.form.getfirst('vardas')
</I>&gt;<i>  passw = req.form.getfirst('slaptazodis')
</I>&gt;<i>
</I>&gt;<i>  if login != 'testas' or passw != '007':
</I>&gt;<i>  util.redirect(req, '../index.html')
</I>&gt;<i>
</I>&gt;<i>  # these work in _session.py, but don't work here
</I>&gt;<i> # if not hasattr(req, 'session'):
</I>&gt;<i> # util.redirect(req, '../index.html')
</I>&gt;<i>  return self._foo(req)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  def __init__(self, *args, **kwargs):
</I>&gt;<i>  # Do something with the args here.
</I>&gt;<i>  return
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  def _foo(self, req):
</I>&gt;<i>
</I>&gt;<i>  try:
</I>&gt;<i>  delta = int(time()- req.session['last'])
</I>&gt;<i>  except KeyError:
</I>&gt;<i>  delta = 0
</I>&gt;<i>  total = int(time()- req.session.created())
</I>&gt;<i>  try:
</I>&gt;<i>  req.session['hits'] += 1
</I>&gt;<i>  except:
</I>&gt;<i>  req.session['hits'] = 1
</I>&gt;<i>
</I>&gt;<i>  req.session['last'] = req.session.last_accessed()
</I>&gt;<i>  req.session.save()
</I>&gt;<i>  return &quot;&quot;&quot;Session ID: %s
</I>&gt;<i> This session has been active for %d seconds
</I>&gt;<i> This session was last accessed %d seconds ago
</I>&gt;<i> This session has been accessed %d times
</I>&gt;<i> &quot;&quot;&quot; % \
</I>&gt;<i>  (req.session.id(), total, delta, req.session['hits'], 'login', 'passw')
</I>&gt;<i>
</I>&gt;<i> foo = ExampleSession(_tags)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> What am I doing wrong? I can't find any better working examples and I have
</I>&gt;<i> allready read everything I found relating to my problem. So if you have any
</I>&gt;<i> ideas or examples it would be great to have a look at them.
</I>&gt;<i>
</I>&gt;<i> Regards,
</I>&gt;<i> Vytas
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i>
</I>&gt;<i>
</I></PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024803.html">[mod_python] Authorization problem
</A></li>
	<LI>Next message: <A HREF="024804.html">[mod_python] Import error on multiple interpreters
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24810">[ date ]</a>
              <a href="thread.html#24810">[ thread ]</a>
              <a href="subject.html#24810">[ subject ]</a>
              <a href="author.html#24810">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
