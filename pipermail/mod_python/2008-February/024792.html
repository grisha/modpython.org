<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Apache Fails to load mod_python.so with Permission
	denied error under SELinux
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Apache%20Fails%20to%20load%20mod_python.so%20with%20Permission%0A%09denied%20error%20under%20SELinux&In-Reply-To=88e286470801312010x170d346bn891ea7dd80a3abe4%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="024793.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Apache Fails to load mod_python.so with Permission
	denied error under SELinux</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Scott Bratcher</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Apache%20Fails%20to%20load%20mod_python.so%20with%20Permission%0A%09denied%20error%20under%20SELinux&In-Reply-To=88e286470801312010x170d346bn891ea7dd80a3abe4%40mail.gmail.com"
       TITLE="[mod_python] Apache Fails to load mod_python.so with Permission
	denied error under SELinux">scott at 3floors.com
       </A><BR>
    <I>Fri Feb  1 02:40:39 EST 2008</I>
    <P><UL>
        
        <LI>Next message: <A HREF="024793.html">[mod_python] Apache Fails to load mod_python.so with Permission
	denied error under SELinux
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24792">[ date ]</a>
              <a href="thread.html#24792">[ thread ]</a>
              <a href="subject.html#24792">[ subject ]</a>
              <a href="author.html#24792">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Graham,

Great, thanks, and since it's missing...

I reinstalled python with:
# ./configure --enable-shared
# make
# make install

and then rebuilt mod_python with:
# ./configure --with-apxs=/usr/sbin/apxs --with-python=/usr/local/bin/ 
python
# make
# make install

Apache started right up. Thank you for the help in getting over that  
hump.

Now I'm getting an [500] Internal Server Error in the browser with  
this output to my apache error_logs:

[Fri Feb 01 01:12:33 2008] [notice] SELinux policy enabled; httpd  
running as context user_u:system_r:httpd_t:s0
[Fri Feb 01 01:12:33 2008] [notice] suEXEC mechanism enabled  
(wrapper: /usr/sbin/suexec)
[Fri Feb 01 01:12:34 2008] [notice] Digest: generating secret for  
digest authentication ...
[Fri Feb 01 01:12:34 2008] [notice] Digest: done
[Fri Feb 01 01:12:34 2008] [notice] mod_python: Creating 8 session  
mutexes based on 256 max processes and 0 max threads.
[Fri Feb 01 01:12:34 2008] [notice] mod_python: using  
mutex_directory /tmp
[Fri Feb 01 01:12:34 2008] [notice] Apache/2.2.3 (Red Hat) configured  
-- resuming normal operations
[Fri Feb 01 01:12:50 2008] [error] make_obcallback: could not import  
mod_python.apache.\n
ImportError: No module named mod_python.apache
[Fri Feb 01 01:12:50 2008] [error] make_obcallback: Python path being  
used &quot;['/usr/lib/python25.zip', '/usr/lib/python2.5', '/usr/lib/ 
python2.5/plat-linux2', '/usr/lib/python2.5/lib-tk', '/usr/lib/ 
python2.5/lib-dynload', '/usr/lib/python2.5/site-packages']&quot;.
[Fri Feb 01 01:12:50 2008] [error] get_interpreter: no interpreter  
callback found.
[Fri Feb 01 01:12:50 2008] [error] [client xx.xx.xx.xx.]  
python_handler: Can't get/create interpreter.

I've looked all over the list archives to find a solution, and this  
seems like a common error output that has, at times, varied causes.  
However, I wasn't able to locate a post that solved this error for  
me. Can you point me in the right direction?

Thanks again for your help,

Scott


Just in case I've checked my SELinux related permissions and didn't  
find anything out of line. I wouldn't know what file specifically to  
check though...

-rwxr-xr-x  root  root system_u:object_r:bin_t          /usr/bin/python
-rwxr-xr-x  root  root system_u:object_r:httpd_modules_t /usr/lib/ 
httpd/modules/mod_python.so
-rwxr-xr-x  root  root system_u:object_r:bin_t          /usr/local/ 
bin/python2.5
drwxr-xr-x  root  root system_u:object_r:lib_t          /usr/local/ 
lib/python2.5/site-packages/mod_python


USING:
--
RHEL5/SELinux
Apache 2.2
Python 2.5.1
mod_pythonn 3.3.1
httpd.conf (not .htaccess)



On Jan 31, 2008, at 10:10 PM, Graham Dumpleton wrote:

&gt;<i> On 01/02/2008, Scott Bratcher &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">scott at 3floors.com</A>&gt; wrote:
</I>&gt;&gt;<i> Thank you for looking in, Graham,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> DEPENDENCIES:
</I>&gt;&gt;<i> # ldd /etc/httpd/modules/mod_python.so
</I>&gt;&gt;<i>          linux-gate.so.1 =&gt;  (0x00b16000)
</I>&gt;&gt;<i>          libpthread.so.0 =&gt; /lib/libpthread.so.0 (0x00f2d000)
</I>&gt;&gt;<i>          libdl.so.2 =&gt; /lib/libdl.so.2 (0x00aa7000)
</I>&gt;&gt;<i>          libutil.so.1 =&gt; /lib/libutil.so.1 (0x00110000)
</I>&gt;&gt;<i>          libm.so.6 =&gt; /lib/libm.so.6 (0x00114000)
</I>&gt;&gt;<i>          libc.so.6 =&gt; /lib/libc.so.6 (0x00453000)
</I>&gt;&gt;<i>          /lib/ld-linux.so.2 (0x0076d000)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> SIZE:
</I>&gt;&gt;<i> # ls -fla /etc/httpd/modules/mod_python.so
</I>&gt;&gt;<i> -rwxr-xr-x 1 root root 4.1M Jan 31 01:51 /etc/httpd/modules/
</I>&gt;&gt;<i> mod_python.so*
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I'm game to reinstall python, how do I check to see if there is a
</I>&gt;&gt;<i> libpythonX.Y.so file linked to mod_python.so?
</I>&gt;<i>
</I>&gt;<i> It should appear in that list above.
</I>&gt;<i>
</I>&gt;<i> Check out notes in:
</I>&gt;<i>
</I>&gt;<i>   <A HREF="http://code.google.com/p/modwsgi/wiki/InstallationIssues">http://code.google.com/p/modwsgi/wiki/InstallationIssues</A>
</I>&gt;<i>
</I>&gt;<i> This is for mod_wsgi, but it has the same issue with the Python  
</I>&gt;<i> library.
</I>&gt;<i>
</I>&gt;<i> Graham
</I>&gt;<i>
</I>&gt;&gt;<i> On Jan 31, 2008, at 6:51 PM, Graham Dumpleton wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> How big is your:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>   /etc/httpd/modules/mod_python.so
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> file? If you run ldd on it, what does it output as far as  
</I>&gt;&gt;&gt;<i> dependencies
</I>&gt;&gt;&gt;<i> on shared libraries?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> One of the problems with some Python installations is that they  
</I>&gt;&gt;&gt;<i> still
</I>&gt;&gt;&gt;<i> do not provide a shared library and so a static library gets  
</I>&gt;&gt;&gt;<i> embedded
</I>&gt;&gt;&gt;<i> in mod_python.so. This results in some messy adress relocations  
</I>&gt;&gt;&gt;<i> having
</I>&gt;&gt;&gt;<i> to be done when mod_python.so is loaded. I am wandering whether the
</I>&gt;&gt;&gt;<i> 'reloc' mentioned in:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>   cannot restore segment prot after reloc
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> is the module loading relocations and it is having a problem with
</I>&gt;&gt;&gt;<i> that.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> If there is no libpythonX.Y.so linked to mod_python.so, then  
</I>&gt;&gt;&gt;<i> reinstall
</I>&gt;&gt;&gt;<i> Python using --enable-shared to configure, possibly fix up missing
</I>&gt;&gt;&gt;<i> libpythonX.Y.so symlink in Python installed config directory and  
</I>&gt;&gt;&gt;<i> then
</I>&gt;&gt;&gt;<i> rebuild mod_python, see if that makes a difference.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Probably nothing to do with this, but if nothing else works. :-)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Graham
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> On 01/02/2008, Scott Bratcher &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">scott at 3floors.com</A>&gt; wrote:
</I>&gt;&gt;&gt;&gt;<i> Thanks Eric and Tom,
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Unresolved however. I did some permissions tests based on your
</I>&gt;&gt;&gt;&gt;<i> feedback.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> I'm chasing this issue as though it is a permissions issue and have
</I>&gt;&gt;&gt;&gt;<i> identified SELinux as the hold-up. I've tried all of these  
</I>&gt;&gt;&gt;&gt;<i> permission
</I>&gt;&gt;&gt;&gt;<i> sets on the modules actual folder and the modules symlinked folder.
</I>&gt;&gt;&gt;&gt;<i> I did both directories just in case the permissions trickle down to
</I>&gt;&gt;&gt;&gt;<i> the actual files being loaded by mod_python itself:
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> # chcon -R -h -u system_u -r object_r -t httpd_sys_content_t /usr/
</I>&gt;&gt;&gt;&gt;<i> lib/
</I>&gt;&gt;&gt;&gt;<i> httpd/modules /etc/httpd/modules
</I>&gt;&gt;&gt;&gt;<i> # chcon -R -h -u user_u -r object_r -t httpd_sys_content_t /usr/ 
</I>&gt;&gt;&gt;&gt;<i> lib/
</I>&gt;&gt;&gt;&gt;<i> httpd/modules /etc/httpd/modules
</I>&gt;&gt;&gt;&gt;<i> # chcon -R -h -u user_u -r object_r -t httpd_modules_t /usr/lib/
</I>&gt;&gt;&gt;&gt;<i> httpd/
</I>&gt;&gt;&gt;&gt;<i> modules /etc/httpd/modules
</I>&gt;&gt;&gt;&gt;<i> # chcon -R -h -u system_u -r object_r -t httpd_modules_t /usr/lib/
</I>&gt;&gt;&gt;&gt;<i> httpd/modules /etc/httpd/modules ((( This one is the original
</I>&gt;&gt;&gt;&gt;<i> permission of all apache modules)))
</I>&gt;&gt;&gt;&gt;<i> # chcon -R -h -u system_u -r object_r -t lib_t /usr/lib/httpd/
</I>&gt;&gt;&gt;&gt;<i> modules /etc/httpd/modules
</I>&gt;&gt;&gt;&gt;<i> # chcon -R -h -u system_u -r object_r -t shlib_t /usr/lib/httpd/
</I>&gt;&gt;&gt;&gt;<i> modules /etc/httpd/modules
</I>&gt;&gt;&gt;&gt;<i> # chcon -R -h -u system_u -r object_r -t textrel_shlib_t /usr/lib/
</I>&gt;&gt;&gt;&gt;<i> httpd/modules /etc/httpd/modules
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> All gave this error:
</I>&gt;&gt;&gt;&gt;<i> ----------
</I>&gt;&gt;&gt;&gt;<i> # service httpd start
</I>&gt;&gt;&gt;&gt;<i> Starting httpd: httpd: Syntax error on line 210 of /etc/httpd/conf/
</I>&gt;&gt;&gt;&gt;<i> httpd.conf: Syntax error on line 6 of /etc/httpd/conf.d/ 
</I>&gt;&gt;&gt;&gt;<i> python.conf:
</I>&gt;&gt;&gt;&gt;<i> Cannot load /etc/httpd/modules/mod_python.so into server: /etc/ 
</I>&gt;&gt;&gt;&gt;<i> httpd/
</I>&gt;&gt;&gt;&gt;<i> modules/mod_python.so: cannot restore segment prot after reloc:
</I>&gt;&gt;&gt;&gt;<i> Permission denied
</I>&gt;&gt;&gt;&gt;<i>                                                              
</I>&gt;&gt;&gt;&gt;<i> [FAILED]
</I>&gt;&gt;&gt;&gt;<i> ----------
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> ---&gt; This is the only one that gave me a different error.
</I>&gt;&gt;&gt;&gt;<i> ----------
</I>&gt;&gt;&gt;&gt;<i> # chcon -R -h -u system_u -t textrel_shlib_t /usr/lib/httpd/ 
</I>&gt;&gt;&gt;&gt;<i> modules /
</I>&gt;&gt;&gt;&gt;<i> etc/httpd/modules
</I>&gt;&gt;&gt;&gt;<i> # service httpd start
</I>&gt;&gt;&gt;&gt;<i> Starting httpd: httpd: Syntax error on line 148 of /etc/httpd/conf/
</I>&gt;&gt;&gt;&gt;<i> httpd.conf: Cannot load /etc/httpd/modules/mod_auth_basic.so into
</I>&gt;&gt;&gt;&gt;<i> server: /etc/httpd/modules/mod_auth_basic.so: cannot open shared
</I>&gt;&gt;&gt;&gt;<i> object file: Permission denied
</I>&gt;&gt;&gt;&gt;<i>                                                              
</I>&gt;&gt;&gt;&gt;<i> [FAILED]
</I>&gt;&gt;&gt;&gt;<i> ----------
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> ****AGAIN I MUST NOTE: All is solved by turning off SELinux and/or
</I>&gt;&gt;&gt;&gt;<i> All is solved by not loading mod_python. All other modules loaded
</I>&gt;&gt;&gt;&gt;<i> just fine with their original permissions which matched mod_python
</I>&gt;&gt;&gt;&gt;<i> exactly.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Scott
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> On Jan 31, 2008, at 1:42 PM, Tom Stambaugh wrote:
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> The incantation that I use (for solving different problems,  
</I>&gt;&gt;&gt;&gt;&gt;<i> though)
</I>&gt;&gt;&gt;&gt;&gt;<i> is:
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> chcon -R -h -t httpd_sys_content_t &lt;filename&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> I think the &quot;-R&quot; makes it recurse to all children, and I think the
</I>&gt;&gt;&gt;&gt;&gt;<i> &quot;httpd_sys_content_t&quot; is more permissive (though that could be
</I>&gt;&gt;&gt;&gt;&gt;<i> mistaken).
</I>&gt;&gt;&gt;&gt;&gt;<i> The -h causes it to apply to sym links.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Afterwords, I get:
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> #ls -lZ adminuser
</I>&gt;&gt;&gt;&gt;&gt;<i> -rw-rw-r--  zeetix   zeetix   user_u:object_r:httpd_sys_content_t
</I>&gt;&gt;&gt;&gt;&gt;<i> &lt;filename&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> I use Fedora core3/core4 linux, so YMMV.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Thx,
</I>&gt;&gt;&gt;&gt;&gt;<i> Tom
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> ----- Original Message -----
</I>&gt;&gt;&gt;&gt;&gt;<i> From: &quot;Scott Bratcher&quot; &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">scott at 3floors.com</A>&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i> To: &quot;Eric Brunson&quot; &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">brunson at brunson.com</A>&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i> Cc: &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mod_python at modpython.org</A>&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i> Sent: Thursday, January 31, 2008 1:47 PM
</I>&gt;&gt;&gt;&gt;&gt;<i> Subject: Re: [mod_python] Apache Fails to load mod_python.so with
</I>&gt;&gt;&gt;&gt;&gt;<i> Permissiondenied error under SELinux
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> Thanks Eric,
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> &quot;setenforce 0&quot; THIS WORKED. Apache started right up
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> Below are the results of my attempts as you suggested. I think
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> we are
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> onto the problem because with SELinux enforced it loads right up.
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> However, the chcon command failed to clear up the problem. I'm
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> new to
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> SELinux. Is there another possible SELinux related permission
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> that  may be
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> the solution? It's just mod_python that is giving this problem
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> even
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> though all of the others share the same t permission  
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> httpd_module.
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> # ls -Zd modules
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> drwxr-xr-x  root root system_u:object_r:httpd_modules_t modules/
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> So I changed the permissions:
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> # chcon -t texrel_shlib_t /etc/httpd/modules/mod_python.so
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> # service httpd start
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> Starting httpd: httpd: Syntax error on line 210 of /etc/httpd/ 
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> conf/
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> httpd.conf: Syntax error on line 6 of /etc/httpd/conf.d/
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> python.conf:
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> Cannot load /etc/httpd/modules/mod_python.so into server: /etc/
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> httpd/
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> modules/mod_python.so: cannot restore segment prot after reloc:
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> Permission denied
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>                                                             
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> [FAILED]
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> # ls -Z /etc/httpd/modules/mod_python.so
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> -rwxr-xr-x  root root system_u:object_r:textrel_shlib_t /etc/ 
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> httpd/
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> modules/mod_python.so*
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> I also tried changing the permissions of the 2.5 site-packages
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> to the
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> same permissions as the previously working 2.4 site-packages,
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> plus  the
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> other listed below, and the still Apache Failure occurs.
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> # ls -Zd /usr/local/lib/python2.5/site-packages/ /usr/lib/
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> python2.4/
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> site-packages/
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> drwxr-xr-x  root root system_u:object_r:lib_t           /usr/lib/
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> python2.4/site-packages/
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> drwxr-xr-x  root root user_u:object_r:lib_t             /usr/ 
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> local/
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> lib/python2.5/site-packages/
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> system_u:object_r:lib_t
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> system_u:object_r:textrel_shlib_t
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> user_u:object_r:textrel_shlib_t
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> If you have other tips I'd appreciate any help you can offer.
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> Scott
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> On Jan 31, 2008, at 10:13 AM, Eric Brunson wrote:
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Scott Bratcher wrote:
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Hello all,
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> THE PROBLEM:
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Starting Apache results in this error:
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> # service httpd start
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Starting httpd: httpd: Syntax error on line 210 of /etc/httpd/
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> conf/
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> httpd.conf: Syntax error on line 6 of /etc/httpd/conf.d/
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> python.conf:
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Cannot load /etc/httpd/modules/mod_python.so into  server:
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> /etc/httpd/modules/mod_python.so: cannot restore segment  prot
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> after
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> reloc: Permission denied
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> [FAILED]
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> This error message is often related to selinux permissions.
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> A quick check to see if that is the problem is to disable
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> selinux  with
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> the command (as root) &quot;setenforce 0&quot;.  If the module then  loads
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> correctly, it can be fixed permanently with the command:
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> chcon -t texrel_shlib_t /etc/httpd/modules/mod_python.so
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Then, re-enable selinux with &quot;setenforce 1&quot;.
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> If disabling selinux does not fix the problem, then more
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> investigation
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> is required.
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Hope that helps,
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> e.
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> USING:
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> RHEL5 / SELinux
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Apache 2.2
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Python 2.5.1
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> mod_pythonn 3.3.1
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> httpd.conf (not .htaccess)
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> TESTED THUS FAR:
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> .so file exists with same permissions as other modules
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> # ls -Z /etc/httpd/modules/mod_python.so
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> -rwxr-xr-x  root root system_u:object_r:httpd_modules_t /etc/
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> httpd/
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> modules/mod_python.so*
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> If I comment out:
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> &quot;#LoadModule python_module modules/mod_python.so&quot;
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> and other related python lines Apache starts just fine without
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> mod_python.
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> # service httpd start
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Starting httpd:
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> [  OK  ]
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> Mod_python mailing list
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;&gt;<i> Mod_python mailing list
</I>&gt;&gt;&gt;&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;&gt;&gt;&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="024793.html">[mod_python] Apache Fails to load mod_python.so with Permission
	denied error under SELinux
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24792">[ date ]</a>
              <a href="thread.html#24792">[ thread ]</a>
              <a href="subject.html#24792">[ subject ]</a>
              <a href="author.html#24792">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
