From dado at wildbrain.com  Tue May  1 16:09:44 2001
From: dado at wildbrain.com (Dado Feigenblatt)
Date: Fri Jan  9 21:46:17 2004
Subject: [mod_python] mod_python and databases.
Message-ID: <3AEF4238.599ACFE2@wildbrain.com>

Hi there.

New to the list. New to mod_python.

I have a bunch of questions, but please, I'm not trying to start a flame
war.

I need to put up a database with access from different platforms.
So far I got this (which might change as my research continues):

The DB server will be (for now) PostgreSQL.
Users will be on different machines: SGIs, Intel/Linux, Macintoshes, and
maybe some Windows boxes.
At first I thought of doing the interface entirely web based, for
portability sake, using PHP (which I don't know)
Then, it hit me that this database will be accessed not only by humans
but by applications runing on some sort of UN*X like machine, and maybe
others (Mac/Win).
We have a lot of little apps and "glue" written in python.
So, we'll have to write some DB modules to interface with our DB and
other apps.
Then it hit me again, if we'll have to write a lot of that stuff in
python, maybe I should discard PHP and just go for python.
That's how I got to mod_python.
But this database will be internal only. Do I need a webserver with
mod_python for that?
Python has nice GUI toolkits. Can't I just do it in Python/Tk or
wxPython?
Why should I use mod_python?

Thanks.


--
Dado Feigenblatt                                 Wild Brain, Inc.
Technical Director                               (415) 553-8000 x???
dado@wildbrain.com                               San Francisco, CA.




From kees.serier at relan.nl  Wed May  2 13:00:15 2001
From: kees.serier at relan.nl (Serier, Kees)
Date: Fri Jan  9 21:46:17 2004
Subject: [mod_python] problems configuring mod_python on AIX.
Message-ID: <AA2536FEE0A9D311887000508B5EDF1E01C2BBED@ab00s003.abab.cadans.nl>

Hello,

I'm trying to build apache with mod_python, but the configure script gives
some errors (lookup at the 1) and 2) in the configure ouput below:  *
Mod_python):
- 1) It seems that it can't find @sbindir@/httpd but it is both in:
     -rwxr-xr-x   1 root     beheer   1200657 Mar 15 09:58
/usr/local/apache/bin/httpd
     -rwxr-xr-x   1 root     beheer   1200657 Mar 15 09:58
/usr/local/apache/sbin/httpd
     and works just fine.
     Passing --sbindir=/usr/local/apache/sbin to the configure scripts
     doesn't help.				     
     /usr/local/apache/libexec exists but is empty
- 2) allthough I use --with-pythonn==/usr/local/src/Python-2.0, configure
     still wants to use python 1.5.2
And yes, it is right about the bloodpresure ;-)

Can anybody give me a tip?

Thanks in advance,

Kees Serier mailto:kees.serier@ordina.nl

* General information:
   AIX        4.2.1
   GCC        2.95.2 (locally build and installed from source)
   GNU-make   3.79.1 (locally build and installed from source)
   Python     2.0    (locally build and installed from source)
   Apache     1.3.19 (locally build and installed from source with DSO)
   Mod_python 2.7.2

  Apache is (default) installed in /usr/local/apache
    source in /usr/local/src/apache_1.3.19
    /usr/local/apache/sbin did was not installed with the default
    installation, I created it making a full copy from /usr/local/apache/bin
    the configure script there finds the apxs utility.
  Python is (default) installed in /usr/local/python
    source in /usr/local/src/Python-2.0
   
  Apache and Python are being used with CGI and MySQL.

* Mod_python:
   source in /usr/local/src/mod_python-2.7.2
   
   [/usr/local/src/mod_python-2.7.2]# ./configure
--with-python=/usr/local/src/Python-2.0
--with-apache=/usr/local/src/apache_1.3.19 --sbindir=/usr/local/apache/sbin
   This gives the following output:
   
   loading cache ./config.cache
   checking for gcc... (cached) gcc
   checking whether the C compiler (gcc  ) works... yes
   checking whether the C compiler (gcc  ) is a cross-compiler... no
   checking whether we are using GNU C... (cached) yes
   checking whether gcc accepts -g... (cached) yes
   checking for ranlib... (cached) ranlib
   checking for ar... (cached) ar
   checking for a BSD compatible install... ./install-sh -c
   checking whether make sets ${MAKE}... (cached) yes
   checking for main in -lm... (cached) yes
   checking for working const... (cached) yes
   checking your blood pressure... a bit high, but we can proceed
   checking whether apxs is available
   checking for --with-apxs... no
   checking for apxs in /usr/local/apache/sbin... found, we'll use this. Use
--with-apxs to specify another.
1) checking for Apache libexec directory... apxs:Error: @sbindir@/httpd not
found or not executable
   
1) checking for Apache include directory... apxs:Error: @sbindir@/httpd not
found or not executable
   -I
   checking for --with-apache... /usr/local/src/apache_1.3.19
   checking for --with-python... /usr/local/src/Python-2.0
2) checking for python... (cached) /usr/local/src/Python-1.5.2/python
2) checking Python version... ./configure[1310]:
/usr/local/src/Python-1.5.2/python:  not found
   
2) checking whether Python is compiled with thread support...
./configure[1316]: /usr/local/src/Python-1.5.2/python:  not found
   no threads, good
2) checking Python install prefix... ./configure[1335]:
/usr/local/src/Python-1.5.2/python:  not found
   
   checking what libraries Python was linked with...
/usr/local/src/Python-2.0/libpython.a   -ldl  -lpthreads   -lm
-lreadline -ltermcap                      -L/usr/local/lib -ltk8.0 -ltcl8.0
-L/usr/lib/X11 -lld -lX11   -lcurses -ltermcap       -L$(exec_prefix)/lib
-lz 
   checking linker flags used to link Python...  -Wl,-bE:python.exp -lld  
   checking where Python include files are... -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include
   checking for mkdep... (cached) /usr/bin/X11/makedepend
   creating ./config.status
   creating Makefile
   creating src/Makefile
   creating src/libpython.module
   creating Doc/Makefile
   analyzing dependencies
-- end of message


From linux at mensagero.com.br  Wed May  2 12:19:13 2001
From: linux at mensagero.com.br (Linux)
Date: Fri Jan  9 21:46:17 2004
Subject: [mod_python] could not import mod_python.apache
Message-ID: <002f01c0d31b$3f53ad00$0300000a@mensagero.int.br>

Hello friends:)

I use apache 1.3.14, python 1.5.2, in a box (linux) Conectiva 6.0 - a RedHat
like linux.
I install mod_python 2.7.1-1.

When I open a directory example in a browser, I got a error 500. The
error_log of apache sais:

make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
[Wed May  2 12:04:41 2001] [error] [client XXX.XXX.XXX.XXX] python_handler:
make_obcallback returned no obCallBack!

Something is wrong, and my poor knowledge about python is not help.

In http.conf

<IfModule mod_python.c>
  Alias /mod_python/ /var/www/mod_python_test/
  <Directory /var/www/mod_python_test>
    AllowOverride FileInfo
  </Directory>
</IfModule>

In .htaccess

SetHandler python-program
PythonHandler pythonhandler

In pythonhandler.py

from mod_python import apache

def handler(req):
    req.send_http_header()
    req.write("Hello to the World from "+req.uri+"!")
    return apache.OK

tanks for any help.

in time: my english is poor, but my soul is better :)
----
Julio Cesar J Melati
Administrador de Redes

http://www.mensagero.com.br
falecom@mensagero.com.br


From db8coach at hotmail.com  Wed May  2 16:55:48 2001
From: db8coach at hotmail.com (Bryon G)
Date: Fri Jan  9 21:46:17 2004
Subject: [mod_python] mod_python vs. aolserver/pywx and postgresql
Message-ID: <LAW2-F133oHMwVN7miR0000d673@hotmail.com>

I am a student at ArsDigita University.  We recently did Phil Greenspun's 
database-backed website course, and made the decision early on to learn and 
use Python to do the class (instead of the non-free .net tools Philip was 
pushing).  We had to decide on a database and a web server, and originally 
started with mod-python and postgres using pg to glue them together, but we 
eventually  switched to aolserver and pywx.  There were two reasons:

1. our instructors were more familiar with AOLserver
2. AOLServer has database connection pooling built in.

The second reason is probably the one which will be relevant to you.  If 
it's possible/easy to do this with modpython/apache, I'd love to know about 
it because I'd prefer to use apache since it's so much more common, but in 
the *very* limited time we had to do the project we found more and better 
documentation (albeit translated from the C api documentation) for the pywx 
way than for the mod python way.

I explored a few other options before we made the switch, such as the pgpool 
module at the vaults (which people seem to be using with mod-fast-cgi, if 
anyone is using it with mod-python I'd love to hear about it), but since we 
were able to get going faster with aolserver that's what we used.

The syntax for the AOLServer database access stuff was, in my opinion, 
harder to learn than the pg way largely because there was less documentation 
available, but once that was out of the way the pooling question seemed to 
be the only real difference between the two in terms of end performance.

Bryon

ps- in case you are wondering, our project was to automate the 
secondarysources.com website for college debaters.  The project is not up on 
the internet yet, and probably won't be for a few months, so unfortunately I 
can't point you to it yet, but if anyone's interested I can post the code we 
wrote somewhere.
_________________________________________________________________
Get your FREE download of MSN Explorer at http://explorer.msn.com


From mhagger at alum.mit.edu  Wed May  2 19:35:31 2001
From: mhagger at alum.mit.edu (Michael Haggerty)
Date: Fri Jan  9 21:46:17 2004
Subject: [mod_python] mod_python vs. aolserver/pywx and postgresql
In-Reply-To: "Bryon G"'s message of "Wed, 02 May 2001 16:55:48 -0000"
References: <LAW2-F133oHMwVN7miR0000d673@hotmail.com>
Message-ID: <m2lmoftjcs.fsf@freak.kaiserty.com>

"Bryon G" <db8coach@hotmail.com> writes:
> The syntax for the AOLServer database access stuff was, in my
> opinion, harder to learn than the pg way largely because there was
> less documentation available, but once that was out of the way the
> pooling question seemed to be the only real difference between the
> two in terms of end performance.

I'm hope nobody is offended that I follow up with a comment about PyWX
on this mailing list...

With PyWX you don't have to limit yourself to the AOLserver database
API to get connection caching.  (In fact, I don't use it myself.)  The
latest version of PyWX has a single-interpreter, multiple-thread mode
with which you could open, for example, multiple pg database
connections on startup and store them in a pool.  Individual scripts
would grab a connection from the pool, use it, clear it out, and
return it to the pool to be reused.  Of course this is predicated on
pg and your pool code being thread-safe.

Once multithreaded Apache is out, similar tricks should be possible in
the Apache world.

Michael

-- 
Michael Haggerty
mhagger@alum.mit.edu

From bbhaydon at bigpond.com  Thu May  3 11:32:03 2001
From: bbhaydon at bigpond.com (Brett Haydon)
Date: Fri Jan  9 21:46:17 2004
Subject: [mod_python] RE: mod_python and databases
In-Reply-To: <200105021601.f42G1L243366@eden.ispol.com>
Message-ID: <NCBBKMABOKFCDLPIKKGIAEPCCCAA.bbhaydon@bigpond.com>

You could do it with any of those nice GUI toolkits.
modpython is only going to be useful if you want the
browser/web page to be the GUI.

It really goes back to the argument of server side
v client side. Do you want to install a GUI client
on every machine?? Do you need the bells & whistles of
a GUI or is a web interface sufficient? Which is faster
to develop for you? etc.

Brett


From dsavitsk at midway.uchicago.edu  Fri May  4 00:35:02 2001
From: dsavitsk at midway.uchicago.edu (douglas savitsky)
Date: Fri Jan  9 21:46:17 2004
Subject: [mod_python] Win2k httpd.conf problems
Message-ID: <988954502.3af23f8680258@webmail.uchicago.edu>

hi there,

i am having trouble getting started, and could use some help.
Win2k, Apache 1.3.14, mod_python 2.7.2, ActivePython 2.0.

I am unable to configure things, and i get the error:
-------------------------
Mod_python error: "PythonHandler test"

Traceback (most recent call last):

  File "c:\program files\python20\lib\mod_python\apache.py", line 180, in 
Dispatch
    object = resolve_object(self.req, module, object_str, silent)

  File "c:\program files\python20\lib\mod_python\apache.py", line 396, in 
resolve_object
    raise AttributeError, s

AttributeError: module 'c:\program files\python20\lib\test\__init__.pyc' 
contains no 'handler'
-------------------------

I saw a reference to this here
http://www.modpython.org/pipermail/mod_python/2001-February/001163.html
but i don't know what the answer means ...

as far as set up, here is what i have done ...

1. put the .dll where it goes.  that part seems okay.
2. add the line 'LoadModule python_module modules/mod_python.dll' which also 
seems fine
3. copy all of the .py files from 
..\python20\lib\mod_python-2.7.2\lib\python\mod_python\*.py to 
..\python20\lib\mod_python\*.py
[if i put them elsewhere i get other erros]
4. make changes to the httpd.conf file so it looks like this
<IfModule mod_alias.c>
    Alias /icons/ "C:/Apache/icons/"
    <Directory "C:/Apache/icons">
        Options Indexes MultiViews
        AllowOverride None
        Order allow,deny
        Allow from all
    </Directory>
    ScriptAlias /cgi-bin/ "C:/Apache/cgi-bin/"
    <Directory "C:/Apache/cgi-bin">
        AllowOverride None
        Options None
        Order allow,deny
        Allow from all
    </Directory>
    <Directory "C:/Apache/cgi-bin">
        AddHandler python-program .py
        PythonHandler test
        PythonDebug on
    </Directory>
</IfModule>

thanks for any help.  i am coming over from iis/asp world, so i have no apache 
experience either.

doug

From trengove at econdata.com.au  Sun May  6 15:07:53 2001
From: trengove at econdata.com.au (Chris Trengove)
Date: Fri Jan  9 21:46:17 2004
Subject: [mod_python] Win32 threading issue
Message-ID: <200105061509919.SM00265@athene>

I have been testing the following script on Apache with mod_python (Apache
1.13.17, mod_python 2.7.2, Windows 2000). I have been interested in testing
the possible throughput of this (and more useful scripts), so I have
another Python script which continually loads this "page".

from mod_python import apache
import thread

def handler(req):
    req.content_type = "text/plain"
    req.send_http_header()
    req.write("%d\n" % thread.get_ident())
    return apache.OK

When I run more than one copy of the driver script (in multiple consoles),
I get behavior indicative of some threading problems. Specifically, some
connections get "lost", the Apache error log reports various instances of
"IOError: Write failed...", and I occassionally get an access violation
inside Apache. Similarly, if I only run one copy of the driver script, and
just keep hitting the refresh button in a browser, the browser
occassionally returns TWO numbers, and sometimes reports an error in
retrieving the data. Note that I have tested my driver program retrieving a
simple text file, and everything works as expected, so it does not appear
to be a problem with Apache. (The problem also goes away if I set
ThreadPerChild to 1 in the Apache configuration.)

I have also found that, if I comment out the req.write() statement in the
handler, then there are no problems. From my examination of the
implementation of the request object, I see that req_write() contains calls
to Py_BEGIN_ALLOW_THREADS / Py_END_ALLOW_THREADS, whereas
req_send_http_header() contains no such calls. This suggests to me that
some thread switching is occurring inside req_write() which is messing with
the state of the interpreter.

I would be most grateful if anyone has any information to offer on this.

Chris Trengove


From marcf at becomm.com  Mon May  7 02:41:30 2001
From: marcf at becomm.com (Marc Fiuczynski)
Date: Fri Jan  9 21:46:17 2004
Subject: [mod_python] Win32 threading issue
Message-ID: <A9DFD9380C01D4118E740050DA7A8970386320@becomm-mis2.becomm.com>

A random shot in the dark...

are you using a multithreaded version of the python interpreter?  If so,
then that might be the cause of your problem.   Somewhere in the mod_python
documentation I read that apache would get confused if you used a
multithreaded version of python.  Check that and please let us (or at least
me) know.

In terms of throughput, you might also try writing a script using "wget" to
measure the number of requests per second you can run (not sure what the
windows equivalent is, or whether you can get it to work with cygwin).

Cheers,
Marc


> -----Original Message-----
> From: Chris Trengove [mailto:trengove@econdata.com.au]
> Sent: Saturday, May 05, 2001 10:08 PM
> To: mod_python@modpython.org
> Subject: [mod_python] Win32 threading issue
> 
> 
> I have been testing the following script on Apache with 
> mod_python (Apache
> 1.13.17, mod_python 2.7.2, Windows 2000). I have been 
> interested in testing
> the possible throughput of this (and more useful scripts), so I have
> another Python script which continually loads this "page".
> 
> from mod_python import apache
> import thread
> 
> def handler(req):
>     req.content_type = "text/plain"
>     req.send_http_header()
>     req.write("%d\n" % thread.get_ident())
>     return apache.OK
> 
> When I run more than one copy of the driver script (in 
> multiple consoles),
> I get behavior indicative of some threading problems. 
> Specifically, some
> connections get "lost", the Apache error log reports various 
> instances of
> "IOError: Write failed...", and I occassionally get an access 
> violation
> inside Apache. Similarly, if I only run one copy of the 
> driver script, and
> just keep hitting the refresh button in a browser, the browser
> occassionally returns TWO numbers, and sometimes reports an error in
> retrieving the data. Note that I have tested my driver 
> program retrieving a
> simple text file, and everything works as expected, so it 
> does not appear
> to be a problem with Apache. (The problem also goes away if I set
> ThreadPerChild to 1 in the Apache configuration.)
> 
> I have also found that, if I comment out the req.write() 
> statement in the
> handler, then there are no problems. From my examination of the
> implementation of the request object, I see that req_write() 
> contains calls
> to Py_BEGIN_ALLOW_THREADS / Py_END_ALLOW_THREADS, whereas
> req_send_http_header() contains no such calls. This suggests 
> to me that
> some thread switching is occurring inside req_write() which 
> is messing with
> the state of the interpreter.
> 
> I would be most grateful if anyone has any information to 
> offer on this.
> 
> Chris Trengove
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 

From trengove at econdata.com.au  Mon May  7 21:21:32 2001
From: trengove at econdata.com.au (Chris Trengove)
Date: Fri Jan  9 21:46:17 2004
Subject: [mod_python] Win32 threading issue
In-Reply-To: <A9DFD9380C01D4118E740050DA7A8970386320@becomm-mis2.becomm.
 com>
Message-ID: <200105072122310.SM00265@athene>

Marc,

Yes, as I understand things, this should be the multithreaded version,
since this is how Python is built for Win32. (I am running the BeOpen 2.0
version of Python.) But my reading of the mod_python documentation is that
mod_python under Win32 is "thread safe", to the extent that it allocates a
new Python thread for each new Apache thread, and does the appropriate
things to make sure that the threads co-exist peacefully.

As for measuring throughput, my script does that quite successfully - if I
only run one copy. The point is that this test environment exposes the
threading problem far more quickly than in a production environment, where
the conflict might occur much less often, and much less predictably.

Chris

At 02:41 AM 7/05/2001 -0700, Marc Fiuczynski wrote:
>A random shot in the dark...
>
>are you using a multithreaded version of the python interpreter?  If so,
>then that might be the cause of your problem.   Somewhere in the mod_python
>documentation I read that apache would get confused if you used a
>multithreaded version of python.  Check that and please let us (or at least
>me) know.
>
>In terms of throughput, you might also try writing a script using "wget" to
>measure the number of requests per second you can run (not sure what the
>windows equivalent is, or whether you can get it to work with cygwin).
>
>Cheers,
>Marc
>


From stephane.bidoul at softwareag.com  Mon May  7 13:22:42 2001
From: stephane.bidoul at softwareag.com (=?iso-8859-1?Q?St=E9phane_Bidoul?=)
Date: Fri Jan  9 21:46:17 2004
Subject: [mod_python] Win32 threading issue
In-Reply-To: <A9DFD9380C01D4118E740050DA7A8970386320@softwareag.com>
Message-ID: <000001c0d70d$064b9fe0$4eb3bd9d@softwareag.com>

> are you using a multithreaded version of the python 
> interpreter?  If so,
> then that might be the cause of your problem.   Somewhere in 
> the mod_python
> documentation I read that apache would get confused if you used a
> multithreaded version of python.  Check that and please let 
> us (or at least
> me) know.

I think this is true for *nix, but on windows,
you *must* use a multithreaded python.

I'll try to have a look at your issue, but I've very
few time available these days.

-sbi

> -----Original Message-----
> From: mod_python-admin@modpython.org
> [mailto:mod_python-admin@modpython.org]On Behalf Of Marc Fiuczynski
> Sent: 07 May, 2001 11:42
> To: 'Chris Trengove'; mod_python@modpython.org
> Subject: RE: [mod_python] Win32 threading issue
> 
> 
> A random shot in the dark...
> 
> are you using a multithreaded version of the python 
> interpreter?  If so,
> then that might be the cause of your problem.   Somewhere in 
> the mod_python
> documentation I read that apache would get confused if you used a
> multithreaded version of python.  Check that and please let 
> us (or at least
> me) know.
> 
> In terms of throughput, you might also try writing a script 
> using "wget" to
> measure the number of requests per second you can run (not 
> sure what the
> windows equivalent is, or whether you can get it to work with cygwin).
> 
> Cheers,
> Marc
> 
> 
> > -----Original Message-----
> > From: Chris Trengove [mailto:trengove@econdata.com.au]
> > Sent: Saturday, May 05, 2001 10:08 PM
> > To: mod_python@modpython.org
> > Subject: [mod_python] Win32 threading issue
> > 
> > 
> > I have been testing the following script on Apache with 
> > mod_python (Apache
> > 1.13.17, mod_python 2.7.2, Windows 2000). I have been 
> > interested in testing
> > the possible throughput of this (and more useful scripts), so I have
> > another Python script which continually loads this "page".
> > 
> > from mod_python import apache
> > import thread
> > 
> > def handler(req):
> >     req.content_type = "text/plain"
> >     req.send_http_header()
> >     req.write("%d\n" % thread.get_ident())
> >     return apache.OK
> > 
> > When I run more than one copy of the driver script (in 
> > multiple consoles),
> > I get behavior indicative of some threading problems. 
> > Specifically, some
> > connections get "lost", the Apache error log reports various 
> > instances of
> > "IOError: Write failed...", and I occassionally get an access 
> > violation
> > inside Apache. Similarly, if I only run one copy of the 
> > driver script, and
> > just keep hitting the refresh button in a browser, the browser
> > occassionally returns TWO numbers, and sometimes reports an error in
> > retrieving the data. Note that I have tested my driver 
> > program retrieving a
> > simple text file, and everything works as expected, so it 
> > does not appear
> > to be a problem with Apache. (The problem also goes away if I set
> > ThreadPerChild to 1 in the Apache configuration.)
> > 
> > I have also found that, if I comment out the req.write() 
> > statement in the
> > handler, then there are no problems. From my examination of the
> > implementation of the request object, I see that req_write() 
> > contains calls
> > to Py_BEGIN_ALLOW_THREADS / Py_END_ALLOW_THREADS, whereas
> > req_send_http_header() contains no such calls. This suggests 
> > to me that
> > some thread switching is occurring inside req_write() which 
> > is messing with
> > the state of the interpreter.
> > 
> > I would be most grateful if anyone has any information to 
> > offer on this.
> > 
> > Chris Trengove
> > 
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://www.modpython.org/mailman/listinfo/mod_python
> > 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From trengove at econdata.com.au  Tue May  8 13:34:46 2001
From: trengove at econdata.com.au (Chris Trengove)
Date: Fri Jan  9 21:46:17 2004
Subject: [mod_python] Win32 threading issue
In-Reply-To: <000001c0d70d$064b9fe0$4eb3bd9d@softwareag.com>
References: <A9DFD9380C01D4118E740050DA7A8970386320@softwareag.com>
Message-ID: <20010508133951.SM00265@athene>

St?phane,

I would be great if you could find time to look at this.

I have been doing some more investigating, trying to understand just what
is going on. As I mentioned in my previous message, Py_BEGIN_ALLOW_THREADS
is called in the request object's write() method, so thread switching could
occur here. But thread switching should still occur in any case inside the
main Python interpreter loop. To test this, I tried the following script

from mod_python import apache
import thread

counter = None
LOOPLIMIT =
1000000

def handler(req):
   	global counter
    counter = 0
   	for i in
range(0,LOOPLIMIT):
        counter = counter + 1
    req.content_type =
"text/plain"
    req.send_http_header()
    req.write("%d: %d\n" %
(thread.get_ident(),counter))
    return apache.OK

If I load this page once, I get a value of 1000000 back, as expected. If I
load the page from two clients "simultaneously" (or as fast as I can
activate each one), I get something like

Client 1
1908: 1200128
2016: 1354557
2024: 591402

Client 2
2004: 1698384
2012: 1800311
2028: 1205627

This is for three repetitions of the page load. As you can see, the Python
interpreter is definitely switching between threads, and producing crazy
results for the global counter variable, which is not protected by any lock.

This is all as expected. The puzzle is why the thread switching inside the
request object's module should be causing some problem, if that is indeed
where the trouble lies. I am wondering whether there is something in the
request object structure which is not totally thread-safe.

Incidentally, if I run enough repetitions of this test setup, I can
eventually get a situation where one thread crashes, and the other thread
(just at this point) returns a value like

632: 1515843<LF>568: 1572286

that is TWO thread IDs in the one message -- the write buffer of one thread
is being appended to by the other, somehow.

Some food for thought.
Chris

>I think this is true for *nix, but on windows,
>you *must* use a multithreaded python.
>
>I'll try to have a look at your issue, but I've very
>few time available these days.



From grisha at modpython.org  Tue May  8 00:22:08 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:17 2004
Subject: [mod_python] Win32 threading issue
In-Reply-To: <20010508133951.SM00265@athene>
Message-ID: <Pine.BSF.4.32.0105080017250.11714-100000@localhost>

Chris -

Do you have Keepalive enabled?

Grisha

On Tue, 8 May 2001, Chris Trengove wrote:

> Incidentally, if I run enough repetitions of this test setup, I can
> eventually get a situation where one thread crashes, and the other thread
> (just at this point) returns a value like
>
> 632: 1515843<LF>568: 1572286
>
> that is TWO thread IDs in the one message -- the write buffer of one thread
> is being appended to by the other, somehow.
>


From trengove at econdata.com.au  Tue May  8 16:27:09 2001
From: trengove at econdata.com.au (Chris Trengove)
Date: Fri Jan  9 21:46:17 2004
Subject: [mod_python] Win32 threading issue
In-Reply-To: <Pine.BSF.4.32.0105080017250.11714-100000@localhost>
References: <20010508133951.SM00265@athene>
Message-ID: <200105081628535.SM00265@athene>

Grisha,

I did have KeepAlive On, but it appears to make no difference. I have just
tried with KeepAlive Off, and I get the same behaviour. Also, the clients I
have been using would be closing the connection after each request. As
clients I have been using a Python script with urllib, and a little C++
test program I wrote to see if trying a different client made any
difference. It didn't.

Chris

At 12:22 AM 8/05/2001 -0400, Gregory (Grisha) Trubetskoy wrote:
>
>Chris -
>
>Do you have Keepalive enabled?
>
>Grisha
>
>On Tue, 8 May 2001, Chris Trengove wrote:
>
>> Incidentally, if I run enough repetitions of this test setup, I can
>> eventually get a situation where one thread crashes, and the other thread
>> (just at this point) returns a value like
>>
>> 632: 1515843<LF>568: 1572286
>>
>> that is TWO thread IDs in the one message -- the write buffer of one thread
>> is being appended to by the other, somehow.


From grisha at modpython.org  Tue May  8 09:47:25 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:17 2004
Subject: [mod_python] Win32 threading issue
In-Reply-To: <200105081628535.SM00265@athene>
Message-ID: <Pine.BSF.4.32.0105080944350.16559-100000@localhost>

Interesting...

Another question - when you say a thread crashes, what exactly do you see
- is it something in the log or one of those dr. watson messages?

On Tue, 8 May 2001, Chris Trengove wrote:

> Grisha,
>
> I did have KeepAlive On, but it appears to make no difference. I have just
> tried with KeepAlive Off, and I get the same behaviour. Also, the clients I
> have been using would be closing the connection after each request. As
> clients I have been using a Python script with urllib, and a little C++
> test program I wrote to see if trying a different client made any
> difference. It didn't.
>
> Chris
>
> At 12:22 AM 8/05/2001 -0400, Gregory (Grisha) Trubetskoy wrote:
> >
> >Chris -
> >
> >Do you have Keepalive enabled?
> >
> >Grisha
> >
> >On Tue, 8 May 2001, Chris Trengove wrote:
> >
> >> Incidentally, if I run enough repetitions of this test setup, I can
> >> eventually get a situation where one thread crashes, and the other thread
> >> (just at this point) returns a value like
> >>
> >> 632: 1515843<LF>568: 1572286
> >>
> >> that is TWO thread IDs in the one message -- the write buffer of one thread
> >> is being appended to by the other, somehow.
>


From fatpornstar at hotmail.com  Tue May  8 17:04:32 2001
From: fatpornstar at hotmail.com (Benjamin Watson)
Date: Fri Jan  9 21:46:17 2004
Subject: [mod_python] Remove me please
Message-ID: <F212ZS4HIv6EybqfAj800005fe8@hotmail.com>

_________________________________________________________________
Get your FREE download of MSN Explorer at http://explorer.msn.com


From CHagner at fool.com  Tue May  8 13:29:37 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:46:17 2004
Subject: [mod_python] Use mod_python for root/home page requests
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E47DCA@rover.foolhq.com>

I currently have mod_python wired into a location (Specifically <Location
/>) that allows all request coming under this location to be handled by my
handler.  I also use SetHandler instead of AddHandler so that it doesn't
even matter what file extension/type is requested.  My goal here is to have
an apache instance that has ALL of its requests go through mod_python.

Now, the strange thing is that this works great for all requests except for
the root/home page.  For example,

http://www.mydummysite.com/blahblah

This works great... my handler is called and is responsible for
interpretting 'blahblah'.  However,

http://www.mydummysite.com/

This fails to go to the handler and instead looks for the default page
(index.html) in the DocumentRoot.  Thus, my Location directive doesn't
appear to be inclusive of the request to the base home URL.

Has anyone tried this before?  I'd prefer to achieve this without relying on
mod_rewrite.

Thanks for your help.

Chris



From trengove at econdata.com.au  Wed May  9 08:27:50 2001
From: trengove at econdata.com.au (Chris Trengove)
Date: Fri Jan  9 21:46:17 2004
Subject: [mod_python] Win32 threading issue
In-Reply-To: <Pine.BSF.4.32.0105080944350.16559-100000@localhost>
References: <200105081628535.SM00265@athene>
Message-ID: <200105090830627.SM00265@athene>

Grisha,

Exactly what I see is variable in nature. The most usual thing will be an
entry in the Apache error log like this

[Tue May 08 16:47:37 2001] [error] PythonHandler hwtest: Traceback (most
recent call last):

[Tue May 08 16:47:37 2001] [error] PythonHandler hwtest:   File
"e:\python20\lib\mod_python\apache.py", line 189, in Dispatch     result =
object(self.req) [Tue May 08 16:47:37 2001] [error] PythonHandler hwtest:
File "c:/apache/apache/htdocs/python\hwtest.py", line 24, in handler
req.write("%d: %d\n" % (thread.get_ident(),counter)) 

[Tue May 08 16:47:37 2001] [error] PythonHandler hwtest: IOError: Write
failed, client closed connection. 

When I use my Python driver script, which keeps going even if no data is
returned from the server, I will often end up with an access violation
inside Apache.exe.

"The instruction at "0x6ff71679" referenced memory at "0x616c707b". The
memory could not be "read"."

Actually, this location appears to be always the same -- when it eventually
happens -- which might be after a significant number log error messages.
After the access violation, one of my driver scripts stops, because it
receives a socket exception (10054, "Connection reset by peer"), and the
other script continues merrily along.

Occassionally other things can happen too -- I think it just depends on
when the two threads conflict. As I mentioned earilier, one really
misterious occurrence is getting a "double message" returned to one thread,
just as the other receives no data. Like this

632: 1515843<LF>568: 1572286

Here <LF> is a line feed, and the numbers before the colons are the thread
IDs. I know that Apache has 50 threads which it is cycling through in
order. On this occassion 568 was due to be the thread to be used for the
OTHER client.

Chris

At 09:47 AM 8/05/2001 -0400, Gregory (Grisha) Trubetskoy wrote:
>
>Interesting...
>
>Another question - when you say a thread crashes, what exactly do you see
>- is it something in the log or one of those dr. watson messages?
>
>On Tue, 8 May 2001, Chris Trengove wrote:
>
>> Grisha,
>>
>> I did have KeepAlive On, but it appears to make no difference. I have just
>> tried with KeepAlive Off, and I get the same behaviour. Also, the clients I
>> have been using would be closing the connection after each request. As
>> clients I have been using a Python script with urllib, and a little C++
>> test program I wrote to see if trying a different client made any
>> difference. It didn't.



From benno at sesgroup.net  Wed May  9 11:24:48 2001
From: benno at sesgroup.net (Ben Leslie)
Date: Fri Jan  9 21:46:17 2004
Subject: [mod_python] Use mod_python for root/home page requests
In-Reply-To: <13CDDE6A53DBD311BC3200508B6F0C4805E47DCA@rover.foolhq.com>; from CHagner@fool.com on Tue, May 08, 2001 at 01:29:37PM -0400
References: <13CDDE6A53DBD311BC3200508B6F0C4805E47DCA@rover.foolhq.com>
Message-ID: <20010509112448.B22766@sesgroup.net>

On Tue, 08 May 2001, Chris Hagner wrote:

> I currently have mod_python wired into a location (Specifically <Location
> />) that allows all request coming under this location to be handled by my
> handler.  I also use SetHandler instead of AddHandler so that it doesn't
> even matter what file extension/type is requested.  My goal here is to have
> an apache instance that has ALL of its requests go through mod_python.
> 
> Now, the strange thing is that this works great for all requests except for
> the root/home page.  For example,
> 
> http://www.mydummysite.com/blahblah
> 
> This works great... my handler is called and is responsible for
> interpretting 'blahblah'.  However,
> 
> http://www.mydummysite.com/
> 
> This fails to go to the handler and instead looks for the default page
> (index.html) in the DocumentRoot.  Thus, my Location directive doesn't
> appear to be inclusive of the request to the base home URL.
> 
> Has anyone tried this before?  I'd prefer to achieve this without relying on
> mod_rewrite.



Mmm I think you need to change the "index" dirrective (not sure what its called,
I'm at uni at the moment, search for index.html). Then you want to add index.py
to this. That should in theory work.

Cheers,

Benno

From CHagner at fool.com  Tue May  8 22:17:04 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:46:17 2004
Subject: [mod_python] Use mod_python for root/home page requests
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E47DCE@rover.foolhq.com>

Actually, my handler doesn't call scripts (index.py)... instead it call a
Servlet-like object that needs to be in the PYTHONPATH.  This is why I'm
using a Location directive instead of a Directory directive.  I basically
need to handle URLs that map to classes in my path instead of script files
in the file system.

One thing I was considering was dropping a custom PythonTransHandler class
into the document root directory.  Then, if I identify a call for the
homepage, I could do an internal redirect to my servlet (i.e.
http://www.mydummysite.com/contentapp).  

The true hack is to put a META-REFRESH tag in the homepage (index.html) to
http://www.mydummysite.com/contentapp, but then I lose all referrer
information and the ability to do anything based on the original query
string.

Another possibility is mod_rewrite, but I'm not sure that will work.  Still
seems like this should be do-able though, given the number of web pages out
there that need to be fully dynamic.

Thanks for the response though.  Any input/ideas are great to hear.

Chris

-----Original Message-----
From: Ben Leslie [mailto:benno@sesgroup.net]
Sent: Tuesday, May 08, 2001 9:25 PM
To: Chris Hagner
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Use mod_python for root/home page requests


On Tue, 08 May 2001, Chris Hagner wrote:

> I currently have mod_python wired into a location (Specifically <Location
> />) that allows all request coming under this location to be handled by my
> handler.  I also use SetHandler instead of AddHandler so that it doesn't
> even matter what file extension/type is requested.  My goal here is to
have
> an apache instance that has ALL of its requests go through mod_python.
> 
> Now, the strange thing is that this works great for all requests except
for
> the root/home page.  For example,
> 
> http://www.mydummysite.com/blahblah
> 
> This works great... my handler is called and is responsible for
> interpretting 'blahblah'.  However,
> 
> http://www.mydummysite.com/
> 
> This fails to go to the handler and instead looks for the default page
> (index.html) in the DocumentRoot.  Thus, my Location directive doesn't
> appear to be inclusive of the request to the base home URL.
> 
> Has anyone tried this before?  I'd prefer to achieve this without relying
on
> mod_rewrite.



Mmm I think you need to change the "index" dirrective (not sure what its
called,
I'm at uni at the moment, search for index.html). Then you want to add
index.py
to this. That should in theory work.

Cheers,

Benno

From bbhaydon at bigpond.com  Wed May  9 16:00:13 2001
From: bbhaydon at bigpond.com (Brett Haydon)
Date: Fri Jan  9 21:46:17 2004
Subject: [mod_python] Compile Problems
Message-ID: <NCBBKMABOKFCDLPIKKGIIEBOCDAA.bbhaydon@bigpond.com>

Hi,
Just compiled Apache 1.3.19 on RH7.1 with mod_python
as a dso against Python 2.1

I get this error when I try to start Apache
Cannot load mod_python.so into server
undefined symbol: openpty

Any ideas??

cheers,  
____________________________
Brett Haydon
bbhaydon@bigpond.com 

From stephane.bidoul at softwareag.com  Wed May  9 14:07:33 2001
From: stephane.bidoul at softwareag.com (=?US-ASCII?Q?Stephane_Bidoul?=)
Date: Fri Jan  9 21:46:17 2004
Subject: [mod_python] Win32 threading issue
In-Reply-To: <200105090830627.SM00265@softwareag.com>
Message-ID: <000001c0d880$a37d8660$4eb3bd9d@softwareag.com>

Chris,

Could you send me your driver script?
I cannot reproduce the behaviour you describe with
my own test scripts.

BTW, do you have a multiprocessor machine?
I know some problems have been reported
but never reproced on MP WIN2K machines.

-sbi

> -----Original Message-----
> From: mod_python-admin@modpython.org
> [mailto:mod_python-admin@modpython.org]On Behalf Of Chris Trengove
> Sent: 09 May, 2001 00:28
> To: Gregory (Grisha) Trubetskoy
> Cc: mod_python@modpython.org
> Subject: RE: [mod_python] Win32 threading issue
> 
> 
> Grisha,
> 
> Exactly what I see is variable in nature. The most usual 
> thing will be an
> entry in the Apache error log like this
> 
> [Tue May 08 16:47:37 2001] [error] PythonHandler hwtest: 
> Traceback (most
> recent call last):
> 
> [Tue May 08 16:47:37 2001] [error] PythonHandler hwtest:   File
> "e:\python20\lib\mod_python\apache.py", line 189, in Dispatch 
>     result =
> object(self.req) [Tue May 08 16:47:37 2001] [error] 
> PythonHandler hwtest:
> File "c:/apache/apache/htdocs/python\hwtest.py", line 24, in handler
> req.write("%d: %d\n" % (thread.get_ident(),counter)) 
> 
> [Tue May 08 16:47:37 2001] [error] PythonHandler hwtest: 
> IOError: Write
> failed, client closed connection. 
> 
> When I use my Python driver script, which keeps going even if 
> no data is
> returned from the server, I will often end up with an access violation
> inside Apache.exe.
> 
> "The instruction at "0x6ff71679" referenced memory at 
> "0x616c707b". The
> memory could not be "read"."
> 
> Actually, this location appears to be always the same -- when 
> it eventually
> happens -- which might be after a significant number log 
> error messages.
> After the access violation, one of my driver scripts stops, because it
> receives a socket exception (10054, "Connection reset by 
> peer"), and the
> other script continues merrily along.
> 
> Occassionally other things can happen too -- I think it just 
> depends on
> when the two threads conflict. As I mentioned earilier, one really
> misterious occurrence is getting a "double message" returned 
> to one thread,
> just as the other receives no data. Like this
> 
> 632: 1515843<LF>568: 1572286
> 
> Here <LF> is a line feed, and the numbers before the colons 
> are the thread
> IDs. I know that Apache has 50 threads which it is cycling through in
> order. On this occassion 568 was due to be the thread to be 
> used for the
> OTHER client.
> 
> Chris
> 
> At 09:47 AM 8/05/2001 -0400, Gregory (Grisha) Trubetskoy wrote:
> >
> >Interesting...
> >
> >Another question - when you say a thread crashes, what 
> exactly do you see
> >- is it something in the log or one of those dr. watson messages?
> >
> >On Tue, 8 May 2001, Chris Trengove wrote:
> >
> >> Grisha,
> >>
> >> I did have KeepAlive On, but it appears to make no 
> difference. I have just
> >> tried with KeepAlive Off, and I get the same behaviour. 
> Also, the clients I
> >> have been using would be closing the connection after each 
> request. As
> >> clients I have been using a Python script with urllib, and 
> a little C++
> >> test program I wrote to see if trying a different client made any
> >> difference. It didn't.
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From trengove at econdata.com.au  Thu May 10 08:43:10 2001
From: trengove at econdata.com.au (Chris Trengove)
Date: Fri Jan  9 21:46:17 2004
Subject: [mod_python] Win32 threading issue
In-Reply-To: <000001c0d880$a37d8660$4eb3bd9d@softwareag.com>
References: <200105090830627.SM00265@softwareag.com>
Message-ID: <200105100844681.SM00265@athene>

Stephane,

This is the sort of thing I have been using. I open two console windows and
start the script in both.
	
	import sys
	import time
	import urllib

	URL =
"http://127.0.0.1/python/test.py"
	NUM_GETS = 1000

	start = time.clock()

for i in range(0,NUM_GETS):
    	f = urllib.urlopen(URL)
		print f.read(),

	f.close()
	stop = time.clock()
	elapsed = stop - start
	print "%d GETs in
%.3f seconds = %.0f GETs/second" % (NUM_GETS,elapsed,NUM_GETS / elapsed)

I do not have a multiprocessor machine. I have been wondering whether this
is something to do running these tests on a single (local) machine, rather
than across a network, but when I try the above driver script retrieving a
small text file, everything is OK.

Incidentally, I have now switched to Apache 1.3.19 and still get the same
behaviour.

Chris

At 02:07 PM 9/05/2001 +0200, =?US-ASCII?Q?Stephane_Bidoul?= wrote:
>Chris,
>
>Could you send me your driver script?
>I cannot reproduce the behaviour you describe with
>my own test scripts.
>
>BTW, do you have a multiprocessor machine?
>I know some problems have been reported
>but never reproced on MP WIN2K machines.
>
>-sbi


From trengove at econdata.com.au  Thu May 10 08:45:08 2001
From: trengove at econdata.com.au (Chris Trengove)
Date: Fri Jan  9 21:46:17 2004
Subject: [mod_python] Win32 threading issue
Message-ID: <200105100846110.SM00265@athene>

Stephane,

Sorry, the mail program keeps messing up the formatting of the script, so
here it is as an attachment.

Chris

At 02:07 PM 9/05/2001 +0200, =?US-ASCII?Q?Stephane_Bidoul?= wrote:
>Chris,
>
>Could you send me your driver script?
>I cannot reproduce the behaviour you describe with
>my own test scripts.
>
>BTW, do you have a multiprocessor machine?
>I know some problems have been reported
>but never reproced on MP WIN2K machines.
>
>-sbi
-------------- next part --------------
import sys
import time
import urllib

URL = "http://127.0.0.1/python/test.py"
NUM_GETS = 1000

start = time.clock()
for i in range(0,NUM_GETS):
    f = urllib.urlopen(URL)
    print f.read(),
    f.close()
stop = time.clock()
elapsed = stop - start
print "%d GETs in %.3f seconds = %.0f GETs/second" % (NUM_GETS,elapsed,NUM_GETS / elapsed)
From CHagner at fool.com  Wed May  9 18:51:25 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:46:17 2004
Subject: [mod_python] Strange reloading of modules used in handler
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E47DE3@rover.foolhq.com>

I'm seeing some strange things with modules being reloaded when used in
mod_python.

Here's the scenario...
1. I'm using PythonImport to import a module (called MyConfig) and store it
in a module variable.
2. That module variable is being accessed by the registered modpy handler.
3. When I start up apache, MyConfig is imported once for each child process.
4. When I request a page, the handler accesses MyConfig... here's the weird
part.
5. SOMETIMES, it re-runs/imports the module containing MyConfig....
specifically, the first couple requests (6? I have 5 child procs running)
re-import the module and then it stops re-importing... for a while... then,
every once in a while it re-imports MyConfig.

Can some explain this?

Is apache killing off child procs and therefore requiring new python
subinterpreters to start up?  If this is not the case, I'm looking for a way
to keep an object in memory (thus, not have its module re-imported).

Here's my modpy setup if it helps...
        SetHandler python-program
        PythonHandler monty.modpy_handler
        PythonImport demo.MyConfig
        PythonDebug On
        PythonNoReload On
        PythonInterpPerDirectory Off

Thanks in advance...

Chris

From CHagner at fool.com  Wed May  9 19:00:21 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:46:17 2004
Subject: [mod_python] empty apache Connection object
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E47DE4@rover.foolhq.com>

Hey there,

Is there a good reason that my Connection object (mp_conn) is empty?  I've
never seen this be populated, but now I'd kind of like some of the
information it provides.

Chris

From gdamjan at mail.net.mk  Wed May  9 03:10:35 2001
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 21:46:18 2004
Subject: [mod_python] Win2k httpd.conf problems
In-Reply-To: <988954502.3af23f8680258@webmail.uchicago.edu>; from dsavitsk@midway.uchicago.edu on Fri, May 04, 2001 at 12:35:02AM -0500
References: <988954502.3af23f8680258@webmail.uchicago.edu>
Message-ID: <20010509031035.A472@local.izmislen.mk>

> I am unable to configure things, and i get the error:
> -------------------------
> Mod_python error: "PythonHandler test"
> 
> Traceback (most recent call last):
> 
>   File "c:\program files\python20\lib\mod_python\apache.py", line 180, in 
> Dispatch
>     object = resolve_object(self.req, module, object_str, silent)
> 
>   File "c:\program files\python20\lib\mod_python\apache.py", line 396, in 
> resolve_object
>     raise AttributeError, s
> 
> AttributeError: module 'c:\program files\python20\lib\test\__init__.pyc' 
> contains no 'handler'
> -------------------------
> 
...
>     <Directory "C:/Apache/cgi-bin">
>         AddHandler python-program .py
>         PythonHandler test

The most common error in the world, and very obvious.
Don't use 'test.py' for your testing script, there is already a package named
'test' in python and mod_python tries to load and execute that one.

You should use something like 'mptest.py' and don't forget to change 
	
	PythonHandler mptest




-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From gdamjan at mail.net.mk  Thu May 10 04:16:05 2001
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 21:46:18 2004
Subject: [mod_python] Strange reloading of modules used in handler
In-Reply-To: <13CDDE6A53DBD311BC3200508B6F0C4805E47DE3@rover.foolhq.com>; from CHagner@fool.com on Wed, May 09, 2001 at 06:51:25PM -0400
References: <13CDDE6A53DBD311BC3200508B6F0C4805E47DE3@rover.foolhq.com>
Message-ID: <20010510041605.A412@local.izmislen.mk>

On Wed, May 09, 2001 at 06:51:25PM -0400, Chris Hagner wrote:
> I'm seeing some strange things with modules being reloaded when used in
> mod_python.
> 
> Here's the scenario...
> 1. I'm using PythonImport to import a module (called MyConfig) and store it
> in a module variable.

I'm not very sure the PythonImport directive works too good, and anyway there's
no need to use it. Just use plain import in the Python scripts.

> 2. That module variable is being accessed by the registered modpy handler.
> 3. When I start up apache, MyConfig is imported once for each child process.
> 4. When I request a page, the handler accesses MyConfig... here's the weird
> part.
> 5. SOMETIMES, it re-runs/imports the module containing MyConfig....
> specifically, the first couple requests (6? I have 5 child procs running)
> re-import the module and then it stops re-importing... for a while... then,
> every once in a while it re-imports MyConfig.

Apache child process die sometimes, either deliberately either not. This causes
your module to be re-imported.

-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From CHagner at fool.com  Wed May  9 23:57:32 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:46:18 2004
Subject: [mod_python] Strange reloading of modules used in handler
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E47DE8@rover.foolhq.com>

Thanks, yeah, simply importing the module was my backup plan.  

My motivation is thus: the server running this handler/code is going to be
swamped load-wise and I wanted to be able to use apache's graceful restart
(starting new child procs and swapping them in for the old ones without
dropping a single request) to seamlessly update the application
configuration.

Maybe I'm just being paranoid and the import won't make a graceful restart
drop a connection... I'll be doing some testing to find out just where this
stands.

Again, thanks for the feedback/input.  Much appreciated.

Chris

-----Original Message-----
From: Damjan [mailto:gdamjan@mail.net.mk]
Sent: Wednesday, May 09, 2001 10:16 PM
To: mod_python@modpython.org
Subject: Re: [mod_python] Strange reloading of modules used in handler


On Wed, May 09, 2001 at 06:51:25PM -0400, Chris Hagner wrote:
> I'm seeing some strange things with modules being reloaded when used in
> mod_python.
> 
> Here's the scenario...
> 1. I'm using PythonImport to import a module (called MyConfig) and store
it
> in a module variable.

I'm not very sure the PythonImport directive works too good, and anyway
there's
no need to use it. Just use plain import in the Python scripts.

> 2. That module variable is being accessed by the registered modpy handler.
> 3. When I start up apache, MyConfig is imported once for each child
process.
> 4. When I request a page, the handler accesses MyConfig... here's the
weird
> part.
> 5. SOMETIMES, it re-runs/imports the module containing MyConfig....
> specifically, the first couple requests (6? I have 5 child procs running)
> re-import the module and then it stops re-importing... for a while...
then,
> every once in a while it re-imports MyConfig.

Apache child process die sometimes, either deliberately either not. This
causes
your module to be re-imported.

-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python

From dave at geko.net.au  Thu May 10 23:11:46 2001
From: dave at geko.net.au (David Creelman)
Date: Fri Jan  9 21:46:18 2004
Subject: [mod_python] What is happening here ?
Message-ID: <3AFA9392.CD147616@geko.net.au>

[Thu May 10 23:09:35 2001] [error] PythonHandler myscript: Traceback
(most recent call last):
[Thu May 10 23:09:35 2001] [error] PythonHandler myscript:   File
"/usr/lib/python2.0/site-packages/mod_python/apache.py", line 176, in
Dispatch
    module = import_module(module_name, _req)
[Thu May 10 23:09:35 2001] [error] PythonHandler myscript:   File
"/usr/lib/python2.0/site-packages/mod_python/apache.py", line 331, in
import_module
    f, p, d = imp.find_module(parts[i], path)
[Thu May 10 23:09:35 2001] [error] PythonHandler myscript: ImportError:
No module named myscript

I get this error when I try to run the following script.

from mod_python import apache

def handler(req):
    req.content_type = "text/plain"
    req.send_http_header()
    req.write("Hello World!")

    return apache.OK

Any help appreciated
David


From aiglauer at yahoo.com  Thu May 10 07:18:27 2001
From: aiglauer at yahoo.com (Alexis Iglauer)
Date: Fri Jan  9 21:46:18 2004
Subject: [mod_python] Segfaults and Handler issues
Message-ID: <20010510141827.72440.qmail@web13903.mail.yahoo.com>

Hi

I am migrating an existing mod_python application to a new server -
which involves an entirely new installation of everything including
apache and mod_python.

The new server is running Mandrake 7.2, apache 1.3.14 [old one had
1.3.9] and mod_python 2.7.2 [old: 2.6.2].

I have had multiple (connected) problems.

One of the things I noticed is that in all the mod_python docs the
AddHandler directive is

AddHandler python-program .py

Whereas I use (also on the old, working system)

AddHandler python-program py   <---- No '.' before 'py'

If I put the '.' in, then apache never finds my handler (old and new
system).

On the old system, everything worked once I compiled with -DEAPI (I had
no issues with threading).  On the new setup I get apache SegFaults.  I
compile as a DSO on both systems.

In trying to fix the SegFault problem, I made myself a separate Python
in /usr/local/src/Python-1.5.2 which I compiled without threads.  I
have also compiled mod_python against this non-threaded python version.
 All this has not helped.  The following things occur:

If I run 'httpd -X' (single httpd and you can see the stdout) and I try
to load my webpage in Netscape (running locally) I will sometimes get
"module '/home/slbin/stoploss/slhead' contains no 'handler'" and
sometimes "no module named re" with the error coming out of my slhead
function.

The irritating thing is that the error messages show that I am using
libraries from my normal python installation and not my non-threaded
install.  Is there any way to force mod_python to load a python from a
certain path?

If I run httpd normally, my page(s) - I use multiple frames, each
generated by the same handler based on the URL - will load.

I have "PythonHandler slhead::handler" in my httpd.conf, and my
functions are inside slhead.py

I now know why my handler stops - I get segfaults whenever I try to
access req.connection.remote_ip.  This used to work - has the
apache/mod_python API changed?

Any ideas, especially on why httpd -X doesn't work and how to enforce a
certain python interpreter, would be most welcome.

Regards
Alexis




__________________________________________________
Do You Yahoo!?
Yahoo! Auctions - buy the things you want at great prices
http://auctions.yahoo.com/

From grisha at modpython.org  Thu May 10 14:14:26 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:18 2004
Subject: [mod_python] empty apache Connection object
In-Reply-To: <13CDDE6A53DBD311BC3200508B6F0C4805E47DE4@rover.foolhq.com>
Message-ID: <Pine.BSF.4.32.0105101414020.34628-100000@localhost>

Can you elaborate on 'empty'?

On Wed, 9 May 2001, Chris Hagner wrote:

> Hey there,
>
> Is there a good reason that my Connection object (mp_conn) is empty?  I've
> never seen this be populated, but now I'd kind of like some of the
> information it provides.
>
> Chris
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From jvdev at 3va.net  Thu May 10 20:47:26 2001
From: jvdev at 3va.net (Jeroen van Drie)
Date: Fri Jan  9 21:46:18 2004
Subject: [mod_python] mod_python DSO in my config
Message-ID: <01051020382904.01357@e109009>

Hi list,

I've installed mod_python on my rh7.1 test machine as a DSO - works like a 
dream - congrats on the team with an excellent module. However!

I need a bit of help getting this to work on my production server which is a 
RH 6.2 running apache 1.3.12 with as `non-standard' both mod_ssl and 
mod_rewrite compiled in. Other more standard modules such as mod_cgi and 
mod_auth are also compiled into the binary. I've just baked a new apache with 
mod_so compiled in and added:

LoadModule python_module libexec/mod_python.so
AddModule mod_python.c

to the config. (These are the only statements of this type (module 
definitions) in the httpd.conf)

I had apxs remade also and compiling & making the mod_python DSO was a 
success.

when I stop and startssl apache I get the notification that 
[warn] Loaded DSO libexec/mod_python.so uses plain Apache 1.3 API, this 
module might crash under EAPI! (please recompile it with -DEAPI)

Which according to many accounts is no problem. However - there is no 
instance of apache running after the startssl command. Worst of all - there 
is nothing in the logs to indicate why the server doesn't want to start  - 
even if running it with LogLevel debug

If I just start the server without ssl enabled the server is started but 
returns a connection refused upon execution of any binary cgi program. 

Since mod_python should be the first in the LoadModule list maybe the 
assumption that it should be compiled into the binary is valid - or that all 
modules should be DSO's so that mod_python can get first pick. But I have as 
many theories as braincells :)

Thanks & best regards,
Jeroen van Drie.

From gdamjan at mail.net.mk  Fri May 11 02:21:44 2001
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 21:46:18 2004
Subject: [mod_python] What is happening here ?
In-Reply-To: <3AFA9392.CD147616@geko.net.au>; from dave@geko.net.au on Thu, May 10, 2001 at 11:11:46PM +1000
References: <3AFA9392.CD147616@geko.net.au>
Message-ID: <20010511022144.A499@local.izmislen.mk>

...

> No module named myscript
> 
> I get this error when I try to run the following script.
> 
...

How is Apache setup, and where is the 'myscript.py' script located?
It seems that mod_python can't find your 'myscript.py' file.

-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From rbunke at helios.acomp.usf.edu  Thu May 10 20:38:40 2001
From: rbunke at helios.acomp.usf.edu (Rick Bunke)
Date: Fri Jan  9 21:46:18 2004
Subject: [mod_python] I can't get apache to handle a .py file
Message-ID: <Pine.GSO.4.21.0105101911530.26528-100000@nova.acomp.usf.edu>

Hello,

I'm stuck.  I've read the FAQ.  I've read mod_python Manuel up to 2.4
testing your new installation.  I've followed the directions there for
mptest.py but all apache will do for me is serve up the text file
mptest.py.  It wont hand it off to mod_python.  I compiled the mod into
apache as static not DSO. 

I'll be glad to send the bulk of my config file if requested to do so but
here is what I think is the important stuff.

httpd.conf
#------ 
LogLevel debug

DocumentRoot "/home/myhome/Text/Web"

#I was just trying to turn every thing on here while I was troubleshouting
#this problem...
<Directory "/">
        Options All +MultiViews
</Directory>

# Python stuff according to mod_python manuel
<Directory "/home/myhome/Texts/Web/pytest">
        AddHandler python-program .py
        PythonHandler mptest
        PythonDebug On
</Directory>
#--------

the config file is basically identical to apache default config
file with the specific site info changed.

[black_box]cat mptest.py
from mod_python import apache
    
def handler(req):
        req.send_http_header()
        req.write("Hello World!")
        return apache.OK

[black_box]ls -l mptest.py
-rwxr-xr-x    1 rick     rick          123 May 10 19:35 mptest.py*

I wasn't sure if mptest.py was suppose to be excutable or not so I it
made it excutable just in case.

when I put a "#!/usr/local/python" in at the top and run it stand alone, 
it doesn't like the "import _apache" line which doesn't really surprise me
sense I don't think your suppose to run it like that :)  I was just trying
to figure what was wrong sense I get no errors in my error.log 

When I type "http://myip/pytest/mptest.py" in web my browser, it displays 
the text file:

from mod_python import apache
    
def handler(req):
	req.send_http_header()
	req.write("Hello World!")
	return apache.OK


Also, when I compiled apache, it failed in the mod_python directory saying
some functions (openpty and forkpty) were "undefined references" so I had
to add "-lutil" to the 
"LIBS="$LIBS -lm /usr/local/src/Python-2.1c2/libpython2.1.a"" 
line in the libpython.module config file, rerun configure, and then it
would compile ok.  possable bug in the configure scripts, or my setup, I
don't know which.

I run Linux 2.4.4
Python 2.1c2 
Apache 1.3.19
Mod_Python 2.7.2

Please help me :)

Thanks
Rick

we enjoy great advantages from the inventions of others, we should be 
glad of an opportunity to serve others by any invention of ours; and 
this we should do freely and generously.
		- Ben Franklin (declining to take out a patent on the
				Franklin Stove)

Whenever there is a conflict between human rights and property rights, 
human rights must prevail.
	           - Abraham Lincoln
	
Information is the currency of democracy.
		   - Thomas Jefferson


From rdevide at ican.at  Fri May 11 09:52:49 2001
From: rdevide at ican.at (Devide Robert)
Date: Fri Jan  9 21:46:18 2004
Subject: [mod_python] I can't get apache to handle a .py file
References: <Pine.GSO.4.21.0105101911530.26528-100000@nova.acomp.usf.edu>
Message-ID: <3AFB9A51.657A4723@ican.at>

Rick Bunke wrote:

> DocumentRoot "/home/myhome/Text/Web"
 :
> <Directory   "/home/myhome/Texts/Web/pytest">

Text <-> Texts ???

dave

From rbunke at helios.acomp.usf.edu  Sat May 12 16:12:43 2001
From: rbunke at helios.acomp.usf.edu (Rick Bunke)
Date: Fri Jan  9 21:46:18 2004
Subject: [mod_python] I can't get apache to handle a .py file
In-Reply-To: <3AFB9A51.657A4723@ican.at>
Message-ID: <Pine.GSO.4.21.0105121605430.4178-100000@nova.acomp.usf.edu>

On Fri, 11 May 2001, Devide Robert wrote:
                                
> Rick Bunke wrote:
>
> > DocumentRoot "/home/myhome/Text/Web"
>  :
> > <Directory   "/home/myhome/Texts/Web/pytest">
>
> Text <-> Texts ???
>
> dave
>

Thanks, It works now.
That was the annoying little detail that I've been overlooking and
pulling my hair out over for three days now while thinking, it can't be
this hard!  :)

Thank You, again 
Rick

we enjoy great advantages from the inventions of others, we should be 
glad of an opportunity to serve others by any invention of ours; and 
this we should do freely and generously.
		- Ben Franklin (declining to take out a patent on the
				Franklin Stove)

Whenever there is a conflict between human rights and property rights, 
human rights must prevail.
	           - Abraham Lincoln
	
Information is the currency of democracy.
		   - Thomas Jefferson



From dave at geko.net.au  Mon May 14 22:34:29 2001
From: dave at geko.net.au (David Creelman)
Date: Fri Jan  9 21:46:18 2004
Subject: [mod_python] What is happening here ?
References: <3AFA9392.CD147616@geko.net.au> <20010511022144.A499@local.izmislen.mk>
Message-ID: <3AFFD0D5.9B0A08A2@geko.net.au>

Hi Damjan,

myscript.py is in /var/www/cgi-bin. I'm running Mandrake 8.0.

Should it go somewhere else ?

Cheers
David

Damjan wrote:

> ...
>
> > No module named myscript
> >
> > I get this error when I try to run the following script.
> >
> ...
>
> How is Apache setup, and where is the 'myscript.py' script located?
> It seems that mod_python can't find your 'myscript.py' file.
>
> --
> Damjan Georgievski              |           ???????~???? ??????????????????????
> Skopje, Macedonia               |           ?????????~??, ?????????????????~??
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From petar at metamarkets.com  Mon May 14 08:38:52 2001
From: petar at metamarkets.com (Petar Karafezov)
Date: Fri Jan  9 21:46:18 2004
Subject: [mod_python] RE: setting multiple cookies with req.headers_out
Message-ID: <86FC34EA3C4F074AA6BBFFE52ED83FED27C1D5@METAEXCH.sfo.metamarkets.com>

Hello all -

I am trying to send more than one cookie in my req.headers_out. The problem
is that req.headers_out is a dictionary - and if I want to send more than 1
cookie - only the last one gets send - they all have key 'Set-cookie'.

I am sure there's a quick and easy solution for this ...I just didn't see
it. Could anyone share ideas/experience on this issue ?

Thanks!

Regards to all,
Petar Karafezov

MetaMarkets.com
415-575-3015
-------------------------------------------
Investing Out Loud at
http://www.metamarkets.com
-------------------------------------------

From miguel at yorku.ca  Mon May 14 11:57:09 2001
From: miguel at yorku.ca (Miguel Marques)
Date: Fri Jan  9 21:46:18 2004
Subject: [mod_python] RE: setting multiple cookies with req.headers_out
In-Reply-To: <86FC34EA3C4F074AA6BBFFE52ED83FED27C1D5@METAEXCH.sfo.metamarkets.com>
References: <86FC34EA3C4F074AA6BBFFE52ED83FED27C1D5@METAEXCH.sfo.metamarkets.com>
Message-ID: <20010514115709Y.miguel@yorku.ca>

Greetings...
On Mon, 14 May 2001 08:38:52 -0700, Petar Karafezov <petar@metamarkets.com> wrote:
> Hello all -
> 
> I am trying to send more than one cookie in my req.headers_out. The problem
> is that req.headers_out is a dictionary - and if I want to send more than 1
> cookie - only the last one gets send - they all have key 'Set-cookie'.
> 
> I am sure there's a quick and easy solution for this ...I just didn't see
> it. Could anyone share ideas/experience on this issue ?
> 
Just use 

req.headers_out.add('Set-Cookie', ...)

as many time as you need.

						Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830




From grisha at modpython.org  Mon May 14 13:09:09 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:18 2004
Subject: [mod_python] RE: setting multiple cookies with req.headers_out
In-Reply-To: <86FC34EA3C4F074AA6BBFFE52ED83FED27C1D5@METAEXCH.sfo.metamarkets.com>
Message-ID: <Pine.BSF.4.32.0105141308590.97224-100000@localhost>


http://www.modpython.org/live/mod_python-2.7.3/doc-html/pyapi-mptable.html



On Mon, 14 May 2001, Petar Karafezov wrote:

> Hello all -
>
> I am trying to send more than one cookie in my req.headers_out. The problem
> is that req.headers_out is a dictionary - and if I want to send more than 1
> cookie - only the last one gets send - they all have key 'Set-cookie'.
>
> I am sure there's a quick and easy solution for this ...I just didn't see
> it. Could anyone share ideas/experience on this issue ?
>
> Thanks!
>
> Regards to all,
> Petar Karafezov
>
> MetaMarkets.com
> 415-575-3015
> -------------------------------------------
> Investing Out Loud at
> http://www.metamarkets.com
> -------------------------------------------
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From grisha at modpython.org  Mon May 14 17:25:07 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:18 2004
Subject: [mod_python] problem with publisher.py File class w/ possible
 fix
In-Reply-To: <A9DFD9380C01D4118E740050DA7A89703860FA@becomm-mis2.becomm.com>
Message-ID: <Pine.BSF.4.32.0105141722420.99402-100000@localhost>

Marc -

Do you have any more details so I could reproduce this error? I am having
a hard time understanding why it would insist on m being an integer.
Perhaps you have the piece of code that caused it?

Grisha


On Wed, 21 Mar 2001, Marc Fiuczynski wrote:

> Hi,
>
> I am having a problem with the publisher.py File class, which I have fixed,
> but I would like your approval.
>
> My configuration is as follows:
> mod_python 2.7.2
> python 2.0
> apache 1.3.14
> Red Hat Linux 7.0
>
> I am using mod python to do http_post operations with files.  This uses the
> publisher.py File class.  The __init__ method of that class steals all of
> the file-like methods, as shown below:
>
>         # steal all the file-like methods
>         methods = field.file.__methods__
>         for m in methods:
>             self.__dict__[m] = methods[m]
>
> I was getting an error in that last line saying that 'm' needed to be an
> int.  (Sorry, I forget the actual error).  I found some other code that was
> doing the exact same thing and noticed that they were assigning the methods
> in a different manner (using setattr).  See below:
>
>         # steal all the file-like methods
>         file = field.file
>         for method in file.__methods__:
>             setattr(self, method, getattr(file, method))
>
> This seems to work.  I am too nascent to Python to understand the history of
> the built-in __xyz__ fields in objects, and whether this is something
> specific to Python 2.0 versus an older version of Python.  Please review and
> if it is the right thing, then feel free to incorporate this change into
> your mod_python code base.
>
> Cheers,
> Marc
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From SumnerH at fool.com  Mon May 14 18:33:44 2001
From: SumnerH at fool.com (G . Sumner Hayes)
Date: Fri Jan  9 21:46:18 2004
Subject: [mod_python] PythonImport question
Message-ID: <20010514183344.A6813@fool.com>

Brief version:
I have a patch to make PythonImport take place during server init
instead of child init--is there any chance it would be accepted?

Long version:
So the PythonImport documentation says:

: Tells the server to import the Python module module at process
: startup. This is useful for initialization tasks that could be
: time consuming and should not be done at the request processing
: time, e.g. initializing a database connection.
:
: The import takes place at child process initialization, so the
: module will actually be imported once for every child process
: spawned.

Having the import take place at every child process
initialization seems to run counter to the purpose of the
statement (doing time consuming server startup stuff).  It
also makes the various children have potentially different
PythonImport'd contents if the module(s) imported that way
are edited in place.

I'm wondering if anyone actually wants that behavior; it seems
like it'd be better to do the PythonImport exactly once at server
startup.

Rationale 1:
Suppose I have a ton of expensive startup work to do in my
PythonImport lines.  Furthermore, I need to be able to do
apache graceful restarts even while under heavy load.  Here's
a sketch of how the apache graceful restarts work--I'll pretend
there are 3 different types of apache process, a "master control
program" or MCP which coordinates startup, a "pool master" or
PM which spawns children as needed, and the child processes
or CPs.

1.  A user sends MCP a SIGUSR1 signal indicating a graceful
restart should take place.  The old PM and CPs continue
handling incoming requests.
2.  MCP starts up a new PM, which reads all startup files and
processes them; this includes running the server init functions
for apache modules (in particular mod_python).
3.  New PM finishes reading startup and fork()s off new CPs (as
per the MinSpareServers and related apache directives).  After
forking new CPs, the new PM tells the MCP that it is ready to
go.
4.  MCP tells old PM to shut down and routes all new incoming
requests to the new PM. 
5.  Old PM tells old CPs to exit; if they're idle, they exit
immediately.  If they're serving a request, they finish doing
so and then exit.

Pretty elegant; you can change the entire apache config on the
fly without dropping any connections.  You can even update shared
objects this way without dropping connections; you can e.g.
migrate from python 1.5.2 to Stackless Python 2.0 (potentially
with a new version of mod_python) seamlessly.

_However_, step (3) gets us in trouble if PythonImports happen
in the child process--the old PM will be exiting while the new
CPs are busy doing whatever (potentially many-second or evan
minute-long) the PythonImports say to do.

If PythonImports took place in the server init, they'd get done
before the new PM/CPs took over; the old ones would continue
serving requests until the new ones were ready.

(Yes, the setup involved will have high-availability measures
in place, but it'd be really nice to have this feature for a
number of reasons).

Rationale 2:
It's far more "apache-like" for configuration data to be read
exactly 1 time at startup and then re-read when explicitly asked
to do so (via a graceful restart).  As it stands now, if I'm
importing mystuff.py via PythonImport and I edit that file while
the server is running, some apache children (which started before
my edits) will have the old mystuff module and others (which
happened to start after my edits) will have the new one.  That's
confusing and potentially dangerous, and if I'm editing files
in place (groan, I know) it's full of nasty races.

Let me know and I'll send a patch.

  Sumner

-- 
rage, rage against the dying of the light

From CHagner at fool.com  Tue May 15 11:00:58 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:46:18 2004
Subject: [mod_python] empty apache Connection object
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E47E1D@rover.foolhq.com>

Sorry for vague statement... here's what I'm seeing when I print out the
Connection object and its attributes.  As you can see, there does appear to
be an mp_conn object present, but all attributes/methods return 'None'.
Thoughts?  Let me know if there's something more valuable I can do to
determine the state of the object.  Thanks.

REQUEST'S CONNECTION'S VALUES
conn: <mp_conn object at 0x87ad968>
child num: None
local address: None
remote address: None
remote ip: None
remote host: None
remote logname: None
user name: None
auth type: None
keep alives: None
local ip: None
local host: None

Chris

-----Original Message-----
From: Gregory (Grisha) Trubetskoy [mailto:grisha@modpython.org]
Sent: Thursday, May 10, 2001 2:14 PM
To: Chris Hagner
Cc: 'mod_python@modpython.org'
Subject: Re: [mod_python] empty apache Connection object



Can you elaborate on 'empty'?

On Wed, 9 May 2001, Chris Hagner wrote:

> Hey there,
>
> Is there a good reason that my Connection object (mp_conn) is empty?  I've
> never seen this be populated, but now I'd kind of like some of the
> information it provides.
>
> Chris
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>

From CHagner at fool.com  Fri May 18 13:45:05 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:46:18 2004
Subject: [mod_python] several mod_python issues
Message-ID: <200105182250.SAA27068@monkeyboy.dorc.foolhq.com>

While working with mod_python lately, we've noticed a couple of
inconsistencies with the documentation and also have a few 
comments/questions on intended behavior and whether certain behavior 
was intended or is just a bug.

1. The PythonNoReload directive is a bit confusing and does not provide
   an option that would also be useful. "PythonNoReload Off" performs a
   full reload/import of the pyhandler on every request.
   "PythonNoReload On" only performs a reload/import when the mtime
   of the handler has changed. We would like to also propose an
   additional option to "never" reload/import the handler except upon
   initial startup of the child process. This would allow for a more
   controlled re-initialization of the server(s) via an apache graceful
   restart.

2. Modules pre-loaded via the PythonImport directive do not appear to be
   readily available in the handler. We've verified that Python Import
   and the handler are running in the same interpreter space by passing
   info via global classes such as Exception, but we can't find the
   modules loaded via PythonImport. They must be somewhere, but just
   can't seem to locate them... What is the expected way to access
   modules that have been pre-loaded via PythonImport from within code
   such as the handler?

3. As detailed in an earlier post from Sumner Hayes, mod_python does not
   perform as expected/desired on a apache graceful restart.
   Essentially, new children are spawned and declared ready to the
   parent before they can actually serve requests (ie still initilizing
   any PythonImport directives). The mod_python directives should be
   fully processed before considering the child ready to serve requests.

This isn't meant as just a rant. Just some things that we've noticed
that are important in our environment. We're willing to help with fixes,
etc., but wanted to make sure we had a full perspective on all the
issues at hand before attacking this stuff. 

Please let us know what you think about the observations listed above.
Thanks.

-- 
Stephan Koledin
Mad Scientist
The Motley Fool
http://fool.com



From grisha at modpython.org  Sat May 19 00:38:41 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:18 2004
Subject: [mod_python] several mod_python issues
In-Reply-To: <200105182250.SAA27068@monkeyboy.dorc.foolhq.com>
Message-ID: <Pine.BSF.4.32.0105190031400.54052-100000@localhost>

On Fri, 18 May 2001, Chris Hagner wrote:

> While working with mod_python lately, we've noticed a couple of
> inconsistencies with the documentation and also have a few
> comments/questions on intended behavior and whether certain behavior
> was intended or is just a bug.
>
> 1. The PythonNoReload directive is a bit confusing and does not provide
>    an option that would also be useful. "PythonNoReload Off" performs a
>    full reload/import of the pyhandler on every request.
>    "PythonNoReload On" only performs a reload/import when the mtime
>    of the handler has changed. We would like to also propose an
>    additional option to "never" reload/import the handler except upon
>    initial startup of the child process. This would allow for a more
>    controlled re-initialization of the server(s) via an apache graceful
>    restart.

This one is a BUG that seems to have been introduced in 2.7.3 releases
while trying to fix another one....

The remaining two issues are just a big mess because I never gave any
priority to PythonImport. The only catch with Summer Hayes's approach is
that stuff will run as root, which to me seems kind of bad. (I haven't
seen the patch, so this is part speculation)

Grisha

> 2. Modules pre-loaded via the PythonImport directive do not appear to be
>    readily available in the handler. We've verified that Python Import
>    and the handler are running in the same interpreter space by passing
>    info via global classes such as Exception, but we can't find the
>    modules loaded via PythonImport. They must be somewhere, but just
>    can't seem to locate them... What is the expected way to access
>    modules that have been pre-loaded via PythonImport from within code
>    such as the handler?
>
> 3. As detailed in an earlier post from Sumner Hayes, mod_python does not
>    perform as expected/desired on a apache graceful restart.
>    Essentially, new children are spawned and declared ready to the
>    parent before they can actually serve requests (ie still initilizing
>    any PythonImport directives). The mod_python directives should be
>    fully processed before considering the child ready to serve requests.
>
> This isn't meant as just a rant. Just some things that we've noticed
> that are important in our environment. We're willing to help with fixes,
> etc., but wanted to make sure we had a full perspective on all the
> issues at hand before attacking this stuff.
>
> Please let us know what you think about the observations listed above.
> Thanks.
>
> --
> Stephan Koledin
> Mad Scientist
> The Motley Fool
> http://fool.com
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From teepwalla at yahoo.com  Fri May 18 21:51:21 2001
From: teepwalla at yahoo.com (Prateep Siamwalla)
Date: Fri Jan  9 21:46:18 2004
Subject: [mod_python] mod_python and locale
Message-ID: <20010519045121.32984.qmail@web14306.mail.yahoo.com>

Hi All,

I've come across a problem with mod_python (2.7.2
compiled with Python 2.0 --with-threads=no) on Linux
(RH 7.0) regarding locale.

the following code (mptest.py):
-----------------
from mod_python import apache
from locale import setlocale,LC_ALL,format


def handler(req):
    req.content_type = "text/plain"
    req.send_http_header()
    setlocale(LC_ALL,'')
    a = 123123231.323    
    req.write("The formatted version of the number %s
is %s" % (a,format('%.2f',a,1)))
    return apache.OK

Produces:
----------------------
The formatted version of the number 123123231.323 is
123123231.32

Rather than the expected
-----------------------
....123,123,231.32

I don't have any problems with locale formating on
Win98+Apache+Python2.0.  Is this a recognized problem?

I've tried locale formating from the Python 2.0
command line on the Linux box and it yields expected
results ( 123,123,231.32)

I've tried locale formating from the compiled
Python2.0 with no threads binary on the Linux box and
it also yields expected results.

Its only on mod_python am I encountering a lack of
correct formating.

Have others encountered this problem?

Thanks in advance.
teep


__________________________________________________
Do You Yahoo!?
Yahoo! Auctions - buy the things you want at great prices
http://auctions.yahoo.com/

From gdamjan at mail.net.mk  Sat May 19 12:03:10 2001
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 21:46:18 2004
Subject: [mod_python] What is happening here ?
In-Reply-To: <3AFFD0D5.9B0A08A2@geko.net.au>; from dave@geko.net.au on Mon, May 14, 2001 at 10:34:29PM +1000
References: <3AFA9392.CD147616@geko.net.au> <20010511022144.A499@local.izmislen.mk> <3AFFD0D5.9B0A08A2@geko.net.au>
Message-ID: <20010519120310.A256@local.izmislen.mk>

On Mon, May 14, 2001 at 10:34:29PM +1000, David Creelman wrote:
> > ...
> >
> > > No module named myscript
> > >
> > > I get this error when I try to run the following script.
> > >
> > ...
> >
> > How is Apache setup, and where is the 'myscript.py' script located?
> > It seems that mod_python can't find your 'myscript.py' file.
>
> myscript.py is in /var/www/cgi-bin. I'm running Mandrake 8.0.
> 
> Should it go somewhere else ?

Yes! Put it somewhere in the python search path.

Also you should probably reread the mod_python documentation. 
mod_python is not related to CGI scripts, but is a scripting engine
inside the apache process. You can do much more with mod_python than
with CGI.

-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From dyeung at ust.hk  Sat May 19 19:45:43 2001
From: dyeung at ust.hk (David Yeung)
Date: Fri Jan  9 21:46:18 2004
Subject: [mod_python] Modules with identical name in different directories
Message-ID: <3B065CE7.2BD9F0CA@ust.hk>

If I have two different python modules with identical name (index.py), e.g.:

   http://host/pytest1/index.py/mainpage

and

   http://host/pytest2/index.py/mainpage

When I access the first index.py module, the mod_python import the first index.py.
Then I switch to access the second index.py. Will the mod_python know it is a
different module with the first one, and then import the second 'index.py' 
automatically? Or it will use the already imported 'index.py' module?

Thanks

david

From grisha at modpython.org  Sat May 19 13:35:58 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:18 2004
Subject: [mod_python] Modules with identical name in different directories
In-Reply-To: <3B065CE7.2BD9F0CA@ust.hk>
Message-ID: <Pine.BSF.4.32.0105191334130.62711-100000@localhost>

On Sat, 19 May 2001, David Yeung wrote:

> If I have two different python modules with identical name (index.py), e.g.:
>
>    http://host/pytest1/index.py/mainpage
>
> and
>
>    http://host/pytest2/index.py/mainpage
>
> When I access the first index.py module, the mod_python import the first index.py.
> Then I switch to access the second index.py. Will the mod_python know it is a
> different module with the first one, and then import the second 'index.py'
> automatically? Or it will use the already imported 'index.py' module?

By default it will use already imported index.py module. But you can use
the PythonInterpPerDirectory, in which case the two would run in separate
subinterpreters.

Grisha


From alain at onesite.org  Sun May 20 04:45:02 2001
From: alain at onesite.org (=?iso-8859-1?Q?Alain_T=E9sio?=)
Date: Fri Jan  9 21:46:18 2004
Subject: [mod_python] When trying to get cgi.FieldStorage() : AttributeError: 'sys' module has no attribute 'argv'
Message-ID: <001101c0e0d6$df62ef40$400110ac@alain>

Hi, I found a message in an archive saying I shouldn't use
FieldStorage with publisher
http://www.modpython.org/pipermail/mod_python/2001-January/001086.html
but I'm not using publisher (or I don't know I am)
Any idea what's happening ?

Thanks
Alain

=========== observer_www.py
import cgi
items=cgi.FieldStorage()

=========== output

Mod_python error: "PythonHandler observer_www"

Traceback (most recent call last):

  File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line
176, in Dispatch
    module = import_module(module_name, _req)

  File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line
340, in import_module
    module = imp.load_module(mname, f, p, d)

  File "/home/observer/scripts/observer_www.py", line 2, in ?
    items=cgi.FieldStorage()

  File "/usr/local/lib/python2.1/cgi.py", line 445, in __init__
    elif sys.argv[1:]:

AttributeError: 'sys' module has no attribute 'argv'



From grisha at modpython.org  Sun May 20 01:17:35 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:18 2004
Subject: [mod_python] When trying to get cgi.FieldStorage() : AttributeError:
 'sys' module has no attribute 'argv'
In-Reply-To: <001101c0e0d6$df62ef40$400110ac@alain>
Message-ID: <Pine.BSF.4.32.0105200111390.67081-100000@localhost>

This is because indeed the sys module has no attribute argv inside
subinterpreters. This is a "feature not a bug" and is documented somewhere
in the Python docs.

If you're using the cgi module, just fake the the argv by doing something
like:

import sys
sys.argv = []

then cgi module will be happy.

Grisha

On Sun, 20 May 2001, [iso-8859-1] Alain T?sio wrote:

> Hi, I found a message in an archive saying I shouldn't use
> FieldStorage with publisher
> http://www.modpython.org/pipermail/mod_python/2001-January/001086.html
> but I'm not using publisher (or I don't know I am)
> Any idea what's happening ?
>
> Thanks
> Alain
>
> =========== observer_www.py
> import cgi
> items=cgi.FieldStorage()
>
> =========== output
>
> Mod_python error: "PythonHandler observer_www"
>
> Traceback (most recent call last):
>
>   File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line
> 176, in Dispatch
>     module = import_module(module_name, _req)
>
>   File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line
> 340, in import_module
>     module = imp.load_module(mname, f, p, d)
>
>   File "/home/observer/scripts/observer_www.py", line 2, in ?
>     items=cgi.FieldStorage()
>
>   File "/usr/local/lib/python2.1/cgi.py", line 445, in __init__
>     elif sys.argv[1:]:
>
> AttributeError: 'sys' module has no attribute 'argv'
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From emailreklama at yahoo.com  Sun May 20 21:09:15 2001
From: emailreklama at yahoo.com (EmailReklama)
Date: Fri Jan  9 21:46:18 2004
Subject: [mod_python] E-MAIL 
Message-ID: <033300912171451SERVER@server>

????????? ???????? ????? ??????? ?? e-mail ?????:

?????? - 28000 ????? ??????.
?????? - 300000 ?? ??? 30% ???????????, 50% ?????????? ??????.

????????? ???????? 2 ??????? ??? ?? 1000 ?????.

??????????????? ?????.

From alain at onesite.org  Sun May 20 19:39:45 2001
From: alain at onesite.org (Alain Tesio)
Date: Fri Jan  9 21:46:18 2004
Subject: [mod_python] When trying to get cgi.FieldStorage() : AttributeError: 'sys' module has no attribute 'argv'
References: <Pine.BSF.4.32.0105200111390.67081-100000@localhost>
Message-ID: <004401c0e153$dccc8520$400110ac@alain>

Thanks for the information, but how can I get the GET parameters then ?
The usual cgi variables aren't in os.environ

Alain

----- Original Message -----
From: "Gregory (Grisha) Trubetskoy" <grisha@modpython.org>
To: "Alain Tesio" <alain@onesite.org>
Cc: "ML mod_python" <mod_python@modpython.org>
Sent: Sunday, May 20, 2001 7:17 AM
Subject: Re: [mod_python] When trying to get cgi.FieldStorage() :
AttributeError: 'sys' module has no attribute 'argv'


>
> This is because indeed the sys module has no attribute argv inside
> subinterpreters. This is a "feature not a bug" and is documented somewhere
> in the Python docs.
>
> If you're using the cgi module, just fake the the argv by doing something
> like:
>
> import sys
> sys.argv = []
>
> then cgi module will be happy.
>
> Grisha
>
> On Sun, 20 May 2001, [iso-8859-1] Alain T?sio wrote:
>
> > Hi, I found a message in an archive saying I shouldn't use
> > FieldStorage with publisher
> > http://www.modpython.org/pipermail/mod_python/2001-January/001086.html
> > but I'm not using publisher (or I don't know I am)
> > Any idea what's happening ?
> >
> > Thanks
> > Alain
> >
> > =========== observer_www.py
> > import cgi
> > items=cgi.FieldStorage()
> >
> > =========== output
> >
> > Mod_python error: "PythonHandler observer_www"
> >
> > Traceback (most recent call last):
> >
> >   File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py",
line
> > 176, in Dispatch
> >     module = import_module(module_name, _req)
> >
> >   File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py",
line
> > 340, in import_module
> >     module = imp.load_module(mname, f, p, d)
> >
> >   File "/home/observer/scripts/observer_www.py", line 2, in ?
> >     items=cgi.FieldStorage()
> >
> >   File "/usr/local/lib/python2.1/cgi.py", line 445, in __init__
> >     elif sys.argv[1:]:
> >
> > AttributeError: 'sys' module has no attribute 'argv'
> >
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://www.modpython.org/mailman/listinfo/mod_python
> >


From grisha at modpython.org  Sun May 20 20:22:20 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:18 2004
Subject: [mod_python] When trying to get cgi.FieldStorage() : AttributeError:
 'sys' module has no attribute 'argv'
In-Reply-To: <004401c0e153$dccc8520$400110ac@alain>
Message-ID: <Pine.BSF.4.32.0105202021500.75359-100000@localhost>

Try reading the manual:

http://www.modpython.org/live/mod_python-2.7.3/doc-html/pyapi-util-fstor.html

On Sun, 20 May 2001, Alain Tesio wrote:

> Thanks for the information, but how can I get the GET parameters then ?
> The usual cgi variables aren't in os.environ
>
> Alain
>
> ----- Original Message -----
> From: "Gregory (Grisha) Trubetskoy" <grisha@modpython.org>
> To: "Alain Tesio" <alain@onesite.org>
> Cc: "ML mod_python" <mod_python@modpython.org>
> Sent: Sunday, May 20, 2001 7:17 AM
> Subject: Re: [mod_python] When trying to get cgi.FieldStorage() :
> AttributeError: 'sys' module has no attribute 'argv'
>
>
> >
> > This is because indeed the sys module has no attribute argv inside
> > subinterpreters. This is a "feature not a bug" and is documented somewhere
> > in the Python docs.
> >
> > If you're using the cgi module, just fake the the argv by doing something
> > like:
> >
> > import sys
> > sys.argv = []
> >
> > then cgi module will be happy.
> >
> > Grisha
> >
> > On Sun, 20 May 2001, [iso-8859-1] Alain T?sio wrote:
> >
> > > Hi, I found a message in an archive saying I shouldn't use
> > > FieldStorage with publisher
> > > http://www.modpython.org/pipermail/mod_python/2001-January/001086.html
> > > but I'm not using publisher (or I don't know I am)
> > > Any idea what's happening ?
> > >
> > > Thanks
> > > Alain
> > >
> > > =========== observer_www.py
> > > import cgi
> > > items=cgi.FieldStorage()
> > >
> > > =========== output
> > >
> > > Mod_python error: "PythonHandler observer_www"
> > >
> > > Traceback (most recent call last):
> > >
> > >   File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py",
> line
> > > 176, in Dispatch
> > >     module = import_module(module_name, _req)
> > >
> > >   File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py",
> line
> > > 340, in import_module
> > >     module = imp.load_module(mname, f, p, d)
> > >
> > >   File "/home/observer/scripts/observer_www.py", line 2, in ?
> > >     items=cgi.FieldStorage()
> > >
> > >   File "/usr/local/lib/python2.1/cgi.py", line 445, in __init__
> > >     elif sys.argv[1:]:
> > >
> > > AttributeError: 'sys' module has no attribute 'argv'
> > >
> > >
> > > _______________________________________________
> > > Mod_python mailing list
> > > Mod_python@modpython.org
> > > http://www.modpython.org/mailman/listinfo/mod_python
> > >
>


From gdamjan at mail.net.mk  Tue May 22 01:32:22 2001
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 21:46:18 2004
Subject: [mod_python] mod_python and locale
In-Reply-To: <20010519045121.32984.qmail@web14306.mail.yahoo.com>; from teepwalla@yahoo.com on Fri, May 18, 2001 at 09:51:21PM -0700
References: <20010519045121.32984.qmail@web14306.mail.yahoo.com>
Message-ID: <20010522013222.A259@local.izmislen.mk>

> I've come across a problem with mod_python (2.7.2
> compiled with Python 2.0 --with-threads=no) on Linux
> (RH 7.0) regarding locale.
> 
> the following code (mptest.py):
> -----------------
> from mod_python import apache
> from locale import setlocale,LC_ALL,format
> 
> 
> def handler(req):
>     req.content_type = "text/plain"
>     req.send_http_header()
>     setlocale(LC_ALL,'')

This command set the locale to the one specified with the LC_xx or LANG
enviroment variables.

>     a = 123123231.323    
>     req.write("The formatted version of the number %s
> is %s" % (a,format('%.2f',a,1)))
>     return apache.OK
> 
> Produces:
> ----------------------
> The formatted version of the number 123123231.323 is
> 123123231.32
> 
> Rather than the expected
> -----------------------
> ....123,123,231.32

When you run your scripts interactively you have defined some locale by the
LC_xxx or the LANG variable. On the other side, it seems that your Apache 
process is using the default locale (C), so that's why the formating looks 
like that.

I would use -- setlocale(LC_ALL,'mk_MK') -- to get macedonian localization in
python scripts, but perhaps you would like to change this on a per user 
preference.



-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From teep at inet.co.th  Tue May 22 19:39:11 2001
From: teep at inet.co.th (Prateep Siamwalla)
Date: Fri Jan  9 21:46:19 2004
Subject: [mod_python] mod_python and locale
Message-ID: <002901c0e2bc$39d40860$0c05a8c0@taramansion.bangkok>

Yes!!! Thanks alot, Damjam....shame on me for not reading the docs on locale
more closely.

teep




From sam at webslingerZ.com  Tue May 22 09:55:58 2001
From: sam at webslingerZ.com (Sam Brauer)
Date: Fri Jan  9 21:46:19 2004
Subject: [mod_python] ANN: new release of maki
Message-ID: <Pine.LNX.4.31.0105220955150.1926-100000@localhost.localdomain>

I've released a new version of maki at http://maki.sourceforge.net

maki is a mod_python handler which uses various 4Suite components to serve
XML with Apache.  It allows a web developer to specify processing rules
based on path-matching regular expressions.  Each rule describes a
pipeline with any number of XSLT steps and/or custom processing steps.  A
processor that evaluates embedded Python source to dynamically modify the
document is included.  maki also supports time-based caching of output.
Also included are two example "logicsheets": one that adds HTTP request
data to the document and another that executes SQL queries and creates
elements from the results.

The overall functionality is similar (though intentionally not identical)
to Cocoon.

For more info, please take a look at the online documentation at
http://maki.sourceforge.net/manual/

Thank you,
Sam

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Sam Brauer : sbrauer@users.sourceforge.net



From dyeung at ust.hk  Wed May 23 15:14:05 2001
From: dyeung at ust.hk (David YEUNG)
Date: Fri Jan  9 21:46:19 2004
Subject: [mod_python] How to set the header 'Content-Disposition:'
Message-ID: <3B0B633D.AEBD803D@ust.hk>

I want to set the header 'Content-Disposition:' field. How can I do that
in the publisher handler.

Thanks

david

From pdeluca at sia.net.au  Thu May 24 21:13:07 2001
From: pdeluca at sia.net.au (Paul De Luca)
Date: Fri Jan  9 21:46:19 2004
Subject: [mod_python] mod python apache problem
Message-ID: <4.3.2.7.2.20010524211137.00acd710@mail.sia.net.au>

Hi,
      I am having some troubles trying to install mod_python onto my home 
PC running Windows ME (hey, its for testing purposes!). I followed the 
directions in the mod python documentation (changing the path when 
necessary). However when I try and start Apache I get the following error:

Syntax error on line 203 of c:/data/apache/conf/httpd.conf:
Cannot load c:/data/apache/modules/mod_python.dll into server: (1157) One 
of the
library files needed to run this application cannot be found:

I think this might have made a mistake at this step of the installation:
 >Move the files in the folder lib inside the mod_python folder (C:\Program
 >Files\Python\lib\mod_python-x\lib\mod_python) to the C:\Program
 >Files\Python\lib\mod_python folder. It's safe to delete these folders we 
just emptied.
but am unsure, as I am using a newer version of python and Apache than 
mentioned in the mod python documentation.

My Setup
Python 2.1  (C:\data\python2.1)
Apache 1.3.19 (C:\data\apache, root dir c:\data\apache\htdocs)
mod_python library files (C:\data\python2.1\Lib\mod_python)
mod_python.dll (C:\data\apache\modules\mod_python.dll)

My Apache httpd.conf


#
# Based upon the NCSA server configuration files originally by Rob McCool.
#
# This is the main Apache server configuration file.  It contains the
# configuration directives that give the server its instructions.
# See <URL:http://www.apache.org/docs/> for detailed information about
# the directives.
#
# Do NOT simply read the instructions in here without understanding
# what they do.  They're here only as hints or reminders.  If you are unsure
# consult the online docs. You have been warned.
#
# After this file is processed, the server will look for and process
# C:/data/apache/conf/srm.conf and then C:/data/apache/conf/access.conf
# unless you have overridden these with ResourceConfig and/or
# AccessConfig directives here.
#
# The configuration directives are grouped into three basic sections:
#  1. Directives that control the operation of the Apache server process as a
#     whole (the 'global environment').
#  2. Directives that define the parameters of the 'main' or 'default' server,
#     which responds to requests that aren't handled by a virtual host.
#     These directives also provide default values for the settings
#     of all virtual hosts.
#  3. Settings for virtual hosts, which allow Web requests to be sent to
#     different IP addresses or hostnames and have them handled by the
#     same Apache server process.
#
# Configuration and logfile names: If the filenames you specify for many
# of the server's control files begin with "/" (or "drive:/" for Win32), the
# server will use that explicit path.  If the filenames do *not* begin
# with "/", the value of ServerRoot is prepended -- so "logs/foo.log"
# with ServerRoot set to "/usr/local/apache" will be interpreted by the
# server as "/usr/local/apache/logs/foo.log".
#
# NOTE: Where filenames are specified, you must use forward slashes
# instead of backslashes (e.g., "c:/apache" instead of "c:\apache").
# If a drive letter is omitted, the drive on which Apache.exe is located
# will be used by default.  It is recommended that you always supply
# an explicit drive letter in absolute paths, however, to avoid
# confusion.
#

### Section 1: Global Environment
#
# The directives in this section affect the overall operation of Apache,
# such as the number of concurrent requests it can handle or where it
# can find its configuration files.
#

#
# ServerType is either inetd, or standalone.  Inetd mode is only supported on
# Unix platforms.
#
ServerType standalone

#
# ServerRoot: The top of the directory tree under which the server's
# configuration, error, and log files are kept.
#
ServerRoot "C:/data/apache"

#
# PidFile: The file in which the server should record its process
# identification number when it starts.
#
PidFile logs/httpd.pid

#
# ScoreBoardFile: File used to store internal server process information.
# Not all architectures require this.  But if yours does (you'll know because
# this file will be  created when you run Apache) then you *must* ensure that
# no two invocations of Apache share the same scoreboard file.
#
ScoreBoardFile logs/apache_runtime_status

#
# In the standard configuration, the server will process httpd.conf (this
# file, specified by the -f command line option), srm.conf, and access.conf
# in that order.  The latter two files are now distributed empty, as it is
# recommended that all directives be kept in a single file for simplicity.
# The commented-out values below are the built-in defaults.  You can have the
# server ignore these files altogether by using "/dev/null" (for Unix) or
# "nul" (for Win32) for the arguments to the directives.
#
#ResourceConfig conf/srm.conf
#AccessConfig conf/access.conf

#
# Timeout: The number of seconds before receives and sends time out.
#
Timeout 300

#
# KeepAlive: Whether or not to allow persistent connections (more than
# one request per connection). Set to "Off" to deactivate.
#
KeepAlive On

#
# MaxKeepAliveRequests: The maximum number of requests to allow
# during a persistent connection. Set to 0 to allow an unlimited amount.
# We recommend you leave this number high, for maximum performance.
#
MaxKeepAliveRequests 100

#
# KeepAliveTimeout: Number of seconds to wait for the next request from the
# same client on the same connection.
#
KeepAliveTimeout 15

#
# Apache on Win32 always creates one child process to handle requests.  If it
# dies, another child process is created automatically.  Within the child
# process multiple threads handle incoming requests.  The next two
# directives control the behaviour of the threads and processes.
#

#
# MaxRequestsPerChild: the number of requests each child process is
# allowed to process before the child dies.  The child will exit so
# as to avoid problems after prolonged use when Apache (and maybe the
# libraries it uses) leak memory or other resources.  On most systems, this
# isn't really needed, but a few (such as Solaris) do have notable leaks
# in the libraries.  For Win32, set this value to zero (unlimited)
# unless advised otherwise.
#
# NOTE: This value does not include keepalive requests after the initial
#       request per connection. For example, if a child process handles
#       an initial request and 10 subsequent "keptalive" requests, it
#       would only count as 1 request towards this limit.
#
MaxRequestsPerChild 0

#
# Number of concurrent threads (i.e., requests) the server will allow.
# Set this value according to the responsiveness of the server (more
# requests active at once means they're all handled more slowly) and
# the amount of system resources you'll allow the server to consume.
#
ThreadsPerChild 50

#
# Listen: Allows you to bind Apache to specific IP addresses and/or
# ports, in addition to the default. See also the <VirtualHost>
# directive.
#
#Listen 3000
#Listen 12.34.56.78:80

#
# BindAddress: You can support virtual hosts with this option. This directive
# is used to tell the server which IP address to listen to. It can either
# contain "*", an IP address, or a fully qualified Internet domain name.
# See also the <VirtualHost> and Listen directives.
#
#BindAddress *

#
# Apache Modules compiled into the standard Windows build
#
# The following modules are bound into the standard Apache binary distribution
# for Windows.  To change the standard behavior, uncomment the following lines
# and modify the list of those specific modules to be enabled in the server.
#
# WARNING: This is an advanced option that may render your server inoperable!
# Do not use these directives without expert guidance.
#
#ClearModuleList
#AddModule mod_so.c mod_mime.c mod_access.c mod_auth.c mod_negotiation.c
#AddModule mod_include.c mod_autoindex.c mod_dir.c mod_cgi.c mod_userdir.c
#AddModule mod_alias.c mod_env.c mod_log_config.c mod_asis.c mod_imap.c
#AddModule mod_actions.c mod_setenvif.c mod_isapi.c

#
# Dynamic Shared Object (DSO) Support
#
# To be able to use the functionality of a module which was built as a DSO you
# have to place corresponding `LoadModule' lines at this location so the
# directives contained in it are actually available _before_ they are used.
# Please read the file README.DSO in the Apache 1.3 distribution for more
# details about the DSO mechanism and run `apache -l' for the list of already
# built-in (statically linked and thus always available) modules in your Apache
# binary.
#
# Note: The order in which modules are loaded is important.  Don't change
# the order below without expert advice.
#
#LoadModule anon_auth_module modules/mod_auth_anon.so
#LoadModule dbm_auth_module modules/mod_auth_dbm.so
#LoadModule digest_auth_module modules/mod_auth_digest.so
#LoadModule cern_meta_module modules/mod_cern_meta.so
#LoadModule digest_module modules/mod_digest.so
#LoadModule expires_module modules/mod_expires.so
#LoadModule headers_module modules/mod_headers.so
#LoadModule proxy_module modules/mod_proxy.so
#LoadModule rewrite_module modules/mod_rewrite.so
#LoadModule speling_module modules/mod_speling.so
#LoadModule info_module modules/mod_info.so
#LoadModule status_module modules/mod_status.so
#LoadModule usertrack_module modules/mod_usertrack.so
LoadModule python_module modules/mod_python.dll

#
# ExtendedStatus controls whether Apache will generate "full" status
# information (ExtendedStatus On) or just basic information (ExtendedStatus
# Off) when the "server-status" handler is called. The default is Off.
#
#ExtendedStatus On

### Section 2: 'Main' server configuration
#
# The directives in this section set up the values used by the 'main'
# server, which responds to any requests that aren't handled by a
# <VirtualHost> definition.  These values also provide defaults for
# any <VirtualHost> containers you may define later in the file.
#
# All of these directives may appear inside <VirtualHost> containers,
# in which case these default settings will be overridden for the
# virtual host being defined.
#

#
# Port: The port to which the standalone server listens.  Certain firewall
# products must be configured before Apache can listen to a specific port.
# Other running httpd servers will also interfere with this port.  Disable
# all firewall, security, and other services if you encounter problems.
# To help diagnose problems use the Windows NT command NETSTAT -a
#
Port 80

#
# ServerAdmin: Your address, where problems with the server should be
# e-mailed.  This address appears on some server-generated pages, such
# as error documents.
#
ServerAdmin pdeluca@sia.net.au

#
# ServerName allows you to set a host name which is sent back to clients for
# your server if it's different than the one the program would get (i.e., use
# "www" instead of the host's real name).
#
# Note: You cannot just invent host names and hope they work. The name you
# define here must be a valid DNS name for your host. If you don't understand
# this, ask your network administrator.
# If your host doesn't have a registered DNS name, enter its IP address here.
# You will have to access it by its address (e.g., http://123.45.67.89/)
# anyway, and this will make redirections work in a sensible way.
#
# 127.0.0.1 is the TCP/IP local loop-back address, often named localhost. Your
# machine always knows itself by this address. If you use Apache strictly for
# local testing and development, you may use 127.0.0.1 as the server name.
#
ServerName localhost


#
# DocumentRoot: The directory out of which you will serve your
# documents. By default, all requests are taken from this directory, but
# symbolic links and aliases may be used to point to other locations.
#
DocumentRoot "C:/data/apache/htdocs"

#
# Each directory to which Apache has access, can be configured with respect
# to which services and features are allowed and/or disabled in that
# directory (and its subdirectories).
#
# First, we configure the "default" to be a very restrictive set of
# permissions.
#
<Directory />
     Options FollowSymLinks
     AllowOverride None
</Directory>

#
# Note that from this point forward you must specifically allow
# particular features to be enabled - so if something's not working as
# you might expect, make sure that you have specifically enabled it
# below.
#

#
# This should be changed to whatever you set DocumentRoot to.
#
<Directory "C:/data/apache/htdocs">

#
# This may also be "None", "All", or any combination of "Indexes",
# "Includes", "FollowSymLinks", "ExecCGI", or "MultiViews".
#
# Note that "MultiViews" must be named *explicitly* --- "Options All"
# doesn't give it to you.
#
     Options Indexes FollowSymLinks MultiViews

#
# This controls which options the .htaccess files in directories can
# override. Can also be "All", or any combination of "Options", "FileInfo",
# "AuthConfig", and "Limit"
#
     AllowOverride None

#
# Controls who can get stuff from this server.
#
     Order allow,deny
     Allow from all
</Directory>

#
# UserDir: The name of the directory which is appended onto a user's home
# directory if a ~user request is received.
#
# Under Win32, we do not currently try to determine the home directory of
# a Windows login, so a format such as that below needs to be used.  See
# the UserDir documentation for details.
#
<IfModule mod_userdir.c>
     UserDir "C:/data/apache/users/"
</IfModule>

#
# Control access to UserDir directories.  The following is an example
# for a site where these directories are restricted to read-only.
#
#<Directory "C:/data/apache/users">
#    AllowOverride FileInfo AuthConfig Limit
#    Options MultiViews Indexes SymLinksIfOwnerMatch IncludesNoExec
#    <Limit GET POST OPTIONS PROPFIND>
#        Order allow,deny
#        Allow from all
#    </Limit>
#    <LimitExcept GET POST OPTIONS PROPFIND>
#        Order deny,allow
#        Deny from all
#    </LimitExcept>
#</Directory>

#
# DirectoryIndex: Name of the file or files to use as a pre-written HTML
# directory index.  Separate multiple entries with spaces.
#
<IfModule mod_dir.c>
     DirectoryIndex index.html
</IfModule>

#
# AccessFileName: The name of the file to look for in each directory
# for access control information.
#
AccessFileName .htaccess

#
# The following lines prevent .htaccess files from being viewed by
# Web clients.  Since .htaccess files often contain authorization
# information, access is disallowed for security reasons.  Comment
# these lines out if you want Web visitors to see the contents of
# .htaccess files.  If you change the AccessFileName directive above,
# be sure to make the corresponding changes here.
#
# Also, folks tend to use names such as .htpasswd for password
# files, so this will protect those as well.
#
<Files ~ "^\.ht">
     Order allow,deny
     Deny from all
</Files>

#
# CacheNegotiatedDocs: By default, Apache sends "Pragma: no-cache" with each
# document that was negotiated on the basis of content. This asks proxy
# servers not to cache the document. Uncommenting the following line disables
# this behavior, and proxies will be allowed to cache the documents.
#
#CacheNegotiatedDocs

#
# UseCanonicalName:  (new for 1.3)  With this setting turned on, whenever
# Apache needs to construct a self-referencing URL (a URL that refers back
# to the server the response is coming from) it will use ServerName and
# Port to form a "canonical" name.  With this setting off, Apache will
# use the hostname:port that the client supplied, when possible.  This
# also affects SERVER_NAME and SERVER_PORT in CGI scripts.
#
UseCanonicalName On

#
# TypesConfig describes where the mime.types file (or equivalent) is
# to be found.
#
<IfModule mod_mime.c>
     TypesConfig conf/mime.types
</IfModule>

#
# DefaultType is the default MIME type the server will use for a document
# if it cannot otherwise determine one, such as from filename extensions.
# If your server contains mostly text or HTML documents, "text/plain" is
# a good value.  If most of your content is binary, such as applications
# or images, you may want to use "application/octet-stream" instead to
# keep browsers from trying to display binary files as though they are
# text.
#
DefaultType text/plain

#
# The mod_mime_magic module allows the server to use various hints from the
# contents of the file itself to determine its type.  The MIMEMagicFile
# directive tells the module where the hint definitions are located.
# mod_mime_magic is not part of the default server (you have to add
# it yourself with a LoadModule [see the DSO paragraph in the 'Global
# Environment' section], or recompile the server and include mod_mime_magic
# as part of the configuration), so it's enclosed in an <IfModule> container.
# This means that the MIMEMagicFile directive will only be processed if the
# module is part of the server.
#
<IfModule mod_mime_magic.c>
     MIMEMagicFile conf/magic
</IfModule>

#
# HostnameLookups: Log the names of clients or just their IP addresses
# e.g., www.apache.org (on) or 204.62.129.132 (off).
# The default is off because it'd be overall better for the net if people
# had to knowingly turn this feature on, since enabling it means that
# each client request will result in AT LEAST one lookup request to the
# nameserver.
#
HostnameLookups Off

#
# ErrorLog: The location of the error log file.
# If you do not specify an ErrorLog directive within a <VirtualHost>
# container, error messages relating to that virtual host will be
# logged here.  If you *do* define an error logfile for a <VirtualHost>
# container, that host's errors will be logged there and not here.
#
ErrorLog logs/error.log

#
# LogLevel: Control the number of messages logged to the error.log.
# Possible values include: debug, info, notice, warn, error, crit,
# alert, emerg.
#
LogLevel warn

#
# The following directives define some format nicknames for use with
# a CustomLog directive (see below).
#
LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\"" 
combined
LogFormat "%h %l %u %t \"%r\" %>s %b" common
LogFormat "%{Referer}i -> %U" referer
LogFormat "%{User-agent}i" agent

#
# The location and format of the access logfile (Common Logfile Format).
# If you do not define any access logfiles within a <VirtualHost>
# container, they will be logged here.  Contrariwise, if you *do*
# define per-<VirtualHost> access logfiles, transactions will be
# logged therein and *not* in this file.
#
CustomLog logs/access.log common

#
# If you would like to have agent and referer logfiles, uncomment the
# following directives.
#
#CustomLog logs/referer.log referer
#CustomLog logs/agent.log agent

#
# If you prefer a single logfile with access, agent, and referer information
# (Combined Logfile Format) you can use the following directive.
#
#CustomLog logs/access.log combined

#
# Optionally add a line containing the server version and virtual host
# name to server-generated pages (error documents, FTP directory listings,
# mod_status and mod_info output etc., but not CGI generated documents).
# Set to "EMail" to also include a mailto: link to the ServerAdmin.
# Set to one of:  On | Off | EMail
#
ServerSignature On

#
# Apache parses all CGI scripts for the shebang line by default.
# This comment line, the first line of the script, consists of the symbols
# pound (#) and exclamation (!) followed by the path of the program that
# can execute this specific script.  For a perl script, with perl.exe in
# the C:\Program Files\Perl directory, the shebang line should be:

    #!c:/program files/perl/perl

# Note you _must_not_ indent the actual shebang line, and it must be the
# first line of the file.  Of course, CGI processing must be enabled by
# the appropriate ScriptAlias or Options ExecCGI directives for the files
# or directory in question.
#
# However, Apache on Windows allows either the Unix behavior above, or can
# use the Registry to match files by extention.  The command to execute
# a file of this type is retrieved from the registry by the same method as
# the Windows Explorer would use to handle double-clicking on a file.
# These script actions can be configured from the Windows Explorer View menu,
# 'Folder Options', and reviewing the 'File Types' tab.  Clicking the Edit
# button allows you to modify the Actions, of which Apache 1.3 attempts to
# perform the 'Open' Action, and failing that it will try the shebang line.
# This behavior is subject to change in Apache release 2.0.
#
# Each mechanism has it's own specific security weaknesses, from the means
# to run a program you didn't intend the website owner to invoke, and the
# best method is a matter of great debate.
#
# To enable the this Windows specific behavior (and therefore -disable- the
# equivilant Unix behavior), uncomment the following directive:
#
#ScriptInterpreterSource registry
#
# The directive above can be placed in individual <Directory> blocks or the
# .htaccess file, with either the 'registry' (Windows behavior) or 'script'
# (Unix behavior) option, and will override this server default option.
#

#
# Aliases: Add here as many aliases as you need (with no limit). The format is
# Alias fakename realname
#
<IfModule mod_alias.c>

     #
     # Note that if you include a trailing / on fakename then the server will
     # require it to be present in the URL.  So "/icons" isn't aliased in this
     # example, only "/icons/"..
     #
     Alias /icons/ "C:/data/apache/icons/"

     <Directory "C:/data/apache/icons">
         Options Indexes MultiViews
         AllowOverride None
         Order allow,deny
         Allow from all
     </Directory>

     #
     # ScriptAlias: This controls which directories contain server scripts.
     # ScriptAliases are essentially the same as Aliases, except that
     # documents in the realname directory are treated as applications and
     # run by the server when requested rather than as documents sent to 
the client.
     # The same rules about trailing "/" apply to ScriptAlias directives as to
     # Alias.
     #
     ScriptAlias /cgi-bin/ "C:/data/apache/cgi-bin/"

     #
     # "C:/data/apache/cgi-bin" should be changed to whatever your 
ScriptAliased
     # CGI directory exists, if you have that configured.
     #
     <Directory "C:/data/apache/cgi-bin">
         AllowOverride None
         Options None
         Order allow,deny
         Allow from all
     </Directory>

     <Directory "c:/data/apache/htdocs/python">
     	AddHandler python-program .py
     	PythonHandler test
     	PythonDebug on
     </Directory>

</IfModule>
# End of aliases.

#
# Redirect allows you to tell clients about documents which used to exist in
# your server's namespace, but do not anymore. This allows you to tell the
# clients where to look for the relocated document.
# Format: Redirect old-URI new-URL
#

#
# Directives controlling the display of server-generated directory listings.
#
<IfModule mod_autoindex.c>

     #
     # FancyIndexing is whether you want fancy directory indexing or standard
     #
     # Note, add the option TrackModified to the IndexOptions default list only
     # if all indexed directories reside on NTFS volumes.  The 
TrackModified flag
     # will report the Last-Modified date to assist caches and proxies to 
properly
     # track directory changes, but it does _not_ work on FAT volumes.
     #
     IndexOptions FancyIndexing

     #
     # AddIcon* directives tell the server which icon to show for different
     # files or filename extensions.  These are only displayed for
     # FancyIndexed directories.
     #
     AddIconByEncoding (CMP,/icons/compressed.gif) x-compress x-gzip

     AddIconByType (TXT,/icons/text.gif) text/*
     AddIconByType (IMG,/icons/image2.gif) image/*
     AddIconByType (SND,/icons/sound2.gif) audio/*
     AddIconByType (VID,/icons/movie.gif) video/*

     AddIcon /icons/binary.gif .bin .exe
     AddIcon /icons/binhex.gif .hqx
     AddIcon /icons/tar.gif .tar
     AddIcon /icons/world2.gif .wrl .wrl.gz .vrml .vrm .iv
     AddIcon /icons/compressed.gif .Z .z .tgz .gz .zip
     AddIcon /icons/a.gif .ps .ai .eps
     AddIcon /icons/layout.gif .html .shtml .htm .pdf
     AddIcon /icons/text.gif .txt
     AddIcon /icons/c.gif .c
     AddIcon /icons/p.gif .pl .py
     AddIcon /icons/f.gif .for
     AddIcon /icons/dvi.gif .dvi
     AddIcon /icons/uuencoded.gif .uu
     AddIcon /icons/script.gif .conf .sh .shar .csh .ksh .tcl
     AddIcon /icons/tex.gif .tex
     AddIcon /icons/bomb.gif core

     AddIcon /icons/back.gif ..
     AddIcon /icons/hand.right.gif README
     AddIcon /icons/folder.gif ^^DIRECTORY^^
     AddIcon /icons/blank.gif ^^BLANKICON^^

     #
     # DefaultIcon is which icon to show for files which do not have an icon
     # explicitly set.
     #
     DefaultIcon /icons/unknown.gif

     #
     # AddDescription allows you to place a short description after a file in
     # server-generated indexes.  These are only displayed for FancyIndexed
     # directories.
     # Format: AddDescription "description" filename
     #
     #AddDescription "GZIP compressed document" .gz
     #AddDescription "tar archive" .tar
     #AddDescription "GZIP compressed tar archive" .tgz

     #
     # ReadmeName is the name of the README file the server will look for by
     # default, and append to directory listings.
     #
     # HeaderName is the name of a file which should be prepended to
     # directory indexes.
     #
     # If MultiViews are amongst the Options in effect, the server will
     # first look for name.html and include it if found.  If name.html
     # doesn't exist, the server will then look for name.txt and include
     # it as plaintext if found.
     #
     ReadmeName README
     HeaderName HEADER

     #
     # IndexIgnore is a set of filenames which directory indexing should ignore
     # and not include in the listing.  Shell-style wildcarding is permitted.
     #
     IndexIgnore .??* *~ *# HEADER* README* RCS CVS *,v *,t

</IfModule>
# End of indexing directives.

#
# Document types.
#
<IfModule mod_mime.c>

     #
     # AddEncoding allows you to have certain browsers (Mosaic/X 2.1+) 
uncompress
     # information on the fly. Note: Not all browsers support this.
     # Despite the name similarity, the following Add* directives have nothing
     # to do with the FancyIndexing customization directives above.
     #
     AddEncoding x-compress Z
     AddEncoding x-gzip gz tgz
     #
     # AddLanguage allows you to specify the language of a document. You can
     # then use content negotiation to give a browser a file in a language
     # it can understand.
     #
     # Note 1: The suffix does not have to be the same as the language
     # keyword --- those with documents in Polish (whose net-standard
     # language code is pl) may wish to use "AddLanguage pl .po" to
     # avoid the ambiguity with the common suffix for perl scripts.
     #
     # Note 2: The example entries below illustrate that in quite
     # some cases the two character 'Language' abbreviation is not
     # identical to the two character 'Country' code for its country,
     # E.g. 'Danmark/dk' versus 'Danish/da'.
     #
     # Note 3: In the case of 'ltz' we violate the RFC by using a three char
     # specifier. But there is 'work in progress' to fix this and get
     # the reference data for rfc1766 cleaned up.
     #
     # Danish (da) - Dutch (nl) - English (en) - Estonian (ee)
     # French (fr) - German (de) - Greek-Modern (el)
     # Italian (it) - Korean (kr) - Norwegian (no)
     # Portugese (pt) - Luxembourgeois* (ltz)
     # Spanish (es) - Swedish (sv) - Catalan (ca) - Czech(cz)
     # Polish (pl) - Brazilian Portuguese (pt-br) - Japanese (ja)
     # Russian (ru)
     #
     AddLanguage da .dk
     AddLanguage nl .nl
     AddLanguage en .en
     AddLanguage et .ee
     AddLanguage fr .fr
     AddLanguage de .de
     AddLanguage el .el
     AddLanguage he .he
     AddCharset ISO-8859-8 .iso8859-8
     AddLanguage it .it
     AddLanguage ja .ja
     AddCharset ISO-2022-JP .jis
     AddLanguage kr .kr
     AddCharset ISO-2022-KR .iso-kr
     AddLanguage no .no
     AddLanguage pl .po
     AddCharset ISO-8859-2 .iso-pl
     AddLanguage pt .pt
     AddLanguage pt-br .pt-br
     AddLanguage ltz .lu
     AddLanguage ca .ca
     AddLanguage es .es
     AddLanguage sv .se
     AddLanguage cz .cz
     AddLanguage ru .ru
     AddLanguage tw .tw
     AddLanguage zh-tw .tw
     AddCharset Big5         .Big5    .big5
     AddCharset WINDOWS-1251 .cp-1251
     AddCharset CP866        .cp866
     AddCharset ISO-8859-5   .iso-ru
     AddCharset KOI8-R       .koi8-r
     AddCharset UCS-2        .ucs2
     AddCharset UCS-4        .ucs4
     AddCharset UTF-8        .utf8

     # LanguagePriority allows you to give precedence to some languages
     # in case of a tie during content negotiation.
     #
     # Just list the languages in decreasing order of preference. We have
     # more or less alphabetized them here. You probably want to change this.
     #
     <IfModule mod_negotiation.c>
         LanguagePriority en da nl et fr de el it ja kr no pl pt pt-br ru 
ltz ca es sv tw
     </IfModule>

     #
     # AddType allows you to tweak mime.types without actually editing it, 
or to
     # make certain files to be certain types.
     #
     # For example, the PHP 3.x module (not part of the Apache distribution 
- see
     # http://www.php.net) will typically use:
     #
     #AddType application/x-httpd-php3 .php3
     #AddType application/x-httpd-php3-source .phps
     #
     # And for PHP 4.x, use:
     #
     #AddType application/x-httpd-php .php
     #AddType application/x-httpd-php-source .phps

     AddType application/x-tar .tgz

     #
     # AddHandler allows you to map certain file extensions to "handlers",
     # actions unrelated to filetype. These can be either built into the server
     # or added with the Action command (see below)
     #
     # If you want to use server side includes, or CGI outside
     # ScriptAliased directories, uncomment the following lines.
     #
     # To use CGI scripts:
     #
     #AddHandler cgi-script .cgi

     #
     # To use server-parsed HTML files
     #
     #AddType text/html .shtml
     #AddHandler server-parsed .shtml

     #
     # Uncomment the following line to enable Apache's send-asis HTTP file
     # feature
     #
     #AddHandler send-as-is asis

     #
     # If you wish to use server-parsed imagemap files, use
     #
     #AddHandler imap-file map

     #
     # To enable type maps, you might want to use
     #
     #AddHandler type-map var

</IfModule>
# End of document types.

#
# Action lets you define media types that will execute a script whenever
# a matching file is called. This eliminates the need for repeated URL
# pathnames for oft-used CGI file processors.
# Format: Action media/type /cgi-script/location
# Format: Action handler-name /cgi-script/location
#

#
# MetaDir: specifies the name of the directory in which Apache can find
# meta information files. These files contain additional HTTP headers
# to include when sending the document
#
#MetaDir .web

#
# MetaSuffix: specifies the file name suffix for the file containing the
# meta information.
#
#MetaSuffix .meta

#
# Customizable error response (Apache style)
#  these come in three flavors
#
#    1) plain text
#ErrorDocument 500 "The server made a boo boo.
#  n.b.  the single leading (") marks it as text, it does not get output
#
#    2) local redirects
#ErrorDocument 404 /missing.html
#  to redirect to local URL /missing.html
#ErrorDocument 404 /cgi-bin/missing_handler.pl
#  N.B.: You can redirect to a script or a document using server-side-includes.
#
#    3) external redirects
#ErrorDocument 402 http://some.other_server.com/subscription_info.html
#  N.B.: Many of the environment variables associated with the original
#  request will *not* be available to such a script.

#
# Customize behaviour based on the browser
#
<IfModule mod_setenvif.c>

     #
     # The following directives modify normal HTTP response behavior.
     # The first directive disables keepalive for Netscape 2.x and browsers 
that
     # spoof it. There are known problems with these browser implementations.
     # The second directive is for Microsoft Internet Explorer 4.0b2
     # which has a broken HTTP/1.1 implementation and does not properly
     # support keepalive when it is used on 301 or 302 (redirect) responses.
     #
     BrowserMatch "Mozilla/2" nokeepalive
     BrowserMatch "MSIE 4\.0b2;" nokeepalive downgrade-1.0 force-response-1.0

     #
     # The following directive disables HTTP/1.1 responses to browsers which
     # are in violation of the HTTP/1.0 spec by not being able to grok a
     # basic 1.1 response.
     #
     BrowserMatch "RealPlayer 4\.0" force-response-1.0
     BrowserMatch "Java/1\.0" force-response-1.0
     BrowserMatch "JDK/1\.0" force-response-1.0

</IfModule>
# End of browser customization directives

#
# Allow server status reports, with the URL of http://servername/server-status
# Change the ".localhost" to match your domain to enable.
#
#<Location /server-status>
#    SetHandler server-status
#    Order deny,allow
#    Deny from all
#    Allow from .localhost
#</Location>

#
# Allow remote server configuration reports, with the URL of
# http://servername/server-info (requires that mod_info.c be loaded).
# Change the ".localhost" to match your domain to enable.
#
#<Location /server-info>
#    SetHandler server-info
#    Order deny,allow
#    Deny from all
#    Allow from .localhost
#</Location>

#
# There have been reports of people trying to abuse an old bug from pre-1.1
# days.  This bug involved a CGI script distributed as a part of Apache.
# By uncommenting these lines you can redirect these attacks to a logging
# script on phf.apache.org.  Or, you can record them yourself, using the script
# support/phf_abuse_log.cgi.
#
#<Location /cgi-bin/phf*>
#    Deny from all
#    ErrorDocument 403 http://phf.apache.org/phf_abuse_log.cgi
#</Location>

#
# Proxy Server directives. Uncomment the following lines to
# enable the proxy server:
#
#<IfModule mod_proxy.c>
#    ProxyRequests On

#    <Directory proxy:*>
#        Order deny,allow
#        Deny from all
#        Allow from .localhost
#    </Directory>

     #
     # Enable/disable the handling of HTTP/1.1 "Via:" headers.
     # ("Full" adds the server version; "Block" removes all outgoing Via: 
headers)
     # Set to one of: Off | On | Full | Block
     #
#    ProxyVia On

     #
     # To enable the cache as well, edit and uncomment the following lines:
     # (no cacheing without CacheRoot)
     #
#    CacheRoot "C:/data/apache/proxy"
#    CacheSize 5
#    CacheGcInterval 4
#    CacheMaxExpire 24
#    CacheLastModifiedFactor 0.1
#    CacheDefaultExpire 1
#    NoCache a_domain.com another_domain.edu joes.garage_sale.com

#</IfModule>
# End of proxy directives.

### Section 3: Virtual Hosts
#
# VirtualHost: If you want to maintain multiple domains/hostnames on your
# machine you can setup VirtualHost containers for them. Most configurations
# use only name-based virtual hosts so the server doesn't need to worry about
# IP addresses. This is indicated by the asterisks in the directives below.
#
# Please see the documentation at <URL:http://www.apache.org/docs/vhosts/>
# for further details before you try to setup virtual hosts.
#
# You may use the command line option '-S' to verify your virtual host
# configuration.

#
# Use name-based virtual hosting.
#
#NameVirtualHost *

#
# VirtualHost example:
# Almost any Apache directive may go into a VirtualHost container.
# The first VirtualHost section is used for requests without a known
# server name.
#
#<VirtualHost *>
#    ServerAdmin webmaster@dummy-host.example.com
#    DocumentRoot /www/docs/dummy-host.example.com
#    ServerName dummy-host.example.com
#    ErrorLog logs/dummy-host.example.com-error_log
#    CustomLog logs/dummy-host.example.com-access_log common
#</VirtualHost>



Apologies for the size of this email, I just need to get this problem 
sorted ASAP. Any help will be greatly appreciated.








-------------------------------------------
Paul De Luca
Email: pdeluca@sia.net.au
Ph: 0414 225561
-------------------------------------------


From grisha at modpython.org  Thu May 24 09:44:54 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:19 2004
Subject: [mod_python] mod python apache problem
In-Reply-To: <4.3.2.7.2.20010524211137.00acd710@mail.sia.net.au>
Message-ID: <Pine.BSF.4.32.0105240943370.30008-100000@localhost>

Most likely this is because the DLL, which was compiled for Windows NT
will not work on ME, because ME doesn't have some libraries that NT has.
But I'm not a Windows expert, this is just a guess.

Grisha

On Thu, 24 May 2001, Paul De Luca wrote:

> Hi,
>       I am having some troubles trying to install mod_python onto my home
> PC running Windows ME (hey, its for testing purposes!). I followed the
> directions in the mod python documentation (changing the path when
> necessary). However when I try and start Apache I get the following error:
>
> Syntax error on line 203 of c:/data/apache/conf/httpd.conf:
> Cannot load c:/data/apache/modules/mod_python.dll into server: (1157) One
> of the
> library files needed to run this application cannot be found:
>
> I think this might have made a mistake at this step of the installation:
>  >Move the files in the folder lib inside the mod_python folder (C:\Program
>  >Files\Python\lib\mod_python-x\lib\mod_python) to the C:\Program
>  >Files\Python\lib\mod_python folder. It's safe to delete these folders we
> just emptied.
> but am unsure, as I am using a newer version of python and Apache than
> mentioned in the mod python documentation.
>
> My Setup
> Python 2.1  (C:\data\python2.1)
> Apache 1.3.19 (C:\data\apache, root dir c:\data\apache\htdocs)
> mod_python library files (C:\data\python2.1\Lib\mod_python)
> mod_python.dll (C:\data\apache\modules\mod_python.dll)
>
> My Apache httpd.conf
>
>
> #
> # Based upon the NCSA server configuration files originally by Rob McCool.
> #
> # This is the main Apache server configuration file.  It contains the
> # configuration directives that give the server its instructions.
> # See <URL:http://www.apache.org/docs/> for detailed information about
> # the directives.
> #
> # Do NOT simply read the instructions in here without understanding
> # what they do.  They're here only as hints or reminders.  If you are unsure
> # consult the online docs. You have been warned.
> #
> # After this file is processed, the server will look for and process
> # C:/data/apache/conf/srm.conf and then C:/data/apache/conf/access.conf
> # unless you have overridden these with ResourceConfig and/or
> # AccessConfig directives here.
> #
> # The configuration directives are grouped into three basic sections:
> #  1. Directives that control the operation of the Apache server process as a
> #     whole (the 'global environment').
> #  2. Directives that define the parameters of the 'main' or 'default' server,
> #     which responds to requests that aren't handled by a virtual host.
> #     These directives also provide default values for the settings
> #     of all virtual hosts.
> #  3. Settings for virtual hosts, which allow Web requests to be sent to
> #     different IP addresses or hostnames and have them handled by the
> #     same Apache server process.
> #
> # Configuration and logfile names: If the filenames you specify for many
> # of the server's control files begin with "/" (or "drive:/" for Win32), the
> # server will use that explicit path.  If the filenames do *not* begin
> # with "/", the value of ServerRoot is prepended -- so "logs/foo.log"
> # with ServerRoot set to "/usr/local/apache" will be interpreted by the
> # server as "/usr/local/apache/logs/foo.log".
> #
> # NOTE: Where filenames are specified, you must use forward slashes
> # instead of backslashes (e.g., "c:/apache" instead of "c:\apache").
> # If a drive letter is omitted, the drive on which Apache.exe is located
> # will be used by default.  It is recommended that you always supply
> # an explicit drive letter in absolute paths, however, to avoid
> # confusion.
> #
>
> ### Section 1: Global Environment
> #
> # The directives in this section affect the overall operation of Apache,
> # such as the number of concurrent requests it can handle or where it
> # can find its configuration files.
> #
>
> #
> # ServerType is either inetd, or standalone.  Inetd mode is only supported on
> # Unix platforms.
> #
> ServerType standalone
>
> #
> # ServerRoot: The top of the directory tree under which the server's
> # configuration, error, and log files are kept.
> #
> ServerRoot "C:/data/apache"
>
> #
> # PidFile: The file in which the server should record its process
> # identification number when it starts.
> #
> PidFile logs/httpd.pid
>
> #
> # ScoreBoardFile: File used to store internal server process information.
> # Not all architectures require this.  But if yours does (you'll know because
> # this file will be  created when you run Apache) then you *must* ensure that
> # no two invocations of Apache share the same scoreboard file.
> #
> ScoreBoardFile logs/apache_runtime_status
>
> #
> # In the standard configuration, the server will process httpd.conf (this
> # file, specified by the -f command line option), srm.conf, and access.conf
> # in that order.  The latter two files are now distributed empty, as it is
> # recommended that all directives be kept in a single file for simplicity.
> # The commented-out values below are the built-in defaults.  You can have the
> # server ignore these files altogether by using "/dev/null" (for Unix) or
> # "nul" (for Win32) for the arguments to the directives.
> #
> #ResourceConfig conf/srm.conf
> #AccessConfig conf/access.conf
>
> #
> # Timeout: The number of seconds before receives and sends time out.
> #
> Timeout 300
>
> #
> # KeepAlive: Whether or not to allow persistent connections (more than
> # one request per connection). Set to "Off" to deactivate.
> #
> KeepAlive On
>
> #
> # MaxKeepAliveRequests: The maximum number of requests to allow
> # during a persistent connection. Set to 0 to allow an unlimited amount.
> # We recommend you leave this number high, for maximum performance.
> #
> MaxKeepAliveRequests 100
>
> #
> # KeepAliveTimeout: Number of seconds to wait for the next request from the
> # same client on the same connection.
> #
> KeepAliveTimeout 15
>
> #
> # Apache on Win32 always creates one child process to handle requests.  If it
> # dies, another child process is created automatically.  Within the child
> # process multiple threads handle incoming requests.  The next two
> # directives control the behaviour of the threads and processes.
> #
>
> #
> # MaxRequestsPerChild: the number of requests each child process is
> # allowed to process before the child dies.  The child will exit so
> # as to avoid problems after prolonged use when Apache (and maybe the
> # libraries it uses) leak memory or other resources.  On most systems, this
> # isn't really needed, but a few (such as Solaris) do have notable leaks
> # in the libraries.  For Win32, set this value to zero (unlimited)
> # unless advised otherwise.
> #
> # NOTE: This value does not include keepalive requests after the initial
> #       request per connection. For example, if a child process handles
> #       an initial request and 10 subsequent "keptalive" requests, it
> #       would only count as 1 request towards this limit.
> #
> MaxRequestsPerChild 0
>
> #
> # Number of concurrent threads (i.e., requests) the server will allow.
> # Set this value according to the responsiveness of the server (more
> # requests active at once means they're all handled more slowly) and
> # the amount of system resources you'll allow the server to consume.
> #
> ThreadsPerChild 50
>
> #
> # Listen: Allows you to bind Apache to specific IP addresses and/or
> # ports, in addition to the default. See also the <VirtualHost>
> # directive.
> #
> #Listen 3000
> #Listen 12.34.56.78:80
>
> #
> # BindAddress: You can support virtual hosts with this option. This directive
> # is used to tell the server which IP address to listen to. It can either
> # contain "*", an IP address, or a fully qualified Internet domain name.
> # See also the <VirtualHost> and Listen directives.
> #
> #BindAddress *
>
> #
> # Apache Modules compiled into the standard Windows build
> #
> # The following modules are bound into the standard Apache binary distribution
> # for Windows.  To change the standard behavior, uncomment the following lines
> # and modify the list of those specific modules to be enabled in the server.
> #
> # WARNING: This is an advanced option that may render your server inoperable!
> # Do not use these directives without expert guidance.
> #
> #ClearModuleList
> #AddModule mod_so.c mod_mime.c mod_access.c mod_auth.c mod_negotiation.c
> #AddModule mod_include.c mod_autoindex.c mod_dir.c mod_cgi.c mod_userdir.c
> #AddModule mod_alias.c mod_env.c mod_log_config.c mod_asis.c mod_imap.c
> #AddModule mod_actions.c mod_setenvif.c mod_isapi.c
>
> #
> # Dynamic Shared Object (DSO) Support
> #
> # To be able to use the functionality of a module which was built as a DSO you
> # have to place corresponding `LoadModule' lines at this location so the
> # directives contained in it are actually available _before_ they are used.
> # Please read the file README.DSO in the Apache 1.3 distribution for more
> # details about the DSO mechanism and run `apache -l' for the list of already
> # built-in (statically linked and thus always available) modules in your Apache
> # binary.
> #
> # Note: The order in which modules are loaded is important.  Don't change
> # the order below without expert advice.
> #
> #LoadModule anon_auth_module modules/mod_auth_anon.so
> #LoadModule dbm_auth_module modules/mod_auth_dbm.so
> #LoadModule digest_auth_module modules/mod_auth_digest.so
> #LoadModule cern_meta_module modules/mod_cern_meta.so
> #LoadModule digest_module modules/mod_digest.so
> #LoadModule expires_module modules/mod_expires.so
> #LoadModule headers_module modules/mod_headers.so
> #LoadModule proxy_module modules/mod_proxy.so
> #LoadModule rewrite_module modules/mod_rewrite.so
> #LoadModule speling_module modules/mod_speling.so
> #LoadModule info_module modules/mod_info.so
> #LoadModule status_module modules/mod_status.so
> #LoadModule usertrack_module modules/mod_usertrack.so
> LoadModule python_module modules/mod_python.dll
>
> #
> # ExtendedStatus controls whether Apache will generate "full" status
> # information (ExtendedStatus On) or just basic information (ExtendedStatus
> # Off) when the "server-status" handler is called. The default is Off.
> #
> #ExtendedStatus On
>
> ### Section 2: 'Main' server configuration
> #
> # The directives in this section set up the values used by the 'main'
> # server, which responds to any requests that aren't handled by a
> # <VirtualHost> definition.  These values also provide defaults for
> # any <VirtualHost> containers you may define later in the file.
> #
> # All of these directives may appear inside <VirtualHost> containers,
> # in which case these default settings will be overridden for the
> # virtual host being defined.
> #
>
> #
> # Port: The port to which the standalone server listens.  Certain firewall
> # products must be configured before Apache can listen to a specific port.
> # Other running httpd servers will also interfere with this port.  Disable
> # all firewall, security, and other services if you encounter problems.
> # To help diagnose problems use the Windows NT command NETSTAT -a
> #
> Port 80
>
> #
> # ServerAdmin: Your address, where problems with the server should be
> # e-mailed.  This address appears on some server-generated pages, such
> # as error documents.
> #
> ServerAdmin pdeluca@sia.net.au
>
> #
> # ServerName allows you to set a host name which is sent back to clients for
> # your server if it's different than the one the program would get (i.e., use
> # "www" instead of the host's real name).
> #
> # Note: You cannot just invent host names and hope they work. The name you
> # define here must be a valid DNS name for your host. If you don't understand
> # this, ask your network administrator.
> # If your host doesn't have a registered DNS name, enter its IP address here.
> # You will have to access it by its address (e.g., http://123.45.67.89/)
> # anyway, and this will make redirections work in a sensible way.
> #
> # 127.0.0.1 is the TCP/IP local loop-back address, often named localhost. Your
> # machine always knows itself by this address. If you use Apache strictly for
> # local testing and development, you may use 127.0.0.1 as the server name.
> #
> ServerName localhost
>
>
> #
> # DocumentRoot: The directory out of which you will serve your
> # documents. By default, all requests are taken from this directory, but
> # symbolic links and aliases may be used to point to other locations.
> #
> DocumentRoot "C:/data/apache/htdocs"
>
> #
> # Each directory to which Apache has access, can be configured with respect
> # to which services and features are allowed and/or disabled in that
> # directory (and its subdirectories).
> #
> # First, we configure the "default" to be a very restrictive set of
> # permissions.
> #
> <Directory />
>      Options FollowSymLinks
>      AllowOverride None
> </Directory>
>
> #
> # Note that from this point forward you must specifically allow
> # particular features to be enabled - so if something's not working as
> # you might expect, make sure that you have specifically enabled it
> # below.
> #
>
> #
> # This should be changed to whatever you set DocumentRoot to.
> #
> <Directory "C:/data/apache/htdocs">
>
> #
> # This may also be "None", "All", or any combination of "Indexes",
> # "Includes", "FollowSymLinks", "ExecCGI", or "MultiViews".
> #
> # Note that "MultiViews" must be named *explicitly* --- "Options All"
> # doesn't give it to you.
> #
>      Options Indexes FollowSymLinks MultiViews
>
> #
> # This controls which options the .htaccess files in directories can
> # override. Can also be "All", or any combination of "Options", "FileInfo",
> # "AuthConfig", and "Limit"
> #
>      AllowOverride None
>
> #
> # Controls who can get stuff from this server.
> #
>      Order allow,deny
>      Allow from all
> </Directory>
>
> #
> # UserDir: The name of the directory which is appended onto a user's home
> # directory if a ~user request is received.
> #
> # Under Win32, we do not currently try to determine the home directory of
> # a Windows login, so a format such as that below needs to be used.  See
> # the UserDir documentation for details.
> #
> <IfModule mod_userdir.c>
>      UserDir "C:/data/apache/users/"
> </IfModule>
>
> #
> # Control access to UserDir directories.  The following is an example
> # for a site where these directories are restricted to read-only.
> #
> #<Directory "C:/data/apache/users">
> #    AllowOverride FileInfo AuthConfig Limit
> #    Options MultiViews Indexes SymLinksIfOwnerMatch IncludesNoExec
> #    <Limit GET POST OPTIONS PROPFIND>
> #        Order allow,deny
> #        Allow from all
> #    </Limit>
> #    <LimitExcept GET POST OPTIONS PROPFIND>
> #        Order deny,allow
> #        Deny from all
> #    </LimitExcept>
> #</Directory>
>
> #
> # DirectoryIndex: Name of the file or files to use as a pre-written HTML
> # directory index.  Separate multiple entries with spaces.
> #
> <IfModule mod_dir.c>
>      DirectoryIndex index.html
> </IfModule>
>
> #
> # AccessFileName: The name of the file to look for in each directory
> # for access control information.
> #
> AccessFileName .htaccess
>
> #
> # The following lines prevent .htaccess files from being viewed by
> # Web clients.  Since .htaccess files often contain authorization
> # information, access is disallowed for security reasons.  Comment
> # these lines out if you want Web visitors to see the contents of
> # .htaccess files.  If you change the AccessFileName directive above,
> # be sure to make the corresponding changes here.
> #
> # Also, folks tend to use names such as .htpasswd for password
> # files, so this will protect those as well.
> #
> <Files ~ "^\.ht">
>      Order allow,deny
>      Deny from all
> </Files>
>
> #
> # CacheNegotiatedDocs: By default, Apache sends "Pragma: no-cache" with each
> # document that was negotiated on the basis of content. This asks proxy
> # servers not to cache the document. Uncommenting the following line disables
> # this behavior, and proxies will be allowed to cache the documents.
> #
> #CacheNegotiatedDocs
>
> #
> # UseCanonicalName:  (new for 1.3)  With this setting turned on, whenever
> # Apache needs to construct a self-referencing URL (a URL that refers back
> # to the server the response is coming from) it will use ServerName and
> # Port to form a "canonical" name.  With this setting off, Apache will
> # use the hostname:port that the client supplied, when possible.  This
> # also affects SERVER_NAME and SERVER_PORT in CGI scripts.
> #
> UseCanonicalName On
>
> #
> # TypesConfig describes where the mime.types file (or equivalent) is
> # to be found.
> #
> <IfModule mod_mime.c>
>      TypesConfig conf/mime.types
> </IfModule>
>
> #
> # DefaultType is the default MIME type the server will use for a document
> # if it cannot otherwise determine one, such as from filename extensions.
> # If your server contains mostly text or HTML documents, "text/plain" is
> # a good value.  If most of your content is binary, such as applications
> # or images, you may want to use "application/octet-stream" instead to
> # keep browsers from trying to display binary files as though they are
> # text.
> #
> DefaultType text/plain
>
> #
> # The mod_mime_magic module allows the server to use various hints from the
> # contents of the file itself to determine its type.  The MIMEMagicFile
> # directive tells the module where the hint definitions are located.
> # mod_mime_magic is not part of the default server (you have to add
> # it yourself with a LoadModule [see the DSO paragraph in the 'Global
> # Environment' section], or recompile the server and include mod_mime_magic
> # as part of the configuration), so it's enclosed in an <IfModule> container.
> # This means that the MIMEMagicFile directive will only be processed if the
> # module is part of the server.
> #
> <IfModule mod_mime_magic.c>
>      MIMEMagicFile conf/magic
> </IfModule>
>
> #
> # HostnameLookups: Log the names of clients or just their IP addresses
> # e.g., www.apache.org (on) or 204.62.129.132 (off).
> # The default is off because it'd be overall better for the net if people
> # had to knowingly turn this feature on, since enabling it means that
> # each client request will result in AT LEAST one lookup request to the
> # nameserver.
> #
> HostnameLookups Off
>
> #
> # ErrorLog: The location of the error log file.
> # If you do not specify an ErrorLog directive within a <VirtualHost>
> # container, error messages relating to that virtual host will be
> # logged here.  If you *do* define an error logfile for a <VirtualHost>
> # container, that host's errors will be logged there and not here.
> #
> ErrorLog logs/error.log
>
> #
> # LogLevel: Control the number of messages logged to the error.log.
> # Possible values include: debug, info, notice, warn, error, crit,
> # alert, emerg.
> #
> LogLevel warn
>
> #
> # The following directives define some format nicknames for use with
> # a CustomLog directive (see below).
> #
> LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\""
> combined
> LogFormat "%h %l %u %t \"%r\" %>s %b" common
> LogFormat "%{Referer}i -> %U" referer
> LogFormat "%{User-agent}i" agent
>
> #
> # The location and format of the access logfile (Common Logfile Format).
> # If you do not define any access logfiles within a <VirtualHost>
> # container, they will be logged here.  Contrariwise, if you *do*
> # define per-<VirtualHost> access logfiles, transactions will be
> # logged therein and *not* in this file.
> #
> CustomLog logs/access.log common
>
> #
> # If you would like to have agent and referer logfiles, uncomment the
> # following directives.
> #
> #CustomLog logs/referer.log referer
> #CustomLog logs/agent.log agent
>
> #
> # If you prefer a single logfile with access, agent, and referer information
> # (Combined Logfile Format) you can use the following directive.
> #
> #CustomLog logs/access.log combined
>
> #
> # Optionally add a line containing the server version and virtual host
> # name to server-generated pages (error documents, FTP directory listings,
> # mod_status and mod_info output etc., but not CGI generated documents).
> # Set to "EMail" to also include a mailto: link to the ServerAdmin.
> # Set to one of:  On | Off | EMail
> #
> ServerSignature On
>
> #
> # Apache parses all CGI scripts for the shebang line by default.
> # This comment line, the first line of the script, consists of the symbols
> # pound (#) and exclamation (!) followed by the path of the program that
> # can execute this specific script.  For a perl script, with perl.exe in
> # the C:\Program Files\Perl directory, the shebang line should be:
>
>     #!c:/program files/perl/perl
>
> # Note you _must_not_ indent the actual shebang line, and it must be the
> # first line of the file.  Of course, CGI processing must be enabled by
> # the appropriate ScriptAlias or Options ExecCGI directives for the files
> # or directory in question.
> #
> # However, Apache on Windows allows either the Unix behavior above, or can
> # use the Registry to match files by extention.  The command to execute
> # a file of this type is retrieved from the registry by the same method as
> # the Windows Explorer would use to handle double-clicking on a file.
> # These script actions can be configured from the Windows Explorer View menu,
> # 'Folder Options', and reviewing the 'File Types' tab.  Clicking the Edit
> # button allows you to modify the Actions, of which Apache 1.3 attempts to
> # perform the 'Open' Action, and failing that it will try the shebang line.
> # This behavior is subject to change in Apache release 2.0.
> #
> # Each mechanism has it's own specific security weaknesses, from the means
> # to run a program you didn't intend the website owner to invoke, and the
> # best method is a matter of great debate.
> #
> # To enable the this Windows specific behavior (and therefore -disable- the
> # equivilant Unix behavior), uncomment the following directive:
> #
> #ScriptInterpreterSource registry
> #
> # The directive above can be placed in individual <Directory> blocks or the
> # .htaccess file, with either the 'registry' (Windows behavior) or 'script'
> # (Unix behavior) option, and will override this server default option.
> #
>
> #
> # Aliases: Add here as many aliases as you need (with no limit). The format is
> # Alias fakename realname
> #
> <IfModule mod_alias.c>
>
>      #
>      # Note that if you include a trailing / on fakename then the server will
>      # require it to be present in the URL.  So "/icons" isn't aliased in this
>      # example, only "/icons/"..
>      #
>      Alias /icons/ "C:/data/apache/icons/"
>
>      <Directory "C:/data/apache/icons">
>          Options Indexes MultiViews
>          AllowOverride None
>          Order allow,deny
>          Allow from all
>      </Directory>
>
>      #
>      # ScriptAlias: This controls which directories contain server scripts.
>      # ScriptAliases are essentially the same as Aliases, except that
>      # documents in the realname directory are treated as applications and
>      # run by the server when requested rather than as documents sent to
> the client.
>      # The same rules about trailing "/" apply to ScriptAlias directives as to
>      # Alias.
>      #
>      ScriptAlias /cgi-bin/ "C:/data/apache/cgi-bin/"
>
>      #
>      # "C:/data/apache/cgi-bin" should be changed to whatever your
> ScriptAliased
>      # CGI directory exists, if you have that configured.
>      #
>      <Directory "C:/data/apache/cgi-bin">
>          AllowOverride None
>          Options None
>          Order allow,deny
>          Allow from all
>      </Directory>
>
>      <Directory "c:/data/apache/htdocs/python">
>      	AddHandler python-program .py
>      	PythonHandler test
>      	PythonDebug on
>      </Directory>
>
> </IfModule>
> # End of aliases.
>
> #
> # Redirect allows you to tell clients about documents which used to exist in
> # your server's namespace, but do not anymore. This allows you to tell the
> # clients where to look for the relocated document.
> # Format: Redirect old-URI new-URL
> #
>
> #
> # Directives controlling the display of server-generated directory listings.
> #
> <IfModule mod_autoindex.c>
>
>      #
>      # FancyIndexing is whether you want fancy directory indexing or standard
>      #
>      # Note, add the option TrackModified to the IndexOptions default list only
>      # if all indexed directories reside on NTFS volumes.  The
> TrackModified flag
>      # will report the Last-Modified date to assist caches and proxies to
> properly
>      # track directory changes, but it does _not_ work on FAT volumes.
>      #
>      IndexOptions FancyIndexing
>
>      #
>      # AddIcon* directives tell the server which icon to show for different
>      # files or filename extensions.  These are only displayed for
>      # FancyIndexed directories.
>      #
>      AddIconByEncoding (CMP,/icons/compressed.gif) x-compress x-gzip
>
>      AddIconByType (TXT,/icons/text.gif) text/*
>      AddIconByType (IMG,/icons/image2.gif) image/*
>      AddIconByType (SND,/icons/sound2.gif) audio/*
>      AddIconByType (VID,/icons/movie.gif) video/*
>
>      AddIcon /icons/binary.gif .bin .exe
>      AddIcon /icons/binhex.gif .hqx
>      AddIcon /icons/tar.gif .tar
>      AddIcon /icons/world2.gif .wrl .wrl.gz .vrml .vrm .iv
>      AddIcon /icons/compressed.gif .Z .z .tgz .gz .zip
>      AddIcon /icons/a.gif .ps .ai .eps
>      AddIcon /icons/layout.gif .html .shtml .htm .pdf
>      AddIcon /icons/text.gif .txt
>      AddIcon /icons/c.gif .c
>      AddIcon /icons/p.gif .pl .py
>      AddIcon /icons/f.gif .for
>      AddIcon /icons/dvi.gif .dvi
>      AddIcon /icons/uuencoded.gif .uu
>      AddIcon /icons/script.gif .conf .sh .shar .csh .ksh .tcl
>      AddIcon /icons/tex.gif .tex
>      AddIcon /icons/bomb.gif core
>
>      AddIcon /icons/back.gif ..
>      AddIcon /icons/hand.right.gif README
>      AddIcon /icons/folder.gif ^^DIRECTORY^^
>      AddIcon /icons/blank.gif ^^BLANKICON^^
>
>      #
>      # DefaultIcon is which icon to show for files which do not have an icon
>      # explicitly set.
>      #
>      DefaultIcon /icons/unknown.gif
>
>      #
>      # AddDescription allows you to place a short description after a file in
>      # server-generated indexes.  These are only displayed for FancyIndexed
>      # directories.
>      # Format: AddDescription "description" filename
>      #
>      #AddDescription "GZIP compressed document" .gz
>      #AddDescription "tar archive" .tar
>      #AddDescription "GZIP compressed tar archive" .tgz
>
>      #
>      # ReadmeName is the name of the README file the server will look for by
>      # default, and append to directory listings.
>      #
>      # HeaderName is the name of a file which should be prepended to
>      # directory indexes.
>      #
>      # If MultiViews are amongst the Options in effect, the server will
>      # first look for name.html and include it if found.  If name.html
>      # doesn't exist, the server will then look for name.txt and include
>      # it as plaintext if found.
>      #
>      ReadmeName README
>      HeaderName HEADER
>
>      #
>      # IndexIgnore is a set of filenames which directory indexing should ignore
>      # and not include in the listing.  Shell-style wildcarding is permitted.
>      #
>      IndexIgnore .??* *~ *# HEADER* README* RCS CVS *,v *,t
>
> </IfModule>
> # End of indexing directives.
>
> #
> # Document types.
> #
> <IfModule mod_mime.c>
>
>      #
>      # AddEncoding allows you to have certain browsers (Mosaic/X 2.1+)
> uncompress
>      # information on the fly. Note: Not all browsers support this.
>      # Despite the name similarity, the following Add* directives have nothing
>      # to do with the FancyIndexing customization directives above.
>      #
>      AddEncoding x-compress Z
>      AddEncoding x-gzip gz tgz
>      #
>      # AddLanguage allows you to specify the language of a document. You can
>      # then use content negotiation to give a browser a file in a language
>      # it can understand.
>      #
>      # Note 1: The suffix does not have to be the same as the language
>      # keyword --- those with documents in Polish (whose net-standard
>      # language code is pl) may wish to use "AddLanguage pl .po" to
>      # avoid the ambiguity with the common suffix for perl scripts.
>      #
>      # Note 2: The example entries below illustrate that in quite
>      # some cases the two character 'Language' abbreviation is not
>      # identical to the two character 'Country' code for its country,
>      # E.g. 'Danmark/dk' versus 'Danish/da'.
>      #
>      # Note 3: In the case of 'ltz' we violate the RFC by using a three char
>      # specifier. But there is 'work in progress' to fix this and get
>      # the reference data for rfc1766 cleaned up.
>      #
>      # Danish (da) - Dutch (nl) - English (en) - Estonian (ee)
>      # French (fr) - German (de) - Greek-Modern (el)
>      # Italian (it) - Korean (kr) - Norwegian (no)
>      # Portugese (pt) - Luxembourgeois* (ltz)
>      # Spanish (es) - Swedish (sv) - Catalan (ca) - Czech(cz)
>      # Polish (pl) - Brazilian Portuguese (pt-br) - Japanese (ja)
>      # Russian (ru)
>      #
>      AddLanguage da .dk
>      AddLanguage nl .nl
>      AddLanguage en .en
>      AddLanguage et .ee
>      AddLanguage fr .fr
>      AddLanguage de .de
>      AddLanguage el .el
>      AddLanguage he .he
>      AddCharset ISO-8859-8 .iso8859-8
>      AddLanguage it .it
>      AddLanguage ja .ja
>      AddCharset ISO-2022-JP .jis
>      AddLanguage kr .kr
>      AddCharset ISO-2022-KR .iso-kr
>      AddLanguage no .no
>      AddLanguage pl .po
>      AddCharset ISO-8859-2 .iso-pl
>      AddLanguage pt .pt
>      AddLanguage pt-br .pt-br
>      AddLanguage ltz .lu
>      AddLanguage ca .ca
>      AddLanguage es .es
>      AddLanguage sv .se
>      AddLanguage cz .cz
>      AddLanguage ru .ru
>      AddLanguage tw .tw
>      AddLanguage zh-tw .tw
>      AddCharset Big5         .Big5    .big5
>      AddCharset WINDOWS-1251 .cp-1251
>      AddCharset CP866        .cp866
>      AddCharset ISO-8859-5   .iso-ru
>      AddCharset KOI8-R       .koi8-r
>      AddCharset UCS-2        .ucs2
>      AddCharset UCS-4        .ucs4
>      AddCharset UTF-8        .utf8
>
>      # LanguagePriority allows you to give precedence to some languages
>      # in case of a tie during content negotiation.
>      #
>      # Just list the languages in decreasing order of preference. We have
>      # more or less alphabetized them here. You probably want to change this.
>      #
>      <IfModule mod_negotiation.c>
>          LanguagePriority en da nl et fr de el it ja kr no pl pt pt-br ru
> ltz ca es sv tw
>      </IfModule>
>
>      #
>      # AddType allows you to tweak mime.types without actually editing it,
> or to
>      # make certain files to be certain types.
>      #
>      # For example, the PHP 3.x module (not part of the Apache distribution
> - see
>      # http://www.php.net) will typically use:
>      #
>      #AddType application/x-httpd-php3 .php3
>      #AddType application/x-httpd-php3-source .phps
>      #
>      # And for PHP 4.x, use:
>      #
>      #AddType application/x-httpd-php .php
>      #AddType application/x-httpd-php-source .phps
>
>      AddType application/x-tar .tgz
>
>      #
>      # AddHandler allows you to map certain file extensions to "handlers",
>      # actions unrelated to filetype. These can be either built into the server
>      # or added with the Action command (see below)
>      #
>      # If you want to use server side includes, or CGI outside
>      # ScriptAliased directories, uncomment the following lines.
>      #
>      # To use CGI scripts:
>      #
>      #AddHandler cgi-script .cgi
>
>      #
>      # To use server-parsed HTML files
>      #
>      #AddType text/html .shtml
>      #AddHandler server-parsed .shtml
>
>      #
>      # Uncomment the following line to enable Apache's send-asis HTTP file
>      # feature
>      #
>      #AddHandler send-as-is asis
>
>      #
>      # If you wish to use server-parsed imagemap files, use
>      #
>      #AddHandler imap-file map
>
>      #
>      # To enable type maps, you might want to use
>      #
>      #AddHandler type-map var
>
> </IfModule>
> # End of document types.
>
> #
> # Action lets you define media types that will execute a script whenever
> # a matching file is called. This eliminates the need for repeated URL
> # pathnames for oft-used CGI file processors.
> # Format: Action media/type /cgi-script/location
> # Format: Action handler-name /cgi-script/location
> #
>
> #
> # MetaDir: specifies the name of the directory in which Apache can find
> # meta information files. These files contain additional HTTP headers
> # to include when sending the document
> #
> #MetaDir .web
>
> #
> # MetaSuffix: specifies the file name suffix for the file containing the
> # meta information.
> #
> #MetaSuffix .meta
>
> #
> # Customizable error response (Apache style)
> #  these come in three flavors
> #
> #    1) plain text
> #ErrorDocument 500 "The server made a boo boo.
> #  n.b.  the single leading (") marks it as text, it does not get output
> #
> #    2) local redirects
> #ErrorDocument 404 /missing.html
> #  to redirect to local URL /missing.html
> #ErrorDocument 404 /cgi-bin/missing_handler.pl
> #  N.B.: You can redirect to a script or a document using server-side-includes.
> #
> #    3) external redirects
> #ErrorDocument 402 http://some.other_server.com/subscription_info.html
> #  N.B.: Many of the environment variables associated with the original
> #  request will *not* be available to such a script.
>
> #
> # Customize behaviour based on the browser
> #
> <IfModule mod_setenvif.c>
>
>      #
>      # The following directives modify normal HTTP response behavior.
>      # The first directive disables keepalive for Netscape 2.x and browsers
> that
>      # spoof it. There are known problems with these browser implementations.
>      # The second directive is for Microsoft Internet Explorer 4.0b2
>      # which has a broken HTTP/1.1 implementation and does not properly
>      # support keepalive when it is used on 301 or 302 (redirect) responses.
>      #
>      BrowserMatch "Mozilla/2" nokeepalive
>      BrowserMatch "MSIE 4\.0b2;" nokeepalive downgrade-1.0 force-response-1.0
>
>      #
>      # The following directive disables HTTP/1.1 responses to browsers which
>      # are in violation of the HTTP/1.0 spec by not being able to grok a
>      # basic 1.1 response.
>      #
>      BrowserMatch "RealPlayer 4\.0" force-response-1.0
>      BrowserMatch "Java/1\.0" force-response-1.0
>      BrowserMatch "JDK/1\.0" force-response-1.0
>
> </IfModule>
> # End of browser customization directives
>
> #
> # Allow server status reports, with the URL of http://servername/server-status
> # Change the ".localhost" to match your domain to enable.
> #
> #<Location /server-status>
> #    SetHandler server-status
> #    Order deny,allow
> #    Deny from all
> #    Allow from .localhost
> #</Location>
>
> #
> # Allow remote server configuration reports, with the URL of
> # http://servername/server-info (requires that mod_info.c be loaded).
> # Change the ".localhost" to match your domain to enable.
> #
> #<Location /server-info>
> #    SetHandler server-info
> #    Order deny,allow
> #    Deny from all
> #    Allow from .localhost
> #</Location>
>
> #
> # There have been reports of people trying to abuse an old bug from pre-1.1
> # days.  This bug involved a CGI script distributed as a part of Apache.
> # By uncommenting these lines you can redirect these attacks to a logging
> # script on phf.apache.org.  Or, you can record them yourself, using the script
> # support/phf_abuse_log.cgi.
> #
> #<Location /cgi-bin/phf*>
> #    Deny from all
> #    ErrorDocument 403 http://phf.apache.org/phf_abuse_log.cgi
> #</Location>
>
> #
> # Proxy Server directives. Uncomment the following lines to
> # enable the proxy server:
> #
> #<IfModule mod_proxy.c>
> #    ProxyRequests On
>
> #    <Directory proxy:*>
> #        Order deny,allow
> #        Deny from all
> #        Allow from .localhost
> #    </Directory>
>
>      #
>      # Enable/disable the handling of HTTP/1.1 "Via:" headers.
>      # ("Full" adds the server version; "Block" removes all outgoing Via:
> headers)
>      # Set to one of: Off | On | Full | Block
>      #
> #    ProxyVia On
>
>      #
>      # To enable the cache as well, edit and uncomment the following lines:
>      # (no cacheing without CacheRoot)
>      #
> #    CacheRoot "C:/data/apache/proxy"
> #    CacheSize 5
> #    CacheGcInterval 4
> #    CacheMaxExpire 24
> #    CacheLastModifiedFactor 0.1
> #    CacheDefaultExpire 1
> #    NoCache a_domain.com another_domain.edu joes.garage_sale.com
>
> #</IfModule>
> # End of proxy directives.
>
> ### Section 3: Virtual Hosts
> #
> # VirtualHost: If you want to maintain multiple domains/hostnames on your
> # machine you can setup VirtualHost containers for them. Most configurations
> # use only name-based virtual hosts so the server doesn't need to worry about
> # IP addresses. This is indicated by the asterisks in the directives below.
> #
> # Please see the documentation at <URL:http://www.apache.org/docs/vhosts/>
> # for further details before you try to setup virtual hosts.
> #
> # You may use the command line option '-S' to verify your virtual host
> # configuration.
>
> #
> # Use name-based virtual hosting.
> #
> #NameVirtualHost *
>
> #
> # VirtualHost example:
> # Almost any Apache directive may go into a VirtualHost container.
> # The first VirtualHost section is used for requests without a known
> # server name.
> #
> #<VirtualHost *>
> #    ServerAdmin webmaster@dummy-host.example.com
> #    DocumentRoot /www/docs/dummy-host.example.com
> #    ServerName dummy-host.example.com
> #    ErrorLog logs/dummy-host.example.com-error_log
> #    CustomLog logs/dummy-host.example.com-access_log common
> #</VirtualHost>
>
>
>
> Apologies for the size of this email, I just need to get this problem
> sorted ASAP. Any help will be greatly appreciated.
>
>
>
>
>
>
>
>
> -------------------------------------------
> Paul De Luca
> Email: pdeluca@sia.net.au
> Ph: 0414 225561
> -------------------------------------------
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From LinscombeJ at cmalliance.org  Thu May 24 09:02:11 2001
From: LinscombeJ at cmalliance.org (Linscombe, Jason)
Date: Fri Jan  9 21:46:19 2004
Subject: [mod_python] SuSE 7.1 RPM mod_python & apache
Message-ID: <CE1A83EC8461D311A81F0060B03C7CAAEF4FE0@mail1.cmalliance.org>

Hi List,

I'm trying to run mod_python over apache and could use some help setting
this up.  Here is my setup...

Apache-1.3.14-6
Python-2.0-6
mod_python-2.7.1-3
Distro: SuSE 7.1 Installed the above with RPM

Here is the python stuff in my httpd.conf
-----------------------------------------------------------------
<IfDefine PYTHON>
LoadModule python_module	/usr/lib/apache/mod_python.so
</IfDefine>

<IfDefine PYTHON>
AddModule mod_python.c
</IfDefine>

<Directory /usr/local/httpd/htdocs/test> 
  AddHandler python-program .py
  PythonHandler mptest 
  PythonDebug On 
</Directory>
-----------------------------------------------------------------


And I have this in a file called /usr/local/httpd/htdocs/test/mptest.py
-----------------------------------------------------------------
from mod_python import apache

def handler(req):
    req.send_http_header()
    req.write("Hello World!")
    return apache.OK
-----------------------------------------------------------------


I have checked all file permissions and everything seems to be OK.  All of
the above was either default in my httpd.conf or what I found in the
"Testing" page on the documentation.  The problem I'm having is with the
above, I try to start apache and I get the following error:

FAILED:  See /var/log/httpd/rcapache.log for details

here is the rcapache.log file...
-----------------------------------------------------------------
Syntax error on line 1634 of /etc/httpd/httpd.conf
Invalid command 'PythonHandler', perhaps mis-spelled or defined by a module
not included in the server configuration.
-----------------------------------------------------------------


Question:  is this mptest.py file necessary for running python scripts over
the web server or is this simply a test?  Being a python newbie, I don't
really know what to do next.  Thanks in advance for any help!

jason


From LinscombeJ at cmalliance.org  Thu May 24 12:20:23 2001
From: LinscombeJ at cmalliance.org (Linscombe, Jason)
Date: Fri Jan  9 21:46:19 2004
Subject: [mod_python] SuSE 7.1 RPM mod_python & apache
Message-ID: <CE1A83EC8461D311A81F0060B03C7CAAEF4FE4@mail1.cmalliance.org>

I tried to simplify things and took it out of the <IfDefine PYTHON> tags and
placed the LoadModule and AddModule lines in the normal place (along with
all the others.  But I'm getting the same error as before.  Does the
<Directory /some/directory/htdocs/test> need to be placed inside another set
of tags or can it simply be appended at the end of the file?  I have it as
the last 5 lines of my httpd.conf

jason



-----Original Message-----
From: Alain T?sio
Sent: Thursday, May 24, 2001 10:54 AM


Hi, I have the same setup without "<IfDefine PYTHON>" and it works ...

Alain



----- Original Message -----
From: "Linscombe, Jason" <LinscombeJ@cmalliance.org>
To: <mod_python@modpython.org>
Sent: Thursday, May 24, 2001 5:02 PM
Subject: [mod_python] SuSE 7.1 RPM mod_python & apache


>
> Hi List,
>
> I'm trying to run mod_python over apache and could use some help setting
> this up.  Here is my setup...
>
> Apache-1.3.14-6
> Python-2.0-6
> mod_python-2.7.1-3
> Distro: SuSE 7.1 Installed the above with RPM
>
> Here is the python stuff in my httpd.conf
> -----------------------------------------------------------------
> <IfDefine PYTHON>
> LoadModule python_module /usr/lib/apache/mod_python.so
> </IfDefine>
>
> <IfDefine PYTHON>
> AddModule mod_python.c
> </IfDefine>
>
> <Directory /usr/local/httpd/htdocs/test>
>   AddHandler python-program .py
>   PythonHandler mptest
>   PythonDebug On
> </Directory>
> -----------------------------------------------------------------
>
>
> And I have this in a file called /usr/local/httpd/htdocs/test/mptest.py
> -----------------------------------------------------------------
> from mod_python import apache
>
> def handler(req):
>     req.send_http_header()
>     req.write("Hello World!")
>     return apache.OK
> -----------------------------------------------------------------
>
>
> I have checked all file permissions and everything seems to be OK.  All of
> the above was either default in my httpd.conf or what I found in the
> "Testing" page on the documentation.  The problem I'm having is with the
> above, I try to start apache and I get the following error:
>
> FAILED:  See /var/log/httpd/rcapache.log for details
>
> here is the rcapache.log file...
> -----------------------------------------------------------------
> Syntax error on line 1634 of /etc/httpd/httpd.conf
> Invalid command 'PythonHandler', perhaps mis-spelled or defined by a
module
> not included in the server configuration.
> -----------------------------------------------------------------
>
>
> Question:  is this mptest.py file necessary for running python scripts
over
> the web server or is this simply a test?  Being a python newbie, I don't
> really know what to do next.  Thanks in advance for any help!
>
> jason
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

From meyer at diku.dk  Fri May 25 02:36:14 2001
From: meyer at diku.dk (Jonas Meyer Rasmussen)
Date: Fri Jan  9 21:46:19 2004
Subject: [mod_python] mod_python on win32
Message-ID: <OHENJJENEHAEEPAOJBHCOEDDCCAA.meyer@diku.dk>

Hi.
I am having alot of trouble getting mod_python to work...
(win32, Win2k Pro, Python 2.1)
apache just denies to load the module in, giving me this error:

Syntax error on line 206 of c:/progra..../httpd.conf:
Cannot load c:/.../apache/modules/mod_python.dll into server: (126) The
specified module could not be found:


I have done this:
added this to httpd.conf:

#placed after other uncommented LoadModules from std config file
LoadModule python_module modules/mod_python.dll


#placed in ifmodule mod_alias.c section
    <Directory "C:/Apache/cgi-bin">
        AddHandler python-program .py
        PythonHandler mptest
        PythonDebug on
    </Directory>



mod_python.dll is in the right place


made a small file in my apache/cgi-bin dir named mptest
which contains the following:

from mod_python import apache

def handler(req):
    req.content_type = "text/plain"
    req.send_http_header()
    req.write("Hello World!")
    return apache.OK


Jonas Meyer Rasmussen


From meyer at diku.dk  Fri May 25 13:03:55 2001
From: meyer at diku.dk (Jonas Meyer Rasmussen)
Date: Fri Jan  9 21:46:19 2004
Subject: [mod_python] mod_python on win32
In-Reply-To: <990766580.3b0de5f4623bb@webmail.uchicago.edu>
Message-ID: <Pine.LNX.4.21.0105251302310.11535-100000@dvalin.diku.dk>

On Thu, 24 May 2001, douglas savitsky wrote:
> 
> I recently upgraded from Python 2.0 to 2.1, and I notice that I am getting the 
> same error.  Perhaps if you go back to 2.0 and see if that works?

Yep that fixed the problem, thank you.

Now i just keep getting an internal server error when i try to load my
mptest.py, it says something about obcallback failed to init
?!?


Jonas Meyer Rasmussen
meyer@diku.dk



From rsalz at zolera.com  Fri May 25 09:41:44 2001
From: rsalz at zolera.com (Rich Salz)
Date: Fri Jan  9 21:46:19 2004
Subject: [mod_python] More file-like behavior
Message-ID: <3B0E6118.9BD61868@zolera.com>

The attached class provides a more complete implementation of Python's
file object.  We'd be quite pleased if it were accepted into the core.
:)
	/r$
-------------- next part --------------
#! /usr/bin/env python
##  ContentReader -- wrapper class for mod_python's request object that
##  provides a more complete set of file methods.
##  Copyright 2001, Zolera Systems, Inc.  All Rights Reserved.
##  This software is distributed under the terms of the mod_python license.
try:
    import xreadlines
except:
    pass

class ContentReader:
    '''A simple object that provides a minimal set of file methods from a
    mod_python request object.  Methods provided: read, readline, readlines,
    close, flush, and tell (and, if available, xreadlines).
    Attributes provided: closed, mode, and name.
    '''

    def __init__(self, req):
	'''req is the mod_python request handler.'''
	self.size = int(req.headers_in['content-length'])
	self.name = '<%s at 0x%x>' % (str(self.__class__), id(self))
	self.req, self.left, self.closed, self.mode = \
		req, self.size, 0, 'r'

    def read(self, size = 0):
	if self.closed: raise ValueError
	if self.left <= 0: return ''
	if size <= 0: size = self.left
	v = self.req.read(size)
	self.left = self.left - len(v)
	return v

    def readline(self, size = 0):
	v = self.req.readline(size)
	if len(v) > 1 and v[-2:] == '\r\n': v = v[:-2] + '\n'
	return v

    def readlines(self, sizehint = None):
	result = []
	while 1:
	    l = x.readline()
	    if l == '': break
	    result.append(l)
	    if sizehint != None:
		sizehint = sizehint - len(l)
		if sizehint <= 0: break
	return result

    def xreadlines(self):
	return xreadlines.xreadlines(self)

    def tell(self):
	return self.size - self.left

    def close(self):
	self.closed = 1

    def flush(self):
	pass
From paullb at bigfoot.com  Fri May 25 17:14:21 2001
From: paullb at bigfoot.com (Brendan Paull)
Date: Fri Jan  9 21:46:19 2004
Subject: [mod_python] Multiple versions on one machine
Message-ID: <5.0.2.1.2.20010525170709.00a0eec0@pop.minet.ca>

Hi,
	On my Red Hat 7.0 system I have two versions of python installed (1.5 and 
2.1) andt hey both work fine. They can be called by typing python1.5 and 
python2.1. I could not deinstall the RPM for 1.5 because there are many 
things that depended on it in my system. However, I have got my mod_python 
(v2.7) working and I can call scripts from inside the html directory 
(/var/www/html/python/ and HTML files for apache are in /var/www/html). 
However, mod_python sees only 1.5. How do I go about getting it to see the 
2.1 as well?

	Also, how would I go about getting python to work as a CGI interpreter, 
again preferably the 2.1 version. I already have perl5 working on the 
system? Is there a how-to somewhere?

I would appreciate any insight into either on of these questions,

Thank you in advance,

Brendan Paull


From grisha at modpython.org  Fri May 25 18:14:02 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:19 2004
Subject: [mod_python] Multiple versions on one machine
In-Reply-To: <5.0.2.1.2.20010525170709.00a0eec0@pop.minet.ca>
Message-ID: <Pine.BSF.4.32.0105251812480.47409-100000@localhost>

mod_python will most likely "see" the one that is invocable as "python"
during compilation. Do you have a python -> python1.5 symlink?

Grisha

On Fri, 25 May 2001, Brendan Paull wrote:

> Hi,
> 	On my Red Hat 7.0 system I have two versions of python installed (1.5 and
> 2.1) andt hey both work fine. They can be called by typing python1.5 and
> python2.1. I could not deinstall the RPM for 1.5 because there are many
> things that depended on it in my system. However, I have got my mod_python
> (v2.7) working and I can call scripts from inside the html directory
> (/var/www/html/python/ and HTML files for apache are in /var/www/html).
> However, mod_python sees only 1.5. How do I go about getting it to see the
> 2.1 as well?
>
> 	Also, how would I go about getting python to work as a CGI interpreter,
> again preferably the 2.1 version. I already have perl5 working on the
> system? Is there a how-to somewhere?
>
> I would appreciate any insight into either on of these questions,
>
> Thank you in advance,
>
> Brendan Paull
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From grisha at modpython.org  Sun May 27 00:52:37 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:19 2004
Subject: [mod_python] More file-like behavior
In-Reply-To: <3B0E6118.9BD61868@zolera.com>
Message-ID: <Pine.BSF.4.32.0105270050470.64009-100000@localhost>

Thanks Rich.

Can you elaborate a bit or give some example on how something like this
would be used? I.e. what advantage it would have over simply doing
req.write() or req.read()?

I'm just trying to get a better idea of how it would fit into mod_python.
:-)

Grisha

On Fri, 25 May 2001, Rich Salz wrote:

> The attached class provides a more complete implementation of Python's
> file object.  We'd be quite pleased if it were accepted into the core.
> :)
> 	/r$


From markb at well.com  Sun May 27 10:27:38 2001
From: markb at well.com (Mark Berry)
Date: Fri Jan  9 21:46:19 2004
Subject: [mod_python] Cookies, Redirects & Headers - Oh My!
Message-ID: <200105271028.DAA01579@smtp.well.com>

Hello List,

After spending almost 2 hours wrestling with the cookies and headers 
from the publisher,  I might suggest that we add a few simple examples 
into the standard documentation showing how to do very  basic but common 
operations.

Also, is there no reason that the publisher couldn't be extended at the 
core level to have something such as session management (using python 
pickling methods) for basic serialization, etc.  Is mod_python kept at 
grass-roots for a good reason? ;-)

I must say that with exceptions of a pool of example code, mod_python 
has been a pleasure to work with.  I would be happy to submit some 
example code to be put into the documentation if interested.

Cheers

.mark

From rsalz at zolera.com  Sun May 27 08:04:05 2001
From: rsalz at zolera.com (Rich Salz)
Date: Fri Jan  9 21:46:19 2004
Subject: [mod_python] More file-like behavior
References: <Pine.BSF.4.32.0105270050470.64009-100000@localhost>
Message-ID: <3B10ED35.CD0D36BC@zolera.com>

> Can you elaborate a bit or give some example on how something like this
> would be used? I.e. what advantage it would have over simply doing
> req.write() or req.read()?

It's a more complete implementation, so anyplace that wants a file
object can pass
	ContentReader(req)

Now, maybe most things just use req.read(), but we (at least) had some
code that wanted filename, etc.
	/r$

From deneb at unixwave.org  Sun May 27 22:12:38 2001
From: deneb at unixwave.org (Deneb)
Date: Fri Jan  9 21:46:20 2004
Subject: [mod_python] Template Class
Message-ID: <20010527221238.A3112@unixwave.org>

Hi,
all just yesterday i finished well a Template Class in order to use it
with modpython, higly ispired from PHPlib Template class, which is 
suitable for all purpose. Actually i use it in some of my projects.
A correct example on how it works, can be found in the PHPlib docs,
at phplib.netuse.de. 
I hope that you find this useful. The code is in the attach.
 
Cheers,
deneb.
 
-------------- next part --------------
#!/usr/bin/python
""" 
/*
 *  PyTemplate - a Simple Python Template Class
 *  Copyright (C) 2001 Giorgio Zoppi <deneb@unixwave.org>
 *
 *  This program is free software; you can redistribute it and/or modify
 *  it under the terms of the GNU General Public License as published by
 *  the Free Software Foundation; either version 2 of the License, or
 *  (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU General Public License for more details.
 *
 *  You should have received a copy of the GNU General Public License
 *  along with this program; if not, write to the Free Software
 *  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 */

This Template file was strictly ported form PHPLIB Template class.
Begin from the port:
28 May 2001

"""
import sys
import re
import os
import string

from stat import *
from types import *

class PyTemplate:
    """A simple Template class"""
    __classname='PyTemplate'
    """0 -> False, 1-> True"""
    __debug	=	1
    __root	=	os.getcwd();
    __unknowns    =       "remove"
    __file	= {}
    __varkeys     = {}
    __varvals     = {}
    __halt_on_error = "yes"
    __last_error    = ""
    
    def __init__(self,root,unknows="remove"):
        self.set_root(root)
	self.set_unknowns(unknows)
	
    def set_root(self,root):
	"""I check if the directory exists"""
	mode = os.stat(root)[ST_MODE]
	if S_ISDIR(mode):
	    """0 -> False, 1-> True"""
	    self.__root=root
	    return 1
	return 0
    def set_unknowns(self,unk):
	self.__unknowns=unk
    def set_file(self,handle,myfile=''):
        if not (type(handle) is DictType):
	    if (myfile==''):
		return 0
	    else:
		self.__file[handle]=self.__filename(myfile)
	else:
	    for (h,f) in handle.items():
		self.__file[h]=self.__filename(f)
		    
    def set_block(self,parent,handle,name=''):
	if not(self.__loadfile(parent)):
	    return 0
	if (name==''):
	    name=handle
	vstr=self.get_var(parent)
	str2 = ''
	for value in vstr:
	    str2 = str2 + value
	reg=r"<!--\s+BEGIN "+handle+"\s+-->(.*)<!--\s+END "+ handle+ "\s+-->"
	matchreg=re.compile(reg,re.S|re.M)
	m=matchreg.findall(str2)
	vname='{' + name + '}'
	vstr2=matchreg.sub(vname,str2)
	self.set_var(name,'')
	self.set_var(handle,m[0])
	self.set_var(parent,vstr2)
    
    def set_var(self,varname1,value=''):
	if not (type(varname1) is DictType):
	    self.__varkeys[varname1]=self.__varname(varname1)
	    self.__varvals[varname1]=value
	else:
	    for vname in varname1.keys():
		self.__varkeys[vname]=self.__varname(vname) 
		self.__varvals[vname]=varname1[vname]
		
	    
    def subst(self,handle):
	if not(self.__loadfile(handle)):
	    return 0
	
	vstr=self.get_var(handle)
	regstr = ''
	for values in vstr:
	    regstr= regstr + values
	vvals= self.__varvals.keys()
	kvals= self.__varkeys.keys()
	key1,key2='',''
	i,j=0,0
	len1,len2=len(vvals),len(kvals)
	while ((i<len1) and (j<len2)):
		key2 = vvals[i]
		key1 = kvals[j]
		vareg=re.compile(self.__varkeys[key1])
    		regstr=vareg.sub(self.__varvals[key2],regstr)
		i,j=i+1,j+1
	return regstr    
    def	psubst(self,handle):
	print self.subst(handle)
	return 0
    def tmpl2str(self,varname):
	return self.finish(self.get_var(varname))
    def parse(self,target,handle, append):
	if not (type(handle) is DictType):
    		vstr=self.subst(handle)
	        if (append==1):
		    mvar = self.get_var(target) + vstr
		    self.set_var(target,mvar)
		else:
		    self.set_var(target,vstr)
	else:	
		vstr = ''	
		for (hname,hvalue) in handle.items():
		    vstr=self.subst(hvalue)  
		    self.set_var(target,vstr)
	#print t.varvals	    
	return vstr
    def get_vars(self): 
	for kname in self.__varkeys.keys():
	    result[kname]=self.__varvals[kname]
	return result
    def get_var(self,varname):
        if not (type(varname) is DictType):
 	    return self.__varvals[varname]
	     
	else:
	    for vname in varname.keys():
		result[vname]=self.__varvals[vname]
	return result
    """def get_undefined --> not implemented"""	    
    def finish(self,vstr):
        regstr1=re.compile('{\[^}+}')
	if (self.__unknowns=="comment"):
	    regstr1.sub("<!--Template not defined -->",vstr)
	elif (self.__unknowns=="remove"):
	    regstr1.sub("",vstr);
	else:
	    self.__unknowns= "keep" """Nothing to do"""
	return vstr	    
    def p(self,varname):
	print self.finish(self.get_var(varname))
    def get(self,varname):
	return self.finish(self.get_var(varname))
    def __filename(self,filename):
	slice=string.find(filename,'/',0,1)
	if (slice==-1):
	    filename= self.__root + '/' + filename
	if not (os.path.isfile(filename)):
	    filename = 0
	return filename
    def __varname(self,varname1):
        var = '{' + varname1 + '}'
	return var
    def __loadfile(self,handle):
	try:
	    if ((self.__varkeys[handle]) and (not (self.__varvals[handle]==''))):
		    return 1
	except KeyError: 
	       new=1
	try:
	   name=self.__file[handle]
	except KeyError:
	    return 0
	filename= self.__filename(name)
	file=open(filename,'r')
	vstr=file.readlines()
	self.set_var(handle,vstr)
	return 1

 		    				        	    
From bl at netgroup.dk  Tue May 29 10:09:19 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:46:20 2004
Subject: [mod_python] Session data
Message-ID: <3B13592F.DB5633BB@netgroup.dk>

Hi ...

I have been trying to write a entry in the mod_python FAQ, but I'm a
quite inpatient person, so I'll ask here too :-)

I really like the way this mod_python thing works, but I have
desperately trying to find a way to store session based data, but
without luck.

Is there a way, or is it necessary to store the session data in a
separate data array, that is mapped to some kind of user Apache info ?
This could be a dumb question, as my knowledge about Apache is quite
limited, so I hope you will forgive if this should be quite obvious.


/BL


From grisha at modpython.org  Tue May 29 08:35:11 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:20 2004
Subject: [mod_python] Session data
In-Reply-To: <3B13592F.DB5633BB@netgroup.dk>
Message-ID: <Pine.BSF.4.32.0105290826550.99341-100000@localhost>

This does indeed seem to be a FAQ, but I don't know if there is a straight
answer to it.

In *my* opinion, trying to maintain state within the server is not
scalable and should be avoided. State should be maintained on the client
side with cookies and url's.

Since Apache 1.3 runs multiple processes, it is impossible to share memory
between them and therefore maintain state in the server.

But even with the new Apache 2.0 (which mod_python does not yet support),
which will be multithreaded, I would stay away from putting state on the
server. If I ever decided that my site is too busy and needs balancing
across multiple servers, I'd be in trouble... Also consider situations
when a request may never reach a server because of some cache inbewteen.

Grisha

On Tue, 29 May 2001, Bo Lorentsen wrote:

> Hi ...
>
> I have been trying to write a entry in the mod_python FAQ, but I'm a
> quite inpatient person, so I'll ask here too :-)
>
> I really like the way this mod_python thing works, but I have
> desperately trying to find a way to store session based data, but
> without luck.
>
> Is there a way, or is it necessary to store the session data in a
> separate data array, that is mapped to some kind of user Apache info ?
> This could be a dumb question, as my knowledge about Apache is quite
> limited, so I hope you will forgive if this should be quite obvious.
>
>
> /BL
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From bl at netgroup.dk  Tue May 29 14:50:28 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:46:20 2004
Subject: [mod_python] Session data
References: <Pine.BSF.4.32.0105290826550.99341-100000@localhost>
Message-ID: <3B139B14.26DF8717@netgroup.dk>

"Gregory (Grisha) Trubetskoy" wrote:

> In *my* opinion, trying to maintain state within the server is not
> scalable and should be avoided. State should be maintained on the client
> side with cookies and url's.

If this is so, shouldn't there be some sort of interface for this ? Or is
this something I should have known more about if I had known the Apache
server better ?

> Since Apache 1.3 runs multiple processes, it is impossible to share memory
> between them and therefore maintain state in the server.

Aha, so this is why the JavaServer make its own service, the Apache direct
requests to !

> But even with the new Apache 2.0 (which mod_python does not yet support),
> which will be multithreaded, I would stay away from putting state on the
> server. If I ever decided that my site is too busy and needs balancing
> across multiple servers, I'd be in trouble... Also consider situations
> when a request may never reach a server because of some cache inbewteen.

You absolutely got a point there.

I just need to gain knowledge about some other ways of maintaining session
data, as until now, I thought that a cookie were just a session reference
number of a kind.

/BL


From jvdev at 3va.net  Tue May 29 15:00:15 2001
From: jvdev at 3va.net (Jeroen van Drie)
Date: Fri Jan  9 21:46:20 2004
Subject: [mod_python] httpd dead but subsys locked
Message-ID: <01052915001503.01699@e109009>

situation:
mod_python, RH 6.2, MySQL-3.23.38-1 all RPM based.

When starting up httpd and running httpd status it returns:
httpd dead but subsys locked

No instance of httpd is found running.

When removing the two mod_python dso lines in the httpd.conf it starts up 
fine.

I have seen these errors on some php mailing lists as well where people seem 
to be relating it to the presence of mysql. There is nothign in the apache 
log file even at debug log level.

A restart of mysql did not help.

I have read that the situation in case of php will be resolved with a server 
reboot. However in this case that would be impractical.

Have any of you experienced this problem and have you found a solution?

Thanks.

From aiglauer at yahoo.com  Tue May 29 06:41:57 2001
From: aiglauer at yahoo.com (Alexis Iglauer)
Date: Fri Jan  9 21:46:20 2004
Subject: [mod_python] httpd dead but subsys locked
In-Reply-To: <01052915001503.01699@e109009>
Message-ID: <20010529134157.247.qmail@web13905.mail.yahoo.com>

My experience is under various versions of Mandrake and Apache 1.3.x.

That message usually comes if apache segfaults.  Check your /var/run
directory for httpd.pid and delete it.

Try running 'httpd -X' to see what error messages you get (often the
problem is threading support or not having the LoadModule line for
mod_python as the first LoadModule in httpd.conf).  My apache always
just crashed - with no debug info - when I loaded a .py file.

Once you have that sorted out (httpd -X runs fine), I find that
'/etc/rc.d/init.d/httpd restart' usually does the trick if you have the
'locked subsystem' error message on starting apache.

Hope this helps
ax

--- Jeroen van Drie <jvdev@3va.net> wrote:
> 
> situation:
> mod_python, RH 6.2, MySQL-3.23.38-1 all RPM based.
> 
> When starting up httpd and running httpd status it returns:
> httpd dead but subsys locked
> 
> No instance of httpd is found running.
> 
> When removing the two mod_python dso lines in the httpd.conf it
> starts up 
> fine.
> 
> I have seen these errors on some php mailing lists as well where
> people seem 
> to be relating it to the presence of mysql. There is nothign in the
> apache 
> log file even at debug log level.
> 
> A restart of mysql did not help.
> 
> I have read that the situation in case of php will be resolved with a
> server 
> reboot. However in this case that would be impractical.
> 
> Have any of you experienced this problem and have you found a
> solution?
> 
> Thanks.
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


__________________________________________________
Do You Yahoo!?
Yahoo! Auctions - buy the things you want at great prices
http://auctions.yahoo.com/

From sam at webslingerZ.com  Tue May 29 09:40:32 2001
From: sam at webslingerZ.com (Sam Brauer)
Date: Fri Jan  9 21:46:20 2004
Subject: [mod_python] Session data
In-Reply-To: <3B139B14.26DF8717@netgroup.dk>
Message-ID: <Pine.LNX.4.31.0105290917340.30341-100000@localhost.localdomain>

On Tue, 29 May 2001, Bo Lorentsen wrote:
<snip>
> I just need to gain knowledge about some other ways of maintaining session
> data, as until now, I thought that a cookie were just a session reference
> number of a kind.
>
> /BL

I think the most portable method (a method with the least
dependency on any particular webserver or application server) is to
maintain the session state in a relational database table and store the
table key value in a cookie.
When a user first hits your site, check for the cookie.
If it exists and matches a record in your table, then treat that record as
that user's session data.
Otherwise, insert a new record and set a session cookie with the key value
of the newly created record.

For applications where security is not a major concern, this method should
be sufficient.  If security is a major concern, you will want to avoid
storing the cookie value as plain text and instead encrypt it in some way.
Also, you may want to set a short expiration time for the cookie, and
perhaps reset it every time you send a response to the user.  You might
also (again, depending on the type of application) want to provide an
explicit logout function that unsets the cookie.
You could also have a field in your table that contains a timestamp that
gets updated every time a request for that session comes in.  Before
updating the field, you might compare its current value with the current
time.  If the difference is greater than some time limit (say 30 minutes),
then you could error out and respond to the user that their session has
expired.

How complicated and secure you want to make it is up to you.

Regards,
Sam Brauer



From jvdev at 3va.net  Tue May 29 16:48:31 2001
From: jvdev at 3va.net (Jeroen van Drie)
Date: Fri Jan  9 21:46:20 2004
Subject: [mod_python] httpd dead but subsys locked
In-Reply-To: <20010529134157.247.qmail@web13905.mail.yahoo.com>
References: <20010529134157.247.qmail@web13905.mail.yahoo.com>
Message-ID: <01052916483108.01699@e109009>

On Tuesday 29 May 2001 15:41 pm, you wrote:

Hi Ax,

When loading with -X i get the "
Loaded DSO modules/mod_python.so uses plain Apache 1.3 API, this module might 
crash under EAPI! (please recompile it with -DEAPI)" 
and it segfaults.

It's the first module defined in httpd.conf.

that hasn't been causing any problems on my 7.1 rh test system and from 
numerous reports I've read people generally seem to disregard the warning.

I got the sources,  edited the Makefile to run apxs with -DEAPI as an 
argument, which however caused the same error and segfault.

I would dearly like to see this issue resolved and if theres anything I can 
do to contribute towards solving it i'd be happy to contribute my time. 



> My experience is under various versions of Mandrake and Apache 1.3.x.
>
> That message usually comes if apache segfaults.  Check your /var/run
> directory for httpd.pid and delete it.
>
> Try running 'httpd -X' to see what error messages you get (often the
> problem is threading support or not having the LoadModule line for
> mod_python as the first LoadModule in httpd.conf).  My apache always
> just crashed - with no debug info - when I loaded a .py file.
>
> Once you have that sorted out (httpd -X runs fine), I find that
> '/etc/rc.d/init.d/httpd restart' usually does the trick if you have the
> 'locked subsystem' error message on starting apache.
>
> Hope this helps
> ax
>
> --- Jeroen van Drie <jvdev@3va.net> wrote:
> > situation:
> > mod_python, RH 6.2, MySQL-3.23.38-1 all RPM based.
> >
> > When starting up httpd and running httpd status it returns:
> > httpd dead but subsys locked
> >
> > No instance of httpd is found running.
> >
> > When removing the two mod_python dso lines in the httpd.conf it
> > starts up
> > fine.
> >
> > I have seen these errors on some php mailing lists as well where
> > people seem
> > to be relating it to the presence of mysql. There is nothign in the
> > apache
> > log file even at debug log level.
> >
> > A restart of mysql did not help.
> >
> > I have read that the situation in case of php will be resolved with a
> > server
> > reboot. However in this case that would be impractical.
> >
> > Have any of you experienced this problem and have you found a
> > solution?
> >
> > Thanks.
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://www.modpython.org/mailman/listinfo/mod_python
>
> __________________________________________________
> Do You Yahoo!?
> Yahoo! Auctions - buy the things you want at great prices
> http://auctions.yahoo.com/

From SumnerH at fool.com  Tue May 29 13:03:49 2001
From: SumnerH at fool.com (G . Sumner Hayes)
Date: Fri Jan  9 21:46:20 2004
Subject: [mod_python] Session data
In-Reply-To: <Pine.BSF.4.32.0105290826550.99341-100000@localhost>; from grisha@modpython.org on Tue, May 29, 2001 at 08:35:11AM -0400
References: <3B13592F.DB5633BB@netgroup.dk> <Pine.BSF.4.32.0105290826550.99341-100000@localhost>
Message-ID: <20010529130349.A17514@fool.com>

Gregory (Grisha) Trubetskoy <grisha@modpython.org> wrote:
> Since Apache 1.3 runs multiple processes, it is impossible to share memory
> between them and therefore maintain state in the server.

You can use either shared mmap or SysV shared mem (there are
python modules for both) to share memory.  I wound up writing
a Python shared dictionary (just pickles objects into the
filesystem when you set them, and unpickles them when you read
them) for my shared state, though I don't share user sessions--I
share things like parsed template files and other cacheable
server-side objects that require an expensive calculation the
first time they're read in.

Same idea would work for user sessions, and since it's in the
filesystem the kernel will take care of buffering for you and you
can use tools like "find" and "rm" to prune the cache. :-)

I agree with Grisha that you probably want to keep state on the
clients if you can, though.

  Sumner

-- 
rage, rage against the dying of the light

From CHagner at fool.com  Tue May 29 13:08:01 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:46:20 2004
Subject: [mod_python] Session data
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E47E7D@rover.foolhq.com>

In my experience, the quickest way to ensure that your web application
scales poorly is to mis-use server-side user sessions (thereby agreeing with
Grisha).  Now, that being said, not everyone needs this level of scalability
AND user sessions are a standard part of almost every-single web application
platform (ASP, Servlets/JSP, ColdFusion, etc.) commercially available.

BTW, I've found that most non-Apache-based web developers (of which I used
to be one :-) are completely ignorant of the realities of running in a
multi-process server.  They generally take for granted the user sessions
built into whatever app server they're using and find it mentally
challenging to truly believe they can live without such functionality.

I like the idea of having a standard interface to whatever mechanism is
responsible for persisting user session information, but I cringe at
incorporating an implementation with mod_python.  Basically, for some people
a pickled object will work fine.  For others a database-based session system
works best.  And some (Grisha) will only be happy with the use of
cookies/urls.

As for multiple-server user sessions, there are some solutions available in
the non-Python space (most of the ones that I've seen use either a database
(ugh :-) or a solution along the lines of Java's RMI to keep the session
pool's in sync.  In either case, it is a non-trivial problem/solution and is
best avoided (following the KISS principle).

You might want to check out WebWare (webware.sourceforge.net) as an expample
web framework that has some session support.  I think they pickle objects to
the file system.  There are some other python-based cgi frameworks that also
support user sessions, but just be aware of how far such solutions will/will
not take you.

Chris

-----Original Message-----
From: Bo Lorentsen [mailto:bl@netgroup.dk]
Sent: Tuesday, May 29, 2001 8:50 AM
To: Gregory (Grisha) Trubetskoy
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Session data


"Gregory (Grisha) Trubetskoy" wrote:

> In *my* opinion, trying to maintain state within the server is not
> scalable and should be avoided. State should be maintained on the client
> side with cookies and url's.

If this is so, shouldn't there be some sort of interface for this ? Or is
this something I should have known more about if I had known the Apache
server better ?

> Since Apache 1.3 runs multiple processes, it is impossible to share memory
> between them and therefore maintain state in the server.

Aha, so this is why the JavaServer make its own service, the Apache direct
requests to !

> But even with the new Apache 2.0 (which mod_python does not yet support),
> which will be multithreaded, I would stay away from putting state on the
> server. If I ever decided that my site is too busy and needs balancing
> across multiple servers, I'd be in trouble... Also consider situations
> when a request may never reach a server because of some cache inbewteen.

You absolutely got a point there.

I just need to gain knowledge about some other ways of maintaining session
data, as until now, I thought that a cookie were just a session reference
number of a kind.

/BL

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python

From gtalvola at nameconnector.com  Tue May 29 14:04:15 2001
From: gtalvola at nameconnector.com (Geoff Talvola)
Date: Fri Jan  9 21:46:20 2004
Subject: [mod_python] Win32 threading issue
Message-ID: <5.0.2.1.0.20010529134743.02ca2d30@infratest1>

I just wanted to confirm that I also get the same behavior on Windows -- if 
I stress out a simple script like the one below with multiple simultaneous 
requests, I get sporadic errors, just as Chris Trengove reported.

I'd be happy to help diagnose and fix the problem, but I know next to 
nothing about Apache and mod_python's internals.  I do have access to VC++ 
6.0 and I have successfully compiled the mod_python dll (for Python 2.1).

Where should I go from here?

>I have been testing the following script on Apache with mod_python (Apache
>1.13.17, mod_python 2.7.2, Windows 2000). I have been interested in testing
>the possible throughput of this (and more useful scripts), so I have
>another Python script which continually loads this "page".
>
>from mod_python import apache
>import thread
>
>def handler(req):
>     req.content_type = "text/plain"
>     req.send_http_header()
>     req.write("%d\n" % thread.get_ident())
>     return apache.OK
>
>When I run more than one copy of the driver script (in multiple consoles),
>I get behavior indicative of some threading problems. Specifically, some
>connections get "lost", the Apache error log reports various instances of
>"IOError: Write failed...", and I occassionally get an access violation
>inside Apache. Similarly, if I only run one copy of the driver script, and
>just keep hitting the refresh button in a browser, the browser
>occassionally returns TWO numbers, and sometimes reports an error in
>retrieving the data. Note that I have tested my driver program retrieving a
>simple text file, and everything works as expected, so it does not appear
>to be a problem with Apache. (The problem also goes away if I set
>ThreadPerChild to 1 in the Apache configuration.)
>
>I have also found that, if I comment out the req.write() statement in the
>handler, then there are no problems. From my examination of the
>implementation of the request object, I see that req_write() contains calls
>to Py_BEGIN_ALLOW_THREADS / Py_END_ALLOW_THREADS, whereas
>req_send_http_header() contains no such calls. This suggests to me that
>some thread switching is occurring inside req_write() which is messing with
>the state of the interpreter.
>
>I would be most grateful if anyone has any information to offer on this.
>
>Chris Trengove


--

- Geoff Talvola
   gtalvola@NameConnector.com

From trengove at econdata.com.au  Wed May 30 09:03:40 2001
From: trengove at econdata.com.au (Chris Trengove)
Date: Fri Jan  9 21:46:20 2004
Subject: [mod_python] Re: Win32 threading issue
In-Reply-To: <5.0.2.1.0.20010529134743.02ca2d30@infratest1>
Message-ID: <200105300905630.SM00248@athene>

Geoff,

This problem has now been fixed, and I expect will be part of mod_python
2.7.4 when Grisha decides to release that. In the mean time, if you have a
desperate need to avoid the threading problem, you can access the modified
files in the CVS.

Chris

At 02:04 PM 29/05/2001 -0400, Geoff Talvola wrote:
>I just wanted to confirm that I also get the same behavior on Windows -- if 
>I stress out a simple script like the one below with multiple simultaneous 
>requests, I get sporadic errors, just as Chris Trengove reported.
>
>I'd be happy to help diagnose and fix the problem, but I know next to 
>nothing about Apache and mod_python's internals.  I do have access to VC++ 
>6.0 and I have successfully compiled the mod_python dll (for Python 2.1).
>
>Where should I go from here?
>

>- Geoff Talvola
>   gtalvola@NameConnector.com
> 

From djc at object-craft.com.au  Wed May 30 10:23:48 2001
From: djc at object-craft.com.au (Dave Cole)
Date: Fri Jan  9 21:46:20 2004
Subject: [mod_python] Session data
In-Reply-To: "Gregory's message of "Tue, 29 May 2001 08:35:11 -0400 (EDT)"
References: <Pine.BSF.4.32.0105290826550.99341-100000@localhost>
Message-ID: <m3elt74rcb.fsf@vole.object-craft.com.au>

>>>>> "Gregory" == Gregory (Grisha) Trubetskoy <grisha@modpython.org> writes:

Gregory> This does indeed seem to be a FAQ, but I don't know if there
Gregory> is a straight answer to it.

Gregory> In *my* opinion, trying to maintain state within the server
Gregory> is not scalable and should be avoided. State should be
Gregory> maintained on the client side with cookies and url's.

Your choice of how to retain session state depends entirely on the
type of application you are building.

Gregory> Since Apache 1.3 runs multiple processes, it is impossible to
Gregory> share memory between them and therefore maintain state in the
Gregory> server.

That is not strictly true.  If you wish to retain state at the server,
you have to write some code.  You can either save state in some sort
of database (not necessarily relational) at the server, or you can
build a session server and cache connections to the server in your
mod_python program.

- Dave

-- 
http://www.object-craft.com.au


From gtalvola at nameconnector.com  Tue May 29 20:28:49 2001
From: gtalvola at nameconnector.com (Geoff Talvola)
Date: Fri Jan  9 21:46:20 2004
Subject: [mod_python] Re: Win32 threading issue
In-Reply-To: <200105300905630.SM00248@athene>
References: <5.0.2.1.0.20010529134743.02ca2d30@infratest1>
Message-ID: <5.0.2.1.0.20010529202540.034332c0@infratest1>

Great!  I love it when bugs have already been fixed.

Grisha, are you planning on releasing 2.7.4 any time soon?  If so, I'll 
just wait for it to be released.


At 09:03 AM 5/30/01 +1000, Chris Trengove wrote:
>Geoff,
>
>This problem has now been fixed, and I expect will be part of mod_python
>2.7.4 when Grisha decides to release that. In the mean time, if you have a
>desperate need to avoid the threading problem, you can access the modified
>files in the CVS.
>
>Chris
>
>At 02:04 PM 29/05/2001 -0400, Geoff Talvola wrote:
> >I just wanted to confirm that I also get the same behavior on Windows -- if
> >I stress out a simple script like the one below with multiple simultaneous
> >requests, I get sporadic errors, just as Chris Trengove reported.
> >
> >I'd be happy to help diagnose and fix the problem, but I know next to
> >nothing about Apache and mod_python's internals.  I do have access to VC++
> >6.0 and I have successfully compiled the mod_python dll (for Python 2.1).
> >
> >Where should I go from here?
> >
>
> >- Geoff Talvola
> >   gtalvola@NameConnector.com
> >

--

- Geoff Talvola
   gtalvola@NameConnector.com

From bl at netgroup.dk  Thu May 31 09:07:33 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:46:20 2004
Subject: [mod_python] Session data
References: <3B13592F.DB5633BB@netgroup.dk> <Pine.BSF.4.32.0105290826550.99341-100000@localhost> <20010529130349.A17514@fool.com>
Message-ID: <3B15EDB5.7E8D811B@netgroup.dk>

"G . Sumner Hayes" wrote:

> You can use either shared mmap or SysV shared mem (there are
> python modules for both) to share memory.  I wound up writing
> a Python shared dictionary (just pickles objects into the
> filesystem when you set them, and unpickles them when you read
> them) for my shared state, though I don't share user sessions--I
> share things like parsed template files and other cacheable
> server-side objects that require an expensive calculation the
> first time they're read in.

How about performance ? Is'nt it expensive accessing file in a dir. for shared
data, I mean, you have to reload it if its RW data, or is it write ones read
many (it sounds like it) ?

> Same idea would work for user sessions, and since it's in the
> filesystem the kernel will take care of buffering for you and you
> can use tools like "find" and "rm" to prune the cache. :-)

Hmm, If I like to change user session data offen, I quess I would go for the
"shared mem" solution.

> I agree with Grisha that you probably want to keep state on the
> clients if you can, though.

This is not possible, as  the state, in my case, is a lot of database keys, and
other internal information for navigating a database.

/BL


From bl at netgroup.dk  Thu May 31 09:26:49 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:46:20 2004
Subject: [mod_python] Session data
References: <Pine.BSF.4.32.0105290826550.99341-100000@localhost> <m3elt74rcb.fsf@vole.object-craft.com.au>
Message-ID: <3B15F239.F158F917@netgroup.dk>

Dave Cole wrote:

> Gregory> Since Apache 1.3 runs multiple processes, it is impossible to
> Gregory> share memory between them and therefore maintain state in the
> Gregory> server.
>
> That is not strictly true.  If you wish to retain state at the server,
> you have to write some code.  You can either save state in some sort
> of database (not necessarily relational) at the server, or you can
> build a session server and cache connections to the server in your
> mod_python program.

Anyway, this would be nice to have in the FAQ.

When I startet to look into mod_python, I did compare with JavaServer, and found
that this "session thing" were missing, and Gregory's comment about scalling
helped me undestand that the JavaServer solution were not always sufficient.

> http://www.object-craft.com.au

Ahh, yet another Rating expert :-)

/BL


From bl at netgroup.dk  Thu May 31 09:40:27 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:46:20 2004
Subject: [mod_python] Session data
References: <13CDDE6A53DBD311BC3200508B6F0C4805E47E7D@rover.foolhq.com>
Message-ID: <3B15F56B.67DF1D35@netgroup.dk>

Chris Hagner wrote:

> In my experience, the quickest way to ensure that your web application
> scales poorly is to mis-use server-side user sessions (thereby agreeing with
> Grisha).  Now, that being said, not everyone needs this level of scalability
> AND user sessions are a standard part of almost every-single web application
> platform (ASP, Servlets/JSP, ColdFusion, etc.) commercially available.

This is the danger of the JavaServer/PHP approach, not been aware of this.

> BTW, I've found that most non-Apache-based web developers (of which I used
> to be one :-) are completely ignorant of the realities of running in a
> multi-process server.  They generally take for granted the user sessions
> built into whatever app server they're using and find it mentally
> challenging to truly believe they can live without such functionality.

Again, the tools they are using gives them this impression, or at least support
there view of the world. And then we have the same problem with ex. ASP as we
have with RAD tools --- the level of insight and experience.

> As for multiple-server user sessions, there are some solutions available in
> the non-Python space (most of the ones that I've seen use either a database
> (ugh :-) or a solution along the lines of Java's RMI to keep the session
> pool's in sync.  In either case, it is a non-trivial problem/solution and is
> best avoided (following the KISS principle).

Or even a CORBA version to keep the real-time aspect :-)

> You might want to check out WebWare (webware.sourceforge.net) as an expample
> web framework that has some session support.  I think they pickle objects to
> the file system.  There are some other python-based cgi frameworks that also
> support user sessions, but just be aware of how far such solutions will/will
> not take you.

I would be nervous about the performance and the real-time aspect by using the
file system approach, but thanks for the advise, I will look into it.

/BL


From SumnerH at fool.com  Thu May 31 12:09:37 2001
From: SumnerH at fool.com (G . Sumner Hayes)
Date: Fri Jan  9 21:46:20 2004
Subject: [mod_python] Session data
In-Reply-To: <3B15EDB5.7E8D811B@netgroup.dk>; from bl@netgroup.dk on Thu, May 31, 2001 at 09:07:33AM +0200
References: <3B13592F.DB5633BB@netgroup.dk> <Pine.BSF.4.32.0105290826550.99341-100000@localhost> <20010529130349.A17514@fool.com> <3B15EDB5.7E8D811B@netgroup.dk>
Message-ID: <20010531120937.A24124@fool.com>

Bo Lorentsen <bl@netgroup.dk> wrote:
> > You can use either shared mmap or SysV shared mem (there are
> > python modules for both) to share memory.  I wound up writing
> > a Python shared dictionary (just pickles objects into the
> > filesystem when you set them, and unpickles them when you read
> > them)
> 
> How about performance ? Is'nt it expensive accessing file in a
> dir. for shared data, I mean, you have to reload it if its RW
> data, or is it write ones read many (it sounds like it) ?

I can write about 3000 entries to the dictionary per second.  I
can read about 8000 entries from the dictionary per second.  This
is with SMP-safe locking, but running on a uniprocessor (600 Mhz
PIII).  This is tha naive 30 minute implentation without any C
extensions or anything.

Most of the time is spent pickling, fs access is _really_ fast
on a decent operating system (e.g. Linux, FreeBSD).  If you're
storing really large objects, the pickling may take longer.

If you're storing a lot of items (more than a few thousands) use
the regular db-in-fs options (nested directories with a few 1000
files each or a btree filesystem like ReiserFS).

> > Same idea would work for user sessions, and since it's in the
> > filesystem the kernel will take care of buffering for you and
> > you can use tools like "find" and "rm" to prune the cache.
> > :-)
>
> Hmm, If I like to change user session data offen, I quess I
> would go for the "shared mem" solution.

I tried it when I first implemented the thing , the timing was
similar (within 2-3%).  Which makes sense, because the time to
pickle is dominating anyway.  Bear in mind that the fs cache is
going to keep all your recently accessed files in RAM anyway.

If you do it in the fs, the implementation is much simpler-- you
need to build a balanced tree or hash table in SHM to get good
performance with more than 20-30 items in the database.  And
you're not as portable.  The key for me, though, was that being
able to play with the cache w/ regular user tools and assign
permissions per-item can be extremely useful.

  Sumner

From paullb at bigfoot.com  Thu May 31 21:23:50 2001
From: paullb at bigfoot.com (Brendan Paull)
Date: Fri Jan  9 21:46:20 2004
Subject: [mod_python] Compiling and installing mod_python-2.7.3
Message-ID: <5.0.2.1.2.20010531211720.00a02220@pop.minet.ca>

Hi,
	I am having a little trouble getting my mod_python to work.

This is the error I get:
[root@BCMP mod_python-2.7.3]# httpd
Syntax error on line 208 of /etc/httpd/conf/httpd.conf:
Cannot load /usr/lib/apache/mod_python.so into server: undefined symbol: 
pthread_create
[root@BCMP mod_python-2.7.3]#


These are the lines that I added to /etc/httpd/conf/httpd.conf:
208->  LoadModule python_module      /usr/lib/apache/mod_python.so #first 
one in the list
272->AddModule mod_python.c

333-337->
<Directory /var/www/html/python>
   AddHandler python-program .py
   PythonHandler mptest
   PythonDebug On
</Directory>


I have included a transcipt of everything that happens as I try to install 
at the end of the message, my system is a RedHat 7.0 and I have apache 1.3 
installed and python 2.1 which works from command line.

I would really appreciate any advice or tips at all.


[root@BCMP mod_python-2.7.3]# ./configure
loading cache ./config.cache
checking for gcc... (cached) gcc
checking whether the C compiler (gcc  ) works... yes
checking whether the C compiler (gcc  ) is a cross-compiler... no
checking whether we are using GNU C... (cached) yes
checking whether gcc accepts -g... (cached) yes
checking for ranlib... (cached) ranlib
checking for ar... (cached) ar
checking for a BSD compatible install... (cached) /usr/bin/install -c
checking whether make sets ${MAKE}... (cached) no
checking for main in -lm... (cached) yes
checking for working const... (cached) yes
checking your blood pressure... a bit high, but we can proceed
checking whether apxs is available
checking for --with-apxs... no
checking for apxs in /usr/local/apache/sbin... no
checking for apxs in your PATH... checking for apxs... (cached) /usr/sbin/apxs
found /usr/sbin/apxs, we'll use this. Use --with-apxs to specify another.
checking for Apache libexec directory... /usr/lib/apache
checking for Apache include directory... -I/usr/include/apache
checking for --with-apache... no
configure: warning: **** No apache sources specified, static compilation 
will not be available.
configure: warning: **** You can use --with-apache to specify where your 
Apache sources are.
checking for --with-python... no
checking for python... (cached) /usr/bin/python
checking Python version... 2.1
checking whether Python is compiled with thread support... yes

   ****** WARNING ******
   Python is compiled with thread support. Apache 1.3 does not use threads.
   On some systems this will cause problems during compilation, on others
   it may result in unpredictable behaviour of your Apache server. Yet on
   others it will work just fine. The recommended approach is to compile
   Python without thread support in a separate location and specify it with
   --with-python option to this ./configure script.

checking Python install prefix... /usr
checking what libraries Python was linked with... 
/usr/lib/python2.1/config/libpython2.1.a
checking linker flags used to link Python...
checking where Python include files are... -I/usr/include/python2.1
checking for mkdep... (cached) /usr/X11R6/bin/makedepend
creating ./config.status
creating Makefile
creating src/Makefile
creating src/libpython.module
creating Doc/Makefile
analyzing dependencies
[root@BCMP mod_python-2.7.3]# make
make[1]: Entering directory `/root/mod_python-2.7.3/src'
make[1]: Leaving directory `/root/mod_python-2.7.3/src'
[root@BCMP mod_python-2.7.3]# make install
make[1]: Entering directory `/root/mod_python-2.7.3'
make[2]: Entering directory `/root/mod_python-2.7.3/src'
make[2]: Leaving directory `/root/mod_python-2.7.3/src'

Performing DSO installation.

/usr/bin/install -c src/mod_python.so /usr/lib/apache
make[2]: Entering directory `/root/mod_python-2.7.3'
/usr/bin/install -c -d /usr/lib/python2.1/site-packages/mod_python
python /usr/lib/python2.1/compileall.py 
/usr/lib/python2.1/site-packages/mod_python
Listing /usr/lib/python2.1/site-packages/mod_python ...
Compiling /usr/lib/python2.1/site-packages/mod_python/__init__.py ...
Compiling /usr/lib/python2.1/site-packages/mod_python/apache.py ...
Compiling /usr/lib/python2.1/site-packages/mod_python/cgihandler.py ...
Compiling /usr/lib/python2.1/site-packages/mod_python/httpdapi.py ...
Compiling /usr/lib/python2.1/site-packages/mod_python/publisher.py ...
Compiling /usr/lib/python2.1/site-packages/mod_python/util.py ...
Compiling /usr/lib/python2.1/site-packages/mod_python/zhandler.py ...
make[2]: Leaving directory `/root/mod_python-2.7.3'

Now don't forget to edit your main config and add
     LoadModule python_module /usr/lib/apache/mod_python.so
and if your configuration uses ClearModuleList, then also
     AddModule mod_python.c

make[1]: Leaving directory `/root/mod_python-2.7.3'




From dado at wildbrain.com  Tue May  1 16:09:44 2001
From: dado at wildbrain.com (Dado Feigenblatt)
Date: Fri Jan  9 21:52:21 2004
Subject: [mod_python] mod_python and databases.
Message-ID: <3AEF4238.599ACFE2@wildbrain.com>

Hi there.

New to the list. New to mod_python.

I have a bunch of questions, but please, I'm not trying to start a flame
war.

I need to put up a database with access from different platforms.
So far I got this (which might change as my research continues):

The DB server will be (for now) PostgreSQL.
Users will be on different machines: SGIs, Intel/Linux, Macintoshes, and
maybe some Windows boxes.
At first I thought of doing the interface entirely web based, for
portability sake, using PHP (which I don't know)
Then, it hit me that this database will be accessed not only by humans
but by applications runing on some sort of UN*X like machine, and maybe
others (Mac/Win).
We have a lot of little apps and "glue" written in python.
So, we'll have to write some DB modules to interface with our DB and
other apps.
Then it hit me again, if we'll have to write a lot of that stuff in
python, maybe I should discard PHP and just go for python.
That's how I got to mod_python.
But this database will be internal only. Do I need a webserver with
mod_python for that?
Python has nice GUI toolkits. Can't I just do it in Python/Tk or
wxPython?
Why should I use mod_python?

Thanks.


--
Dado Feigenblatt                                 Wild Brain, Inc.
Technical Director                               (415) 553-8000 x???
dado@wildbrain.com                               San Francisco, CA.




From kees.serier at relan.nl  Wed May  2 13:00:15 2001
From: kees.serier at relan.nl (Serier, Kees)
Date: Fri Jan  9 21:52:22 2004
Subject: [mod_python] problems configuring mod_python on AIX.
Message-ID: <AA2536FEE0A9D311887000508B5EDF1E01C2BBED@ab00s003.abab.cadans.nl>

Hello,

I'm trying to build apache with mod_python, but the configure script gives
some errors (lookup at the 1) and 2) in the configure ouput below:  *
Mod_python):
- 1) It seems that it can't find @sbindir@/httpd but it is both in:
     -rwxr-xr-x   1 root     beheer   1200657 Mar 15 09:58
/usr/local/apache/bin/httpd
     -rwxr-xr-x   1 root     beheer   1200657 Mar 15 09:58
/usr/local/apache/sbin/httpd
     and works just fine.
     Passing --sbindir=/usr/local/apache/sbin to the configure scripts
     doesn't help.				     
     /usr/local/apache/libexec exists but is empty
- 2) allthough I use --with-pythonn==/usr/local/src/Python-2.0, configure
     still wants to use python 1.5.2
And yes, it is right about the bloodpresure ;-)

Can anybody give me a tip?

Thanks in advance,

Kees Serier mailto:kees.serier@ordina.nl

* General information:
   AIX        4.2.1
   GCC        2.95.2 (locally build and installed from source)
   GNU-make   3.79.1 (locally build and installed from source)
   Python     2.0    (locally build and installed from source)
   Apache     1.3.19 (locally build and installed from source with DSO)
   Mod_python 2.7.2

  Apache is (default) installed in /usr/local/apache
    source in /usr/local/src/apache_1.3.19
    /usr/local/apache/sbin did was not installed with the default
    installation, I created it making a full copy from /usr/local/apache/bin
    the configure script there finds the apxs utility.
  Python is (default) installed in /usr/local/python
    source in /usr/local/src/Python-2.0
   
  Apache and Python are being used with CGI and MySQL.

* Mod_python:
   source in /usr/local/src/mod_python-2.7.2
   
   [/usr/local/src/mod_python-2.7.2]# ./configure
--with-python=/usr/local/src/Python-2.0
--with-apache=/usr/local/src/apache_1.3.19 --sbindir=/usr/local/apache/sbin
   This gives the following output:
   
   loading cache ./config.cache
   checking for gcc... (cached) gcc
   checking whether the C compiler (gcc  ) works... yes
   checking whether the C compiler (gcc  ) is a cross-compiler... no
   checking whether we are using GNU C... (cached) yes
   checking whether gcc accepts -g... (cached) yes
   checking for ranlib... (cached) ranlib
   checking for ar... (cached) ar
   checking for a BSD compatible install... ./install-sh -c
   checking whether make sets ${MAKE}... (cached) yes
   checking for main in -lm... (cached) yes
   checking for working const... (cached) yes
   checking your blood pressure... a bit high, but we can proceed
   checking whether apxs is available
   checking for --with-apxs... no
   checking for apxs in /usr/local/apache/sbin... found, we'll use this. Use
--with-apxs to specify another.
1) checking for Apache libexec directory... apxs:Error: @sbindir@/httpd not
found or not executable
   
1) checking for Apache include directory... apxs:Error: @sbindir@/httpd not
found or not executable
   -I
   checking for --with-apache... /usr/local/src/apache_1.3.19
   checking for --with-python... /usr/local/src/Python-2.0
2) checking for python... (cached) /usr/local/src/Python-1.5.2/python
2) checking Python version... ./configure[1310]:
/usr/local/src/Python-1.5.2/python:  not found
   
2) checking whether Python is compiled with thread support...
./configure[1316]: /usr/local/src/Python-1.5.2/python:  not found
   no threads, good
2) checking Python install prefix... ./configure[1335]:
/usr/local/src/Python-1.5.2/python:  not found
   
   checking what libraries Python was linked with...
/usr/local/src/Python-2.0/libpython.a   -ldl  -lpthreads   -lm
-lreadline -ltermcap                      -L/usr/local/lib -ltk8.0 -ltcl8.0
-L/usr/lib/X11 -lld -lX11   -lcurses -ltermcap       -L$(exec_prefix)/lib
-lz 
   checking linker flags used to link Python...  -Wl,-bE:python.exp -lld  
   checking where Python include files are... -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include
   checking for mkdep... (cached) /usr/bin/X11/makedepend
   creating ./config.status
   creating Makefile
   creating src/Makefile
   creating src/libpython.module
   creating Doc/Makefile
   analyzing dependencies
-- end of message


From linux at mensagero.com.br  Wed May  2 12:19:13 2001
From: linux at mensagero.com.br (Linux)
Date: Fri Jan  9 21:52:22 2004
Subject: [mod_python] could not import mod_python.apache
Message-ID: <002f01c0d31b$3f53ad00$0300000a@mensagero.int.br>

Hello friends:)

I use apache 1.3.14, python 1.5.2, in a box (linux) Conectiva 6.0 - a RedHat
like linux.
I install mod_python 2.7.1-1.

When I open a directory example in a browser, I got a error 500. The
error_log of apache sais:

make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
[Wed May  2 12:04:41 2001] [error] [client XXX.XXX.XXX.XXX] python_handler:
make_obcallback returned no obCallBack!

Something is wrong, and my poor knowledge about python is not help.

In http.conf

<IfModule mod_python.c>
  Alias /mod_python/ /var/www/mod_python_test/
  <Directory /var/www/mod_python_test>
    AllowOverride FileInfo
  </Directory>
</IfModule>

In .htaccess

SetHandler python-program
PythonHandler pythonhandler

In pythonhandler.py

from mod_python import apache

def handler(req):
    req.send_http_header()
    req.write("Hello to the World from "+req.uri+"!")
    return apache.OK

tanks for any help.

in time: my english is poor, but my soul is better :)
----
Julio Cesar J Melati
Administrador de Redes

http://www.mensagero.com.br
falecom@mensagero.com.br


From db8coach at hotmail.com  Wed May  2 16:55:48 2001
From: db8coach at hotmail.com (Bryon G)
Date: Fri Jan  9 21:52:22 2004
Subject: [mod_python] mod_python vs. aolserver/pywx and postgresql
Message-ID: <LAW2-F133oHMwVN7miR0000d673@hotmail.com>

I am a student at ArsDigita University.  We recently did Phil Greenspun's 
database-backed website course, and made the decision early on to learn and 
use Python to do the class (instead of the non-free .net tools Philip was 
pushing).  We had to decide on a database and a web server, and originally 
started with mod-python and postgres using pg to glue them together, but we 
eventually  switched to aolserver and pywx.  There were two reasons:

1. our instructors were more familiar with AOLserver
2. AOLServer has database connection pooling built in.

The second reason is probably the one which will be relevant to you.  If 
it's possible/easy to do this with modpython/apache, I'd love to know about 
it because I'd prefer to use apache since it's so much more common, but in 
the *very* limited time we had to do the project we found more and better 
documentation (albeit translated from the C api documentation) for the pywx 
way than for the mod python way.

I explored a few other options before we made the switch, such as the pgpool 
module at the vaults (which people seem to be using with mod-fast-cgi, if 
anyone is using it with mod-python I'd love to hear about it), but since we 
were able to get going faster with aolserver that's what we used.

The syntax for the AOLServer database access stuff was, in my opinion, 
harder to learn than the pg way largely because there was less documentation 
available, but once that was out of the way the pooling question seemed to 
be the only real difference between the two in terms of end performance.

Bryon

ps- in case you are wondering, our project was to automate the 
secondarysources.com website for college debaters.  The project is not up on 
the internet yet, and probably won't be for a few months, so unfortunately I 
can't point you to it yet, but if anyone's interested I can post the code we 
wrote somewhere.
_________________________________________________________________
Get your FREE download of MSN Explorer at http://explorer.msn.com


From mhagger at alum.mit.edu  Wed May  2 19:35:31 2001
From: mhagger at alum.mit.edu (Michael Haggerty)
Date: Fri Jan  9 21:52:22 2004
Subject: [mod_python] mod_python vs. aolserver/pywx and postgresql
In-Reply-To: "Bryon G"'s message of "Wed, 02 May 2001 16:55:48 -0000"
References: <LAW2-F133oHMwVN7miR0000d673@hotmail.com>
Message-ID: <m2lmoftjcs.fsf@freak.kaiserty.com>

"Bryon G" <db8coach@hotmail.com> writes:
> The syntax for the AOLServer database access stuff was, in my
> opinion, harder to learn than the pg way largely because there was
> less documentation available, but once that was out of the way the
> pooling question seemed to be the only real difference between the
> two in terms of end performance.

I'm hope nobody is offended that I follow up with a comment about PyWX
on this mailing list...

With PyWX you don't have to limit yourself to the AOLserver database
API to get connection caching.  (In fact, I don't use it myself.)  The
latest version of PyWX has a single-interpreter, multiple-thread mode
with which you could open, for example, multiple pg database
connections on startup and store them in a pool.  Individual scripts
would grab a connection from the pool, use it, clear it out, and
return it to the pool to be reused.  Of course this is predicated on
pg and your pool code being thread-safe.

Once multithreaded Apache is out, similar tricks should be possible in
the Apache world.

Michael

-- 
Michael Haggerty
mhagger@alum.mit.edu

From bbhaydon at bigpond.com  Thu May  3 11:32:03 2001
From: bbhaydon at bigpond.com (Brett Haydon)
Date: Fri Jan  9 21:52:22 2004
Subject: [mod_python] RE: mod_python and databases
In-Reply-To: <200105021601.f42G1L243366@eden.ispol.com>
Message-ID: <NCBBKMABOKFCDLPIKKGIAEPCCCAA.bbhaydon@bigpond.com>

You could do it with any of those nice GUI toolkits.
modpython is only going to be useful if you want the
browser/web page to be the GUI.

It really goes back to the argument of server side
v client side. Do you want to install a GUI client
on every machine?? Do you need the bells & whistles of
a GUI or is a web interface sufficient? Which is faster
to develop for you? etc.

Brett


From dsavitsk at midway.uchicago.edu  Fri May  4 00:35:02 2001
From: dsavitsk at midway.uchicago.edu (douglas savitsky)
Date: Fri Jan  9 21:52:22 2004
Subject: [mod_python] Win2k httpd.conf problems
Message-ID: <988954502.3af23f8680258@webmail.uchicago.edu>

hi there,

i am having trouble getting started, and could use some help.
Win2k, Apache 1.3.14, mod_python 2.7.2, ActivePython 2.0.

I am unable to configure things, and i get the error:
-------------------------
Mod_python error: "PythonHandler test"

Traceback (most recent call last):

  File "c:\program files\python20\lib\mod_python\apache.py", line 180, in 
Dispatch
    object = resolve_object(self.req, module, object_str, silent)

  File "c:\program files\python20\lib\mod_python\apache.py", line 396, in 
resolve_object
    raise AttributeError, s

AttributeError: module 'c:\program files\python20\lib\test\__init__.pyc' 
contains no 'handler'
-------------------------

I saw a reference to this here
http://www.modpython.org/pipermail/mod_python/2001-February/001163.html
but i don't know what the answer means ...

as far as set up, here is what i have done ...

1. put the .dll where it goes.  that part seems okay.
2. add the line 'LoadModule python_module modules/mod_python.dll' which also 
seems fine
3. copy all of the .py files from 
..\python20\lib\mod_python-2.7.2\lib\python\mod_python\*.py to 
..\python20\lib\mod_python\*.py
[if i put them elsewhere i get other erros]
4. make changes to the httpd.conf file so it looks like this
<IfModule mod_alias.c>
    Alias /icons/ "C:/Apache/icons/"
    <Directory "C:/Apache/icons">
        Options Indexes MultiViews
        AllowOverride None
        Order allow,deny
        Allow from all
    </Directory>
    ScriptAlias /cgi-bin/ "C:/Apache/cgi-bin/"
    <Directory "C:/Apache/cgi-bin">
        AllowOverride None
        Options None
        Order allow,deny
        Allow from all
    </Directory>
    <Directory "C:/Apache/cgi-bin">
        AddHandler python-program .py
        PythonHandler test
        PythonDebug on
    </Directory>
</IfModule>

thanks for any help.  i am coming over from iis/asp world, so i have no apache 
experience either.

doug

From trengove at econdata.com.au  Sun May  6 15:07:53 2001
From: trengove at econdata.com.au (Chris Trengove)
Date: Fri Jan  9 21:52:22 2004
Subject: [mod_python] Win32 threading issue
Message-ID: <200105061509919.SM00265@athene>

I have been testing the following script on Apache with mod_python (Apache
1.13.17, mod_python 2.7.2, Windows 2000). I have been interested in testing
the possible throughput of this (and more useful scripts), so I have
another Python script which continually loads this "page".

from mod_python import apache
import thread

def handler(req):
    req.content_type = "text/plain"
    req.send_http_header()
    req.write("%d\n" % thread.get_ident())
    return apache.OK

When I run more than one copy of the driver script (in multiple consoles),
I get behavior indicative of some threading problems. Specifically, some
connections get "lost", the Apache error log reports various instances of
"IOError: Write failed...", and I occassionally get an access violation
inside Apache. Similarly, if I only run one copy of the driver script, and
just keep hitting the refresh button in a browser, the browser
occassionally returns TWO numbers, and sometimes reports an error in
retrieving the data. Note that I have tested my driver program retrieving a
simple text file, and everything works as expected, so it does not appear
to be a problem with Apache. (The problem also goes away if I set
ThreadPerChild to 1 in the Apache configuration.)

I have also found that, if I comment out the req.write() statement in the
handler, then there are no problems. From my examination of the
implementation of the request object, I see that req_write() contains calls
to Py_BEGIN_ALLOW_THREADS / Py_END_ALLOW_THREADS, whereas
req_send_http_header() contains no such calls. This suggests to me that
some thread switching is occurring inside req_write() which is messing with
the state of the interpreter.

I would be most grateful if anyone has any information to offer on this.

Chris Trengove


From marcf at becomm.com  Mon May  7 02:41:30 2001
From: marcf at becomm.com (Marc Fiuczynski)
Date: Fri Jan  9 21:52:22 2004
Subject: [mod_python] Win32 threading issue
Message-ID: <A9DFD9380C01D4118E740050DA7A8970386320@becomm-mis2.becomm.com>

A random shot in the dark...

are you using a multithreaded version of the python interpreter?  If so,
then that might be the cause of your problem.   Somewhere in the mod_python
documentation I read that apache would get confused if you used a
multithreaded version of python.  Check that and please let us (or at least
me) know.

In terms of throughput, you might also try writing a script using "wget" to
measure the number of requests per second you can run (not sure what the
windows equivalent is, or whether you can get it to work with cygwin).

Cheers,
Marc


> -----Original Message-----
> From: Chris Trengove [mailto:trengove@econdata.com.au]
> Sent: Saturday, May 05, 2001 10:08 PM
> To: mod_python@modpython.org
> Subject: [mod_python] Win32 threading issue
> 
> 
> I have been testing the following script on Apache with 
> mod_python (Apache
> 1.13.17, mod_python 2.7.2, Windows 2000). I have been 
> interested in testing
> the possible throughput of this (and more useful scripts), so I have
> another Python script which continually loads this "page".
> 
> from mod_python import apache
> import thread
> 
> def handler(req):
>     req.content_type = "text/plain"
>     req.send_http_header()
>     req.write("%d\n" % thread.get_ident())
>     return apache.OK
> 
> When I run more than one copy of the driver script (in 
> multiple consoles),
> I get behavior indicative of some threading problems. 
> Specifically, some
> connections get "lost", the Apache error log reports various 
> instances of
> "IOError: Write failed...", and I occassionally get an access 
> violation
> inside Apache. Similarly, if I only run one copy of the 
> driver script, and
> just keep hitting the refresh button in a browser, the browser
> occassionally returns TWO numbers, and sometimes reports an error in
> retrieving the data. Note that I have tested my driver 
> program retrieving a
> simple text file, and everything works as expected, so it 
> does not appear
> to be a problem with Apache. (The problem also goes away if I set
> ThreadPerChild to 1 in the Apache configuration.)
> 
> I have also found that, if I comment out the req.write() 
> statement in the
> handler, then there are no problems. From my examination of the
> implementation of the request object, I see that req_write() 
> contains calls
> to Py_BEGIN_ALLOW_THREADS / Py_END_ALLOW_THREADS, whereas
> req_send_http_header() contains no such calls. This suggests 
> to me that
> some thread switching is occurring inside req_write() which 
> is messing with
> the state of the interpreter.
> 
> I would be most grateful if anyone has any information to 
> offer on this.
> 
> Chris Trengove
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 

From trengove at econdata.com.au  Mon May  7 21:21:32 2001
From: trengove at econdata.com.au (Chris Trengove)
Date: Fri Jan  9 21:52:22 2004
Subject: [mod_python] Win32 threading issue
In-Reply-To: <A9DFD9380C01D4118E740050DA7A8970386320@becomm-mis2.becomm.
 com>
Message-ID: <200105072122310.SM00265@athene>

Marc,

Yes, as I understand things, this should be the multithreaded version,
since this is how Python is built for Win32. (I am running the BeOpen 2.0
version of Python.) But my reading of the mod_python documentation is that
mod_python under Win32 is "thread safe", to the extent that it allocates a
new Python thread for each new Apache thread, and does the appropriate
things to make sure that the threads co-exist peacefully.

As for measuring throughput, my script does that quite successfully - if I
only run one copy. The point is that this test environment exposes the
threading problem far more quickly than in a production environment, where
the conflict might occur much less often, and much less predictably.

Chris

At 02:41 AM 7/05/2001 -0700, Marc Fiuczynski wrote:
>A random shot in the dark...
>
>are you using a multithreaded version of the python interpreter?  If so,
>then that might be the cause of your problem.   Somewhere in the mod_python
>documentation I read that apache would get confused if you used a
>multithreaded version of python.  Check that and please let us (or at least
>me) know.
>
>In terms of throughput, you might also try writing a script using "wget" to
>measure the number of requests per second you can run (not sure what the
>windows equivalent is, or whether you can get it to work with cygwin).
>
>Cheers,
>Marc
>


From stephane.bidoul at softwareag.com  Mon May  7 13:22:42 2001
From: stephane.bidoul at softwareag.com (=?iso-8859-1?Q?St=E9phane_Bidoul?=)
Date: Fri Jan  9 21:52:22 2004
Subject: [mod_python] Win32 threading issue
In-Reply-To: <A9DFD9380C01D4118E740050DA7A8970386320@softwareag.com>
Message-ID: <000001c0d70d$064b9fe0$4eb3bd9d@softwareag.com>

> are you using a multithreaded version of the python 
> interpreter?  If so,
> then that might be the cause of your problem.   Somewhere in 
> the mod_python
> documentation I read that apache would get confused if you used a
> multithreaded version of python.  Check that and please let 
> us (or at least
> me) know.

I think this is true for *nix, but on windows,
you *must* use a multithreaded python.

I'll try to have a look at your issue, but I've very
few time available these days.

-sbi

> -----Original Message-----
> From: mod_python-admin@modpython.org
> [mailto:mod_python-admin@modpython.org]On Behalf Of Marc Fiuczynski
> Sent: 07 May, 2001 11:42
> To: 'Chris Trengove'; mod_python@modpython.org
> Subject: RE: [mod_python] Win32 threading issue
> 
> 
> A random shot in the dark...
> 
> are you using a multithreaded version of the python 
> interpreter?  If so,
> then that might be the cause of your problem.   Somewhere in 
> the mod_python
> documentation I read that apache would get confused if you used a
> multithreaded version of python.  Check that and please let 
> us (or at least
> me) know.
> 
> In terms of throughput, you might also try writing a script 
> using "wget" to
> measure the number of requests per second you can run (not 
> sure what the
> windows equivalent is, or whether you can get it to work with cygwin).
> 
> Cheers,
> Marc
> 
> 
> > -----Original Message-----
> > From: Chris Trengove [mailto:trengove@econdata.com.au]
> > Sent: Saturday, May 05, 2001 10:08 PM
> > To: mod_python@modpython.org
> > Subject: [mod_python] Win32 threading issue
> > 
> > 
> > I have been testing the following script on Apache with 
> > mod_python (Apache
> > 1.13.17, mod_python 2.7.2, Windows 2000). I have been 
> > interested in testing
> > the possible throughput of this (and more useful scripts), so I have
> > another Python script which continually loads this "page".
> > 
> > from mod_python import apache
> > import thread
> > 
> > def handler(req):
> >     req.content_type = "text/plain"
> >     req.send_http_header()
> >     req.write("%d\n" % thread.get_ident())
> >     return apache.OK
> > 
> > When I run more than one copy of the driver script (in 
> > multiple consoles),
> > I get behavior indicative of some threading problems. 
> > Specifically, some
> > connections get "lost", the Apache error log reports various 
> > instances of
> > "IOError: Write failed...", and I occassionally get an access 
> > violation
> > inside Apache. Similarly, if I only run one copy of the 
> > driver script, and
> > just keep hitting the refresh button in a browser, the browser
> > occassionally returns TWO numbers, and sometimes reports an error in
> > retrieving the data. Note that I have tested my driver 
> > program retrieving a
> > simple text file, and everything works as expected, so it 
> > does not appear
> > to be a problem with Apache. (The problem also goes away if I set
> > ThreadPerChild to 1 in the Apache configuration.)
> > 
> > I have also found that, if I comment out the req.write() 
> > statement in the
> > handler, then there are no problems. From my examination of the
> > implementation of the request object, I see that req_write() 
> > contains calls
> > to Py_BEGIN_ALLOW_THREADS / Py_END_ALLOW_THREADS, whereas
> > req_send_http_header() contains no such calls. This suggests 
> > to me that
> > some thread switching is occurring inside req_write() which 
> > is messing with
> > the state of the interpreter.
> > 
> > I would be most grateful if anyone has any information to 
> > offer on this.
> > 
> > Chris Trengove
> > 
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://www.modpython.org/mailman/listinfo/mod_python
> > 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From trengove at econdata.com.au  Tue May  8 13:34:46 2001
From: trengove at econdata.com.au (Chris Trengove)
Date: Fri Jan  9 21:52:22 2004
Subject: [mod_python] Win32 threading issue
In-Reply-To: <000001c0d70d$064b9fe0$4eb3bd9d@softwareag.com>
References: <A9DFD9380C01D4118E740050DA7A8970386320@softwareag.com>
Message-ID: <20010508133951.SM00265@athene>

St?phane,

I would be great if you could find time to look at this.

I have been doing some more investigating, trying to understand just what
is going on. As I mentioned in my previous message, Py_BEGIN_ALLOW_THREADS
is called in the request object's write() method, so thread switching could
occur here. But thread switching should still occur in any case inside the
main Python interpreter loop. To test this, I tried the following script

from mod_python import apache
import thread

counter = None
LOOPLIMIT =
1000000

def handler(req):
   	global counter
    counter = 0
   	for i in
range(0,LOOPLIMIT):
        counter = counter + 1
    req.content_type =
"text/plain"
    req.send_http_header()
    req.write("%d: %d\n" %
(thread.get_ident(),counter))
    return apache.OK

If I load this page once, I get a value of 1000000 back, as expected. If I
load the page from two clients "simultaneously" (or as fast as I can
activate each one), I get something like

Client 1
1908: 1200128
2016: 1354557
2024: 591402

Client 2
2004: 1698384
2012: 1800311
2028: 1205627

This is for three repetitions of the page load. As you can see, the Python
interpreter is definitely switching between threads, and producing crazy
results for the global counter variable, which is not protected by any lock.

This is all as expected. The puzzle is why the thread switching inside the
request object's module should be causing some problem, if that is indeed
where the trouble lies. I am wondering whether there is something in the
request object structure which is not totally thread-safe.

Incidentally, if I run enough repetitions of this test setup, I can
eventually get a situation where one thread crashes, and the other thread
(just at this point) returns a value like

632: 1515843<LF>568: 1572286

that is TWO thread IDs in the one message -- the write buffer of one thread
is being appended to by the other, somehow.

Some food for thought.
Chris

>I think this is true for *nix, but on windows,
>you *must* use a multithreaded python.
>
>I'll try to have a look at your issue, but I've very
>few time available these days.



From grisha at modpython.org  Tue May  8 00:22:08 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:22 2004
Subject: [mod_python] Win32 threading issue
In-Reply-To: <20010508133951.SM00265@athene>
Message-ID: <Pine.BSF.4.32.0105080017250.11714-100000@localhost>

Chris -

Do you have Keepalive enabled?

Grisha

On Tue, 8 May 2001, Chris Trengove wrote:

> Incidentally, if I run enough repetitions of this test setup, I can
> eventually get a situation where one thread crashes, and the other thread
> (just at this point) returns a value like
>
> 632: 1515843<LF>568: 1572286
>
> that is TWO thread IDs in the one message -- the write buffer of one thread
> is being appended to by the other, somehow.
>


From trengove at econdata.com.au  Tue May  8 16:27:09 2001
From: trengove at econdata.com.au (Chris Trengove)
Date: Fri Jan  9 21:52:22 2004
Subject: [mod_python] Win32 threading issue
In-Reply-To: <Pine.BSF.4.32.0105080017250.11714-100000@localhost>
References: <20010508133951.SM00265@athene>
Message-ID: <200105081628535.SM00265@athene>

Grisha,

I did have KeepAlive On, but it appears to make no difference. I have just
tried with KeepAlive Off, and I get the same behaviour. Also, the clients I
have been using would be closing the connection after each request. As
clients I have been using a Python script with urllib, and a little C++
test program I wrote to see if trying a different client made any
difference. It didn't.

Chris

At 12:22 AM 8/05/2001 -0400, Gregory (Grisha) Trubetskoy wrote:
>
>Chris -
>
>Do you have Keepalive enabled?
>
>Grisha
>
>On Tue, 8 May 2001, Chris Trengove wrote:
>
>> Incidentally, if I run enough repetitions of this test setup, I can
>> eventually get a situation where one thread crashes, and the other thread
>> (just at this point) returns a value like
>>
>> 632: 1515843<LF>568: 1572286
>>
>> that is TWO thread IDs in the one message -- the write buffer of one thread
>> is being appended to by the other, somehow.


From grisha at modpython.org  Tue May  8 09:47:25 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:22 2004
Subject: [mod_python] Win32 threading issue
In-Reply-To: <200105081628535.SM00265@athene>
Message-ID: <Pine.BSF.4.32.0105080944350.16559-100000@localhost>

Interesting...

Another question - when you say a thread crashes, what exactly do you see
- is it something in the log or one of those dr. watson messages?

On Tue, 8 May 2001, Chris Trengove wrote:

> Grisha,
>
> I did have KeepAlive On, but it appears to make no difference. I have just
> tried with KeepAlive Off, and I get the same behaviour. Also, the clients I
> have been using would be closing the connection after each request. As
> clients I have been using a Python script with urllib, and a little C++
> test program I wrote to see if trying a different client made any
> difference. It didn't.
>
> Chris
>
> At 12:22 AM 8/05/2001 -0400, Gregory (Grisha) Trubetskoy wrote:
> >
> >Chris -
> >
> >Do you have Keepalive enabled?
> >
> >Grisha
> >
> >On Tue, 8 May 2001, Chris Trengove wrote:
> >
> >> Incidentally, if I run enough repetitions of this test setup, I can
> >> eventually get a situation where one thread crashes, and the other thread
> >> (just at this point) returns a value like
> >>
> >> 632: 1515843<LF>568: 1572286
> >>
> >> that is TWO thread IDs in the one message -- the write buffer of one thread
> >> is being appended to by the other, somehow.
>


From fatpornstar at hotmail.com  Tue May  8 17:04:32 2001
From: fatpornstar at hotmail.com (Benjamin Watson)
Date: Fri Jan  9 21:52:22 2004
Subject: [mod_python] Remove me please
Message-ID: <F212ZS4HIv6EybqfAj800005fe8@hotmail.com>

_________________________________________________________________
Get your FREE download of MSN Explorer at http://explorer.msn.com


From CHagner at fool.com  Tue May  8 13:29:37 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:52:22 2004
Subject: [mod_python] Use mod_python for root/home page requests
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E47DCA@rover.foolhq.com>

I currently have mod_python wired into a location (Specifically <Location
/>) that allows all request coming under this location to be handled by my
handler.  I also use SetHandler instead of AddHandler so that it doesn't
even matter what file extension/type is requested.  My goal here is to have
an apache instance that has ALL of its requests go through mod_python.

Now, the strange thing is that this works great for all requests except for
the root/home page.  For example,

http://www.mydummysite.com/blahblah

This works great... my handler is called and is responsible for
interpretting 'blahblah'.  However,

http://www.mydummysite.com/

This fails to go to the handler and instead looks for the default page
(index.html) in the DocumentRoot.  Thus, my Location directive doesn't
appear to be inclusive of the request to the base home URL.

Has anyone tried this before?  I'd prefer to achieve this without relying on
mod_rewrite.

Thanks for your help.

Chris



From trengove at econdata.com.au  Wed May  9 08:27:50 2001
From: trengove at econdata.com.au (Chris Trengove)
Date: Fri Jan  9 21:52:22 2004
Subject: [mod_python] Win32 threading issue
In-Reply-To: <Pine.BSF.4.32.0105080944350.16559-100000@localhost>
References: <200105081628535.SM00265@athene>
Message-ID: <200105090830627.SM00265@athene>

Grisha,

Exactly what I see is variable in nature. The most usual thing will be an
entry in the Apache error log like this

[Tue May 08 16:47:37 2001] [error] PythonHandler hwtest: Traceback (most
recent call last):

[Tue May 08 16:47:37 2001] [error] PythonHandler hwtest:   File
"e:\python20\lib\mod_python\apache.py", line 189, in Dispatch     result =
object(self.req) [Tue May 08 16:47:37 2001] [error] PythonHandler hwtest:
File "c:/apache/apache/htdocs/python\hwtest.py", line 24, in handler
req.write("%d: %d\n" % (thread.get_ident(),counter)) 

[Tue May 08 16:47:37 2001] [error] PythonHandler hwtest: IOError: Write
failed, client closed connection. 

When I use my Python driver script, which keeps going even if no data is
returned from the server, I will often end up with an access violation
inside Apache.exe.

"The instruction at "0x6ff71679" referenced memory at "0x616c707b". The
memory could not be "read"."

Actually, this location appears to be always the same -- when it eventually
happens -- which might be after a significant number log error messages.
After the access violation, one of my driver scripts stops, because it
receives a socket exception (10054, "Connection reset by peer"), and the
other script continues merrily along.

Occassionally other things can happen too -- I think it just depends on
when the two threads conflict. As I mentioned earilier, one really
misterious occurrence is getting a "double message" returned to one thread,
just as the other receives no data. Like this

632: 1515843<LF>568: 1572286

Here <LF> is a line feed, and the numbers before the colons are the thread
IDs. I know that Apache has 50 threads which it is cycling through in
order. On this occassion 568 was due to be the thread to be used for the
OTHER client.

Chris

At 09:47 AM 8/05/2001 -0400, Gregory (Grisha) Trubetskoy wrote:
>
>Interesting...
>
>Another question - when you say a thread crashes, what exactly do you see
>- is it something in the log or one of those dr. watson messages?
>
>On Tue, 8 May 2001, Chris Trengove wrote:
>
>> Grisha,
>>
>> I did have KeepAlive On, but it appears to make no difference. I have just
>> tried with KeepAlive Off, and I get the same behaviour. Also, the clients I
>> have been using would be closing the connection after each request. As
>> clients I have been using a Python script with urllib, and a little C++
>> test program I wrote to see if trying a different client made any
>> difference. It didn't.



From benno at sesgroup.net  Wed May  9 11:24:48 2001
From: benno at sesgroup.net (Ben Leslie)
Date: Fri Jan  9 21:52:22 2004
Subject: [mod_python] Use mod_python for root/home page requests
In-Reply-To: <13CDDE6A53DBD311BC3200508B6F0C4805E47DCA@rover.foolhq.com>; from CHagner@fool.com on Tue, May 08, 2001 at 01:29:37PM -0400
References: <13CDDE6A53DBD311BC3200508B6F0C4805E47DCA@rover.foolhq.com>
Message-ID: <20010509112448.B22766@sesgroup.net>

On Tue, 08 May 2001, Chris Hagner wrote:

> I currently have mod_python wired into a location (Specifically <Location
> />) that allows all request coming under this location to be handled by my
> handler.  I also use SetHandler instead of AddHandler so that it doesn't
> even matter what file extension/type is requested.  My goal here is to have
> an apache instance that has ALL of its requests go through mod_python.
> 
> Now, the strange thing is that this works great for all requests except for
> the root/home page.  For example,
> 
> http://www.mydummysite.com/blahblah
> 
> This works great... my handler is called and is responsible for
> interpretting 'blahblah'.  However,
> 
> http://www.mydummysite.com/
> 
> This fails to go to the handler and instead looks for the default page
> (index.html) in the DocumentRoot.  Thus, my Location directive doesn't
> appear to be inclusive of the request to the base home URL.
> 
> Has anyone tried this before?  I'd prefer to achieve this without relying on
> mod_rewrite.



Mmm I think you need to change the "index" dirrective (not sure what its called,
I'm at uni at the moment, search for index.html). Then you want to add index.py
to this. That should in theory work.

Cheers,

Benno

From CHagner at fool.com  Tue May  8 22:17:04 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:52:22 2004
Subject: [mod_python] Use mod_python for root/home page requests
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E47DCE@rover.foolhq.com>

Actually, my handler doesn't call scripts (index.py)... instead it call a
Servlet-like object that needs to be in the PYTHONPATH.  This is why I'm
using a Location directive instead of a Directory directive.  I basically
need to handle URLs that map to classes in my path instead of script files
in the file system.

One thing I was considering was dropping a custom PythonTransHandler class
into the document root directory.  Then, if I identify a call for the
homepage, I could do an internal redirect to my servlet (i.e.
http://www.mydummysite.com/contentapp).  

The true hack is to put a META-REFRESH tag in the homepage (index.html) to
http://www.mydummysite.com/contentapp, but then I lose all referrer
information and the ability to do anything based on the original query
string.

Another possibility is mod_rewrite, but I'm not sure that will work.  Still
seems like this should be do-able though, given the number of web pages out
there that need to be fully dynamic.

Thanks for the response though.  Any input/ideas are great to hear.

Chris

-----Original Message-----
From: Ben Leslie [mailto:benno@sesgroup.net]
Sent: Tuesday, May 08, 2001 9:25 PM
To: Chris Hagner
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Use mod_python for root/home page requests


On Tue, 08 May 2001, Chris Hagner wrote:

> I currently have mod_python wired into a location (Specifically <Location
> />) that allows all request coming under this location to be handled by my
> handler.  I also use SetHandler instead of AddHandler so that it doesn't
> even matter what file extension/type is requested.  My goal here is to
have
> an apache instance that has ALL of its requests go through mod_python.
> 
> Now, the strange thing is that this works great for all requests except
for
> the root/home page.  For example,
> 
> http://www.mydummysite.com/blahblah
> 
> This works great... my handler is called and is responsible for
> interpretting 'blahblah'.  However,
> 
> http://www.mydummysite.com/
> 
> This fails to go to the handler and instead looks for the default page
> (index.html) in the DocumentRoot.  Thus, my Location directive doesn't
> appear to be inclusive of the request to the base home URL.
> 
> Has anyone tried this before?  I'd prefer to achieve this without relying
on
> mod_rewrite.



Mmm I think you need to change the "index" dirrective (not sure what its
called,
I'm at uni at the moment, search for index.html). Then you want to add
index.py
to this. That should in theory work.

Cheers,

Benno

From bbhaydon at bigpond.com  Wed May  9 16:00:13 2001
From: bbhaydon at bigpond.com (Brett Haydon)
Date: Fri Jan  9 21:52:22 2004
Subject: [mod_python] Compile Problems
Message-ID: <NCBBKMABOKFCDLPIKKGIIEBOCDAA.bbhaydon@bigpond.com>

Hi,
Just compiled Apache 1.3.19 on RH7.1 with mod_python
as a dso against Python 2.1

I get this error when I try to start Apache
Cannot load mod_python.so into server
undefined symbol: openpty

Any ideas??

cheers,  
____________________________
Brett Haydon
bbhaydon@bigpond.com 

From stephane.bidoul at softwareag.com  Wed May  9 14:07:33 2001
From: stephane.bidoul at softwareag.com (=?US-ASCII?Q?Stephane_Bidoul?=)
Date: Fri Jan  9 21:52:22 2004
Subject: [mod_python] Win32 threading issue
In-Reply-To: <200105090830627.SM00265@softwareag.com>
Message-ID: <000001c0d880$a37d8660$4eb3bd9d@softwareag.com>

Chris,

Could you send me your driver script?
I cannot reproduce the behaviour you describe with
my own test scripts.

BTW, do you have a multiprocessor machine?
I know some problems have been reported
but never reproced on MP WIN2K machines.

-sbi

> -----Original Message-----
> From: mod_python-admin@modpython.org
> [mailto:mod_python-admin@modpython.org]On Behalf Of Chris Trengove
> Sent: 09 May, 2001 00:28
> To: Gregory (Grisha) Trubetskoy
> Cc: mod_python@modpython.org
> Subject: RE: [mod_python] Win32 threading issue
> 
> 
> Grisha,
> 
> Exactly what I see is variable in nature. The most usual 
> thing will be an
> entry in the Apache error log like this
> 
> [Tue May 08 16:47:37 2001] [error] PythonHandler hwtest: 
> Traceback (most
> recent call last):
> 
> [Tue May 08 16:47:37 2001] [error] PythonHandler hwtest:   File
> "e:\python20\lib\mod_python\apache.py", line 189, in Dispatch 
>     result =
> object(self.req) [Tue May 08 16:47:37 2001] [error] 
> PythonHandler hwtest:
> File "c:/apache/apache/htdocs/python\hwtest.py", line 24, in handler
> req.write("%d: %d\n" % (thread.get_ident(),counter)) 
> 
> [Tue May 08 16:47:37 2001] [error] PythonHandler hwtest: 
> IOError: Write
> failed, client closed connection. 
> 
> When I use my Python driver script, which keeps going even if 
> no data is
> returned from the server, I will often end up with an access violation
> inside Apache.exe.
> 
> "The instruction at "0x6ff71679" referenced memory at 
> "0x616c707b". The
> memory could not be "read"."
> 
> Actually, this location appears to be always the same -- when 
> it eventually
> happens -- which might be after a significant number log 
> error messages.
> After the access violation, one of my driver scripts stops, because it
> receives a socket exception (10054, "Connection reset by 
> peer"), and the
> other script continues merrily along.
> 
> Occassionally other things can happen too -- I think it just 
> depends on
> when the two threads conflict. As I mentioned earilier, one really
> misterious occurrence is getting a "double message" returned 
> to one thread,
> just as the other receives no data. Like this
> 
> 632: 1515843<LF>568: 1572286
> 
> Here <LF> is a line feed, and the numbers before the colons 
> are the thread
> IDs. I know that Apache has 50 threads which it is cycling through in
> order. On this occassion 568 was due to be the thread to be 
> used for the
> OTHER client.
> 
> Chris
> 
> At 09:47 AM 8/05/2001 -0400, Gregory (Grisha) Trubetskoy wrote:
> >
> >Interesting...
> >
> >Another question - when you say a thread crashes, what 
> exactly do you see
> >- is it something in the log or one of those dr. watson messages?
> >
> >On Tue, 8 May 2001, Chris Trengove wrote:
> >
> >> Grisha,
> >>
> >> I did have KeepAlive On, but it appears to make no 
> difference. I have just
> >> tried with KeepAlive Off, and I get the same behaviour. 
> Also, the clients I
> >> have been using would be closing the connection after each 
> request. As
> >> clients I have been using a Python script with urllib, and 
> a little C++
> >> test program I wrote to see if trying a different client made any
> >> difference. It didn't.
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From trengove at econdata.com.au  Thu May 10 08:43:10 2001
From: trengove at econdata.com.au (Chris Trengove)
Date: Fri Jan  9 21:52:22 2004
Subject: [mod_python] Win32 threading issue
In-Reply-To: <000001c0d880$a37d8660$4eb3bd9d@softwareag.com>
References: <200105090830627.SM00265@softwareag.com>
Message-ID: <200105100844681.SM00265@athene>

Stephane,

This is the sort of thing I have been using. I open two console windows and
start the script in both.
	
	import sys
	import time
	import urllib

	URL =
"http://127.0.0.1/python/test.py"
	NUM_GETS = 1000

	start = time.clock()

for i in range(0,NUM_GETS):
    	f = urllib.urlopen(URL)
		print f.read(),

	f.close()
	stop = time.clock()
	elapsed = stop - start
	print "%d GETs in
%.3f seconds = %.0f GETs/second" % (NUM_GETS,elapsed,NUM_GETS / elapsed)

I do not have a multiprocessor machine. I have been wondering whether this
is something to do running these tests on a single (local) machine, rather
than across a network, but when I try the above driver script retrieving a
small text file, everything is OK.

Incidentally, I have now switched to Apache 1.3.19 and still get the same
behaviour.

Chris

At 02:07 PM 9/05/2001 +0200, =?US-ASCII?Q?Stephane_Bidoul?= wrote:
>Chris,
>
>Could you send me your driver script?
>I cannot reproduce the behaviour you describe with
>my own test scripts.
>
>BTW, do you have a multiprocessor machine?
>I know some problems have been reported
>but never reproced on MP WIN2K machines.
>
>-sbi


From trengove at econdata.com.au  Thu May 10 08:45:08 2001
From: trengove at econdata.com.au (Chris Trengove)
Date: Fri Jan  9 21:52:22 2004
Subject: [mod_python] Win32 threading issue
Message-ID: <200105100846110.SM00265@athene>

Stephane,

Sorry, the mail program keeps messing up the formatting of the script, so
here it is as an attachment.

Chris

At 02:07 PM 9/05/2001 +0200, =?US-ASCII?Q?Stephane_Bidoul?= wrote:
>Chris,
>
>Could you send me your driver script?
>I cannot reproduce the behaviour you describe with
>my own test scripts.
>
>BTW, do you have a multiprocessor machine?
>I know some problems have been reported
>but never reproced on MP WIN2K machines.
>
>-sbi
-------------- next part --------------
import sys
import time
import urllib

URL = "http://127.0.0.1/python/test.py"
NUM_GETS = 1000

start = time.clock()
for i in range(0,NUM_GETS):
    f = urllib.urlopen(URL)
    print f.read(),
    f.close()
stop = time.clock()
elapsed = stop - start
print "%d GETs in %.3f seconds = %.0f GETs/second" % (NUM_GETS,elapsed,NUM_GETS / elapsed)
From CHagner at fool.com  Wed May  9 18:51:25 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:52:22 2004
Subject: [mod_python] Strange reloading of modules used in handler
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E47DE3@rover.foolhq.com>

I'm seeing some strange things with modules being reloaded when used in
mod_python.

Here's the scenario...
1. I'm using PythonImport to import a module (called MyConfig) and store it
in a module variable.
2. That module variable is being accessed by the registered modpy handler.
3. When I start up apache, MyConfig is imported once for each child process.
4. When I request a page, the handler accesses MyConfig... here's the weird
part.
5. SOMETIMES, it re-runs/imports the module containing MyConfig....
specifically, the first couple requests (6? I have 5 child procs running)
re-import the module and then it stops re-importing... for a while... then,
every once in a while it re-imports MyConfig.

Can some explain this?

Is apache killing off child procs and therefore requiring new python
subinterpreters to start up?  If this is not the case, I'm looking for a way
to keep an object in memory (thus, not have its module re-imported).

Here's my modpy setup if it helps...
        SetHandler python-program
        PythonHandler monty.modpy_handler
        PythonImport demo.MyConfig
        PythonDebug On
        PythonNoReload On
        PythonInterpPerDirectory Off

Thanks in advance...

Chris

From CHagner at fool.com  Wed May  9 19:00:21 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:52:22 2004
Subject: [mod_python] empty apache Connection object
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E47DE4@rover.foolhq.com>

Hey there,

Is there a good reason that my Connection object (mp_conn) is empty?  I've
never seen this be populated, but now I'd kind of like some of the
information it provides.

Chris

From gdamjan at mail.net.mk  Wed May  9 03:10:35 2001
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 21:52:22 2004
Subject: [mod_python] Win2k httpd.conf problems
In-Reply-To: <988954502.3af23f8680258@webmail.uchicago.edu>; from dsavitsk@midway.uchicago.edu on Fri, May 04, 2001 at 12:35:02AM -0500
References: <988954502.3af23f8680258@webmail.uchicago.edu>
Message-ID: <20010509031035.A472@local.izmislen.mk>

> I am unable to configure things, and i get the error:
> -------------------------
> Mod_python error: "PythonHandler test"
> 
> Traceback (most recent call last):
> 
>   File "c:\program files\python20\lib\mod_python\apache.py", line 180, in 
> Dispatch
>     object = resolve_object(self.req, module, object_str, silent)
> 
>   File "c:\program files\python20\lib\mod_python\apache.py", line 396, in 
> resolve_object
>     raise AttributeError, s
> 
> AttributeError: module 'c:\program files\python20\lib\test\__init__.pyc' 
> contains no 'handler'
> -------------------------
> 
...
>     <Directory "C:/Apache/cgi-bin">
>         AddHandler python-program .py
>         PythonHandler test

The most common error in the world, and very obvious.
Don't use 'test.py' for your testing script, there is already a package named
'test' in python and mod_python tries to load and execute that one.

You should use something like 'mptest.py' and don't forget to change 
	
	PythonHandler mptest




-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From gdamjan at mail.net.mk  Thu May 10 04:16:05 2001
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 21:52:22 2004
Subject: [mod_python] Strange reloading of modules used in handler
In-Reply-To: <13CDDE6A53DBD311BC3200508B6F0C4805E47DE3@rover.foolhq.com>; from CHagner@fool.com on Wed, May 09, 2001 at 06:51:25PM -0400
References: <13CDDE6A53DBD311BC3200508B6F0C4805E47DE3@rover.foolhq.com>
Message-ID: <20010510041605.A412@local.izmislen.mk>

On Wed, May 09, 2001 at 06:51:25PM -0400, Chris Hagner wrote:
> I'm seeing some strange things with modules being reloaded when used in
> mod_python.
> 
> Here's the scenario...
> 1. I'm using PythonImport to import a module (called MyConfig) and store it
> in a module variable.

I'm not very sure the PythonImport directive works too good, and anyway there's
no need to use it. Just use plain import in the Python scripts.

> 2. That module variable is being accessed by the registered modpy handler.
> 3. When I start up apache, MyConfig is imported once for each child process.
> 4. When I request a page, the handler accesses MyConfig... here's the weird
> part.
> 5. SOMETIMES, it re-runs/imports the module containing MyConfig....
> specifically, the first couple requests (6? I have 5 child procs running)
> re-import the module and then it stops re-importing... for a while... then,
> every once in a while it re-imports MyConfig.

Apache child process die sometimes, either deliberately either not. This causes
your module to be re-imported.

-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From CHagner at fool.com  Wed May  9 23:57:32 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:52:22 2004
Subject: [mod_python] Strange reloading of modules used in handler
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E47DE8@rover.foolhq.com>

Thanks, yeah, simply importing the module was my backup plan.  

My motivation is thus: the server running this handler/code is going to be
swamped load-wise and I wanted to be able to use apache's graceful restart
(starting new child procs and swapping them in for the old ones without
dropping a single request) to seamlessly update the application
configuration.

Maybe I'm just being paranoid and the import won't make a graceful restart
drop a connection... I'll be doing some testing to find out just where this
stands.

Again, thanks for the feedback/input.  Much appreciated.

Chris

-----Original Message-----
From: Damjan [mailto:gdamjan@mail.net.mk]
Sent: Wednesday, May 09, 2001 10:16 PM
To: mod_python@modpython.org
Subject: Re: [mod_python] Strange reloading of modules used in handler


On Wed, May 09, 2001 at 06:51:25PM -0400, Chris Hagner wrote:
> I'm seeing some strange things with modules being reloaded when used in
> mod_python.
> 
> Here's the scenario...
> 1. I'm using PythonImport to import a module (called MyConfig) and store
it
> in a module variable.

I'm not very sure the PythonImport directive works too good, and anyway
there's
no need to use it. Just use plain import in the Python scripts.

> 2. That module variable is being accessed by the registered modpy handler.
> 3. When I start up apache, MyConfig is imported once for each child
process.
> 4. When I request a page, the handler accesses MyConfig... here's the
weird
> part.
> 5. SOMETIMES, it re-runs/imports the module containing MyConfig....
> specifically, the first couple requests (6? I have 5 child procs running)
> re-import the module and then it stops re-importing... for a while...
then,
> every once in a while it re-imports MyConfig.

Apache child process die sometimes, either deliberately either not. This
causes
your module to be re-imported.

-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python

From dave at geko.net.au  Thu May 10 23:11:46 2001
From: dave at geko.net.au (David Creelman)
Date: Fri Jan  9 21:52:22 2004
Subject: [mod_python] What is happening here ?
Message-ID: <3AFA9392.CD147616@geko.net.au>

[Thu May 10 23:09:35 2001] [error] PythonHandler myscript: Traceback
(most recent call last):
[Thu May 10 23:09:35 2001] [error] PythonHandler myscript:   File
"/usr/lib/python2.0/site-packages/mod_python/apache.py", line 176, in
Dispatch
    module = import_module(module_name, _req)
[Thu May 10 23:09:35 2001] [error] PythonHandler myscript:   File
"/usr/lib/python2.0/site-packages/mod_python/apache.py", line 331, in
import_module
    f, p, d = imp.find_module(parts[i], path)
[Thu May 10 23:09:35 2001] [error] PythonHandler myscript: ImportError:
No module named myscript

I get this error when I try to run the following script.

from mod_python import apache

def handler(req):
    req.content_type = "text/plain"
    req.send_http_header()
    req.write("Hello World!")

    return apache.OK

Any help appreciated
David


From aiglauer at yahoo.com  Thu May 10 07:18:27 2001
From: aiglauer at yahoo.com (Alexis Iglauer)
Date: Fri Jan  9 21:52:22 2004
Subject: [mod_python] Segfaults and Handler issues
Message-ID: <20010510141827.72440.qmail@web13903.mail.yahoo.com>

Hi

I am migrating an existing mod_python application to a new server -
which involves an entirely new installation of everything including
apache and mod_python.

The new server is running Mandrake 7.2, apache 1.3.14 [old one had
1.3.9] and mod_python 2.7.2 [old: 2.6.2].

I have had multiple (connected) problems.

One of the things I noticed is that in all the mod_python docs the
AddHandler directive is

AddHandler python-program .py

Whereas I use (also on the old, working system)

AddHandler python-program py   <---- No '.' before 'py'

If I put the '.' in, then apache never finds my handler (old and new
system).

On the old system, everything worked once I compiled with -DEAPI (I had
no issues with threading).  On the new setup I get apache SegFaults.  I
compile as a DSO on both systems.

In trying to fix the SegFault problem, I made myself a separate Python
in /usr/local/src/Python-1.5.2 which I compiled without threads.  I
have also compiled mod_python against this non-threaded python version.
 All this has not helped.  The following things occur:

If I run 'httpd -X' (single httpd and you can see the stdout) and I try
to load my webpage in Netscape (running locally) I will sometimes get
"module '/home/slbin/stoploss/slhead' contains no 'handler'" and
sometimes "no module named re" with the error coming out of my slhead
function.

The irritating thing is that the error messages show that I am using
libraries from my normal python installation and not my non-threaded
install.  Is there any way to force mod_python to load a python from a
certain path?

If I run httpd normally, my page(s) - I use multiple frames, each
generated by the same handler based on the URL - will load.

I have "PythonHandler slhead::handler" in my httpd.conf, and my
functions are inside slhead.py

I now know why my handler stops - I get segfaults whenever I try to
access req.connection.remote_ip.  This used to work - has the
apache/mod_python API changed?

Any ideas, especially on why httpd -X doesn't work and how to enforce a
certain python interpreter, would be most welcome.

Regards
Alexis




__________________________________________________
Do You Yahoo!?
Yahoo! Auctions - buy the things you want at great prices
http://auctions.yahoo.com/

From grisha at modpython.org  Thu May 10 14:14:26 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:23 2004
Subject: [mod_python] empty apache Connection object
In-Reply-To: <13CDDE6A53DBD311BC3200508B6F0C4805E47DE4@rover.foolhq.com>
Message-ID: <Pine.BSF.4.32.0105101414020.34628-100000@localhost>

Can you elaborate on 'empty'?

On Wed, 9 May 2001, Chris Hagner wrote:

> Hey there,
>
> Is there a good reason that my Connection object (mp_conn) is empty?  I've
> never seen this be populated, but now I'd kind of like some of the
> information it provides.
>
> Chris
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From jvdev at 3va.net  Thu May 10 20:47:26 2001
From: jvdev at 3va.net (Jeroen van Drie)
Date: Fri Jan  9 21:52:23 2004
Subject: [mod_python] mod_python DSO in my config
Message-ID: <01051020382904.01357@e109009>

Hi list,

I've installed mod_python on my rh7.1 test machine as a DSO - works like a 
dream - congrats on the team with an excellent module. However!

I need a bit of help getting this to work on my production server which is a 
RH 6.2 running apache 1.3.12 with as `non-standard' both mod_ssl and 
mod_rewrite compiled in. Other more standard modules such as mod_cgi and 
mod_auth are also compiled into the binary. I've just baked a new apache with 
mod_so compiled in and added:

LoadModule python_module libexec/mod_python.so
AddModule mod_python.c

to the config. (These are the only statements of this type (module 
definitions) in the httpd.conf)

I had apxs remade also and compiling & making the mod_python DSO was a 
success.

when I stop and startssl apache I get the notification that 
[warn] Loaded DSO libexec/mod_python.so uses plain Apache 1.3 API, this 
module might crash under EAPI! (please recompile it with -DEAPI)

Which according to many accounts is no problem. However - there is no 
instance of apache running after the startssl command. Worst of all - there 
is nothing in the logs to indicate why the server doesn't want to start  - 
even if running it with LogLevel debug

If I just start the server without ssl enabled the server is started but 
returns a connection refused upon execution of any binary cgi program. 

Since mod_python should be the first in the LoadModule list maybe the 
assumption that it should be compiled into the binary is valid - or that all 
modules should be DSO's so that mod_python can get first pick. But I have as 
many theories as braincells :)

Thanks & best regards,
Jeroen van Drie.

From gdamjan at mail.net.mk  Fri May 11 02:21:44 2001
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 21:52:23 2004
Subject: [mod_python] What is happening here ?
In-Reply-To: <3AFA9392.CD147616@geko.net.au>; from dave@geko.net.au on Thu, May 10, 2001 at 11:11:46PM +1000
References: <3AFA9392.CD147616@geko.net.au>
Message-ID: <20010511022144.A499@local.izmislen.mk>

...

> No module named myscript
> 
> I get this error when I try to run the following script.
> 
...

How is Apache setup, and where is the 'myscript.py' script located?
It seems that mod_python can't find your 'myscript.py' file.

-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From rbunke at helios.acomp.usf.edu  Thu May 10 20:38:40 2001
From: rbunke at helios.acomp.usf.edu (Rick Bunke)
Date: Fri Jan  9 21:52:23 2004
Subject: [mod_python] I can't get apache to handle a .py file
Message-ID: <Pine.GSO.4.21.0105101911530.26528-100000@nova.acomp.usf.edu>

Hello,

I'm stuck.  I've read the FAQ.  I've read mod_python Manuel up to 2.4
testing your new installation.  I've followed the directions there for
mptest.py but all apache will do for me is serve up the text file
mptest.py.  It wont hand it off to mod_python.  I compiled the mod into
apache as static not DSO. 

I'll be glad to send the bulk of my config file if requested to do so but
here is what I think is the important stuff.

httpd.conf
#------ 
LogLevel debug

DocumentRoot "/home/myhome/Text/Web"

#I was just trying to turn every thing on here while I was troubleshouting
#this problem...
<Directory "/">
        Options All +MultiViews
</Directory>

# Python stuff according to mod_python manuel
<Directory "/home/myhome/Texts/Web/pytest">
        AddHandler python-program .py
        PythonHandler mptest
        PythonDebug On
</Directory>
#--------

the config file is basically identical to apache default config
file with the specific site info changed.

[black_box]cat mptest.py
from mod_python import apache
    
def handler(req):
        req.send_http_header()
        req.write("Hello World!")
        return apache.OK

[black_box]ls -l mptest.py
-rwxr-xr-x    1 rick     rick          123 May 10 19:35 mptest.py*

I wasn't sure if mptest.py was suppose to be excutable or not so I it
made it excutable just in case.

when I put a "#!/usr/local/python" in at the top and run it stand alone, 
it doesn't like the "import _apache" line which doesn't really surprise me
sense I don't think your suppose to run it like that :)  I was just trying
to figure what was wrong sense I get no errors in my error.log 

When I type "http://myip/pytest/mptest.py" in web my browser, it displays 
the text file:

from mod_python import apache
    
def handler(req):
	req.send_http_header()
	req.write("Hello World!")
	return apache.OK


Also, when I compiled apache, it failed in the mod_python directory saying
some functions (openpty and forkpty) were "undefined references" so I had
to add "-lutil" to the 
"LIBS="$LIBS -lm /usr/local/src/Python-2.1c2/libpython2.1.a"" 
line in the libpython.module config file, rerun configure, and then it
would compile ok.  possable bug in the configure scripts, or my setup, I
don't know which.

I run Linux 2.4.4
Python 2.1c2 
Apache 1.3.19
Mod_Python 2.7.2

Please help me :)

Thanks
Rick

we enjoy great advantages from the inventions of others, we should be 
glad of an opportunity to serve others by any invention of ours; and 
this we should do freely and generously.
		- Ben Franklin (declining to take out a patent on the
				Franklin Stove)

Whenever there is a conflict between human rights and property rights, 
human rights must prevail.
	           - Abraham Lincoln
	
Information is the currency of democracy.
		   - Thomas Jefferson


From rdevide at ican.at  Fri May 11 09:52:49 2001
From: rdevide at ican.at (Devide Robert)
Date: Fri Jan  9 21:52:23 2004
Subject: [mod_python] I can't get apache to handle a .py file
References: <Pine.GSO.4.21.0105101911530.26528-100000@nova.acomp.usf.edu>
Message-ID: <3AFB9A51.657A4723@ican.at>

Rick Bunke wrote:

> DocumentRoot "/home/myhome/Text/Web"
 :
> <Directory   "/home/myhome/Texts/Web/pytest">

Text <-> Texts ???

dave

From rbunke at helios.acomp.usf.edu  Sat May 12 16:12:43 2001
From: rbunke at helios.acomp.usf.edu (Rick Bunke)
Date: Fri Jan  9 21:52:23 2004
Subject: [mod_python] I can't get apache to handle a .py file
In-Reply-To: <3AFB9A51.657A4723@ican.at>
Message-ID: <Pine.GSO.4.21.0105121605430.4178-100000@nova.acomp.usf.edu>

On Fri, 11 May 2001, Devide Robert wrote:
                                
> Rick Bunke wrote:
>
> > DocumentRoot "/home/myhome/Text/Web"
>  :
> > <Directory   "/home/myhome/Texts/Web/pytest">
>
> Text <-> Texts ???
>
> dave
>

Thanks, It works now.
That was the annoying little detail that I've been overlooking and
pulling my hair out over for three days now while thinking, it can't be
this hard!  :)

Thank You, again 
Rick

we enjoy great advantages from the inventions of others, we should be 
glad of an opportunity to serve others by any invention of ours; and 
this we should do freely and generously.
		- Ben Franklin (declining to take out a patent on the
				Franklin Stove)

Whenever there is a conflict between human rights and property rights, 
human rights must prevail.
	           - Abraham Lincoln
	
Information is the currency of democracy.
		   - Thomas Jefferson



From dave at geko.net.au  Mon May 14 22:34:29 2001
From: dave at geko.net.au (David Creelman)
Date: Fri Jan  9 21:52:23 2004
Subject: [mod_python] What is happening here ?
References: <3AFA9392.CD147616@geko.net.au> <20010511022144.A499@local.izmislen.mk>
Message-ID: <3AFFD0D5.9B0A08A2@geko.net.au>

Hi Damjan,

myscript.py is in /var/www/cgi-bin. I'm running Mandrake 8.0.

Should it go somewhere else ?

Cheers
David

Damjan wrote:

> ...
>
> > No module named myscript
> >
> > I get this error when I try to run the following script.
> >
> ...
>
> How is Apache setup, and where is the 'myscript.py' script located?
> It seems that mod_python can't find your 'myscript.py' file.
>
> --
> Damjan Georgievski              |           ???????~???? ??????????????????????
> Skopje, Macedonia               |           ?????????~??, ?????????????????~??
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From petar at metamarkets.com  Mon May 14 08:38:52 2001
From: petar at metamarkets.com (Petar Karafezov)
Date: Fri Jan  9 21:52:23 2004
Subject: [mod_python] RE: setting multiple cookies with req.headers_out
Message-ID: <86FC34EA3C4F074AA6BBFFE52ED83FED27C1D5@METAEXCH.sfo.metamarkets.com>

Hello all -

I am trying to send more than one cookie in my req.headers_out. The problem
is that req.headers_out is a dictionary - and if I want to send more than 1
cookie - only the last one gets send - they all have key 'Set-cookie'.

I am sure there's a quick and easy solution for this ...I just didn't see
it. Could anyone share ideas/experience on this issue ?

Thanks!

Regards to all,
Petar Karafezov

MetaMarkets.com
415-575-3015
-------------------------------------------
Investing Out Loud at
http://www.metamarkets.com
-------------------------------------------

From miguel at yorku.ca  Mon May 14 11:57:09 2001
From: miguel at yorku.ca (Miguel Marques)
Date: Fri Jan  9 21:52:23 2004
Subject: [mod_python] RE: setting multiple cookies with req.headers_out
In-Reply-To: <86FC34EA3C4F074AA6BBFFE52ED83FED27C1D5@METAEXCH.sfo.metamarkets.com>
References: <86FC34EA3C4F074AA6BBFFE52ED83FED27C1D5@METAEXCH.sfo.metamarkets.com>
Message-ID: <20010514115709Y.miguel@yorku.ca>

Greetings...
On Mon, 14 May 2001 08:38:52 -0700, Petar Karafezov <petar@metamarkets.com> wrote:
> Hello all -
> 
> I am trying to send more than one cookie in my req.headers_out. The problem
> is that req.headers_out is a dictionary - and if I want to send more than 1
> cookie - only the last one gets send - they all have key 'Set-cookie'.
> 
> I am sure there's a quick and easy solution for this ...I just didn't see
> it. Could anyone share ideas/experience on this issue ?
> 
Just use 

req.headers_out.add('Set-Cookie', ...)

as many time as you need.

						Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830




From grisha at modpython.org  Mon May 14 13:09:09 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:23 2004
Subject: [mod_python] RE: setting multiple cookies with req.headers_out
In-Reply-To: <86FC34EA3C4F074AA6BBFFE52ED83FED27C1D5@METAEXCH.sfo.metamarkets.com>
Message-ID: <Pine.BSF.4.32.0105141308590.97224-100000@localhost>


http://www.modpython.org/live/mod_python-2.7.3/doc-html/pyapi-mptable.html



On Mon, 14 May 2001, Petar Karafezov wrote:

> Hello all -
>
> I am trying to send more than one cookie in my req.headers_out. The problem
> is that req.headers_out is a dictionary - and if I want to send more than 1
> cookie - only the last one gets send - they all have key 'Set-cookie'.
>
> I am sure there's a quick and easy solution for this ...I just didn't see
> it. Could anyone share ideas/experience on this issue ?
>
> Thanks!
>
> Regards to all,
> Petar Karafezov
>
> MetaMarkets.com
> 415-575-3015
> -------------------------------------------
> Investing Out Loud at
> http://www.metamarkets.com
> -------------------------------------------
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From grisha at modpython.org  Mon May 14 17:25:07 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:23 2004
Subject: [mod_python] problem with publisher.py File class w/ possible
 fix
In-Reply-To: <A9DFD9380C01D4118E740050DA7A89703860FA@becomm-mis2.becomm.com>
Message-ID: <Pine.BSF.4.32.0105141722420.99402-100000@localhost>

Marc -

Do you have any more details so I could reproduce this error? I am having
a hard time understanding why it would insist on m being an integer.
Perhaps you have the piece of code that caused it?

Grisha


On Wed, 21 Mar 2001, Marc Fiuczynski wrote:

> Hi,
>
> I am having a problem with the publisher.py File class, which I have fixed,
> but I would like your approval.
>
> My configuration is as follows:
> mod_python 2.7.2
> python 2.0
> apache 1.3.14
> Red Hat Linux 7.0
>
> I am using mod python to do http_post operations with files.  This uses the
> publisher.py File class.  The __init__ method of that class steals all of
> the file-like methods, as shown below:
>
>         # steal all the file-like methods
>         methods = field.file.__methods__
>         for m in methods:
>             self.__dict__[m] = methods[m]
>
> I was getting an error in that last line saying that 'm' needed to be an
> int.  (Sorry, I forget the actual error).  I found some other code that was
> doing the exact same thing and noticed that they were assigning the methods
> in a different manner (using setattr).  See below:
>
>         # steal all the file-like methods
>         file = field.file
>         for method in file.__methods__:
>             setattr(self, method, getattr(file, method))
>
> This seems to work.  I am too nascent to Python to understand the history of
> the built-in __xyz__ fields in objects, and whether this is something
> specific to Python 2.0 versus an older version of Python.  Please review and
> if it is the right thing, then feel free to incorporate this change into
> your mod_python code base.
>
> Cheers,
> Marc
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From SumnerH at fool.com  Mon May 14 18:33:44 2001
From: SumnerH at fool.com (G . Sumner Hayes)
Date: Fri Jan  9 21:52:23 2004
Subject: [mod_python] PythonImport question
Message-ID: <20010514183344.A6813@fool.com>

Brief version:
I have a patch to make PythonImport take place during server init
instead of child init--is there any chance it would be accepted?

Long version:
So the PythonImport documentation says:

: Tells the server to import the Python module module at process
: startup. This is useful for initialization tasks that could be
: time consuming and should not be done at the request processing
: time, e.g. initializing a database connection.
:
: The import takes place at child process initialization, so the
: module will actually be imported once for every child process
: spawned.

Having the import take place at every child process
initialization seems to run counter to the purpose of the
statement (doing time consuming server startup stuff).  It
also makes the various children have potentially different
PythonImport'd contents if the module(s) imported that way
are edited in place.

I'm wondering if anyone actually wants that behavior; it seems
like it'd be better to do the PythonImport exactly once at server
startup.

Rationale 1:
Suppose I have a ton of expensive startup work to do in my
PythonImport lines.  Furthermore, I need to be able to do
apache graceful restarts even while under heavy load.  Here's
a sketch of how the apache graceful restarts work--I'll pretend
there are 3 different types of apache process, a "master control
program" or MCP which coordinates startup, a "pool master" or
PM which spawns children as needed, and the child processes
or CPs.

1.  A user sends MCP a SIGUSR1 signal indicating a graceful
restart should take place.  The old PM and CPs continue
handling incoming requests.
2.  MCP starts up a new PM, which reads all startup files and
processes them; this includes running the server init functions
for apache modules (in particular mod_python).
3.  New PM finishes reading startup and fork()s off new CPs (as
per the MinSpareServers and related apache directives).  After
forking new CPs, the new PM tells the MCP that it is ready to
go.
4.  MCP tells old PM to shut down and routes all new incoming
requests to the new PM. 
5.  Old PM tells old CPs to exit; if they're idle, they exit
immediately.  If they're serving a request, they finish doing
so and then exit.

Pretty elegant; you can change the entire apache config on the
fly without dropping any connections.  You can even update shared
objects this way without dropping connections; you can e.g.
migrate from python 1.5.2 to Stackless Python 2.0 (potentially
with a new version of mod_python) seamlessly.

_However_, step (3) gets us in trouble if PythonImports happen
in the child process--the old PM will be exiting while the new
CPs are busy doing whatever (potentially many-second or evan
minute-long) the PythonImports say to do.

If PythonImports took place in the server init, they'd get done
before the new PM/CPs took over; the old ones would continue
serving requests until the new ones were ready.

(Yes, the setup involved will have high-availability measures
in place, but it'd be really nice to have this feature for a
number of reasons).

Rationale 2:
It's far more "apache-like" for configuration data to be read
exactly 1 time at startup and then re-read when explicitly asked
to do so (via a graceful restart).  As it stands now, if I'm
importing mystuff.py via PythonImport and I edit that file while
the server is running, some apache children (which started before
my edits) will have the old mystuff module and others (which
happened to start after my edits) will have the new one.  That's
confusing and potentially dangerous, and if I'm editing files
in place (groan, I know) it's full of nasty races.

Let me know and I'll send a patch.

  Sumner

-- 
rage, rage against the dying of the light

From CHagner at fool.com  Tue May 15 11:00:58 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:52:23 2004
Subject: [mod_python] empty apache Connection object
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E47E1D@rover.foolhq.com>

Sorry for vague statement... here's what I'm seeing when I print out the
Connection object and its attributes.  As you can see, there does appear to
be an mp_conn object present, but all attributes/methods return 'None'.
Thoughts?  Let me know if there's something more valuable I can do to
determine the state of the object.  Thanks.

REQUEST'S CONNECTION'S VALUES
conn: <mp_conn object at 0x87ad968>
child num: None
local address: None
remote address: None
remote ip: None
remote host: None
remote logname: None
user name: None
auth type: None
keep alives: None
local ip: None
local host: None

Chris

-----Original Message-----
From: Gregory (Grisha) Trubetskoy [mailto:grisha@modpython.org]
Sent: Thursday, May 10, 2001 2:14 PM
To: Chris Hagner
Cc: 'mod_python@modpython.org'
Subject: Re: [mod_python] empty apache Connection object



Can you elaborate on 'empty'?

On Wed, 9 May 2001, Chris Hagner wrote:

> Hey there,
>
> Is there a good reason that my Connection object (mp_conn) is empty?  I've
> never seen this be populated, but now I'd kind of like some of the
> information it provides.
>
> Chris
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>

From CHagner at fool.com  Fri May 18 13:45:05 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:52:23 2004
Subject: [mod_python] several mod_python issues
Message-ID: <200105182250.SAA27068@monkeyboy.dorc.foolhq.com>

While working with mod_python lately, we've noticed a couple of
inconsistencies with the documentation and also have a few 
comments/questions on intended behavior and whether certain behavior 
was intended or is just a bug.

1. The PythonNoReload directive is a bit confusing and does not provide
   an option that would also be useful. "PythonNoReload Off" performs a
   full reload/import of the pyhandler on every request.
   "PythonNoReload On" only performs a reload/import when the mtime
   of the handler has changed. We would like to also propose an
   additional option to "never" reload/import the handler except upon
   initial startup of the child process. This would allow for a more
   controlled re-initialization of the server(s) via an apache graceful
   restart.

2. Modules pre-loaded via the PythonImport directive do not appear to be
   readily available in the handler. We've verified that Python Import
   and the handler are running in the same interpreter space by passing
   info via global classes such as Exception, but we can't find the
   modules loaded via PythonImport. They must be somewhere, but just
   can't seem to locate them... What is the expected way to access
   modules that have been pre-loaded via PythonImport from within code
   such as the handler?

3. As detailed in an earlier post from Sumner Hayes, mod_python does not
   perform as expected/desired on a apache graceful restart.
   Essentially, new children are spawned and declared ready to the
   parent before they can actually serve requests (ie still initilizing
   any PythonImport directives). The mod_python directives should be
   fully processed before considering the child ready to serve requests.

This isn't meant as just a rant. Just some things that we've noticed
that are important in our environment. We're willing to help with fixes,
etc., but wanted to make sure we had a full perspective on all the
issues at hand before attacking this stuff. 

Please let us know what you think about the observations listed above.
Thanks.

-- 
Stephan Koledin
Mad Scientist
The Motley Fool
http://fool.com



From grisha at modpython.org  Sat May 19 00:38:41 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:23 2004
Subject: [mod_python] several mod_python issues
In-Reply-To: <200105182250.SAA27068@monkeyboy.dorc.foolhq.com>
Message-ID: <Pine.BSF.4.32.0105190031400.54052-100000@localhost>

On Fri, 18 May 2001, Chris Hagner wrote:

> While working with mod_python lately, we've noticed a couple of
> inconsistencies with the documentation and also have a few
> comments/questions on intended behavior and whether certain behavior
> was intended or is just a bug.
>
> 1. The PythonNoReload directive is a bit confusing and does not provide
>    an option that would also be useful. "PythonNoReload Off" performs a
>    full reload/import of the pyhandler on every request.
>    "PythonNoReload On" only performs a reload/import when the mtime
>    of the handler has changed. We would like to also propose an
>    additional option to "never" reload/import the handler except upon
>    initial startup of the child process. This would allow for a more
>    controlled re-initialization of the server(s) via an apache graceful
>    restart.

This one is a BUG that seems to have been introduced in 2.7.3 releases
while trying to fix another one....

The remaining two issues are just a big mess because I never gave any
priority to PythonImport. The only catch with Summer Hayes's approach is
that stuff will run as root, which to me seems kind of bad. (I haven't
seen the patch, so this is part speculation)

Grisha

> 2. Modules pre-loaded via the PythonImport directive do not appear to be
>    readily available in the handler. We've verified that Python Import
>    and the handler are running in the same interpreter space by passing
>    info via global classes such as Exception, but we can't find the
>    modules loaded via PythonImport. They must be somewhere, but just
>    can't seem to locate them... What is the expected way to access
>    modules that have been pre-loaded via PythonImport from within code
>    such as the handler?
>
> 3. As detailed in an earlier post from Sumner Hayes, mod_python does not
>    perform as expected/desired on a apache graceful restart.
>    Essentially, new children are spawned and declared ready to the
>    parent before they can actually serve requests (ie still initilizing
>    any PythonImport directives). The mod_python directives should be
>    fully processed before considering the child ready to serve requests.
>
> This isn't meant as just a rant. Just some things that we've noticed
> that are important in our environment. We're willing to help with fixes,
> etc., but wanted to make sure we had a full perspective on all the
> issues at hand before attacking this stuff.
>
> Please let us know what you think about the observations listed above.
> Thanks.
>
> --
> Stephan Koledin
> Mad Scientist
> The Motley Fool
> http://fool.com
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From teepwalla at yahoo.com  Fri May 18 21:51:21 2001
From: teepwalla at yahoo.com (Prateep Siamwalla)
Date: Fri Jan  9 21:52:23 2004
Subject: [mod_python] mod_python and locale
Message-ID: <20010519045121.32984.qmail@web14306.mail.yahoo.com>

Hi All,

I've come across a problem with mod_python (2.7.2
compiled with Python 2.0 --with-threads=no) on Linux
(RH 7.0) regarding locale.

the following code (mptest.py):
-----------------
from mod_python import apache
from locale import setlocale,LC_ALL,format


def handler(req):
    req.content_type = "text/plain"
    req.send_http_header()
    setlocale(LC_ALL,'')
    a = 123123231.323    
    req.write("The formatted version of the number %s
is %s" % (a,format('%.2f',a,1)))
    return apache.OK

Produces:
----------------------
The formatted version of the number 123123231.323 is
123123231.32

Rather than the expected
-----------------------
....123,123,231.32

I don't have any problems with locale formating on
Win98+Apache+Python2.0.  Is this a recognized problem?

I've tried locale formating from the Python 2.0
command line on the Linux box and it yields expected
results ( 123,123,231.32)

I've tried locale formating from the compiled
Python2.0 with no threads binary on the Linux box and
it also yields expected results.

Its only on mod_python am I encountering a lack of
correct formating.

Have others encountered this problem?

Thanks in advance.
teep


__________________________________________________
Do You Yahoo!?
Yahoo! Auctions - buy the things you want at great prices
http://auctions.yahoo.com/

From gdamjan at mail.net.mk  Sat May 19 12:03:10 2001
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 21:52:23 2004
Subject: [mod_python] What is happening here ?
In-Reply-To: <3AFFD0D5.9B0A08A2@geko.net.au>; from dave@geko.net.au on Mon, May 14, 2001 at 10:34:29PM +1000
References: <3AFA9392.CD147616@geko.net.au> <20010511022144.A499@local.izmislen.mk> <3AFFD0D5.9B0A08A2@geko.net.au>
Message-ID: <20010519120310.A256@local.izmislen.mk>

On Mon, May 14, 2001 at 10:34:29PM +1000, David Creelman wrote:
> > ...
> >
> > > No module named myscript
> > >
> > > I get this error when I try to run the following script.
> > >
> > ...
> >
> > How is Apache setup, and where is the 'myscript.py' script located?
> > It seems that mod_python can't find your 'myscript.py' file.
>
> myscript.py is in /var/www/cgi-bin. I'm running Mandrake 8.0.
> 
> Should it go somewhere else ?

Yes! Put it somewhere in the python search path.

Also you should probably reread the mod_python documentation. 
mod_python is not related to CGI scripts, but is a scripting engine
inside the apache process. You can do much more with mod_python than
with CGI.

-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From dyeung at ust.hk  Sat May 19 19:45:43 2001
From: dyeung at ust.hk (David Yeung)
Date: Fri Jan  9 21:52:23 2004
Subject: [mod_python] Modules with identical name in different directories
Message-ID: <3B065CE7.2BD9F0CA@ust.hk>

If I have two different python modules with identical name (index.py), e.g.:

   http://host/pytest1/index.py/mainpage

and

   http://host/pytest2/index.py/mainpage

When I access the first index.py module, the mod_python import the first index.py.
Then I switch to access the second index.py. Will the mod_python know it is a
different module with the first one, and then import the second 'index.py' 
automatically? Or it will use the already imported 'index.py' module?

Thanks

david

From grisha at modpython.org  Sat May 19 13:35:58 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:23 2004
Subject: [mod_python] Modules with identical name in different directories
In-Reply-To: <3B065CE7.2BD9F0CA@ust.hk>
Message-ID: <Pine.BSF.4.32.0105191334130.62711-100000@localhost>

On Sat, 19 May 2001, David Yeung wrote:

> If I have two different python modules with identical name (index.py), e.g.:
>
>    http://host/pytest1/index.py/mainpage
>
> and
>
>    http://host/pytest2/index.py/mainpage
>
> When I access the first index.py module, the mod_python import the first index.py.
> Then I switch to access the second index.py. Will the mod_python know it is a
> different module with the first one, and then import the second 'index.py'
> automatically? Or it will use the already imported 'index.py' module?

By default it will use already imported index.py module. But you can use
the PythonInterpPerDirectory, in which case the two would run in separate
subinterpreters.

Grisha


From alain at onesite.org  Sun May 20 04:45:02 2001
From: alain at onesite.org (=?iso-8859-1?Q?Alain_T=E9sio?=)
Date: Fri Jan  9 21:52:23 2004
Subject: [mod_python] When trying to get cgi.FieldStorage() : AttributeError: 'sys' module has no attribute 'argv'
Message-ID: <001101c0e0d6$df62ef40$400110ac@alain>

Hi, I found a message in an archive saying I shouldn't use
FieldStorage with publisher
http://www.modpython.org/pipermail/mod_python/2001-January/001086.html
but I'm not using publisher (or I don't know I am)
Any idea what's happening ?

Thanks
Alain

=========== observer_www.py
import cgi
items=cgi.FieldStorage()

=========== output

Mod_python error: "PythonHandler observer_www"

Traceback (most recent call last):

  File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line
176, in Dispatch
    module = import_module(module_name, _req)

  File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line
340, in import_module
    module = imp.load_module(mname, f, p, d)

  File "/home/observer/scripts/observer_www.py", line 2, in ?
    items=cgi.FieldStorage()

  File "/usr/local/lib/python2.1/cgi.py", line 445, in __init__
    elif sys.argv[1:]:

AttributeError: 'sys' module has no attribute 'argv'



From grisha at modpython.org  Sun May 20 01:17:35 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:23 2004
Subject: [mod_python] When trying to get cgi.FieldStorage() : AttributeError:
 'sys' module has no attribute 'argv'
In-Reply-To: <001101c0e0d6$df62ef40$400110ac@alain>
Message-ID: <Pine.BSF.4.32.0105200111390.67081-100000@localhost>

This is because indeed the sys module has no attribute argv inside
subinterpreters. This is a "feature not a bug" and is documented somewhere
in the Python docs.

If you're using the cgi module, just fake the the argv by doing something
like:

import sys
sys.argv = []

then cgi module will be happy.

Grisha

On Sun, 20 May 2001, [iso-8859-1] Alain T?sio wrote:

> Hi, I found a message in an archive saying I shouldn't use
> FieldStorage with publisher
> http://www.modpython.org/pipermail/mod_python/2001-January/001086.html
> but I'm not using publisher (or I don't know I am)
> Any idea what's happening ?
>
> Thanks
> Alain
>
> =========== observer_www.py
> import cgi
> items=cgi.FieldStorage()
>
> =========== output
>
> Mod_python error: "PythonHandler observer_www"
>
> Traceback (most recent call last):
>
>   File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line
> 176, in Dispatch
>     module = import_module(module_name, _req)
>
>   File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line
> 340, in import_module
>     module = imp.load_module(mname, f, p, d)
>
>   File "/home/observer/scripts/observer_www.py", line 2, in ?
>     items=cgi.FieldStorage()
>
>   File "/usr/local/lib/python2.1/cgi.py", line 445, in __init__
>     elif sys.argv[1:]:
>
> AttributeError: 'sys' module has no attribute 'argv'
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From emailreklama at yahoo.com  Sun May 20 21:09:15 2001
From: emailreklama at yahoo.com (EmailReklama)
Date: Fri Jan  9 21:52:23 2004
Subject: [mod_python] E-MAIL 
Message-ID: <033300912171451SERVER@server>

????????? ???????? ????? ??????? ?? e-mail ?????:

?????? - 28000 ????? ??????.
?????? - 300000 ?? ??? 30% ???????????, 50% ?????????? ??????.

????????? ???????? 2 ??????? ??? ?? 1000 ?????.

??????????????? ?????.

From alain at onesite.org  Sun May 20 19:39:45 2001
From: alain at onesite.org (Alain Tesio)
Date: Fri Jan  9 21:52:23 2004
Subject: [mod_python] When trying to get cgi.FieldStorage() : AttributeError: 'sys' module has no attribute 'argv'
References: <Pine.BSF.4.32.0105200111390.67081-100000@localhost>
Message-ID: <004401c0e153$dccc8520$400110ac@alain>

Thanks for the information, but how can I get the GET parameters then ?
The usual cgi variables aren't in os.environ

Alain

----- Original Message -----
From: "Gregory (Grisha) Trubetskoy" <grisha@modpython.org>
To: "Alain Tesio" <alain@onesite.org>
Cc: "ML mod_python" <mod_python@modpython.org>
Sent: Sunday, May 20, 2001 7:17 AM
Subject: Re: [mod_python] When trying to get cgi.FieldStorage() :
AttributeError: 'sys' module has no attribute 'argv'


>
> This is because indeed the sys module has no attribute argv inside
> subinterpreters. This is a "feature not a bug" and is documented somewhere
> in the Python docs.
>
> If you're using the cgi module, just fake the the argv by doing something
> like:
>
> import sys
> sys.argv = []
>
> then cgi module will be happy.
>
> Grisha
>
> On Sun, 20 May 2001, [iso-8859-1] Alain T?sio wrote:
>
> > Hi, I found a message in an archive saying I shouldn't use
> > FieldStorage with publisher
> > http://www.modpython.org/pipermail/mod_python/2001-January/001086.html
> > but I'm not using publisher (or I don't know I am)
> > Any idea what's happening ?
> >
> > Thanks
> > Alain
> >
> > =========== observer_www.py
> > import cgi
> > items=cgi.FieldStorage()
> >
> > =========== output
> >
> > Mod_python error: "PythonHandler observer_www"
> >
> > Traceback (most recent call last):
> >
> >   File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py",
line
> > 176, in Dispatch
> >     module = import_module(module_name, _req)
> >
> >   File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py",
line
> > 340, in import_module
> >     module = imp.load_module(mname, f, p, d)
> >
> >   File "/home/observer/scripts/observer_www.py", line 2, in ?
> >     items=cgi.FieldStorage()
> >
> >   File "/usr/local/lib/python2.1/cgi.py", line 445, in __init__
> >     elif sys.argv[1:]:
> >
> > AttributeError: 'sys' module has no attribute 'argv'
> >
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://www.modpython.org/mailman/listinfo/mod_python
> >


From grisha at modpython.org  Sun May 20 20:22:20 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:23 2004
Subject: [mod_python] When trying to get cgi.FieldStorage() : AttributeError:
 'sys' module has no attribute 'argv'
In-Reply-To: <004401c0e153$dccc8520$400110ac@alain>
Message-ID: <Pine.BSF.4.32.0105202021500.75359-100000@localhost>

Try reading the manual:

http://www.modpython.org/live/mod_python-2.7.3/doc-html/pyapi-util-fstor.html

On Sun, 20 May 2001, Alain Tesio wrote:

> Thanks for the information, but how can I get the GET parameters then ?
> The usual cgi variables aren't in os.environ
>
> Alain
>
> ----- Original Message -----
> From: "Gregory (Grisha) Trubetskoy" <grisha@modpython.org>
> To: "Alain Tesio" <alain@onesite.org>
> Cc: "ML mod_python" <mod_python@modpython.org>
> Sent: Sunday, May 20, 2001 7:17 AM
> Subject: Re: [mod_python] When trying to get cgi.FieldStorage() :
> AttributeError: 'sys' module has no attribute 'argv'
>
>
> >
> > This is because indeed the sys module has no attribute argv inside
> > subinterpreters. This is a "feature not a bug" and is documented somewhere
> > in the Python docs.
> >
> > If you're using the cgi module, just fake the the argv by doing something
> > like:
> >
> > import sys
> > sys.argv = []
> >
> > then cgi module will be happy.
> >
> > Grisha
> >
> > On Sun, 20 May 2001, [iso-8859-1] Alain T?sio wrote:
> >
> > > Hi, I found a message in an archive saying I shouldn't use
> > > FieldStorage with publisher
> > > http://www.modpython.org/pipermail/mod_python/2001-January/001086.html
> > > but I'm not using publisher (or I don't know I am)
> > > Any idea what's happening ?
> > >
> > > Thanks
> > > Alain
> > >
> > > =========== observer_www.py
> > > import cgi
> > > items=cgi.FieldStorage()
> > >
> > > =========== output
> > >
> > > Mod_python error: "PythonHandler observer_www"
> > >
> > > Traceback (most recent call last):
> > >
> > >   File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py",
> line
> > > 176, in Dispatch
> > >     module = import_module(module_name, _req)
> > >
> > >   File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py",
> line
> > > 340, in import_module
> > >     module = imp.load_module(mname, f, p, d)
> > >
> > >   File "/home/observer/scripts/observer_www.py", line 2, in ?
> > >     items=cgi.FieldStorage()
> > >
> > >   File "/usr/local/lib/python2.1/cgi.py", line 445, in __init__
> > >     elif sys.argv[1:]:
> > >
> > > AttributeError: 'sys' module has no attribute 'argv'
> > >
> > >
> > > _______________________________________________
> > > Mod_python mailing list
> > > Mod_python@modpython.org
> > > http://www.modpython.org/mailman/listinfo/mod_python
> > >
>


From gdamjan at mail.net.mk  Tue May 22 01:32:22 2001
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 21:52:23 2004
Subject: [mod_python] mod_python and locale
In-Reply-To: <20010519045121.32984.qmail@web14306.mail.yahoo.com>; from teepwalla@yahoo.com on Fri, May 18, 2001 at 09:51:21PM -0700
References: <20010519045121.32984.qmail@web14306.mail.yahoo.com>
Message-ID: <20010522013222.A259@local.izmislen.mk>

> I've come across a problem with mod_python (2.7.2
> compiled with Python 2.0 --with-threads=no) on Linux
> (RH 7.0) regarding locale.
> 
> the following code (mptest.py):
> -----------------
> from mod_python import apache
> from locale import setlocale,LC_ALL,format
> 
> 
> def handler(req):
>     req.content_type = "text/plain"
>     req.send_http_header()
>     setlocale(LC_ALL,'')

This command set the locale to the one specified with the LC_xx or LANG
enviroment variables.

>     a = 123123231.323    
>     req.write("The formatted version of the number %s
> is %s" % (a,format('%.2f',a,1)))
>     return apache.OK
> 
> Produces:
> ----------------------
> The formatted version of the number 123123231.323 is
> 123123231.32
> 
> Rather than the expected
> -----------------------
> ....123,123,231.32

When you run your scripts interactively you have defined some locale by the
LC_xxx or the LANG variable. On the other side, it seems that your Apache 
process is using the default locale (C), so that's why the formating looks 
like that.

I would use -- setlocale(LC_ALL,'mk_MK') -- to get macedonian localization in
python scripts, but perhaps you would like to change this on a per user 
preference.



-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From teep at inet.co.th  Tue May 22 19:39:11 2001
From: teep at inet.co.th (Prateep Siamwalla)
Date: Fri Jan  9 21:52:23 2004
Subject: [mod_python] mod_python and locale
Message-ID: <002901c0e2bc$39d40860$0c05a8c0@taramansion.bangkok>

Yes!!! Thanks alot, Damjam....shame on me for not reading the docs on locale
more closely.

teep




From sam at webslingerZ.com  Tue May 22 09:55:58 2001
From: sam at webslingerZ.com (Sam Brauer)
Date: Fri Jan  9 21:52:23 2004
Subject: [mod_python] ANN: new release of maki
Message-ID: <Pine.LNX.4.31.0105220955150.1926-100000@localhost.localdomain>

I've released a new version of maki at http://maki.sourceforge.net

maki is a mod_python handler which uses various 4Suite components to serve
XML with Apache.  It allows a web developer to specify processing rules
based on path-matching regular expressions.  Each rule describes a
pipeline with any number of XSLT steps and/or custom processing steps.  A
processor that evaluates embedded Python source to dynamically modify the
document is included.  maki also supports time-based caching of output.
Also included are two example "logicsheets": one that adds HTTP request
data to the document and another that executes SQL queries and creates
elements from the results.

The overall functionality is similar (though intentionally not identical)
to Cocoon.

For more info, please take a look at the online documentation at
http://maki.sourceforge.net/manual/

Thank you,
Sam

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Sam Brauer : sbrauer@users.sourceforge.net



From dyeung at ust.hk  Wed May 23 15:14:05 2001
From: dyeung at ust.hk (David YEUNG)
Date: Fri Jan  9 21:52:23 2004
Subject: [mod_python] How to set the header 'Content-Disposition:'
Message-ID: <3B0B633D.AEBD803D@ust.hk>

I want to set the header 'Content-Disposition:' field. How can I do that
in the publisher handler.

Thanks

david

From pdeluca at sia.net.au  Thu May 24 21:13:07 2001
From: pdeluca at sia.net.au (Paul De Luca)
Date: Fri Jan  9 21:52:24 2004
Subject: [mod_python] mod python apache problem
Message-ID: <4.3.2.7.2.20010524211137.00acd710@mail.sia.net.au>

Hi,
      I am having some troubles trying to install mod_python onto my home 
PC running Windows ME (hey, its for testing purposes!). I followed the 
directions in the mod python documentation (changing the path when 
necessary). However when I try and start Apache I get the following error:

Syntax error on line 203 of c:/data/apache/conf/httpd.conf:
Cannot load c:/data/apache/modules/mod_python.dll into server: (1157) One 
of the
library files needed to run this application cannot be found:

I think this might have made a mistake at this step of the installation:
 >Move the files in the folder lib inside the mod_python folder (C:\Program
 >Files\Python\lib\mod_python-x\lib\mod_python) to the C:\Program
 >Files\Python\lib\mod_python folder. It's safe to delete these folders we 
just emptied.
but am unsure, as I am using a newer version of python and Apache than 
mentioned in the mod python documentation.

My Setup
Python 2.1  (C:\data\python2.1)
Apache 1.3.19 (C:\data\apache, root dir c:\data\apache\htdocs)
mod_python library files (C:\data\python2.1\Lib\mod_python)
mod_python.dll (C:\data\apache\modules\mod_python.dll)

My Apache httpd.conf


#
# Based upon the NCSA server configuration files originally by Rob McCool.
#
# This is the main Apache server configuration file.  It contains the
# configuration directives that give the server its instructions.
# See <URL:http://www.apache.org/docs/> for detailed information about
# the directives.
#
# Do NOT simply read the instructions in here without understanding
# what they do.  They're here only as hints or reminders.  If you are unsure
# consult the online docs. You have been warned.
#
# After this file is processed, the server will look for and process
# C:/data/apache/conf/srm.conf and then C:/data/apache/conf/access.conf
# unless you have overridden these with ResourceConfig and/or
# AccessConfig directives here.
#
# The configuration directives are grouped into three basic sections:
#  1. Directives that control the operation of the Apache server process as a
#     whole (the 'global environment').
#  2. Directives that define the parameters of the 'main' or 'default' server,
#     which responds to requests that aren't handled by a virtual host.
#     These directives also provide default values for the settings
#     of all virtual hosts.
#  3. Settings for virtual hosts, which allow Web requests to be sent to
#     different IP addresses or hostnames and have them handled by the
#     same Apache server process.
#
# Configuration and logfile names: If the filenames you specify for many
# of the server's control files begin with "/" (or "drive:/" for Win32), the
# server will use that explicit path.  If the filenames do *not* begin
# with "/", the value of ServerRoot is prepended -- so "logs/foo.log"
# with ServerRoot set to "/usr/local/apache" will be interpreted by the
# server as "/usr/local/apache/logs/foo.log".
#
# NOTE: Where filenames are specified, you must use forward slashes
# instead of backslashes (e.g., "c:/apache" instead of "c:\apache").
# If a drive letter is omitted, the drive on which Apache.exe is located
# will be used by default.  It is recommended that you always supply
# an explicit drive letter in absolute paths, however, to avoid
# confusion.
#

### Section 1: Global Environment
#
# The directives in this section affect the overall operation of Apache,
# such as the number of concurrent requests it can handle or where it
# can find its configuration files.
#

#
# ServerType is either inetd, or standalone.  Inetd mode is only supported on
# Unix platforms.
#
ServerType standalone

#
# ServerRoot: The top of the directory tree under which the server's
# configuration, error, and log files are kept.
#
ServerRoot "C:/data/apache"

#
# PidFile: The file in which the server should record its process
# identification number when it starts.
#
PidFile logs/httpd.pid

#
# ScoreBoardFile: File used to store internal server process information.
# Not all architectures require this.  But if yours does (you'll know because
# this file will be  created when you run Apache) then you *must* ensure that
# no two invocations of Apache share the same scoreboard file.
#
ScoreBoardFile logs/apache_runtime_status

#
# In the standard configuration, the server will process httpd.conf (this
# file, specified by the -f command line option), srm.conf, and access.conf
# in that order.  The latter two files are now distributed empty, as it is
# recommended that all directives be kept in a single file for simplicity.
# The commented-out values below are the built-in defaults.  You can have the
# server ignore these files altogether by using "/dev/null" (for Unix) or
# "nul" (for Win32) for the arguments to the directives.
#
#ResourceConfig conf/srm.conf
#AccessConfig conf/access.conf

#
# Timeout: The number of seconds before receives and sends time out.
#
Timeout 300

#
# KeepAlive: Whether or not to allow persistent connections (more than
# one request per connection). Set to "Off" to deactivate.
#
KeepAlive On

#
# MaxKeepAliveRequests: The maximum number of requests to allow
# during a persistent connection. Set to 0 to allow an unlimited amount.
# We recommend you leave this number high, for maximum performance.
#
MaxKeepAliveRequests 100

#
# KeepAliveTimeout: Number of seconds to wait for the next request from the
# same client on the same connection.
#
KeepAliveTimeout 15

#
# Apache on Win32 always creates one child process to handle requests.  If it
# dies, another child process is created automatically.  Within the child
# process multiple threads handle incoming requests.  The next two
# directives control the behaviour of the threads and processes.
#

#
# MaxRequestsPerChild: the number of requests each child process is
# allowed to process before the child dies.  The child will exit so
# as to avoid problems after prolonged use when Apache (and maybe the
# libraries it uses) leak memory or other resources.  On most systems, this
# isn't really needed, but a few (such as Solaris) do have notable leaks
# in the libraries.  For Win32, set this value to zero (unlimited)
# unless advised otherwise.
#
# NOTE: This value does not include keepalive requests after the initial
#       request per connection. For example, if a child process handles
#       an initial request and 10 subsequent "keptalive" requests, it
#       would only count as 1 request towards this limit.
#
MaxRequestsPerChild 0

#
# Number of concurrent threads (i.e., requests) the server will allow.
# Set this value according to the responsiveness of the server (more
# requests active at once means they're all handled more slowly) and
# the amount of system resources you'll allow the server to consume.
#
ThreadsPerChild 50

#
# Listen: Allows you to bind Apache to specific IP addresses and/or
# ports, in addition to the default. See also the <VirtualHost>
# directive.
#
#Listen 3000
#Listen 12.34.56.78:80

#
# BindAddress: You can support virtual hosts with this option. This directive
# is used to tell the server which IP address to listen to. It can either
# contain "*", an IP address, or a fully qualified Internet domain name.
# See also the <VirtualHost> and Listen directives.
#
#BindAddress *

#
# Apache Modules compiled into the standard Windows build
#
# The following modules are bound into the standard Apache binary distribution
# for Windows.  To change the standard behavior, uncomment the following lines
# and modify the list of those specific modules to be enabled in the server.
#
# WARNING: This is an advanced option that may render your server inoperable!
# Do not use these directives without expert guidance.
#
#ClearModuleList
#AddModule mod_so.c mod_mime.c mod_access.c mod_auth.c mod_negotiation.c
#AddModule mod_include.c mod_autoindex.c mod_dir.c mod_cgi.c mod_userdir.c
#AddModule mod_alias.c mod_env.c mod_log_config.c mod_asis.c mod_imap.c
#AddModule mod_actions.c mod_setenvif.c mod_isapi.c

#
# Dynamic Shared Object (DSO) Support
#
# To be able to use the functionality of a module which was built as a DSO you
# have to place corresponding `LoadModule' lines at this location so the
# directives contained in it are actually available _before_ they are used.
# Please read the file README.DSO in the Apache 1.3 distribution for more
# details about the DSO mechanism and run `apache -l' for the list of already
# built-in (statically linked and thus always available) modules in your Apache
# binary.
#
# Note: The order in which modules are loaded is important.  Don't change
# the order below without expert advice.
#
#LoadModule anon_auth_module modules/mod_auth_anon.so
#LoadModule dbm_auth_module modules/mod_auth_dbm.so
#LoadModule digest_auth_module modules/mod_auth_digest.so
#LoadModule cern_meta_module modules/mod_cern_meta.so
#LoadModule digest_module modules/mod_digest.so
#LoadModule expires_module modules/mod_expires.so
#LoadModule headers_module modules/mod_headers.so
#LoadModule proxy_module modules/mod_proxy.so
#LoadModule rewrite_module modules/mod_rewrite.so
#LoadModule speling_module modules/mod_speling.so
#LoadModule info_module modules/mod_info.so
#LoadModule status_module modules/mod_status.so
#LoadModule usertrack_module modules/mod_usertrack.so
LoadModule python_module modules/mod_python.dll

#
# ExtendedStatus controls whether Apache will generate "full" status
# information (ExtendedStatus On) or just basic information (ExtendedStatus
# Off) when the "server-status" handler is called. The default is Off.
#
#ExtendedStatus On

### Section 2: 'Main' server configuration
#
# The directives in this section set up the values used by the 'main'
# server, which responds to any requests that aren't handled by a
# <VirtualHost> definition.  These values also provide defaults for
# any <VirtualHost> containers you may define later in the file.
#
# All of these directives may appear inside <VirtualHost> containers,
# in which case these default settings will be overridden for the
# virtual host being defined.
#

#
# Port: The port to which the standalone server listens.  Certain firewall
# products must be configured before Apache can listen to a specific port.
# Other running httpd servers will also interfere with this port.  Disable
# all firewall, security, and other services if you encounter problems.
# To help diagnose problems use the Windows NT command NETSTAT -a
#
Port 80

#
# ServerAdmin: Your address, where problems with the server should be
# e-mailed.  This address appears on some server-generated pages, such
# as error documents.
#
ServerAdmin pdeluca@sia.net.au

#
# ServerName allows you to set a host name which is sent back to clients for
# your server if it's different than the one the program would get (i.e., use
# "www" instead of the host's real name).
#
# Note: You cannot just invent host names and hope they work. The name you
# define here must be a valid DNS name for your host. If you don't understand
# this, ask your network administrator.
# If your host doesn't have a registered DNS name, enter its IP address here.
# You will have to access it by its address (e.g., http://123.45.67.89/)
# anyway, and this will make redirections work in a sensible way.
#
# 127.0.0.1 is the TCP/IP local loop-back address, often named localhost. Your
# machine always knows itself by this address. If you use Apache strictly for
# local testing and development, you may use 127.0.0.1 as the server name.
#
ServerName localhost


#
# DocumentRoot: The directory out of which you will serve your
# documents. By default, all requests are taken from this directory, but
# symbolic links and aliases may be used to point to other locations.
#
DocumentRoot "C:/data/apache/htdocs"

#
# Each directory to which Apache has access, can be configured with respect
# to which services and features are allowed and/or disabled in that
# directory (and its subdirectories).
#
# First, we configure the "default" to be a very restrictive set of
# permissions.
#
<Directory />
     Options FollowSymLinks
     AllowOverride None
</Directory>

#
# Note that from this point forward you must specifically allow
# particular features to be enabled - so if something's not working as
# you might expect, make sure that you have specifically enabled it
# below.
#

#
# This should be changed to whatever you set DocumentRoot to.
#
<Directory "C:/data/apache/htdocs">

#
# This may also be "None", "All", or any combination of "Indexes",
# "Includes", "FollowSymLinks", "ExecCGI", or "MultiViews".
#
# Note that "MultiViews" must be named *explicitly* --- "Options All"
# doesn't give it to you.
#
     Options Indexes FollowSymLinks MultiViews

#
# This controls which options the .htaccess files in directories can
# override. Can also be "All", or any combination of "Options", "FileInfo",
# "AuthConfig", and "Limit"
#
     AllowOverride None

#
# Controls who can get stuff from this server.
#
     Order allow,deny
     Allow from all
</Directory>

#
# UserDir: The name of the directory which is appended onto a user's home
# directory if a ~user request is received.
#
# Under Win32, we do not currently try to determine the home directory of
# a Windows login, so a format such as that below needs to be used.  See
# the UserDir documentation for details.
#
<IfModule mod_userdir.c>
     UserDir "C:/data/apache/users/"
</IfModule>

#
# Control access to UserDir directories.  The following is an example
# for a site where these directories are restricted to read-only.
#
#<Directory "C:/data/apache/users">
#    AllowOverride FileInfo AuthConfig Limit
#    Options MultiViews Indexes SymLinksIfOwnerMatch IncludesNoExec
#    <Limit GET POST OPTIONS PROPFIND>
#        Order allow,deny
#        Allow from all
#    </Limit>
#    <LimitExcept GET POST OPTIONS PROPFIND>
#        Order deny,allow
#        Deny from all
#    </LimitExcept>
#</Directory>

#
# DirectoryIndex: Name of the file or files to use as a pre-written HTML
# directory index.  Separate multiple entries with spaces.
#
<IfModule mod_dir.c>
     DirectoryIndex index.html
</IfModule>

#
# AccessFileName: The name of the file to look for in each directory
# for access control information.
#
AccessFileName .htaccess

#
# The following lines prevent .htaccess files from being viewed by
# Web clients.  Since .htaccess files often contain authorization
# information, access is disallowed for security reasons.  Comment
# these lines out if you want Web visitors to see the contents of
# .htaccess files.  If you change the AccessFileName directive above,
# be sure to make the corresponding changes here.
#
# Also, folks tend to use names such as .htpasswd for password
# files, so this will protect those as well.
#
<Files ~ "^\.ht">
     Order allow,deny
     Deny from all
</Files>

#
# CacheNegotiatedDocs: By default, Apache sends "Pragma: no-cache" with each
# document that was negotiated on the basis of content. This asks proxy
# servers not to cache the document. Uncommenting the following line disables
# this behavior, and proxies will be allowed to cache the documents.
#
#CacheNegotiatedDocs

#
# UseCanonicalName:  (new for 1.3)  With this setting turned on, whenever
# Apache needs to construct a self-referencing URL (a URL that refers back
# to the server the response is coming from) it will use ServerName and
# Port to form a "canonical" name.  With this setting off, Apache will
# use the hostname:port that the client supplied, when possible.  This
# also affects SERVER_NAME and SERVER_PORT in CGI scripts.
#
UseCanonicalName On

#
# TypesConfig describes where the mime.types file (or equivalent) is
# to be found.
#
<IfModule mod_mime.c>
     TypesConfig conf/mime.types
</IfModule>

#
# DefaultType is the default MIME type the server will use for a document
# if it cannot otherwise determine one, such as from filename extensions.
# If your server contains mostly text or HTML documents, "text/plain" is
# a good value.  If most of your content is binary, such as applications
# or images, you may want to use "application/octet-stream" instead to
# keep browsers from trying to display binary files as though they are
# text.
#
DefaultType text/plain

#
# The mod_mime_magic module allows the server to use various hints from the
# contents of the file itself to determine its type.  The MIMEMagicFile
# directive tells the module where the hint definitions are located.
# mod_mime_magic is not part of the default server (you have to add
# it yourself with a LoadModule [see the DSO paragraph in the 'Global
# Environment' section], or recompile the server and include mod_mime_magic
# as part of the configuration), so it's enclosed in an <IfModule> container.
# This means that the MIMEMagicFile directive will only be processed if the
# module is part of the server.
#
<IfModule mod_mime_magic.c>
     MIMEMagicFile conf/magic
</IfModule>

#
# HostnameLookups: Log the names of clients or just their IP addresses
# e.g., www.apache.org (on) or 204.62.129.132 (off).
# The default is off because it'd be overall better for the net if people
# had to knowingly turn this feature on, since enabling it means that
# each client request will result in AT LEAST one lookup request to the
# nameserver.
#
HostnameLookups Off

#
# ErrorLog: The location of the error log file.
# If you do not specify an ErrorLog directive within a <VirtualHost>
# container, error messages relating to that virtual host will be
# logged here.  If you *do* define an error logfile for a <VirtualHost>
# container, that host's errors will be logged there and not here.
#
ErrorLog logs/error.log

#
# LogLevel: Control the number of messages logged to the error.log.
# Possible values include: debug, info, notice, warn, error, crit,
# alert, emerg.
#
LogLevel warn

#
# The following directives define some format nicknames for use with
# a CustomLog directive (see below).
#
LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\"" 
combined
LogFormat "%h %l %u %t \"%r\" %>s %b" common
LogFormat "%{Referer}i -> %U" referer
LogFormat "%{User-agent}i" agent

#
# The location and format of the access logfile (Common Logfile Format).
# If you do not define any access logfiles within a <VirtualHost>
# container, they will be logged here.  Contrariwise, if you *do*
# define per-<VirtualHost> access logfiles, transactions will be
# logged therein and *not* in this file.
#
CustomLog logs/access.log common

#
# If you would like to have agent and referer logfiles, uncomment the
# following directives.
#
#CustomLog logs/referer.log referer
#CustomLog logs/agent.log agent

#
# If you prefer a single logfile with access, agent, and referer information
# (Combined Logfile Format) you can use the following directive.
#
#CustomLog logs/access.log combined

#
# Optionally add a line containing the server version and virtual host
# name to server-generated pages (error documents, FTP directory listings,
# mod_status and mod_info output etc., but not CGI generated documents).
# Set to "EMail" to also include a mailto: link to the ServerAdmin.
# Set to one of:  On | Off | EMail
#
ServerSignature On

#
# Apache parses all CGI scripts for the shebang line by default.
# This comment line, the first line of the script, consists of the symbols
# pound (#) and exclamation (!) followed by the path of the program that
# can execute this specific script.  For a perl script, with perl.exe in
# the C:\Program Files\Perl directory, the shebang line should be:

    #!c:/program files/perl/perl

# Note you _must_not_ indent the actual shebang line, and it must be the
# first line of the file.  Of course, CGI processing must be enabled by
# the appropriate ScriptAlias or Options ExecCGI directives for the files
# or directory in question.
#
# However, Apache on Windows allows either the Unix behavior above, or can
# use the Registry to match files by extention.  The command to execute
# a file of this type is retrieved from the registry by the same method as
# the Windows Explorer would use to handle double-clicking on a file.
# These script actions can be configured from the Windows Explorer View menu,
# 'Folder Options', and reviewing the 'File Types' tab.  Clicking the Edit
# button allows you to modify the Actions, of which Apache 1.3 attempts to
# perform the 'Open' Action, and failing that it will try the shebang line.
# This behavior is subject to change in Apache release 2.0.
#
# Each mechanism has it's own specific security weaknesses, from the means
# to run a program you didn't intend the website owner to invoke, and the
# best method is a matter of great debate.
#
# To enable the this Windows specific behavior (and therefore -disable- the
# equivilant Unix behavior), uncomment the following directive:
#
#ScriptInterpreterSource registry
#
# The directive above can be placed in individual <Directory> blocks or the
# .htaccess file, with either the 'registry' (Windows behavior) or 'script'
# (Unix behavior) option, and will override this server default option.
#

#
# Aliases: Add here as many aliases as you need (with no limit). The format is
# Alias fakename realname
#
<IfModule mod_alias.c>

     #
     # Note that if you include a trailing / on fakename then the server will
     # require it to be present in the URL.  So "/icons" isn't aliased in this
     # example, only "/icons/"..
     #
     Alias /icons/ "C:/data/apache/icons/"

     <Directory "C:/data/apache/icons">
         Options Indexes MultiViews
         AllowOverride None
         Order allow,deny
         Allow from all
     </Directory>

     #
     # ScriptAlias: This controls which directories contain server scripts.
     # ScriptAliases are essentially the same as Aliases, except that
     # documents in the realname directory are treated as applications and
     # run by the server when requested rather than as documents sent to 
the client.
     # The same rules about trailing "/" apply to ScriptAlias directives as to
     # Alias.
     #
     ScriptAlias /cgi-bin/ "C:/data/apache/cgi-bin/"

     #
     # "C:/data/apache/cgi-bin" should be changed to whatever your 
ScriptAliased
     # CGI directory exists, if you have that configured.
     #
     <Directory "C:/data/apache/cgi-bin">
         AllowOverride None
         Options None
         Order allow,deny
         Allow from all
     </Directory>

     <Directory "c:/data/apache/htdocs/python">
     	AddHandler python-program .py
     	PythonHandler test
     	PythonDebug on
     </Directory>

</IfModule>
# End of aliases.

#
# Redirect allows you to tell clients about documents which used to exist in
# your server's namespace, but do not anymore. This allows you to tell the
# clients where to look for the relocated document.
# Format: Redirect old-URI new-URL
#

#
# Directives controlling the display of server-generated directory listings.
#
<IfModule mod_autoindex.c>

     #
     # FancyIndexing is whether you want fancy directory indexing or standard
     #
     # Note, add the option TrackModified to the IndexOptions default list only
     # if all indexed directories reside on NTFS volumes.  The 
TrackModified flag
     # will report the Last-Modified date to assist caches and proxies to 
properly
     # track directory changes, but it does _not_ work on FAT volumes.
     #
     IndexOptions FancyIndexing

     #
     # AddIcon* directives tell the server which icon to show for different
     # files or filename extensions.  These are only displayed for
     # FancyIndexed directories.
     #
     AddIconByEncoding (CMP,/icons/compressed.gif) x-compress x-gzip

     AddIconByType (TXT,/icons/text.gif) text/*
     AddIconByType (IMG,/icons/image2.gif) image/*
     AddIconByType (SND,/icons/sound2.gif) audio/*
     AddIconByType (VID,/icons/movie.gif) video/*

     AddIcon /icons/binary.gif .bin .exe
     AddIcon /icons/binhex.gif .hqx
     AddIcon /icons/tar.gif .tar
     AddIcon /icons/world2.gif .wrl .wrl.gz .vrml .vrm .iv
     AddIcon /icons/compressed.gif .Z .z .tgz .gz .zip
     AddIcon /icons/a.gif .ps .ai .eps
     AddIcon /icons/layout.gif .html .shtml .htm .pdf
     AddIcon /icons/text.gif .txt
     AddIcon /icons/c.gif .c
     AddIcon /icons/p.gif .pl .py
     AddIcon /icons/f.gif .for
     AddIcon /icons/dvi.gif .dvi
     AddIcon /icons/uuencoded.gif .uu
     AddIcon /icons/script.gif .conf .sh .shar .csh .ksh .tcl
     AddIcon /icons/tex.gif .tex
     AddIcon /icons/bomb.gif core

     AddIcon /icons/back.gif ..
     AddIcon /icons/hand.right.gif README
     AddIcon /icons/folder.gif ^^DIRECTORY^^
     AddIcon /icons/blank.gif ^^BLANKICON^^

     #
     # DefaultIcon is which icon to show for files which do not have an icon
     # explicitly set.
     #
     DefaultIcon /icons/unknown.gif

     #
     # AddDescription allows you to place a short description after a file in
     # server-generated indexes.  These are only displayed for FancyIndexed
     # directories.
     # Format: AddDescription "description" filename
     #
     #AddDescription "GZIP compressed document" .gz
     #AddDescription "tar archive" .tar
     #AddDescription "GZIP compressed tar archive" .tgz

     #
     # ReadmeName is the name of the README file the server will look for by
     # default, and append to directory listings.
     #
     # HeaderName is the name of a file which should be prepended to
     # directory indexes.
     #
     # If MultiViews are amongst the Options in effect, the server will
     # first look for name.html and include it if found.  If name.html
     # doesn't exist, the server will then look for name.txt and include
     # it as plaintext if found.
     #
     ReadmeName README
     HeaderName HEADER

     #
     # IndexIgnore is a set of filenames which directory indexing should ignore
     # and not include in the listing.  Shell-style wildcarding is permitted.
     #
     IndexIgnore .??* *~ *# HEADER* README* RCS CVS *,v *,t

</IfModule>
# End of indexing directives.

#
# Document types.
#
<IfModule mod_mime.c>

     #
     # AddEncoding allows you to have certain browsers (Mosaic/X 2.1+) 
uncompress
     # information on the fly. Note: Not all browsers support this.
     # Despite the name similarity, the following Add* directives have nothing
     # to do with the FancyIndexing customization directives above.
     #
     AddEncoding x-compress Z
     AddEncoding x-gzip gz tgz
     #
     # AddLanguage allows you to specify the language of a document. You can
     # then use content negotiation to give a browser a file in a language
     # it can understand.
     #
     # Note 1: The suffix does not have to be the same as the language
     # keyword --- those with documents in Polish (whose net-standard
     # language code is pl) may wish to use "AddLanguage pl .po" to
     # avoid the ambiguity with the common suffix for perl scripts.
     #
     # Note 2: The example entries below illustrate that in quite
     # some cases the two character 'Language' abbreviation is not
     # identical to the two character 'Country' code for its country,
     # E.g. 'Danmark/dk' versus 'Danish/da'.
     #
     # Note 3: In the case of 'ltz' we violate the RFC by using a three char
     # specifier. But there is 'work in progress' to fix this and get
     # the reference data for rfc1766 cleaned up.
     #
     # Danish (da) - Dutch (nl) - English (en) - Estonian (ee)
     # French (fr) - German (de) - Greek-Modern (el)
     # Italian (it) - Korean (kr) - Norwegian (no)
     # Portugese (pt) - Luxembourgeois* (ltz)
     # Spanish (es) - Swedish (sv) - Catalan (ca) - Czech(cz)
     # Polish (pl) - Brazilian Portuguese (pt-br) - Japanese (ja)
     # Russian (ru)
     #
     AddLanguage da .dk
     AddLanguage nl .nl
     AddLanguage en .en
     AddLanguage et .ee
     AddLanguage fr .fr
     AddLanguage de .de
     AddLanguage el .el
     AddLanguage he .he
     AddCharset ISO-8859-8 .iso8859-8
     AddLanguage it .it
     AddLanguage ja .ja
     AddCharset ISO-2022-JP .jis
     AddLanguage kr .kr
     AddCharset ISO-2022-KR .iso-kr
     AddLanguage no .no
     AddLanguage pl .po
     AddCharset ISO-8859-2 .iso-pl
     AddLanguage pt .pt
     AddLanguage pt-br .pt-br
     AddLanguage ltz .lu
     AddLanguage ca .ca
     AddLanguage es .es
     AddLanguage sv .se
     AddLanguage cz .cz
     AddLanguage ru .ru
     AddLanguage tw .tw
     AddLanguage zh-tw .tw
     AddCharset Big5         .Big5    .big5
     AddCharset WINDOWS-1251 .cp-1251
     AddCharset CP866        .cp866
     AddCharset ISO-8859-5   .iso-ru
     AddCharset KOI8-R       .koi8-r
     AddCharset UCS-2        .ucs2
     AddCharset UCS-4        .ucs4
     AddCharset UTF-8        .utf8

     # LanguagePriority allows you to give precedence to some languages
     # in case of a tie during content negotiation.
     #
     # Just list the languages in decreasing order of preference. We have
     # more or less alphabetized them here. You probably want to change this.
     #
     <IfModule mod_negotiation.c>
         LanguagePriority en da nl et fr de el it ja kr no pl pt pt-br ru 
ltz ca es sv tw
     </IfModule>

     #
     # AddType allows you to tweak mime.types without actually editing it, 
or to
     # make certain files to be certain types.
     #
     # For example, the PHP 3.x module (not part of the Apache distribution 
- see
     # http://www.php.net) will typically use:
     #
     #AddType application/x-httpd-php3 .php3
     #AddType application/x-httpd-php3-source .phps
     #
     # And for PHP 4.x, use:
     #
     #AddType application/x-httpd-php .php
     #AddType application/x-httpd-php-source .phps

     AddType application/x-tar .tgz

     #
     # AddHandler allows you to map certain file extensions to "handlers",
     # actions unrelated to filetype. These can be either built into the server
     # or added with the Action command (see below)
     #
     # If you want to use server side includes, or CGI outside
     # ScriptAliased directories, uncomment the following lines.
     #
     # To use CGI scripts:
     #
     #AddHandler cgi-script .cgi

     #
     # To use server-parsed HTML files
     #
     #AddType text/html .shtml
     #AddHandler server-parsed .shtml

     #
     # Uncomment the following line to enable Apache's send-asis HTTP file
     # feature
     #
     #AddHandler send-as-is asis

     #
     # If you wish to use server-parsed imagemap files, use
     #
     #AddHandler imap-file map

     #
     # To enable type maps, you might want to use
     #
     #AddHandler type-map var

</IfModule>
# End of document types.

#
# Action lets you define media types that will execute a script whenever
# a matching file is called. This eliminates the need for repeated URL
# pathnames for oft-used CGI file processors.
# Format: Action media/type /cgi-script/location
# Format: Action handler-name /cgi-script/location
#

#
# MetaDir: specifies the name of the directory in which Apache can find
# meta information files. These files contain additional HTTP headers
# to include when sending the document
#
#MetaDir .web

#
# MetaSuffix: specifies the file name suffix for the file containing the
# meta information.
#
#MetaSuffix .meta

#
# Customizable error response (Apache style)
#  these come in three flavors
#
#    1) plain text
#ErrorDocument 500 "The server made a boo boo.
#  n.b.  the single leading (") marks it as text, it does not get output
#
#    2) local redirects
#ErrorDocument 404 /missing.html
#  to redirect to local URL /missing.html
#ErrorDocument 404 /cgi-bin/missing_handler.pl
#  N.B.: You can redirect to a script or a document using server-side-includes.
#
#    3) external redirects
#ErrorDocument 402 http://some.other_server.com/subscription_info.html
#  N.B.: Many of the environment variables associated with the original
#  request will *not* be available to such a script.

#
# Customize behaviour based on the browser
#
<IfModule mod_setenvif.c>

     #
     # The following directives modify normal HTTP response behavior.
     # The first directive disables keepalive for Netscape 2.x and browsers 
that
     # spoof it. There are known problems with these browser implementations.
     # The second directive is for Microsoft Internet Explorer 4.0b2
     # which has a broken HTTP/1.1 implementation and does not properly
     # support keepalive when it is used on 301 or 302 (redirect) responses.
     #
     BrowserMatch "Mozilla/2" nokeepalive
     BrowserMatch "MSIE 4\.0b2;" nokeepalive downgrade-1.0 force-response-1.0

     #
     # The following directive disables HTTP/1.1 responses to browsers which
     # are in violation of the HTTP/1.0 spec by not being able to grok a
     # basic 1.1 response.
     #
     BrowserMatch "RealPlayer 4\.0" force-response-1.0
     BrowserMatch "Java/1\.0" force-response-1.0
     BrowserMatch "JDK/1\.0" force-response-1.0

</IfModule>
# End of browser customization directives

#
# Allow server status reports, with the URL of http://servername/server-status
# Change the ".localhost" to match your domain to enable.
#
#<Location /server-status>
#    SetHandler server-status
#    Order deny,allow
#    Deny from all
#    Allow from .localhost
#</Location>

#
# Allow remote server configuration reports, with the URL of
# http://servername/server-info (requires that mod_info.c be loaded).
# Change the ".localhost" to match your domain to enable.
#
#<Location /server-info>
#    SetHandler server-info
#    Order deny,allow
#    Deny from all
#    Allow from .localhost
#</Location>

#
# There have been reports of people trying to abuse an old bug from pre-1.1
# days.  This bug involved a CGI script distributed as a part of Apache.
# By uncommenting these lines you can redirect these attacks to a logging
# script on phf.apache.org.  Or, you can record them yourself, using the script
# support/phf_abuse_log.cgi.
#
#<Location /cgi-bin/phf*>
#    Deny from all
#    ErrorDocument 403 http://phf.apache.org/phf_abuse_log.cgi
#</Location>

#
# Proxy Server directives. Uncomment the following lines to
# enable the proxy server:
#
#<IfModule mod_proxy.c>
#    ProxyRequests On

#    <Directory proxy:*>
#        Order deny,allow
#        Deny from all
#        Allow from .localhost
#    </Directory>

     #
     # Enable/disable the handling of HTTP/1.1 "Via:" headers.
     # ("Full" adds the server version; "Block" removes all outgoing Via: 
headers)
     # Set to one of: Off | On | Full | Block
     #
#    ProxyVia On

     #
     # To enable the cache as well, edit and uncomment the following lines:
     # (no cacheing without CacheRoot)
     #
#    CacheRoot "C:/data/apache/proxy"
#    CacheSize 5
#    CacheGcInterval 4
#    CacheMaxExpire 24
#    CacheLastModifiedFactor 0.1
#    CacheDefaultExpire 1
#    NoCache a_domain.com another_domain.edu joes.garage_sale.com

#</IfModule>
# End of proxy directives.

### Section 3: Virtual Hosts
#
# VirtualHost: If you want to maintain multiple domains/hostnames on your
# machine you can setup VirtualHost containers for them. Most configurations
# use only name-based virtual hosts so the server doesn't need to worry about
# IP addresses. This is indicated by the asterisks in the directives below.
#
# Please see the documentation at <URL:http://www.apache.org/docs/vhosts/>
# for further details before you try to setup virtual hosts.
#
# You may use the command line option '-S' to verify your virtual host
# configuration.

#
# Use name-based virtual hosting.
#
#NameVirtualHost *

#
# VirtualHost example:
# Almost any Apache directive may go into a VirtualHost container.
# The first VirtualHost section is used for requests without a known
# server name.
#
#<VirtualHost *>
#    ServerAdmin webmaster@dummy-host.example.com
#    DocumentRoot /www/docs/dummy-host.example.com
#    ServerName dummy-host.example.com
#    ErrorLog logs/dummy-host.example.com-error_log
#    CustomLog logs/dummy-host.example.com-access_log common
#</VirtualHost>



Apologies for the size of this email, I just need to get this problem 
sorted ASAP. Any help will be greatly appreciated.








-------------------------------------------
Paul De Luca
Email: pdeluca@sia.net.au
Ph: 0414 225561
-------------------------------------------


From grisha at modpython.org  Thu May 24 09:44:54 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:24 2004
Subject: [mod_python] mod python apache problem
In-Reply-To: <4.3.2.7.2.20010524211137.00acd710@mail.sia.net.au>
Message-ID: <Pine.BSF.4.32.0105240943370.30008-100000@localhost>

Most likely this is because the DLL, which was compiled for Windows NT
will not work on ME, because ME doesn't have some libraries that NT has.
But I'm not a Windows expert, this is just a guess.

Grisha

On Thu, 24 May 2001, Paul De Luca wrote:

> Hi,
>       I am having some troubles trying to install mod_python onto my home
> PC running Windows ME (hey, its for testing purposes!). I followed the
> directions in the mod python documentation (changing the path when
> necessary). However when I try and start Apache I get the following error:
>
> Syntax error on line 203 of c:/data/apache/conf/httpd.conf:
> Cannot load c:/data/apache/modules/mod_python.dll into server: (1157) One
> of the
> library files needed to run this application cannot be found:
>
> I think this might have made a mistake at this step of the installation:
>  >Move the files in the folder lib inside the mod_python folder (C:\Program
>  >Files\Python\lib\mod_python-x\lib\mod_python) to the C:\Program
>  >Files\Python\lib\mod_python folder. It's safe to delete these folders we
> just emptied.
> but am unsure, as I am using a newer version of python and Apache than
> mentioned in the mod python documentation.
>
> My Setup
> Python 2.1  (C:\data\python2.1)
> Apache 1.3.19 (C:\data\apache, root dir c:\data\apache\htdocs)
> mod_python library files (C:\data\python2.1\Lib\mod_python)
> mod_python.dll (C:\data\apache\modules\mod_python.dll)
>
> My Apache httpd.conf
>
>
> #
> # Based upon the NCSA server configuration files originally by Rob McCool.
> #
> # This is the main Apache server configuration file.  It contains the
> # configuration directives that give the server its instructions.
> # See <URL:http://www.apache.org/docs/> for detailed information about
> # the directives.
> #
> # Do NOT simply read the instructions in here without understanding
> # what they do.  They're here only as hints or reminders.  If you are unsure
> # consult the online docs. You have been warned.
> #
> # After this file is processed, the server will look for and process
> # C:/data/apache/conf/srm.conf and then C:/data/apache/conf/access.conf
> # unless you have overridden these with ResourceConfig and/or
> # AccessConfig directives here.
> #
> # The configuration directives are grouped into three basic sections:
> #  1. Directives that control the operation of the Apache server process as a
> #     whole (the 'global environment').
> #  2. Directives that define the parameters of the 'main' or 'default' server,
> #     which responds to requests that aren't handled by a virtual host.
> #     These directives also provide default values for the settings
> #     of all virtual hosts.
> #  3. Settings for virtual hosts, which allow Web requests to be sent to
> #     different IP addresses or hostnames and have them handled by the
> #     same Apache server process.
> #
> # Configuration and logfile names: If the filenames you specify for many
> # of the server's control files begin with "/" (or "drive:/" for Win32), the
> # server will use that explicit path.  If the filenames do *not* begin
> # with "/", the value of ServerRoot is prepended -- so "logs/foo.log"
> # with ServerRoot set to "/usr/local/apache" will be interpreted by the
> # server as "/usr/local/apache/logs/foo.log".
> #
> # NOTE: Where filenames are specified, you must use forward slashes
> # instead of backslashes (e.g., "c:/apache" instead of "c:\apache").
> # If a drive letter is omitted, the drive on which Apache.exe is located
> # will be used by default.  It is recommended that you always supply
> # an explicit drive letter in absolute paths, however, to avoid
> # confusion.
> #
>
> ### Section 1: Global Environment
> #
> # The directives in this section affect the overall operation of Apache,
> # such as the number of concurrent requests it can handle or where it
> # can find its configuration files.
> #
>
> #
> # ServerType is either inetd, or standalone.  Inetd mode is only supported on
> # Unix platforms.
> #
> ServerType standalone
>
> #
> # ServerRoot: The top of the directory tree under which the server's
> # configuration, error, and log files are kept.
> #
> ServerRoot "C:/data/apache"
>
> #
> # PidFile: The file in which the server should record its process
> # identification number when it starts.
> #
> PidFile logs/httpd.pid
>
> #
> # ScoreBoardFile: File used to store internal server process information.
> # Not all architectures require this.  But if yours does (you'll know because
> # this file will be  created when you run Apache) then you *must* ensure that
> # no two invocations of Apache share the same scoreboard file.
> #
> ScoreBoardFile logs/apache_runtime_status
>
> #
> # In the standard configuration, the server will process httpd.conf (this
> # file, specified by the -f command line option), srm.conf, and access.conf
> # in that order.  The latter two files are now distributed empty, as it is
> # recommended that all directives be kept in a single file for simplicity.
> # The commented-out values below are the built-in defaults.  You can have the
> # server ignore these files altogether by using "/dev/null" (for Unix) or
> # "nul" (for Win32) for the arguments to the directives.
> #
> #ResourceConfig conf/srm.conf
> #AccessConfig conf/access.conf
>
> #
> # Timeout: The number of seconds before receives and sends time out.
> #
> Timeout 300
>
> #
> # KeepAlive: Whether or not to allow persistent connections (more than
> # one request per connection). Set to "Off" to deactivate.
> #
> KeepAlive On
>
> #
> # MaxKeepAliveRequests: The maximum number of requests to allow
> # during a persistent connection. Set to 0 to allow an unlimited amount.
> # We recommend you leave this number high, for maximum performance.
> #
> MaxKeepAliveRequests 100
>
> #
> # KeepAliveTimeout: Number of seconds to wait for the next request from the
> # same client on the same connection.
> #
> KeepAliveTimeout 15
>
> #
> # Apache on Win32 always creates one child process to handle requests.  If it
> # dies, another child process is created automatically.  Within the child
> # process multiple threads handle incoming requests.  The next two
> # directives control the behaviour of the threads and processes.
> #
>
> #
> # MaxRequestsPerChild: the number of requests each child process is
> # allowed to process before the child dies.  The child will exit so
> # as to avoid problems after prolonged use when Apache (and maybe the
> # libraries it uses) leak memory or other resources.  On most systems, this
> # isn't really needed, but a few (such as Solaris) do have notable leaks
> # in the libraries.  For Win32, set this value to zero (unlimited)
> # unless advised otherwise.
> #
> # NOTE: This value does not include keepalive requests after the initial
> #       request per connection. For example, if a child process handles
> #       an initial request and 10 subsequent "keptalive" requests, it
> #       would only count as 1 request towards this limit.
> #
> MaxRequestsPerChild 0
>
> #
> # Number of concurrent threads (i.e., requests) the server will allow.
> # Set this value according to the responsiveness of the server (more
> # requests active at once means they're all handled more slowly) and
> # the amount of system resources you'll allow the server to consume.
> #
> ThreadsPerChild 50
>
> #
> # Listen: Allows you to bind Apache to specific IP addresses and/or
> # ports, in addition to the default. See also the <VirtualHost>
> # directive.
> #
> #Listen 3000
> #Listen 12.34.56.78:80
>
> #
> # BindAddress: You can support virtual hosts with this option. This directive
> # is used to tell the server which IP address to listen to. It can either
> # contain "*", an IP address, or a fully qualified Internet domain name.
> # See also the <VirtualHost> and Listen directives.
> #
> #BindAddress *
>
> #
> # Apache Modules compiled into the standard Windows build
> #
> # The following modules are bound into the standard Apache binary distribution
> # for Windows.  To change the standard behavior, uncomment the following lines
> # and modify the list of those specific modules to be enabled in the server.
> #
> # WARNING: This is an advanced option that may render your server inoperable!
> # Do not use these directives without expert guidance.
> #
> #ClearModuleList
> #AddModule mod_so.c mod_mime.c mod_access.c mod_auth.c mod_negotiation.c
> #AddModule mod_include.c mod_autoindex.c mod_dir.c mod_cgi.c mod_userdir.c
> #AddModule mod_alias.c mod_env.c mod_log_config.c mod_asis.c mod_imap.c
> #AddModule mod_actions.c mod_setenvif.c mod_isapi.c
>
> #
> # Dynamic Shared Object (DSO) Support
> #
> # To be able to use the functionality of a module which was built as a DSO you
> # have to place corresponding `LoadModule' lines at this location so the
> # directives contained in it are actually available _before_ they are used.
> # Please read the file README.DSO in the Apache 1.3 distribution for more
> # details about the DSO mechanism and run `apache -l' for the list of already
> # built-in (statically linked and thus always available) modules in your Apache
> # binary.
> #
> # Note: The order in which modules are loaded is important.  Don't change
> # the order below without expert advice.
> #
> #LoadModule anon_auth_module modules/mod_auth_anon.so
> #LoadModule dbm_auth_module modules/mod_auth_dbm.so
> #LoadModule digest_auth_module modules/mod_auth_digest.so
> #LoadModule cern_meta_module modules/mod_cern_meta.so
> #LoadModule digest_module modules/mod_digest.so
> #LoadModule expires_module modules/mod_expires.so
> #LoadModule headers_module modules/mod_headers.so
> #LoadModule proxy_module modules/mod_proxy.so
> #LoadModule rewrite_module modules/mod_rewrite.so
> #LoadModule speling_module modules/mod_speling.so
> #LoadModule info_module modules/mod_info.so
> #LoadModule status_module modules/mod_status.so
> #LoadModule usertrack_module modules/mod_usertrack.so
> LoadModule python_module modules/mod_python.dll
>
> #
> # ExtendedStatus controls whether Apache will generate "full" status
> # information (ExtendedStatus On) or just basic information (ExtendedStatus
> # Off) when the "server-status" handler is called. The default is Off.
> #
> #ExtendedStatus On
>
> ### Section 2: 'Main' server configuration
> #
> # The directives in this section set up the values used by the 'main'
> # server, which responds to any requests that aren't handled by a
> # <VirtualHost> definition.  These values also provide defaults for
> # any <VirtualHost> containers you may define later in the file.
> #
> # All of these directives may appear inside <VirtualHost> containers,
> # in which case these default settings will be overridden for the
> # virtual host being defined.
> #
>
> #
> # Port: The port to which the standalone server listens.  Certain firewall
> # products must be configured before Apache can listen to a specific port.
> # Other running httpd servers will also interfere with this port.  Disable
> # all firewall, security, and other services if you encounter problems.
> # To help diagnose problems use the Windows NT command NETSTAT -a
> #
> Port 80
>
> #
> # ServerAdmin: Your address, where problems with the server should be
> # e-mailed.  This address appears on some server-generated pages, such
> # as error documents.
> #
> ServerAdmin pdeluca@sia.net.au
>
> #
> # ServerName allows you to set a host name which is sent back to clients for
> # your server if it's different than the one the program would get (i.e., use
> # "www" instead of the host's real name).
> #
> # Note: You cannot just invent host names and hope they work. The name you
> # define here must be a valid DNS name for your host. If you don't understand
> # this, ask your network administrator.
> # If your host doesn't have a registered DNS name, enter its IP address here.
> # You will have to access it by its address (e.g., http://123.45.67.89/)
> # anyway, and this will make redirections work in a sensible way.
> #
> # 127.0.0.1 is the TCP/IP local loop-back address, often named localhost. Your
> # machine always knows itself by this address. If you use Apache strictly for
> # local testing and development, you may use 127.0.0.1 as the server name.
> #
> ServerName localhost
>
>
> #
> # DocumentRoot: The directory out of which you will serve your
> # documents. By default, all requests are taken from this directory, but
> # symbolic links and aliases may be used to point to other locations.
> #
> DocumentRoot "C:/data/apache/htdocs"
>
> #
> # Each directory to which Apache has access, can be configured with respect
> # to which services and features are allowed and/or disabled in that
> # directory (and its subdirectories).
> #
> # First, we configure the "default" to be a very restrictive set of
> # permissions.
> #
> <Directory />
>      Options FollowSymLinks
>      AllowOverride None
> </Directory>
>
> #
> # Note that from this point forward you must specifically allow
> # particular features to be enabled - so if something's not working as
> # you might expect, make sure that you have specifically enabled it
> # below.
> #
>
> #
> # This should be changed to whatever you set DocumentRoot to.
> #
> <Directory "C:/data/apache/htdocs">
>
> #
> # This may also be "None", "All", or any combination of "Indexes",
> # "Includes", "FollowSymLinks", "ExecCGI", or "MultiViews".
> #
> # Note that "MultiViews" must be named *explicitly* --- "Options All"
> # doesn't give it to you.
> #
>      Options Indexes FollowSymLinks MultiViews
>
> #
> # This controls which options the .htaccess files in directories can
> # override. Can also be "All", or any combination of "Options", "FileInfo",
> # "AuthConfig", and "Limit"
> #
>      AllowOverride None
>
> #
> # Controls who can get stuff from this server.
> #
>      Order allow,deny
>      Allow from all
> </Directory>
>
> #
> # UserDir: The name of the directory which is appended onto a user's home
> # directory if a ~user request is received.
> #
> # Under Win32, we do not currently try to determine the home directory of
> # a Windows login, so a format such as that below needs to be used.  See
> # the UserDir documentation for details.
> #
> <IfModule mod_userdir.c>
>      UserDir "C:/data/apache/users/"
> </IfModule>
>
> #
> # Control access to UserDir directories.  The following is an example
> # for a site where these directories are restricted to read-only.
> #
> #<Directory "C:/data/apache/users">
> #    AllowOverride FileInfo AuthConfig Limit
> #    Options MultiViews Indexes SymLinksIfOwnerMatch IncludesNoExec
> #    <Limit GET POST OPTIONS PROPFIND>
> #        Order allow,deny
> #        Allow from all
> #    </Limit>
> #    <LimitExcept GET POST OPTIONS PROPFIND>
> #        Order deny,allow
> #        Deny from all
> #    </LimitExcept>
> #</Directory>
>
> #
> # DirectoryIndex: Name of the file or files to use as a pre-written HTML
> # directory index.  Separate multiple entries with spaces.
> #
> <IfModule mod_dir.c>
>      DirectoryIndex index.html
> </IfModule>
>
> #
> # AccessFileName: The name of the file to look for in each directory
> # for access control information.
> #
> AccessFileName .htaccess
>
> #
> # The following lines prevent .htaccess files from being viewed by
> # Web clients.  Since .htaccess files often contain authorization
> # information, access is disallowed for security reasons.  Comment
> # these lines out if you want Web visitors to see the contents of
> # .htaccess files.  If you change the AccessFileName directive above,
> # be sure to make the corresponding changes here.
> #
> # Also, folks tend to use names such as .htpasswd for password
> # files, so this will protect those as well.
> #
> <Files ~ "^\.ht">
>      Order allow,deny
>      Deny from all
> </Files>
>
> #
> # CacheNegotiatedDocs: By default, Apache sends "Pragma: no-cache" with each
> # document that was negotiated on the basis of content. This asks proxy
> # servers not to cache the document. Uncommenting the following line disables
> # this behavior, and proxies will be allowed to cache the documents.
> #
> #CacheNegotiatedDocs
>
> #
> # UseCanonicalName:  (new for 1.3)  With this setting turned on, whenever
> # Apache needs to construct a self-referencing URL (a URL that refers back
> # to the server the response is coming from) it will use ServerName and
> # Port to form a "canonical" name.  With this setting off, Apache will
> # use the hostname:port that the client supplied, when possible.  This
> # also affects SERVER_NAME and SERVER_PORT in CGI scripts.
> #
> UseCanonicalName On
>
> #
> # TypesConfig describes where the mime.types file (or equivalent) is
> # to be found.
> #
> <IfModule mod_mime.c>
>      TypesConfig conf/mime.types
> </IfModule>
>
> #
> # DefaultType is the default MIME type the server will use for a document
> # if it cannot otherwise determine one, such as from filename extensions.
> # If your server contains mostly text or HTML documents, "text/plain" is
> # a good value.  If most of your content is binary, such as applications
> # or images, you may want to use "application/octet-stream" instead to
> # keep browsers from trying to display binary files as though they are
> # text.
> #
> DefaultType text/plain
>
> #
> # The mod_mime_magic module allows the server to use various hints from the
> # contents of the file itself to determine its type.  The MIMEMagicFile
> # directive tells the module where the hint definitions are located.
> # mod_mime_magic is not part of the default server (you have to add
> # it yourself with a LoadModule [see the DSO paragraph in the 'Global
> # Environment' section], or recompile the server and include mod_mime_magic
> # as part of the configuration), so it's enclosed in an <IfModule> container.
> # This means that the MIMEMagicFile directive will only be processed if the
> # module is part of the server.
> #
> <IfModule mod_mime_magic.c>
>      MIMEMagicFile conf/magic
> </IfModule>
>
> #
> # HostnameLookups: Log the names of clients or just their IP addresses
> # e.g., www.apache.org (on) or 204.62.129.132 (off).
> # The default is off because it'd be overall better for the net if people
> # had to knowingly turn this feature on, since enabling it means that
> # each client request will result in AT LEAST one lookup request to the
> # nameserver.
> #
> HostnameLookups Off
>
> #
> # ErrorLog: The location of the error log file.
> # If you do not specify an ErrorLog directive within a <VirtualHost>
> # container, error messages relating to that virtual host will be
> # logged here.  If you *do* define an error logfile for a <VirtualHost>
> # container, that host's errors will be logged there and not here.
> #
> ErrorLog logs/error.log
>
> #
> # LogLevel: Control the number of messages logged to the error.log.
> # Possible values include: debug, info, notice, warn, error, crit,
> # alert, emerg.
> #
> LogLevel warn
>
> #
> # The following directives define some format nicknames for use with
> # a CustomLog directive (see below).
> #
> LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\""
> combined
> LogFormat "%h %l %u %t \"%r\" %>s %b" common
> LogFormat "%{Referer}i -> %U" referer
> LogFormat "%{User-agent}i" agent
>
> #
> # The location and format of the access logfile (Common Logfile Format).
> # If you do not define any access logfiles within a <VirtualHost>
> # container, they will be logged here.  Contrariwise, if you *do*
> # define per-<VirtualHost> access logfiles, transactions will be
> # logged therein and *not* in this file.
> #
> CustomLog logs/access.log common
>
> #
> # If you would like to have agent and referer logfiles, uncomment the
> # following directives.
> #
> #CustomLog logs/referer.log referer
> #CustomLog logs/agent.log agent
>
> #
> # If you prefer a single logfile with access, agent, and referer information
> # (Combined Logfile Format) you can use the following directive.
> #
> #CustomLog logs/access.log combined
>
> #
> # Optionally add a line containing the server version and virtual host
> # name to server-generated pages (error documents, FTP directory listings,
> # mod_status and mod_info output etc., but not CGI generated documents).
> # Set to "EMail" to also include a mailto: link to the ServerAdmin.
> # Set to one of:  On | Off | EMail
> #
> ServerSignature On
>
> #
> # Apache parses all CGI scripts for the shebang line by default.
> # This comment line, the first line of the script, consists of the symbols
> # pound (#) and exclamation (!) followed by the path of the program that
> # can execute this specific script.  For a perl script, with perl.exe in
> # the C:\Program Files\Perl directory, the shebang line should be:
>
>     #!c:/program files/perl/perl
>
> # Note you _must_not_ indent the actual shebang line, and it must be the
> # first line of the file.  Of course, CGI processing must be enabled by
> # the appropriate ScriptAlias or Options ExecCGI directives for the files
> # or directory in question.
> #
> # However, Apache on Windows allows either the Unix behavior above, or can
> # use the Registry to match files by extention.  The command to execute
> # a file of this type is retrieved from the registry by the same method as
> # the Windows Explorer would use to handle double-clicking on a file.
> # These script actions can be configured from the Windows Explorer View menu,
> # 'Folder Options', and reviewing the 'File Types' tab.  Clicking the Edit
> # button allows you to modify the Actions, of which Apache 1.3 attempts to
> # perform the 'Open' Action, and failing that it will try the shebang line.
> # This behavior is subject to change in Apache release 2.0.
> #
> # Each mechanism has it's own specific security weaknesses, from the means
> # to run a program you didn't intend the website owner to invoke, and the
> # best method is a matter of great debate.
> #
> # To enable the this Windows specific behavior (and therefore -disable- the
> # equivilant Unix behavior), uncomment the following directive:
> #
> #ScriptInterpreterSource registry
> #
> # The directive above can be placed in individual <Directory> blocks or the
> # .htaccess file, with either the 'registry' (Windows behavior) or 'script'
> # (Unix behavior) option, and will override this server default option.
> #
>
> #
> # Aliases: Add here as many aliases as you need (with no limit). The format is
> # Alias fakename realname
> #
> <IfModule mod_alias.c>
>
>      #
>      # Note that if you include a trailing / on fakename then the server will
>      # require it to be present in the URL.  So "/icons" isn't aliased in this
>      # example, only "/icons/"..
>      #
>      Alias /icons/ "C:/data/apache/icons/"
>
>      <Directory "C:/data/apache/icons">
>          Options Indexes MultiViews
>          AllowOverride None
>          Order allow,deny
>          Allow from all
>      </Directory>
>
>      #
>      # ScriptAlias: This controls which directories contain server scripts.
>      # ScriptAliases are essentially the same as Aliases, except that
>      # documents in the realname directory are treated as applications and
>      # run by the server when requested rather than as documents sent to
> the client.
>      # The same rules about trailing "/" apply to ScriptAlias directives as to
>      # Alias.
>      #
>      ScriptAlias /cgi-bin/ "C:/data/apache/cgi-bin/"
>
>      #
>      # "C:/data/apache/cgi-bin" should be changed to whatever your
> ScriptAliased
>      # CGI directory exists, if you have that configured.
>      #
>      <Directory "C:/data/apache/cgi-bin">
>          AllowOverride None
>          Options None
>          Order allow,deny
>          Allow from all
>      </Directory>
>
>      <Directory "c:/data/apache/htdocs/python">
>      	AddHandler python-program .py
>      	PythonHandler test
>      	PythonDebug on
>      </Directory>
>
> </IfModule>
> # End of aliases.
>
> #
> # Redirect allows you to tell clients about documents which used to exist in
> # your server's namespace, but do not anymore. This allows you to tell the
> # clients where to look for the relocated document.
> # Format: Redirect old-URI new-URL
> #
>
> #
> # Directives controlling the display of server-generated directory listings.
> #
> <IfModule mod_autoindex.c>
>
>      #
>      # FancyIndexing is whether you want fancy directory indexing or standard
>      #
>      # Note, add the option TrackModified to the IndexOptions default list only
>      # if all indexed directories reside on NTFS volumes.  The
> TrackModified flag
>      # will report the Last-Modified date to assist caches and proxies to
> properly
>      # track directory changes, but it does _not_ work on FAT volumes.
>      #
>      IndexOptions FancyIndexing
>
>      #
>      # AddIcon* directives tell the server which icon to show for different
>      # files or filename extensions.  These are only displayed for
>      # FancyIndexed directories.
>      #
>      AddIconByEncoding (CMP,/icons/compressed.gif) x-compress x-gzip
>
>      AddIconByType (TXT,/icons/text.gif) text/*
>      AddIconByType (IMG,/icons/image2.gif) image/*
>      AddIconByType (SND,/icons/sound2.gif) audio/*
>      AddIconByType (VID,/icons/movie.gif) video/*
>
>      AddIcon /icons/binary.gif .bin .exe
>      AddIcon /icons/binhex.gif .hqx
>      AddIcon /icons/tar.gif .tar
>      AddIcon /icons/world2.gif .wrl .wrl.gz .vrml .vrm .iv
>      AddIcon /icons/compressed.gif .Z .z .tgz .gz .zip
>      AddIcon /icons/a.gif .ps .ai .eps
>      AddIcon /icons/layout.gif .html .shtml .htm .pdf
>      AddIcon /icons/text.gif .txt
>      AddIcon /icons/c.gif .c
>      AddIcon /icons/p.gif .pl .py
>      AddIcon /icons/f.gif .for
>      AddIcon /icons/dvi.gif .dvi
>      AddIcon /icons/uuencoded.gif .uu
>      AddIcon /icons/script.gif .conf .sh .shar .csh .ksh .tcl
>      AddIcon /icons/tex.gif .tex
>      AddIcon /icons/bomb.gif core
>
>      AddIcon /icons/back.gif ..
>      AddIcon /icons/hand.right.gif README
>      AddIcon /icons/folder.gif ^^DIRECTORY^^
>      AddIcon /icons/blank.gif ^^BLANKICON^^
>
>      #
>      # DefaultIcon is which icon to show for files which do not have an icon
>      # explicitly set.
>      #
>      DefaultIcon /icons/unknown.gif
>
>      #
>      # AddDescription allows you to place a short description after a file in
>      # server-generated indexes.  These are only displayed for FancyIndexed
>      # directories.
>      # Format: AddDescription "description" filename
>      #
>      #AddDescription "GZIP compressed document" .gz
>      #AddDescription "tar archive" .tar
>      #AddDescription "GZIP compressed tar archive" .tgz
>
>      #
>      # ReadmeName is the name of the README file the server will look for by
>      # default, and append to directory listings.
>      #
>      # HeaderName is the name of a file which should be prepended to
>      # directory indexes.
>      #
>      # If MultiViews are amongst the Options in effect, the server will
>      # first look for name.html and include it if found.  If name.html
>      # doesn't exist, the server will then look for name.txt and include
>      # it as plaintext if found.
>      #
>      ReadmeName README
>      HeaderName HEADER
>
>      #
>      # IndexIgnore is a set of filenames which directory indexing should ignore
>      # and not include in the listing.  Shell-style wildcarding is permitted.
>      #
>      IndexIgnore .??* *~ *# HEADER* README* RCS CVS *,v *,t
>
> </IfModule>
> # End of indexing directives.
>
> #
> # Document types.
> #
> <IfModule mod_mime.c>
>
>      #
>      # AddEncoding allows you to have certain browsers (Mosaic/X 2.1+)
> uncompress
>      # information on the fly. Note: Not all browsers support this.
>      # Despite the name similarity, the following Add* directives have nothing
>      # to do with the FancyIndexing customization directives above.
>      #
>      AddEncoding x-compress Z
>      AddEncoding x-gzip gz tgz
>      #
>      # AddLanguage allows you to specify the language of a document. You can
>      # then use content negotiation to give a browser a file in a language
>      # it can understand.
>      #
>      # Note 1: The suffix does not have to be the same as the language
>      # keyword --- those with documents in Polish (whose net-standard
>      # language code is pl) may wish to use "AddLanguage pl .po" to
>      # avoid the ambiguity with the common suffix for perl scripts.
>      #
>      # Note 2: The example entries below illustrate that in quite
>      # some cases the two character 'Language' abbreviation is not
>      # identical to the two character 'Country' code for its country,
>      # E.g. 'Danmark/dk' versus 'Danish/da'.
>      #
>      # Note 3: In the case of 'ltz' we violate the RFC by using a three char
>      # specifier. But there is 'work in progress' to fix this and get
>      # the reference data for rfc1766 cleaned up.
>      #
>      # Danish (da) - Dutch (nl) - English (en) - Estonian (ee)
>      # French (fr) - German (de) - Greek-Modern (el)
>      # Italian (it) - Korean (kr) - Norwegian (no)
>      # Portugese (pt) - Luxembourgeois* (ltz)
>      # Spanish (es) - Swedish (sv) - Catalan (ca) - Czech(cz)
>      # Polish (pl) - Brazilian Portuguese (pt-br) - Japanese (ja)
>      # Russian (ru)
>      #
>      AddLanguage da .dk
>      AddLanguage nl .nl
>      AddLanguage en .en
>      AddLanguage et .ee
>      AddLanguage fr .fr
>      AddLanguage de .de
>      AddLanguage el .el
>      AddLanguage he .he
>      AddCharset ISO-8859-8 .iso8859-8
>      AddLanguage it .it
>      AddLanguage ja .ja
>      AddCharset ISO-2022-JP .jis
>      AddLanguage kr .kr
>      AddCharset ISO-2022-KR .iso-kr
>      AddLanguage no .no
>      AddLanguage pl .po
>      AddCharset ISO-8859-2 .iso-pl
>      AddLanguage pt .pt
>      AddLanguage pt-br .pt-br
>      AddLanguage ltz .lu
>      AddLanguage ca .ca
>      AddLanguage es .es
>      AddLanguage sv .se
>      AddLanguage cz .cz
>      AddLanguage ru .ru
>      AddLanguage tw .tw
>      AddLanguage zh-tw .tw
>      AddCharset Big5         .Big5    .big5
>      AddCharset WINDOWS-1251 .cp-1251
>      AddCharset CP866        .cp866
>      AddCharset ISO-8859-5   .iso-ru
>      AddCharset KOI8-R       .koi8-r
>      AddCharset UCS-2        .ucs2
>      AddCharset UCS-4        .ucs4
>      AddCharset UTF-8        .utf8
>
>      # LanguagePriority allows you to give precedence to some languages
>      # in case of a tie during content negotiation.
>      #
>      # Just list the languages in decreasing order of preference. We have
>      # more or less alphabetized them here. You probably want to change this.
>      #
>      <IfModule mod_negotiation.c>
>          LanguagePriority en da nl et fr de el it ja kr no pl pt pt-br ru
> ltz ca es sv tw
>      </IfModule>
>
>      #
>      # AddType allows you to tweak mime.types without actually editing it,
> or to
>      # make certain files to be certain types.
>      #
>      # For example, the PHP 3.x module (not part of the Apache distribution
> - see
>      # http://www.php.net) will typically use:
>      #
>      #AddType application/x-httpd-php3 .php3
>      #AddType application/x-httpd-php3-source .phps
>      #
>      # And for PHP 4.x, use:
>      #
>      #AddType application/x-httpd-php .php
>      #AddType application/x-httpd-php-source .phps
>
>      AddType application/x-tar .tgz
>
>      #
>      # AddHandler allows you to map certain file extensions to "handlers",
>      # actions unrelated to filetype. These can be either built into the server
>      # or added with the Action command (see below)
>      #
>      # If you want to use server side includes, or CGI outside
>      # ScriptAliased directories, uncomment the following lines.
>      #
>      # To use CGI scripts:
>      #
>      #AddHandler cgi-script .cgi
>
>      #
>      # To use server-parsed HTML files
>      #
>      #AddType text/html .shtml
>      #AddHandler server-parsed .shtml
>
>      #
>      # Uncomment the following line to enable Apache's send-asis HTTP file
>      # feature
>      #
>      #AddHandler send-as-is asis
>
>      #
>      # If you wish to use server-parsed imagemap files, use
>      #
>      #AddHandler imap-file map
>
>      #
>      # To enable type maps, you might want to use
>      #
>      #AddHandler type-map var
>
> </IfModule>
> # End of document types.
>
> #
> # Action lets you define media types that will execute a script whenever
> # a matching file is called. This eliminates the need for repeated URL
> # pathnames for oft-used CGI file processors.
> # Format: Action media/type /cgi-script/location
> # Format: Action handler-name /cgi-script/location
> #
>
> #
> # MetaDir: specifies the name of the directory in which Apache can find
> # meta information files. These files contain additional HTTP headers
> # to include when sending the document
> #
> #MetaDir .web
>
> #
> # MetaSuffix: specifies the file name suffix for the file containing the
> # meta information.
> #
> #MetaSuffix .meta
>
> #
> # Customizable error response (Apache style)
> #  these come in three flavors
> #
> #    1) plain text
> #ErrorDocument 500 "The server made a boo boo.
> #  n.b.  the single leading (") marks it as text, it does not get output
> #
> #    2) local redirects
> #ErrorDocument 404 /missing.html
> #  to redirect to local URL /missing.html
> #ErrorDocument 404 /cgi-bin/missing_handler.pl
> #  N.B.: You can redirect to a script or a document using server-side-includes.
> #
> #    3) external redirects
> #ErrorDocument 402 http://some.other_server.com/subscription_info.html
> #  N.B.: Many of the environment variables associated with the original
> #  request will *not* be available to such a script.
>
> #
> # Customize behaviour based on the browser
> #
> <IfModule mod_setenvif.c>
>
>      #
>      # The following directives modify normal HTTP response behavior.
>      # The first directive disables keepalive for Netscape 2.x and browsers
> that
>      # spoof it. There are known problems with these browser implementations.
>      # The second directive is for Microsoft Internet Explorer 4.0b2
>      # which has a broken HTTP/1.1 implementation and does not properly
>      # support keepalive when it is used on 301 or 302 (redirect) responses.
>      #
>      BrowserMatch "Mozilla/2" nokeepalive
>      BrowserMatch "MSIE 4\.0b2;" nokeepalive downgrade-1.0 force-response-1.0
>
>      #
>      # The following directive disables HTTP/1.1 responses to browsers which
>      # are in violation of the HTTP/1.0 spec by not being able to grok a
>      # basic 1.1 response.
>      #
>      BrowserMatch "RealPlayer 4\.0" force-response-1.0
>      BrowserMatch "Java/1\.0" force-response-1.0
>      BrowserMatch "JDK/1\.0" force-response-1.0
>
> </IfModule>
> # End of browser customization directives
>
> #
> # Allow server status reports, with the URL of http://servername/server-status
> # Change the ".localhost" to match your domain to enable.
> #
> #<Location /server-status>
> #    SetHandler server-status
> #    Order deny,allow
> #    Deny from all
> #    Allow from .localhost
> #</Location>
>
> #
> # Allow remote server configuration reports, with the URL of
> # http://servername/server-info (requires that mod_info.c be loaded).
> # Change the ".localhost" to match your domain to enable.
> #
> #<Location /server-info>
> #    SetHandler server-info
> #    Order deny,allow
> #    Deny from all
> #    Allow from .localhost
> #</Location>
>
> #
> # There have been reports of people trying to abuse an old bug from pre-1.1
> # days.  This bug involved a CGI script distributed as a part of Apache.
> # By uncommenting these lines you can redirect these attacks to a logging
> # script on phf.apache.org.  Or, you can record them yourself, using the script
> # support/phf_abuse_log.cgi.
> #
> #<Location /cgi-bin/phf*>
> #    Deny from all
> #    ErrorDocument 403 http://phf.apache.org/phf_abuse_log.cgi
> #</Location>
>
> #
> # Proxy Server directives. Uncomment the following lines to
> # enable the proxy server:
> #
> #<IfModule mod_proxy.c>
> #    ProxyRequests On
>
> #    <Directory proxy:*>
> #        Order deny,allow
> #        Deny from all
> #        Allow from .localhost
> #    </Directory>
>
>      #
>      # Enable/disable the handling of HTTP/1.1 "Via:" headers.
>      # ("Full" adds the server version; "Block" removes all outgoing Via:
> headers)
>      # Set to one of: Off | On | Full | Block
>      #
> #    ProxyVia On
>
>      #
>      # To enable the cache as well, edit and uncomment the following lines:
>      # (no cacheing without CacheRoot)
>      #
> #    CacheRoot "C:/data/apache/proxy"
> #    CacheSize 5
> #    CacheGcInterval 4
> #    CacheMaxExpire 24
> #    CacheLastModifiedFactor 0.1
> #    CacheDefaultExpire 1
> #    NoCache a_domain.com another_domain.edu joes.garage_sale.com
>
> #</IfModule>
> # End of proxy directives.
>
> ### Section 3: Virtual Hosts
> #
> # VirtualHost: If you want to maintain multiple domains/hostnames on your
> # machine you can setup VirtualHost containers for them. Most configurations
> # use only name-based virtual hosts so the server doesn't need to worry about
> # IP addresses. This is indicated by the asterisks in the directives below.
> #
> # Please see the documentation at <URL:http://www.apache.org/docs/vhosts/>
> # for further details before you try to setup virtual hosts.
> #
> # You may use the command line option '-S' to verify your virtual host
> # configuration.
>
> #
> # Use name-based virtual hosting.
> #
> #NameVirtualHost *
>
> #
> # VirtualHost example:
> # Almost any Apache directive may go into a VirtualHost container.
> # The first VirtualHost section is used for requests without a known
> # server name.
> #
> #<VirtualHost *>
> #    ServerAdmin webmaster@dummy-host.example.com
> #    DocumentRoot /www/docs/dummy-host.example.com
> #    ServerName dummy-host.example.com
> #    ErrorLog logs/dummy-host.example.com-error_log
> #    CustomLog logs/dummy-host.example.com-access_log common
> #</VirtualHost>
>
>
>
> Apologies for the size of this email, I just need to get this problem
> sorted ASAP. Any help will be greatly appreciated.
>
>
>
>
>
>
>
>
> -------------------------------------------
> Paul De Luca
> Email: pdeluca@sia.net.au
> Ph: 0414 225561
> -------------------------------------------
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From LinscombeJ at cmalliance.org  Thu May 24 09:02:11 2001
From: LinscombeJ at cmalliance.org (Linscombe, Jason)
Date: Fri Jan  9 21:52:24 2004
Subject: [mod_python] SuSE 7.1 RPM mod_python & apache
Message-ID: <CE1A83EC8461D311A81F0060B03C7CAAEF4FE0@mail1.cmalliance.org>

Hi List,

I'm trying to run mod_python over apache and could use some help setting
this up.  Here is my setup...

Apache-1.3.14-6
Python-2.0-6
mod_python-2.7.1-3
Distro: SuSE 7.1 Installed the above with RPM

Here is the python stuff in my httpd.conf
-----------------------------------------------------------------
<IfDefine PYTHON>
LoadModule python_module	/usr/lib/apache/mod_python.so
</IfDefine>

<IfDefine PYTHON>
AddModule mod_python.c
</IfDefine>

<Directory /usr/local/httpd/htdocs/test> 
  AddHandler python-program .py
  PythonHandler mptest 
  PythonDebug On 
</Directory>
-----------------------------------------------------------------


And I have this in a file called /usr/local/httpd/htdocs/test/mptest.py
-----------------------------------------------------------------
from mod_python import apache

def handler(req):
    req.send_http_header()
    req.write("Hello World!")
    return apache.OK
-----------------------------------------------------------------


I have checked all file permissions and everything seems to be OK.  All of
the above was either default in my httpd.conf or what I found in the
"Testing" page on the documentation.  The problem I'm having is with the
above, I try to start apache and I get the following error:

FAILED:  See /var/log/httpd/rcapache.log for details

here is the rcapache.log file...
-----------------------------------------------------------------
Syntax error on line 1634 of /etc/httpd/httpd.conf
Invalid command 'PythonHandler', perhaps mis-spelled or defined by a module
not included in the server configuration.
-----------------------------------------------------------------


Question:  is this mptest.py file necessary for running python scripts over
the web server or is this simply a test?  Being a python newbie, I don't
really know what to do next.  Thanks in advance for any help!

jason


From LinscombeJ at cmalliance.org  Thu May 24 12:20:23 2001
From: LinscombeJ at cmalliance.org (Linscombe, Jason)
Date: Fri Jan  9 21:52:24 2004
Subject: [mod_python] SuSE 7.1 RPM mod_python & apache
Message-ID: <CE1A83EC8461D311A81F0060B03C7CAAEF4FE4@mail1.cmalliance.org>

I tried to simplify things and took it out of the <IfDefine PYTHON> tags and
placed the LoadModule and AddModule lines in the normal place (along with
all the others.  But I'm getting the same error as before.  Does the
<Directory /some/directory/htdocs/test> need to be placed inside another set
of tags or can it simply be appended at the end of the file?  I have it as
the last 5 lines of my httpd.conf

jason



-----Original Message-----
From: Alain T?sio
Sent: Thursday, May 24, 2001 10:54 AM


Hi, I have the same setup without "<IfDefine PYTHON>" and it works ...

Alain



----- Original Message -----
From: "Linscombe, Jason" <LinscombeJ@cmalliance.org>
To: <mod_python@modpython.org>
Sent: Thursday, May 24, 2001 5:02 PM
Subject: [mod_python] SuSE 7.1 RPM mod_python & apache


>
> Hi List,
>
> I'm trying to run mod_python over apache and could use some help setting
> this up.  Here is my setup...
>
> Apache-1.3.14-6
> Python-2.0-6
> mod_python-2.7.1-3
> Distro: SuSE 7.1 Installed the above with RPM
>
> Here is the python stuff in my httpd.conf
> -----------------------------------------------------------------
> <IfDefine PYTHON>
> LoadModule python_module /usr/lib/apache/mod_python.so
> </IfDefine>
>
> <IfDefine PYTHON>
> AddModule mod_python.c
> </IfDefine>
>
> <Directory /usr/local/httpd/htdocs/test>
>   AddHandler python-program .py
>   PythonHandler mptest
>   PythonDebug On
> </Directory>
> -----------------------------------------------------------------
>
>
> And I have this in a file called /usr/local/httpd/htdocs/test/mptest.py
> -----------------------------------------------------------------
> from mod_python import apache
>
> def handler(req):
>     req.send_http_header()
>     req.write("Hello World!")
>     return apache.OK
> -----------------------------------------------------------------
>
>
> I have checked all file permissions and everything seems to be OK.  All of
> the above was either default in my httpd.conf or what I found in the
> "Testing" page on the documentation.  The problem I'm having is with the
> above, I try to start apache and I get the following error:
>
> FAILED:  See /var/log/httpd/rcapache.log for details
>
> here is the rcapache.log file...
> -----------------------------------------------------------------
> Syntax error on line 1634 of /etc/httpd/httpd.conf
> Invalid command 'PythonHandler', perhaps mis-spelled or defined by a
module
> not included in the server configuration.
> -----------------------------------------------------------------
>
>
> Question:  is this mptest.py file necessary for running python scripts
over
> the web server or is this simply a test?  Being a python newbie, I don't
> really know what to do next.  Thanks in advance for any help!
>
> jason
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

From meyer at diku.dk  Fri May 25 02:36:14 2001
From: meyer at diku.dk (Jonas Meyer Rasmussen)
Date: Fri Jan  9 21:52:24 2004
Subject: [mod_python] mod_python on win32
Message-ID: <OHENJJENEHAEEPAOJBHCOEDDCCAA.meyer@diku.dk>

Hi.
I am having alot of trouble getting mod_python to work...
(win32, Win2k Pro, Python 2.1)
apache just denies to load the module in, giving me this error:

Syntax error on line 206 of c:/progra..../httpd.conf:
Cannot load c:/.../apache/modules/mod_python.dll into server: (126) The
specified module could not be found:


I have done this:
added this to httpd.conf:

#placed after other uncommented LoadModules from std config file
LoadModule python_module modules/mod_python.dll


#placed in ifmodule mod_alias.c section
    <Directory "C:/Apache/cgi-bin">
        AddHandler python-program .py
        PythonHandler mptest
        PythonDebug on
    </Directory>



mod_python.dll is in the right place


made a small file in my apache/cgi-bin dir named mptest
which contains the following:

from mod_python import apache

def handler(req):
    req.content_type = "text/plain"
    req.send_http_header()
    req.write("Hello World!")
    return apache.OK


Jonas Meyer Rasmussen


From meyer at diku.dk  Fri May 25 13:03:55 2001
From: meyer at diku.dk (Jonas Meyer Rasmussen)
Date: Fri Jan  9 21:52:24 2004
Subject: [mod_python] mod_python on win32
In-Reply-To: <990766580.3b0de5f4623bb@webmail.uchicago.edu>
Message-ID: <Pine.LNX.4.21.0105251302310.11535-100000@dvalin.diku.dk>

On Thu, 24 May 2001, douglas savitsky wrote:
> 
> I recently upgraded from Python 2.0 to 2.1, and I notice that I am getting the 
> same error.  Perhaps if you go back to 2.0 and see if that works?

Yep that fixed the problem, thank you.

Now i just keep getting an internal server error when i try to load my
mptest.py, it says something about obcallback failed to init
?!?


Jonas Meyer Rasmussen
meyer@diku.dk



From rsalz at zolera.com  Fri May 25 09:41:44 2001
From: rsalz at zolera.com (Rich Salz)
Date: Fri Jan  9 21:52:24 2004
Subject: [mod_python] More file-like behavior
Message-ID: <3B0E6118.9BD61868@zolera.com>

The attached class provides a more complete implementation of Python's
file object.  We'd be quite pleased if it were accepted into the core.
:)
	/r$
-------------- next part --------------
#! /usr/bin/env python
##  ContentReader -- wrapper class for mod_python's request object that
##  provides a more complete set of file methods.
##  Copyright 2001, Zolera Systems, Inc.  All Rights Reserved.
##  This software is distributed under the terms of the mod_python license.
try:
    import xreadlines
except:
    pass

class ContentReader:
    '''A simple object that provides a minimal set of file methods from a
    mod_python request object.  Methods provided: read, readline, readlines,
    close, flush, and tell (and, if available, xreadlines).
    Attributes provided: closed, mode, and name.
    '''

    def __init__(self, req):
	'''req is the mod_python request handler.'''
	self.size = int(req.headers_in['content-length'])
	self.name = '<%s at 0x%x>' % (str(self.__class__), id(self))
	self.req, self.left, self.closed, self.mode = \
		req, self.size, 0, 'r'

    def read(self, size = 0):
	if self.closed: raise ValueError
	if self.left <= 0: return ''
	if size <= 0: size = self.left
	v = self.req.read(size)
	self.left = self.left - len(v)
	return v

    def readline(self, size = 0):
	v = self.req.readline(size)
	if len(v) > 1 and v[-2:] == '\r\n': v = v[:-2] + '\n'
	return v

    def readlines(self, sizehint = None):
	result = []
	while 1:
	    l = x.readline()
	    if l == '': break
	    result.append(l)
	    if sizehint != None:
		sizehint = sizehint - len(l)
		if sizehint <= 0: break
	return result

    def xreadlines(self):
	return xreadlines.xreadlines(self)

    def tell(self):
	return self.size - self.left

    def close(self):
	self.closed = 1

    def flush(self):
	pass
From paullb at bigfoot.com  Fri May 25 17:14:21 2001
From: paullb at bigfoot.com (Brendan Paull)
Date: Fri Jan  9 21:52:24 2004
Subject: [mod_python] Multiple versions on one machine
Message-ID: <5.0.2.1.2.20010525170709.00a0eec0@pop.minet.ca>

Hi,
	On my Red Hat 7.0 system I have two versions of python installed (1.5 and 
2.1) andt hey both work fine. They can be called by typing python1.5 and 
python2.1. I could not deinstall the RPM for 1.5 because there are many 
things that depended on it in my system. However, I have got my mod_python 
(v2.7) working and I can call scripts from inside the html directory 
(/var/www/html/python/ and HTML files for apache are in /var/www/html). 
However, mod_python sees only 1.5. How do I go about getting it to see the 
2.1 as well?

	Also, how would I go about getting python to work as a CGI interpreter, 
again preferably the 2.1 version. I already have perl5 working on the 
system? Is there a how-to somewhere?

I would appreciate any insight into either on of these questions,

Thank you in advance,

Brendan Paull


From grisha at modpython.org  Fri May 25 18:14:02 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:24 2004
Subject: [mod_python] Multiple versions on one machine
In-Reply-To: <5.0.2.1.2.20010525170709.00a0eec0@pop.minet.ca>
Message-ID: <Pine.BSF.4.32.0105251812480.47409-100000@localhost>

mod_python will most likely "see" the one that is invocable as "python"
during compilation. Do you have a python -> python1.5 symlink?

Grisha

On Fri, 25 May 2001, Brendan Paull wrote:

> Hi,
> 	On my Red Hat 7.0 system I have two versions of python installed (1.5 and
> 2.1) andt hey both work fine. They can be called by typing python1.5 and
> python2.1. I could not deinstall the RPM for 1.5 because there are many
> things that depended on it in my system. However, I have got my mod_python
> (v2.7) working and I can call scripts from inside the html directory
> (/var/www/html/python/ and HTML files for apache are in /var/www/html).
> However, mod_python sees only 1.5. How do I go about getting it to see the
> 2.1 as well?
>
> 	Also, how would I go about getting python to work as a CGI interpreter,
> again preferably the 2.1 version. I already have perl5 working on the
> system? Is there a how-to somewhere?
>
> I would appreciate any insight into either on of these questions,
>
> Thank you in advance,
>
> Brendan Paull
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From grisha at modpython.org  Sun May 27 00:52:37 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:24 2004
Subject: [mod_python] More file-like behavior
In-Reply-To: <3B0E6118.9BD61868@zolera.com>
Message-ID: <Pine.BSF.4.32.0105270050470.64009-100000@localhost>

Thanks Rich.

Can you elaborate a bit or give some example on how something like this
would be used? I.e. what advantage it would have over simply doing
req.write() or req.read()?

I'm just trying to get a better idea of how it would fit into mod_python.
:-)

Grisha

On Fri, 25 May 2001, Rich Salz wrote:

> The attached class provides a more complete implementation of Python's
> file object.  We'd be quite pleased if it were accepted into the core.
> :)
> 	/r$


From markb at well.com  Sun May 27 10:27:38 2001
From: markb at well.com (Mark Berry)
Date: Fri Jan  9 21:52:24 2004
Subject: [mod_python] Cookies, Redirects & Headers - Oh My!
Message-ID: <200105271028.DAA01579@smtp.well.com>

Hello List,

After spending almost 2 hours wrestling with the cookies and headers 
from the publisher,  I might suggest that we add a few simple examples 
into the standard documentation showing how to do very  basic but common 
operations.

Also, is there no reason that the publisher couldn't be extended at the 
core level to have something such as session management (using python 
pickling methods) for basic serialization, etc.  Is mod_python kept at 
grass-roots for a good reason? ;-)

I must say that with exceptions of a pool of example code, mod_python 
has been a pleasure to work with.  I would be happy to submit some 
example code to be put into the documentation if interested.

Cheers

.mark

From rsalz at zolera.com  Sun May 27 08:04:05 2001
From: rsalz at zolera.com (Rich Salz)
Date: Fri Jan  9 21:52:24 2004
Subject: [mod_python] More file-like behavior
References: <Pine.BSF.4.32.0105270050470.64009-100000@localhost>
Message-ID: <3B10ED35.CD0D36BC@zolera.com>

> Can you elaborate a bit or give some example on how something like this
> would be used? I.e. what advantage it would have over simply doing
> req.write() or req.read()?

It's a more complete implementation, so anyplace that wants a file
object can pass
	ContentReader(req)

Now, maybe most things just use req.read(), but we (at least) had some
code that wanted filename, etc.
	/r$

From deneb at unixwave.org  Sun May 27 22:12:38 2001
From: deneb at unixwave.org (Deneb)
Date: Fri Jan  9 21:52:24 2004
Subject: [mod_python] Template Class
Message-ID: <20010527221238.A3112@unixwave.org>

Hi,
all just yesterday i finished well a Template Class in order to use it
with modpython, higly ispired from PHPlib Template class, which is 
suitable for all purpose. Actually i use it in some of my projects.
A correct example on how it works, can be found in the PHPlib docs,
at phplib.netuse.de. 
I hope that you find this useful. The code is in the attach.
 
Cheers,
deneb.
 
-------------- next part --------------
#!/usr/bin/python
""" 
/*
 *  PyTemplate - a Simple Python Template Class
 *  Copyright (C) 2001 Giorgio Zoppi <deneb@unixwave.org>
 *
 *  This program is free software; you can redistribute it and/or modify
 *  it under the terms of the GNU General Public License as published by
 *  the Free Software Foundation; either version 2 of the License, or
 *  (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU General Public License for more details.
 *
 *  You should have received a copy of the GNU General Public License
 *  along with this program; if not, write to the Free Software
 *  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 */

This Template file was strictly ported form PHPLIB Template class.
Begin from the port:
28 May 2001

"""
import sys
import re
import os
import string

from stat import *
from types import *

class PyTemplate:
    """A simple Template class"""
    __classname='PyTemplate'
    """0 -> False, 1-> True"""
    __debug	=	1
    __root	=	os.getcwd();
    __unknowns    =       "remove"
    __file	= {}
    __varkeys     = {}
    __varvals     = {}
    __halt_on_error = "yes"
    __last_error    = ""
    
    def __init__(self,root,unknows="remove"):
        self.set_root(root)
	self.set_unknowns(unknows)
	
    def set_root(self,root):
	"""I check if the directory exists"""
	mode = os.stat(root)[ST_MODE]
	if S_ISDIR(mode):
	    """0 -> False, 1-> True"""
	    self.__root=root
	    return 1
	return 0
    def set_unknowns(self,unk):
	self.__unknowns=unk
    def set_file(self,handle,myfile=''):
        if not (type(handle) is DictType):
	    if (myfile==''):
		return 0
	    else:
		self.__file[handle]=self.__filename(myfile)
	else:
	    for (h,f) in handle.items():
		self.__file[h]=self.__filename(f)
		    
    def set_block(self,parent,handle,name=''):
	if not(self.__loadfile(parent)):
	    return 0
	if (name==''):
	    name=handle
	vstr=self.get_var(parent)
	str2 = ''
	for value in vstr:
	    str2 = str2 + value
	reg=r"<!--\s+BEGIN "+handle+"\s+-->(.*)<!--\s+END "+ handle+ "\s+-->"
	matchreg=re.compile(reg,re.S|re.M)
	m=matchreg.findall(str2)
	vname='{' + name + '}'
	vstr2=matchreg.sub(vname,str2)
	self.set_var(name,'')
	self.set_var(handle,m[0])
	self.set_var(parent,vstr2)
    
    def set_var(self,varname1,value=''):
	if not (type(varname1) is DictType):
	    self.__varkeys[varname1]=self.__varname(varname1)
	    self.__varvals[varname1]=value
	else:
	    for vname in varname1.keys():
		self.__varkeys[vname]=self.__varname(vname) 
		self.__varvals[vname]=varname1[vname]
		
	    
    def subst(self,handle):
	if not(self.__loadfile(handle)):
	    return 0
	
	vstr=self.get_var(handle)
	regstr = ''
	for values in vstr:
	    regstr= regstr + values
	vvals= self.__varvals.keys()
	kvals= self.__varkeys.keys()
	key1,key2='',''
	i,j=0,0
	len1,len2=len(vvals),len(kvals)
	while ((i<len1) and (j<len2)):
		key2 = vvals[i]
		key1 = kvals[j]
		vareg=re.compile(self.__varkeys[key1])
    		regstr=vareg.sub(self.__varvals[key2],regstr)
		i,j=i+1,j+1
	return regstr    
    def	psubst(self,handle):
	print self.subst(handle)
	return 0
    def tmpl2str(self,varname):
	return self.finish(self.get_var(varname))
    def parse(self,target,handle, append):
	if not (type(handle) is DictType):
    		vstr=self.subst(handle)
	        if (append==1):
		    mvar = self.get_var(target) + vstr
		    self.set_var(target,mvar)
		else:
		    self.set_var(target,vstr)
	else:	
		vstr = ''	
		for (hname,hvalue) in handle.items():
		    vstr=self.subst(hvalue)  
		    self.set_var(target,vstr)
	#print t.varvals	    
	return vstr
    def get_vars(self): 
	for kname in self.__varkeys.keys():
	    result[kname]=self.__varvals[kname]
	return result
    def get_var(self,varname):
        if not (type(varname) is DictType):
 	    return self.__varvals[varname]
	     
	else:
	    for vname in varname.keys():
		result[vname]=self.__varvals[vname]
	return result
    """def get_undefined --> not implemented"""	    
    def finish(self,vstr):
        regstr1=re.compile('{\[^}+}')
	if (self.__unknowns=="comment"):
	    regstr1.sub("<!--Template not defined -->",vstr)
	elif (self.__unknowns=="remove"):
	    regstr1.sub("",vstr);
	else:
	    self.__unknowns= "keep" """Nothing to do"""
	return vstr	    
    def p(self,varname):
	print self.finish(self.get_var(varname))
    def get(self,varname):
	return self.finish(self.get_var(varname))
    def __filename(self,filename):
	slice=string.find(filename,'/',0,1)
	if (slice==-1):
	    filename= self.__root + '/' + filename
	if not (os.path.isfile(filename)):
	    filename = 0
	return filename
    def __varname(self,varname1):
        var = '{' + varname1 + '}'
	return var
    def __loadfile(self,handle):
	try:
	    if ((self.__varkeys[handle]) and (not (self.__varvals[handle]==''))):
		    return 1
	except KeyError: 
	       new=1
	try:
	   name=self.__file[handle]
	except KeyError:
	    return 0
	filename= self.__filename(name)
	file=open(filename,'r')
	vstr=file.readlines()
	self.set_var(handle,vstr)
	return 1

 		    				        	    
From bl at netgroup.dk  Tue May 29 10:09:19 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:52:24 2004
Subject: [mod_python] Session data
Message-ID: <3B13592F.DB5633BB@netgroup.dk>

Hi ...

I have been trying to write a entry in the mod_python FAQ, but I'm a
quite inpatient person, so I'll ask here too :-)

I really like the way this mod_python thing works, but I have
desperately trying to find a way to store session based data, but
without luck.

Is there a way, or is it necessary to store the session data in a
separate data array, that is mapped to some kind of user Apache info ?
This could be a dumb question, as my knowledge about Apache is quite
limited, so I hope you will forgive if this should be quite obvious.


/BL


From grisha at modpython.org  Tue May 29 08:35:11 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:24 2004
Subject: [mod_python] Session data
In-Reply-To: <3B13592F.DB5633BB@netgroup.dk>
Message-ID: <Pine.BSF.4.32.0105290826550.99341-100000@localhost>

This does indeed seem to be a FAQ, but I don't know if there is a straight
answer to it.

In *my* opinion, trying to maintain state within the server is not
scalable and should be avoided. State should be maintained on the client
side with cookies and url's.

Since Apache 1.3 runs multiple processes, it is impossible to share memory
between them and therefore maintain state in the server.

But even with the new Apache 2.0 (which mod_python does not yet support),
which will be multithreaded, I would stay away from putting state on the
server. If I ever decided that my site is too busy and needs balancing
across multiple servers, I'd be in trouble... Also consider situations
when a request may never reach a server because of some cache inbewteen.

Grisha

On Tue, 29 May 2001, Bo Lorentsen wrote:

> Hi ...
>
> I have been trying to write a entry in the mod_python FAQ, but I'm a
> quite inpatient person, so I'll ask here too :-)
>
> I really like the way this mod_python thing works, but I have
> desperately trying to find a way to store session based data, but
> without luck.
>
> Is there a way, or is it necessary to store the session data in a
> separate data array, that is mapped to some kind of user Apache info ?
> This could be a dumb question, as my knowledge about Apache is quite
> limited, so I hope you will forgive if this should be quite obvious.
>
>
> /BL
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From bl at netgroup.dk  Tue May 29 14:50:28 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:52:24 2004
Subject: [mod_python] Session data
References: <Pine.BSF.4.32.0105290826550.99341-100000@localhost>
Message-ID: <3B139B14.26DF8717@netgroup.dk>

"Gregory (Grisha) Trubetskoy" wrote:

> In *my* opinion, trying to maintain state within the server is not
> scalable and should be avoided. State should be maintained on the client
> side with cookies and url's.

If this is so, shouldn't there be some sort of interface for this ? Or is
this something I should have known more about if I had known the Apache
server better ?

> Since Apache 1.3 runs multiple processes, it is impossible to share memory
> between them and therefore maintain state in the server.

Aha, so this is why the JavaServer make its own service, the Apache direct
requests to !

> But even with the new Apache 2.0 (which mod_python does not yet support),
> which will be multithreaded, I would stay away from putting state on the
> server. If I ever decided that my site is too busy and needs balancing
> across multiple servers, I'd be in trouble... Also consider situations
> when a request may never reach a server because of some cache inbewteen.

You absolutely got a point there.

I just need to gain knowledge about some other ways of maintaining session
data, as until now, I thought that a cookie were just a session reference
number of a kind.

/BL


From jvdev at 3va.net  Tue May 29 15:00:15 2001
From: jvdev at 3va.net (Jeroen van Drie)
Date: Fri Jan  9 21:52:24 2004
Subject: [mod_python] httpd dead but subsys locked
Message-ID: <01052915001503.01699@e109009>

situation:
mod_python, RH 6.2, MySQL-3.23.38-1 all RPM based.

When starting up httpd and running httpd status it returns:
httpd dead but subsys locked

No instance of httpd is found running.

When removing the two mod_python dso lines in the httpd.conf it starts up 
fine.

I have seen these errors on some php mailing lists as well where people seem 
to be relating it to the presence of mysql. There is nothign in the apache 
log file even at debug log level.

A restart of mysql did not help.

I have read that the situation in case of php will be resolved with a server 
reboot. However in this case that would be impractical.

Have any of you experienced this problem and have you found a solution?

Thanks.

From aiglauer at yahoo.com  Tue May 29 06:41:57 2001
From: aiglauer at yahoo.com (Alexis Iglauer)
Date: Fri Jan  9 21:52:24 2004
Subject: [mod_python] httpd dead but subsys locked
In-Reply-To: <01052915001503.01699@e109009>
Message-ID: <20010529134157.247.qmail@web13905.mail.yahoo.com>

My experience is under various versions of Mandrake and Apache 1.3.x.

That message usually comes if apache segfaults.  Check your /var/run
directory for httpd.pid and delete it.

Try running 'httpd -X' to see what error messages you get (often the
problem is threading support or not having the LoadModule line for
mod_python as the first LoadModule in httpd.conf).  My apache always
just crashed - with no debug info - when I loaded a .py file.

Once you have that sorted out (httpd -X runs fine), I find that
'/etc/rc.d/init.d/httpd restart' usually does the trick if you have the
'locked subsystem' error message on starting apache.

Hope this helps
ax

--- Jeroen van Drie <jvdev@3va.net> wrote:
> 
> situation:
> mod_python, RH 6.2, MySQL-3.23.38-1 all RPM based.
> 
> When starting up httpd and running httpd status it returns:
> httpd dead but subsys locked
> 
> No instance of httpd is found running.
> 
> When removing the two mod_python dso lines in the httpd.conf it
> starts up 
> fine.
> 
> I have seen these errors on some php mailing lists as well where
> people seem 
> to be relating it to the presence of mysql. There is nothign in the
> apache 
> log file even at debug log level.
> 
> A restart of mysql did not help.
> 
> I have read that the situation in case of php will be resolved with a
> server 
> reboot. However in this case that would be impractical.
> 
> Have any of you experienced this problem and have you found a
> solution?
> 
> Thanks.
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


__________________________________________________
Do You Yahoo!?
Yahoo! Auctions - buy the things you want at great prices
http://auctions.yahoo.com/

From sam at webslingerZ.com  Tue May 29 09:40:32 2001
From: sam at webslingerZ.com (Sam Brauer)
Date: Fri Jan  9 21:52:25 2004
Subject: [mod_python] Session data
In-Reply-To: <3B139B14.26DF8717@netgroup.dk>
Message-ID: <Pine.LNX.4.31.0105290917340.30341-100000@localhost.localdomain>

On Tue, 29 May 2001, Bo Lorentsen wrote:
<snip>
> I just need to gain knowledge about some other ways of maintaining session
> data, as until now, I thought that a cookie were just a session reference
> number of a kind.
>
> /BL

I think the most portable method (a method with the least
dependency on any particular webserver or application server) is to
maintain the session state in a relational database table and store the
table key value in a cookie.
When a user first hits your site, check for the cookie.
If it exists and matches a record in your table, then treat that record as
that user's session data.
Otherwise, insert a new record and set a session cookie with the key value
of the newly created record.

For applications where security is not a major concern, this method should
be sufficient.  If security is a major concern, you will want to avoid
storing the cookie value as plain text and instead encrypt it in some way.
Also, you may want to set a short expiration time for the cookie, and
perhaps reset it every time you send a response to the user.  You might
also (again, depending on the type of application) want to provide an
explicit logout function that unsets the cookie.
You could also have a field in your table that contains a timestamp that
gets updated every time a request for that session comes in.  Before
updating the field, you might compare its current value with the current
time.  If the difference is greater than some time limit (say 30 minutes),
then you could error out and respond to the user that their session has
expired.

How complicated and secure you want to make it is up to you.

Regards,
Sam Brauer



From jvdev at 3va.net  Tue May 29 16:48:31 2001
From: jvdev at 3va.net (Jeroen van Drie)
Date: Fri Jan  9 21:52:25 2004
Subject: [mod_python] httpd dead but subsys locked
In-Reply-To: <20010529134157.247.qmail@web13905.mail.yahoo.com>
References: <20010529134157.247.qmail@web13905.mail.yahoo.com>
Message-ID: <01052916483108.01699@e109009>

On Tuesday 29 May 2001 15:41 pm, you wrote:

Hi Ax,

When loading with -X i get the "
Loaded DSO modules/mod_python.so uses plain Apache 1.3 API, this module might 
crash under EAPI! (please recompile it with -DEAPI)" 
and it segfaults.

It's the first module defined in httpd.conf.

that hasn't been causing any problems on my 7.1 rh test system and from 
numerous reports I've read people generally seem to disregard the warning.

I got the sources,  edited the Makefile to run apxs with -DEAPI as an 
argument, which however caused the same error and segfault.

I would dearly like to see this issue resolved and if theres anything I can 
do to contribute towards solving it i'd be happy to contribute my time. 



> My experience is under various versions of Mandrake and Apache 1.3.x.
>
> That message usually comes if apache segfaults.  Check your /var/run
> directory for httpd.pid and delete it.
>
> Try running 'httpd -X' to see what error messages you get (often the
> problem is threading support or not having the LoadModule line for
> mod_python as the first LoadModule in httpd.conf).  My apache always
> just crashed - with no debug info - when I loaded a .py file.
>
> Once you have that sorted out (httpd -X runs fine), I find that
> '/etc/rc.d/init.d/httpd restart' usually does the trick if you have the
> 'locked subsystem' error message on starting apache.
>
> Hope this helps
> ax
>
> --- Jeroen van Drie <jvdev@3va.net> wrote:
> > situation:
> > mod_python, RH 6.2, MySQL-3.23.38-1 all RPM based.
> >
> > When starting up httpd and running httpd status it returns:
> > httpd dead but subsys locked
> >
> > No instance of httpd is found running.
> >
> > When removing the two mod_python dso lines in the httpd.conf it
> > starts up
> > fine.
> >
> > I have seen these errors on some php mailing lists as well where
> > people seem
> > to be relating it to the presence of mysql. There is nothign in the
> > apache
> > log file even at debug log level.
> >
> > A restart of mysql did not help.
> >
> > I have read that the situation in case of php will be resolved with a
> > server
> > reboot. However in this case that would be impractical.
> >
> > Have any of you experienced this problem and have you found a
> > solution?
> >
> > Thanks.
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://www.modpython.org/mailman/listinfo/mod_python
>
> __________________________________________________
> Do You Yahoo!?
> Yahoo! Auctions - buy the things you want at great prices
> http://auctions.yahoo.com/

From SumnerH at fool.com  Tue May 29 13:03:49 2001
From: SumnerH at fool.com (G . Sumner Hayes)
Date: Fri Jan  9 21:52:25 2004
Subject: [mod_python] Session data
In-Reply-To: <Pine.BSF.4.32.0105290826550.99341-100000@localhost>; from grisha@modpython.org on Tue, May 29, 2001 at 08:35:11AM -0400
References: <3B13592F.DB5633BB@netgroup.dk> <Pine.BSF.4.32.0105290826550.99341-100000@localhost>
Message-ID: <20010529130349.A17514@fool.com>

Gregory (Grisha) Trubetskoy <grisha@modpython.org> wrote:
> Since Apache 1.3 runs multiple processes, it is impossible to share memory
> between them and therefore maintain state in the server.

You can use either shared mmap or SysV shared mem (there are
python modules for both) to share memory.  I wound up writing
a Python shared dictionary (just pickles objects into the
filesystem when you set them, and unpickles them when you read
them) for my shared state, though I don't share user sessions--I
share things like parsed template files and other cacheable
server-side objects that require an expensive calculation the
first time they're read in.

Same idea would work for user sessions, and since it's in the
filesystem the kernel will take care of buffering for you and you
can use tools like "find" and "rm" to prune the cache. :-)

I agree with Grisha that you probably want to keep state on the
clients if you can, though.

  Sumner

-- 
rage, rage against the dying of the light

From CHagner at fool.com  Tue May 29 13:08:01 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:52:25 2004
Subject: [mod_python] Session data
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E47E7D@rover.foolhq.com>

In my experience, the quickest way to ensure that your web application
scales poorly is to mis-use server-side user sessions (thereby agreeing with
Grisha).  Now, that being said, not everyone needs this level of scalability
AND user sessions are a standard part of almost every-single web application
platform (ASP, Servlets/JSP, ColdFusion, etc.) commercially available.

BTW, I've found that most non-Apache-based web developers (of which I used
to be one :-) are completely ignorant of the realities of running in a
multi-process server.  They generally take for granted the user sessions
built into whatever app server they're using and find it mentally
challenging to truly believe they can live without such functionality.

I like the idea of having a standard interface to whatever mechanism is
responsible for persisting user session information, but I cringe at
incorporating an implementation with mod_python.  Basically, for some people
a pickled object will work fine.  For others a database-based session system
works best.  And some (Grisha) will only be happy with the use of
cookies/urls.

As for multiple-server user sessions, there are some solutions available in
the non-Python space (most of the ones that I've seen use either a database
(ugh :-) or a solution along the lines of Java's RMI to keep the session
pool's in sync.  In either case, it is a non-trivial problem/solution and is
best avoided (following the KISS principle).

You might want to check out WebWare (webware.sourceforge.net) as an expample
web framework that has some session support.  I think they pickle objects to
the file system.  There are some other python-based cgi frameworks that also
support user sessions, but just be aware of how far such solutions will/will
not take you.

Chris

-----Original Message-----
From: Bo Lorentsen [mailto:bl@netgroup.dk]
Sent: Tuesday, May 29, 2001 8:50 AM
To: Gregory (Grisha) Trubetskoy
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Session data


"Gregory (Grisha) Trubetskoy" wrote:

> In *my* opinion, trying to maintain state within the server is not
> scalable and should be avoided. State should be maintained on the client
> side with cookies and url's.

If this is so, shouldn't there be some sort of interface for this ? Or is
this something I should have known more about if I had known the Apache
server better ?

> Since Apache 1.3 runs multiple processes, it is impossible to share memory
> between them and therefore maintain state in the server.

Aha, so this is why the JavaServer make its own service, the Apache direct
requests to !

> But even with the new Apache 2.0 (which mod_python does not yet support),
> which will be multithreaded, I would stay away from putting state on the
> server. If I ever decided that my site is too busy and needs balancing
> across multiple servers, I'd be in trouble... Also consider situations
> when a request may never reach a server because of some cache inbewteen.

You absolutely got a point there.

I just need to gain knowledge about some other ways of maintaining session
data, as until now, I thought that a cookie were just a session reference
number of a kind.

/BL

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python

From gtalvola at nameconnector.com  Tue May 29 14:04:15 2001
From: gtalvola at nameconnector.com (Geoff Talvola)
Date: Fri Jan  9 21:52:25 2004
Subject: [mod_python] Win32 threading issue
Message-ID: <5.0.2.1.0.20010529134743.02ca2d30@infratest1>

I just wanted to confirm that I also get the same behavior on Windows -- if 
I stress out a simple script like the one below with multiple simultaneous 
requests, I get sporadic errors, just as Chris Trengove reported.

I'd be happy to help diagnose and fix the problem, but I know next to 
nothing about Apache and mod_python's internals.  I do have access to VC++ 
6.0 and I have successfully compiled the mod_python dll (for Python 2.1).

Where should I go from here?

>I have been testing the following script on Apache with mod_python (Apache
>1.13.17, mod_python 2.7.2, Windows 2000). I have been interested in testing
>the possible throughput of this (and more useful scripts), so I have
>another Python script which continually loads this "page".
>
>from mod_python import apache
>import thread
>
>def handler(req):
>     req.content_type = "text/plain"
>     req.send_http_header()
>     req.write("%d\n" % thread.get_ident())
>     return apache.OK
>
>When I run more than one copy of the driver script (in multiple consoles),
>I get behavior indicative of some threading problems. Specifically, some
>connections get "lost", the Apache error log reports various instances of
>"IOError: Write failed...", and I occassionally get an access violation
>inside Apache. Similarly, if I only run one copy of the driver script, and
>just keep hitting the refresh button in a browser, the browser
>occassionally returns TWO numbers, and sometimes reports an error in
>retrieving the data. Note that I have tested my driver program retrieving a
>simple text file, and everything works as expected, so it does not appear
>to be a problem with Apache. (The problem also goes away if I set
>ThreadPerChild to 1 in the Apache configuration.)
>
>I have also found that, if I comment out the req.write() statement in the
>handler, then there are no problems. From my examination of the
>implementation of the request object, I see that req_write() contains calls
>to Py_BEGIN_ALLOW_THREADS / Py_END_ALLOW_THREADS, whereas
>req_send_http_header() contains no such calls. This suggests to me that
>some thread switching is occurring inside req_write() which is messing with
>the state of the interpreter.
>
>I would be most grateful if anyone has any information to offer on this.
>
>Chris Trengove


--

- Geoff Talvola
   gtalvola@NameConnector.com

From trengove at econdata.com.au  Wed May 30 09:03:40 2001
From: trengove at econdata.com.au (Chris Trengove)
Date: Fri Jan  9 21:52:25 2004
Subject: [mod_python] Re: Win32 threading issue
In-Reply-To: <5.0.2.1.0.20010529134743.02ca2d30@infratest1>
Message-ID: <200105300905630.SM00248@athene>

Geoff,

This problem has now been fixed, and I expect will be part of mod_python
2.7.4 when Grisha decides to release that. In the mean time, if you have a
desperate need to avoid the threading problem, you can access the modified
files in the CVS.

Chris

At 02:04 PM 29/05/2001 -0400, Geoff Talvola wrote:
>I just wanted to confirm that I also get the same behavior on Windows -- if 
>I stress out a simple script like the one below with multiple simultaneous 
>requests, I get sporadic errors, just as Chris Trengove reported.
>
>I'd be happy to help diagnose and fix the problem, but I know next to 
>nothing about Apache and mod_python's internals.  I do have access to VC++ 
>6.0 and I have successfully compiled the mod_python dll (for Python 2.1).
>
>Where should I go from here?
>

>- Geoff Talvola
>   gtalvola@NameConnector.com
> 

From djc at object-craft.com.au  Wed May 30 10:23:48 2001
From: djc at object-craft.com.au (Dave Cole)
Date: Fri Jan  9 21:52:25 2004
Subject: [mod_python] Session data
In-Reply-To: "Gregory's message of "Tue, 29 May 2001 08:35:11 -0400 (EDT)"
References: <Pine.BSF.4.32.0105290826550.99341-100000@localhost>
Message-ID: <m3elt74rcb.fsf@vole.object-craft.com.au>

>>>>> "Gregory" == Gregory (Grisha) Trubetskoy <grisha@modpython.org> writes:

Gregory> This does indeed seem to be a FAQ, but I don't know if there
Gregory> is a straight answer to it.

Gregory> In *my* opinion, trying to maintain state within the server
Gregory> is not scalable and should be avoided. State should be
Gregory> maintained on the client side with cookies and url's.

Your choice of how to retain session state depends entirely on the
type of application you are building.

Gregory> Since Apache 1.3 runs multiple processes, it is impossible to
Gregory> share memory between them and therefore maintain state in the
Gregory> server.

That is not strictly true.  If you wish to retain state at the server,
you have to write some code.  You can either save state in some sort
of database (not necessarily relational) at the server, or you can
build a session server and cache connections to the server in your
mod_python program.

- Dave

-- 
http://www.object-craft.com.au


From gtalvola at nameconnector.com  Tue May 29 20:28:49 2001
From: gtalvola at nameconnector.com (Geoff Talvola)
Date: Fri Jan  9 21:52:25 2004
Subject: [mod_python] Re: Win32 threading issue
In-Reply-To: <200105300905630.SM00248@athene>
References: <5.0.2.1.0.20010529134743.02ca2d30@infratest1>
Message-ID: <5.0.2.1.0.20010529202540.034332c0@infratest1>

Great!  I love it when bugs have already been fixed.

Grisha, are you planning on releasing 2.7.4 any time soon?  If so, I'll 
just wait for it to be released.


At 09:03 AM 5/30/01 +1000, Chris Trengove wrote:
>Geoff,
>
>This problem has now been fixed, and I expect will be part of mod_python
>2.7.4 when Grisha decides to release that. In the mean time, if you have a
>desperate need to avoid the threading problem, you can access the modified
>files in the CVS.
>
>Chris
>
>At 02:04 PM 29/05/2001 -0400, Geoff Talvola wrote:
> >I just wanted to confirm that I also get the same behavior on Windows -- if
> >I stress out a simple script like the one below with multiple simultaneous
> >requests, I get sporadic errors, just as Chris Trengove reported.
> >
> >I'd be happy to help diagnose and fix the problem, but I know next to
> >nothing about Apache and mod_python's internals.  I do have access to VC++
> >6.0 and I have successfully compiled the mod_python dll (for Python 2.1).
> >
> >Where should I go from here?
> >
>
> >- Geoff Talvola
> >   gtalvola@NameConnector.com
> >

--

- Geoff Talvola
   gtalvola@NameConnector.com

From bl at netgroup.dk  Thu May 31 09:07:33 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:52:25 2004
Subject: [mod_python] Session data
References: <3B13592F.DB5633BB@netgroup.dk> <Pine.BSF.4.32.0105290826550.99341-100000@localhost> <20010529130349.A17514@fool.com>
Message-ID: <3B15EDB5.7E8D811B@netgroup.dk>

"G . Sumner Hayes" wrote:

> You can use either shared mmap or SysV shared mem (there are
> python modules for both) to share memory.  I wound up writing
> a Python shared dictionary (just pickles objects into the
> filesystem when you set them, and unpickles them when you read
> them) for my shared state, though I don't share user sessions--I
> share things like parsed template files and other cacheable
> server-side objects that require an expensive calculation the
> first time they're read in.

How about performance ? Is'nt it expensive accessing file in a dir. for shared
data, I mean, you have to reload it if its RW data, or is it write ones read
many (it sounds like it) ?

> Same idea would work for user sessions, and since it's in the
> filesystem the kernel will take care of buffering for you and you
> can use tools like "find" and "rm" to prune the cache. :-)

Hmm, If I like to change user session data offen, I quess I would go for the
"shared mem" solution.

> I agree with Grisha that you probably want to keep state on the
> clients if you can, though.

This is not possible, as  the state, in my case, is a lot of database keys, and
other internal information for navigating a database.

/BL


From bl at netgroup.dk  Thu May 31 09:26:49 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:52:25 2004
Subject: [mod_python] Session data
References: <Pine.BSF.4.32.0105290826550.99341-100000@localhost> <m3elt74rcb.fsf@vole.object-craft.com.au>
Message-ID: <3B15F239.F158F917@netgroup.dk>

Dave Cole wrote:

> Gregory> Since Apache 1.3 runs multiple processes, it is impossible to
> Gregory> share memory between them and therefore maintain state in the
> Gregory> server.
>
> That is not strictly true.  If you wish to retain state at the server,
> you have to write some code.  You can either save state in some sort
> of database (not necessarily relational) at the server, or you can
> build a session server and cache connections to the server in your
> mod_python program.

Anyway, this would be nice to have in the FAQ.

When I startet to look into mod_python, I did compare with JavaServer, and found
that this "session thing" were missing, and Gregory's comment about scalling
helped me undestand that the JavaServer solution were not always sufficient.

> http://www.object-craft.com.au

Ahh, yet another Rating expert :-)

/BL


From bl at netgroup.dk  Thu May 31 09:40:27 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:52:25 2004
Subject: [mod_python] Session data
References: <13CDDE6A53DBD311BC3200508B6F0C4805E47E7D@rover.foolhq.com>
Message-ID: <3B15F56B.67DF1D35@netgroup.dk>

Chris Hagner wrote:

> In my experience, the quickest way to ensure that your web application
> scales poorly is to mis-use server-side user sessions (thereby agreeing with
> Grisha).  Now, that being said, not everyone needs this level of scalability
> AND user sessions are a standard part of almost every-single web application
> platform (ASP, Servlets/JSP, ColdFusion, etc.) commercially available.

This is the danger of the JavaServer/PHP approach, not been aware of this.

> BTW, I've found that most non-Apache-based web developers (of which I used
> to be one :-) are completely ignorant of the realities of running in a
> multi-process server.  They generally take for granted the user sessions
> built into whatever app server they're using and find it mentally
> challenging to truly believe they can live without such functionality.

Again, the tools they are using gives them this impression, or at least support
there view of the world. And then we have the same problem with ex. ASP as we
have with RAD tools --- the level of insight and experience.

> As for multiple-server user sessions, there are some solutions available in
> the non-Python space (most of the ones that I've seen use either a database
> (ugh :-) or a solution along the lines of Java's RMI to keep the session
> pool's in sync.  In either case, it is a non-trivial problem/solution and is
> best avoided (following the KISS principle).

Or even a CORBA version to keep the real-time aspect :-)

> You might want to check out WebWare (webware.sourceforge.net) as an expample
> web framework that has some session support.  I think they pickle objects to
> the file system.  There are some other python-based cgi frameworks that also
> support user sessions, but just be aware of how far such solutions will/will
> not take you.

I would be nervous about the performance and the real-time aspect by using the
file system approach, but thanks for the advise, I will look into it.

/BL


From SumnerH at fool.com  Thu May 31 12:09:37 2001
From: SumnerH at fool.com (G . Sumner Hayes)
Date: Fri Jan  9 21:52:25 2004
Subject: [mod_python] Session data
In-Reply-To: <3B15EDB5.7E8D811B@netgroup.dk>; from bl@netgroup.dk on Thu, May 31, 2001 at 09:07:33AM +0200
References: <3B13592F.DB5633BB@netgroup.dk> <Pine.BSF.4.32.0105290826550.99341-100000@localhost> <20010529130349.A17514@fool.com> <3B15EDB5.7E8D811B@netgroup.dk>
Message-ID: <20010531120937.A24124@fool.com>

Bo Lorentsen <bl@netgroup.dk> wrote:
> > You can use either shared mmap or SysV shared mem (there are
> > python modules for both) to share memory.  I wound up writing
> > a Python shared dictionary (just pickles objects into the
> > filesystem when you set them, and unpickles them when you read
> > them)
> 
> How about performance ? Is'nt it expensive accessing file in a
> dir. for shared data, I mean, you have to reload it if its RW
> data, or is it write ones read many (it sounds like it) ?

I can write about 3000 entries to the dictionary per second.  I
can read about 8000 entries from the dictionary per second.  This
is with SMP-safe locking, but running on a uniprocessor (600 Mhz
PIII).  This is tha naive 30 minute implentation without any C
extensions or anything.

Most of the time is spent pickling, fs access is _really_ fast
on a decent operating system (e.g. Linux, FreeBSD).  If you're
storing really large objects, the pickling may take longer.

If you're storing a lot of items (more than a few thousands) use
the regular db-in-fs options (nested directories with a few 1000
files each or a btree filesystem like ReiserFS).

> > Same idea would work for user sessions, and since it's in the
> > filesystem the kernel will take care of buffering for you and
> > you can use tools like "find" and "rm" to prune the cache.
> > :-)
>
> Hmm, If I like to change user session data offen, I quess I
> would go for the "shared mem" solution.

I tried it when I first implemented the thing , the timing was
similar (within 2-3%).  Which makes sense, because the time to
pickle is dominating anyway.  Bear in mind that the fs cache is
going to keep all your recently accessed files in RAM anyway.

If you do it in the fs, the implementation is much simpler-- you
need to build a balanced tree or hash table in SHM to get good
performance with more than 20-30 items in the database.  And
you're not as portable.  The key for me, though, was that being
able to play with the cache w/ regular user tools and assign
permissions per-item can be extremely useful.

  Sumner

From paullb at bigfoot.com  Thu May 31 21:23:50 2001
From: paullb at bigfoot.com (Brendan Paull)
Date: Fri Jan  9 21:52:25 2004
Subject: [mod_python] Compiling and installing mod_python-2.7.3
Message-ID: <5.0.2.1.2.20010531211720.00a02220@pop.minet.ca>

Hi,
	I am having a little trouble getting my mod_python to work.

This is the error I get:
[root@BCMP mod_python-2.7.3]# httpd
Syntax error on line 208 of /etc/httpd/conf/httpd.conf:
Cannot load /usr/lib/apache/mod_python.so into server: undefined symbol: 
pthread_create
[root@BCMP mod_python-2.7.3]#


These are the lines that I added to /etc/httpd/conf/httpd.conf:
208->  LoadModule python_module      /usr/lib/apache/mod_python.so #first 
one in the list
272->AddModule mod_python.c

333-337->
<Directory /var/www/html/python>
   AddHandler python-program .py
   PythonHandler mptest
   PythonDebug On
</Directory>


I have included a transcipt of everything that happens as I try to install 
at the end of the message, my system is a RedHat 7.0 and I have apache 1.3 
installed and python 2.1 which works from command line.

I would really appreciate any advice or tips at all.


[root@BCMP mod_python-2.7.3]# ./configure
loading cache ./config.cache
checking for gcc... (cached) gcc
checking whether the C compiler (gcc  ) works... yes
checking whether the C compiler (gcc  ) is a cross-compiler... no
checking whether we are using GNU C... (cached) yes
checking whether gcc accepts -g... (cached) yes
checking for ranlib... (cached) ranlib
checking for ar... (cached) ar
checking for a BSD compatible install... (cached) /usr/bin/install -c
checking whether make sets ${MAKE}... (cached) no
checking for main in -lm... (cached) yes
checking for working const... (cached) yes
checking your blood pressure... a bit high, but we can proceed
checking whether apxs is available
checking for --with-apxs... no
checking for apxs in /usr/local/apache/sbin... no
checking for apxs in your PATH... checking for apxs... (cached) /usr/sbin/apxs
found /usr/sbin/apxs, we'll use this. Use --with-apxs to specify another.
checking for Apache libexec directory... /usr/lib/apache
checking for Apache include directory... -I/usr/include/apache
checking for --with-apache... no
configure: warning: **** No apache sources specified, static compilation 
will not be available.
configure: warning: **** You can use --with-apache to specify where your 
Apache sources are.
checking for --with-python... no
checking for python... (cached) /usr/bin/python
checking Python version... 2.1
checking whether Python is compiled with thread support... yes

   ****** WARNING ******
   Python is compiled with thread support. Apache 1.3 does not use threads.
   On some systems this will cause problems during compilation, on others
   it may result in unpredictable behaviour of your Apache server. Yet on
   others it will work just fine. The recommended approach is to compile
   Python without thread support in a separate location and specify it with
   --with-python option to this ./configure script.

checking Python install prefix... /usr
checking what libraries Python was linked with... 
/usr/lib/python2.1/config/libpython2.1.a
checking linker flags used to link Python...
checking where Python include files are... -I/usr/include/python2.1
checking for mkdep... (cached) /usr/X11R6/bin/makedepend
creating ./config.status
creating Makefile
creating src/Makefile
creating src/libpython.module
creating Doc/Makefile
analyzing dependencies
[root@BCMP mod_python-2.7.3]# make
make[1]: Entering directory `/root/mod_python-2.7.3/src'
make[1]: Leaving directory `/root/mod_python-2.7.3/src'
[root@BCMP mod_python-2.7.3]# make install
make[1]: Entering directory `/root/mod_python-2.7.3'
make[2]: Entering directory `/root/mod_python-2.7.3/src'
make[2]: Leaving directory `/root/mod_python-2.7.3/src'

Performing DSO installation.

/usr/bin/install -c src/mod_python.so /usr/lib/apache
make[2]: Entering directory `/root/mod_python-2.7.3'
/usr/bin/install -c -d /usr/lib/python2.1/site-packages/mod_python
python /usr/lib/python2.1/compileall.py 
/usr/lib/python2.1/site-packages/mod_python
Listing /usr/lib/python2.1/site-packages/mod_python ...
Compiling /usr/lib/python2.1/site-packages/mod_python/__init__.py ...
Compiling /usr/lib/python2.1/site-packages/mod_python/apache.py ...
Compiling /usr/lib/python2.1/site-packages/mod_python/cgihandler.py ...
Compiling /usr/lib/python2.1/site-packages/mod_python/httpdapi.py ...
Compiling /usr/lib/python2.1/site-packages/mod_python/publisher.py ...
Compiling /usr/lib/python2.1/site-packages/mod_python/util.py ...
Compiling /usr/lib/python2.1/site-packages/mod_python/zhandler.py ...
make[2]: Leaving directory `/root/mod_python-2.7.3'

Now don't forget to edit your main config and add
     LoadModule python_module /usr/lib/apache/mod_python.so
and if your configuration uses ClearModuleList, then also
     AddModule mod_python.c

make[1]: Leaving directory `/root/mod_python-2.7.3'




From dado at wildbrain.com  Tue May  1 16:09:44 2001
From: dado at wildbrain.com (Dado Feigenblatt)
Date: Fri Jan  9 21:58:53 2004
Subject: [mod_python] mod_python and databases.
Message-ID: <3AEF4238.599ACFE2@wildbrain.com>

Hi there.

New to the list. New to mod_python.

I have a bunch of questions, but please, I'm not trying to start a flame
war.

I need to put up a database with access from different platforms.
So far I got this (which might change as my research continues):

The DB server will be (for now) PostgreSQL.
Users will be on different machines: SGIs, Intel/Linux, Macintoshes, and
maybe some Windows boxes.
At first I thought of doing the interface entirely web based, for
portability sake, using PHP (which I don't know)
Then, it hit me that this database will be accessed not only by humans
but by applications runing on some sort of UN*X like machine, and maybe
others (Mac/Win).
We have a lot of little apps and "glue" written in python.
So, we'll have to write some DB modules to interface with our DB and
other apps.
Then it hit me again, if we'll have to write a lot of that stuff in
python, maybe I should discard PHP and just go for python.
That's how I got to mod_python.
But this database will be internal only. Do I need a webserver with
mod_python for that?
Python has nice GUI toolkits. Can't I just do it in Python/Tk or
wxPython?
Why should I use mod_python?

Thanks.


--
Dado Feigenblatt                                 Wild Brain, Inc.
Technical Director                               (415) 553-8000 x???
dado@wildbrain.com                               San Francisco, CA.




From kees.serier at relan.nl  Wed May  2 13:00:15 2001
From: kees.serier at relan.nl (Serier, Kees)
Date: Fri Jan  9 21:58:53 2004
Subject: [mod_python] problems configuring mod_python on AIX.
Message-ID: <AA2536FEE0A9D311887000508B5EDF1E01C2BBED@ab00s003.abab.cadans.nl>

Hello,

I'm trying to build apache with mod_python, but the configure script gives
some errors (lookup at the 1) and 2) in the configure ouput below:  *
Mod_python):
- 1) It seems that it can't find @sbindir@/httpd but it is both in:
     -rwxr-xr-x   1 root     beheer   1200657 Mar 15 09:58
/usr/local/apache/bin/httpd
     -rwxr-xr-x   1 root     beheer   1200657 Mar 15 09:58
/usr/local/apache/sbin/httpd
     and works just fine.
     Passing --sbindir=/usr/local/apache/sbin to the configure scripts
     doesn't help.				     
     /usr/local/apache/libexec exists but is empty
- 2) allthough I use --with-pythonn==/usr/local/src/Python-2.0, configure
     still wants to use python 1.5.2
And yes, it is right about the bloodpresure ;-)

Can anybody give me a tip?

Thanks in advance,

Kees Serier mailto:kees.serier@ordina.nl

* General information:
   AIX        4.2.1
   GCC        2.95.2 (locally build and installed from source)
   GNU-make   3.79.1 (locally build and installed from source)
   Python     2.0    (locally build and installed from source)
   Apache     1.3.19 (locally build and installed from source with DSO)
   Mod_python 2.7.2

  Apache is (default) installed in /usr/local/apache
    source in /usr/local/src/apache_1.3.19
    /usr/local/apache/sbin did was not installed with the default
    installation, I created it making a full copy from /usr/local/apache/bin
    the configure script there finds the apxs utility.
  Python is (default) installed in /usr/local/python
    source in /usr/local/src/Python-2.0
   
  Apache and Python are being used with CGI and MySQL.

* Mod_python:
   source in /usr/local/src/mod_python-2.7.2
   
   [/usr/local/src/mod_python-2.7.2]# ./configure
--with-python=/usr/local/src/Python-2.0
--with-apache=/usr/local/src/apache_1.3.19 --sbindir=/usr/local/apache/sbin
   This gives the following output:
   
   loading cache ./config.cache
   checking for gcc... (cached) gcc
   checking whether the C compiler (gcc  ) works... yes
   checking whether the C compiler (gcc  ) is a cross-compiler... no
   checking whether we are using GNU C... (cached) yes
   checking whether gcc accepts -g... (cached) yes
   checking for ranlib... (cached) ranlib
   checking for ar... (cached) ar
   checking for a BSD compatible install... ./install-sh -c
   checking whether make sets ${MAKE}... (cached) yes
   checking for main in -lm... (cached) yes
   checking for working const... (cached) yes
   checking your blood pressure... a bit high, but we can proceed
   checking whether apxs is available
   checking for --with-apxs... no
   checking for apxs in /usr/local/apache/sbin... found, we'll use this. Use
--with-apxs to specify another.
1) checking for Apache libexec directory... apxs:Error: @sbindir@/httpd not
found or not executable
   
1) checking for Apache include directory... apxs:Error: @sbindir@/httpd not
found or not executable
   -I
   checking for --with-apache... /usr/local/src/apache_1.3.19
   checking for --with-python... /usr/local/src/Python-2.0
2) checking for python... (cached) /usr/local/src/Python-1.5.2/python
2) checking Python version... ./configure[1310]:
/usr/local/src/Python-1.5.2/python:  not found
   
2) checking whether Python is compiled with thread support...
./configure[1316]: /usr/local/src/Python-1.5.2/python:  not found
   no threads, good
2) checking Python install prefix... ./configure[1335]:
/usr/local/src/Python-1.5.2/python:  not found
   
   checking what libraries Python was linked with...
/usr/local/src/Python-2.0/libpython.a   -ldl  -lpthreads   -lm
-lreadline -ltermcap                      -L/usr/local/lib -ltk8.0 -ltcl8.0
-L/usr/lib/X11 -lld -lX11   -lcurses -ltermcap       -L$(exec_prefix)/lib
-lz 
   checking linker flags used to link Python...  -Wl,-bE:python.exp -lld  
   checking where Python include files are... -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include
   checking for mkdep... (cached) /usr/bin/X11/makedepend
   creating ./config.status
   creating Makefile
   creating src/Makefile
   creating src/libpython.module
   creating Doc/Makefile
   analyzing dependencies
-- end of message


From linux at mensagero.com.br  Wed May  2 12:19:13 2001
From: linux at mensagero.com.br (Linux)
Date: Fri Jan  9 21:58:53 2004
Subject: [mod_python] could not import mod_python.apache
Message-ID: <002f01c0d31b$3f53ad00$0300000a@mensagero.int.br>

Hello friends:)

I use apache 1.3.14, python 1.5.2, in a box (linux) Conectiva 6.0 - a RedHat
like linux.
I install mod_python 2.7.1-1.

When I open a directory example in a browser, I got a error 500. The
error_log of apache sais:

make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
[Wed May  2 12:04:41 2001] [error] [client XXX.XXX.XXX.XXX] python_handler:
make_obcallback returned no obCallBack!

Something is wrong, and my poor knowledge about python is not help.

In http.conf

<IfModule mod_python.c>
  Alias /mod_python/ /var/www/mod_python_test/
  <Directory /var/www/mod_python_test>
    AllowOverride FileInfo
  </Directory>
</IfModule>

In .htaccess

SetHandler python-program
PythonHandler pythonhandler

In pythonhandler.py

from mod_python import apache

def handler(req):
    req.send_http_header()
    req.write("Hello to the World from "+req.uri+"!")
    return apache.OK

tanks for any help.

in time: my english is poor, but my soul is better :)
----
Julio Cesar J Melati
Administrador de Redes

http://www.mensagero.com.br
falecom@mensagero.com.br


From db8coach at hotmail.com  Wed May  2 16:55:48 2001
From: db8coach at hotmail.com (Bryon G)
Date: Fri Jan  9 21:58:53 2004
Subject: [mod_python] mod_python vs. aolserver/pywx and postgresql
Message-ID: <LAW2-F133oHMwVN7miR0000d673@hotmail.com>

I am a student at ArsDigita University.  We recently did Phil Greenspun's 
database-backed website course, and made the decision early on to learn and 
use Python to do the class (instead of the non-free .net tools Philip was 
pushing).  We had to decide on a database and a web server, and originally 
started with mod-python and postgres using pg to glue them together, but we 
eventually  switched to aolserver and pywx.  There were two reasons:

1. our instructors were more familiar with AOLserver
2. AOLServer has database connection pooling built in.

The second reason is probably the one which will be relevant to you.  If 
it's possible/easy to do this with modpython/apache, I'd love to know about 
it because I'd prefer to use apache since it's so much more common, but in 
the *very* limited time we had to do the project we found more and better 
documentation (albeit translated from the C api documentation) for the pywx 
way than for the mod python way.

I explored a few other options before we made the switch, such as the pgpool 
module at the vaults (which people seem to be using with mod-fast-cgi, if 
anyone is using it with mod-python I'd love to hear about it), but since we 
were able to get going faster with aolserver that's what we used.

The syntax for the AOLServer database access stuff was, in my opinion, 
harder to learn than the pg way largely because there was less documentation 
available, but once that was out of the way the pooling question seemed to 
be the only real difference between the two in terms of end performance.

Bryon

ps- in case you are wondering, our project was to automate the 
secondarysources.com website for college debaters.  The project is not up on 
the internet yet, and probably won't be for a few months, so unfortunately I 
can't point you to it yet, but if anyone's interested I can post the code we 
wrote somewhere.
_________________________________________________________________
Get your FREE download of MSN Explorer at http://explorer.msn.com


From mhagger at alum.mit.edu  Wed May  2 19:35:31 2001
From: mhagger at alum.mit.edu (Michael Haggerty)
Date: Fri Jan  9 21:58:53 2004
Subject: [mod_python] mod_python vs. aolserver/pywx and postgresql
In-Reply-To: "Bryon G"'s message of "Wed, 02 May 2001 16:55:48 -0000"
References: <LAW2-F133oHMwVN7miR0000d673@hotmail.com>
Message-ID: <m2lmoftjcs.fsf@freak.kaiserty.com>

"Bryon G" <db8coach@hotmail.com> writes:
> The syntax for the AOLServer database access stuff was, in my
> opinion, harder to learn than the pg way largely because there was
> less documentation available, but once that was out of the way the
> pooling question seemed to be the only real difference between the
> two in terms of end performance.

I'm hope nobody is offended that I follow up with a comment about PyWX
on this mailing list...

With PyWX you don't have to limit yourself to the AOLserver database
API to get connection caching.  (In fact, I don't use it myself.)  The
latest version of PyWX has a single-interpreter, multiple-thread mode
with which you could open, for example, multiple pg database
connections on startup and store them in a pool.  Individual scripts
would grab a connection from the pool, use it, clear it out, and
return it to the pool to be reused.  Of course this is predicated on
pg and your pool code being thread-safe.

Once multithreaded Apache is out, similar tricks should be possible in
the Apache world.

Michael

-- 
Michael Haggerty
mhagger@alum.mit.edu

From bbhaydon at bigpond.com  Thu May  3 11:32:03 2001
From: bbhaydon at bigpond.com (Brett Haydon)
Date: Fri Jan  9 21:58:53 2004
Subject: [mod_python] RE: mod_python and databases
In-Reply-To: <200105021601.f42G1L243366@eden.ispol.com>
Message-ID: <NCBBKMABOKFCDLPIKKGIAEPCCCAA.bbhaydon@bigpond.com>

You could do it with any of those nice GUI toolkits.
modpython is only going to be useful if you want the
browser/web page to be the GUI.

It really goes back to the argument of server side
v client side. Do you want to install a GUI client
on every machine?? Do you need the bells & whistles of
a GUI or is a web interface sufficient? Which is faster
to develop for you? etc.

Brett


From dsavitsk at midway.uchicago.edu  Fri May  4 00:35:02 2001
From: dsavitsk at midway.uchicago.edu (douglas savitsky)
Date: Fri Jan  9 21:58:53 2004
Subject: [mod_python] Win2k httpd.conf problems
Message-ID: <988954502.3af23f8680258@webmail.uchicago.edu>

hi there,

i am having trouble getting started, and could use some help.
Win2k, Apache 1.3.14, mod_python 2.7.2, ActivePython 2.0.

I am unable to configure things, and i get the error:
-------------------------
Mod_python error: "PythonHandler test"

Traceback (most recent call last):

  File "c:\program files\python20\lib\mod_python\apache.py", line 180, in 
Dispatch
    object = resolve_object(self.req, module, object_str, silent)

  File "c:\program files\python20\lib\mod_python\apache.py", line 396, in 
resolve_object
    raise AttributeError, s

AttributeError: module 'c:\program files\python20\lib\test\__init__.pyc' 
contains no 'handler'
-------------------------

I saw a reference to this here
http://www.modpython.org/pipermail/mod_python/2001-February/001163.html
but i don't know what the answer means ...

as far as set up, here is what i have done ...

1. put the .dll where it goes.  that part seems okay.
2. add the line 'LoadModule python_module modules/mod_python.dll' which also 
seems fine
3. copy all of the .py files from 
..\python20\lib\mod_python-2.7.2\lib\python\mod_python\*.py to 
..\python20\lib\mod_python\*.py
[if i put them elsewhere i get other erros]
4. make changes to the httpd.conf file so it looks like this
<IfModule mod_alias.c>
    Alias /icons/ "C:/Apache/icons/"
    <Directory "C:/Apache/icons">
        Options Indexes MultiViews
        AllowOverride None
        Order allow,deny
        Allow from all
    </Directory>
    ScriptAlias /cgi-bin/ "C:/Apache/cgi-bin/"
    <Directory "C:/Apache/cgi-bin">
        AllowOverride None
        Options None
        Order allow,deny
        Allow from all
    </Directory>
    <Directory "C:/Apache/cgi-bin">
        AddHandler python-program .py
        PythonHandler test
        PythonDebug on
    </Directory>
</IfModule>

thanks for any help.  i am coming over from iis/asp world, so i have no apache 
experience either.

doug

From trengove at econdata.com.au  Sun May  6 15:07:53 2001
From: trengove at econdata.com.au (Chris Trengove)
Date: Fri Jan  9 21:58:53 2004
Subject: [mod_python] Win32 threading issue
Message-ID: <200105061509919.SM00265@athene>

I have been testing the following script on Apache with mod_python (Apache
1.13.17, mod_python 2.7.2, Windows 2000). I have been interested in testing
the possible throughput of this (and more useful scripts), so I have
another Python script which continually loads this "page".

from mod_python import apache
import thread

def handler(req):
    req.content_type = "text/plain"
    req.send_http_header()
    req.write("%d\n" % thread.get_ident())
    return apache.OK

When I run more than one copy of the driver script (in multiple consoles),
I get behavior indicative of some threading problems. Specifically, some
connections get "lost", the Apache error log reports various instances of
"IOError: Write failed...", and I occassionally get an access violation
inside Apache. Similarly, if I only run one copy of the driver script, and
just keep hitting the refresh button in a browser, the browser
occassionally returns TWO numbers, and sometimes reports an error in
retrieving the data. Note that I have tested my driver program retrieving a
simple text file, and everything works as expected, so it does not appear
to be a problem with Apache. (The problem also goes away if I set
ThreadPerChild to 1 in the Apache configuration.)

I have also found that, if I comment out the req.write() statement in the
handler, then there are no problems. From my examination of the
implementation of the request object, I see that req_write() contains calls
to Py_BEGIN_ALLOW_THREADS / Py_END_ALLOW_THREADS, whereas
req_send_http_header() contains no such calls. This suggests to me that
some thread switching is occurring inside req_write() which is messing with
the state of the interpreter.

I would be most grateful if anyone has any information to offer on this.

Chris Trengove


From marcf at becomm.com  Mon May  7 02:41:30 2001
From: marcf at becomm.com (Marc Fiuczynski)
Date: Fri Jan  9 21:58:53 2004
Subject: [mod_python] Win32 threading issue
Message-ID: <A9DFD9380C01D4118E740050DA7A8970386320@becomm-mis2.becomm.com>

A random shot in the dark...

are you using a multithreaded version of the python interpreter?  If so,
then that might be the cause of your problem.   Somewhere in the mod_python
documentation I read that apache would get confused if you used a
multithreaded version of python.  Check that and please let us (or at least
me) know.

In terms of throughput, you might also try writing a script using "wget" to
measure the number of requests per second you can run (not sure what the
windows equivalent is, or whether you can get it to work with cygwin).

Cheers,
Marc


> -----Original Message-----
> From: Chris Trengove [mailto:trengove@econdata.com.au]
> Sent: Saturday, May 05, 2001 10:08 PM
> To: mod_python@modpython.org
> Subject: [mod_python] Win32 threading issue
> 
> 
> I have been testing the following script on Apache with 
> mod_python (Apache
> 1.13.17, mod_python 2.7.2, Windows 2000). I have been 
> interested in testing
> the possible throughput of this (and more useful scripts), so I have
> another Python script which continually loads this "page".
> 
> from mod_python import apache
> import thread
> 
> def handler(req):
>     req.content_type = "text/plain"
>     req.send_http_header()
>     req.write("%d\n" % thread.get_ident())
>     return apache.OK
> 
> When I run more than one copy of the driver script (in 
> multiple consoles),
> I get behavior indicative of some threading problems. 
> Specifically, some
> connections get "lost", the Apache error log reports various 
> instances of
> "IOError: Write failed...", and I occassionally get an access 
> violation
> inside Apache. Similarly, if I only run one copy of the 
> driver script, and
> just keep hitting the refresh button in a browser, the browser
> occassionally returns TWO numbers, and sometimes reports an error in
> retrieving the data. Note that I have tested my driver 
> program retrieving a
> simple text file, and everything works as expected, so it 
> does not appear
> to be a problem with Apache. (The problem also goes away if I set
> ThreadPerChild to 1 in the Apache configuration.)
> 
> I have also found that, if I comment out the req.write() 
> statement in the
> handler, then there are no problems. From my examination of the
> implementation of the request object, I see that req_write() 
> contains calls
> to Py_BEGIN_ALLOW_THREADS / Py_END_ALLOW_THREADS, whereas
> req_send_http_header() contains no such calls. This suggests 
> to me that
> some thread switching is occurring inside req_write() which 
> is messing with
> the state of the interpreter.
> 
> I would be most grateful if anyone has any information to 
> offer on this.
> 
> Chris Trengove
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 

From trengove at econdata.com.au  Mon May  7 21:21:32 2001
From: trengove at econdata.com.au (Chris Trengove)
Date: Fri Jan  9 21:58:53 2004
Subject: [mod_python] Win32 threading issue
In-Reply-To: <A9DFD9380C01D4118E740050DA7A8970386320@becomm-mis2.becomm.
 com>
Message-ID: <200105072122310.SM00265@athene>

Marc,

Yes, as I understand things, this should be the multithreaded version,
since this is how Python is built for Win32. (I am running the BeOpen 2.0
version of Python.) But my reading of the mod_python documentation is that
mod_python under Win32 is "thread safe", to the extent that it allocates a
new Python thread for each new Apache thread, and does the appropriate
things to make sure that the threads co-exist peacefully.

As for measuring throughput, my script does that quite successfully - if I
only run one copy. The point is that this test environment exposes the
threading problem far more quickly than in a production environment, where
the conflict might occur much less often, and much less predictably.

Chris

At 02:41 AM 7/05/2001 -0700, Marc Fiuczynski wrote:
>A random shot in the dark...
>
>are you using a multithreaded version of the python interpreter?  If so,
>then that might be the cause of your problem.   Somewhere in the mod_python
>documentation I read that apache would get confused if you used a
>multithreaded version of python.  Check that and please let us (or at least
>me) know.
>
>In terms of throughput, you might also try writing a script using "wget" to
>measure the number of requests per second you can run (not sure what the
>windows equivalent is, or whether you can get it to work with cygwin).
>
>Cheers,
>Marc
>


From stephane.bidoul at softwareag.com  Mon May  7 13:22:42 2001
From: stephane.bidoul at softwareag.com (=?iso-8859-1?Q?St=E9phane_Bidoul?=)
Date: Fri Jan  9 21:58:53 2004
Subject: [mod_python] Win32 threading issue
In-Reply-To: <A9DFD9380C01D4118E740050DA7A8970386320@softwareag.com>
Message-ID: <000001c0d70d$064b9fe0$4eb3bd9d@softwareag.com>

> are you using a multithreaded version of the python 
> interpreter?  If so,
> then that might be the cause of your problem.   Somewhere in 
> the mod_python
> documentation I read that apache would get confused if you used a
> multithreaded version of python.  Check that and please let 
> us (or at least
> me) know.

I think this is true for *nix, but on windows,
you *must* use a multithreaded python.

I'll try to have a look at your issue, but I've very
few time available these days.

-sbi

> -----Original Message-----
> From: mod_python-admin@modpython.org
> [mailto:mod_python-admin@modpython.org]On Behalf Of Marc Fiuczynski
> Sent: 07 May, 2001 11:42
> To: 'Chris Trengove'; mod_python@modpython.org
> Subject: RE: [mod_python] Win32 threading issue
> 
> 
> A random shot in the dark...
> 
> are you using a multithreaded version of the python 
> interpreter?  If so,
> then that might be the cause of your problem.   Somewhere in 
> the mod_python
> documentation I read that apache would get confused if you used a
> multithreaded version of python.  Check that and please let 
> us (or at least
> me) know.
> 
> In terms of throughput, you might also try writing a script 
> using "wget" to
> measure the number of requests per second you can run (not 
> sure what the
> windows equivalent is, or whether you can get it to work with cygwin).
> 
> Cheers,
> Marc
> 
> 
> > -----Original Message-----
> > From: Chris Trengove [mailto:trengove@econdata.com.au]
> > Sent: Saturday, May 05, 2001 10:08 PM
> > To: mod_python@modpython.org
> > Subject: [mod_python] Win32 threading issue
> > 
> > 
> > I have been testing the following script on Apache with 
> > mod_python (Apache
> > 1.13.17, mod_python 2.7.2, Windows 2000). I have been 
> > interested in testing
> > the possible throughput of this (and more useful scripts), so I have
> > another Python script which continually loads this "page".
> > 
> > from mod_python import apache
> > import thread
> > 
> > def handler(req):
> >     req.content_type = "text/plain"
> >     req.send_http_header()
> >     req.write("%d\n" % thread.get_ident())
> >     return apache.OK
> > 
> > When I run more than one copy of the driver script (in 
> > multiple consoles),
> > I get behavior indicative of some threading problems. 
> > Specifically, some
> > connections get "lost", the Apache error log reports various 
> > instances of
> > "IOError: Write failed...", and I occassionally get an access 
> > violation
> > inside Apache. Similarly, if I only run one copy of the 
> > driver script, and
> > just keep hitting the refresh button in a browser, the browser
> > occassionally returns TWO numbers, and sometimes reports an error in
> > retrieving the data. Note that I have tested my driver 
> > program retrieving a
> > simple text file, and everything works as expected, so it 
> > does not appear
> > to be a problem with Apache. (The problem also goes away if I set
> > ThreadPerChild to 1 in the Apache configuration.)
> > 
> > I have also found that, if I comment out the req.write() 
> > statement in the
> > handler, then there are no problems. From my examination of the
> > implementation of the request object, I see that req_write() 
> > contains calls
> > to Py_BEGIN_ALLOW_THREADS / Py_END_ALLOW_THREADS, whereas
> > req_send_http_header() contains no such calls. This suggests 
> > to me that
> > some thread switching is occurring inside req_write() which 
> > is messing with
> > the state of the interpreter.
> > 
> > I would be most grateful if anyone has any information to 
> > offer on this.
> > 
> > Chris Trengove
> > 
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://www.modpython.org/mailman/listinfo/mod_python
> > 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From trengove at econdata.com.au  Tue May  8 13:34:46 2001
From: trengove at econdata.com.au (Chris Trengove)
Date: Fri Jan  9 21:58:53 2004
Subject: [mod_python] Win32 threading issue
In-Reply-To: <000001c0d70d$064b9fe0$4eb3bd9d@softwareag.com>
References: <A9DFD9380C01D4118E740050DA7A8970386320@softwareag.com>
Message-ID: <20010508133951.SM00265@athene>

St?phane,

I would be great if you could find time to look at this.

I have been doing some more investigating, trying to understand just what
is going on. As I mentioned in my previous message, Py_BEGIN_ALLOW_THREADS
is called in the request object's write() method, so thread switching could
occur here. But thread switching should still occur in any case inside the
main Python interpreter loop. To test this, I tried the following script

from mod_python import apache
import thread

counter = None
LOOPLIMIT =
1000000

def handler(req):
   	global counter
    counter = 0
   	for i in
range(0,LOOPLIMIT):
        counter = counter + 1
    req.content_type =
"text/plain"
    req.send_http_header()
    req.write("%d: %d\n" %
(thread.get_ident(),counter))
    return apache.OK

If I load this page once, I get a value of 1000000 back, as expected. If I
load the page from two clients "simultaneously" (or as fast as I can
activate each one), I get something like

Client 1
1908: 1200128
2016: 1354557
2024: 591402

Client 2
2004: 1698384
2012: 1800311
2028: 1205627

This is for three repetitions of the page load. As you can see, the Python
interpreter is definitely switching between threads, and producing crazy
results for the global counter variable, which is not protected by any lock.

This is all as expected. The puzzle is why the thread switching inside the
request object's module should be causing some problem, if that is indeed
where the trouble lies. I am wondering whether there is something in the
request object structure which is not totally thread-safe.

Incidentally, if I run enough repetitions of this test setup, I can
eventually get a situation where one thread crashes, and the other thread
(just at this point) returns a value like

632: 1515843<LF>568: 1572286

that is TWO thread IDs in the one message -- the write buffer of one thread
is being appended to by the other, somehow.

Some food for thought.
Chris

>I think this is true for *nix, but on windows,
>you *must* use a multithreaded python.
>
>I'll try to have a look at your issue, but I've very
>few time available these days.



From grisha at modpython.org  Tue May  8 00:22:08 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:58:53 2004
Subject: [mod_python] Win32 threading issue
In-Reply-To: <20010508133951.SM00265@athene>
Message-ID: <Pine.BSF.4.32.0105080017250.11714-100000@localhost>

Chris -

Do you have Keepalive enabled?

Grisha

On Tue, 8 May 2001, Chris Trengove wrote:

> Incidentally, if I run enough repetitions of this test setup, I can
> eventually get a situation where one thread crashes, and the other thread
> (just at this point) returns a value like
>
> 632: 1515843<LF>568: 1572286
>
> that is TWO thread IDs in the one message -- the write buffer of one thread
> is being appended to by the other, somehow.
>


From trengove at econdata.com.au  Tue May  8 16:27:09 2001
From: trengove at econdata.com.au (Chris Trengove)
Date: Fri Jan  9 21:58:53 2004
Subject: [mod_python] Win32 threading issue
In-Reply-To: <Pine.BSF.4.32.0105080017250.11714-100000@localhost>
References: <20010508133951.SM00265@athene>
Message-ID: <200105081628535.SM00265@athene>

Grisha,

I did have KeepAlive On, but it appears to make no difference. I have just
tried with KeepAlive Off, and I get the same behaviour. Also, the clients I
have been using would be closing the connection after each request. As
clients I have been using a Python script with urllib, and a little C++
test program I wrote to see if trying a different client made any
difference. It didn't.

Chris

At 12:22 AM 8/05/2001 -0400, Gregory (Grisha) Trubetskoy wrote:
>
>Chris -
>
>Do you have Keepalive enabled?
>
>Grisha
>
>On Tue, 8 May 2001, Chris Trengove wrote:
>
>> Incidentally, if I run enough repetitions of this test setup, I can
>> eventually get a situation where one thread crashes, and the other thread
>> (just at this point) returns a value like
>>
>> 632: 1515843<LF>568: 1572286
>>
>> that is TWO thread IDs in the one message -- the write buffer of one thread
>> is being appended to by the other, somehow.


From grisha at modpython.org  Tue May  8 09:47:25 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:58:53 2004
Subject: [mod_python] Win32 threading issue
In-Reply-To: <200105081628535.SM00265@athene>
Message-ID: <Pine.BSF.4.32.0105080944350.16559-100000@localhost>

Interesting...

Another question - when you say a thread crashes, what exactly do you see
- is it something in the log or one of those dr. watson messages?

On Tue, 8 May 2001, Chris Trengove wrote:

> Grisha,
>
> I did have KeepAlive On, but it appears to make no difference. I have just
> tried with KeepAlive Off, and I get the same behaviour. Also, the clients I
> have been using would be closing the connection after each request. As
> clients I have been using a Python script with urllib, and a little C++
> test program I wrote to see if trying a different client made any
> difference. It didn't.
>
> Chris
>
> At 12:22 AM 8/05/2001 -0400, Gregory (Grisha) Trubetskoy wrote:
> >
> >Chris -
> >
> >Do you have Keepalive enabled?
> >
> >Grisha
> >
> >On Tue, 8 May 2001, Chris Trengove wrote:
> >
> >> Incidentally, if I run enough repetitions of this test setup, I can
> >> eventually get a situation where one thread crashes, and the other thread
> >> (just at this point) returns a value like
> >>
> >> 632: 1515843<LF>568: 1572286
> >>
> >> that is TWO thread IDs in the one message -- the write buffer of one thread
> >> is being appended to by the other, somehow.
>


From fatpornstar at hotmail.com  Tue May  8 17:04:32 2001
From: fatpornstar at hotmail.com (Benjamin Watson)
Date: Fri Jan  9 21:58:53 2004
Subject: [mod_python] Remove me please
Message-ID: <F212ZS4HIv6EybqfAj800005fe8@hotmail.com>

_________________________________________________________________
Get your FREE download of MSN Explorer at http://explorer.msn.com


From CHagner at fool.com  Tue May  8 13:29:37 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:58:53 2004
Subject: [mod_python] Use mod_python for root/home page requests
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E47DCA@rover.foolhq.com>

I currently have mod_python wired into a location (Specifically <Location
/>) that allows all request coming under this location to be handled by my
handler.  I also use SetHandler instead of AddHandler so that it doesn't
even matter what file extension/type is requested.  My goal here is to have
an apache instance that has ALL of its requests go through mod_python.

Now, the strange thing is that this works great for all requests except for
the root/home page.  For example,

http://www.mydummysite.com/blahblah

This works great... my handler is called and is responsible for
interpretting 'blahblah'.  However,

http://www.mydummysite.com/

This fails to go to the handler and instead looks for the default page
(index.html) in the DocumentRoot.  Thus, my Location directive doesn't
appear to be inclusive of the request to the base home URL.

Has anyone tried this before?  I'd prefer to achieve this without relying on
mod_rewrite.

Thanks for your help.

Chris



From trengove at econdata.com.au  Wed May  9 08:27:50 2001
From: trengove at econdata.com.au (Chris Trengove)
Date: Fri Jan  9 21:58:53 2004
Subject: [mod_python] Win32 threading issue
In-Reply-To: <Pine.BSF.4.32.0105080944350.16559-100000@localhost>
References: <200105081628535.SM00265@athene>
Message-ID: <200105090830627.SM00265@athene>

Grisha,

Exactly what I see is variable in nature. The most usual thing will be an
entry in the Apache error log like this

[Tue May 08 16:47:37 2001] [error] PythonHandler hwtest: Traceback (most
recent call last):

[Tue May 08 16:47:37 2001] [error] PythonHandler hwtest:   File
"e:\python20\lib\mod_python\apache.py", line 189, in Dispatch     result =
object(self.req) [Tue May 08 16:47:37 2001] [error] PythonHandler hwtest:
File "c:/apache/apache/htdocs/python\hwtest.py", line 24, in handler
req.write("%d: %d\n" % (thread.get_ident(),counter)) 

[Tue May 08 16:47:37 2001] [error] PythonHandler hwtest: IOError: Write
failed, client closed connection. 

When I use my Python driver script, which keeps going even if no data is
returned from the server, I will often end up with an access violation
inside Apache.exe.

"The instruction at "0x6ff71679" referenced memory at "0x616c707b". The
memory could not be "read"."

Actually, this location appears to be always the same -- when it eventually
happens -- which might be after a significant number log error messages.
After the access violation, one of my driver scripts stops, because it
receives a socket exception (10054, "Connection reset by peer"), and the
other script continues merrily along.

Occassionally other things can happen too -- I think it just depends on
when the two threads conflict. As I mentioned earilier, one really
misterious occurrence is getting a "double message" returned to one thread,
just as the other receives no data. Like this

632: 1515843<LF>568: 1572286

Here <LF> is a line feed, and the numbers before the colons are the thread
IDs. I know that Apache has 50 threads which it is cycling through in
order. On this occassion 568 was due to be the thread to be used for the
OTHER client.

Chris

At 09:47 AM 8/05/2001 -0400, Gregory (Grisha) Trubetskoy wrote:
>
>Interesting...
>
>Another question - when you say a thread crashes, what exactly do you see
>- is it something in the log or one of those dr. watson messages?
>
>On Tue, 8 May 2001, Chris Trengove wrote:
>
>> Grisha,
>>
>> I did have KeepAlive On, but it appears to make no difference. I have just
>> tried with KeepAlive Off, and I get the same behaviour. Also, the clients I
>> have been using would be closing the connection after each request. As
>> clients I have been using a Python script with urllib, and a little C++
>> test program I wrote to see if trying a different client made any
>> difference. It didn't.



From benno at sesgroup.net  Wed May  9 11:24:48 2001
From: benno at sesgroup.net (Ben Leslie)
Date: Fri Jan  9 21:58:54 2004
Subject: [mod_python] Use mod_python for root/home page requests
In-Reply-To: <13CDDE6A53DBD311BC3200508B6F0C4805E47DCA@rover.foolhq.com>; from CHagner@fool.com on Tue, May 08, 2001 at 01:29:37PM -0400
References: <13CDDE6A53DBD311BC3200508B6F0C4805E47DCA@rover.foolhq.com>
Message-ID: <20010509112448.B22766@sesgroup.net>

On Tue, 08 May 2001, Chris Hagner wrote:

> I currently have mod_python wired into a location (Specifically <Location
> />) that allows all request coming under this location to be handled by my
> handler.  I also use SetHandler instead of AddHandler so that it doesn't
> even matter what file extension/type is requested.  My goal here is to have
> an apache instance that has ALL of its requests go through mod_python.
> 
> Now, the strange thing is that this works great for all requests except for
> the root/home page.  For example,
> 
> http://www.mydummysite.com/blahblah
> 
> This works great... my handler is called and is responsible for
> interpretting 'blahblah'.  However,
> 
> http://www.mydummysite.com/
> 
> This fails to go to the handler and instead looks for the default page
> (index.html) in the DocumentRoot.  Thus, my Location directive doesn't
> appear to be inclusive of the request to the base home URL.
> 
> Has anyone tried this before?  I'd prefer to achieve this without relying on
> mod_rewrite.



Mmm I think you need to change the "index" dirrective (not sure what its called,
I'm at uni at the moment, search for index.html). Then you want to add index.py
to this. That should in theory work.

Cheers,

Benno

From CHagner at fool.com  Tue May  8 22:17:04 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:58:54 2004
Subject: [mod_python] Use mod_python for root/home page requests
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E47DCE@rover.foolhq.com>

Actually, my handler doesn't call scripts (index.py)... instead it call a
Servlet-like object that needs to be in the PYTHONPATH.  This is why I'm
using a Location directive instead of a Directory directive.  I basically
need to handle URLs that map to classes in my path instead of script files
in the file system.

One thing I was considering was dropping a custom PythonTransHandler class
into the document root directory.  Then, if I identify a call for the
homepage, I could do an internal redirect to my servlet (i.e.
http://www.mydummysite.com/contentapp).  

The true hack is to put a META-REFRESH tag in the homepage (index.html) to
http://www.mydummysite.com/contentapp, but then I lose all referrer
information and the ability to do anything based on the original query
string.

Another possibility is mod_rewrite, but I'm not sure that will work.  Still
seems like this should be do-able though, given the number of web pages out
there that need to be fully dynamic.

Thanks for the response though.  Any input/ideas are great to hear.

Chris

-----Original Message-----
From: Ben Leslie [mailto:benno@sesgroup.net]
Sent: Tuesday, May 08, 2001 9:25 PM
To: Chris Hagner
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Use mod_python for root/home page requests


On Tue, 08 May 2001, Chris Hagner wrote:

> I currently have mod_python wired into a location (Specifically <Location
> />) that allows all request coming under this location to be handled by my
> handler.  I also use SetHandler instead of AddHandler so that it doesn't
> even matter what file extension/type is requested.  My goal here is to
have
> an apache instance that has ALL of its requests go through mod_python.
> 
> Now, the strange thing is that this works great for all requests except
for
> the root/home page.  For example,
> 
> http://www.mydummysite.com/blahblah
> 
> This works great... my handler is called and is responsible for
> interpretting 'blahblah'.  However,
> 
> http://www.mydummysite.com/
> 
> This fails to go to the handler and instead looks for the default page
> (index.html) in the DocumentRoot.  Thus, my Location directive doesn't
> appear to be inclusive of the request to the base home URL.
> 
> Has anyone tried this before?  I'd prefer to achieve this without relying
on
> mod_rewrite.



Mmm I think you need to change the "index" dirrective (not sure what its
called,
I'm at uni at the moment, search for index.html). Then you want to add
index.py
to this. That should in theory work.

Cheers,

Benno

From bbhaydon at bigpond.com  Wed May  9 16:00:13 2001
From: bbhaydon at bigpond.com (Brett Haydon)
Date: Fri Jan  9 21:58:54 2004
Subject: [mod_python] Compile Problems
Message-ID: <NCBBKMABOKFCDLPIKKGIIEBOCDAA.bbhaydon@bigpond.com>

Hi,
Just compiled Apache 1.3.19 on RH7.1 with mod_python
as a dso against Python 2.1

I get this error when I try to start Apache
Cannot load mod_python.so into server
undefined symbol: openpty

Any ideas??

cheers,  
____________________________
Brett Haydon
bbhaydon@bigpond.com 

From stephane.bidoul at softwareag.com  Wed May  9 14:07:33 2001
From: stephane.bidoul at softwareag.com (=?US-ASCII?Q?Stephane_Bidoul?=)
Date: Fri Jan  9 21:58:54 2004
Subject: [mod_python] Win32 threading issue
In-Reply-To: <200105090830627.SM00265@softwareag.com>
Message-ID: <000001c0d880$a37d8660$4eb3bd9d@softwareag.com>

Chris,

Could you send me your driver script?
I cannot reproduce the behaviour you describe with
my own test scripts.

BTW, do you have a multiprocessor machine?
I know some problems have been reported
but never reproced on MP WIN2K machines.

-sbi

> -----Original Message-----
> From: mod_python-admin@modpython.org
> [mailto:mod_python-admin@modpython.org]On Behalf Of Chris Trengove
> Sent: 09 May, 2001 00:28
> To: Gregory (Grisha) Trubetskoy
> Cc: mod_python@modpython.org
> Subject: RE: [mod_python] Win32 threading issue
> 
> 
> Grisha,
> 
> Exactly what I see is variable in nature. The most usual 
> thing will be an
> entry in the Apache error log like this
> 
> [Tue May 08 16:47:37 2001] [error] PythonHandler hwtest: 
> Traceback (most
> recent call last):
> 
> [Tue May 08 16:47:37 2001] [error] PythonHandler hwtest:   File
> "e:\python20\lib\mod_python\apache.py", line 189, in Dispatch 
>     result =
> object(self.req) [Tue May 08 16:47:37 2001] [error] 
> PythonHandler hwtest:
> File "c:/apache/apache/htdocs/python\hwtest.py", line 24, in handler
> req.write("%d: %d\n" % (thread.get_ident(),counter)) 
> 
> [Tue May 08 16:47:37 2001] [error] PythonHandler hwtest: 
> IOError: Write
> failed, client closed connection. 
> 
> When I use my Python driver script, which keeps going even if 
> no data is
> returned from the server, I will often end up with an access violation
> inside Apache.exe.
> 
> "The instruction at "0x6ff71679" referenced memory at 
> "0x616c707b". The
> memory could not be "read"."
> 
> Actually, this location appears to be always the same -- when 
> it eventually
> happens -- which might be after a significant number log 
> error messages.
> After the access violation, one of my driver scripts stops, because it
> receives a socket exception (10054, "Connection reset by 
> peer"), and the
> other script continues merrily along.
> 
> Occassionally other things can happen too -- I think it just 
> depends on
> when the two threads conflict. As I mentioned earilier, one really
> misterious occurrence is getting a "double message" returned 
> to one thread,
> just as the other receives no data. Like this
> 
> 632: 1515843<LF>568: 1572286
> 
> Here <LF> is a line feed, and the numbers before the colons 
> are the thread
> IDs. I know that Apache has 50 threads which it is cycling through in
> order. On this occassion 568 was due to be the thread to be 
> used for the
> OTHER client.
> 
> Chris
> 
> At 09:47 AM 8/05/2001 -0400, Gregory (Grisha) Trubetskoy wrote:
> >
> >Interesting...
> >
> >Another question - when you say a thread crashes, what 
> exactly do you see
> >- is it something in the log or one of those dr. watson messages?
> >
> >On Tue, 8 May 2001, Chris Trengove wrote:
> >
> >> Grisha,
> >>
> >> I did have KeepAlive On, but it appears to make no 
> difference. I have just
> >> tried with KeepAlive Off, and I get the same behaviour. 
> Also, the clients I
> >> have been using would be closing the connection after each 
> request. As
> >> clients I have been using a Python script with urllib, and 
> a little C++
> >> test program I wrote to see if trying a different client made any
> >> difference. It didn't.
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From trengove at econdata.com.au  Thu May 10 08:43:10 2001
From: trengove at econdata.com.au (Chris Trengove)
Date: Fri Jan  9 21:58:54 2004
Subject: [mod_python] Win32 threading issue
In-Reply-To: <000001c0d880$a37d8660$4eb3bd9d@softwareag.com>
References: <200105090830627.SM00265@softwareag.com>
Message-ID: <200105100844681.SM00265@athene>

Stephane,

This is the sort of thing I have been using. I open two console windows and
start the script in both.
	
	import sys
	import time
	import urllib

	URL =
"http://127.0.0.1/python/test.py"
	NUM_GETS = 1000

	start = time.clock()

for i in range(0,NUM_GETS):
    	f = urllib.urlopen(URL)
		print f.read(),

	f.close()
	stop = time.clock()
	elapsed = stop - start
	print "%d GETs in
%.3f seconds = %.0f GETs/second" % (NUM_GETS,elapsed,NUM_GETS / elapsed)

I do not have a multiprocessor machine. I have been wondering whether this
is something to do running these tests on a single (local) machine, rather
than across a network, but when I try the above driver script retrieving a
small text file, everything is OK.

Incidentally, I have now switched to Apache 1.3.19 and still get the same
behaviour.

Chris

At 02:07 PM 9/05/2001 +0200, =?US-ASCII?Q?Stephane_Bidoul?= wrote:
>Chris,
>
>Could you send me your driver script?
>I cannot reproduce the behaviour you describe with
>my own test scripts.
>
>BTW, do you have a multiprocessor machine?
>I know some problems have been reported
>but never reproced on MP WIN2K machines.
>
>-sbi


From trengove at econdata.com.au  Thu May 10 08:45:08 2001
From: trengove at econdata.com.au (Chris Trengove)
Date: Fri Jan  9 21:58:54 2004
Subject: [mod_python] Win32 threading issue
Message-ID: <200105100846110.SM00265@athene>

Stephane,

Sorry, the mail program keeps messing up the formatting of the script, so
here it is as an attachment.

Chris

At 02:07 PM 9/05/2001 +0200, =?US-ASCII?Q?Stephane_Bidoul?= wrote:
>Chris,
>
>Could you send me your driver script?
>I cannot reproduce the behaviour you describe with
>my own test scripts.
>
>BTW, do you have a multiprocessor machine?
>I know some problems have been reported
>but never reproced on MP WIN2K machines.
>
>-sbi
-------------- next part --------------
import sys
import time
import urllib

URL = "http://127.0.0.1/python/test.py"
NUM_GETS = 1000

start = time.clock()
for i in range(0,NUM_GETS):
    f = urllib.urlopen(URL)
    print f.read(),
    f.close()
stop = time.clock()
elapsed = stop - start
print "%d GETs in %.3f seconds = %.0f GETs/second" % (NUM_GETS,elapsed,NUM_GETS / elapsed)
From CHagner at fool.com  Wed May  9 18:51:25 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:58:54 2004
Subject: [mod_python] Strange reloading of modules used in handler
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E47DE3@rover.foolhq.com>

I'm seeing some strange things with modules being reloaded when used in
mod_python.

Here's the scenario...
1. I'm using PythonImport to import a module (called MyConfig) and store it
in a module variable.
2. That module variable is being accessed by the registered modpy handler.
3. When I start up apache, MyConfig is imported once for each child process.
4. When I request a page, the handler accesses MyConfig... here's the weird
part.
5. SOMETIMES, it re-runs/imports the module containing MyConfig....
specifically, the first couple requests (6? I have 5 child procs running)
re-import the module and then it stops re-importing... for a while... then,
every once in a while it re-imports MyConfig.

Can some explain this?

Is apache killing off child procs and therefore requiring new python
subinterpreters to start up?  If this is not the case, I'm looking for a way
to keep an object in memory (thus, not have its module re-imported).

Here's my modpy setup if it helps...
        SetHandler python-program
        PythonHandler monty.modpy_handler
        PythonImport demo.MyConfig
        PythonDebug On
        PythonNoReload On
        PythonInterpPerDirectory Off

Thanks in advance...

Chris

From CHagner at fool.com  Wed May  9 19:00:21 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:58:54 2004
Subject: [mod_python] empty apache Connection object
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E47DE4@rover.foolhq.com>

Hey there,

Is there a good reason that my Connection object (mp_conn) is empty?  I've
never seen this be populated, but now I'd kind of like some of the
information it provides.

Chris

From gdamjan at mail.net.mk  Wed May  9 03:10:35 2001
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 21:58:54 2004
Subject: [mod_python] Win2k httpd.conf problems
In-Reply-To: <988954502.3af23f8680258@webmail.uchicago.edu>; from dsavitsk@midway.uchicago.edu on Fri, May 04, 2001 at 12:35:02AM -0500
References: <988954502.3af23f8680258@webmail.uchicago.edu>
Message-ID: <20010509031035.A472@local.izmislen.mk>

> I am unable to configure things, and i get the error:
> -------------------------
> Mod_python error: "PythonHandler test"
> 
> Traceback (most recent call last):
> 
>   File "c:\program files\python20\lib\mod_python\apache.py", line 180, in 
> Dispatch
>     object = resolve_object(self.req, module, object_str, silent)
> 
>   File "c:\program files\python20\lib\mod_python\apache.py", line 396, in 
> resolve_object
>     raise AttributeError, s
> 
> AttributeError: module 'c:\program files\python20\lib\test\__init__.pyc' 
> contains no 'handler'
> -------------------------
> 
...
>     <Directory "C:/Apache/cgi-bin">
>         AddHandler python-program .py
>         PythonHandler test

The most common error in the world, and very obvious.
Don't use 'test.py' for your testing script, there is already a package named
'test' in python and mod_python tries to load and execute that one.

You should use something like 'mptest.py' and don't forget to change 
	
	PythonHandler mptest




-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From gdamjan at mail.net.mk  Thu May 10 04:16:05 2001
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 21:58:54 2004
Subject: [mod_python] Strange reloading of modules used in handler
In-Reply-To: <13CDDE6A53DBD311BC3200508B6F0C4805E47DE3@rover.foolhq.com>; from CHagner@fool.com on Wed, May 09, 2001 at 06:51:25PM -0400
References: <13CDDE6A53DBD311BC3200508B6F0C4805E47DE3@rover.foolhq.com>
Message-ID: <20010510041605.A412@local.izmislen.mk>

On Wed, May 09, 2001 at 06:51:25PM -0400, Chris Hagner wrote:
> I'm seeing some strange things with modules being reloaded when used in
> mod_python.
> 
> Here's the scenario...
> 1. I'm using PythonImport to import a module (called MyConfig) and store it
> in a module variable.

I'm not very sure the PythonImport directive works too good, and anyway there's
no need to use it. Just use plain import in the Python scripts.

> 2. That module variable is being accessed by the registered modpy handler.
> 3. When I start up apache, MyConfig is imported once for each child process.
> 4. When I request a page, the handler accesses MyConfig... here's the weird
> part.
> 5. SOMETIMES, it re-runs/imports the module containing MyConfig....
> specifically, the first couple requests (6? I have 5 child procs running)
> re-import the module and then it stops re-importing... for a while... then,
> every once in a while it re-imports MyConfig.

Apache child process die sometimes, either deliberately either not. This causes
your module to be re-imported.

-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From CHagner at fool.com  Wed May  9 23:57:32 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:58:54 2004
Subject: [mod_python] Strange reloading of modules used in handler
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E47DE8@rover.foolhq.com>

Thanks, yeah, simply importing the module was my backup plan.  

My motivation is thus: the server running this handler/code is going to be
swamped load-wise and I wanted to be able to use apache's graceful restart
(starting new child procs and swapping them in for the old ones without
dropping a single request) to seamlessly update the application
configuration.

Maybe I'm just being paranoid and the import won't make a graceful restart
drop a connection... I'll be doing some testing to find out just where this
stands.

Again, thanks for the feedback/input.  Much appreciated.

Chris

-----Original Message-----
From: Damjan [mailto:gdamjan@mail.net.mk]
Sent: Wednesday, May 09, 2001 10:16 PM
To: mod_python@modpython.org
Subject: Re: [mod_python] Strange reloading of modules used in handler


On Wed, May 09, 2001 at 06:51:25PM -0400, Chris Hagner wrote:
> I'm seeing some strange things with modules being reloaded when used in
> mod_python.
> 
> Here's the scenario...
> 1. I'm using PythonImport to import a module (called MyConfig) and store
it
> in a module variable.

I'm not very sure the PythonImport directive works too good, and anyway
there's
no need to use it. Just use plain import in the Python scripts.

> 2. That module variable is being accessed by the registered modpy handler.
> 3. When I start up apache, MyConfig is imported once for each child
process.
> 4. When I request a page, the handler accesses MyConfig... here's the
weird
> part.
> 5. SOMETIMES, it re-runs/imports the module containing MyConfig....
> specifically, the first couple requests (6? I have 5 child procs running)
> re-import the module and then it stops re-importing... for a while...
then,
> every once in a while it re-imports MyConfig.

Apache child process die sometimes, either deliberately either not. This
causes
your module to be re-imported.

-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python

From dave at geko.net.au  Thu May 10 23:11:46 2001
From: dave at geko.net.au (David Creelman)
Date: Fri Jan  9 21:58:54 2004
Subject: [mod_python] What is happening here ?
Message-ID: <3AFA9392.CD147616@geko.net.au>

[Thu May 10 23:09:35 2001] [error] PythonHandler myscript: Traceback
(most recent call last):
[Thu May 10 23:09:35 2001] [error] PythonHandler myscript:   File
"/usr/lib/python2.0/site-packages/mod_python/apache.py", line 176, in
Dispatch
    module = import_module(module_name, _req)
[Thu May 10 23:09:35 2001] [error] PythonHandler myscript:   File
"/usr/lib/python2.0/site-packages/mod_python/apache.py", line 331, in
import_module
    f, p, d = imp.find_module(parts[i], path)
[Thu May 10 23:09:35 2001] [error] PythonHandler myscript: ImportError:
No module named myscript

I get this error when I try to run the following script.

from mod_python import apache

def handler(req):
    req.content_type = "text/plain"
    req.send_http_header()
    req.write("Hello World!")

    return apache.OK

Any help appreciated
David


From aiglauer at yahoo.com  Thu May 10 07:18:27 2001
From: aiglauer at yahoo.com (Alexis Iglauer)
Date: Fri Jan  9 21:58:54 2004
Subject: [mod_python] Segfaults and Handler issues
Message-ID: <20010510141827.72440.qmail@web13903.mail.yahoo.com>

Hi

I am migrating an existing mod_python application to a new server -
which involves an entirely new installation of everything including
apache and mod_python.

The new server is running Mandrake 7.2, apache 1.3.14 [old one had
1.3.9] and mod_python 2.7.2 [old: 2.6.2].

I have had multiple (connected) problems.

One of the things I noticed is that in all the mod_python docs the
AddHandler directive is

AddHandler python-program .py

Whereas I use (also on the old, working system)

AddHandler python-program py   <---- No '.' before 'py'

If I put the '.' in, then apache never finds my handler (old and new
system).

On the old system, everything worked once I compiled with -DEAPI (I had
no issues with threading).  On the new setup I get apache SegFaults.  I
compile as a DSO on both systems.

In trying to fix the SegFault problem, I made myself a separate Python
in /usr/local/src/Python-1.5.2 which I compiled without threads.  I
have also compiled mod_python against this non-threaded python version.
 All this has not helped.  The following things occur:

If I run 'httpd -X' (single httpd and you can see the stdout) and I try
to load my webpage in Netscape (running locally) I will sometimes get
"module '/home/slbin/stoploss/slhead' contains no 'handler'" and
sometimes "no module named re" with the error coming out of my slhead
function.

The irritating thing is that the error messages show that I am using
libraries from my normal python installation and not my non-threaded
install.  Is there any way to force mod_python to load a python from a
certain path?

If I run httpd normally, my page(s) - I use multiple frames, each
generated by the same handler based on the URL - will load.

I have "PythonHandler slhead::handler" in my httpd.conf, and my
functions are inside slhead.py

I now know why my handler stops - I get segfaults whenever I try to
access req.connection.remote_ip.  This used to work - has the
apache/mod_python API changed?

Any ideas, especially on why httpd -X doesn't work and how to enforce a
certain python interpreter, would be most welcome.

Regards
Alexis




__________________________________________________
Do You Yahoo!?
Yahoo! Auctions - buy the things you want at great prices
http://auctions.yahoo.com/

From grisha at modpython.org  Thu May 10 14:14:26 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:58:54 2004
Subject: [mod_python] empty apache Connection object
In-Reply-To: <13CDDE6A53DBD311BC3200508B6F0C4805E47DE4@rover.foolhq.com>
Message-ID: <Pine.BSF.4.32.0105101414020.34628-100000@localhost>

Can you elaborate on 'empty'?

On Wed, 9 May 2001, Chris Hagner wrote:

> Hey there,
>
> Is there a good reason that my Connection object (mp_conn) is empty?  I've
> never seen this be populated, but now I'd kind of like some of the
> information it provides.
>
> Chris
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From jvdev at 3va.net  Thu May 10 20:47:26 2001
From: jvdev at 3va.net (Jeroen van Drie)
Date: Fri Jan  9 21:58:54 2004
Subject: [mod_python] mod_python DSO in my config
Message-ID: <01051020382904.01357@e109009>

Hi list,

I've installed mod_python on my rh7.1 test machine as a DSO - works like a 
dream - congrats on the team with an excellent module. However!

I need a bit of help getting this to work on my production server which is a 
RH 6.2 running apache 1.3.12 with as `non-standard' both mod_ssl and 
mod_rewrite compiled in. Other more standard modules such as mod_cgi and 
mod_auth are also compiled into the binary. I've just baked a new apache with 
mod_so compiled in and added:

LoadModule python_module libexec/mod_python.so
AddModule mod_python.c

to the config. (These are the only statements of this type (module 
definitions) in the httpd.conf)

I had apxs remade also and compiling & making the mod_python DSO was a 
success.

when I stop and startssl apache I get the notification that 
[warn] Loaded DSO libexec/mod_python.so uses plain Apache 1.3 API, this 
module might crash under EAPI! (please recompile it with -DEAPI)

Which according to many accounts is no problem. However - there is no 
instance of apache running after the startssl command. Worst of all - there 
is nothing in the logs to indicate why the server doesn't want to start  - 
even if running it with LogLevel debug

If I just start the server without ssl enabled the server is started but 
returns a connection refused upon execution of any binary cgi program. 

Since mod_python should be the first in the LoadModule list maybe the 
assumption that it should be compiled into the binary is valid - or that all 
modules should be DSO's so that mod_python can get first pick. But I have as 
many theories as braincells :)

Thanks & best regards,
Jeroen van Drie.

From gdamjan at mail.net.mk  Fri May 11 02:21:44 2001
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 21:58:54 2004
Subject: [mod_python] What is happening here ?
In-Reply-To: <3AFA9392.CD147616@geko.net.au>; from dave@geko.net.au on Thu, May 10, 2001 at 11:11:46PM +1000
References: <3AFA9392.CD147616@geko.net.au>
Message-ID: <20010511022144.A499@local.izmislen.mk>

...

> No module named myscript
> 
> I get this error when I try to run the following script.
> 
...

How is Apache setup, and where is the 'myscript.py' script located?
It seems that mod_python can't find your 'myscript.py' file.

-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From rbunke at helios.acomp.usf.edu  Thu May 10 20:38:40 2001
From: rbunke at helios.acomp.usf.edu (Rick Bunke)
Date: Fri Jan  9 21:58:54 2004
Subject: [mod_python] I can't get apache to handle a .py file
Message-ID: <Pine.GSO.4.21.0105101911530.26528-100000@nova.acomp.usf.edu>

Hello,

I'm stuck.  I've read the FAQ.  I've read mod_python Manuel up to 2.4
testing your new installation.  I've followed the directions there for
mptest.py but all apache will do for me is serve up the text file
mptest.py.  It wont hand it off to mod_python.  I compiled the mod into
apache as static not DSO. 

I'll be glad to send the bulk of my config file if requested to do so but
here is what I think is the important stuff.

httpd.conf
#------ 
LogLevel debug

DocumentRoot "/home/myhome/Text/Web"

#I was just trying to turn every thing on here while I was troubleshouting
#this problem...
<Directory "/">
        Options All +MultiViews
</Directory>

# Python stuff according to mod_python manuel
<Directory "/home/myhome/Texts/Web/pytest">
        AddHandler python-program .py
        PythonHandler mptest
        PythonDebug On
</Directory>
#--------

the config file is basically identical to apache default config
file with the specific site info changed.

[black_box]cat mptest.py
from mod_python import apache
    
def handler(req):
        req.send_http_header()
        req.write("Hello World!")
        return apache.OK

[black_box]ls -l mptest.py
-rwxr-xr-x    1 rick     rick          123 May 10 19:35 mptest.py*

I wasn't sure if mptest.py was suppose to be excutable or not so I it
made it excutable just in case.

when I put a "#!/usr/local/python" in at the top and run it stand alone, 
it doesn't like the "import _apache" line which doesn't really surprise me
sense I don't think your suppose to run it like that :)  I was just trying
to figure what was wrong sense I get no errors in my error.log 

When I type "http://myip/pytest/mptest.py" in web my browser, it displays 
the text file:

from mod_python import apache
    
def handler(req):
	req.send_http_header()
	req.write("Hello World!")
	return apache.OK


Also, when I compiled apache, it failed in the mod_python directory saying
some functions (openpty and forkpty) were "undefined references" so I had
to add "-lutil" to the 
"LIBS="$LIBS -lm /usr/local/src/Python-2.1c2/libpython2.1.a"" 
line in the libpython.module config file, rerun configure, and then it
would compile ok.  possable bug in the configure scripts, or my setup, I
don't know which.

I run Linux 2.4.4
Python 2.1c2 
Apache 1.3.19
Mod_Python 2.7.2

Please help me :)

Thanks
Rick

we enjoy great advantages from the inventions of others, we should be 
glad of an opportunity to serve others by any invention of ours; and 
this we should do freely and generously.
		- Ben Franklin (declining to take out a patent on the
				Franklin Stove)

Whenever there is a conflict between human rights and property rights, 
human rights must prevail.
	           - Abraham Lincoln
	
Information is the currency of democracy.
		   - Thomas Jefferson


From rdevide at ican.at  Fri May 11 09:52:49 2001
From: rdevide at ican.at (Devide Robert)
Date: Fri Jan  9 21:58:54 2004
Subject: [mod_python] I can't get apache to handle a .py file
References: <Pine.GSO.4.21.0105101911530.26528-100000@nova.acomp.usf.edu>
Message-ID: <3AFB9A51.657A4723@ican.at>

Rick Bunke wrote:

> DocumentRoot "/home/myhome/Text/Web"
 :
> <Directory   "/home/myhome/Texts/Web/pytest">

Text <-> Texts ???

dave

From rbunke at helios.acomp.usf.edu  Sat May 12 16:12:43 2001
From: rbunke at helios.acomp.usf.edu (Rick Bunke)
Date: Fri Jan  9 21:58:54 2004
Subject: [mod_python] I can't get apache to handle a .py file
In-Reply-To: <3AFB9A51.657A4723@ican.at>
Message-ID: <Pine.GSO.4.21.0105121605430.4178-100000@nova.acomp.usf.edu>

On Fri, 11 May 2001, Devide Robert wrote:
                                
> Rick Bunke wrote:
>
> > DocumentRoot "/home/myhome/Text/Web"
>  :
> > <Directory   "/home/myhome/Texts/Web/pytest">
>
> Text <-> Texts ???
>
> dave
>

Thanks, It works now.
That was the annoying little detail that I've been overlooking and
pulling my hair out over for three days now while thinking, it can't be
this hard!  :)

Thank You, again 
Rick

we enjoy great advantages from the inventions of others, we should be 
glad of an opportunity to serve others by any invention of ours; and 
this we should do freely and generously.
		- Ben Franklin (declining to take out a patent on the
				Franklin Stove)

Whenever there is a conflict between human rights and property rights, 
human rights must prevail.
	           - Abraham Lincoln
	
Information is the currency of democracy.
		   - Thomas Jefferson



From dave at geko.net.au  Mon May 14 22:34:29 2001
From: dave at geko.net.au (David Creelman)
Date: Fri Jan  9 21:58:54 2004
Subject: [mod_python] What is happening here ?
References: <3AFA9392.CD147616@geko.net.au> <20010511022144.A499@local.izmislen.mk>
Message-ID: <3AFFD0D5.9B0A08A2@geko.net.au>

Hi Damjan,

myscript.py is in /var/www/cgi-bin. I'm running Mandrake 8.0.

Should it go somewhere else ?

Cheers
David

Damjan wrote:

> ...
>
> > No module named myscript
> >
> > I get this error when I try to run the following script.
> >
> ...
>
> How is Apache setup, and where is the 'myscript.py' script located?
> It seems that mod_python can't find your 'myscript.py' file.
>
> --
> Damjan Georgievski              |           ???????~???? ??????????????????????
> Skopje, Macedonia               |           ?????????~??, ?????????????????~??
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From petar at metamarkets.com  Mon May 14 08:38:52 2001
From: petar at metamarkets.com (Petar Karafezov)
Date: Fri Jan  9 21:58:54 2004
Subject: [mod_python] RE: setting multiple cookies with req.headers_out
Message-ID: <86FC34EA3C4F074AA6BBFFE52ED83FED27C1D5@METAEXCH.sfo.metamarkets.com>

Hello all -

I am trying to send more than one cookie in my req.headers_out. The problem
is that req.headers_out is a dictionary - and if I want to send more than 1
cookie - only the last one gets send - they all have key 'Set-cookie'.

I am sure there's a quick and easy solution for this ...I just didn't see
it. Could anyone share ideas/experience on this issue ?

Thanks!

Regards to all,
Petar Karafezov

MetaMarkets.com
415-575-3015
-------------------------------------------
Investing Out Loud at
http://www.metamarkets.com
-------------------------------------------

From miguel at yorku.ca  Mon May 14 11:57:09 2001
From: miguel at yorku.ca (Miguel Marques)
Date: Fri Jan  9 21:58:54 2004
Subject: [mod_python] RE: setting multiple cookies with req.headers_out
In-Reply-To: <86FC34EA3C4F074AA6BBFFE52ED83FED27C1D5@METAEXCH.sfo.metamarkets.com>
References: <86FC34EA3C4F074AA6BBFFE52ED83FED27C1D5@METAEXCH.sfo.metamarkets.com>
Message-ID: <20010514115709Y.miguel@yorku.ca>

Greetings...
On Mon, 14 May 2001 08:38:52 -0700, Petar Karafezov <petar@metamarkets.com> wrote:
> Hello all -
> 
> I am trying to send more than one cookie in my req.headers_out. The problem
> is that req.headers_out is a dictionary - and if I want to send more than 1
> cookie - only the last one gets send - they all have key 'Set-cookie'.
> 
> I am sure there's a quick and easy solution for this ...I just didn't see
> it. Could anyone share ideas/experience on this issue ?
> 
Just use 

req.headers_out.add('Set-Cookie', ...)

as many time as you need.

						Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830




From grisha at modpython.org  Mon May 14 13:09:09 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:58:54 2004
Subject: [mod_python] RE: setting multiple cookies with req.headers_out
In-Reply-To: <86FC34EA3C4F074AA6BBFFE52ED83FED27C1D5@METAEXCH.sfo.metamarkets.com>
Message-ID: <Pine.BSF.4.32.0105141308590.97224-100000@localhost>


http://www.modpython.org/live/mod_python-2.7.3/doc-html/pyapi-mptable.html



On Mon, 14 May 2001, Petar Karafezov wrote:

> Hello all -
>
> I am trying to send more than one cookie in my req.headers_out. The problem
> is that req.headers_out is a dictionary - and if I want to send more than 1
> cookie - only the last one gets send - they all have key 'Set-cookie'.
>
> I am sure there's a quick and easy solution for this ...I just didn't see
> it. Could anyone share ideas/experience on this issue ?
>
> Thanks!
>
> Regards to all,
> Petar Karafezov
>
> MetaMarkets.com
> 415-575-3015
> -------------------------------------------
> Investing Out Loud at
> http://www.metamarkets.com
> -------------------------------------------
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From grisha at modpython.org  Mon May 14 17:25:07 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:58:54 2004
Subject: [mod_python] problem with publisher.py File class w/ possible
 fix
In-Reply-To: <A9DFD9380C01D4118E740050DA7A89703860FA@becomm-mis2.becomm.com>
Message-ID: <Pine.BSF.4.32.0105141722420.99402-100000@localhost>

Marc -

Do you have any more details so I could reproduce this error? I am having
a hard time understanding why it would insist on m being an integer.
Perhaps you have the piece of code that caused it?

Grisha


On Wed, 21 Mar 2001, Marc Fiuczynski wrote:

> Hi,
>
> I am having a problem with the publisher.py File class, which I have fixed,
> but I would like your approval.
>
> My configuration is as follows:
> mod_python 2.7.2
> python 2.0
> apache 1.3.14
> Red Hat Linux 7.0
>
> I am using mod python to do http_post operations with files.  This uses the
> publisher.py File class.  The __init__ method of that class steals all of
> the file-like methods, as shown below:
>
>         # steal all the file-like methods
>         methods = field.file.__methods__
>         for m in methods:
>             self.__dict__[m] = methods[m]
>
> I was getting an error in that last line saying that 'm' needed to be an
> int.  (Sorry, I forget the actual error).  I found some other code that was
> doing the exact same thing and noticed that they were assigning the methods
> in a different manner (using setattr).  See below:
>
>         # steal all the file-like methods
>         file = field.file
>         for method in file.__methods__:
>             setattr(self, method, getattr(file, method))
>
> This seems to work.  I am too nascent to Python to understand the history of
> the built-in __xyz__ fields in objects, and whether this is something
> specific to Python 2.0 versus an older version of Python.  Please review and
> if it is the right thing, then feel free to incorporate this change into
> your mod_python code base.
>
> Cheers,
> Marc
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From SumnerH at fool.com  Mon May 14 18:33:44 2001
From: SumnerH at fool.com (G . Sumner Hayes)
Date: Fri Jan  9 21:58:54 2004
Subject: [mod_python] PythonImport question
Message-ID: <20010514183344.A6813@fool.com>

Brief version:
I have a patch to make PythonImport take place during server init
instead of child init--is there any chance it would be accepted?

Long version:
So the PythonImport documentation says:

: Tells the server to import the Python module module at process
: startup. This is useful for initialization tasks that could be
: time consuming and should not be done at the request processing
: time, e.g. initializing a database connection.
:
: The import takes place at child process initialization, so the
: module will actually be imported once for every child process
: spawned.

Having the import take place at every child process
initialization seems to run counter to the purpose of the
statement (doing time consuming server startup stuff).  It
also makes the various children have potentially different
PythonImport'd contents if the module(s) imported that way
are edited in place.

I'm wondering if anyone actually wants that behavior; it seems
like it'd be better to do the PythonImport exactly once at server
startup.

Rationale 1:
Suppose I have a ton of expensive startup work to do in my
PythonImport lines.  Furthermore, I need to be able to do
apache graceful restarts even while under heavy load.  Here's
a sketch of how the apache graceful restarts work--I'll pretend
there are 3 different types of apache process, a "master control
program" or MCP which coordinates startup, a "pool master" or
PM which spawns children as needed, and the child processes
or CPs.

1.  A user sends MCP a SIGUSR1 signal indicating a graceful
restart should take place.  The old PM and CPs continue
handling incoming requests.
2.  MCP starts up a new PM, which reads all startup files and
processes them; this includes running the server init functions
for apache modules (in particular mod_python).
3.  New PM finishes reading startup and fork()s off new CPs (as
per the MinSpareServers and related apache directives).  After
forking new CPs, the new PM tells the MCP that it is ready to
go.
4.  MCP tells old PM to shut down and routes all new incoming
requests to the new PM. 
5.  Old PM tells old CPs to exit; if they're idle, they exit
immediately.  If they're serving a request, they finish doing
so and then exit.

Pretty elegant; you can change the entire apache config on the
fly without dropping any connections.  You can even update shared
objects this way without dropping connections; you can e.g.
migrate from python 1.5.2 to Stackless Python 2.0 (potentially
with a new version of mod_python) seamlessly.

_However_, step (3) gets us in trouble if PythonImports happen
in the child process--the old PM will be exiting while the new
CPs are busy doing whatever (potentially many-second or evan
minute-long) the PythonImports say to do.

If PythonImports took place in the server init, they'd get done
before the new PM/CPs took over; the old ones would continue
serving requests until the new ones were ready.

(Yes, the setup involved will have high-availability measures
in place, but it'd be really nice to have this feature for a
number of reasons).

Rationale 2:
It's far more "apache-like" for configuration data to be read
exactly 1 time at startup and then re-read when explicitly asked
to do so (via a graceful restart).  As it stands now, if I'm
importing mystuff.py via PythonImport and I edit that file while
the server is running, some apache children (which started before
my edits) will have the old mystuff module and others (which
happened to start after my edits) will have the new one.  That's
confusing and potentially dangerous, and if I'm editing files
in place (groan, I know) it's full of nasty races.

Let me know and I'll send a patch.

  Sumner

-- 
rage, rage against the dying of the light

From CHagner at fool.com  Tue May 15 11:00:58 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:58:54 2004
Subject: [mod_python] empty apache Connection object
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E47E1D@rover.foolhq.com>

Sorry for vague statement... here's what I'm seeing when I print out the
Connection object and its attributes.  As you can see, there does appear to
be an mp_conn object present, but all attributes/methods return 'None'.
Thoughts?  Let me know if there's something more valuable I can do to
determine the state of the object.  Thanks.

REQUEST'S CONNECTION'S VALUES
conn: <mp_conn object at 0x87ad968>
child num: None
local address: None
remote address: None
remote ip: None
remote host: None
remote logname: None
user name: None
auth type: None
keep alives: None
local ip: None
local host: None

Chris

-----Original Message-----
From: Gregory (Grisha) Trubetskoy [mailto:grisha@modpython.org]
Sent: Thursday, May 10, 2001 2:14 PM
To: Chris Hagner
Cc: 'mod_python@modpython.org'
Subject: Re: [mod_python] empty apache Connection object



Can you elaborate on 'empty'?

On Wed, 9 May 2001, Chris Hagner wrote:

> Hey there,
>
> Is there a good reason that my Connection object (mp_conn) is empty?  I've
> never seen this be populated, but now I'd kind of like some of the
> information it provides.
>
> Chris
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>

From CHagner at fool.com  Fri May 18 13:45:05 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:58:54 2004
Subject: [mod_python] several mod_python issues
Message-ID: <200105182250.SAA27068@monkeyboy.dorc.foolhq.com>

While working with mod_python lately, we've noticed a couple of
inconsistencies with the documentation and also have a few 
comments/questions on intended behavior and whether certain behavior 
was intended or is just a bug.

1. The PythonNoReload directive is a bit confusing and does not provide
   an option that would also be useful. "PythonNoReload Off" performs a
   full reload/import of the pyhandler on every request.
   "PythonNoReload On" only performs a reload/import when the mtime
   of the handler has changed. We would like to also propose an
   additional option to "never" reload/import the handler except upon
   initial startup of the child process. This would allow for a more
   controlled re-initialization of the server(s) via an apache graceful
   restart.

2. Modules pre-loaded via the PythonImport directive do not appear to be
   readily available in the handler. We've verified that Python Import
   and the handler are running in the same interpreter space by passing
   info via global classes such as Exception, but we can't find the
   modules loaded via PythonImport. They must be somewhere, but just
   can't seem to locate them... What is the expected way to access
   modules that have been pre-loaded via PythonImport from within code
   such as the handler?

3. As detailed in an earlier post from Sumner Hayes, mod_python does not
   perform as expected/desired on a apache graceful restart.
   Essentially, new children are spawned and declared ready to the
   parent before they can actually serve requests (ie still initilizing
   any PythonImport directives). The mod_python directives should be
   fully processed before considering the child ready to serve requests.

This isn't meant as just a rant. Just some things that we've noticed
that are important in our environment. We're willing to help with fixes,
etc., but wanted to make sure we had a full perspective on all the
issues at hand before attacking this stuff. 

Please let us know what you think about the observations listed above.
Thanks.

-- 
Stephan Koledin
Mad Scientist
The Motley Fool
http://fool.com



From grisha at modpython.org  Sat May 19 00:38:41 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:58:54 2004
Subject: [mod_python] several mod_python issues
In-Reply-To: <200105182250.SAA27068@monkeyboy.dorc.foolhq.com>
Message-ID: <Pine.BSF.4.32.0105190031400.54052-100000@localhost>

On Fri, 18 May 2001, Chris Hagner wrote:

> While working with mod_python lately, we've noticed a couple of
> inconsistencies with the documentation and also have a few
> comments/questions on intended behavior and whether certain behavior
> was intended or is just a bug.
>
> 1. The PythonNoReload directive is a bit confusing and does not provide
>    an option that would also be useful. "PythonNoReload Off" performs a
>    full reload/import of the pyhandler on every request.
>    "PythonNoReload On" only performs a reload/import when the mtime
>    of the handler has changed. We would like to also propose an
>    additional option to "never" reload/import the handler except upon
>    initial startup of the child process. This would allow for a more
>    controlled re-initialization of the server(s) via an apache graceful
>    restart.

This one is a BUG that seems to have been introduced in 2.7.3 releases
while trying to fix another one....

The remaining two issues are just a big mess because I never gave any
priority to PythonImport. The only catch with Summer Hayes's approach is
that stuff will run as root, which to me seems kind of bad. (I haven't
seen the patch, so this is part speculation)

Grisha

> 2. Modules pre-loaded via the PythonImport directive do not appear to be
>    readily available in the handler. We've verified that Python Import
>    and the handler are running in the same interpreter space by passing
>    info via global classes such as Exception, but we can't find the
>    modules loaded via PythonImport. They must be somewhere, but just
>    can't seem to locate them... What is the expected way to access
>    modules that have been pre-loaded via PythonImport from within code
>    such as the handler?
>
> 3. As detailed in an earlier post from Sumner Hayes, mod_python does not
>    perform as expected/desired on a apache graceful restart.
>    Essentially, new children are spawned and declared ready to the
>    parent before they can actually serve requests (ie still initilizing
>    any PythonImport directives). The mod_python directives should be
>    fully processed before considering the child ready to serve requests.
>
> This isn't meant as just a rant. Just some things that we've noticed
> that are important in our environment. We're willing to help with fixes,
> etc., but wanted to make sure we had a full perspective on all the
> issues at hand before attacking this stuff.
>
> Please let us know what you think about the observations listed above.
> Thanks.
>
> --
> Stephan Koledin
> Mad Scientist
> The Motley Fool
> http://fool.com
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From teepwalla at yahoo.com  Fri May 18 21:51:21 2001
From: teepwalla at yahoo.com (Prateep Siamwalla)
Date: Fri Jan  9 21:58:54 2004
Subject: [mod_python] mod_python and locale
Message-ID: <20010519045121.32984.qmail@web14306.mail.yahoo.com>

Hi All,

I've come across a problem with mod_python (2.7.2
compiled with Python 2.0 --with-threads=no) on Linux
(RH 7.0) regarding locale.

the following code (mptest.py):
-----------------
from mod_python import apache
from locale import setlocale,LC_ALL,format


def handler(req):
    req.content_type = "text/plain"
    req.send_http_header()
    setlocale(LC_ALL,'')
    a = 123123231.323    
    req.write("The formatted version of the number %s
is %s" % (a,format('%.2f',a,1)))
    return apache.OK

Produces:
----------------------
The formatted version of the number 123123231.323 is
123123231.32

Rather than the expected
-----------------------
....123,123,231.32

I don't have any problems with locale formating on
Win98+Apache+Python2.0.  Is this a recognized problem?

I've tried locale formating from the Python 2.0
command line on the Linux box and it yields expected
results ( 123,123,231.32)

I've tried locale formating from the compiled
Python2.0 with no threads binary on the Linux box and
it also yields expected results.

Its only on mod_python am I encountering a lack of
correct formating.

Have others encountered this problem?

Thanks in advance.
teep


__________________________________________________
Do You Yahoo!?
Yahoo! Auctions - buy the things you want at great prices
http://auctions.yahoo.com/

From gdamjan at mail.net.mk  Sat May 19 12:03:10 2001
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 21:58:54 2004
Subject: [mod_python] What is happening here ?
In-Reply-To: <3AFFD0D5.9B0A08A2@geko.net.au>; from dave@geko.net.au on Mon, May 14, 2001 at 10:34:29PM +1000
References: <3AFA9392.CD147616@geko.net.au> <20010511022144.A499@local.izmislen.mk> <3AFFD0D5.9B0A08A2@geko.net.au>
Message-ID: <20010519120310.A256@local.izmislen.mk>

On Mon, May 14, 2001 at 10:34:29PM +1000, David Creelman wrote:
> > ...
> >
> > > No module named myscript
> > >
> > > I get this error when I try to run the following script.
> > >
> > ...
> >
> > How is Apache setup, and where is the 'myscript.py' script located?
> > It seems that mod_python can't find your 'myscript.py' file.
>
> myscript.py is in /var/www/cgi-bin. I'm running Mandrake 8.0.
> 
> Should it go somewhere else ?

Yes! Put it somewhere in the python search path.

Also you should probably reread the mod_python documentation. 
mod_python is not related to CGI scripts, but is a scripting engine
inside the apache process. You can do much more with mod_python than
with CGI.

-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From dyeung at ust.hk  Sat May 19 19:45:43 2001
From: dyeung at ust.hk (David Yeung)
Date: Fri Jan  9 21:58:54 2004
Subject: [mod_python] Modules with identical name in different directories
Message-ID: <3B065CE7.2BD9F0CA@ust.hk>

If I have two different python modules with identical name (index.py), e.g.:

   http://host/pytest1/index.py/mainpage

and

   http://host/pytest2/index.py/mainpage

When I access the first index.py module, the mod_python import the first index.py.
Then I switch to access the second index.py. Will the mod_python know it is a
different module with the first one, and then import the second 'index.py' 
automatically? Or it will use the already imported 'index.py' module?

Thanks

david

From grisha at modpython.org  Sat May 19 13:35:58 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:58:54 2004
Subject: [mod_python] Modules with identical name in different directories
In-Reply-To: <3B065CE7.2BD9F0CA@ust.hk>
Message-ID: <Pine.BSF.4.32.0105191334130.62711-100000@localhost>

On Sat, 19 May 2001, David Yeung wrote:

> If I have two different python modules with identical name (index.py), e.g.:
>
>    http://host/pytest1/index.py/mainpage
>
> and
>
>    http://host/pytest2/index.py/mainpage
>
> When I access the first index.py module, the mod_python import the first index.py.
> Then I switch to access the second index.py. Will the mod_python know it is a
> different module with the first one, and then import the second 'index.py'
> automatically? Or it will use the already imported 'index.py' module?

By default it will use already imported index.py module. But you can use
the PythonInterpPerDirectory, in which case the two would run in separate
subinterpreters.

Grisha


From alain at onesite.org  Sun May 20 04:45:02 2001
From: alain at onesite.org (=?iso-8859-1?Q?Alain_T=E9sio?=)
Date: Fri Jan  9 21:58:55 2004
Subject: [mod_python] When trying to get cgi.FieldStorage() : AttributeError: 'sys' module has no attribute 'argv'
Message-ID: <001101c0e0d6$df62ef40$400110ac@alain>

Hi, I found a message in an archive saying I shouldn't use
FieldStorage with publisher
http://www.modpython.org/pipermail/mod_python/2001-January/001086.html
but I'm not using publisher (or I don't know I am)
Any idea what's happening ?

Thanks
Alain

=========== observer_www.py
import cgi
items=cgi.FieldStorage()

=========== output

Mod_python error: "PythonHandler observer_www"

Traceback (most recent call last):

  File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line
176, in Dispatch
    module = import_module(module_name, _req)

  File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line
340, in import_module
    module = imp.load_module(mname, f, p, d)

  File "/home/observer/scripts/observer_www.py", line 2, in ?
    items=cgi.FieldStorage()

  File "/usr/local/lib/python2.1/cgi.py", line 445, in __init__
    elif sys.argv[1:]:

AttributeError: 'sys' module has no attribute 'argv'



From grisha at modpython.org  Sun May 20 01:17:35 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:58:55 2004
Subject: [mod_python] When trying to get cgi.FieldStorage() : AttributeError:
 'sys' module has no attribute 'argv'
In-Reply-To: <001101c0e0d6$df62ef40$400110ac@alain>
Message-ID: <Pine.BSF.4.32.0105200111390.67081-100000@localhost>

This is because indeed the sys module has no attribute argv inside
subinterpreters. This is a "feature not a bug" and is documented somewhere
in the Python docs.

If you're using the cgi module, just fake the the argv by doing something
like:

import sys
sys.argv = []

then cgi module will be happy.

Grisha

On Sun, 20 May 2001, [iso-8859-1] Alain T?sio wrote:

> Hi, I found a message in an archive saying I shouldn't use
> FieldStorage with publisher
> http://www.modpython.org/pipermail/mod_python/2001-January/001086.html
> but I'm not using publisher (or I don't know I am)
> Any idea what's happening ?
>
> Thanks
> Alain
>
> =========== observer_www.py
> import cgi
> items=cgi.FieldStorage()
>
> =========== output
>
> Mod_python error: "PythonHandler observer_www"
>
> Traceback (most recent call last):
>
>   File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line
> 176, in Dispatch
>     module = import_module(module_name, _req)
>
>   File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line
> 340, in import_module
>     module = imp.load_module(mname, f, p, d)
>
>   File "/home/observer/scripts/observer_www.py", line 2, in ?
>     items=cgi.FieldStorage()
>
>   File "/usr/local/lib/python2.1/cgi.py", line 445, in __init__
>     elif sys.argv[1:]:
>
> AttributeError: 'sys' module has no attribute 'argv'
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From emailreklama at yahoo.com  Sun May 20 21:09:15 2001
From: emailreklama at yahoo.com (EmailReklama)
Date: Fri Jan  9 21:58:55 2004
Subject: [mod_python] E-MAIL 
Message-ID: <033300912171451SERVER@server>

????????? ???????? ????? ??????? ?? e-mail ?????:

?????? - 28000 ????? ??????.
?????? - 300000 ?? ??? 30% ???????????, 50% ?????????? ??????.

????????? ???????? 2 ??????? ??? ?? 1000 ?????.

??????????????? ?????.

From alain at onesite.org  Sun May 20 19:39:45 2001
From: alain at onesite.org (Alain Tesio)
Date: Fri Jan  9 21:58:55 2004
Subject: [mod_python] When trying to get cgi.FieldStorage() : AttributeError: 'sys' module has no attribute 'argv'
References: <Pine.BSF.4.32.0105200111390.67081-100000@localhost>
Message-ID: <004401c0e153$dccc8520$400110ac@alain>

Thanks for the information, but how can I get the GET parameters then ?
The usual cgi variables aren't in os.environ

Alain

----- Original Message -----
From: "Gregory (Grisha) Trubetskoy" <grisha@modpython.org>
To: "Alain Tesio" <alain@onesite.org>
Cc: "ML mod_python" <mod_python@modpython.org>
Sent: Sunday, May 20, 2001 7:17 AM
Subject: Re: [mod_python] When trying to get cgi.FieldStorage() :
AttributeError: 'sys' module has no attribute 'argv'


>
> This is because indeed the sys module has no attribute argv inside
> subinterpreters. This is a "feature not a bug" and is documented somewhere
> in the Python docs.
>
> If you're using the cgi module, just fake the the argv by doing something
> like:
>
> import sys
> sys.argv = []
>
> then cgi module will be happy.
>
> Grisha
>
> On Sun, 20 May 2001, [iso-8859-1] Alain T?sio wrote:
>
> > Hi, I found a message in an archive saying I shouldn't use
> > FieldStorage with publisher
> > http://www.modpython.org/pipermail/mod_python/2001-January/001086.html
> > but I'm not using publisher (or I don't know I am)
> > Any idea what's happening ?
> >
> > Thanks
> > Alain
> >
> > =========== observer_www.py
> > import cgi
> > items=cgi.FieldStorage()
> >
> > =========== output
> >
> > Mod_python error: "PythonHandler observer_www"
> >
> > Traceback (most recent call last):
> >
> >   File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py",
line
> > 176, in Dispatch
> >     module = import_module(module_name, _req)
> >
> >   File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py",
line
> > 340, in import_module
> >     module = imp.load_module(mname, f, p, d)
> >
> >   File "/home/observer/scripts/observer_www.py", line 2, in ?
> >     items=cgi.FieldStorage()
> >
> >   File "/usr/local/lib/python2.1/cgi.py", line 445, in __init__
> >     elif sys.argv[1:]:
> >
> > AttributeError: 'sys' module has no attribute 'argv'
> >
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://www.modpython.org/mailman/listinfo/mod_python
> >


From grisha at modpython.org  Sun May 20 20:22:20 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:58:55 2004
Subject: [mod_python] When trying to get cgi.FieldStorage() : AttributeError:
 'sys' module has no attribute 'argv'
In-Reply-To: <004401c0e153$dccc8520$400110ac@alain>
Message-ID: <Pine.BSF.4.32.0105202021500.75359-100000@localhost>

Try reading the manual:

http://www.modpython.org/live/mod_python-2.7.3/doc-html/pyapi-util-fstor.html

On Sun, 20 May 2001, Alain Tesio wrote:

> Thanks for the information, but how can I get the GET parameters then ?
> The usual cgi variables aren't in os.environ
>
> Alain
>
> ----- Original Message -----
> From: "Gregory (Grisha) Trubetskoy" <grisha@modpython.org>
> To: "Alain Tesio" <alain@onesite.org>
> Cc: "ML mod_python" <mod_python@modpython.org>
> Sent: Sunday, May 20, 2001 7:17 AM
> Subject: Re: [mod_python] When trying to get cgi.FieldStorage() :
> AttributeError: 'sys' module has no attribute 'argv'
>
>
> >
> > This is because indeed the sys module has no attribute argv inside
> > subinterpreters. This is a "feature not a bug" and is documented somewhere
> > in the Python docs.
> >
> > If you're using the cgi module, just fake the the argv by doing something
> > like:
> >
> > import sys
> > sys.argv = []
> >
> > then cgi module will be happy.
> >
> > Grisha
> >
> > On Sun, 20 May 2001, [iso-8859-1] Alain T?sio wrote:
> >
> > > Hi, I found a message in an archive saying I shouldn't use
> > > FieldStorage with publisher
> > > http://www.modpython.org/pipermail/mod_python/2001-January/001086.html
> > > but I'm not using publisher (or I don't know I am)
> > > Any idea what's happening ?
> > >
> > > Thanks
> > > Alain
> > >
> > > =========== observer_www.py
> > > import cgi
> > > items=cgi.FieldStorage()
> > >
> > > =========== output
> > >
> > > Mod_python error: "PythonHandler observer_www"
> > >
> > > Traceback (most recent call last):
> > >
> > >   File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py",
> line
> > > 176, in Dispatch
> > >     module = import_module(module_name, _req)
> > >
> > >   File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py",
> line
> > > 340, in import_module
> > >     module = imp.load_module(mname, f, p, d)
> > >
> > >   File "/home/observer/scripts/observer_www.py", line 2, in ?
> > >     items=cgi.FieldStorage()
> > >
> > >   File "/usr/local/lib/python2.1/cgi.py", line 445, in __init__
> > >     elif sys.argv[1:]:
> > >
> > > AttributeError: 'sys' module has no attribute 'argv'
> > >
> > >
> > > _______________________________________________
> > > Mod_python mailing list
> > > Mod_python@modpython.org
> > > http://www.modpython.org/mailman/listinfo/mod_python
> > >
>


From gdamjan at mail.net.mk  Tue May 22 01:32:22 2001
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 21:58:55 2004
Subject: [mod_python] mod_python and locale
In-Reply-To: <20010519045121.32984.qmail@web14306.mail.yahoo.com>; from teepwalla@yahoo.com on Fri, May 18, 2001 at 09:51:21PM -0700
References: <20010519045121.32984.qmail@web14306.mail.yahoo.com>
Message-ID: <20010522013222.A259@local.izmislen.mk>

> I've come across a problem with mod_python (2.7.2
> compiled with Python 2.0 --with-threads=no) on Linux
> (RH 7.0) regarding locale.
> 
> the following code (mptest.py):
> -----------------
> from mod_python import apache
> from locale import setlocale,LC_ALL,format
> 
> 
> def handler(req):
>     req.content_type = "text/plain"
>     req.send_http_header()
>     setlocale(LC_ALL,'')

This command set the locale to the one specified with the LC_xx or LANG
enviroment variables.

>     a = 123123231.323    
>     req.write("The formatted version of the number %s
> is %s" % (a,format('%.2f',a,1)))
>     return apache.OK
> 
> Produces:
> ----------------------
> The formatted version of the number 123123231.323 is
> 123123231.32
> 
> Rather than the expected
> -----------------------
> ....123,123,231.32

When you run your scripts interactively you have defined some locale by the
LC_xxx or the LANG variable. On the other side, it seems that your Apache 
process is using the default locale (C), so that's why the formating looks 
like that.

I would use -- setlocale(LC_ALL,'mk_MK') -- to get macedonian localization in
python scripts, but perhaps you would like to change this on a per user 
preference.



-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From teep at inet.co.th  Tue May 22 19:39:11 2001
From: teep at inet.co.th (Prateep Siamwalla)
Date: Fri Jan  9 21:58:55 2004
Subject: [mod_python] mod_python and locale
Message-ID: <002901c0e2bc$39d40860$0c05a8c0@taramansion.bangkok>

Yes!!! Thanks alot, Damjam....shame on me for not reading the docs on locale
more closely.

teep




From sam at webslingerZ.com  Tue May 22 09:55:58 2001
From: sam at webslingerZ.com (Sam Brauer)
Date: Fri Jan  9 21:58:55 2004
Subject: [mod_python] ANN: new release of maki
Message-ID: <Pine.LNX.4.31.0105220955150.1926-100000@localhost.localdomain>

I've released a new version of maki at http://maki.sourceforge.net

maki is a mod_python handler which uses various 4Suite components to serve
XML with Apache.  It allows a web developer to specify processing rules
based on path-matching regular expressions.  Each rule describes a
pipeline with any number of XSLT steps and/or custom processing steps.  A
processor that evaluates embedded Python source to dynamically modify the
document is included.  maki also supports time-based caching of output.
Also included are two example "logicsheets": one that adds HTTP request
data to the document and another that executes SQL queries and creates
elements from the results.

The overall functionality is similar (though intentionally not identical)
to Cocoon.

For more info, please take a look at the online documentation at
http://maki.sourceforge.net/manual/

Thank you,
Sam

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Sam Brauer : sbrauer@users.sourceforge.net



From dyeung at ust.hk  Wed May 23 15:14:05 2001
From: dyeung at ust.hk (David YEUNG)
Date: Fri Jan  9 21:58:55 2004
Subject: [mod_python] How to set the header 'Content-Disposition:'
Message-ID: <3B0B633D.AEBD803D@ust.hk>

I want to set the header 'Content-Disposition:' field. How can I do that
in the publisher handler.

Thanks

david

From pdeluca at sia.net.au  Thu May 24 21:13:07 2001
From: pdeluca at sia.net.au (Paul De Luca)
Date: Fri Jan  9 21:58:55 2004
Subject: [mod_python] mod python apache problem
Message-ID: <4.3.2.7.2.20010524211137.00acd710@mail.sia.net.au>

Hi,
      I am having some troubles trying to install mod_python onto my home 
PC running Windows ME (hey, its for testing purposes!). I followed the 
directions in the mod python documentation (changing the path when 
necessary). However when I try and start Apache I get the following error:

Syntax error on line 203 of c:/data/apache/conf/httpd.conf:
Cannot load c:/data/apache/modules/mod_python.dll into server: (1157) One 
of the
library files needed to run this application cannot be found:

I think this might have made a mistake at this step of the installation:
 >Move the files in the folder lib inside the mod_python folder (C:\Program
 >Files\Python\lib\mod_python-x\lib\mod_python) to the C:\Program
 >Files\Python\lib\mod_python folder. It's safe to delete these folders we 
just emptied.
but am unsure, as I am using a newer version of python and Apache than 
mentioned in the mod python documentation.

My Setup
Python 2.1  (C:\data\python2.1)
Apache 1.3.19 (C:\data\apache, root dir c:\data\apache\htdocs)
mod_python library files (C:\data\python2.1\Lib\mod_python)
mod_python.dll (C:\data\apache\modules\mod_python.dll)

My Apache httpd.conf


#
# Based upon the NCSA server configuration files originally by Rob McCool.
#
# This is the main Apache server configuration file.  It contains the
# configuration directives that give the server its instructions.
# See <URL:http://www.apache.org/docs/> for detailed information about
# the directives.
#
# Do NOT simply read the instructions in here without understanding
# what they do.  They're here only as hints or reminders.  If you are unsure
# consult the online docs. You have been warned.
#
# After this file is processed, the server will look for and process
# C:/data/apache/conf/srm.conf and then C:/data/apache/conf/access.conf
# unless you have overridden these with ResourceConfig and/or
# AccessConfig directives here.
#
# The configuration directives are grouped into three basic sections:
#  1. Directives that control the operation of the Apache server process as a
#     whole (the 'global environment').
#  2. Directives that define the parameters of the 'main' or 'default' server,
#     which responds to requests that aren't handled by a virtual host.
#     These directives also provide default values for the settings
#     of all virtual hosts.
#  3. Settings for virtual hosts, which allow Web requests to be sent to
#     different IP addresses or hostnames and have them handled by the
#     same Apache server process.
#
# Configuration and logfile names: If the filenames you specify for many
# of the server's control files begin with "/" (or "drive:/" for Win32), the
# server will use that explicit path.  If the filenames do *not* begin
# with "/", the value of ServerRoot is prepended -- so "logs/foo.log"
# with ServerRoot set to "/usr/local/apache" will be interpreted by the
# server as "/usr/local/apache/logs/foo.log".
#
# NOTE: Where filenames are specified, you must use forward slashes
# instead of backslashes (e.g., "c:/apache" instead of "c:\apache").
# If a drive letter is omitted, the drive on which Apache.exe is located
# will be used by default.  It is recommended that you always supply
# an explicit drive letter in absolute paths, however, to avoid
# confusion.
#

### Section 1: Global Environment
#
# The directives in this section affect the overall operation of Apache,
# such as the number of concurrent requests it can handle or where it
# can find its configuration files.
#

#
# ServerType is either inetd, or standalone.  Inetd mode is only supported on
# Unix platforms.
#
ServerType standalone

#
# ServerRoot: The top of the directory tree under which the server's
# configuration, error, and log files are kept.
#
ServerRoot "C:/data/apache"

#
# PidFile: The file in which the server should record its process
# identification number when it starts.
#
PidFile logs/httpd.pid

#
# ScoreBoardFile: File used to store internal server process information.
# Not all architectures require this.  But if yours does (you'll know because
# this file will be  created when you run Apache) then you *must* ensure that
# no two invocations of Apache share the same scoreboard file.
#
ScoreBoardFile logs/apache_runtime_status

#
# In the standard configuration, the server will process httpd.conf (this
# file, specified by the -f command line option), srm.conf, and access.conf
# in that order.  The latter two files are now distributed empty, as it is
# recommended that all directives be kept in a single file for simplicity.
# The commented-out values below are the built-in defaults.  You can have the
# server ignore these files altogether by using "/dev/null" (for Unix) or
# "nul" (for Win32) for the arguments to the directives.
#
#ResourceConfig conf/srm.conf
#AccessConfig conf/access.conf

#
# Timeout: The number of seconds before receives and sends time out.
#
Timeout 300

#
# KeepAlive: Whether or not to allow persistent connections (more than
# one request per connection). Set to "Off" to deactivate.
#
KeepAlive On

#
# MaxKeepAliveRequests: The maximum number of requests to allow
# during a persistent connection. Set to 0 to allow an unlimited amount.
# We recommend you leave this number high, for maximum performance.
#
MaxKeepAliveRequests 100

#
# KeepAliveTimeout: Number of seconds to wait for the next request from the
# same client on the same connection.
#
KeepAliveTimeout 15

#
# Apache on Win32 always creates one child process to handle requests.  If it
# dies, another child process is created automatically.  Within the child
# process multiple threads handle incoming requests.  The next two
# directives control the behaviour of the threads and processes.
#

#
# MaxRequestsPerChild: the number of requests each child process is
# allowed to process before the child dies.  The child will exit so
# as to avoid problems after prolonged use when Apache (and maybe the
# libraries it uses) leak memory or other resources.  On most systems, this
# isn't really needed, but a few (such as Solaris) do have notable leaks
# in the libraries.  For Win32, set this value to zero (unlimited)
# unless advised otherwise.
#
# NOTE: This value does not include keepalive requests after the initial
#       request per connection. For example, if a child process handles
#       an initial request and 10 subsequent "keptalive" requests, it
#       would only count as 1 request towards this limit.
#
MaxRequestsPerChild 0

#
# Number of concurrent threads (i.e., requests) the server will allow.
# Set this value according to the responsiveness of the server (more
# requests active at once means they're all handled more slowly) and
# the amount of system resources you'll allow the server to consume.
#
ThreadsPerChild 50

#
# Listen: Allows you to bind Apache to specific IP addresses and/or
# ports, in addition to the default. See also the <VirtualHost>
# directive.
#
#Listen 3000
#Listen 12.34.56.78:80

#
# BindAddress: You can support virtual hosts with this option. This directive
# is used to tell the server which IP address to listen to. It can either
# contain "*", an IP address, or a fully qualified Internet domain name.
# See also the <VirtualHost> and Listen directives.
#
#BindAddress *

#
# Apache Modules compiled into the standard Windows build
#
# The following modules are bound into the standard Apache binary distribution
# for Windows.  To change the standard behavior, uncomment the following lines
# and modify the list of those specific modules to be enabled in the server.
#
# WARNING: This is an advanced option that may render your server inoperable!
# Do not use these directives without expert guidance.
#
#ClearModuleList
#AddModule mod_so.c mod_mime.c mod_access.c mod_auth.c mod_negotiation.c
#AddModule mod_include.c mod_autoindex.c mod_dir.c mod_cgi.c mod_userdir.c
#AddModule mod_alias.c mod_env.c mod_log_config.c mod_asis.c mod_imap.c
#AddModule mod_actions.c mod_setenvif.c mod_isapi.c

#
# Dynamic Shared Object (DSO) Support
#
# To be able to use the functionality of a module which was built as a DSO you
# have to place corresponding `LoadModule' lines at this location so the
# directives contained in it are actually available _before_ they are used.
# Please read the file README.DSO in the Apache 1.3 distribution for more
# details about the DSO mechanism and run `apache -l' for the list of already
# built-in (statically linked and thus always available) modules in your Apache
# binary.
#
# Note: The order in which modules are loaded is important.  Don't change
# the order below without expert advice.
#
#LoadModule anon_auth_module modules/mod_auth_anon.so
#LoadModule dbm_auth_module modules/mod_auth_dbm.so
#LoadModule digest_auth_module modules/mod_auth_digest.so
#LoadModule cern_meta_module modules/mod_cern_meta.so
#LoadModule digest_module modules/mod_digest.so
#LoadModule expires_module modules/mod_expires.so
#LoadModule headers_module modules/mod_headers.so
#LoadModule proxy_module modules/mod_proxy.so
#LoadModule rewrite_module modules/mod_rewrite.so
#LoadModule speling_module modules/mod_speling.so
#LoadModule info_module modules/mod_info.so
#LoadModule status_module modules/mod_status.so
#LoadModule usertrack_module modules/mod_usertrack.so
LoadModule python_module modules/mod_python.dll

#
# ExtendedStatus controls whether Apache will generate "full" status
# information (ExtendedStatus On) or just basic information (ExtendedStatus
# Off) when the "server-status" handler is called. The default is Off.
#
#ExtendedStatus On

### Section 2: 'Main' server configuration
#
# The directives in this section set up the values used by the 'main'
# server, which responds to any requests that aren't handled by a
# <VirtualHost> definition.  These values also provide defaults for
# any <VirtualHost> containers you may define later in the file.
#
# All of these directives may appear inside <VirtualHost> containers,
# in which case these default settings will be overridden for the
# virtual host being defined.
#

#
# Port: The port to which the standalone server listens.  Certain firewall
# products must be configured before Apache can listen to a specific port.
# Other running httpd servers will also interfere with this port.  Disable
# all firewall, security, and other services if you encounter problems.
# To help diagnose problems use the Windows NT command NETSTAT -a
#
Port 80

#
# ServerAdmin: Your address, where problems with the server should be
# e-mailed.  This address appears on some server-generated pages, such
# as error documents.
#
ServerAdmin pdeluca@sia.net.au

#
# ServerName allows you to set a host name which is sent back to clients for
# your server if it's different than the one the program would get (i.e., use
# "www" instead of the host's real name).
#
# Note: You cannot just invent host names and hope they work. The name you
# define here must be a valid DNS name for your host. If you don't understand
# this, ask your network administrator.
# If your host doesn't have a registered DNS name, enter its IP address here.
# You will have to access it by its address (e.g., http://123.45.67.89/)
# anyway, and this will make redirections work in a sensible way.
#
# 127.0.0.1 is the TCP/IP local loop-back address, often named localhost. Your
# machine always knows itself by this address. If you use Apache strictly for
# local testing and development, you may use 127.0.0.1 as the server name.
#
ServerName localhost


#
# DocumentRoot: The directory out of which you will serve your
# documents. By default, all requests are taken from this directory, but
# symbolic links and aliases may be used to point to other locations.
#
DocumentRoot "C:/data/apache/htdocs"

#
# Each directory to which Apache has access, can be configured with respect
# to which services and features are allowed and/or disabled in that
# directory (and its subdirectories).
#
# First, we configure the "default" to be a very restrictive set of
# permissions.
#
<Directory />
     Options FollowSymLinks
     AllowOverride None
</Directory>

#
# Note that from this point forward you must specifically allow
# particular features to be enabled - so if something's not working as
# you might expect, make sure that you have specifically enabled it
# below.
#

#
# This should be changed to whatever you set DocumentRoot to.
#
<Directory "C:/data/apache/htdocs">

#
# This may also be "None", "All", or any combination of "Indexes",
# "Includes", "FollowSymLinks", "ExecCGI", or "MultiViews".
#
# Note that "MultiViews" must be named *explicitly* --- "Options All"
# doesn't give it to you.
#
     Options Indexes FollowSymLinks MultiViews

#
# This controls which options the .htaccess files in directories can
# override. Can also be "All", or any combination of "Options", "FileInfo",
# "AuthConfig", and "Limit"
#
     AllowOverride None

#
# Controls who can get stuff from this server.
#
     Order allow,deny
     Allow from all
</Directory>

#
# UserDir: The name of the directory which is appended onto a user's home
# directory if a ~user request is received.
#
# Under Win32, we do not currently try to determine the home directory of
# a Windows login, so a format such as that below needs to be used.  See
# the UserDir documentation for details.
#
<IfModule mod_userdir.c>
     UserDir "C:/data/apache/users/"
</IfModule>

#
# Control access to UserDir directories.  The following is an example
# for a site where these directories are restricted to read-only.
#
#<Directory "C:/data/apache/users">
#    AllowOverride FileInfo AuthConfig Limit
#    Options MultiViews Indexes SymLinksIfOwnerMatch IncludesNoExec
#    <Limit GET POST OPTIONS PROPFIND>
#        Order allow,deny
#        Allow from all
#    </Limit>
#    <LimitExcept GET POST OPTIONS PROPFIND>
#        Order deny,allow
#        Deny from all
#    </LimitExcept>
#</Directory>

#
# DirectoryIndex: Name of the file or files to use as a pre-written HTML
# directory index.  Separate multiple entries with spaces.
#
<IfModule mod_dir.c>
     DirectoryIndex index.html
</IfModule>

#
# AccessFileName: The name of the file to look for in each directory
# for access control information.
#
AccessFileName .htaccess

#
# The following lines prevent .htaccess files from being viewed by
# Web clients.  Since .htaccess files often contain authorization
# information, access is disallowed for security reasons.  Comment
# these lines out if you want Web visitors to see the contents of
# .htaccess files.  If you change the AccessFileName directive above,
# be sure to make the corresponding changes here.
#
# Also, folks tend to use names such as .htpasswd for password
# files, so this will protect those as well.
#
<Files ~ "^\.ht">
     Order allow,deny
     Deny from all
</Files>

#
# CacheNegotiatedDocs: By default, Apache sends "Pragma: no-cache" with each
# document that was negotiated on the basis of content. This asks proxy
# servers not to cache the document. Uncommenting the following line disables
# this behavior, and proxies will be allowed to cache the documents.
#
#CacheNegotiatedDocs

#
# UseCanonicalName:  (new for 1.3)  With this setting turned on, whenever
# Apache needs to construct a self-referencing URL (a URL that refers back
# to the server the response is coming from) it will use ServerName and
# Port to form a "canonical" name.  With this setting off, Apache will
# use the hostname:port that the client supplied, when possible.  This
# also affects SERVER_NAME and SERVER_PORT in CGI scripts.
#
UseCanonicalName On

#
# TypesConfig describes where the mime.types file (or equivalent) is
# to be found.
#
<IfModule mod_mime.c>
     TypesConfig conf/mime.types
</IfModule>

#
# DefaultType is the default MIME type the server will use for a document
# if it cannot otherwise determine one, such as from filename extensions.
# If your server contains mostly text or HTML documents, "text/plain" is
# a good value.  If most of your content is binary, such as applications
# or images, you may want to use "application/octet-stream" instead to
# keep browsers from trying to display binary files as though they are
# text.
#
DefaultType text/plain

#
# The mod_mime_magic module allows the server to use various hints from the
# contents of the file itself to determine its type.  The MIMEMagicFile
# directive tells the module where the hint definitions are located.
# mod_mime_magic is not part of the default server (you have to add
# it yourself with a LoadModule [see the DSO paragraph in the 'Global
# Environment' section], or recompile the server and include mod_mime_magic
# as part of the configuration), so it's enclosed in an <IfModule> container.
# This means that the MIMEMagicFile directive will only be processed if the
# module is part of the server.
#
<IfModule mod_mime_magic.c>
     MIMEMagicFile conf/magic
</IfModule>

#
# HostnameLookups: Log the names of clients or just their IP addresses
# e.g., www.apache.org (on) or 204.62.129.132 (off).
# The default is off because it'd be overall better for the net if people
# had to knowingly turn this feature on, since enabling it means that
# each client request will result in AT LEAST one lookup request to the
# nameserver.
#
HostnameLookups Off

#
# ErrorLog: The location of the error log file.
# If you do not specify an ErrorLog directive within a <VirtualHost>
# container, error messages relating to that virtual host will be
# logged here.  If you *do* define an error logfile for a <VirtualHost>
# container, that host's errors will be logged there and not here.
#
ErrorLog logs/error.log

#
# LogLevel: Control the number of messages logged to the error.log.
# Possible values include: debug, info, notice, warn, error, crit,
# alert, emerg.
#
LogLevel warn

#
# The following directives define some format nicknames for use with
# a CustomLog directive (see below).
#
LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\"" 
combined
LogFormat "%h %l %u %t \"%r\" %>s %b" common
LogFormat "%{Referer}i -> %U" referer
LogFormat "%{User-agent}i" agent

#
# The location and format of the access logfile (Common Logfile Format).
# If you do not define any access logfiles within a <VirtualHost>
# container, they will be logged here.  Contrariwise, if you *do*
# define per-<VirtualHost> access logfiles, transactions will be
# logged therein and *not* in this file.
#
CustomLog logs/access.log common

#
# If you would like to have agent and referer logfiles, uncomment the
# following directives.
#
#CustomLog logs/referer.log referer
#CustomLog logs/agent.log agent

#
# If you prefer a single logfile with access, agent, and referer information
# (Combined Logfile Format) you can use the following directive.
#
#CustomLog logs/access.log combined

#
# Optionally add a line containing the server version and virtual host
# name to server-generated pages (error documents, FTP directory listings,
# mod_status and mod_info output etc., but not CGI generated documents).
# Set to "EMail" to also include a mailto: link to the ServerAdmin.
# Set to one of:  On | Off | EMail
#
ServerSignature On

#
# Apache parses all CGI scripts for the shebang line by default.
# This comment line, the first line of the script, consists of the symbols
# pound (#) and exclamation (!) followed by the path of the program that
# can execute this specific script.  For a perl script, with perl.exe in
# the C:\Program Files\Perl directory, the shebang line should be:

    #!c:/program files/perl/perl

# Note you _must_not_ indent the actual shebang line, and it must be the
# first line of the file.  Of course, CGI processing must be enabled by
# the appropriate ScriptAlias or Options ExecCGI directives for the files
# or directory in question.
#
# However, Apache on Windows allows either the Unix behavior above, or can
# use the Registry to match files by extention.  The command to execute
# a file of this type is retrieved from the registry by the same method as
# the Windows Explorer would use to handle double-clicking on a file.
# These script actions can be configured from the Windows Explorer View menu,
# 'Folder Options', and reviewing the 'File Types' tab.  Clicking the Edit
# button allows you to modify the Actions, of which Apache 1.3 attempts to
# perform the 'Open' Action, and failing that it will try the shebang line.
# This behavior is subject to change in Apache release 2.0.
#
# Each mechanism has it's own specific security weaknesses, from the means
# to run a program you didn't intend the website owner to invoke, and the
# best method is a matter of great debate.
#
# To enable the this Windows specific behavior (and therefore -disable- the
# equivilant Unix behavior), uncomment the following directive:
#
#ScriptInterpreterSource registry
#
# The directive above can be placed in individual <Directory> blocks or the
# .htaccess file, with either the 'registry' (Windows behavior) or 'script'
# (Unix behavior) option, and will override this server default option.
#

#
# Aliases: Add here as many aliases as you need (with no limit). The format is
# Alias fakename realname
#
<IfModule mod_alias.c>

     #
     # Note that if you include a trailing / on fakename then the server will
     # require it to be present in the URL.  So "/icons" isn't aliased in this
     # example, only "/icons/"..
     #
     Alias /icons/ "C:/data/apache/icons/"

     <Directory "C:/data/apache/icons">
         Options Indexes MultiViews
         AllowOverride None
         Order allow,deny
         Allow from all
     </Directory>

     #
     # ScriptAlias: This controls which directories contain server scripts.
     # ScriptAliases are essentially the same as Aliases, except that
     # documents in the realname directory are treated as applications and
     # run by the server when requested rather than as documents sent to 
the client.
     # The same rules about trailing "/" apply to ScriptAlias directives as to
     # Alias.
     #
     ScriptAlias /cgi-bin/ "C:/data/apache/cgi-bin/"

     #
     # "C:/data/apache/cgi-bin" should be changed to whatever your 
ScriptAliased
     # CGI directory exists, if you have that configured.
     #
     <Directory "C:/data/apache/cgi-bin">
         AllowOverride None
         Options None
         Order allow,deny
         Allow from all
     </Directory>

     <Directory "c:/data/apache/htdocs/python">
     	AddHandler python-program .py
     	PythonHandler test
     	PythonDebug on
     </Directory>

</IfModule>
# End of aliases.

#
# Redirect allows you to tell clients about documents which used to exist in
# your server's namespace, but do not anymore. This allows you to tell the
# clients where to look for the relocated document.
# Format: Redirect old-URI new-URL
#

#
# Directives controlling the display of server-generated directory listings.
#
<IfModule mod_autoindex.c>

     #
     # FancyIndexing is whether you want fancy directory indexing or standard
     #
     # Note, add the option TrackModified to the IndexOptions default list only
     # if all indexed directories reside on NTFS volumes.  The 
TrackModified flag
     # will report the Last-Modified date to assist caches and proxies to 
properly
     # track directory changes, but it does _not_ work on FAT volumes.
     #
     IndexOptions FancyIndexing

     #
     # AddIcon* directives tell the server which icon to show for different
     # files or filename extensions.  These are only displayed for
     # FancyIndexed directories.
     #
     AddIconByEncoding (CMP,/icons/compressed.gif) x-compress x-gzip

     AddIconByType (TXT,/icons/text.gif) text/*
     AddIconByType (IMG,/icons/image2.gif) image/*
     AddIconByType (SND,/icons/sound2.gif) audio/*
     AddIconByType (VID,/icons/movie.gif) video/*

     AddIcon /icons/binary.gif .bin .exe
     AddIcon /icons/binhex.gif .hqx
     AddIcon /icons/tar.gif .tar
     AddIcon /icons/world2.gif .wrl .wrl.gz .vrml .vrm .iv
     AddIcon /icons/compressed.gif .Z .z .tgz .gz .zip
     AddIcon /icons/a.gif .ps .ai .eps
     AddIcon /icons/layout.gif .html .shtml .htm .pdf
     AddIcon /icons/text.gif .txt
     AddIcon /icons/c.gif .c
     AddIcon /icons/p.gif .pl .py
     AddIcon /icons/f.gif .for
     AddIcon /icons/dvi.gif .dvi
     AddIcon /icons/uuencoded.gif .uu
     AddIcon /icons/script.gif .conf .sh .shar .csh .ksh .tcl
     AddIcon /icons/tex.gif .tex
     AddIcon /icons/bomb.gif core

     AddIcon /icons/back.gif ..
     AddIcon /icons/hand.right.gif README
     AddIcon /icons/folder.gif ^^DIRECTORY^^
     AddIcon /icons/blank.gif ^^BLANKICON^^

     #
     # DefaultIcon is which icon to show for files which do not have an icon
     # explicitly set.
     #
     DefaultIcon /icons/unknown.gif

     #
     # AddDescription allows you to place a short description after a file in
     # server-generated indexes.  These are only displayed for FancyIndexed
     # directories.
     # Format: AddDescription "description" filename
     #
     #AddDescription "GZIP compressed document" .gz
     #AddDescription "tar archive" .tar
     #AddDescription "GZIP compressed tar archive" .tgz

     #
     # ReadmeName is the name of the README file the server will look for by
     # default, and append to directory listings.
     #
     # HeaderName is the name of a file which should be prepended to
     # directory indexes.
     #
     # If MultiViews are amongst the Options in effect, the server will
     # first look for name.html and include it if found.  If name.html
     # doesn't exist, the server will then look for name.txt and include
     # it as plaintext if found.
     #
     ReadmeName README
     HeaderName HEADER

     #
     # IndexIgnore is a set of filenames which directory indexing should ignore
     # and not include in the listing.  Shell-style wildcarding is permitted.
     #
     IndexIgnore .??* *~ *# HEADER* README* RCS CVS *,v *,t

</IfModule>
# End of indexing directives.

#
# Document types.
#
<IfModule mod_mime.c>

     #
     # AddEncoding allows you to have certain browsers (Mosaic/X 2.1+) 
uncompress
     # information on the fly. Note: Not all browsers support this.
     # Despite the name similarity, the following Add* directives have nothing
     # to do with the FancyIndexing customization directives above.
     #
     AddEncoding x-compress Z
     AddEncoding x-gzip gz tgz
     #
     # AddLanguage allows you to specify the language of a document. You can
     # then use content negotiation to give a browser a file in a language
     # it can understand.
     #
     # Note 1: The suffix does not have to be the same as the language
     # keyword --- those with documents in Polish (whose net-standard
     # language code is pl) may wish to use "AddLanguage pl .po" to
     # avoid the ambiguity with the common suffix for perl scripts.
     #
     # Note 2: The example entries below illustrate that in quite
     # some cases the two character 'Language' abbreviation is not
     # identical to the two character 'Country' code for its country,
     # E.g. 'Danmark/dk' versus 'Danish/da'.
     #
     # Note 3: In the case of 'ltz' we violate the RFC by using a three char
     # specifier. But there is 'work in progress' to fix this and get
     # the reference data for rfc1766 cleaned up.
     #
     # Danish (da) - Dutch (nl) - English (en) - Estonian (ee)
     # French (fr) - German (de) - Greek-Modern (el)
     # Italian (it) - Korean (kr) - Norwegian (no)
     # Portugese (pt) - Luxembourgeois* (ltz)
     # Spanish (es) - Swedish (sv) - Catalan (ca) - Czech(cz)
     # Polish (pl) - Brazilian Portuguese (pt-br) - Japanese (ja)
     # Russian (ru)
     #
     AddLanguage da .dk
     AddLanguage nl .nl
     AddLanguage en .en
     AddLanguage et .ee
     AddLanguage fr .fr
     AddLanguage de .de
     AddLanguage el .el
     AddLanguage he .he
     AddCharset ISO-8859-8 .iso8859-8
     AddLanguage it .it
     AddLanguage ja .ja
     AddCharset ISO-2022-JP .jis
     AddLanguage kr .kr
     AddCharset ISO-2022-KR .iso-kr
     AddLanguage no .no
     AddLanguage pl .po
     AddCharset ISO-8859-2 .iso-pl
     AddLanguage pt .pt
     AddLanguage pt-br .pt-br
     AddLanguage ltz .lu
     AddLanguage ca .ca
     AddLanguage es .es
     AddLanguage sv .se
     AddLanguage cz .cz
     AddLanguage ru .ru
     AddLanguage tw .tw
     AddLanguage zh-tw .tw
     AddCharset Big5         .Big5    .big5
     AddCharset WINDOWS-1251 .cp-1251
     AddCharset CP866        .cp866
     AddCharset ISO-8859-5   .iso-ru
     AddCharset KOI8-R       .koi8-r
     AddCharset UCS-2        .ucs2
     AddCharset UCS-4        .ucs4
     AddCharset UTF-8        .utf8

     # LanguagePriority allows you to give precedence to some languages
     # in case of a tie during content negotiation.
     #
     # Just list the languages in decreasing order of preference. We have
     # more or less alphabetized them here. You probably want to change this.
     #
     <IfModule mod_negotiation.c>
         LanguagePriority en da nl et fr de el it ja kr no pl pt pt-br ru 
ltz ca es sv tw
     </IfModule>

     #
     # AddType allows you to tweak mime.types without actually editing it, 
or to
     # make certain files to be certain types.
     #
     # For example, the PHP 3.x module (not part of the Apache distribution 
- see
     # http://www.php.net) will typically use:
     #
     #AddType application/x-httpd-php3 .php3
     #AddType application/x-httpd-php3-source .phps
     #
     # And for PHP 4.x, use:
     #
     #AddType application/x-httpd-php .php
     #AddType application/x-httpd-php-source .phps

     AddType application/x-tar .tgz

     #
     # AddHandler allows you to map certain file extensions to "handlers",
     # actions unrelated to filetype. These can be either built into the server
     # or added with the Action command (see below)
     #
     # If you want to use server side includes, or CGI outside
     # ScriptAliased directories, uncomment the following lines.
     #
     # To use CGI scripts:
     #
     #AddHandler cgi-script .cgi

     #
     # To use server-parsed HTML files
     #
     #AddType text/html .shtml
     #AddHandler server-parsed .shtml

     #
     # Uncomment the following line to enable Apache's send-asis HTTP file
     # feature
     #
     #AddHandler send-as-is asis

     #
     # If you wish to use server-parsed imagemap files, use
     #
     #AddHandler imap-file map

     #
     # To enable type maps, you might want to use
     #
     #AddHandler type-map var

</IfModule>
# End of document types.

#
# Action lets you define media types that will execute a script whenever
# a matching file is called. This eliminates the need for repeated URL
# pathnames for oft-used CGI file processors.
# Format: Action media/type /cgi-script/location
# Format: Action handler-name /cgi-script/location
#

#
# MetaDir: specifies the name of the directory in which Apache can find
# meta information files. These files contain additional HTTP headers
# to include when sending the document
#
#MetaDir .web

#
# MetaSuffix: specifies the file name suffix for the file containing the
# meta information.
#
#MetaSuffix .meta

#
# Customizable error response (Apache style)
#  these come in three flavors
#
#    1) plain text
#ErrorDocument 500 "The server made a boo boo.
#  n.b.  the single leading (") marks it as text, it does not get output
#
#    2) local redirects
#ErrorDocument 404 /missing.html
#  to redirect to local URL /missing.html
#ErrorDocument 404 /cgi-bin/missing_handler.pl
#  N.B.: You can redirect to a script or a document using server-side-includes.
#
#    3) external redirects
#ErrorDocument 402 http://some.other_server.com/subscription_info.html
#  N.B.: Many of the environment variables associated with the original
#  request will *not* be available to such a script.

#
# Customize behaviour based on the browser
#
<IfModule mod_setenvif.c>

     #
     # The following directives modify normal HTTP response behavior.
     # The first directive disables keepalive for Netscape 2.x and browsers 
that
     # spoof it. There are known problems with these browser implementations.
     # The second directive is for Microsoft Internet Explorer 4.0b2
     # which has a broken HTTP/1.1 implementation and does not properly
     # support keepalive when it is used on 301 or 302 (redirect) responses.
     #
     BrowserMatch "Mozilla/2" nokeepalive
     BrowserMatch "MSIE 4\.0b2;" nokeepalive downgrade-1.0 force-response-1.0

     #
     # The following directive disables HTTP/1.1 responses to browsers which
     # are in violation of the HTTP/1.0 spec by not being able to grok a
     # basic 1.1 response.
     #
     BrowserMatch "RealPlayer 4\.0" force-response-1.0
     BrowserMatch "Java/1\.0" force-response-1.0
     BrowserMatch "JDK/1\.0" force-response-1.0

</IfModule>
# End of browser customization directives

#
# Allow server status reports, with the URL of http://servername/server-status
# Change the ".localhost" to match your domain to enable.
#
#<Location /server-status>
#    SetHandler server-status
#    Order deny,allow
#    Deny from all
#    Allow from .localhost
#</Location>

#
# Allow remote server configuration reports, with the URL of
# http://servername/server-info (requires that mod_info.c be loaded).
# Change the ".localhost" to match your domain to enable.
#
#<Location /server-info>
#    SetHandler server-info
#    Order deny,allow
#    Deny from all
#    Allow from .localhost
#</Location>

#
# There have been reports of people trying to abuse an old bug from pre-1.1
# days.  This bug involved a CGI script distributed as a part of Apache.
# By uncommenting these lines you can redirect these attacks to a logging
# script on phf.apache.org.  Or, you can record them yourself, using the script
# support/phf_abuse_log.cgi.
#
#<Location /cgi-bin/phf*>
#    Deny from all
#    ErrorDocument 403 http://phf.apache.org/phf_abuse_log.cgi
#</Location>

#
# Proxy Server directives. Uncomment the following lines to
# enable the proxy server:
#
#<IfModule mod_proxy.c>
#    ProxyRequests On

#    <Directory proxy:*>
#        Order deny,allow
#        Deny from all
#        Allow from .localhost
#    </Directory>

     #
     # Enable/disable the handling of HTTP/1.1 "Via:" headers.
     # ("Full" adds the server version; "Block" removes all outgoing Via: 
headers)
     # Set to one of: Off | On | Full | Block
     #
#    ProxyVia On

     #
     # To enable the cache as well, edit and uncomment the following lines:
     # (no cacheing without CacheRoot)
     #
#    CacheRoot "C:/data/apache/proxy"
#    CacheSize 5
#    CacheGcInterval 4
#    CacheMaxExpire 24
#    CacheLastModifiedFactor 0.1
#    CacheDefaultExpire 1
#    NoCache a_domain.com another_domain.edu joes.garage_sale.com

#</IfModule>
# End of proxy directives.

### Section 3: Virtual Hosts
#
# VirtualHost: If you want to maintain multiple domains/hostnames on your
# machine you can setup VirtualHost containers for them. Most configurations
# use only name-based virtual hosts so the server doesn't need to worry about
# IP addresses. This is indicated by the asterisks in the directives below.
#
# Please see the documentation at <URL:http://www.apache.org/docs/vhosts/>
# for further details before you try to setup virtual hosts.
#
# You may use the command line option '-S' to verify your virtual host
# configuration.

#
# Use name-based virtual hosting.
#
#NameVirtualHost *

#
# VirtualHost example:
# Almost any Apache directive may go into a VirtualHost container.
# The first VirtualHost section is used for requests without a known
# server name.
#
#<VirtualHost *>
#    ServerAdmin webmaster@dummy-host.example.com
#    DocumentRoot /www/docs/dummy-host.example.com
#    ServerName dummy-host.example.com
#    ErrorLog logs/dummy-host.example.com-error_log
#    CustomLog logs/dummy-host.example.com-access_log common
#</VirtualHost>



Apologies for the size of this email, I just need to get this problem 
sorted ASAP. Any help will be greatly appreciated.








-------------------------------------------
Paul De Luca
Email: pdeluca@sia.net.au
Ph: 0414 225561
-------------------------------------------


From grisha at modpython.org  Thu May 24 09:44:54 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:58:55 2004
Subject: [mod_python] mod python apache problem
In-Reply-To: <4.3.2.7.2.20010524211137.00acd710@mail.sia.net.au>
Message-ID: <Pine.BSF.4.32.0105240943370.30008-100000@localhost>

Most likely this is because the DLL, which was compiled for Windows NT
will not work on ME, because ME doesn't have some libraries that NT has.
But I'm not a Windows expert, this is just a guess.

Grisha

On Thu, 24 May 2001, Paul De Luca wrote:

> Hi,
>       I am having some troubles trying to install mod_python onto my home
> PC running Windows ME (hey, its for testing purposes!). I followed the
> directions in the mod python documentation (changing the path when
> necessary). However when I try and start Apache I get the following error:
>
> Syntax error on line 203 of c:/data/apache/conf/httpd.conf:
> Cannot load c:/data/apache/modules/mod_python.dll into server: (1157) One
> of the
> library files needed to run this application cannot be found:
>
> I think this might have made a mistake at this step of the installation:
>  >Move the files in the folder lib inside the mod_python folder (C:\Program
>  >Files\Python\lib\mod_python-x\lib\mod_python) to the C:\Program
>  >Files\Python\lib\mod_python folder. It's safe to delete these folders we
> just emptied.
> but am unsure, as I am using a newer version of python and Apache than
> mentioned in the mod python documentation.
>
> My Setup
> Python 2.1  (C:\data\python2.1)
> Apache 1.3.19 (C:\data\apache, root dir c:\data\apache\htdocs)
> mod_python library files (C:\data\python2.1\Lib\mod_python)
> mod_python.dll (C:\data\apache\modules\mod_python.dll)
>
> My Apache httpd.conf
>
>
> #
> # Based upon the NCSA server configuration files originally by Rob McCool.
> #
> # This is the main Apache server configuration file.  It contains the
> # configuration directives that give the server its instructions.
> # See <URL:http://www.apache.org/docs/> for detailed information about
> # the directives.
> #
> # Do NOT simply read the instructions in here without understanding
> # what they do.  They're here only as hints or reminders.  If you are unsure
> # consult the online docs. You have been warned.
> #
> # After this file is processed, the server will look for and process
> # C:/data/apache/conf/srm.conf and then C:/data/apache/conf/access.conf
> # unless you have overridden these with ResourceConfig and/or
> # AccessConfig directives here.
> #
> # The configuration directives are grouped into three basic sections:
> #  1. Directives that control the operation of the Apache server process as a
> #     whole (the 'global environment').
> #  2. Directives that define the parameters of the 'main' or 'default' server,
> #     which responds to requests that aren't handled by a virtual host.
> #     These directives also provide default values for the settings
> #     of all virtual hosts.
> #  3. Settings for virtual hosts, which allow Web requests to be sent to
> #     different IP addresses or hostnames and have them handled by the
> #     same Apache server process.
> #
> # Configuration and logfile names: If the filenames you specify for many
> # of the server's control files begin with "/" (or "drive:/" for Win32), the
> # server will use that explicit path.  If the filenames do *not* begin
> # with "/", the value of ServerRoot is prepended -- so "logs/foo.log"
> # with ServerRoot set to "/usr/local/apache" will be interpreted by the
> # server as "/usr/local/apache/logs/foo.log".
> #
> # NOTE: Where filenames are specified, you must use forward slashes
> # instead of backslashes (e.g., "c:/apache" instead of "c:\apache").
> # If a drive letter is omitted, the drive on which Apache.exe is located
> # will be used by default.  It is recommended that you always supply
> # an explicit drive letter in absolute paths, however, to avoid
> # confusion.
> #
>
> ### Section 1: Global Environment
> #
> # The directives in this section affect the overall operation of Apache,
> # such as the number of concurrent requests it can handle or where it
> # can find its configuration files.
> #
>
> #
> # ServerType is either inetd, or standalone.  Inetd mode is only supported on
> # Unix platforms.
> #
> ServerType standalone
>
> #
> # ServerRoot: The top of the directory tree under which the server's
> # configuration, error, and log files are kept.
> #
> ServerRoot "C:/data/apache"
>
> #
> # PidFile: The file in which the server should record its process
> # identification number when it starts.
> #
> PidFile logs/httpd.pid
>
> #
> # ScoreBoardFile: File used to store internal server process information.
> # Not all architectures require this.  But if yours does (you'll know because
> # this file will be  created when you run Apache) then you *must* ensure that
> # no two invocations of Apache share the same scoreboard file.
> #
> ScoreBoardFile logs/apache_runtime_status
>
> #
> # In the standard configuration, the server will process httpd.conf (this
> # file, specified by the -f command line option), srm.conf, and access.conf
> # in that order.  The latter two files are now distributed empty, as it is
> # recommended that all directives be kept in a single file for simplicity.
> # The commented-out values below are the built-in defaults.  You can have the
> # server ignore these files altogether by using "/dev/null" (for Unix) or
> # "nul" (for Win32) for the arguments to the directives.
> #
> #ResourceConfig conf/srm.conf
> #AccessConfig conf/access.conf
>
> #
> # Timeout: The number of seconds before receives and sends time out.
> #
> Timeout 300
>
> #
> # KeepAlive: Whether or not to allow persistent connections (more than
> # one request per connection). Set to "Off" to deactivate.
> #
> KeepAlive On
>
> #
> # MaxKeepAliveRequests: The maximum number of requests to allow
> # during a persistent connection. Set to 0 to allow an unlimited amount.
> # We recommend you leave this number high, for maximum performance.
> #
> MaxKeepAliveRequests 100
>
> #
> # KeepAliveTimeout: Number of seconds to wait for the next request from the
> # same client on the same connection.
> #
> KeepAliveTimeout 15
>
> #
> # Apache on Win32 always creates one child process to handle requests.  If it
> # dies, another child process is created automatically.  Within the child
> # process multiple threads handle incoming requests.  The next two
> # directives control the behaviour of the threads and processes.
> #
>
> #
> # MaxRequestsPerChild: the number of requests each child process is
> # allowed to process before the child dies.  The child will exit so
> # as to avoid problems after prolonged use when Apache (and maybe the
> # libraries it uses) leak memory or other resources.  On most systems, this
> # isn't really needed, but a few (such as Solaris) do have notable leaks
> # in the libraries.  For Win32, set this value to zero (unlimited)
> # unless advised otherwise.
> #
> # NOTE: This value does not include keepalive requests after the initial
> #       request per connection. For example, if a child process handles
> #       an initial request and 10 subsequent "keptalive" requests, it
> #       would only count as 1 request towards this limit.
> #
> MaxRequestsPerChild 0
>
> #
> # Number of concurrent threads (i.e., requests) the server will allow.
> # Set this value according to the responsiveness of the server (more
> # requests active at once means they're all handled more slowly) and
> # the amount of system resources you'll allow the server to consume.
> #
> ThreadsPerChild 50
>
> #
> # Listen: Allows you to bind Apache to specific IP addresses and/or
> # ports, in addition to the default. See also the <VirtualHost>
> # directive.
> #
> #Listen 3000
> #Listen 12.34.56.78:80
>
> #
> # BindAddress: You can support virtual hosts with this option. This directive
> # is used to tell the server which IP address to listen to. It can either
> # contain "*", an IP address, or a fully qualified Internet domain name.
> # See also the <VirtualHost> and Listen directives.
> #
> #BindAddress *
>
> #
> # Apache Modules compiled into the standard Windows build
> #
> # The following modules are bound into the standard Apache binary distribution
> # for Windows.  To change the standard behavior, uncomment the following lines
> # and modify the list of those specific modules to be enabled in the server.
> #
> # WARNING: This is an advanced option that may render your server inoperable!
> # Do not use these directives without expert guidance.
> #
> #ClearModuleList
> #AddModule mod_so.c mod_mime.c mod_access.c mod_auth.c mod_negotiation.c
> #AddModule mod_include.c mod_autoindex.c mod_dir.c mod_cgi.c mod_userdir.c
> #AddModule mod_alias.c mod_env.c mod_log_config.c mod_asis.c mod_imap.c
> #AddModule mod_actions.c mod_setenvif.c mod_isapi.c
>
> #
> # Dynamic Shared Object (DSO) Support
> #
> # To be able to use the functionality of a module which was built as a DSO you
> # have to place corresponding `LoadModule' lines at this location so the
> # directives contained in it are actually available _before_ they are used.
> # Please read the file README.DSO in the Apache 1.3 distribution for more
> # details about the DSO mechanism and run `apache -l' for the list of already
> # built-in (statically linked and thus always available) modules in your Apache
> # binary.
> #
> # Note: The order in which modules are loaded is important.  Don't change
> # the order below without expert advice.
> #
> #LoadModule anon_auth_module modules/mod_auth_anon.so
> #LoadModule dbm_auth_module modules/mod_auth_dbm.so
> #LoadModule digest_auth_module modules/mod_auth_digest.so
> #LoadModule cern_meta_module modules/mod_cern_meta.so
> #LoadModule digest_module modules/mod_digest.so
> #LoadModule expires_module modules/mod_expires.so
> #LoadModule headers_module modules/mod_headers.so
> #LoadModule proxy_module modules/mod_proxy.so
> #LoadModule rewrite_module modules/mod_rewrite.so
> #LoadModule speling_module modules/mod_speling.so
> #LoadModule info_module modules/mod_info.so
> #LoadModule status_module modules/mod_status.so
> #LoadModule usertrack_module modules/mod_usertrack.so
> LoadModule python_module modules/mod_python.dll
>
> #
> # ExtendedStatus controls whether Apache will generate "full" status
> # information (ExtendedStatus On) or just basic information (ExtendedStatus
> # Off) when the "server-status" handler is called. The default is Off.
> #
> #ExtendedStatus On
>
> ### Section 2: 'Main' server configuration
> #
> # The directives in this section set up the values used by the 'main'
> # server, which responds to any requests that aren't handled by a
> # <VirtualHost> definition.  These values also provide defaults for
> # any <VirtualHost> containers you may define later in the file.
> #
> # All of these directives may appear inside <VirtualHost> containers,
> # in which case these default settings will be overridden for the
> # virtual host being defined.
> #
>
> #
> # Port: The port to which the standalone server listens.  Certain firewall
> # products must be configured before Apache can listen to a specific port.
> # Other running httpd servers will also interfere with this port.  Disable
> # all firewall, security, and other services if you encounter problems.
> # To help diagnose problems use the Windows NT command NETSTAT -a
> #
> Port 80
>
> #
> # ServerAdmin: Your address, where problems with the server should be
> # e-mailed.  This address appears on some server-generated pages, such
> # as error documents.
> #
> ServerAdmin pdeluca@sia.net.au
>
> #
> # ServerName allows you to set a host name which is sent back to clients for
> # your server if it's different than the one the program would get (i.e., use
> # "www" instead of the host's real name).
> #
> # Note: You cannot just invent host names and hope they work. The name you
> # define here must be a valid DNS name for your host. If you don't understand
> # this, ask your network administrator.
> # If your host doesn't have a registered DNS name, enter its IP address here.
> # You will have to access it by its address (e.g., http://123.45.67.89/)
> # anyway, and this will make redirections work in a sensible way.
> #
> # 127.0.0.1 is the TCP/IP local loop-back address, often named localhost. Your
> # machine always knows itself by this address. If you use Apache strictly for
> # local testing and development, you may use 127.0.0.1 as the server name.
> #
> ServerName localhost
>
>
> #
> # DocumentRoot: The directory out of which you will serve your
> # documents. By default, all requests are taken from this directory, but
> # symbolic links and aliases may be used to point to other locations.
> #
> DocumentRoot "C:/data/apache/htdocs"
>
> #
> # Each directory to which Apache has access, can be configured with respect
> # to which services and features are allowed and/or disabled in that
> # directory (and its subdirectories).
> #
> # First, we configure the "default" to be a very restrictive set of
> # permissions.
> #
> <Directory />
>      Options FollowSymLinks
>      AllowOverride None
> </Directory>
>
> #
> # Note that from this point forward you must specifically allow
> # particular features to be enabled - so if something's not working as
> # you might expect, make sure that you have specifically enabled it
> # below.
> #
>
> #
> # This should be changed to whatever you set DocumentRoot to.
> #
> <Directory "C:/data/apache/htdocs">
>
> #
> # This may also be "None", "All", or any combination of "Indexes",
> # "Includes", "FollowSymLinks", "ExecCGI", or "MultiViews".
> #
> # Note that "MultiViews" must be named *explicitly* --- "Options All"
> # doesn't give it to you.
> #
>      Options Indexes FollowSymLinks MultiViews
>
> #
> # This controls which options the .htaccess files in directories can
> # override. Can also be "All", or any combination of "Options", "FileInfo",
> # "AuthConfig", and "Limit"
> #
>      AllowOverride None
>
> #
> # Controls who can get stuff from this server.
> #
>      Order allow,deny
>      Allow from all
> </Directory>
>
> #
> # UserDir: The name of the directory which is appended onto a user's home
> # directory if a ~user request is received.
> #
> # Under Win32, we do not currently try to determine the home directory of
> # a Windows login, so a format such as that below needs to be used.  See
> # the UserDir documentation for details.
> #
> <IfModule mod_userdir.c>
>      UserDir "C:/data/apache/users/"
> </IfModule>
>
> #
> # Control access to UserDir directories.  The following is an example
> # for a site where these directories are restricted to read-only.
> #
> #<Directory "C:/data/apache/users">
> #    AllowOverride FileInfo AuthConfig Limit
> #    Options MultiViews Indexes SymLinksIfOwnerMatch IncludesNoExec
> #    <Limit GET POST OPTIONS PROPFIND>
> #        Order allow,deny
> #        Allow from all
> #    </Limit>
> #    <LimitExcept GET POST OPTIONS PROPFIND>
> #        Order deny,allow
> #        Deny from all
> #    </LimitExcept>
> #</Directory>
>
> #
> # DirectoryIndex: Name of the file or files to use as a pre-written HTML
> # directory index.  Separate multiple entries with spaces.
> #
> <IfModule mod_dir.c>
>      DirectoryIndex index.html
> </IfModule>
>
> #
> # AccessFileName: The name of the file to look for in each directory
> # for access control information.
> #
> AccessFileName .htaccess
>
> #
> # The following lines prevent .htaccess files from being viewed by
> # Web clients.  Since .htaccess files often contain authorization
> # information, access is disallowed for security reasons.  Comment
> # these lines out if you want Web visitors to see the contents of
> # .htaccess files.  If you change the AccessFileName directive above,
> # be sure to make the corresponding changes here.
> #
> # Also, folks tend to use names such as .htpasswd for password
> # files, so this will protect those as well.
> #
> <Files ~ "^\.ht">
>      Order allow,deny
>      Deny from all
> </Files>
>
> #
> # CacheNegotiatedDocs: By default, Apache sends "Pragma: no-cache" with each
> # document that was negotiated on the basis of content. This asks proxy
> # servers not to cache the document. Uncommenting the following line disables
> # this behavior, and proxies will be allowed to cache the documents.
> #
> #CacheNegotiatedDocs
>
> #
> # UseCanonicalName:  (new for 1.3)  With this setting turned on, whenever
> # Apache needs to construct a self-referencing URL (a URL that refers back
> # to the server the response is coming from) it will use ServerName and
> # Port to form a "canonical" name.  With this setting off, Apache will
> # use the hostname:port that the client supplied, when possible.  This
> # also affects SERVER_NAME and SERVER_PORT in CGI scripts.
> #
> UseCanonicalName On
>
> #
> # TypesConfig describes where the mime.types file (or equivalent) is
> # to be found.
> #
> <IfModule mod_mime.c>
>      TypesConfig conf/mime.types
> </IfModule>
>
> #
> # DefaultType is the default MIME type the server will use for a document
> # if it cannot otherwise determine one, such as from filename extensions.
> # If your server contains mostly text or HTML documents, "text/plain" is
> # a good value.  If most of your content is binary, such as applications
> # or images, you may want to use "application/octet-stream" instead to
> # keep browsers from trying to display binary files as though they are
> # text.
> #
> DefaultType text/plain
>
> #
> # The mod_mime_magic module allows the server to use various hints from the
> # contents of the file itself to determine its type.  The MIMEMagicFile
> # directive tells the module where the hint definitions are located.
> # mod_mime_magic is not part of the default server (you have to add
> # it yourself with a LoadModule [see the DSO paragraph in the 'Global
> # Environment' section], or recompile the server and include mod_mime_magic
> # as part of the configuration), so it's enclosed in an <IfModule> container.
> # This means that the MIMEMagicFile directive will only be processed if the
> # module is part of the server.
> #
> <IfModule mod_mime_magic.c>
>      MIMEMagicFile conf/magic
> </IfModule>
>
> #
> # HostnameLookups: Log the names of clients or just their IP addresses
> # e.g., www.apache.org (on) or 204.62.129.132 (off).
> # The default is off because it'd be overall better for the net if people
> # had to knowingly turn this feature on, since enabling it means that
> # each client request will result in AT LEAST one lookup request to the
> # nameserver.
> #
> HostnameLookups Off
>
> #
> # ErrorLog: The location of the error log file.
> # If you do not specify an ErrorLog directive within a <VirtualHost>
> # container, error messages relating to that virtual host will be
> # logged here.  If you *do* define an error logfile for a <VirtualHost>
> # container, that host's errors will be logged there and not here.
> #
> ErrorLog logs/error.log
>
> #
> # LogLevel: Control the number of messages logged to the error.log.
> # Possible values include: debug, info, notice, warn, error, crit,
> # alert, emerg.
> #
> LogLevel warn
>
> #
> # The following directives define some format nicknames for use with
> # a CustomLog directive (see below).
> #
> LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\""
> combined
> LogFormat "%h %l %u %t \"%r\" %>s %b" common
> LogFormat "%{Referer}i -> %U" referer
> LogFormat "%{User-agent}i" agent
>
> #
> # The location and format of the access logfile (Common Logfile Format).
> # If you do not define any access logfiles within a <VirtualHost>
> # container, they will be logged here.  Contrariwise, if you *do*
> # define per-<VirtualHost> access logfiles, transactions will be
> # logged therein and *not* in this file.
> #
> CustomLog logs/access.log common
>
> #
> # If you would like to have agent and referer logfiles, uncomment the
> # following directives.
> #
> #CustomLog logs/referer.log referer
> #CustomLog logs/agent.log agent
>
> #
> # If you prefer a single logfile with access, agent, and referer information
> # (Combined Logfile Format) you can use the following directive.
> #
> #CustomLog logs/access.log combined
>
> #
> # Optionally add a line containing the server version and virtual host
> # name to server-generated pages (error documents, FTP directory listings,
> # mod_status and mod_info output etc., but not CGI generated documents).
> # Set to "EMail" to also include a mailto: link to the ServerAdmin.
> # Set to one of:  On | Off | EMail
> #
> ServerSignature On
>
> #
> # Apache parses all CGI scripts for the shebang line by default.
> # This comment line, the first line of the script, consists of the symbols
> # pound (#) and exclamation (!) followed by the path of the program that
> # can execute this specific script.  For a perl script, with perl.exe in
> # the C:\Program Files\Perl directory, the shebang line should be:
>
>     #!c:/program files/perl/perl
>
> # Note you _must_not_ indent the actual shebang line, and it must be the
> # first line of the file.  Of course, CGI processing must be enabled by
> # the appropriate ScriptAlias or Options ExecCGI directives for the files
> # or directory in question.
> #
> # However, Apache on Windows allows either the Unix behavior above, or can
> # use the Registry to match files by extention.  The command to execute
> # a file of this type is retrieved from the registry by the same method as
> # the Windows Explorer would use to handle double-clicking on a file.
> # These script actions can be configured from the Windows Explorer View menu,
> # 'Folder Options', and reviewing the 'File Types' tab.  Clicking the Edit
> # button allows you to modify the Actions, of which Apache 1.3 attempts to
> # perform the 'Open' Action, and failing that it will try the shebang line.
> # This behavior is subject to change in Apache release 2.0.
> #
> # Each mechanism has it's own specific security weaknesses, from the means
> # to run a program you didn't intend the website owner to invoke, and the
> # best method is a matter of great debate.
> #
> # To enable the this Windows specific behavior (and therefore -disable- the
> # equivilant Unix behavior), uncomment the following directive:
> #
> #ScriptInterpreterSource registry
> #
> # The directive above can be placed in individual <Directory> blocks or the
> # .htaccess file, with either the 'registry' (Windows behavior) or 'script'
> # (Unix behavior) option, and will override this server default option.
> #
>
> #
> # Aliases: Add here as many aliases as you need (with no limit). The format is
> # Alias fakename realname
> #
> <IfModule mod_alias.c>
>
>      #
>      # Note that if you include a trailing / on fakename then the server will
>      # require it to be present in the URL.  So "/icons" isn't aliased in this
>      # example, only "/icons/"..
>      #
>      Alias /icons/ "C:/data/apache/icons/"
>
>      <Directory "C:/data/apache/icons">
>          Options Indexes MultiViews
>          AllowOverride None
>          Order allow,deny
>          Allow from all
>      </Directory>
>
>      #
>      # ScriptAlias: This controls which directories contain server scripts.
>      # ScriptAliases are essentially the same as Aliases, except that
>      # documents in the realname directory are treated as applications and
>      # run by the server when requested rather than as documents sent to
> the client.
>      # The same rules about trailing "/" apply to ScriptAlias directives as to
>      # Alias.
>      #
>      ScriptAlias /cgi-bin/ "C:/data/apache/cgi-bin/"
>
>      #
>      # "C:/data/apache/cgi-bin" should be changed to whatever your
> ScriptAliased
>      # CGI directory exists, if you have that configured.
>      #
>      <Directory "C:/data/apache/cgi-bin">
>          AllowOverride None
>          Options None
>          Order allow,deny
>          Allow from all
>      </Directory>
>
>      <Directory "c:/data/apache/htdocs/python">
>      	AddHandler python-program .py
>      	PythonHandler test
>      	PythonDebug on
>      </Directory>
>
> </IfModule>
> # End of aliases.
>
> #
> # Redirect allows you to tell clients about documents which used to exist in
> # your server's namespace, but do not anymore. This allows you to tell the
> # clients where to look for the relocated document.
> # Format: Redirect old-URI new-URL
> #
>
> #
> # Directives controlling the display of server-generated directory listings.
> #
> <IfModule mod_autoindex.c>
>
>      #
>      # FancyIndexing is whether you want fancy directory indexing or standard
>      #
>      # Note, add the option TrackModified to the IndexOptions default list only
>      # if all indexed directories reside on NTFS volumes.  The
> TrackModified flag
>      # will report the Last-Modified date to assist caches and proxies to
> properly
>      # track directory changes, but it does _not_ work on FAT volumes.
>      #
>      IndexOptions FancyIndexing
>
>      #
>      # AddIcon* directives tell the server which icon to show for different
>      # files or filename extensions.  These are only displayed for
>      # FancyIndexed directories.
>      #
>      AddIconByEncoding (CMP,/icons/compressed.gif) x-compress x-gzip
>
>      AddIconByType (TXT,/icons/text.gif) text/*
>      AddIconByType (IMG,/icons/image2.gif) image/*
>      AddIconByType (SND,/icons/sound2.gif) audio/*
>      AddIconByType (VID,/icons/movie.gif) video/*
>
>      AddIcon /icons/binary.gif .bin .exe
>      AddIcon /icons/binhex.gif .hqx
>      AddIcon /icons/tar.gif .tar
>      AddIcon /icons/world2.gif .wrl .wrl.gz .vrml .vrm .iv
>      AddIcon /icons/compressed.gif .Z .z .tgz .gz .zip
>      AddIcon /icons/a.gif .ps .ai .eps
>      AddIcon /icons/layout.gif .html .shtml .htm .pdf
>      AddIcon /icons/text.gif .txt
>      AddIcon /icons/c.gif .c
>      AddIcon /icons/p.gif .pl .py
>      AddIcon /icons/f.gif .for
>      AddIcon /icons/dvi.gif .dvi
>      AddIcon /icons/uuencoded.gif .uu
>      AddIcon /icons/script.gif .conf .sh .shar .csh .ksh .tcl
>      AddIcon /icons/tex.gif .tex
>      AddIcon /icons/bomb.gif core
>
>      AddIcon /icons/back.gif ..
>      AddIcon /icons/hand.right.gif README
>      AddIcon /icons/folder.gif ^^DIRECTORY^^
>      AddIcon /icons/blank.gif ^^BLANKICON^^
>
>      #
>      # DefaultIcon is which icon to show for files which do not have an icon
>      # explicitly set.
>      #
>      DefaultIcon /icons/unknown.gif
>
>      #
>      # AddDescription allows you to place a short description after a file in
>      # server-generated indexes.  These are only displayed for FancyIndexed
>      # directories.
>      # Format: AddDescription "description" filename
>      #
>      #AddDescription "GZIP compressed document" .gz
>      #AddDescription "tar archive" .tar
>      #AddDescription "GZIP compressed tar archive" .tgz
>
>      #
>      # ReadmeName is the name of the README file the server will look for by
>      # default, and append to directory listings.
>      #
>      # HeaderName is the name of a file which should be prepended to
>      # directory indexes.
>      #
>      # If MultiViews are amongst the Options in effect, the server will
>      # first look for name.html and include it if found.  If name.html
>      # doesn't exist, the server will then look for name.txt and include
>      # it as plaintext if found.
>      #
>      ReadmeName README
>      HeaderName HEADER
>
>      #
>      # IndexIgnore is a set of filenames which directory indexing should ignore
>      # and not include in the listing.  Shell-style wildcarding is permitted.
>      #
>      IndexIgnore .??* *~ *# HEADER* README* RCS CVS *,v *,t
>
> </IfModule>
> # End of indexing directives.
>
> #
> # Document types.
> #
> <IfModule mod_mime.c>
>
>      #
>      # AddEncoding allows you to have certain browsers (Mosaic/X 2.1+)
> uncompress
>      # information on the fly. Note: Not all browsers support this.
>      # Despite the name similarity, the following Add* directives have nothing
>      # to do with the FancyIndexing customization directives above.
>      #
>      AddEncoding x-compress Z
>      AddEncoding x-gzip gz tgz
>      #
>      # AddLanguage allows you to specify the language of a document. You can
>      # then use content negotiation to give a browser a file in a language
>      # it can understand.
>      #
>      # Note 1: The suffix does not have to be the same as the language
>      # keyword --- those with documents in Polish (whose net-standard
>      # language code is pl) may wish to use "AddLanguage pl .po" to
>      # avoid the ambiguity with the common suffix for perl scripts.
>      #
>      # Note 2: The example entries below illustrate that in quite
>      # some cases the two character 'Language' abbreviation is not
>      # identical to the two character 'Country' code for its country,
>      # E.g. 'Danmark/dk' versus 'Danish/da'.
>      #
>      # Note 3: In the case of 'ltz' we violate the RFC by using a three char
>      # specifier. But there is 'work in progress' to fix this and get
>      # the reference data for rfc1766 cleaned up.
>      #
>      # Danish (da) - Dutch (nl) - English (en) - Estonian (ee)
>      # French (fr) - German (de) - Greek-Modern (el)
>      # Italian (it) - Korean (kr) - Norwegian (no)
>      # Portugese (pt) - Luxembourgeois* (ltz)
>      # Spanish (es) - Swedish (sv) - Catalan (ca) - Czech(cz)
>      # Polish (pl) - Brazilian Portuguese (pt-br) - Japanese (ja)
>      # Russian (ru)
>      #
>      AddLanguage da .dk
>      AddLanguage nl .nl
>      AddLanguage en .en
>      AddLanguage et .ee
>      AddLanguage fr .fr
>      AddLanguage de .de
>      AddLanguage el .el
>      AddLanguage he .he
>      AddCharset ISO-8859-8 .iso8859-8
>      AddLanguage it .it
>      AddLanguage ja .ja
>      AddCharset ISO-2022-JP .jis
>      AddLanguage kr .kr
>      AddCharset ISO-2022-KR .iso-kr
>      AddLanguage no .no
>      AddLanguage pl .po
>      AddCharset ISO-8859-2 .iso-pl
>      AddLanguage pt .pt
>      AddLanguage pt-br .pt-br
>      AddLanguage ltz .lu
>      AddLanguage ca .ca
>      AddLanguage es .es
>      AddLanguage sv .se
>      AddLanguage cz .cz
>      AddLanguage ru .ru
>      AddLanguage tw .tw
>      AddLanguage zh-tw .tw
>      AddCharset Big5         .Big5    .big5
>      AddCharset WINDOWS-1251 .cp-1251
>      AddCharset CP866        .cp866
>      AddCharset ISO-8859-5   .iso-ru
>      AddCharset KOI8-R       .koi8-r
>      AddCharset UCS-2        .ucs2
>      AddCharset UCS-4        .ucs4
>      AddCharset UTF-8        .utf8
>
>      # LanguagePriority allows you to give precedence to some languages
>      # in case of a tie during content negotiation.
>      #
>      # Just list the languages in decreasing order of preference. We have
>      # more or less alphabetized them here. You probably want to change this.
>      #
>      <IfModule mod_negotiation.c>
>          LanguagePriority en da nl et fr de el it ja kr no pl pt pt-br ru
> ltz ca es sv tw
>      </IfModule>
>
>      #
>      # AddType allows you to tweak mime.types without actually editing it,
> or to
>      # make certain files to be certain types.
>      #
>      # For example, the PHP 3.x module (not part of the Apache distribution
> - see
>      # http://www.php.net) will typically use:
>      #
>      #AddType application/x-httpd-php3 .php3
>      #AddType application/x-httpd-php3-source .phps
>      #
>      # And for PHP 4.x, use:
>      #
>      #AddType application/x-httpd-php .php
>      #AddType application/x-httpd-php-source .phps
>
>      AddType application/x-tar .tgz
>
>      #
>      # AddHandler allows you to map certain file extensions to "handlers",
>      # actions unrelated to filetype. These can be either built into the server
>      # or added with the Action command (see below)
>      #
>      # If you want to use server side includes, or CGI outside
>      # ScriptAliased directories, uncomment the following lines.
>      #
>      # To use CGI scripts:
>      #
>      #AddHandler cgi-script .cgi
>
>      #
>      # To use server-parsed HTML files
>      #
>      #AddType text/html .shtml
>      #AddHandler server-parsed .shtml
>
>      #
>      # Uncomment the following line to enable Apache's send-asis HTTP file
>      # feature
>      #
>      #AddHandler send-as-is asis
>
>      #
>      # If you wish to use server-parsed imagemap files, use
>      #
>      #AddHandler imap-file map
>
>      #
>      # To enable type maps, you might want to use
>      #
>      #AddHandler type-map var
>
> </IfModule>
> # End of document types.
>
> #
> # Action lets you define media types that will execute a script whenever
> # a matching file is called. This eliminates the need for repeated URL
> # pathnames for oft-used CGI file processors.
> # Format: Action media/type /cgi-script/location
> # Format: Action handler-name /cgi-script/location
> #
>
> #
> # MetaDir: specifies the name of the directory in which Apache can find
> # meta information files. These files contain additional HTTP headers
> # to include when sending the document
> #
> #MetaDir .web
>
> #
> # MetaSuffix: specifies the file name suffix for the file containing the
> # meta information.
> #
> #MetaSuffix .meta
>
> #
> # Customizable error response (Apache style)
> #  these come in three flavors
> #
> #    1) plain text
> #ErrorDocument 500 "The server made a boo boo.
> #  n.b.  the single leading (") marks it as text, it does not get output
> #
> #    2) local redirects
> #ErrorDocument 404 /missing.html
> #  to redirect to local URL /missing.html
> #ErrorDocument 404 /cgi-bin/missing_handler.pl
> #  N.B.: You can redirect to a script or a document using server-side-includes.
> #
> #    3) external redirects
> #ErrorDocument 402 http://some.other_server.com/subscription_info.html
> #  N.B.: Many of the environment variables associated with the original
> #  request will *not* be available to such a script.
>
> #
> # Customize behaviour based on the browser
> #
> <IfModule mod_setenvif.c>
>
>      #
>      # The following directives modify normal HTTP response behavior.
>      # The first directive disables keepalive for Netscape 2.x and browsers
> that
>      # spoof it. There are known problems with these browser implementations.
>      # The second directive is for Microsoft Internet Explorer 4.0b2
>      # which has a broken HTTP/1.1 implementation and does not properly
>      # support keepalive when it is used on 301 or 302 (redirect) responses.
>      #
>      BrowserMatch "Mozilla/2" nokeepalive
>      BrowserMatch "MSIE 4\.0b2;" nokeepalive downgrade-1.0 force-response-1.0
>
>      #
>      # The following directive disables HTTP/1.1 responses to browsers which
>      # are in violation of the HTTP/1.0 spec by not being able to grok a
>      # basic 1.1 response.
>      #
>      BrowserMatch "RealPlayer 4\.0" force-response-1.0
>      BrowserMatch "Java/1\.0" force-response-1.0
>      BrowserMatch "JDK/1\.0" force-response-1.0
>
> </IfModule>
> # End of browser customization directives
>
> #
> # Allow server status reports, with the URL of http://servername/server-status
> # Change the ".localhost" to match your domain to enable.
> #
> #<Location /server-status>
> #    SetHandler server-status
> #    Order deny,allow
> #    Deny from all
> #    Allow from .localhost
> #</Location>
>
> #
> # Allow remote server configuration reports, with the URL of
> # http://servername/server-info (requires that mod_info.c be loaded).
> # Change the ".localhost" to match your domain to enable.
> #
> #<Location /server-info>
> #    SetHandler server-info
> #    Order deny,allow
> #    Deny from all
> #    Allow from .localhost
> #</Location>
>
> #
> # There have been reports of people trying to abuse an old bug from pre-1.1
> # days.  This bug involved a CGI script distributed as a part of Apache.
> # By uncommenting these lines you can redirect these attacks to a logging
> # script on phf.apache.org.  Or, you can record them yourself, using the script
> # support/phf_abuse_log.cgi.
> #
> #<Location /cgi-bin/phf*>
> #    Deny from all
> #    ErrorDocument 403 http://phf.apache.org/phf_abuse_log.cgi
> #</Location>
>
> #
> # Proxy Server directives. Uncomment the following lines to
> # enable the proxy server:
> #
> #<IfModule mod_proxy.c>
> #    ProxyRequests On
>
> #    <Directory proxy:*>
> #        Order deny,allow
> #        Deny from all
> #        Allow from .localhost
> #    </Directory>
>
>      #
>      # Enable/disable the handling of HTTP/1.1 "Via:" headers.
>      # ("Full" adds the server version; "Block" removes all outgoing Via:
> headers)
>      # Set to one of: Off | On | Full | Block
>      #
> #    ProxyVia On
>
>      #
>      # To enable the cache as well, edit and uncomment the following lines:
>      # (no cacheing without CacheRoot)
>      #
> #    CacheRoot "C:/data/apache/proxy"
> #    CacheSize 5
> #    CacheGcInterval 4
> #    CacheMaxExpire 24
> #    CacheLastModifiedFactor 0.1
> #    CacheDefaultExpire 1
> #    NoCache a_domain.com another_domain.edu joes.garage_sale.com
>
> #</IfModule>
> # End of proxy directives.
>
> ### Section 3: Virtual Hosts
> #
> # VirtualHost: If you want to maintain multiple domains/hostnames on your
> # machine you can setup VirtualHost containers for them. Most configurations
> # use only name-based virtual hosts so the server doesn't need to worry about
> # IP addresses. This is indicated by the asterisks in the directives below.
> #
> # Please see the documentation at <URL:http://www.apache.org/docs/vhosts/>
> # for further details before you try to setup virtual hosts.
> #
> # You may use the command line option '-S' to verify your virtual host
> # configuration.
>
> #
> # Use name-based virtual hosting.
> #
> #NameVirtualHost *
>
> #
> # VirtualHost example:
> # Almost any Apache directive may go into a VirtualHost container.
> # The first VirtualHost section is used for requests without a known
> # server name.
> #
> #<VirtualHost *>
> #    ServerAdmin webmaster@dummy-host.example.com
> #    DocumentRoot /www/docs/dummy-host.example.com
> #    ServerName dummy-host.example.com
> #    ErrorLog logs/dummy-host.example.com-error_log
> #    CustomLog logs/dummy-host.example.com-access_log common
> #</VirtualHost>
>
>
>
> Apologies for the size of this email, I just need to get this problem
> sorted ASAP. Any help will be greatly appreciated.
>
>
>
>
>
>
>
>
> -------------------------------------------
> Paul De Luca
> Email: pdeluca@sia.net.au
> Ph: 0414 225561
> -------------------------------------------
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From LinscombeJ at cmalliance.org  Thu May 24 09:02:11 2001
From: LinscombeJ at cmalliance.org (Linscombe, Jason)
Date: Fri Jan  9 21:58:55 2004
Subject: [mod_python] SuSE 7.1 RPM mod_python & apache
Message-ID: <CE1A83EC8461D311A81F0060B03C7CAAEF4FE0@mail1.cmalliance.org>

Hi List,

I'm trying to run mod_python over apache and could use some help setting
this up.  Here is my setup...

Apache-1.3.14-6
Python-2.0-6
mod_python-2.7.1-3
Distro: SuSE 7.1 Installed the above with RPM

Here is the python stuff in my httpd.conf
-----------------------------------------------------------------
<IfDefine PYTHON>
LoadModule python_module	/usr/lib/apache/mod_python.so
</IfDefine>

<IfDefine PYTHON>
AddModule mod_python.c
</IfDefine>

<Directory /usr/local/httpd/htdocs/test> 
  AddHandler python-program .py
  PythonHandler mptest 
  PythonDebug On 
</Directory>
-----------------------------------------------------------------


And I have this in a file called /usr/local/httpd/htdocs/test/mptest.py
-----------------------------------------------------------------
from mod_python import apache

def handler(req):
    req.send_http_header()
    req.write("Hello World!")
    return apache.OK
-----------------------------------------------------------------


I have checked all file permissions and everything seems to be OK.  All of
the above was either default in my httpd.conf or what I found in the
"Testing" page on the documentation.  The problem I'm having is with the
above, I try to start apache and I get the following error:

FAILED:  See /var/log/httpd/rcapache.log for details

here is the rcapache.log file...
-----------------------------------------------------------------
Syntax error on line 1634 of /etc/httpd/httpd.conf
Invalid command 'PythonHandler', perhaps mis-spelled or defined by a module
not included in the server configuration.
-----------------------------------------------------------------


Question:  is this mptest.py file necessary for running python scripts over
the web server or is this simply a test?  Being a python newbie, I don't
really know what to do next.  Thanks in advance for any help!

jason


From LinscombeJ at cmalliance.org  Thu May 24 12:20:23 2001
From: LinscombeJ at cmalliance.org (Linscombe, Jason)
Date: Fri Jan  9 21:58:55 2004
Subject: [mod_python] SuSE 7.1 RPM mod_python & apache
Message-ID: <CE1A83EC8461D311A81F0060B03C7CAAEF4FE4@mail1.cmalliance.org>

I tried to simplify things and took it out of the <IfDefine PYTHON> tags and
placed the LoadModule and AddModule lines in the normal place (along with
all the others.  But I'm getting the same error as before.  Does the
<Directory /some/directory/htdocs/test> need to be placed inside another set
of tags or can it simply be appended at the end of the file?  I have it as
the last 5 lines of my httpd.conf

jason



-----Original Message-----
From: Alain T?sio
Sent: Thursday, May 24, 2001 10:54 AM


Hi, I have the same setup without "<IfDefine PYTHON>" and it works ...

Alain



----- Original Message -----
From: "Linscombe, Jason" <LinscombeJ@cmalliance.org>
To: <mod_python@modpython.org>
Sent: Thursday, May 24, 2001 5:02 PM
Subject: [mod_python] SuSE 7.1 RPM mod_python & apache


>
> Hi List,
>
> I'm trying to run mod_python over apache and could use some help setting
> this up.  Here is my setup...
>
> Apache-1.3.14-6
> Python-2.0-6
> mod_python-2.7.1-3
> Distro: SuSE 7.1 Installed the above with RPM
>
> Here is the python stuff in my httpd.conf
> -----------------------------------------------------------------
> <IfDefine PYTHON>
> LoadModule python_module /usr/lib/apache/mod_python.so
> </IfDefine>
>
> <IfDefine PYTHON>
> AddModule mod_python.c
> </IfDefine>
>
> <Directory /usr/local/httpd/htdocs/test>
>   AddHandler python-program .py
>   PythonHandler mptest
>   PythonDebug On
> </Directory>
> -----------------------------------------------------------------
>
>
> And I have this in a file called /usr/local/httpd/htdocs/test/mptest.py
> -----------------------------------------------------------------
> from mod_python import apache
>
> def handler(req):
>     req.send_http_header()
>     req.write("Hello World!")
>     return apache.OK
> -----------------------------------------------------------------
>
>
> I have checked all file permissions and everything seems to be OK.  All of
> the above was either default in my httpd.conf or what I found in the
> "Testing" page on the documentation.  The problem I'm having is with the
> above, I try to start apache and I get the following error:
>
> FAILED:  See /var/log/httpd/rcapache.log for details
>
> here is the rcapache.log file...
> -----------------------------------------------------------------
> Syntax error on line 1634 of /etc/httpd/httpd.conf
> Invalid command 'PythonHandler', perhaps mis-spelled or defined by a
module
> not included in the server configuration.
> -----------------------------------------------------------------
>
>
> Question:  is this mptest.py file necessary for running python scripts
over
> the web server or is this simply a test?  Being a python newbie, I don't
> really know what to do next.  Thanks in advance for any help!
>
> jason
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

From meyer at diku.dk  Fri May 25 02:36:14 2001
From: meyer at diku.dk (Jonas Meyer Rasmussen)
Date: Fri Jan  9 21:58:56 2004
Subject: [mod_python] mod_python on win32
Message-ID: <OHENJJENEHAEEPAOJBHCOEDDCCAA.meyer@diku.dk>

Hi.
I am having alot of trouble getting mod_python to work...
(win32, Win2k Pro, Python 2.1)
apache just denies to load the module in, giving me this error:

Syntax error on line 206 of c:/progra..../httpd.conf:
Cannot load c:/.../apache/modules/mod_python.dll into server: (126) The
specified module could not be found:


I have done this:
added this to httpd.conf:

#placed after other uncommented LoadModules from std config file
LoadModule python_module modules/mod_python.dll


#placed in ifmodule mod_alias.c section
    <Directory "C:/Apache/cgi-bin">
        AddHandler python-program .py
        PythonHandler mptest
        PythonDebug on
    </Directory>



mod_python.dll is in the right place


made a small file in my apache/cgi-bin dir named mptest
which contains the following:

from mod_python import apache

def handler(req):
    req.content_type = "text/plain"
    req.send_http_header()
    req.write("Hello World!")
    return apache.OK


Jonas Meyer Rasmussen


From meyer at diku.dk  Fri May 25 13:03:55 2001
From: meyer at diku.dk (Jonas Meyer Rasmussen)
Date: Fri Jan  9 21:58:56 2004
Subject: [mod_python] mod_python on win32
In-Reply-To: <990766580.3b0de5f4623bb@webmail.uchicago.edu>
Message-ID: <Pine.LNX.4.21.0105251302310.11535-100000@dvalin.diku.dk>

On Thu, 24 May 2001, douglas savitsky wrote:
> 
> I recently upgraded from Python 2.0 to 2.1, and I notice that I am getting the 
> same error.  Perhaps if you go back to 2.0 and see if that works?

Yep that fixed the problem, thank you.

Now i just keep getting an internal server error when i try to load my
mptest.py, it says something about obcallback failed to init
?!?


Jonas Meyer Rasmussen
meyer@diku.dk



From rsalz at zolera.com  Fri May 25 09:41:44 2001
From: rsalz at zolera.com (Rich Salz)
Date: Fri Jan  9 21:58:56 2004
Subject: [mod_python] More file-like behavior
Message-ID: <3B0E6118.9BD61868@zolera.com>

The attached class provides a more complete implementation of Python's
file object.  We'd be quite pleased if it were accepted into the core.
:)
	/r$
-------------- next part --------------
#! /usr/bin/env python
##  ContentReader -- wrapper class for mod_python's request object that
##  provides a more complete set of file methods.
##  Copyright 2001, Zolera Systems, Inc.  All Rights Reserved.
##  This software is distributed under the terms of the mod_python license.
try:
    import xreadlines
except:
    pass

class ContentReader:
    '''A simple object that provides a minimal set of file methods from a
    mod_python request object.  Methods provided: read, readline, readlines,
    close, flush, and tell (and, if available, xreadlines).
    Attributes provided: closed, mode, and name.
    '''

    def __init__(self, req):
	'''req is the mod_python request handler.'''
	self.size = int(req.headers_in['content-length'])
	self.name = '<%s at 0x%x>' % (str(self.__class__), id(self))
	self.req, self.left, self.closed, self.mode = \
		req, self.size, 0, 'r'

    def read(self, size = 0):
	if self.closed: raise ValueError
	if self.left <= 0: return ''
	if size <= 0: size = self.left
	v = self.req.read(size)
	self.left = self.left - len(v)
	return v

    def readline(self, size = 0):
	v = self.req.readline(size)
	if len(v) > 1 and v[-2:] == '\r\n': v = v[:-2] + '\n'
	return v

    def readlines(self, sizehint = None):
	result = []
	while 1:
	    l = x.readline()
	    if l == '': break
	    result.append(l)
	    if sizehint != None:
		sizehint = sizehint - len(l)
		if sizehint <= 0: break
	return result

    def xreadlines(self):
	return xreadlines.xreadlines(self)

    def tell(self):
	return self.size - self.left

    def close(self):
	self.closed = 1

    def flush(self):
	pass
From paullb at bigfoot.com  Fri May 25 17:14:21 2001
From: paullb at bigfoot.com (Brendan Paull)
Date: Fri Jan  9 21:58:56 2004
Subject: [mod_python] Multiple versions on one machine
Message-ID: <5.0.2.1.2.20010525170709.00a0eec0@pop.minet.ca>

Hi,
	On my Red Hat 7.0 system I have two versions of python installed (1.5 and 
2.1) andt hey both work fine. They can be called by typing python1.5 and 
python2.1. I could not deinstall the RPM for 1.5 because there are many 
things that depended on it in my system. However, I have got my mod_python 
(v2.7) working and I can call scripts from inside the html directory 
(/var/www/html/python/ and HTML files for apache are in /var/www/html). 
However, mod_python sees only 1.5. How do I go about getting it to see the 
2.1 as well?

	Also, how would I go about getting python to work as a CGI interpreter, 
again preferably the 2.1 version. I already have perl5 working on the 
system? Is there a how-to somewhere?

I would appreciate any insight into either on of these questions,

Thank you in advance,

Brendan Paull


From grisha at modpython.org  Fri May 25 18:14:02 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:58:56 2004
Subject: [mod_python] Multiple versions on one machine
In-Reply-To: <5.0.2.1.2.20010525170709.00a0eec0@pop.minet.ca>
Message-ID: <Pine.BSF.4.32.0105251812480.47409-100000@localhost>

mod_python will most likely "see" the one that is invocable as "python"
during compilation. Do you have a python -> python1.5 symlink?

Grisha

On Fri, 25 May 2001, Brendan Paull wrote:

> Hi,
> 	On my Red Hat 7.0 system I have two versions of python installed (1.5 and
> 2.1) andt hey both work fine. They can be called by typing python1.5 and
> python2.1. I could not deinstall the RPM for 1.5 because there are many
> things that depended on it in my system. However, I have got my mod_python
> (v2.7) working and I can call scripts from inside the html directory
> (/var/www/html/python/ and HTML files for apache are in /var/www/html).
> However, mod_python sees only 1.5. How do I go about getting it to see the
> 2.1 as well?
>
> 	Also, how would I go about getting python to work as a CGI interpreter,
> again preferably the 2.1 version. I already have perl5 working on the
> system? Is there a how-to somewhere?
>
> I would appreciate any insight into either on of these questions,
>
> Thank you in advance,
>
> Brendan Paull
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From grisha at modpython.org  Sun May 27 00:52:37 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:58:56 2004
Subject: [mod_python] More file-like behavior
In-Reply-To: <3B0E6118.9BD61868@zolera.com>
Message-ID: <Pine.BSF.4.32.0105270050470.64009-100000@localhost>

Thanks Rich.

Can you elaborate a bit or give some example on how something like this
would be used? I.e. what advantage it would have over simply doing
req.write() or req.read()?

I'm just trying to get a better idea of how it would fit into mod_python.
:-)

Grisha

On Fri, 25 May 2001, Rich Salz wrote:

> The attached class provides a more complete implementation of Python's
> file object.  We'd be quite pleased if it were accepted into the core.
> :)
> 	/r$


From markb at well.com  Sun May 27 10:27:38 2001
From: markb at well.com (Mark Berry)
Date: Fri Jan  9 21:58:56 2004
Subject: [mod_python] Cookies, Redirects & Headers - Oh My!
Message-ID: <200105271028.DAA01579@smtp.well.com>

Hello List,

After spending almost 2 hours wrestling with the cookies and headers 
from the publisher,  I might suggest that we add a few simple examples 
into the standard documentation showing how to do very  basic but common 
operations.

Also, is there no reason that the publisher couldn't be extended at the 
core level to have something such as session management (using python 
pickling methods) for basic serialization, etc.  Is mod_python kept at 
grass-roots for a good reason? ;-)

I must say that with exceptions of a pool of example code, mod_python 
has been a pleasure to work with.  I would be happy to submit some 
example code to be put into the documentation if interested.

Cheers

.mark

From rsalz at zolera.com  Sun May 27 08:04:05 2001
From: rsalz at zolera.com (Rich Salz)
Date: Fri Jan  9 21:58:56 2004
Subject: [mod_python] More file-like behavior
References: <Pine.BSF.4.32.0105270050470.64009-100000@localhost>
Message-ID: <3B10ED35.CD0D36BC@zolera.com>

> Can you elaborate a bit or give some example on how something like this
> would be used? I.e. what advantage it would have over simply doing
> req.write() or req.read()?

It's a more complete implementation, so anyplace that wants a file
object can pass
	ContentReader(req)

Now, maybe most things just use req.read(), but we (at least) had some
code that wanted filename, etc.
	/r$

From deneb at unixwave.org  Sun May 27 22:12:38 2001
From: deneb at unixwave.org (Deneb)
Date: Fri Jan  9 21:58:56 2004
Subject: [mod_python] Template Class
Message-ID: <20010527221238.A3112@unixwave.org>

Hi,
all just yesterday i finished well a Template Class in order to use it
with modpython, higly ispired from PHPlib Template class, which is 
suitable for all purpose. Actually i use it in some of my projects.
A correct example on how it works, can be found in the PHPlib docs,
at phplib.netuse.de. 
I hope that you find this useful. The code is in the attach.
 
Cheers,
deneb.
 
-------------- next part --------------
#!/usr/bin/python
""" 
/*
 *  PyTemplate - a Simple Python Template Class
 *  Copyright (C) 2001 Giorgio Zoppi <deneb@unixwave.org>
 *
 *  This program is free software; you can redistribute it and/or modify
 *  it under the terms of the GNU General Public License as published by
 *  the Free Software Foundation; either version 2 of the License, or
 *  (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU General Public License for more details.
 *
 *  You should have received a copy of the GNU General Public License
 *  along with this program; if not, write to the Free Software
 *  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 */

This Template file was strictly ported form PHPLIB Template class.
Begin from the port:
28 May 2001

"""
import sys
import re
import os
import string

from stat import *
from types import *

class PyTemplate:
    """A simple Template class"""
    __classname='PyTemplate'
    """0 -> False, 1-> True"""
    __debug	=	1
    __root	=	os.getcwd();
    __unknowns    =       "remove"
    __file	= {}
    __varkeys     = {}
    __varvals     = {}
    __halt_on_error = "yes"
    __last_error    = ""
    
    def __init__(self,root,unknows="remove"):
        self.set_root(root)
	self.set_unknowns(unknows)
	
    def set_root(self,root):
	"""I check if the directory exists"""
	mode = os.stat(root)[ST_MODE]
	if S_ISDIR(mode):
	    """0 -> False, 1-> True"""
	    self.__root=root
	    return 1
	return 0
    def set_unknowns(self,unk):
	self.__unknowns=unk
    def set_file(self,handle,myfile=''):
        if not (type(handle) is DictType):
	    if (myfile==''):
		return 0
	    else:
		self.__file[handle]=self.__filename(myfile)
	else:
	    for (h,f) in handle.items():
		self.__file[h]=self.__filename(f)
		    
    def set_block(self,parent,handle,name=''):
	if not(self.__loadfile(parent)):
	    return 0
	if (name==''):
	    name=handle
	vstr=self.get_var(parent)
	str2 = ''
	for value in vstr:
	    str2 = str2 + value
	reg=r"<!--\s+BEGIN "+handle+"\s+-->(.*)<!--\s+END "+ handle+ "\s+-->"
	matchreg=re.compile(reg,re.S|re.M)
	m=matchreg.findall(str2)
	vname='{' + name + '}'
	vstr2=matchreg.sub(vname,str2)
	self.set_var(name,'')
	self.set_var(handle,m[0])
	self.set_var(parent,vstr2)
    
    def set_var(self,varname1,value=''):
	if not (type(varname1) is DictType):
	    self.__varkeys[varname1]=self.__varname(varname1)
	    self.__varvals[varname1]=value
	else:
	    for vname in varname1.keys():
		self.__varkeys[vname]=self.__varname(vname) 
		self.__varvals[vname]=varname1[vname]
		
	    
    def subst(self,handle):
	if not(self.__loadfile(handle)):
	    return 0
	
	vstr=self.get_var(handle)
	regstr = ''
	for values in vstr:
	    regstr= regstr + values
	vvals= self.__varvals.keys()
	kvals= self.__varkeys.keys()
	key1,key2='',''
	i,j=0,0
	len1,len2=len(vvals),len(kvals)
	while ((i<len1) and (j<len2)):
		key2 = vvals[i]
		key1 = kvals[j]
		vareg=re.compile(self.__varkeys[key1])
    		regstr=vareg.sub(self.__varvals[key2],regstr)
		i,j=i+1,j+1
	return regstr    
    def	psubst(self,handle):
	print self.subst(handle)
	return 0
    def tmpl2str(self,varname):
	return self.finish(self.get_var(varname))
    def parse(self,target,handle, append):
	if not (type(handle) is DictType):
    		vstr=self.subst(handle)
	        if (append==1):
		    mvar = self.get_var(target) + vstr
		    self.set_var(target,mvar)
		else:
		    self.set_var(target,vstr)
	else:	
		vstr = ''	
		for (hname,hvalue) in handle.items():
		    vstr=self.subst(hvalue)  
		    self.set_var(target,vstr)
	#print t.varvals	    
	return vstr
    def get_vars(self): 
	for kname in self.__varkeys.keys():
	    result[kname]=self.__varvals[kname]
	return result
    def get_var(self,varname):
        if not (type(varname) is DictType):
 	    return self.__varvals[varname]
	     
	else:
	    for vname in varname.keys():
		result[vname]=self.__varvals[vname]
	return result
    """def get_undefined --> not implemented"""	    
    def finish(self,vstr):
        regstr1=re.compile('{\[^}+}')
	if (self.__unknowns=="comment"):
	    regstr1.sub("<!--Template not defined -->",vstr)
	elif (self.__unknowns=="remove"):
	    regstr1.sub("",vstr);
	else:
	    self.__unknowns= "keep" """Nothing to do"""
	return vstr	    
    def p(self,varname):
	print self.finish(self.get_var(varname))
    def get(self,varname):
	return self.finish(self.get_var(varname))
    def __filename(self,filename):
	slice=string.find(filename,'/',0,1)
	if (slice==-1):
	    filename= self.__root + '/' + filename
	if not (os.path.isfile(filename)):
	    filename = 0
	return filename
    def __varname(self,varname1):
        var = '{' + varname1 + '}'
	return var
    def __loadfile(self,handle):
	try:
	    if ((self.__varkeys[handle]) and (not (self.__varvals[handle]==''))):
		    return 1
	except KeyError: 
	       new=1
	try:
	   name=self.__file[handle]
	except KeyError:
	    return 0
	filename= self.__filename(name)
	file=open(filename,'r')
	vstr=file.readlines()
	self.set_var(handle,vstr)
	return 1

 		    				        	    
From bl at netgroup.dk  Tue May 29 10:09:19 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:58:56 2004
Subject: [mod_python] Session data
Message-ID: <3B13592F.DB5633BB@netgroup.dk>

Hi ...

I have been trying to write a entry in the mod_python FAQ, but I'm a
quite inpatient person, so I'll ask here too :-)

I really like the way this mod_python thing works, but I have
desperately trying to find a way to store session based data, but
without luck.

Is there a way, or is it necessary to store the session data in a
separate data array, that is mapped to some kind of user Apache info ?
This could be a dumb question, as my knowledge about Apache is quite
limited, so I hope you will forgive if this should be quite obvious.


/BL


From grisha at modpython.org  Tue May 29 08:35:11 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:58:56 2004
Subject: [mod_python] Session data
In-Reply-To: <3B13592F.DB5633BB@netgroup.dk>
Message-ID: <Pine.BSF.4.32.0105290826550.99341-100000@localhost>

This does indeed seem to be a FAQ, but I don't know if there is a straight
answer to it.

In *my* opinion, trying to maintain state within the server is not
scalable and should be avoided. State should be maintained on the client
side with cookies and url's.

Since Apache 1.3 runs multiple processes, it is impossible to share memory
between them and therefore maintain state in the server.

But even with the new Apache 2.0 (which mod_python does not yet support),
which will be multithreaded, I would stay away from putting state on the
server. If I ever decided that my site is too busy and needs balancing
across multiple servers, I'd be in trouble... Also consider situations
when a request may never reach a server because of some cache inbewteen.

Grisha

On Tue, 29 May 2001, Bo Lorentsen wrote:

> Hi ...
>
> I have been trying to write a entry in the mod_python FAQ, but I'm a
> quite inpatient person, so I'll ask here too :-)
>
> I really like the way this mod_python thing works, but I have
> desperately trying to find a way to store session based data, but
> without luck.
>
> Is there a way, or is it necessary to store the session data in a
> separate data array, that is mapped to some kind of user Apache info ?
> This could be a dumb question, as my knowledge about Apache is quite
> limited, so I hope you will forgive if this should be quite obvious.
>
>
> /BL
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From bl at netgroup.dk  Tue May 29 14:50:28 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:58:56 2004
Subject: [mod_python] Session data
References: <Pine.BSF.4.32.0105290826550.99341-100000@localhost>
Message-ID: <3B139B14.26DF8717@netgroup.dk>

"Gregory (Grisha) Trubetskoy" wrote:

> In *my* opinion, trying to maintain state within the server is not
> scalable and should be avoided. State should be maintained on the client
> side with cookies and url's.

If this is so, shouldn't there be some sort of interface for this ? Or is
this something I should have known more about if I had known the Apache
server better ?

> Since Apache 1.3 runs multiple processes, it is impossible to share memory
> between them and therefore maintain state in the server.

Aha, so this is why the JavaServer make its own service, the Apache direct
requests to !

> But even with the new Apache 2.0 (which mod_python does not yet support),
> which will be multithreaded, I would stay away from putting state on the
> server. If I ever decided that my site is too busy and needs balancing
> across multiple servers, I'd be in trouble... Also consider situations
> when a request may never reach a server because of some cache inbewteen.

You absolutely got a point there.

I just need to gain knowledge about some other ways of maintaining session
data, as until now, I thought that a cookie were just a session reference
number of a kind.

/BL


From jvdev at 3va.net  Tue May 29 15:00:15 2001
From: jvdev at 3va.net (Jeroen van Drie)
Date: Fri Jan  9 21:58:56 2004
Subject: [mod_python] httpd dead but subsys locked
Message-ID: <01052915001503.01699@e109009>

situation:
mod_python, RH 6.2, MySQL-3.23.38-1 all RPM based.

When starting up httpd and running httpd status it returns:
httpd dead but subsys locked

No instance of httpd is found running.

When removing the two mod_python dso lines in the httpd.conf it starts up 
fine.

I have seen these errors on some php mailing lists as well where people seem 
to be relating it to the presence of mysql. There is nothign in the apache 
log file even at debug log level.

A restart of mysql did not help.

I have read that the situation in case of php will be resolved with a server 
reboot. However in this case that would be impractical.

Have any of you experienced this problem and have you found a solution?

Thanks.

From aiglauer at yahoo.com  Tue May 29 06:41:57 2001
From: aiglauer at yahoo.com (Alexis Iglauer)
Date: Fri Jan  9 21:58:56 2004
Subject: [mod_python] httpd dead but subsys locked
In-Reply-To: <01052915001503.01699@e109009>
Message-ID: <20010529134157.247.qmail@web13905.mail.yahoo.com>

My experience is under various versions of Mandrake and Apache 1.3.x.

That message usually comes if apache segfaults.  Check your /var/run
directory for httpd.pid and delete it.

Try running 'httpd -X' to see what error messages you get (often the
problem is threading support or not having the LoadModule line for
mod_python as the first LoadModule in httpd.conf).  My apache always
just crashed - with no debug info - when I loaded a .py file.

Once you have that sorted out (httpd -X runs fine), I find that
'/etc/rc.d/init.d/httpd restart' usually does the trick if you have the
'locked subsystem' error message on starting apache.

Hope this helps
ax

--- Jeroen van Drie <jvdev@3va.net> wrote:
> 
> situation:
> mod_python, RH 6.2, MySQL-3.23.38-1 all RPM based.
> 
> When starting up httpd and running httpd status it returns:
> httpd dead but subsys locked
> 
> No instance of httpd is found running.
> 
> When removing the two mod_python dso lines in the httpd.conf it
> starts up 
> fine.
> 
> I have seen these errors on some php mailing lists as well where
> people seem 
> to be relating it to the presence of mysql. There is nothign in the
> apache 
> log file even at debug log level.
> 
> A restart of mysql did not help.
> 
> I have read that the situation in case of php will be resolved with a
> server 
> reboot. However in this case that would be impractical.
> 
> Have any of you experienced this problem and have you found a
> solution?
> 
> Thanks.
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


__________________________________________________
Do You Yahoo!?
Yahoo! Auctions - buy the things you want at great prices
http://auctions.yahoo.com/

From sam at webslingerZ.com  Tue May 29 09:40:32 2001
From: sam at webslingerZ.com (Sam Brauer)
Date: Fri Jan  9 21:58:56 2004
Subject: [mod_python] Session data
In-Reply-To: <3B139B14.26DF8717@netgroup.dk>
Message-ID: <Pine.LNX.4.31.0105290917340.30341-100000@localhost.localdomain>

On Tue, 29 May 2001, Bo Lorentsen wrote:
<snip>
> I just need to gain knowledge about some other ways of maintaining session
> data, as until now, I thought that a cookie were just a session reference
> number of a kind.
>
> /BL

I think the most portable method (a method with the least
dependency on any particular webserver or application server) is to
maintain the session state in a relational database table and store the
table key value in a cookie.
When a user first hits your site, check for the cookie.
If it exists and matches a record in your table, then treat that record as
that user's session data.
Otherwise, insert a new record and set a session cookie with the key value
of the newly created record.

For applications where security is not a major concern, this method should
be sufficient.  If security is a major concern, you will want to avoid
storing the cookie value as plain text and instead encrypt it in some way.
Also, you may want to set a short expiration time for the cookie, and
perhaps reset it every time you send a response to the user.  You might
also (again, depending on the type of application) want to provide an
explicit logout function that unsets the cookie.
You could also have a field in your table that contains a timestamp that
gets updated every time a request for that session comes in.  Before
updating the field, you might compare its current value with the current
time.  If the difference is greater than some time limit (say 30 minutes),
then you could error out and respond to the user that their session has
expired.

How complicated and secure you want to make it is up to you.

Regards,
Sam Brauer



From jvdev at 3va.net  Tue May 29 16:48:31 2001
From: jvdev at 3va.net (Jeroen van Drie)
Date: Fri Jan  9 21:58:56 2004
Subject: [mod_python] httpd dead but subsys locked
In-Reply-To: <20010529134157.247.qmail@web13905.mail.yahoo.com>
References: <20010529134157.247.qmail@web13905.mail.yahoo.com>
Message-ID: <01052916483108.01699@e109009>

On Tuesday 29 May 2001 15:41 pm, you wrote:

Hi Ax,

When loading with -X i get the "
Loaded DSO modules/mod_python.so uses plain Apache 1.3 API, this module might 
crash under EAPI! (please recompile it with -DEAPI)" 
and it segfaults.

It's the first module defined in httpd.conf.

that hasn't been causing any problems on my 7.1 rh test system and from 
numerous reports I've read people generally seem to disregard the warning.

I got the sources,  edited the Makefile to run apxs with -DEAPI as an 
argument, which however caused the same error and segfault.

I would dearly like to see this issue resolved and if theres anything I can 
do to contribute towards solving it i'd be happy to contribute my time. 



> My experience is under various versions of Mandrake and Apache 1.3.x.
>
> That message usually comes if apache segfaults.  Check your /var/run
> directory for httpd.pid and delete it.
>
> Try running 'httpd -X' to see what error messages you get (often the
> problem is threading support or not having the LoadModule line for
> mod_python as the first LoadModule in httpd.conf).  My apache always
> just crashed - with no debug info - when I loaded a .py file.
>
> Once you have that sorted out (httpd -X runs fine), I find that
> '/etc/rc.d/init.d/httpd restart' usually does the trick if you have the
> 'locked subsystem' error message on starting apache.
>
> Hope this helps
> ax
>
> --- Jeroen van Drie <jvdev@3va.net> wrote:
> > situation:
> > mod_python, RH 6.2, MySQL-3.23.38-1 all RPM based.
> >
> > When starting up httpd and running httpd status it returns:
> > httpd dead but subsys locked
> >
> > No instance of httpd is found running.
> >
> > When removing the two mod_python dso lines in the httpd.conf it
> > starts up
> > fine.
> >
> > I have seen these errors on some php mailing lists as well where
> > people seem
> > to be relating it to the presence of mysql. There is nothign in the
> > apache
> > log file even at debug log level.
> >
> > A restart of mysql did not help.
> >
> > I have read that the situation in case of php will be resolved with a
> > server
> > reboot. However in this case that would be impractical.
> >
> > Have any of you experienced this problem and have you found a
> > solution?
> >
> > Thanks.
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://www.modpython.org/mailman/listinfo/mod_python
>
> __________________________________________________
> Do You Yahoo!?
> Yahoo! Auctions - buy the things you want at great prices
> http://auctions.yahoo.com/

From SumnerH at fool.com  Tue May 29 13:03:49 2001
From: SumnerH at fool.com (G . Sumner Hayes)
Date: Fri Jan  9 21:58:56 2004
Subject: [mod_python] Session data
In-Reply-To: <Pine.BSF.4.32.0105290826550.99341-100000@localhost>; from grisha@modpython.org on Tue, May 29, 2001 at 08:35:11AM -0400
References: <3B13592F.DB5633BB@netgroup.dk> <Pine.BSF.4.32.0105290826550.99341-100000@localhost>
Message-ID: <20010529130349.A17514@fool.com>

Gregory (Grisha) Trubetskoy <grisha@modpython.org> wrote:
> Since Apache 1.3 runs multiple processes, it is impossible to share memory
> between them and therefore maintain state in the server.

You can use either shared mmap or SysV shared mem (there are
python modules for both) to share memory.  I wound up writing
a Python shared dictionary (just pickles objects into the
filesystem when you set them, and unpickles them when you read
them) for my shared state, though I don't share user sessions--I
share things like parsed template files and other cacheable
server-side objects that require an expensive calculation the
first time they're read in.

Same idea would work for user sessions, and since it's in the
filesystem the kernel will take care of buffering for you and you
can use tools like "find" and "rm" to prune the cache. :-)

I agree with Grisha that you probably want to keep state on the
clients if you can, though.

  Sumner

-- 
rage, rage against the dying of the light

From CHagner at fool.com  Tue May 29 13:08:01 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:58:56 2004
Subject: [mod_python] Session data
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E47E7D@rover.foolhq.com>

In my experience, the quickest way to ensure that your web application
scales poorly is to mis-use server-side user sessions (thereby agreeing with
Grisha).  Now, that being said, not everyone needs this level of scalability
AND user sessions are a standard part of almost every-single web application
platform (ASP, Servlets/JSP, ColdFusion, etc.) commercially available.

BTW, I've found that most non-Apache-based web developers (of which I used
to be one :-) are completely ignorant of the realities of running in a
multi-process server.  They generally take for granted the user sessions
built into whatever app server they're using and find it mentally
challenging to truly believe they can live without such functionality.

I like the idea of having a standard interface to whatever mechanism is
responsible for persisting user session information, but I cringe at
incorporating an implementation with mod_python.  Basically, for some people
a pickled object will work fine.  For others a database-based session system
works best.  And some (Grisha) will only be happy with the use of
cookies/urls.

As for multiple-server user sessions, there are some solutions available in
the non-Python space (most of the ones that I've seen use either a database
(ugh :-) or a solution along the lines of Java's RMI to keep the session
pool's in sync.  In either case, it is a non-trivial problem/solution and is
best avoided (following the KISS principle).

You might want to check out WebWare (webware.sourceforge.net) as an expample
web framework that has some session support.  I think they pickle objects to
the file system.  There are some other python-based cgi frameworks that also
support user sessions, but just be aware of how far such solutions will/will
not take you.

Chris

-----Original Message-----
From: Bo Lorentsen [mailto:bl@netgroup.dk]
Sent: Tuesday, May 29, 2001 8:50 AM
To: Gregory (Grisha) Trubetskoy
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Session data


"Gregory (Grisha) Trubetskoy" wrote:

> In *my* opinion, trying to maintain state within the server is not
> scalable and should be avoided. State should be maintained on the client
> side with cookies and url's.

If this is so, shouldn't there be some sort of interface for this ? Or is
this something I should have known more about if I had known the Apache
server better ?

> Since Apache 1.3 runs multiple processes, it is impossible to share memory
> between them and therefore maintain state in the server.

Aha, so this is why the JavaServer make its own service, the Apache direct
requests to !

> But even with the new Apache 2.0 (which mod_python does not yet support),
> which will be multithreaded, I would stay away from putting state on the
> server. If I ever decided that my site is too busy and needs balancing
> across multiple servers, I'd be in trouble... Also consider situations
> when a request may never reach a server because of some cache inbewteen.

You absolutely got a point there.

I just need to gain knowledge about some other ways of maintaining session
data, as until now, I thought that a cookie were just a session reference
number of a kind.

/BL

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python

From gtalvola at nameconnector.com  Tue May 29 14:04:15 2001
From: gtalvola at nameconnector.com (Geoff Talvola)
Date: Fri Jan  9 21:58:56 2004
Subject: [mod_python] Win32 threading issue
Message-ID: <5.0.2.1.0.20010529134743.02ca2d30@infratest1>

I just wanted to confirm that I also get the same behavior on Windows -- if 
I stress out a simple script like the one below with multiple simultaneous 
requests, I get sporadic errors, just as Chris Trengove reported.

I'd be happy to help diagnose and fix the problem, but I know next to 
nothing about Apache and mod_python's internals.  I do have access to VC++ 
6.0 and I have successfully compiled the mod_python dll (for Python 2.1).

Where should I go from here?

>I have been testing the following script on Apache with mod_python (Apache
>1.13.17, mod_python 2.7.2, Windows 2000). I have been interested in testing
>the possible throughput of this (and more useful scripts), so I have
>another Python script which continually loads this "page".
>
>from mod_python import apache
>import thread
>
>def handler(req):
>     req.content_type = "text/plain"
>     req.send_http_header()
>     req.write("%d\n" % thread.get_ident())
>     return apache.OK
>
>When I run more than one copy of the driver script (in multiple consoles),
>I get behavior indicative of some threading problems. Specifically, some
>connections get "lost", the Apache error log reports various instances of
>"IOError: Write failed...", and I occassionally get an access violation
>inside Apache. Similarly, if I only run one copy of the driver script, and
>just keep hitting the refresh button in a browser, the browser
>occassionally returns TWO numbers, and sometimes reports an error in
>retrieving the data. Note that I have tested my driver program retrieving a
>simple text file, and everything works as expected, so it does not appear
>to be a problem with Apache. (The problem also goes away if I set
>ThreadPerChild to 1 in the Apache configuration.)
>
>I have also found that, if I comment out the req.write() statement in the
>handler, then there are no problems. From my examination of the
>implementation of the request object, I see that req_write() contains calls
>to Py_BEGIN_ALLOW_THREADS / Py_END_ALLOW_THREADS, whereas
>req_send_http_header() contains no such calls. This suggests to me that
>some thread switching is occurring inside req_write() which is messing with
>the state of the interpreter.
>
>I would be most grateful if anyone has any information to offer on this.
>
>Chris Trengove


--

- Geoff Talvola
   gtalvola@NameConnector.com

From trengove at econdata.com.au  Wed May 30 09:03:40 2001
From: trengove at econdata.com.au (Chris Trengove)
Date: Fri Jan  9 21:58:56 2004
Subject: [mod_python] Re: Win32 threading issue
In-Reply-To: <5.0.2.1.0.20010529134743.02ca2d30@infratest1>
Message-ID: <200105300905630.SM00248@athene>

Geoff,

This problem has now been fixed, and I expect will be part of mod_python
2.7.4 when Grisha decides to release that. In the mean time, if you have a
desperate need to avoid the threading problem, you can access the modified
files in the CVS.

Chris

At 02:04 PM 29/05/2001 -0400, Geoff Talvola wrote:
>I just wanted to confirm that I also get the same behavior on Windows -- if 
>I stress out a simple script like the one below with multiple simultaneous 
>requests, I get sporadic errors, just as Chris Trengove reported.
>
>I'd be happy to help diagnose and fix the problem, but I know next to 
>nothing about Apache and mod_python's internals.  I do have access to VC++ 
>6.0 and I have successfully compiled the mod_python dll (for Python 2.1).
>
>Where should I go from here?
>

>- Geoff Talvola
>   gtalvola@NameConnector.com
> 

From djc at object-craft.com.au  Wed May 30 10:23:48 2001
From: djc at object-craft.com.au (Dave Cole)
Date: Fri Jan  9 21:58:56 2004
Subject: [mod_python] Session data
In-Reply-To: "Gregory's message of "Tue, 29 May 2001 08:35:11 -0400 (EDT)"
References: <Pine.BSF.4.32.0105290826550.99341-100000@localhost>
Message-ID: <m3elt74rcb.fsf@vole.object-craft.com.au>

>>>>> "Gregory" == Gregory (Grisha) Trubetskoy <grisha@modpython.org> writes:

Gregory> This does indeed seem to be a FAQ, but I don't know if there
Gregory> is a straight answer to it.

Gregory> In *my* opinion, trying to maintain state within the server
Gregory> is not scalable and should be avoided. State should be
Gregory> maintained on the client side with cookies and url's.

Your choice of how to retain session state depends entirely on the
type of application you are building.

Gregory> Since Apache 1.3 runs multiple processes, it is impossible to
Gregory> share memory between them and therefore maintain state in the
Gregory> server.

That is not strictly true.  If you wish to retain state at the server,
you have to write some code.  You can either save state in some sort
of database (not necessarily relational) at the server, or you can
build a session server and cache connections to the server in your
mod_python program.

- Dave

-- 
http://www.object-craft.com.au


From gtalvola at nameconnector.com  Tue May 29 20:28:49 2001
From: gtalvola at nameconnector.com (Geoff Talvola)
Date: Fri Jan  9 21:58:56 2004
Subject: [mod_python] Re: Win32 threading issue
In-Reply-To: <200105300905630.SM00248@athene>
References: <5.0.2.1.0.20010529134743.02ca2d30@infratest1>
Message-ID: <5.0.2.1.0.20010529202540.034332c0@infratest1>

Great!  I love it when bugs have already been fixed.

Grisha, are you planning on releasing 2.7.4 any time soon?  If so, I'll 
just wait for it to be released.


At 09:03 AM 5/30/01 +1000, Chris Trengove wrote:
>Geoff,
>
>This problem has now been fixed, and I expect will be part of mod_python
>2.7.4 when Grisha decides to release that. In the mean time, if you have a
>desperate need to avoid the threading problem, you can access the modified
>files in the CVS.
>
>Chris
>
>At 02:04 PM 29/05/2001 -0400, Geoff Talvola wrote:
> >I just wanted to confirm that I also get the same behavior on Windows -- if
> >I stress out a simple script like the one below with multiple simultaneous
> >requests, I get sporadic errors, just as Chris Trengove reported.
> >
> >I'd be happy to help diagnose and fix the problem, but I know next to
> >nothing about Apache and mod_python's internals.  I do have access to VC++
> >6.0 and I have successfully compiled the mod_python dll (for Python 2.1).
> >
> >Where should I go from here?
> >
>
> >- Geoff Talvola
> >   gtalvola@NameConnector.com
> >

--

- Geoff Talvola
   gtalvola@NameConnector.com

From bl at netgroup.dk  Thu May 31 09:07:33 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:58:56 2004
Subject: [mod_python] Session data
References: <3B13592F.DB5633BB@netgroup.dk> <Pine.BSF.4.32.0105290826550.99341-100000@localhost> <20010529130349.A17514@fool.com>
Message-ID: <3B15EDB5.7E8D811B@netgroup.dk>

"G . Sumner Hayes" wrote:

> You can use either shared mmap or SysV shared mem (there are
> python modules for both) to share memory.  I wound up writing
> a Python shared dictionary (just pickles objects into the
> filesystem when you set them, and unpickles them when you read
> them) for my shared state, though I don't share user sessions--I
> share things like parsed template files and other cacheable
> server-side objects that require an expensive calculation the
> first time they're read in.

How about performance ? Is'nt it expensive accessing file in a dir. for shared
data, I mean, you have to reload it if its RW data, or is it write ones read
many (it sounds like it) ?

> Same idea would work for user sessions, and since it's in the
> filesystem the kernel will take care of buffering for you and you
> can use tools like "find" and "rm" to prune the cache. :-)

Hmm, If I like to change user session data offen, I quess I would go for the
"shared mem" solution.

> I agree with Grisha that you probably want to keep state on the
> clients if you can, though.

This is not possible, as  the state, in my case, is a lot of database keys, and
other internal information for navigating a database.

/BL


From bl at netgroup.dk  Thu May 31 09:26:49 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:58:56 2004
Subject: [mod_python] Session data
References: <Pine.BSF.4.32.0105290826550.99341-100000@localhost> <m3elt74rcb.fsf@vole.object-craft.com.au>
Message-ID: <3B15F239.F158F917@netgroup.dk>

Dave Cole wrote:

> Gregory> Since Apache 1.3 runs multiple processes, it is impossible to
> Gregory> share memory between them and therefore maintain state in the
> Gregory> server.
>
> That is not strictly true.  If you wish to retain state at the server,
> you have to write some code.  You can either save state in some sort
> of database (not necessarily relational) at the server, or you can
> build a session server and cache connections to the server in your
> mod_python program.

Anyway, this would be nice to have in the FAQ.

When I startet to look into mod_python, I did compare with JavaServer, and found
that this "session thing" were missing, and Gregory's comment about scalling
helped me undestand that the JavaServer solution were not always sufficient.

> http://www.object-craft.com.au

Ahh, yet another Rating expert :-)

/BL


From bl at netgroup.dk  Thu May 31 09:40:27 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:58:56 2004
Subject: [mod_python] Session data
References: <13CDDE6A53DBD311BC3200508B6F0C4805E47E7D@rover.foolhq.com>
Message-ID: <3B15F56B.67DF1D35@netgroup.dk>

Chris Hagner wrote:

> In my experience, the quickest way to ensure that your web application
> scales poorly is to mis-use server-side user sessions (thereby agreeing with
> Grisha).  Now, that being said, not everyone needs this level of scalability
> AND user sessions are a standard part of almost every-single web application
> platform (ASP, Servlets/JSP, ColdFusion, etc.) commercially available.

This is the danger of the JavaServer/PHP approach, not been aware of this.

> BTW, I've found that most non-Apache-based web developers (of which I used
> to be one :-) are completely ignorant of the realities of running in a
> multi-process server.  They generally take for granted the user sessions
> built into whatever app server they're using and find it mentally
> challenging to truly believe they can live without such functionality.

Again, the tools they are using gives them this impression, or at least support
there view of the world. And then we have the same problem with ex. ASP as we
have with RAD tools --- the level of insight and experience.

> As for multiple-server user sessions, there are some solutions available in
> the non-Python space (most of the ones that I've seen use either a database
> (ugh :-) or a solution along the lines of Java's RMI to keep the session
> pool's in sync.  In either case, it is a non-trivial problem/solution and is
> best avoided (following the KISS principle).

Or even a CORBA version to keep the real-time aspect :-)

> You might want to check out WebWare (webware.sourceforge.net) as an expample
> web framework that has some session support.  I think they pickle objects to
> the file system.  There are some other python-based cgi frameworks that also
> support user sessions, but just be aware of how far such solutions will/will
> not take you.

I would be nervous about the performance and the real-time aspect by using the
file system approach, but thanks for the advise, I will look into it.

/BL


From SumnerH at fool.com  Thu May 31 12:09:37 2001
From: SumnerH at fool.com (G . Sumner Hayes)
Date: Fri Jan  9 21:58:56 2004
Subject: [mod_python] Session data
In-Reply-To: <3B15EDB5.7E8D811B@netgroup.dk>; from bl@netgroup.dk on Thu, May 31, 2001 at 09:07:33AM +0200
References: <3B13592F.DB5633BB@netgroup.dk> <Pine.BSF.4.32.0105290826550.99341-100000@localhost> <20010529130349.A17514@fool.com> <3B15EDB5.7E8D811B@netgroup.dk>
Message-ID: <20010531120937.A24124@fool.com>

Bo Lorentsen <bl@netgroup.dk> wrote:
> > You can use either shared mmap or SysV shared mem (there are
> > python modules for both) to share memory.  I wound up writing
> > a Python shared dictionary (just pickles objects into the
> > filesystem when you set them, and unpickles them when you read
> > them)
> 
> How about performance ? Is'nt it expensive accessing file in a
> dir. for shared data, I mean, you have to reload it if its RW
> data, or is it write ones read many (it sounds like it) ?

I can write about 3000 entries to the dictionary per second.  I
can read about 8000 entries from the dictionary per second.  This
is with SMP-safe locking, but running on a uniprocessor (600 Mhz
PIII).  This is tha naive 30 minute implentation without any C
extensions or anything.

Most of the time is spent pickling, fs access is _really_ fast
on a decent operating system (e.g. Linux, FreeBSD).  If you're
storing really large objects, the pickling may take longer.

If you're storing a lot of items (more than a few thousands) use
the regular db-in-fs options (nested directories with a few 1000
files each or a btree filesystem like ReiserFS).

> > Same idea would work for user sessions, and since it's in the
> > filesystem the kernel will take care of buffering for you and
> > you can use tools like "find" and "rm" to prune the cache.
> > :-)
>
> Hmm, If I like to change user session data offen, I quess I
> would go for the "shared mem" solution.

I tried it when I first implemented the thing , the timing was
similar (within 2-3%).  Which makes sense, because the time to
pickle is dominating anyway.  Bear in mind that the fs cache is
going to keep all your recently accessed files in RAM anyway.

If you do it in the fs, the implementation is much simpler-- you
need to build a balanced tree or hash table in SHM to get good
performance with more than 20-30 items in the database.  And
you're not as portable.  The key for me, though, was that being
able to play with the cache w/ regular user tools and assign
permissions per-item can be extremely useful.

  Sumner

From paullb at bigfoot.com  Thu May 31 21:23:50 2001
From: paullb at bigfoot.com (Brendan Paull)
Date: Fri Jan  9 21:58:56 2004
Subject: [mod_python] Compiling and installing mod_python-2.7.3
Message-ID: <5.0.2.1.2.20010531211720.00a02220@pop.minet.ca>

Hi,
	I am having a little trouble getting my mod_python to work.

This is the error I get:
[root@BCMP mod_python-2.7.3]# httpd
Syntax error on line 208 of /etc/httpd/conf/httpd.conf:
Cannot load /usr/lib/apache/mod_python.so into server: undefined symbol: 
pthread_create
[root@BCMP mod_python-2.7.3]#


These are the lines that I added to /etc/httpd/conf/httpd.conf:
208->  LoadModule python_module      /usr/lib/apache/mod_python.so #first 
one in the list
272->AddModule mod_python.c

333-337->
<Directory /var/www/html/python>
   AddHandler python-program .py
   PythonHandler mptest
   PythonDebug On
</Directory>


I have included a transcipt of everything that happens as I try to install 
at the end of the message, my system is a RedHat 7.0 and I have apache 1.3 
installed and python 2.1 which works from command line.

I would really appreciate any advice or tips at all.


[root@BCMP mod_python-2.7.3]# ./configure
loading cache ./config.cache
checking for gcc... (cached) gcc
checking whether the C compiler (gcc  ) works... yes
checking whether the C compiler (gcc  ) is a cross-compiler... no
checking whether we are using GNU C... (cached) yes
checking whether gcc accepts -g... (cached) yes
checking for ranlib... (cached) ranlib
checking for ar... (cached) ar
checking for a BSD compatible install... (cached) /usr/bin/install -c
checking whether make sets ${MAKE}... (cached) no
checking for main in -lm... (cached) yes
checking for working const... (cached) yes
checking your blood pressure... a bit high, but we can proceed
checking whether apxs is available
checking for --with-apxs... no
checking for apxs in /usr/local/apache/sbin... no
checking for apxs in your PATH... checking for apxs... (cached) /usr/sbin/apxs
found /usr/sbin/apxs, we'll use this. Use --with-apxs to specify another.
checking for Apache libexec directory... /usr/lib/apache
checking for Apache include directory... -I/usr/include/apache
checking for --with-apache... no
configure: warning: **** No apache sources specified, static compilation 
will not be available.
configure: warning: **** You can use --with-apache to specify where your 
Apache sources are.
checking for --with-python... no
checking for python... (cached) /usr/bin/python
checking Python version... 2.1
checking whether Python is compiled with thread support... yes

   ****** WARNING ******
   Python is compiled with thread support. Apache 1.3 does not use threads.
   On some systems this will cause problems during compilation, on others
   it may result in unpredictable behaviour of your Apache server. Yet on
   others it will work just fine. The recommended approach is to compile
   Python without thread support in a separate location and specify it with
   --with-python option to this ./configure script.

checking Python install prefix... /usr
checking what libraries Python was linked with... 
/usr/lib/python2.1/config/libpython2.1.a
checking linker flags used to link Python...
checking where Python include files are... -I/usr/include/python2.1
checking for mkdep... (cached) /usr/X11R6/bin/makedepend
creating ./config.status
creating Makefile
creating src/Makefile
creating src/libpython.module
creating Doc/Makefile
analyzing dependencies
[root@BCMP mod_python-2.7.3]# make
make[1]: Entering directory `/root/mod_python-2.7.3/src'
make[1]: Leaving directory `/root/mod_python-2.7.3/src'
[root@BCMP mod_python-2.7.3]# make install
make[1]: Entering directory `/root/mod_python-2.7.3'
make[2]: Entering directory `/root/mod_python-2.7.3/src'
make[2]: Leaving directory `/root/mod_python-2.7.3/src'

Performing DSO installation.

/usr/bin/install -c src/mod_python.so /usr/lib/apache
make[2]: Entering directory `/root/mod_python-2.7.3'
/usr/bin/install -c -d /usr/lib/python2.1/site-packages/mod_python
python /usr/lib/python2.1/compileall.py 
/usr/lib/python2.1/site-packages/mod_python
Listing /usr/lib/python2.1/site-packages/mod_python ...
Compiling /usr/lib/python2.1/site-packages/mod_python/__init__.py ...
Compiling /usr/lib/python2.1/site-packages/mod_python/apache.py ...
Compiling /usr/lib/python2.1/site-packages/mod_python/cgihandler.py ...
Compiling /usr/lib/python2.1/site-packages/mod_python/httpdapi.py ...
Compiling /usr/lib/python2.1/site-packages/mod_python/publisher.py ...
Compiling /usr/lib/python2.1/site-packages/mod_python/util.py ...
Compiling /usr/lib/python2.1/site-packages/mod_python/zhandler.py ...
make[2]: Leaving directory `/root/mod_python-2.7.3'

Now don't forget to edit your main config and add
     LoadModule python_module /usr/lib/apache/mod_python.so
and if your configuration uses ClearModuleList, then also
     AddModule mod_python.c

make[1]: Leaving directory `/root/mod_python-2.7.3'




From dado at wildbrain.com  Tue May  1 16:09:44 2001
From: dado at wildbrain.com (Dado Feigenblatt)
Date: Fri Jan  9 22:02:42 2004
Subject: [mod_python] mod_python and databases.
Message-ID: <3AEF4238.599ACFE2@wildbrain.com>

Hi there.

New to the list. New to mod_python.

I have a bunch of questions, but please, I'm not trying to start a flame
war.

I need to put up a database with access from different platforms.
So far I got this (which might change as my research continues):

The DB server will be (for now) PostgreSQL.
Users will be on different machines: SGIs, Intel/Linux, Macintoshes, and
maybe some Windows boxes.
At first I thought of doing the interface entirely web based, for
portability sake, using PHP (which I don't know)
Then, it hit me that this database will be accessed not only by humans
but by applications runing on some sort of UN*X like machine, and maybe
others (Mac/Win).
We have a lot of little apps and "glue" written in python.
So, we'll have to write some DB modules to interface with our DB and
other apps.
Then it hit me again, if we'll have to write a lot of that stuff in
python, maybe I should discard PHP and just go for python.
That's how I got to mod_python.
But this database will be internal only. Do I need a webserver with
mod_python for that?
Python has nice GUI toolkits. Can't I just do it in Python/Tk or
wxPython?
Why should I use mod_python?

Thanks.


--
Dado Feigenblatt                                 Wild Brain, Inc.
Technical Director                               (415) 553-8000 x???
dado@wildbrain.com                               San Francisco, CA.




From kees.serier at relan.nl  Wed May  2 13:00:15 2001
From: kees.serier at relan.nl (Serier, Kees)
Date: Fri Jan  9 22:02:43 2004
Subject: [mod_python] problems configuring mod_python on AIX.
Message-ID: <AA2536FEE0A9D311887000508B5EDF1E01C2BBED@ab00s003.abab.cadans.nl>

Hello,

I'm trying to build apache with mod_python, but the configure script gives
some errors (lookup at the 1) and 2) in the configure ouput below:  *
Mod_python):
- 1) It seems that it can't find @sbindir@/httpd but it is both in:
     -rwxr-xr-x   1 root     beheer   1200657 Mar 15 09:58
/usr/local/apache/bin/httpd
     -rwxr-xr-x   1 root     beheer   1200657 Mar 15 09:58
/usr/local/apache/sbin/httpd
     and works just fine.
     Passing --sbindir=/usr/local/apache/sbin to the configure scripts
     doesn't help.				     
     /usr/local/apache/libexec exists but is empty
- 2) allthough I use --with-pythonn==/usr/local/src/Python-2.0, configure
     still wants to use python 1.5.2
And yes, it is right about the bloodpresure ;-)

Can anybody give me a tip?

Thanks in advance,

Kees Serier mailto:kees.serier@ordina.nl

* General information:
   AIX        4.2.1
   GCC        2.95.2 (locally build and installed from source)
   GNU-make   3.79.1 (locally build and installed from source)
   Python     2.0    (locally build and installed from source)
   Apache     1.3.19 (locally build and installed from source with DSO)
   Mod_python 2.7.2

  Apache is (default) installed in /usr/local/apache
    source in /usr/local/src/apache_1.3.19
    /usr/local/apache/sbin did was not installed with the default
    installation, I created it making a full copy from /usr/local/apache/bin
    the configure script there finds the apxs utility.
  Python is (default) installed in /usr/local/python
    source in /usr/local/src/Python-2.0
   
  Apache and Python are being used with CGI and MySQL.

* Mod_python:
   source in /usr/local/src/mod_python-2.7.2
   
   [/usr/local/src/mod_python-2.7.2]# ./configure
--with-python=/usr/local/src/Python-2.0
--with-apache=/usr/local/src/apache_1.3.19 --sbindir=/usr/local/apache/sbin
   This gives the following output:
   
   loading cache ./config.cache
   checking for gcc... (cached) gcc
   checking whether the C compiler (gcc  ) works... yes
   checking whether the C compiler (gcc  ) is a cross-compiler... no
   checking whether we are using GNU C... (cached) yes
   checking whether gcc accepts -g... (cached) yes
   checking for ranlib... (cached) ranlib
   checking for ar... (cached) ar
   checking for a BSD compatible install... ./install-sh -c
   checking whether make sets ${MAKE}... (cached) yes
   checking for main in -lm... (cached) yes
   checking for working const... (cached) yes
   checking your blood pressure... a bit high, but we can proceed
   checking whether apxs is available
   checking for --with-apxs... no
   checking for apxs in /usr/local/apache/sbin... found, we'll use this. Use
--with-apxs to specify another.
1) checking for Apache libexec directory... apxs:Error: @sbindir@/httpd not
found or not executable
   
1) checking for Apache include directory... apxs:Error: @sbindir@/httpd not
found or not executable
   -I
   checking for --with-apache... /usr/local/src/apache_1.3.19
   checking for --with-python... /usr/local/src/Python-2.0
2) checking for python... (cached) /usr/local/src/Python-1.5.2/python
2) checking Python version... ./configure[1310]:
/usr/local/src/Python-1.5.2/python:  not found
   
2) checking whether Python is compiled with thread support...
./configure[1316]: /usr/local/src/Python-1.5.2/python:  not found
   no threads, good
2) checking Python install prefix... ./configure[1335]:
/usr/local/src/Python-1.5.2/python:  not found
   
   checking what libraries Python was linked with...
/usr/local/src/Python-2.0/libpython.a   -ldl  -lpthreads   -lm
-lreadline -ltermcap                      -L/usr/local/lib -ltk8.0 -ltcl8.0
-L/usr/lib/X11 -lld -lX11   -lcurses -ltermcap       -L$(exec_prefix)/lib
-lz 
   checking linker flags used to link Python...  -Wl,-bE:python.exp -lld  
   checking where Python include files are... -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include
   checking for mkdep... (cached) /usr/bin/X11/makedepend
   creating ./config.status
   creating Makefile
   creating src/Makefile
   creating src/libpython.module
   creating Doc/Makefile
   analyzing dependencies
-- end of message


From linux at mensagero.com.br  Wed May  2 12:19:13 2001
From: linux at mensagero.com.br (Linux)
Date: Fri Jan  9 22:02:43 2004
Subject: [mod_python] could not import mod_python.apache
Message-ID: <002f01c0d31b$3f53ad00$0300000a@mensagero.int.br>

Hello friends:)

I use apache 1.3.14, python 1.5.2, in a box (linux) Conectiva 6.0 - a RedHat
like linux.
I install mod_python 2.7.1-1.

When I open a directory example in a browser, I got a error 500. The
error_log of apache sais:

make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
[Wed May  2 12:04:41 2001] [error] [client XXX.XXX.XXX.XXX] python_handler:
make_obcallback returned no obCallBack!

Something is wrong, and my poor knowledge about python is not help.

In http.conf

<IfModule mod_python.c>
  Alias /mod_python/ /var/www/mod_python_test/
  <Directory /var/www/mod_python_test>
    AllowOverride FileInfo
  </Directory>
</IfModule>

In .htaccess

SetHandler python-program
PythonHandler pythonhandler

In pythonhandler.py

from mod_python import apache

def handler(req):
    req.send_http_header()
    req.write("Hello to the World from "+req.uri+"!")
    return apache.OK

tanks for any help.

in time: my english is poor, but my soul is better :)
----
Julio Cesar J Melati
Administrador de Redes

http://www.mensagero.com.br
falecom@mensagero.com.br


From db8coach at hotmail.com  Wed May  2 16:55:48 2001
From: db8coach at hotmail.com (Bryon G)
Date: Fri Jan  9 22:02:43 2004
Subject: [mod_python] mod_python vs. aolserver/pywx and postgresql
Message-ID: <LAW2-F133oHMwVN7miR0000d673@hotmail.com>

I am a student at ArsDigita University.  We recently did Phil Greenspun's 
database-backed website course, and made the decision early on to learn and 
use Python to do the class (instead of the non-free .net tools Philip was 
pushing).  We had to decide on a database and a web server, and originally 
started with mod-python and postgres using pg to glue them together, but we 
eventually  switched to aolserver and pywx.  There were two reasons:

1. our instructors were more familiar with AOLserver
2. AOLServer has database connection pooling built in.

The second reason is probably the one which will be relevant to you.  If 
it's possible/easy to do this with modpython/apache, I'd love to know about 
it because I'd prefer to use apache since it's so much more common, but in 
the *very* limited time we had to do the project we found more and better 
documentation (albeit translated from the C api documentation) for the pywx 
way than for the mod python way.

I explored a few other options before we made the switch, such as the pgpool 
module at the vaults (which people seem to be using with mod-fast-cgi, if 
anyone is using it with mod-python I'd love to hear about it), but since we 
were able to get going faster with aolserver that's what we used.

The syntax for the AOLServer database access stuff was, in my opinion, 
harder to learn than the pg way largely because there was less documentation 
available, but once that was out of the way the pooling question seemed to 
be the only real difference between the two in terms of end performance.

Bryon

ps- in case you are wondering, our project was to automate the 
secondarysources.com website for college debaters.  The project is not up on 
the internet yet, and probably won't be for a few months, so unfortunately I 
can't point you to it yet, but if anyone's interested I can post the code we 
wrote somewhere.
_________________________________________________________________
Get your FREE download of MSN Explorer at http://explorer.msn.com


From mhagger at alum.mit.edu  Wed May  2 19:35:31 2001
From: mhagger at alum.mit.edu (Michael Haggerty)
Date: Fri Jan  9 22:02:43 2004
Subject: [mod_python] mod_python vs. aolserver/pywx and postgresql
In-Reply-To: "Bryon G"'s message of "Wed, 02 May 2001 16:55:48 -0000"
References: <LAW2-F133oHMwVN7miR0000d673@hotmail.com>
Message-ID: <m2lmoftjcs.fsf@freak.kaiserty.com>

"Bryon G" <db8coach@hotmail.com> writes:
> The syntax for the AOLServer database access stuff was, in my
> opinion, harder to learn than the pg way largely because there was
> less documentation available, but once that was out of the way the
> pooling question seemed to be the only real difference between the
> two in terms of end performance.

I'm hope nobody is offended that I follow up with a comment about PyWX
on this mailing list...

With PyWX you don't have to limit yourself to the AOLserver database
API to get connection caching.  (In fact, I don't use it myself.)  The
latest version of PyWX has a single-interpreter, multiple-thread mode
with which you could open, for example, multiple pg database
connections on startup and store them in a pool.  Individual scripts
would grab a connection from the pool, use it, clear it out, and
return it to the pool to be reused.  Of course this is predicated on
pg and your pool code being thread-safe.

Once multithreaded Apache is out, similar tricks should be possible in
the Apache world.

Michael

-- 
Michael Haggerty
mhagger@alum.mit.edu

From bbhaydon at bigpond.com  Thu May  3 11:32:03 2001
From: bbhaydon at bigpond.com (Brett Haydon)
Date: Fri Jan  9 22:02:43 2004
Subject: [mod_python] RE: mod_python and databases
In-Reply-To: <200105021601.f42G1L243366@eden.ispol.com>
Message-ID: <NCBBKMABOKFCDLPIKKGIAEPCCCAA.bbhaydon@bigpond.com>

You could do it with any of those nice GUI toolkits.
modpython is only going to be useful if you want the
browser/web page to be the GUI.

It really goes back to the argument of server side
v client side. Do you want to install a GUI client
on every machine?? Do you need the bells & whistles of
a GUI or is a web interface sufficient? Which is faster
to develop for you? etc.

Brett


From dsavitsk at midway.uchicago.edu  Fri May  4 00:35:02 2001
From: dsavitsk at midway.uchicago.edu (douglas savitsky)
Date: Fri Jan  9 22:02:43 2004
Subject: [mod_python] Win2k httpd.conf problems
Message-ID: <988954502.3af23f8680258@webmail.uchicago.edu>

hi there,

i am having trouble getting started, and could use some help.
Win2k, Apache 1.3.14, mod_python 2.7.2, ActivePython 2.0.

I am unable to configure things, and i get the error:
-------------------------
Mod_python error: "PythonHandler test"

Traceback (most recent call last):

  File "c:\program files\python20\lib\mod_python\apache.py", line 180, in 
Dispatch
    object = resolve_object(self.req, module, object_str, silent)

  File "c:\program files\python20\lib\mod_python\apache.py", line 396, in 
resolve_object
    raise AttributeError, s

AttributeError: module 'c:\program files\python20\lib\test\__init__.pyc' 
contains no 'handler'
-------------------------

I saw a reference to this here
http://www.modpython.org/pipermail/mod_python/2001-February/001163.html
but i don't know what the answer means ...

as far as set up, here is what i have done ...

1. put the .dll where it goes.  that part seems okay.
2. add the line 'LoadModule python_module modules/mod_python.dll' which also 
seems fine
3. copy all of the .py files from 
..\python20\lib\mod_python-2.7.2\lib\python\mod_python\*.py to 
..\python20\lib\mod_python\*.py
[if i put them elsewhere i get other erros]
4. make changes to the httpd.conf file so it looks like this
<IfModule mod_alias.c>
    Alias /icons/ "C:/Apache/icons/"
    <Directory "C:/Apache/icons">
        Options Indexes MultiViews
        AllowOverride None
        Order allow,deny
        Allow from all
    </Directory>
    ScriptAlias /cgi-bin/ "C:/Apache/cgi-bin/"
    <Directory "C:/Apache/cgi-bin">
        AllowOverride None
        Options None
        Order allow,deny
        Allow from all
    </Directory>
    <Directory "C:/Apache/cgi-bin">
        AddHandler python-program .py
        PythonHandler test
        PythonDebug on
    </Directory>
</IfModule>

thanks for any help.  i am coming over from iis/asp world, so i have no apache 
experience either.

doug

From trengove at econdata.com.au  Sun May  6 15:07:53 2001
From: trengove at econdata.com.au (Chris Trengove)
Date: Fri Jan  9 22:02:43 2004
Subject: [mod_python] Win32 threading issue
Message-ID: <200105061509919.SM00265@athene>

I have been testing the following script on Apache with mod_python (Apache
1.13.17, mod_python 2.7.2, Windows 2000). I have been interested in testing
the possible throughput of this (and more useful scripts), so I have
another Python script which continually loads this "page".

from mod_python import apache
import thread

def handler(req):
    req.content_type = "text/plain"
    req.send_http_header()
    req.write("%d\n" % thread.get_ident())
    return apache.OK

When I run more than one copy of the driver script (in multiple consoles),
I get behavior indicative of some threading problems. Specifically, some
connections get "lost", the Apache error log reports various instances of
"IOError: Write failed...", and I occassionally get an access violation
inside Apache. Similarly, if I only run one copy of the driver script, and
just keep hitting the refresh button in a browser, the browser
occassionally returns TWO numbers, and sometimes reports an error in
retrieving the data. Note that I have tested my driver program retrieving a
simple text file, and everything works as expected, so it does not appear
to be a problem with Apache. (The problem also goes away if I set
ThreadPerChild to 1 in the Apache configuration.)

I have also found that, if I comment out the req.write() statement in the
handler, then there are no problems. From my examination of the
implementation of the request object, I see that req_write() contains calls
to Py_BEGIN_ALLOW_THREADS / Py_END_ALLOW_THREADS, whereas
req_send_http_header() contains no such calls. This suggests to me that
some thread switching is occurring inside req_write() which is messing with
the state of the interpreter.

I would be most grateful if anyone has any information to offer on this.

Chris Trengove


From marcf at becomm.com  Mon May  7 02:41:30 2001
From: marcf at becomm.com (Marc Fiuczynski)
Date: Fri Jan  9 22:02:43 2004
Subject: [mod_python] Win32 threading issue
Message-ID: <A9DFD9380C01D4118E740050DA7A8970386320@becomm-mis2.becomm.com>

A random shot in the dark...

are you using a multithreaded version of the python interpreter?  If so,
then that might be the cause of your problem.   Somewhere in the mod_python
documentation I read that apache would get confused if you used a
multithreaded version of python.  Check that and please let us (or at least
me) know.

In terms of throughput, you might also try writing a script using "wget" to
measure the number of requests per second you can run (not sure what the
windows equivalent is, or whether you can get it to work with cygwin).

Cheers,
Marc


> -----Original Message-----
> From: Chris Trengove [mailto:trengove@econdata.com.au]
> Sent: Saturday, May 05, 2001 10:08 PM
> To: mod_python@modpython.org
> Subject: [mod_python] Win32 threading issue
> 
> 
> I have been testing the following script on Apache with 
> mod_python (Apache
> 1.13.17, mod_python 2.7.2, Windows 2000). I have been 
> interested in testing
> the possible throughput of this (and more useful scripts), so I have
> another Python script which continually loads this "page".
> 
> from mod_python import apache
> import thread
> 
> def handler(req):
>     req.content_type = "text/plain"
>     req.send_http_header()
>     req.write("%d\n" % thread.get_ident())
>     return apache.OK
> 
> When I run more than one copy of the driver script (in 
> multiple consoles),
> I get behavior indicative of some threading problems. 
> Specifically, some
> connections get "lost", the Apache error log reports various 
> instances of
> "IOError: Write failed...", and I occassionally get an access 
> violation
> inside Apache. Similarly, if I only run one copy of the 
> driver script, and
> just keep hitting the refresh button in a browser, the browser
> occassionally returns TWO numbers, and sometimes reports an error in
> retrieving the data. Note that I have tested my driver 
> program retrieving a
> simple text file, and everything works as expected, so it 
> does not appear
> to be a problem with Apache. (The problem also goes away if I set
> ThreadPerChild to 1 in the Apache configuration.)
> 
> I have also found that, if I comment out the req.write() 
> statement in the
> handler, then there are no problems. From my examination of the
> implementation of the request object, I see that req_write() 
> contains calls
> to Py_BEGIN_ALLOW_THREADS / Py_END_ALLOW_THREADS, whereas
> req_send_http_header() contains no such calls. This suggests 
> to me that
> some thread switching is occurring inside req_write() which 
> is messing with
> the state of the interpreter.
> 
> I would be most grateful if anyone has any information to 
> offer on this.
> 
> Chris Trengove
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 

From trengove at econdata.com.au  Mon May  7 21:21:32 2001
From: trengove at econdata.com.au (Chris Trengove)
Date: Fri Jan  9 22:02:43 2004
Subject: [mod_python] Win32 threading issue
In-Reply-To: <A9DFD9380C01D4118E740050DA7A8970386320@becomm-mis2.becomm.
 com>
Message-ID: <200105072122310.SM00265@athene>

Marc,

Yes, as I understand things, this should be the multithreaded version,
since this is how Python is built for Win32. (I am running the BeOpen 2.0
version of Python.) But my reading of the mod_python documentation is that
mod_python under Win32 is "thread safe", to the extent that it allocates a
new Python thread for each new Apache thread, and does the appropriate
things to make sure that the threads co-exist peacefully.

As for measuring throughput, my script does that quite successfully - if I
only run one copy. The point is that this test environment exposes the
threading problem far more quickly than in a production environment, where
the conflict might occur much less often, and much less predictably.

Chris

At 02:41 AM 7/05/2001 -0700, Marc Fiuczynski wrote:
>A random shot in the dark...
>
>are you using a multithreaded version of the python interpreter?  If so,
>then that might be the cause of your problem.   Somewhere in the mod_python
>documentation I read that apache would get confused if you used a
>multithreaded version of python.  Check that and please let us (or at least
>me) know.
>
>In terms of throughput, you might also try writing a script using "wget" to
>measure the number of requests per second you can run (not sure what the
>windows equivalent is, or whether you can get it to work with cygwin).
>
>Cheers,
>Marc
>


From stephane.bidoul at softwareag.com  Mon May  7 13:22:42 2001
From: stephane.bidoul at softwareag.com (=?iso-8859-1?Q?St=E9phane_Bidoul?=)
Date: Fri Jan  9 22:02:43 2004
Subject: [mod_python] Win32 threading issue
In-Reply-To: <A9DFD9380C01D4118E740050DA7A8970386320@softwareag.com>
Message-ID: <000001c0d70d$064b9fe0$4eb3bd9d@softwareag.com>

> are you using a multithreaded version of the python 
> interpreter?  If so,
> then that might be the cause of your problem.   Somewhere in 
> the mod_python
> documentation I read that apache would get confused if you used a
> multithreaded version of python.  Check that and please let 
> us (or at least
> me) know.

I think this is true for *nix, but on windows,
you *must* use a multithreaded python.

I'll try to have a look at your issue, but I've very
few time available these days.

-sbi

> -----Original Message-----
> From: mod_python-admin@modpython.org
> [mailto:mod_python-admin@modpython.org]On Behalf Of Marc Fiuczynski
> Sent: 07 May, 2001 11:42
> To: 'Chris Trengove'; mod_python@modpython.org
> Subject: RE: [mod_python] Win32 threading issue
> 
> 
> A random shot in the dark...
> 
> are you using a multithreaded version of the python 
> interpreter?  If so,
> then that might be the cause of your problem.   Somewhere in 
> the mod_python
> documentation I read that apache would get confused if you used a
> multithreaded version of python.  Check that and please let 
> us (or at least
> me) know.
> 
> In terms of throughput, you might also try writing a script 
> using "wget" to
> measure the number of requests per second you can run (not 
> sure what the
> windows equivalent is, or whether you can get it to work with cygwin).
> 
> Cheers,
> Marc
> 
> 
> > -----Original Message-----
> > From: Chris Trengove [mailto:trengove@econdata.com.au]
> > Sent: Saturday, May 05, 2001 10:08 PM
> > To: mod_python@modpython.org
> > Subject: [mod_python] Win32 threading issue
> > 
> > 
> > I have been testing the following script on Apache with 
> > mod_python (Apache
> > 1.13.17, mod_python 2.7.2, Windows 2000). I have been 
> > interested in testing
> > the possible throughput of this (and more useful scripts), so I have
> > another Python script which continually loads this "page".
> > 
> > from mod_python import apache
> > import thread
> > 
> > def handler(req):
> >     req.content_type = "text/plain"
> >     req.send_http_header()
> >     req.write("%d\n" % thread.get_ident())
> >     return apache.OK
> > 
> > When I run more than one copy of the driver script (in 
> > multiple consoles),
> > I get behavior indicative of some threading problems. 
> > Specifically, some
> > connections get "lost", the Apache error log reports various 
> > instances of
> > "IOError: Write failed...", and I occassionally get an access 
> > violation
> > inside Apache. Similarly, if I only run one copy of the 
> > driver script, and
> > just keep hitting the refresh button in a browser, the browser
> > occassionally returns TWO numbers, and sometimes reports an error in
> > retrieving the data. Note that I have tested my driver 
> > program retrieving a
> > simple text file, and everything works as expected, so it 
> > does not appear
> > to be a problem with Apache. (The problem also goes away if I set
> > ThreadPerChild to 1 in the Apache configuration.)
> > 
> > I have also found that, if I comment out the req.write() 
> > statement in the
> > handler, then there are no problems. From my examination of the
> > implementation of the request object, I see that req_write() 
> > contains calls
> > to Py_BEGIN_ALLOW_THREADS / Py_END_ALLOW_THREADS, whereas
> > req_send_http_header() contains no such calls. This suggests 
> > to me that
> > some thread switching is occurring inside req_write() which 
> > is messing with
> > the state of the interpreter.
> > 
> > I would be most grateful if anyone has any information to 
> > offer on this.
> > 
> > Chris Trengove
> > 
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://www.modpython.org/mailman/listinfo/mod_python
> > 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From trengove at econdata.com.au  Tue May  8 13:34:46 2001
From: trengove at econdata.com.au (Chris Trengove)
Date: Fri Jan  9 22:02:43 2004
Subject: [mod_python] Win32 threading issue
In-Reply-To: <000001c0d70d$064b9fe0$4eb3bd9d@softwareag.com>
References: <A9DFD9380C01D4118E740050DA7A8970386320@softwareag.com>
Message-ID: <20010508133951.SM00265@athene>

St?phane,

I would be great if you could find time to look at this.

I have been doing some more investigating, trying to understand just what
is going on. As I mentioned in my previous message, Py_BEGIN_ALLOW_THREADS
is called in the request object's write() method, so thread switching could
occur here. But thread switching should still occur in any case inside the
main Python interpreter loop. To test this, I tried the following script

from mod_python import apache
import thread

counter = None
LOOPLIMIT =
1000000

def handler(req):
   	global counter
    counter = 0
   	for i in
range(0,LOOPLIMIT):
        counter = counter + 1
    req.content_type =
"text/plain"
    req.send_http_header()
    req.write("%d: %d\n" %
(thread.get_ident(),counter))
    return apache.OK

If I load this page once, I get a value of 1000000 back, as expected. If I
load the page from two clients "simultaneously" (or as fast as I can
activate each one), I get something like

Client 1
1908: 1200128
2016: 1354557
2024: 591402

Client 2
2004: 1698384
2012: 1800311
2028: 1205627

This is for three repetitions of the page load. As you can see, the Python
interpreter is definitely switching between threads, and producing crazy
results for the global counter variable, which is not protected by any lock.

This is all as expected. The puzzle is why the thread switching inside the
request object's module should be causing some problem, if that is indeed
where the trouble lies. I am wondering whether there is something in the
request object structure which is not totally thread-safe.

Incidentally, if I run enough repetitions of this test setup, I can
eventually get a situation where one thread crashes, and the other thread
(just at this point) returns a value like

632: 1515843<LF>568: 1572286

that is TWO thread IDs in the one message -- the write buffer of one thread
is being appended to by the other, somehow.

Some food for thought.
Chris

>I think this is true for *nix, but on windows,
>you *must* use a multithreaded python.
>
>I'll try to have a look at your issue, but I've very
>few time available these days.



From grisha at modpython.org  Tue May  8 00:22:08 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:02:43 2004
Subject: [mod_python] Win32 threading issue
In-Reply-To: <20010508133951.SM00265@athene>
Message-ID: <Pine.BSF.4.32.0105080017250.11714-100000@localhost>

Chris -

Do you have Keepalive enabled?

Grisha

On Tue, 8 May 2001, Chris Trengove wrote:

> Incidentally, if I run enough repetitions of this test setup, I can
> eventually get a situation where one thread crashes, and the other thread
> (just at this point) returns a value like
>
> 632: 1515843<LF>568: 1572286
>
> that is TWO thread IDs in the one message -- the write buffer of one thread
> is being appended to by the other, somehow.
>


From trengove at econdata.com.au  Tue May  8 16:27:09 2001
From: trengove at econdata.com.au (Chris Trengove)
Date: Fri Jan  9 22:02:43 2004
Subject: [mod_python] Win32 threading issue
In-Reply-To: <Pine.BSF.4.32.0105080017250.11714-100000@localhost>
References: <20010508133951.SM00265@athene>
Message-ID: <200105081628535.SM00265@athene>

Grisha,

I did have KeepAlive On, but it appears to make no difference. I have just
tried with KeepAlive Off, and I get the same behaviour. Also, the clients I
have been using would be closing the connection after each request. As
clients I have been using a Python script with urllib, and a little C++
test program I wrote to see if trying a different client made any
difference. It didn't.

Chris

At 12:22 AM 8/05/2001 -0400, Gregory (Grisha) Trubetskoy wrote:
>
>Chris -
>
>Do you have Keepalive enabled?
>
>Grisha
>
>On Tue, 8 May 2001, Chris Trengove wrote:
>
>> Incidentally, if I run enough repetitions of this test setup, I can
>> eventually get a situation where one thread crashes, and the other thread
>> (just at this point) returns a value like
>>
>> 632: 1515843<LF>568: 1572286
>>
>> that is TWO thread IDs in the one message -- the write buffer of one thread
>> is being appended to by the other, somehow.


From grisha at modpython.org  Tue May  8 09:47:25 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:02:43 2004
Subject: [mod_python] Win32 threading issue
In-Reply-To: <200105081628535.SM00265@athene>
Message-ID: <Pine.BSF.4.32.0105080944350.16559-100000@localhost>

Interesting...

Another question - when you say a thread crashes, what exactly do you see
- is it something in the log or one of those dr. watson messages?

On Tue, 8 May 2001, Chris Trengove wrote:

> Grisha,
>
> I did have KeepAlive On, but it appears to make no difference. I have just
> tried with KeepAlive Off, and I get the same behaviour. Also, the clients I
> have been using would be closing the connection after each request. As
> clients I have been using a Python script with urllib, and a little C++
> test program I wrote to see if trying a different client made any
> difference. It didn't.
>
> Chris
>
> At 12:22 AM 8/05/2001 -0400, Gregory (Grisha) Trubetskoy wrote:
> >
> >Chris -
> >
> >Do you have Keepalive enabled?
> >
> >Grisha
> >
> >On Tue, 8 May 2001, Chris Trengove wrote:
> >
> >> Incidentally, if I run enough repetitions of this test setup, I can
> >> eventually get a situation where one thread crashes, and the other thread
> >> (just at this point) returns a value like
> >>
> >> 632: 1515843<LF>568: 1572286
> >>
> >> that is TWO thread IDs in the one message -- the write buffer of one thread
> >> is being appended to by the other, somehow.
>


From fatpornstar at hotmail.com  Tue May  8 17:04:32 2001
From: fatpornstar at hotmail.com (Benjamin Watson)
Date: Fri Jan  9 22:02:43 2004
Subject: [mod_python] Remove me please
Message-ID: <F212ZS4HIv6EybqfAj800005fe8@hotmail.com>

_________________________________________________________________
Get your FREE download of MSN Explorer at http://explorer.msn.com


From CHagner at fool.com  Tue May  8 13:29:37 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 22:02:43 2004
Subject: [mod_python] Use mod_python for root/home page requests
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E47DCA@rover.foolhq.com>

I currently have mod_python wired into a location (Specifically <Location
/>) that allows all request coming under this location to be handled by my
handler.  I also use SetHandler instead of AddHandler so that it doesn't
even matter what file extension/type is requested.  My goal here is to have
an apache instance that has ALL of its requests go through mod_python.

Now, the strange thing is that this works great for all requests except for
the root/home page.  For example,

http://www.mydummysite.com/blahblah

This works great... my handler is called and is responsible for
interpretting 'blahblah'.  However,

http://www.mydummysite.com/

This fails to go to the handler and instead looks for the default page
(index.html) in the DocumentRoot.  Thus, my Location directive doesn't
appear to be inclusive of the request to the base home URL.

Has anyone tried this before?  I'd prefer to achieve this without relying on
mod_rewrite.

Thanks for your help.

Chris



From trengove at econdata.com.au  Wed May  9 08:27:50 2001
From: trengove at econdata.com.au (Chris Trengove)
Date: Fri Jan  9 22:02:43 2004
Subject: [mod_python] Win32 threading issue
In-Reply-To: <Pine.BSF.4.32.0105080944350.16559-100000@localhost>
References: <200105081628535.SM00265@athene>
Message-ID: <200105090830627.SM00265@athene>

Grisha,

Exactly what I see is variable in nature. The most usual thing will be an
entry in the Apache error log like this

[Tue May 08 16:47:37 2001] [error] PythonHandler hwtest: Traceback (most
recent call last):

[Tue May 08 16:47:37 2001] [error] PythonHandler hwtest:   File
"e:\python20\lib\mod_python\apache.py", line 189, in Dispatch     result =
object(self.req) [Tue May 08 16:47:37 2001] [error] PythonHandler hwtest:
File "c:/apache/apache/htdocs/python\hwtest.py", line 24, in handler
req.write("%d: %d\n" % (thread.get_ident(),counter)) 

[Tue May 08 16:47:37 2001] [error] PythonHandler hwtest: IOError: Write
failed, client closed connection. 

When I use my Python driver script, which keeps going even if no data is
returned from the server, I will often end up with an access violation
inside Apache.exe.

"The instruction at "0x6ff71679" referenced memory at "0x616c707b". The
memory could not be "read"."

Actually, this location appears to be always the same -- when it eventually
happens -- which might be after a significant number log error messages.
After the access violation, one of my driver scripts stops, because it
receives a socket exception (10054, "Connection reset by peer"), and the
other script continues merrily along.

Occassionally other things can happen too -- I think it just depends on
when the two threads conflict. As I mentioned earilier, one really
misterious occurrence is getting a "double message" returned to one thread,
just as the other receives no data. Like this

632: 1515843<LF>568: 1572286

Here <LF> is a line feed, and the numbers before the colons are the thread
IDs. I know that Apache has 50 threads which it is cycling through in
order. On this occassion 568 was due to be the thread to be used for the
OTHER client.

Chris

At 09:47 AM 8/05/2001 -0400, Gregory (Grisha) Trubetskoy wrote:
>
>Interesting...
>
>Another question - when you say a thread crashes, what exactly do you see
>- is it something in the log or one of those dr. watson messages?
>
>On Tue, 8 May 2001, Chris Trengove wrote:
>
>> Grisha,
>>
>> I did have KeepAlive On, but it appears to make no difference. I have just
>> tried with KeepAlive Off, and I get the same behaviour. Also, the clients I
>> have been using would be closing the connection after each request. As
>> clients I have been using a Python script with urllib, and a little C++
>> test program I wrote to see if trying a different client made any
>> difference. It didn't.



From benno at sesgroup.net  Wed May  9 11:24:48 2001
From: benno at sesgroup.net (Ben Leslie)
Date: Fri Jan  9 22:02:43 2004
Subject: [mod_python] Use mod_python for root/home page requests
In-Reply-To: <13CDDE6A53DBD311BC3200508B6F0C4805E47DCA@rover.foolhq.com>; from CHagner@fool.com on Tue, May 08, 2001 at 01:29:37PM -0400
References: <13CDDE6A53DBD311BC3200508B6F0C4805E47DCA@rover.foolhq.com>
Message-ID: <20010509112448.B22766@sesgroup.net>

On Tue, 08 May 2001, Chris Hagner wrote:

> I currently have mod_python wired into a location (Specifically <Location
> />) that allows all request coming under this location to be handled by my
> handler.  I also use SetHandler instead of AddHandler so that it doesn't
> even matter what file extension/type is requested.  My goal here is to have
> an apache instance that has ALL of its requests go through mod_python.
> 
> Now, the strange thing is that this works great for all requests except for
> the root/home page.  For example,
> 
> http://www.mydummysite.com/blahblah
> 
> This works great... my handler is called and is responsible for
> interpretting 'blahblah'.  However,
> 
> http://www.mydummysite.com/
> 
> This fails to go to the handler and instead looks for the default page
> (index.html) in the DocumentRoot.  Thus, my Location directive doesn't
> appear to be inclusive of the request to the base home URL.
> 
> Has anyone tried this before?  I'd prefer to achieve this without relying on
> mod_rewrite.



Mmm I think you need to change the "index" dirrective (not sure what its called,
I'm at uni at the moment, search for index.html). Then you want to add index.py
to this. That should in theory work.

Cheers,

Benno

From CHagner at fool.com  Tue May  8 22:17:04 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 22:02:43 2004
Subject: [mod_python] Use mod_python for root/home page requests
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E47DCE@rover.foolhq.com>

Actually, my handler doesn't call scripts (index.py)... instead it call a
Servlet-like object that needs to be in the PYTHONPATH.  This is why I'm
using a Location directive instead of a Directory directive.  I basically
need to handle URLs that map to classes in my path instead of script files
in the file system.

One thing I was considering was dropping a custom PythonTransHandler class
into the document root directory.  Then, if I identify a call for the
homepage, I could do an internal redirect to my servlet (i.e.
http://www.mydummysite.com/contentapp).  

The true hack is to put a META-REFRESH tag in the homepage (index.html) to
http://www.mydummysite.com/contentapp, but then I lose all referrer
information and the ability to do anything based on the original query
string.

Another possibility is mod_rewrite, but I'm not sure that will work.  Still
seems like this should be do-able though, given the number of web pages out
there that need to be fully dynamic.

Thanks for the response though.  Any input/ideas are great to hear.

Chris

-----Original Message-----
From: Ben Leslie [mailto:benno@sesgroup.net]
Sent: Tuesday, May 08, 2001 9:25 PM
To: Chris Hagner
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Use mod_python for root/home page requests


On Tue, 08 May 2001, Chris Hagner wrote:

> I currently have mod_python wired into a location (Specifically <Location
> />) that allows all request coming under this location to be handled by my
> handler.  I also use SetHandler instead of AddHandler so that it doesn't
> even matter what file extension/type is requested.  My goal here is to
have
> an apache instance that has ALL of its requests go through mod_python.
> 
> Now, the strange thing is that this works great for all requests except
for
> the root/home page.  For example,
> 
> http://www.mydummysite.com/blahblah
> 
> This works great... my handler is called and is responsible for
> interpretting 'blahblah'.  However,
> 
> http://www.mydummysite.com/
> 
> This fails to go to the handler and instead looks for the default page
> (index.html) in the DocumentRoot.  Thus, my Location directive doesn't
> appear to be inclusive of the request to the base home URL.
> 
> Has anyone tried this before?  I'd prefer to achieve this without relying
on
> mod_rewrite.



Mmm I think you need to change the "index" dirrective (not sure what its
called,
I'm at uni at the moment, search for index.html). Then you want to add
index.py
to this. That should in theory work.

Cheers,

Benno

From bbhaydon at bigpond.com  Wed May  9 16:00:13 2001
From: bbhaydon at bigpond.com (Brett Haydon)
Date: Fri Jan  9 22:02:43 2004
Subject: [mod_python] Compile Problems
Message-ID: <NCBBKMABOKFCDLPIKKGIIEBOCDAA.bbhaydon@bigpond.com>

Hi,
Just compiled Apache 1.3.19 on RH7.1 with mod_python
as a dso against Python 2.1

I get this error when I try to start Apache
Cannot load mod_python.so into server
undefined symbol: openpty

Any ideas??

cheers,  
____________________________
Brett Haydon
bbhaydon@bigpond.com 

From stephane.bidoul at softwareag.com  Wed May  9 14:07:33 2001
From: stephane.bidoul at softwareag.com (=?US-ASCII?Q?Stephane_Bidoul?=)
Date: Fri Jan  9 22:02:43 2004
Subject: [mod_python] Win32 threading issue
In-Reply-To: <200105090830627.SM00265@softwareag.com>
Message-ID: <000001c0d880$a37d8660$4eb3bd9d@softwareag.com>

Chris,

Could you send me your driver script?
I cannot reproduce the behaviour you describe with
my own test scripts.

BTW, do you have a multiprocessor machine?
I know some problems have been reported
but never reproced on MP WIN2K machines.

-sbi

> -----Original Message-----
> From: mod_python-admin@modpython.org
> [mailto:mod_python-admin@modpython.org]On Behalf Of Chris Trengove
> Sent: 09 May, 2001 00:28
> To: Gregory (Grisha) Trubetskoy
> Cc: mod_python@modpython.org
> Subject: RE: [mod_python] Win32 threading issue
> 
> 
> Grisha,
> 
> Exactly what I see is variable in nature. The most usual 
> thing will be an
> entry in the Apache error log like this
> 
> [Tue May 08 16:47:37 2001] [error] PythonHandler hwtest: 
> Traceback (most
> recent call last):
> 
> [Tue May 08 16:47:37 2001] [error] PythonHandler hwtest:   File
> "e:\python20\lib\mod_python\apache.py", line 189, in Dispatch 
>     result =
> object(self.req) [Tue May 08 16:47:37 2001] [error] 
> PythonHandler hwtest:
> File "c:/apache/apache/htdocs/python\hwtest.py", line 24, in handler
> req.write("%d: %d\n" % (thread.get_ident(),counter)) 
> 
> [Tue May 08 16:47:37 2001] [error] PythonHandler hwtest: 
> IOError: Write
> failed, client closed connection. 
> 
> When I use my Python driver script, which keeps going even if 
> no data is
> returned from the server, I will often end up with an access violation
> inside Apache.exe.
> 
> "The instruction at "0x6ff71679" referenced memory at 
> "0x616c707b". The
> memory could not be "read"."
> 
> Actually, this location appears to be always the same -- when 
> it eventually
> happens -- which might be after a significant number log 
> error messages.
> After the access violation, one of my driver scripts stops, because it
> receives a socket exception (10054, "Connection reset by 
> peer"), and the
> other script continues merrily along.
> 
> Occassionally other things can happen too -- I think it just 
> depends on
> when the two threads conflict. As I mentioned earilier, one really
> misterious occurrence is getting a "double message" returned 
> to one thread,
> just as the other receives no data. Like this
> 
> 632: 1515843<LF>568: 1572286
> 
> Here <LF> is a line feed, and the numbers before the colons 
> are the thread
> IDs. I know that Apache has 50 threads which it is cycling through in
> order. On this occassion 568 was due to be the thread to be 
> used for the
> OTHER client.
> 
> Chris
> 
> At 09:47 AM 8/05/2001 -0400, Gregory (Grisha) Trubetskoy wrote:
> >
> >Interesting...
> >
> >Another question - when you say a thread crashes, what 
> exactly do you see
> >- is it something in the log or one of those dr. watson messages?
> >
> >On Tue, 8 May 2001, Chris Trengove wrote:
> >
> >> Grisha,
> >>
> >> I did have KeepAlive On, but it appears to make no 
> difference. I have just
> >> tried with KeepAlive Off, and I get the same behaviour. 
> Also, the clients I
> >> have been using would be closing the connection after each 
> request. As
> >> clients I have been using a Python script with urllib, and 
> a little C++
> >> test program I wrote to see if trying a different client made any
> >> difference. It didn't.
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From trengove at econdata.com.au  Thu May 10 08:43:10 2001
From: trengove at econdata.com.au (Chris Trengove)
Date: Fri Jan  9 22:02:43 2004
Subject: [mod_python] Win32 threading issue
In-Reply-To: <000001c0d880$a37d8660$4eb3bd9d@softwareag.com>
References: <200105090830627.SM00265@softwareag.com>
Message-ID: <200105100844681.SM00265@athene>

Stephane,

This is the sort of thing I have been using. I open two console windows and
start the script in both.
	
	import sys
	import time
	import urllib

	URL =
"http://127.0.0.1/python/test.py"
	NUM_GETS = 1000

	start = time.clock()

for i in range(0,NUM_GETS):
    	f = urllib.urlopen(URL)
		print f.read(),

	f.close()
	stop = time.clock()
	elapsed = stop - start
	print "%d GETs in
%.3f seconds = %.0f GETs/second" % (NUM_GETS,elapsed,NUM_GETS / elapsed)

I do not have a multiprocessor machine. I have been wondering whether this
is something to do running these tests on a single (local) machine, rather
than across a network, but when I try the above driver script retrieving a
small text file, everything is OK.

Incidentally, I have now switched to Apache 1.3.19 and still get the same
behaviour.

Chris

At 02:07 PM 9/05/2001 +0200, =?US-ASCII?Q?Stephane_Bidoul?= wrote:
>Chris,
>
>Could you send me your driver script?
>I cannot reproduce the behaviour you describe with
>my own test scripts.
>
>BTW, do you have a multiprocessor machine?
>I know some problems have been reported
>but never reproced on MP WIN2K machines.
>
>-sbi


From trengove at econdata.com.au  Thu May 10 08:45:08 2001
From: trengove at econdata.com.au (Chris Trengove)
Date: Fri Jan  9 22:02:43 2004
Subject: [mod_python] Win32 threading issue
Message-ID: <200105100846110.SM00265@athene>

Stephane,

Sorry, the mail program keeps messing up the formatting of the script, so
here it is as an attachment.

Chris

At 02:07 PM 9/05/2001 +0200, =?US-ASCII?Q?Stephane_Bidoul?= wrote:
>Chris,
>
>Could you send me your driver script?
>I cannot reproduce the behaviour you describe with
>my own test scripts.
>
>BTW, do you have a multiprocessor machine?
>I know some problems have been reported
>but never reproced on MP WIN2K machines.
>
>-sbi
-------------- next part --------------
import sys
import time
import urllib

URL = "http://127.0.0.1/python/test.py"
NUM_GETS = 1000

start = time.clock()
for i in range(0,NUM_GETS):
    f = urllib.urlopen(URL)
    print f.read(),
    f.close()
stop = time.clock()
elapsed = stop - start
print "%d GETs in %.3f seconds = %.0f GETs/second" % (NUM_GETS,elapsed,NUM_GETS / elapsed)
From CHagner at fool.com  Wed May  9 18:51:25 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 22:02:43 2004
Subject: [mod_python] Strange reloading of modules used in handler
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E47DE3@rover.foolhq.com>

I'm seeing some strange things with modules being reloaded when used in
mod_python.

Here's the scenario...
1. I'm using PythonImport to import a module (called MyConfig) and store it
in a module variable.
2. That module variable is being accessed by the registered modpy handler.
3. When I start up apache, MyConfig is imported once for each child process.
4. When I request a page, the handler accesses MyConfig... here's the weird
part.
5. SOMETIMES, it re-runs/imports the module containing MyConfig....
specifically, the first couple requests (6? I have 5 child procs running)
re-import the module and then it stops re-importing... for a while... then,
every once in a while it re-imports MyConfig.

Can some explain this?

Is apache killing off child procs and therefore requiring new python
subinterpreters to start up?  If this is not the case, I'm looking for a way
to keep an object in memory (thus, not have its module re-imported).

Here's my modpy setup if it helps...
        SetHandler python-program
        PythonHandler monty.modpy_handler
        PythonImport demo.MyConfig
        PythonDebug On
        PythonNoReload On
        PythonInterpPerDirectory Off

Thanks in advance...

Chris

From CHagner at fool.com  Wed May  9 19:00:21 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 22:02:43 2004
Subject: [mod_python] empty apache Connection object
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E47DE4@rover.foolhq.com>

Hey there,

Is there a good reason that my Connection object (mp_conn) is empty?  I've
never seen this be populated, but now I'd kind of like some of the
information it provides.

Chris

From gdamjan at mail.net.mk  Wed May  9 03:10:35 2001
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 22:02:43 2004
Subject: [mod_python] Win2k httpd.conf problems
In-Reply-To: <988954502.3af23f8680258@webmail.uchicago.edu>; from dsavitsk@midway.uchicago.edu on Fri, May 04, 2001 at 12:35:02AM -0500
References: <988954502.3af23f8680258@webmail.uchicago.edu>
Message-ID: <20010509031035.A472@local.izmislen.mk>

> I am unable to configure things, and i get the error:
> -------------------------
> Mod_python error: "PythonHandler test"
> 
> Traceback (most recent call last):
> 
>   File "c:\program files\python20\lib\mod_python\apache.py", line 180, in 
> Dispatch
>     object = resolve_object(self.req, module, object_str, silent)
> 
>   File "c:\program files\python20\lib\mod_python\apache.py", line 396, in 
> resolve_object
>     raise AttributeError, s
> 
> AttributeError: module 'c:\program files\python20\lib\test\__init__.pyc' 
> contains no 'handler'
> -------------------------
> 
...
>     <Directory "C:/Apache/cgi-bin">
>         AddHandler python-program .py
>         PythonHandler test

The most common error in the world, and very obvious.
Don't use 'test.py' for your testing script, there is already a package named
'test' in python and mod_python tries to load and execute that one.

You should use something like 'mptest.py' and don't forget to change 
	
	PythonHandler mptest




-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From gdamjan at mail.net.mk  Thu May 10 04:16:05 2001
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 22:02:43 2004
Subject: [mod_python] Strange reloading of modules used in handler
In-Reply-To: <13CDDE6A53DBD311BC3200508B6F0C4805E47DE3@rover.foolhq.com>; from CHagner@fool.com on Wed, May 09, 2001 at 06:51:25PM -0400
References: <13CDDE6A53DBD311BC3200508B6F0C4805E47DE3@rover.foolhq.com>
Message-ID: <20010510041605.A412@local.izmislen.mk>

On Wed, May 09, 2001 at 06:51:25PM -0400, Chris Hagner wrote:
> I'm seeing some strange things with modules being reloaded when used in
> mod_python.
> 
> Here's the scenario...
> 1. I'm using PythonImport to import a module (called MyConfig) and store it
> in a module variable.

I'm not very sure the PythonImport directive works too good, and anyway there's
no need to use it. Just use plain import in the Python scripts.

> 2. That module variable is being accessed by the registered modpy handler.
> 3. When I start up apache, MyConfig is imported once for each child process.
> 4. When I request a page, the handler accesses MyConfig... here's the weird
> part.
> 5. SOMETIMES, it re-runs/imports the module containing MyConfig....
> specifically, the first couple requests (6? I have 5 child procs running)
> re-import the module and then it stops re-importing... for a while... then,
> every once in a while it re-imports MyConfig.

Apache child process die sometimes, either deliberately either not. This causes
your module to be re-imported.

-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From CHagner at fool.com  Wed May  9 23:57:32 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 22:02:43 2004
Subject: [mod_python] Strange reloading of modules used in handler
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E47DE8@rover.foolhq.com>

Thanks, yeah, simply importing the module was my backup plan.  

My motivation is thus: the server running this handler/code is going to be
swamped load-wise and I wanted to be able to use apache's graceful restart
(starting new child procs and swapping them in for the old ones without
dropping a single request) to seamlessly update the application
configuration.

Maybe I'm just being paranoid and the import won't make a graceful restart
drop a connection... I'll be doing some testing to find out just where this
stands.

Again, thanks for the feedback/input.  Much appreciated.

Chris

-----Original Message-----
From: Damjan [mailto:gdamjan@mail.net.mk]
Sent: Wednesday, May 09, 2001 10:16 PM
To: mod_python@modpython.org
Subject: Re: [mod_python] Strange reloading of modules used in handler


On Wed, May 09, 2001 at 06:51:25PM -0400, Chris Hagner wrote:
> I'm seeing some strange things with modules being reloaded when used in
> mod_python.
> 
> Here's the scenario...
> 1. I'm using PythonImport to import a module (called MyConfig) and store
it
> in a module variable.

I'm not very sure the PythonImport directive works too good, and anyway
there's
no need to use it. Just use plain import in the Python scripts.

> 2. That module variable is being accessed by the registered modpy handler.
> 3. When I start up apache, MyConfig is imported once for each child
process.
> 4. When I request a page, the handler accesses MyConfig... here's the
weird
> part.
> 5. SOMETIMES, it re-runs/imports the module containing MyConfig....
> specifically, the first couple requests (6? I have 5 child procs running)
> re-import the module and then it stops re-importing... for a while...
then,
> every once in a while it re-imports MyConfig.

Apache child process die sometimes, either deliberately either not. This
causes
your module to be re-imported.

-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python

From dave at geko.net.au  Thu May 10 23:11:46 2001
From: dave at geko.net.au (David Creelman)
Date: Fri Jan  9 22:02:43 2004
Subject: [mod_python] What is happening here ?
Message-ID: <3AFA9392.CD147616@geko.net.au>

[Thu May 10 23:09:35 2001] [error] PythonHandler myscript: Traceback
(most recent call last):
[Thu May 10 23:09:35 2001] [error] PythonHandler myscript:   File
"/usr/lib/python2.0/site-packages/mod_python/apache.py", line 176, in
Dispatch
    module = import_module(module_name, _req)
[Thu May 10 23:09:35 2001] [error] PythonHandler myscript:   File
"/usr/lib/python2.0/site-packages/mod_python/apache.py", line 331, in
import_module
    f, p, d = imp.find_module(parts[i], path)
[Thu May 10 23:09:35 2001] [error] PythonHandler myscript: ImportError:
No module named myscript

I get this error when I try to run the following script.

from mod_python import apache

def handler(req):
    req.content_type = "text/plain"
    req.send_http_header()
    req.write("Hello World!")

    return apache.OK

Any help appreciated
David


From aiglauer at yahoo.com  Thu May 10 07:18:27 2001
From: aiglauer at yahoo.com (Alexis Iglauer)
Date: Fri Jan  9 22:02:43 2004
Subject: [mod_python] Segfaults and Handler issues
Message-ID: <20010510141827.72440.qmail@web13903.mail.yahoo.com>

Hi

I am migrating an existing mod_python application to a new server -
which involves an entirely new installation of everything including
apache and mod_python.

The new server is running Mandrake 7.2, apache 1.3.14 [old one had
1.3.9] and mod_python 2.7.2 [old: 2.6.2].

I have had multiple (connected) problems.

One of the things I noticed is that in all the mod_python docs the
AddHandler directive is

AddHandler python-program .py

Whereas I use (also on the old, working system)

AddHandler python-program py   <---- No '.' before 'py'

If I put the '.' in, then apache never finds my handler (old and new
system).

On the old system, everything worked once I compiled with -DEAPI (I had
no issues with threading).  On the new setup I get apache SegFaults.  I
compile as a DSO on both systems.

In trying to fix the SegFault problem, I made myself a separate Python
in /usr/local/src/Python-1.5.2 which I compiled without threads.  I
have also compiled mod_python against this non-threaded python version.
 All this has not helped.  The following things occur:

If I run 'httpd -X' (single httpd and you can see the stdout) and I try
to load my webpage in Netscape (running locally) I will sometimes get
"module '/home/slbin/stoploss/slhead' contains no 'handler'" and
sometimes "no module named re" with the error coming out of my slhead
function.

The irritating thing is that the error messages show that I am using
libraries from my normal python installation and not my non-threaded
install.  Is there any way to force mod_python to load a python from a
certain path?

If I run httpd normally, my page(s) - I use multiple frames, each
generated by the same handler based on the URL - will load.

I have "PythonHandler slhead::handler" in my httpd.conf, and my
functions are inside slhead.py

I now know why my handler stops - I get segfaults whenever I try to
access req.connection.remote_ip.  This used to work - has the
apache/mod_python API changed?

Any ideas, especially on why httpd -X doesn't work and how to enforce a
certain python interpreter, would be most welcome.

Regards
Alexis




__________________________________________________
Do You Yahoo!?
Yahoo! Auctions - buy the things you want at great prices
http://auctions.yahoo.com/

From grisha at modpython.org  Thu May 10 14:14:26 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:02:44 2004
Subject: [mod_python] empty apache Connection object
In-Reply-To: <13CDDE6A53DBD311BC3200508B6F0C4805E47DE4@rover.foolhq.com>
Message-ID: <Pine.BSF.4.32.0105101414020.34628-100000@localhost>

Can you elaborate on 'empty'?

On Wed, 9 May 2001, Chris Hagner wrote:

> Hey there,
>
> Is there a good reason that my Connection object (mp_conn) is empty?  I've
> never seen this be populated, but now I'd kind of like some of the
> information it provides.
>
> Chris
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From jvdev at 3va.net  Thu May 10 20:47:26 2001
From: jvdev at 3va.net (Jeroen van Drie)
Date: Fri Jan  9 22:02:44 2004
Subject: [mod_python] mod_python DSO in my config
Message-ID: <01051020382904.01357@e109009>

Hi list,

I've installed mod_python on my rh7.1 test machine as a DSO - works like a 
dream - congrats on the team with an excellent module. However!

I need a bit of help getting this to work on my production server which is a 
RH 6.2 running apache 1.3.12 with as `non-standard' both mod_ssl and 
mod_rewrite compiled in. Other more standard modules such as mod_cgi and 
mod_auth are also compiled into the binary. I've just baked a new apache with 
mod_so compiled in and added:

LoadModule python_module libexec/mod_python.so
AddModule mod_python.c

to the config. (These are the only statements of this type (module 
definitions) in the httpd.conf)

I had apxs remade also and compiling & making the mod_python DSO was a 
success.

when I stop and startssl apache I get the notification that 
[warn] Loaded DSO libexec/mod_python.so uses plain Apache 1.3 API, this 
module might crash under EAPI! (please recompile it with -DEAPI)

Which according to many accounts is no problem. However - there is no 
instance of apache running after the startssl command. Worst of all - there 
is nothing in the logs to indicate why the server doesn't want to start  - 
even if running it with LogLevel debug

If I just start the server without ssl enabled the server is started but 
returns a connection refused upon execution of any binary cgi program. 

Since mod_python should be the first in the LoadModule list maybe the 
assumption that it should be compiled into the binary is valid - or that all 
modules should be DSO's so that mod_python can get first pick. But I have as 
many theories as braincells :)

Thanks & best regards,
Jeroen van Drie.

From gdamjan at mail.net.mk  Fri May 11 02:21:44 2001
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 22:02:44 2004
Subject: [mod_python] What is happening here ?
In-Reply-To: <3AFA9392.CD147616@geko.net.au>; from dave@geko.net.au on Thu, May 10, 2001 at 11:11:46PM +1000
References: <3AFA9392.CD147616@geko.net.au>
Message-ID: <20010511022144.A499@local.izmislen.mk>

...

> No module named myscript
> 
> I get this error when I try to run the following script.
> 
...

How is Apache setup, and where is the 'myscript.py' script located?
It seems that mod_python can't find your 'myscript.py' file.

-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From rbunke at helios.acomp.usf.edu  Thu May 10 20:38:40 2001
From: rbunke at helios.acomp.usf.edu (Rick Bunke)
Date: Fri Jan  9 22:02:44 2004
Subject: [mod_python] I can't get apache to handle a .py file
Message-ID: <Pine.GSO.4.21.0105101911530.26528-100000@nova.acomp.usf.edu>

Hello,

I'm stuck.  I've read the FAQ.  I've read mod_python Manuel up to 2.4
testing your new installation.  I've followed the directions there for
mptest.py but all apache will do for me is serve up the text file
mptest.py.  It wont hand it off to mod_python.  I compiled the mod into
apache as static not DSO. 

I'll be glad to send the bulk of my config file if requested to do so but
here is what I think is the important stuff.

httpd.conf
#------ 
LogLevel debug

DocumentRoot "/home/myhome/Text/Web"

#I was just trying to turn every thing on here while I was troubleshouting
#this problem...
<Directory "/">
        Options All +MultiViews
</Directory>

# Python stuff according to mod_python manuel
<Directory "/home/myhome/Texts/Web/pytest">
        AddHandler python-program .py
        PythonHandler mptest
        PythonDebug On
</Directory>
#--------

the config file is basically identical to apache default config
file with the specific site info changed.

[black_box]cat mptest.py
from mod_python import apache
    
def handler(req):
        req.send_http_header()
        req.write("Hello World!")
        return apache.OK

[black_box]ls -l mptest.py
-rwxr-xr-x    1 rick     rick          123 May 10 19:35 mptest.py*

I wasn't sure if mptest.py was suppose to be excutable or not so I it
made it excutable just in case.

when I put a "#!/usr/local/python" in at the top and run it stand alone, 
it doesn't like the "import _apache" line which doesn't really surprise me
sense I don't think your suppose to run it like that :)  I was just trying
to figure what was wrong sense I get no errors in my error.log 

When I type "http://myip/pytest/mptest.py" in web my browser, it displays 
the text file:

from mod_python import apache
    
def handler(req):
	req.send_http_header()
	req.write("Hello World!")
	return apache.OK


Also, when I compiled apache, it failed in the mod_python directory saying
some functions (openpty and forkpty) were "undefined references" so I had
to add "-lutil" to the 
"LIBS="$LIBS -lm /usr/local/src/Python-2.1c2/libpython2.1.a"" 
line in the libpython.module config file, rerun configure, and then it
would compile ok.  possable bug in the configure scripts, or my setup, I
don't know which.

I run Linux 2.4.4
Python 2.1c2 
Apache 1.3.19
Mod_Python 2.7.2

Please help me :)

Thanks
Rick

we enjoy great advantages from the inventions of others, we should be 
glad of an opportunity to serve others by any invention of ours; and 
this we should do freely and generously.
		- Ben Franklin (declining to take out a patent on the
				Franklin Stove)

Whenever there is a conflict between human rights and property rights, 
human rights must prevail.
	           - Abraham Lincoln
	
Information is the currency of democracy.
		   - Thomas Jefferson


From rdevide at ican.at  Fri May 11 09:52:49 2001
From: rdevide at ican.at (Devide Robert)
Date: Fri Jan  9 22:02:44 2004
Subject: [mod_python] I can't get apache to handle a .py file
References: <Pine.GSO.4.21.0105101911530.26528-100000@nova.acomp.usf.edu>
Message-ID: <3AFB9A51.657A4723@ican.at>

Rick Bunke wrote:

> DocumentRoot "/home/myhome/Text/Web"
 :
> <Directory   "/home/myhome/Texts/Web/pytest">

Text <-> Texts ???

dave

From rbunke at helios.acomp.usf.edu  Sat May 12 16:12:43 2001
From: rbunke at helios.acomp.usf.edu (Rick Bunke)
Date: Fri Jan  9 22:02:44 2004
Subject: [mod_python] I can't get apache to handle a .py file
In-Reply-To: <3AFB9A51.657A4723@ican.at>
Message-ID: <Pine.GSO.4.21.0105121605430.4178-100000@nova.acomp.usf.edu>

On Fri, 11 May 2001, Devide Robert wrote:
                                
> Rick Bunke wrote:
>
> > DocumentRoot "/home/myhome/Text/Web"
>  :
> > <Directory   "/home/myhome/Texts/Web/pytest">
>
> Text <-> Texts ???
>
> dave
>

Thanks, It works now.
That was the annoying little detail that I've been overlooking and
pulling my hair out over for three days now while thinking, it can't be
this hard!  :)

Thank You, again 
Rick

we enjoy great advantages from the inventions of others, we should be 
glad of an opportunity to serve others by any invention of ours; and 
this we should do freely and generously.
		- Ben Franklin (declining to take out a patent on the
				Franklin Stove)

Whenever there is a conflict between human rights and property rights, 
human rights must prevail.
	           - Abraham Lincoln
	
Information is the currency of democracy.
		   - Thomas Jefferson



From dave at geko.net.au  Mon May 14 22:34:29 2001
From: dave at geko.net.au (David Creelman)
Date: Fri Jan  9 22:02:44 2004
Subject: [mod_python] What is happening here ?
References: <3AFA9392.CD147616@geko.net.au> <20010511022144.A499@local.izmislen.mk>
Message-ID: <3AFFD0D5.9B0A08A2@geko.net.au>

Hi Damjan,

myscript.py is in /var/www/cgi-bin. I'm running Mandrake 8.0.

Should it go somewhere else ?

Cheers
David

Damjan wrote:

> ...
>
> > No module named myscript
> >
> > I get this error when I try to run the following script.
> >
> ...
>
> How is Apache setup, and where is the 'myscript.py' script located?
> It seems that mod_python can't find your 'myscript.py' file.
>
> --
> Damjan Georgievski              |           ???????~???? ??????????????????????
> Skopje, Macedonia               |           ?????????~??, ?????????????????~??
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From petar at metamarkets.com  Mon May 14 08:38:52 2001
From: petar at metamarkets.com (Petar Karafezov)
Date: Fri Jan  9 22:02:44 2004
Subject: [mod_python] RE: setting multiple cookies with req.headers_out
Message-ID: <86FC34EA3C4F074AA6BBFFE52ED83FED27C1D5@METAEXCH.sfo.metamarkets.com>

Hello all -

I am trying to send more than one cookie in my req.headers_out. The problem
is that req.headers_out is a dictionary - and if I want to send more than 1
cookie - only the last one gets send - they all have key 'Set-cookie'.

I am sure there's a quick and easy solution for this ...I just didn't see
it. Could anyone share ideas/experience on this issue ?

Thanks!

Regards to all,
Petar Karafezov

MetaMarkets.com
415-575-3015
-------------------------------------------
Investing Out Loud at
http://www.metamarkets.com
-------------------------------------------

From miguel at yorku.ca  Mon May 14 11:57:09 2001
From: miguel at yorku.ca (Miguel Marques)
Date: Fri Jan  9 22:02:44 2004
Subject: [mod_python] RE: setting multiple cookies with req.headers_out
In-Reply-To: <86FC34EA3C4F074AA6BBFFE52ED83FED27C1D5@METAEXCH.sfo.metamarkets.com>
References: <86FC34EA3C4F074AA6BBFFE52ED83FED27C1D5@METAEXCH.sfo.metamarkets.com>
Message-ID: <20010514115709Y.miguel@yorku.ca>

Greetings...
On Mon, 14 May 2001 08:38:52 -0700, Petar Karafezov <petar@metamarkets.com> wrote:
> Hello all -
> 
> I am trying to send more than one cookie in my req.headers_out. The problem
> is that req.headers_out is a dictionary - and if I want to send more than 1
> cookie - only the last one gets send - they all have key 'Set-cookie'.
> 
> I am sure there's a quick and easy solution for this ...I just didn't see
> it. Could anyone share ideas/experience on this issue ?
> 
Just use 

req.headers_out.add('Set-Cookie', ...)

as many time as you need.

						Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830




From grisha at modpython.org  Mon May 14 13:09:09 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:02:44 2004
Subject: [mod_python] RE: setting multiple cookies with req.headers_out
In-Reply-To: <86FC34EA3C4F074AA6BBFFE52ED83FED27C1D5@METAEXCH.sfo.metamarkets.com>
Message-ID: <Pine.BSF.4.32.0105141308590.97224-100000@localhost>


http://www.modpython.org/live/mod_python-2.7.3/doc-html/pyapi-mptable.html



On Mon, 14 May 2001, Petar Karafezov wrote:

> Hello all -
>
> I am trying to send more than one cookie in my req.headers_out. The problem
> is that req.headers_out is a dictionary - and if I want to send more than 1
> cookie - only the last one gets send - they all have key 'Set-cookie'.
>
> I am sure there's a quick and easy solution for this ...I just didn't see
> it. Could anyone share ideas/experience on this issue ?
>
> Thanks!
>
> Regards to all,
> Petar Karafezov
>
> MetaMarkets.com
> 415-575-3015
> -------------------------------------------
> Investing Out Loud at
> http://www.metamarkets.com
> -------------------------------------------
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From grisha at modpython.org  Mon May 14 17:25:07 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:02:44 2004
Subject: [mod_python] problem with publisher.py File class w/ possible
 fix
In-Reply-To: <A9DFD9380C01D4118E740050DA7A89703860FA@becomm-mis2.becomm.com>
Message-ID: <Pine.BSF.4.32.0105141722420.99402-100000@localhost>

Marc -

Do you have any more details so I could reproduce this error? I am having
a hard time understanding why it would insist on m being an integer.
Perhaps you have the piece of code that caused it?

Grisha


On Wed, 21 Mar 2001, Marc Fiuczynski wrote:

> Hi,
>
> I am having a problem with the publisher.py File class, which I have fixed,
> but I would like your approval.
>
> My configuration is as follows:
> mod_python 2.7.2
> python 2.0
> apache 1.3.14
> Red Hat Linux 7.0
>
> I am using mod python to do http_post operations with files.  This uses the
> publisher.py File class.  The __init__ method of that class steals all of
> the file-like methods, as shown below:
>
>         # steal all the file-like methods
>         methods = field.file.__methods__
>         for m in methods:
>             self.__dict__[m] = methods[m]
>
> I was getting an error in that last line saying that 'm' needed to be an
> int.  (Sorry, I forget the actual error).  I found some other code that was
> doing the exact same thing and noticed that they were assigning the methods
> in a different manner (using setattr).  See below:
>
>         # steal all the file-like methods
>         file = field.file
>         for method in file.__methods__:
>             setattr(self, method, getattr(file, method))
>
> This seems to work.  I am too nascent to Python to understand the history of
> the built-in __xyz__ fields in objects, and whether this is something
> specific to Python 2.0 versus an older version of Python.  Please review and
> if it is the right thing, then feel free to incorporate this change into
> your mod_python code base.
>
> Cheers,
> Marc
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From SumnerH at fool.com  Mon May 14 18:33:44 2001
From: SumnerH at fool.com (G . Sumner Hayes)
Date: Fri Jan  9 22:02:44 2004
Subject: [mod_python] PythonImport question
Message-ID: <20010514183344.A6813@fool.com>

Brief version:
I have a patch to make PythonImport take place during server init
instead of child init--is there any chance it would be accepted?

Long version:
So the PythonImport documentation says:

: Tells the server to import the Python module module at process
: startup. This is useful for initialization tasks that could be
: time consuming and should not be done at the request processing
: time, e.g. initializing a database connection.
:
: The import takes place at child process initialization, so the
: module will actually be imported once for every child process
: spawned.

Having the import take place at every child process
initialization seems to run counter to the purpose of the
statement (doing time consuming server startup stuff).  It
also makes the various children have potentially different
PythonImport'd contents if the module(s) imported that way
are edited in place.

I'm wondering if anyone actually wants that behavior; it seems
like it'd be better to do the PythonImport exactly once at server
startup.

Rationale 1:
Suppose I have a ton of expensive startup work to do in my
PythonImport lines.  Furthermore, I need to be able to do
apache graceful restarts even while under heavy load.  Here's
a sketch of how the apache graceful restarts work--I'll pretend
there are 3 different types of apache process, a "master control
program" or MCP which coordinates startup, a "pool master" or
PM which spawns children as needed, and the child processes
or CPs.

1.  A user sends MCP a SIGUSR1 signal indicating a graceful
restart should take place.  The old PM and CPs continue
handling incoming requests.
2.  MCP starts up a new PM, which reads all startup files and
processes them; this includes running the server init functions
for apache modules (in particular mod_python).
3.  New PM finishes reading startup and fork()s off new CPs (as
per the MinSpareServers and related apache directives).  After
forking new CPs, the new PM tells the MCP that it is ready to
go.
4.  MCP tells old PM to shut down and routes all new incoming
requests to the new PM. 
5.  Old PM tells old CPs to exit; if they're idle, they exit
immediately.  If they're serving a request, they finish doing
so and then exit.

Pretty elegant; you can change the entire apache config on the
fly without dropping any connections.  You can even update shared
objects this way without dropping connections; you can e.g.
migrate from python 1.5.2 to Stackless Python 2.0 (potentially
with a new version of mod_python) seamlessly.

_However_, step (3) gets us in trouble if PythonImports happen
in the child process--the old PM will be exiting while the new
CPs are busy doing whatever (potentially many-second or evan
minute-long) the PythonImports say to do.

If PythonImports took place in the server init, they'd get done
before the new PM/CPs took over; the old ones would continue
serving requests until the new ones were ready.

(Yes, the setup involved will have high-availability measures
in place, but it'd be really nice to have this feature for a
number of reasons).

Rationale 2:
It's far more "apache-like" for configuration data to be read
exactly 1 time at startup and then re-read when explicitly asked
to do so (via a graceful restart).  As it stands now, if I'm
importing mystuff.py via PythonImport and I edit that file while
the server is running, some apache children (which started before
my edits) will have the old mystuff module and others (which
happened to start after my edits) will have the new one.  That's
confusing and potentially dangerous, and if I'm editing files
in place (groan, I know) it's full of nasty races.

Let me know and I'll send a patch.

  Sumner

-- 
rage, rage against the dying of the light

From CHagner at fool.com  Tue May 15 11:00:58 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 22:02:44 2004
Subject: [mod_python] empty apache Connection object
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E47E1D@rover.foolhq.com>

Sorry for vague statement... here's what I'm seeing when I print out the
Connection object and its attributes.  As you can see, there does appear to
be an mp_conn object present, but all attributes/methods return 'None'.
Thoughts?  Let me know if there's something more valuable I can do to
determine the state of the object.  Thanks.

REQUEST'S CONNECTION'S VALUES
conn: <mp_conn object at 0x87ad968>
child num: None
local address: None
remote address: None
remote ip: None
remote host: None
remote logname: None
user name: None
auth type: None
keep alives: None
local ip: None
local host: None

Chris

-----Original Message-----
From: Gregory (Grisha) Trubetskoy [mailto:grisha@modpython.org]
Sent: Thursday, May 10, 2001 2:14 PM
To: Chris Hagner
Cc: 'mod_python@modpython.org'
Subject: Re: [mod_python] empty apache Connection object



Can you elaborate on 'empty'?

On Wed, 9 May 2001, Chris Hagner wrote:

> Hey there,
>
> Is there a good reason that my Connection object (mp_conn) is empty?  I've
> never seen this be populated, but now I'd kind of like some of the
> information it provides.
>
> Chris
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>

From CHagner at fool.com  Fri May 18 13:45:05 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 22:02:44 2004
Subject: [mod_python] several mod_python issues
Message-ID: <200105182250.SAA27068@monkeyboy.dorc.foolhq.com>

While working with mod_python lately, we've noticed a couple of
inconsistencies with the documentation and also have a few 
comments/questions on intended behavior and whether certain behavior 
was intended or is just a bug.

1. The PythonNoReload directive is a bit confusing and does not provide
   an option that would also be useful. "PythonNoReload Off" performs a
   full reload/import of the pyhandler on every request.
   "PythonNoReload On" only performs a reload/import when the mtime
   of the handler has changed. We would like to also propose an
   additional option to "never" reload/import the handler except upon
   initial startup of the child process. This would allow for a more
   controlled re-initialization of the server(s) via an apache graceful
   restart.

2. Modules pre-loaded via the PythonImport directive do not appear to be
   readily available in the handler. We've verified that Python Import
   and the handler are running in the same interpreter space by passing
   info via global classes such as Exception, but we can't find the
   modules loaded via PythonImport. They must be somewhere, but just
   can't seem to locate them... What is the expected way to access
   modules that have been pre-loaded via PythonImport from within code
   such as the handler?

3. As detailed in an earlier post from Sumner Hayes, mod_python does not
   perform as expected/desired on a apache graceful restart.
   Essentially, new children are spawned and declared ready to the
   parent before they can actually serve requests (ie still initilizing
   any PythonImport directives). The mod_python directives should be
   fully processed before considering the child ready to serve requests.

This isn't meant as just a rant. Just some things that we've noticed
that are important in our environment. We're willing to help with fixes,
etc., but wanted to make sure we had a full perspective on all the
issues at hand before attacking this stuff. 

Please let us know what you think about the observations listed above.
Thanks.

-- 
Stephan Koledin
Mad Scientist
The Motley Fool
http://fool.com



From grisha at modpython.org  Sat May 19 00:38:41 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:02:44 2004
Subject: [mod_python] several mod_python issues
In-Reply-To: <200105182250.SAA27068@monkeyboy.dorc.foolhq.com>
Message-ID: <Pine.BSF.4.32.0105190031400.54052-100000@localhost>

On Fri, 18 May 2001, Chris Hagner wrote:

> While working with mod_python lately, we've noticed a couple of
> inconsistencies with the documentation and also have a few
> comments/questions on intended behavior and whether certain behavior
> was intended or is just a bug.
>
> 1. The PythonNoReload directive is a bit confusing and does not provide
>    an option that would also be useful. "PythonNoReload Off" performs a
>    full reload/import of the pyhandler on every request.
>    "PythonNoReload On" only performs a reload/import when the mtime
>    of the handler has changed. We would like to also propose an
>    additional option to "never" reload/import the handler except upon
>    initial startup of the child process. This would allow for a more
>    controlled re-initialization of the server(s) via an apache graceful
>    restart.

This one is a BUG that seems to have been introduced in 2.7.3 releases
while trying to fix another one....

The remaining two issues are just a big mess because I never gave any
priority to PythonImport. The only catch with Summer Hayes's approach is
that stuff will run as root, which to me seems kind of bad. (I haven't
seen the patch, so this is part speculation)

Grisha

> 2. Modules pre-loaded via the PythonImport directive do not appear to be
>    readily available in the handler. We've verified that Python Import
>    and the handler are running in the same interpreter space by passing
>    info via global classes such as Exception, but we can't find the
>    modules loaded via PythonImport. They must be somewhere, but just
>    can't seem to locate them... What is the expected way to access
>    modules that have been pre-loaded via PythonImport from within code
>    such as the handler?
>
> 3. As detailed in an earlier post from Sumner Hayes, mod_python does not
>    perform as expected/desired on a apache graceful restart.
>    Essentially, new children are spawned and declared ready to the
>    parent before they can actually serve requests (ie still initilizing
>    any PythonImport directives). The mod_python directives should be
>    fully processed before considering the child ready to serve requests.
>
> This isn't meant as just a rant. Just some things that we've noticed
> that are important in our environment. We're willing to help with fixes,
> etc., but wanted to make sure we had a full perspective on all the
> issues at hand before attacking this stuff.
>
> Please let us know what you think about the observations listed above.
> Thanks.
>
> --
> Stephan Koledin
> Mad Scientist
> The Motley Fool
> http://fool.com
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From teepwalla at yahoo.com  Fri May 18 21:51:21 2001
From: teepwalla at yahoo.com (Prateep Siamwalla)
Date: Fri Jan  9 22:02:44 2004
Subject: [mod_python] mod_python and locale
Message-ID: <20010519045121.32984.qmail@web14306.mail.yahoo.com>

Hi All,

I've come across a problem with mod_python (2.7.2
compiled with Python 2.0 --with-threads=no) on Linux
(RH 7.0) regarding locale.

the following code (mptest.py):
-----------------
from mod_python import apache
from locale import setlocale,LC_ALL,format


def handler(req):
    req.content_type = "text/plain"
    req.send_http_header()
    setlocale(LC_ALL,'')
    a = 123123231.323    
    req.write("The formatted version of the number %s
is %s" % (a,format('%.2f',a,1)))
    return apache.OK

Produces:
----------------------
The formatted version of the number 123123231.323 is
123123231.32

Rather than the expected
-----------------------
....123,123,231.32

I don't have any problems with locale formating on
Win98+Apache+Python2.0.  Is this a recognized problem?

I've tried locale formating from the Python 2.0
command line on the Linux box and it yields expected
results ( 123,123,231.32)

I've tried locale formating from the compiled
Python2.0 with no threads binary on the Linux box and
it also yields expected results.

Its only on mod_python am I encountering a lack of
correct formating.

Have others encountered this problem?

Thanks in advance.
teep


__________________________________________________
Do You Yahoo!?
Yahoo! Auctions - buy the things you want at great prices
http://auctions.yahoo.com/

From gdamjan at mail.net.mk  Sat May 19 12:03:10 2001
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 22:02:44 2004
Subject: [mod_python] What is happening here ?
In-Reply-To: <3AFFD0D5.9B0A08A2@geko.net.au>; from dave@geko.net.au on Mon, May 14, 2001 at 10:34:29PM +1000
References: <3AFA9392.CD147616@geko.net.au> <20010511022144.A499@local.izmislen.mk> <3AFFD0D5.9B0A08A2@geko.net.au>
Message-ID: <20010519120310.A256@local.izmislen.mk>

On Mon, May 14, 2001 at 10:34:29PM +1000, David Creelman wrote:
> > ...
> >
> > > No module named myscript
> > >
> > > I get this error when I try to run the following script.
> > >
> > ...
> >
> > How is Apache setup, and where is the 'myscript.py' script located?
> > It seems that mod_python can't find your 'myscript.py' file.
>
> myscript.py is in /var/www/cgi-bin. I'm running Mandrake 8.0.
> 
> Should it go somewhere else ?

Yes! Put it somewhere in the python search path.

Also you should probably reread the mod_python documentation. 
mod_python is not related to CGI scripts, but is a scripting engine
inside the apache process. You can do much more with mod_python than
with CGI.

-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From dyeung at ust.hk  Sat May 19 19:45:43 2001
From: dyeung at ust.hk (David Yeung)
Date: Fri Jan  9 22:02:44 2004
Subject: [mod_python] Modules with identical name in different directories
Message-ID: <3B065CE7.2BD9F0CA@ust.hk>

If I have two different python modules with identical name (index.py), e.g.:

   http://host/pytest1/index.py/mainpage

and

   http://host/pytest2/index.py/mainpage

When I access the first index.py module, the mod_python import the first index.py.
Then I switch to access the second index.py. Will the mod_python know it is a
different module with the first one, and then import the second 'index.py' 
automatically? Or it will use the already imported 'index.py' module?

Thanks

david

From grisha at modpython.org  Sat May 19 13:35:58 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:02:44 2004
Subject: [mod_python] Modules with identical name in different directories
In-Reply-To: <3B065CE7.2BD9F0CA@ust.hk>
Message-ID: <Pine.BSF.4.32.0105191334130.62711-100000@localhost>

On Sat, 19 May 2001, David Yeung wrote:

> If I have two different python modules with identical name (index.py), e.g.:
>
>    http://host/pytest1/index.py/mainpage
>
> and
>
>    http://host/pytest2/index.py/mainpage
>
> When I access the first index.py module, the mod_python import the first index.py.
> Then I switch to access the second index.py. Will the mod_python know it is a
> different module with the first one, and then import the second 'index.py'
> automatically? Or it will use the already imported 'index.py' module?

By default it will use already imported index.py module. But you can use
the PythonInterpPerDirectory, in which case the two would run in separate
subinterpreters.

Grisha


From alain at onesite.org  Sun May 20 04:45:02 2001
From: alain at onesite.org (=?iso-8859-1?Q?Alain_T=E9sio?=)
Date: Fri Jan  9 22:02:44 2004
Subject: [mod_python] When trying to get cgi.FieldStorage() : AttributeError: 'sys' module has no attribute 'argv'
Message-ID: <001101c0e0d6$df62ef40$400110ac@alain>

Hi, I found a message in an archive saying I shouldn't use
FieldStorage with publisher
http://www.modpython.org/pipermail/mod_python/2001-January/001086.html
but I'm not using publisher (or I don't know I am)
Any idea what's happening ?

Thanks
Alain

=========== observer_www.py
import cgi
items=cgi.FieldStorage()

=========== output

Mod_python error: "PythonHandler observer_www"

Traceback (most recent call last):

  File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line
176, in Dispatch
    module = import_module(module_name, _req)

  File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line
340, in import_module
    module = imp.load_module(mname, f, p, d)

  File "/home/observer/scripts/observer_www.py", line 2, in ?
    items=cgi.FieldStorage()

  File "/usr/local/lib/python2.1/cgi.py", line 445, in __init__
    elif sys.argv[1:]:

AttributeError: 'sys' module has no attribute 'argv'



From grisha at modpython.org  Sun May 20 01:17:35 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:02:44 2004
Subject: [mod_python] When trying to get cgi.FieldStorage() : AttributeError:
 'sys' module has no attribute 'argv'
In-Reply-To: <001101c0e0d6$df62ef40$400110ac@alain>
Message-ID: <Pine.BSF.4.32.0105200111390.67081-100000@localhost>

This is because indeed the sys module has no attribute argv inside
subinterpreters. This is a "feature not a bug" and is documented somewhere
in the Python docs.

If you're using the cgi module, just fake the the argv by doing something
like:

import sys
sys.argv = []

then cgi module will be happy.

Grisha

On Sun, 20 May 2001, [iso-8859-1] Alain T?sio wrote:

> Hi, I found a message in an archive saying I shouldn't use
> FieldStorage with publisher
> http://www.modpython.org/pipermail/mod_python/2001-January/001086.html
> but I'm not using publisher (or I don't know I am)
> Any idea what's happening ?
>
> Thanks
> Alain
>
> =========== observer_www.py
> import cgi
> items=cgi.FieldStorage()
>
> =========== output
>
> Mod_python error: "PythonHandler observer_www"
>
> Traceback (most recent call last):
>
>   File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line
> 176, in Dispatch
>     module = import_module(module_name, _req)
>
>   File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line
> 340, in import_module
>     module = imp.load_module(mname, f, p, d)
>
>   File "/home/observer/scripts/observer_www.py", line 2, in ?
>     items=cgi.FieldStorage()
>
>   File "/usr/local/lib/python2.1/cgi.py", line 445, in __init__
>     elif sys.argv[1:]:
>
> AttributeError: 'sys' module has no attribute 'argv'
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From emailreklama at yahoo.com  Sun May 20 21:09:15 2001
From: emailreklama at yahoo.com (EmailReklama)
Date: Fri Jan  9 22:02:44 2004
Subject: [mod_python] E-MAIL 
Message-ID: <033300912171451SERVER@server>

????????? ???????? ????? ??????? ?? e-mail ?????:

?????? - 28000 ????? ??????.
?????? - 300000 ?? ??? 30% ???????????, 50% ?????????? ??????.

????????? ???????? 2 ??????? ??? ?? 1000 ?????.

??????????????? ?????.

From alain at onesite.org  Sun May 20 19:39:45 2001
From: alain at onesite.org (Alain Tesio)
Date: Fri Jan  9 22:02:44 2004
Subject: [mod_python] When trying to get cgi.FieldStorage() : AttributeError: 'sys' module has no attribute 'argv'
References: <Pine.BSF.4.32.0105200111390.67081-100000@localhost>
Message-ID: <004401c0e153$dccc8520$400110ac@alain>

Thanks for the information, but how can I get the GET parameters then ?
The usual cgi variables aren't in os.environ

Alain

----- Original Message -----
From: "Gregory (Grisha) Trubetskoy" <grisha@modpython.org>
To: "Alain Tesio" <alain@onesite.org>
Cc: "ML mod_python" <mod_python@modpython.org>
Sent: Sunday, May 20, 2001 7:17 AM
Subject: Re: [mod_python] When trying to get cgi.FieldStorage() :
AttributeError: 'sys' module has no attribute 'argv'


>
> This is because indeed the sys module has no attribute argv inside
> subinterpreters. This is a "feature not a bug" and is documented somewhere
> in the Python docs.
>
> If you're using the cgi module, just fake the the argv by doing something
> like:
>
> import sys
> sys.argv = []
>
> then cgi module will be happy.
>
> Grisha
>
> On Sun, 20 May 2001, [iso-8859-1] Alain T?sio wrote:
>
> > Hi, I found a message in an archive saying I shouldn't use
> > FieldStorage with publisher
> > http://www.modpython.org/pipermail/mod_python/2001-January/001086.html
> > but I'm not using publisher (or I don't know I am)
> > Any idea what's happening ?
> >
> > Thanks
> > Alain
> >
> > =========== observer_www.py
> > import cgi
> > items=cgi.FieldStorage()
> >
> > =========== output
> >
> > Mod_python error: "PythonHandler observer_www"
> >
> > Traceback (most recent call last):
> >
> >   File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py",
line
> > 176, in Dispatch
> >     module = import_module(module_name, _req)
> >
> >   File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py",
line
> > 340, in import_module
> >     module = imp.load_module(mname, f, p, d)
> >
> >   File "/home/observer/scripts/observer_www.py", line 2, in ?
> >     items=cgi.FieldStorage()
> >
> >   File "/usr/local/lib/python2.1/cgi.py", line 445, in __init__
> >     elif sys.argv[1:]:
> >
> > AttributeError: 'sys' module has no attribute 'argv'
> >
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://www.modpython.org/mailman/listinfo/mod_python
> >


From grisha at modpython.org  Sun May 20 20:22:20 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:02:44 2004
Subject: [mod_python] When trying to get cgi.FieldStorage() : AttributeError:
 'sys' module has no attribute 'argv'
In-Reply-To: <004401c0e153$dccc8520$400110ac@alain>
Message-ID: <Pine.BSF.4.32.0105202021500.75359-100000@localhost>

Try reading the manual:

http://www.modpython.org/live/mod_python-2.7.3/doc-html/pyapi-util-fstor.html

On Sun, 20 May 2001, Alain Tesio wrote:

> Thanks for the information, but how can I get the GET parameters then ?
> The usual cgi variables aren't in os.environ
>
> Alain
>
> ----- Original Message -----
> From: "Gregory (Grisha) Trubetskoy" <grisha@modpython.org>
> To: "Alain Tesio" <alain@onesite.org>
> Cc: "ML mod_python" <mod_python@modpython.org>
> Sent: Sunday, May 20, 2001 7:17 AM
> Subject: Re: [mod_python] When trying to get cgi.FieldStorage() :
> AttributeError: 'sys' module has no attribute 'argv'
>
>
> >
> > This is because indeed the sys module has no attribute argv inside
> > subinterpreters. This is a "feature not a bug" and is documented somewhere
> > in the Python docs.
> >
> > If you're using the cgi module, just fake the the argv by doing something
> > like:
> >
> > import sys
> > sys.argv = []
> >
> > then cgi module will be happy.
> >
> > Grisha
> >
> > On Sun, 20 May 2001, [iso-8859-1] Alain T?sio wrote:
> >
> > > Hi, I found a message in an archive saying I shouldn't use
> > > FieldStorage with publisher
> > > http://www.modpython.org/pipermail/mod_python/2001-January/001086.html
> > > but I'm not using publisher (or I don't know I am)
> > > Any idea what's happening ?
> > >
> > > Thanks
> > > Alain
> > >
> > > =========== observer_www.py
> > > import cgi
> > > items=cgi.FieldStorage()
> > >
> > > =========== output
> > >
> > > Mod_python error: "PythonHandler observer_www"
> > >
> > > Traceback (most recent call last):
> > >
> > >   File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py",
> line
> > > 176, in Dispatch
> > >     module = import_module(module_name, _req)
> > >
> > >   File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py",
> line
> > > 340, in import_module
> > >     module = imp.load_module(mname, f, p, d)
> > >
> > >   File "/home/observer/scripts/observer_www.py", line 2, in ?
> > >     items=cgi.FieldStorage()
> > >
> > >   File "/usr/local/lib/python2.1/cgi.py", line 445, in __init__
> > >     elif sys.argv[1:]:
> > >
> > > AttributeError: 'sys' module has no attribute 'argv'
> > >
> > >
> > > _______________________________________________
> > > Mod_python mailing list
> > > Mod_python@modpython.org
> > > http://www.modpython.org/mailman/listinfo/mod_python
> > >
>


From gdamjan at mail.net.mk  Tue May 22 01:32:22 2001
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 22:02:44 2004
Subject: [mod_python] mod_python and locale
In-Reply-To: <20010519045121.32984.qmail@web14306.mail.yahoo.com>; from teepwalla@yahoo.com on Fri, May 18, 2001 at 09:51:21PM -0700
References: <20010519045121.32984.qmail@web14306.mail.yahoo.com>
Message-ID: <20010522013222.A259@local.izmislen.mk>

> I've come across a problem with mod_python (2.7.2
> compiled with Python 2.0 --with-threads=no) on Linux
> (RH 7.0) regarding locale.
> 
> the following code (mptest.py):
> -----------------
> from mod_python import apache
> from locale import setlocale,LC_ALL,format
> 
> 
> def handler(req):
>     req.content_type = "text/plain"
>     req.send_http_header()
>     setlocale(LC_ALL,'')

This command set the locale to the one specified with the LC_xx or LANG
enviroment variables.

>     a = 123123231.323    
>     req.write("The formatted version of the number %s
> is %s" % (a,format('%.2f',a,1)))
>     return apache.OK
> 
> Produces:
> ----------------------
> The formatted version of the number 123123231.323 is
> 123123231.32
> 
> Rather than the expected
> -----------------------
> ....123,123,231.32

When you run your scripts interactively you have defined some locale by the
LC_xxx or the LANG variable. On the other side, it seems that your Apache 
process is using the default locale (C), so that's why the formating looks 
like that.

I would use -- setlocale(LC_ALL,'mk_MK') -- to get macedonian localization in
python scripts, but perhaps you would like to change this on a per user 
preference.



-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From teep at inet.co.th  Tue May 22 19:39:11 2001
From: teep at inet.co.th (Prateep Siamwalla)
Date: Fri Jan  9 22:02:44 2004
Subject: [mod_python] mod_python and locale
Message-ID: <002901c0e2bc$39d40860$0c05a8c0@taramansion.bangkok>

Yes!!! Thanks alot, Damjam....shame on me for not reading the docs on locale
more closely.

teep




From sam at webslingerZ.com  Tue May 22 09:55:58 2001
From: sam at webslingerZ.com (Sam Brauer)
Date: Fri Jan  9 22:02:44 2004
Subject: [mod_python] ANN: new release of maki
Message-ID: <Pine.LNX.4.31.0105220955150.1926-100000@localhost.localdomain>

I've released a new version of maki at http://maki.sourceforge.net

maki is a mod_python handler which uses various 4Suite components to serve
XML with Apache.  It allows a web developer to specify processing rules
based on path-matching regular expressions.  Each rule describes a
pipeline with any number of XSLT steps and/or custom processing steps.  A
processor that evaluates embedded Python source to dynamically modify the
document is included.  maki also supports time-based caching of output.
Also included are two example "logicsheets": one that adds HTTP request
data to the document and another that executes SQL queries and creates
elements from the results.

The overall functionality is similar (though intentionally not identical)
to Cocoon.

For more info, please take a look at the online documentation at
http://maki.sourceforge.net/manual/

Thank you,
Sam

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Sam Brauer : sbrauer@users.sourceforge.net



From dyeung at ust.hk  Wed May 23 15:14:05 2001
From: dyeung at ust.hk (David YEUNG)
Date: Fri Jan  9 22:02:44 2004
Subject: [mod_python] How to set the header 'Content-Disposition:'
Message-ID: <3B0B633D.AEBD803D@ust.hk>

I want to set the header 'Content-Disposition:' field. How can I do that
in the publisher handler.

Thanks

david

From pdeluca at sia.net.au  Thu May 24 21:13:07 2001
From: pdeluca at sia.net.au (Paul De Luca)
Date: Fri Jan  9 22:02:45 2004
Subject: [mod_python] mod python apache problem
Message-ID: <4.3.2.7.2.20010524211137.00acd710@mail.sia.net.au>

Hi,
      I am having some troubles trying to install mod_python onto my home 
PC running Windows ME (hey, its for testing purposes!). I followed the 
directions in the mod python documentation (changing the path when 
necessary). However when I try and start Apache I get the following error:

Syntax error on line 203 of c:/data/apache/conf/httpd.conf:
Cannot load c:/data/apache/modules/mod_python.dll into server: (1157) One 
of the
library files needed to run this application cannot be found:

I think this might have made a mistake at this step of the installation:
 >Move the files in the folder lib inside the mod_python folder (C:\Program
 >Files\Python\lib\mod_python-x\lib\mod_python) to the C:\Program
 >Files\Python\lib\mod_python folder. It's safe to delete these folders we 
just emptied.
but am unsure, as I am using a newer version of python and Apache than 
mentioned in the mod python documentation.

My Setup
Python 2.1  (C:\data\python2.1)
Apache 1.3.19 (C:\data\apache, root dir c:\data\apache\htdocs)
mod_python library files (C:\data\python2.1\Lib\mod_python)
mod_python.dll (C:\data\apache\modules\mod_python.dll)

My Apache httpd.conf


#
# Based upon the NCSA server configuration files originally by Rob McCool.
#
# This is the main Apache server configuration file.  It contains the
# configuration directives that give the server its instructions.
# See <URL:http://www.apache.org/docs/> for detailed information about
# the directives.
#
# Do NOT simply read the instructions in here without understanding
# what they do.  They're here only as hints or reminders.  If you are unsure
# consult the online docs. You have been warned.
#
# After this file is processed, the server will look for and process
# C:/data/apache/conf/srm.conf and then C:/data/apache/conf/access.conf
# unless you have overridden these with ResourceConfig and/or
# AccessConfig directives here.
#
# The configuration directives are grouped into three basic sections:
#  1. Directives that control the operation of the Apache server process as a
#     whole (the 'global environment').
#  2. Directives that define the parameters of the 'main' or 'default' server,
#     which responds to requests that aren't handled by a virtual host.
#     These directives also provide default values for the settings
#     of all virtual hosts.
#  3. Settings for virtual hosts, which allow Web requests to be sent to
#     different IP addresses or hostnames and have them handled by the
#     same Apache server process.
#
# Configuration and logfile names: If the filenames you specify for many
# of the server's control files begin with "/" (or "drive:/" for Win32), the
# server will use that explicit path.  If the filenames do *not* begin
# with "/", the value of ServerRoot is prepended -- so "logs/foo.log"
# with ServerRoot set to "/usr/local/apache" will be interpreted by the
# server as "/usr/local/apache/logs/foo.log".
#
# NOTE: Where filenames are specified, you must use forward slashes
# instead of backslashes (e.g., "c:/apache" instead of "c:\apache").
# If a drive letter is omitted, the drive on which Apache.exe is located
# will be used by default.  It is recommended that you always supply
# an explicit drive letter in absolute paths, however, to avoid
# confusion.
#

### Section 1: Global Environment
#
# The directives in this section affect the overall operation of Apache,
# such as the number of concurrent requests it can handle or where it
# can find its configuration files.
#

#
# ServerType is either inetd, or standalone.  Inetd mode is only supported on
# Unix platforms.
#
ServerType standalone

#
# ServerRoot: The top of the directory tree under which the server's
# configuration, error, and log files are kept.
#
ServerRoot "C:/data/apache"

#
# PidFile: The file in which the server should record its process
# identification number when it starts.
#
PidFile logs/httpd.pid

#
# ScoreBoardFile: File used to store internal server process information.
# Not all architectures require this.  But if yours does (you'll know because
# this file will be  created when you run Apache) then you *must* ensure that
# no two invocations of Apache share the same scoreboard file.
#
ScoreBoardFile logs/apache_runtime_status

#
# In the standard configuration, the server will process httpd.conf (this
# file, specified by the -f command line option), srm.conf, and access.conf
# in that order.  The latter two files are now distributed empty, as it is
# recommended that all directives be kept in a single file for simplicity.
# The commented-out values below are the built-in defaults.  You can have the
# server ignore these files altogether by using "/dev/null" (for Unix) or
# "nul" (for Win32) for the arguments to the directives.
#
#ResourceConfig conf/srm.conf
#AccessConfig conf/access.conf

#
# Timeout: The number of seconds before receives and sends time out.
#
Timeout 300

#
# KeepAlive: Whether or not to allow persistent connections (more than
# one request per connection). Set to "Off" to deactivate.
#
KeepAlive On

#
# MaxKeepAliveRequests: The maximum number of requests to allow
# during a persistent connection. Set to 0 to allow an unlimited amount.
# We recommend you leave this number high, for maximum performance.
#
MaxKeepAliveRequests 100

#
# KeepAliveTimeout: Number of seconds to wait for the next request from the
# same client on the same connection.
#
KeepAliveTimeout 15

#
# Apache on Win32 always creates one child process to handle requests.  If it
# dies, another child process is created automatically.  Within the child
# process multiple threads handle incoming requests.  The next two
# directives control the behaviour of the threads and processes.
#

#
# MaxRequestsPerChild: the number of requests each child process is
# allowed to process before the child dies.  The child will exit so
# as to avoid problems after prolonged use when Apache (and maybe the
# libraries it uses) leak memory or other resources.  On most systems, this
# isn't really needed, but a few (such as Solaris) do have notable leaks
# in the libraries.  For Win32, set this value to zero (unlimited)
# unless advised otherwise.
#
# NOTE: This value does not include keepalive requests after the initial
#       request per connection. For example, if a child process handles
#       an initial request and 10 subsequent "keptalive" requests, it
#       would only count as 1 request towards this limit.
#
MaxRequestsPerChild 0

#
# Number of concurrent threads (i.e., requests) the server will allow.
# Set this value according to the responsiveness of the server (more
# requests active at once means they're all handled more slowly) and
# the amount of system resources you'll allow the server to consume.
#
ThreadsPerChild 50

#
# Listen: Allows you to bind Apache to specific IP addresses and/or
# ports, in addition to the default. See also the <VirtualHost>
# directive.
#
#Listen 3000
#Listen 12.34.56.78:80

#
# BindAddress: You can support virtual hosts with this option. This directive
# is used to tell the server which IP address to listen to. It can either
# contain "*", an IP address, or a fully qualified Internet domain name.
# See also the <VirtualHost> and Listen directives.
#
#BindAddress *

#
# Apache Modules compiled into the standard Windows build
#
# The following modules are bound into the standard Apache binary distribution
# for Windows.  To change the standard behavior, uncomment the following lines
# and modify the list of those specific modules to be enabled in the server.
#
# WARNING: This is an advanced option that may render your server inoperable!
# Do not use these directives without expert guidance.
#
#ClearModuleList
#AddModule mod_so.c mod_mime.c mod_access.c mod_auth.c mod_negotiation.c
#AddModule mod_include.c mod_autoindex.c mod_dir.c mod_cgi.c mod_userdir.c
#AddModule mod_alias.c mod_env.c mod_log_config.c mod_asis.c mod_imap.c
#AddModule mod_actions.c mod_setenvif.c mod_isapi.c

#
# Dynamic Shared Object (DSO) Support
#
# To be able to use the functionality of a module which was built as a DSO you
# have to place corresponding `LoadModule' lines at this location so the
# directives contained in it are actually available _before_ they are used.
# Please read the file README.DSO in the Apache 1.3 distribution for more
# details about the DSO mechanism and run `apache -l' for the list of already
# built-in (statically linked and thus always available) modules in your Apache
# binary.
#
# Note: The order in which modules are loaded is important.  Don't change
# the order below without expert advice.
#
#LoadModule anon_auth_module modules/mod_auth_anon.so
#LoadModule dbm_auth_module modules/mod_auth_dbm.so
#LoadModule digest_auth_module modules/mod_auth_digest.so
#LoadModule cern_meta_module modules/mod_cern_meta.so
#LoadModule digest_module modules/mod_digest.so
#LoadModule expires_module modules/mod_expires.so
#LoadModule headers_module modules/mod_headers.so
#LoadModule proxy_module modules/mod_proxy.so
#LoadModule rewrite_module modules/mod_rewrite.so
#LoadModule speling_module modules/mod_speling.so
#LoadModule info_module modules/mod_info.so
#LoadModule status_module modules/mod_status.so
#LoadModule usertrack_module modules/mod_usertrack.so
LoadModule python_module modules/mod_python.dll

#
# ExtendedStatus controls whether Apache will generate "full" status
# information (ExtendedStatus On) or just basic information (ExtendedStatus
# Off) when the "server-status" handler is called. The default is Off.
#
#ExtendedStatus On

### Section 2: 'Main' server configuration
#
# The directives in this section set up the values used by the 'main'
# server, which responds to any requests that aren't handled by a
# <VirtualHost> definition.  These values also provide defaults for
# any <VirtualHost> containers you may define later in the file.
#
# All of these directives may appear inside <VirtualHost> containers,
# in which case these default settings will be overridden for the
# virtual host being defined.
#

#
# Port: The port to which the standalone server listens.  Certain firewall
# products must be configured before Apache can listen to a specific port.
# Other running httpd servers will also interfere with this port.  Disable
# all firewall, security, and other services if you encounter problems.
# To help diagnose problems use the Windows NT command NETSTAT -a
#
Port 80

#
# ServerAdmin: Your address, where problems with the server should be
# e-mailed.  This address appears on some server-generated pages, such
# as error documents.
#
ServerAdmin pdeluca@sia.net.au

#
# ServerName allows you to set a host name which is sent back to clients for
# your server if it's different than the one the program would get (i.e., use
# "www" instead of the host's real name).
#
# Note: You cannot just invent host names and hope they work. The name you
# define here must be a valid DNS name for your host. If you don't understand
# this, ask your network administrator.
# If your host doesn't have a registered DNS name, enter its IP address here.
# You will have to access it by its address (e.g., http://123.45.67.89/)
# anyway, and this will make redirections work in a sensible way.
#
# 127.0.0.1 is the TCP/IP local loop-back address, often named localhost. Your
# machine always knows itself by this address. If you use Apache strictly for
# local testing and development, you may use 127.0.0.1 as the server name.
#
ServerName localhost


#
# DocumentRoot: The directory out of which you will serve your
# documents. By default, all requests are taken from this directory, but
# symbolic links and aliases may be used to point to other locations.
#
DocumentRoot "C:/data/apache/htdocs"

#
# Each directory to which Apache has access, can be configured with respect
# to which services and features are allowed and/or disabled in that
# directory (and its subdirectories).
#
# First, we configure the "default" to be a very restrictive set of
# permissions.
#
<Directory />
     Options FollowSymLinks
     AllowOverride None
</Directory>

#
# Note that from this point forward you must specifically allow
# particular features to be enabled - so if something's not working as
# you might expect, make sure that you have specifically enabled it
# below.
#

#
# This should be changed to whatever you set DocumentRoot to.
#
<Directory "C:/data/apache/htdocs">

#
# This may also be "None", "All", or any combination of "Indexes",
# "Includes", "FollowSymLinks", "ExecCGI", or "MultiViews".
#
# Note that "MultiViews" must be named *explicitly* --- "Options All"
# doesn't give it to you.
#
     Options Indexes FollowSymLinks MultiViews

#
# This controls which options the .htaccess files in directories can
# override. Can also be "All", or any combination of "Options", "FileInfo",
# "AuthConfig", and "Limit"
#
     AllowOverride None

#
# Controls who can get stuff from this server.
#
     Order allow,deny
     Allow from all
</Directory>

#
# UserDir: The name of the directory which is appended onto a user's home
# directory if a ~user request is received.
#
# Under Win32, we do not currently try to determine the home directory of
# a Windows login, so a format such as that below needs to be used.  See
# the UserDir documentation for details.
#
<IfModule mod_userdir.c>
     UserDir "C:/data/apache/users/"
</IfModule>

#
# Control access to UserDir directories.  The following is an example
# for a site where these directories are restricted to read-only.
#
#<Directory "C:/data/apache/users">
#    AllowOverride FileInfo AuthConfig Limit
#    Options MultiViews Indexes SymLinksIfOwnerMatch IncludesNoExec
#    <Limit GET POST OPTIONS PROPFIND>
#        Order allow,deny
#        Allow from all
#    </Limit>
#    <LimitExcept GET POST OPTIONS PROPFIND>
#        Order deny,allow
#        Deny from all
#    </LimitExcept>
#</Directory>

#
# DirectoryIndex: Name of the file or files to use as a pre-written HTML
# directory index.  Separate multiple entries with spaces.
#
<IfModule mod_dir.c>
     DirectoryIndex index.html
</IfModule>

#
# AccessFileName: The name of the file to look for in each directory
# for access control information.
#
AccessFileName .htaccess

#
# The following lines prevent .htaccess files from being viewed by
# Web clients.  Since .htaccess files often contain authorization
# information, access is disallowed for security reasons.  Comment
# these lines out if you want Web visitors to see the contents of
# .htaccess files.  If you change the AccessFileName directive above,
# be sure to make the corresponding changes here.
#
# Also, folks tend to use names such as .htpasswd for password
# files, so this will protect those as well.
#
<Files ~ "^\.ht">
     Order allow,deny
     Deny from all
</Files>

#
# CacheNegotiatedDocs: By default, Apache sends "Pragma: no-cache" with each
# document that was negotiated on the basis of content. This asks proxy
# servers not to cache the document. Uncommenting the following line disables
# this behavior, and proxies will be allowed to cache the documents.
#
#CacheNegotiatedDocs

#
# UseCanonicalName:  (new for 1.3)  With this setting turned on, whenever
# Apache needs to construct a self-referencing URL (a URL that refers back
# to the server the response is coming from) it will use ServerName and
# Port to form a "canonical" name.  With this setting off, Apache will
# use the hostname:port that the client supplied, when possible.  This
# also affects SERVER_NAME and SERVER_PORT in CGI scripts.
#
UseCanonicalName On

#
# TypesConfig describes where the mime.types file (or equivalent) is
# to be found.
#
<IfModule mod_mime.c>
     TypesConfig conf/mime.types
</IfModule>

#
# DefaultType is the default MIME type the server will use for a document
# if it cannot otherwise determine one, such as from filename extensions.
# If your server contains mostly text or HTML documents, "text/plain" is
# a good value.  If most of your content is binary, such as applications
# or images, you may want to use "application/octet-stream" instead to
# keep browsers from trying to display binary files as though they are
# text.
#
DefaultType text/plain

#
# The mod_mime_magic module allows the server to use various hints from the
# contents of the file itself to determine its type.  The MIMEMagicFile
# directive tells the module where the hint definitions are located.
# mod_mime_magic is not part of the default server (you have to add
# it yourself with a LoadModule [see the DSO paragraph in the 'Global
# Environment' section], or recompile the server and include mod_mime_magic
# as part of the configuration), so it's enclosed in an <IfModule> container.
# This means that the MIMEMagicFile directive will only be processed if the
# module is part of the server.
#
<IfModule mod_mime_magic.c>
     MIMEMagicFile conf/magic
</IfModule>

#
# HostnameLookups: Log the names of clients or just their IP addresses
# e.g., www.apache.org (on) or 204.62.129.132 (off).
# The default is off because it'd be overall better for the net if people
# had to knowingly turn this feature on, since enabling it means that
# each client request will result in AT LEAST one lookup request to the
# nameserver.
#
HostnameLookups Off

#
# ErrorLog: The location of the error log file.
# If you do not specify an ErrorLog directive within a <VirtualHost>
# container, error messages relating to that virtual host will be
# logged here.  If you *do* define an error logfile for a <VirtualHost>
# container, that host's errors will be logged there and not here.
#
ErrorLog logs/error.log

#
# LogLevel: Control the number of messages logged to the error.log.
# Possible values include: debug, info, notice, warn, error, crit,
# alert, emerg.
#
LogLevel warn

#
# The following directives define some format nicknames for use with
# a CustomLog directive (see below).
#
LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\"" 
combined
LogFormat "%h %l %u %t \"%r\" %>s %b" common
LogFormat "%{Referer}i -> %U" referer
LogFormat "%{User-agent}i" agent

#
# The location and format of the access logfile (Common Logfile Format).
# If you do not define any access logfiles within a <VirtualHost>
# container, they will be logged here.  Contrariwise, if you *do*
# define per-<VirtualHost> access logfiles, transactions will be
# logged therein and *not* in this file.
#
CustomLog logs/access.log common

#
# If you would like to have agent and referer logfiles, uncomment the
# following directives.
#
#CustomLog logs/referer.log referer
#CustomLog logs/agent.log agent

#
# If you prefer a single logfile with access, agent, and referer information
# (Combined Logfile Format) you can use the following directive.
#
#CustomLog logs/access.log combined

#
# Optionally add a line containing the server version and virtual host
# name to server-generated pages (error documents, FTP directory listings,
# mod_status and mod_info output etc., but not CGI generated documents).
# Set to "EMail" to also include a mailto: link to the ServerAdmin.
# Set to one of:  On | Off | EMail
#
ServerSignature On

#
# Apache parses all CGI scripts for the shebang line by default.
# This comment line, the first line of the script, consists of the symbols
# pound (#) and exclamation (!) followed by the path of the program that
# can execute this specific script.  For a perl script, with perl.exe in
# the C:\Program Files\Perl directory, the shebang line should be:

    #!c:/program files/perl/perl

# Note you _must_not_ indent the actual shebang line, and it must be the
# first line of the file.  Of course, CGI processing must be enabled by
# the appropriate ScriptAlias or Options ExecCGI directives for the files
# or directory in question.
#
# However, Apache on Windows allows either the Unix behavior above, or can
# use the Registry to match files by extention.  The command to execute
# a file of this type is retrieved from the registry by the same method as
# the Windows Explorer would use to handle double-clicking on a file.
# These script actions can be configured from the Windows Explorer View menu,
# 'Folder Options', and reviewing the 'File Types' tab.  Clicking the Edit
# button allows you to modify the Actions, of which Apache 1.3 attempts to
# perform the 'Open' Action, and failing that it will try the shebang line.
# This behavior is subject to change in Apache release 2.0.
#
# Each mechanism has it's own specific security weaknesses, from the means
# to run a program you didn't intend the website owner to invoke, and the
# best method is a matter of great debate.
#
# To enable the this Windows specific behavior (and therefore -disable- the
# equivilant Unix behavior), uncomment the following directive:
#
#ScriptInterpreterSource registry
#
# The directive above can be placed in individual <Directory> blocks or the
# .htaccess file, with either the 'registry' (Windows behavior) or 'script'
# (Unix behavior) option, and will override this server default option.
#

#
# Aliases: Add here as many aliases as you need (with no limit). The format is
# Alias fakename realname
#
<IfModule mod_alias.c>

     #
     # Note that if you include a trailing / on fakename then the server will
     # require it to be present in the URL.  So "/icons" isn't aliased in this
     # example, only "/icons/"..
     #
     Alias /icons/ "C:/data/apache/icons/"

     <Directory "C:/data/apache/icons">
         Options Indexes MultiViews
         AllowOverride None
         Order allow,deny
         Allow from all
     </Directory>

     #
     # ScriptAlias: This controls which directories contain server scripts.
     # ScriptAliases are essentially the same as Aliases, except that
     # documents in the realname directory are treated as applications and
     # run by the server when requested rather than as documents sent to 
the client.
     # The same rules about trailing "/" apply to ScriptAlias directives as to
     # Alias.
     #
     ScriptAlias /cgi-bin/ "C:/data/apache/cgi-bin/"

     #
     # "C:/data/apache/cgi-bin" should be changed to whatever your 
ScriptAliased
     # CGI directory exists, if you have that configured.
     #
     <Directory "C:/data/apache/cgi-bin">
         AllowOverride None
         Options None
         Order allow,deny
         Allow from all
     </Directory>

     <Directory "c:/data/apache/htdocs/python">
     	AddHandler python-program .py
     	PythonHandler test
     	PythonDebug on
     </Directory>

</IfModule>
# End of aliases.

#
# Redirect allows you to tell clients about documents which used to exist in
# your server's namespace, but do not anymore. This allows you to tell the
# clients where to look for the relocated document.
# Format: Redirect old-URI new-URL
#

#
# Directives controlling the display of server-generated directory listings.
#
<IfModule mod_autoindex.c>

     #
     # FancyIndexing is whether you want fancy directory indexing or standard
     #
     # Note, add the option TrackModified to the IndexOptions default list only
     # if all indexed directories reside on NTFS volumes.  The 
TrackModified flag
     # will report the Last-Modified date to assist caches and proxies to 
properly
     # track directory changes, but it does _not_ work on FAT volumes.
     #
     IndexOptions FancyIndexing

     #
     # AddIcon* directives tell the server which icon to show for different
     # files or filename extensions.  These are only displayed for
     # FancyIndexed directories.
     #
     AddIconByEncoding (CMP,/icons/compressed.gif) x-compress x-gzip

     AddIconByType (TXT,/icons/text.gif) text/*
     AddIconByType (IMG,/icons/image2.gif) image/*
     AddIconByType (SND,/icons/sound2.gif) audio/*
     AddIconByType (VID,/icons/movie.gif) video/*

     AddIcon /icons/binary.gif .bin .exe
     AddIcon /icons/binhex.gif .hqx
     AddIcon /icons/tar.gif .tar
     AddIcon /icons/world2.gif .wrl .wrl.gz .vrml .vrm .iv
     AddIcon /icons/compressed.gif .Z .z .tgz .gz .zip
     AddIcon /icons/a.gif .ps .ai .eps
     AddIcon /icons/layout.gif .html .shtml .htm .pdf
     AddIcon /icons/text.gif .txt
     AddIcon /icons/c.gif .c
     AddIcon /icons/p.gif .pl .py
     AddIcon /icons/f.gif .for
     AddIcon /icons/dvi.gif .dvi
     AddIcon /icons/uuencoded.gif .uu
     AddIcon /icons/script.gif .conf .sh .shar .csh .ksh .tcl
     AddIcon /icons/tex.gif .tex
     AddIcon /icons/bomb.gif core

     AddIcon /icons/back.gif ..
     AddIcon /icons/hand.right.gif README
     AddIcon /icons/folder.gif ^^DIRECTORY^^
     AddIcon /icons/blank.gif ^^BLANKICON^^

     #
     # DefaultIcon is which icon to show for files which do not have an icon
     # explicitly set.
     #
     DefaultIcon /icons/unknown.gif

     #
     # AddDescription allows you to place a short description after a file in
     # server-generated indexes.  These are only displayed for FancyIndexed
     # directories.
     # Format: AddDescription "description" filename
     #
     #AddDescription "GZIP compressed document" .gz
     #AddDescription "tar archive" .tar
     #AddDescription "GZIP compressed tar archive" .tgz

     #
     # ReadmeName is the name of the README file the server will look for by
     # default, and append to directory listings.
     #
     # HeaderName is the name of a file which should be prepended to
     # directory indexes.
     #
     # If MultiViews are amongst the Options in effect, the server will
     # first look for name.html and include it if found.  If name.html
     # doesn't exist, the server will then look for name.txt and include
     # it as plaintext if found.
     #
     ReadmeName README
     HeaderName HEADER

     #
     # IndexIgnore is a set of filenames which directory indexing should ignore
     # and not include in the listing.  Shell-style wildcarding is permitted.
     #
     IndexIgnore .??* *~ *# HEADER* README* RCS CVS *,v *,t

</IfModule>
# End of indexing directives.

#
# Document types.
#
<IfModule mod_mime.c>

     #
     # AddEncoding allows you to have certain browsers (Mosaic/X 2.1+) 
uncompress
     # information on the fly. Note: Not all browsers support this.
     # Despite the name similarity, the following Add* directives have nothing
     # to do with the FancyIndexing customization directives above.
     #
     AddEncoding x-compress Z
     AddEncoding x-gzip gz tgz
     #
     # AddLanguage allows you to specify the language of a document. You can
     # then use content negotiation to give a browser a file in a language
     # it can understand.
     #
     # Note 1: The suffix does not have to be the same as the language
     # keyword --- those with documents in Polish (whose net-standard
     # language code is pl) may wish to use "AddLanguage pl .po" to
     # avoid the ambiguity with the common suffix for perl scripts.
     #
     # Note 2: The example entries below illustrate that in quite
     # some cases the two character 'Language' abbreviation is not
     # identical to the two character 'Country' code for its country,
     # E.g. 'Danmark/dk' versus 'Danish/da'.
     #
     # Note 3: In the case of 'ltz' we violate the RFC by using a three char
     # specifier. But there is 'work in progress' to fix this and get
     # the reference data for rfc1766 cleaned up.
     #
     # Danish (da) - Dutch (nl) - English (en) - Estonian (ee)
     # French (fr) - German (de) - Greek-Modern (el)
     # Italian (it) - Korean (kr) - Norwegian (no)
     # Portugese (pt) - Luxembourgeois* (ltz)
     # Spanish (es) - Swedish (sv) - Catalan (ca) - Czech(cz)
     # Polish (pl) - Brazilian Portuguese (pt-br) - Japanese (ja)
     # Russian (ru)
     #
     AddLanguage da .dk
     AddLanguage nl .nl
     AddLanguage en .en
     AddLanguage et .ee
     AddLanguage fr .fr
     AddLanguage de .de
     AddLanguage el .el
     AddLanguage he .he
     AddCharset ISO-8859-8 .iso8859-8
     AddLanguage it .it
     AddLanguage ja .ja
     AddCharset ISO-2022-JP .jis
     AddLanguage kr .kr
     AddCharset ISO-2022-KR .iso-kr
     AddLanguage no .no
     AddLanguage pl .po
     AddCharset ISO-8859-2 .iso-pl
     AddLanguage pt .pt
     AddLanguage pt-br .pt-br
     AddLanguage ltz .lu
     AddLanguage ca .ca
     AddLanguage es .es
     AddLanguage sv .se
     AddLanguage cz .cz
     AddLanguage ru .ru
     AddLanguage tw .tw
     AddLanguage zh-tw .tw
     AddCharset Big5         .Big5    .big5
     AddCharset WINDOWS-1251 .cp-1251
     AddCharset CP866        .cp866
     AddCharset ISO-8859-5   .iso-ru
     AddCharset KOI8-R       .koi8-r
     AddCharset UCS-2        .ucs2
     AddCharset UCS-4        .ucs4
     AddCharset UTF-8        .utf8

     # LanguagePriority allows you to give precedence to some languages
     # in case of a tie during content negotiation.
     #
     # Just list the languages in decreasing order of preference. We have
     # more or less alphabetized them here. You probably want to change this.
     #
     <IfModule mod_negotiation.c>
         LanguagePriority en da nl et fr de el it ja kr no pl pt pt-br ru 
ltz ca es sv tw
     </IfModule>

     #
     # AddType allows you to tweak mime.types without actually editing it, 
or to
     # make certain files to be certain types.
     #
     # For example, the PHP 3.x module (not part of the Apache distribution 
- see
     # http://www.php.net) will typically use:
     #
     #AddType application/x-httpd-php3 .php3
     #AddType application/x-httpd-php3-source .phps
     #
     # And for PHP 4.x, use:
     #
     #AddType application/x-httpd-php .php
     #AddType application/x-httpd-php-source .phps

     AddType application/x-tar .tgz

     #
     # AddHandler allows you to map certain file extensions to "handlers",
     # actions unrelated to filetype. These can be either built into the server
     # or added with the Action command (see below)
     #
     # If you want to use server side includes, or CGI outside
     # ScriptAliased directories, uncomment the following lines.
     #
     # To use CGI scripts:
     #
     #AddHandler cgi-script .cgi

     #
     # To use server-parsed HTML files
     #
     #AddType text/html .shtml
     #AddHandler server-parsed .shtml

     #
     # Uncomment the following line to enable Apache's send-asis HTTP file
     # feature
     #
     #AddHandler send-as-is asis

     #
     # If you wish to use server-parsed imagemap files, use
     #
     #AddHandler imap-file map

     #
     # To enable type maps, you might want to use
     #
     #AddHandler type-map var

</IfModule>
# End of document types.

#
# Action lets you define media types that will execute a script whenever
# a matching file is called. This eliminates the need for repeated URL
# pathnames for oft-used CGI file processors.
# Format: Action media/type /cgi-script/location
# Format: Action handler-name /cgi-script/location
#

#
# MetaDir: specifies the name of the directory in which Apache can find
# meta information files. These files contain additional HTTP headers
# to include when sending the document
#
#MetaDir .web

#
# MetaSuffix: specifies the file name suffix for the file containing the
# meta information.
#
#MetaSuffix .meta

#
# Customizable error response (Apache style)
#  these come in three flavors
#
#    1) plain text
#ErrorDocument 500 "The server made a boo boo.
#  n.b.  the single leading (") marks it as text, it does not get output
#
#    2) local redirects
#ErrorDocument 404 /missing.html
#  to redirect to local URL /missing.html
#ErrorDocument 404 /cgi-bin/missing_handler.pl
#  N.B.: You can redirect to a script or a document using server-side-includes.
#
#    3) external redirects
#ErrorDocument 402 http://some.other_server.com/subscription_info.html
#  N.B.: Many of the environment variables associated with the original
#  request will *not* be available to such a script.

#
# Customize behaviour based on the browser
#
<IfModule mod_setenvif.c>

     #
     # The following directives modify normal HTTP response behavior.
     # The first directive disables keepalive for Netscape 2.x and browsers 
that
     # spoof it. There are known problems with these browser implementations.
     # The second directive is for Microsoft Internet Explorer 4.0b2
     # which has a broken HTTP/1.1 implementation and does not properly
     # support keepalive when it is used on 301 or 302 (redirect) responses.
     #
     BrowserMatch "Mozilla/2" nokeepalive
     BrowserMatch "MSIE 4\.0b2;" nokeepalive downgrade-1.0 force-response-1.0

     #
     # The following directive disables HTTP/1.1 responses to browsers which
     # are in violation of the HTTP/1.0 spec by not being able to grok a
     # basic 1.1 response.
     #
     BrowserMatch "RealPlayer 4\.0" force-response-1.0
     BrowserMatch "Java/1\.0" force-response-1.0
     BrowserMatch "JDK/1\.0" force-response-1.0

</IfModule>
# End of browser customization directives

#
# Allow server status reports, with the URL of http://servername/server-status
# Change the ".localhost" to match your domain to enable.
#
#<Location /server-status>
#    SetHandler server-status
#    Order deny,allow
#    Deny from all
#    Allow from .localhost
#</Location>

#
# Allow remote server configuration reports, with the URL of
# http://servername/server-info (requires that mod_info.c be loaded).
# Change the ".localhost" to match your domain to enable.
#
#<Location /server-info>
#    SetHandler server-info
#    Order deny,allow
#    Deny from all
#    Allow from .localhost
#</Location>

#
# There have been reports of people trying to abuse an old bug from pre-1.1
# days.  This bug involved a CGI script distributed as a part of Apache.
# By uncommenting these lines you can redirect these attacks to a logging
# script on phf.apache.org.  Or, you can record them yourself, using the script
# support/phf_abuse_log.cgi.
#
#<Location /cgi-bin/phf*>
#    Deny from all
#    ErrorDocument 403 http://phf.apache.org/phf_abuse_log.cgi
#</Location>

#
# Proxy Server directives. Uncomment the following lines to
# enable the proxy server:
#
#<IfModule mod_proxy.c>
#    ProxyRequests On

#    <Directory proxy:*>
#        Order deny,allow
#        Deny from all
#        Allow from .localhost
#    </Directory>

     #
     # Enable/disable the handling of HTTP/1.1 "Via:" headers.
     # ("Full" adds the server version; "Block" removes all outgoing Via: 
headers)
     # Set to one of: Off | On | Full | Block
     #
#    ProxyVia On

     #
     # To enable the cache as well, edit and uncomment the following lines:
     # (no cacheing without CacheRoot)
     #
#    CacheRoot "C:/data/apache/proxy"
#    CacheSize 5
#    CacheGcInterval 4
#    CacheMaxExpire 24
#    CacheLastModifiedFactor 0.1
#    CacheDefaultExpire 1
#    NoCache a_domain.com another_domain.edu joes.garage_sale.com

#</IfModule>
# End of proxy directives.

### Section 3: Virtual Hosts
#
# VirtualHost: If you want to maintain multiple domains/hostnames on your
# machine you can setup VirtualHost containers for them. Most configurations
# use only name-based virtual hosts so the server doesn't need to worry about
# IP addresses. This is indicated by the asterisks in the directives below.
#
# Please see the documentation at <URL:http://www.apache.org/docs/vhosts/>
# for further details before you try to setup virtual hosts.
#
# You may use the command line option '-S' to verify your virtual host
# configuration.

#
# Use name-based virtual hosting.
#
#NameVirtualHost *

#
# VirtualHost example:
# Almost any Apache directive may go into a VirtualHost container.
# The first VirtualHost section is used for requests without a known
# server name.
#
#<VirtualHost *>
#    ServerAdmin webmaster@dummy-host.example.com
#    DocumentRoot /www/docs/dummy-host.example.com
#    ServerName dummy-host.example.com
#    ErrorLog logs/dummy-host.example.com-error_log
#    CustomLog logs/dummy-host.example.com-access_log common
#</VirtualHost>



Apologies for the size of this email, I just need to get this problem 
sorted ASAP. Any help will be greatly appreciated.








-------------------------------------------
Paul De Luca
Email: pdeluca@sia.net.au
Ph: 0414 225561
-------------------------------------------


From grisha at modpython.org  Thu May 24 09:44:54 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:02:45 2004
Subject: [mod_python] mod python apache problem
In-Reply-To: <4.3.2.7.2.20010524211137.00acd710@mail.sia.net.au>
Message-ID: <Pine.BSF.4.32.0105240943370.30008-100000@localhost>

Most likely this is because the DLL, which was compiled for Windows NT
will not work on ME, because ME doesn't have some libraries that NT has.
But I'm not a Windows expert, this is just a guess.

Grisha

On Thu, 24 May 2001, Paul De Luca wrote:

> Hi,
>       I am having some troubles trying to install mod_python onto my home
> PC running Windows ME (hey, its for testing purposes!). I followed the
> directions in the mod python documentation (changing the path when
> necessary). However when I try and start Apache I get the following error:
>
> Syntax error on line 203 of c:/data/apache/conf/httpd.conf:
> Cannot load c:/data/apache/modules/mod_python.dll into server: (1157) One
> of the
> library files needed to run this application cannot be found:
>
> I think this might have made a mistake at this step of the installation:
>  >Move the files in the folder lib inside the mod_python folder (C:\Program
>  >Files\Python\lib\mod_python-x\lib\mod_python) to the C:\Program
>  >Files\Python\lib\mod_python folder. It's safe to delete these folders we
> just emptied.
> but am unsure, as I am using a newer version of python and Apache than
> mentioned in the mod python documentation.
>
> My Setup
> Python 2.1  (C:\data\python2.1)
> Apache 1.3.19 (C:\data\apache, root dir c:\data\apache\htdocs)
> mod_python library files (C:\data\python2.1\Lib\mod_python)
> mod_python.dll (C:\data\apache\modules\mod_python.dll)
>
> My Apache httpd.conf
>
>
> #
> # Based upon the NCSA server configuration files originally by Rob McCool.
> #
> # This is the main Apache server configuration file.  It contains the
> # configuration directives that give the server its instructions.
> # See <URL:http://www.apache.org/docs/> for detailed information about
> # the directives.
> #
> # Do NOT simply read the instructions in here without understanding
> # what they do.  They're here only as hints or reminders.  If you are unsure
> # consult the online docs. You have been warned.
> #
> # After this file is processed, the server will look for and process
> # C:/data/apache/conf/srm.conf and then C:/data/apache/conf/access.conf
> # unless you have overridden these with ResourceConfig and/or
> # AccessConfig directives here.
> #
> # The configuration directives are grouped into three basic sections:
> #  1. Directives that control the operation of the Apache server process as a
> #     whole (the 'global environment').
> #  2. Directives that define the parameters of the 'main' or 'default' server,
> #     which responds to requests that aren't handled by a virtual host.
> #     These directives also provide default values for the settings
> #     of all virtual hosts.
> #  3. Settings for virtual hosts, which allow Web requests to be sent to
> #     different IP addresses or hostnames and have them handled by the
> #     same Apache server process.
> #
> # Configuration and logfile names: If the filenames you specify for many
> # of the server's control files begin with "/" (or "drive:/" for Win32), the
> # server will use that explicit path.  If the filenames do *not* begin
> # with "/", the value of ServerRoot is prepended -- so "logs/foo.log"
> # with ServerRoot set to "/usr/local/apache" will be interpreted by the
> # server as "/usr/local/apache/logs/foo.log".
> #
> # NOTE: Where filenames are specified, you must use forward slashes
> # instead of backslashes (e.g., "c:/apache" instead of "c:\apache").
> # If a drive letter is omitted, the drive on which Apache.exe is located
> # will be used by default.  It is recommended that you always supply
> # an explicit drive letter in absolute paths, however, to avoid
> # confusion.
> #
>
> ### Section 1: Global Environment
> #
> # The directives in this section affect the overall operation of Apache,
> # such as the number of concurrent requests it can handle or where it
> # can find its configuration files.
> #
>
> #
> # ServerType is either inetd, or standalone.  Inetd mode is only supported on
> # Unix platforms.
> #
> ServerType standalone
>
> #
> # ServerRoot: The top of the directory tree under which the server's
> # configuration, error, and log files are kept.
> #
> ServerRoot "C:/data/apache"
>
> #
> # PidFile: The file in which the server should record its process
> # identification number when it starts.
> #
> PidFile logs/httpd.pid
>
> #
> # ScoreBoardFile: File used to store internal server process information.
> # Not all architectures require this.  But if yours does (you'll know because
> # this file will be  created when you run Apache) then you *must* ensure that
> # no two invocations of Apache share the same scoreboard file.
> #
> ScoreBoardFile logs/apache_runtime_status
>
> #
> # In the standard configuration, the server will process httpd.conf (this
> # file, specified by the -f command line option), srm.conf, and access.conf
> # in that order.  The latter two files are now distributed empty, as it is
> # recommended that all directives be kept in a single file for simplicity.
> # The commented-out values below are the built-in defaults.  You can have the
> # server ignore these files altogether by using "/dev/null" (for Unix) or
> # "nul" (for Win32) for the arguments to the directives.
> #
> #ResourceConfig conf/srm.conf
> #AccessConfig conf/access.conf
>
> #
> # Timeout: The number of seconds before receives and sends time out.
> #
> Timeout 300
>
> #
> # KeepAlive: Whether or not to allow persistent connections (more than
> # one request per connection). Set to "Off" to deactivate.
> #
> KeepAlive On
>
> #
> # MaxKeepAliveRequests: The maximum number of requests to allow
> # during a persistent connection. Set to 0 to allow an unlimited amount.
> # We recommend you leave this number high, for maximum performance.
> #
> MaxKeepAliveRequests 100
>
> #
> # KeepAliveTimeout: Number of seconds to wait for the next request from the
> # same client on the same connection.
> #
> KeepAliveTimeout 15
>
> #
> # Apache on Win32 always creates one child process to handle requests.  If it
> # dies, another child process is created automatically.  Within the child
> # process multiple threads handle incoming requests.  The next two
> # directives control the behaviour of the threads and processes.
> #
>
> #
> # MaxRequestsPerChild: the number of requests each child process is
> # allowed to process before the child dies.  The child will exit so
> # as to avoid problems after prolonged use when Apache (and maybe the
> # libraries it uses) leak memory or other resources.  On most systems, this
> # isn't really needed, but a few (such as Solaris) do have notable leaks
> # in the libraries.  For Win32, set this value to zero (unlimited)
> # unless advised otherwise.
> #
> # NOTE: This value does not include keepalive requests after the initial
> #       request per connection. For example, if a child process handles
> #       an initial request and 10 subsequent "keptalive" requests, it
> #       would only count as 1 request towards this limit.
> #
> MaxRequestsPerChild 0
>
> #
> # Number of concurrent threads (i.e., requests) the server will allow.
> # Set this value according to the responsiveness of the server (more
> # requests active at once means they're all handled more slowly) and
> # the amount of system resources you'll allow the server to consume.
> #
> ThreadsPerChild 50
>
> #
> # Listen: Allows you to bind Apache to specific IP addresses and/or
> # ports, in addition to the default. See also the <VirtualHost>
> # directive.
> #
> #Listen 3000
> #Listen 12.34.56.78:80
>
> #
> # BindAddress: You can support virtual hosts with this option. This directive
> # is used to tell the server which IP address to listen to. It can either
> # contain "*", an IP address, or a fully qualified Internet domain name.
> # See also the <VirtualHost> and Listen directives.
> #
> #BindAddress *
>
> #
> # Apache Modules compiled into the standard Windows build
> #
> # The following modules are bound into the standard Apache binary distribution
> # for Windows.  To change the standard behavior, uncomment the following lines
> # and modify the list of those specific modules to be enabled in the server.
> #
> # WARNING: This is an advanced option that may render your server inoperable!
> # Do not use these directives without expert guidance.
> #
> #ClearModuleList
> #AddModule mod_so.c mod_mime.c mod_access.c mod_auth.c mod_negotiation.c
> #AddModule mod_include.c mod_autoindex.c mod_dir.c mod_cgi.c mod_userdir.c
> #AddModule mod_alias.c mod_env.c mod_log_config.c mod_asis.c mod_imap.c
> #AddModule mod_actions.c mod_setenvif.c mod_isapi.c
>
> #
> # Dynamic Shared Object (DSO) Support
> #
> # To be able to use the functionality of a module which was built as a DSO you
> # have to place corresponding `LoadModule' lines at this location so the
> # directives contained in it are actually available _before_ they are used.
> # Please read the file README.DSO in the Apache 1.3 distribution for more
> # details about the DSO mechanism and run `apache -l' for the list of already
> # built-in (statically linked and thus always available) modules in your Apache
> # binary.
> #
> # Note: The order in which modules are loaded is important.  Don't change
> # the order below without expert advice.
> #
> #LoadModule anon_auth_module modules/mod_auth_anon.so
> #LoadModule dbm_auth_module modules/mod_auth_dbm.so
> #LoadModule digest_auth_module modules/mod_auth_digest.so
> #LoadModule cern_meta_module modules/mod_cern_meta.so
> #LoadModule digest_module modules/mod_digest.so
> #LoadModule expires_module modules/mod_expires.so
> #LoadModule headers_module modules/mod_headers.so
> #LoadModule proxy_module modules/mod_proxy.so
> #LoadModule rewrite_module modules/mod_rewrite.so
> #LoadModule speling_module modules/mod_speling.so
> #LoadModule info_module modules/mod_info.so
> #LoadModule status_module modules/mod_status.so
> #LoadModule usertrack_module modules/mod_usertrack.so
> LoadModule python_module modules/mod_python.dll
>
> #
> # ExtendedStatus controls whether Apache will generate "full" status
> # information (ExtendedStatus On) or just basic information (ExtendedStatus
> # Off) when the "server-status" handler is called. The default is Off.
> #
> #ExtendedStatus On
>
> ### Section 2: 'Main' server configuration
> #
> # The directives in this section set up the values used by the 'main'
> # server, which responds to any requests that aren't handled by a
> # <VirtualHost> definition.  These values also provide defaults for
> # any <VirtualHost> containers you may define later in the file.
> #
> # All of these directives may appear inside <VirtualHost> containers,
> # in which case these default settings will be overridden for the
> # virtual host being defined.
> #
>
> #
> # Port: The port to which the standalone server listens.  Certain firewall
> # products must be configured before Apache can listen to a specific port.
> # Other running httpd servers will also interfere with this port.  Disable
> # all firewall, security, and other services if you encounter problems.
> # To help diagnose problems use the Windows NT command NETSTAT -a
> #
> Port 80
>
> #
> # ServerAdmin: Your address, where problems with the server should be
> # e-mailed.  This address appears on some server-generated pages, such
> # as error documents.
> #
> ServerAdmin pdeluca@sia.net.au
>
> #
> # ServerName allows you to set a host name which is sent back to clients for
> # your server if it's different than the one the program would get (i.e., use
> # "www" instead of the host's real name).
> #
> # Note: You cannot just invent host names and hope they work. The name you
> # define here must be a valid DNS name for your host. If you don't understand
> # this, ask your network administrator.
> # If your host doesn't have a registered DNS name, enter its IP address here.
> # You will have to access it by its address (e.g., http://123.45.67.89/)
> # anyway, and this will make redirections work in a sensible way.
> #
> # 127.0.0.1 is the TCP/IP local loop-back address, often named localhost. Your
> # machine always knows itself by this address. If you use Apache strictly for
> # local testing and development, you may use 127.0.0.1 as the server name.
> #
> ServerName localhost
>
>
> #
> # DocumentRoot: The directory out of which you will serve your
> # documents. By default, all requests are taken from this directory, but
> # symbolic links and aliases may be used to point to other locations.
> #
> DocumentRoot "C:/data/apache/htdocs"
>
> #
> # Each directory to which Apache has access, can be configured with respect
> # to which services and features are allowed and/or disabled in that
> # directory (and its subdirectories).
> #
> # First, we configure the "default" to be a very restrictive set of
> # permissions.
> #
> <Directory />
>      Options FollowSymLinks
>      AllowOverride None
> </Directory>
>
> #
> # Note that from this point forward you must specifically allow
> # particular features to be enabled - so if something's not working as
> # you might expect, make sure that you have specifically enabled it
> # below.
> #
>
> #
> # This should be changed to whatever you set DocumentRoot to.
> #
> <Directory "C:/data/apache/htdocs">
>
> #
> # This may also be "None", "All", or any combination of "Indexes",
> # "Includes", "FollowSymLinks", "ExecCGI", or "MultiViews".
> #
> # Note that "MultiViews" must be named *explicitly* --- "Options All"
> # doesn't give it to you.
> #
>      Options Indexes FollowSymLinks MultiViews
>
> #
> # This controls which options the .htaccess files in directories can
> # override. Can also be "All", or any combination of "Options", "FileInfo",
> # "AuthConfig", and "Limit"
> #
>      AllowOverride None
>
> #
> # Controls who can get stuff from this server.
> #
>      Order allow,deny
>      Allow from all
> </Directory>
>
> #
> # UserDir: The name of the directory which is appended onto a user's home
> # directory if a ~user request is received.
> #
> # Under Win32, we do not currently try to determine the home directory of
> # a Windows login, so a format such as that below needs to be used.  See
> # the UserDir documentation for details.
> #
> <IfModule mod_userdir.c>
>      UserDir "C:/data/apache/users/"
> </IfModule>
>
> #
> # Control access to UserDir directories.  The following is an example
> # for a site where these directories are restricted to read-only.
> #
> #<Directory "C:/data/apache/users">
> #    AllowOverride FileInfo AuthConfig Limit
> #    Options MultiViews Indexes SymLinksIfOwnerMatch IncludesNoExec
> #    <Limit GET POST OPTIONS PROPFIND>
> #        Order allow,deny
> #        Allow from all
> #    </Limit>
> #    <LimitExcept GET POST OPTIONS PROPFIND>
> #        Order deny,allow
> #        Deny from all
> #    </LimitExcept>
> #</Directory>
>
> #
> # DirectoryIndex: Name of the file or files to use as a pre-written HTML
> # directory index.  Separate multiple entries with spaces.
> #
> <IfModule mod_dir.c>
>      DirectoryIndex index.html
> </IfModule>
>
> #
> # AccessFileName: The name of the file to look for in each directory
> # for access control information.
> #
> AccessFileName .htaccess
>
> #
> # The following lines prevent .htaccess files from being viewed by
> # Web clients.  Since .htaccess files often contain authorization
> # information, access is disallowed for security reasons.  Comment
> # these lines out if you want Web visitors to see the contents of
> # .htaccess files.  If you change the AccessFileName directive above,
> # be sure to make the corresponding changes here.
> #
> # Also, folks tend to use names such as .htpasswd for password
> # files, so this will protect those as well.
> #
> <Files ~ "^\.ht">
>      Order allow,deny
>      Deny from all
> </Files>
>
> #
> # CacheNegotiatedDocs: By default, Apache sends "Pragma: no-cache" with each
> # document that was negotiated on the basis of content. This asks proxy
> # servers not to cache the document. Uncommenting the following line disables
> # this behavior, and proxies will be allowed to cache the documents.
> #
> #CacheNegotiatedDocs
>
> #
> # UseCanonicalName:  (new for 1.3)  With this setting turned on, whenever
> # Apache needs to construct a self-referencing URL (a URL that refers back
> # to the server the response is coming from) it will use ServerName and
> # Port to form a "canonical" name.  With this setting off, Apache will
> # use the hostname:port that the client supplied, when possible.  This
> # also affects SERVER_NAME and SERVER_PORT in CGI scripts.
> #
> UseCanonicalName On
>
> #
> # TypesConfig describes where the mime.types file (or equivalent) is
> # to be found.
> #
> <IfModule mod_mime.c>
>      TypesConfig conf/mime.types
> </IfModule>
>
> #
> # DefaultType is the default MIME type the server will use for a document
> # if it cannot otherwise determine one, such as from filename extensions.
> # If your server contains mostly text or HTML documents, "text/plain" is
> # a good value.  If most of your content is binary, such as applications
> # or images, you may want to use "application/octet-stream" instead to
> # keep browsers from trying to display binary files as though they are
> # text.
> #
> DefaultType text/plain
>
> #
> # The mod_mime_magic module allows the server to use various hints from the
> # contents of the file itself to determine its type.  The MIMEMagicFile
> # directive tells the module where the hint definitions are located.
> # mod_mime_magic is not part of the default server (you have to add
> # it yourself with a LoadModule [see the DSO paragraph in the 'Global
> # Environment' section], or recompile the server and include mod_mime_magic
> # as part of the configuration), so it's enclosed in an <IfModule> container.
> # This means that the MIMEMagicFile directive will only be processed if the
> # module is part of the server.
> #
> <IfModule mod_mime_magic.c>
>      MIMEMagicFile conf/magic
> </IfModule>
>
> #
> # HostnameLookups: Log the names of clients or just their IP addresses
> # e.g., www.apache.org (on) or 204.62.129.132 (off).
> # The default is off because it'd be overall better for the net if people
> # had to knowingly turn this feature on, since enabling it means that
> # each client request will result in AT LEAST one lookup request to the
> # nameserver.
> #
> HostnameLookups Off
>
> #
> # ErrorLog: The location of the error log file.
> # If you do not specify an ErrorLog directive within a <VirtualHost>
> # container, error messages relating to that virtual host will be
> # logged here.  If you *do* define an error logfile for a <VirtualHost>
> # container, that host's errors will be logged there and not here.
> #
> ErrorLog logs/error.log
>
> #
> # LogLevel: Control the number of messages logged to the error.log.
> # Possible values include: debug, info, notice, warn, error, crit,
> # alert, emerg.
> #
> LogLevel warn
>
> #
> # The following directives define some format nicknames for use with
> # a CustomLog directive (see below).
> #
> LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\""
> combined
> LogFormat "%h %l %u %t \"%r\" %>s %b" common
> LogFormat "%{Referer}i -> %U" referer
> LogFormat "%{User-agent}i" agent
>
> #
> # The location and format of the access logfile (Common Logfile Format).
> # If you do not define any access logfiles within a <VirtualHost>
> # container, they will be logged here.  Contrariwise, if you *do*
> # define per-<VirtualHost> access logfiles, transactions will be
> # logged therein and *not* in this file.
> #
> CustomLog logs/access.log common
>
> #
> # If you would like to have agent and referer logfiles, uncomment the
> # following directives.
> #
> #CustomLog logs/referer.log referer
> #CustomLog logs/agent.log agent
>
> #
> # If you prefer a single logfile with access, agent, and referer information
> # (Combined Logfile Format) you can use the following directive.
> #
> #CustomLog logs/access.log combined
>
> #
> # Optionally add a line containing the server version and virtual host
> # name to server-generated pages (error documents, FTP directory listings,
> # mod_status and mod_info output etc., but not CGI generated documents).
> # Set to "EMail" to also include a mailto: link to the ServerAdmin.
> # Set to one of:  On | Off | EMail
> #
> ServerSignature On
>
> #
> # Apache parses all CGI scripts for the shebang line by default.
> # This comment line, the first line of the script, consists of the symbols
> # pound (#) and exclamation (!) followed by the path of the program that
> # can execute this specific script.  For a perl script, with perl.exe in
> # the C:\Program Files\Perl directory, the shebang line should be:
>
>     #!c:/program files/perl/perl
>
> # Note you _must_not_ indent the actual shebang line, and it must be the
> # first line of the file.  Of course, CGI processing must be enabled by
> # the appropriate ScriptAlias or Options ExecCGI directives for the files
> # or directory in question.
> #
> # However, Apache on Windows allows either the Unix behavior above, or can
> # use the Registry to match files by extention.  The command to execute
> # a file of this type is retrieved from the registry by the same method as
> # the Windows Explorer would use to handle double-clicking on a file.
> # These script actions can be configured from the Windows Explorer View menu,
> # 'Folder Options', and reviewing the 'File Types' tab.  Clicking the Edit
> # button allows you to modify the Actions, of which Apache 1.3 attempts to
> # perform the 'Open' Action, and failing that it will try the shebang line.
> # This behavior is subject to change in Apache release 2.0.
> #
> # Each mechanism has it's own specific security weaknesses, from the means
> # to run a program you didn't intend the website owner to invoke, and the
> # best method is a matter of great debate.
> #
> # To enable the this Windows specific behavior (and therefore -disable- the
> # equivilant Unix behavior), uncomment the following directive:
> #
> #ScriptInterpreterSource registry
> #
> # The directive above can be placed in individual <Directory> blocks or the
> # .htaccess file, with either the 'registry' (Windows behavior) or 'script'
> # (Unix behavior) option, and will override this server default option.
> #
>
> #
> # Aliases: Add here as many aliases as you need (with no limit). The format is
> # Alias fakename realname
> #
> <IfModule mod_alias.c>
>
>      #
>      # Note that if you include a trailing / on fakename then the server will
>      # require it to be present in the URL.  So "/icons" isn't aliased in this
>      # example, only "/icons/"..
>      #
>      Alias /icons/ "C:/data/apache/icons/"
>
>      <Directory "C:/data/apache/icons">
>          Options Indexes MultiViews
>          AllowOverride None
>          Order allow,deny
>          Allow from all
>      </Directory>
>
>      #
>      # ScriptAlias: This controls which directories contain server scripts.
>      # ScriptAliases are essentially the same as Aliases, except that
>      # documents in the realname directory are treated as applications and
>      # run by the server when requested rather than as documents sent to
> the client.
>      # The same rules about trailing "/" apply to ScriptAlias directives as to
>      # Alias.
>      #
>      ScriptAlias /cgi-bin/ "C:/data/apache/cgi-bin/"
>
>      #
>      # "C:/data/apache/cgi-bin" should be changed to whatever your
> ScriptAliased
>      # CGI directory exists, if you have that configured.
>      #
>      <Directory "C:/data/apache/cgi-bin">
>          AllowOverride None
>          Options None
>          Order allow,deny
>          Allow from all
>      </Directory>
>
>      <Directory "c:/data/apache/htdocs/python">
>      	AddHandler python-program .py
>      	PythonHandler test
>      	PythonDebug on
>      </Directory>
>
> </IfModule>
> # End of aliases.
>
> #
> # Redirect allows you to tell clients about documents which used to exist in
> # your server's namespace, but do not anymore. This allows you to tell the
> # clients where to look for the relocated document.
> # Format: Redirect old-URI new-URL
> #
>
> #
> # Directives controlling the display of server-generated directory listings.
> #
> <IfModule mod_autoindex.c>
>
>      #
>      # FancyIndexing is whether you want fancy directory indexing or standard
>      #
>      # Note, add the option TrackModified to the IndexOptions default list only
>      # if all indexed directories reside on NTFS volumes.  The
> TrackModified flag
>      # will report the Last-Modified date to assist caches and proxies to
> properly
>      # track directory changes, but it does _not_ work on FAT volumes.
>      #
>      IndexOptions FancyIndexing
>
>      #
>      # AddIcon* directives tell the server which icon to show for different
>      # files or filename extensions.  These are only displayed for
>      # FancyIndexed directories.
>      #
>      AddIconByEncoding (CMP,/icons/compressed.gif) x-compress x-gzip
>
>      AddIconByType (TXT,/icons/text.gif) text/*
>      AddIconByType (IMG,/icons/image2.gif) image/*
>      AddIconByType (SND,/icons/sound2.gif) audio/*
>      AddIconByType (VID,/icons/movie.gif) video/*
>
>      AddIcon /icons/binary.gif .bin .exe
>      AddIcon /icons/binhex.gif .hqx
>      AddIcon /icons/tar.gif .tar
>      AddIcon /icons/world2.gif .wrl .wrl.gz .vrml .vrm .iv
>      AddIcon /icons/compressed.gif .Z .z .tgz .gz .zip
>      AddIcon /icons/a.gif .ps .ai .eps
>      AddIcon /icons/layout.gif .html .shtml .htm .pdf
>      AddIcon /icons/text.gif .txt
>      AddIcon /icons/c.gif .c
>      AddIcon /icons/p.gif .pl .py
>      AddIcon /icons/f.gif .for
>      AddIcon /icons/dvi.gif .dvi
>      AddIcon /icons/uuencoded.gif .uu
>      AddIcon /icons/script.gif .conf .sh .shar .csh .ksh .tcl
>      AddIcon /icons/tex.gif .tex
>      AddIcon /icons/bomb.gif core
>
>      AddIcon /icons/back.gif ..
>      AddIcon /icons/hand.right.gif README
>      AddIcon /icons/folder.gif ^^DIRECTORY^^
>      AddIcon /icons/blank.gif ^^BLANKICON^^
>
>      #
>      # DefaultIcon is which icon to show for files which do not have an icon
>      # explicitly set.
>      #
>      DefaultIcon /icons/unknown.gif
>
>      #
>      # AddDescription allows you to place a short description after a file in
>      # server-generated indexes.  These are only displayed for FancyIndexed
>      # directories.
>      # Format: AddDescription "description" filename
>      #
>      #AddDescription "GZIP compressed document" .gz
>      #AddDescription "tar archive" .tar
>      #AddDescription "GZIP compressed tar archive" .tgz
>
>      #
>      # ReadmeName is the name of the README file the server will look for by
>      # default, and append to directory listings.
>      #
>      # HeaderName is the name of a file which should be prepended to
>      # directory indexes.
>      #
>      # If MultiViews are amongst the Options in effect, the server will
>      # first look for name.html and include it if found.  If name.html
>      # doesn't exist, the server will then look for name.txt and include
>      # it as plaintext if found.
>      #
>      ReadmeName README
>      HeaderName HEADER
>
>      #
>      # IndexIgnore is a set of filenames which directory indexing should ignore
>      # and not include in the listing.  Shell-style wildcarding is permitted.
>      #
>      IndexIgnore .??* *~ *# HEADER* README* RCS CVS *,v *,t
>
> </IfModule>
> # End of indexing directives.
>
> #
> # Document types.
> #
> <IfModule mod_mime.c>
>
>      #
>      # AddEncoding allows you to have certain browsers (Mosaic/X 2.1+)
> uncompress
>      # information on the fly. Note: Not all browsers support this.
>      # Despite the name similarity, the following Add* directives have nothing
>      # to do with the FancyIndexing customization directives above.
>      #
>      AddEncoding x-compress Z
>      AddEncoding x-gzip gz tgz
>      #
>      # AddLanguage allows you to specify the language of a document. You can
>      # then use content negotiation to give a browser a file in a language
>      # it can understand.
>      #
>      # Note 1: The suffix does not have to be the same as the language
>      # keyword --- those with documents in Polish (whose net-standard
>      # language code is pl) may wish to use "AddLanguage pl .po" to
>      # avoid the ambiguity with the common suffix for perl scripts.
>      #
>      # Note 2: The example entries below illustrate that in quite
>      # some cases the two character 'Language' abbreviation is not
>      # identical to the two character 'Country' code for its country,
>      # E.g. 'Danmark/dk' versus 'Danish/da'.
>      #
>      # Note 3: In the case of 'ltz' we violate the RFC by using a three char
>      # specifier. But there is 'work in progress' to fix this and get
>      # the reference data for rfc1766 cleaned up.
>      #
>      # Danish (da) - Dutch (nl) - English (en) - Estonian (ee)
>      # French (fr) - German (de) - Greek-Modern (el)
>      # Italian (it) - Korean (kr) - Norwegian (no)
>      # Portugese (pt) - Luxembourgeois* (ltz)
>      # Spanish (es) - Swedish (sv) - Catalan (ca) - Czech(cz)
>      # Polish (pl) - Brazilian Portuguese (pt-br) - Japanese (ja)
>      # Russian (ru)
>      #
>      AddLanguage da .dk
>      AddLanguage nl .nl
>      AddLanguage en .en
>      AddLanguage et .ee
>      AddLanguage fr .fr
>      AddLanguage de .de
>      AddLanguage el .el
>      AddLanguage he .he
>      AddCharset ISO-8859-8 .iso8859-8
>      AddLanguage it .it
>      AddLanguage ja .ja
>      AddCharset ISO-2022-JP .jis
>      AddLanguage kr .kr
>      AddCharset ISO-2022-KR .iso-kr
>      AddLanguage no .no
>      AddLanguage pl .po
>      AddCharset ISO-8859-2 .iso-pl
>      AddLanguage pt .pt
>      AddLanguage pt-br .pt-br
>      AddLanguage ltz .lu
>      AddLanguage ca .ca
>      AddLanguage es .es
>      AddLanguage sv .se
>      AddLanguage cz .cz
>      AddLanguage ru .ru
>      AddLanguage tw .tw
>      AddLanguage zh-tw .tw
>      AddCharset Big5         .Big5    .big5
>      AddCharset WINDOWS-1251 .cp-1251
>      AddCharset CP866        .cp866
>      AddCharset ISO-8859-5   .iso-ru
>      AddCharset KOI8-R       .koi8-r
>      AddCharset UCS-2        .ucs2
>      AddCharset UCS-4        .ucs4
>      AddCharset UTF-8        .utf8
>
>      # LanguagePriority allows you to give precedence to some languages
>      # in case of a tie during content negotiation.
>      #
>      # Just list the languages in decreasing order of preference. We have
>      # more or less alphabetized them here. You probably want to change this.
>      #
>      <IfModule mod_negotiation.c>
>          LanguagePriority en da nl et fr de el it ja kr no pl pt pt-br ru
> ltz ca es sv tw
>      </IfModule>
>
>      #
>      # AddType allows you to tweak mime.types without actually editing it,
> or to
>      # make certain files to be certain types.
>      #
>      # For example, the PHP 3.x module (not part of the Apache distribution
> - see
>      # http://www.php.net) will typically use:
>      #
>      #AddType application/x-httpd-php3 .php3
>      #AddType application/x-httpd-php3-source .phps
>      #
>      # And for PHP 4.x, use:
>      #
>      #AddType application/x-httpd-php .php
>      #AddType application/x-httpd-php-source .phps
>
>      AddType application/x-tar .tgz
>
>      #
>      # AddHandler allows you to map certain file extensions to "handlers",
>      # actions unrelated to filetype. These can be either built into the server
>      # or added with the Action command (see below)
>      #
>      # If you want to use server side includes, or CGI outside
>      # ScriptAliased directories, uncomment the following lines.
>      #
>      # To use CGI scripts:
>      #
>      #AddHandler cgi-script .cgi
>
>      #
>      # To use server-parsed HTML files
>      #
>      #AddType text/html .shtml
>      #AddHandler server-parsed .shtml
>
>      #
>      # Uncomment the following line to enable Apache's send-asis HTTP file
>      # feature
>      #
>      #AddHandler send-as-is asis
>
>      #
>      # If you wish to use server-parsed imagemap files, use
>      #
>      #AddHandler imap-file map
>
>      #
>      # To enable type maps, you might want to use
>      #
>      #AddHandler type-map var
>
> </IfModule>
> # End of document types.
>
> #
> # Action lets you define media types that will execute a script whenever
> # a matching file is called. This eliminates the need for repeated URL
> # pathnames for oft-used CGI file processors.
> # Format: Action media/type /cgi-script/location
> # Format: Action handler-name /cgi-script/location
> #
>
> #
> # MetaDir: specifies the name of the directory in which Apache can find
> # meta information files. These files contain additional HTTP headers
> # to include when sending the document
> #
> #MetaDir .web
>
> #
> # MetaSuffix: specifies the file name suffix for the file containing the
> # meta information.
> #
> #MetaSuffix .meta
>
> #
> # Customizable error response (Apache style)
> #  these come in three flavors
> #
> #    1) plain text
> #ErrorDocument 500 "The server made a boo boo.
> #  n.b.  the single leading (") marks it as text, it does not get output
> #
> #    2) local redirects
> #ErrorDocument 404 /missing.html
> #  to redirect to local URL /missing.html
> #ErrorDocument 404 /cgi-bin/missing_handler.pl
> #  N.B.: You can redirect to a script or a document using server-side-includes.
> #
> #    3) external redirects
> #ErrorDocument 402 http://some.other_server.com/subscription_info.html
> #  N.B.: Many of the environment variables associated with the original
> #  request will *not* be available to such a script.
>
> #
> # Customize behaviour based on the browser
> #
> <IfModule mod_setenvif.c>
>
>      #
>      # The following directives modify normal HTTP response behavior.
>      # The first directive disables keepalive for Netscape 2.x and browsers
> that
>      # spoof it. There are known problems with these browser implementations.
>      # The second directive is for Microsoft Internet Explorer 4.0b2
>      # which has a broken HTTP/1.1 implementation and does not properly
>      # support keepalive when it is used on 301 or 302 (redirect) responses.
>      #
>      BrowserMatch "Mozilla/2" nokeepalive
>      BrowserMatch "MSIE 4\.0b2;" nokeepalive downgrade-1.0 force-response-1.0
>
>      #
>      # The following directive disables HTTP/1.1 responses to browsers which
>      # are in violation of the HTTP/1.0 spec by not being able to grok a
>      # basic 1.1 response.
>      #
>      BrowserMatch "RealPlayer 4\.0" force-response-1.0
>      BrowserMatch "Java/1\.0" force-response-1.0
>      BrowserMatch "JDK/1\.0" force-response-1.0
>
> </IfModule>
> # End of browser customization directives
>
> #
> # Allow server status reports, with the URL of http://servername/server-status
> # Change the ".localhost" to match your domain to enable.
> #
> #<Location /server-status>
> #    SetHandler server-status
> #    Order deny,allow
> #    Deny from all
> #    Allow from .localhost
> #</Location>
>
> #
> # Allow remote server configuration reports, with the URL of
> # http://servername/server-info (requires that mod_info.c be loaded).
> # Change the ".localhost" to match your domain to enable.
> #
> #<Location /server-info>
> #    SetHandler server-info
> #    Order deny,allow
> #    Deny from all
> #    Allow from .localhost
> #</Location>
>
> #
> # There have been reports of people trying to abuse an old bug from pre-1.1
> # days.  This bug involved a CGI script distributed as a part of Apache.
> # By uncommenting these lines you can redirect these attacks to a logging
> # script on phf.apache.org.  Or, you can record them yourself, using the script
> # support/phf_abuse_log.cgi.
> #
> #<Location /cgi-bin/phf*>
> #    Deny from all
> #    ErrorDocument 403 http://phf.apache.org/phf_abuse_log.cgi
> #</Location>
>
> #
> # Proxy Server directives. Uncomment the following lines to
> # enable the proxy server:
> #
> #<IfModule mod_proxy.c>
> #    ProxyRequests On
>
> #    <Directory proxy:*>
> #        Order deny,allow
> #        Deny from all
> #        Allow from .localhost
> #    </Directory>
>
>      #
>      # Enable/disable the handling of HTTP/1.1 "Via:" headers.
>      # ("Full" adds the server version; "Block" removes all outgoing Via:
> headers)
>      # Set to one of: Off | On | Full | Block
>      #
> #    ProxyVia On
>
>      #
>      # To enable the cache as well, edit and uncomment the following lines:
>      # (no cacheing without CacheRoot)
>      #
> #    CacheRoot "C:/data/apache/proxy"
> #    CacheSize 5
> #    CacheGcInterval 4
> #    CacheMaxExpire 24
> #    CacheLastModifiedFactor 0.1
> #    CacheDefaultExpire 1
> #    NoCache a_domain.com another_domain.edu joes.garage_sale.com
>
> #</IfModule>
> # End of proxy directives.
>
> ### Section 3: Virtual Hosts
> #
> # VirtualHost: If you want to maintain multiple domains/hostnames on your
> # machine you can setup VirtualHost containers for them. Most configurations
> # use only name-based virtual hosts so the server doesn't need to worry about
> # IP addresses. This is indicated by the asterisks in the directives below.
> #
> # Please see the documentation at <URL:http://www.apache.org/docs/vhosts/>
> # for further details before you try to setup virtual hosts.
> #
> # You may use the command line option '-S' to verify your virtual host
> # configuration.
>
> #
> # Use name-based virtual hosting.
> #
> #NameVirtualHost *
>
> #
> # VirtualHost example:
> # Almost any Apache directive may go into a VirtualHost container.
> # The first VirtualHost section is used for requests without a known
> # server name.
> #
> #<VirtualHost *>
> #    ServerAdmin webmaster@dummy-host.example.com
> #    DocumentRoot /www/docs/dummy-host.example.com
> #    ServerName dummy-host.example.com
> #    ErrorLog logs/dummy-host.example.com-error_log
> #    CustomLog logs/dummy-host.example.com-access_log common
> #</VirtualHost>
>
>
>
> Apologies for the size of this email, I just need to get this problem
> sorted ASAP. Any help will be greatly appreciated.
>
>
>
>
>
>
>
>
> -------------------------------------------
> Paul De Luca
> Email: pdeluca@sia.net.au
> Ph: 0414 225561
> -------------------------------------------
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From LinscombeJ at cmalliance.org  Thu May 24 09:02:11 2001
From: LinscombeJ at cmalliance.org (Linscombe, Jason)
Date: Fri Jan  9 22:02:45 2004
Subject: [mod_python] SuSE 7.1 RPM mod_python & apache
Message-ID: <CE1A83EC8461D311A81F0060B03C7CAAEF4FE0@mail1.cmalliance.org>

Hi List,

I'm trying to run mod_python over apache and could use some help setting
this up.  Here is my setup...

Apache-1.3.14-6
Python-2.0-6
mod_python-2.7.1-3
Distro: SuSE 7.1 Installed the above with RPM

Here is the python stuff in my httpd.conf
-----------------------------------------------------------------
<IfDefine PYTHON>
LoadModule python_module	/usr/lib/apache/mod_python.so
</IfDefine>

<IfDefine PYTHON>
AddModule mod_python.c
</IfDefine>

<Directory /usr/local/httpd/htdocs/test> 
  AddHandler python-program .py
  PythonHandler mptest 
  PythonDebug On 
</Directory>
-----------------------------------------------------------------


And I have this in a file called /usr/local/httpd/htdocs/test/mptest.py
-----------------------------------------------------------------
from mod_python import apache

def handler(req):
    req.send_http_header()
    req.write("Hello World!")
    return apache.OK
-----------------------------------------------------------------


I have checked all file permissions and everything seems to be OK.  All of
the above was either default in my httpd.conf or what I found in the
"Testing" page on the documentation.  The problem I'm having is with the
above, I try to start apache and I get the following error:

FAILED:  See /var/log/httpd/rcapache.log for details

here is the rcapache.log file...
-----------------------------------------------------------------
Syntax error on line 1634 of /etc/httpd/httpd.conf
Invalid command 'PythonHandler', perhaps mis-spelled or defined by a module
not included in the server configuration.
-----------------------------------------------------------------


Question:  is this mptest.py file necessary for running python scripts over
the web server or is this simply a test?  Being a python newbie, I don't
really know what to do next.  Thanks in advance for any help!

jason


From LinscombeJ at cmalliance.org  Thu May 24 12:20:23 2001
From: LinscombeJ at cmalliance.org (Linscombe, Jason)
Date: Fri Jan  9 22:02:45 2004
Subject: [mod_python] SuSE 7.1 RPM mod_python & apache
Message-ID: <CE1A83EC8461D311A81F0060B03C7CAAEF4FE4@mail1.cmalliance.org>

I tried to simplify things and took it out of the <IfDefine PYTHON> tags and
placed the LoadModule and AddModule lines in the normal place (along with
all the others.  But I'm getting the same error as before.  Does the
<Directory /some/directory/htdocs/test> need to be placed inside another set
of tags or can it simply be appended at the end of the file?  I have it as
the last 5 lines of my httpd.conf

jason



-----Original Message-----
From: Alain T?sio
Sent: Thursday, May 24, 2001 10:54 AM


Hi, I have the same setup without "<IfDefine PYTHON>" and it works ...

Alain



----- Original Message -----
From: "Linscombe, Jason" <LinscombeJ@cmalliance.org>
To: <mod_python@modpython.org>
Sent: Thursday, May 24, 2001 5:02 PM
Subject: [mod_python] SuSE 7.1 RPM mod_python & apache


>
> Hi List,
>
> I'm trying to run mod_python over apache and could use some help setting
> this up.  Here is my setup...
>
> Apache-1.3.14-6
> Python-2.0-6
> mod_python-2.7.1-3
> Distro: SuSE 7.1 Installed the above with RPM
>
> Here is the python stuff in my httpd.conf
> -----------------------------------------------------------------
> <IfDefine PYTHON>
> LoadModule python_module /usr/lib/apache/mod_python.so
> </IfDefine>
>
> <IfDefine PYTHON>
> AddModule mod_python.c
> </IfDefine>
>
> <Directory /usr/local/httpd/htdocs/test>
>   AddHandler python-program .py
>   PythonHandler mptest
>   PythonDebug On
> </Directory>
> -----------------------------------------------------------------
>
>
> And I have this in a file called /usr/local/httpd/htdocs/test/mptest.py
> -----------------------------------------------------------------
> from mod_python import apache
>
> def handler(req):
>     req.send_http_header()
>     req.write("Hello World!")
>     return apache.OK
> -----------------------------------------------------------------
>
>
> I have checked all file permissions and everything seems to be OK.  All of
> the above was either default in my httpd.conf or what I found in the
> "Testing" page on the documentation.  The problem I'm having is with the
> above, I try to start apache and I get the following error:
>
> FAILED:  See /var/log/httpd/rcapache.log for details
>
> here is the rcapache.log file...
> -----------------------------------------------------------------
> Syntax error on line 1634 of /etc/httpd/httpd.conf
> Invalid command 'PythonHandler', perhaps mis-spelled or defined by a
module
> not included in the server configuration.
> -----------------------------------------------------------------
>
>
> Question:  is this mptest.py file necessary for running python scripts
over
> the web server or is this simply a test?  Being a python newbie, I don't
> really know what to do next.  Thanks in advance for any help!
>
> jason
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

From meyer at diku.dk  Fri May 25 02:36:14 2001
From: meyer at diku.dk (Jonas Meyer Rasmussen)
Date: Fri Jan  9 22:02:45 2004
Subject: [mod_python] mod_python on win32
Message-ID: <OHENJJENEHAEEPAOJBHCOEDDCCAA.meyer@diku.dk>

Hi.
I am having alot of trouble getting mod_python to work...
(win32, Win2k Pro, Python 2.1)
apache just denies to load the module in, giving me this error:

Syntax error on line 206 of c:/progra..../httpd.conf:
Cannot load c:/.../apache/modules/mod_python.dll into server: (126) The
specified module could not be found:


I have done this:
added this to httpd.conf:

#placed after other uncommented LoadModules from std config file
LoadModule python_module modules/mod_python.dll


#placed in ifmodule mod_alias.c section
    <Directory "C:/Apache/cgi-bin">
        AddHandler python-program .py
        PythonHandler mptest
        PythonDebug on
    </Directory>



mod_python.dll is in the right place


made a small file in my apache/cgi-bin dir named mptest
which contains the following:

from mod_python import apache

def handler(req):
    req.content_type = "text/plain"
    req.send_http_header()
    req.write("Hello World!")
    return apache.OK


Jonas Meyer Rasmussen


From meyer at diku.dk  Fri May 25 13:03:55 2001
From: meyer at diku.dk (Jonas Meyer Rasmussen)
Date: Fri Jan  9 22:02:45 2004
Subject: [mod_python] mod_python on win32
In-Reply-To: <990766580.3b0de5f4623bb@webmail.uchicago.edu>
Message-ID: <Pine.LNX.4.21.0105251302310.11535-100000@dvalin.diku.dk>

On Thu, 24 May 2001, douglas savitsky wrote:
> 
> I recently upgraded from Python 2.0 to 2.1, and I notice that I am getting the 
> same error.  Perhaps if you go back to 2.0 and see if that works?

Yep that fixed the problem, thank you.

Now i just keep getting an internal server error when i try to load my
mptest.py, it says something about obcallback failed to init
?!?


Jonas Meyer Rasmussen
meyer@diku.dk



From rsalz at zolera.com  Fri May 25 09:41:44 2001
From: rsalz at zolera.com (Rich Salz)
Date: Fri Jan  9 22:02:45 2004
Subject: [mod_python] More file-like behavior
Message-ID: <3B0E6118.9BD61868@zolera.com>

The attached class provides a more complete implementation of Python's
file object.  We'd be quite pleased if it were accepted into the core.
:)
	/r$
-------------- next part --------------
#! /usr/bin/env python
##  ContentReader -- wrapper class for mod_python's request object that
##  provides a more complete set of file methods.
##  Copyright 2001, Zolera Systems, Inc.  All Rights Reserved.
##  This software is distributed under the terms of the mod_python license.
try:
    import xreadlines
except:
    pass

class ContentReader:
    '''A simple object that provides a minimal set of file methods from a
    mod_python request object.  Methods provided: read, readline, readlines,
    close, flush, and tell (and, if available, xreadlines).
    Attributes provided: closed, mode, and name.
    '''

    def __init__(self, req):
	'''req is the mod_python request handler.'''
	self.size = int(req.headers_in['content-length'])
	self.name = '<%s at 0x%x>' % (str(self.__class__), id(self))
	self.req, self.left, self.closed, self.mode = \
		req, self.size, 0, 'r'

    def read(self, size = 0):
	if self.closed: raise ValueError
	if self.left <= 0: return ''
	if size <= 0: size = self.left
	v = self.req.read(size)
	self.left = self.left - len(v)
	return v

    def readline(self, size = 0):
	v = self.req.readline(size)
	if len(v) > 1 and v[-2:] == '\r\n': v = v[:-2] + '\n'
	return v

    def readlines(self, sizehint = None):
	result = []
	while 1:
	    l = x.readline()
	    if l == '': break
	    result.append(l)
	    if sizehint != None:
		sizehint = sizehint - len(l)
		if sizehint <= 0: break
	return result

    def xreadlines(self):
	return xreadlines.xreadlines(self)

    def tell(self):
	return self.size - self.left

    def close(self):
	self.closed = 1

    def flush(self):
	pass
From paullb at bigfoot.com  Fri May 25 17:14:21 2001
From: paullb at bigfoot.com (Brendan Paull)
Date: Fri Jan  9 22:02:45 2004
Subject: [mod_python] Multiple versions on one machine
Message-ID: <5.0.2.1.2.20010525170709.00a0eec0@pop.minet.ca>

Hi,
	On my Red Hat 7.0 system I have two versions of python installed (1.5 and 
2.1) andt hey both work fine. They can be called by typing python1.5 and 
python2.1. I could not deinstall the RPM for 1.5 because there are many 
things that depended on it in my system. However, I have got my mod_python 
(v2.7) working and I can call scripts from inside the html directory 
(/var/www/html/python/ and HTML files for apache are in /var/www/html). 
However, mod_python sees only 1.5. How do I go about getting it to see the 
2.1 as well?

	Also, how would I go about getting python to work as a CGI interpreter, 
again preferably the 2.1 version. I already have perl5 working on the 
system? Is there a how-to somewhere?

I would appreciate any insight into either on of these questions,

Thank you in advance,

Brendan Paull


From grisha at modpython.org  Fri May 25 18:14:02 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:02:45 2004
Subject: [mod_python] Multiple versions on one machine
In-Reply-To: <5.0.2.1.2.20010525170709.00a0eec0@pop.minet.ca>
Message-ID: <Pine.BSF.4.32.0105251812480.47409-100000@localhost>

mod_python will most likely "see" the one that is invocable as "python"
during compilation. Do you have a python -> python1.5 symlink?

Grisha

On Fri, 25 May 2001, Brendan Paull wrote:

> Hi,
> 	On my Red Hat 7.0 system I have two versions of python installed (1.5 and
> 2.1) andt hey both work fine. They can be called by typing python1.5 and
> python2.1. I could not deinstall the RPM for 1.5 because there are many
> things that depended on it in my system. However, I have got my mod_python
> (v2.7) working and I can call scripts from inside the html directory
> (/var/www/html/python/ and HTML files for apache are in /var/www/html).
> However, mod_python sees only 1.5. How do I go about getting it to see the
> 2.1 as well?
>
> 	Also, how would I go about getting python to work as a CGI interpreter,
> again preferably the 2.1 version. I already have perl5 working on the
> system? Is there a how-to somewhere?
>
> I would appreciate any insight into either on of these questions,
>
> Thank you in advance,
>
> Brendan Paull
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From grisha at modpython.org  Sun May 27 00:52:37 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:02:45 2004
Subject: [mod_python] More file-like behavior
In-Reply-To: <3B0E6118.9BD61868@zolera.com>
Message-ID: <Pine.BSF.4.32.0105270050470.64009-100000@localhost>

Thanks Rich.

Can you elaborate a bit or give some example on how something like this
would be used? I.e. what advantage it would have over simply doing
req.write() or req.read()?

I'm just trying to get a better idea of how it would fit into mod_python.
:-)

Grisha

On Fri, 25 May 2001, Rich Salz wrote:

> The attached class provides a more complete implementation of Python's
> file object.  We'd be quite pleased if it were accepted into the core.
> :)
> 	/r$


From markb at well.com  Sun May 27 10:27:38 2001
From: markb at well.com (Mark Berry)
Date: Fri Jan  9 22:02:45 2004
Subject: [mod_python] Cookies, Redirects & Headers - Oh My!
Message-ID: <200105271028.DAA01579@smtp.well.com>

Hello List,

After spending almost 2 hours wrestling with the cookies and headers 
from the publisher,  I might suggest that we add a few simple examples 
into the standard documentation showing how to do very  basic but common 
operations.

Also, is there no reason that the publisher couldn't be extended at the 
core level to have something such as session management (using python 
pickling methods) for basic serialization, etc.  Is mod_python kept at 
grass-roots for a good reason? ;-)

I must say that with exceptions of a pool of example code, mod_python 
has been a pleasure to work with.  I would be happy to submit some 
example code to be put into the documentation if interested.

Cheers

.mark

From rsalz at zolera.com  Sun May 27 08:04:05 2001
From: rsalz at zolera.com (Rich Salz)
Date: Fri Jan  9 22:02:45 2004
Subject: [mod_python] More file-like behavior
References: <Pine.BSF.4.32.0105270050470.64009-100000@localhost>
Message-ID: <3B10ED35.CD0D36BC@zolera.com>

> Can you elaborate a bit or give some example on how something like this
> would be used? I.e. what advantage it would have over simply doing
> req.write() or req.read()?

It's a more complete implementation, so anyplace that wants a file
object can pass
	ContentReader(req)

Now, maybe most things just use req.read(), but we (at least) had some
code that wanted filename, etc.
	/r$

From deneb at unixwave.org  Sun May 27 22:12:38 2001
From: deneb at unixwave.org (Deneb)
Date: Fri Jan  9 22:02:45 2004
Subject: [mod_python] Template Class
Message-ID: <20010527221238.A3112@unixwave.org>

Hi,
all just yesterday i finished well a Template Class in order to use it
with modpython, higly ispired from PHPlib Template class, which is 
suitable for all purpose. Actually i use it in some of my projects.
A correct example on how it works, can be found in the PHPlib docs,
at phplib.netuse.de. 
I hope that you find this useful. The code is in the attach.
 
Cheers,
deneb.
 
-------------- next part --------------
#!/usr/bin/python
""" 
/*
 *  PyTemplate - a Simple Python Template Class
 *  Copyright (C) 2001 Giorgio Zoppi <deneb@unixwave.org>
 *
 *  This program is free software; you can redistribute it and/or modify
 *  it under the terms of the GNU General Public License as published by
 *  the Free Software Foundation; either version 2 of the License, or
 *  (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU General Public License for more details.
 *
 *  You should have received a copy of the GNU General Public License
 *  along with this program; if not, write to the Free Software
 *  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 */

This Template file was strictly ported form PHPLIB Template class.
Begin from the port:
28 May 2001

"""
import sys
import re
import os
import string

from stat import *
from types import *

class PyTemplate:
    """A simple Template class"""
    __classname='PyTemplate'
    """0 -> False, 1-> True"""
    __debug	=	1
    __root	=	os.getcwd();
    __unknowns    =       "remove"
    __file	= {}
    __varkeys     = {}
    __varvals     = {}
    __halt_on_error = "yes"
    __last_error    = ""
    
    def __init__(self,root,unknows="remove"):
        self.set_root(root)
	self.set_unknowns(unknows)
	
    def set_root(self,root):
	"""I check if the directory exists"""
	mode = os.stat(root)[ST_MODE]
	if S_ISDIR(mode):
	    """0 -> False, 1-> True"""
	    self.__root=root
	    return 1
	return 0
    def set_unknowns(self,unk):
	self.__unknowns=unk
    def set_file(self,handle,myfile=''):
        if not (type(handle) is DictType):
	    if (myfile==''):
		return 0
	    else:
		self.__file[handle]=self.__filename(myfile)
	else:
	    for (h,f) in handle.items():
		self.__file[h]=self.__filename(f)
		    
    def set_block(self,parent,handle,name=''):
	if not(self.__loadfile(parent)):
	    return 0
	if (name==''):
	    name=handle
	vstr=self.get_var(parent)
	str2 = ''
	for value in vstr:
	    str2 = str2 + value
	reg=r"<!--\s+BEGIN "+handle+"\s+-->(.*)<!--\s+END "+ handle+ "\s+-->"
	matchreg=re.compile(reg,re.S|re.M)
	m=matchreg.findall(str2)
	vname='{' + name + '}'
	vstr2=matchreg.sub(vname,str2)
	self.set_var(name,'')
	self.set_var(handle,m[0])
	self.set_var(parent,vstr2)
    
    def set_var(self,varname1,value=''):
	if not (type(varname1) is DictType):
	    self.__varkeys[varname1]=self.__varname(varname1)
	    self.__varvals[varname1]=value
	else:
	    for vname in varname1.keys():
		self.__varkeys[vname]=self.__varname(vname) 
		self.__varvals[vname]=varname1[vname]
		
	    
    def subst(self,handle):
	if not(self.__loadfile(handle)):
	    return 0
	
	vstr=self.get_var(handle)
	regstr = ''
	for values in vstr:
	    regstr= regstr + values
	vvals= self.__varvals.keys()
	kvals= self.__varkeys.keys()
	key1,key2='',''
	i,j=0,0
	len1,len2=len(vvals),len(kvals)
	while ((i<len1) and (j<len2)):
		key2 = vvals[i]
		key1 = kvals[j]
		vareg=re.compile(self.__varkeys[key1])
    		regstr=vareg.sub(self.__varvals[key2],regstr)
		i,j=i+1,j+1
	return regstr    
    def	psubst(self,handle):
	print self.subst(handle)
	return 0
    def tmpl2str(self,varname):
	return self.finish(self.get_var(varname))
    def parse(self,target,handle, append):
	if not (type(handle) is DictType):
    		vstr=self.subst(handle)
	        if (append==1):
		    mvar = self.get_var(target) + vstr
		    self.set_var(target,mvar)
		else:
		    self.set_var(target,vstr)
	else:	
		vstr = ''	
		for (hname,hvalue) in handle.items():
		    vstr=self.subst(hvalue)  
		    self.set_var(target,vstr)
	#print t.varvals	    
	return vstr
    def get_vars(self): 
	for kname in self.__varkeys.keys():
	    result[kname]=self.__varvals[kname]
	return result
    def get_var(self,varname):
        if not (type(varname) is DictType):
 	    return self.__varvals[varname]
	     
	else:
	    for vname in varname.keys():
		result[vname]=self.__varvals[vname]
	return result
    """def get_undefined --> not implemented"""	    
    def finish(self,vstr):
        regstr1=re.compile('{\[^}+}')
	if (self.__unknowns=="comment"):
	    regstr1.sub("<!--Template not defined -->",vstr)
	elif (self.__unknowns=="remove"):
	    regstr1.sub("",vstr);
	else:
	    self.__unknowns= "keep" """Nothing to do"""
	return vstr	    
    def p(self,varname):
	print self.finish(self.get_var(varname))
    def get(self,varname):
	return self.finish(self.get_var(varname))
    def __filename(self,filename):
	slice=string.find(filename,'/',0,1)
	if (slice==-1):
	    filename= self.__root + '/' + filename
	if not (os.path.isfile(filename)):
	    filename = 0
	return filename
    def __varname(self,varname1):
        var = '{' + varname1 + '}'
	return var
    def __loadfile(self,handle):
	try:
	    if ((self.__varkeys[handle]) and (not (self.__varvals[handle]==''))):
		    return 1
	except KeyError: 
	       new=1
	try:
	   name=self.__file[handle]
	except KeyError:
	    return 0
	filename= self.__filename(name)
	file=open(filename,'r')
	vstr=file.readlines()
	self.set_var(handle,vstr)
	return 1

 		    				        	    
From bl at netgroup.dk  Tue May 29 10:09:19 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 22:02:45 2004
Subject: [mod_python] Session data
Message-ID: <3B13592F.DB5633BB@netgroup.dk>

Hi ...

I have been trying to write a entry in the mod_python FAQ, but I'm a
quite inpatient person, so I'll ask here too :-)

I really like the way this mod_python thing works, but I have
desperately trying to find a way to store session based data, but
without luck.

Is there a way, or is it necessary to store the session data in a
separate data array, that is mapped to some kind of user Apache info ?
This could be a dumb question, as my knowledge about Apache is quite
limited, so I hope you will forgive if this should be quite obvious.


/BL


From grisha at modpython.org  Tue May 29 08:35:11 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:02:45 2004
Subject: [mod_python] Session data
In-Reply-To: <3B13592F.DB5633BB@netgroup.dk>
Message-ID: <Pine.BSF.4.32.0105290826550.99341-100000@localhost>

This does indeed seem to be a FAQ, but I don't know if there is a straight
answer to it.

In *my* opinion, trying to maintain state within the server is not
scalable and should be avoided. State should be maintained on the client
side with cookies and url's.

Since Apache 1.3 runs multiple processes, it is impossible to share memory
between them and therefore maintain state in the server.

But even with the new Apache 2.0 (which mod_python does not yet support),
which will be multithreaded, I would stay away from putting state on the
server. If I ever decided that my site is too busy and needs balancing
across multiple servers, I'd be in trouble... Also consider situations
when a request may never reach a server because of some cache inbewteen.

Grisha

On Tue, 29 May 2001, Bo Lorentsen wrote:

> Hi ...
>
> I have been trying to write a entry in the mod_python FAQ, but I'm a
> quite inpatient person, so I'll ask here too :-)
>
> I really like the way this mod_python thing works, but I have
> desperately trying to find a way to store session based data, but
> without luck.
>
> Is there a way, or is it necessary to store the session data in a
> separate data array, that is mapped to some kind of user Apache info ?
> This could be a dumb question, as my knowledge about Apache is quite
> limited, so I hope you will forgive if this should be quite obvious.
>
>
> /BL
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From bl at netgroup.dk  Tue May 29 14:50:28 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 22:02:45 2004
Subject: [mod_python] Session data
References: <Pine.BSF.4.32.0105290826550.99341-100000@localhost>
Message-ID: <3B139B14.26DF8717@netgroup.dk>

"Gregory (Grisha) Trubetskoy" wrote:

> In *my* opinion, trying to maintain state within the server is not
> scalable and should be avoided. State should be maintained on the client
> side with cookies and url's.

If this is so, shouldn't there be some sort of interface for this ? Or is
this something I should have known more about if I had known the Apache
server better ?

> Since Apache 1.3 runs multiple processes, it is impossible to share memory
> between them and therefore maintain state in the server.

Aha, so this is why the JavaServer make its own service, the Apache direct
requests to !

> But even with the new Apache 2.0 (which mod_python does not yet support),
> which will be multithreaded, I would stay away from putting state on the
> server. If I ever decided that my site is too busy and needs balancing
> across multiple servers, I'd be in trouble... Also consider situations
> when a request may never reach a server because of some cache inbewteen.

You absolutely got a point there.

I just need to gain knowledge about some other ways of maintaining session
data, as until now, I thought that a cookie were just a session reference
number of a kind.

/BL


From jvdev at 3va.net  Tue May 29 15:00:15 2001
From: jvdev at 3va.net (Jeroen van Drie)
Date: Fri Jan  9 22:02:45 2004
Subject: [mod_python] httpd dead but subsys locked
Message-ID: <01052915001503.01699@e109009>

situation:
mod_python, RH 6.2, MySQL-3.23.38-1 all RPM based.

When starting up httpd and running httpd status it returns:
httpd dead but subsys locked

No instance of httpd is found running.

When removing the two mod_python dso lines in the httpd.conf it starts up 
fine.

I have seen these errors on some php mailing lists as well where people seem 
to be relating it to the presence of mysql. There is nothign in the apache 
log file even at debug log level.

A restart of mysql did not help.

I have read that the situation in case of php will be resolved with a server 
reboot. However in this case that would be impractical.

Have any of you experienced this problem and have you found a solution?

Thanks.

From aiglauer at yahoo.com  Tue May 29 06:41:57 2001
From: aiglauer at yahoo.com (Alexis Iglauer)
Date: Fri Jan  9 22:02:46 2004
Subject: [mod_python] httpd dead but subsys locked
In-Reply-To: <01052915001503.01699@e109009>
Message-ID: <20010529134157.247.qmail@web13905.mail.yahoo.com>

My experience is under various versions of Mandrake and Apache 1.3.x.

That message usually comes if apache segfaults.  Check your /var/run
directory for httpd.pid and delete it.

Try running 'httpd -X' to see what error messages you get (often the
problem is threading support or not having the LoadModule line for
mod_python as the first LoadModule in httpd.conf).  My apache always
just crashed - with no debug info - when I loaded a .py file.

Once you have that sorted out (httpd -X runs fine), I find that
'/etc/rc.d/init.d/httpd restart' usually does the trick if you have the
'locked subsystem' error message on starting apache.

Hope this helps
ax

--- Jeroen van Drie <jvdev@3va.net> wrote:
> 
> situation:
> mod_python, RH 6.2, MySQL-3.23.38-1 all RPM based.
> 
> When starting up httpd and running httpd status it returns:
> httpd dead but subsys locked
> 
> No instance of httpd is found running.
> 
> When removing the two mod_python dso lines in the httpd.conf it
> starts up 
> fine.
> 
> I have seen these errors on some php mailing lists as well where
> people seem 
> to be relating it to the presence of mysql. There is nothign in the
> apache 
> log file even at debug log level.
> 
> A restart of mysql did not help.
> 
> I have read that the situation in case of php will be resolved with a
> server 
> reboot. However in this case that would be impractical.
> 
> Have any of you experienced this problem and have you found a
> solution?
> 
> Thanks.
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


__________________________________________________
Do You Yahoo!?
Yahoo! Auctions - buy the things you want at great prices
http://auctions.yahoo.com/

From sam at webslingerZ.com  Tue May 29 09:40:32 2001
From: sam at webslingerZ.com (Sam Brauer)
Date: Fri Jan  9 22:02:46 2004
Subject: [mod_python] Session data
In-Reply-To: <3B139B14.26DF8717@netgroup.dk>
Message-ID: <Pine.LNX.4.31.0105290917340.30341-100000@localhost.localdomain>

On Tue, 29 May 2001, Bo Lorentsen wrote:
<snip>
> I just need to gain knowledge about some other ways of maintaining session
> data, as until now, I thought that a cookie were just a session reference
> number of a kind.
>
> /BL

I think the most portable method (a method with the least
dependency on any particular webserver or application server) is to
maintain the session state in a relational database table and store the
table key value in a cookie.
When a user first hits your site, check for the cookie.
If it exists and matches a record in your table, then treat that record as
that user's session data.
Otherwise, insert a new record and set a session cookie with the key value
of the newly created record.

For applications where security is not a major concern, this method should
be sufficient.  If security is a major concern, you will want to avoid
storing the cookie value as plain text and instead encrypt it in some way.
Also, you may want to set a short expiration time for the cookie, and
perhaps reset it every time you send a response to the user.  You might
also (again, depending on the type of application) want to provide an
explicit logout function that unsets the cookie.
You could also have a field in your table that contains a timestamp that
gets updated every time a request for that session comes in.  Before
updating the field, you might compare its current value with the current
time.  If the difference is greater than some time limit (say 30 minutes),
then you could error out and respond to the user that their session has
expired.

How complicated and secure you want to make it is up to you.

Regards,
Sam Brauer



From jvdev at 3va.net  Tue May 29 16:48:31 2001
From: jvdev at 3va.net (Jeroen van Drie)
Date: Fri Jan  9 22:02:46 2004
Subject: [mod_python] httpd dead but subsys locked
In-Reply-To: <20010529134157.247.qmail@web13905.mail.yahoo.com>
References: <20010529134157.247.qmail@web13905.mail.yahoo.com>
Message-ID: <01052916483108.01699@e109009>

On Tuesday 29 May 2001 15:41 pm, you wrote:

Hi Ax,

When loading with -X i get the "
Loaded DSO modules/mod_python.so uses plain Apache 1.3 API, this module might 
crash under EAPI! (please recompile it with -DEAPI)" 
and it segfaults.

It's the first module defined in httpd.conf.

that hasn't been causing any problems on my 7.1 rh test system and from 
numerous reports I've read people generally seem to disregard the warning.

I got the sources,  edited the Makefile to run apxs with -DEAPI as an 
argument, which however caused the same error and segfault.

I would dearly like to see this issue resolved and if theres anything I can 
do to contribute towards solving it i'd be happy to contribute my time. 



> My experience is under various versions of Mandrake and Apache 1.3.x.
>
> That message usually comes if apache segfaults.  Check your /var/run
> directory for httpd.pid and delete it.
>
> Try running 'httpd -X' to see what error messages you get (often the
> problem is threading support or not having the LoadModule line for
> mod_python as the first LoadModule in httpd.conf).  My apache always
> just crashed - with no debug info - when I loaded a .py file.
>
> Once you have that sorted out (httpd -X runs fine), I find that
> '/etc/rc.d/init.d/httpd restart' usually does the trick if you have the
> 'locked subsystem' error message on starting apache.
>
> Hope this helps
> ax
>
> --- Jeroen van Drie <jvdev@3va.net> wrote:
> > situation:
> > mod_python, RH 6.2, MySQL-3.23.38-1 all RPM based.
> >
> > When starting up httpd and running httpd status it returns:
> > httpd dead but subsys locked
> >
> > No instance of httpd is found running.
> >
> > When removing the two mod_python dso lines in the httpd.conf it
> > starts up
> > fine.
> >
> > I have seen these errors on some php mailing lists as well where
> > people seem
> > to be relating it to the presence of mysql. There is nothign in the
> > apache
> > log file even at debug log level.
> >
> > A restart of mysql did not help.
> >
> > I have read that the situation in case of php will be resolved with a
> > server
> > reboot. However in this case that would be impractical.
> >
> > Have any of you experienced this problem and have you found a
> > solution?
> >
> > Thanks.
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://www.modpython.org/mailman/listinfo/mod_python
>
> __________________________________________________
> Do You Yahoo!?
> Yahoo! Auctions - buy the things you want at great prices
> http://auctions.yahoo.com/

From SumnerH at fool.com  Tue May 29 13:03:49 2001
From: SumnerH at fool.com (G . Sumner Hayes)
Date: Fri Jan  9 22:02:46 2004
Subject: [mod_python] Session data
In-Reply-To: <Pine.BSF.4.32.0105290826550.99341-100000@localhost>; from grisha@modpython.org on Tue, May 29, 2001 at 08:35:11AM -0400
References: <3B13592F.DB5633BB@netgroup.dk> <Pine.BSF.4.32.0105290826550.99341-100000@localhost>
Message-ID: <20010529130349.A17514@fool.com>

Gregory (Grisha) Trubetskoy <grisha@modpython.org> wrote:
> Since Apache 1.3 runs multiple processes, it is impossible to share memory
> between them and therefore maintain state in the server.

You can use either shared mmap or SysV shared mem (there are
python modules for both) to share memory.  I wound up writing
a Python shared dictionary (just pickles objects into the
filesystem when you set them, and unpickles them when you read
them) for my shared state, though I don't share user sessions--I
share things like parsed template files and other cacheable
server-side objects that require an expensive calculation the
first time they're read in.

Same idea would work for user sessions, and since it's in the
filesystem the kernel will take care of buffering for you and you
can use tools like "find" and "rm" to prune the cache. :-)

I agree with Grisha that you probably want to keep state on the
clients if you can, though.

  Sumner

-- 
rage, rage against the dying of the light

From CHagner at fool.com  Tue May 29 13:08:01 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 22:02:46 2004
Subject: [mod_python] Session data
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E47E7D@rover.foolhq.com>

In my experience, the quickest way to ensure that your web application
scales poorly is to mis-use server-side user sessions (thereby agreeing with
Grisha).  Now, that being said, not everyone needs this level of scalability
AND user sessions are a standard part of almost every-single web application
platform (ASP, Servlets/JSP, ColdFusion, etc.) commercially available.

BTW, I've found that most non-Apache-based web developers (of which I used
to be one :-) are completely ignorant of the realities of running in a
multi-process server.  They generally take for granted the user sessions
built into whatever app server they're using and find it mentally
challenging to truly believe they can live without such functionality.

I like the idea of having a standard interface to whatever mechanism is
responsible for persisting user session information, but I cringe at
incorporating an implementation with mod_python.  Basically, for some people
a pickled object will work fine.  For others a database-based session system
works best.  And some (Grisha) will only be happy with the use of
cookies/urls.

As for multiple-server user sessions, there are some solutions available in
the non-Python space (most of the ones that I've seen use either a database
(ugh :-) or a solution along the lines of Java's RMI to keep the session
pool's in sync.  In either case, it is a non-trivial problem/solution and is
best avoided (following the KISS principle).

You might want to check out WebWare (webware.sourceforge.net) as an expample
web framework that has some session support.  I think they pickle objects to
the file system.  There are some other python-based cgi frameworks that also
support user sessions, but just be aware of how far such solutions will/will
not take you.

Chris

-----Original Message-----
From: Bo Lorentsen [mailto:bl@netgroup.dk]
Sent: Tuesday, May 29, 2001 8:50 AM
To: Gregory (Grisha) Trubetskoy
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Session data


"Gregory (Grisha) Trubetskoy" wrote:

> In *my* opinion, trying to maintain state within the server is not
> scalable and should be avoided. State should be maintained on the client
> side with cookies and url's.

If this is so, shouldn't there be some sort of interface for this ? Or is
this something I should have known more about if I had known the Apache
server better ?

> Since Apache 1.3 runs multiple processes, it is impossible to share memory
> between them and therefore maintain state in the server.

Aha, so this is why the JavaServer make its own service, the Apache direct
requests to !

> But even with the new Apache 2.0 (which mod_python does not yet support),
> which will be multithreaded, I would stay away from putting state on the
> server. If I ever decided that my site is too busy and needs balancing
> across multiple servers, I'd be in trouble... Also consider situations
> when a request may never reach a server because of some cache inbewteen.

You absolutely got a point there.

I just need to gain knowledge about some other ways of maintaining session
data, as until now, I thought that a cookie were just a session reference
number of a kind.

/BL

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python

From gtalvola at nameconnector.com  Tue May 29 14:04:15 2001
From: gtalvola at nameconnector.com (Geoff Talvola)
Date: Fri Jan  9 22:02:46 2004
Subject: [mod_python] Win32 threading issue
Message-ID: <5.0.2.1.0.20010529134743.02ca2d30@infratest1>

I just wanted to confirm that I also get the same behavior on Windows -- if 
I stress out a simple script like the one below with multiple simultaneous 
requests, I get sporadic errors, just as Chris Trengove reported.

I'd be happy to help diagnose and fix the problem, but I know next to 
nothing about Apache and mod_python's internals.  I do have access to VC++ 
6.0 and I have successfully compiled the mod_python dll (for Python 2.1).

Where should I go from here?

>I have been testing the following script on Apache with mod_python (Apache
>1.13.17, mod_python 2.7.2, Windows 2000). I have been interested in testing
>the possible throughput of this (and more useful scripts), so I have
>another Python script which continually loads this "page".
>
>from mod_python import apache
>import thread
>
>def handler(req):
>     req.content_type = "text/plain"
>     req.send_http_header()
>     req.write("%d\n" % thread.get_ident())
>     return apache.OK
>
>When I run more than one copy of the driver script (in multiple consoles),
>I get behavior indicative of some threading problems. Specifically, some
>connections get "lost", the Apache error log reports various instances of
>"IOError: Write failed...", and I occassionally get an access violation
>inside Apache. Similarly, if I only run one copy of the driver script, and
>just keep hitting the refresh button in a browser, the browser
>occassionally returns TWO numbers, and sometimes reports an error in
>retrieving the data. Note that I have tested my driver program retrieving a
>simple text file, and everything works as expected, so it does not appear
>to be a problem with Apache. (The problem also goes away if I set
>ThreadPerChild to 1 in the Apache configuration.)
>
>I have also found that, if I comment out the req.write() statement in the
>handler, then there are no problems. From my examination of the
>implementation of the request object, I see that req_write() contains calls
>to Py_BEGIN_ALLOW_THREADS / Py_END_ALLOW_THREADS, whereas
>req_send_http_header() contains no such calls. This suggests to me that
>some thread switching is occurring inside req_write() which is messing with
>the state of the interpreter.
>
>I would be most grateful if anyone has any information to offer on this.
>
>Chris Trengove


--

- Geoff Talvola
   gtalvola@NameConnector.com

From trengove at econdata.com.au  Wed May 30 09:03:40 2001
From: trengove at econdata.com.au (Chris Trengove)
Date: Fri Jan  9 22:02:46 2004
Subject: [mod_python] Re: Win32 threading issue
In-Reply-To: <5.0.2.1.0.20010529134743.02ca2d30@infratest1>
Message-ID: <200105300905630.SM00248@athene>

Geoff,

This problem has now been fixed, and I expect will be part of mod_python
2.7.4 when Grisha decides to release that. In the mean time, if you have a
desperate need to avoid the threading problem, you can access the modified
files in the CVS.

Chris

At 02:04 PM 29/05/2001 -0400, Geoff Talvola wrote:
>I just wanted to confirm that I also get the same behavior on Windows -- if 
>I stress out a simple script like the one below with multiple simultaneous 
>requests, I get sporadic errors, just as Chris Trengove reported.
>
>I'd be happy to help diagnose and fix the problem, but I know next to 
>nothing about Apache and mod_python's internals.  I do have access to VC++ 
>6.0 and I have successfully compiled the mod_python dll (for Python 2.1).
>
>Where should I go from here?
>

>- Geoff Talvola
>   gtalvola@NameConnector.com
> 

From djc at object-craft.com.au  Wed May 30 10:23:48 2001
From: djc at object-craft.com.au (Dave Cole)
Date: Fri Jan  9 22:02:46 2004
Subject: [mod_python] Session data
In-Reply-To: "Gregory's message of "Tue, 29 May 2001 08:35:11 -0400 (EDT)"
References: <Pine.BSF.4.32.0105290826550.99341-100000@localhost>
Message-ID: <m3elt74rcb.fsf@vole.object-craft.com.au>

>>>>> "Gregory" == Gregory (Grisha) Trubetskoy <grisha@modpython.org> writes:

Gregory> This does indeed seem to be a FAQ, but I don't know if there
Gregory> is a straight answer to it.

Gregory> In *my* opinion, trying to maintain state within the server
Gregory> is not scalable and should be avoided. State should be
Gregory> maintained on the client side with cookies and url's.

Your choice of how to retain session state depends entirely on the
type of application you are building.

Gregory> Since Apache 1.3 runs multiple processes, it is impossible to
Gregory> share memory between them and therefore maintain state in the
Gregory> server.

That is not strictly true.  If you wish to retain state at the server,
you have to write some code.  You can either save state in some sort
of database (not necessarily relational) at the server, or you can
build a session server and cache connections to the server in your
mod_python program.

- Dave

-- 
http://www.object-craft.com.au


From gtalvola at nameconnector.com  Tue May 29 20:28:49 2001
From: gtalvola at nameconnector.com (Geoff Talvola)
Date: Fri Jan  9 22:02:46 2004
Subject: [mod_python] Re: Win32 threading issue
In-Reply-To: <200105300905630.SM00248@athene>
References: <5.0.2.1.0.20010529134743.02ca2d30@infratest1>
Message-ID: <5.0.2.1.0.20010529202540.034332c0@infratest1>

Great!  I love it when bugs have already been fixed.

Grisha, are you planning on releasing 2.7.4 any time soon?  If so, I'll 
just wait for it to be released.


At 09:03 AM 5/30/01 +1000, Chris Trengove wrote:
>Geoff,
>
>This problem has now been fixed, and I expect will be part of mod_python
>2.7.4 when Grisha decides to release that. In the mean time, if you have a
>desperate need to avoid the threading problem, you can access the modified
>files in the CVS.
>
>Chris
>
>At 02:04 PM 29/05/2001 -0400, Geoff Talvola wrote:
> >I just wanted to confirm that I also get the same behavior on Windows -- if
> >I stress out a simple script like the one below with multiple simultaneous
> >requests, I get sporadic errors, just as Chris Trengove reported.
> >
> >I'd be happy to help diagnose and fix the problem, but I know next to
> >nothing about Apache and mod_python's internals.  I do have access to VC++
> >6.0 and I have successfully compiled the mod_python dll (for Python 2.1).
> >
> >Where should I go from here?
> >
>
> >- Geoff Talvola
> >   gtalvola@NameConnector.com
> >

--

- Geoff Talvola
   gtalvola@NameConnector.com

From bl at netgroup.dk  Thu May 31 09:07:33 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 22:02:46 2004
Subject: [mod_python] Session data
References: <3B13592F.DB5633BB@netgroup.dk> <Pine.BSF.4.32.0105290826550.99341-100000@localhost> <20010529130349.A17514@fool.com>
Message-ID: <3B15EDB5.7E8D811B@netgroup.dk>

"G . Sumner Hayes" wrote:

> You can use either shared mmap or SysV shared mem (there are
> python modules for both) to share memory.  I wound up writing
> a Python shared dictionary (just pickles objects into the
> filesystem when you set them, and unpickles them when you read
> them) for my shared state, though I don't share user sessions--I
> share things like parsed template files and other cacheable
> server-side objects that require an expensive calculation the
> first time they're read in.

How about performance ? Is'nt it expensive accessing file in a dir. for shared
data, I mean, you have to reload it if its RW data, or is it write ones read
many (it sounds like it) ?

> Same idea would work for user sessions, and since it's in the
> filesystem the kernel will take care of buffering for you and you
> can use tools like "find" and "rm" to prune the cache. :-)

Hmm, If I like to change user session data offen, I quess I would go for the
"shared mem" solution.

> I agree with Grisha that you probably want to keep state on the
> clients if you can, though.

This is not possible, as  the state, in my case, is a lot of database keys, and
other internal information for navigating a database.

/BL


From bl at netgroup.dk  Thu May 31 09:26:49 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 22:02:46 2004
Subject: [mod_python] Session data
References: <Pine.BSF.4.32.0105290826550.99341-100000@localhost> <m3elt74rcb.fsf@vole.object-craft.com.au>
Message-ID: <3B15F239.F158F917@netgroup.dk>

Dave Cole wrote:

> Gregory> Since Apache 1.3 runs multiple processes, it is impossible to
> Gregory> share memory between them and therefore maintain state in the
> Gregory> server.
>
> That is not strictly true.  If you wish to retain state at the server,
> you have to write some code.  You can either save state in some sort
> of database (not necessarily relational) at the server, or you can
> build a session server and cache connections to the server in your
> mod_python program.

Anyway, this would be nice to have in the FAQ.

When I startet to look into mod_python, I did compare with JavaServer, and found
that this "session thing" were missing, and Gregory's comment about scalling
helped me undestand that the JavaServer solution were not always sufficient.

> http://www.object-craft.com.au

Ahh, yet another Rating expert :-)

/BL


From bl at netgroup.dk  Thu May 31 09:40:27 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 22:02:46 2004
Subject: [mod_python] Session data
References: <13CDDE6A53DBD311BC3200508B6F0C4805E47E7D@rover.foolhq.com>
Message-ID: <3B15F56B.67DF1D35@netgroup.dk>

Chris Hagner wrote:

> In my experience, the quickest way to ensure that your web application
> scales poorly is to mis-use server-side user sessions (thereby agreeing with
> Grisha).  Now, that being said, not everyone needs this level of scalability
> AND user sessions are a standard part of almost every-single web application
> platform (ASP, Servlets/JSP, ColdFusion, etc.) commercially available.

This is the danger of the JavaServer/PHP approach, not been aware of this.

> BTW, I've found that most non-Apache-based web developers (of which I used
> to be one :-) are completely ignorant of the realities of running in a
> multi-process server.  They generally take for granted the user sessions
> built into whatever app server they're using and find it mentally
> challenging to truly believe they can live without such functionality.

Again, the tools they are using gives them this impression, or at least support
there view of the world. And then we have the same problem with ex. ASP as we
have with RAD tools --- the level of insight and experience.

> As for multiple-server user sessions, there are some solutions available in
> the non-Python space (most of the ones that I've seen use either a database
> (ugh :-) or a solution along the lines of Java's RMI to keep the session
> pool's in sync.  In either case, it is a non-trivial problem/solution and is
> best avoided (following the KISS principle).

Or even a CORBA version to keep the real-time aspect :-)

> You might want to check out WebWare (webware.sourceforge.net) as an expample
> web framework that has some session support.  I think they pickle objects to
> the file system.  There are some other python-based cgi frameworks that also
> support user sessions, but just be aware of how far such solutions will/will
> not take you.

I would be nervous about the performance and the real-time aspect by using the
file system approach, but thanks for the advise, I will look into it.

/BL


From SumnerH at fool.com  Thu May 31 12:09:37 2001
From: SumnerH at fool.com (G . Sumner Hayes)
Date: Fri Jan  9 22:02:46 2004
Subject: [mod_python] Session data
In-Reply-To: <3B15EDB5.7E8D811B@netgroup.dk>; from bl@netgroup.dk on Thu, May 31, 2001 at 09:07:33AM +0200
References: <3B13592F.DB5633BB@netgroup.dk> <Pine.BSF.4.32.0105290826550.99341-100000@localhost> <20010529130349.A17514@fool.com> <3B15EDB5.7E8D811B@netgroup.dk>
Message-ID: <20010531120937.A24124@fool.com>

Bo Lorentsen <bl@netgroup.dk> wrote:
> > You can use either shared mmap or SysV shared mem (there are
> > python modules for both) to share memory.  I wound up writing
> > a Python shared dictionary (just pickles objects into the
> > filesystem when you set them, and unpickles them when you read
> > them)
> 
> How about performance ? Is'nt it expensive accessing file in a
> dir. for shared data, I mean, you have to reload it if its RW
> data, or is it write ones read many (it sounds like it) ?

I can write about 3000 entries to the dictionary per second.  I
can read about 8000 entries from the dictionary per second.  This
is with SMP-safe locking, but running on a uniprocessor (600 Mhz
PIII).  This is tha naive 30 minute implentation without any C
extensions or anything.

Most of the time is spent pickling, fs access is _really_ fast
on a decent operating system (e.g. Linux, FreeBSD).  If you're
storing really large objects, the pickling may take longer.

If you're storing a lot of items (more than a few thousands) use
the regular db-in-fs options (nested directories with a few 1000
files each or a btree filesystem like ReiserFS).

> > Same idea would work for user sessions, and since it's in the
> > filesystem the kernel will take care of buffering for you and
> > you can use tools like "find" and "rm" to prune the cache.
> > :-)
>
> Hmm, If I like to change user session data offen, I quess I
> would go for the "shared mem" solution.

I tried it when I first implemented the thing , the timing was
similar (within 2-3%).  Which makes sense, because the time to
pickle is dominating anyway.  Bear in mind that the fs cache is
going to keep all your recently accessed files in RAM anyway.

If you do it in the fs, the implementation is much simpler-- you
need to build a balanced tree or hash table in SHM to get good
performance with more than 20-30 items in the database.  And
you're not as portable.  The key for me, though, was that being
able to play with the cache w/ regular user tools and assign
permissions per-item can be extremely useful.

  Sumner

From paullb at bigfoot.com  Thu May 31 21:23:50 2001
From: paullb at bigfoot.com (Brendan Paull)
Date: Fri Jan  9 22:02:46 2004
Subject: [mod_python] Compiling and installing mod_python-2.7.3
Message-ID: <5.0.2.1.2.20010531211720.00a02220@pop.minet.ca>

Hi,
	I am having a little trouble getting my mod_python to work.

This is the error I get:
[root@BCMP mod_python-2.7.3]# httpd
Syntax error on line 208 of /etc/httpd/conf/httpd.conf:
Cannot load /usr/lib/apache/mod_python.so into server: undefined symbol: 
pthread_create
[root@BCMP mod_python-2.7.3]#


These are the lines that I added to /etc/httpd/conf/httpd.conf:
208->  LoadModule python_module      /usr/lib/apache/mod_python.so #first 
one in the list
272->AddModule mod_python.c

333-337->
<Directory /var/www/html/python>
   AddHandler python-program .py
   PythonHandler mptest
   PythonDebug On
</Directory>


I have included a transcipt of everything that happens as I try to install 
at the end of the message, my system is a RedHat 7.0 and I have apache 1.3 
installed and python 2.1 which works from command line.

I would really appreciate any advice or tips at all.


[root@BCMP mod_python-2.7.3]# ./configure
loading cache ./config.cache
checking for gcc... (cached) gcc
checking whether the C compiler (gcc  ) works... yes
checking whether the C compiler (gcc  ) is a cross-compiler... no
checking whether we are using GNU C... (cached) yes
checking whether gcc accepts -g... (cached) yes
checking for ranlib... (cached) ranlib
checking for ar... (cached) ar
checking for a BSD compatible install... (cached) /usr/bin/install -c
checking whether make sets ${MAKE}... (cached) no
checking for main in -lm... (cached) yes
checking for working const... (cached) yes
checking your blood pressure... a bit high, but we can proceed
checking whether apxs is available
checking for --with-apxs... no
checking for apxs in /usr/local/apache/sbin... no
checking for apxs in your PATH... checking for apxs... (cached) /usr/sbin/apxs
found /usr/sbin/apxs, we'll use this. Use --with-apxs to specify another.
checking for Apache libexec directory... /usr/lib/apache
checking for Apache include directory... -I/usr/include/apache
checking for --with-apache... no
configure: warning: **** No apache sources specified, static compilation 
will not be available.
configure: warning: **** You can use --with-apache to specify where your 
Apache sources are.
checking for --with-python... no
checking for python... (cached) /usr/bin/python
checking Python version... 2.1
checking whether Python is compiled with thread support... yes

   ****** WARNING ******
   Python is compiled with thread support. Apache 1.3 does not use threads.
   On some systems this will cause problems during compilation, on others
   it may result in unpredictable behaviour of your Apache server. Yet on
   others it will work just fine. The recommended approach is to compile
   Python without thread support in a separate location and specify it with
   --with-python option to this ./configure script.

checking Python install prefix... /usr
checking what libraries Python was linked with... 
/usr/lib/python2.1/config/libpython2.1.a
checking linker flags used to link Python...
checking where Python include files are... -I/usr/include/python2.1
checking for mkdep... (cached) /usr/X11R6/bin/makedepend
creating ./config.status
creating Makefile
creating src/Makefile
creating src/libpython.module
creating Doc/Makefile
analyzing dependencies
[root@BCMP mod_python-2.7.3]# make
make[1]: Entering directory `/root/mod_python-2.7.3/src'
make[1]: Leaving directory `/root/mod_python-2.7.3/src'
[root@BCMP mod_python-2.7.3]# make install
make[1]: Entering directory `/root/mod_python-2.7.3'
make[2]: Entering directory `/root/mod_python-2.7.3/src'
make[2]: Leaving directory `/root/mod_python-2.7.3/src'

Performing DSO installation.

/usr/bin/install -c src/mod_python.so /usr/lib/apache
make[2]: Entering directory `/root/mod_python-2.7.3'
/usr/bin/install -c -d /usr/lib/python2.1/site-packages/mod_python
python /usr/lib/python2.1/compileall.py 
/usr/lib/python2.1/site-packages/mod_python
Listing /usr/lib/python2.1/site-packages/mod_python ...
Compiling /usr/lib/python2.1/site-packages/mod_python/__init__.py ...
Compiling /usr/lib/python2.1/site-packages/mod_python/apache.py ...
Compiling /usr/lib/python2.1/site-packages/mod_python/cgihandler.py ...
Compiling /usr/lib/python2.1/site-packages/mod_python/httpdapi.py ...
Compiling /usr/lib/python2.1/site-packages/mod_python/publisher.py ...
Compiling /usr/lib/python2.1/site-packages/mod_python/util.py ...
Compiling /usr/lib/python2.1/site-packages/mod_python/zhandler.py ...
make[2]: Leaving directory `/root/mod_python-2.7.3'

Now don't forget to edit your main config and add
     LoadModule python_module /usr/lib/apache/mod_python.so
and if your configuration uses ClearModuleList, then also
     AddModule mod_python.c

make[1]: Leaving directory `/root/mod_python-2.7.3'




