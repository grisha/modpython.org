<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Using shared memory to do global persistence
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Using%20shared%20memory%20to%20do%20global%20persistence&In-Reply-To=20030626183642.GB5652%40lyra.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010203.html">
   <LINK REL="Next"  HREF="010205.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
<table border=0 width="100%"><tr><td valign="top">
   <H1>[mod_python] Using shared memory to do global persistence</H1>
    <B>Jonathan Gardner</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Using%20shared%20memory%20to%20do%20global%20persistence&In-Reply-To=20030626183642.GB5652%40lyra.org"
       TITLE="[mod_python] Using shared memory to do global persistence">jgardner at jonathangardner.net
       </A><BR>
    <I>Thu Jun 26 11:45:57 EST 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="010203.html">[mod_python] Using shared memory to do global persistence
</A></li>
        <LI>Next message: <A HREF="010205.html">[mod_python] Using shared memory to do global persistence
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10204">[ date ]</a>
              <a href="thread.html#10204">[ thread ]</a>
              <a href="subject.html#10204">[ subject ]</a>
              <a href="author.html#10204">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On Thursday 26 June 2003 11:36, Greg Stein wrote:
&gt;<i> APR has facilities to do shared memory in a portable fashion; APR is part
</I>&gt;<i> of Apache 2.0, so there isn't much reason to go grab any other library.
</I>&gt;<i>
</I>&gt;<i> You can also use APRUTIL's apr_rmm.h to manage sub-allocations within the
</I>&gt;<i> shared memory segments. The problem is that a shared memory segment could
</I>&gt;<i> be mapped to different addresses in different processes. Thus, you want to
</I>&gt;<i> hold onto offsets into a shared memory segment. apr_rmm.h helps with
</I>&gt;<i> managing these subblocks and working with offsets rather than direct
</I>&gt;<i> pointers. Note that apr_rmm also handles locking so that you can have
</I>&gt;<i> multiple processes allocating (simultaneously) from a shared mem segment.
</I>&gt;<i>
</I>&gt;<i> You can then layer additional Python facilities on top of this substrate.
</I>&gt;<i>
</I>
The python facility would be something like POSH.

So, based on this new information, the project scope would now become:

1) Expand POSH so that it can use shared objects that were shared by a foreign 
process (provided with some information on which shared memory segment they 
are using)

2) Integrate POSH with mod_python and APR.

The problem I see now: How to communicate between all of the processes that 
there are shared objects available, and detail where those shared objects 
are? I don't think it is possible to create shared objects via mod_python 
before the processes are seperated. Even if it was, is it possible to 
transfer references to those shared objects to each process?

The only solution I see right now is to have some central repository that any 
process can access and declare the existence of shared objects, their 
location, and whatever else is needed. Other processes can read the 
repository and find currently existing shared objects by a unique string.

The exact nature of the repository isn't important. It could be a bit of 
shared memory in a special location, a file, a Berkely DB, or even something 
more exotic. The point is that the processes can declare new shares, or find 
existing shares by a unique identifier.

- -- 
Jonathan Gardner &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">jgardner at jonathangardner.net</A>&gt;
(was <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">jgardn at alumni.washington.edu</A>)
Live Free, Use Linux!
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.1 (GNU/Linux)

iD8DBQE++z9mWgwF3QvpWNwRAmawAKDDzpi9kOyIu88CZaCxVTsCqYQ1uwCgymzr
n6NkA9YggvsuqJcdzmnzpdc=
=rHuV
-----END PGP SIGNATURE-----

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010203.html">[mod_python] Using shared memory to do global persistence
</A></li>
	<LI>Next message: <A HREF="010205.html">[mod_python] Using shared memory to do global persistence
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10204">[ date ]</a>
              <a href="thread.html#10204">[ thread ]</a>
              <a href="subject.html#10204">[ subject ]</a>
              <a href="author.html#10204">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
