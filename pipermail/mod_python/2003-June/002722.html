<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] mod_python weirdness, maybe related to importing?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20mod_python%20weirdness%2C%20maybe%20related%20to%20importing%3F&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002715.html">
   <LINK REL="Next"  HREF="002730.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] mod_python weirdness, maybe related to importing?</H1>
    <B>Mike Looijmans</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20mod_python%20weirdness%2C%20maybe%20related%20to%20importing%3F&In-Reply-To="
       TITLE="[mod_python] mod_python weirdness, maybe related to importing?">mike.looijmans at asml.com
       </A><BR>
    <I>Tue Jun 10 13:23:43 EST 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="002715.html">[mod_python] 
	working fix [FAQ: 'import site' failed; use -v for traceback]
</A></li>
        <LI>Next message: <A HREF="002730.html">[mod_python] templating (was: supporting modular mod_python
	extensions vs.&quot;folding&quot; mod_psp)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2722">[ date ]</a>
              <a href="thread.html#2722">[ thread ]</a>
              <a href="subject.html#2722">[ subject ]</a>
              <a href="author.html#2722">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i>Ugh, yeah, it was happening in the SimpleTAL code where I didn't expect
</I>&gt;<i>it to be.  It'd be nice if in debug mode mod_python would throw an
</I>&gt;<i>exception or something if you tried adding headers after there had been
</I>&gt;<i>a write.
</I>

You could do this at runtime without having to patch the mod_python code, in
the handler just do:

def handler(req):
    req.write = mywrite
    req.header_out = myheaderout(req)

def mywrite(self, data):
    self.write(data)
    self.headers_sent = 1

class myheaderout():
    ... # init stuff
    def __init__(self, req):
        self.req = req
        self.__get__ = req.header_out.__get__
        # etc. etc.
    def __set__(self, key, value):
        if self.req.headers_sent:
            raise EHeadersSent
        req.header_out[key] = value






-- 
The information contained in this communication and any attachments is confidential and may be privileged, and is for the sole use of the intended recipient(s). Any unauthorized review, use, disclosure or distribution is prohibited. If you are not the intended recipient, please notify the sender immediately by replying to this message and destroy all copies of this message and any attachments. ASML is neither liable for the proper and complete transmission of the information contained in this communication, nor for any delay in its receipt.
-- 


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002715.html">[mod_python] 
	working fix [FAQ: 'import site' failed; use -v for traceback]
</A></li>
	<LI>Next message: <A HREF="002730.html">[mod_python] templating (was: supporting modular mod_python
	extensions vs.&quot;folding&quot; mod_psp)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2722">[ date ]</a>
              <a href="thread.html#2722">[ thread ]</a>
              <a href="subject.html#2722">[ subject ]</a>
              <a href="author.html#2722">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
