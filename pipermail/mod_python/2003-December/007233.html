<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Trouble installing mod_python
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Trouble%20installing%20mod_python&In-Reply-To=CD80C6EA-2CDE-11D8-BBFA-000A95A072FC%40sb.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007228.html">
   <LINK REL="Next"  HREF="007222.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Trouble installing mod_python</H1>
    <B>Ron Reisor</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Trouble%20installing%20mod_python&In-Reply-To=CD80C6EA-2CDE-11D8-BBFA-000A95A072FC%40sb.org"
       TITLE="[mod_python] Trouble installing mod_python">ron at UDel.Edu
       </A><BR>
    <I>Mon Dec 15 09:17:27 EST 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="007228.html">[mod_python] Trouble installing mod_python
</A></li>
        <LI>Next message: <A HREF="007222.html">[mod_python] Problem with 'import' statement in 'execfile' script
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7233">[ date ]</a>
              <a href="thread.html#7233">[ thread ]</a>
              <a href="subject.html#7233">[ subject ]</a>
              <a href="author.html#7233">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<table border=0 width="100%"><tr><td>
<!--beginarticle-->
<PRE>Kevin,

   The mod_python.so that is built doesn't depend on other needed shared
libraries.  This seems to be the result of how it is built by apxs.  I'm
not sure of the best way to get this problem resolved, but we have been
able to work around the problems. This is a little messy though:

   Build ssl and apache2.0.48 in /usr/local.  MacOSX 10.3 will use shared
libraries in /usr/local/lib without any changes.  The only thing I think
is special about the apache build is to specify --with-mpm=worker so you
get thread support

   Rebuild Python-2.3. I recommend 2.3.2 which includes some patches that
are important to us, but 2.3 works.  2.3.3c1 seems fine so far.  We
replaced the Apple supplied Python in preference for the latest version.
This replaces files in /Applications/MacPython-2.3 and
/Library/Frameworks/Python.framework and /usr/local/bin.  Build like:

./configure --enable-framework
make
make frameworkinstall

   To build mod_python, get the latest cvs.  It includes patches for
Python-2.3 memory/object allocation that will matter on MacOSX.  Build it
as usual to start:

./configure --with-apxs=/usr/local/bin/apxs
make
su
make install

   But, the apxs will use the gnu libtool and what you end up with is a
mod_python.so that doesn't have the right dependencies.  You can check
this with otool:

[roaming-163-213:~/macpython/httpd-python] ron% otool -L
src/.libs/mod_python.so
src/.libs/mod_python.so:
        /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current
version 71.0.0)
[roaming-163-213:~/macpython/httpd-python] ron%

   Key libraries, like Python, are missing.  So, here's the really messy
part.  Remove the mod_python.so link from src and run this command in the
src directory:

libtool -o mod_python.so -dynamic -flat_namespace -undefined suppress
hlistobject.o hlist.o filterobject.o connobject.o serverobject.o util.o
tableobject.o requestobject.o _apachemodule.o mod_python.o -framework
System -lcc_dynamic -arch_only ppc -framework Python -framework
CoreServices -framework Foundation -lm

   That should be all one shell command line.  One important difference
here is that the libtool you use is the Apple supplied libtool, not the
gnu libtool that apxs would normally use.  Also, there's switches in there
that I don't know how to get apxs to generate. If you check this with
otool you should see:

[roaming-163-213:~/macpython/httpd-python/src] ron% otool -L mod_python.so
mod_python.so:
        mod_python.so (compatibility version 0.0.0, current version 0.0.0)
        /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current
version 71.0.0)
        /Library/Frameworks/Python.framework/Versions/2.3/Python
(compatibility version 2.3.0, current version 2.3.0)

/System/Library/Frameworks/CoreServices.framework/Versions/A/CoreServices
(compatibility version 1.0.0, current version 16.0.0)

/System/Library/Frameworks/Foundation.framework/Versions/C/Foundation
(compatibility version 300.0.0, current version 500.5.0)
[roaming-163-213:~/macpython/httpd-python/src] ron%

   Then, copy the mod_python.so into the /usr/local/modules directory.

cheers,

Ron


On Fri, 12 Dec 2003, Kevin Ballard wrote:

&gt;<i> I'm running Mac OS X 10.3 with Apache 2 installed (via the Complete
</I>&gt;<i> Apache 2 installer package) and I'm trying to install mod_python
</I>&gt;<i> (latest from CVS). I ./configure and make and make install it fine, but
</I>&gt;<i> when I add the LoadModule line to my httpd.conf file and do a Check
</I>&gt;<i> Syntax I get the following error:
</I>&gt;<i>
</I>&gt;<i> Syntax error on line 1099 of /Library/Apache2/conf/httpd.conf:
</I>&gt;<i> Cannot load /Library/Apache2/modules/mod_python.so into server: dyld:
</I>&gt;<i> /Library/Apache2/bin/httpd Undefined symbols:
</I>&gt;<i> _PyExc_AttributeError
</I>&gt;<i> _PyExc_IOError
</I>&gt;<i> _PyExc_IndexError
</I>&gt;<i> _PyExc_KeyError
</I>&gt;<i> _PyExc_RuntimeError
</I>&gt;<i> _PyExc_StopIteration
</I>&gt;<i> _PyExc_TypeError
</I>&gt;<i> _PyExc_ValueError
</I>&gt;<i> _PyInt_Type
</I>&gt;<i> _PyList_Type
</I>&gt;<i> _PyObject_GenericGetAttr
</I>&gt;<i> _PyObject_GenericSetAttr
</I>&gt;<i> _PyString_Type
</I>&gt;<i> _PyType_Type
</I>&gt;<i> _Py_OptimizeFlag
</I>&gt;<i> __Py_NoneStruct
</I>&gt;<i> __Py_NotImplementedStruct
</I>&gt;<i>
</I>&gt;<i> line 1099 is my LoadModule for mod_python. Why am I getting this error
</I>&gt;<i> and how can I fix it?
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Kevin Ballard
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">kevin at sb.org</A>
</I>&gt;<i> <A HREF="http://www.tildesoft.com">http://www.tildesoft.com</A>
</I>&gt;<i> <A HREF="http://kevin.sb.org">http://kevin.sb.org</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i>
</I>
Ron Reisor &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">ron at udel.edu</A>&gt; (RWR3)
University of Delaware Information Technologies/Network and Systems Services
Computing Center/192 South Chapel Street/Newark DE, 19716
pgp finger print: 0D 73 06 6F D3 6A 99 D3  F5 D5 6E FF 3B B9 7C 2C
</PRE>
<!--endarticle-->
</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007228.html">[mod_python] Trouble installing mod_python
</A></li>
	<LI>Next message: <A HREF="007222.html">[mod_python] Problem with 'import' statement in 'execfile' script
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7233">[ date ]</a>
              <a href="thread.html#7233">[ thread ]</a>
              <a href="subject.html#7233">[ subject ]</a>
              <a href="author.html#7233">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
