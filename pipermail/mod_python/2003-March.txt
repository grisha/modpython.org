From mike at mikesclutter.com  Sat Mar  1 11:07:23 2003
From: mike at mikesclutter.com (Michael Owens)
Date: Fri Jan  9 21:47:17 2004
Subject: [mod_python] Problem with C extension type
Message-ID: <200303011107.23400.mike@mikesclutter.com>

This is a rather intricate problem, but I don't know where else to go. I have 
a C extension in which I created a native Python type, call it X, which has 
two methods: A() and B(). Then I create a Python class, derived from X type, 
called Y, which has has two methods C() and D(). Y is defined as follows 
(cmod is my C extension in which X is implemented)

from cmod import X

class Y(X):
  
    def __new__(cls, db):
        return super(Y, cls).__new__(cls)

    def C():
	print "C()"

    def D():
	print "D()"

If I call Y.A() from a normal python script, there is no problem --- it 
resolved to X.A(). But if I do this inside of mod_python, I get an error 
saying that object Y has no such attribute A. I don't understand why 
mod_python would be any different in attribute resolution than Python would 
be since it is using the same Python implementation/library. I am using 
Python 2.2.2 and mod_python 3.0.1 in Apache 2.x.

Any ideas?

Michael Owens.

From jermnsar at hotmail.com  Sat Mar  1 20:04:23 2003
From: jermnsar at hotmail.com (Jeremy Lowery)
Date: Fri Jan  9 21:47:17 2004
Subject: [mod_python] Full Path Info on Request object
Message-ID: <F138mnSA3oZs7pKy2uh0001dc06@hotmail.com>

Hello,

I'm writing my own publisher, and I don't understand why mod_python doesn't 
include the full pathname in the req.filename attribute.

In my .htaccess

SetHandler python-program
# My Custom Publisher in this directory
PythonHandler ServletPublisher
PythonDebug On

I make a request:
http://localhost/~jermnsar/foo/bar/test/hmm?dat=val&val2=dat2

and printing out the variables:

req.uri /~jermnsar/foo/bar/test/hmm
req.filename C:/Documents and Settings/jermnsar/My Documents/My Website/foo


What would be an easy way to resolve to
C:/Documents and Settings/jermnsar/My Documents/My Website/foo/bar/test/hmm

or at least easily extract the /bar/test/hmm

Would be easy to do with some string manip I suppose, but I'm looking for 
faster (i.e. quicker CPU wise) way.

Why does the translation from the web path to the physical path only include 
the first element?

Windows XPsp1/Apache 2.0.44/mod_python 3.0.1

Thanks
Jeremy S Lowery






_________________________________________________________________
MSN 8 helps eliminate e-mail viruses. Get 2 months FREE*.  
http://join.msn.com/?page=features/virus


From mike at mikesclutter.com  Mon Mar  3 17:26:37 2003
From: mike at mikesclutter.com (Michael Owens)
Date: Fri Jan  9 21:47:17 2004
Subject: [mod_python] Problem with C extension type
In-Reply-To: <200303011107.23400.mike@mikesclutter.com>
References: <200303011107.23400.mike@mikesclutter.com>
Message-ID: <200303031726.37382.mike@mikesclutter.com>

As a matter of interest, I found what was wrong (sort of). My C type's (X's) 
tp_getattro implementation was screwy. When I replaced it with 
PyObject_GenericGetAttr, everything worked fine in mod_python. I still don't 
know why the original implementation worked in Python and not in mod_python, 
but I don't care so long as it works now.

On Saturday 01 March 2003 11:07 am, Michael Owens wrote:
> This is a rather intricate problem, but I don't know where else to go. I
> have a C extension in which I created a native Python type, call it X,
> which has two methods: A() and B(). Then I create a Python class, derived
> from X type, called Y, which has has two methods C() and D(). Y is defined
> as follows (cmod is my C extension in which X is implemented)
>
> from cmod import X
>
> class Y(X):
>
>     def __new__(cls, db):
>         return super(Y, cls).__new__(cls)
>
>     def C():
> 	print "C()"
>
>     def D():
> 	print "D()"
>
> If I call Y.A() from a normal python script, there is no problem --- it
> resolved to X.A(). But if I do this inside of mod_python, I get an error
> saying that object Y has no such attribute A. I don't understand why
> mod_python would be any different in attribute resolution than Python would
> be since it is using the same Python implementation/library. I am using
> Python 2.2.2 and mod_python 3.0.1 in Apache 2.x.
>
> Any ideas?
>
> Michael Owens.
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

From mark at camazotz.com  Wed Mar  5 23:19:09 2003
From: mark at camazotz.com (Mark Smith)
Date: Fri Jan  9 21:47:17 2004
Subject: [mod_python] mod_python 3.0, Apache 2.0, OS X 10.2
Message-ID: <C6F0BB52-4F8A-11D7-ABDE-00039364CE50@camazotz.com>

Has anyone succeeded in building mod_python 3 on Apache 2 under OS X?  
Last time it was discussed was November last year:

http://www.modpython.org/pipermail/mod_python/2002-November/002652.html

thanks,
Mark


From grisha at modpython.org  Thu Mar  6 00:35:26 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:47:17 2004
Subject: [mod_python] mod_python 3.0, Apache 2.0, OS X 10.2
In-Reply-To: <C6F0BB52-4F8A-11D7-ABDE-00039364CE50@camazotz.com>
Message-ID: <20030306003346.D12356-100000@eden.ispol.com>

It builds and runs just fine undex OS X, you should have at least mp 3.0.1
and better yet the latest sources from CVS, and make sure to check out the
README, it has some OS X instructions in it.

Grisha

On Wed, 5 Mar 2003, Mark Smith wrote:

> Has anyone succeeded in building mod_python 3 on Apache 2 under OS X?
> Last time it was discussed was November last year:
>
> http://www.modpython.org/pipermail/mod_python/2002-November/002652.html
>
> thanks,
> Mark
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From pascalbarbedor at free.fr  Fri Mar  7 00:19:59 2003
From: pascalbarbedor at free.fr (pascal barbedor)
Date: Fri Jan  9 21:47:17 2004
Subject: [mod_python] req.user stays None in authen
Message-ID: <002101c2e436$e8c50c70$908b933e@allalswqm99ewu>

Hi on win 32 with python 2.2.2, installed last version 3.01, added missing mscvrt70.dll
and everything works great!


I wanted to try out the doc tutorial 
<Directory /mywebdir>
AddHandler python-program .py
PythonHandler myscript
PythonAuthenHandler myscript
PythonDebug On
AuthType Basic
AuthName "Restricted Area"
require valid-user
</Directory>

with script

from mod_python import apache
def authenhandler(req):
user = req.user
pw = req.get_basic_auth_pw()
if user == "spam" and pw == "eggs":
return apache.OK
else:
return apache.HTTP_UNAUTHORIZED

it works but req.user is always None
I printed user, pw to apache log and got None eggs
ie password is well passed, but not user
so the authentication results in neverending pop up login window

I checked from mozilla and opera browser


thanks for any help








-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20030307/9852e6fb/attachment.htm
From pmguerre at ualg.pt  Mon Mar 10 20:30:34 2003
From: pmguerre at ualg.pt (Pedro Guerreiro)
Date: Fri Jan  9 21:47:17 2004
Subject: [mod_python] Installing mod_python 3.0.1 in Windows
Message-ID: <20030310202756.F238C4BE80@smtp.ualg.pt>

Hi.

Why was the instructions on how to install mod_python in windows removed from 
the 3.0 documentation? AFAIK in the previous release there was instructions 
on how to do this...

Also, why isn't _anywhere_ (AFAICT) a reference that you _also_ need the Unix 
source (from mod_python-x.tgz) to install it in Windows? From 
http://httpd.apache.org/modules/python-download.cgi one gets the ideia that 
to install it in Windows only the python2.2.2-apache2.0.43.zip is needed?

And finally, why isn't documented that one need msvcr70.dll (not everyone has 
Microsoft Visual _whatever_ installed) to run mod_python?

To resume, please make some documentation on how to install the new 
mod_python on the windows platform, so that someone does go away because 
he/she cannot put mod_python to work... Or at least put up some link to 
http://www.modpython.org/pipermail/mod_python/2002-December/002714.html, and 
to http://www.modpython.org/live/mod_python-2.7.8/doc-html/app-wininst.html

Thanks, and keep up the good work.

	-pmg

From sury.ondrej at globe.cz  Tue Mar 11 11:32:21 2003
From: sury.ondrej at globe.cz (Ondrej Sury)
Date: Fri Jan  9 21:47:17 2004
Subject: [mod_python] session management in mod_python
Message-ID: <87bs0ib3d6.fsf@globe.cz>

Since I still haven't found what I am looking for ;-) (no, I have found
search page for mailing list archive), I just want to ask if there is some
module which is solving /subj. (something like php has) ie. setting session
cookie, loading session variables etc.

O.

-- 
Ondrej Sury - CIO                   Globe Internet s.r.o. http://globe.cz/
Tel: +420(2)35365000 Fax: +420(2)35365009     Planickova 1, 162 00 Praha 6

From lyager at phunkbros.dk  Tue Mar 11 12:18:05 2003
From: lyager at phunkbros.dk (Jesper L. Nielsen)
Date: Fri Jan  9 21:47:17 2004
Subject: [mod_python] session management in mod_python
In-Reply-To: <87bs0ib3d6.fsf@globe.cz>
References: <87bs0ib3d6.fsf@globe.cz>
Message-ID: <20030311111805.GA2976@home.phunkbros.dk>

* Ondrej Sury (sury.ondrej@globe.cz) [2003-03-11 11:03]:
> Since I still haven't found what I am looking for ;-) (no, I have found
> search page for mailing list archive), I just want to ask if there is some
> module which is solving /subj. (something like php has) ie. setting session
> cookie, loading session variables etc.

Personally I'm pretty happy with PyWebLib
(http://www.stroeder.com/pylib/PyWebLib/), which is very customize-able 
:) .  I'm sure, though, that there are many other possibilities.

--
Jesper L. Nielsen
http://phunkbros.dk

From cjackson at spsu.edu  Tue Mar 11 16:10:03 2003
From: cjackson at spsu.edu (Chris Jackson)
Date: Fri Jan  9 21:47:17 2004
Subject: [mod_python] prototype 3.0.3
Message-ID: <000201c2e812$9572f6b0$5f05010a@moxie>

+1
 
moxie
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20030311/456a779e/attachment.htm
From grisha at modpython.org  Wed Mar 12 10:18:38 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:47:17 2004
Subject: [mod_python] prototype 3.0.3
In-Reply-To: <000201c2e812$9572f6b0$5f05010a@moxie>
Message-ID: <20030312101758.F18937-100000@eden.ispol.com>

Thanks

I've been kinda swamped lately, but I'll try to put it out there today or
tomorrow.

Grisha

On Tue, 11 Mar 2003, Chris Jackson wrote:

> +1
>
> moxie
>


From neel at mediapulse.com  Wed Mar 12 10:57:25 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:47:17 2004
Subject: [mod_python] Fixup hander not always being called
Message-ID: <C0FC22C08B82074A88B50061764157775C0C@johnson.mediapulse.net>

I have some mod perl code I'm trying to move over to modpython.  The
perl code adds a cookie header to all requests using the fixup phase,
and then logs some info in the logging phase.  When I setup python to do
the same, the fixup handler is not always called.  It looks like it is
related to cgi scripts, as when I hit a cgi page in the web browser, my
fixup handler is not called - but it will call the perl version.

My conf has:

    <Location />
        #SetHandler python-program
        PythonLogHandler qlog
        PythonFixupHandler qlog
        PythonDebug On
    </Location>

I've commented out the SetHandler because that would break cgi scripts
(causing the text of the script to be sent to the browser, instead of
executing it).  This is the same with mod_perl, you can't use the
SetHandler.

qlog.py (simplified):

from mod_python import apache

def fixuphandler(req):

    apache.log_error("----------- New Hit -----------")
    apache.log_error("CT: " + str(req.content_type))

def loghandler(req):

    apache.log_error("----------- Log Hit -----------")


Any insights?  I'd like to do the new version of this code in python,
and not perl, but I gotta get this cgi snafu solved.

Thanks,
Mike


From neel at mediapulse.com  Wed Mar 12 13:34:23 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:47:17 2004
Subject: [mod_python] Fixup hander not always being called
Message-ID: <C0FC22C08B82074A88B50061764157772C654C@johnson.mediapulse.net>

Sctratch the below.  It looks like the function apache.log_error()
doesn't always work, so my method of testing the handler was flawed.  I
used Sam Spade to watch headers, and my cookies are being added, even
though the calls to the error_log are not printing.

Also, I left off I'm using 2.7.8 on Apache 1.3.26

Thanks,
Mike

-----Original Message-----
From: Michael C. Neel 
Sent: Wednesday, March 12, 2003 10:57 AM
To: mod_python@modpython.org
Subject: [mod_python] Fixup hander not always being called


I have some mod perl code I'm trying to move over to modpython.  The
perl code adds a cookie header to all requests using the fixup phase,
and then logs some info in the logging phase.  When I setup python to do
the same, the fixup handler is not always called.  It looks like it is
related to cgi scripts, as when I hit a cgi page in the web browser, my
fixup handler is not called - but it will call the perl version.

My conf has:

    <Location />
        #SetHandler python-program
        PythonLogHandler qlog
        PythonFixupHandler qlog
        PythonDebug On
    </Location>

I've commented out the SetHandler because that would break cgi scripts
(causing the text of the script to be sent to the browser, instead of
executing it).  This is the same with mod_perl, you can't use the
SetHandler.

qlog.py (simplified):

from mod_python import apache

def fixuphandler(req):

    apache.log_error("----------- New Hit -----------")
    apache.log_error("CT: " + str(req.content_type))

def loghandler(req):

    apache.log_error("----------- Log Hit -----------")


Any insights?  I'd like to do the new version of this code in python,
and not perl, but I gotta get this cgi snafu solved.

Thanks,
Mike

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python


From grisha at apache.org  Mon Mar 17 10:49:27 2003
From: grisha at apache.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:47:17 2004
Subject: [mod_python] ANNOUNCE: Mod_python 3.0.3
In-Reply-To: <20021127135855.Q36516-100000@eden.ispol.com>
Message-ID: <20030317103105.X92188-100000@eden.ispol.com>

The Apache Software Foundation and The Apache HTTP Server Project are
pleased to announce the release of mod_python 3.0.3.

Mod_python is an Apache HTTP Server module that embeds the Python
interpreter within the server. With mod_python you can write web-based
applications in Python that will run many times faster than traditional
CGI and will have access to advanced features such as ability to retain
database connections between requests, access to httpd internals and
provide content filter as well as connection handlers.

This release fixes numerous bugs identified after last release (3.0.1). It
is highly recommended that you upgrade to version 3.0.3 for improved
stability and performance.

Mod_python is available for download from:

http://httpd.apache.org/modules/python-download.cgi

For more information about mod_python visit:

http://www.modpython.org/

Regards,

Grisha Trubetskoy


From mike.looijmans at asml.com  Tue Mar 18 08:07:14 2003
From: mike.looijmans at asml.com (Mike Looijmans)
Date: Fri Jan  9 21:47:17 2004
Subject: [mod_python] ANNOUNCE: Mod_python 3.0.3
Message-ID: <01c2ed1d$009e3d00$926a1e6e@wsasd464>

Hmm. Had some troubles running this baby after the ./configure - smake - smake
install dance. Turned out to be a file permission problem.
The following occured in the apache error log:

[Tue Mar 18 07:56:33 2003] [notice] Apache/2.0.44 (Unix) mod_python/3.0.3
Python/2.2.2 configured -- resuming normal operations
[Tue Mar 18 07:56:35 2003] [error] make_obcallback: could not import
mod_python.apache.

ImportError: No module named apache
[Tue Mar 18 07:57:01 2003] [error] make_obcallback: could not import
mod_python.apache.


The problem was that in /usr/local/lib/python2.2/site-package/mod_pyton, all
files were root-only (pun intented) after installation (mode 600). Would be
nice if the install script forced to 644 mode instead. The apache server runs
as user "nobody" so didn't get access.

--
Mike Looijmans
ASML: http://www5nl.asml.nl/~mlooijma
Private: http://www.milosoftware.com

-----Original Message-----
From: Gregory (Grisha) Trubetskoy <grisha@apache.org>


>
>The Apache Software Foundation and The Apache HTTP Server Project are
>pleased to announce the release of mod_python 3.0.3.



From graeme_matthew at hotmail.com  Tue Mar 18 23:05:21 2003
From: graeme_matthew at hotmail.com (Graeme Matthew)
Date: Fri Jan  9 21:47:17 2004
Subject: [mod_python] Cant get modPython working
Message-ID: <BAY1-F12ATiyhGvDpED000327a4@hotmail.com>

Hi all, im pulling out my 7pm brown hair that is now almost grey !!!!!

I have followed the instructions to get mod_python working on Win32 (XP)

I have edited my conf file as follows:

LoadModule python_module modules/mod_python.so

#added handler directives in scriptalias
<Directory "C:/Program Files/Apache Group/Apache2/cgi-bin">
    AllowOverride None
    Options None
    Order allow,deny
    Allow from all
    AddHandler python-program .py
    PythonHandler mptest
    PythonDebug On
</Directory>

I have placed mptest.py in my cgi-bin folder it contains the following:


from mod_python import apache

def handler(req):
    req.write("Content-type: text/html\n\nHello World!")
    return apache.OK

I keep on getting a HTTP 500 Internal Server Error and cant understand why 
as the log file does not seem to contain the error.

Any help would be much appreciated

Thanks


Graeme

_________________________________________________________________
MSN Instant Messenger now available on Australian mobile phones. Go to  
http://ninemsn.com.au/mobilecentral/hotmail_messenger.asp


From graeme_matthew at hotmail.com  Wed Mar 19 00:07:44 2003
From: graeme_matthew at hotmail.com (Graeme Matthew)
Date: Fri Jan  9 21:47:17 2004
Subject: [mod_python] ModPython working, but multiple handlers ?
Message-ID: <BAY1-F66Hy3SpwBGpEI00000f34@hotmail.com>

Hi all, finally got it working, so please ignore my previous request ...

my last issue before bead is adding multiple handlers

if I do the following:

PythonHandler mptest
PythonHandler app

then my app also prints out mptest within the webpage

If anyone has experienced this then i would like to hear how you solved it, 
as soon as I take mptest out, the problem is removed

Regards


Graeme




_________________________________________________________________
Hotmail now available on Australian mobile phones. Go to  
http://ninemsn.com.au/mobilecentral/hotmail_mobile.asp


From grisha at modpython.org  Tue Mar 18 11:16:15 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:47:17 2004
Subject: [mod_python] ModPython working, but multiple handlers ?
In-Reply-To: <BAY1-F66Hy3SpwBGpEI00000f34@hotmail.com>
Message-ID: <20030318111340.Q7557-100000@eden.ispol.com>

There can only be one PythonHandler and subsequent directives will
override previous, so the net effect of your config below is
"PythonHandler app".

If I understand what you're trying to do, you should look at the manual
and read about the Publisher handler in the tutorial.

Grisha

On Wed, 19 Mar 2003, Graeme Matthew wrote:

>
> Hi all, finally got it working, so please ignore my previous request ...
>
> my last issue before bead is adding multiple handlers
>
> if I do the following:
>
> PythonHandler mptest
> PythonHandler app
>
> then my app also prints out mptest within the webpage
>
> If anyone has experienced this then i would like to hear how you solved it,
> as soon as I take mptest out, the problem is removed
>
> Regards
>
>
> Graeme
>
>
>
>
> _________________________________________________________________
> Hotmail now available on Australian mobile phones. Go to
> http://ninemsn.com.au/mobilecentral/hotmail_mobile.asp
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From mtaylor at real.com  Thu Mar 20 14:07:42 2003
From: mtaylor at real.com (Mark Taylor)
Date: Fri Jan  9 21:47:17 2004
Subject: [mod_python] has anyone successfully built mod_python3.03 on OpenBSD?
Message-ID: <Pine.LNX.4.21.0303201358360.2164-100000@lothlorien.coreqa.prognet.com>

I've been using OpenBSD3.2, apache2.0.43 and python2.2.1

apxs is not building mod_python.so.  I've found similar plaints in the
threads, but no solutions.

-- 
Mark Taylor

Real Networks
Systems Administrator
Developer Services Group - Technical Operations

http://votetoimpeach.org/


From drh9296 at ritvax.rit.edu  Thu Mar 20 18:29:21 2003
From: drh9296 at ritvax.rit.edu (David Higgs)
Date: Fri Jan  9 21:47:17 2004
Subject: [mod_python] has anyone successfully built mod_python3.03 on
 OpenBSD?
References: 
 <Pine.LNX.4.21.0303201358360.2164-100000@lothlorien.coreqa.prognet.com>
Message-ID: <3E7A4ED1.9000909@rit.edu>

I haven't got around to getting mod_python working on my setup yet, but 
here's a heads-up...

There's a good chance that OpenBSD3.2's apache2 is chrooted to 
/var/www/, just like the default apache1.x.  You'll have to have a 
separate python install within /var/www/ or disable the chroot.

Can you paste the specific problems you're getting?  Maybe someone can 
help you out.

--david

Mark Taylor wrote:
> I've been using OpenBSD3.2, apache2.0.43 and python2.2.1
> 
> apxs is not building mod_python.so.  I've found similar plaints in the
> threads, but no solutions.


From mtaylor at real.com  Thu Mar 20 17:03:56 2003
From: mtaylor at real.com (Mark Taylor)
Date: Fri Jan  9 21:47:17 2004
Subject: [mod_python] has anyone successfully built mod_python3.03 on
 OpenBSD?
In-Reply-To: <3E7A4ED1.9000909@rit.edu>
Message-ID: <Pine.LNX.4.21.0303201653020.2164-100000@lothlorien.coreqa.prognet.com>

./configure --with-apxs=<location of apxs>  goes normally, without error.
running 'make' then goes normally until the end, when we get this output:

*** Warning: inter-library dependencies are not known to be supported.
*** All declared inter-library dependencies are being dropped.

*** Warning: libtool could not satisfy all declared inter-library
*** dependencies of module libmod_python.  Therefore, libtool will create
*** a static module, that should work as long as the dlopening
*** application is linked with the -dlopen flag.

Now su and make install
  (or, if you only want to perform a partial install,
   you can use make install_dso and make install_py_lib)

Source distribution found

...

# make install

Compiling for DSO.

...

Performing DSO installation.

/usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
install: src/mod_python.so: No such file or directory
*** Error code 71

Stop in /tmp/mod_python-3.0.3 (line 94 of Makefile).
*** Error code 1

Stop in /tmp/mod_python-3.0.3 (line 91 of Makefile).


AND, in fact, the link in ./src is broken.  there is no mod_python.so in
./src/.libs/ 

# ls src/.libs
libmod_python.a mod_python.la   mod_python.lai

???

mt

On Thu, 20 Mar 2003, David Higgs wrote:

> I haven't got around to getting mod_python working on my setup yet, but 
> here's a heads-up...
> 
> There's a good chance that OpenBSD3.2's apache2 is chrooted to 
> /var/www/, just like the default apache1.x.  You'll have to have a 
> separate python install within /var/www/ or disable the chroot.
> 
> Can you paste the specific problems you're getting?  Maybe someone can 
> help you out.
> 
> --david
> 
> Mark Taylor wrote:
> > I've been using OpenBSD3.2, apache2.0.43 and python2.2.1
> > 
> > apxs is not building mod_python.so.  I've found similar plaints in the
> > threads, but no solutions.
> 

-- 
Mark Taylor

Real Networks
Systems Administrator
Developer Services Group - Technical Operations

http://votetoimpeach.org/


From grisha at modpython.org  Thu Mar 20 23:46:47 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:47:17 2004
Subject: [mod_python] has anyone successfully built mod_python3.03 on
 OpenBSD?
In-Reply-To: <Pine.LNX.4.21.0303201653020.2164-100000@lothlorien.coreqa.prognet.com>
Message-ID: <20030320233453.O44142-100000@eden.ispol.com>

I am OpenBSD ignorant, but on FreeBSD it builds without a hinch (it also
builds on Darwin which has its own different set of complications).

This message usually means libtool is complaining that it won't build an
.so out of static libraries.

On all other OS's I've seen it this was resolvable by upgrading to latest
libtool where this restriction has been lifted.

Another solution is to build pythonlib as an .so - Python does not
directly support this, but it has been reported to work fine if done
manually with something like (YMMV):

mkdir .extract
cd .extract
ar xv ../libpython2.2.a
cd ..
gcc -shared -o libpython2.2.so.0 .extract/*.o
rm -rf .extract

Grisha

On Thu, 20 Mar 2003, Mark Taylor wrote:

>
> ./configure --with-apxs=<location of apxs>  goes normally, without error.
> running 'make' then goes normally until the end, when we get this output:
>
> *** Warning: inter-library dependencies are not known to be supported.
> *** All declared inter-library dependencies are being dropped.
>
> *** Warning: libtool could not satisfy all declared inter-library
> *** dependencies of module libmod_python.  Therefore, libtool will create
> *** a static module, that should work as long as the dlopening
> *** application is linked with the -dlopen flag.
>
> Now su and make install
>   (or, if you only want to perform a partial install,
>    you can use make install_dso and make install_py_lib)
>
> Source distribution found
>
> ...
>
> # make install
>
> Compiling for DSO.
>
> ...
>
> Performing DSO installation.
>
> /usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
> install: src/mod_python.so: No such file or directory
> *** Error code 71
>
> Stop in /tmp/mod_python-3.0.3 (line 94 of Makefile).
> *** Error code 1
>
> Stop in /tmp/mod_python-3.0.3 (line 91 of Makefile).
>
>
> AND, in fact, the link in ./src is broken.  there is no mod_python.so in
> ./src/.libs/
>
> # ls src/.libs
> libmod_python.a mod_python.la   mod_python.lai
>
> ???
>
> mt
>
> On Thu, 20 Mar 2003, David Higgs wrote:
>
> > I haven't got around to getting mod_python working on my setup yet, but
> > here's a heads-up...
> >
> > There's a good chance that OpenBSD3.2's apache2 is chrooted to
> > /var/www/, just like the default apache1.x.  You'll have to have a
> > separate python install within /var/www/ or disable the chroot.
> >
> > Can you paste the specific problems you're getting?  Maybe someone can
> > help you out.
> >
> > --david
> >
> > Mark Taylor wrote:
> > > I've been using OpenBSD3.2, apache2.0.43 and python2.2.1
> > >
> > > apxs is not building mod_python.so.  I've found similar plaints in the
> > > threads, but no solutions.
> >
>
> --
> Mark Taylor
>
> Real Networks
> Systems Administrator
> Developer Services Group - Technical Operations
>
> http://votetoimpeach.org/
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From mike.looijmans at asml.com  Fri Mar 21 07:35:40 2003
From: mike.looijmans at asml.com (Mike Looijmans)
Date: Fri Jan  9 21:47:17 2004
Subject: [mod_python] Success: PythonCGI (not the other way)
Message-ID: <01c2ef74$16f20600$926a1e6e@wsasd464>

Since not all our servers are Apache 2.0.xx yet, and mod_python isn't
available on those, I wanted to remain compatible with the CGI interface.

But sacrificing performance by using the cgihandler (which made the server
effectively single-threaded because of the stdout sharing) did not seem a good
idea.

Instead, I put it the other way around. The native connection mode is
mod_python, and I let the CGI handler simulate the Request interface. By not
using too big a subset, I managed to quite easily do this. The net effect is
that the mod_python script now run much faster than the cgihandler conversion
I used first, and the CGI still works at roughly the same speed (the impact on
performance by creating the Request object is neglegible. The main part of the
code is below.

Each module has a main() function, that takes some parameters. One can use
"main(req, form)" for example, or "main(req, db, auth, form)". The main must
write to req.write(..) just like a mod_python script would. The script does
not know whether it's run from CGI or mod_python.

Comments are welcome!

##
class Request:
    def __init__(self):
        environ = os.environ
        self.subprocess_env = environ
        self.content_type = "text/plain"
        self.status = 200
        self.args = environ.get('QUERY_STRING', '')
        self.path_info = environ.get('PATH_INFO', '')
        self.method  = environ['REQUEST_METHOD']
        self.unparsed_uri = environ['REQUEST_URI']
        self.uri = environ['SCRIPT_NAME']
        self.content_length = -1
        self._headed = 0
        self.headers_out = self
        self.headers = ""
        self.read = sys.stdin.read
        hin = {}
        v = environ.get('HTTP_REFERER', '')
        hin['Referer'] = v
        hin['referer'] = v
        if environ.has_key('HTTP_COOKIE'):
            v = environ['HTTP_COOKIE']
            hin['Cookie'] = v
            hin['cookie'] = v
        self.headers_in = hin
    def add(self, key, value):
        self.headers += '%s: %s\n' % (key, value)
    def set_content_length(self, len):
        self.content_length = len
    def _writeheaders(self):
        self._headed = 1
        sys.stdout.write('status: %s\n' % self.status)
        sys.stdout.write('Content-Type: %s\n' % self.content_type)
        if self.content_length >= 0:
            sys.stdout.write('Content-Length: %s\n' % self.content_length)
        sys.stdout.write(self.headers)
        sys.stdout.write('\n')
        self.write = sys.stdout.write
    def write(self, s):
        if not self._headed:
            self._writeheaders()
        sys.stdout.write(s)

try:
    req = Request()
    program = req.path_info
    if program[0] == '/':
        program = program[1:]
    if not program:
        raise ERedirect, 'ops_webrellist'
    try:
        module = __import__(program)
        try:
            main = module.main
        except AttributeError:
            raise ENoMain, path
        kwargs = {}
        kwargs['req'] = req
        expected = main.func_code.co_varnames[:main.func_code.co_argcount]
        db = None
        if 'form' in expected:
            import cgi
            form = cgi.FieldStorage()
            kwargs['form'] = form
            req.form = form
# Some more stuff about database connections left out #
        apply(module.main, (), kwargs)

    except ImportError:
        admin = os.environ['SERVER_ADMIN']
        print '''Status: 404 Not Found
Content-Type: text/html


--
Mike Looijmans
ASML: http://www5nl.asml.nl/~mlooijma
Private: http://www.milosoftware.com



From mike.looijmans at asml.com  Fri Mar 21 08:53:29 2003
From: mike.looijmans at asml.com (Mike Looijmans)
Date: Fri Jan  9 21:47:17 2004
Subject: [mod_python] Success: PythonCGI (not the other way)
Message-ID: <01c2ef7e$f5e2e280$926a1e6e@wsasd464>

No, i meant that the sysop hasn't updated the server yet (probably local
politics, no time, blah blah, ...)
Besides, I definitely don't want more than 2 flavours of servers out there.

--
Mike Looijmans

-----Original Message-----


>On Fri, Mar 21, 2003 at 07:35:40AM +0100, Mike Looijmans wrote:
>> Since not all our servers are Apache 2.0.xx yet, and mod_python isn't
>> available on those, I wanted to remain compatible with the CGI interface.
>
>Hmm? Are you saying that mod_python isn't available for apache < 2.0?
>Because it is. mod_python version 2.x is for apache 1.3.x, mod_python
>version 3.x is for apache 2.x (yeah, slightly confusing there).



From mike.looijmans at asml.com  Fri Mar 21 09:05:01 2003
From: mike.looijmans at asml.com (Mike Looijmans)
Date: Fri Jan  9 21:47:17 2004
Subject: [mod_python] MySQL DB connection sharing solution
Message-ID: <01c2ef80$9259b480$926a1e6e@wsasd464>

The trouble with most MySQL connection "sharing" methods is that they use the
same connection for multiple threads. This will not work when using scrolling
cursors, you can have only one of those open per connection. If you allow
users to run arbitrary queries, you don't want them to allocate 100 megabytes
of buffer space on the server when doing a "SELECT * FROM customer, orders"
(forgetting to join them...) so they are a must have.

Solution I came up with is to "give" a Connection object to each thread, and
when done, return it to the pool. If a connection is not in the pool, a new
one is made. With a bit of locking, you can have as many threads as you like,
and they won't interfere. The connections are stored in a dictionary, using
the usr, password, host and database as entry 'hash' (which I made a string
for easy debugging).
The entries are a list, when connecting the first object is taken from the
list, and appended again when the handler is done with it. It checks if the
connection is still valid when returning it (so a handler CAN do a db.close()
to dispose of a connection if that is neccesary).

### Connection sharing code ###

dblist = {}
_lock = threading.Lock()

def connectdb(req):
    environ = req.subprocess_env
    dbentry = '%s:%s@%s/%s' % (environ['DBUSER'],
                               environ['DBPWD'],
                               environ['DBHOST'],
                               environ['DBNAME'])
    req.dbentry = dbentry
    _lock.acquire()
    try:
        list = dblist.get(dbentry, [])
        if len(list):
            result = list[0]
            del list[0]
        else:
            import ops_sql
            dblist[dbentry] = list
            result = ops_sql.db_connect(environ)
    finally:
        _lock.release()
    return result

def donedb(req, db):
    if db and (not db._db.closed):
        _lock.acquire()
        try:
            dblist[req.dbentry].append(db)
        finally:
            _lock.release()

### In the handler(req) routine ###

           db = None
            if 'form' in expected:
                form = util.FieldStorage(req)
                kwargs['form'] = form
                req.form = form
            if 'db' in expected:
                db = connectdb(req)
                kwargs['db'] = db
            try:
                apply(module.main, (), kwargs)
            finally:
                donedb(req, db)



--
Mike Looijmans
ASML: http://www5nl.asml.nl/~mlooijma
Private: http://www.milosoftware.com



From laurie at tratt.net  Fri Mar 21 08:57:44 2003
From: laurie at tratt.net (Laurence Tratt)
Date: Fri Jan  9 21:47:18 2004
Subject: [mod_python] has anyone successfully built mod_python3.03 on OpenBSD?
In-Reply-To: <Pine.LNX.4.21.0303201358360.2164-100000@lothlorien.coreqa.prognet.com>; from mtaylor@real.com on Thu, Mar 20, 2003 at 02:07:42PM -0800
References: <Pine.LNX.4.21.0303201358360.2164-100000@lothlorien.coreqa.prognet.com>
Message-ID: <20030321085744.A32228@purcell.tratt.net>

On Thu, Mar 20, 2003 at 02:07:42PM -0800, Mark Taylor wrote:

> I've been using OpenBSD3.2, apache2.0.43 and python2.2.1
>
> apxs is not building mod_python.so.  I've found similar plaints in the
> threads, but no solutions.

I haven't had a chance to try this on the latest mod_python, but the problem
certainly used to be that Apache (2.0.33/2.0.44) ships with a version of
libtool which could charitably be described as brain dead. Install libtool
from ports, then overwrite Apache's version of libtool "cp
/usr/local/bin/libtool /usr/local/apache2/build" [or wherever your Apache 2
is].

I've been doing a fairly substantial amount of mod_python work under OpenBSD
and, once installed, it's as stable as a rock.

Best wishes,


Laurie

From jc at cowgar.com  Fri Mar 21 08:37:04 2003
From: jc at cowgar.com (Jeremy Cowgar)
Date: Fri Jan  9 21:47:18 2004
Subject: [mod_python] PythonImport - an example?
In-Reply-To: <01c2ef7e$f5e2e280$926a1e6e@wsasd464>
References: <01c2ef7e$f5e2e280$926a1e6e@wsasd464>
Message-ID: <200303210837.04952.jc@cowgar.com>

Can anyone give me an example of how the PythonImport directive/code works?

I may be mistaken, but what I want to use it for is to establish my initial db 
connections, load some classes, do some configuration, etc... Then in all my 
hander's, I should have access to that information, correct?

Thanks,

Jeremy

From grisha at modpython.org  Fri Mar 21 10:01:44 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:47:18 2004
Subject: [mod_python] has anyone successfully built mod_python3.03 on
 OpenBSD?
In-Reply-To: <20030321085744.A32228@purcell.tratt.net>
Message-ID: <20030321095949.I50466-100000@eden.ispol.com>


On Fri, 21 Mar 2003, Laurence Tratt wrote:

> certainly used to be that Apache (2.0.33/2.0.44) ships with a version of
> libtool which could charitably be described as brain dead. Install libtool
> from ports, then overwrite Apache's version of libtool "cp
> /usr/local/bin/libtool /usr/local/apache2/build" [or wherever your Apache 2
> is].

A better way is to run ./buildconf - this will copy the libtool from your
system into the Apache source tree and do some other important suff (like
rebuild the ./configure script).


Grisha


From laurie at tratt.net  Fri Mar 21 15:05:55 2003
From: laurie at tratt.net (Laurence Tratt)
Date: Fri Jan  9 21:47:18 2004
Subject: [mod_python] has anyone successfully built mod_python3.03 on OpenBSD?
In-Reply-To: <20030321095949.I50466-100000@eden.ispol.com>; from grisha@modpython.org on Fri, Mar 21, 2003 at 10:01:44AM -0500
References: <20030321085744.A32228@purcell.tratt.net> <20030321095949.I50466-100000@eden.ispol.com>
Message-ID: <20030321150555.H32228@purcell.tratt.net>

On Fri, Mar 21, 2003 at 10:01:44AM -0500, Gregory (Grisha) Trubetskoy wrote:

[Laurie]
>> certainly used to be that Apache (2.0.33/2.0.44) ships with a version of
>> libtool which could charitably be described as brain dead. Install
>> libtool from ports, then overwrite Apache's version of libtool "cp
>> /usr/local/bin/libtool /usr/local/apache2/build" [or wherever your Apache
>> 2 is].
> A better way is to run ./buildconf - this will copy the libtool from your
> system into the Apache source tree and do some other important suff (like
> rebuild the ./configure script).

ISTR that ./buildconf still picks up the Apache libtool (or, at least, it
does under OpenBSD), but would be happy to be corrected.

Best wishes,


Laurie

From grisha at modpython.org  Fri Mar 21 10:36:36 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:47:18 2004
Subject: [mod_python] PythonImport - an example?
In-Reply-To: <200303210837.04952.jc@cowgar.com>
Message-ID: <20030321100228.P50466-100000@eden.ispol.com>

Yes, but I would stay away from PythonImport unless you have no choice.

There's been some debate about this on the list before and it manly arises
from a misunderstanding of how things work. At first glance it seems like
a simple and obvious thing - initiate my db connections and load big data
dictionaries at server startup so that when those requests come in we're
ready to go.

But the problem is that Apache doesn't work this way. The context within
which a request runs comes into existence only after a request begins and
is a result of applying known server configuration directives (from config
and .htaccess files) to dynamic request parameters (e.g. host:  header
which dictates the virtual server to be used, and also the name of the
subinterpreter mod_python will use).

Consider also that there is no way to reliably predict ahead of time what
this request environment may look like since it is put together gradually
by handlers, which might be provided by any number of apache modules which
may choose to drastically change the request environment (e.g. rewrite a
bunch of headers). For example the virtual server and document root
information may not even be specified in the config file but is created
dynamically per-request if you're using something like mod_vhost.

But the server config file discussion during PythonImport is moot,
because, in fact, at the time when PythonImport executes (Apache child
initialization phase), Apache hasn't yet read the config file fully.

So you have to realize that PythonImport runs in this minimalistic bare
environment and needs a hint in the form of the subinterpreter name to be
useful, and sometimes getting it to work correctly can be a challenge, and
also keep in mind that using this directive isn't very portable because it
requires the interpreter name.

I personally favor not bothering with pre-initialization at all. The
downside is that the first hit to your side may take a little longer.
Another option that I've used quite successfully is to add a request to
some initialization url (using lynx or wget or whatever) into the server
start up script.

Grisha

On Fri, 21 Mar 2003, Jeremy Cowgar wrote:

> Can anyone give me an example of how the PythonImport directive/code works?
>
> I may be mistaken, but what I want to use it for is to establish my initial db
> connections, load some classes, do some configuration, etc... Then in all my
> hander's, I should have access to that information, correct?
>
> Thanks,
>
> Jeremy
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From vlindberg at verio.net  Fri Mar 21 18:01:10 2003
From: vlindberg at verio.net (VanL)
Date: Fri Jan  9 21:47:18 2004
Subject: [mod_python] Dynamic virtualhost configuration
Message-ID: <3E7BB5D6.5020706@verio.net>

Hello,

In a book about apache, I came across the following bit of code for 
mod_perl:

[embedded in httpd.conf]
# generate virtual hosts on the fly with Perl
<Perl>
#!/usr/bin perl -w

[snip some stuff]

# Open the virtual hosts file
open (FILE, "/usr/local/apache/conf/vhosts.conf");

while(<FILE>)
     # Create a virtual host based on this line
     ($ip,$host,$admin,$vroot,$aliases) = split /\s*,\s*, $_;
     $VirtualHost {$ip} = {

         [Create virtual host from variables]

[snip other stuff]

</Perl>
[continue httpd.conf]

Is it possible to do the same with mod_python?  I am in a situation 
where I have many subhosts, substantially similar.  Being able to define 
a shorthand for virtual hosts would be a big plus.

In a similar vein, the documentation talks about dynamically associating 
different handlers with a request.  Are these python handlers only, or 
could mod_python do a runtime check that associates mod_php with .php 
files in a specific virtualhost?

Thanks,

VanL


From vlindberg at verio.net  Fri Mar 21 18:18:06 2003
From: vlindberg at verio.net (VanL)
Date: Fri Jan  9 21:47:18 2004
Subject: [mod_python] Dynamic virtualhost configuration
In-Reply-To: <20030322010644.GO13870@netvista.mikebell.org>
References: <3E7BB5D6.5020706@verio.net> <20030322010644.GO13870@netvista.mikebell.org>
Message-ID: <3E7BB9CE.40204@verio.net>

Hello,

mod_vhost_alias would work for some of the accounts, but not others.
The essential problem is that certain services (like php execution, or 
ssi execution) are defined on a per-vhost basis.  From reading the 
documentation and a little experimentation, I'm not sure how to enable 
these services in some contexts, and not in others.  Note that I'm 
mostly talking about module-based services, not simple cgi executiona 
ability.  Thus VirtualScriptAlias wouldn't cut it, to my knowledge.

VanL

mike@mikebell.org wrote:

>On Fri, Mar 21, 2003 at 06:01:10PM -0700, VanL wrote:
>  
>
>>Is it possible to do the same with mod_python?  I am in a situation 
>>where I have many subhosts, substantially similar.  Being able to define 
>>a shorthand for virtual hosts would be a big plus.
>>    
>>
>
>What about mod_vhost_alias? That's what I use.
>
>  
>



From vlindberg at verio.net  Fri Mar 21 18:26:35 2003
From: vlindberg at verio.net (VanL)
Date: Fri Jan  9 21:47:18 2004
Subject: [mod_python] Dynamic virtualhost configuration
In-Reply-To: <20030322012527.GP13870@netvista.mikebell.org>
References: <3E7BB5D6.5020706@verio.net> <20030322010644.GO13870@netvista.mikebell.org> <3E7BB9CE.40204@verio.net> <20030322012527.GP13870@netvista.mikebell.org>
Message-ID: <3E7BBBCB.3090508@verio.net>

mike@mikebell.org wrote:

>Well, if you've got (say) three different setups, three IPs will do the
>job very nicely... If you don't have three IPs it's not so easy, but...
>

Thats right.  And if you only have one IP, then you start looking at a 
way to do it dynamically, so you don't tear your hair out. Hence my 
request...

VanL



From lientz at harvestsolutions.com  Fri Mar 21 18:06:26 2003
From: lientz at harvestsolutions.com (Andrew Lientz)
Date: Fri Jan  9 21:47:18 2004
Subject: [mod_python] cgihandler and redirects
Message-ID: <1048298792.9281.20.camel@hercules.harvestsolutions.com>

Hi,

We are going to slowly convert to mod_python for our application.  In
order to start the transitions I had to correct three things to allow
the cgihandler.py to make our application work properly.  

I edited apache.py to look for the Location header.  When it finds it it
sets the status. I had a problem with the status raised in cgihandler.py
being overridden.  I ended up getting the nicely formated OK pages out
of the web server.  I added the code below to the write function in the
CGIStdout class.

Here's the diff output of my changes:
714,715d713
<                     if h.lower() == "location":
<                         self.req.status = HTTP_MOVED_TEMPORARILY

This allows the code below to be read and redirected without the OK
page.

print "Location: http://blah\n"

and not need any special changes.


In cgihandler.py, I had to append the the current directory to
sys.path.  If it's a subdirectory of the main directory, the
subdirectory doesn't get passed.  This messes with import commands
within a script.  

Also, sys.exit(0) is an easy way to end a script.  It should be graceful
but it raises a SystemExit error.  I modified the code to deal with
this.

Here's the diff output of what I changed in cgihandler.py.

127d126
<             sys.path.append (dir)
134,141d132
<             # this executes the module
<             try:
<                 imp.load_module(module_name, fd, path, desc)
<             except SystemExit, e:
<                 if e == 0:
<                     pass
<                 else:
<                     raise SystemExit, e

I am posting this as an FYI and to see if there was something better I
could have done.  I couldn't find any references in the list archives,
so I hope this helps.

Regards,

Andy
-- 
Andrew Lientz
Harvest Solutions, Inc.
310-398-4761


From mateusz at ant.gliwice.pl  Mon Mar 24 13:23:34 2003
From: mateusz at ant.gliwice.pl (Mateusz Korniak)
Date: Fri Jan  9 21:47:18 2004
Subject: [mod_python] Using publisher handler to generate directory index - how to do it in right and easy way ?
Message-ID: <200303241323.34434.mateusz@ant.gliwice.pl>

Assume I have:
Defined for virtual host www.host.com  root direcotory <html_dir>/host/
I have <html_dir>/host/handler.py defined as Publisher Handler.

When user requestes 'www.host.com/handler/foo' it works well.

How to make handler.index(req) be handler of user requestes 'www.host.com' ?

TIA
-- 
Mateusz Korniak
easy.com  easy.go


From grisha at modpython.org  Mon Mar 24 10:51:22 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:47:18 2004
Subject: [mod_python] Using publisher handler to generate directory index
 - how to do it in right and easy way ?
In-Reply-To: <200303241323.34434.mateusz@ant.gliwice.pl>
Message-ID: <20030324105047.T95235-100000@eden.ispol.com>


On Mon, 24 Mar 2003, Mateusz Korniak wrote:

> When user requestes 'www.host.com/handler/foo' it works well.
>
> How to make handler.index(req) be handler of user requestes 'www.host.com' ?

You can use a DirectoryIndex directive to point to a mod_python script.

Grisha


From dorlov at banta-im.com  Wed Mar 26 11:32:41 2003
From: dorlov at banta-im.com (Dmitry Orlov)
Date: Fri Jan  9 21:47:18 2004
Subject: [mod_python] HTML filtering
Message-ID: <3E81D629.E27E83BE@banta-im.com>

I've started looking into switching some sites that use Python through
cgi to mod_python. The sites work via HTML filtering, sort of like PHP,
with bits of Python stuck inside HTML files. I tried to look for docs
that would show how I could set up such a scheme for mod_python, but
haven't found anything (yet).

Currently, we configure Apache using ScriptAlias and Action directives,
so that any request for a .html file within a certain Location gets
piped through the cgi which runs Python via an HTML filter.

The HTML filter coded in C/flex. It does variable substitution for
things like {$foo}, runs Python snippets between <?python and ?> tags a
la PHP, and a bunch of other nifty things, like form pre-population.

This scheme works quite well, and is fast if one uses fastcgi, but is a
bit complicated. I am hoping to simplify it using mod_python while
retaining the excellent performance.

I am thinking that the ideal drop-in replacement scheme would be to make
our HTML filter into a Python module, and call it via an output filter.
But how do I set it up so that mod_python runs for .html files instead
of .py files?

-Dmitry

From geertj at boskant.nl  Wed Mar 26 18:00:39 2003
From: geertj at boskant.nl (Geert Jansen)
Date: Fri Jan  9 21:47:18 2004
Subject: [mod_python] HTML filtering
In-Reply-To: <3E81D629.E27E83BE@banta-im.com>
References: <3E81D629.E27E83BE@banta-im.com>
Message-ID: <20030326170039.GA7644@vader.boskant.nl>

On Wed, Mar 26, 2003 at 11:32:41AM -0500, Dmitry Orlov wrote:
 
> I am thinking that the ideal drop-in replacement scheme would be to make
> our HTML filter into a Python module, and call it via an output filter.
> But how do I set it up so that mod_python runs for .html files instead
> of .py files?

(Set,Add)Handler python-program .html

Greetings,
Geert Jansen

From neel at mediapulse.com  Wed Mar 26 12:08:01 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:47:18 2004
Subject: [mod_python] HTML filtering
Message-ID: <C0FC22C08B82074A88B50061764157772C656A@johnson.mediapulse.net>

In httpd.conf, for the server add:

    <Files ~ "\.html$">
        SetHandler python-program
        PythonPath "sys.path+['/home/sites/mysite.com/modules']"
        PythonHandler www
        #PythonDebug On
    </Files>

With a www.py in the /home/sites/mysite.com/modules directory.  In
www.py you can put your request handler.

You might want to take a look at Albatross, it sounds very close to what
you are doing, http://www.object-craft.com.au/projects/albatross/

Mike

-----Original Message-----
From: Dmitry Orlov [mailto:dorlov@banta-im.com] 
Sent: Wednesday, March 26, 2003 11:33 AM
To: mod_python@modpython.org
Subject: [mod_python] HTML filtering


I've started looking into switching some sites that use Python through
cgi to mod_python. The sites work via HTML filtering, sort of like PHP,
with bits of Python stuck inside HTML files. I tried to look for docs
that would show how I could set up such a scheme for mod_python, but
haven't found anything (yet).

Currently, we configure Apache using ScriptAlias and Action directives,
so that any request for a .html file within a certain Location gets
piped through the cgi which runs Python via an HTML filter.

The HTML filter coded in C/flex. It does variable substitution for
things like {$foo}, runs Python snippets between <?python and ?> tags a
la PHP, and a bunch of other nifty things, like form pre-population.

This scheme works quite well, and is fast if one uses fastcgi, but is a
bit complicated. I am hoping to simplify it using mod_python while
retaining the excellent performance.

I am thinking that the ideal drop-in replacement scheme would be to make
our HTML filter into a Python module, and call it via an output filter.
But how do I set it up so that mod_python runs for .html files instead
of .py files?

-Dmitry
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python


From peter.bittner at gmx.net  Thu Mar 27 02:17:57 2003
From: peter.bittner at gmx.net (Peter Bittner)
Date: Fri Jan  9 21:47:18 2004
Subject: [mod_python] Using publisher handler to generate directory index - how to do it in right and easy way ?
References: <20030324105047.T95235-100000@eden.ispol.com>
Message-ID: <30920.1048727877@www56.gmx.net>

Hi there!

> On Mon, 24 Mar 2003, Mateusz Korniak wrote:
> 
> > When user requestes 'www.host.com/handler/foo' it works well.
> >
> > How to make handler.index(req) be handler of user requestes
> > 'www.host.com' ?

I have already tried to talk about this topic a while ago (maybe half a year
ago it was).

What I had proposed then, was to make the PublisherHandler handle a
'default' method, say func default(), which should be called automatically when a
request without a function name comes. In your examples this would be
'www.host.com/handler/' -- this would be handled like todays
'www.host.com/handler/default'.

This way one could make the web server handle, say, all 'index.py' files
like the defaults of a directory. (Comparable to the 'index.html' or whatever
someone sets to be called when no document is specified on access to HTML-files
on a web server.)

Having a PublisherHandler with a default function would then make it easy --
(look at the subject of Mateusz' message!) -- to create web projects in the
same simple manner as if there were only HTML-files:

 - An HTTP request to www.host.com would go to, say, www.host.com/index.py
(physically) and logically to www.host.com/index/default, respectively.
 - An HTTP request to www.host.com/mydir/ would in the same manner go to
www.host.com/mydir/index.py (physically) and logically to
www.host.com/mydir/index/default, respectively.

I think mod_python would only benefit from such a change to the
PublisherHandler's code. This would make mod_python (and thus Python itself) more
attractive to web designers and web programmers.

"Grisha" wrote:
> You can use a DirectoryIndex directive to point to a mod_python script.

Well, from my point of view this is only a workaround.
A general solution, however, might give Python the chance to become as
popular as PHP for web programming - after some time of course, not over night!

Please guys, note that this might be a change request that a lot of people
are waiting for, I think especially a lot of newbies to mod_python - newbies
that know other languages like PHP and (CGI-) Python beside others.

Peter

-- 
"Free software is like free speech, not free beer" (Richard Stallman)

+++ GMX - Mail, Messaging & more  http://www.gmx.net +++
Bitte l?cheln! Fotogalerie online mit GMX ohne eigene Homepage!


From dustin at ywlcs.org  Wed Mar 26 21:19:44 2003
From: dustin at ywlcs.org (Dustin Mitchell)
Date: Fri Jan  9 21:47:18 2004
Subject: [mod_python] Using publisher handler to generate directory index - how to do it in right and easy way ?
In-Reply-To: <30920.1048727877@www56.gmx.net>
References: <20030324105047.T95235-100000@eden.ispol.com> <30920.1048727877@www56.gmx.net>
Message-ID: <20030327031944.GP10000@eleanor.internal.ywlcs.org>

I agree this wouuld be a handy feature.  If it's likely to cause problems
(with backward compatibility, perhaps), then it could be selected with a
configuration directive (PythonOption PublisherDefault [off|<name>]), or even
exist as a separate publisher.

I'm sure we're all missing some good reason this is a bad idea.

Otherwise, I'd be willing to create a patch.

Dustin

-- 

  Dustin Mitchell
  dustin@ywlcs.org/djmitche@alumni.uchicago.edu
  http://people.cs.uchicago.edu/~dustin/

From grisha at modpython.org  Wed Mar 26 23:10:02 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:47:18 2004
Subject: [mod_python] Using publisher handler to generate directory index
 - how to do it in right and easy way ?
In-Reply-To: <20030327031944.GP10000@eleanor.internal.ywlcs.org>
Message-ID: <20030326230705.G36549-100000@eden.ispol.com>

Unless I'm missing something, the publisher already has a default
function, only it's "index" not "default":

http://www.modpython.org/live/current/doc-html/hand-pub-alg-trav.html

Grisha

On Wed, 26 Mar 2003, Dustin Mitchell wrote:

> I agree this wouuld be a handy feature.  If it's likely to cause problems
> (with backward compatibility, perhaps), then it could be selected with a
> configuration directive (PythonOption PublisherDefault [off|<name>]), or even
> exist as a separate publisher.
>
> I'm sure we're all missing some good reason this is a bad idea.
>
> Otherwise, I'd be willing to create a patch.
>
> Dustin
>
> --
>
>   Dustin Mitchell
>   dustin@ywlcs.org/djmitche@alumni.uchicago.edu
>   http://people.cs.uchicago.edu/~dustin/
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From stevena at neosynapse.net  Wed Mar 26 23:47:02 2003
From: stevena at neosynapse.net (Steven D. Arnold)
Date: Fri Jan  9 21:47:18 2004
Subject: [mod_python] environment variables not visible?
Message-ID: <BAA7EC76.1FC82%stevena@neosynapse.net>

Hello,

I am attempting to use mod_python 2.7.8 with spyce 1.3.6.  In my project, I
use a database module that connects with a Sybase database.  The module
expects certain environment variables to be set, which I set directly using
os.environ.  Nevertheless, the module doesn't seem to see the environment
variables; the errors are exactly as if the environment variables are not
present.

When I execute the same code from the python interpreter, it works fine.
Likewise when I run the pages from CGI rather than mod_python.  Thus, it
seems as if this may be a mod_python issue.  Any idea what may be going on?

Thanks,
steve
-- 



From grisha at modpython.org  Thu Mar 27 08:04:31 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:47:18 2004
Subject: [mod_python] environment variables not visible?
In-Reply-To: <BAA7EC76.1FC82%stevena@neosynapse.net>
Message-ID: <20030327080031.S42239-100000@eden.ispol.com>

I am guessing you are using the cgihandler. You can't see environment
variables from within the cgihandler-executed CGI scripts, it's mentioned
here:

http://www.modpython.org/live/current/doc-html/hand-cgi.html

Your options are to switch to using the publisher handler or write your
own handler.

Also, I may be wrong, but I think information that is gathered by the
sybase client from the environment can be passed to it by other means.

Grisha

On Wed, 26 Mar 2003, Steven D. Arnold wrote:

> Hello,
>
> I am attempting to use mod_python 2.7.8 with spyce 1.3.6.  In my project, I
> use a database module that connects with a Sybase database.  The module
> expects certain environment variables to be set, which I set directly using
> os.environ.  Nevertheless, the module doesn't seem to see the environment
> variables; the errors are exactly as if the environment variables are not
> present.
>
> When I execute the same code from the python interpreter, it works fine.
> Likewise when I run the pages from CGI rather than mod_python.  Thus, it
> seems as if this may be a mod_python issue.  Any idea what may be going on?
>
> Thanks,
> steve
> --
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From vlindberg at verio.net  Thu Mar 27 08:34:08 2003
From: vlindberg at verio.net (VanL)
Date: Fri Jan  9 21:47:18 2004
Subject: [mod_python] Using the socket module
Message-ID: <3E8319F0.2010306@verio.net>

Hello,

I am trying to connect to a Pyro Server from an app running within
mod_python, but it dies anytime it tries to initialize the socket
library.  Is this a known issue?   Are there any fixes or workarounds?

Thanks

VanL



From geertj at boskant.nl  Thu Mar 27 16:54:43 2003
From: geertj at boskant.nl (Geert Jansen)
Date: Fri Jan  9 21:47:18 2004
Subject: [mod_python] Python codecs bug
Message-ID: <20030327155443.GA23429@vader.boskant.nl>

Hi,

recently, a bug in the Python codecs subsystem has been discovered that
can affect mod_python programs. I have a confirmed report that this bug fixes
the vague "Cannot unmarshal code object in restricted execution mode" error
that was discussed on this list:

  http://mail.python.org/pipermail/python-list/2002-June/109233.html

The bug is described in detail here:

  http://sourceforge.net/tracker/index.php?func=detail&aid=663074&group_id=5470&atid=105470

The Python 2.3 CVS has been fixed. A backport of this fix to Python 2.2.2 is
available from my website at:

  http://draco.boskant.nl/requirements.dsp

the patch has been submitted to the Python crew.

I thought you'd might be interested...

Greetings,
Geert Jansen

From grisha at modpython.org  Thu Mar 27 11:01:27 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:47:18 2004
Subject: [mod_python] Using the socket module
In-Reply-To: <3E8319F0.2010306@verio.net>
Message-ID: <20030327105923.D44232-100000@eden.ispol.com>

It would help if you provided some specifics:

1. Code
2. Any error output (from apache error_log)
3. Versions of Python, mod_python, apache and your OS

Grisha

On Thu, 27 Mar 2003, VanL wrote:

> Hello,
>
> I am trying to connect to a Pyro Server from an app running within
> mod_python, but it dies anytime it tries to initialize the socket
> library.  Is this a known issue?   Are there any fixes or workarounds?
>
> Thanks
>
> VanL
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From stevena at neosynapse.net  Thu Mar 27 11:26:34 2003
From: stevena at neosynapse.net (Steven D. Arnold)
Date: Fri Jan  9 21:47:18 2004
Subject: [mod_python] environment variables not visible?
In-Reply-To: <20030327080031.S42239-100000@eden.ispol.com>
Message-ID: <BAA8906A.1FDDE%stevena@neosynapse.net>

On 3/27/03 8:04 AM, "Gregory (Grisha) Trubetskoy" <grisha@modpython.org>
wrote:

> I am guessing you are using the cgihandler. You can't see environment
> variables from within the cgihandler-executed CGI scripts, it's mentioned
> here:
> 
> http://www.modpython.org/live/current/doc-html/hand-cgi.html

I saw this post, but it doesn't seem I am using that.  Here's the section of
the config:

#AddHandler spyce-cgi-handler spy
#Action spyce-cgi-handler "/spyce-cgi/run_spyceCGI.py"
#ScriptAlias /spyce-cgi/ "/usr/share/spyce/cgi/"
<IfModule mod_python.c>
  AddHandler python-program .spy
  PythonHandler run_spyceModpy::spyceMain
  PythonPath 
"sys.path+[r'/usr/share/spyce/cgi','/server/unr/spyce_modules']"
  PythonOption SPYCE_CONFIG "/usr/share/spyce/spyce.conf"
  # !!! Do NOT turn on. !!!
  PythonOptimize Off
  SetEnv SYBASE /server/sybase/ASE_12501_2
  SetEnv LD_LIBRARY_PATH
/server/sybase/ASE_12501_2/OCS-12_5/lib:/usr/local/lib
  SetEnv SYBASE_OCS /server/sybase/ASE_12501_2/OCS-12_5
  SetEnv SYBASE_ASE /server/sybase/ASE_12501_2/ASE-12_5
</IfModule>
## Following Directives commented out for Mod_python testing
## 03/25/03
#<Location /spyce-cgi/>
#  <IfModule mod_fastcgi.c>
#    # If mod_fastcgi not installed, we get plain cgi
#    SetHandler fastcgi-script
#  </IfModule>
#</Location>
# If FastCGI is installed, it will be picked up
# automatically. On Linux, you can also omit this section
# and use a dynamic fcgi server instead.
#<IfModule mod_fastcgi.c>
#  FastCgiServer "/usr/share/spyce/cgi/run_spyceCGI.py" -port 7654
-initial-env F
#CGI_PORT=7654
#</IfModule>

Note the SetEnv directives are used in addition to setting the environment
with os.environ, but neither of these approaches work.  I am not familiar
enough with the internals of mod_python, but it seems perhaps
run_spyceModpy::spyceMain is the mon_python handler and perhaps it is
somehow forgetting the environment variables.  Does this seem like a likely
possibility to you?

Thanks,
steve
-- 



From vlindberg at verio.net  Thu Mar 27 11:25:58 2003
From: vlindberg at verio.net (VanL)
Date: Fri Jan  9 21:47:18 2004
Subject: [mod_python] Using the socket module
References: <20030327105923.D44232-100000@eden.ispol.com>
Message-ID: <3E834236.7030104@verio.net>

I'm sorry, I have worked it out.  The bug was not in mod_python -- Pyro 
was importing the Threading module in a couple of places without 
checking to see if the python installation supported multithreading.

Thanks,

VanL

Gregory (Grisha) Trubetskoy wrote:

>It would help if you provided some specifics:
>
>1. Code
>2. Any error output (from apache error_log)
>3. Versions of Python, mod_python, apache and your OS
>
>Grisha
>
>On Thu, 27 Mar 2003, VanL wrote:
>
>  
>
>>Hello,
>>
>>I am trying to connect to a Pyro Server from an app running within
>>mod_python, but it dies anytime it tries to initialize the socket
>>library.  Is this a known issue?   Are there any fixes or workarounds?
>>
>>Thanks
>>
>>VanL
>>
>>
>>_______________________________________________
>>Mod_python mailing list
>>Mod_python@modpython.org
>>http://www.modpython.org/mailman/listinfo/mod_python
>>
>>    
>>
>
>  
>




From jessamyn.smith at pason.com  Thu Mar 27 14:38:16 2003
From: jessamyn.smith at pason.com (Jessamyn Smith)
Date: Fri Jan  9 21:47:18 2004
Subject: [mod_python] Import site failed
Message-ID: <20030327143816.A935@ash.int.ca.pason.com>


We are in the process of upgrading our application to use mod_python.  I
have successfully configured and installed mod_python-2.7.8 on my
system, with Python 2.2.2 and MySQL-python-0.9.2.  However, when the
other developers follow my directions, they get the following error when
trying to run any Python CGI scripts:

'import site' failed; use -v for traceback
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
[Thu Mar 27 14:28:44 2003] [error] [client 127.0.0.1] python_handler:
make_obcallback returned no obCallBack!

Does anyone have any insight as to what could be different?  As far as
we know we are all running the same system (RedHat 7.3).  I am able to
wipe out my entire Python 2.2.2 directory and start the install from
scratch, and get a working version of mod_python, so I suspect the
problem is in the environment.

I tried looking through the archives, but the link for downloading the
entire mbox seems to be broken:
Not Found

The requested URL /pipermail/mod_python.mbox/mod_python.mbox was not
found on this server.

My patience for clicking monthly links to the archives wore out well
before I'd checked them all.

Jessamyn
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 232 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20030327/d532d963/attachment.bin
From scott_list at mischko.com  Thu Mar 27 13:40:24 2003
From: scott_list at mischko.com (Scott Chapman)
Date: Fri Jan  9 21:47:18 2004
Subject: [mod_python] HTML filtering
In-Reply-To: <3E81D629.E27E83BE@banta-im.com>
References: <3E81D629.E27E83BE@banta-im.com>
Message-ID: <200303271340.24840.scott_list@mischko.com>

You might want to look at Spyce (http://spyce.sourceforge.net/) also.  It 
allows you to embed Python in HTML.

Scott


On Wednesday 26 March 2003 8:32 am, Dmitry Orlov wrote:
I've started looking into switching some sites that use Python through
cgi to mod_python. The sites work via HTML filtering, sort of like PHP,
with bits of Python stuck inside HTML files. I tried to look for docs
that would show how I could set up such a scheme for mod_python, but
haven't found anything (yet).

Currently, we configure Apache using ScriptAlias and Action directives,
so that any request for a .html file within a certain Location gets
piped through the cgi which runs Python via an HTML filter.

The HTML filter coded in C/flex. It does variable substitution for
things like {$foo}, runs Python snippets between <?python and ?> tags a
la PHP, and a bunch of other nifty things, like form pre-population.

This scheme works quite well, and is fast if one uses fastcgi, but is a
bit complicated. I am hoping to simplify it using mod_python while
retaining the excellent performance.

I am thinking that the ideal drop-in replacement scheme would be to make
our HTML filter into a Python module, and call it via an output filter.
But how do I set it up so that mod_python runs for .html files instead
of .py files?

-Dmitry
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python



From gnb at itga.com.au  Fri Mar 28 09:05:23 2003
From: gnb at itga.com.au (Gregory Bond)
Date: Fri Jan  9 21:47:18 2004
Subject: [mod_python] Import site failed 
In-Reply-To: Your message of Thu, 27 Mar 2003 14:38:16 -0700.
Message-ID: <200303272205.JAA14087@lightning.itga.com.au>

> [Thu Mar 27 14:28:44 2003] [error] [client 127.0.0.1] python_handler:
> make_obcallback returned no obCallBack!

Check the very first entry in the FAQ:
	http://www.modpython.org/FAQ/faqw.py?req=show&file=faq02.001.htp




From dorlov at banta-im.com  Thu Mar 27 17:25:27 2003
From: dorlov at banta-im.com (Dmitry Orlov)
Date: Fri Jan  9 21:47:18 2004
Subject: [mod_python] HTML filtering
References: <3E81D629.E27E83BE@banta-im.com> <200303271340.24840.scott_list@mischko.com>
Message-ID: <3E837A57.7D90AEB6@banta-im.com>

Hi Scott,

Thanks for the tip, but I've looked at all kinds of templating engines,
and they all pretty much do the same thing, albeit in a wide variety of
ways. The commonalities are:

1. you have to manually put in bits of code to change values of
attributes and query string variables, and

2. designers who use wysiwyg tools like Dreamweaver are at a loss if you
give them a marked-up HTML file to edit.

The idea behind ours is that lots of common-sense stuff just happens
automatically. For example, if there is an <input type="text"
name="foo"> and request.foo happens to be "bar", the engine spits out
<input type="text" name="foo" value="bar"> without being asked. Likewise
with <a href="something.com?foo"> - it gets rewritten to <a
href="something.com?foo=bar"> without the programmer having to do
anything.

We've been using this engine with good results for about 4 years now, on
lots of sites, like http://designjet.hp.com/. It's built into a couple
of our legacy frameworks, but should be relatively easy to reuse;
reasonably recent docs are available at
http://www.integratis.org/dfp.html.

I am leaning in the direction of making it into a GPL'ed Python module
that can be plugged into mod_python as an output filter. But I don't
know how much interest there would be. OSDN/Sourceforge/Freshmeat don't
seem effective as far as gauging interest.

That's why I am sort of spamming this list (just this once, I promise!)
If you think you might be interested in trying it out, or know of anyone
who might be, please let me know. If a bunch of people tell me "Yes,
I'll try it", then that's probably all the push I need to start coding.

-Dmitry

Scott Chapman wrote:
> 
> You might want to look at Spyce (http://spyce.sourceforge.net/) also.  It
> allows you to embed Python in HTML.
> 
> Scott
> 
> On Wednesday 26 March 2003 8:32 am, Dmitry Orlov wrote:
> I've started looking into switching some sites that use Python through
> cgi to mod_python. The sites work via HTML filtering, sort of like PHP,
> with bits of Python stuck inside HTML files. I tried to look for docs
> that would show how I could set up such a scheme for mod_python, but
> haven't found anything (yet).
> 
> Currently, we configure Apache using ScriptAlias and Action directives,
> so that any request for a .html file within a certain Location gets
> piped through the cgi which runs Python via an HTML filter.
> 
> The HTML filter coded in C/flex. It does variable substitution for
> things like {$foo}, runs Python snippets between <?python and ?> tags a
> la PHP, and a bunch of other nifty things, like form pre-population.
> 
> This scheme works quite well, and is fast if one uses fastcgi, but is a
> bit complicated. I am hoping to simplify it using mod_python while
> retaining the excellent performance.
> 
> I am thinking that the ideal drop-in replacement scheme would be to make
> our HTML filter into a Python module, and call it via an output filter.
> But how do I set it up so that mod_python runs for .html files instead
> of .py files?
> 
> -Dmitry
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

From gnb at itga.com.au  Fri Mar 28 10:09:42 2003
From: gnb at itga.com.au (Gregory Bond)
Date: Fri Jan  9 21:47:18 2004
Subject: [mod_python] HTML filtering 
In-Reply-To: Your message of Thu, 27 Mar 2003 17:25:27 -0500.
Message-ID: <200303272309.KAA18383@lightning.itga.com.au>

> The idea behind ours is that lots of common-sense stuff just happens
> automatically. For example, if there is an <input type="text"
> name="foo"> and request.foo happens to be "bar", the engine spits out
> <input type="text" name="foo" value="bar"> without being asked.

Albatross (http://www.object-craft.com.au/projects/albatross/) does this sort 
of thing very well, and supports CGI or mod_python with the same script (with 
a bit of trickery).  But it might be a bit hard to cut over existing products 
to use it.


From grisha at modpython.org  Thu Mar 27 18:14:01 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:47:18 2004
Subject: [mod_python] HTML filtering
In-Reply-To: <3E837A57.7D90AEB6@banta-im.com>
Message-ID: <20030327181158.I50327-100000@eden.ispol.com>


On Thu, 27 Mar 2003, Dmitry Orlov wrote:

> I am leaning in the direction of making it into a GPL'ed Python module
> that can be plugged into mod_python as an output filter.

It's be more in Python spirit if it was a BSD-style license rather than
GPL. :-)

Grisha


From scott_list at mischko.com  Thu Mar 27 15:14:16 2003
From: scott_list at mischko.com (Scott Chapman)
Date: Fri Jan  9 21:47:18 2004
Subject: [mod_python] HTML filtering
In-Reply-To: <3E837A57.7D90AEB6@banta-im.com>
References: <3E81D629.E27E83BE@banta-im.com> <200303271340.24840.scott_list@mischko.com> <3E837A57.7D90AEB6@banta-im.com>
Message-ID: <200303271514.16988.scott_list@mischko.com>

I am VERY interested in this.  If you can make a copy of it available to 
experiment with, I'd appreciate it.

My vote is "Yes" on GPL action here!

Scott

On Thursday 27 March 2003 2:25 pm, Dmitry Orlov wrote:
Hi Scott,

Thanks for the tip, but I've looked at all kinds of templating engines,
and they all pretty much do the same thing, albeit in a wide variety of
ways. The commonalities are:

1. you have to manually put in bits of code to change values of
attributes and query string variables, and

2. designers who use wysiwyg tools like Dreamweaver are at a loss if you
give them a marked-up HTML file to edit.

The idea behind ours is that lots of common-sense stuff just happens
automatically. For example, if there is an <input type="text"
name="foo"> and request.foo happens to be "bar", the engine spits out
<input type="text" name="foo" value="bar"> without being asked. Likewise
with <a href="something.com?foo"> - it gets rewritten to <a
href="something.com?foo=bar"> without the programmer having to do
anything.

We've been using this engine with good results for about 4 years now, on
lots of sites, like http://designjet.hp.com/. It's built into a couple
of our legacy frameworks, but should be relatively easy to reuse;
reasonably recent docs are available at
http://www.integratis.org/dfp.html.

I am leaning in the direction of making it into a GPL'ed Python module
that can be plugged into mod_python as an output filter. But I don't
know how much interest there would be. OSDN/Sourceforge/Freshmeat don't
seem effective as far as gauging interest.

That's why I am sort of spamming this list (just this once, I promise!)
If you think you might be interested in trying it out, or know of anyone
who might be, please let me know. If a bunch of people tell me "Yes,
I'll try it", then that's probably all the push I need to start coding.

-Dmitry

Scott Chapman wrote:
> You might want to look at Spyce (http://spyce.sourceforge.net/) also.  It
> allows you to embed Python in HTML.
>
> Scott
>
> On Wednesday 26 March 2003 8:32 am, Dmitry Orlov wrote:
> I've started looking into switching some sites that use Python through
> cgi to mod_python. The sites work via HTML filtering, sort of like PHP,
> with bits of Python stuck inside HTML files. I tried to look for docs
> that would show how I could set up such a scheme for mod_python, but
> haven't found anything (yet).
>
> Currently, we configure Apache using ScriptAlias and Action directives,
> so that any request for a .html file within a certain Location gets
> piped through the cgi which runs Python via an HTML filter.
>
> The HTML filter coded in C/flex. It does variable substitution for
> things like {$foo}, runs Python snippets between <?python and ?> tags a
> la PHP, and a bunch of other nifty things, like form pre-population.
>
> This scheme works quite well, and is fast if one uses fastcgi, but is a
> bit complicated. I am hoping to simplify it using mod_python while
> retaining the excellent performance.
>
> I am thinking that the ideal drop-in replacement scheme would be to make
> our HTML filter into a Python module, and call it via an output filter.
> But how do I set it up so that mod_python runs for .html files instead
> of .py files?
>
> -Dmitry
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python



From jessamyn.smith at pason.com  Fri Mar 28 07:56:42 2003
From: jessamyn.smith at pason.com (Jessamyn Smith)
Date: Fri Jan  9 21:47:18 2004
Subject: [mod_python] Import site failed
In-Reply-To: <D31B04F24EDE7644BB169BB4F080778A06C2396B@s30342g004005>; from Hans.Yandle@cingular.com on Fri, Mar 28, 2003 at 09:07:37AM -0500
References: <D31B04F24EDE7644BB169BB4F080778A06C2396B@s30342g004005>
Message-ID: <20030328075642.A25172@ash.int.ca.pason.com>


Thank you everyone for your help.  We managed to fix the problem by
adding a symbolic link:
ln -s /path/to/Python-2.2.2 /path/to/PythonHome

And editing the apache startup script (/etc/init.d/httpd), adding:
export PYTHONHOME='/hub/apps/PythonHome/'
in the start() function.

I felt pretty dumb for not checking the webpage for a FAQ.  We were
googling for "import site failed", when apparently we should have been
googling for "obcallback".  I am also still perplexed as to how my
machine is able to find mod_python, when I haven't done either of the
above steps.

Anyway, thanks again!

Jessamyn
-- 
Jessamyn Smith
Systems Analyst, DataHub Team
Ph: (403) 301-3470
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 232 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20030328/5bbc3796/attachment.bin
From grisha at modpython.org  Fri Mar 28 17:38:48 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:47:18 2004
Subject: [mod_python] Why are you using mod_python?
In-Reply-To: <20030328075642.A25172@ash.int.ca.pason.com>
Message-ID: <20030328172826.X67038-100000@eden.ispol.com>

Hello everyone -

As the original author of mod_python I think I'm allowed to jerk people's
chains with this simple question:

Why are you using mod_python?

You can reply on or off list, either is fine. The results, after I get to
mull over them will be published in one way or another.

I've decided to ask the list because I recently realized that I am not
sure I know the answer. Not to say that I don't like mod_python, on the
contrary, I do, but to formulate in words exactly why is rather difficult.
Besides, my opinion is biased anyway :-)

Thanks in advance!

Grisha



From gdamjan at mail.net.mk  Sat Mar 29 03:55:34 2003
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 21:47:19 2004
Subject: [mod_python] environment variables not visible?
In-Reply-To: <BAA8906A.1FDDE%stevena@neosynapse.net>
References: <20030327080031.S42239-100000@eden.ispol.com> <BAA8906A.1FDDE%stevena@neosynapse.net>
Message-ID: <20030329025534.GB2171@legolas.on.net.mk>

>   SetEnv SYBASE /server/sybase/ASE_12501_2
>   SetEnv LD_LIBRARY_PATH
> /server/sybase/ASE_12501_2/OCS-12_5/lib:/usr/local/lib
>   SetEnv SYBASE_OCS /server/sybase/ASE_12501_2/OCS-12_5
>   SetEnv SYBASE_ASE /server/sybase/ASE_12501_2/ASE-12_5
> 
> Note the SetEnv directives are used in addition to setting the environment
> with os.environ, but neither of these approaches work.  I am not familiar
> enough with the internals of mod_python, but it seems perhaps
> run_spyceModpy::spyceMain is the mon_python handler and perhaps it is
> somehow forgetting the environment variables.  Does this seem like a likely
> possibility to you?

I had a similar problem with Apache, PHP and ORACLE. I tried the SetEnv
approach too...

The catch is that SetEnv just sets some Apache-specific internal
environment - that has nothing to do with the UNIX/OS environment.

I've also tried to solve the problem by putting putenv("ORACLE_HOME=...") 
in the PHP code. And with that sometimes it worked and sometimes it
didn't. 

Last I've found that I must set the environment prior to starting the 
apache process. I've ended up with:

    env - ORACLE_HOME=/usr/share/oracle \
           /usr/sbin/apachectl start

in my "/etc/rc.d/rc.httpd" script, and a note to everyone never to call 
"apachectl" directly but to always call "/etc/rc.d/rc.httpd".

In the end the conclusion is that these proprietary products SUCK, it so
much simpler with MySQL or PostgreSQL.



-- 
Damjan Georgievski

From frank at fejes.net  Fri Mar 28 23:14:12 2003
From: frank at fejes.net (Frank S. Fejes III)
Date: Fri Jan  9 21:47:19 2004
Subject: [mod_python] Why are you using mod_python?
In-Reply-To: <20030328172826.X67038-100000@eden.ispol.com>
References: <20030328075642.A25172@ash.int.ca.pason.com>
	<20030328172826.X67038-100000@eden.ispol.com>
Message-ID: <20030328231412.24efac21.frank@fejes.net>

Nobody has responded yet...I've been curious myself.  Personally, my primary
goal in using it (and other mod_* language modules) is to improve the
performance/scalability of my CGI applications.  Unfortunately, I really
dislike the Publisher handler's way of doing things (the
programname.py/method URL syntax feels silly to me) and it seems like most
people are very down on the capabilities and stability of the CGI handler so
I find myself just going plain CGI anyway for many things now when I use
python.

Not to start religious wars, but I find myself using and enjoying mod_ruby
the most of all the web development "environments".  It's simple to use for
the basics while maintaining a very neat and clear way of manipulating
requests and performing advanced tasks.  As an added bonus, eruby (inline
ruby ala asp/php) is nicely integrated.

On a somewhat tangential note, I think mod_python documentation reflects
strangely on what target audience might be interested in the module.  Almost
all introductions I've seen to mod_python begin with a tutorial on creating
a handler.  I'd venture a guess that writing handlers is what fewer than 1%
of web developers want to do with an apache module initially.  In my
experience, most people want to write some code and have it run faster than
it would run under straight CGI...they don't want to write custom handlers.

It's late and I'm tired so take everything I say with a grain of salt! :)

--frank

On Fri, 28 Mar 2003 17:38:48 -0500 (EST)
"Gregory (Grisha) Trubetskoy" <grisha@modpython.org> wrote:

> 
> Hello everyone -
> 
> As the original author of mod_python I think I'm allowed to jerk people's
> chains with this simple question:
> 
> Why are you using mod_python?
> 
> You can reply on or off list, either is fine. The results, after I get to
> mull over them will be published in one way or another.
> 
> I've decided to ask the list because I recently realized that I am not
> sure I know the answer. Not to say that I don't like mod_python, on the
> contrary, I do, but to formulate in words exactly why is rather difficult.
> Besides, my opinion is biased anyway :-)
> 
> Thanks in advance!
> 
> Grisha
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 

From pascalbarbedor at free.fr  Sat Mar 29 08:27:57 2003
From: pascalbarbedor at free.fr (pascal barbedor)
Date: Fri Jan  9 21:47:19 2004
Subject: Fw: [mod_python] Why are you using mod_python?
Message-ID: <002501c2f5c4$b8d35d10$118a933e@allalswqm99ewu>

----- Original Message -----
From: "pascal barbedor" <pascalbarbedor@free.fr>
To: "Gregory (Grisha) Trubetskoy" <grisha@modpython.org>
Sent: Saturday, March 29, 2003 8:03 AM
Subject: Re: [mod_python] Why are you using mod_python?


> Hi
>
>
> I am using it because it is simple and the documentation is clear and
> simple.
> Its only a little more effort compared to plain cgi and it is faster.
>
> also I use it bare bone, I don't use the publisher and I don't use any
> template system on top of mod_python.
> (I am not fond of template systems, I think req.write is enough)
> I find it modular and convenient to add one handler by directory and I
> usually rely on a directoryindex index.py
> to be able to call the handler simply with /myweb  without anything else,
> which is mapped to myweb/index.py by apache.
> this way I never call a .py file explicitely.
> each index.py is a dispatcher to other .py files in the same dir
> I also have a common directory with site wide classes and functions. and
> that's it.
>
> I use it on win32
> before python I was using perl/mod_perl but its not working very good on
> win32 yet for apache 2, at least I had core dumps related to libxml and so
I
> moved to python/mod_python, and stopped using libxslt or any xlst
transform
> , and now use only sax transform. its clearer than big xls stylesheets.
>
> I find that the documentation could contain more usage examples but is
good
> anyway.
> also the developing process is made uncomparabely better through the debug
> directive which outputs on the browser and the automatic reload of modules
>
> so that I don't see the difference compared to cgi developement, and I see
a
> difference in that I have the satisfaction to use a close to apache API
and
> it's fun.
>
> I must say when I tried the authentication exxample in the doc, I could
not
> make it work.
>
> but still the feeling is that it works very well, development is very
> confortable, and I am glad I tried it.
>
>
> thanks
> pascal
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
> ----- Original Message -----
> From: "Gregory (Grisha) Trubetskoy" <grisha@modpython.org>
> To: <mod_python@modpython.org>
> Sent: Friday, March 28, 2003 11:38 PM
> Subject: [mod_python] Why are you using mod_python?
>
>
> >
> > Hello everyone -
> >
> > As the original author of mod_python I think I'm allowed to jerk
people's
> > chains with this simple question:
> >
> > Why are you using mod_python?
> >
> > You can reply on or off list, either is fine. The results, after I get
to
> > mull over them will be published in one way or another.
> >
> > I've decided to ask the list because I recently realized that I am not
> > sure I know the answer. Not to say that I don't like mod_python, on the
> > contrary, I do, but to formulate in words exactly why is rather
difficult.
> > Besides, my opinion is biased anyway :-)
> >
> > Thanks in advance!
> >
> > Grisha
> >
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://www.modpython.org/mailman/listinfo/mod_python
> >
>


From stevehamilton at blueyonder.co.uk  Sat Mar 29 12:12:42 2003
From: stevehamilton at blueyonder.co.uk (Stephen Hamilton)
Date: Fri Jan  9 21:47:19 2004
Subject: [mod_python] Import Error (windows)
Message-ID: <000801c2f5ec$7fe2c450$0100a8c0@willem>

Python 2.2
Apache 2.0.44
mod_python-3.0.3.win32.exe

new to mod_python and list so be gentle with me

searched through the list and found similar probs but on different
platforms and versions
but no answers (probably me not looking hard enough)

anyway following tutorial and set httpd.conf as said :-

LoadModule python_module modules/mod_python.so

<Directory "C:\Program Files\Apache Group\Apache2\htdocs\test"> 
  AddHandler python-program .py
  PythonHandler mptest.py 
  PythonDebug On 
</Directory>
 
error reads:-
Mod_python error: "PythonHandler mptest.py"
Traceback (most recent call last):
  File "C:\Python22\Lib\site-packages\mod_python\apache.py", line 320, in HandlerDispatch
    module = import_module(module_name, config)
  File "C:\Python22\Lib\site-packages\mod_python\apache.py", line 496, in import_module
    f, p, d = imp.find_module(parts[i], path)

ImportError: No module named py

it's probably a simple answer but can anyone help
thanks in advance
stephen
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20030329/d7038de0/attachment.htm
From pascalbarbedor at free.fr  Sat Mar 29 14:44:32 2003
From: pascalbarbedor at free.fr (pascal barbedor)
Date: Fri Jan  9 21:47:19 2004
Subject: [mod_python] Import Error (windows)
References: <000801c2f5ec$7fe2c450$0100a8c0@willem>
Message-ID: <000b01c2f5f9$54c28050$a8a1933e@allalswqm99ewu>

hi

maybe spaces in path is bad idea, plus forward slashes required

pascal
  ----- Original Message ----- 
  From: Stephen Hamilton 
  To: mod_python@modpython.org 
  Sent: Saturday, March 29, 2003 1:12 PM
  Subject: [mod_python] Import Error (windows)


  Python 2.2
  Apache 2.0.44
  mod_python-3.0.3.win32.exe

  new to mod_python and list so be gentle with me

  searched through the list and found similar probs but on different
  platforms and versions
  but no answers (probably me not looking hard enough)

  anyway following tutorial and set httpd.conf as said :-

  LoadModule python_module modules/mod_python.so

  <Directory "C:\Program Files\Apache Group\Apache2\htdocs\test"> 
    AddHandler python-program .py
    PythonHandler mptest.py 
    PythonDebug On 
  </Directory>
   
  error reads:-
  Mod_python error: "PythonHandler mptest.py"
  Traceback (most recent call last):
    File "C:\Python22\Lib\site-packages\mod_python\apache.py", line 320, in HandlerDispatch
      module = import_module(module_name, config)
    File "C:\Python22\Lib\site-packages\mod_python\apache.py", line 496, in import_module
      f, p, d = imp.find_module(parts[i], path)

  ImportError: No module named py

  it's probably a simple answer but can anyone help
  thanks in advance
  stephen
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20030329/6ec25c38/attachment.htm
From dustin at ywlcs.org  Sat Mar 29 10:04:06 2003
From: dustin at ywlcs.org (Dustin Mitchell)
Date: Fri Jan  9 21:47:19 2004
Subject: [mod_python] Why are you using mod_python?
In-Reply-To: <20030328172826.X67038-100000@eden.ispol.com>
References: <20030328075642.A25172@ash.int.ca.pason.com> <20030328172826.X67038-100000@eden.ispol.com>
Message-ID: <20030329160405.GJ10000@eleanor.internal.ywlcs.org>

I use mod_python because it turns the web server into one very large
event-driven Python program.  I can do whatever I want with requests.  I can
parse URLs however I'd like.  I can construct the response however I'd like.
I have complete control over the transaction, without any hacks or other
impediments.

One of the advantages of having the web server act like a very large Python
program is its speed.  Also, from this frame of mind, caching and
preflighting are almost intuitive (if you've ever done SMP programming before
:-)

Dustin

-- 

  Dustin Mitchell
  dustin@ywlcs.org/djmitche@alumni.uchicago.edu
  http://people.cs.uchicago.edu/~dustin/

From neo at https.ru  Sat Mar 29 22:58:26 2003
From: neo at https.ru (Neo Eureka)
Date: Fri Jan  9 21:47:19 2004
Subject: [mod_python] Import Error (windows)
In-Reply-To: <000801c2f5ec$7fe2c450$0100a8c0@willem>
References: <000801c2f5ec$7fe2c450$0100a8c0@willem>
Message-ID: <245039446.20030329225826@https.ru>

 You should not add ".py" extension.
The correct line is:

 PythonHandler mptest


> Python 2.2
> Apache 2.0.44
> mod_python-3.0.3.win32.exe

> new to mod_python and list so be gentle with me

> searched through the list and found similar probs but on different
> platforms and versions
> but no answers (probably me not looking hard enough)

> anyway following tutorial and set httpd.conf as said :-

> LoadModule python_module modules/mod_python.so

> <Directory "C:\Program Files\Apache Group\Apache2\htdocs\test"> 
>   AddHandler python-program .py
>   PythonHandler mptest.py 
>   PythonDebug On 
> </Directory>
 
> error reads:-
> Mod_python error: "PythonHandler mptest.py"
> Traceback (most recent call last):
>   File "C:\Python22\Lib\site-packages\mod_python\apache.py", line 320, in HandlerDispatch
>     module = import_module(module_name, config)
>   File "C:\Python22\Lib\site-packages\mod_python\apache.py", line 496, in import_module
>     f, p, d = imp.find_module(parts[i], path)

> ImportError: No module named py

> it's probably a simple answer but can anyone help
> thanks in advance
> stephen


--- 
Neo Eureka / mailto:neo@https.ru


From stevehamilton at blueyonder.co.uk  Sat Mar 29 20:20:57 2003
From: stevehamilton at blueyonder.co.uk (Stephen Hamilton)
Date: Fri Jan  9 21:47:19 2004
Subject: [mod_python] re Import Error (windows)
Message-ID: <002d01c2f630$b54709f0$0100a8c0@willem>

update for other wooden heads like me 
without the ".py" it works a treat
thanks for the swift response and your patients
stephen   (8(|) doe


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20030329/e7ab7378/attachment.htm
From ian at veryfresh.com  Sat Mar 29 16:46:45 2003
From: ian at veryfresh.com (Ian Clelland)
Date: Fri Jan  9 21:47:19 2004
Subject: [mod_python] Why are you using mod_python?
In-Reply-To: <20030328231412.24efac21.frank@fejes.net>
References: <20030328075642.A25172@ash.int.ca.pason.com> <20030328172826.X67038-100000@eden.ispol.com> <20030328231412.24efac21.frank@fejes.net>
Message-ID: <20030330004644.GA17569@fullfactor.com>

On Fri, Mar 28, 2003 at 11:14:12PM -0600, Frank S. Fejes III wrote:
> On Fri, 28 Mar 2003 17:38:48 -0500 (EST)
> "Gregory (Grisha) Trubetskoy" <grisha@modpython.org> wrote:
> 
> > 
> > Hello everyone -
> > 
> > As the original author of mod_python I think I'm allowed to jerk people's
> > chains with this simple question:
> > 
> > Why are you using mod_python?

...

> On a somewhat tangential note, I think mod_python documentation reflects
> strangely on what target audience might be interested in the module.  Almost
> all introductions I've seen to mod_python begin with a tutorial on creating
> a handler.  I'd venture a guess that writing handlers is what fewer than 1%
> of web developers want to do with an apache module initially.  In my
> experience, most people want to write some code and have it run faster than
> it would run under straight CGI...they don't want to write custom handlers.

Well, I suppose I must be counted among that 1% :) I switched to
mod_python from PHP and Servlets about <checks CVS> 8 or 9 months ago,
and it was primarily because of the flexibility and power of cutsom
handlers. I love the fact that I can write applications whose URLs have
some meaning besides simply naming a file on the web server's hard
drive.

When I was first introduced to mod_python, I imagined it to be simply a
way to embed python code inline into HTML files (like PHP or JSP,) and I
nearly dismissed it out of hand. I looked at it more carefully, though,
and when I realised that it was more akin to mod_perl, and would
actually give me an opportunity to interact so closely with Apache, I
became much more excited working with it.

Since then, I have adopted many of the tenets of the REST philosophy,
and I have found mod_python to be an ideal platform to develop REST-ful
applications. I doubt I could even go back to the CGI or PHP ways of
doing things now.


But then, that might just be me :)


Ian Clelland
<ian@veryfresh.com>

From peter.bittner at gmx.net  Sun Mar 30 22:55:55 2003
From: peter.bittner at gmx.net (Peter Bittner)
Date: Fri Jan  9 21:47:19 2004
Subject: [mod_python] Why are you using mod_python?
Message-ID: <18707.1049057755@www41.gmx.net>

Hi there!

I like mod_python because I like Python and I am glad whenever I can use it
to write web applications. Customers, however, in most cases ask me to go for
PHP or so since this is easier to find programmers for for maintenance
afterwards.

> Personally, my primary goal in using it (and other mod_* language
> modules) is to improve the performance/scalability of my CGI applications.

This is true for me, too.

> Unfortunately, I really dislike the Publisher handler's way of doing
things
> (the programname.py/method URL syntax feels silly to me) and it seems
> like most people are very down on the capabilities and stability of the
> CGI handler so I find myself just going plain CGI anyway for many things
> now when I use python.

This is absolutely true for myself, too. Clearly, I would appreciate
mod_python to have nothing but advantages, but it does have those unconfortable
features.

> Almost all introductions I've seen to mod_python begin with a
> tutorial on creating a handler.  I'd venture a guess that writing
> handlers is what fewer than 1% of web developers want to do
> with an apache module initially.  In my experience, most people
> want to write some code and have it run faster than it would run
> under straight CGI...they don't want to write custom handlers.

I absolutely agree. This is my opinion, too.

I also do not see why modifying the webserver's (Apache's) configuration
should be advantagous when I, say, add a new directory to my web project. When I
want to write, say, a website, I do not want to go into /etc/apache.conf (I
might not even have access to it!), but I want to go straight into coding.
And porting this code to another webserver should not be a nightmare, but a job
of copying the .py files, that's it.

I like Python and I'd be happy to see mod_python becoming as popular for web
programming as PHP is today.

Cheers, Peter

-- 
Peter Bittner
mail: peter.bittner@gmx.net

"Free software is like free speech, not free beer" (Richard Stallman)

+++ GMX - Mail, Messaging & more  http://www.gmx.net +++
Bitte l?cheln! Fotogalerie online mit GMX ohne eigene Homepage!


From mike.looijmans at asml.com  Mon Mar 31 07:35:36 2003
From: mike.looijmans at asml.com (Mike Looijmans)
Date: Fri Jan  9 21:47:19 2004
Subject: [mod_python] Why are you using mod_python?
Message-ID: <01c2f747$5aecc400$926a1e6e@wsasd464>

Simple: There were a few dozen clients when we started this project. There
will be about 400 when we roll it out worldwide, and I didn't want the server
to spend too much time loading the interpreter for each call.
With CGI, it could process about 2 requests per second. With mod_python, that
increased to over 20 per second.

Keeping database connections alive and some internal caching were nice things
to add (I like a bit of multithreaded programming), but did not add any
measurable performance gains (I guess the Python-MySQL link is just too fast
when all is local).

Our system is now hybrid - servers can either use CGI or mod_python (bot if
they like). But I did not use cgihandler because it also took quite a
performance hit because of reloading a lot of libraries, and after a few dozen
requests the cgi library would lose the os.environ and a restart of the server
would be neccesary to get things going again. Also, cgihandler does not
combine well with Apache's "worker" thread model, cgihandler turns the whole
system into a single-threaded server in that particular case.

--
Mike Looijmans
ASML: http://www5nl.asml.nl/~mlooijma
Private: http://www.milosoftware.com

-----Original Message-----
From: Gregory (Grisha) Trubetskoy <grisha@modpython.org>
To: mod_python@modpython.org <mod_python@modpython.org>
Date: Saturday, March 29, 2003 12:42 AM
Subject: [mod_python] Why are you using mod_python?


>
>Hello everyone -
>
>As the original author of mod_python I think I'm allowed to jerk people's
>chains with this simple question:
>
>Why are you using mod_python?
>



From sandor.kopanyi at mailbox.hu  Mon Mar 31 08:57:35 2003
From: sandor.kopanyi at mailbox.hu (sandor.kopanyi@mailbox.hu)
Date: Fri Jan  9 21:47:19 2004
Subject: [mod_python] Re: Why are you using mod_python?
In-Reply-To: <20030329170001.80558.66529.Mailman@eden.ispol.com>
Message-ID: <20030331065735.16655.qmail@arnold.mailbox.hu>

Hi,

I'm using mod_python because of:
- simplicity
- elegance of Python
- rich Python libs
- quick development

/Sandor
PS. I don't have anything against publisher, I use it regurarly, beside
the other ways


_______________________________________________________________________
http://mailbox.hu - WAP-on is olvashatod




From mike at mikesclutter.com  Sat Mar  1 11:07:23 2003
From: mike at mikesclutter.com (Michael Owens)
Date: Fri Jan  9 21:53:24 2004
Subject: [mod_python] Problem with C extension type
Message-ID: <200303011107.23400.mike@mikesclutter.com>

This is a rather intricate problem, but I don't know where else to go. I have 
a C extension in which I created a native Python type, call it X, which has 
two methods: A() and B(). Then I create a Python class, derived from X type, 
called Y, which has has two methods C() and D(). Y is defined as follows 
(cmod is my C extension in which X is implemented)

from cmod import X

class Y(X):
  
    def __new__(cls, db):
        return super(Y, cls).__new__(cls)

    def C():
	print "C()"

    def D():
	print "D()"

If I call Y.A() from a normal python script, there is no problem --- it 
resolved to X.A(). But if I do this inside of mod_python, I get an error 
saying that object Y has no such attribute A. I don't understand why 
mod_python would be any different in attribute resolution than Python would 
be since it is using the same Python implementation/library. I am using 
Python 2.2.2 and mod_python 3.0.1 in Apache 2.x.

Any ideas?

Michael Owens.

From jermnsar at hotmail.com  Sat Mar  1 20:04:23 2003
From: jermnsar at hotmail.com (Jeremy Lowery)
Date: Fri Jan  9 21:53:24 2004
Subject: [mod_python] Full Path Info on Request object
Message-ID: <F138mnSA3oZs7pKy2uh0001dc06@hotmail.com>

Hello,

I'm writing my own publisher, and I don't understand why mod_python doesn't 
include the full pathname in the req.filename attribute.

In my .htaccess

SetHandler python-program
# My Custom Publisher in this directory
PythonHandler ServletPublisher
PythonDebug On

I make a request:
http://localhost/~jermnsar/foo/bar/test/hmm?dat=val&val2=dat2

and printing out the variables:

req.uri /~jermnsar/foo/bar/test/hmm
req.filename C:/Documents and Settings/jermnsar/My Documents/My Website/foo


What would be an easy way to resolve to
C:/Documents and Settings/jermnsar/My Documents/My Website/foo/bar/test/hmm

or at least easily extract the /bar/test/hmm

Would be easy to do with some string manip I suppose, but I'm looking for 
faster (i.e. quicker CPU wise) way.

Why does the translation from the web path to the physical path only include 
the first element?

Windows XPsp1/Apache 2.0.44/mod_python 3.0.1

Thanks
Jeremy S Lowery






_________________________________________________________________
MSN 8 helps eliminate e-mail viruses. Get 2 months FREE*.  
http://join.msn.com/?page=features/virus


From mike at mikesclutter.com  Mon Mar  3 17:26:37 2003
From: mike at mikesclutter.com (Michael Owens)
Date: Fri Jan  9 21:53:24 2004
Subject: [mod_python] Problem with C extension type
In-Reply-To: <200303011107.23400.mike@mikesclutter.com>
References: <200303011107.23400.mike@mikesclutter.com>
Message-ID: <200303031726.37382.mike@mikesclutter.com>

As a matter of interest, I found what was wrong (sort of). My C type's (X's) 
tp_getattro implementation was screwy. When I replaced it with 
PyObject_GenericGetAttr, everything worked fine in mod_python. I still don't 
know why the original implementation worked in Python and not in mod_python, 
but I don't care so long as it works now.

On Saturday 01 March 2003 11:07 am, Michael Owens wrote:
> This is a rather intricate problem, but I don't know where else to go. I
> have a C extension in which I created a native Python type, call it X,
> which has two methods: A() and B(). Then I create a Python class, derived
> from X type, called Y, which has has two methods C() and D(). Y is defined
> as follows (cmod is my C extension in which X is implemented)
>
> from cmod import X
>
> class Y(X):
>
>     def __new__(cls, db):
>         return super(Y, cls).__new__(cls)
>
>     def C():
> 	print "C()"
>
>     def D():
> 	print "D()"
>
> If I call Y.A() from a normal python script, there is no problem --- it
> resolved to X.A(). But if I do this inside of mod_python, I get an error
> saying that object Y has no such attribute A. I don't understand why
> mod_python would be any different in attribute resolution than Python would
> be since it is using the same Python implementation/library. I am using
> Python 2.2.2 and mod_python 3.0.1 in Apache 2.x.
>
> Any ideas?
>
> Michael Owens.
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

From mark at camazotz.com  Wed Mar  5 23:19:09 2003
From: mark at camazotz.com (Mark Smith)
Date: Fri Jan  9 21:53:24 2004
Subject: [mod_python] mod_python 3.0, Apache 2.0, OS X 10.2
Message-ID: <C6F0BB52-4F8A-11D7-ABDE-00039364CE50@camazotz.com>

Has anyone succeeded in building mod_python 3 on Apache 2 under OS X?  
Last time it was discussed was November last year:

http://www.modpython.org/pipermail/mod_python/2002-November/002652.html

thanks,
Mark


From grisha at modpython.org  Thu Mar  6 00:35:26 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:53:24 2004
Subject: [mod_python] mod_python 3.0, Apache 2.0, OS X 10.2
In-Reply-To: <C6F0BB52-4F8A-11D7-ABDE-00039364CE50@camazotz.com>
Message-ID: <20030306003346.D12356-100000@eden.ispol.com>

It builds and runs just fine undex OS X, you should have at least mp 3.0.1
and better yet the latest sources from CVS, and make sure to check out the
README, it has some OS X instructions in it.

Grisha

On Wed, 5 Mar 2003, Mark Smith wrote:

> Has anyone succeeded in building mod_python 3 on Apache 2 under OS X?
> Last time it was discussed was November last year:
>
> http://www.modpython.org/pipermail/mod_python/2002-November/002652.html
>
> thanks,
> Mark
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From pascalbarbedor at free.fr  Fri Mar  7 00:19:59 2003
From: pascalbarbedor at free.fr (pascal barbedor)
Date: Fri Jan  9 21:53:24 2004
Subject: [mod_python] req.user stays None in authen
Message-ID: <002101c2e436$e8c50c70$908b933e@allalswqm99ewu>

Hi on win 32 with python 2.2.2, installed last version 3.01, added missing mscvrt70.dll
and everything works great!


I wanted to try out the doc tutorial 
<Directory /mywebdir>
AddHandler python-program .py
PythonHandler myscript
PythonAuthenHandler myscript
PythonDebug On
AuthType Basic
AuthName "Restricted Area"
require valid-user
</Directory>

with script

from mod_python import apache
def authenhandler(req):
user = req.user
pw = req.get_basic_auth_pw()
if user == "spam" and pw == "eggs":
return apache.OK
else:
return apache.HTTP_UNAUTHORIZED

it works but req.user is always None
I printed user, pw to apache log and got None eggs
ie password is well passed, but not user
so the authentication results in neverending pop up login window

I checked from mozilla and opera browser


thanks for any help








-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20030307/9852e6fb/attachment-0001.htm
From pmguerre at ualg.pt  Mon Mar 10 20:30:34 2003
From: pmguerre at ualg.pt (Pedro Guerreiro)
Date: Fri Jan  9 21:53:24 2004
Subject: [mod_python] Installing mod_python 3.0.1 in Windows
Message-ID: <20030310202756.F238C4BE80@smtp.ualg.pt>

Hi.

Why was the instructions on how to install mod_python in windows removed from 
the 3.0 documentation? AFAIK in the previous release there was instructions 
on how to do this...

Also, why isn't _anywhere_ (AFAICT) a reference that you _also_ need the Unix 
source (from mod_python-x.tgz) to install it in Windows? From 
http://httpd.apache.org/modules/python-download.cgi one gets the ideia that 
to install it in Windows only the python2.2.2-apache2.0.43.zip is needed?

And finally, why isn't documented that one need msvcr70.dll (not everyone has 
Microsoft Visual _whatever_ installed) to run mod_python?

To resume, please make some documentation on how to install the new 
mod_python on the windows platform, so that someone does go away because 
he/she cannot put mod_python to work... Or at least put up some link to 
http://www.modpython.org/pipermail/mod_python/2002-December/002714.html, and 
to http://www.modpython.org/live/mod_python-2.7.8/doc-html/app-wininst.html

Thanks, and keep up the good work.

	-pmg

From sury.ondrej at globe.cz  Tue Mar 11 11:32:21 2003
From: sury.ondrej at globe.cz (Ondrej Sury)
Date: Fri Jan  9 21:53:24 2004
Subject: [mod_python] session management in mod_python
Message-ID: <87bs0ib3d6.fsf@globe.cz>

Since I still haven't found what I am looking for ;-) (no, I have found
search page for mailing list archive), I just want to ask if there is some
module which is solving /subj. (something like php has) ie. setting session
cookie, loading session variables etc.

O.

-- 
Ondrej Sury - CIO                   Globe Internet s.r.o. http://globe.cz/
Tel: +420(2)35365000 Fax: +420(2)35365009     Planickova 1, 162 00 Praha 6

From lyager at phunkbros.dk  Tue Mar 11 12:18:05 2003
From: lyager at phunkbros.dk (Jesper L. Nielsen)
Date: Fri Jan  9 21:53:24 2004
Subject: [mod_python] session management in mod_python
In-Reply-To: <87bs0ib3d6.fsf@globe.cz>
References: <87bs0ib3d6.fsf@globe.cz>
Message-ID: <20030311111805.GA2976@home.phunkbros.dk>

* Ondrej Sury (sury.ondrej@globe.cz) [2003-03-11 11:03]:
> Since I still haven't found what I am looking for ;-) (no, I have found
> search page for mailing list archive), I just want to ask if there is some
> module which is solving /subj. (something like php has) ie. setting session
> cookie, loading session variables etc.

Personally I'm pretty happy with PyWebLib
(http://www.stroeder.com/pylib/PyWebLib/), which is very customize-able 
:) .  I'm sure, though, that there are many other possibilities.

--
Jesper L. Nielsen
http://phunkbros.dk

From cjackson at spsu.edu  Tue Mar 11 16:10:03 2003
From: cjackson at spsu.edu (Chris Jackson)
Date: Fri Jan  9 21:53:24 2004
Subject: [mod_python] prototype 3.0.3
Message-ID: <000201c2e812$9572f6b0$5f05010a@moxie>

+1
 
moxie
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20030311/456a779e/attachment-0001.htm
From grisha at modpython.org  Wed Mar 12 10:18:38 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:53:24 2004
Subject: [mod_python] prototype 3.0.3
In-Reply-To: <000201c2e812$9572f6b0$5f05010a@moxie>
Message-ID: <20030312101758.F18937-100000@eden.ispol.com>

Thanks

I've been kinda swamped lately, but I'll try to put it out there today or
tomorrow.

Grisha

On Tue, 11 Mar 2003, Chris Jackson wrote:

> +1
>
> moxie
>


From neel at mediapulse.com  Wed Mar 12 10:57:25 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:53:24 2004
Subject: [mod_python] Fixup hander not always being called
Message-ID: <C0FC22C08B82074A88B50061764157775C0C@johnson.mediapulse.net>

I have some mod perl code I'm trying to move over to modpython.  The
perl code adds a cookie header to all requests using the fixup phase,
and then logs some info in the logging phase.  When I setup python to do
the same, the fixup handler is not always called.  It looks like it is
related to cgi scripts, as when I hit a cgi page in the web browser, my
fixup handler is not called - but it will call the perl version.

My conf has:

    <Location />
        #SetHandler python-program
        PythonLogHandler qlog
        PythonFixupHandler qlog
        PythonDebug On
    </Location>

I've commented out the SetHandler because that would break cgi scripts
(causing the text of the script to be sent to the browser, instead of
executing it).  This is the same with mod_perl, you can't use the
SetHandler.

qlog.py (simplified):

from mod_python import apache

def fixuphandler(req):

    apache.log_error("----------- New Hit -----------")
    apache.log_error("CT: " + str(req.content_type))

def loghandler(req):

    apache.log_error("----------- Log Hit -----------")


Any insights?  I'd like to do the new version of this code in python,
and not perl, but I gotta get this cgi snafu solved.

Thanks,
Mike


From neel at mediapulse.com  Wed Mar 12 13:34:23 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:53:24 2004
Subject: [mod_python] Fixup hander not always being called
Message-ID: <C0FC22C08B82074A88B50061764157772C654C@johnson.mediapulse.net>

Sctratch the below.  It looks like the function apache.log_error()
doesn't always work, so my method of testing the handler was flawed.  I
used Sam Spade to watch headers, and my cookies are being added, even
though the calls to the error_log are not printing.

Also, I left off I'm using 2.7.8 on Apache 1.3.26

Thanks,
Mike

-----Original Message-----
From: Michael C. Neel 
Sent: Wednesday, March 12, 2003 10:57 AM
To: mod_python@modpython.org
Subject: [mod_python] Fixup hander not always being called


I have some mod perl code I'm trying to move over to modpython.  The
perl code adds a cookie header to all requests using the fixup phase,
and then logs some info in the logging phase.  When I setup python to do
the same, the fixup handler is not always called.  It looks like it is
related to cgi scripts, as when I hit a cgi page in the web browser, my
fixup handler is not called - but it will call the perl version.

My conf has:

    <Location />
        #SetHandler python-program
        PythonLogHandler qlog
        PythonFixupHandler qlog
        PythonDebug On
    </Location>

I've commented out the SetHandler because that would break cgi scripts
(causing the text of the script to be sent to the browser, instead of
executing it).  This is the same with mod_perl, you can't use the
SetHandler.

qlog.py (simplified):

from mod_python import apache

def fixuphandler(req):

    apache.log_error("----------- New Hit -----------")
    apache.log_error("CT: " + str(req.content_type))

def loghandler(req):

    apache.log_error("----------- Log Hit -----------")


Any insights?  I'd like to do the new version of this code in python,
and not perl, but I gotta get this cgi snafu solved.

Thanks,
Mike

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python


From grisha at apache.org  Mon Mar 17 10:49:27 2003
From: grisha at apache.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:53:24 2004
Subject: [mod_python] ANNOUNCE: Mod_python 3.0.3
In-Reply-To: <20021127135855.Q36516-100000@eden.ispol.com>
Message-ID: <20030317103105.X92188-100000@eden.ispol.com>

The Apache Software Foundation and The Apache HTTP Server Project are
pleased to announce the release of mod_python 3.0.3.

Mod_python is an Apache HTTP Server module that embeds the Python
interpreter within the server. With mod_python you can write web-based
applications in Python that will run many times faster than traditional
CGI and will have access to advanced features such as ability to retain
database connections between requests, access to httpd internals and
provide content filter as well as connection handlers.

This release fixes numerous bugs identified after last release (3.0.1). It
is highly recommended that you upgrade to version 3.0.3 for improved
stability and performance.

Mod_python is available for download from:

http://httpd.apache.org/modules/python-download.cgi

For more information about mod_python visit:

http://www.modpython.org/

Regards,

Grisha Trubetskoy


From mike.looijmans at asml.com  Tue Mar 18 08:07:14 2003
From: mike.looijmans at asml.com (Mike Looijmans)
Date: Fri Jan  9 21:53:24 2004
Subject: [mod_python] ANNOUNCE: Mod_python 3.0.3
Message-ID: <01c2ed1d$009e3d00$926a1e6e@wsasd464>

Hmm. Had some troubles running this baby after the ./configure - smake - smake
install dance. Turned out to be a file permission problem.
The following occured in the apache error log:

[Tue Mar 18 07:56:33 2003] [notice] Apache/2.0.44 (Unix) mod_python/3.0.3
Python/2.2.2 configured -- resuming normal operations
[Tue Mar 18 07:56:35 2003] [error] make_obcallback: could not import
mod_python.apache.

ImportError: No module named apache
[Tue Mar 18 07:57:01 2003] [error] make_obcallback: could not import
mod_python.apache.


The problem was that in /usr/local/lib/python2.2/site-package/mod_pyton, all
files were root-only (pun intented) after installation (mode 600). Would be
nice if the install script forced to 644 mode instead. The apache server runs
as user "nobody" so didn't get access.

--
Mike Looijmans
ASML: http://www5nl.asml.nl/~mlooijma
Private: http://www.milosoftware.com

-----Original Message-----
From: Gregory (Grisha) Trubetskoy <grisha@apache.org>


>
>The Apache Software Foundation and The Apache HTTP Server Project are
>pleased to announce the release of mod_python 3.0.3.



From graeme_matthew at hotmail.com  Tue Mar 18 23:05:21 2003
From: graeme_matthew at hotmail.com (Graeme Matthew)
Date: Fri Jan  9 21:53:24 2004
Subject: [mod_python] Cant get modPython working
Message-ID: <BAY1-F12ATiyhGvDpED000327a4@hotmail.com>

Hi all, im pulling out my 7pm brown hair that is now almost grey !!!!!

I have followed the instructions to get mod_python working on Win32 (XP)

I have edited my conf file as follows:

LoadModule python_module modules/mod_python.so

#added handler directives in scriptalias
<Directory "C:/Program Files/Apache Group/Apache2/cgi-bin">
    AllowOverride None
    Options None
    Order allow,deny
    Allow from all
    AddHandler python-program .py
    PythonHandler mptest
    PythonDebug On
</Directory>

I have placed mptest.py in my cgi-bin folder it contains the following:


from mod_python import apache

def handler(req):
    req.write("Content-type: text/html\n\nHello World!")
    return apache.OK

I keep on getting a HTTP 500 Internal Server Error and cant understand why 
as the log file does not seem to contain the error.

Any help would be much appreciated

Thanks


Graeme

_________________________________________________________________
MSN Instant Messenger now available on Australian mobile phones. Go to  
http://ninemsn.com.au/mobilecentral/hotmail_messenger.asp


From graeme_matthew at hotmail.com  Wed Mar 19 00:07:44 2003
From: graeme_matthew at hotmail.com (Graeme Matthew)
Date: Fri Jan  9 21:53:24 2004
Subject: [mod_python] ModPython working, but multiple handlers ?
Message-ID: <BAY1-F66Hy3SpwBGpEI00000f34@hotmail.com>

Hi all, finally got it working, so please ignore my previous request ...

my last issue before bead is adding multiple handlers

if I do the following:

PythonHandler mptest
PythonHandler app

then my app also prints out mptest within the webpage

If anyone has experienced this then i would like to hear how you solved it, 
as soon as I take mptest out, the problem is removed

Regards


Graeme




_________________________________________________________________
Hotmail now available on Australian mobile phones. Go to  
http://ninemsn.com.au/mobilecentral/hotmail_mobile.asp


From grisha at modpython.org  Tue Mar 18 11:16:15 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:53:24 2004
Subject: [mod_python] ModPython working, but multiple handlers ?
In-Reply-To: <BAY1-F66Hy3SpwBGpEI00000f34@hotmail.com>
Message-ID: <20030318111340.Q7557-100000@eden.ispol.com>

There can only be one PythonHandler and subsequent directives will
override previous, so the net effect of your config below is
"PythonHandler app".

If I understand what you're trying to do, you should look at the manual
and read about the Publisher handler in the tutorial.

Grisha

On Wed, 19 Mar 2003, Graeme Matthew wrote:

>
> Hi all, finally got it working, so please ignore my previous request ...
>
> my last issue before bead is adding multiple handlers
>
> if I do the following:
>
> PythonHandler mptest
> PythonHandler app
>
> then my app also prints out mptest within the webpage
>
> If anyone has experienced this then i would like to hear how you solved it,
> as soon as I take mptest out, the problem is removed
>
> Regards
>
>
> Graeme
>
>
>
>
> _________________________________________________________________
> Hotmail now available on Australian mobile phones. Go to
> http://ninemsn.com.au/mobilecentral/hotmail_mobile.asp
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From mtaylor at real.com  Thu Mar 20 14:07:42 2003
From: mtaylor at real.com (Mark Taylor)
Date: Fri Jan  9 21:53:25 2004
Subject: [mod_python] has anyone successfully built mod_python3.03 on OpenBSD?
Message-ID: <Pine.LNX.4.21.0303201358360.2164-100000@lothlorien.coreqa.prognet.com>

I've been using OpenBSD3.2, apache2.0.43 and python2.2.1

apxs is not building mod_python.so.  I've found similar plaints in the
threads, but no solutions.

-- 
Mark Taylor

Real Networks
Systems Administrator
Developer Services Group - Technical Operations

http://votetoimpeach.org/


From drh9296 at ritvax.rit.edu  Thu Mar 20 18:29:21 2003
From: drh9296 at ritvax.rit.edu (David Higgs)
Date: Fri Jan  9 21:53:25 2004
Subject: [mod_python] has anyone successfully built mod_python3.03 on
 OpenBSD?
References: 
 <Pine.LNX.4.21.0303201358360.2164-100000@lothlorien.coreqa.prognet.com>
Message-ID: <3E7A4ED1.9000909@rit.edu>

I haven't got around to getting mod_python working on my setup yet, but 
here's a heads-up...

There's a good chance that OpenBSD3.2's apache2 is chrooted to 
/var/www/, just like the default apache1.x.  You'll have to have a 
separate python install within /var/www/ or disable the chroot.

Can you paste the specific problems you're getting?  Maybe someone can 
help you out.

--david

Mark Taylor wrote:
> I've been using OpenBSD3.2, apache2.0.43 and python2.2.1
> 
> apxs is not building mod_python.so.  I've found similar plaints in the
> threads, but no solutions.


From mtaylor at real.com  Thu Mar 20 17:03:56 2003
From: mtaylor at real.com (Mark Taylor)
Date: Fri Jan  9 21:53:25 2004
Subject: [mod_python] has anyone successfully built mod_python3.03 on
 OpenBSD?
In-Reply-To: <3E7A4ED1.9000909@rit.edu>
Message-ID: <Pine.LNX.4.21.0303201653020.2164-100000@lothlorien.coreqa.prognet.com>

./configure --with-apxs=<location of apxs>  goes normally, without error.
running 'make' then goes normally until the end, when we get this output:

*** Warning: inter-library dependencies are not known to be supported.
*** All declared inter-library dependencies are being dropped.

*** Warning: libtool could not satisfy all declared inter-library
*** dependencies of module libmod_python.  Therefore, libtool will create
*** a static module, that should work as long as the dlopening
*** application is linked with the -dlopen flag.

Now su and make install
  (or, if you only want to perform a partial install,
   you can use make install_dso and make install_py_lib)

Source distribution found

...

# make install

Compiling for DSO.

...

Performing DSO installation.

/usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
install: src/mod_python.so: No such file or directory
*** Error code 71

Stop in /tmp/mod_python-3.0.3 (line 94 of Makefile).
*** Error code 1

Stop in /tmp/mod_python-3.0.3 (line 91 of Makefile).


AND, in fact, the link in ./src is broken.  there is no mod_python.so in
./src/.libs/ 

# ls src/.libs
libmod_python.a mod_python.la   mod_python.lai

???

mt

On Thu, 20 Mar 2003, David Higgs wrote:

> I haven't got around to getting mod_python working on my setup yet, but 
> here's a heads-up...
> 
> There's a good chance that OpenBSD3.2's apache2 is chrooted to 
> /var/www/, just like the default apache1.x.  You'll have to have a 
> separate python install within /var/www/ or disable the chroot.
> 
> Can you paste the specific problems you're getting?  Maybe someone can 
> help you out.
> 
> --david
> 
> Mark Taylor wrote:
> > I've been using OpenBSD3.2, apache2.0.43 and python2.2.1
> > 
> > apxs is not building mod_python.so.  I've found similar plaints in the
> > threads, but no solutions.
> 

-- 
Mark Taylor

Real Networks
Systems Administrator
Developer Services Group - Technical Operations

http://votetoimpeach.org/


From grisha at modpython.org  Thu Mar 20 23:46:47 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:53:25 2004
Subject: [mod_python] has anyone successfully built mod_python3.03 on
 OpenBSD?
In-Reply-To: <Pine.LNX.4.21.0303201653020.2164-100000@lothlorien.coreqa.prognet.com>
Message-ID: <20030320233453.O44142-100000@eden.ispol.com>

I am OpenBSD ignorant, but on FreeBSD it builds without a hinch (it also
builds on Darwin which has its own different set of complications).

This message usually means libtool is complaining that it won't build an
.so out of static libraries.

On all other OS's I've seen it this was resolvable by upgrading to latest
libtool where this restriction has been lifted.

Another solution is to build pythonlib as an .so - Python does not
directly support this, but it has been reported to work fine if done
manually with something like (YMMV):

mkdir .extract
cd .extract
ar xv ../libpython2.2.a
cd ..
gcc -shared -o libpython2.2.so.0 .extract/*.o
rm -rf .extract

Grisha

On Thu, 20 Mar 2003, Mark Taylor wrote:

>
> ./configure --with-apxs=<location of apxs>  goes normally, without error.
> running 'make' then goes normally until the end, when we get this output:
>
> *** Warning: inter-library dependencies are not known to be supported.
> *** All declared inter-library dependencies are being dropped.
>
> *** Warning: libtool could not satisfy all declared inter-library
> *** dependencies of module libmod_python.  Therefore, libtool will create
> *** a static module, that should work as long as the dlopening
> *** application is linked with the -dlopen flag.
>
> Now su and make install
>   (or, if you only want to perform a partial install,
>    you can use make install_dso and make install_py_lib)
>
> Source distribution found
>
> ...
>
> # make install
>
> Compiling for DSO.
>
> ...
>
> Performing DSO installation.
>
> /usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
> install: src/mod_python.so: No such file or directory
> *** Error code 71
>
> Stop in /tmp/mod_python-3.0.3 (line 94 of Makefile).
> *** Error code 1
>
> Stop in /tmp/mod_python-3.0.3 (line 91 of Makefile).
>
>
> AND, in fact, the link in ./src is broken.  there is no mod_python.so in
> ./src/.libs/
>
> # ls src/.libs
> libmod_python.a mod_python.la   mod_python.lai
>
> ???
>
> mt
>
> On Thu, 20 Mar 2003, David Higgs wrote:
>
> > I haven't got around to getting mod_python working on my setup yet, but
> > here's a heads-up...
> >
> > There's a good chance that OpenBSD3.2's apache2 is chrooted to
> > /var/www/, just like the default apache1.x.  You'll have to have a
> > separate python install within /var/www/ or disable the chroot.
> >
> > Can you paste the specific problems you're getting?  Maybe someone can
> > help you out.
> >
> > --david
> >
> > Mark Taylor wrote:
> > > I've been using OpenBSD3.2, apache2.0.43 and python2.2.1
> > >
> > > apxs is not building mod_python.so.  I've found similar plaints in the
> > > threads, but no solutions.
> >
>
> --
> Mark Taylor
>
> Real Networks
> Systems Administrator
> Developer Services Group - Technical Operations
>
> http://votetoimpeach.org/
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From mike.looijmans at asml.com  Fri Mar 21 07:35:40 2003
From: mike.looijmans at asml.com (Mike Looijmans)
Date: Fri Jan  9 21:53:25 2004
Subject: [mod_python] Success: PythonCGI (not the other way)
Message-ID: <01c2ef74$16f20600$926a1e6e@wsasd464>

Since not all our servers are Apache 2.0.xx yet, and mod_python isn't
available on those, I wanted to remain compatible with the CGI interface.

But sacrificing performance by using the cgihandler (which made the server
effectively single-threaded because of the stdout sharing) did not seem a good
idea.

Instead, I put it the other way around. The native connection mode is
mod_python, and I let the CGI handler simulate the Request interface. By not
using too big a subset, I managed to quite easily do this. The net effect is
that the mod_python script now run much faster than the cgihandler conversion
I used first, and the CGI still works at roughly the same speed (the impact on
performance by creating the Request object is neglegible. The main part of the
code is below.

Each module has a main() function, that takes some parameters. One can use
"main(req, form)" for example, or "main(req, db, auth, form)". The main must
write to req.write(..) just like a mod_python script would. The script does
not know whether it's run from CGI or mod_python.

Comments are welcome!

##
class Request:
    def __init__(self):
        environ = os.environ
        self.subprocess_env = environ
        self.content_type = "text/plain"
        self.status = 200
        self.args = environ.get('QUERY_STRING', '')
        self.path_info = environ.get('PATH_INFO', '')
        self.method  = environ['REQUEST_METHOD']
        self.unparsed_uri = environ['REQUEST_URI']
        self.uri = environ['SCRIPT_NAME']
        self.content_length = -1
        self._headed = 0
        self.headers_out = self
        self.headers = ""
        self.read = sys.stdin.read
        hin = {}
        v = environ.get('HTTP_REFERER', '')
        hin['Referer'] = v
        hin['referer'] = v
        if environ.has_key('HTTP_COOKIE'):
            v = environ['HTTP_COOKIE']
            hin['Cookie'] = v
            hin['cookie'] = v
        self.headers_in = hin
    def add(self, key, value):
        self.headers += '%s: %s\n' % (key, value)
    def set_content_length(self, len):
        self.content_length = len
    def _writeheaders(self):
        self._headed = 1
        sys.stdout.write('status: %s\n' % self.status)
        sys.stdout.write('Content-Type: %s\n' % self.content_type)
        if self.content_length >= 0:
            sys.stdout.write('Content-Length: %s\n' % self.content_length)
        sys.stdout.write(self.headers)
        sys.stdout.write('\n')
        self.write = sys.stdout.write
    def write(self, s):
        if not self._headed:
            self._writeheaders()
        sys.stdout.write(s)

try:
    req = Request()
    program = req.path_info
    if program[0] == '/':
        program = program[1:]
    if not program:
        raise ERedirect, 'ops_webrellist'
    try:
        module = __import__(program)
        try:
            main = module.main
        except AttributeError:
            raise ENoMain, path
        kwargs = {}
        kwargs['req'] = req
        expected = main.func_code.co_varnames[:main.func_code.co_argcount]
        db = None
        if 'form' in expected:
            import cgi
            form = cgi.FieldStorage()
            kwargs['form'] = form
            req.form = form
# Some more stuff about database connections left out #
        apply(module.main, (), kwargs)

    except ImportError:
        admin = os.environ['SERVER_ADMIN']
        print '''Status: 404 Not Found
Content-Type: text/html


--
Mike Looijmans
ASML: http://www5nl.asml.nl/~mlooijma
Private: http://www.milosoftware.com



From mike.looijmans at asml.com  Fri Mar 21 08:53:29 2003
From: mike.looijmans at asml.com (Mike Looijmans)
Date: Fri Jan  9 21:53:25 2004
Subject: [mod_python] Success: PythonCGI (not the other way)
Message-ID: <01c2ef7e$f5e2e280$926a1e6e@wsasd464>

No, i meant that the sysop hasn't updated the server yet (probably local
politics, no time, blah blah, ...)
Besides, I definitely don't want more than 2 flavours of servers out there.

--
Mike Looijmans

-----Original Message-----


>On Fri, Mar 21, 2003 at 07:35:40AM +0100, Mike Looijmans wrote:
>> Since not all our servers are Apache 2.0.xx yet, and mod_python isn't
>> available on those, I wanted to remain compatible with the CGI interface.
>
>Hmm? Are you saying that mod_python isn't available for apache < 2.0?
>Because it is. mod_python version 2.x is for apache 1.3.x, mod_python
>version 3.x is for apache 2.x (yeah, slightly confusing there).



From mike.looijmans at asml.com  Fri Mar 21 09:05:01 2003
From: mike.looijmans at asml.com (Mike Looijmans)
Date: Fri Jan  9 21:53:25 2004
Subject: [mod_python] MySQL DB connection sharing solution
Message-ID: <01c2ef80$9259b480$926a1e6e@wsasd464>

The trouble with most MySQL connection "sharing" methods is that they use the
same connection for multiple threads. This will not work when using scrolling
cursors, you can have only one of those open per connection. If you allow
users to run arbitrary queries, you don't want them to allocate 100 megabytes
of buffer space on the server when doing a "SELECT * FROM customer, orders"
(forgetting to join them...) so they are a must have.

Solution I came up with is to "give" a Connection object to each thread, and
when done, return it to the pool. If a connection is not in the pool, a new
one is made. With a bit of locking, you can have as many threads as you like,
and they won't interfere. The connections are stored in a dictionary, using
the usr, password, host and database as entry 'hash' (which I made a string
for easy debugging).
The entries are a list, when connecting the first object is taken from the
list, and appended again when the handler is done with it. It checks if the
connection is still valid when returning it (so a handler CAN do a db.close()
to dispose of a connection if that is neccesary).

### Connection sharing code ###

dblist = {}
_lock = threading.Lock()

def connectdb(req):
    environ = req.subprocess_env
    dbentry = '%s:%s@%s/%s' % (environ['DBUSER'],
                               environ['DBPWD'],
                               environ['DBHOST'],
                               environ['DBNAME'])
    req.dbentry = dbentry
    _lock.acquire()
    try:
        list = dblist.get(dbentry, [])
        if len(list):
            result = list[0]
            del list[0]
        else:
            import ops_sql
            dblist[dbentry] = list
            result = ops_sql.db_connect(environ)
    finally:
        _lock.release()
    return result

def donedb(req, db):
    if db and (not db._db.closed):
        _lock.acquire()
        try:
            dblist[req.dbentry].append(db)
        finally:
            _lock.release()

### In the handler(req) routine ###

           db = None
            if 'form' in expected:
                form = util.FieldStorage(req)
                kwargs['form'] = form
                req.form = form
            if 'db' in expected:
                db = connectdb(req)
                kwargs['db'] = db
            try:
                apply(module.main, (), kwargs)
            finally:
                donedb(req, db)



--
Mike Looijmans
ASML: http://www5nl.asml.nl/~mlooijma
Private: http://www.milosoftware.com



From laurie at tratt.net  Fri Mar 21 08:57:44 2003
From: laurie at tratt.net (Laurence Tratt)
Date: Fri Jan  9 21:53:25 2004
Subject: [mod_python] has anyone successfully built mod_python3.03 on OpenBSD?
In-Reply-To: <Pine.LNX.4.21.0303201358360.2164-100000@lothlorien.coreqa.prognet.com>; from mtaylor@real.com on Thu, Mar 20, 2003 at 02:07:42PM -0800
References: <Pine.LNX.4.21.0303201358360.2164-100000@lothlorien.coreqa.prognet.com>
Message-ID: <20030321085744.A32228@purcell.tratt.net>

On Thu, Mar 20, 2003 at 02:07:42PM -0800, Mark Taylor wrote:

> I've been using OpenBSD3.2, apache2.0.43 and python2.2.1
>
> apxs is not building mod_python.so.  I've found similar plaints in the
> threads, but no solutions.

I haven't had a chance to try this on the latest mod_python, but the problem
certainly used to be that Apache (2.0.33/2.0.44) ships with a version of
libtool which could charitably be described as brain dead. Install libtool
from ports, then overwrite Apache's version of libtool "cp
/usr/local/bin/libtool /usr/local/apache2/build" [or wherever your Apache 2
is].

I've been doing a fairly substantial amount of mod_python work under OpenBSD
and, once installed, it's as stable as a rock.

Best wishes,


Laurie

From jc at cowgar.com  Fri Mar 21 08:37:04 2003
From: jc at cowgar.com (Jeremy Cowgar)
Date: Fri Jan  9 21:53:25 2004
Subject: [mod_python] PythonImport - an example?
In-Reply-To: <01c2ef7e$f5e2e280$926a1e6e@wsasd464>
References: <01c2ef7e$f5e2e280$926a1e6e@wsasd464>
Message-ID: <200303210837.04952.jc@cowgar.com>

Can anyone give me an example of how the PythonImport directive/code works?

I may be mistaken, but what I want to use it for is to establish my initial db 
connections, load some classes, do some configuration, etc... Then in all my 
hander's, I should have access to that information, correct?

Thanks,

Jeremy

From grisha at modpython.org  Fri Mar 21 10:01:44 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:53:25 2004
Subject: [mod_python] has anyone successfully built mod_python3.03 on
 OpenBSD?
In-Reply-To: <20030321085744.A32228@purcell.tratt.net>
Message-ID: <20030321095949.I50466-100000@eden.ispol.com>


On Fri, 21 Mar 2003, Laurence Tratt wrote:

> certainly used to be that Apache (2.0.33/2.0.44) ships with a version of
> libtool which could charitably be described as brain dead. Install libtool
> from ports, then overwrite Apache's version of libtool "cp
> /usr/local/bin/libtool /usr/local/apache2/build" [or wherever your Apache 2
> is].

A better way is to run ./buildconf - this will copy the libtool from your
system into the Apache source tree and do some other important suff (like
rebuild the ./configure script).


Grisha


From laurie at tratt.net  Fri Mar 21 15:05:55 2003
From: laurie at tratt.net (Laurence Tratt)
Date: Fri Jan  9 21:53:25 2004
Subject: [mod_python] has anyone successfully built mod_python3.03 on OpenBSD?
In-Reply-To: <20030321095949.I50466-100000@eden.ispol.com>; from grisha@modpython.org on Fri, Mar 21, 2003 at 10:01:44AM -0500
References: <20030321085744.A32228@purcell.tratt.net> <20030321095949.I50466-100000@eden.ispol.com>
Message-ID: <20030321150555.H32228@purcell.tratt.net>

On Fri, Mar 21, 2003 at 10:01:44AM -0500, Gregory (Grisha) Trubetskoy wrote:

[Laurie]
>> certainly used to be that Apache (2.0.33/2.0.44) ships with a version of
>> libtool which could charitably be described as brain dead. Install
>> libtool from ports, then overwrite Apache's version of libtool "cp
>> /usr/local/bin/libtool /usr/local/apache2/build" [or wherever your Apache
>> 2 is].
> A better way is to run ./buildconf - this will copy the libtool from your
> system into the Apache source tree and do some other important suff (like
> rebuild the ./configure script).

ISTR that ./buildconf still picks up the Apache libtool (or, at least, it
does under OpenBSD), but would be happy to be corrected.

Best wishes,


Laurie

From grisha at modpython.org  Fri Mar 21 10:36:36 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:53:25 2004
Subject: [mod_python] PythonImport - an example?
In-Reply-To: <200303210837.04952.jc@cowgar.com>
Message-ID: <20030321100228.P50466-100000@eden.ispol.com>

Yes, but I would stay away from PythonImport unless you have no choice.

There's been some debate about this on the list before and it manly arises
from a misunderstanding of how things work. At first glance it seems like
a simple and obvious thing - initiate my db connections and load big data
dictionaries at server startup so that when those requests come in we're
ready to go.

But the problem is that Apache doesn't work this way. The context within
which a request runs comes into existence only after a request begins and
is a result of applying known server configuration directives (from config
and .htaccess files) to dynamic request parameters (e.g. host:  header
which dictates the virtual server to be used, and also the name of the
subinterpreter mod_python will use).

Consider also that there is no way to reliably predict ahead of time what
this request environment may look like since it is put together gradually
by handlers, which might be provided by any number of apache modules which
may choose to drastically change the request environment (e.g. rewrite a
bunch of headers). For example the virtual server and document root
information may not even be specified in the config file but is created
dynamically per-request if you're using something like mod_vhost.

But the server config file discussion during PythonImport is moot,
because, in fact, at the time when PythonImport executes (Apache child
initialization phase), Apache hasn't yet read the config file fully.

So you have to realize that PythonImport runs in this minimalistic bare
environment and needs a hint in the form of the subinterpreter name to be
useful, and sometimes getting it to work correctly can be a challenge, and
also keep in mind that using this directive isn't very portable because it
requires the interpreter name.

I personally favor not bothering with pre-initialization at all. The
downside is that the first hit to your side may take a little longer.
Another option that I've used quite successfully is to add a request to
some initialization url (using lynx or wget or whatever) into the server
start up script.

Grisha

On Fri, 21 Mar 2003, Jeremy Cowgar wrote:

> Can anyone give me an example of how the PythonImport directive/code works?
>
> I may be mistaken, but what I want to use it for is to establish my initial db
> connections, load some classes, do some configuration, etc... Then in all my
> hander's, I should have access to that information, correct?
>
> Thanks,
>
> Jeremy
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From vlindberg at verio.net  Fri Mar 21 18:01:10 2003
From: vlindberg at verio.net (VanL)
Date: Fri Jan  9 21:53:25 2004
Subject: [mod_python] Dynamic virtualhost configuration
Message-ID: <3E7BB5D6.5020706@verio.net>

Hello,

In a book about apache, I came across the following bit of code for 
mod_perl:

[embedded in httpd.conf]
# generate virtual hosts on the fly with Perl
<Perl>
#!/usr/bin perl -w

[snip some stuff]

# Open the virtual hosts file
open (FILE, "/usr/local/apache/conf/vhosts.conf");

while(<FILE>)
     # Create a virtual host based on this line
     ($ip,$host,$admin,$vroot,$aliases) = split /\s*,\s*, $_;
     $VirtualHost {$ip} = {

         [Create virtual host from variables]

[snip other stuff]

</Perl>
[continue httpd.conf]

Is it possible to do the same with mod_python?  I am in a situation 
where I have many subhosts, substantially similar.  Being able to define 
a shorthand for virtual hosts would be a big plus.

In a similar vein, the documentation talks about dynamically associating 
different handlers with a request.  Are these python handlers only, or 
could mod_python do a runtime check that associates mod_php with .php 
files in a specific virtualhost?

Thanks,

VanL


From vlindberg at verio.net  Fri Mar 21 18:18:06 2003
From: vlindberg at verio.net (VanL)
Date: Fri Jan  9 21:53:25 2004
Subject: [mod_python] Dynamic virtualhost configuration
In-Reply-To: <20030322010644.GO13870@netvista.mikebell.org>
References: <3E7BB5D6.5020706@verio.net> <20030322010644.GO13870@netvista.mikebell.org>
Message-ID: <3E7BB9CE.40204@verio.net>

Hello,

mod_vhost_alias would work for some of the accounts, but not others.
The essential problem is that certain services (like php execution, or 
ssi execution) are defined on a per-vhost basis.  From reading the 
documentation and a little experimentation, I'm not sure how to enable 
these services in some contexts, and not in others.  Note that I'm 
mostly talking about module-based services, not simple cgi executiona 
ability.  Thus VirtualScriptAlias wouldn't cut it, to my knowledge.

VanL

mike@mikebell.org wrote:

>On Fri, Mar 21, 2003 at 06:01:10PM -0700, VanL wrote:
>  
>
>>Is it possible to do the same with mod_python?  I am in a situation 
>>where I have many subhosts, substantially similar.  Being able to define 
>>a shorthand for virtual hosts would be a big plus.
>>    
>>
>
>What about mod_vhost_alias? That's what I use.
>
>  
>



From vlindberg at verio.net  Fri Mar 21 18:26:35 2003
From: vlindberg at verio.net (VanL)
Date: Fri Jan  9 21:53:25 2004
Subject: [mod_python] Dynamic virtualhost configuration
In-Reply-To: <20030322012527.GP13870@netvista.mikebell.org>
References: <3E7BB5D6.5020706@verio.net> <20030322010644.GO13870@netvista.mikebell.org> <3E7BB9CE.40204@verio.net> <20030322012527.GP13870@netvista.mikebell.org>
Message-ID: <3E7BBBCB.3090508@verio.net>

mike@mikebell.org wrote:

>Well, if you've got (say) three different setups, three IPs will do the
>job very nicely... If you don't have three IPs it's not so easy, but...
>

Thats right.  And if you only have one IP, then you start looking at a 
way to do it dynamically, so you don't tear your hair out. Hence my 
request...

VanL



From lientz at harvestsolutions.com  Fri Mar 21 18:06:26 2003
From: lientz at harvestsolutions.com (Andrew Lientz)
Date: Fri Jan  9 21:53:25 2004
Subject: [mod_python] cgihandler and redirects
Message-ID: <1048298792.9281.20.camel@hercules.harvestsolutions.com>

Hi,

We are going to slowly convert to mod_python for our application.  In
order to start the transitions I had to correct three things to allow
the cgihandler.py to make our application work properly.  

I edited apache.py to look for the Location header.  When it finds it it
sets the status. I had a problem with the status raised in cgihandler.py
being overridden.  I ended up getting the nicely formated OK pages out
of the web server.  I added the code below to the write function in the
CGIStdout class.

Here's the diff output of my changes:
714,715d713
<                     if h.lower() == "location":
<                         self.req.status = HTTP_MOVED_TEMPORARILY

This allows the code below to be read and redirected without the OK
page.

print "Location: http://blah\n"

and not need any special changes.


In cgihandler.py, I had to append the the current directory to
sys.path.  If it's a subdirectory of the main directory, the
subdirectory doesn't get passed.  This messes with import commands
within a script.  

Also, sys.exit(0) is an easy way to end a script.  It should be graceful
but it raises a SystemExit error.  I modified the code to deal with
this.

Here's the diff output of what I changed in cgihandler.py.

127d126
<             sys.path.append (dir)
134,141d132
<             # this executes the module
<             try:
<                 imp.load_module(module_name, fd, path, desc)
<             except SystemExit, e:
<                 if e == 0:
<                     pass
<                 else:
<                     raise SystemExit, e

I am posting this as an FYI and to see if there was something better I
could have done.  I couldn't find any references in the list archives,
so I hope this helps.

Regards,

Andy
-- 
Andrew Lientz
Harvest Solutions, Inc.
310-398-4761


From mateusz at ant.gliwice.pl  Mon Mar 24 13:23:34 2003
From: mateusz at ant.gliwice.pl (Mateusz Korniak)
Date: Fri Jan  9 21:53:25 2004
Subject: [mod_python] Using publisher handler to generate directory index - how to do it in right and easy way ?
Message-ID: <200303241323.34434.mateusz@ant.gliwice.pl>

Assume I have:
Defined for virtual host www.host.com  root direcotory <html_dir>/host/
I have <html_dir>/host/handler.py defined as Publisher Handler.

When user requestes 'www.host.com/handler/foo' it works well.

How to make handler.index(req) be handler of user requestes 'www.host.com' ?

TIA
-- 
Mateusz Korniak
easy.com  easy.go


From grisha at modpython.org  Mon Mar 24 10:51:22 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:53:25 2004
Subject: [mod_python] Using publisher handler to generate directory index
 - how to do it in right and easy way ?
In-Reply-To: <200303241323.34434.mateusz@ant.gliwice.pl>
Message-ID: <20030324105047.T95235-100000@eden.ispol.com>


On Mon, 24 Mar 2003, Mateusz Korniak wrote:

> When user requestes 'www.host.com/handler/foo' it works well.
>
> How to make handler.index(req) be handler of user requestes 'www.host.com' ?

You can use a DirectoryIndex directive to point to a mod_python script.

Grisha


From dorlov at banta-im.com  Wed Mar 26 11:32:41 2003
From: dorlov at banta-im.com (Dmitry Orlov)
Date: Fri Jan  9 21:53:25 2004
Subject: [mod_python] HTML filtering
Message-ID: <3E81D629.E27E83BE@banta-im.com>

I've started looking into switching some sites that use Python through
cgi to mod_python. The sites work via HTML filtering, sort of like PHP,
with bits of Python stuck inside HTML files. I tried to look for docs
that would show how I could set up such a scheme for mod_python, but
haven't found anything (yet).

Currently, we configure Apache using ScriptAlias and Action directives,
so that any request for a .html file within a certain Location gets
piped through the cgi which runs Python via an HTML filter.

The HTML filter coded in C/flex. It does variable substitution for
things like {$foo}, runs Python snippets between <?python and ?> tags a
la PHP, and a bunch of other nifty things, like form pre-population.

This scheme works quite well, and is fast if one uses fastcgi, but is a
bit complicated. I am hoping to simplify it using mod_python while
retaining the excellent performance.

I am thinking that the ideal drop-in replacement scheme would be to make
our HTML filter into a Python module, and call it via an output filter.
But how do I set it up so that mod_python runs for .html files instead
of .py files?

-Dmitry

From geertj at boskant.nl  Wed Mar 26 18:00:39 2003
From: geertj at boskant.nl (Geert Jansen)
Date: Fri Jan  9 21:53:25 2004
Subject: [mod_python] HTML filtering
In-Reply-To: <3E81D629.E27E83BE@banta-im.com>
References: <3E81D629.E27E83BE@banta-im.com>
Message-ID: <20030326170039.GA7644@vader.boskant.nl>

On Wed, Mar 26, 2003 at 11:32:41AM -0500, Dmitry Orlov wrote:
 
> I am thinking that the ideal drop-in replacement scheme would be to make
> our HTML filter into a Python module, and call it via an output filter.
> But how do I set it up so that mod_python runs for .html files instead
> of .py files?

(Set,Add)Handler python-program .html

Greetings,
Geert Jansen

From neel at mediapulse.com  Wed Mar 26 12:08:01 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:53:25 2004
Subject: [mod_python] HTML filtering
Message-ID: <C0FC22C08B82074A88B50061764157772C656A@johnson.mediapulse.net>

In httpd.conf, for the server add:

    <Files ~ "\.html$">
        SetHandler python-program
        PythonPath "sys.path+['/home/sites/mysite.com/modules']"
        PythonHandler www
        #PythonDebug On
    </Files>

With a www.py in the /home/sites/mysite.com/modules directory.  In
www.py you can put your request handler.

You might want to take a look at Albatross, it sounds very close to what
you are doing, http://www.object-craft.com.au/projects/albatross/

Mike

-----Original Message-----
From: Dmitry Orlov [mailto:dorlov@banta-im.com] 
Sent: Wednesday, March 26, 2003 11:33 AM
To: mod_python@modpython.org
Subject: [mod_python] HTML filtering


I've started looking into switching some sites that use Python through
cgi to mod_python. The sites work via HTML filtering, sort of like PHP,
with bits of Python stuck inside HTML files. I tried to look for docs
that would show how I could set up such a scheme for mod_python, but
haven't found anything (yet).

Currently, we configure Apache using ScriptAlias and Action directives,
so that any request for a .html file within a certain Location gets
piped through the cgi which runs Python via an HTML filter.

The HTML filter coded in C/flex. It does variable substitution for
things like {$foo}, runs Python snippets between <?python and ?> tags a
la PHP, and a bunch of other nifty things, like form pre-population.

This scheme works quite well, and is fast if one uses fastcgi, but is a
bit complicated. I am hoping to simplify it using mod_python while
retaining the excellent performance.

I am thinking that the ideal drop-in replacement scheme would be to make
our HTML filter into a Python module, and call it via an output filter.
But how do I set it up so that mod_python runs for .html files instead
of .py files?

-Dmitry
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python


From peter.bittner at gmx.net  Thu Mar 27 02:17:57 2003
From: peter.bittner at gmx.net (Peter Bittner)
Date: Fri Jan  9 21:53:25 2004
Subject: [mod_python] Using publisher handler to generate directory index - how to do it in right and easy way ?
References: <20030324105047.T95235-100000@eden.ispol.com>
Message-ID: <30920.1048727877@www56.gmx.net>

Hi there!

> On Mon, 24 Mar 2003, Mateusz Korniak wrote:
> 
> > When user requestes 'www.host.com/handler/foo' it works well.
> >
> > How to make handler.index(req) be handler of user requestes
> > 'www.host.com' ?

I have already tried to talk about this topic a while ago (maybe half a year
ago it was).

What I had proposed then, was to make the PublisherHandler handle a
'default' method, say func default(), which should be called automatically when a
request without a function name comes. In your examples this would be
'www.host.com/handler/' -- this would be handled like todays
'www.host.com/handler/default'.

This way one could make the web server handle, say, all 'index.py' files
like the defaults of a directory. (Comparable to the 'index.html' or whatever
someone sets to be called when no document is specified on access to HTML-files
on a web server.)

Having a PublisherHandler with a default function would then make it easy --
(look at the subject of Mateusz' message!) -- to create web projects in the
same simple manner as if there were only HTML-files:

 - An HTTP request to www.host.com would go to, say, www.host.com/index.py
(physically) and logically to www.host.com/index/default, respectively.
 - An HTTP request to www.host.com/mydir/ would in the same manner go to
www.host.com/mydir/index.py (physically) and logically to
www.host.com/mydir/index/default, respectively.

I think mod_python would only benefit from such a change to the
PublisherHandler's code. This would make mod_python (and thus Python itself) more
attractive to web designers and web programmers.

"Grisha" wrote:
> You can use a DirectoryIndex directive to point to a mod_python script.

Well, from my point of view this is only a workaround.
A general solution, however, might give Python the chance to become as
popular as PHP for web programming - after some time of course, not over night!

Please guys, note that this might be a change request that a lot of people
are waiting for, I think especially a lot of newbies to mod_python - newbies
that know other languages like PHP and (CGI-) Python beside others.

Peter

-- 
"Free software is like free speech, not free beer" (Richard Stallman)

+++ GMX - Mail, Messaging & more  http://www.gmx.net +++
Bitte l?cheln! Fotogalerie online mit GMX ohne eigene Homepage!


From dustin at ywlcs.org  Wed Mar 26 21:19:44 2003
From: dustin at ywlcs.org (Dustin Mitchell)
Date: Fri Jan  9 21:53:25 2004
Subject: [mod_python] Using publisher handler to generate directory index - how to do it in right and easy way ?
In-Reply-To: <30920.1048727877@www56.gmx.net>
References: <20030324105047.T95235-100000@eden.ispol.com> <30920.1048727877@www56.gmx.net>
Message-ID: <20030327031944.GP10000@eleanor.internal.ywlcs.org>

I agree this wouuld be a handy feature.  If it's likely to cause problems
(with backward compatibility, perhaps), then it could be selected with a
configuration directive (PythonOption PublisherDefault [off|<name>]), or even
exist as a separate publisher.

I'm sure we're all missing some good reason this is a bad idea.

Otherwise, I'd be willing to create a patch.

Dustin

-- 

  Dustin Mitchell
  dustin@ywlcs.org/djmitche@alumni.uchicago.edu
  http://people.cs.uchicago.edu/~dustin/

From grisha at modpython.org  Wed Mar 26 23:10:02 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:53:25 2004
Subject: [mod_python] Using publisher handler to generate directory index
 - how to do it in right and easy way ?
In-Reply-To: <20030327031944.GP10000@eleanor.internal.ywlcs.org>
Message-ID: <20030326230705.G36549-100000@eden.ispol.com>

Unless I'm missing something, the publisher already has a default
function, only it's "index" not "default":

http://www.modpython.org/live/current/doc-html/hand-pub-alg-trav.html

Grisha

On Wed, 26 Mar 2003, Dustin Mitchell wrote:

> I agree this wouuld be a handy feature.  If it's likely to cause problems
> (with backward compatibility, perhaps), then it could be selected with a
> configuration directive (PythonOption PublisherDefault [off|<name>]), or even
> exist as a separate publisher.
>
> I'm sure we're all missing some good reason this is a bad idea.
>
> Otherwise, I'd be willing to create a patch.
>
> Dustin
>
> --
>
>   Dustin Mitchell
>   dustin@ywlcs.org/djmitche@alumni.uchicago.edu
>   http://people.cs.uchicago.edu/~dustin/
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From stevena at neosynapse.net  Wed Mar 26 23:47:02 2003
From: stevena at neosynapse.net (Steven D. Arnold)
Date: Fri Jan  9 21:53:25 2004
Subject: [mod_python] environment variables not visible?
Message-ID: <BAA7EC76.1FC82%stevena@neosynapse.net>

Hello,

I am attempting to use mod_python 2.7.8 with spyce 1.3.6.  In my project, I
use a database module that connects with a Sybase database.  The module
expects certain environment variables to be set, which I set directly using
os.environ.  Nevertheless, the module doesn't seem to see the environment
variables; the errors are exactly as if the environment variables are not
present.

When I execute the same code from the python interpreter, it works fine.
Likewise when I run the pages from CGI rather than mod_python.  Thus, it
seems as if this may be a mod_python issue.  Any idea what may be going on?

Thanks,
steve
-- 



From grisha at modpython.org  Thu Mar 27 08:04:31 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:53:25 2004
Subject: [mod_python] environment variables not visible?
In-Reply-To: <BAA7EC76.1FC82%stevena@neosynapse.net>
Message-ID: <20030327080031.S42239-100000@eden.ispol.com>

I am guessing you are using the cgihandler. You can't see environment
variables from within the cgihandler-executed CGI scripts, it's mentioned
here:

http://www.modpython.org/live/current/doc-html/hand-cgi.html

Your options are to switch to using the publisher handler or write your
own handler.

Also, I may be wrong, but I think information that is gathered by the
sybase client from the environment can be passed to it by other means.

Grisha

On Wed, 26 Mar 2003, Steven D. Arnold wrote:

> Hello,
>
> I am attempting to use mod_python 2.7.8 with spyce 1.3.6.  In my project, I
> use a database module that connects with a Sybase database.  The module
> expects certain environment variables to be set, which I set directly using
> os.environ.  Nevertheless, the module doesn't seem to see the environment
> variables; the errors are exactly as if the environment variables are not
> present.
>
> When I execute the same code from the python interpreter, it works fine.
> Likewise when I run the pages from CGI rather than mod_python.  Thus, it
> seems as if this may be a mod_python issue.  Any idea what may be going on?
>
> Thanks,
> steve
> --
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From vlindberg at verio.net  Thu Mar 27 08:34:08 2003
From: vlindberg at verio.net (VanL)
Date: Fri Jan  9 21:53:25 2004
Subject: [mod_python] Using the socket module
Message-ID: <3E8319F0.2010306@verio.net>

Hello,

I am trying to connect to a Pyro Server from an app running within
mod_python, but it dies anytime it tries to initialize the socket
library.  Is this a known issue?   Are there any fixes or workarounds?

Thanks

VanL



From geertj at boskant.nl  Thu Mar 27 16:54:43 2003
From: geertj at boskant.nl (Geert Jansen)
Date: Fri Jan  9 21:53:25 2004
Subject: [mod_python] Python codecs bug
Message-ID: <20030327155443.GA23429@vader.boskant.nl>

Hi,

recently, a bug in the Python codecs subsystem has been discovered that
can affect mod_python programs. I have a confirmed report that this bug fixes
the vague "Cannot unmarshal code object in restricted execution mode" error
that was discussed on this list:

  http://mail.python.org/pipermail/python-list/2002-June/109233.html

The bug is described in detail here:

  http://sourceforge.net/tracker/index.php?func=detail&aid=663074&group_id=5470&atid=105470

The Python 2.3 CVS has been fixed. A backport of this fix to Python 2.2.2 is
available from my website at:

  http://draco.boskant.nl/requirements.dsp

the patch has been submitted to the Python crew.

I thought you'd might be interested...

Greetings,
Geert Jansen

From grisha at modpython.org  Thu Mar 27 11:01:27 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:53:25 2004
Subject: [mod_python] Using the socket module
In-Reply-To: <3E8319F0.2010306@verio.net>
Message-ID: <20030327105923.D44232-100000@eden.ispol.com>

It would help if you provided some specifics:

1. Code
2. Any error output (from apache error_log)
3. Versions of Python, mod_python, apache and your OS

Grisha

On Thu, 27 Mar 2003, VanL wrote:

> Hello,
>
> I am trying to connect to a Pyro Server from an app running within
> mod_python, but it dies anytime it tries to initialize the socket
> library.  Is this a known issue?   Are there any fixes or workarounds?
>
> Thanks
>
> VanL
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From stevena at neosynapse.net  Thu Mar 27 11:26:34 2003
From: stevena at neosynapse.net (Steven D. Arnold)
Date: Fri Jan  9 21:53:25 2004
Subject: [mod_python] environment variables not visible?
In-Reply-To: <20030327080031.S42239-100000@eden.ispol.com>
Message-ID: <BAA8906A.1FDDE%stevena@neosynapse.net>

On 3/27/03 8:04 AM, "Gregory (Grisha) Trubetskoy" <grisha@modpython.org>
wrote:

> I am guessing you are using the cgihandler. You can't see environment
> variables from within the cgihandler-executed CGI scripts, it's mentioned
> here:
> 
> http://www.modpython.org/live/current/doc-html/hand-cgi.html

I saw this post, but it doesn't seem I am using that.  Here's the section of
the config:

#AddHandler spyce-cgi-handler spy
#Action spyce-cgi-handler "/spyce-cgi/run_spyceCGI.py"
#ScriptAlias /spyce-cgi/ "/usr/share/spyce/cgi/"
<IfModule mod_python.c>
  AddHandler python-program .spy
  PythonHandler run_spyceModpy::spyceMain
  PythonPath 
"sys.path+[r'/usr/share/spyce/cgi','/server/unr/spyce_modules']"
  PythonOption SPYCE_CONFIG "/usr/share/spyce/spyce.conf"
  # !!! Do NOT turn on. !!!
  PythonOptimize Off
  SetEnv SYBASE /server/sybase/ASE_12501_2
  SetEnv LD_LIBRARY_PATH
/server/sybase/ASE_12501_2/OCS-12_5/lib:/usr/local/lib
  SetEnv SYBASE_OCS /server/sybase/ASE_12501_2/OCS-12_5
  SetEnv SYBASE_ASE /server/sybase/ASE_12501_2/ASE-12_5
</IfModule>
## Following Directives commented out for Mod_python testing
## 03/25/03
#<Location /spyce-cgi/>
#  <IfModule mod_fastcgi.c>
#    # If mod_fastcgi not installed, we get plain cgi
#    SetHandler fastcgi-script
#  </IfModule>
#</Location>
# If FastCGI is installed, it will be picked up
# automatically. On Linux, you can also omit this section
# and use a dynamic fcgi server instead.
#<IfModule mod_fastcgi.c>
#  FastCgiServer "/usr/share/spyce/cgi/run_spyceCGI.py" -port 7654
-initial-env F
#CGI_PORT=7654
#</IfModule>

Note the SetEnv directives are used in addition to setting the environment
with os.environ, but neither of these approaches work.  I am not familiar
enough with the internals of mod_python, but it seems perhaps
run_spyceModpy::spyceMain is the mon_python handler and perhaps it is
somehow forgetting the environment variables.  Does this seem like a likely
possibility to you?

Thanks,
steve
-- 



From vlindberg at verio.net  Thu Mar 27 11:25:58 2003
From: vlindberg at verio.net (VanL)
Date: Fri Jan  9 21:53:25 2004
Subject: [mod_python] Using the socket module
References: <20030327105923.D44232-100000@eden.ispol.com>
Message-ID: <3E834236.7030104@verio.net>

I'm sorry, I have worked it out.  The bug was not in mod_python -- Pyro 
was importing the Threading module in a couple of places without 
checking to see if the python installation supported multithreading.

Thanks,

VanL

Gregory (Grisha) Trubetskoy wrote:

>It would help if you provided some specifics:
>
>1. Code
>2. Any error output (from apache error_log)
>3. Versions of Python, mod_python, apache and your OS
>
>Grisha
>
>On Thu, 27 Mar 2003, VanL wrote:
>
>  
>
>>Hello,
>>
>>I am trying to connect to a Pyro Server from an app running within
>>mod_python, but it dies anytime it tries to initialize the socket
>>library.  Is this a known issue?   Are there any fixes or workarounds?
>>
>>Thanks
>>
>>VanL
>>
>>
>>_______________________________________________
>>Mod_python mailing list
>>Mod_python@modpython.org
>>http://www.modpython.org/mailman/listinfo/mod_python
>>
>>    
>>
>
>  
>




From jessamyn.smith at pason.com  Thu Mar 27 14:38:16 2003
From: jessamyn.smith at pason.com (Jessamyn Smith)
Date: Fri Jan  9 21:53:25 2004
Subject: [mod_python] Import site failed
Message-ID: <20030327143816.A935@ash.int.ca.pason.com>


We are in the process of upgrading our application to use mod_python.  I
have successfully configured and installed mod_python-2.7.8 on my
system, with Python 2.2.2 and MySQL-python-0.9.2.  However, when the
other developers follow my directions, they get the following error when
trying to run any Python CGI scripts:

'import site' failed; use -v for traceback
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
[Thu Mar 27 14:28:44 2003] [error] [client 127.0.0.1] python_handler:
make_obcallback returned no obCallBack!

Does anyone have any insight as to what could be different?  As far as
we know we are all running the same system (RedHat 7.3).  I am able to
wipe out my entire Python 2.2.2 directory and start the install from
scratch, and get a working version of mod_python, so I suspect the
problem is in the environment.

I tried looking through the archives, but the link for downloading the
entire mbox seems to be broken:
Not Found

The requested URL /pipermail/mod_python.mbox/mod_python.mbox was not
found on this server.

My patience for clicking monthly links to the archives wore out well
before I'd checked them all.

Jessamyn
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 232 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20030327/d532d963/attachment-0001.bin
From scott_list at mischko.com  Thu Mar 27 13:40:24 2003
From: scott_list at mischko.com (Scott Chapman)
Date: Fri Jan  9 21:53:26 2004
Subject: [mod_python] HTML filtering
In-Reply-To: <3E81D629.E27E83BE@banta-im.com>
References: <3E81D629.E27E83BE@banta-im.com>
Message-ID: <200303271340.24840.scott_list@mischko.com>

You might want to look at Spyce (http://spyce.sourceforge.net/) also.  It 
allows you to embed Python in HTML.

Scott


On Wednesday 26 March 2003 8:32 am, Dmitry Orlov wrote:
I've started looking into switching some sites that use Python through
cgi to mod_python. The sites work via HTML filtering, sort of like PHP,
with bits of Python stuck inside HTML files. I tried to look for docs
that would show how I could set up such a scheme for mod_python, but
haven't found anything (yet).

Currently, we configure Apache using ScriptAlias and Action directives,
so that any request for a .html file within a certain Location gets
piped through the cgi which runs Python via an HTML filter.

The HTML filter coded in C/flex. It does variable substitution for
things like {$foo}, runs Python snippets between <?python and ?> tags a
la PHP, and a bunch of other nifty things, like form pre-population.

This scheme works quite well, and is fast if one uses fastcgi, but is a
bit complicated. I am hoping to simplify it using mod_python while
retaining the excellent performance.

I am thinking that the ideal drop-in replacement scheme would be to make
our HTML filter into a Python module, and call it via an output filter.
But how do I set it up so that mod_python runs for .html files instead
of .py files?

-Dmitry
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python



From gnb at itga.com.au  Fri Mar 28 09:05:23 2003
From: gnb at itga.com.au (Gregory Bond)
Date: Fri Jan  9 21:53:26 2004
Subject: [mod_python] Import site failed 
In-Reply-To: Your message of Thu, 27 Mar 2003 14:38:16 -0700.
Message-ID: <200303272205.JAA14087@lightning.itga.com.au>

> [Thu Mar 27 14:28:44 2003] [error] [client 127.0.0.1] python_handler:
> make_obcallback returned no obCallBack!

Check the very first entry in the FAQ:
	http://www.modpython.org/FAQ/faqw.py?req=show&file=faq02.001.htp




From dorlov at banta-im.com  Thu Mar 27 17:25:27 2003
From: dorlov at banta-im.com (Dmitry Orlov)
Date: Fri Jan  9 21:53:26 2004
Subject: [mod_python] HTML filtering
References: <3E81D629.E27E83BE@banta-im.com> <200303271340.24840.scott_list@mischko.com>
Message-ID: <3E837A57.7D90AEB6@banta-im.com>

Hi Scott,

Thanks for the tip, but I've looked at all kinds of templating engines,
and they all pretty much do the same thing, albeit in a wide variety of
ways. The commonalities are:

1. you have to manually put in bits of code to change values of
attributes and query string variables, and

2. designers who use wysiwyg tools like Dreamweaver are at a loss if you
give them a marked-up HTML file to edit.

The idea behind ours is that lots of common-sense stuff just happens
automatically. For example, if there is an <input type="text"
name="foo"> and request.foo happens to be "bar", the engine spits out
<input type="text" name="foo" value="bar"> without being asked. Likewise
with <a href="something.com?foo"> - it gets rewritten to <a
href="something.com?foo=bar"> without the programmer having to do
anything.

We've been using this engine with good results for about 4 years now, on
lots of sites, like http://designjet.hp.com/. It's built into a couple
of our legacy frameworks, but should be relatively easy to reuse;
reasonably recent docs are available at
http://www.integratis.org/dfp.html.

I am leaning in the direction of making it into a GPL'ed Python module
that can be plugged into mod_python as an output filter. But I don't
know how much interest there would be. OSDN/Sourceforge/Freshmeat don't
seem effective as far as gauging interest.

That's why I am sort of spamming this list (just this once, I promise!)
If you think you might be interested in trying it out, or know of anyone
who might be, please let me know. If a bunch of people tell me "Yes,
I'll try it", then that's probably all the push I need to start coding.

-Dmitry

Scott Chapman wrote:
> 
> You might want to look at Spyce (http://spyce.sourceforge.net/) also.  It
> allows you to embed Python in HTML.
> 
> Scott
> 
> On Wednesday 26 March 2003 8:32 am, Dmitry Orlov wrote:
> I've started looking into switching some sites that use Python through
> cgi to mod_python. The sites work via HTML filtering, sort of like PHP,
> with bits of Python stuck inside HTML files. I tried to look for docs
> that would show how I could set up such a scheme for mod_python, but
> haven't found anything (yet).
> 
> Currently, we configure Apache using ScriptAlias and Action directives,
> so that any request for a .html file within a certain Location gets
> piped through the cgi which runs Python via an HTML filter.
> 
> The HTML filter coded in C/flex. It does variable substitution for
> things like {$foo}, runs Python snippets between <?python and ?> tags a
> la PHP, and a bunch of other nifty things, like form pre-population.
> 
> This scheme works quite well, and is fast if one uses fastcgi, but is a
> bit complicated. I am hoping to simplify it using mod_python while
> retaining the excellent performance.
> 
> I am thinking that the ideal drop-in replacement scheme would be to make
> our HTML filter into a Python module, and call it via an output filter.
> But how do I set it up so that mod_python runs for .html files instead
> of .py files?
> 
> -Dmitry
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

From gnb at itga.com.au  Fri Mar 28 10:09:42 2003
From: gnb at itga.com.au (Gregory Bond)
Date: Fri Jan  9 21:53:26 2004
Subject: [mod_python] HTML filtering 
In-Reply-To: Your message of Thu, 27 Mar 2003 17:25:27 -0500.
Message-ID: <200303272309.KAA18383@lightning.itga.com.au>

> The idea behind ours is that lots of common-sense stuff just happens
> automatically. For example, if there is an <input type="text"
> name="foo"> and request.foo happens to be "bar", the engine spits out
> <input type="text" name="foo" value="bar"> without being asked.

Albatross (http://www.object-craft.com.au/projects/albatross/) does this sort 
of thing very well, and supports CGI or mod_python with the same script (with 
a bit of trickery).  But it might be a bit hard to cut over existing products 
to use it.


From grisha at modpython.org  Thu Mar 27 18:14:01 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:53:26 2004
Subject: [mod_python] HTML filtering
In-Reply-To: <3E837A57.7D90AEB6@banta-im.com>
Message-ID: <20030327181158.I50327-100000@eden.ispol.com>


On Thu, 27 Mar 2003, Dmitry Orlov wrote:

> I am leaning in the direction of making it into a GPL'ed Python module
> that can be plugged into mod_python as an output filter.

It's be more in Python spirit if it was a BSD-style license rather than
GPL. :-)

Grisha


From scott_list at mischko.com  Thu Mar 27 15:14:16 2003
From: scott_list at mischko.com (Scott Chapman)
Date: Fri Jan  9 21:53:26 2004
Subject: [mod_python] HTML filtering
In-Reply-To: <3E837A57.7D90AEB6@banta-im.com>
References: <3E81D629.E27E83BE@banta-im.com> <200303271340.24840.scott_list@mischko.com> <3E837A57.7D90AEB6@banta-im.com>
Message-ID: <200303271514.16988.scott_list@mischko.com>

I am VERY interested in this.  If you can make a copy of it available to 
experiment with, I'd appreciate it.

My vote is "Yes" on GPL action here!

Scott

On Thursday 27 March 2003 2:25 pm, Dmitry Orlov wrote:
Hi Scott,

Thanks for the tip, but I've looked at all kinds of templating engines,
and they all pretty much do the same thing, albeit in a wide variety of
ways. The commonalities are:

1. you have to manually put in bits of code to change values of
attributes and query string variables, and

2. designers who use wysiwyg tools like Dreamweaver are at a loss if you
give them a marked-up HTML file to edit.

The idea behind ours is that lots of common-sense stuff just happens
automatically. For example, if there is an <input type="text"
name="foo"> and request.foo happens to be "bar", the engine spits out
<input type="text" name="foo" value="bar"> without being asked. Likewise
with <a href="something.com?foo"> - it gets rewritten to <a
href="something.com?foo=bar"> without the programmer having to do
anything.

We've been using this engine with good results for about 4 years now, on
lots of sites, like http://designjet.hp.com/. It's built into a couple
of our legacy frameworks, but should be relatively easy to reuse;
reasonably recent docs are available at
http://www.integratis.org/dfp.html.

I am leaning in the direction of making it into a GPL'ed Python module
that can be plugged into mod_python as an output filter. But I don't
know how much interest there would be. OSDN/Sourceforge/Freshmeat don't
seem effective as far as gauging interest.

That's why I am sort of spamming this list (just this once, I promise!)
If you think you might be interested in trying it out, or know of anyone
who might be, please let me know. If a bunch of people tell me "Yes,
I'll try it", then that's probably all the push I need to start coding.

-Dmitry

Scott Chapman wrote:
> You might want to look at Spyce (http://spyce.sourceforge.net/) also.  It
> allows you to embed Python in HTML.
>
> Scott
>
> On Wednesday 26 March 2003 8:32 am, Dmitry Orlov wrote:
> I've started looking into switching some sites that use Python through
> cgi to mod_python. The sites work via HTML filtering, sort of like PHP,
> with bits of Python stuck inside HTML files. I tried to look for docs
> that would show how I could set up such a scheme for mod_python, but
> haven't found anything (yet).
>
> Currently, we configure Apache using ScriptAlias and Action directives,
> so that any request for a .html file within a certain Location gets
> piped through the cgi which runs Python via an HTML filter.
>
> The HTML filter coded in C/flex. It does variable substitution for
> things like {$foo}, runs Python snippets between <?python and ?> tags a
> la PHP, and a bunch of other nifty things, like form pre-population.
>
> This scheme works quite well, and is fast if one uses fastcgi, but is a
> bit complicated. I am hoping to simplify it using mod_python while
> retaining the excellent performance.
>
> I am thinking that the ideal drop-in replacement scheme would be to make
> our HTML filter into a Python module, and call it via an output filter.
> But how do I set it up so that mod_python runs for .html files instead
> of .py files?
>
> -Dmitry
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python



From jessamyn.smith at pason.com  Fri Mar 28 07:56:42 2003
From: jessamyn.smith at pason.com (Jessamyn Smith)
Date: Fri Jan  9 21:53:26 2004
Subject: [mod_python] Import site failed
In-Reply-To: <D31B04F24EDE7644BB169BB4F080778A06C2396B@s30342g004005>; from Hans.Yandle@cingular.com on Fri, Mar 28, 2003 at 09:07:37AM -0500
References: <D31B04F24EDE7644BB169BB4F080778A06C2396B@s30342g004005>
Message-ID: <20030328075642.A25172@ash.int.ca.pason.com>


Thank you everyone for your help.  We managed to fix the problem by
adding a symbolic link:
ln -s /path/to/Python-2.2.2 /path/to/PythonHome

And editing the apache startup script (/etc/init.d/httpd), adding:
export PYTHONHOME='/hub/apps/PythonHome/'
in the start() function.

I felt pretty dumb for not checking the webpage for a FAQ.  We were
googling for "import site failed", when apparently we should have been
googling for "obcallback".  I am also still perplexed as to how my
machine is able to find mod_python, when I haven't done either of the
above steps.

Anyway, thanks again!

Jessamyn
-- 
Jessamyn Smith
Systems Analyst, DataHub Team
Ph: (403) 301-3470
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 232 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20030328/5bbc3796/attachment-0001.bin
From grisha at modpython.org  Fri Mar 28 17:38:48 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:53:26 2004
Subject: [mod_python] Why are you using mod_python?
In-Reply-To: <20030328075642.A25172@ash.int.ca.pason.com>
Message-ID: <20030328172826.X67038-100000@eden.ispol.com>

Hello everyone -

As the original author of mod_python I think I'm allowed to jerk people's
chains with this simple question:

Why are you using mod_python?

You can reply on or off list, either is fine. The results, after I get to
mull over them will be published in one way or another.

I've decided to ask the list because I recently realized that I am not
sure I know the answer. Not to say that I don't like mod_python, on the
contrary, I do, but to formulate in words exactly why is rather difficult.
Besides, my opinion is biased anyway :-)

Thanks in advance!

Grisha



From gdamjan at mail.net.mk  Sat Mar 29 03:55:34 2003
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 21:53:26 2004
Subject: [mod_python] environment variables not visible?
In-Reply-To: <BAA8906A.1FDDE%stevena@neosynapse.net>
References: <20030327080031.S42239-100000@eden.ispol.com> <BAA8906A.1FDDE%stevena@neosynapse.net>
Message-ID: <20030329025534.GB2171@legolas.on.net.mk>

>   SetEnv SYBASE /server/sybase/ASE_12501_2
>   SetEnv LD_LIBRARY_PATH
> /server/sybase/ASE_12501_2/OCS-12_5/lib:/usr/local/lib
>   SetEnv SYBASE_OCS /server/sybase/ASE_12501_2/OCS-12_5
>   SetEnv SYBASE_ASE /server/sybase/ASE_12501_2/ASE-12_5
> 
> Note the SetEnv directives are used in addition to setting the environment
> with os.environ, but neither of these approaches work.  I am not familiar
> enough with the internals of mod_python, but it seems perhaps
> run_spyceModpy::spyceMain is the mon_python handler and perhaps it is
> somehow forgetting the environment variables.  Does this seem like a likely
> possibility to you?

I had a similar problem with Apache, PHP and ORACLE. I tried the SetEnv
approach too...

The catch is that SetEnv just sets some Apache-specific internal
environment - that has nothing to do with the UNIX/OS environment.

I've also tried to solve the problem by putting putenv("ORACLE_HOME=...") 
in the PHP code. And with that sometimes it worked and sometimes it
didn't. 

Last I've found that I must set the environment prior to starting the 
apache process. I've ended up with:

    env - ORACLE_HOME=/usr/share/oracle \
           /usr/sbin/apachectl start

in my "/etc/rc.d/rc.httpd" script, and a note to everyone never to call 
"apachectl" directly but to always call "/etc/rc.d/rc.httpd".

In the end the conclusion is that these proprietary products SUCK, it so
much simpler with MySQL or PostgreSQL.



-- 
Damjan Georgievski

From frank at fejes.net  Fri Mar 28 23:14:12 2003
From: frank at fejes.net (Frank S. Fejes III)
Date: Fri Jan  9 21:53:26 2004
Subject: [mod_python] Why are you using mod_python?
In-Reply-To: <20030328172826.X67038-100000@eden.ispol.com>
References: <20030328075642.A25172@ash.int.ca.pason.com>
	<20030328172826.X67038-100000@eden.ispol.com>
Message-ID: <20030328231412.24efac21.frank@fejes.net>

Nobody has responded yet...I've been curious myself.  Personally, my primary
goal in using it (and other mod_* language modules) is to improve the
performance/scalability of my CGI applications.  Unfortunately, I really
dislike the Publisher handler's way of doing things (the
programname.py/method URL syntax feels silly to me) and it seems like most
people are very down on the capabilities and stability of the CGI handler so
I find myself just going plain CGI anyway for many things now when I use
python.

Not to start religious wars, but I find myself using and enjoying mod_ruby
the most of all the web development "environments".  It's simple to use for
the basics while maintaining a very neat and clear way of manipulating
requests and performing advanced tasks.  As an added bonus, eruby (inline
ruby ala asp/php) is nicely integrated.

On a somewhat tangential note, I think mod_python documentation reflects
strangely on what target audience might be interested in the module.  Almost
all introductions I've seen to mod_python begin with a tutorial on creating
a handler.  I'd venture a guess that writing handlers is what fewer than 1%
of web developers want to do with an apache module initially.  In my
experience, most people want to write some code and have it run faster than
it would run under straight CGI...they don't want to write custom handlers.

It's late and I'm tired so take everything I say with a grain of salt! :)

--frank

On Fri, 28 Mar 2003 17:38:48 -0500 (EST)
"Gregory (Grisha) Trubetskoy" <grisha@modpython.org> wrote:

> 
> Hello everyone -
> 
> As the original author of mod_python I think I'm allowed to jerk people's
> chains with this simple question:
> 
> Why are you using mod_python?
> 
> You can reply on or off list, either is fine. The results, after I get to
> mull over them will be published in one way or another.
> 
> I've decided to ask the list because I recently realized that I am not
> sure I know the answer. Not to say that I don't like mod_python, on the
> contrary, I do, but to formulate in words exactly why is rather difficult.
> Besides, my opinion is biased anyway :-)
> 
> Thanks in advance!
> 
> Grisha
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 

From pascalbarbedor at free.fr  Sat Mar 29 08:27:57 2003
From: pascalbarbedor at free.fr (pascal barbedor)
Date: Fri Jan  9 21:53:26 2004
Subject: Fw: [mod_python] Why are you using mod_python?
Message-ID: <002501c2f5c4$b8d35d10$118a933e@allalswqm99ewu>

----- Original Message -----
From: "pascal barbedor" <pascalbarbedor@free.fr>
To: "Gregory (Grisha) Trubetskoy" <grisha@modpython.org>
Sent: Saturday, March 29, 2003 8:03 AM
Subject: Re: [mod_python] Why are you using mod_python?


> Hi
>
>
> I am using it because it is simple and the documentation is clear and
> simple.
> Its only a little more effort compared to plain cgi and it is faster.
>
> also I use it bare bone, I don't use the publisher and I don't use any
> template system on top of mod_python.
> (I am not fond of template systems, I think req.write is enough)
> I find it modular and convenient to add one handler by directory and I
> usually rely on a directoryindex index.py
> to be able to call the handler simply with /myweb  without anything else,
> which is mapped to myweb/index.py by apache.
> this way I never call a .py file explicitely.
> each index.py is a dispatcher to other .py files in the same dir
> I also have a common directory with site wide classes and functions. and
> that's it.
>
> I use it on win32
> before python I was using perl/mod_perl but its not working very good on
> win32 yet for apache 2, at least I had core dumps related to libxml and so
I
> moved to python/mod_python, and stopped using libxslt or any xlst
transform
> , and now use only sax transform. its clearer than big xls stylesheets.
>
> I find that the documentation could contain more usage examples but is
good
> anyway.
> also the developing process is made uncomparabely better through the debug
> directive which outputs on the browser and the automatic reload of modules
>
> so that I don't see the difference compared to cgi developement, and I see
a
> difference in that I have the satisfaction to use a close to apache API
and
> it's fun.
>
> I must say when I tried the authentication exxample in the doc, I could
not
> make it work.
>
> but still the feeling is that it works very well, development is very
> confortable, and I am glad I tried it.
>
>
> thanks
> pascal
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
> ----- Original Message -----
> From: "Gregory (Grisha) Trubetskoy" <grisha@modpython.org>
> To: <mod_python@modpython.org>
> Sent: Friday, March 28, 2003 11:38 PM
> Subject: [mod_python] Why are you using mod_python?
>
>
> >
> > Hello everyone -
> >
> > As the original author of mod_python I think I'm allowed to jerk
people's
> > chains with this simple question:
> >
> > Why are you using mod_python?
> >
> > You can reply on or off list, either is fine. The results, after I get
to
> > mull over them will be published in one way or another.
> >
> > I've decided to ask the list because I recently realized that I am not
> > sure I know the answer. Not to say that I don't like mod_python, on the
> > contrary, I do, but to formulate in words exactly why is rather
difficult.
> > Besides, my opinion is biased anyway :-)
> >
> > Thanks in advance!
> >
> > Grisha
> >
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://www.modpython.org/mailman/listinfo/mod_python
> >
>


From stevehamilton at blueyonder.co.uk  Sat Mar 29 12:12:42 2003
From: stevehamilton at blueyonder.co.uk (Stephen Hamilton)
Date: Fri Jan  9 21:53:26 2004
Subject: [mod_python] Import Error (windows)
Message-ID: <000801c2f5ec$7fe2c450$0100a8c0@willem>

Python 2.2
Apache 2.0.44
mod_python-3.0.3.win32.exe

new to mod_python and list so be gentle with me

searched through the list and found similar probs but on different
platforms and versions
but no answers (probably me not looking hard enough)

anyway following tutorial and set httpd.conf as said :-

LoadModule python_module modules/mod_python.so

<Directory "C:\Program Files\Apache Group\Apache2\htdocs\test"> 
  AddHandler python-program .py
  PythonHandler mptest.py 
  PythonDebug On 
</Directory>
 
error reads:-
Mod_python error: "PythonHandler mptest.py"
Traceback (most recent call last):
  File "C:\Python22\Lib\site-packages\mod_python\apache.py", line 320, in HandlerDispatch
    module = import_module(module_name, config)
  File "C:\Python22\Lib\site-packages\mod_python\apache.py", line 496, in import_module
    f, p, d = imp.find_module(parts[i], path)

ImportError: No module named py

it's probably a simple answer but can anyone help
thanks in advance
stephen
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20030329/d7038de0/attachment-0001.htm
From pascalbarbedor at free.fr  Sat Mar 29 14:44:32 2003
From: pascalbarbedor at free.fr (pascal barbedor)
Date: Fri Jan  9 21:53:26 2004
Subject: [mod_python] Import Error (windows)
References: <000801c2f5ec$7fe2c450$0100a8c0@willem>
Message-ID: <000b01c2f5f9$54c28050$a8a1933e@allalswqm99ewu>

hi

maybe spaces in path is bad idea, plus forward slashes required

pascal
  ----- Original Message ----- 
  From: Stephen Hamilton 
  To: mod_python@modpython.org 
  Sent: Saturday, March 29, 2003 1:12 PM
  Subject: [mod_python] Import Error (windows)


  Python 2.2
  Apache 2.0.44
  mod_python-3.0.3.win32.exe

  new to mod_python and list so be gentle with me

  searched through the list and found similar probs but on different
  platforms and versions
  but no answers (probably me not looking hard enough)

  anyway following tutorial and set httpd.conf as said :-

  LoadModule python_module modules/mod_python.so

  <Directory "C:\Program Files\Apache Group\Apache2\htdocs\test"> 
    AddHandler python-program .py
    PythonHandler mptest.py 
    PythonDebug On 
  </Directory>
   
  error reads:-
  Mod_python error: "PythonHandler mptest.py"
  Traceback (most recent call last):
    File "C:\Python22\Lib\site-packages\mod_python\apache.py", line 320, in HandlerDispatch
      module = import_module(module_name, config)
    File "C:\Python22\Lib\site-packages\mod_python\apache.py", line 496, in import_module
      f, p, d = imp.find_module(parts[i], path)

  ImportError: No module named py

  it's probably a simple answer but can anyone help
  thanks in advance
  stephen
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20030329/6ec25c38/attachment-0001.htm
From dustin at ywlcs.org  Sat Mar 29 10:04:06 2003
From: dustin at ywlcs.org (Dustin Mitchell)
Date: Fri Jan  9 21:53:26 2004
Subject: [mod_python] Why are you using mod_python?
In-Reply-To: <20030328172826.X67038-100000@eden.ispol.com>
References: <20030328075642.A25172@ash.int.ca.pason.com> <20030328172826.X67038-100000@eden.ispol.com>
Message-ID: <20030329160405.GJ10000@eleanor.internal.ywlcs.org>

I use mod_python because it turns the web server into one very large
event-driven Python program.  I can do whatever I want with requests.  I can
parse URLs however I'd like.  I can construct the response however I'd like.
I have complete control over the transaction, without any hacks or other
impediments.

One of the advantages of having the web server act like a very large Python
program is its speed.  Also, from this frame of mind, caching and
preflighting are almost intuitive (if you've ever done SMP programming before
:-)

Dustin

-- 

  Dustin Mitchell
  dustin@ywlcs.org/djmitche@alumni.uchicago.edu
  http://people.cs.uchicago.edu/~dustin/

From neo at https.ru  Sat Mar 29 22:58:26 2003
From: neo at https.ru (Neo Eureka)
Date: Fri Jan  9 21:53:26 2004
Subject: [mod_python] Import Error (windows)
In-Reply-To: <000801c2f5ec$7fe2c450$0100a8c0@willem>
References: <000801c2f5ec$7fe2c450$0100a8c0@willem>
Message-ID: <245039446.20030329225826@https.ru>

 You should not add ".py" extension.
The correct line is:

 PythonHandler mptest


> Python 2.2
> Apache 2.0.44
> mod_python-3.0.3.win32.exe

> new to mod_python and list so be gentle with me

> searched through the list and found similar probs but on different
> platforms and versions
> but no answers (probably me not looking hard enough)

> anyway following tutorial and set httpd.conf as said :-

> LoadModule python_module modules/mod_python.so

> <Directory "C:\Program Files\Apache Group\Apache2\htdocs\test"> 
>   AddHandler python-program .py
>   PythonHandler mptest.py 
>   PythonDebug On 
> </Directory>
 
> error reads:-
> Mod_python error: "PythonHandler mptest.py"
> Traceback (most recent call last):
>   File "C:\Python22\Lib\site-packages\mod_python\apache.py", line 320, in HandlerDispatch
>     module = import_module(module_name, config)
>   File "C:\Python22\Lib\site-packages\mod_python\apache.py", line 496, in import_module
>     f, p, d = imp.find_module(parts[i], path)

> ImportError: No module named py

> it's probably a simple answer but can anyone help
> thanks in advance
> stephen


--- 
Neo Eureka / mailto:neo@https.ru


From stevehamilton at blueyonder.co.uk  Sat Mar 29 20:20:57 2003
From: stevehamilton at blueyonder.co.uk (Stephen Hamilton)
Date: Fri Jan  9 21:53:26 2004
Subject: [mod_python] re Import Error (windows)
Message-ID: <002d01c2f630$b54709f0$0100a8c0@willem>

update for other wooden heads like me 
without the ".py" it works a treat
thanks for the swift response and your patients
stephen   (8(|) doe


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20030329/e7ab7378/attachment-0001.htm
From ian at veryfresh.com  Sat Mar 29 16:46:45 2003
From: ian at veryfresh.com (Ian Clelland)
Date: Fri Jan  9 21:53:26 2004
Subject: [mod_python] Why are you using mod_python?
In-Reply-To: <20030328231412.24efac21.frank@fejes.net>
References: <20030328075642.A25172@ash.int.ca.pason.com> <20030328172826.X67038-100000@eden.ispol.com> <20030328231412.24efac21.frank@fejes.net>
Message-ID: <20030330004644.GA17569@fullfactor.com>

On Fri, Mar 28, 2003 at 11:14:12PM -0600, Frank S. Fejes III wrote:
> On Fri, 28 Mar 2003 17:38:48 -0500 (EST)
> "Gregory (Grisha) Trubetskoy" <grisha@modpython.org> wrote:
> 
> > 
> > Hello everyone -
> > 
> > As the original author of mod_python I think I'm allowed to jerk people's
> > chains with this simple question:
> > 
> > Why are you using mod_python?

...

> On a somewhat tangential note, I think mod_python documentation reflects
> strangely on what target audience might be interested in the module.  Almost
> all introductions I've seen to mod_python begin with a tutorial on creating
> a handler.  I'd venture a guess that writing handlers is what fewer than 1%
> of web developers want to do with an apache module initially.  In my
> experience, most people want to write some code and have it run faster than
> it would run under straight CGI...they don't want to write custom handlers.

Well, I suppose I must be counted among that 1% :) I switched to
mod_python from PHP and Servlets about <checks CVS> 8 or 9 months ago,
and it was primarily because of the flexibility and power of cutsom
handlers. I love the fact that I can write applications whose URLs have
some meaning besides simply naming a file on the web server's hard
drive.

When I was first introduced to mod_python, I imagined it to be simply a
way to embed python code inline into HTML files (like PHP or JSP,) and I
nearly dismissed it out of hand. I looked at it more carefully, though,
and when I realised that it was more akin to mod_perl, and would
actually give me an opportunity to interact so closely with Apache, I
became much more excited working with it.

Since then, I have adopted many of the tenets of the REST philosophy,
and I have found mod_python to be an ideal platform to develop REST-ful
applications. I doubt I could even go back to the CGI or PHP ways of
doing things now.


But then, that might just be me :)


Ian Clelland
<ian@veryfresh.com>

From peter.bittner at gmx.net  Sun Mar 30 22:55:55 2003
From: peter.bittner at gmx.net (Peter Bittner)
Date: Fri Jan  9 21:53:26 2004
Subject: [mod_python] Why are you using mod_python?
Message-ID: <18707.1049057755@www41.gmx.net>

Hi there!

I like mod_python because I like Python and I am glad whenever I can use it
to write web applications. Customers, however, in most cases ask me to go for
PHP or so since this is easier to find programmers for for maintenance
afterwards.

> Personally, my primary goal in using it (and other mod_* language
> modules) is to improve the performance/scalability of my CGI applications.

This is true for me, too.

> Unfortunately, I really dislike the Publisher handler's way of doing
things
> (the programname.py/method URL syntax feels silly to me) and it seems
> like most people are very down on the capabilities and stability of the
> CGI handler so I find myself just going plain CGI anyway for many things
> now when I use python.

This is absolutely true for myself, too. Clearly, I would appreciate
mod_python to have nothing but advantages, but it does have those unconfortable
features.

> Almost all introductions I've seen to mod_python begin with a
> tutorial on creating a handler.  I'd venture a guess that writing
> handlers is what fewer than 1% of web developers want to do
> with an apache module initially.  In my experience, most people
> want to write some code and have it run faster than it would run
> under straight CGI...they don't want to write custom handlers.

I absolutely agree. This is my opinion, too.

I also do not see why modifying the webserver's (Apache's) configuration
should be advantagous when I, say, add a new directory to my web project. When I
want to write, say, a website, I do not want to go into /etc/apache.conf (I
might not even have access to it!), but I want to go straight into coding.
And porting this code to another webserver should not be a nightmare, but a job
of copying the .py files, that's it.

I like Python and I'd be happy to see mod_python becoming as popular for web
programming as PHP is today.

Cheers, Peter

-- 
Peter Bittner
mail: peter.bittner@gmx.net

"Free software is like free speech, not free beer" (Richard Stallman)

+++ GMX - Mail, Messaging & more  http://www.gmx.net +++
Bitte l?cheln! Fotogalerie online mit GMX ohne eigene Homepage!


From mike.looijmans at asml.com  Mon Mar 31 07:35:36 2003
From: mike.looijmans at asml.com (Mike Looijmans)
Date: Fri Jan  9 21:53:26 2004
Subject: [mod_python] Why are you using mod_python?
Message-ID: <01c2f747$5aecc400$926a1e6e@wsasd464>

Simple: There were a few dozen clients when we started this project. There
will be about 400 when we roll it out worldwide, and I didn't want the server
to spend too much time loading the interpreter for each call.
With CGI, it could process about 2 requests per second. With mod_python, that
increased to over 20 per second.

Keeping database connections alive and some internal caching were nice things
to add (I like a bit of multithreaded programming), but did not add any
measurable performance gains (I guess the Python-MySQL link is just too fast
when all is local).

Our system is now hybrid - servers can either use CGI or mod_python (bot if
they like). But I did not use cgihandler because it also took quite a
performance hit because of reloading a lot of libraries, and after a few dozen
requests the cgi library would lose the os.environ and a restart of the server
would be neccesary to get things going again. Also, cgihandler does not
combine well with Apache's "worker" thread model, cgihandler turns the whole
system into a single-threaded server in that particular case.

--
Mike Looijmans
ASML: http://www5nl.asml.nl/~mlooijma
Private: http://www.milosoftware.com

-----Original Message-----
From: Gregory (Grisha) Trubetskoy <grisha@modpython.org>
To: mod_python@modpython.org <mod_python@modpython.org>
Date: Saturday, March 29, 2003 12:42 AM
Subject: [mod_python] Why are you using mod_python?


>
>Hello everyone -
>
>As the original author of mod_python I think I'm allowed to jerk people's
>chains with this simple question:
>
>Why are you using mod_python?
>



From sandor.kopanyi at mailbox.hu  Mon Mar 31 08:57:35 2003
From: sandor.kopanyi at mailbox.hu (sandor.kopanyi@mailbox.hu)
Date: Fri Jan  9 21:53:26 2004
Subject: [mod_python] Re: Why are you using mod_python?
In-Reply-To: <20030329170001.80558.66529.Mailman@eden.ispol.com>
Message-ID: <20030331065735.16655.qmail@arnold.mailbox.hu>

Hi,

I'm using mod_python because of:
- simplicity
- elegance of Python
- rich Python libs
- quick development

/Sandor
PS. I don't have anything against publisher, I use it regurarly, beside
the other ways


_______________________________________________________________________
http://mailbox.hu - WAP-on is olvashatod




From mike at mikesclutter.com  Sat Mar  1 11:07:23 2003
From: mike at mikesclutter.com (Michael Owens)
Date: Fri Jan  9 21:59:55 2004
Subject: [mod_python] Problem with C extension type
Message-ID: <200303011107.23400.mike@mikesclutter.com>

This is a rather intricate problem, but I don't know where else to go. I have 
a C extension in which I created a native Python type, call it X, which has 
two methods: A() and B(). Then I create a Python class, derived from X type, 
called Y, which has has two methods C() and D(). Y is defined as follows 
(cmod is my C extension in which X is implemented)

from cmod import X

class Y(X):
  
    def __new__(cls, db):
        return super(Y, cls).__new__(cls)

    def C():
	print "C()"

    def D():
	print "D()"

If I call Y.A() from a normal python script, there is no problem --- it 
resolved to X.A(). But if I do this inside of mod_python, I get an error 
saying that object Y has no such attribute A. I don't understand why 
mod_python would be any different in attribute resolution than Python would 
be since it is using the same Python implementation/library. I am using 
Python 2.2.2 and mod_python 3.0.1 in Apache 2.x.

Any ideas?

Michael Owens.

From jermnsar at hotmail.com  Sat Mar  1 20:04:23 2003
From: jermnsar at hotmail.com (Jeremy Lowery)
Date: Fri Jan  9 21:59:55 2004
Subject: [mod_python] Full Path Info on Request object
Message-ID: <F138mnSA3oZs7pKy2uh0001dc06@hotmail.com>

Hello,

I'm writing my own publisher, and I don't understand why mod_python doesn't 
include the full pathname in the req.filename attribute.

In my .htaccess

SetHandler python-program
# My Custom Publisher in this directory
PythonHandler ServletPublisher
PythonDebug On

I make a request:
http://localhost/~jermnsar/foo/bar/test/hmm?dat=val&val2=dat2

and printing out the variables:

req.uri /~jermnsar/foo/bar/test/hmm
req.filename C:/Documents and Settings/jermnsar/My Documents/My Website/foo


What would be an easy way to resolve to
C:/Documents and Settings/jermnsar/My Documents/My Website/foo/bar/test/hmm

or at least easily extract the /bar/test/hmm

Would be easy to do with some string manip I suppose, but I'm looking for 
faster (i.e. quicker CPU wise) way.

Why does the translation from the web path to the physical path only include 
the first element?

Windows XPsp1/Apache 2.0.44/mod_python 3.0.1

Thanks
Jeremy S Lowery






_________________________________________________________________
MSN 8 helps eliminate e-mail viruses. Get 2 months FREE*.  
http://join.msn.com/?page=features/virus


From mike at mikesclutter.com  Mon Mar  3 17:26:37 2003
From: mike at mikesclutter.com (Michael Owens)
Date: Fri Jan  9 21:59:55 2004
Subject: [mod_python] Problem with C extension type
In-Reply-To: <200303011107.23400.mike@mikesclutter.com>
References: <200303011107.23400.mike@mikesclutter.com>
Message-ID: <200303031726.37382.mike@mikesclutter.com>

As a matter of interest, I found what was wrong (sort of). My C type's (X's) 
tp_getattro implementation was screwy. When I replaced it with 
PyObject_GenericGetAttr, everything worked fine in mod_python. I still don't 
know why the original implementation worked in Python and not in mod_python, 
but I don't care so long as it works now.

On Saturday 01 March 2003 11:07 am, Michael Owens wrote:
> This is a rather intricate problem, but I don't know where else to go. I
> have a C extension in which I created a native Python type, call it X,
> which has two methods: A() and B(). Then I create a Python class, derived
> from X type, called Y, which has has two methods C() and D(). Y is defined
> as follows (cmod is my C extension in which X is implemented)
>
> from cmod import X
>
> class Y(X):
>
>     def __new__(cls, db):
>         return super(Y, cls).__new__(cls)
>
>     def C():
> 	print "C()"
>
>     def D():
> 	print "D()"
>
> If I call Y.A() from a normal python script, there is no problem --- it
> resolved to X.A(). But if I do this inside of mod_python, I get an error
> saying that object Y has no such attribute A. I don't understand why
> mod_python would be any different in attribute resolution than Python would
> be since it is using the same Python implementation/library. I am using
> Python 2.2.2 and mod_python 3.0.1 in Apache 2.x.
>
> Any ideas?
>
> Michael Owens.
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

From mark at camazotz.com  Wed Mar  5 23:19:09 2003
From: mark at camazotz.com (Mark Smith)
Date: Fri Jan  9 21:59:55 2004
Subject: [mod_python] mod_python 3.0, Apache 2.0, OS X 10.2
Message-ID: <C6F0BB52-4F8A-11D7-ABDE-00039364CE50@camazotz.com>

Has anyone succeeded in building mod_python 3 on Apache 2 under OS X?  
Last time it was discussed was November last year:

http://www.modpython.org/pipermail/mod_python/2002-November/002652.html

thanks,
Mark


From grisha at modpython.org  Thu Mar  6 00:35:26 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:55 2004
Subject: [mod_python] mod_python 3.0, Apache 2.0, OS X 10.2
In-Reply-To: <C6F0BB52-4F8A-11D7-ABDE-00039364CE50@camazotz.com>
Message-ID: <20030306003346.D12356-100000@eden.ispol.com>

It builds and runs just fine undex OS X, you should have at least mp 3.0.1
and better yet the latest sources from CVS, and make sure to check out the
README, it has some OS X instructions in it.

Grisha

On Wed, 5 Mar 2003, Mark Smith wrote:

> Has anyone succeeded in building mod_python 3 on Apache 2 under OS X?
> Last time it was discussed was November last year:
>
> http://www.modpython.org/pipermail/mod_python/2002-November/002652.html
>
> thanks,
> Mark
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From pascalbarbedor at free.fr  Fri Mar  7 00:19:59 2003
From: pascalbarbedor at free.fr (pascal barbedor)
Date: Fri Jan  9 21:59:55 2004
Subject: [mod_python] req.user stays None in authen
Message-ID: <002101c2e436$e8c50c70$908b933e@allalswqm99ewu>

Hi on win 32 with python 2.2.2, installed last version 3.01, added missing mscvrt70.dll
and everything works great!


I wanted to try out the doc tutorial 
<Directory /mywebdir>
AddHandler python-program .py
PythonHandler myscript
PythonAuthenHandler myscript
PythonDebug On
AuthType Basic
AuthName "Restricted Area"
require valid-user
</Directory>

with script

from mod_python import apache
def authenhandler(req):
user = req.user
pw = req.get_basic_auth_pw()
if user == "spam" and pw == "eggs":
return apache.OK
else:
return apache.HTTP_UNAUTHORIZED

it works but req.user is always None
I printed user, pw to apache log and got None eggs
ie password is well passed, but not user
so the authentication results in neverending pop up login window

I checked from mozilla and opera browser


thanks for any help








-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20030307/9852e6fb/attachment-0002.htm
From pmguerre at ualg.pt  Mon Mar 10 20:30:34 2003
From: pmguerre at ualg.pt (Pedro Guerreiro)
Date: Fri Jan  9 21:59:55 2004
Subject: [mod_python] Installing mod_python 3.0.1 in Windows
Message-ID: <20030310202756.F238C4BE80@smtp.ualg.pt>

Hi.

Why was the instructions on how to install mod_python in windows removed from 
the 3.0 documentation? AFAIK in the previous release there was instructions 
on how to do this...

Also, why isn't _anywhere_ (AFAICT) a reference that you _also_ need the Unix 
source (from mod_python-x.tgz) to install it in Windows? From 
http://httpd.apache.org/modules/python-download.cgi one gets the ideia that 
to install it in Windows only the python2.2.2-apache2.0.43.zip is needed?

And finally, why isn't documented that one need msvcr70.dll (not everyone has 
Microsoft Visual _whatever_ installed) to run mod_python?

To resume, please make some documentation on how to install the new 
mod_python on the windows platform, so that someone does go away because 
he/she cannot put mod_python to work... Or at least put up some link to 
http://www.modpython.org/pipermail/mod_python/2002-December/002714.html, and 
to http://www.modpython.org/live/mod_python-2.7.8/doc-html/app-wininst.html

Thanks, and keep up the good work.

	-pmg

From sury.ondrej at globe.cz  Tue Mar 11 11:32:21 2003
From: sury.ondrej at globe.cz (Ondrej Sury)
Date: Fri Jan  9 21:59:55 2004
Subject: [mod_python] session management in mod_python
Message-ID: <87bs0ib3d6.fsf@globe.cz>

Since I still haven't found what I am looking for ;-) (no, I have found
search page for mailing list archive), I just want to ask if there is some
module which is solving /subj. (something like php has) ie. setting session
cookie, loading session variables etc.

O.

-- 
Ondrej Sury - CIO                   Globe Internet s.r.o. http://globe.cz/
Tel: +420(2)35365000 Fax: +420(2)35365009     Planickova 1, 162 00 Praha 6

From lyager at phunkbros.dk  Tue Mar 11 12:18:05 2003
From: lyager at phunkbros.dk (Jesper L. Nielsen)
Date: Fri Jan  9 21:59:55 2004
Subject: [mod_python] session management in mod_python
In-Reply-To: <87bs0ib3d6.fsf@globe.cz>
References: <87bs0ib3d6.fsf@globe.cz>
Message-ID: <20030311111805.GA2976@home.phunkbros.dk>

* Ondrej Sury (sury.ondrej@globe.cz) [2003-03-11 11:03]:
> Since I still haven't found what I am looking for ;-) (no, I have found
> search page for mailing list archive), I just want to ask if there is some
> module which is solving /subj. (something like php has) ie. setting session
> cookie, loading session variables etc.

Personally I'm pretty happy with PyWebLib
(http://www.stroeder.com/pylib/PyWebLib/), which is very customize-able 
:) .  I'm sure, though, that there are many other possibilities.

--
Jesper L. Nielsen
http://phunkbros.dk

From cjackson at spsu.edu  Tue Mar 11 16:10:03 2003
From: cjackson at spsu.edu (Chris Jackson)
Date: Fri Jan  9 21:59:55 2004
Subject: [mod_python] prototype 3.0.3
Message-ID: <000201c2e812$9572f6b0$5f05010a@moxie>

+1
 
moxie
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20030311/456a779e/attachment-0002.htm
From grisha at modpython.org  Wed Mar 12 10:18:38 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:55 2004
Subject: [mod_python] prototype 3.0.3
In-Reply-To: <000201c2e812$9572f6b0$5f05010a@moxie>
Message-ID: <20030312101758.F18937-100000@eden.ispol.com>

Thanks

I've been kinda swamped lately, but I'll try to put it out there today or
tomorrow.

Grisha

On Tue, 11 Mar 2003, Chris Jackson wrote:

> +1
>
> moxie
>


From neel at mediapulse.com  Wed Mar 12 10:57:25 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:59:55 2004
Subject: [mod_python] Fixup hander not always being called
Message-ID: <C0FC22C08B82074A88B50061764157775C0C@johnson.mediapulse.net>

I have some mod perl code I'm trying to move over to modpython.  The
perl code adds a cookie header to all requests using the fixup phase,
and then logs some info in the logging phase.  When I setup python to do
the same, the fixup handler is not always called.  It looks like it is
related to cgi scripts, as when I hit a cgi page in the web browser, my
fixup handler is not called - but it will call the perl version.

My conf has:

    <Location />
        #SetHandler python-program
        PythonLogHandler qlog
        PythonFixupHandler qlog
        PythonDebug On
    </Location>

I've commented out the SetHandler because that would break cgi scripts
(causing the text of the script to be sent to the browser, instead of
executing it).  This is the same with mod_perl, you can't use the
SetHandler.

qlog.py (simplified):

from mod_python import apache

def fixuphandler(req):

    apache.log_error("----------- New Hit -----------")
    apache.log_error("CT: " + str(req.content_type))

def loghandler(req):

    apache.log_error("----------- Log Hit -----------")


Any insights?  I'd like to do the new version of this code in python,
and not perl, but I gotta get this cgi snafu solved.

Thanks,
Mike


From neel at mediapulse.com  Wed Mar 12 13:34:23 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:59:55 2004
Subject: [mod_python] Fixup hander not always being called
Message-ID: <C0FC22C08B82074A88B50061764157772C654C@johnson.mediapulse.net>

Sctratch the below.  It looks like the function apache.log_error()
doesn't always work, so my method of testing the handler was flawed.  I
used Sam Spade to watch headers, and my cookies are being added, even
though the calls to the error_log are not printing.

Also, I left off I'm using 2.7.8 on Apache 1.3.26

Thanks,
Mike

-----Original Message-----
From: Michael C. Neel 
Sent: Wednesday, March 12, 2003 10:57 AM
To: mod_python@modpython.org
Subject: [mod_python] Fixup hander not always being called


I have some mod perl code I'm trying to move over to modpython.  The
perl code adds a cookie header to all requests using the fixup phase,
and then logs some info in the logging phase.  When I setup python to do
the same, the fixup handler is not always called.  It looks like it is
related to cgi scripts, as when I hit a cgi page in the web browser, my
fixup handler is not called - but it will call the perl version.

My conf has:

    <Location />
        #SetHandler python-program
        PythonLogHandler qlog
        PythonFixupHandler qlog
        PythonDebug On
    </Location>

I've commented out the SetHandler because that would break cgi scripts
(causing the text of the script to be sent to the browser, instead of
executing it).  This is the same with mod_perl, you can't use the
SetHandler.

qlog.py (simplified):

from mod_python import apache

def fixuphandler(req):

    apache.log_error("----------- New Hit -----------")
    apache.log_error("CT: " + str(req.content_type))

def loghandler(req):

    apache.log_error("----------- Log Hit -----------")


Any insights?  I'd like to do the new version of this code in python,
and not perl, but I gotta get this cgi snafu solved.

Thanks,
Mike

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python


From grisha at apache.org  Mon Mar 17 10:49:27 2003
From: grisha at apache.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:55 2004
Subject: [mod_python] ANNOUNCE: Mod_python 3.0.3
In-Reply-To: <20021127135855.Q36516-100000@eden.ispol.com>
Message-ID: <20030317103105.X92188-100000@eden.ispol.com>

The Apache Software Foundation and The Apache HTTP Server Project are
pleased to announce the release of mod_python 3.0.3.

Mod_python is an Apache HTTP Server module that embeds the Python
interpreter within the server. With mod_python you can write web-based
applications in Python that will run many times faster than traditional
CGI and will have access to advanced features such as ability to retain
database connections between requests, access to httpd internals and
provide content filter as well as connection handlers.

This release fixes numerous bugs identified after last release (3.0.1). It
is highly recommended that you upgrade to version 3.0.3 for improved
stability and performance.

Mod_python is available for download from:

http://httpd.apache.org/modules/python-download.cgi

For more information about mod_python visit:

http://www.modpython.org/

Regards,

Grisha Trubetskoy


From mike.looijmans at asml.com  Tue Mar 18 08:07:14 2003
From: mike.looijmans at asml.com (Mike Looijmans)
Date: Fri Jan  9 21:59:55 2004
Subject: [mod_python] ANNOUNCE: Mod_python 3.0.3
Message-ID: <01c2ed1d$009e3d00$926a1e6e@wsasd464>

Hmm. Had some troubles running this baby after the ./configure - smake - smake
install dance. Turned out to be a file permission problem.
The following occured in the apache error log:

[Tue Mar 18 07:56:33 2003] [notice] Apache/2.0.44 (Unix) mod_python/3.0.3
Python/2.2.2 configured -- resuming normal operations
[Tue Mar 18 07:56:35 2003] [error] make_obcallback: could not import
mod_python.apache.

ImportError: No module named apache
[Tue Mar 18 07:57:01 2003] [error] make_obcallback: could not import
mod_python.apache.


The problem was that in /usr/local/lib/python2.2/site-package/mod_pyton, all
files were root-only (pun intented) after installation (mode 600). Would be
nice if the install script forced to 644 mode instead. The apache server runs
as user "nobody" so didn't get access.

--
Mike Looijmans
ASML: http://www5nl.asml.nl/~mlooijma
Private: http://www.milosoftware.com

-----Original Message-----
From: Gregory (Grisha) Trubetskoy <grisha@apache.org>


>
>The Apache Software Foundation and The Apache HTTP Server Project are
>pleased to announce the release of mod_python 3.0.3.



From graeme_matthew at hotmail.com  Tue Mar 18 23:05:21 2003
From: graeme_matthew at hotmail.com (Graeme Matthew)
Date: Fri Jan  9 21:59:55 2004
Subject: [mod_python] Cant get modPython working
Message-ID: <BAY1-F12ATiyhGvDpED000327a4@hotmail.com>

Hi all, im pulling out my 7pm brown hair that is now almost grey !!!!!

I have followed the instructions to get mod_python working on Win32 (XP)

I have edited my conf file as follows:

LoadModule python_module modules/mod_python.so

#added handler directives in scriptalias
<Directory "C:/Program Files/Apache Group/Apache2/cgi-bin">
    AllowOverride None
    Options None
    Order allow,deny
    Allow from all
    AddHandler python-program .py
    PythonHandler mptest
    PythonDebug On
</Directory>

I have placed mptest.py in my cgi-bin folder it contains the following:


from mod_python import apache

def handler(req):
    req.write("Content-type: text/html\n\nHello World!")
    return apache.OK

I keep on getting a HTTP 500 Internal Server Error and cant understand why 
as the log file does not seem to contain the error.

Any help would be much appreciated

Thanks


Graeme

_________________________________________________________________
MSN Instant Messenger now available on Australian mobile phones. Go to  
http://ninemsn.com.au/mobilecentral/hotmail_messenger.asp


From graeme_matthew at hotmail.com  Wed Mar 19 00:07:44 2003
From: graeme_matthew at hotmail.com (Graeme Matthew)
Date: Fri Jan  9 21:59:55 2004
Subject: [mod_python] ModPython working, but multiple handlers ?
Message-ID: <BAY1-F66Hy3SpwBGpEI00000f34@hotmail.com>

Hi all, finally got it working, so please ignore my previous request ...

my last issue before bead is adding multiple handlers

if I do the following:

PythonHandler mptest
PythonHandler app

then my app also prints out mptest within the webpage

If anyone has experienced this then i would like to hear how you solved it, 
as soon as I take mptest out, the problem is removed

Regards


Graeme




_________________________________________________________________
Hotmail now available on Australian mobile phones. Go to  
http://ninemsn.com.au/mobilecentral/hotmail_mobile.asp


From grisha at modpython.org  Tue Mar 18 11:16:15 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:55 2004
Subject: [mod_python] ModPython working, but multiple handlers ?
In-Reply-To: <BAY1-F66Hy3SpwBGpEI00000f34@hotmail.com>
Message-ID: <20030318111340.Q7557-100000@eden.ispol.com>

There can only be one PythonHandler and subsequent directives will
override previous, so the net effect of your config below is
"PythonHandler app".

If I understand what you're trying to do, you should look at the manual
and read about the Publisher handler in the tutorial.

Grisha

On Wed, 19 Mar 2003, Graeme Matthew wrote:

>
> Hi all, finally got it working, so please ignore my previous request ...
>
> my last issue before bead is adding multiple handlers
>
> if I do the following:
>
> PythonHandler mptest
> PythonHandler app
>
> then my app also prints out mptest within the webpage
>
> If anyone has experienced this then i would like to hear how you solved it,
> as soon as I take mptest out, the problem is removed
>
> Regards
>
>
> Graeme
>
>
>
>
> _________________________________________________________________
> Hotmail now available on Australian mobile phones. Go to
> http://ninemsn.com.au/mobilecentral/hotmail_mobile.asp
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From mtaylor at real.com  Thu Mar 20 14:07:42 2003
From: mtaylor at real.com (Mark Taylor)
Date: Fri Jan  9 21:59:56 2004
Subject: [mod_python] has anyone successfully built mod_python3.03 on OpenBSD?
Message-ID: <Pine.LNX.4.21.0303201358360.2164-100000@lothlorien.coreqa.prognet.com>

I've been using OpenBSD3.2, apache2.0.43 and python2.2.1

apxs is not building mod_python.so.  I've found similar plaints in the
threads, but no solutions.

-- 
Mark Taylor

Real Networks
Systems Administrator
Developer Services Group - Technical Operations

http://votetoimpeach.org/


From drh9296 at ritvax.rit.edu  Thu Mar 20 18:29:21 2003
From: drh9296 at ritvax.rit.edu (David Higgs)
Date: Fri Jan  9 21:59:56 2004
Subject: [mod_python] has anyone successfully built mod_python3.03 on
 OpenBSD?
References: 
 <Pine.LNX.4.21.0303201358360.2164-100000@lothlorien.coreqa.prognet.com>
Message-ID: <3E7A4ED1.9000909@rit.edu>

I haven't got around to getting mod_python working on my setup yet, but 
here's a heads-up...

There's a good chance that OpenBSD3.2's apache2 is chrooted to 
/var/www/, just like the default apache1.x.  You'll have to have a 
separate python install within /var/www/ or disable the chroot.

Can you paste the specific problems you're getting?  Maybe someone can 
help you out.

--david

Mark Taylor wrote:
> I've been using OpenBSD3.2, apache2.0.43 and python2.2.1
> 
> apxs is not building mod_python.so.  I've found similar plaints in the
> threads, but no solutions.


From mtaylor at real.com  Thu Mar 20 17:03:56 2003
From: mtaylor at real.com (Mark Taylor)
Date: Fri Jan  9 21:59:56 2004
Subject: [mod_python] has anyone successfully built mod_python3.03 on
 OpenBSD?
In-Reply-To: <3E7A4ED1.9000909@rit.edu>
Message-ID: <Pine.LNX.4.21.0303201653020.2164-100000@lothlorien.coreqa.prognet.com>

./configure --with-apxs=<location of apxs>  goes normally, without error.
running 'make' then goes normally until the end, when we get this output:

*** Warning: inter-library dependencies are not known to be supported.
*** All declared inter-library dependencies are being dropped.

*** Warning: libtool could not satisfy all declared inter-library
*** dependencies of module libmod_python.  Therefore, libtool will create
*** a static module, that should work as long as the dlopening
*** application is linked with the -dlopen flag.

Now su and make install
  (or, if you only want to perform a partial install,
   you can use make install_dso and make install_py_lib)

Source distribution found

...

# make install

Compiling for DSO.

...

Performing DSO installation.

/usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
install: src/mod_python.so: No such file or directory
*** Error code 71

Stop in /tmp/mod_python-3.0.3 (line 94 of Makefile).
*** Error code 1

Stop in /tmp/mod_python-3.0.3 (line 91 of Makefile).


AND, in fact, the link in ./src is broken.  there is no mod_python.so in
./src/.libs/ 

# ls src/.libs
libmod_python.a mod_python.la   mod_python.lai

???

mt

On Thu, 20 Mar 2003, David Higgs wrote:

> I haven't got around to getting mod_python working on my setup yet, but 
> here's a heads-up...
> 
> There's a good chance that OpenBSD3.2's apache2 is chrooted to 
> /var/www/, just like the default apache1.x.  You'll have to have a 
> separate python install within /var/www/ or disable the chroot.
> 
> Can you paste the specific problems you're getting?  Maybe someone can 
> help you out.
> 
> --david
> 
> Mark Taylor wrote:
> > I've been using OpenBSD3.2, apache2.0.43 and python2.2.1
> > 
> > apxs is not building mod_python.so.  I've found similar plaints in the
> > threads, but no solutions.
> 

-- 
Mark Taylor

Real Networks
Systems Administrator
Developer Services Group - Technical Operations

http://votetoimpeach.org/


From grisha at modpython.org  Thu Mar 20 23:46:47 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:56 2004
Subject: [mod_python] has anyone successfully built mod_python3.03 on
 OpenBSD?
In-Reply-To: <Pine.LNX.4.21.0303201653020.2164-100000@lothlorien.coreqa.prognet.com>
Message-ID: <20030320233453.O44142-100000@eden.ispol.com>

I am OpenBSD ignorant, but on FreeBSD it builds without a hinch (it also
builds on Darwin which has its own different set of complications).

This message usually means libtool is complaining that it won't build an
.so out of static libraries.

On all other OS's I've seen it this was resolvable by upgrading to latest
libtool where this restriction has been lifted.

Another solution is to build pythonlib as an .so - Python does not
directly support this, but it has been reported to work fine if done
manually with something like (YMMV):

mkdir .extract
cd .extract
ar xv ../libpython2.2.a
cd ..
gcc -shared -o libpython2.2.so.0 .extract/*.o
rm -rf .extract

Grisha

On Thu, 20 Mar 2003, Mark Taylor wrote:

>
> ./configure --with-apxs=<location of apxs>  goes normally, without error.
> running 'make' then goes normally until the end, when we get this output:
>
> *** Warning: inter-library dependencies are not known to be supported.
> *** All declared inter-library dependencies are being dropped.
>
> *** Warning: libtool could not satisfy all declared inter-library
> *** dependencies of module libmod_python.  Therefore, libtool will create
> *** a static module, that should work as long as the dlopening
> *** application is linked with the -dlopen flag.
>
> Now su and make install
>   (or, if you only want to perform a partial install,
>    you can use make install_dso and make install_py_lib)
>
> Source distribution found
>
> ...
>
> # make install
>
> Compiling for DSO.
>
> ...
>
> Performing DSO installation.
>
> /usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
> install: src/mod_python.so: No such file or directory
> *** Error code 71
>
> Stop in /tmp/mod_python-3.0.3 (line 94 of Makefile).
> *** Error code 1
>
> Stop in /tmp/mod_python-3.0.3 (line 91 of Makefile).
>
>
> AND, in fact, the link in ./src is broken.  there is no mod_python.so in
> ./src/.libs/
>
> # ls src/.libs
> libmod_python.a mod_python.la   mod_python.lai
>
> ???
>
> mt
>
> On Thu, 20 Mar 2003, David Higgs wrote:
>
> > I haven't got around to getting mod_python working on my setup yet, but
> > here's a heads-up...
> >
> > There's a good chance that OpenBSD3.2's apache2 is chrooted to
> > /var/www/, just like the default apache1.x.  You'll have to have a
> > separate python install within /var/www/ or disable the chroot.
> >
> > Can you paste the specific problems you're getting?  Maybe someone can
> > help you out.
> >
> > --david
> >
> > Mark Taylor wrote:
> > > I've been using OpenBSD3.2, apache2.0.43 and python2.2.1
> > >
> > > apxs is not building mod_python.so.  I've found similar plaints in the
> > > threads, but no solutions.
> >
>
> --
> Mark Taylor
>
> Real Networks
> Systems Administrator
> Developer Services Group - Technical Operations
>
> http://votetoimpeach.org/
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From mike.looijmans at asml.com  Fri Mar 21 07:35:40 2003
From: mike.looijmans at asml.com (Mike Looijmans)
Date: Fri Jan  9 21:59:56 2004
Subject: [mod_python] Success: PythonCGI (not the other way)
Message-ID: <01c2ef74$16f20600$926a1e6e@wsasd464>

Since not all our servers are Apache 2.0.xx yet, and mod_python isn't
available on those, I wanted to remain compatible with the CGI interface.

But sacrificing performance by using the cgihandler (which made the server
effectively single-threaded because of the stdout sharing) did not seem a good
idea.

Instead, I put it the other way around. The native connection mode is
mod_python, and I let the CGI handler simulate the Request interface. By not
using too big a subset, I managed to quite easily do this. The net effect is
that the mod_python script now run much faster than the cgihandler conversion
I used first, and the CGI still works at roughly the same speed (the impact on
performance by creating the Request object is neglegible. The main part of the
code is below.

Each module has a main() function, that takes some parameters. One can use
"main(req, form)" for example, or "main(req, db, auth, form)". The main must
write to req.write(..) just like a mod_python script would. The script does
not know whether it's run from CGI or mod_python.

Comments are welcome!

##
class Request:
    def __init__(self):
        environ = os.environ
        self.subprocess_env = environ
        self.content_type = "text/plain"
        self.status = 200
        self.args = environ.get('QUERY_STRING', '')
        self.path_info = environ.get('PATH_INFO', '')
        self.method  = environ['REQUEST_METHOD']
        self.unparsed_uri = environ['REQUEST_URI']
        self.uri = environ['SCRIPT_NAME']
        self.content_length = -1
        self._headed = 0
        self.headers_out = self
        self.headers = ""
        self.read = sys.stdin.read
        hin = {}
        v = environ.get('HTTP_REFERER', '')
        hin['Referer'] = v
        hin['referer'] = v
        if environ.has_key('HTTP_COOKIE'):
            v = environ['HTTP_COOKIE']
            hin['Cookie'] = v
            hin['cookie'] = v
        self.headers_in = hin
    def add(self, key, value):
        self.headers += '%s: %s\n' % (key, value)
    def set_content_length(self, len):
        self.content_length = len
    def _writeheaders(self):
        self._headed = 1
        sys.stdout.write('status: %s\n' % self.status)
        sys.stdout.write('Content-Type: %s\n' % self.content_type)
        if self.content_length >= 0:
            sys.stdout.write('Content-Length: %s\n' % self.content_length)
        sys.stdout.write(self.headers)
        sys.stdout.write('\n')
        self.write = sys.stdout.write
    def write(self, s):
        if not self._headed:
            self._writeheaders()
        sys.stdout.write(s)

try:
    req = Request()
    program = req.path_info
    if program[0] == '/':
        program = program[1:]
    if not program:
        raise ERedirect, 'ops_webrellist'
    try:
        module = __import__(program)
        try:
            main = module.main
        except AttributeError:
            raise ENoMain, path
        kwargs = {}
        kwargs['req'] = req
        expected = main.func_code.co_varnames[:main.func_code.co_argcount]
        db = None
        if 'form' in expected:
            import cgi
            form = cgi.FieldStorage()
            kwargs['form'] = form
            req.form = form
# Some more stuff about database connections left out #
        apply(module.main, (), kwargs)

    except ImportError:
        admin = os.environ['SERVER_ADMIN']
        print '''Status: 404 Not Found
Content-Type: text/html


--
Mike Looijmans
ASML: http://www5nl.asml.nl/~mlooijma
Private: http://www.milosoftware.com



From mike.looijmans at asml.com  Fri Mar 21 08:53:29 2003
From: mike.looijmans at asml.com (Mike Looijmans)
Date: Fri Jan  9 21:59:56 2004
Subject: [mod_python] Success: PythonCGI (not the other way)
Message-ID: <01c2ef7e$f5e2e280$926a1e6e@wsasd464>

No, i meant that the sysop hasn't updated the server yet (probably local
politics, no time, blah blah, ...)
Besides, I definitely don't want more than 2 flavours of servers out there.

--
Mike Looijmans

-----Original Message-----


>On Fri, Mar 21, 2003 at 07:35:40AM +0100, Mike Looijmans wrote:
>> Since not all our servers are Apache 2.0.xx yet, and mod_python isn't
>> available on those, I wanted to remain compatible with the CGI interface.
>
>Hmm? Are you saying that mod_python isn't available for apache < 2.0?
>Because it is. mod_python version 2.x is for apache 1.3.x, mod_python
>version 3.x is for apache 2.x (yeah, slightly confusing there).



From mike.looijmans at asml.com  Fri Mar 21 09:05:01 2003
From: mike.looijmans at asml.com (Mike Looijmans)
Date: Fri Jan  9 21:59:56 2004
Subject: [mod_python] MySQL DB connection sharing solution
Message-ID: <01c2ef80$9259b480$926a1e6e@wsasd464>

The trouble with most MySQL connection "sharing" methods is that they use the
same connection for multiple threads. This will not work when using scrolling
cursors, you can have only one of those open per connection. If you allow
users to run arbitrary queries, you don't want them to allocate 100 megabytes
of buffer space on the server when doing a "SELECT * FROM customer, orders"
(forgetting to join them...) so they are a must have.

Solution I came up with is to "give" a Connection object to each thread, and
when done, return it to the pool. If a connection is not in the pool, a new
one is made. With a bit of locking, you can have as many threads as you like,
and they won't interfere. The connections are stored in a dictionary, using
the usr, password, host and database as entry 'hash' (which I made a string
for easy debugging).
The entries are a list, when connecting the first object is taken from the
list, and appended again when the handler is done with it. It checks if the
connection is still valid when returning it (so a handler CAN do a db.close()
to dispose of a connection if that is neccesary).

### Connection sharing code ###

dblist = {}
_lock = threading.Lock()

def connectdb(req):
    environ = req.subprocess_env
    dbentry = '%s:%s@%s/%s' % (environ['DBUSER'],
                               environ['DBPWD'],
                               environ['DBHOST'],
                               environ['DBNAME'])
    req.dbentry = dbentry
    _lock.acquire()
    try:
        list = dblist.get(dbentry, [])
        if len(list):
            result = list[0]
            del list[0]
        else:
            import ops_sql
            dblist[dbentry] = list
            result = ops_sql.db_connect(environ)
    finally:
        _lock.release()
    return result

def donedb(req, db):
    if db and (not db._db.closed):
        _lock.acquire()
        try:
            dblist[req.dbentry].append(db)
        finally:
            _lock.release()

### In the handler(req) routine ###

           db = None
            if 'form' in expected:
                form = util.FieldStorage(req)
                kwargs['form'] = form
                req.form = form
            if 'db' in expected:
                db = connectdb(req)
                kwargs['db'] = db
            try:
                apply(module.main, (), kwargs)
            finally:
                donedb(req, db)



--
Mike Looijmans
ASML: http://www5nl.asml.nl/~mlooijma
Private: http://www.milosoftware.com



From laurie at tratt.net  Fri Mar 21 08:57:44 2003
From: laurie at tratt.net (Laurence Tratt)
Date: Fri Jan  9 21:59:56 2004
Subject: [mod_python] has anyone successfully built mod_python3.03 on OpenBSD?
In-Reply-To: <Pine.LNX.4.21.0303201358360.2164-100000@lothlorien.coreqa.prognet.com>; from mtaylor@real.com on Thu, Mar 20, 2003 at 02:07:42PM -0800
References: <Pine.LNX.4.21.0303201358360.2164-100000@lothlorien.coreqa.prognet.com>
Message-ID: <20030321085744.A32228@purcell.tratt.net>

On Thu, Mar 20, 2003 at 02:07:42PM -0800, Mark Taylor wrote:

> I've been using OpenBSD3.2, apache2.0.43 and python2.2.1
>
> apxs is not building mod_python.so.  I've found similar plaints in the
> threads, but no solutions.

I haven't had a chance to try this on the latest mod_python, but the problem
certainly used to be that Apache (2.0.33/2.0.44) ships with a version of
libtool which could charitably be described as brain dead. Install libtool
from ports, then overwrite Apache's version of libtool "cp
/usr/local/bin/libtool /usr/local/apache2/build" [or wherever your Apache 2
is].

I've been doing a fairly substantial amount of mod_python work under OpenBSD
and, once installed, it's as stable as a rock.

Best wishes,


Laurie

From jc at cowgar.com  Fri Mar 21 08:37:04 2003
From: jc at cowgar.com (Jeremy Cowgar)
Date: Fri Jan  9 21:59:56 2004
Subject: [mod_python] PythonImport - an example?
In-Reply-To: <01c2ef7e$f5e2e280$926a1e6e@wsasd464>
References: <01c2ef7e$f5e2e280$926a1e6e@wsasd464>
Message-ID: <200303210837.04952.jc@cowgar.com>

Can anyone give me an example of how the PythonImport directive/code works?

I may be mistaken, but what I want to use it for is to establish my initial db 
connections, load some classes, do some configuration, etc... Then in all my 
hander's, I should have access to that information, correct?

Thanks,

Jeremy

From grisha at modpython.org  Fri Mar 21 10:01:44 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:56 2004
Subject: [mod_python] has anyone successfully built mod_python3.03 on
 OpenBSD?
In-Reply-To: <20030321085744.A32228@purcell.tratt.net>
Message-ID: <20030321095949.I50466-100000@eden.ispol.com>


On Fri, 21 Mar 2003, Laurence Tratt wrote:

> certainly used to be that Apache (2.0.33/2.0.44) ships with a version of
> libtool which could charitably be described as brain dead. Install libtool
> from ports, then overwrite Apache's version of libtool "cp
> /usr/local/bin/libtool /usr/local/apache2/build" [or wherever your Apache 2
> is].

A better way is to run ./buildconf - this will copy the libtool from your
system into the Apache source tree and do some other important suff (like
rebuild the ./configure script).


Grisha


From laurie at tratt.net  Fri Mar 21 15:05:55 2003
From: laurie at tratt.net (Laurence Tratt)
Date: Fri Jan  9 21:59:56 2004
Subject: [mod_python] has anyone successfully built mod_python3.03 on OpenBSD?
In-Reply-To: <20030321095949.I50466-100000@eden.ispol.com>; from grisha@modpython.org on Fri, Mar 21, 2003 at 10:01:44AM -0500
References: <20030321085744.A32228@purcell.tratt.net> <20030321095949.I50466-100000@eden.ispol.com>
Message-ID: <20030321150555.H32228@purcell.tratt.net>

On Fri, Mar 21, 2003 at 10:01:44AM -0500, Gregory (Grisha) Trubetskoy wrote:

[Laurie]
>> certainly used to be that Apache (2.0.33/2.0.44) ships with a version of
>> libtool which could charitably be described as brain dead. Install
>> libtool from ports, then overwrite Apache's version of libtool "cp
>> /usr/local/bin/libtool /usr/local/apache2/build" [or wherever your Apache
>> 2 is].
> A better way is to run ./buildconf - this will copy the libtool from your
> system into the Apache source tree and do some other important suff (like
> rebuild the ./configure script).

ISTR that ./buildconf still picks up the Apache libtool (or, at least, it
does under OpenBSD), but would be happy to be corrected.

Best wishes,


Laurie

From grisha at modpython.org  Fri Mar 21 10:36:36 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:56 2004
Subject: [mod_python] PythonImport - an example?
In-Reply-To: <200303210837.04952.jc@cowgar.com>
Message-ID: <20030321100228.P50466-100000@eden.ispol.com>

Yes, but I would stay away from PythonImport unless you have no choice.

There's been some debate about this on the list before and it manly arises
from a misunderstanding of how things work. At first glance it seems like
a simple and obvious thing - initiate my db connections and load big data
dictionaries at server startup so that when those requests come in we're
ready to go.

But the problem is that Apache doesn't work this way. The context within
which a request runs comes into existence only after a request begins and
is a result of applying known server configuration directives (from config
and .htaccess files) to dynamic request parameters (e.g. host:  header
which dictates the virtual server to be used, and also the name of the
subinterpreter mod_python will use).

Consider also that there is no way to reliably predict ahead of time what
this request environment may look like since it is put together gradually
by handlers, which might be provided by any number of apache modules which
may choose to drastically change the request environment (e.g. rewrite a
bunch of headers). For example the virtual server and document root
information may not even be specified in the config file but is created
dynamically per-request if you're using something like mod_vhost.

But the server config file discussion during PythonImport is moot,
because, in fact, at the time when PythonImport executes (Apache child
initialization phase), Apache hasn't yet read the config file fully.

So you have to realize that PythonImport runs in this minimalistic bare
environment and needs a hint in the form of the subinterpreter name to be
useful, and sometimes getting it to work correctly can be a challenge, and
also keep in mind that using this directive isn't very portable because it
requires the interpreter name.

I personally favor not bothering with pre-initialization at all. The
downside is that the first hit to your side may take a little longer.
Another option that I've used quite successfully is to add a request to
some initialization url (using lynx or wget or whatever) into the server
start up script.

Grisha

On Fri, 21 Mar 2003, Jeremy Cowgar wrote:

> Can anyone give me an example of how the PythonImport directive/code works?
>
> I may be mistaken, but what I want to use it for is to establish my initial db
> connections, load some classes, do some configuration, etc... Then in all my
> hander's, I should have access to that information, correct?
>
> Thanks,
>
> Jeremy
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From vlindberg at verio.net  Fri Mar 21 18:01:10 2003
From: vlindberg at verio.net (VanL)
Date: Fri Jan  9 21:59:56 2004
Subject: [mod_python] Dynamic virtualhost configuration
Message-ID: <3E7BB5D6.5020706@verio.net>

Hello,

In a book about apache, I came across the following bit of code for 
mod_perl:

[embedded in httpd.conf]
# generate virtual hosts on the fly with Perl
<Perl>
#!/usr/bin perl -w

[snip some stuff]

# Open the virtual hosts file
open (FILE, "/usr/local/apache/conf/vhosts.conf");

while(<FILE>)
     # Create a virtual host based on this line
     ($ip,$host,$admin,$vroot,$aliases) = split /\s*,\s*, $_;
     $VirtualHost {$ip} = {

         [Create virtual host from variables]

[snip other stuff]

</Perl>
[continue httpd.conf]

Is it possible to do the same with mod_python?  I am in a situation 
where I have many subhosts, substantially similar.  Being able to define 
a shorthand for virtual hosts would be a big plus.

In a similar vein, the documentation talks about dynamically associating 
different handlers with a request.  Are these python handlers only, or 
could mod_python do a runtime check that associates mod_php with .php 
files in a specific virtualhost?

Thanks,

VanL


From vlindberg at verio.net  Fri Mar 21 18:18:06 2003
From: vlindberg at verio.net (VanL)
Date: Fri Jan  9 21:59:56 2004
Subject: [mod_python] Dynamic virtualhost configuration
In-Reply-To: <20030322010644.GO13870@netvista.mikebell.org>
References: <3E7BB5D6.5020706@verio.net> <20030322010644.GO13870@netvista.mikebell.org>
Message-ID: <3E7BB9CE.40204@verio.net>

Hello,

mod_vhost_alias would work for some of the accounts, but not others.
The essential problem is that certain services (like php execution, or 
ssi execution) are defined on a per-vhost basis.  From reading the 
documentation and a little experimentation, I'm not sure how to enable 
these services in some contexts, and not in others.  Note that I'm 
mostly talking about module-based services, not simple cgi executiona 
ability.  Thus VirtualScriptAlias wouldn't cut it, to my knowledge.

VanL

mike@mikebell.org wrote:

>On Fri, Mar 21, 2003 at 06:01:10PM -0700, VanL wrote:
>  
>
>>Is it possible to do the same with mod_python?  I am in a situation 
>>where I have many subhosts, substantially similar.  Being able to define 
>>a shorthand for virtual hosts would be a big plus.
>>    
>>
>
>What about mod_vhost_alias? That's what I use.
>
>  
>



From vlindberg at verio.net  Fri Mar 21 18:26:35 2003
From: vlindberg at verio.net (VanL)
Date: Fri Jan  9 21:59:56 2004
Subject: [mod_python] Dynamic virtualhost configuration
In-Reply-To: <20030322012527.GP13870@netvista.mikebell.org>
References: <3E7BB5D6.5020706@verio.net> <20030322010644.GO13870@netvista.mikebell.org> <3E7BB9CE.40204@verio.net> <20030322012527.GP13870@netvista.mikebell.org>
Message-ID: <3E7BBBCB.3090508@verio.net>

mike@mikebell.org wrote:

>Well, if you've got (say) three different setups, three IPs will do the
>job very nicely... If you don't have three IPs it's not so easy, but...
>

Thats right.  And if you only have one IP, then you start looking at a 
way to do it dynamically, so you don't tear your hair out. Hence my 
request...

VanL



From lientz at harvestsolutions.com  Fri Mar 21 18:06:26 2003
From: lientz at harvestsolutions.com (Andrew Lientz)
Date: Fri Jan  9 21:59:56 2004
Subject: [mod_python] cgihandler and redirects
Message-ID: <1048298792.9281.20.camel@hercules.harvestsolutions.com>

Hi,

We are going to slowly convert to mod_python for our application.  In
order to start the transitions I had to correct three things to allow
the cgihandler.py to make our application work properly.  

I edited apache.py to look for the Location header.  When it finds it it
sets the status. I had a problem with the status raised in cgihandler.py
being overridden.  I ended up getting the nicely formated OK pages out
of the web server.  I added the code below to the write function in the
CGIStdout class.

Here's the diff output of my changes:
714,715d713
<                     if h.lower() == "location":
<                         self.req.status = HTTP_MOVED_TEMPORARILY

This allows the code below to be read and redirected without the OK
page.

print "Location: http://blah\n"

and not need any special changes.


In cgihandler.py, I had to append the the current directory to
sys.path.  If it's a subdirectory of the main directory, the
subdirectory doesn't get passed.  This messes with import commands
within a script.  

Also, sys.exit(0) is an easy way to end a script.  It should be graceful
but it raises a SystemExit error.  I modified the code to deal with
this.

Here's the diff output of what I changed in cgihandler.py.

127d126
<             sys.path.append (dir)
134,141d132
<             # this executes the module
<             try:
<                 imp.load_module(module_name, fd, path, desc)
<             except SystemExit, e:
<                 if e == 0:
<                     pass
<                 else:
<                     raise SystemExit, e

I am posting this as an FYI and to see if there was something better I
could have done.  I couldn't find any references in the list archives,
so I hope this helps.

Regards,

Andy
-- 
Andrew Lientz
Harvest Solutions, Inc.
310-398-4761


From mateusz at ant.gliwice.pl  Mon Mar 24 13:23:34 2003
From: mateusz at ant.gliwice.pl (Mateusz Korniak)
Date: Fri Jan  9 21:59:56 2004
Subject: [mod_python] Using publisher handler to generate directory index - how to do it in right and easy way ?
Message-ID: <200303241323.34434.mateusz@ant.gliwice.pl>

Assume I have:
Defined for virtual host www.host.com  root direcotory <html_dir>/host/
I have <html_dir>/host/handler.py defined as Publisher Handler.

When user requestes 'www.host.com/handler/foo' it works well.

How to make handler.index(req) be handler of user requestes 'www.host.com' ?

TIA
-- 
Mateusz Korniak
easy.com  easy.go


From grisha at modpython.org  Mon Mar 24 10:51:22 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:56 2004
Subject: [mod_python] Using publisher handler to generate directory index
 - how to do it in right and easy way ?
In-Reply-To: <200303241323.34434.mateusz@ant.gliwice.pl>
Message-ID: <20030324105047.T95235-100000@eden.ispol.com>


On Mon, 24 Mar 2003, Mateusz Korniak wrote:

> When user requestes 'www.host.com/handler/foo' it works well.
>
> How to make handler.index(req) be handler of user requestes 'www.host.com' ?

You can use a DirectoryIndex directive to point to a mod_python script.

Grisha


From dorlov at banta-im.com  Wed Mar 26 11:32:41 2003
From: dorlov at banta-im.com (Dmitry Orlov)
Date: Fri Jan  9 21:59:56 2004
Subject: [mod_python] HTML filtering
Message-ID: <3E81D629.E27E83BE@banta-im.com>

I've started looking into switching some sites that use Python through
cgi to mod_python. The sites work via HTML filtering, sort of like PHP,
with bits of Python stuck inside HTML files. I tried to look for docs
that would show how I could set up such a scheme for mod_python, but
haven't found anything (yet).

Currently, we configure Apache using ScriptAlias and Action directives,
so that any request for a .html file within a certain Location gets
piped through the cgi which runs Python via an HTML filter.

The HTML filter coded in C/flex. It does variable substitution for
things like {$foo}, runs Python snippets between <?python and ?> tags a
la PHP, and a bunch of other nifty things, like form pre-population.

This scheme works quite well, and is fast if one uses fastcgi, but is a
bit complicated. I am hoping to simplify it using mod_python while
retaining the excellent performance.

I am thinking that the ideal drop-in replacement scheme would be to make
our HTML filter into a Python module, and call it via an output filter.
But how do I set it up so that mod_python runs for .html files instead
of .py files?

-Dmitry

From geertj at boskant.nl  Wed Mar 26 18:00:39 2003
From: geertj at boskant.nl (Geert Jansen)
Date: Fri Jan  9 21:59:56 2004
Subject: [mod_python] HTML filtering
In-Reply-To: <3E81D629.E27E83BE@banta-im.com>
References: <3E81D629.E27E83BE@banta-im.com>
Message-ID: <20030326170039.GA7644@vader.boskant.nl>

On Wed, Mar 26, 2003 at 11:32:41AM -0500, Dmitry Orlov wrote:
 
> I am thinking that the ideal drop-in replacement scheme would be to make
> our HTML filter into a Python module, and call it via an output filter.
> But how do I set it up so that mod_python runs for .html files instead
> of .py files?

(Set,Add)Handler python-program .html

Greetings,
Geert Jansen

From neel at mediapulse.com  Wed Mar 26 12:08:01 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:59:56 2004
Subject: [mod_python] HTML filtering
Message-ID: <C0FC22C08B82074A88B50061764157772C656A@johnson.mediapulse.net>

In httpd.conf, for the server add:

    <Files ~ "\.html$">
        SetHandler python-program
        PythonPath "sys.path+['/home/sites/mysite.com/modules']"
        PythonHandler www
        #PythonDebug On
    </Files>

With a www.py in the /home/sites/mysite.com/modules directory.  In
www.py you can put your request handler.

You might want to take a look at Albatross, it sounds very close to what
you are doing, http://www.object-craft.com.au/projects/albatross/

Mike

-----Original Message-----
From: Dmitry Orlov [mailto:dorlov@banta-im.com] 
Sent: Wednesday, March 26, 2003 11:33 AM
To: mod_python@modpython.org
Subject: [mod_python] HTML filtering


I've started looking into switching some sites that use Python through
cgi to mod_python. The sites work via HTML filtering, sort of like PHP,
with bits of Python stuck inside HTML files. I tried to look for docs
that would show how I could set up such a scheme for mod_python, but
haven't found anything (yet).

Currently, we configure Apache using ScriptAlias and Action directives,
so that any request for a .html file within a certain Location gets
piped through the cgi which runs Python via an HTML filter.

The HTML filter coded in C/flex. It does variable substitution for
things like {$foo}, runs Python snippets between <?python and ?> tags a
la PHP, and a bunch of other nifty things, like form pre-population.

This scheme works quite well, and is fast if one uses fastcgi, but is a
bit complicated. I am hoping to simplify it using mod_python while
retaining the excellent performance.

I am thinking that the ideal drop-in replacement scheme would be to make
our HTML filter into a Python module, and call it via an output filter.
But how do I set it up so that mod_python runs for .html files instead
of .py files?

-Dmitry
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python


From peter.bittner at gmx.net  Thu Mar 27 02:17:57 2003
From: peter.bittner at gmx.net (Peter Bittner)
Date: Fri Jan  9 21:59:56 2004
Subject: [mod_python] Using publisher handler to generate directory index - how to do it in right and easy way ?
References: <20030324105047.T95235-100000@eden.ispol.com>
Message-ID: <30920.1048727877@www56.gmx.net>

Hi there!

> On Mon, 24 Mar 2003, Mateusz Korniak wrote:
> 
> > When user requestes 'www.host.com/handler/foo' it works well.
> >
> > How to make handler.index(req) be handler of user requestes
> > 'www.host.com' ?

I have already tried to talk about this topic a while ago (maybe half a year
ago it was).

What I had proposed then, was to make the PublisherHandler handle a
'default' method, say func default(), which should be called automatically when a
request without a function name comes. In your examples this would be
'www.host.com/handler/' -- this would be handled like todays
'www.host.com/handler/default'.

This way one could make the web server handle, say, all 'index.py' files
like the defaults of a directory. (Comparable to the 'index.html' or whatever
someone sets to be called when no document is specified on access to HTML-files
on a web server.)

Having a PublisherHandler with a default function would then make it easy --
(look at the subject of Mateusz' message!) -- to create web projects in the
same simple manner as if there were only HTML-files:

 - An HTTP request to www.host.com would go to, say, www.host.com/index.py
(physically) and logically to www.host.com/index/default, respectively.
 - An HTTP request to www.host.com/mydir/ would in the same manner go to
www.host.com/mydir/index.py (physically) and logically to
www.host.com/mydir/index/default, respectively.

I think mod_python would only benefit from such a change to the
PublisherHandler's code. This would make mod_python (and thus Python itself) more
attractive to web designers and web programmers.

"Grisha" wrote:
> You can use a DirectoryIndex directive to point to a mod_python script.

Well, from my point of view this is only a workaround.
A general solution, however, might give Python the chance to become as
popular as PHP for web programming - after some time of course, not over night!

Please guys, note that this might be a change request that a lot of people
are waiting for, I think especially a lot of newbies to mod_python - newbies
that know other languages like PHP and (CGI-) Python beside others.

Peter

-- 
"Free software is like free speech, not free beer" (Richard Stallman)

+++ GMX - Mail, Messaging & more  http://www.gmx.net +++
Bitte l?cheln! Fotogalerie online mit GMX ohne eigene Homepage!


From dustin at ywlcs.org  Wed Mar 26 21:19:44 2003
From: dustin at ywlcs.org (Dustin Mitchell)
Date: Fri Jan  9 21:59:56 2004
Subject: [mod_python] Using publisher handler to generate directory index - how to do it in right and easy way ?
In-Reply-To: <30920.1048727877@www56.gmx.net>
References: <20030324105047.T95235-100000@eden.ispol.com> <30920.1048727877@www56.gmx.net>
Message-ID: <20030327031944.GP10000@eleanor.internal.ywlcs.org>

I agree this wouuld be a handy feature.  If it's likely to cause problems
(with backward compatibility, perhaps), then it could be selected with a
configuration directive (PythonOption PublisherDefault [off|<name>]), or even
exist as a separate publisher.

I'm sure we're all missing some good reason this is a bad idea.

Otherwise, I'd be willing to create a patch.

Dustin

-- 

  Dustin Mitchell
  dustin@ywlcs.org/djmitche@alumni.uchicago.edu
  http://people.cs.uchicago.edu/~dustin/

From grisha at modpython.org  Wed Mar 26 23:10:02 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:56 2004
Subject: [mod_python] Using publisher handler to generate directory index
 - how to do it in right and easy way ?
In-Reply-To: <20030327031944.GP10000@eleanor.internal.ywlcs.org>
Message-ID: <20030326230705.G36549-100000@eden.ispol.com>

Unless I'm missing something, the publisher already has a default
function, only it's "index" not "default":

http://www.modpython.org/live/current/doc-html/hand-pub-alg-trav.html

Grisha

On Wed, 26 Mar 2003, Dustin Mitchell wrote:

> I agree this wouuld be a handy feature.  If it's likely to cause problems
> (with backward compatibility, perhaps), then it could be selected with a
> configuration directive (PythonOption PublisherDefault [off|<name>]), or even
> exist as a separate publisher.
>
> I'm sure we're all missing some good reason this is a bad idea.
>
> Otherwise, I'd be willing to create a patch.
>
> Dustin
>
> --
>
>   Dustin Mitchell
>   dustin@ywlcs.org/djmitche@alumni.uchicago.edu
>   http://people.cs.uchicago.edu/~dustin/
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From stevena at neosynapse.net  Wed Mar 26 23:47:02 2003
From: stevena at neosynapse.net (Steven D. Arnold)
Date: Fri Jan  9 21:59:56 2004
Subject: [mod_python] environment variables not visible?
Message-ID: <BAA7EC76.1FC82%stevena@neosynapse.net>

Hello,

I am attempting to use mod_python 2.7.8 with spyce 1.3.6.  In my project, I
use a database module that connects with a Sybase database.  The module
expects certain environment variables to be set, which I set directly using
os.environ.  Nevertheless, the module doesn't seem to see the environment
variables; the errors are exactly as if the environment variables are not
present.

When I execute the same code from the python interpreter, it works fine.
Likewise when I run the pages from CGI rather than mod_python.  Thus, it
seems as if this may be a mod_python issue.  Any idea what may be going on?

Thanks,
steve
-- 



From grisha at modpython.org  Thu Mar 27 08:04:31 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:56 2004
Subject: [mod_python] environment variables not visible?
In-Reply-To: <BAA7EC76.1FC82%stevena@neosynapse.net>
Message-ID: <20030327080031.S42239-100000@eden.ispol.com>

I am guessing you are using the cgihandler. You can't see environment
variables from within the cgihandler-executed CGI scripts, it's mentioned
here:

http://www.modpython.org/live/current/doc-html/hand-cgi.html

Your options are to switch to using the publisher handler or write your
own handler.

Also, I may be wrong, but I think information that is gathered by the
sybase client from the environment can be passed to it by other means.

Grisha

On Wed, 26 Mar 2003, Steven D. Arnold wrote:

> Hello,
>
> I am attempting to use mod_python 2.7.8 with spyce 1.3.6.  In my project, I
> use a database module that connects with a Sybase database.  The module
> expects certain environment variables to be set, which I set directly using
> os.environ.  Nevertheless, the module doesn't seem to see the environment
> variables; the errors are exactly as if the environment variables are not
> present.
>
> When I execute the same code from the python interpreter, it works fine.
> Likewise when I run the pages from CGI rather than mod_python.  Thus, it
> seems as if this may be a mod_python issue.  Any idea what may be going on?
>
> Thanks,
> steve
> --
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From vlindberg at verio.net  Thu Mar 27 08:34:08 2003
From: vlindberg at verio.net (VanL)
Date: Fri Jan  9 21:59:56 2004
Subject: [mod_python] Using the socket module
Message-ID: <3E8319F0.2010306@verio.net>

Hello,

I am trying to connect to a Pyro Server from an app running within
mod_python, but it dies anytime it tries to initialize the socket
library.  Is this a known issue?   Are there any fixes or workarounds?

Thanks

VanL



From geertj at boskant.nl  Thu Mar 27 16:54:43 2003
From: geertj at boskant.nl (Geert Jansen)
Date: Fri Jan  9 21:59:56 2004
Subject: [mod_python] Python codecs bug
Message-ID: <20030327155443.GA23429@vader.boskant.nl>

Hi,

recently, a bug in the Python codecs subsystem has been discovered that
can affect mod_python programs. I have a confirmed report that this bug fixes
the vague "Cannot unmarshal code object in restricted execution mode" error
that was discussed on this list:

  http://mail.python.org/pipermail/python-list/2002-June/109233.html

The bug is described in detail here:

  http://sourceforge.net/tracker/index.php?func=detail&aid=663074&group_id=5470&atid=105470

The Python 2.3 CVS has been fixed. A backport of this fix to Python 2.2.2 is
available from my website at:

  http://draco.boskant.nl/requirements.dsp

the patch has been submitted to the Python crew.

I thought you'd might be interested...

Greetings,
Geert Jansen

From grisha at modpython.org  Thu Mar 27 11:01:27 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:56 2004
Subject: [mod_python] Using the socket module
In-Reply-To: <3E8319F0.2010306@verio.net>
Message-ID: <20030327105923.D44232-100000@eden.ispol.com>

It would help if you provided some specifics:

1. Code
2. Any error output (from apache error_log)
3. Versions of Python, mod_python, apache and your OS

Grisha

On Thu, 27 Mar 2003, VanL wrote:

> Hello,
>
> I am trying to connect to a Pyro Server from an app running within
> mod_python, but it dies anytime it tries to initialize the socket
> library.  Is this a known issue?   Are there any fixes or workarounds?
>
> Thanks
>
> VanL
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From stevena at neosynapse.net  Thu Mar 27 11:26:34 2003
From: stevena at neosynapse.net (Steven D. Arnold)
Date: Fri Jan  9 21:59:56 2004
Subject: [mod_python] environment variables not visible?
In-Reply-To: <20030327080031.S42239-100000@eden.ispol.com>
Message-ID: <BAA8906A.1FDDE%stevena@neosynapse.net>

On 3/27/03 8:04 AM, "Gregory (Grisha) Trubetskoy" <grisha@modpython.org>
wrote:

> I am guessing you are using the cgihandler. You can't see environment
> variables from within the cgihandler-executed CGI scripts, it's mentioned
> here:
> 
> http://www.modpython.org/live/current/doc-html/hand-cgi.html

I saw this post, but it doesn't seem I am using that.  Here's the section of
the config:

#AddHandler spyce-cgi-handler spy
#Action spyce-cgi-handler "/spyce-cgi/run_spyceCGI.py"
#ScriptAlias /spyce-cgi/ "/usr/share/spyce/cgi/"
<IfModule mod_python.c>
  AddHandler python-program .spy
  PythonHandler run_spyceModpy::spyceMain
  PythonPath 
"sys.path+[r'/usr/share/spyce/cgi','/server/unr/spyce_modules']"
  PythonOption SPYCE_CONFIG "/usr/share/spyce/spyce.conf"
  # !!! Do NOT turn on. !!!
  PythonOptimize Off
  SetEnv SYBASE /server/sybase/ASE_12501_2
  SetEnv LD_LIBRARY_PATH
/server/sybase/ASE_12501_2/OCS-12_5/lib:/usr/local/lib
  SetEnv SYBASE_OCS /server/sybase/ASE_12501_2/OCS-12_5
  SetEnv SYBASE_ASE /server/sybase/ASE_12501_2/ASE-12_5
</IfModule>
## Following Directives commented out for Mod_python testing
## 03/25/03
#<Location /spyce-cgi/>
#  <IfModule mod_fastcgi.c>
#    # If mod_fastcgi not installed, we get plain cgi
#    SetHandler fastcgi-script
#  </IfModule>
#</Location>
# If FastCGI is installed, it will be picked up
# automatically. On Linux, you can also omit this section
# and use a dynamic fcgi server instead.
#<IfModule mod_fastcgi.c>
#  FastCgiServer "/usr/share/spyce/cgi/run_spyceCGI.py" -port 7654
-initial-env F
#CGI_PORT=7654
#</IfModule>

Note the SetEnv directives are used in addition to setting the environment
with os.environ, but neither of these approaches work.  I am not familiar
enough with the internals of mod_python, but it seems perhaps
run_spyceModpy::spyceMain is the mon_python handler and perhaps it is
somehow forgetting the environment variables.  Does this seem like a likely
possibility to you?

Thanks,
steve
-- 



From vlindberg at verio.net  Thu Mar 27 11:25:58 2003
From: vlindberg at verio.net (VanL)
Date: Fri Jan  9 21:59:56 2004
Subject: [mod_python] Using the socket module
References: <20030327105923.D44232-100000@eden.ispol.com>
Message-ID: <3E834236.7030104@verio.net>

I'm sorry, I have worked it out.  The bug was not in mod_python -- Pyro 
was importing the Threading module in a couple of places without 
checking to see if the python installation supported multithreading.

Thanks,

VanL

Gregory (Grisha) Trubetskoy wrote:

>It would help if you provided some specifics:
>
>1. Code
>2. Any error output (from apache error_log)
>3. Versions of Python, mod_python, apache and your OS
>
>Grisha
>
>On Thu, 27 Mar 2003, VanL wrote:
>
>  
>
>>Hello,
>>
>>I am trying to connect to a Pyro Server from an app running within
>>mod_python, but it dies anytime it tries to initialize the socket
>>library.  Is this a known issue?   Are there any fixes or workarounds?
>>
>>Thanks
>>
>>VanL
>>
>>
>>_______________________________________________
>>Mod_python mailing list
>>Mod_python@modpython.org
>>http://www.modpython.org/mailman/listinfo/mod_python
>>
>>    
>>
>
>  
>




From jessamyn.smith at pason.com  Thu Mar 27 14:38:16 2003
From: jessamyn.smith at pason.com (Jessamyn Smith)
Date: Fri Jan  9 21:59:56 2004
Subject: [mod_python] Import site failed
Message-ID: <20030327143816.A935@ash.int.ca.pason.com>


We are in the process of upgrading our application to use mod_python.  I
have successfully configured and installed mod_python-2.7.8 on my
system, with Python 2.2.2 and MySQL-python-0.9.2.  However, when the
other developers follow my directions, they get the following error when
trying to run any Python CGI scripts:

'import site' failed; use -v for traceback
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
[Thu Mar 27 14:28:44 2003] [error] [client 127.0.0.1] python_handler:
make_obcallback returned no obCallBack!

Does anyone have any insight as to what could be different?  As far as
we know we are all running the same system (RedHat 7.3).  I am able to
wipe out my entire Python 2.2.2 directory and start the install from
scratch, and get a working version of mod_python, so I suspect the
problem is in the environment.

I tried looking through the archives, but the link for downloading the
entire mbox seems to be broken:
Not Found

The requested URL /pipermail/mod_python.mbox/mod_python.mbox was not
found on this server.

My patience for clicking monthly links to the archives wore out well
before I'd checked them all.

Jessamyn
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 232 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20030327/d532d963/attachment-0002.bin
From scott_list at mischko.com  Thu Mar 27 13:40:24 2003
From: scott_list at mischko.com (Scott Chapman)
Date: Fri Jan  9 21:59:57 2004
Subject: [mod_python] HTML filtering
In-Reply-To: <3E81D629.E27E83BE@banta-im.com>
References: <3E81D629.E27E83BE@banta-im.com>
Message-ID: <200303271340.24840.scott_list@mischko.com>

You might want to look at Spyce (http://spyce.sourceforge.net/) also.  It 
allows you to embed Python in HTML.

Scott


On Wednesday 26 March 2003 8:32 am, Dmitry Orlov wrote:
I've started looking into switching some sites that use Python through
cgi to mod_python. The sites work via HTML filtering, sort of like PHP,
with bits of Python stuck inside HTML files. I tried to look for docs
that would show how I could set up such a scheme for mod_python, but
haven't found anything (yet).

Currently, we configure Apache using ScriptAlias and Action directives,
so that any request for a .html file within a certain Location gets
piped through the cgi which runs Python via an HTML filter.

The HTML filter coded in C/flex. It does variable substitution for
things like {$foo}, runs Python snippets between <?python and ?> tags a
la PHP, and a bunch of other nifty things, like form pre-population.

This scheme works quite well, and is fast if one uses fastcgi, but is a
bit complicated. I am hoping to simplify it using mod_python while
retaining the excellent performance.

I am thinking that the ideal drop-in replacement scheme would be to make
our HTML filter into a Python module, and call it via an output filter.
But how do I set it up so that mod_python runs for .html files instead
of .py files?

-Dmitry
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python



From gnb at itga.com.au  Fri Mar 28 09:05:23 2003
From: gnb at itga.com.au (Gregory Bond)
Date: Fri Jan  9 21:59:57 2004
Subject: [mod_python] Import site failed 
In-Reply-To: Your message of Thu, 27 Mar 2003 14:38:16 -0700.
Message-ID: <200303272205.JAA14087@lightning.itga.com.au>

> [Thu Mar 27 14:28:44 2003] [error] [client 127.0.0.1] python_handler:
> make_obcallback returned no obCallBack!

Check the very first entry in the FAQ:
	http://www.modpython.org/FAQ/faqw.py?req=show&file=faq02.001.htp




From dorlov at banta-im.com  Thu Mar 27 17:25:27 2003
From: dorlov at banta-im.com (Dmitry Orlov)
Date: Fri Jan  9 21:59:57 2004
Subject: [mod_python] HTML filtering
References: <3E81D629.E27E83BE@banta-im.com> <200303271340.24840.scott_list@mischko.com>
Message-ID: <3E837A57.7D90AEB6@banta-im.com>

Hi Scott,

Thanks for the tip, but I've looked at all kinds of templating engines,
and they all pretty much do the same thing, albeit in a wide variety of
ways. The commonalities are:

1. you have to manually put in bits of code to change values of
attributes and query string variables, and

2. designers who use wysiwyg tools like Dreamweaver are at a loss if you
give them a marked-up HTML file to edit.

The idea behind ours is that lots of common-sense stuff just happens
automatically. For example, if there is an <input type="text"
name="foo"> and request.foo happens to be "bar", the engine spits out
<input type="text" name="foo" value="bar"> without being asked. Likewise
with <a href="something.com?foo"> - it gets rewritten to <a
href="something.com?foo=bar"> without the programmer having to do
anything.

We've been using this engine with good results for about 4 years now, on
lots of sites, like http://designjet.hp.com/. It's built into a couple
of our legacy frameworks, but should be relatively easy to reuse;
reasonably recent docs are available at
http://www.integratis.org/dfp.html.

I am leaning in the direction of making it into a GPL'ed Python module
that can be plugged into mod_python as an output filter. But I don't
know how much interest there would be. OSDN/Sourceforge/Freshmeat don't
seem effective as far as gauging interest.

That's why I am sort of spamming this list (just this once, I promise!)
If you think you might be interested in trying it out, or know of anyone
who might be, please let me know. If a bunch of people tell me "Yes,
I'll try it", then that's probably all the push I need to start coding.

-Dmitry

Scott Chapman wrote:
> 
> You might want to look at Spyce (http://spyce.sourceforge.net/) also.  It
> allows you to embed Python in HTML.
> 
> Scott
> 
> On Wednesday 26 March 2003 8:32 am, Dmitry Orlov wrote:
> I've started looking into switching some sites that use Python through
> cgi to mod_python. The sites work via HTML filtering, sort of like PHP,
> with bits of Python stuck inside HTML files. I tried to look for docs
> that would show how I could set up such a scheme for mod_python, but
> haven't found anything (yet).
> 
> Currently, we configure Apache using ScriptAlias and Action directives,
> so that any request for a .html file within a certain Location gets
> piped through the cgi which runs Python via an HTML filter.
> 
> The HTML filter coded in C/flex. It does variable substitution for
> things like {$foo}, runs Python snippets between <?python and ?> tags a
> la PHP, and a bunch of other nifty things, like form pre-population.
> 
> This scheme works quite well, and is fast if one uses fastcgi, but is a
> bit complicated. I am hoping to simplify it using mod_python while
> retaining the excellent performance.
> 
> I am thinking that the ideal drop-in replacement scheme would be to make
> our HTML filter into a Python module, and call it via an output filter.
> But how do I set it up so that mod_python runs for .html files instead
> of .py files?
> 
> -Dmitry
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

From gnb at itga.com.au  Fri Mar 28 10:09:42 2003
From: gnb at itga.com.au (Gregory Bond)
Date: Fri Jan  9 21:59:57 2004
Subject: [mod_python] HTML filtering 
In-Reply-To: Your message of Thu, 27 Mar 2003 17:25:27 -0500.
Message-ID: <200303272309.KAA18383@lightning.itga.com.au>

> The idea behind ours is that lots of common-sense stuff just happens
> automatically. For example, if there is an <input type="text"
> name="foo"> and request.foo happens to be "bar", the engine spits out
> <input type="text" name="foo" value="bar"> without being asked.

Albatross (http://www.object-craft.com.au/projects/albatross/) does this sort 
of thing very well, and supports CGI or mod_python with the same script (with 
a bit of trickery).  But it might be a bit hard to cut over existing products 
to use it.


From grisha at modpython.org  Thu Mar 27 18:14:01 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:57 2004
Subject: [mod_python] HTML filtering
In-Reply-To: <3E837A57.7D90AEB6@banta-im.com>
Message-ID: <20030327181158.I50327-100000@eden.ispol.com>


On Thu, 27 Mar 2003, Dmitry Orlov wrote:

> I am leaning in the direction of making it into a GPL'ed Python module
> that can be plugged into mod_python as an output filter.

It's be more in Python spirit if it was a BSD-style license rather than
GPL. :-)

Grisha


From scott_list at mischko.com  Thu Mar 27 15:14:16 2003
From: scott_list at mischko.com (Scott Chapman)
Date: Fri Jan  9 21:59:57 2004
Subject: [mod_python] HTML filtering
In-Reply-To: <3E837A57.7D90AEB6@banta-im.com>
References: <3E81D629.E27E83BE@banta-im.com> <200303271340.24840.scott_list@mischko.com> <3E837A57.7D90AEB6@banta-im.com>
Message-ID: <200303271514.16988.scott_list@mischko.com>

I am VERY interested in this.  If you can make a copy of it available to 
experiment with, I'd appreciate it.

My vote is "Yes" on GPL action here!

Scott

On Thursday 27 March 2003 2:25 pm, Dmitry Orlov wrote:
Hi Scott,

Thanks for the tip, but I've looked at all kinds of templating engines,
and they all pretty much do the same thing, albeit in a wide variety of
ways. The commonalities are:

1. you have to manually put in bits of code to change values of
attributes and query string variables, and

2. designers who use wysiwyg tools like Dreamweaver are at a loss if you
give them a marked-up HTML file to edit.

The idea behind ours is that lots of common-sense stuff just happens
automatically. For example, if there is an <input type="text"
name="foo"> and request.foo happens to be "bar", the engine spits out
<input type="text" name="foo" value="bar"> without being asked. Likewise
with <a href="something.com?foo"> - it gets rewritten to <a
href="something.com?foo=bar"> without the programmer having to do
anything.

We've been using this engine with good results for about 4 years now, on
lots of sites, like http://designjet.hp.com/. It's built into a couple
of our legacy frameworks, but should be relatively easy to reuse;
reasonably recent docs are available at
http://www.integratis.org/dfp.html.

I am leaning in the direction of making it into a GPL'ed Python module
that can be plugged into mod_python as an output filter. But I don't
know how much interest there would be. OSDN/Sourceforge/Freshmeat don't
seem effective as far as gauging interest.

That's why I am sort of spamming this list (just this once, I promise!)
If you think you might be interested in trying it out, or know of anyone
who might be, please let me know. If a bunch of people tell me "Yes,
I'll try it", then that's probably all the push I need to start coding.

-Dmitry

Scott Chapman wrote:
> You might want to look at Spyce (http://spyce.sourceforge.net/) also.  It
> allows you to embed Python in HTML.
>
> Scott
>
> On Wednesday 26 March 2003 8:32 am, Dmitry Orlov wrote:
> I've started looking into switching some sites that use Python through
> cgi to mod_python. The sites work via HTML filtering, sort of like PHP,
> with bits of Python stuck inside HTML files. I tried to look for docs
> that would show how I could set up such a scheme for mod_python, but
> haven't found anything (yet).
>
> Currently, we configure Apache using ScriptAlias and Action directives,
> so that any request for a .html file within a certain Location gets
> piped through the cgi which runs Python via an HTML filter.
>
> The HTML filter coded in C/flex. It does variable substitution for
> things like {$foo}, runs Python snippets between <?python and ?> tags a
> la PHP, and a bunch of other nifty things, like form pre-population.
>
> This scheme works quite well, and is fast if one uses fastcgi, but is a
> bit complicated. I am hoping to simplify it using mod_python while
> retaining the excellent performance.
>
> I am thinking that the ideal drop-in replacement scheme would be to make
> our HTML filter into a Python module, and call it via an output filter.
> But how do I set it up so that mod_python runs for .html files instead
> of .py files?
>
> -Dmitry
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python



From jessamyn.smith at pason.com  Fri Mar 28 07:56:42 2003
From: jessamyn.smith at pason.com (Jessamyn Smith)
Date: Fri Jan  9 21:59:57 2004
Subject: [mod_python] Import site failed
In-Reply-To: <D31B04F24EDE7644BB169BB4F080778A06C2396B@s30342g004005>; from Hans.Yandle@cingular.com on Fri, Mar 28, 2003 at 09:07:37AM -0500
References: <D31B04F24EDE7644BB169BB4F080778A06C2396B@s30342g004005>
Message-ID: <20030328075642.A25172@ash.int.ca.pason.com>


Thank you everyone for your help.  We managed to fix the problem by
adding a symbolic link:
ln -s /path/to/Python-2.2.2 /path/to/PythonHome

And editing the apache startup script (/etc/init.d/httpd), adding:
export PYTHONHOME='/hub/apps/PythonHome/'
in the start() function.

I felt pretty dumb for not checking the webpage for a FAQ.  We were
googling for "import site failed", when apparently we should have been
googling for "obcallback".  I am also still perplexed as to how my
machine is able to find mod_python, when I haven't done either of the
above steps.

Anyway, thanks again!

Jessamyn
-- 
Jessamyn Smith
Systems Analyst, DataHub Team
Ph: (403) 301-3470
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 232 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20030328/5bbc3796/attachment-0002.bin
From grisha at modpython.org  Fri Mar 28 17:38:48 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:57 2004
Subject: [mod_python] Why are you using mod_python?
In-Reply-To: <20030328075642.A25172@ash.int.ca.pason.com>
Message-ID: <20030328172826.X67038-100000@eden.ispol.com>

Hello everyone -

As the original author of mod_python I think I'm allowed to jerk people's
chains with this simple question:

Why are you using mod_python?

You can reply on or off list, either is fine. The results, after I get to
mull over them will be published in one way or another.

I've decided to ask the list because I recently realized that I am not
sure I know the answer. Not to say that I don't like mod_python, on the
contrary, I do, but to formulate in words exactly why is rather difficult.
Besides, my opinion is biased anyway :-)

Thanks in advance!

Grisha



From gdamjan at mail.net.mk  Sat Mar 29 03:55:34 2003
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 21:59:57 2004
Subject: [mod_python] environment variables not visible?
In-Reply-To: <BAA8906A.1FDDE%stevena@neosynapse.net>
References: <20030327080031.S42239-100000@eden.ispol.com> <BAA8906A.1FDDE%stevena@neosynapse.net>
Message-ID: <20030329025534.GB2171@legolas.on.net.mk>

>   SetEnv SYBASE /server/sybase/ASE_12501_2
>   SetEnv LD_LIBRARY_PATH
> /server/sybase/ASE_12501_2/OCS-12_5/lib:/usr/local/lib
>   SetEnv SYBASE_OCS /server/sybase/ASE_12501_2/OCS-12_5
>   SetEnv SYBASE_ASE /server/sybase/ASE_12501_2/ASE-12_5
> 
> Note the SetEnv directives are used in addition to setting the environment
> with os.environ, but neither of these approaches work.  I am not familiar
> enough with the internals of mod_python, but it seems perhaps
> run_spyceModpy::spyceMain is the mon_python handler and perhaps it is
> somehow forgetting the environment variables.  Does this seem like a likely
> possibility to you?

I had a similar problem with Apache, PHP and ORACLE. I tried the SetEnv
approach too...

The catch is that SetEnv just sets some Apache-specific internal
environment - that has nothing to do with the UNIX/OS environment.

I've also tried to solve the problem by putting putenv("ORACLE_HOME=...") 
in the PHP code. And with that sometimes it worked and sometimes it
didn't. 

Last I've found that I must set the environment prior to starting the 
apache process. I've ended up with:

    env - ORACLE_HOME=/usr/share/oracle \
           /usr/sbin/apachectl start

in my "/etc/rc.d/rc.httpd" script, and a note to everyone never to call 
"apachectl" directly but to always call "/etc/rc.d/rc.httpd".

In the end the conclusion is that these proprietary products SUCK, it so
much simpler with MySQL or PostgreSQL.



-- 
Damjan Georgievski

From frank at fejes.net  Fri Mar 28 23:14:12 2003
From: frank at fejes.net (Frank S. Fejes III)
Date: Fri Jan  9 21:59:57 2004
Subject: [mod_python] Why are you using mod_python?
In-Reply-To: <20030328172826.X67038-100000@eden.ispol.com>
References: <20030328075642.A25172@ash.int.ca.pason.com>
	<20030328172826.X67038-100000@eden.ispol.com>
Message-ID: <20030328231412.24efac21.frank@fejes.net>

Nobody has responded yet...I've been curious myself.  Personally, my primary
goal in using it (and other mod_* language modules) is to improve the
performance/scalability of my CGI applications.  Unfortunately, I really
dislike the Publisher handler's way of doing things (the
programname.py/method URL syntax feels silly to me) and it seems like most
people are very down on the capabilities and stability of the CGI handler so
I find myself just going plain CGI anyway for many things now when I use
python.

Not to start religious wars, but I find myself using and enjoying mod_ruby
the most of all the web development "environments".  It's simple to use for
the basics while maintaining a very neat and clear way of manipulating
requests and performing advanced tasks.  As an added bonus, eruby (inline
ruby ala asp/php) is nicely integrated.

On a somewhat tangential note, I think mod_python documentation reflects
strangely on what target audience might be interested in the module.  Almost
all introductions I've seen to mod_python begin with a tutorial on creating
a handler.  I'd venture a guess that writing handlers is what fewer than 1%
of web developers want to do with an apache module initially.  In my
experience, most people want to write some code and have it run faster than
it would run under straight CGI...they don't want to write custom handlers.

It's late and I'm tired so take everything I say with a grain of salt! :)

--frank

On Fri, 28 Mar 2003 17:38:48 -0500 (EST)
"Gregory (Grisha) Trubetskoy" <grisha@modpython.org> wrote:

> 
> Hello everyone -
> 
> As the original author of mod_python I think I'm allowed to jerk people's
> chains with this simple question:
> 
> Why are you using mod_python?
> 
> You can reply on or off list, either is fine. The results, after I get to
> mull over them will be published in one way or another.
> 
> I've decided to ask the list because I recently realized that I am not
> sure I know the answer. Not to say that I don't like mod_python, on the
> contrary, I do, but to formulate in words exactly why is rather difficult.
> Besides, my opinion is biased anyway :-)
> 
> Thanks in advance!
> 
> Grisha
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 

From pascalbarbedor at free.fr  Sat Mar 29 08:27:57 2003
From: pascalbarbedor at free.fr (pascal barbedor)
Date: Fri Jan  9 21:59:57 2004
Subject: Fw: [mod_python] Why are you using mod_python?
Message-ID: <002501c2f5c4$b8d35d10$118a933e@allalswqm99ewu>

----- Original Message -----
From: "pascal barbedor" <pascalbarbedor@free.fr>
To: "Gregory (Grisha) Trubetskoy" <grisha@modpython.org>
Sent: Saturday, March 29, 2003 8:03 AM
Subject: Re: [mod_python] Why are you using mod_python?


> Hi
>
>
> I am using it because it is simple and the documentation is clear and
> simple.
> Its only a little more effort compared to plain cgi and it is faster.
>
> also I use it bare bone, I don't use the publisher and I don't use any
> template system on top of mod_python.
> (I am not fond of template systems, I think req.write is enough)
> I find it modular and convenient to add one handler by directory and I
> usually rely on a directoryindex index.py
> to be able to call the handler simply with /myweb  without anything else,
> which is mapped to myweb/index.py by apache.
> this way I never call a .py file explicitely.
> each index.py is a dispatcher to other .py files in the same dir
> I also have a common directory with site wide classes and functions. and
> that's it.
>
> I use it on win32
> before python I was using perl/mod_perl but its not working very good on
> win32 yet for apache 2, at least I had core dumps related to libxml and so
I
> moved to python/mod_python, and stopped using libxslt or any xlst
transform
> , and now use only sax transform. its clearer than big xls stylesheets.
>
> I find that the documentation could contain more usage examples but is
good
> anyway.
> also the developing process is made uncomparabely better through the debug
> directive which outputs on the browser and the automatic reload of modules
>
> so that I don't see the difference compared to cgi developement, and I see
a
> difference in that I have the satisfaction to use a close to apache API
and
> it's fun.
>
> I must say when I tried the authentication exxample in the doc, I could
not
> make it work.
>
> but still the feeling is that it works very well, development is very
> confortable, and I am glad I tried it.
>
>
> thanks
> pascal
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
> ----- Original Message -----
> From: "Gregory (Grisha) Trubetskoy" <grisha@modpython.org>
> To: <mod_python@modpython.org>
> Sent: Friday, March 28, 2003 11:38 PM
> Subject: [mod_python] Why are you using mod_python?
>
>
> >
> > Hello everyone -
> >
> > As the original author of mod_python I think I'm allowed to jerk
people's
> > chains with this simple question:
> >
> > Why are you using mod_python?
> >
> > You can reply on or off list, either is fine. The results, after I get
to
> > mull over them will be published in one way or another.
> >
> > I've decided to ask the list because I recently realized that I am not
> > sure I know the answer. Not to say that I don't like mod_python, on the
> > contrary, I do, but to formulate in words exactly why is rather
difficult.
> > Besides, my opinion is biased anyway :-)
> >
> > Thanks in advance!
> >
> > Grisha
> >
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://www.modpython.org/mailman/listinfo/mod_python
> >
>


From stevehamilton at blueyonder.co.uk  Sat Mar 29 12:12:42 2003
From: stevehamilton at blueyonder.co.uk (Stephen Hamilton)
Date: Fri Jan  9 21:59:57 2004
Subject: [mod_python] Import Error (windows)
Message-ID: <000801c2f5ec$7fe2c450$0100a8c0@willem>

Python 2.2
Apache 2.0.44
mod_python-3.0.3.win32.exe

new to mod_python and list so be gentle with me

searched through the list and found similar probs but on different
platforms and versions
but no answers (probably me not looking hard enough)

anyway following tutorial and set httpd.conf as said :-

LoadModule python_module modules/mod_python.so

<Directory "C:\Program Files\Apache Group\Apache2\htdocs\test"> 
  AddHandler python-program .py
  PythonHandler mptest.py 
  PythonDebug On 
</Directory>
 
error reads:-
Mod_python error: "PythonHandler mptest.py"
Traceback (most recent call last):
  File "C:\Python22\Lib\site-packages\mod_python\apache.py", line 320, in HandlerDispatch
    module = import_module(module_name, config)
  File "C:\Python22\Lib\site-packages\mod_python\apache.py", line 496, in import_module
    f, p, d = imp.find_module(parts[i], path)

ImportError: No module named py

it's probably a simple answer but can anyone help
thanks in advance
stephen
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20030329/d7038de0/attachment-0002.htm
From pascalbarbedor at free.fr  Sat Mar 29 14:44:32 2003
From: pascalbarbedor at free.fr (pascal barbedor)
Date: Fri Jan  9 21:59:57 2004
Subject: [mod_python] Import Error (windows)
References: <000801c2f5ec$7fe2c450$0100a8c0@willem>
Message-ID: <000b01c2f5f9$54c28050$a8a1933e@allalswqm99ewu>

hi

maybe spaces in path is bad idea, plus forward slashes required

pascal
  ----- Original Message ----- 
  From: Stephen Hamilton 
  To: mod_python@modpython.org 
  Sent: Saturday, March 29, 2003 1:12 PM
  Subject: [mod_python] Import Error (windows)


  Python 2.2
  Apache 2.0.44
  mod_python-3.0.3.win32.exe

  new to mod_python and list so be gentle with me

  searched through the list and found similar probs but on different
  platforms and versions
  but no answers (probably me not looking hard enough)

  anyway following tutorial and set httpd.conf as said :-

  LoadModule python_module modules/mod_python.so

  <Directory "C:\Program Files\Apache Group\Apache2\htdocs\test"> 
    AddHandler python-program .py
    PythonHandler mptest.py 
    PythonDebug On 
  </Directory>
   
  error reads:-
  Mod_python error: "PythonHandler mptest.py"
  Traceback (most recent call last):
    File "C:\Python22\Lib\site-packages\mod_python\apache.py", line 320, in HandlerDispatch
      module = import_module(module_name, config)
    File "C:\Python22\Lib\site-packages\mod_python\apache.py", line 496, in import_module
      f, p, d = imp.find_module(parts[i], path)

  ImportError: No module named py

  it's probably a simple answer but can anyone help
  thanks in advance
  stephen
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20030329/6ec25c38/attachment-0002.htm
From dustin at ywlcs.org  Sat Mar 29 10:04:06 2003
From: dustin at ywlcs.org (Dustin Mitchell)
Date: Fri Jan  9 21:59:57 2004
Subject: [mod_python] Why are you using mod_python?
In-Reply-To: <20030328172826.X67038-100000@eden.ispol.com>
References: <20030328075642.A25172@ash.int.ca.pason.com> <20030328172826.X67038-100000@eden.ispol.com>
Message-ID: <20030329160405.GJ10000@eleanor.internal.ywlcs.org>

I use mod_python because it turns the web server into one very large
event-driven Python program.  I can do whatever I want with requests.  I can
parse URLs however I'd like.  I can construct the response however I'd like.
I have complete control over the transaction, without any hacks or other
impediments.

One of the advantages of having the web server act like a very large Python
program is its speed.  Also, from this frame of mind, caching and
preflighting are almost intuitive (if you've ever done SMP programming before
:-)

Dustin

-- 

  Dustin Mitchell
  dustin@ywlcs.org/djmitche@alumni.uchicago.edu
  http://people.cs.uchicago.edu/~dustin/

From neo at https.ru  Sat Mar 29 22:58:26 2003
From: neo at https.ru (Neo Eureka)
Date: Fri Jan  9 21:59:57 2004
Subject: [mod_python] Import Error (windows)
In-Reply-To: <000801c2f5ec$7fe2c450$0100a8c0@willem>
References: <000801c2f5ec$7fe2c450$0100a8c0@willem>
Message-ID: <245039446.20030329225826@https.ru>

 You should not add ".py" extension.
The correct line is:

 PythonHandler mptest


> Python 2.2
> Apache 2.0.44
> mod_python-3.0.3.win32.exe

> new to mod_python and list so be gentle with me

> searched through the list and found similar probs but on different
> platforms and versions
> but no answers (probably me not looking hard enough)

> anyway following tutorial and set httpd.conf as said :-

> LoadModule python_module modules/mod_python.so

> <Directory "C:\Program Files\Apache Group\Apache2\htdocs\test"> 
>   AddHandler python-program .py
>   PythonHandler mptest.py 
>   PythonDebug On 
> </Directory>
 
> error reads:-
> Mod_python error: "PythonHandler mptest.py"
> Traceback (most recent call last):
>   File "C:\Python22\Lib\site-packages\mod_python\apache.py", line 320, in HandlerDispatch
>     module = import_module(module_name, config)
>   File "C:\Python22\Lib\site-packages\mod_python\apache.py", line 496, in import_module
>     f, p, d = imp.find_module(parts[i], path)

> ImportError: No module named py

> it's probably a simple answer but can anyone help
> thanks in advance
> stephen


--- 
Neo Eureka / mailto:neo@https.ru


From stevehamilton at blueyonder.co.uk  Sat Mar 29 20:20:57 2003
From: stevehamilton at blueyonder.co.uk (Stephen Hamilton)
Date: Fri Jan  9 21:59:57 2004
Subject: [mod_python] re Import Error (windows)
Message-ID: <002d01c2f630$b54709f0$0100a8c0@willem>

update for other wooden heads like me 
without the ".py" it works a treat
thanks for the swift response and your patients
stephen   (8(|) doe


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20030329/e7ab7378/attachment-0002.htm
From ian at veryfresh.com  Sat Mar 29 16:46:45 2003
From: ian at veryfresh.com (Ian Clelland)
Date: Fri Jan  9 21:59:57 2004
Subject: [mod_python] Why are you using mod_python?
In-Reply-To: <20030328231412.24efac21.frank@fejes.net>
References: <20030328075642.A25172@ash.int.ca.pason.com> <20030328172826.X67038-100000@eden.ispol.com> <20030328231412.24efac21.frank@fejes.net>
Message-ID: <20030330004644.GA17569@fullfactor.com>

On Fri, Mar 28, 2003 at 11:14:12PM -0600, Frank S. Fejes III wrote:
> On Fri, 28 Mar 2003 17:38:48 -0500 (EST)
> "Gregory (Grisha) Trubetskoy" <grisha@modpython.org> wrote:
> 
> > 
> > Hello everyone -
> > 
> > As the original author of mod_python I think I'm allowed to jerk people's
> > chains with this simple question:
> > 
> > Why are you using mod_python?

...

> On a somewhat tangential note, I think mod_python documentation reflects
> strangely on what target audience might be interested in the module.  Almost
> all introductions I've seen to mod_python begin with a tutorial on creating
> a handler.  I'd venture a guess that writing handlers is what fewer than 1%
> of web developers want to do with an apache module initially.  In my
> experience, most people want to write some code and have it run faster than
> it would run under straight CGI...they don't want to write custom handlers.

Well, I suppose I must be counted among that 1% :) I switched to
mod_python from PHP and Servlets about <checks CVS> 8 or 9 months ago,
and it was primarily because of the flexibility and power of cutsom
handlers. I love the fact that I can write applications whose URLs have
some meaning besides simply naming a file on the web server's hard
drive.

When I was first introduced to mod_python, I imagined it to be simply a
way to embed python code inline into HTML files (like PHP or JSP,) and I
nearly dismissed it out of hand. I looked at it more carefully, though,
and when I realised that it was more akin to mod_perl, and would
actually give me an opportunity to interact so closely with Apache, I
became much more excited working with it.

Since then, I have adopted many of the tenets of the REST philosophy,
and I have found mod_python to be an ideal platform to develop REST-ful
applications. I doubt I could even go back to the CGI or PHP ways of
doing things now.


But then, that might just be me :)


Ian Clelland
<ian@veryfresh.com>

From peter.bittner at gmx.net  Sun Mar 30 22:55:55 2003
From: peter.bittner at gmx.net (Peter Bittner)
Date: Fri Jan  9 21:59:57 2004
Subject: [mod_python] Why are you using mod_python?
Message-ID: <18707.1049057755@www41.gmx.net>

Hi there!

I like mod_python because I like Python and I am glad whenever I can use it
to write web applications. Customers, however, in most cases ask me to go for
PHP or so since this is easier to find programmers for for maintenance
afterwards.

> Personally, my primary goal in using it (and other mod_* language
> modules) is to improve the performance/scalability of my CGI applications.

This is true for me, too.

> Unfortunately, I really dislike the Publisher handler's way of doing
things
> (the programname.py/method URL syntax feels silly to me) and it seems
> like most people are very down on the capabilities and stability of the
> CGI handler so I find myself just going plain CGI anyway for many things
> now when I use python.

This is absolutely true for myself, too. Clearly, I would appreciate
mod_python to have nothing but advantages, but it does have those unconfortable
features.

> Almost all introductions I've seen to mod_python begin with a
> tutorial on creating a handler.  I'd venture a guess that writing
> handlers is what fewer than 1% of web developers want to do
> with an apache module initially.  In my experience, most people
> want to write some code and have it run faster than it would run
> under straight CGI...they don't want to write custom handlers.

I absolutely agree. This is my opinion, too.

I also do not see why modifying the webserver's (Apache's) configuration
should be advantagous when I, say, add a new directory to my web project. When I
want to write, say, a website, I do not want to go into /etc/apache.conf (I
might not even have access to it!), but I want to go straight into coding.
And porting this code to another webserver should not be a nightmare, but a job
of copying the .py files, that's it.

I like Python and I'd be happy to see mod_python becoming as popular for web
programming as PHP is today.

Cheers, Peter

-- 
Peter Bittner
mail: peter.bittner@gmx.net

"Free software is like free speech, not free beer" (Richard Stallman)

+++ GMX - Mail, Messaging & more  http://www.gmx.net +++
Bitte l?cheln! Fotogalerie online mit GMX ohne eigene Homepage!


From mike.looijmans at asml.com  Mon Mar 31 07:35:36 2003
From: mike.looijmans at asml.com (Mike Looijmans)
Date: Fri Jan  9 21:59:57 2004
Subject: [mod_python] Why are you using mod_python?
Message-ID: <01c2f747$5aecc400$926a1e6e@wsasd464>

Simple: There were a few dozen clients when we started this project. There
will be about 400 when we roll it out worldwide, and I didn't want the server
to spend too much time loading the interpreter for each call.
With CGI, it could process about 2 requests per second. With mod_python, that
increased to over 20 per second.

Keeping database connections alive and some internal caching were nice things
to add (I like a bit of multithreaded programming), but did not add any
measurable performance gains (I guess the Python-MySQL link is just too fast
when all is local).

Our system is now hybrid - servers can either use CGI or mod_python (bot if
they like). But I did not use cgihandler because it also took quite a
performance hit because of reloading a lot of libraries, and after a few dozen
requests the cgi library would lose the os.environ and a restart of the server
would be neccesary to get things going again. Also, cgihandler does not
combine well with Apache's "worker" thread model, cgihandler turns the whole
system into a single-threaded server in that particular case.

--
Mike Looijmans
ASML: http://www5nl.asml.nl/~mlooijma
Private: http://www.milosoftware.com

-----Original Message-----
From: Gregory (Grisha) Trubetskoy <grisha@modpython.org>
To: mod_python@modpython.org <mod_python@modpython.org>
Date: Saturday, March 29, 2003 12:42 AM
Subject: [mod_python] Why are you using mod_python?


>
>Hello everyone -
>
>As the original author of mod_python I think I'm allowed to jerk people's
>chains with this simple question:
>
>Why are you using mod_python?
>



From sandor.kopanyi at mailbox.hu  Mon Mar 31 08:57:35 2003
From: sandor.kopanyi at mailbox.hu (sandor.kopanyi@mailbox.hu)
Date: Fri Jan  9 21:59:57 2004
Subject: [mod_python] Re: Why are you using mod_python?
In-Reply-To: <20030329170001.80558.66529.Mailman@eden.ispol.com>
Message-ID: <20030331065735.16655.qmail@arnold.mailbox.hu>

Hi,

I'm using mod_python because of:
- simplicity
- elegance of Python
- rich Python libs
- quick development

/Sandor
PS. I don't have anything against publisher, I use it regurarly, beside
the other ways


_______________________________________________________________________
http://mailbox.hu - WAP-on is olvashatod




From mike at mikesclutter.com  Sat Mar  1 11:07:23 2003
From: mike at mikesclutter.com (Michael Owens)
Date: Fri Jan  9 22:03:45 2004
Subject: [mod_python] Problem with C extension type
Message-ID: <200303011107.23400.mike@mikesclutter.com>

This is a rather intricate problem, but I don't know where else to go. I have 
a C extension in which I created a native Python type, call it X, which has 
two methods: A() and B(). Then I create a Python class, derived from X type, 
called Y, which has has two methods C() and D(). Y is defined as follows 
(cmod is my C extension in which X is implemented)

from cmod import X

class Y(X):
  
    def __new__(cls, db):
        return super(Y, cls).__new__(cls)

    def C():
	print "C()"

    def D():
	print "D()"

If I call Y.A() from a normal python script, there is no problem --- it 
resolved to X.A(). But if I do this inside of mod_python, I get an error 
saying that object Y has no such attribute A. I don't understand why 
mod_python would be any different in attribute resolution than Python would 
be since it is using the same Python implementation/library. I am using 
Python 2.2.2 and mod_python 3.0.1 in Apache 2.x.

Any ideas?

Michael Owens.

From jermnsar at hotmail.com  Sat Mar  1 20:04:23 2003
From: jermnsar at hotmail.com (Jeremy Lowery)
Date: Fri Jan  9 22:03:45 2004
Subject: [mod_python] Full Path Info on Request object
Message-ID: <F138mnSA3oZs7pKy2uh0001dc06@hotmail.com>

Hello,

I'm writing my own publisher, and I don't understand why mod_python doesn't 
include the full pathname in the req.filename attribute.

In my .htaccess

SetHandler python-program
# My Custom Publisher in this directory
PythonHandler ServletPublisher
PythonDebug On

I make a request:
http://localhost/~jermnsar/foo/bar/test/hmm?dat=val&val2=dat2

and printing out the variables:

req.uri /~jermnsar/foo/bar/test/hmm
req.filename C:/Documents and Settings/jermnsar/My Documents/My Website/foo


What would be an easy way to resolve to
C:/Documents and Settings/jermnsar/My Documents/My Website/foo/bar/test/hmm

or at least easily extract the /bar/test/hmm

Would be easy to do with some string manip I suppose, but I'm looking for 
faster (i.e. quicker CPU wise) way.

Why does the translation from the web path to the physical path only include 
the first element?

Windows XPsp1/Apache 2.0.44/mod_python 3.0.1

Thanks
Jeremy S Lowery






_________________________________________________________________
MSN 8 helps eliminate e-mail viruses. Get 2 months FREE*.  
http://join.msn.com/?page=features/virus


From mike at mikesclutter.com  Mon Mar  3 17:26:37 2003
From: mike at mikesclutter.com (Michael Owens)
Date: Fri Jan  9 22:03:45 2004
Subject: [mod_python] Problem with C extension type
In-Reply-To: <200303011107.23400.mike@mikesclutter.com>
References: <200303011107.23400.mike@mikesclutter.com>
Message-ID: <200303031726.37382.mike@mikesclutter.com>

As a matter of interest, I found what was wrong (sort of). My C type's (X's) 
tp_getattro implementation was screwy. When I replaced it with 
PyObject_GenericGetAttr, everything worked fine in mod_python. I still don't 
know why the original implementation worked in Python and not in mod_python, 
but I don't care so long as it works now.

On Saturday 01 March 2003 11:07 am, Michael Owens wrote:
> This is a rather intricate problem, but I don't know where else to go. I
> have a C extension in which I created a native Python type, call it X,
> which has two methods: A() and B(). Then I create a Python class, derived
> from X type, called Y, which has has two methods C() and D(). Y is defined
> as follows (cmod is my C extension in which X is implemented)
>
> from cmod import X
>
> class Y(X):
>
>     def __new__(cls, db):
>         return super(Y, cls).__new__(cls)
>
>     def C():
> 	print "C()"
>
>     def D():
> 	print "D()"
>
> If I call Y.A() from a normal python script, there is no problem --- it
> resolved to X.A(). But if I do this inside of mod_python, I get an error
> saying that object Y has no such attribute A. I don't understand why
> mod_python would be any different in attribute resolution than Python would
> be since it is using the same Python implementation/library. I am using
> Python 2.2.2 and mod_python 3.0.1 in Apache 2.x.
>
> Any ideas?
>
> Michael Owens.
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

From mark at camazotz.com  Wed Mar  5 23:19:09 2003
From: mark at camazotz.com (Mark Smith)
Date: Fri Jan  9 22:03:45 2004
Subject: [mod_python] mod_python 3.0, Apache 2.0, OS X 10.2
Message-ID: <C6F0BB52-4F8A-11D7-ABDE-00039364CE50@camazotz.com>

Has anyone succeeded in building mod_python 3 on Apache 2 under OS X?  
Last time it was discussed was November last year:

http://www.modpython.org/pipermail/mod_python/2002-November/002652.html

thanks,
Mark


From grisha at modpython.org  Thu Mar  6 00:35:26 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:45 2004
Subject: [mod_python] mod_python 3.0, Apache 2.0, OS X 10.2
In-Reply-To: <C6F0BB52-4F8A-11D7-ABDE-00039364CE50@camazotz.com>
Message-ID: <20030306003346.D12356-100000@eden.ispol.com>

It builds and runs just fine undex OS X, you should have at least mp 3.0.1
and better yet the latest sources from CVS, and make sure to check out the
README, it has some OS X instructions in it.

Grisha

On Wed, 5 Mar 2003, Mark Smith wrote:

> Has anyone succeeded in building mod_python 3 on Apache 2 under OS X?
> Last time it was discussed was November last year:
>
> http://www.modpython.org/pipermail/mod_python/2002-November/002652.html
>
> thanks,
> Mark
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From pascalbarbedor at free.fr  Fri Mar  7 00:19:59 2003
From: pascalbarbedor at free.fr (pascal barbedor)
Date: Fri Jan  9 22:03:45 2004
Subject: [mod_python] req.user stays None in authen
Message-ID: <002101c2e436$e8c50c70$908b933e@allalswqm99ewu>

Hi on win 32 with python 2.2.2, installed last version 3.01, added missing mscvrt70.dll
and everything works great!


I wanted to try out the doc tutorial 
<Directory /mywebdir>
AddHandler python-program .py
PythonHandler myscript
PythonAuthenHandler myscript
PythonDebug On
AuthType Basic
AuthName "Restricted Area"
require valid-user
</Directory>

with script

from mod_python import apache
def authenhandler(req):
user = req.user
pw = req.get_basic_auth_pw()
if user == "spam" and pw == "eggs":
return apache.OK
else:
return apache.HTTP_UNAUTHORIZED

it works but req.user is always None
I printed user, pw to apache log and got None eggs
ie password is well passed, but not user
so the authentication results in neverending pop up login window

I checked from mozilla and opera browser


thanks for any help








-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20030307/9852e6fb/attachment-0003.htm
From pmguerre at ualg.pt  Mon Mar 10 20:30:34 2003
From: pmguerre at ualg.pt (Pedro Guerreiro)
Date: Fri Jan  9 22:03:45 2004
Subject: [mod_python] Installing mod_python 3.0.1 in Windows
Message-ID: <20030310202756.F238C4BE80@smtp.ualg.pt>

Hi.

Why was the instructions on how to install mod_python in windows removed from 
the 3.0 documentation? AFAIK in the previous release there was instructions 
on how to do this...

Also, why isn't _anywhere_ (AFAICT) a reference that you _also_ need the Unix 
source (from mod_python-x.tgz) to install it in Windows? From 
http://httpd.apache.org/modules/python-download.cgi one gets the ideia that 
to install it in Windows only the python2.2.2-apache2.0.43.zip is needed?

And finally, why isn't documented that one need msvcr70.dll (not everyone has 
Microsoft Visual _whatever_ installed) to run mod_python?

To resume, please make some documentation on how to install the new 
mod_python on the windows platform, so that someone does go away because 
he/she cannot put mod_python to work... Or at least put up some link to 
http://www.modpython.org/pipermail/mod_python/2002-December/002714.html, and 
to http://www.modpython.org/live/mod_python-2.7.8/doc-html/app-wininst.html

Thanks, and keep up the good work.

	-pmg

From sury.ondrej at globe.cz  Tue Mar 11 11:32:21 2003
From: sury.ondrej at globe.cz (Ondrej Sury)
Date: Fri Jan  9 22:03:45 2004
Subject: [mod_python] session management in mod_python
Message-ID: <87bs0ib3d6.fsf@globe.cz>

Since I still haven't found what I am looking for ;-) (no, I have found
search page for mailing list archive), I just want to ask if there is some
module which is solving /subj. (something like php has) ie. setting session
cookie, loading session variables etc.

O.

-- 
Ondrej Sury - CIO                   Globe Internet s.r.o. http://globe.cz/
Tel: +420(2)35365000 Fax: +420(2)35365009     Planickova 1, 162 00 Praha 6

From lyager at phunkbros.dk  Tue Mar 11 12:18:05 2003
From: lyager at phunkbros.dk (Jesper L. Nielsen)
Date: Fri Jan  9 22:03:45 2004
Subject: [mod_python] session management in mod_python
In-Reply-To: <87bs0ib3d6.fsf@globe.cz>
References: <87bs0ib3d6.fsf@globe.cz>
Message-ID: <20030311111805.GA2976@home.phunkbros.dk>

* Ondrej Sury (sury.ondrej@globe.cz) [2003-03-11 11:03]:
> Since I still haven't found what I am looking for ;-) (no, I have found
> search page for mailing list archive), I just want to ask if there is some
> module which is solving /subj. (something like php has) ie. setting session
> cookie, loading session variables etc.

Personally I'm pretty happy with PyWebLib
(http://www.stroeder.com/pylib/PyWebLib/), which is very customize-able 
:) .  I'm sure, though, that there are many other possibilities.

--
Jesper L. Nielsen
http://phunkbros.dk

From cjackson at spsu.edu  Tue Mar 11 16:10:03 2003
From: cjackson at spsu.edu (Chris Jackson)
Date: Fri Jan  9 22:03:45 2004
Subject: [mod_python] prototype 3.0.3
Message-ID: <000201c2e812$9572f6b0$5f05010a@moxie>

+1
 
moxie
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20030311/456a779e/attachment-0003.htm
From grisha at modpython.org  Wed Mar 12 10:18:38 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:45 2004
Subject: [mod_python] prototype 3.0.3
In-Reply-To: <000201c2e812$9572f6b0$5f05010a@moxie>
Message-ID: <20030312101758.F18937-100000@eden.ispol.com>

Thanks

I've been kinda swamped lately, but I'll try to put it out there today or
tomorrow.

Grisha

On Tue, 11 Mar 2003, Chris Jackson wrote:

> +1
>
> moxie
>


From neel at mediapulse.com  Wed Mar 12 10:57:25 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:03:45 2004
Subject: [mod_python] Fixup hander not always being called
Message-ID: <C0FC22C08B82074A88B50061764157775C0C@johnson.mediapulse.net>

I have some mod perl code I'm trying to move over to modpython.  The
perl code adds a cookie header to all requests using the fixup phase,
and then logs some info in the logging phase.  When I setup python to do
the same, the fixup handler is not always called.  It looks like it is
related to cgi scripts, as when I hit a cgi page in the web browser, my
fixup handler is not called - but it will call the perl version.

My conf has:

    <Location />
        #SetHandler python-program
        PythonLogHandler qlog
        PythonFixupHandler qlog
        PythonDebug On
    </Location>

I've commented out the SetHandler because that would break cgi scripts
(causing the text of the script to be sent to the browser, instead of
executing it).  This is the same with mod_perl, you can't use the
SetHandler.

qlog.py (simplified):

from mod_python import apache

def fixuphandler(req):

    apache.log_error("----------- New Hit -----------")
    apache.log_error("CT: " + str(req.content_type))

def loghandler(req):

    apache.log_error("----------- Log Hit -----------")


Any insights?  I'd like to do the new version of this code in python,
and not perl, but I gotta get this cgi snafu solved.

Thanks,
Mike


From neel at mediapulse.com  Wed Mar 12 13:34:23 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:03:45 2004
Subject: [mod_python] Fixup hander not always being called
Message-ID: <C0FC22C08B82074A88B50061764157772C654C@johnson.mediapulse.net>

Sctratch the below.  It looks like the function apache.log_error()
doesn't always work, so my method of testing the handler was flawed.  I
used Sam Spade to watch headers, and my cookies are being added, even
though the calls to the error_log are not printing.

Also, I left off I'm using 2.7.8 on Apache 1.3.26

Thanks,
Mike

-----Original Message-----
From: Michael C. Neel 
Sent: Wednesday, March 12, 2003 10:57 AM
To: mod_python@modpython.org
Subject: [mod_python] Fixup hander not always being called


I have some mod perl code I'm trying to move over to modpython.  The
perl code adds a cookie header to all requests using the fixup phase,
and then logs some info in the logging phase.  When I setup python to do
the same, the fixup handler is not always called.  It looks like it is
related to cgi scripts, as when I hit a cgi page in the web browser, my
fixup handler is not called - but it will call the perl version.

My conf has:

    <Location />
        #SetHandler python-program
        PythonLogHandler qlog
        PythonFixupHandler qlog
        PythonDebug On
    </Location>

I've commented out the SetHandler because that would break cgi scripts
(causing the text of the script to be sent to the browser, instead of
executing it).  This is the same with mod_perl, you can't use the
SetHandler.

qlog.py (simplified):

from mod_python import apache

def fixuphandler(req):

    apache.log_error("----------- New Hit -----------")
    apache.log_error("CT: " + str(req.content_type))

def loghandler(req):

    apache.log_error("----------- Log Hit -----------")


Any insights?  I'd like to do the new version of this code in python,
and not perl, but I gotta get this cgi snafu solved.

Thanks,
Mike

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python


From grisha at apache.org  Mon Mar 17 10:49:27 2003
From: grisha at apache.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:45 2004
Subject: [mod_python] ANNOUNCE: Mod_python 3.0.3
In-Reply-To: <20021127135855.Q36516-100000@eden.ispol.com>
Message-ID: <20030317103105.X92188-100000@eden.ispol.com>

The Apache Software Foundation and The Apache HTTP Server Project are
pleased to announce the release of mod_python 3.0.3.

Mod_python is an Apache HTTP Server module that embeds the Python
interpreter within the server. With mod_python you can write web-based
applications in Python that will run many times faster than traditional
CGI and will have access to advanced features such as ability to retain
database connections between requests, access to httpd internals and
provide content filter as well as connection handlers.

This release fixes numerous bugs identified after last release (3.0.1). It
is highly recommended that you upgrade to version 3.0.3 for improved
stability and performance.

Mod_python is available for download from:

http://httpd.apache.org/modules/python-download.cgi

For more information about mod_python visit:

http://www.modpython.org/

Regards,

Grisha Trubetskoy


From mike.looijmans at asml.com  Tue Mar 18 08:07:14 2003
From: mike.looijmans at asml.com (Mike Looijmans)
Date: Fri Jan  9 22:03:45 2004
Subject: [mod_python] ANNOUNCE: Mod_python 3.0.3
Message-ID: <01c2ed1d$009e3d00$926a1e6e@wsasd464>

Hmm. Had some troubles running this baby after the ./configure - smake - smake
install dance. Turned out to be a file permission problem.
The following occured in the apache error log:

[Tue Mar 18 07:56:33 2003] [notice] Apache/2.0.44 (Unix) mod_python/3.0.3
Python/2.2.2 configured -- resuming normal operations
[Tue Mar 18 07:56:35 2003] [error] make_obcallback: could not import
mod_python.apache.

ImportError: No module named apache
[Tue Mar 18 07:57:01 2003] [error] make_obcallback: could not import
mod_python.apache.


The problem was that in /usr/local/lib/python2.2/site-package/mod_pyton, all
files were root-only (pun intented) after installation (mode 600). Would be
nice if the install script forced to 644 mode instead. The apache server runs
as user "nobody" so didn't get access.

--
Mike Looijmans
ASML: http://www5nl.asml.nl/~mlooijma
Private: http://www.milosoftware.com

-----Original Message-----
From: Gregory (Grisha) Trubetskoy <grisha@apache.org>


>
>The Apache Software Foundation and The Apache HTTP Server Project are
>pleased to announce the release of mod_python 3.0.3.



From graeme_matthew at hotmail.com  Tue Mar 18 23:05:21 2003
From: graeme_matthew at hotmail.com (Graeme Matthew)
Date: Fri Jan  9 22:03:45 2004
Subject: [mod_python] Cant get modPython working
Message-ID: <BAY1-F12ATiyhGvDpED000327a4@hotmail.com>

Hi all, im pulling out my 7pm brown hair that is now almost grey !!!!!

I have followed the instructions to get mod_python working on Win32 (XP)

I have edited my conf file as follows:

LoadModule python_module modules/mod_python.so

#added handler directives in scriptalias
<Directory "C:/Program Files/Apache Group/Apache2/cgi-bin">
    AllowOverride None
    Options None
    Order allow,deny
    Allow from all
    AddHandler python-program .py
    PythonHandler mptest
    PythonDebug On
</Directory>

I have placed mptest.py in my cgi-bin folder it contains the following:


from mod_python import apache

def handler(req):
    req.write("Content-type: text/html\n\nHello World!")
    return apache.OK

I keep on getting a HTTP 500 Internal Server Error and cant understand why 
as the log file does not seem to contain the error.

Any help would be much appreciated

Thanks


Graeme

_________________________________________________________________
MSN Instant Messenger now available on Australian mobile phones. Go to  
http://ninemsn.com.au/mobilecentral/hotmail_messenger.asp


From graeme_matthew at hotmail.com  Wed Mar 19 00:07:44 2003
From: graeme_matthew at hotmail.com (Graeme Matthew)
Date: Fri Jan  9 22:03:45 2004
Subject: [mod_python] ModPython working, but multiple handlers ?
Message-ID: <BAY1-F66Hy3SpwBGpEI00000f34@hotmail.com>

Hi all, finally got it working, so please ignore my previous request ...

my last issue before bead is adding multiple handlers

if I do the following:

PythonHandler mptest
PythonHandler app

then my app also prints out mptest within the webpage

If anyone has experienced this then i would like to hear how you solved it, 
as soon as I take mptest out, the problem is removed

Regards


Graeme




_________________________________________________________________
Hotmail now available on Australian mobile phones. Go to  
http://ninemsn.com.au/mobilecentral/hotmail_mobile.asp


From grisha at modpython.org  Tue Mar 18 11:16:15 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:45 2004
Subject: [mod_python] ModPython working, but multiple handlers ?
In-Reply-To: <BAY1-F66Hy3SpwBGpEI00000f34@hotmail.com>
Message-ID: <20030318111340.Q7557-100000@eden.ispol.com>

There can only be one PythonHandler and subsequent directives will
override previous, so the net effect of your config below is
"PythonHandler app".

If I understand what you're trying to do, you should look at the manual
and read about the Publisher handler in the tutorial.

Grisha

On Wed, 19 Mar 2003, Graeme Matthew wrote:

>
> Hi all, finally got it working, so please ignore my previous request ...
>
> my last issue before bead is adding multiple handlers
>
> if I do the following:
>
> PythonHandler mptest
> PythonHandler app
>
> then my app also prints out mptest within the webpage
>
> If anyone has experienced this then i would like to hear how you solved it,
> as soon as I take mptest out, the problem is removed
>
> Regards
>
>
> Graeme
>
>
>
>
> _________________________________________________________________
> Hotmail now available on Australian mobile phones. Go to
> http://ninemsn.com.au/mobilecentral/hotmail_mobile.asp
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From mtaylor at real.com  Thu Mar 20 14:07:42 2003
From: mtaylor at real.com (Mark Taylor)
Date: Fri Jan  9 22:03:45 2004
Subject: [mod_python] has anyone successfully built mod_python3.03 on OpenBSD?
Message-ID: <Pine.LNX.4.21.0303201358360.2164-100000@lothlorien.coreqa.prognet.com>

I've been using OpenBSD3.2, apache2.0.43 and python2.2.1

apxs is not building mod_python.so.  I've found similar plaints in the
threads, but no solutions.

-- 
Mark Taylor

Real Networks
Systems Administrator
Developer Services Group - Technical Operations

http://votetoimpeach.org/


From drh9296 at ritvax.rit.edu  Thu Mar 20 18:29:21 2003
From: drh9296 at ritvax.rit.edu (David Higgs)
Date: Fri Jan  9 22:03:45 2004
Subject: [mod_python] has anyone successfully built mod_python3.03 on
 OpenBSD?
References: 
 <Pine.LNX.4.21.0303201358360.2164-100000@lothlorien.coreqa.prognet.com>
Message-ID: <3E7A4ED1.9000909@rit.edu>

I haven't got around to getting mod_python working on my setup yet, but 
here's a heads-up...

There's a good chance that OpenBSD3.2's apache2 is chrooted to 
/var/www/, just like the default apache1.x.  You'll have to have a 
separate python install within /var/www/ or disable the chroot.

Can you paste the specific problems you're getting?  Maybe someone can 
help you out.

--david

Mark Taylor wrote:
> I've been using OpenBSD3.2, apache2.0.43 and python2.2.1
> 
> apxs is not building mod_python.so.  I've found similar plaints in the
> threads, but no solutions.


From mtaylor at real.com  Thu Mar 20 17:03:56 2003
From: mtaylor at real.com (Mark Taylor)
Date: Fri Jan  9 22:03:45 2004
Subject: [mod_python] has anyone successfully built mod_python3.03 on
 OpenBSD?
In-Reply-To: <3E7A4ED1.9000909@rit.edu>
Message-ID: <Pine.LNX.4.21.0303201653020.2164-100000@lothlorien.coreqa.prognet.com>

./configure --with-apxs=<location of apxs>  goes normally, without error.
running 'make' then goes normally until the end, when we get this output:

*** Warning: inter-library dependencies are not known to be supported.
*** All declared inter-library dependencies are being dropped.

*** Warning: libtool could not satisfy all declared inter-library
*** dependencies of module libmod_python.  Therefore, libtool will create
*** a static module, that should work as long as the dlopening
*** application is linked with the -dlopen flag.

Now su and make install
  (or, if you only want to perform a partial install,
   you can use make install_dso and make install_py_lib)

Source distribution found

...

# make install

Compiling for DSO.

...

Performing DSO installation.

/usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
install: src/mod_python.so: No such file or directory
*** Error code 71

Stop in /tmp/mod_python-3.0.3 (line 94 of Makefile).
*** Error code 1

Stop in /tmp/mod_python-3.0.3 (line 91 of Makefile).


AND, in fact, the link in ./src is broken.  there is no mod_python.so in
./src/.libs/ 

# ls src/.libs
libmod_python.a mod_python.la   mod_python.lai

???

mt

On Thu, 20 Mar 2003, David Higgs wrote:

> I haven't got around to getting mod_python working on my setup yet, but 
> here's a heads-up...
> 
> There's a good chance that OpenBSD3.2's apache2 is chrooted to 
> /var/www/, just like the default apache1.x.  You'll have to have a 
> separate python install within /var/www/ or disable the chroot.
> 
> Can you paste the specific problems you're getting?  Maybe someone can 
> help you out.
> 
> --david
> 
> Mark Taylor wrote:
> > I've been using OpenBSD3.2, apache2.0.43 and python2.2.1
> > 
> > apxs is not building mod_python.so.  I've found similar plaints in the
> > threads, but no solutions.
> 

-- 
Mark Taylor

Real Networks
Systems Administrator
Developer Services Group - Technical Operations

http://votetoimpeach.org/


From grisha at modpython.org  Thu Mar 20 23:46:47 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:45 2004
Subject: [mod_python] has anyone successfully built mod_python3.03 on
 OpenBSD?
In-Reply-To: <Pine.LNX.4.21.0303201653020.2164-100000@lothlorien.coreqa.prognet.com>
Message-ID: <20030320233453.O44142-100000@eden.ispol.com>

I am OpenBSD ignorant, but on FreeBSD it builds without a hinch (it also
builds on Darwin which has its own different set of complications).

This message usually means libtool is complaining that it won't build an
.so out of static libraries.

On all other OS's I've seen it this was resolvable by upgrading to latest
libtool where this restriction has been lifted.

Another solution is to build pythonlib as an .so - Python does not
directly support this, but it has been reported to work fine if done
manually with something like (YMMV):

mkdir .extract
cd .extract
ar xv ../libpython2.2.a
cd ..
gcc -shared -o libpython2.2.so.0 .extract/*.o
rm -rf .extract

Grisha

On Thu, 20 Mar 2003, Mark Taylor wrote:

>
> ./configure --with-apxs=<location of apxs>  goes normally, without error.
> running 'make' then goes normally until the end, when we get this output:
>
> *** Warning: inter-library dependencies are not known to be supported.
> *** All declared inter-library dependencies are being dropped.
>
> *** Warning: libtool could not satisfy all declared inter-library
> *** dependencies of module libmod_python.  Therefore, libtool will create
> *** a static module, that should work as long as the dlopening
> *** application is linked with the -dlopen flag.
>
> Now su and make install
>   (or, if you only want to perform a partial install,
>    you can use make install_dso and make install_py_lib)
>
> Source distribution found
>
> ...
>
> # make install
>
> Compiling for DSO.
>
> ...
>
> Performing DSO installation.
>
> /usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
> install: src/mod_python.so: No such file or directory
> *** Error code 71
>
> Stop in /tmp/mod_python-3.0.3 (line 94 of Makefile).
> *** Error code 1
>
> Stop in /tmp/mod_python-3.0.3 (line 91 of Makefile).
>
>
> AND, in fact, the link in ./src is broken.  there is no mod_python.so in
> ./src/.libs/
>
> # ls src/.libs
> libmod_python.a mod_python.la   mod_python.lai
>
> ???
>
> mt
>
> On Thu, 20 Mar 2003, David Higgs wrote:
>
> > I haven't got around to getting mod_python working on my setup yet, but
> > here's a heads-up...
> >
> > There's a good chance that OpenBSD3.2's apache2 is chrooted to
> > /var/www/, just like the default apache1.x.  You'll have to have a
> > separate python install within /var/www/ or disable the chroot.
> >
> > Can you paste the specific problems you're getting?  Maybe someone can
> > help you out.
> >
> > --david
> >
> > Mark Taylor wrote:
> > > I've been using OpenBSD3.2, apache2.0.43 and python2.2.1
> > >
> > > apxs is not building mod_python.so.  I've found similar plaints in the
> > > threads, but no solutions.
> >
>
> --
> Mark Taylor
>
> Real Networks
> Systems Administrator
> Developer Services Group - Technical Operations
>
> http://votetoimpeach.org/
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From mike.looijmans at asml.com  Fri Mar 21 07:35:40 2003
From: mike.looijmans at asml.com (Mike Looijmans)
Date: Fri Jan  9 22:03:45 2004
Subject: [mod_python] Success: PythonCGI (not the other way)
Message-ID: <01c2ef74$16f20600$926a1e6e@wsasd464>

Since not all our servers are Apache 2.0.xx yet, and mod_python isn't
available on those, I wanted to remain compatible with the CGI interface.

But sacrificing performance by using the cgihandler (which made the server
effectively single-threaded because of the stdout sharing) did not seem a good
idea.

Instead, I put it the other way around. The native connection mode is
mod_python, and I let the CGI handler simulate the Request interface. By not
using too big a subset, I managed to quite easily do this. The net effect is
that the mod_python script now run much faster than the cgihandler conversion
I used first, and the CGI still works at roughly the same speed (the impact on
performance by creating the Request object is neglegible. The main part of the
code is below.

Each module has a main() function, that takes some parameters. One can use
"main(req, form)" for example, or "main(req, db, auth, form)". The main must
write to req.write(..) just like a mod_python script would. The script does
not know whether it's run from CGI or mod_python.

Comments are welcome!

##
class Request:
    def __init__(self):
        environ = os.environ
        self.subprocess_env = environ
        self.content_type = "text/plain"
        self.status = 200
        self.args = environ.get('QUERY_STRING', '')
        self.path_info = environ.get('PATH_INFO', '')
        self.method  = environ['REQUEST_METHOD']
        self.unparsed_uri = environ['REQUEST_URI']
        self.uri = environ['SCRIPT_NAME']
        self.content_length = -1
        self._headed = 0
        self.headers_out = self
        self.headers = ""
        self.read = sys.stdin.read
        hin = {}
        v = environ.get('HTTP_REFERER', '')
        hin['Referer'] = v
        hin['referer'] = v
        if environ.has_key('HTTP_COOKIE'):
            v = environ['HTTP_COOKIE']
            hin['Cookie'] = v
            hin['cookie'] = v
        self.headers_in = hin
    def add(self, key, value):
        self.headers += '%s: %s\n' % (key, value)
    def set_content_length(self, len):
        self.content_length = len
    def _writeheaders(self):
        self._headed = 1
        sys.stdout.write('status: %s\n' % self.status)
        sys.stdout.write('Content-Type: %s\n' % self.content_type)
        if self.content_length >= 0:
            sys.stdout.write('Content-Length: %s\n' % self.content_length)
        sys.stdout.write(self.headers)
        sys.stdout.write('\n')
        self.write = sys.stdout.write
    def write(self, s):
        if not self._headed:
            self._writeheaders()
        sys.stdout.write(s)

try:
    req = Request()
    program = req.path_info
    if program[0] == '/':
        program = program[1:]
    if not program:
        raise ERedirect, 'ops_webrellist'
    try:
        module = __import__(program)
        try:
            main = module.main
        except AttributeError:
            raise ENoMain, path
        kwargs = {}
        kwargs['req'] = req
        expected = main.func_code.co_varnames[:main.func_code.co_argcount]
        db = None
        if 'form' in expected:
            import cgi
            form = cgi.FieldStorage()
            kwargs['form'] = form
            req.form = form
# Some more stuff about database connections left out #
        apply(module.main, (), kwargs)

    except ImportError:
        admin = os.environ['SERVER_ADMIN']
        print '''Status: 404 Not Found
Content-Type: text/html


--
Mike Looijmans
ASML: http://www5nl.asml.nl/~mlooijma
Private: http://www.milosoftware.com



From mike.looijmans at asml.com  Fri Mar 21 08:53:29 2003
From: mike.looijmans at asml.com (Mike Looijmans)
Date: Fri Jan  9 22:03:45 2004
Subject: [mod_python] Success: PythonCGI (not the other way)
Message-ID: <01c2ef7e$f5e2e280$926a1e6e@wsasd464>

No, i meant that the sysop hasn't updated the server yet (probably local
politics, no time, blah blah, ...)
Besides, I definitely don't want more than 2 flavours of servers out there.

--
Mike Looijmans

-----Original Message-----


>On Fri, Mar 21, 2003 at 07:35:40AM +0100, Mike Looijmans wrote:
>> Since not all our servers are Apache 2.0.xx yet, and mod_python isn't
>> available on those, I wanted to remain compatible with the CGI interface.
>
>Hmm? Are you saying that mod_python isn't available for apache < 2.0?
>Because it is. mod_python version 2.x is for apache 1.3.x, mod_python
>version 3.x is for apache 2.x (yeah, slightly confusing there).



From mike.looijmans at asml.com  Fri Mar 21 09:05:01 2003
From: mike.looijmans at asml.com (Mike Looijmans)
Date: Fri Jan  9 22:03:46 2004
Subject: [mod_python] MySQL DB connection sharing solution
Message-ID: <01c2ef80$9259b480$926a1e6e@wsasd464>

The trouble with most MySQL connection "sharing" methods is that they use the
same connection for multiple threads. This will not work when using scrolling
cursors, you can have only one of those open per connection. If you allow
users to run arbitrary queries, you don't want them to allocate 100 megabytes
of buffer space on the server when doing a "SELECT * FROM customer, orders"
(forgetting to join them...) so they are a must have.

Solution I came up with is to "give" a Connection object to each thread, and
when done, return it to the pool. If a connection is not in the pool, a new
one is made. With a bit of locking, you can have as many threads as you like,
and they won't interfere. The connections are stored in a dictionary, using
the usr, password, host and database as entry 'hash' (which I made a string
for easy debugging).
The entries are a list, when connecting the first object is taken from the
list, and appended again when the handler is done with it. It checks if the
connection is still valid when returning it (so a handler CAN do a db.close()
to dispose of a connection if that is neccesary).

### Connection sharing code ###

dblist = {}
_lock = threading.Lock()

def connectdb(req):
    environ = req.subprocess_env
    dbentry = '%s:%s@%s/%s' % (environ['DBUSER'],
                               environ['DBPWD'],
                               environ['DBHOST'],
                               environ['DBNAME'])
    req.dbentry = dbentry
    _lock.acquire()
    try:
        list = dblist.get(dbentry, [])
        if len(list):
            result = list[0]
            del list[0]
        else:
            import ops_sql
            dblist[dbentry] = list
            result = ops_sql.db_connect(environ)
    finally:
        _lock.release()
    return result

def donedb(req, db):
    if db and (not db._db.closed):
        _lock.acquire()
        try:
            dblist[req.dbentry].append(db)
        finally:
            _lock.release()

### In the handler(req) routine ###

           db = None
            if 'form' in expected:
                form = util.FieldStorage(req)
                kwargs['form'] = form
                req.form = form
            if 'db' in expected:
                db = connectdb(req)
                kwargs['db'] = db
            try:
                apply(module.main, (), kwargs)
            finally:
                donedb(req, db)



--
Mike Looijmans
ASML: http://www5nl.asml.nl/~mlooijma
Private: http://www.milosoftware.com



From laurie at tratt.net  Fri Mar 21 08:57:44 2003
From: laurie at tratt.net (Laurence Tratt)
Date: Fri Jan  9 22:03:46 2004
Subject: [mod_python] has anyone successfully built mod_python3.03 on OpenBSD?
In-Reply-To: <Pine.LNX.4.21.0303201358360.2164-100000@lothlorien.coreqa.prognet.com>; from mtaylor@real.com on Thu, Mar 20, 2003 at 02:07:42PM -0800
References: <Pine.LNX.4.21.0303201358360.2164-100000@lothlorien.coreqa.prognet.com>
Message-ID: <20030321085744.A32228@purcell.tratt.net>

On Thu, Mar 20, 2003 at 02:07:42PM -0800, Mark Taylor wrote:

> I've been using OpenBSD3.2, apache2.0.43 and python2.2.1
>
> apxs is not building mod_python.so.  I've found similar plaints in the
> threads, but no solutions.

I haven't had a chance to try this on the latest mod_python, but the problem
certainly used to be that Apache (2.0.33/2.0.44) ships with a version of
libtool which could charitably be described as brain dead. Install libtool
from ports, then overwrite Apache's version of libtool "cp
/usr/local/bin/libtool /usr/local/apache2/build" [or wherever your Apache 2
is].

I've been doing a fairly substantial amount of mod_python work under OpenBSD
and, once installed, it's as stable as a rock.

Best wishes,


Laurie

From jc at cowgar.com  Fri Mar 21 08:37:04 2003
From: jc at cowgar.com (Jeremy Cowgar)
Date: Fri Jan  9 22:03:46 2004
Subject: [mod_python] PythonImport - an example?
In-Reply-To: <01c2ef7e$f5e2e280$926a1e6e@wsasd464>
References: <01c2ef7e$f5e2e280$926a1e6e@wsasd464>
Message-ID: <200303210837.04952.jc@cowgar.com>

Can anyone give me an example of how the PythonImport directive/code works?

I may be mistaken, but what I want to use it for is to establish my initial db 
connections, load some classes, do some configuration, etc... Then in all my 
hander's, I should have access to that information, correct?

Thanks,

Jeremy

From grisha at modpython.org  Fri Mar 21 10:01:44 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:46 2004
Subject: [mod_python] has anyone successfully built mod_python3.03 on
 OpenBSD?
In-Reply-To: <20030321085744.A32228@purcell.tratt.net>
Message-ID: <20030321095949.I50466-100000@eden.ispol.com>


On Fri, 21 Mar 2003, Laurence Tratt wrote:

> certainly used to be that Apache (2.0.33/2.0.44) ships with a version of
> libtool which could charitably be described as brain dead. Install libtool
> from ports, then overwrite Apache's version of libtool "cp
> /usr/local/bin/libtool /usr/local/apache2/build" [or wherever your Apache 2
> is].

A better way is to run ./buildconf - this will copy the libtool from your
system into the Apache source tree and do some other important suff (like
rebuild the ./configure script).


Grisha


From laurie at tratt.net  Fri Mar 21 15:05:55 2003
From: laurie at tratt.net (Laurence Tratt)
Date: Fri Jan  9 22:03:46 2004
Subject: [mod_python] has anyone successfully built mod_python3.03 on OpenBSD?
In-Reply-To: <20030321095949.I50466-100000@eden.ispol.com>; from grisha@modpython.org on Fri, Mar 21, 2003 at 10:01:44AM -0500
References: <20030321085744.A32228@purcell.tratt.net> <20030321095949.I50466-100000@eden.ispol.com>
Message-ID: <20030321150555.H32228@purcell.tratt.net>

On Fri, Mar 21, 2003 at 10:01:44AM -0500, Gregory (Grisha) Trubetskoy wrote:

[Laurie]
>> certainly used to be that Apache (2.0.33/2.0.44) ships with a version of
>> libtool which could charitably be described as brain dead. Install
>> libtool from ports, then overwrite Apache's version of libtool "cp
>> /usr/local/bin/libtool /usr/local/apache2/build" [or wherever your Apache
>> 2 is].
> A better way is to run ./buildconf - this will copy the libtool from your
> system into the Apache source tree and do some other important suff (like
> rebuild the ./configure script).

ISTR that ./buildconf still picks up the Apache libtool (or, at least, it
does under OpenBSD), but would be happy to be corrected.

Best wishes,


Laurie

From grisha at modpython.org  Fri Mar 21 10:36:36 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:46 2004
Subject: [mod_python] PythonImport - an example?
In-Reply-To: <200303210837.04952.jc@cowgar.com>
Message-ID: <20030321100228.P50466-100000@eden.ispol.com>

Yes, but I would stay away from PythonImport unless you have no choice.

There's been some debate about this on the list before and it manly arises
from a misunderstanding of how things work. At first glance it seems like
a simple and obvious thing - initiate my db connections and load big data
dictionaries at server startup so that when those requests come in we're
ready to go.

But the problem is that Apache doesn't work this way. The context within
which a request runs comes into existence only after a request begins and
is a result of applying known server configuration directives (from config
and .htaccess files) to dynamic request parameters (e.g. host:  header
which dictates the virtual server to be used, and also the name of the
subinterpreter mod_python will use).

Consider also that there is no way to reliably predict ahead of time what
this request environment may look like since it is put together gradually
by handlers, which might be provided by any number of apache modules which
may choose to drastically change the request environment (e.g. rewrite a
bunch of headers). For example the virtual server and document root
information may not even be specified in the config file but is created
dynamically per-request if you're using something like mod_vhost.

But the server config file discussion during PythonImport is moot,
because, in fact, at the time when PythonImport executes (Apache child
initialization phase), Apache hasn't yet read the config file fully.

So you have to realize that PythonImport runs in this minimalistic bare
environment and needs a hint in the form of the subinterpreter name to be
useful, and sometimes getting it to work correctly can be a challenge, and
also keep in mind that using this directive isn't very portable because it
requires the interpreter name.

I personally favor not bothering with pre-initialization at all. The
downside is that the first hit to your side may take a little longer.
Another option that I've used quite successfully is to add a request to
some initialization url (using lynx or wget or whatever) into the server
start up script.

Grisha

On Fri, 21 Mar 2003, Jeremy Cowgar wrote:

> Can anyone give me an example of how the PythonImport directive/code works?
>
> I may be mistaken, but what I want to use it for is to establish my initial db
> connections, load some classes, do some configuration, etc... Then in all my
> hander's, I should have access to that information, correct?
>
> Thanks,
>
> Jeremy
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From vlindberg at verio.net  Fri Mar 21 18:01:10 2003
From: vlindberg at verio.net (VanL)
Date: Fri Jan  9 22:03:46 2004
Subject: [mod_python] Dynamic virtualhost configuration
Message-ID: <3E7BB5D6.5020706@verio.net>

Hello,

In a book about apache, I came across the following bit of code for 
mod_perl:

[embedded in httpd.conf]
# generate virtual hosts on the fly with Perl
<Perl>
#!/usr/bin perl -w

[snip some stuff]

# Open the virtual hosts file
open (FILE, "/usr/local/apache/conf/vhosts.conf");

while(<FILE>)
     # Create a virtual host based on this line
     ($ip,$host,$admin,$vroot,$aliases) = split /\s*,\s*, $_;
     $VirtualHost {$ip} = {

         [Create virtual host from variables]

[snip other stuff]

</Perl>
[continue httpd.conf]

Is it possible to do the same with mod_python?  I am in a situation 
where I have many subhosts, substantially similar.  Being able to define 
a shorthand for virtual hosts would be a big plus.

In a similar vein, the documentation talks about dynamically associating 
different handlers with a request.  Are these python handlers only, or 
could mod_python do a runtime check that associates mod_php with .php 
files in a specific virtualhost?

Thanks,

VanL


From vlindberg at verio.net  Fri Mar 21 18:18:06 2003
From: vlindberg at verio.net (VanL)
Date: Fri Jan  9 22:03:46 2004
Subject: [mod_python] Dynamic virtualhost configuration
In-Reply-To: <20030322010644.GO13870@netvista.mikebell.org>
References: <3E7BB5D6.5020706@verio.net> <20030322010644.GO13870@netvista.mikebell.org>
Message-ID: <3E7BB9CE.40204@verio.net>

Hello,

mod_vhost_alias would work for some of the accounts, but not others.
The essential problem is that certain services (like php execution, or 
ssi execution) are defined on a per-vhost basis.  From reading the 
documentation and a little experimentation, I'm not sure how to enable 
these services in some contexts, and not in others.  Note that I'm 
mostly talking about module-based services, not simple cgi executiona 
ability.  Thus VirtualScriptAlias wouldn't cut it, to my knowledge.

VanL

mike@mikebell.org wrote:

>On Fri, Mar 21, 2003 at 06:01:10PM -0700, VanL wrote:
>  
>
>>Is it possible to do the same with mod_python?  I am in a situation 
>>where I have many subhosts, substantially similar.  Being able to define 
>>a shorthand for virtual hosts would be a big plus.
>>    
>>
>
>What about mod_vhost_alias? That's what I use.
>
>  
>



From vlindberg at verio.net  Fri Mar 21 18:26:35 2003
From: vlindberg at verio.net (VanL)
Date: Fri Jan  9 22:03:46 2004
Subject: [mod_python] Dynamic virtualhost configuration
In-Reply-To: <20030322012527.GP13870@netvista.mikebell.org>
References: <3E7BB5D6.5020706@verio.net> <20030322010644.GO13870@netvista.mikebell.org> <3E7BB9CE.40204@verio.net> <20030322012527.GP13870@netvista.mikebell.org>
Message-ID: <3E7BBBCB.3090508@verio.net>

mike@mikebell.org wrote:

>Well, if you've got (say) three different setups, three IPs will do the
>job very nicely... If you don't have three IPs it's not so easy, but...
>

Thats right.  And if you only have one IP, then you start looking at a 
way to do it dynamically, so you don't tear your hair out. Hence my 
request...

VanL



From lientz at harvestsolutions.com  Fri Mar 21 18:06:26 2003
From: lientz at harvestsolutions.com (Andrew Lientz)
Date: Fri Jan  9 22:03:46 2004
Subject: [mod_python] cgihandler and redirects
Message-ID: <1048298792.9281.20.camel@hercules.harvestsolutions.com>

Hi,

We are going to slowly convert to mod_python for our application.  In
order to start the transitions I had to correct three things to allow
the cgihandler.py to make our application work properly.  

I edited apache.py to look for the Location header.  When it finds it it
sets the status. I had a problem with the status raised in cgihandler.py
being overridden.  I ended up getting the nicely formated OK pages out
of the web server.  I added the code below to the write function in the
CGIStdout class.

Here's the diff output of my changes:
714,715d713
<                     if h.lower() == "location":
<                         self.req.status = HTTP_MOVED_TEMPORARILY

This allows the code below to be read and redirected without the OK
page.

print "Location: http://blah\n"

and not need any special changes.


In cgihandler.py, I had to append the the current directory to
sys.path.  If it's a subdirectory of the main directory, the
subdirectory doesn't get passed.  This messes with import commands
within a script.  

Also, sys.exit(0) is an easy way to end a script.  It should be graceful
but it raises a SystemExit error.  I modified the code to deal with
this.

Here's the diff output of what I changed in cgihandler.py.

127d126
<             sys.path.append (dir)
134,141d132
<             # this executes the module
<             try:
<                 imp.load_module(module_name, fd, path, desc)
<             except SystemExit, e:
<                 if e == 0:
<                     pass
<                 else:
<                     raise SystemExit, e

I am posting this as an FYI and to see if there was something better I
could have done.  I couldn't find any references in the list archives,
so I hope this helps.

Regards,

Andy
-- 
Andrew Lientz
Harvest Solutions, Inc.
310-398-4761


From mateusz at ant.gliwice.pl  Mon Mar 24 13:23:34 2003
From: mateusz at ant.gliwice.pl (Mateusz Korniak)
Date: Fri Jan  9 22:03:46 2004
Subject: [mod_python] Using publisher handler to generate directory index - how to do it in right and easy way ?
Message-ID: <200303241323.34434.mateusz@ant.gliwice.pl>

Assume I have:
Defined for virtual host www.host.com  root direcotory <html_dir>/host/
I have <html_dir>/host/handler.py defined as Publisher Handler.

When user requestes 'www.host.com/handler/foo' it works well.

How to make handler.index(req) be handler of user requestes 'www.host.com' ?

TIA
-- 
Mateusz Korniak
easy.com  easy.go


From grisha at modpython.org  Mon Mar 24 10:51:22 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:46 2004
Subject: [mod_python] Using publisher handler to generate directory index
 - how to do it in right and easy way ?
In-Reply-To: <200303241323.34434.mateusz@ant.gliwice.pl>
Message-ID: <20030324105047.T95235-100000@eden.ispol.com>


On Mon, 24 Mar 2003, Mateusz Korniak wrote:

> When user requestes 'www.host.com/handler/foo' it works well.
>
> How to make handler.index(req) be handler of user requestes 'www.host.com' ?

You can use a DirectoryIndex directive to point to a mod_python script.

Grisha


From dorlov at banta-im.com  Wed Mar 26 11:32:41 2003
From: dorlov at banta-im.com (Dmitry Orlov)
Date: Fri Jan  9 22:03:46 2004
Subject: [mod_python] HTML filtering
Message-ID: <3E81D629.E27E83BE@banta-im.com>

I've started looking into switching some sites that use Python through
cgi to mod_python. The sites work via HTML filtering, sort of like PHP,
with bits of Python stuck inside HTML files. I tried to look for docs
that would show how I could set up such a scheme for mod_python, but
haven't found anything (yet).

Currently, we configure Apache using ScriptAlias and Action directives,
so that any request for a .html file within a certain Location gets
piped through the cgi which runs Python via an HTML filter.

The HTML filter coded in C/flex. It does variable substitution for
things like {$foo}, runs Python snippets between <?python and ?> tags a
la PHP, and a bunch of other nifty things, like form pre-population.

This scheme works quite well, and is fast if one uses fastcgi, but is a
bit complicated. I am hoping to simplify it using mod_python while
retaining the excellent performance.

I am thinking that the ideal drop-in replacement scheme would be to make
our HTML filter into a Python module, and call it via an output filter.
But how do I set it up so that mod_python runs for .html files instead
of .py files?

-Dmitry

From geertj at boskant.nl  Wed Mar 26 18:00:39 2003
From: geertj at boskant.nl (Geert Jansen)
Date: Fri Jan  9 22:03:46 2004
Subject: [mod_python] HTML filtering
In-Reply-To: <3E81D629.E27E83BE@banta-im.com>
References: <3E81D629.E27E83BE@banta-im.com>
Message-ID: <20030326170039.GA7644@vader.boskant.nl>

On Wed, Mar 26, 2003 at 11:32:41AM -0500, Dmitry Orlov wrote:
 
> I am thinking that the ideal drop-in replacement scheme would be to make
> our HTML filter into a Python module, and call it via an output filter.
> But how do I set it up so that mod_python runs for .html files instead
> of .py files?

(Set,Add)Handler python-program .html

Greetings,
Geert Jansen

From neel at mediapulse.com  Wed Mar 26 12:08:01 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:03:46 2004
Subject: [mod_python] HTML filtering
Message-ID: <C0FC22C08B82074A88B50061764157772C656A@johnson.mediapulse.net>

In httpd.conf, for the server add:

    <Files ~ "\.html$">
        SetHandler python-program
        PythonPath "sys.path+['/home/sites/mysite.com/modules']"
        PythonHandler www
        #PythonDebug On
    </Files>

With a www.py in the /home/sites/mysite.com/modules directory.  In
www.py you can put your request handler.

You might want to take a look at Albatross, it sounds very close to what
you are doing, http://www.object-craft.com.au/projects/albatross/

Mike

-----Original Message-----
From: Dmitry Orlov [mailto:dorlov@banta-im.com] 
Sent: Wednesday, March 26, 2003 11:33 AM
To: mod_python@modpython.org
Subject: [mod_python] HTML filtering


I've started looking into switching some sites that use Python through
cgi to mod_python. The sites work via HTML filtering, sort of like PHP,
with bits of Python stuck inside HTML files. I tried to look for docs
that would show how I could set up such a scheme for mod_python, but
haven't found anything (yet).

Currently, we configure Apache using ScriptAlias and Action directives,
so that any request for a .html file within a certain Location gets
piped through the cgi which runs Python via an HTML filter.

The HTML filter coded in C/flex. It does variable substitution for
things like {$foo}, runs Python snippets between <?python and ?> tags a
la PHP, and a bunch of other nifty things, like form pre-population.

This scheme works quite well, and is fast if one uses fastcgi, but is a
bit complicated. I am hoping to simplify it using mod_python while
retaining the excellent performance.

I am thinking that the ideal drop-in replacement scheme would be to make
our HTML filter into a Python module, and call it via an output filter.
But how do I set it up so that mod_python runs for .html files instead
of .py files?

-Dmitry
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python


From peter.bittner at gmx.net  Thu Mar 27 02:17:57 2003
From: peter.bittner at gmx.net (Peter Bittner)
Date: Fri Jan  9 22:03:46 2004
Subject: [mod_python] Using publisher handler to generate directory index - how to do it in right and easy way ?
References: <20030324105047.T95235-100000@eden.ispol.com>
Message-ID: <30920.1048727877@www56.gmx.net>

Hi there!

> On Mon, 24 Mar 2003, Mateusz Korniak wrote:
> 
> > When user requestes 'www.host.com/handler/foo' it works well.
> >
> > How to make handler.index(req) be handler of user requestes
> > 'www.host.com' ?

I have already tried to talk about this topic a while ago (maybe half a year
ago it was).

What I had proposed then, was to make the PublisherHandler handle a
'default' method, say func default(), which should be called automatically when a
request without a function name comes. In your examples this would be
'www.host.com/handler/' -- this would be handled like todays
'www.host.com/handler/default'.

This way one could make the web server handle, say, all 'index.py' files
like the defaults of a directory. (Comparable to the 'index.html' or whatever
someone sets to be called when no document is specified on access to HTML-files
on a web server.)

Having a PublisherHandler with a default function would then make it easy --
(look at the subject of Mateusz' message!) -- to create web projects in the
same simple manner as if there were only HTML-files:

 - An HTTP request to www.host.com would go to, say, www.host.com/index.py
(physically) and logically to www.host.com/index/default, respectively.
 - An HTTP request to www.host.com/mydir/ would in the same manner go to
www.host.com/mydir/index.py (physically) and logically to
www.host.com/mydir/index/default, respectively.

I think mod_python would only benefit from such a change to the
PublisherHandler's code. This would make mod_python (and thus Python itself) more
attractive to web designers and web programmers.

"Grisha" wrote:
> You can use a DirectoryIndex directive to point to a mod_python script.

Well, from my point of view this is only a workaround.
A general solution, however, might give Python the chance to become as
popular as PHP for web programming - after some time of course, not over night!

Please guys, note that this might be a change request that a lot of people
are waiting for, I think especially a lot of newbies to mod_python - newbies
that know other languages like PHP and (CGI-) Python beside others.

Peter

-- 
"Free software is like free speech, not free beer" (Richard Stallman)

+++ GMX - Mail, Messaging & more  http://www.gmx.net +++
Bitte l?cheln! Fotogalerie online mit GMX ohne eigene Homepage!


From dustin at ywlcs.org  Wed Mar 26 21:19:44 2003
From: dustin at ywlcs.org (Dustin Mitchell)
Date: Fri Jan  9 22:03:46 2004
Subject: [mod_python] Using publisher handler to generate directory index - how to do it in right and easy way ?
In-Reply-To: <30920.1048727877@www56.gmx.net>
References: <20030324105047.T95235-100000@eden.ispol.com> <30920.1048727877@www56.gmx.net>
Message-ID: <20030327031944.GP10000@eleanor.internal.ywlcs.org>

I agree this wouuld be a handy feature.  If it's likely to cause problems
(with backward compatibility, perhaps), then it could be selected with a
configuration directive (PythonOption PublisherDefault [off|<name>]), or even
exist as a separate publisher.

I'm sure we're all missing some good reason this is a bad idea.

Otherwise, I'd be willing to create a patch.

Dustin

-- 

  Dustin Mitchell
  dustin@ywlcs.org/djmitche@alumni.uchicago.edu
  http://people.cs.uchicago.edu/~dustin/

From grisha at modpython.org  Wed Mar 26 23:10:02 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:46 2004
Subject: [mod_python] Using publisher handler to generate directory index
 - how to do it in right and easy way ?
In-Reply-To: <20030327031944.GP10000@eleanor.internal.ywlcs.org>
Message-ID: <20030326230705.G36549-100000@eden.ispol.com>

Unless I'm missing something, the publisher already has a default
function, only it's "index" not "default":

http://www.modpython.org/live/current/doc-html/hand-pub-alg-trav.html

Grisha

On Wed, 26 Mar 2003, Dustin Mitchell wrote:

> I agree this wouuld be a handy feature.  If it's likely to cause problems
> (with backward compatibility, perhaps), then it could be selected with a
> configuration directive (PythonOption PublisherDefault [off|<name>]), or even
> exist as a separate publisher.
>
> I'm sure we're all missing some good reason this is a bad idea.
>
> Otherwise, I'd be willing to create a patch.
>
> Dustin
>
> --
>
>   Dustin Mitchell
>   dustin@ywlcs.org/djmitche@alumni.uchicago.edu
>   http://people.cs.uchicago.edu/~dustin/
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From stevena at neosynapse.net  Wed Mar 26 23:47:02 2003
From: stevena at neosynapse.net (Steven D. Arnold)
Date: Fri Jan  9 22:03:46 2004
Subject: [mod_python] environment variables not visible?
Message-ID: <BAA7EC76.1FC82%stevena@neosynapse.net>

Hello,

I am attempting to use mod_python 2.7.8 with spyce 1.3.6.  In my project, I
use a database module that connects with a Sybase database.  The module
expects certain environment variables to be set, which I set directly using
os.environ.  Nevertheless, the module doesn't seem to see the environment
variables; the errors are exactly as if the environment variables are not
present.

When I execute the same code from the python interpreter, it works fine.
Likewise when I run the pages from CGI rather than mod_python.  Thus, it
seems as if this may be a mod_python issue.  Any idea what may be going on?

Thanks,
steve
-- 



From grisha at modpython.org  Thu Mar 27 08:04:31 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:46 2004
Subject: [mod_python] environment variables not visible?
In-Reply-To: <BAA7EC76.1FC82%stevena@neosynapse.net>
Message-ID: <20030327080031.S42239-100000@eden.ispol.com>

I am guessing you are using the cgihandler. You can't see environment
variables from within the cgihandler-executed CGI scripts, it's mentioned
here:

http://www.modpython.org/live/current/doc-html/hand-cgi.html

Your options are to switch to using the publisher handler or write your
own handler.

Also, I may be wrong, but I think information that is gathered by the
sybase client from the environment can be passed to it by other means.

Grisha

On Wed, 26 Mar 2003, Steven D. Arnold wrote:

> Hello,
>
> I am attempting to use mod_python 2.7.8 with spyce 1.3.6.  In my project, I
> use a database module that connects with a Sybase database.  The module
> expects certain environment variables to be set, which I set directly using
> os.environ.  Nevertheless, the module doesn't seem to see the environment
> variables; the errors are exactly as if the environment variables are not
> present.
>
> When I execute the same code from the python interpreter, it works fine.
> Likewise when I run the pages from CGI rather than mod_python.  Thus, it
> seems as if this may be a mod_python issue.  Any idea what may be going on?
>
> Thanks,
> steve
> --
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From vlindberg at verio.net  Thu Mar 27 08:34:08 2003
From: vlindberg at verio.net (VanL)
Date: Fri Jan  9 22:03:46 2004
Subject: [mod_python] Using the socket module
Message-ID: <3E8319F0.2010306@verio.net>

Hello,

I am trying to connect to a Pyro Server from an app running within
mod_python, but it dies anytime it tries to initialize the socket
library.  Is this a known issue?   Are there any fixes or workarounds?

Thanks

VanL



From geertj at boskant.nl  Thu Mar 27 16:54:43 2003
From: geertj at boskant.nl (Geert Jansen)
Date: Fri Jan  9 22:03:46 2004
Subject: [mod_python] Python codecs bug
Message-ID: <20030327155443.GA23429@vader.boskant.nl>

Hi,

recently, a bug in the Python codecs subsystem has been discovered that
can affect mod_python programs. I have a confirmed report that this bug fixes
the vague "Cannot unmarshal code object in restricted execution mode" error
that was discussed on this list:

  http://mail.python.org/pipermail/python-list/2002-June/109233.html

The bug is described in detail here:

  http://sourceforge.net/tracker/index.php?func=detail&aid=663074&group_id=5470&atid=105470

The Python 2.3 CVS has been fixed. A backport of this fix to Python 2.2.2 is
available from my website at:

  http://draco.boskant.nl/requirements.dsp

the patch has been submitted to the Python crew.

I thought you'd might be interested...

Greetings,
Geert Jansen

From grisha at modpython.org  Thu Mar 27 11:01:27 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:46 2004
Subject: [mod_python] Using the socket module
In-Reply-To: <3E8319F0.2010306@verio.net>
Message-ID: <20030327105923.D44232-100000@eden.ispol.com>

It would help if you provided some specifics:

1. Code
2. Any error output (from apache error_log)
3. Versions of Python, mod_python, apache and your OS

Grisha

On Thu, 27 Mar 2003, VanL wrote:

> Hello,
>
> I am trying to connect to a Pyro Server from an app running within
> mod_python, but it dies anytime it tries to initialize the socket
> library.  Is this a known issue?   Are there any fixes or workarounds?
>
> Thanks
>
> VanL
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From stevena at neosynapse.net  Thu Mar 27 11:26:34 2003
From: stevena at neosynapse.net (Steven D. Arnold)
Date: Fri Jan  9 22:03:46 2004
Subject: [mod_python] environment variables not visible?
In-Reply-To: <20030327080031.S42239-100000@eden.ispol.com>
Message-ID: <BAA8906A.1FDDE%stevena@neosynapse.net>

On 3/27/03 8:04 AM, "Gregory (Grisha) Trubetskoy" <grisha@modpython.org>
wrote:

> I am guessing you are using the cgihandler. You can't see environment
> variables from within the cgihandler-executed CGI scripts, it's mentioned
> here:
> 
> http://www.modpython.org/live/current/doc-html/hand-cgi.html

I saw this post, but it doesn't seem I am using that.  Here's the section of
the config:

#AddHandler spyce-cgi-handler spy
#Action spyce-cgi-handler "/spyce-cgi/run_spyceCGI.py"
#ScriptAlias /spyce-cgi/ "/usr/share/spyce/cgi/"
<IfModule mod_python.c>
  AddHandler python-program .spy
  PythonHandler run_spyceModpy::spyceMain
  PythonPath 
"sys.path+[r'/usr/share/spyce/cgi','/server/unr/spyce_modules']"
  PythonOption SPYCE_CONFIG "/usr/share/spyce/spyce.conf"
  # !!! Do NOT turn on. !!!
  PythonOptimize Off
  SetEnv SYBASE /server/sybase/ASE_12501_2
  SetEnv LD_LIBRARY_PATH
/server/sybase/ASE_12501_2/OCS-12_5/lib:/usr/local/lib
  SetEnv SYBASE_OCS /server/sybase/ASE_12501_2/OCS-12_5
  SetEnv SYBASE_ASE /server/sybase/ASE_12501_2/ASE-12_5
</IfModule>
## Following Directives commented out for Mod_python testing
## 03/25/03
#<Location /spyce-cgi/>
#  <IfModule mod_fastcgi.c>
#    # If mod_fastcgi not installed, we get plain cgi
#    SetHandler fastcgi-script
#  </IfModule>
#</Location>
# If FastCGI is installed, it will be picked up
# automatically. On Linux, you can also omit this section
# and use a dynamic fcgi server instead.
#<IfModule mod_fastcgi.c>
#  FastCgiServer "/usr/share/spyce/cgi/run_spyceCGI.py" -port 7654
-initial-env F
#CGI_PORT=7654
#</IfModule>

Note the SetEnv directives are used in addition to setting the environment
with os.environ, but neither of these approaches work.  I am not familiar
enough with the internals of mod_python, but it seems perhaps
run_spyceModpy::spyceMain is the mon_python handler and perhaps it is
somehow forgetting the environment variables.  Does this seem like a likely
possibility to you?

Thanks,
steve
-- 



From vlindberg at verio.net  Thu Mar 27 11:25:58 2003
From: vlindberg at verio.net (VanL)
Date: Fri Jan  9 22:03:46 2004
Subject: [mod_python] Using the socket module
References: <20030327105923.D44232-100000@eden.ispol.com>
Message-ID: <3E834236.7030104@verio.net>

I'm sorry, I have worked it out.  The bug was not in mod_python -- Pyro 
was importing the Threading module in a couple of places without 
checking to see if the python installation supported multithreading.

Thanks,

VanL

Gregory (Grisha) Trubetskoy wrote:

>It would help if you provided some specifics:
>
>1. Code
>2. Any error output (from apache error_log)
>3. Versions of Python, mod_python, apache and your OS
>
>Grisha
>
>On Thu, 27 Mar 2003, VanL wrote:
>
>  
>
>>Hello,
>>
>>I am trying to connect to a Pyro Server from an app running within
>>mod_python, but it dies anytime it tries to initialize the socket
>>library.  Is this a known issue?   Are there any fixes or workarounds?
>>
>>Thanks
>>
>>VanL
>>
>>
>>_______________________________________________
>>Mod_python mailing list
>>Mod_python@modpython.org
>>http://www.modpython.org/mailman/listinfo/mod_python
>>
>>    
>>
>
>  
>




From jessamyn.smith at pason.com  Thu Mar 27 14:38:16 2003
From: jessamyn.smith at pason.com (Jessamyn Smith)
Date: Fri Jan  9 22:03:46 2004
Subject: [mod_python] Import site failed
Message-ID: <20030327143816.A935@ash.int.ca.pason.com>


We are in the process of upgrading our application to use mod_python.  I
have successfully configured and installed mod_python-2.7.8 on my
system, with Python 2.2.2 and MySQL-python-0.9.2.  However, when the
other developers follow my directions, they get the following error when
trying to run any Python CGI scripts:

'import site' failed; use -v for traceback
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
[Thu Mar 27 14:28:44 2003] [error] [client 127.0.0.1] python_handler:
make_obcallback returned no obCallBack!

Does anyone have any insight as to what could be different?  As far as
we know we are all running the same system (RedHat 7.3).  I am able to
wipe out my entire Python 2.2.2 directory and start the install from
scratch, and get a working version of mod_python, so I suspect the
problem is in the environment.

I tried looking through the archives, but the link for downloading the
entire mbox seems to be broken:
Not Found

The requested URL /pipermail/mod_python.mbox/mod_python.mbox was not
found on this server.

My patience for clicking monthly links to the archives wore out well
before I'd checked them all.

Jessamyn
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 232 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20030327/d532d963/attachment-0003.bin
From scott_list at mischko.com  Thu Mar 27 13:40:24 2003
From: scott_list at mischko.com (Scott Chapman)
Date: Fri Jan  9 22:03:46 2004
Subject: [mod_python] HTML filtering
In-Reply-To: <3E81D629.E27E83BE@banta-im.com>
References: <3E81D629.E27E83BE@banta-im.com>
Message-ID: <200303271340.24840.scott_list@mischko.com>

You might want to look at Spyce (http://spyce.sourceforge.net/) also.  It 
allows you to embed Python in HTML.

Scott


On Wednesday 26 March 2003 8:32 am, Dmitry Orlov wrote:
I've started looking into switching some sites that use Python through
cgi to mod_python. The sites work via HTML filtering, sort of like PHP,
with bits of Python stuck inside HTML files. I tried to look for docs
that would show how I could set up such a scheme for mod_python, but
haven't found anything (yet).

Currently, we configure Apache using ScriptAlias and Action directives,
so that any request for a .html file within a certain Location gets
piped through the cgi which runs Python via an HTML filter.

The HTML filter coded in C/flex. It does variable substitution for
things like {$foo}, runs Python snippets between <?python and ?> tags a
la PHP, and a bunch of other nifty things, like form pre-population.

This scheme works quite well, and is fast if one uses fastcgi, but is a
bit complicated. I am hoping to simplify it using mod_python while
retaining the excellent performance.

I am thinking that the ideal drop-in replacement scheme would be to make
our HTML filter into a Python module, and call it via an output filter.
But how do I set it up so that mod_python runs for .html files instead
of .py files?

-Dmitry
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python



From gnb at itga.com.au  Fri Mar 28 09:05:23 2003
From: gnb at itga.com.au (Gregory Bond)
Date: Fri Jan  9 22:03:46 2004
Subject: [mod_python] Import site failed 
In-Reply-To: Your message of Thu, 27 Mar 2003 14:38:16 -0700.
Message-ID: <200303272205.JAA14087@lightning.itga.com.au>

> [Thu Mar 27 14:28:44 2003] [error] [client 127.0.0.1] python_handler:
> make_obcallback returned no obCallBack!

Check the very first entry in the FAQ:
	http://www.modpython.org/FAQ/faqw.py?req=show&file=faq02.001.htp




From dorlov at banta-im.com  Thu Mar 27 17:25:27 2003
From: dorlov at banta-im.com (Dmitry Orlov)
Date: Fri Jan  9 22:03:46 2004
Subject: [mod_python] HTML filtering
References: <3E81D629.E27E83BE@banta-im.com> <200303271340.24840.scott_list@mischko.com>
Message-ID: <3E837A57.7D90AEB6@banta-im.com>

Hi Scott,

Thanks for the tip, but I've looked at all kinds of templating engines,
and they all pretty much do the same thing, albeit in a wide variety of
ways. The commonalities are:

1. you have to manually put in bits of code to change values of
attributes and query string variables, and

2. designers who use wysiwyg tools like Dreamweaver are at a loss if you
give them a marked-up HTML file to edit.

The idea behind ours is that lots of common-sense stuff just happens
automatically. For example, if there is an <input type="text"
name="foo"> and request.foo happens to be "bar", the engine spits out
<input type="text" name="foo" value="bar"> without being asked. Likewise
with <a href="something.com?foo"> - it gets rewritten to <a
href="something.com?foo=bar"> without the programmer having to do
anything.

We've been using this engine with good results for about 4 years now, on
lots of sites, like http://designjet.hp.com/. It's built into a couple
of our legacy frameworks, but should be relatively easy to reuse;
reasonably recent docs are available at
http://www.integratis.org/dfp.html.

I am leaning in the direction of making it into a GPL'ed Python module
that can be plugged into mod_python as an output filter. But I don't
know how much interest there would be. OSDN/Sourceforge/Freshmeat don't
seem effective as far as gauging interest.

That's why I am sort of spamming this list (just this once, I promise!)
If you think you might be interested in trying it out, or know of anyone
who might be, please let me know. If a bunch of people tell me "Yes,
I'll try it", then that's probably all the push I need to start coding.

-Dmitry

Scott Chapman wrote:
> 
> You might want to look at Spyce (http://spyce.sourceforge.net/) also.  It
> allows you to embed Python in HTML.
> 
> Scott
> 
> On Wednesday 26 March 2003 8:32 am, Dmitry Orlov wrote:
> I've started looking into switching some sites that use Python through
> cgi to mod_python. The sites work via HTML filtering, sort of like PHP,
> with bits of Python stuck inside HTML files. I tried to look for docs
> that would show how I could set up such a scheme for mod_python, but
> haven't found anything (yet).
> 
> Currently, we configure Apache using ScriptAlias and Action directives,
> so that any request for a .html file within a certain Location gets
> piped through the cgi which runs Python via an HTML filter.
> 
> The HTML filter coded in C/flex. It does variable substitution for
> things like {$foo}, runs Python snippets between <?python and ?> tags a
> la PHP, and a bunch of other nifty things, like form pre-population.
> 
> This scheme works quite well, and is fast if one uses fastcgi, but is a
> bit complicated. I am hoping to simplify it using mod_python while
> retaining the excellent performance.
> 
> I am thinking that the ideal drop-in replacement scheme would be to make
> our HTML filter into a Python module, and call it via an output filter.
> But how do I set it up so that mod_python runs for .html files instead
> of .py files?
> 
> -Dmitry
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

From gnb at itga.com.au  Fri Mar 28 10:09:42 2003
From: gnb at itga.com.au (Gregory Bond)
Date: Fri Jan  9 22:03:46 2004
Subject: [mod_python] HTML filtering 
In-Reply-To: Your message of Thu, 27 Mar 2003 17:25:27 -0500.
Message-ID: <200303272309.KAA18383@lightning.itga.com.au>

> The idea behind ours is that lots of common-sense stuff just happens
> automatically. For example, if there is an <input type="text"
> name="foo"> and request.foo happens to be "bar", the engine spits out
> <input type="text" name="foo" value="bar"> without being asked.

Albatross (http://www.object-craft.com.au/projects/albatross/) does this sort 
of thing very well, and supports CGI or mod_python with the same script (with 
a bit of trickery).  But it might be a bit hard to cut over existing products 
to use it.


From grisha at modpython.org  Thu Mar 27 18:14:01 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:46 2004
Subject: [mod_python] HTML filtering
In-Reply-To: <3E837A57.7D90AEB6@banta-im.com>
Message-ID: <20030327181158.I50327-100000@eden.ispol.com>


On Thu, 27 Mar 2003, Dmitry Orlov wrote:

> I am leaning in the direction of making it into a GPL'ed Python module
> that can be plugged into mod_python as an output filter.

It's be more in Python spirit if it was a BSD-style license rather than
GPL. :-)

Grisha


From scott_list at mischko.com  Thu Mar 27 15:14:16 2003
From: scott_list at mischko.com (Scott Chapman)
Date: Fri Jan  9 22:03:46 2004
Subject: [mod_python] HTML filtering
In-Reply-To: <3E837A57.7D90AEB6@banta-im.com>
References: <3E81D629.E27E83BE@banta-im.com> <200303271340.24840.scott_list@mischko.com> <3E837A57.7D90AEB6@banta-im.com>
Message-ID: <200303271514.16988.scott_list@mischko.com>

I am VERY interested in this.  If you can make a copy of it available to 
experiment with, I'd appreciate it.

My vote is "Yes" on GPL action here!

Scott

On Thursday 27 March 2003 2:25 pm, Dmitry Orlov wrote:
Hi Scott,

Thanks for the tip, but I've looked at all kinds of templating engines,
and they all pretty much do the same thing, albeit in a wide variety of
ways. The commonalities are:

1. you have to manually put in bits of code to change values of
attributes and query string variables, and

2. designers who use wysiwyg tools like Dreamweaver are at a loss if you
give them a marked-up HTML file to edit.

The idea behind ours is that lots of common-sense stuff just happens
automatically. For example, if there is an <input type="text"
name="foo"> and request.foo happens to be "bar", the engine spits out
<input type="text" name="foo" value="bar"> without being asked. Likewise
with <a href="something.com?foo"> - it gets rewritten to <a
href="something.com?foo=bar"> without the programmer having to do
anything.

We've been using this engine with good results for about 4 years now, on
lots of sites, like http://designjet.hp.com/. It's built into a couple
of our legacy frameworks, but should be relatively easy to reuse;
reasonably recent docs are available at
http://www.integratis.org/dfp.html.

I am leaning in the direction of making it into a GPL'ed Python module
that can be plugged into mod_python as an output filter. But I don't
know how much interest there would be. OSDN/Sourceforge/Freshmeat don't
seem effective as far as gauging interest.

That's why I am sort of spamming this list (just this once, I promise!)
If you think you might be interested in trying it out, or know of anyone
who might be, please let me know. If a bunch of people tell me "Yes,
I'll try it", then that's probably all the push I need to start coding.

-Dmitry

Scott Chapman wrote:
> You might want to look at Spyce (http://spyce.sourceforge.net/) also.  It
> allows you to embed Python in HTML.
>
> Scott
>
> On Wednesday 26 March 2003 8:32 am, Dmitry Orlov wrote:
> I've started looking into switching some sites that use Python through
> cgi to mod_python. The sites work via HTML filtering, sort of like PHP,
> with bits of Python stuck inside HTML files. I tried to look for docs
> that would show how I could set up such a scheme for mod_python, but
> haven't found anything (yet).
>
> Currently, we configure Apache using ScriptAlias and Action directives,
> so that any request for a .html file within a certain Location gets
> piped through the cgi which runs Python via an HTML filter.
>
> The HTML filter coded in C/flex. It does variable substitution for
> things like {$foo}, runs Python snippets between <?python and ?> tags a
> la PHP, and a bunch of other nifty things, like form pre-population.
>
> This scheme works quite well, and is fast if one uses fastcgi, but is a
> bit complicated. I am hoping to simplify it using mod_python while
> retaining the excellent performance.
>
> I am thinking that the ideal drop-in replacement scheme would be to make
> our HTML filter into a Python module, and call it via an output filter.
> But how do I set it up so that mod_python runs for .html files instead
> of .py files?
>
> -Dmitry
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python



From jessamyn.smith at pason.com  Fri Mar 28 07:56:42 2003
From: jessamyn.smith at pason.com (Jessamyn Smith)
Date: Fri Jan  9 22:03:46 2004
Subject: [mod_python] Import site failed
In-Reply-To: <D31B04F24EDE7644BB169BB4F080778A06C2396B@s30342g004005>; from Hans.Yandle@cingular.com on Fri, Mar 28, 2003 at 09:07:37AM -0500
References: <D31B04F24EDE7644BB169BB4F080778A06C2396B@s30342g004005>
Message-ID: <20030328075642.A25172@ash.int.ca.pason.com>


Thank you everyone for your help.  We managed to fix the problem by
adding a symbolic link:
ln -s /path/to/Python-2.2.2 /path/to/PythonHome

And editing the apache startup script (/etc/init.d/httpd), adding:
export PYTHONHOME='/hub/apps/PythonHome/'
in the start() function.

I felt pretty dumb for not checking the webpage for a FAQ.  We were
googling for "import site failed", when apparently we should have been
googling for "obcallback".  I am also still perplexed as to how my
machine is able to find mod_python, when I haven't done either of the
above steps.

Anyway, thanks again!

Jessamyn
-- 
Jessamyn Smith
Systems Analyst, DataHub Team
Ph: (403) 301-3470
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 232 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20030328/5bbc3796/attachment-0003.bin
From grisha at modpython.org  Fri Mar 28 17:38:48 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:46 2004
Subject: [mod_python] Why are you using mod_python?
In-Reply-To: <20030328075642.A25172@ash.int.ca.pason.com>
Message-ID: <20030328172826.X67038-100000@eden.ispol.com>

Hello everyone -

As the original author of mod_python I think I'm allowed to jerk people's
chains with this simple question:

Why are you using mod_python?

You can reply on or off list, either is fine. The results, after I get to
mull over them will be published in one way or another.

I've decided to ask the list because I recently realized that I am not
sure I know the answer. Not to say that I don't like mod_python, on the
contrary, I do, but to formulate in words exactly why is rather difficult.
Besides, my opinion is biased anyway :-)

Thanks in advance!

Grisha



From gdamjan at mail.net.mk  Sat Mar 29 03:55:34 2003
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 22:03:47 2004
Subject: [mod_python] environment variables not visible?
In-Reply-To: <BAA8906A.1FDDE%stevena@neosynapse.net>
References: <20030327080031.S42239-100000@eden.ispol.com> <BAA8906A.1FDDE%stevena@neosynapse.net>
Message-ID: <20030329025534.GB2171@legolas.on.net.mk>

>   SetEnv SYBASE /server/sybase/ASE_12501_2
>   SetEnv LD_LIBRARY_PATH
> /server/sybase/ASE_12501_2/OCS-12_5/lib:/usr/local/lib
>   SetEnv SYBASE_OCS /server/sybase/ASE_12501_2/OCS-12_5
>   SetEnv SYBASE_ASE /server/sybase/ASE_12501_2/ASE-12_5
> 
> Note the SetEnv directives are used in addition to setting the environment
> with os.environ, but neither of these approaches work.  I am not familiar
> enough with the internals of mod_python, but it seems perhaps
> run_spyceModpy::spyceMain is the mon_python handler and perhaps it is
> somehow forgetting the environment variables.  Does this seem like a likely
> possibility to you?

I had a similar problem with Apache, PHP and ORACLE. I tried the SetEnv
approach too...

The catch is that SetEnv just sets some Apache-specific internal
environment - that has nothing to do with the UNIX/OS environment.

I've also tried to solve the problem by putting putenv("ORACLE_HOME=...") 
in the PHP code. And with that sometimes it worked and sometimes it
didn't. 

Last I've found that I must set the environment prior to starting the 
apache process. I've ended up with:

    env - ORACLE_HOME=/usr/share/oracle \
           /usr/sbin/apachectl start

in my "/etc/rc.d/rc.httpd" script, and a note to everyone never to call 
"apachectl" directly but to always call "/etc/rc.d/rc.httpd".

In the end the conclusion is that these proprietary products SUCK, it so
much simpler with MySQL or PostgreSQL.



-- 
Damjan Georgievski

From frank at fejes.net  Fri Mar 28 23:14:12 2003
From: frank at fejes.net (Frank S. Fejes III)
Date: Fri Jan  9 22:03:47 2004
Subject: [mod_python] Why are you using mod_python?
In-Reply-To: <20030328172826.X67038-100000@eden.ispol.com>
References: <20030328075642.A25172@ash.int.ca.pason.com>
	<20030328172826.X67038-100000@eden.ispol.com>
Message-ID: <20030328231412.24efac21.frank@fejes.net>

Nobody has responded yet...I've been curious myself.  Personally, my primary
goal in using it (and other mod_* language modules) is to improve the
performance/scalability of my CGI applications.  Unfortunately, I really
dislike the Publisher handler's way of doing things (the
programname.py/method URL syntax feels silly to me) and it seems like most
people are very down on the capabilities and stability of the CGI handler so
I find myself just going plain CGI anyway for many things now when I use
python.

Not to start religious wars, but I find myself using and enjoying mod_ruby
the most of all the web development "environments".  It's simple to use for
the basics while maintaining a very neat and clear way of manipulating
requests and performing advanced tasks.  As an added bonus, eruby (inline
ruby ala asp/php) is nicely integrated.

On a somewhat tangential note, I think mod_python documentation reflects
strangely on what target audience might be interested in the module.  Almost
all introductions I've seen to mod_python begin with a tutorial on creating
a handler.  I'd venture a guess that writing handlers is what fewer than 1%
of web developers want to do with an apache module initially.  In my
experience, most people want to write some code and have it run faster than
it would run under straight CGI...they don't want to write custom handlers.

It's late and I'm tired so take everything I say with a grain of salt! :)

--frank

On Fri, 28 Mar 2003 17:38:48 -0500 (EST)
"Gregory (Grisha) Trubetskoy" <grisha@modpython.org> wrote:

> 
> Hello everyone -
> 
> As the original author of mod_python I think I'm allowed to jerk people's
> chains with this simple question:
> 
> Why are you using mod_python?
> 
> You can reply on or off list, either is fine. The results, after I get to
> mull over them will be published in one way or another.
> 
> I've decided to ask the list because I recently realized that I am not
> sure I know the answer. Not to say that I don't like mod_python, on the
> contrary, I do, but to formulate in words exactly why is rather difficult.
> Besides, my opinion is biased anyway :-)
> 
> Thanks in advance!
> 
> Grisha
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 

From pascalbarbedor at free.fr  Sat Mar 29 08:27:57 2003
From: pascalbarbedor at free.fr (pascal barbedor)
Date: Fri Jan  9 22:03:47 2004
Subject: Fw: [mod_python] Why are you using mod_python?
Message-ID: <002501c2f5c4$b8d35d10$118a933e@allalswqm99ewu>

----- Original Message -----
From: "pascal barbedor" <pascalbarbedor@free.fr>
To: "Gregory (Grisha) Trubetskoy" <grisha@modpython.org>
Sent: Saturday, March 29, 2003 8:03 AM
Subject: Re: [mod_python] Why are you using mod_python?


> Hi
>
>
> I am using it because it is simple and the documentation is clear and
> simple.
> Its only a little more effort compared to plain cgi and it is faster.
>
> also I use it bare bone, I don't use the publisher and I don't use any
> template system on top of mod_python.
> (I am not fond of template systems, I think req.write is enough)
> I find it modular and convenient to add one handler by directory and I
> usually rely on a directoryindex index.py
> to be able to call the handler simply with /myweb  without anything else,
> which is mapped to myweb/index.py by apache.
> this way I never call a .py file explicitely.
> each index.py is a dispatcher to other .py files in the same dir
> I also have a common directory with site wide classes and functions. and
> that's it.
>
> I use it on win32
> before python I was using perl/mod_perl but its not working very good on
> win32 yet for apache 2, at least I had core dumps related to libxml and so
I
> moved to python/mod_python, and stopped using libxslt or any xlst
transform
> , and now use only sax transform. its clearer than big xls stylesheets.
>
> I find that the documentation could contain more usage examples but is
good
> anyway.
> also the developing process is made uncomparabely better through the debug
> directive which outputs on the browser and the automatic reload of modules
>
> so that I don't see the difference compared to cgi developement, and I see
a
> difference in that I have the satisfaction to use a close to apache API
and
> it's fun.
>
> I must say when I tried the authentication exxample in the doc, I could
not
> make it work.
>
> but still the feeling is that it works very well, development is very
> confortable, and I am glad I tried it.
>
>
> thanks
> pascal
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
> ----- Original Message -----
> From: "Gregory (Grisha) Trubetskoy" <grisha@modpython.org>
> To: <mod_python@modpython.org>
> Sent: Friday, March 28, 2003 11:38 PM
> Subject: [mod_python] Why are you using mod_python?
>
>
> >
> > Hello everyone -
> >
> > As the original author of mod_python I think I'm allowed to jerk
people's
> > chains with this simple question:
> >
> > Why are you using mod_python?
> >
> > You can reply on or off list, either is fine. The results, after I get
to
> > mull over them will be published in one way or another.
> >
> > I've decided to ask the list because I recently realized that I am not
> > sure I know the answer. Not to say that I don't like mod_python, on the
> > contrary, I do, but to formulate in words exactly why is rather
difficult.
> > Besides, my opinion is biased anyway :-)
> >
> > Thanks in advance!
> >
> > Grisha
> >
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://www.modpython.org/mailman/listinfo/mod_python
> >
>


From stevehamilton at blueyonder.co.uk  Sat Mar 29 12:12:42 2003
From: stevehamilton at blueyonder.co.uk (Stephen Hamilton)
Date: Fri Jan  9 22:03:47 2004
Subject: [mod_python] Import Error (windows)
Message-ID: <000801c2f5ec$7fe2c450$0100a8c0@willem>

Python 2.2
Apache 2.0.44
mod_python-3.0.3.win32.exe

new to mod_python and list so be gentle with me

searched through the list and found similar probs but on different
platforms and versions
but no answers (probably me not looking hard enough)

anyway following tutorial and set httpd.conf as said :-

LoadModule python_module modules/mod_python.so

<Directory "C:\Program Files\Apache Group\Apache2\htdocs\test"> 
  AddHandler python-program .py
  PythonHandler mptest.py 
  PythonDebug On 
</Directory>
 
error reads:-
Mod_python error: "PythonHandler mptest.py"
Traceback (most recent call last):
  File "C:\Python22\Lib\site-packages\mod_python\apache.py", line 320, in HandlerDispatch
    module = import_module(module_name, config)
  File "C:\Python22\Lib\site-packages\mod_python\apache.py", line 496, in import_module
    f, p, d = imp.find_module(parts[i], path)

ImportError: No module named py

it's probably a simple answer but can anyone help
thanks in advance
stephen
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20030329/d7038de0/attachment-0003.htm
From pascalbarbedor at free.fr  Sat Mar 29 14:44:32 2003
From: pascalbarbedor at free.fr (pascal barbedor)
Date: Fri Jan  9 22:03:47 2004
Subject: [mod_python] Import Error (windows)
References: <000801c2f5ec$7fe2c450$0100a8c0@willem>
Message-ID: <000b01c2f5f9$54c28050$a8a1933e@allalswqm99ewu>

hi

maybe spaces in path is bad idea, plus forward slashes required

pascal
  ----- Original Message ----- 
  From: Stephen Hamilton 
  To: mod_python@modpython.org 
  Sent: Saturday, March 29, 2003 1:12 PM
  Subject: [mod_python] Import Error (windows)


  Python 2.2
  Apache 2.0.44
  mod_python-3.0.3.win32.exe

  new to mod_python and list so be gentle with me

  searched through the list and found similar probs but on different
  platforms and versions
  but no answers (probably me not looking hard enough)

  anyway following tutorial and set httpd.conf as said :-

  LoadModule python_module modules/mod_python.so

  <Directory "C:\Program Files\Apache Group\Apache2\htdocs\test"> 
    AddHandler python-program .py
    PythonHandler mptest.py 
    PythonDebug On 
  </Directory>
   
  error reads:-
  Mod_python error: "PythonHandler mptest.py"
  Traceback (most recent call last):
    File "C:\Python22\Lib\site-packages\mod_python\apache.py", line 320, in HandlerDispatch
      module = import_module(module_name, config)
    File "C:\Python22\Lib\site-packages\mod_python\apache.py", line 496, in import_module
      f, p, d = imp.find_module(parts[i], path)

  ImportError: No module named py

  it's probably a simple answer but can anyone help
  thanks in advance
  stephen
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20030329/6ec25c38/attachment-0003.htm
From dustin at ywlcs.org  Sat Mar 29 10:04:06 2003
From: dustin at ywlcs.org (Dustin Mitchell)
Date: Fri Jan  9 22:03:47 2004
Subject: [mod_python] Why are you using mod_python?
In-Reply-To: <20030328172826.X67038-100000@eden.ispol.com>
References: <20030328075642.A25172@ash.int.ca.pason.com> <20030328172826.X67038-100000@eden.ispol.com>
Message-ID: <20030329160405.GJ10000@eleanor.internal.ywlcs.org>

I use mod_python because it turns the web server into one very large
event-driven Python program.  I can do whatever I want with requests.  I can
parse URLs however I'd like.  I can construct the response however I'd like.
I have complete control over the transaction, without any hacks or other
impediments.

One of the advantages of having the web server act like a very large Python
program is its speed.  Also, from this frame of mind, caching and
preflighting are almost intuitive (if you've ever done SMP programming before
:-)

Dustin

-- 

  Dustin Mitchell
  dustin@ywlcs.org/djmitche@alumni.uchicago.edu
  http://people.cs.uchicago.edu/~dustin/

From neo at https.ru  Sat Mar 29 22:58:26 2003
From: neo at https.ru (Neo Eureka)
Date: Fri Jan  9 22:03:47 2004
Subject: [mod_python] Import Error (windows)
In-Reply-To: <000801c2f5ec$7fe2c450$0100a8c0@willem>
References: <000801c2f5ec$7fe2c450$0100a8c0@willem>
Message-ID: <245039446.20030329225826@https.ru>

 You should not add ".py" extension.
The correct line is:

 PythonHandler mptest


> Python 2.2
> Apache 2.0.44
> mod_python-3.0.3.win32.exe

> new to mod_python and list so be gentle with me

> searched through the list and found similar probs but on different
> platforms and versions
> but no answers (probably me not looking hard enough)

> anyway following tutorial and set httpd.conf as said :-

> LoadModule python_module modules/mod_python.so

> <Directory "C:\Program Files\Apache Group\Apache2\htdocs\test"> 
>   AddHandler python-program .py
>   PythonHandler mptest.py 
>   PythonDebug On 
> </Directory>
 
> error reads:-
> Mod_python error: "PythonHandler mptest.py"
> Traceback (most recent call last):
>   File "C:\Python22\Lib\site-packages\mod_python\apache.py", line 320, in HandlerDispatch
>     module = import_module(module_name, config)
>   File "C:\Python22\Lib\site-packages\mod_python\apache.py", line 496, in import_module
>     f, p, d = imp.find_module(parts[i], path)

> ImportError: No module named py

> it's probably a simple answer but can anyone help
> thanks in advance
> stephen


--- 
Neo Eureka / mailto:neo@https.ru


From stevehamilton at blueyonder.co.uk  Sat Mar 29 20:20:57 2003
From: stevehamilton at blueyonder.co.uk (Stephen Hamilton)
Date: Fri Jan  9 22:03:47 2004
Subject: [mod_python] re Import Error (windows)
Message-ID: <002d01c2f630$b54709f0$0100a8c0@willem>

update for other wooden heads like me 
without the ".py" it works a treat
thanks for the swift response and your patients
stephen   (8(|) doe


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20030329/e7ab7378/attachment-0003.htm
From ian at veryfresh.com  Sat Mar 29 16:46:45 2003
From: ian at veryfresh.com (Ian Clelland)
Date: Fri Jan  9 22:03:47 2004
Subject: [mod_python] Why are you using mod_python?
In-Reply-To: <20030328231412.24efac21.frank@fejes.net>
References: <20030328075642.A25172@ash.int.ca.pason.com> <20030328172826.X67038-100000@eden.ispol.com> <20030328231412.24efac21.frank@fejes.net>
Message-ID: <20030330004644.GA17569@fullfactor.com>

On Fri, Mar 28, 2003 at 11:14:12PM -0600, Frank S. Fejes III wrote:
> On Fri, 28 Mar 2003 17:38:48 -0500 (EST)
> "Gregory (Grisha) Trubetskoy" <grisha@modpython.org> wrote:
> 
> > 
> > Hello everyone -
> > 
> > As the original author of mod_python I think I'm allowed to jerk people's
> > chains with this simple question:
> > 
> > Why are you using mod_python?

...

> On a somewhat tangential note, I think mod_python documentation reflects
> strangely on what target audience might be interested in the module.  Almost
> all introductions I've seen to mod_python begin with a tutorial on creating
> a handler.  I'd venture a guess that writing handlers is what fewer than 1%
> of web developers want to do with an apache module initially.  In my
> experience, most people want to write some code and have it run faster than
> it would run under straight CGI...they don't want to write custom handlers.

Well, I suppose I must be counted among that 1% :) I switched to
mod_python from PHP and Servlets about <checks CVS> 8 or 9 months ago,
and it was primarily because of the flexibility and power of cutsom
handlers. I love the fact that I can write applications whose URLs have
some meaning besides simply naming a file on the web server's hard
drive.

When I was first introduced to mod_python, I imagined it to be simply a
way to embed python code inline into HTML files (like PHP or JSP,) and I
nearly dismissed it out of hand. I looked at it more carefully, though,
and when I realised that it was more akin to mod_perl, and would
actually give me an opportunity to interact so closely with Apache, I
became much more excited working with it.

Since then, I have adopted many of the tenets of the REST philosophy,
and I have found mod_python to be an ideal platform to develop REST-ful
applications. I doubt I could even go back to the CGI or PHP ways of
doing things now.


But then, that might just be me :)


Ian Clelland
<ian@veryfresh.com>

From peter.bittner at gmx.net  Sun Mar 30 22:55:55 2003
From: peter.bittner at gmx.net (Peter Bittner)
Date: Fri Jan  9 22:03:47 2004
Subject: [mod_python] Why are you using mod_python?
Message-ID: <18707.1049057755@www41.gmx.net>

Hi there!

I like mod_python because I like Python and I am glad whenever I can use it
to write web applications. Customers, however, in most cases ask me to go for
PHP or so since this is easier to find programmers for for maintenance
afterwards.

> Personally, my primary goal in using it (and other mod_* language
> modules) is to improve the performance/scalability of my CGI applications.

This is true for me, too.

> Unfortunately, I really dislike the Publisher handler's way of doing
things
> (the programname.py/method URL syntax feels silly to me) and it seems
> like most people are very down on the capabilities and stability of the
> CGI handler so I find myself just going plain CGI anyway for many things
> now when I use python.

This is absolutely true for myself, too. Clearly, I would appreciate
mod_python to have nothing but advantages, but it does have those unconfortable
features.

> Almost all introductions I've seen to mod_python begin with a
> tutorial on creating a handler.  I'd venture a guess that writing
> handlers is what fewer than 1% of web developers want to do
> with an apache module initially.  In my experience, most people
> want to write some code and have it run faster than it would run
> under straight CGI...they don't want to write custom handlers.

I absolutely agree. This is my opinion, too.

I also do not see why modifying the webserver's (Apache's) configuration
should be advantagous when I, say, add a new directory to my web project. When I
want to write, say, a website, I do not want to go into /etc/apache.conf (I
might not even have access to it!), but I want to go straight into coding.
And porting this code to another webserver should not be a nightmare, but a job
of copying the .py files, that's it.

I like Python and I'd be happy to see mod_python becoming as popular for web
programming as PHP is today.

Cheers, Peter

-- 
Peter Bittner
mail: peter.bittner@gmx.net

"Free software is like free speech, not free beer" (Richard Stallman)

+++ GMX - Mail, Messaging & more  http://www.gmx.net +++
Bitte l?cheln! Fotogalerie online mit GMX ohne eigene Homepage!


From mike.looijmans at asml.com  Mon Mar 31 07:35:36 2003
From: mike.looijmans at asml.com (Mike Looijmans)
Date: Fri Jan  9 22:03:47 2004
Subject: [mod_python] Why are you using mod_python?
Message-ID: <01c2f747$5aecc400$926a1e6e@wsasd464>

Simple: There were a few dozen clients when we started this project. There
will be about 400 when we roll it out worldwide, and I didn't want the server
to spend too much time loading the interpreter for each call.
With CGI, it could process about 2 requests per second. With mod_python, that
increased to over 20 per second.

Keeping database connections alive and some internal caching were nice things
to add (I like a bit of multithreaded programming), but did not add any
measurable performance gains (I guess the Python-MySQL link is just too fast
when all is local).

Our system is now hybrid - servers can either use CGI or mod_python (bot if
they like). But I did not use cgihandler because it also took quite a
performance hit because of reloading a lot of libraries, and after a few dozen
requests the cgi library would lose the os.environ and a restart of the server
would be neccesary to get things going again. Also, cgihandler does not
combine well with Apache's "worker" thread model, cgihandler turns the whole
system into a single-threaded server in that particular case.

--
Mike Looijmans
ASML: http://www5nl.asml.nl/~mlooijma
Private: http://www.milosoftware.com

-----Original Message-----
From: Gregory (Grisha) Trubetskoy <grisha@modpython.org>
To: mod_python@modpython.org <mod_python@modpython.org>
Date: Saturday, March 29, 2003 12:42 AM
Subject: [mod_python] Why are you using mod_python?


>
>Hello everyone -
>
>As the original author of mod_python I think I'm allowed to jerk people's
>chains with this simple question:
>
>Why are you using mod_python?
>



From sandor.kopanyi at mailbox.hu  Mon Mar 31 08:57:35 2003
From: sandor.kopanyi at mailbox.hu (sandor.kopanyi@mailbox.hu)
Date: Fri Jan  9 22:03:47 2004
Subject: [mod_python] Re: Why are you using mod_python?
In-Reply-To: <20030329170001.80558.66529.Mailman@eden.ispol.com>
Message-ID: <20030331065735.16655.qmail@arnold.mailbox.hu>

Hi,

I'm using mod_python because of:
- simplicity
- elegance of Python
- rich Python libs
- quick development

/Sandor
PS. I don't have anything against publisher, I use it regurarly, beside
the other ways


_______________________________________________________________________
http://mailbox.hu - WAP-on is olvashatod




