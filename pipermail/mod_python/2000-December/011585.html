<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] rpm-packaging and DESTDIR
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20rpm-packaging%20and%20DESTDIR&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011592.html">
   <LINK REL="Next"  HREF="011590.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] rpm-packaging and DESTDIR</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Mads Kiilerich</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20rpm-packaging%20and%20DESTDIR&In-Reply-To="
       TITLE="[mod_python] rpm-packaging and DESTDIR">Mads at Kiilerich.com
       </A><BR>
    <I>Thu Dec 28 14:19:02 EST 2000</I>
    <P><UL>
        <LI>Previous message: <A HREF="011592.html">[mod_python] Publisher Handler
</A></li>
        <LI>Next message: <A HREF="011590.html">[mod_python] rpm-packaging and DESTDIR
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11585">[ date ]</a>
              <a href="thread.html#11585">[ thread ]</a>
              <a href="subject.html#11585">[ subject ]</a>
              <a href="author.html#11585">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

I'm hacking the RedHat RPM specs.

First, I've found that 
	./configure --prefix=something 
has no effect at all. It should either be fixed or removed from
the documentation.

For RPM packaging installation in another directory than the one
compiled for is essential. Thus I suggest the attached patch. It
causes any installation to be done below $DESTDIR . If no
DESTDIR is defined in the environment it has no effect.

Also, could you please put the spec used to build rpms in cvs?
And could it be in the root, ie as mod_python/mod_python.spec?
(That makes rpm-building even easier; given a mod_python tar the
rpm's can be build with
	rpm -ta src/mod_python-2.7.1.tar.gz
)

I have some enhancements to the spec as well - but I'll sit on
them until the spec is in cvs.

Happy Newyear from

-- 
Mads Kiilerich          Sys.Adm. Cand.Polyt. Stud.Bibel.
<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mads at Kiilerich.com</A>      Tel. +45 26 20 07 73
Fxvqrevx! Fiva! Qrg re cvffrgneiryvtg ng xelcgrer zrq EBG-13.                   
-------------- next part --------------
Index: Makefile.in
===================================================================
RCS file: /cvsroot/modpython/mod_python/Makefile.in,v
retrieving revision 1.7
diff -u -u -r1.7 Makefile.in
--- Makefile.in	2000/12/06 03:05:37	1.7
+++ Makefile.in	2000/12/28 13:05:01
@@ -82,7 +82,7 @@
 	@echo
 	@echo &quot;Performing DSO installation.&quot;
 	@echo
-	$(INSTALL) src/mod_python.so $(LIBEXECDIR)
+	$(INSTALL) src/mod_python.so $(DESTDIR)$(LIBEXECDIR)
 	@$(MAKE) install_py_lib
 	@echo
 	@echo &quot;Now don't forget to edit your main config and add&quot;
@@ -114,12 +114,12 @@
 	@echo
 
 install_py_lib:
-	$(INSTALL) -d $(PY_STD_LIB)/site-packages/mod_python
+	$(INSTALL) -d $(DESTDIR)$(PY_STD_LIB)/site-packages/mod_python
 	@for f in `ls lib/python/mod_python/*.py`; \
 	do \
-		$(INSTALL) $$f $(PY_STD_LIB)/site-packages/mod_python; \
+		$(INSTALL) $$f $(DESTDIR)$(PY_STD_LIB)/site-packages/mod_python; \
 	done
-	python $(PY_STD_LIB)/compileall.py $(PY_STD_LIB)/site-packages/mod_python
+	python $(PY_STD_LIB)/compileall.py $(DESTDIR)$(PY_STD_LIB)/site-packages/mod_python
 
 clean:
 	cd src &amp;&amp; $(MAKE) clean
</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011592.html">[mod_python] Publisher Handler
</A></li>
	<LI>Next message: <A HREF="011590.html">[mod_python] rpm-packaging and DESTDIR
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11585">[ date ]</a>
              <a href="thread.html#11585">[ thread ]</a>
              <a href="subject.html#11585">[ subject ]</a>
              <a href="author.html#11585">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
