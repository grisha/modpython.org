<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] transhandler setup?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20transhandler%20setup%3F&In-Reply-To=bf10f5f08cc0a26fe706e91aa2557691%40ixopusada.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018908.html">
   <LINK REL="Next"  HREF="018938.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] transhandler setup?</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20transhandler%20setup%3F&In-Reply-To=bf10f5f08cc0a26fe706e91aa2557691%40ixopusada.com"
       TITLE="[mod_python] transhandler setup?">grahamd at dscpl.com.au
       </A><BR>
    <I>Thu Aug 25 22:19:42 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="018908.html">[mod_python] transhandler setup?
</A></li>
        <LI>Next message: <A HREF="018938.html">[mod_python] transhandler setup?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18909">[ date ]</a>
              <a href="thread.html#18909">[ thread ]</a>
              <a href="subject.html#18909">[ subject ]</a>
              <a href="author.html#18909">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>If your content handler doesn't want to handle a request, have it return
apache.DECLINED and Apache will then serve up any static file that may
have been identified by the URL.

   def handler(req):
     extension = os.path.splitext(req.filename)[1]
     if extension == &quot;.html&quot;:
       if not os.path.exists(req.filename):
         ...
       else:
         return apache.DECLINED
     else:
       return apache.DECLINED

That is at least one way of doing it, although this will disable
processing in some cases by other Apache modules such as PHP. You can
get around that by explicitly disabling use of mod_python for that
extension:

   &lt;Directory /document/root&gt;
   SetHandler mod_python
   PythonHandler main
   &lt;Files *.php&gt;
   SetHandler None
   &lt;/Files&gt;
   &lt;/Directory&gt;

Rather than using subtraction, you could instead be additive:

   &lt;Directory /document/root&gt;
   AddHandler mod_python .html
   PythonHandler main
   &lt;/Directory&gt;

Thus, if you are only interested in intercepting .html files, only
have mod_python triggered for them.

In respect of transhandler(), all I can really comment on there is
that if setting PythonTransHandler, you do not need to use either
AddHandler or SetHandler. These latter directives only need to be
used if setting PythonHandler, ie., the content handler. As the
documentation points out, PythonTransHandler can only be used at
top level scope, ie., not with a Directory, Location or Files
directive or in a .htaccess file.

Graham

On 26/08/2005, at 11:57 AM, IR labs wrote:

&gt;<i> Sorry, I haven't been clear. I don't want so much to handle all 
</I>&gt;<i> requests under a directory. I like to handle all requests in general, 
</I>&gt;<i> and than first analyze the url. ((If the it is a certain file (.gif, 
</I>&gt;<i> .jpg, .css, .js) or a certain directory, apache should handle it 
</I>&gt;<i> further, i.e. just serve that file. If it is just a path or a .html, I 
</I>&gt;<i> want a python script to check wether the directory or file indeed 
</I>&gt;<i> exist or not. If the index.html or other .html file doesn't exist the 
</I>&gt;<i> main.py should take it over.))
</I>&gt;<i> So I wan't this analysis be done during the transHandler phase. But 
</I>&gt;<i> how do I make apache run my translate.py first? where do I put my 
</I>&gt;<i> config lines?
</I>&gt;<i> PythonPath &quot;sys.path + ['/some/path']&quot;
</I>&gt;<i> PythonTransHandler translate
</I>&gt;<i>
</I>&gt;<i> thx
</I>&gt;<i> dirk
</I>&gt;<i>
</I>&gt;<i> On 25-aug-05, at 23:01, Graham Dumpleton wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> If you want all requests falling under a directory to be handled by
</I>&gt;&gt;<i> mod_python use SetHandler and not AddHandler. Eg.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>   &lt;Directory /some/path&gt;
</I>&gt;&gt;<i>   SetHandler mod_python
</I>&gt;&gt;<i>   PythonHandler main
</I>&gt;&gt;<i>   &lt;/Directory&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Read the documentation for further information of the difference.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On 25/08/2005, at 9:21 PM, IR labs wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Hi All, a mod_python newbie here.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I am trying to set up my server using mod_python's transhandler, but 
</I>&gt;&gt;&gt;<i> I can't figure out the right configuration. I am experimenting with 
</I>&gt;&gt;&gt;<i> the most crude and basic uri translation possible: every request 
</I>&gt;&gt;&gt;<i> should be redirected to main.py. But somehow apache doesn't want to 
</I>&gt;&gt;&gt;<i> do that. Right now it still displays static pages (.html files) with 
</I>&gt;&gt;&gt;<i> images, etc etc. (where I would think req.filename = 
</I>&gt;&gt;&gt;<i> '/var/www/mod_python_test/main.py' should prevent all of that.)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> This is my setup:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> from httpd.conf :
</I>&gt;&gt;&gt;<i> -----------------------------------------
</I>&gt;&gt;&gt;<i> ...
</I>&gt;&gt;&gt;<i> &lt;IfModule mod_python.c&gt;
</I>&gt;&gt;&gt;<i>     AddHandler mod_python .py
</I>&gt;&gt;&gt;<i>     PythonPath &quot;sys.path + ['/var/www/mod_python_test/']&quot;
</I>&gt;&gt;&gt;<i>     PythonTransHandler translate
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> &lt;/IfModule&gt;
</I>&gt;&gt;&gt;<i> ...
</I>&gt;&gt;&gt;<i> -----------------------------------------
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> my script
</I>&gt;&gt;&gt;<i> /var/www/mod_python_test/translate.py :
</I>&gt;&gt;&gt;<i> -----------------------------------------
</I>&gt;&gt;&gt;<i> from mod_python import apache
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> def transhandler(req):
</I>&gt;&gt;&gt;<i> 	req.filename = '/var/www/mod_python_test/main.py'
</I>&gt;&gt;&gt;<i> 	return apache.OK
</I>&gt;&gt;&gt;<i> -----------------------------------------
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> using
</I>&gt;&gt;&gt;<i> FreeBSD 5.2.1
</I>&gt;&gt;&gt;<i> Apache 2.0.54
</I>&gt;&gt;&gt;<i> mod_python 3.1.4
</I>&gt;&gt;&gt;<i> Python 2.3.2
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Note that my main.py does work through the .htaccess in 
</I>&gt;&gt;&gt;<i> /var/www/mod_python_test/
</I>&gt;&gt;&gt;<i> -----------------------------------------
</I>&gt;&gt;&gt;<i> AddHandler mod_python .py
</I>&gt;&gt;&gt;<i> PythonHandler main
</I>&gt;&gt;&gt;<i> PythonDebug On
</I>&gt;&gt;&gt;<i> -----------------------------------------
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> But it (main.py) should be called for all the url's requested (not 
</I>&gt;&gt;&gt;<i> just for /mod_python_test/whatever.py and friends.)
</I>&gt;&gt;&gt;<i> thx
</I>&gt;&gt;&gt;<i> dirk
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> -----------------------------
</I>&gt;&gt;&gt;<i> Dirk van Oosterbosch
</I>&gt;&gt;&gt;<i> de Wittenstraat 225
</I>&gt;&gt;&gt;<i> 1052 AT Amsterdam
</I>&gt;&gt;&gt;<i> the Netherlands
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> <A HREF="http://labs.ixopusada.com">http://labs.ixopusada.com</A>
</I>&gt;&gt;&gt;<i> -----------------------------
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;<i> Mod_python mailing list
</I>&gt;&gt;&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;&gt;&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -----------------------------
</I>&gt;<i> Dirk van Oosterbosch
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">dirk at ixopusada.com</A>
</I>&gt;<i> -----------------------------
</I>&gt;<i>
</I>
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018908.html">[mod_python] transhandler setup?
</A></li>
	<LI>Next message: <A HREF="018938.html">[mod_python] transhandler setup?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18909">[ date ]</a>
              <a href="thread.html#18909">[ thread ]</a>
              <a href="subject.html#18909">[ subject ]</a>
              <a href="author.html#18909">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
