<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Problem in executing java program using mod_python.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Problem%20in%20executing%20java%20program%20using%20mod_python.&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018836.html">
   <LINK REL="Next"  HREF="018844.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Problem in executing java program using mod_python.</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Manjeet Chaudhary</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Problem%20in%20executing%20java%20program%20using%20mod_python.&In-Reply-To="
       TITLE="[mod_python] Problem in executing java program using mod_python.">manjeet at infogridpacific.com
       </A><BR>
    <I>Tue Aug 16 06:23:39 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="018836.html">[mod_python] tutorials on mod_python
</A></li>
        <LI>Next message: <A HREF="018844.html">[mod_python] Problem in executing java program using mod_python.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18841">[ date ]</a>
              <a href="thread.html#18841">[ thread ]</a>
              <a href="subject.html#18841">[ subject ]</a>
              <a href="author.html#18841">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello All

I am using mod_python and Lucene for searching of Arabic Text from an 
Index created using Lucene+Java.
I am facing some problems in running &quot;java&quot; command using mod_python.

1.   I am trying to run java program using &quot;os.system&quot; command.
    Check = os.system(&quot;java ..........&quot;)

2.   The command returns me a value of 256.
    i.e Check = 256

3.   I am not able to figure it out why that java program is not being 
executed properly.

4.   For the java program i have set the classpath and compiling and 
running that program using the classpath.

    export CLASSPATH = 
/home/ajinkyan/cgi-bin/infoviewer/Jar_Files/lucene-1.4.3.jar 
:<i>/home/ajinkyan/cgi-bin/infoviewer/Jar_Files/PDFBox-0.6.7a.jar 
</I>:<i>/home/ajinkyan/cgi-bin/infoviewer/Jar_Files/log4j-1.2.8.jar 
</I>:<i>/home/ajinkyan/cgi-bin/infoviewer/Jar_Files/tm-extractors-0.4.jar 
</I>:<i>/home/ajinkyan/cgi-bin/infoviewer/Jar_Files/ArabicAnalyzer-1.0b.jar 
</I>:<i>/home/ajinkyan/cgi-bin/infoviewer/Jar_Files/commons-collections-3.1.jar
</I>
    javac -classpath $CLASSPATH:. SearchFiles.java

    java -classpath $ClASSPATH:. SearchFiles

5.   SearchFiles program is running properly if i run it from shell.

So please help me and tell where i am going wrong.
I have attached the copy of code at the end .

Thank you
Manjeet Chaudhary



#!/usr/bin/env python
&quot;&quot;&quot;
#-------------------------------------------------------------------------------------------------------
#Name:       ar_search.py
#Version:    1.0
#Purpose:    Searching for Infoviewer
#Author:     Alok Khandelwal
#Created:    10-08-2005
#Licence:    Infogrid Pacific EULA
#--------------------------------------------------------------------------------------------------------
#Revision History
#--------------------------------------------------------------------------------------------------------

#----------------Different modules required are imported 
here-------------------
&quot;&quot;&quot;
import cgitb,cgi,sys
cgitb.enable()
import os
from os.path import join, abspath
from mod_python import apache,util,Session
&quot;&quot;&quot;
#----------------End of importing 
modules----------------------------------------


def search(req):

    &quot;&quot;&quot;This part takes Arabic keyword from req variable and write that 
keyword into a temp file. This temp file will be opened by java program 
and that program will take that value and search for the variable in the 
index file.
Java program will store the result in results.txt file&quot;&quot;&quot;

    The_Form = util.FieldStorage(req)
    for name in The_Form.keys():
        #--------Checking for the selected Fields and turning those flag 
on--------
        if name == 'search_contents':
            value=The_Form[name]
            value.encode('utf-8')
            f=open(&quot;/home/ajinkyan/cgi-bin/infoviewer/temp.txt&quot;,&quot;w&quot;)
            f.write(value)
            f.close()

            try:
                command = &quot;export 
CLASSPATH=/home/ajinkyan/cgi-bin/infoviewer/Jar_Files/lucene-1.4.3.jar:/home/ajinkyan/cgi-bin/infoviewer/Jar_Files/PDFBox-0.6.7a.jar:/home/ajinkyan/cgi-bin/infoviewer/Jar_Files/log4j-1.2.8.jar:/home/ajinkyan/cgi-bin/infoviewer/Jar_Files/tm-extractors-0.4.jar:/home/ajinkyan/cgi-bin/infoviewer/Jar_Files/ArabicAnalyzer-1.0b.jar:/home/ajinkyan/cgi-bin/infoviewer/Jar_Files/commons-collections-3.1.jar&quot;
                import os
                os.system(command)
                command = &quot;java -classpath 
$CLASSPATH:/home/ajinkyan/cgi-bin/infoviewer SearchFiles&quot;
                check=os.system(command)
                req.write(&quot;\ncheck = &quot; + str(check))
                f  = open(  
&quot;/home/ajinkyan/cgi-bin/infoviewer/results.txt&quot;,&quot;r&quot;)
                result=f.read()
                req.write(result)
            except:

                req.write(&quot;\n&quot;)
                req.write(str(sys.exc_type))
                req.write(&quot;\n&quot;)
                req.write(str(sys.exc_value))



____________________________________________________________________________________________________________________________

# After executing the os.system command the value returned in check is 
maximum times 256 or some thing near 32000 .

# Java program is running independently without any errors. Only when it 
is called using os.system it doesn't run .

# The Java program is as follows

___________________________________________________________________________________________________________________________


/**
* @Name   : SearchFiles.java
* @Version: 1.0
* @Author : Alok Khandelwal
* @Created: 2 August 2005
* @Purpose: Searching in index for arabic contents
* @Copyright:(c)2004 by Infogrid Pacific Pte. Ltd.
* @Licenece :Infogrid Pacific Eula
*/




import org.apache.lucene.search.Searcher;
import org.apache.lucene.search.IndexSearcher;
import org.apache.lucene.search.Query;
import org.apache.lucene.search.Hits;
import org.apache.lucene.queryParser.QueryParser;
import gpl.pierrick.brihaye.aramorph.lucene.ArabicStemAnalyzer;
import java.io.*;
import org.apache.lucene.document.Document;
class SearchFiles
{
    public static void main(String[] args)
    {
        try
        {
            FileInputStream fis = new FileInputStream(new File ( 
&quot;/home/ajinkyan/cgi-bin/infoviewer/temp.txt&quot;));
            BufferedReader in = new BufferedReader(new 
InputStreamReader(fis,&quot;UTF8&quot;));
            char [] buf = new char[80];
            int numRead;
            numRead=in.read(buf,0,80);
            String field=&quot;\&quot;&quot;;
            for(int k=0;k&lt;numRead;k++)
            {
                field=field+buf[k];
            }
            field=field+&quot;\&quot;&quot;;
            FileOutputStream fos = new FileOutputStream(new File ( 
&quot;/home/ajinkyan/cgi-bin/infoviewer/results.txt&quot;));
            BufferedWriter out = new BufferedWriter(new 
OutputStreamWriter(fos,&quot;UTF8&quot;));
            Searcher searcher = new 
IndexSearcher(&quot;/home/ajinkyan/cgi-bin/infoviewer/index_arabic&quot;);
            try
            {
                    Query query = QueryParser.parse(field, &quot;contents&quot;, 
new ArabicStemAnalyzer());
                    Hits hits = searcher.search(query);
                    String output=&quot;Total match document = \n&quot;;
                    for(int j=0;j&lt;hits.length();j++)
                    {
                        Document doc = hits.doc(j);
                    //    System.out.print(hits.score(j)+&quot;  &quot;);
                        output = output +&quot;\n&quot;+ doc.get(&quot;filename&quot;);
                    }
                    out.write(output);
                    out.write(&quot;\n&quot;);
            }
            catch(Exception e)
            {
                out.write(&quot;Parser Error&quot;);
                out.write(&quot;\n&quot;);

            }
            searcher.close();
            out.close();
        }
        catch (Exception e)
        {
            String s= &quot; caught a &quot; + e.getClass() +
             &quot;\n with message: &quot; + e.getMessage();
        }
    }//end of main
}//end of SerchFiles
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018836.html">[mod_python] tutorials on mod_python
</A></li>
	<LI>Next message: <A HREF="018844.html">[mod_python] Problem in executing java program using mod_python.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18841">[ date ]</a>
              <a href="thread.html#18841">[ thread ]</a>
              <a href="subject.html#18841">[ subject ]</a>
              <a href="author.html#18841">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
