<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] How to make mod_python know when Apache
	is	shutdown/restarted?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20How%20to%20make%20mod_python%20know%20when%20Apache%0A%09is%09shutdown/restarted%3F&In-Reply-To=42F3FF00.5040309%40mischko.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018801.html">
   <LINK REL="Next"  HREF="018803.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] How to make mod_python know when Apache
	is	shutdown/restarted?</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20How%20to%20make%20mod_python%20know%20when%20Apache%0A%09is%09shutdown/restarted%3F&In-Reply-To=42F3FF00.5040309%40mischko.com"
       TITLE="[mod_python] How to make mod_python know when Apache
	is	shutdown/restarted?">grahamd at dscpl.com.au
       </A><BR>
    <I>Fri Aug  5 20:13:08 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="018801.html">[mod_python] How to make mod_python know when Apache
	is	shutdown/restarted?
</A></li>
        <LI>Next message: <A HREF="018803.html">[mod_python] How to make mod_python know when Apache
	is	shutdown/restarted?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18802">[ date ]</a>
              <a href="thread.html#18802">[ thread ]</a>
              <a href="subject.html#18802">[ subject ]</a>
              <a href="author.html#18802">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On 06/08/2005, at 10:06 AM, Scott Chapman wrote:

&gt;<i> Graham Dumpleton wrote:
</I>&gt;<i>  &gt; Since to get the server object you need a request object, the only
</I>&gt;&gt;<i> option is to call it as a side effect of a request. To avoid calling 
</I>&gt;&gt;<i> it
</I>&gt;&gt;<i> more than once, you simply need to keep a global data flag some where
</I>&gt;&gt;<i> which you can set the first time you register the cleanup handler
</I>&gt;&gt;<i> thereby avoiding calling it again.
</I>&gt;<i>
</I>&gt;<i> Is there any way to store something global in memory on a per-child 
</I>&gt;<i> basis, rather than in a session (which goes out to a dbm file)?
</I>
You could still use a module imported using PythonImport for that 
purpose.

What you probably want to do is used PythonImport like you were before 
but
don't have it trigger the connection to the database system. When a call
comes into access the database via that module later on, use your flag
stored as global data in that module or in your database connection 
object
to check at that point. If first time, connect to database and register
cleanup handler.

BTW, almost have a working version of apache.register_cleanup() going 
anyway
if you want to try it when I am done. Means modify mod_python source 
though.

Graham

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018801.html">[mod_python] How to make mod_python know when Apache
	is	shutdown/restarted?
</A></li>
	<LI>Next message: <A HREF="018803.html">[mod_python] How to make mod_python know when Apache
	is	shutdown/restarted?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18802">[ date ]</a>
              <a href="thread.html#18802">[ thread ]</a>
              <a href="subject.html#18802">[ subject ]</a>
              <a href="author.html#18802">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
