<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] My template script isn't working
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20My%20template%20script%20isn%27t%20working&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018927.html">
   <LINK REL="Next"  HREF="018929.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] My template script isn't working</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20My%20template%20script%20isn%27t%20working&In-Reply-To="
       TITLE="[mod_python] My template script isn't working">grahamd at dscpl.com.au
       </A><BR>
    <I>Sun Aug 28 20:28:34 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="018927.html">[mod_python] My template script isn't working
</A></li>
        <LI>Next message: <A HREF="018929.html">[mod_python] My template script isn't working
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18928">[ date ]</a>
              <a href="thread.html#18928">[ thread ]</a>
              <a href="subject.html#18928">[ subject ]</a>
              <a href="author.html#18928">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Where ever you keep your templates, you can't use a relative path to the
filename argument as the current working directory could be set to
anything. You therefore must use an absolute pathname meaning you either
have to hard code pathnames (bad), express them relative to a hard coded
pathname set as a PythonOption setting (not so bad), or express them
relative to the location of the script as determined from __file__.

Thus, even if that exact code you provided may work now, there is no
gaurantee that it would work under a different Apache setup where the
working directory of Apache is different.

Anton wrote ..
&gt;<i> Actualy I keep *.tmpl in &quot;templates&quot; directory.
</I>&gt;<i> I turned apache debug logging on and got 1 'info':
</I>&gt;<i> [Mon Aug 29 02:09:58 2005] [info] (104)Connection reset by peer:
</I>&gt;<i> core_output_filter: writing data to the network
</I>&gt;<i> 
</I>&gt;<i> It explains my problem. But I don't know how it helps to solve my problem.
</I>&gt;<i> 
</I>&gt;<i> 2005/8/29, Graham Dumpleton &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">grahamd at dscpl.com.au</A>&gt;:
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; On 29/08/2005, at 8:49 AM, Anton wrote:
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; &gt; I am migrating from php to python. Simple script are attached with
</I>&gt;<i> &gt; &gt; templates.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; The problem is script isn't being processed by apache (It's not
</I>&gt;<i> &gt; &gt; AddHandler stuff). And I think something is segfaulting.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; What is wrong with it?
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Script works if I, for example, change QUOTE to QUOTE2 and error
</I>&gt;<i> &gt; &gt; occurs:
</I>&gt;<i> &gt; &gt; NameError: name 'QUOTE' is not defined
</I>&gt;<i> &gt; &gt; &lt;index.py&gt;&lt;style.css&gt;&lt;header.tmpl&gt;&lt;index.tmpl&gt;&lt;right.tmpl&gt;_____________
</I>&gt;<i> &gt; &gt; _________________________________
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; In your code you have:
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt;    from mod_python import apache,psp
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt;    def index(req):
</I>&gt;<i> &gt;      quote = 'quote_of_the_day'
</I>&gt;<i> &gt;      tmpl = psp.PSP(req, filename='templates/index.tmpl')
</I>&gt;<i> &gt;      tmpl.run( vars={'QUOTES':quote} )
</I>&gt;<i> &gt;      return apache.OK
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; The current working directory will not be that of your script. For
</I>&gt;<i> &gt; starters, try instead:
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt;    from mod_python import apache,psp
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt;    import os
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt;    __here__ = os.path.dirname(__file__)
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt;    def index(req):
</I>&gt;<i> &gt;      quote = 'quote_of_the_day'
</I>&gt;<i> &gt;      tmpl = psp.PSP(req, filename=os.path.join(__here__,'index.tmpl'))
</I>&gt;<i> &gt;      tmpl.run( vars={'QUOTES':quote} )
</I>&gt;<i> &gt;      return apache.OK
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt;
</I></PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018927.html">[mod_python] My template script isn't working
</A></li>
	<LI>Next message: <A HREF="018929.html">[mod_python] My template script isn't working
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18928">[ date ]</a>
              <a href="thread.html#18928">[ thread ]</a>
              <a href="subject.html#18928">[ subject ]</a>
              <a href="author.html#18928">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
