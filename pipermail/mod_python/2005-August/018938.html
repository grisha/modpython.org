<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] transhandler setup?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20transhandler%20setup%3F&In-Reply-To=c81dfac26014a65427f09a833aaf43fa%40dscpl.com.au">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018909.html">
   <LINK REL="Next"  HREF="018939.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] transhandler setup?</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>IR labs</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20transhandler%20setup%3F&In-Reply-To=c81dfac26014a65427f09a833aaf43fa%40dscpl.com.au"
       TITLE="[mod_python] transhandler setup?">labs at ixopusada.com
       </A><BR>
    <I>Tue Aug 30 15:44:15 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="018909.html">[mod_python] transhandler setup?
</A></li>
        <LI>Next message: <A HREF="018939.html">[mod_python] transhandler setup?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18938">[ date ]</a>
              <a href="thread.html#18938">[ thread ]</a>
              <a href="subject.html#18938">[ subject ]</a>
              <a href="author.html#18938">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Sorry for a late reply.

I feel really silly for my problem, *really* silly. (almost too silly 
to let you all know ...)
After trying all different things in the httpd.conf and not seeing any 
noticeable result, I started thinking it could be having to do with 
apache not reading it after I issued &quot;sudo apachectl restart&quot;. And then 
I realized that, after I upgraded to apache 2, to make mod_python work 
decently, I forgot to also change the path to /usr/local/apache2/bin in 
my .profile. DUH... So every time I tried to made a change to apache2's 
httpd.conf and &quot;restarted&quot; I restarted apache 1, ... well, zero points 
for dirk and no desert for a week. :-(

So I got everything working in the end.

But thanks for this solution to have everything (also the stuff we 
don't want to handle) handled by the handler in main.py.
My only remaining question now, would be what you recommend?
1. Don't use the transhandle phase, and have *all* requests handled by 
the main PythonHandler, including the ones it shouldn't handle ( 
apache.DECLINE)
or.
2. Use the TransHandler phase to discern between real physical present 
files (requests for .html, .css, .js etc. files) and virtual pages that 
should be handled by main.py

Thanks,
dirk

On 26-aug-05, at 04:19, Graham Dumpleton wrote:

&gt;<i> If your content handler doesn't want to handle a request, have it 
</I>&gt;<i> return
</I>&gt;<i> apache.DECLINED and Apache will then serve up any static file that may
</I>&gt;<i> have been identified by the URL.
</I>&gt;<i>
</I>&gt;<i>   def handler(req):
</I>&gt;<i>     extension = os.path.splitext(req.filename)[1]
</I>&gt;<i>     if extension == &quot;.html&quot;:
</I>&gt;<i>       if not os.path.exists(req.filename):
</I>&gt;<i>         ...
</I>&gt;<i>       else:
</I>&gt;<i>         return apache.DECLINED
</I>&gt;<i>     else:
</I>&gt;<i>       return apache.DECLINED
</I>&gt;<i>
</I>&gt;<i> That is at least one way of doing it, although this will disable
</I>&gt;<i> processing in some cases by other Apache modules such as PHP. You can
</I>&gt;<i> get around that by explicitly disabling use of mod_python for that
</I>&gt;<i> extension:
</I>&gt;<i>
</I>&gt;<i>   &lt;Directory /document/root&gt;
</I>&gt;<i>   SetHandler mod_python
</I>&gt;<i>   PythonHandler main
</I>&gt;<i>   &lt;Files *.php&gt;
</I>&gt;<i>   SetHandler None
</I>&gt;<i>   &lt;/Files&gt;
</I>&gt;<i>   &lt;/Directory&gt;
</I>&gt;<i>
</I>&gt;<i> Rather than using subtraction, you could instead be additive:
</I>&gt;<i>
</I>&gt;<i>   &lt;Directory /document/root&gt;
</I>&gt;<i>   AddHandler mod_python .html
</I>&gt;<i>   PythonHandler main
</I>&gt;<i>   &lt;/Directory&gt;
</I>&gt;<i>
</I>&gt;<i> Thus, if you are only interested in intercepting .html files, only
</I>&gt;<i> have mod_python triggered for them.
</I>&gt;<i>
</I>&gt;<i> In respect of transhandler(), all I can really comment on there is
</I>&gt;<i> that if setting PythonTransHandler, you do not need to use either
</I>&gt;<i> AddHandler or SetHandler. These latter directives only need to be
</I>&gt;<i> used if setting PythonHandler, ie., the content handler. As the
</I>&gt;<i> documentation points out, PythonTransHandler can only be used at
</I>&gt;<i> top level scope, ie., not with a Directory, Location or Files
</I>&gt;<i> directive or in a .htaccess file.
</I>&gt;<i>
</I>&gt;<i> Graham
</I>&gt;<i>
</I>&gt;<i> On 26/08/2005, at 11:57 AM, IR labs wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Sorry, I haven't been clear. I don't want so much to handle all 
</I>&gt;&gt;<i> requests under a directory. I like to handle all requests in general, 
</I>&gt;&gt;<i> and than first analyze the url. ((If the it is a certain file (.gif, 
</I>&gt;&gt;<i> .jpg, .css, .js) or a certain directory, apache should handle it 
</I>&gt;&gt;<i> further, i.e. just serve that file. If it is just a path or a .html, 
</I>&gt;&gt;<i> I want a python script to check wether the directory or file indeed 
</I>&gt;&gt;<i> exist or not. If the index.html or other .html file doesn't exist the 
</I>&gt;&gt;<i> main.py should take it over.))
</I>&gt;&gt;<i> So I wan't this analysis be done during the transHandler phase. But 
</I>&gt;&gt;<i> how do I make apache run my translate.py first? where do I put my 
</I>&gt;&gt;<i> config lines?
</I>&gt;&gt;<i> PythonPath &quot;sys.path + ['/some/path']&quot;
</I>&gt;&gt;<i> PythonTransHandler translate
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> thx
</I>&gt;&gt;<i> dirk
</I>&gt;<i>
</I>
-----------------------------
Dirk van Oosterbosch
<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">dirk at ixopusada.com</A>
-----------------------------


</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018909.html">[mod_python] transhandler setup?
</A></li>
	<LI>Next message: <A HREF="018939.html">[mod_python] transhandler setup?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18938">[ date ]</a>
              <a href="thread.html#18938">[ thread ]</a>
              <a href="subject.html#18938">[ subject ]</a>
              <a href="author.html#18938">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
