From scarfboy at gmail.com  Sun Apr  1 17:27:47 2007
From: scarfboy at gmail.com (Bart)
Date: Sun Apr  1 17:27:53 2007
Subject: [mod_python] in modpython ,how to restrict the upload file size?
In-Reply-To: <88e286470703311818g107ae776o83dc5c980ab7b102@mail.gmail.com>
References: <op.tp0i14eqju6s6z@localhost>
	<88e286470703302228yf82dd1fy5ebf80855a1c6ac@mail.gmail.com>
	<op.tp2idnluju6s6z@trilobit>
	<88e286470703311818g107ae776o83dc5c980ab7b102@mail.gmail.com>
Message-ID: <b71082d80704011427h1b979fdbk30193334c26e5d8e@mail.gmail.com>

> BTW, please use reply-all to keep discussion on mailing list.

Is there no way to configure your mailing list to override Reply-To,
or whatever
the standards say?
I find this the strangest mailing list behaviour I've met, and it's
just too easy
to do it wrong - the obvious thing that works in every other list I've been in
is the most wrong thing in this one...
From graham.dumpleton at gmail.com  Sun Apr  1 17:48:19 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sun Apr  1 17:48:22 2007
Subject: [mod_python] in modpython ,how to restrict the upload file size?
In-Reply-To: <b71082d80704011427h1b979fdbk30193334c26e5d8e@mail.gmail.com>
References: <op.tp0i14eqju6s6z@localhost>
	<88e286470703302228yf82dd1fy5ebf80855a1c6ac@mail.gmail.com>
	<op.tp2idnluju6s6z@trilobit>
	<88e286470703311818g107ae776o83dc5c980ab7b102@mail.gmail.com>
	<b71082d80704011427h1b979fdbk30193334c26e5d8e@mail.gmail.com>
Message-ID: <88e286470704011448t765fddfen93f3ee9b36abb235@mail.gmail.com>

Active people on the project have no way of changing it, plus there
are just as many people who seem to believe the way it is now is
correct as described in:

  http://www.unicom.com/pw/reply-to-harmful.html

If you check the mailing list archives you will see countless other
discussions about it.

Graham

On 02/04/07, Bart <scarfboy@gmail.com> wrote:
> > BTW, please use reply-all to keep discussion on mailing list.
>
> Is there no way to configure your mailing list to override Reply-To,
> or whatever
> the standards say?
> I find this the strangest mailing list behaviour I've met, and it's
> just too easy
> to do it wrong - the obvious thing that works in every other list I've been in
> is the most wrong thing in this one...
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From scarfboy at gmail.com  Sun Apr  1 18:42:36 2007
From: scarfboy at gmail.com (Bart)
Date: Sun Apr  1 18:42:47 2007
Subject: [mod_python] in modpython ,how to restrict the upload file size?
In-Reply-To: <88e286470704011448t765fddfen93f3ee9b36abb235@mail.gmail.com>
References: <op.tp0i14eqju6s6z@localhost>
	<88e286470703302228yf82dd1fy5ebf80855a1c6ac@mail.gmail.com>
	<op.tp2idnluju6s6z@trilobit>
	<88e286470703311818g107ae776o83dc5c980ab7b102@mail.gmail.com>
	<b71082d80704011427h1b979fdbk30193334c26e5d8e@mail.gmail.com>
	<88e286470704011448t765fddfen93f3ee9b36abb235@mail.gmail.com>
Message-ID: <b71082d80704011542q5b7c0ee6hc0bc7ef4031cc5dc@mail.gmail.com>

On 4/1/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> Active people on the project have no way of changing it, plus there
I don't actually know what you mean with that. Is its admin not around?
Does it not support this feature or not allow change while active?


> are just as many people who seem to believe the way it is now is
> correct as described in:
>
>   http://www.unicom.com/pw/reply-to-harmful.html

I get their actual point, even if it's presented badly. I also
disagree with it as long as it's based on "You suck through using a
common mail program rather than this [dead link] or this [dead link]
*reasonable* one". Silly us.

I could get into arguments of fair expectation, CC-fests that can't be
seen or joined once its separates from the list, having to do having
to six operations to reply to this mailing list or
means people get doubles, but if it's impossible to change anyway...


> If you check the mailing list archives you will see countless other
> discussions about it.
I know, I observed or participated in one or maybe two. I just
continue to be hopeful:)

Oh well. It was worth a try.


--Bart
From graham.dumpleton at gmail.com  Sun Apr  1 19:49:46 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sun Apr  1 19:49:49 2007
Subject: [mod_python] in modpython ,how to restrict the upload file size?
In-Reply-To: <b71082d80704011542q5b7c0ee6hc0bc7ef4031cc5dc@mail.gmail.com>
References: <op.tp0i14eqju6s6z@localhost>
	<88e286470703302228yf82dd1fy5ebf80855a1c6ac@mail.gmail.com>
	<op.tp2idnluju6s6z@trilobit>
	<88e286470703311818g107ae776o83dc5c980ab7b102@mail.gmail.com>
	<b71082d80704011427h1b979fdbk30193334c26e5d8e@mail.gmail.com>
	<88e286470704011448t765fddfen93f3ee9b36abb235@mail.gmail.com>
	<b71082d80704011542q5b7c0ee6hc0bc7ef4031cc5dc@mail.gmail.com>
Message-ID: <88e286470704011649w69330ea0j63fc2f73cb4baa7b@mail.gmail.com>

On 02/04/07, Bart <scarfboy@gmail.com> wrote:
> On 4/1/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > Active people on the project have no way of changing it, plus there
> I don't actually know what you mean with that. Is its admin not around?
> Does it not support this feature or not allow change while active?

The mailing list is hosted on modpython.org. Only Grisha has access to
that machine and he does not participate in the day to day going
activities of mod_python any more. When we do need to contact him, he
doesn't even always respond. So, even if he was agreeable getting hold
of him in the first place to do anything about it is a totally
different matter.

Graham
From Brian.McCann at viziant.net  Wed Apr  4 00:31:02 2007
From: Brian.McCann at viziant.net (Brian McCann)
Date: Wed Apr  4 00:31:36 2007
Subject: [mod_python] mod_python install fails
Message-ID: <93066C069973ED448DC2BCEA9C44A7382BCCA1@efmailx.theeagleforce.com>

Hi,
 
I'm trying to install mod_python on a RedHat4 enterprise server which has CollabNets's
SVN runing with apache 2.2.3 installed I'm getting the following errors.
any help would be greatly appreciated
Thanks,
Brian
 
 
I ran config,make,make install, but get the errors below when I try to restart apache, here is the full out put from config, as you can see there a a few problems 
1. I point to apxs2 but the config script ignores and uses apxs 
2. config uses apache 2.0.52 but should be using the one installed with CollabNetSVN 2.2.3 
I also put the apache restart error at the bottom of this comment 
Thanks, 
Brian 
******************************************************************************* 
[root@sirius1 mod_python-3.3.1]# ./configure --with-python=/usr/bin/python2.3 --with-apxs2=/usr/sbi 
n/apxs2 --with-flex=/usr/bin/flex 
checking for gcc... gcc 
checking for C compiler default output file name... a.out 
checking whether the C compiler works... yes 
checking whether we are cross compiling... no 
checking for suffix of executables... 
checking for suffix of object files... o 
checking whether we are using the GNU C compiler... yes 
checking whether gcc accepts -g... yes 
checking for gcc option to accept ANSI C... none needed 
checking for ar... ar 
checking for a BSD-compatible install... /usr/bin/install -c 
checking whether make sets $(MAKE)... yes 
checking for main in -lm... yes 
checking for an ANSI C-conforming const... yes 
checking your blood pressure... a bit high, but we can proceed 
configure: checking whether apxs is available... 
checking for --with-apxs... no 
checking for apxs in /usr/local/apache/sbin... no 
checking for apxs in your PATH... checking for apxs... /usr/sbin/apxs 
found /usr/sbin/apxs, we'll use this. Use --with-apxs to specify another. 
checking Apache version... 2.0.52 
checking for Apache libexec directory... /usr/lib/httpd/modules 
checking for Apache include directory... -I/usr/include/httpd 
checking for --with-python... /usr/bin/python2.3 
checking Python version... 2.3 
checking Python install prefix... /usr 
checking checking where python libraries are installed... /usr/lib/python2.3 
checking for Py_NewInterpreter in -lpython2.3... yes 
checking what libraries Python was linked with... -lpython2.3 -lpthread -ldl -lutil -lm 
checking linker flags used to link Python... 
checking where Python include files are... -I/usr/include/python2.3 
checking for --with-python-src... no 
checking for --with-mutex-dir... no 
Using MUTEX_DIR /tmp 
checking for --with-max-locks... no 
Using 8 MAX_LOCKS. 
checking for --with-flex... /usr/bin/flex 
found /usr/bin/flex, we'll use this. Use --with-flex to specify another. 
checking flex version... configure: WARNING: Flex version 2.5.4 found. 
Version 2.5.31 or greater is required. You can generally ignore this 
warning unless you need to regenerate psp_parser.c from psp_parse.l. 
If you do need regenerate psp_parser.c, use --with-flex to specify the 
location of the correct flex version. See the README for more information. 
configure: creating ./config.status 
config.status: creating Makefile 
config.status: creating src/Makefile 
config.status: creating Doc/Makefile 
config.status: creating src/include/mod_python.h 
config.status: creating test/Makefile 
config.status: creating test/testconf.py 
config.status: creating dist/setup.py 
config.status: creating dist/Makefile 
[root@sirius1 mod_python-3.3.1]# 
***************************************************************** 
Apache restart error 
[root@sirius1 bin]# apachectl restart 
httpd: Syntax error on line 55 of /etc/opt/CollabNet_Subversion/conf/httpd.conf: API module structure `python_module' in file /usr/lib/httpd/modules/m 
od_python.so is garbled - perhaps this is not an Apache module DSO?

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070404/bed73b2e/attachment.html
From graham.dumpleton at gmail.com  Wed Apr  4 00:41:55 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Apr  4 00:41:58 2007
Subject: [mod_python] mod_python install fails
In-Reply-To: <93066C069973ED448DC2BCEA9C44A7382BCCA1@efmailx.theeagleforce.com>
References: <93066C069973ED448DC2BCEA9C44A7382BCCA1@efmailx.theeagleforce.com>
Message-ID: <88e286470704032141v443ff12bnc740a0f93548339@mail.gmail.com>

On 04/04/07, Brian McCann <Brian.McCann@viziant.net> wrote:
> I'm trying to install mod_python on a RedHat4 enterprise server which has
> CollabNets's
> SVN runing with apache 2.2.3 installed I'm getting the following errors.
> any help would be greatly appreciated
>
> I ran config,make,make install, but get the errors below when I try to
> restart apache, here is the full out put from config, as you can see there a
> a few problems
> 1. I point to apxs2 but the config script ignores and uses apxs

But you use the wrong option to configure. There is no --with-apxs2
option, use --with-apxs instead:

./configure  --with-python=/usr/bin/python2.3
--with-apxs=/usr/sbin/apxs2 --with-flex=/usr/bin/flex

> 2. config uses apache 2.0.52 but should be using the one installed with
> CollabNetSVN 2.2.3
> I also put the apache restart error at the bottom of this comment
> Thanks,
> Brian
> *******************************************************************************
> [root@sirius1 mod_python-3.3.1]# ./configure
> --with-python=/usr/bin/python2.3 --with-apxs2=/usr/sbi
> n/apxs2 --with-flex=/usr/bin/flex
> checking for gcc... gcc
> checking for C compiler default output file name... a.out
> checking whether the C compiler works... yes
> checking whether we are cross compiling... no
> checking for suffix of executables...
> checking for suffix of object files... o
> checking whether we are using the GNU C compiler... yes
> checking whether gcc accepts -g... yes
> checking for gcc option to accept ANSI C... none needed
> checking for ar... ar
> checking for a BSD-compatible install... /usr/bin/install -c
> checking whether make sets $(MAKE)... yes
> checking for main in -lm... yes
> checking for an ANSI C-conforming const... yes
> checking your blood pressure... a bit high, but we can proceed
> configure: checking whether apxs is available...
> checking for --with-apxs... no
> checking for apxs in /usr/local/apache/sbin... no
> checking for apxs in your PATH... checking for apxs... /usr/sbin/apxs
> found /usr/sbin/apxs, we'll use this. Use --with-apxs to specify another.
> checking Apache version... 2.0.52
> checking for Apache libexec directory... /usr/lib/httpd/modules
> checking for Apache include directory... -I/usr/include/httpd
> checking for --with-python... /usr/bin/python2.3
> checking Python version... 2.3
> checking Python install prefix... /usr
> checking checking where python libraries are installed... /usr/lib/python2.3
> checking for Py_NewInterpreter in -lpython2.3... yes
> checking what libraries Python was linked with... -lpython2.3 -lpthread -ldl
> -lutil -lm
> checking linker flags used to link Python...
> checking where Python include files are... -I/usr/include/python2.3
> checking for --with-python-src... no
> checking for --with-mutex-dir... no
> Using MUTEX_DIR /tmp
> checking for --with-max-locks... no
> Using 8 MAX_LOCKS.
> checking for --with-flex... /usr/bin/flex
> found /usr/bin/flex, we'll use this. Use --with-flex to specify another.
> checking flex version... configure: WARNING: Flex version 2.5.4 found.
> Version 2.5.31 or greater is required. You can generally ignore this
> warning unless you need to regenerate psp_parser.c from psp_parse.l.
> If you do need regenerate psp_parser.c, use --with-flex to specify the
> location of the correct flex version. See the README for more information.
> configure: creating ./config.status
> config.status: creating Makefile
> config.status: creating src/Makefile
> config.status: creating Doc/Makefile
> config.status: creating src/include/mod_python.h
> config.status: creating test/Makefile
> config.status: creating test/testconf.py
> config.status: creating dist/setup.py
> config.status: creating dist/Makefile
> [root@sirius1 mod_python-3.3.1]#
> *****************************************************************
> Apache restart error
> [root@sirius1 bin]# apachectl restart
> httpd: Syntax error on line 55 of
> /etc/opt/CollabNet_Subversion/conf/httpd.conf: API module
> structure `python_module' in file /usr/lib/httpd/modules/m
> od_python.so is garbled - perhaps this is not an Apache module DSO?
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
From graham.dumpleton at gmail.com  Wed Apr  4 07:57:39 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Apr  4 07:58:03 2007
Subject: [mod_python] mod_python install fails
In-Reply-To: <93066C069973ED448DC2BCEA9C44A7382BCCA2@efmailx.theeagleforce.com>
References: <93066C069973ED448DC2BCEA9C44A7382BCCA1@efmailx.theeagleforce.com>
	<88e286470704032141v443ff12bnc740a0f93548339@mail.gmail.com>
	<93066C069973ED448DC2BCEA9C44A7382BCCA2@efmailx.theeagleforce.com>
Message-ID: <88e286470704040457x77af37e3u1382a1ae1451b082@mail.gmail.com>

On 04/04/07, Brian McCann <Brian.McCann@viziant.net> wrote:
>
>
>
> Hi Graham,
>
> I made the change you sugested in configure but get the following errors in
> bold  below
> any ideas?
> Thanks,
> Brian
> [root@sirius1 mod_python-3.3.1]# ./configure
> --with-python=/usr/bin/python2.3
> --with-apxs=/usr/sbin/apxs2 --with-flex=/usr/bin/flex
> checking for gcc... gcc
> checking for C compiler default output file name... a.out
> checking whether the C compiler works... yes
> checking whether we are cross compiling... no
> checking for suffix of executables...
> checking for suffix of object files... o
> checking whether we are using the GNU C compiler... yes
> checking whether gcc accepts -g... yes
> checking for gcc option to accept ANSI C... none needed
> checking for ar... ar
> checking for a BSD-compatible install... /usr/bin/install -c
> checking whether make sets $(MAKE)... yes
> checking for main in -lm... yes
> checking for an ANSI C-conforming const... yes
> checking your blood pressure... a bit high, but we can proceed
> configure: checking whether apxs is available...
> checking for --with-apxs... /usr/sbin/apxs2 executable, good
> checking Apache version... apxs:Error: /usr/sbin/httpd2 not found or not
> executable.
> apxs:Error: /usr/sbin/httpd2 not found or not executable.
> ./configure: line 2713: /: is a directory
> configure: error: This version of mod_python only works with Apache 2. The
> one you have seems to be .
> [root@sirius1 mod_python-3.3.1]#

What is the actual path to your 'httpd'? Is it '/usr/bin/httpd'?

If when you run:

  apxs2 -q TARGET

it generates:

  httpd2

then suggests your Apache installation is broken in some way.

Can only suggest you modify the mod_python configure program and look for:

  HTTPD="`${APXS} -q SBINDIR`/`${APXS} -q TARGET`"

change it to:

  HTTPD="/usr/bin/httpd"

or whatever the actual path to the web server executable is.

Rerun configure. This may or may no get you further.

Graham

>  ________________________________
>  From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
> Sent: Wed 4/4/2007 12:41 AM
> To: Brian McCann
> Cc: mod_python@modpython.org
> Subject: Re: [mod_python] mod_python install fails
>
>
>
>
> On 04/04/07, Brian McCann <Brian.McCann@viziant.net> wrote:
> > I'm trying to install mod_python on a RedHat4 enterprise server which has
> > CollabNets's
> > SVN runing with apache 2.2.3 installed I'm getting the following errors.
> > any help would be greatly appreciated
> >
> > I ran config,make,make install, but get the errors below when I try to
> > restart apache, here is the full out put from config, as you can see there
> a
> > a few problems
> > 1. I point to apxs2 but the config script ignores and uses apxs
>
> But you use the wrong option to configure. There is no --with-apxs2
> option, use --with-apxs instead:
>
> ./configure  --with-python=/usr/bin/python2.3
> --with-apxs=/usr/sbin/apxs2 --with-flex=/usr/bin/flex
>
> > 2. config uses apache 2.0.52 but should be using the one installed with
> > CollabNetSVN 2.2.3
> > I also put the apache restart error at the bottom of this comment
> > Thanks,
> > Brian
> >
> *******************************************************************************
> > [root@sirius1 mod_python-3.3.1]# ./configure
> > --with-python=/usr/bin/python2.3 --with-apxs2=/usr/sbi
> > n/apxs2 --with-flex=/usr/bin/flex
> > checking for gcc... gcc
> > checking for C compiler default output file name... a.out
> > checking whether the C compiler works... yes
> > checking whether we are cross compiling... no
> > checking for suffix of executables...
> > checking for suffix of object files... o
> > checking whether we are using the GNU C compiler... yes
> > checking whether gcc accepts -g... yes
> > checking for gcc option to accept ANSI C... none needed
> > checking for ar... ar
> > checking for a BSD-compatible install... /usr/bin/install -c
> > checking whether make sets $(MAKE)... yes
> > checking for main in -lm... yes
> > checking for an ANSI C-conforming const... yes
> > checking your blood pressure... a bit high, but we can proceed
> > configure: checking whether apxs is available...
> > checking for --with-apxs... no
> > checking for apxs in /usr/local/apache/sbin... no
> > checking for apxs in your PATH... checking for apxs... /usr/sbin/apxs
> > found /usr/sbin/apxs, we'll use this. Use --with-apxs to specify another.
> > checking Apache version... 2.0.52
> > checking for Apache libexec directory... /usr/lib/httpd/modules
> > checking for Apache include directory... -I/usr/include/httpd
> > checking for --with-python... /usr/bin/python2.3
> > checking Python version... 2.3
> > checking Python install prefix... /usr
> > checking checking where python libraries are installed...
> /usr/lib/python2.3
> > checking for Py_NewInterpreter in -lpython2.3... yes
> > checking what libraries Python was linked with... -lpython2.3 -lpthread
> -ldl
> > -lutil -lm
> > checking linker flags used to link Python...
> > checking where Python include files are... -I/usr/include/python2.3
> > checking for --with-python-src... no
> > checking for --with-mutex-dir... no
> > Using MUTEX_DIR /tmp
> > checking for --with-max-locks... no
> > Using 8 MAX_LOCKS.
> > checking for --with-flex... /usr/bin/flex
> > found /usr/bin/flex, we'll use this. Use --with-flex to specify another.
> > checking flex version... configure: WARNING: Flex version 2.5.4 found.
> > Version 2.5.31 or greater is required. You can generally ignore this
> > warning unless you need to regenerate psp_parser.c from psp_parse.l.
> > If you do need regenerate psp_parser.c, use --with-flex to specify the
> > location of the correct flex version. See the README for more information.
> > configure: creating ./config.status
> > config.status: creating Makefile
> > config.status: creating src/Makefile
> > config.status: creating Doc/Makefile
> > config.status: creating src/include/mod_python.h
> > config.status: creating test/Makefile
> > config.status: creating test/testconf.py
> > config.status: creating dist/setup.py
> > config.status: creating dist/Makefile
> > [root@sirius1 mod_python-3.3.1]#
> >
> *****************************************************************
> > Apache restart error
> > [root@sirius1 bin]# apachectl restart
> > httpd: Syntax error on line 55 of
> > /etc/opt/CollabNet_Subversion/conf/httpd.conf: API module
> > structure `python_module' in file /usr/lib/httpd/modules/m
> > od_python.so is garbled - perhaps this is not an Apache module DSO?
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> >
>
From Brian.McCann at viziant.net  Wed Apr  4 07:58:54 2007
From: Brian.McCann at viziant.net (Brian McCann)
Date: Wed Apr  4 07:59:47 2007
Subject: [mod_python] mod_python install fails
Message-ID: <93066C069973ED448DC2BCEA9C44A7382BCCA3@efmailx.theeagleforce.com>

Hi Graham,
 
I made the change you suggested in configure but get the following errors in bold  below
any ideas?
Thanks,
Brian
[root@sirius1 mod_python-3.3.1]# ./configure --with-python=/usr/bin/python2.3 --with-apxs=/usr/sbin/apxs2 --with-flex=/usr/bin/flex
checking for gcc... gcc
checking for C compiler default output file name... a.out
checking whether the C compiler works... yes
checking whether we are cross compiling... no
checking for suffix of executables...
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether gcc accepts -g... yes
checking for gcc option to accept ANSI C... none needed
checking for ar... ar
checking for a BSD-compatible install... /usr/bin/install -c
checking whether make sets $(MAKE)... yes
checking for main in -lm... yes
checking for an ANSI C-conforming const... yes
checking your blood pressure... a bit high, but we can proceed
configure: checking whether apxs is available...
checking for --with-apxs... /usr/sbin/apxs2 executable, good
checking Apache version... apxs:Error: /usr/sbin/httpd2 not found or not executable.
apxs:Error: /usr/sbin/httpd2 not found or not executable.
./configure: line 2713: /: is a directory
configure: error: This version of mod_python only works with Apache 2. The one you have seems to be .
[root@sirius1 mod_python-3.3.1]# 
<mailto:brian.mccann@viziant.net> 
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070404/3ee4539b/attachment-0001.html
From Brian.McCann at viziant.net  Wed Apr  4 08:00:46 2007
From: Brian.McCann at viziant.net (Brian McCann)
Date: Wed Apr  4 08:04:56 2007
Subject: [mod_python] mod_python install fails
References: <93066C069973ED448DC2BCEA9C44A7382BCCA1@efmailx.theeagleforce.com><88e286470704032141v443ff12bnc740a0f93548339@mail.gmail.com><93066C069973ED448DC2BCEA9C44A7382BCCA2@efmailx.theeagleforce.com>
	<88e286470704040457x77af37e3u1382a1ae1451b082@mail.gmail.com>
Message-ID: <93066C069973ED448DC2BCEA9C44A7382BCCA4@efmailx.theeagleforce.com>

httpd is located in /opt/CollabNet_Subversion/bin/httpd
[root@sirius1 bin]# httpd -V
Server version: Apache/2.2.3
Server built:   Feb  5 2007 13:01:55
 
[root@sirius1 bin]# apxs2 -q TARGET
apxs:Error: /usr/sbin/httpd2 not found or not executable.
--Brian
 
Brian McCann
Release Engineer
Viziant Corporation
 
Phone:  (617) 692-2793
Cell:     (508) 212-9193 
 
 brian.mccann@viziant.net
 
 

________________________________

From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
Sent: Wed 4/4/2007 7:57 AM
To: Brian McCann
Cc: mod_python@modpython.org
Subject: Re: [mod_python] mod_python install fails



On 04/04/07, Brian McCann <Brian.McCann@viziant.net> wrote:
>
>
>
> Hi Graham,
>
> I made the change you sugested in configure but get the following errors in
> bold  below
> any ideas?
> Thanks,
> Brian
> [root@sirius1 mod_python-3.3.1]# ./configure
> --with-python=/usr/bin/python2.3
> --with-apxs=/usr/sbin/apxs2 --with-flex=/usr/bin/flex
> checking for gcc... gcc
> checking for C compiler default output file name... a.out
> checking whether the C compiler works... yes
> checking whether we are cross compiling... no
> checking for suffix of executables...
> checking for suffix of object files... o
> checking whether we are using the GNU C compiler... yes
> checking whether gcc accepts -g... yes
> checking for gcc option to accept ANSI C... none needed
> checking for ar... ar
> checking for a BSD-compatible install... /usr/bin/install -c
> checking whether make sets $(MAKE)... yes
> checking for main in -lm... yes
> checking for an ANSI C-conforming const... yes
> checking your blood pressure... a bit high, but we can proceed
> configure: checking whether apxs is available...
> checking for --with-apxs... /usr/sbin/apxs2 executable, good
> checking Apache version... apxs:Error: /usr/sbin/httpd2 not found or not
> executable.
> apxs:Error: /usr/sbin/httpd2 not found or not executable.
> ./configure: line 2713: /: is a directory
> configure: error: This version of mod_python only works with Apache 2. The
> one you have seems to be .
> [root@sirius1 mod_python-3.3.1]#

What is the actual path to your 'httpd'? Is it '/usr/bin/httpd'?

If when you run:

  apxs2 -q TARGET

it generates:

  httpd2

then suggests your Apache installation is broken in some way.

Can only suggest you modify the mod_python configure program and look for:

  HTTPD="`${APXS} -q SBINDIR`/`${APXS} -q TARGET`"

change it to:

  HTTPD="/usr/bin/httpd"

or whatever the actual path to the web server executable is.

Rerun configure. This may or may no get you further.

Graham

>  ________________________________
>  From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
> Sent: Wed 4/4/2007 12:41 AM
> To: Brian McCann
> Cc: mod_python@modpython.org
> Subject: Re: [mod_python] mod_python install fails
>
>
>
>
> On 04/04/07, Brian McCann <Brian.McCann@viziant.net> wrote:
> > I'm trying to install mod_python on a RedHat4 enterprise server which has
> > CollabNets's
> > SVN runing with apache 2.2.3 installed I'm getting the following errors.
> > any help would be greatly appreciated
> >
> > I ran config,make,make install, but get the errors below when I try to
> > restart apache, here is the full out put from config, as you can see there
> a
> > a few problems
> > 1. I point to apxs2 but the config script ignores and uses apxs
>
> But you use the wrong option to configure. There is no --with-apxs2
> option, use --with-apxs instead:
>
> ./configure  --with-python=/usr/bin/python2.3
> --with-apxs=/usr/sbin/apxs2 --with-flex=/usr/bin/flex
>
> > 2. config uses apache 2.0.52 but should be using the one installed with
> > CollabNetSVN 2.2.3
> > I also put the apache restart error at the bottom of this comment
> > Thanks,
> > Brian
> >
> *******************************************************************************
> > [root@sirius1 mod_python-3.3.1]# ./configure
> > --with-python=/usr/bin/python2.3 --with-apxs2=/usr/sbi
> > n/apxs2 --with-flex=/usr/bin/flex
> > checking for gcc... gcc
> > checking for C compiler default output file name... a.out
> > checking whether the C compiler works... yes
> > checking whether we are cross compiling... no
> > checking for suffix of executables...
> > checking for suffix of object files... o
> > checking whether we are using the GNU C compiler... yes
> > checking whether gcc accepts -g... yes
> > checking for gcc option to accept ANSI C... none needed
> > checking for ar... ar
> > checking for a BSD-compatible install... /usr/bin/install -c
> > checking whether make sets $(MAKE)... yes
> > checking for main in -lm... yes
> > checking for an ANSI C-conforming const... yes
> > checking your blood pressure... a bit high, but we can proceed
> > configure: checking whether apxs is available...
> > checking for --with-apxs... no
> > checking for apxs in /usr/local/apache/sbin... no
> > checking for apxs in your PATH... checking for apxs... /usr/sbin/apxs
> > found /usr/sbin/apxs, we'll use this. Use --with-apxs to specify another.
> > checking Apache version... 2.0.52
> > checking for Apache libexec directory... /usr/lib/httpd/modules
> > checking for Apache include directory... -I/usr/include/httpd
> > checking for --with-python... /usr/bin/python2.3
> > checking Python version... 2.3
> > checking Python install prefix... /usr
> > checking checking where python libraries are installed...
> /usr/lib/python2.3
> > checking for Py_NewInterpreter in -lpython2.3... yes
> > checking what libraries Python was linked with... -lpython2.3 -lpthread
> -ldl
> > -lutil -lm
> > checking linker flags used to link Python...
> > checking where Python include files are... -I/usr/include/python2.3
> > checking for --with-python-src... no
> > checking for --with-mutex-dir... no
> > Using MUTEX_DIR /tmp
> > checking for --with-max-locks... no
> > Using 8 MAX_LOCKS.
> > checking for --with-flex... /usr/bin/flex
> > found /usr/bin/flex, we'll use this. Use --with-flex to specify another.
> > checking flex version... configure: WARNING: Flex version 2.5.4 found.
> > Version 2.5.31 or greater is required. You can generally ignore this
> > warning unless you need to regenerate psp_parser.c from psp_parse.l.
> > If you do need regenerate psp_parser.c, use --with-flex to specify the
> > location of the correct flex version. See the README for more information.
> > configure: creating ./config.status
> > config.status: creating Makefile
> > config.status: creating src/Makefile
> > config.status: creating Doc/Makefile
> > config.status: creating src/include/mod_python.h
> > config.status: creating test/Makefile
> > config.status: creating test/testconf.py
> > config.status: creating dist/setup.py
> > config.status: creating dist/Makefile
> > [root@sirius1 mod_python-3.3.1]#
> >
> *****************************************************************
> > Apache restart error
> > [root@sirius1 bin]# apachectl restart
> > httpd: Syntax error on line 55 of
> > /etc/opt/CollabNet_Subversion/conf/httpd.conf: API module
> > structure `python_module' in file /usr/lib/httpd/modules/m
> > od_python.so is garbled - perhaps this is not an Apache module DSO?
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> >
>


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070404/1598943f/attachment.html
From list at joreybump.com  Wed Apr  4 09:28:22 2007
From: list at joreybump.com (Jorey Bump)
Date: Wed Apr  4 09:28:29 2007
Subject: [mod_python] mod_python install fails
In-Reply-To: <93066C069973ED448DC2BCEA9C44A7382BCCA4@efmailx.theeagleforce.com>
References: <93066C069973ED448DC2BCEA9C44A7382BCCA1@efmailx.theeagleforce.com><88e286470704032141v443ff12bnc740a0f93548339@mail.gmail.com><93066C069973ED448DC2BCEA9C44A7382BCCA2@efmailx.theeagleforce.com>	<88e286470704040457x77af37e3u1382a1ae1451b082@mail.gmail.com>
	<93066C069973ED448DC2BCEA9C44A7382BCCA4@efmailx.theeagleforce.com>
Message-ID: <4613A7F6.7090108@joreybump.com>

Brian McCann wrote:
> httpd is located in /opt/CollabNet_Subversion/bin/httpd

Then it seems to be an alternative installation of Apache, and you must 
use the full path.

> [root@sirius1 bin]# httpd -V
> Server version: Apache/2.2.3
> Server built:   Feb  5 2007 13:01:55

This is calling whichever httpd is in your path. Run this command instead:

  /opt/CollabNet_Subversion/bin/httpd -V

> [root@sirius1 bin]# apxs2 -q TARGET
> apxs:Error: /usr/sbin/httpd2 not found or not executable.

Once again, you must use the apxs installed by your target Apache 
installation. It is probabably this:

  /opt/CollabNet_Subversion/bin/apxs

Confirm this and use:

  --with-apxs=/opt/CollabNet_Subversion/bin/apxs

>  > configure: checking whether apxs is available...
>  > checking for --with-apxs... /usr/sbin/apxs2 executable, good

That looks like the apxs installed by Red Hat.

>  > checking Apache version... apxs:Error: /usr/sbin/httpd2 not found or not
>  > executable.
>  > apxs:Error: /usr/sbin/httpd2 not found or not executable.

It's looking for Red Hat's httpd, not the CollabNet one.

You should also make sure you don't have Red Hat's mod_python installed. 
While it's easy to install mod_python to work with any single Apache 
installation, it's a bit more work to support multiple installations.

And if you're not going to use Red Hat's Apache, uninstall every bit of 
it to get it out of your path (and add /opt/CollabNet_Subversion/bin/ to 
your path if you want the convenience).


From Brian.McCann at viziant.net  Wed Apr  4 10:47:38 2007
From: Brian.McCann at viziant.net (Brian McCann)
Date: Wed Apr  4 10:48:22 2007
Subject: [mod_python] mod_python install fails
References: <93066C069973ED448DC2BCEA9C44A7382BCCA1@efmailx.theeagleforce.com><88e286470704032141v443ff12bnc740a0f93548339@mail.gmail.com><93066C069973ED448DC2BCEA9C44A7382BCCA2@efmailx.theeagleforce.com>	<88e286470704040457x77af37e3u1382a1ae1451b082@mail.gmail.com>
	<93066C069973ED448DC2BCEA9C44A7382BCCA4@efmailx.theeagleforce.com>
	<4613A7F6.7090108@joreybump.com>
Message-ID: <93066C069973ED448DC2BCEA9C44A7382BCCA5@efmailx.theeagleforce.com>

Hi Jorey,
 
These are the versions\locations on our server
[root@sirius1 bin]# /opt/CollabNet_Subversion/bin/httpd -V
Server version: Apache/2.2.3
Server built:   Feb  5 2007 13:01:55
I cp this httpd file to httpd2 and put that file in /etc
this is what I get now whenI run configure, make, make install[root@sirius1 mod_python-3.3.1]# ./configure --with-python=/usr/bin/python2.3 --with-apxs=/usr/sbin/apxs2 --with-flex=/usr/bin/flex
 
and the try to restart apache I get this garbled error
[root@sirius1 bin]# apachectl restart
httpd: Syntax error on line 55 of /etc/opt/CollabNet_Subversion/conf/httpd.conf: API module structure `python_module' in file /usr/lib/apache2/mod_pyt
hon.so is garbled - perhaps this is not an Apache module DSO?
[root@sirius1 bin]#
 
CollabNet did not come with apxs2 so I installe dthe package apache2-devel
 
--Brian
 

checking for gcc... gcc
checking for C compiler default output file name... a.out
checking whether the C compiler works... yes
checking whether we are cross compiling... no
checking for suffix of executables...
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether gcc accepts -g... yes
checking for gcc option to accept ANSI C... none needed
checking for ar... ar
checking for a BSD-compatible install... /usr/bin/install -c
checking whether make sets $(MAKE)... yes
checking for main in -lm... yes
checking for an ANSI C-conforming const... yes
checking your blood pressure... a bit high, but we can proceed
configure: checking whether apxs is available...
checking for --with-apxs... /usr/sbin/apxs2 executable, good
checking Apache version... 2.2.3
checking for Apache libexec directory... /usr/lib/apache2
checking for Apache include directory... -I/usr/include/apache2
checking for --with-python... /usr/bin/python2.3
checking Python version... 2.3
checking Python install prefix... /usr
checking checking where python libraries are installed... /usr/lib/python2.3
checking for Py_NewInterpreter in -lpython2.3... yes
checking what libraries Python was linked with... -lpython2.3 -lpthread -ldl -lutil -lm
checking linker flags used to link Python...
checking where Python include files are... -I/usr/include/python2.3
checking for --with-python-src... no
checking for --with-mutex-dir... no
Using MUTEX_DIR /tmp
checking for --with-max-locks... no
Using 8 MAX_LOCKS.
checking for --with-flex... /usr/bin/flex
found /usr/bin/flex, we'll use this. Use --with-flex to specify another.
checking flex version... configure: WARNING: Flex version 2.5.4 found.
    Version 2.5.31 or greater is required.  You can generally ignore this
    warning unless you need to regenerate psp_parser.c from psp_parse.l.
    If you do need regenerate psp_parser.c, use --with-flex to specify the
    location of the correct flex version. See the README for more information.
configure: creating ./config.status
config.status: creating Makefile
config.status: creating src/Makefile
config.status: creating Doc/Makefile
config.status: creating src/include/mod_python.h
config.status: creating test/Makefile
config.status: creating test/testconf.py
config.status: creating dist/setup.py
config.status: creating dist/Makefile
[root@sirius1 mod_python-3.3.1]# make
make[1]: Entering directory `/opt/software/TracWeb/mod_python-3.3.1/src'
make[1]: Leaving directory `/opt/software/TracWeb/mod_python-3.3.1/src'
make[1]: Entering directory `/opt/software/TracWeb/mod_python-3.3.1/dist'
make[2]: Entering directory `/opt/software/TracWeb/mod_python-3.3.1/src'
make[2]: `psp_parser.c' is up to date.
make[2]: Leaving directory `/opt/software/TracWeb/mod_python-3.3.1/src'
/usr/bin/python2.3 setup.py build
running build
running build_py
running build_ext
make[1]: Leaving directory `/opt/software/TracWeb/mod_python-3.3.1/dist'
Now su and make install
  (or, if you only want to perform a partial install,
   you can use make install_dso and make install_py_lib)
[root@sirius1 mod_python-3.3.1]# make install
make[1]: Entering directory `/opt/software/TracWeb/mod_python-3.3.1'
make[2]: Entering directory `/opt/software/TracWeb/mod_python-3.3.1/src'
make[2]: Leaving directory `/opt/software/TracWeb/mod_python-3.3.1/src'
make[2]: Entering directory `/opt/software/TracWeb/mod_python-3.3.1/dist'
make[3]: Entering directory `/opt/software/TracWeb/mod_python-3.3.1/src'
make[3]: `psp_parser.c' is up to date.
make[3]: Leaving directory `/opt/software/TracWeb/mod_python-3.3.1/src'
/usr/bin/python2.3 setup.py build
running build
running build_py
running build_ext
make[2]: Leaving directory `/opt/software/TracWeb/mod_python-3.3.1/dist'
Now su and make install
  (or, if you only want to perform a partial install,
   you can use make install_dso and make install_py_lib)

Performing DSO installation.
/usr/bin/install -c -d /usr/lib/apache2
/usr/bin/install -c src/mod_python.so /usr/lib/apache2
Now don't forget to edit your main config and add
    LoadModule python_module /usr/lib/apache2/mod_python.so
and if your configuration uses ClearModuleList, then also
    AddModule mod_python.c
make[1]: Leaving directory `/opt/software/TracWeb/mod_python-3.3.1'
make[1]: Entering directory `/opt/software/TracWeb/mod_python-3.3.1'
cd dist && make install_py_lib
make[2]: Entering directory `/opt/software/TracWeb/mod_python-3.3.1/dist'
make[3]: Entering directory `/opt/software/TracWeb/mod_python-3.3.1/src'
make[3]: `psp_parser.c' is up to date.
make[3]: Leaving directory `/opt/software/TracWeb/mod_python-3.3.1/src'
if test -z "" ; then \
        /usr/bin/python2.3 setup.py install --optimize 2 --force ; \
else \
        /usr/bin/python2.3 setup.py install --optimize 2 --force --root  ; \
fi
running install
running build
running build_py
running build_ext
running install_lib
copying build/lib.linux-i686-2.3/mod_python/publisher.py -> /usr/lib/python2.3/site-packages/mod_python
copying build/lib.linux-i686-2.3/mod_python/Session.py -> /usr/lib/python2.3/site-packages/mod_python
copying build/lib.linux-i686-2.3/mod_python/_psp.so -> /usr/lib/python2.3/site-packages/mod_python
copying build/lib.linux-i686-2.3/mod_python/python22.py -> /usr/lib/python2.3/site-packages/mod_python
copying build/lib.linux-i686-2.3/mod_python/util.py -> /usr/lib/python2.3/site-packages/mod_python
copying build/lib.linux-i686-2.3/mod_python/Cookie.py -> /usr/lib/python2.3/site-packages/mod_python
copying build/lib.linux-i686-2.3/mod_python/__init__.py -> /usr/lib/python2.3/site-packages/mod_python
copying build/lib.linux-i686-2.3/mod_python/apache.py -> /usr/lib/python2.3/site-packages/mod_python
copying build/lib.linux-i686-2.3/mod_python/importer.py -> /usr/lib/python2.3/site-packages/mod_python
copying build/lib.linux-i686-2.3/mod_python/testhandler.py -> /usr/lib/python2.3/site-packages/mod_python
copying build/lib.linux-i686-2.3/mod_python/psp.py -> /usr/lib/python2.3/site-packages/mod_python
copying build/lib.linux-i686-2.3/mod_python/cache.py -> /usr/lib/python2.3/site-packages/mod_python
copying build/lib.linux-i686-2.3/mod_python/cgihandler.py -> /usr/lib/python2.3/site-packages/mod_python
byte-compiling /usr/lib/python2.3/site-packages/mod_python/publisher.py to publisher.pyc
byte-compiling /usr/lib/python2.3/site-packages/mod_python/Session.py to Session.pyc
byte-compiling /usr/lib/python2.3/site-packages/mod_python/python22.py to python22.pyc
byte-compiling /usr/lib/python2.3/site-packages/mod_python/util.py to util.pyc
byte-compiling /usr/lib/python2.3/site-packages/mod_python/Cookie.py to Cookie.pyc
byte-compiling /usr/lib/python2.3/site-packages/mod_python/__init__.py to __init__.pyc
byte-compiling /usr/lib/python2.3/site-packages/mod_python/apache.py to apache.pyc
byte-compiling /usr/lib/python2.3/site-packages/mod_python/importer.py to importer.pyc
byte-compiling /usr/lib/python2.3/site-packages/mod_python/testhandler.py to testhandler.pyc
byte-compiling /usr/lib/python2.3/site-packages/mod_python/psp.py to psp.pyc
byte-compiling /usr/lib/python2.3/site-packages/mod_python/cache.py to cache.pyc
byte-compiling /usr/lib/python2.3/site-packages/mod_python/cgihandler.py to cgihandler.pyc
writing byte-compilation script '/tmp/tmpSyy3RN.py'
/usr/bin/python2.3 -OO /tmp/tmpSyy3RN.py
removing /tmp/tmpSyy3RN.py
make[2]: Leaving directory `/opt/software/TracWeb/mod_python-3.3.1/dist'
make[1]: Leaving directory `/opt/software/TracWeb/mod_python-3.3.1'
[root@sirius1 mod_python-3.3.1]#
 
 
Brian McCann
Release Engineer
Viziant Corporation
 
Phone:  (617) 692-2793
Cell:     (508) 212-9193 
 
 brian.mccann@viziant.net
 
 

________________________________

From: Jorey Bump [mailto:list@joreybump.com]
Sent: Wed 4/4/2007 9:28 AM
To: Brian McCann
Cc: mod_python@modpython.org
Subject: Re: [mod_python] mod_python install fails



Brian McCann wrote:
> httpd is located in /opt/CollabNet_Subversion/bin/httpd

Then it seems to be an alternative installation of Apache, and you must
use the full path.

> [root@sirius1 bin]# httpd -V
> Server version: Apache/2.2.3
> Server built:   Feb  5 2007 13:01:55

This is calling whichever httpd is in your path. Run this command instead:

  /opt/CollabNet_Subversion/bin/httpd -V

> [root@sirius1 bin]# apxs2 -q TARGET
> apxs:Error: /usr/sbin/httpd2 not found or not executable.

Once again, you must use the apxs installed by your target Apache
installation. It is probabably this:

  /opt/CollabNet_Subversion/bin/apxs

Confirm this and use:

  --with-apxs=/opt/CollabNet_Subversion/bin/apxs

>  > configure: checking whether apxs is available...
>  > checking for --with-apxs... /usr/sbin/apxs2 executable, good

That looks like the apxs installed by Red Hat.

>  > checking Apache version... apxs:Error: /usr/sbin/httpd2 not found or not
>  > executable.
>  > apxs:Error: /usr/sbin/httpd2 not found or not executable.

It's looking for Red Hat's httpd, not the CollabNet one.

You should also make sure you don't have Red Hat's mod_python installed.
While it's easy to install mod_python to work with any single Apache
installation, it's a bit more work to support multiple installations.

And if you're not going to use Red Hat's Apache, uninstall every bit of
it to get it out of your path (and add /opt/CollabNet_Subversion/bin/ to
your path if you want the convenience).




-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070404/0c6a329f/attachment-0001.html
From list at joreybump.com  Wed Apr  4 11:22:05 2007
From: list at joreybump.com (Jorey Bump)
Date: Wed Apr  4 11:22:09 2007
Subject: [mod_python] mod_python install fails
In-Reply-To: <93066C069973ED448DC2BCEA9C44A7382BCCA5@efmailx.theeagleforce.com>
References: <93066C069973ED448DC2BCEA9C44A7382BCCA1@efmailx.theeagleforce.com><88e286470704032141v443ff12bnc740a0f93548339@mail.gmail.com><93066C069973ED448DC2BCEA9C44A7382BCCA2@efmailx.theeagleforce.com>	<88e286470704040457x77af37e3u1382a1ae1451b082@mail.gmail.com>
	<93066C069973ED448DC2BCEA9C44A7382BCCA4@efmailx.theeagleforce.com>
	<4613A7F6.7090108@joreybump.com>
	<93066C069973ED448DC2BCEA9C44A7382BCCA5@efmailx.theeagleforce.com>
Message-ID: <4613C29D.9050101@joreybump.com>

Brian McCann wrote:

> These are the versions\locations on our server
> [root@sirius1 bin]# /opt/CollabNet_Subversion/bin/httpd -V
> Server version: Apache/2.2.3
> Server built:   Feb  5 2007 13:01:55
> I cp this httpd file to httpd2 and put that file in /etc

Why would you do that?

> this is what I get now whenI run configure, make, make 
> install[root@sirius1 mod_python-3.3.1]# ./configure 
> --with-python=/usr/bin/python2.3 --with-apxs=/usr/sbin/apxs2 
> --with-flex=/usr/bin/flex

You're still using an apxs that doesn't match your target Apache 
installation. As root, run the following commands:

  updatedb
  locate apxs

See if the output shows apxs somewhere within your CollabNet installation.

> and the try to restart apache I get this garbled error
> [root@sirius1 bin]# apachectl restart
> httpd: Syntax error on line 55 of 
> /etc/opt/CollabNet_Subversion/conf/httpd.conf: API module structure 
> `python_module' in file /usr/lib/apache2/mod_pyt
> hon.so is garbled - perhaps this is not an Apache module DSO?
> [root@sirius1 bin]#
>  
> CollabNet did not come with apxs2 so I installe dthe package apache2-devel

That will only work for Red Hat's corresponding Apache RPM. Keep in mind 
that the original upstream Apache httpd distribution doesn't use the 
names apxs2 or httpd2, a convention used by packagers to support 
installing Apache httpd versions 1.x and 2.x on the same machine. A 
vanilla installation of httpd will simply provide apxs and httpd. I have 
no familiarity with CollabNet, but if they're distributing Apache, they 
must provide the source, so you will be able to install a working apxs, 
somehow. They may even supply it as another package. In any case, you 
should use the apxs that corresponds to your target Apache installation.

Once you understand it, the default Apache httpd is flexible and well 
designed. If CollabNet hasn't crippled it in any way, it should be easy 
to add functionality like mod_python.

From Brian.McCann at viziant.net  Wed Apr  4 12:06:41 2007
From: Brian.McCann at viziant.net (Brian McCann)
Date: Wed Apr  4 12:07:06 2007
Subject: [mod_python] mod_python install fails
References: <93066C069973ED448DC2BCEA9C44A7382BCCA1@efmailx.theeagleforce.com><88e286470704032141v443ff12bnc740a0f93548339@mail.gmail.com><93066C069973ED448DC2BCEA9C44A7382BCCA2@efmailx.theeagleforce.com>	<88e286470704040457x77af37e3u1382a1ae1451b082@mail.gmail.com>
	<93066C069973ED448DC2BCEA9C44A7382BCCA4@efmailx.theeagleforce.com>
	<4613A7F6.7090108@joreybump.com>
	<93066C069973ED448DC2BCEA9C44A7382BCCA5@efmailx.theeagleforce.com>
	<4613C29D.9050101@joreybump.com>
Message-ID: <93066C069973ED448DC2BCEA9C44A7382BCCA6@efmailx.theeagleforce.com>

Hi Jore,
here are all references ro apxs, there was no apxs wit Collabnet, that's why I installed apache2-devel to get it
the version of apache that came with the RH install was 2.0.52 and the one with the collabnet install 2.2.3
there is an apxs in /usr/sbin/ but when I run configure pointing to it, I get the output in bold below pointing to apache 2.0.52 not 2.2.3 are you saying that if I can get the apxs associated with apache version 2.2.3(the version CollabNet uses)mod_python will build succcessfully?
Thanks,
-Brian
[root@sirius1 conf]# updatedb
[root@sirius1 conf]# locate apxs
/usr/share/man/man8/apxs.8.gz
/usr/share/man/man8/apxs2.8.gz
/usr/sbin/apxs
/usr/sbin/apxs2
/var/www/manual/programs/apxs.html.ko.euc-kr
/var/www/manual/programs/apxs.html.en
/var/www/manual/programs/apxs.html
/etc/opt/CollabNet_Subversion/default-site/htdocs/manual/programs/apxs.html
/etc/opt/CollabNet_Subversion/default-site/htdocs/manual/programs/apxs.html.ko.euc-kr
/etc/opt/CollabNet_Subversion/default-site/htdocs/manual/programs/apxs.html.en
[root@sirius1 mod_python-3.3.1]# ./configure --with-python=/usr/bin/python2.3 --with-apxs=/usr/sbin/apxs --with-flex=/usr/bin/flex
checking for gcc... gcc
checking for C compiler default output file name... a.out
checking whether the C compiler works... yes
checking whether we are cross compiling... no
checking for suffix of executables...
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether gcc accepts -g... yes
checking for gcc option to accept ANSI C... none needed
checking for ar... ar
checking for a BSD-compatible install... /usr/bin/install -c
checking whether make sets $(MAKE)... yes
checking for main in -lm... yes
checking for an ANSI C-conforming const... yes
checking your blood pressure... a bit high, but we can proceed
configure: checking whether apxs is available...
checking for --with-apxs... /usr/sbin/apxs executable, good
checking Apache version... 2.0.52
checking for Apache libexec directory... /usr/lib/httpd/modules
checking for Apache include directory... -I/usr/include/httpd
checking for --with-python... /usr/bin/python2.3
checking Python version... 2.3
checking Python install prefix... /usr
checking checking where python libraries are installed... /usr/lib/python2.3
checking for Py_NewInterpreter in -lpython2.3... yes
checking what libraries Python was linked with... -lpython2.3 -lpthread -ldl -lutil -lm
checking linker flags used to link Python...
checking where Python include files are... -I/usr/include/python2.3
checking for --with-python-src... no
checking for --with-mutex-dir... no
Using MUTEX_DIR /tmp
checking for --with-max-locks... no
Using 8 MAX_LOCKS.
checking for --with-flex... /usr/bin/flex
found /usr/bin/flex, we'll use this. Use --with-flex to specify another.
checking flex version... configure: WARNING: Flex version 2.5.4 found.
    Version 2.5.31 or greater is required.  You can generally ignore this
    warning unless you need to regenerate psp_parser.c from psp_parse.l.
    If you do need regenerate psp_parser.c, use --with-flex to specify the
    location of the correct flex version. See the README for more information.
configure: creating ./config.status
config.status: creating Makefile
config.status: creating src/Makefile
config.status: creating Doc/Makefile
config.status: creating src/include/mod_python.h
config.status: creating test/Makefile
config.status: creating test/testconf.py
config.status: creating dist/setup.py
config.status: creating dist/Makefile
 
 
 

________________________________

From: Jorey Bump [mailto:list@joreybump.com]
Sent: Wed 4/4/2007 11:22 AM
To: Brian McCann
Cc: mod_python@modpython.org
Subject: Re: [mod_python] mod_python install fails



Brian McCann wrote:

> These are the versions\locations on our server
> [root@sirius1 bin]# /opt/CollabNet_Subversion/bin/httpd -V
> Server version: Apache/2.2.3
> Server built:   Feb  5 2007 13:01:55
> I cp this httpd file to httpd2 and put that file in /etc

Why would you do that?

> this is what I get now whenI run configure, make, make
> install[root@sirius1 mod_python-3.3.1]# ./configure
> --with-python=/usr/bin/python2.3 --with-apxs=/usr/sbin/apxs2
> --with-flex=/usr/bin/flex

You're still using an apxs that doesn't match your target Apache
installation. As root, run the following commands:

  updatedb
  locate apxs

See if the output shows apxs somewhere within your CollabNet installation.

> and the try to restart apache I get this garbled error
> [root@sirius1 bin]# apachectl restart
> httpd: Syntax error on line 55 of
> /etc/opt/CollabNet_Subversion/conf/httpd.conf: API module structure
> `python_module' in file /usr/lib/apache2/mod_pyt
> hon.so is garbled - perhaps this is not an Apache module DSO?
> [root@sirius1 bin]#
> 
> CollabNet did not come with apxs2 so I installe dthe package apache2-devel

That will only work for Red Hat's corresponding Apache RPM. Keep in mind
that the original upstream Apache httpd distribution doesn't use the
names apxs2 or httpd2, a convention used by packagers to support
installing Apache httpd versions 1.x and 2.x on the same machine. A
vanilla installation of httpd will simply provide apxs and httpd. I have
no familiarity with CollabNet, but if they're distributing Apache, they
must provide the source, so you will be able to install a working apxs,
somehow. They may even supply it as another package. In any case, you
should use the apxs that corresponds to your target Apache installation.

Once you understand it, the default Apache httpd is flexible and well
designed. If CollabNet hasn't crippled it in any way, it should be easy
to add functionality like mod_python.



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070404/7bb2485e/attachment.html
From list at joreybump.com  Wed Apr  4 12:43:39 2007
From: list at joreybump.com (Jorey Bump)
Date: Wed Apr  4 12:43:43 2007
Subject: [mod_python] mod_python install fails
In-Reply-To: <93066C069973ED448DC2BCEA9C44A7382BCCA6@efmailx.theeagleforce.com>
References: <93066C069973ED448DC2BCEA9C44A7382BCCA1@efmailx.theeagleforce.com><88e286470704032141v443ff12bnc740a0f93548339@mail.gmail.com><93066C069973ED448DC2BCEA9C44A7382BCCA2@efmailx.theeagleforce.com>	<88e286470704040457x77af37e3u1382a1ae1451b082@mail.gmail.com>
	<93066C069973ED448DC2BCEA9C44A7382BCCA4@efmailx.theeagleforce.com>
	<4613A7F6.7090108@joreybump.com>
	<93066C069973ED448DC2BCEA9C44A7382BCCA5@efmailx.theeagleforce.com>
	<4613C29D.9050101@joreybump.com>
	<93066C069973ED448DC2BCEA9C44A7382BCCA6@efmailx.theeagleforce.com>
Message-ID: <4613D5BB.1080805@joreybump.com>

Brian McCann wrote:

> here are all references ro apxs, there was no apxs wit Collabnet, that's 
> why I installed apache2-devel to get it
> the version of apache that came with the RH install was 2.0.52 and the 
> one with the collabnet install 2.2.3
> there is an apxs in /usr/sbin/ but when I run configure pointing to it, 
> I get the output in bold below pointing to apache 2.0.52 not 2.2.3 are 
> you saying that if I can get the apxs associated with apache version 
> 2.2.3(the version CollabNet uses)mod_python will build succcessfully?

Yes, and I would even go so far as to say that you should use an apxs 
that is created when the target Apache httpd installation is compiled. 
In other words, it will be easiest to use an apxs that matches your 
installation, not merely one that matches the version. I highly 
recommend contacting CollabNet for support. It's trivial to include 
apxs, so they have either overlooked it, or have a good reason not to do 
so. If you explain your use case to them, they are in the best position 
to provide further instructions.


From Brian.McCann at viziant.net  Wed Apr  4 12:55:38 2007
From: Brian.McCann at viziant.net (Brian McCann)
Date: Wed Apr  4 12:56:01 2007
Subject: [mod_python] mod_python install fails
References: <93066C069973ED448DC2BCEA9C44A7382BCCA1@efmailx.theeagleforce.com><88e286470704032141v443ff12bnc740a0f93548339@mail.gmail.com><93066C069973ED448DC2BCEA9C44A7382BCCA2@efmailx.theeagleforce.com>	<88e286470704040457x77af37e3u1382a1ae1451b082@mail.gmail.com>
	<93066C069973ED448DC2BCEA9C44A7382BCCA4@efmailx.theeagleforce.com>
	<4613A7F6.7090108@joreybump.com>
	<93066C069973ED448DC2BCEA9C44A7382BCCA5@efmailx.theeagleforce.com>
	<4613C29D.9050101@joreybump.com>
	<93066C069973ED448DC2BCEA9C44A7382BCCA6@efmailx.theeagleforce.com>
	<4613D5BB.1080805@joreybump.com>
Message-ID: <93066C069973ED448DC2BCEA9C44A7382BCCA7@efmailx.theeagleforce.com>

Jorey,
many thanks,  I'm now on the right path.
I've contacted CollabNet\requested the apxs that was compiled  with version 2.2.3
another question on this,
I've installed httpd-devel-2.0.52-28.ent  apache2-devel-2.0.46-1.72 during my hunt of apxs, should I remove these
packages from my server? also should I remove the default apache httpd-2.052-28.ent server
since I'm using 2.2.3?
this clean up should affect the RH server right?
 
Thanks,
Brian
 

________________________________

From: Jorey Bump [mailto:list@joreybump.com]
Sent: Wed 4/4/2007 12:43 PM
To: Brian McCann
Cc: mod_python@modpython.org
Subject: Re: [mod_python] mod_python install fails



Brian McCann wrote:

> here are all references ro apxs, there was no apxs wit Collabnet, that's
> why I installed apache2-devel to get it
> the version of apache that came with the RH install was 2.0.52 and the
> one with the collabnet install 2.2.3
> there is an apxs in /usr/sbin/ but when I run configure pointing to it,
> I get the output in bold below pointing to apache 2.0.52 not 2.2.3 are
> you saying that if I can get the apxs associated with apache version
> 2.2.3(the version CollabNet uses)mod_python will build succcessfully?

Yes, and I would even go so far as to say that you should use an apxs
that is created when the target Apache httpd installation is compiled.
In other words, it will be easiest to use an apxs that matches your
installation, not merely one that matches the version. I highly
recommend contacting CollabNet for support. It's trivial to include
apxs, so they have either overlooked it, or have a good reason not to do
so. If you explain your use case to them, they are in the best position
to provide further instructions.




-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070404/6d9f2eda/attachment.html
From list at joreybump.com  Wed Apr  4 13:01:14 2007
From: list at joreybump.com (Jorey Bump)
Date: Wed Apr  4 13:01:22 2007
Subject: [mod_python] mod_python install fails
In-Reply-To: <93066C069973ED448DC2BCEA9C44A7382BCCA7@efmailx.theeagleforce.com>
References: <93066C069973ED448DC2BCEA9C44A7382BCCA1@efmailx.theeagleforce.com><88e286470704032141v443ff12bnc740a0f93548339@mail.gmail.com><93066C069973ED448DC2BCEA9C44A7382BCCA2@efmailx.theeagleforce.com>	<88e286470704040457x77af37e3u1382a1ae1451b082@mail.gmail.com>
	<93066C069973ED448DC2BCEA9C44A7382BCCA4@efmailx.theeagleforce.com>
	<4613A7F6.7090108@joreybump.com>
	<93066C069973ED448DC2BCEA9C44A7382BCCA5@efmailx.theeagleforce.com>
	<4613C29D.9050101@joreybump.com>
	<93066C069973ED448DC2BCEA9C44A7382BCCA6@efmailx.theeagleforce.com>
	<4613D5BB.1080805@joreybump.com>
	<93066C069973ED448DC2BCEA9C44A7382BCCA7@efmailx.theeagleforce.com>
Message-ID: <4613D9DA.4040206@joreybump.com>

Brian McCann wrote:
> Jorey,
> many thanks,  I'm now on the right path.
> I've contacted CollabNet\requested the apxs that was compiled  with 
> version 2.2.3
> another question on this,
> I've installed httpd-devel-2.0.52-28.ent  apache2-devel-2.0.46-1.72 
> during my hunt of apxs, should I remove these
> packages from my server? also should I remove the default apache 
> httpd-2.052-28.ent server
> since I'm using 2.2.3?
> this clean up should affect the RH server right?

An HTTP daemon is not a critical component, so it should be possible to 
remove all of Red Hat's Apache httpd RPMs. As I said, multiple versions 
of Apache httpd can coexist peacefully, but there's no sense in 
installing unused software, and removing it will at least remove it from 
your $PATH.

From steino at ccri.net  Thu Apr  5 09:37:39 2007
From: steino at ccri.net (Olaf Stein)
Date: Thu Apr  5 09:38:23 2007
Subject: [mod_python] Path/address bar contents
Message-ID: <C23A73E3.1D09%steino@ccri.net>

Hi all,

I have a small app that works like this

Somebody visits the start page

http://localhost/apps/start/enter

where start is a python file (start.py) and enter() the function that
displays the login html (through templates, etc)

After entering credentials and clicking the login button, I call a function
login() (also in start.py), which checks the credentials and then call
either the function enter() again (if credentials are not good) or function
start() (if credentials are good). Basically function login() does not
create any html output.

The question now is, after logging in and calling start(), the function
executes correctly, but in the browser's address bar it still shows

http://localhost/apps/start/login

Instead of

http://localhost/apps/start/start

Is this because login() does not create html output and is there anything I
can do so the "correct" path is shown


Thanks
Olaf

From sdavis2 at mail.nih.gov  Thu Apr  5 09:53:40 2007
From: sdavis2 at mail.nih.gov (Sean Davis)
Date: Thu Apr  5 09:53:46 2007
Subject: [mod_python] Path/address bar contents
In-Reply-To: <C23A73E3.1D09%steino@ccri.net>
References: <C23A73E3.1D09%steino@ccri.net>
Message-ID: <200704050953.40960.sdavis2@mail.nih.gov>

On Thursday 05 April 2007 09:37, Olaf Stein wrote:
> Hi all,
>
> I have a small app that works like this
>
> Somebody visits the start page
>
> http://localhost/apps/start/enter
>
> where start is a python file (start.py) and enter() the function that
> displays the login html (through templates, etc)
>
> After entering credentials and clicking the login button, I call a function
> login() (also in start.py), which checks the credentials and then call
> either the function enter() again (if credentials are not good) or function
> start() (if credentials are good). Basically function login() does not
> create any html output.
>
> The question now is, after logging in and calling start(), the function
> executes correctly, but in the browser's address bar it still shows
>
> http://localhost/apps/start/login
>
> Instead of
>
> http://localhost/apps/start/start
>
> Is this because login() does not create html output and is there anything I
> can do so the "correct" path is shown

You can have login() do a redirect to start() if successful.  Or (probably 
more efficient) call start(), check login() from within start(), and in 
login, do a redirect to enter() if the login criteria are not met.

But I might be misunderstanding something here.

Sean
From steino at ccri.net  Thu Apr  5 10:04:49 2007
From: steino at ccri.net (Olaf Stein)
Date: Thu Apr  5 10:05:26 2007
Subject: [mod_python] Path/address bar contents
In-Reply-To: <200704050953.40960.sdavis2@mail.nih.gov>
Message-ID: <C23A7A41.1D11%steino@ccri.net>

I could call login from within start...
Thanks

What do you mean by redirect?


On 4/5/07 9:53 AM, "Sean Davis" <sdavis2@mail.nih.gov> wrote:

> On Thursday 05 April 2007 09:37, Olaf Stein wrote:
>> Hi all,
>> 
>> I have a small app that works like this
>> 
>> Somebody visits the start page
>> 
>> http://localhost/apps/start/enter
>> 
>> where start is a python file (start.py) and enter() the function that
>> displays the login html (through templates, etc)
>> 
>> After entering credentials and clicking the login button, I call a function
>> login() (also in start.py), which checks the credentials and then call
>> either the function enter() again (if credentials are not good) or function
>> start() (if credentials are good). Basically function login() does not
>> create any html output.
>> 
>> The question now is, after logging in and calling start(), the function
>> executes correctly, but in the browser's address bar it still shows
>> 
>> http://localhost/apps/start/login
>> 
>> Instead of
>> 
>> http://localhost/apps/start/start
>> 
>> Is this because login() does not create html output and is there anything I
>> can do so the "correct" path is shown
> 
> You can have login() do a redirect to start() if successful.  Or (probably
> more efficient) call start(), check login() from within start(), and in
> login, do a redirect to enter() if the login criteria are not met.
> 
> But I might be misunderstanding something here.
> 
> Sean





-------------------------
Olaf Stein
DBA
Center for Quantitative and Computational Biology
Columbus Children's Research Institute
700 Children's Drive
phone: 1-614-355-5685
cell: 1-614-843-0432
email: steino@ccri.net

From sdavis2 at mail.nih.gov  Thu Apr  5 10:12:52 2007
From: sdavis2 at mail.nih.gov (Sean Davis)
Date: Thu Apr  5 10:13:05 2007
Subject: [mod_python] Path/address bar contents
In-Reply-To: <C23A7A41.1D11%steino@ccri.net>
References: <C23A7A41.1D11%steino@ccri.net>
Message-ID: <200704051012.52814.sdavis2@mail.nih.gov>

On Thursday 05 April 2007 10:04, Olaf Stein wrote:
> I could call login from within start...
> Thanks
>
> What do you mean by redirect?

To redirect is to return a response that tells the browser to go to another 
location:

http://www.modpython.org/live/current/doc-html/pyapi-util-funcs.html

Sean
From john_nowlan at carleton.ca  Thu Apr  5 13:55:08 2007
From: john_nowlan at carleton.ca (John_Nowlan)
Date: Thu Apr  5 13:55:22 2007
Subject: [mod_python] compiling on solaris 9?
Message-ID: <6A5D305B0DE17541907AC0448C828A71012FB24C@CCSEXB10.CUNET.CARLETON.CA>

I have built apache2.2.4 and python2.5. from source, with some tweaks as outlined in some previous emails, i.e. build shared (some relevant snipped bits below).

When I try and compile mod_python now I have a similar problem to what is outlined at:

http://mail-archives.apache.org/mod_mbox/httpd-python-dev/200309.mbox/%3COFD98EF736.64974D7D-ON85256DA2.0054DC15-85256DA2.0055AD14@EU.novartis.net%3E

i.e. lots of 'ld: fatal: relocations remain against allocatable but non-writable sections'

Here is a fuller output:

ar -x `gcc -print-libgcc-file-name` _eprintf.o
ar -x `gcc -print-libgcc-file-name` _floatdidf.o
ar -x `gcc -print-libgcc-file-name` _muldi3.o

Compiling for DSO.

/usr/local/apache2/bin/apxs -I/files/app/modpython/mod_python-3.3.1/src/include -I/usr/local/apache2/in
clude -I/usr/local/include/python2.5 -c mod_python.c _apachemodule.c requestobject.c tableobject.c util
.c  serverobject.c connobject.c filterobject.c hlist.c  hlistobject.c finfoobject.c -L/usr/local/lib/py
thon2.5/config     -L/usr/local/lib -R/usr/local/lib -R/usr/lib -L/usr/lib -L/usr/openwin/lib -R/usr/op
enwin/lib -L/usr/local/ssl/lib -R/usr/local/ssl/lib -L/usr/local/BerkeleyDB.4.2/lib -R/usr/local/Berkel
eyDB.4.2/lib -lm  -lpython2.5   -lresolv -lsocket -lnsl -lrt -ldl  -lpthread   -lm _eprintf.o _floatdid
f.o _muldi3.o
/usr/local/apache2/build/libtool --silent --mode=compile gcc -prefer-pic   -DSOLARIS2=9 -D_POSIX_PTHREA
D_SEMANTICS -D_REENTRANT -D_LARGEFILE64_SOURCE -g -O2 -pthreads -I/usr/local/apache2/include  -I/usr/lo
cal/apache2/include   -I/usr/local/apache2/include -I/usr/local/include -I/files/app/modpython/mod_pyth
on-3.3.1/src/include -I/usr/local/apache2/include -I/usr/local/include/python2.5  -c -o mod_python.lo m
od_python.c && touch mod_python.slo

snip...

*** Warning: Linking the shared library mod_python.la against the non-libtool
*** objects  _eprintf.o _floatdidf.o _muldi3.o is not portable!
Text relocation remains                         referenced
    against symbol                  offset      in file
<unknown>                           0x1ee4      /usr/local/lib/python2.5/config/libpython2.5.a(floatobj
ect.o)
<unknown> 
<unknown>                           0x1eec      /usr/local/lib/python2.5/config/libpython2.5.a(floatobj
ect.o)
<unknown>                           0x1ef0      /usr/local/lib/python2.5/config/libpython2.5.a(floatobj
ect.o)
<unknown>                           0x1ef4      /usr/local/lib/python2.5/config/libpython2.5.a(floatobj
ect.o)
<unknown>                           0x1ef8      /usr/local/lib/python2.5/config/libpython2.5.a(floatobj
ect.o)
<unknown>                           0x3474      /usr/local/lib/python2.5/config/libpython2.5.a(listobje
ct.o)
<unknown>                           0x3478      /usr/local/lib/python2.5/config/libpython2.5.a(listobje
ct.o)
<unknown>                           0x347c      /usr/local/lib/python2.5/config/libpython2.5.a(listobje
ct.o)
<unknown>                           0x3480      /usr/local/lib/python2.5/config/libpython2.5.a(listobje
ct.o)
<unknown>                           0x3484      /usr/local/lib/python2.5/config/libpython2.5.a(listobje
ct.o)
<unknown>                           0x3488      /usr/local/lib/python2.5/config/libpython2.5.a(listobje
ct.o)
<unknown>                           0x290       /usr/local/lib/python2.5/config/libpython2.5.a(methodob
ject.o)
<unknown>                           0x294       /usr/local/lib/python2.5/config/libpython2.5.a(methodob
ject.o)
...lots more like above unknown symbol, ending with

ld: fatal: relocations remain against allocatable but non-writable sections
collect2: ld returned 1 exit status
apxs:Error: Command failed with rc=65536
.
*** Error code 1
make: Fatal error: Command failed for target `mod_python.so'
Current working directory /files/app/modpython/mod_python-3.3.1/src
*** Error code 1
make: Fatal error: Command failed for target `do_dso'
========================================================

Does anyone have any suggestions as to what I might look for/try? 
The real unix admins are not available at the moment and I'm bruising my head. 

Note that I seemed to have a similar problem with apache2 build seeing the static libs and not the shared libs at first that was apparently caused by some incorrect some symbolic links. Without knowing any better it almost looks to me like it is not seeing /usr/local/lib/python2.5/config/libpython2.5.a as a shared lib or something like that, but what do I know.


> -----Original Message-----
> From: mod_python-bounces@modpython.org
> [mailto:mod_python-bounces@modpython.org]On Behalf Of Jose De Leon
> Sent: Wednesday, February 28, 2007 1:16 PM
> To: Graham Dumpleton
> Cc: mod_python@modpython.org
> Subject: Re: [mod_python] Mod_Python Make fails on Solaris 9
> 
> 
> Thank you Graham! You pointed me in the right direction :) ... l 
> recompiled Python 2.5 with Shared Libraries instead of Static, when l 
> recompiled Mod_Python it worked like a charm, thanks again :)
> 
> ./configure --with-shared

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070405/cc28fed9/attachment.html
From graham.dumpleton at gmail.com  Thu Apr  5 18:50:31 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Apr  5 18:50:37 2007
Subject: [mod_python] compiling on solaris 9?
In-Reply-To: <6A5D305B0DE17541907AC0448C828A71012FB24C@CCSEXB10.CUNET.CARLETON.CA>
References: <6A5D305B0DE17541907AC0448C828A71012FB24C@CCSEXB10.CUNET.CARLETON.CA>
Message-ID: <88e286470704051550o3199f0f9x35b42aa2d2d79333@mail.gmail.com>

See:

  http://www.modpython.org/pipermail/mod_python/2007-February/023219.html

You need to hack src/Makefile to have -mimpure-text supplied as linker
option or rebuild mod_python with --enable-shared when you run
configure for mod_pytthon.

On 06/04/07, John_Nowlan <john_nowlan@carleton.ca> wrote:
>
>
>
> I have built apache2.2.4 and python2.5. from source, with some tweaks as
> outlined in some previous emails, i.e. build shared (some relevant snipped
> bits below).
>
> When I try and compile mod_python now I have a similar problem to what is
> outlined at:
>
> http://mail-archives.apache.org/mod_mbox/httpd-python-dev/200309.mbox/%3COFD98EF736.64974D7D-ON85256DA2.0054DC15-85256DA2.0055AD14@EU.novartis.net%3E
>
> i.e. lots of 'ld: fatal: relocations remain against allocatable but
> non-writable sections'
>
> Here is a fuller output:
>
> ar -x `gcc -print-libgcc-file-name` _eprintf.o
> ar -x `gcc -print-libgcc-file-name` _floatdidf.o
> ar -x `gcc -print-libgcc-file-name` _muldi3.o
>
> Compiling for DSO.
>
> /usr/local/apache2/bin/apxs
> -I/files/app/modpython/mod_python-3.3.1/src/include
> -I/usr/local/apache2/in
> clude -I/usr/local/include/python2.5 -c mod_python.c _apachemodule.c
> requestobject.c tableobject.c util
> .c  serverobject.c connobject.c filterobject.c hlist.c  hlistobject.c
> finfoobject.c -L/usr/local/lib/py
> thon2.5/config     -L/usr/local/lib -R/usr/local/lib -R/usr/lib -L/usr/lib
> -L/usr/openwin/lib -R/usr/op
> enwin/lib -L/usr/local/ssl/lib -R/usr/local/ssl/lib
> -L/usr/local/BerkeleyDB.4.2/lib -R/usr/local/Berkel
> eyDB.4.2/lib -lm  -lpython2.5   -lresolv -lsocket -lnsl -lrt -ldl  -lpthread
>   -lm _eprintf.o _floatdid
> f.o _muldi3.o
> /usr/local/apache2/build/libtool --silent --mode=compile
> gcc -prefer-pic   -DSOLARIS2=9 -D_POSIX_PTHREA
> D_SEMANTICS -D_REENTRANT -D_LARGEFILE64_SOURCE -g -O2 -pthreads
> -I/usr/local/apache2/include  -I/usr/lo
> cal/apache2/include   -I/usr/local/apache2/include -I/usr/local/include
> -I/files/app/modpython/mod_pyth
> on-3.3.1/src/include -I/usr/local/apache2/include
> -I/usr/local/include/python2.5  -c -o mod_python.lo m
> od_python.c && touch mod_python.slo
>
> snip...
>
> *** Warning: Linking the shared library mod_python.la against the
> non-libtool
> *** objects  _eprintf.o _floatdidf.o _muldi3.o is not portable!
> Text relocation remains                         referenced
>     against symbol                  offset      in file
> <unknown>                           0x1ee4
> /usr/local/lib/python2.5/config/libpython2.5.a(floatobj
> ect.o)
> <unknown>
> <unknown>                           0x1eec
> /usr/local/lib/python2.5/config/libpython2.5.a(floatobj
> ect.o)
> <unknown>                           0x1ef0
> /usr/local/lib/python2.5/config/libpython2.5.a(floatobj
> ect.o)
> <unknown>                           0x1ef4
> /usr/local/lib/python2.5/config/libpython2.5.a(floatobj
> ect.o)
> <unknown>                           0x1ef8
> /usr/local/lib/python2.5/config/libpython2.5.a(floatobj
> ect.o)
> <unknown>                           0x3474
> /usr/local/lib/python2.5/config/libpython2.5.a(listobje
> ct.o)
> <unknown>                           0x3478
> /usr/local/lib/python2.5/config/libpython2.5.a(listobje
> ct.o)
> <unknown>                           0x347c
> /usr/local/lib/python2.5/config/libpython2.5.a(listobje
> ct.o)
> <unknown>                           0x3480
> /usr/local/lib/python2.5/config/libpython2.5.a(listobje
> ct.o)
> <unknown>                           0x3484
> /usr/local/lib/python2.5/config/libpython2.5.a(listobje
> ct.o)
> <unknown>                           0x3488
> /usr/local/lib/python2.5/config/libpython2.5.a(listobje
> ct.o)
> <unknown>                           0x290
> /usr/local/lib/python2.5/config/libpython2.5.a(methodob
> ject.o)
> <unknown>                           0x294
> /usr/local/lib/python2.5/config/libpython2.5.a(methodob
> ject.o)
> ...lots more like above unknown symbol, ending with
>
> ld: fatal: relocations remain against allocatable but non-writable sections
> collect2: ld returned 1 exit status
> apxs:Error: Command failed with rc=65536
> .
> *** Error code 1
> make: Fatal error: Command failed for target `mod_python.so'
> Current working directory
> /files/app/modpython/mod_python-3.3.1/src
> *** Error code 1
> make: Fatal error: Command failed for target `do_dso'
> ========================================================
>
> Does anyone have any suggestions as to what I might look for/try?
> The real unix admins are not available at the moment and I'm bruising my
> head.
>
> Note that I seemed to have a similar problem with apache2 build seeing the
> static libs and not the shared libs at first that was apparently caused by
> some incorrect some symbolic links. Without knowing any better it almost
> looks to me like it is not seeing
> /usr/local/lib/python2.5/config/libpython2.5.a as a shared
> lib or something like that, but what do I know.
>
>
> > -----Original Message-----
> > From: mod_python-bounces@modpython.org
> > [mailto:mod_python-bounces@modpython.org]On Behalf Of
> Jose De Leon
> > Sent: Wednesday, February 28, 2007 1:16 PM
> > To: Graham Dumpleton
> > Cc: mod_python@modpython.org
> > Subject: Re: [mod_python] Mod_Python Make fails on Solaris 9
> >
> >
> > Thank you Graham! You pointed me in the right direction :) ... l
> > recompiled Python 2.5 with Shared Libraries instead of Static, when l
> > recompiled Mod_Python it worked like a charm, thanks again :)
> >
> > ./configure --with-shared
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
From scarfboy at gmail.com  Fri Apr  6 10:54:45 2007
From: scarfboy at gmail.com (Bart)
Date: Fri Apr  6 10:54:53 2007
Subject: [mod_python] Catching errors above handler level?
Message-ID: <b71082d80704060754x3d38a16i823ef295da503ce4@mail.gmail.com>

I would like to know whether there's a way to work above
the level of handlers, since I'm thinking about making
a singular error handler that says things like "Oops,
the database acted up" without having to add
the same try-except-except-except-except to all of my
two dozen or so handlers.

If possible, it may be interesting in other ways, such as making a
nice exception formatter too, like moimoin's (if memory serves).


I also wonder whether it's simple to add automatic me-notification of
things like HTTP 404 and 500 errors as well as python exceptions.

Can at least the HTTP error bit be done by falling through to a
python/php errordocument page?
Can it be done Inside mod_python? (which would have the possible
upside of being able to  report context variables too, but I can live
without that)


thanks for having your brains picked,
--Bart
From graham.dumpleton at gmail.com  Fri Apr  6 19:34:06 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Fri Apr  6 19:34:12 2007
Subject: [mod_python] Catching errors above handler level?
In-Reply-To: <b71082d80704060754x3d38a16i823ef295da503ce4@mail.gmail.com>
References: <b71082d80704060754x3d38a16i823ef295da503ce4@mail.gmail.com>
Message-ID: <88e286470704061634xe1faa0bi39fbbc5484eb316b@mail.gmail.com>

On 07/04/07, Bart <scarfboy@gmail.com> wrote:
> I would like to know whether there's a way to work above
> the level of handlers, since I'm thinking about making
> a singular error handler that says things like "Oops,
> the database acted up" without having to add
> the same try-except-except-except-except to all of my
> two dozen or so handlers.
>
> If possible, it may be interesting in other ways, such as making a
> nice exception formatter too, like moimoin's (if memory serves).
>
>
> I also wonder whether it's simple to add automatic me-notification of
> things like HTTP 404 and 500 errors as well as python exceptions.
>
> Can at least the HTTP error bit be done by falling through to a
> python/php errordocument page?
> Can it be done Inside mod_python? (which would have the possible
> upside of being able to  report context variables too, but I can live
> without that)

This has been asked before. To do it the Apache way would need changes
to mod_python. See:

http://www.modpython.org/pipermail/mod_python/2007-March/023290.html

for more details.

Graham
From amorey at octopart.com  Sun Apr  8 02:36:40 2007
From: amorey at octopart.com (Andres Morey)
Date: Sun Apr  8 02:37:03 2007
Subject: [mod_python] mpm-worker and mod_python
Message-ID: <2FF8C8AA-EA51-4F9D-BF07-426952B767C3@octopart.com>

Hi,

I had mod_python 3.3.1 running on Apache 2.2.4 with mpm-prefork (on  
Ubuntu 6.10 x86_64). mod_python wasn't caching modules so I  
recompiled apache with mpm-worker instead. Now mod_python is caching  
modules but apache is taking up 100% of system resources. Is it  
possible to cache modules with Apache using mpm-prefork? Has anybody  
else seen all system resources get taken up by using mod_python and  
mpm-worker?

thanks,
-Andres

From phillscot at mac.com  Sun Apr  8 14:31:40 2007
From: phillscot at mac.com (Philippe Schottey)
Date: Sun Apr  8 14:33:34 2007
Subject: [mod_python] cgi handler
Message-ID: <775B0CD3-FC05-4ABD-B2F9-45A41E8ABD1E@mac.com>

Hello,

This is the first time i'm using python and mod_python.
The hosting company only wants to use the cgi_handler.

I have some problems retrieving POST and GET parameters.
I've read somewhere that this should do the trick:

import cgi
form = cgi.FieldStorage()
value = form[key]

When I'm trying this, the form object is allways empty.
The form code:
		<form name="main" action="test.py" method="POST">
			<input type="hidden" name="action" id="action" value="good"/>
             <input type="submit"/>
		</form>

I can't seem to retrieve the action parameter.
Help.

Thanks,

Philippe Schottey



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070408/c7eebbb3/attachment.html
From ondra.cap at seznam.cz  Sun Apr  8 16:28:17 2007
From: ondra.cap at seznam.cz (Ondra Kupka)
Date: Sun Apr  8 16:28:23 2007
Subject: [mod_python] cgi handler
In-Reply-To: <775B0CD3-FC05-4ABD-B2F9-45A41E8ABD1E@mac.com>
References: <775B0CD3-FC05-4ABD-B2F9-45A41E8ABD1E@mac.com>
Message-ID: <46195061.10107@seznam.cz>

Philippe Schottey wrote:
> Hello,
>
> This is the first time i'm using python and mod_python.
> The hosting company only wants to use the cgi_handler.
>
> I have some problems retrieving POST and GET parameters.
> I've read somewhere that this should do the trick:
>
> import cgi
> form = cgi.FieldStorage()
> value = form[key]
>
> When I'm trying this, the form object is allways empty.
> The form code:
> <form name="main" action="test.py" method="POST">
> <input type="hidden" name="action" id="action" value="good"/>
>             <input type="submit"/>
> </form>
>
> I can't seem to retrieve the action parameter.
> Help.
>
> Thanks,
>
> Philippe Schottey
>
>
>
> ------------------------------------------------------------------------
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>   
Hi,
I'm just beginner, but I think you should use form[key].value
From phillscot at mac.com  Sun Apr  8 16:32:27 2007
From: phillscot at mac.com (Philippe Schottey)
Date: Sun Apr  8 16:34:18 2007
Subject: [mod_python] cgi handler
In-Reply-To: <46195061.10107@seznam.cz>
References: <775B0CD3-FC05-4ABD-B2F9-45A41E8ABD1E@mac.com>
	<46195061.10107@seznam.cz>
Message-ID: <54D7C50D-DB97-4FED-80BD-7EE5B6DEA991@mac.com>

That does not change anything.
You see even this gives false:

form.has_key(key)

I think I badly create the FieldStorage()...


On 08 Apr 2007, at 22:28, Ondra Kupka wrote:

> Philippe Schottey wrote:
>> Hello,
>>
>> This is the first time i'm using python and mod_python.
>> The hosting company only wants to use the cgi_handler.
>>
>> I have some problems retrieving POST and GET parameters.
>> I've read somewhere that this should do the trick:
>>
>> import cgi
>> form = cgi.FieldStorage()
>> value = form[key]
>>
>> When I'm trying this, the form object is allways empty.
>> The form code:
>> <form name="main" action="test.py" method="POST">
>> <input type="hidden" name="action" id="action" value="good"/>
>>             <input type="submit"/>
>> </form>
>>
>> I can't seem to retrieve the action parameter.
>> Help.
>>
>> Thanks,
>>
>> Philippe Schottey
>>
>>
>>
>> --------------------------------------------------------------------- 
>> ---
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>
> Hi,
> I'm just beginner, but I think you should use form[key].value

From amorey at octopart.com  Sun Apr  8 16:39:11 2007
From: amorey at octopart.com (Andres Morey)
Date: Sun Apr  8 16:39:24 2007
Subject: [mod_python] cgi handler
In-Reply-To: <46195061.10107@seznam.cz>
References: <775B0CD3-FC05-4ABD-B2F9-45A41E8ABD1E@mac.com>
	<46195061.10107@seznam.cz>
Message-ID: <6129F1D6-9824-4EA3-8838-50F731DA755F@octopart.com>

Hi,

What is the best Apache configuration for mod_python (v3.3.1)? Should  
Apache be compiled with mpm-prefork or mpm-worker?

Thanks,
-Andres

From graham.dumpleton at gmail.com  Sun Apr  8 21:44:51 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sun Apr  8 21:44:54 2007
Subject: [mod_python] mpm-worker and mod_python
In-Reply-To: <2FF8C8AA-EA51-4F9D-BF07-426952B767C3@octopart.com>
References: <2FF8C8AA-EA51-4F9D-BF07-426952B767C3@octopart.com>
Message-ID: <88e286470704081844j88eba5aoe6001e402fbcab25@mail.gmail.com>

On 08/04/07, Andres Morey <amorey@octopart.com> wrote:
> Hi,
>
> I had mod_python 3.3.1 running on Apache 2.2.4 with mpm-prefork (on
> Ubuntu 6.10 x86_64). mod_python wasn't caching modules so I
> recompiled apache with mpm-worker instead.

mod_python should be caching modules with prefork. On what basis do
you believe it isn't? Are you possibly not reading the Apache error
log messages properly where it clearly gives the process ID for which
process is currently loading mod_python modules. For prefork there can
be many Apache child processes so you will see for each distinct
module a loading message for each distinct process.

> Now mod_python is caching
> modules but apache is taking up 100% of system resources.

What did you do to trigger the condition? Does it do that as soon as
Apache starts, or only after the first request that triggers some
mod_python code?

> Is it
> possible to cache modules with Apache using mpm-prefork?

It should work fine now.

BTW, what modules are you talking about? Are you talking about modules
installed as part of Python, or those in your document tree and
containing a handler or which are being loaded by
mod_python.publisher?

Is your mod_python code otherwise working? There is a rare case where
an issue with md5 hash library in PHP may cause a lot of problems with
the new module loaded in mod_python 3.3.1.

Graham
From graham.dumpleton at gmail.com  Sun Apr  8 21:52:13 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sun Apr  8 21:52:19 2007
Subject: [mod_python] cgi handler
In-Reply-To: <775B0CD3-FC05-4ABD-B2F9-45A41E8ABD1E@mac.com>
References: <775B0CD3-FC05-4ABD-B2F9-45A41E8ABD1E@mac.com>
Message-ID: <88e286470704081852j266d49d4r748b68b70ec01900@mail.gmail.com>

On 09/04/07, Philippe Schottey <phillscot@mac.com> wrote:
> Hello,
>
> This is the first time i'm using python and mod_python.
> The hosting company only wants to use the cgi_handler.

Can you confirm that what you mean is that the web hosting company is
only allowing you to use as the handler for mod_python:

  PythonHandler mod_python.cgihandler

Just want to confirm so that we know for sure that you aren't just
using standard CGI.

> I have some problems retrieving POST and GET parameters.
> I've read somewhere that this should do the trick:
>
> import cgi
> form = cgi.FieldStorage()
> value = form[key]

Can you perhaps show a more complete script?

Also, which version of mod_python is being used and which version of Python?

Graham

> When I'm trying this, the form object is allways empty.
> The form code:
>  <form name="main" action="test.py" method="POST">
>  <input type="hidden" name="action" id="action" value="good"/>
>             <input type="submit"/>
>  </form>
>
> I can't seem to retrieve the action parameter.
From graham.dumpleton at gmail.com  Sun Apr  8 21:54:20 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sun Apr  8 21:54:22 2007
Subject: [mod_python] cgi handler
In-Reply-To: <6129F1D6-9824-4EA3-8838-50F731DA755F@octopart.com>
References: <775B0CD3-FC05-4ABD-B2F9-45A41E8ABD1E@mac.com>
	<46195061.10107@seznam.cz>
	<6129F1D6-9824-4EA3-8838-50F731DA755F@octopart.com>
Message-ID: <88e286470704081854u763f9425l611c215a90bb6074@mail.gmail.com>

On 09/04/07, Andres Morey <amorey@octopart.com> wrote:
> Hi,
>
> What is the best Apache configuration for mod_python (v3.3.1)? Should
> Apache be compiled with mpm-prefork or mpm-worker?

It is safest to use mpm-prefork if you are using other third party web
frameworks or components and have no idea if those packages are thread
safe. Even if you are writing your own from scratch, if you don't know
much about writing thread safe code, use mpm-prefork.

In short, the difference is that mpm-worker can result in multiple
requests being processed within the same process at the same time in
different threads. Thus your code needs to be thread safe.

Graham
From graham.dumpleton at gmail.com  Sun Apr  8 22:40:34 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sun Apr  8 22:40:39 2007
Subject: [mod_python] mpm-worker and mod_python
In-Reply-To: <43C591BB-2BF1-4EB6-9BF3-4E32AE468AF1@octopart.com>
References: <2FF8C8AA-EA51-4F9D-BF07-426952B767C3@octopart.com>
	<88e286470704081844j88eba5aoe6001e402fbcab25@mail.gmail.com>
	<43C591BB-2BF1-4EB6-9BF3-4E32AE468AF1@octopart.com>
Message-ID: <88e286470704081940y9187ea4r7341eea18e145b8d@mail.gmail.com>

On 09/04/07, Andres Morey <amorey@octopart.com> wrote:
> Hi Graham,
>
> Thanks for your reply. I looked into it again and mod_python is
> actually caching modules with prefork. Page load times were taking a
> while and originally it looked like it was a module caching problem.
> Part of the problem is that apache was running 6 processes so it was
> difficult to determine when slow load times were caused by mod_python
> importing modules on a new process or other problems in the code.
>
> I've narrowed down the trouble spots that are unrelated to mod_python
> but I still have one question about caching. Does mod_python reimport
> modules when it encounters modules of the same name in different
> directories? I have index.py as the name for handlers in different
> directories and I'm wondering if mod_python is reimporting them every
> time it encounters one.

Prior to mod_python 3.2.8 it had that problem for any handler modules
or modules imported using apache.import_module(). In mod_python 3.2.X
it only had the problem for handler modules and mod_python.publisher
worked okay. In mod_python 3.3.1 it shouldn't be a problem at all as
modules imported by mod_python module loader are distinguished by full
path. For more details see import_module() documentation in:

  http://www.modpython.org/live/current/doc-html/pyapi-apmeth.html

and also read:

  http://www.dscpl.com.au/wiki/ModPython/Articles/ModuleImportingIsBroken

Note, make sure you are not setting PythonPath to contain locations in
document tree if using mod_python 3.3.1. Documentation above should
from memory explain why not.

> Finally, is there a way to force mod_python to cache modules before a
> request is made to apache?

Use the PythonImport directive:

  http://www.modpython.org/live/current/doc-html/dir-other-pimp.html

Graham

> On Apr 8, 2007, at 6:44 PM, Graham Dumpleton wrote:
>
> > On 08/04/07, Andres Morey <amorey@octopart.com> wrote:
> >> Hi,
> >>
> >> I had mod_python 3.3.1 running on Apache 2.2.4 with mpm-prefork (on
> >> Ubuntu 6.10 x86_64). mod_python wasn't caching modules so I
> >> recompiled apache with mpm-worker instead.
> >
> > mod_python should be caching modules with prefork. On what basis do
> > you believe it isn't? Are you possibly not reading the Apache error
> > log messages properly where it clearly gives the process ID for which
> > process is currently loading mod_python modules. For prefork there can
> > be many Apache child processes so you will see for each distinct
> > module a loading message for each distinct process.
> >
> >> Now mod_python is caching
> >> modules but apache is taking up 100% of system resources.
> >
> > What did you do to trigger the condition? Does it do that as soon as
> > Apache starts, or only after the first request that triggers some
> > mod_python code?
> >
> >> Is it
> >> possible to cache modules with Apache using mpm-prefork?
> >
> > It should work fine now.
> >
> > BTW, what modules are you talking about? Are you talking about modules
> > installed as part of Python, or those in your document tree and
> > containing a handler or which are being loaded by
> > mod_python.publisher?
> >
> > Is your mod_python code otherwise working? There is a rare case where
> > an issue with md5 hash library in PHP may cause a lot of problems with
> > the new module loaded in mod_python 3.3.1.
> >
> > Graham
>
>
From graham.dumpleton at gmail.com  Sun Apr  8 23:38:38 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sun Apr  8 23:38:42 2007
Subject: [mod_python] cgi handler
In-Reply-To: <1C97D56F-2B3C-49C3-9A9B-7BA4E036A8E0@mac.com>
References: <775B0CD3-FC05-4ABD-B2F9-45A41E8ABD1E@mac.com>
	<88e286470704081852j266d49d4r748b68b70ec01900@mail.gmail.com>
	<1C97D56F-2B3C-49C3-9A9B-7BA4E036A8E0@mac.com>
Message-ID: <88e286470704082038k13f8e7b6h3e98bdaa59e62262@mail.gmail.com>

Code works fine for me on mod_python 3.3.1, Python 2.3.5 and Apache 2.2.1.

Thus, nothing wrong with the code itself.

Can you be more precise about which version of mod_python they are using?

On 09/04/07, Philippe Schottey <phillscot@mac.com> wrote:
> Indeed, only the cgi_handler is configured.
> Versions:
> python 2.3
> apache 2
> mod_python 3.*
>
> The (test) script I have is:
>
> from mod_python import apache
> import cgi
>
> form = cgi.FieldStorage()
>
> print """Content-type: text/html
>
> <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
> <html>
>     <head>
>         <title>test</title>
>     </head>
>     <body>
>         """
> print form.has_key('action')
> print """
>     </body>
> </html>"""
>
>
>
> On 09 Apr 2007, at 03:52, Graham Dumpleton wrote:
>
> On 09/04/07, Philippe Schottey <phillscot@mac.com> wrote:
> Hello,
>
> This is the first time i'm using python and mod_python.
> The hosting company only wants to use the cgi_handler.
>
> Can you confirm that what you mean is that the web hosting company is
> only allowing you to use as the handler for mod_python:
>
>  PythonHandler mod_python.cgihandler
>
> Just want to confirm so that we know for sure that you aren't just
> using standard CGI.
>
>
> I have some problems retrieving POST and GET parameters.
> I've read somewhere that this should do the trick:
>
> import cgi
> form = cgi.FieldStorage()
> value = form[key]
>
> Can you perhaps show a more complete script?
>
> Also, which version of mod_python is being used and which version of Python?
>
> Graham
>
>
> When I'm trying this, the form object is allways empty.
> The form code:
>  <form name="main" action="test.py" method="POST">
>  <input type="hidden" name="action" id="action" value="good"/>
>             <input type="submit"/>
>  </form>
>
> I can't seem to retrieve the action parameter.
>
From sebastien.maret at gmail.com  Mon Apr  9 00:37:41 2007
From: sebastien.maret at gmail.com (Sebastien Maret)
Date: Mon Apr  9 00:40:06 2007
Subject: [mod_python] popen() and mod_python
Message-ID: <m2bqhyduy2.fsf@gmail.com>

Hello,

I need to write a Python script that open an other program through a
pipe. For example:

import os

def index(req):
       
   p = os.popen ("/bin/sh", 'w')
   p.write ("ls >> log")
   p.close ()

   f = open("log")
   s = f.readlines()
   f.close()

   return s

Although the same kind of script works fine when I run it from the
command line, it does not work when I put it on my webserver. The pipe
does not seems to be opened. Is it for security reasons? Is there a
workaround?

Thanks,
S?bastien






From jgentil at sebistar.net  Mon Apr  9 12:26:18 2007
From: jgentil at sebistar.net (Jon-Pierre Gentil)
Date: Mon Apr  9 12:27:45 2007
Subject: [mod_python] popen() and mod_python
In-Reply-To: <m2bqhyduy2.fsf@gmail.com>
References: <m2bqhyduy2.fsf@gmail.com>
Message-ID: <461A692A.9060004@sebistar.net>

Sebastien Maret wrote:

> import os
> 
> def index(req):
>        
>    p = os.popen ("/bin/sh", 'w')
>    p.write ("ls >> log")
>    p.close ()
> 
>    f = open("log")
>    s = f.readlines()
>    f.close()
> 
>    return s
> 
> Although the same kind of script works fine when I run it from the
> command line, it does not work when I put it on my webserver. The pipe
> does not seems to be opened. Is it for security reasons? Is there a
> workaround?


It looks like you're returning the string instead of using req.write()
to output the data.  A request handler expects an HTTP code return
value, not the string output..

See http://www.modpython.org/live/current/doc-html/pyapi-handler.html
From list at joreybump.com  Mon Apr  9 12:56:31 2007
From: list at joreybump.com (Jorey Bump)
Date: Mon Apr  9 12:56:39 2007
Subject: [mod_python] popen() and mod_python
In-Reply-To: <461A692A.9060004@sebistar.net>
References: <m2bqhyduy2.fsf@gmail.com> <461A692A.9060004@sebistar.net>
Message-ID: <461A703F.9060106@joreybump.com>

Jon-Pierre Gentil wrote:
> Sebastien Maret wrote:
> 
>> import os
>>
>> def index(req):
>>        
>>    p = os.popen ("/bin/sh", 'w')
>>    p.write ("ls >> log")
>>    p.close ()
>>
>>    f = open("log")
>>    s = f.readlines()
>>    f.close()
>>
>>    return s
>>
>> Although the same kind of script works fine when I run it from the
>> command line, it does not work when I put it on my webserver. The pipe
>> does not seems to be opened. Is it for security reasons? Is there a
>> workaround?
> 
> 
> It looks like you're returning the string instead of using req.write()
> to output the data.  A request handler expects an HTTP code return
> value, not the string output..

That's not true of all handlers. The OP might be using Publisher, which 
only requires a string to be returned.

Try using full paths to all binaries and files. The apache user is 
likely to have a very different environment than your normal user at the 
command line, and there's no guarantee that it won't change beneath your 
feet. Rule out all ambiguity.

Also, you might want to try with something simpler, such as returning 
only the output of ls. In fact, I'm not sure I see the purpose of 
opening /bin/sh here, but maybe you have something else in mind other 
than this example, hopefully not evil. :)

From john_nowlan at carleton.ca  Mon Apr  9 13:33:28 2007
From: john_nowlan at carleton.ca (John_Nowlan)
Date: Mon Apr  9 13:34:18 2007
Subject: [mod_python] compiling on solaris 9?
In-Reply-To: <88e286470704051550o3199f0f9x35b42aa2d2d79333@mail.gmail.com>
Message-ID: <6A5D305B0DE17541907AC0448C828A71012FB253@CCSEXB10.CUNET.CARLETON.CA>

Looks like the source of my problem was incorrectly building python

with: --with-shared (silently ignored, if my understanding is correct)
when it should have been: --enable-shared

rebuilding corrected - and built libpython.so. 
Thanks.

Can anyone recommend good reading for understanding ./configure options? Is this output from autoconf? and does reading up on autoconf explain .configure options?

> -----Original Message-----
> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
> Sent: Thursday, April 05, 2007 6:51 PM
> To: John_Nowlan
> Cc: Mod_python@modpython.org
> Subject: Re: [mod_python] compiling on solaris 9?
> 
> 
> See:
> 
>   
> http://www.modpython.org/pipermail/mod_python/2007-February/02
> 3219.html
> 
> You need to hack src/Makefile to have -mimpure-text supplied as linker
> option or rebuild mod_python with --enable-shared when you run
> configure for mod_pytthon.
> 
From list at joreybump.com  Mon Apr  9 14:10:05 2007
From: list at joreybump.com (Jorey Bump)
Date: Mon Apr  9 14:10:12 2007
Subject: [mod_python] compiling on solaris 9?
In-Reply-To: <6A5D305B0DE17541907AC0448C828A71012FB253@CCSEXB10.CUNET.CARLETON.CA>
References: <6A5D305B0DE17541907AC0448C828A71012FB253@CCSEXB10.CUNET.CARLETON.CA>
Message-ID: <461A817D.6050400@joreybump.com>

John_Nowlan wrote:
> Looks like the source of my problem was incorrectly building python
> 
> with: --with-shared (silently ignored, if my understanding is correct)
> when it should have been: --enable-shared
> 
> rebuilding corrected - and built libpython.so. 
> Thanks.
> 
> Can anyone recommend good reading for understanding ./configure options? Is this output from autoconf? and does reading up on autoconf explain .configure options?

Your best bet is to run this command:

  ./configure --help

Then consult the application's documentation for anything that isn't 
clear (and cross your fingers that you will find an answer).


From adityode at gmail.com  Tue Apr 10 04:15:01 2007
From: adityode at gmail.com (adityo deshmukh)
Date: Tue Apr 10 04:11:59 2007
Subject: [mod_python] compile problems on mod_python 3.3.1
Message-ID: <461B4785.7040809@gmail.com>

Hello,

Im running Apache 2.0.55 and python 2.4.4 on a a debian system (amd64 
kernel 2.6.15-1-amd64-k8)

i am trying to build mod python from source however i am getting this 
error..

./configure --with-apxs=/usr/bin/apxs2 --with-python=/usr/bin/python2.4
checking for gcc... gcc
checking for C compiler default output file name... a.out
checking whether the C compiler works... yes
checking whether we are cross compiling... no
checking for suffix of executables...
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether gcc accepts -g... yes
checking for gcc option to accept ANSI C... none needed
checking for ar... ar
checking for a BSD-compatible install... /usr/bin/install -c
checking whether make sets $(MAKE)... yes
checking for main in -lm... yes
checking for an ANSI C-conforming const... yes
checking your blood pressure... a bit high, but we can proceed
configure: checking whether apxs is available...
checking for --with-apxs... /usr/bin/apxs2 executable, good
checking Apache version... 2.0.55
checking for Apache libexec directory... /usr/lib/apache2/modules
checking for Apache include directory... -I/usr/include/apache2
checking for --with-python... /usr/bin/python2.4
checking Python version... 2.4
checking Python install prefix... /usr
checking checking where python libraries are installed... 
/usr/lib/python2.4
checking for Py_NewInterpreter in -lpython2.4... no
configure: error: Can not link to python

any ideas..why this is happening..

regards
adi

From graham.dumpleton at gmail.com  Tue Apr 10 05:25:07 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Apr 10 05:25:26 2007
Subject: [mod_python] compile problems on mod_python 3.3.1
In-Reply-To: <461B4785.7040809@gmail.com>
References: <461B4785.7040809@gmail.com>
Message-ID: <88e286470704100225v3f36dc5ayf95d6f73ef2351e0@mail.gmail.com>

You probably only have the 'python' rpm or equivalent package for your
system installed. You also need to have 'python-dev' package
installed. This contains header files and the Python library.

Graham

On 10/04/07, adityo deshmukh <adityode@gmail.com> wrote:
> Hello,
>
> Im running Apache 2.0.55 and python 2.4.4 on a a debian system (amd64
> kernel 2.6.15-1-amd64-k8)
>
> i am trying to build mod python from source however i am getting this
> error..
>
> ./configure --with-apxs=/usr/bin/apxs2 --with-python=/usr/bin/python2.4
> checking for gcc... gcc
> checking for C compiler default output file name... a.out
> checking whether the C compiler works... yes
> checking whether we are cross compiling... no
> checking for suffix of executables...
> checking for suffix of object files... o
> checking whether we are using the GNU C compiler... yes
> checking whether gcc accepts -g... yes
> checking for gcc option to accept ANSI C... none needed
> checking for ar... ar
> checking for a BSD-compatible install... /usr/bin/install -c
> checking whether make sets $(MAKE)... yes
> checking for main in -lm... yes
> checking for an ANSI C-conforming const... yes
> checking your blood pressure... a bit high, but we can proceed
> configure: checking whether apxs is available...
> checking for --with-apxs... /usr/bin/apxs2 executable, good
> checking Apache version... 2.0.55
> checking for Apache libexec directory... /usr/lib/apache2/modules
> checking for Apache include directory... -I/usr/include/apache2
> checking for --with-python... /usr/bin/python2.4
> checking Python version... 2.4
> checking Python install prefix... /usr
> checking checking where python libraries are installed...
> /usr/lib/python2.4
> checking for Py_NewInterpreter in -lpython2.4... no
> configure: error: Can not link to python
>
> any ideas..why this is happening..
>
> regards
> adi
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From roberto at connexer.com  Tue Apr 10 05:27:19 2007
From: roberto at connexer.com (Roberto =?iso-8859-1?Q?C=2E_S=E1nchez?=)
Date: Tue Apr 10 05:27:25 2007
Subject: [mod_python] compile problems on mod_python 3.3.1
In-Reply-To: <461B4785.7040809@gmail.com>
References: <461B4785.7040809@gmail.com>
Message-ID: <20070410092719.GA11099@santiago.connexer.com>

On Tue, Apr 10, 2007 at 01:45:01PM +0530, adityo deshmukh wrote:
> Hello,
> 
> Im running Apache 2.0.55 and python 2.4.4 on a a debian system (amd64 
> kernel 2.6.15-1-amd64-k8)
> 
> i am trying to build mod python from source however i am getting this 
> error..
> 
Out of curiousity, what is wrong with the Debian packages that makes
them unsuitable?

<SNIP>
> checking for Py_NewInterpreter in -lpython2.4... no
> configure: error: Can not link to python
> 
> any ideas..why this is happening..
> 
You do not have the python-dev and/or the python2.4-dev packages
installed.

Regards,

-Roberto
-- 
Roberto C. S?nchez
http://people.connexer.com/~roberto
http://www.connexer.com
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070410/d16e5cd1/attachment.bin
From jguthrie at brokersys.com  Tue Apr 10 15:23:01 2007
From: jguthrie at brokersys.com (Jonathan Guthrie)
Date: Tue Apr 10 15:23:14 2007
Subject: [mod_python] Where do I submit patches?
Message-ID: <1176232981.3075.38.camel@jguthrie>

I'm new here, so I don't rightly know.  Where do I submit patches for
review and (possibly) inclusion into the source?  It's a large patch,
intended to address the first part of MODPYTHON-169.

From graham.dumpleton at gmail.com  Tue Apr 10 17:41:30 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Apr 10 17:41:36 2007
Subject: [mod_python] Where do I submit patches?
In-Reply-To: <1176232981.3075.38.camel@jguthrie>
References: <1176232981.3075.38.camel@jguthrie>
Message-ID: <88e286470704101441o61ffc5b0m67ea0d2c191fd8aa@mail.gmail.com>

On 11/04/07, Jonathan Guthrie <jguthrie@brokersys.com> wrote:
> I'm new here, so I don't rightly know.  Where do I submit patches for
> review and (possibly) inclusion into the source?  It's a large patch,
> intended to address the first part of MODPYTHON-169.

Provided the patches are against mod_python 3.3.1, create yourself a
JIRA account and attach it to the issue along with any additional
comments you may have as to how it matches up with what was proposed
etc.

Graham
From graham.dumpleton at gmail.com  Tue Apr 10 17:47:18 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Apr 10 17:47:23 2007
Subject: [mod_python] Where do I submit patches?
In-Reply-To: <88e286470704101441o61ffc5b0m67ea0d2c191fd8aa@mail.gmail.com>
References: <1176232981.3075.38.camel@jguthrie>
	<88e286470704101441o61ffc5b0m67ea0d2c191fd8aa@mail.gmail.com>
Message-ID: <88e286470704101447s21c0b37exa6b13cb75ff84dce@mail.gmail.com>

On 11/04/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> On 11/04/07, Jonathan Guthrie <jguthrie@brokersys.com> wrote:
> > I'm new here, so I don't rightly know.  Where do I submit patches for
> > review and (possibly) inclusion into the source?  It's a large patch,
> > intended to address the first part of MODPYTHON-169.
>
> Provided the patches are against mod_python 3.3.1, create yourself a
> JIRA account and attach it to the issue along with any additional
> comments you may have as to how it matches up with what was proposed
> etc.

Oh, also get yourself subscribed to the mod_python developers mailing
list (python-dev). See details at:

  http://wiki.apache.org/mod_python/Mailing_lists

This is where any followup discussion on your proposed changes would be.

Graham
From ds at bittorrent.com  Tue Apr 10 19:10:32 2007
From: ds at bittorrent.com (David Schachter)
Date: Tue Apr 10 19:10:44 2007
Subject: [mod_python] Global Interpreter Lock problem with Berkeley DB XML
	and mod_python
Message-ID: <461C1968.3080103@bittorrent.com>

Folks--

I'm having a problem embedding Berkeley DB XML into Apache with 
mod_python. The first attempt to create an XmlManager causes a lockup in 
Python--the Global Interpreter Lock is deadlocked, I think. (Stack trace 
below.) Any ideas of how to debug? Is there a BDB XML Python expert? I 
checked Google without success.

The code to demonstrate the problem is simple and shown below. When the 
line "xmlManager = dbxml.XmlManager()" is commented out, the code runs 
ok. Commented in, Apache locks up.

The most recent mod_python has this comment at 
http://www.modpython.org/live/mod_python-3.3.1/doc-html/app-changes.html:

    Third party C modules that use the simplified API for the Global
    Interpreter Lock (GIL), as described in PEP 311, can now be used.
    The only requirement is that such modules can only be used in the
    context of the "main_interpreter". /(More info at
    http://issues.apache.org/jira/browse/MODPYTHON-77.)/

The documentation for mod_python at 
http://www.modpython.org/live/current/doc-html/pyapi-interps.html says:

    Note that if any third party module is being used which has a C code
    component that uses the simplified API for access to the Global
    Interpreter Lock (GIL) for Python extension modules, then the
    interpreter name must be forcibly set to be "main_interpreter". This
    is necessary as such a module will only work correctly if run within
    the context of the first Python interpreter created by the process.

Conforming to this, I set the interpreter name in the httpd.conf file 
using the directive "PythonInterpreter main_interpreter" and I verified 
this by printing the interpreter name from my Python code.

In dbxml-2.3.10/dbxml/src/python, there's some code relating to the GIL 
in dbxml_python_wrap.cpp. If someone else has already beaten this 
problem into submission, I'd rather not duplicate the effort.

                         -- David Schachter

#! /usr/bin/python

import dbxml
from mod_python import apache
import os


def handler(req):
  id = "pid %d, interpreter '%s'" % (os.getpid(), req.interpreter)

  apache.log_error("About to start BDB XML from %s." % id)
  xmlManager = dbxml.XmlManager()
  apache.log_error("Started BDB XML.")

  req.write("Hi from %s." % id)
  return apache.OK


STACK TRACE IS:

(gdb) bt
#0  0xffffe410 in __kernel_vsyscall ()
#1  0xb7e97af0 in sem_wait@GLIBC_2.0 () from 
/lib/tls/i686/cmov/libpthread.so.0
#2  0x00000004 in ?? ()
#3  0xb7ce7a00 in PyThread_acquire_lock (lock=0x0, waitflag=1) at 
thread_pthread.h:298
#4  0xb7cb5689 in PyEval_RestoreThread (tstate=0x810f888) at 
Python/ceval.c:305
#5  0xb7ce16e7 in PyGILState_Ensure () at Python/pystate.c:512
#6  0xb78282f9 in _wrap_new_XmlManager (self=0x0, args=0xb7b9102c) at 
dbxml_python_wrap.cpp:898
     (The reference to line 898 is correct but surprising, the result of 
a macro expansion at line 4195. --D.S.)
#7  0xb7c65967 in PyObject_Call (func=0x0, arg=0xfffffffc, 
kw=0xfffffffc) at Objects/abstract.c:1795
#8  0xb7cb9e1d in PyEval_EvalFrame (f=0x822cdbc) at Python/ceval.c:3845
#9  0xb7cbd719 in PyEval_EvalCodeEx (co=0xb6b12e20, globals=0xfffffffc, 
locals=0x0, args=0x0, argcount=1,
    kws=0x0, kwcount=0, defs=0x0, defcount=0, closure=0x0) at 
Python/ceval.c:2741
#10 0xb7d0d6be in function_call (func=0xb6b0902c, arg=0xb6b892ac, 
kw=0x0) at Objects/funcobject.c:548
#11 0xb7c65967 in PyObject_Call (func=0x0, arg=0xfffffffc, 
kw=0xfffffffc) at Objects/abstract.c:1795
#12 0xb7c6e389 in instancemethod_call (func=0xfffffffc, arg=0xb6b892ac, 
kw=0xfffffffc)
    at Objects/classobject.c:2532
#13 0xb7c65967 in PyObject_Call (func=0x0, arg=0xfffffffc, 
kw=0xfffffffc) at Objects/abstract.c:1795
#14 0xb7c99728 in slot_tp_init (self=0xb6af1fac, args=0xfffffffc, 
kwds=0xfffffffc)
    at Objects/typeobject.c:4774
#15 0xb7c91ad4 in type_call (type=0xb7c99675, args=0xb7b9102c, kwds=0x0) 
at Objects/typeobject.c:435
#16 0xb7c65967 in PyObject_Call (func=0x0, arg=0xfffffffc, 
kw=0xfffffffc) at Objects/abstract.c:1795
#17 0xb7cba239 in PyEval_EvalFrame (f=0x820f224) at Python/ceval.c:3776
#18 0xb7cbd0eb in PyEval_EvalFrame (f=0x8195854) at Python/ceval.c:3651
#19 0xb7cbd0eb in PyEval_EvalFrame (f=0x81c9ac4) at Python/ceval.c:3651
#20 0xb7cbd719 in PyEval_EvalCodeEx (co=0xb6b87e20, globals=0xfffffffc, 
locals=0x0, args=0x7, argcount=0,
    kws=0x8282440, kwcount=7, defs=0x0, defcount=0, closure=0x0) at 
Python/ceval.c:2741
#21 0xb7cbb46a in PyEval_EvalFrame (f=0x82822a4) at Python/ceval.c:3660
#22 0xb7cbd719 in PyEval_EvalCodeEx (co=0xb6b87ee0, globals=0xfffffffc, 
locals=0x0, args=0x0, argcount=2,
    kws=0x0, kwcount=0, defs=0x0, defcount=0, closure=0x0) at 
Python/ceval.c:2741
#23 0xb7d0d6be in function_call (func=0xb6af3a74, arg=0xb6b7c78c, 
kw=0x0) at Objects/funcobject.c:548
#24 0xb7c65967 in PyObject_Call (func=0x0, arg=0xfffffffc, 
kw=0xfffffffc) at Objects/abstract.c:1795
#25 0xb7c6e389 in instancemethod_call (func=0xfffffffc, arg=0xb6b7c78c, 
kw=0xfffffffc)
    at Objects/classobject.c:2532
#26 0xb7c65bf6 in PyObject_CallMethod (o=0x0, name=0xb6b891ec "\001", 
format=0xb6b891ec "\001")
    at Objects/abstract.c:1795
#27 0xb7c5f505 in python_handler (req=0x828a7b8, phase=0xb7d16e59 
"PythonHandler") at mod_python.c:1652
#28 0x08073daf in ap_run_handler (r=0x828a7b8) at config.c:157
#29 0x080741b1 in ap_invoke_handler (r=0x828a7b8) at config.c:372
---Type <return> to continue, or q <return> to quit---
#30 0x0808ba77 in ap_process_request (r=0x828a7b8) at http_request.c:258
#31 0x0808929b in ap_process_http_connection (c=0x8185638) at 
http_core.c:184
#32 0x0807a599 in ap_run_process_connection (c=0x8185638) at connection.c:43
#33 0x0809e55a in child_main (child_num_arg=-4) at prefork.c:640
#34 0x0809e7a8 in make_child (s=0x80c9c80, slot=0) at prefork.c:680
#35 0x0809ee53 in ap_mpm_run (_pconf=0xbf86d6f0, plog=0x81031a0, 
s=0xbf86d6f4) at prefork.c:956
#36 0x080622c8 in main (argc=2, argv=0xbf86d8b4) at main.c:717
(gdb)



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070410/530f317c/attachment.html
From graham.dumpleton at gmail.com  Tue Apr 10 21:00:29 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Apr 10 21:00:35 2007
Subject: [mod_python] Global Interpreter Lock problem with Berkeley DB XML
	and mod_python
In-Reply-To: <461C1968.3080103@bittorrent.com>
References: <461C1968.3080103@bittorrent.com>
Message-ID: <88e286470704101800h781d61f5ib7c1b4a58aba1ca@mail.gmail.com>

Try rebuilding dbxml but ensure that compiler option:

  -DSWIG_PYTHON_NO_USE_GIL

is used.

I don't know when SWIG changed, it certainly didn't generate these
PyGILState calls the last time I played with it, which wasn't that
long ago, but it isn't going to work under mod_python the way they now
do it as the default.

I'll have to look into this further when I get a chance as this new
behaviour of SWIG is going to cause all my Apache API SWIG bindings to
break. :-(

Graham

On 11/04/07, David Schachter <ds@bittorrent.com> wrote:
>
>  Folks--
>
>  I'm having a problem embedding Berkeley DB XML into Apache with mod_python.
> The first attempt to create an XmlManager causes a lockup in Python--the
> Global Interpreter Lock is deadlocked, I think. (Stack trace below.) Any
> ideas of how to debug? Is there a BDB XML Python expert? I checked Google
> without success.
>
>  The code to demonstrate the problem is simple and shown below. When the
> line "xmlManager = dbxml.XmlManager()" is commented out, the code runs ok.
> Commented in, Apache locks up.
>
>  The most recent mod_python has this comment at
> http://www.modpython.org/live/mod_python-3.3.1/doc-html/app-changes.html:
>
>
> Third party C modules that use the simplified API for the Global Interpreter
> Lock (GIL), as described in PEP 311, can now be used. The only requirement
> is that such modules can only be used in the context of the
> "main_interpreter". (More info at
> http://issues.apache.org/jira/browse/MODPYTHON-77.)
>  The documentation for mod_python at
> http://www.modpython.org/live/current/doc-html/pyapi-interps.html
> says:
>
>
> Note that if any third party module is being used which has a C code
> component that uses the simplified API for access to the Global Interpreter
> Lock (GIL) for Python extension modules, then the interpreter name must be
> forcibly set to be "main_interpreter". This is necessary as such a module
> will only work correctly if run within the context of the first Python
> interpreter created by the process.
>  Conforming to this, I set the interpreter name in the httpd.conf file using
> the directive "PythonInterpreter main_interpreter" and I verified this by
> printing the interpreter name from my Python code.
>
>  In dbxml-2.3.10/dbxml/src/python, there's some code relating to the GIL in
> dbxml_python_wrap.cpp. If someone else has already beaten this problem into
> submission, I'd rather not duplicate the effort.
>
>                           -- David Schachter
>
>  #! /usr/bin/python
>
>  import dbxml
>  from mod_python import apache
>  import os
>
>
>  def handler(req):
>    id = "pid %d, interpreter '%s'" % (os.getpid(), req.interpreter)
>
>    apache.log_error("About to start BDB XML from %s." % id)
>    xmlManager = dbxml.XmlManager()
>    apache.log_error("Started BDB XML.")
>
>    req.write("Hi from %s." % id)
>    return apache.OK
>
>
>  STACK TRACE IS:
>
>  (gdb) bt
>  #0  0xffffe410 in __kernel_vsyscall ()
>  #1  0xb7e97af0 in sem_wait@GLIBC_2.0 () from
> /lib/tls/i686/cmov/libpthread.so.0
>  #2  0x00000004 in ?? ()
>  #3  0xb7ce7a00 in PyThread_acquire_lock (lock=0x0, waitflag=1) at
> thread_pthread.h:298
>  #4  0xb7cb5689 in PyEval_RestoreThread (tstate=0x810f888) at
> Python/ceval.c:305
>  #5  0xb7ce16e7 in PyGILState_Ensure () at Python/pystate.c:512
>  #6  0xb78282f9 in _wrap_new_XmlManager (self=0x0, args=0xb7b9102c) at
> dbxml_python_wrap.cpp:898
>       (The reference to line 898 is correct but surprising, the result of a
> macro expansion at line 4195. --D.S.)
>  #7  0xb7c65967 in PyObject_Call (func=0x0, arg=0xfffffffc, kw=0xfffffffc)
> at Objects/abstract.c:1795
>  #8  0xb7cb9e1d in PyEval_EvalFrame (f=0x822cdbc) at Python/ceval.c:3845
>  #9  0xb7cbd719 in PyEval_EvalCodeEx (co=0xb6b12e20, globals=0xfffffffc,
> locals=0x0, args=0x0, argcount=1,
>      kws=0x0, kwcount=0, defs=0x0, defcount=0, closure=0x0) at
> Python/ceval.c:2741
>  #10 0xb7d0d6be in function_call (func=0xb6b0902c, arg=0xb6b892ac, kw=0x0)
> at Objects/funcobject.c:548
>  #11 0xb7c65967 in PyObject_Call (func=0x0, arg=0xfffffffc, kw=0xfffffffc)
> at Objects/abstract.c:1795
>  #12 0xb7c6e389 in instancemethod_call (func=0xfffffffc, arg=0xb6b892ac,
> kw=0xfffffffc)
>      at Objects/classobject.c:2532
>  #13 0xb7c65967 in PyObject_Call (func=0x0, arg=0xfffffffc, kw=0xfffffffc)
> at Objects/abstract.c:1795
>  #14 0xb7c99728 in slot_tp_init (self=0xb6af1fac, args=0xfffffffc,
> kwds=0xfffffffc)
>      at Objects/typeobject.c:4774
>  #15 0xb7c91ad4 in type_call (type=0xb7c99675, args=0xb7b9102c, kwds=0x0) at
> Objects/typeobject.c:435
>  #16 0xb7c65967 in PyObject_Call (func=0x0, arg=0xfffffffc, kw=0xfffffffc)
> at Objects/abstract.c:1795
>  #17 0xb7cba239 in PyEval_EvalFrame (f=0x820f224) at Python/ceval.c:3776
>  #18 0xb7cbd0eb in PyEval_EvalFrame (f=0x8195854) at Python/ceval.c:3651
>  #19 0xb7cbd0eb in PyEval_EvalFrame (f=0x81c9ac4) at Python/ceval.c:3651
>  #20 0xb7cbd719 in PyEval_EvalCodeEx (co=0xb6b87e20, globals=0xfffffffc,
> locals=0x0, args=0x7, argcount=0,
>      kws=0x8282440, kwcount=7, defs=0x0, defcount=0, closure=0x0) at
> Python/ceval.c:2741
>  #21 0xb7cbb46a in PyEval_EvalFrame (f=0x82822a4) at Python/ceval.c:3660
>  #22 0xb7cbd719 in PyEval_EvalCodeEx (co=0xb6b87ee0, globals=0xfffffffc,
> locals=0x0, args=0x0, argcount=2,
>      kws=0x0, kwcount=0, defs=0x0, defcount=0, closure=0x0) at
> Python/ceval.c:2741
>  #23 0xb7d0d6be in function_call (func=0xb6af3a74, arg=0xb6b7c78c, kw=0x0)
> at Objects/funcobject.c:548
>  #24 0xb7c65967 in PyObject_Call (func=0x0, arg=0xfffffffc, kw=0xfffffffc)
> at Objects/abstract.c:1795
>  #25 0xb7c6e389 in instancemethod_call (func=0xfffffffc, arg=0xb6b7c78c,
> kw=0xfffffffc)
>      at Objects/classobject.c:2532
>  #26 0xb7c65bf6 in PyObject_CallMethod (o=0x0, name=0xb6b891ec "\001",
> format=0xb6b891ec "\001")
>      at Objects/abstract.c:1795
>  #27 0xb7c5f505 in python_handler (req=0x828a7b8, phase=0xb7d16e59
> "PythonHandler") at mod_python.c:1652
>  #28 0x08073daf in ap_run_handler (r=0x828a7b8) at config.c:157
>  #29 0x080741b1 in ap_invoke_handler (r=0x828a7b8) at config.c:372
>  ---Type <return> to continue, or q <return> to quit---
>  #30 0x0808ba77 in ap_process_request (r=0x828a7b8) at http_request.c:258
>  #31 0x0808929b in ap_process_http_connection (c=0x8185638) at
> http_core.c:184
>  #32 0x0807a599 in ap_run_process_connection (c=0x8185638) at
> connection.c:43
>  #33 0x0809e55a in child_main (child_num_arg=-4) at prefork.c:640
>  #34 0x0809e7a8 in make_child (s=0x80c9c80, slot=0) at prefork.c:680
>  #35 0x0809ee53 in ap_mpm_run (_pconf=0xbf86d6f0, plog=0x81031a0,
> s=0xbf86d6f4) at prefork.c:956
>  #36 0x080622c8 in main (argc=2, argv=0xbf86d8b4) at main.c:717
>  (gdb)
>
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
From graham.dumpleton at gmail.com  Tue Apr 10 21:12:44 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Apr 10 21:12:47 2007
Subject: [mod_python] Global Interpreter Lock problem with Berkeley DB XML
	and mod_python
In-Reply-To: <88e286470704101800h781d61f5ib7c1b4a58aba1ca@mail.gmail.com>
References: <461C1968.3080103@bittorrent.com>
	<88e286470704101800h781d61f5ib7c1b4a58aba1ca@mail.gmail.com>
Message-ID: <88e286470704101812ha6cf5b1t9cf17175c0c160a0@mail.gmail.com>

Looking a bit further, the GIL macros are in my own stuff, but I
suspect it doesn't get enabled because I don't use the -threads option
to SWIG. I don't understand the consequences of the option, but
changing:

  dbxml/dist/s_swig

so that '-threads' isn't in swig_args for Python would probably get
rid of the stuff.

Would need to work out why they use the option in the first place as
turning it off could break things if dbxml is dependent on it in some
way.

Graham

On 11/04/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> Try rebuilding dbxml but ensure that compiler option:
>
>   -DSWIG_PYTHON_NO_USE_GIL
>
> is used.
>
> I don't know when SWIG changed, it certainly didn't generate these
> PyGILState calls the last time I played with it, which wasn't that
> long ago, but it isn't going to work under mod_python the way they now
> do it as the default.
>
> I'll have to look into this further when I get a chance as this new
> behaviour of SWIG is going to cause all my Apache API SWIG bindings to
> break. :-(
>
> Graham
>
> On 11/04/07, David Schachter <ds@bittorrent.com> wrote:
> >
> >  Folks--
> >
> >  I'm having a problem embedding Berkeley DB XML into Apache with mod_python.
> > The first attempt to create an XmlManager causes a lockup in Python--the
> > Global Interpreter Lock is deadlocked, I think. (Stack trace below.) Any
> > ideas of how to debug? Is there a BDB XML Python expert? I checked Google
> > without success.
> >
> >  The code to demonstrate the problem is simple and shown below. When the
> > line "xmlManager = dbxml.XmlManager()" is commented out, the code runs ok.
> > Commented in, Apache locks up.
> >
> >  The most recent mod_python has this comment at
> > http://www.modpython.org/live/mod_python-3.3.1/doc-html/app-changes.html:
> >
> >
> > Third party C modules that use the simplified API for the Global Interpreter
> > Lock (GIL), as described in PEP 311, can now be used. The only requirement
> > is that such modules can only be used in the context of the
> > "main_interpreter". (More info at
> > http://issues.apache.org/jira/browse/MODPYTHON-77.)
> >  The documentation for mod_python at
> > http://www.modpython.org/live/current/doc-html/pyapi-interps.html
> > says:
> >
> >
> > Note that if any third party module is being used which has a C code
> > component that uses the simplified API for access to the Global Interpreter
> > Lock (GIL) for Python extension modules, then the interpreter name must be
> > forcibly set to be "main_interpreter". This is necessary as such a module
> > will only work correctly if run within the context of the first Python
> > interpreter created by the process.
> >  Conforming to this, I set the interpreter name in the httpd.conf file using
> > the directive "PythonInterpreter main_interpreter" and I verified this by
> > printing the interpreter name from my Python code.
> >
> >  In dbxml-2.3.10/dbxml/src/python, there's some code relating to the GIL in
> > dbxml_python_wrap.cpp. If someone else has already beaten this problem into
> > submission, I'd rather not duplicate the effort.
> >
> >                           -- David Schachter
> >
> >  #! /usr/bin/python
> >
> >  import dbxml
> >  from mod_python import apache
> >  import os
> >
> >
> >  def handler(req):
> >    id = "pid %d, interpreter '%s'" % (os.getpid(), req.interpreter)
> >
> >    apache.log_error("About to start BDB XML from %s." % id)
> >    xmlManager = dbxml.XmlManager()
> >    apache.log_error("Started BDB XML.")
> >
> >    req.write("Hi from %s." % id)
> >    return apache.OK
> >
> >
> >  STACK TRACE IS:
> >
> >  (gdb) bt
> >  #0  0xffffe410 in __kernel_vsyscall ()
> >  #1  0xb7e97af0 in sem_wait@GLIBC_2.0 () from
> > /lib/tls/i686/cmov/libpthread.so.0
> >  #2  0x00000004 in ?? ()
> >  #3  0xb7ce7a00 in PyThread_acquire_lock (lock=0x0, waitflag=1) at
> > thread_pthread.h:298
> >  #4  0xb7cb5689 in PyEval_RestoreThread (tstate=0x810f888) at
> > Python/ceval.c:305
> >  #5  0xb7ce16e7 in PyGILState_Ensure () at Python/pystate.c:512
> >  #6  0xb78282f9 in _wrap_new_XmlManager (self=0x0, args=0xb7b9102c) at
> > dbxml_python_wrap.cpp:898
> >       (The reference to line 898 is correct but surprising, the result of a
> > macro expansion at line 4195. --D.S.)
> >  #7  0xb7c65967 in PyObject_Call (func=0x0, arg=0xfffffffc, kw=0xfffffffc)
> > at Objects/abstract.c:1795
> >  #8  0xb7cb9e1d in PyEval_EvalFrame (f=0x822cdbc) at Python/ceval.c:3845
> >  #9  0xb7cbd719 in PyEval_EvalCodeEx (co=0xb6b12e20, globals=0xfffffffc,
> > locals=0x0, args=0x0, argcount=1,
> >      kws=0x0, kwcount=0, defs=0x0, defcount=0, closure=0x0) at
> > Python/ceval.c:2741
> >  #10 0xb7d0d6be in function_call (func=0xb6b0902c, arg=0xb6b892ac, kw=0x0)
> > at Objects/funcobject.c:548
> >  #11 0xb7c65967 in PyObject_Call (func=0x0, arg=0xfffffffc, kw=0xfffffffc)
> > at Objects/abstract.c:1795
> >  #12 0xb7c6e389 in instancemethod_call (func=0xfffffffc, arg=0xb6b892ac,
> > kw=0xfffffffc)
> >      at Objects/classobject.c:2532
> >  #13 0xb7c65967 in PyObject_Call (func=0x0, arg=0xfffffffc, kw=0xfffffffc)
> > at Objects/abstract.c:1795
> >  #14 0xb7c99728 in slot_tp_init (self=0xb6af1fac, args=0xfffffffc,
> > kwds=0xfffffffc)
> >      at Objects/typeobject.c:4774
> >  #15 0xb7c91ad4 in type_call (type=0xb7c99675, args=0xb7b9102c, kwds=0x0) at
> > Objects/typeobject.c:435
> >  #16 0xb7c65967 in PyObject_Call (func=0x0, arg=0xfffffffc, kw=0xfffffffc)
> > at Objects/abstract.c:1795
> >  #17 0xb7cba239 in PyEval_EvalFrame (f=0x820f224) at Python/ceval.c:3776
> >  #18 0xb7cbd0eb in PyEval_EvalFrame (f=0x8195854) at Python/ceval.c:3651
> >  #19 0xb7cbd0eb in PyEval_EvalFrame (f=0x81c9ac4) at Python/ceval.c:3651
> >  #20 0xb7cbd719 in PyEval_EvalCodeEx (co=0xb6b87e20, globals=0xfffffffc,
> > locals=0x0, args=0x7, argcount=0,
> >      kws=0x8282440, kwcount=7, defs=0x0, defcount=0, closure=0x0) at
> > Python/ceval.c:2741
> >  #21 0xb7cbb46a in PyEval_EvalFrame (f=0x82822a4) at Python/ceval.c:3660
> >  #22 0xb7cbd719 in PyEval_EvalCodeEx (co=0xb6b87ee0, globals=0xfffffffc,
> > locals=0x0, args=0x0, argcount=2,
> >      kws=0x0, kwcount=0, defs=0x0, defcount=0, closure=0x0) at
> > Python/ceval.c:2741
> >  #23 0xb7d0d6be in function_call (func=0xb6af3a74, arg=0xb6b7c78c, kw=0x0)
> > at Objects/funcobject.c:548
> >  #24 0xb7c65967 in PyObject_Call (func=0x0, arg=0xfffffffc, kw=0xfffffffc)
> > at Objects/abstract.c:1795
> >  #25 0xb7c6e389 in instancemethod_call (func=0xfffffffc, arg=0xb6b7c78c,
> > kw=0xfffffffc)
> >      at Objects/classobject.c:2532
> >  #26 0xb7c65bf6 in PyObject_CallMethod (o=0x0, name=0xb6b891ec "\001",
> > format=0xb6b891ec "\001")
> >      at Objects/abstract.c:1795
> >  #27 0xb7c5f505 in python_handler (req=0x828a7b8, phase=0xb7d16e59
> > "PythonHandler") at mod_python.c:1652
> >  #28 0x08073daf in ap_run_handler (r=0x828a7b8) at config.c:157
> >  #29 0x080741b1 in ap_invoke_handler (r=0x828a7b8) at config.c:372
> >  ---Type <return> to continue, or q <return> to quit---
> >  #30 0x0808ba77 in ap_process_request (r=0x828a7b8) at http_request.c:258
> >  #31 0x0808929b in ap_process_http_connection (c=0x8185638) at
> > http_core.c:184
> >  #32 0x0807a599 in ap_run_process_connection (c=0x8185638) at
> > connection.c:43
> >  #33 0x0809e55a in child_main (child_num_arg=-4) at prefork.c:640
> >  #34 0x0809e7a8 in make_child (s=0x80c9c80, slot=0) at prefork.c:680
> >  #35 0x0809ee53 in ap_mpm_run (_pconf=0xbf86d6f0, plog=0x81031a0,
> > s=0xbf86d6f4) at prefork.c:956
> >  #36 0x080622c8 in main (argc=2, argv=0xbf86d8b4) at main.c:717
> >  (gdb)
> >
> >
> >
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> >
>
From graham.dumpleton at gmail.com  Tue Apr 10 23:06:37 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Apr 10 23:06:41 2007
Subject: [mod_python] Global Interpreter Lock problem with Berkeley DB XML
	and mod_python
In-Reply-To: <461C4396.8080807@bittorrent.com>
References: <461C1968.3080103@bittorrent.com>
	<88e286470704101800h781d61f5ib7c1b4a58aba1ca@mail.gmail.com>
	<88e286470704101812ha6cf5b1t9cf17175c0c160a0@mail.gmail.com>
	<461C4396.8080807@bittorrent.com>
Message-ID: <88e286470704102006q594b7745u4ba31c834ec22f17@mail.gmail.com>

On 11/04/07, David Schachter <ds@bittorrent.com> wrote:
> Graham--
>
> Thanks for the tip. I re-swigged the Python code and BDB XML no longer
> locks up at first blush. (Out of context, the previous sentence makes
> little sense.) I haven't done any testing beyond that yet. Thank you for
> getting jiggy with my swiggy.
>
> George--
>
> Is this something for the next 2.3.x release?
>
>                       -- David Schachter

FWIW, am not sure why the -threads option is used as I can't see that
it would be required when the package is used exclusively from Python
code. The only time one would potentially need the GIL wrappers that
SWIG puts in there is when some C code which doesn't currently have
the Python GIL held or an active thread state makes a call to one of
the generated SWIG wrapper functions.

Unless the dbxml package has been specially designed to be used in
embedded systems where C code is calling out of C code into
dbxml/Python code and the calling C code hasn't performed any prior
Python initialisation steps, this is unlikely to occur. Only other
possibility is that dbxml specifically has sections where it releases
the GIL but then wants to be able to perform a callback into Python
code, but I can't see any instances of Py_BEGIN_ALLOW_THREADS and
Py_END_ALLOW_THREADS being used in the code.

The reason the GIL wrappers cause a problem for mod_python is that
mod_python has already correctly acquired the GIL and created an
active thread state, but such thread states are not registered with
Python's simplified GIL API system because one is not meant to use the
Python simplified GIL API system when multiple Python sub interpreters
are used for various reasons. It says as much in the Python code and
also I think the documentation.

Not sure how much joy you will get with getting dbxml changed. Really
need to find out exactly why dbxml authors think the -threads option
is required.

Graham

> Graham Dumpleton wrote:
> > Looking a bit further, the GIL macros are in my own stuff, but I
> > suspect it doesn't get enabled because I don't use the -threads option
> > to SWIG. I don't understand the consequences of the option, but
> > changing:
> >
> >  dbxml/dist/s_swig
> >
> > so that '-threads' isn't in swig_args for Python would probably get
> > rid of the stuff.
> >
> > Would need to work out why they use the option in the first place as
> > turning it off could break things if dbxml is dependent on it in some
> > way.
> >
> > Graham
> >
> > On 11/04/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> >> Try rebuilding dbxml but ensure that compiler option:
> >>
> >>   -DSWIG_PYTHON_NO_USE_GIL
> >>
> >> is used.
> >>
> >> I don't know when SWIG changed, it certainly didn't generate these
> >> PyGILState calls the last time I played with it, which wasn't that
> >> long ago, but it isn't going to work under mod_python the way they now
> >> do it as the default.
> >>
> >> I'll have to look into this further when I get a chance as this new
> >> behaviour of SWIG is going to cause all my Apache API SWIG bindings to
> >> break. :-(
> >>
> >> Graham
> >>
> >> On 11/04/07, David Schachter <ds@bittorrent.com> wrote:
> >> >
> >> >  Folks--
> >> >
> >> >  I'm having a problem embedding Berkeley DB XML into Apache with
> >> mod_python.
> >> > The first attempt to create an XmlManager causes a lockup in
> >> Python--the
> >> > Global Interpreter Lock is deadlocked, I think. (Stack trace
> >> below.) Any
> >> > ideas of how to debug? Is there a BDB XML Python expert? I checked
> >> Google
> >> > without success.
> >> >
> >> >  The code to demonstrate the problem is simple and shown below.
> >> When the
> >> > line "xmlManager = dbxml.XmlManager()" is commented out, the code
> >> runs ok.
> >> > Commented in, Apache locks up.
> >> >
> >> >  The most recent mod_python has this comment at
> >> >
> >> http://www.modpython.org/live/mod_python-3.3.1/doc-html/app-changes.html:
> >>
> >> >
> >> >
> >> > Third party C modules that use the simplified API for the Global
> >> Interpreter
> >> > Lock (GIL), as described in PEP 311, can now be used. The only
> >> requirement
> >> > is that such modules can only be used in the context of the
> >> > "main_interpreter". (More info at
> >> > http://issues.apache.org/jira/browse/MODPYTHON-77.)
> >> >  The documentation for mod_python at
> >> > http://www.modpython.org/live/current/doc-html/pyapi-interps.html
> >> > says:
> >> >
> >> >
> >> > Note that if any third party module is being used which has a C code
> >> > component that uses the simplified API for access to the Global
> >> Interpreter
> >> > Lock (GIL) for Python extension modules, then the interpreter name
> >> must be
> >> > forcibly set to be "main_interpreter". This is necessary as such a
> >> module
> >> > will only work correctly if run within the context of the first Python
> >> > interpreter created by the process.
> >> >  Conforming to this, I set the interpreter name in the httpd.conf
> >> file using
> >> > the directive "PythonInterpreter main_interpreter" and I verified
> >> this by
> >> > printing the interpreter name from my Python code.
> >> >
> >> >  In dbxml-2.3.10/dbxml/src/python, there's some code relating to
> >> the GIL in
> >> > dbxml_python_wrap.cpp. If someone else has already beaten this
> >> problem into
> >> > submission, I'd rather not duplicate the effort.
> >> >
> >> >                           -- David Schachter
> >> >
> >> >  #! /usr/bin/python
> >> >
> >> >  import dbxml
> >> >  from mod_python import apache
> >> >  import os
> >> >
> >> >
> >> >  def handler(req):
> >> >    id = "pid %d, interpreter '%s'" % (os.getpid(), req.interpreter)
> >> >
> >> >    apache.log_error("About to start BDB XML from %s." % id)
> >> >    xmlManager = dbxml.XmlManager()
> >> >    apache.log_error("Started BDB XML.")
> >> >
> >> >    req.write("Hi from %s." % id)
> >> >    return apache.OK
> >> >
> >> >
> >> >  STACK TRACE IS:
> >> >
> >> >  (gdb) bt
> >> >  #0  0xffffe410 in __kernel_vsyscall ()
> >> >  #1  0xb7e97af0 in sem_wait@GLIBC_2.0 () from
> >> > /lib/tls/i686/cmov/libpthread.so.0
> >> >  #2  0x00000004 in ?? ()
> >> >  #3  0xb7ce7a00 in PyThread_acquire_lock (lock=0x0, waitflag=1) at
> >> > thread_pthread.h:298
> >> >  #4  0xb7cb5689 in PyEval_RestoreThread (tstate=0x810f888) at
> >> > Python/ceval.c:305
> >> >  #5  0xb7ce16e7 in PyGILState_Ensure () at Python/pystate.c:512
> >> >  #6  0xb78282f9 in _wrap_new_XmlManager (self=0x0, args=0xb7b9102c) at
> >> > dbxml_python_wrap.cpp:898
> >> >       (The reference to line 898 is correct but surprising, the
> >> result of a
> >> > macro expansion at line 4195. --D.S.)
> >> >  #7  0xb7c65967 in PyObject_Call (func=0x0, arg=0xfffffffc,
> >> kw=0xfffffffc)
> >> > at Objects/abstract.c:1795
> >> >  #8  0xb7cb9e1d in PyEval_EvalFrame (f=0x822cdbc) at
> >> Python/ceval.c:3845
> >> >  #9  0xb7cbd719 in PyEval_EvalCodeEx (co=0xb6b12e20,
> >> globals=0xfffffffc,
> >> > locals=0x0, args=0x0, argcount=1,
> >> >      kws=0x0, kwcount=0, defs=0x0, defcount=0, closure=0x0) at
> >> > Python/ceval.c:2741
> >> >  #10 0xb7d0d6be in function_call (func=0xb6b0902c, arg=0xb6b892ac,
> >> kw=0x0)
> >> > at Objects/funcobject.c:548
> >> >  #11 0xb7c65967 in PyObject_Call (func=0x0, arg=0xfffffffc,
> >> kw=0xfffffffc)
> >> > at Objects/abstract.c:1795
> >> >  #12 0xb7c6e389 in instancemethod_call (func=0xfffffffc,
> >> arg=0xb6b892ac,
> >> > kw=0xfffffffc)
> >> >      at Objects/classobject.c:2532
> >> >  #13 0xb7c65967 in PyObject_Call (func=0x0, arg=0xfffffffc,
> >> kw=0xfffffffc)
> >> > at Objects/abstract.c:1795
> >> >  #14 0xb7c99728 in slot_tp_init (self=0xb6af1fac, args=0xfffffffc,
> >> > kwds=0xfffffffc)
> >> >      at Objects/typeobject.c:4774
> >> >  #15 0xb7c91ad4 in type_call (type=0xb7c99675, args=0xb7b9102c,
> >> kwds=0x0) at
> >> > Objects/typeobject.c:435
> >> >  #16 0xb7c65967 in PyObject_Call (func=0x0, arg=0xfffffffc,
> >> kw=0xfffffffc)
> >> > at Objects/abstract.c:1795
> >> >  #17 0xb7cba239 in PyEval_EvalFrame (f=0x820f224) at
> >> Python/ceval.c:3776
> >> >  #18 0xb7cbd0eb in PyEval_EvalFrame (f=0x8195854) at
> >> Python/ceval.c:3651
> >> >  #19 0xb7cbd0eb in PyEval_EvalFrame (f=0x81c9ac4) at
> >> Python/ceval.c:3651
> >> >  #20 0xb7cbd719 in PyEval_EvalCodeEx (co=0xb6b87e20,
> >> globals=0xfffffffc,
> >> > locals=0x0, args=0x7, argcount=0,
> >> >      kws=0x8282440, kwcount=7, defs=0x0, defcount=0, closure=0x0) at
> >> > Python/ceval.c:2741
> >> >  #21 0xb7cbb46a in PyEval_EvalFrame (f=0x82822a4) at
> >> Python/ceval.c:3660
> >> >  #22 0xb7cbd719 in PyEval_EvalCodeEx (co=0xb6b87ee0,
> >> globals=0xfffffffc,
> >> > locals=0x0, args=0x0, argcount=2,
> >> >      kws=0x0, kwcount=0, defs=0x0, defcount=0, closure=0x0) at
> >> > Python/ceval.c:2741
> >> >  #23 0xb7d0d6be in function_call (func=0xb6af3a74, arg=0xb6b7c78c,
> >> kw=0x0)
> >> > at Objects/funcobject.c:548
> >> >  #24 0xb7c65967 in PyObject_Call (func=0x0, arg=0xfffffffc,
> >> kw=0xfffffffc)
> >> > at Objects/abstract.c:1795
> >> >  #25 0xb7c6e389 in instancemethod_call (func=0xfffffffc,
> >> arg=0xb6b7c78c,
> >> > kw=0xfffffffc)
> >> >      at Objects/classobject.c:2532
> >> >  #26 0xb7c65bf6 in PyObject_CallMethod (o=0x0, name=0xb6b891ec "\001",
> >> > format=0xb6b891ec "\001")
> >> >      at Objects/abstract.c:1795
> >> >  #27 0xb7c5f505 in python_handler (req=0x828a7b8, phase=0xb7d16e59
> >> > "PythonHandler") at mod_python.c:1652
> >> >  #28 0x08073daf in ap_run_handler (r=0x828a7b8) at config.c:157
> >> >  #29 0x080741b1 in ap_invoke_handler (r=0x828a7b8) at config.c:372
> >> >  ---Type <return> to continue, or q <return> to quit---
> >> >  #30 0x0808ba77 in ap_process_request (r=0x828a7b8) at
> >> http_request.c:258
> >> >  #31 0x0808929b in ap_process_http_connection (c=0x8185638) at
> >> > http_core.c:184
> >> >  #32 0x0807a599 in ap_run_process_connection (c=0x8185638) at
> >> > connection.c:43
> >> >  #33 0x0809e55a in child_main (child_num_arg=-4) at prefork.c:640
> >> >  #34 0x0809e7a8 in make_child (s=0x80c9c80, slot=0) at prefork.c:680
> >> >  #35 0x0809ee53 in ap_mpm_run (_pconf=0xbf86d6f0, plog=0x81031a0,
> >> > s=0xbf86d6f4) at prefork.c:956
> >> >  #36 0x080622c8 in main (argc=2, argv=0xbf86d8b4) at main.c:717
> >> >  (gdb)
> >> >
> >> >
> >> >
> >> >
> >> > _______________________________________________
> >> > Mod_python mailing list
> >> > Mod_python@modpython.org
> >> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >> >
> >> >
> >>
> >
>
>
From phillscot at mac.com  Wed Apr 11 05:06:24 2007
From: phillscot at mac.com (Philippe Schottey)
Date: Wed Apr 11 05:09:41 2007
Subject: [mod_python] cgi handler
In-Reply-To: <88e286470704082038k13f8e7b6h3e98bdaa59e62262@mail.gmail.com>
References: <775B0CD3-FC05-4ABD-B2F9-45A41E8ABD1E@mac.com>
	<88e286470704081852j266d49d4r748b68b70ec01900@mail.gmail.com>
	<1C97D56F-2B3C-49C3-9A9B-7BA4E036A8E0@mac.com>
	<88e286470704082038k13f8e7b6h3e98bdaa59e62262@mail.gmail.com>
Message-ID: <2416D9BB-713E-46A7-8323-8A91A0760C9F@mac.com>

Hmm indeed, I was wrong...
On the hosting server the code seems to work fine.
On my machine (mac) however it does not work.
Maybe it is a configuration problem?

So I have:
python 2.4.3
apache 2.2.4.0
mod_python 3.3.1.0

The httpd config is:
#
# Additional files to server.
Alias /pschotte /Users/pschotte/Sites

#
# Activate python in the needed directories.
<Directory /Users/pschotte/Sites>
     # Give access.
     Order allow,deny
     Allow from all
     # Activate python.
     AddHandler mod_python .py
     PythonHandler mod_python.cgihandler
     PythonDebug On
</Directory>



On 09 Apr 2007, at 05:38, Graham Dumpleton wrote:

> Code works fine for me on mod_python 3.3.1, Python 2.3.5 and Apache  
> 2.2.1.
>
> Thus, nothing wrong with the code itself.
>
> Can you be more precise about which version of mod_python they are  
> using?
>
> On 09/04/07, Philippe Schottey <phillscot@mac.com> wrote:
>> Indeed, only the cgi_handler is configured.
>> Versions:
>> python 2.3
>> apache 2
>> mod_python 3.*
>>
>> The (test) script I have is:
>>
>> from mod_python import apache
>> import cgi
>>
>> form = cgi.FieldStorage()
>>
>> print """Content-type: text/html
>>
>> <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
>> <html>
>>     <head>
>>         <title>test</title>
>>     </head>
>>     <body>
>>         """
>> print form.has_key('action')
>> print """
>>     </body>
>> </html>"""
>>
>>
>>
>> On 09 Apr 2007, at 03:52, Graham Dumpleton wrote:
>>
>> On 09/04/07, Philippe Schottey <phillscot@mac.com> wrote:
>> Hello,
>>
>> This is the first time i'm using python and mod_python.
>> The hosting company only wants to use the cgi_handler.
>>
>> Can you confirm that what you mean is that the web hosting company is
>> only allowing you to use as the handler for mod_python:
>>
>>  PythonHandler mod_python.cgihandler
>>
>> Just want to confirm so that we know for sure that you aren't just
>> using standard CGI.
>>
>>
>> I have some problems retrieving POST and GET parameters.
>> I've read somewhere that this should do the trick:
>>
>> import cgi
>> form = cgi.FieldStorage()
>> value = form[key]
>>
>> Can you perhaps show a more complete script?
>>
>> Also, which version of mod_python is being used and which version  
>> of Python?
>>
>> Graham
>>
>>
>> When I'm trying this, the form object is allways empty.
>> The form code:
>>  <form name="main" action="test.py" method="POST">
>>  <input type="hidden" name="action" id="action" value="good"/>
>>             <input type="submit"/>
>>  </form>
>>
>> I can't seem to retrieve the action parameter.
>>

From indyone at gmail.com  Wed Apr 11 05:08:28 2007
From: indyone at gmail.com (indyone)
Date: Wed Apr 11 05:10:31 2007
Subject: [mod_python] Problems with inpufilter & mod_proxy
Message-ID: <461CA58C.1000906@gmail.com>

    Hi all,

I am trying to create a custom input filter and i'm facing some strange 
problems...

I am running:
Apache/2.0.59 (Win32)
mod_python/3.3.1
Python/2.4.3

I have this testing filter.py:

from mod_python import apache

def inputfilter(filter):
    apache.log_error('MyFilter: Requested %s' % filter.req.uri, 
apache.APLOG_NOTICE)
    filter.pass_on()
    apache.log_error('MyFilter: Exiting...', apache.APLOG_NOTICE)

The apache's conf has these:

LoadModule rewrite_module modules/mod_rewrite.so
LoadModule proxy_module modules/mod_proxy.so
LoadModule proxy_http_module modules/mod_proxy_http.so
LoadModule python_module modules/mod_python.so

PythonAutoReload On
PythonDebug On
PythonInputFilter filter MY_INPUT
SetInputFilter MY_INPUT

RewriteEngine On
RewriteRule ^/(.*) 
http://localhost:8080/VirtualHostBase/http/localhost:80/Plone/VirtualHostRoot/$1 
[L,P]

My problem is that when i'm calling the URL http://localhost the browser 
says 'Waiting for localhost' forever,
Apache is eating memory & CPU really fast, and in the error log i get 
these also forever...

[Wed Apr 11 11:15:18 2007] [notice] MyFilter: Requested /
[Wed Apr 11 11:15:18 2007] [notice] MyFilter: Exiting...
[Wed Apr 11 11:15:18 2007] [notice] MyFilter: Requested /
[Wed Apr 11 11:15:18 2007] [notice] MyFilter: Exiting...
[Wed Apr 11 11:15:18 2007] [notice] MyFilter: Requested /
[Wed Apr 11 11:15:18 2007] [notice] MyFilter: Exiting...
[Wed Apr 11 11:15:18 2007] [notice] MyFilter: Requested /
[Wed Apr 11 11:15:18 2007] [notice] MyFilter: Exiting...
....

Only way to stop this is killing apache.
If i comment-out the rewrite from the .conf and call http://localhost i 
get the default index.html and the filter works fine.
If i add a filter.close() like this (with the rewrite on again):

def inputfilter(filter):
    apache.log_error('MyFilter: Requested %s' % filter.req.uri, 
apache.APLOG_NOTICE)
    filter.pass_on()
    filter.close()
    apache.log_error('MyFilter: Exiting...', apache.APLOG_NOTICE)

The filter works fine in GET requests and i see properly the pages from 
the backend server (which is a Zope)...
but... when i POST a form i get this in the error_log:
[Wed Apr 11 11:55:12 2007] [notice] MyFilter: Requested /login_form
[Wed Apr 11 11:55:12 2007] [notice] MyFilter: Exiting...
[Wed Apr 11 12:00:12 2007] [error] [client 127.0.0.1] proxy: error 
reading status line from remote server localhost, referer: 
http://localhost/login_form
[Wed Apr 11 12:00:12 2007] [error] [client 127.0.0.1] proxy: Error 
reading from remote server returned by /login_form, referer: 
http://localhost/login_form
[Wed Apr 11 12:00:12 2007] [notice] MyFilter: Requested /login_form
[Wed Apr 11 12:00:12 2007] [notice] MyFilter: Exiting...
[Wed Apr 11 12:00:12 2007] [notice] MyFilter: Requested /login_form
[Wed Apr 11 12:00:12 2007] [notice] MyFilter: Exiting...
and yes, the backend server is still running...

I have also tried this code with the combinations:
    Apache/2.2 (Win32) mod_python/3.3.1 Python/2.4.3
    Apache/2.2 (Win32) mod_python/3.2.1 Python/2.4.3
and got the same results...

Please give any hint u come up... Thank u in advance.

Ioannis Stavrinos
From sebastien.maret at gmail.com  Wed Apr 11 11:17:16 2007
From: sebastien.maret at gmail.com (Sebastien Maret)
Date: Wed Apr 11 11:18:29 2007
Subject: [mod_python] Re: popen() and mod_python
References: <m2bqhyduy2.fsf@gmail.com> <461A692A.9060004@sebistar.net>
	<461A703F.9060106@joreybump.com>
Message-ID: <m2zm5fszyb.fsf@maretmaclt.astro.lsa.umich.edu>

Jorey Bump <list@joreybump.com> writes:

> Jon-Pierre Gentil wrote:
>> Sebastien Maret wrote:
>>
>>> import os
>>>
>>> def index(req):
>>>           p = os.popen ("/bin/sh", 'w')
>>>    p.write ("ls >> log")
>>>    p.close ()
>>>
>>>    f = open("log")
>>>    s = f.readlines()
>>>    f.close()
>>>
>>>    return s
>>>
>>> Although the same kind of script works fine when I run it from the
>>> command line, it does not work when I put it on my webserver. The pipe
>>> does not seems to be opened. Is it for security reasons? Is there a
>>> workaround?
>>
>>
>> It looks like you're returning the string instead of using req.write()
>> to output the data.  A request handler expects an HTTP code return
>> value, not the string output..
>
> That's not true of all handlers. The OP might be using Publisher,
> which only requires a string to be returned.

I do use the publisher. I should have mentioned that.

> Try using full paths to all binaries and files. The apache user is
> likely to have a very different environment than your normal user at
> the command line, and there's no guarantee that it won't change
> beneath your feet. Rule out all ambiguity.

That was it. The ls >> log command was trying to create a file in the
current directory, which turns out to be /. Using a full path for the
log file solved the problem.

> Also, you might want to try with something simpler, such as returning
> only the output of ls. In fact, I'm not sure I see the purpose of
> opening /bin/sh here, but maybe you have something else in mind other
> than this example, hopefully not evil. :)

This was just an example.

Thanks for the help.
S?bastien

From graham.dumpleton at gmail.com  Wed Apr 11 18:16:42 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Apr 11 18:16:51 2007
Subject: [mod_python] Global Interpreter Lock problem with Berkeley DB XML
	and mod_python
In-Reply-To: <3770C111-687D-4A51-AB0B-8C4DA3DB0C04@oracle.com>
References: <461C1968.3080103@bittorrent.com>
	<88e286470704101800h781d61f5ib7c1b4a58aba1ca@mail.gmail.com>
	<88e286470704101812ha6cf5b1t9cf17175c0c160a0@mail.gmail.com>
	<461C4396.8080807@bittorrent.com>
	<88e286470704102006q594b7745u4ba31c834ec22f17@mail.gmail.com>
	<3770C111-687D-4A51-AB0B-8C4DA3DB0C04@oracle.com>
Message-ID: <88e286470704111516y5b0a01c2mb8838b21bfe96444@mail.gmail.com>

Can you point me to the relevant files and sections of files where the
callback from C code where no GIL is held, is made into Python code.
If I can see how that is being done and understand it, may be able to
suggest something.

Graham

On 12/04/07, George Feinberg <george.feinberg@oracle.com> wrote:
>
> Graham,
>
> This is George Feinberg, and I am responsible for BDB XML development,
> and I happened to make the change to use -threads in SWIG generation.
>
> Perhaps you can help -- you seem to know more about it than I do.
> Here's
> the history:
>
> David's using release 2.3.10, where -threads was added.
> In release 2.2.13 (the previous one), it was not used, but there was
> a problem.
> Multi-threaded Python programs, they would deadlock themselves on
> a combination of BDB XML locking and the GIL.  One of the threads's
> stacks
> looked a bit like this:
>
> #6  0x080dd045 in PyThread_acquire_lock ()
> #7  0x080b1141 in PyEval_EvalFrame ()
> #8  0x080b726d in PyEval_EvalCodeEx ()
> #9  0x080b5719 in PyEval_EvalFrame ()
> #10 0x080b580c in PyEval_EvalFrame ()
> #11 0x080b726d in PyEval_EvalCodeEx ()
> #12 0x080fb6fd in PyFunction_SetClosure ()
> #13 0x0805950c in PyObject_Call ()
> #14 0x0805eac5 in PyMethod_New ()
> #15 0x0805950c in PyObject_Call ()
> #16 0x0808a965 in _PyType_Lookup ()
> #17 0x0808ca88 in _PyObject_SlotCompare ()
> #18 0x0805950c in PyObject_Call ()
> #19 0x080afed7 in PyEval_CallObjectWithKeywords ()
> #20 0x080594e3 in PyObject_CallObject ()
> #21 0xb7b0b360 in SWIG_Python_NewPointerObj (ptr=Variable "ptr" is not
> available.
> ) at dbxml_python_wrap.cpp:1266
> #22 0xb7b32df6 in _wrap_XmlManager_query__SWIG_3 (args=Variable
> "args" is not
> available.
> ) at dbxml_python_wrap.cpp:6675
> #23 0xb7b3332a in _wrap_XmlManager_query (self=0x0, args=0xb6baeb1c) at
>
> There was another thread involved, and it was blocked inside BDB XML
> waiting
> for a page lock held by the thread above.  Presumably it also held
> the lock
> (GIL) that caused this thread to block.
>
> So... I tried a bunch of things to fix this, but the fact that python
> 2.3 and 2.4 have
> different lock-related APIs and you crash in 2.3 if you use the wrong
> one didn't help.
> Turning on -threads, plus some other custom code did the trick.
>
> I'm perfectly happy with another solution if there is one.
> Eliminating Python 2.3
> support, or at least making it conditional it might help.
> Perhaps you have a suggestion.  I'm not a Python expert by any
> stretch of the imagination.
> I ended up here via hacking.
>
> There are a couple of things that I'm *trying* to accomplish in the
> module:
> 1.  release the GIL while in BDB XML to allow other threads to run in
> Python.
> 2.  the module uses SWIG Directors, so calls back into those (from C+
> +) need to
> reacquire the lock, or things go badly.
>
> What is the best way to do this?  Just eliminating -threads will
> cause things
> to appear to be working until they deadlock in the non-mod_python
> environment.   I'm guessing that using your
> active state threads may deadlock too, but I'm not certain.
>
> Thanks for any advice,
>
> George
>
> On Apr 10, 2007, at 11:06 PM, Graham Dumpleton wrote:
>
> > FWIW, am not sure why the -threads option is used as I can't see that
> > it would be required when the package is used exclusively from Python
> > code. The only time one would potentially need the GIL wrappers that
> > SWIG puts in there is when some C code which doesn't currently have
> > the Python GIL held or an active thread state makes a call to one of
> > the generated SWIG wrapper functions.
> >
> > Unless the dbxml package has been specially designed to be used in
> > embedded systems where C code is calling out of C code into
> > dbxml/Python code and the calling C code hasn't performed any prior
> > Python initialisation steps, this is unlikely to occur. Only other
> > possibility is that dbxml specifically has sections where it releases
> > the GIL but then wants to be able to perform a callback into Python
> > code, but I can't see any instances of Py_BEGIN_ALLOW_THREADS and
> > Py_END_ALLOW_THREADS being used in the code.
> >
> > The reason the GIL wrappers cause a problem for mod_python is that
> > mod_python has already correctly acquired the GIL and created an
> > active thread state, but such thread states are not registered with
> > Python's simplified GIL API system because one is not meant to use the
> > Python simplified GIL API system when multiple Python sub interpreters
> > are used for various reasons. It says as much in the Python code and
> > also I think the documentation.
> >
> > Not sure how much joy you will get with getting dbxml changed. Really
> > need to find out exactly why dbxml authors think the -threads option
> > is required.
> >
> > Graham
> >
> >> Graham Dumpleton wrote:
> >> > Looking a bit further, the GIL macros are in my own stuff, but I
> >> > suspect it doesn't get enabled because I don't use the -threads
> >> option
> >> > to SWIG. I don't understand the consequences of the option, but
> >> > changing:
> >> >
> >> >  dbxml/dist/s_swig
> >> >
> >> > so that '-threads' isn't in swig_args for Python would probably get
> >> > rid of the stuff.
> >> >
> >> > Would need to work out why they use the option in the first
> >> place as
> >> > turning it off could break things if dbxml is dependent on it in
> >> some
> >> > way.
> >> >
> >> > Graham
> >> >
> >> > On 11/04/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> >> >> Try rebuilding dbxml but ensure that compiler option:
> >> >>
> >> >>   -DSWIG_PYTHON_NO_USE_GIL
> >> >>
> >> >> is used.
> >> >>
> >> >> I don't know when SWIG changed, it certainly didn't generate these
> >> >> PyGILState calls the last time I played with it, which wasn't that
> >> >> long ago, but it isn't going to work under mod_python the way
> >> they now
> >> >> do it as the default.
> >> >>
> >> >> I'll have to look into this further when I get a chance as this
> >> new
> >> >> behaviour of SWIG is going to cause all my Apache API SWIG
> >> bindings to
> >> >> break. :-(
> >> >>
> >> >> Graham
> >> >>
> >> >> On 11/04/07, David Schachter <ds@bittorrent.com> wrote:
> >> >> >
> >> >> >  Folks--
> >> >> >
> >> >> >  I'm having a problem embedding Berkeley DB XML into Apache with
> >> >> mod_python.
> >> >> > The first attempt to create an XmlManager causes a lockup in
> >> >> Python--the
> >> >> > Global Interpreter Lock is deadlocked, I think. (Stack trace
> >> >> below.) Any
> >> >> > ideas of how to debug? Is there a BDB XML Python expert? I
> >> checked
> >> >> Google
> >> >> > without success.
> >> >> >
> >> >> >  The code to demonstrate the problem is simple and shown below.
> >> >> When the
> >> >> > line "xmlManager = dbxml.XmlManager()" is commented out, the
> >> code
> >> >> runs ok.
> >> >> > Commented in, Apache locks up.
> >> >> >
> >> >> >  The most recent mod_python has this comment at
> >> >> >
> >> >> http://www.modpython.org/live/mod_python-3.3.1/doc-html/app-
> >> changes.html:
> >> >>
> >> >> >
> >> >> >
> >> >> > Third party C modules that use the simplified API for the Global
> >> >> Interpreter
> >> >> > Lock (GIL), as described in PEP 311, can now be used. The only
> >> >> requirement
> >> >> > is that such modules can only be used in the context of the
> >> >> > "main_interpreter". (More info at
> >> >> > http://issues.apache.org/jira/browse/MODPYTHON-77.)
> >> >> >  The documentation for mod_python at
> >> >> > http://www.modpython.org/live/current/doc-html/pyapi-
> >> interps.html
> >> >> > says:
> >> >> >
> >> >> >
> >> >> > Note that if any third party module is being used which has a
> >> C code
> >> >> > component that uses the simplified API for access to the Global
> >> >> Interpreter
> >> >> > Lock (GIL) for Python extension modules, then the interpreter
> >> name
> >> >> must be
> >> >> > forcibly set to be "main_interpreter". This is necessary as
> >> such a
> >> >> module
> >> >> > will only work correctly if run within the context of the
> >> first Python
> >> >> > interpreter created by the process.
> >> >> >  Conforming to this, I set the interpreter name in the
> >> httpd.conf
> >> >> file using
> >> >> > the directive "PythonInterpreter main_interpreter" and I
> >> verified
> >> >> this by
> >> >> > printing the interpreter name from my Python code.
> >> >> >
> >> >> >  In dbxml-2.3.10/dbxml/src/python, there's some code relating to
> >> >> the GIL in
> >> >> > dbxml_python_wrap.cpp. If someone else has already beaten this
> >> >> problem into
> >> >> > submission, I'd rather not duplicate the effort.
> >> >> >
> >> >> >                           -- David Schachter
> >> >> >
> >> >> >  #! /usr/bin/python
> >> >> >
> >> >> >  import dbxml
> >> >> >  from mod_python import apache
> >> >> >  import os
> >> >> >
> >> >> >
> >> >> >  def handler(req):
> >> >> >    id = "pid %d, interpreter '%s'" % (os.getpid(),
> >> req.interpreter)
> >> >> >
> >> >> >    apache.log_error("About to start BDB XML from %s." % id)
> >> >> >    xmlManager = dbxml.XmlManager()
> >> >> >    apache.log_error("Started BDB XML.")
> >> >> >
> >> >> >    req.write("Hi from %s." % id)
> >> >> >    return apache.OK
> >> >> >
> >> >> >
> >> >> >  STACK TRACE IS:
> >> >> >
> >> >> >  (gdb) bt
> >> >> >  #0  0xffffe410 in __kernel_vsyscall ()
> >> >> >  #1  0xb7e97af0 in sem_wait@GLIBC_2.0 () from
> >> >> > /lib/tls/i686/cmov/libpthread.so.0
> >> >> >  #2  0x00000004 in ?? ()
> >> >> >  #3  0xb7ce7a00 in PyThread_acquire_lock (lock=0x0,
> >> waitflag=1) at
> >> >> > thread_pthread.h:298
> >> >> >  #4  0xb7cb5689 in PyEval_RestoreThread (tstate=0x810f888) at
> >> >> > Python/ceval.c:305
> >> >> >  #5  0xb7ce16e7 in PyGILState_Ensure () at Python/pystate.c:512
> >> >> >  #6  0xb78282f9 in _wrap_new_XmlManager (self=0x0,
> >> args=0xb7b9102c) at
> >> >> > dbxml_python_wrap.cpp:898
> >> >> >       (The reference to line 898 is correct but surprising, the
> >> >> result of a
> >> >> > macro expansion at line 4195. --D.S.)
> >> >> >  #7  0xb7c65967 in PyObject_Call (func=0x0, arg=0xfffffffc,
> >> >> kw=0xfffffffc)
> >> >> > at Objects/abstract.c:1795
> >> >> >  #8  0xb7cb9e1d in PyEval_EvalFrame (f=0x822cdbc) at
> >> >> Python/ceval.c:3845
> >> >> >  #9  0xb7cbd719 in PyEval_EvalCodeEx (co=0xb6b12e20,
> >> >> globals=0xfffffffc,
> >> >> > locals=0x0, args=0x0, argcount=1,
> >> >> >      kws=0x0, kwcount=0, defs=0x0, defcount=0, closure=0x0) at
> >> >> > Python/ceval.c:2741
> >> >> >  #10 0xb7d0d6be in function_call (func=0xb6b0902c,
> >> arg=0xb6b892ac,
> >> >> kw=0x0)
> >> >> > at Objects/funcobject.c:548
> >> >> >  #11 0xb7c65967 in PyObject_Call (func=0x0, arg=0xfffffffc,
> >> >> kw=0xfffffffc)
> >> >> > at Objects/abstract.c:1795
> >> >> >  #12 0xb7c6e389 in instancemethod_call (func=0xfffffffc,
> >> >> arg=0xb6b892ac,
> >> >> > kw=0xfffffffc)
> >> >> >      at Objects/classobject.c:2532
> >> >> >  #13 0xb7c65967 in PyObject_Call (func=0x0, arg=0xfffffffc,
> >> >> kw=0xfffffffc)
> >> >> > at Objects/abstract.c:1795
> >> >> >  #14 0xb7c99728 in slot_tp_init (self=0xb6af1fac,
> >> args=0xfffffffc,
> >> >> > kwds=0xfffffffc)
> >> >> >      at Objects/typeobject.c:4774
> >> >> >  #15 0xb7c91ad4 in type_call (type=0xb7c99675, args=0xb7b9102c,
> >> >> kwds=0x0) at
> >> >> > Objects/typeobject.c:435
> >> >> >  #16 0xb7c65967 in PyObject_Call (func=0x0, arg=0xfffffffc,
> >> >> kw=0xfffffffc)
> >> >> > at Objects/abstract.c:1795
> >> >> >  #17 0xb7cba239 in PyEval_EvalFrame (f=0x820f224) at
> >> >> Python/ceval.c:3776
> >> >> >  #18 0xb7cbd0eb in PyEval_EvalFrame (f=0x8195854) at
> >> >> Python/ceval.c:3651
> >> >> >  #19 0xb7cbd0eb in PyEval_EvalFrame (f=0x81c9ac4) at
> >> >> Python/ceval.c:3651
> >> >> >  #20 0xb7cbd719 in PyEval_EvalCodeEx (co=0xb6b87e20,
> >> >> globals=0xfffffffc,
> >> >> > locals=0x0, args=0x7, argcount=0,
> >> >> >      kws=0x8282440, kwcount=7, defs=0x0, defcount=0,
> >> closure=0x0) at
> >> >> > Python/ceval.c:2741
> >> >> >  #21 0xb7cbb46a in PyEval_EvalFrame (f=0x82822a4) at
> >> >> Python/ceval.c:3660
> >> >> >  #22 0xb7cbd719 in PyEval_EvalCodeEx (co=0xb6b87ee0,
> >> >> globals=0xfffffffc,
> >> >> > locals=0x0, args=0x0, argcount=2,
> >> >> >      kws=0x0, kwcount=0, defs=0x0, defcount=0, closure=0x0) at
> >> >> > Python/ceval.c:2741
> >> >> >  #23 0xb7d0d6be in function_call (func=0xb6af3a74,
> >> arg=0xb6b7c78c,
> >> >> kw=0x0)
> >> >> > at Objects/funcobject.c:548
> >> >> >  #24 0xb7c65967 in PyObject_Call (func=0x0, arg=0xfffffffc,
> >> >> kw=0xfffffffc)
> >> >> > at Objects/abstract.c:1795
> >> >> >  #25 0xb7c6e389 in instancemethod_call (func=0xfffffffc,
> >> >> arg=0xb6b7c78c,
> >> >> > kw=0xfffffffc)
> >> >> >      at Objects/classobject.c:2532
> >> >> >  #26 0xb7c65bf6 in PyObject_CallMethod (o=0x0,
> >> name=0xb6b891ec "\001",
> >> >> > format=0xb6b891ec "\001")
> >> >> >      at Objects/abstract.c:1795
> >> >> >  #27 0xb7c5f505 in python_handler (req=0x828a7b8,
> >> phase=0xb7d16e59
> >> >> > "PythonHandler") at mod_python.c:1652
> >> >> >  #28 0x08073daf in ap_run_handler (r=0x828a7b8) at config.c:157
> >> >> >  #29 0x080741b1 in ap_invoke_handler (r=0x828a7b8) at
> >> config.c:372
> >> >> >  ---Type <return> to continue, or q <return> to quit---
> >> >> >  #30 0x0808ba77 in ap_process_request (r=0x828a7b8) at
> >> >> http_request.c:258
> >> >> >  #31 0x0808929b in ap_process_http_connection (c=0x8185638) at
> >> >> > http_core.c:184
> >> >> >  #32 0x0807a599 in ap_run_process_connection (c=0x8185638) at
> >> >> > connection.c:43
> >> >> >  #33 0x0809e55a in child_main (child_num_arg=-4) at prefork.c:
> >> 640
> >> >> >  #34 0x0809e7a8 in make_child (s=0x80c9c80, slot=0) at
> >> prefork.c:680
> >> >> >  #35 0x0809ee53 in ap_mpm_run (_pconf=0xbf86d6f0,
> >> plog=0x81031a0,
> >> >> > s=0xbf86d6f4) at prefork.c:956
> >> >> >  #36 0x080622c8 in main (argc=2, argv=0xbf86d8b4) at main.c:717
> >> >> >  (gdb)
> >> >> >
> >> >> >
> >> >> >
> >> >> >
> >> >> > _______________________________________________
> >> >> > Mod_python mailing list
> >> >> > Mod_python@modpython.org
> >> >> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >> >> >
> >> >> >
> >> >>
> >> >
> >>
> >>
>
>
From nathan at yapta.com  Wed Apr 11 18:30:52 2007
From: nathan at yapta.com (Nathan C. Tresch)
Date: Wed Apr 11 18:30:56 2007
Subject: [mod_python] Mod_Python and RewriteRule
Message-ID: <8e3f377c0704111530p60743212v31fd3801f74437a3@mail.gmail.com>

We're using Myghty and Mod_Python.  The following RewriteRule produces a
404:

RewriteRule /trip-([0-9]*)/.*/ /user/trip.myt\?tab=airlines&id=$1 [L]

Previously, before we converted to PHP, the rule looked like this:

RewriteRule /trip-([0-9]*)/.*/ /user/trip.php\?tab=airlines&id=$1 [L]

This worked.

Can anyone tell me what gives?






-- 
Nathan C. Tresch
Software Engineer
YapTA! Inc.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070411/7705d3c0/attachment.html
From graham.dumpleton at gmail.com  Wed Apr 11 18:41:15 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Apr 11 18:41:19 2007
Subject: [mod_python] Mod_Python and RewriteRule
In-Reply-To: <8e3f377c0704111530p60743212v31fd3801f74437a3@mail.gmail.com>
References: <8e3f377c0704111530p60743212v31fd3801f74437a3@mail.gmail.com>
Message-ID: <88e286470704111541m187d44c2pdfb4ca25a57ffd8c@mail.gmail.com>

On 12/04/07, Nathan C. Tresch <nathan@yapta.com> wrote:
> We're using Myghty and Mod_Python.  The following RewriteRule produces a
> 404:
>
> RewriteRule /trip-([0-9]*)/.*/
> /user/trip.myt\?tab=airlines&id=$1 [L]
>
> Previously, before we converted to PHP, the rule looked like this:
>
> RewriteRule /trip-([0-9]*)/.*/
> /user/trip.php\?tab=airlines&id=$1 [L]
>
> This worked.
>
> Can anyone tell me what gives?

Have you tried debugging what mod_rewrite is doing by increasing its
logging output using the RewriteLogLevel directive etc? From that you
can see what it finally rewrites it to. You can then try putting that
URL into the browser directly and try and work out why any other
configuration may not be correct.

Graham
From nathan at yapta.com  Wed Apr 11 18:48:35 2007
From: nathan at yapta.com (Nathan C. Tresch)
Date: Wed Apr 11 18:48:40 2007
Subject: [mod_python] Mod_Python and RewriteRule
In-Reply-To: <88e286470704111541m187d44c2pdfb4ca25a57ffd8c@mail.gmail.com>
References: <8e3f377c0704111530p60743212v31fd3801f74437a3@mail.gmail.com>
	<88e286470704111541m187d44c2pdfb4ca25a57ffd8c@mail.gmail.com>
Message-ID: <8e3f377c0704111548r4d94bd8dk8cd67e122c607fa2@mail.gmail.com>

So, here is what I get:

%tail -f rewrite_log
67.42.99.238 - - [11/Apr/2007:15:44:23 --0700]
[dev.yapta.com/sid#80d05f0][rid#8d3c050/initial
<http://dev.yapta.com/sid#80d05f0%5D%5Brid%238d3c050/initial>] (2) init
rewrite engine with requested uri /trip-18335/Minneapolis/St.
Paul/Washington/
67.42.99.238 - - [11/Apr/2007:15:44:23 --0700]
[dev.yapta.com/sid#80d05f0][rid#8d3c050/initial<http://dev.yapta.com/sid#80d05f0%5D%5Brid%238d3c050/initial>]
(3) applying pattern '/trip-([0-9]*)/.*/' to uri
'/trip-18335/Minneapolis/St. Paul/Washington/'
67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
dev.yapta.com/sid#80d05f0][rid#8d3c050/initial<http://dev.yapta.com/sid#80d05f0%5D%5Brid%238d3c050/initial>]
(2) rewrite '/trip-18335/Minneapolis/St. Paul/Washington/' ->
'/user/trip.myt?tab=airline&id=18335'
67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
dev.yapta.com/sid#80d05f0][rid#8d3c050/initial<http://dev.yapta.com/sid#80d05f0%5D%5Brid%238d3c050/initial>]
(3) split uri=/user/trip.myt?tab=airline&id=18335 -> uri=/user/trip.myt,
args=tab=airline&id=18335
67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
dev.yapta.com/sid#80d05f0][rid#8d3c050/initial<http://dev.yapta.com/sid#80d05f0%5D%5Brid%238d3c050/initial>]
(2) local path result: /user/trip.myt
67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
dev.yapta.com/sid#80d05f0][rid#8d3c050/initial<http://dev.yapta.com/sid#80d05f0%5D%5Brid%238d3c050/initial>]
(2) prefixed with document_root to
/usr/local/data/wwwdev/ntresch/public/user/trip.myt
67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
dev.yapta.com/sid#80d05f0][rid#8d3c050/initial<http://dev.yapta.com/sid#80d05f0%5D%5Brid%238d3c050/initial>]
(1) go-ahead with /usr/local/data/wwwdev/ntresch/public/user/trip.myt [OK]

Yet my browser still gives me a 404.

I suspect it's because python/myghty is looking for something in the
origional path, it's modules maybe?  And it can't find anything there.

On 4/11/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
>
> On 12/04/07, Nathan C. Tresch <nathan@yapta.com> wrote:
> > We're using Myghty and Mod_Python.  The following RewriteRule produces a
> > 404:
> >
> > RewriteRule /trip-([0-9]*)/.*/
> > /user/trip.myt\?tab=airlines&id=$1 [L]
> >
> > Previously, before we converted to PHP, the rule looked like this:
> >
> > RewriteRule /trip-([0-9]*)/.*/
> > /user/trip.php\?tab=airlines&id=$1 [L]
> >
> > This worked.
> >
> > Can anyone tell me what gives?
>
> Have you tried debugging what mod_rewrite is doing by increasing its
> logging output using the RewriteLogLevel directive etc? From that you
> can see what it finally rewrites it to. You can then try putting that
> URL into the browser directly and try and work out why any other
> configuration may not be correct.
>
> Graham
>



-- 
Nathan C. Tresch
Software Engineer
YapTA! Inc.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070411/36812630/attachment-0001.html
From graham.dumpleton at gmail.com  Wed Apr 11 18:53:50 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Apr 11 18:53:54 2007
Subject: [mod_python] Mod_Python and RewriteRule
In-Reply-To: <8e3f377c0704111548r4d94bd8dk8cd67e122c607fa2@mail.gmail.com>
References: <8e3f377c0704111530p60743212v31fd3801f74437a3@mail.gmail.com>
	<88e286470704111541m187d44c2pdfb4ca25a57ffd8c@mail.gmail.com>
	<8e3f377c0704111548r4d94bd8dk8cd67e122c607fa2@mail.gmail.com>
Message-ID: <88e286470704111553o33c6dd70q24fa5ea737c7ef27@mail.gmail.com>

Does using:

  /user/trip.myt?tab=airline&id=18335

in the browser work?

What is the Apache configuration snippet you are using to enable
mod_python for this URL? Where is it located, main Apache
configuration or .htaccess file?

Graham

On 12/04/07, Nathan C. Tresch <nathan@yapta.com> wrote:
> So, here is what I get:
>
> %tail -f rewrite_log
> 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> dev.yapta.com/sid#80d05f0][rid#8d3c050/initial ] (2) init
> rewrite engine with requested uri /trip-18335/Minneapolis/St.
> Paul/Washington/
> 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> dev.yapta.com/sid#80d05f0][rid#8d3c050/initial] (3)
> applying pattern '/trip-([0-9]*)/.*/' to uri '/trip-18335/Minneapolis/St.
> Paul/Washington/'
>  67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> dev.yapta.com/sid#80d05f0][rid#8d3c050/initial] (2) rewrite
> '/trip-18335/Minneapolis/St. Paul/Washington/' ->
> '/user/trip.myt?tab=airline&id=18335'
> 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> dev.yapta.com/sid#80d05f0][rid#8d3c050/initial] (3) split
> uri=/user/trip.myt?tab=airline&id=18335 ->
> uri=/user/trip.myt, args=tab=airline&id=18335
> 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> dev.yapta.com/sid#80d05f0][rid#8d3c050/initial] (2) local
> path result: /user/trip.myt
> 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> dev.yapta.com/sid#80d05f0][rid#8d3c050/initial] (2)
> prefixed with document_root to
> /usr/local/data/wwwdev/ntresch/public/user/trip.myt
> 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> dev.yapta.com/sid#80d05f0][rid#8d3c050/initial] (1)
> go-ahead with
> /usr/local/data/wwwdev/ntresch/public/user/trip.myt [OK]
>
> Yet my browser still gives me a 404.
>
> I suspect it's because python/myghty is looking for something in the
> origional path, it's modules maybe?  And it can't find anything there.
>
>
>  On 4/11/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > On 12/04/07, Nathan C. Tresch <nathan@yapta.com> wrote:
> > > We're using Myghty and Mod_Python.  The following RewriteRule produces a
> > > 404:
> > >
> > > RewriteRule /trip-([0-9]*)/.*/
> > > /user/trip.myt\?tab=airlines&id=$1 [L]
> > >
> > > Previously, before we converted to PHP, the rule looked like this:
> > >
> > > RewriteRule /trip-([0-9]*)/.*/
> > > /user/trip.php\?tab=airlines&id=$1 [L]
> > >
> > > This worked.
> > >
> > > Can anyone tell me what gives?
> >
> > Have you tried debugging what mod_rewrite is doing by increasing its
> > logging output using the RewriteLogLevel directive etc? From that you
> > can see what it finally rewrites it to. You can then try putting that
> > URL into the browser directly and try and work out why any other
> > configuration may not be correct.
> >
> > Graham
> >
>
>
>
> --
> Nathan C. Tresch
> Software Engineer
> YapTA! Inc.
From nathan at yapta.com  Wed Apr 11 18:56:24 2007
From: nathan at yapta.com (Nathan C. Tresch)
Date: Wed Apr 11 18:56:30 2007
Subject: [mod_python] Mod_Python and RewriteRule
In-Reply-To: <88e286470704111553o33c6dd70q24fa5ea737c7ef27@mail.gmail.com>
References: <8e3f377c0704111530p60743212v31fd3801f74437a3@mail.gmail.com>
	<88e286470704111541m187d44c2pdfb4ca25a57ffd8c@mail.gmail.com>
	<8e3f377c0704111548r4d94bd8dk8cd67e122c607fa2@mail.gmail.com>
	<88e286470704111553o33c6dd70q24fa5ea737c7ef27@mail.gmail.com>
Message-ID: <8e3f377c0704111556i45d84ba9ka060318b5e730bf0@mail.gmail.com>

Yes,  /user/trip.myt?tab=airline&id=18335 works.

    AddHandler mod_python .py
    AddHandler mod_python .myt
    PythonHandler myghty.ApacheHandler::handle
    PythonPath "[r'/usr/local/data/wwwdev/ntresch']+sys.path"
    PythonOption MyghtyInterpreterName r"ntresch_interp"
    PythonOption MyghtyComponentRoot \
    "[  \
        {'components':'/data/wwwdev/ntresch/public'}, \
        {'templates':'/data/wwwdev/ntresch/myghty/templates'} \
    ]"
    PythonOption MyghtyDataDir r"/data/wwwdev/ntresch/myghty/data"


    #PythonHandler mod_python.publisher
    PythonDebug On

These lines are located in the main apache config file.

On 4/11/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
>
> Does using:
>
>   /user/trip.myt?tab=airline&id=18335
>
> in the browser work?
>
> What is the Apache configuration snippet you are using to enable
> mod_python for this URL? Where is it located, main Apache
> configuration or .htaccess file?
>
> Graham
>
> On 12/04/07, Nathan C. Tresch <nathan@yapta.com> wrote:
> > So, here is what I get:
> >
> > %tail -f rewrite_log
> > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial ] (2) init
> > rewrite engine with requested uri /trip-18335/Minneapolis/St.
> > Paul/Washington/
> > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial] (3)
> > applying pattern '/trip-([0-9]*)/.*/' to uri
> '/trip-18335/Minneapolis/St.
> > Paul/Washington/'
> >  67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial] (2) rewrite
> > '/trip-18335/Minneapolis/St. Paul/Washington/' ->
> > '/user/trip.myt?tab=airline&id=18335'
> > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial] (3) split
> > uri=/user/trip.myt?tab=airline&id=18335 ->
> > uri=/user/trip.myt, args=tab=airline&id=18335
> > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial] (2) local
> > path result: /user/trip.myt
> > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial] (2)
> > prefixed with document_root to
> > /usr/local/data/wwwdev/ntresch/public/user/trip.myt
> > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial] (1)
> > go-ahead with
> > /usr/local/data/wwwdev/ntresch/public/user/trip.myt [OK]
> >
> > Yet my browser still gives me a 404.
> >
> > I suspect it's because python/myghty is looking for something in the
> > origional path, it's modules maybe?  And it can't find anything there.
> >
> >
> >  On 4/11/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > > On 12/04/07, Nathan C. Tresch <nathan@yapta.com> wrote:
> > > > We're using Myghty and Mod_Python.  The following RewriteRule
> produces a
> > > > 404:
> > > >
> > > > RewriteRule /trip-([0-9]*)/.*/
> > > > /user/trip.myt\?tab=airlines&id=$1 [L]
> > > >
> > > > Previously, before we converted to PHP, the rule looked like this:
> > > >
> > > > RewriteRule /trip-([0-9]*)/.*/
> > > > /user/trip.php\?tab=airlines&id=$1 [L]
> > > >
> > > > This worked.
> > > >
> > > > Can anyone tell me what gives?
> > >
> > > Have you tried debugging what mod_rewrite is doing by increasing its
> > > logging output using the RewriteLogLevel directive etc? From that you
> > > can see what it finally rewrites it to. You can then try putting that
> > > URL into the browser directly and try and work out why any other
> > > configuration may not be correct.
> > >
> > > Graham
> > >
> >
> >
> >
> > --
> > Nathan C. Tresch
> > Software Engineer
> > YapTA! Inc.
>



-- 
Nathan C. Tresch
Software Engineer
YapTA! Inc.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070411/4ce3bf74/attachment.html
From graham.dumpleton at gmail.com  Wed Apr 11 19:05:53 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Apr 11 19:06:09 2007
Subject: [mod_python] Mod_Python and RewriteRule
In-Reply-To: <8e3f377c0704111556i45d84ba9ka060318b5e730bf0@mail.gmail.com>
References: <8e3f377c0704111530p60743212v31fd3801f74437a3@mail.gmail.com>
	<88e286470704111541m187d44c2pdfb4ca25a57ffd8c@mail.gmail.com>
	<8e3f377c0704111548r4d94bd8dk8cd67e122c607fa2@mail.gmail.com>
	<88e286470704111553o33c6dd70q24fa5ea737c7ef27@mail.gmail.com>
	<8e3f377c0704111556i45d84ba9ka060318b5e730bf0@mail.gmail.com>
Message-ID: <88e286470704111605s53ebc67fu8da69cbd6d39cfa9@mail.gmail.com>

Does it make any difference if you use:

  RewriteRule /trip-([0-9]*)/.*/ /user/trip.myt\?tab=airlines&id=$1 [PT]

or:

  RewriteRule /trip-([0-9]*)/.*/ /user/trip.myt\?tab=airlines&id=$1
[H=mod_python]

Can't remember if latter requires Apache 2.2 If older version of
Apache maybe try:

  RewriteRule /trip-([0-9]*)/.*/ /user/trip.myt\?tab=airlines&id=$1
[T=mod_python]

Graham

On 12/04/07, Nathan C. Tresch <nathan@yapta.com> wrote:
> Yes,  /user/trip.myt?tab=airline&id=18335 works.
>
>     AddHandler mod_python .py
>     AddHandler mod_python .myt
>     PythonHandler myghty.ApacheHandler::handle
>     PythonPath
> "[r'/usr/local/data/wwwdev/ntresch']+sys.path"
>     PythonOption MyghtyInterpreterName r"ntresch_interp"
>     PythonOption MyghtyComponentRoot \
>     "[  \
>         {'components':'/data/wwwdev/ntresch/public'}, \
>
> {'templates':'/data/wwwdev/ntresch/myghty/templates'} \
>     ]"
>     PythonOption MyghtyDataDir
> r"/data/wwwdev/ntresch/myghty/data"
>
>
>     #PythonHandler mod_python.publisher
>     PythonDebug On
>
> These lines are located in the main apache config file.
>
>
> On 4/11/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > Does using:
> >
> >   /user/trip.myt?tab=airline&id=18335
> >
> > in the browser work?
> >
> > What is the Apache configuration snippet you are using to enable
> > mod_python for this URL? Where is it located, main Apache
> > configuration or .htaccess file?
> >
> > Graham
> >
> > On 12/04/07, Nathan C. Tresch <nathan@yapta.com> wrote:
> > > So, here is what I get:
> > >
> > > %tail -f rewrite_log
> > > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial ] (2)
> init
> > > rewrite engine with requested uri /trip-18335/Minneapolis/St.
> > > Paul/Washington/
> > > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial] (3)
> > > applying pattern '/trip-([0-9]*)/.*/' to uri
> '/trip-18335/Minneapolis/St.
> > > Paul/Washington/'
> > >  67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial] (2)
> rewrite
> > > '/trip-18335/Minneapolis/St. Paul/Washington/' ->
> > > '/user/trip.myt?tab=airline&id=18335'
> > > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial] (3)
> split
> > > uri=/user/trip.myt?tab=airline&id=18335 ->
> > > uri=/user/trip.myt, args=tab=airline&id=18335
> > > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial] (2)
> local
> > > path result: /user/trip.myt
> > > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial] (2)
> > > prefixed with document_root to
> > > /usr/local/data/wwwdev/ntresch/public/user/trip.myt
> > > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial ] (1)
> > > go-ahead with
> > > /usr/local/data/wwwdev/ntresch/public/user/trip.myt
> [OK]
> > >
> > > Yet my browser still gives me a 404.
> > >
> > > I suspect it's because python/myghty is looking for something in the
> > > origional path, it's modules maybe?  And it can't find anything there.
> > >
> > >
> > >  On 4/11/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > > > On 12/04/07, Nathan C. Tresch <nathan@yapta.com> wrote:
> > > > > We're using Myghty and Mod_Python.  The following RewriteRule
> produces a
> > > > > 404:
> > > > >
> > > > > RewriteRule /trip-([0-9]*)/.*/
> > > > > /user/trip.myt\?tab=airlines&id=$1 [L]
> > > > >
> > > > > Previously, before we converted to PHP, the rule looked like this:
> > > > >
> > > > > RewriteRule /trip-([0-9]*)/.*/
> > > > > /user/trip.php\?tab=airlines&id=$1 [L]
> > > > >
> > > > > This worked.
> > > > >
> > > > > Can anyone tell me what gives?
> > > >
> > > > Have you tried debugging what mod_rewrite is doing by increasing its
> > > > logging output using the RewriteLogLevel directive etc? From that you
> > > > can see what it finally rewrites it to. You can then try putting that
> > > > URL into the browser directly and try and work out why any other
> > > > configuration may not be correct.
> > > >
> > > > Graham
> > > >
> > >
> > >
> > >
> > > --
> > > Nathan C. Tresch
> > > Software Engineer
> > > YapTA! Inc.
> >
>
>
>
> --
>
> Nathan C. Tresch
> Software Engineer
> YapTA! Inc.
From nathan at yapta.com  Wed Apr 11 19:13:16 2007
From: nathan at yapta.com (Nathan C. Tresch)
Date: Wed Apr 11 19:13:25 2007
Subject: [mod_python] Mod_Python and RewriteRule
In-Reply-To: <88e286470704111605s53ebc67fu8da69cbd6d39cfa9@mail.gmail.com>
References: <8e3f377c0704111530p60743212v31fd3801f74437a3@mail.gmail.com>
	<88e286470704111541m187d44c2pdfb4ca25a57ffd8c@mail.gmail.com>
	<8e3f377c0704111548r4d94bd8dk8cd67e122c607fa2@mail.gmail.com>
	<88e286470704111553o33c6dd70q24fa5ea737c7ef27@mail.gmail.com>
	<8e3f377c0704111556i45d84ba9ka060318b5e730bf0@mail.gmail.com>
	<88e286470704111605s53ebc67fu8da69cbd6d39cfa9@mail.gmail.com>
Message-ID: <8e3f377c0704111613w3ce238ffqd125dd47333de2d7@mail.gmail.com>

When I use [PT] both Firefox and IE continually reload the page and peg the
CPU at 100%, however, I get the content I'm after.

The other two options alter the debug output slightly, but still give the
same result.  The extra output just seems to specify it's setting the
MIME-type to mod_python


On 4/11/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
>
> Does it make any difference if you use:
>
>   RewriteRule /trip-([0-9]*)/.*/ /user/trip.myt\?tab=airlines&id=$1 [PT]
>
> or:
>
>   RewriteRule /trip-([0-9]*)/.*/ /user/trip.myt\?tab=airlines&id=$1
> [H=mod_python]
>
> Can't remember if latter requires Apache 2.2 If older version of
> Apache maybe try:
>
>   RewriteRule /trip-([0-9]*)/.*/ /user/trip.myt\?tab=airlines&id=$1
> [T=mod_python]
>
> Graham
>
> On 12/04/07, Nathan C. Tresch <nathan@yapta.com> wrote:
> > Yes,  /user/trip.myt?tab=airline&id=18335 works.
> >
> >     AddHandler mod_python .py
> >     AddHandler mod_python .myt
> >     PythonHandler myghty.ApacheHandler::handle
> >     PythonPath
> > "[r'/usr/local/data/wwwdev/ntresch']+sys.path"
> >     PythonOption MyghtyInterpreterName r"ntresch_interp"
> >     PythonOption MyghtyComponentRoot \
> >     "[  \
> >         {'components':'/data/wwwdev/ntresch/public'}, \
> >
> > {'templates':'/data/wwwdev/ntresch/myghty/templates'} \
> >     ]"
> >     PythonOption MyghtyDataDir
> > r"/data/wwwdev/ntresch/myghty/data"
> >
> >
> >     #PythonHandler mod_python.publisher
> >     PythonDebug On
> >
> > These lines are located in the main apache config file.
> >
> >
> > On 4/11/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > > Does using:
> > >
> > >   /user/trip.myt?tab=airline&id=18335
> > >
> > > in the browser work?
> > >
> > > What is the Apache configuration snippet you are using to enable
> > > mod_python for this URL? Where is it located, main Apache
> > > configuration or .htaccess file?
> > >
> > > Graham
> > >
> > > On 12/04/07, Nathan C. Tresch <nathan@yapta.com> wrote:
> > > > So, here is what I get:
> > > >
> > > > %tail -f rewrite_log
> > > > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial ] (2)
> > init
> > > > rewrite engine with requested uri /trip-18335/Minneapolis/St.
> > > > Paul/Washington/
> > > > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial] (3)
> > > > applying pattern '/trip-([0-9]*)/.*/' to uri
> > '/trip-18335/Minneapolis/St.
> > > > Paul/Washington/'
> > > >  67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial] (2)
> > rewrite
> > > > '/trip-18335/Minneapolis/St. Paul/Washington/' ->
> > > > '/user/trip.myt?tab=airline&id=18335'
> > > > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial] (3)
> > split
> > > > uri=/user/trip.myt?tab=airline&id=18335 ->
> > > > uri=/user/trip.myt, args=tab=airline&id=18335
> > > > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial] (2)
> > local
> > > > path result: /user/trip.myt
> > > > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial] (2)
> > > > prefixed with document_root to
> > > > /usr/local/data/wwwdev/ntresch/public/user/trip.myt
> > > > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial ] (1)
> > > > go-ahead with
> > > > /usr/local/data/wwwdev/ntresch/public/user/trip.myt
> > [OK]
> > > >
> > > > Yet my browser still gives me a 404.
> > > >
> > > > I suspect it's because python/myghty is looking for something in the
> > > > origional path, it's modules maybe?  And it can't find anything
> there.
> > > >
> > > >
> > > >  On 4/11/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > > > > On 12/04/07, Nathan C. Tresch <nathan@yapta.com> wrote:
> > > > > > We're using Myghty and Mod_Python.  The following RewriteRule
> > produces a
> > > > > > 404:
> > > > > >
> > > > > > RewriteRule /trip-([0-9]*)/.*/
> > > > > > /user/trip.myt\?tab=airlines&id=$1 [L]
> > > > > >
> > > > > > Previously, before we converted to PHP, the rule looked like
> this:
> > > > > >
> > > > > > RewriteRule /trip-([0-9]*)/.*/
> > > > > > /user/trip.php\?tab=airlines&id=$1 [L]
> > > > > >
> > > > > > This worked.
> > > > > >
> > > > > > Can anyone tell me what gives?
> > > > >
> > > > > Have you tried debugging what mod_rewrite is doing by increasing
> its
> > > > > logging output using the RewriteLogLevel directive etc? From that
> you
> > > > > can see what it finally rewrites it to. You can then try putting
> that
> > > > > URL into the browser directly and try and work out why any other
> > > > > configuration may not be correct.
> > > > >
> > > > > Graham
> > > > >
> > > >
> > > >
> > > >
> > > > --
> > > > Nathan C. Tresch
> > > > Software Engineer
> > > > YapTA! Inc.
> > >
> >
> >
> >
> > --
> >
> > Nathan C. Tresch
> > Software Engineer
> > YapTA! Inc.
>



-- 
Nathan C. Tresch
Software Engineer
YapTA! Inc.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070411/e2a316dc/attachment-0001.html
From graham.dumpleton at gmail.com  Wed Apr 11 19:17:54 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Apr 11 19:17:58 2007
Subject: [mod_python] Mod_Python and RewriteRule
In-Reply-To: <8e3f377c0704111613w3ce238ffqd125dd47333de2d7@mail.gmail.com>
References: <8e3f377c0704111530p60743212v31fd3801f74437a3@mail.gmail.com>
	<88e286470704111541m187d44c2pdfb4ca25a57ffd8c@mail.gmail.com>
	<8e3f377c0704111548r4d94bd8dk8cd67e122c607fa2@mail.gmail.com>
	<88e286470704111553o33c6dd70q24fa5ea737c7ef27@mail.gmail.com>
	<8e3f377c0704111556i45d84ba9ka060318b5e730bf0@mail.gmail.com>
	<88e286470704111605s53ebc67fu8da69cbd6d39cfa9@mail.gmail.com>
	<8e3f377c0704111613w3ce238ffqd125dd47333de2d7@mail.gmail.com>
Message-ID: <88e286470704111617m64295898i3e490ca03ab2357a@mail.gmail.com>

On 12/04/07, Nathan C. Tresch <nathan@yapta.com> wrote:
> When I use [PT] both Firefox and IE continually reload the page and peg the
> CPU at 100%, however, I get the content I'm after.

If you see the content you want but the browser is reloading, that
would suggest an issue with the page. Does the HTML for the page have
some meta data which forces a reload after some period. Can you use
some low level mechanism to get the page (curl, wget, telnet) and see
what the actual HTTP status code is and confirm it is just a 200 and
not some sort of redirection status. Also look to see if a Location
header is being returned which may be a target of a redirect.

Graham

> The other two options alter the debug output slightly, but still give the
> same result.  The extra output just seems to specify it's setting the
> MIME-type to mod_python
>
>
>
> On 4/11/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > Does it make any difference if you use:
> >
> >   RewriteRule /trip-([0-9]*)/.*/
> /user/trip.myt\?tab=airlines&id=$1 [PT]
> >
> > or:
> >
> >   RewriteRule /trip-([0-9]*)/.*/
> /user/trip.myt\?tab=airlines&id=$1
> > [H=mod_python]
> >
> > Can't remember if latter requires Apache 2.2 If older version of
> > Apache maybe try:
> >
> >   RewriteRule /trip-([0-9]*)/.*/
> /user/trip.myt\?tab=airlines&id=$1
> > [T=mod_python]
> >
> > Graham
> >
> > On 12/04/07, Nathan C. Tresch < nathan@yapta.com> wrote:
> > > Yes,  /user/trip.myt?tab=airline&id=18335 works.
> > >
> > >     AddHandler mod_python .py
> > >     AddHandler mod_python .myt
> > >     PythonHandler myghty.ApacheHandler::handle
> > >     PythonPath
> > > "[r'/usr/local/data/wwwdev/ntresch']+sys.path"
> > >     PythonOption MyghtyInterpreterName r"ntresch_interp"
> > >     PythonOption MyghtyComponentRoot \
> > >     "[  \
> > >         {'components':'/data/wwwdev/ntresch/public'}, \
> > >
> > > {'templates':'/data/wwwdev/ntresch/myghty/templates'} \
> > >     ]"
> > >     PythonOption MyghtyDataDir
> > > r"/data/wwwdev/ntresch/myghty/data"
> > >
> > >
> > >     #PythonHandler mod_python.publisher
> > >     PythonDebug On
> > >
> > > These lines are located in the main apache config file.
> > >
> > >
> > > On 4/11/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > > > Does using:
> > > >
> > > >   /user/trip.myt?tab=airline&id=18335
> > > >
> > > > in the browser work?
> > > >
> > > > What is the Apache configuration snippet you are using to enable
> > > > mod_python for this URL? Where is it located, main Apache
> > > > configuration or .htaccess file?
> > > >
> > > > Graham
> > > >
> > > > On 12/04/07, Nathan C. Tresch <nathan@yapta.com> wrote:
> > > > > So, here is what I get:
> > > > >
> > > > > %tail -f rewrite_log
> > > > > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial ]
> (2)
> > > init
> > > > > rewrite engine with requested uri /trip-18335/Minneapolis/St.
> > > > > Paul/Washington/
> > > > > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial] (3)
> > > > > applying pattern '/trip-([0-9]*)/.*/' to uri
> > > '/trip-18335/Minneapolis/St.
> > > > > Paul/Washington/'
> > > > >  67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial] (2)
> > > rewrite
> > > > > '/trip-18335/Minneapolis/St. Paul/Washington/' ->
> > > > > '/user/trip.myt?tab=airline&id=18335'
> > > > > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial ]
> (3)
> > > split
> > > > > uri=/user/trip.myt?tab=airline&id=18335 ->
> > > > > uri=/user/trip.myt, args=tab=airline&id=18335
> > > > > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial] (2)
> > > local
> > > > > path result: /user/trip.myt
> > > > > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial ]
> (2)
> > > > > prefixed with document_root to
> > > > > /usr/local/data/wwwdev/ntresch/public/user/trip.myt
> > > > > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial ]
> (1)
> > > > > go-ahead with
> > > > > /usr/local/data/wwwdev/ntresch/public/user/trip.myt
> > > [OK]
> > > > >
> > > > > Yet my browser still gives me a 404.
> > > > >
> > > > > I suspect it's because python/myghty is looking for something in the
> > > > > origional path, it's modules maybe?  And it can't find anything
> there.
> > > > >
> > > > >
> > > > >  On 4/11/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > > > > > On 12/04/07, Nathan C. Tresch < nathan@yapta.com> wrote:
> > > > > > > We're using Myghty and Mod_Python.  The following RewriteRule
> > > produces a
> > > > > > > 404:
> > > > > > >
> > > > > > > RewriteRule /trip-([0-9]*)/.*/
> > > > > > > /user/trip.myt\?tab=airlines&id=$1 [L]
> > > > > > >
> > > > > > > Previously, before we converted to PHP, the rule looked like
> this:
> > > > > > >
> > > > > > > RewriteRule /trip-([0-9]*)/.*/
> > > > > > > /user/trip.php\?tab=airlines&id=$1 [L]
> > > > > > >
> > > > > > > This worked.
> > > > > > >
> > > > > > > Can anyone tell me what gives?
> > > > > >
> > > > > > Have you tried debugging what mod_rewrite is doing by increasing
> its
> > > > > > logging output using the RewriteLogLevel directive etc? From that
> you
> > > > > > can see what it finally rewrites it to. You can then try putting
> that
> > > > > > URL into the browser directly and try and work out why any other
> > > > > > configuration may not be correct.
> > > > > >
> > > > > > Graham
> > > > > >
> > > > >
> > > > >
> > > > >
> > > > > --
> > > > > Nathan C. Tresch
> > > > > Software Engineer
> > > > > YapTA! Inc.
> > > >
> > >
> > >
> > >
> > > --
> > >
> > > Nathan C. Tresch
> > > Software Engineer
> > > YapTA! Inc.
> >
>
>
>
> --
>
> Nathan C. Tresch
> Software Engineer
> YapTA! Inc.
From nathan at yapta.com  Wed Apr 11 19:26:41 2007
From: nathan at yapta.com (Nathan C. Tresch)
Date: Wed Apr 11 19:26:46 2007
Subject: [mod_python] Mod_Python and RewriteRule
In-Reply-To: <88e286470704111617m64295898i3e490ca03ab2357a@mail.gmail.com>
References: <8e3f377c0704111530p60743212v31fd3801f74437a3@mail.gmail.com>
	<88e286470704111541m187d44c2pdfb4ca25a57ffd8c@mail.gmail.com>
	<8e3f377c0704111548r4d94bd8dk8cd67e122c607fa2@mail.gmail.com>
	<88e286470704111553o33c6dd70q24fa5ea737c7ef27@mail.gmail.com>
	<8e3f377c0704111556i45d84ba9ka060318b5e730bf0@mail.gmail.com>
	<88e286470704111605s53ebc67fu8da69cbd6d39cfa9@mail.gmail.com>
	<8e3f377c0704111613w3ce238ffqd125dd47333de2d7@mail.gmail.com>
	<88e286470704111617m64295898i3e490ca03ab2357a@mail.gmail.com>
Message-ID: <8e3f377c0704111626t24a4eec3re68f672ce275af7a@mail.gmail.com>

When I load JUST the page I don't get the reloading problem, only when I use
the rewrite engine and [PT].

Using liveHeaders for Firefox I end up with a zillion(sic) 200 status's,
they never seem to stop.

On 4/11/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
>
> On 12/04/07, Nathan C. Tresch <nathan@yapta.com> wrote:
> > When I use [PT] both Firefox and IE continually reload the page and peg
> the
> > CPU at 100%, however, I get the content I'm after.
>
> If you see the content you want but the browser is reloading, that
> would suggest an issue with the page. Does the HTML for the page have
> some meta data which forces a reload after some period. Can you use
> some low level mechanism to get the page (curl, wget, telnet) and see
> what the actual HTTP status code is and confirm it is just a 200 and
> not some sort of redirection status. Also look to see if a Location
> header is being returned which may be a target of a redirect.
>
> Graham
>
> > The other two options alter the debug output slightly, but still give
> the
> > same result.  The extra output just seems to specify it's setting the
> > MIME-type to mod_python
> >
> >
> >
> > On 4/11/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > > Does it make any difference if you use:
> > >
> > >   RewriteRule /trip-([0-9]*)/.*/
> > /user/trip.myt\?tab=airlines&id=$1 [PT]
> > >
> > > or:
> > >
> > >   RewriteRule /trip-([0-9]*)/.*/
> > /user/trip.myt\?tab=airlines&id=$1
> > > [H=mod_python]
> > >
> > > Can't remember if latter requires Apache 2.2 If older version of
> > > Apache maybe try:
> > >
> > >   RewriteRule /trip-([0-9]*)/.*/
> > /user/trip.myt\?tab=airlines&id=$1
> > > [T=mod_python]
> > >
> > > Graham
> > >
> > > On 12/04/07, Nathan C. Tresch < nathan@yapta.com> wrote:
> > > > Yes,  /user/trip.myt?tab=airline&id=18335 works.
> > > >
> > > >     AddHandler mod_python .py
> > > >     AddHandler mod_python .myt
> > > >     PythonHandler myghty.ApacheHandler::handle
> > > >     PythonPath
> > > > "[r'/usr/local/data/wwwdev/ntresch']+sys.path"
> > > >     PythonOption MyghtyInterpreterName r"ntresch_interp"
> > > >     PythonOption MyghtyComponentRoot \
> > > >     "[  \
> > > >         {'components':'/data/wwwdev/ntresch/public'}, \
> > > >
> > > > {'templates':'/data/wwwdev/ntresch/myghty/templates'} \
> > > >     ]"
> > > >     PythonOption MyghtyDataDir
> > > > r"/data/wwwdev/ntresch/myghty/data"
> > > >
> > > >
> > > >     #PythonHandler mod_python.publisher
> > > >     PythonDebug On
> > > >
> > > > These lines are located in the main apache config file.
> > > >
> > > >
> > > > On 4/11/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > > > > Does using:
> > > > >
> > > > >   /user/trip.myt?tab=airline&id=18335
> > > > >
> > > > > in the browser work?
> > > > >
> > > > > What is the Apache configuration snippet you are using to enable
> > > > > mod_python for this URL? Where is it located, main Apache
> > > > > configuration or .htaccess file?
> > > > >
> > > > > Graham
> > > > >
> > > > > On 12/04/07, Nathan C. Tresch <nathan@yapta.com> wrote:
> > > > > > So, here is what I get:
> > > > > >
> > > > > > %tail -f rewrite_log
> > > > > > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > > > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial ]
> > (2)
> > > > init
> > > > > > rewrite engine with requested uri /trip-18335/Minneapolis/St.
> > > > > > Paul/Washington/
> > > > > > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > > > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial] (3)
> > > > > > applying pattern '/trip-([0-9]*)/.*/' to uri
> > > > '/trip-18335/Minneapolis/St.
> > > > > > Paul/Washington/'
> > > > > >  67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > > > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial] (2)
> > > > rewrite
> > > > > > '/trip-18335/Minneapolis/St. Paul/Washington/' ->
> > > > > > '/user/trip.myt?tab=airline&id=18335'
> > > > > > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > > > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial ]
> > (3)
> > > > split
> > > > > > uri=/user/trip.myt?tab=airline&id=18335 ->
> > > > > > uri=/user/trip.myt, args=tab=airline&id=18335
> > > > > > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > > > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial] (2)
> > > > local
> > > > > > path result: /user/trip.myt
> > > > > > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > > > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial ]
> > (2)
> > > > > > prefixed with document_root to
> > > > > > /usr/local/data/wwwdev/ntresch/public/user/trip.myt
> > > > > > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > > > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial ]
> > (1)
> > > > > > go-ahead with
> > > > > > /usr/local/data/wwwdev/ntresch/public/user/trip.myt
> > > > [OK]
> > > > > >
> > > > > > Yet my browser still gives me a 404.
> > > > > >
> > > > > > I suspect it's because python/myghty is looking for something in
> the
> > > > > > origional path, it's modules maybe?  And it can't find anything
> > there.
> > > > > >
> > > > > >
> > > > > >  On 4/11/07, Graham Dumpleton <graham.dumpleton@gmail.com>
> wrote:
> > > > > > > On 12/04/07, Nathan C. Tresch < nathan@yapta.com> wrote:
> > > > > > > > We're using Myghty and Mod_Python.  The following
> RewriteRule
> > > > produces a
> > > > > > > > 404:
> > > > > > > >
> > > > > > > > RewriteRule /trip-([0-9]*)/.*/
> > > > > > > > /user/trip.myt\?tab=airlines&id=$1 [L]
> > > > > > > >
> > > > > > > > Previously, before we converted to PHP, the rule looked like
> > this:
> > > > > > > >
> > > > > > > > RewriteRule /trip-([0-9]*)/.*/
> > > > > > > > /user/trip.php\?tab=airlines&id=$1 [L]
> > > > > > > >
> > > > > > > > This worked.
> > > > > > > >
> > > > > > > > Can anyone tell me what gives?
> > > > > > >
> > > > > > > Have you tried debugging what mod_rewrite is doing by
> increasing
> > its
> > > > > > > logging output using the RewriteLogLevel directive etc? From
> that
> > you
> > > > > > > can see what it finally rewrites it to. You can then try
> putting
> > that
> > > > > > > URL into the browser directly and try and work out why any
> other
> > > > > > > configuration may not be correct.
> > > > > > >
> > > > > > > Graham
> > > > > > >
> > > > > >
> > > > > >
> > > > > >
> > > > > > --
> > > > > > Nathan C. Tresch
> > > > > > Software Engineer
> > > > > > YapTA! Inc.
> > > > >
> > > >
> > > >
> > > >
> > > > --
> > > >
> > > > Nathan C. Tresch
> > > > Software Engineer
> > > > YapTA! Inc.
> > >
> >
> >
> >
> > --
> >
> > Nathan C. Tresch
> > Software Engineer
> > YapTA! Inc.
>



-- 
Nathan C. Tresch
Software Engineer
YapTA! Inc.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070411/461f6d9a/attachment.html
From graham.dumpleton at gmail.com  Wed Apr 11 19:38:54 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Apr 11 19:38:59 2007
Subject: [mod_python] Mod_Python and RewriteRule
In-Reply-To: <8e3f377c0704111626t24a4eec3re68f672ce275af7a@mail.gmail.com>
References: <8e3f377c0704111530p60743212v31fd3801f74437a3@mail.gmail.com>
	<88e286470704111541m187d44c2pdfb4ca25a57ffd8c@mail.gmail.com>
	<8e3f377c0704111548r4d94bd8dk8cd67e122c607fa2@mail.gmail.com>
	<88e286470704111553o33c6dd70q24fa5ea737c7ef27@mail.gmail.com>
	<8e3f377c0704111556i45d84ba9ka060318b5e730bf0@mail.gmail.com>
	<88e286470704111605s53ebc67fu8da69cbd6d39cfa9@mail.gmail.com>
	<8e3f377c0704111613w3ce238ffqd125dd47333de2d7@mail.gmail.com>
	<88e286470704111617m64295898i3e490ca03ab2357a@mail.gmail.com>
	<8e3f377c0704111626t24a4eec3re68f672ce275af7a@mail.gmail.com>
Message-ID: <88e286470704111638t432b8a04q227530c65e55bbe1@mail.gmail.com>

What if you use wget/curl to get the page? At least with those
programs it should only make one request. There must be something in
the page that causes the browser to re-request it.

If mod_rewrite becomes a pain, the only other way would be to write
using mod_python your own transhandler (I think this is best) which
matches req.uri for what you want and then sets req.filename and
req.args to what you need. Also possibly may want to even set
req.handler at that point to 'mod_python' and even register the
handler to call using req.add_handler(). That way the only thing in
Apache configuration is PythonTransHandler and PythonOption
directives. This will possibly give you better control than
mod_rewrite but does mean that all requests go through Python handler
code which may be a performance issue.

Other than that suggestion, would need to experiment but don't have
time right now.

Graham

On 12/04/07, Nathan C. Tresch <nathan@yapta.com> wrote:
> When I load JUST the page I don't get the reloading problem, only when I use
> the rewrite engine and [PT].
>
> Using liveHeaders for Firefox I end up with a zillion(sic) 200 status's,
> they never seem to stop.
>
>
> On 4/11/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > On 12/04/07, Nathan C. Tresch <nathan@yapta.com> wrote:
> > > When I use [PT] both Firefox and IE continually reload the page and peg
> the
> > > CPU at 100%, however, I get the content I'm after.
> >
> > If you see the content you want but the browser is reloading, that
> > would suggest an issue with the page. Does the HTML for the page have
> > some meta data which forces a reload after some period. Can you use
> > some low level mechanism to get the page (curl, wget, telnet) and see
> > what the actual HTTP status code is and confirm it is just a 200 and
> > not some sort of redirection status. Also look to see if a Location
> > header is being returned which may be a target of a redirect.
> >
> > Graham
> >
> > > The other two options alter the debug output slightly, but still give
> the
> > > same result.  The extra output just seems to specify it's setting the
> > > MIME-type to mod_python
> > >
> > >
> > >
> > > On 4/11/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > > > Does it make any difference if you use:
> > > >
> > > >   RewriteRule /trip-([0-9]*)/.*/
> > > /user/trip.myt\?tab=airlines&id=$1 [PT]
> > > >
> > > > or:
> > > >
> > > >   RewriteRule /trip-([0-9]*)/.*/
> > > /user/trip.myt\?tab=airlines&id=$1
> > > > [H=mod_python]
> > > >
> > > > Can't remember if latter requires Apache 2.2 If older version of
> > > > Apache maybe try:
> > > >
> > > >   RewriteRule /trip-([0-9]*)/.*/
> > > /user/trip.myt\?tab=airlines&id=$1
> > > > [T=mod_python]
> > > >
> > > > Graham
> > > >
> > > > On 12/04/07, Nathan C. Tresch < nathan@yapta.com> wrote:
> > > > > Yes,  /user/trip.myt?tab=airline&id=18335 works.
> > > > >
> > > > >     AddHandler mod_python .py
> > > > >     AddHandler mod_python .myt
> > > > >     PythonHandler myghty.ApacheHandler::handle
> > > > >     PythonPath
> > > > > "[r'/usr/local/data/wwwdev/ntresch']+sys.path"
> > > > >     PythonOption MyghtyInterpreterName r"ntresch_interp"
> > > > >     PythonOption MyghtyComponentRoot \
> > > > >     "[  \
> > > > >
> {'components':'/data/wwwdev/ntresch/public'}, \
> > > > >
> > > > >
> {'templates':'/data/wwwdev/ntresch/myghty/templates'} \
> > > > >     ]"
> > > > >     PythonOption MyghtyDataDir
> > > > > r"/data/wwwdev/ntresch/myghty/data"
> > > > >
> > > > >
> > > > >     #PythonHandler mod_python.publisher
> > > > >     PythonDebug On
> > > > >
> > > > > These lines are located in the main apache config file.
> > > > >
> > > > >
> > > > > On 4/11/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > > > > > Does using:
> > > > > >
> > > > > >   /user/trip.myt?tab=airline&id=18335
> > > > > >
> > > > > > in the browser work?
> > > > > >
> > > > > > What is the Apache configuration snippet you are using to enable
> > > > > > mod_python for this URL? Where is it located, main Apache
> > > > > > configuration or .htaccess file?
> > > > > >
> > > > > > Graham
> > > > > >
> > > > > > On 12/04/07, Nathan C. Tresch < nathan@yapta.com> wrote:
> > > > > > > So, here is what I get:
> > > > > > >
> > > > > > > %tail -f rewrite_log
> > > > > > > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > > > > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial
> ]
> > > (2)
> > > > > init
> > > > > > > rewrite engine with requested uri /trip-18335/Minneapolis/St.
> > > > > > > Paul/Washington/
> > > > > > > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > > > > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial]
> (3)
> > > > > > > applying pattern '/trip-([0-9]*)/.*/' to uri
> > > > > '/trip-18335/Minneapolis/St.
> > > > > > > Paul/Washington/'
> > > > > > >  67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > > > > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial]
> (2)
> > > > > rewrite
> > > > > > > '/trip-18335/Minneapolis/St. Paul/Washington/' ->
> > > > > > > '/user/trip.myt?tab=airline&id=18335'
> > > > > > > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > > > > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial
> ]
> > > (3)
> > > > > split
> > > > > > > uri=/user/trip.myt?tab=airline&id=18335 ->
> > > > > > > uri=/user/trip.myt, args=tab=airline&id=18335
> > > > > > > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > > > > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial
> ] (2)
> > > > > local
> > > > > > > path result: /user/trip.myt
> > > > > > > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > > > > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial
> ]
> > > (2)
> > > > > > > prefixed with document_root to
> > > > > > >
> /usr/local/data/wwwdev/ntresch/public/user/trip.myt
> > > > > > > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > > > > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial
> ]
> > > (1)
> > > > > > > go-ahead with
> > > > > > >
> /usr/local/data/wwwdev/ntresch/public/user/trip.myt
> > > > > [OK]
> > > > > > >
> > > > > > > Yet my browser still gives me a 404.
> > > > > > >
> > > > > > > I suspect it's because python/myghty is looking for something in
> the
> > > > > > > origional path, it's modules maybe?  And it can't find anything
> > > there.
> > > > > > >
> > > > > > >
> > > > > > >  On 4/11/07, Graham Dumpleton <graham.dumpleton@gmail.com>
> wrote:
> > > > > > > > On 12/04/07, Nathan C. Tresch < nathan@yapta.com> wrote:
> > > > > > > > > We're using Myghty and Mod_Python.  The following
> RewriteRule
> > > > > produces a
> > > > > > > > > 404:
> > > > > > > > >
> > > > > > > > > RewriteRule /trip-([0-9]*)/.*/
> > > > > > > > > /user/trip.myt\?tab=airlines&id=$1 [L]
> > > > > > > > >
> > > > > > > > > Previously, before we converted to PHP, the rule looked like
> > > this:
> > > > > > > > >
> > > > > > > > > RewriteRule /trip-([0-9]*)/.*/
> > > > > > > > > /user/trip.php\?tab=airlines&id=$1 [L]
> > > > > > > > >
> > > > > > > > > This worked.
> > > > > > > > >
> > > > > > > > > Can anyone tell me what gives?
> > > > > > > >
> > > > > > > > Have you tried debugging what mod_rewrite is doing by
> increasing
> > > its
> > > > > > > > logging output using the RewriteLogLevel directive etc? From
> that
> > > you
> > > > > > > > can see what it finally rewrites it to. You can then try
> putting
> > > that
> > > > > > > > URL into the browser directly and try and work out why any
> other
> > > > > > > > configuration may not be correct.
> > > > > > > >
> > > > > > > > Graham
> > > > > > > >
> > > > > > >
> > > > > > >
> > > > > > >
> > > > > > > --
> > > > > > > Nathan C. Tresch
> > > > > > > Software Engineer
> > > > > > > YapTA! Inc.
> > > > > >
> > > > >
> > > > >
> > > > >
> > > > > --
> > > > >
> > > > > Nathan C. Tresch
> > > > > Software Engineer
> > > > > YapTA! Inc.
> > > >
> > >
> > >
> > >
> > > --
> > >
> > > Nathan C. Tresch
> > > Software Engineer
> > > YapTA! Inc.
> >
>
>
>
> --
>
> Nathan C. Tresch
> Software Engineer
> YapTA! Inc.
From nathan at yapta.com  Wed Apr 11 20:07:21 2007
From: nathan at yapta.com (Nathan C. Tresch)
Date: Wed Apr 11 20:07:27 2007
Subject: [mod_python] Mod_Python and RewriteRule
In-Reply-To: <88e286470704111638t432b8a04q227530c65e55bbe1@mail.gmail.com>
References: <8e3f377c0704111530p60743212v31fd3801f74437a3@mail.gmail.com>
	<88e286470704111541m187d44c2pdfb4ca25a57ffd8c@mail.gmail.com>
	<8e3f377c0704111548r4d94bd8dk8cd67e122c607fa2@mail.gmail.com>
	<88e286470704111553o33c6dd70q24fa5ea737c7ef27@mail.gmail.com>
	<8e3f377c0704111556i45d84ba9ka060318b5e730bf0@mail.gmail.com>
	<88e286470704111605s53ebc67fu8da69cbd6d39cfa9@mail.gmail.com>
	<8e3f377c0704111613w3ce238ffqd125dd47333de2d7@mail.gmail.com>
	<88e286470704111617m64295898i3e490ca03ab2357a@mail.gmail.com>
	<8e3f377c0704111626t24a4eec3re68f672ce275af7a@mail.gmail.com>
	<88e286470704111638t432b8a04q227530c65e55bbe1@mail.gmail.com>
Message-ID: <8e3f377c0704111707g2d1272cbn5aa9eeb38bc69a9c@mail.gmail.com>

Of course you were right in your supposition that the page had a bug in it
causing [PT] to act wonky. I fixed that and it works as intended now.

Thanks!

On 4/11/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
>
> What if you use wget/curl to get the page? At least with those
> programs it should only make one request. There must be something in
> the page that causes the browser to re-request it.
>
> If mod_rewrite becomes a pain, the only other way would be to write
> using mod_python your own transhandler (I think this is best) which
> matches req.uri for what you want and then sets req.filename and
> req.args to what you need. Also possibly may want to even set
> req.handler at that point to 'mod_python' and even register the
> handler to call using req.add_handler(). That way the only thing in
> Apache configuration is PythonTransHandler and PythonOption
> directives. This will possibly give you better control than
> mod_rewrite but does mean that all requests go through Python handler
> code which may be a performance issue.
>
> Other than that suggestion, would need to experiment but don't have
> time right now.
>
> Graham
>
> On 12/04/07, Nathan C. Tresch <nathan@yapta.com> wrote:
> > When I load JUST the page I don't get the reloading problem, only when I
> use
> > the rewrite engine and [PT].
> >
> > Using liveHeaders for Firefox I end up with a zillion(sic) 200 status's,
> > they never seem to stop.
> >
> >
> > On 4/11/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > > On 12/04/07, Nathan C. Tresch <nathan@yapta.com> wrote:
> > > > When I use [PT] both Firefox and IE continually reload the page and
> peg
> > the
> > > > CPU at 100%, however, I get the content I'm after.
> > >
> > > If you see the content you want but the browser is reloading, that
> > > would suggest an issue with the page. Does the HTML for the page have
> > > some meta data which forces a reload after some period. Can you use
> > > some low level mechanism to get the page (curl, wget, telnet) and see
> > > what the actual HTTP status code is and confirm it is just a 200 and
> > > not some sort of redirection status. Also look to see if a Location
> > > header is being returned which may be a target of a redirect.
> > >
> > > Graham
> > >
> > > > The other two options alter the debug output slightly, but still
> give
> > the
> > > > same result.  The extra output just seems to specify it's setting
> the
> > > > MIME-type to mod_python
> > > >
> > > >
> > > >
> > > > On 4/11/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > > > > Does it make any difference if you use:
> > > > >
> > > > >   RewriteRule /trip-([0-9]*)/.*/
> > > > /user/trip.myt\?tab=airlines&id=$1 [PT]
> > > > >
> > > > > or:
> > > > >
> > > > >   RewriteRule /trip-([0-9]*)/.*/
> > > > /user/trip.myt\?tab=airlines&id=$1
> > > > > [H=mod_python]
> > > > >
> > > > > Can't remember if latter requires Apache 2.2 If older version of
> > > > > Apache maybe try:
> > > > >
> > > > >   RewriteRule /trip-([0-9]*)/.*/
> > > > /user/trip.myt\?tab=airlines&id=$1
> > > > > [T=mod_python]
> > > > >
> > > > > Graham
> > > > >
> > > > > On 12/04/07, Nathan C. Tresch < nathan@yapta.com> wrote:
> > > > > > Yes,  /user/trip.myt?tab=airline&id=18335 works.
> > > > > >
> > > > > >     AddHandler mod_python .py
> > > > > >     AddHandler mod_python .myt
> > > > > >     PythonHandler myghty.ApacheHandler::handle
> > > > > >     PythonPath
> > > > > > "[r'/usr/local/data/wwwdev/ntresch']+sys.path"
> > > > > >     PythonOption MyghtyInterpreterName r"ntresch_interp"
> > > > > >     PythonOption MyghtyComponentRoot \
> > > > > >     "[  \
> > > > > >
> > {'components':'/data/wwwdev/ntresch/public'}, \
> > > > > >
> > > > > >
> > {'templates':'/data/wwwdev/ntresch/myghty/templates'} \
> > > > > >     ]"
> > > > > >     PythonOption MyghtyDataDir
> > > > > > r"/data/wwwdev/ntresch/myghty/data"
> > > > > >
> > > > > >
> > > > > >     #PythonHandler mod_python.publisher
> > > > > >     PythonDebug On
> > > > > >
> > > > > > These lines are located in the main apache config file.
> > > > > >
> > > > > >
> > > > > > On 4/11/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > > > > > > Does using:
> > > > > > >
> > > > > > >   /user/trip.myt?tab=airline&id=18335
> > > > > > >
> > > > > > > in the browser work?
> > > > > > >
> > > > > > > What is the Apache configuration snippet you are using to
> enable
> > > > > > > mod_python for this URL? Where is it located, main Apache
> > > > > > > configuration or .htaccess file?
> > > > > > >
> > > > > > > Graham
> > > > > > >
> > > > > > > On 12/04/07, Nathan C. Tresch < nathan@yapta.com> wrote:
> > > > > > > > So, here is what I get:
> > > > > > > >
> > > > > > > > %tail -f rewrite_log
> > > > > > > > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > > > > > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial
> > ]
> > > > (2)
> > > > > > init
> > > > > > > > rewrite engine with requested uri
> /trip-18335/Minneapolis/St.
> > > > > > > > Paul/Washington/
> > > > > > > > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > > > > > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial]
> > (3)
> > > > > > > > applying pattern '/trip-([0-9]*)/.*/' to uri
> > > > > > '/trip-18335/Minneapolis/St.
> > > > > > > > Paul/Washington/'
> > > > > > > >  67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > > > > > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial]
> > (2)
> > > > > > rewrite
> > > > > > > > '/trip-18335/Minneapolis/St. Paul/Washington/' ->
> > > > > > > > '/user/trip.myt?tab=airline&id=18335'
> > > > > > > > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > > > > > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial
> > ]
> > > > (3)
> > > > > > split
> > > > > > > > uri=/user/trip.myt?tab=airline&id=18335 ->
> > > > > > > > uri=/user/trip.myt, args=tab=airline&id=18335
> > > > > > > > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > > > > > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial
> > ] (2)
> > > > > > local
> > > > > > > > path result: /user/trip.myt
> > > > > > > > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > > > > > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial
> > ]
> > > > (2)
> > > > > > > > prefixed with document_root to
> > > > > > > >
> > /usr/local/data/wwwdev/ntresch/public/user/trip.myt
> > > > > > > > 67.42.99.238 - - [11/Apr/2007:15:44:23 --0700] [
> > > > > > > > dev.yapta.com/sid#80d05f0][rid#8d3c050/initial
> > ]
> > > > (1)
> > > > > > > > go-ahead with
> > > > > > > >
> > /usr/local/data/wwwdev/ntresch/public/user/trip.myt
> > > > > > [OK]
> > > > > > > >
> > > > > > > > Yet my browser still gives me a 404.
> > > > > > > >
> > > > > > > > I suspect it's because python/myghty is looking for
> something in
> > the
> > > > > > > > origional path, it's modules maybe?  And it can't find
> anything
> > > > there.
> > > > > > > >
> > > > > > > >
> > > > > > > >  On 4/11/07, Graham Dumpleton <graham.dumpleton@gmail.com>
> > wrote:
> > > > > > > > > On 12/04/07, Nathan C. Tresch < nathan@yapta.com> wrote:
> > > > > > > > > > We're using Myghty and Mod_Python.  The following
> > RewriteRule
> > > > > > produces a
> > > > > > > > > > 404:
> > > > > > > > > >
> > > > > > > > > > RewriteRule /trip-([0-9]*)/.*/
> > > > > > > > > > /user/trip.myt\?tab=airlines&id=$1 [L]
> > > > > > > > > >
> > > > > > > > > > Previously, before we converted to PHP, the rule looked
> like
> > > > this:
> > > > > > > > > >
> > > > > > > > > > RewriteRule /trip-([0-9]*)/.*/
> > > > > > > > > > /user/trip.php\?tab=airlines&id=$1 [L]
> > > > > > > > > >
> > > > > > > > > > This worked.
> > > > > > > > > >
> > > > > > > > > > Can anyone tell me what gives?
> > > > > > > > >
> > > > > > > > > Have you tried debugging what mod_rewrite is doing by
> > increasing
> > > > its
> > > > > > > > > logging output using the RewriteLogLevel directive etc?
> From
> > that
> > > > you
> > > > > > > > > can see what it finally rewrites it to. You can then try
> > putting
> > > > that
> > > > > > > > > URL into the browser directly and try and work out why any
> > other
> > > > > > > > > configuration may not be correct.
> > > > > > > > >
> > > > > > > > > Graham
> > > > > > > > >
> > > > > > > >
> > > > > > > >
> > > > > > > >
> > > > > > > > --
> > > > > > > > Nathan C. Tresch
> > > > > > > > Software Engineer
> > > > > > > > YapTA! Inc.
> > > > > > >
> > > > > >
> > > > > >
> > > > > >
> > > > > > --
> > > > > >
> > > > > > Nathan C. Tresch
> > > > > > Software Engineer
> > > > > > YapTA! Inc.
> > > > >
> > > >
> > > >
> > > >
> > > > --
> > > >
> > > > Nathan C. Tresch
> > > > Software Engineer
> > > > YapTA! Inc.
> > >
> >
> >
> >
> > --
> >
> > Nathan C. Tresch
> > Software Engineer
> > YapTA! Inc.
>



-- 
Nathan C. Tresch
Software Engineer
YapTA! Inc.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070411/8237c503/attachment.html
From jochen.wuttke at gmx.de  Fri Apr 13 05:27:33 2007
From: jochen.wuttke at gmx.de (Jochen Wuttke)
Date: Fri Apr 13 05:27:58 2007
Subject: [mod_python] make_obcallback: could not import mod_python. apache.
Message-ID: <BC60FF9B-5183-418A-AD8C-43632C8A1C12@gmx.de>

Hi,


Versions:
Apache 2.2.3
mod_python 3.3.1

this is the error message:

[Thu Apr 12 18:44:04 2007] [error] make_obcallback: could not import  
mod_python.
apache.\n
ImportError: No module named mod_python.apache
[Thu Apr 12 18:44:04 2007] [error] make_obcallback: Python path being  
used "['/u
sr/lib/python24.zip', '/usr/lib/python2.4', '/usr/lib/python2.4/plat- 
linux2', '/
usr/lib/python2.4/lib-tk', '/usr/lib/python2.4/lib-dynload', '/usr/ 
local/lib/pyt
hon2.4/site-packages', '/usr/lib/python2.4/site-packages', '/var/lib/ 
python-supp
ort/python2.4']".
[Thu Apr 12 18:44:04 2007] [error] get_interpreter: no interpreter  
callback foun
d.

I had to install a bunch of things in my $HOME on the server, and  
obviously that path is not listed here.
I saw a previous post suggesting that one should fix the path python  
is looking for modules. Unfortunately I don't have root access on the  
server and can't do that. So I tried to place an appropriate

PythonPath "sys.path + ['/the/path/in/my/home']"

directive in the apache config:

1. Within a <Location>
2. Directly after the LoadModule statement (ClearModules is not used)
3. In the server config area.

None of these directives changes the python path used when I try to  
access the test location. Any suggestions what I'm doing wrong?

Jochen
From poeml at suse.de  Fri Apr 13 09:47:32 2007
From: poeml at suse.de (Dr. Peter Poeml)
Date: Fri Apr 13 09:51:10 2007
Subject: [mod_python] Mod_python 3.3.1 openSUSE package
In-Reply-To: <20070215165246.H48122@grisha.dyndns.org>
References: <20070215165246.H48122@grisha.dyndns.org>
Message-ID: <20070413134731.GS29791@suse.de>

Hi,

On Thu, Feb 15, 2007 at 04:54:13PM -0500, Gregory (Grisha) Trubetskoy wrote:
> 
> The Apache Software Foundation and The Apache HTTP Server Project are
> pleased to announce the 3.3.1 release of mod_python. Mod_python 3.3.1
> is considered a stable release, suitable for production use.

I have updated the packages in the openSUSE buildservice to 3.3.1:

http://software.opensuse.org/download/Apache:/Modules/

The directories starting with "Apache_" contain builds against the
buildservice Apache (http://software.opensuse.org/download/Apache/). The
other ones are builds for the standard distro Apache.

Peter
-- 
Allen Gewalten zum Trutz sich erhalten.
 
SUSE LINUX Products GmbH
Research & Development
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070413/f772f1cb/attachment.bin
From graham.dumpleton at gmail.com  Sat Apr 14 03:28:42 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sat Apr 14 03:29:09 2007
Subject: [mod_python] make_obcallback: could not import mod_python. apache.
In-Reply-To: <BC60FF9B-5183-418A-AD8C-43632C8A1C12@gmx.de>
References: <BC60FF9B-5183-418A-AD8C-43632C8A1C12@gmx.de>
Message-ID: <88e286470704140028l526b3fdeic714a3bf84f727cf@mail.gmail.com>

If you don't have root access to the server, how did you get the
Apache mod_python.so module installed in the first place, or are you
using Apache out of your own account?

If you had to install the Python bits of mod_python in your own
account, the only choice, is to set the PYTHONPATH environment
variable in the user environment that Apache runs as to list where you
had to install stuff in your own directory. If Apache is run as root
though, you aren't going to be able to do that and if you could get
that done, you may as well get mod_python installed properly.

On 13/04/07, Jochen Wuttke <jochen.wuttke@gmx.de> wrote:
> Hi,
>
>
> Versions:
> Apache 2.2.3
> mod_python 3.3.1
>
> this is the error message:
>
> [Thu Apr 12 18:44:04 2007] [error] make_obcallback: could not import
> mod_python.
> apache.\n
> ImportError: No module named mod_python.apache
> [Thu Apr 12 18:44:04 2007] [error] make_obcallback: Python path being
> used "['/u
> sr/lib/python24.zip', '/usr/lib/python2.4', '/usr/lib/python2.4/plat-
> linux2', '/
> usr/lib/python2.4/lib-tk', '/usr/lib/python2.4/lib-dynload', '/usr/
> local/lib/pyt
> hon2.4/site-packages', '/usr/lib/python2.4/site-packages', '/var/lib/
> python-supp
> ort/python2.4']".
> [Thu Apr 12 18:44:04 2007] [error] get_interpreter: no interpreter
> callback foun
> d.
>
> I had to install a bunch of things in my $HOME on the server, and
> obviously that path is not listed here.
> I saw a previous post suggesting that one should fix the path python
> is looking for modules. Unfortunately I don't have root access on the
> server and can't do that. So I tried to place an appropriate
>
> PythonPath "sys.path + ['/the/path/in/my/home']"
>
> directive in the apache config:
>
> 1. Within a <Location>
> 2. Directly after the LoadModule statement (ClearModules is not used)
> 3. In the server config area.
>
> None of these directives changes the python path used when I try to
> access the test location. Any suggestions what I'm doing wrong?
>
> Jochen
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From wg at codingz.info  Sat Apr 14 18:40:24 2007
From: wg at codingz.info (Christophe C. T.)
Date: Sat Apr 14 18:40:26 2007
Subject: [mod_python] Supported Python version
Message-ID: <200704141940188031033@codingz.info>

Sorry for that but I have a a "silly" question, modpython doesn't works with Python >2.3 ?
When I install with the last python's version its say that python is not installed so I have uninstall them and install an older version of Python (2.3) and works fine!

Thanks!

Best regards,
Christophe from Brazil.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070414/10f22d5b/attachment.html
From graham.dumpleton at gmail.com  Sat Apr 14 20:32:40 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sat Apr 14 20:32:43 2007
Subject: [mod_python] Supported Python version
In-Reply-To: <200704141940188031033@codingz.info>
References: <200704141940188031033@codingz.info>
Message-ID: <88e286470704141732p1e276e11l12c0f1d83c49d6ad@mail.gmail.com>

On 15/04/07, Christophe C. T. <wg@codingz.info> wrote:
>
>
> Sorry for that but I have a a "silly" question, modpython doesn't works with
> Python >2.3 ?
> When I install with the last python's version its say that python is not
> installed so I have uninstall them and install an older version of Python
> (2.3) and works fine!

FYI, mod_python works fine with Python 2.3, 2.4 and 2.5.

Are you compiling from source code or using prepackage binaries?

Which operating system are you using?

Do you have multiple versions of Apache and/or Python installed on your system?

What are the error messages you get in the Apache error log?

Have you tried working through steps listed in:

  http://www.dscpl.com.au/wiki/ModPython/Articles/GettingModPythonWorking

to determine if the Python components of mod_python are installed
correctly and which version is installed?

Graham
From lists at stringsutils.com  Sat Apr 14 22:41:41 2007
From: lists at stringsutils.com (Francisco Reyes)
Date: Sun Apr 15 10:07:14 2007
Subject: [mod_python] Types of handlers in 3.3?
Message-ID: <cone.1176604901.528217.82378.1000@zoraida.natserv.net>

In the docs for 3.3 I see under the performance section:

Standard CGI:            23 requests/s
Mod_python cgihandler:  385 requests/s
Mod_python publisher:   476 requests/s
Mod_python handler:    1203 requests/s

What is the syntax to enable the "Mod_python handler"?

AddHandler mod_python .py
PythonHandler mod_python.handler
PythonDebug On

Didn't give me any errors when I did apachectl graceful but the sample 
program I tried gave an error.

I have a sample working using the publisher handler.
AddHandler mod_python .py
PythonHandler mod_python.publisher
PythonDebug On


Are "Mod_python handler" coded different from mod_python.publisher?

Is the "Mod_python handler" indicating the program itself as the handler?
I see in the documentation.

AddHandler mod_python .py
PythonHandler mptest
PythonDebug On

Where mptest is the program.

From list at joreybump.com  Sun Apr 15 11:36:02 2007
From: list at joreybump.com (Jorey Bump)
Date: Sun Apr 15 11:36:07 2007
Subject: [mod_python] Types of handlers in 3.3?
In-Reply-To: <cone.1176604901.528217.82378.1000@zoraida.natserv.net>
References: <cone.1176604901.528217.82378.1000@zoraida.natserv.net>
Message-ID: <46224662.6080909@joreybump.com>

Francisco Reyes wrote:
> In the docs for 3.3 I see under the performance section:
> 
> Standard CGI:            23 requests/s
> Mod_python cgihandler:  385 requests/s
> Mod_python publisher:   476 requests/s
> Mod_python handler:    1203 requests/s
> 
> What is the syntax to enable the "Mod_python handler"?
> 
> AddHandler mod_python .py
> PythonHandler mod_python.handler
> PythonDebug On
> 
> Didn't give me any errors when I did apachectl graceful but the sample 
> program I tried gave an error.

There is no mod_python.handler

> I have a sample working using the publisher handler.
> AddHandler mod_python .py
> PythonHandler mod_python.publisher
> PythonDebug On
> 
> Are "Mod_python handler" coded different from mod_python.publisher?

It's just an example using a custom handler, demonstrating a theoretical 
maximum without the overhead of the other handlers. Note that in 
practice, custom handlers will gain overhead as features are added.

> Is the "Mod_python handler" indicating the program itself as the handler?
> I see in the documentation.
> 
> AddHandler mod_python .py
> PythonHandler mptest
> PythonDebug On
> 
> Where mptest is the program.

It's a custom handler that you must write yourself to test mod_python.



From steino at ccri.net  Sun Apr 15 15:30:59 2007
From: steino at ccri.net (Olaf Stein)
Date: Sun Apr 15 15:31:23 2007
Subject: [mod_python] Protecting folders question
Message-ID: <C247F5B3.801%steino@ccri.net>

Hi all,

I am relatively new to mod_python and tried to find some online docs in this
topic, have not been very successful though.

Here is the scenario:

I have an app residing with htdocs/apps
Http.conf entries
-------

<Directory /usr/local/apache/htdocs/apps/>
     SetHandler mod_python
     PythonHandler mod_python.publisher
     PythonDebug On
</Directory>

-------

My html templates are sitting outside apps in /usr/local/apache/htdocs/tmpl
and I read those from there.

I also have a folder /usr/local/apache/htdocs/files where I copy files
uploaded by the users.

Now, obviously both these directories are viewable with a browser with no
restrictions (assuming one knows the entire path to a file, including the
file name).

I do not want anybody to have access those files without going through the
app.

I protected the directories with htaccess.
Now I have the problem that the browser wants a username and password when
the app loads the templates.

The questions are then:
- Does this setup make sense at all or should I place those folders and
files somewhere else (e.g within the app handler folder).

- If this makes sense, how can I access the files from within the app
without having to enter credentials (basically going around the
authentication process)

Thanks in advance

Olaf












From sdavis2 at mail.nih.gov  Sun Apr 15 16:15:30 2007
From: sdavis2 at mail.nih.gov (Sean Davis)
Date: Sun Apr 15 16:15:34 2007
Subject: [mod_python] Protecting folders question
In-Reply-To: <C247F5B3.801%steino@ccri.net>
References: <C247F5B3.801%steino@ccri.net>
Message-ID: <462287E2.6080902@mail.nih.gov>

Olaf Stein wrote:
> Hi all,
>
> I am relatively new to mod_python and tried to find some online docs in this
> topic, have not been very successful though.
>
> Here is the scenario:
>
> I have an app residing with htdocs/apps
> Http.conf entries
> -------
>
> <Directory /usr/local/apache/htdocs/apps/>
>      SetHandler mod_python
>      PythonHandler mod_python.publisher
>      PythonDebug On
> </Directory>
>
> -------
>
> My html templates are sitting outside apps in /usr/local/apache/htdocs/tmpl
> and I read those from there.
>
> I also have a folder /usr/local/apache/htdocs/files where I copy files
> uploaded by the users.
>
> Now, obviously both these directories are viewable with a browser with no
> restrictions (assuming one knows the entire path to a file, including the
> file name).
>
> I do not want anybody to have access those files without going through the
> app.
>
> I protected the directories with htaccess.
> Now I have the problem that the browser wants a username and password when
> the app loads the templates.
>
> The questions are then:
> - Does this setup make sense at all or should I place those folders and
> files somewhere else (e.g within the app handler folder).
>
> - If this makes sense, how can I access the files from within the app
> without having to enter credentials (basically going around the
> authentication process)
>   
The standard way of handling this is to not store those files in the 
htdocs directory.  Just make directories somewhere else in the file 
system and make sure they are readable and writable by the apache user.  
However, do not add a directory block in the http.conf file, so the 
directories will not be visible from the browser. 

Sean
From graham.dumpleton at gmail.com  Sun Apr 15 17:51:36 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sun Apr 15 17:51:53 2007
Subject: [mod_python] Types of handlers in 3.3?
In-Reply-To: <46224662.6080909@joreybump.com>
References: <cone.1176604901.528217.82378.1000@zoraida.natserv.net>
	<46224662.6080909@joreybump.com>
Message-ID: <88e286470704151451h35572d35w72ea6b9b9ac56cb7@mail.gmail.com>

You may find the following worth reading:

  http://www.dscpl.com.au/wiki/ModPython/Articles/GettingModPythonWorking
  http://www.dscpl.com.au/wiki/ModPython/Articles/SetHandlerVersusAddHandler

It may help to answer some of the questions you have and also some you
don't yet have.

Graham

On 16/04/07, Jorey Bump <list@joreybump.com> wrote:
> Francisco Reyes wrote:
> > In the docs for 3.3 I see under the performance section:
> >
> > Standard CGI:            23 requests/s
> > Mod_python cgihandler:  385 requests/s
> > Mod_python publisher:   476 requests/s
> > Mod_python handler:    1203 requests/s
> >
> > What is the syntax to enable the "Mod_python handler"?
> >
> > AddHandler mod_python .py
> > PythonHandler mod_python.handler
> > PythonDebug On
> >
> > Didn't give me any errors when I did apachectl graceful but the sample
> > program I tried gave an error.
>
> There is no mod_python.handler
>
> > I have a sample working using the publisher handler.
> > AddHandler mod_python .py
> > PythonHandler mod_python.publisher
> > PythonDebug On
> >
> > Are "Mod_python handler" coded different from mod_python.publisher?
>
> It's just an example using a custom handler, demonstrating a theoretical
> maximum without the overhead of the other handlers. Note that in
> practice, custom handlers will gain overhead as features are added.
>
> > Is the "Mod_python handler" indicating the program itself as the handler?
> > I see in the documentation.
> >
> > AddHandler mod_python .py
> > PythonHandler mptest
> > PythonDebug On
> >
> > Where mptest is the program.
>
> It's a custom handler that you must write yourself to test mod_python.
From graham.dumpleton at gmail.com  Sun Apr 15 17:54:38 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sun Apr 15 17:54:41 2007
Subject: [mod_python] Protecting folders question
In-Reply-To: <C247F5B3.801%steino@ccri.net>
References: <C247F5B3.801%steino@ccri.net>
Message-ID: <88e286470704151454q5266f297w49aee0a2e5c143c5@mail.gmail.com>

On 16/04/07, Olaf Stein <steino@ccri.net> wrote:

> - If this makes sense, how can I access the files from within the app
> without having to enter credentials (basically going around the
> authentication process)

That it is asking for authentication can only be because that is what
you have setup in your Apache configuration using AuthType etc
directives.

Graham
From prashanth.dumpuri at vanderbilt.edu  Tue Apr 17 01:37:12 2007
From: prashanth.dumpuri at vanderbilt.edu (Prashanth)
Date: Tue Apr 17 00:36:26 2007
Subject: [mod_python] handling multiple users with mod_python
Message-ID: <46245D08.1000601@vanderbilt.edu>

All,
  I have just started getting into web design and programming. I have to 
create a web page that can handle multiple logins/users. After logging 
in, the website has to cater to the individual needs of each user.

index.html - main interface page that has a login prompt.
login.py - verifies the authenticity of the user.
After logging in, the user is directed to the "jobs" page
job1.html and job1.py, job2.html and job2.py .... jobN.html and jobN.py 
- the html scripts accept files from the user and run the jobs described 
in the associated python scripts.
Results.html - page where the users can download the results from the 
above python scripts.

Since the results will be different for different users, I have to keep 
track of the users that login to the webpage and direct them 
accordingly. How do I pass the username from login.py to job1.py ?

(I created multiple usernames and passwords using .htpasswd. I'm using 
mod_python 3.3 and apache 2.0.59).

Any help in this regard will be greatly appreciated.
Prashanth






From graham.dumpleton at gmail.com  Tue Apr 17 01:07:36 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Apr 17 01:07:41 2007
Subject: [mod_python] handling multiple users with mod_python
In-Reply-To: <46245D08.1000601@vanderbilt.edu>
References: <46245D08.1000601@vanderbilt.edu>
Message-ID: <88e286470704162207p49ba6bcfg35df80f3252a7937@mail.gmail.com>

On 17/04/07, Prashanth <prashanth.dumpuri@vanderbilt.edu> wrote:
> All,
>   I have just started getting into web design and programming. I have to
> create a web page that can handle multiple logins/users. After logging
> in, the website has to cater to the individual needs of each user.
>
> index.html - main interface page that has a login prompt.
> login.py - verifies the authenticity of the user.
> After logging in, the user is directed to the "jobs" page
> job1.html and job1.py, job2.html and job2.py .... jobN.html and jobN.py
> - the html scripts accept files from the user and run the jobs described
> in the associated python scripts.
> Results.html - page where the users can download the results from the
> above python scripts.
>
> Since the results will be different for different users, I have to keep
> track of the users that login to the webpage and direct them
> accordingly. How do I pass the username from login.py to job1.py ?
>
> (I created multiple usernames and passwords using .htpasswd. I'm using
> mod_python 3.3 and apache 2.0.59).

You probably need some form of web server session management:

  http://en.wikipedia.org/wiki/Session_management#Web_Server_Session_Management

At the lowest level this is usually managed using browser cookies, or
forms of URL rewriting.

In mod_python you want to look at the Session class:

  http://www.modpython.org/live/current/doc-html/pyapi-sess.html

as an implementation of a cookie based system.

Graham
From mlh496 at gmail.com  Tue Apr 17 01:08:25 2007
From: mlh496 at gmail.com (Michael Harrison)
Date: Tue Apr 17 01:08:35 2007
Subject: [mod_python] Problem storing objects in session
Message-ID: <65baf90704162208ub96f62s62204b8d80c57e1a@mail.gmail.com>

I can store objects in session locally, but not on my production server.
Here are my computer specs:

Local: Windows, Apache 2.2, ModPython 3.3.1
Server: Linux, Apache 2.2, ModPython 3.3.1

Reading through past discussions, I understand there was a change in
ModPython 3.2 that did cause pickling problems when saving a session with
objects in it.  Has this been fixed?  If so, then apparently I need to tweak
my Apache configuration (not sure how).  If not, I can't find any discussion
that mentions this fact.

Thanks in advance,
-Michael Harrison (first time poster)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070416/6159aca5/attachment.html
From graham.dumpleton at gmail.com  Tue Apr 17 01:22:47 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Apr 17 01:22:54 2007
Subject: [mod_python] Problem storing objects in session
In-Reply-To: <65baf90704162208ub96f62s62204b8d80c57e1a@mail.gmail.com>
References: <65baf90704162208ub96f62s62204b8d80c57e1a@mail.gmail.com>
Message-ID: <88e286470704162222q18bb3b76q7eb15342e9cb7e97@mail.gmail.com>

On 17/04/07, Michael Harrison <mlh496@gmail.com> wrote:
> I can store objects in session locally, but not on my production server.

What is the actual error you are getting?

> Here are my computer specs:
>
> Local: Windows, Apache 2.2, ModPython 3.3.1
>  Server: Linux, Apache 2.2, ModPython 3.3.1
>
> Reading through past discussions, I understand there was a change in
> ModPython 3.2 that did cause pickling problems when saving a session with
> objects in it.  Has this been fixed?  If so, then apparently I need to tweak
> my Apache configuration (not sure how).  If not, I can't find any discussion
> that mentions this fact.

The changes started in 3.2 with mod_python.publisher and also applying
to basic handlers in 3.3, impose certain limitations as to what you
can pickle when a file system based session database is used. This is
documented at:

  http://www.dscpl.com.au/wiki/ModPython/Articles/IssuesWithSessionObjects

When running Windows an in memory session database is used and the
limitations do not apply. That is most likely why your code will not
port to Linux.

The only solution is to limit what data types you are pickling. This
of course is total speculation as you haven't said what the actual
error messages are that you are seeing in the error page or in your
logs.

Note that the limitations will not be removed unless the whole ability
to reload modules is given up.

Graham
From list at joreybump.com  Tue Apr 17 13:07:31 2007
From: list at joreybump.com (Jorey Bump)
Date: Tue Apr 17 13:07:47 2007
Subject: [mod_python] handling multiple users with mod_python
In-Reply-To: <46245D08.1000601@vanderbilt.edu>
References: <46245D08.1000601@vanderbilt.edu>
Message-ID: <4624FED3.4090205@joreybump.com>

Prashanth wrote:
> All,
>  I have just started getting into web design and programming. I have to 
> create a web page that can handle multiple logins/users. After logging 
> in, the website has to cater to the individual needs of each user.
> 
> index.html - main interface page that has a login prompt.
> login.py - verifies the authenticity of the user.
> After logging in, the user is directed to the "jobs" page
> job1.html and job1.py, job2.html and job2.py .... jobN.html and jobN.py 
> - the html scripts accept files from the user and run the jobs described 
> in the associated python scripts.
> Results.html - page where the users can download the results from the 
> above python scripts.
> 
> Since the results will be different for different users, I have to keep 
> track of the users that login to the webpage and direct them 
> accordingly. How do I pass the username from login.py to job1.py ?
> 
> (I created multiple usernames and passwords using .htpasswd. I'm using 
> mod_python 3.3 and apache 2.0.59).
> 
> Any help in this regard will be greatly appreciated.

Judging by your description, you can create the entire application in a 
single file, such as jobs.py. Handle your logic in that file and simply 
branch according to the GET, POST, or session variables. Scattering this 
across multiple pages will only complicate things. Certainly you can 
keep your jobN information in some kind of structure or database?

From prashanth.dumpuri at vanderbilt.edu  Tue Apr 17 18:32:45 2007
From: prashanth.dumpuri at vanderbilt.edu (Prashanth)
Date: Tue Apr 17 18:33:01 2007
Subject: [mod_python] REMOTE_USER key error question
In-Reply-To: <88e286470704162207p49ba6bcfg35df80f3252a7937@mail.gmail.com>
References: <46245D08.1000601@vanderbilt.edu>
	<88e286470704162207p49ba6bcfg35df80f3252a7937@mail.gmail.com>
Message-ID: <46254B0D.6030203@vanderbilt.edu>

All,

I'm trying to pick up REMOTE_USER from os.environ['REMOTE_USER'] and I 
get a key error as shown below:

------------------------------------------------------------------------------------------------------------------------------------------------------------
Mod_python error: "PythonHandler test"
Traceback (most recent call last):
File "/usr/lib/python2.4/site-packages/mod_python/apache.py", line 299, 
in HandlerDispatch
result = object(req)
File "/var/www/modelweb/restricted/test.py", line 17, in handler
req.write(os.environ['REMOTE_USER'])
KeyError: 'REMOTE_USER'

---------------------------------------------------------------------------------------------------------------------------------------------------------------
Using cgi.print_environ() returns nothing. I'm using apache 2 (and 
htpasswd), so I know REMOTE USER must be set.

Here's my directory structure:

index.html  in /var/www/modelweb - that challenges the user with a login 
prompt
test.py in /var/www/modelweb/restricted - that executes (or it's 
supposed to) if the user's login is successful.

Can someone help me figure out what's going on here ? Any help in this 
regard will be greatly appreciated.
Prashanth



From graham.dumpleton at gmail.com  Tue Apr 17 18:45:29 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Apr 17 18:45:39 2007
Subject: [mod_python] REMOTE_USER key error question
In-Reply-To: <46254B0D.6030203@vanderbilt.edu>
References: <46245D08.1000601@vanderbilt.edu>
	<88e286470704162207p49ba6bcfg35df80f3252a7937@mail.gmail.com>
	<46254B0D.6030203@vanderbilt.edu>
Message-ID: <88e286470704171545r427fada3of8a56166bf6295b9@mail.gmail.com>

On 18/04/07, Prashanth <prashanth.dumpuri@vanderbilt.edu> wrote:
> All,
>
> I'm trying to pick up REMOTE_USER from os.environ['REMOTE_USER'] and I
> get a key error as shown below:
>
> ------------------------------------------------------------------------------------------------------------------------------------------------------------
> Mod_python error: "PythonHandler test"
> Traceback (most recent call last):
> File "/usr/lib/python2.4/site-packages/mod_python/apache.py", line 299,
> in HandlerDispatch
> result = object(req)
> File "/var/www/modelweb/restricted/test.py", line 17, in handler
> req.write(os.environ['REMOTE_USER'])
> KeyError: 'REMOTE_USER'
>
> ---------------------------------------------------------------------------------------------------------------------------------------------------------------
> Using cgi.print_environ() returns nothing. I'm using apache 2 (and
> htpasswd), so I know REMOTE USER must be set.
>
> Here's my directory structure:
>
> index.html  in /var/www/modelweb - that challenges the user with a login
> prompt
> test.py in /var/www/modelweb/restricted - that executes (or it's
> supposed to) if the user's login is successful.
>
> Can someone help me figure out what's going on here ? Any help in this
> regard will be greatly appreciated.

If you are using AuthType directive then user is available as:

  req.user

Note that mod_python is not CGI, so don't apply CGI concepts to it.
You will not find CGI environment stuff in os.environ.

Graham
From sdavis2 at mail.nih.gov  Tue Apr 17 18:51:32 2007
From: sdavis2 at mail.nih.gov (Sean Davis)
Date: Tue Apr 17 18:51:39 2007
Subject: [mod_python] REMOTE_USER key error question
In-Reply-To: <46254B0D.6030203@vanderbilt.edu>
References: <46245D08.1000601@vanderbilt.edu>	<88e286470704162207p49ba6bcfg35df80f3252a7937@mail.gmail.com>
	<46254B0D.6030203@vanderbilt.edu>
Message-ID: <46254F74.5010302@mail.nih.gov>

Prashanth wrote:
> All,
>
> I'm trying to pick up REMOTE_USER from os.environ['REMOTE_USER'] and I 
> get a key error as shown below:
>
> ------------------------------------------------------------------------------------------------------------------------------------------------------------ 
>
> Mod_python error: "PythonHandler test"
> Traceback (most recent call last):
> File "/usr/lib/python2.4/site-packages/mod_python/apache.py", line 
> 299, in HandlerDispatch
> result = object(req)
> File "/var/www/modelweb/restricted/test.py", line 17, in handler
> req.write(os.environ['REMOTE_USER'])
> KeyError: 'REMOTE_USER'
>
> --------------------------------------------------------------------------------------------------------------------------------------------------------------- 
>
> Using cgi.print_environ() returns nothing. I'm using apache 2 (and 
> htpasswd), so I know REMOTE USER must be set.
See here:

http://www.modpython.org/live/current/doc-html/tut-more-complicated.html

Sean
From indyone at gmail.com  Thu Apr 19 11:21:05 2007
From: indyone at gmail.com (indyone ;o))
Date: Thu Apr 19 11:21:20 2007
Subject: [mod_python] Problem with mod_proxy + inputfilter + headers_in
Message-ID: <e79469d0704190821x12a0ffa9ve94e9d13e37898e6@mail.gmail.com>

Hi list,

I'm trying to get the headers_in from the client, and after changing/adding
some headers i would like to pass them to the backend server.
I'm using Apache/2.0.55 (Win32) mod_python/3.1.3 Python/2.3.5
The problem is that the headers are sent to the backend unchanged when using
this simple input filter:

def inputfilter(filter):

    filter.req.headers_in['X-MyHeader'] = 'Test'
    if filter.req.main is not None:
        filter.pass_on()
        return

    filter.req.log_error('Start %s' % filter.req.uri)
    s = filter.read()
    while s:
        filter.write(s)
        s = filter.read()
    if s is None:
        filter.close()
        filter.req.log_error('End %s' % filter.req.uri)

    filter.req.log_error('%s' % filter.req.headers_in)

and Apache logs:

[Thu Apr 19 18:17:28 2007] [error] [client 127.0.0.1] Start /, referer:
http://localhost/
[Thu Apr 19 18:17:28 2007] [error] [client 127.0.0.1] End /, referer:
http://localhost/
[Thu Apr 19 18:17:28 2007] [error] [client 127.0.0.1] {'X-MyHeader': 'Test',
'X-Forwarded-Server': 'luna', 'X-Forwarded-Host': 'localhost',
'X-Forwarded-For': '127.0.0.1', 'Max-Forwards': '10', 'Cookie': 'wstyle=;
__ac="YWRtaW46bWF0cml4";
tree-s="eJzT0MgpMOQKVneEAKcAN19bda4CI67EkgJjLj0AegYHmA"', 'Referer': '
http://localhost/', 'Accept-Charset': 'ISO-8859-7,utf-8;q=0.7,*;q=0.7',
'Accept-Encoding': 'gzip,deflate', 'Accept-Language': 'el,en-us;q=0.7,en;q=
0.3', 'Accept': 'text/xml,application/xml,application/xhtml+xml,text/html;q=
0.9,text/plain;q=0.8,image/png,*/*;q=0.5', 'User-Agent': 'Mozilla/5.0
(Windows; U; Windows NT 5.1; en-US; rv:1.8.0.8) Gecko/20061030
SeaMonkey/1.0.6', 'Host': 'localhost'}, referer: http://localhost/
...(multiple times)...

Which is right i think... But my backend server gets this request:

GET /VirtualHostBase/http/localhost:80/Editorial/VirtualHostRoot/ HTTP/1.1
Host: localhost:8081
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.0.8)
Gecko/20061030 SeaMonkey/1.0.6
Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9
,text/plain;q=0.8,image/png,*/*;q=0.5
Accept-Language: el,en-us;q=0.7,en;q=0.3
Accept-Encoding: gzip,deflate
Accept-Charset: ISO-8859-7,utf-8;q=0.7,*;q=0.7
Referer: http://localhost/
Cookie: wstyle=; __ac="YWRtaW46bWF0cml4";
tree-s="eJzT0MgpMOQKVneEAKcAN19bda4CI67EkgJjLj0AegYHmA"
Max-Forwards: 10
X-Forwarded-For: 127.0.0.1
X-Forwarded-Host: localhost
X-Forwarded-Server: luna

Thank you in advance,

Ioannis Stavrinos
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070419/bb5876e0/attachment.html
From graham.dumpleton at gmail.com  Thu Apr 19 17:53:30 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Apr 19 17:53:39 2007
Subject: [mod_python] Problem with mod_proxy + inputfilter + headers_in
In-Reply-To: <e79469d0704190821x12a0ffa9ve94e9d13e37898e6@mail.gmail.com>
References: <e79469d0704190821x12a0ffa9ve94e9d13e37898e6@mail.gmail.com>
Message-ID: <88e286470704191453o5b0b3c08u77b14064c1f58950@mail.gmail.com>

You can't use a mod_python input filter to modify incoming headers. If
the changes to the headers aren't intended to influence the behaviour
of what Apache does during access, authentication, authorisation and
type checking phases, use a PythonFixupHandler to update any headers
to then be used by the actual response handler.

Note, provided you are using mod_python 3.3, you can actually use
mod_python to trigger the proxying as well. See:

http://issues.apache.org/jira/browse/MODPYTHON-141

Graham

On 20/04/07, indyone ;o) <indyone@gmail.com> wrote:
> Hi list,
>
> I'm trying to get the headers_in from the client, and after changing/adding
> some headers i would like to pass them to the backend server.
> I'm using Apache/2.0.55 (Win32) mod_python/3.1.3 Python/2.3.5
> The problem is that the headers are sent to the backend unchanged when using
> this simple input filter:
>
> def inputfilter(filter):
>
>     filter.req.headers_in['X-MyHeader'] = 'Test'
>     if filter.req.main is not None:
>         filter.pass_on()
>         return
>
>     filter.req.log_error('Start %s' % filter.req.uri)
>     s = filter.read()
>     while s:
>         filter.write(s)
>         s = filter.read()
>     if s is None:
>         filter.close()
>         filter.req.log_error('End %s' % filter.req.uri)
>
>     filter.req.log_error('%s' % filter.req.headers_in)
>
> and Apache logs:
>
> [Thu Apr 19 18:17:28 2007] [error] [client 127.0.0.1] Start /, referer:
> http://localhost/
> [Thu Apr 19 18:17:28 2007] [error] [client 127.0.0.1] End /, referer:
> http://localhost/
> [Thu Apr 19 18:17:28 2007] [error] [client 127.0.0.1] {'X-MyHeader': 'Test',
> 'X-Forwarded-Server': 'luna', 'X-Forwarded-Host': 'localhost',
> 'X-Forwarded-For': ' 127.0.0.1', 'Max-Forwards': '10', 'Cookie': 'wstyle=;
> __ac="YWRtaW46bWF0cml4";
> tree-s="eJzT0MgpMOQKVneEAKcAN19bda4CI67EkgJjLj0AegYHmA"',
> 'Referer': ' http://localhost/', 'Accept-Charset':
> 'ISO-8859-7,utf-8;q=0.7,*;q=0.7', 'Accept-Encoding': 'gzip,deflate',
> 'Accept-Language': 'el,en-us;q=0.7 ,en;q=0.3', 'Accept':
> 'text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5',
> 'User-Agent': 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv: 1.8.0.8)
> Gecko/20061030 SeaMonkey/1.0.6', 'Host': 'localhost'}, referer:
> http://localhost/
> ...(multiple times)...
>
> Which is right i think... But my backend server gets this request:
>
> GET
> /VirtualHostBase/http/localhost:80/Editorial/VirtualHostRoot/
> HTTP/1.1
> Host: localhost:8081
> User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.0.8)
> Gecko/20061030 SeaMonkey/1.0.6
> Accept:
> text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
> Accept-Language: el,en-us;q=0.7,en;q=0.3
> Accept-Encoding: gzip,deflate
> Accept-Charset: ISO-8859-7,utf-8;q= 0.7,*;q=0.7
> Referer: http://localhost/
> Cookie: wstyle=; __ac="YWRtaW46bWF0cml4";
> tree-s="eJzT0MgpMOQKVneEAKcAN19bda4CI67EkgJjLj0AegYHmA"
> Max-Forwards: 10
> X-Forwarded-For: 127.0.0.1
> X-Forwarded-Host: localhost
> X-Forwarded-Server: luna
>
> Thank you in advance,
>
> Ioannis Stavrinos
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
From prashanth.dumpuri at vanderbilt.edu  Thu Apr 19 22:20:48 2007
From: prashanth.dumpuri at vanderbilt.edu (Prashanth)
Date: Thu Apr 19 21:19:52 2007
Subject: [mod_python] req.write - display in same page
In-Reply-To: <88e286470704171545r427fada3of8a56166bf6295b9@mail.gmail.com>
References: <46245D08.1000601@vanderbilt.edu>	
	<88e286470704162207p49ba6bcfg35df80f3252a7937@mail.gmail.com>	
	<46254B0D.6030203@vanderbilt.edu>
	<88e286470704171545r427fada3of8a56166bf6295b9@mail.gmail.com>
Message-ID: <46282380.5050008@vanderbilt.edu>

All,
  Can someone please direct me on how to display messages written to the 
browser using req.write() in the same page ?
Thanks
Prashanth

From graham.dumpleton at gmail.com  Thu Apr 19 21:28:15 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Apr 19 21:28:22 2007
Subject: [mod_python] req.write - display in same page
In-Reply-To: <46282380.5050008@vanderbilt.edu>
References: <46245D08.1000601@vanderbilt.edu>
	<88e286470704162207p49ba6bcfg35df80f3252a7937@mail.gmail.com>
	<46254B0D.6030203@vanderbilt.edu>
	<88e286470704171545r427fada3of8a56166bf6295b9@mail.gmail.com>
	<46282380.5050008@vanderbilt.edu>
Message-ID: <88e286470704191828t6d298cfaka37f1624d8958f1f@mail.gmail.com>

On 20/04/07, Prashanth <prashanth.dumpuri@vanderbilt.edu> wrote:
> All,
>   Can someone please direct me on how to display messages written to the
> browser using req.write() in the same page ?

I think you are going to have that explain that a bit better, as have
no idea what you are asking.

Graham
From roberto at connexer.com  Thu Apr 19 21:28:30 2007
From: roberto at connexer.com (Roberto =?iso-8859-1?Q?C=2E_S=E1nchez?=)
Date: Thu Apr 19 21:28:35 2007
Subject: [mod_python] req.write - display in same page
In-Reply-To: <46282380.5050008@vanderbilt.edu>
References: <46245D08.1000601@vanderbilt.edu>
	<88e286470704162207p49ba6bcfg35df80f3252a7937@mail.gmail.com>
	<46254B0D.6030203@vanderbilt.edu>
	<88e286470704171545r427fada3of8a56166bf6295b9@mail.gmail.com>
	<46282380.5050008@vanderbilt.edu>
Message-ID: <20070420012830.GB815@miami.connexer.com>

On Thu, Apr 19, 2007 at 08:20:48PM -0600, Prashanth wrote:
> All,
>  Can someone please direct me on how to display messages written to the 
> browser using req.write() in the same page ?
> Thanks
> Prashanth
> 
What are you trying to accomplish?

Regards,

-Roberto

-- 
Roberto C. S?nchez
http://people.connexer.com/~roberto
http://www.connexer.com
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070419/5f286cbc/attachment.bin
From prashanth.dumpuri at vanderbilt.edu  Thu Apr 19 22:44:39 2007
From: prashanth.dumpuri at vanderbilt.edu (Prashanth)
Date: Thu Apr 19 21:43:51 2007
Subject: [mod_python] req.write - display in same page
In-Reply-To: <88e286470704191828t6d298cfaka37f1624d8958f1f@mail.gmail.com>
References: <46245D08.1000601@vanderbilt.edu>	
	<88e286470704162207p49ba6bcfg35df80f3252a7937@mail.gmail.com>	
	<46254B0D.6030203@vanderbilt.edu>	
	<88e286470704171545r427fada3of8a56166bf6295b9@mail.gmail.com>	
	<46282380.5050008@vanderbilt.edu>
	<88e286470704191828t6d298cfaka37f1624d8958f1f@mail.gmail.com>
Message-ID: <46282917.7020309@vanderbilt.edu>

Graham and Roberto,
Apologies for not being clear in my earlier post.

The following is a part of my HTML code (called index.html) that accepts 
a file from users, reads and then processes it

<form action="python/cgi-bin/getFile" method="post" 
enctype="multipart/form-data">
<input type="file" name="file" />
<input type="submit" name="submit" value="Submit" />
</form>

Here's my python script (readFile.py) that handles reading the file 
(that is uploaded by the user)

from mod_python import apache
from mod_python.util import FieldStorage
def handler(req):
req.content_type = "text/plain"
form = FieldStorage(req)
for field in form.list:
fname = field.filename
ext = fname.split(".")

# desired file extension for me is .nml
if (ext != ".nml):
req.write("Please input a file with .nml extension")
else:
req.write("File has the desired extension..proceeding to process it")


The way it stands req.write is printing the messages in a reloaded 
window/ fresh page. Is there a way to print messages from req.write in 
the same page ? In other words, req.write is writing its messages to 
http://localhost/index.html/readFile.py. Can I force req.write to write 
the messages to http://localhost/index.html ?

Thanks
Prashanth



From graham.dumpleton at gmail.com  Thu Apr 19 21:53:31 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Apr 19 21:53:35 2007
Subject: [mod_python] req.write - display in same page
In-Reply-To: <46282917.7020309@vanderbilt.edu>
References: <46245D08.1000601@vanderbilt.edu>
	<88e286470704162207p49ba6bcfg35df80f3252a7937@mail.gmail.com>
	<46254B0D.6030203@vanderbilt.edu>
	<88e286470704171545r427fada3of8a56166bf6295b9@mail.gmail.com>
	<46282380.5050008@vanderbilt.edu>
	<88e286470704191828t6d298cfaka37f1624d8958f1f@mail.gmail.com>
	<46282917.7020309@vanderbilt.edu>
Message-ID: <88e286470704191853p1a8ee9d7t972b2e14c93c4add@mail.gmail.com>

On 20/04/07, Prashanth <prashanth.dumpuri@vanderbilt.edu> wrote:
> Graham and Roberto,
> Apologies for not being clear in my earlier post.
>
> The following is a part of my HTML code (called index.html) that accepts
> a file from users, reads and then processes it
>
> <form action="python/cgi-bin/getFile" method="post"
> enctype="multipart/form-data">
> <input type="file" name="file" />
> <input type="submit" name="submit" value="Submit" />
> </form>
>
> Here's my python script (readFile.py) that handles reading the file
> (that is uploaded by the user)
>
> from mod_python import apache
> from mod_python.util import FieldStorage
> def handler(req):
> req.content_type = "text/plain"
> form = FieldStorage(req)
> for field in form.list:
> fname = field.filename
> ext = fname.split(".")
>
> # desired file extension for me is .nml
> if (ext != ".nml):
> req.write("Please input a file with .nml extension")
> else:
> req.write("File has the desired extension..proceeding to process it")
>
>
> The way it stands req.write is printing the messages in a reloaded
> window/ fresh page. Is there a way to print messages from req.write in
> the same page ? In other words, req.write is writing its messages to
> http://localhost/index.html/readFile.py. Can I force req.write to write
> the messages to http://localhost/index.html ?

Only by using JavaScript and AJAX like magic. See:

  http://en.wikipedia.org/wiki/AJAX

That or perhaps resort to using HTML frames in some way.

Graham
From nlv11281 at natlab.research.philips.com  Fri Apr 20 06:48:29 2007
From: nlv11281 at natlab.research.philips.com (Mike Looijmans)
Date: Fri Apr 20 06:48:43 2007
Subject: [mod_python] req.write - display in same page
In-Reply-To: <46282917.7020309@vanderbilt.edu>
References: <46245D08.1000601@vanderbilt.edu>		<88e286470704162207p49ba6bcfg35df80f3252a7937@mail.gmail.com>		<46254B0D.6030203@vanderbilt.edu>		<88e286470704171545r427fada3of8a56166bf6295b9@mail.gmail.com>		<46282380.5050008@vanderbilt.edu>	<88e286470704191828t6d298cfaka37f1624d8958f1f@mail.gmail.com>
	<46282917.7020309@vanderbilt.edu>
Message-ID: <46289A7D.8060801@natlab.research.philips.com>

In any web application, the solution is to display the same page again 
with the error message added. To the end-user, that has the effect of 
displaying it on the page (which you probably want because the user is 
likely to want to correct the mistake and try again). On success, you 
can redirect to another page to continue the process.

--
Mike Looijmans
Philips Natlab / Topic Automation


Prashanth wrote:
> Graham and Roberto,
> Apologies for not being clear in my earlier post.
> 
> The following is a part of my HTML code (called index.html) that accepts 
> a file from users, reads and then processes it
> 
> <form action="python/cgi-bin/getFile" method="post" 
> enctype="multipart/form-data">
> <input type="file" name="file" />
> <input type="submit" name="submit" value="Submit" />
> </form>
> 
> Here's my python script (readFile.py) that handles reading the file 
> (that is uploaded by the user)
> 
> from mod_python import apache
> from mod_python.util import FieldStorage
> def handler(req):
> req.content_type = "text/plain"
> form = FieldStorage(req)
> for field in form.list:
> fname = field.filename
> ext = fname.split(".")
> 
> # desired file extension for me is .nml
> if (ext != ".nml):
> req.write("Please input a file with .nml extension")
> else:
> req.write("File has the desired extension..proceeding to process it")
> 
> 
> The way it stands req.write is printing the messages in a reloaded 
> window/ fresh page. Is there a way to print messages from req.write in 
> the same page ? In other words, req.write is writing its messages to 
> http://localhost/index.html/readFile.py. Can I force req.write to write 
> the messages to http://localhost/index.html ?
> 
> Thanks
> Prashanth

From midreth at gmail.com  Fri Apr 20 11:28:55 2007
From: midreth at gmail.com (Ruben K.)
Date: Fri Apr 20 11:29:20 2007
Subject: [mod_python] using FieldStorage without publishing handler
Message-ID: <57f09d600704200828l4a35f66eg38e5bb1a98894038@mail.gmail.com>

Hello,

I was wondering if it is possible to use FieldStorage for POST data and FILE
data
without having to use the publishing handler. Is it possible? How would I go
about this?

The only kind of data I have been able to get with it is GET data

Regards,
Ruben K.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070420/f5e1987c/attachment-0001.html
From nferrier at tapsellferrier.co.uk  Fri Apr 20 11:56:08 2007
From: nferrier at tapsellferrier.co.uk (Nic James Ferrier)
Date: Fri Apr 20 11:55:13 2007
Subject: [mod_python] using FieldStorage without publishing handler
In-Reply-To: <57f09d600704200828l4a35f66eg38e5bb1a98894038@mail.gmail.com>
	(Ruben K.'s message of "Fri\, 20 Apr 2007 17\:28\:55 +0200")
References: <57f09d600704200828l4a35f66eg38e5bb1a98894038@mail.gmail.com>
Message-ID: <87zm53kpk7.fsf@kanga.tapsellferrier.co.uk>

"Ruben K." <midreth@gmail.com> writes:

> Hello,
>
> I was wondering if it is possible to use FieldStorage for POST data and FILE
> data
> without having to use the publishing handler. Is it possible? How would I go
> about this?
>
> The only kind of data I have been able to get with it is GET data

I think you must be doing something wrong because it just works:

  def handler(http):
      params = util.FieldStorage(http)
      for field in params.list:
          print >>http, 
               """<span class="%s">%s</span>""" %
                       (field.name, field.value)

will spit out some values with GET or POST.

It seems to prefer either one of the URI args or the
multipart/form-data args so if you're doing this:

  POST /someuri?name=value
  content-type: application/x-www-form-urlencoded
  other=value

then you need to have something combines the two.

I use this:

  def http_params(http):
      mod_python_form = util.FieldStorage(http)
      fields = mod_python_form.list
      result_dict = {}
      try:
          result_dict = util.parse_qs(http.args, True)
      except TypeError:
          # The above can produce an error coz http.args is None
          pass

      for field in fields:
          result_dict[field.name] = field.value
      return result_dict

But this also normalizes the fielstorage to a normal dict and I
suspect there is more elegant python that will do the job much better.

-- 
Nic Ferrier
http://www.tapsellferrier.co.uk   
From python at longlost.info  Sun Apr 22 05:34:32 2007
From: python at longlost.info (python@longlost.info)
Date: Sun Apr 22 05:39:01 2007
Subject: [mod_python] Exposing additional C APIs
Message-ID: <20070422093432.GA32765@blim.org>

Hi,

I've written an apache module encapsulating a data structure and ideally I would like to expose the API to scripts running within mod_python.  My guess is that there is no way to do this right now - but it can't hurt to ask, right?

I was looking into the 'providers' API in the apache portability runtime.  Maybe mod_python could be extended to with a PythonImportProvider directive which allows other apache modules to import their Python API into a python interpreter?  Similar to the existing PythonImport directive.

Thanks in advance for any help/thoughts,

Lee
From graham.dumpleton at gmail.com  Sun Apr 22 06:03:28 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sun Apr 22 06:03:33 2007
Subject: [mod_python] Exposing additional C APIs
In-Reply-To: <20070422093432.GA32765@blim.org>
References: <20070422093432.GA32765@blim.org>
Message-ID: <88e286470704220303v3c86838ew31915c2d64bc2ade@mail.gmail.com>

On 22/04/07, python@longlost.info <python@longlost.info> wrote:
> Hi,
>
> I've written an apache module encapsulating a data structure and ideally I would like to expose the API to scripts running within mod_python.  My guess is that there is no way to do this right now - but it can't hurt to ask, right?
>
> I was looking into the 'providers' API in the apache portability runtime.  Maybe mod_python could be extended to with a PythonImportProvider directive which allows other apache modules to import their Python API into a python interpreter?  Similar to the existing PythonImport directive.
>
> Thanks in advance for any help/thoughts,

There are a couple of ways you can go about it, although it is very
much virgin territory for development and using parts of mod_python
that aren't really officially designated public, but more for
experimentation only. Thus these parts of mod_python can possibly
change in the future.

First is that mod_python exports hooks which can be used to
acquire/release designated Python interpreter instances and get hold
of the request object for a request_rec. A separate Apache module can
use these to get to the request object and set an attribute of the
request object to some externally created Python object.

For this approach, see:

  http://issues.apache.org/jira/browse/MODPYTHON-165

The second way of possibly going about it is to use the fact that
there are Python CObject references for the underlying Apache
request_rec structure available in the Python request object as
'_request_rec' attribute. This could be passed into a custom Python
module which uses the request_rec to get access to some data
associated with a different Apache module and then returns a Python
object which wraps that data or translates it into a Python only
object. This custom module could be created by hand or could be
generated using SWIG in some way.

I have previously posted an example that does a similar thing before,
although it predates the '_request_rec' attribute so could be done in
better ways now. For this see:

  http://www.modpython.org/pipermail/mod_python/2005-November/019609.html

FWIW, I have Python SWIG bindings for most of the Apache and Apache
Runtime Libraries which I have been playing with. It is probably
somewhat impractical to utilise these in any way in mod_python itself
now due to the way the code was developed, but am looking at making it
possible to hook certain phases of Apache in mod_wsgi with everything
in Python side then being done using the Python SWIG bindings. Also
looking at the concept of being able to develop true Apache modules in
Python, including addition of configuration directives. This though
will all be independent of mod_python though.

Graham
From python at longlost.info  Sun Apr 22 11:06:24 2007
From: python at longlost.info (python@longlost.info)
Date: Sun Apr 22 11:10:46 2007
Subject: [mod_python] Exposing additional C APIs
In-Reply-To: <88e286470704220303v3c86838ew31915c2d64bc2ade@mail.gmail.com>
Message-ID: <20070422150624.GA558@blim.org>

Thanks for the comprehensive reply.  I'll take a look at the exported hooks approach first to see if I can get something working that way.

Many thanks,

Lee
From tms43 at clearwire.net  Mon Apr 23 12:31:24 2007
From: tms43 at clearwire.net (Teresa Stanton)
Date: Mon Apr 23 12:31:40 2007
Subject: [mod_python] Apache2 won't start after changing config file with
	Load mod_py...
Message-ID: <002b01c785c4$d7087b50$9200a8c0@samiam>

I installed mod_python 3.3.1 to use with my python 2.5 and Apache 2.0.58.
Using the config information found in the following web site:

http://www.dscpl.com.au/wiki/ModPython/Articles/GettingModPythonWorking

I added this line:

LoadModule python_module modules/mod_python.so

The only change I made is in the path, 'libexec' should be 'modules' on my
Windows XP.  When I try to start the server, it won't start at all.  There
are no error files because it won't start.

Unfortunately I have to run the python files I'm using in Windows.  I'm
trying to use VideoCapture for a project in a python class.  I will be
writing a script that will allow me to grab images that have been taken by
any one of 3 different cameras.  But, I gotta get this Apache server running
with mod_Py first.  Can anyone help me? 

T


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070423/dd8fa902/attachment.html
From seanglover at sympatico.ca  Mon Apr 23 14:53:07 2007
From: seanglover at sympatico.ca (Sean Glover)
Date: Mon Apr 23 14:55:04 2007
Subject: [mod_python] mod_python,
	python_handler error "Can't get/create interpreter"
Message-ID: <BAYC1-PASMTP04ylF1P00011ed1@bayc1-pasmtp04.bayc1.hotmail.com>

Hello, I recently started using python 2.5 on my FreeBSD machine.  I had a
version of mod_python up and running (sorry, I don't recall which one)
against python 2.4.  I used the ports packages system to install mod_python
3.3.1 without incident.  It replaced the old mod_python.so module and put
the necessary python modules in my python2.5 site-packages directory.  I
left my httpd.conf configuration the same, restarted, and hit my mod_python
test page and receive an internal server error.  Below is a paste from my
httpd-error.log.

Could anyone suggest a solution to get mod_python (with python 2.5) working
with my apache 2.2 server again?

Cheers,

Sean

# mod_python.so module

-rwxr-xr-x  1 root  wheel  122135 Apr 23 12:43
/usr/local/libexec/apache22/mod_python.so

 

# mod_python python modules (/usr/local/lib/python2.5/site-packages)

drwxr-xr-x   2 root  wheel    1024 Apr 23 12:43 mod_python

-rw-r--r--   1 root  wheel     254 Apr 23 12:43
mod_python-3.3.1-py2.5.egg-info

 

# apache httpd.conf file entry

LoadModule python_module libexec/apache22/mod_python.so

 

# test .htaccess (http://randonom.com/test/python/mptest.py)

AddHandler mod_python .py

PythonHandler mptest

PythonDebug On

 

# httpd-error.log after hitting the URL above ^

[Mon Apr 23 13:37:40 2007] [error] get_interpreter: no interpreter callback
found.

[Mon Apr 23 13:37:40 2007] [error] [client 65.36.178.226] python_handler:
Can't get/create interpreter. 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070423/bedbf6b2/attachment.html
From graham.dumpleton at gmail.com  Mon Apr 23 17:54:14 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Apr 23 17:54:19 2007
Subject: [mod_python] Apache2 won't start after changing config file with
	Load mod_py...
In-Reply-To: <002b01c785c4$d7087b50$9200a8c0@samiam>
References: <002b01c785c4$d7087b50$9200a8c0@samiam>
Message-ID: <88e286470704231454o13a3772fo4a417ac927167b73@mail.gmail.com>

On 24/04/07, Teresa Stanton <tms43@clearwire.net> wrote:
>
>
>
> I installed mod_python 3.3.1 to use with my python 2.5 and Apache 2.0.58.
> Using the config information found in the following web site:
>
> http://www.dscpl.com.au/wiki/ModPython/Articles/GettingModPythonWorking
>
> I added this line:
>
> LoadModule python_module modules/mod_python.so
>
> The only change I made is in the path, 'libexec' should be 'modules' on my
> Windows XP.  When I try to start the server, it won't start at all.  There
> are no error files because it won't start.
>
> Unfortunately I have to run the python files I'm using in Windows.  I'm
> trying to use VideoCapture for a project in a python class.  I will be
> writing a script that will allow me to grab images that have been taken by
> any one of 3 different cameras.  But, I gotta get this Apache server running
> with mod_Py first.  Can anyone help me?

The usual reasons for a complete inability to start Apache on Windows are:

1. You are using the wrong version of mod_python binary installer for
the version of Apache you are using.

2. You are missing the required Microsoft Visual C++ runtime DLLs
which mod_python requires exist.

3. You have a problem with access privileges whereby you are running
Apache as some special user and that user does not have access rights
to read the mod_python Apache module, the C++ runtime DLLs or some
other files required by mod_python.

Someone else will have to comment on what the C++ runtime DLLs are
that are required as I don't know the exact details. If you use the
search box on www.modpython.org site to search the archive of old
mailing list posts you might possibly find the information though.

Graham
From tms43 at clearwire.net  Mon Apr 23 18:01:07 2007
From: tms43 at clearwire.net (Teresa Stanton)
Date: Mon Apr 23 18:01:15 2007
Subject: [mod_python] Apache2 won't start after changing config file with
	Load mod_py...
In-Reply-To: <88e286470704231454o13a3772fo4a417ac927167b73@mail.gmail.com>
References: <002b01c785c4$d7087b50$9200a8c0@samiam>
	<88e286470704231454o13a3772fo4a417ac927167b73@mail.gmail.com>
Message-ID: <000c01c785f2$e6b68690$9200a8c0@samiam>

Thank you.  I used the mod_Python installer for python 2.5, and Apache 2, I
have Microsoft Visual C++ installed on my computer (I don't know if that
makes a difference), I am the administrator on this computer and am running
in administrator mode.

I will do the search on the C++ runime DLLs to make sure that isn't a
problem..

I do get this message when I run the configuration test:

Syntax error on line 174 of C:/Program Files/Apache
Group/Apache2/conf/httpd.con
f:
Can't locate API module structure `mod_python' in file C:/Program
Files/Apache G
roup/Apache2/modules/mod_python.so: No error

If that makes it any clearer.  I hadn't run the config test previously, but
it was suggested by someone else.

Ty

T
-----Original Message-----
From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com] 
Sent: Monday, April 23, 2007 2:54 PM
To: Teresa Stanton
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Apache2 won't start after changing config file
with Load mod_py...

On 24/04/07, Teresa Stanton <tms43@clearwire.net> wrote:
>
>
>
> I installed mod_python 3.3.1 to use with my python 2.5 and Apache 2.0.58.
> Using the config information found in the following web site:
>
> http://www.dscpl.com.au/wiki/ModPython/Articles/GettingModPythonWorkin
> g
>
> I added this line:
>
> LoadModule python_module modules/mod_python.so
>
> The only change I made is in the path, 'libexec' should be 'modules' 
> on my Windows XP.  When I try to start the server, it won't start at 
> all.  There are no error files because it won't start.
>
> Unfortunately I have to run the python files I'm using in Windows.  
> I'm trying to use VideoCapture for a project in a python class.  I 
> will be writing a script that will allow me to grab images that have 
> been taken by any one of 3 different cameras.  But, I gotta get this 
> Apache server running with mod_Py first.  Can anyone help me?

The usual reasons for a complete inability to start Apache on Windows are:

1. You are using the wrong version of mod_python binary installer for the
version of Apache you are using.

2. You are missing the required Microsoft Visual C++ runtime DLLs which
mod_python requires exist.

3. You have a problem with access privileges whereby you are running Apache
as some special user and that user does not have access rights to read the
mod_python Apache module, the C++ runtime DLLs or some other files required
by mod_python.

Someone else will have to comment on what the C++ runtime DLLs are that are
required as I don't know the exact details. If you use the search box on
www.modpython.org site to search the archive of old mailing list posts you
might possibly find the information though.

Graham


From graham.dumpleton at gmail.com  Mon Apr 23 18:02:00 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Apr 23 18:02:07 2007
Subject: [mod_python] mod_python,
	python_handler error "Can't get/create interpreter"
In-Reply-To: <BAYC1-PASMTP04ylF1P00011ed1@bayc1-pasmtp04.bayc1.hotmail.com>
References: <BAYC1-PASMTP04ylF1P00011ed1@bayc1-pasmtp04.bayc1.hotmail.com>
Message-ID: <88e286470704231502w7c5c85f1lde9963fa7bfea788@mail.gmail.com>

On 24/04/07, Sean Glover <seanglover@sympatico.ca> wrote:
> Hello, I recently started using python 2.5 on my FreeBSD machine.  I had a
> version of mod_python up and running (sorry, I don't recall which one)
> against python 2.4.  I used the ports packages system to install mod_python
> 3.3.1 without incident.  It replaced the old mod_python.so module and put
> the necessary python modules in my python2.5 site-packages directory.  I
> left my httpd.conf configuration the same, restarted,

When replacing mod_python version, always a good idea to do a 'stop'
and 'start' rather than a 'restart', but presuming you would have
eventually tried that.

> and hit my mod_python
> test page and receive an internal server error.  Below is a paste from my
> httpd-error.log.
>
> Could anyone suggest a solution to get mod_python (with python 2.5) working
> with my apache 2.2 server again?

How many versions of Python do you have installed on your system?

I would probably guess you have older version of Python in /usr/bin
still and Python when being initialised within mod_python is finding
that old version, but the old version doesn't have the mod_python
Python bits.

Try setting the PATH environment variable for the user that runs
Apache to have /usr/local/bin first in the path so that it finds the
version of Python you want used before the operating system default
version.

BTW, are you sure there weren't a series of other error messages prior
to those you quoted. Can you include the dozen of so lines before that
point?

Graham

> # mod_python.so module
>
> -rwxr-xr-x  1 root  wheel  122135 Apr 23 12:43
> /usr/local/libexec/apache22/mod_python.so
>
>
>
> # mod_python python modules (/usr/local/lib/python2.5/site-packages)
>
> drwxr-xr-x   2 root  wheel    1024 Apr 23 12:43 mod_python
>
> -rw-r--r--   1 root  wheel     254 Apr 23 12:43
> mod_python-3.3.1-py2.5.egg-info
>
>
>
> # apache httpd.conf file entry
>
> LoadModule python_module libexec/apache22/mod_python.so
>
>
>
> # test .htaccess
> (http://randonom.com/test/python/mptest.py)
>
> AddHandler mod_python .py
>
> PythonHandler mptest
>
> PythonDebug On
>
>
>
> # httpd-error.log after hitting the URL above ^
>
> [Mon Apr 23 13:37:40 2007] [error] get_interpreter: no interpreter callback
> found.
>
> [Mon Apr 23 13:37:40 2007] [error] [client 65.36.178.226] python_handler:
> Can't get/create interpreter.
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
From graham.dumpleton at gmail.com  Mon Apr 23 18:05:42 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Apr 23 18:05:46 2007
Subject: [mod_python] Apache2 won't start after changing config file with
	Load mod_py...
In-Reply-To: <000c01c785f2$e6b68690$9200a8c0@samiam>
References: <002b01c785c4$d7087b50$9200a8c0@samiam>
	<88e286470704231454o13a3772fo4a417ac927167b73@mail.gmail.com>
	<000c01c785f2$e6b68690$9200a8c0@samiam>
Message-ID: <88e286470704231505i2bdb4794oefc5a71db3a29b0c@mail.gmail.com>

That error generally means that the mod_python module is built for a
different version of Apache than what you are using. That or you are
using some distribution of Apache that wasn't what was built against.

Where did you get your Apache and mod_python installers and what were
the exact names of the installer files?

Graham

On 24/04/07, Teresa Stanton <tms43@clearwire.net> wrote:
> Thank you.  I used the mod_Python installer for python 2.5, and Apache 2, I
> have Microsoft Visual C++ installed on my computer (I don't know if that
> makes a difference), I am the administrator on this computer and am running
> in administrator mode.
>
> I will do the search on the C++ runime DLLs to make sure that isn't a
> problem..
>
> I do get this message when I run the configuration test:
>
> Syntax error on line 174 of C:/Program Files/Apache
> Group/Apache2/conf/httpd.con
> f:
> Can't locate API module structure `mod_python' in file C:/Program
> Files/Apache G
> roup/Apache2/modules/mod_python.so: No error
>
> If that makes it any clearer.  I hadn't run the config test previously, but
> it was suggested by someone else.
>
> Ty
>
> T
> -----Original Message-----
> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
> Sent: Monday, April 23, 2007 2:54 PM
> To: Teresa Stanton
> Cc: mod_python@modpython.org
> Subject: Re: [mod_python] Apache2 won't start after changing config file
> with Load mod_py...
>
> On 24/04/07, Teresa Stanton <tms43@clearwire.net> wrote:
> >
> >
> >
> > I installed mod_python 3.3.1 to use with my python 2.5 and Apache 2.0.58.
> > Using the config information found in the following web site:
> >
> > http://www.dscpl.com.au/wiki/ModPython/Articles/GettingModPythonWorkin
> > g
> >
> > I added this line:
> >
> > LoadModule python_module modules/mod_python.so
> >
> > The only change I made is in the path, 'libexec' should be 'modules'
> > on my Windows XP.  When I try to start the server, it won't start at
> > all.  There are no error files because it won't start.
> >
> > Unfortunately I have to run the python files I'm using in Windows.
> > I'm trying to use VideoCapture for a project in a python class.  I
> > will be writing a script that will allow me to grab images that have
> > been taken by any one of 3 different cameras.  But, I gotta get this
> > Apache server running with mod_Py first.  Can anyone help me?
>
> The usual reasons for a complete inability to start Apache on Windows are:
>
> 1. You are using the wrong version of mod_python binary installer for the
> version of Apache you are using.
>
> 2. You are missing the required Microsoft Visual C++ runtime DLLs which
> mod_python requires exist.
>
> 3. You have a problem with access privileges whereby you are running Apache
> as some special user and that user does not have access rights to read the
> mod_python Apache module, the C++ runtime DLLs or some other files required
> by mod_python.
>
> Someone else will have to comment on what the C++ runtime DLLs are that are
> required as I don't know the exact details. If you use the search box on
> www.modpython.org site to search the archive of old mailing list posts you
> might possibly find the information though.
>
> Graham
>
>
>
From greg at vig.co.nz  Mon Apr 23 18:33:49 2007
From: greg at vig.co.nz (Greg Fawcett)
Date: Mon Apr 23 18:33:54 2007
Subject: [mod_python] Streaming output
Message-ID: <928306280704231533g31951251lcd2f9936187e21f0@mail.gmail.com>

Hi -

Is there any way to stream output to a request object, instead of using
req.write()? My application has to serve PDF documents (sometimes several
tens of megabytes long). Access to these has to be controlled, and they are
encrypted, so I can't just expose them as normal files to apache. PHP has a
useful function passthru(command) which will run command and stream the
output directly back to the client - is there any equivalent in python?

On a related note, how "direct" is req.write()? I'd hate it to be buffering
the whole PDF up somewhere along the line, before sending it to the client.

Thanks in advance.

Greg Fawcett.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070424/463422fe/attachment.html
From graham.dumpleton at gmail.com  Mon Apr 23 18:44:03 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Apr 23 18:44:07 2007
Subject: [mod_python] Streaming output
In-Reply-To: <928306280704231533g31951251lcd2f9936187e21f0@mail.gmail.com>
References: <928306280704231533g31951251lcd2f9936187e21f0@mail.gmail.com>
Message-ID: <88e286470704231544v21458bb1r2db32029e5ada652@mail.gmail.com>

On 24/04/07, Greg Fawcett <greg@vig.co.nz> wrote:
> Hi -
>
> Is there any way to stream output to a request object, instead of using
> req.write()? My application has to serve PDF documents (sometimes several
> tens of megabytes long). Access to these has to be controlled, and they are
> encrypted, so I can't just expose them as normal files to apache. PHP has a
> useful function passthru(command) which will run command and stream the
> output directly back to the client - is there any equivalent in python?
>
> On a related note, how "direct" is req.write()? I'd hate it to be buffering
> the whole PDF up somewhere along the line, before sending it to the client.

Check the documentation and I think you will find your answer.

  http://www.modpython.org/live/current/doc-html/pyapi-mprequest-meth.html

For write():

write(string[, flush=1])
    Writes string directly to the client, then flushes the buffer,
unless flush is 0.

Thus, it defaults to flushing data as soon as written, but this can be
disabled and output will be buffered up until request is done.

sendfile(path[, offset, len])
    Sends len bytes of file path directly to the client, starting at
offset offset using the server's internal API. offset defaults to 0,
and len defaults to -1 (send the entire file).

    Returns the number of bytes sent, or raises an IOError exception on failure.

    This function provides the most efficient way to send a file to the client.

This passes the job of sending the file to Apache whereby it may be
able to use more efficient methods than you can use.

Graham
From nferrier at tapsellferrier.co.uk  Mon Apr 23 18:50:43 2007
From: nferrier at tapsellferrier.co.uk (Nic James Ferrier)
Date: Mon Apr 23 18:50:11 2007
Subject: [mod_python] Streaming output
In-Reply-To: <928306280704231533g31951251lcd2f9936187e21f0@mail.gmail.com>
	(Greg Fawcett's message of "Tue\, 24 Apr 2007 10\:33\:49 +1200")
References: <928306280704231533g31951251lcd2f9936187e21f0@mail.gmail.com>
Message-ID: <87lkgig0xo.fsf@kanga.tapsellferrier.co.uk>

"Greg Fawcett" <greg@vig.co.nz> writes:

> Is there any way to stream output to a request object, instead of using
> req.write()? My application has to serve PDF documents (sometimes several
> tens of megabytes long). Access to these has to be controlled, and they are
> encrypted, so I can't just expose them as normal files to apache. PHP has a
> useful function passthru(command) which will run command and stream the
> output directly back to the client - is there any equivalent in python?
>
> On a related note, how "direct" is req.write()? I'd hate it to be buffering
> the whole PDF up somewhere along the line, before sending it to the
> client.

mod_python has sendfile which is similar to passthru

It means you can protect your PDF documents in non-webserver space but
still use apache to serve them.

-- 
Nic Ferrier
http://www.tapsellferrier.co.uk   
From seanglover at sympatico.ca  Mon Apr 23 18:52:12 2007
From: seanglover at sympatico.ca (Sean Glover)
Date: Mon Apr 23 18:54:36 2007
Subject: [mod_python] mod_python,
	python_handler error "Can't get/create interpreter"
In-Reply-To: <88e286470704231502w7c5c85f1lde9963fa7bfea788@mail.gmail.com>
Message-ID: <BAYC1-PASMTP08GAqEZ0001071e@bayc1-pasmtp08.bayc1.hotmail.com>

Hi Graham,

I stopped apache before I installed mod_python, but just to be sure I tried
it again.

I have several versions of python installed on my system.  I symlinked
'python' to the compiled python2.5 executable.  My /usr/local/bin directory
has the following python entries:

lrwxr-xr-x  1 root  wheel       9 Apr 20 12:38 python -> python2.5
lrwxr-xr-x  1 root  wheel      16 Mar  9 06:45 python-config ->
python2.5-config
-r-xr-xr-x  2 root  wheel    3252 Apr  9 20:32 python-shared
-r-xr-xr-x  1 root  wheel    3252 Jan 11 04:47 python-shared2.3
-r-xr-xr-x  2 root  wheel    3252 Apr  9 20:32 python-shared2.4
-r-xr-xr-x  1 root  wheel    3172 Apr  9 20:24 python-shared2.5
-r-xr-xr-x  1 root  wheel    1288 Apr  9 20:24 python-shared2.5-config
-r-xr-xr-x  1 root  wheel  771932 Jan 11 04:46 python2.3
-r-xr-xr-x  2 root  wheel  827180 Apr  9 20:32 python2.4
-r-xr-xr-x  1 root  wheel  944656 Apr  9 20:23 python2.5
-r-xr-xr-x  1 root  wheel    1281 Apr  9 20:24 python2.5-config

I tried rearranging the entries in my $PATH env var for the www user which
httpd runs under:


-----Original Message-----
From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com] 
Sent: Monday, April 23, 2007 6:02 PM
To: Sean Glover
Cc: mod_python@modpython.org
Subject: Re: [mod_python] mod_python, python_handler error "Can't get/create
interpreter"

On 24/04/07, Sean Glover <seanglover@sympatico.ca> wrote:
> Hello, I recently started using python 2.5 on my FreeBSD machine.  I had a
> version of mod_python up and running (sorry, I don't recall which one)
> against python 2.4.  I used the ports packages system to install
mod_python
> 3.3.1 without incident.  It replaced the old mod_python.so module and put
> the necessary python modules in my python2.5 site-packages directory.  I
> left my httpd.conf configuration the same, restarted,

When replacing mod_python version, always a good idea to do a 'stop'
and 'start' rather than a 'restart', but presuming you would have
eventually tried that.

> and hit my mod_python
> test page and receive an internal server error.  Below is a paste from my
> httpd-error.log.
>
> Could anyone suggest a solution to get mod_python (with python 2.5)
working
> with my apache 2.2 server again?

How many versions of Python do you have installed on your system?

I would probably guess you have older version of Python in /usr/bin
still and Python when being initialised within mod_python is finding
that old version, but the old version doesn't have the mod_python
Python bits.

Try setting the PATH environment variable for the user that runs
Apache to have /usr/local/bin first in the path so that it finds the
version of Python you want used before the operating system default
version.

BTW, are you sure there weren't a series of other error messages prior
to those you quoted. Can you include the dozen of so lines before that
point?

Graham

> # mod_python.so module
>
> -rwxr-xr-x  1 root  wheel  122135 Apr 23 12:43
> /usr/local/libexec/apache22/mod_python.so
>
>
>
> # mod_python python modules (/usr/local/lib/python2.5/site-packages)
>
> drwxr-xr-x   2 root  wheel    1024 Apr 23 12:43 mod_python
>
> -rw-r--r--   1 root  wheel     254 Apr 23 12:43
> mod_python-3.3.1-py2.5.egg-info
>
>
>
> # apache httpd.conf file entry
>
> LoadModule python_module libexec/apache22/mod_python.so
>
>
>
> # test .htaccess
> (http://randonom.com/test/python/mptest.py)
>
> AddHandler mod_python .py
>
> PythonHandler mptest
>
> PythonDebug On
>
>
>
> # httpd-error.log after hitting the URL above ^
>
> [Mon Apr 23 13:37:40 2007] [error] get_interpreter: no interpreter
callback
> found.
>
> [Mon Apr 23 13:37:40 2007] [error] [client 65.36.178.226] python_handler:
> Can't get/create interpreter.
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
 


From seanglover at sympatico.ca  Mon Apr 23 18:58:29 2007
From: seanglover at sympatico.ca (Sean Glover)
Date: Mon Apr 23 19:02:56 2007
Subject: [mod_python] mod_python,
	python_handler error "Can't get/create interpreter"
Message-ID: <BAYC1-PASMTP05O3C9v00013665@bayc1-pasmtp05.bayc1.hotmail.com>

(sorry, I accidentally sent this prematurely)

Hi Graham,

I stopped apache before I installed mod_python, but just to be sure I tried
it again.

I have several versions of python installed on my system.  I symlinked
'python' to the compiled python2.5 executable.  My /usr/local/bin directory
has the following python entries:

lrwxr-xr-x  1 root  wheel       9 Apr 20 12:38 python -> python2.5
lrwxr-xr-x  1 root  wheel      16 Mar  9 06:45 python-config ->
python2.5-config
-r-xr-xr-x  2 root  wheel    3252 Apr  9 20:32 python-shared
-r-xr-xr-x  1 root  wheel    3252 Jan 11 04:47 python-shared2.3
-r-xr-xr-x  2 root  wheel    3252 Apr  9 20:32 python-shared2.4
-r-xr-xr-x  1 root  wheel    3172 Apr  9 20:24 python-shared2.5
-r-xr-xr-x  1 root  wheel    1288 Apr  9 20:24 python-shared2.5-config
-r-xr-xr-x  1 root  wheel  771932 Jan 11 04:46 python2.3
-r-xr-xr-x  2 root  wheel  827180 Apr  9 20:32 python2.4
-r-xr-xr-x  1 root  wheel  944656 Apr  9 20:23 python2.5
-r-xr-xr-x  1 root  wheel    1281 Apr  9 20:24 python2.5-config

I tried rearranging the entries in my $PATH env var for the www user which
httpd runs under.  I stopped apache while doing this:

[www@thewire /home/wladek]$ export
PATH="/usr/local/bin:/sbin:/bin:/usr/sbin:/us
r/bin:/usr/games:/usr/local/sbin:/usr/X11R6/bin:/root/bin"
[www@thewire /home/wladek]$ echo $PATH
/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/usr/games:/usr/local/sbin:/usr
/X11
R6/bin:/root/bin

More lines from httpd-error.log:

[Mon Apr 23 18:52:38 2007] [warn] Init: Session Cache is not configured
[hint: SSLSessionCache]
[Mon Apr 23 18:52:39 2007] [notice] mod_python: Creating 8 session mutexes
based on 256 max processes and 0 max threads.
[Mon Apr 23 18:52:39 2007] [notice] mod_python: using mutex_directory /tmp
[Mon Apr 23 18:52:39 2007] [notice] Digest: generating secret for digest
authentication ...
[Mon Apr 23 18:52:39 2007] [notice] Digest: done
[Mon Apr 23 18:52:40 2007] [notice] Apache/2.2.0 (FreeBSD) mod_ssl/2.2.0
OpenSSL /0.9.7e-p1 DAV/2 mod_python/3.3.1 Python/2.5 PHP/5.2.0 with
Suhosin-Patch configured -- resuming normal operations
[Mon Apr 23 18:52:47 2007] [error] make_obcallback: could not call init.\n
Traceback (most recent call last):
  File "/usr/local/lib/python2.5/site-packages/mod_python/apache.py", line
937,in init
    from mod_python import importer
  File "/usr/local/lib/python2.5/site-packages/mod_python/importer.py", line
24, in <module>
    from mod_python import publisher
  File "/usr/local/lib/python2.5/site-packages/mod_python/publisher.py",
line 50, in <module>
    from cache import ModuleCache, NOT_INITIALIZED
  File "/usr/local/lib/python2.5/site-packages/mod_python/cache.py", line
27, in <module>
    import urllib2
  File "/usr/local/lib/python2.5/urllib2.py", line 88, in <module>
    import hashlib
  File "/usr/local/lib/python2.5/hashlib.py", line 104, in <module>
    md5 = __get_builtin_constructor('md5')
  File "/usr/local/lib/python2.5/hashlib.py", line 31, in
__get_builtin_constructor
    import _md5
ImportError: No module named _md5
[Mon Apr 23 18:52:47 2007] [error] get_interpreter: no interpreter callback
found.
[Mon Apr 23 18:52:47 2007] [error] [client 76.64.190.137] python_handler:
Can't get/create interpreter.

Sean

-----Original Message-----
From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com] 
Sent: Monday, April 23, 2007 6:02 PM
To: Sean Glover
Cc: mod_python@modpython.org
Subject: Re: [mod_python] mod_python, python_handler error "Can't get/create
interpreter"

On 24/04/07, Sean Glover <seanglover@sympatico.ca> wrote:
> Hello, I recently started using python 2.5 on my FreeBSD machine.  I had a
> version of mod_python up and running (sorry, I don't recall which one)
> against python 2.4.  I used the ports packages system to install
mod_python
> 3.3.1 without incident.  It replaced the old mod_python.so module and put
> the necessary python modules in my python2.5 site-packages directory.  I
> left my httpd.conf configuration the same, restarted,

When replacing mod_python version, always a good idea to do a 'stop'
and 'start' rather than a 'restart', but presuming you would have
eventually tried that.

> and hit my mod_python
> test page and receive an internal server error.  Below is a paste from my
> httpd-error.log.
>
> Could anyone suggest a solution to get mod_python (with python 2.5)
working
> with my apache 2.2 server again?

How many versions of Python do you have installed on your system?

I would probably guess you have older version of Python in /usr/bin
still and Python when being initialised within mod_python is finding
that old version, but the old version doesn't have the mod_python
Python bits.

Try setting the PATH environment variable for the user that runs
Apache to have /usr/local/bin first in the path so that it finds the
version of Python you want used before the operating system default
version.

BTW, are you sure there weren't a series of other error messages prior
to those you quoted. Can you include the dozen of so lines before that
point?

Graham

> # mod_python.so module
>
> -rwxr-xr-x  1 root  wheel  122135 Apr 23 12:43
> /usr/local/libexec/apache22/mod_python.so
>
>
>
> # mod_python python modules (/usr/local/lib/python2.5/site-packages)
>
> drwxr-xr-x   2 root  wheel    1024 Apr 23 12:43 mod_python
>
> -rw-r--r--   1 root  wheel     254 Apr 23 12:43
> mod_python-3.3.1-py2.5.egg-info
>
>
>
> # apache httpd.conf file entry
>
> LoadModule python_module libexec/apache22/mod_python.so
>
>
>
> # test .htaccess
> (http://randonom.com/test/python/mptest.py)
>
> AddHandler mod_python .py
>
> PythonHandler mptest
>
> PythonDebug On
>
>
>
> # httpd-error.log after hitting the URL above ^
>
> [Mon Apr 23 13:37:40 2007] [error] get_interpreter: no interpreter
callback
> found.
>
> [Mon Apr 23 13:37:40 2007] [error] [client 65.36.178.226] python_handler:
> Can't get/create interpreter.
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
 


From graham.dumpleton at gmail.com  Mon Apr 23 19:09:01 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Apr 23 19:09:06 2007
Subject: [mod_python] mod_python,
	python_handler error "Can't get/create interpreter"
In-Reply-To: <BAYC1-PASMTP05O3C9v00013665@bayc1-pasmtp05.bayc1.hotmail.com>
References: <BAYC1-PASMTP05O3C9v00013665@bayc1-pasmtp05.bayc1.hotmail.com>
Message-ID: <88e286470704231609k32e59abbn5711f3056d0e3d18@mail.gmail.com>

On 24/04/07, Sean Glover <seanglover@sympatico.ca> wrote:
> [Mon Apr 23 18:52:47 2007] [error] make_obcallback: could not call init.\n
> Traceback (most recent call last):
>   File "/usr/local/lib/python2.5/site-packages/mod_python/apache.py", line
> 937,in init
>     from mod_python import importer
>   File "/usr/local/lib/python2.5/site-packages/mod_python/importer.py", line
> 24, in <module>
>     from mod_python import publisher
>   File "/usr/local/lib/python2.5/site-packages/mod_python/publisher.py",
> line 50, in <module>
>     from cache import ModuleCache, NOT_INITIALIZED
>   File "/usr/local/lib/python2.5/site-packages/mod_python/cache.py", line
> 27, in <module>
>     import urllib2
>   File "/usr/local/lib/python2.5/urllib2.py", line 88, in <module>
>     import hashlib
>   File "/usr/local/lib/python2.5/hashlib.py", line 104, in <module>
>     md5 = __get_builtin_constructor('md5')
>   File "/usr/local/lib/python2.5/hashlib.py", line 31, in
> __get_builtin_constructor
>     import _md5
> ImportError: No module named _md5
> [Mon Apr 23 18:52:47 2007] [error] get_interpreter: no interpreter callback
> found.
> [Mon Apr 23 18:52:47 2007] [error] [client 76.64.190.137] python_handler:
> Can't get/create interpreter.

And there be the real problem. Either that version of Python hasn't
got the md5 module installed, or you are running PHP on the same
server and it is loading the mhash.so PHP module which has shown in
the past to conflict in bad ways with mod_python.

Thus, check if from command line Python you can import 'md5' module.
If that works, disable PHP on web server and see if problem goes away.
If it does, work out how to disable PHP mhash.so so it doesn't load.

Graham
From graham.dumpleton at gmail.com  Mon Apr 23 20:52:47 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Apr 23 20:52:55 2007
Subject: [mod_python] mod_python,
	python_handler error "Can't get/create interpreter"
In-Reply-To: <BAYC1-PASMTP05jDcw900013889@bayc1-pasmtp05.bayc1.hotmail.com>
References: <88e286470704231609k32e59abbn5711f3056d0e3d18@mail.gmail.com>
	<BAYC1-PASMTP05jDcw900013889@bayc1-pasmtp05.bayc1.hotmail.com>
Message-ID: <88e286470704231752n63eef45es5956729f1b464bb@mail.gmail.com>

On 24/04/07, Sean Glover <seanglover@sympatico.ca> wrote:
> Graham,
>
> I removed the line from my httpd.conf that loaded the php5 module and
> restarted:
>
> #LoadModule php5_module        libexec/apache22/libphp5.so
>
> Unfortunately, I still get the same error message.
>
> I loaded the 'md5' library in the python 2.5 terminal successfully, but was
> unable to load '_md5'.
>
> Python 2.5 (r25:51908, Apr  9 2007, 20:22:40)
> [GCC 3.4.4 [FreeBSD] 20050518] on freebsd6
> Type "help", "copyright", "credits" or "license" for more information.
> >>> import md5
> >>> import _md5
> Traceback (most recent call last):
>   File "<stdin>", line 1, in <module>
> ImportError: No module named _md5

Hmmm, next time I should read the error messages properly. Problem is
that new Python 2.5 'hashlib' module is the one that is loading '_md5'
module. The 'hashlib' module being required by 'urllib2'.

The thing is that 'hashlib' shouldn't be trying to import '_md5' if
the '_hashlib' module imports okay from 'hashlib', which is what it
should use these days instead of '_md5'.

What do you get if you try importing '_hashlib' from command line
Python. If that doesn't work then your Python installed is borked in
some way and you will need to work out how to get 'hashlib' module to
import successfully from command line Python before you can get any
further.

Note that if 'hashlib' does import okay from command line, the problem
may be that '_hashlib' has shared library dependencies that can't be
resolved when imported under Apache. In that case you will need to
run:

  ldd _hashlib.so

from Python library directory and work out what libraries it uses and
where they are. If they are in a non standard location then you may
have to set directory in LD_LIBRARY_PATH for Apache to tell it where
they are. Ideally Python would be rebuilt while setting LD_RUN_PATH in
environment with that non standard library location so that directory
gets embedded in '_hashlib.so'.

Hopefully that makes half sense. :-)

Graham

> Error:
>
> [Mon Apr 23 20:21:28 2007] [error] make_obcallback: could not call init.\n
> Traceback (most recent call last):
>   File "/usr/local/lib/python2.5/site-packages/mod_python/apache.py", line
> 937, in init
>     from mod_python import importer
>   File "/usr/local/lib/python2.5/site-packages/mod_python/importer.py", line
> 24, in <module>
>     from mod_python import publisher
>   File "/usr/local/lib/python2.5/site-packages/mod_python/publisher.py",
> line 50, in <module>
>     from cache import ModuleCache, NOT_INITIALIZED
>   File "/usr/local/lib/python2.5/site-packages/mod_python/cache.py", line
> 27, in <module>
>     import urllib2
>   File "/usr/local/lib/python2.5/urllib2.py", line 88, in <module>
>     import hashlib
>   File "/usr/local/lib/python2.5/hashlib.py", line 104, in <module>
>     md5 = __get_builtin_constructor('md5')
>   File "/usr/local/lib/python2.5/hashlib.py", line 31, in
> __get_builtin_constructor
>     import _md5
> ImportError: No module named _md5
> [Mon Apr 23 20:21:28 2007] [error] get_interpreter: no interpreter callback
> found.
> [Mon Apr 23 20:21:28 2007] [error] [client 76.64.190.137] python_handler:
> Can't get/create interpreter., referer: http://randonom.com/test/python/
>
> Sean
>
> -----Original Message-----
> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
> Sent: Monday, April 23, 2007 7:09 PM
> To: Sean Glover
> Cc: mod_python@modpython.org
> Subject: Re: [mod_python] mod_python, python_handler error "Can't get/create
> interpreter"
>
> On 24/04/07, Sean Glover <seanglover@sympatico.ca> wrote:
> > [Mon Apr 23 18:52:47 2007] [error] make_obcallback: could not call init.\n
> > Traceback (most recent call last):
> >   File "/usr/local/lib/python2.5/site-packages/mod_python/apache.py", line
> > 937,in init
> >     from mod_python import importer
> >   File "/usr/local/lib/python2.5/site-packages/mod_python/importer.py",
> line
> > 24, in <module>
> >     from mod_python import publisher
> >   File "/usr/local/lib/python2.5/site-packages/mod_python/publisher.py",
> > line 50, in <module>
> >     from cache import ModuleCache, NOT_INITIALIZED
> >   File "/usr/local/lib/python2.5/site-packages/mod_python/cache.py", line
> > 27, in <module>
> >     import urllib2
> >   File "/usr/local/lib/python2.5/urllib2.py", line 88, in <module>
> >     import hashlib
> >   File "/usr/local/lib/python2.5/hashlib.py", line 104, in <module>
> >     md5 = __get_builtin_constructor('md5')
> >   File "/usr/local/lib/python2.5/hashlib.py", line 31, in
> > __get_builtin_constructor
> >     import _md5
> > ImportError: No module named _md5
> > [Mon Apr 23 18:52:47 2007] [error] get_interpreter: no interpreter
> callback
> > found.
> > [Mon Apr 23 18:52:47 2007] [error] [client 76.64.190.137] python_handler:
> > Can't get/create interpreter.
>
> And there be the real problem. Either that version of Python hasn't
> got the md5 module installed, or you are running PHP on the same
> server and it is loading the mhash.so PHP module which has shown in
> the past to conflict in bad ways with mod_python.
>
> Thus, check if from command line Python you can import 'md5' module.
> If that works, disable PHP on web server and see if problem goes away.
> If it does, work out how to disable PHP mhash.so so it doesn't load.
>
> Graham
>
>
>
From jambor3 at gmail.com  Mon Apr 23 23:32:05 2007
From: jambor3 at gmail.com (jambor)
Date: Mon Apr 23 23:32:05 2007
Subject: [mod_python] cache.py Cache.__delitem__ bug
Message-ID: <1B7975EA-4210-4DA2-B025-C4372FC4675D@gmail.com>

This may have been reported before, but I think there's a bug in  
cache.py where deleting a cached entry breaks the cache queue linked  
list.
Reported at the bottom of:
http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/302997

I guess it looks like cache.py isn't really used in 3.3, but if  
you're distributing it for compatibility purposes, perhaps it's worth  
noting.

Also, I was wondering if the mod_python project has a roadmap for  
future development. Has developer focus switched to mod_wsgi?

Thanks,
Jambor
From graham.dumpleton at gmail.com  Mon Apr 23 23:59:02 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Apr 23 23:59:06 2007
Subject: [mod_python] cache.py Cache.__delitem__ bug
In-Reply-To: <1B7975EA-4210-4DA2-B025-C4372FC4675D@gmail.com>
References: <1B7975EA-4210-4DA2-B025-C4372FC4675D@gmail.com>
Message-ID: <88e286470704232059m624180f6t70404269e3471924@mail.gmail.com>

On 24/04/07, jambor <jambor3@gmail.com> wrote:
> This may have been reported before, but I think there's a bug in
> cache.py where deleting a cached entry breaks the cache queue linked
> list.
> Reported at the bottom of:
> http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/302997
>
> I guess it looks like cache.py isn't really used in 3.3, but if
> you're distributing it for compatibility purposes, perhaps it's worth
> noting.

The cache.py file will be removed in next update to mod_python given
that it is not required by new module importer. It was always only
really there for internal use and not part of any official public API.

> Also, I was wondering if the mod_python project has a roadmap for
> future development. Has developer focus switched to mod_wsgi?

I can only speak for myself and yes my main focus at least is now on
mod_wsgi and some other semi secret Apache/Python related projects I
have been working on. There is no one else working on mod_wsgi.

In developing mod_wsgi I have come across various things that can be
done better in mod_python or which will fix issues in mod_python. I
will at some stage log all these as issues in JIRA, but anything being
done about them will probably depend on whether there is any interest
from mod_python users or not on doing further work on mod_python. At
the moment the way I read things is that most seem to be quite happy
with mod_python 3.3, at least the number of questions and complaints
about mod_python appears to have dropped off.

Before any significant new coding is done, various issues with web
sites, documentation etc, probably need to be sorted out as some of
the issues are in some ways a deterrent to wanting to expend too much
effort on the code.

Graham
From seanglover at sympatico.ca  Tue Apr 24 20:00:34 2007
From: seanglover at sympatico.ca (Sean Glover)
Date: Tue Apr 24 20:02:31 2007
Subject: FW: [mod_python] mod_python,
	python_handler error "Can't get/create interpreter"
Message-ID: <BAYC1-PASMTP05cbdFk00015371@bayc1-pasmtp05.bayc1.hotmail.com>

Looks like 'hashlib' and '_hashlib' alike are installed ok.

Python 2.5 (r25:51908, Apr  9 2007, 20:22:40)
[GCC 3.4.4 [FreeBSD] 20050518] on freebsd6
Type "help", "copyright", "credits" or "license" for more information.
>>> import _hashlib
>>> import hashlib
>>> dir(_hashlib)
['__doc__', '__file__', '__name__', 'new', 'openssl_md5', 'openssl_sha1',
'opens
sl_sha224', 'openssl_sha256', 'openssl_sha384', 'openssl_sha512']

Btw, appreciating the help so far! =)

-----Original Message-----
From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com] 
Sent: Monday, April 23, 2007 8:53 PM
To: Sean Glover
Cc: mod_python@modpython.org
Subject: Re: [mod_python] mod_python, python_handler error "Can't get/create
interpreter"

On 24/04/07, Sean Glover <seanglover@sympatico.ca> wrote:
> Graham,
>
> I removed the line from my httpd.conf that loaded the php5 module and
> restarted:
>
> #LoadModule php5_module        libexec/apache22/libphp5.so
>
> Unfortunately, I still get the same error message.
>
> I loaded the 'md5' library in the python 2.5 terminal successfully, but
was
> unable to load '_md5'.
>
> Python 2.5 (r25:51908, Apr  9 2007, 20:22:40)
> [GCC 3.4.4 [FreeBSD] 20050518] on freebsd6
> Type "help", "copyright", "credits" or "license" for more information.
> >>> import md5
> >>> import _md5
> Traceback (most recent call last):
>   File "<stdin>", line 1, in <module>
> ImportError: No module named _md5

Hmmm, next time I should read the error messages properly. Problem is
that new Python 2.5 'hashlib' module is the one that is loading '_md5'
module. The 'hashlib' module being required by 'urllib2'.

The thing is that 'hashlib' shouldn't be trying to import '_md5' if
the '_hashlib' module imports okay from 'hashlib', which is what it
should use these days instead of '_md5'.

What do you get if you try importing '_hashlib' from command line
Python. If that doesn't work then your Python installed is borked in
some way and you will need to work out how to get 'hashlib' module to
import successfully from command line Python before you can get any
further.

Note that if 'hashlib' does import okay from command line, the problem
may be that '_hashlib' has shared library dependencies that can't be
resolved when imported under Apache. In that case you will need to
run:

  ldd _hashlib.so

from Python library directory and work out what libraries it uses and
where they are. If they are in a non standard location then you may
have to set directory in LD_LIBRARY_PATH for Apache to tell it where
they are. Ideally Python would be rebuilt while setting LD_RUN_PATH in
environment with that non standard library location so that directory
gets embedded in '_hashlib.so'.

Hopefully that makes half sense. :-)

Graham

> Error:
>
> [Mon Apr 23 20:21:28 2007] [error] make_obcallback: could not call init.\n
> Traceback (most recent call last):
>   File "/usr/local/lib/python2.5/site-packages/mod_python/apache.py", line
> 937, in init
>     from mod_python import importer
>   File "/usr/local/lib/python2.5/site-packages/mod_python/importer.py",
line
> 24, in <module>
>     from mod_python import publisher
>   File "/usr/local/lib/python2.5/site-packages/mod_python/publisher.py",
> line 50, in <module>
>     from cache import ModuleCache, NOT_INITIALIZED
>   File "/usr/local/lib/python2.5/site-packages/mod_python/cache.py", line
> 27, in <module>
>     import urllib2
>   File "/usr/local/lib/python2.5/urllib2.py", line 88, in <module>
>     import hashlib
>   File "/usr/local/lib/python2.5/hashlib.py", line 104, in <module>
>     md5 = __get_builtin_constructor('md5')
>   File "/usr/local/lib/python2.5/hashlib.py", line 31, in
> __get_builtin_constructor
>     import _md5
> ImportError: No module named _md5
> [Mon Apr 23 20:21:28 2007] [error] get_interpreter: no interpreter
callback
> found.
> [Mon Apr 23 20:21:28 2007] [error] [client 76.64.190.137] python_handler:
> Can't get/create interpreter., referer: http://randonom.com/test/python/
>
> Sean
>
> -----Original Message-----
> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
> Sent: Monday, April 23, 2007 7:09 PM
> To: Sean Glover
> Cc: mod_python@modpython.org
> Subject: Re: [mod_python] mod_python, python_handler error "Can't
get/create
> interpreter"
>
> On 24/04/07, Sean Glover <seanglover@sympatico.ca> wrote:
> > [Mon Apr 23 18:52:47 2007] [error] make_obcallback: could not call
init.\n
> > Traceback (most recent call last):
> >   File "/usr/local/lib/python2.5/site-packages/mod_python/apache.py",
line
> > 937,in init
> >     from mod_python import importer
> >   File "/usr/local/lib/python2.5/site-packages/mod_python/importer.py",
> line
> > 24, in <module>
> >     from mod_python import publisher
> >   File "/usr/local/lib/python2.5/site-packages/mod_python/publisher.py",
> > line 50, in <module>
> >     from cache import ModuleCache, NOT_INITIALIZED
> >   File "/usr/local/lib/python2.5/site-packages/mod_python/cache.py",
line
> > 27, in <module>
> >     import urllib2
> >   File "/usr/local/lib/python2.5/urllib2.py", line 88, in <module>
> >     import hashlib
> >   File "/usr/local/lib/python2.5/hashlib.py", line 104, in <module>
> >     md5 = __get_builtin_constructor('md5')
> >   File "/usr/local/lib/python2.5/hashlib.py", line 31, in
> > __get_builtin_constructor
> >     import _md5
> > ImportError: No module named _md5
> > [Mon Apr 23 18:52:47 2007] [error] get_interpreter: no interpreter
> callback
> > found.
> > [Mon Apr 23 18:52:47 2007] [error] [client 76.64.190.137]
python_handler:
> > Can't get/create interpreter.
>
> And there be the real problem. Either that version of Python hasn't
> got the md5 module installed, or you are running PHP on the same
> server and it is loading the mhash.so PHP module which has shown in
> the past to conflict in bad ways with mod_python.
>
> Thus, check if from command line Python you can import 'md5' module.
> If that works, disable PHP on web server and see if problem goes away.
> If it does, work out how to disable PHP mhash.so so it doesn't load.
>
> Graham
>
>
>
                                                  

From seanglover at sympatico.ca  Wed Apr 25 07:49:52 2007
From: seanglover at sympatico.ca (Sean Glover)
Date: Wed Apr 25 07:51:42 2007
Subject: [mod_python] mod_python,
	python_handler error "Can't get/create interpreter"
In-Reply-To: <BAYC1-PASMTP05cbdFk00015371@bayc1-pasmtp05.bayc1.hotmail.com>
Message-ID: <BAYC1-PASMTP06TlMCr00014e74@bayc1-pasmtp06.bayc1.hotmail.com>

Just had to recompile apache.  Thanks for all the help.

-----Original Message-----
From: mod_python-bounces@modpython.org
[mailto:mod_python-bounces@modpython.org] On Behalf Of Sean Glover
Sent: Tuesday, April 24, 2007 8:01 PM
To: mod_python@modpython.org
Subject: FW: [mod_python] mod_python,python_handler error "Can't get/create
interpreter"

Looks like 'hashlib' and '_hashlib' alike are installed ok.

Python 2.5 (r25:51908, Apr  9 2007, 20:22:40)
[GCC 3.4.4 [FreeBSD] 20050518] on freebsd6
Type "help", "copyright", "credits" or "license" for more information.
>>> import _hashlib
>>> import hashlib
>>> dir(_hashlib)
['__doc__', '__file__', '__name__', 'new', 'openssl_md5', 'openssl_sha1',
'opens
sl_sha224', 'openssl_sha256', 'openssl_sha384', 'openssl_sha512']

Btw, appreciating the help so far! =)

-----Original Message-----
From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com] 
Sent: Monday, April 23, 2007 8:53 PM
To: Sean Glover
Cc: mod_python@modpython.org
Subject: Re: [mod_python] mod_python, python_handler error "Can't get/create
interpreter"

On 24/04/07, Sean Glover <seanglover@sympatico.ca> wrote:
> Graham,
>
> I removed the line from my httpd.conf that loaded the php5 module and
> restarted:
>
> #LoadModule php5_module        libexec/apache22/libphp5.so
>
> Unfortunately, I still get the same error message.
>
> I loaded the 'md5' library in the python 2.5 terminal successfully, but
was
> unable to load '_md5'.
>
> Python 2.5 (r25:51908, Apr  9 2007, 20:22:40)
> [GCC 3.4.4 [FreeBSD] 20050518] on freebsd6
> Type "help", "copyright", "credits" or "license" for more information.
> >>> import md5
> >>> import _md5
> Traceback (most recent call last):
>   File "<stdin>", line 1, in <module>
> ImportError: No module named _md5

Hmmm, next time I should read the error messages properly. Problem is
that new Python 2.5 'hashlib' module is the one that is loading '_md5'
module. The 'hashlib' module being required by 'urllib2'.

The thing is that 'hashlib' shouldn't be trying to import '_md5' if
the '_hashlib' module imports okay from 'hashlib', which is what it
should use these days instead of '_md5'.

What do you get if you try importing '_hashlib' from command line
Python. If that doesn't work then your Python installed is borked in
some way and you will need to work out how to get 'hashlib' module to
import successfully from command line Python before you can get any
further.

Note that if 'hashlib' does import okay from command line, the problem
may be that '_hashlib' has shared library dependencies that can't be
resolved when imported under Apache. In that case you will need to
run:

  ldd _hashlib.so

from Python library directory and work out what libraries it uses and
where they are. If they are in a non standard location then you may
have to set directory in LD_LIBRARY_PATH for Apache to tell it where
they are. Ideally Python would be rebuilt while setting LD_RUN_PATH in
environment with that non standard library location so that directory
gets embedded in '_hashlib.so'.

Hopefully that makes half sense. :-)

Graham

> Error:
>
> [Mon Apr 23 20:21:28 2007] [error] make_obcallback: could not call init.\n
> Traceback (most recent call last):
>   File "/usr/local/lib/python2.5/site-packages/mod_python/apache.py", line
> 937, in init
>     from mod_python import importer
>   File "/usr/local/lib/python2.5/site-packages/mod_python/importer.py",
line
> 24, in <module>
>     from mod_python import publisher
>   File "/usr/local/lib/python2.5/site-packages/mod_python/publisher.py",
> line 50, in <module>
>     from cache import ModuleCache, NOT_INITIALIZED
>   File "/usr/local/lib/python2.5/site-packages/mod_python/cache.py", line
> 27, in <module>
>     import urllib2
>   File "/usr/local/lib/python2.5/urllib2.py", line 88, in <module>
>     import hashlib
>   File "/usr/local/lib/python2.5/hashlib.py", line 104, in <module>
>     md5 = __get_builtin_constructor('md5')
>   File "/usr/local/lib/python2.5/hashlib.py", line 31, in
> __get_builtin_constructor
>     import _md5
> ImportError: No module named _md5
> [Mon Apr 23 20:21:28 2007] [error] get_interpreter: no interpreter
callback
> found.
> [Mon Apr 23 20:21:28 2007] [error] [client 76.64.190.137] python_handler:
> Can't get/create interpreter., referer: http://randonom.com/test/python/
>
> Sean
>
> -----Original Message-----
> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
> Sent: Monday, April 23, 2007 7:09 PM
> To: Sean Glover
> Cc: mod_python@modpython.org
> Subject: Re: [mod_python] mod_python, python_handler error "Can't
get/create
> interpreter"
>
> On 24/04/07, Sean Glover <seanglover@sympatico.ca> wrote:
> > [Mon Apr 23 18:52:47 2007] [error] make_obcallback: could not call
init.\n
> > Traceback (most recent call last):
> >   File "/usr/local/lib/python2.5/site-packages/mod_python/apache.py",
line
> > 937,in init
> >     from mod_python import importer
> >   File "/usr/local/lib/python2.5/site-packages/mod_python/importer.py",
> line
> > 24, in <module>
> >     from mod_python import publisher
> >   File "/usr/local/lib/python2.5/site-packages/mod_python/publisher.py",
> > line 50, in <module>
> >     from cache import ModuleCache, NOT_INITIALIZED
> >   File "/usr/local/lib/python2.5/site-packages/mod_python/cache.py",
line
> > 27, in <module>
> >     import urllib2
> >   File "/usr/local/lib/python2.5/urllib2.py", line 88, in <module>
> >     import hashlib
> >   File "/usr/local/lib/python2.5/hashlib.py", line 104, in <module>
> >     md5 = __get_builtin_constructor('md5')
> >   File "/usr/local/lib/python2.5/hashlib.py", line 31, in
> > __get_builtin_constructor
> >     import _md5
> > ImportError: No module named _md5
> > [Mon Apr 23 18:52:47 2007] [error] get_interpreter: no interpreter
> callback
> > found.
> > [Mon Apr 23 18:52:47 2007] [error] [client 76.64.190.137]
python_handler:
> > Can't get/create interpreter.
>
> And there be the real problem. Either that version of Python hasn't
> got the md5 module installed, or you are running PHP on the same
> server and it is loading the mhash.so PHP module which has shown in
> the past to conflict in bad ways with mod_python.
>
> Thus, check if from command line Python you can import 'md5' module.
> If that works, disable PHP on web server and see if problem goes away.
> If it does, work out how to disable PHP mhash.so so it doesn't load.
>
> Graham
>
>
>
                                                  

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python
                                                  

From christian.perone at gmail.com  Wed Apr 25 09:03:14 2007
From: christian.perone at gmail.com (Christian S. Perone)
Date: Wed Apr 25 09:03:42 2007
Subject: [mod_python] PSP (exit/quit/return statement)
Message-ID: <1f6dbaf0704250603m1cdc372ewb85514f1caa8016@mail.gmail.com>

Hello, there is an exit, quit, abort or return like statement for psp ?
For example, I want to do that:

<%
req.write("1")
[exit statement]
req.write("2")
%>

in a way that the statement abort the flow of execution and the result be:
1

I have been read the documentation and don't found anything like that.

Thank you,
- Christian

-- 
Christian S. Perone - christian_perone at gmail dot com
"The effect of music is so very much more powerful and penetrating than is
that of the other arts, for these others speak only of the shadow, but music
of the essence."
- Schopenhauer, Vol. I, Chapter III, The World As Representation
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070425/7c9be834/attachment.html
From graham.dumpleton at gmail.com  Wed Apr 25 17:47:42 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Apr 25 17:47:52 2007
Subject: [mod_python] PSP (exit/quit/return statement)
In-Reply-To: <1f6dbaf0704250603m1cdc372ewb85514f1caa8016@mail.gmail.com>
References: <1f6dbaf0704250603m1cdc372ewb85514f1caa8016@mail.gmail.com>
Message-ID: <88e286470704251447m1a26505ema5abcb35a129c65b@mail.gmail.com>

On 25/04/07, Christian S. Perone <christian.perone@gmail.com> wrote:
> Hello, there is an exit, quit, abort or return like statement for psp ?
> For example, I want to do that:
>
> <%
> req.write("1")
> [exit statement]
> req.write("2")
> %>
>
> in a way that the statement abort the flow of execution and the result be:
> 1
>
> I have been read the documentation and don't found anything like that.

There is no way to currently do it.

Some may argue that it is bad practice, but other templating systems
do have such a feature.

Propose a syntax or mechanism for doing it and if others think it is
reasonable it can be added to list of issues to be looked at.

Graham
From sliderw at hotmail.com  Wed Apr 25 22:51:20 2007
From: sliderw at hotmail.com (sliderw hotmail)
Date: Wed Apr 25 22:51:26 2007
Subject: [mod_python] Getting query parameters when there is RewriteRule
Message-ID: <BAY103-F109342CBF13C2B8F4F625ABD480@phx.gbl>

In httpd.conf, I have:

RewriteRule ^/dl/([^/\?]+)/([^/\?]+)/? /dl/myhandler.py?a=$1&b=$2 [PT,L]

and:

Alias /dl/ "/some/path/"
<Directory "/some/path/">
  ... mod_python stuff here for myhandler ...
</Directory>

myhandler gets the query parameters using qp = 
req.parsed_uri[apache.URI_QUERY]. If I go to 
http://www.mysite.com/dl/myhandler.py?a=1&b=2, qp is "a=1&b=2", as expected. 
On the other hand, if I go to http://www.mysite.com/dl/1/2/, qp is None, but 
I expect qp is "a=1&b=2". How can I make this work?

I'm using mod_python 3.3.1.

Thanks.

_________________________________________________________________
The average US Credit Score is 675. The cost to see yours: $0 by Experian. 
http://www.freecreditreport.com/pm/default.aspx?sc=660600&bcd=EMAILFOOTERAVERAGE

From graham.dumpleton at gmail.com  Wed Apr 25 23:05:00 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Apr 25 23:05:04 2007
Subject: [mod_python] Getting query parameters when there is RewriteRule
In-Reply-To: <BAY103-F109342CBF13C2B8F4F625ABD480@phx.gbl>
References: <BAY103-F109342CBF13C2B8F4F625ABD480@phx.gbl>
Message-ID: <88e286470704252005h7d00ac9eh1d6db19eb4d8f34a@mail.gmail.com>

On 26/04/07, sliderw hotmail <sliderw@hotmail.com> wrote:
> In httpd.conf, I have:
>
> RewriteRule ^/dl/([^/\?]+)/([^/\?]+)/? /dl/myhandler.py?a=$1&b=$2 [PT,L]
>
> and:
>
> Alias /dl/ "/some/path/"
> <Directory "/some/path/">
>   ... mod_python stuff here for myhandler ...
> </Directory>
>
> myhandler gets the query parameters using qp =
> req.parsed_uri[apache.URI_QUERY]. If I go to
> http://www.mysite.com/dl/myhandler.py?a=1&b=2, qp is "a=1&b=2", as expected.
> On the other hand, if I go to http://www.mysite.com/dl/1/2/, qp is None, but
> I expect qp is "a=1&b=2". How can I make this work?

Have you enabled debug in mod_rewrite and looked at the rewrite log to
verify what that your rule matches and is getting rewritten to what
you expect it to? What does it show?

What is the 'mod_python stuff here for myhandler' which you are using?

Have you tried using 'req.args' instead of getting it out of req.parsed_uri?

There is possibly a better way of doing this which avoids mod_rewrite
altogether but will have to think about it first before I suggest some
code to actually try. In short though it involves using a fixuphandler
to trigger mod_python instead of the Apache configuration. One can be
explicit about handler you then want executed and pass what you are
passing through as args as attributes stored against the request
object. Avoids having to do form args processing in actual response
handler.

Graham
From nlv11281 at natlab.research.philips.com  Thu Apr 26 01:20:56 2007
From: nlv11281 at natlab.research.philips.com (Mike Looijmans)
Date: Thu Apr 26 01:21:03 2007
Subject: [mod_python] PSP (exit/quit/return statement)
In-Reply-To: <88e286470704251447m1a26505ema5abcb35a129c65b@mail.gmail.com>
References: <1f6dbaf0704250603m1cdc372ewb85514f1caa8016@mail.gmail.com>
	<88e286470704251447m1a26505ema5abcb35a129c65b@mail.gmail.com>
Message-ID: <463036B8.6090909@natlab.research.philips.com>

Raising an exception will get you there, with some help. If you wrap 
your PSP page in a publisher handler, you can create a "Abort" exception 
class that you catch silently.

class Abort(Exception): pass

try:
   PSP...
except Abort:
   pass
except:
   ... normal handling...


Mike Looijmans
Philips Natlab / Topic Automation


Graham Dumpleton wrote:
> On 25/04/07, Christian S. Perone <christian.perone@gmail.com> wrote:
> 
>> Hello, there is an exit, quit, abort or return like statement for psp ?
>> For example, I want to do that:
>>
>> <%
>> req.write("1")
>> [exit statement]
>> req.write("2")
>> %>
>>
>> in a way that the statement abort the flow of execution and the result 
>> be:
>> 1
>>
>> I have been read the documentation and don't found anything like that.
> 
> 
> There is no way to currently do it.
> 
> Some may argue that it is bad practice, but other templating systems
> do have such a feature.
> 
> Propose a syntax or mechanism for doing it and if others think it is
> reasonable it can be added to list of issues to be looked at.
> 
> Graham
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 
> 
> 



From ml at dasir.net  Thu Apr 26 04:03:04 2007
From: ml at dasir.net (ml)
Date: Thu Apr 26 04:03:10 2007
Subject: [mod_python] uneven speed results
Message-ID: <46305CB8.9060504@dasir.net>

Hi!

I was wondering why mod_python (3.2.8) has so uneven speed results, e.g.:

# ab -k -c1 -n15 some_python_site
...
Percentage of the requests served within a certain time (ms)
  50%    158
  66%    161
  75%    165
  80%    166
  90%   1173
  95%   1209
  98%   1209
  99%   1209
 100%   1209 (longest request)

When I compare it to a PHP it has constant response time on each request.
I know that the startup can take some more time but sometimes it takes a
longer time when I do refreshing the page in a browser so the startup
can't affect the response (I think :-).

What all does affect the mod_python runtime?

David
From graham.dumpleton at gmail.com  Thu Apr 26 06:24:17 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Apr 26 06:24:21 2007
Subject: [mod_python] uneven speed results
In-Reply-To: <46305CB8.9060504@dasir.net>
References: <46305CB8.9060504@dasir.net>
Message-ID: <88e286470704260324v3ab4e68cu3f0d2c6dd54d2f55@mail.gmail.com>

Using 'ab' with such small numbers of requests always yields
unreliable results. What do you get if you use 5000-10000 requests?

Also note that using -k isn't a realistic measure of real world
performance as no single client is going to trigger large numbers of
requests over the same connection, so don't use -k when using the
large number of requests I suggest.

Graham

On 26/04/07, ml <ml@dasir.net> wrote:
> Hi!
>
> I was wondering why mod_python (3.2.8) has so uneven speed results, e.g.:
>
> # ab -k -c1 -n15 some_python_site
> ...
> Percentage of the requests served within a certain time (ms)
>   50%    158
>   66%    161
>   75%    165
>   80%    166
>   90%   1173
>   95%   1209
>   98%   1209
>   99%   1209
>  100%   1209 (longest request)
>
> When I compare it to a PHP it has constant response time on each request.
> I know that the startup can take some more time but sometimes it takes a
> longer time when I do refreshing the page in a browser so the startup
> can't affect the response (I think :-).
>
> What all does affect the mod_python runtime?
>
> David
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From christian.perone at gmail.com  Thu Apr 26 08:11:53 2007
From: christian.perone at gmail.com (Christian S. Perone)
Date: Thu Apr 26 08:12:30 2007
Subject: [mod_python] PSP (exit/quit/return statement)
In-Reply-To: <463036B8.6090909@natlab.research.philips.com>
References: <1f6dbaf0704250603m1cdc372ewb85514f1caa8016@mail.gmail.com>
	<88e286470704251447m1a26505ema5abcb35a129c65b@mail.gmail.com>
	<463036B8.6090909@natlab.research.philips.com>
Message-ID: <1f6dbaf0704260511t4ed855dbgfbbed7009af41dde@mail.gmail.com>

Well, in my mind, it's a programming bad practice, cause aborting the flow
of program can make it hard to maintain and debug by creating multiple
exit points, some use the maxim "one way in and one way out",
and this is true and specifically important inside loops. But the point is
that: this must
be avoided by programmer, not in the language. I think that will be
a nice feature in mod_python, the syntax can be like in myghty templating
system: request.abort(status_code=None), and can be implemented using
the approach that Mike said.
It's just a suggestion, thank you for help.

- Christian S. Perone

On 4/26/07, Mike Looijmans <nlv11281@natlab.research.philips.com> wrote:
>
> Raising an exception will get you there, with some help. If you wrap
> your PSP page in a publisher handler, you can create a "Abort" exception
> class that you catch silently.
>
> class Abort(Exception): pass
>
> try:
>    PSP...
> except Abort:
>    pass
> except:
>    ... normal handling...
>
>
> Mike Looijmans
> Philips Natlab / Topic Automation
>
>
> Graham Dumpleton wrote:
> > On 25/04/07, Christian S. Perone <christian.perone@gmail.com> wrote:
> >
> >> Hello, there is an exit, quit, abort or return like statement for psp ?
> >> For example, I want to do that:
> >>
> >> <%
> >> req.write("1")
> >> [exit statement]
> >> req.write("2")
> >> %>
> >>
> >> in a way that the statement abort the flow of execution and the result
> >> be:
> >> 1
> >>
> >> I have been read the documentation and don't found anything like that.
> >
> >
> > There is no way to currently do it.
> >
> > Some may argue that it is bad practice, but other templating systems
> > do have such a feature.
> >
> > Propose a syntax or mechanism for doing it and if others think it is
> > reasonable it can be added to list of issues to be looked at.
> >
> > Graham
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> >
> >
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>



-- 
Christian S. Perone - christian_perone at gmail dot com
"The effect of music is so very much more powerful and penetrating than is
that of the other arts, for these others speak only of the shadow, but music
of the essence."
- Schopenhauer, Vol. I, Chapter III, The World As Representation
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070426/f8547b59/attachment.html
From christian.perone at gmail.com  Thu Apr 26 08:39:25 2007
From: christian.perone at gmail.com (Christian S. Perone)
Date: Thu Apr 26 08:40:35 2007
Subject: [mod_python] PSP (exit/quit/return statement)
In-Reply-To: <1f6dbaf0704260511t4ed855dbgfbbed7009af41dde@mail.gmail.com>
References: <1f6dbaf0704250603m1cdc372ewb85514f1caa8016@mail.gmail.com>
	<88e286470704251447m1a26505ema5abcb35a129c65b@mail.gmail.com>
	<463036B8.6090909@natlab.research.philips.com>
	<1f6dbaf0704260511t4ed855dbgfbbed7009af41dde@mail.gmail.com>
Message-ID: <1f6dbaf0704260539s513af767r6a3ea05efb9d2774@mail.gmail.com>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: patch_except_psp_py.diff
Type: text/x-diff
Size: 1431 bytes
Desc: not available
Url : http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070426/05b6884b/patch_except_psp_py-0001.bin
From natea at jazkarta.com  Thu Apr 26 10:51:55 2007
From: natea at jazkarta.com (Nate Aune)
Date: Thu Apr 26 10:52:04 2007
Subject: [mod_python] ImportError on mathmodule: undefined symbol: PyFPE_jbuf
Message-ID: <9a89227c0704260751l5b3e7e9bh78a06b32a9c07ee7@mail.gmail.com>

Hello,

I'm trying to set up Trac on my server and having some problems with
mod_python. When I go to the URL of my Trac instance, I get the
following error:

Mod_python error: "PythonHandler trac.web.modpython_frontend"

Traceback (most recent call last):

  File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line
287, in HandlerDispatch
    log=debug)

  File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line
457, in import_module
    module = imp.load_module(mname, f, p, d)

  File "/usr/lib/python2.3/site-packages/trac/web/__init__.py", line 1, in ?
    from trac.web.api import *

  File "/usr/lib/python2.3/site-packages/trac/web/api.py", line 17, in ?
    from BaseHTTPServer import BaseHTTPRequestHandler

  File "/usr/lib/python2.3/BaseHTTPServer.py", line 76, in ?
    import mimetools

  File "/usr/lib/python2.3/mimetools.py", line 6, in ?
    import tempfile

  File "/usr/lib/python2.3/tempfile.py", line 33, in ?
    from random import Random as _Random

  File "/usr/lib/python2.3/random.py", line 42, in ?
    from math import log as _log, exp as _exp, pi as _pi, e as _e

ImportError: /usr/lib/python2.3/lib-dynload/mathmodule.so: undefined
symbol: PyFPE_jbuf

I've also set up the mpinfo for testing/debugging with these lines in
my Apache vhost:

<Location /mpinfo>
   SetHandler mod_python
   PythonHandler mod_python.testhandler
   PythonDebug on
</Location>

When I try to access this url /mpinfo, I get this error:

Mod_python error: "PythonHandler mod_python.testhandler"

Traceback (most recent call last):

  File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line
287, in HandlerDispatch
    log=debug)

  File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line
454, in import_module
    f, p, d = imp.find_module(parts[i], path)

ImportError: No module named testhandler

Does anyone know what might be the problem?

I'm using Trac 0.10.3.1, mod_python-3.1.3, Apache 2.0.52, and CentOS 4
(kernel  2.6.9-48.EL)

thanks,
Nate

-- 
Nate Aune - natea@jazkarta.com
http://www.jazkarta.com
Plone solutions, consulting and development
From ml at dasir.net  Thu Apr 26 10:55:48 2007
From: ml at dasir.net (ml)
Date: Thu Apr 26 10:55:49 2007
Subject: [mod_python] uneven speed results
In-Reply-To: <88e286470704260324v3ab4e68cu3f0d2c6dd54d2f55@mail.gmail.com>
References: <46305CB8.9060504@dasir.net>
	<88e286470704260324v3ab4e68cu3f0d2c6dd54d2f55@mail.gmail.com>
Message-ID: <4630BD74.5000305@dasir.net>

For a large count of requests it gives some constant reply time. But
rarely visited sites have a long "warm up" (sometimes over 2 seconds)
and that is too much. I'm just curious what makes the difference between
e.g. 150ms and 1500ms respond times.

D


Graham Dumpleton napsal(a):
> Using 'ab' with such small numbers of requests always yields
> unreliable results. What do you get if you use 5000-10000 requests?
> 
> Also note that using -k isn't a realistic measure of real world
> performance as no single client is going to trigger large numbers of
> requests over the same connection, so don't use -k when using the
> large number of requests I suggest.
> 
> Graham
> 
> On 26/04/07, ml <ml@dasir.net> wrote:
>> Hi!
>>
>> I was wondering why mod_python (3.2.8) has so uneven speed results, e.g.:
>>
>> # ab -k -c1 -n15 some_python_site
>> ...
>> Percentage of the requests served within a certain time (ms)
>>   50%    158
>>   66%    161
>>   75%    165
>>   80%    166
>>   90%   1173
>>   95%   1209
>>   98%   1209
>>   99%   1209
>>  100%   1209 (longest request)
>>
>> When I compare it to a PHP it has constant response time on each request.
>> I know that the startup can take some more time but sometimes it takes a
>> longer time when I do refreshing the page in a browser so the startup
>> can't affect the response (I think :-).
>>
>> What all does affect the mod_python runtime?
>>
>> David
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>
> 
From sliderw at hotmail.com  Thu Apr 26 14:40:40 2007
From: sliderw at hotmail.com (sliderw hotmail)
Date: Thu Apr 26 14:40:49 2007
Subject: [mod_python] Getting query parameters when there is RewriteRule
In-Reply-To: <88e286470704252005h7d00ac9eh1d6db19eb4d8f34a@mail.gmail.com>
Message-ID: <BAY103-F380EAAA202E9CBBAC031FABD480@phx.gbl>

Doing qp = req.args works (for both cases). I didn't know about req.args. 
Thanks for the suggestion.


>From: "Graham Dumpleton" <graham.dumpleton@gmail.com>
>To: "sliderw hotmail" <sliderw@hotmail.com>
>CC: mod_python@modpython.org
>Subject: Re: [mod_python] Getting query parameters when there is 
>RewriteRule
>Date: Thu, 26 Apr 2007 13:05:00 +1000
>
>On 26/04/07, sliderw hotmail <sliderw@hotmail.com> wrote:
>>In httpd.conf, I have:
>>
>>RewriteRule ^/dl/([^/\?]+)/([^/\?]+)/? /dl/myhandler.py?a=$1&b=$2 [PT,L]
>>
>>and:
>>
>>Alias /dl/ "/some/path/"
>><Directory "/some/path/">
>>   ... mod_python stuff here for myhandler ...
>></Directory>
>>
>>myhandler gets the query parameters using qp =
>>req.parsed_uri[apache.URI_QUERY]. If I go to
>>http://www.mysite.com/dl/myhandler.py?a=1&b=2, qp is "a=1&b=2", as 
>>expected.
>>On the other hand, if I go to http://www.mysite.com/dl/1/2/, qp is None, 
>>but
>>I expect qp is "a=1&b=2". How can I make this work?
>
>Have you enabled debug in mod_rewrite and looked at the rewrite log to
>verify what that your rule matches and is getting rewritten to what
>you expect it to? What does it show?
>
>What is the 'mod_python stuff here for myhandler' which you are using?
>
>Have you tried using 'req.args' instead of getting it out of 
>req.parsed_uri?
>
>There is possibly a better way of doing this which avoids mod_rewrite
>altogether but will have to think about it first before I suggest some
>code to actually try. In short though it involves using a fixuphandler
>to trigger mod_python instead of the Apache configuration. One can be
>explicit about handler you then want executed and pass what you are
>passing through as args as attributes stored against the request
>object. Avoids having to do form args processing in actual response
>handler.
>
>Graham

_________________________________________________________________
Interest Rates NEAR 39yr LOWS!  $430,000 Mortgage for $1,299/mo - Calculate 
new payment 
http://www.lowermybills.com/lre/index.jsp?sourceid=lmb-9632-19132&moid=14888

From graham.dumpleton at gmail.com  Thu Apr 26 17:52:28 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Apr 26 17:52:34 2007
Subject: [mod_python] uneven speed results
In-Reply-To: <4630BD74.5000305@dasir.net>
References: <46305CB8.9060504@dasir.net>
	<88e286470704260324v3ab4e68cu3f0d2c6dd54d2f55@mail.gmail.com>
	<4630BD74.5000305@dasir.net>
Message-ID: <88e286470704261452s1c57abe5gf7fd253a5e824ebb@mail.gmail.com>

The main problem with Python web frameworks is that they are usually
quite huge in comparison to PHP pages. Take for example TurboGears,
just to load it up the basic set of features into memory takes up
15MB. That is even before any requests arrive.

Now, if you run Apache in prefork mode and have up to 25 processes the
amount of memory starts to add up. In a memory constrained box this
may mean having to swap memory back in from disk in the worse case.

Worse is that if you have the idle state of Apache setup to only run a
few processes and create the rest on demand, creating those extra
processes when there is a peak in traffic will result in the slow
startup of loading that 15MB of modules into memory in order to handle
the request.

Further, once the peaks is gone Apache will kill off what it sees and
extra processes to its requirements, so the next time there is a peak
it happens all over again.

Thus, suggested that if running prefork that one set the idle number
of processes to perhaps be larger than normal so no need to create
additional processes when small peaks in demand. Alternative is to use
worker MPM whereby one can make use of multiple threads in a smaller
number of processes.

Graham

On 27/04/07, ml <ml@dasir.net> wrote:
> For a large count of requests it gives some constant reply time. But
> rarely visited sites have a long "warm up" (sometimes over 2 seconds)
> and that is too much. I'm just curious what makes the difference between
> e.g. 150ms and 1500ms respond times.
>
> D
>
>
> Graham Dumpleton napsal(a):
> > Using 'ab' with such small numbers of requests always yields
> > unreliable results. What do you get if you use 5000-10000 requests?
> >
> > Also note that using -k isn't a realistic measure of real world
> > performance as no single client is going to trigger large numbers of
> > requests over the same connection, so don't use -k when using the
> > large number of requests I suggest.
> >
> > Graham
> >
> > On 26/04/07, ml <ml@dasir.net> wrote:
> >> Hi!
> >>
> >> I was wondering why mod_python (3.2.8) has so uneven speed results, e.g.:
> >>
> >> # ab -k -c1 -n15 some_python_site
> >> ...
> >> Percentage of the requests served within a certain time (ms)
> >>   50%    158
> >>   66%    161
> >>   75%    165
> >>   80%    166
> >>   90%   1173
> >>   95%   1209
> >>   98%   1209
> >>   99%   1209
> >>  100%   1209 (longest request)
> >>
> >> When I compare it to a PHP it has constant response time on each request.
> >> I know that the startup can take some more time but sometimes it takes a
> >> longer time when I do refreshing the page in a browser so the startup
> >> can't affect the response (I think :-).
> >>
> >> What all does affect the mod_python runtime?
> >>
> >> David
> >> _______________________________________________
> >> Mod_python mailing list
> >> Mod_python@modpython.org
> >> http://mailman.modpython.org/mailman/listinfo/mod_python
> >>
> >
>
From graham.dumpleton at gmail.com  Thu Apr 26 18:00:54 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Apr 26 18:01:04 2007
Subject: [mod_python] ImportError on mathmodule: undefined symbol:
	PyFPE_jbuf
In-Reply-To: <9a89227c0704260751l5b3e7e9bh78a06b32a9c07ee7@mail.gmail.com>
References: <9a89227c0704260751l5b3e7e9bh78a06b32a9c07ee7@mail.gmail.com>
Message-ID: <88e286470704261500h2f7a0733q40e7b57045b4c2f8@mail.gmail.com>

You likely have some sort of mismatch with what version of Python you
compiled mod_python with and/or which version it is running as and
what installed Python library files are being found.

What version of Python did you believe was used to compile mod_python?

Was the standard Python 2.3.X which is installed on your system?

Do you have multiple versions of Python installed on your system?

Graham

On 27/04/07, Nate Aune <natea@jazkarta.com> wrote:
> Hello,
>
> I'm trying to set up Trac on my server and having some problems with
> mod_python. When I go to the URL of my Trac instance, I get the
> following error:
>
> Mod_python error: "PythonHandler trac.web.modpython_frontend"
>
> Traceback (most recent call last):
>
>   File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line
> 287, in HandlerDispatch
>     log=debug)
>
>   File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line
> 457, in import_module
>     module = imp.load_module(mname, f, p, d)
>
>   File "/usr/lib/python2.3/site-packages/trac/web/__init__.py", line 1, in ?
>     from trac.web.api import *
>
>   File "/usr/lib/python2.3/site-packages/trac/web/api.py", line 17, in ?
>     from BaseHTTPServer import BaseHTTPRequestHandler
>
>   File "/usr/lib/python2.3/BaseHTTPServer.py", line 76, in ?
>     import mimetools
>
>   File "/usr/lib/python2.3/mimetools.py", line 6, in ?
>     import tempfile
>
>   File "/usr/lib/python2.3/tempfile.py", line 33, in ?
>     from random import Random as _Random
>
>   File "/usr/lib/python2.3/random.py", line 42, in ?
>     from math import log as _log, exp as _exp, pi as _pi, e as _e
>
> ImportError: /usr/lib/python2.3/lib-dynload/mathmodule.so: undefined
> symbol: PyFPE_jbuf
>
> I've also set up the mpinfo for testing/debugging with these lines in
> my Apache vhost:
>
> <Location /mpinfo>
>    SetHandler mod_python
>    PythonHandler mod_python.testhandler
>    PythonDebug on
> </Location>
>
> When I try to access this url /mpinfo, I get this error:
>
> Mod_python error: "PythonHandler mod_python.testhandler"
>
> Traceback (most recent call last):
>
>   File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line
> 287, in HandlerDispatch
>     log=debug)
>
>   File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line
> 454, in import_module
>     f, p, d = imp.find_module(parts[i], path)
>
> ImportError: No module named testhandler
>
> Does anyone know what might be the problem?
>
> I'm using Trac 0.10.3.1, mod_python-3.1.3, Apache 2.0.52, and CentOS 4
> (kernel  2.6.9-48.EL)
>
> thanks,
> Nate
>
> --
> Nate Aune - natea@jazkarta.com
> http://www.jazkarta.com
> Plone solutions, consulting and development
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From nlv11281 at natlab.research.philips.com  Fri Apr 27 02:02:08 2007
From: nlv11281 at natlab.research.philips.com (Mike Looijmans)
Date: Fri Apr 27 02:02:28 2007
Subject: [mod_python] uneven speed results
In-Reply-To: <4630BD74.5000305@dasir.net>
References: <46305CB8.9060504@dasir.net>	<88e286470704260324v3ab4e68cu3f0d2c6dd54d2f55@mail.gmail.com>
	<4630BD74.5000305@dasir.net>
Message-ID: <463191E0.1070309@natlab.research.philips.com>

Like Graham wrote, the prefork needs to load Python and your framework.

I usually configure Apache to use the worker MPM with many threads and 
few processes. The threading of Python is good on single-CPU systems, 
and for multi-CPU systems, just set the min number of processes to equal 
the number of CPUs to compensate. This reduces the memory consumption of 
Apache with mod_python considerably, aiding performance.

If you want a constant response time, you may want to consider using CGI 
for rarely-used sites. The response will be slower, since starting the 
interpreter takes about 20 ms. Since you report 150ms as shortest time, 
I do not think this solution viable for your application.



Mike Looijmans
Philips Natlab / Topic Automation


ml wrote:
> For a large count of requests it gives some constant reply time. But
> rarely visited sites have a long "warm up" (sometimes over 2 seconds)
> and that is too much. I'm just curious what makes the difference between
> e.g. 150ms and 1500ms respond times.
> 
> D
> 
> 
> Graham Dumpleton napsal(a):
> 
>>Using 'ab' with such small numbers of requests always yields
>>unreliable results. What do you get if you use 5000-10000 requests?
>>
>>Also note that using -k isn't a realistic measure of real world
>>performance as no single client is going to trigger large numbers of
>>requests over the same connection, so don't use -k when using the
>>large number of requests I suggest.
>>
>>Graham
>>
>>On 26/04/07, ml <ml@dasir.net> wrote:
>>
>>>Hi!
>>>
>>>I was wondering why mod_python (3.2.8) has so uneven speed results, e.g.:
>>>
>>># ab -k -c1 -n15 some_python_site
>>>...
>>>Percentage of the requests served within a certain time (ms)
>>>  50%    158
>>>  66%    161
>>>  75%    165
>>>  80%    166
>>>  90%   1173
>>>  95%   1209
>>>  98%   1209
>>>  99%   1209
>>> 100%   1209 (longest request)
>>>
>>>When I compare it to a PHP it has constant response time on each request.
>>>I know that the startup can take some more time but sometimes it takes a
>>>longer time when I do refreshing the page in a browser so the startup
>>>can't affect the response (I think :-).
>>>
>>>What all does affect the mod_python runtime?
>>>
>>>David
>>>_______________________________________________
>>>Mod_python mailing list
>>>Mod_python@modpython.org
>>>http://mailman.modpython.org/mailman/listinfo/mod_python
>>>
>>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 
> 
> 



From graham.dumpleton at gmail.com  Fri Apr 27 07:39:28 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Fri Apr 27 07:39:43 2007
Subject: [mod_python] Python 3.0/Guido and mod_python.
Message-ID: <88e286470704270439j73f45e10jd0687de9ff26e86b@mail.gmail.com>

I'm too lazy to read and understand what the discussion is all about,
but Guido makes reference to mod_python in a discussion about some
extensions to Python 3.0 which if done would make it impossible to run
mod_python with Python 3.0. The discussions are at:

http://groups.google.com/group/Numpy-discussion/browse_thread/thread/e3dac7bd178c9b6d/4c8c70ceadbaa2bd?lnk=st&q=mod_python&rnum=10#4c8c70ceadbaa2bd

An interesting quote from Guido is:

"""I would like to let users modify the built-ins, but such changes
ought to be isolated from other interpreters running in the same
address space. I don't want to be the one to tell the mod_python
community they won't be able to upgrade to 3.0... """

We will have to see what happens.

Graham
From grisha at modpython.org  Fri Apr 27 11:01:40 2007
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Apr 27 11:01:50 2007
Subject: [mod_python] Python 3.0/Guido and mod_python.
In-Reply-To: <88e286470704270439j73f45e10jd0687de9ff26e86b@mail.gmail.com>
References: <88e286470704270439j73f45e10jd0687de9ff26e86b@mail.gmail.com>
Message-ID: <20070427105906.K45239@grisha.dyndns.org>


Interesting... It doesn't look like it's anything we could control though 
- worst case there will be no more multiple interpreters (as I understood 
it), which wouldn't be the end of the world, but it's really nice to know 
that mod_python is seriously considered in the design discussions!

On Fri, 27 Apr 2007, Graham Dumpleton wrote:

> I'm too lazy to read and understand what the discussion is all about,
> but Guido makes reference to mod_python in a discussion about some
> extensions to Python 3.0 which if done would make it impossible to run
> mod_python with Python 3.0. The discussions are at:
>
> http://groups.google.com/group/Numpy-discussion/browse_thread/thread/e3dac7bd178c9b6d/4c8c70ceadbaa2bd?lnk=st&q=mod_python&rnum=10#4c8c70ceadbaa2bd
>
> An interesting quote from Guido is:
>
> """I would like to let users modify the built-ins, but such changes
> ought to be isolated from other interpreters running in the same
> address space. I don't want to be the one to tell the mod_python
> community they won't be able to upgrade to 3.0... """
>
> We will have to see what happens.
>
> Graham
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From sh23 at leicester.ac.uk  Fri Apr 27 11:46:54 2007
From: sh23 at leicester.ac.uk (S.Hayles)
Date: Fri Apr 27 11:46:59 2007
Subject: [mod_python] Python 3.0/Guido and mod_python.
In-Reply-To: <88e286470704270439j73f45e10jd0687de9ff26e86b@mail.gmail.com>
References: <88e286470704270439j73f45e10jd0687de9ff26e86b@mail.gmail.com>
Message-ID: <Pine.LNX.4.62.0704271640340.3280@falcon.le.ac.uk>


My non-expert reading of this is that changes to built-ins need to be
isolated from other interpreters running in the same address space so 
they don't make mod_python unusable.

But I could be wrong.

Steven

Steven Hayles - Computer Systems Developer, sh23@le.ac.uk
Web and e-learning Services, IT Services, Computer Centre,
University of Leicester, University Rd, Leicester, LE1 7RH 
Fax (0/+44)116 2525027 WWW <URL:http://www.le.ac.uk/home/sh23>

On Fri, 27 Apr 2007, Graham Dumpleton wrote:

> I'm too lazy to read and understand what the discussion is all about,
> but Guido makes reference to mod_python in a discussion about some
> extensions to Python 3.0 which if done would make it impossible to run
> mod_python with Python 3.0. The discussions are at:
>
> http://groups.google.com/group/Numpy-discussion/browse_thread/thread/e3dac7bd178c9b6d/4c8c70ceadbaa2bd?lnk=st&q=mod_python&rnum=10#4c8c70ceadbaa2bd
>
> An interesting quote from Guido is:
>
> """I would like to let users modify the built-ins, but such changes
> ought to be isolated from other interpreters running in the same
> address space. I don't want to be the one to tell the mod_python
> community they won't be able to upgrade to 3.0... """
>
> We will have to see what happens.
>
> Graham
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From rogerb at rogerbinns.com  Mon Apr 30 19:47:02 2007
From: rogerb at rogerbinns.com (Roger Binns)
Date: Mon Apr 30 19:47:09 2007
Subject: [mod_python] Access checking against another path
Message-ID: <46367FF6.2060601@rogerbinns.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

I have two separate paths in my web server.  One is /admin below which
is a web based administration application.  The other is a REST style
api which is available as /api/object/{list,create,delete}

In the web admin pages, I need to include information from the api but
can't see how to do it.  Note that the web administrator will have set
authentication/authorization on the /api path (eg all users can list,
only some can create and delete).

Effectively I need to be able to construct a new request object within
the admin code pointing to the api code, copy across the authentication
information from the admin request, issue the request and read the results.

The alternative is for the web administrator to also have to put
authentication and access control on the web admin, but then that is two
locations and the web admin doesn't have the same granularity as the
REST urls+methods.

Roger
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)

iD8DBQFGNn/2mOOfHg372QQRApMfAJ0Te7pEPI1l2MNs+otOVgqAxM36TwCg4/vI
2xAQ+sZhz+QmeU8Ec1JcWSU=
=96xI
-----END PGP SIGNATURE-----
From roberto at connexer.com  Mon Apr 30 19:59:32 2007
From: roberto at connexer.com (Roberto =?iso-8859-1?Q?C=2E_S=E1nchez?=)
Date: Mon Apr 30 19:59:37 2007
Subject: [mod_python] Access checking against another path
In-Reply-To: <46367FF6.2060601@rogerbinns.com>
References: <46367FF6.2060601@rogerbinns.com>
Message-ID: <20070430235932.GD27028@miami.connexer.com>

On Mon, Apr 30, 2007 at 04:47:02PM -0700, Roger Binns wrote:
> I have two separate paths in my web server.  One is /admin below which
> is a web based administration application.  The other is a REST style
> api which is available as /api/object/{list,create,delete}
> 
> In the web admin pages, I need to include information from the api but
> can't see how to do it.  Note that the web administrator will have set
> authentication/authorization on the /api path (eg all users can list,
> only some can create and delete).
> 
Have you considered cookies?

Regards,

-Roberto

-- 
Roberto C. S?nchez
http://people.connexer.com/~roberto
http://www.connexer.com
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070430/e955f118/attachment.bin
From graham.dumpleton at gmail.com  Mon Apr 30 20:00:23 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Apr 30 20:00:28 2007
Subject: [mod_python] Access checking against another path
In-Reply-To: <46367FF6.2060601@rogerbinns.com>
References: <46367FF6.2060601@rogerbinns.com>
Message-ID: <88e286470704301700s626b9945ha7438de0feac1bb5@mail.gmail.com>

On 01/05/07, Roger Binns <rogerb@rogerbinns.com> wrote:
> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
>
> I have two separate paths in my web server.  One is /admin below which
> is a web based administration application.  The other is a REST style
> api which is available as /api/object/{list,create,delete}
>
> In the web admin pages, I need to include information from the api but
> can't see how to do it.  Note that the web administrator will have set
> authentication/authorization on the /api path (eg all users can list,
> only some can create and delete).
>
> Effectively I need to be able to construct a new request object within
> the admin code pointing to the api code, copy across the authentication
> information from the admin request, issue the request and read the results.
>
> The alternative is for the web administrator to also have to put
> authentication and access control on the web admin, but then that is two
> locations and the web admin doesn't have the same granularity as the
> REST urls+methods.

Perhaps look at the req.internal_redirect() method. See:

  http://www.modpython.org/live/current/doc-html/pyapi-mprequest-meth.html

If you need access to req.user of the parent request from the sub
request, you have to access req.prev.user from the sub request to get
it from memory.

Graham
From rogerb at rogerbinns.com  Mon Apr 30 20:07:52 2007
From: rogerb at rogerbinns.com (Roger Binns)
Date: Mon Apr 30 20:07:55 2007
Subject: [mod_python] Access checking against another path
In-Reply-To: <88e286470704301700s626b9945ha7438de0feac1bb5@mail.gmail.com>
References: <46367FF6.2060601@rogerbinns.com>
	<88e286470704301700s626b9945ha7438de0feac1bb5@mail.gmail.com>
Message-ID: <463684D8.6030906@rogerbinns.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Graham Dumpleton wrote:
> Perhaps look at the req.internal_redirect() method. See:
> 
>  http://www.modpython.org/live/current/doc-html/pyapi-mprequest-meth.html
> 
> If you need access to req.user of the parent request from the sub
> request, you have to access req.prev.user from the sub request to get
> it from memory.

As far as I can tell, that method does an actual redirect which is not
what I want.  In the output of /admin, I want to include the output of
/api/object/whatever (amongst other things).

If they were running on different web servers then I would have to use a
HTTP client and do things that way.  In this case they are running on
the same server, and the minimum I need to answer is "are the
credentials supplied to /admin sufficient for /api/object/whatever"

Roger
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)

iD8DBQFGNoTYmOOfHg372QQRAgKPAKCWLGO8oRU+8vsPRTuGvOkwb6S0eACfW+od
D1MhH6pkrkLYe85cMkBS7aU=
=TUjI
-----END PGP SIGNATURE-----
From rogerb at rogerbinns.com  Mon Apr 30 20:16:01 2007
From: rogerb at rogerbinns.com (Roger Binns)
Date: Mon Apr 30 20:16:04 2007
Subject: [mod_python] Access checking against another path
In-Reply-To: <20070430235932.GD27028@miami.connexer.com>
References: <46367FF6.2060601@rogerbinns.com>
	<20070430235932.GD27028@miami.connexer.com>
Message-ID: <463686C1.8010006@rogerbinns.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Roberto C. S?nchez wrote:
> Have you considered cookies?

They won't help :-(.  The problem I am trying to solve is the
administrator not having to set duplicate authentication and access
control directives.  They should set them once on /api/object/whatever.

But then in the code below /admin I need to perform actions on object as
well as providing HTML user interface.  I don't want the web
administrator to have to set another set of authentication and access
control on /admin.

That means the code in /admin has to use the credentials it was supplied
with and ask /api/object/whatever if they are ok.

Roger
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)

iD8DBQFGNobBmOOfHg372QQRArflAJ0WbQfJ0TE2I1qX8N9V8huTdTRT4wCgwLgq
RbjYcoU6BSikFkCgdSfn+vU=
=FP3u
-----END PGP SIGNATURE-----
From graham.dumpleton at gmail.com  Mon Apr 30 20:30:37 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Apr 30 20:30:40 2007
Subject: [mod_python] Access checking against another path
In-Reply-To: <463684D8.6030906@rogerbinns.com>
References: <46367FF6.2060601@rogerbinns.com>
	<88e286470704301700s626b9945ha7438de0feac1bb5@mail.gmail.com>
	<463684D8.6030906@rogerbinns.com>
Message-ID: <88e286470704301730u2b660dd5r718b2ba5fbdfc6ee@mail.gmail.com>

On 01/05/07, Roger Binns <rogerb@rogerbinns.com> wrote:
> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
>
> Graham Dumpleton wrote:
> > Perhaps look at the req.internal_redirect() method. See:
> >
> >  http://www.modpython.org/live/current/doc-html/pyapi-mprequest-meth.html
> >
> > If you need access to req.user of the parent request from the sub
> > request, you have to access req.prev.user from the sub request to get
> > it from memory.
>
> As far as I can tell, that method does an actual redirect which is not
> what I want.  In the output of /admin, I want to include the output of
> /api/object/whatever (amongst other things).
>
> If they were running on different web servers then I would have to use a
> HTTP client and do things that way.  In this case they are running on
> the same server, and the minimum I need to answer is "are the
> credentials supplied to /admin sufficient for /api/object/whatever"

The method req.internal_redirect() does it all within the web server,
it is not sending back a redirect to the web browser client. It is not
even possible using req.internal_redirect() to make a request against
another web server unless the target of the internal request so
happened be a resource configure using mod_proxy to be redirected to
some downstream server.

Note that when using req.internal_redirect(), that called resource
then effectively generates the complete response. If you want the
output of the sub request to be included as a subcomponent of HTML of
parent, then you would really need to do a Python import to get access
to Python code for your sub handler and invoke direct as Python code.

Graham
From roberto at connexer.com  Mon Apr 30 20:32:36 2007
From: roberto at connexer.com (Roberto =?iso-8859-1?Q?C=2E_S=E1nchez?=)
Date: Mon Apr 30 20:32:39 2007
Subject: [mod_python] Access checking against another path
In-Reply-To: <463686C1.8010006@rogerbinns.com>
References: <46367FF6.2060601@rogerbinns.com>
	<20070430235932.GD27028@miami.connexer.com>
	<463686C1.8010006@rogerbinns.com>
Message-ID: <20070501003236.GE27028@miami.connexer.com>

On Mon, Apr 30, 2007 at 05:16:01PM -0700, Roger Binns wrote:
> Roberto C. S?nchez wrote:
> > Have you considered cookies?
> 
> They won't help :-(.  The problem I am trying to solve is the
> administrator not having to set duplicate authentication and access
> control directives.  They should set them once on /api/object/whatever.
> 
> But then in the code below /admin I need to perform actions on object as
> well as providing HTML user interface.  I don't want the web
> administrator to have to set another set of authentication and access
> control on /admin.
> 
> That means the code in /admin has to use the credentials it was supplied
> with and ask /api/object/whatever if they are ok.
> 
OK.  I misunderstood what you were trying to accomplish.

Feel free to ignore me :-)

Regards,

-Roberto

-- 
Roberto C. S?nchez
http://people.connexer.com/~roberto
http://www.connexer.com
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070430/4b75c5a7/attachment.bin
From rogerb at rogerbinns.com  Mon Apr 30 20:47:48 2007
From: rogerb at rogerbinns.com (Roger Binns)
Date: Mon Apr 30 20:47:50 2007
Subject: [mod_python] Access checking against another path
In-Reply-To: <88e286470704301730u2b660dd5r718b2ba5fbdfc6ee@mail.gmail.com>
References: <46367FF6.2060601@rogerbinns.com>	
	<88e286470704301700s626b9945ha7438de0feac1bb5@mail.gmail.com>	
	<463684D8.6030906@rogerbinns.com>
	<88e286470704301730u2b660dd5r718b2ba5fbdfc6ee@mail.gmail.com>
Message-ID: <46368E34.1060008@rogerbinns.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Graham Dumpleton wrote:
> Note that when using req.internal_redirect(), that called resource
> then effectively generates the complete response. If you want the
> output of the sub request to be included as a subcomponent of HTML of
> parent, then you would really need to do a Python import to get access
> to Python code for your sub handler and invoke direct as Python code.

I still don't see how this helps me.  It is closer, but doesn't solve
the fundamental problem of wanting to check the access control.  My
handler code for /admin would look something like this:

def handler(req):
  print "Hello world"

  # I can't see how to do the next two lines which could have
  # different permissions
  ... check credentials in req against "/api/object/list"
  ... check credentials in req against "/api/object3/delete"

  # The next two could be done by calling the code that
  # implements /api directly (or playing with internal_redirect)
  items=request("/api/object/list")
  request("/api/%s/delete" % (items[3],))

  print "more output saying item3 was deleted"

Roger
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)

iD8DBQFGNo40mOOfHg372QQRAktzAKCn9wC9l6qV7RsA9BuHu7qJJj9e0wCgo+1I
/zTA5dlHINjEVFZZvv9I8k8=
=hzjQ
-----END PGP SIGNATURE-----
From graham.dumpleton at gmail.com  Mon Apr 30 21:32:35 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Apr 30 21:32:40 2007
Subject: [mod_python] Access checking against another path
In-Reply-To: <46368E34.1060008@rogerbinns.com>
References: <46367FF6.2060601@rogerbinns.com>
	<88e286470704301700s626b9945ha7438de0feac1bb5@mail.gmail.com>
	<463684D8.6030906@rogerbinns.com>
	<88e286470704301730u2b660dd5r718b2ba5fbdfc6ee@mail.gmail.com>
	<46368E34.1060008@rogerbinns.com>
Message-ID: <88e286470704301832k7cc290eetd82a55f393241b53@mail.gmail.com>

On 01/05/07, Roger Binns <rogerb@rogerbinns.com> wrote:
> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
>
> Graham Dumpleton wrote:
> > Note that when using req.internal_redirect(), that called resource
> > then effectively generates the complete response. If you want the
> > output of the sub request to be included as a subcomponent of HTML of
> > parent, then you would really need to do a Python import to get access
> > to Python code for your sub handler and invoke direct as Python code.
>
> I still don't see how this helps me.  It is closer, but doesn't solve
> the fundamental problem of wanting to check the access control.  My
> handler code for /admin would look something like this:
>
> def handler(req):
>   print "Hello world"
>
>   # I can't see how to do the next two lines which could have
>   # different permissions
>   ... check credentials in req against "/api/object/list"
>   ... check credentials in req against "/api/object3/delete"
>
>   # The next two could be done by calling the code that
>   # implements /api directly (or playing with internal_redirect)
>   items=request("/api/object/list")
>   request("/api/%s/delete" % (items[3],))
>
>   print "more output saying item3 was deleted"

What type of authentication is being used? Is it 'Basic' for AuthType
or something entirely different?

The problem is that the way you are doing it is more or less
circumventing Apache's normal authentication mechanisms. Even if one
had access to the full Apache C API am not sure you could do it in a
way that would be seen as being correct for the way Apache works.

The only way I could conceive of you being able to do it then would be
using a session/cookie based mechanism as other person suggested, with
concept of user roles whereby user who hasn't logged in through web
form doesn't have rights to do stuff. Ie., the sub handlers when
called as Python objects would check what role session has and reject
call if not required rights.

Graham
