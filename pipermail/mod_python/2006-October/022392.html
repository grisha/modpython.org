<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] util.FieldStorage
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20util.FieldStorage&In-Reply-To=E4EB1BDA-5608-4DA4-A7D1-72F413565FEF%40dscpl.com.au">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022391.html">
   <LINK REL="Next"  HREF="022393.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] util.FieldStorage</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20util.FieldStorage&In-Reply-To=E4EB1BDA-5608-4DA4-A7D1-72F413565FEF%40dscpl.com.au"
       TITLE="[mod_python] util.FieldStorage">grahamd at dscpl.com.au
       </A><BR>
    <I>Thu Oct 26 06:12:17 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="022391.html">[mod_python] util.FieldStorage
</A></li>
        <LI>Next message: <A HREF="022393.html">[mod_python] util.FieldStorage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22392">[ date ]</a>
              <a href="thread.html#22392">[ thread ]</a>
              <a href="subject.html#22392">[ subject ]</a>
              <a href="author.html#22392">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Yes, FieldStorage in 3.3 is broken in as much as add_field() if called
after the first time that the 'dictionary' attribute is accessed in  
some way,
does not result in that value ending up in the dictionary. Thus it is  
not
visible to __getitem__(), has_key() etc.

Something else to fix. :-(

Graham

On 26/10/2006, at 7:56 PM, Graham Dumpleton wrote:

&gt;<i> The util.FieldStorage implementation in mod_python 3.3 is quite a bit
</I>&gt;<i> different to what is used in older versions of mod_python and which
</I>&gt;<i> you based your changes upon. Thus your changes are not compatible
</I>&gt;<i> with the new code base.
</I>&gt;<i>
</I>&gt;<i> Some have talked about making the new implementation of the
</I>&gt;<i> FieldStorage class more dictionary like than it is, but no one has
</I>&gt;<i> stepped up to provide any changes.
</I>&gt;<i>
</I>&gt;<i> To be honest I haven't actually looked into how FieldStorage is
</I>&gt;<i> implemented as someone outside of the core developers provided
</I>&gt;<i> the updated code and it was integrated by someone other than
</I>&gt;<i> myself. Looking at the code now, I actually think it might be a bit
</I>&gt;<i> broken. I'll have to do some playing with the code.
</I>&gt;<i>
</I>&gt;<i> BTW, what benefits do you think you get if it is more dictionary like?
</I>&gt;<i> I am not sure I understand the reason for making such changes in
</I>&gt;<i> the first place.
</I>&gt;<i>
</I>&gt;<i> Graham
</I>&gt;<i>
</I>&gt;<i> On 26/10/2006, at 7:14 PM, Brian Bird wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Is there anything in the works to make util.FieldStorage act more  
</I>&gt;&gt;<i> like a real dictionary? Specifically, it doesn&#8217;t support the  
</I>&gt;&gt;<i> __setitem__, __delitem__ methods. Since the documentation states  
</I>&gt;&gt;<i> &quot;it can be treated like a dictionary&#8221; I was surprised to find  
</I>&gt;&gt;<i> these methods missing.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I know it&#8217;s easy to change it to a real dictionary to get these  
</I>&gt;&gt;<i> methods, but then you lose the (very useful) getlist() method. At  
</I>&gt;&gt;<i> first glance it doesn&#8217;t look like much work to add the extra  
</I>&gt;&gt;<i> methods (but I haven&#8217;t looked at how it may affect values which  
</I>&gt;&gt;<i> aren&#8217;t StringField&#8217;s).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I&#8217;ve just looked in the latest subversion and found that the items 
</I>&gt;&gt;<i> () method is now in util.FieldStorage, as well as a method  
</I>&gt;&gt;<i> add_field() which looks suspiciously like __setitem__ should, but  
</I>&gt;&gt;<i> no sign of a __delitem__. However, there now seems to be a  
</I>&gt;&gt;<i> self.dictionary object which could be useful &#8211; perhaps all  
</I>&gt;&gt;<i> unrecognised methods should be passed onto self.dictionary in the  
</I>&gt;&gt;<i> __getattr__ instead of raising an AttributeError?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I&#8217;ve put below what I thought needed adding to the  
</I>&gt;&gt;<i> util.FieldStorage class before I noticed self.dictionary in case  
</I>&gt;&gt;<i> it&#8217;s any help.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ### Disclaimer &#8211; completely untested! J ###
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> def __setitem__(self, key, value):
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     self.list.append(util.Field(key, cStringIO.StringIO(key),  
</I>&gt;&gt;<i> &quot;text/plain&quot;, {}, None, {}))
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> def __delitem__(self, key):
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     for item in self.list:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         if item.name == key:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>             self.list.remove(item)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> def items(self):
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     result = []
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     for key in self.keys():
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         result.append((key, self[key]))
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     return result
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> def update(self, d):
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     for k in d.keys():
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         self[k] = d[k]
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>

</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022391.html">[mod_python] util.FieldStorage
</A></li>
	<LI>Next message: <A HREF="022393.html">[mod_python] util.FieldStorage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22392">[ date ]</a>
              <a href="thread.html#22392">[ thread ]</a>
              <a href="subject.html#22392">[ subject ]</a>
              <a href="author.html#22392">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
