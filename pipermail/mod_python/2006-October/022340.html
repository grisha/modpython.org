<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] ReportLab integration
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20ReportLab%20integration&In-Reply-To=007701c6f157%2412893af0%24800101df%40qlf.local">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022336.html">
   <LINK REL="Next"  HREF="022341.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] ReportLab integration</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Colin Bean</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20ReportLab%20integration&In-Reply-To=007701c6f157%2412893af0%24800101df%40qlf.local"
       TITLE="[mod_python] ReportLab integration">ccbean at gmail.com
       </A><BR>
    <I>Mon Oct 16 15:44:03 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="022336.html">[mod_python] Mod_python and Javascript
</A></li>
        <LI>Next message: <A HREF="022341.html">[mod_python] ReportLab integration
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22340">[ date ]</a>
              <a href="thread.html#22340">[ thread ]</a>
              <a href="subject.html#22340">[ subject ]</a>
              <a href="author.html#22340">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Jim,

So you're just getting a blank page in IE when you try to access your
pdf?  One case is that the content is actually being sent to IE, and
IE isn't displaying to properly, another is the content isn't being
sent correctly / completely.  I'm guessing it's the first, since
there's not much that's browser-dependent in your code, but you might
want to check this.  In the past, I&quot;ve used a lightweight http proxy
(pick your flavor -- webscarab worked well for me) between browser and
server, to make sure that the complete content is actually being sent
to the browser.

So, assuming the pdf content is actually being send but IE won't display it:
Just realized that the microsoft KB article never mentions this
(sorry), but if you change &quot;content-disposition: attachment...&quot; to
&quot;content-disposition: inline...&quot;, it will set the filename / type for
inline display like you're looking for.

Here's another snippet that talks about handling pdf content (it's for
java, but mainly deals with headers / filename stuff):
<A HREF="http://www.rgagnon.com/javadetails/java-0404.html">http://www.rgagnon.com/javadetails/java-0404.html</A>

hth,
Colin



On 10/16/06, Jim Steil &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">jim at qlf.com</A>&gt; wrote:
&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> It runs my script, but doesn't go anywhere when it is done.  The code looks
</I>&gt;<i> like this:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ---------------------
</I>&gt;<i>
</I>&gt;<i> # Create the document.
</I>&gt;<i>
</I>&gt;<i> reportPeriod = 'Report for the Month of %s %s' % (months[reportMonth],
</I>&gt;<i> reportYear)
</I>&gt;<i>
</I>&gt;<i> output = StringIO.StringIO()
</I>&gt;<i>
</I>&gt;<i> doc = SimpleDocTemplate(output, pagesize=landscape(letter))
</I>&gt;<i>
</I>&gt;<i> doc.m = reportPeriod
</I>&gt;<i>
</I>&gt;<i> go(doc, reportMonth, reportYear)
</I>&gt;<i>
</I>&gt;<i> # Return the rendered page content.
</I>&gt;<i>
</I>&gt;<i> content = output.getvalue()
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> req.content_type = &quot;application/pdf&quot;
</I>&gt;<i>
</I>&gt;<i> req.headers_out['Content-Length'] = str(len(content))
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> # Internet Explorer chokes on this with PDFs.
</I>&gt;<i>
</I>&gt;<i> #req.headers_out['Pragma'] = 'no-cache'
</I>&gt;<i>
</I>&gt;<i> #req.headers_out['Cache-Control'] = 'no-cache'
</I>&gt;<i>
</I>&gt;<i> #req.headers_out['Expires'] = '-1'
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> req.send_http_header()
</I>&gt;<i>
</I>&gt;<i> req.write(content)
</I>&gt;<i>
</I>&gt;<i> return apache.OK
</I>&gt;<i>
</I>&gt;<i> ---------------------
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> This works fine in Firefox, but doesn't do anything in IE.  The comment in
</I>&gt;<i> the code about Internet Explorer choking was there in Grahams example.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I looked at the link you provided, but it seems to speak about doing a Save
</I>&gt;<i> As when you display the content.  That is not what I'm trying to accomplish.
</I>&gt;<i>  I want the pdf to come back to the screen, but have it come back with a
</I>&gt;<i> name.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>       -Jim
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Jim Steil
</I>&gt;<i>
</I>&gt;<i> IT Manager
</I>&gt;<i>
</I>&gt;<i> Quality Liquid Feeds
</I>&gt;<i>
</I>&gt;<i> (608) 935-2345
</I>&gt;<i>
</I>&gt;<i> (608) 341-9896 cell
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -----Original Message-----
</I>&gt;<i>  From: Colin Bean [mailto:<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">ccbean at gmail.com</A>]
</I>&gt;<i>  Sent: Monday, October 16, 2006 2:05 PM
</I>&gt;<i>  To: Jim Steil
</I>&gt;<i>  Cc: <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mod_python at modpython.org</A>
</I>&gt;<i>  Subject: Re: [mod_python] ReportLab integration
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Hi Jim,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> How does it break in IE?  If it it won't recognize the result is a
</I>&gt;<i>
</I>&gt;<i> pdf, try setting the content-disposition header.  You can use this to
</I>&gt;<i>
</I>&gt;<i> specify a filename that browser will save your file as; if you give it
</I>&gt;<i>
</I>&gt;<i> a .pdf extension then IE should open it fine.  Here's a little more
</I>&gt;<i>
</I>&gt;<i> info on it:
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://support.microsoft.com/kb/260519">http://support.microsoft.com/kb/260519</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I *think* that changing your handler to use a .pdf extension will do
</I>&gt;<i>
</I>&gt;<i> the same thing (I haven't used publisher yet so I'm not sure how to do
</I>&gt;<i>
</I>&gt;<i> this); the content disposition trick might be easier, though.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -Colin
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On 10/16/06, Jim Steil &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">jim at qlf.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt; Graham:
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt; Thanks so much for the examples.  That's exactly what I needed.  I used
</I>&gt;<i> the
</I>&gt;<i>
</I>&gt;<i> &gt; example in Reportlab-demo.py and it is working great in FireFox, but not
</I>&gt;<i> in
</I>&gt;<i>
</I>&gt;<i> &gt; IE.  There is a comment in the source about IE choking on some code but I
</I>&gt;<i>
</I>&gt;<i> &gt; don't know how to get around that.  Also, is there some trick or
</I>&gt;<i>
</I>&gt;<i> &gt; configuration I need to do to get a .pdf extension on my url?  I'm using
</I>&gt;<i> the
</I>&gt;<i>
</I>&gt;<i> &gt; publisher handler.
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt; Thanks again.  What I've got working now really helps, and getting around
</I>&gt;<i>
</I>&gt;<i> &gt; these 2 issues would just be icing on the cake!
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;             -Jim
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt; Jim Steil
</I>&gt;<i>
</I>&gt;<i> &gt;  IT Manager
</I>&gt;<i>
</I>&gt;<i> &gt;  Quality Liquid Feeds
</I>&gt;<i>
</I>&gt;<i> &gt;  (608) 935-2345
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt; (608) 341-9896 cell
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;  ________________________________
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt; From: Graham Dumpleton [mailto:<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">grahamd at dscpl.com.au</A>]
</I>&gt;<i>
</I>&gt;<i> &gt;  Sent: Saturday, October 14, 2006 12:54 AM
</I>&gt;<i>
</I>&gt;<i> &gt;  To: Jim Steil
</I>&gt;<i>
</I>&gt;<i> &gt;  Cc: <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mod_python at modpython.org</A>
</I>&gt;<i>
</I>&gt;<i> &gt;  Subject: Re: [mod_python] ReportLab integration
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt; On 14/10/2006, at 6:25 AM, Jim Steil wrote:
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt; Can someone help get me pointed in the right direction?  I want to allow a
</I>&gt;<i>
</I>&gt;<i> &gt; user to request a PDF from my mod_python app.  When they do so, I want to
</I>&gt;<i>
</I>&gt;<i> &gt; generate the PDF on the fly with ReportLab and then send the resulting PDF
</I>&gt;<i>
</I>&gt;<i> &gt; back to the browser without saving it anywhere.  I've done some searches
</I>&gt;<i> on
</I>&gt;<i>
</I>&gt;<i> &gt; the web but can't seem to find examples of doing this with just mod_python
</I>&gt;<i>
</I>&gt;<i> &gt; and ReportLab.  I've seen examples of using other tools, but not just
</I>&gt;<i>
</I>&gt;<i> &gt; mod_python.  This sounds like something others are probably doing, but I
</I>&gt;<i>
</I>&gt;<i> &gt; need a push in the right direction.  Thanks in advance for your time.
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt; Try:
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i> <A HREF="http://www.dscpl.com.au/projects/vampire/examples/reportlab/reportlab-demo.pdf">http://www.dscpl.com.au/projects/vampire/examples/reportlab/reportlab-demo.pdf</A>
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt; This uses reportlab to generate the PDF.
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt; There is also:
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i> <A HREF="http://www.dscpl.com.au/projects/vampire/examples/reportlab/trml2pdf-demo.pdf">http://www.dscpl.com.au/projects/vampire/examples/reportlab/trml2pdf-demo.pdf</A>
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt; This uses free version of tool for converting reportlab RML to PDF.
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt; The actual source code for each is at:
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i> <A HREF="http://www.dscpl.com.au/projects/vampire/source/examples/reportlab/reportlab-demo.py">http://www.dscpl.com.au/projects/vampire/source/examples/reportlab/reportlab-demo.py</A>
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i> <A HREF="http://www.dscpl.com.au/projects/vampire/source/examples/reportlab/_handler.py">http://www.dscpl.com.au/projects/vampire/source/examples/reportlab/_handler.py</A>
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i> <A HREF="http://www.dscpl.com.au/projects/vampire/source/examples/reportlab/trml2pdf-demo.rml">http://www.dscpl.com.au/projects/vampire/source/examples/reportlab/trml2pdf-demo.rml</A>
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt; These happen to use Vampire for the mod_python handler framework,
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt; but you should be able to adapt them to other mod_python handler
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt; systems.
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt; Graham
</I>&gt;<i>
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i>
</I>&gt;<i> &gt; Mod_python mailing list
</I>&gt;<i>
</I>&gt;<i> &gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i>
</I>&gt;<i> &gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> &gt;
</I></PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022336.html">[mod_python] Mod_python and Javascript
</A></li>
	<LI>Next message: <A HREF="022341.html">[mod_python] ReportLab integration
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22340">[ date ]</a>
              <a href="thread.html#22340">[ thread ]</a>
              <a href="subject.html#22340">[ subject ]</a>
              <a href="author.html#22340">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
