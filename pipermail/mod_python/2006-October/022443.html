<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] sendfile problems with IE
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20sendfile%20problems%20with%20IE&In-Reply-To=000a01c6fcfb%242bd29650%24639fcd53%40MARK">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022440.html">
   <LINK REL="Next"  HREF="022441.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] sendfile problems with IE</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Colin Bean</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20sendfile%20problems%20with%20IE&In-Reply-To=000a01c6fcfb%242bd29650%24639fcd53%40MARK"
       TITLE="[mod_python] sendfile problems with IE">ccbean at gmail.com
       </A><BR>
    <I>Tue Oct 31 19:19:22 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="022440.html">[mod_python] sendfile problems with IE
</A></li>
        <LI>Next message: <A HREF="022441.html">[mod_python] Building a web application using Cheetah and
	mod_python
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22443">[ date ]</a>
              <a href="thread.html#22443">[ thread ]</a>
              <a href="subject.html#22443">[ subject ]</a>
              <a href="author.html#22443">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Mark,

Here's a thread that might deal with the same problems (in this case
getting IE to correctly display generated pdfs):
<A HREF="http://modpython.org/pipermail/mod_python/2006-October/022341.html">http://modpython.org/pipermail/mod_python/2006-October/022341.html</A>

And I just realized that I sent a message in reply to this and didn't
re: the list (crap!).  My response is quoted in the reply here,
though:
<A HREF="http://modpython.org/pipermail/mod_python/2006-October/022348.html">http://modpython.org/pipermail/mod_python/2006-October/022348.html</A>

I don't know if any of this will actually apply to what you're doing,
but in the PDF example IE was behaving strangely if the cache-control
header was set at all.   Doesn't look like you're setting it in the
code you provided, but there are some cases where mod_python will set
it on its own (for instance, when you're using sessions or cookies).
Is your code a complete handler, or does it get called in the context
of a larger site?

If it is something with the headers, a lightweight http proxy (I like
webscarab) is a nice way be able to look at the headers exactly as
they are being sent to the client.  You can also use it to verify that
the content is being sent completely.  However you want to do it, it
might be helpful to determine exactly what headers are being set.

The only other thing I can think of is that I usually put quotes
around the filename part of the content-disposition header
('attachment;filename=&quot;taggedhits.xls&quot;').  I don't know if this causes
IE to break or not, but it might be worth trying.

Hopefully some of this helps...

-Colin

On 10/31/06, Mark Norley &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">m_norley_newsgroups at yahoo.co.uk</A>&gt; wrote:
&gt;<i> Hello
</I>&gt;<i>
</I>&gt;<i> Hope this list can save me again ;-)
</I>&gt;<i> This bit of code works fine in Firefox and Netscape but IE doesn't like it:
</I>&gt;<i>
</I>&gt;<i> def handler(req):
</I>&gt;<i>     req.content_type = &quot;application/vnd.ms-excel&quot;
</I>&gt;<i>     req.set_content_length(os.path.getsize(ROOT+'\\taggedhits.xls'))
</I>&gt;<i>     req.headers_out[&quot;Content-Disposition&quot;] = &quot;attachment;
</I>&gt;<i> filename=taggedhits.xls&quot;
</I>&gt;<i>     req.sendfile(ROOT+&quot;\\taggedhits.xls&quot;)
</I>&gt;<i>     return apache.OK
</I>&gt;<i>
</I>&gt;<i> With IE the File Download dialogue looks strange. IE thinks the filename is
</I>&gt;<i> filehandler_py rather than taggedhits.xls:
</I>&gt;<i>
</I>&gt;<i> Name: filehandler_py
</I>&gt;<i> Type: Microsoft Excel Worksheet, 13.5 KB
</I>&gt;<i> From: 'mysite'
</I>&gt;<i>
</I>&gt;<i> filehandler.py is the name of the script for starters, not the file I want
</I>&gt;<i> to download, and why has IE swapped the dot for an underscore?
</I>&gt;<i>
</I>&gt;<i> On pressing Save I get:
</I>&gt;<i> Internet Explorer cannot download filehandler.py from 'mysite'.
</I>&gt;<i> Internet Explorer was not able to open this internet site. The requested
</I>&gt;<i> site is either unavailable or cannot be found. Please try again later.
</I>&gt;<i>
</I>&gt;<i> Does anyone know what I need to do for IE to recognise the file? I'm
</I>&gt;<i> thinking I'm missing a header field or something.
</I>&gt;<i>
</I>&gt;<i> Cheers
</I>&gt;<i> Mark
</I>&gt;<i>
</I>&gt;<i> Win XP SP2
</I>&gt;<i> Python 2.4.2
</I>&gt;<i> Apache 2.2.2
</I>&gt;<i> Mod_python 3.2.10
</I>&gt;<i> Firefox 1.5.0.7
</I>&gt;<i> Netscape 7.2
</I>&gt;<i> IE 6
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> No virus found in this outgoing message.
</I>&gt;<i> Checked by AVG Free Edition.
</I>&gt;<i> Version: 7.1.409 / Virus Database: 268.13.20/508 - Release Date: 31/10/06
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Send instant messages to your online friends <A HREF="http://uk.messenger.yahoo.com">http://uk.messenger.yahoo.com</A>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i>
</I></PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022440.html">[mod_python] sendfile problems with IE
</A></li>
	<LI>Next message: <A HREF="022441.html">[mod_python] Building a web application using Cheetah and
	mod_python
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22443">[ date ]</a>
              <a href="thread.html#22443">[ thread ]</a>
              <a href="subject.html#22443">[ subject ]</a>
              <a href="author.html#22443">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
