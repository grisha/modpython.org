<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Memory Session doesen't
	workwithPythonInterpPerDirectory on Windows
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Memory%20Session%20doesen%27t%0A%09workwithPythonInterpPerDirectory%20on%20Windows&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022370.html">
   <LINK REL="Next"  HREF="022363.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Memory Session doesen't
	workwithPythonInterpPerDirectory on Windows</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Memory%20Session%20doesen%27t%0A%09workwithPythonInterpPerDirectory%20on%20Windows&In-Reply-To="
       TITLE="[mod_python] Memory Session doesen't
	workwithPythonInterpPerDirectory on Windows">grahamd at dscpl.com.au
       </A><BR>
    <I>Wed Oct 18 18:28:00 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="022370.html">[mod_python] Using mod_python with two applications fails on
	FedoraCore 4, works on Window/XP
</A></li>
        <LI>Next message: <A HREF="022363.html">[mod_python] Memory Session doesen't
	workwithPythonInterpPerDirectory on Windows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22356">[ date ]</a>
              <a href="thread.html#22356">[ thread ]</a>
              <a href="subject.html#22356">[ subject ]</a>
              <a href="author.html#22356">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Graham Dumpleton wrote ..
&gt;<i> Luca Montecchiani wrote ..
</I>&gt;<i> &gt; Hi all,
</I>&gt;<i> &gt; this is probably a FAQ but I want to share with you
</I>&gt;<i> &gt; my bad experience.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; I've a situation where /www/dir1/login.py create a session and
</I>&gt;<i> &gt; redirect to /www/dir2/desktop.py that read the session to see
</I>&gt;<i> &gt; if is_new or not.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Unfortunately this doesn't work if you are using:
</I>&gt;<i> &gt; 1) Windows platform
</I>&gt;<i> &gt; 2) PythonOption PythonInterpPerDirectory On
</I>&gt;<i> &gt; 3) PythonOption Session MemorySession
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; The desktop.py check if the session is new and
</I>&gt;<i> &gt; it is always True :-(
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; This seem pretty simple to explain, having Session
</I>&gt;<i> &gt; saved in Memory the second python interpreter (/www/dir2) doesn't
</I>&gt;<i> &gt; &quot;see&quot; the session created by the first interpreter (/www/dir1)
</I>&gt;<i> &gt; because of the PythonInterpPerDirectory option.
</I>
Whoops. Not thinking properly. Yes, use of MemorySession when two
separate interpreters used like this would be an issue and external
database would be needed. This would be the only way of getting it
to work if you must communicate between two separate interpreters.

&gt;<i> &gt; Now if I want to make it work I have to turn off the
</I>&gt;<i> &gt; PythonInterpPerDirectory or change the Session from
</I>&gt;<i> &gt; MemorySession to DbmSession .
</I>&gt;<i> &gt; Of course this will not happen if the desktop.py where
</I>&gt;<i> &gt; on the same directory of the login.py script.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Is this a correct analysis ?
</I>&gt;<i> &gt; If it is must be a FAQ IMHO and what is the best practice
</I>&gt;<i> &gt; to avoid this problem ?
</I>&gt;<i> 
</I>&gt;<i> What version of mod_python are you using? There are bugs related to
</I>&gt;<i> PythonInterpPerDirectory in older versions, and not all problems may
</I>&gt;<i> even be addressed until mod_python 3.3. You should avoid using the
</I>&gt;<i> PythonInterpPerDirectory unless you have a very good reason.
</I>&gt;<i> 
</I>&gt;<i> For a possible workaround, try setting:
</I>&gt;<i> 
</I>&gt;<i>   PythonOption ApplicationPath /www
</I>&gt;<i> 
</I>&gt;<i> This will ensure that cookies used for session in each context use the
</I>&gt;<i> same path. They will not otherwise if you have distinct PythonHandler
</I>&gt;<i> directives in each context, irrespective of whether you are using the
</I>&gt;<i> PythonInterpPerDirectory directive.
</I>
There is still a possibility this may apply in some circumstances.

&gt;<i> There is also perhaps an issue in mod_python session code as well
</I>&gt;<i> which I hadn't noticed before. That is that it uses:
</I>&gt;<i> 
</I>&gt;<i>             # the path where *Handler directive was specified
</I>&gt;<i>             dirpath = self._req.hlist.directory 
</I>&gt;<i>             if dirpath:
</I>&gt;<i>                 docroot = self._req.document_root()
</I>&gt;<i>                 c.path = dirpath[len(docroot):]
</I>&gt;<i>             else:
</I>&gt;<i>                 c.path = '/'
</I>&gt;<i> 
</I>&gt;<i> This will not work though where the directory the handler is specified
</I>&gt;<i> for is not located within the document root. There are possibly other
</I>&gt;<i> issues with this code in relation to mod_python 3.3 which I'll have to
</I>&gt;<i> address as well.
</I>&gt;<i> 
</I>&gt;<i> This issue is incidental though and probably not the cause of any
</I>&gt;<i> problem you have.
</I>&gt;<i> 
</I>&gt;<i> BTW, why are you using PythonInterpPerDirectory? What do you think
</I>&gt;<i> you get from using it?
</I>
Still like to know why you are using this directive. :-)

Graham
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022370.html">[mod_python] Using mod_python with two applications fails on
	FedoraCore 4, works on Window/XP
</A></li>
	<LI>Next message: <A HREF="022363.html">[mod_python] Memory Session doesen't
	workwithPythonInterpPerDirectory on Windows
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22356">[ date ]</a>
              <a href="thread.html#22356">[ thread ]</a>
              <a href="subject.html#22356">[ subject ]</a>
              <a href="author.html#22356">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
