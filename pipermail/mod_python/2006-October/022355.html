<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Using mod_python with two applications fails on
	FedoraCore 4, works on Window/XP
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Using%20mod_python%20with%20two%20applications%20fails%20on%0A%09FedoraCore%204%2C%20works%20on%20Window/XP&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022354.html">
   <LINK REL="Next"  HREF="022370.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Using mod_python with two applications fails on
	FedoraCore 4, works on Window/XP</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Using%20mod_python%20with%20two%20applications%20fails%20on%0A%09FedoraCore%204%2C%20works%20on%20Window/XP&In-Reply-To="
       TITLE="[mod_python] Using mod_python with two applications fails on
	FedoraCore 4, works on Window/XP">grahamd at dscpl.com.au
       </A><BR>
    <I>Wed Oct 18 18:23:18 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="022354.html">[mod_python] Memory Session doesen't work
	withPythonInterpPerDirectory on Windows
</A></li>
        <LI>Next message: <A HREF="022370.html">[mod_python] Using mod_python with two applications fails on
	FedoraCore 4, works on Window/XP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22355">[ date ]</a>
              <a href="thread.html#22355">[ thread ]</a>
              <a href="subject.html#22355">[ subject ]</a>
              <a href="author.html#22355">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Roger wrote ..
&gt;<i> I am running apache 2.0.54 and mod_python 3.2.10 on Fedora Core 4.  I am
</I>&gt;<i> running both Webware and MoinMoin under mod_python as a means of 
</I>&gt;<i> speeding up the applications. 
</I>&gt;<i> 
</I>&gt;<i> My problem is that the MoinMoin modules (the second application defined)
</I>&gt;<i> are being reloaded with each request.  A logging message inserted into
</I>&gt;<i> the MoinMoin request.py module verifies this.  I found this problem 
</I>&gt;<i> while investigating the cause of why my newly written MoinMoin macros 
</I>&gt;<i> were crashing after MySQL ran out of available connections.
</I>&gt;<i> 
</I>&gt;<i> This problem does not occur on my test system under Windows/XP with 
</I>&gt;<i> apache 2.0.53 and mod_python 3.2.5.  I had been running mod_python 3.1.4
</I>&gt;<i> under Fedora Core 4 and have upgraded to 3.2.10 but the problem persists.
</I>&gt;<i> 
</I>&gt;<i> Some snippets from httpd.conf:
</I>&gt;<i> 
</I>&gt;<i> LoadModule python_module modules/mod_python.so
</I>&gt;<i> 
</I>&gt;<i> # Webware WebKit
</I>&gt;<i> &lt;Location /webkit &gt;
</I>&gt;<i>    SetHandler python-program
</I>&gt;<i>    # add the directory that contains ModPythonAdapter.py
</I>&gt;<i>    PythonPath &quot;sys.path+['/home/web/Webware']&quot;
</I>&gt;<i>    PythonOption AppWorkDir /home/web/dra
</I>&gt;<i>    PythonHandler WebKit.Adapters.ModPythonAdapter
</I>&gt;<i>    PythonDebug On
</I>&gt;<i> &lt;/Location&gt;
</I>&gt;<i> 
</I>&gt;<i> # MoinMoin
</I>&gt;<i> &lt;Location /drawiki&gt;
</I>&gt;<i>     SetHandler python-program
</I>&gt;<i>     PythonPath &quot;['/home/web/Moin/drawiki/']+sys.path&quot;
</I>&gt;<i>     PythonHandler MoinMoin.request::RequestModPy.run
</I>&gt;<i>     PythonDebug On
</I>&gt;<i> &lt;/Location&gt;
</I>&gt;<i> 
</I>&gt;<i> Any suggestions as to what I may be doing wrong?
</I>

The messages in the error log file do not show the process ID for the Apache
child process that performed the import. Nor do they distinguish between an
initial load and a reload, nor which Python interpreter instance performed the
load. FWIW, both all issues are addressed in mod_python 3.3.

Why this is important is that if you are using Apache in prefork mode, whereby
there are multiple Apache child processes, you may be confusing messages
generated from different Apache child processes as indicating that a module is
being reloaded on ever request. Instead, all that may be happening is that each
request is going to a different Apache child process and it takes a while
before all Apache child processes have been involved in handling a request for
that application and before the messages stop appearing.

If you have been having problems with Apache child processes crashing at
regular intervals, then the messages may just keep appearing as Apache creates
new child processes to replace those which have died. Also, if you have a low
count for the number of requests that any one Apache child process should
handle before Apache shuts down that process, you may have a high turn over of
processes and thus again a continual stream of messages. Thus make sure that
you don't have MaxRequestsPerChild directive set in main Apache configuration
to some low value.

In case you are worried that it is somehow due to an interaction between the
two different applications you are hosting, then forcible separate them into
their own Python interpreter instances with each Apache child process by using
the PythonInterpreter directive. Ie., In MoinMoin use:

  PythonInterpreter wiki

and in the other use:

  PythonInterpreter webware

Graham
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022354.html">[mod_python] Memory Session doesen't work
	withPythonInterpPerDirectory on Windows
</A></li>
	<LI>Next message: <A HREF="022370.html">[mod_python] Using mod_python with two applications fails on
	FedoraCore 4, works on Window/XP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22355">[ date ]</a>
              <a href="thread.html#22355">[ thread ]</a>
              <a href="subject.html#22355">[ subject ]</a>
              <a href="author.html#22355">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
