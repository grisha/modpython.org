<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] AddHandler / SetHandler (black magic)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20AddHandler%20/%20SetHandler%20%28black%20magic%29&In-Reply-To=1592670000.20061006134045%40zdisk.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022210.html">
   <LINK REL="Next"  HREF="022214.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] AddHandler / SetHandler (black magic)</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20AddHandler%20/%20SetHandler%20%28black%20magic%29&In-Reply-To=1592670000.20061006134045%40zdisk.net"
       TITLE="[mod_python] AddHandler / SetHandler (black magic)">grahamd at dscpl.com.au
       </A><BR>
    <I>Fri Oct  6 07:01:41 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="022210.html">[mod_python] AddHandler / SetHandler (black magic)
</A></li>
        <LI>Next message: <A HREF="022214.html">[mod_python] AddHandler / SetHandler (black magic)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22213">[ date ]</a>
              <a href="thread.html#22213">[ thread ]</a>
              <a href="subject.html#22213">[ subject ]</a>
              <a href="author.html#22213">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On 06/10/2006, at 7:40 PM, Norman Tindall wrote:

&gt;<i> Hello marinus,
</I>&gt;<i>       You could try Set handler with
</I>&gt;<i>       this code in handler:
</I>&gt;<i>
</I>&gt;<i> def handler(req,db):
</I>&gt;<i>
</I>&gt;<i>     if req.status != 200:
</I>&gt;<i>         raise apache.SERVER_RETURN, req.status
</I>
Why??? In what circumstances do you believe that one could
arrive here with req.status already set to something other than
a value of 200. If an earlier handler had generated an error by
setting req.status, it should have returned apache.DONE and
not apache.OK and thus shouldn't ever end up here.

&gt;<i>     extentions_we_handle = [&quot;html&quot;,&quot;py&quot;]  # list of ext you want to  
</I>&gt;<i> handle
</I>&gt;<i>     ext = req.filename.split(&quot;.&quot;)
</I>
If you are going to do that, you should use:

   import posixpath
   ext = posixpath.splitext(req.filename)[0]

The way you were doing it, a '.' in a directory name earlier in the
URL could give problems.

The posixpath module is preferred instead of os.path as Apache
always uses POSIX style slash and not backslash for directory
separators. But then, posixpath doesn't deal with drive letters.
In practice there needs to be some apache.* functions which are
equivalent to os.path.* functions but which work properly on the
Apache style paths. Such a thing is on the list of things to do. :-)

&gt;<i>     if len(ext) &gt; 1 and ext[-1] in extentions_we_handle:
</I>&gt;<i>         return apache.DECLINED
</I>&gt;<i>
</I>&gt;<i>     # do some work here with the extantions you want to handle
</I>
Using AddHandler and other Apache directives is still the better
way. In mod_python 3.3 it will be easier to do things like above,
but it shouldn't be done in the response handler phase but an
earlier phase such as the fixup handler phase. I'll be writing an
article about this specific ability of mod_python 3.3 some time in
the near future hopefully.

Graham
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022210.html">[mod_python] AddHandler / SetHandler (black magic)
</A></li>
	<LI>Next message: <A HREF="022214.html">[mod_python] AddHandler / SetHandler (black magic)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22213">[ date ]</a>
              <a href="thread.html#22213">[ thread ]</a>
              <a href="subject.html#22213">[ subject ]</a>
              <a href="author.html#22213">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
