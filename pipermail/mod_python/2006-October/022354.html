<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Memory Session doesen't work
	withPythonInterpPerDirectory on Windows
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Memory%20Session%20doesen%27t%20work%0A%09withPythonInterpPerDirectory%20on%20Windows&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022353.html">
   <LINK REL="Next"  HREF="022355.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Memory Session doesen't work
	withPythonInterpPerDirectory on Windows</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Memory%20Session%20doesen%27t%20work%0A%09withPythonInterpPerDirectory%20on%20Windows&In-Reply-To="
       TITLE="[mod_python] Memory Session doesen't work
	withPythonInterpPerDirectory on Windows">grahamd at dscpl.com.au
       </A><BR>
    <I>Wed Oct 18 18:10:17 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="022353.html">[mod_python] Using mod_python with two applications fails on Fedora
 Core 4, works on Window/XP
</A></li>
        <LI>Next message: <A HREF="022355.html">[mod_python] Using mod_python with two applications fails on
	FedoraCore 4, works on Window/XP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22354">[ date ]</a>
              <a href="thread.html#22354">[ thread ]</a>
              <a href="subject.html#22354">[ subject ]</a>
              <a href="author.html#22354">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Luca Montecchiani wrote ..
&gt;<i> Hi all,
</I>&gt;<i> this is probably a FAQ but I want to share with you
</I>&gt;<i> my bad experience.
</I>&gt;<i> 
</I>&gt;<i> I've a situation where /www/dir1/login.py create a session and
</I>&gt;<i> redirect to /www/dir2/desktop.py that read the session to see
</I>&gt;<i> if is_new or not.
</I>&gt;<i> 
</I>&gt;<i> Unfortunately this doesn't work if you are using:
</I>&gt;<i> 1) Windows platform
</I>&gt;<i> 2) PythonOption PythonInterpPerDirectory On
</I>&gt;<i> 3) PythonOption Session MemorySession
</I>&gt;<i> 
</I>&gt;<i> The desktop.py check if the session is new and
</I>&gt;<i> it is always True :-(
</I>&gt;<i> 
</I>&gt;<i> This seem pretty simple to explain, having Session
</I>&gt;<i> saved in Memory the second python interpreter (/www/dir2) doesn't
</I>&gt;<i> &quot;see&quot; the session created by the first interpreter (/www/dir1)
</I>&gt;<i> because of the PythonInterpPerDirectory option.
</I>&gt;<i> 
</I>&gt;<i> Now if I want to make it work I have to turn off the
</I>&gt;<i> PythonInterpPerDirectory or change the Session from
</I>&gt;<i> MemorySession to DbmSession .
</I>&gt;<i> Of course this will not happen if the desktop.py where
</I>&gt;<i> on the same directory of the login.py script.
</I>&gt;<i> 
</I>&gt;<i> Is this a correct analysis ?
</I>&gt;<i> If it is must be a FAQ IMHO and what is the best practice
</I>&gt;<i> to avoid this problem ?
</I>
What version of mod_python are you using? There are bugs related to
PythonInterpPerDirectory in older versions, and not all problems may
even be addressed until mod_python 3.3. You should avoid using the
PythonInterpPerDirectory unless you have a very good reason.

For a possible workaround, try setting:

  PythonOption ApplicationPath /www

This will ensure that cookies used for session in each context use the
same path. They will not otherwise if you have distinct PythonHandler
directives in each context, irrespective of whether you are using the
PythonInterpPerDirectory directive.

There is also perhaps an issue in mod_python session code as well
which I hadn't noticed before. That is that it uses:

            # the path where *Handler directive was specified
            dirpath = self._req.hlist.directory 
            if dirpath:
                docroot = self._req.document_root()
                c.path = dirpath[len(docroot):]
            else:
                c.path = '/'

This will not work though where the directory the handler is specified
for is not located within the document root. There are possibly other
issues with this code in relation to mod_python 3.3 which I'll have to
address as well.

This issue is incidental though and probably not the cause of any
problem you have.

BTW, why are you using PythonInterpPerDirectory? What do you think
you get from using it?

Graham

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022353.html">[mod_python] Using mod_python with two applications fails on Fedora
 Core 4, works on Window/XP
</A></li>
	<LI>Next message: <A HREF="022355.html">[mod_python] Using mod_python with two applications fails on
	FedoraCore 4, works on Window/XP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22354">[ date ]</a>
              <a href="thread.html#22354">[ thread ]</a>
              <a href="subject.html#22354">[ subject ]</a>
              <a href="author.html#22354">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
