<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] sendfile problems with IE
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20sendfile%20problems%20with%20IE&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022436.html">
   <LINK REL="Next"  HREF="022443.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] sendfile problems with IE</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Mark Norley</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20sendfile%20problems%20with%20IE&In-Reply-To="
       TITLE="[mod_python] sendfile problems with IE">m_norley_newsgroups at yahoo.co.uk
       </A><BR>
    <I>Tue Oct 31 09:45:12 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="022436.html">[mod_python] Building a web application using Cheetah
	andmod_python
</A></li>
        <LI>Next message: <A HREF="022443.html">[mod_python] sendfile problems with IE
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22440">[ date ]</a>
              <a href="thread.html#22440">[ thread ]</a>
              <a href="subject.html#22440">[ subject ]</a>
              <a href="author.html#22440">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello

Hope this list can save me again ;-)
This bit of code works fine in Firefox and Netscape but IE doesn't like it:

def handler(req):
    req.content_type = &quot;application/vnd.ms-excel&quot;
    req.set_content_length(os.path.getsize(ROOT+'\\taggedhits.xls'))
    req.headers_out[&quot;Content-Disposition&quot;] = &quot;attachment;
filename=taggedhits.xls&quot;
    req.sendfile(ROOT+&quot;\\taggedhits.xls&quot;)
    return apache.OK

With IE the File Download dialogue looks strange. IE thinks the filename is
filehandler_py rather than taggedhits.xls:

Name: filehandler_py
Type: Microsoft Excel Worksheet, 13.5 KB
From: 'mysite'

filehandler.py is the name of the script for starters, not the file I want
to download, and why has IE swapped the dot for an underscore?

On pressing Save I get:
Internet Explorer cannot download filehandler.py from 'mysite'.
Internet Explorer was not able to open this internet site. The requested
site is either unavailable or cannot be found. Please try again later.

Does anyone know what I need to do for IE to recognise the file? I'm
thinking I'm missing a header field or something.  

Cheers
Mark

Win XP SP2
Python 2.4.2
Apache 2.2.2
Mod_python 3.2.10
Firefox 1.5.0.7
Netscape 7.2
IE 6

-- 
No virus found in this outgoing message.
Checked by AVG Free Edition.
Version: 7.1.409 / Virus Database: 268.13.20/508 - Release Date: 31/10/06
 

Send instant messages to your online friends <A HREF="http://uk.messenger.yahoo.com">http://uk.messenger.yahoo.com</A> 
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022436.html">[mod_python] Building a web application using Cheetah
	andmod_python
</A></li>
	<LI>Next message: <A HREF="022443.html">[mod_python] sendfile problems with IE
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22440">[ date ]</a>
              <a href="thread.html#22440">[ thread ]</a>
              <a href="subject.html#22440">[ subject ]</a>
              <a href="author.html#22440">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
