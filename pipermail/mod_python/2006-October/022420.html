<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Building a web application using Cheetah and
	mod_python
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Building%20a%20web%20application%20using%20Cheetah%20and%0A%09mod_python&In-Reply-To=98F8294A-E202-401C-8C1D-095545B22E59%40ixopusada.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022417.html">
   <LINK REL="Next"  HREF="022435.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Building a web application using Cheetah and
	mod_python</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Building%20a%20web%20application%20using%20Cheetah%20and%0A%09mod_python&In-Reply-To=98F8294A-E202-401C-8C1D-095545B22E59%40ixopusada.com"
       TITLE="[mod_python] Building a web application using Cheetah and
	mod_python">grahamd at dscpl.com.au
       </A><BR>
    <I>Sat Oct 28 19:10:35 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="022417.html">[mod_python] Building a web application using Cheetah and
	mod_python
</A></li>
        <LI>Next message: <A HREF="022435.html">[mod_python] Building a web application using Cheetah and
	mod_python
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22420">[ date ]</a>
              <a href="thread.html#22420">[ thread ]</a>
              <a href="subject.html#22420">[ subject ]</a>
              <a href="author.html#22420">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On 29/10/2006, at 4:12 AM, Dirk van Oosterbosch, IR labs wrote:

&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I am also working on a &quot;cms&quot;-like website system, using mod_python  
</I>&gt;<i> and Cheetah, though I've not yet tied these both up together, to be  
</I>&gt;<i> fully functional. Still working on the smaller subparts of the system.
</I>&gt;<i> So I follow this subject with great interest.
</I>&gt;<i>
</I>&gt;<i> It feels like the core of this discussion is about making sure the  
</I>&gt;<i> cheetah modules gets reloaded when they change. I didn't conduct  
</I>&gt;<i> any tests yet, still trying to grasp the exact mechanisms underneath.
</I>&gt;<i>
</I>&gt;&gt;&gt;<i> [...]
</I>&gt;&gt;&gt;<i> Is this the best way to import template modules and then evaluate  
</I>&gt;&gt;&gt;<i> them?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> No, in as much as you are having to create a parallel hierarchy of  
</I>&gt;&gt;<i> publisher
</I>&gt;&gt;<i> handlers for each Cheetah page. You would be better off using a  
</I>&gt;&gt;<i> custom
</I>&gt;&gt;<i> handler which does the dispatch direct to the compiled Cheetah  
</I>&gt;&gt;<i> template
</I>&gt;&gt;<i> classes.
</I>&gt;<i>
</I>&gt;<i> I'm not sure if this helps, but I've got a similar setup. There is  
</I>&gt;<i> one handler in a main.py that handles all requests. This main  
</I>&gt;<i> connects to a database, to find out which Cheetah template to use,  
</I>&gt;<i> and loads and fills this template. Also I've got a directory which  
</I>&gt;<i> hold all the python files directly necessary for the system (/var/ 
</I>&gt;<i> www/python) and an other directory to hold my templates. (/var/www/ 
</I>&gt;<i> python/templates)
</I>&gt;<i>
</I>&gt;<i> If inside this main.py I would use an `apache.import_module 
</I>&gt;<i> (fooTemplate)` instead of just `from fooTemplate import  
</I>&gt;<i> fooTemplate`, that would mean that the fooTemplate is reloaded if  
</I>&gt;<i> it changed, doesn't it?
</I>
Probably not. See issue 8 in:

   <A HREF="http://www.dscpl.com.au/wiki/ModPython/Articles/">http://www.dscpl.com.au/wiki/ModPython/Articles/</A> 
ModuleImportingIsBroken

&gt;<i> But would it also mean that all the other templates which are  
</I>&gt;<i> imported through their inheritance would be reloaded if they are  
</I>&gt;<i> changed?
</I>
Again, probably not, for same reason.

&gt;<i> Most of my templates are inheriting parent-templates using the  
</I>&gt;<i> Cheetah standard
</I>&gt;<i> #from bar import bar
</I>&gt;<i> #extends bar
</I>&gt;<i>
</I>&gt;<i> It's easy to create a whole directory with fresh modules, using the  
</I>&gt;<i> shell `cheetah compile *.tmpl`. But is there also a way to ensure  
</I>&gt;<i> me that apache is reloading them, if I do that? (i.e. an other way  
</I>&gt;<i> than restarting apache, which I have to do frequently while  
</I>&gt;<i> debugging this system :-(
</I>
Using current versions of mod_python available there is no way of  
doing it except
perhaps by using the Vampire extensions for mod_python.  
Alternatively, use
version 3.3 of mod_python out of Subversion repository or wait until  
it is released.

Both Vampire and the new mod_python 3.3 implement a module importer  
which
tracks child imports and will correctly import parent modules when a  
child changes.
In fact it is the Vampire module importer which was used as basis for  
3.3 version.

This works even if 'from bar import bar' is used as they intercept  
the 'import'
statement and when an import is performed from inside a module which was
already imported using the module importer, it will use the module  
importer for
the 'import' as well. Ie., no need to use apache.import_module()  
explicitly. If the
module being imported using 'import' is in another directory though,  
it is necessary
to specify an option declaring the search path for the modules. This  
is a path which
is distinct from PythonPath as new importer will not use any module  
in PythonPath
as a candidate for reloading as that causes lots of problems.

Anyway, end result is that with these module importers, you can  
update a base
class template, regenerate Cheetah Python class and anything which  
extends
from it will be automatically reloaded along with the base class.

&gt;<i> And sometimes I am not importing a compiled template in main, but  
</I>&gt;<i> create a new template from a text/tmpl file
</I>&gt;<i> `t = Template(file = &quot;foobar.tmpl&quot;, searchList = [dict, obj])`
</I>&gt;<i> What does creating a template on the fly like this, mean for  
</I>&gt;<i> reloading a changed inherited template?
</I>
Not sure. Does Cheetah use a caching system of its own for this so  
that it isn't
loading them from disk all the time and does it reload the tmpl file  
if it has changed
on disk. I can't remember what it does and it may have changed since  
when I
was more actively looking at it.

&gt;&gt;&gt;<i> This second file only works if I add /var/www/app/templates to my
</I>&gt;&gt;&gt;<i> PythonPath.  And, due to (2) above, I then also have to add
</I>&gt;&gt;&gt;<i> /var/www/app to PythonPath.  Is this really necessary?=
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> With the version of mod_python you are using, yes it is necessary.
</I>&gt;<i>
</I>&gt;<i> I am also adding the templates directory to my PythonPath, but  
</I>&gt;<i> since I am not yet running my code from Apache, I haven't yet  
</I>&gt;<i> discovered problems with loading the rest of my python modules from  
</I>&gt;<i> my /var/www/python. But if I hit those issues, I'll now know how to  
</I>&gt;<i> fix them, ;-)
</I>
With new importers, you don't want to be setting PythonPath if you  
want modules
to be reloadable. You will need to set the module importers own  
search path.

&gt;<i> BTW, (OT)
</I>&gt;<i>
</I>&gt;&gt;&gt;<i>    templateModule = apache.import_module(&quot;templates/myTemplate&quot;)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Using '/' in the module name like this is not portable and is  
</I>&gt;&gt;<i> dependent
</I>&gt;&gt;<i> on peculiarities of the behaviour of Python on a specific  
</I>&gt;&gt;<i> platform. It will
</I>&gt;&gt;<i> not for example work on Mac OS X and also possibly not on Windows.
</I>&gt;<i>
</I>&gt;<i> I am working on a mac and also using slashes `/` to delimit my  
</I>&gt;<i> paths, so no problems there. (Didn't try from mod_python though &amp;  
</I>&gt;<i> dunno what will happen on Windows).
</I>
What version of Python are you using? I know for sure it didn't work  
with
Python (2.3) on Panther. I also don't think it worked with Python  
(2.3.5)
on Tiger. If you are using Python 2.4 or later which you installed  
yourself,
it is entirely possible it may work.

&gt;<i> However I know of portability issues, so I am only using paths/with/ 
</I>&gt;<i> slashes in my configuration files, if I need to create a path in  
</I>&gt;<i> code I'm using os.path.join()
</I>
Depending on the source of the path, one should actually use  
posixpath functions
sometimes instead of os.path. This is especially the case of working  
on req.uri and
sometimes on req.filename. This is because Apache supplies both of  
them as
POSIXish style paths and using os.path functions on Windows can screw  
things
up as it introduces back slashes.

&gt;&gt;<i> Things are a bit easier to manage and easier to predict when  
</I>&gt;&gt;<i> mod_python 3.3
</I>&gt;&gt;<i> can be used. Version 3.3 of mod_python hasn't been released yet,  
</I>&gt;&gt;<i> but is quite
</I>&gt;&gt;<i> close.
</I>&gt;<i>
</I>&gt;<i> I am eagerly awaiting :-)
</I>&gt;<i> best
</I>&gt;<i>
</I>&gt;<i> dirk
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -----------------------------
</I>&gt;<i> Dirk van Oosterbosch
</I>&gt;<i> de Wittenstraat 225
</I>&gt;<i> 1052 AT Amsterdam
</I>&gt;<i> the Netherlands
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://labs.ixopusada.com">http://labs.ixopusada.com</A>
</I>&gt;<i> -----------------------------
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On 28-okt-2006, at 5:32, Graham Dumpleton wrote:
</I>&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On 28/10/2006, at 7:44 AM, Sebastian Celis wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Hello,
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I am new to this list and have just recently begun to work on a
</I>&gt;&gt;&gt;<i> project where I wish to use mod_python.publisher and cheetah to  
</I>&gt;&gt;&gt;<i> drive
</I>&gt;&gt;&gt;<i> an entire web application.  I apologize if the following topics have
</I>&gt;&gt;&gt;<i> been discussed to death recently, but I have read through the
</I>&gt;&gt;&gt;<i> documentation on both sites and have searched through the mailing- 
</I>&gt;&gt;&gt;<i> list
</I>&gt;&gt;&gt;<i> archives and while I have seen similar discussions, I have yet to  
</I>&gt;&gt;&gt;<i> find
</I>&gt;&gt;&gt;<i> definitive answers.  I am able to get most things to work, however I
</I>&gt;&gt;&gt;<i> can't help but feel that there are better ways of approaching  
</I>&gt;&gt;&gt;<i> some of
</I>&gt;&gt;&gt;<i> my situations.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> First, I'll quickly describe my directory structure:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> /var/www/app -- The base directory to the web application.  This  
</I>&gt;&gt;&gt;<i> will
</I>&gt;&gt;&gt;<i> directly contain most of the python files that correspond  
</I>&gt;&gt;&gt;<i> directly to
</I>&gt;&gt;&gt;<i> URLs.  For example, index.py, login.py, etc.  In this directory.
</I>&gt;&gt;&gt;<i> /var/www/app/templates -- Contains all of my cheetah templates.
</I>&gt;&gt;&gt;<i> /var/www/app/include -- Contains the python utility modules I am
</I>&gt;&gt;&gt;<i> writing specifically for this application.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Now, onto the questions.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> 1) Importing compiled cheetah templates
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Assume I have code like the following in /var/www/app/test1.py
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> ######################################
</I>&gt;&gt;&gt;<i> from mod_python import apache
</I>&gt;&gt;&gt;<i> from Cheetah.Template import Template
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> def index(req):
</I>&gt;&gt;&gt;<i>    req.content_type = &quot;text/html&quot;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>    dict = {'title': 'My Title!', 'message': 'Hello world!'}
</I>&gt;&gt;&gt;<i>    templateModule = apache.import_module(&quot;templates/myTemplate&quot;)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Using '/' in the module name like this is not portable and is  
</I>&gt;&gt;<i> dependent
</I>&gt;&gt;<i> on peculiarities of the behaviour of Python on a specific  
</I>&gt;&gt;<i> platform. It will
</I>&gt;&gt;<i> not for example work on Mac OS X and also possibly not on Windows.
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>    t = getattr(templateModule, &quot;myTemplate&quot;)()
</I>&gt;&gt;&gt;<i>    searchList = t.searchList()
</I>&gt;&gt;&gt;<i>    searchList.insert(0, dict)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>    return(t.respond())
</I>&gt;&gt;&gt;<i> ######################################
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Is this the best way to import template modules and then evaluate  
</I>&gt;&gt;&gt;<i> them?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> No, in as much as you are having to create a parallel hierarchy of  
</I>&gt;&gt;<i> publisher
</I>&gt;&gt;<i> handlers for each Cheetah page. You would be better off using a  
</I>&gt;&gt;<i> custom
</I>&gt;&gt;<i> handler which does the dispatch direct to the compiled Cheetah  
</I>&gt;&gt;<i> template
</I>&gt;&gt;<i> classes. See the mod_python handler described in:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>   <A HREF="http://wiki.cheetahtemplate.org/cheetah-recipes.html">http://wiki.cheetahtemplate.org/cheetah-recipes.html</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> 2) Modifying PythonPath prevents modules from being imported
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Inside file /var/www/app/test2.py, I have the following code:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> import config
</I>&gt;&gt;&gt;<i> (or)
</I>&gt;&gt;&gt;<i> config = apache.import_module(&quot;config&quot;)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Both of these commands load /var/www/app/config.py, and seem to work
</I>&gt;&gt;&gt;<i> fine.  However, if I add
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> PythonPath &quot;['/var/www/app/templates']+sys.path&quot;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> to my apache configuration, I get an error next time I run test2.py.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> ###
</I>&gt;&gt;&gt;<i> Mod_python error: &quot;PythonHandler mod_python.publisher&quot;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Traceback (most recent call last):
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>  File &quot;/usr/lib/python2.4/site-packages/mod_python/apache.py&quot;, line
</I>&gt;&gt;&gt;<i> 299, in HandlerDispatch
</I>&gt;&gt;&gt;<i>    result = object(req)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>  File &quot;/usr/lib/python2.4/site-packages/mod_python/publisher.py&quot;,
</I>&gt;&gt;&gt;<i> line 213, in handler
</I>&gt;&gt;&gt;<i>    published = publish_object(req, object)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>  File &quot;/usr/lib/python2.4/site-packages/mod_python/publisher.py&quot;,
</I>&gt;&gt;&gt;<i> line 412, in publish_object
</I>&gt;&gt;&gt;<i>    return publish_object(req,util.apply_fs_data(object, req.form,  
</I>&gt;&gt;&gt;<i> req=req))
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>  File &quot;/usr/lib/python2.4/site-packages/mod_python/util.py&quot;, line
</I>&gt;&gt;&gt;<i> 439, in apply_fs_data
</I>&gt;&gt;&gt;<i>    return object(**args)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>  File &quot;/var/www/app/test2.py&quot;, line 8, in index
</I>&gt;&gt;&gt;<i>    config = apache.import_module(&quot;config&quot;)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>  File &quot;/usr/lib/python2.4/site-packages/mod_python/apache.py&quot;, line
</I>&gt;&gt;&gt;<i> 461, in import_module
</I>&gt;&gt;&gt;<i>    f, p, d = imp.find_module(parts[i], path)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> ImportError: No module named config
</I>&gt;&gt;&gt;<i> ###
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Why does this initially work but then stop working once I add a
</I>&gt;&gt;&gt;<i> directory to my path?  I can fix it by adding '/var/www/app' to my
</I>&gt;&gt;&gt;<i> PythonPath as well, but I don't understand why it didn't work before
</I>&gt;&gt;&gt;<i> that.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> That is just how mod_python has always worked. Setting PythonPath
</I>&gt;&gt;<i> stops mod_python looking in the directory the handler was specified
</I>&gt;&gt;<i> for. Yes it is a pain. FWIW, this behaviour changes in mod_python 3.3
</I>&gt;&gt;<i> where the whole issue of module importing is dealt with a bit  
</I>&gt;&gt;<i> differently
</I>&gt;&gt;<i> and is much more consistent and predictable.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Current versions of mod_python have a lot of issues when it comes
</I>&gt;&gt;<i> to the module importer. You should really have a read of:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>   <A HREF="http://www.dscpl.com.au/wiki/ModPython/Articles/">http://www.dscpl.com.au/wiki/ModPython/Articles/</A> 
</I>&gt;&gt;<i> ModuleImportingIsBroken
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> 3) Cheetah and #include
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I have read a lot about why mod_python sets the current working
</I>&gt;&gt;&gt;<i> directory to '/', but this seems to be causing some larger problems
</I>&gt;&gt;&gt;<i> when cheetah comes into play.  (3) and (4) discuss two issues that I
</I>&gt;&gt;&gt;<i> am having trouble with.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Here is /var/www/app/templates/testPage.tmpl:
</I>&gt;&gt;&gt;<i> ###
</I>&gt;&gt;&gt;<i> #include 'header_include.tmpl'
</I>&gt;&gt;&gt;<i> &lt;head&gt;
</I>&gt;&gt;&gt;<i> &lt;title&gt;$title&lt;/title&gt;
</I>&gt;&gt;&gt;<i> &lt;/head&gt;
</I>&gt;&gt;&gt;<i> &lt;body&gt;
</I>&gt;&gt;&gt;<i> &lt;p&gt;$message&lt;/p&gt;
</I>&gt;&gt;&gt;<i> &lt;/body&gt;
</I>&gt;&gt;&gt;<i> #include 'footer_include.tmpl'
</I>&gt;&gt;&gt;<i> ###
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> However, as this actually tries to load /header_include.tmpl and
</I>&gt;&gt;&gt;<i> /footer_include.tmpl instead of the ones located in my templates
</I>&gt;&gt;&gt;<i> directory, this will not work.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> If you are going to use compiled templates, you are possibly  
</I>&gt;&gt;<i> better off using
</I>&gt;&gt;<i> a site page base class and have specific pages extend that page.  
</I>&gt;&gt;<i> These
</I>&gt;&gt;<i> common blocks are then accessible through the base class. This  
</I>&gt;&gt;<i> means you
</I>&gt;&gt;<i> get the benefit of compiled code for the included blocks as well,  
</I>&gt;&gt;<i> instead of
</I>&gt;&gt;<i> it having to be interpreted each time.
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I came up with two workarounds,
</I>&gt;&gt;&gt;<i> however I don't really love either:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> a)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> ###
</I>&gt;&gt;&gt;<i> #include os.path.join(os.path.dirname(__file__),  
</I>&gt;&gt;&gt;<i> 'header_include.tmpl')
</I>&gt;&gt;&gt;<i> &lt;head&gt;
</I>&gt;&gt;&gt;<i> &lt;title&gt;$title&lt;/title&gt;
</I>&gt;&gt;&gt;<i> &lt;/head&gt;
</I>&gt;&gt;&gt;<i> &lt;body&gt;
</I>&gt;&gt;&gt;<i> &lt;p&gt;$message&lt;/p&gt;
</I>&gt;&gt;&gt;<i> &lt;/body&gt;
</I>&gt;&gt;&gt;<i> #include os.path.join(os.path.dirname(__file__),  
</I>&gt;&gt;&gt;<i> 'footer_include.tmpl')
</I>&gt;&gt;&gt;<i> ###
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> b)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Actually pass $templatesDir into all of my templates and then  
</I>&gt;&gt;&gt;<i> instead call:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> ###
</I>&gt;&gt;&gt;<i> #include os.path.join(templatesDir, 'header_include.tmpl')
</I>&gt;&gt;&gt;<i> &lt;head&gt;
</I>&gt;&gt;&gt;<i> &lt;title&gt;$title&lt;/title&gt;
</I>&gt;&gt;&gt;<i> &lt;/head&gt;
</I>&gt;&gt;&gt;<i> &lt;body&gt;
</I>&gt;&gt;&gt;<i> &lt;p&gt;$message&lt;/p&gt;
</I>&gt;&gt;&gt;<i> &lt;/body&gt;
</I>&gt;&gt;&gt;<i> #include os.path.join(templatesDir, 'footer_include.tmpl')
</I>&gt;&gt;&gt;<i> ###
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I guess I'm leaning toward (a), but both seem cumbersome and slower
</I>&gt;&gt;&gt;<i> than necessary.  Is there a better way to do this?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> If my memory of Cheetah is correct, then extending from a site  
</I>&gt;&gt;<i> page which
</I>&gt;&gt;<i> has reusable bits like this as I describe above is better.
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> 4) Cheetah and inheritance
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Assume these two files:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> /var/www/app/templates/overall_base.tmpl
</I>&gt;&gt;&gt;<i> ###
</I>&gt;&gt;&gt;<i> &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
</I>&gt;&gt;&gt;<i> &lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.1//EN&quot;
</I>&gt;&gt;&gt;<i>          &quot;<A HREF="http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd&quot;">http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd&quot;</A>&gt;
</I>&gt;&gt;&gt;<i> &lt;html xmlns=&quot;<A HREF="http://www.w3.org/1999/xhtml&quot;">http://www.w3.org/1999/xhtml&quot;</A> xml:lang=&quot;en&quot;&gt;
</I>&gt;&gt;&gt;<i> &lt;head&gt;
</I>&gt;&gt;&gt;<i>    &lt;title&gt;$title&lt;/title&gt;
</I>&gt;&gt;&gt;<i> &lt;/head&gt;
</I>&gt;&gt;&gt;<i> &lt;body&gt;
</I>&gt;&gt;&gt;<i>    $bodyContent
</I>&gt;&gt;&gt;<i> &lt;/body&gt;
</I>&gt;&gt;&gt;<i> &lt;/html&gt;
</I>&gt;&gt;&gt;<i> ###
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> /var/www/app/templates/overall_base_extender.tmpl
</I>&gt;&gt;&gt;<i> ###
</I>&gt;&gt;&gt;<i> #overall_base = apache.import_module(&quot;overall_base&quot;)
</I>&gt;&gt;&gt;<i> (or)
</I>&gt;&gt;&gt;<i> #from overall_base import overall_base
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> #extends overall_base
</I>&gt;&gt;&gt;<i> #def title
</I>&gt;&gt;&gt;<i> Welcome to Foo
</I>&gt;&gt;&gt;<i> #end def
</I>&gt;&gt;&gt;<i> #def bodyContent
</I>&gt;&gt;&gt;<i> Hello world!
</I>&gt;&gt;&gt;<i> #end def
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> This second file only works if I add /var/www/app/templates to my
</I>&gt;&gt;&gt;<i> PythonPath.  And, due to (2) above, I then also have to add
</I>&gt;&gt;&gt;<i> /var/www/app to PythonPath.  Is this really necessary?=
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> With the version of mod_python you are using, yes it is necessary.
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> #overall_base = apache.import_module(&quot;overall_base&quot;,
</I>&gt;&gt;&gt;<i> path=[os.path.dirname(__file__)])
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> doesn't seem to work inside the cheetah template file.  Even
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> #sys.path.append(os.path.dirname(__file__))
</I>&gt;&gt;&gt;<i> #overall_base = apache.import_module(&quot;overall_base&quot;)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> That one I am not sure about. You may be hitting one of the other  
</I>&gt;&gt;<i> problems
</I>&gt;&gt;<i> with PythonPath based module importing which is you can't easily  
</I>&gt;&gt;<i> have the
</I>&gt;&gt;<i> same name module in different directories and be sure you import  
</I>&gt;&gt;<i> the one
</I>&gt;&gt;<i> you want.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> In general I wouldn't recommend using apache.import_module() within
</I>&gt;&gt;<i> Cheetah templates explicitly.
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> doesn't seem to work.  Is there any way to get inheriting  
</I>&gt;&gt;&gt;<i> templates to
</I>&gt;&gt;&gt;<i> work without modifying PythonPath to include all the directories  
</I>&gt;&gt;&gt;<i> where
</I>&gt;&gt;&gt;<i> my base templates might be located?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Not really.
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I apologize for the huge length of this e-mail.  I am still  
</I>&gt;&gt;&gt;<i> fairly new
</I>&gt;&gt;&gt;<i> to mod_python and cheetah, but so far I really like what I see.  I
</I>&gt;&gt;&gt;<i> just feel like there are a few issues I need to wrap my head around
</I>&gt;&gt;&gt;<i> before I can really dive into developing applications.  Any pointers
</I>&gt;&gt;&gt;<i> or help with these issues that you can provide would be greatly
</I>&gt;&gt;&gt;<i> appreciated.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Things are a bit easier to manage and easier to predict when  
</I>&gt;&gt;<i> mod_python 3.3
</I>&gt;&gt;<i> can be used. Version 3.3 of mod_python hasn't been released yet,  
</I>&gt;&gt;<i> but is quite
</I>&gt;&gt;<i> close. If you want to try the source for mod_python out of the  
</I>&gt;&gt;<i> Subversion
</I>&gt;&gt;<i> repository, then can suggest better ways of doing things.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Graham
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Mod_python mailing list
</I>&gt;&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I></PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022417.html">[mod_python] Building a web application using Cheetah and
	mod_python
</A></li>
	<LI>Next message: <A HREF="022435.html">[mod_python] Building a web application using Cheetah and
	mod_python
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22420">[ date ]</a>
              <a href="thread.html#22420">[ thread ]</a>
              <a href="subject.html#22420">[ subject ]</a>
              <a href="author.html#22420">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
