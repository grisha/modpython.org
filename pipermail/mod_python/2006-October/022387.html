<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] RE: modPython pool of single-threaded sub-interpreters?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20RE%3A%20modPython%20pool%20of%20single-threaded%20sub-interpreters%3F&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022386.html">
   <LINK REL="Next"  HREF="022388.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] RE: modPython pool of single-threaded sub-interpreters?</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20RE%3A%20modPython%20pool%20of%20single-threaded%20sub-interpreters%3F&In-Reply-To="
       TITLE="[mod_python] RE: modPython pool of single-threaded sub-interpreters?">grahamd at dscpl.com.au
       </A><BR>
    <I>Wed Oct 25 22:57:43 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="022386.html">[mod_python] FieldStorage's keep_blank_values argument
	andRequest.form
</A></li>
        <LI>Next message: <A HREF="022388.html">[mod_python] 500 errors from authentication example
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22387">[ date ]</a>
              <a href="thread.html#22387">[ thread ]</a>
              <a href="subject.html#22387">[ subject ]</a>
              <a href="author.html#22387">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Would prefer that you subscribe to the mod_python mailing list and ask
such questions there. I have cc'd this on to the mailing list and would
hope that you subscribe and follow up there as necessary.

Matt Krom wrote ..
&gt;<i> Hmm, could we employ forking (at the Apache level) to address this issue?
</I>&gt;<i> Ideally with forking, each request would be handled in its own local memory,
</I>&gt;<i> so the Python app would not have to be threadsafe...
</I>&gt;<i> 
</I>&gt;<i> Thanks for any insight.  I've been reading more of your postings (Google
</I>&gt;<i> &quot;site:modpython.org grahamd&quot;) for tidbits.
</I>&gt;<i> 
</I>&gt;<i> Matt
</I>
What you are talking about is exactly what Apache/mod_python does when
you use it on UNIX with 'prefork' MPM (the default). Read:

  <A HREF="http://www.dscpl.com.au/wiki/ModPython/Articles/TheProcessInterpreterModel">http://www.dscpl.com.au/wiki/ModPython/Articles/TheProcessInterpreterModel</A>

If you are running on Windows you are out of luck, your application will have
to be multithread safe.

To determine if your Apache (on UNIX) is built with 'prefork' MPM, run:

  httpd -l

If the listing mentions 'prefork.c', it is prefork. If it mentions 'worker.c' it
is worker MPM and can run multiple requests concurrently in separate
threads in the same process.

Graham

&gt;<i> -----Original Message-----
</I>&gt;<i> From: Matt Krom
</I>&gt;<i> Sent: Wed 10/25/2006 10:32 PM
</I>&gt;<i> To: <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">grahamd at dscpl.com.au</A>
</I>&gt;<i> Cc: Matt Krom
</I>&gt;<i> Subject: modPython pool of single-threaded sub-interpreters?
</I>&gt;<i>  
</I>&gt;<i> I'm reading up on the topic of sub-interpreters and threads within mod_python,
</I>&gt;<i> and was encouraged by your knowiedge in this posting :
</I>&gt;<i>    <A HREF="http://www.modpython.org/pipermail/mod_python/2006-August/021867.html">http://www.modpython.org/pipermail/mod_python/2006-August/021867.html</A>
</I>&gt;<i> (Although that posting doesn't address our particular issue).
</I>&gt;<i> 
</I>&gt;<i> What we'd like (&quot;need&quot;, actually, since our app is not thread-safe), is:
</I>&gt;<i> 
</I>&gt;<i> - A pool of sub-interpreters
</I>&gt;<i> - Each sub-interpreter handling only one request at a time (single-threaded)
</I>&gt;<i> - New requests given to an idle sub-interpreter
</I>&gt;<i> - Doesn't matter if this is by virtual host, by directory, etc
</I>&gt;<i> 
</I>&gt;<i> As for efficiency of this model, it's no worse than what we're doing now
</I>&gt;<i> (fastcgi manages a pool of C processes, each with its own Python interpreter).
</I>&gt;<i> 
</I>&gt;<i> Do you know of a way to configure mod_python as above?  If you're a committer
</I>&gt;<i> or have viewed the code, does it seem like an easy modification I could
</I>&gt;<i> attempt?
</I>&gt;<i> 
</I>&gt;<i> Thanks for any insight--we are sort of in a pickle and need to solve this
</I>&gt;<i> issue.
</I>&gt;<i> 
</I>&gt;<i> Matt
</I>&gt;<i> 
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mkrom at banta.com</A>
</I>&gt;<i> Cambridge, MA
</I></PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022386.html">[mod_python] FieldStorage's keep_blank_values argument
	andRequest.form
</A></li>
	<LI>Next message: <A HREF="022388.html">[mod_python] 500 errors from authentication example
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22387">[ date ]</a>
              <a href="thread.html#22387">[ thread ]</a>
              <a href="subject.html#22387">[ subject ]</a>
              <a href="author.html#22387">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
