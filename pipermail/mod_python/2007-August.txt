From gulopine at gamemusic.org  Wed Aug  1 21:10:50 2007
From: gulopine at gamemusic.org (Marty Alchin)
Date: Wed Aug  1 21:11:05 2007
Subject: [mod_python] ImportError: No module named mod_python.apache
Message-ID: <7e8d40920708011810q8bb5be0yc2c75a6ac3126309@mail.gmail.com>

I was having problems with mod_python recently, so I decided to
upgrade to Python 2.5 (which I had wanted to do anyway), reinstall
mod_python and try again. I'm getting the following error, however,
and I can't sort out why.

[Wed Aug 01 18:20:53 2007] [error] make_obcallback: could not import
mod_python.apache.\n
'import site' failed; use -v for traceback
ImportError: No module named mod_python.apache
[Wed Aug 01 18:20:53 2007] [error] make_obcallback: Python path being
used "['/usr/local/lib/python2.5/site-packages',
'/usr/local/lib/python25.zip', '/usr/local/lib/python2.5/',
'/usr/local/lib/python2.5/plat-linux2',
'/usr/local/lib/python2.5/lib-tk',
'/usr/local/lib/python2.5/lib-dynload']".
[Wed Aug 01 18:20:53 2007] [error] get_interpreter: no interpreter
callback found.
[Wed Aug 01 18:20:53 2007] [error] [client 24.11.212.122]
python_handler: Can't get/create interpreter.

Initially, it seemed to make sense, since Python's site-packages
wasn't listed in the path that was being used. However, when I run it
with PYTHONPATH=/usr/local/lib/python2.5/site-packages, it still runs
into the same error, and as you can see, site-packages is now
included. I haven't found anything else in the logs that sheds any
light on the subject.

Is there something I can do to get more information about what's going wrong?

-Gul
From graham.dumpleton at gmail.com  Wed Aug  1 21:40:20 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Aug  1 21:40:28 2007
Subject: [mod_python] ImportError: No module named mod_python.apache
In-Reply-To: <7e8d40920708011810q8bb5be0yc2c75a6ac3126309@mail.gmail.com>
References: <7e8d40920708011810q8bb5be0yc2c75a6ac3126309@mail.gmail.com>
Message-ID: <88e286470708011840p240c3573v4946988c1306c9b4@mail.gmail.com>

Run it again, setting:

  PYTHONVERBOSE=1

in the environment.

The error is while site file is being imported, ie., before
mod_python.apache is imported.

Post back result to the mailing list.

Graham

On 02/08/07, Marty Alchin <gulopine@gamemusic.org> wrote:
> I was having problems with mod_python recently, so I decided to
> upgrade to Python 2.5 (which I had wanted to do anyway), reinstall
> mod_python and try again. I'm getting the following error, however,
> and I can't sort out why.
>
> [Wed Aug 01 18:20:53 2007] [error] make_obcallback: could not import
> mod_python.apache.\n
> 'import site' failed; use -v for traceback
> ImportError: No module named mod_python.apache
> [Wed Aug 01 18:20:53 2007] [error] make_obcallback: Python path being
> used "['/usr/local/lib/python2.5/site-packages',
> '/usr/local/lib/python25.zip', '/usr/local/lib/python2.5/',
> '/usr/local/lib/python2.5/plat-linux2',
> '/usr/local/lib/python2.5/lib-tk',
> '/usr/local/lib/python2.5/lib-dynload']".
> [Wed Aug 01 18:20:53 2007] [error] get_interpreter: no interpreter
> callback found.
> [Wed Aug 01 18:20:53 2007] [error] [client 24.11.212.122]
> python_handler: Can't get/create interpreter.
>
> Initially, it seemed to make sense, since Python's site-packages
> wasn't listed in the path that was being used. However, when I run it
> with PYTHONPATH=/usr/local/lib/python2.5/site-packages, it still runs
> into the same error, and as you can see, site-packages is now
> included. I haven't found anything else in the logs that sheds any
> light on the subject.
>
> Is there something I can do to get more information about what's going wrong?
>
> -Gul
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From gulopine at gamemusic.org  Wed Aug  1 22:21:33 2007
From: gulopine at gamemusic.org (Marty Alchin)
Date: Wed Aug  1 22:21:42 2007
Subject: [mod_python] ImportError: No module named mod_python.apache
In-Reply-To: <88e286470708011840p240c3573v4946988c1306c9b4@mail.gmail.com>
References: <7e8d40920708011810q8bb5be0yc2c75a6ac3126309@mail.gmail.com>
	<88e286470708011840p240c3573v4946988c1306c9b4@mail.gmail.com>
Message-ID: <7e8d40920708011921x491577a9w51cdbdab54948546@mail.gmail.com>

I've been staring at computer screens for too long today, so I can't
make heads or tails of this at the moment.

-Gul

[Wed Aug 01 20:45:21 2007] [error] make_obcallback: could not import
mod_python.apache.\n
# installing zipimport hook
import zipimport # builtin
# installed zipimport hook
# /usr/local/lib/python2.5/site.pyc matches /usr/local/lib/python2.5/site.py
import site # precompiled from /usr/local/lib/python2.5/site.pyc
# /usr/local/lib/python2.5/os.pyc matches /usr/local/lib/python2.5/os.py
import os # precompiled from /usr/local/lib/python2.5/os.pyc
import posix # builtin
# /usr/local/lib/python2.5/posixpath.pyc matches
/usr/local/lib/python2.5/posixpath.py
import posixpath # precompiled from /usr/local/lib/python2.5/posixpath.pyc
# /usr/local/lib/python2.5/stat.pyc matches /usr/local/lib/python2.5/stat.py
import stat # precompiled from /usr/local/lib/python2.5/stat.pyc
# /usr/local/lib/python2.5/UserDict.pyc matches
/usr/local/lib/python2.5/UserDict.py
import UserDict # precompiled from /usr/local/lib/python2.5/UserDict.pyc
# /usr/local/lib/python2.5/copy_reg.pyc matches
/usr/local/lib/python2.5/copy_reg.py
import copy_reg # precompiled from /usr/local/lib/python2.5/copy_reg.pyc
# /usr/local/lib/python2.5/types.pyc matches /usr/local/lib/python2.5/types.py
import types # precompiled from /usr/local/lib/python2.5/types.pyc
import _types # builtin
# /usr/local/lib/python2.5/warnings.pyc matches
/usr/local/lib/python2.5/warnings.py
import warnings # precompiled from /usr/local/lib/python2.5/warnings.pyc
# /usr/local/lib/python2.5/linecache.pyc matches
/usr/local/lib/python2.5/linecache.py
import linecache # precompiled from /usr/local/lib/python2.5/linecache.pyc
import encodings # directory /usr/local/lib/python2.5/encodings
# /usr/local/lib/python2.5/encodings/__init__.pyc matches
/usr/local/lib/python2.5/encodings/__init__.py
import encodings # precompiled from
/usr/local/lib/python2.5/encodings/__init__.pyc
# /usr/local/lib/python2.5/codecs.pyc matches /usr/local/lib/python2.5/codecs.py
import codecs # precompiled from /usr/local/lib/python2.5/codecs.pyc
import _codecs # builtin
# /usr/local/lib/python2.5/encodings/aliases.pyc matches
/usr/local/lib/python2.5/encodings/aliases.py
import encodings.aliases # precompiled from
/usr/local/lib/python2.5/encodings/aliases.pyc
# /usr/local/lib/python2.5/encodings/utf_8.pyc matches
/usr/local/lib/python2.5/encodings/utf_8.py
import encodings.utf_8 # precompiled from
/usr/local/lib/python2.5/encodings/utf_8.pyc
import __builtin__ # previously loaded (__builtin__)
import sys # previously loaded (sys)
# installing zipimport hook
import zipimport # previously loaded (zipimport)
# installed zipimport hook
'import site' failed; traceback:
ImportError: No module named site
ImportError: No module named mod_python.apache
[Wed Aug 01 20:45:21 2007] [error] make_obcallback: Python path being
used "['/usr/local/lib/python2.5/site-packages',
'/usr/local/lib/python25.zip', '/usr/local/lib/python2.5/',
'/usr/local/lib/python2.5/plat-linux2',
'/usr/local/lib/python2.5/lib-tk',
'/usr/local/lib/python2.5/lib-dynload']".
[Wed Aug 01 20:45:21 2007] [error] get_interpreter: no interpreter
callback found.
[Wed Aug 01 20:45:21 2007] [error] [client 24.11.212.122]
python_handler: Can't get/create interpreter.

On 8/1/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> Run it again, setting:
>
>   PYTHONVERBOSE=1
>
> in the environment.
>
> The error is while site file is being imported, ie., before
> mod_python.apache is imported.
>
> Post back result to the mailing list.
>
> Graham
>
> On 02/08/07, Marty Alchin <gulopine@gamemusic.org> wrote:
> > I was having problems with mod_python recently, so I decided to
> > upgrade to Python 2.5 (which I had wanted to do anyway), reinstall
> > mod_python and try again. I'm getting the following error, however,
> > and I can't sort out why.
> >
> > [Wed Aug 01 18:20:53 2007] [error] make_obcallback: could not import
> > mod_python.apache.\n
> > 'import site' failed; use -v for traceback
> > ImportError: No module named mod_python.apache
> > [Wed Aug 01 18:20:53 2007] [error] make_obcallback: Python path being
> > used "['/usr/local/lib/python2.5/site-packages',
> > '/usr/local/lib/python25.zip', '/usr/local/lib/python2.5/',
> > '/usr/local/lib/python2.5/plat-linux2',
> > '/usr/local/lib/python2.5/lib-tk',
> > '/usr/local/lib/python2.5/lib-dynload']".
> > [Wed Aug 01 18:20:53 2007] [error] get_interpreter: no interpreter
> > callback found.
> > [Wed Aug 01 18:20:53 2007] [error] [client 24.11.212.122]
> > python_handler: Can't get/create interpreter.
> >
> > Initially, it seemed to make sense, since Python's site-packages
> > wasn't listed in the path that was being used. However, when I run it
> > with PYTHONPATH=/usr/local/lib/python2.5/site-packages, it still runs
> > into the same error, and as you can see, site-packages is now
> > included. I haven't found anything else in the logs that sheds any
> > light on the subject.
> >
> > Is there something I can do to get more information about what's going wrong?
> >
> > -Gul
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
>
From graham.dumpleton at gmail.com  Wed Aug  1 22:39:13 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Aug  1 22:39:22 2007
Subject: [mod_python] ImportError: No module named mod_python.apache
In-Reply-To: <7e8d40920708011921x491577a9w51cdbdab54948546@mail.gmail.com>
References: <7e8d40920708011810q8bb5be0yc2c75a6ac3126309@mail.gmail.com>
	<88e286470708011840p240c3573v4946988c1306c9b4@mail.gmail.com>
	<7e8d40920708011921x491577a9w51cdbdab54948546@mail.gmail.com>
Message-ID: <88e286470708011939l33608392jd806cdb6b322941b@mail.gmail.com>

Unfortunately the Apache/Python errors don't get ordered correctly as
to get Python messages to display needs an explicit flush. This only
get done later.

Anyway, the reason 'site-packages' wouldn't appear the first time is
that that directory is only added when 'site' is imported. You should
not be adding 'site-packages' explicitly to PYTHONPATH.

However, you are getting:

  'import site' failed; traceback:
  ImportError: No module named site

So 'site' module is failing to import.

Although, earlier it shows:

  # /usr/local/lib/python2.5/site.pyc matches /usr/local/lib/python2.5/site.py
  import site # precompiled from /usr/local/lib/python2.5/site.pyc

That it identifies a site.pyc suggests it does exist. You perhaps
should ensure that it and all other Python installed files are
readable to others. This is necessary as Apache would generally run as
a different user to you.

Also, is /usr/local/bin/python the version of Python executable that
would be found first in the PATH of the user that Apache is run as? Do
you have any other versions of Python 2.5 installed anywhere?

Does it make a difference if you set:

  PYTHONEXECUTABLE=/usr/local/bin/python

in environment of user that Apache is started as?

Graham

On 02/08/07, Marty Alchin <gulopine@gamemusic.org> wrote:
> I've been staring at computer screens for too long today, so I can't
> make heads or tails of this at the moment.
>
> -Gul
>
> [Wed Aug 01 20:45:21 2007] [error] make_obcallback: could not import
> mod_python.apache.\n
> # installing zipimport hook
> import zipimport # builtin
> # installed zipimport hook
> # /usr/local/lib/python2.5/site.pyc matches /usr/local/lib/python2.5/site.py
> import site # precompiled from /usr/local/lib/python2.5/site.pyc
> # /usr/local/lib/python2.5/os.pyc matches /usr/local/lib/python2.5/os.py
> import os # precompiled from /usr/local/lib/python2.5/os.pyc
> import posix # builtin
> # /usr/local/lib/python2.5/posixpath.pyc matches
> /usr/local/lib/python2.5/posixpath.py
> import posixpath # precompiled from /usr/local/lib/python2.5/posixpath.pyc
> # /usr/local/lib/python2.5/stat.pyc matches /usr/local/lib/python2.5/stat.py
> import stat # precompiled from /usr/local/lib/python2.5/stat.pyc
> # /usr/local/lib/python2.5/UserDict.pyc matches
> /usr/local/lib/python2.5/UserDict.py
> import UserDict # precompiled from /usr/local/lib/python2.5/UserDict.pyc
> # /usr/local/lib/python2.5/copy_reg.pyc matches
> /usr/local/lib/python2.5/copy_reg.py
> import copy_reg # precompiled from /usr/local/lib/python2.5/copy_reg.pyc
> # /usr/local/lib/python2.5/types.pyc matches /usr/local/lib/python2.5/types.py
> import types # precompiled from /usr/local/lib/python2.5/types.pyc
> import _types # builtin
> # /usr/local/lib/python2.5/warnings.pyc matches
> /usr/local/lib/python2.5/warnings.py
> import warnings # precompiled from /usr/local/lib/python2.5/warnings.pyc
> # /usr/local/lib/python2.5/linecache.pyc matches
> /usr/local/lib/python2.5/linecache.py
> import linecache # precompiled from /usr/local/lib/python2.5/linecache.pyc
> import encodings # directory /usr/local/lib/python2.5/encodings
> # /usr/local/lib/python2.5/encodings/__init__.pyc matches
> /usr/local/lib/python2.5/encodings/__init__.py
> import encodings # precompiled from
> /usr/local/lib/python2.5/encodings/__init__.pyc
> # /usr/local/lib/python2.5/codecs.pyc matches /usr/local/lib/python2.5/codecs.py
> import codecs # precompiled from /usr/local/lib/python2.5/codecs.pyc
> import _codecs # builtin
> # /usr/local/lib/python2.5/encodings/aliases.pyc matches
> /usr/local/lib/python2.5/encodings/aliases.py
> import encodings.aliases # precompiled from
> /usr/local/lib/python2.5/encodings/aliases.pyc
> # /usr/local/lib/python2.5/encodings/utf_8.pyc matches
> /usr/local/lib/python2.5/encodings/utf_8.py
> import encodings.utf_8 # precompiled from
> /usr/local/lib/python2.5/encodings/utf_8.pyc
> import __builtin__ # previously loaded (__builtin__)
> import sys # previously loaded (sys)
> # installing zipimport hook
> import zipimport # previously loaded (zipimport)
> # installed zipimport hook
> 'import site' failed; traceback:
> ImportError: No module named site
> ImportError: No module named mod_python.apache
> [Wed Aug 01 20:45:21 2007] [error] make_obcallback: Python path being
> used "['/usr/local/lib/python2.5/site-packages',
> '/usr/local/lib/python25.zip', '/usr/local/lib/python2.5/',
> '/usr/local/lib/python2.5/plat-linux2',
> '/usr/local/lib/python2.5/lib-tk',
> '/usr/local/lib/python2.5/lib-dynload']".
> [Wed Aug 01 20:45:21 2007] [error] get_interpreter: no interpreter
> callback found.
> [Wed Aug 01 20:45:21 2007] [error] [client 24.11.212.122]
> python_handler: Can't get/create interpreter.
>
> On 8/1/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > Run it again, setting:
> >
> >   PYTHONVERBOSE=1
> >
> > in the environment.
> >
> > The error is while site file is being imported, ie., before
> > mod_python.apache is imported.
> >
> > Post back result to the mailing list.
> >
> > Graham
> >
> > On 02/08/07, Marty Alchin <gulopine@gamemusic.org> wrote:
> > > I was having problems with mod_python recently, so I decided to
> > > upgrade to Python 2.5 (which I had wanted to do anyway), reinstall
> > > mod_python and try again. I'm getting the following error, however,
> > > and I can't sort out why.
> > >
> > > [Wed Aug 01 18:20:53 2007] [error] make_obcallback: could not import
> > > mod_python.apache.\n
> > > 'import site' failed; use -v for traceback
> > > ImportError: No module named mod_python.apache
> > > [Wed Aug 01 18:20:53 2007] [error] make_obcallback: Python path being
> > > used "['/usr/local/lib/python2.5/site-packages',
> > > '/usr/local/lib/python25.zip', '/usr/local/lib/python2.5/',
> > > '/usr/local/lib/python2.5/plat-linux2',
> > > '/usr/local/lib/python2.5/lib-tk',
> > > '/usr/local/lib/python2.5/lib-dynload']".
> > > [Wed Aug 01 18:20:53 2007] [error] get_interpreter: no interpreter
> > > callback found.
> > > [Wed Aug 01 18:20:53 2007] [error] [client 24.11.212.122]
> > > python_handler: Can't get/create interpreter.
> > >
> > > Initially, it seemed to make sense, since Python's site-packages
> > > wasn't listed in the path that was being used. However, when I run it
> > > with PYTHONPATH=/usr/local/lib/python2.5/site-packages, it still runs
> > > into the same error, and as you can see, site-packages is now
> > > included. I haven't found anything else in the logs that sheds any
> > > light on the subject.
> > >
> > > Is there something I can do to get more information about what's going wrong?
> > >
> > > -Gul
> > > _______________________________________________
> > > Mod_python mailing list
> > > Mod_python@modpython.org
> > > http://mailman.modpython.org/mailman/listinfo/mod_python
> > >
> >
>
From linux at qbox.es  Fri Aug  3 05:33:40 2007
From: linux at qbox.es (=?ISO-8859-1?Q?S=2ER=2EPard=E1?=)
Date: Fri Aug  3 05:33:54 2007
Subject: [mod_python] Encoding problems
Message-ID: <1186133620.7867.17.camel@ThorUx>

Hi,

I have problems in a *.psp page, where I have code like :

	
	File xx.psp:

		<%
		table = Table()
		table.select('tipo','3A?OS')		
		%>
        
        
        
        
	File tables.py:

		# -*- coding: utf-8 -*-
	
		...

		class Table:
			...
			def select(self, column, value):
				...
				lowerValue = str(value).lower()
				....
				where = 'WHERE lower(%s) = %s' % (column, lowerValue)
				...

			...
		...





But in expression:  str(value).lower()  
I obtain 3a?os instead of 3a?os.



I am considering to change the where line to: where = 'WHERE lower(%s) =
lower(%s)' % (column, value)
In that case it works OK in the postgregsql 8.2 database with UTF-8
encoding.


But I want to know what I am not doing OK, to avoid future problems with
character codification.



Thank You.



From clodoaldo.pinto.neto at gmail.com  Fri Aug  3 12:28:45 2007
From: clodoaldo.pinto.neto at gmail.com (Clodoaldo)
Date: Fri Aug  3 12:29:01 2007
Subject: [mod_python] Encoding problems
In-Reply-To: <1186133620.7867.17.camel@ThorUx>
References: <1186133620.7867.17.camel@ThorUx>
Message-ID: <a595de7a0708030928x37e521dh1db66218f2af258d@mail.gmail.com>

2007/8/3, S.R.Pard? <linux@qbox.es>:
> Hi,
>
> I have problems in a *.psp page, where I have code like :
>
>
>        File xx.psp:
>
>                <%
>                table = Table()
>                table.select('tipo','3A?OS')
>                %>
>
>
>
>
>        File tables.py:
>
>                # -*- coding: utf-8 -*-
>
>                ...
>
>                class Table:
>                        ...
>                        def select(self, column, value):
>                                ...
>                                lowerValue = str(value).lower()

Try like this:

lowerValue = str(value).decode('utf8').lower().encode('utf8')

Clodoaldo Pinto Neto

From listas at flavioribeiro.com  Fri Aug  3 14:13:40 2007
From: listas at flavioribeiro.com (=?ISO-8859-1?Q?Fl=E1vio_Ribeiro?=)
Date: Fri Aug  3 14:13:50 2007
Subject: [mod_python] Login system
Message-ID: <873b128e0708031113qe6472b6oe7ad170ccd73d04e@mail.gmail.com>

Hi all,

Has anyone an simple example of a login system made in mod_python (psp) ?

thanks

-- 
Fl?vio Ribeiro
listas@flavioribeiro.com
www.flavioribeiro.com
(83) 9981.4441
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070803/11a451fb/attachment.html
From njvsny at yahoo.com  Fri Aug  3 19:15:02 2007
From: njvsny at yahoo.com (Hristo Asenov)
Date: Fri Aug  3 19:15:29 2007
Subject: [mod_python] Login system
In-Reply-To: <873b128e0708031113qe6472b6oe7ad170ccd73d04e@mail.gmail.com>
Message-ID: <91618.29648.qm@web37914.mail.mud.yahoo.com>

Have you looked at PythonAuthenHandler? There's an example at http://www.modpython.org/live/current/doc-html/tut-more-complicated.html

Fl?vio Ribeiro <listas@flavioribeiro.com> wrote: Hi all,

Has anyone an simple example of a login system made in mod_python (psp) ?

thanks

-- 
Fl?vio Ribeiro
listas@flavioribeiro.com
 www.flavioribeiro.com
(83) 9981.4441 _______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python


       
---------------------------------
Take the Internet to Go: Yahoo!Go puts the Internet in your pocket: mail, news, photos & more. 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070803/53852053/attachment.html
From vikram at iiit.ac.in  Sat Aug  4 03:11:22 2007
From: vikram at iiit.ac.in (Vikram Pudi)
Date: Sat Aug  4 03:12:01 2007
Subject: [mod_python] sqlite commands in python 2.5.1 not working in
	modpython 3.3.1
Message-ID: <46B4269A.30808@iiit.ac.in>


I have the latest versions of modpython (3.3.1) and python (2.5.1) 
compiled from scratch. I can create a connection and a cursor object, 
but cur.execute() commands dont work and the program doesnt proceed to 
the next line. There is no error output. Apache error log shows that the 
modpython child process exited with a segmentation fault.

Request any kind of help to get this to work... I am teaching a course 
for over 100 students and planned to cover modpython as the first choice 
  for web-programming... Now I am stuck!

Regards,
-Vikram.


-- 
This message has been scanned for viruses and
dangerous content by MailScanner, and is
believed to be clean.

From richardlewis at fastmail.co.uk  Sat Aug  4 04:02:03 2007
From: richardlewis at fastmail.co.uk (Richard Lewis)
Date: Sat Aug  4 04:02:13 2007
Subject: [mod_python] sqlite commands in python 2.5.1 not working in
	modpython 3.3.1
In-Reply-To: <46B4269A.30808@iiit.ac.in>
References: <46B4269A.30808@iiit.ac.in>
Message-ID: <200708040902.03404.richardlewis@fastmail.co.uk>

On Saturday 04 August 2007 08:11:22 Vikram Pudi wrote:
> I have the latest versions of modpython (3.3.1) and python
> (2.5.1) compiled from scratch. I can create a connection and a
> cursor object, but cur.execute() commands dont work and the
> program doesnt proceed to the next line. There is no error
> output. Apache error log shows that the modpython child process
> exited with a segmentation fault.
>
What operating system are you using? What version of sqlite? Did you 
compile it and the Python bindings yourself too?

Have you tried just using pre-compiled binaries of Python / 
mod_python / sqlite instead?

Cheers,
Richard
-- 
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
Richard Lewis
http://www.richard-lewis.me.uk/
JID: ironchicken@jabber.earth.li
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
From vikram at iiit.ac.in  Sat Aug  4 04:47:55 2007
From: vikram at iiit.ac.in (Vikram Pudi)
Date: Sat Aug  4 04:48:29 2007
Subject: [mod_python] sqlite commands in python 2.5.1 not working
	in	modpython 3.3.1
In-Reply-To: <200708040902.03404.richardlewis@fastmail.co.uk>
References: <46B4269A.30808@iiit.ac.in>
	<200708040902.03404.richardlewis@fastmail.co.uk>
Message-ID: <46B43D3B.8050509@iiit.ac.in>


Since python 2.5.1 comes with sqlite inbuilt, I didn't compile sqlite 
seperately. To find out the sqlite version, I did "import sqlite3" and 
"print sqlite3.version". It outputs 2.3.2!  I am sure I have sqlite3.4.0 
also installed on my system. How to fix this? To find out my os, uname 
gives: "Linux cygnus 2.6.9-22.EL".

Regards,
-Vikram.

Richard Lewis wrote:
> On Saturday 04 August 2007 08:11:22 Vikram Pudi wrote:
>> I have the latest versions of modpython (3.3.1) and python
>> (2.5.1) compiled from scratch. I can create a connection and a
>> cursor object, but cur.execute() commands dont work and the
>> program doesnt proceed to the next line. There is no error
>> output. Apache error log shows that the modpython child process
>> exited with a segmentation fault.
>>
> What operating system are you using? What version of sqlite? Did you 
> compile it and the Python bindings yourself too?
> 
> Have you tried just using pre-compiled binaries of Python / 
> mod_python / sqlite instead?
> 
> Cheers,
> Richard

-- 
This message has been scanned for viruses and
dangerous content by MailScanner, and is
believed to be clean.

From vikram at iiit.ac.in  Sat Aug  4 05:58:37 2007
From: vikram at iiit.ac.in (Vikram Pudi)
Date: Sat Aug  4 05:59:18 2007
Subject: [mod_python] sqlite commands in python 2.5.1 not
	working	in	modpython 3.3.1
In-Reply-To: <46B43D3B.8050509@iiit.ac.in>
References: <46B4269A.30808@iiit.ac.in>	<200708040902.03404.richardlewis@fastmail.co.uk>
	<46B43D3B.8050509@iiit.ac.in>
Message-ID: <46B44DCD.5060806@iiit.ac.in>


The problem is fixed!

I figured that the sqlite3.version gives the version of pysqlite and 
sqlite3.sqlite_vesion gives the sqlite's version... for me it was 3.4.0 
so that is quite recent.

I found this article at http://www.initd.org/tracker/pysqlite/ticket/174
which mentioned that the pysqlite that comes with python is 2.3.2 and it 
  doesnt work with modpython... so I downloaded the latest version of 
pysqlite and installed it and it worked!

The only problem is I need to do:
from pysqlite2 import dbapi2 as sqlite3

instead of plain: import sqlite3

But I'll live with that.

Thanks,
-Vikram.

Vikram Pudi wrote:
> 
> Since python 2.5.1 comes with sqlite inbuilt, I didn't compile sqlite 
> seperately. To find out the sqlite version, I did "import sqlite3" and 
> "print sqlite3.version". It outputs 2.3.2!  I am sure I have sqlite3.4.0 
> also installed on my system. How to fix this? To find out my os, uname 
> gives: "Linux cygnus 2.6.9-22.EL".
> 
> Regards,
> -Vikram.
> 
> Richard Lewis wrote:
>> On Saturday 04 August 2007 08:11:22 Vikram Pudi wrote:
>>> I have the latest versions of modpython (3.3.1) and python
>>> (2.5.1) compiled from scratch. I can create a connection and a
>>> cursor object, but cur.execute() commands dont work and the
>>> program doesnt proceed to the next line. There is no error
>>> output. Apache error log shows that the modpython child process
>>> exited with a segmentation fault.
>>>
>> What operating system are you using? What version of sqlite? Did you 
>> compile it and the Python bindings yourself too?
>>
>> Have you tried just using pre-compiled binaries of Python / mod_python 
>> / sqlite instead?
>>
>> Cheers,
>> Richard
> 

-- 
This message has been scanned for viruses and
dangerous content by MailScanner, and is
believed to be clean.

From graham.dumpleton at gmail.com  Sat Aug  4 06:08:52 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sat Aug  4 06:09:02 2007
Subject: [mod_python] undefined symbol: forkpty
In-Reply-To: <5D65485E-626D-4F14-A04E-4CDD255EF789@duke.edu>
References: <4bed4b960707271724h7f2c1fcdo121dfea4dd081085@mail.gmail.com>
	<88e286470707290413j78e8a726i84ec5506cd14e1d9@mail.gmail.com>
	<5D65485E-626D-4F14-A04E-4CDD255EF789@duke.edu>
Message-ID: <88e286470708040308t3f239e5dy5b10ab9eee000c84@mail.gmail.com>

In the same directory as the Apache httpd binary there is a file
called envvars. In that file add:

  LD_PRELOAD=/usr/lib/libutil.so
  export LD_PRELOAD

Alternatively, after having run 'configure' on mod_python source code,
modify src/Makefile and add '-lutil' into the LDFLAGS definition. Then
compile mod_python and install as per normal.

Graham

On 04/08/07, Justin Wickett <justin.wickett@duke.edu> wrote:
> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
>
> Hi Graham,
>
> I am having the exact same problem with my FC7 image that Gustavo
> Steigert mentioned. I used 'yum' to download and install the HTTPD
> RPM (version 2.2.4-4.1.fc7) as well as the HTTPD-devel RPM, so I
> didn't compile anything myself. I did however compile mod_python
> 3.3.1. When I went to start up Apache, I received:
>
> Starting httpd: httpd: Syntax error on line 209 of /etc/httpd/conf/
> httpd.conf: Syntax error on line 6 of /etc/httpd/conf.d/python.conf:
> Cannot load /usr/lib/httpd/modules/mod_python.so into server: /usr/
> lib/httpd/modules/mod_python.so: undefined symbol: forkpty
>
> Here is some info about my libutil.a...
>
> - -bash-3.2# nm /usr/lib/libutil.a | grep forkpty
> forkpty.o:
> 00000000 T forkpty
>
> Because I was not the one who compiled Apache,  I don't think there
> is a way to link it at this point. Do you (or anyone else) have any
> advice as to how to fix this problem? Should I compile Apache and
> link the library then? Thanks in advance...
>
> Justin Wickett
> Duke 2010
> http://www.duke.edu/~jyw2
>
>
>
> On Jul 29, 2007, at 4:13 AM, Graham Dumpleton wrote:
>
> > On 28/07/07, Gustavo Steigert <steigert@gmail.com> wrote:
> >> Hi guys,
> >>
> >> I installed Apache2 (from source) and it worked fine. Then I
> >> installed
> >> mod_python (also from source) and no error was shown; after, I
> >> configured
> >> the httpd.conf for loading mod_python, and now when I try to start
> >> apache,
> >> it says:
> >>
> >>  httpd: Syntax error on line 54 of
> >> /usr/local/apache2/conf/httpd.conf: Cannot load
> >> /usr/local/apache2/modules/mod_python.so into server:
> >> /usr/local/apache2/modules/mod_python.so: undefined symbol:
> >> forkpty
> >>
> >> Version information:
> >>
> >> httpd 2.2.4
> >> mod_python 3.3.1
> >> fedora 7Can anyone please help?
> >
> > The forkpty function isn't even used by mod_python, although it is
> > used in the Python 'posix' module which would probably be
> > automatically loaded by Python at startup.
> >
> > What I would suggest is the problem is that whatever system library
> > defines that function isn't being linked into Apache when it is being
> > built.
> >
> > First step would thus be to find out which system library contains
> > that function. To do this, run 'nm' on each of the system libraries in
> > /usr/lib until you find it. On Linux box I have access to the library
> > is libutil.
> >
> > $ nm libutil.a | grep forkpty
> > forkpty.o:
> > 00000000 T forkpty
> >
> > Make sure this library is linked into Apache, preferably as a shared
> > library as Apache itself may not require the function and wouldn't
> > link it in if libutil is a static library.
> >
> > Graham
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
>
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v1.4.7 (Darwin)
>
> iD8DBQFGtCntJSH8HIex+CkRAlqpAJ40Ydh6+akifwyy24UKx3XoFyQv/wCcDmVA
> KNa42ElKmBlM7FDXUyfJA+I=
> =F5pV
> -----END PGP SIGNATURE-----
>
From graham.dumpleton at gmail.com  Sat Aug  4 06:18:24 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sat Aug  4 06:18:35 2007
Subject: [mod_python] undefined symbol: forkpty
In-Reply-To: <88e286470708040308t3f239e5dy5b10ab9eee000c84@mail.gmail.com>
References: <4bed4b960707271724h7f2c1fcdo121dfea4dd081085@mail.gmail.com>
	<88e286470707290413j78e8a726i84ec5506cd14e1d9@mail.gmail.com>
	<5D65485E-626D-4F14-A04E-4CDD255EF789@duke.edu>
	<88e286470708040308t3f239e5dy5b10ab9eee000c84@mail.gmail.com>
Message-ID: <88e286470708040318i70d0b71ax4a82290f363a0cda@mail.gmail.com>

On 04/08/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> In the same directory as the Apache httpd binary there is a file
> called envvars. In that file add:
>
>   LD_PRELOAD=/usr/lib/libutil.so
>   export LD_PRELOAD
>
> Alternatively, after having run 'configure' on mod_python source code,
> modify src/Makefile and add '-lutil' into the LDFLAGS definition. Then
> compile mod_python and install as per normal.

By rights should actually be added to LIBS not LDFLAGS, but probably
would still have worked anyway. :-)

> Graham
>
> On 04/08/07, Justin Wickett <justin.wickett@duke.edu> wrote:
> > -----BEGIN PGP SIGNED MESSAGE-----
> > Hash: SHA1
> >
> > Hi Graham,
> >
> > I am having the exact same problem with my FC7 image that Gustavo
> > Steigert mentioned. I used 'yum' to download and install the HTTPD
> > RPM (version 2.2.4-4.1.fc7) as well as the HTTPD-devel RPM, so I
> > didn't compile anything myself. I did however compile mod_python
> > 3.3.1. When I went to start up Apache, I received:
> >
> > Starting httpd: httpd: Syntax error on line 209 of /etc/httpd/conf/
> > httpd.conf: Syntax error on line 6 of /etc/httpd/conf.d/python.conf:
> > Cannot load /usr/lib/httpd/modules/mod_python.so into server: /usr/
> > lib/httpd/modules/mod_python.so: undefined symbol: forkpty
> >
> > Here is some info about my libutil.a...
> >
> > - -bash-3.2# nm /usr/lib/libutil.a | grep forkpty
> > forkpty.o:
> > 00000000 T forkpty
> >
> > Because I was not the one who compiled Apache,  I don't think there
> > is a way to link it at this point. Do you (or anyone else) have any
> > advice as to how to fix this problem? Should I compile Apache and
> > link the library then? Thanks in advance...
> >
> > Justin Wickett
> > Duke 2010
> > http://www.duke.edu/~jyw2
> >
> >
> >
> > On Jul 29, 2007, at 4:13 AM, Graham Dumpleton wrote:
> >
> > > On 28/07/07, Gustavo Steigert <steigert@gmail.com> wrote:
> > >> Hi guys,
> > >>
> > >> I installed Apache2 (from source) and it worked fine. Then I
> > >> installed
> > >> mod_python (also from source) and no error was shown; after, I
> > >> configured
> > >> the httpd.conf for loading mod_python, and now when I try to start
> > >> apache,
> > >> it says:
> > >>
> > >>  httpd: Syntax error on line 54 of
> > >> /usr/local/apache2/conf/httpd.conf: Cannot load
> > >> /usr/local/apache2/modules/mod_python.so into server:
> > >> /usr/local/apache2/modules/mod_python.so: undefined symbol:
> > >> forkpty
> > >>
> > >> Version information:
> > >>
> > >> httpd 2.2.4
> > >> mod_python 3.3.1
> > >> fedora 7Can anyone please help?
> > >
> > > The forkpty function isn't even used by mod_python, although it is
> > > used in the Python 'posix' module which would probably be
> > > automatically loaded by Python at startup.
> > >
> > > What I would suggest is the problem is that whatever system library
> > > defines that function isn't being linked into Apache when it is being
> > > built.
> > >
> > > First step would thus be to find out which system library contains
> > > that function. To do this, run 'nm' on each of the system libraries in
> > > /usr/lib until you find it. On Linux box I have access to the library
> > > is libutil.
> > >
> > > $ nm libutil.a | grep forkpty
> > > forkpty.o:
> > > 00000000 T forkpty
> > >
> > > Make sure this library is linked into Apache, preferably as a shared
> > > library as Apache itself may not require the function and wouldn't
> > > link it in if libutil is a static library.
> > >
> > > Graham
> > > _______________________________________________
> > > Mod_python mailing list
> > > Mod_python@modpython.org
> > > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> > -----BEGIN PGP SIGNATURE-----
> > Version: GnuPG v1.4.7 (Darwin)
> >
> > iD8DBQFGtCntJSH8HIex+CkRAlqpAJ40Ydh6+akifwyy24UKx3XoFyQv/wCcDmVA
> > KNa42ElKmBlM7FDXUyfJA+I=
> > =F5pV
> > -----END PGP SIGNATURE-----
> >
>
From matusis at matusis.com  Mon Aug  6 01:55:17 2007
From: matusis at matusis.com (Alec Matusis)
Date: Mon Aug  6 01:55:34 2007
Subject: [mod_python] Session class or Memcache to reduce load?
Message-ID: <002301c7d7ee$5e60f7f0$1b22e7d0$@com>

Hello, I am sorry if my question is too basic. I would like to reduce the
load on apache 2.0 (on 2.6.9 linux) that is running with prefork MPM.
There are two main things that are causing the load:

a) Thumbnail images that are requested repeatedly 
b) A simple DB query is necessary to locate an image file after the request.
The result of the query does not change. DB is located on another machine.

My first question, do we need to cache \thumbnail images at all, or the
file-caching by the OS is sufficient?

Second question, to cache the results of the query, should we use
mod_python's Session class ( wich will use DbmSession since we are using
prefork MPM), or memcache?

For certain reasons in the application logic we cannot use apache's
mod_cache.

Thanks

Alec.

From cklinger at novareto.de  Mon Aug  6 04:42:03 2007
From: cklinger at novareto.de (Christian Klinger)
Date: Mon Aug  6 04:45:16 2007
Subject: [mod_python] Access-Handler based on a Variable
Message-ID: <f96msn$kh4$1@sea.gmane.org>

Hi mod_python Users,

i am new to mod_python so sorry for stupid questions.


I try to write an access handler for an xml-rpc connection.
The access handler should check if a key in the xml-rpc
data is correct.

Here my questions:
Is this possible with mod_python?
Has anyone an example?
How can i access the (12) of getResults in the accesshandler.


Christian

Here is my code:
--------------------------------------------------------
<VirtualHost *:80>
     ServerName dummy-host.example.com
     ServerAlias www.dummy-host.example.com

    <Proxy *>
       AuthBasicAuthoritative Off
        AddHandler mod_python .py
        PythonHandler myscript.py
        PythonAccessHandler myscript
        PythonDebug On
        PythonEnablePdb On
      </Proxy>

         RewriteEngine On
         RewriteRule ^/(.*) 
http://localhost:8080/VirtualHostBase/http/%{SERVER_NAME}:80/extraNet/VirtualHostRoot/$1 
[L,P]

</VirtualHost>


myscript.py
def accesshandler(req):
     apache.log_error("accesshandler -%s" %req)
     if key == "OK"
         return apache.OK
     return


the client:
portal = xmlrpclib.Server('http://192.168.2.23/extraNet')
print portal
print portal.getResult(12)

From graham.dumpleton at gmail.com  Mon Aug  6 05:20:14 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Aug  6 05:20:23 2007
Subject: [mod_python] Access-Handler based on a Variable
In-Reply-To: <f96msn$kh4$1@sea.gmane.org>
References: <f96msn$kh4$1@sea.gmane.org>
Message-ID: <88e286470708060220j1d653ac4yca024674b220410a@mail.gmail.com>

On 06/08/07, Christian Klinger <cklinger@novareto.de> wrote:
> Hi mod_python Users,
>
> i am new to mod_python so sorry for stupid questions.
>
>
> I try to write an access handler for an xml-rpc connection.
> The access handler should check if a key in the xml-rpc
> data is correct.
>
> Here my questions:
> Is this possible with mod_python?
> Has anyone an example?
> How can i access the (12) of getResults in the accesshandler.
>
>
> Christian
>
> Here is my code:
> --------------------------------------------------------
> <VirtualHost *:80>
>      ServerName dummy-host.example.com
>      ServerAlias www.dummy-host.example.com
>
>     <Proxy *>
>        AuthBasicAuthoritative Off
>         AddHandler mod_python .py
>         PythonHandler myscript.py
>         PythonAccessHandler myscript
>         PythonDebug On
>         PythonEnablePdb On
>       </Proxy>
>
>          RewriteEngine On
>          RewriteRule ^/(.*)
> http://localhost:8080/VirtualHostBase/http/%{SERVER_NAME}:80/extraNet/VirtualHostRoot/$1
> [L,P]
>
> </VirtualHost>
>
>
> myscript.py
> def accesshandler(req):
>      apache.log_error("accesshandler -%s" %req)
>      if key == "OK"
>          return apache.OK
>      return
>
>
> the client:
> portal = xmlrpclib.Server('http://192.168.2.23/extraNet')
> print portal
> print portal.getResult(12)

An access handler or other handler phase prior to the actual content
handler should not as a rule be consuming the request content. If this
is done, it can cause problems when certain features of Apache are
being used.

All I can suggest is not to use an access handler, but instead use a
stacked content handler.

         PythonHandler myscript::prehandler myscript::handler

The prehandler could decode the actual XML-RPC request and check for
any required parameters it may pass. If the required parameter is
missing it should return the appropriate error status, otherwise it
would store the decoded request content as req.data and return
apache.DECLINED as the result. Provide apache.DECLINED is returned as
the result, the real handler would then still be called and it can
access the decode request from the prehandler as req.data.

Graham
From graham.dumpleton at gmail.com  Mon Aug  6 05:25:09 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Aug  6 05:25:17 2007
Subject: [mod_python] Session class or Memcache to reduce load?
In-Reply-To: <002301c7d7ee$5e60f7f0$1b22e7d0$@com>
References: <002301c7d7ee$5e60f7f0$1b22e7d0$@com>
Message-ID: <88e286470708060225v37e8a162pfeab4169fce432f1@mail.gmail.com>

On 06/08/07, Alec Matusis <matusis@matusis.com> wrote:
> Hello, I am sorry if my question is too basic. I would like to reduce the
> load on apache 2.0 (on 2.6.9 linux) that is running with prefork MPM.
> There are two main things that are causing the load:

How do you know that these two things are causing the load?

> a) Thumbnail images that are requested repeatedly

Are you serving up the thumbnails from Python code dynamically or
allowing Apache to serve them up form a static file?

> b) A simple DB query is necessary to locate an image file after the request.
> The result of the query does not change. DB is located on another machine.
>
> My first question, do we need to cache \thumbnail images at all, or the
> file-caching by the OS is sufficient?

OS file caching probably will not make much difference. Where one can
waste a lot of cycles though is by using Python code to serve up the
images. Thus, if Python is involved in serving up the images, how is
it being done?

> Second question, to cache the results of the query, should we use
> mod_python's Session class ( wich will use DbmSession since we are using
> prefork MPM), or memcache?

Traditionally people use memcached for this.

> For certain reasons in the application logic we cannot use apache's
> mod_cache.

What reasons?

Graham
From cklinger at novareto.de  Mon Aug  6 05:51:38 2007
From: cklinger at novareto.de (Christian Klinger)
Date: Mon Aug  6 05:51:59 2007
Subject: [mod_python] Re: Access-Handler based on a Variable
In-Reply-To: <88e286470708060220j1d653ac4yca024674b220410a@mail.gmail.com>
References: <f96msn$kh4$1@sea.gmane.org>
	<88e286470708060220j1d653ac4yca024674b220410a@mail.gmail.com>
Message-ID: <f96qv6$kh4$2@sea.gmane.org>

Graham Dumpleton schrieb:
> On 06/08/07, Christian Klinger <cklinger@novareto.de> wrote:
>> Hi mod_python Users,
>>
>> i am new to mod_python so sorry for stupid questions.
>>
>>
>> I try to write an access handler for an xml-rpc connection.
>> The access handler should check if a key in the xml-rpc
>> data is correct.
>>
>> Here my questions:
>> Is this possible with mod_python?
>> Has anyone an example?
>> How can i access the (12) of getResults in the accesshandler.
>>
>>
>> Christian
>>
>> Here is my code:
>> --------------------------------------------------------
>> <VirtualHost *:80>
>>      ServerName dummy-host.example.com
>>      ServerAlias www.dummy-host.example.com
>>
>>     <Proxy *>
>>        AuthBasicAuthoritative Off
>>         AddHandler mod_python .py
>>         PythonHandler myscript.py
>>         PythonAccessHandler myscript
>>         PythonDebug On
>>         PythonEnablePdb On
>>       </Proxy>
>>
>>          RewriteEngine On
>>          RewriteRule ^/(.*)
>> http://localhost:8080/VirtualHostBase/http/%{SERVER_NAME}:80/extraNet/VirtualHostRoot/$1
>> [L,P]
>>
>> </VirtualHost>
>>
>>
>> myscript.py
>> def accesshandler(req):
>>      apache.log_error("accesshandler -%s" %req)
>>      if key == "OK"
>>          return apache.OK
>>      return
>>
>>
>> the client:
>> portal = xmlrpclib.Server('http://192.168.2.23/extraNet')
>> print portal
>> print portal.getResult(12)
> 
> An access handler or other handler phase prior to the actual content
> handler should not as a rule be consuming the request content. If this
> is done, it can cause problems when certain features of Apache are
> being used.
> 
> All I can suggest is not to use an access handler, but instead use a
> stacked content handler.
> 
>          PythonHandler myscript::prehandler myscript::handler
> 
> The prehandler could decode the actual XML-RPC request and check for
> any required parameters it may pass. If the required parameter is
> missing it should return the appropriate error status, otherwise it
> would store the decoded request content as req.data and return
> apache.DECLINED as the result. Provide apache.DECLINED is returned as
> the result, the real handler would then still be called and it can
> access the decode request from the prehandler as req.data.
> 
> Graham
Hi Graham,

i try to use an apache as a proxy for the real web-server.
I want only allow users with a valid key to access the service.

Maybe i can use an Authenhandler or Authzhandler?

Now i use this script:

def accesshandler(req):
     #import pdb; pdb.set_trace()
     data = req.read()
     apache.log_error("accesshandler %s" %len(data))
     if data != '':
         key = xmlrpclib.loads(data)[0][0]
     #key = xmlrpclib.loads(data)[0][1]
         apache.log_error("accesshandler %s" %key)
     return apache.OK

In the error_log i see the right key.

But the client gives me this traceback (unfortunatly i do not see
something in the apache error_log:

haubitz:~/Scripts/rpc chrissi$ python2.3 client.py
Traceback (most recent call last):
   File "client.py", line 53, in ?
     portal.getResult('gustav')
   File 
"/System/Library/Frameworks/Python.framework/Versions/2.3/lib/python2.3/xmlrpclib.py", 
line 1032, in __call__
     return self.__send(self.__name, args)
   File 
"/System/Library/Frameworks/Python.framework/Versions/2.3/lib/python2.3/xmlrpclib.py", 
line 1319, in __request
     verbose=self.__verbose
   File 
"/System/Library/Frameworks/Python.framework/Versions/2.3/lib/python2.3/xmlrpclib.py", 
line 1073, in request
     headers
xmlrpclib.ProtocolError: <ProtocolError for 192.168.2.23/extraNet: 500 
Internal Server Error>


Christian

From graham.dumpleton at gmail.com  Mon Aug  6 07:08:31 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Aug  6 07:08:39 2007
Subject: [mod_python] Re: Access-Handler based on a Variable
In-Reply-To: <f96qv6$kh4$2@sea.gmane.org>
References: <f96msn$kh4$1@sea.gmane.org>
	<88e286470708060220j1d653ac4yca024674b220410a@mail.gmail.com>
	<f96qv6$kh4$2@sea.gmane.org>
Message-ID: <88e286470708060408i63e2b54cjc4019d9348a1916b@mail.gmail.com>

On 06/08/07, Christian Klinger <cklinger@novareto.de> wrote:
> i try to use an apache as a proxy for the real web-server.
> I want only allow users with a valid key to access the service.
>
> Maybe i can use an Authenhandler or Authzhandler?

You can't go reading the data of the request in these either. Reading
the content in any of these handlers will consume it and it will not
be passed onto the content handler. In this case the content handler
is the proxy and so the proxy will never see the data and will not be
able to pass it on to the down stream web site.

Reasons why you might be getting a 500 error are that your handler
simply has an error in it and a 500 error page is getting passed back
to the XML-RPC client, but it doesn't display it. Another reason may
be because you have consumed the content and so when the proxy tries
to transfer the data to the downstream server, it finds that the
Content-Length doesn't match what data is available because actual
content length is now zero.

The only way one can interrogate request content and preserve it is to
use an input filter, but this also will be useless to you, as there is
no way in an input filter to return an error response back to the
client if you intend rejecting the request.

The only this I can think of that you could do is implement a content
handler which accepts the request as an XML-RPC request, rejects or
accept it, and then makes a separate XML-RPC call using xmlrpclib
module to the downstream web server and return and response you get.
Ie., you effectively do the proxy rather than having mod_proxy do it.

Graham
From seanglover at sympatico.ca  Mon Aug  6 11:47:46 2007
From: seanglover at sympatico.ca (Sean Glover)
Date: Mon Aug  6 11:47:49 2007
Subject: [mod_python] unsubscribe
Message-ID: <BAYC1-PASMTP059vJdg00005e0e@bayc1-pasmtp05.bayc1.hotmail.com>

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070806/1f9d9924/attachment.html
From matusis at matusis.com  Mon Aug  6 16:53:09 2007
From: matusis at matusis.com (Alec Matusis)
Date: Mon Aug  6 16:53:27 2007
Subject: [mod_python] Session class or Memcache to reduce load?
In-Reply-To: <88e286470708060225v37e8a162pfeab4169fce432f1@mail.gmail.com>
References: <002301c7d7ee$5e60f7f0$1b22e7d0$@com>
	<88e286470708060225v37e8a162pfeab4169fce432f1@mail.gmail.com>
Message-ID: <00fd01c7d86b$cd220e90$67662bb0$@com>



> -----Original Message-----
> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
> Sent: Monday, August 06, 2007 2:25 AM
> > Hello, I am sorry if my question is too basic. I would like to reduce
> the
> > load on apache 2.0 (on 2.6.9 linux) that is running with prefork MPM.
> > There are two main things that are causing the load:
> 
> How do you know that these two things are causing the load?
> 

Because all this apache server (this physical machine) does is serving
thumbnails. 

> > a) Thumbnail images that are requested repeatedly
> 
> Are you serving up the thumbnails from Python code dynamically or
> allowing Apache to serve them up form a static file?

Dynamically.
 
> 
> > b) A simple DB query is necessary to locate an image file after the
> request.
> > The result of the query does not change. DB is located on another
> machine.
> >
> > My first question, do we need to cache \thumbnail images at all, or
> the
> > file-caching by the OS is sufficient?
> 
> OS file caching probably will not make much difference. Where one can
> waste a lot of cycles though is by using Python code to serve up the
> images. Thus, if Python is involved in serving up the images, how is
> it being done?
> 

The URI in the client's request contains an image code. Python queries the
DB (on a separate machine) to convert the URI into the image file location,
and then uses 

        f =  open(file_path)
        im_data = f.read()
        f.close()

then it determines image type using PIL

	  im = Image.open(file_path)
	  im_type = im.format.lower()

(Image.open() is a lazy operation in PIL, so I think it does not have to do
much to determine the image format)
Then python writes the data to the client

        self.req.content_type = 'image/' + im_type
        self.req.headers_out['Content-Length'] = str(len(im_data))
        self.dict['bin_data'] = im_data

 
> > Second question, to cache the results of the query, should we use
> > mod_python's Session class ( wich will use DbmSession since we are
> using
> > prefork MPM), or memcache?
> 
> Traditionally people use memcached for this.
> 
Why? For performance reasons?

> > For certain reasons in the application logic we cannot use apache's
> > mod_cache.
> What reasons?
> 

Because sometimes the images are dynamically banned (flagged) by users, and
in that case we need to render a special image. The DB query that we use
gives None for the image file path when it's banned. So when the image
status changes, we will need to dynamically purge the file path of the image
that is be cached.  

> Graham

From ccbean at gmail.com  Mon Aug  6 17:44:54 2007
From: ccbean at gmail.com (Colin Bean)
Date: Mon Aug  6 17:45:03 2007
Subject: [mod_python] Session class or Memcache to reduce load?
In-Reply-To: <00fd01c7d86b$cd220e90$67662bb0$@com>
References: <002301c7d7ee$5e60f7f0$1b22e7d0$@com>
	<88e286470708060225v37e8a162pfeab4169fce432f1@mail.gmail.com>
	<00fd01c7d86b$cd220e90$67662bb0$@com>
Message-ID: <29a6ca010708061444y6d2f6dd5w6b1800ccf5b437d7@mail.gmail.com>

Hey Alec,

For starters, you should use req.sendfile instead of manually reading
/ sending the file in Python.
I believe you'd still have to set the content type manually, so you'd
still have to determine that.  This looks like it would be an easy
change to implement, and hopefully will help your performance
immediately.

Graham described a potentially faster method here (with the warning
that it's "slightly theoretical" -- I've not tried it, but reading the
thread might be helpful)
http://www.modpython.org/pipermail/mod_python/2007-July/024061.html

-Colin


On 8/6/07, Alec Matusis <matusis@matusis.com> wrote:
>
>
> > -----Original Message-----
> > From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
> > Sent: Monday, August 06, 2007 2:25 AM
> > > Hello, I am sorry if my question is too basic. I would like to reduce
> > the
> > > load on apache 2.0 (on 2.6.9 linux) that is running with prefork MPM.
> > > There are two main things that are causing the load:
> >
> > How do you know that these two things are causing the load?
> >
>
> Because all this apache server (this physical machine) does is serving
> thumbnails.
>
> > > a) Thumbnail images that are requested repeatedly
> >
> > Are you serving up the thumbnails from Python code dynamically or
> > allowing Apache to serve them up form a static file?
>
> Dynamically.
>
> >
> > > b) A simple DB query is necessary to locate an image file after the
> > request.
> > > The result of the query does not change. DB is located on another
> > machine.
> > >
> > > My first question, do we need to cache \thumbnail images at all, or
> > the
> > > file-caching by the OS is sufficient?
> >
> > OS file caching probably will not make much difference. Where one can
> > waste a lot of cycles though is by using Python code to serve up the
> > images. Thus, if Python is involved in serving up the images, how is
> > it being done?
> >
>
> The URI in the client's request contains an image code. Python queries the
> DB (on a separate machine) to convert the URI into the image file location,
> and then uses
>
>         f =  open(file_path)
>         im_data = f.read()
>         f.close()
>
> then it determines image type using PIL
>
>           im = Image.open(file_path)
>           im_type = im.format.lower()
>
> (Image.open() is a lazy operation in PIL, so I think it does not have to do
> much to determine the image format)
> Then python writes the data to the client
>
>         self.req.content_type = 'image/' + im_type
>         self.req.headers_out['Content-Length'] = str(len(im_data))
>         self.dict['bin_data'] = im_data
>
>
> > > Second question, to cache the results of the query, should we use
> > > mod_python's Session class ( wich will use DbmSession since we are
> > using
> > > prefork MPM), or memcache?
> >
> > Traditionally people use memcached for this.
> >
> Why? For performance reasons?
>
> > > For certain reasons in the application logic we cannot use apache's
> > > mod_cache.
> > What reasons?
> >
>
> Because sometimes the images are dynamically banned (flagged) by users, and
> in that case we need to render a special image. The DB query that we use
> gives None for the image file path when it's banned. So when the image
> status changes, we will need to dynamically purge the file path of the image
> that is be cached.
>
> > Graham
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From matusis at matusis.com  Tue Aug  7 03:38:25 2007
From: matusis at matusis.com (Alec Matusis)
Date: Tue Aug  7 03:38:49 2007
Subject: [mod_python] Session class or Memcache to reduce load?
In-Reply-To: <29a6ca010708061444y6d2f6dd5w6b1800ccf5b437d7@mail.gmail.com>
References: <002301c7d7ee$5e60f7f0$1b22e7d0$@com>	
	<88e286470708060225v37e8a162pfeab4169fce432f1@mail.gmail.com>	
	<00fd01c7d86b$cd220e90$67662bb0$@com>
	<29a6ca010708061444y6d2f6dd5w6b1800ccf5b437d7@mail.gmail.com>
Message-ID: <003e01c7d8c5$f0f14890$d2d3d9b0$@com>

Hi Colin, thanks for the tip.

I converted to req.sendfile, and then we run into issues with browser
caching of these thumbnail images.

When I use req.sendfile, is there a way to retrieve the last modification
time of the image file automatically (without using os.stat(image_path)) and
send it to the client in Last-Modified header?

It looks like I would have to do this additional os.stat(image_path) per
thumbnail retrieval to make correct use of If-Modified-Since client header
to keep the browser cache current.

Alec.

> -----Original Message-----
> From: Colin Bean [mailto:ccbean@gmail.com]
> Sent: Monday, August 06, 2007 2:45 PM
> To: Alec Matusis
> Cc: mod_python@modpython.org
> Subject: Re: [mod_python] Session class or Memcache to reduce load?
> 
> Hey Alec,
> 
> For starters, you should use req.sendfile instead of manually reading
> / sending the file in Python.
> I believe you'd still have to set the content type manually, so you'd
> still have to determine that.  This looks like it would be an easy
> change to implement, and hopefully will help your performance
> immediately.
> 
> Graham described a potentially faster method here (with the warning
> that it's "slightly theoretical" -- I've not tried it, but reading the
> thread might be helpful)
> http://www.modpython.org/pipermail/mod_python/2007-July/024061.html
> 
> -Colin
> 
> 
> On 8/6/07, Alec Matusis <matusis@matusis.com> wrote:
> >
> >
> > > -----Original Message-----
> > > From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
> > > Sent: Monday, August 06, 2007 2:25 AM
> > > > Hello, I am sorry if my question is too basic. I would like to
> reduce
> > > the
> > > > load on apache 2.0 (on 2.6.9 linux) that is running with prefork
> MPM.
> > > > There are two main things that are causing the load:
> > >
> > > How do you know that these two things are causing the load?
> > >
> >
> > Because all this apache server (this physical machine) does is
> serving
> > thumbnails.
> >
> > > > a) Thumbnail images that are requested repeatedly
> > >
> > > Are you serving up the thumbnails from Python code dynamically or
> > > allowing Apache to serve them up form a static file?
> >
> > Dynamically.
> >
> > >
> > > > b) A simple DB query is necessary to locate an image file after
> the
> > > request.
> > > > The result of the query does not change. DB is located on another
> > > machine.
> > > >
> > > > My first question, do we need to cache \thumbnail images at all,
> or
> > > the
> > > > file-caching by the OS is sufficient?
> > >
> > > OS file caching probably will not make much difference. Where one
> can
> > > waste a lot of cycles though is by using Python code to serve up
> the
> > > images. Thus, if Python is involved in serving up the images, how
> is
> > > it being done?
> > >
> >
> > The URI in the client's request contains an image code. Python
> queries the
> > DB (on a separate machine) to convert the URI into the image file
> location,
> > and then uses
> >
> >         f =  open(file_path)
> >         im_data = f.read()
> >         f.close()
> >
> > then it determines image type using PIL
> >
> >           im = Image.open(file_path)
> >           im_type = im.format.lower()
> >
> > (Image.open() is a lazy operation in PIL, so I think it does not have
> to do
> > much to determine the image format)
> > Then python writes the data to the client
> >
> >         self.req.content_type = 'image/' + im_type
> >         self.req.headers_out['Content-Length'] = str(len(im_data))
> >         self.dict['bin_data'] = im_data
> >
> >
> > > > Second question, to cache the results of the query, should we use
> > > > mod_python's Session class ( wich will use DbmSession since we
> are
> > > using
> > > > prefork MPM), or memcache?
> > >
> > > Traditionally people use memcached for this.
> > >
> > Why? For performance reasons?
> >
> > > > For certain reasons in the application logic we cannot use
> apache's
> > > > mod_cache.
> > > What reasons?
> > >
> >
> > Because sometimes the images are dynamically banned (flagged) by
> users, and
> > in that case we need to render a special image. The DB query that we
> use
> > gives None for the image file path when it's banned. So when the
> image
> > status changes, we will need to dynamically purge the file path of
> the image
> > that is be cached.
> >
> > > Graham
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >

From graham.dumpleton at gmail.com  Tue Aug  7 04:42:12 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Aug  7 04:42:24 2007
Subject: [mod_python] Session class or Memcache to reduce load?
In-Reply-To: <003e01c7d8c5$f0f14890$d2d3d9b0$@com>
References: <002301c7d7ee$5e60f7f0$1b22e7d0$@com>
	<88e286470708060225v37e8a162pfeab4169fce432f1@mail.gmail.com>
	<00fd01c7d86b$cd220e90$67662bb0$@com>
	<29a6ca010708061444y6d2f6dd5w6b1800ccf5b437d7@mail.gmail.com>
	<003e01c7d8c5$f0f14890$d2d3d9b0$@com>
Message-ID: <88e286470708070142u2a6d20b5w3a613ce8440e2def@mail.gmail.com>

On 07/08/07, Alec Matusis <matusis@matusis.com> wrote:
> Hi Colin, thanks for the tip.
>
> I converted to req.sendfile, and then we run into issues with browser
> caching of these thumbnail images.

The problem may be that if you URL actually matches to a physical file
which is the handler, then Apache may be using attributes of that
handler file in response headers.

If you are having issues with caching occurring when you don't want it
to happen, set:

  req.no_cache = 1

This should cause Apache to set appropriate headers to prevent caching
by intermediaries or browser.

> When I use req.sendfile, is there a way to retrieve the last modification
> time of the image file automatically (without using os.stat(image_path))

No way of avoiding the stat() call when using req.sendfile().

> and
> send it to the client in Last-Modified header?

In preference to setting header directly, see req.update_mtime() and
req.set_last_modified(). Also look at req.meets_conditions() in case
it is useful. These methods just reflect Apache API versions, ie.,
ap_update_mtime(), ap_set_last_modified() and ap_meets_condition(), so
you may have to try and find some documentation on Apache itself to
work out how to use them though, as mod_python documentation is pretty
sparse in that respect. All the same, make sure you look through:

  http://www.modpython.org/live/current/doc-html/pyapi-mprequest.html

> It looks like I would have to do this additional os.stat(image_path) per
> thumbnail retrieval to make correct use of If-Modified-Since client header
> to keep the browser cache current.

The past mailing list post that was referenced in respect of setting
req.filename, req.finfo and return apache.DECLINED, should allow
Apache to do a lot of this stuff for you. So perhaps give it a try and
see what it does.

Graham

> > -----Original Message-----
> > From: Colin Bean [mailto:ccbean@gmail.com]
> > Sent: Monday, August 06, 2007 2:45 PM
> > To: Alec Matusis
> > Cc: mod_python@modpython.org
> > Subject: Re: [mod_python] Session class or Memcache to reduce load?
> >
> > Hey Alec,
> >
> > For starters, you should use req.sendfile instead of manually reading
> > / sending the file in Python.
> > I believe you'd still have to set the content type manually, so you'd
> > still have to determine that.  This looks like it would be an easy
> > change to implement, and hopefully will help your performance
> > immediately.
> >
> > Graham described a potentially faster method here (with the warning
> > that it's "slightly theoretical" -- I've not tried it, but reading the
> > thread might be helpful)
> > http://www.modpython.org/pipermail/mod_python/2007-July/024061.html
> >
> > -Colin
> >
> >
> > On 8/6/07, Alec Matusis <matusis@matusis.com> wrote:
> > >
> > >
> > > > -----Original Message-----
> > > > From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
> > > > Sent: Monday, August 06, 2007 2:25 AM
> > > > > Hello, I am sorry if my question is too basic. I would like to
> > reduce
> > > > the
> > > > > load on apache 2.0 (on 2.6.9 linux) that is running with prefork
> > MPM.
> > > > > There are two main things that are causing the load:
> > > >
> > > > How do you know that these two things are causing the load?
> > > >
> > >
> > > Because all this apache server (this physical machine) does is
> > serving
> > > thumbnails.
> > >
> > > > > a) Thumbnail images that are requested repeatedly
> > > >
> > > > Are you serving up the thumbnails from Python code dynamically or
> > > > allowing Apache to serve them up form a static file?
> > >
> > > Dynamically.
> > >
> > > >
> > > > > b) A simple DB query is necessary to locate an image file after
> > the
> > > > request.
> > > > > The result of the query does not change. DB is located on another
> > > > machine.
> > > > >
> > > > > My first question, do we need to cache \thumbnail images at all,
> > or
> > > > the
> > > > > file-caching by the OS is sufficient?
> > > >
> > > > OS file caching probably will not make much difference. Where one
> > can
> > > > waste a lot of cycles though is by using Python code to serve up
> > the
> > > > images. Thus, if Python is involved in serving up the images, how
> > is
> > > > it being done?
> > > >
> > >
> > > The URI in the client's request contains an image code. Python
> > queries the
> > > DB (on a separate machine) to convert the URI into the image file
> > location,
> > > and then uses
> > >
> > >         f =  open(file_path)
> > >         im_data = f.read()
> > >         f.close()
> > >
> > > then it determines image type using PIL
> > >
> > >           im = Image.open(file_path)
> > >           im_type = im.format.lower()
> > >
> > > (Image.open() is a lazy operation in PIL, so I think it does not have
> > to do
> > > much to determine the image format)
> > > Then python writes the data to the client
> > >
> > >         self.req.content_type = 'image/' + im_type
> > >         self.req.headers_out['Content-Length'] = str(len(im_data))
> > >         self.dict['bin_data'] = im_data
> > >
> > >
> > > > > Second question, to cache the results of the query, should we use
> > > > > mod_python's Session class ( wich will use DbmSession since we
> > are
> > > > using
> > > > > prefork MPM), or memcache?
> > > >
> > > > Traditionally people use memcached for this.
> > > >
> > > Why? For performance reasons?
> > >
> > > > > For certain reasons in the application logic we cannot use
> > apache's
> > > > > mod_cache.
> > > > What reasons?
> > > >
> > >
> > > Because sometimes the images are dynamically banned (flagged) by
> > users, and
> > > in that case we need to render a special image. The DB query that we
> > use
> > > gives None for the image file path when it's banned. So when the
> > image
> > > status changes, we will need to dynamically purge the file path of
> > the image
> > > that is be cached.
> > >
> > > > Graham
> > >
> > > _______________________________________________
> > > Mod_python mailing list
> > > Mod_python@modpython.org
> > > http://mailman.modpython.org/mailman/listinfo/mod_python
> > >
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From nlv11281 at natlab.research.philips.com  Tue Aug  7 05:07:43 2007
From: nlv11281 at natlab.research.philips.com (Mike Looijmans)
Date: Tue Aug  7 05:07:59 2007
Subject: [mod_python] Session class or Memcache to reduce load?
In-Reply-To: <003e01c7d8c5$f0f14890$d2d3d9b0$@com>
References: <002301c7d7ee$5e60f7f0$1b22e7d0$@com>		<88e286470708060225v37e8a162pfeab4169fce432f1@mail.gmail.com>		<00fd01c7d86b$cd220e90$67662bb0$@com>	<29a6ca010708061444y6d2f6dd5w6b1800ccf5b437d7@mail.gmail.com>
	<003e01c7d8c5$f0f14890$d2d3d9b0$@com>
Message-ID: <46B8365F.2010002@natlab.research.philips.com>

Instead of trying to "fix" apache and creating yet more workarounds for other workarounds, work 
together with the client's browser.

The last-modified header should be derived from your database data, not from the thumbnail file. 
 From your description, i understand that the thumbnails never change, but the database does change 
parameters for a thumbnail. (even if thumbnails do change, just change the filename when updating it 
instead of simply replacing the contents to enforce that thumbnail files never change)

Store a last-modified date/time in the DB for the particular item. Then, when a request comes in 
from the client:
- Get the associated last-modified date from the database.
- Get the "if-modified-since" header that the client sent.
- If the date matches, just send back a "304 Not Modified" response. You're done.
- Otherwise, send the image data and be sure to add the Last-Modified header you got from the DB.

This will allow the data to be cached on the client's machine, which is much more efficient. It will 
also allow you to change to another image (with the same URL) without the need of a "purge" function.

Don't try to cache the file contents. The OS will probably do a better job at that. (For example, 
MySQL relies completely on the OS for any file caching and only caches index data)

Note that if you know in advance that the thumbnail will not change for some time, you can add an 
"Expires" header to the outgoing data. This will cause the client not to request an update until 
that date arrives (and you can still use the last-modified system in that case).


Mike Looijmans
Philips Natlab / Topic Automation


Alec Matusis wrote:
> Hi Colin, thanks for the tip.
> 
> I converted to req.sendfile, and then we run into issues with browser
> caching of these thumbnail images.
> 
> When I use req.sendfile, is there a way to retrieve the last modification
> time of the image file automatically (without using os.stat(image_path)) and
> send it to the client in Last-Modified header?
> 
> It looks like I would have to do this additional os.stat(image_path) per
> thumbnail retrieval to make correct use of If-Modified-Since client header
> to keep the browser cache current.
> 
> Alec.
> 
>> -----Original Message-----
>> From: Colin Bean [mailto:ccbean@gmail.com]
>> Sent: Monday, August 06, 2007 2:45 PM
>> To: Alec Matusis
>> Cc: mod_python@modpython.org
>> Subject: Re: [mod_python] Session class or Memcache to reduce load?
>>
>> Hey Alec,
>>
>> For starters, you should use req.sendfile instead of manually reading
>> / sending the file in Python.
>> I believe you'd still have to set the content type manually, so you'd
>> still have to determine that.  This looks like it would be an easy
>> change to implement, and hopefully will help your performance
>> immediately.
>>
>> Graham described a potentially faster method here (with the warning
>> that it's "slightly theoretical" -- I've not tried it, but reading the
>> thread might be helpful)
>> http://www.modpython.org/pipermail/mod_python/2007-July/024061.html
>>
>> -Colin
>>
>>
>> On 8/6/07, Alec Matusis <matusis@matusis.com> wrote:
>>>
>>>> -----Original Message-----
>>>> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
>>>> Sent: Monday, August 06, 2007 2:25 AM
>>>>> Hello, I am sorry if my question is too basic. I would like to
>> reduce
>>>> the
>>>>> load on apache 2.0 (on 2.6.9 linux) that is running with prefork
>> MPM.
>>>>> There are two main things that are causing the load:
>>>> How do you know that these two things are causing the load?
>>>>
>>> Because all this apache server (this physical machine) does is
>> serving
>>> thumbnails.
>>>
>>>>> a) Thumbnail images that are requested repeatedly
>>>> Are you serving up the thumbnails from Python code dynamically or
>>>> allowing Apache to serve them up form a static file?
>>> Dynamically.
>>>
>>>>> b) A simple DB query is necessary to locate an image file after
>> the
>>>> request.
>>>>> The result of the query does not change. DB is located on another
>>>> machine.
>>>>> My first question, do we need to cache \thumbnail images at all,
>> or
>>>> the
>>>>> file-caching by the OS is sufficient?
>>>> OS file caching probably will not make much difference. Where one
>> can
>>>> waste a lot of cycles though is by using Python code to serve up
>> the
>>>> images. Thus, if Python is involved in serving up the images, how
>> is
>>>> it being done?
>>>>
>>> The URI in the client's request contains an image code. Python
>> queries the
>>> DB (on a separate machine) to convert the URI into the image file
>> location,
>>> and then uses
>>>
>>>         f =  open(file_path)
>>>         im_data = f.read()
>>>         f.close()
>>>
>>> then it determines image type using PIL
>>>
>>>           im = Image.open(file_path)
>>>           im_type = im.format.lower()
>>>
>>> (Image.open() is a lazy operation in PIL, so I think it does not have
>> to do
>>> much to determine the image format)
>>> Then python writes the data to the client
>>>
>>>         self.req.content_type = 'image/' + im_type
>>>         self.req.headers_out['Content-Length'] = str(len(im_data))
>>>         self.dict['bin_data'] = im_data
>>>
>>>
>>>>> Second question, to cache the results of the query, should we use
>>>>> mod_python's Session class ( wich will use DbmSession since we
>> are
>>>> using
>>>>> prefork MPM), or memcache?
>>>> Traditionally people use memcached for this.
>>>>
>>> Why? For performance reasons?
>>>
>>>>> For certain reasons in the application logic we cannot use
>> apache's
>>>>> mod_cache.
>>>> What reasons?
>>>>
>>> Because sometimes the images are dynamically banned (flagged) by
>> users, and
>>> in that case we need to render a special image. The DB query that we
>> use
>>> gives None for the image file path when it's banned. So when the
>> image
>>> status changes, we will need to dynamically purge the file path of
>> the image
>>> that is be cached.
>>>
>>>> Graham
>>> _______________________________________________
>>> Mod_python mailing list
>>> Mod_python@modpython.org
>>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>>
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 
> 


From jpg at jgassociates.ca  Wed Aug  8 10:55:19 2007
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Wed Aug  8 10:55:01 2007
Subject: [mod_python] Session class or Memcache to reduce load?
In-Reply-To: <002301c7d7ee$5e60f7f0$1b22e7d0$@com>
References: <002301c7d7ee$5e60f7f0$1b22e7d0$@com>
Message-ID: <46B9D957.7090605@jgassociates.ca>

Other folks have already replied with good advice, but I want to add a 
few comments on session handling.

Alec Matusis wrote:
> Hello, I am sorry if my question is too basic. I would like to reduce the
> load on apache 2.0 (on 2.6.9 linux) that is running with prefork MPM.
> There are two main things that are causing the load:
> 
> a) Thumbnail images that are requested repeatedly 
> b) A simple DB query is necessary to locate an image file after the request.
> The result of the query does not change. DB is located on another machine.
> 
> My first question, do we need to cache \thumbnail images at all, or the
> file-caching by the OS is sufficient?
> 
> Second question, to cache the results of the query, should we use
> mod_python's Session class ( wich will use DbmSession since we are using
> prefork MPM), or memcache?

Using DbmSession may actually increase your load for a couple of 
reasons. For starters access to the database is serialized by a global 
lock which may be a bottleneck.

More seriously, a cleanup of expired sessions is performed after 
approximately 1000 requests per child. During this cleanup the db will 
also be locked. If you have a really large number of  sessions (greater 
than 10,000 for example) the time required for the cleanup will not be 
trivial and the rate at which requests are served may drop 
significantly. I did some benchmarking on this and saw the rate at which 
requests were served drop by 90% in some circumstances (IIRC). If you're 
really interested you can look in the mail archives on the developer's list.

This cleanup side effect was something I noticed when developing the 
FileSession class (introduced in 3.2.7). FileSession has a couple of 
features that avoid the cleanup problems. DbmSession can't be fixed due 
to some limitations of dbm.

If you decide you do need to use sessions make sure you run some 
benchmarks first. If you see a problem then either use FileSession or 
create a backend for a proper relational database where the cleanup can 
be extremely fast.

Jim
From cldwesterhof at gmail.com  Wed Aug  8 11:53:26 2007
From: cldwesterhof at gmail.com (Cecil Westerhof)
Date: Wed Aug  8 11:53:35 2007
Subject: [mod_python] Is mod_python threadsafe?
Message-ID: <bb8b59590708080853i36eec6djc8ef7b894eadb95c@mail.gmail.com>

I understood that mod_php is not threadsafe. Is mod_python threadsafe?

-- 
Cecil Westerhof
From jpg at jgassociates.ca  Wed Aug  8 12:25:56 2007
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Wed Aug  8 12:24:49 2007
Subject: [mod_python] Is mod_python threadsafe?
In-Reply-To: <bb8b59590708080853i36eec6djc8ef7b894eadb95c@mail.gmail.com>
References: <bb8b59590708080853i36eec6djc8ef7b894eadb95c@mail.gmail.com>
Message-ID: <46B9EE94.5090706@jgassociates.ca>

Cecil Westerhof wrote:
> I understood that mod_php is not threadsafe. Is mod_python threadsafe?
> 

Yes.

Jim
From graham.dumpleton at gmail.com  Wed Aug  8 16:55:43 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Aug  8 16:55:57 2007
Subject: [mod_python] Is mod_python threadsafe?
In-Reply-To: <46B9EE94.5090706@jgassociates.ca>
References: <bb8b59590708080853i36eec6djc8ef7b894eadb95c@mail.gmail.com>
	<46B9EE94.5090706@jgassociates.ca>
Message-ID: <88e286470708081355o5ed8d17cla80ed905a48d23ac@mail.gmail.com>

On 09/08/2007, Jim Gallacher <jpg@jgassociates.ca> wrote:
> Cecil Westerhof wrote:
> > I understood that mod_php is not threadsafe. Is mod_python threadsafe?
> >
>
> Yes.

With the proviso that your own application code must also be written
to be thread safe.

As I understand it these days, the core of PHP implementation is
thread safe. The problem is that not all the third party modules for
PHP are thread safe and that is where the problems arise.

Graham
From matusis at matusis.com  Wed Aug  8 16:58:56 2007
From: matusis at matusis.com (Alec Matusis)
Date: Wed Aug  8 16:59:18 2007
Subject: [mod_python] Session class or Memcache to reduce load?
In-Reply-To: <46B9D957.7090605@jgassociates.ca>
References: <002301c7d7ee$5e60f7f0$1b22e7d0$@com>
	<46B9D957.7090605@jgassociates.ca>
Message-ID: <010201c7d9fe$f02add10$d0809730$@com>

Thanks everybody for responding.
I implemented 
> For starters, you should use req.sendfile instead of manually reading
> / sending the file in Python.

This reduced load average from 13.0 to 10.0

> Using DbmSession may actually increase your load for a couple of
> reasons. For starters access to the database is serialized by a global
> lock which may be a bottleneck.

In this regard, I have another question: should each request open it's own
MySQL connection (the connection to our DB slave servers), or only one
connection should be opened, and passed around between requests using
DbmSession or some other means?

> -----Original Message-----
> From: Jim Gallacher [mailto:jpg@jgassociates.ca]
> Sent: Wednesday, August 08, 2007 7:55 AM
> To: Alec Matusis
> Cc: mod_python@modpython.org
> Subject: Re: [mod_python] Session class or Memcache to reduce load?
> 
> Other folks have already replied with good advice, but I want to add a
> few comments on session handling.
> 
> Alec Matusis wrote:
> > Hello, I am sorry if my question is too basic. I would like to reduce
> the
> > load on apache 2.0 (on 2.6.9 linux) that is running with prefork MPM.
> > There are two main things that are causing the load:
> >
> > a) Thumbnail images that are requested repeatedly
> > b) A simple DB query is necessary to locate an image file after the
> request.
> > The result of the query does not change. DB is located on another
> machine.
> >
> > My first question, do we need to cache \thumbnail images at all, or
> the
> > file-caching by the OS is sufficient?
> >
> > Second question, to cache the results of the query, should we use
> > mod_python's Session class ( wich will use DbmSession since we are
> using
> > prefork MPM), or memcache?
> 
> Using DbmSession may actually increase your load for a couple of
> reasons. For starters access to the database is serialized by a global
> lock which may be a bottleneck.
> 
> More seriously, a cleanup of expired sessions is performed after
> approximately 1000 requests per child. During this cleanup the db will
> also be locked. If you have a really large number of  sessions (greater
> than 10,000 for example) the time required for the cleanup will not be
> trivial and the rate at which requests are served may drop
> significantly. I did some benchmarking on this and saw the rate at
> which
> requests were served drop by 90% in some circumstances (IIRC). If
> you're
> really interested you can look in the mail archives on the developer's
> list.
> 
> This cleanup side effect was something I noticed when developing the
> FileSession class (introduced in 3.2.7). FileSession has a couple of
> features that avoid the cleanup problems. DbmSession can't be fixed due
> to some limitations of dbm.
> 
> If you decide you do need to use sessions make sure you run some
> benchmarks first. If you see a problem then either use FileSession or
> create a backend for a proper relational database where the cleanup can
> be extremely fast.
> 
> Jim

From jpg at jgassociates.ca  Wed Aug  8 18:37:06 2007
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Wed Aug  8 18:32:56 2007
Subject: [mod_python] Session class or Memcache to reduce load?
In-Reply-To: <010201c7d9fe$f02add10$d0809730$@com>
References: <002301c7d7ee$5e60f7f0$1b22e7d0$@com>	<46B9D957.7090605@jgassociates.ca>
	<010201c7d9fe$f02add10$d0809730$@com>
Message-ID: <46BA4592.502@jgassociates.ca>

Alec Matusis wrote:
> Thanks everybody for responding.
> I implemented 
>> For starters, you should use req.sendfile instead of manually reading
>> / sending the file in Python.
> 
> This reduced load average from 13.0 to 10.0

I can see why you might want to speed things up! :)

>> Using DbmSession may actually increase your load for a couple of
>> reasons. For starters access to the database is serialized by a global
>> lock which may be a bottleneck.
> 
> In this regard, I have another question: should each request open it's own
> MySQL connection (the connection to our DB slave servers), or only one
> connection should be opened, and passed around between requests using
> DbmSession or some other means?

DbmSession won't get you anywhere here as you can't pickle the 
connection object. Even if you could the connection would still need to 
be re-established when the pickle is loaded so you are no further ahead. 
Furthermore the overhead of reading + un-pickling is likely greater than 
just opening and closing your DB connection anyway, so unless you are 
already using session handling you could end up with lower performance. 
Establishing a MySQL connection is pretty fast although this may not be 
the case for other databases.

Connection pooling or caching has been discussed on the list in the 
past. You might want to dig through the mail archives. Just be aware 
that when using the prefork-mpm each child will get it's own MySQL 
connection. If you are under heavy load and alot of children get spawned 
you could end up hitting a MySQL resource limit for the number of 
connections. This would be bad. ;)

Connection pooling would be more effective with the worker or threaded 
mpms, where the number of children are limited. Threads in the same 
child process can draw from the same pool so it's possible to actually 
manage the pool.

Are you currently using DbmSession? How many concurrent requests? What 
version of mod_python you are using? Let me know and I'll pass along 
some ideas for optimizing session handling.

Jim
From matusis at matusis.com  Wed Aug  8 20:18:21 2007
From: matusis at matusis.com (Alec Matusis)
Date: Wed Aug  8 20:18:45 2007
Subject: [mod_python] Session class or Memcache to reduce load?
In-Reply-To: <46BA4592.502@jgassociates.ca>
References: <002301c7d7ee$5e60f7f0$1b22e7d0$@com>	<46B9D957.7090605@jgassociates.ca>
	<010201c7d9fe$f02add10$d0809730$@com>
	<46BA4592.502@jgassociates.ca>
Message-ID: <003f01c7da1a$cbe58510$63b08f30$@com>

> Are you currently using DbmSession? 

No, we don't.

> How many concurrent requests? 

This is the output of /server-status (not at the peak load. At peak it can
be up to 120-130)

96.3 requests/sec - 363.1 kB/second - 3862 B/request 
60 requests currently being processed, 21 idle workers 

C.RW.CW__.C_RCWCCC__CCCWCWC_CCW_CC_CCC_C_C.CCC__WCRCCC._CCR..WW_
.__WCCC.CCC.CC....R....._.W......C..............._....C.........
....C....RC...._._..........._W.................................
................................................................

This is what we have in httpd.conf:

<IfModule prefork.c>
StartServers          10
MinSpareServers       5
MaxSpareServers       10
MaxClients            180
MaxRequestsPerChild   10000
MaxMemFree      2048
</IfModule>


> What version of mod_python you are using? 

Server Version: Apache/2.0.54 (Unix) mod_python/3.1.4 Python/2.4.1
We are planning an upgrade to Apache 2.2 and the latest mod_python very
soon.

> Let me know and I'll pass along
> some ideas for optimizing session handling.

Thank you.

> -----Original Message-----
> From: Jim Gallacher [mailto:jpg@jgassociates.ca]
> Sent: Wednesday, August 08, 2007 3:37 PM
> To: Alec Matusis
> Cc: mod_python@modpython.org
> Subject: Re: [mod_python] Session class or Memcache to reduce load?
> 
> Alec Matusis wrote:
> > Thanks everybody for responding.
> > I implemented
> >> For starters, you should use req.sendfile instead of manually
> reading
> >> / sending the file in Python.
> >
> > This reduced load average from 13.0 to 10.0
> 
> I can see why you might want to speed things up! :)
> 
> >> Using DbmSession may actually increase your load for a couple of
> >> reasons. For starters access to the database is serialized by a
> global
> >> lock which may be a bottleneck.
> >
> > In this regard, I have another question: should each request open
> it's own
> > MySQL connection (the connection to our DB slave servers), or only
> one
> > connection should be opened, and passed around between requests using
> > DbmSession or some other means?
> 
> DbmSession won't get you anywhere here as you can't pickle the
> connection object. Even if you could the connection would still need to
> be re-established when the pickle is loaded so you are no further
> ahead.
> Furthermore the overhead of reading + un-pickling is likely greater
> than
> just opening and closing your DB connection anyway, so unless you are
> already using session handling you could end up with lower performance.
> Establishing a MySQL connection is pretty fast although this may not be
> the case for other databases.
> 
> Connection pooling or caching has been discussed on the list in the
> past. You might want to dig through the mail archives. Just be aware
> that when using the prefork-mpm each child will get it's own MySQL
> connection. If you are under heavy load and alot of children get
> spawned
> you could end up hitting a MySQL resource limit for the number of
> connections. This would be bad. ;)
> 
> Connection pooling would be more effective with the worker or threaded
> mpms, where the number of children are limited. Threads in the same
> child process can draw from the same pool so it's possible to actually
> manage the pool.
> 
> Are you currently using DbmSession? How many concurrent requests? What
> version of mod_python you are using? Let me know and I'll pass along
> some ideas for optimizing session handling.
> 
> Jim

From nlv11281 at natlab.research.philips.com  Thu Aug  9 01:34:35 2007
From: nlv11281 at natlab.research.philips.com (Mike Looijmans)
Date: Thu Aug  9 01:34:54 2007
Subject: [mod_python] Session class or Memcache to reduce load?
In-Reply-To: <010201c7d9fe$f02add10$d0809730$@com>
References: <002301c7d7ee$5e60f7f0$1b22e7d0$@com>	<46B9D957.7090605@jgassociates.ca>
	<010201c7d9fe$f02add10$d0809730$@com>
Message-ID: <46BAA76B.50908@natlab.research.philips.com>

 > In this regard, I have another question: should each request open it's own
 > MySQL connection (the connection to our DB slave servers), or only one
 > connection should be opened, and passed around between requests using
 > DbmSession or some other means?

I tried benchmarking my connection pool against setting up a connection for each and every request. 
I found that I could not prove any improvement in speed for MySQL 3 or 4, so I would not start on 
that path. MySQL can handle hundreds of connections just fine. Just set up the database to accept 
many connections.

Set up MySQL to use unix sockets (or named pipes on Windows) and preferably switch off TCP/IP 
completely in MySQL if the DB and web services run on the same machine. Also, if the database plays 
a significant role, configure MySQL to use more resources than what it allocates by default. For 
some statistics crunching DB tasks, I assigned half the machine's RAM as index buffer.

Switching on MySQL's query cache is also very useful if you are likely to run the exact same query 
multiple times. This happens for example if you check user access rights or session data in the DB.

With MySQL, if your machine cannot handle the load, add another machine and use replication. You can 
do the same for your web server, by the way.


Mike Looijmans
Philips Natlab / Topic Automation



From andrewr at collab.net  Mon Aug 13 19:38:21 2007
From: andrewr at collab.net (Andrew Ryan)
Date: Mon Aug 13 19:38:36 2007
Subject: [mod_python] Traceback in FilterDispatch
Message-ID: <5AF7C646667D3B449012D7F80FF5A0E90170ACB9@SP-EXCHMBC.sp.corp.collab.net>

Hi,

I've seen the following traceback -- rarely -- from mod_python in my
logs. I haven't heard of any user-reported issues with the script that's
generating it, and I can't duplicate this problem myself. My only guess
is that it's something related to a connection getting reset during some
phase of the output filter that this code is running in.

 Traceback (most recent call last):
   File "/usr/lib/python2.4/site-packages/mod_python/importer.py", line
1389, in FilterDispatch
filter.flush(),
   IOError: Flush failed.

The offending code is in FilterDispatch:
            if not filter.closed:
                filter.flush()

I'm not sure what the "right" thing to do, this might just be a
try/"except pass" moment. This is with 3.3.1 and 2.4.3.

--andrew

From graham.dumpleton at gmail.com  Mon Aug 13 19:55:05 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Aug 13 19:55:14 2007
Subject: [mod_python] Traceback in FilterDispatch
In-Reply-To: <5AF7C646667D3B449012D7F80FF5A0E90170ACB9@SP-EXCHMBC.sp.corp.collab.net>
References: <5AF7C646667D3B449012D7F80FF5A0E90170ACB9@SP-EXCHMBC.sp.corp.collab.net>
Message-ID: <88e286470708131655m1f8e5848ma30ee83bbd385cbb@mail.gmail.com>

On 14/08/07, Andrew Ryan <andrewr@collab.net> wrote:
> Hi,
>
> I've seen the following traceback -- rarely -- from mod_python in my
> logs. I haven't heard of any user-reported issues with the script that's
> generating it, and I can't duplicate this problem myself. My only guess
> is that it's something related to a connection getting reset during some
> phase of the output filter that this code is running in.
>
>  Traceback (most recent call last):
>    File "/usr/lib/python2.4/site-packages/mod_python/importer.py", line
> 1389, in FilterDispatch
> filter.flush(),
>    IOError: Flush failed.
>
> The offending code is in FilterDispatch:
>             if not filter.closed:
>                 filter.flush()
>
> I'm not sure what the "right" thing to do, this might just be a
> try/"except pass" moment. This is with 3.3.1 and 2.4.3.

Would feasibly occur when the remote client (web browser) closed the
connection before response had been completely received.

Generally relatively easy to simulate by hitting reload button on
browser constantly without waiting for page to complete.

Graham
From jagge_90 at hotmail.com  Wed Aug 15 13:49:15 2007
From: jagge_90 at hotmail.com (Jacob Carlsson)
Date: Wed Aug 15 13:49:33 2007
Subject: [mod_python] Apache wont load/start...
Message-ID: <BAY129-F38ED57D28A3DEFC5AE675CF7DE0@phx.gbl>

Hello!

Im using Windows XP.

I have tried to get apache (both 2.2.4 and 2.0.59 to work with mod_python). 
I have python 2.4 and I have tried using 
"mod_python-3.2.10.win32-py2.4-apache2.2" & 
"mod_python-3.3.1.win32-py2.4-Apache2.2" and also some other different 
versions when I tested with apache 2.0.59.

My problem is that apache simply wont load when i enter "LoadModule 
python_module modules/mod_python.so" in httpd.conf.
Now I have tried fixing this in many various ways for hours and not succeded 
at all.
For example I have searched google and your page for answers and i found out 
that some people had the same problem as I but some of their solutions didnt 
work out for me.
For example I tried adding python to my "PATH" variable but that didnt help 
much.. Maybe i did it incorrect? I added "C:\Python24" (thats simply where I 
installed python)
Also many that have the same problem didnt get an answer that i could read.

So i would appreciate any help so i finally can solve this really annoying 
problem!

Best Regards Jacob Carlsson

_________________________________________________________________
Luspank? Tj?na pengar p? auktion http://tradera.msn.se/

From ccbean at gmail.com  Wed Aug 15 14:08:19 2007
From: ccbean at gmail.com (Colin Bean)
Date: Wed Aug 15 14:08:29 2007
Subject: [mod_python] Apache wont load/start...
In-Reply-To: <BAY129-F38ED57D28A3DEFC5AE675CF7DE0@phx.gbl>
References: <BAY129-F38ED57D28A3DEFC5AE675CF7DE0@phx.gbl>
Message-ID: <29a6ca010708151108l6f83417dn6389e47e117a71e3@mail.gmail.com>

Please post the contents from your Apache error log when you try to
start the server, can't really tell what the problem is from the
information you've given.

On 8/15/07, Jacob Carlsson <jagge_90@hotmail.com> wrote:
> Hello!
>
> Im using Windows XP.
>
> I have tried to get apache (both 2.2.4 and 2.0.59 to work with mod_python).
> I have python 2.4 and I have tried using
> "mod_python-3.2.10.win32-py2.4-apache2.2" &
> "mod_python-3.3.1.win32-py2.4-Apache2.2" and also some other different
> versions when I tested with apache 2.0.59.
>
> My problem is that apache simply wont load when i enter "LoadModule
> python_module modules/mod_python.so" in httpd.conf.
> Now I have tried fixing this in many various ways for hours and not succeded
> at all.
> For example I have searched google and your page for answers and i found out
> that some people had the same problem as I but some of their solutions didnt
> work out for me.
> For example I tried adding python to my "PATH" variable but that didnt help
> much.. Maybe i did it incorrect? I added "C:\Python24" (thats simply where I
> installed python)
> Also many that have the same problem didnt get an answer that i could read.
>
> So i would appreciate any help so i finally can solve this really annoying
> problem!
>
> Best Regards Jacob Carlsson
>
> _________________________________________________________________
> Luspank? Tj?na pengar p? auktion http://tradera.msn.se/
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From ccbean at gmail.com  Wed Aug 15 16:35:21 2007
From: ccbean at gmail.com (Colin Bean)
Date: Wed Aug 15 16:35:34 2007
Subject: [mod_python] Apache wont load/start...
In-Reply-To: <BAY129-F226C4B3BD8C739C4A8E82CF7DE0@phx.gbl>
References: <29a6ca010708151108l6f83417dn6389e47e117a71e3@mail.gmail.com>
	<BAY129-F226C4B3BD8C739C4A8E82CF7DE0@phx.gbl>
Message-ID: <29a6ca010708151335p3c6d26e0sba4ce476ece76bcc@mail.gmail.com>

Try following the links from this message, they seem to address the
same problem:

http://www.modpython.org/pipermail/mod_python/2007-June/023861.html

Past that I'm probably not going to be of much help as I don't use
mod_python on windows...
Just to clarify, you are using the installer compiled for apache
2.0.x, correct?  I'm guessing so, as I doubt you would have gotten
this far otherwise.

Take care,
Colin

On 8/15/07, Jacob Carlsson <jagge_90@hotmail.com> wrote:
> Hey!
>
> Thank you for your fast answer!
>
> There was no errors in the log. Thats why it was so weird. While i waited
> for an answer i downgraded my apache to 2.0.59 again and entered my python
> installation path in the PATH variable. And when i restarted my computer it
> started up fine despite i had entered "LoadModule python_module ...". But
> still it dont work and gives me alot of errors. I'll post my log:
>
>
>
> [Wed Aug 15 21:00:47 2007] [notice] Apache/2.0.59 (Win32) DAV/2 SVN/1.4.4
> configured -- resuming normal operations
> [Wed Aug 15 21:00:47 2007] [notice] Server built: Jul 27 2006 15:55:03
> [Wed Aug 15 21:00:47 2007] [notice] Parent: Created child process 4852
> [Wed Aug 15 21:00:48 2007] [error] python_init: Python version mismatch,
> expected '2.4.3', found '2.4.4'.
> [Wed Aug 15 21:00:48 2007] [error] python_init: Python executable found
> 'H:\\install\\Apache2\\bin\\Apache.exe'.
> [Wed Aug 15 21:00:48 2007] [error] python_init: Python path being used
> 'H:\\install\\Python24\\python24.zip;.\\DLLs;.\\lib;.\\lib\\plat-win;.\\lib\\lib-tk;H:\\install\\Apache2\\bin'.
> [Wed Aug 15 21:00:48 2007] [notice] mod_python: Creating 8 session mutexes
> based on 0 max processes and 250 max threads.
> [Wed Aug 15 21:00:48 2007] [notice] Child 4852: Child process is running
> [Wed Aug 15 21:00:48 2007] [notice] Child 4852: Acquired the start mutex.
> [Wed Aug 15 21:00:48 2007] [notice] Child 4852: Starting 250 worker threads.
> [Wed Aug 15 21:00:51 2007] [error] make_obcallback: could not import
> mod_python.apache.\n
> [Wed Aug 15 21:00:51 2007] [error] make_obcallback: Python path being used
> "['H:\\\\install\\\\Python24\\\\python24.zip', '.\\\\DLLs', '.\\\\lib',
> '.\\\\lib\\\\plat-win', '.\\\\lib\\\\lib-tk',
> 'H:\\\\install\\\\Apache2\\\\bin']".
> [Wed Aug 15 21:00:51 2007] [error] get_interpreter: no interpreter callback
> found.
> [Wed Aug 15 21:00:51 2007] [error] [client 127.0.0.1] python_handler: Can't
> get/create interpreter.
>
>
> These last errors comes when i try accessing the following:
>
> <Location /mpinfo>
>    SetHandler mod_python
>    PythonInterpreter main_interpreter
>    PythonHandler mod_python.testhandler
> </Location>
>
> Like what does it mean with "Python version mismatch, expected '2.4.3',
> found '2.4.4'.", expected 2.4.3? How could it expect something else?
>
> Also i tried entering some more paths into the PATH variable like
> "Lib,lib-tk,DLLs" but it doesent seem enough...
>
> Best Regards Jacob Carlsson
>
> >From: "Colin Bean" <ccbean@gmail.com>
> >To: "Jacob Carlsson" <jagge_90@hotmail.com>
> >CC: mod_python@modpython.org
> >Subject: Re: [mod_python] Apache wont load/start...
> >Date: Wed, 15 Aug 2007 11:08:19 -0700
> >
> >Please post the contents from your Apache error log when you try to
> >start the server, can't really tell what the problem is from the
> >information you've given.
> >
> >On 8/15/07, Jacob Carlsson <jagge_90@hotmail.com> wrote:
> > > Hello!
> > >
> > > Im using Windows XP.
> > >
> > > I have tried to get apache (both 2.2.4 and 2.0.59 to work with
> >mod_python).
> > > I have python 2.4 and I have tried using
> > > "mod_python-3.2.10.win32-py2.4-apache2.2" &
> > > "mod_python-3.3.1.win32-py2.4-Apache2.2" and also some other different
> > > versions when I tested with apache 2.0.59.
> > >
> > > My problem is that apache simply wont load when i enter "LoadModule
> > > python_module modules/mod_python.so" in httpd.conf.
> > > Now I have tried fixing this in many various ways for hours and not
> >succeded
> > > at all.
> > > For example I have searched google and your page for answers and i found
> >out
> > > that some people had the same problem as I but some of their solutions
> >didnt
> > > work out for me.
> > > For example I tried adding python to my "PATH" variable but that didnt
> >help
> > > much.. Maybe i did it incorrect? I added "C:\Python24" (thats simply
> >where I
> > > installed python)
> > > Also many that have the same problem didnt get an answer that i could
> >read.
> > >
> > > So i would appreciate any help so i finally can solve this really
> >annoying
> > > problem!
> > >
> > > Best Regards Jacob Carlsson
> > >
> > > _________________________________________________________________
> > > Luspank? Tj?na pengar p? auktion http://tradera.msn.se/
> > >
> > > _______________________________________________
> > > Mod_python mailing list
> > > Mod_python@modpython.org
> > > http://mailman.modpython.org/mailman/listinfo/mod_python
> > >
>
> _________________________________________________________________
> Spela roliga Worms'07 i mobilen
> http://msn.cellus.se/?page=game_order&itemId=878908
>
>

From graham.dumpleton at gmail.com  Wed Aug 15 18:19:16 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Aug 15 18:19:30 2007
Subject: [mod_python] Apache wont load/start...
In-Reply-To: <29a6ca010708151335p3c6d26e0sba4ce476ece76bcc@mail.gmail.com>
References: <29a6ca010708151108l6f83417dn6389e47e117a71e3@mail.gmail.com>
	<BAY129-F226C4B3BD8C739C4A8E82CF7DE0@phx.gbl>
	<29a6ca010708151335p3c6d26e0sba4ce476ece76bcc@mail.gmail.com>
Message-ID: <88e286470708151519s4eb38159v8e1218a0385c0047@mail.gmail.com>

On 16/08/07, Colin Bean <ccbean@gmail.com> wrote:
> Try following the links from this message, they seem to address the
> same problem:
>
> http://www.modpython.org/pipermail/mod_python/2007-June/023861.html

Actually, possibly don't pay too much attention to that post about
adding site-packages as it isn't meant to be listed in the registry
entries to begin with. The site-packages directory is only added when
the Python site.py file has been loaded. This was only brought to my
attention recently when working out Windows issues with mod_wsgi.

Thus, if mod_python code modules not being found, more likely to be
that correct site.py file isn't being found at startup. This can occur
because of access permissions on files if Apache is run as a service
and thus a different user. Thus, very important to install
Apache/Python/mod_python as administrator so file permissions are
okay, DLLs are in system directories and so registry entries setup for
machine and not just user.

Problems can also arise where you have installed multiple versions of
Python and the first one found in PATH is not the same version that
mod_python requires. This can occur from installing multiple Python
versions explicitly, or can be done inadvertently as there are now a
number of Windows applications which provide their own copy of Python.
If the Python version from such an application is found in PATH first
it can screw everything up. If this Python version was found first
when installing mod_python, can also mean that mod_python Python code
files were installed in wrong location and not where Python used by
Apache is looking. There can also be a problem where real Python was
installed as administrator and the application version as normal user,
as the application version may put entries in user registry entries
and shadow those for machine.

I stress though what has already been said, it is vitally important to
see what is being logged in the Apache error logs so the reason can be
determined.

As to not seeing solutions to previous posts, it is generally because
people having problems don't explain problems very well and in enough
detail. As a consequence we repeat all the commonly suspected issues,
such as above. The OP somehow then solves his problem and then doesn't
bother responding to say what the problem was and how they fixed it.
As a consequence we never learn anything about what the actual problem
was and are never able to improve our troubleshooting suggestions.

So, please provide details about log messages and help us by feeding
back whatever information seems pertinent and how you may have solved
the problem.

Thanks.

Graham

> Past that I'm probably not going to be of much help as I don't use
> mod_python on windows...
> Just to clarify, you are using the installer compiled for apache
> 2.0.x, correct?  I'm guessing so, as I doubt you would have gotten
> this far otherwise.
>
> Take care,
> Colin
>
> On 8/15/07, Jacob Carlsson <jagge_90@hotmail.com> wrote:
> > Hey!
> >
> > Thank you for your fast answer!
> >
> > There was no errors in the log. Thats why it was so weird. While i waited
> > for an answer i downgraded my apache to 2.0.59 again and entered my python
> > installation path in the PATH variable. And when i restarted my computer it
> > started up fine despite i had entered "LoadModule python_module ...". But
> > still it dont work and gives me alot of errors. I'll post my log:
> >
> >
> >
> > [Wed Aug 15 21:00:47 2007] [notice] Apache/2.0.59 (Win32) DAV/2 SVN/1.4.4
> > configured -- resuming normal operations
> > [Wed Aug 15 21:00:47 2007] [notice] Server built: Jul 27 2006 15:55:03
> > [Wed Aug 15 21:00:47 2007] [notice] Parent: Created child process 4852
> > [Wed Aug 15 21:00:48 2007] [error] python_init: Python version mismatch,
> > expected '2.4.3', found '2.4.4'.
> > [Wed Aug 15 21:00:48 2007] [error] python_init: Python executable found
> > 'H:\\install\\Apache2\\bin\\Apache.exe'.
> > [Wed Aug 15 21:00:48 2007] [error] python_init: Python path being used
> > 'H:\\install\\Python24\\python24.zip;.\\DLLs;.\\lib;.\\lib\\plat-win;.\\lib\\lib-tk;H:\\install\\Apache2\\bin'.
> > [Wed Aug 15 21:00:48 2007] [notice] mod_python: Creating 8 session mutexes
> > based on 0 max processes and 250 max threads.
> > [Wed Aug 15 21:00:48 2007] [notice] Child 4852: Child process is running
> > [Wed Aug 15 21:00:48 2007] [notice] Child 4852: Acquired the start mutex.
> > [Wed Aug 15 21:00:48 2007] [notice] Child 4852: Starting 250 worker threads.
> > [Wed Aug 15 21:00:51 2007] [error] make_obcallback: could not import
> > mod_python.apache.\n
> > [Wed Aug 15 21:00:51 2007] [error] make_obcallback: Python path being used
> > "['H:\\\\install\\\\Python24\\\\python24.zip', '.\\\\DLLs', '.\\\\lib',
> > '.\\\\lib\\\\plat-win', '.\\\\lib\\\\lib-tk',
> > 'H:\\\\install\\\\Apache2\\\\bin']".
> > [Wed Aug 15 21:00:51 2007] [error] get_interpreter: no interpreter callback
> > found.
> > [Wed Aug 15 21:00:51 2007] [error] [client 127.0.0.1] python_handler: Can't
> > get/create interpreter.
> >
> >
> > These last errors comes when i try accessing the following:
> >
> > <Location /mpinfo>
> >    SetHandler mod_python
> >    PythonInterpreter main_interpreter
> >    PythonHandler mod_python.testhandler
> > </Location>
> >
> > Like what does it mean with "Python version mismatch, expected '2.4.3',
> > found '2.4.4'.", expected 2.4.3? How could it expect something else?
> >
> > Also i tried entering some more paths into the PATH variable like
> > "Lib,lib-tk,DLLs" but it doesent seem enough...
> >
> > Best Regards Jacob Carlsson
> >
> > >From: "Colin Bean" <ccbean@gmail.com>
> > >To: "Jacob Carlsson" <jagge_90@hotmail.com>
> > >CC: mod_python@modpython.org
> > >Subject: Re: [mod_python] Apache wont load/start...
> > >Date: Wed, 15 Aug 2007 11:08:19 -0700
> > >
> > >Please post the contents from your Apache error log when you try to
> > >start the server, can't really tell what the problem is from the
> > >information you've given.
> > >
> > >On 8/15/07, Jacob Carlsson <jagge_90@hotmail.com> wrote:
> > > > Hello!
> > > >
> > > > Im using Windows XP.
> > > >
> > > > I have tried to get apache (both 2.2.4 and 2.0.59 to work with
> > >mod_python).
> > > > I have python 2.4 and I have tried using
> > > > "mod_python-3.2.10.win32-py2.4-apache2.2" &
> > > > "mod_python-3.3.1.win32-py2.4-Apache2.2" and also some other different
> > > > versions when I tested with apache 2.0.59.
> > > >
> > > > My problem is that apache simply wont load when i enter "LoadModule
> > > > python_module modules/mod_python.so" in httpd.conf.
> > > > Now I have tried fixing this in many various ways for hours and not
> > >succeded
> > > > at all.
> > > > For example I have searched google and your page for answers and i found
> > >out
> > > > that some people had the same problem as I but some of their solutions
> > >didnt
> > > > work out for me.
> > > > For example I tried adding python to my "PATH" variable but that didnt
> > >help
> > > > much.. Maybe i did it incorrect? I added "C:\Python24" (thats simply
> > >where I
> > > > installed python)
> > > > Also many that have the same problem didnt get an answer that i could
> > >read.
> > > >
> > > > So i would appreciate any help so i finally can solve this really
> > >annoying
> > > > problem!
> > > >
> > > > Best Regards Jacob Carlsson
> > > >
> > > > _________________________________________________________________
> > > > Luspank? Tj?na pengar p? auktion http://tradera.msn.se/
> > > >
> > > > _______________________________________________
> > > > Mod_python mailing list
> > > > Mod_python@modpython.org
> > > > http://mailman.modpython.org/mailman/listinfo/mod_python
> > > >
> >
> > _________________________________________________________________
> > Spela roliga Worms'07 i mobilen
> > http://msn.cellus.se/?page=game_order&itemId=878908
> >
> >
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From jagge_90 at hotmail.com  Thu Aug 16 06:38:58 2007
From: jagge_90 at hotmail.com (Jacob Carlsson)
Date: Thu Aug 16 06:39:23 2007
Subject: [mod_python] Apache wont load/start...
In-Reply-To: <29a6ca010708151335p3c6d26e0sba4ce476ece76bcc@mail.gmail.com>
Message-ID: <BAY129-F306DD684BEE17002FC772FF7DF0@phx.gbl>

Hello!

Okey. Im going to give some more detaild information.

OS: Windows XP SP2
PYTHON: 2.4.4
MOD_PYTHON: mod_python-3.3.1.win32-py2.4-Apache2.0
APACHE: Apache 2.0.59 (yes, its from a installer i didnt compile it myself)
WHY DO I WANT MOD_PYTHON: To install the project management tool Trac

FIRST PROBLEM:
Now i had Apache 2.2, mod_python-3.3.1.win32-py2.4-Apache2.2, python 2.4 
installed.
Everytime i entered "LoadModule python_module modules/mod_python.so" my 
apache wouldnt start. There was no error specified in the apache monitor 
only said "Error", and there was no special error specified in apcahes Error 
log either, not any "couldnt find/load module" or anything.

HOW DID I SOLVE THE FIRST PROBLEM:
I really did not solve it, or maybe? First i couldnt even launch apache 
2.0.59 when adding "LoadModule ...." but then i thought, why not try 
downgrading and make clean install once more and so i did. I unistalled 
apache 2.2 and mod_python installed clean apache 2.0.59 and mod_python, 
restarted my computer and it worked. Now i could load the module without 
apache screaming about a Error. Though i directly ran into next problem but 
at least i got somewhere.
So note that BEFORE i restarted my computer i also added:

Well i simply added some paths to the PATH variable (Right click your "My 
computer" -> Properties -> Advanced -> Enviorment Variables -> find PATH i 
list -> add directorys where python is installed)

I never tried these settings with Apache 2.2 since i didnt understand that 
restarting was needed.
Also maybe this didnt solve my problem, maybe it was something else? And 
thats just exaclty the reason why im staying at 2.0.59 now when i got it 
working instead of going back to 2.2 and getting that error again.

SECOND PROBLEM:
Well, now i got apache 2.0.59, mod_python 3.3.1 read my settings on top of 
the mail for more detaild information about my system as it is now. Now i 
can run apache when LoadModule is uncommented in httpd.conf but i cant use 
python at all. When i add:

<Location /mpinfo>
   SetHandler mod_python
   PythonInterpreter main_interpreter
   PythonHandler mod_python.testhandler
</Location>

and then try to access localhost/mpinfo the server gives me a internal error 
(500).
My Apache error log says:

[Thu Aug 16 12:13:07 2007] [error] make_obcallback: could not import 
mod_python.apache.\n
[Thu Aug 16 12:13:07 2007] [error] make_obcallback: Python path being used 
"['H:\\\\install\\\\Python24\\\\python24.zip', '.\\\\DLLs', '.\\\\lib', 
'.\\\\lib\\\\plat-win', '.\\\\lib\\\\lib-tk', 
'H:\\\\install\\\\Apache2\\\\bin']".
[Thu Aug 16 12:13:07 2007] [error] get_interpreter: no interpreter callback 
found.
[Thu Aug 16 12:13:07 2007] [error] [client 127.0.0.1] python_handler: Can't 
get/create interpreter.

And on STARTUP of the apache it also seems to be a little error:

[Thu Aug 16 11:25:14 2007] [notice] Apache/2.0.59 (Win32) DAV/2 SVN/1.4.4 
configured -- resuming normal operations
[Thu Aug 16 11:25:14 2007] [notice] Server built: Jul 27 2006 15:55:03
[Thu Aug 16 11:25:14 2007] [notice] Parent: Created child process 520
[Thu Aug 16 11:25:14 2007] [error] python_init: Python version mismatch, 
expected '2.4.3', found '2.4.4'.
[Thu Aug 16 11:25:14 2007] [error] python_init: Python executable found 
'H:\\install\\Apache2\\bin\\Apache.exe'.
[Thu Aug 16 11:25:14 2007] [error] python_init: Python path being used 
'H:\\install\\Python24\\python24.zip;.\\DLLs;.\\lib;.\\lib\\plat-win;.\\lib\\lib-tk;H:\\install\\Apache2\\bin'.
[Thu Aug 16 11:25:14 2007] [notice] mod_python: Creating 8 session mutexes 
based on 0 max processes and 250 max threads.
[Thu Aug 16 11:25:14 2007] [notice] Child 520: Child process is running
[Thu Aug 16 11:25:14 2007] [notice] Child 520: Acquired the start mutex.
[Thu Aug 16 11:25:14 2007] [notice] Child 520: Starting 250 worker threads.

If anyone could help me out with my last error i would be really thankful 
since i have tried to do this for several hours now. I feel really 
disapointed and tired of just trying and trying, thats why i mail in this 
mail list.

Some other information that might be useful: (This is how i have it now, 
when apache 2.0.59 is "sort of" working:

CURRENT "PATH" VARIABLE:

........;H:\install\Python24;H:\install\Subversion\bin;H:\install\Python24\DLLs;H:\install\Python24\Lib;H:\install\Python24\Lib\lib-tk;H:\install\Python24\Lib\site-packages;H:\install\Python24\Lib\site-packages\mod_python

NOTE: Even though i have entered: Lib\site-packages\mod_python etc. It 
doesnet show this in the error log. It only shows DLLs, Lib, lib-tk, and so 
on? Why is that? I have tried restarting but this time it isnt changing? 
Maybe i must reinstall apache when these settigns are set?

CURRENT REGISTRY SETTINGS:

This is my "PythonPath" in the registry, i have tried adding 
"...site-packages\\mod_python" here as well.

Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Python\PythonCore\2.4\PythonPath]
@="H:\\install\\Python24\\Lib;H:\\install\\Python24\\DLLs;H:\\install\\Python24\\Lib\\lib-tk;H:\\install\\Python24\\Lib\\site-packages;H:\\install\\Python24\\Lib\\site-packages\\mod_python"


Now, if there are any more details you think i should provide then please 
let me know, i will gladly provide the information if im able to!
Im not the best on installing these actually advanced programs/modules. 
Installing Trac has been a nightmare for me. Either that wont work or that, 
trac has really succeeded in making the worlds most difficult install if you 
ask me ;).

Thank you for reading!

Best Regards Jacob Carlsson



>From: "Colin Bean" <ccbean@gmail.com>
>To: "Jacob Carlsson" <jagge_90@hotmail.com>, list 
><mod_python@modpython.org>
>Subject: Re: [mod_python] Apache wont load/start...
>Date: Wed, 15 Aug 2007 13:35:21 -0700
>
>Try following the links from this message, they seem to address the
>same problem:
>
>http://www.modpython.org/pipermail/mod_python/2007-June/023861.html
>
>Past that I'm probably not going to be of much help as I don't use
>mod_python on windows...
>Just to clarify, you are using the installer compiled for apache
>2.0.x, correct?  I'm guessing so, as I doubt you would have gotten
>this far otherwise.
>
>Take care,
>Colin
>
>On 8/15/07, Jacob Carlsson <jagge_90@hotmail.com> wrote:
> > Hey!
> >
> > Thank you for your fast answer!
> >
> > There was no errors in the log. Thats why it was so weird. While i 
>waited
> > for an answer i downgraded my apache to 2.0.59 again and entered my 
>python
> > installation path in the PATH variable. And when i restarted my computer 
>it
> > started up fine despite i had entered "LoadModule python_module ...". 
>But
> > still it dont work and gives me alot of errors. I'll post my log:
> >
> >
> >
> > [Wed Aug 15 21:00:47 2007] [notice] Apache/2.0.59 (Win32) DAV/2 
>SVN/1.4.4
> > configured -- resuming normal operations
> > [Wed Aug 15 21:00:47 2007] [notice] Server built: Jul 27 2006 15:55:03
> > [Wed Aug 15 21:00:47 2007] [notice] Parent: Created child process 4852
> > [Wed Aug 15 21:00:48 2007] [error] python_init: Python version mismatch,
> > expected '2.4.3', found '2.4.4'.
> > [Wed Aug 15 21:00:48 2007] [error] python_init: Python executable found
> > 'H:\\install\\Apache2\\bin\\Apache.exe'.
> > [Wed Aug 15 21:00:48 2007] [error] python_init: Python path being used
> > 
>'H:\\install\\Python24\\python24.zip;.\\DLLs;.\\lib;.\\lib\\plat-win;.\\lib\\lib-tk;H:\\install\\Apache2\\bin'.
> > [Wed Aug 15 21:00:48 2007] [notice] mod_python: Creating 8 session 
>mutexes
> > based on 0 max processes and 250 max threads.
> > [Wed Aug 15 21:00:48 2007] [notice] Child 4852: Child process is running
> > [Wed Aug 15 21:00:48 2007] [notice] Child 4852: Acquired the start 
>mutex.
> > [Wed Aug 15 21:00:48 2007] [notice] Child 4852: Starting 250 worker 
>threads.
> > [Wed Aug 15 21:00:51 2007] [error] make_obcallback: could not import
> > mod_python.apache.\n
> > [Wed Aug 15 21:00:51 2007] [error] make_obcallback: Python path being 
>used
> > "['H:\\\\install\\\\Python24\\\\python24.zip', '.\\\\DLLs', '.\\\\lib',
> > '.\\\\lib\\\\plat-win', '.\\\\lib\\\\lib-tk',
> > 'H:\\\\install\\\\Apache2\\\\bin']".
> > [Wed Aug 15 21:00:51 2007] [error] get_interpreter: no interpreter 
>callback
> > found.
> > [Wed Aug 15 21:00:51 2007] [error] [client 127.0.0.1] python_handler: 
>Can't
> > get/create interpreter.
> >
> >
> > These last errors comes when i try accessing the following:
> >
> > <Location /mpinfo>
> >    SetHandler mod_python
> >    PythonInterpreter main_interpreter
> >    PythonHandler mod_python.testhandler
> > </Location>
> >
> > Like what does it mean with "Python version mismatch, expected '2.4.3',
> > found '2.4.4'.", expected 2.4.3? How could it expect something else?
> >
> > Also i tried entering some more paths into the PATH variable like
> > "Lib,lib-tk,DLLs" but it doesent seem enough...
> >
> > Best Regards Jacob Carlsson
> >
> > >From: "Colin Bean" <ccbean@gmail.com>
> > >To: "Jacob Carlsson" <jagge_90@hotmail.com>
> > >CC: mod_python@modpython.org
> > >Subject: Re: [mod_python] Apache wont load/start...
> > >Date: Wed, 15 Aug 2007 11:08:19 -0700
> > >
> > >Please post the contents from your Apache error log when you try to
> > >start the server, can't really tell what the problem is from the
> > >information you've given.
> > >
> > >On 8/15/07, Jacob Carlsson <jagge_90@hotmail.com> wrote:
> > > > Hello!
> > > >
> > > > Im using Windows XP.
> > > >
> > > > I have tried to get apache (both 2.2.4 and 2.0.59 to work with
> > >mod_python).
> > > > I have python 2.4 and I have tried using
> > > > "mod_python-3.2.10.win32-py2.4-apache2.2" &
> > > > "mod_python-3.3.1.win32-py2.4-Apache2.2" and also some other 
>different
> > > > versions when I tested with apache 2.0.59.
> > > >
> > > > My problem is that apache simply wont load when i enter "LoadModule
> > > > python_module modules/mod_python.so" in httpd.conf.
> > > > Now I have tried fixing this in many various ways for hours and not
> > >succeded
> > > > at all.
> > > > For example I have searched google and your page for answers and i 
>found
> > >out
> > > > that some people had the same problem as I but some of their 
>solutions
> > >didnt
> > > > work out for me.
> > > > For example I tried adding python to my "PATH" variable but that 
>didnt
> > >help
> > > > much.. Maybe i did it incorrect? I added "C:\Python24" (thats simply
> > >where I
> > > > installed python)
> > > > Also many that have the same problem didnt get an answer that i 
>could
> > >read.
> > > >
> > > > So i would appreciate any help so i finally can solve this really
> > >annoying
> > > > problem!
> > > >
> > > > Best Regards Jacob Carlsson
> > > >
> > > > _________________________________________________________________
> > > > Luspank? Tj?na pengar p? auktion http://tradera.msn.se/
> > > >
> > > > _______________________________________________
> > > > Mod_python mailing list
> > > > Mod_python@modpython.org
> > > > http://mailman.modpython.org/mailman/listinfo/mod_python
> > > >
> >
> > _________________________________________________________________
> > Spela roliga Worms'07 i mobilen
> > http://msn.cellus.se/?page=game_order&itemId=878908
> >
> >

_________________________________________________________________
Luspank? Tj?na pengar p? auktion http://tradera.msn.se/

From graham.dumpleton at gmail.com  Thu Aug 16 07:29:04 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Aug 16 07:29:23 2007
Subject: [mod_python] Apache wont load/start...
In-Reply-To: <BAY129-F3290E8CCDF966D6E3CCE0DF7DF0@phx.gbl>
References: <88e286470708151519s4eb38159v8e1218a0385c0047@mail.gmail.com>
	<BAY129-F3290E8CCDF966D6E3CCE0DF7DF0@phx.gbl>
Message-ID: <88e286470708160429l5ae5dec4t589848a29d789ce7@mail.gmail.com>

On 16/08/07, Jacob Carlsson <jagge_90@hotmail.com> wrote:
> Hello!
>
> Okey. Im going to give some more detaild information.
>
> OS: Windows XP SP2
> PYTHON: 2.4.4
> MOD_PYTHON: mod_python-3.3.1.win32-py2.4-Apache2.0
> APACHE: Apache 2.0.59 (yes, its from a installer i didnt compile it myself)
> WHY DO I WANT MOD_PYTHON: To install the project management tool Trac
>
> FIRST PROBLEM:
> Now i had Apache 2.2, mod_python-3.3.1.win32-py2.4-Apache2.2, python 2.4
> installed.
> Everytime i entered "LoadModule python_module modules/mod_python.so" my
> apache wouldnt start. There was no error specified in the apache monitor
> only said "Error", and there was no special error specified in apcahes Error
> log either, not any "couldnt find/load module" or anything.

Did you run Apache installer as Administrator?

How are you starting Apache? Are you starting it as yourself directly,
or as an Apache service?

> HOW DID I SOLVE THE FIRST PROBLEM:
> I really did not solve it, or maybe? First i couldnt even launch apache
> 2.0.59 when adding "LoadModule ...." but then i thought, why not try
> downgrading and make clean install once more and so i did. I unistalled
> apache 2.2 and mod_python installed clean apache 2.0.59 and mod_python,
> restarted my computer and it worked. Now i could load the module without
> apache screaming about a Error. Though i directly ran into next problem but
> at least i got somewhere.
> So note that BEFORE i restarted my computer i also added:
>
> Well i simply added some paths to the PATH variable (Right click your "My
> computer" -> Properties -> Advanced -> Enviorment Variables -> find PATH i
> list -> add directorys where python is installed)
>
> I never tried these settings with Apache 2.2 since i didnt understand that
> restarting was needed.
> Also maybe this didnt solve my problem, maybe it was something else? And
> thats just exaclty the reason why im staying at 2.0.59 now when i got it
> working instead of going back to 2.2 and getting that error again.
>
> SECOND PROBLEM:
> Well, now i got apache 2.0.59, mod_python 3.3.1 read my settings on top of
> the mail for more detaild information about my system as it is now. Now i
> can run apache when LoadModule is uncommented in httpd.conf but i cant use
> python at all. When i add:
>
> <Location /mpinfo>
>    SetHandler mod_python
>    PythonInterpreter main_interpreter
>    PythonHandler mod_python.testhandler
> </Location>
>
> and then try to access localhost/mpinfo the server gives me a internal error
> (500).
> My Apache error log says:
>
> [Thu Aug 16 12:13:07 2007] [error] make_obcallback: could not import
> mod_python.apache.\n
> [Thu Aug 16 12:13:07 2007] [error] make_obcallback: Python path being used
> "['H:\\\\install\\\\Python24\\\\python24.zip', '.\\\\DLLs', '.\\\\lib',
> '.\\\\lib\\\\plat-win', '.\\\\lib\\\\lib-tk',

Where this is wrong is that the actual directory where the Python
stuff is meant to be has been replaced with '.'. That this is wrong
means that site.py file probably isn't being found and as a result
site-packages not being added automatically and so can't find
mod_python. Why the path would have '.' I don't know.

If you can set environment variable:

  PYTHONVERBOSE=1

before you start Apache, you may be able to coax Python to output more
verbose information and you might see error about not finding site.py
file.

> 'H:\\\\install\\\\Apache2\\\\bin']".
> [Thu Aug 16 12:13:07 2007] [error] get_interpreter: no interpreter callback
> found.
> [Thu Aug 16 12:13:07 2007] [error] [client 127.0.0.1] python_handler: Can't
> get/create interpreter.
>
> And on STARTUP of the apache it also seems to be a little error:
>
> [Thu Aug 16 11:25:14 2007] [notice] Apache/2.0.59 (Win32) DAV/2 SVN/1.4.4
> configured -- resuming normal operations
> [Thu Aug 16 11:25:14 2007] [notice] Server built: Jul 27 2006 15:55:03
> [Thu Aug 16 11:25:14 2007] [notice] Parent: Created child process 520
> [Thu Aug 16 11:25:14 2007] [error] python_init: Python version mismatch,
> expected '2.4.3', found '2.4.4'.
> [Thu Aug 16 11:25:14 2007] [error] python_init: Python executable found
> 'H:\\install\\Apache2\\bin\\Apache.exe'.
> [Thu Aug 16 11:25:14 2007] [error] python_init: Python path being used
> 'H:\\install\\Python24\\python24.zip;.\\DLLs;.\\lib;.\\lib\\plat-win;.\\lib\\lib-tk;H:\\install\\Apache2\\bin'.
> [Thu Aug 16 11:25:14 2007] [notice] mod_python: Creating 8 session mutexes
> based on 0 max processes and 250 max threads.
> [Thu Aug 16 11:25:14 2007] [notice] Child 520: Child process is running
> [Thu Aug 16 11:25:14 2007] [notice] Child 520: Acquired the start mutex.
> [Thu Aug 16 11:25:14 2007] [notice] Child 520: Starting 250 worker threads.
>
> If anyone could help me out with my last error i would be really thankful
> since i have tried to do this for several hours now. I feel really
> disapointed and tired of just trying and trying, thats why i mail in this
> mail list.

If you get totally frustrated and want to try something different,
have a go at mod_wsgi instead of mod_python. :-)

> Some other information that might be useful: (This is how i have it now,
> when apache 2.0.59 is "sort of" working:
>
> CURRENT "PATH" VARIABLE:
>
> ........;H:\install\Python24;H:\install\Subversion\bin;H:\install\Python24\DLLs;H:\install\Python24\Lib;H:\install\Python24\Lib\lib-tk;H:\install\Python24\Lib\site-packages;H:\install\Python24\Lib\site-packages\mod_python
>
> NOTE: Even though i have entered: Lib\site-packages\mod_python etc. It
> doesnet show this in the error log. It only shows DLLs, Lib, lib-tk, and so
> on? Why is that? I have tried restarting but this time it isnt changing?
> Maybe i must reinstall apache when these settigns are set?
>
> CURRENT REGISTRY SETTINGS:
>
> This is my "PythonPath" in the registry, i have tried adding
> "...site-packages\\mod_python" here as well.
>
> Windows Registry Editor Version 5.00
>
> [HKEY_CURRENT_USER\Software\Python\PythonCore\2.4\PythonPath]
> @="H:\\install\\Python24\\Lib;H:\\install\\Python24\\DLLs;H:\\install\\Python24\\Lib\\lib-tk;H:\\install\\Python24\\Lib\\site-packages;H:\\install\\Python24\\Lib\\site-packages\\mod_python"

Did you run Python installer as Administrator? Suggestions made by
people in past gave:

[HKEY_LOCAL_MACHINE\SOFTWARE\Python\PythonCore\2.5\PythonPath]
@="<path to python>\\Lib;<path to python>\\DLLs;<path to
python>\\Lib\\lib-tk"

Check KEY_LOCAL_MACHINE to see if there are entries there and post
what they are. If they are missing or wrong and running Apache as
service, might be bypassing your user entries and thus end up with
wrong directories.

> Now, if there are any more details you think i should provide then please
> let me know, i will gladly provide the information if im able to!
> Im not the best on installing these actually advanced programs/modules.
> Installing Trac has been a nightmare for me. Either that wont work or that,
> trac has really succeeded in making the worlds most difficult install if you
> ask me ;).

You might also have a read of thread:

  http://groups.google.com/group/modwsgi/browse_thread/thread/16242447b5890e96

This was for mod_wsgi instead of mod_python, but it gives a whole
bunch of other registry entries which I don't know are relevant or
not.

Maybe a Windows person can make more sense of this than me. I don't
use Windows for this stort of stuff.

Graham

> Thank you for reading!
>
> Best Regards Jacob Carlsson
>
> >From: "Graham Dumpleton" <graham.dumpleton@gmail.com>
> >To: "Colin Bean" <ccbean@gmail.com>
> >CC: "Jacob Carlsson" <jagge_90@hotmail.com>, list
> ><mod_python@modpython.org>
> >Subject: Re: [mod_python] Apache wont load/start...
> >Date: Thu, 16 Aug 2007 08:19:16 +1000
> >
> >On 16/08/07, Colin Bean <ccbean@gmail.com> wrote:
> > > Try following the links from this message, they seem to address the
> > > same problem:
> > >
> > > http://www.modpython.org/pipermail/mod_python/2007-June/023861.html
> >
> >Actually, possibly don't pay too much attention to that post about
> >adding site-packages as it isn't meant to be listed in the registry
> >entries to begin with. The site-packages directory is only added when
> >the Python site.py file has been loaded. This was only brought to my
> >attention recently when working out Windows issues with mod_wsgi.
> >
> >Thus, if mod_python code modules not being found, more likely to be
> >that correct site.py file isn't being found at startup. This can occur
> >because of access permissions on files if Apache is run as a service
> >and thus a different user. Thus, very important to install
> >Apache/Python/mod_python as administrator so file permissions are
> >okay, DLLs are in system directories and so registry entries setup for
> >machine and not just user.
> >
> >Problems can also arise where you have installed multiple versions of
> >Python and the first one found in PATH is not the same version that
> >mod_python requires. This can occur from installing multiple Python
> >versions explicitly, or can be done inadvertently as there are now a
> >number of Windows applications which provide their own copy of Python.
> >If the Python version from such an application is found in PATH first
> >it can screw everything up. If this Python version was found first
> >when installing mod_python, can also mean that mod_python Python code
> >files were installed in wrong location and not where Python used by
> >Apache is looking. There can also be a problem where real Python was
> >installed as administrator and the application version as normal user,
> >as the application version may put entries in user registry entries
> >and shadow those for machine.
> >
> >I stress though what has already been said, it is vitally important to
> >see what is being logged in the Apache error logs so the reason can be
> >determined.
> >
> >As to not seeing solutions to previous posts, it is generally because
> >people having problems don't explain problems very well and in enough
> >detail. As a consequence we repeat all the commonly suspected issues,
> >such as above. The OP somehow then solves his problem and then doesn't
> >bother responding to say what the problem was and how they fixed it.
> >As a consequence we never learn anything about what the actual problem
> >was and are never able to improve our troubleshooting suggestions.
> >
> >So, please provide details about log messages and help us by feeding
> >back whatever information seems pertinent and how you may have solved
> >the problem.
> >
> >Thanks.
> >
> >Graham
> >
> > > Past that I'm probably not going to be of much help as I don't use
> > > mod_python on windows...
> > > Just to clarify, you are using the installer compiled for apache
> > > 2.0.x, correct?  I'm guessing so, as I doubt you would have gotten
> > > this far otherwise.
> > >
> > > Take care,
> > > Colin
> > >
> > > On 8/15/07, Jacob Carlsson <jagge_90@hotmail.com> wrote:
> > > > Hey!
> > > >
> > > > Thank you for your fast answer!
> > > >
> > > > There was no errors in the log. Thats why it was so weird. While i
> >waited
> > > > for an answer i downgraded my apache to 2.0.59 again and entered my
> >python
> > > > installation path in the PATH variable. And when i restarted my
> >computer it
> > > > started up fine despite i had entered "LoadModule python_module ...".
> >But
> > > > still it dont work and gives me alot of errors. I'll post my log:
> > > >
> > > >
> > > >
> > > > [Wed Aug 15 21:00:47 2007] [notice] Apache/2.0.59 (Win32) DAV/2
> >SVN/1.4.4
> > > > configured -- resuming normal operations
> > > > [Wed Aug 15 21:00:47 2007] [notice] Server built: Jul 27 2006 15:55:03
> > > > [Wed Aug 15 21:00:47 2007] [notice] Parent: Created child process 4852
> > > > [Wed Aug 15 21:00:48 2007] [error] python_init: Python version
> >mismatch,
> > > > expected '2.4.3', found '2.4.4'.
> > > > [Wed Aug 15 21:00:48 2007] [error] python_init: Python executable
> >found
> > > > 'H:\\install\\Apache2\\bin\\Apache.exe'.
> > > > [Wed Aug 15 21:00:48 2007] [error] python_init: Python path being used
> > > >
> >'H:\\install\\Python24\\python24.zip;.\\DLLs;.\\lib;.\\lib\\plat-win;.\\lib\\lib-tk;H:\\install\\Apache2\\bin'.
> > > > [Wed Aug 15 21:00:48 2007] [notice] mod_python: Creating 8 session
> >mutexes
> > > > based on 0 max processes and 250 max threads.
> > > > [Wed Aug 15 21:00:48 2007] [notice] Child 4852: Child process is
> >running
> > > > [Wed Aug 15 21:00:48 2007] [notice] Child 4852: Acquired the start
> >mutex.
> > > > [Wed Aug 15 21:00:48 2007] [notice] Child 4852: Starting 250 worker
> >threads.
> > > > [Wed Aug 15 21:00:51 2007] [error] make_obcallback: could not import
> > > > mod_python.apache.\n
> > > > [Wed Aug 15 21:00:51 2007] [error] make_obcallback: Python path being
> >used
> > > > "['H:\\\\install\\\\Python24\\\\python24.zip', '.\\\\DLLs',
> >'.\\\\lib',
> > > > '.\\\\lib\\\\plat-win', '.\\\\lib\\\\lib-tk',
> > > > 'H:\\\\install\\\\Apache2\\\\bin']".
> > > > [Wed Aug 15 21:00:51 2007] [error] get_interpreter: no interpreter
> >callback
> > > > found.
> > > > [Wed Aug 15 21:00:51 2007] [error] [client 127.0.0.1] python_handler:
> >Can't
> > > > get/create interpreter.
> > > >
> > > >
> > > > These last errors comes when i try accessing the following:
> > > >
> > > > <Location /mpinfo>
> > > >    SetHandler mod_python
> > > >    PythonInterpreter main_interpreter
> > > >    PythonHandler mod_python.testhandler
> > > > </Location>
> > > >
> > > > Like what does it mean with "Python version mismatch, expected
> >'2.4.3',
> > > > found '2.4.4'.", expected 2.4.3? How could it expect something else?
> > > >
> > > > Also i tried entering some more paths into the PATH variable like
> > > > "Lib,lib-tk,DLLs" but it doesent seem enough...
> > > >
> > > > Best Regards Jacob Carlsson
> > > >
> > > > >From: "Colin Bean" <ccbean@gmail.com>
> > > > >To: "Jacob Carlsson" <jagge_90@hotmail.com>
> > > > >CC: mod_python@modpython.org
> > > > >Subject: Re: [mod_python] Apache wont load/start...
> > > > >Date: Wed, 15 Aug 2007 11:08:19 -0700
> > > > >
> > > > >Please post the contents from your Apache error log when you try to
> > > > >start the server, can't really tell what the problem is from the
> > > > >information you've given.
> > > > >
> > > > >On 8/15/07, Jacob Carlsson <jagge_90@hotmail.com> wrote:
> > > > > > Hello!
> > > > > >
> > > > > > Im using Windows XP.
> > > > > >
> > > > > > I have tried to get apache (both 2.2.4 and 2.0.59 to work with
> > > > >mod_python).
> > > > > > I have python 2.4 and I have tried using
> > > > > > "mod_python-3.2.10.win32-py2.4-apache2.2" &
> > > > > > "mod_python-3.3.1.win32-py2.4-Apache2.2" and also some other
> >different
> > > > > > versions when I tested with apache 2.0.59.
> > > > > >
> > > > > > My problem is that apache simply wont load when i enter
> >"LoadModule
> > > > > > python_module modules/mod_python.so" in httpd.conf.
> > > > > > Now I have tried fixing this in many various ways for hours and
> >not
> > > > >succeded
> > > > > > at all.
> > > > > > For example I have searched google and your page for answers and i
> >found
> > > > >out
> > > > > > that some people had the same problem as I but some of their
> >solutions
> > > > >didnt
> > > > > > work out for me.
> > > > > > For example I tried adding python to my "PATH" variable but that
> >didnt
> > > > >help
> > > > > > much.. Maybe i did it incorrect? I added "C:\Python24" (thats
> >simply
> > > > >where I
> > > > > > installed python)
> > > > > > Also many that have the same problem didnt get an answer that i
> >could
> > > > >read.
> > > > > >
> > > > > > So i would appreciate any help so i finally can solve this really
> > > > >annoying
> > > > > > problem!
> > > > > >
> > > > > > Best Regards Jacob Carlsson
> > > > > >
> > > > > > _________________________________________________________________
> > > > > > Luspank? Tj?na pengar p? auktion http://tradera.msn.se/
> > > > > >
> > > > > > _______________________________________________
> > > > > > Mod_python mailing list
> > > > > > Mod_python@modpython.org
> > > > > > http://mailman.modpython.org/mailman/listinfo/mod_python
> > > > > >
> > > >
> > > > _________________________________________________________________
> > > > Spela roliga Worms'07 i mobilen
> > > > http://msn.cellus.se/?page=game_order&itemId=878908
> > > >
> > > >
> > >
> > > _______________________________________________
> > > Mod_python mailing list
> > > Mod_python@modpython.org
> > > http://mailman.modpython.org/mailman/listinfo/mod_python
> > >
>
> _________________________________________________________________
> Spela roliga Worms'07 i mobilen
> http://msn.cellus.se/?page=game_order&itemId=878908
>
>

From zeljko_t at post.htnet.hr  Thu Aug 16 14:17:09 2007
From: zeljko_t at post.htnet.hr (Zeljko Trogrlic)
Date: Thu Aug 16 14:17:21 2007
Subject: [mod_python] mod_python library problem
Message-ID: <46C494A5.4060105@post.htnet.hr>

Hello,
 
I am porting Python web application from Solaris to Linux. This 
application is using one C module. Module is accessible from command 
line interpreter, but if I try to import it in web application, I get:
 
[Fri Aug 17 09:03:55 2007] [error] [client xxx.xxx.xxx.xxx] 
PythonHandler mod_python.cgihandler: ImportError: No module named 
msmutil, referer: http://192.168.200.20/

I tried to (directory /opt/aaa/siem_aatv contains .so file):
 * export PYTHONPATH
 * add it through httpd.conf: PythonPath "sys.path + 
['/opt/mradius-common/lib/python','/opt/webconf/lib','/opt/aaa/siem_aatv']"
 * add it programatically: sys.path.append('/opt/aaa/siem_aatv')
but nothing works. Other non-C Python modules are found. If I try to 
print out sys.path, it is there:
 
for x in sys.path:
        sys.stderr.write(x);
        sys.stderr.write('\n');

Result:

/usr/lib/python23.zip
/usr/lib/python2.3
/usr/lib/python2.3/plat-linux2
/usr/lib/python2.3/lib-tk
/usr/lib/python2.3/lib-dynload
/usr/lib/python2.3/site-packages
/usr/lib/python2.3/site-packages/gtk-2.0
/opt/mradius-common/lib/python
/opt/webconf/lib
/opt/aaa/siem_aatv
 
Did somebody experienced such problem?

python-2.3.4-14.1
mod_python-3.1.3-5.1

Zeljko

From graham.dumpleton at gmail.com  Thu Aug 16 18:03:53 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Aug 16 18:04:07 2007
Subject: [mod_python] Apache wont load/start...
In-Reply-To: <BAY129-F40914CB3824837E07EEBB4F7DF0@phx.gbl>
References: <88e286470708160429l5ae5dec4t589848a29d789ce7@mail.gmail.com>
	<BAY129-F40914CB3824837E07EEBB4F7DF0@phx.gbl>
Message-ID: <88e286470708161503m3a0ad2d9ib997b09b6d4ca4@mail.gmail.com>

So everyone on the mailing list knows, problem solved. See below.

My question now is at what point did Python 2.5 get installed,
apparently as Administrator? Did you subsequently uninstall it or is
it still on your system somewhere?

What might have also worked is if you uninstalled Python 2.4, ensuring
user registry entries were cleaned up and then reinstall Python 2.4 as
Administrator.

Thanks for the feedback, slowly each bit of information we get helps
to clarify how some peoples systems end up in this state.

BTW, the configuration for this mailing list means that you need to
use reply-all for response to go back to the mailing list.

Graham

On 16/08/07, Jacob Carlsson <jagge_90@hotmail.com> wrote:
> I solved the problem! Now it shows /mpinfo!!
>
> And i'll tell you how and why.
>
> I thought about some of the things you wrote in the previous email and i
> rememberd: did i check if the python registry file ALSO existed in:
> [HKEY_LOCAL_MACHINE\SOFTWARE\Python\PythonCore\2.4] ?
>
> The answer was no, i only checked HKEY_CURRENT_USER. So i checked if the
> registry key existed in HKEY_LOCAL_MACHINE and it didnt! So i went to:
> http://www.modpython.org/pipermail/mod_python/2006-September/021979.html
> as you have told many users with my problem and i just changed all "2.5" to
> "2.4" since im runing python 2.4. I ran the .reg file and restarted my
> apache and localhost/mpinfo worked. It shows no errors and seem to show the
> correct information.
>
> Now lets see if i can install Trac without any more troubles with
> mod_python.. Hehe.
>
> Thank you for you excellent help and really fast answers! :)
>
> Best Regards Jacob Carlsson
>
>
> >From: "Graham Dumpleton" <graham.dumpleton@gmail.com>
> >To: "Jacob Carlsson" <jagge_90@hotmail.com>
> >CC: mod_python <mod_python@modpython.org>
> >Subject: Re: [mod_python] Apache wont load/start...
> >Date: Thu, 16 Aug 2007 21:29:04 +1000
> >
> >On 16/08/07, Jacob Carlsson <jagge_90@hotmail.com> wrote:
> > > Hello!
> > >
> > > Okey. Im going to give some more detaild information.
> > >
> > > OS: Windows XP SP2
> > > PYTHON: 2.4.4
> > > MOD_PYTHON: mod_python-3.3.1.win32-py2.4-Apache2.0
> > > APACHE: Apache 2.0.59 (yes, its from a installer i didnt compile it
> >myself)
> > > WHY DO I WANT MOD_PYTHON: To install the project management tool Trac
> > >
> > > FIRST PROBLEM:
> > > Now i had Apache 2.2, mod_python-3.3.1.win32-py2.4-Apache2.2, python 2.4
> > > installed.
> > > Everytime i entered "LoadModule python_module modules/mod_python.so" my
> > > apache wouldnt start. There was no error specified in the apache monitor
> > > only said "Error", and there was no special error specified in apcahes
> >Error
> > > log either, not any "couldnt find/load module" or anything.
> >
> >Did you run Apache installer as Administrator?
> >
> >How are you starting Apache? Are you starting it as yourself directly,
> >or as an Apache service?
> >
> > > HOW DID I SOLVE THE FIRST PROBLEM:
> > > I really did not solve it, or maybe? First i couldnt even launch apache
> > > 2.0.59 when adding "LoadModule ...." but then i thought, why not try
> > > downgrading and make clean install once more and so i did. I unistalled
> > > apache 2.2 and mod_python installed clean apache 2.0.59 and mod_python,
> > > restarted my computer and it worked. Now i could load the module without
> > > apache screaming about a Error. Though i directly ran into next problem
> >but
> > > at least i got somewhere.
> > > So note that BEFORE i restarted my computer i also added:
> > >
> > > Well i simply added some paths to the PATH variable (Right click your
> >"My
> > > computer" -> Properties -> Advanced -> Enviorment Variables -> find PATH
> >i
> > > list -> add directorys where python is installed)
> > >
> > > I never tried these settings with Apache 2.2 since i didnt understand
> >that
> > > restarting was needed.
> > > Also maybe this didnt solve my problem, maybe it was something else? And
> > > thats just exaclty the reason why im staying at 2.0.59 now when i got it
> > > working instead of going back to 2.2 and getting that error again.
> > >
> > > SECOND PROBLEM:
> > > Well, now i got apache 2.0.59, mod_python 3.3.1 read my settings on top
> >of
> > > the mail for more detaild information about my system as it is now. Now
> >i
> > > can run apache when LoadModule is uncommented in httpd.conf but i cant
> >use
> > > python at all. When i add:
> > >
> > > <Location /mpinfo>
> > >    SetHandler mod_python
> > >    PythonInterpreter main_interpreter
> > >    PythonHandler mod_python.testhandler
> > > </Location>
> > >
> > > and then try to access localhost/mpinfo the server gives me a internal
> >error
> > > (500).
> > > My Apache error log says:
> > >
> > > [Thu Aug 16 12:13:07 2007] [error] make_obcallback: could not import
> > > mod_python.apache.\n
> > > [Thu Aug 16 12:13:07 2007] [error] make_obcallback: Python path being
> >used
> > > "['H:\\\\install\\\\Python24\\\\python24.zip', '.\\\\DLLs', '.\\\\lib',
> > > '.\\\\lib\\\\plat-win', '.\\\\lib\\\\lib-tk',
> >
> >Where this is wrong is that the actual directory where the Python
> >stuff is meant to be has been replaced with '.'. That this is wrong
> >means that site.py file probably isn't being found and as a result
> >site-packages not being added automatically and so can't find
> >mod_python. Why the path would have '.' I don't know.
> >
> >If you can set environment variable:
> >
> >   PYTHONVERBOSE=1
> >
> >before you start Apache, you may be able to coax Python to output more
> >verbose information and you might see error about not finding site.py
> >file.
> >
> > > 'H:\\\\install\\\\Apache2\\\\bin']".
> > > [Thu Aug 16 12:13:07 2007] [error] get_interpreter: no interpreter
> >callback
> > > found.
> > > [Thu Aug 16 12:13:07 2007] [error] [client 127.0.0.1] python_handler:
> >Can't
> > > get/create interpreter.
> > >
> > > And on STARTUP of the apache it also seems to be a little error:
> > >
> > > [Thu Aug 16 11:25:14 2007] [notice] Apache/2.0.59 (Win32) DAV/2
> >SVN/1.4.4
> > > configured -- resuming normal operations
> > > [Thu Aug 16 11:25:14 2007] [notice] Server built: Jul 27 2006 15:55:03
> > > [Thu Aug 16 11:25:14 2007] [notice] Parent: Created child process 520
> > > [Thu Aug 16 11:25:14 2007] [error] python_init: Python version mismatch,
> > > expected '2.4.3', found '2.4.4'.
> > > [Thu Aug 16 11:25:14 2007] [error] python_init: Python executable found
> > > 'H:\\install\\Apache2\\bin\\Apache.exe'.
> > > [Thu Aug 16 11:25:14 2007] [error] python_init: Python path being used
> > >
> >'H:\\install\\Python24\\python24.zip;.\\DLLs;.\\lib;.\\lib\\plat-win;.\\lib\\lib-tk;H:\\install\\Apache2\\bin'.
> > > [Thu Aug 16 11:25:14 2007] [notice] mod_python: Creating 8 session
> >mutexes
> > > based on 0 max processes and 250 max threads.
> > > [Thu Aug 16 11:25:14 2007] [notice] Child 520: Child process is running
> > > [Thu Aug 16 11:25:14 2007] [notice] Child 520: Acquired the start mutex.
> > > [Thu Aug 16 11:25:14 2007] [notice] Child 520: Starting 250 worker
> >threads.
> > >
> > > If anyone could help me out with my last error i would be really
> >thankful
> > > since i have tried to do this for several hours now. I feel really
> > > disapointed and tired of just trying and trying, thats why i mail in
> >this
> > > mail list.
> >
> >If you get totally frustrated and want to try something different,
> >have a go at mod_wsgi instead of mod_python. :-)
> >
> > > Some other information that might be useful: (This is how i have it now,
> > > when apache 2.0.59 is "sort of" working:
> > >
> > > CURRENT "PATH" VARIABLE:
> > >
> > >
> >........;H:\install\Python24;H:\install\Subversion\bin;H:\install\Python24\DLLs;H:\install\Python24\Lib;H:\install\Python24\Lib\lib-tk;H:\install\Python24\Lib\site-packages;H:\install\Python24\Lib\site-packages\mod_python
> > >
> > > NOTE: Even though i have entered: Lib\site-packages\mod_python etc. It
> > > doesnet show this in the error log. It only shows DLLs, Lib, lib-tk, and
> >so
> > > on? Why is that? I have tried restarting but this time it isnt changing?
> > > Maybe i must reinstall apache when these settigns are set?
> > >
> > > CURRENT REGISTRY SETTINGS:
> > >
> > > This is my "PythonPath" in the registry, i have tried adding
> > > "...site-packages\\mod_python" here as well.
> > >
> > > Windows Registry Editor Version 5.00
> > >
> > > [HKEY_CURRENT_USER\Software\Python\PythonCore\2.4\PythonPath]
> > >
> >@="H:\\install\\Python24\\Lib;H:\\install\\Python24\\DLLs;H:\\install\\Python24\\Lib\\lib-tk;H:\\install\\Python24\\Lib\\site-packages;H:\\install\\Python24\\Lib\\site-packages\\mod_python"
> >
> >Did you run Python installer as Administrator? Suggestions made by
> >people in past gave:
> >
> >[HKEY_LOCAL_MACHINE\SOFTWARE\Python\PythonCore\2.5\PythonPath]
> >@="<path to python>\\Lib;<path to python>\\DLLs;<path to
> >python>\\Lib\\lib-tk"
> >
> >Check KEY_LOCAL_MACHINE to see if there are entries there and post
> >what they are. If they are missing or wrong and running Apache as
> >service, might be bypassing your user entries and thus end up with
> >wrong directories.
> >
> > > Now, if there are any more details you think i should provide then
> >please
> > > let me know, i will gladly provide the information if im able to!
> > > Im not the best on installing these actually advanced programs/modules.
> > > Installing Trac has been a nightmare for me. Either that wont work or
> >that,
> > > trac has really succeeded in making the worlds most difficult install if
> >you
> > > ask me ;).
> >
> >You might also have a read of thread:
> >
> >
> >http://groups.google.com/group/modwsgi/browse_thread/thread/16242447b5890e96
> >
> >This was for mod_wsgi instead of mod_python, but it gives a whole
> >bunch of other registry entries which I don't know are relevant or
> >not.
> >
> >Maybe a Windows person can make more sense of this than me. I don't
> >use Windows for this stort of stuff.
> >
> >Graham
> >
> > > Thank you for reading!
> > >
> > > Best Regards Jacob Carlsson
> > >
> > > >From: "Graham Dumpleton" <graham.dumpleton@gmail.com>
> > > >To: "Colin Bean" <ccbean@gmail.com>
> > > >CC: "Jacob Carlsson" <jagge_90@hotmail.com>, list
> > > ><mod_python@modpython.org>
> > > >Subject: Re: [mod_python] Apache wont load/start...
> > > >Date: Thu, 16 Aug 2007 08:19:16 +1000
> > > >
> > > >On 16/08/07, Colin Bean <ccbean@gmail.com> wrote:
> > > > > Try following the links from this message, they seem to address the
> > > > > same problem:
> > > > >
> > > > > http://www.modpython.org/pipermail/mod_python/2007-June/023861.html
> > > >
> > > >Actually, possibly don't pay too much attention to that post about
> > > >adding site-packages as it isn't meant to be listed in the registry
> > > >entries to begin with. The site-packages directory is only added when
> > > >the Python site.py file has been loaded. This was only brought to my
> > > >attention recently when working out Windows issues with mod_wsgi.
> > > >
> > > >Thus, if mod_python code modules not being found, more likely to be
> > > >that correct site.py file isn't being found at startup. This can occur
> > > >because of access permissions on files if Apache is run as a service
> > > >and thus a different user. Thus, very important to install
> > > >Apache/Python/mod_python as administrator so file permissions are
> > > >okay, DLLs are in system directories and so registry entries setup for
> > > >machine and not just user.
> > > >
> > > >Problems can also arise where you have installed multiple versions of
> > > >Python and the first one found in PATH is not the same version that
> > > >mod_python requires. This can occur from installing multiple Python
> > > >versions explicitly, or can be done inadvertently as there are now a
> > > >number of Windows applications which provide their own copy of Python.
> > > >If the Python version from such an application is found in PATH first
> > > >it can screw everything up. If this Python version was found first
> > > >when installing mod_python, can also mean that mod_python Python code
> > > >files were installed in wrong location and not where Python used by
> > > >Apache is looking. There can also be a problem where real Python was
> > > >installed as administrator and the application version as normal user,
> > > >as the application version may put entries in user registry entries
> > > >and shadow those for machine.
> > > >
> > > >I stress though what has already been said, it is vitally important to
> > > >see what is being logged in the Apache error logs so the reason can be
> > > >determined.
> > > >
> > > >As to not seeing solutions to previous posts, it is generally because
> > > >people having problems don't explain problems very well and in enough
> > > >detail. As a consequence we repeat all the commonly suspected issues,
> > > >such as above. The OP somehow then solves his problem and then doesn't
> > > >bother responding to say what the problem was and how they fixed it.
> > > >As a consequence we never learn anything about what the actual problem
> > > >was and are never able to improve our troubleshooting suggestions.
> > > >
> > > >So, please provide details about log messages and help us by feeding
> > > >back whatever information seems pertinent and how you may have solved
> > > >the problem.
> > > >
> > > >Thanks.
> > > >
> > > >Graham
> > > >
> > > > > Past that I'm probably not going to be of much help as I don't use
> > > > > mod_python on windows...
> > > > > Just to clarify, you are using the installer compiled for apache
> > > > > 2.0.x, correct?  I'm guessing so, as I doubt you would have gotten
> > > > > this far otherwise.
> > > > >
> > > > > Take care,
> > > > > Colin
> > > > >
> > > > > On 8/15/07, Jacob Carlsson <jagge_90@hotmail.com> wrote:
> > > > > > Hey!
> > > > > >
> > > > > > Thank you for your fast answer!
> > > > > >
> > > > > > There was no errors in the log. Thats why it was so weird. While i
> > > >waited
> > > > > > for an answer i downgraded my apache to 2.0.59 again and entered
> >my
> > > >python
> > > > > > installation path in the PATH variable. And when i restarted my
> > > >computer it
> > > > > > started up fine despite i had entered "LoadModule python_module
> >...".
> > > >But
> > > > > > still it dont work and gives me alot of errors. I'll post my log:
> > > > > >
> > > > > >
> > > > > >
> > > > > > [Wed Aug 15 21:00:47 2007] [notice] Apache/2.0.59 (Win32) DAV/2
> > > >SVN/1.4.4
> > > > > > configured -- resuming normal operations
> > > > > > [Wed Aug 15 21:00:47 2007] [notice] Server built: Jul 27 2006
> >15:55:03
> > > > > > [Wed Aug 15 21:00:47 2007] [notice] Parent: Created child process
> >4852
> > > > > > [Wed Aug 15 21:00:48 2007] [error] python_init: Python version
> > > >mismatch,
> > > > > > expected '2.4.3', found '2.4.4'.
> > > > > > [Wed Aug 15 21:00:48 2007] [error] python_init: Python executable
> > > >found
> > > > > > 'H:\\install\\Apache2\\bin\\Apache.exe'.
> > > > > > [Wed Aug 15 21:00:48 2007] [error] python_init: Python path being
> >used
> > > > > >
> > >
> > >'H:\\install\\Python24\\python24.zip;.\\DLLs;.\\lib;.\\lib\\plat-win;.\\lib\\lib-tk;H:\\install\\Apache2\\bin'.
> > > > > > [Wed Aug 15 21:00:48 2007] [notice] mod_python: Creating 8 session
> > > >mutexes
> > > > > > based on 0 max processes and 250 max threads.
> > > > > > [Wed Aug 15 21:00:48 2007] [notice] Child 4852: Child process is
> > > >running
> > > > > > [Wed Aug 15 21:00:48 2007] [notice] Child 4852: Acquired the start
> > > >mutex.
> > > > > > [Wed Aug 15 21:00:48 2007] [notice] Child 4852: Starting 250
> >worker
> > > >threads.
> > > > > > [Wed Aug 15 21:00:51 2007] [error] make_obcallback: could not
> >import
> > > > > > mod_python.apache.\n
> > > > > > [Wed Aug 15 21:00:51 2007] [error] make_obcallback: Python path
> >being
> > > >used
> > > > > > "['H:\\\\install\\\\Python24\\\\python24.zip', '.\\\\DLLs',
> > > >'.\\\\lib',
> > > > > > '.\\\\lib\\\\plat-win', '.\\\\lib\\\\lib-tk',
> > > > > > 'H:\\\\install\\\\Apache2\\\\bin']".
> > > > > > [Wed Aug 15 21:00:51 2007] [error] get_interpreter: no interpreter
> > > >callback
> > > > > > found.
> > > > > > [Wed Aug 15 21:00:51 2007] [error] [client 127.0.0.1]
> >python_handler:
> > > >Can't
> > > > > > get/create interpreter.
> > > > > >
> > > > > >
> > > > > > These last errors comes when i try accessing the following:
> > > > > >
> > > > > > <Location /mpinfo>
> > > > > >    SetHandler mod_python
> > > > > >    PythonInterpreter main_interpreter
> > > > > >    PythonHandler mod_python.testhandler
> > > > > > </Location>
> > > > > >
> > > > > > Like what does it mean with "Python version mismatch, expected
> > > >'2.4.3',
> > > > > > found '2.4.4'.", expected 2.4.3? How could it expect something
> >else?
> > > > > >
> > > > > > Also i tried entering some more paths into the PATH variable like
> > > > > > "Lib,lib-tk,DLLs" but it doesent seem enough...
> > > > > >
> > > > > > Best Regards Jacob Carlsson
> > > > > >
> > > > > > >From: "Colin Bean" <ccbean@gmail.com>
> > > > > > >To: "Jacob Carlsson" <jagge_90@hotmail.com>
> > > > > > >CC: mod_python@modpython.org
> > > > > > >Subject: Re: [mod_python] Apache wont load/start...
> > > > > > >Date: Wed, 15 Aug 2007 11:08:19 -0700
> > > > > > >
> > > > > > >Please post the contents from your Apache error log when you try
> >to
> > > > > > >start the server, can't really tell what the problem is from the
> > > > > > >information you've given.
> > > > > > >
> > > > > > >On 8/15/07, Jacob Carlsson <jagge_90@hotmail.com> wrote:
> > > > > > > > Hello!
> > > > > > > >
> > > > > > > > Im using Windows XP.
> > > > > > > >
> > > > > > > > I have tried to get apache (both 2.2.4 and 2.0.59 to work with
> > > > > > >mod_python).
> > > > > > > > I have python 2.4 and I have tried using
> > > > > > > > "mod_python-3.2.10.win32-py2.4-apache2.2" &
> > > > > > > > "mod_python-3.3.1.win32-py2.4-Apache2.2" and also some other
> > > >different
> > > > > > > > versions when I tested with apache 2.0.59.
> > > > > > > >
> > > > > > > > My problem is that apache simply wont load when i enter
> > > >"LoadModule
> > > > > > > > python_module modules/mod_python.so" in httpd.conf.
> > > > > > > > Now I have tried fixing this in many various ways for hours
> >and
> > > >not
> > > > > > >succeded
> > > > > > > > at all.
> > > > > > > > For example I have searched google and your page for answers
> >and i
> > > >found
> > > > > > >out
> > > > > > > > that some people had the same problem as I but some of their
> > > >solutions
> > > > > > >didnt
> > > > > > > > work out for me.
> > > > > > > > For example I tried adding python to my "PATH" variable but
> >that
> > > >didnt
> > > > > > >help
> > > > > > > > much.. Maybe i did it incorrect? I added "C:\Python24" (thats
> > > >simply
> > > > > > >where I
> > > > > > > > installed python)
> > > > > > > > Also many that have the same problem didnt get an answer that
> >i
> > > >could
> > > > > > >read.
> > > > > > > >
> > > > > > > > So i would appreciate any help so i finally can solve this
> >really
> > > > > > >annoying
> > > > > > > > problem!
> > > > > > > >
> > > > > > > > Best Regards Jacob Carlsson
> > > > > > > >
> > > > > > > >
> >_________________________________________________________________
> > > > > > > > Luspank? Tj?na pengar p? auktion http://tradera.msn.se/
> > > > > > > >
> > > > > > > > _______________________________________________
> > > > > > > > Mod_python mailing list
> > > > > > > > Mod_python@modpython.org
> > > > > > > > http://mailman.modpython.org/mailman/listinfo/mod_python
> > > > > > > >
> > > > > >
> > > > > > _________________________________________________________________
> > > > > > Spela roliga Worms'07 i mobilen
> > > > > > http://msn.cellus.se/?page=game_order&itemId=878908
> > > > > >
> > > > > >
> > > > >
> > > > > _______________________________________________
> > > > > Mod_python mailing list
> > > > > Mod_python@modpython.org
> > > > > http://mailman.modpython.org/mailman/listinfo/mod_python
> > > > >
> > >
> > > _________________________________________________________________
> > > Spela roliga Worms'07 i mobilen
> > > http://msn.cellus.se/?page=game_order&itemId=878908
> > >
> > >
>
> _________________________________________________________________
> Se artisterna upptr?da f?r en gr?n planet http://liveearth.se.msn.com/
>
>

From graham.dumpleton at gmail.com  Thu Aug 16 18:05:53 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Aug 16 18:06:07 2007
Subject: [mod_python] mod_python library problem
In-Reply-To: <46C494A5.4060105@post.htnet.hr>
References: <46C494A5.4060105@post.htnet.hr>
Message-ID: <88e286470708161505x3dc6139dp4041fe5a7d9fffe6@mail.gmail.com>

Apache/mod_python generally runs as a distinct user. Ensure that all
the directories down to where the module is installed, plus the module
file itself, are readable to others or appropriate group that Apache
user runs as can access.

Graham

On 17/08/07, Zeljko Trogrlic <zeljko_t@post.htnet.hr> wrote:
> Hello,
>
> I am porting Python web application from Solaris to Linux. This
> application is using one C module. Module is accessible from command
> line interpreter, but if I try to import it in web application, I get:
>
> [Fri Aug 17 09:03:55 2007] [error] [client xxx.xxx.xxx.xxx]
> PythonHandler mod_python.cgihandler: ImportError: No module named
> msmutil, referer: http://192.168.200.20/
>
> I tried to (directory /opt/aaa/siem_aatv contains .so file):
>  * export PYTHONPATH
>  * add it through httpd.conf: PythonPath "sys.path +
> ['/opt/mradius-common/lib/python','/opt/webconf/lib','/opt/aaa/siem_aatv']"
>  * add it programatically: sys.path.append('/opt/aaa/siem_aatv')
> but nothing works. Other non-C Python modules are found. If I try to
> print out sys.path, it is there:
>
> for x in sys.path:
>         sys.stderr.write(x);
>         sys.stderr.write('\n');
>
> Result:
>
> /usr/lib/python23.zip
> /usr/lib/python2.3
> /usr/lib/python2.3/plat-linux2
> /usr/lib/python2.3/lib-tk
> /usr/lib/python2.3/lib-dynload
> /usr/lib/python2.3/site-packages
> /usr/lib/python2.3/site-packages/gtk-2.0
> /opt/mradius-common/lib/python
> /opt/webconf/lib
> /opt/aaa/siem_aatv
>
> Did somebody experienced such problem?
>
> python-2.3.4-14.1
> mod_python-3.1.3-5.1
>
> Zeljko
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From jagge_90 at hotmail.com  Fri Aug 17 07:00:28 2007
From: jagge_90 at hotmail.com (Jacob Carlsson)
Date: Fri Aug 17 07:01:22 2007
Subject: [mod_python] Apache wont load/start...
In-Reply-To: <88e286470708161503m3a0ad2d9ib997b09b6d4ca4@mail.gmail.com>
Message-ID: <BAY129-F246F1132B52BCE13092D8DF7D80@phx.gbl>

Hello Again!

Okey, now im using "answer all".

Fisrt of all i installed python 2.5 as an administartor. This was because i 
was going to use latest Trac (0.11). I faild installing it and got 
frustrated, so i thought that i can try again with a new clean stable 
install. The last stable version of Trac was 0.10.4 and it only required 
Python 2.4.

So i uninstalled python 2.5 (without removing stuff from th registry 
manually) and installed Python 2.4. Since then i always used Python 2.4. At 
the point where i solved the problem with mod_python completly i had cleaned 
the registry of all 2.5 related registry keys and i added the "custom query" 
(which you can find in this mail below).

Note: Everything related to my mail has been installed under an Admin 
account, also it has been the same account and i have not switched.


If theres something else you need to know please let me know!

Best Regards Jacob Carlsson


>From: "Graham Dumpleton" <graham.dumpleton@gmail.com>
>To: "Jacob Carlsson" <jagge_90@hotmail.com>
>CC: mod_python <mod_python@modpython.org>
>Subject: Re: [mod_python] Apache wont load/start...
>Date: Fri, 17 Aug 2007 08:03:53 +1000
>
>So everyone on the mailing list knows, problem solved. See below.
>
>My question now is at what point did Python 2.5 get installed,
>apparently as Administrator? Did you subsequently uninstall it or is
>it still on your system somewhere?
>
>What might have also worked is if you uninstalled Python 2.4, ensuring
>user registry entries were cleaned up and then reinstall Python 2.4 as
>Administrator.
>
>Thanks for the feedback, slowly each bit of information we get helps
>to clarify how some peoples systems end up in this state.
>
>BTW, the configuration for this mailing list means that you need to
>use reply-all for response to go back to the mailing list.
>
>Graham
>
>On 16/08/07, Jacob Carlsson <jagge_90@hotmail.com> wrote:
> > I solved the problem! Now it shows /mpinfo!!
> >
> > And i'll tell you how and why.
> >
> > I thought about some of the things you wrote in the previous email and i
> > rememberd: did i check if the python registry file ALSO existed in:
> > [HKEY_LOCAL_MACHINE\SOFTWARE\Python\PythonCore\2.4] ?
> >
> > The answer was no, i only checked HKEY_CURRENT_USER. So i checked if the
> > registry key existed in HKEY_LOCAL_MACHINE and it didnt! So i went to:
> > http://www.modpython.org/pipermail/mod_python/2006-September/021979.html
> > as you have told many users with my problem and i just changed all "2.5" 
>to
> > "2.4" since im runing python 2.4. I ran the .reg file and restarted my
> > apache and localhost/mpinfo worked. It shows no errors and seem to show 
>the
> > correct information.
> >
> > Now lets see if i can install Trac without any more troubles with
> > mod_python.. Hehe.
> >
> > Thank you for you excellent help and really fast answers! :)
> >
> > Best Regards Jacob Carlsson
> >
> >
> > >From: "Graham Dumpleton" <graham.dumpleton@gmail.com>
> > >To: "Jacob Carlsson" <jagge_90@hotmail.com>
> > >CC: mod_python <mod_python@modpython.org>
> > >Subject: Re: [mod_python] Apache wont load/start...
> > >Date: Thu, 16 Aug 2007 21:29:04 +1000
> > >
> > >On 16/08/07, Jacob Carlsson <jagge_90@hotmail.com> wrote:
> > > > Hello!
> > > >
> > > > Okey. Im going to give some more detaild information.
> > > >
> > > > OS: Windows XP SP2
> > > > PYTHON: 2.4.4
> > > > MOD_PYTHON: mod_python-3.3.1.win32-py2.4-Apache2.0
> > > > APACHE: Apache 2.0.59 (yes, its from a installer i didnt compile it
> > >myself)
> > > > WHY DO I WANT MOD_PYTHON: To install the project management tool 
>Trac
> > > >
> > > > FIRST PROBLEM:
> > > > Now i had Apache 2.2, mod_python-3.3.1.win32-py2.4-Apache2.2, python 
>2.4
> > > > installed.
> > > > Everytime i entered "LoadModule python_module modules/mod_python.so" 
>my
> > > > apache wouldnt start. There was no error specified in the apache 
>monitor
> > > > only said "Error", and there was no special error specified in 
>apcahes
> > >Error
> > > > log either, not any "couldnt find/load module" or anything.
> > >
> > >Did you run Apache installer as Administrator?
> > >
> > >How are you starting Apache? Are you starting it as yourself directly,
> > >or as an Apache service?
> > >
> > > > HOW DID I SOLVE THE FIRST PROBLEM:
> > > > I really did not solve it, or maybe? First i couldnt even launch 
>apache
> > > > 2.0.59 when adding "LoadModule ...." but then i thought, why not try
> > > > downgrading and make clean install once more and so i did. I 
>unistalled
> > > > apache 2.2 and mod_python installed clean apache 2.0.59 and 
>mod_python,
> > > > restarted my computer and it worked. Now i could load the module 
>without
> > > > apache screaming about a Error. Though i directly ran into next 
>problem
> > >but
> > > > at least i got somewhere.
> > > > So note that BEFORE i restarted my computer i also added:
> > > >
> > > > Well i simply added some paths to the PATH variable (Right click 
>your
> > >"My
> > > > computer" -> Properties -> Advanced -> Enviorment Variables -> find 
>PATH
> > >i
> > > > list -> add directorys where python is installed)
> > > >
> > > > I never tried these settings with Apache 2.2 since i didnt 
>understand
> > >that
> > > > restarting was needed.
> > > > Also maybe this didnt solve my problem, maybe it was something else? 
>And
> > > > thats just exaclty the reason why im staying at 2.0.59 now when i 
>got it
> > > > working instead of going back to 2.2 and getting that error again.
> > > >
> > > > SECOND PROBLEM:
> > > > Well, now i got apache 2.0.59, mod_python 3.3.1 read my settings on 
>top
> > >of
> > > > the mail for more detaild information about my system as it is now. 
>Now
> > >i
> > > > can run apache when LoadModule is uncommented in httpd.conf but i 
>cant
> > >use
> > > > python at all. When i add:
> > > >
> > > > <Location /mpinfo>
> > > >    SetHandler mod_python
> > > >    PythonInterpreter main_interpreter
> > > >    PythonHandler mod_python.testhandler
> > > > </Location>
> > > >
> > > > and then try to access localhost/mpinfo the server gives me a 
>internal
> > >error
> > > > (500).
> > > > My Apache error log says:
> > > >
> > > > [Thu Aug 16 12:13:07 2007] [error] make_obcallback: could not import
> > > > mod_python.apache.\n
> > > > [Thu Aug 16 12:13:07 2007] [error] make_obcallback: Python path 
>being
> > >used
> > > > "['H:\\\\install\\\\Python24\\\\python24.zip', '.\\\\DLLs', 
>'.\\\\lib',
> > > > '.\\\\lib\\\\plat-win', '.\\\\lib\\\\lib-tk',
> > >
> > >Where this is wrong is that the actual directory where the Python
> > >stuff is meant to be has been replaced with '.'. That this is wrong
> > >means that site.py file probably isn't being found and as a result
> > >site-packages not being added automatically and so can't find
> > >mod_python. Why the path would have '.' I don't know.
> > >
> > >If you can set environment variable:
> > >
> > >   PYTHONVERBOSE=1
> > >
> > >before you start Apache, you may be able to coax Python to output more
> > >verbose information and you might see error about not finding site.py
> > >file.
> > >
> > > > 'H:\\\\install\\\\Apache2\\\\bin']".
> > > > [Thu Aug 16 12:13:07 2007] [error] get_interpreter: no interpreter
> > >callback
> > > > found.
> > > > [Thu Aug 16 12:13:07 2007] [error] [client 127.0.0.1] 
>python_handler:
> > >Can't
> > > > get/create interpreter.
> > > >
> > > > And on STARTUP of the apache it also seems to be a little error:
> > > >
> > > > [Thu Aug 16 11:25:14 2007] [notice] Apache/2.0.59 (Win32) DAV/2
> > >SVN/1.4.4
> > > > configured -- resuming normal operations
> > > > [Thu Aug 16 11:25:14 2007] [notice] Server built: Jul 27 2006 
>15:55:03
> > > > [Thu Aug 16 11:25:14 2007] [notice] Parent: Created child process 
>520
> > > > [Thu Aug 16 11:25:14 2007] [error] python_init: Python version 
>mismatch,
> > > > expected '2.4.3', found '2.4.4'.
> > > > [Thu Aug 16 11:25:14 2007] [error] python_init: Python executable 
>found
> > > > 'H:\\install\\Apache2\\bin\\Apache.exe'.
> > > > [Thu Aug 16 11:25:14 2007] [error] python_init: Python path being 
>used
> > > >
> > 
> >'H:\\install\\Python24\\python24.zip;.\\DLLs;.\\lib;.\\lib\\plat-win;.\\lib\\lib-tk;H:\\install\\Apache2\\bin'.
> > > > [Thu Aug 16 11:25:14 2007] [notice] mod_python: Creating 8 session
> > >mutexes
> > > > based on 0 max processes and 250 max threads.
> > > > [Thu Aug 16 11:25:14 2007] [notice] Child 520: Child process is 
>running
> > > > [Thu Aug 16 11:25:14 2007] [notice] Child 520: Acquired the start 
>mutex.
> > > > [Thu Aug 16 11:25:14 2007] [notice] Child 520: Starting 250 worker
> > >threads.
> > > >
> > > > If anyone could help me out with my last error i would be really
> > >thankful
> > > > since i have tried to do this for several hours now. I feel really
> > > > disapointed and tired of just trying and trying, thats why i mail in
> > >this
> > > > mail list.
> > >
> > >If you get totally frustrated and want to try something different,
> > >have a go at mod_wsgi instead of mod_python. :-)
> > >
> > > > Some other information that might be useful: (This is how i have it 
>now,
> > > > when apache 2.0.59 is "sort of" working:
> > > >
> > > > CURRENT "PATH" VARIABLE:
> > > >
> > > >
> > 
> >........;H:\install\Python24;H:\install\Subversion\bin;H:\install\Python24\DLLs;H:\install\Python24\Lib;H:\install\Python24\Lib\lib-tk;H:\install\Python24\Lib\site-packages;H:\install\Python24\Lib\site-packages\mod_python
> > > >
> > > > NOTE: Even though i have entered: Lib\site-packages\mod_python etc. 
>It
> > > > doesnet show this in the error log. It only shows DLLs, Lib, lib-tk, 
>and
> > >so
> > > > on? Why is that? I have tried restarting but this time it isnt 
>changing?
> > > > Maybe i must reinstall apache when these settigns are set?
> > > >
> > > > CURRENT REGISTRY SETTINGS:
> > > >
> > > > This is my "PythonPath" in the registry, i have tried adding
> > > > "...site-packages\\mod_python" here as well.
> > > >
> > > > Windows Registry Editor Version 5.00
> > > >
> > > > [HKEY_CURRENT_USER\Software\Python\PythonCore\2.4\PythonPath]
> > > >
> > 
> >@="H:\\install\\Python24\\Lib;H:\\install\\Python24\\DLLs;H:\\install\\Python24\\Lib\\lib-tk;H:\\install\\Python24\\Lib\\site-packages;H:\\install\\Python24\\Lib\\site-packages\\mod_python"
> > >
> > >Did you run Python installer as Administrator? Suggestions made by
> > >people in past gave:
> > >
> > >[HKEY_LOCAL_MACHINE\SOFTWARE\Python\PythonCore\2.5\PythonPath]
> > >@="<path to python>\\Lib;<path to python>\\DLLs;<path to
> > >python>\\Lib\\lib-tk"
> > >
> > >Check KEY_LOCAL_MACHINE to see if there are entries there and post
> > >what they are. If they are missing or wrong and running Apache as
> > >service, might be bypassing your user entries and thus end up with
> > >wrong directories.
> > >
> > > > Now, if there are any more details you think i should provide then
> > >please
> > > > let me know, i will gladly provide the information if im able to!
> > > > Im not the best on installing these actually advanced 
>programs/modules.
> > > > Installing Trac has been a nightmare for me. Either that wont work 
>or
> > >that,
> > > > trac has really succeeded in making the worlds most difficult 
>install if
> > >you
> > > > ask me ;).
> > >
> > >You might also have a read of thread:
> > >
> > >
> > 
> >http://groups.google.com/group/modwsgi/browse_thread/thread/16242447b5890e96
> > >
> > >This was for mod_wsgi instead of mod_python, but it gives a whole
> > >bunch of other registry entries which I don't know are relevant or
> > >not.
> > >
> > >Maybe a Windows person can make more sense of this than me. I don't
> > >use Windows for this stort of stuff.
> > >
> > >Graham
> > >
> > > > Thank you for reading!
> > > >
> > > > Best Regards Jacob Carlsson
> > > >
> > > > >From: "Graham Dumpleton" <graham.dumpleton@gmail.com>
> > > > >To: "Colin Bean" <ccbean@gmail.com>
> > > > >CC: "Jacob Carlsson" <jagge_90@hotmail.com>, list
> > > > ><mod_python@modpython.org>
> > > > >Subject: Re: [mod_python] Apache wont load/start...
> > > > >Date: Thu, 16 Aug 2007 08:19:16 +1000
> > > > >
> > > > >On 16/08/07, Colin Bean <ccbean@gmail.com> wrote:
> > > > > > Try following the links from this message, they seem to address 
>the
> > > > > > same problem:
> > > > > >
> > > > > > 
>http://www.modpython.org/pipermail/mod_python/2007-June/023861.html
> > > > >
> > > > >Actually, possibly don't pay too much attention to that post about
> > > > >adding site-packages as it isn't meant to be listed in the registry
> > > > >entries to begin with. The site-packages directory is only added 
>when
> > > > >the Python site.py file has been loaded. This was only brought to 
>my
> > > > >attention recently when working out Windows issues with mod_wsgi.
> > > > >
> > > > >Thus, if mod_python code modules not being found, more likely to be
> > > > >that correct site.py file isn't being found at startup. This can 
>occur
> > > > >because of access permissions on files if Apache is run as a 
>service
> > > > >and thus a different user. Thus, very important to install
> > > > >Apache/Python/mod_python as administrator so file permissions are
> > > > >okay, DLLs are in system directories and so registry entries setup 
>for
> > > > >machine and not just user.
> > > > >
> > > > >Problems can also arise where you have installed multiple versions 
>of
> > > > >Python and the first one found in PATH is not the same version that
> > > > >mod_python requires. This can occur from installing multiple Python
> > > > >versions explicitly, or can be done inadvertently as there are now 
>a
> > > > >number of Windows applications which provide their own copy of 
>Python.
> > > > >If the Python version from such an application is found in PATH 
>first
> > > > >it can screw everything up. If this Python version was found first
> > > > >when installing mod_python, can also mean that mod_python Python 
>code
> > > > >files were installed in wrong location and not where Python used by
> > > > >Apache is looking. There can also be a problem where real Python 
>was
> > > > >installed as administrator and the application version as normal 
>user,
> > > > >as the application version may put entries in user registry entries
> > > > >and shadow those for machine.
> > > > >
> > > > >I stress though what has already been said, it is vitally important 
>to
> > > > >see what is being logged in the Apache error logs so the reason can 
>be
> > > > >determined.
> > > > >
> > > > >As to not seeing solutions to previous posts, it is generally 
>because
> > > > >people having problems don't explain problems very well and in 
>enough
> > > > >detail. As a consequence we repeat all the commonly suspected 
>issues,
> > > > >such as above. The OP somehow then solves his problem and then 
>doesn't
> > > > >bother responding to say what the problem was and how they fixed 
>it.
> > > > >As a consequence we never learn anything about what the actual 
>problem
> > > > >was and are never able to improve our troubleshooting suggestions.
> > > > >
> > > > >So, please provide details about log messages and help us by 
>feeding
> > > > >back whatever information seems pertinent and how you may have 
>solved
> > > > >the problem.
> > > > >
> > > > >Thanks.
> > > > >
> > > > >Graham
> > > > >
> > > > > > Past that I'm probably not going to be of much help as I don't 
>use
> > > > > > mod_python on windows...
> > > > > > Just to clarify, you are using the installer compiled for apache
> > > > > > 2.0.x, correct?  I'm guessing so, as I doubt you would have 
>gotten
> > > > > > this far otherwise.
> > > > > >
> > > > > > Take care,
> > > > > > Colin
> > > > > >
> > > > > > On 8/15/07, Jacob Carlsson <jagge_90@hotmail.com> wrote:
> > > > > > > Hey!
> > > > > > >
> > > > > > > Thank you for your fast answer!
> > > > > > >
> > > > > > > There was no errors in the log. Thats why it was so weird. 
>While i
> > > > >waited
> > > > > > > for an answer i downgraded my apache to 2.0.59 again and 
>entered
> > >my
> > > > >python
> > > > > > > installation path in the PATH variable. And when i restarted 
>my
> > > > >computer it
> > > > > > > started up fine despite i had entered "LoadModule 
>python_module
> > >...".
> > > > >But
> > > > > > > still it dont work and gives me alot of errors. I'll post my 
>log:
> > > > > > >
> > > > > > >
> > > > > > >
> > > > > > > [Wed Aug 15 21:00:47 2007] [notice] Apache/2.0.59 (Win32) 
>DAV/2
> > > > >SVN/1.4.4
> > > > > > > configured -- resuming normal operations
> > > > > > > [Wed Aug 15 21:00:47 2007] [notice] Server built: Jul 27 2006
> > >15:55:03
> > > > > > > [Wed Aug 15 21:00:47 2007] [notice] Parent: Created child 
>process
> > >4852
> > > > > > > [Wed Aug 15 21:00:48 2007] [error] python_init: Python version
> > > > >mismatch,
> > > > > > > expected '2.4.3', found '2.4.4'.
> > > > > > > [Wed Aug 15 21:00:48 2007] [error] python_init: Python 
>executable
> > > > >found
> > > > > > > 'H:\\install\\Apache2\\bin\\Apache.exe'.
> > > > > > > [Wed Aug 15 21:00:48 2007] [error] python_init: Python path 
>being
> > >used
> > > > > > >
> > > >
> > > 
> >'H:\\install\\Python24\\python24.zip;.\\DLLs;.\\lib;.\\lib\\plat-win;.\\lib\\lib-tk;H:\\install\\Apache2\\bin'.
> > > > > > > [Wed Aug 15 21:00:48 2007] [notice] mod_python: Creating 8 
>session
> > > > >mutexes
> > > > > > > based on 0 max processes and 250 max threads.
> > > > > > > [Wed Aug 15 21:00:48 2007] [notice] Child 4852: Child process 
>is
> > > > >running
> > > > > > > [Wed Aug 15 21:00:48 2007] [notice] Child 4852: Acquired the 
>start
> > > > >mutex.
> > > > > > > [Wed Aug 15 21:00:48 2007] [notice] Child 4852: Starting 250
> > >worker
> > > > >threads.
> > > > > > > [Wed Aug 15 21:00:51 2007] [error] make_obcallback: could not
> > >import
> > > > > > > mod_python.apache.\n
> > > > > > > [Wed Aug 15 21:00:51 2007] [error] make_obcallback: Python 
>path
> > >being
> > > > >used
> > > > > > > "['H:\\\\install\\\\Python24\\\\python24.zip', '.\\\\DLLs',
> > > > >'.\\\\lib',
> > > > > > > '.\\\\lib\\\\plat-win', '.\\\\lib\\\\lib-tk',
> > > > > > > 'H:\\\\install\\\\Apache2\\\\bin']".
> > > > > > > [Wed Aug 15 21:00:51 2007] [error] get_interpreter: no 
>interpreter
> > > > >callback
> > > > > > > found.
> > > > > > > [Wed Aug 15 21:00:51 2007] [error] [client 127.0.0.1]
> > >python_handler:
> > > > >Can't
> > > > > > > get/create interpreter.
> > > > > > >
> > > > > > >
> > > > > > > These last errors comes when i try accessing the following:
> > > > > > >
> > > > > > > <Location /mpinfo>
> > > > > > >    SetHandler mod_python
> > > > > > >    PythonInterpreter main_interpreter
> > > > > > >    PythonHandler mod_python.testhandler
> > > > > > > </Location>
> > > > > > >
> > > > > > > Like what does it mean with "Python version mismatch, expected
> > > > >'2.4.3',
> > > > > > > found '2.4.4'.", expected 2.4.3? How could it expect something
> > >else?
> > > > > > >
> > > > > > > Also i tried entering some more paths into the PATH variable 
>like
> > > > > > > "Lib,lib-tk,DLLs" but it doesent seem enough...
> > > > > > >
> > > > > > > Best Regards Jacob Carlsson
> > > > > > >
> > > > > > > >From: "Colin Bean" <ccbean@gmail.com>
> > > > > > > >To: "Jacob Carlsson" <jagge_90@hotmail.com>
> > > > > > > >CC: mod_python@modpython.org
> > > > > > > >Subject: Re: [mod_python] Apache wont load/start...
> > > > > > > >Date: Wed, 15 Aug 2007 11:08:19 -0700
> > > > > > > >
> > > > > > > >Please post the contents from your Apache error log when you 
>try
> > >to
> > > > > > > >start the server, can't really tell what the problem is from 
>the
> > > > > > > >information you've given.
> > > > > > > >
> > > > > > > >On 8/15/07, Jacob Carlsson <jagge_90@hotmail.com> wrote:
> > > > > > > > > Hello!
> > > > > > > > >
> > > > > > > > > Im using Windows XP.
> > > > > > > > >
> > > > > > > > > I have tried to get apache (both 2.2.4 and 2.0.59 to work 
>with
> > > > > > > >mod_python).
> > > > > > > > > I have python 2.4 and I have tried using
> > > > > > > > > "mod_python-3.2.10.win32-py2.4-apache2.2" &
> > > > > > > > > "mod_python-3.3.1.win32-py2.4-Apache2.2" and also some 
>other
> > > > >different
> > > > > > > > > versions when I tested with apache 2.0.59.
> > > > > > > > >
> > > > > > > > > My problem is that apache simply wont load when i enter
> > > > >"LoadModule
> > > > > > > > > python_module modules/mod_python.so" in httpd.conf.
> > > > > > > > > Now I have tried fixing this in many various ways for 
>hours
> > >and
> > > > >not
> > > > > > > >succeded
> > > > > > > > > at all.
> > > > > > > > > For example I have searched google and your page for 
>answers
> > >and i
> > > > >found
> > > > > > > >out
> > > > > > > > > that some people had the same problem as I but some of 
>their
> > > > >solutions
> > > > > > > >didnt
> > > > > > > > > work out for me.
> > > > > > > > > For example I tried adding python to my "PATH" variable 
>but
> > >that
> > > > >didnt
> > > > > > > >help
> > > > > > > > > much.. Maybe i did it incorrect? I added "C:\Python24" 
>(thats
> > > > >simply
> > > > > > > >where I
> > > > > > > > > installed python)
> > > > > > > > > Also many that have the same problem didnt get an answer 
>that
> > >i
> > > > >could
> > > > > > > >read.
> > > > > > > > >
> > > > > > > > > So i would appreciate any help so i finally can solve this
> > >really
> > > > > > > >annoying
> > > > > > > > > problem!
> > > > > > > > >
> > > > > > > > > Best Regards Jacob Carlsson
> > > > > > > > >
> > > > > > > > >
> > >_________________________________________________________________
> > > > > > > > > Luspank? Tj?na pengar p? auktion http://tradera.msn.se/
> > > > > > > > >
> > > > > > > > > _______________________________________________
> > > > > > > > > Mod_python mailing list
> > > > > > > > > Mod_python@modpython.org
> > > > > > > > > http://mailman.modpython.org/mailman/listinfo/mod_python
> > > > > > > > >
> > > > > > >
> > > > > > > 
>_________________________________________________________________
> > > > > > > Spela roliga Worms'07 i mobilen
> > > > > > > http://msn.cellus.se/?page=game_order&itemId=878908
> > > > > > >
> > > > > > >
> > > > > >
> > > > > > _______________________________________________
> > > > > > Mod_python mailing list
> > > > > > Mod_python@modpython.org
> > > > > > http://mailman.modpython.org/mailman/listinfo/mod_python
> > > > > >
> > > >
> > > > _________________________________________________________________
> > > > Spela roliga Worms'07 i mobilen
> > > > http://msn.cellus.se/?page=game_order&itemId=878908
> > > >
> > > >
> >
> > _________________________________________________________________
> > Se artisterna upptr?da f?r en gr?n planet http://liveearth.se.msn.com/
> >
> >

_________________________________________________________________
Uppt?ck k?rleken p? MSN 
http://match.se.msn.com/channel/index.aspx?trackingid=1002962

From ken.manheimer at gmail.com  Sat Aug 18 13:53:28 2007
From: ken.manheimer at gmail.com (Ken Manheimer)
Date: Sat Aug 18 13:53:44 2007
Subject: [mod_python] stumped by inputfilter infinite repeat
Message-ID: <2cd46e7f0708181053m7f2de1abl3a46b75e7291b596@mail.gmail.com>

hi, all.  i'm using mod_python with a downloads/uploads handler,
tramline ( http://infrae.com/products/tramline ) with a content
management system (plone).  when the tramline input and output filters
are hooked in (using SetInputFilter and SetOutputFilter) and i visit
the zope/plone site via a redirect, i get infinite repeated calls to
the input filter.  (i can observe the this by setting PythonEnablePdb
- from the perspective of the web browser, no page is returned.)  i
can provide more details, and realize that this may be a tramline
problem, but it seems like a behavior that might be familiar to
mod_python experts, so i thought i'd run it by you all first.

things like mpinfo and mptest.py work fine.  visiting the regular,
file-based mockup site yields no problems - only the embedded zope
site, via a rewrite rule:

  RewriteRule ^/testbed(.*)
http://127.0.0.1:8080/VirtualHostBase/http/%{HTTP_HOST}:80/VirtualHostRoot/_vh_testbed/$1
[L,P]

(the elaborate VirtualHostRoot stuff is for a zope virtual hosting provision.)

does any of this sound familiar to anyone?  suggestions about
debugging it?  (stepping through the input and output filters using
PythonEnablePdb yields little or no illumination - they just keep
getting invoked.  i don't know what to look for tracing added to
importer.py FilterDispatch, which i tried instead of using
PythonEnablePdb.)

any help would be appreciated!
-- 
ken manheimer
http://myriadicity.net
From graham.dumpleton at gmail.com  Sat Aug 18 18:49:18 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sat Aug 18 18:49:40 2007
Subject: [mod_python] stumped by inputfilter infinite repeat
In-Reply-To: <2cd46e7f0708181053m7f2de1abl3a46b75e7291b596@mail.gmail.com>
References: <2cd46e7f0708181053m7f2de1abl3a46b75e7291b596@mail.gmail.com>
Message-ID: <88e286470708181549j3cfd9b38sd975581939902007@mail.gmail.com>

Which version of mod_python and Apache are you using?

The Tramline author suspected there existed a problem in mod_python
and/or Apache that caused some issues. They suggest in their
documentation a change that should be made to mod_python, although it
hasn't been done in official releases as it wouldn't seem to be the
correct thing to do. One issue was fixed in filter code in mod_python
in recent versions which may have caused issues, but not the same
change they suggested. They also felt that certain older versions of
Apache may have had some problem.

For some more details see:

  https://issues.apache.org/jira/browse/MODPYTHON-76

Graham

On 19/08/07, Ken Manheimer <ken.manheimer@gmail.com> wrote:
> hi, all.  i'm using mod_python with a downloads/uploads handler,
> tramline ( http://infrae.com/products/tramline ) with a content
> management system (plone).  when the tramline input and output filters
> are hooked in (using SetInputFilter and SetOutputFilter) and i visit
> the zope/plone site via a redirect, i get infinite repeated calls to
> the input filter.  (i can observe the this by setting PythonEnablePdb
> - from the perspective of the web browser, no page is returned.)  i
> can provide more details, and realize that this may be a tramline
> problem, but it seems like a behavior that might be familiar to
> mod_python experts, so i thought i'd run it by you all first.
>
> things like mpinfo and mptest.py work fine.  visiting the regular,
> file-based mockup site yields no problems - only the embedded zope
> site, via a rewrite rule:
>
>   RewriteRule ^/testbed(.*)
> http://127.0.0.1:8080/VirtualHostBase/http/%{HTTP_HOST}:80/VirtualHostRoot/_vh_testbed/$1
> [L,P]
>
> (the elaborate VirtualHostRoot stuff is for a zope virtual hosting provision.)
>
> does any of this sound familiar to anyone?  suggestions about
> debugging it?  (stepping through the input and output filters using
> PythonEnablePdb yields little or no illumination - they just keep
> getting invoked.  i don't know what to look for tracing added to
> importer.py FilterDispatch, which i tried instead of using
> PythonEnablePdb.)
>
> any help would be appreciated!
> --
> ken manheimer
> http://myriadicity.net
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From ken.manheimer at gmail.com  Mon Aug 20 18:39:33 2007
From: ken.manheimer at gmail.com (Ken Manheimer)
Date: Mon Aug 20 18:39:50 2007
Subject: [mod_python] stumped by inputfilter infinite repeat
In-Reply-To: <88e286470708181549j3cfd9b38sd975581939902007@mail.gmail.com>
References: <2cd46e7f0708181053m7f2de1abl3a46b75e7291b596@mail.gmail.com>
	<88e286470708181549j3cfd9b38sd975581939902007@mail.gmail.com>
Message-ID: <2cd46e7f0708201539k3e6a101crd55b4a15ad800266@mail.gmail.com>

On 8/18/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> Which version of mod_python and Apache are you using?
>
> The Tramline author suspected there existed a problem in mod_python
> and/or Apache that caused some issues. They suggest in their
> documentation a change that should be made to mod_python, although it
> hasn't been done in official releases as it wouldn't seem to be the
> correct thing to do. One issue was fixed in filter code in mod_python
> in recent versions which may have caused issues, but not the same
> change they suggested. They also felt that certain older versions of
> Apache may have had some problem.
>
> For some more details see:
>
>   https://issues.apache.org/jira/browse/MODPYTHON-76

thanks much, graham, for your reply.  i did know about the need to
inihbit filter.flush() - it's described in the tramline install
instructions.  i also factored tramline completely out of the picture,
reproducing the behavior using instead some trivial artifical
inputfilter and outputfilter functions:

  def inputfilter(filter):
      "stub input filter"
      filter.req.log_error("klm input filter")

  def outputfilter(filter):
      "stub output filter"
      filter.req.log_error("klm output filter")

running without pdb enabled but through the rewrite rule i mentioned
earlier, to Zope, yields an infinite stream of the "klm input filter"
messages, and no "klm output filter" ones.  (the problem does *not*
happen when the Zope backend is not running.)

i did reread the bug report, and it occurred to me to try the current
apache svn version, as the bug report mentions - an off chance,
though, since the features of the svn version around the time of the
bug report should have seen released by now.  unfortunately, that
works worse.  i'm getting a fatal error trying to run the latest svn
version with mod_python installed:

httpd: Syntax error on line 116 of /usr/local/apache2/conf/httpd.conf:
Cannot load /usr/local/apache2/modules/mod_python.so into server:
/usr/local/apache2/modules/mod_python.so: undefined symbol:
ap_requires
err 1:  2811  /usr/local/apache2/bin/apachectl configtest

this obstacle on obstacle is discouraging.  a google search reveals no
other reports of this particular error, and i have no reason to be
confident that getting it working would actually improve the original
inputfilter problem.  i plan to inquire on the tramline and plone
lists for alternatives.  i am interested to hear insights on this, but
think i'm better off pursuing other avenues (there's some alpha plone
accommodations for blobs in the zodb), and if that works, giving up on
mod_python.

i did solve one interesting incidental problem along the way, that
might be of value to someone else.  when the interminable inputfilter
invocation is happening i have to kill apache with a KILL signal (9).
doing that lead to mutex leaks, soon leading to apache start failures,
with an error_log complaint like this:

[Fri Aug 17 12:00:00 2007] [error] (28)No space left on device:
mod_python: Failed to create global mutex 0 of 32 (/tmp/mpmtx125450).

investigating, i learned about ipcs to report semaphores and ipcrm to
remove them, and created a little script that did the job for me:

ipcs -s | while read key id garbage; do
  case "$id" in
    [0-9]* ) echo -n "$id "
             ipcrm -s $id;;
    * ) : ;;
  esac
done

handy.

also, in case anyone still thinks attention to mod_python and tramline
is worthwhile, here are my web server details, from mod_python's
mpinfo:

  Apache/2.2.4 (Unix) mod_ssl/2.2.4  OpenSSL/0.9.7a  DAV/2  mod_python/3.3.1
  Python/2.4.3

and host server os and hardware: linux kernel 2.6.9-42.ELsmp on an AMD
Athlon 64 X2
Dual Core Processor 4200+.  (it's actually running redhat 4.1, alas.)

-- 
ken
http://myriadicity.net

> On 19/08/07, Ken Manheimer <ken.manheimer@gmail.com> wrote:
> > hi, all.  i'm using mod_python with a downloads/uploads handler,
> > tramline ( http://infrae.com/products/tramline ) with a content
> > management system (plone).  when the tramline input and output filters
> > are hooked in (using SetInputFilter and SetOutputFilter) and i visit
> > the zope/plone site via a redirect, i get infinite repeated calls to
> > the input filter.  (i can observe the this by setting PythonEnablePdb
> > - from the perspective of the web browser, no page is returned.)  i
> > can provide more details, and realize that this may be a tramline
> > problem, but it seems like a behavior that might be familiar to
> > mod_python experts, so i thought i'd run it by you all first.
> >
> > things like mpinfo and mptest.py work fine.  visiting the regular,
> > file-based mockup site yields no problems - only the embedded zope
> > site, via a rewrite rule:
> >
> >   RewriteRule ^/testbed(.*)
> > http://127.0.0.1:8080/VirtualHostBase/http/%{HTTP_HOST}:80/VirtualHostRoot/_vh_testbed/$1
> > [L,P]
> >
> > (the elaborate VirtualHostRoot stuff is for a zope virtual hosting provision.)
> >
> > does any of this sound familiar to anyone?  suggestions about
> > debugging it?  (stepping through the input and output filters using
> > PythonEnablePdb yields little or no illumination - they just keep
> > getting invoked.  i don't know what to look for tracing added to
> > importer.py FilterDispatch, which i tried instead of using
> > PythonEnablePdb.)
> >
> > any help would be appreciated!
From graham.dumpleton at gmail.com  Mon Aug 20 18:57:50 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Aug 20 18:58:20 2007
Subject: [mod_python] stumped by inputfilter infinite repeat
In-Reply-To: <2cd46e7f0708201539k3e6a101crd55b4a15ad800266@mail.gmail.com>
References: <2cd46e7f0708181053m7f2de1abl3a46b75e7291b596@mail.gmail.com>
	<88e286470708181549j3cfd9b38sd975581939902007@mail.gmail.com>
	<2cd46e7f0708201539k3e6a101crd55b4a15ad800266@mail.gmail.com>
Message-ID: <88e286470708201557u39337615ubed1ab010208192f@mail.gmail.com>

On 21/08/07, Ken Manheimer <ken.manheimer@gmail.com> wrote:
> On 8/18/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > Which version of mod_python and Apache are you using?
> >
> > The Tramline author suspected there existed a problem in mod_python
> > and/or Apache that caused some issues. They suggest in their
> > documentation a change that should be made to mod_python, although it
> > hasn't been done in official releases as it wouldn't seem to be the
> > correct thing to do. One issue was fixed in filter code in mod_python
> > in recent versions which may have caused issues, but not the same
> > change they suggested. They also felt that certain older versions of
> > Apache may have had some problem.
> >
> > For some more details see:
> >
> >   https://issues.apache.org/jira/browse/MODPYTHON-76
>
> thanks much, graham, for your reply.  i did know about the need to
> inihbit filter.flush() - it's described in the tramline install
> instructions.  i also factored tramline completely out of the picture,
> reproducing the behavior using instead some trivial artifical
> inputfilter and outputfilter functions:
>
>   def inputfilter(filter):
>       "stub input filter"
>       filter.req.log_error("klm input filter")
>
>   def outputfilter(filter):
>       "stub output filter"
>       filter.req.log_error("klm output filter")
>
> running without pdb enabled but through the rewrite rule i mentioned
> earlier, to Zope, yields an infinite stream of the "klm input filter"
> messages, and no "klm output filter" ones.  (the problem does *not*
> happen when the Zope backend is not running.)

As I would expect, as the input filter is neither consuming the data
or passing it on. Try something like:

from mod_python import apache

def inputfilter(filter):

    s = filter.read()
    while s:
        filter.write(s)
        s = filter.read()

    if s is None:
        filter.close()

Similar for output filter.

> i did reread the bug report, and it occurred to me to try the current
> apache svn version, as the bug report mentions - an off chance,
> though, since the features of the svn version around the time of the
> bug report should have seen released by now.  unfortunately, that
> works worse.  i'm getting a fatal error trying to run the latest svn
> version with mod_python installed:
>
> httpd: Syntax error on line 116 of /usr/local/apache2/conf/httpd.conf:
> Cannot load /usr/local/apache2/modules/mod_python.so into server:
> /usr/local/apache2/modules/mod_python.so: undefined symbol:
> ap_requires
> err 1:  2811  /usr/local/apache2/bin/apachectl configtest

Do you have multiple versions of Apache on your system? This error
suggest the mod_python source code has been compiled against a
different version of Apache than you are trying to use it with.

> this obstacle on obstacle is discouraging.  a google search reveals no
> other reports of this particular error, and i have no reason to be
> confident that getting it working would actually improve the original
> inputfilter problem.  i plan to inquire on the tramline and plone
> lists for alternatives.  i am interested to hear insights on this, but
> think i'm better off pursuing other avenues (there's some alpha plone
> accommodations for blobs in the zodb), and if that works, giving up on
> mod_python.
>
> i did solve one interesting incidental problem along the way, that
> might be of value to someone else.  when the interminable inputfilter
> invocation is happening i have to kill apache with a KILL signal (9).
> doing that lead to mutex leaks, soon leading to apache start failures,
> with an error_log complaint like this:
>
> [Fri Aug 17 12:00:00 2007] [error] (28)No space left on device:
> mod_python: Failed to create global mutex 0 of 32 (/tmp/mpmtx125450).

You need to make sure you kill off the zombie Apache parent processes
as well if any exist. It will only be when they have gone that the
mutexes will be released.

> investigating, i learned about ipcs to report semaphores and ipcrm to
> remove them, and created a little script that did the job for me:
>
> ipcs -s | while read key id garbage; do
>   case "$id" in
>     [0-9]* ) echo -n "$id "
>              ipcrm -s $id;;
>     * ) : ;;
>   esac
> done
>
> handy.

Hmmm, wont this be dangerous if something is using them. Things other
than Apache use these things.

Graham

> also, in case anyone still thinks attention to mod_python and tramline
> is worthwhile, here are my web server details, from mod_python's
> mpinfo:
>
>   Apache/2.2.4 (Unix) mod_ssl/2.2.4  OpenSSL/0.9.7a  DAV/2  mod_python/3.3.1
>   Python/2.4.3
>
> and host server os and hardware: linux kernel 2.6.9-42.ELsmp on an AMD
> Athlon 64 X2
> Dual Core Processor 4200+.  (it's actually running redhat 4.1, alas.)
>
> --
> ken
> http://myriadicity.net
>
> > On 19/08/07, Ken Manheimer <ken.manheimer@gmail.com> wrote:
> > > hi, all.  i'm using mod_python with a downloads/uploads handler,
> > > tramline ( http://infrae.com/products/tramline ) with a content
> > > management system (plone).  when the tramline input and output filters
> > > are hooked in (using SetInputFilter and SetOutputFilter) and i visit
> > > the zope/plone site via a redirect, i get infinite repeated calls to
> > > the input filter.  (i can observe the this by setting PythonEnablePdb
> > > - from the perspective of the web browser, no page is returned.)  i
> > > can provide more details, and realize that this may be a tramline
> > > problem, but it seems like a behavior that might be familiar to
> > > mod_python experts, so i thought i'd run it by you all first.
> > >
> > > things like mpinfo and mptest.py work fine.  visiting the regular,
> > > file-based mockup site yields no problems - only the embedded zope
> > > site, via a rewrite rule:
> > >
> > >   RewriteRule ^/testbed(.*)
> > > http://127.0.0.1:8080/VirtualHostBase/http/%{HTTP_HOST}:80/VirtualHostRoot/_vh_testbed/$1
> > > [L,P]
> > >
> > > (the elaborate VirtualHostRoot stuff is for a zope virtual hosting provision.)
> > >
> > > does any of this sound familiar to anyone?  suggestions about
> > > debugging it?  (stepping through the input and output filters using
> > > PythonEnablePdb yields little or no illumination - they just keep
> > > getting invoked.  i don't know what to look for tracing added to
> > > importer.py FilterDispatch, which i tried instead of using
> > > PythonEnablePdb.)
> > >
> > > any help would be appreciated!
>
From ken.manheimer at gmail.com  Mon Aug 20 20:19:21 2007
From: ken.manheimer at gmail.com (Ken Manheimer)
Date: Mon Aug 20 20:19:36 2007
Subject: [mod_python] stumped by inputfilter infinite repeat
In-Reply-To: <88e286470708201557u39337615ubed1ab010208192f@mail.gmail.com>
References: <2cd46e7f0708181053m7f2de1abl3a46b75e7291b596@mail.gmail.com>
	<88e286470708181549j3cfd9b38sd975581939902007@mail.gmail.com>
	<2cd46e7f0708201539k3e6a101crd55b4a15ad800266@mail.gmail.com>
	<88e286470708201557u39337615ubed1ab010208192f@mail.gmail.com>
Message-ID: <2cd46e7f0708201719u379ebf6m1b5b49d9aa750e69@mail.gmail.com>

On 8/20/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> On 21/08/07, Ken Manheimer <ken.manheimer@gmail.com> wrote:
> > On 8/18/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > > Which version of mod_python and Apache are you using?
> > >
> > > The Tramline author suspected there existed a problem in mod_python
> > > and/or Apache that caused some issues. They suggest in their
> > > documentation a change that should be made to mod_python, although it
> > > hasn't been done in official releases as it wouldn't seem to be the
> > > correct thing to do. One issue was fixed in filter code in mod_python
> > > in recent versions which may have caused issues, but not the same
> > > change they suggested. They also felt that certain older versions of
> > > Apache may have had some problem.
> > >
> > > For some more details see:
> > >
> > >   https://issues.apache.org/jira/browse/MODPYTHON-76
> >
> > thanks much, graham, for your reply.  i did know about the need to
> > inihbit filter.flush() - it's described in the tramline install
> > instructions.  i also factored tramline completely out of the picture,
> > reproducing the behavior using instead some trivial artifical
> > inputfilter and outputfilter functions:
> >
> >   def inputfilter(filter):
> >       "stub input filter"
> >       filter.req.log_error("klm input filter")
> >
> >   def outputfilter(filter):
> >       "stub output filter"
> >       filter.req.log_error("klm output filter")
> >
> > running without pdb enabled but through the rewrite rule i mentioned
> > earlier, to Zope, yields an infinite stream of the "klm input filter"
> > messages, and no "klm output filter" ones.  (the problem does *not*
> > happen when the Zope backend is not running.)
>
> As I would expect, as the input filter is neither consuming the data
> or passing it on. Try something like:
>
> from mod_python import apache
>
> def inputfilter(filter):
>
>     s = filter.read()
>     while s:
>         filter.write(s)
>         s = filter.read()
>
>     if s is None:
>         filter.close()
>
> Similar for output filter.

hmm!

the lack of any input handling in my routine was really dumb.  but in
any case, this may point to something that gets tramline working.

the tramline input filter is intended to only intervene for main POST
requests that consist of multipart/form-data.  for other requests it
would do a filter.pass_on() and return:

    def inputfilter(filter):
        # we're done if we're in a subrequest
        if filter.req.main is not None:
            filter.pass_on()
            return

        # we only handle POST requests
        if filter.req.method != 'POST':
            filter.pass_on()
            return

        # we only handle multipart/form-data
        enctype = filter.req.headers_in.get('Content-Type')
        if enctype[:19] != 'multipart/form-data':
            filter.pass_on()
            return

        [do some real stuff, otherwise]

i the assume that the filter.pass_on() was supposed to do the right
thing, but i tried that in my stub filters (after confirming that your
filter.read()/filter.write() handling did in fact work, graham), and
it didn't.  so i replaced the above with:

    def inputfilter(filter):

        enctype = filter.req.headers_in.get('Content-Type')
        if ((filter.req.main is not None)   # we are in a subrequest
            or (filter.req.method != 'POST')# this is not a POST
request
            or (enctype[:19] != 'multipart/form-data')): # not
multipart/form-data:
            s = filter.read()
            while s:
                filter.write(s)
                s = filter.read()
            if s is None:
                filter.close()
            return

        [do some real stuff, otherwise]

and i don't get the hang.  i have to test the intended tramline
operation, and don't understand enough yet about it or mod_python
filters to be confident that i have something right, but at least i
have something to work with now!

can you say why the filter.pass_on() is not sufficient, by the way?
even with and added filter.flush() the infinite repeat still happens.

> > i did reread the bug report, and it occurred to me to try the current
> > apache svn version, as the bug report mentions - an off chance,
> > though, since the features of the svn version around the time of the
> > bug report should have seen released by now.  unfortunately, that
> > works worse.  i'm getting a fatal error trying to run the latest svn
> > version with mod_python installed:
> >
> > httpd: Syntax error on line 116 of /usr/local/apache2/conf/httpd.conf:
> > Cannot load /usr/local/apache2/modules/mod_python.so into server:
> > /usr/local/apache2/modules/mod_python.so: undefined symbol:
> > ap_requires
> > err 1:  2811  /usr/local/apache2/bin/apachectl configtest
>
> Do you have multiple versions of Apache on your system? This error
> suggest the mod_python source code has been compiled against a
> different version of Apache than you are trying to use it with.

now that i have something to work with using the current apache
version (which i put back in place from a tarball i created before
trying the install of the svn version), i don't need to resolve the
svn version problems.  still, here are the details:

i do have an older installation, but i'm not running it, and i build
(configure) mod_python with the apxs of the new version.  checked that
a bunch of times, and examined config.status, besides.

  ./configure --with-apxs=/usr/local/apache2/bin/apxs
--with-python=/usr/local/bin/python2.4 --with-max-locks=32

i've been running a version of apache2 out of /usr/local/apache2 for a
few months, though with very light use.  i actually deleted the older
apache2 installation before installing the svn checkout one, to avoid
cross-version contamination.

> > this obstacle on obstacle is discouraging.  a google search reveals no
> > other reports of this particular error, and i have no reason to be
> > confident that getting it working would actually improve the original
> > inputfilter problem.  i plan to inquire on the tramline and plone
> > lists for alternatives.  i am interested to hear insights on this, but
> > think i'm better off pursuing other avenues (there's some alpha plone
> > accommodations for blobs in the zodb), and if that works, giving up on
> > mod_python.
> >
> > i did solve one interesting incidental problem along the way, that
> > might be of value to someone else.  when the interminable inputfilter
> > invocation is happening i have to kill apache with a KILL signal (9).
> > doing that lead to mutex leaks, soon leading to apache start failures,
> > with an error_log complaint like this:
> >
> > [Fri Aug 17 12:00:00 2007] [error] (28)No space left on device:
> > mod_python: Failed to create global mutex 0 of 32 (/tmp/mpmtx125450).
>
> You need to make sure you kill off the zombie Apache parent processes
> as well if any exist. It will only be when they have gone that the
> mutexes will be released.

i am usually running apache in non-daemon mode, in order to interact
with the pdb session, when this happens:

  /usr/local/apache2/bin/httpd -k start -X -DONE_PROCESS

^C or default kill signal doesn't kill it.  no other httpd processes
exist.  i don't think the problem is due to running in the foreground,
however - i think the server is blocking on some kind of IO.  it
happens whether or not PythonDebugPdb is set, but it doesn't happen
when i do a regular apachectl start - then killing the lead httpd
processes results in an eventual KILL signal from some supervisor.
the mutex leaks don't happen then.

> > investigating, i learned about ipcs to report semaphores and ipcrm to
> > remove them, and created a little script that did the job for me:
> >
> > ipcs -s | while read key id garbage; do
> >   case "$id" in
> >     [0-9]* ) echo -n "$id "
> >              ipcrm -s $id;;
> >     * ) : ;;
> >   esac
> > done
> >
> > handy.
>
> Hmmm, wont this be dangerous if something is using them. Things other
> than Apache use these things.

whoops again.  i have an exclusive-use machine, for now, and was
taking that overmuch for granted.

this should be a better focused approach, though still requires
caution, since it will screw over a properly running apache.  (it
removes the mutexes owned by the apache user, which is the one i'm
using.)

trash_mutexes () {
  ipcs -s | while read key id owner garbage; do
    case "$owner" in
      apache ) echo -n "$id "
               ipcrm -s $id;;
      * ) : ;;
    esac
  done
}

the important thing is that i have something to go on with tramline,
even if it's not quite right, yet.  thanks much!

ken

> > also, in case anyone still thinks attention to mod_python and tramline
> > is worthwhile, here are my web server details, from mod_python's
> > mpinfo:
> >
> >   Apache/2.2.4 (Unix) mod_ssl/2.2.4  OpenSSL/0.9.7a  DAV/2  mod_python/3.3.1
> >   Python/2.4.3
> >
> > and host server os and hardware: linux kernel 2.6.9-42.ELsmp on an AMD
> > Athlon 64 X2
> > Dual Core Processor 4200+.  (it's actually running redhat 4.1, alas.)
> >
> > --
> > ken
> > http://myriadicity.net
> >
> > > On 19/08/07, Ken Manheimer <ken.manheimer@gmail.com> wrote:
> > > > hi, all.  i'm using mod_python with a downloads/uploads handler,
> > > > tramline ( http://infrae.com/products/tramline ) with a content
> > > > management system (plone).  when the tramline input and output filters
> > > > are hooked in (using SetInputFilter and SetOutputFilter) and i visit
> > > > the zope/plone site via a redirect, i get infinite repeated calls to
> > > > the input filter.  (i can observe the this by setting PythonEnablePdb
> > > > - from the perspective of the web browser, no page is returned.)  i
> > > > can provide more details, and realize that this may be a tramline
> > > > problem, but it seems like a behavior that might be familiar to
> > > > mod_python experts, so i thought i'd run it by you all first.
> > > >
> > > > things like mpinfo and mptest.py work fine.  visiting the regular,
> > > > file-based mockup site yields no problems - only the embedded zope
> > > > site, via a rewrite rule:
> > > >
> > > >   RewriteRule ^/testbed(.*)
> > > > http://127.0.0.1:8080/VirtualHostBase/http/%{HTTP_HOST}:80/VirtualHostRoot/_vh_testbed/$1
> > > > [L,P]
> > > >
> > > > (the elaborate VirtualHostRoot stuff is for a zope virtual hosting provision.)
> > > >
> > > > does any of this sound familiar to anyone?  suggestions about
> > > > debugging it?  (stepping through the input and output filters using
> > > > PythonEnablePdb yields little or no illumination - they just keep
> > > > getting invoked.  i don't know what to look for tracing added to
> > > > importer.py FilterDispatch, which i tried instead of using
> > > > PythonEnablePdb.)
> > > >
> > > > any help would be appreciated!
From graham.dumpleton at gmail.com  Mon Aug 20 20:25:56 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Aug 20 20:26:06 2007
Subject: [mod_python] stumped by inputfilter infinite repeat
In-Reply-To: <2cd46e7f0708201719u379ebf6m1b5b49d9aa750e69@mail.gmail.com>
References: <2cd46e7f0708181053m7f2de1abl3a46b75e7291b596@mail.gmail.com>
	<88e286470708181549j3cfd9b38sd975581939902007@mail.gmail.com>
	<2cd46e7f0708201539k3e6a101crd55b4a15ad800266@mail.gmail.com>
	<88e286470708201557u39337615ubed1ab010208192f@mail.gmail.com>
	<2cd46e7f0708201719u379ebf6m1b5b49d9aa750e69@mail.gmail.com>
Message-ID: <88e286470708201725k4d730266l3500339a2cfca9e0@mail.gmail.com>

On 21/08/07, Ken Manheimer <ken.manheimer@gmail.com> wrote:
> hmm!
>
> the lack of any input handling in my routine was really dumb.  but in
> any case, this may point to something that gets tramline working.
>
> the tramline input filter is intended to only intervene for main POST
> requests that consist of multipart/form-data.  for other requests it
> would do a filter.pass_on() and return:
>
>     def inputfilter(filter):
>         # we're done if we're in a subrequest
>         if filter.req.main is not None:
>             filter.pass_on()
>             return

I'd be worried about the check of:

  filter.req.main

>From memory this is going to always pass on doing the request if it is
a sub request. A sub request might occur if using mod_rewrite or
Action directives, plus possibly other things.

Put some debug in which dumps out whether req.main is set and then
dump out what main request is, ie., req.main.uri etc. This may give
clues as to what is going on.

Graham

>         # we only handle POST requests
>         if filter.req.method != 'POST':
>             filter.pass_on()
>             return
>
>         # we only handle multipart/form-data
>         enctype = filter.req.headers_in.get('Content-Type')
>         if enctype[:19] != 'multipart/form-data':
>             filter.pass_on()
>             return
>
>         [do some real stuff, otherwise]
>
> i the assume that the filter.pass_on() was supposed to do the right
> thing, but i tried that in my stub filters (after confirming that your
> filter.read()/filter.write() handling did in fact work, graham), and
> it didn't.  so i replaced the above with:
>
>     def inputfilter(filter):
>
>         enctype = filter.req.headers_in.get('Content-Type')
>         if ((filter.req.main is not None)   # we are in a subrequest
>             or (filter.req.method != 'POST')# this is not a POST
> request
>             or (enctype[:19] != 'multipart/form-data')): # not
> multipart/form-data:
>             s = filter.read()
>             while s:
>                 filter.write(s)
>                 s = filter.read()
>             if s is None:
>                 filter.close()
>             return
>
>         [do some real stuff, otherwise]
>
> and i don't get the hang.  i have to test the intended tramline
> operation, and don't understand enough yet about it or mod_python
> filters to be confident that i have something right, but at least i
> have something to work with now!
>
> can you say why the filter.pass_on() is not sufficient, by the way?
> even with and added filter.flush() the infinite repeat still happens.
From wozniak.tomasz.84 at wp.pl  Tue Aug 21 11:27:36 2007
From: wozniak.tomasz.84 at wp.pl (=?ISO-8859-2?Q?Tomasz_Wo=BCniak?=)
Date: Tue Aug 21 11:28:00 2007
Subject: [mod_python] libapache2-mod-python error
In-Reply-To: <200708210022.l7L0LEId000836@modpython.org>
References: <200708210022.l7L0LEId000836@modpython.org>
Message-ID: <46cb04682a56f@wp.pl>

Please help me:
I tried to install apache with mod_python in the Ubuntu. I have done it, 
but instructions in the manual, and wikipedia doesn't work ( I cannot 
run python from the url). Then I tried a lot of things. The last one 
were:
sudo aptitude install python
sudo aptitude install libapache2-mod-python
sudo gedit /etc/apache2/mods-available/mod_python.conf
  AddType application/x-httpd-python .py
  AddHandler mod_python .py
  PythonHandler mod_python.publisher
  PythonDebug On
cd /etc/apache2/mods-enabled
sudo ln -s ../mods-available/mod_python.conf mod_python.conf
sudo /etc/init.d/apache2 restart
But I had libapache2-mod-python error, and i have it whatever I try to 
install...

PLEASE HELP ME!!!
Tomasz Wo?niak

----------------------------------------------------
Raz, dwa, trzy... BUNGEEEE! Zabij nude i skocz z nami na bungee!
Ty wybierasz czas i miejsce, my podpowiadamy jak to zrobi?! Zobacz:
http://klik.wp.pl/?adr=http%3A%2F%2Fadv.reklama.wp.pl%2Fas%2Fbungee.html&sid=1269


From richardlewis at fastmail.co.uk  Tue Aug 21 11:50:40 2007
From: richardlewis at fastmail.co.uk (Richard Lewis)
Date: Tue Aug 21 11:51:04 2007
Subject: [mod_python] libapache2-mod-python error
In-Reply-To: <46cb04682a56f@wp.pl>
References: <200708210022.l7L0LEId000836@modpython.org> <46cb04682a56f@wp.pl>
Message-ID: <200708211650.41678.richardlewis@fastmail.co.uk>

On Tuesday 21 August 2007 16:27:36 Tomasz Wo?niak wrote:
> I tried to install apache with mod_python in the Ubuntu.

I use mod_python in Debian "unstable"

> The last one were: 
> sudo aptitude install python
> sudo aptitude install libapache2-mod-python
> sudo gedit /etc/apache2/mods-available/mod_python.conf
>   AddType application/x-httpd-python .py
>   AddHandler mod_python .py
>   PythonHandler mod_python.publisher
>   PythonDebug On
> cd /etc/apache2/mods-enabled
> sudo ln -s ../mods-available/mod_python.conf mod_python.conf
> sudo /etc/init.d/apache2 restart

Hmm. In Debian there is no mod_python.conf, just mod_python.load. 
This contains one line:

LoadModule python_module /usr/lib/apache2/modules/mod_python.so

> But I had libapache2-mod-python error, and i have it whatever I
> try to install...
>
Are you sure Apache is running? Will it serve a plain HTML page 
correctly? Try:

$ sudo netstat -n -t -l

and make sure there is a service running on port 80:

tcp6     0    0 :::80          :::*         LISTEN

So, what exactly goes wrong? Have you tried a test script? Try 
following the instructions here:

http://www.modpython.org/live/current/doc-html/inst-testing.html

> PLEASE HELP ME!!!

Then ask this again if it still doesn't work.

Cheers,
Richard
-- 
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
Richard Lewis
http://www.richard-lewis.me.uk/
JID: ironchicken@jabber.earth.li
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From aseem at metaweb.com  Tue Aug 21 12:29:50 2007
From: aseem at metaweb.com (Aseem Mohanty)
Date: Tue Aug 21 12:30:02 2007
Subject: [mod_python] libapache2-mod-python error
In-Reply-To: <46cb04682a56f@wp.pl>
References: <200708210022.l7L0LEId000836@modpython.org> <46cb04682a56f@wp.pl>
Message-ID: <46CB12FE.5000001@metaweb.com>

Tomasz Wo?niak wrote:
> Please help me:
> I tried to install apache with mod_python in the Ubuntu. I have done it, 
> but instructions in the manual, and wikipedia doesn't work ( I cannot 
> run python from the url). Then I tried a lot of things. The last one 
> were:
> sudo aptitude install python
> sudo aptitude install libapache2-mod-python
> sudo gedit /etc/apache2/mods-available/mod_python.conf
>   AddType application/x-httpd-python .py
>   AddHandler mod_python .py
>   PythonHandler mod_python.publisher
>   PythonDebug On
> cd /etc/apache2/mods-enabled
> sudo ln -s ../mods-available/mod_python.conf mod_python.conf
> sudo /etc/init.d/apache2 restart
> But I had libapache2-mod-python error, and i have it whatever I try to 
> install...

I have it running on feisty, so it can work without much munging. You actually 
don't need the mod_python.conf file, you can put it in the location section of 
the site file in the sites-available folder or in sites-available/default file.

What error are you getting?

AM

> 
> PLEASE HELP ME!!!
> Tomasz Wo?niak
> 
> ----------------------------------------------------
> Raz, dwa, trzy... BUNGEEEE! Zabij nude i skocz z nami na bungee!
> Ty wybierasz czas i miejsce, my podpowiadamy jak to zrobi?! Zobacz:
> http://klik.wp.pl/?adr=http%3A%2F%2Fadv.reklama.wp.pl%2Fas%2Fbungee.html&sid=1269
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
From graham.dumpleton at gmail.com  Tue Aug 21 18:18:58 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Aug 21 18:19:09 2007
Subject: [mod_python] libapache2-mod-python error
In-Reply-To: <46cb04682a56f@wp.pl>
References: <200708210022.l7L0LEId000836@modpython.org> <46cb04682a56f@wp.pl>
Message-ID: <88e286470708211518r64d286aek14044de0f6b443d1@mail.gmail.com>

On 22/08/07, Tomasz Wo?niak <wozniak.tomasz.84@wp.pl> wrote:
> Please help me:
> I tried to install apache with mod_python in the Ubuntu. I have done it,
> but instructions in the manual, and wikipedia doesn't work ( I cannot
> run python from the url). Then I tried a lot of things. The last one
> were:
> sudo aptitude install python
> sudo aptitude install libapache2-mod-python
> sudo gedit /etc/apache2/mods-available/mod_python.conf
>   AddType application/x-httpd-python .py

What documentation says that 'application/x-httpd-python' is a valid
value for AddType to get mod_python to work? No such thing is
supported by mod_python. That you have defined this may well be
screwing up AddHandler directive.

To start with, very much suggest you do not try and use publisher and
try basic 'mptest' style example per documentation. Also try doing it
through .htaccess file first per instructions at:

  http://www.dscpl.com.au/wiki/ModPython/Articles/GettingModPythonWorking

Take note of the list of information which would be useful to use in
working out what you are doing wrong if it still doesn't work. It
isn't enough to say it doesn't work. Need to know what configuration
and URL you are using, the error the browser is giving you and what
errors may appear in Apache error logs.

Graham

>   AddHandler mod_python .py
>   PythonHandler mod_python.publisher
>   PythonDebug On
> cd /etc/apache2/mods-enabled
> sudo ln -s ../mods-available/mod_python.conf mod_python.conf
> sudo /etc/init.d/apache2 restart
> But I had libapache2-mod-python error, and i have it whatever I try to
> install...
>
> PLEASE HELP ME!!!
> Tomasz Wo?niak
>
> ----------------------------------------------------
> Raz, dwa, trzy... BUNGEEEE! Zabij nude i skocz z nami na bungee!
> Ty wybierasz czas i miejsce, my podpowiadamy jak to zrobi?! Zobacz:
> http://klik.wp.pl/?adr=http%3A%2F%2Fadv.reklama.wp.pl%2Fas%2Fbungee.html&sid=1269
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From wikiterra at gmail.com  Tue Aug 21 18:24:48 2007
From: wikiterra at gmail.com (Jonathan Frankel)
Date: Tue Aug 21 18:24:59 2007
Subject: [mod_python] How to do file uploads
Message-ID: <111c9e510708211524q449175cem6e7795e3bb2cde6b@mail.gmail.com>

Hello, I'm just using mod_python for the first time, and I'm trying to
figure out how to do file uploads. However, I'm completely confused
with this. From the documentation it seems to indicate that the best
way to do it is to use the FieldStorage class...except I can't see how
the examples provided have anything to do with file uploads.

When I search around I find very little, though the popular method
seems to be to use req.form['file'].file to return a file object.
Except I can't find where the documentation says anything about a
"form" attribute in req. Furthermore, I see people saying that it's
best to pass the data from the client through an input filter, which
sounds good and I kind of sort of get it, but don't know how to
implement it and can't find any examples.

Can anyone provide me with an example that allows a client to upload a
file, and limits it to a certain size? I really think that this sort
of thing should be provided as an example. If I get this working, I'll
gladly donate my code to put up on the examples page.

Thanks in advance,
Jonathan
From graham.dumpleton at gmail.com  Tue Aug 21 21:57:10 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Aug 21 21:57:24 2007
Subject: [mod_python] How to do file uploads
In-Reply-To: <111c9e510708211524q449175cem6e7795e3bb2cde6b@mail.gmail.com>
References: <111c9e510708211524q449175cem6e7795e3bb2cde6b@mail.gmail.com>
Message-ID: <88e286470708211857k1c256951tb2552f6aaa6edaa1@mail.gmail.com>

See:

  http://webpython.codepoint.net/mod_python_publisher_file_upload
  http://webpython.codepoint.net/mod_python_publisher_big_file_upload

req.form only exists if you are using publisher. If not using
publisher, add to start of handler the code:

  req.form = util.FieldStorage(req)

to create it.

Graham

On 22/08/07, Jonathan Frankel <wikiterra@gmail.com> wrote:
> Hello, I'm just using mod_python for the first time, and I'm trying to
> figure out how to do file uploads. However, I'm completely confused
> with this. From the documentation it seems to indicate that the best
> way to do it is to use the FieldStorage class...except I can't see how
> the examples provided have anything to do with file uploads.
>
> When I search around I find very little, though the popular method
> seems to be to use req.form['file'].file to return a file object.
> Except I can't find where the documentation says anything about a
> "form" attribute in req. Furthermore, I see people saying that it's
> best to pass the data from the client through an input filter, which
> sounds good and I kind of sort of get it, but don't know how to
> implement it and can't find any examples.
>
> Can anyone provide me with an example that allows a client to upload a
> file, and limits it to a certain size? I really think that this sort
> of thing should be provided as an example. If I get this working, I'll
> gladly donate my code to put up on the examples page.
>
> Thanks in advance,
> Jonathan
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From wikiterra at gmail.com  Wed Aug 22 13:45:01 2007
From: wikiterra at gmail.com (Jonathan Frankel)
Date: Wed Aug 22 13:45:18 2007
Subject: [mod_python] How to do file uploads
In-Reply-To: <88e286470708211857k1c256951tb2552f6aaa6edaa1@mail.gmail.com>
References: <111c9e510708211524q449175cem6e7795e3bb2cde6b@mail.gmail.com>
	<88e286470708211857k1c256951tb2552f6aaa6edaa1@mail.gmail.com>
Message-ID: <111c9e510708221045xeaf24dcnc65501774841fd38@mail.gmail.com>

Ahh, okay. Am I correct in thinking, then, that calling "req.form"
instantiates a FieldStorage object? Namely, making "form," the
FieldStorage object, a new attribute of req? Or does "req.form"
already exist as soon as mod_python hands req off to one of my own
functions?

Also, what is the preferred, or better way, to access form data? Is it
always more "efficient" or "secure" to use the FieldStorage object, or
is it just as good to use something like--

def getData(req, field1, field2):

The documentation uses the latter in its examples of reading form
data, and then goes on to say that FieldStorage can be used to access
form data...but doesn't actually show any examples of this. And this
link you sent me--which is very helpful, thank you--doesn't mention
passing form data to functions as arguments. So...I find this kind of
confusing.

Finally, about the file upload. The "Big File Upload" link you sent
says at the top that it buffers the input so that it doesn't "memory
starve the server if the file is a bit bigger." Does this mean when
the buffer function is called, it only gets the specified amount of
data in each chunk from the client in discrete steps? I ask this
because I was under the impression that when you make the statement,
"req.form['file'].file" you've already gotten all of the data from the
client onto the server.

Thanks again,
Jonathan

On 8/21/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> See:
>
>   http://webpython.codepoint.net/mod_python_publisher_file_upload
>   http://webpython.codepoint.net/mod_python_publisher_big_file_upload
>
> req.form only exists if you are using publisher. If not using
> publisher, add to start of handler the code:
>
>   req.form = util.FieldStorage(req)
>
> to create it.
>
> Graham
>
> On 22/08/07, Jonathan Frankel <wikiterra@gmail.com> wrote:
> > Hello, I'm just using mod_python for the first time, and I'm trying to
> > figure out how to do file uploads. However, I'm completely confused
> > with this. From the documentation it seems to indicate that the best
> > way to do it is to use the FieldStorage class...except I can't see how
> > the examples provided have anything to do with file uploads.
> >
> > When I search around I find very little, though the popular method
> > seems to be to use req.form['file'].file to return a file object.
> > Except I can't find where the documentation says anything about a
> > "form" attribute in req. Furthermore, I see people saying that it's
> > best to pass the data from the client through an input filter, which
> > sounds good and I kind of sort of get it, but don't know how to
> > implement it and can't find any examples.
> >
> > Can anyone provide me with an example that allows a client to upload a
> > file, and limits it to a certain size? I really think that this sort
> > of thing should be provided as an example. If I get this working, I'll
> > gladly donate my code to put up on the examples page.
> >
> > Thanks in advance,
> > Jonathan
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
>
From graham.dumpleton at gmail.com  Wed Aug 22 18:24:54 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Aug 22 18:25:07 2007
Subject: [mod_python] How to do file uploads
In-Reply-To: <111c9e510708221045xeaf24dcnc65501774841fd38@mail.gmail.com>
References: <111c9e510708211524q449175cem6e7795e3bb2cde6b@mail.gmail.com>
	<88e286470708211857k1c256951tb2552f6aaa6edaa1@mail.gmail.com>
	<111c9e510708221045xeaf24dcnc65501774841fd38@mail.gmail.com>
Message-ID: <88e286470708221524v5d73684exf4dc84972d835875@mail.gmail.com>

On 23/08/07, Jonathan Frankel <wikiterra@gmail.com> wrote:
> Ahh, okay. Am I correct in thinking, then, that calling "req.form"
> instantiates a FieldStorage object? Namely, making "form," the
> FieldStorage object, a new attribute of req? Or does "req.form"
> already exist as soon as mod_python hands req off to one of my own
> functions?

As I said previously, req.form is only automatically created when
using publisher. Ie., when you have PythonHandler set to
mod_python.publisher. It is a feature of that high level handler that
it does this. If you are implementing your own low level handler it
will not be done, nor will you have the feature of form fields being
able to be passed as distinct arguments to your handler.

Research the mod_python documentation to satisfy yourself what the
distinction is between basic low level handler and high level
publisher handler. Then you may not be so confused.

> Also, what is the preferred, or better way, to access form data? Is it
> always more "efficient" or "secure" to use the FieldStorage object, or
> is it just as good to use something like--
>
> def getData(req, field1, field2):
>
> The documentation uses the latter in its examples of reading form
> data, and then goes on to say that FieldStorage can be used to access
> form data...but doesn't actually show any examples of this. And this
> link you sent me--which is very helpful, thank you--doesn't mention
> passing form data to functions as arguments. So...I find this kind of
> confusing.

Since those pages are part of a complete set of tutorial pages someone
has written for using mod_python, maybe you should go back to the
start and read them all. Note that I found these pages by doing a
Google search. I haven't actually looked at them in a very long time
and am not familiar with them, but the contents on the right side of
the page suggests it covers what you want, although the examples may
be specific to publisher in many cases.

> Finally, about the file upload. The "Big File Upload" link you sent
> says at the top that it buffers the input so that it doesn't "memory
> starve the server if the file is a bit bigger." Does this mean when
> the buffer function is called, it only gets the specified amount of
> data in each chunk from the client in discrete steps? I ask this
> because I was under the impression that when you make the statement,
> "req.form['file'].file" you've already gotten all of the data from the
> client onto the server.

I'm not familiar with the example. As I said I pointed it out as it
was one of the first pages that appear in Google search. Other may
have the time to help you understand it, I am a bit busy at the
moment. Sorry.

Graham

> Thanks again,
> Jonathan
>
> On 8/21/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > See:
> >
> >   http://webpython.codepoint.net/mod_python_publisher_file_upload
> >   http://webpython.codepoint.net/mod_python_publisher_big_file_upload
> >
> > req.form only exists if you are using publisher. If not using
> > publisher, add to start of handler the code:
> >
> >   req.form = util.FieldStorage(req)
> >
> > to create it.
> >
> > Graham
> >
> > On 22/08/07, Jonathan Frankel <wikiterra@gmail.com> wrote:
> > > Hello, I'm just using mod_python for the first time, and I'm trying to
> > > figure out how to do file uploads. However, I'm completely confused
> > > with this. From the documentation it seems to indicate that the best
> > > way to do it is to use the FieldStorage class...except I can't see how
> > > the examples provided have anything to do with file uploads.
> > >
> > > When I search around I find very little, though the popular method
> > > seems to be to use req.form['file'].file to return a file object.
> > > Except I can't find where the documentation says anything about a
> > > "form" attribute in req. Furthermore, I see people saying that it's
> > > best to pass the data from the client through an input filter, which
> > > sounds good and I kind of sort of get it, but don't know how to
> > > implement it and can't find any examples.
> > >
> > > Can anyone provide me with an example that allows a client to upload a
> > > file, and limits it to a certain size? I really think that this sort
> > > of thing should be provided as an example. If I get this working, I'll
> > > gladly donate my code to put up on the examples page.
> > >
> > > Thanks in advance,
> > > Jonathan
> > > _______________________________________________
> > > Mod_python mailing list
> > > Mod_python@modpython.org
> > > http://mailman.modpython.org/mailman/listinfo/mod_python
> > >
> >
>
From graham.dumpleton at gmail.com  Sat Aug 25 00:04:21 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sat Aug 25 00:04:34 2007
Subject: [mod_python] Re: Curious error with Session Variables
In-Reply-To: <1187967860.493686.127380@r23g2000prd.googlegroups.com>
References: <6e38f9f00704031036u37116ec1h74e2f2f5894e8e35@mail.gmail.com>
	<1175697578.903613.7740@e65g2000hsc.googlegroups.com>
	<13e880750705081311x79850862p5659a39759fa5eff@mail.gmail.com>
	<46410B45.7030508@qwest.net>
	<13e880750705090616p2bbed7cbxff487f9f8e606892@mail.gmail.com>
	<1178759442.297892.62700@u30g2000hsc.googlegroups.com>
	<1187967860.493686.127380@r23g2000prd.googlegroups.com>
Message-ID: <88e286470708242104r6c2e7d58w844845c086cbe433@mail.gmail.com>

On 25/08/07, karn <kan2005@gmail.com> wrote:
> I found this problem too, but I am not expert in php.
> Could you explain in detail , how to disable php mhash module? Did you
> mean change configuration in php.ini?
>
> Karn

I'm not a PHP person so have no idea. I have pushed your question back
onto the mod_python list where there is no doubt someone who has had
to do this who can tell you. Otherwise ask on a PHP list if you cant
get an answer.

Graham

> On 10 .., 08:10, Graham Dumpleton <Graham.Dumple...@gmail.com>
> wrote:
> > Tryreenabling PHP, but delve into the PHP setup and disable the
> > loading of the PHP mhash module first.
> >
> > There have been cases where the PHP mhash module has clashed in some
> > way with the Python md5 hash modules and caused the Python module to
> > give back incorrect results. This may have an effect on sessioncookiesif a md5 hash is used in some way to generate it.
> >
> > Graham
> >
> > On May 9, 11:16 pm, "Diego pylorca" <pylo...@gmail.com> wrote:
> >
> >
> >
> > > Nop,
> >
> > > when I disable mod-php5, the admin works correctly :(
> >
> > > my web browsers are firefox and opera and IE, but it is not a client host
> > > problem :'(
> >
> > > On 5/8/07, John DeRosa <stug...@qwest.net> wrote:
> >
> > > > Perhaps checkyourfirewall, anti-hijack, anti-trojan, etc. software.
> > > > You may have a cookie guard enabled.
> >
> > > > For example, Webroot's Spy Sweeper has a set of "shields" for web
> > > > browsers, and they include the blocking of certain trackingcookiesand
> > > > some IE security 'protection'.  Perhapsyoursystem is running a similar
> > > > product?
> >
> > > > John
> >
> > > > Diego pylorca wrote:
> > > > > mmmmm
> >
> > > > > I deployed my site, and in the admin when itryto login i get this
> > > > message:
> >
> > > > > "Lookslikeyourbrowserisn'tconfiguredtoacceptcookies.Please
> > > > >enablecookies,reloadthispage, andtryagain."
> >
> > > > > thecookiesis enabled.
> >
> > > > > my server is a debian etch stable (intalled modpython apache2 and mysql
> > > > > from apt)
> >
> > > > > i ve run django/bin/daily_cleanup.py and flush the session table...
> >
> > > > > PD: sory by me bad english
> >
> > > > > On 4/4/07, *chasfs* <cha...@yahoo.com <mailto:cha...@yahoo.com>> wrote:
> >
> > > > >     There are several things going on here. If you have multiple django
> > > > >     sites
> > > > >     all setting sessionscookies, make sure that the SESSION_COOKIE_NAME
> > > > >     and SESSION_COOKIE_DOMAIN are unique in the respective settings.py
> > > > >     files.
> >
> > > > >     You also need to clean out old session rows in the django_session
> > > > >     database.
> > > > >     You can use django/bin/daily_cleanup.py to do this.
> >
> > > > >     Good luck,
> > > > >     -chasfs
> >
> > > > >     On Apr 3, 1:36 pm, "Ramdas S" < ram...@gmail.com
> > > > >     <mailto:ram...@gmail.com>> wrote:
> > > > >      > Since last few days I am getting this error on Django web sites
> > > > >     hosted.
> > > > >      > Obviously it is clashing with something.
> >
> > > > >      > When I work on admin interface to add or delete content, I get
> > > > >     logged off
> > > > >      > and it takes some time for me to loginagain.
> >
> > > > >      > I get the following messages
> >
> > > > >      >Pleaseenter a correct username and password. Note that both
> > > > >     fields are
> > > > >      > case-sensitive.
> >
> > > > >      > If I keep on trying then the message changes to
> >
> > > > >      >Lookslikeyourbrowserisn'tconfiguredtoacceptcookies.
> > > > >    Pleaseenable
> > > > >      >cookies,reloadthispage, andtryagain.
> >
> > > > >      > Later if I persist
> >
> > > > >      > I get this error
> >
> > > > >      > -----
> >
> > > > >      > SuspiciousOperation at /admin/ User may have tampered with
> > > > session
> > > > >      > cookie. Request
> > > > >      > Method: POST  Request URL:http://developeriq.com/admin/
> > > > >     Exception Type:
> > > > >      > SuspiciousOperation  Exception Value: User may have tampered with
> > > > >     session
> > > > >      > cookie.  Exception Location:
> >
> > > > /usr/lib/python2.4/site-packages/django/contrib/admin/views/decorators.py
> >
> > > > >      > in _decode_post_data, line 40
> >
> > > > >      > I am using the latest development version Mod_Python, Apache and
> > > > >     Ubuntu
> > > > >      > Linux
> >
> > > > >      > What can be the reason
> >
> > > > >      > Thanks
> >
> > > > >      > Ramdas S
> >
> > > > >      > The Server is a dedicated server, and it also runs PHP, MySQl and
> > > > >     some PHP
> > > > >      > and Python software.
> >
> > > > > --
> > > > > Diego F. Toritto.
> >
> > > --
> > > Diego F. Toritto.-  -
> >
> > -  -
>
>

From francis.west at ntlworld.com  Sun Aug 26 15:29:34 2007
From: francis.west at ntlworld.com (Francis West)
Date: Sun Aug 26 15:29:55 2007
Subject: [mod_python] apache configuration
Message-ID: <46D1D49E.7070106@ntlworld.com>

Hello,
    i just picked up mod_python today,  I wanted to build a system where 
I could handle all requests under a certain director.  for example:

my apache config looks something like this:

    Alias /learning/ "/script/home/learning/"
    <Directory "/script/home/learning/">

        DirectoryIndex index.py

        Options Indexes MultiViews FollowSymLinks
        AddHandler mod_python .py
        PythonHandler index
        PythonDebug On

    </Directory>


what i would like to do next is have all requests to 
/learning/xxx.anything get processed by the index.py


Thanks
Francis
From hlnrog001 at gmail.com  Sun Aug 26 16:40:35 2007
From: hlnrog001 at gmail.com (Roger Holness)
Date: Sun Aug 26 16:40:46 2007
Subject: [mod_python] Aliasing extensions in mod_python
Message-ID: <cff19d420708261340r613e01a8xffd087733e6d4e59@mail.gmail.com>

Hi

I am working on a python script to generate dynamic wml

I am using publisher of mod_python

The problem I am having is that my script returns valid wml but my
phone that I am testing on (and I assume others as well) doesn't check
the mime type, rather just the extension

ie. www.mywebsite/wml.py/test  is returning valid wml, but the phone
doesn't realise that as it is expecting /test.wml

Now functions names can't contain periods, so I can't do:
def test.wml(req)

I am therefore trying to alias wml.py/test.wml to wml.py/test,
effectively tricking the phone into doing what it should be doing in
the first place

Any ideas how I would go about this?

Regards

Roger

PS. Yes, I am a noob :P
From list at joreybump.com  Sun Aug 26 17:21:25 2007
From: list at joreybump.com (Jorey Bump)
Date: Sun Aug 26 17:21:36 2007
Subject: [mod_python] Aliasing extensions in mod_python
In-Reply-To: <cff19d420708261340r613e01a8xffd087733e6d4e59@mail.gmail.com>
References: <cff19d420708261340r613e01a8xffd087733e6d4e59@mail.gmail.com>
Message-ID: <46D1EED5.6060208@joreybump.com>

Roger Holness wrote:

> The problem I am having is that my script returns valid wml but my
> phone that I am testing on (and I assume others as well) doesn't check
> the mime type, rather just the extension
> 
> ie. www.mywebsite/wml.py/test  is returning valid wml, but the phone
> doesn't realise that as it is expecting /test.wml
> 
> Now functions names can't contain periods, so I can't do:
> def test.wml(req)

You can create a class with a wml method. Then you create an instance of 
the class, and get at the method using dotted notation.

class Class:
     def __call__(self):
         return "I am the default method."
     def wml(self):
         page = <create wml page here>
         return page

test = Class()

Now you should be able to reach it via:

  http://www.mywebsite/wml.py/test.wml

From graham.dumpleton at gmail.com  Sun Aug 26 17:56:32 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sun Aug 26 17:56:43 2007
Subject: [mod_python] apache configuration
In-Reply-To: <46D1D49E.7070106@ntlworld.com>
References: <46D1D49E.7070106@ntlworld.com>
Message-ID: <88e286470708261456i5de95708t2367265cd66317af@mail.gmail.com>

On 27/08/07, Francis West <francis.west@ntlworld.com> wrote:
> Hello,
>     i just picked up mod_python today,  I wanted to build a system where
> I could handle all requests under a certain director.  for example:
>
> my apache config looks something like this:
>
>     Alias /learning/ "/script/home/learning/"
>     <Directory "/script/home/learning/">
>
>         DirectoryIndex index.py
>
>         Options Indexes MultiViews FollowSymLinks
>         AddHandler mod_python .py
>         PythonHandler index
>         PythonDebug On
>
>     </Directory>
>
>
> what i would like to do next is have all requests to
> /learning/xxx.anything get processed by the index.py

If you use SetHandler rather than AddHandler, it will process all
requests in the scope through mod_python.

   <Directory "/script/home/learning/">

       SetHandler mod_python .py
       PythonHandler index
       PythonDebug On

   </Directory>

I'm not quite sure if that is what you meant though as when you say
'xxx.anything', do you mean just for the resource with that name, or
are you implying some wildcarding, or as above, anything in the
directory. If just that resource:

   <Directory "/script/home/learning/">

       DirectoryIndex index.py

       Options Indexes MultiViews FollowSymLinks
       AddHandler mod_python .py
       PythonHandler index
       PythonDebug On

       <Files xxx.anything>
       SetHandler mod_python
       </Files>

   </Directory>

Can you provide a better example of what you want? Perhaps also
expressing it in terms of the final goal as opposed to a specific step
along the way.

Also read:

  http://www.dscpl.com.au/wiki/ModPython/Articles/SetHandlerVersusAddHandler

Graham
From ccbean at gmail.com  Sun Aug 26 18:24:21 2007
From: ccbean at gmail.com (Colin Bean)
Date: Sun Aug 26 18:24:36 2007
Subject: [mod_python] Aliasing extensions in mod_python
In-Reply-To: <cff19d420708261340r613e01a8xffd087733e6d4e59@mail.gmail.com>
References: <cff19d420708261340r613e01a8xffd087733e6d4e59@mail.gmail.com>
Message-ID: <29a6ca010708261524o7c623015t7c26faf6656e0ceb@mail.gmail.com>

You might also try setting the content-disposition header of your
request to specify a file name -- this might be all you need, if the
phone uses it correctly.
Also, you could use mod_rewrite to do the "alias" you mentioned (if
you didn't want to change your existing python handler).  Take a look
a the documentation on the apache httpd site...

-Colin

On 8/26/07, Roger Holness <hlnrog001@gmail.com> wrote:
> Hi
>
> I am working on a python script to generate dynamic wml
>
> I am using publisher of mod_python
>
> The problem I am having is that my script returns valid wml but my
> phone that I am testing on (and I assume others as well) doesn't check
> the mime type, rather just the extension
>
> ie. www.mywebsite/wml.py/test  is returning valid wml, but the phone
> doesn't realise that as it is expecting /test.wml
>
> Now functions names can't contain periods, so I can't do:
> def test.wml(req)
>
> I am therefore trying to alias wml.py/test.wml to wml.py/test,
> effectively tricking the phone into doing what it should be doing in
> the first place
>
> Any ideas how I would go about this?
>
> Regards
>
> Roger
>
> PS. Yes, I am a noob :P
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From sdavis2 at mail.nih.gov  Sun Aug 26 19:39:16 2007
From: sdavis2 at mail.nih.gov (Sean Davis)
Date: Sun Aug 26 19:39:28 2007
Subject: [mod_python] Aliasing extensions in mod_python
In-Reply-To: <cff19d420708261340r613e01a8xffd087733e6d4e59@mail.gmail.com>
References: <cff19d420708261340r613e01a8xffd087733e6d4e59@mail.gmail.com>
Message-ID: <46D20F24.2000309@mail.nih.gov>

Roger Holness wrote:
> Hi
>
> I am working on a python script to generate dynamic wml
>
> I am using publisher of mod_python
>
> The problem I am having is that my script returns valid wml but my
> phone that I am testing on (and I assume others as well) doesn't check
> the mime type, rather just the extension
>
> ie. www.mywebsite/wml.py/test  is returning valid wml, but the phone
> doesn't realise that as it is expecting /test.wml
>
> Now functions names can't contain periods, so I can't do:
> def test.wml(req)
>
> I am therefore trying to alias wml.py/test.wml to wml.py/test,
> effectively tricking the phone into doing what it should be doing in
> the first place
>
> Any ideas how I would go about this?
>   

Will mod_rewrite do what you want?  I think it will....

Sean
From mod_python at rolfvandekrol.nl  Tue Aug 28 11:52:14 2007
From: mod_python at rolfvandekrol.nl (Rolf van de Krol)
Date: Tue Aug 28 11:52:44 2007
Subject: [mod_python] Interpreters and global names
Message-ID: <46D444AE.2090103@rolfvandekrol.nl>

Hi everybody at this list,

I've got a problem. To me it seems quite complex so explaining it takes 
some code to write. But i'm a total newbie to mod_python. I've read the 
documentation, I understand it, I managed to setup a running mod_python 
installation and I can write some simple applications with it. That's it.
So, my apologies for the amount of code in the message,  I hope you can 
bring the effort to read it to understand my problem. I enclosed python 
code in <code> tags to show where the code begins and ends.

I've set up two VirtualHosts with the following directives in 
httpd.conf. (I changed some names, because the domainnames used for this 
are not to be published.)

NameVirtualHost *:80
<VirtualHost *:80>
    ServerName domain1.ext
    ServerAdmin admin@domain1.ext
    <Location />
        Order Allow,Deny
        Allow from all
      
        SetHandler mod_python
        PythonInterpreter domain1interpreter
        PythonHandler D:/main.py
        PythonDebug On
    </Location>
</VirtualHost>

<VirtualHost *:80>
   ServerName admin.domain1.ext
   ServerAdmin admin@domain1.ext
     <Location />
       Order Allow,Deny
       Allow from all
             SetHandler mod_python
       PythonInterpreter domain1interpreter
       PythonHandler D:/radmin.py
       PythonDebug On
   </Location>
</VirtualHost>

As you can see, they both share the same interpreter. The setup works. 
With the following python code in main.py and radmin.py they both print 
the same name.

<code>
from mod_python import apache
def handler(req):
    req.content_type = 'text/plain'
    req.write(req.interpreter)
    return apache.OK
</code>

I changed main.py to the following code:

<code>
from mod_python import apache
import collections

def handler(req):
    if not globals().has_key('aPool'):
        aPool = collections.deque()
        global aPool
    else:
        global aPool

    # code to use aPool and print some output
</code>

aPool is used to create a database connection pool, but that's not 
important to the problem. The code above works fine.

I change radmin.py to the following:

<code>
from mod_python import apache
import collections
import pprint

def handler(req):
    req.content_type = 'text/plain'
    req.write(pprint.pformat(globals()))
</code>

What I expected was that I could find aPool in the output of radmin.py. 
But I couldn't. It just isn't there. It seems that the global names 
aren't as global as they seem to be. Is there a way to make variables 
set in main.py accessable to radmin.py?

I hope any of you knows the answer.

Rolf van de Krol

From graham.dumpleton at gmail.com  Tue Aug 28 18:04:12 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Aug 28 18:04:25 2007
Subject: [mod_python] Interpreters and global names
In-Reply-To: <46D444AE.2090103@rolfvandekrol.nl>
References: <46D444AE.2090103@rolfvandekrol.nl>
Message-ID: <88e286470708281504l2663f516u2839fa3db6145b7@mail.gmail.com>

Apache on UNIX is a multi process web server. Read:

  http://www.dscpl.com.au/wiki/ModPython/Articles/TheProcessInterpreterModel

Graham

On 29/08/07, Rolf van de Krol <mod_python@rolfvandekrol.nl> wrote:
> Hi everybody at this list,
>
> I've got a problem. To me it seems quite complex so explaining it takes
> some code to write. But i'm a total newbie to mod_python. I've read the
> documentation, I understand it, I managed to setup a running mod_python
> installation and I can write some simple applications with it. That's it.
> So, my apologies for the amount of code in the message,  I hope you can
> bring the effort to read it to understand my problem. I enclosed python
> code in <code> tags to show where the code begins and ends.
>
> I've set up two VirtualHosts with the following directives in
> httpd.conf. (I changed some names, because the domainnames used for this
> are not to be published.)
>
> NameVirtualHost *:80
> <VirtualHost *:80>
>     ServerName domain1.ext
>     ServerAdmin admin@domain1.ext
>     <Location />
>         Order Allow,Deny
>         Allow from all
>
>         SetHandler mod_python
>         PythonInterpreter domain1interpreter
>         PythonHandler D:/main.py
>         PythonDebug On
>     </Location>
> </VirtualHost>
>
> <VirtualHost *:80>
>    ServerName admin.domain1.ext
>    ServerAdmin admin@domain1.ext
>      <Location />
>        Order Allow,Deny
>        Allow from all
>              SetHandler mod_python
>        PythonInterpreter domain1interpreter
>        PythonHandler D:/radmin.py
>        PythonDebug On
>    </Location>
> </VirtualHost>
>
> As you can see, they both share the same interpreter. The setup works.
> With the following python code in main.py and radmin.py they both print
> the same name.
>
> <code>
> from mod_python import apache
> def handler(req):
>     req.content_type = 'text/plain'
>     req.write(req.interpreter)
>     return apache.OK
> </code>
>
> I changed main.py to the following code:
>
> <code>
> from mod_python import apache
> import collections
>
> def handler(req):
>     if not globals().has_key('aPool'):
>         aPool = collections.deque()
>         global aPool
>     else:
>         global aPool
>
>     # code to use aPool and print some output
> </code>
>
> aPool is used to create a database connection pool, but that's not
> important to the problem. The code above works fine.
>
> I change radmin.py to the following:
>
> <code>
> from mod_python import apache
> import collections
> import pprint
>
> def handler(req):
>     req.content_type = 'text/plain'
>     req.write(pprint.pformat(globals()))
> </code>
>
> What I expected was that I could find aPool in the output of radmin.py.
> But I couldn't. It just isn't there. It seems that the global names
> aren't as global as they seem to be. Is there a way to make variables
> set in main.py accessable to radmin.py?
>
> I hope any of you knows the answer.
>
> Rolf van de Krol
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From sidnei at enfoldsystems.com  Tue Aug 28 22:14:51 2007
From: sidnei at enfoldsystems.com (Sidnei da Silva)
Date: Tue Aug 28 22:25:43 2007
Subject: [mod_python] Headers not being sent when input/output is over a
	certain size
Message-ID: <fb2kr0$f63$1@sea.gmane.org>

Hi there,

I'm writing an Output Filter using mod_python and facing an intriguing 
issue.

When my input/output is over a certain size, the Content-Type/Content-Length
headers are not set. Anything below that size works fine.

I'm using mod_python 3.3.1 with Apache 2.2.4 on both Windows and Linux with
the same behaviour.

The input size is roughly 7.5Kb and the generated output is roughly 13.5Kb.
The only difference between a working request and a non-working request is 
the
size. It smells to me like there's some buffer flushing going on before I 
set
Content-Length/Content-Type.

Is this a known-issue? If not, how can I help diagnose it?

-- 
Sidnei da Silva
Enfold Systems, Inc.
 


From boris.dusek at gmail.com  Tue Aug 28 22:26:18 2007
From: boris.dusek at gmail.com (=?UTF-8?Q?Boris_Du=C5=A1ek?=)
Date: Tue Aug 28 22:26:33 2007
Subject: [mod_python] Session-related hang
Message-ID: <b2c603da0708281926w45322828s194214a0212b443@mail.gmail.com>

Hi,

I am using Apache 2.2.3, mod_python 2.3.8. I experience a hang that is
related to Session.
I have such a class:

file nanosession.py:
class NanoSession(Session.DbmSession):
    def __init__(self, req):
        logging.debug("In NanoSession.__init__")
        logging.debug("Calling DbmSession.__init__")
        Session.DbmSession.__init__(self, req)

    def ...

in the index.py file, that gets displayed by mod_python.publisher,
there is following code:

def index(req, **vars):
    logging.debug("Entered index.py/index")

    logging.debug("Reloading module 1")
    reload(module1)

    logging.debug("Reloading module nanosession")
    reload(nanosession)

    logging.debug("Reloading module 2")
    reload(module2)

    logging.debug("Generating page content")
    content = generate_content(...)


When I hit for the index.py page, it was working for the first time. I
am not really sure what I have been doing then, probably just surfing
the other pages on the same site. And then suddenly, from then on,
when I wanted to display some page, it took forever (I mean not long,
I mean it did not display, Firefox displaying "Waiting for ...",
netcat displaying no output available). Then I asked a friend at a
different computer (with a different IP) to try to access the same
webpage - he could access it, and it displayed immediately. However,
then he hit the reload button in his browser, and he was immediately
from then on experiencing the same "never loads" behavior for any
webpage that uses sessions.

The logging output from the above code shows that it hangs on
DbmSession.__init__:

DEBUG:root:Entered index.py/index
DEBUG:root:Reloading module webpage
DEBUG:root:Reloading module webpage
DEBUG:root:Reloading module webpage
DEBUG:root:Creating session
DEBUG:root:nanosession.py/NanoSession.__init__
DEBUG:root:calling DbnSession.__init__
DEBUG:root:Entered index.py/index
DEBUG:root:Reloading module webpage
DEBUG:root:Reloading module webpage
DEBUG:root:Reloading module webpage
DEBUG:root:Creating session
DEBUG:root:nanosession.py/NanoSession.__init__
DEBUG:root:calling DbmSession.__init__
...
and so on...

Do you please have any suggestions about possible cause and workarounds?

Thanks,
Boris Du?ek

From sidnei at enfoldsystems.com  Tue Aug 28 23:12:56 2007
From: sidnei at enfoldsystems.com (Sidnei da Silva)
Date: Tue Aug 28 23:13:40 2007
Subject: [mod_python] Re: XSLT and mod_python
References: <B6C73A5E30565245BB6D32B5F5DF7A52120376@sense.emmastraat.pijnacker>
	<200705231716.05231.richardlewis@fastmail.co.uk>
Message-ID: <fb2o81$klm$1@sea.gmane.org>

"Richard Lewis" <richardlewis@fastmail.co.uk> wrote 
in message news:200705231716.05231.richardlewis@fastmail.co.uk...
> Therefore I use lxml[2] which implements Fredrik Lundh[3]'s ElementTree[4]
> interface (which is now part of the Python standard library, as of 2.5[5]) 
> as
> a wrapper around libxml/libxslt. Its a very nice way to work with XML/XSLT 
> in
> Python as its /very/ fast and it creates nice Pythonic data structures as 
> a
> result of your XSLT transformations which you can then go on to manipulate 
> in
> code (or just write to a string or file-like object). The only problem 
> I've
> had with it is, I /think/, that its causing crashing of the mod_python's
> Python interpreter when you use <xsl:import />. As I said, I /think/ this 
> is
> what's causing these crashes, but I'm not sure yet.

FWIW, I'm also using lxml and gone through a similar issue with a crash 
using lxml and the XSLT document() function. The solution was to use 
"PythonInterpreter main_interpreter", as I've found described on the 
documentation for 'xapian' (!). Stephan Behnel, lxml developer also 
suggested compiling lxml with(out?) threading support, but I didn't give 
that a try.

-- 
Sidnei da Silva
Enfold Systems, Inc. 


From graham.dumpleton at gmail.com  Tue Aug 28 23:25:09 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Aug 28 23:25:22 2007
Subject: [mod_python] Session-related hang
In-Reply-To: <b2c603da0708281926w45322828s194214a0212b443@mail.gmail.com>
References: <b2c603da0708281926w45322828s194214a0212b443@mail.gmail.com>
Message-ID: <88e286470708282025p36d792afxf9134ad6ea5a0d5a@mail.gmail.com>

You are likely trying to create a session object when one has already
been created for that request already and thus dead locking on
yourself. There are lots of examples of people doing this in the
www.modpython.org mailing list archives, search from www.modpython.org
search box.

What is in generate_content(...)? Without seeing how you are
manipulating sessions can say exactly what you are doing wrong

BTW, why are you creating a derived session object type?

Also, using reload() like that is not recommended. Upgrade to
mod_python 3.3.1 and read about import_module() function in:

  http://www.modpython.org/live/current/doc-html/pyapi-apmeth.html

Graham

On 29/08/2007, Boris Du?ek <boris.dusek@gmail.com> wrote:
> Hi,
>
> I am using Apache 2.2.3, mod_python 2.3.8. I experience a hang that is
> related to Session.
> I have such a class:
>
> file nanosession.py:
> class NanoSession(Session.DbmSession):
>     def __init__(self, req):
>         logging.debug("In NanoSession.__init__")
>         logging.debug("Calling DbmSession.__init__")
>         Session.DbmSession.__init__(self, req)
>
>     def ...
>
> in the index.py file, that gets displayed by mod_python.publisher,
> there is following code:
>
> def index(req, **vars):
>     logging.debug("Entered index.py/index")
>
>     logging.debug("Reloading module 1")
>     reload(module1)
>
>     logging.debug("Reloading module nanosession")
>     reload(nanosession)
>
>     logging.debug("Reloading module 2")
>     reload(module2)
>
>     logging.debug("Generating page content")
>     content = generate_content(...)
>
>
> When I hit for the index.py page, it was working for the first time. I
> am not really sure what I have been doing then, probably just surfing
> the other pages on the same site. And then suddenly, from then on,
> when I wanted to display some page, it took forever (I mean not long,
> I mean it did not display, Firefox displaying "Waiting for ...",
> netcat displaying no output available). Then I asked a friend at a
> different computer (with a different IP) to try to access the same
> webpage - he could access it, and it displayed immediately. However,
> then he hit the reload button in his browser, and he was immediately
> from then on experiencing the same "never loads" behavior for any
> webpage that uses sessions.
>
> The logging output from the above code shows that it hangs on
> DbmSession.__init__:
>
> DEBUG:root:Entered index.py/index
> DEBUG:root:Reloading module webpage
> DEBUG:root:Reloading module webpage
> DEBUG:root:Reloading module webpage
> DEBUG:root:Creating session
> DEBUG:root:nanosession.py/NanoSession.__init__
> DEBUG:root:calling DbnSession.__init__
> DEBUG:root:Entered index.py/index
> DEBUG:root:Reloading module webpage
> DEBUG:root:Reloading module webpage
> DEBUG:root:Reloading module webpage
> DEBUG:root:Creating session
> DEBUG:root:nanosession.py/NanoSession.__init__
> DEBUG:root:calling DbmSession.__init__
> ...
> and so on...
>
> Do you please have any suggestions about possible cause and workarounds?
>
> Thanks,
> Boris Du?ek
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From graham.dumpleton at gmail.com  Tue Aug 28 23:28:48 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Aug 28 23:28:59 2007
Subject: [mod_python] Re: XSLT and mod_python
In-Reply-To: <fb2o81$klm$1@sea.gmane.org>
References: <B6C73A5E30565245BB6D32B5F5DF7A52120376@sense.emmastraat.pijnacker>
	<200705231716.05231.richardlewis@fastmail.co.uk>
	<fb2o81$klm$1@sea.gmane.org>
Message-ID: <88e286470708282028u75580808yb910edaf4b56dcc3@mail.gmail.com>

If you are having to use 'main_interpreter', then it means some C
extension module author has taken the easy path and used the
simplified GIL state API for thread management rather than using the
complete API properly. This means their module cannot be used in
secondary sub interpreters as created in mod_python and you have to
force it to use the main interpreter.

Graham

On 29/08/2007, Sidnei da Silva <sidnei@enfoldsystems.com> wrote:
> "Richard Lewis" <richardlewis@fastmail.co.uk> wrote
> in message news:200705231716.05231.richardlewis@fastmail.co.uk...
> > Therefore I use lxml[2] which implements Fredrik Lundh[3]'s ElementTree[4]
> > interface (which is now part of the Python standard library, as of 2.5[5])
> > as
> > a wrapper around libxml/libxslt. Its a very nice way to work with XML/XSLT
> > in
> > Python as its /very/ fast and it creates nice Pythonic data structures as
> > a
> > result of your XSLT transformations which you can then go on to manipulate
> > in
> > code (or just write to a string or file-like object). The only problem
> > I've
> > had with it is, I /think/, that its causing crashing of the mod_python's
> > Python interpreter when you use <xsl:import />. As I said, I /think/ this
> > is
> > what's causing these crashes, but I'm not sure yet.
>
> FWIW, I'm also using lxml and gone through a similar issue with a crash
> using lxml and the XSLT document() function. The solution was to use
> "PythonInterpreter main_interpreter", as I've found described on the
> documentation for 'xapian' (!). Stephan Behnel, lxml developer also
> suggested compiling lxml with(out?) threading support, but I didn't give
> that a try.
>
> --
> Sidnei da Silva
> Enfold Systems, Inc.
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From graham.dumpleton at gmail.com  Tue Aug 28 23:32:20 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Aug 28 23:32:34 2007
Subject: [mod_python] Headers not being sent when input/output is over a
	certain size
In-Reply-To: <fb2kr0$f63$1@sea.gmane.org>
References: <fb2kr0$f63$1@sea.gmane.org>
Message-ID: <88e286470708282032i3fe6e390j96bec45522c9bfb5@mail.gmail.com>

On 29/08/2007, Sidnei da Silva <sidnei@enfoldsystems.com> wrote:
> Hi there,
>
> I'm writing an Output Filter using mod_python and facing an intriguing
> issue.
>
> When my input/output is over a certain size, the Content-Type/Content-Length
> headers are not set. Anything below that size works fine.
>
> I'm using mod_python 3.3.1 with Apache 2.2.4 on both Windows and Linux with
> the same behaviour.
>
> The input size is roughly 7.5Kb and the generated output is roughly 13.5Kb.
> The only difference between a working request and a non-working request is
> the
> size. It smells to me like there's some buffer flushing going on before I
> set
> Content-Length/Content-Type.
>
> Is this a known-issue? If not, how can I help diagnose it?

If you expect to be able to set headers in an output filter based on
the complete content being output, you need to buffer up all your data
and write it in one go after you have updated the headers. You cannot
write the data and then update the headers.

Without seeing the code for your output filter, can't comment further
as to what the problem may be.

Graham
From graham.dumpleton at gmail.com  Tue Aug 28 23:57:35 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Aug 28 23:57:48 2007
Subject: [mod_python] Headers not being sent when input/output is over a
	certain size
In-Reply-To: <A27E48C051AA49529DD4EA05B09FE963@topia>
References: <fb2kr0$f63$1@sea.gmane.org>
	<88e286470708282032i3fe6e390j96bec45522c9bfb5@mail.gmail.com>
	<A27E48C051AA49529DD4EA05B09FE963@topia>
Message-ID: <88e286470708282057t386062f0ib0f937bc64f62a6@mail.gmail.com>

On 29/08/2007, Sidnei da Silva <sidnei@enfoldsystems.com> wrote:
> ----- Original Message -----
> > If you expect to be able to set headers in an output filter based on
> > the complete content being output, you need to buffer up all your data
> > and write it in one go after you have updated the headers. You cannot
> > write the data and then update the headers.
>
> That's what I'm doing yes.
>
> > Without seeing the code for your output filter, can't comment further
> > as to what the problem may be.
>
> It goes along the lines of (off the top of my head):
>
> if <request-not-interesting>:
>    filter.pass_on()
>    return
>
> ... do buffering ..
>
> if <read-returns-None>:
>   filter.req.set_content_length(<len-of-generated-data>)
>   filter.req.content_type = 'text/xml'
>   filter.write(<generated-data>)
>   filter.close()
>
> Again, it works as expected with little data, but when there's just a little
> bit over 7.5k of buffered input data, when I call filter.write() the
> Content-Length and Content-Type headers do not get sent.

Do you get a content length header if you enable the Apache
CONTENT_LENGTH output filter?

Part of the problem may be that output filters in Apache are a
resource filter and are only possibly supposed to operate on the
actual body content. I'm not sure if resource filters are supposed to
be able to operate on headers.

The CONTENT_LENGTH output filter for example which does operate on
headers, is registered as a protocol filter and not a resource filter.

I don't have the time to investigate this now, but might be able to
look at what the differences are later and whether you can even set
headers in mod_python output filters.

/**
 * Filters have different types/classifications. These are used to group
 * and sort the filters to properly sequence their operation.
 *
 * The types have a particular sort order, which allows us to insert them
 * into the filter chain in a determistic order. Within a particular grouping,
 * the ordering is equivalent to the order of calls to ap_add_*_filter().
 */
typedef enum {
    /** These filters are used to alter the content that is passed through
     *  them. Examples are SSI or PHP. */
    AP_FTYPE_RESOURCE     = 10,
    /** These filters are used to alter the content as a whole, but after all
     *  AP_FTYPE_RESOURCE filters are executed.  These filters should not
     *  change the content-type.  An example is deflate.  */
    AP_FTYPE_CONTENT_SET  = 20,
    /** These filters are used to handle the protocol between server and
     *  client.  Examples are HTTP and POP. */
    AP_FTYPE_PROTOCOL     = 30,
    /** These filters implement transport encodings (e.g., chunking). */
    AP_FTYPE_TRANSCODE    = 40,
    /** These filters will alter the content, but in ways that are
     *  more strongly associated with the connection.  Examples are
     *  splitting an HTTP connection into multiple requests and
     *  buffering HTTP responses across multiple requests.
     *
     *  It is important to note that these types of filters are not
     *  allowed in a sub-request. A sub-request's output can certainly
     *  be filtered by ::AP_FTYPE_RESOURCE filters, but all of the "final
     *  processing" is determined by the main request. */
    AP_FTYPE_CONNECTION  = 50,
    /** These filters don't alter the content.  They are responsible for
     *  sending/receiving data to/from the client. */
    AP_FTYPE_NETWORK     = 60
} ap_filter_type;

Graham
From sidnei at enfoldsystems.com  Wed Aug 29 05:55:20 2007
From: sidnei at enfoldsystems.com (Sidnei da Silva)
Date: Wed Aug 29 05:55:47 2007
Subject: [mod_python] Headers not being sent when input/output is over a
	certain size
References: <fb2kr0$f63$1@sea.gmane.org>
	<88e286470708282032i3fe6e390j96bec45522c9bfb5@mail.gmail.com>
	<A27E48C051AA49529DD4EA05B09FE963@topia>
	<88e286470708282057t386062f0ib0f937bc64f62a6@mail.gmail.com>
Message-ID: <A32BEB83ADE348AFBFAEB21171B296B4@topia>

----- Original Message -----
> Do you get a content length header if you enable the Apache
> CONTENT_LENGTH output filter?

I haven't actually tried that, but is it really relevant? The fact is that 
what I'm seeing is that Content-Length *and* Content-Type does get properly 
set when the request has a small size, but not when it goes over a certain 
size. I'm suspecting on the 'automatically send the headers on first 
write()' feature, but haven't dug enough to have 100% confidence that is the 
issue.

> Part of the problem may be that output filters in Apache are a
> resource filter and are only possibly supposed to operate on the
> actual body content. I'm not sure if resource filters are supposed to
> be able to operate on headers.

Could be, but that would not explain why it does work for small requests.

> The CONTENT_LENGTH output filter for example which does operate on
> headers, is registered as a protocol filter and not a resource filter.
>
> I don't have the time to investigate this now, but might be able to
> look at what the differences are later and whether you can even set
> headers in mod_python output filters.

I will give CONTENT_LENGTH a try later this week. Leaving home to attend the 
3rd PyConBrasil right now.

-- 
Sidnei da Silva
Enfold Systems, Inc. 

From sidnei at enfoldsystems.com  Wed Aug 29 06:02:32 2007
From: sidnei at enfoldsystems.com (Sidnei da Silva)
Date: Wed Aug 29 06:02:56 2007
Subject: [mod_python] Headers not being sent when input/output is over a
	certain size
References: <fb2kr0$f63$1@sea.gmane.org>
	<88e286470708282032i3fe6e390j96bec45522c9bfb5@mail.gmail.com>
	<A27E48C051AA49529DD4EA05B09FE963@topia>
	<88e286470708282057t386062f0ib0f937bc64f62a6@mail.gmail.com>
Message-ID: <037C01D2CC8E49839DE343F2EFB2035B@topia>

FWIW, here's the source for the output filter (this is based on an example 
from Lee Brown on this list):

https://svn.enfoldsystems.com/browse/public/enfold.lxml/trunk/src/enfold/lxml/apache.py?rev=1315&view=auto

-- 
Sidnei da Silva
Enfold Systems, Inc. 

From graham.dumpleton at gmail.com  Wed Aug 29 06:12:15 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Aug 29 06:12:34 2007
Subject: [mod_python] Headers not being sent when input/output is over a
	certain size
In-Reply-To: <A32BEB83ADE348AFBFAEB21171B296B4@topia>
References: <fb2kr0$f63$1@sea.gmane.org>
	<88e286470708282032i3fe6e390j96bec45522c9bfb5@mail.gmail.com>
	<A27E48C051AA49529DD4EA05B09FE963@topia>
	<88e286470708282057t386062f0ib0f937bc64f62a6@mail.gmail.com>
	<A32BEB83ADE348AFBFAEB21171B296B4@topia>
Message-ID: <88e286470708290312o8efc6bbk304e4607ea111bf7@mail.gmail.com>

On 29/08/2007, Sidnei da Silva <sidnei@enfoldsystems.com> wrote:
> ----- Original Message -----
> > Do you get a content length header if you enable the Apache
> > CONTENT_LENGTH output filter?
>
> I haven't actually tried that, but is it really relevant? The fact is that
> what I'm seeing is that Content-Length *and* Content-Type does get properly
> set when the request has a small size, but not when it goes over a certain
> size. I'm suspecting on the 'automatically send the headers on first
> write()' feature, but haven't dug enough to have 100% confidence that is the
> issue.
>
> > Part of the problem may be that output filters in Apache are a
> > resource filter and are only possibly supposed to operate on the
> > actual body content. I'm not sure if resource filters are supposed to
> > be able to operate on headers.
>
> Could be, but that would not explain why it does work for small requests.

But you indicated you were buffering all output so sending headers on
first write shouldn't be different for the two.

The reason for suggesting CONTENT_LENGTH is that it is a filter which
is specifically meant to update headers. As I pointed out it registers
itself as a different type of output filter. There may be something
about the filter type that provides guarantees which the filter type
used by mod_python doesn't. Thus, whether it works for small write may
just be undefined behaviour.

> > The CONTENT_LENGTH output filter for example which does operate on
> > headers, is registered as a protocol filter and not a resource filter.
> >
> > I don't have the time to investigate this now, but might be able to
> > look at what the differences are later and whether you can even set
> > headers in mod_python output filters.
>
> I will give CONTENT_LENGTH a try later this week. Leaving home to attend the
> 3rd PyConBrasil right now.

I'll see if I can work out something from the code you sent in the mean time.

Have fun at PyConBrasil. When you get back you will have to tell me
whether there was any talk about mod_wsgi. ;-)

Graham
From liamr at umich.edu  Wed Aug 29 10:28:36 2007
From: liamr at umich.edu (Liam Hoekenga)
Date: Wed Aug 29 10:28:52 2007
Subject: [mod_python] ImportError: reload(): module ... not in sys.modules ?
Message-ID: <Pine.LNX.4.64.0708290956360.10932@whisper.web.itd.umich.edu>

I'm a sysadmin who's part of a group that provides campus-wide web hosting 
at our university.  We're working with a faculty member who would like us 
to host an application he wrote in his departmental web environment and 
we're having issues.  Of course the application "just works" on his 
departmental machine, but when we try it on our box, the most current 
error we're getting is...

 	ImportError: reload(): module _mp_a52d922604fbb12687f4374d3c536a1b
 		not in sys.modules

Their departmental server is  using Apache 2.0.52, Python 2.3.4 and 
mod_python 3.1.3.

We're using Apache 2.2.3, Python 2.5, and mod_python 3.3.1.

I'm not a python programmer and this is my first forray in to mod_python. 
It kind of looks like from the rest of the debugging output that 
_mp_a52d922604fbb12687f4374d3c536a1b is the name of a "file" that 
mod_python has already processed an inserted into a cache.. and that 
perhaps that cache isn't in the python path?  I don't know.  Kinda 
grasping at straws here.

Here's our current mod_python configuration for the directory in question..

     Alias /pharmacy/ /home/pharmacy/Private/html/
    <IfModule mod_python.c>
        <Directory /home/pharmacy/Private/html/>
        AddHandler mod_python .py
        AllowOverride AuthConfig FileInfo Indexes Limit
        PythonAutoReload On
        PythonHandler /home/pharmacy/Private/html/python-program.py
        PythonDebug On
        </Directory>
     </IfModule>

If it does look like problems due to differences between the environments 
in which the application was developed and the where we're trying to 
deploy it, I'd be very appreciative for hints at what needs to be changed 
to make it work.  I'm very open to suggestions.

What follows are the excerpts from the apache error logs, and the output 
we see when we access the page with PythonDebug enabled.

Liam

--------------------------------------

Here's the appropriate output from the apache error log...

[Wed Aug 29 10:08:41 2007] [notice] mod_python (pid=6977, interpreter='example.umich.edu'): Importing module '/home/pharmacy/Private/html/python-program.py'
[Wed Aug 29 10:08:41 2007] [notice] mod_python (pid=6977, interpreter='example.umich.edu'): Importing module '/home/pharmacy/Private/html/tutor.py'
[Wed Aug 29 10:08:41 2007] [notice] mod_python (pid=6977, interpreter='example.umich.edu'): Importing module '/home/pharmacy/Private/html/lesson.py'
[Wed Aug 29 10:08:41 2007] [notice] mod_python (pid=6977, interpreter='example.umich.edu'): Importing module '/home/pharmacy/Private/html/tex.py'
[Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx] mod_python (pid=6977, interpreter='example.umich.edu', phase='PythonHandler', handler='/home/pharmacy/Private/html/python-program.py'): Application error, referer: https://example.umich.edu/pharmacy/python-program.py
[Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx] ServerName: 'example.umich.edu', referer: https://example.umich.edu/pharmacy/python-program.py
[Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx] DocumentRoot: '/usr/share/apache2/htdocs/default/', referer: https://example.umich.edu/pharmacy/python-program.py
[Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx] URI: '/pharmacy/python-program.py', referer: https://example.umich.edu/pharmacy/python-program.py
[Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx] Location: None, referer: https://example.umich.edu/pharmacy/python-program.py
[Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx] Directory: '/home/pharmacy/Private/html/', referer: https://example.umich.edu/pharmacy/python-program.py
[Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx] Filename: '/home/pharmacy/Private/html/python-program.py', referer: https://example.umich.edu/pharmacy/python-program.py
[Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx] PathInfo: '', referer: https://example.umich.edu/pharmacy/python-program.py
[Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx] Traceback (most recent call last):, referer: https://example.umich.edu/pharmacy/python-program.py
[Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx]   File "/usr/lib/python2.5/site-packages/mod_python/importer.py", line 1537, in HandlerDispatch\n    default=default_handler, arg=req, silent=hlist.silent), referer: https://example.umich.edu/pharmacy/python-program.py
[Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx]   File "/usr/lib/python2.5/site-packages/mod_python/importer.py", line 1229, in _process_target\n    result = _execute_target(config, req, object, arg), referer: https://example.umich.edu/pharmacy/python-program.py
[Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx]   File "/usr/lib/python2.5/site-packages/mod_python/importer.py", line 1128, in _execute_target\n    result = object(arg), referer: https://example.umich.edu/pharmacy/python-program.py
[Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx]   File "/home/pharmacy/Private/html/python-program.py", line 224, in handler\n    s = coord.initHistory(session, formd), referer: https://example.umich.edu/pharmacy/python-program.py
[Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx]   File "/home/pharmacy/Private/html/python-program.py", line 132, in initHistory\n    reload(tutor)\t# Force the current version of tutor module to be used., referer: https://example.umich.edu/pharmacy/python-program.py
[Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx] ImportError: reload(): module _mp_a52d922604fbb12687f4374d3c536a1b not in sys.modules, referer: https://example.umich.edu/pharmacy/python-program.py

--------------------------------------

Here's what we get when we access the page with PythonDebug turned on...

...continuing old session

...POST reading: uniqname=bjensen&lessonchoice=Minimal&startup=Start
...cwd='/'
...ls=['lost+found', 'var', '.bash_history', '.authorize', 'afs',  'bin', 'boot', 'dev',
'etc', 'home', 'lib', 'mnt', 'proc', 'root',  'sys', 'sbin', 'ticket', 'tmp', 'usr',
'opt', 'man']
MOD_PYTHON ERROR

ProcessId:      22409
Interpreter:    'example.umich.edu'

ServerName:     'example.umich.edu'
DocumentRoot:   '/usr/share/apache2/htdocs/default/'

URI:            '/pharmacy/python-program.py'
Location:       None
Directory:      '/home/pharmacy/Private/html/'
Filename:       '/home/pharmacy/Private/html/
crippen/python-program.py'
PathInfo:       ''

Phase:          'PythonHandler'
Handler:        '/home/pharmacy/Private/html/
crippen/python-program.py'

Traceback (most recent call last):

   File "/usr/lib/python2.5/site-packages/mod_python/importer.py",  line 1537, in
HandlerDispatch
     default=default_handler, arg=req, silent=hlist.silent)

   File "/usr/lib/python2.5/site-packages/mod_python/importer.py",  line 1229, in
_process_target
     result = _execute_target(config, req, object, arg)

   File "/usr/lib/python2.5/site-packages/mod_python/importer.py",  line 1128, in
_execute_target
     result = object(arg)

   File "/home/pharmacy/Private/html python-program.py",
line 224, in handler
     s = coord.initHistory(session, formd)

   File "/home/pharmacy/Private/html python-program.py",
line 132, in initHistory
     reload(tutor)        # Force the current version of tutor module to be  used.

ImportError: reload(): module _mp_a52d922604fbb12687f4374d3c536a1b  not in sys.modules


MODULE CACHE DETAILS

Accessed:       Tue Aug 28 17:47:07 2007
Generation:     4

_mp_036881b8bfdae0dbd53cd31522b8613c {
   FileName:     '/home/pharmacy/Private/html/ crippen/lesson.py'
   Instance:     1
   Generation:   1
   Modified:     Wed Mar  7 13:53:05 2007
   Imported:     Tue Aug 28 17:26:23 2007
}

_mp_6e0a86c977aa7b4821de3f2e456eeb4d {
   FileName:     '/home/pharmacy/Private/html/
crippen/python-program.py'
   Instance:     1
   Generation:   4
   Modified:     Tue Aug 28 17:26:02 2007
   Imported:     Tue Aug 28 17:26:23 2007
   ModulePath:   '/home/pharmacy/Private/html/'
   Children:     '/home/pharmacy/Private/html/ crippen/tutor.py'
}

_mp_251123f760a2485b75c77026f93acd83 {
   FileName:     '/home/pharmacy/Private/html/ crippen/tex.py'
   Instance:     1
   Generation:   2
   Modified:     Fri Mar 30 09:39:23 2007
   Imported:     Tue Aug 28 17:26:23 2007
}

_mp_a52d922604fbb12687f4374d3c536a1b {
   FileName:     '/home/pharmacy/Private/html/ crippen/tutor.py'
   Instance:     1
   Generation:   3
   Modified:     Tue Aug 21 15:16:35 2007
   Imported:     Tue Aug 28 17:26:23 2007
   Children:     '/home/pharmacy/Private/html/ crippen/lesson.py',
                 '/home/pharmacy/Private/html/ crippen/tex.py'
}

From graham.dumpleton at gmail.com  Wed Aug 29 18:22:20 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Aug 29 18:23:24 2007
Subject: [mod_python] ImportError: reload(): module ... not in sys.modules
	?
In-Reply-To: <Pine.LNX.4.64.0708290956360.10932@whisper.web.itd.umich.edu>
References: <Pine.LNX.4.64.0708290956360.10932@whisper.web.itd.umich.edu>
Message-ID: <88e286470708291522n5ad41b1el37ffb6da439d7593@mail.gmail.com>

Quick fix is to comment out the line with 'reload()' on it.

Beyond that you have two options:

1. Downgrade from mod_python 3.3.1 to 3.2.10.

2. Have the author of the application upgrade to 3.3.1 and have them
fix their code to eliminate use of reload() which will not work with
modules in 3.3.1 managed by mod_python and was never a reliable way in
older versions of mod_python of reloading modules anyway. To assist
them in fixing their code when they move to 3.3.1, point them to the
function 'import_module()' in the documentation:

  http://www.modpython.org/live/current/doc-html/pyapi-apmeth.html

That function is the correct way in mod_python of managing reloading
of mod_python managed modules.

Graham

On 30/08/2007, Liam Hoekenga <liamr@umich.edu> wrote:
> I'm a sysadmin who's part of a group that provides campus-wide web hosting
> at our university.  We're working with a faculty member who would like us
> to host an application he wrote in his departmental web environment and
> we're having issues.  Of course the application "just works" on his
> departmental machine, but when we try it on our box, the most current
> error we're getting is...
>
>         ImportError: reload(): module _mp_a52d922604fbb12687f4374d3c536a1b
>                 not in sys.modules
>
> Their departmental server is  using Apache 2.0.52, Python 2.3.4 and
> mod_python 3.1.3.
>
> We're using Apache 2.2.3, Python 2.5, and mod_python 3.3.1.
>
> I'm not a python programmer and this is my first forray in to mod_python.
> It kind of looks like from the rest of the debugging output that
> _mp_a52d922604fbb12687f4374d3c536a1b is the name of a "file" that
> mod_python has already processed an inserted into a cache.. and that
> perhaps that cache isn't in the python path?  I don't know.  Kinda
> grasping at straws here.
>
> Here's our current mod_python configuration for the directory in question..
>
>      Alias /pharmacy/ /home/pharmacy/Private/html/
>     <IfModule mod_python.c>
>         <Directory /home/pharmacy/Private/html/>
>         AddHandler mod_python .py
>         AllowOverride AuthConfig FileInfo Indexes Limit
>         PythonAutoReload On
>         PythonHandler /home/pharmacy/Private/html/python-program.py
>         PythonDebug On
>         </Directory>
>      </IfModule>
>
> If it does look like problems due to differences between the environments
> in which the application was developed and the where we're trying to
> deploy it, I'd be very appreciative for hints at what needs to be changed
> to make it work.  I'm very open to suggestions.
>
> What follows are the excerpts from the apache error logs, and the output
> we see when we access the page with PythonDebug enabled.
>
> Liam
>
> --------------------------------------
>
> Here's the appropriate output from the apache error log...
>
> [Wed Aug 29 10:08:41 2007] [notice] mod_python (pid=6977, interpreter='example.umich.edu'): Importing module '/home/pharmacy/Private/html/python-program.py'
> [Wed Aug 29 10:08:41 2007] [notice] mod_python (pid=6977, interpreter='example.umich.edu'): Importing module '/home/pharmacy/Private/html/tutor.py'
> [Wed Aug 29 10:08:41 2007] [notice] mod_python (pid=6977, interpreter='example.umich.edu'): Importing module '/home/pharmacy/Private/html/lesson.py'
> [Wed Aug 29 10:08:41 2007] [notice] mod_python (pid=6977, interpreter='example.umich.edu'): Importing module '/home/pharmacy/Private/html/tex.py'
> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx] mod_python (pid=6977, interpreter='example.umich.edu', phase='PythonHandler', handler='/home/pharmacy/Private/html/python-program.py'): Application error, referer: https://example.umich.edu/pharmacy/python-program.py
> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx] ServerName: 'example.umich.edu', referer: https://example.umich.edu/pharmacy/python-program.py
> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx] DocumentRoot: '/usr/share/apache2/htdocs/default/', referer: https://example.umich.edu/pharmacy/python-program.py
> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx] URI: '/pharmacy/python-program.py', referer: https://example.umich.edu/pharmacy/python-program.py
> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx] Location: None, referer: https://example.umich.edu/pharmacy/python-program.py
> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx] Directory: '/home/pharmacy/Private/html/', referer: https://example.umich.edu/pharmacy/python-program.py
> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx] Filename: '/home/pharmacy/Private/html/python-program.py', referer: https://example.umich.edu/pharmacy/python-program.py
> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx] PathInfo: '', referer: https://example.umich.edu/pharmacy/python-program.py
> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx] Traceback (most recent call last):, referer: https://example.umich.edu/pharmacy/python-program.py
> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx]   File "/usr/lib/python2.5/site-packages/mod_python/importer.py", line 1537, in HandlerDispatch\n    default=default_handler, arg=req, silent=hlist.silent), referer: https://example.umich.edu/pharmacy/python-program.py
> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx]   File "/usr/lib/python2.5/site-packages/mod_python/importer.py", line 1229, in _process_target\n    result = _execute_target(config, req, object, arg), referer: https://example.umich.edu/pharmacy/python-program.py
> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx]   File "/usr/lib/python2.5/site-packages/mod_python/importer.py", line 1128, in _execute_target\n    result = object(arg), referer: https://example.umich.edu/pharmacy/python-program.py
> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx]   File "/home/pharmacy/Private/html/python-program.py", line 224, in handler\n    s = coord.initHistory(session, formd), referer: https://example.umich.edu/pharmacy/python-program.py
> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx]   File "/home/pharmacy/Private/html/python-program.py", line 132, in initHistory\n    reload(tutor)\t# Force the current version of tutor module to be used., referer: https://example.umich.edu/pharmacy/python-program.py
> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx] ImportError: reload(): module _mp_a52d922604fbb12687f4374d3c536a1b not in sys.modules, referer: https://example.umich.edu/pharmacy/python-program.py
>
> --------------------------------------
>
> Here's what we get when we access the page with PythonDebug turned on...
>
> ...continuing old session
>
> ...POST reading: uniqname=bjensen&lessonchoice=Minimal&startup=Start
> ...cwd='/'
> ...ls=['lost+found', 'var', '.bash_history', '.authorize', 'afs',  'bin', 'boot', 'dev',
> 'etc', 'home', 'lib', 'mnt', 'proc', 'root',  'sys', 'sbin', 'ticket', 'tmp', 'usr',
> 'opt', 'man']
> MOD_PYTHON ERROR
>
> ProcessId:      22409
> Interpreter:    'example.umich.edu'
>
> ServerName:     'example.umich.edu'
> DocumentRoot:   '/usr/share/apache2/htdocs/default/'
>
> URI:            '/pharmacy/python-program.py'
> Location:       None
> Directory:      '/home/pharmacy/Private/html/'
> Filename:       '/home/pharmacy/Private/html/
> crippen/python-program.py'
> PathInfo:       ''
>
> Phase:          'PythonHandler'
> Handler:        '/home/pharmacy/Private/html/
> crippen/python-program.py'
>
> Traceback (most recent call last):
>
>    File "/usr/lib/python2.5/site-packages/mod_python/importer.py",  line 1537, in
> HandlerDispatch
>      default=default_handler, arg=req, silent=hlist.silent)
>
>    File "/usr/lib/python2.5/site-packages/mod_python/importer.py",  line 1229, in
> _process_target
>      result = _execute_target(config, req, object, arg)
>
>    File "/usr/lib/python2.5/site-packages/mod_python/importer.py",  line 1128, in
> _execute_target
>      result = object(arg)
>
>    File "/home/pharmacy/Private/html python-program.py",
> line 224, in handler
>      s = coord.initHistory(session, formd)
>
>    File "/home/pharmacy/Private/html python-program.py",
> line 132, in initHistory
>      reload(tutor)        # Force the current version of tutor module to be  used.
>
> ImportError: reload(): module _mp_a52d922604fbb12687f4374d3c536a1b  not in sys.modules
>
>
> MODULE CACHE DETAILS
>
> Accessed:       Tue Aug 28 17:47:07 2007
> Generation:     4
>
> _mp_036881b8bfdae0dbd53cd31522b8613c {
>    FileName:     '/home/pharmacy/Private/html/ crippen/lesson.py'
>    Instance:     1
>    Generation:   1
>    Modified:     Wed Mar  7 13:53:05 2007
>    Imported:     Tue Aug 28 17:26:23 2007
> }
>
> _mp_6e0a86c977aa7b4821de3f2e456eeb4d {
>    FileName:     '/home/pharmacy/Private/html/
> crippen/python-program.py'
>    Instance:     1
>    Generation:   4
>    Modified:     Tue Aug 28 17:26:02 2007
>    Imported:     Tue Aug 28 17:26:23 2007
>    ModulePath:   '/home/pharmacy/Private/html/'
>    Children:     '/home/pharmacy/Private/html/ crippen/tutor.py'
> }
>
> _mp_251123f760a2485b75c77026f93acd83 {
>    FileName:     '/home/pharmacy/Private/html/ crippen/tex.py'
>    Instance:     1
>    Generation:   2
>    Modified:     Fri Mar 30 09:39:23 2007
>    Imported:     Tue Aug 28 17:26:23 2007
> }
>
> _mp_a52d922604fbb12687f4374d3c536a1b {
>    FileName:     '/home/pharmacy/Private/html/ crippen/tutor.py'
>    Instance:     1
>    Generation:   3
>    Modified:     Tue Aug 21 15:16:35 2007
>    Imported:     Tue Aug 28 17:26:23 2007
>    Children:     '/home/pharmacy/Private/html/ crippen/lesson.py',
>                  '/home/pharmacy/Private/html/ crippen/tex.py'
> }
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From boris.dusek at gmail.com  Wed Aug 29 23:10:27 2007
From: boris.dusek at gmail.com (=?UTF-8?Q?Boris_Du=C5=A1ek?=)
Date: Wed Aug 29 23:10:41 2007
Subject: [mod_python] Session-related hang
In-Reply-To: <88e286470708282025p36d792afxf9134ad6ea5a0d5a@mail.gmail.com>
References: <b2c603da0708281926w45322828s194214a0212b443@mail.gmail.com>
	<88e286470708282025p36d792afxf9134ad6ea5a0d5a@mail.gmail.com>
Message-ID: <b2c603da0708292010la3cd9bat1c63792108dbf8f1@mail.gmail.com>

Hi Graham,

On 8/28/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> You are likely trying to create a session object when one has already
> been created for that request already and thus dead locking on
> yourself. There are lots of examples of people doing this in the
> www.modpython.org mailing list archives, search from www.modpython.org
> search box.
>
> What is in generate_content(...)? Without seeing how you are
> manipulating sessions can say exactly what you are doing wrong

The problem is fixed now. It was permission issue on the dbm file
where DbmSession stores the session information (/tmp/mp_sess.dbm by
default).

> BTW, why are you creating a derived session object type?

Because we need some convenience methods for the session class, like
for user management etc.

> Also, using reload() like that is not recommended. Upgrade to
> mod_python 3.3.1 and read about import_module() function in:
>
>   http://www.modpython.org/live/current/doc-html/pyapi-apmeth.html

We would love to upgrade. It would be easy on our development virtual
machines. But not at all easy to push for this upgrade on a production
server where many sites are using it.

> Graham

Thank you for your answer,
Boris

>
> On 29/08/2007, Boris Du?ek <boris.dusek@gmail.com> wrote:
> > Hi,
> >
> > I am using Apache 2.2.3, mod_python 2.3.8. I experience a hang that is
> > related to Session.
> > I have such a class:
> >
> > file nanosession.py:
> > class NanoSession(Session.DbmSession):
> >     def __init__(self, req):
> >         logging.debug("In NanoSession.__init__")
> >         logging.debug("Calling DbmSession.__init__")
> >         Session.DbmSession.__init__(self, req)
> >
> >     def ...
> >
> > in the index.py file, that gets displayed by mod_python.publisher,
> > there is following code:
> >
> > def index(req, **vars):
> >     logging.debug("Entered index.py/index")
> >
> >     logging.debug("Reloading module 1")
> >     reload(module1)
> >
> >     logging.debug("Reloading module nanosession")
> >     reload(nanosession)
> >
> >     logging.debug("Reloading module 2")
> >     reload(module2)
> >
> >     logging.debug("Generating page content")
> >     content = generate_content(...)
> >
> >
> > When I hit for the index.py page, it was working for the first time. I
> > am not really sure what I have been doing then, probably just surfing
> > the other pages on the same site. And then suddenly, from then on,
> > when I wanted to display some page, it took forever (I mean not long,
> > I mean it did not display, Firefox displaying "Waiting for ...",
> > netcat displaying no output available). Then I asked a friend at a
> > different computer (with a different IP) to try to access the same
> > webpage - he could access it, and it displayed immediately. However,
> > then he hit the reload button in his browser, and he was immediately
> > from then on experiencing the same "never loads" behavior for any
> > webpage that uses sessions.
> >
> > The logging output from the above code shows that it hangs on
> > DbmSession.__init__:
> >
> > DEBUG:root:Entered index.py/index
> > DEBUG:root:Reloading module webpage
> > DEBUG:root:Reloading module webpage
> > DEBUG:root:Reloading module webpage
> > DEBUG:root:Creating session
> > DEBUG:root:nanosession.py/NanoSession.__init__
> > DEBUG:root:calling DbnSession.__init__
> > DEBUG:root:Entered index.py/index
> > DEBUG:root:Reloading module webpage
> > DEBUG:root:Reloading module webpage
> > DEBUG:root:Reloading module webpage
> > DEBUG:root:Creating session
> > DEBUG:root:nanosession.py/NanoSession.__init__
> > DEBUG:root:calling DbmSession.__init__
> > ...
> > and so on...
> >
> > Do you please have any suggestions about possible cause and workarounds?
> >
> > Thanks,
> > Boris Du?ek
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
>

From sidnei at enfoldsystems.com  Thu Aug 30 09:45:10 2007
From: sidnei at enfoldsystems.com (Sidnei da Silva)
Date: Thu Aug 30 09:45:23 2007
Subject: [mod_python] Headers not being sent when input/output is over a
	certain size
In-Reply-To: <A32BEB83ADE348AFBFAEB21171B296B4@topia>
References: <fb2kr0$f63$1@sea.gmane.org>
	<88e286470708282032i3fe6e390j96bec45522c9bfb5@mail.gmail.com>
	<A27E48C051AA49529DD4EA05B09FE963@topia>
	<88e286470708282057t386062f0ib0f937bc64f62a6@mail.gmail.com>
	<A32BEB83ADE348AFBFAEB21171B296B4@topia>
Message-ID: <a7a2b76b0708300645j33a5139s64fcddc94eda1cf2@mail.gmail.com>

On 8/29/07, Sidnei da Silva <sidnei@enfoldsystems.com> wrote:
> > Do you get a content length header if you enable the Apache
> > CONTENT_LENGTH output filter?

Ok, so I tried it this way:

   AddOutputFilterByType LXMLFILTER;CONTENT_LENGTH text/xml

And my Content-Type header does *not* get updated to the actual
content length did output. :(

Is there anything I can do to help debugging this?

-- 
Sidnei da Silva
Enfold Systems                http://enfoldsystems.com
Fax +1 832 201 8856     Office +1 713 942 2377 Ext 214
From liamr at umich.edu  Thu Aug 30 10:51:42 2007
From: liamr at umich.edu (liamr@umich.edu)
Date: Thu Aug 30 10:51:58 2007
Subject: [mod_python] ImportError: reload(): module ... not in
	sys.modules ?
In-Reply-To: <88e286470708291522n5ad41b1el37ffb6da439d7593@mail.gmail.com>
References: <Pine.LNX.4.64.0708290956360.10932@whisper.web.itd.umich.edu>
	<88e286470708291522n5ad41b1el37ffb6da439d7593@mail.gmail.com>
Message-ID: <20070830105142.9jdr2la7wo4g8k8g@web.mail.umich.edu>

So you'd say this is due to a fundamental change in behavior between 
3.3.1 and 3.2.10?

Might the version difference also explain..

File "/usr/lib/python2.5/xml/sax/handler.py", line 38, in fatalError
    raise exception

  SAXParseException:

    https://example.umich.edu/pharmacy//lessonsdir/lesson.dtd:1:0:      
   error in processing external entity reference

We're running into some other stuff that I figured may be due to his 
application being developed in a the 3.1 branch and us running the 3.3 
branch, but I'm not familiar enough with what's going on to know what 
I'm looking for the in the change log.

Thanks!
Liam


Quoting Graham Dumpleton <graham.dumpleton@gmail.com>:

> Quick fix is to comment out the line with 'reload()' on it.
>
> Beyond that you have two options:
>
> 1. Downgrade from mod_python 3.3.1 to 3.2.10.
>
> 2. Have the author of the application upgrade to 3.3.1 and have them
> fix their code to eliminate use of reload() which will not work with
> modules in 3.3.1 managed by mod_python and was never a reliable way in
> older versions of mod_python of reloading modules anyway. To assist
> them in fixing their code when they move to 3.3.1, point them to the
> function 'import_module()' in the documentation:
>
>  http://www.modpython.org/live/current/doc-html/pyapi-apmeth.html
>
> That function is the correct way in mod_python of managing reloading
> of mod_python managed modules.
>
> Graham
>
> On 30/08/2007, Liam Hoekenga <liamr@umich.edu> wrote:
>> I'm a sysadmin who's part of a group that provides campus-wide web hosting
>> at our university.  We're working with a faculty member who would like us
>> to host an application he wrote in his departmental web environment and
>> we're having issues.  Of course the application "just works" on his
>> departmental machine, but when we try it on our box, the most current
>> error we're getting is...
>>
>>         ImportError: reload(): module _mp_a52d922604fbb12687f4374d3c536a1b
>>                 not in sys.modules
>>
>> Their departmental server is  using Apache 2.0.52, Python 2.3.4 and
>> mod_python 3.1.3.
>>
>> We're using Apache 2.2.3, Python 2.5, and mod_python 3.3.1.
>>
>> I'm not a python programmer and this is my first forray in to mod_python.
>> It kind of looks like from the rest of the debugging output that
>> _mp_a52d922604fbb12687f4374d3c536a1b is the name of a "file" that
>> mod_python has already processed an inserted into a cache.. and that
>> perhaps that cache isn't in the python path?  I don't know.  Kinda
>> grasping at straws here.
>>
>> Here's our current mod_python configuration for the directory in question..
>>
>>      Alias /pharmacy/ /home/pharmacy/Private/html/
>>     <IfModule mod_python.c>
>>         <Directory /home/pharmacy/Private/html/>
>>         AddHandler mod_python .py
>>         AllowOverride AuthConfig FileInfo Indexes Limit
>>         PythonAutoReload On
>>         PythonHandler /home/pharmacy/Private/html/python-program.py
>>         PythonDebug On
>>         </Directory>
>>      </IfModule>
>>
>> If it does look like problems due to differences between the environments
>> in which the application was developed and the where we're trying to
>> deploy it, I'd be very appreciative for hints at what needs to be changed
>> to make it work.  I'm very open to suggestions.
>>
>> What follows are the excerpts from the apache error logs, and the output
>> we see when we access the page with PythonDebug enabled.
>>
>> Liam
>>
>> --------------------------------------
>>
>> Here's the appropriate output from the apache error log...
>>
>> [Wed Aug 29 10:08:41 2007] [notice] mod_python (pid=6977, 
>> interpreter='example.umich.edu'): Importing module 
>> '/home/pharmacy/Private/html/python-program.py'
>> [Wed Aug 29 10:08:41 2007] [notice] mod_python (pid=6977, 
>> interpreter='example.umich.edu'): Importing module 
>> '/home/pharmacy/Private/html/tutor.py'
>> [Wed Aug 29 10:08:41 2007] [notice] mod_python (pid=6977, 
>> interpreter='example.umich.edu'): Importing module 
>> '/home/pharmacy/Private/html/lesson.py'
>> [Wed Aug 29 10:08:41 2007] [notice] mod_python (pid=6977, 
>> interpreter='example.umich.edu'): Importing module 
>> '/home/pharmacy/Private/html/tex.py'
>> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx] 
>> mod_python (pid=6977, interpreter='example.umich.edu', 
>> phase='PythonHandler', 
>> handler='/home/pharmacy/Private/html/python-program.py'): 
>> Application error, referer: 
>> https://example.umich.edu/pharmacy/python-program.py
>> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx] 
>> ServerName: 'example.umich.edu', referer: 
>> https://example.umich.edu/pharmacy/python-program.py
>> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx] 
>> DocumentRoot: '/usr/share/apache2/htdocs/default/', referer: 
>> https://example.umich.edu/pharmacy/python-program.py
>> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx] URI: 
>> '/pharmacy/python-program.py', referer: 
>> https://example.umich.edu/pharmacy/python-program.py
>> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx] 
>> Location: None, referer: 
>> https://example.umich.edu/pharmacy/python-program.py
>> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx] 
>> Directory: '/home/pharmacy/Private/html/', referer: 
>> https://example.umich.edu/pharmacy/python-program.py
>> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx] 
>> Filename: '/home/pharmacy/Private/html/python-program.py', referer: 
>> https://example.umich.edu/pharmacy/python-program.py
>> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx] 
>> PathInfo: '', referer: 
>> https://example.umich.edu/pharmacy/python-program.py
>> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx] 
>> Traceback (most recent call last):, referer: 
>> https://example.umich.edu/pharmacy/python-program.py
>> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx]   File 
>> "/usr/lib/python2.5/site-packages/mod_python/importer.py", line 
>> 1537, in HandlerDispatch\n    default=default_handler, arg=req, 
>> silent=hlist.silent), referer: 
>> https://example.umich.edu/pharmacy/python-program.py
>> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx]   File 
>> "/usr/lib/python2.5/site-packages/mod_python/importer.py", line 
>> 1229, in _process_target\n    result = _execute_target(config, req, 
>> object, arg), referer: 
>> https://example.umich.edu/pharmacy/python-program.py
>> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx]   File 
>> "/usr/lib/python2.5/site-packages/mod_python/importer.py", line 
>> 1128, in _execute_target\n    result = object(arg), referer: 
>> https://example.umich.edu/pharmacy/python-program.py
>> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx]   File 
>> "/home/pharmacy/Private/html/python-program.py", line 224, in 
>> handler\n    s = coord.initHistory(session, formd), referer: 
>> https://example.umich.edu/pharmacy/python-program.py
>> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx]   File 
>> "/home/pharmacy/Private/html/python-program.py", line 132, in 
>> initHistory\n    reload(tutor)\t# Force the current version of tutor 
>> module to be used., referer: 
>> https://example.umich.edu/pharmacy/python-program.py
>> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx] 
>> ImportError: reload(): module _mp_a52d922604fbb12687f4374d3c536a1b 
>> not in sys.modules, referer: 
>> https://example.umich.edu/pharmacy/python-program.py
>>
>> --------------------------------------
>>
>> Here's what we get when we access the page with PythonDebug turned on...
>>
>> ...continuing old session
>>
>> ...POST reading: uniqname=bjensen&lessonchoice=Minimal&startup=Start
>> ...cwd='/'
>> ...ls=['lost+found', 'var', '.bash_history', '.authorize', 'afs',  
>> 'bin', 'boot', 'dev',
>> 'etc', 'home', 'lib', 'mnt', 'proc', 'root',  'sys', 'sbin', 
>> 'ticket', 'tmp', 'usr',
>> 'opt', 'man']
>> MOD_PYTHON ERROR
>>
>> ProcessId:      22409
>> Interpreter:    'example.umich.edu'
>>
>> ServerName:     'example.umich.edu'
>> DocumentRoot:   '/usr/share/apache2/htdocs/default/'
>>
>> URI:            '/pharmacy/python-program.py'
>> Location:       None
>> Directory:      '/home/pharmacy/Private/html/'
>> Filename:       '/home/pharmacy/Private/html/
>> crippen/python-program.py'
>> PathInfo:       ''
>>
>> Phase:          'PythonHandler'
>> Handler:        '/home/pharmacy/Private/html/
>> crippen/python-program.py'
>>
>> Traceback (most recent call last):
>>
>>    File "/usr/lib/python2.5/site-packages/mod_python/importer.py",  
>> line 1537, in
>> HandlerDispatch
>>      default=default_handler, arg=req, silent=hlist.silent)
>>
>>    File "/usr/lib/python2.5/site-packages/mod_python/importer.py",  
>> line 1229, in
>> _process_target
>>      result = _execute_target(config, req, object, arg)
>>
>>    File "/usr/lib/python2.5/site-packages/mod_python/importer.py",  
>> line 1128, in
>> _execute_target
>>      result = object(arg)
>>
>>    File "/home/pharmacy/Private/html python-program.py",
>> line 224, in handler
>>      s = coord.initHistory(session, formd)
>>
>>    File "/home/pharmacy/Private/html python-program.py",
>> line 132, in initHistory
>>      reload(tutor)        # Force the current version of tutor 
>> module to be  used.
>>
>> ImportError: reload(): module _mp_a52d922604fbb12687f4374d3c536a1b  
>> not in sys.modules
>>
>>
>> MODULE CACHE DETAILS
>>
>> Accessed:       Tue Aug 28 17:47:07 2007
>> Generation:     4
>>
>> _mp_036881b8bfdae0dbd53cd31522b8613c {
>>    FileName:     '/home/pharmacy/Private/html/ crippen/lesson.py'
>>    Instance:     1
>>    Generation:   1
>>    Modified:     Wed Mar  7 13:53:05 2007
>>    Imported:     Tue Aug 28 17:26:23 2007
>> }
>>
>> _mp_6e0a86c977aa7b4821de3f2e456eeb4d {
>>    FileName:     '/home/pharmacy/Private/html/
>> crippen/python-program.py'
>>    Instance:     1
>>    Generation:   4
>>    Modified:     Tue Aug 28 17:26:02 2007
>>    Imported:     Tue Aug 28 17:26:23 2007
>>    ModulePath:   '/home/pharmacy/Private/html/'
>>    Children:     '/home/pharmacy/Private/html/ crippen/tutor.py'
>> }
>>
>> _mp_251123f760a2485b75c77026f93acd83 {
>>    FileName:     '/home/pharmacy/Private/html/ crippen/tex.py'
>>    Instance:     1
>>    Generation:   2
>>    Modified:     Fri Mar 30 09:39:23 2007
>>    Imported:     Tue Aug 28 17:26:23 2007
>> }
>>
>> _mp_a52d922604fbb12687f4374d3c536a1b {
>>    FileName:     '/home/pharmacy/Private/html/ crippen/tutor.py'
>>    Instance:     1
>>    Generation:   3
>>    Modified:     Tue Aug 21 15:16:35 2007
>>    Imported:     Tue Aug 28 17:26:23 2007
>>    Children:     '/home/pharmacy/Private/html/ crippen/lesson.py',
>>                  '/home/pharmacy/Private/html/ crippen/tex.py'
>> }
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>
>
> !DSPAM:46d5f1ac113225939618124!
>
>
>
>


From sidnei at enfoldsystems.com  Thu Aug 30 11:42:19 2007
From: sidnei at enfoldsystems.com (Sidnei da Silva)
Date: Thu Aug 30 11:42:30 2007
Subject: [mod_python] Headers not being sent when input/output is over a
	certain size
In-Reply-To: <a7a2b76b0708300645j33a5139s64fcddc94eda1cf2@mail.gmail.com>
References: <fb2kr0$f63$1@sea.gmane.org>
	<88e286470708282032i3fe6e390j96bec45522c9bfb5@mail.gmail.com>
	<A27E48C051AA49529DD4EA05B09FE963@topia>
	<88e286470708282057t386062f0ib0f937bc64f62a6@mail.gmail.com>
	<A32BEB83ADE348AFBFAEB21171B296B4@topia>
	<a7a2b76b0708300645j33a5139s64fcddc94eda1cf2@mail.gmail.com>
Message-ID: <a7a2b76b0708300842m6dbc8d4frbfa260c8281c3be6@mail.gmail.com>

On 8/30/07, Sidnei da Silva <sidnei@enfoldsystems.com> wrote:
> Is there anything I can do to help debugging this?

Ok, here's some information that might be meaningful to the problem I'm having.

The data that is being fed into this output filter is coming from mod_proxy.

I've looked at the mod_proxy source and I see that it does some stuff
directly with output filters and headers, but couldn't yet find what
would cause it to have different behaviour depending on the response
size.

It is certainly the case that when the output filter is called, if the
response size is small, bytes_sent is zero, and if the response size
is bigger, bytes_sent is 418 which looks like the size of the headers.

Maybe there's some other condition that's triggering the premature
sending of the headers which I couldn't find yet.
-- 
Sidnei da Silva
Enfold Systems                http://enfoldsystems.com
Fax +1 832 201 8856     Office +1 713 942 2377 Ext 214
From chowell at pyxisinnovation.com  Thu Aug 30 14:02:58 2007
From: chowell at pyxisinnovation.com (Chris Howell)
Date: Thu Aug 30 14:03:17 2007
Subject: [mod_python] mod_python
Message-ID: <46D70652.7000609@pyxisinnovation.com>

Hi All,

I've installed the Apache webserver 2.2.4 onto a machine. I am trying to 
get the python mod working for the apache webserver.  I installed 
mod_python-3.3.1, for windows and I have the correct version of Python 
installed. I did everything the install asked me to do, when I edited my 
httpd.conf file for apache I added this line

LoadModule python_module modules/mod_python.so

Where all of the other load modules happen, to be.

So I shut the apache server down and I restarted it when I restart the 
server I get this error message.

"Cannot load C:/Program Files/Apache Software 
Foundation/Apache2.2/modules/mod_python.so into server. The specified 
procedure could not be found.

When I went to the modules directory, under the apache root, the 
mod_python.so file does exist so I am not sure what the problem is or 
what the solution is. Any light someone could shed on this would be 
greatly appreciated.

Regards,
Chris Howell
Software Engineer
the PYXIS innovation - /Common Ground for Digital Earth /
Kingston, Ontario
w: www.pyxisinnovation.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070830/a77a66b1/attachment.html
From graham.dumpleton at gmail.com  Thu Aug 30 19:23:54 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Aug 30 19:24:12 2007
Subject: [mod_python] ImportError: reload(): module ... not in sys.modules
	?
In-Reply-To: <20070830105142.9jdr2la7wo4g8k8g@web.mail.umich.edu>
References: <Pine.LNX.4.64.0708290956360.10932@whisper.web.itd.umich.edu>
	<88e286470708291522n5ad41b1el37ffb6da439d7593@mail.gmail.com>
	<20070830105142.9jdr2la7wo4g8k8g@web.mail.umich.edu>
Message-ID: <88e286470708301623q374651dax1ba28e536f74b0ae@mail.gmail.com>

On 31/08/2007, liamr@umich.edu <liamr@umich.edu> wrote:
> So you'd say this is due to a fundamental change in behavior between
> 3.3.1 and 3.2.10?

Depends on how you look at it. Using reload() explicitly isn't
necessary a reliable way of doing things in the first place when using
mod_python and would in general not be recommended.

The import_module() function does actually exist in older versions of
mod_python and if they use it, their code should be reasonably
portable between the versions. They should base their use of the
function on older documentation though as newer version provides
additional features and if they were relied upon the code wouldn't be
backward compatible.

What occurred in 3.3.1 is that the implementation of import_module()
was completed redone to fix a range of problems:

  http://www.dscpl.com.au/wiki/ModPython/Articles/ModuleImportingIsBroken

The changes created a few incompatibilities, but it would only affect
a very small percentage of people. That reload() will now not work on
modules managed by the mod_python module importer is one.

If you want to restore the old module importer functionality without
downgrading mod_python, then you can also set the
'mod_python.legacy.importer' option as described in the documentation
for 'import_module()'.

> Might the version difference also explain..
>
> File "/usr/lib/python2.5/xml/sax/handler.py", line 38, in fatalError
>     raise exception
>
>   SAXParseException:
>
>     https://example.umich.edu/pharmacy//lessonsdir/lesson.dtd:1:0:
>    error in processing external entity reference
>
> We're running into some other stuff that I figured may be due to his
> application being developed in a the 3.1 branch and us running the 3.3
> branch, but I'm not familiar enough with what's going on to know what
> I'm looking for the in the change log.

This latter issue looks more to be because of the difference in the
Python version than mod_python. Thus, you have more to contend with
than the differences in mod_python version and I'd contend that
mod_python version differences will actually be the lessor of your
problems.

Graham

> Quoting Graham Dumpleton <graham.dumpleton@gmail.com>:
>
> > Quick fix is to comment out the line with 'reload()' on it.
> >
> > Beyond that you have two options:
> >
> > 1. Downgrade from mod_python 3.3.1 to 3.2.10.
> >
> > 2. Have the author of the application upgrade to 3.3.1 and have them
> > fix their code to eliminate use of reload() which will not work with
> > modules in 3.3.1 managed by mod_python and was never a reliable way in
> > older versions of mod_python of reloading modules anyway. To assist
> > them in fixing their code when they move to 3.3.1, point them to the
> > function 'import_module()' in the documentation:
> >
> >  http://www.modpython.org/live/current/doc-html/pyapi-apmeth.html
> >
> > That function is the correct way in mod_python of managing reloading
> > of mod_python managed modules.
> >
> > Graham
> >
> > On 30/08/2007, Liam Hoekenga <liamr@umich.edu> wrote:
> >> I'm a sysadmin who's part of a group that provides campus-wide web hosting
> >> at our university.  We're working with a faculty member who would like us
> >> to host an application he wrote in his departmental web environment and
> >> we're having issues.  Of course the application "just works" on his
> >> departmental machine, but when we try it on our box, the most current
> >> error we're getting is...
> >>
> >>         ImportError: reload(): module _mp_a52d922604fbb12687f4374d3c536a1b
> >>                 not in sys.modules
> >>
> >> Their departmental server is  using Apache 2.0.52, Python 2.3.4 and
> >> mod_python 3.1.3.
> >>
> >> We're using Apache 2.2.3, Python 2.5, and mod_python 3.3.1.
> >>
> >> I'm not a python programmer and this is my first forray in to mod_python.
> >> It kind of looks like from the rest of the debugging output that
> >> _mp_a52d922604fbb12687f4374d3c536a1b is the name of a "file" that
> >> mod_python has already processed an inserted into a cache.. and that
> >> perhaps that cache isn't in the python path?  I don't know.  Kinda
> >> grasping at straws here.
> >>
> >> Here's our current mod_python configuration for the directory in question..
> >>
> >>      Alias /pharmacy/ /home/pharmacy/Private/html/
> >>     <IfModule mod_python.c>
> >>         <Directory /home/pharmacy/Private/html/>
> >>         AddHandler mod_python .py
> >>         AllowOverride AuthConfig FileInfo Indexes Limit
> >>         PythonAutoReload On
> >>         PythonHandler /home/pharmacy/Private/html/python-program.py
> >>         PythonDebug On
> >>         </Directory>
> >>      </IfModule>
> >>
> >> If it does look like problems due to differences between the environments
> >> in which the application was developed and the where we're trying to
> >> deploy it, I'd be very appreciative for hints at what needs to be changed
> >> to make it work.  I'm very open to suggestions.
> >>
> >> What follows are the excerpts from the apache error logs, and the output
> >> we see when we access the page with PythonDebug enabled.
> >>
> >> Liam
> >>
> >> --------------------------------------
> >>
> >> Here's the appropriate output from the apache error log...
> >>
> >> [Wed Aug 29 10:08:41 2007] [notice] mod_python (pid=6977,
> >> interpreter='example.umich.edu'): Importing module
> >> '/home/pharmacy/Private/html/python-program.py'
> >> [Wed Aug 29 10:08:41 2007] [notice] mod_python (pid=6977,
> >> interpreter='example.umich.edu'): Importing module
> >> '/home/pharmacy/Private/html/tutor.py'
> >> [Wed Aug 29 10:08:41 2007] [notice] mod_python (pid=6977,
> >> interpreter='example.umich.edu'): Importing module
> >> '/home/pharmacy/Private/html/lesson.py'
> >> [Wed Aug 29 10:08:41 2007] [notice] mod_python (pid=6977,
> >> interpreter='example.umich.edu'): Importing module
> >> '/home/pharmacy/Private/html/tex.py'
> >> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx]
> >> mod_python (pid=6977, interpreter='example.umich.edu',
> >> phase='PythonHandler',
> >> handler='/home/pharmacy/Private/html/python-program.py'):
> >> Application error, referer:
> >> https://example.umich.edu/pharmacy/python-program.py
> >> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx]
> >> ServerName: 'example.umich.edu', referer:
> >> https://example.umich.edu/pharmacy/python-program.py
> >> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx]
> >> DocumentRoot: '/usr/share/apache2/htdocs/default/', referer:
> >> https://example.umich.edu/pharmacy/python-program.py
> >> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx] URI:
> >> '/pharmacy/python-program.py', referer:
> >> https://example.umich.edu/pharmacy/python-program.py
> >> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx]
> >> Location: None, referer:
> >> https://example.umich.edu/pharmacy/python-program.py
> >> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx]
> >> Directory: '/home/pharmacy/Private/html/', referer:
> >> https://example.umich.edu/pharmacy/python-program.py
> >> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx]
> >> Filename: '/home/pharmacy/Private/html/python-program.py', referer:
> >> https://example.umich.edu/pharmacy/python-program.py
> >> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx]
> >> PathInfo: '', referer:
> >> https://example.umich.edu/pharmacy/python-program.py
> >> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx]
> >> Traceback (most recent call last):, referer:
> >> https://example.umich.edu/pharmacy/python-program.py
> >> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx]   File
> >> "/usr/lib/python2.5/site-packages/mod_python/importer.py", line
> >> 1537, in HandlerDispatch\n    default=default_handler, arg=req,
> >> silent=hlist.silent), referer:
> >> https://example.umich.edu/pharmacy/python-program.py
> >> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx]   File
> >> "/usr/lib/python2.5/site-packages/mod_python/importer.py", line
> >> 1229, in _process_target\n    result = _execute_target(config, req,
> >> object, arg), referer:
> >> https://example.umich.edu/pharmacy/python-program.py
> >> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx]   File
> >> "/usr/lib/python2.5/site-packages/mod_python/importer.py", line
> >> 1128, in _execute_target\n    result = object(arg), referer:
> >> https://example.umich.edu/pharmacy/python-program.py
> >> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx]   File
> >> "/home/pharmacy/Private/html/python-program.py", line 224, in
> >> handler\n    s = coord.initHistory(session, formd), referer:
> >> https://example.umich.edu/pharmacy/python-program.py
> >> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx]   File
> >> "/home/pharmacy/Private/html/python-program.py", line 132, in
> >> initHistory\n    reload(tutor)\t# Force the current version of tutor
> >> module to be used., referer:
> >> https://example.umich.edu/pharmacy/python-program.py
> >> [Wed Aug 29 10:08:45 2007] [error] [client xxx.xxx.xxx.xxx]
> >> ImportError: reload(): module _mp_a52d922604fbb12687f4374d3c536a1b
> >> not in sys.modules, referer:
> >> https://example.umich.edu/pharmacy/python-program.py
> >>
> >> --------------------------------------
> >>
> >> Here's what we get when we access the page with PythonDebug turned on...
> >>
> >> ...continuing old session
> >>
> >> ...POST reading: uniqname=bjensen&lessonchoice=Minimal&startup=Start
> >> ...cwd='/'
> >> ...ls=['lost+found', 'var', '.bash_history', '.authorize', 'afs',
> >> 'bin', 'boot', 'dev',
> >> 'etc', 'home', 'lib', 'mnt', 'proc', 'root',  'sys', 'sbin',
> >> 'ticket', 'tmp', 'usr',
> >> 'opt', 'man']
> >> MOD_PYTHON ERROR
> >>
> >> ProcessId:      22409
> >> Interpreter:    'example.umich.edu'
> >>
> >> ServerName:     'example.umich.edu'
> >> DocumentRoot:   '/usr/share/apache2/htdocs/default/'
> >>
> >> URI:            '/pharmacy/python-program.py'
> >> Location:       None
> >> Directory:      '/home/pharmacy/Private/html/'
> >> Filename:       '/home/pharmacy/Private/html/
> >> crippen/python-program.py'
> >> PathInfo:       ''
> >>
> >> Phase:          'PythonHandler'
> >> Handler:        '/home/pharmacy/Private/html/
> >> crippen/python-program.py'
> >>
> >> Traceback (most recent call last):
> >>
> >>    File "/usr/lib/python2.5/site-packages/mod_python/importer.py",
> >> line 1537, in
> >> HandlerDispatch
> >>      default=default_handler, arg=req, silent=hlist.silent)
> >>
> >>    File "/usr/lib/python2.5/site-packages/mod_python/importer.py",
> >> line 1229, in
> >> _process_target
> >>      result = _execute_target(config, req, object, arg)
> >>
> >>    File "/usr/lib/python2.5/site-packages/mod_python/importer.py",
> >> line 1128, in
> >> _execute_target
> >>      result = object(arg)
> >>
> >>    File "/home/pharmacy/Private/html python-program.py",
> >> line 224, in handler
> >>      s = coord.initHistory(session, formd)
> >>
> >>    File "/home/pharmacy/Private/html python-program.py",
> >> line 132, in initHistory
> >>      reload(tutor)        # Force the current version of tutor
> >> module to be  used.
> >>
> >> ImportError: reload(): module _mp_a52d922604fbb12687f4374d3c536a1b
> >> not in sys.modules
> >>
> >>
> >> MODULE CACHE DETAILS
> >>
> >> Accessed:       Tue Aug 28 17:47:07 2007
> >> Generation:     4
> >>
> >> _mp_036881b8bfdae0dbd53cd31522b8613c {
> >>    FileName:     '/home/pharmacy/Private/html/ crippen/lesson.py'
> >>    Instance:     1
> >>    Generation:   1
> >>    Modified:     Wed Mar  7 13:53:05 2007
> >>    Imported:     Tue Aug 28 17:26:23 2007
> >> }
> >>
> >> _mp_6e0a86c977aa7b4821de3f2e456eeb4d {
> >>    FileName:     '/home/pharmacy/Private/html/
> >> crippen/python-program.py'
> >>    Instance:     1
> >>    Generation:   4
> >>    Modified:     Tue Aug 28 17:26:02 2007
> >>    Imported:     Tue Aug 28 17:26:23 2007
> >>    ModulePath:   '/home/pharmacy/Private/html/'
> >>    Children:     '/home/pharmacy/Private/html/ crippen/tutor.py'
> >> }
> >>
> >> _mp_251123f760a2485b75c77026f93acd83 {
> >>    FileName:     '/home/pharmacy/Private/html/ crippen/tex.py'
> >>    Instance:     1
> >>    Generation:   2
> >>    Modified:     Fri Mar 30 09:39:23 2007
> >>    Imported:     Tue Aug 28 17:26:23 2007
> >> }
> >>
> >> _mp_a52d922604fbb12687f4374d3c536a1b {
> >>    FileName:     '/home/pharmacy/Private/html/ crippen/tutor.py'
> >>    Instance:     1
> >>    Generation:   3
> >>    Modified:     Tue Aug 21 15:16:35 2007
> >>    Imported:     Tue Aug 28 17:26:23 2007
> >>    Children:     '/home/pharmacy/Private/html/ crippen/lesson.py',
> >>                  '/home/pharmacy/Private/html/ crippen/tex.py'
> >> }
> >>
> >> _______________________________________________
> >> Mod_python mailing list
> >> Mod_python@modpython.org
> >> http://mailman.modpython.org/mailman/listinfo/mod_python
> >>
> >
> > !DSPAM:46d5f1ac113225939618124!
> >
> >
> >
> >
>
>
>
From graham.dumpleton at gmail.com  Thu Aug 30 19:39:16 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Aug 30 19:39:27 2007
Subject: [mod_python] mod_python
In-Reply-To: <46D70652.7000609@pyxisinnovation.com>
References: <46D70652.7000609@pyxisinnovation.com>
Message-ID: <88e286470708301639y3c78feeetf19036b934fbd01b@mail.gmail.com>

On 31/08/2007, Chris Howell <chowell@pyxisinnovation.com> wrote:
>
>  Hi All,
>
>  I've installed the Apache webserver 2.2.4 onto a machine. I am trying to
> get the python mod working for the apache webserver.  I installed
> mod_python-3.3.1, for windows and I have the correct version of Python
> installed. I did everything the install asked me to do, when I edited my
> httpd.conf file for apache I added this line
>
>  LoadModule python_module modules/mod_python.so
>
>  Where all of the other load modules happen, to be.
>
>  So I shut the apache server down and I restarted it when I restart the
> server I get this error message.
>
>  "Cannot load C:/Program Files/Apache Software
> Foundation/Apache2.2/modules/mod_python.so into server. The
> specified procedure could not be found.
>
>  When I went to the modules directory, under the apache root, the
> mod_python.so file does exist so I am not sure what the problem is or what
> the solution is. Any light someone could shed on this would be greatly
> appreciated.

Following is a summary of common problems on Windows.

1. Wrong version of mod_python installed for version of Python/Apache
installed, or you have multiple versions of Python installed and the
DLL for the wrong one is being found in your PATH first causing a
failure to load the module. Look for all instances of PYTHONXY.DLL on
your system, where XY is a version number. Even if you didn't
explicitly install more than one version of Python, there are a number
of third party packages which install their own internal version of
Python and if they are in your PATH first it can screw things up.

2. Python/Apache/ModPython when installed was not installed as an
Administrator and as a result the DLLs are not in the operating system
library. If Apache is then started as a service, it may not be able to
find the required DLLs, or they may not have permissions such that the
Apache service can read them.

3. You have installed/uninstalled multiple versions of Python and
there are old Windows registry entries for another version still in
existence which is causing problems.

Because of where the problem is occurring, I would suggest it is a
permissions problem or inability to find appropriate DLLs. Thus
explore those possibilities first and come back to us with what you
find. Let us know things like whether you are running Apache as a
service, where the Python DLL and Microsoft C/C++ runtime DLLs are
located etc. Also indicate whether you are using www.python.org
version of Python or another distributors version.

Often these sorts of problems vanish when Python/Apache/ModPython are
all uninstalled, and then reinstalled as Administrator. Thus perhaps
also try that.

Graham
From hhanke at pdx.edu  Thu Aug 30 19:41:37 2007
From: hhanke at pdx.edu (hhanke@pdx.edu)
Date: Thu Aug 30 19:41:50 2007
Subject: [mod_python] Howto force reload of all modules
Message-ID: <20070830164137.sa7glmmqstcgc848@webmail.pdx.edu>


Hello,

please, I'm using apache.import_module() to import my modules
in mod_python 3.2.8 (I'm stuck with this version on our
production server). Since it has its problems, please, what
is the easiest way to reload all modules?

Is there some Apache directive or some apache. method which
would allow me to ask for all modules to be reloaded
on next access?

Thank you,
Hynek Hanke

From graham.dumpleton at gmail.com  Thu Aug 30 21:48:55 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Aug 30 21:49:08 2007
Subject: [mod_python] Howto force reload of all modules
In-Reply-To: <20070830164137.sa7glmmqstcgc848@webmail.pdx.edu>
References: <20070830164137.sa7glmmqstcgc848@webmail.pdx.edu>
Message-ID: <88e286470708301848m2606c9fid4a7a9b0b8891571@mail.gmail.com>

On 31/08/2007, hhanke@pdx.edu <hhanke@pdx.edu> wrote:
>
> Hello,
>
> please, I'm using apache.import_module() to import my modules
> in mod_python 3.2.8 (I'm stuck with this version on our
> production server). Since it has its problems, please, what
> is the easiest way to reload all modules?
>
> Is there some Apache directive or some apache. method which
> would allow me to ask for all modules to be reloaded
> on next access?

The only reliable way is to restart the whole of Apache.

If it were a development server, you could also use the brute force
method of having the Apache child process restart after every request.
This is done using the Apache directive:

  MaxRequestsPerChild 1

This should however never be used on a production server, as it would
give CGI like performance.

In short, there is no good way of doing it. Even the module importer
in 3.3.1 is only of use to web application code which is managed by
mod_python and not normal Python modules on sys.path.

Graham
From graham.dumpleton at gmail.com  Fri Aug 31 02:46:00 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Fri Aug 31 02:46:11 2007
Subject: [mod_python] Re: Debian bug#433038: mod_python collides with
	mod_php5
In-Reply-To: <20070831062814.GA25163@mycre.ws>
References: <88e286470708302321u4a897dbeoff84b68a686c2de1@mail.gmail.com>
	<20070831062814.GA25163@mycre.ws>
Message-ID: <88e286470708302346h25e3c539u94f9ad0d8b8b2a29@mail.gmail.com>

More information. In libmhash2 it has:

lib/.libs/libmhash.a(md5.o):
00000a60 T _MD5Final
00000000 T _MD5Init
00000040 T _MD5Transform
00000940 T _MD5Update
         U _mutils_bzero
         U _mutils_memcpy
         U _mutils_word32nswap
         U dyld_stub_binding_helper

In Python (<2.5), it has its own md5c.c file. If this is compiled
correctly, it should end up with:

00001288 T __Py_MD5Final
00001174 T __Py_MD5Init
000011b4 T __Py_MD5Update

Ie., Python should prefix the symbols so there is no clash.

You should check that this prefixing is actually occurring by doing an
nm on md5.so in Python modules directory. If it isn't, that could be
the problem.

Graham

On 31/08/2007, Robert Edmonds <edmonds@debian.org> wrote:
> Hi, Graham:
>
> Thanks for the fast follow-up.  I'm adding the bug report to the To: so
> that the original bug submitter will see your response.
>
> Graham Dumpleton wrote:
> > In 411487 it mentions:
> >
> > """So, it seems it's directly related to libmhash2 (as [2] suggests)."""
> >
> > Disabling of mhash module may not be enough if one of the other PHP
> > modules they list in 433038 also use libmhash2 library. Quite possible
> > that one of the crypto libraries use it, or the ldap module mentioned
> > in the mod_python mailing list mail.
> >
> > Can you run ldd on main PHP module and all PHP modules and see which
> > one has a dependency on libmhash2, or any other md5 hash library.
> >
> > Basic problem as we understand it is that libmhash2 uses a symbol name
> > which clashes with one used by Python md5 module. Which ever gets
> > loaded first, usually PHP version, takes precedence and since that is
> > not compatible with other package a crash occurs.
> >
> > If it can be determined that it is libmhash2 and then which symbol in
> > it clashes with one in Python md5 module, one or the other could
> > somehow be namespace escaped to avoid the problem.
> >
> > Graham
> >
> > On 31/08/2007, Robert Edmonds <edmonds@debian.org> wrote:
> > > Hi,
> > >
> > > I'm one of the Debian maintainers of the libapache2-mod-python package.
> > > Could someone please take a look at the report filed here?
> > >
> > >     http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=433038
> > >
> > > The user writes,
> > >
> > >     If libapache2-mod-python is installed together with libapache2-mod-php5,
> > >     (at least) the mod_python.psp handler fails immediately without any proper
> > >     error message.
> > >
> > >     This also happens if the php5 mhash module is uninstalled, purged and
> > >     apache is restarted.  mod_python starts working immediately if mod-php5 is
> > >     disabled using "a2dismod php5" and restarting apache.
> > >
> > >     [...]
> > >
> > >     This effectively renders mod_python.psp unusuable as soon as mod-php5
> > >     (maybe together with some specific modules) is installed and it's also hard
> > >     to debug as there's no indication whatsoever of what is going wrong, other
> > >     than that it "doesn't work".
> > >
> > > More details are on the page.  I'm afraid I'm having difficulties
> > > tracking down the root cause of the user's problem.
> > >
> > > --
> > > Robert Edmonds
> > > edmonds@debian.org
> > >
> > >
> >
>
> --
> Robert Edmonds
> edmonds@debian.org
>
From graham.dumpleton at gmail.com  Fri Aug 31 04:24:19 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Fri Aug 31 04:24:30 2007
Subject: [mod_python] Re: Debian bug#433038: mod_python collides with
	mod_php5
In-Reply-To: <20070831065336.GB25027@mycre.ws>
References: <88e286470708302321u4a897dbeoff84b68a686c2de1@mail.gmail.com>
	<20070831062814.GA25163@mycre.ws>
	<88e286470708302346h25e3c539u94f9ad0d8b8b2a29@mail.gmail.com>
	<20070831065336.GB25027@mycre.ws>
Message-ID: <88e286470708310124s713fa408idc0b95769570dbc3@mail.gmail.com>

On 31/08/2007, Robert Edmonds <edmonds@debian.org> wrote:
> Graham Dumpleton wrote:
> > More information. In libmhash2 it has:
> >
> > lib/.libs/libmhash.a(md5.o):
> > 00000a60 T _MD5Final
> > 00000000 T _MD5Init
> > 00000040 T _MD5Transform
> > 00000940 T _MD5Update
> >          U _mutils_bzero
> >          U _mutils_memcpy
> >          U _mutils_word32nswap
> >          U dyld_stub_binding_helper
> >
> > In Python (<2.5), it has its own md5c.c file. If this is compiled
> > correctly, it should end up with:
> >
> > 00001288 T __Py_MD5Final
> > 00001174 T __Py_MD5Init
> > 000011b4 T __Py_MD5Update
> >
> > Ie., Python should prefix the symbols so there is no clash.
> >
> > You should check that this prefixing is actually occurring by doing an
> > nm on md5.so in Python modules directory. If it isn't, that could be
> > the problem.
>
> It looks like this is not the case --
>
> edmonds@chase{0}:~$ nm -D /usr/lib/python2.4/lib-dynload/md5.so | grep MD5
> 0000000000001b30 T MD5Final
> 0000000000001380 T MD5Init
> 00000000000013b0 T MD5Transform
> 0000000000001c10 T MD5Update
>
> edmonds@chase{0}:~$ nm -D /usr/lib/libmhash.so.2 | grep MD5
> 00000000000069b0 T MD5Final
> 0000000000006200 T MD5Init
> 0000000000006230 T MD5Transform
> 0000000000006a80 T MD5Update
>
> I guess this is the root cause of Debian bug #411487, but it looks like
> the submitter of #433038 still experiences his problem even when
> libmhash is not loaded into the apache process.

I think I know what may have gone wrong here.

In Python source code there is md5c.c and md5.h. In the md5.h file it has:

/* Rename all exported symbols to avoid conflicts with similarly named
   symbols in some systems' standard C libraries... */

#define MD5Init _Py_MD5Init
#define MD5Update _Py_MD5Update
#define MD5Final _Py_MD5Final

void MD5Init(MD5_CTX *);
void MD5Update(MD5_CTX *, unsigned char *, unsigned int);
void MD5Final(unsigned char [16], MD5_CTX *);

If when the Python package was Debianised, whoever did it added
additional -I flags at the start of the CPPFLAGS passed to the
compiler such that instead of picking up md5.h from the Python source
directory, it picked up one from some system include directory, or
from another package, then the symbols would not have been namespace
prefixed like they should have.

As a result, just for Debian package of Python, the symbols wouldn't
be namespaced and thus why this problem only appears on Linux systems
derived from Debian packages.

The only way therefore of fixing this may be to review the Debian
package build scripts around Python to see if they do do something
with -I as a described. Simple fix may then be to append the -I flags
rather than prepend them. Otherwise, would be necessary to patch
md5c.c in Python source code to move the #defines into it just before
"md5.h" is included. That way the namespace prefixing will occur even
if wrong "md5.h" is included. One would hope though in this case that
the "md5.h" file actually used is compatible with the md5c.c file in
Python.

Graham
From graham.dumpleton at gmail.com  Fri Aug 31 05:05:52 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Fri Aug 31 05:06:05 2007
Subject: [mod_python] Re: Debian bug#433038: mod_python collides with
	mod_php5
In-Reply-To: <20070831084612.GB26496@mycre.ws>
References: <88e286470708302321u4a897dbeoff84b68a686c2de1@mail.gmail.com>
	<20070831062814.GA25163@mycre.ws>
	<88e286470708302346h25e3c539u94f9ad0d8b8b2a29@mail.gmail.com>
	<20070831065336.GB25027@mycre.ws>
	<88e286470708310124s713fa408idc0b95769570dbc3@mail.gmail.com>
	<20070831084612.GB26496@mycre.ws>
Message-ID: <88e286470708310205u56eeea03xa61760ffdd64f69b@mail.gmail.com>

On 31/08/2007, Robert Edmonds <edmonds@debian.org> wrote:
> tags 440272 + patch
> thanks
>
> Graham Dumpleton wrote:
> > I think I know what may have gone wrong here.
> >
> > In Python source code there is md5c.c and md5.h. In the md5.h file it has:
> >
> > /* Rename all exported symbols to avoid conflicts with similarly named
> >    symbols in some systems' standard C libraries... */
> >
> > #define MD5Init _Py_MD5Init
> > #define MD5Update _Py_MD5Update
> > #define MD5Final _Py_MD5Final
> >
> > void MD5Init(MD5_CTX *);
> > void MD5Update(MD5_CTX *, unsigned char *, unsigned int);
> > void MD5Final(unsigned char [16], MD5_CTX *);
> >
> > If when the Python package was Debianised, whoever did it added
> > additional -I flags at the start of the CPPFLAGS passed to the
> > compiler such that instead of picking up md5.h from the Python source
> > directory, it picked up one from some system include directory, or
> > from another package, then the symbols would not have been namespace
> > prefixed like they should have.
> >
> > As a result, just for Debian package of Python, the symbols wouldn't
> > be namespaced and thus why this problem only appears on Linux systems
> > derived from Debian packages.
> >
> > The only way therefore of fixing this may be to review the Debian
> > package build scripts around Python to see if they do do something
> > with -I as a described. Simple fix may then be to append the -I flags
> > rather than prepend them. Otherwise, would be necessary to patch
> > md5c.c in Python source code to move the #defines into it just before
> > "md5.h" is included. That way the namespace prefixing will occur even
> > if wrong "md5.h" is included. One would hope though in this case that
> > the "md5.h" file actually used is compatible with the md5c.c file in
> > Python.
> >
> > Graham
>
> I'll offer an alternate theory.  From the python2.4 Debian changelog,
>
> python2.4 (2.4dfsg-1) unstable; urgency=medium
> [...]
>
>   * Replace md5 implementation with one having a DFSG conforming license.
>
> [...]
>  -- Matthias Klose <doko@debian.org>  Tue,  8 Feb 2005 19:13:10 +0100
>
> This implementation doesn't have the #define re-definitions, and
> unfortunately uses the same MD5* symbols used in other DSOs.  This patch
> ought to fix that.  Build-tested; the symbols are properly re-defined
> and the md5 module still works.
>
>
> --- python2.4-2.4.4/Modules/md5.h.orig  2007-08-31 04:32:55.778928580 -0400
> +++ python2.4-2.4.4/Modules/md5.h       2007-08-31 04:33:34.997163501 -0400
> @@ -45,6 +45,14 @@
>         UWORD32 in[16];
>  };
>
> +/* Rename all exported symbols to avoid conflicts with similarly named
> +   symbols in other libraries */
> +
> +#define MD5Init _PyDFSG_MD5Init
> +#define MD5Update _PyDFSG_MD5Update
> +#define MD5Final _PyDFSG_MD5Final
> +#define MD5Transform _PyDFSG_MD5Transform
> +
>  void MD5Init(struct MD5Context *context);
>  void MD5Update(struct MD5Context *context, md5byte const *buf, unsigned len);
>  void MD5Final(unsigned char digest[16], struct MD5Context *context);

Yeah, was thinking afterwards whether that might have been the case as
couldn't otherwise account for the MD5Transform function appearing as
that was made static in Python source code.

FWIW, I have updated by mod_wsgi documentation describing the problem.
See 'Python MD5 Hash Module Conflict' in:

  http://code.google.com/p/modwsgi/wiki/ApplicationIssues

Thanks for helping to track this problem. This has been hanging around
for a while, but we have never got enough information back from people
to identify exactly what the problem was caused by.

Graham
From chowell at pyxisinnovation.com  Fri Aug 31 10:25:13 2007
From: chowell at pyxisinnovation.com (Chris Howell)
Date: Fri Aug 31 10:25:31 2007
Subject: [mod_python] Testing Mod_python
Message-ID: <46D824C9.2080600@pyxisinnovation.com>

Hi All.

So I got  mod_python installed, with apache on my windows box running 
WinXP SP2. When I went to test the mod_install following the directions 
on this site.

http://www.modpython.org/live/current/doc-html/inst-testing.html

I put the directory in this my httpd.conf file, and it looks like this.

<Directory "C:/Program Files/Apache Software 
Foundation/Apache2.2/htdocs/test">
  Options FollowSymLinks
  AllowOverride All
  Order deny,allow
  Satisfy all
  AddHandler mod_python .py
  PythonHandler mptest
  PythonDebug On
</Directory>

I restarted the Apache server no problem.

My python test file looks like.

from mod_python import apache

def handler(req):
    req.content_type = 'text/plain'
    req.write("Hello World")
    return apache.OK
File name: *mptest.py* and it's in the appropriate directory and 
everything.

When I try to point by browser URL at the python file with this.

http://euclid:9000/Test/mptest.py

I get this error message.

MOD_PYTHON ERROR

ProcessId:      1652
Interpreter:    'euclid.PyxisInnovation.local'

ServerName:     'euclid.PyxisInnovation.local'
DocumentRoot:   'C:/Program Files/Apache Software Foundation/Apache2.2/htdocs'

URI:            '/Test/mptest.py'
Location:       None
Directory:      'C:/Program Files/Apache Software Foundation/Apache2.2/htdocs/Test/'
Filename:       'C:/Program Files/Apache Software Foundation/Apache2.2/htdocs/Test/mptest.py'
PathInfo:       ''

Phase:          'PythonHandler'
Handler:        'mptest'

Traceback (most recent call last):

  File "C:\Python25\Lib\site-packages\mod_python\importer.py", line 1537, in HandlerDispatch
    default=default_handler, arg=req, silent=hlist.silent)

  File "C:\Python25\Lib\site-packages\mod_python\importer.py", line 1202, in _process_target
    module = import_module(module_name, path=path)

  File "C:\Python25\Lib\site-packages\mod_python\importer.py", line 304, in import_module
    return __import__(module_name, {}, {}, ['*'])

ImportError: No module named mptest


Any help would be great.

Cheers
Chris Howell
Software Engineer
the PYXIS innovation - /Common Ground for Digital Earth/
Kingston Ontario
w: www.pyxisinnovation.com





-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070831/b804ff1c/attachment.html
From chowell at pyxisinnovation.com  Fri Aug 31 11:42:22 2007
From: chowell at pyxisinnovation.com (Chris Howell)
Date: Fri Aug 31 11:47:54 2007
Subject: [mod_python] Testing Python Mod
Message-ID: <46D836DE.4050605@pyxisinnovation.com>

Hi All,

So in regards to a follow up on my last post. I found this page at.

http://www.dscpl.com.au/wiki/ModPython/Articles/GettingModPythonWorking

Which describes how to get the python mod working for apache and I 
changed it around so that I was no longer trying to access it globally.

My .htaccess file looks like

AddHandler python-program .py
PythonHandler mptest
PythonDebug On

And is found in the same directory as my *.py file.

My httpd.conf file has this entry in it now.

<Directory "C:/Program Files/Apache Software 
Foundation/Apache2.2/htdocs/Test">
AllowOverride FileInfo
</Directory>

When I attempt to access the .py file. I get this message up.

MOD_PYTHON ERROR

ProcessId:      2544
Interpreter:    '192.168.0.42'

ServerName:     '192.168.0.42'
DocumentRoot:   'C:/Program Files/Apache Software Foundation/Apache2.2/htdocs'

URI:            '/Test/mptest.py'
Location:       None
Directory:      'C:/Program Files/Apache Software Foundation/Apache2.2/htdocs/Test/'
Filename:       'C:/Program Files/Apache Software Foundation/Apache2.2/htdocs/Test/mptest.py'
PathInfo:       ''

Phase:          'PythonHandler'
Handler:        'mptest'

Traceback (most recent call last):

  File "C:\Python25\Lib\site-packages\mod_python\importer.py", line 1537, in HandlerDispatch
    default=default_handler, arg=req, silent=hlist.silent)

  File "C:\Python25\Lib\site-packages\mod_python\importer.py", line 1202, in _process_target
    module = import_module(module_name, path=path)

  File "C:\Python25\Lib\site-packages\mod_python\importer.py", line 304, in import_module
    return __import__(module_name, {}, {}, ['*'])

ImportError: No module named mptest

So I've tried two approaches and I am stumped on both of them. 
I would sincerely appreciate any help. 

Cheers
Chris Howell 
Software Engineer 
the PYXIS Innovation - /Common Ground for Digital Earth 
Kingston Ontario.
/www.pyxisinnovation.com





-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070831/4ec16d60/attachment-0001.html
From hhanke at pdx.edu  Fri Aug 31 14:21:18 2007
From: hhanke at pdx.edu (hhanke@pdx.edu)
Date: Fri Aug 31 14:21:43 2007
Subject: [mod_python] Howto force reload of all modules
In-Reply-To: <88e286470708301848m2606c9fid4a7a9b0b8891571@mail.gmail.com>
References: <20070830164137.sa7glmmqstcgc848@webmail.pdx.edu>
	<88e286470708301848m2606c9fid4a7a9b0b8891571@mail.gmail.com>
Message-ID: <20070831112118.ra0rf8e3d68ssw8s@webmail.pdx.edu>

Quoting Graham Dumpleton <graham.dumpleton@gmail.com>:
> On 31/08/2007, hhanke@pdx.edu <hhanke@pdx.edu> wrote:
>> please, I'm using apache.import_module() to import my modules
>> in mod_python 3.2.8 (I'm stuck with this version on our
>> production server). Since it has its problems, please, what
>> is the easiest way to reload all modules?
> The only reliable way is to restart the whole of Apache.

This just cannot be done on a production sever where multiple
websites run and a server I as a developer have no controll about.

> If it were a development server, you could also use the brute force
> method of having the Apache child process restart after every request.
> This is done using the Apache directive:
>   MaxRequestsPerChild 1
> This should however never be used on a production server, as it would
> give CGI like performance.

It would be acceptable to use it for a short period, e.g. after updating
the website to the new release version, but since I can't do that on
a per-directory basis through .htaccess, it is of no use on a production
server where multiple websites run and I can't edit the global conf.

> In short, there is no good way of doing it.

So how do I use Python for writing more complicated webpages,
that need to use modules (both my own and completely external
that I have no controll about and they use the classical import)?
Do I have to use CGI then?

> Even the module importer in 3.3.1 is only of use to web application
> code which is managed by mod_python and not normal Python modules
> on sys.path.

Hm... Can I somehow force the reload of a given module that I imported
through apache.import_module manually? I mean an equivalent of reload().

Thank you,
Hynek




From graham.dumpleton at gmail.com  Fri Aug 31 18:20:19 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Fri Aug 31 18:20:32 2007
Subject: [mod_python] Howto force reload of all modules
In-Reply-To: <20070831112118.ra0rf8e3d68ssw8s@webmail.pdx.edu>
References: <20070830164137.sa7glmmqstcgc848@webmail.pdx.edu>
	<88e286470708301848m2606c9fid4a7a9b0b8891571@mail.gmail.com>
	<20070831112118.ra0rf8e3d68ssw8s@webmail.pdx.edu>
Message-ID: <88e286470708311520n45714961gda4c488d6e0c451d@mail.gmail.com>

On 01/09/2007, hhanke@pdx.edu <hhanke@pdx.edu> wrote:
> Quoting Graham Dumpleton <graham.dumpleton@gmail.com>:
> > On 31/08/2007, hhanke@pdx.edu <hhanke@pdx.edu> wrote:
> >> please, I'm using apache.import_module() to import my modules
> >> in mod_python 3.2.8 (I'm stuck with this version on our
> >> production server). Since it has its problems, please, what
> >> is the easiest way to reload all modules?
> > The only reliable way is to restart the whole of Apache.
>
> This just cannot be done on a production sever where multiple
> websites run and a server I as a developer have no controll about.
>
> > If it were a development server, you could also use the brute force
> > method of having the Apache child process restart after every request.
> > This is done using the Apache directive:
> >   MaxRequestsPerChild 1
> > This should however never be used on a production server, as it would
> > give CGI like performance.
>
> It would be acceptable to use it for a short period, e.g. after updating
> the website to the new release version, but since I can't do that on
> a per-directory basis through .htaccess, it is of no use on a production
> server where multiple websites run and I can't edit the global conf.
>
> > In short, there is no good way of doing it.
>
> So how do I use Python for writing more complicated webpages,
> that need to use modules (both my own and completely external
> that I have no controll about and they use the classical import)?
> Do I have to use CGI then?
>
> > Even the module importer in 3.3.1 is only of use to web application
> > code which is managed by mod_python and not normal Python modules
> > on sys.path.
>
> Hm... Can I somehow force the reload of a given module that I imported
> through apache.import_module manually? I mean an equivalent of reload().

Have you read the documentation for 'import_module()' in mod_python 3.3.1?

  http://www.modpython.org/live/current/doc-html/pyapi-apmeth.html

The whole point of 'import_module()' is that provided the modules are
ones which mod_python can manage (not on sys.path), then when you make
changes to a module, or a module which is depended upon by another
module, the top level module and any modules on the path down to the
changed module will be automatically reloaded.

But then, if you cant upgrade to 3.3.1 you will be stuck with the
older implementation of 'import_module()' which has lots of problems
and doesn't handle reloading when child modules are changed. See:

  http://www.dscpl.com.au/wiki/ModPython/Articles/ModuleImportingIsBroken

If CGI is an option, because you aren't really using mod_python
specific features anyway, then yes you could use CGI, but in that case
you would better off converting your application to be a WSGI
application and using mod_wsgi (www.modwsgi.org) with its daemon mode.
In daemon mode of mod_wsgi your application is delegated to its own
separate process and you can control restarts of just that process
using signals. This allows one to implement an automatic reloader.
See:

  http://code.google.com/p/modwsgi/wiki/ReloadingSourceCode

In summary, with mod_python your production box is best used only for
deployment and not for development. You can only get so far using
'import_module()' properly on a production box, sometimes you just
cant avoid doing a restart. Thus you really need to use a separate
Apache instance when you are doing development with mod_python if you
have no ability to restart your production server.

Graham
From graham.dumpleton at gmail.com  Fri Aug 31 18:34:10 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Fri Aug 31 18:34:21 2007
Subject: [mod_python] Testing Mod_python
In-Reply-To: <46D824C9.2080600@pyxisinnovation.com>
References: <46D824C9.2080600@pyxisinnovation.com>
Message-ID: <88e286470708311534o790431d3l3050086c88bc7c3@mail.gmail.com>

On 01/09/2007, Chris Howell <chowell@pyxisinnovation.com> wrote:
>
>  Hi All.
>
>  So I got  mod_python installed, with apache on my windows box running WinXP
> SP2. When I went to test the mod_install following the directions on this
> site.
>
> http://www.modpython.org/live/current/doc-html/inst-testing.html
>
>  I put the directory in this my httpd.conf file, and it looks like this.
>
>  <Directory "C:/Program Files/Apache Software
> Foundation/Apache2.2/htdocs/test">
>    Options FollowSymLinks
>    AllowOverride All
>    Order deny,allow
>    Satisfy all
>    AddHandler mod_python .py
>    PythonHandler mptest
>    PythonDebug On
>  </Directory>
>
>  I restarted the Apache server no problem.
>
>  My python test file looks like.
>
>  from mod_python import apache
>
>  def handler(req):
>      req.content_type = 'text/plain'
>      req.write("Hello World")
>      return apache.OK
>  File name: mptest.py and it's in the appropriate directory and everything.
>
>  When I try to point by browser URL at the python file with this.
>
>  http://euclid:9000/Test/mptest.py
>
>  I get this error message.
>
>  MOD_PYTHON ERROR
>
> ProcessId: 1652
> Interpreter: 'euclid.PyxisInnovation.local'
>
> ServerName: 'euclid.PyxisInnovation.local'
> DocumentRoot: 'C:/Program Files/Apache Software Foundation/Apache2.2/htdocs'
>
> URI: '/Test/mptest.py'
> Location: None
> Directory: 'C:/Program Files/Apache Software
> Foundation/Apache2.2/htdocs/Test/'
> Filename: 'C:/Program Files/Apache Software
> Foundation/Apache2.2/htdocs/Test/mptest.py'
> PathInfo: ''
>
> Phase: 'PythonHandler'
> Handler: 'mptest'
>
> Traceback (most recent call last):
>
>  File
> "C:\Python25\Lib\site-packages\mod_python\importer.py",
> line 1537, in HandlerDispatch
>  default=default_handler, arg=req, silent=hlist.silent)
>
>  File
> "C:\Python25\Lib\site-packages\mod_python\importer.py",
> line 1202, in _process_target
>  module = import_module(module_name, path=path)
>
>  File
> "C:\Python25\Lib\site-packages\mod_python\importer.py",
> line 304, in import_module
>  return __import__(module_name, {}, {}, ['*'])
>
> ImportError: No module named mptest
>
>  Any help would be great.

If you put a plain text file 'hello.txt' in the 'test' subdirectory,
can you access it from browser as:

  /Test/hello.txt

If you can't, and you are running Apache as a service, then it means
Apache doesn't have appropriate permissions to read the contents of
that subdirectory.

BTW, keep trying to use this method, as most of the time Apache on
Win32 isn't set up quite correctly such that .htaccess works.

Graham
From hhanke at pdx.edu  Fri Aug 31 21:17:25 2007
From: hhanke at pdx.edu (hhanke@pdx.edu)
Date: Fri Aug 31 21:17:36 2007
Subject: [mod_python] Howto force reload of all modules
In-Reply-To: <88e286470708311520n45714961gda4c488d6e0c451d@mail.gmail.com>
References: <20070830164137.sa7glmmqstcgc848@webmail.pdx.edu>
	<88e286470708301848m2606c9fid4a7a9b0b8891571@mail.gmail.com>
	<20070831112118.ra0rf8e3d68ssw8s@webmail.pdx.edu>
	<88e286470708311520n45714961gda4c488d6e0c451d@mail.gmail.com>
Message-ID: <20070831181725.oyfclrosk7e8skc4@webmail.pdx.edu>

> In summary, with mod_python your production box is best used only for
> deployment and not for development. You can only get so far using
> 'import_module()' properly on a production box, sometimes you just
> cant avoid doing a restart. Thus you really need to use a separate
> Apache instance when you are doing development with mod_python if you
> have no ability to restart your production server.

Hi Graham,

thanks for the explanation. I've read the documentation, but as I
said before, I can't use 3.3 yet. It is not only about
developement/production, but also production/production, because
when there is a new version of the software, I do not have any
reasonable way how to run the new code.

Anyway, I understand there is no use in complaining about
something that was fixed already. We just need to push our
admin to install mod_python 3.3 ASAP.

Thank you very much,
Hynek Hanke

