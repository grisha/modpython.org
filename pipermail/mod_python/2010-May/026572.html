<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] mod_python import failure on FreeBSD AMD64
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20mod_python%20import%20failure%20on%20FreeBSD%20AMD64&In-Reply-To=BAY144-W24C14007BB435C3AB6C12BAEF40%40phx.gbl">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026571.html">
   <LINK REL="Next"  HREF="026573.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] mod_python import failure on FreeBSD AMD64</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20mod_python%20import%20failure%20on%20FreeBSD%20AMD64&In-Reply-To=BAY144-W24C14007BB435C3AB6C12BAEF40%40phx.gbl"
       TITLE="[mod_python] mod_python import failure on FreeBSD AMD64">graham.dumpleton at gmail.com
       </A><BR>
    <I>Wed May  5 01:51:51 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="026571.html">[mod_python] mod_python import failure on FreeBSD AMD64
</A></li>
        <LI>Next message: <A HREF="026573.html">[mod_python] The mod_python project soon to be officially dead.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26572">[ date ]</a>
              <a href="thread.html#26572">[ thread ]</a>
              <a href="subject.html#26572">[ subject ]</a>
              <a href="author.html#26572">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 5 May 2010 14:55, Surly The Clown &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">surly_the_clown at hotmail.com</A>&gt; wrote:
&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> Date: Wed, 5 May 2010 13:17:07 +1000
</I>&gt;&gt;<i> Subject: Re: [mod_python] mod_python import failure on FreeBSD AMD64
</I>&gt;&gt;<i> From: <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">graham.dumpleton at gmail.com</A>
</I>&gt;&gt;<i> To: <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">surly_the_clown at hotmail.com</A>
</I>&gt;&gt;<i> CC: <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mod_python at modpython.org</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On 5 May 2010 13:13, Surly The Clown &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">surly_the_clown at hotmail.com</A>&gt; wrote:
</I>&gt;&gt;<i> &gt;&gt; &gt; Any more ideas?
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; Don't use mod_python if you don't have to.
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; What are you wanting to host using it?
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Big(ish) media files, and I'm wanting to hook into Apache so that I can
</I>&gt;&gt;<i> &gt; control access to them with custom logic. As far as I've been able to
</I>&gt;&gt;<i> &gt; determine, this is something that wsgi/fastcgi can't really do, unless
</I>&gt;&gt;<i> &gt; you
</I>&gt;&gt;<i> &gt; use URL rewriting to force the requests to go through a script. Even
</I>&gt;&gt;<i> &gt; then,
</I>&gt;&gt;<i> &gt; it's suboptimal as the file would then be piped through a script instead
</I>&gt;&gt;<i> &gt; of
</I>&gt;&gt;<i> &gt; handled directly by Apache. mod_python was pretty much exactly what I
</I>&gt;&gt;<i> &gt; need.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Depends exactly on what you want to do. See:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> <A HREF="http://code.google.com/p/modwsgi/wiki/AccessControlMechanisms">http://code.google.com/p/modwsgi/wiki/AccessControlMechanisms</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Graham
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Interesting. Unfortunately, those access control mechanisms all seem to be
</I>&gt;<i> based on http access control, which is inadequate for my needs.
</I>&gt;<i> Specifically, what I need is the ability to enforce one login per user. You
</I>&gt;<i> can't do this with http access control because it allows or denies access
</I>&gt;<i> based solely on what the client sends the server, and does not have any way
</I>&gt;<i> of denying access if, say, that username was logged in somewhere else, or if
</I>&gt;<i> that is the case, logging out the other user session in favor of the new
</I>&gt;<i> one. I spent quite some time looking for modules for both apache and nginx
</I>&gt;<i> before I came to the conclusion that there were none, which I find
</I>&gt;<i> astonishing. It's of course possible that I've missed something. However,
</I>&gt;<i> mod_python will allow me to do what I need, and this scheme of access
</I>&gt;<i> control does work.
</I>
I warn you that using mod_python to do that will be a PITA.

You don't even need to hook into the early phases of Apache request
processing to do what you want. You would be better off writing a
standard WSGI application which incorporates the form/session based
login mechanism to handle access and then use X-Sendfile response
header and mod_sendfile to then serve up the static file.

This gives you a number of benefits. The most important is that you
have a portable solution as it could be hosted on mod_wsgi or
mod_fcgid/flup on Apache with mod_xsendfile in Apache serving up the
file based on X-Sendfile. You could also use nginx/fastcgi/flup and
equivalent X-Sendile support in nginx using its mod_xsendfile.

Another way besides using X-Sendfile is to use nginx X-Accel-Redirect
header with private URL namespace. This can be used in front of
nginx/fastcgi/flup or where nginx is front end to Apache/mod_wsgi.

Thus, you have multiple widely used and well tested existing means of
serving up static files via the web server, where the file is
controlled by a web application implementing the access control.

Another benefit is that you don't have to implement from scratch the
form/session login mechanism as you can reuse an existing WSGI
component which performs that task already. Options for that are
Beaker (<A HREF="http://beaker.groovie.org/">http://beaker.groovie.org/</A>) and repoze.who
(<A HREF="http://docs.repoze.org/who/2.0/">http://docs.repoze.org/who/2.0/</A>).

If you still don't want to go that path and want an Apache only
solution, suggest you look at mod_auth_tkt
(<A HREF="http://www.openfusion.com.au/labs/mod_auth_tkt/">http://www.openfusion.com.au/labs/mod_auth_tkt/</A>).

There is also mod_session in Apache, but that is only available from
Apache 2.3 onwards.

&gt;<i> Now, I can see why you'd prefer to use wsgi or fastcgi if they are adequate
</I>&gt;<i> for your needs, but mod_python can do some things that those just can't, and
</I>&gt;<i> they are useful things, so I'm surprised that it's been abandoned.
</I>
Few people need those additional features.

&gt;<i> At any rate, I now have an additional machine where mod_python works: an
</I>&gt;<i> i386 FreeBSD instance running in QEMU. And I also discovered that running
</I>&gt;<i> make extract in mod_python's directory yields the error:
</I>&gt;<i> &quot;/usr/local/sbin/apxs: not found&quot; and &quot;===&gt; mod_python-3.3.1_2 : Your apache
</I>&gt;<i> does not support DSO modules.&quot; Bizarre.
</I>
Not really. FreeBSD is a very backward system when it comes to Apache
and you may find it only ships with Apache 1.3. Even when you can get
Apache 2.X for FreeBSD, it often has all multithreading support
disabled completely in APR libraries.

&gt;<i> Searching the inter-net for the
</I>&gt;<i> latter message makes me think that something is messed up with apache.
</I>&gt;<i> However, /usr/local/sbin/apxs is on the system, is executable, and runs.
</I>&gt;<i> Deinstalling apache and then attempting to rebuild it yields:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ./buildconf: /usr/local/bin/autoheader-2.62: not found
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> which is once again actually on the system and working fine. This leads me
</I>&gt;<i> to believe that something is seriously messed up with that system and that
</I>&gt;<i> is likely why mod_python isn't working. Thank you for your assistance,
</I>&gt;<i> though.
</I>

Graham
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="026571.html">[mod_python] mod_python import failure on FreeBSD AMD64
</A></li>
	<LI>Next message: <A HREF="026573.html">[mod_python] The mod_python project soon to be officially dead.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26572">[ date ]</a>
              <a href="thread.html#26572">[ thread ]</a>
              <a href="subject.html#26572">[ subject ]</a>
              <a href="author.html#26572">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
