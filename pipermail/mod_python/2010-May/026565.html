<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] mod_python import failure on FreeBSD AMD64
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20mod_python%20import%20failure%20on%20FreeBSD%20AMD64&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="026566.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] mod_python import failure on FreeBSD AMD64</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Surly The Clown</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20mod_python%20import%20failure%20on%20FreeBSD%20AMD64&In-Reply-To="
       TITLE="[mod_python] mod_python import failure on FreeBSD AMD64">surly_the_clown at hotmail.com
       </A><BR>
    <I>Tue May  4 19:12:48 EDT 2010</I>
    <P><UL>
        
        <LI>Next message: <A HREF="026566.html">[mod_python] mod_python import failure on FreeBSD AMD64
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26565">[ date ]</a>
              <a href="thread.html#26565">[ thread ]</a>
              <a href="subject.html#26565">[ subject ]</a>
              <a href="author.html#26565">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hello all,


I have two FreeBSD machines, both running the latest FreeBSD-8.0 release, apache-2.2.14_6, and mod_python-3.3.1_2. On one of the machines, the i386 one, there are no problems. Everything works fine. On the other one, an AMD64 machine, any attempt to access a page handled by mod_python results in a 500 Internal Server Error response and the following error log:


[Tue May 04 14:41:34 2010] [notice] mod_python: Creating 8 session mutexes based on 256 max processes and 0 max threads.
[Tue May 04 14:41:34 2010] [notice] mod_python: using mutex_directory /tmp
[Tue May 04 14:41:34 2010] [notice] Apache/2.2.14 (FreeBSD) mod_python/3.3.1 Python/2.6.4 configured -- resuming normal operations
sem_init: No space left on device
[Tue May 04 14:41:51 2010] [error] make_obcallback: could not import mod_python.apache.\n
Traceback (most recent call last):
  File &quot;/usr/local/lib/python2.6/site-packages/mod_python/apache.py&quot;, line 29, in &lt;module&gt;
    import cgi
  File &quot;/usr/local/lib/python2.6/cgi.py&quot;, line 40, in &lt;module&gt;
    import urllib
  File &quot;/usr/local/lib/python2.6/urllib.py&quot;, line 26, in &lt;module&gt;
    import socket
  File &quot;/usr/local/lib/python2.6/socket.py&quot;, line 64, in &lt;module&gt;
    from _ssl import SSLError as sslerror
ImportError: cannot import name SSLError
[Tue May 04 14:41:51 2010] [error] make_obcallback: Python path being used &quot;['/usr/local/lib/python2.6/site-packages/setuptools-0.6c11-py2.6.egg', '/usr/local/lib/python2.6/site-packages/nose-0.11.1-py2.6.egg', '/usr/local/lib/python26.zip', '/usr/local/lib/python2.6', '/usr/local/lib/python2.6/plat-freebsd8', '/usr/local/lib/python2.6/lib-tk', '/usr/local/lib/python2.6/lib-old', '/usr/local/lib/python2.6/lib-dynload', '/usr/local/lib/python2.6/site-packages', '/usr/local/lib/python2.6/site-packages/Numeric', '/usr/local/lib/python2.6/site-packages/gtk-2.0']&quot;.
[Tue May 04 14:41:51 2010] [error] get_interpreter: no interpreter callback found.
[Tue May 04 14:41:51 2010] [error] [client 192.168.123.106] python_handler: Can't get/create interpreter.
[Tue May 04 14:41:51 2010] [error] [client 192.168.123.106] File does not exist: /usr/home/chrisa/test/favicon.ico, referer: <A HREF="http://192.168.123.136:8080/fetch.py">http://192.168.123.136:8080/fetch.py</A>


Going into the python interpreter and entering &quot;from _ssl import SSLError as sslerror&quot; results in no error. Doing all the imports (except _apache) found in the apache.py file in order also results in no error. In fact, entering &quot;from mod_python import apache&quot; acts as expected, failing only on the &quot;import _apache&quot; line in apache.py, as that is only defined when the interpreter is embedded. The error with importing cgi only seems to occur when called from within apache, and only on the AMD64 machine.


I doubt this is caused by some bug in the AMD64 version because as far as I've been able to tell, nobody has this problem but me.


My httpd.conf on the machine which has the problem (comments stripped):


ServerRoot &quot;/usr/local&quot;
Listen 8080
LoadModule deflate_module libexec/apache22/mod_deflate.so
LoadModule log_config_module libexec/apache22/mod_log_config.so
LoadModule mime_magic_module libexec/apache22/mod_mime_magic.so
LoadModule unique_id_module libexec/apache22/mod_unique_id.so
LoadModule mime_module libexec/apache22/mod_mime.so
LoadModule dir_module libexec/apache22/mod_dir.so
LoadModule authz_host_module libexec/apache22/mod_authz_host.so
LoadModule python_module libexec/apache22/mod_python.so
&lt;IfModule !mpm_netware_module&gt;
&lt;IfModule !mpm_winnt_module&gt;
User www
Group www
&lt;/IfModule&gt;
&lt;/IfModule&gt;
ServerAdmin <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">you at example.com</A>
ServerName 192.168.123.136:8080
DocumentRoot &quot;/usr/home/chrisa/test&quot;
&lt;Directory /&gt;
    AllowOverride None
    Options None
    Order deny,allow
    Deny from all
&lt;/Directory&gt;
&lt;Directory &quot;/usr/home/chrisa/test&quot;&gt;
    Options None
    DirectoryIndex index.html
    AddHandler mod_python .py .php .html .swf .pdf .js
    PythonHandler fetch
    PythonDebug On
    AllowOverride None
    Order allow,deny
    Allow from all
&lt;/Directory&gt;
&lt;IfModule dir_module&gt;
    DirectoryIndex index.html
&lt;/IfModule&gt;
&lt;FilesMatch &quot;^\.ht&quot;&gt;
    Order allow,deny
    Deny from all
    Satisfy All
&lt;/FilesMatch&gt;
ErrorLog &quot;/var/log/httpd-error.log&quot;
LogLevel warn
&lt;IfModule log_config_module&gt;
    LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot;&quot; combined
    LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b&quot; common
    &lt;IfModule logio_module&gt;
      LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot; %I %O&quot; combinedio
    &lt;/IfModule&gt;
    CustomLog &quot;/var/log/httpd-access.log&quot; combined
&lt;/IfModule&gt;
DefaultType text/plain
&lt;IfModule mime_module&gt;
    TypesConfig etc/apache22/mime.types
    AddEncoding x-compress .Z
    AddEncoding x-gzip .gz .tgz
&lt;/IfModule&gt;



The one on the machine where it works differs only in DocumentRoot and Directory, as the directory structure is a little different there.


 		 	   		  
_________________________________________________________________
MSN Dating: Find someone special. Start now.
<A HREF="http://go.microsoft.com/?linkid=9729707">http://go.microsoft.com/?linkid=9729707</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20100504/31bc54a4/attachment.html">http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20100504/31bc54a4/attachment.html</A>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="026566.html">[mod_python] mod_python import failure on FreeBSD AMD64
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26565">[ date ]</a>
              <a href="thread.html#26565">[ thread ]</a>
              <a href="subject.html#26565">[ subject ]</a>
              <a href="author.html#26565">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
