<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Fixup hander not always being called
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Fixup%20hander%20not%20always%20being%20called&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009768.html">
   <LINK REL="Next"  HREF="009770.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
<table border=0 width="100%"><tr><td valign="top">
   <H1>[mod_python] Fixup hander not always being called</H1>
    <B>Michael C. Neel</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Fixup%20hander%20not%20always%20being%20called&In-Reply-To="
       TITLE="[mod_python] Fixup hander not always being called">neel at mediapulse.com
       </A><BR>
    <I>Wed Mar 12 10:57:25 EST 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="009768.html">[mod_python] prototype 3.0.3
</A></li>
        <LI>Next message: <A HREF="009770.html">[mod_python] Fixup hander not always being called
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9769">[ date ]</a>
              <a href="thread.html#9769">[ thread ]</a>
              <a href="subject.html#9769">[ subject ]</a>
              <a href="author.html#9769">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I have some mod perl code I'm trying to move over to modpython.  The
perl code adds a cookie header to all requests using the fixup phase,
and then logs some info in the logging phase.  When I setup python to do
the same, the fixup handler is not always called.  It looks like it is
related to cgi scripts, as when I hit a cgi page in the web browser, my
fixup handler is not called - but it will call the perl version.

My conf has:

    &lt;Location /&gt;
        #SetHandler python-program
        PythonLogHandler qlog
        PythonFixupHandler qlog
        PythonDebug On
    &lt;/Location&gt;

I've commented out the SetHandler because that would break cgi scripts
(causing the text of the script to be sent to the browser, instead of
executing it).  This is the same with mod_perl, you can't use the
SetHandler.

qlog.py (simplified):

from mod_python import apache

def fixuphandler(req):

    apache.log_error(&quot;----------- New Hit -----------&quot;)
    apache.log_error(&quot;CT: &quot; + str(req.content_type))

def loghandler(req):

    apache.log_error(&quot;----------- Log Hit -----------&quot;)


Any insights?  I'd like to do the new version of this code in python,
and not perl, but I gotta get this cgi snafu solved.

Thanks,
Mike


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009768.html">[mod_python] prototype 3.0.3
</A></li>
	<LI>Next message: <A HREF="009770.html">[mod_python] Fixup hander not always being called
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9769">[ date ]</a>
              <a href="thread.html#9769">[ thread ]</a>
              <a href="subject.html#9769">[ subject ]</a>
              <a href="author.html#9769">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
