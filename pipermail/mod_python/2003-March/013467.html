<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Fixup hander not always being called
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Fixup%20hander%20not%20always%20being%20called&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013466.html">
   <LINK REL="Next"  HREF="013468.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Fixup hander not always being called</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Michael C. Neel</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Fixup%20hander%20not%20always%20being%20called&In-Reply-To="
       TITLE="[mod_python] Fixup hander not always being called">neel at mediapulse.com
       </A><BR>
    <I>Wed Mar 12 13:34:23 EST 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="013466.html">[mod_python] Fixup hander not always being called
</A></li>
        <LI>Next message: <A HREF="013468.html">[mod_python] ANNOUNCE: Mod_python 3.0.3
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13467">[ date ]</a>
              <a href="thread.html#13467">[ thread ]</a>
              <a href="subject.html#13467">[ subject ]</a>
              <a href="author.html#13467">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Sctratch the below.  It looks like the function apache.log_error()
doesn't always work, so my method of testing the handler was flawed.  I
used Sam Spade to watch headers, and my cookies are being added, even
though the calls to the error_log are not printing.

Also, I left off I'm using 2.7.8 on Apache 1.3.26

Thanks,
Mike

-----Original Message-----
From: Michael C. Neel 
Sent: Wednesday, March 12, 2003 10:57 AM
To: <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mod_python at modpython.org</A>
Subject: [mod_python] Fixup hander not always being called


I have some mod perl code I'm trying to move over to modpython.  The
perl code adds a cookie header to all requests using the fixup phase,
and then logs some info in the logging phase.  When I setup python to do
the same, the fixup handler is not always called.  It looks like it is
related to cgi scripts, as when I hit a cgi page in the web browser, my
fixup handler is not called - but it will call the perl version.

My conf has:

    &lt;Location /&gt;
        #SetHandler python-program
        PythonLogHandler qlog
        PythonFixupHandler qlog
        PythonDebug On
    &lt;/Location&gt;

I've commented out the SetHandler because that would break cgi scripts
(causing the text of the script to be sent to the browser, instead of
executing it).  This is the same with mod_perl, you can't use the
SetHandler.

qlog.py (simplified):

from mod_python import apache

def fixuphandler(req):

    apache.log_error(&quot;----------- New Hit -----------&quot;)
    apache.log_error(&quot;CT: &quot; + str(req.content_type))

def loghandler(req):

    apache.log_error(&quot;----------- Log Hit -----------&quot;)


Any insights?  I'd like to do the new version of this code in python,
and not perl, but I gotta get this cgi snafu solved.

Thanks,
Mike

_______________________________________________
Mod_python mailing list
<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
<A HREF="http://www.modpython.org/mailman/listinfo/mod_python">http://www.modpython.org/mailman/listinfo/mod_python</A>


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013466.html">[mod_python] Fixup hander not always being called
</A></li>
	<LI>Next message: <A HREF="013468.html">[mod_python] ANNOUNCE: Mod_python 3.0.3
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13467">[ date ]</a>
              <a href="thread.html#13467">[ thread ]</a>
              <a href="subject.html#13467">[ subject ]</a>
              <a href="author.html#13467">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
