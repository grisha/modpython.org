<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Mac OS X Leopard upset my mod_python test bed.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Mac%20OS%20X%20Leopard%20upset%20my%20mod_python%20test%20bed.&In-Reply-To=88e286470711251821l493fa193vdf8b1673cd3c4d69%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024506.html">
   <LINK REL="Next"  HREF="024508.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Mac OS X Leopard upset my mod_python test bed.</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Simon Kesenci</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Mac%20OS%20X%20Leopard%20upset%20my%20mod_python%20test%20bed.&In-Reply-To=88e286470711251821l493fa193vdf8b1673cd3c4d69%40mail.gmail.com"
       TITLE="[mod_python] Mac OS X Leopard upset my mod_python test bed.">god at skri.org
       </A><BR>
    <I>Sun Nov 25 22:47:12 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="024506.html">[mod_python] Mac OS X Leopard upset my mod_python test bed.
</A></li>
        <LI>Next message: <A HREF="024508.html">[mod_python] Mac OS X Leopard upset my mod_python test bed.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24507">[ date ]</a>
              <a href="thread.html#24507">[ thread ]</a>
              <a href="subject.html#24507">[ subject ]</a>
              <a href="author.html#24507">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Not sure how the Sharing Preferences starts apache but I suspect it  
uses something similar to sudo.  At any rate I tried starting it the  
way you described and mod_python still worked as expected.

I then removed /usr/local/bin from my personal account's path and  
logged back in, confirmed that the path lacked /usr/local/bin, used  
sudo -H to start apache again and mod_python still worked.

I then renamed /usr/local/bin to /usr/local/bin2, restarted apache and  
mod_python still worked.

It seems mod_python only needs to find the executable at the time you  
compile mod_python.

Though I have my setup working, the question of where mod_python got  
the path in the error log in my original message remains.  Neither  
interpreter on my computer yields that result via sys.path (although  
some of the items in that list correspond, via symlinks, to locations  
on the path from the interpreter that came with Leopard).

--S.

On Nov 25, 2007, at 18:21, Graham Dumpleton wrote:

&gt;<i> On 26/11/2007, Simon Kesenci &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">god at skri.org</A>&gt; wrote:
</I>&gt;&gt;<i> I haven't found a discussion of this problem in the archives.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Strange stuff.  It started working properly after I removed the /usr/
</I>&gt;&gt;<i> sbin/httpd symlink and copied the compiled version there.  It works
</I>&gt;&gt;<i> without setting PYTHONHOME and without /usr/local/bin in root's path.
</I>&gt;<i>
</I>&gt;<i> More than likely you used 'sudo' to restart Apache and it therefore
</I>&gt;<i> picked up your personal PATH which had /usr/local/bin first. Do a:
</I>&gt;<i>
</I>&gt;<i>  sudo -H apachcetl stop
</I>&gt;<i>  sudo -H apachectl start
</I>&gt;<i>
</I>&gt;<i> and see if you are so lucky. The -H option prevents your personal user
</I>&gt;<i> environment transferring over to Apache startup environment.
</I>&gt;<i>
</I>&gt;<i> Graham
</I>&gt;<i>
</I>&gt;&gt;<i> To answer your question, using the OS-provided installation (whatever
</I>&gt;&gt;<i> the OS) leaves your software to the mercies of the OS's update  
</I>&gt;&gt;<i> schedule.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> --S.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Nov 25, 2007, at 14:17, Graham Dumpleton wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> In 'envvars' file in the same directory as the real httpd you want
</I>&gt;&gt;&gt;<i> to run, add:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> PYTHONHOME=/usr/local
</I>&gt;&gt;&gt;<i> export PYTHONHOME
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Alternatively, you must ensure that the PATH of the user that Apache
</I>&gt;&gt;&gt;<i> is started as has /usr/local/bin in its path before /usr/bin, else  
</I>&gt;&gt;&gt;<i> it
</I>&gt;&gt;&gt;<i> will find the wrong 'python' executable and thus end up looking in  
</I>&gt;&gt;&gt;<i> the
</I>&gt;&gt;&gt;<i> wrong location for the corresponding lib directory.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Search the mod_python mailing lists for past discussions on this
</I>&gt;&gt;&gt;<i> issue.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> BTW, why do you want to install your own version of Python 2.5, what
</I>&gt;&gt;&gt;<i> is wrong with the Python 2.5 that the operating system ships?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Graham
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> On 26/11/2007, Simon Kesenci &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">god at skri.org</A>&gt; wrote:
</I>&gt;&gt;&gt;&gt;<i> I recently upgraded my PowerBook (PPC) to Leopard.  Piece by  
</I>&gt;&gt;&gt;&gt;<i> piece I
</I>&gt;&gt;&gt;&gt;<i> started reassembling my web server test bed (httpd 2.2.6, Python
</I>&gt;&gt;&gt;&gt;<i> 2.5.1, mod_python 3.3.1), which worked perfectly on Tiger.  I built
</I>&gt;&gt;&gt;&gt;<i> everything from their sources.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> This time around I got everything to work except for mod_python.   
</I>&gt;&gt;&gt;&gt;<i> My
</I>&gt;&gt;&gt;&gt;<i> procedure had the following non-standard edits:
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> httpd 2.2.6:
</I>&gt;&gt;&gt;&gt;<i>    Changed APR_HAS_SENDFILE to 0 in srclib/apr/include/apr.h
</I>&gt;&gt;&gt;&gt;<i>    After installation I backed up /usr/sbin/httpd and entered
</I>&gt;&gt;&gt;&gt;<i>      ln -s /usr/local/apache2/bin/httpd /usr/sbin/httpd.
</I>&gt;&gt;&gt;&gt;<i>    (This allows you to activate the compiled httpd from the Sharing
</I>&gt;&gt;&gt;&gt;<i> Preferences, which will also have the built-in firewall open and
</I>&gt;&gt;&gt;&gt;<i> close
</I>&gt;&gt;&gt;&gt;<i> port 80 in sync with the server.)
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Python 2.5.1:
</I>&gt;&gt;&gt;&gt;<i>    After ./configure --enable-framework I added -DSETPGRP_HAVE_ARG
</I>&gt;&gt;&gt;&gt;<i> to the top-level Makefile (make exits with an error otherwise due
</I>&gt;&gt;&gt;&gt;<i> to a
</I>&gt;&gt;&gt;&gt;<i> lack of arguments to setpgrp()).
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Both of the above work as expected, but when I threw mod_python  
</I>&gt;&gt;&gt;&gt;<i> into
</I>&gt;&gt;&gt;&gt;<i> the mix I kept getting the following error:
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> [Sun Nov 25 09:43:22 2007] [error] make_obcallback: could not  
</I>&gt;&gt;&gt;&gt;<i> import
</I>&gt;&gt;&gt;&gt;<i> mod_python.apache.\n
</I>&gt;&gt;&gt;&gt;<i> ImportError: No module named mod_python.apache
</I>&gt;&gt;&gt;&gt;<i> [Sun Nov 25 09:43:22 2007] [error] make_obcallback: Python path  
</I>&gt;&gt;&gt;&gt;<i> being
</I>&gt;&gt;&gt;&gt;<i> used &quot;['/usr/lib/python25.zip', '/usr/lib/python2.5', '/usr/lib/
</I>&gt;&gt;&gt;&gt;<i> python2.5/plat-darwin', '/usr/lib/python2.5/plat-mac', '/usr/lib/
</I>&gt;&gt;&gt;&gt;<i> python2.5/plat-mac/lib-scriptpackages', '/usr/lib/python2.5/lib-
</I>&gt;&gt;&gt;&gt;<i> tk', '/
</I>&gt;&gt;&gt;&gt;<i> usr/lib/python2.5/lib-dynload', '/Library/Python/2.5/site-
</I>&gt;&gt;&gt;&gt;<i> packages']&quot;.
</I>&gt;&gt;&gt;&gt;<i> [Sun Nov 25 09:43:22 2007] [error] get_interpreter: no interpreter
</I>&gt;&gt;&gt;&gt;<i> callback found.
</I>&gt;&gt;&gt;&gt;<i> [Sun Nov 25 09:43:22 2007] [error] [client 10.0.1.2]  
</I>&gt;&gt;&gt;&gt;<i> python_handler:
</I>&gt;&gt;&gt;&gt;<i> Can't get/create interpreter., referer: <A HREF="http://10.0.1.2/~simon/">http://10.0.1.2/~simon/</A> 
</I>&gt;&gt;&gt;&gt;<i> test/
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> I used a number of scripts to test the installation, including
</I>&gt;&gt;&gt;&gt;<i> mptest.py from the mod_python doc.  The last script I used to test
</I>&gt;&gt;&gt;&gt;<i> did
</I>&gt;&gt;&gt;&gt;<i> not import mod_python.apache explicitly:
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> from mod_python import util
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> def index(req):
</I>&gt;&gt;&gt;&gt;<i>  util.redirect(req, 'www.example.com')
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> While installing mod_python the output made clear that it took up  
</I>&gt;&gt;&gt;&gt;<i> the
</I>&gt;&gt;&gt;&gt;<i> interpreter in /usr/local/bin rather than the one provided by Apple
</I>&gt;&gt;&gt;&gt;<i> in /usr/bin and installed under /Library/Frameworks/ 
</I>&gt;&gt;&gt;&gt;<i> Python.framework/
</I>&gt;&gt;&gt;&gt;<i> Versions/2.5/lib/python2.5/site-packages/ rather than /Library/
</I>&gt;&gt;&gt;&gt;<i> Python/
</I>&gt;&gt;&gt;&gt;<i> 2.5/site-packages.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> I don't know from where it pulled that path.  The interpreter I
</I>&gt;&gt;&gt;&gt;<i> compiled uses the path:
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> ['', '/Library/Frameworks/Python.framework/Versions/2.5/lib/
</I>&gt;&gt;&gt;&gt;<i> python25.zip', '/Library/Frameworks/Python.framework/Versions/2.5/
</I>&gt;&gt;&gt;&gt;<i> lib/
</I>&gt;&gt;&gt;&gt;<i> python2.5', '/Library/Frameworks/Python.framework/Versions/2.5/lib/
</I>&gt;&gt;&gt;&gt;<i> python2.5/plat-darwin', '/Library/Frameworks/Python.framework/
</I>&gt;&gt;&gt;&gt;<i> Versions/
</I>&gt;&gt;&gt;&gt;<i> 2.5/lib/python2.5/plat-mac', '/Library/Frameworks/Python.framework/
</I>&gt;&gt;&gt;&gt;<i> Versions/2.5/lib/python2.5/plat-mac/lib-scriptpackages', '/Library/
</I>&gt;&gt;&gt;&gt;<i> Frameworks/Python.framework/Versions/2.5/lib/python2.5/lib-tk', '/
</I>&gt;&gt;&gt;&gt;<i> Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/lib-
</I>&gt;&gt;&gt;&gt;<i> dynload', '/Library/Frameworks/Python.framework/Versions/2.5/lib/
</I>&gt;&gt;&gt;&gt;<i> python2.5/site-packages']
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> The interpreter provided by Apple uses:
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> ['', '/System/Library/Frameworks/Python.framework/Versions/2.5/lib/
</I>&gt;&gt;&gt;&gt;<i> python25.zip', '/System/Library/Frameworks/Python.framework/ 
</I>&gt;&gt;&gt;&gt;<i> Versions/
</I>&gt;&gt;&gt;&gt;<i> 2.5/lib/python2.5', '/System/Library/Frameworks/Python.framework/
</I>&gt;&gt;&gt;&gt;<i> Versions/2.5/lib/python2.5/plat-darwin', '/System/Library/ 
</I>&gt;&gt;&gt;&gt;<i> Frameworks/
</I>&gt;&gt;&gt;&gt;<i> Python.framework/Versions/2.5/lib/python2.5/plat-mac', '/System/
</I>&gt;&gt;&gt;&gt;<i> Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/ 
</I>&gt;&gt;&gt;&gt;<i> plat-
</I>&gt;&gt;&gt;&gt;<i> mac/lib-scriptpackages', '/System/Library/Frameworks/
</I>&gt;&gt;&gt;&gt;<i> Python.framework/
</I>&gt;&gt;&gt;&gt;<i> Versions/2.5/Extras/lib/python', '/System/Library/Frameworks/
</I>&gt;&gt;&gt;&gt;<i> Python.framework/Versions/2.5/lib/python2.5/lib-tk', '/System/
</I>&gt;&gt;&gt;&gt;<i> Library/
</I>&gt;&gt;&gt;&gt;<i> Frameworks/Python.framework/Versions/2.5/lib/python2.5/lib-
</I>&gt;&gt;&gt;&gt;<i> dynload', '/
</I>&gt;&gt;&gt;&gt;<i> Library/Python/2.5/site-packages', '/System/Library/Frameworks/
</I>&gt;&gt;&gt;&gt;<i> Python.framework/Versions/2.5/Extras/lib/python/PyObjC']
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> This morning I logged on to my Linux web server and installed all
</I>&gt;&gt;&gt;&gt;<i> these packages from source without any problems.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> --S.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;&gt;<i> Mod_python mailing list
</I>&gt;&gt;&gt;&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;&gt;&gt;&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Mod_python mailing list
</I>&gt;&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;&gt;<i>
</I>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024506.html">[mod_python] Mac OS X Leopard upset my mod_python test bed.
</A></li>
	<LI>Next message: <A HREF="024508.html">[mod_python] Mac OS X Leopard upset my mod_python test bed.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24507">[ date ]</a>
              <a href="thread.html#24507">[ thread ]</a>
              <a href="subject.html#24507">[ subject ]</a>
              <a href="author.html#24507">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
