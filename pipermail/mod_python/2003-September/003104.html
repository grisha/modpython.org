<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] File upload
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20File%20upload&In-Reply-To=3F69630C.2090403%40sjsoft.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003097.html">
   <LINK REL="Next"  HREF="003098.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] File upload</H1>
    <B>Kirk Bailey</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20File%20upload&In-Reply-To=3F69630C.2090403%40sjsoft.com"
       TITLE="[mod_python] File upload">idiot1 at netzero.net
       </A><BR>
    <I>Thu Sep 18 12:11:42 EST 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="003097.html">[mod_python] File upload
</A></li>
        <LI>Next message: <A HREF="003098.html">[mod_python] File upload
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3104">[ date ]</a>
              <a href="thread.html#3104">[ thread ]</a>
              <a href="subject.html#3104">[ subject ]</a>
              <a href="author.html#3104">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>My wiki, wikinehesa, has a upload in it. Try downloading it, and read the form 
in the footer of the page generated by wikinehesaed1.py, and read the script 
wikinehesaed2.py to see how the thing handles doing an upload.

<A HREF="http://www.tinylist.org/">http://www.tinylist.org/</A>

scan down to the OTHER STUFF section and there is the download for wikinehesa. 
To play with it, up by the top near the hit counter is a link to a working 
install of the wiki.

David Fraser wrote:

&gt;<i> Greenbeard wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> Does anyone have a good file upload example? 
</I>&gt;&gt;<i> When I try something like:
</I>&gt;&gt;<i> def upload(req, file):
</I>&gt;&gt;<i>    tempFile = file.read()
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I get: AttributeError: File instance has no attribute
</I>&gt;&gt;<i> 'read'
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> if I use:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    tempFile = req.form['file'] I get the file contents but I don't 
</I>&gt;&gt;<i> think this would
</I>&gt;&gt;<i> work well with large files (or would it?)
</I>&gt;&gt;<i> Also,
</I>&gt;&gt;<i> when I try to get attribues like file.type I get
</I>&gt;&gt;<i> AttributeError: File instance has no attribute 'type'.
</I>&gt;&gt;<i> I do get the file.filename.  
</I>&gt;&gt;<i> So how can I tell if it should be a binary write etc.?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> It looks like the publisher handler (which I am using)
</I>&gt;&gt;<i> returns a File object but I can not get it to act like
</I>&gt;&gt;<i> a file/StringIO object nor can I accesss the
</I>&gt;&gt;<i> attributes that are mentioned in the documentation.  
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I am using W2k, Python 2.2  and Mod_py 3.0.3. 
</I>&gt;&gt;<i> Thanks for the help,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> gb400
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> __________________________________
</I>&gt;&gt;<i> Do you Yahoo!?
</I>&gt;&gt;<i> Yahoo! SiteBuilder - Free, easy-to-use web site design software
</I>&gt;&gt;<i> <A HREF="http://sitebuilder.yahoo.com">http://sitebuilder.yahoo.com</A>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Mod_python mailing list
</I>&gt;&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  
</I>&gt;&gt;<i>
</I>&gt;<i> Don't know much about publisher, but a normal mod_python handler should 
</I>&gt;<i> be able to do something like this (totally untested code):
</I>&gt;<i> 
</I>&gt;<i> def handle(req):
</I>&gt;<i>  argdict = util.FieldStorage(req)
</I>&gt;<i>  for key in argdict.keys():
</I>&gt;<i>    value = argdict[key]
</I>&gt;<i>    if type(value) == types.InstanceType:
</I>&gt;<i>      if isinstance(value, util.StringField):
</I>&gt;<i>        # this is for a normal field...
</I>&gt;<i>        pass
</I>&gt;<i>      elif isinstance(value, util.Field):
</I>&gt;<i>        # this is for an attachment upload...
</I>&gt;<i>        filename = field.filename
</I>&gt;<i>        content_type = field.type
</I>&gt;<i>        # this will work by doing a read...
</I>&gt;<i>        contents = field.value
</I>&gt;<i>        # or you can do the read yourself:
</I>&gt;<i>        field.file.seek(0)
</I>&gt;<i>        contents = field.file.read()
</I>&gt;<i>        # reset the position so others can read it
</I>&gt;<i>        field.file.seek(0)
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>
-- 

-- 

end

Cheers!
         Kirk D Bailey

  +                              think                                +
   <A HREF="http://www.howlermonkey.net">http://www.howlermonkey.net</A>  +-----+        <A HREF="http://www.tinylist.org">http://www.tinylist.org</A>
   <A HREF="http://www.listville.net">http://www.listville.net</A>     | BOX |  <A HREF="http://www.sacredelectron.org">http://www.sacredelectron.org</A>
   Thou art free&quot;-ERIS          +-----+     'Got a light?'-Prometheus
  +                              kniht                                +

Fnord.

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003097.html">[mod_python] File upload
</A></li>
	<LI>Next message: <A HREF="003098.html">[mod_python] File upload
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3104">[ date ]</a>
              <a href="thread.html#3104">[ thread ]</a>
              <a href="subject.html#3104">[ subject ]</a>
              <a href="author.html#3104">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
