<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] [help]please give an input filter example ?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20%5Bhelp%5Dplease%20give%20an%20input%20filter%20example%20%3F&In-Reply-To=003301c38403%249ca9ae00%24db64a8c0%40camgelo">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006832.html">
   <LINK REL="Next"  HREF="006841.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] [help]please give an input filter example ?</H1>
    <B>Gregory (Grisha) Trubetskoy</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20%5Bhelp%5Dplease%20give%20an%20input%20filter%20example%20%3F&In-Reply-To=003301c38403%249ca9ae00%24db64a8c0%40camgelo"
       TITLE="[mod_python] [help]please give an input filter example ?">grisha at modpython.org
       </A><BR>
    <I>Fri Sep 26 10:53:56 EST 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="006832.html">[mod_python] [help]please give an input filter example ?
</A></li>
        <LI>Next message: <A HREF="006841.html">[mod_python] [help]please give an input filter example ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6833">[ date ]</a>
              <a href="thread.html#6833">[ thread ]</a>
              <a href="subject.html#6833">[ subject ]</a>
              <a href="author.html#6833">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<table border=0 width="100%"><tr><td>
<!--beginarticle-->
<PRE>
Interesting...

If you could change filterobject.c, around line 223, where the code looks
like:

       if (! APR_STATUS_IS_SUCCESS(self-&gt;rc)) {
            PyErr_SetObject(PyExc_IOError,
                            PyString_FromString(&quot;Input filter read error&quot;));
            return NULL;
To:

       if (! APR_STATUS_IS_SUCCESS(self-&gt;rc)) {
            PyErr_Format(PyExc_IOError, &quot;Input filter read error: %d&quot;,
                         self-&gt;rc);
            return NULL;

This will log the actual return code that Apache is returning on this
error, it might give us more information on what is really going on there.

Thanks,

Grisha


On Fri, 26 Sep 2003, camge wrote:

&gt;<i> regardless of Content-Length problem,
</I>&gt;<i> I found my apache's error log has these error message when I post data to
</I>&gt;<i> cgi.
</I>&gt;<i> ------------------------------------------------
</I>&gt;<i> ...
</I>&gt;<i> [Fri Sep 26 15:51:31 2003] [error] [client 192.168.100.219] inputfilter
</I>&gt;<i> cameoInputFilter: Traceback (most recent call last):, referer:
</I>&gt;<i> <A HREF="http://192.168.100.161/test/index.htm">http://192.168.100.161/test/index.htm</A>
</I>&gt;<i> [Fri Sep 26 15:51:31 2003] [error] [client 192.168.100.219] inputfilter
</I>&gt;<i> cameoInputFilter:   File &quot;C:\Program
</I>&gt;<i> Files\WebSite\lib\python22\lib\site-packages\mod_python\apache.py&quot;, line
</I>&gt;<i> 222, in FilterDispatch
</I>&gt;<i>     object(filter), referer: <A HREF="http://192.168.100.161/test/index.htm">http://192.168.100.161/test/index.htm</A>
</I>&gt;<i> [Fri Sep 26 15:51:31 2003] [error] [client 192.168.100.219] inputfilter
</I>&gt;<i> cameoInputFilter:   File &quot;C:/Program
</I>&gt;<i> Files/WebSite/httpd/CameoMobileSpace\cameoInputFilter.py&quot;, line 9, in
</I>&gt;<i> inputfilter
</I>&gt;<i>     strBody = filter.read(), referer: <A HREF="http://192.168.100.161/test/index.htm">http://192.168.100.161/test/index.htm</A>
</I>&gt;<i> [Fri Sep 26 15:51:31 2003] [error] [client 192.168.100.219] inputfilter
</I>&gt;<i> cameoInputFilter: IOError: Input filter read error, referer:
</I>&gt;<i> <A HREF="http://192.168.100.161/test/index.htm">http://192.168.100.161/test/index.htm</A>
</I>&gt;<i> ...
</I>&gt;<i> -------------------------------------------------
</I>&gt;<i> although having error log, input filter still works.
</I>&gt;<i> Should I catch this exception? and how to handle it, close filter or just
</I>&gt;<i> return?
</I>&gt;<i> Below is my simple inputfilter:
</I>&gt;<i>
</I>&gt;<i> def inputfilter(filter):
</I>&gt;<i>     strBody = filter.read()
</I>&gt;<i>     if strBody:
</I>&gt;<i>         filter.write(strBody)
</I>&gt;<i>     else:
</I>&gt;<i>         filter.close()
</I>&gt;<i>     return apache.OK
</I>&gt;<i>
</I></PRE>
<!--endarticle-->
</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006832.html">[mod_python] [help]please give an input filter example ?
</A></li>
	<LI>Next message: <A HREF="006841.html">[mod_python] [help]please give an input filter example ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6833">[ date ]</a>
              <a href="thread.html#6833">[ thread ]</a>
              <a href="subject.html#6833">[ subject ]</a>
              <a href="author.html#6833">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
