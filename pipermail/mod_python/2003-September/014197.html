<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] [help]please give an input filter example ?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20%5Bhelp%5Dplease%20give%20an%20input%20filter%20example%20%3F&In-Reply-To=000e01c37de9%2460cfd0f0%24db64a8c0%40camgelo">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014193.html">
   <LINK REL="Next"  HREF="014206.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] [help]please give an input filter example ?</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>David Fraser</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20%5Bhelp%5Dplease%20give%20an%20input%20filter%20example%20%3F&In-Reply-To=000e01c37de9%2460cfd0f0%24db64a8c0%40camgelo"
       TITLE="[mod_python] [help]please give an input filter example ?">davidf at sjsoft.com
       </A><BR>
    <I>Thu Sep 18 18:02:34 EST 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="014193.html">[mod_python] [help]please give an input filter example ?
</A></li>
        <LI>Next message: <A HREF="014206.html">[mod_python] [help]please give an input filter example ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14197">[ date ]</a>
              <a href="thread.html#14197">[ thread ]</a>
              <a href="subject.html#14197">[ subject ]</a>
              <a href="author.html#14197">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>camge wrote:

&gt;<i>----- Original Message ----- 
</I>&gt;<i>From: &quot;David Fraser&quot; &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">davidf at sjsoft.com</A>&gt;
</I>&gt;<i>To: &quot;camge&quot; &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">is83070 at cis.nctu.edu.tw</A>&gt;
</I>&gt;<i>Cc: &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mod_python at modpython.org</A>&gt;
</I>&gt;<i>Sent: Thursday, September 18, 2003 7:05 PM
</I>&gt;<i>Subject: Re: [mod_python] [help]please give an input filter example ?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  
</I>&gt;<i>
</I>&gt;&gt;<i>camge wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>----- Original Message ----- 
</I>&gt;&gt;&gt;<i>From: &quot;David Fraser&quot; &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">davidf at sjsoft.com</A>&gt;
</I>&gt;&gt;&gt;<i>To: &quot;camge&quot; &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">is83070 at cis.nctu.edu.tw</A>&gt;
</I>&gt;&gt;&gt;<i>Sent: Thursday, September 18, 2003 6:12 PM
</I>&gt;&gt;&gt;<i>Subject: Re: [mod_python] [help]please give an input filter example ?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>      
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>camge wrote:
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>Hi ,
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>  I have written an output filter, and it works fine.
</I>&gt;&gt;&gt;&gt;&gt;<i>But I dont know how to write an input filter, there are not any
</I>&gt;&gt;&gt;&gt;&gt;<i>          
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;<i>examples.
</I>&gt;<i>  
</I>&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>I have tried to write an simple input filter according to an output
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>          
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>filter.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>      
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>But it always makes IE hang there.
</I>&gt;&gt;&gt;&gt;&gt;<i>If any one can give me an example about input filter?
</I>&gt;&gt;&gt;&gt;&gt;<i>Thanks a lot!
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>My environment:
</I>&gt;&gt;&gt;&gt;&gt;<i>Apache/2.0.44 (Win32)
</I>&gt;&gt;&gt;&gt;&gt;<i>mod_ssl/2.0.44
</I>&gt;&gt;&gt;&gt;&gt;<i>OpenSSL/0.9.7
</I>&gt;&gt;&gt;&gt;&gt;<i>mod_python/3.0.3
</I>&gt;&gt;&gt;&gt;&gt;<i>Python/2.2.2
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>Best regards,
</I>&gt;&gt;&gt;&gt;&gt;<i>camge
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>          
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>Why don't you send your example input filter that makes IE hang?
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>Thanks
</I>&gt;&gt;&gt;&gt;<i>David
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>        
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>Below is my simple input filter inputFilter.py:
</I>&gt;&gt;&gt;<i>-------------------------------------------------------------
</I>&gt;&gt;&gt;<i>def inputfilter(filter):
</I>&gt;&gt;&gt;<i>   f=open('filter.log','ab')#for debug
</I>&gt;&gt;&gt;<i>   data='start'
</I>&gt;&gt;&gt;<i>   while data!=None:
</I>&gt;&gt;&gt;<i>       try:
</I>&gt;&gt;&gt;<i>           data = filter.read()
</I>&gt;&gt;&gt;<i>           if data:
</I>&gt;&gt;&gt;<i>               filter.write(data)
</I>&gt;&gt;&gt;<i>               f.write(str(data))
</I>&gt;&gt;&gt;<i>       except Exception,e:
</I>&gt;&gt;&gt;<i>               f.write(str(e))
</I>&gt;&gt;&gt;<i>               data=None
</I>&gt;&gt;&gt;<i>    if data==None:
</I>&gt;&gt;&gt;<i>       filter.close()
</I>&gt;&gt;&gt;<i>    f.close()
</I>&gt;&gt;&gt;<i>----------------------------------------
</I>&gt;&gt;&gt;<i>httpd.conf:
</I>&gt;&gt;&gt;<i>----------------------------------------
</I>&gt;&gt;&gt;<i>&lt;Location /test/&gt;
</I>&gt;&gt;&gt;<i>    PythonInputFilter inputFilter MyInputFilter
</I>&gt;&gt;&gt;<i>    SetInputFilter MyInputFilter
</I>&gt;&gt;&gt;<i>&lt;/Location&gt;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>      
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>Excuse me rearranging your post, bottom posting makes discussion easier...
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>I think the problem here is that you're doing filter.read() which will
</I>&gt;&gt;<i>read until an end of file, which will never happen on an input filter.
</I>&gt;&gt;<i>You probably need a more intelligent way of working out when to stop
</I>&gt;&gt;<i>reading, e.g. for HTTP, you could read a line at a time.
</I>&gt;&gt;<i>What are you wanting to use the input filter for?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>David
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    
</I>&gt;&gt;<i>
</I>&gt;<i>Thanks for your fast response!
</I>&gt;<i>I have tried filter.readline(), but it still reads nothing.
</I>&gt;<i>  
</I>&gt;<i>
</I>That's a pleasure. OK, I don't really know anything about input filters, 
I was just pretending... maybe some else can help

&gt;<i>I need input filter to convert character set of form data submitted by cell
</I>&gt;<i>phone browser.
</I>&gt;<i>For example, convert utf-8 to big5 or gb.
</I>&gt;<i>If I can do it in input filter, then I dont need to modify all of my pages.
</I>&gt;<i>  
</I>&gt;<i>
</I>Aha. What I would do is just put a function in a module that changes the 
encoding.
Get the arguments like you normally would, then just do a decode/encode.
Since that module can be accessed from anywhere, it will work just as well.
Also, it's less likely to cause bugs, and will probably be faster 
(you'll only making one jump into the Python interpreter and back)

Cheers
David


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014193.html">[mod_python] [help]please give an input filter example ?
</A></li>
	<LI>Next message: <A HREF="014206.html">[mod_python] [help]please give an input filter example ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14197">[ date ]</a>
              <a href="thread.html#14197">[ thread ]</a>
              <a href="subject.html#14197">[ subject ]</a>
              <a href="author.html#14197">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
