<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] 	does a mod_python handler exist to generate
	charts/graphs? (png	images)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20%09does%20a%20mod_python%20handler%20exist%20to%20generate%0A%09charts/graphs%3F%20%28png%09images%29&In-Reply-To=OFACFE0A3B.CBD0AC18-ON85256DA6.004B1817-85256DA6.004CDDEC%40EU.novartis.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006814.html">
   <LINK REL="Next"  HREF="006817.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] 	does a mod_python handler exist to generate
	charts/graphs? (png	images)</H1>
    <B>David Fraser</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20%09does%20a%20mod_python%20handler%20exist%20to%20generate%0A%09charts/graphs%3F%20%28png%09images%29&In-Reply-To=OFACFE0A3B.CBD0AC18-ON85256DA6.004B1817-85256DA6.004CDDEC%40EU.novartis.net"
       TITLE="[mod_python] 	does a mod_python handler exist to generate
	charts/graphs? (png	images)">davidf at sjsoft.com
       </A><BR>
    <I>Fri Sep 19 16:18:16 EST 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="006814.html">[mod_python] 	does a mod_python handler exist to generate
	charts/graphs? (png	images)
</A></li>
        <LI>Next message: <A HREF="006817.html">[mod_python]  does a mod_python handler exist to generate
 charts/graphs? (png images)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6815">[ date ]</a>
              <a href="thread.html#6815">[ thread ]</a>
              <a href="subject.html#6815">[ subject ]</a>
              <a href="author.html#6815">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<table border=0 width="100%"><tr><td>
<!--beginarticle-->
<PRE><A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">perry.tew at cibavision.novartis.com</A> wrote:

&gt;<i>David,
</I>&gt;<i>   Thanks for the input.  I'll add chaco and gnuplot.py to the list.  So 
</I>&gt;<i>far I have (in no order):
</I>&gt;<i>
</I>&gt;<i>reportlab
</I>&gt;<i>pygdchart
</I>&gt;<i>chaco
</I>&gt;<i>gnuplot
</I>&gt;<i>
</I>&gt;<i>I'll have to start investigating each of them.  chaco and gnuplot appear 
</I>&gt;<i>to have massive options and functionality.
</I>&gt;<i>  
</I>&gt;<i>
</I>Great. I'm away for the next few days so it'll be interesting to see 
what you find.

&gt;<i>
</I>&gt;<i>In response to your earlier suggestions:
</I>&gt;<i>&quot;&quot;&quot;
</I>&gt;<i>This kind of thing is pretty simple, you can either create a 
</I>&gt;<i>StringIO.StringIO object (standard Python) which is a pseudo-file that 
</I>&gt;<i>you can get the contents out of using a string, or you could try passing 
</I>&gt;<i>the request object (at the appropriate time) and see if it will work 
</I>&gt;<i>writing to that.
</I>&gt;<i>Another option (assuming the project is open source) is to alter the 
</I>&gt;<i>program to support returning the data in a string.
</I>&gt;<i>I got the reportlab guys to do this - their project is mainly focussed 
</I>&gt;<i>on Reports and PDF, but it also has charting capabilities I haven't 
</I>&gt;<i>investigated.
</I>&gt;<i>&quot;&quot;&quot;
</I>&gt;<i>
</I>&gt;<i>I tried to use the StringIO object from both StringIO and cStringIO.  The 
</I>&gt;<i>library didn't like
</I>&gt;<i>that at all.  I traced some of the pygdchart code.  It drops down into C 
</I>&gt;<i>and calls the following code (from _gdchartc.c)
</I>&gt;<i>( I stripped out some unnecessary lines):
</I>&gt;<i>PyObject *pfile, *labels, *data, *combodata;
</I>&gt;<i>FILE *fp;
</I>&gt;<i>...
</I>&gt;<i>if (!PyArg_ParseTuple(args, &quot;iiO!iiOiOO&quot;, &amp;width, &amp;height, &amp;PyFile_Type, 
</I>&gt;<i>&amp;pfile, 
</I>&gt;<i>...
</I>&gt;<i>fp = PyFile_AsFile(pfile);
</I>&gt;<i>
</I>&gt;<i>I so new to python it hurts, but I'm guessing that at this point in a C 
</I>&gt;<i>program, pfile has to be an
</I>&gt;<i>actual pointer to a file and not a file-like interface such as StringIO? 
</I>&gt;<i>Any experience with this?
</I>&gt;<i>
</I>&gt;<i>As for having the author change the interface, I've already emailed them. 
</I>&gt;<i>Later on I found
</I>&gt;<i>the cStringIO functionality listed in a TODO file for the pygdchart 
</I>&gt;<i>library.  Guess I'm not the first...
</I>&gt;<i>I don't know how possible it would be to use cStringIO, since the FILE 
</I>&gt;<i>pointer is passed through a mess of C libraries
</I>&gt;<i>
</I>&gt;<i>gdchart -&gt; gd -&gt; libjpeg
</I>&gt;<i>
</I>&gt;<i>The functions all the way down to libjpeg are wanting a pointer to a FILE 
</I>&gt;<i>structure.   My other thought was
</I>&gt;<i>looking for a way to imitate the FILE pointer in memory and modifying the 
</I>&gt;<i>entry C code to return back the
</I>&gt;<i>in memory data as a binary stream.  I'll have to look into that as well. 
</I>&gt;<i>My C is pretty weak as well.  I'm
</I>&gt;<i>so thankful there's Google.
</I>&gt;<i>
</I>&gt;<i>As a workaround, here's what I did (using os.tmpfile):
</I>&gt;<i>
</I>&gt;<i>from mod_python import apache
</I>&gt;<i>from mod_python import util
</I>&gt;<i>import gdchart
</I>&gt;<i>import os
</I>&gt;<i>
</I>&gt;<i>def handler(req):
</I>&gt;<i>        req.content_type = &quot;image/png&quot;
</I>&gt;<i>
</I>&gt;<i>        chart = gdchart.Line3D()
</I>&gt;<i>        chart.width = 250
</I>&gt;<i>        chart.height = 250
</I>&gt;<i>        chart.xtitle = &quot;xtitle goes here&quot;
</I>&gt;<i>        chart.ytitle = &quot;Percentage&quot;
</I>&gt;<i>        chart.title = &quot;Example Graph&quot;
</I>&gt;<i>        chart.ext_color = [ &quot;white&quot;, &quot;yellow&quot;, &quot;red&quot;, &quot;blue&quot;, &quot;green&quot;]
</I>&gt;<i>        chart.setData([20, 100, 80, 30, 50],[10,150,20,25,65])
</I>&gt;<i>        chart.setLabels([&quot;Mon&quot;, &quot;Tue&quot;, &quot;Wed&quot;, &quot;Thu&quot;, &quot;Fri&quot;])
</I>&gt;<i>        chart.setLabels([&quot;Mon&quot;, &quot;Tue&quot;, &quot;Wed&quot;, &quot;Thu&quot;, &quot;Fri&quot;])
</I>&gt;<i>
</I>&gt;<i>        f = os.tmpfile()
</I>&gt;<i>        chart.draw(f)
</I>&gt;<i>        f.seek(0)
</I>&gt;<i>        req.write(f.read())
</I>&gt;<i>        f.close()
</I>&gt;<i>
</I>&gt;<i>        return apache.OK
</I>&gt;<i>
</I>&gt;<i>It outputs a graph for me.    Here's another question that may be 
</I>&gt;<i>better suited for comp.lang.python, but do you know if
</I>&gt;<i>os.tmpfile() uses an in-memory representation of a file
</I>&gt;<i>or does it use a physical file that just remains anonymous?  I'm 
</I>&gt;<i>concerned about the wasteful loss of speed having to write to
</I>&gt;<i>disk and read it back.
</I>&gt;<i>
</I>&gt;<i>Well, enough rambling.  Thanks for your time,
</I>&gt;<i>Perry Tew
</I>&gt;<i>  
</I>&gt;<i>
</I>I'm pretty sure os.tmpfile() is a real file. It should probably be 
deleted afterwards.
Definitely the better option here is changing the library...
Thanks for the investigations
David


</PRE>
<!--endarticle-->
</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006814.html">[mod_python] 	does a mod_python handler exist to generate
	charts/graphs? (png	images)
</A></li>
	<LI>Next message: <A HREF="006817.html">[mod_python]  does a mod_python handler exist to generate
 charts/graphs? (png images)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6815">[ date ]</a>
              <a href="thread.html#6815">[ thread ]</a>
              <a href="subject.html#6815">[ subject ]</a>
              <a href="author.html#6815">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
