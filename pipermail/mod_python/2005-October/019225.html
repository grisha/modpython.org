<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] PyThreadState_Delete: tstate is still current
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20PyThreadState_Delete%3A%20tstate%20is%20still%20current&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019224.html">
   <LINK REL="Next"  HREF="019226.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] PyThreadState_Delete: tstate is still current</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Peter Sanchez</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20PyThreadState_Delete%3A%20tstate%20is%20still%20current&In-Reply-To="
       TITLE="[mod_python] PyThreadState_Delete: tstate is still current">petersanchez at gmail.com
       </A><BR>
    <I>Mon Oct 10 22:12:44 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="019224.html">[mod_python] mysqldb calls cause segfault
</A></li>
        <LI>Next message: <A HREF="019226.html">[mod_python] mod_python, WebDAV and dynamic VirtualHosts
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19225">[ date ]</a>
              <a href="thread.html#19225">[ thread ]</a>
              <a href="subject.html#19225">[ subject ]</a>
              <a href="author.html#19225">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey all...

I have an issue. I am developing some software for a website using
mod_python.publisher. I just upgraded from apache 1.3.33/mod_python
2.7.11 to apache2.0.54/mod_python3.1.4. They were installed via Ports,
and the OS is FreeBSD 4.11-STABLE.

The version of python installed is 2.4.1, no-threads. This was also
installed via ports.

Now, prior to the upgrade, the software I am working on, was
functioning correctly, now it is not. The entire data (html) is not
making it to the user (browser.) The page that is loading does load
most of the way, I can see images, text, etc. The entire page just
doesn't load, and my browser (Safari) reports a bad server response
(due to the mod_python script crashing, see below)

The logs show this:

Fatal Python error: PyThreadState_Delete: tstate is still current
[Mon Oct 10 18:49:48 2005] [notice] child pid 2161 exit signal Abort trap (6)

This is the same error for EVERY time I load any page (function) in my
python script. Like I said before, the code was working prior to the
upgrade. The reason for the upgrade is Session support, which appears
to only be in 3.x tree of mod_python.

This is the apache config I am using (in relation to mod_python):

&lt;Directory /home/user/public_html/modpy&gt;
        Options -MultiViews
        AddHandler python-program .py
        SetHandler python-program
        PythonHandler mod_python.publisher
        PythonDebug On
        Order allow,deny
        Allow from all
    &lt;/Directory&gt;

I have tried searching google and haven't found the solution. Can
anyone help me out here? Again, the script does give some data but
dies/crashes before it is complete.

Thanks in advance for any and all help!

Peter

</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019224.html">[mod_python] mysqldb calls cause segfault
</A></li>
	<LI>Next message: <A HREF="019226.html">[mod_python] mod_python, WebDAV and dynamic VirtualHosts
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19225">[ date ]</a>
              <a href="thread.html#19225">[ thread ]</a>
              <a href="subject.html#19225">[ subject ]</a>
              <a href="author.html#19225">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
