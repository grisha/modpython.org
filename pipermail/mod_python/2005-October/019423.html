<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] I: Too many cookies using mod_python 3.2.2b from
	mod_python-3.2.2b.win32-py2.4.exe
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20I%3A%20Too%20many%20cookies%20using%20mod_python%203.2.2b%20from%0A%09mod_python-3.2.2b.win32-py2.4.exe&In-Reply-To=BC53C974C3B9E542BC0A9BD4C5B1168A0B765E%40NEWMAIL.manord.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019420.html">
   <LINK REL="Next"  HREF="019424.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] I: Too many cookies using mod_python 3.2.2b from
	mod_python-3.2.2b.win32-py2.4.exe</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Jim Gallacher</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20I%3A%20Too%20many%20cookies%20using%20mod_python%203.2.2b%20from%0A%09mod_python-3.2.2b.win32-py2.4.exe&In-Reply-To=BC53C974C3B9E542BC0A9BD4C5B1168A0B765E%40NEWMAIL.manord.com"
       TITLE="[mod_python] I: Too many cookies using mod_python 3.2.2b from
	mod_python-3.2.2b.win32-py2.4.exe">jg.lists at sympatico.ca
       </A><BR>
    <I>Wed Oct 26 17:22:48 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="019420.html">[mod_python] I: Too many cookies using mod_python 3.2.2b from
	mod_python-3.2.2b.win32-py2.4.exe
</A></li>
        <LI>Next message: <A HREF="019424.html">[mod_python] mpservlets, hypertext and mathml 
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19423">[ date ]</a>
              <a href="thread.html#19423">[ thread ]</a>
              <a href="subject.html#19423">[ subject ]</a>
              <a href="author.html#19423">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Manera, Villiam wrote:
&gt;<i> This for complete my previus message:
</I>&gt;<i> Without  2 lines added in the beta release I still have only 1 cookie as before.
</I>&gt;<i> 
</I>&gt;<i> class BaseSession(dict):
</I>&gt;<i> .........
</I>&gt;<i>         if self._sid:
</I>&gt;<i>             # attempt to load ourselves
</I>&gt;<i>             self.lock()
</I>&gt;<i>             if self.load():
</I>&gt;<i>                 self._new = 0
</I>&gt;<i>                 #if not req.headers_out.has_key(&quot;Set-Cookie&quot;):
</I>&gt;<i>                 #    Cookie.add_cookie(self._req, Cookie.Cookie(session_cookie_name, self._sid))
</I>&gt;<i> 
</I>

OK, here is the story.

The two lines you've commented out were added to 3.2 to support some new 
session handling functionality. For various reasons that new 
functionality has been deferred until 3.3, but the new code was not 
removed. That should not be a problem, except that it is both buggy and 
wrong. :-(

It should look more like:

          if self._sid:
              # attempt to load ourselves
              self.lock()
              if self.load():
                  self._new = 0
                  # set a cookie if the source of self._sid was not a
                  # a cookie
                  if not cookies.has_key(session_cookie_name): 

                      Cookie.add_cookie(self._req, self.make_cookie())

self.make_cookie() takes care of your ApplicationPath problem. For the 
time being however, your solution (removing those 2 lines altogether) is 
the correct one.

This will be fixed for the 3.2 final release.

Regards,
Jim
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019420.html">[mod_python] I: Too many cookies using mod_python 3.2.2b from
	mod_python-3.2.2b.win32-py2.4.exe
</A></li>
	<LI>Next message: <A HREF="019424.html">[mod_python] mpservlets, hypertext and mathml 
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19423">[ date ]</a>
              <a href="thread.html#19423">[ thread ]</a>
              <a href="subject.html#19423">[ subject ]</a>
              <a href="author.html#19423">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
