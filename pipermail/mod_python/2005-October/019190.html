<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] multiple requests to authenhandler for a single url
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20multiple%20requests%20to%20authenhandler%20for%20a%20single%20url&In-Reply-To=20051005231340.D29249%40grisha.dyndns.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019189.html">
   <LINK REL="Next"  HREF="019197.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] multiple requests to authenhandler for a single url</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>reghigh</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20multiple%20requests%20to%20authenhandler%20for%20a%20single%20url&In-Reply-To=20051005231340.D29249%40grisha.dyndns.org"
       TITLE="[mod_python] multiple requests to authenhandler for a single url">reghigh at thefactz.org
       </A><BR>
    <I>Thu Oct  6 05:13:15 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="019189.html">[mod_python] multiple requests to authenhandler for a single url
</A></li>
        <LI>Next message: <A HREF="019197.html">[mod_python] multiple requests to authenhandler for a single url
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19190">[ date ]</a>
              <a href="thread.html#19190">[ thread ]</a>
              <a href="subject.html#19190">[ subject ]</a>
              <a href="author.html#19190">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Gregory (Grisha) Trubetskoy wrote:
&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> On Wed, 5 Oct 2005, Jim Gallacher wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> It's not too much of a stretch to imagine that it may call the auth 
</I>&gt;&gt;<i> handler once for each subdirectory in a url as well.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> This is exactly how it works - the handler is called once for every 
</I>&gt;<i> directory. One way to think of it is to ask a question - How else would 
</I>&gt;<i> you get an opportunity to check whether a directory is allowed to be 
</I>&gt;<i> seen from outside?
</I>
Thanks for the replies especially to Jim for the points about searching 
for htaccess. The idea about apache producing an authen request for each 
subdirectory is what I thought originally but the following results 
(from original mail) undermine that:

When I replace &lt;Location /&gt; with &lt;Location /x&gt;

Then

   /x -&gt; (/x) = 1 request
   /xx -&gt; not processed by handler
   /x/y -&gt; (/x/y) = 1 request
   /x/x/y -&gt; (/x/y, /x/x/y) = 2 requests

If apache really were checking every part of the hierarchy why don't we 
have:

/x/y -&gt; (/y, /x/y)?

One answer might be that apache does go through every subdirectory and 
then matches against Location command so we would have:

/y -&gt; Location /x -&gt; no match
/x/y -&gt; Location /x -&gt; match

Under this hypothesis one should have /x/y/x -&gt; (/x, /x/y/x).

However a quick check with /x/y/x shows this is not the case (this is 
also seen in the second example i give) since /x/y/x produces only one 
request (i.e. /x/y/x -&gt; (/x/y/x)).

The second, more complex, LocationMatch testing in my original mail was 
an attempt to explore this further. What it means is that the best 
hypothesis I can come up with is:

1. Apache breaks a url up from top down so /x/y/z -&gt; /z, /y/z, /x/y/z
2. Apache then matches each of these against the location directive. 
HOWEVER it must have some kind of rule where it first matches from the 
right end of that list and once it enconters a failure to match it halts.
3. Apache then generates authen requests etc

Item 2 is rather confusing since it definitely seems the authenhandler 
gets urls in the order given yet apache must process from complete url 
down to smallest fragment (how else do we explain that /x/y/x only 
generates one request?)

&gt;<i> What happens if you set &quot;AllowOverride None&quot;?
</I>&gt;<i> Note that AllowOverride is only available in a &lt;Directory&gt; section. 
</I>
I have augmented my apache config to be:

   &lt;Directory /&gt;
     AllowOverride None
   &lt;/Directory&gt;
   &lt;Location /x&gt;
       AuthType Basic
       AuthName &quot;Restricted Area&quot;
       Require valid-user
   &lt;/Location&gt;

And have also replaced / in Directory with document root but it makes no 
difference that I can see.

Regards,

Tristan
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019189.html">[mod_python] multiple requests to authenhandler for a single url
</A></li>
	<LI>Next message: <A HREF="019197.html">[mod_python] multiple requests to authenhandler for a single url
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19190">[ date ]</a>
              <a href="thread.html#19190">[ thread ]</a>
              <a href="subject.html#19190">[ subject ]</a>
              <a href="author.html#19190">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
