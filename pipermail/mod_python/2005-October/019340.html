<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] The DOs and DONTs of mod_python: second problem
	maybecornered.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20The%20DOs%20and%20DONTs%20of%20mod_python%3A%20second%20problem%0A%09maybecornered.&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019341.html">
   <LINK REL="Next"  HREF="019342.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] The DOs and DONTs of mod_python: second problem
	maybecornered.</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20The%20DOs%20and%20DONTs%20of%20mod_python%3A%20second%20problem%0A%09maybecornered.&In-Reply-To="
       TITLE="[mod_python] The DOs and DONTs of mod_python: second problem
	maybecornered.">grahamd at dscpl.com.au
       </A><BR>
    <I>Tue Oct 18 21:33:44 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="019341.html">[mod_python] The DOs and DONTs of mod_python: one problem found
</A></li>
        <LI>Next message: <A HREF="019342.html">[mod_python] The DOs and DONTs of mod_python: second problem
	maybecornered.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19340">[ date ]</a>
              <a href="thread.html#19340">[ thread ]</a>
              <a href="subject.html#19340">[ subject ]</a>
              <a href="author.html#19340">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Philippe C. Martin wrote ..
&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> I'm not sure that's enough info:
</I>&gt;<i> 
</I>&gt;<i> Just for my knowledge, why would that have an effect in apache and not
</I>&gt;<i> the 
</I>&gt;<i> command line ?
</I>
Imagine if each version of expat used a slightly different structure
layout or structure size for something. An object created in the code of
the shared library when accessed by C code compiled against the library,
but that of a different version, could access the wrong bit of the
object and thus follow a bogus pointer and thus crash.

Consider this platform I have access to:

cinderella$ python
Python 2.3.4 (#1, Nov 25 2004, 17:05:37) 
[GCC 3.3.2] on sunos5
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt;<i> import pyexpat
</I>&gt;&gt;&gt;<i> pyexpat.version_info
</I>(1, 95, 7)
&gt;&gt;&gt;<i> ^D
</I>cinderella$ cd /usr/local/lib
cinderella$ strings libexpat.so | grep expat_
expat_1.95.4

The libexpat.so installed on the system has an older version than that
compiled into Python. If something causes the libexpat.so to be linked
into Apache at the same time as the Python code executing from
mod_python is using the embedded one, if there is an incompatability,
there may be a problem.

In this case, I should be looking at upgrading the one installed in the
operating system.

Depending on your system the libexpat.so might be in /lib, /usr/lib,
/usr/local/lib or elsewhere.

Graham

&gt;<i> [<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">philippe at pcmsc</A> philippe]$ python
</I>&gt;<i> Python 2.4.2 (#1, Oct 18 2005, 04:32:14)
</I>&gt;<i> [GCC 3.4.1 (Mandrakelinux 10.1 3.4.1-4mdk)] on linux2
</I>&gt;<i> Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
</I>&gt;<i> &gt;&gt;&gt; import pyexpat
</I>&gt;<i> &gt;&gt;&gt; pyexpat.version_info
</I>&gt;<i> (1, 95, 8)
</I>&gt;<i> &gt;&gt;&gt; import expat
</I>&gt;<i> Traceback (most recent call last):
</I>&gt;<i>   File &quot;&lt;stdin&gt;&quot;, line 1, in ?
</I>&gt;<i> ImportError: No module named expat
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> [<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">philippe at pcmsc</A> SC]$ find /usr/lib/python2.4/ -name '*expat*' -exec ls
</I>&gt;<i> -l {} 
</I>&gt;<i> \;
</I>&gt;<i> -rw-r--r--  1 root root 2586 Oct 18 
</I>&gt;<i> 04:35 /usr/lib/python2.4/test/output/test_pyexpat
</I>&gt;<i> -rw-r--r--  1 root root 12012 Oct 18 
</I>&gt;<i> 04:35 /usr/lib/python2.4/test/test_pyexpat.py
</I>&gt;<i> -rw-r--r--  1 root root 11514 Oct 18 
</I>&gt;<i> 04:36 /usr/lib/python2.4/test/test_pyexpat.pyc
</I>&gt;<i> -rw-r--r--  1 root root 11514 Oct 18 
</I>&gt;<i> 04:36 /usr/lib/python2.4/test/test_pyexpat.pyo
</I>&gt;<i> -rw-r--r--  1 root root 36379 Oct 18 
</I>&gt;<i> 04:35 /usr/lib/python2.4/xml/dom/expatbuilder.py
</I>&gt;<i> -rw-r--r--  1 root root 31084 Oct 18 
</I>&gt;<i> 04:36 /usr/lib/python2.4/xml/dom/expatbuilder.pyc
</I>&gt;<i> -rw-r--r--  1 root root 30453 Oct 18 
</I>&gt;<i> 04:36 /usr/lib/python2.4/xml/dom/expatbuilder.pyo
</I>&gt;<i> -rw-r--r--  1 root root 112 Oct 18 
</I>&gt;<i> 04:35 /usr/lib/python2.4/xml/parsers/expat.py
</I>&gt;<i> -rw-r--r--  1 root root 273 Oct 18 
</I>&gt;<i> 04:36 /usr/lib/python2.4/xml/parsers/expat.pyc
</I>&gt;<i> -rw-r--r--  1 root root 273 Oct 18 
</I>&gt;<i> 04:36 /usr/lib/python2.4/xml/parsers/expat.pyo
</I>&gt;<i> -rw-r--r--  1 root root 14408 Oct 18 
</I>&gt;<i> 04:35 /usr/lib/python2.4/xml/sax/expatreader.py
</I>&gt;<i> -rw-r--r--  1 root root 13471 Oct 18 
</I>&gt;<i> 04:36 /usr/lib/python2.4/xml/sax/expatreader.pyc
</I>&gt;<i> -rw-r--r--  1 root root 13471 Oct 18 
</I>&gt;<i> 04:36 /usr/lib/python2.4/xml/sax/expatreader.pyo
</I>&gt;<i> -rwxr-xr-x  1 root root 436290 Oct 18 
</I>&gt;<i> 04:33 /usr/lib/python2.4/lib-dynload/pyexpat.so
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> On Wednesday 19 October 2005 12:35 am, Graham Dumpleton wrote:
</I>&gt;<i> &gt; Philippe C. Martin wrote ..
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt; Hi,
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; If any of you wish to look at this: this code works in command line,
</I>&gt;<i> and
</I>&gt;<i> &gt; &gt; crashes with apache. Something I'm doing is really anoying minidom.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; you can fetch the xml file responsible at: www.snakecard.com/mod_python
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Any help is greatly appreciated.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I you are using a module which does XML processing and it is literally
</I>&gt;<i> &gt; crashing, look at what version of the expat libraries that are installed
</I>&gt;<i> &gt; on your system.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; A problem that can occur is that Python embeds a version of expat within
</I>&gt;<i> &gt; its pyexpat module. If an incompatible version of expat is also linked
</I>&gt;<i> &gt; in as a shared library, a crash generally occurs.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; To determine the version of expat embedded in Python, do from a command
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; line run Python:
</I>&gt;<i> &gt; &gt;&gt;&gt; import pyexpat
</I>&gt;<i> &gt; &gt;&gt;&gt; pyexpat.version_info
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; (1, 95, 6)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Ensure that the version of any expat shared library is at least newer
</I>&gt;<i> &gt; than that embedded into Python, or the same version if possible.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Graham
</I>&gt;<i> 
</I>&gt;<i> -- 
</I>&gt;<i> *************************************
</I>&gt;<i> Philippe C. Martin
</I>&gt;<i> SnakeCard, LLC
</I>&gt;<i> www.snakecard.com
</I>&gt;<i> +1 405 694 8098
</I>&gt;<i> *************************************
</I></PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019341.html">[mod_python] The DOs and DONTs of mod_python: one problem found
</A></li>
	<LI>Next message: <A HREF="019342.html">[mod_python] The DOs and DONTs of mod_python: second problem
	maybecornered.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19340">[ date ]</a>
              <a href="thread.html#19340">[ thread ]</a>
              <a href="subject.html#19340">[ subject ]</a>
              <a href="author.html#19340">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
