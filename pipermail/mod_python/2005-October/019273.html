<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] PyThreadState_Delete: tstate is still current
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20PyThreadState_Delete%3A%20tstate%20is%20still%20current&In-Reply-To=bb84149f0510141124t230cada7tbd35f4286fe2b935%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019267.html">
   <LINK REL="Next"  HREF="019274.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] PyThreadState_Delete: tstate is still current</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20PyThreadState_Delete%3A%20tstate%20is%20still%20current&In-Reply-To=bb84149f0510141124t230cada7tbd35f4286fe2b935%40mail.gmail.com"
       TITLE="[mod_python] PyThreadState_Delete: tstate is still current">grahamd at dscpl.com.au
       </A><BR>
    <I>Fri Oct 14 21:35:42 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="019267.html">[mod_python] PyThreadState_Delete: tstate is still current
</A></li>
        <LI>Next message: <A HREF="019274.html">[mod_python] PyThreadState_Delete: tstate is still current
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19273">[ date ]</a>
              <a href="thread.html#19273">[ thread ]</a>
              <a href="subject.html#19273">[ subject ]</a>
              <a href="author.html#19273">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Most strange. Good news is that have managed to get onto a Linux system
and build up non threaded Python and duplicate it.

[Fri Oct 14 21:30:31 2005] [notice] Apache/2.0.55 (Unix) 
mod_python/3.2.0b Python/2.3.5 configured -- resuming normal 
operations[Fri Oct 14 21:30:32 2005] [error] make_obcallback: could not 
call init.\n
TypeError: init() takes no arguments (2 given)Fatal Python error: 
PyThreadState_Delete: tstate is still current
[Fri Oct 14 21:30:32 2005] [notice] child pid 609 exit signal Aborted 
(6)[Fri Oct 14 21:30:43 2005] [error] make_obcallback: could not call 
init.\n
TypeError: init() takes no arguments (2 given)Fatal Python error: 
PyThreadState_Delete: tstate is still current
[Fri Oct 14 21:30:44 2005] [error] make_obcallback: could not call 
init.\nTypeError: init() takes no arguments (2 given)
Fatal Python error: PyThreadState_Delete: tstate is still current[Fri 
Oct 14 21:30:44 2005] [notice] child pid 610 exit signal Aborted (6)
[Fri Oct 14 21:30:44 2005] [notice] child pid 611 exit signal Aborted 
(6)

More later when I work out why it is happening. :-)

Graham

On 15/10/2005, at 4:24 AM, Peter Sanchez wrote:

&gt;<i> Sorry for the late reply, got busy yesterday.
</I>&gt;<i>
</I>&gt;<i>  I did as you suggested, and it errors when trying to start apache 
</I>&gt;<i> (unable to load mod_python.so), so it has to be the right module.
</I>&gt;<i>
</I>&gt;<i>  So, now I put it back to the 3.1.4 version again, and I thought the 
</I>&gt;<i> entire pages were loading, but when I load pages with a lot more data, 
</I>&gt;<i> I realize that they aren't loading in whole. So I am still trying to 
</I>&gt;<i> figure out why it is crashing.
</I>&gt;<i>
</I>&gt;<i>  Is there any way to trace the mod_python process, not sure if this 
</I>&gt;<i> would even help.
</I>&gt;<i>
</I>&gt;<i>  Thanks guys,
</I>&gt;<i>
</I>&gt;<i>  Peter
</I>&gt;<i>
</I>&gt;<i> On 10/12/05, Graham Dumpleton &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">grahamd at dscpl.com.au</A>&gt; wrote:
</I>&gt;&gt;<i> If it truly is picking up this file, it should fail to find it. If 
</I>&gt;&gt;<i> not and
</I>&gt;&gt;<i> you still get the error, there must be another copy somewhere
</I>&gt;&gt;<i> which is being found.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Sorry, if this seems like I don't trust what you say, but the error
</I>&gt;&gt;<i> really suggests that an old version is being used and this will at
</I>&gt;&gt;<i> least try and confirm whether your new one is being used or not.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  Other things to check are that there aren't two LoadModule lines in
</I>&gt;&gt;<i> Apache config file for mod_python.so where each grabs it from a
</I>&gt;&gt;<i> different location. A long shot would be that mod_python.so is
</I>&gt;&gt;<i> somehow statically compiled into Apache.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Graham
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Peter Sanchez wrote ..
</I>&gt;&gt;<i> &gt; OK, I checked on the mod_python.so, the time stamp is the same as 
</I>&gt;&gt;<i> the
</I>&gt;&gt;<i> &gt; mod_python .py files in the python site-packages directory 
</I>&gt;&gt;<i> (remember I
</I>&gt;&gt;<i> &gt; just reinstalled them tonight)
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Also, if I do a 'strings mod_python.so | grep 3' I get 
</I>&gt;&gt;<i> &quot;mod_python/3.2.2&quot;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; so I am assuming it is the correct one.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Any other ideas?
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Thanks!!
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Peter
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; On 10/12/05, Graham Dumpleton &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">grahamd at dscpl.com.au</A>&gt; wrote:
</I>&gt;&gt;<i> &gt; &gt; The mod_python.so in your Apache modules directory, or wherever it
</I>&gt;&gt;<i>  &gt; &gt; is picking it up from, appears to still be that for mod_python 
</I>&gt;&gt;<i> 2.7.X.
</I>&gt;&gt;<i> &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; Thus, find LoadModule instruction for mod_python in Apache config
</I>&gt;&gt;<i> &gt; &gt; and work out where it is loading it from. Ensure that that module 
</I>&gt;&gt;<i> is
</I>&gt;&gt;<i> &gt; &gt; that for mod_python 3.2.
</I>&gt;&gt;<i> &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; Graham
</I>&gt;&gt;<i> &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; Peter Sanchez wrote ..
</I>&gt;&gt;<i> &gt; &gt; &gt; Maybe I am not understanding what you are saying...
</I>&gt;&gt;<i> &gt; &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; So I just deinstalled mod_python completely, verified that the
</I>&gt;&gt;<i> &gt; &gt; &gt; directory /usr/local/lib/python2.4/site-packages/mod_python 
</I>&gt;&gt;<i> directory
</I>&gt;&gt;<i> &gt; &gt; &gt; was gone. I reinstalled and the directory was there with all 
</I>&gt;&gt;<i> the other
</I>&gt;&gt;<i> &gt; &gt; &gt; files included (apache.py , etc.)
</I>&gt;&gt;<i> &gt; &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; The same problem exists. Is it an Apache compilation issue?
</I>&gt;&gt;<i> &gt; &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; Sorry if I am being slow on this issue...
</I>&gt;&gt;<i> &gt; &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; Thanks,
</I>&gt;&gt;<i> &gt; &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; Peter
</I>&gt;&gt;<i> &gt; &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; On 10/12/05, Graham Dumpleton &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">grahamd at dscpl.com.au</A>&gt; wrote:
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; Now I am even more blind. I got that the wrong way around. You
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; have the 3.2 mod_python.apache module, but the Apache module
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; is still that for 2.7. Ie., only mod_python Apache module for 
</I>&gt;&gt;<i> 2.7
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; would be attempting to call init() with 0 arguments where 2 is
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; expected.
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; This would explain why thread state problem is still there as 
</I>&gt;&gt;<i> Apache
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; module hasn't changed.
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;&gt;<i>  &gt; &gt; &gt; &gt; Blame Apple for this, trying to read up on the new video 
</I>&gt;&gt;<i> iPod and
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; it is distracting my thoughts. :-)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; Graham
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;&gt;<i>  &gt; &gt; &gt; &gt; On 13/10/2005, at 8:04 AM, Graham Dumpleton wrote:
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt; Okay, I am blind. Unfortunate that the thread state problem 
</I>&gt;&gt;<i> didn't
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt; go away, but only just noticed in the error messages the 
</I>&gt;&gt;<i> init()
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt; call argument mismatch.
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt; The problem you are having is that the Apache module is for
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt; mod_python 3.2, but it is still finding the Python modules, 
</I>&gt;&gt;<i> ie.,
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt; the mod_python.apache module, from your old mod_python 2.7
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt; installation.
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt; In 2.7, init() took no arguments. In 3.2 it takes two 
</I>&gt;&gt;<i> arguments.
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt; Sorry, didn't notice that before. Thus, get rid of the 
</I>&gt;&gt;<i> mod_python
</I>&gt;&gt;<i> &gt; 2.7
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt; Python modules and ensure 3.2 versions are installed 
</I>&gt;&gt;<i> correctly.
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt; Still think something isn't right with the thread state 
</I>&gt;&gt;<i> deletion
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt; code. Are you absolutely sure that your newly compiled 
</I>&gt;&gt;<i> Apache
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt; module is being used?
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt; Graham
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt; On 12/10/2005, at 9:33 AM, Peter Sanchez wrote:
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; Well, I did the patches you suggested, and it didn't help 
</I>&gt;&gt;<i> much.
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; Here is the log snippet:
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; [Tue Oct 11 16:17:07 2005] [notice] Apache/2.0.54 
</I>&gt;&gt;<i> (FreeBSD) PHP/
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; 4.4.0 mod_python/3.2.0b Python/2.4.1 configured -- 
</I>&gt;&gt;<i> resuming normal
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; operati
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; ons
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; [Tue Oct 11 16:17:07 2005] [notice] child pid 71664 exit 
</I>&gt;&gt;<i> signal
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; Abort trap (6)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; [Tue Oct 11 16:17:07 2005] [notice] child pid 71663 exit 
</I>&gt;&gt;<i> signal
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; Abort trap (6)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; [Tue Oct 11 16:17:07 2005] [notice] child pid 71660 exit 
</I>&gt;&gt;<i> signal
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; Abort trap (6)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; [Tue Oct 11 16:17:07 2005] [notice] child pid 71654 exit 
</I>&gt;&gt;<i> signal
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; Abort trap (6)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; [Tue Oct 11 16:17:07 2005] [notice] child pid 71640 exit 
</I>&gt;&gt;<i> signal
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; Abort trap (6)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; [Tue Oct 11 16:17:07 2005] [notice] child pid 71634 exit 
</I>&gt;&gt;<i> signal
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; Abort trap (6)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; [Tue Oct 11 16:17:07 2005] [notice] child pid 71624 exit 
</I>&gt;&gt;<i> signal
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; Abort trap (6)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; [Tue Oct 11 16:17:07 2005] [notice] child pid 69509 exit 
</I>&gt;&gt;<i> signal
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; Abort trap (6)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; [Tue Oct 11 16:17:07 2005] [notice] child pid 69490 exit 
</I>&gt;&gt;<i> signal
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; Abort trap (6)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; [Tue Oct 11 16:17:07 2005] [notice] child pid 69470 exit 
</I>&gt;&gt;<i> signal
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; Abort trap (6)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; [Tue Oct 11 16:17:07 2005] [notice] child pid 69437 exit 
</I>&gt;&gt;<i> signal
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; Abort trap (6)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; [Tue Oct 11 16:17:07 2005] [error] make_obcallback: could 
</I>&gt;&gt;<i> not
</I>&gt;&gt;<i> &gt; call
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; init.\n
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; TypeError: init() takes exactly 2 arguments (0 given)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; Fatal Python error: PyThreadState_Delete: tstate is still 
</I>&gt;&gt;<i> current
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; [Tue Oct 11 16:17:08 2005] [notice] child pid 71632 exit 
</I>&gt;&gt;<i> signal
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; Abort trap (6)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; [Tue Oct 11 16:17:09 2005] [error] make_obcallback: could 
</I>&gt;&gt;<i> not
</I>&gt;&gt;<i> &gt; call
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; init.\n
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; TypeError: init() takes exactly 2 arguments (0 given)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; Over and over again ;) I went back to 3.1.4, since I am 
</I>&gt;&gt;<i> testing
</I>&gt;&gt;<i> &gt; on
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; a live server (no other choice unfortunately.)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; I also tried writing a basic function that does nothing but
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; display a session id, no other modules included and it 
</I>&gt;&gt;<i> gave the
</I>&gt;&gt;<i>  &gt; &gt; &gt; &gt; &gt;&gt; same results. You guys probably knew that was the case, 
</I>&gt;&gt;<i> but just
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; an FYI.
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; Thanks again,
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; Peter
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; On 10/11/05, Graham Dumpleton &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">grahamd at dscpl.com.au</A>&gt; 
</I>&gt;&gt;<i> wrote: Making
</I>&gt;&gt;<i>  &gt; &gt; &gt; &gt; &gt;&gt; an educated guess (???), in src/mod_python.c, can you 
</I>&gt;&gt;<i> modify the
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; release_interpreter() function and change:
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; static void release_interpreter(void)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; {
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt;&#160;&#160;&#160;&#160; PyThreadState *tstate = PyThreadState_Get();
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; #ifdef WITH_THREAD
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt;&#160;&#160;&#160;&#160; PyEval_ReleaseThread(tstate);
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; #endif
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt;&#160;&#160;&#160;&#160; PyThreadState_Delete(tstate);
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; }
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; to:
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; static void release_interpreter(void)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; {
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt;&#160;&#160;&#160;&#160; PyThreadState *tstate = PyThreadState_Get();
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; #ifdef WITH_THREAD
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt;&#160;&#160;&#160;&#160; PyEval_ReleaseThread(tstate);
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; #else
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt;&#160;&#160;&#160;&#160; PyThreadState_Swap(NULL);
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; #endif
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt;&#160;&#160;&#160;&#160; PyThreadState_Delete(tstate);
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; }
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; The original doesn't seem quite right to me because it 
</I>&gt;&gt;<i> wouldn't
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; revert
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; the thread state before deleting it when threads aren't 
</I>&gt;&gt;<i> used.
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; There is a
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; similar bit of code in get_interpreter() where it has:
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; if (!idata-&gt;obcallback)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; #ifdef WITH_THREAD
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; PyEval_ReleaseThread(tstate);
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; #endif&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 
</I>&gt;&gt;<i> PyThreadState_Delete(tstate);
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; which perhaps should be:
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; if (!idata-&gt;obcallback)
</I>&gt;&gt;<i>  &gt; &gt; &gt; &gt; &gt;&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; #ifdef WITH_THREAD
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; PyEval_ReleaseThread(tstate);
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; #else
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; PyThreadState_Swap(NULL);
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; #endif
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; PyThreadState_Delete(tstate);
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; In this case it only gets invoked when mod_python callback 
</I>&gt;&gt;<i> can't
</I>&gt;&gt;<i> &gt; be
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; created.
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; If this is indeed the problem, in mod_python 3.1.3, the 
</I>&gt;&gt;<i> callback
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; may be
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; created okay so it only dies in release_interpreter(). In
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; mod_python 3.2
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; though, maybe the callback creation itself is failing 
</I>&gt;&gt;<i> meaning
</I>&gt;&gt;<i> &gt; it
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; would
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; die everytime a child process is created.
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; If someone has the time and a non BSD platform could you
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; independently
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; build a version of Python without thread support and then 
</I>&gt;&gt;<i> build
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; mod_python 3.2 and see if you get similar crashes. Ie., I 
</I>&gt;&gt;<i> feel
</I>&gt;&gt;<i> &gt; this
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; could be wrong for no threads and not be BSD specific. 
</I>&gt;&gt;<i> From what
</I>&gt;&gt;<i> &gt; I
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; have
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; seen, FreeBSD is the only platform that still doesn't 
</I>&gt;&gt;<i> build in
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; threads
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; to Python by default and thus why it isn't seen more. I 
</I>&gt;&gt;<i> can't
</I>&gt;&gt;<i> &gt; do it
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; personally as have MacOS X and one has to be careful with 
</I>&gt;&gt;<i> multiple
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; Python installations there in case one trashes system one
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; accidentally.
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; Would rather not risk it. :-)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; Graham
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; Peter Sanchez wrote ..
</I>&gt;&gt;<i>  &gt; &gt; &gt; &gt; &gt;&gt; &gt; Thanks for the reference. I tried adding the following 
</I>&gt;&gt;<i> line,
</I>&gt;&gt;<i> &gt; no
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; real help.
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; So I rebuilt apache2 and mod_python and made sure it 
</I>&gt;&gt;<i> didn't
</I>&gt;&gt;<i> &gt; have
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; threads
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; support. Now, I still get the same error message, but 
</I>&gt;&gt;<i> the entire
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; page is
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; loading correctly?
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; Same log entries though:
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; Fatal Python error: PyThreadState_Delete: tstate is 
</I>&gt;&gt;<i> still current
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; [Tue Oct 11 13:05:15 2005] [notice] child pid 256 exit 
</I>&gt;&gt;<i> signal
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; Abort trap
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; (6)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt;
</I>&gt;&gt;<i>  &gt; &gt; &gt; &gt; &gt;&gt; &gt; I am wondering if at this point, its not related to 
</I>&gt;&gt;<i> Cheetah
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; Template engine,
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; which I use for my templates (will be converting to psp 
</I>&gt;&gt;<i> template
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; system
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; very
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; soon) I am not sure if that attempts any threaded 
</I>&gt;&gt;<i> functions,
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; etc. Also,
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; I
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; dont know that if it was trying something like that, if 
</I>&gt;&gt;<i> it would
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; effect
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; mod_python in this way.
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; Is there any traces I can run, etc. to help debug this 
</I>&gt;&gt;<i> issue?
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; Thanks,
</I>&gt;&gt;<i>  &gt; &gt; &gt; &gt; &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; Peter
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; On 10/11/05, Jim Gallacher &lt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">jg.lists at sympatico.ca</A>&gt; 
</I>&gt;&gt;<i> wrote:
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; Peter Sanchez wrote:
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; OK, I tried 3.2.2b from source. Now, when I start 
</I>&gt;&gt;<i> apache,
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; the logs
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; just
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; go into a loop with the same errors as before :)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; [Tue Oct 11 10:26:14 2005] [notice] Apache/2.0.54 
</I>&gt;&gt;<i> (FreeBSD)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; PHP/4.4.0
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; mod_python/3.2.0b Python/2.4.1 configured -- 
</I>&gt;&gt;<i> resuming normal
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; operations
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; [Tue Oct 11 10:26:14 2005] [notice] child pid 26791 
</I>&gt;&gt;<i> exit
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; signal Abort
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; trap (6)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; [Tue Oct 11 10:26:14 2005] [notice] child pid 26318 
</I>&gt;&gt;<i> exit
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; signal Abort
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; trap (6)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; [Tue Oct 11 10:26:14 2005] [notice] child pid 26317 
</I>&gt;&gt;<i> exit
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; signal Abort
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; trap (6)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; [Tue Oct 11 10:26:14 2005] [notice] child pid 24178 
</I>&gt;&gt;<i> exit
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; signal Abort
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; trap (6)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; [Tue Oct 11 10:26:14 2005] [notice] child pid 24162 
</I>&gt;&gt;<i> exit
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; signal Abort
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; trap (6)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; [Tue Oct 11 10:26:14 2005] [notice] child pid 24148 
</I>&gt;&gt;<i> exit
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; signal Abort
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; trap (6)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; [Tue Oct 11 10:26:14 2005] [notice] child pid 24133 
</I>&gt;&gt;<i> exit
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; signal Abort
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; trap (6)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; [Tue Oct 11 10:26:14 2005] [notice] child pid 24122 
</I>&gt;&gt;<i> exit
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; signal Abort
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; trap (6)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; [Tue Oct 11 10:26:14 2005] [notice] child pid 24050 
</I>&gt;&gt;<i> exit
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; signal Abort
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; trap (6)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; [Tue Oct 11 10:26:14 2005] [notice] child pid 24033 
</I>&gt;&gt;<i> exit
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; signal Abort
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; trap (6)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; [Tue Oct 11 10:26:14 2005] [notice] child pid 23318 
</I>&gt;&gt;<i> exit
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; signal Abort
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; trap (6)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; [Tue Oct 11 10:26:14 2005] [notice] child pid 23285 
</I>&gt;&gt;<i> exit
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; signal Abort
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; trap (6)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; [Tue Oct 11 10:26:14 2005] [notice] child pid 23266 
</I>&gt;&gt;<i> exit
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; signal Abort
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; trap (6)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; [Tue Oct 11 10:26:14 2005] [notice] child pid 23195 
</I>&gt;&gt;<i> exit
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; signal Abort
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; trap (6)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; [Tue Oct 11 10:26:14 2005] [error] make_obcallback: 
</I>&gt;&gt;<i> could
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; not call
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; init.\n
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; TypeError: init() takes exactly 2 arguments (0 given)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; Fatal Python error: PyThreadState_Delete: tstate is 
</I>&gt;&gt;<i> still
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; current
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; [Tue Oct 11 10:26:14 2005] [error] make_obcallback: 
</I>&gt;&gt;<i> could
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; not call
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; init.\n
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; TypeError: init() takes exactly 2 arguments (0 given)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; Fatal Python error: PyThreadState_Delete: tstate is 
</I>&gt;&gt;<i> still
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; current
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; Note, these were being given while NOT loading my 
</I>&gt;&gt;<i> mod_python
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; code,
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; I
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; think it was doing this for every 'normal' apache 
</I>&gt;&gt;<i> instance.
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; I quickly
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; reverted back to the last setup (mod_pyton/3.1.4)
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; Any other ideas guys?
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; Thanks,
</I>&gt;&gt;<i>  &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt; Peter
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; This sounds like the problem I was having trying to 
</I>&gt;&gt;<i> get the
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; 3.2.2b unit
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; tests to pass on FreeBSD. This was discussed on the 
</I>&gt;&gt;<i> python-dev
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; list
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; around Sept 10.
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; You can read the archive on gmane at
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; 
</I>&gt;&gt;<i> <A HREF="http://comments.gmane.org/gmane.comp.apache.mod-python.devel/1465">http://comments.gmane.org/gmane.comp.apache.mod-python.devel/1465</A>
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; Grisha suggested you can see this sort of problem on 
</I>&gt;&gt;<i> FreeBSD
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; where
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; Python is threaded and Apache is not and offered the 
</I>&gt;&gt;<i> following:
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; If you built apache without thread support, you may 
</I>&gt;&gt;<i> need to
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; add the
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; following lines to $PREFIX/sbin/envvars:
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; LD_PRELOAD=/usr/lib/libc_r.so
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; export LD_PRELOAD
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; Regards,
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt; Jim
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt; &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;&gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt; _______________________________________________
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt; Mod_python mailing list
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt;
</I>

</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019267.html">[mod_python] PyThreadState_Delete: tstate is still current
</A></li>
	<LI>Next message: <A HREF="019274.html">[mod_python] PyThreadState_Delete: tstate is still current
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19273">[ date ]</a>
              <a href="thread.html#19273">[ thread ]</a>
              <a href="subject.html#19273">[ subject ]</a>
              <a href="author.html#19273">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
