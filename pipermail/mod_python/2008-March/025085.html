<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] patch to use Py_SetProgramName()
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20patch%20to%20use%20Py_SetProgramName%28%29&In-Reply-To=20080327145705.GA16811%40swri.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025082.html">
   <LINK REL="Next"  HREF="025088.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] patch to use Py_SetProgramName()</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20patch%20to%20use%20Py_SetProgramName%28%29&In-Reply-To=20080327145705.GA16811%40swri.org"
       TITLE="[mod_python] patch to use Py_SetProgramName()">graham.dumpleton at gmail.com
       </A><BR>
    <I>Fri Mar 28 00:41:54 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="025082.html">[mod_python] patch to use Py_SetProgramName()
</A></li>
        <LI>Next message: <A HREF="025088.html">[mod_python] patch to use Py_SetProgramName()
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25085">[ date ]</a>
              <a href="thread.html#25085">[ thread ]</a>
              <a href="subject.html#25085">[ subject ]</a>
              <a href="author.html#25085">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 28/03/2008, Glen W. Mabey &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Glen.Mabey at swri.org</A>&gt; wrote:
&gt;<i> On Wed, Mar 26, 2008 at 03:51:58PM -0500, Graham Dumpleton wrote:
</I>&gt;<i>  &gt; Even if it fixes things on some platforms, the problem I have with it
</I>&gt;<i>  &gt; is that it hard codes a path into the executable. If the 'python'
</I>&gt;<i>  &gt; executable supplied to --with-python was actually a symlink to another
</I>&gt;<i>  &gt; location, the result will be an incorrect location is used as you
</I>&gt;<i>  &gt; really want the location pointed at, not where the symlink was.
</I>&gt;<i>  &gt; Another problem might be where people building binary distributions of
</I>&gt;<i>  &gt; mod_python use some special Python installation not in the standard
</I>&gt;<i>  &gt; location. It may work for them when they test it, but when they
</I>&gt;<i>  &gt; release it it then make break for others because they may not have
</I>&gt;<i>  &gt; Python installed where person who built it did.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> My impression from the description of the Py_SetProgramName() function
</I>&gt;<i>  was that it provided not so much of a hard-coding to the path but rather
</I>&gt;<i>  steering the search for the executable to first look at a specific
</I>&gt;<i>  location before looking in other likely places.
</I>
You are probably right, been a while since I looked at Python
internals for that stuff.

&gt;<i>  Has that been your experience in using Py_SetProgramName()?
</I>
What I do know is the code in Python internals which uses that value
and others such as PYTHONHOME is really convoluted, especially when it
comes to Windows and MacOS X where I never did quite work out where it
finds some stuff for determining prefix location.

&gt;<i>  &gt; What was found with mod_wsgi was that it was better to have a
</I>&gt;<i>  &gt; directive in Apache configuration file which allowed one to set
</I>&gt;<i>  &gt; PYTHONHOME.
</I>&gt;<i>
</I>&gt;<i> Apparently, the use of PYTHONHOME would still override the value given
</I>&gt;<i>  to Py_SetProgramName(), so it doesn't seem to me that you would lose any
</I>&gt;<i>  flexibility by its use.
</I>
I'll give it some more thought, setting it may not be such a big deal,
I was perhaps just being overly cautious as I wanted something that
would work cross platform.

What I definitely don't want to do again is expose a
WSGIPythonExecutable directive as it just caused confusion as people
were using it for virtual environments when they should have been
using WSGIPythonHome. It became an issue because people were blogging
examples using WSGIPythonExecutable but then it wouldn't work on
Windows or MacOS X.

Graham

&gt;<i>  &gt; This still didn't work for Windows, but seemed the best
</I>&gt;<i>  &gt; compromise. One benefit of making it configurable through the Apache
</I>&gt;<i>  &gt; configuration file was that that mechanism could then be used to point
</I>&gt;<i>  &gt; the interpreter at a Python virtual environment isolated from
</I>&gt;<i>  &gt; site-packages of standard Python installation. For details on this
</I>&gt;<i>  &gt; see:
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt;   <A HREF="http://code.google.com/p/modwsgi/wiki/VirtualEnvironments">http://code.google.com/p/modwsgi/wiki/VirtualEnvironments</A>
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt; You might also read section 'Multiple Python Versions' of:
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt;   <A HREF="http://code.google.com/p/modwsgi/wiki/InstallationIssues">http://code.google.com/p/modwsgi/wiki/InstallationIssues</A>
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt; which for mod_wsgi talks about the same problem with wrong version of
</I>&gt;<i>  &gt; Python being found.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> One reason for my terseness in my original post was that I couldn't see
</I>&gt;<i>  any reason (at the time) for not employing Py_SetProgramName(), since it
</I>&gt;<i>  seemed to me to be the preferred mechanism (if the executable path is
</I>&gt;<i>  known at compile time) to *correctly* specify the path for a package
</I>&gt;<i>  maintainer whose work will end up on other people's systems.  Or to give a
</I>&gt;<i>  person like myself (targeting a specialized type of installation) to use
</I>&gt;<i>  a symlink that actually points to the desired interpreter, without the
</I>&gt;<i>  need to define PYTHONHOME (that has complicated things in the past
</I>&gt;<i>  here).
</I>&gt;<i>
</I>&gt;<i>  Anyway, thank you for you attention.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  Glen Mabey
</I>&gt;<i>
</I></PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025082.html">[mod_python] patch to use Py_SetProgramName()
</A></li>
	<LI>Next message: <A HREF="025088.html">[mod_python] patch to use Py_SetProgramName()
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25085">[ date ]</a>
              <a href="thread.html#25085">[ thread ]</a>
              <a href="subject.html#25085">[ subject ]</a>
              <a href="author.html#25085">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
