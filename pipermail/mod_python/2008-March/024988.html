<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Lock-Problem with Oracle
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Lock-Problem%20with%20Oracle&In-Reply-To=196843740%40web.de">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024987.html">
   <LINK REL="Next"  HREF="024991.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Lock-Problem with Oracle</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Sean Allen</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Lock-Problem%20with%20Oracle&In-Reply-To=196843740%40web.de"
       TITLE="[mod_python] Lock-Problem with Oracle">sean at ardishealth.com
       </A><BR>
    <I>Fri Mar 14 12:06:22 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="024987.html">[mod_python] Lock-Problem with Oracle
</A></li>
        <LI>Next message: <A HREF="024991.html">[mod_python] Lock-Problem with Oracle
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24988">[ date ]</a>
              <a href="thread.html#24988">[ thread ]</a>
              <a href="subject.html#24988">[ subject ]</a>
              <a href="author.html#24988">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Mar 14, 2008, at 9:16 AM, Hartmut Fr&#246;ls wrote:

&gt;<i> Hi Group,
</I>&gt;<i>
</I>&gt;<i> I try to use mod_python to generate a browser-based GUI for a
</I>&gt;<i> small ERP-Application.
</I>&gt;<i> I use Apache 2.2, mod_python 3.3.1 and Python 2.4.4  with Oracle 9i2.
</I>&gt;<i>
</I>&gt;<i> At first I wrote a programm  like this:
</I>&gt;<i>
</I>&gt;<i> ########################################
</I>&gt;<i> import db      # my database handlers with cx_Oracle
</I>&gt;<i>
</I>&gt;<i> def index(req):
</I>&gt;<i>
</I>&gt;<i>   ...               # generate a http-page with a form
</I>&gt;<i>
</I>&gt;<i>   return http
</I>&gt;<i>
</I>&gt;<i> def GetDat(req,**data):
</I>&gt;<i>      .....
</I>&gt;<i>      db.select(...... for_update=1)
</I>&gt;<i>      .....
</I>&gt;<i>      return data
</I>&gt;<i>
</I>&gt;<i> def PutDat(req,**data):
</I>&gt;<i>      .....
</I>&gt;<i>      db.update(data)
</I>&gt;<i>      .....
</I>&gt;<i>      return succes
</I>&gt;<i>
</I>&gt;<i> #########################################
</I>&gt;<i>
</I>&gt;<i> The http-page has some AJAX-functions, which send and recieve
</I>&gt;<i> the datas the user needs or has updatet.
</I>&gt;<i>
</I>&gt;<i> The problem is, when the programm makes the update on the
</I>&gt;<i> database, it waits for the lock, because the programm has opend
</I>&gt;<i> a second cursor for the update, although the cursor-objects should
</I>&gt;<i> be global. I know, after reading many of the postings in this group  
</I>&gt;<i> and all over
</I>&gt;<i> the web, that this is because mod_python opens a new request for
</I>&gt;<i> the call of the PutDat() function and this new interpreter-instance of
</I>&gt;<i> this request has its own global vars.
</I>&gt;<i> So I come to my question: is there any way to tell mod_python, that  
</I>&gt;<i> the
</I>&gt;<i> AJAX-request from the http-page must go to the interpreter-instance,
</I>&gt;<i> that has generatet the page ?  Or do You know any other solution for
</I>&gt;<i> this lock-problem ?
</I>&gt;<i>
</I>
Let me see if I follow this:

index is called
getDat is called
putDat is called via ajax.

why exactly is a lock being held after getDat?
are you locking it explicitly in getDat? if yes, when exactly would  
that lock be released?

if you are locking it, then basically you are trying to do something  
stateful via a stateless
medium which is going to cause you a large amount of trouble.

I suggest if the above is the case, you look into 'optimistic locking':

<A HREF="http://en.wikipedia.org/wiki/Optimistic_concurrency_control">http://en.wikipedia.org/wiki/Optimistic_concurrency_control</A>






</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024987.html">[mod_python] Lock-Problem with Oracle
</A></li>
	<LI>Next message: <A HREF="024991.html">[mod_python] Lock-Problem with Oracle
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24988">[ date ]</a>
              <a href="thread.html#24988">[ thread ]</a>
              <a href="subject.html#24988">[ subject ]</a>
              <a href="author.html#24988">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
