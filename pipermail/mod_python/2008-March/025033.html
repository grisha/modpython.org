<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Chaining handlers
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Chaining%20handlers&In-Reply-To=88e286470803192036r2ffd637cpadf601904c56bdc8%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025032.html">
   <LINK REL="Next"  HREF="025038.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Chaining handlers</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Chaining%20handlers&In-Reply-To=88e286470803192036r2ffd637cpadf601904c56bdc8%40mail.gmail.com"
       TITLE="[mod_python] Chaining handlers">graham.dumpleton at gmail.com
       </A><BR>
    <I>Wed Mar 19 23:51:43 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="025032.html">[mod_python] Chaining handlers
</A></li>
        <LI>Next message: <A HREF="025038.html">[mod_python] Chaining handlers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25033">[ date ]</a>
              <a href="thread.html#25033">[ thread ]</a>
              <a href="subject.html#25033">[ subject ]</a>
              <a href="author.html#25033">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Also go to <A HREF="http://books.google.com">http://books.google.com</A> and plug in search term of
'authn_cookie'. This should yield snippet of Nick Kew's book on
writing Apache modules. Read it as well as surrounding pages.

It has been a while since I read that section, so can't remember if
that is directly applicable. It may still be of interest were you to
try and write a C module or even Python auth handler to do this.

Also found mod_authn_form, but it is tied to MySQL database.

Graham

On 20/03/2008, Graham Dumpleton &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">graham.dumpleton at gmail.com</A>&gt; wrote:
&gt;<i> On 20/03/2008, David Champion &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">dgc at uchicago.edu</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;<i> &gt; &gt; The documentation does cover it, as long as you know what you are looking for.
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt; Ugh.  I guess I don't -- I still don't see it, at least expressed in
</I>&gt;<i>  &gt;  this terminology.
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt;  &gt; Before can suggest something, need to know what the criteria is that
</I>&gt;<i>  &gt;  &gt; you are wanting to block on. Are you wanting to implement HTTP basic
</I>&gt;<i>  &gt;  &gt; authorisation, ie., require user to login, or wanting to block based
</I>&gt;<i>  &gt;  &gt; on something else, such as client IP?
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt; It could be a variety of things, honestly.  Fundamentally I'm going
</I>&gt;<i>  &gt;  to ask for a username and password, but the usernames and passwords
</I>&gt;<i>  &gt;  are in flux at all times (i.e. there's no singular password file / sql
</I>&gt;<i>  &gt;  database / bdb file / whatever), and we might want to block even a
</I>&gt;<i>  &gt;  valid user/password pair based on IP or some other criterion.  I want
</I>&gt;<i>  &gt;  to be able to interact with the user in these edge cases.  I have a CGI
</I>&gt;<i>  &gt;  that does this well, so I'm trying to make a handler that uses cookies
</I>&gt;<i>  &gt;  established by the CGI to make a straightforward access decision at the
</I>&gt;<i>  &gt;  handler level so that I don't need to call out to a gateway CGI for
</I>&gt;<i>  &gt;  every request.
</I>&gt;<i>  &gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> The access, authentication and authorisation handler phases are:
</I>&gt;<i>
</I>&gt;<i>   <A HREF="http://www.modpython.org/live/current/doc-html/dir-handlers-ach.html">http://www.modpython.org/live/current/doc-html/dir-handlers-ach.html</A>
</I>&gt;<i>   <A HREF="http://www.modpython.org/live/current/doc-html/dir-handlers-auh.html">http://www.modpython.org/live/current/doc-html/dir-handlers-auh.html</A>
</I>&gt;<i>   <A HREF="http://www.modpython.org/live/current/doc-html/dir-handlers-auzh.html">http://www.modpython.org/live/current/doc-html/dir-handlers-auzh.html</A>
</I>&gt;<i>
</I>&gt;<i>  To get some context also see:
</I>&gt;<i>
</I>&gt;<i>   <A HREF="http://www.fmc-modeling.org/category/projects/apache/amp/4_4Request_Response_Loop.html">http://www.fmc-modeling.org/category/projects/apache/amp/4_4Request_Response_Loop.html</A>
</I>&gt;<i>
</I>&gt;<i>  plus other parts of same document.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  &gt;  It's also desirable in this case to use a form for the authN instead of
</I>&gt;<i>  &gt;  a browser-dependent Basic login dialog.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Although authentication phase handler is mainly used for HTTP Basic
</I>&gt;<i>  authentication, it can be adapted for use in form based login
</I>&gt;<i>  mechanism. It is a bit more tricky to do though.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  &gt;  &gt; Also, is this the only reason you are wanting to use mod_python, or do
</I>&gt;<i>  &gt;  &gt; you also have web applications that use mod_python specific APIs for
</I>&gt;<i>  &gt;  &gt; content handler? If you do have a web application, is it WSGI
</I>&gt;<i>  &gt;  &gt; compatible and thus could be hosted on any WSGI capable system?
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt; I want this to act as a single signon service for a variety of
</I>&gt;<i>  &gt;  applications, but none of them is written in python at all.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> If you only wanted HTTP Basic authentication I would then have
</I>&gt;<i>  suggested using mod_wsgi, not for its Python web hosting ability, but
</I>&gt;<i>  its Python hooks for Apache auth provider mechanism. See:
</I>&gt;<i>
</I>&gt;<i>   <A HREF="http://code.google.com/p/modwsgi/wiki/AccessControlMechanisms">http://code.google.com/p/modwsgi/wiki/AccessControlMechanisms</A>
</I>&gt;<i>
</I>&gt;<i>  Is simpler to use than writing full handlers in mod_python.
</I>&gt;<i>
</I>&gt;<i>  If you can find a separate Apache module that handles the concept of
</I>&gt;<i>  form based login but can use an Apache 2.2 auth provider, then
</I>&gt;<i>  mod_wsgi could still be used. I vaguely remember there being one that
</I>&gt;<i>  may sort of do that, but would need to go looking for it again. If can
</I>&gt;<i>  find that, then all you would need to do is provide the check password
</I>&gt;<i>  and groups hooks in Python code.
</I>&gt;<i>
</I>&gt;<i>  I'll have a look to see if I can find Apache module that does that.
</I>&gt;<i>  Would rather pursue that than try to find and resurrect code I had for
</I>&gt;<i>  doing form based login as authentication handler as right now not sure
</I>&gt;<i>  where I put it. :-)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  Graham
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  &gt;  The authentication information is available through a Python API,
</I>&gt;<i>  &gt;  so it's helpful to use Python to make the authN checks.  Other than
</I>&gt;<i>  &gt;  that I'm flexible, I guess -- there's no python-generated content
</I>&gt;<i>  &gt;  to serve.  I just have this odd user base that I need to provide my
</I>&gt;<i>  &gt;  own programmatic access to, and I don't want to do it separately for
</I>&gt;<i>  &gt;  several different applications.  I'd rather have the web server tell the
</I>&gt;<i>  &gt;  application that the user is pre-approved.  And I like Python most. :)
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt;  In the end this is not so different from any other SSO out there: detect
</I>&gt;<i>  &gt;  whether authN is required for the user, redirect to a login resource if
</I>&gt;<i>  &gt;  so, and then re-evaluate credentials upon return.  I just can't use any
</I>&gt;<i>  &gt;  existing SSOs that I know of because of where my user information is.
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt;  If there's some way I can bust it all through the *appearance* of HTTP
</I>&gt;<i>  &gt;  Basic just to get $REMOTE_USER on the application end, I can use that.
</I>&gt;<i>  &gt;  But I don't know any way to use Basic on the server without using it on
</I>&gt;<i>  &gt;  the client, unless it makes sense to make a two-pass handler that makes
</I>&gt;<i>  &gt;  an access decision first and filters incoming headers second.  But this
</I>&gt;<i>  &gt;  still leaves open how to engage CGI and PHP handlers later, so I'm not
</I>&gt;<i>  &gt;  sure it really solves the problem -- it's just another approach that
</I>&gt;<i>  &gt;  converges to the same point.
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt;  Thanks for your time.
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt;
</I>&gt;<i>  &gt;  --
</I>&gt;<i>  &gt;   -D.    <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">dgc at uchicago.edu</A>    NSIT    University of Chicago
</I>&gt;<i>  &gt;  _______________________________________________
</I>&gt;<i>  &gt;  Mod_python mailing list
</I>&gt;<i>  &gt;  <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i>  &gt;  <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i>  &gt;
</I>&gt;<i>
</I></PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025032.html">[mod_python] Chaining handlers
</A></li>
	<LI>Next message: <A HREF="025038.html">[mod_python] Chaining handlers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25033">[ date ]</a>
              <a href="thread.html#25033">[ thread ]</a>
              <a href="subject.html#25033">[ subject ]</a>
              <a href="author.html#25033">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
