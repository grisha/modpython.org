<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] util.Fieldstorage and form
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20util.Fieldstorage%20and%20form&In-Reply-To=024a01c6dd80%24422fd060%24c7010a0a%40talentica.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022114.html">
   <LINK REL="Next"  HREF="022115.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] util.Fieldstorage and form</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20util.Fieldstorage%20and%20form&In-Reply-To=024a01c6dd80%24422fd060%24c7010a0a%40talentica.com"
       TITLE="[mod_python] util.Fieldstorage and form">grahamd at dscpl.com.au
       </A><BR>
    <I>Mon Sep 25 07:36:37 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="022114.html">[mod_python] util.Fieldstorage and form
</A></li>
        <LI>Next message: <A HREF="022115.html">[mod_python] Good example site with py, psp, and structure
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22122">[ date ]</a>
              <a href="thread.html#22122">[ thread ]</a>
              <a href="subject.html#22122">[ subject ]</a>
              <a href="author.html#22122">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Your questions may in part be answered by:

   <A HREF="http://issues.apache.org/jira/browse/MODPYTHON-38">http://issues.apache.org/jira/browse/MODPYTHON-38</A>

If FieldStorage object is constructed twice, on the second time  
round, it
will only be able to provide access to form fields which are part of the
query string of the URL itself and not any field embedded as multipart
form data within the content of the POST request. This was what Jim
was getting as except that he didn't mention case where mix of query
string and multipart form parameters used.

What is not clear from your message is whether you are doing absolutely
everything within a self contained PSP page, or whether you are actually
using a wrapper around it in the form of a custom handler or a handler
such as mod_python.publisher.

If you are wrapping PSP stuff on mod_python.publisher functions, you
actually need to pass in &quot;form&quot; something like:

     settings = {}
     ...
     settings.update({&quot;form&quot;:req.form})
     template = psp.PSP(req,filename=path,vars=settings)
     template.run()

In mod_python 3.3, this will no longer be necessary as PSP has been
changed to  use req.form which may be inherited from a custom handler
which has already created it and stored it as that named attribute of  
the
request object.

Can you be clearer about whether you are using mix of query string
parameters and multipart form parameters within content of request,
and clarify whether you are using PSP only or in conjunction with
another handler.

Posting an actual small working example of what you are talking about
would be good, as then we don't need to guess.

Graham

On 21/09/2006, at 11:17 PM, sandip wrote:

&gt;<i> Thanks Jim. This explains the puzzle.
</I>&gt;<i> but form['filefield'] doesn't work for accessing file data.
</I>&gt;<i> how to use form to access file data? or Is form being implemented  
</I>&gt;<i> partially in mod_python?
</I>&gt;<i>
</I>&gt;<i> thanks
</I>&gt;<i> sandip
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ----- Original Message ----- From: &quot;Jim Gallacher&quot;  
</I>&gt;<i> &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">jpg at jgassociates.ca</A>&gt;
</I>&gt;<i> To: &quot;sandip&quot; &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">sandip.more at gmail.com</A>&gt;
</I>&gt;<i> Cc: &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mod_python at modpython.org</A>&gt;
</I>&gt;<i> Sent: Thursday, September 21, 2006 6:02 PM
</I>&gt;<i> Subject: Re: [mod_python] util.Fieldstorage and form
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> sandip wrote:
</I>&gt;&gt;&gt;<i> Hi all,
</I>&gt;&gt;&gt;<i>    Other day i was trying to build upload functionality in psp. I  
</I>&gt;&gt;&gt;<i> am handling form(method: POST) submission in psp.
</I>&gt;&gt;&gt;<i> this form contain a hidden element and  a element of type file  
</I>&gt;&gt;&gt;<i> for upload.
</I>&gt;&gt;&gt;<i> I observed certain things. When I use form['field'] to access  
</I>&gt;&gt;&gt;<i> value of hidden form element,and in same code
</I>&gt;&gt;&gt;<i> if I use FieldStorage(req) to get the attributes of uploaded  
</I>&gt;&gt;&gt;<i> file. I can't access file attributes.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> but if I use only FieldStorage to access all the elements of  
</I>&gt;&gt;&gt;<i> form, I could access it.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> so why can't I  use both form and FieldStorage in same code?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The form you see in psp is actually a FieldStorage instance which  
</I>&gt;&gt;<i> is automatically created when the psp parse encounters mention of  
</I>&gt;&gt;<i> the form variable.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> FieldStorage may only be called once per request, as it consumes  
</I>&gt;&gt;<i> the request body. Wnen it is called a second time, there is  
</I>&gt;&gt;<i> nothing left to read.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The usual solution is to store a reference to the form in your  
</I>&gt;&gt;<i> request object, and pass that around to any functions that need it.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &lt;%
</I>&gt;&gt;<i>   stuff = form['stuff']
</I>&gt;&gt;<i>   req.form = form
</I>&gt;&gt;<i> %&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> You'll then be able to access the form in code outside of the psp  
</I>&gt;&gt;<i> page.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Jim
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I></PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022114.html">[mod_python] util.Fieldstorage and form
</A></li>
	<LI>Next message: <A HREF="022115.html">[mod_python] Good example site with py, psp, and structure
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22122">[ date ]</a>
              <a href="thread.html#22122">[ thread ]</a>
              <a href="subject.html#22122">[ subject ]</a>
              <a href="author.html#22122">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
