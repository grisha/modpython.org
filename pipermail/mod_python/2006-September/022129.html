<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Segmentation fault when loading modules
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Segmentation%20fault%20when%20loading%20modules&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022128.html">
   <LINK REL="Next"  HREF="022130.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Segmentation fault when loading modules</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Segmentation%20fault%20when%20loading%20modules&In-Reply-To="
       TITLE="[mod_python] Segmentation fault when loading modules">grahamd at dscpl.com.au
       </A><BR>
    <I>Tue Sep 26 20:51:50 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="022128.html">[mod_python] Segmentation fault when loading modules
</A></li>
        <LI>Next message: <A HREF="022130.html">[mod_python] Persist database conn,
	or pers. variables - where I put them ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22129">[ date ]</a>
              <a href="thread.html#22129">[ thread ]</a>
              <a href="subject.html#22129">[ subject ]</a>
              <a href="author.html#22129">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Read:

  <A HREF="http://www.dscpl.com.au/wiki/ModPython/Articles/ExpatCausingApacheCrash">http://www.dscpl.com.au/wiki/ModPython/Articles/ExpatCausingApacheCrash</A>

This will answer all your questions and tell you what you need to do.

Graham

Siddhartha Azad wrote ..
&gt;<i> Hi,
</I>&gt;<i> I have mod_python 3.2.10 built with apache 2.2.3 on RH
</I>&gt;<i> Linux. All was working fine for me until I changed my
</I>&gt;<i> directory structure (and hence the location of the
</I>&gt;<i> python modules). After doing so I apache started
</I>&gt;<i> seg-faulting. I  debugged with gdb -X and the
</I>&gt;<i> stacktrace points (as I suspected) to some
</I>&gt;<i> module-loading code that eventually crashes in some
</I>&gt;<i> pyexpat module due to a null string.
</I>&gt;<i> 
</I>&gt;<i> When I change my directory structure to what it was
</I>&gt;<i> before, everything works perfectly.
</I>&gt;<i> 
</I>&gt;<i> 1. The directory structure that works:
</I>&gt;<i> 
</I>&gt;<i>    /dev/www/xyz.py
</I>&gt;<i>    /dev/www/modules/*.py
</I>&gt;<i> 
</I>&gt;<i>  When I invoke xyz.py from the browser (xyz.py imports
</I>&gt;<i> modules from &quot;modules.py&quot;) everything works fine (i.e.
</I>&gt;<i> when the modules sub-directory is under within the
</I>&gt;<i> same parent directory as xyz.py.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 2. The directory structure that doesn't work:
</I>&gt;<i> 
</I>&gt;<i>   /dev/www/xyz.py
</I>&gt;<i>   /dev/modules/*.py
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Notice that the modules are no longer under the &quot;www&quot;
</I>&gt;<i> directory. Also, this only happens when my PYTHONPATH
</I>&gt;<i> actually has the &quot;modules&quot; directory (otherwise of
</I>&gt;<i> course I get an error from xyz.py that the import of
</I>&gt;<i> the modules failed).
</I>&gt;<i> Please help, I have been trying to fix this for 2 days
</I>&gt;<i> now and cannot find any references anyplace else.
</I>&gt;<i> The output from the apache error log and some walkback
</I>&gt;<i> from &quot;gdb&quot; follow.
</I>&gt;<i> Thanks, Sid.
</I>&gt;<i> 
</I>&gt;<i> APACHE ERROR LOG
</I>&gt;<i> ----------------
</I>&gt;<i> 
</I>&gt;<i> [Tue Sep 26 20:12:47 2006] [notice] mod_python:
</I>&gt;<i> (Re)importing module 'mod_python.publisher'
</I>&gt;<i> [Tue Sep 26 20:12:47 2006] [notice] [client 127.0.0.1]
</I>&gt;<i> Publisher loading page /home/sid/dev/www/xyz.py
</I>&gt;<i> [Tue Sep 26 20:12:48 2006] [notice] child pid 32091
</I>&gt;<i> exit signal Segmentation fault (11)
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> WALKBACK FROM DEBUGGER
</I>&gt;<i> ----------------------
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> #0  0x40167892 in PyString_FromString (str=0x0) at
</I>&gt;<i> Objects/stringobject.c:106
</I>&gt;<i> #1  0x401b8373 in PyModule_AddStringConstant
</I>&gt;<i> (m=0x4081e0ec,
</I>&gt;<i>    name=0x4092f6ba &quot;XML_ERROR_UNBOUND_PREFIX&quot;,
</I>&gt;<i> value=0x0) at
</I>&gt;<i> Python/modsupport.c:531
</I>&gt;<i> #2  0x40913fa1 in initpyexpat () at
</I>&gt;<i> /usr/python-2.4.2/Python-2.4.2/Modules/pyexpat.c:1970
</I>&gt;<i> #3  0x401b2bad in _PyImport_LoadDynamicModule
</I>&gt;<i> (name=0xbfffadfc &quot;pyexpat&quot;,
</I>&gt;<i>    pathname=0xbfffa960
</I>&gt;<i> &quot;/usr/local/lib/python2.4/lib-dynload/pyexpat.so&quot;,
</I>&gt;<i> fp=0x8253090)
</I>&gt;<i>    at Python/importdl.c:53
</I>&gt;<i> #4  0x401af90d in load_module (name=0xbfffadfc
</I>&gt;<i> &quot;pyexpat&quot;, fp=0x8253090,
</I>&gt;<i>    buf=0xbfffa960
</I>&gt;<i> &quot;/usr/local/lib/python2.4/lib-dynload/pyexpat.so&quot;,
</I>&gt;<i> type=3, loader=0x1b)
</I>&gt;<i>    at Python/import.c:1677
</I>&gt;<i> #5  0x401b0615 in import_submodule (mod=0x40208de0,
</I>&gt;<i> subname=0xbfffadfc
</I>&gt;<i> &quot;pyexpat&quot;,
</I>&gt;<i>    fullname=0xbfffadfc &quot;pyexpat&quot;) at
</I>&gt;<i> Python/import.c:2262
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I></PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022128.html">[mod_python] Segmentation fault when loading modules
</A></li>
	<LI>Next message: <A HREF="022130.html">[mod_python] Persist database conn,
	or pers. variables - where I put them ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22129">[ date ]</a>
              <a href="thread.html#22129">[ thread ]</a>
              <a href="subject.html#22129">[ subject ]</a>
              <a href="author.html#22129">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
