<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [SPAM] [mod_python] [SPAM] modpython session under linux apache
	2.2 mpm-worker
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5BSPAM%5D%20%5Bmod_python%5D%20%5BSPAM%5D%20modpython%20session%20under%20linux%20apache%0A%092.2%20mpm-worker&In-Reply-To=79b73f2b0609010211r30a8c69ta239c2fc1296543%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021978.html">
   <LINK REL="Next"  HREF="021983.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[SPAM] [mod_python] [SPAM] modpython session under linux apache
	2.2 mpm-worker</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Jim Gallacher</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5BSPAM%5D%20%5Bmod_python%5D%20%5BSPAM%5D%20modpython%20session%20under%20linux%20apache%0A%092.2%20mpm-worker&In-Reply-To=79b73f2b0609010211r30a8c69ta239c2fc1296543%40mail.gmail.com"
       TITLE="[SPAM] [mod_python] [SPAM] modpython session under linux apache
	2.2 mpm-worker">jpg at jgassociates.ca
       </A><BR>
    <I>Fri Sep  1 08:13:10 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="021978.html">[mod_python] [SPAM] modpython session under linux apache 2.2
	mpm-worker
</A></li>
        <LI>Next message: <A HREF="021983.html">[mod_python] threads and FreeBSD: LD_PRELOAD=/usr/lib/libc_r.so the
	same as --enable-threads?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21981">[ date ]</a>
              <a href="thread.html#21981">[ thread ]</a>
              <a href="subject.html#21981">[ subject ]</a>
              <a href="author.html#21981">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>It's not immediately obvious from your code why it might hang, but I can 
tell you the session part will not work as written. When a session is 
created a corresponding cookie is set in the response header. However 
your have a req.write() call before you create your session object. The 
first req.write() will cause the headers to be sent to the client, so 
the session cookie will never be sent. Sesssion.Session() must happen 
before any req.write() call.

Jim

guo tie wrote:
&gt;<i> hi,
</I>&gt;<i>   all.
</I>&gt;<i>   i found the mod_python session under linux apache 2.2 mpm-worker have
</I>&gt;<i> problem.
</I>&gt;<i> 
</I>&gt;<i> linux: 2.6.17
</I>&gt;<i> apache: 2.2 mpm-worker
</I>&gt;<i> python: 2.4.3
</I>&gt;<i> mod_python 3.2.10
</I>&gt;<i> 
</I>&gt;<i> Now, the test.py is :
</I>&gt;<i> 
</I>&gt;<i> from mod_python import apache
</I>&gt;<i> from mod_python import Session
</I>&gt;<i> import sys
</I>&gt;<i> 
</I>&gt;<i> class Dispatcher(object):
</I>&gt;<i>    def __init__(self, req):
</I>&gt;<i>        self._req = req
</I>&gt;<i>        self._uri =  req.uri
</I>&gt;<i> 
</I>&gt;<i>    def dispatch(self, req):
</I>&gt;<i>        req.content_type =      'text/plain'
</I>&gt;<i>        import mod_python
</I>&gt;<i>        req.write(mod_python.version)
</I>&gt;<i>        req.write('\n')
</I>&gt;<i>        self.sess =     Session.Session(req)
</I>&gt;<i>        req.write(&quot;after create session\n&quot;)
</I>&gt;<i>        self.sess['obj'] =      'abcdtest'
</I>&gt;<i>        req.write(&quot;after sess['ob'] = 'abcdtest'\n&quot;)
</I>&gt;<i>        self.sess.set_timeout(60 * 60)
</I>&gt;<i>        req.write(&quot;after self.set_timeout(60 * 60)\n&quot;)
</I>&gt;<i>        self.sess.save()
</I>&gt;<i>        req.write(&quot;after sess.save()\n&quot;)
</I>&gt;<i>        req.write(self.sess['obj'])
</I>&gt;<i> 
</I>&gt;<i>        return apache.OK
</I>&gt;<i> 
</I>&gt;<i> def handler(req):
</I>&gt;<i>    mypatch =   Dispatcher(req)
</I>&gt;<i>    return mypatch.dispatch(req)
</I>&gt;<i> 
</I>&gt;<i> when i use ie or firefox visit the page, i was hanged after output
</I>&gt;<i> 3.2.10
</I>&gt;<i> 
</I>&gt;<i> i think this is the session bug with apache mpm mode, i see somebody else
</I>&gt;<i> have mentioned it .
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> ------------------------------------------------------------------------
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021978.html">[mod_python] [SPAM] modpython session under linux apache 2.2
	mpm-worker
</A></li>
	<LI>Next message: <A HREF="021983.html">[mod_python] threads and FreeBSD: LD_PRELOAD=/usr/lib/libc_r.so the
	same as --enable-threads?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21981">[ date ]</a>
              <a href="thread.html#21981">[ thread ]</a>
              <a href="subject.html#21981">[ subject ]</a>
              <a href="author.html#21981">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
