<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] mod-gnutls 'SSL_SRP_USER' and ModPython
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20mod-gnutls%20%27SSL_SRP_USER%27%20and%20ModPython&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025482.html">
   <LINK REL="Next"  HREF="025478.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] mod-gnutls 'SSL_SRP_USER' and ModPython</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Ambrose Andrews</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20mod-gnutls%20%27SSL_SRP_USER%27%20and%20ModPython&In-Reply-To="
       TITLE="[mod_python] mod-gnutls 'SSL_SRP_USER' and ModPython">ambrose-bulk at vrvl.net
       </A><BR>
    <I>Sat Jul 26 07:29:16 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="025482.html">[mod_python] Newbie question: do I need to worry about
	compilation of modules served directly by mod_python
</A></li>
        <LI>Next message: <A HREF="025478.html">[mod_python] mod-gnutls 'SSL_SRP_USER' and ModPython
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25475">[ date ]</a>
              <a href="thread.html#25475">[ thread ]</a>
              <a href="subject.html#25475">[ subject ]</a>
              <a href="author.html#25475">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>[ N.B.  i sent an identical message to the mod_gnutls list, and send it
here too now since its an issue of interaction and i don't know
precisely where the problem lies.  -AA. ]

Hi...

I run Debian 'Lenny' testing with:
Apache2 v 2.2.9
Mod-Python v 3.3.1
Mod-GnuTLS v 0.5.1

I've struck some mod-gnutls specific trouble in interaction with
modpython - see this traceback:

&quot;&quot;&quot;
MOD_PYTHON ERROR

ProcessId:      15879
Interpreter:    'CRYPTO'

ServerName:     'www.pathogens.vrvl.net'
DocumentRoot:   '/var/www/SSL_www.zed.vrvl.net/'

URI:            '/'
Location:       '/'
Directory:      None
Filename:       '/var/www/SSL_www.zed.vrvl.net/'
PathInfo:       ''

Phase:          'PythonHandler'
Handler:        'django.core.handlers.modpython'

Traceback (most recent call last):

  File &quot;/usr/lib/python2.5/site-packages/mod_python/importer.py&quot;, line
1537, in HandlerDispatch
    default=default_handler, arg=req, silent=hlist.silent)

  File &quot;/usr/lib/python2.5/site-packages/mod_python/importer.py&quot;, line
1229, in _process_target
    result = _execute_target(config, req, object, arg)

  File &quot;/usr/lib/python2.5/site-packages/mod_python/importer.py&quot;, line
1128, in _execute_target
    result = object(arg)

  File &quot;/var/lib/python-support/python2.5/django/core/handlers/modpython.py&quot;,
line 177, in handler
    return ModPythonHandler()(req)

  File &quot;/var/lib/python-support/python2.5/django/core/handlers/modpython.py&quot;,
line 137, in __call__
    os.environ.update(req.subprocess_env)

  File &quot;/usr/lib/python2.5/os.py&quot;, line 489, in update
    self[k] = dict[k]

  File &quot;/usr/lib/python2.5/os.py&quot;, line 474, in __setitem__
    putenv(key, item)

TypeError: putenv() argument 2 must be string, not None
&quot;&quot;&quot;

So to investigate, from inside a modpython script I get this output
for str(req.subprocess_env):

{
'SCRIPT_NAME': '/',
 'REQUEST_URI': '/',
 'QUERY_STRING': '',
 'REQUEST_METHOD': 'GET',
 'SERVER_PROTOCOL': 'HTTP/1.1',
 'GATEWAY_INTERFACE': 'CGI/1.1',
 'SSL_SERVER_S_AN1': 'UNSUPPORTED',
 'SSL_SERVER_S_AN0': 'DNSNAME:*.pathogens.vrvl.net',
 'SSL_SERVER_A_KEY': 'RSA',
 'SSL_SERVER_A_SIG': 'RSA-SHA',
 'SSL_SERVER_V_START': 'Jul 21 10:36:39 2008 EST',
'SSL_SERVER_V_END': 'Jul 21 10:36:39 2010 EST',
'SSL_SERVER_CERT_TYPE': 'X.509',
 'SSL_SERVER_M_VERSION': '3',
 'SSL_SERVER_M_SERIAL': '5B8F',
 'SSL_SERVER_I_DN': 'O=CAcert Inc.,OU=<A HREF="http://www.CAcert.org,CN=CAcert">http://www.CAcert.org,CN=CAcert</A>
Class 3 Root',
 'SSL_SERVER_S_DN': 'CN=*.pathogens.zed.vrvl.net',
 'SSL_SESSION_ID':
'2352784F1DDE3AA3687B3ED53D6C7055CBC3BA2F80B13B58760B9C33B9413EA2',
'SSL_CIPHER_EXPORT': 'false',
'SSL_CIPHER_ALGKEYSIZE': '256',
'SSL_CIPHER_USEKEYSIZE': '256',
 'SSL_CLIENT_VERIFY': 'NONE',
 'SSL_SRP_USER': None,
 'SSL_COMPRESS_METHOD': 'NULL',
 'SSL_CIPHER': 'DHE_RSA_AES_256_CBC_SHA1',
'SSL_PROTOCOL': 'SSL3.0',
'SSL_VERSION_INTERFACE': 'mod_gnutls/0.5.1',
'SSL_VERSION_LIBRARY': 'GnuTLS/2.2.1',
'HTTPS': 'on'
}

and was offered the following observation in the Django irc channel:

&quot;&quot;&quot;
19:47 &lt; Magus-&gt; aha
19:47 &lt; Magus-&gt; SSL_SRP_USER is being set wrong
19:48 &lt; Magus-&gt; it is None instead of a string like &quot;NONE&quot; like
SSL_CLIENT_VERIFY is set to
19:48 &lt; Magus-&gt; since you can't update environ with None as an env var value
19:51 &lt; Magus-&gt; its probably an issue in the module though, unless its
the modpython handler replacing None with 'NONE' on the other bits

&quot;&quot;&quot;

So I don't know if the problem is modpython not dealing with an exotic
environment variable it doesn't get from mod-ssl or whether it is a
mod-gnutls inconsistency.  Anyone know?


  -AA.



-- 
Ambrose Andrews
LPO box 8274 ANU Acton ACT 0200 Australia
<A HREF="http://www.vrvl.net/~ambrose/">http://www.vrvl.net/~ambrose/</A>
mailto:<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">ambrose at vrvl.net</A>
home:+61_262305976
work:+61_261256749
mobile:+61_415544621
irc:{undernet|freenode|oftc}:znalo
xmpp:<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">ambrose at jabber.fsfe.org</A>
sip:<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">znalo at ekiga.net</A>
CE38 8B79 C0A7 DF4A 4F54 E352 2647 19A1 DB3B F823
556A 6D19 0904 827C 9DB8 3697 32D0 1E11 403F 2BE1
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025482.html">[mod_python] Newbie question: do I need to worry about
	compilation of modules served directly by mod_python
</A></li>
	<LI>Next message: <A HREF="025478.html">[mod_python] mod-gnutls 'SSL_SRP_USER' and ModPython
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25475">[ date ]</a>
              <a href="thread.html#25475">[ thread ]</a>
              <a href="subject.html#25475">[ subject ]</a>
              <a href="author.html#25475">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
