<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] importing from a PSP file
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20importing%20from%20a%20PSP%20file&In-Reply-To=4e4a11f8050106165241b8583c%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017041.html">
   <LINK REL="Next"  HREF="017046.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] importing from a PSP file</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20importing%20from%20a%20PSP%20file&In-Reply-To=4e4a11f8050106165241b8583c%40mail.gmail.com"
       TITLE="[mod_python] importing from a PSP file">grahamd at dscpl.com.au
       </A><BR>
    <I>Thu Jan  6 21:51:36 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="017041.html">[mod_python] importing from a PSP file
</A></li>
        <LI>Next message: <A HREF="017046.html">[mod_python] Installing mod_python without root-permissions.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17042">[ date ]</a>
              <a href="thread.html#17042">[ thread ]</a>
              <a href="subject.html#17042">[ subject ]</a>
              <a href="author.html#17042">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Jan 07 08:52, Simon Wittber &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">simonwittber at gmail.com</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> Subject: Re: [mod_python] importing from a PSP file
</I>&gt;<i>
</I>&gt;<i> &gt; &gt; I don't know if this will help you or not, but mod_python actually uses
</I>&gt;<i> &gt; &gt; subinterpreters, each of which have their own namespace separate from the
</I>&gt;<i> &gt; &gt; main interpreter.
</I>&gt;<i> 
</I>&gt;<i> Brilliant! Just what I need.
</I>&gt;<i> 
</I>&gt;<i> &gt; In short, requests against the directory and a file in the directory map
</I>&gt;<i> &gt; to different interpreters when they should be the same. This makes it
</I>&gt;<i> &gt; hard to have a default index page served up when directory is accessed.
</I>&gt;<i> 
</I>&gt;<i> Fortunately we do not use index.psp files, so it seems this bug won't effect us.
</I>&gt;<i> 
</I>&gt;<i> To summarise:
</I>&gt;<i> 
</I>&gt;<i> The final 3 lines I added after line 207 in psp.py are:
</I>&gt;<i> 
</I>&gt;<i> cwd = os.path.split(self.filename)[0]
</I>&gt;<i> if cwd not in sys.path:
</I>&gt;<i>     sys.path.append(cwd)
</I>&gt;<i> 
</I>&gt;<i> This allows (along with the PythonInterpPerDirectory driective)
</I>&gt;<i> multiple developers, on the same machine, to import different packages
</I>&gt;<i> (which reside in the same folder as the .psp file) of the same name
</I>&gt;<i> into .psp pages which are served from their public_html folders.
</I>
There isn't a need to be changing psp.py at all and changing it isn't a
good idea as others have said. For the path bit, use PythonPath directive
in the users htaccess file instead. Out of the options mentioned as to
separate interpreters, use PythonInterpPerDirective instead of the
PythonInterpPerDirectory option.

Thus, a users .htaccess file in their public_html directory would read
something like:

  AddHandler mod_python .psp
  PythonInterpPerDirective On
  PythonHandler mod_python.psp
  PythonPath &quot;sys.path+'/home/simon/public_html/package'&quot;

Or in httpd.conf, as:

  &lt;Directory /home/simon/public_html&gt;
  AddHandler mod_python .psp
  PythonInterpPerDirective On
  PythonHandler mod_python.psp
  PythonPath &quot;sys.path+'/home/simon/public_html/package'&quot;
  &lt;/Directory&gt;

In someone elses directory, just change the PythonPath setting as is
appropriate for their version of the above.

What this would then give you is a separate interpreter for stuff rooted
at the top of each persons public_html directory. Further, the Python
path would include the &quot;package&quot; subdirectory of the public_html
directory.

The reason for not using PythonInterpPerDirectory, besides the bug, is
that if subdirectories were created, under public_html which have .psp
files, each of those directories would have a separate interpreter as well.
Using PythonInterpPerDirective means the whole directory hierarchy
under public_html would share the same one for that one user.

--
Graham Dumpleton (<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">grahamd at dscpl.com.au</A>)
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017041.html">[mod_python] importing from a PSP file
</A></li>
	<LI>Next message: <A HREF="017046.html">[mod_python] Installing mod_python without root-permissions.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17042">[ date ]</a>
              <a href="thread.html#17042">[ thread ]</a>
              <a href="subject.html#17042">[ subject ]</a>
              <a href="author.html#17042">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
