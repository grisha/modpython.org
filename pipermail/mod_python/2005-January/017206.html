<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] psp_site example doesn't work
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20psp_site%20example%20doesn%27t%20work&In-Reply-To=c298f2d705012407307d37cb3c%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017223.html">
   <LINK REL="Next"  HREF="017217.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] psp_site example doesn't work</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Jorey Bump</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20psp_site%20example%20doesn%27t%20work&In-Reply-To=c298f2d705012407307d37cb3c%40mail.gmail.com"
       TITLE="[mod_python] psp_site example doesn't work">list at joreybump.com
       </A><BR>
    <I>Mon Jan 24 14:32:05 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="017223.html">[mod_python] psp_site example doesn't work
</A></li>
        <LI>Next message: <A HREF="017217.html">[mod_python] psp_site example doesn't work
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17206">[ date ]</a>
              <a href="thread.html#17206">[ thread ]</a>
              <a href="subject.html#17206">[ subject ]</a>
              <a href="author.html#17206">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Nicolas Lehuen wrote:
&gt;<i> On Mon, 24 Jan 2005 16:28:47 +0100, Nicolas Lehuen
</I>&gt;<i> &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">nicolas.lehuen at gmail.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i>On Mon, 24 Jan 2005 09:12:24 -0500, Jorey Bump &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">list at joreybump.com</A>&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>Nicolas Lehuen wrote:
</I>
&gt;&gt;<i>The problem is that mod_python.publisher does not follow the standard
</I>&gt;&gt;<i>Python way in that it imports published modules as root-level modules.
</I>
Yes, it's true that it strips away leading path information to put all 
modules on an even plane. I find this an easy adjustment to make. 
Imports done by published modules obey sys.path, so I don't see any 
problem.

&gt;&gt;<i>It's as if mod_python.publisher changed sys.path for each and every
</I>&gt;&gt;<i>published module. This is not the standard Python way, and the source
</I>&gt;&gt;<i>for many errors.
</I>
The main effect is that the DocumentRoot might get prepended to sys.path 
instead of the directory containing the published module. But a single 
interpreter must have a single working directory, so I consider this an 
elegant solution.

If you modify the path with the PythonPath directive, this will no 
longer be the case. The DocumentRoot is not prepended to the path and 
you will be limited to the directories explicitly listed in PythonPath. 
This can lead to surprising behaviour if you created some modules and 
packages in the DocumentRoot, because they will no longer work properly.

To me, this seems very much like a feature, and not a bug, because it 
allows you to finetune your environment and offers some nice security 
capabilities. You are right that it's not expected, but it's not 
necessarily inconsistent, once you get used to it.

Fortunately, I tend to create packages that are available for my apps 
and put them in predictable locations in the module search path, so I'm 
not bit by this. You are right that this can be a serious problem for 
anyone expecting sys.path to be identical to python run from the command 
line, but it's really a mod_python configuration issue.

&gt;&gt;<i>Note that the current package system in Python is way, way smarter
</I>&gt;&gt;<i>than mod_python.publisher : in a package, you can import fellow
</I>&gt;&gt;<i>modules by giving their local names. It's not recommended by
</I>&gt;&gt;<i>pychecker, but it works. The smart part is that if I have this :
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>/
</I>&gt;&gt;<i>     package1.py
</I>&gt;&gt;<i>/subdir
</I>&gt;&gt;<i>     __init__.py
</I>&gt;&gt;<i>     package1.py
</I>&gt;&gt;<i>     package2.py
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>Then whatever I do, /subdir/package1.py is imported as subdir.package1
</I>&gt;&gt;<i>and does not collide with /package1.py. mod_python.publisher is not as
</I>&gt;&gt;<i>smart, this is very confusing and surprising, nearly everybody
</I>&gt;&gt;<i>complains about this and hence, I think this should be filed as a bug.
</I>
To be accurate, Python does not import fellow modules or packages -- it 
prepends the directory containing the main module to sys.path and limits 
imports to sys.path. As seen above, mod_python also obeys sys.path, so 
be sure your imported modules/packages are there.

&gt;&gt;<i>So maybe apache.import_module should not be modified (except for
</I>&gt;&gt;<i>performance, but that's another issue which is already in the bugs
</I>&gt;&gt;<i>database), but mod_python.publisher sure has to be changed.
</I>
Its behaviour is consistent, once you understand it, so I don't see a 
need for the change.

&gt;<i> Or it could be the sign that mod_python.publisher should be completely
</I>&gt;<i> erased from the project, since it poses much more problems than it
</I>&gt;<i> solves. Maybe we should include both mpservlets and Vampire in
</I>&gt;<i> mod_python, and forget about the default publisher (except maybe for
</I>&gt;<i> compatibility issues).
</I>
Yikes! Publisher is simply the best web application framework I have 
ever used. I've never felt a need to move beyond it, and I'm not menaced 
by the issues that seem to bother others. I'd rather see it more heavily 
promoted and the intricacies explained in some more detail. Once you 
comprehend a few simple rules, it's incredibly powerful and productive. 
   Grisha created a thing of beauty in Publisher, but its simplicity is 
lost on many people. To remove it would be madness...



</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017223.html">[mod_python] psp_site example doesn't work
</A></li>
	<LI>Next message: <A HREF="017217.html">[mod_python] psp_site example doesn't work
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17206">[ date ]</a>
              <a href="thread.html#17206">[ thread ]</a>
              <a href="subject.html#17206">[ subject ]</a>
              <a href="author.html#17206">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
