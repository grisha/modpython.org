<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] mod_python + vampire + psp
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20mod_python%20%2B%20vampire%20%2B%20psp&In-Reply-To=1105944659.29542%40dscpl.user.openhosting.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017115.html">
   <LINK REL="Next"  HREF="017120.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] mod_python + vampire + psp</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20mod_python%20%2B%20vampire%20%2B%20psp&In-Reply-To=1105944659.29542%40dscpl.user.openhosting.com"
       TITLE="[mod_python] mod_python + vampire + psp">grahamd at dscpl.com.au
       </A><BR>
    <I>Mon Jan 17 03:30:45 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="017115.html">[mod_python] mod_python + vampire + psp
</A></li>
        <LI>Next message: <A HREF="017120.html">[mod_python] mod_python + vampire + psp
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17116">[ date ]</a>
              <a href="thread.html#17116">[ thread ]</a>
              <a href="subject.html#17116">[ subject ]</a>
              <a href="author.html#17116">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On 17/01/2005, at 5:50 PM, Graham Dumpleton wrote:

&gt;<i> Keerati Inochanon wrote ..
</I>&gt;&gt;<i> Hi,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I am a couple-of-day old python programmer. I decided to give a shot
</I>&gt;&gt;<i> at mod_python. I successfully installed mod_python, but I am still
</I>&gt;&gt;<i> trying to work with vampire. I would like psp files to be able to call
</I>&gt;&gt;<i> functions in other modules (ie. a .py file). Before installing
</I>&gt;&gt;<i> vampire, I was able to do this by calling filename/function (eg. &lt;form
</I>&gt;&gt;<i> action=&quot;authentication/login&quot; method=&quot;post&quot; name=&quot;doe&quot;&gt; ) . If I do
</I>&gt;&gt;<i> the same thing now, it will give me a 404 file not found error.
</I>&gt;&gt;<i> Putting <A HREF="http://domain/filename/function">http://domain/filename/function</A> in the location bar will not
</I>&gt;&gt;<i> work either.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ...
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I am using the .vampire and default-handlers.py as provided with the
</I>&gt;&gt;<i> source as the default content handler. Vampire is now mapping html
</I>&gt;&gt;<i> extension to psp. The psp file snippet is below:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &lt;html&gt;
</I>&gt;&gt;<i> &lt;form action=&quot;authentication/login&quot; method=&quot;post&quot; name=&quot;auth&quot;&gt;
</I>&gt;&gt;<i>   Username: &lt;input type=&quot;text&quot; name=&quot;username&quot;&gt;&lt;/input&gt;&lt;br&gt;
</I>&gt;&gt;<i>   Password: &lt;input type=&quot;password&quot; name=&quot;password&quot;&gt;&lt;/input&gt;&lt;br&gt;
</I>&gt;&gt;<i>   &lt;input type=&quot;hidden&quot; name=&quot;isFirst&quot; value=&quot;False&quot;&gt;&lt;/input&gt;
</I>&gt;&gt;<i>   &lt;input type=&quot;submit&quot; value=&quot;Login&quot;&gt;
</I>&gt;&gt;<i> &lt;/form&gt;
</I>&gt;&gt;<i> &lt;/html&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Any help will be much appreciated. Thank you very much!
</I>&gt;<i>
</I>&gt;<i> The form is merely a POST against a URL, specifically 
</I>&gt;<i> &quot;authentication/login&quot;.
</I>&gt;<i> Using Vampire, you should therefore have a file:
</I>&gt;<i>
</I>&gt;<i>   authentication/login.py
</I>&gt;<i>
</I>&gt;<i> In this file it would have a handler defined as:
</I>&gt;<i>
</I>&gt;<i>   def handler(req,username,password,isFirst):
</I>&gt;<i>     ...
</I>&gt;<i>
</I>&gt;<i> The method is just &quot;handler()&quot; in this case, as the URL being posted 
</I>&gt;<i> against
</I>&gt;<i> has no extension on it.
</I>&gt;<i>
</I>&gt;<i> At least that is how it should work. I'll test it when I get home and 
</I>&gt;<i> post again
</I>&gt;<i> then.
</I>
Have twigged now on what you are doing differently.

When using PSP directly, your login handler was being implemented in
the style expected by mod_python.publisher. That is, for 
&quot;authentication/login&quot;
you would have had a file called &quot;authentication.py&quot; with a function in
it called &quot;login&quot;.

In Vampire, it does not use the mod_python.publisher style of mapping 
URLs to
actual files. In mod_python.publisher generally all but the last part 
of the
URL identifies the path to the file and the last part identifies the 
method
within the file.

In Vampire, the whole URL (or as much as possible) is used to identify 
the
path to the file. Any extra is supplied in the &quot;req&quot; object as 
&quot;path_info&quot;.
The method executed in the file will be handler(), or if the last 
component
on the URL used to identify the file has an extension, the 
handler_extn(),
method where &quot;extn&quot; is replaced with the actual extension.

What this means is that when using mod_python.publisher, there can be
multiple methods in the same code file which are associated with 
different
resource URLs. If an extension is used and AddHandler is set 
appropriately,
the extension has no real meaning.

In Vampire, each code file only has methods related to one specific 
resource.
There may however be different methods for delivering up the resource in
different formats. Which is called is dictated by the extension used in 
the
URL.

Thus in Vampire, mapping to functions is different. The other thing to 
know
is that the handler functions in Vampire follow the standard mod_python
form. That is, its return value is a status value. In 
mod_python.publisher
the return value will be the actual content, which if not HTML, will be
converted to HTML. If a specific status has to be returned an exception 
is
instead raised.

Note though that Vampire supports the mod_python.publisher like 
extension
of being able to accept form parameters as method parameters of the
handler method. In doing this though, it is mandatory that the first
argument of the handler method still be the &quot;req&quot; object whereas in
mod_python.publisher accepting the req object is optional and could be
placed in any position.

That said, if the only method in authentication.py to be called via a
URL is login(), you could instead renamed authentication.py to login.py
and change the method from login() to handler() and the the action in
form would just be &quot;login&quot;. You obviously still need change the 
handler()
method to be implemented more in the form of a standard handler and not
a mod_python.publisher method.

Hope this helps.

--
Graham Dumpleton (<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">grahamd at dscpl.com.au</A>)

</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017115.html">[mod_python] mod_python + vampire + psp
</A></li>
	<LI>Next message: <A HREF="017120.html">[mod_python] mod_python + vampire + psp
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17116">[ date ]</a>
              <a href="thread.html#17116">[ thread ]</a>
              <a href="subject.html#17116">[ subject ]</a>
              <a href="author.html#17116">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
