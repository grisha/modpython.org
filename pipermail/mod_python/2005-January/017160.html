<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] mptest.py works, other .py files don't
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20mptest.py%20works%2C%20other%20.py%20files%20don%27t&In-Reply-To=1106177941.11185.46.camel%40fons">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017158.html">
   <LINK REL="Next"  HREF="017166.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] mptest.py works, other .py files don't</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Nicolas Lehuen</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20mptest.py%20works%2C%20other%20.py%20files%20don%27t&In-Reply-To=1106177941.11185.46.camel%40fons"
       TITLE="[mod_python] mptest.py works, other .py files don't">nicolas.lehuen at gmail.com
       </A><BR>
    <I>Wed Jan 19 19:03:53 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="017158.html">[mod_python] mptest.py works, other .py files don't
</A></li>
        <LI>Next message: <A HREF="017166.html">[mod_python] mptest.py works, other .py files don't
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17160">[ date ]</a>
              <a href="thread.html#17160">[ thread ]</a>
              <a href="subject.html#17160">[ subject ]</a>
              <a href="author.html#17160">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, 20 Jan 2005 00:39:01 +0100, Bas van Dorp &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">bas at vandorp.nu</A>&gt; wrote:
[...]
&gt;<i> Guess what? This works :-)) However, when I rename this file to
</I>&gt;<i> mptest2.py, I get this:
</I>&gt;<i> 
</I>&gt;<i> Mod_python error: &quot;PythonHandler mptest&quot;
</I>&gt;<i> 
</I>&gt;<i> Traceback (most recent call last):
</I>&gt;<i> 
</I>&gt;<i>   File &quot;/usr/local/lib/python2.3/site-packages/mod_python/apache.py&quot;, line 287, in HandlerDispatch
</I>&gt;<i>     log=debug)
</I>&gt;<i> 
</I>&gt;<i>   File &quot;/usr/local/lib/python2.3/site-packages/mod_python/apache.py&quot;, line 454, in import_module
</I>&gt;<i>     f, p, d = imp.find_module(parts[i], path)
</I>&gt;<i> 
</I>&gt;<i> ImportError: No module named mptest
</I>&gt;<i> 
</I>&gt;<i> This was not what I expected. I've read this over and over:
</I>&gt;<i> <A HREF="http://www.modpython.org/live/current/doc-html/tut-what-it-do.html">http://www.modpython.org/live/current/doc-html/tut-what-it-do.html</A>
</I>&gt;<i> 
</I>&gt;<i> The last paragraph explicitly states that the name of my python script
</I>&gt;<i> doesn't matter. I probably missed something... I've tried a lot of
</I>&gt;<i> things, but I still get errors. I seem to be able to make mod_python to
</I>&gt;<i> execute only the scripts I specify in httpd.conf, and nothing else.
</I>&gt;<i> Specifying multiple files in httpd.conf also gives interesting results.
</I>&gt;<i> For example:
</I>&gt;<i> 
</I>&gt;<i> ==&gt; httpd.conf:
</I>&gt;<i> &lt;Directory /home/www/basd/python&gt;
</I>&gt;<i>     AddHandler mod_python .py
</I>&gt;<i>     PythonHandler mptest
</I>&gt;<i>     PythonHandler mptest2
</I>&gt;<i>     PythonDebug On
</I>&gt;<i> &lt;/Directory&gt;
</I>&gt;<i> 
</I>&gt;<i> ==&gt; mptest.py:
</I>&gt;<i> from mod_python import apache
</I>&gt;<i> 
</I>&gt;<i> def handler(req):
</I>&gt;<i>     req.write(&quot;Hello World!&quot;)
</I>&gt;<i>     return apache.OK
</I>&gt;<i> 
</I>&gt;<i> ==&gt; mptest2.py:
</I>&gt;<i> from mod_python import apache
</I>&gt;<i> 
</I>&gt;<i> def handler(req):
</I>&gt;<i>     req.write(&quot;Hello Universe!&quot;)
</I>&gt;<i>     return apache.OK
</I>&gt;<i> 
</I>&gt;<i> Whether I point my browser to mptest.py or mptest2.py, I get the same
</I>&gt;<i> result:
</I>&gt;<i> 
</I>&gt;<i> Hello World!Hello Universe!
</I>&gt;<i> 
</I>&gt;<i> I don't get it. I would like to tell Apache to parse all .py scripts in
</I>&gt;<i> certain directories, just like I do with .php scripts. But how?
</I>&gt;<i> 
</I>&gt;<i> Greetings and thanks in advance,
</I>&gt;<i> 
</I>&gt;<i> Bas
</I>
The name of the .py file in the URL doesn't matters, but the name of
the PythonHandler does. I think we should change the doc because
you're not the first to be confused about this.

The configuration file reads like this :

# for directory /home/www/basd/python
# which is accessed through something like <A HREF="http://localhost/basd/python">http://localhost/basd/python</A>
&lt;Directory /home/www/basd/python&gt;
     # any filename ending by .py must be handled by mod_python
     AddHandler mod_python .py
     # mod_python will call the handler function defined in the mptest module
     # which will be imported from the /home/www/basd/python
directory, hence from
     # /home/www/basd/python/mptest.py
     PythonHandler mptest
     # add debug information i.e. outputs stack traces to the client
     PythonDebug On
 &lt;/Directory&gt;

Now I hope it's clear : with this configuration, the module with then
handler() function MUST be in /home/www/basd/python/mptest.py. But you
can test the module by requesting ANY URL provided it ends with .py :

<A HREF="http://localhost/basd/python/foo.py">http://localhost/basd/python/foo.py</A>
<A HREF="http://localhost/basd/python/bar.py">http://localhost/basd/python/bar.py</A>

And so on. Naturally, this test handler won't lead you very far... To
build your real application, you'll have to write some Python or PSP
code for each and every page or function your site provide.

What you need, therefore, is a dispatching handler function, which
knows where to find the code for the various pages of your
application. That's what you get with the builtin mod_python.publisher
handler (which is described in the documentation), or other handlers,
like the one provided by spin-off projects like mod_python servlets
(MPS), Vampire, etc.

I hope this helps,
Regards,
Nicolas
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017158.html">[mod_python] mptest.py works, other .py files don't
</A></li>
	<LI>Next message: <A HREF="017166.html">[mod_python] mptest.py works, other .py files don't
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17160">[ date ]</a>
              <a href="thread.html#17160">[ thread ]</a>
              <a href="subject.html#17160">[ subject ]</a>
              <a href="author.html#17160">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
