<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Cheetah / mod_python problem: importing python
	module into cheetah template
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Cheetah%20/%20mod_python%20problem%3A%20importing%20python%0A%09module%20into%20cheetah%20template&In-Reply-To=b11ea23c0709131038k636f0ca7gceb43035d9d58ab6%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024200.html">
   <LINK REL="Next"  HREF="024197.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Cheetah / mod_python problem: importing python
	module into cheetah template</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Cheetah%20/%20mod_python%20problem%3A%20importing%20python%0A%09module%20into%20cheetah%20template&In-Reply-To=b11ea23c0709131038k636f0ca7gceb43035d9d58ab6%40mail.gmail.com"
       TITLE="[mod_python] Cheetah / mod_python problem: importing python
	module into cheetah template">graham.dumpleton at gmail.com
       </A><BR>
    <I>Thu Sep 13 18:09:26 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="024200.html">[mod_python] Cheetah / mod_python problem: importing python
	module into cheetah template
</A></li>
        <LI>Next message: <A HREF="024197.html">[mod_python] Apache virtual host, mod_python and Roundup
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24201">[ date ]</a>
              <a href="thread.html#24201">[ thread ]</a>
              <a href="subject.html#24201">[ subject ]</a>
              <a href="author.html#24201">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Is LcConfig actually a Python package rather than a single Python code
file module?

&gt;<i>From mod_python 3.3.1, you cannot put Python packages in the document
</I>tree due to the separation between document tree module imports and
normal sys.path imports.

Read documentation for import_module() in:

  <A HREF="http://www.modpython.org/live/current/doc-html/pyapi-apmeth.html">http://www.modpython.org/live/current/doc-html/pyapi-apmeth.html</A>

This is the function that underlays imports of modules residing in
document tree and is used for top level handlers and
mod_python.publisher handlers files.

If your code is a Python package, move it outside of the document tree
and then use PythonPath directory to refer to the parent directory
containing your packages/modules.

In general it is not a good idea to be putting common Python
packages/modules in the document tree if they aren't actually
mod_python handlers. Some, and possibly with good reason, would also
recommend that handler code files in document tree be a very thin
shell which always simply imports code from outside of the document
tree and calls it. The reason for this is so that an Apache
misconfiguration doesn't expose your source code.

Graham

On 14/09/2007, Webb Sprague &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">webb.sprague at gmail.com</A>&gt; wrote:
&gt;<i> (Let me repost a more cogent answer...)
</I>&gt;<i>
</I>&gt;<i> On 9/12/07, Graham Dumpleton &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">graham.dumpleton at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt; Was mod_python one of the things you upgraded?
</I>&gt;<i>
</I>&gt;<i> Yep
</I>&gt;<i>
</I>&gt;<i> &gt; What is the mod_python configuration for that Directory context?
</I>&gt;<i>
</I>&gt;<i> # LCFIT directory
</I>&gt;<i> &lt;Directory /var/www/localhost/htdocs/larry&gt;
</I>&gt;<i>     SetHandler mod_python
</I>&gt;<i>     PythonHandler mod_python.publisher
</I>&gt;<i>     PythonDebug On
</I>&gt;<i>     #PythonOptimize On
</I>&gt;<i> &lt;/Directory&gt;
</I>&gt;<i>
</I>&gt;<i> &gt; On 13/09/2007, Webb Sprague &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">webb.sprague at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt; &gt; Hi all,
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Sorry for the redundancy, but I didn't get a response on the Cheetah
</I>&gt;<i> &gt; &gt; mailing list (probably dead because they use SF), so here I go again:
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; I am using modpython 3.3.1, cheetah 2.0rc8, python2.5, and apache2 on
</I>&gt;<i> &gt; &gt; a gentoo machine.  I recently upgraded a bunch of stuff on the machine
</I>&gt;<i> &gt; &gt; - it had worked six months ago with different apache etc.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; The templates are used by calling:
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; pageTemplate = Template.Template(file=self.navTemplate, searchList =
</I>&gt;<i> &gt; &gt; searchList)
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; #... and then ...
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; req.write(str(pageTemplate))
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; I have a template that has the following code at the top:
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; #import sys
</I>&gt;<i> &gt; &gt; #import os
</I>&gt;<i> &gt; &gt; #$sys.path.append('/var/www/localhost/htdocs/larry/')  ## path of following
</I>&gt;<i> &gt; &gt; #from LcConfig import *
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; But I get an error in my apache logs saying the module can't be found
</I>&gt;<i> &gt; &gt; - please help!
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Log dump:
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133] Traceback
</I>&gt;<i> &gt; &gt; (most recent call last):, referer: <A HREF="http://lare.demog.berkeley.edu/">http://lare.demog.berkeley.edu/</A>
</I>&gt;<i> &gt; &gt; [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
</I>&gt;<i> &gt; &gt; &quot;/usr/lib64/python2.5/site-packages/mod_python/importer.py&quot;, line
</I>&gt;<i> &gt; &gt; 1537, in HandlerDispatch\n    default=default_handler, arg=req,
</I>&gt;<i> &gt; &gt; silent=hlist.silent), referer: <A HREF="http://lare.demog.berkeley.edu/">http://lare.demog.berkeley.edu/</A>
</I>&gt;<i> &gt; &gt; [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
</I>&gt;<i> &gt; &gt; &quot;/usr/lib64/python2.5/site-packages/mod_python/importer.py&quot;, line
</I>&gt;<i> &gt; &gt; 1229, in _process_target\n    result = _execute_target(config, req,
</I>&gt;<i> &gt; &gt; object, arg), referer: <A HREF="http://lare.demog.berkeley.edu/">http://lare.demog.berkeley.edu/</A>
</I>&gt;<i> &gt; &gt; [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
</I>&gt;<i> &gt; &gt; &quot;/usr/lib64/python2.5/site-packages/mod_python/importer.py&quot;, line
</I>&gt;<i> &gt; &gt; 1128, in _execute_target\n    result = object(arg), referer:
</I>&gt;<i> &gt; &gt; <A HREF="http://lare.demog.berkeley.edu/">http://lare.demog.berkeley.edu/</A>
</I>&gt;<i> &gt; &gt; [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
</I>&gt;<i> &gt; &gt; &quot;/usr/lib64/python2.5/site-packages/mod_python/publisher.py&quot;, line
</I>&gt;<i> &gt; &gt; 213, in handler\n    published = publish_object(req, object), referer:
</I>&gt;<i> &gt; &gt; <A HREF="http://lare.demog.berkeley.edu/">http://lare.demog.berkeley.edu/</A>
</I>&gt;<i> &gt; &gt; [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
</I>&gt;<i> &gt; &gt; &quot;/usr/lib64/python2.5/site-packages/mod_python/publisher.py&quot;, line
</I>&gt;<i> &gt; &gt; 425, in publish_object\n    return
</I>&gt;<i> &gt; &gt; publish_object(req,util.apply_fs_data(object, req.form, req=req)),
</I>&gt;<i> &gt; &gt; referer: <A HREF="http://lare.demog.berkeley.edu/">http://lare.demog.berkeley.edu/</A>
</I>&gt;<i> &gt; &gt; [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
</I>&gt;<i> &gt; &gt; &quot;/usr/lib64/python2.5/site-packages/mod_python/util.py&quot;, line 554, in
</I>&gt;<i> &gt; &gt; apply_fs_data\n    return object(**args), referer:
</I>&gt;<i> &gt; &gt; <A HREF="http://lare.demog.berkeley.edu/">http://lare.demog.berkeley.edu/</A>
</I>&gt;<i> &gt; &gt; [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
</I>&gt;<i> &gt; &gt; &quot;/var/www/localhost/htdocs/larry/LcPageObjects.py&quot;, line 55, in
</I>&gt;<i> &gt; &gt; __call__\n    formTemplate = Template.Template(file=self.formTemplate,
</I>&gt;<i> &gt; &gt; searchList = searchList), referer: <A HREF="http://lare.demog.berkeley.edu/">http://lare.demog.berkeley.edu/</A>
</I>&gt;<i> &gt; &gt; [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
</I>&gt;<i> &gt; &gt; &quot;/usr/lib64/python2.5/site-packages/Cheetah/Template.py&quot;, line 1204,
</I>&gt;<i> &gt; &gt; in __init__\n    self._compile(source, file,
</I>&gt;<i> &gt; &gt; compilerSettings=compilerSettings), referer:
</I>&gt;<i> &gt; &gt; <A HREF="http://lare.demog.berkeley.edu/">http://lare.demog.berkeley.edu/</A>
</I>&gt;<i> &gt; &gt; [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
</I>&gt;<i> &gt; &gt; &quot;/usr/lib64/python2.5/site-packages/Cheetah/Template.py&quot;, line 1492,
</I>&gt;<i> &gt; &gt; in _compile\n    keepRefToGeneratedCode=True), referer:
</I>&gt;<i> &gt; &gt; <A HREF="http://lare.demog.berkeley.edu/">http://lare.demog.berkeley.edu/</A>
</I>&gt;<i> &gt; &gt; [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
</I>&gt;<i> &gt; &gt; &quot;/usr/lib64/python2.5/site-packages/Cheetah/Template.py&quot;, line 780, in
</I>&gt;<i> &gt; &gt; compile\n    exec co in mod.__dict__, referer:
</I>&gt;<i> &gt; &gt; <A HREF="http://lare.demog.berkeley.edu/">http://lare.demog.berkeley.edu/</A>
</I>&gt;<i> &gt; &gt; [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
</I>&gt;<i> &gt; &gt; &quot;_var_www_localhost_htdocs_larry_TEMPLATES_LoginForm_tmpl.py&quot;, line
</I>&gt;<i> &gt; &gt; 25, in &lt;module&gt;, referer: <A HREF="http://lare.demog.berkeley.edu/">http://lare.demog.berkeley.edu/</A>
</I>&gt;<i> &gt; &gt; [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133] ImportError:
</I>&gt;<i> &gt; &gt; No module named LcConfig, referer: <A HREF="http://lare.demog.berkeley.edu/">http://lare.demog.berkeley.edu/</A>
</I>&gt;<i> &gt; &gt; _______________________________________________
</I>&gt;<i> &gt; &gt; Mod_python mailing list
</I>&gt;<i> &gt; &gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> &gt; &gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt;
</I>&gt;<i>
</I></PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024200.html">[mod_python] Cheetah / mod_python problem: importing python
	module into cheetah template
</A></li>
	<LI>Next message: <A HREF="024197.html">[mod_python] Apache virtual host, mod_python and Roundup
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24201">[ date ]</a>
              <a href="thread.html#24201">[ thread ]</a>
              <a href="subject.html#24201">[ subject ]</a>
              <a href="author.html#24201">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
