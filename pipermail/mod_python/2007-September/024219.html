<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Dummy threads
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Dummy%20threads&In-Reply-To=46EA8D96.8060905%40ofset.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024218.html">
   <LINK REL="Next"  HREF="024220.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Dummy threads</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Dummy%20threads&In-Reply-To=46EA8D96.8060905%40ofset.org"
       TITLE="[mod_python] Dummy threads">graham.dumpleton at gmail.com
       </A><BR>
    <I>Fri Sep 14 19:18:39 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="024218.html">[mod_python] Dummy threads
</A></li>
        <LI>Next message: <A HREF="024220.html">[mod_python] Dummy threads
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24219">[ date ]</a>
              <a href="thread.html#24219">[ thread ]</a>
              <a href="subject.html#24219">[ subject ]</a>
              <a href="author.html#24219">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 14/09/2007, Odile B&#233;nassy &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">odile at ofset.org</A>&gt; wrote:
&gt;<i> Hello,
</I>&gt;<i>
</I>&gt;<i> I'm currently trying to port glasnost CMS on Apache2 (*) and encounter
</I>&gt;<i> issues related to Dummy Threads
</I>&gt;<i>
</I>&gt;<i> Here is my test.py file (I use it as a mod python handler):
</I>&gt;<i>
</I>&gt;<i> --%&lt;
</I>&gt;<i> #!/usr/bin/env python
</I>&gt;<i>
</I>&gt;<i> import threading
</I>&gt;<i> from mod_python import apache
</I>&gt;<i>
</I>&gt;<i> def handler(req):
</I>&gt;<i>     thread = threading.currentThread()
</I>&gt;<i>     r = req.the_request
</I>&gt;<i>     req.content_type = &quot;text/plain&quot;
</I>&gt;<i>     req.write(&quot;Bonjour!&quot;)
</I>&gt;<i>     req.write(&quot;\n&quot;)
</I>&gt;<i>     req.write(r)
</I>&gt;<i>     req.write(&quot;\n&quot;)
</I>&gt;<i>     req.write(repr(thread))
</I>&gt;<i>     return apache.OK
</I>&gt;<i>
</I>&gt;<i> --%&lt;
</I>&gt;<i>
</I>&gt;<i> As you can see, it is a rather minimal handler.
</I>&gt;<i>
</I>&gt;<i> At first it renders:
</I>&gt;<i>
</I>&gt;<i> --%&lt;
</I>&gt;<i> Bonjour!
</I>&gt;<i> GET / HTTP/1.1
</I>&gt;<i> &lt;_MainThread(MainThread, started)&gt;
</I>&gt;<i> --%&lt;
</I>&gt;<i>
</I>&gt;<i> but if I call any URL more than 3 or 4 times in a row, I get this on the
</I>&gt;<i> browser
</I>&gt;<i>
</I>&gt;<i> -%&lt;
</I>&gt;<i> Bonjour!
</I>&gt;<i> GET / HTTP/1.1
</I>&gt;<i> &lt;_DummyThread(Dummy-1, started daemon)&gt;
</I>&gt;<i> --%&lt;
</I>&gt;<i>
</I>&gt;<i> Can you help me figuring out why this dummy &amp; annoying thing is happening?
</I>
It is normal.

When Apache worker MPM, or Windows MPM are used, then multiple
requests are used to handle requests. All these threads are created by
Apache and not Python. Which ever Apache thread so happened to be the
one which initialised Python will show as MainThread. Any other Apache
threads will be maked by Python as a DummyThread, which indicates they
are a foreign thread created outside of Python, as is the case in
Apache. Because requests are handled in random thread from Apache
thread pool, sometimes you will thus see MainThread and other times
you will see DummyThread.

Why is this creating a problem?

Graham

</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024218.html">[mod_python] Dummy threads
</A></li>
	<LI>Next message: <A HREF="024220.html">[mod_python] Dummy threads
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24219">[ date ]</a>
              <a href="thread.html#24219">[ thread ]</a>
              <a href="subject.html#24219">[ subject ]</a>
              <a href="author.html#24219">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
