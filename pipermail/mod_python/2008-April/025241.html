<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] deadlock when using mod_python + simplified GIL -
	e.g. swig wrapper of xapian (MODPYTHON-217)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20deadlock%20when%20using%20mod_python%20%2B%20simplified%20GIL%20-%0A%09e.g.%20swig%20wrapper%20of%20xapian%20%28MODPYTHON-217%29&In-Reply-To=9e6af55b0804271318l37664029jb9ec51d67fc6eccc%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025240.html">
   <LINK REL="Next"  HREF="025242.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] deadlock when using mod_python + simplified GIL -
	e.g. swig wrapper of xapian (MODPYTHON-217)</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20deadlock%20when%20using%20mod_python%20%2B%20simplified%20GIL%20-%0A%09e.g.%20swig%20wrapper%20of%20xapian%20%28MODPYTHON-217%29&In-Reply-To=9e6af55b0804271318l37664029jb9ec51d67fc6eccc%40mail.gmail.com"
       TITLE="[mod_python] deadlock when using mod_python + simplified GIL -
	e.g. swig wrapper of xapian (MODPYTHON-217)">graham.dumpleton at gmail.com
       </A><BR>
    <I>Sun Apr 27 17:34:52 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="025240.html">[mod_python] deadlock when using mod_python + simplified GIL - e.g.
	swig wrapper of xapian (MODPYTHON-217)
</A></li>
        <LI>Next message: <A HREF="025242.html">[mod_python] Re: Problem with mod_proxy + inputfilter + headers_in
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25241">[ date ]</a>
              <a href="thread.html#25241">[ thread ]</a>
              <a href="subject.html#25241">[ subject ]</a>
              <a href="author.html#25241">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>2008/4/28 Herbert Poul &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">herbert.poul at gmail.com</A>&gt;:
&gt;<i> hi,
</I>&gt;<i>
</I>&gt;<i>  i stumbled across a problem which has been reported a year ago called
</I>&gt;<i>  &quot;Python 2.3 and simplified GIL state API still causes problems.&quot;:
</I>&gt;<i>  <A HREF="http://issues.apache.org/jira/browse/MODPYTHON-217">http://issues.apache.org/jira/browse/MODPYTHON-217</A>
</I>&gt;<i>  and wondered if there are any plans to fix it or any known workarounds.
</I>&gt;<i>
</I>&gt;<i>  in short: i am trying to get the python wrapper of xapian (based on
</I>&gt;<i>  swig, which in turn uses simplified GIL api) working in mod_python -
</I>&gt;<i>  but every call to this C extension ends in a deadlock.
</I>&gt;<i>
</I>&gt;<i>  it seems this problem arises because of the combination of mod_python
</I>&gt;<i>  using PyEval_AcquireLock and the SWIG wrapper using simplified GIL
</I>&gt;<i>  (PyGILState_Ensure)
</I>&gt;<i>
</I>&gt;<i>  is this actually anything that needs fixing in mod_python, or in the
</I>&gt;<i>  python wrapper/SWIG ?
</I>&gt;<i>  i would appreciate any pointers. (i have already tried using
</I>&gt;<i>  'PythonInterpreter main_interpreter' but it doesn't help)
</I>
Yes, mod_python needs fixing. It needs to detect when main interpreter
being used and use simplified GLI state API methods instead of
traditional thread state API.

Is your Python web application specifically written to mod_python API
or are you using some sort of web framework that uses WSGI as server
interface. If WSGI capable, you can use mod_wsgi instead, which
doesn't have this problem, although you still need to force web
application to run in main interpreter.

Graham
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025240.html">[mod_python] deadlock when using mod_python + simplified GIL - e.g.
	swig wrapper of xapian (MODPYTHON-217)
</A></li>
	<LI>Next message: <A HREF="025242.html">[mod_python] Re: Problem with mod_proxy + inputfilter + headers_in
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25241">[ date ]</a>
              <a href="thread.html#25241">[ thread ]</a>
              <a href="subject.html#25241">[ subject ]</a>
              <a href="author.html#25241">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
