<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Best way to have an unique_id per request
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Best%20way%20to%20have%20an%20unique_id%20per%20request&In-Reply-To=48104180.1090709%40teamsystem.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025229.html">
   <LINK REL="Next"  HREF="025236.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Best way to have an unique_id per request</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Best%20way%20to%20have%20an%20unique_id%20per%20request&In-Reply-To=48104180.1090709%40teamsystem.com"
       TITLE="[mod_python] Best way to have an unique_id per request">graham.dumpleton at gmail.com
       </A><BR>
    <I>Thu Apr 24 06:10:59 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="025229.html">[mod_python] Best way to have an unique_id per request
</A></li>
        <LI>Next message: <A HREF="025236.html">[mod_python] Best way to have an unique_id per request
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25231">[ date ]</a>
              <a href="thread.html#25231">[ thread ]</a>
              <a href="subject.html#25231">[ subject ]</a>
              <a href="author.html#25231">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>2008/4/24 Luca Montecchiani &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">l.montecchiani at teamsystem.com</A>&gt;:
&gt;<i> Graham Dumpleton ha scritto:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; Don't stick uniqidprog in req, it will always be 0 as a result. It
</I>&gt;<i> &gt; needs to be a global module variable which is thread protected.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;  from threading import Lock
</I>&gt;<i> &gt;  lock = Lock()
</I>&gt;<i> &gt;  uniqidprog = 1
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;  def _getunique(req):
</I>&gt;<i> &gt;    lock.acquire()
</I>&gt;<i> &gt;    value = uniqidprog
</I>&gt;<i> &gt;    uniqidprog += 1
</I>&gt;<i> &gt;    lock.release()
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;    ... use
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i>  In my own publisher I've many req.somevarname = somevalue
</I>&gt;<i>  without worrying about locking simply because the docs suggest it :
</I>&gt;<i>
</I>&gt;<i>  &quot;4.5.4 Request Object
</I>&gt;<i>  The request object is a Python mapping to the Apache request rec structure.
</I>&gt;<i> When a handler is invoked, it is
</I>&gt;<i>  always passed a single argument - the request object.
</I>&gt;<i>  You can dynamically assign attributes to it as a way to communicate between
</I>&gt;<i> handlers.&quot;
</I>
Yes, but in this case you want the counter to be common to all request
handlers executing in that process over time, otherwise it is
pointless having it. When you assign to req object, it only exists for
that one request.

Maybe I am misunderstanding what you are wanting to do. :-)

Graham
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025229.html">[mod_python] Best way to have an unique_id per request
</A></li>
	<LI>Next message: <A HREF="025236.html">[mod_python] Best way to have an unique_id per request
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25231">[ date ]</a>
              <a href="thread.html#25231">[ thread ]</a>
              <a href="subject.html#25231">[ subject ]</a>
              <a href="author.html#25231">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
