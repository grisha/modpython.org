<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Proxy + Tomcat filter problems
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Proxy%20%2B%20Tomcat%20filter%20problems&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025205.html">
   <LINK REL="Next"  HREF="025207.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Proxy + Tomcat filter problems</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Rados&#322;aw Rymaszewski</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Proxy%20%2B%20Tomcat%20filter%20problems&In-Reply-To="
       TITLE="[mod_python] Proxy + Tomcat filter problems">rrymaszewski at contentforces.pl
       </A><BR>
    <I>Thu Apr 17 06:20:10 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="025205.html">[mod_python] Executing c++ functions through psp
</A></li>
        <LI>Next message: <A HREF="025207.html">[mod_python] Proxy + Tomcat filter problems
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25206">[ date ]</a>
              <a href="thread.html#25206">[ thread ]</a>
              <a href="subject.html#25206">[ subject ]</a>
              <a href="author.html#25206">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello

I was trying to find out solution for my problem but there were no answers,
so I decided to write here.

We are using mod_python filters for our system

Infrastructure description:

INTERNET &lt;---&gt; APACHE 2.8.3 with mod_python 3.3.1 + output filters &lt;--&gt;
Apache proxy module &lt;--&gt; TOMCAT 5.5.2x

our filters concat chunked content from tomcat and write to client whole
changed content. It's important for us to get whole response from tomcat and
after it process.

problem is when filter.read() reach last byte (filter.read() == None) then
there is no possibility to overwrite request headers.

There is no such problem during reading content and when we serve static
pages from apache www server.

mod_python receive such headers

1 chunk

[Wed Apr 16 05:52:15 2008] [error] {'Via': '1.1 domain', 'Set-Cookie':
'JSESSIONID=sessionXXX; Path=/path', 'Date': 'Fri, 18 Apr 2008 19:47:06
GMT', 'Cache-Control': 'no-store', 'Cache-Control': 'no-cache', 'Expires':
'Thu, 01 Jan 1970 00:00:00 GMT', 'Pragma': 'No-cache', 'Server':
'Apache-Coyote'}

2 chunk

[Wed Apr 16 05:52:15 2008] [error] {'Content-Type': 'text/plain',
'Transfer-Encoding': 'chunked', 'Connection': 'Keep-Alive', 'Keep-Alive':
'timeout=15, max=100', 'Via': '1.1 domain', 'Set-Cookie':
'JSESSIONID=sessionXXX; Path=/path', 'Cache-Control': 'No-cache', 'Expires':
'0', 'Pragma': 'No-cache'}

3 chunk

[Wed Apr 16 05:52:15 2008] [error] {'Content-Type': 'text/plain',
'Transfer-Encoding': 'chunked', 'Connection': 'Keep-Alive', 'Keep-Alive':
'timeout=15, max=100', 'Via': '1.1 domain', 'Set-Cookie':
'JSESSIONID=sessionXXX; Path=/path', 'Cache-Control': 'No-cache', 'Expires':
'0', 'Pragma': 'No-cache'}

when I finish process on first or second chunk I can modify headers without
any problems. after third one there is no such possibility

Do You know what could be wrong ?

-- 
Rados&#322;aw Rymaszewski
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20080417/66e3a9fa/attachment.html">http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20080417/66e3a9fa/attachment.html</A>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025205.html">[mod_python] Executing c++ functions through psp
</A></li>
	<LI>Next message: <A HREF="025207.html">[mod_python] Proxy + Tomcat filter problems
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25206">[ date ]</a>
              <a href="thread.html#25206">[ thread ]</a>
              <a href="subject.html#25206">[ subject ]</a>
              <a href="author.html#25206">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
