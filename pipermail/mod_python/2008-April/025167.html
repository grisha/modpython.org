<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] need help solving some performance issues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20need%20help%20solving%20some%20performance%20issues&In-Reply-To=20080410165726.GA99314%40pcbsd">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025180.html">
   <LINK REL="Next"  HREF="025169.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] need help solving some performance issues</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Colin Bean</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20need%20help%20solving%20some%20performance%20issues&In-Reply-To=20080410165726.GA99314%40pcbsd"
       TITLE="[mod_python] need help solving some performance issues">ccbean at gmail.com
       </A><BR>
    <I>Thu Apr 10 14:32:18 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="025180.html">[mod_python] need help solving some performance issues
</A></li>
        <LI>Next message: <A HREF="025169.html">[mod_python] need help solving some performance issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25167">[ date ]</a>
              <a href="thread.html#25167">[ thread ]</a>
              <a href="subject.html#25167">[ subject ]</a>
              <a href="author.html#25167">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, Apr 10, 2008 at 9:57 AM, Culley Harrelson &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">harrelson at gmail.com</A>&gt; wrote:
&gt;<i> I manage a mod_python application that was built about 4 years ago and has
</I>&gt;<i>  not changed much since.  It uses clearsilver templates and interacts with
</I>&gt;<i>  postgresql via psychopg.  The database is on a second machine and the
</I>&gt;<i>  mod_python machine (FreeBSD) has no other major applications.
</I>&gt;<i>
</I>&gt;<i>  The application is much more popular than it was when it was built and I am
</I>&gt;<i>  now encountering some performance problems.  Specifically the CPU seems to be
</I>&gt;<i>  the bottleneck.  The machine has 2 gigs of ram and a single processor.  Ram
</I>&gt;<i>  doesn't seem to be a problem.  When examining top output, I see that every
</I>&gt;<i>  once in a while a process comes along and sucks down 10%-20% of the cpu.  A
</I>&gt;<i>  handful of these processes can (and regularly do) consume the whole CPU.
</I>&gt;<i>
</I>&gt;<i>  I don't really know how to go about optimizing the CPU usage of my
</I>&gt;<i>  application.  Any suggestions are extremely welcome.
</I>&gt;<i>
</I>

Have you profiled your code at all?  Might help to track down problem areas...


&gt;<i>  Currently my plan is to throw hardware at problem.  The traditional way to
</I>&gt;<i>  expand would be to add an additional webserver and do DNS round robin, or
</I>&gt;<i>  something like that.  Unfortunately this would cause database problems for
</I>&gt;<i>  me.  Top of my todo list is to swap out psycopg and use sqlrelay but I don't
</I>&gt;<i>  have enough time to do this quickly.  So... I am now considering switching to
</I>&gt;<i>  a dual cpu system.  I would keep apache in prefork mode-- I have read that
</I>&gt;<i>  this works fine on systems with 2 processors.
</I>&gt;<i>
</I>
Could you be more specific about the database problems you're
anticipating?  Are you worried about the database server being able to
scale as well?


You might also want to look at caching solutions, especially if you
have plenty of RAM :)  You could probably roll your own with Memcached
without too much trouble, and this could potentially ease the load on
the CPU quite a bit.

Colin
</PRE>













<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025180.html">[mod_python] need help solving some performance issues
</A></li>
	<LI>Next message: <A HREF="025169.html">[mod_python] need help solving some performance issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25167">[ date ]</a>
              <a href="thread.html#25167">[ thread ]</a>
              <a href="subject.html#25167">[ subject ]</a>
              <a href="author.html#25167">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
