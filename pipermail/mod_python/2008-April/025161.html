<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] need help solving some performance issues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20need%20help%20solving%20some%20performance%20issues&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025174.html">
   <LINK REL="Next"  HREF="025162.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] need help solving some performance issues</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Culley Harrelson</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20need%20help%20solving%20some%20performance%20issues&In-Reply-To="
       TITLE="[mod_python] need help solving some performance issues">harrelson at gmail.com
       </A><BR>
    <I>Thu Apr 10 12:57:26 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="025174.html">[mod_python] Newbie Question
</A></li>
        <LI>Next message: <A HREF="025162.html">[mod_python] need help solving some performance issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25161">[ date ]</a>
              <a href="thread.html#25161">[ thread ]</a>
              <a href="subject.html#25161">[ subject ]</a>
              <a href="author.html#25161">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I manage a mod_python application that was built about 4 years ago and has
not changed much since.  It uses clearsilver templates and interacts with
postgresql via psychopg.  The database is on a second machine and the
mod_python machine (FreeBSD) has no other major applications.  

The application is much more popular than it was when it was built and I am
now encountering some performance problems.  Specifically the CPU seems to be
the bottleneck.  The machine has 2 gigs of ram and a single processor.  Ram
doesn't seem to be a problem.  When examining top output, I see that every
once in a while a process comes along and sucks down 10%-20% of the cpu.  A
handful of these processes can (and regularly do) consume the whole CPU.

I don't really know how to go about optimizing the CPU usage of my
application.  Any suggestions are extremely welcome.  

Currently my plan is to throw hardware at problem.  The traditional way to
expand would be to add an additional webserver and do DNS round robin, or
something like that.  Unfortunately this would cause database problems for
me.  Top of my todo list is to swap out psycopg and use sqlrelay but I don't
have enough time to do this quickly.  So... I am now considering switching to
a dual cpu system.  I would keep apache in prefork mode-- I have read that
this works fine on systems with 2 processors.

Which leads me to my main question.  Is this a valid approach?  Assuming the
CPU is the only bottleneck will this double my capacity?

All comments, advice, opinions are welcome and appreciated.

ch
</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025174.html">[mod_python] Newbie Question
</A></li>
	<LI>Next message: <A HREF="025162.html">[mod_python] need help solving some performance issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25161">[ date ]</a>
              <a href="thread.html#25161">[ thread ]</a>
              <a href="subject.html#25161">[ subject ]</a>
              <a href="author.html#25161">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
