<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Session.py and &quot;secret&quot; parameter. Is it secure?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Session.py%20and%20%22secret%22%20parameter.%20Is%20it%20secure%3F&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016030.html">
   <LINK REL="Next"  HREF="016049.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Session.py and &quot;secret&quot; parameter. Is it secure?</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Brian Bird</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Session.py%20and%20%22secret%22%20parameter.%20Is%20it%20secure%3F&In-Reply-To="
       TITLE="[mod_python] Session.py and &quot;secret&quot; parameter. Is it secure?">brian.bird at securetrading.com
       </A><BR>
    <I>Wed Aug 11 11:44:39 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="016030.html">[mod_python] Stopping Reimports
</A></li>
        <LI>Next message: <A HREF="016049.html">[mod_python] Session.py and &quot;secret&quot; parameter. Is it secure?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16028">[ date ]</a>
              <a href="thread.html#16028">[ thread ]</a>
              <a href="subject.html#16028">[ subject ]</a>
              <a href="author.html#16028">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm implementing a session-based login system using mod_python. I decided to
use SignedCookie because the cookie will contain the login name of the
authenticated user and I therefore need to ensure the cookie has not been
tampered with on the client (If there's a better way to do this kind of
thing could someone point me in the right direction?).

If I create a session using the following command: 
s=Session.DbmSession(self.req, secret=&quot;mysecret&quot;) 

then the session will be created using SignedCookie. If on a subsequent
request I perform the same command I get back the same session. Everything
is fine so far.

However, if I change the value of &quot;mysecret&quot; I thought I would get an error
(since this is equivalent to someone tampering with the signed cookie isn't
it?). The command works though. 

I see from looking at Session.py that a SignedCookie is created (line 111 in
Session.py), but it's type is not checked (the documentation says you should
check the type to ensure it is SignedCookie not Cookie, otherwise the
signature verification has failed). The variable &quot;cookies&quot; normally contains
a SignedCookie object, but when I change &quot;mysecret&quot; it contains a Cookie
object.

Does this mean that the cookie signature is not being verified correctly if
using Session.py or am I missing something? 

Why does SignedCookie return an instance of Cookie if the signature
verification fails rather than raising an Exception?

Thanks, 
Brian 



</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016030.html">[mod_python] Stopping Reimports
</A></li>
	<LI>Next message: <A HREF="016049.html">[mod_python] Session.py and &quot;secret&quot; parameter. Is it secure?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16028">[ date ]</a>
              <a href="thread.html#16028">[ thread ]</a>
              <a href="subject.html#16028">[ subject ]</a>
              <a href="author.html#16028">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
