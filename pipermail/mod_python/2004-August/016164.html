<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Lifespan of objects
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Lifespan%20of%20objects&In-Reply-To=1606C1F9-F22B-11D8-9860-000A95AC6C3C%40Memora.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016154.html">
   <LINK REL="Next"  HREF="016165.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Lifespan of objects</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Nick</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Lifespan%20of%20objects&In-Reply-To=1606C1F9-F22B-11D8-9860-000A95AC6C3C%40Memora.com"
       TITLE="[mod_python] Lifespan of objects">nick at dd.revealed.net
       </A><BR>
    <I>Fri Aug 20 10:12:42 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="016154.html">[mod_python] Lifespan of objects
</A></li>
        <LI>Next message: <A HREF="016165.html">[mod_python] AuthName
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16164">[ date ]</a>
              <a href="thread.html#16164">[ thread ]</a>
              <a href="subject.html#16164">[ subject ]</a>
              <a href="author.html#16164">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Try calling gc.collect() occasionally, assuming the connections can be 
collected.  Don't know if the db module keeps an internal list of 
connections or not.  If it does, then forcing garbage collection may not 
help.  The 3rd module that has a connection pool may be your only hope in 
that case.

Nick

Antonio Rodriguez wrote:

&gt;&gt;<i> When I started playing with DB API stuff I thought that destruction
</I>&gt;&gt;<i> would close the connection, but it didn't seem to. I had to
</I>&gt;&gt;<i> specifically close them.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> How do you specifically close them especially when mod_python is 
</I>&gt;<i> performing the module reload automatically? Is there some sort of unload 
</I>&gt;<i> hook?
</I>&gt;<i> 
</I>&gt;<i> I can think that an alternative is to put all of the db connection code 
</I>&gt;<i> in a dbmodule.py and then import from there for the script your working 
</I>&gt;<i> on. Since this dbmodule.py will not change as you work on your code, its 
</I>&gt;<i> global dict (and therefore your connection object) should stay in scope 
</I>&gt;<i> the whole time (unless you change dbmodule.py).
</I>&gt;<i> 
</I>&gt;<i> Does this make sense?
</I>&gt;<i> 
</I>&gt;<i> AR
</I>&gt;<i> 
</I>&gt;<i> On Aug 19, 2004, at 5:47 PM, Nic Ferrier wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> Svenne Krap &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">svenne at krap.dk</A>&gt; writes:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I don't realize how I am using a single connection in parallel.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> While running apache, it forks new processes if there are simultanious
</I>&gt;&gt;&gt;<i> connections. Each of these should open exactly one connection and
</I>&gt;&gt;&gt;<i> use that.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Sorry, I missed what mpm you were using.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I thought, that my example was a simple connection pool (I never need
</I>&gt;&gt;&gt;<i> more than one cursor open per process anyhow), if I am in error, please
</I>&gt;&gt;&gt;<i> provide pointers to a good connection pool (I haven't been able to
</I>&gt;&gt;&gt;<i> locate any through google. Just a mailing-list suggestion that resembles
</I>&gt;&gt;&gt;<i> my solution).
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> It seems however, when I modify the .py-file the amount of connections
</I>&gt;&gt;&gt;<i> grow. Is my program &quot;losing&quot; connections when the module is reloaded
</I>&gt;&gt;&gt;<i> ?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> If you modify the .py I'm sure you'll lose them. The old instances
</I>&gt;&gt;<i> will go out of scope and not be closed.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> When I started playing with DB API stuff I thought that destruction
</I>&gt;&gt;<i> would close the connection, but it didn't seem to. I had to
</I>&gt;&gt;<i> specifically close them.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Nic
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Mod_python mailing list
</I>&gt;&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;&gt;<i>
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>
</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016154.html">[mod_python] Lifespan of objects
</A></li>
	<LI>Next message: <A HREF="016165.html">[mod_python] AuthName
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16164">[ date ]</a>
              <a href="thread.html#16164">[ thread ]</a>
              <a href="subject.html#16164">[ subject ]</a>
              <a href="author.html#16164">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
