<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] PSP buffer?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20PSP%20buffer%3F&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016137.html">
   <LINK REL="Next"  HREF="016040.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] PSP buffer?</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Jim Dabell</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20PSP%20buffer%3F&In-Reply-To="
       TITLE="[mod_python] PSP buffer?">jim-mod-python at jimdabell.com
       </A><BR>
    <I>Thu Aug 12 18:37:17 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="016137.html">[mod_python] The right way to handle sessions
</A></li>
        <LI>Next message: <A HREF="016040.html">[mod_python] PSP buffer?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16039">[ date ]</a>
              <a href="thread.html#16039">[ thread ]</a>
              <a href="subject.html#16039">[ subject ]</a>
              <a href="author.html#16039">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
I'm just getting stuck into mod_python, and I've hit a bit of a snag.  I am 
writing a handler, but would like to use PSP to construct a few pages.  So 
I'm instantiating a PSP object, and using its run() method to execute it.

Unfortunately, that just repeatedly calls req.write(), which doesn't give me 
the opportunity to perform any operations on the result before it is sent to 
the client, or even output additional headers afterwards.  For instance, I 
can't find a way of producing a Content-Length header, or using content 
encoding to gzip the response body.  run() actually calls req.write with 
flush=0, but then explicitly calls flush() afterwards.

For the moment, I'm working around this by passing a proxy object that 
intercepts write() and flush() to the PSP constructor.  This seems like a 
pretty fragile hack to me though, and I was wondering if there was a better 
way of accomplishing what I am after, or plans to make PSP more flexible in 
later releases.

As far as I can tell, my only other options are:

a) Dump PSP
b) Alter psp.py
c) Dump my handler and use the PSP handler.

None of these are particularly attractive options to me.  Does anybody have 
any better suggestions?  Google, the FAQ and the manual didn't turn up 
anything particularly inspiring.

-- 
Jim Dabell

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016137.html">[mod_python] The right way to handle sessions
</A></li>
	<LI>Next message: <A HREF="016040.html">[mod_python] PSP buffer?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16039">[ date ]</a>
              <a href="thread.html#16039">[ thread ]</a>
              <a href="subject.html#16039">[ subject ]</a>
              <a href="author.html#16039">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
