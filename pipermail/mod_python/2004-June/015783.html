<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Returning HTTP_MULTI_STATUS from a custom handler
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Returning%20HTTP_MULTI_STATUS%20from%20a%20custom%20handler&In-Reply-To=1087224196.19670.11.camel%40hercules.dustbite.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015780.html">
   <LINK REL="Next"  HREF="015784.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Returning HTTP_MULTI_STATUS from a custom handler</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Gregory (Grisha) Trubetskoy</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Returning%20HTTP_MULTI_STATUS%20from%20a%20custom%20handler&In-Reply-To=1087224196.19670.11.camel%40hercules.dustbite.org"
       TITLE="[mod_python] Returning HTTP_MULTI_STATUS from a custom handler">grisha at modpython.org
       </A><BR>
    <I>Mon Jun 14 14:24:19 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="015780.html">[mod_python] Returning HTTP_MULTI_STATUS from a custom handler
</A></li>
        <LI>Next message: <A HREF="015784.html">[mod_python] Returning HTTP_MULTI_STATUS from a custom handler
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15783">[ date ]</a>
              <a href="thread.html#15783">[ thread ]</a>
              <a href="subject.html#15783">[ subject ]</a>
              <a href="author.html#15783">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Indrek

If you want Apache to handle the error, you return it the error code. This
will result in the behaviour you are seeing (an error page and a status of
200).

If you do not want Apache to handle the error (and in your case you do
not), then set req.status yourself, write the necessary output (e.g. some
html describing the error)  if any, and return apache.OK.

So the code you're looking for is:

def handler(req):
    req.status = apache.HTTP_MULTI_STATUS
    req.content_type = 'text/plain; charset=UTF-8&quot;
    req.write('hi!')
    return apache.OK

This may seem confusing at first, but if you think about it it actually
makes pretty good sense. :-)

Grisha

On Mon, 14 Jun 2004, Indrek [ISO-8859-1] J?rve wrote:

&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I'm currently working on creating a WebDAV implementation in mod_python.
</I>&gt;<i> To achieve this, I've written a custom request handler which does the
</I>&gt;<i> work required for each request and returns the defined status code
</I>&gt;<i> according to WebDAV spec. However, whenever I try to return
</I>&gt;<i> apache.HTTP_MULTI_STATUS (required by some response types), something
</I>&gt;<i> funky happens. A standard apache &quot;internal error occured&quot; gets appended
</I>&gt;<i> to the client output, and apache return code gets changed to 200. It's
</I>&gt;<i> rather easy to duplicate, a minimal handler like below reproduces it on
</I>&gt;<i> my Suse 9.0/mod_python 3.0 box.
</I>&gt;<i>
</I>&gt;<i> TestPublisher.py:
</I>&gt;<i>
</I>&gt;<i> from mod_python import apache
</I>&gt;<i>
</I>&gt;<i> def handler(req):
</I>&gt;<i>     req.content_type = 'text/plain; charset=UTF-8&quot;
</I>&gt;<i>     req.write('hi!')
</I>&gt;<i>     return apache.HTTP_MULTI_STATUS
</I>&gt;<i>
</I>&gt;<i> Am I doing something awfully wrong or is this a general problem?
</I>&gt;<i>
</I>&gt;<i> Regards,
</I>&gt;<i> Indrek
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i>
</I></PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015780.html">[mod_python] Returning HTTP_MULTI_STATUS from a custom handler
</A></li>
	<LI>Next message: <A HREF="015784.html">[mod_python] Returning HTTP_MULTI_STATUS from a custom handler
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15783">[ date ]</a>
              <a href="thread.html#15783">[ thread ]</a>
              <a href="subject.html#15783">[ subject ]</a>
              <a href="author.html#15783">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
