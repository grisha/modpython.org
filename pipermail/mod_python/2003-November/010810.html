<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Form-based authentication using mod_puthon / Apache
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Form-based%20authentication%20using%20mod_puthon%20/%20Apache&In-Reply-To=C0FC22C08B82074A88B500617641577787A7CB%40johnson.mediapulse.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010809.html">
   <LINK REL="Next"  HREF="010811.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
<table border=0 width="100%"><tr><td valign="top">
   <H1>[mod_python] Form-based authentication using mod_puthon / Apache</H1>
    <B>Simon Willison</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Form-based%20authentication%20using%20mod_puthon%20/%20Apache&In-Reply-To=C0FC22C08B82074A88B500617641577787A7CB%40johnson.mediapulse.net"
       TITLE="[mod_python] Form-based authentication using mod_puthon / Apache">cs1spw at bath.ac.uk
       </A><BR>
    <I>Mon Nov 24 13:56:15 EST 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="010809.html">[mod_python] Form-based authentication using mod_puthon / Apache
</A></li>
        <LI>Next message: <A HREF="010811.html">[mod_python] Form-based authentication using mod_puthon / Apache
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10810">[ date ]</a>
              <a href="thread.html#10810">[ thread ]</a>
              <a href="subject.html#10810">[ subject ]</a>
              <a href="author.html#10810">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Michael C. Neel wrote:
&gt;<i> ...now when we decode the cookie...
</I>&gt;<i> 
</I>&gt;<i> 1.  base64 decode it, and check our md5 sig
</I>&gt;<i> 2.  ungzip the string and parse it back to it's object/string form
</I>&gt;<i> 3.  make sure the IP, user-agent match the current request
</I>&gt;<i> 4.  make sure the timestamp is within our limit for a login
</I>
One potential problem with checking the IP is that some people access 
the internet through a rotating proxy, meaning that subsequent requests 
might come from a different IP address (I've heard AOL does this). One 
way around this would be to check that at least the first two parts of 
the IP address stayed the same as only the last two would be likely to 
change if a rotating proxy was in use.

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010809.html">[mod_python] Form-based authentication using mod_puthon / Apache
</A></li>
	<LI>Next message: <A HREF="010811.html">[mod_python] Form-based authentication using mod_puthon / Apache
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10810">[ date ]</a>
              <a href="thread.html#10810">[ thread ]</a>
              <a href="subject.html#10810">[ subject ]</a>
              <a href="author.html#10810">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
