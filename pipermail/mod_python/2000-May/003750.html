<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] quick code review
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20quick%20code%20review&In-Reply-To=Pine.LNX.4.10.10005251801100.16846-100000%40nebula.lyra.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003723.html">
   <LINK REL="Next"  HREF="003752.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] quick code review</H1>
    <B>Gregory Trubetskoy</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20quick%20code%20review&In-Reply-To=Pine.LNX.4.10.10005251801100.16846-100000%40nebula.lyra.org"
       TITLE="[mod_python] quick code review">grisha at modpython.org
       </A><BR>
    <I>Mon May 29 11:44:15 EST 2000</I>
    <P><UL>
        <LI>Previous message: <A HREF="003723.html">[mod_python] quick code review
</A></li>
        <LI>Next message: <A HREF="003752.html">[mod_python] quick code review
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3750">[ date ]</a>
              <a href="thread.html#3750">[ thread ]</a>
              <a href="subject.html#3750">[ subject ]</a>
              <a href="author.html#3750">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<table border=0 width="100%"><tr><td>
<!--beginarticle-->
<PRE>On Thu, 25 May 2000, Greg Stein wrote:

&gt;<i> *) rather than storing the &quot;request object&quot; into r-&gt;notes, place it into
</I>&gt;<i>    tstate-&gt;dict. you won't have to do the atoi() stuff (which is Bad
</I>&gt;<i>    anyways)
</I>
This won't work. Or rather it will, but it's getting too complex to be
worth it. 

The problem is that a single request can span multiple thread states - a
typical scenario is when there is a PythonAuthenHandler directive
somewhere in a parent directory and a PythonHandler directive in a
subdirectory. The two handlers will be executed in different
subinterpreters, thereofre having different tstates and result in two
separate requestobjects being instantiated. 

So you get the malloc penalty plus the complexity of dealing with the
tstate-&gt;dict dictionary (which too will need to be created, another
malloc) for not much of a practical gain other than proper code, which,
btw, becomes kind of arcane and hard to understand (a bad thing as well).

It seems to me that I am working around what is really an Apache
limitation. The request_rec is clearly the right place to store a pointer
to a requestobject for that request_rec, the limitation is that the place
alloted for these sorts of things (r-&gt;notes) only deals with strings.

I think there needs to be something similar to r-&gt;notes that can take a
pointer. For now, I think I'm going to revert to the atoi stuff...

Grisha


</PRE>
<!--endarticle-->
</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003723.html">[mod_python] quick code review
</A></li>
	<LI>Next message: <A HREF="003752.html">[mod_python] quick code review
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3750">[ date ]</a>
              <a href="thread.html#3750">[ thread ]</a>
              <a href="subject.html#3750">[ subject ]</a>
              <a href="author.html#3750">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
