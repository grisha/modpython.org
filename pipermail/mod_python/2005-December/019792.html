<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Configuring mod_python via reverse proxy
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Configuring%20mod_python%20via%20reverse%20proxy&In-Reply-To=1134705769.21065%40dscpl.user.openhosting.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019791.html">
   <LINK REL="Next"  HREF="019806.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Configuring mod_python via reverse proxy</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Roberto Sanchez</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Configuring%20mod_python%20via%20reverse%20proxy&In-Reply-To=1134705769.21065%40dscpl.user.openhosting.com"
       TITLE="[mod_python] Configuring mod_python via reverse proxy">roberto at familiasanchez.net
       </A><BR>
    <I>Thu Dec 15 23:07:12 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="019791.html">[mod_python] Configuring mod_python via reverse proxy
</A></li>
        <LI>Next message: <A HREF="019806.html">[mod_python] Where is the referrer found?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19792">[ date ]</a>
              <a href="thread.html#19792">[ thread ]</a>
              <a href="subject.html#19792">[ subject ]</a>
              <a href="author.html#19792">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Graham Dumpleton wrote:
&gt;<i> 
</I>&gt;<i> Yes, except that there are really two issues here. The first as you
</I>&gt;<i> highlight is that all scripts run as the same user.
</I>&gt;<i> 
</I>&gt;<i> The bigger immediate problem is the potential cross pollution of Python
</I>&gt;<i> modules and the visibility of another users Python modules within the
</I>&gt;<i> executing process. This will occur where requests for each user are
</I>&gt;<i> handled within the context of one Python interpreter instance, which is
</I>&gt;<i> the default if both users requests are handled within the context of the
</I>&gt;<i> same virtual host.
</I>&gt;<i> 
</I>&gt;<i> With a bit of work, one could specify in the main Apache configuration
</I>&gt;<i> file that each user has a distinct interpreter using PythonInterpreter
</I>&gt;<i> directive, but there is no way of stopping the user changing it to
</I>&gt;<i> something else in .htaccess file, bar preventing the use of .htaccess
</I>&gt;<i> file altogether.
</I>&gt;<i> 
</I>&gt;<i> The consequence of this is that I could use PythonInterpreter to name
</I>&gt;<i> some other users interpreter and create special handlers that allowed
</I>&gt;<i> me to then browse all his loaded modules looking for senstive data
</I>&gt;<i> such as login details, or cached data out of a database etc.
</I>&gt;<i> 
</I>&gt;<i> What is really required in mod_python is a way for an administrator to
</I>&gt;<i> set PythonInterpreter in the main Apache configuration differently for
</I>&gt;<i> differently parts of the URL namespace and then set some other option
</I>&gt;<i> to say that it cannot be overridden in a .htaccess file at all.
</I>&gt;<i> 
</I>&gt;<i> This way the administrator has better control and can ensure some
</I>&gt;<i> seperation. I'm not sure though whether there is a means by which it
</I>&gt;<i> could be added to mod_python such that this could be done. Would need
</I>&gt;<i> some digging into the Apache internals.
</I>&gt;<i> 
</I>&gt;<i> This wouldn't solve the problem completely though, as the fact that
</I>&gt;<i> all users code runs as the same actual user, means that you could just
</I>&gt;<i> read the source code in direct as text and steal it that way. This means
</I>&gt;<i> someone is doing it deliberately, but at present with how mod_python
</I>&gt;<i> works, the cross pollution of in memory modules can lead to unexpected
</I>&gt;<i> behaviour without even trying. Hopefully mod_python 3.3 will solve this
</I>&gt;<i> with the module importing system being reimplemented.
</I>&gt;<i> 
</I>&gt;<i> So yes, your concerns are quite valid and no there aren't any simple
</I>&gt;<i> answers. :-(
</I>&gt;<i> 
</I>&gt;<i> Graham
</I>&gt;<i> 
</I>
That is why I was attempting to get the mod_python behind a reverse 
proxy to work.  At least that way, the apache instance is running as the 
user that owns the python modules.  There are also implications there, 
but those are more easily solved.  In the future, I will try and go with 
a complete virtual server approach, but my machine's resources will not 
allow that now.

Anyhow, thanks for all the great insight.

-Roberto

-- 
Roberto C. Sanchez
<A HREF="http://familiasanchez.net/~roberto">http://familiasanchez.net/~roberto</A>
</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019791.html">[mod_python] Configuring mod_python via reverse proxy
</A></li>
	<LI>Next message: <A HREF="019806.html">[mod_python] Where is the referrer found?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19792">[ date ]</a>
              <a href="thread.html#19792">[ thread ]</a>
              <a href="subject.html#19792">[ subject ]</a>
              <a href="author.html#19792">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
