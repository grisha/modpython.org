<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Problem with PythonImport
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Problem%20with%20PythonImport&In-Reply-To=200512261844.49069.bluszcz%40jabberpl.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019826.html">
   <LINK REL="Next"  HREF="019828.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Problem with PythonImport</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Problem%20with%20PythonImport&In-Reply-To=200512261844.49069.bluszcz%40jabberpl.org"
       TITLE="[mod_python] Problem with PythonImport">grahamd at dscpl.com.au
       </A><BR>
    <I>Mon Dec 26 22:56:36 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="019826.html">[mod_python] Problem with PythonImport
</A></li>
        <LI>Next message: <A HREF="019828.html">[mod_python] Collecting GET and POST vars
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19827">[ date ]</a>
              <a href="thread.html#19827">[ thread ]</a>
              <a href="subject.html#19827">[ subject ]</a>
              <a href="author.html#19827">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>You still need to import your module in your PSP code. All the  
PythonImport
statement does is preload the module prior to any request being handled
such that code with side effects can be done early. Just like any  
other Python
module, it has to use &quot;import&quot; statement to import anything it wants  
to use,
even if already imported by some other separate module/code. More  
comments
below.

On 27/12/2005, at 4:44 AM, Rafal Zawadzki wrote:

&gt;<i> Hi. At the beginning I have to say that I read:
</I>&gt;<i>
</I>&gt;<i> * thread called &quot;PythonImport: Can someone please draw a diagram  
</I>&gt;<i> for this
</I>&gt;<i> idiot?&quot; and others similar ;&gt;
</I>&gt;<i> * documentation about PythonImport
</I>&gt;<i>
</I>&gt;<i> I am writing web application using modpython 3.1 + psp. I am using  
</I>&gt;<i> apache2, my
</I>&gt;<i> apache2.conf contains:
</I>&gt;<i>
</I>&gt;<i> PythonImport Baza glam.idoru
</I>&gt;<i> PythonOptimize on
</I>&gt;<i>
</I>&gt;<i> and file of my virtual host contains:
</I>&gt;<i>
</I>&gt;<i> &lt;Directory /home/bluszcz/www/glam.idoru&gt;
</I>&gt;<i> DirectoryIndex index.psp index.html
</I>&gt;<i> AddHandler mod_python .psp
</I>&gt;<i> PythonHandler mod_python.psp
</I>&gt;<i> PythonDebug On
</I>&gt;<i> PythonPath &quot;sys.path+['/home/bluszcz/www/glam.idoru']&quot;
</I>&gt;<i> AllowOverride None
</I>&gt;<i> &lt;/Directory&gt;
</I>&gt;<i>
</I>&gt;<i> cat testimport.py
</I>&gt;<i>
</I>&gt;<i> &lt;%
</I>
import Baza

&gt;<i> req.write(str(dir()))
</I>&gt;<i> req.write(&quot;&lt;br /&gt;&quot;)
</I>&gt;<i> req.write(str(req.interpreter))
</I>&gt;<i> %&gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> links -dump <A HREF="http://glam.idoru/admin/testimport.psp">http://glam.idoru/admin/testimport.psp</A>
</I>&gt;<i>
</I>&gt;<i> gives me:
</I>&gt;<i>
</I>&gt;<i> ['FileCache', 'HitsCache', 'PSP', 'PSPInterface', 'Session',  
</I>&gt;<i> '__builtins__',
</I>&gt;<i> '__doc__', '__file__', '__mtime__', '__name__', '_apache', '_psp',  
</I>&gt;<i> 'anydbm',
</I>&gt;<i> 'apache', 'code2str', 'dbm_cache_get', 'dbm_cache_store',  
</I>&gt;<i> 'dbm_cache_type',
</I>&gt;<i> 'dbm_types', 'escape', 'form', 'handler', 'marshal', 'mem_fcache',
</I>&gt;<i> 'mem_scache', 'new', 'os', 'parse', 'parsestring', 'path_split',  
</I>&gt;<i> 'psp',
</I>&gt;<i> 'req', 'session', 'str2code', 'sys', 'tempdir', 'tempfile', 'util',
</I>&gt;<i> 'whichdb']
</I>&gt;<i> glam.idoru
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> My question is how can I get to my &quot;Baza&quot; module? I am trying to  
</I>&gt;<i> use it with
</I>&gt;<i> persisten database connection (there is no enough docs about it!).  
</I>&gt;<i> Module
</I>&gt;<i> Baza is has been loaded (i tried to put into this command creating  
</I>&gt;<i> dir, and
</I>&gt;<i> it works).
</I>
There are downsides to using PythonImport to initialise database  
connections
as a side effect. Namely, if it fails, if you don't have fallback  
means of having the
database connections initialised, you have to restart Apache. Thus,  
you need
to make sure you do it properly.

See mailing list threads:

   <A HREF="http://www.modpython.org/pipermail/mod_python/2005-October/">http://www.modpython.org/pipermail/mod_python/2005-October/</A> 
019287.html
   <A HREF="http://www.modpython.org/pipermail/mod_python/2005-September/">http://www.modpython.org/pipermail/mod_python/2005-September/</A> 
019092.html

Also be aware that current versions of mod_python have various issues  
with
module importing in general, see:

   <A HREF="http://www.dscpl.com.au/articles/modpython-003.html">http://www.dscpl.com.au/articles/modpython-003.html</A>

Graham

  
  
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019826.html">[mod_python] Problem with PythonImport
</A></li>
	<LI>Next message: <A HREF="019828.html">[mod_python] Collecting GET and POST vars
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19827">[ date ]</a>
              <a href="thread.html#19827">[ thread ]</a>
              <a href="subject.html#19827">[ subject ]</a>
              <a href="author.html#19827">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
