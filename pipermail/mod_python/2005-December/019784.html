<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Apache processes &quot;eating up&quot; too much memory (leak?)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Apache%20processes%20%22eating%20up%22%20too%20much%20memory%20%28leak%3F%29&In-Reply-To=1134688020.611%40dscpl.user.openhosting.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019783.html">
   <LINK REL="Next"  HREF="019795.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Apache processes &quot;eating up&quot; too much memory (leak?)</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Jim Gallacher</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Apache%20processes%20%22eating%20up%22%20too%20much%20memory%20%28leak%3F%29&In-Reply-To=1134688020.611%40dscpl.user.openhosting.com"
       TITLE="[mod_python] Apache processes &quot;eating up&quot; too much memory (leak?)">jpg at jgassociates.ca
       </A><BR>
    <I>Thu Dec 15 18:41:58 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="019783.html">[mod_python] Apache processes &quot;eating up&quot; too much memory (leak?)
</A></li>
        <LI>Next message: <A HREF="019795.html">[mod_python] Apache processes &quot;eating up&quot; too much memory (leak?)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19784">[ date ]</a>
              <a href="thread.html#19784">[ thread ]</a>
              <a href="subject.html#19784">[ subject ]</a>
              <a href="author.html#19784">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The leak in 3.1.4 resulted from the use of the PythonOption directive. 
Around 25 bytes was lost for each directive on each request. This was 
pretty small, but does add up when you really hammer the server. Check 
the following JIRA issues for details:

<A HREF="http://issues.apache.org/jira/browse/MODPYTHON-60">http://issues.apache.org/jira/browse/MODPYTHON-60</A>
<A HREF="http://issues.apache.org/jira/browse/MODPYTHON-75">http://issues.apache.org/jira/browse/MODPYTHON-75</A>

You want 3.2.5b all the way.

Jim


Graham Dumpleton wrote:
&gt;<i> FWIW, you might consider upgrading to mod_python 3.2.5b if you can. I
</I>&gt;<i> believe that that version eliminates a few memory leaks in certain
</I>&gt;<i> circumstances in mod_python itself, although I don't remember the
</I>&gt;<i> details. This may or may not be contributing. My understanding was that
</I>&gt;<i> the mod_python leaks weren't that great, but if you are handling a lot
</I>&gt;<i> of requests it may be noticeable. You also may want to configure Apache
</I>&gt;<i> to recycle child processes after a certain number of requests to avoid
</I>&gt;<i> overblown processes.
</I>&gt;<i> 
</I>&gt;<i> Sorry, I know this doesn't really help with tracking down the source of
</I>&gt;<i> any problem if in your code. :-)
</I>&gt;<i> 
</I>&gt;<i> Graham
</I>&gt;<i> 
</I>&gt;<i> =?ISO-8859-1?Q?S=E9bastien_Arnaud?= wrote ..
</I>&gt;<i> 
</I>&gt;&gt;<i>Hello!
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>I am running mod_python on 2 identical production server for 2 small  
</I>&gt;&gt;<i>apps I wrote which basically render over 100 of different SVG charts. 
</I>&gt;&gt;<i>I am running Gentoo on those servers, mod_python 3.1.4, apache 2.0.55 
</I>&gt;&gt;<i>in prefork mode, each server has 1 Go of mem.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>Both applications have been in beta testing for like 1 month or so,  
</I>&gt;&gt;<i>and I just noticed today that the memory usage was really high for  
</I>&gt;&gt;<i>each apache process running (max of 10 set in the conf file). When I  
</I>&gt;&gt;<i>started those apache process 30 days ago they stabilize at 2.0 % of  
</I>&gt;&gt;<i>memory used, but somehow after 30 days of users testing the app, it  
</I>&gt;&gt;<i>went to 10% per apache process, which made the swap usage go to 1Go  
</I>&gt;&gt;<i>(over 2Go avail). I am doing quite a lot of caching of XSL files in  
</I>&gt;&gt;<i>the app, but this is suppose to happen at launch time, meaning I  
</I>&gt;&gt;<i>instantiate all the objects I need at the first call of the  
</I>&gt;&gt;<i>mod_python handler and they persist through the life of those apache  
</I>&gt;&gt;<i>processes. Does somebody know anyway to inspect each apache process  
</I>&gt;&gt;<i>to see where the memory is being used? Basically I am trying here to  
</I>&gt;&gt;<i>figure out if I have some kind of memory leak going on, or if there  
</I>&gt;&gt;<i>is something I miscalculated when caching the large amount of XSL  
</I>&gt;&gt;<i>files in persistent Python objects.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>Apart from that, those 2 little applications fly in terms of speed! A 
</I>&gt;&gt;<i>lot of people (including me) got really blown away to witness the  
</I>&gt;&gt;<i>speed of those 2 apps on those &quot;old&quot; servers (which are quad PIII  
</I>&gt;&gt;<i>550Mhz btw).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>Thank you in advance for any insights so that I can get to the bottom 
</I>&gt;&gt;<i>of this!
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>Cheers!
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>S&#233;bastien Arnaud
</I>&gt;&gt;<i>eMedia Library, inc
</I>&gt;&gt;<i><A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">sebastien at emedialibrary.org</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>_______________________________________________
</I>&gt;&gt;<i>Mod_python mailing list
</I>&gt;&gt;<i><A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;&gt;<i><A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>------------------------------------------------------------------------
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>_______________________________________________
</I>&gt;&gt;<i>Mod_python mailing list
</I>&gt;&gt;<i><A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;&gt;<i><A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>
</PRE>














<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019783.html">[mod_python] Apache processes &quot;eating up&quot; too much memory (leak?)
</A></li>
	<LI>Next message: <A HREF="019795.html">[mod_python] Apache processes &quot;eating up&quot; too much memory (leak?)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19784">[ date ]</a>
              <a href="thread.html#19784">[ thread ]</a>
              <a href="subject.html#19784">[ subject ]</a>
              <a href="author.html#19784">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
