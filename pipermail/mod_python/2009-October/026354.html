<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] handler module loading/execution phases
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20handler%20module%20loading/execution%20phases&In-Reply-To=4AD45EF1.4020107%40playstos.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026353.html">
   <LINK REL="Next"  HREF="026355.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] handler module loading/execution phases</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20handler%20module%20loading/execution%20phases&In-Reply-To=4AD45EF1.4020107%40playstos.com"
       TITLE="[mod_python] handler module loading/execution phases">graham.dumpleton at gmail.com
       </A><BR>
    <I>Tue Oct 13 07:15:03 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="026353.html">[mod_python] handler module loading/execution phases
</A></li>
        <LI>Next message: <A HREF="026355.html">[mod_python] handler module loading/execution phases
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26354">[ date ]</a>
              <a href="thread.html#26354">[ thread ]</a>
              <a href="subject.html#26354">[ subject ]</a>
              <a href="author.html#26354">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Apache/mod_python on UNIX is multi process and therefore requests
don't necessarily go back to the same process. Also, if using worker
MPM, that code isn't thread safe and so technically multiple threads
updating global variable at same time could not see it being
incremented as you expect.

It is also possible for Apache processes to be recycled both at the
whim of Apache, but also explicitly if MaxRequestsPerChild is set to
be non zero in Apache configuration files.

BTW, if you have PythonDebug set to On, then the error logs should
display messages about when mod_python loads or reloads mod_python
handler module files.

Graham

2009/10/13 Alessandro de Manzano &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">demanzano at playstos.com</A>&gt;:
&gt;<i> Hello,
</I>&gt;<i>
</I>&gt;<i> I'm using ModPyhton 3.3.1 with Apache 2.2.13 and I'm developing a simple
</I>&gt;<i> RESTful-like custom webservice.
</I>&gt;<i>
</I>&gt;<i> All is working correctly, but I'm investigating some &quot;optimization&quot; issues.
</I>&gt;<i>
</I>&gt;<i> In particular, it's not clear to me when/how modpython (re)loads/(re)imports
</I>&gt;<i> the handler's own .py module.
</I>&gt;<i>
</I>&gt;<i> I mean, something like that:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> testdummy.py:
</I>&gt;<i>
</I>&gt;<i> DUMMY = 0
</I>&gt;<i>
</I>&gt;<i> def handler(req):
</I>&gt;<i> &#160; &#160; &#160; &#160;global DUMMY
</I>&gt;<i> &#160; &#160; &#160; &#160;apache.log_error(&quot;dummy = %d&quot; % DUMMY, apache.APLOG_ERR, req.server)
</I>&gt;<i> &#160; &#160; &#160; &#160;DUMMY += 1
</I>&gt;<i>
</I>&gt;<i> &#160; &#160; &#160; &#160;[etc etc. simple req.write() etc.]
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &quot;testdummy.py&quot; is configured in Apache as PythonHandler:
</I>&gt;<i> &#160; &#160;[..]
</I>&gt;<i> &#160; &#160;AddHandler mod_python .py
</I>&gt;<i> &#160; &#160;PythonHandler testdummy
</I>&gt;<i> &#160; &#160;PythonDebug On # just for debug
</I>&gt;<i> &#160; &#160;PythonAutoReload On # just for debug
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I was expecting to see &quot;dummy = n&quot; where n &gt; 0 sometime in the log.. As soon
</I>&gt;<i> as the same apache process get executed again it should maintain the global
</I>&gt;<i> variable, I tought.
</I>&gt;<i> Since this does NOT happens (verified after about 100s requests) I guess the
</I>&gt;<i> &quot;testdummy.py&quot; module is re-evaluated EVERY single time, for every and each
</I>&gt;<i> request.
</I>&gt;<i> I am right ? or where am I wrong ?
</I>&gt;<i> I read the docs but apparently did not find a description of this issue
</I>&gt;<i>
</I>&gt;<i> Where can I read about the procedures/phases of module loading/evaulating of
</I>&gt;<i> handlers ?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Any hints is welcomed!
</I>&gt;<i>
</I>&gt;<i> Thanks in advance
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> A. de Manzano
</I>&gt;<i> Milano
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i>
</I>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="026353.html">[mod_python] handler module loading/execution phases
</A></li>
	<LI>Next message: <A HREF="026355.html">[mod_python] handler module loading/execution phases
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26354">[ date ]</a>
              <a href="thread.html#26354">[ thread ]</a>
              <a href="subject.html#26354">[ subject ]</a>
              <a href="author.html#26354">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
