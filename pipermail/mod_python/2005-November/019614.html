<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] returning errors from python handler and
	ErrorDocument
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20returning%20errors%20from%20python%20handler%20and%0A%09ErrorDocument&In-Reply-To=87lkzb7buh.fsf_-_%40kanga.tapsellferrier.co.uk">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019613.html">
   <LINK REL="Next"  HREF="019623.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] returning errors from python handler and
	ErrorDocument</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Jim Gallacher</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20returning%20errors%20from%20python%20handler%20and%0A%09ErrorDocument&In-Reply-To=87lkzb7buh.fsf_-_%40kanga.tapsellferrier.co.uk"
       TITLE="[mod_python] returning errors from python handler and
	ErrorDocument">jpg at jgassociates.ca
       </A><BR>
    <I>Sat Nov 26 11:47:55 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="019613.html">[mod_python] returning errors from python handler and ErrorDocument
</A></li>
        <LI>Next message: <A HREF="019623.html">[mod_python] returning errors from python handler and
	ErrorDocument
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19614">[ date ]</a>
              <a href="thread.html#19614">[ thread ]</a>
              <a href="subject.html#19614">[ subject ]</a>
              <a href="author.html#19614">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Nic Ferrier wrote:
&gt;<i> I've got a python handler that does this:
</I>&gt;<i> 
</I>&gt;<i>    # something.py
</I>&gt;<i> 
</I>&gt;<i>    def handler(http):
</I>&gt;<i>       http.status = apache.UNAUTHORIZED
</I>&gt;<i>       return apache.OK
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> And in the apache config I've got something like:
</I>&gt;<i> 
</I>&gt;<i>    &lt;Location /something&gt;
</I>&gt;<i>    SetHandler python-program
</I>&gt;<i>    PythonHandler something
</I>&gt;<i>    &lt;/Location&gt;
</I>&gt;<i> 
</I>&gt;<i>    ErrorDocument 401 /somepage.html
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> But the error document is not being served for requests to my
</I>&gt;<i> handler. I think it should because I'm returning 401.
</I>&gt;<i> 
</I>&gt;<i> Can someone enlighten me? Does the request processing just not work
</I>&gt;<i> like that?
</I>
You would think that just setting the status would suffice but this does 
not seem to be the way it works. Without actually checking I imagine 
that the client will still see the req.status you set, plus whatever 
content your handler dishes out, but you have not told apache that you 
want to interupt processing have sling some different content. You do 
this by raising an exception.

from mod_python import apache

def handler(req):
     if unknown_user(req):
         raise apache.SERVER_RETURN, apache.HTTP_UNAUTHORIZED

     if  user_is_naughty(req):
         raise apache.SERVER_RETURN, apache.HTTP_FORBIDDEN

     if user_is_asking_for_something_silly(req):
         raise apache.SERVER_RETURN, apache.HTTP_NOT_FOUND

     req.write(&quot;It's all good&quot;)
     return apache.OK

Jim



</PRE>














<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019613.html">[mod_python] returning errors from python handler and ErrorDocument
</A></li>
	<LI>Next message: <A HREF="019623.html">[mod_python] returning errors from python handler and
	ErrorDocument
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19614">[ date ]</a>
              <a href="thread.html#19614">[ thread ]</a>
              <a href="subject.html#19614">[ subject ]</a>
              <a href="author.html#19614">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
