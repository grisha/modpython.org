<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Vampire ErrorDocument
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Vampire%20ErrorDocument&In-Reply-To=e3a291250511111329j1e3c0970v526aa4dc3924fd6%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019519.html">
   <LINK REL="Next"  HREF="019521.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Vampire ErrorDocument</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Vampire%20ErrorDocument&In-Reply-To=e3a291250511111329j1e3c0970v526aa4dc3924fd6%40mail.gmail.com"
       TITLE="[mod_python] Vampire ErrorDocument">grahamd at dscpl.com.au
       </A><BR>
    <I>Fri Nov 11 22:47:39 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="019519.html">[mod_python] Vampire ErrorDocument
</A></li>
        <LI>Next message: <A HREF="019521.html">[mod_python] a novice problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19520">[ date ]</a>
              <a href="thread.html#19520">[ thread ]</a>
              <a href="subject.html#19520">[ subject ]</a>
              <a href="author.html#19520">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On 12/11/2005, at 8:29 AM, Brandon N wrote:

&gt;<i> Ive had some good luck coming to terms with Apache/mod_python/ 
</I>&gt;<i> Vampire but I've run into a snag.
</I>&gt;<i>
</I>&gt;<i> How does one setup an &quot;ErrorDocument 404 /404.py&quot; with a Vampire/ 
</I>&gt;<i> mod_python file? All my attempts (basically the first tutorial  
</I>&gt;<i> handler_html etc) are met with:
</I>&gt;<i> The requested URL /something.html was not found on this server.
</I>&gt;<i>
</I>&gt;<i> Additionally, a 403 Forbidden error was encountered while trying to  
</I>&gt;<i> use an ErrorDocument to handle the request.
</I>&gt;<i>
</I>&gt;<i> Any ideas?
</I>Vampire imposes the ideal that URLs should never use a .py extension,  
thereby
ensuring that the fact that Python is being used isn't obvious. This  
extends to
internally redirected URLs such as that specified for ErrorDocument.  
Thus, for
starters don't specify &quot;/404.py&quot; as the target URL for ErrorDocument.

For an error document call &quot;404.py&quot; containing:

   from mod_python import apache

   def handler(req):
     req.status = apache.HTTP_NOT_FOUND
     req.content_type = 'text/html'
     req.write(&quot;&lt;html&gt;&lt;body&gt;&lt;p&gt;NOT FOUND&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;&quot;)
     return apache.DONE

Use an Apache configuration of:

   Options -MultiViews
   ErrorDocument 404 /~grahamd/vampire/404

Ie., no extension on ErrorDocument URL, so handler function is called  
&quot;handler()&quot;.
Adjust actual location component of URL as appropriate.

Note that in this case it is extra important that the Apache  
MultiViews options is
disabled. It is recommended that this be disabled whenever using  
Vampire anyway,
or at least when you want URLs with no extension.

Alternatively, instead of calling it &quot;handler()&quot;, call it  
&quot;handler_html()&quot; and use:

   ErrorDocument 404 /~grahamd/vampire/404.html

Presuming that is that it returns HTML, else it wouldn't really make  
sense to use that
extension.

BTW, have explicitly set req.status, but this is probably not  
actually required as
Apache knows it is a 404 error already and has therefore set it. I  
have returned
apache.DONE instead of apache.OK just to ensure no extra phases are  
somehow
executed after the handler is executed to serve up the error document.

Anyway, see how that goes.

Graham

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019519.html">[mod_python] Vampire ErrorDocument
</A></li>
	<LI>Next message: <A HREF="019521.html">[mod_python] a novice problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19520">[ date ]</a>
              <a href="thread.html#19520">[ thread ]</a>
              <a href="subject.html#19520">[ subject ]</a>
              <a href="author.html#19520">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
