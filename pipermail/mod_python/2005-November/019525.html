<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Re: next beta
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Re%3A%20next%20beta&In-Reply-To=1CFED96A-0963-40CB-B8FE-ADBFAD8DDDDA%40mitre.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019524.html">
   <LINK REL="Next"  HREF="019526.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Re: next beta</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Nicolas Lehuen</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Re%3A%20next%20beta&In-Reply-To=1CFED96A-0963-40CB-B8FE-ADBFAD8DDDDA%40mitre.org"
       TITLE="[mod_python] Re: next beta">nicolas.lehuen at gmail.com
       </A><BR>
    <I>Mon Nov 14 10:08:31 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="019524.html">[mod_python] Re: next beta
</A></li>
        <LI>Next message: <A HREF="019526.html">[mod_python] Re: next beta
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19525">[ date ]</a>
              <a href="thread.html#19525">[ thread ]</a>
              <a href="subject.html#19525">[ subject ]</a>
              <a href="author.html#19525">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Alexis, sorry but this is not the latest version. I've made some
changes to your version with the hope of simplifying the source code
and documenting it. Could you please try the version you'll find at :

<A HREF="http://svn.apache.org/viewcvs.cgi/httpd/mod_python/trunk/lib/python/mod_python/util.py?rev=332779&amp;view=markup">http://svn.apache.org/viewcvs.cgi/httpd/mod_python/trunk/lib/python/mod_python/util.py?rev=332779&amp;view=markup</A>

Be sure to use the whole file, and not just read_to_boundary. Indeed,
I've introduced some changes in FieldStorage.__init__ that will be
required by read_to_boundary.

Thanks,
Nicolas

2005/11/14, Alexis Marrero &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">amarrero at mitre.org</A>&gt;:
&gt;<i> I did try the code and worked fine for my test file set (~55000 files).
</I>&gt;<i>
</I>&gt;<i> Like I stated in a previous email I made some changes based on Mike's
</I>&gt;<i> concern about performance.
</I>&gt;<i>
</I>&gt;<i> So my last version of the function was, I tested it tih my file set
</I>&gt;<i> and it passed all my tests.
</I>&gt;<i>
</I>&gt;<i> def read_to_boundary_new(self, req, boundary, file):
</I>&gt;<i>      previous_delimiter = ''
</I>&gt;<i>      bound_length = len(boundary)
</I>&gt;<i>      while 1:
</I>&gt;<i>          line = req.readline(readBlockSize)
</I>&gt;<i>          if line[:bound_length] == boundary:
</I>&gt;<i>              break
</I>&gt;<i>
</I>&gt;<i>          if line[-2:] == '\r\n':
</I>&gt;<i>              file.write(previous_delimiter + line[:-2])
</I>&gt;<i>              previous_delimiter = '\r\n'
</I>&gt;<i>
</I>&gt;<i>          elif line[-1:] == '\r':
</I>&gt;<i>              file.write(previous_delimiter + line[:-1])
</I>&gt;<i>              previous_delimiter = '\r'
</I>&gt;<i>
</I>&gt;<i>          elif line[-1:] == '\n':
</I>&gt;<i>              if len(line[:-1]) &gt; 0:
</I>&gt;<i>                  file.write(previous_delimiter + line[:-1])
</I>&gt;<i>                  previous_delimiter = '\n'
</I>&gt;<i>
</I>&gt;<i>              else:
</I>&gt;<i>                  previous_delimiter += '\n'
</I>&gt;<i>
</I>&gt;<i>          else:
</I>&gt;<i>              file.write(previous_delimiter + line)
</I>&gt;<i>              previous_delimiter = ''
</I>&gt;<i>
</I>&gt;<i> /amn
</I>&gt;<i> On Nov 14, 2005, at 8:34 AM, Jim Gallacher wrote:
</I>&gt;<i>
</I>&gt;<i> &gt; It looks like Nicolas was very busy on the weekend cleaning up
</I>&gt;<i> &gt; remaining issues.  Has Alexis had a chance to test the new upload
</I>&gt;<i> &gt; code?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Are there any objections to creating a 3.2.5 beta today?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Jim
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i>
</I>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019524.html">[mod_python] Re: next beta
</A></li>
	<LI>Next message: <A HREF="019526.html">[mod_python] Re: next beta
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19525">[ date ]</a>
              <a href="thread.html#19525">[ thread ]</a>
              <a href="subject.html#19525">[ subject ]</a>
              <a href="author.html#19525">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
