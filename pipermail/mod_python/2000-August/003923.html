<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] mod_python / win32all and COM
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20mod_python%20/%20win32all%20and%20COM&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003916.html">
   <LINK REL="Next"  HREF="003917.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] mod_python / win32all and COM</H1>
    <B>Stephane Bidoul</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20mod_python%20/%20win32all%20and%20COM&In-Reply-To="
       TITLE="[mod_python] mod_python / win32all and COM">sbi at acse.be
       </A><BR>
    <I>Thu Aug 10 19:40:09 EST 2000</I>
    <P><UL>
        <LI>Previous message: <A HREF="003916.html">[mod_python] mod_python / win32all and COM
</A></li>
        <LI>Next message: <A HREF="003917.html">[mod_python] problem with authen handler
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3923">[ date ]</a>
              <a href="thread.html#3923">[ thread ]</a>
              <a href="subject.html#3923">[ subject ]</a>
              <a href="author.html#3923">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<table border=0 width="100%"><tr><td>
<!--beginarticle-->
<PRE>I think you need to put COM in free-threaded mode
by doing

&gt;&gt;&gt;<i> sys.coinit_flags = 0
</I>
before anything else.

There is a mention of this in the Python COM readme,
but and can't recall where it's documented in more details...

Tell me if it works for you.

-sbi

----- Original Message -----
From: &quot;Robert Nasca&quot; &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Robert.Nasca at macquarie.com.au</A>&gt;
To: &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mod_python at modpython.org</A>&gt;
Sent: Tuesday, 08 August, 2000 01:27
Subject: [mod_python] mod_python / win32all and COM


&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> Is there an FAQ on using mod_python with COM? It seems that I am having
</I>&gt;<i> problems due to the threaded nature of Apache on win32 and it's
</I>&gt;<i> interaction with COM.
</I>&gt;<i>
</I>&gt;<i> I have created an interface to some COM objects using the &quot;makepy.py&quot;
</I>&gt;<i> program which comes with win32all.
</I>&gt;<i>
</I>&gt;<i> When I run Apache with ThreadsPerChild set to 1, everything runs fine
</I>&gt;<i> (albeit with only one client), but when I set this to something higher,
</I>&gt;<i> I get errors saying &quot;CoInitialise() has not been called&quot;, which I assume
</I>&gt;<i> are related to Apache spawning multiple threads. I've attached the
</I>&gt;<i> output below.
</I>&gt;<i>
</I>&gt;<i> Mod_python error: &quot;PythonHandler pytest&quot;Traceback (innermost last):
</I>&gt;<i>   File &quot;h:\website\python\mod_python\apache.py&quot;, line 119, in Dispatch
</I>&gt;<i>     result = object(req)
</I>&gt;<i>   File &quot;h:/website/htdocs/test\pytest.py&quot;, line 8, in handler
</I>&gt;<i>     d = Snakey.Database.RiskReporterDatabase()
</I>&gt;<i>   File &quot;H:\WebSite\Python\Snakey\Database.py&quot;, line 32, in __init__
</I>&gt;<i>     self.openConnection(&quot;DSN=RISK_REPORTER&quot;)
</I>&gt;<i>   File &quot;H:\WebSite\Python\Snakey\Database.py&quot;, line 20, in
</I>&gt;<i> openConnection
</I>&gt;<i>     self.connection = msado21.Connection()
</I>&gt;<i>   File &quot;H:\PythonDev\Snakey\msado21.py&quot;, line 1607, in __init__
</I>&gt;<i> com_error: (-2147221008, 'CoInitialize has not been called.', None,
</I>&gt;<i> None)
</I>&gt;<i>
</I>&gt;<i> If anyone has a suggestion on what is happening, or pointers to some
</I>&gt;<i> information on using mod_python and COM, it would be appreciated.
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i> Rob.
</I>&gt;<i>
</I>&gt;<i>
</I>


</PRE>
<!--endarticle-->
</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003916.html">[mod_python] mod_python / win32all and COM
</A></li>
	<LI>Next message: <A HREF="003917.html">[mod_python] problem with authen handler
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3923">[ date ]</a>
              <a href="thread.html#3923">[ thread ]</a>
              <a href="subject.html#3923">[ subject ]</a>
              <a href="author.html#3923">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
