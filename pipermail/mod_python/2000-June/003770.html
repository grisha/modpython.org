<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Leaking and cgi-handler
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Leaking%20and%20cgi-handler&In-Reply-To=4.3.2.20000605071041.00b91280%40pop.ne.mediaone.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003769.html">
   <LINK REL="Next"  HREF="003780.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Leaking and cgi-handler</H1>
    <B>Gregory Trubetskoy</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Leaking%20and%20cgi-handler&In-Reply-To=4.3.2.20000605071041.00b91280%40pop.ne.mediaone.net"
       TITLE="[mod_python] Leaking and cgi-handler">grisha at ispol.com
       </A><BR>
    <I>Mon Jun  5 08:05:32 EST 2000</I>
    <P><UL>
        <LI>Previous message: <A HREF="003769.html">[mod_python] Leaking and cgi-handler
</A></li>
        <LI>Next message: <A HREF="003780.html">[mod_python] Leaking and cgi-handler
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3770">[ date ]</a>
              <a href="thread.html#3770">[ thread ]</a>
              <a href="subject.html#3770">[ subject ]</a>
              <a href="author.html#3770">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<table border=0 width="100%"><tr><td>
<!--beginarticle-->
<PRE>Sean - 

If you can find the source of the memory leak, please let me know what it
is, because I couldn't... :-(

The cgihandler when used with scripts not using cgi.py does not leak a
byte of memory. Unfortunately 98% of Python scripts out there start with
&quot;import cgi&quot;.

A common misconception about Python and memory leaks is that it is
impossible to leak memory in Python. Python, just like any other language
allows you to allocate limitless memory, and in a persistent daemon-type
environment like Apache it shows.

Most likely the reason PyApache does not leak memory as bad is it resets
the interpeter between hits. This comes at a significant performance hit
since all the modules have to imported again, to the point where PyApache
isn't all that much faster than plain CGI.

My recomendation would to rewrite everything using &quot;native&quot; mod_python
handlers. They are simple (much simpler than CGI), fast and they do not
leak memory. You fears about them being unstable are unfounded, I think.

P.S. A skeleton content handler is described in the documentation.

--
  Gregory (Grisha) Trubetskoy
       <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">grisha at ispol.com</A>

On Mon, 5 Jun 2000, Sean True wrote:

&gt;<i> The same code runs under pyapache with a very modest memory leak (also
</I>&gt;<i> documented for pyapache) of about 1K per page served.
</I>&gt;<i> 
</I>&gt;<i> I was a little unwilling to try switching to a more direct method of
</I>&gt;<i> content handling under mod_python (creating a request handler for
</I>&gt;<i> .phtml page) until the whole system was a little more stable. I'm in
</I>&gt;<i> production under pyapache now, and I hate forking the code base.
</I>&gt;<i> 
</I>&gt;<i> Comments? Suggestions?
</I>&gt;<i> 
</I>&gt;<i> Does anyone have a skeleton content handler they would be willing to
</I>&gt;<i> share, along with a corresponding .conf entry?
</I>&gt;<i> 
</I>&gt;<i> -- Sean
</I>

</PRE>
<!--endarticle-->
</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003769.html">[mod_python] Leaking and cgi-handler
</A></li>
	<LI>Next message: <A HREF="003780.html">[mod_python] Leaking and cgi-handler
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3770">[ date ]</a>
              <a href="thread.html#3770">[ thread ]</a>
              <a href="subject.html#3770">[ subject ]</a>
              <a href="author.html#3770">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
