From jcruff at gmail.com  Thu Mar  1 09:40:16 2007
From: jcruff at gmail.com (John Ruff)
Date: Thu Mar  1 09:40:22 2007
Subject: [mod_python] PSP Templating
Message-ID: <F52D355D-1F97-437C-ADFA-93F6D8C4A554@gmail.com>

I'm trying to understand what I'm doing wrong.  I'm using mod_python  
3.3.1 with apache 2.2.4.  The situation is that while trying to use  
PSP as a templating engine, none of the examples work.  Yet normal  
'SetHandler mod_python' with inline html works no problem.

I have the following:

<Directory "/home/<user-dir>/Sites/python">
     SetHandler mod_python
     PythonHandler mod_python.publisher
     PythonOption mod_python.psp.cache_database_filename "/tmp/ 
pspcache.dbm"
     PythonDebug On
</Directory>

====hello.py====
from mod_python import apache, psp

def hello(req):
     s = 'Hello, there!'
     tmpl = psp.PSP(req, filename = 'hello.tmpl')
     tmpl.run(vars = {'greet':s})
     return apache.OK

====hello.tmpl====
<html>
<body>
     <h1><%=greet%></h1>
</body>
</html>


Still, I'm presented with a webpage that's raw html of what would  
have been generated.  When using firefox's Web Developer toolbar to  
see the generated source I can see that my html has been surrounded  
by an '<html><head></head><body><pre>...</pre></body></html>' block.   
So it looks like this:

[snip]

<html><head></head><body><pre>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD  
XHTML 1.0 Strict//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;

&lt;html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"  
lang="en"&gt;
&lt;head&gt;
     &lt;meta http-equiv="Content-Type" content="text/html;  
charset=utf-8"/&gt;

     &lt;title&gt;hello&lt;/title&gt;


&lt;/head&gt;

&lt;body&gt;
     &lt;h1&gt;Hello, there!&lt;/h1&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre></body></html>

[/snip]

Any ideas why this is happening?
___________________
John Ruff
jcruff@gmail.com
GPG Key: 0x1F691195
FGPR: 6B50 37C9 10F9 6C4A D381  54B8 319D 7DD9 1F69 1195

"No one can see past a choice they don't understand." --The Oracle


From john_nowlan at carleton.ca  Thu Mar  1 10:09:54 2007
From: john_nowlan at carleton.ca (John_Nowlan)
Date: Thu Mar  1 10:09:55 2007
Subject: [mod_python] PSP Templating
In-Reply-To: <F52D355D-1F97-437C-ADFA-93F6D8C4A554@gmail.com>
Message-ID: <6A5D305B0DE17541907AC0448C828A71012FB1D4@CCSEXB10.CUNET.CARLETON.CA>

I think you need to set the content type of your page. I.e. put

       req.content_type = 'text/html'

as the first line of your hello function.
See the mod_python faq 2.25. as well
http://www.modpython.org/FAQ/faqw.py?req=show&file=faq02.025.htp


> -----Original Message-----
> From: mod_python-bounces@modpython.org
> [mailto:mod_python-bounces@modpython.org]On Behalf Of John Ruff
> Sent: Thursday, March 01, 2007 9:40 AM
> To: mod_python
> Subject: [mod_python] PSP Templating
> 
> 
> I'm trying to understand what I'm doing wrong.  I'm using mod_python  
> 3.3.1 with apache 2.2.4.  The situation is that while trying to use  
> PSP as a templating engine, none of the examples work.  Yet normal  
> 'SetHandler mod_python' with inline html works no problem.
> 
> I have the following:
> 
> <Directory "/home/<user-dir>/Sites/python">
>      SetHandler mod_python
>      PythonHandler mod_python.publisher
>      PythonOption mod_python.psp.cache_database_filename "/tmp/ 
> pspcache.dbm"
>      PythonDebug On
> </Directory>
> 
> ====hello.py====
> from mod_python import apache, psp
> 
> def hello(req):
>      s = 'Hello, there!'
>      tmpl = psp.PSP(req, filename = 'hello.tmpl')
>      tmpl.run(vars = {'greet':s})
>      return apache.OK
> 
> ====hello.tmpl====
> <html>
> <body>
>      <h1><%=greet%></h1>
> </body>
> </html>
> 
> 
> Still, I'm presented with a webpage that's raw html of what would  
> have been generated.  When using firefox's Web Developer toolbar to  
> see the generated source I can see that my html has been surrounded  
> by an '<html><head></head><body><pre>...</pre></body></html>' 
> block.   
> So it looks like this:
> 
> [snip]
> 
> <html><head></head><body><pre>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD  
> XHTML 1.0 Strict//EN"
>      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;
> 
> &lt;html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"  
> lang="en"&gt;
> &lt;head&gt;
>      &lt;meta http-equiv="Content-Type" content="text/html;  
> charset=utf-8"/&gt;
> 
>      &lt;title&gt;hello&lt;/title&gt;
> 
> 
> &lt;/head&gt;
> 
> &lt;body&gt;
>      &lt;h1&gt;Hello, there!&lt;/h1&gt;
> &lt;/body&gt;
> &lt;/html&gt;
> </pre></body></html>
> 
> [/snip]
> 
> Any ideas why this is happening?
> ___________________
> John Ruff
> jcruff@gmail.com
> GPG Key: 0x1F691195
> FGPR: 6B50 37C9 10F9 6C4A D381  54B8 319D 7DD9 1F69 1195
> 
> "No one can see past a choice they don't understand." --The Oracle
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 
From steino at ccri.net  Thu Mar  1 10:13:08 2007
From: steino at ccri.net (Olaf Stein)
Date: Thu Mar  1 10:14:35 2007
Subject: [mod_python] PSP Templating
In-Reply-To: <F52D355D-1F97-437C-ADFA-93F6D8C4A554@gmail.com>
Message-ID: <C20C57B4.12AA%steino@ccri.net>

Add
req.content_type = 'text/html'
Before your tmpl.run(vars = {'greet':s})

Olaf

On 3/1/07 9:40 AM, "John Ruff" <jcruff@gmail.com> wrote:

> I'm trying to understand what I'm doing wrong.  I'm using mod_python
> 3.3.1 with apache 2.2.4.  The situation is that while trying to use
> PSP as a templating engine, none of the examples work.  Yet normal
> 'SetHandler mod_python' with inline html works no problem.
> 
> I have the following:
> 
> <Directory "/home/<user-dir>/Sites/python">
>      SetHandler mod_python
>      PythonHandler mod_python.publisher
>      PythonOption mod_python.psp.cache_database_filename "/tmp/
> pspcache.dbm"
>      PythonDebug On
> </Directory>
> 
> ====hello.py====
> from mod_python import apache, psp
> 
> def hello(req):
>      s = 'Hello, there!'
>      tmpl = psp.PSP(req, filename = 'hello.tmpl')
>      tmpl.run(vars = {'greet':s})
>      return apache.OK
> 
> ====hello.tmpl====
> <html>
> <body>
>      <h1><%=greet%></h1>
> </body>
> </html>
> 
> 
> Still, I'm presented with a webpage that's raw html of what would
> have been generated.  When using firefox's Web Developer toolbar to
> see the generated source I can see that my html has been surrounded
> by an '<html><head></head><body><pre>...</pre></body></html>' block.
> So it looks like this:
> 
> [snip]
> 
> <html><head></head><body><pre>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD
> XHTML 1.0 Strict//EN"
>      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;
> 
> &lt;html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
> lang="en"&gt;
> &lt;head&gt;
>      &lt;meta http-equiv="Content-Type" content="text/html;
> charset=utf-8"/&gt;
> 
>      &lt;title&gt;hello&lt;/title&gt;
> 
> 
> &lt;/head&gt;
> 
> &lt;body&gt;
>      &lt;h1&gt;Hello, there!&lt;/h1&gt;
> &lt;/body&gt;
> &lt;/html&gt;
> </pre></body></html>
> 
> [/snip]
> 
> Any ideas why this is happening?
> ___________________
> John Ruff
> jcruff@gmail.com
> GPG Key: 0x1F691195
> FGPR: 6B50 37C9 10F9 6C4A D381  54B8 319D 7DD9 1F69 1195
> 
> "No one can see past a choice they don't understand." --The Oracle
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python





-------------------------
Olaf Stein
DBA
Center for Quantitative and Computational Biology
Columbus Children's Research Institute
700 Children's Drive
phone: 1-614-355-5685
cell: 1-614-843-0432
email: steino@ccri.net

From jcruff at gmail.com  Thu Mar  1 10:18:45 2007
From: jcruff at gmail.com (John Ruff)
Date: Thu Mar  1 10:18:50 2007
Subject: [mod_python] PSP Templating
In-Reply-To: <C20C57B4.12AA%steino@ccri.net>
References: <C20C57B4.12AA%steino@ccri.net>
Message-ID: <1EC86F27-05B6-403C-803F-760ECC88D708@gmail.com>

Thanks Olaf.  Is this a new requirement?  It's not mentioned in the  
PSP 3.3 docs example for templating.  Also, I didn't see this issue  
when previously using 3.2.10.

Thanks.
___________________
John Ruff
jcruff@gmail.com
GPG Key: 0x1F691195
FGPR: 6B50 37C9 10F9 6C4A D381  54B8 319D 7DD9 1F69 1195

"No one can see past a choice they don't understand." --The Oracle


On Mar 1, 2007, at 10:13 AM, Olaf Stein wrote:

> Add
> req.content_type = 'text/html'
> Before your tmpl.run(vars = {'greet':s})
>
> Olaf
>
> On 3/1/07 9:40 AM, "John Ruff" <jcruff@gmail.com> wrote:
>
>> I'm trying to understand what I'm doing wrong.  I'm using mod_python
>> 3.3.1 with apache 2.2.4.  The situation is that while trying to use
>> PSP as a templating engine, none of the examples work.  Yet normal
>> 'SetHandler mod_python' with inline html works no problem.
>>
>> I have the following:
>>
>> <Directory "/home/<user-dir>/Sites/python">
>>      SetHandler mod_python
>>      PythonHandler mod_python.publisher
>>      PythonOption mod_python.psp.cache_database_filename "/tmp/
>> pspcache.dbm"
>>      PythonDebug On
>> </Directory>
>>
>> ====hello.py====
>> from mod_python import apache, psp
>>
>> def hello(req):
>>      s = 'Hello, there!'
>>      tmpl = psp.PSP(req, filename = 'hello.tmpl')
>>      tmpl.run(vars = {'greet':s})
>>      return apache.OK
>>
>> ====hello.tmpl====
>> <html>
>> <body>
>>      <h1><%=greet%></h1>
>> </body>
>> </html>
>>
>>
>> Still, I'm presented with a webpage that's raw html of what would
>> have been generated.  When using firefox's Web Developer toolbar to
>> see the generated source I can see that my html has been surrounded
>> by an '<html><head></head><body><pre>...</pre></body></html>' block.
>> So it looks like this:
>>
>> [snip]
>>
>> <html><head></head><body><pre>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD
>> XHTML 1.0 Strict//EN"
>>      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;
>>
>> &lt;html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
>> lang="en"&gt;
>> &lt;head&gt;
>>      &lt;meta http-equiv="Content-Type" content="text/html;
>> charset=utf-8"/&gt;
>>
>>      &lt;title&gt;hello&lt;/title&gt;
>>
>>
>> &lt;/head&gt;
>>
>> &lt;body&gt;
>>      &lt;h1&gt;Hello, there!&lt;/h1&gt;
>> &lt;/body&gt;
>> &lt;/html&gt;
>> </pre></body></html>
>>
>> [/snip]
>>
>> Any ideas why this is happening?
>> ___________________
>> John Ruff
>> jcruff@gmail.com
>> GPG Key: 0x1F691195
>> FGPR: 6B50 37C9 10F9 6C4A D381  54B8 319D 7DD9 1F69 1195
>>
>> "No one can see past a choice they don't understand." --The Oracle
>>
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
>
>
>
> -------------------------
> Olaf Stein
> DBA
> Center for Quantitative and Computational Biology
> Columbus Children's Research Institute
> 700 Children's Drive
> phone: 1-614-355-5685
> cell: 1-614-843-0432
> email: steino@ccri.net
>

From jpg at jgassociates.ca  Thu Mar  1 11:49:26 2007
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Thu Mar  1 11:48:03 2007
Subject: [mod_python] PSP Templating
In-Reply-To: <1EC86F27-05B6-403C-803F-760ECC88D708@gmail.com>
References: <C20C57B4.12AA%steino@ccri.net>
	<1EC86F27-05B6-403C-803F-760ECC88D708@gmail.com>
Message-ID: <45E70416.6090106@jgassociates.ca>

John Ruff wrote:
> Thanks Olaf.  Is this a new requirement?  It's not mentioned in the PSP 
> 3.3 docs example for templating.  Also, I didn't see this issue when 
> previously using 3.2.10.

Were you using *exactly* the same code? If so I'm surprised it worked 
before.

Some of what you are seeing is the result of the way you are using 
mod_python.publisher, rather than a psp issue. First, don't return 
apache.OK from your hello() function. Publisher looks after the apache 
return code for you internally. Publisher will convert whatever is 
returned by the function to a string and write it to the client. If 
req.content_type is not set publisher will examine whatever is returned 
and make a best effort to guess the correct content_type, and in this 
case guesses wrong. You real content is being written directly by the 
run() method of your PSP instance. In this case you must explicitly set 
the content type. Note that if you were using the mod_python.psp handler 
directly it would have guessed the correct content type and all would 
have well.

As for the extra html being written... I have no idea what is going on 
as I can't reproduce that result using the code snippet you've given. 
For me it just returns:

<html>
<body>
     <h1>Hello, there!</h1>
</body>
</html>
0

Jim


> Thanks.
> ___________________
> John Ruff
> jcruff@gmail.com
> GPG Key: 0x1F691195
> FGPR: 6B50 37C9 10F9 6C4A D381  54B8 319D 7DD9 1F69 1195
> 
> "No one can see past a choice they don't understand." --The Oracle
> 
> 
> On Mar 1, 2007, at 10:13 AM, Olaf Stein wrote:
> 
>> Add
>> req.content_type = 'text/html'
>> Before your tmpl.run(vars = {'greet':s})
>>
>> Olaf
>>
>> On 3/1/07 9:40 AM, "John Ruff" <jcruff@gmail.com> wrote:
>>
>>> I'm trying to understand what I'm doing wrong.  I'm using mod_python
>>> 3.3.1 with apache 2.2.4.  The situation is that while trying to use
>>> PSP as a templating engine, none of the examples work.  Yet normal
>>> 'SetHandler mod_python' with inline html works no problem.
>>>
>>> I have the following:
>>>
>>> <Directory "/home/<user-dir>/Sites/python">
>>>      SetHandler mod_python
>>>      PythonHandler mod_python.publisher
>>>      PythonOption mod_python.psp.cache_database_filename "/tmp/
>>> pspcache.dbm"
>>>      PythonDebug On
>>> </Directory>
>>>
>>> ====hello.py====
>>> from mod_python import apache, psp
>>>
>>> def hello(req):
>>>      s = 'Hello, there!'
>>>      tmpl = psp.PSP(req, filename = 'hello.tmpl')
>>>      tmpl.run(vars = {'greet':s})
>>>      return apache.OK
>>>
>>> ====hello.tmpl====
>>> <html>
>>> <body>
>>>      <h1><%=greet%></h1>
>>> </body>
>>> </html>
>>>
>>>
>>> Still, I'm presented with a webpage that's raw html of what would
>>> have been generated.  When using firefox's Web Developer toolbar to
>>> see the generated source I can see that my html has been surrounded
>>> by an '<html><head></head><body><pre>...</pre></body></html>' block.
>>> So it looks like this:
>>>
>>> [snip]
>>>
>>> <html><head></head><body><pre>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD
>>> XHTML 1.0 Strict//EN"
>>>      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;
>>>
>>> &lt;html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
>>> lang="en"&gt;
>>> &lt;head&gt;
>>>      &lt;meta http-equiv="Content-Type" content="text/html;
>>> charset=utf-8"/&gt;
>>>
>>>      &lt;title&gt;hello&lt;/title&gt;
>>>
>>>
>>> &lt;/head&gt;
>>>
>>> &lt;body&gt;
>>>      &lt;h1&gt;Hello, there!&lt;/h1&gt;
>>> &lt;/body&gt;
>>> &lt;/html&gt;
>>> </pre></body></html>
>>>
>>> [/snip]
>>>
>>> Any ideas why this is happening?
>>> ___________________
>>> John Ruff
>>> jcruff@gmail.com
>>> GPG Key: 0x1F691195
>>> FGPR: 6B50 37C9 10F9 6C4A D381  54B8 319D 7DD9 1F69 1195
>>>
>>> "No one can see past a choice they don't understand." --The Oracle
>>>
>>>
>>> _______________________________________________
>>> Mod_python mailing list
>>> Mod_python@modpython.org
>>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>
>>
>>
>>
>>
>> -------------------------
>> Olaf Stein
>> DBA
>> Center for Quantitative and Computational Biology
>> Columbus Children's Research Institute
>> 700 Children's Drive
>> phone: 1-614-355-5685
>> cell: 1-614-843-0432
>> email: steino@ccri.net
>>
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

From jcruff at gmail.com  Thu Mar  1 12:04:42 2007
From: jcruff at gmail.com (John Ruff)
Date: Thu Mar  1 12:05:30 2007
Subject: [mod_python] PSP Templating
In-Reply-To: <45E70416.6090106@jgassociates.ca>
References: <C20C57B4.12AA%steino@ccri.net>
	<1EC86F27-05B6-403C-803F-760ECC88D708@gmail.com>
	<45E70416.6090106@jgassociates.ca>
Message-ID: <861BC698-33F1-4BC5-B00A-1D9B25622D5F@gmail.com>

You are right is was not happening before, my mistake - I went back  
and checked.  However, I've found that if I change my hello.py to the  
following, req.content_type doens't have to be defined.  Can you  
explain this or point me to some reading?  Does this somehow invoke  
the use of the mod_python.psp handler - I'm sure I'm way off base.

def hello(req):
      s = 'Hello, there!'
      return psp.PSP(req, filename = 'hello.tmpl', vars = {'greet':s})

___________________
John Ruff
jcruff@gmail.com
GPG Key: 0x1F691195
FGPR: 6B50 37C9 10F9 6C4A D381  54B8 319D 7DD9 1F69 1195

"No one can see past a choice they don't understand." --The Oracle


On Mar 1, 2007, at 11:49 AM, Jim Gallacher wrote:

> John Ruff wrote:
>> Thanks Olaf.  Is this a new requirement?  It's not mentioned in  
>> the PSP 3.3 docs example for templating.  Also, I didn't see this  
>> issue when previously using 3.2.10.
>
> Were you using *exactly* the same code? If so I'm surprised it  
> worked before.
>
> Some of what you are seeing is the result of the way you are using  
> mod_python.publisher, rather than a psp issue. First, don't return  
> apache.OK from your hello() function. Publisher looks after the  
> apache return code for you internally. Publisher will convert  
> whatever is returned by the function to a string and write it to  
> the client. If req.content_type is not set publisher will examine  
> whatever is returned and make a best effort to guess the correct  
> content_type, and in this case guesses wrong. You real content is  
> being written directly by the run() method of your PSP instance. In  
> this case you must explicitly set the content type. Note that if  
> you were using the mod_python.psp handler directly it would have  
> guessed the correct content type and all would have well.
>
> As for the extra html being written... I have no idea what is going  
> on as I can't reproduce that result using the code snippet you've  
> given. For me it just returns:
>
> <html>
> <body>
>     <h1>Hello, there!</h1>
> </body>
> </html>
> 0
>
> Jim
>
>
>> Thanks.
>> ___________________
>> John Ruff
>> jcruff@gmail.com
>> GPG Key: 0x1F691195
>> FGPR: 6B50 37C9 10F9 6C4A D381  54B8 319D 7DD9 1F69 1195
>> "No one can see past a choice they don't understand." --The Oracle
>> On Mar 1, 2007, at 10:13 AM, Olaf Stein wrote:
>>> Add
>>> req.content_type = 'text/html'
>>> Before your tmpl.run(vars = {'greet':s})
>>>
>>> Olaf
>>>
>>> On 3/1/07 9:40 AM, "John Ruff" <jcruff@gmail.com> wrote:
>>>
>>>> I'm trying to understand what I'm doing wrong.  I'm using  
>>>> mod_python
>>>> 3.3.1 with apache 2.2.4.  The situation is that while trying to use
>>>> PSP as a templating engine, none of the examples work.  Yet normal
>>>> 'SetHandler mod_python' with inline html works no problem.
>>>>
>>>> I have the following:
>>>>
>>>> <Directory "/home/<user-dir>/Sites/python">
>>>>      SetHandler mod_python
>>>>      PythonHandler mod_python.publisher
>>>>      PythonOption mod_python.psp.cache_database_filename "/tmp/
>>>> pspcache.dbm"
>>>>      PythonDebug On
>>>> </Directory>
>>>>
>>>> ====hello.py====
>>>> from mod_python import apache, psp
>>>>
>>>> def hello(req):
>>>>      s = 'Hello, there!'
>>>>      tmpl = psp.PSP(req, filename = 'hello.tmpl')
>>>>      tmpl.run(vars = {'greet':s})
>>>>      return apache.OK
>>>>
>>>> ====hello.tmpl====
>>>> <html>
>>>> <body>
>>>>      <h1><%=greet%></h1>
>>>> </body>
>>>> </html>
>>>>
>>>>
>>>> Still, I'm presented with a webpage that's raw html of what would
>>>> have been generated.  When using firefox's Web Developer toolbar to
>>>> see the generated source I can see that my html has been surrounded
>>>> by an '<html><head></head><body><pre>...</pre></body></html>'  
>>>> block.
>>>> So it looks like this:
>>>>
>>>> [snip]
>>>>
>>>> <html><head></head><body><pre>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD
>>>> XHTML 1.0 Strict//EN"
>>>>      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;
>>>>
>>>> &lt;html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
>>>> lang="en"&gt;
>>>> &lt;head&gt;
>>>>      &lt;meta http-equiv="Content-Type" content="text/html;
>>>> charset=utf-8"/&gt;
>>>>
>>>>      &lt;title&gt;hello&lt;/title&gt;
>>>>
>>>>
>>>> &lt;/head&gt;
>>>>
>>>> &lt;body&gt;
>>>>      &lt;h1&gt;Hello, there!&lt;/h1&gt;
>>>> &lt;/body&gt;
>>>> &lt;/html&gt;
>>>> </pre></body></html>
>>>>
>>>> [/snip]
>>>>
>>>> Any ideas why this is happening?
>>>> ___________________
>>>> John Ruff
>>>> jcruff@gmail.com
>>>> GPG Key: 0x1F691195
>>>> FGPR: 6B50 37C9 10F9 6C4A D381  54B8 319D 7DD9 1F69 1195
>>>>
>>>> "No one can see past a choice they don't understand." --The Oracle
>>>>
>>>>
>>>> _______________________________________________
>>>> Mod_python mailing list
>>>> Mod_python@modpython.org
>>>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>>
>>>
>>>
>>>
>>>
>>> -------------------------
>>> Olaf Stein
>>> DBA
>>> Center for Quantitative and Computational Biology
>>> Columbus Children's Research Institute
>>> 700 Children's Drive
>>> phone: 1-614-355-5685
>>> cell: 1-614-843-0432
>>> email: steino@ccri.net
>>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From jpg at jgassociates.ca  Thu Mar  1 12:51:33 2007
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Thu Mar  1 12:49:33 2007
Subject: [mod_python] PSP Templating
In-Reply-To: <861BC698-33F1-4BC5-B00A-1D9B25622D5F@gmail.com>
References: <C20C57B4.12AA%steino@ccri.net>
	<1EC86F27-05B6-403C-803F-760ECC88D708@gmail.com>
	<45E70416.6090106@jgassociates.ca>
	<861BC698-33F1-4BC5-B00A-1D9B25622D5F@gmail.com>
Message-ID: <45E712A5.4030108@jgassociates.ca>

John Ruff wrote:
> You are right is was not happening before, my mistake - I went back and 
> checked.  However, I've found that if I change my hello.py to the 
> following, req.content_type doens't have to be defined.  Can you explain 
> this or point me to some reading?  Does this somehow invoke the use of 
> the mod_python.psp handler

No, but the end result is similar. The psp handler sets the content type 
and calls PSP.run().

> 
> def hello(req):
>      s = 'Hello, there!'
>      return psp.PSP(req, filename = 'hello.tmpl', vars = {'greet':s})

Publisher calls the PSP.__str__() method, which looks like this:

     def __str__(self):
         self.req.content_type = 'text/html'
         self.run()
         return ""

which is where the content_type is getting set.

I must admit I am little surprised by the code here... it could be a bit 
of a gotchya for someone using this particular idiom (publishing a PSP 
object) to create something other than html and may represent a bug. 
Perhaps we should be checking to see if the content_type is already set 
rather than blindly overwriting it, so that a user can explicitly set 
the type if they need to?

Digging a little deeper, mod_python.psp.handler() also hard codes the 
content_type as 'text/html'. So it would seem that if one wants to 
generate anything other than 'text/html' one must avoid using the PSP 
handler, or publisher handler as shown in your example above. Not that 
this is pertinent to your current question - just an interesting little 
quirk.

Jim

> ___________________
> John Ruff
> jcruff@gmail.com
> GPG Key: 0x1F691195
> FGPR: 6B50 37C9 10F9 6C4A D381  54B8 319D 7DD9 1F69 1195
> 
> "No one can see past a choice they don't understand." --The Oracle
> 
> 
> On Mar 1, 2007, at 11:49 AM, Jim Gallacher wrote:
> 
>> John Ruff wrote:
>>> Thanks Olaf.  Is this a new requirement?  It's not mentioned in the 
>>> PSP 3.3 docs example for templating.  Also, I didn't see this issue 
>>> when previously using 3.2.10.
>>
>> Were you using *exactly* the same code? If so I'm surprised it worked 
>> before.
>>
>> Some of what you are seeing is the result of the way you are using 
>> mod_python.publisher, rather than a psp issue. First, don't return 
>> apache.OK from your hello() function. Publisher looks after the apache 
>> return code for you internally. Publisher will convert whatever is 
>> returned by the function to a string and write it to the client. If 
>> req.content_type is not set publisher will examine whatever is 
>> returned and make a best effort to guess the correct content_type, and 
>> in this case guesses wrong. You real content is being written directly 
>> by the run() method of your PSP instance. In this case you must 
>> explicitly set the content type. Note that if you were using the 
>> mod_python.psp handler directly it would have guessed the correct 
>> content type and all would have well.
>>
>> As for the extra html being written... I have no idea what is going on 
>> as I can't reproduce that result using the code snippet you've given. 
>> For me it just returns:
>>
>> <html>
>> <body>
>>     <h1>Hello, there!</h1>
>> </body>
>> </html>
>> 0
>>
>> Jim
>>
>>
>>> Thanks.
>>> ___________________
>>> John Ruff
>>> jcruff@gmail.com
>>> GPG Key: 0x1F691195
>>> FGPR: 6B50 37C9 10F9 6C4A D381  54B8 319D 7DD9 1F69 1195
>>> "No one can see past a choice they don't understand." --The Oracle
>>> On Mar 1, 2007, at 10:13 AM, Olaf Stein wrote:
>>>> Add
>>>> req.content_type = 'text/html'
>>>> Before your tmpl.run(vars = {'greet':s})
>>>>
>>>> Olaf
>>>>
>>>> On 3/1/07 9:40 AM, "John Ruff" <jcruff@gmail.com> wrote:
>>>>
>>>>> I'm trying to understand what I'm doing wrong.  I'm using mod_python
>>>>> 3.3.1 with apache 2.2.4.  The situation is that while trying to use
>>>>> PSP as a templating engine, none of the examples work.  Yet normal
>>>>> 'SetHandler mod_python' with inline html works no problem.
>>>>>
>>>>> I have the following:
>>>>>
>>>>> <Directory "/home/<user-dir>/Sites/python">
>>>>>      SetHandler mod_python
>>>>>      PythonHandler mod_python.publisher
>>>>>      PythonOption mod_python.psp.cache_database_filename "/tmp/
>>>>> pspcache.dbm"
>>>>>      PythonDebug On
>>>>> </Directory>
>>>>>
>>>>> ====hello.py====
>>>>> from mod_python import apache, psp
>>>>>
>>>>> def hello(req):
>>>>>      s = 'Hello, there!'
>>>>>      tmpl = psp.PSP(req, filename = 'hello.tmpl')
>>>>>      tmpl.run(vars = {'greet':s})
>>>>>      return apache.OK
>>>>>
>>>>> ====hello.tmpl====
>>>>> <html>
>>>>> <body>
>>>>>      <h1><%=greet%></h1>
>>>>> </body>
>>>>> </html>
>>>>>
>>>>>
>>>>> Still, I'm presented with a webpage that's raw html of what would
>>>>> have been generated.  When using firefox's Web Developer toolbar to
>>>>> see the generated source I can see that my html has been surrounded
>>>>> by an '<html><head></head><body><pre>...</pre></body></html>' block.
>>>>> So it looks like this:
>>>>>
>>>>> [snip]
>>>>>
>>>>> <html><head></head><body><pre>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD
>>>>> XHTML 1.0 Strict//EN"
>>>>>      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;
>>>>>
>>>>> &lt;html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
>>>>> lang="en"&gt;
>>>>> &lt;head&gt;
>>>>>      &lt;meta http-equiv="Content-Type" content="text/html;
>>>>> charset=utf-8"/&gt;
>>>>>
>>>>>      &lt;title&gt;hello&lt;/title&gt;
>>>>>
>>>>>
>>>>> &lt;/head&gt;
>>>>>
>>>>> &lt;body&gt;
>>>>>      &lt;h1&gt;Hello, there!&lt;/h1&gt;
>>>>> &lt;/body&gt;
>>>>> &lt;/html&gt;
>>>>> </pre></body></html>
>>>>>
>>>>> [/snip]
>>>>>
>>>>> Any ideas why this is happening?
>>>>> ___________________
>>>>> John Ruff
>>>>> jcruff@gmail.com
>>>>> GPG Key: 0x1F691195
>>>>> FGPR: 6B50 37C9 10F9 6C4A D381  54B8 319D 7DD9 1F69 1195
>>>>>
>>>>> "No one can see past a choice they don't understand." --The Oracle
>>>>>
>>>>>
>>>>> _______________________________________________
>>>>> Mod_python mailing list
>>>>> Mod_python@modpython.org
>>>>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>>>
>>>>
>>>>
>>>>
>>>>
>>>> -------------------------
>>>> Olaf Stein
>>>> DBA
>>>> Center for Quantitative and Computational Biology
>>>> Columbus Children's Research Institute
>>>> 700 Children's Drive
>>>> phone: 1-614-355-5685
>>>> cell: 1-614-843-0432
>>>> email: steino@ccri.net
>>>>
>>> _______________________________________________
>>> Mod_python mailing list
>>> Mod_python@modpython.org
>>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>
> 
> 

From grahamd at dscpl.com.au  Fri Mar  2 19:14:53 2007
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Fri Mar  2 19:16:41 2007
Subject: [mod_python] Apache/mod_python process sizes. Help wanted.
Message-ID: <99C69BF9-B599-4BBD-9018-174FC9884492@dscpl.com.au>

This email is to enlist the help of mod_python users out there to  
hopefully
disprove a possible misconception that exists and which is often used
to malign mod_python and label it a bad solution to the problem of  
hosting
web applications. If intrigued, keep reading, especially as the  
results may
end up showing that you might be able to improve the memory use profile
of your own Apache installation.

The actual claim which would be nice to disprove is that mod_python
consumes huge amounts of memory.

The first part of this issue I want to look at and get data on is how  
much
memory is used by an Apache child process immediately after Apache is
started and before any actual request or additional Python modules are
imported.

What I am trying to determine is by how much is the process size caused
not by mod_python, but by the fact that standard Python installations  
tend
not to be built with the '-enable-shared' option. To be more  
specific, that the
Python library is static rather than being a shared library.

The reason this can be an issue is that when creating the mod_python.so
module which is loaded into Apache, if the Python library is static  
rather
than shared, then libtool will actually incorporate the contents of  
the Python
static library into mod_python.so itself. This alone will cause the  
size of the
mod_python.so file to be much larger.

The next factor is in what way particular operating systems will  
treat the
memory consumed by the mod_python.so file when loaded into memory
as shared data

The best scenario would be that the memory would be shared between all
Apache child processes. Thus, even if mod_python.so is bigger than it
needs to be due to there only being a static Python library, at least  
there is
only one copy in memory.

The worst case and one which apparently can happen on some platforms,
is that because the objects in the Python static library are not  
relocatable
objects, when mapped into memory, the required address translations
will result in a copy on write of the memory used by the Python library
object files in memory. This will result in the Python library parts  
of the
mod_python.so file not being able to be shared across all Apache child
processes and thus Apache as a whole could consume huge amounts as
each Apache child process would effectively have its own copy in memory
of the Python library.

What I am therefore after is a selection of data for various  
platforms and
the different ways that Python can be built, showing size of  
mod_python.so,
whether Python library is static or shared, how much memory Apache child
processes take when mod_python not loaded and then how much when
it is loaded.

Note that I am not interested in this for Win32 or MacOS systems, but  
the
Linux/BSD/Solaris/HPUX platforms.

Thus:

1. Operating System

For example:

   Mac OS X 10.4 (PowerPC)

2. Size of mod_python.so.

For example:

$ ls -las mod_python.so
744 -rwxr-xr-x   1 grahamd  admin  378280 Dec 10 17:24 mod_python.so

3. Size of Python library. This should exist in the 'lib/pythonX.Y/ 
config'
directory of your Python installation. Ie., at same directory level  
as your
'site-packages' directory. It would be called 'libpythonX.Y.a',  
'libpythonX.Y.so'
or 'libpythonX.Y.sl'.

MacOS is a bit different as it uses what it calls frameworks, ie., a  
fancy shared
library, and they are named differently, but as an example:

$ ls -las Python
2144 -rwxr-xr-x   1 root  wheel  1097268 Sep 13 12:12 Python

On UNIX platforms, use 'ls -las libpython*'.

4. Confirm whether mod_python.so uses Python library as static  
library or
shared library. On UNIX systems you can use the 'ldd' command on
mod_python.so to determine this.

MacOS is a bit different again here and uses 'otool' command instead and
output looks a fair bit different, but as example:

	$ otool -L mod_python.so mod_python.so:
         /usr/lib/libSystem.B.dylib (compatibility version 1.0.0,  
current version 88.1.6)
         /System/Library/Frameworks/Python.framework/Versions/2.3/ 
Python (compatibility version 2.3.0, current version 2.3.5)
         /System/Library/Frameworks/CoreServices.framework/Versions/A/ 
CoreServices (compatibility version 1.0.0, current version 18.0.0)
         /System/Library/Frameworks/Foundation.framework/Versions/C/ 
Foundation (compatibility version 300.0.0, current version 567.27.0)
         /usr/lib/libmx.A.dylib (compatibility version 1.0.0, current  
version 92.0.0)

5. Work out how much memory Apache uses when mod_python is not being
loaded. One can use 'top' for this. Hopefully others may suggest  
better ways.

For example:

   PID COMMAND      %CPU   TIME   #TH #PRTS #MREGS RPRVT  RSHRD   
RSIZE  VSIZE
   277 httpd        0.0%  0:00.00   1     8    26    72K  1.88M    
496K  29.3M
   276 httpd        0.0%  0:00.00   1     8    26    76K  1.88M    
500K  29.3M
   275 httpd        0.0%  0:00.00   1     8    26    76K  1.88M    
500K  29.3M
   274 httpd        0.0%  0:00.00   1     8    26    76K  1.88M    
500K  29.3M
   273 httpd        0.0%  0:00.00   1     8    26    72K  1.88M    
500K  29.3M
   272 httpd        0.0%  0:00.01   1    11    27    76K  1.89M   
1.07M  29.3M

6. Work out how much memory Apache uses when mod_python is loaded
but before any requests have occurred. Ensure that no PythonImport
directives have been used.

For example:

	  PID COMMAND      %CPU   TIME   #TH #PRTS #MREGS RPRVT  RSHRD   
RSIZE  VSIZE
   291 httpd        0.0%  0:00.00   1     8    36   120K  2.77M    
700K  30.3M
   290 httpd        0.0%  0:00.00   1     8    36   124K  2.77M    
704K  30.3M
   289 httpd        0.0%  0:00.00   1     8    36   124K  2.77M    
704K  30.3M
   288 httpd        0.0%  0:00.00   1     8    36   124K  2.77M    
704K  30.3M
   287 httpd        0.0%  0:00.00   1     8    36   120K  2.77M    
704K  30.3M
   286 httpd        0.0%  0:00.07   1    11    36    40K  2.77M   
1.81M  30.3M

Thus on MacOS where shared library for Python is used, process specific
memory use does go up, but no but that much. One sees a bigger jump
in shared memory use because of shared Python library.

If eager, use a hello world mod_python example and trigger one request
against it and see how size changes.

7. If you are also loading lots of other Apache modules, such as  
mod_perl,
module for PHP etc, list any significant ones so we might understand  
what
else may be using memory. Ideally, do the tests with as little  
modules loaded
as possible.

So, what do other people get?

Is that fact that Python installations often only provide a static  
Python
library the culprit?

Is there a better way of analysing memory use than this?

It would be great if someone has the time and resources to actually  
build
up two Python versions, one with static and shared libraries, then build
mod_python.so and compare for each. Being on the same platform
may help in comparing them. I can't really do this on MacOS and don't
have access to other platforms to test.

Thanks in advance.

Graham

From greg at vig.co.nz  Fri Mar  2 23:31:58 2007
From: greg at vig.co.nz (Greg Fawcett)
Date: Fri Mar  2 23:32:03 2007
Subject: [mod_python] Apache/mod_python process sizes. Help wanted.
In-Reply-To: <99C69BF9-B599-4BBD-9018-174FC9884492@dscpl.com.au>
References: <99C69BF9-B599-4BBD-9018-174FC9884492@dscpl.com.au>
Message-ID: <928306280703022031x6d295dbdrd5cca993ec4a6a0b@mail.gmail.com>

Hi Graham -

First, thanks for your frequent and insightful contributions to this list.

1. Ubuntu Linux 6.06 LTS

2. ls -las /usr/lib/apache2/modules/mod_python.so
        84 -rw-r--r-- 1 root root 80072 2006-03-20 21:29
/usr/lib/apache2/modules/mod_python.so

3. ls -las /usr/lib/libpython2.4.so.1.0
        1052 -rw-r--r-- 1 root root 1070260 2006-10-06 21:35
/usr/lib/libpython2.4.so.1.0

4. ldd /usr/lib/apache2/modules/mod_python.so
        linux-gate.so.1 =>  (0xffffe000)
        libpython2.4.so.1.0 => /usr/lib/libpython2.4.so.1.0 (0xb7e1b000)
        libpthread.so.0 => /lib/tls/i686/cmov/libpthread.so.0 (0xb7e08000)
        libdl.so.2 => /lib/tls/i686/cmov/libdl.so.2 (0xb7e05000)
        libutil.so.1 => /lib/tls/i686/cmov/libutil.so.1 (0xb7e02000)
        libm.so.6 => /lib/tls/i686/cmov/libm.so.6 (0xb7de0000)
        libc.so.6 => /lib/tls/i686/cmov/libc.so.6 (0xb7cb1000)
        /lib/ld-linux.so.2 (0x80000000)

5. Remove all references to mod_python in sites-available/*
        sudo a2dismod mod_python
        sudo /etc/init.d/apache2 force-reload
        top -U www-data

                top - 17:25:30 up 100 days,  3:01,  1 user,  load average:
0.00, 0.00, 0.00
                Tasks:  76 total,   2 running,  74 sleeping,   0 stopped,
0 zombie
                Cpu(s):  0.0% us,  0.3% sy,  0.0% ni, 99.7% id,  0.0% wa,
0.0% hi,  0.0% si
                Mem:    255824k total,   222824k used,    33000k free,
84288k buffers
                Swap:  1951800k total,     4320k used,  1947480k free,
52072k cached

                  PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+
COMMAND
                 8138 www-data  18   0 19628 3236  868 S  0.0  1.3
0:00.00apache2
                 8139 www-data  19   0 19628 3236  868 S  0.0  1.3
0:00.00apache2
                 8140 www-data  19   0 19628 3236  868 S  0.0  1.3
0:00.00apache2
                 8141 www-data  19   0 19628 3236  868 S  0.0  1.3
0:00.00apache2
                 8142 www-data  19   0 19628 3236  868 S  0.0  1.3
0:00.00apache2

6. Add mod_python references again...
        sudo a2enmod mod_python
        sudo /etc/init.d/apache2 force-reload
        top -U www-data

                top - 17:29:05 up 100 days,  3:04,  1 user,  load average:
0.00, 0.00, 0.00
                Tasks:  76 total,   2 running,  74 sleeping,   0 stopped,
0 zombie
                Cpu(s):  0.0% us,  0.0% sy,  0.0% ni, 100.0% id,  0.0% wa,
0.0% hi,  0.0% si
                Mem:    255824k total,   224292k used,    31532k free,
84408k buffers
                Swap:  1951800k total,     4320k used,  1947480k free,
52224k cached

                  PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+
COMMAND
                 8223 www-data  20   0 21580 4136  980 S  0.0  1.6
0:00.00apache2
                 8224 www-data  20   0 21580 4136  980 S  0.0  1.6
0:00.00apache2
                 8225 www-data  22   0 21580 4136  980 S  0.0  1.6
0:00.01apache2
                 8226 www-data  21   0 21580 4136  980 S  0.0  1.6
0:00.00apache2
                 8227 www-data  21   0 21580 4136  980 S  0.0  1.6
0:00.00apache2

Hope that makes more sense to you than it does to me. Let me know if there
is anything else I should have done.

Cheers!
Greg Fawcett.

On 03/03/07, Graham Dumpleton <grahamd@dscpl.com.au> wrote:
>
> This email is to enlist the help of mod_python users out there to
> hopefully
> disprove a possible misconception that exists and which is often used
> to malign mod_python and label it a bad solution to the problem of
> hosting
> web applications. If intrigued, keep reading, especially as the
> results may
> end up showing that you might be able to improve the memory use profile
> of your own Apache installation.
>
> The actual claim which would be nice to disprove is that mod_python
> consumes huge amounts of memory.
>
> The first part of this issue I want to look at and get data on is how
> much
> memory is used by an Apache child process immediately after Apache is
> started and before any actual request or additional Python modules are
> imported.
>
> What I am trying to determine is by how much is the process size caused
> not by mod_python, but by the fact that standard Python installations
> tend
> not to be built with the '-enable-shared' option. To be more
> specific, that the
> Python library is static rather than being a shared library.
>
> The reason this can be an issue is that when creating the mod_python.so
> module which is loaded into Apache, if the Python library is static
> rather
> than shared, then libtool will actually incorporate the contents of
> the Python
> static library into mod_python.so itself. This alone will cause the
> size of the
> mod_python.so file to be much larger.
>
> The next factor is in what way particular operating systems will
> treat the
> memory consumed by the mod_python.so file when loaded into memory
> as shared data
>
> The best scenario would be that the memory would be shared between all
> Apache child processes. Thus, even if mod_python.so is bigger than it
> needs to be due to there only being a static Python library, at least
> there is
> only one copy in memory.
>
> The worst case and one which apparently can happen on some platforms,
> is that because the objects in the Python static library are not
> relocatable
> objects, when mapped into memory, the required address translations
> will result in a copy on write of the memory used by the Python library
> object files in memory. This will result in the Python library parts
> of the
> mod_python.so file not being able to be shared across all Apache child
> processes and thus Apache as a whole could consume huge amounts as
> each Apache child process would effectively have its own copy in memory
> of the Python library.
>
> What I am therefore after is a selection of data for various
> platforms and
> the different ways that Python can be built, showing size of
> mod_python.so,
> whether Python library is static or shared, how much memory Apache child
> processes take when mod_python not loaded and then how much when
> it is loaded.
>
> Note that I am not interested in this for Win32 or MacOS systems, but
> the
> Linux/BSD/Solaris/HPUX platforms.
>
> Thus:
>
> 1. Operating System
>
> For example:
>
>    Mac OS X 10.4 (PowerPC)
>
> 2. Size of mod_python.so.
>
> For example:
>
> $ ls -las mod_python.so
> 744 -rwxr-xr-x   1 grahamd  admin  378280 Dec 10 17:24 mod_python.so
>
> 3. Size of Python library. This should exist in the 'lib/pythonX.Y/
> config'
> directory of your Python installation. Ie., at same directory level
> as your
> 'site-packages' directory. It would be called 'libpythonX.Y.a',
> 'libpythonX.Y.so'
> or 'libpythonX.Y.sl'.
>
> MacOS is a bit different as it uses what it calls frameworks, ie., a
> fancy shared
> library, and they are named differently, but as an example:
>
> $ ls -las Python
> 2144 -rwxr-xr-x   1 root  wheel  1097268 Sep 13 12:12 Python
>
> On UNIX platforms, use 'ls -las libpython*'.
>
> 4. Confirm whether mod_python.so uses Python library as static
> library or
> shared library. On UNIX systems you can use the 'ldd' command on
> mod_python.so to determine this.
>
> MacOS is a bit different again here and uses 'otool' command instead and
> output looks a fair bit different, but as example:
>
>         $ otool -L mod_python.so mod_python.so:
>          /usr/lib/libSystem.B.dylib (compatibility version 1.0.0,
> current version 88.1.6)
>          /System/Library/Frameworks/Python.framework/Versions/2.3/
> Python (compatibility version 2.3.0, current version 2.3.5)
>          /System/Library/Frameworks/CoreServices.framework/Versions/A/
> CoreServices (compatibility version 1.0.0, current version 18.0.0)
>          /System/Library/Frameworks/Foundation.framework/Versions/C/
> Foundation (compatibility version 300.0.0, current version 567.27.0)
>          /usr/lib/libmx.A.dylib (compatibility version 1.0.0, current
> version 92.0.0)
>
> 5. Work out how much memory Apache uses when mod_python is not being
> loaded. One can use 'top' for this. Hopefully others may suggest
> better ways.
>
> For example:
>
>    PID COMMAND      %CPU   TIME   #TH #PRTS #MREGS RPRVT  RSHRD
> RSIZE  VSIZE
>    277 httpd        0.0%  0:00.00   1     8    26    72K  1.88M
> 496K  29.3M
>    276 httpd        0.0%  0:00.00   1     8    26    76K  1.88M
> 500K  29.3M
>    275 httpd        0.0%  0:00.00   1     8    26    76K  1.88M
> 500K  29.3M
>    274 httpd        0.0%  0:00.00   1     8    26    76K  1.88M
> 500K  29.3M
>    273 httpd        0.0%  0:00.00   1     8    26    72K  1.88M
> 500K  29.3M
>    272 httpd        0.0%  0:00.01   1    11    27    76K  1.89M
> 1.07M  29.3M
>
> 6. Work out how much memory Apache uses when mod_python is loaded
> but before any requests have occurred. Ensure that no PythonImport
> directives have been used.
>
> For example:
>
>           PID COMMAND      %CPU   TIME   #TH #PRTS #MREGS RPRVT  RSHRD
> RSIZE  VSIZE
>    291 httpd        0.0%  0:00.00   1     8    36   120K  2.77M
> 700K  30.3M
>    290 httpd        0.0%  0:00.00   1     8    36   124K  2.77M
> 704K  30.3M
>    289 httpd        0.0%  0:00.00   1     8    36   124K  2.77M
> 704K  30.3M
>    288 httpd        0.0%  0:00.00   1     8    36   124K  2.77M
> 704K  30.3M
>    287 httpd        0.0%  0:00.00   1     8    36   120K  2.77M
> 704K  30.3M
>    286 httpd        0.0%  0:00.07   1    11    36    40K  2.77M
> 1.81M  30.3M
>
> Thus on MacOS where shared library for Python is used, process specific
> memory use does go up, but no but that much. One sees a bigger jump
> in shared memory use because of shared Python library.
>
> If eager, use a hello world mod_python example and trigger one request
> against it and see how size changes.
>
> 7. If you are also loading lots of other Apache modules, such as
> mod_perl,
> module for PHP etc, list any significant ones so we might understand
> what
> else may be using memory. Ideally, do the tests with as little
> modules loaded
> as possible.
>
> So, what do other people get?
>
> Is that fact that Python installations often only provide a static
> Python
> library the culprit?
>
> Is there a better way of analysing memory use than this?
>
> It would be great if someone has the time and resources to actually
> build
> up two Python versions, one with static and shared libraries, then build
> mod_python.so and compare for each. Being on the same platform
> may help in comparing them. I can't really do this on MacOS and don't
> have access to other platforms to test.
>
> Thanks in advance.
>
> Graham
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070303/5fbe4d54/attachment-0001.html
From rvernica at gmail.com  Fri Mar  2 23:37:18 2007
From: rvernica at gmail.com (Rares Vernica)
Date: Fri Mar  2 23:40:14 2007
Subject: [mod_python] mod_python 3.3.1 make error
Message-ID: <esau1v$opv$1@sea.gmane.org>

Hi,

./configure seems to be OK but make files when running libtool. Here is 
the output of the ./configure and make.

Any help is greatly appreciated.

Thanks a lot,
Ray


apple:~/<2>apple/src/mod_python-3.3.1> ./configure 
--with-apxs=/opt/apache-2.0.52/bin/apxs
checking for gcc... gcc
checking for C compiler default output file name... a.out
checking whether the C compiler works... yes
checking whether we are cross compiling... no
checking for suffix of executables...
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether gcc accepts -g... yes
checking for gcc option to accept ANSI C... none needed
checking for ar... ar
checking for a BSD-compatible install... ./install-sh -c
checking whether make sets $(MAKE)... yes
checking for main in -lm... yes
checking for an ANSI C-conforming const... yes
checking your blood pressure... a bit high, but we can proceed
configure: checking whether apxs is available...
checking for --with-apxs... /opt/apache-2.0.52/bin/apxs executable, good
checking Apache version... 2.0.52
checking for Apache libexec directory... /opt/apache-2.0.52/modules
checking for Apache include directory... -I/opt/apache-2.0.52/include
checking for gcc on Solaris possible missing _eprintf problem... "done"
checking for --with-python... no
checking for python... /opt/python/2.4.3/bin/python
checking Python version... 2.4
checking Python install prefix... /opt/python/2.4.3
checking checking where python libraries are installed... 
/opt/python/2.4.3/lib/python2.4
checking for Py_NewInterpreter in -lpython2.4... yes
checking what libraries Python was linked with... -lpython2.4   -lresolv 
-lsocket -lnsl -lrt -ldl  -lpthread   -lm
checking linker flags used to link Python...
checking where Python include files are... 
-I/opt/python/2.4.3/include/python2.4
checking for --with-python-src... no
checking for --with-mutex-dir... no
Using MUTEX_DIR /tmp
checking for --with-max-locks... no
Using 8 MAX_LOCKS.
checking for --with-flex... no
checking for flex... /opt/gnutools-1.1/bin/flex
found /opt/gnutools-1.1/bin/flex, we'll use this. Use --with-flex to 
specify another.
checking flex version... awk: syntax error near line 1
awk: bailing out near line 1
awk: syntax error near line 1
awk: bailing out near line 1
awk: syntax error near line 1
awk: bailing out near line 1
./configure: line 3187: test: : integer expression expected
configure: WARNING: Flex version 2.5.4 found.
     Version 2.5.31 or greater is required.  You can generally ignore this
     warning unless you need to regenerate psp_parser.c from psp_parse.l.
     If you do need regenerate psp_parser.c, use --with-flex to specify the
     location of the correct flex version. See the README for more 
information.
configure: creating ./config.status
config.status: creating Makefile
config.status: creating src/Makefile
config.status: creating Doc/Makefile
config.status: creating src/include/mod_python.h
config.status: creating test/Makefile
config.status: creating test/testconf.py
config.status: creating dist/setup.py
config.status: creating dist/Makefile
apple:~/<2>apple/src/mod_python-3.3.1> make
make[1]: Entering directory 
`/extra/rvernica0/usr/apple/src/mod_python-3.3.1/src'

Compiling for DSO.

/opt/apache-2.0.52/bin/apxs 
-I/home/rvernica/loquat/usr/apple/src/mod_python-3.3.1/src/include 
-I/opt/apache-2.0.52/include -I/opt/python/2.4.3/include/python2.4 -c 
mod_python.c _apachemodule.c requestobject.c tableobject.c util.c 
serverobject.c connobject.c filterobject.c hlist.c hlistobject.c 
finfoobject.c -L/opt/python/2.4.3/lib/python2.4/config        -lm 
-lpython2.4   -lresolv -lsocket -lnsl -lrt -ldl  -lpthread   -lm 
          _eprintf.o _floatdidf.o _muldi3.o
/opt/apache-2.0.52/build/libtool --silent --mode=compile gcc -prefer-pic 
  -DAP_HAVE_DESIGNATED_INITIALIZER -DSOLARIS2=8 
-D_POSIX_PTHREAD_SEMANTICS -D_REENTRANT -g -O2 -pthreads 
-I/opt/apache-2.0.52/include  -I/opt/apache-2.0.52/include 
-I/opt/apache-2.0.52/include 
-I/home/rvernica/loquat/usr/apple/src/mod_python-3.3.1/src/include 
-I/opt/apache-2.0.52/include -I/opt/python/2.4.3/include/python2.4  -c 
-o mod_python.lo mod_python.c && touch mod_python.slo
In file included from /usr/include/sys/wait.h:24,
                  from /opt/apache-2.0.52/include/apr.h:124,
                  from /opt/apache-2.0.52/include/ap_config.h:19,
                  from /opt/apache-2.0.52/include/httpd.h:29,
                  from 
/home/rvernica/loquat/usr/apple/src/mod_python-3.3.1/src/include/mod_python.h:42,
                  from mod_python.c:28:
/usr/include/sys/siginfo.h:259: error: parse error before "ctid_t"
/usr/include/sys/siginfo.h:292: error: parse error before '}' token
/usr/include/sys/siginfo.h:294: error: parse error before '}' token
/usr/include/sys/siginfo.h:390: error: parse error before "ctid_t"
/usr/include/sys/siginfo.h:398: error: conflicting types for '__fault'
/usr/include/sys/siginfo.h:267: error: previous declaration of '__fault' 
was here
/usr/include/sys/siginfo.h:404: error: conflicting types for '__file'
/usr/include/sys/siginfo.h:273: error: previous declaration of '__file' 
was here
/usr/include/sys/siginfo.h:420: error: conflicting types for '__prof'
/usr/include/sys/siginfo.h:287: error: previous declaration of '__prof' 
was here
/usr/include/sys/siginfo.h:424: error: conflicting types for '__rctl'
/usr/include/sys/siginfo.h:291: error: previous declaration of '__rctl' 
was here
/usr/include/sys/siginfo.h:426: error: parse error before '}' token
/usr/include/sys/siginfo.h:428: error: parse error before '}' token
/usr/include/sys/siginfo.h:432: error: parse error before "k_siginfo_t"
/usr/include/sys/siginfo.h:437: error: parse error before '}' token
In file included from /usr/include/sys/procset.h:24,
                  from /usr/include/sys/wait.h:25,
                  from /opt/apache-2.0.52/include/apr.h:124,
                  from /opt/apache-2.0.52/include/ap_config.h:19,
                  from /opt/apache-2.0.52/include/httpd.h:29,
                  from 
/home/rvernica/loquat/usr/apple/src/mod_python-3.3.1/src/include/mod_python.h:42,
                  from mod_python.c:28:
/opt/gcc-3.4.1/lib/gcc/sparc-sun-solaris2.8/3.4.1/include/sys/signal.h:96: 
error: parse error before "siginfo_t"
In file included from /opt/apache-2.0.52/include/apr.h:124,
                  from /opt/apache-2.0.52/include/ap_config.h:19,
                  from /opt/apache-2.0.52/include/httpd.h:29,
                  from 
/home/rvernica/loquat/usr/apple/src/mod_python-3.3.1/src/include/mod_python.h:42,
                  from mod_python.c:28:
/usr/include/sys/wait.h:86: error: parse error before "siginfo_t"
In file included from /opt/apache-2.0.52/include/apr_general.h:32,
                  from /opt/apache-2.0.52/include/apr_pools.h:38,
                  from /opt/apache-2.0.52/include/apr_tables.h:25,
                  from /opt/apache-2.0.52/include/apr_hooks.h:21,
                  from /opt/apache-2.0.52/include/ap_config.h:20,
                  from /opt/apache-2.0.52/include/httpd.h:29,
                  from 
/home/rvernica/loquat/usr/apple/src/mod_python-3.3.1/src/include/mod_python.h:42,
                  from mod_python.c:28:
/usr/include/signal.h:111: error: parse error before "siginfo_t"
/usr/include/signal.h:113: error: parse error before "siginfo_t"
In file included from /opt/python/2.4.3/include/python2.4/Python.h:8,
                  from 
/home/rvernica/loquat/usr/apple/src/mod_python-3.3.1/src/include/mod_python.h:80,
                  from mod_python.c:28:
/opt/python/2.4.3/include/python2.4/pyconfig.h:820:1: warning: 
"_FILE_OFFSET_BITS" redefined
In file included from 
/opt/gcc-3.4.1/lib/gcc/sparc-sun-solaris2.8/3.4.1/include/sys/types.h:29,
                  from /opt/apache-2.0.52/include/apr.h:112,
                  from /opt/apache-2.0.52/include/ap_config.h:19,
                  from /opt/apache-2.0.52/include/httpd.h:29,
                  from 
/home/rvernica/loquat/usr/apple/src/mod_python-3.3.1/src/include/mod_python.h:42,
                  from mod_python.c:28:
/usr/include/sys/feature_tests.h:188:1: warning: this is the location of 
the previous definition
mod_python.c: In function `python_init':
mod_python.c:826: warning: initialization from incompatible pointer type
apxs:Error: Command failed with rc=65536
.
make[1]: *** [mod_python.so] Error 1
make[1]: Leaving directory 
`/extra/rvernica0/usr/apple/src/mod_python-3.3.1/src'
make: *** [do_dso] Error 2
apple:~/<2>apple/src/mod_python-3.3.1>

From clodoaldo.pinto.neto at gmail.com  Sat Mar  3 08:27:02 2007
From: clodoaldo.pinto.neto at gmail.com (Clodoaldo)
Date: Sat Mar  3 08:27:08 2007
Subject: [mod_python] Apache/mod_python process sizes. Help wanted.
In-Reply-To: <99C69BF9-B599-4BBD-9018-174FC9884492@dscpl.com.au>
References: <99C69BF9-B599-4BBD-9018-174FC9884492@dscpl.com.au>
Message-ID: <a595de7a0703030527s2235c517la53b43a64066f0f3@mail.gmail.com>

2007/3/2, Graham Dumpleton <grahamd@dscpl.com.au>:
>
> So, what do other people get?

# uname -a
Linux s0.localdomain 2.6.19-1.2895.fc6 #1 SMP Wed Jan 10 18:32:37 EST
2007 i686 athlon i386 GNU/Linux

$ ls -las /usr/lib/httpd/modules/mod_python.so
1580 -rwxr-xr-x 1 root root 1611019 Feb  1 15:55
/usr/lib/httpd/modules/mod_python.so

$ ls -las /usr/lib/python2.4/config/libpython2.4.a
1736 -rw-r--r-- 1 root root 1767520 Oct 23 17:58
/usr/lib/python2.4/config/libpython2.4.a

# ldd /usr/lib/httpd/modules/mod_python.so
        linux-gate.so.1 =>  (0x00308000)
        libpthread.so.0 => /lib/libpthread.so.0 (0x008b4000)
        libdl.so.2 => /lib/libdl.so.2 (0x003ce000)
        libutil.so.1 => /lib/libutil.so.1 (0x00110000)
        libm.so.6 => /lib/libm.so.6 (0x00114000)
        libc.so.6 => /lib/libc.so.6 (0x0013b000)
        /lib/ld-linux.so.2 (0x80000000)

>5. Work out how much memory Apache uses when mod_python is not being
loaded. One can use 'top' for this. Hopefully others may suggest
better ways.

# top -U apache

top - 13:04:02 up 27 days, 14:07,  3 users,  load average: 1.03, 1.04, 1.01
Tasks: 116 total,   2 running, 114 sleeping,   0 stopped,   0 zombie
Cpu(s):  0.3%us,  0.0%sy, 99.7%ni,  0.0%id,  0.0%wa,  0.0%hi,  0.0%si,  0.0%st
Mem:   1538488k total,  1483200k used,    55288k free,    19692k buffers
Swap:  4087888k total,      572k used,  4087316k free,  1313956k cached

  PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND
 1367 apache    25   0 28728 5552  648 S  0.0  0.4   0:00.00 httpd

>6. Work out how much memory Apache uses when mod_python is loaded
but before any requests have occurred. Ensure that no PythonImport
directives have been used.

# top -U apache

top - 13:06:41 up 27 days, 14:10,  3 users,  load average: 1.00, 1.02, 1.00
Tasks: 116 total,   2 running, 114 sleeping,   0 stopped,   0 zombie
Cpu(s):  6.6%us,  1.1%sy, 90.2%ni,  1.5%id,  0.2%wa,  0.2%hi,  0.2%si,  0.0%st
Mem:   1538488k total,  1486348k used,    52140k free,    20000k buffers
Swap:  4087888k total,      572k used,  4087316k free,  1316220k cached

  PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND
 1423 apache    25   0 30948 6724  808 S  0.0  0.4   0:00.00 httpd

>If eager, use a hello world mod_python example and trigger one request
against it and see how size changes.

After one publisher helloword request:

# top -U apache

top - 13:20:49 up 27 days, 14:24,  3 users,  load average: 1.00, 1.00, 1.00
Tasks: 117 total,   2 running, 115 sleeping,   0 stopped,   0 zombie
Cpu(s):  0.0%us,  0.0%sy,100.0%ni,  0.0%id,  0.0%wa,  0.0%hi,  0.0%si,  0.0%st
Mem:   1538488k total,  1490996k used,    47492k free,    21880k buffers
Swap:  4087888k total,      572k used,  4087316k free,  1314228k cached

  PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND
 1423 apache    15   0 35020  12m 3212 S  0.0  0.8   0:00.26 httpd
 1452 apache    15   0 30948 6724  808 S  0.0  0.4   0:00.00 httpd

>7. If you are also loading lots of other Apache modules, such as
mod_perl,
module for PHP etc, list any significant ones so we might understand
what
else may be using memory. Ideally, do the tests with as little
modules loaded
as possible.

# httpd -M
Loaded Modules:
 core_module (static)
 mpm_prefork_module (static)
 http_module (static)
 so_module (static)
 auth_basic_module (shared)
 auth_digest_module (shared)
 authn_file_module (shared)
 authn_alias_module (shared)
 authn_anon_module (shared)
 authn_dbm_module (shared)
 authn_default_module (shared)
 authz_host_module (shared)
 authz_user_module (shared)
 authz_owner_module (shared)
 authz_groupfile_module (shared)
 authz_dbm_module (shared)
 authz_default_module (shared)
 ldap_module (shared)
 authnz_ldap_module (shared)
 include_module (shared)
 log_config_module (shared)
 logio_module (shared)
 env_module (shared)
 ext_filter_module (shared)
 mime_magic_module (shared)
 expires_module (shared)
 deflate_module (shared)
 headers_module (shared)
 usertrack_module (shared)
 setenvif_module (shared)
 mime_module (shared)
 dav_module (shared)
 status_module (shared)
 autoindex_module (shared)
 info_module (shared)
 dav_fs_module (shared)
 vhost_alias_module (shared)
 negotiation_module (shared)
 dir_module (shared)
 actions_module (shared)
 speling_module (shared)
 userdir_module (shared)
 alias_module (shared)
 rewrite_module (shared)
 proxy_module (shared)
 proxy_balancer_module (shared)
 proxy_ftp_module (shared)
 proxy_http_module (shared)
 proxy_connect_module (shared)
 cache_module (shared)
 suexec_module (shared)
 disk_cache_module (shared)
 file_cache_module (shared)
 mem_cache_module (shared)
 cgi_module (shared)
 php5_module (shared)
 proxy_ajp_module (shared)
 python_module (shared)
Syntax OK

HTH. Regards,
-- 
Clodoaldo Pinto Neto
From jpg at jgassociates.ca  Sat Mar  3 11:46:43 2007
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Sat Mar  3 11:45:45 2007
Subject: [mod_python] Apache/mod_python process sizes. Help wanted.
In-Reply-To: <99C69BF9-B599-4BBD-9018-174FC9884492@dscpl.com.au>
References: <99C69BF9-B599-4BBD-9018-174FC9884492@dscpl.com.au>
Message-ID: <45E9A673.4020902@jgassociates.ca>

Graham Dumpleton wrote:
> This email is to enlist the help of mod_python users out there to hopefully
> disprove a possible misconception that exists and which is often used
> to malign mod_python and label it a bad solution to the problem of hosting
> web applications. If intrigued, keep reading, especially as the results may
> end up showing that you might be able to improve the memory use profile
> of your own Apache installation.
> 
> The actual claim which would be nice to disprove is that mod_python
> consumes huge amounts of memory.

> Is there a better way of analysing memory use than this?

I don't have much time to play around today, but I will should tomorrow.

pmap is a great tool for getting really detailed information on memory 
use. As a quick example with worker mpm:

$ top -b -u www-data -n 1 -d 1

   PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND
  5558 www-data  18   0 10100 2232  792 S  0.0  0.2   0:00.00 apache2
  5596 www-data  19   0  227m 3652 1412 S  0.0  0.4   0:00.00 apache2
  5598 www-data  18   0  227m 4112 1804 S  0.0  0.4   0:00.01 apache2

$ ldd /usr/lib/apache2/modules/mod_python.so

         linux-gate.so.1 =>  (0xffffe000)
         libpython2.4.so.1.0 => /usr/lib/libpython2.4.so.1.0 (0xb7eb9000)
         libpthread.so.0 => /lib/tls/i686/cmov/libpthread.so.0 (0xb7ea7000)
         libdl.so.2 => /lib/tls/i686/cmov/libdl.so.2 (0xb7ea4000)
         libutil.so.1 => /lib/tls/i686/cmov/libutil.so.1 (0xb7ea1000)
         libm.so.6 => /lib/tls/i686/cmov/libm.so.6 (0xb7e7e000)
         libc.so.6 => /lib/tls/i686/cmov/libc.so.6 (0xb7d4f000)
         /lib/ld-linux.so.2 (0x80000000)


$ pmap -d 5558 | grep "^Address\|python"

Address   Kbytes Mode  Offset           Device    Mapping
b771f000     888 r-x-- 0000000000000000 003:00004 libpython2.4.so.1.0
b77fd000     156 rwx-- 00000000000de000 003:00004 libpython2.4.so.1.0
b7835000      92 r-x-- 0000000000000000 003:00004 mod_python.so
b784c000      12 rwx-- 0000000000017000 003:00004 mod_python.so

$ pmap -d 5596 | grep "^Address\|python"

Address   Kbytes Mode  Offset           Device    Mapping
b771f000     888 r-x-- 0000000000000000 003:00004 libpython2.4.so.1.0
b77fd000     156 rwx-- 00000000000de000 003:00004 libpython2.4.so.1.0
b7835000      92 r-x-- 0000000000000000 003:00004 mod_python.so
b784c000      12 rwx-- 0000000000017000 003:00004 mod_python.so

$ pmap -d 5598|grep python

b771f000     888 r-x-- 0000000000000000 003:00004 libpython2.4.so.1.0
b77fd000     156 rwx-- 00000000000de000 003:00004 libpython2.4.so.1.0
b7835000      92 r-x-- 0000000000000000 003:00004 mod_python.so
b784c000      12 rwx-- 0000000000017000 003:00004 mod_python.so

To properly profile the memory usage we'd really need to look at which 
libraries are pulled in for libpython2.4.so exclusively.

I'm not accounting for the memory usage attributable to the python stack 
here either. I still need to figure out the best way to get that info, 
which I'll defer to tomorrow.

Just in case someone doesn't have pmap available but is curious about 
the complete output:

$ pmap -d 5598
5598:   /usr/sbin/apache2 -k start -DSSL
Address   Kbytes Mode  Offset           Device    Mapping
08048000     364 r-x-- 0000000000000000 003:00004 apache2
080a3000      12 rwx-- 000000000005a000 003:00004 apache2
080a6000    1924 rwx-- 00000000080a6000 000:00000   [ anon ]
a9e28000      36 r-x-- 0000000000000000 003:00004 libgcc_s.so.1
a9e31000       4 rwx-- 0000000000009000 003:00004 libgcc_s.so.1
a9e32000       4 ----- 00000000a9e32000 000:00000   [ anon ]
a9e33000    8192 rwx-- 00000000a9e33000 000:00000   [ anon ]
aa633000       4 ----- 00000000aa633000 000:00000   [ anon ]
aa634000    8192 rwx-- 00000000aa634000 000:00000   [ anon ]
aae34000       4 ----- 00000000aae34000 000:00000   [ anon ]
aae35000    8192 rwx-- 00000000aae35000 000:00000   [ anon ]
ab635000       4 ----- 00000000ab635000 000:00000   [ anon ]
ab636000    8192 rwx-- 00000000ab636000 000:00000   [ anon ]
abe36000       4 ----- 00000000abe36000 000:00000   [ anon ]
abe37000    8192 rwx-- 00000000abe37000 000:00000   [ anon ]
ac637000       4 ----- 00000000ac637000 000:00000   [ anon ]
ac638000    8192 rwx-- 00000000ac638000 000:00000   [ anon ]
ace38000       4 ----- 00000000ace38000 000:00000   [ anon ]
ace39000    8192 rwx-- 00000000ace39000 000:00000   [ anon ]
ad639000       4 ----- 00000000ad639000 000:00000   [ anon ]
ad63a000    8192 rwx-- 00000000ad63a000 000:00000   [ anon ]
ade3a000       4 ----- 00000000ade3a000 000:00000   [ anon ]
ade3b000    8192 rwx-- 00000000ade3b000 000:00000   [ anon ]
ae63b000       4 ----- 00000000ae63b000 000:00000   [ anon ]
ae63c000    8192 rwx-- 00000000ae63c000 000:00000   [ anon ]
aee3c000       4 ----- 00000000aee3c000 000:00000   [ anon ]
aee3d000    8192 rwx-- 00000000aee3d000 000:00000   [ anon ]
af63d000       4 ----- 00000000af63d000 000:00000   [ anon ]
af63e000    8192 rwx-- 00000000af63e000 000:00000   [ anon ]
afe3e000       4 ----- 00000000afe3e000 000:00000   [ anon ]
afe3f000    8192 rwx-- 00000000afe3f000 000:00000   [ anon ]
b063f000       4 ----- 00000000b063f000 000:00000   [ anon ]
b0640000    8192 rwx-- 00000000b0640000 000:00000   [ anon ]
b0e40000       4 ----- 00000000b0e40000 000:00000   [ anon ]
b0e41000    8192 rwx-- 00000000b0e41000 000:00000   [ anon ]
b1641000       4 ----- 00000000b1641000 000:00000   [ anon ]
b1642000    8192 rwx-- 00000000b1642000 000:00000   [ anon ]
b1e42000       4 ----- 00000000b1e42000 000:00000   [ anon ]
b1e43000    8192 rwx-- 00000000b1e43000 000:00000   [ anon ]
b2643000       4 ----- 00000000b2643000 000:00000   [ anon ]
b2644000    8192 rwx-- 00000000b2644000 000:00000   [ anon ]
b2e44000       4 ----- 00000000b2e44000 000:00000   [ anon ]
b2e45000    8192 rwx-- 00000000b2e45000 000:00000   [ anon ]
b3645000       4 ----- 00000000b3645000 000:00000   [ anon ]
b3646000    8192 rwx-- 00000000b3646000 000:00000   [ anon ]
b3e46000       4 ----- 00000000b3e46000 000:00000   [ anon ]
b3e47000    8192 rwx-- 00000000b3e47000 000:00000   [ anon ]
b4647000       4 ----- 00000000b4647000 000:00000   [ anon ]
b4648000    8192 rwx-- 00000000b4648000 000:00000   [ anon ]
b4e48000       4 ----- 00000000b4e48000 000:00000   [ anon ]
b4e49000    8192 rwx-- 00000000b4e49000 000:00000   [ anon ]
b5649000       4 ----- 00000000b5649000 000:00000   [ anon ]
b564a000    8192 rwx-- 00000000b564a000 000:00000   [ anon ]
b5e4a000       4 ----- 00000000b5e4a000 000:00000   [ anon ]
b5e4b000    8192 rwx-- 00000000b5e4b000 000:00000   [ anon ]
b664b000       4 ----- 00000000b664b000 000:00000   [ anon ]
b664c000    8192 rwx-- 00000000b664c000 000:00000   [ anon ]
b6e4c000       4 ----- 00000000b6e4c000 000:00000   [ anon ]
b6e4d000    8192 rwx-- 00000000b6e4d000 000:00000   [ anon ]
b764d000     208 rwxs- 0000000000000000 000:00007 zero (deleted)
b7681000     520 rwx-- 00000000b7681000 000:00000   [ anon ]
b7703000      36 r-x-- 0000000000000000 003:00004 libnss_files-2.3.6.so
b770c000       4 rwx-- 0000000000008000 003:00004 libnss_files-2.3.6.so
b770d000      32 r-x-- 0000000000000000 003:00004 libnss_nis-2.3.6.so
b7715000       4 rwx-- 0000000000007000 003:00004 libnss_nis-2.3.6.so
b7716000      32 r-x-- 0000000000000000 003:00004 libnss_compat-2.3.6.so
b771e000       4 rwx-- 0000000000007000 003:00004 libnss_compat-2.3.6.so
b771f000     888 r-x-- 0000000000000000 003:00004 libpython2.4.so.1.0
b77fd000     156 rwx-- 00000000000de000 003:00004 libpython2.4.so.1.0
b7824000      16 rwx-- 00000000b7824000 000:00000   [ anon ]
b7835000      92 r-x-- 0000000000000000 003:00004 mod_python.so
b784c000      12 rwx-- 0000000000017000 003:00004 mod_python.so
b784f000     136 r-x-- 0000000000000000 003:00004 libsvn_fs_base-1.so.0.0.0
b7871000       4 rwx-- 0000000000022000 003:00004 libsvn_fs_base-1.so.0.0.0
b7872000      96 r-x-- 0000000000000000 003:00004 libsvn_fs_fs-1.so.0.0.0
b788a000       4 rwx-- 0000000000017000 003:00004 libsvn_fs_fs-1.so.0.0.0
b788b000     148 r-x-- 0000000000000000 003:00004 libsvn_subr-1.so.0.0.0
b78b0000       4 rwx-- 0000000000025000 003:00004 libsvn_subr-1.so.0.0.0
b78b1000      28 r-x-- 0000000000000000 003:00004 libsvn_delta-1.so.0.0.0
b78b8000       4 rwx-- 0000000000006000 003:00004 libsvn_delta-1.so.0.0.0
b78b9000     112 r-x-- 0000000000000000 003:00004 libsvn_repos-1.so.0.0.0
b78d5000       4 rwx-- 000000000001b000 003:00004 libsvn_repos-1.so.0.0.0
b78da000       8 r-x-- 0000000000000000 003:00004 mod_userdir.so
b78dc000       4 rwx-- 0000000000001000 003:00004 mod_userdir.so
b78dd000       8 r-x-- 0000000000000000 003:00004 libutil-2.3.6.so
b78df000       4 rwx-- 0000000000001000 003:00004 libutil-2.3.6.so
b78e0000       8 r-x-- 0000000000000000 003:00004 mod_authz_svn.so
b78e2000       4 rwx-- 0000000000001000 003:00004 mod_authz_svn.so
b78e3000     104 r-x-- 0000000000000000 003:00004 mod_dav_svn.so
b78fd000       4 rwx-- 000000000001a000 003:00004 mod_dav_svn.so
b78fe000      36 r-x-- 0000000000000000 003:00004 mod_dav_fs.so
b7907000       4 rwx-- 0000000000009000 003:00004 mod_dav_fs.so
b7908000      80 r-x-- 0000000000000000 003:00004 mod_dav.so
b791c000       4 rwx-- 0000000000013000 003:00004 mod_dav.so
b791d000       8 rwx-- 00000000b791d000 000:00000   [ anon ]
b791f000      12 r-x-- 0000000000000000 003:00004 libgpg-error.so.0.1.4
b7922000       4 rwx-- 0000000000002000 003:00004 libgpg-error.so.0.1.4
b7923000       4 rwx-- 00000000b7923000 000:00000   [ anon ]
b7924000     284 r-x-- 0000000000000000 003:00004 libgcrypt.so.11.2.1
b796b000      20 rwx-- 0000000000047000 003:00004 libgcrypt.so.11.2.1
b7970000      60 r-x-- 0000000000000000 003:00004 libtasn1.so.2.0.17
b797f000       4 rwx-- 000000000000f000 003:00004 libtasn1.so.2.0.17
b7980000     396 r-x-- 0000000000000000 003:00004 libgnutls.so.12.3.6
b79e3000      24 rwx-- 0000000000062000 003:00004 libgnutls.so.12.3.6
b79e9000      76 r-x-- 0000000000000000 003:00004 libsasl2.so.2.0.19
b79fc000       4 rwx-- 0000000000013000 003:00004 libsasl2.so.2.0.19
b79fd000      64 r-x-- 0000000000000000 003:00004 libresolv-2.3.6.so
b7a0d000       4 rwx-- 0000000000010000 003:00004 libresolv-2.3.6.so
b7a0e000      12 rwx-- 00000000b7a0e000 000:00000   [ anon ]
b7a11000    1172 r-x-- 0000000000000000 003:00004 libc-2.3.6.so
b7b36000      28 rwx-- 0000000000125000 003:00004 libc-2.3.6.so
b7b3d000      12 rwx-- 00000000b7b3d000 000:00000   [ anon ]
b7b40000       8 r-x-- 0000000000000000 003:00004 libdl-2.3.6.so
b7b42000       4 rwx-- 0000000000001000 003:00004 libdl-2.3.6.so
b7b43000      60 r-x-- 0000000000000000 003:00004 libpthread-2.3.6.so
b7b52000       4 rwx-- 000000000000e000 003:00004 libpthread-2.3.6.so
b7b53000       8 rwx-- 00000000b7b53000 000:00000   [ anon ]
b7b55000      72 r-x-- 0000000000000000 003:00004 libnsl-2.3.6.so
b7b67000       4 rwx-- 0000000000012000 003:00004 libnsl-2.3.6.so
b7b68000       8 rwx-- 00000000b7b68000 000:00000   [ anon ]
b7b6a000      20 r-x-- 0000000000000000 003:00004 libcrypt-2.3.6.so
b7b6f000       4 rwx-- 0000000000004000 003:00004 libcrypt-2.3.6.so
b7b70000     156 rwx-- 00000000b7b70000 000:00000   [ anon ]
b7b97000     132 r-x-- 0000000000000000 003:00004 libm-2.3.6.so
b7bb8000       4 rwx-- 0000000000020000 003:00004 libm-2.3.6.so
b7bb9000       4 rwx-- 00000000b7bb9000 000:00000   [ anon ]
b7bba000      28 r-x-- 0000000000000000 003:00004 librt-2.3.6.so
b7bc1000       4 rwx-- 0000000000006000 003:00004 librt-2.3.6.so
b7bc2000     120 r-x-- 0000000000000000 003:00004 libapr-0.so.0.9.7
b7be0000       4 rwx-- 000000000001d000 003:00004 libapr-0.so.0.9.7
b7be1000       4 rwx-- 00000000b7be1000 000:00000   [ anon ]
b7be2000     112 r-x-- 0000000000000000 003:00004 libexpat.so.1.0.0
b7bfe000      12 rwx-- 000000000001c000 003:00004 libexpat.so.1.0.0
b7c01000     868 r-x-- 0000000000000000 003:00004 libdb-4.3.so
b7cda000      12 rwx-- 00000000000d8000 003:00004 libdb-4.3.so
b7cdd000      44 r-x-- 0000000000000000 003:00004 liblber.so.2.0.130
b7ce8000       4 rwx-- 000000000000a000 003:00004 liblber.so.2.0.130
b7ce9000     204 r-x-- 0000000000000000 003:00004 libldap_r.so.2.0.130
b7d1c000       4 rwx-- 0000000000033000 003:00004 libldap_r.so.2.0.130
b7d1d000       4 rwx-- 00000000b7d1d000 000:00000   [ anon ]
b7d1e000      76 r-x-- 0000000000000000 003:00004 libaprutil-0.so.0.9.7
b7d31000       4 rwx-- 0000000000013000 003:00004 libaprutil-0.so.0.9.7
b7d32000    1116 r-x-- 0000000000000000 003:00004 libcrypto.so.0.9.8
b7e49000      84 rwx-- 0000000000116000 003:00004 libcrypto.so.0.9.8
b7e5e000      12 rwx-- 00000000b7e5e000 000:00000   [ anon ]
b7e61000     228 r-x-- 0000000000000000 003:00004 libssl.so.0.9.8
b7e9a000      16 rwx-- 0000000000039000 003:00004 libssl.so.0.9.8
b7e9e000      76 r-x-- 0000000000000000 003:00004 libz.so.1.2.3
b7eb1000       4 rwx-- 0000000000012000 003:00004 libz.so.1.2.3
b7eb2000      92 r-x-- 0000000000000000 003:00004 libpcre.so.3.12.0
b7ec9000      92 rwx-- 0000000000016000 003:00004 libpcre.so.3.12.0
b7ee1000      16 r-x-- 0000000000000000 003:00004 libsvn_fs-1.so.0.0.0
b7ee5000       4 rwx-- 0000000000003000 003:00004 libsvn_fs-1.so.0.0.0
b7ee6000      24 r-x-- 0000000000000000 003:00004 mod_cgid.so
b7eec000       4 rwx-- 0000000000006000 003:00004 mod_cgid.so
b7eed000      12 rwx-- 00000000b7eed000 000:00000   [ anon ]
b7ef0000      84 r-x-- 0000000000000000 003:00004 ld-2.3.6.so
b7f05000       4 rwx-- 0000000000014000 003:00004 ld-2.3.6.so
bfaef000      84 rwx-- 00000000bfaef000 000:00000   [ stack ]
bfb04000       4 rw--- 00000000bfb04000 000:00000   [ anon ]
ffffe000       4 ----- 0000000000000000 000:00000   [ anon ]
mapped: 232584K    writeable/private: 224576K    shared: 208K


Interestingly, on another apache instance (prefork, with php4):
$ pmap -d 895 | grep "^Address\|php"
Address   Kbytes Mode  Offset           Device    Mapping
405d6000    2936 r-x-- 0000000000000000 008:00001 libphp4.so
408b4000     120 rw--- 00000000002de000 008:00001 libphp4.so

Oh...my...God... php4 is HUGE. ;)

Jim
From list at joreybump.com  Sat Mar  3 15:54:49 2007
From: list at joreybump.com (Jorey Bump)
Date: Sat Mar  3 15:54:58 2007
Subject: [mod_python] Apache/mod_python process sizes. Help wanted.
In-Reply-To: <99C69BF9-B599-4BBD-9018-174FC9884492@dscpl.com.au>
References: <99C69BF9-B599-4BBD-9018-174FC9884492@dscpl.com.au>
Message-ID: <45E9E099.1000003@joreybump.com>

Graham Dumpleton wrote:

> 1. Operating System

Slackware Linux 10.2

$ uname -a
Linux degas 2.4.31 #21 Sun Jun 5 19:19:51 PDT 2005 i686 unknown unknown 
GNU/Linux

> 2. Size of mod_python.so.

$ ls -las /usr/local/apache2/modules/mod_python.so
1192 -rwxr-xr-x  1 root root 1213776 2007-02-01 11:44 
/usr/local/apache2/modules/mod_python.so

> 3. Size of Python library. This should exist in the 'lib/pythonX.Y/config'
> directory of your Python installation. Ie., at same directory level as your
> 'site-packages' directory. It would be called 'libpythonX.Y.a', 
> 'libpythonX.Y.so'
> or 'libpythonX.Y.sl'.

ls -las /usr/lib/python2.4/config/libpython2.4.a
1700 -rw-r--r--  1 root root 1733986 2005-04-11 01:32 
/usr/lib/python2.4/config/libpython2.4.a

> 4. Confirm whether mod_python.so uses Python library as static library or
> shared library. On UNIX systems you can use the 'ldd' command on
> mod_python.so to determine this.

$ ldd /usr/local/apache2/modules/mod_python.so
         libpthread.so.0 => /lib/libpthread.so.0 (0x40144000)
         libdl.so.2 => /lib/libdl.so.2 (0x40196000)
         libutil.so.1 => /lib/libutil.so.1 (0x4019a000)
         libm.so.6 => /lib/libm.so.6 (0x4019e000)
         libc.so.6 => /lib/libc.so.6 (0x401c1000)
         /lib/ld-linux.so.2 (0x80000000)

> 5. Work out how much memory Apache uses when mod_python is not being
> loaded. One can use 'top' for this. Hopefully others may suggest better 
> ways.

Comment out mod_python in httpd.conf:

# Include conf/local/mod_python.conf

Fully stop then start apache:

# /etc/rc.d/rc.apache stop
# /etc/rc.d/rc.apache start

$ top -U nobody
top - 15:26:01 up 93 days,  5:49,  1 user,  load average: 0.00, 0.07, 0.08
Tasks:  69 total,   2 running,  67 sleeping,   0 stopped,   0 zombie
Cpu(s):   0.0% user,   0.0% system,   0.0% nice, 100.0% idle
Mem:    904440k total,   448276k used,   456164k free,    38520k buffers
Swap:  1951856k total,    32408k used,  1919448k free,   111932k cached

   PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND
31424 nobody    11   0  7572 7572 7444 S  0.0  0.8   0:00.00 httpd
31425 nobody    13   0  7572 7572 7448 S  0.0  0.8   0:00.00 httpd
31426 nobody    13   0  7572 7572 7448 S  0.0  0.8   0:00.00 httpd
31427 nobody    14   0  7572 7572 7448 S  0.0  0.8   0:00.00 httpd
31428 nobody    17   0  7572 7572 7448 S  0.0  0.8   0:00.00 httpd


> 6. Work out how much memory Apache uses when mod_python is loaded
> but before any requests have occurred. Ensure that no PythonImport
> directives have been used.

Enable mod_python in httpd.conf:

Include conf/local/mod_python.conf

Fully stop then start apache:

# /etc/rc.d/rc.apache stop
# /etc/rc.d/rc.apache start

$ top -U nobody

top - 15:28:43 up 93 days,  5:51,  1 user,  load average: 0.00, 0.04, 0.07
Tasks:  78 total,   1 running,  77 sleeping,   0 stopped,   0 zombie
Cpu(s):   0.4% user,   0.1% system,   0.0% nice,  99.5% idle
Mem:    904440k total,   461256k used,   443184k free,    39208k buffers
Swap:  1951856k total,    32408k used,  1919448k free,   113432k cached

   PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND
31480 nobody    11   0  9164 9164 8956 S  0.0  1.0   0:00.00 httpd
31481 nobody    11   0  9164 9164 8960 S  0.0  1.0   0:00.01 httpd
31482 nobody    13   0  9164 9164 8960 S  0.0  1.0   0:00.00 httpd
31483 nobody    13   0  9164 9164 8960 S  0.0  1.0   0:00.00 httpd
31484 nobody    14   0  9164 9164 8960 S  0.0  1.0   0:00.00 httpd

> If eager, use a hello world mod_python example and trigger one request
> against it and see how size changes.

top - 15:29:18 up 93 days,  5:52,  1 user,  load average: 0.00, 0.03, 0.07
Tasks:  78 total,   2 running,  76 sleeping,   0 stopped,   0 zombie
Cpu(s):   4.7% user,   0.3% system,   0.0% nice,  95.0% idle
Mem:    904440k total,   465304k used,   439136k free,    39272k buffers
Swap:  1951856k total,    32408k used,  1919448k free,   113432k cached

   PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND
31480 nobody    14   0 13248  12m 8836 S  5.0  1.5   0:00.15 httpd

> 7. If you are also loading lots of other Apache modules, such as mod_perl,
> module for PHP etc, list any significant ones so we might understand what
> else may be using memory. Ideally, do the tests with as little modules 
> loaded
> as possible.

# /usr/local/apache2/bin/httpd -M
Loaded Modules:
  core_module (static)
  mpm_prefork_module (static)
  http_module (static)
  so_module (static)
  authn_file_module (shared)
  authn_default_module (shared)
  authz_host_module (shared)
  authz_groupfile_module (shared)
  authz_user_module (shared)
  authz_default_module (shared)
  auth_basic_module (shared)
  auth_digest_module (shared)
  filter_module (shared)
  deflate_module (shared)
  log_config_module (shared)
  logio_module (shared)
  env_module (shared)
  mime_magic_module (shared)
  cern_meta_module (shared)
  expires_module (shared)
  headers_module (shared)
  setenvif_module (shared)
  ssl_module (shared)
  mime_module (shared)
  dav_module (shared)
  status_module (shared)
  autoindex_module (shared)
  asis_module (shared)
  info_module (shared)
  cgi_module (shared)
  dav_fs_module (shared)
  vhost_alias_module (shared)
  negotiation_module (shared)
  dir_module (shared)
  actions_module (shared)
  userdir_module (shared)
  alias_module (shared)
  rewrite_module (shared)
  php5_module (shared)
  python_module (shared)

> So, what do other people get?
> 
> Is that fact that Python installations often only provide a static Python
> library the culprit?

Not sure, but I noticed something else that I found interesting: Without 
mod_python loaded, starting with a complete stop of apache, start, then 
several restarts, the top output showed httpd growing by 8 bytes with 
each restart. After loading mod_python, then repeating the process, 
httpd grew 628 bytes with each restart. Not a lot, but significantly 
more than 8 bytes. What are the long term implications of this?

> Is there a better way of analysing memory use than this?

Here's Jim's suggestion for pmap:

$ pmap -d 31480 | grep python
40cd5000    1020 r-x-- 0000000000000000 008:00002 mod_python.so
40dd4000     164 rw--- 00000000000ff000 008:00002 mod_python.so

From list at joreybump.com  Sat Mar  3 16:07:35 2007
From: list at joreybump.com (Jorey Bump)
Date: Sat Mar  3 16:07:39 2007
Subject: [mod_python] Apache/mod_python process sizes. Help wanted.
In-Reply-To: <45E9A673.4020902@jgassociates.ca>
References: <99C69BF9-B599-4BBD-9018-174FC9884492@dscpl.com.au>
	<45E9A673.4020902@jgassociates.ca>
Message-ID: <45E9E397.5070401@joreybump.com>

Jim Gallacher wrote:

> Interestingly, on another apache instance (prefork, with php4):
> $ pmap -d 895 | grep "^Address\|php"
> Address   Kbytes Mode  Offset           Device    Mapping
> 405d6000    2936 r-x-- 0000000000000000 008:00001 libphp4.so
> 408b4000     120 rw--- 00000000002de000 008:00001 libphp4.so
> 
> Oh...my...God... php4 is HUGE. ;)

pffft... Mine's bigger:

$ pmap -d 17060 | grep php
40450000    4756 r-x-- 0000000000000000 008:00002 libphp5.so
408f5000     676 rw--- 00000000004a5000 008:00002 libphp5.so

And it goes to 5!
From grahamd at dscpl.com.au  Sat Mar  3 17:30:57 2007
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Sat Mar  3 17:32:43 2007
Subject: [mod_python] Apache/mod_python process sizes. Help wanted.
In-Reply-To: <45E9E099.1000003@joreybump.com>
References: <99C69BF9-B599-4BBD-9018-174FC9884492@dscpl.com.au>
	<45E9E099.1000003@joreybump.com>
Message-ID: <B76BC114-0C62-42B1-AAFF-40B604E1AAB1@dscpl.com.au>


On 04/03/2007, at 7:54 AM, Jorey Bump wrote:

>
>> If eager, use a hello world mod_python example and trigger one  
>> request
>> against it and see how size changes.
>
> top - 15:29:18 up 93 days,  5:52,  1 user,  load average: 0.00,  
> 0.03, 0.07
> Tasks:  78 total,   2 running,  76 sleeping,   0 stopped,   0 zombie
> Cpu(s):   4.7% user,   0.3% system,   0.0% nice,  95.0% idle
> Mem:    904440k total,   465304k used,   439136k free,    39272k  
> buffers
> Swap:  1951856k total,    32408k used,  1919448k free,   113432k  
> cached
>
>   PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND
> 31480 nobody    14   0 13248  12m 8836 S  5.0  1.5   0:00.15 httpd

Thanks for the feedback so far guys. First thing this all shows is  
that need
a more conclusive way of determining how memory is used by Apache
process as top alone isn't that good. I'll look at pmap as suggested and
see what else there might be.

Apart from the size of PHP, what is disturbing to me though is how much
the amount of memory used jumps up on the first request. In phase 1 of
looking at this, wasn't intending to look at that aspect, but just  
threw in the
request to try it as an afterthought. I had actually forgotten that  
it does jump
up quite significantly.

The reason I had forgotten is that these days I have been playing with
mod_wsgi most of the time and have grown accustomed to a small memory
footprint.

As an example, on MacOS with both mod_python and mod_wsgi modules
loaded I start out with:

   408 httpd        0.0%  0:00.00   1     8    39   212K  2.86M    
900K  30.4M
   407 httpd        0.0%  0:00.00   1     8    39   216K  2.86M    
904K  30.4M
   406 httpd        0.0%  0:00.00   1     8    39   216K  2.86M    
904K  30.4M
   405 httpd        0.0%  0:00.00   1     8    39   216K  2.86M    
904K  30.4M
   404 httpd        0.0%  0:00.00   1     8    39   212K  2.86M    
904K  30.4M
   403 httpd        0.0%  0:00.06   1    11    39    44K  2.86M   
1.78M  30.4M

Ie., 212K - 216K memory private to the Apache child process.

I then fire off a mod_python and mod_wsgi request. For both modules, I
have forced use of the first Python interpreter instance created to  
avoid
the creation of an extra interpreter. Being the first interpreter, it  
is also
used for both mod_python and mod_wsgi requests, whereas normally
all other interpreter instances are separate to each package.

For both cases use simple hello world program. With mod_python use a
basic handler and not mod_python.publisher.

The result for mod_python request is (pid 405):

   410 httpd        0.0%  0:00.00   1     8    39   212K  2.87M    
888K  30.4M
   408 httpd        0.0%  0:00.00   1     8    39   212K  2.87M    
764K  30.4M
   407 httpd        0.0%  0:00.00   1     8    39   216K  2.87M    
768K  30.4M
   406 httpd        0.0%  0:00.00   1     8    39   216K  2.87M    
768K  30.4M
   405 httpd        0.0%  0:00.37   1    10    86  2.40M  2.75M   
3.94M  32.0M
   404 httpd        0.0%  0:00.00   1     8    39   212K  2.87M    
768K  30.4M
   403 httpd        0.0%  0:00.06   1    11    39    32K  2.87M   
1.30M  30.4M

Thus, private memory use by Apache child process jumps up to 2.40M.
Ie., about an extra 2.2M.

For a mod_wsgi request however, the result is (pid 407):

   410 httpd        0.0%  0:00.00   1     8    39   212K  2.87M    
816K  30.4M
   408 httpd        0.0%  0:00.00   1     8    39   212K  2.87M    
764K  30.4M
   407 httpd        0.0%  0:00.01   1    10    39   568K  2.87M  1.64M 
+ 30.4M
   406 httpd        0.0%  0:00.00   1     8    39   216K  2.87M    
768K  30.4M
   405 httpd        0.0%  0:00.37   1    10    86  2.40M  2.75M   
3.95M  32.0M
   404 httpd        0.0%  0:00.00   1     8    39   212K  2.87M    
768K  30.4M
   403 httpd        0.0%  0:00.06   1    11    39    32K  2.87M   
1.30M  30.4M

That is, private memory use by Apache child process only jumps up to  
568K.
Ie., about an extra 350K.

This is quite a big difference and really makes one wander what  
mod_python
is actually doing. This will also have to be investigated, but  
probably still
want to pursue this shared versus static library thing first.

Graham
From grahamd at dscpl.com.au  Sat Mar  3 17:47:46 2007
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Sat Mar  3 17:49:31 2007
Subject: [mod_python] Apache/mod_python process sizes. Help wanted.
In-Reply-To: <B76BC114-0C62-42B1-AAFF-40B604E1AAB1@dscpl.com.au>
References: <99C69BF9-B599-4BBD-9018-174FC9884492@dscpl.com.au>
	<45E9E099.1000003@joreybump.com>
	<B76BC114-0C62-42B1-AAFF-40B604E1AAB1@dscpl.com.au>
Message-ID: <6845B1B4-9242-4CFA-B420-150C101ECBF9@dscpl.com.au>


On 04/03/2007, at 9:30 AM, Graham Dumpleton wrote:

> The result for mod_python request is (pid 405):
>
>   410 httpd        0.0%  0:00.00   1     8    39   212K  2.87M    
> 888K  30.4M
>   408 httpd        0.0%  0:00.00   1     8    39   212K  2.87M    
> 764K  30.4M
>   407 httpd        0.0%  0:00.00   1     8    39   216K  2.87M    
> 768K  30.4M
>   406 httpd        0.0%  0:00.00   1     8    39   216K  2.87M    
> 768K  30.4M
>   405 httpd        0.0%  0:00.37   1    10    86  2.40M  2.75M   
> 3.94M  32.0M
>   404 httpd        0.0%  0:00.00   1     8    39   212K  2.87M    
> 768K  30.4M
>   403 httpd        0.0%  0:00.06   1    11    39    32K  2.87M   
> 1.30M  30.4M
>
> Thus, private memory use by Apache child process jumps up to 2.40M.
> Ie., about an extra 2.2M.
>
> For a mod_wsgi request however, the result is (pid 407):
>
>   410 httpd        0.0%  0:00.00   1     8    39   212K  2.87M    
> 816K  30.4M
>   408 httpd        0.0%  0:00.00   1     8    39   212K  2.87M    
> 764K  30.4M
>   407 httpd        0.0%  0:00.01   1    10    39   568K  2.87M   
> 1.64M+ 30.4M
>   406 httpd        0.0%  0:00.00   1     8    39   216K  2.87M    
> 768K  30.4M
>   405 httpd        0.0%  0:00.37   1    10    86  2.40M  2.75M   
> 3.95M  32.0M
>   404 httpd        0.0%  0:00.00   1     8    39   212K  2.87M    
> 768K  30.4M
>   403 httpd        0.0%  0:00.06   1    11    39    32K  2.87M   
> 1.30M  30.4M
>
> That is, private memory use by Apache child process only jumps up  
> to 568K.
> Ie., about an extra 350K.
>
> This is quite a big difference and really makes one wander what  
> mod_python
> is actually doing. This will also have to be investigated, but  
> probably still
> want to pursue this shared versus static library thing first.

Part of the jump is the imports in mod_python.apache:

import sys
import traceback
import time
import os
import pdb
import stat
import imp
import types
import cgi
import _apache
import threading

I had been thinking they would have been done when mod_python loaded
for first interpreter, but they aren't done until time of first request.

If I import the same modules into mod_wsgi example, then get (pid 429):

   432 httpd        0.0%  0:00.00   1     8    39   212K  2.87M    
904K  30.4M
   430 httpd        0.0%  0:00.00   1     8    39   212K  2.87M    
776K  30.4M
   429 httpd        0.0%  0:00.18   1    10    67  1.95M  2.88M   
3.33M  31.5M
   428 httpd        0.0%  0:00.00   1     8    39   216K  2.87M    
780K  30.4M
   427 httpd        0.0%  0:00.00   1     8    39   216K  2.87M    
780K  30.4M
   426 httpd        0.0%  0:00.00   1     8    39   212K  2.87M    
780K  30.4M
   425 httpd        0.0%  0:00.07   1    11    39    32K  2.87M   
1.34M  30.4M

Thus these modules alone causes it to jump up to 1.95M. This works out
about an extra 1.4MB. Because mod_wsgi is all in C code aren't  
relying on
any Python modules so base overhead is less.

Interesting. How many of these modules could be avoided in mod_python
if we tried hard?

Graham
From jpg at jgassociates.ca  Sat Mar  3 19:31:34 2007
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Sat Mar  3 19:27:04 2007
Subject: [mod_python] Apache/mod_python process sizes. Help wanted.
In-Reply-To: <6845B1B4-9242-4CFA-B420-150C101ECBF9@dscpl.com.au>
References: <99C69BF9-B599-4BBD-9018-174FC9884492@dscpl.com.au>	<45E9E099.1000003@joreybump.com>	<B76BC114-0C62-42B1-AAFF-40B604E1AAB1@dscpl.com.au>
	<6845B1B4-9242-4CFA-B420-150C101ECBF9@dscpl.com.au>
Message-ID: <45EA1366.5070003@jgassociates.ca>

Graham Dumpleton wrote:
> 
> On 04/03/2007, at 9:30 AM, Graham Dumpleton wrote:
> 
>> The result for mod_python request is (pid 405):
>>
>>   410 httpd        0.0%  0:00.00   1     8    39   212K  2.87M   888K  
>> 30.4M
>>   408 httpd        0.0%  0:00.00   1     8    39   212K  2.87M   764K  
>> 30.4M
>>   407 httpd        0.0%  0:00.00   1     8    39   216K  2.87M   768K  
>> 30.4M
>>   406 httpd        0.0%  0:00.00   1     8    39   216K  2.87M   768K  
>> 30.4M
>>   405 httpd        0.0%  0:00.37   1    10    86  2.40M  2.75M  3.94M  
>> 32.0M
>>   404 httpd        0.0%  0:00.00   1     8    39   212K  2.87M   768K  
>> 30.4M
>>   403 httpd        0.0%  0:00.06   1    11    39    32K  2.87M  1.30M  
>> 30.4M
>>
>> Thus, private memory use by Apache child process jumps up to 2.40M.
>> Ie., about an extra 2.2M.
>>
>> For a mod_wsgi request however, the result is (pid 407):
>>
>>   410 httpd        0.0%  0:00.00   1     8    39   212K  2.87M   816K  
>> 30.4M
>>   408 httpd        0.0%  0:00.00   1     8    39   212K  2.87M   764K  
>> 30.4M
>>   407 httpd        0.0%  0:00.01   1    10    39   568K  2.87M  1.64M+ 
>> 30.4M
>>   406 httpd        0.0%  0:00.00   1     8    39   216K  2.87M   768K  
>> 30.4M
>>   405 httpd        0.0%  0:00.37   1    10    86  2.40M  2.75M  3.95M  
>> 32.0M
>>   404 httpd        0.0%  0:00.00   1     8    39   212K  2.87M   768K  
>> 30.4M
>>   403 httpd        0.0%  0:00.06   1    11    39    32K  2.87M  1.30M  
>> 30.4M
>>
>> That is, private memory use by Apache child process only jumps up to 
>> 568K.
>> Ie., about an extra 350K.
>>
>> This is quite a big difference and really makes one wander what 
>> mod_python
>> is actually doing. This will also have to be investigated, but 
>> probably still
>> want to pursue this shared versus static library thing first.
> 
> Part of the jump is the imports in mod_python.apache:
> 
> import sys
> import traceback
> import time
> import os
> import pdb
> import stat
> import imp
> import types
> import cgi
> import _apache
> import threading
> 
> I had been thinking they would have been done when mod_python loaded
> for first interpreter, but they aren't done until time of first request.
> 
> If I import the same modules into mod_wsgi example, then get (pid 429):
> 
>   432 httpd        0.0%  0:00.00   1     8    39   212K  2.87M   904K  
> 30.4M
>   430 httpd        0.0%  0:00.00   1     8    39   212K  2.87M   776K  
> 30.4M
>   429 httpd        0.0%  0:00.18   1    10    67  1.95M  2.88M  3.33M  
> 31.5M
>   428 httpd        0.0%  0:00.00   1     8    39   216K  2.87M   780K  
> 30.4M
>   427 httpd        0.0%  0:00.00   1     8    39   216K  2.87M   780K  
> 30.4M
>   426 httpd        0.0%  0:00.00   1     8    39   212K  2.87M   780K  
> 30.4M
>   425 httpd        0.0%  0:00.07   1    11    39    32K  2.87M  1.34M  
> 30.4M
> 
> Thus these modules alone causes it to jump up to 1.95M. This works out
> about an extra 1.4MB. Because mod_wsgi is all in C code aren't relying on
> any Python modules so base overhead is less.
> 
> Interesting. How many of these modules could be avoided in mod_python
> if we tried hard?

I have no idea, but it's worth a look.

Attached is a fun little script that uses pmap to examine the changes. 
You'll need to modify the $URL in the script so it points to an 
appropriate mod_python script.

Results for before and after running a helloworld.py script:

--- before/30006.log	2007-03-03 18:59:20.000000000 -0500
+++ after/30006.log	2007-03-03 18:59:20.000000000 -0500
@@ -2,7 +2,40 @@
  Address   Kbytes Mode  Offset           Device    Mapping
  08048000     364 r-x-- 0000000000000000 003:00004 apache2
  080a3000      12 rw--- 000000000005a000 003:00004 apache2
-080a6000    1792 rw--- 00000000080a6000 000:00000   [ anon ]
+080a6000    2592 rw--- 00000000080a6000 000:00000   [ anon ]
+a9cd4000       4 r-x-- 0000000000000000 003:00004 _weakref.so
+a9cd5000       4 rw--- 0000000000000000 003:00004 _weakref.so
+a9cd6000       4 r-x-- 0000000000000000 003:00004 _bisect.so
+a9cd7000       4 rw--- 0000000000001000 003:00004 _bisect.so
+a9cd8000     260 rw--- 00000000a9cd8000 000:00000   [ anon ]
+a9d19000      12 r-x-- 0000000000000000 003:00004 sha.so
+a9d1c000       4 rw--- 0000000000002000 003:00004 sha.so
+a9d1d000       8 r-x-- 0000000000000000 003:00004 md5.so
+a9d1f000       4 rw--- 0000000000002000 003:00004 md5.so
+a9d20000     388 rw--- 00000000a9d20000 000:00000   [ anon ]
+a9d81000      56 r-x-- 0000000000000000 003:00004 datetime.so
+a9d8f000      12 rw--- 000000000000d000 003:00004 datetime.so
+a9d92000     260 rw--- 00000000a9d92000 000:00000   [ anon ]
+a9dd3000      16 r-x-- 0000000000000000 003:00004 struct.so
+a9dd7000       4 rw--- 0000000000004000 003:00004 struct.so
+a9dd8000      12 r-x-- 0000000000000000 003:00004 collections.so
+a9ddb000       4 rw--- 0000000000003000 003:00004 collections.so
+a9ddc000       8 r-x-- 0000000000000000 003:00004 fcntl.so
+a9dde000       4 rw--- 0000000000002000 003:00004 fcntl.so
+a9ddf000       8 r-x-- 0000000000000000 003:00004 _random.so
+a9de1000       4 rw--- 0000000000002000 003:00004 _random.so
+a9de2000      12 r-x-- 0000000000000000 003:00004 binascii.so
+a9de5000       8 rw--- 0000000000002000 003:00004 binascii.so
+a9de7000      12 r-x-- 0000000000000000 003:00004 math.so
+a9dea000       4 rw--- 0000000000002000 003:00004 math.so
+a9deb000     260 rw--- 00000000a9deb000 000:00000   [ anon ]
+a9e2c000      12 r-x-- 0000000000000000 003:00004 _ssl.so
+a9e2f000       4 rw--- 0000000000003000 003:00004 _ssl.so
+a9e30000      36 r-x-- 0000000000000000 003:00004 _socket.so
+a9e39000      12 rw--- 0000000000009000 003:00004 _socket.so
+a9e3c000      20 r-x-- 0000000000000000 003:00004 itertools.so
+a9e41000       8 rw--- 0000000000004000 003:00004 itertools.so
+a9e43000     260 rw--- 00000000a9e43000 000:00000   [ anon ]
  a9e84000      36 r-x-- 0000000000000000 003:00004 libgcc_s.so.1
  a9e8d000       4 rw--- 0000000000009000 003:00004 libgcc_s.so.1
  a9e8e000       4 ----- 00000000a9e8e000 000:00000   [ anon ]
@@ -70,6 +103,12 @@
  b777b000     888 r-x-- 0000000000000000 003:00004 libpython2.4.so.1.0
  b7859000     156 rw--- 00000000000de000 003:00004 libpython2.4.so.1.0
  b7880000      16 rw--- 00000000b7880000 000:00000   [ anon ]
+b7884000       4 r-x-- 0000000000000000 003:00004 syslog.so
+b7885000       4 rw--- 0000000000001000 003:00004 syslog.so
+b7886000      16 r-x-- 0000000000000000 003:00004 strop.so
+b788a000       8 rw--- 0000000000003000 003:00004 strop.so
+b788c000      12 r-x-- 0000000000000000 003:00004 time.so
+b788f000       8 rw--- 0000000000002000 003:00004 time.so
  b7891000      92 r-x-- 0000000000000000 003:00004 mod_python.so
  b78a8000      12 rw--- 0000000000017000 003:00004 mod_python.so
  b78ab000     136 r-x-- 0000000000000000 003:00004 
libsvn_fs_base-1.so.0.0.0
@@ -82,6 +121,8 @@
  b7914000       4 rw--- 0000000000006000 003:00004 libsvn_delta-1.so.0.0.0
  b7915000     112 r-x-- 0000000000000000 003:00004 libsvn_repos-1.so.0.0.0
  b7931000       4 rw--- 000000000001b000 003:00004 libsvn_repos-1.so.0.0.0
+b7932000      12 r-x-- 0000000000000000 003:00004 cStringIO.so
+b7935000       4 rw--- 0000000000003000 003:00004 cStringIO.so
  b7936000       8 r-x-- 0000000000000000 003:00004 mod_userdir.so
  b7938000       4 rw--- 0000000000001000 003:00004 mod_userdir.so
  b7939000       8 r-x-- 0000000000000000 003:00004 libutil-2.3.6.so
@@ -161,4 +202,4 @@
  bfb4b000      80 rwx-- 00000000bfb4b000 000:00000   [ stack ]
  bfb5f000       8 rw--- 00000000bfb5f000 000:00000   [ anon ]
  ffffe000       4 ----- 0000000000000000 000:00000   [ anon ]
-mapped: 232452K    writeable/private: 224444K    shared: 208K
+mapped: 235048K    writeable/private: 226776K    shared: 208K


So we are increasing memory usage by 4928K (2596K mapped + 2332K 
writable/private) which is in line with what Graham found using top.

Jim

-------------- next part --------------
A non-text attachment was scrubbed...
Name: quickie-profile.sh
Type: application/x-shellscript
Size: 510 bytes
Desc: not available
Url : http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070303/038809bc/quickie-profile-0001.bin
From grahamd at dscpl.com.au  Sat Mar  3 19:36:09 2007
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Sat Mar  3 19:38:03 2007
Subject: [mod_python] Apache/mod_python process sizes. Help wanted.
In-Reply-To: <45EA1366.5070003@jgassociates.ca>
References: <99C69BF9-B599-4BBD-9018-174FC9884492@dscpl.com.au>	<45E9E099.1000003@joreybump.com>	<B76BC114-0C62-42B1-AAFF-40B604E1AAB1@dscpl.com.au>
	<6845B1B4-9242-4CFA-B420-150C101ECBF9@dscpl.com.au>
	<45EA1366.5070003@jgassociates.ca>
Message-ID: <9B4F4598-0595-4098-BAA1-7E3FF9442C49@dscpl.com.au>


On 04/03/2007, at 11:31 AM, Jim Gallacher wrote:

>> Part of the jump is the imports in mod_python.apache:
>> import sys
>> import traceback
>> import time
>> import os
>> import pdb
>> import stat
>> import imp
>> import types
>> import cgi
>> import _apache
>> import threading
>> I had been thinking they would have been done when mod_python loaded
>> for first interpreter, but they aren't done until time of first  
>> request.
>> If I import the same modules into mod_wsgi example, then get (pid  
>> 429):
>>   432 httpd        0.0%  0:00.00   1     8    39   212K  2.87M    
>> 904K  30.4M
>>   430 httpd        0.0%  0:00.00   1     8    39   212K  2.87M    
>> 776K  30.4M
>>   429 httpd        0.0%  0:00.18   1    10    67  1.95M  2.88M   
>> 3.33M  31.5M
>>   428 httpd        0.0%  0:00.00   1     8    39   216K  2.87M    
>> 780K  30.4M
>>   427 httpd        0.0%  0:00.00   1     8    39   216K  2.87M    
>> 780K  30.4M
>>   426 httpd        0.0%  0:00.00   1     8    39   212K  2.87M    
>> 780K  30.4M
>>   425 httpd        0.0%  0:00.07   1    11    39    32K  2.87M   
>> 1.34M  30.4M
>> Thus these modules alone causes it to jump up to 1.95M. This works  
>> out
>> about an extra 1.4MB. Because mod_wsgi is all in C code aren't  
>> relying on
>> any Python modules so base overhead is less.
>> Interesting. How many of these modules could be avoided in mod_python
>> if we tried hard?
>
> I have no idea, but it's worth a look.

It is quite easy to get rid of 'cgi' as all that is used in it is  
cgi.escape(). We can
just duplicate that one function:

def escape(s, quote=None):
   s = string.replace(s,"&","&amp;")
   s = string.replace(s,"<","&lt;")
   s = string.replace(s,">","&gt;",)
   if quote:
     s = string.replace(s,'"',"&quot;")
   return s

We also do not need to load 'pdb' at global scope. We can instead do  
it only
at point that it is required. Ie., if PythonEnablePdb directive  is  
enabled.

Those two alone drop my 1.95M figure down to 0.8MB.

   510 httpd        0.0%  0:00.00   1     8    39   212K  2.87M    
904K  30.4M
   509 httpd        0.0%  0:00.00   1     8    39   212K  2.87M    
792K  30.4M
   508 httpd        0.0%  0:00.00   1     8    39   216K  2.87M    
796K  30.4M
   507 httpd        0.0%  0:00.00   1     8    39   216K  2.87M    
796K  30.4M
   506 httpd        0.0%  0:00.00   1     8    39   216K  2.87M    
796K  30.4M
   505 httpd        0.0%  0:00.04   1    10    42   812K  2.80M  2.01M 
+ 30.5M
   504 httpd        0.0%  0:00.06   1    11    39    32K  2.87M   
1.39M  30.4M

The rest can't probably be eliminated and gains would be a lot less. The
'cgi' module is always a big memory hog and slow to load, so if can get
rid of that, all the better. Would need to go from 'apache',  
'importer' and
'psp' mod_python modules.

Graham
From grahamd at dscpl.com.au  Sat Mar  3 21:44:30 2007
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Sat Mar  3 21:46:18 2007
Subject: [mod_python] mod_python 3.3.1 make error
In-Reply-To: <esau1v$opv$1@sea.gmane.org>
References: <esau1v$opv$1@sea.gmane.org>
Message-ID: <159BC489-183C-4620-AB7D-A40205C45670@dscpl.com.au>

There are two issues in there.

On 03/03/2007, at 3:37 PM, Rares Vernica wrote:

> checking for flex... /opt/gnutools-1.1/bin/flex
> found /opt/gnutools-1.1/bin/flex, we'll use this. Use --with-flex  
> to specify another.
> checking flex version... awk: syntax error near line 1
> awk: bailing out near line 1
> awk: syntax error near line 1
> awk: bailing out near line 1
> awk: syntax error near line 1
> awk: bailing out near line 1
> ./configure: line 3187: test: : integer expression expected
> configure: WARNING: Flex version 2.5.4 found.
>     Version 2.5.31 or greater is required.  You can generally  
> ignore this
>     warning unless you need to regenerate psp_parser.c from  
> psp_parse.l.
>     If you do need regenerate psp_parser.c, use --with-flex to  
> specify the
>     location of the correct flex version. See the README for more  
> information.

Although this isn't stopping compilation, it is strange that awk is  
failing.

Which 'awk' is found first in your path. Ie., run:

   which awk

Looks like it may be finding the brain damaged BSD version of 'awk'  
rather
than SYSV one. Do you have /usr/ucb in your PATH before normal /bin and
/usr/bin/directories.

The mod_python configure script should really be doing a search for the
existence of 'gawk', 'nawk' and 'awk' in that order when it isn't.

> Compiling for DSO.
>
> /opt/apache-2.0.52/bin/apxs -I/home/rvernica/loquat/usr/apple/src/ 
> mod_python-3.3.1/src/include -I/opt/apache-2.0.52/include -I/opt/ 
> python/2.4.3/include/python2.4 -c mod_python.c _apachemodule.c  
> requestobject.c tableobject.c util.c serverobject.c connobject.c  
> filterobject.c hlist.c hlistobject.c finfoobject.c -L/opt/python/ 
> 2.4.3/lib/python2.4/config        -lm -lpython2.4   -lresolv - 
> lsocket -lnsl -lrt -ldl  -lpthread   -lm          _eprintf.o  
> _floatdidf.o _muldi3.o
> /opt/apache-2.0.52/build/libtool --silent --mode=compile gcc - 
> prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -DSOLARIS2=8 - 
> D_POSIX_PTHREAD_SEMANTICS -D_REENTRANT -g -O2 -pthreads -I/opt/ 
> apache-2.0.52/include  -I/opt/apache-2.0.52/include -I/opt/ 
> apache-2.0.52/include -I/home/rvernica/loquat/usr/apple/src/ 
> mod_python-3.3.1/src/include -I/opt/apache-2.0.52/include -I/opt/ 
> python/2.4.3/include/python2.4  -c -o mod_python.lo mod_python.c &&  
> touch mod_python.slo
> In file included from /usr/include/sys/wait.h:24,
>                  from /opt/apache-2.0.52/include/apr.h:124,
>                  from /opt/apache-2.0.52/include/ap_config.h:19,
>                  from /opt/apache-2.0.52/include/httpd.h:29,
>                  from /home/rvernica/loquat/usr/apple/src/ 
> mod_python-3.3.1/src/include/mod_python.h:42,
>                  from mod_python.c:28:
> /usr/include/sys/siginfo.h:259: error: parse error before "ctid_t"
> /usr/include/sys/siginfo.h:292: error: parse error before '}' token
> /usr/include/sys/siginfo.h:294: error: parse error before '}' token
> /usr/include/sys/siginfo.h:390: error: parse error before "ctid_t"
> /usr/include/sys/siginfo.h:398: error: conflicting types for '__fault'
> /usr/include/sys/siginfo.h:267: error: previous declaration of  
> '__fault' was here

Can you post the 10 lines either side of line 259 in include file:

   /usr/include/sys/siginfo.h

Looks like order of includes is causing a problem. But then the  
includes are
from Apache header files which should be okay.

Can you confirm that you are running older Solaris 8.

You might try dropping /usr/ucb from your path as well, but don't it  
will make a
difference to compilation problem.


Graham
From grahamd at dscpl.com.au  Sat Mar  3 22:05:30 2007
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Sat Mar  3 22:07:17 2007
Subject: [mod_python] Apache/mod_python process sizes. Help wanted.
In-Reply-To: <9B4F4598-0595-4098-BAA1-7E3FF9442C49@dscpl.com.au>
References: <99C69BF9-B599-4BBD-9018-174FC9884492@dscpl.com.au>	<45E9E099.1000003@joreybump.com>	<B76BC114-0C62-42B1-AAFF-40B604E1AAB1@dscpl.com.au>
	<6845B1B4-9242-4CFA-B420-150C101ECBF9@dscpl.com.au>
	<45EA1366.5070003@jgassociates.ca>
	<9B4F4598-0595-4098-BAA1-7E3FF9442C49@dscpl.com.au>
Message-ID: <B5E6E029-498E-428D-8556-7E61986221D4@dscpl.com.au>


On 04/03/2007, at 11:36 AM, Graham Dumpleton wrote:

>
> On 04/03/2007, at 11:31 AM, Jim Gallacher wrote:
>
>>> Part of the jump is the imports in mod_python.apache:
>>> import sys
>>> import traceback
>>> import time
>>> import os
>>> import pdb
>>> import stat
>>> import imp
>>> import types
>>> import cgi
>>> import _apache
>>> import threading
>>> I had been thinking they would have been done when mod_python loaded
>>> for first interpreter, but they aren't done until time of first  
>>> request.
>>> If I import the same modules into mod_wsgi example, then get (pid  
>>> 429):
>>>   432 httpd        0.0%  0:00.00   1     8    39   212K  2.87M    
>>> 904K  30.4M
>>>   430 httpd        0.0%  0:00.00   1     8    39   212K  2.87M    
>>> 776K  30.4M
>>>   429 httpd        0.0%  0:00.18   1    10    67  1.95M  2.88M   
>>> 3.33M  31.5M
>>>   428 httpd        0.0%  0:00.00   1     8    39   216K  2.87M    
>>> 780K  30.4M
>>>   427 httpd        0.0%  0:00.00   1     8    39   216K  2.87M    
>>> 780K  30.4M
>>>   426 httpd        0.0%  0:00.00   1     8    39   212K  2.87M    
>>> 780K  30.4M
>>>   425 httpd        0.0%  0:00.07   1    11    39    32K  2.87M   
>>> 1.34M  30.4M
>>> Thus these modules alone causes it to jump up to 1.95M. This  
>>> works out
>>> about an extra 1.4MB. Because mod_wsgi is all in C code aren't  
>>> relying on
>>> any Python modules so base overhead is less.
>>> Interesting. How many of these modules could be avoided in  
>>> mod_python
>>> if we tried hard?
>>
>> I have no idea, but it's worth a look.
>
> It is quite easy to get rid of 'cgi' as all that is used in it is  
> cgi.escape(). We can
> just duplicate that one function:
>
> def escape(s, quote=None):
>   s = string.replace(s,"&","&amp;")
>   s = string.replace(s,"<","&lt;")
>   s = string.replace(s,">","&gt;",)
>   if quote:
>     s = string.replace(s,'"',"&quot;")
>   return s
>
> We also do not need to load 'pdb' at global scope. We can instead  
> do it only
> at point that it is required. Ie., if PythonEnablePdb directive  is  
> enabled.
>
> Those two alone drop my 1.95M figure down to 0.8MB.
>
>   510 httpd        0.0%  0:00.00   1     8    39   212K  2.87M    
> 904K  30.4M
>   509 httpd        0.0%  0:00.00   1     8    39   212K  2.87M    
> 792K  30.4M
>   508 httpd        0.0%  0:00.00   1     8    39   216K  2.87M    
> 796K  30.4M
>   507 httpd        0.0%  0:00.00   1     8    39   216K  2.87M    
> 796K  30.4M
>   506 httpd        0.0%  0:00.00   1     8    39   216K  2.87M    
> 796K  30.4M
>   505 httpd        0.0%  0:00.04   1    10    42   812K  2.80M   
> 2.01M+ 30.5M
>   504 httpd        0.0%  0:00.06   1    11    39    32K  2.87M   
> 1.39M  30.4M
>
> The rest can't probably be eliminated and gains would be a lot  
> less. The
> 'cgi' module is always a big memory hog and slow to load, so if can  
> get
> rid of that, all the better. Would need to go from 'apache',  
> 'importer' and
> 'psp' mod_python modules.

On mod_python itself, after eliminating 'cgi' module use from  
'apache', 'psp'
and 'importer', plus 'urllib2', 'rfc822', 'calendar' and 'weakref'  
from 'cache'
and deferring import of 'pdb', have gone from my original mod_python
figure of:

   410 httpd        0.0%  0:00.00   1     8    39   212K  2.87M    
888K  30.4M
   408 httpd        0.0%  0:00.00   1     8    39   212K  2.87M    
764K  30.4M
   407 httpd        0.0%  0:00.00   1     8    39   216K  2.87M    
768K  30.4M
   406 httpd        0.0%  0:00.00   1     8    39   216K  2.87M    
768K  30.4M
   405 httpd        0.0%  0:00.37   1    10    86  2.40M  2.75M   
3.94M  32.0M
   404 httpd        0.0%  0:00.00   1     8    39   212K  2.87M    
768K  30.4M
   403 httpd        0.0%  0:00.06   1    11    39    32K  2.87M   
1.30M  30.4M

to:

3355 httpd        0.0%  0:00.00   1     8    39   212K  3.09M   900K   
30.4M
3353 httpd        0.0%  0:00.00   1     8    39   212K  3.09M   768K   
30.4M
3352 httpd        0.0%  0:00.00   1     8    39   212K  3.09M   768K   
30.4M
3351 httpd        0.0%  0:00.00   1     8    39   212K  3.09M   768K   
30.4M
3350 httpd        0.0%  0:00.14   1    10    67  1.36M  3.09M  2.70M   
31.0M
3349 httpd        0.0%  0:00.00   1     8    39   212K  3.09M   772K   
30.4M
3348 httpd        0.0%  0:00.08   1    11    39    36K  3.09M  1.32M   
30.4M

Thus have eliminated 1.0MB from base Apache child process size.

Obviously if an application is using any of these modules anyway,  
they'll
just get loaded back again later.

To drop some of the stuff from 'cache' had to comment out stuff like the
HTTPCache etc. These bits of that file aren't used by mod_python though
and were only in there to preserve the full content of original file  
when it
was borrowed from elsewhere. When full cutover to new module importer
done that file was going to disappear anyway.

All well and good, but this is distracting from my original goal of  
the static
versus shared library issue. :-)

Graham
From list at joreybump.com  Sun Mar  4 07:42:40 2007
From: list at joreybump.com (Jorey Bump)
Date: Sun Mar  4 07:42:51 2007
Subject: [mod_python] Apache/mod_python process sizes. Help wanted.
In-Reply-To: <B5E6E029-498E-428D-8556-7E61986221D4@dscpl.com.au>
References: <99C69BF9-B599-4BBD-9018-174FC9884492@dscpl.com.au>	<45E9E099.1000003@joreybump.com>	<B76BC114-0C62-42B1-AAFF-40B604E1AAB1@dscpl.com.au>	<6845B1B4-9242-4CFA-B420-150C101ECBF9@dscpl.com.au>	<45EA1366.5070003@jgassociates.ca>	<9B4F4598-0595-4098-BAA1-7E3FF9442C49@dscpl.com.au>
	<B5E6E029-498E-428D-8556-7E61986221D4@dscpl.com.au>
Message-ID: <45EABEC0.7050601@joreybump.com>

Graham Dumpleton wrote:

> All well and good, but this is distracting from my original goal of the 
> static
> versus shared library issue. :-)

Perhaps, but improving mod_python will pass these benefits on to 
everyone immediately. I think that people are less likely to replace 
Python on their systems if you determine that shared libraries are 
better, although it's still a good idea to explore this and get the word 
to Python packagers, or at least identify platforms that include a 
static Python (Slackware uses --enable-shared).
From rvernica at gmail.com  Mon Mar  5 18:17:11 2007
From: rvernica at gmail.com (Rares Vernica)
Date: Mon Mar  5 18:17:46 2007
Subject: [mod_python] Re: mod_python 3.3.1 make error
In-Reply-To: <159BC489-183C-4620-AB7D-A40205C45670@dscpl.com.au>
References: <esau1v$opv$1@sea.gmane.org>
	<159BC489-183C-4620-AB7D-A40205C45670@dscpl.com.au>
Message-ID: <esi8ds$1e0$1@sea.gmane.org>

>> checking for flex... /opt/gnutools-1.1/bin/flex
>> found /opt/gnutools-1.1/bin/flex, we'll use this. Use --with-flex to 
>> specify another.
>> checking flex version... awk: syntax error near line 1
>> awk: bailing out near line 1
>> awk: syntax error near line 1
>> awk: bailing out near line 1
>> awk: syntax error near line 1
>> awk: bailing out near line 1
>> ./configure: line 3187: test: : integer expression expected
>> configure: WARNING: Flex version 2.5.4 found.
>>     Version 2.5.31 or greater is required.  You can generally ignore this
>>     warning unless you need to regenerate psp_parser.c from psp_parse.l.
>>     If you do need regenerate psp_parser.c, use --with-flex to specify 
>> the
>>     location of the correct flex version. See the README for more 
>> information.
> 
> Although this isn't stopping compilation, it is strange that awk is 
> failing.
> 
> Which 'awk' is found first in your path. Ie., run:
> 
>   which awk
> 
> Looks like it may be finding the brain damaged BSD version of 'awk' rather
> than SYSV one. Do you have /usr/ucb in your PATH before normal /bin and
> /usr/bin/directories.
> 
> The mod_python configure script should really be doing a search for the
> existence of 'gawk', 'nawk' and 'awk' in that order when it isn't.
> 

The awk is from /usr/bin. The OS is SunOs 5.10. I have no awk in 
/usr/ucb. Anyway, I liked gawk to awk in a directory which is first in 
path. So, no there is no error. I have an old flex so I have to fix thsi 
too.

>> Compiling for DSO.
>>
>> /opt/apache-2.0.52/bin/apxs 
>> -I/home/rvernica/loquat/usr/apple/src/mod_python-3.3.1/src/include 
>> -I/opt/apache-2.0.52/include -I/opt/python/2.4.3/include/python2.4 -c 
>> mod_python.c _apachemodule.c requestobject.c tableobject.c util.c 
>> serverobject.c connobject.c filterobject.c hlist.c hlistobject.c 
>> finfoobject.c -L/opt/python/2.4.3/lib/python2.4/config        -lm 
>> -lpython2.4   -lresolv -lsocket -lnsl -lrt -ldl  -lpthread   
>> -lm          _eprintf.o _floatdidf.o _muldi3.o
>> /opt/apache-2.0.52/build/libtool --silent --mode=compile gcc 
>> -prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -DSOLARIS2=8 
>> -D_POSIX_PTHREAD_SEMANTICS -D_REENTRANT -g -O2 -pthreads 
>> -I/opt/apache-2.0.52/include  -I/opt/apache-2.0.52/include 
>> -I/opt/apache-2.0.52/include 
>> -I/home/rvernica/loquat/usr/apple/src/mod_python-3.3.1/src/include 
>> -I/opt/apache-2.0.52/include -I/opt/python/2.4.3/include/python2.4  -c 
>> -o mod_python.lo mod_python.c && touch mod_python.slo
>> In file included from /usr/include/sys/wait.h:24,
>>                  from /opt/apache-2.0.52/include/apr.h:124,
>>                  from /opt/apache-2.0.52/include/ap_config.h:19,
>>                  from /opt/apache-2.0.52/include/httpd.h:29,
>>                  from 
>> /home/rvernica/loquat/usr/apple/src/mod_python-3.3.1/src/include/mod_python.h:42, 
>>
>>                  from mod_python.c:28:
>> /usr/include/sys/siginfo.h:259: error: parse error before "ctid_t"
>> /usr/include/sys/siginfo.h:292: error: parse error before '}' token
>> /usr/include/sys/siginfo.h:294: error: parse error before '}' token
>> /usr/include/sys/siginfo.h:390: error: parse error before "ctid_t"
>> /usr/include/sys/siginfo.h:398: error: conflicting types for '__fault'
>> /usr/include/sys/siginfo.h:267: error: previous declaration of 
>> '__fault' was here
> 
> Can you post the 10 lines either side of line 259 in include file:
> 
>   /usr/include/sys/siginfo.h

#else
					union __sigval	__value;
#endif
				} __kill;
				struct {
					clock_t __utime;
					int	__status;
					clock_t __stime;
				} __cld;
			} __pdata;
			ctid_t	__ctid;		/* contract ID		*/
			zoneid_t __zoneid;	/* zone ID		*/
		} __proc;

		struct {	/* SIGSEGV, SIGBUS, SIGILL, SIGTRAP, SIGFPE */
			void 	*__addr;	/* faulting address	*/
			int	__trapno;	/* illegal trap number	*/
			caddr_t	__pc;		/* instruction address	*/
		} __fault;

		struct {			/* SIGPOLL, SIGXFSZ	*/


> 
> Looks like order of includes is causing a problem. But then the includes 
> are
> from Apache header files which should be okay.
> 
> Can you confirm that you are running older Solaris 8.

It is SunOS 5.10.

> 
> You might try dropping /usr/ucb from your path as well, but don't it 
> will make a
> difference to compilation problem.

I don't have /usr/ucb in the path.

Thanks a lot,
Ray

From rvernica at gmail.com  Mon Mar  5 19:29:44 2007
From: rvernica at gmail.com (Rares Vernica)
Date: Mon Mar  5 19:30:15 2007
Subject: [mod_python] Re: mod_python 3.3.1 make error
In-Reply-To: <esi8ds$1e0$1@sea.gmane.org>
References: <esau1v$opv$1@sea.gmane.org>	<159BC489-183C-4620-AB7D-A40205C45670@dscpl.com.au>
	<esi8ds$1e0$1@sea.gmane.org>
Message-ID: <esiclt$dnm$1@sea.gmane.org>

Rares Vernica wrote:
>>> checking for flex... /opt/gnutools-1.1/bin/flex
>>> found /opt/gnutools-1.1/bin/flex, we'll use this. Use --with-flex to 
>>> specify another.
>>> checking flex version... awk: syntax error near line 1
>>> awk: bailing out near line 1
>>> awk: syntax error near line 1
>>> awk: bailing out near line 1
>>> awk: syntax error near line 1
>>> awk: bailing out near line 1
>>> ./configure: line 3187: test: : integer expression expected
>>> configure: WARNING: Flex version 2.5.4 found.
>>>     Version 2.5.31 or greater is required.  You can generally ignore 
>>> this
>>>     warning unless you need to regenerate psp_parser.c from psp_parse.l.
>>>     If you do need regenerate psp_parser.c, use --with-flex to 
>>> specify the
>>>     location of the correct flex version. See the README for more 
>>> information.
>>
>> Although this isn't stopping compilation, it is strange that awk is 
>> failing.
>>
>> Which 'awk' is found first in your path. Ie., run:
>>
>>   which awk
>>
>> Looks like it may be finding the brain damaged BSD version of 'awk' 
>> rather
>> than SYSV one. Do you have /usr/ucb in your PATH before normal /bin and
>> /usr/bin/directories.
>>
>> The mod_python configure script should really be doing a search for the
>> existence of 'gawk', 'nawk' and 'awk' in that order when it isn't.
>>
> 
> The awk is from /usr/bin. The OS is SunOs 5.10. I have no awk in 
> /usr/ucb. Anyway, I liked gawk to awk in a directory which is first in 
> path. So, no there is no error. I have an old flex so I have to fix thsi 
> too.
> 

I fixed the flex problem so, ./configure does not have any errors or 
warnings.

Still, the make errors are the same.

Thanks a lot,
Ray

From davidf at sjsoft.com  Tue Mar  6 04:49:25 2007
From: davidf at sjsoft.com (David Fraser)
Date: Tue Mar  6 04:49:49 2007
Subject: [mod_python] matplotlib and mod_python
In-Reply-To: <1172437084.7355.11.camel@localhost>
References: <1172437084.7355.11.camel@localhost>
Message-ID: <45ED3925.5030601@sjsoft.com>

Rajarshi Guha wrote:
> Hi, I have a mod_python based application in which I would like to
> generate a chart using matplotlib.
>
> Currently, when I try to call the function that generates the chart I
> get a 'HOME not writable' error. I realize why this is happening and so
> I modified my apache startup script to export a HOME directory of '/tmp'
>
> When this is done, the chart is generated, but when I try to dump the
> chart to a file using:
>
> canvas.print_figure( ... )
>
> the file is always created in /tmp (i.e., the value of HOME), rather
> than in the file that I specify (which is in a current directory that is
> writable by apache).
>
> Has anybody successfully used matplotlib in a mod_python application, to
> actually save a chart to a disk file?
>
> (I realize that one way would be to send back the raw image bytes, but
> the image is supposed to be a part of an HTML page, so I can't go down
> that path)
>
> Any pointers would be greatly appreciated.
>   
A much better way IMHO is to generate the image in a Python handler in
response to the request for the image.
Then you can send back the raw image bytes without saving them to disk.
You basically need to pass the parameters that are needed to generate
the image in the URL that you reference the image as in the HTML code
This avoids all kinds of potential problems with state, multiple image
requests overlapping, etc

David
From tcataldo at bham.lib.al.us  Thu Mar  8 12:39:59 2007
From: tcataldo at bham.lib.al.us (Tobin Cataldo)
Date: Thu Mar  8 12:40:05 2007
Subject: [mod_python] mod_python and .pyo files
Message-ID: <45F04A6F.8090503@bham.lib.al.us>

Greetings,

I would like to ship only .pyo files to a website and use those with 
mod_python. I have seen this question in the archives but haven't seen a 
clear answer.

I believe the Python Interpreter will choose a .pyc or .pyo file if 
available, but I want to only have the .pyo files in my target directory.

Apache conf:
DirectoryIndex index.pyo index.py ...
...
AddHander mod_python .pyo
...
SetHandler mod_python

This Apache configuration still requires .py in the target directory or 
the page can't be found.

I am applying mod_python against a directory which Graham says will 
translate to a request against index.py 
(http://www.dscpl.com.au/wiki/ModPython/Articles/SetHandlerVersusAddHandler).

How do I overwrite this behavior? I suppose I could do it via Location 
directives, but how to do this with DirectoryIndex and the Directory 
directives?

Thanks,
Tobin Cataldo
From petersanchez at gmail.com  Thu Mar  8 13:53:46 2007
From: petersanchez at gmail.com (Peter Sanchez)
Date: Thu Mar  8 13:53:54 2007
Subject: [mod_python] publisher - variable processing
Message-ID: <75CDF7A8-FD2A-4B6B-8417-E834D0959A5F@gmail.com>

Is there a way to process data passed in the URL without using the  
"normal" CGI method using publisher? ie,

www.domain.com/script?var1=foo&var2=blah - This I can use req.form  
for the data. Say I want to use the following:

www.domain.com/script/foo/blah

I don't mind parsing the data myself, but how can I get the string "/ 
foo/blah" ?

I am sure its possible creating a different handler, but is it  
possible to do so using .publisher?

Thanks!

Peter


From dkramer at aptima.com  Thu Mar  8 13:59:59 2007
From: dkramer at aptima.com (David Kramer)
Date: Thu Mar  8 14:00:12 2007
Subject: [mod_python] publisher - variable processing
In-Reply-To: <75CDF7A8-FD2A-4B6B-8417-E834D0959A5F@gmail.com>
References: <75CDF7A8-FD2A-4B6B-8417-E834D0959A5F@gmail.com>
Message-ID: <45F05D2F.5090701@aptima.com>

Peter Sanchez wrote:
> Is there a way to process data passed in the URL without using the 
> "normal" CGI method using publisher? ie,
> 
> www.domain.com/script?var1=foo&var2=blah - This I can use req.form for 
> the data. Say I want to use the following:
> 
> www.domain.com/script/foo/blah
> 
> I don't mind parsing the data myself, but how can I get the string 
> "/foo/blah" ?

The path_info member of the request object should give you what you want.

http://www.modpython.org/live/current/doc-html/pyapi-mprequest-mem.html


The information transmitted is intended only for the person or entity to which it is addressed and may contain confidential and/or privileged material. Any review, retransmission, dissemination or other use of, or taking of any action in reliance upon this information by persons or entities other than the intended recipient is prohibited. If you received this in error, please contact the sender and delete the material from any computer.

From list at joreybump.com  Thu Mar  8 14:17:27 2007
From: list at joreybump.com (Jorey Bump)
Date: Thu Mar  8 14:17:36 2007
Subject: [mod_python] publisher - variable processing
In-Reply-To: <45F05D2F.5090701@aptima.com>
References: <75CDF7A8-FD2A-4B6B-8417-E834D0959A5F@gmail.com>
	<45F05D2F.5090701@aptima.com>
Message-ID: <45F06147.8060502@joreybump.com>

David Kramer wrote:
> Peter Sanchez wrote:
>> Is there a way to process data passed in the URL without using the 
>> "normal" CGI method using publisher? ie,
>>
>> www.domain.com/script?var1=foo&var2=blah - This I can use req.form for 
>> the data. Say I want to use the following:
>>
>> www.domain.com/script/foo/blah
>>
>> I don't mind parsing the data myself, but how can I get the string 
>> "/foo/blah" ?
> 
> The path_info member of the request object should give you what you want.
> 
> http://www.modpython.org/live/current/doc-html/pyapi-mprequest-mem.html

That won't work with Publisher, which will attempt to map each part of 
the URL to a publishable object.
From Jake.E.Posey at boeing.com  Thu Mar  8 15:09:27 2007
From: Jake.E.Posey at boeing.com (Posey, Jake E)
Date: Thu Mar  8 15:10:01 2007
Subject: [mod_python] Compiling mod_python on 64bit RHEL 4
Message-ID: <7B73172B331C034198AA90BDF604F5FB02860F0C@XCH-NW-5V1.nw.nos.boeing.com>

I have a couple of issues.

 

One is I have Apache 1.3.31 and Python 2.3.4 and I'm trying to compile
mod_python 2.7.10 on 64bit RHEL 4 but after running configure
-with-apxs=/ots/apache_1.3.31/bin/apxs the make dso fails with the
following error.

 

/usr/bin/ld: mod_python.o: relocation R_X86_64_32 against `a local
symbol' can not be used when making a shared object; recompile with
-fPIC

mod_python.o: could not read symbols: Bad value

collect2: ld returned 1 exit status

apxs:Break: Command failed with rc=1

make[1]: *** [mod_python.so] Error 1

make[1]: Leaving directory `/tmp/mod_python-2.7.10/src'

make: *** [do_dso] Error 2

 

I've tried several version of  apache, python, and mod_python and I get
the same error.

 

Second when I do just a plain ./configure
-with-apache=/tmp/apache_1.3.31 (which is the source code) 

 

[root@lcas204 mod_python-2.7.10]# make

make[1]: Entering directory `/tmp/mod_python-2.7.10/src'

 

Making static version of mod_python. For DSO, do "make dso".

 

rm -f libpython.a

ar cr libpython.a mod_python.o _apachemodule.o requestobject.o
tableobject.o util.o serverobject.o connobject.o

ranlib libpython.a

 

Now su and make install

  (or, if you only want to perform a partial install,

   you can use make install_static and make install_py_lib)

 

make[1]: Leaving directory `/tmp/mod_python-2.7.10/src'

 

 make install

 

After running make install it ask me to do this

 

Now cd into /tmp/apache_1.3.31 and reconfigure and rebuild apache with

    ./configure --activate-module=src/modules/python/libpython.a

    make

 

or, if you use the old Configure method, add to your src/Configuration
file

    AddModule modules/python/libpython.a

then, in src directory:

    ./Configure

    make

 

I perform the steps above but it doesn't create the mod_python.so file.
Am I missing a step here?

 

I've searched to no avail on finding a answer much less a fix.  I have
this same configuration on other machines however they are running 32bit
RHEL 4.  I tried this configuration on another machine same 64bit RHEL 4
os and it fails. So is there a problem with compiling and installing
mod_python on RHEL 64bit os?  Apache and Python installs find.  Have I
missed setting a flag in Apache and/or Python?

 

Need a solution, I don't have much hair left to pull out, beside my head
is getting sore.

 

Thanks,

 

Jake E. Posey

Email: jake.e.posey@boeing.com <mailto:jake.e.posey@boeing.com> 

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070308/0b719103/attachment.html
From ccbean at gmail.com  Thu Mar  8 15:56:04 2007
From: ccbean at gmail.com (Colin Bean)
Date: Thu Mar  8 15:56:18 2007
Subject: [mod_python] publisher - variable processing
In-Reply-To: <75CDF7A8-FD2A-4B6B-8417-E834D0959A5F@gmail.com>
References: <75CDF7A8-FD2A-4B6B-8417-E834D0959A5F@gmail.com>
Message-ID: <29a6ca010703081256p57297a17k8b4cf5f9be488856@mail.gmail.com>

Have you considered using mod_rewrite?  If you don't mind using an
outside module, you'd be able to use "pretty" urls and not have to
change your publisher code.

Colin

On 3/8/07, Peter Sanchez <petersanchez@gmail.com> wrote:
> Is there a way to process data passed in the URL without using the
> "normal" CGI method using publisher? ie,
>
> www.domain.com/script?var1=foo&var2=blah - This I can use req.form
> for the data. Say I want to use the following:
>
> www.domain.com/script/foo/blah
>
> I don't mind parsing the data myself, but how can I get the string "/
> foo/blah" ?
>
> I am sure its possible creating a different handler, but is it
> possible to do so using .publisher?
>
> Thanks!
>
> Peter
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From graham.dumpleton at gmail.com  Thu Mar  8 16:04:11 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Mar  8 16:04:15 2007
Subject: [mod_python] Compiling mod_python on 64bit RHEL 4
In-Reply-To: <7B73172B331C034198AA90BDF604F5FB02860F0C@XCH-NW-5V1.nw.nos.boeing.com>
References: <7B73172B331C034198AA90BDF604F5FB02860F0C@XCH-NW-5V1.nw.nos.boeing.com>
Message-ID: <88e286470703081304p19ae82d5v7c63203d7ee4beac@mail.gmail.com>

On 09/03/07, Posey, Jake E <Jake.E.Posey@boeing.com> wrote:
> I have a couple of issues.
>
> One is I have Apache 1.3.31 and Python 2.3.4 and I'm trying to compile
> mod_python 2.7.10 on 64bit RHEL 4 but after running configure
> ?with-apxs=/ots/apache_1.3.31/bin/apxs the make dso fails
> with the following error.
>
> /usr/bin/ld: mod_python.o: relocation R_X86_64_32 against `a local symbol'
> can not be used when making a shared object; recompile with -fPIC
>
> mod_python.o: could not read symbols: Bad value
>
> collect2: ld returned 1 exit status
>
> apxs:Break: Command failed with rc=1
>
> make[1]: *** [mod_python.so] Error 1
>
> make[1]: Leaving directory `/tmp/mod_python-2.7.10/src'
>
> make: *** [do_dso] Error 2
>
>
>
> I've tried several version of  apache, python, and mod_python and I get the
> same error.

Have you tried a current version of Apache and mod_python and not some
really old versions? Ie., something like Apache 2.2.4 and mod_python
3.3.1.

Trying to debug how to compile what is a very old version of
mod_python against a 64 bit platform isn't something that you will
probably find anyone willing to help with. By using a newer version
means we also know it isn't something that may have been resolved in a
newer version.

Graham

From graham.dumpleton at gmail.com  Thu Mar  8 16:05:04 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Mar  8 16:05:06 2007
Subject: [mod_python] mod_python and .pyo files
In-Reply-To: <45F04A6F.8090503@bham.lib.al.us>
References: <45F04A6F.8090503@bham.lib.al.us>
Message-ID: <88e286470703081305w42c8c768y3fe6e50565e2b23b@mail.gmail.com>

On 09/03/07, Tobin Cataldo <tcataldo@bham.lib.al.us> wrote:
> Greetings,
>
> I would like to ship only .pyo files to a website and use those with
> mod_python. I have seen this question in the archives but haven't seen a
> clear answer.
>
> I believe the Python Interpreter will choose a .pyc or .pyo file if
> available, but I want to only have the .pyo files in my target directory.
>
> Apache conf:
> DirectoryIndex index.pyo index.py ...
> ...
> AddHander mod_python .pyo
> ...
> SetHandler mod_python
>
> This Apache configuration still requires .py in the target directory or
> the page can't be found.
>
> I am applying mod_python against a directory which Graham says will
> translate to a request against index.py
> (http://www.dscpl.com.au/wiki/ModPython/Articles/SetHandlerVersusAddHandler).
>
> How do I overwrite this behavior? I suppose I could do it via Location
> directives, but how to do this with DirectoryIndex and the Directory
> directives?

For code files which are managed by the mod_python module importer you
cannot do that as it doesn't use .pyc or .pyo files nor generate them.

This has been the case for mod_python.publisher since mod_python 3.2.7
and for all module imports managed by mod_python since 3.3.1.

Note that where a module import cannot be done by mod_python and it
defers to the standard Python module importer, the standard Python
module importer will still make use of .pyc/.pyo files if they exist,
although, for .pyo files you would need to have specified the
directive:

 PythonOptimize On

Graham
From graham.dumpleton at gmail.com  Thu Mar  8 16:12:06 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Mar  8 16:12:19 2007
Subject: [mod_python] publisher - variable processing
In-Reply-To: <29a6ca010703081256p57297a17k8b4cf5f9be488856@mail.gmail.com>
References: <75CDF7A8-FD2A-4B6B-8417-E834D0959A5F@gmail.com>
	<29a6ca010703081256p57297a17k8b4cf5f9be488856@mail.gmail.com>
Message-ID: <88e286470703081312p4e2de421ic4eb3e6b82b1dd01@mail.gmail.com>

On 09/03/07, Colin Bean <ccbean@gmail.com> wrote:
> Have you considered using mod_rewrite?  If you don't mind using an
> outside module, you'd be able to use "pretty" urls and not have to
> change your publisher code.
>
> Colin
>
> On 3/8/07, Peter Sanchez <petersanchez@gmail.com> wrote:
> > Is there a way to process data passed in the URL without using the
> > "normal" CGI method using publisher? ie,
> >
> > www.domain.com/script?var1=foo&var2=blah - This I can use req.form
> > for the data. Say I want to use the following:
> >
> > www.domain.com/script/foo/blah
> >
> > I don't mind parsing the data myself, but how can I get the string "/
> > foo/blah" ?
> >
> > I am sure its possible creating a different handler, but is it
> > possible to do so using .publisher?

I'd also suggest mod_rewrite as one way of doing it, but there is also
a way of doing it in mod_python.publisher using a wrapper class for a
method. See:

  http://www.modpython.org/pipermail/mod_python/2005-March/017560.html

The concept could probably be extended to handle form parameters
properly and also to be able to be applied using a decorator.

Graham
From grosvally at optonline.net  Thu Mar  8 17:45:14 2007
From: grosvally at optonline.net (George Rosvally)
Date: Thu Mar  8 17:44:35 2007
Subject: [mod_python] Install /Testing Issues ( missing mptest module)
Message-ID: <45F091FA.7080001@optonline.net>

Hi,
I am new to mod_python, and am having troubles getting it to work.

I run on windows xp sp2 and have installed python 2.5 , pywin 32-210,
mod_python-3.3.1, and use xampp 1.5.5 for my apache server.


Running mytest.py results messages stating the mptest is not found.

See ">>>>> mytest.py results" for the output.

mpinfo results follow.

Any help would be appreciated.


Thanks
George

MP info yield's  the following results:

General information
Apache version	Apache/2.2.3 (Win32) DAV/2 mod_ssl/2.2.3 OpenSSL/0.9.8d
mod_autoindex_color mod_python/3.3.1 Python/2.5 PHP/5.2.0 mod_jk/1.2.15
Apache threaded MPM	Yes, maximum 250 threads / process
Apache forked MPM	No (single process MPM)
Apache server root	C:/xamp/xampp/apache
Apache document root	C:/xamp/xampp/htdocs
Apache error log	C:/xamp/xampp/apache\logs/error.log (view last 100 lines)
Python sys.version	2.5 (r25:51908, Sep 19 2006, 09:52:17) [MSC v.1310 32
bit (Intel)]
Python sys.path	

C:\WINDOWS\system32\python25.zip
C:\Python25\Lib
C:\Python25\DLLs
C:\Python25\Lib\lib-tk
C:\xamp\xampp\apache
C:\xamp\xampp\apache\bin
C:\Python25
C:\Python25\lib\site-packages
C:\Python25\lib\site-packages\win32
C:\Python25\lib\site-packages\win32\lib
C:\Python25\lib\site-packages\Pythonwin

Python interpreter name	localhost
mod_python.publisher available	Yes
mod_python.psp available	Yes
Request input headers
Key	Value
Host	localhost
User-Agent	Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.2)
Gecko/20070219 Firefox/2.0.0.2
Accept
text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
Accept-Language	en-us,en;q=0.5
Accept-Encoding	gzip,deflate
Accept-Charset	ISO-8859-1,utf-8;q=0.7,*;q=0.7
Keep-Alive	300
Connection	keep-alive
Request environment
Key	Value
GATEWAY_INTERFACE	CGI/1.1
SERVER_PROTOCOL	HTTP/1.1
REQUEST_METHOD	GET
QUERY_STRING	
REQUEST_URI	/mpinfo
SCRIPT_NAME	/mpinfo
HTTP_HOST	localhost
HTTP_USER_AGENT	Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US;
rv:1.8.1.2) Gecko/20070219 Firefox/2.0.0.2
HTTP_ACCEPT
text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
HTTP_ACCEPT_LANGUAGE	en-us,en;q=0.5
HTTP_ACCEPT_ENCODING	gzip,deflate
HTTP_ACCEPT_CHARSET	ISO-8859-1,utf-8;q=0.7,*;q=0.7
HTTP_KEEP_ALIVE	300
HTTP_CONNECTION	keep-alive
PATH
C:\Perl\bin\;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem;C:\PROGRA~1\CRNADM~1;C:\Program 

Files\Common Files\STOPzilla!;C:\Program Files\NTP\bin;C:\Program
Files\ImageConverter Plus;C:\Program Files\ImageConverter
Plus;C:\Program Files\QuickTime\QTSystem\
SystemRoot	C:\WINDOWS
COMSPEC	C:\WINDOWS\system32\cmd.exe
PATHEXT	.COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH
WINDIR	C:\WINDOWS
SERVER_SIGNATURE	
Apache/2.2.3 (Win32) DAV/2 mod_ssl/2.2.3 OpenSSL/0.9.8d
mod_autoindex_color mod_python/3.3.1 Python/2.5 PHP/5.2.0 mod_jk/1.2.15
Server at localhost Port 80
SERVER_SOFTWARE	Apache/2.2.3 (Win32) DAV/2 mod_ssl/2.2.3 OpenSSL/0.9.8d
mod_autoindex_color mod_python/3.3.1 Python/2.5 PHP/5.2.0 mod_jk/1.2.15
SERVER_NAME	localhost
SERVER_ADDR	127.0.0.1
SERVER_PORT	80
REMOTE_ADDR	127.0.0.1
DOCUMENT_ROOT	C:/xamp/xampp/htdocs
SERVER_ADMIN	admin@localhost
SCRIPT_FILENAME	C:/xamp/xampp/htdocs/mpinfo
REMOTE_PORT	4006
Request configuration
Key	Value
PythonDebug	1
Request options
Key	Value
mod_python.mutex_directory	/tmp
mod_python.mutex_locks	8
Request notes
Key	Value
python_init_ran	1
Server configuration
Key	Value
Server options
Key	Value
mod_python.mutex_directory	/tmp
mod_python.mutex_locks	8
Server configuration tree

ThreadsPerChild 250
MaxRequestsPerChild 0
Listen 80
PythonOption mod_python.mutex_directory "/tmp"
PythonOption mod_python.mutex_locks 8
ServerAdmin admin@localhost
ServerName localhost:80
DocumentRoot "C:/xamp/xampp/htdocs"

     Options FollowSymLinks
     AllowOverride None
     Order deny,allow
     Deny from all

     Options Indexes FollowSymLinks Includes ExecCGI
     AllowOverride All
     Order allow,deny
     Allow from all

     AddHandler mod_python .py
     PythonHandler mptest
     PythonDebug On
DirectoryIndex index.php index.php4 index.php3 index.cgi index.pl
index.html index.htm index.shtml index.phtml

     Order allow,deny
     Deny from all
ErrorLog logs/error.log
LogLevel warn
LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\""
combined
LogFormat "%h %l %u %t \"%r\" %>s %b" common
CustomLog logs/access.log common
ScriptAlias /cgi-bin/ "C:/xamp/xampp/cgi-bin/"

     AllowOverride None
     Options None
     Order allow,deny
     Allow from all
DefaultType text/plain
TypesConfig conf/mime.types
AddType application/x-compress .Z
AddType application/x-gzip .gz .tgz
AddHandler cgi-script .cgi
AddType text/html .shtml
AddOutputFilter INCLUDES .shtml
EnableMMAP off
EnableSendfile off
AddType application/x-httpd-php-source .phps
AddType application/x-httpd-php .php .php5 .php4 .php3 .phtml


         php_admin_flag safe_mode off
Alias /security "C:/xamp/xampp/security/htdocs/"


         php_admin_flag safe_mode off
     AllowOverride AuthConfig
     Order allow,deny
     Allow from all
Alias /phpmyadmin "C:/xamp/xampp/phpMyAdmin/"

     AllowOverride AuthConfig
     Order allow,deny
     Allow from all
Alias /webalizer "C:/xamp/xampp/webalizer/"


         php_admin_flag safe_mode off
     AllowOverride AuthConfig
     Order allow,deny
     Allow from all
Alias /contrib "C:/xamp/xampp/contrib/"


         php_admin_flag safe_mode off
     AllowOverride AuthConfig
     Order allow,deny
     Allow from all
Alias /error/ "C:/xamp/xampp/apache/error/"

     AllowOverride None
     Options IncludesNoExec
     AddOutputFilter Includes html
     AddHandler type-map var
     Order allow,deny
     Allow from all
     LanguagePriority en cs de es fr it ja ko nl pl pt-br ro sv tr
     ForceLanguagePriority Prefer Fallback
ErrorDocument 400 /error/HTTP_BAD_REQUEST.html.var
ErrorDocument 401 /error/HTTP_UNAUTHORIZED.html.var
ErrorDocument 403 /error/HTTP_FORBIDDEN.html.var
ErrorDocument 404 /error/HTTP_NOT_FOUND.html.var
ErrorDocument 405 /error/HTTP_METHOD_NOT_ALLOWED.html.var
ErrorDocument 408 /error/HTTP_REQUEST_TIME_OUT.html.var
ErrorDocument 410 /error/HTTP_GONE.html.var
ErrorDocument 411 /error/HTTP_LENGTH_REQUIRED.html.var
ErrorDocument 412 /error/HTTP_PRECONDITION_FAILED.html.var
ErrorDocument 413 /error/HTTP_REQUEST_ENTITY_TOO_LARGE.html.var
ErrorDocument 414 /error/HTTP_REQUEST_URI_TOO_LARGE.html.var
ErrorDocument 415 /error/HTTP_UNSUPPORTED_MEDIA_TYPE.html.var
ErrorDocument 500 /error/HTTP_INTERNAL_SERVER_ERROR.html.var
ErrorDocument 501 /error/HTTP_NOT_IMPLEMENTED.html.var
ErrorDocument 502 /error/HTTP_BAD_GATEWAY.html.var
ErrorDocument 503 /error/HTTP_SERVICE_UNAVAILABLE.html.var
ErrorDocument 506 /error/HTTP_VARIANT_ALSO_VARIES.html.var
IndexOptions FancyIndexing VersionSort
Alias /icons/ "C:/xamp/xampp/apache/icons/"

     Options Indexes MultiViews
     AllowOverride None
     Order allow,deny
     Allow from all
AddIconByEncoding (CMP,/icons/compressed.gif) x-compress x-gzip
AddIconByType (TXT,/icons/text.gif) text/*
AddIconByType (IMG,/icons/image2.gif) image/*
AddIconByType (SND,/icons/sound2.gif) audio/*
AddIconByType (VID,/icons/movie.gif) video/*
AddIcon /icons/binary.gif .bin .exe
AddIcon /icons/binhex.gif .hqx
AddIcon /icons/tar.gif .tar
AddIcon /icons/world2.gif .wrl .wrl.gz .vrml .vrm .iv
AddIcon /icons/compressed.gif .Z .z .tgz .gz .zip
AddIcon /icons/a.gif .ps .ai .eps
AddIcon /icons/layout.gif .html .shtml .htm .pdf
AddIcon /icons/text.gif .txt
AddIcon /icons/c.gif .c
AddIcon /icons/p.gif .pl .py
AddIcon /icons/f.gif .for
AddIcon /icons/dvi.gif .dvi
AddIcon /icons/uuencoded.gif .uu
AddIcon /icons/script.gif .conf .sh .shar .csh .ksh .tcl
AddIcon /icons/tex.gif .tex
AddIcon /icons/bomb.gif core
AddIcon /icons/back.gif ..
AddIcon /icons/hand.right.gif README
AddIcon /icons/folder.gif ^^DIRECTORY^^
AddIcon /icons/blank.gif ^^BLANKICON^^
DefaultIcon /icons/unknown.gif
ReadmeName README.html
HeaderName HEADER.html
IndexIgnore .??* *~ *# HEADER* README* RCS CVS *,v *,t
AddLanguage ca .ca
AddLanguage cs .cz .cs
AddLanguage da .dk
AddLanguage de .de
AddLanguage el .el
AddLanguage en .en
AddLanguage eo .eo
AddLanguage es .es
AddLanguage et .et
AddLanguage fr .fr
AddLanguage he .he
AddLanguage hr .hr
AddLanguage it .it
AddLanguage ja .ja
AddLanguage ko .ko
AddLanguage ltz .ltz
AddLanguage nl .nl
AddLanguage nn .nn
AddLanguage no .no
AddLanguage pl .po
AddLanguage pt .pt
AddLanguage pt-BR .pt-br
AddLanguage ru .ru
AddLanguage sv .sv
AddLanguage zh-CN .zh-cn
AddLanguage zh-TW .zh-tw
LanguagePriority en ca cs da de el eo es et fr he hr it ja ko ltz nl nn
no pl pt pt-BR ru sv zh-CN zh-TW
ForceLanguagePriority Prefer Fallback
AddCharset us-ascii.ascii .us-ascii
AddCharset ISO-8859-1  .iso8859-1  .latin1
AddCharset ISO-8859-2  .iso8859-2  .latin2 .cen
AddCharset ISO-8859-3  .iso8859-3  .latin3
AddCharset ISO-8859-4  .iso8859-4  .latin4
AddCharset ISO-8859-5  .iso8859-5  .cyr .iso-ru
AddCharset ISO-8859-6  .iso8859-6  .arb .arabic
AddCharset ISO-8859-7  .iso8859-7  .grk .greek
AddCharset ISO-8859-8  .iso8859-8  .heb .hebrew
AddCharset ISO-8859-9  .iso8859-9  .latin5 .trk
AddCharset ISO-8859-10  .iso8859-10  .latin6
AddCharset ISO-8859-13  .iso8859-13
AddCharset ISO-8859-14  .iso8859-14  .latin8
AddCharset ISO-8859-15  .iso8859-15  .latin9
AddCharset ISO-8859-16  .iso8859-16  .latin10
AddCharset ISO-2022-JP .iso2022-jp .jis
AddCharset ISO-2022-KR .iso2022-kr .kis
AddCharset ISO-2022-CN .iso2022-cn .cis
AddCharset Big5.Big5   .big5 .b5
AddCharset cn-Big5 .cn-big5
AddCharset WINDOWS-1251 .cp-1251   .win-1251
AddCharset CP866   .cp866
AddCharset KOI8  .koi8
AddCharset KOI8-E  .koi8-e
AddCharset KOI8-r  .koi8-r .koi8-ru
AddCharset KOI8-U  .koi8-u
AddCharset KOI8-ru .koi8-uk .ua
AddCharset ISO-10646-UCS-2 .ucs2
AddCharset ISO-10646-UCS-4 .ucs4
AddCharset UTF-7   .utf7
AddCharset UTF-8   .utf8
AddCharset UTF-16  .utf16
AddCharset UTF-16BE .utf16be
AddCharset UTF-16LE .utf16le
AddCharset UTF-32  .utf32
AddCharset UTF-32BE .utf32be
AddCharset UTF-32LE .utf32le
AddCharset euc-cn  .euc-cn
AddCharset euc-gb  .euc-gb
AddCharset euc-jp  .euc-jp
AddCharset euc-kr  .euc-kr
AddCharset EUC-TW  .euc-tw
AddCharset gb2312  .gb2312 .gb
AddCharset iso-10646-ucs-2 .ucs-2 .iso-10646-ucs-2
AddCharset iso-10646-ucs-4 .ucs-4 .iso-10646-ucs-4
AddCharset shift_jis   .shift_jis .sjis

     SetHandler server-status
     Order deny,allow
     Deny from all
     Allow from .example.com

     SetHandler server-info
     Order deny,allow
     Deny from all
     Allow from .example.com
DavLockDB "C:/xamp/xampp/tmp/DavLock"
Alias /webdav "C:/xamp/xampp/webdav"

     Dav On
     Order allow,deny
     Allow from all
     AuthName DAV-upload
     AuthType Basic
     AuthUserFile "C:/xamp/xampp/security/htpasswd.webdav"

         require valid-user
BrowserMatch "Microsoft Data Access Internet Publishing Provider"
redirect-carefully
BrowserMatch "MS FrontPage" redirect-carefully
BrowserMatch "^WebDrive" redirect-carefully
BrowserMatch "^WebDAVFS/1.[0123]" redirect-carefully
BrowserMatch "^gnome-vfs/1.0" redirect-carefully
BrowserMatch "^XML Spy" redirect-carefully
BrowserMatch "^Dreamweaver-WebDAV-SCM1" redirect-carefully
BrowserMatch "MSIE" AuthDigestEnableQueryStringHack=On
Timeout 300
KeepAlive On
MaxKeepAliveRequests 100
KeepAliveTimeout 5
UseCanonicalName Off
AccessFileName .htaccess
ServerTokens Full
ServerSignature On
HostnameLookups Off
Listen 443
AddType application/x-x509-ca-cert .crt
AddType application/x-pkcs7-crl    .crl
SSLPassPhraseDialog builtin
SSLSessionCache dbm:logs/ssl.scache
SSLSessionCacheTimeout 300
SSLMutex default

     DocumentRoot "C:/xamp/xampp/htdocs"
     ServerName localhost:443
     ServerAdmin admin@localhost
     ErrorLog logs/error.log
     CustomLog logs/access.log combined
     SSLEngine on
     SSLCipherSuite
ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP:+eNULL
     SSLCertificateFile conf/ssl.crt/server.crt
     SSLCertificateKeyFile conf/ssl.key/server.key


         SSLOptions +StdEnvVars

         SSLOptions +StdEnvVars
     BrowserMatch ".*MSIE.*"                  nokeepalive
ssl-unclean-shutdown                  downgrade-1.0 force-response-1.0
     CustomLog logs/ssl_request.log                   "%t %h
%{SSL_PROTOCOL}x %{SSL_CIPHER}x \"%r\" %b"
SSLRandomSeed startup builtin
SSLRandomSeed connect builtin
JkWorkersFile "C:/xamp/xampp/tomcat/conf/workers.properties"
JkLogFile "C:/xamp/xampp/tomcat/logs/mod_jk.log"
JkLogLevel info
JkOptions +ForwardKeySize +ForwardURICompat -ForwardDirectories
JkMount /*.jsp ajp13
JkMount /java/* ajp13
JkMount /jsp-examples/* ajp13
JkMount /servlets-examples/* ajp13

     SetHandler mod_python
     PythonHandler mod_python.testhandler

>>>>> mytest.py results

MOD_PYTHON ERROR

ProcessId:      3108
Interpreter:    'localhost'

ServerName:     'localhost'
DocumentRoot:   'C:/xamp/xampp/htdocs'

URI:            '/mytest.py'
Location:       None
Directory:      'C:/xamp/xampp/htdocs/'
Filename:       'C:/xamp/xampp/htdocs/mytest.py'
PathInfo:       ''

Phase:          'PythonHandler'
Handler:        'mptest'

Traceback (most recent call last):

   File "C:\Python25\Lib\site-packages\mod_python\importer.py", line
1537, in HandlerDispatch
     default=default_handler, arg=req, silent=hlist.silent)

   File "C:\Python25\Lib\site-packages\mod_python\importer.py", line
1202, in _process_target
     module = import_module(module_name, path=path)

   File "C:\Python25\Lib\site-packages\mod_python\importer.py", line
304, in import_module
     return __import__(module_name, {}, {}, ['*'])

ImportError: No module named mptest




From graham.dumpleton at gmail.com  Thu Mar  8 17:58:40 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Mar  8 17:58:45 2007
Subject: [mod_python] Install /Testing Issues ( missing mptest module)
In-Reply-To: <45F091FA.7080001@optonline.net>
References: <45F091FA.7080001@optonline.net>
Message-ID: <88e286470703081458t503c4f4cw37177b148be98b81@mail.gmail.com>

On 09/03/07, George Rosvally <grosvally@optonline.net> wrote:
> Hi,
> I am new to mod_python, and am having troubles getting it to work.
>
> I run on windows xp sp2 and have installed python 2.5 , pywin 32-210,
> mod_python-3.3.1, and use xampp 1.5.5 for my apache server.

Putting PythonHandler at the root of your web server like that is
probably not a good idea. I would suggest you try following guidelines
for mptest example at:

  http://www.dscpl.com.au/wiki/ModPython/Articles/GettingModPythonWorking

This might help you to understand how to set things up better. Take
note that the user that Apache runs as must have permissions to be
able to read your code files.

Also a good idea to read:

  http://www.dscpl.com.au/wiki/ModPython/Articles/SetHandlerVersusAddHandler

if you are not too familiar with Apache.

Graham
From Jake.E.Posey at boeing.com  Thu Mar  8 18:30:14 2007
From: Jake.E.Posey at boeing.com (Posey, Jake E)
Date: Thu Mar  8 18:30:33 2007
Subject: [mod_python] RE: Mod_python Digest, Vol 48, Issue 10
In-Reply-To: <200703082259.l28MxGJw003952@modpython.org>
References: <200703082259.l28MxGJw003952@modpython.org>
Message-ID: <7B73172B331C034198AA90BDF604F5FB02860F35@XCH-NW-5V1.nw.nos.boeing.com>

I've asked my users to do that but unfortunately they say they can't
upgrade.  If we can't get this resolved then we would have to rebuild
the box and install the 32bit OS, which is what we have running on the
other boxes.

Anything would help.

Thanks,

Jake

-----Original Message-----
From: mod_python-request@modpython.org
[mailto:mod_python-request@modpython.org] 
Sent: Thursday, March 08, 2007 2:59 PM
To: mod_python@modpython.org
Subject: Mod_python Digest, Vol 48, Issue 10

Send Mod_python mailing list submissions to
	mod_python@modpython.org

To subscribe or unsubscribe via the World Wide Web, visit
	http://mailman.modpython.org/mailman/listinfo/mod_python
or, via email, send a message with subject or body 'help' to
	mod_python-request@modpython.org

You can reach the person managing the list at
	mod_python-owner@modpython.org

When replying, please edit your Subject line so it is more specific
than "Re: Contents of Mod_python digest..."


Today's Topics:

   1. Re: Compiling mod_python on 64bit RHEL 4 (Graham Dumpleton)
   2. Re: mod_python and .pyo files (Graham Dumpleton)
   3. Re: publisher - variable processing (Graham Dumpleton)
   4. Install /Testing Issues ( missing mptest module) (George Rosvally)
   5. Re: Install /Testing Issues ( missing mptest module)
      (Graham Dumpleton)


----------------------------------------------------------------------

Message: 1
Date: Fri, 9 Mar 2007 08:04:11 +1100
From: "Graham Dumpleton" <graham.dumpleton@gmail.com>
Subject: Re: [mod_python] Compiling mod_python on 64bit RHEL 4
To: "Posey, Jake E" <Jake.E.Posey@boeing.com>
Cc: mod_python@modpython.org
Message-ID:
	<88e286470703081304p19ae82d5v7c63203d7ee4beac@mail.gmail.com>
Content-Type: text/plain; charset=WINDOWS-1252; format=flowed

On 09/03/07, Posey, Jake E <Jake.E.Posey@boeing.com> wrote:
> I have a couple of issues.
>
> One is I have Apache 1.3.31 and Python 2.3.4 and I'm trying to compile
> mod_python 2.7.10 on 64bit RHEL 4 but after running configure
> -with-apxs=/ots/apache_1.3.31/bin/apxs the make dso fails
> with the following error.
>
> /usr/bin/ld: mod_python.o: relocation R_X86_64_32 against `a local
symbol'
> can not be used when making a shared object; recompile with -fPIC
>
> mod_python.o: could not read symbols: Bad value
>
> collect2: ld returned 1 exit status
>
> apxs:Break: Command failed with rc=1
>
> make[1]: *** [mod_python.so] Error 1
>
> make[1]: Leaving directory `/tmp/mod_python-2.7.10/src'
>
> make: *** [do_dso] Error 2
>
>
>
> I've tried several version of  apache, python, and mod_python and I
get the
> same error.

Have you tried a current version of Apache and mod_python and not some
really old versions? Ie., something like Apache 2.2.4 and mod_python
3.3.1.

Trying to debug how to compile what is a very old version of
mod_python against a 64 bit platform isn't something that you will
probably find anyone willing to help with. By using a newer version
means we also know it isn't something that may have been resolved in a
newer version.

Graham



------------------------------

Message: 2
Date: Fri, 9 Mar 2007 08:05:04 +1100
From: "Graham Dumpleton" <graham.dumpleton@gmail.com>
Subject: Re: [mod_python] mod_python and .pyo files
To: "Tobin Cataldo" <tcataldo@bham.lib.al.us>
Cc: mod_python@modpython.org
Message-ID:
	<88e286470703081305w42c8c768y3fe6e50565e2b23b@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed

On 09/03/07, Tobin Cataldo <tcataldo@bham.lib.al.us> wrote:
> Greetings,
>
> I would like to ship only .pyo files to a website and use those with
> mod_python. I have seen this question in the archives but haven't seen
a
> clear answer.
>
> I believe the Python Interpreter will choose a .pyc or .pyo file if
> available, but I want to only have the .pyo files in my target
directory.
>
> Apache conf:
> DirectoryIndex index.pyo index.py ...
> ...
> AddHander mod_python .pyo
> ...
> SetHandler mod_python
>
> This Apache configuration still requires .py in the target directory
or
> the page can't be found.
>
> I am applying mod_python against a directory which Graham says will
> translate to a request against index.py
>
(http://www.dscpl.com.au/wiki/ModPython/Articles/SetHandlerVersusAddHand
ler).
>
> How do I overwrite this behavior? I suppose I could do it via Location
> directives, but how to do this with DirectoryIndex and the Directory
> directives?

For code files which are managed by the mod_python module importer you
cannot do that as it doesn't use .pyc or .pyo files nor generate them.

This has been the case for mod_python.publisher since mod_python 3.2.7
and for all module imports managed by mod_python since 3.3.1.

Note that where a module import cannot be done by mod_python and it
defers to the standard Python module importer, the standard Python
module importer will still make use of .pyc/.pyo files if they exist,
although, for .pyo files you would need to have specified the
directive:

 PythonOptimize On

Graham


------------------------------

Message: 3
Date: Fri, 9 Mar 2007 08:12:06 +1100
From: "Graham Dumpleton" <graham.dumpleton@gmail.com>
Subject: Re: [mod_python] publisher - variable processing
To: "Colin Bean" <ccbean@gmail.com>
Cc: mod_python@modpython.org
Message-ID:
	<88e286470703081312p4e2de421ic4eb3e6b82b1dd01@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed

On 09/03/07, Colin Bean <ccbean@gmail.com> wrote:
> Have you considered using mod_rewrite?  If you don't mind using an
> outside module, you'd be able to use "pretty" urls and not have to
> change your publisher code.
>
> Colin
>
> On 3/8/07, Peter Sanchez <petersanchez@gmail.com> wrote:
> > Is there a way to process data passed in the URL without using the
> > "normal" CGI method using publisher? ie,
> >
> > www.domain.com/script?var1=foo&var2=blah - This I can use req.form
> > for the data. Say I want to use the following:
> >
> > www.domain.com/script/foo/blah
> >
> > I don't mind parsing the data myself, but how can I get the string
"/
> > foo/blah" ?
> >
> > I am sure its possible creating a different handler, but is it
> > possible to do so using .publisher?

I'd also suggest mod_rewrite as one way of doing it, but there is also
a way of doing it in mod_python.publisher using a wrapper class for a
method. See:

  http://www.modpython.org/pipermail/mod_python/2005-March/017560.html

The concept could probably be extended to handle form parameters
properly and also to be able to be applied using a decorator.

Graham


------------------------------

Message: 4
Date: Thu, 08 Mar 2007 17:45:14 -0500
From: George Rosvally <grosvally@optonline.net>
Subject: [mod_python] Install /Testing Issues ( missing mptest module)
To: mod_python@modpython.org
Message-ID: <45F091FA.7080001@optonline.net>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed

Hi,
I am new to mod_python, and am having troubles getting it to work.

I run on windows xp sp2 and have installed python 2.5 , pywin 32-210,
mod_python-3.3.1, and use xampp 1.5.5 for my apache server.


Running mytest.py results messages stating the mptest is not found.

See ">>>>> mytest.py results" for the output.

mpinfo results follow.

Any help would be appreciated.


Thanks
George

MP info yield's  the following results:

General information
Apache version	Apache/2.2.3 (Win32) DAV/2 mod_ssl/2.2.3 OpenSSL/0.9.8d
mod_autoindex_color mod_python/3.3.1 Python/2.5 PHP/5.2.0 mod_jk/1.2.15
Apache threaded MPM	Yes, maximum 250 threads / process
Apache forked MPM	No (single process MPM)
Apache server root	C:/xamp/xampp/apache
Apache document root	C:/xamp/xampp/htdocs
Apache error log	C:/xamp/xampp/apache\logs/error.log (view last
100 lines)
Python sys.version	2.5 (r25:51908, Sep 19 2006, 09:52:17) [MSC
v.1310 32
bit (Intel)]
Python sys.path	

C:\WINDOWS\system32\python25.zip
C:\Python25\Lib
C:\Python25\DLLs
C:\Python25\Lib\lib-tk
C:\xamp\xampp\apache
C:\xamp\xampp\apache\bin
C:\Python25
C:\Python25\lib\site-packages
C:\Python25\lib\site-packages\win32
C:\Python25\lib\site-packages\win32\lib
C:\Python25\lib\site-packages\Pythonwin

Python interpreter name	localhost
mod_python.publisher available	Yes
mod_python.psp available	Yes
Request input headers
Key	Value
Host	localhost
User-Agent	Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US;
rv:1.8.1.2)
Gecko/20070219 Firefox/2.0.0.2
Accept
text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plai
n;q=0.8,image/png,*/*;q=0.5
Accept-Language	en-us,en;q=0.5
Accept-Encoding	gzip,deflate
Accept-Charset	ISO-8859-1,utf-8;q=0.7,*;q=0.7
Keep-Alive	300
Connection	keep-alive
Request environment
Key	Value
GATEWAY_INTERFACE	CGI/1.1
SERVER_PROTOCOL	HTTP/1.1
REQUEST_METHOD	GET
QUERY_STRING	
REQUEST_URI	/mpinfo
SCRIPT_NAME	/mpinfo
HTTP_HOST	localhost
HTTP_USER_AGENT	Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US;
rv:1.8.1.2) Gecko/20070219 Firefox/2.0.0.2
HTTP_ACCEPT
text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plai
n;q=0.8,image/png,*/*;q=0.5
HTTP_ACCEPT_LANGUAGE	en-us,en;q=0.5
HTTP_ACCEPT_ENCODING	gzip,deflate
HTTP_ACCEPT_CHARSET	ISO-8859-1,utf-8;q=0.7,*;q=0.7
HTTP_KEEP_ALIVE	300
HTTP_CONNECTION	keep-alive
PATH
C:\Perl\bin\;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem;C:\
PROGRA~1\CRNADM~1;C:\Program 

Files\Common Files\STOPzilla!;C:\Program Files\NTP\bin;C:\Program
Files\ImageConverter Plus;C:\Program Files\ImageConverter
Plus;C:\Program Files\QuickTime\QTSystem\
SystemRoot	C:\WINDOWS
COMSPEC	C:\WINDOWS\system32\cmd.exe
PATHEXT	.COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH
WINDIR	C:\WINDOWS
SERVER_SIGNATURE	
Apache/2.2.3 (Win32) DAV/2 mod_ssl/2.2.3 OpenSSL/0.9.8d
mod_autoindex_color mod_python/3.3.1 Python/2.5 PHP/5.2.0 mod_jk/1.2.15
Server at localhost Port 80
SERVER_SOFTWARE	Apache/2.2.3 (Win32) DAV/2 mod_ssl/2.2.3 OpenSSL/0.9.8d
mod_autoindex_color mod_python/3.3.1 Python/2.5 PHP/5.2.0 mod_jk/1.2.15
SERVER_NAME	localhost
SERVER_ADDR	127.0.0.1
SERVER_PORT	80
REMOTE_ADDR	127.0.0.1
DOCUMENT_ROOT	C:/xamp/xampp/htdocs
SERVER_ADMIN	admin@localhost
SCRIPT_FILENAME	C:/xamp/xampp/htdocs/mpinfo
REMOTE_PORT	4006
Request configuration
Key	Value
PythonDebug	1
Request options
Key	Value
mod_python.mutex_directory	/tmp
mod_python.mutex_locks	8
Request notes
Key	Value
python_init_ran	1
Server configuration
Key	Value
Server options
Key	Value
mod_python.mutex_directory	/tmp
mod_python.mutex_locks	8
Server configuration tree

ThreadsPerChild 250
MaxRequestsPerChild 0
Listen 80
PythonOption mod_python.mutex_directory "/tmp"
PythonOption mod_python.mutex_locks 8
ServerAdmin admin@localhost
ServerName localhost:80
DocumentRoot "C:/xamp/xampp/htdocs"

     Options FollowSymLinks
     AllowOverride None
     Order deny,allow
     Deny from all

     Options Indexes FollowSymLinks Includes ExecCGI
     AllowOverride All
     Order allow,deny
     Allow from all

     AddHandler mod_python .py
     PythonHandler mptest
     PythonDebug On
DirectoryIndex index.php index.php4 index.php3 index.cgi index.pl
index.html index.htm index.shtml index.phtml

     Order allow,deny
     Deny from all
ErrorLog logs/error.log
LogLevel warn
LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\""
combined
LogFormat "%h %l %u %t \"%r\" %>s %b" common
CustomLog logs/access.log common
ScriptAlias /cgi-bin/ "C:/xamp/xampp/cgi-bin/"

     AllowOverride None
     Options None
     Order allow,deny
     Allow from all
DefaultType text/plain
TypesConfig conf/mime.types
AddType application/x-compress .Z
AddType application/x-gzip .gz .tgz
AddHandler cgi-script .cgi
AddType text/html .shtml
AddOutputFilter INCLUDES .shtml
EnableMMAP off
EnableSendfile off
AddType application/x-httpd-php-source .phps
AddType application/x-httpd-php .php .php5 .php4 .php3 .phtml


         php_admin_flag safe_mode off
Alias /security "C:/xamp/xampp/security/htdocs/"


         php_admin_flag safe_mode off
     AllowOverride AuthConfig
     Order allow,deny
     Allow from all
Alias /phpmyadmin "C:/xamp/xampp/phpMyAdmin/"

     AllowOverride AuthConfig
     Order allow,deny
     Allow from all
Alias /webalizer "C:/xamp/xampp/webalizer/"


         php_admin_flag safe_mode off
     AllowOverride AuthConfig
     Order allow,deny
     Allow from all
Alias /contrib "C:/xamp/xampp/contrib/"


         php_admin_flag safe_mode off
     AllowOverride AuthConfig
     Order allow,deny
     Allow from all
Alias /error/ "C:/xamp/xampp/apache/error/"

     AllowOverride None
     Options IncludesNoExec
     AddOutputFilter Includes html
     AddHandler type-map var
     Order allow,deny
     Allow from all
     LanguagePriority en cs de es fr it ja ko nl pl pt-br ro sv tr
     ForceLanguagePriority Prefer Fallback
ErrorDocument 400 /error/HTTP_BAD_REQUEST.html.var
ErrorDocument 401 /error/HTTP_UNAUTHORIZED.html.var
ErrorDocument 403 /error/HTTP_FORBIDDEN.html.var
ErrorDocument 404 /error/HTTP_NOT_FOUND.html.var
ErrorDocument 405 /error/HTTP_METHOD_NOT_ALLOWED.html.var
ErrorDocument 408 /error/HTTP_REQUEST_TIME_OUT.html.var
ErrorDocument 410 /error/HTTP_GONE.html.var
ErrorDocument 411 /error/HTTP_LENGTH_REQUIRED.html.var
ErrorDocument 412 /error/HTTP_PRECONDITION_FAILED.html.var
ErrorDocument 413 /error/HTTP_REQUEST_ENTITY_TOO_LARGE.html.var
ErrorDocument 414 /error/HTTP_REQUEST_URI_TOO_LARGE.html.var
ErrorDocument 415 /error/HTTP_UNSUPPORTED_MEDIA_TYPE.html.var
ErrorDocument 500 /error/HTTP_INTERNAL_SERVER_ERROR.html.var
ErrorDocument 501 /error/HTTP_NOT_IMPLEMENTED.html.var
ErrorDocument 502 /error/HTTP_BAD_GATEWAY.html.var
ErrorDocument 503 /error/HTTP_SERVICE_UNAVAILABLE.html.var
ErrorDocument 506 /error/HTTP_VARIANT_ALSO_VARIES.html.var
IndexOptions FancyIndexing VersionSort
Alias /icons/ "C:/xamp/xampp/apache/icons/"

     Options Indexes MultiViews
     AllowOverride None
     Order allow,deny
     Allow from all
AddIconByEncoding (CMP,/icons/compressed.gif) x-compress x-gzip
AddIconByType (TXT,/icons/text.gif) text/*
AddIconByType (IMG,/icons/image2.gif) image/*
AddIconByType (SND,/icons/sound2.gif) audio/*
AddIconByType (VID,/icons/movie.gif) video/*
AddIcon /icons/binary.gif .bin .exe
AddIcon /icons/binhex.gif .hqx
AddIcon /icons/tar.gif .tar
AddIcon /icons/world2.gif .wrl .wrl.gz .vrml .vrm .iv
AddIcon /icons/compressed.gif .Z .z .tgz .gz .zip
AddIcon /icons/a.gif .ps .ai .eps
AddIcon /icons/layout.gif .html .shtml .htm .pdf
AddIcon /icons/text.gif .txt
AddIcon /icons/c.gif .c
AddIcon /icons/p.gif .pl .py
AddIcon /icons/f.gif .for
AddIcon /icons/dvi.gif .dvi
AddIcon /icons/uuencoded.gif .uu
AddIcon /icons/script.gif .conf .sh .shar .csh .ksh .tcl
AddIcon /icons/tex.gif .tex
AddIcon /icons/bomb.gif core
AddIcon /icons/back.gif ..
AddIcon /icons/hand.right.gif README
AddIcon /icons/folder.gif ^^DIRECTORY^^
AddIcon /icons/blank.gif ^^BLANKICON^^
DefaultIcon /icons/unknown.gif
ReadmeName README.html
HeaderName HEADER.html
IndexIgnore .??* *~ *# HEADER* README* RCS CVS *,v *,t
AddLanguage ca .ca
AddLanguage cs .cz .cs
AddLanguage da .dk
AddLanguage de .de
AddLanguage el .el
AddLanguage en .en
AddLanguage eo .eo
AddLanguage es .es
AddLanguage et .et
AddLanguage fr .fr
AddLanguage he .he
AddLanguage hr .hr
AddLanguage it .it
AddLanguage ja .ja
AddLanguage ko .ko
AddLanguage ltz .ltz
AddLanguage nl .nl
AddLanguage nn .nn
AddLanguage no .no
AddLanguage pl .po
AddLanguage pt .pt
AddLanguage pt-BR .pt-br
AddLanguage ru .ru
AddLanguage sv .sv
AddLanguage zh-CN .zh-cn
AddLanguage zh-TW .zh-tw
LanguagePriority en ca cs da de el eo es et fr he hr it ja ko ltz nl nn
no pl pt pt-BR ru sv zh-CN zh-TW
ForceLanguagePriority Prefer Fallback
AddCharset us-ascii.ascii .us-ascii
AddCharset ISO-8859-1  .iso8859-1  .latin1
AddCharset ISO-8859-2  .iso8859-2  .latin2 .cen
AddCharset ISO-8859-3  .iso8859-3  .latin3
AddCharset ISO-8859-4  .iso8859-4  .latin4
AddCharset ISO-8859-5  .iso8859-5  .cyr .iso-ru
AddCharset ISO-8859-6  .iso8859-6  .arb .arabic
AddCharset ISO-8859-7  .iso8859-7  .grk .greek
AddCharset ISO-8859-8  .iso8859-8  .heb .hebrew
AddCharset ISO-8859-9  .iso8859-9  .latin5 .trk
AddCharset ISO-8859-10  .iso8859-10  .latin6
AddCharset ISO-8859-13  .iso8859-13
AddCharset ISO-8859-14  .iso8859-14  .latin8
AddCharset ISO-8859-15  .iso8859-15  .latin9
AddCharset ISO-8859-16  .iso8859-16  .latin10
AddCharset ISO-2022-JP .iso2022-jp .jis
AddCharset ISO-2022-KR .iso2022-kr .kis
AddCharset ISO-2022-CN .iso2022-cn .cis
AddCharset Big5.Big5   .big5 .b5
AddCharset cn-Big5 .cn-big5
AddCharset WINDOWS-1251 .cp-1251   .win-1251
AddCharset CP866   .cp866
AddCharset KOI8  .koi8
AddCharset KOI8-E  .koi8-e
AddCharset KOI8-r  .koi8-r .koi8-ru
AddCharset KOI8-U  .koi8-u
AddCharset KOI8-ru .koi8-uk .ua
AddCharset ISO-10646-UCS-2 .ucs2
AddCharset ISO-10646-UCS-4 .ucs4
AddCharset UTF-7   .utf7
AddCharset UTF-8   .utf8
AddCharset UTF-16  .utf16
AddCharset UTF-16BE .utf16be
AddCharset UTF-16LE .utf16le
AddCharset UTF-32  .utf32
AddCharset UTF-32BE .utf32be
AddCharset UTF-32LE .utf32le
AddCharset euc-cn  .euc-cn
AddCharset euc-gb  .euc-gb
AddCharset euc-jp  .euc-jp
AddCharset euc-kr  .euc-kr
AddCharset EUC-TW  .euc-tw
AddCharset gb2312  .gb2312 .gb
AddCharset iso-10646-ucs-2 .ucs-2 .iso-10646-ucs-2
AddCharset iso-10646-ucs-4 .ucs-4 .iso-10646-ucs-4
AddCharset shift_jis   .shift_jis .sjis

     SetHandler server-status
     Order deny,allow
     Deny from all
     Allow from .example.com

     SetHandler server-info
     Order deny,allow
     Deny from all
     Allow from .example.com
DavLockDB "C:/xamp/xampp/tmp/DavLock"
Alias /webdav "C:/xamp/xampp/webdav"

     Dav On
     Order allow,deny
     Allow from all
     AuthName DAV-upload
     AuthType Basic
     AuthUserFile "C:/xamp/xampp/security/htpasswd.webdav"

         require valid-user
BrowserMatch "Microsoft Data Access Internet Publishing Provider"
redirect-carefully
BrowserMatch "MS FrontPage" redirect-carefully
BrowserMatch "^WebDrive" redirect-carefully
BrowserMatch "^WebDAVFS/1.[0123]" redirect-carefully
BrowserMatch "^gnome-vfs/1.0" redirect-carefully
BrowserMatch "^XML Spy" redirect-carefully
BrowserMatch "^Dreamweaver-WebDAV-SCM1" redirect-carefully
BrowserMatch "MSIE" AuthDigestEnableQueryStringHack=On
Timeout 300
KeepAlive On
MaxKeepAliveRequests 100
KeepAliveTimeout 5
UseCanonicalName Off
AccessFileName .htaccess
ServerTokens Full
ServerSignature On
HostnameLookups Off
Listen 443
AddType application/x-x509-ca-cert .crt
AddType application/x-pkcs7-crl    .crl
SSLPassPhraseDialog builtin
SSLSessionCache dbm:logs/ssl.scache
SSLSessionCacheTimeout 300
SSLMutex default

     DocumentRoot "C:/xamp/xampp/htdocs"
     ServerName localhost:443
     ServerAdmin admin@localhost
     ErrorLog logs/error.log
     CustomLog logs/access.log combined
     SSLEngine on
     SSLCipherSuite
ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP:+eNULL
     SSLCertificateFile conf/ssl.crt/server.crt
     SSLCertificateKeyFile conf/ssl.key/server.key


         SSLOptions +StdEnvVars

         SSLOptions +StdEnvVars
     BrowserMatch ".*MSIE.*"                  nokeepalive
ssl-unclean-shutdown                  downgrade-1.0 force-response-1.0
     CustomLog logs/ssl_request.log                   "%t %h
%{SSL_PROTOCOL}x %{SSL_CIPHER}x \"%r\" %b"
SSLRandomSeed startup builtin
SSLRandomSeed connect builtin
JkWorkersFile "C:/xamp/xampp/tomcat/conf/workers.properties"
JkLogFile "C:/xamp/xampp/tomcat/logs/mod_jk.log"
JkLogLevel info
JkOptions +ForwardKeySize +ForwardURICompat -ForwardDirectories
JkMount /*.jsp ajp13
JkMount /java/* ajp13
JkMount /jsp-examples/* ajp13
JkMount /servlets-examples/* ajp13

     SetHandler mod_python
     PythonHandler mod_python.testhandler

>>>>> mytest.py results

MOD_PYTHON ERROR

ProcessId:      3108
Interpreter:    'localhost'

ServerName:     'localhost'
DocumentRoot:   'C:/xamp/xampp/htdocs'

URI:            '/mytest.py'
Location:       None
Directory:      'C:/xamp/xampp/htdocs/'
Filename:       'C:/xamp/xampp/htdocs/mytest.py'
PathInfo:       ''

Phase:          'PythonHandler'
Handler:        'mptest'

Traceback (most recent call last):

   File "C:\Python25\Lib\site-packages\mod_python\importer.py", line
1537, in HandlerDispatch
     default=default_handler, arg=req, silent=hlist.silent)

   File "C:\Python25\Lib\site-packages\mod_python\importer.py", line
1202, in _process_target
     module = import_module(module_name, path=path)

   File "C:\Python25\Lib\site-packages\mod_python\importer.py", line
304, in import_module
     return __import__(module_name, {}, {}, ['*'])

ImportError: No module named mptest






------------------------------

Message: 5
Date: Fri, 9 Mar 2007 09:58:40 +1100
From: "Graham Dumpleton" <graham.dumpleton@gmail.com>
Subject: Re: [mod_python] Install /Testing Issues ( missing mptest
	module)
To: "George Rosvally" <grosvally@optonline.net>
Cc: mod_python@modpython.org
Message-ID:
	<88e286470703081458t503c4f4cw37177b148be98b81@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed

On 09/03/07, George Rosvally <grosvally@optonline.net> wrote:
> Hi,
> I am new to mod_python, and am having troubles getting it to work.
>
> I run on windows xp sp2 and have installed python 2.5 , pywin 32-210,
> mod_python-3.3.1, and use xampp 1.5.5 for my apache server.

Putting PythonHandler at the root of your web server like that is
probably not a good idea. I would suggest you try following guidelines
for mptest example at:

 
http://www.dscpl.com.au/wiki/ModPython/Articles/GettingModPythonWorking

This might help you to understand how to set things up better. Take
note that the user that Apache runs as must have permissions to be
able to read your code files.

Also a good idea to read:

 
http://www.dscpl.com.au/wiki/ModPython/Articles/SetHandlerVersusAddHandl
er

if you are not too familiar with Apache.

Graham


------------------------------

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python


End of Mod_python Digest, Vol 48, Issue 10
******************************************

From newbarker at btinternet.com  Thu Mar  8 18:44:02 2007
From: newbarker at btinternet.com (PETER BARKER)
Date: Thu Mar  8 18:44:08 2007
Subject: [mod_python] PSP templates within publisher module
Message-ID: <170479.41988.qm@web86002.mail.ird.yahoo.com>

I have a website composed of some simple Python Server Page files and images in the same directory. The images are referenced from the pages without any qualification e.g. <img src="theimage.jpg"/> or <a href="about.psp">About us</a>. If the page is on http://localhost/company_name/index.psp, this works as http://localhost/company_name/theimage.jpg or http://localhost/company_name/about.psp is accessible. So far so good!
   
  I am adding a section to the website using the mod_python publisher handler. This will be implemented in a module called ClientArea.py. As part of this module, I want to be able to use the existing PSP files as templates and insert only the content relevant to the module. Assume I'm calling a function called "entryPoint" within this module, then the browser is now pointing at http://localhost/company_name/ClientArea.py/entryPoint. I am now having problems with the internal links because the unqualified link seems to be referring to an entity withing ClientArea.py - e.g. http://localhost/company_name/ClientArea.py/theimage.jpg. This resource doesn't exist though!
   
  I don't really want to duplicate the PSP pages and have one version with "../" prefixed. I also don't want to fully qualify the links.
   
  I welcome suggestions on what I should be doing here!
   
  Regards,
   
  Pete B
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070308/790e5395/attachment.html
From graham.dumpleton at gmail.com  Thu Mar  8 18:55:45 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Mar  8 18:55:49 2007
Subject: [mod_python] Compiling mod_python on 64bit RHEL 4
Message-ID: <88e286470703081555i4d41fe61o620664d59ce73b32@mail.gmail.com>

On 09/03/07, Posey, Jake E <Jake.E.Posey@boeing.com> wrote:
> I've asked my users to do that but unfortunately they say they can't
> upgrade.  If we can't get this resolved then we would have to rebuild
> the box and install the 32bit OS, which is what we have running on the
> other boxes.

Is the version of Apache you have installed simply a prebuilt 32bit
version or was it specifically compiled on 64bit version of OS with
the 64bit compiler?

One possibility is that the apxs/libtool setup in Apache that is being
used is actually for 32bit OS where objects don't need to be PIC,
whereas it needs to be PIC on 64bit OS. Thus, you may need to fix up
your Apache installation for it to work. Otherwise you may be able to
hack the required -fPIC flag into the mod_python Makefile somewhere
where it will be used for code compilation.

Graham
From graham.dumpleton at gmail.com  Thu Mar  8 19:05:44 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Mar  8 19:05:47 2007
Subject: [mod_python] PSP templates within publisher module
In-Reply-To: <170479.41988.qm@web86002.mail.ird.yahoo.com>
References: <170479.41988.qm@web86002.mail.ird.yahoo.com>
Message-ID: <88e286470703081605w36435f6bjbc63c7c26bb96191@mail.gmail.com>

On 09/03/07, PETER BARKER <newbarker@btinternet.com> wrote:
> I have a website composed of some simple Python Server Page files and images
> in the same directory. The images are referenced from the pages without any
> qualification e.g. <img src="theimage.jpg"/> or <a href="about.psp">About
> us</a>. If the page is on
> http://localhost/company_name/index.psp, this works as
> http://localhost/company_name/theimage.jpg or
> http://localhost/company_name/about.psp is accessible. So
> far so good!
>
> I am adding a section to the website using the mod_python publisher handler.
> This will be implemented in a module called ClientArea.py. As part of this
> module, I want to be able to use the existing PSP files as templates and
> insert only the content relevant to the module. Assume I'm calling a
> function called "entryPoint" within this module, then the browser is now
> pointing at
> http://localhost/company_name/ClientArea.py/entryPoint. I
> am now having problems with the internal links because the unqualified link
> seems to be referring to an entity withing ClientArea.py - e.g.
> http://localhost/company_name/ClientArea.py/theimage.jpg.
> This resource doesn't exist though!
>
> I don't really want to duplicate the PSP pages and have one version with
> "../" prefixed. I also don't want to fully qualify the links.
>
> I welcome suggestions on what I should be doing here!

When working out relative pathnames, PSP will do the equivalent of:

  os.path.dirname(req.filename)

to determine the base directory. For mod_python.publisher this will
not be want you want.

Provided you are using a new enough version of mod_python, before you
invoke PSP template, set:

  req.filename = '/some/directory/containing/psp/files/'

Ie., set it name of directory where PSP files are located. Ensure it
has a trailing slash.

BTW, I haven't tried this, but I think it should work.

Graham
From graham.dumpleton at gmail.com  Thu Mar  8 19:21:41 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Mar  8 19:21:43 2007
Subject: [mod_python] Compiling mod_python on 64bit RHEL 4
In-Reply-To: <7B73172B331C034198AA90BDF604F5FB02860F37@XCH-NW-5V1.nw.nos.boeing.com>
References: <88e286470703081555i4d41fe61o620664d59ce73b32@mail.gmail.com>
	<7B73172B331C034198AA90BDF604F5FB02860F37@XCH-NW-5V1.nw.nos.boeing.com>
Message-ID: <88e286470703081621m5e70b61ckb44303cfb87f308c@mail.gmail.com>

On 09/03/07, Posey, Jake E <Jake.E.Posey@boeing.com> wrote:
> I've been trying to hack the -fPIC flag in the Makefile but not sure
> where in the Makefile.  I'll also try using the 64bit compiler.

Try CFLAGS in src/Makefile.

Please keep followups on mailing list.

Graham
From newbarker at btinternet.com  Thu Mar  8 19:27:33 2007
From: newbarker at btinternet.com (PETER BARKER)
Date: Thu Mar  8 19:27:37 2007
Subject: [mod_python] PSP templates within publisher module
In-Reply-To: <88e286470703081605w36435f6bjbc63c7c26bb96191@mail.gmail.com>
Message-ID: <930854.17152.qm@web86004.mail.ird.yahoo.com>

Graham,
   
  That doesn't work because it's the client (browser) that constructs the fully qualified path to the image based on the path of the current resource (now .../ClientArea.py), and the path in the link. I got a 404 when I tried this suggestion.
   
  Here's the code of a stripped down version of the problem...
   
  INDEX.PSP:
  <html>
<head>
    <title>Test</title>
</head>
<body>
<img src="AnImage.jpg"/>
<br>
<a href="ClientArea.py/entryPoint">Clients' Area</a>
</body>
</html>

  CLIENTAREA.PY:
  from mod_python import psp
  def entryPoint(req):
  req.content_type='text/html'
  return psp.PSP(req,filename='index.psp').run()
   
  APACHE CONFIGURATION:
  <Directory "C:/Program Files/Apache Software Foundation/Apache2.2/htdocs/PSPExample">
    AddHandler mod_python .py .psp
    PythonHandler mod_python.publisher | .py
    PythonHandler mod_python.psp | .psp
    PythonDebug On
</Directory>

  Regards,
   
  Pete

Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
  On 09/03/07, PETER BARKER wrote:
> I have a website composed of some simple Python Server Page files and images
> in the same directory. The images are referenced from the pages without any
> qualification e.g.  or About
> us. If the page is on
> http://localhost/company_name/index.psp, this works as
> http://localhost/company_name/theimage.jpg or
> http://localhost/company_name/about.psp is accessible. So
> far so good!
>
> I am adding a section to the website using the mod_python publisher handler.
> This will be implemented in a module called ClientArea.py. As part of this
> module, I want to be able to use the existing PSP files as templates and
> insert only the content relevant to the module. Assume I'm calling a
> function called "entryPoint" within this module, then the browser is now
> pointing at
> http://localhost/company_name/ClientArea.py/entryPoint. I
> am now having problems with the internal links because the unqualified link
> seems to be referring to an entity withing ClientArea.py - e.g.
> http://localhost/company_name/ClientArea.py/theimage.jpg.
> This resource doesn't exist though!
>
> I don't really want to duplicate the PSP pages and have one version with
> "../" prefixed. I also don't want to fully qualify the links.
>
> I welcome suggestions on what I should be doing here!

When working out relative pathnames, PSP will do the equivalent of:

os.path.dirname(req.filename)

to determine the base directory. For mod_python.publisher this will
not be want you want.

Provided you are using a new enough version of mod_python, before you
invoke PSP template, set:

req.filename = '/some/directory/containing/psp/files/'

Ie., set it name of directory where PSP files are located. Ensure it
has a trailing slash.

BTW, I haven't tried this, but I think it should work.

Graham

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070309/29150fe8/attachment.html
From graham.dumpleton at gmail.com  Thu Mar  8 19:38:48 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Mar  8 19:38:51 2007
Subject: [mod_python] PSP templates within publisher module
In-Reply-To: <930854.17152.qm@web86004.mail.ird.yahoo.com>
References: <88e286470703081605w36435f6bjbc63c7c26bb96191@mail.gmail.com>
	<930854.17152.qm@web86004.mail.ird.yahoo.com>
Message-ID: <88e286470703081638p4d862acbva99d9bf9aa02bbfc@mail.gmail.com>

Sorry, didn't read it properly. Thought you were talking about
including PSP snippets within other PSP files which were in same
directory as publisher file. I shouldn't rush to respond when most of
my attention is actually on something else. :-)

I'll read your emails again properly later, but you may want to read
the following in the interim:

  http://www.modpython.org/pipermail/mod_python/2006-March/020501.html

This talks about problems with determining base URLs when using
publisher and some code to help in this area.

Graham

On 09/03/07, PETER BARKER <newbarker@btinternet.com> wrote:
>
> Graham,
>
> That doesn't work because it's the client (browser) that constructs the fully qualified path to the image based on the path of the current resource (now .../ClientArea.py), and the path in the link. I got a 404 when I tried this suggestion.
>
> Here's the code of a stripped down version of the problem...
>
> INDEX.PSP:
> <html>
> <head>
>     <title>Test</title>
> </head>
> <body>
> <img src="AnImage.jpg"/>
> <br>
> <a href="ClientArea.py/entryPoint">Clients' Area</a>
> </body>
> </html>
>
> CLIENTAREA.PY:
> from mod_python import psp
> def entryPoint(req):
>   req.content_type='text/html'
>   return psp.PSP(req,filename='index.psp').run()
>
> APACHE CONFIGURATION:
> <Directory "C:/Program  Files/Apache Software Foundation/Apache2.2/htdocs/PSPExample">
>     AddHandler mod_python .py .psp
>     PythonHandler mod_python.publisher | .py
>     PythonHandler mod_python.psp | .psp
>     PythonDebug On
> </Directory>
>
> Regards,
>
> Pete
>
> Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> On 09/03/07, PETER BARKER wrote:
> > I have a website composed of some simple Python Server Page files and images
> > in the same directory. The images are referenced from the pages without any
> > qualification e.g.  or About
> > us. If the page is on
>
> >  http://localhost/company_name/index.psp, this works as
> > http://localhost/company_name/theimage.jpg or
> > http://localhost/company_name/about.psp is accessible. So
> > far so good!
> >
> > I am adding a section to the website using the mod_python publisher handler.
> > This will be implemented in a module called ClientArea.py. As part of this
> > module, I want to be able to use the existing PSP files as templates and
> > insert only the content relevant to the module. Assume I'm calling a
> > function called "entryPoint" within this module, then the browser is now
> > pointing at
> > http://localhost/company_name/ClientArea.py/entryPoint. I
> > am now having problems with the internal links because the unqualified link
> > seems to be referring to an entity withing ClientArea.py - e.g.
> > http://localhost/company_name/ClientArea.py/theimage.jpg.
> > This resource doesn't exist though!
> >
> > I don't  really want to duplicate the PSP pages and have one version with
> > "../" prefixed. I also don't want to fully qualify the links.
> >
> > I welcome suggestions on what I should be doing here!
>
> When working out relative pathnames, PSP will do the equivalent of:
>
> os.path.dirname(req.filename)
>
> to determine the base directory. For mod_python.publisher this will
> not be want you want.
>
> Provided you are using a new enough version of mod_python, before you
> invoke PSP template, set:
>
> req.filename = '/some/directory/containing/psp/files/'
>
> Ie., set it name of directory where PSP files are located. Ensure it
> has a trailing slash.
>
> BTW, I haven't tried this, but I think it should work.
>
> Graham
>
>
From fred at urlbit.us  Fri Mar  9 15:43:12 2007
From: fred at urlbit.us (Fred of UrlBit.Us)
Date: Fri Mar  9 15:43:22 2007
Subject: [mod_python] PSP and object duplication
Message-ID: <200703091543.12600.fred@urlbit.us>

I am having a problem with PSP that seems to be copying objects in the vars 
list rather than using the originals.

Basically, I invoke PSP directly in mod_python (rather than using the Apache 
directives to do it.) Something like:

psp=PSP(req, vars={"myob":myob})

And from within the template, I modify myob.

But when psp.run() returns, the modifications to myob are gone. It as though 
PSP actually made a copy of myob, rather than using the actual object 
itself.

I actually looked at the PSP code, and it appeared NOT to be doing a copy -- 
at least during construction. I did not delve deeper into the code yet.

I hope someone can explain this strange behavior!!!! Any ideas would be 
greatly appreciated. Thanks!

-- Fred
http://urlbit.us
Bite those long URLs!
From fred at urlbit.us  Fri Mar  9 15:49:00 2007
From: fred at urlbit.us (Fred of UrlBit.Us)
Date: Fri Mar  9 15:49:07 2007
Subject: [mod_python] Compiling mod_python on 64bit RHEL 4
In-Reply-To: <88e286470703081621m5e70b61ckb44303cfb87f308c@mail.gmail.com>
References: <88e286470703081555i4d41fe61o620664d59ce73b32@mail.gmail.com>
	<7B73172B331C034198AA90BDF604F5FB02860F37@XCH-NW-5V1.nw.nos.boeing.com>
	<88e286470703081621m5e70b61ckb44303cfb87f308c@mail.gmail.com>
Message-ID: <200703091549.00393.fred@urlbit.us>

On Thursday 08 March 2007 19:21, Graham Dumpleton uttered thusly:
> On 09/03/07, Posey, Jake E <Jake.E.Posey@boeing.com> wrote:
> > I've been trying to hack the -fPIC flag in the Makefile but not sure
> > where in the Makefile.  I'll also try using the 64bit compiler.
>
> Try CFLAGS in src/Makefile.

I've written a simple build script to make mod_python. Chomp, modify, and use 
as you wish. This script is set for Python 2.5, but can be modified easily 
enough for 2.4

==============
#!/bin/bash
# configure and build the mod_python module

CFLAGS="-fPIC"

make distclean
if ./configure \
    --with-max-locks=32 \
    --with-python=/usr/local/bin/python2.5 ; then
    if make; then
        if make install; then
            echo "Build, make, and install of of mod_python successful."
        else
            echo "Install failed."
            exit 3
        fi
    else
        echo "Make failed."
        exit 2
    fi
    echo
else
    echo "Configure failed"
    exit 1
fi
==============

-- 
http://urlbit.us
Bite those long URLs!
From newbarker at btinternet.com  Sat Mar 10 03:19:35 2007
From: newbarker at btinternet.com (PETER BARKER)
Date: Sat Mar 10 03:19:38 2007
Subject: [mod_python] First mod_python project design teething problems
Message-ID: <299834.32252.qm@web86011.mail.ird.yahoo.com>

Hello all,
   
  BACKGROUND
  ----------
  I have a set of PSP pages; index.psp, about.psp, etc. These call into sub-templates to get the page header, footer, etc. They only really difffer in the "content" area and I like this maintainability. These are served by Apache and the mod_python.psp handler (PythonHandler mod_python.psp | .psp).
   
  I have a another page called client.psp. This template is used by a "Client Area" of the website which is a Python module; ClientArea.py. This allows the user to login to the site to do more stuff in the Client Area. client.psp looks similar to index.psp, etc. to maintain the consistent appearance of the site, but is given it's content by the ClientArea.py module:
   
  def _mergeWithTemplate(req,txt):
  pathname = os.path.join(os.path.dirname(req.filename),'client.psp')
  template = psp.PSP(req,filename=pathname)
  return template.run({'theContent':txt})

  The content is very dynamic; it'll be a login form, or a table showing database information, etc.
   
  PROBLEM
  -------
  When a user's logged into the site I want to display a "Sign Out/Logoff" link at the top of every page. Not only on client.psp which is templated within the Python module, but index.psp and about.psp too. I had a bright idea - I can use req.session and check it within the psp templates. However, this is only going to be set for client.psp as the other pages get served from Apache directly. Do I really want to add session grabbing logic to the PSP pages and make them more complicated? 
   
  QUESTION
  --------
  Taking a step back from my actual problem, I'd like some criticism on my approach to this development. What's the best practice/standard/canonical way of employing mod_python to develop a site with a handful of quasi-static pages which look very similar and the content is known in advance (but I might want to add logoff link or similar), and a page which has the same look as the other pages but the content is very fluid?
   
  Regards,
   
  Pete
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070310/12626341/attachment.html
From yinglcs at gmail.com  Sat Mar 10 13:43:19 2007
From: yinglcs at gmail.com (ying lcs)
Date: Sat Mar 10 13:43:24 2007
Subject: [mod_python] Error in running configure in RHEL4
Message-ID: <568e62a40703101043i58e66a77k2bd10b3f943366e6@mail.gmail.com>

I get the following error in running '.configure' in RHEL4.
Can you please tell me how to fix it?

 ./configure
checking for gcc... gcc
checking for C compiler default output file name... a.out
checking whether the C compiler works... yes
checking whether we are cross compiling... no
checking for suffix of executables...
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether gcc accepts -g... yes
checking for gcc option to accept ANSI C... none needed
checking for ar... ar
checking for a BSD-compatible install... /usr/bin/install -c
checking whether make sets $(MAKE)... yes
checking for main in -lm... yes
checking for an ANSI C-conforming const... yes
checking your blood pressure... a bit high, but we can proceed
configure: checking whether apxs is available...
checking for --with-apxs... no
checking for apxs in /usr/local/apache/sbin... no
checking for apxs in your PATH... checking for apxs... no
checking for apxs2 in your PATH... checking for apxs2... no
configure: WARNING: **** apxs was not found, DSO compilation will not
be available.
configure: WARNING: **** You can use --with-apxs to specify where your apxs is.
configure: error: Neither static nor DSO option available, there is no
point in continuing.
From roberto at connexer.com  Sat Mar 10 14:53:00 2007
From: roberto at connexer.com (Roberto C. Sanchez)
Date: Sat Mar 10 14:53:03 2007
Subject: [mod_python] Error in running configure in RHEL4
In-Reply-To: <568e62a40703101043i58e66a77k2bd10b3f943366e6@mail.gmail.com>
References: <568e62a40703101043i58e66a77k2bd10b3f943366e6@mail.gmail.com>
Message-ID: <20070310195300.GC588@miami.connexer.com>

On Sat, Mar 10, 2007 at 12:43:19PM -0600, ying lcs wrote:
> I get the following error in running '.configure' in RHEL4.
> Can you please tell me how to fix it?
> 
<SNIP>
> configure: WARNING: **** apxs was not found, DSO compilation will not
> be available.
> configure: WARNING: **** You can use --with-apxs to specify where your apxs 
> is.
> configure: error: Neither static nor DSO option available, there is no
> point in continuing.

Sure, tell it where to find apxs.  If it is not already on your system,
then it is likely in the apache development packages for your distro.

Regards,

-Roberto
-- 
Roberto C. Sanchez
http://people.connexer.com/~roberto
http://www.connexer.com
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070310/a07b22a1/attachment.bin
From yinglcs at gmail.com  Sat Mar 10 15:03:15 2007
From: yinglcs at gmail.com (ying lcs)
Date: Sat Mar 10 15:03:19 2007
Subject: [mod_python] assert error "have_pysqlite > 0"
Message-ID: <568e62a40703101203t445c2be7w27ee0abf8a2b3090@mail.gmail.com>

Hi,

I am trying to setup Apache with Trac which uses mod_python. I get the
following error:
assert have_pysqlite > 0

And I have verify this  via command line as well, that seem no problem.
# python
Python 2.3.4 (#1, Feb  2 2005, 11:44:49)
[GCC 3.4.3 20041212 (Red Hat 3.4.3-9.EL4)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import trac.db.sqlite_backend
>>> trac.db.sqlite_backend._ver
(3, 3, 13)
>>> trac.db.sqlite_backend.have_pysqlite
2
>>> trac.db.sqlite_backend.sqlite.version

'2.3.3'

But when i access the Trac via Apache (with mod_python), i get the
following error:

File "/usr/lib/python2.3/site-packages/trac/db/pool.py", line 101, in
get_cnx
    cnx = self._connector.get_connection(**self._kwargs)

  File "/usr/lib/python2.3/site-packages/trac/db/sqlite_backend.py",
line 113, in get_connection
    return SQLiteConnection(path, params)

  File "/usr/lib/python2.3/site-packages/trac/db/sqlite_backend.py",
line 140, in __init__
    assert have_pysqlite > 0
From newbarker at btinternet.com  Sun Mar 11 04:21:57 2007
From: newbarker at btinternet.com (PETER BARKER)
Date: Sun Mar 11 04:22:02 2007
Subject: [mod_python] When using PSP is request object persistent?
Message-ID: <20070311092157.77502.qmail@web86015.mail.ird.yahoo.com>

Hello,
   
  See below for the stripped-down code to my problem/query. Note that I do not save the session anywhere.
   
  With the two PSP template lines commented, the session is always new (because I'm not saving it). When the templating code is uncommented, the session is remembered across requests. Why is this?
   
  APACHE CONFIG:
  <Directory "C:/Program Files/Apache Software Foundation/Apache2.2/htdocs/pypublish">
    SetHandler mod_python
    PythonDebug On
    PythonHandler mod_python.publisher
</Directory>

  INDEX.HTML:
  <html>
<head><title>hello</title></head>
<body>
</body>
</html>
   
  THETEST.PY:
  from mod_python import Session, psp
import os
  def entry(req):
  req.session = Session.Session(req)
  if req.session.is_new():
    returnedDoc = "Newly created session: " + req.session.id()
  else:
    returnedDoc = 'Existing session:' + req.session.id()
    #pathname = os.path.join(os.path.dirname(req.filename),'index.html')
  #psp.PSP(req,filename=pathname).run()
    req.content_type = 'text/html'
  return returnedDoc

  Regards,
   
  Pete
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070311/db6eb7a9/attachment.html
From graham.dumpleton at gmail.com  Sun Mar 11 04:42:11 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sun Mar 11 04:42:14 2007
Subject: [mod_python] When using PSP is request object persistent?
In-Reply-To: <20070311092157.77502.qmail@web86015.mail.ird.yahoo.com>
References: <20070311092157.77502.qmail@web86015.mail.ird.yahoo.com>
Message-ID: <88e286470703110142i67904132hab2759df4f093a86@mail.gmail.com>

On 11/03/07, PETER BARKER <newbarker@btinternet.com> wrote:
> Hello,
>
> See below for the stripped-down code to my problem/query. Note that I do not
> save the session anywhere.
>
> With the two PSP template lines commented, the session is always new
> (because I'm not saving it). When the templating code is uncommented, the
> session is remembered across requests. Why is this?
>
> APACHE CONFIG:
> <Directory "C:/Program Files/Apache Software
> Foundation/Apache2.2/htdocs/pypublish">
>     SetHandler mod_python
>     PythonDebug On
>     PythonHandler mod_python.publisher
> </Directory>
>
> INDEX.HTML:
> <html>
> <head><title>hello</title></head>
> <body>
> </body>
> </html>
>
> THETEST.PY:
> from mod_python import Session, psp
> import os
> def entry(req):
>   req.session = Session.Session(req)
>   if req.session.is_new():
>     returnedDoc = "Newly created session: " + req.session.id()
>   else:
>     returnedDoc = 'Existing session:' + req.session.id()
>   #pathname = os.path.join(os.path.dirname(req.filename),'index.html')
>   #psp.PSP(req,filename=pathname).run()
>   req.content_type = 'text/html'
>   return returnedDoc

Do you use the session object in the PSP page? If you do, then what
you are seeing is consistent with how PSP has perhaps always worked.

As the code stands, if a session object is created, whether it be
prior to PSP being invoked or as a result of a reference to the
session object in a PSP page, the PSP code is always saving the
session object to ensure that the last accessed time is updated.

If the session object wasn't actually referenced from within the PSP
page this raises an interesting corner case which wasn't perhaps
thought of when PSP was changed to use a session object present as
req.session. The issue is if req.session exists but the session object
is not used in the PSP page, should the PSP code be saving the session
to have the last accessed time updated.

Thus, the code in PSP code should perhaps instead of saying:

                # the mere instantiation of a session changes it
                # (access time), so it *always* has to be saved
                if hasattr(req, 'session'):
                    req.session.save()

perhaps say:

                # the mere instantiation of a session changes it
                # (access time), so it *always* has to be saved
                if "session" in code.co_names and hasattr(req, 'session'):
                    req.session.save()

In summary, it is a feature of PSP that if a session object is used in
a PSP page that the session is always saved automatically. The
question is whether it should be saving it when the session was
created before PSP was invoked and the session isn't used in the PSP
page. Problem is that changing the behaviour may be too late now that
it is working this way.


Graham
From newbarker at btinternet.com  Sun Mar 11 06:05:34 2007
From: newbarker at btinternet.com (PETER BARKER)
Date: Sun Mar 11 06:05:38 2007
Subject: [mod_python] When using PSP is request object persistent?
In-Reply-To: <88e286470703110142i67904132hab2759df4f093a86@mail.gmail.com>
Message-ID: <20070311110534.23375.qmail@web86015.mail.ird.yahoo.com>

Graham,
   
  I appreciate the reply. My method fits in the corner case you mention. The stripped down example is from a project where a protected area of the website is entered. The previous presence of the session means they're already logged in, and the absence means they are required to login. This logic is based upon the description of the is_new() method at http://www.modpython.org/live/current/doc-html/pyapi-sess-classes.html where it suggests you could use:
   
  sess = Session(req)
if sess.is_new():
    # redirect to login
    util.redirect(req, 'http://www.mysite.com/login')
   
  Of course, I'm doing something slightly different and composing a page from PSP templates. It's a shame this templating method which doesn't logically have anything to do with sessions (when viewed purely from a templating perspective) disables the ability to use is_new() in this way.
   
  I was going to store additional session information in a relational database anyway, so for me I guess the fix is to check for existence of corresponding record in the database as I'm definitely in control of that persistence! I'm going to have to store the last access time in the database too so I can implement the timing out of a session.
   
  Regards,
   
  Pete

Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
  On 11/03/07, PETER BARKER wrote:
> Hello,
>
> See below for the stripped-down code to my problem/query. Note that I do not
> save the session anywhere.
>
> With the two PSP template lines commented, the session is always new
> (because I'm not saving it). When the templating code is uncommented, the
> session is remembered across requests. Why is this?
>
> APACHE CONFIG:
> 
> SetHandler mod_python
> PythonDebug On
> PythonHandler mod_python.publisher
> 
>
> INDEX.HTML:
> 
> 
> 
> 
> 
>
> THETEST.PY:
> from mod_python import Session, psp
> import os
> def entry(req):
> req.session = Session.Session(req)
> if req.session.is_new():
> returnedDoc = "Newly created session: " + req.session.id()
> else:
> returnedDoc = 'Existing session:' + req.session.id()
> #pathname = os.path.join(os.path.dirname(req.filename),'index.html')
> #psp.PSP(req,filename=pathname).run()
> req.content_type = 'text/html'
> return returnedDoc

Do you use the session object in the PSP page? If you do, then what
you are seeing is consistent with how PSP has perhaps always worked.

As the code stands, if a session object is created, whether it be
prior to PSP being invoked or as a result of a reference to the
session object in a PSP page, the PSP code is always saving the
session object to ensure that the last accessed time is updated.

If the session object wasn't actually referenced from within the PSP
page this raises an interesting corner case which wasn't perhaps
thought of when PSP was changed to use a session object present as
req.session. The issue is if req.session exists but the session object
is not used in the PSP page, should the PSP code be saving the session
to have the last accessed time updated.

Thus, the code in PSP code should perhaps instead of saying:

# the mere instantiation of a session changes it
# (access time), so it *always* has to be saved
if hasattr(req, 'session'):
req.session.save()

perhaps say:

# the mere instantiation of a session changes it
# (access time), so it *always* has to be saved
if "session" in code.co_names and hasattr(req, 'session'):
req.session.save()

In summary, it is a feature of PSP that if a session object is used in
a PSP page that the session is always saved automatically. The
question is whether it should be saving it when the session was
created before PSP was invoked and the session isn't used in the PSP
page. Problem is that changing the behaviour may be too late now that
it is working this way.


Graham

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070311/888f5fe3/attachment-0001.html
From graham.dumpleton at gmail.com  Sun Mar 11 06:10:13 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sun Mar 11 06:10:15 2007
Subject: [mod_python] When using PSP is request object persistent?
In-Reply-To: <20070311110534.23375.qmail@web86015.mail.ird.yahoo.com>
References: <88e286470703110142i67904132hab2759df4f093a86@mail.gmail.com>
	<20070311110534.23375.qmail@web86015.mail.ird.yahoo.com>
Message-ID: <88e286470703110410v5ee3f04chd202e62f17a65067@mail.gmail.com>

In your case, if you don't want PSP code messing with your session
object, simply don't save it as req.session. Instead call it
req.mysession. This will work as long as there is no attempt to access
'session' variable in a PSP page. If there is then PSP will attempt to
create its own session object and you will get a deadlock as your code
has already created one and has a lock on it.

Graham

On 11/03/07, PETER BARKER <newbarker@btinternet.com> wrote:
> Graham,
>
> I appreciate the reply. My method fits in the corner case you mention. The
> stripped down example is from a project where a protected area of the
> website is entered. The previous presence of the session means they're
> already logged in, and the absence means they are required to login. This
> logic is based upon the description of the is_new() method at
> http://www.modpython.org/live/current/doc-html/pyapi-sess-classes.html
> where it suggests you could use:
>
> sess = Session(req)
> if sess.is_new():
>     # redirect to login
>     util.redirect(req, 'http://www.mysite.com/login')
>
> Of course, I'm doing something slightly different and composing a page from
> PSP templates. It's a shame this templating method which doesn't logically
> have anything to do with sessions (when viewed purely from a templating
> perspective) disables the ability to use is_new() in this way.
>
> I was going to store additional session information in a relational database
> anyway, so for me I guess the fix is to check for existence of corresponding
> record in the database as I'm definitely in control of that persistence! I'm
> going to have to store the last access time in the database too so I can
> implement the timing out of a session.
>
> Regards,
>
> Pete
>
> Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> On 11/03/07, PETER BARKER wrote:
> > Hello,
> >
> > See below for the stripped-down code to my problem/query. Note that I do
> not
> > save the session anywhere.
> >
> > With the two PSP template lines commented, the session is always new
> > (because I'm not saving it). When the templating code is uncommented, the
> > session is remembered across requests. Why is this?
> >
> > APACHE CONFIG:
> >
> > SetHandler mod_python
> > PythonDebug On
> > PythonHandler mod_python.publisher
> >
> >
> > INDEX.HTML:
>
> >
> >
> >
> >
> >
> >
> > THETEST.PY:
> > from mod_python import Session, psp
> > import os
> > def entry(req):
> > req.session = Session.Session(req)
> > if req.session.is_new():
> > returnedDoc = "Newly created session: " + req.session.id()
> > else:
> > returnedDoc = 'Existing session:' + req.session.id()
> > #pathname = os.path.join(os.path.dirname(req.filename),'index.html')
> > #psp.PSP(req,filename=pathname).run()
> > req.content_type = 'text/html'
> > return returnedDoc
>
> Do you use the session object in the PSP page? If you do, then what
> you are seeing is consistent with how PSP has perhaps always worked.
>
> As the code stands, if a session object is created, whether it be
> prior to PSP being invoked or as a result of a reference to the
> session object in a PSP page, the PSP code is always saving the
> session object to ensure that the last accessed time is updated.
>
> If the session object wasn't actually referenced from within the PSP
> page this raises an interesting corner case which wasn't perhaps
> thought of when PSP was changed to use a session object present as
> req.session. The issue is if req.session exists but the session object
> is not used in the PSP page, should the PSP code be saving the session
> to have the last accessed time updated.
>
> Thus, the code in PSP code should perhaps instead of saying:
>
> # the mere instantiation of a session changes it
> # (access time), so it *always* has to be saved
> if hasattr(req, 'session'):
> req.session.save()
>
> perhaps say:
>
> # the mere instantiation of a session changes it
> # (access time), so it *always* has to be saved
> if "session" in code.co_names and hasattr(req, 'session'):
> req.session.save()
>
> In summary, it is a feature of PSP that if a session object is used in
> a PSP page that the session is always saved automatically. The
> question is whether it should be saving it when the session was
> created before PSP was invoked and the session isn't used in the PSP
> page. Problem is that changing the behaviour may be too late now that
> it is working this way.
>
>
> Graham
>
>
From fred at urlbit.us  Sun Mar 11 10:17:44 2007
From: fred at urlbit.us (Fred of UrlBit.Us)
Date: Sun Mar 11 10:17:56 2007
Subject: [mod_python] Session persistence issues and interpereter wiedness...
In-Reply-To: <200703091543.12600.fred@urlbit.us>
References: <200703091543.12600.fred@urlbit.us>
Message-ID: <200703111117.45555.fred@urlbit.us>

On Friday 09 March 2007 15:43, Fred of UrlBit.Us uttered thusly:
> I am having a problem with PSP that seems to be copying objects in the
> vars list rather than using the originals.

What I thought was "object duplication" wasn't at all -- actually, I am 
seeing two problems (and I mis-read my log dumps).

I am not wanting PSP to automatically handle the session object, since I want 
to handle that myself outside of PSP. So I pass in the session object as a 
part of a composition object variable to PSP space, so PSP will leave it 
alone. Then I explicitly save the Session with session.save().

My problem is that for whatever the reason, the session appears to not be 
loading on the next query, even though the SID is still there and the 
Session object report it's not new. I have confirmed that the save is saving 
the modifications (by hex-dumping the contents of the DBM files, etc., but 
they are not loading. No exceptions are generated either. I create the 
session in the handler with Session(req).

The 2nd issue I am seeing -- maybe related, but I doubt it -- is that the 
interpreter for the virtual server seems to reload every so often, as I 
notice modules and plugins being reloaded after so many queries. Is this 
suppose to happen?

Any help would be greatly appreciated.

Running Linux (32-bit), Apache 2.0.55, mod_python 3.3.1, Python 2.5

--Fred 
http://urlbit.us
Bite those long URLs!
From jpg at jgassociates.ca  Sun Mar 11 11:26:41 2007
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Sun Mar 11 11:25:33 2007
Subject: [mod_python] Session persistence issues and interpereter
	wiedness...
In-Reply-To: <200703111117.45555.fred@urlbit.us>
References: <200703091543.12600.fred@urlbit.us>
	<200703111117.45555.fred@urlbit.us>
Message-ID: <45F42DC1.3000700@jgassociates.ca>

Fred of UrlBit.Us wrote:
> On Friday 09 March 2007 15:43, Fred of UrlBit.Us uttered thusly:
>> I am having a problem with PSP that seems to be copying objects in the
>> vars list rather than using the originals.
> 
> What I thought was "object duplication" wasn't at all -- actually, I am 
> seeing two problems (and I mis-read my log dumps).
> 
> I am not wanting PSP to automatically handle the session object, since I want 
> to handle that myself outside of PSP. So I pass in the session object as a 
> part of a composition object variable to PSP space, so PSP will leave it 
> alone. Then I explicitly save the Session with session.save().
> 
> My problem is that for whatever the reason, the session appears to not be 
> loading on the next query, even though the SID is still there and the 
> Session object report it's not new. I have confirmed that the save is saving 
> the modifications (by hex-dumping the contents of the DBM files, etc., but 
> they are not loading. No exceptions are generated either. I create the 
> session in the handler with Session(req).

Make sure you create your session object before sending *any* content 
back to the client. The response header for the session cookie is set 
when the session object is created. The first call to req.write(), 
either explicitly, or implicitly with PSP or publisher, causes the 
response headers to be sent. If you create your session after that it 
will be too late. Each new request will always seem to create a new session.

By way of illustration, this bit of code would exhibit the problem:

def handler(req):
     req.content_type = 'text/plain'
     req.write('stuff\n') # this forces the response headers to be sent
     sess = Session(req)  # oops, headers already sent
                          #  - client never sees the session cookie
     sess.save()
     req.write('more stuff')
     return apache.OK

You can confirm that the session cookie is not getting set by looking at 
the response headers on the client.

> The 2nd issue I am seeing -- maybe related, but I doubt it -- is that the 
> interpreter for the virtual server seems to reload every so often, as I 
> notice modules and plugins being reloaded after so many queries. Is this 
> suppose to happen?

Am I to assume that your modules are not changing? If so, this could be 
related to your apache configuration. For prefork-mpm (worker-mpm will 
be similar), if MaxRequestsPerChild is > 0, then the child process will 
be killed and a new interpreter created when httpd spawns a new child 
process.

Likewise, take a look at:

StartServers         5
MinSpareServers      5
MaxSpareServers     10

If the load spikes a number of new processes may be created, each 
getting a new interpreter. When the load falls again httpd will kill 
some off to somewhere between 5 and 10.

> Running Linux (32-bit), Apache 2.0.55, mod_python 3.3.1, Python 2.5

Jim


From mcla0181 at umn.edu  Sun Mar 11 22:11:52 2007
From: mcla0181 at umn.edu (Jon McLachlan)
Date: Sun Mar 11 22:12:06 2007
Subject: [mod_python] Install Question
Message-ID: <45F4C4F8.5060005@umn.edu>

Hi,

  I am trying to install mod_python on apache 2.2.4, running SuSE (uname 
-a = Linux neo 2.6.16.27-0.6-default #1 Wed Dec 13 09:34:50 UTC 2006 
i686 i686 i386 GNU/Linux).  I have not encountered any strange behavior 
while following the documented install process described at 
http://www.modpython.org/live/current/doc-html/inst-compiling.html.  I 
am primarily interested in installing mod_python as a DSO on apache, 
because my primary use is for trac.  Whenever I attempt to use the 
mod_python handler for a specific Directory, Location, or VM as defined 
in the apache's configuration, it returns an internal server error to 
the client.  Further, the error_log reports the following:

[Sun Mar 11 21:53:30 2007] [error] make_obcallback: could not call init.\n
TypeError: init() takes no arguments (2 given)
[Sun Mar 11 21:53:30 2007] [error] make_obcallback: mod_python version 
mismatch, expected '3.3.1', found '<unknown>'.
[Sun Mar 11 21:53:30 2007] [error] make_obcallback: mod_python modules 
location '/usr/lib/python2.4/site-packages/mod_python/__init__.pyc'.
[Sun Mar 11 21:53:30 2007] [error] get_interpreter: no interpreter 
callback found.
[Sun Mar 11 21:53:30 2007] [error] [client 63.231.137.166] 
python_handler: Can't get/create interpreter.

The trouble shooting guide at 
http://www.modpython.org/live/current/doc-html/inst-trouble.html did not 
help much.
The FAQ seemed hopeful at first, but after the faq for "init" redirected 
me to http://www.modpython.org/FAQ/faqw.py?req=show&file=faq02.001.htp I 
am still yet to resolve this issue.

I am certain that the files in 
"/usr/lib/python2.4/site-packages/mod_python/*" are accessible by the 
apache username/group.  I know that adding a PYTHONHOME env variable for 
apache, only complicates things by making the module unloadable (even 
when this points to the correct, and readable&executable, python dir, 
because apache always seems to mangle the path while, this is funny, 
"looking for python").  I have tried "strace httpd -X" but, I have not 
discovered any extra clues as to what is going on - only similar 
information as described above in the error logs.  I am entirely perplex 
by the elusive culprit behind this bug.  I know that it must ultimately 
be something I am not understanding, though, so here I plead to a more 
practiced group.

Any thoughts, comments, or advice are greatly appreciated.

Best Regards,
~Jon
From graham.dumpleton at gmail.com  Sun Mar 11 22:28:12 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sun Mar 11 22:28:16 2007
Subject: [mod_python] Install Question
In-Reply-To: <45F4C4F8.5060005@umn.edu>
References: <45F4C4F8.5060005@umn.edu>
Message-ID: <88e286470703112028mf3e9dacx9a0fba2123127a05@mail.gmail.com>

Are you absolutely sure that the mod_python files in Python
site-packages are those for the version of mod_python you are using?

The error messages indicate that a recent version of mod_python is
installed but that it is finding an old version of mod_python Python
code files in site-packages. This is evident as mod_python is trying
to pass two arguments to the init() function but the Python code files
aren't expecting any. The change to passing two arguments occurred
sometime in mod_python 3.2.X versions.

If the site-packages has correct versions, then speculate that you
have two versions of Python installed and old version of mod_python
files is in the version of Python you didn't want used. If the version
of Python you want used is in a non standard spot, you will need to
change the PATH inherited by the Apache process such that the python
executable you want used appears first in the PATH before than in
/usr/bin.

Graham

On 12/03/07, Jon McLachlan <mcla0181@umn.edu> wrote:
> Hi,
>
>   I am trying to install mod_python on apache 2.2.4, running SuSE (uname
> -a = Linux neo 2.6.16.27-0.6-default #1 Wed Dec 13 09:34:50 UTC 2006
> i686 i686 i386 GNU/Linux).  I have not encountered any strange behavior
> while following the documented install process described at
> http://www.modpython.org/live/current/doc-html/inst-compiling.html.  I
> am primarily interested in installing mod_python as a DSO on apache,
> because my primary use is for trac.  Whenever I attempt to use the
> mod_python handler for a specific Directory, Location, or VM as defined
> in the apache's configuration, it returns an internal server error to
> the client.  Further, the error_log reports the following:
>
> [Sun Mar 11 21:53:30 2007] [error] make_obcallback: could not call init.\n
> TypeError: init() takes no arguments (2 given)
> [Sun Mar 11 21:53:30 2007] [error] make_obcallback: mod_python version
> mismatch, expected '3.3.1', found '<unknown>'.
> [Sun Mar 11 21:53:30 2007] [error] make_obcallback: mod_python modules
> location '/usr/lib/python2.4/site-packages/mod_python/__init__.pyc'.
> [Sun Mar 11 21:53:30 2007] [error] get_interpreter: no interpreter
> callback found.
> [Sun Mar 11 21:53:30 2007] [error] [client 63.231.137.166]
> python_handler: Can't get/create interpreter.
>
> The trouble shooting guide at
> http://www.modpython.org/live/current/doc-html/inst-trouble.html did not
> help much.
> The FAQ seemed hopeful at first, but after the faq for "init" redirected
> me to http://www.modpython.org/FAQ/faqw.py?req=show&file=faq02.001.htp I
> am still yet to resolve this issue.
>
> I am certain that the files in
> "/usr/lib/python2.4/site-packages/mod_python/*" are accessible by the
> apache username/group.  I know that adding a PYTHONHOME env variable for
> apache, only complicates things by making the module unloadable (even
> when this points to the correct, and readable&executable, python dir,
> because apache always seems to mangle the path while, this is funny,
> "looking for python").  I have tried "strace httpd -X" but, I have not
> discovered any extra clues as to what is going on - only similar
> information as described above in the error logs.  I am entirely perplex
> by the elusive culprit behind this bug.  I know that it must ultimately
> be something I am not understanding, though, so here I plead to a more
> practiced group.
>
> Any thoughts, comments, or advice are greatly appreciated.
>
> Best Regards,
> ~Jon
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From nunoalexandre.rodrigues at gmail.com  Tue Mar 13 06:41:30 2007
From: nunoalexandre.rodrigues at gmail.com (Nuno Rodrigues)
Date: Tue Mar 13 06:41:52 2007
Subject: [mod_python] Help installing mod_python on apache and xp
Message-ID: <45F68DEA.000001.03192@EL-DIABLU>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/gif
Size: 21075 bytes
Desc: not available
Url : http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070313/619fcdda/attachment-0001.gif
From mlists at e-beyond.de  Tue Mar 13 07:19:53 2007
From: mlists at e-beyond.de (me)
Date: Tue Mar 13 07:21:26 2007
Subject: [mod_python] reloading issue
Message-ID: <200703131320.00612.mlists@e-beyond.de>

Hi there,

I've got an issue with mod_python. There is a script (index.py) wich is 
processed when I go to http://www.xyz.somewhere/ but when I reload
the page 3-4 times I'll receive the error below. It doesn't matter if the page 
is reloaded fast or slowly.
The only point that may be an problem (but I didn't think so) is a factory 
which should provide the classes for the modules (not the python-modules) of 
the site.

thanks for your help!!
marc

mod_python: 3.3.1
python 2.4

The Factory:
class ContentFactory:
  def factory(self,className, *args):
    aClass = getattr(__import__(__name__), className)
    return apply(aClass, args)

The error-message:
MOD_PYTHON ERROR

ProcessId:      29986
Interpreter:    'www.xyz.somehwere'

ServerName:     'www.xyz.somehwere'
DocumentRoot:   '/www/www.xyz.somehwere/htdocs'

URI:            '/'
Location:       '/'
Directory:      None
Filename:       '/www/www.xyz.somehwere/htdocs/index.py'
PathInfo:       ''

Phase:          'PythonHandler'
Handler:        'mod_python.publisher'

Traceback (most recent call last):

  File "/usr/lib/python2.4/site-packages/mod_python/importer.py", line 1537, 
in HandlerDispatch
    default=default_handler, arg=req, silent=hlist.silent)

  File "/usr/lib/python2.4/site-packages/mod_python/importer.py", line 1229, 
in _process_target
    result = _execute_target(config, req, object, arg)

  File "/usr/lib/python2.4/site-packages/mod_python/importer.py", line 1128, 
in _execute_target
    result = object(arg)

  File "/usr/lib/python2.4/site-packages/mod_python/publisher.py", line 213, 
in handler
    published = publish_object(req, object)

  File "/usr/lib/python2.4/site-packages/mod_python/publisher.py", line 425, 
in publish_object
    return publish_object(req,util.apply_fs_data(object, req.form, req=req))

  File "/usr/lib/python2.4/site-packages/mod_python/util.py", line 554, in 
apply_fs_data
    return object(**args)

  File "/www/www.xyz.somehwere/htdocs/index.py", line 6, in index
    return c.getResponse()

  File "/www/www.xyz.somehwere/htdocs/_module/Content.py", line 28, in 
getResponse
    return Template ( file = self.req.document_root() 
+ '/_templates/standard.tmpl', searchList = [{ 'authenticated': 
self.authenticated , 'content' : self._processContent()}] )

  File "/www/www.xyz.somehwere/htdocs/_module/Content.py", line 23, in 
_processContent
    contentRunner = cp.factory('MainIndex',self.req)

  File "/www/www.xyz.somehwere/htdocs/_module/ContentFactory.py", line 6, in 
factory
    aClass = getattr(__import__(__name__), className)

AttributeError: 'module' object has no attribute 'MainIndex'


MODULE CACHE DETAILS

Accessed:       Tue Mar 13 13:08:47 2007
Generation:     1

_mp_977643700f732f7a07a576608a2136c2 {
  FileName:     '/www/www.xyz.somehwere/htdocs/index.py'
  Instance:     1
  Generation:   1
  Modified:     Tue Mar 13 09:10:38 2007
  Imported:     Tue Mar 13 12:41:52 2007
}
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070313/5206c277/attachment.bin
From graham.dumpleton at gmail.com  Tue Mar 13 16:14:15 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Mar 13 16:14:22 2007
Subject: [mod_python] Help installing mod_python on apache and xp
In-Reply-To: <45F68DEA.000001.03192@EL-DIABLU>
References: <45F68DEA.000001.03192@EL-DIABLU>
Message-ID: <88e286470703131414i6a75bcefud7d23b7c9361c133@mail.gmail.com>

You have stuffed up your Apache configuration at some point as
evidenced by message:

> [error] [client 127.0.0.1] client denied by server configuration: C:/Program Files/Apache Software Foundation/Apache2.2/htdocs/

You should have had a configuration entry somewhere of the form:

<Directory C:/Program Files/Apache Software Foundation/Apache2.2/htdocs>
Order deny, allow
Allow from all
</Directory>

What happened to that?

I might then suggest you read instructions at:

  http://www.dscpl.com.au/wiki/ModPython/Articles/GettingModPythonWorking

and get it working using .htaccess method in subdirectory of htdocs.
Then you might read the Apache documentation and understand how
Directory directives work so as to know the difference and use them to
set it all up from main configuration.

Graham

On 13/03/07, Nuno Rodrigues <nunoalexandre.rodrigues@gmail.com> wrote:
>
>
>
> Hello to you all,
> I'm a newbie on Python and on Apache, but I've searched the faq for the same error  without sucess.
> First the facts:
>
> Apache HTTP Server 2.2.4 + Python 2.5 + Mod_python 3.3.1 on XP Pro
>
> I've used the windows installers without any errors. Manually added the following lines to the httpd.conf server file:
>
> LoadModule python_module modules/mod_python.so
>
> <Directory /mptest>
>     AddHandler mod_python .py
>     PythonHandler mptest
>     PythonDebug On
>     AllowOverride FileInfo
> </Directory>
>
> The server test page works and I can get the mod_python version on the python command line, but when I put my python test on the browser instead of "Hello World!" I get the entire python code:
> from mod_python import apache
>
> def handler(req):
>    req.content_type = 'text/plain'
>    req.write("Hello World!")
>    return apache.OK
>
> What's wrong with this ? Can anyone please help me out ?
>
> PS:
> Error Log(errors and warnings only):
> (...)
> [error] [client 127.0.0.1] File does not exist: C:/Program Files/Apache Software Foundation/Apache2.2/htdocs/CFIDE
> [error] [client 127.0.0.1] File does not exist: C:/Program Files/Apache Software Foundation/Apache2.2/htdocs/CFIDE
> [error] [client 127.0.0.1] File does not exist: C:/Program Files/Apache Software Foundation/Apache2.2/htdocs/temp.html
>
> (...)
> [error] [client 127.0.0.1] client denied by server configuration: C:/Program Files/Apache Software Foundation/Apache2.2/htdocs/
> [error] [client 127.0.0.1] client denied by server configuration: C:/Program Files/Apache Software Foundation/Apache2.2/htdocs/favicon.ico
> [error] [client 127.0.0.1] client denied by server configuration: C:/Program Files/Apache Software Foundation/Apache2.2/htdocs/favicon.ico
> [error] [client 127.0.0.1] client denied by server configuration: C:/Program Files/Apache Software Foundation/Apache2.2/htdocs/mptest.py
> [error] [client 127.0.0.1] client denied by server configuration: C:/Program Files/Apache Software Foundation/Apache2.2/htdocs/mptest
> [error] [client 127.0.0.1] client denied by server configuration: C:/Program Files/Apache Software Foundation/Apache2.2/htdocs/mptest.py
> [error] [client 127.0.0.1] client denied by server configuration: C:/Program Files/Apache Software Foundation/Apache2.2/htdocs/mptest
> [error] [client 127.0.0.1] client denied by server configuration: C:/Program Files/Apache Software Foundation/Apache2.2/htdocs/mptest.py
> [error] [client 127.0.0.1] client denied by server configuration: C:/Program Files/Apache Software Foundation/Apache2.2/htdocs/
>
> (...)
> [warn] (OS 995)The I/O operation has been aborted because of either a thread exit or an application request.  : winnt_accept: Asynchronous AcceptEx failed.
>
> (...)
> [error] [client 127.0.0.1] File does not exist: C:/Program Files/Apache Software Foundation/Apache2.2/htdocs/mptest.py
> (...)
> [error] [client 127.0.0.1] File does not exist: C:/Program Files/Apache Software Foundation/Apache2.2/htdocs/favicon.ico
> [error] [client 127.0.0.1] File does not exist: C:/Program Files/Apache Software Foundation/Apache2.2/htdocs/favicon.ico
> [error] [client 127.0.0.1] File does not exist: C:/Program Files/Apache Software Foundation/Apache2.2/htdocs/favicon.ico
>
>
>
>
>
>
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
From graham.dumpleton at gmail.com  Tue Mar 13 16:22:38 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Mar 13 16:22:41 2007
Subject: [mod_python] reloading issue
In-Reply-To: <200703131320.00612.mlists@e-beyond.de>
References: <200703131320.00612.mlists@e-beyond.de>
Message-ID: <88e286470703131422n4ab44da0sc0205d350917f235@mail.gmail.com>

On 13/03/07, me <mlists@e-beyond.de> wrote:
> Hi there,
>
> I've got an issue with mod_python. There is a script (index.py) wich is
> processed when I go to http://www.xyz.somewhere/ but when I reload
> the page 3-4 times I'll receive the error below. It doesn't matter if the page
> is reloaded fast or slowly.
> The only point that may be an problem (but I didn't think so) is a factory
> which should provide the classes for the modules (not the python-modules) of
> the site.
>
> thanks for your help!!
> marc
>
> mod_python: 3.3.1
> python 2.4
>
> The Factory:
> class ContentFactory:
>   def factory(self,className, *args):
>     aClass = getattr(__import__(__name__), className)

Why are you using __name__ as argument to __import__ here as that
would mean you are trying to import the same module as the code is in,
although that will not actually work as you think as modules like your
index.py file are imported by special mod_python module importer and
__name__ will not be 'index' but  in this case
'_mp_977643700f732f7a07a576608a2136c2'. Since the mod_python module
importer will not find a .py file by that name, it will fallback to
Python importer which I would have though would have failed to find
it.

Are you really wanting to import the same module as the code is in?

Rather than using __import__() you might be better off looking at the
apache.import_module() function as described in:

  http://www.modpython.org/live/current/doc-html/pyapi-apmeth.html

This will give you better control over module importing as file can be
specified by full path. Also allows automatic module reloading.

Graham

>     return apply(aClass, args)
>
> The error-message:
> MOD_PYTHON ERROR
>
> ProcessId:      29986
> Interpreter:    'www.xyz.somehwere'
>
> ServerName:     'www.xyz.somehwere'
> DocumentRoot:   '/www/www.xyz.somehwere/htdocs'
>
> URI:            '/'
> Location:       '/'
> Directory:      None
> Filename:       '/www/www.xyz.somehwere/htdocs/index.py'
> PathInfo:       ''
>
> Phase:          'PythonHandler'
> Handler:        'mod_python.publisher'
>
> Traceback (most recent call last):
>
>   File "/usr/lib/python2.4/site-packages/mod_python/importer.py", line 1537,
> in HandlerDispatch
>     default=default_handler, arg=req, silent=hlist.silent)
>
>   File "/usr/lib/python2.4/site-packages/mod_python/importer.py", line 1229,
> in _process_target
>     result = _execute_target(config, req, object, arg)
>
>   File "/usr/lib/python2.4/site-packages/mod_python/importer.py", line 1128,
> in _execute_target
>     result = object(arg)
>
>   File "/usr/lib/python2.4/site-packages/mod_python/publisher.py", line 213,
> in handler
>     published = publish_object(req, object)
>
>   File "/usr/lib/python2.4/site-packages/mod_python/publisher.py", line 425,
> in publish_object
>     return publish_object(req,util.apply_fs_data(object, req.form, req=req))
>
>   File "/usr/lib/python2.4/site-packages/mod_python/util.py", line 554, in
> apply_fs_data
>     return object(**args)
>
>   File "/www/www.xyz.somehwere/htdocs/index.py", line 6, in index
>     return c.getResponse()
>
>   File "/www/www.xyz.somehwere/htdocs/_module/Content.py", line 28, in
> getResponse
>     return Template ( file = self.req.document_root()
> + '/_templates/standard.tmpl', searchList = [{ 'authenticated':
> self.authenticated , 'content' : self._processContent()}] )
>
>   File "/www/www.xyz.somehwere/htdocs/_module/Content.py", line 23, in
> _processContent
>     contentRunner = cp.factory('MainIndex',self.req)
>
>   File "/www/www.xyz.somehwere/htdocs/_module/ContentFactory.py", line 6, in
> factory
>     aClass = getattr(__import__(__name__), className)
>
> AttributeError: 'module' object has no attribute 'MainIndex'
>
>
> MODULE CACHE DETAILS
>
> Accessed:       Tue Mar 13 13:08:47 2007
> Generation:     1
>
> _mp_977643700f732f7a07a576608a2136c2 {
>   FileName:     '/www/www.xyz.somehwere/htdocs/index.py'
>   Instance:     1
>   Generation:   1
>   Modified:     Tue Mar 13 09:10:38 2007
>   Imported:     Tue Mar 13 12:41:52 2007
> }
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
>
From graham.dumpleton at gmail.com  Wed Mar 14 00:54:30 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Mar 14 00:54:34 2007
Subject: [mod_python] reloading issue
In-Reply-To: <200703140646.31872.mlists@e-beyond.de>
References: <200703131320.00612.mlists@e-beyond.de>
	<88e286470703131422n4ab44da0sc0205d350917f235@mail.gmail.com>
	<200703140646.31872.mlists@e-beyond.de>
Message-ID: <88e286470703132254i142cec97p20f2eac2785f9743@mail.gmail.com>

On 14/03/07, me <mlists@e-beyond.de> wrote:
> Hello Graham,
>
> Am Dienstag 13 M?rz 2007 22:22:38 schrieben Sie:
> > > The Factory:
> > > class ContentFactory:
> > >   def factory(self,className, *args):
> > >     aClass = getattr(__import__(__name__), className)
> >
> > Why are you using __name__ as argument to __import__ here as that
> > would mean you are trying to import the same module as the code is in,
> > although that will not actually work as you think as modules like your
> > index.py file are imported by special mod_python module importer and
> > __name__ will not be 'index' but  in this case
> > '_mp_977643700f732f7a07a576608a2136c2'. Since the mod_python module
> > importer will not find a .py file by that name, it will fallback to
> > Python importer which I would have though would have failed to find
> > it.
> >
> > Are you really wanting to import the same module as the code is in?
> >
> > Rather than using __import__() you might be better off looking at the
> > apache.import_module() function as described in:
> >
> >   http://www.modpython.org/live/current/doc-html/pyapi-apmeth.html
> >
> > This will give you better control over module importing as file can be
> > specified by full path. Also allows automatic module reloading.
> >
>
> I'm fairly new to python (I've used python years ago and came back to use it
> now) and I was trying to implement an factory. So I can load Classes based
> on a provided string and not to use a huge if elif condition.
>
> If I use the apache.import_module it should look like the following, right?
>
> def factory(self,className, *args):
>         module = apache.import_module('./Contents/'+className+'.py')
>         aClass = getattr(module, className)
>
> The strange thing with the 'old' factory: it's working. The strange behaviour
> that this error occurs sometimes is gone after 3-4 apache restarts. Now it
> works as expected. (Okay I'll reimplement the factory now)

Presuming that the 'Contents' directory is a subdirectory of the
directory where the code file containing that factory method is
contained in, and the directory the factory method is contained in is
a module imported by mod_python or mod_python.publisher, then yes it
should work.

If you have defined use of mod_python.publisher for the directory the
factory method is in, all those files in the 'Contents' subdirectory
will also be visible through mod_python.publisher. You should
therefore move your 'Contents' directory out of the web server
document tree to avoid them being called directly, or put a .htaccess
file in the 'Contents' directory which contains:

  Deny from all

This will stop them being accessible by mod_python.publisher from a client.

Graham

From graham.dumpleton at gmail.com  Wed Mar 14 04:37:00 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Mar 14 04:37:04 2007
Subject: [mod_python] reloading issue
In-Reply-To: <200703140738.45450.mlists@e-beyond.de>
References: <200703131320.00612.mlists@e-beyond.de>
	<200703140646.31872.mlists@e-beyond.de>
	<88e286470703132254i142cec97p20f2eac2785f9743@mail.gmail.com>
	<200703140738.45450.mlists@e-beyond.de>
Message-ID: <88e286470703140237u147b8820w67fb00aad3b3161c@mail.gmail.com>

On 14/03/07, me <mlists@e-beyond.de> wrote:
> Hello Graham,
>
> Am Mittwoch 14 M?rz 2007 06:54:30 schrieben Sie:
> > On 14/03/07, me <mlists@e-beyond.de> wrote:
> > If you have defined use of mod_python.publisher for the directory the
> > factory method is in, all those files in the 'Contents' subdirectory
> > will also be visible through mod_python.publisher. You should
> > therefore move your 'Contents' directory out of the web server
> > document tree to avoid them being called directly, or put a .htaccess
> > file in the 'Contents' directory which contains:
> >
> >   Deny from all
> >
> > This will stop them being accessible by mod_python.publisher from a client.
>
> I thought I've read in the documentation that when I create a directory with
> an leading underscore the directory is protected.
>         http://www.modpython.org/live/current/doc-html/hand-pub-alg-trav.html
> My directory structure looks like that:
>
>   DocumentRoot/_modules/Contents/__init__.py
>                                                           MainIndex.py
>                          /index.py
>
> And the module directory is provided to the importer in the apache
> configuration:
>
> PythonOption
> mod_python.importer.path "['/www/www.isi-muenchen.de/htdocs/_module']"
>
> I think that should be okay... ??

Correct on the underscore, although a .htaccess file is still a good
idea because if someone stuffs up the main Apache configuration they
could inadvertently expose your source code still since the only thing
stopping it from being visible is mod_python.publisher at the moment.

As far as import_module(), that also should work with that importer
path, although using a non obvious aspect of import_module() which I
am not sure is actually documented as a feature and you probably
should not rely upon. That is that using relative path of './' will
resolve relative to directory the call is done from, but in your case
you have stumbled upon fact that implementation actually also tries to
find a module by appending a './' prefixed path to any of the
directories in the importer path. Thus why it finds './Contents' even
though it isn't in the directory the call is being made from but
elsewhere. You would be better off reserving './' for when you really
mean relative to the same directory. Instead use just:

  module = apache.import_module('Contents/' + className)

This will have the same affect and that it isn't a relative path
implies better that a search is being done.

Other options is to be explicit:

  module = apache.import _module('~/_modules/Contents/' + className + '.py')

BTW, the 'Contents/__init__.py' will not be getting imported unless
you explicitly do so. Ie., not treated like a package.

Also, please keep followups on the mailing list.

Graham

From mlists at e-beyond.de  Wed Mar 14 04:55:25 2007
From: mlists at e-beyond.de (me)
Date: Wed Mar 14 04:57:09 2007
Subject: [mod_python] reloading issue
In-Reply-To: <88e286470703140237u147b8820w67fb00aad3b3161c@mail.gmail.com>
References: <200703131320.00612.mlists@e-beyond.de>
	<200703140738.45450.mlists@e-beyond.de>
	<88e286470703140237u147b8820w67fb00aad3b3161c@mail.gmail.com>
Message-ID: <200703141055.28905.mlists@e-beyond.de>

Hello Graham,

Am Mittwoch 14 M?rz 2007 10:37:00 schrieb Graham Dumpleton:
>
> Correct on the underscore, although a .htaccess file is still a good
> idea because if someone stuffs up the main Apache configuration they
> could inadvertently expose your source code still since the only thing
> stopping it from being visible is mod_python.publisher at the moment.

That with .htaccess might not be needed. mod_security is filtering every 
request to *.py and other extensions. But you're right it's a "plus" on 
security to disallow access using .htaccess.

> As far as import_module(), that also should work with that importer
> path, although using a non obvious aspect of import_module() which I
> am not sure is actually documented as a feature and you probably
> should not rely upon. That is that using relative path of './' will
> resolve relative to directory the call is done from, but in your case
> you have stumbled upon fact that implementation actually also tries to
> find a module by appending a './' prefixed path to any of the
> directories in the importer path. Thus why it finds './Contents' even
> though it isn't in the directory the call is being made from but
> elsewhere. You would be better off reserving './' for when you really
> mean relative to the same directory. Instead use just:
>
>   module = apache.import_module('Contents/' + className)
>
> This will have the same affect and that it isn't a relative path
> implies better that a search is being done.
>
> Other options is to be explicit:
>
>   module = apache.import _module('~/_modules/Contents/' + className +
> '.py')

Okay, it looks also good with the ./ but I follow your hints and change that 
to the 'Contents/' + className version. I think that might be the best way 
because I've declaratively configured the path in the apache configuration, 
when changing that I don't have to change the sources.

> Also, please keep followups on the mailing list.

Sorry I haven't seen that I'm only replying to you (and not to the list)...

Marc
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070314/450340e5/attachment.bin
From kenneth at loafman.com  Wed Mar 14 17:10:22 2007
From: kenneth at loafman.com (Kenneth Loafman)
Date: Wed Mar 14 17:10:36 2007
Subject: [mod_python] Session Freezing using mod_python.Session
Message-ID: <45F872CE.5050403@loafman.com>

Hi,

The small snippet of code below freezes if there is an existing pysid 
cookie (sample straight out of the manual).  If there is no pysid 
cookie, then index() displays, but show() hangs.

Platform is Ubuntu Edgy 64-bit, Apache, mod_python, python 2.4.

Any suggestions would be appreciated.

...Thanks,
...Ken

def index(req):
    session = Session.Session(req)
    if session.is_new():
       session['hits'] = 1
    else:
       session['hits'] += 1
    session.save()
    return """\
%s
<fieldset>
<legend>
Please select the database:
</legend>
<form method="post" action="/demo/index/show">
<...snip...>
%s
""" % (_head, _tail)

def show(req):
    session = Session.Session(req)
    <...snip...>
From graham.dumpleton at gmail.com  Wed Mar 14 17:24:43 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Mar 14 17:24:45 2007
Subject: [mod_python] Session Freezing using mod_python.Session
In-Reply-To: <45F872CE.5050403@loafman.com>
References: <45F872CE.5050403@loafman.com>
Message-ID: <88e286470703141524i5cd21295v1b87813048afa480@mail.gmail.com>

On 15/03/07, Kenneth Loafman <kenneth@loafman.com> wrote:
> Hi,
>
> The small snippet of code below freezes if there is an existing pysid
> cookie (sample straight out of the manual).  If there is no pysid
> cookie, then index() displays, but show() hangs.

Yet you don't show us the code in show() which is the important bit.

Does show() call any other functions in which you are trying to create
a Session object a  subsequent time. If you are it will hang as you
can create only one Session object instance per request. In other
words, if show() was for example written as:

  def show(req):
      session = Session.Session(req)
      return index(req)

you would have this problem with it hanging as show already has a lock
on the session

Normal practice is to always use:

     if not hasattr(req,'session'):
       req.session = Session.Session(req)

     if req.session.is_new():
       ...

Thus, always check to see if req.session has been already set by
something else and only create a new Session object if it hasn't,
assigning it to req.session and always using it from there as well.

If this doesn't help, post the code for show() and what it may call.

Graham

> Platform is Ubuntu Edgy 64-bit, Apache, mod_python, python 2.4.
>
> Any suggestions would be appreciated.
>
> ...Thanks,
> ...Ken
>
> def index(req):
>     session = Session.Session(req)
>     if session.is_new():
>        session['hits'] = 1
>     else:
>        session['hits'] += 1
>     session.save()
>     return """\
> %s
> <fieldset>
> <legend>
> Please select the database:
> </legend>
> <form method="post" action="/demo/index/show">
> <...snip...>
> %s
> """ % (_head, _tail)
>
> def show(req):
>     session = Session.Session(req)
>     <...snip...>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From kenneth at loafman.com  Wed Mar 14 17:56:47 2007
From: kenneth at loafman.com (Kenneth Loafman)
Date: Wed Mar 14 17:56:57 2007
Subject: [mod_python] Session Freezing using mod_python.Session
In-Reply-To: <88e286470703141524i5cd21295v1b87813048afa480@mail.gmail.com>
References: <45F872CE.5050403@loafman.com>
	<88e286470703141524i5cd21295v1b87813048afa480@mail.gmail.com>
Message-ID: <45F87DAF.4060700@loafman.com>

Graham Dumpleton wrote:
> On 15/03/07, Kenneth Loafman <kenneth@loafman.com> wrote:
>> Hi,
>>
>> The small snippet of code below freezes if there is an existing pysid
>> cookie (sample straight out of the manual).  If there is no pysid
>> cookie, then index() displays, but show() hangs.
> 
> Yet you don't show us the code in show() which is the important bit.

It turns out that I did show the important bit, a blind request to get a 
new session.

> Normal practice is to always use:
> 
>     if not hasattr(req,'session'):
>       req.session = Session.Session(req)
> 
>     if req.session.is_new():
>       ...

This is exactly what I needed.  index() got the session, then called 
show() which tried to get a new session.  The docs seem to imply that 
Session(req) should look to see if a session exists, then use it. 
Obviously, that implication is not valid.

Thanks for all the help.  Its working now.

...Ken
From graham.dumpleton at gmail.com  Wed Mar 14 18:04:52 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Mar 14 18:04:55 2007
Subject: [mod_python] Session Freezing using mod_python.Session
In-Reply-To: <45F87DAF.4060700@loafman.com>
References: <45F872CE.5050403@loafman.com>
	<88e286470703141524i5cd21295v1b87813048afa480@mail.gmail.com>
	<45F87DAF.4060700@loafman.com>
Message-ID: <88e286470703141604s676e8adbr20ba02c74e77a8b6@mail.gmail.com>

On 15/03/07, Kenneth Loafman <kenneth@loafman.com> wrote:
> Graham Dumpleton wrote:
> > On 15/03/07, Kenneth Loafman <kenneth@loafman.com> wrote:
> >> Hi,
> >>
> >> The small snippet of code below freezes if there is an existing pysid
> >> cookie (sample straight out of the manual).  If there is no pysid
> >> cookie, then index() displays, but show() hangs.
> >
> > Yet you don't show us the code in show() which is the important bit.
>
> It turns out that I did show the important bit, a blind request to get a
> new session.
>
> > Normal practice is to always use:
> >
> >     if not hasattr(req,'session'):
> >       req.session = Session.Session(req)
> >
> >     if req.session.is_new():
> >       ...
>
> This is exactly what I needed.  index() got the session, then called
> show() which tried to get a new session.  The docs seem to imply that
> Session(req) should look to see if a session exists, then use it.
> Obviously, that implication is not valid.

Hmmm, the code example you posted does not show index() calling
show(). That the form had it as the target of the action doesn't
result in index() calling show() within the code.

What the docs is referring to is that the Session object will look in
the session database to see if an existing persistent session entry is
there from a previous request, not that it will look to see if a prior
Session object instance has been created for the current request.

Graham
From jamiegrove at gmail.com  Thu Mar 15 16:25:02 2007
From: jamiegrove at gmail.com (Jamie Grove)
Date: Thu Mar 15 16:25:09 2007
Subject: [mod_python] Session Freezing using mod_python.Session
Message-ID: <c71674d20703151425x6c32f098r32792d0a4276252d@mail.gmail.com>

Hi, Graham.

I think Kenneth is referring to section 4.8.1:

"If session type option is not found, the function queries the MPM and
  based on that returns either a new instance of DbmSession or
MemorySession. MemorySession will be used if the MPM is   threaded and
not forked (such is the case on Windows), or if it threaded,   forked,
but only one process is allowed (the worker MPM can be configured   to
run this way). In all other cases DbmSession is used."

- Jamie
From chrispwd at gmail.com  Fri Mar 16 09:25:13 2007
From: chrispwd at gmail.com (Chris Rilly)
Date: Fri Mar 16 09:25:23 2007
Subject: [mod_python] Trapping output from importer.ReportError
Message-ID: <5d74cfb70703160725k226b69f6h79bacf609e60b0e6@mail.gmail.com>

Hello,

I have a custom logging class in our application that we use (writes to
file, not to apache logs).

What I would like to do is when an internal server error happens, log the
traceback to the file via our logger and not the apache error log. I noticed
in the importer module there is a method called "ReportError".  The exact
output thats being emitted from that method is what I would like to capture.

I'm somewhat new to mod_python, but is there a way to override or get the
traceback from that method? My application is making use of the publisher
handler.

Off to the side a bit, after the traceback is logged, I would want to
redirect the user to a specific page instead of the default "Internal server
error" page.

Thank you!!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070316/5065a286/attachment.html
From graham.dumpleton at gmail.com  Fri Mar 16 19:34:40 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Fri Mar 16 19:34:46 2007
Subject: [mod_python] Trapping output from importer.ReportError
In-Reply-To: <5d74cfb70703160725k226b69f6h79bacf609e60b0e6@mail.gmail.com>
References: <5d74cfb70703160725k226b69f6h79bacf609e60b0e6@mail.gmail.com>
Message-ID: <88e286470703161734j54cb0941n6d9c0c5711548080@mail.gmail.com>

On 17/03/07, Chris Rilly <chrispwd@gmail.com> wrote:
> Hello,
>
> I have a custom logging class in our application that we use (writes to
> file, not to apache logs).
>
> What I would like to do is when an internal server error happens, log the
> traceback to the file via our logger and not the apache error log. I noticed
> in the importer module there is a method called "ReportError".  The exact
> output thats being emitted from that method is what I would like to capture.
>
> I'm somewhat new to mod_python, but is there a way to override or get the
> traceback from that method?

No.

> My application is making use of the publisher
> handler.
>
> Off to the side a bit, after the traceback is logged, I would want to
> redirect the user to a specific page instead of the default "Internal server
> error" page.

The Apache way of doing things, which mod_python doesn't follow and
probably should be changed to conform to, is that the text of the
message it would display in the error page should also be stored in
req.notes['error-notes']. Having done that, all you need to do is
define:

  ErrorDocument 500 /some/path/to/my/error/handler

The associated error handler would then be able to extract out
REDIRECT_ERROR_NOTES from the subprocess environment and use that in a
custom page.

If you have multilingual error documents enabled in Apache 2.X, they
already will display these error notes, but if you want a certain
format, you can just define your own error document handler as I
explained.

Anyway, to use this mechanism that Apache already supports is probably
the preferred way but mod_python has to be changed to use it.

Graham
From nmilkovits at gmail.com  Mon Mar 19 12:24:33 2007
From: nmilkovits at gmail.com (Nicholas Milkovits)
Date: Mon Mar 19 12:24:46 2007
Subject: [mod_python] Object cleanup with child process scaling
Message-ID: <71a75690703191024o7faa4fe8yfb0b77c04f0dba07@mail.gmail.com>

Hello all,

I have a quick question about how apache2 and mod python work. When
apache (running in prefork mode) decides to scale back the number of
running child processes running because of a low request volume, does
mod python ensure that all objects have their __del__ methods called
or does apache just kill it and release the memory back to the system?
I am running across a problem where my oracle db has to many sessions
open (although they are marked as idle/invalid) and it appears to be
because the client application is never explicity telling oracle to
close the sessions before exiting. Is there any way to ensure a chunk
of code gets run before apache kills the process?

Thanks,
Nick M.
From graham.dumpleton at gmail.com  Mon Mar 19 15:57:02 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Mar 19 15:57:05 2007
Subject: [mod_python] Object cleanup with child process scaling
In-Reply-To: <71a75690703191024o7faa4fe8yfb0b77c04f0dba07@mail.gmail.com>
References: <71a75690703191024o7faa4fe8yfb0b77c04f0dba07@mail.gmail.com>
Message-ID: <88e286470703191357n4f49e44am479406632e0a2077@mail.gmail.com>

On 20/03/07, Nicholas Milkovits <nmilkovits@gmail.com> wrote:
> Hello all,
>
> I have a quick question about how apache2 and mod python work. When
> apache (running in prefork mode) decides to scale back the number of
> running child processes running because of a low request volume, does
> mod python ensure that all objects have their __del__ methods called

No it doesn't currently ensure that __del__ methods are called.

> or does apache just kill it and release the memory back to the system?

Yes and no. See below.

> I am running across a problem where my oracle db has to many sessions
> open (although they are marked as idle/invalid) and it appears to be
> because the client application is never explicity telling oracle to
> close the sessions before exiting. Is there any way to ensure a chunk
> of code gets run before apache kills the process?

When an Apache child process is killed the socket will be closed off.
The Oracle server side should detect this and recycle the connection
automatically. Because of this fact, I would suggest the problem might
lie elsewhere.

That said, look at the apache.register_cleanup() method.

  http://www.modpython.org/live/current/doc-html/pyapi-apmeth.html

This allows registration of callback to be called when Apache child
process is being shutdown. Note though that it is not guaranteed that
the callback will be called as various things could cause shutdown to
hang and parent Apache process will forcibly kill off child processes
if this occurs. Child process could also just die of their own accord
as well which would also mean that this would not be triggered.

Graham
From g.farina at pharaondev.com  Tue Mar 20 03:35:14 2007
From: g.farina at pharaondev.com (Gabriele Farina)
Date: Tue Mar 20 03:35:00 2007
Subject: [mod_python] Compiling mod_python
Message-ID: <5EB03EC6-9F5B-4DDA-8AC1-8778161CA0EC@pharaondev.com>

Hi,

today I'm trying to compile mod_python on a Debian Linux box.
I installed correctly apache 2.2.4 and Python 2.5 from sources and  
then tried to compile mod_python. I get this error:

...
/config -Xlinker -export-dynamic -lm -lpython2.5 -lpthread -ldl - 
lutil -lm
/usr/bin/ld: /usr/local/lib/python2.5/config/libpython2.5.a 
(abstract.o): relocation R_X86_64_32 against `a local symbol' can not  
be used when making a shared object; recompile with -fPIC
/usr/local/lib/python2.5/config/libpython2.5.a: could not read  
symbols: Bad value
collect2: ld returned 1 exit status
apxs:Error: Command failed with rc=65536
.
make[1]: *** [mod_python.so] Error 1
make[1]: Leaving directory `/usr/local/src/mod_python-3.3.1/src'
make: *** [do_dso] Error 2

Anyone can help me understand where is the problem ?

Gabriele

From roberto at connexer.com  Tue Mar 20 03:44:39 2007
From: roberto at connexer.com (Roberto =?iso-8859-1?Q?C=2E_S=E1nchez?=)
Date: Tue Mar 20 03:44:47 2007
Subject: [mod_python] Compiling mod_python
In-Reply-To: <5EB03EC6-9F5B-4DDA-8AC1-8778161CA0EC@pharaondev.com>
References: <5EB03EC6-9F5B-4DDA-8AC1-8778161CA0EC@pharaondev.com>
Message-ID: <20070320084439.GB8104@santiago.connexer.com>

On Tue, Mar 20, 2007 at 09:35:14AM +0100, Gabriele Farina wrote:
> Hi,
> 
> today I'm trying to compile mod_python on a Debian Linux box.
> I installed correctly apache 2.2.4 and Python 2.5 from sources and  
> then tried to compile mod_python. I get this error:
> 
Umm, why on Earth would you install Apache *and* Python from sources on
Debian?  Just use aptitude.  Besides, mod_python is also packaged for
Debian.

Regards,

-Roberto

-- 
Roberto C. S?nchez
http://people.connexer.com/~roberto
http://www.connexer.com
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070320/c5973d52/attachment.bin
From graham.dumpleton at gmail.com  Tue Mar 20 05:27:45 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Mar 20 05:27:50 2007
Subject: [mod_python] Compiling mod_python
In-Reply-To: <20070320084439.GB8104@santiago.connexer.com>
References: <5EB03EC6-9F5B-4DDA-8AC1-8778161CA0EC@pharaondev.com>
	<20070320084439.GB8104@santiago.connexer.com>
Message-ID: <88e286470703200327n31c2eba6t46f320effad6b790@mail.gmail.com>

On 20/03/07, Roberto C. S?nchez <roberto@connexer.com> wrote:
> On Tue, Mar 20, 2007 at 09:35:14AM +0100, Gabriele Farina wrote:
> > Hi,
> >
> > today I'm trying to compile mod_python on a Debian Linux box.
> > I installed correctly apache 2.2.4 and Python 2.5 from sources and
> > then tried to compile mod_python. I get this error:
> >
> Umm, why on Earth would you install Apache *and* Python from sources on
> Debian?  Just use aptitude.  Besides, mod_python is also packaged for
> Debian.

One reason for recompiling Python is because the prepackaged binary
distributions of Python are generally never built with the
--enabled-shared option. This means you only have a static libpython.a
file and on 64 bit platforms when recompiling mod_python like above
this presents problems sometimes as Python packages are only built as
32 bit binaries. Also, that there is only a static libpython.a and not
a libpython.so means that the static Python library has to be embedded
within the mod_python.so file to work. This means that instead of your
mod_python.so being in the order of a few hundred KBytes it is over
1MB in size. Because the Python library part of this is not
relocatable object files, when it gets loaded into memory it
potentially has to have address relocations done on it resulting in
the mod_python.so no longer being shared between processes and instead
each of your Apache child processes ends up with up to 1.5MB of extra
private memory in use. In the end your Python web application is going
to probably take a lot more memory than that but it doesn't make the
situation any better.

Thus, to the OP, rebuild your Python installation from source first
and ensure that --enable-shared is used when configure is run. After
you have that reinstalled, then try rebuilding mod_python and see if
the error goes away. To save trashing the existing Python installation
you might install new version of Python elsewhere. Be warned that you
may have to ensure location of  'python' executable for new version is
in PATH before standard one for user that Apache runs as. See how it
goes without doing that first though. Not sure if rebuilding Apache is
actually necessary.

Graham

From kenneth at loafman.com  Tue Mar 20 08:32:58 2007
From: kenneth at loafman.com (Kenneth Loafman)
Date: Tue Mar 20 08:33:42 2007
Subject: [mod_python] Detecting Back Button Usage
Message-ID: <45FFE28A.7010104@loafman.com>

Hi,

This may not be the list I need, but here goes.  I'm new at this whole 
user interface thing, by nature a low-level systems guy, so be kind.

I'm using mod_python under Ubuntu Edgy 64, doing some basic plots of 
data and allowing users to select a point to center on a region and gen 
the next plot.  All of that works as long as the user moves forward. 
The problem comes in the use of the back button.  The browser merely 
displays the last page rather than rebuilding it, or at least restoring 
the variables.  This leads to a lot of confusion because the server is 
on one set of plot values and the browser is now on another.  This seems 
to be a common problem.  Is there a solution, or should I just warn the 
user not to use the browser back button?

...Thanks,
...Ken
From clodoaldo.pinto.neto at gmail.com  Tue Mar 20 09:03:05 2007
From: clodoaldo.pinto.neto at gmail.com (Clodoaldo)
Date: Tue Mar 20 09:03:09 2007
Subject: [mod_python] Detecting Back Button Usage
In-Reply-To: <45FFE28A.7010104@loafman.com>
References: <45FFE28A.7010104@loafman.com>
Message-ID: <a595de7a0703200703m1e43c581y78990bd71d511166@mail.gmail.com>

2007/3/20, Kenneth Loafman <kenneth@loafman.com>:
> I'm using mod_python under Ubuntu Edgy 64, doing some basic plots of
> data and allowing users to select a point to center on a region and gen
> the next plot.  All of that works as long as the user moves forward.
> The problem comes in the use of the back button.  The browser merely
> displays the last page rather than rebuilding it, or at least restoring
> the variables.  This leads to a lot of confusion because the server is
> on one set of plot values and the browser is now on another.  This seems
> to be a common problem.  Is there a solution, or should I just warn the
> user not to use the browser back button?

How does the user select the point? Entering it in a form field? If so
save the plot values (the page state) on the page using a hidden field
inside the form:
<input type="hidden" name="variable_1" value="99.9">
<input type="hidden" name="variable_2" value="33.3">

When the form is submitted those values will be available to your script.

If you are using some Ajax scripting to let the user select the point
then adapt it to also send the current page state.

I could not find the correct words to google. It would be something
like "page state maintenance in HTML (or HTTP)". Can someone create
the correct search words?

Regards,
-- 
Clodoaldo Pinto Neto
From list at joreybump.com  Tue Mar 20 09:03:30 2007
From: list at joreybump.com (Jorey Bump)
Date: Tue Mar 20 09:03:35 2007
Subject: [mod_python] Detecting Back Button Usage
In-Reply-To: <45FFE28A.7010104@loafman.com>
References: <45FFE28A.7010104@loafman.com>
Message-ID: <45FFE9B2.7040300@joreybump.com>

Kenneth Loafman wrote:
> Hi,
> 
> This may not be the list I need, but here goes.  I'm new at this whole 
> user interface thing, by nature a low-level systems guy, so be kind.
> 
> I'm using mod_python under Ubuntu Edgy 64, doing some basic plots of 
> data and allowing users to select a point to center on a region and gen 
> the next plot.  All of that works as long as the user moves forward. The 
> problem comes in the use of the back button.  The browser merely 
> displays the last page rather than rebuilding it, or at least restoring 
> the variables.  This leads to a lot of confusion because the server is 
> on one set of plot values and the browser is now on another.  This seems 
> to be a common problem.  Is there a solution, or should I just warn the 
> user not to use the browser back button?

By default, your application has no way of knowing how the client 
requested the URL (other than the unreliable HTTP_REFERER environment 
variable), so it will need to know how to handle all requests, no matter 
what. You can maintain/simulate some sort of state in a variety of 
(somewhat limited) ways on the server side, and everyone has their own 
favorite approach. In any case, you need to expect the unexpected in the 
application itself.

After securing your application, you can add client-side scripting for 
potentially finer control over the requests sent by the client under 
certain circumstances. Typically, you'll use JavaScript, but there are 
other options, depending on your needs. Be aware that while you can 
require that your users depend on this to get use from your application, 
you can't force an arbitrary client to follow such rules, so you do need 
to be prepared when a visitor arrives without JavaScript enabled (for 
example).

Since you're correct that this isn't a mod_python issue, you're most 
likely to get more useful answers in a JavaScript or DHTML forum. There 
are also a number of JavaScript frameworks springing up, due to the AJAX 
craze, and some of these might have useful libraries, so you don't have 
to reinvent the wheel.

From list at joreybump.com  Tue Mar 20 09:30:19 2007
From: list at joreybump.com (Jorey Bump)
Date: Tue Mar 20 09:30:40 2007
Subject: [mod_python] Detecting Back Button Usage
In-Reply-To: <a595de7a0703200703m1e43c581y78990bd71d511166@mail.gmail.com>
References: <45FFE28A.7010104@loafman.com>
	<a595de7a0703200703m1e43c581y78990bd71d511166@mail.gmail.com>
Message-ID: <45FFEFFB.5030208@joreybump.com>

Clodoaldo wrote:
> 2007/3/20, Kenneth Loafman <kenneth@loafman.com>:
>> The problem comes in the use of the back button.  The browser merely
>> displays the last page rather than rebuilding it, or at least restoring
>> the variables.  
> 
> How does the user select the point? Entering it in a form field? If so
> save the plot values (the page state) on the page using a hidden field
> inside the form:
> <input type="hidden" name="variable_1" value="99.9">
> <input type="hidden" name="variable_2" value="33.3">
> 
> When the form is submitted those values will be available to your script.

These days, all bets are off concerning the default behaviour of the 
back button on the variety of browsers one will encounter. There's no 
way to enforce sending form variables without client side scripting...

> If you are using some Ajax scripting to let the user select the point
> then adapt it to also send the current page state.

...as you suggest here. Even so, exhaustive testing is recommended 
before you assume it works for all browsers, as well as preparing for 
browsers with DHTML features disabled or crippled. The most foolproof 
design will maintain state on the server, perhaps using a database. It's 
  a lot of work up front, but has a number of payoffs, as long as the 
application warrants it. Of course, since the OP seems to be describing 
a graphical application, he may get a lot of mileage out of AJAX or 
something like it.
From scarfboy at gmail.com  Tue Mar 20 11:11:19 2007
From: scarfboy at gmail.com (Bart)
Date: Tue Mar 20 11:11:22 2007
Subject: [mod_python] Detecting Back Button Usage
In-Reply-To: <a595de7a0703200703m1e43c581y78990bd71d511166@mail.gmail.com>
References: <45FFE28A.7010104@loafman.com>
	<a595de7a0703200703m1e43c581y78990bd71d511166@mail.gmail.com>
Message-ID: <b71082d80703200911v31bf3074q7dbb2b5fb079b841@mail.gmail.com>

Indeed. To solve this, you need to remember past states
one way or another.


In one administration interface I've seen, state is remembered
server-side for... I forget whether it was a number of actions or
some time.

It involved an identifier for each served page, which means you
can actually *know* when a user submits something from a page
displaying old state, and decide to either
* set the new state as the displayed state+the change requested
* set the new state as the current state + the change requested
  (often unpredictable)
* complain "hey, you tried to alter from an old state!"
* complain "hey, you tried to alter from an old state!", view the
  current, and ask whether you still want to apply the changes,
  to *that*. This is the user-friendliest if the last option may throw
  away ten minutes of user work.


The idea of using AJAX to essentially imitate MVC is probably a
workable one too, (though I still haven't checked whether there is
a simple way of checking use of the back button through
(ajax-less) client side scripting)
If you do this, be sure to also give sane fallback behaviour to
people with scripting disabled.

--Bart




On 3/20/07, Clodoaldo <clodoaldo.pinto.neto@gmail.com> wrote:
> 2007/3/20, Kenneth Loafman <kenneth@loafman.com>:
> > I'm using mod_python under Ubuntu Edgy 64, doing some basic plots of
> > data and allowing users to select a point to center on a region and gen
> > the next plot.  All of that works as long as the user moves forward.
> > The problem comes in the use of the back button.  The browser merely
> > displays the last page rather than rebuilding it, or at least restoring
> > the variables.  This leads to a lot of confusion because the server is
> > on one set of plot values and the browser is now on another.  This seems
> > to be a common problem.  Is there a solution, or should I just warn the
> > user not to use the browser back button?
>
> How does the user select the point? Entering it in a form field? If so
> save the plot values (the page state) on the page using a hidden field
> inside the form:
> <input type="hidden" name="variable_1" value="99.9">
> <input type="hidden" name="variable_2" value="33.3">
>
> When the form is submitted those values will be available to your script.
>
> If you are using some Ajax scripting to let the user select the point
> then adapt it to also send the current page state.
>
> I could not find the correct words to google. It would be something
> like "page state maintenance in HTML (or HTTP)". Can someone create
> the correct search words?
>
> Regards,
> --
> Clodoaldo Pinto Neto
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From roberto at connexer.com  Tue Mar 20 11:19:24 2007
From: roberto at connexer.com (Roberto =?iso-8859-1?Q?C=2E_S=E1nchez?=)
Date: Tue Mar 20 11:19:29 2007
Subject: [mod_python] Compiling mod_python
In-Reply-To: <88e286470703200327n31c2eba6t46f320effad6b790@mail.gmail.com>
References: <5EB03EC6-9F5B-4DDA-8AC1-8778161CA0EC@pharaondev.com>
	<20070320084439.GB8104@santiago.connexer.com>
	<88e286470703200327n31c2eba6t46f320effad6b790@mail.gmail.com>
Message-ID: <20070320161924.GA17686@santiago.connexer.com>

On Tue, Mar 20, 2007 at 09:27:45PM +1100, Graham Dumpleton wrote:
> 
> One reason for recompiling Python is because the prepackaged binary
> distributions of Python are generally never built with the
> --enabled-shared option. This means you only have a static libpython.a

This is not the case on Debian.  From a stock Sarge install:

ldd /usr/lib/apache2/modules/mod_python.so
	libpython2.3.so.1.0 => /usr/lib/libpython2.3.so.1.0 (0x4001b000)
	libpthread.so.0 => /lib/libpthread.so.0 (0x40124000)
	libdl.so.2 => /lib/libdl.so.2 (0x40175000)
	libutil.so.1 => /lib/libutil.so.1 (0x40179000)
	libm.so.6 => /lib/libm.so.6 (0x4017c000)
	libc.so.6 => /lib/libc.so.6 (0x4019e000)
	/lib/ld-linux.so.2 => /lib/ld-linux.so.2 (0x80000000)


> file and on 64 bit platforms when recompiling mod_python like above
> this presents problems sometimes as Python packages are only built as
> 32 bit binaries. Also, that there is only a static libpython.a and not
> a libpython.so means that the static Python library has to be embedded
> within the mod_python.so file to work. This means that instead of your
> mod_python.so being in the order of a few hundred KBytes it is over
> 1MB in size. Because the Python library part of this is not
> relocatable object files, when it gets loaded into memory it
> potentially has to have address relocations done on it resulting in
> the mod_python.so no longer being shared between processes and instead
> each of your Apache child processes ends up with up to 1.5MB of extra
> private memory in use. In the end your Python web application is going
> to probably take a lot more memory than that but it doesn't make the
> situation any better.
> 
> Thus, to the OP, rebuild your Python installation from source first
> and ensure that --enable-shared is used when configure is run. After
> you have that reinstalled, then try rebuilding mod_python and see if
> the error goes away. To save trashing the existing Python installation
> you might install new version of Python elsewhere. Be warned that you
> may have to ensure location of  'python' executable for new version is
> in PATH before standard one for user that Apache runs as. See how it
> goes without doing that first though. Not sure if rebuilding Apache is
> actually necessary.
> 
Again, this is not necessary on Debian.

Regards,

-Roberto

-- 
Roberto C. S?nchez
http://people.connexer.com/~roberto
http://www.connexer.com
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070320/e083e3e3/attachment.bin
From Jake.E.Posey at boeing.com  Tue Mar 20 11:53:37 2007
From: Jake.E.Posey at boeing.com (Posey, Jake E)
Date: Tue Mar 20 11:55:14 2007
Subject: [mod_python] RE: Mod_python Digest, Vol 48, Issue 23
In-Reply-To: <200703201431.l2KEV9Zq032754@modpython.org>
References: <200703201431.l2KEV9Zq032754@modpython.org>
Message-ID: <7B73172B331C034198AA90BDF604F5FB02861508@XCH-NW-5V1.nw.nos.boeing.com>

I have the same problem with compiling mod_python on 64bit Red Hat with apache 2.2.4 and even after recompiling python 2.5 with --enable-shared everything configures, compiles, and install without any errors but when I run python -V I get the following error:

[root@lcas204 ~]# /usr/local/bin/python -V
/usr/local/bin/python: error while loading shared libraries: libpython2.5.so.1.0: cannot open shared object file: No such file or directory
[root@lcas204 ~]#

However the file does exist and it is in my path.

[root@lcas204 lib]# pwd
/usr/local/lib
[root@lcas204 lib]# ls -ld *python*
lrwxrwxrwx   1 root root      19 Mar 20 09:02 libpython2.5.so -> libpython2.5.so.1.0
-r-xr-xr-x   1 root root 5001973 Mar 20 09:02 libpython2.5.so.1.0
lrwxrwxrwx   1 root root      19 Mar 20 09:14 libpython.so -> libpython2.5.so.1.0
drwxr-xr-x  21 root root   20480 Mar 20 09:02 python2.5
[root@lcas204 lib]#

[root@lcas204 ~]# echo $PATH
/usr/kerberos/sbin:/usr/kerberos/bin:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/usr/X11R6/bin:/root/bin:/usr/local:/usr/local/lib:/usr/local/lib/python2.5
[root@lcas204 ~]#

But if I just run ./configure with no options it configure, compiles, and installs with no errors and I'm able to run python -V to check the version and make sure it is working but when I go to compile mod_python I'm back to the original problem.

Any other ideas?

Thanks in advance,

Jake

-----Original Message-----
From: mod_python-request@modpython.org [mailto:mod_python-request@modpython.org] 
Sent: Tuesday, March 20, 2007 7:31 AM
To: mod_python@modpython.org
Subject: Mod_python Digest, Vol 48, Issue 23

Send Mod_python mailing list submissions to
	mod_python@modpython.org

To subscribe or unsubscribe via the World Wide Web, visit
	http://mailman.modpython.org/mailman/listinfo/mod_python
or, via email, send a message with subject or body 'help' to
	mod_python-request@modpython.org

You can reach the person managing the list at
	mod_python-owner@modpython.org

When replying, please edit your Subject line so it is more specific
than "Re: Contents of Mod_python digest..."


Today's Topics:

   1. Object cleanup with child process scaling (Nicholas Milkovits)
   2. Re: Object cleanup with child process scaling (Graham Dumpleton)
   3. Compiling mod_python (Gabriele Farina)
   4. Re: Compiling mod_python (Roberto C. S?nchez)
   5. Re: Compiling mod_python (Graham Dumpleton)
   6. Detecting Back Button Usage (Kenneth Loafman)
   7. Re: Detecting Back Button Usage (Clodoaldo)
   8. Re: Detecting Back Button Usage (Jorey Bump)
   9. Re: Detecting Back Button Usage (Jorey Bump)


----------------------------------------------------------------------

Message: 1
Date: Mon, 19 Mar 2007 13:24:33 -0400
From: "Nicholas Milkovits" <nmilkovits@gmail.com>
Subject: [mod_python] Object cleanup with child process scaling
To: mod_python@modpython.org
Message-ID:
	<71a75690703191024o7faa4fe8yfb0b77c04f0dba07@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed

Hello all,

I have a quick question about how apache2 and mod python work. When
apache (running in prefork mode) decides to scale back the number of
running child processes running because of a low request volume, does
mod python ensure that all objects have their __del__ methods called
or does apache just kill it and release the memory back to the system?
I am running across a problem where my oracle db has to many sessions
open (although they are marked as idle/invalid) and it appears to be
because the client application is never explicity telling oracle to
close the sessions before exiting. Is there any way to ensure a chunk
of code gets run before apache kills the process?

Thanks,
Nick M.


------------------------------

Message: 2
Date: Tue, 20 Mar 2007 07:57:02 +1100
From: "Graham Dumpleton" <graham.dumpleton@gmail.com>
Subject: Re: [mod_python] Object cleanup with child process scaling
To: "Nicholas Milkovits" <nmilkovits@gmail.com>
Cc: mod_python@modpython.org
Message-ID:
	<88e286470703191357n4f49e44am479406632e0a2077@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed

On 20/03/07, Nicholas Milkovits <nmilkovits@gmail.com> wrote:
> Hello all,
>
> I have a quick question about how apache2 and mod python work. When
> apache (running in prefork mode) decides to scale back the number of
> running child processes running because of a low request volume, does
> mod python ensure that all objects have their __del__ methods called

No it doesn't currently ensure that __del__ methods are called.

> or does apache just kill it and release the memory back to the system?

Yes and no. See below.

> I am running across a problem where my oracle db has to many sessions
> open (although they are marked as idle/invalid) and it appears to be
> because the client application is never explicity telling oracle to
> close the sessions before exiting. Is there any way to ensure a chunk
> of code gets run before apache kills the process?

When an Apache child process is killed the socket will be closed off.
The Oracle server side should detect this and recycle the connection
automatically. Because of this fact, I would suggest the problem might
lie elsewhere.

That said, look at the apache.register_cleanup() method.

  http://www.modpython.org/live/current/doc-html/pyapi-apmeth.html

This allows registration of callback to be called when Apache child
process is being shutdown. Note though that it is not guaranteed that
the callback will be called as various things could cause shutdown to
hang and parent Apache process will forcibly kill off child processes
if this occurs. Child process could also just die of their own accord
as well which would also mean that this would not be triggered.

Graham


------------------------------

Message: 3
Date: Tue, 20 Mar 2007 09:35:14 +0100
From: Gabriele Farina <g.farina@pharaondev.com>
Subject: [mod_python] Compiling mod_python
To: mod_python@modpython.org
Message-ID: <5EB03EC6-9F5B-4DDA-8AC1-8778161CA0EC@pharaondev.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed

Hi,

today I'm trying to compile mod_python on a Debian Linux box.
I installed correctly apache 2.2.4 and Python 2.5 from sources and  
then tried to compile mod_python. I get this error:

...
/config -Xlinker -export-dynamic -lm -lpython2.5 -lpthread -ldl - 
lutil -lm
/usr/bin/ld: /usr/local/lib/python2.5/config/libpython2.5.a 
(abstract.o): relocation R_X86_64_32 against `a local symbol' can not  
be used when making a shared object; recompile with -fPIC
/usr/local/lib/python2.5/config/libpython2.5.a: could not read  
symbols: Bad value
collect2: ld returned 1 exit status
apxs:Error: Command failed with rc=65536
.
make[1]: *** [mod_python.so] Error 1
make[1]: Leaving directory `/usr/local/src/mod_python-3.3.1/src'
make: *** [do_dso] Error 2

Anyone can help me understand where is the problem ?

Gabriele



------------------------------

Message: 4
Date: Tue, 20 Mar 2007 04:44:39 -0400
From: Roberto C. S?nchez <roberto@connexer.com>
Subject: Re: [mod_python] Compiling mod_python
To: Gabriele Farina <g.farina@pharaondev.com>
Cc: mod_python@modpython.org
Message-ID: <20070320084439.GB8104@santiago.connexer.com>
Content-Type: text/plain; charset="iso-8859-1"

On Tue, Mar 20, 2007 at 09:35:14AM +0100, Gabriele Farina wrote:
> Hi,
> 
> today I'm trying to compile mod_python on a Debian Linux box.
> I installed correctly apache 2.2.4 and Python 2.5 from sources and  
> then tried to compile mod_python. I get this error:
> 
Umm, why on Earth would you install Apache *and* Python from sources on
Debian?  Just use aptitude.  Besides, mod_python is also packaged for
Debian.

Regards,

-Roberto

-- 
Roberto C. S?nchez
http://people.connexer.com/~roberto
http://www.connexer.com
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070320/c5973d52/attachment-0001.bin

------------------------------

Message: 5
Date: Tue, 20 Mar 2007 21:27:45 +1100
From: "Graham Dumpleton" <graham.dumpleton@gmail.com>
Subject: Re: [mod_python] Compiling mod_python
To: " Roberto C. S?nchez " <roberto@connexer.com>,	"Gabriele Farina"
	<g.farina@pharaondev.com>, mod_python@modpython.org
Message-ID:
	<88e286470703200327n31c2eba6t46f320effad6b790@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed

On 20/03/07, Roberto C. S?nchez <roberto@connexer.com> wrote:
> On Tue, Mar 20, 2007 at 09:35:14AM +0100, Gabriele Farina wrote:
> > Hi,
> >
> > today I'm trying to compile mod_python on a Debian Linux box.
> > I installed correctly apache 2.2.4 and Python 2.5 from sources and
> > then tried to compile mod_python. I get this error:
> >
> Umm, why on Earth would you install Apache *and* Python from sources on
> Debian?  Just use aptitude.  Besides, mod_python is also packaged for
> Debian.

One reason for recompiling Python is because the prepackaged binary
distributions of Python are generally never built with the
--enabled-shared option. This means you only have a static libpython.a
file and on 64 bit platforms when recompiling mod_python like above
this presents problems sometimes as Python packages are only built as
32 bit binaries. Also, that there is only a static libpython.a and not
a libpython.so means that the static Python library has to be embedded
within the mod_python.so file to work. This means that instead of your
mod_python.so being in the order of a few hundred KBytes it is over
1MB in size. Because the Python library part of this is not
relocatable object files, when it gets loaded into memory it
potentially has to have address relocations done on it resulting in
the mod_python.so no longer being shared between processes and instead
each of your Apache child processes ends up with up to 1.5MB of extra
private memory in use. In the end your Python web application is going
to probably take a lot more memory than that but it doesn't make the
situation any better.

Thus, to the OP, rebuild your Python installation from source first
and ensure that --enable-shared is used when configure is run. After
you have that reinstalled, then try rebuilding mod_python and see if
the error goes away. To save trashing the existing Python installation
you might install new version of Python elsewhere. Be warned that you
may have to ensure location of  'python' executable for new version is
in PATH before standard one for user that Apache runs as. See how it
goes without doing that first though. Not sure if rebuilding Apache is
actually necessary.

Graham



------------------------------

Message: 6
Date: Tue, 20 Mar 2007 08:32:58 -0500
From: Kenneth Loafman <kenneth@loafman.com>
Subject: [mod_python] Detecting Back Button Usage
To: Mod_python@modpython.org
Message-ID: <45FFE28A.7010104@loafman.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed

Hi,

This may not be the list I need, but here goes.  I'm new at this whole 
user interface thing, by nature a low-level systems guy, so be kind.

I'm using mod_python under Ubuntu Edgy 64, doing some basic plots of 
data and allowing users to select a point to center on a region and gen 
the next plot.  All of that works as long as the user moves forward. 
The problem comes in the use of the back button.  The browser merely 
displays the last page rather than rebuilding it, or at least restoring 
the variables.  This leads to a lot of confusion because the server is 
on one set of plot values and the browser is now on another.  This seems 
to be a common problem.  Is there a solution, or should I just warn the 
user not to use the browser back button?

...Thanks,
...Ken


------------------------------

Message: 7
Date: Tue, 20 Mar 2007 11:03:05 -0300
From: Clodoaldo <clodoaldo.pinto.neto@gmail.com>
Subject: Re: [mod_python] Detecting Back Button Usage
To: "Kenneth Loafman" <kenneth@loafman.com>
Cc: Mod_python@modpython.org
Message-ID:
	<a595de7a0703200703m1e43c581y78990bd71d511166@mail.gmail.com>
Content-Type: text/plain; charset=UTF-8; format=flowed

2007/3/20, Kenneth Loafman <kenneth@loafman.com>:
> I'm using mod_python under Ubuntu Edgy 64, doing some basic plots of
> data and allowing users to select a point to center on a region and gen
> the next plot.  All of that works as long as the user moves forward.
> The problem comes in the use of the back button.  The browser merely
> displays the last page rather than rebuilding it, or at least restoring
> the variables.  This leads to a lot of confusion because the server is
> on one set of plot values and the browser is now on another.  This seems
> to be a common problem.  Is there a solution, or should I just warn the
> user not to use the browser back button?

How does the user select the point? Entering it in a form field? If so
save the plot values (the page state) on the page using a hidden field
inside the form:
<input type="hidden" name="variable_1" value="99.9">
<input type="hidden" name="variable_2" value="33.3">

When the form is submitted those values will be available to your script.

If you are using some Ajax scripting to let the user select the point
then adapt it to also send the current page state.

I could not find the correct words to google. It would be something
like "page state maintenance in HTML (or HTTP)". Can someone create
the correct search words?

Regards,
-- 
Clodoaldo Pinto Neto


------------------------------

Message: 8
Date: Tue, 20 Mar 2007 10:03:30 -0400
From: Jorey Bump <list@joreybump.com>
Subject: Re: [mod_python] Detecting Back Button Usage
To: Kenneth Loafman <kenneth@loafman.com>
Cc: Mod_python@modpython.org
Message-ID: <45FFE9B2.7040300@joreybump.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed

Kenneth Loafman wrote:
> Hi,
> 
> This may not be the list I need, but here goes.  I'm new at this whole 
> user interface thing, by nature a low-level systems guy, so be kind.
> 
> I'm using mod_python under Ubuntu Edgy 64, doing some basic plots of 
> data and allowing users to select a point to center on a region and gen 
> the next plot.  All of that works as long as the user moves forward. The 
> problem comes in the use of the back button.  The browser merely 
> displays the last page rather than rebuilding it, or at least restoring 
> the variables.  This leads to a lot of confusion because the server is 
> on one set of plot values and the browser is now on another.  This seems 
> to be a common problem.  Is there a solution, or should I just warn the 
> user not to use the browser back button?

By default, your application has no way of knowing how the client 
requested the URL (other than the unreliable HTTP_REFERER environment 
variable), so it will need to know how to handle all requests, no matter 
what. You can maintain/simulate some sort of state in a variety of 
(somewhat limited) ways on the server side, and everyone has their own 
favorite approach. In any case, you need to expect the unexpected in the 
application itself.

After securing your application, you can add client-side scripting for 
potentially finer control over the requests sent by the client under 
certain circumstances. Typically, you'll use JavaScript, but there are 
other options, depending on your needs. Be aware that while you can 
require that your users depend on this to get use from your application, 
you can't force an arbitrary client to follow such rules, so you do need 
to be prepared when a visitor arrives without JavaScript enabled (for 
example).

Since you're correct that this isn't a mod_python issue, you're most 
likely to get more useful answers in a JavaScript or DHTML forum. There 
are also a number of JavaScript frameworks springing up, due to the AJAX 
craze, and some of these might have useful libraries, so you don't have 
to reinvent the wheel.



------------------------------

Message: 9
Date: Tue, 20 Mar 2007 10:30:19 -0400
From: Jorey Bump <list@joreybump.com>
Subject: Re: [mod_python] Detecting Back Button Usage
To: Clodoaldo <clodoaldo.pinto.neto@gmail.com>
Cc: Mod_python@modpython.org
Message-ID: <45FFEFFB.5030208@joreybump.com>
Content-Type: text/plain; charset=UTF-8; format=flowed

Clodoaldo wrote:
> 2007/3/20, Kenneth Loafman <kenneth@loafman.com>:
>> The problem comes in the use of the back button.  The browser merely
>> displays the last page rather than rebuilding it, or at least restoring
>> the variables.  
> 
> How does the user select the point? Entering it in a form field? If so
> save the plot values (the page state) on the page using a hidden field
> inside the form:
> <input type="hidden" name="variable_1" value="99.9">
> <input type="hidden" name="variable_2" value="33.3">
> 
> When the form is submitted those values will be available to your script.

These days, all bets are off concerning the default behaviour of the 
back button on the variety of browsers one will encounter. There's no 
way to enforce sending form variables without client side scripting...

> If you are using some Ajax scripting to let the user select the point
> then adapt it to also send the current page state.

...as you suggest here. Even so, exhaustive testing is recommended 
before you assume it works for all browsers, as well as preparing for 
browsers with DHTML features disabled or crippled. The most foolproof 
design will maintain state on the server, perhaps using a database. It's 
  a lot of work up front, but has a number of payoffs, as long as the 
application warrants it. Of course, since the OP seems to be describing 
a graphical application, he may get a lot of mileage out of AJAX or 
something like it.


------------------------------

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python


End of Mod_python Digest, Vol 48, Issue 23
******************************************

From kenneth at loafman.com  Tue Mar 20 13:46:35 2007
From: kenneth at loafman.com (Kenneth Loafman)
Date: Tue Mar 20 13:47:00 2007
Subject: [mod_python] Detecting Back Button Usage
In-Reply-To: <a595de7a0703200703m1e43c581y78990bd71d511166@mail.gmail.com>
References: <45FFE28A.7010104@loafman.com>
	<a595de7a0703200703m1e43c581y78990bd71d511166@mail.gmail.com>
Message-ID: <46002C0B.8070508@loafman.com>

Clodoaldo wrote:
> 2007/3/20, Kenneth Loafman <kenneth@loafman.com>:
>> I'm using mod_python under Ubuntu Edgy 64, doing some basic plots of
>> data and allowing users to select a point to center on a region and gen
>> the next plot.  All of that works as long as the user moves forward.
>> The problem comes in the use of the back button.  The browser merely
>> displays the last page rather than rebuilding it, or at least restoring
>> the variables.  This leads to a lot of confusion because the server is
>> on one set of plot values and the browser is now on another.  This seems
>> to be a common problem.  Is there a solution, or should I just warn the
>> user not to use the browser back button?
> 
> How does the user select the point? Entering it in a form field? If so
> save the plot values (the page state) on the page using a hidden field
> inside the form:
> <input type="hidden" name="variable_1" value="99.9">
> <input type="hidden" name="variable_2" value="33.3">
> 
> When the form is submitted those values will be available to your script.

What I am doing is this:

def regen_plot(req):
    <plot logic snipped>
return """\
%s
<div align="center">
<a href="/demo/index/display_hit">
<img src="/demo/%s.gif" ismap border=0></a>
<p>X range is %d through %d seconds</p>
</div>
%s
""" % (_head, dbname, xrng[0], xrng[1], _tail(req))

Then when the user hits a point on the plot, display_hit is called.  I 
translate the x,y args from the URL into plot space, center the point 
around a smaller region, and plot again.  Going forward, it all works. 
Session() vars work, but since I'm not in a form, and there's no submit 
button, the hidden values don't work.  req.form.get('x') fails.

Is it possible to get <form> to use an <img ... ismap> tag in lieu of 
the submit button?

...Thanks,
...Ken

From clodoaldo.pinto.neto at gmail.com  Tue Mar 20 14:04:35 2007
From: clodoaldo.pinto.neto at gmail.com (Clodoaldo)
Date: Tue Mar 20 14:04:39 2007
Subject: [mod_python] Detecting Back Button Usage
In-Reply-To: <46002C0B.8070508@loafman.com>
References: <45FFE28A.7010104@loafman.com>
	<a595de7a0703200703m1e43c581y78990bd71d511166@mail.gmail.com>
	<46002C0B.8070508@loafman.com>
Message-ID: <a595de7a0703201204x1037d089q566f6abeaa85c477@mail.gmail.com>

2007/3/20, Kenneth Loafman <kenneth@loafman.com>:
> Clodoaldo wrote:
> > 2007/3/20, Kenneth Loafman <kenneth@loafman.com>:
> >> I'm using mod_python under Ubuntu Edgy 64, doing some basic plots of
> >> data and allowing users to select a point to center on a region and gen
> >> the next plot.  All of that works as long as the user moves forward.
> >> The problem comes in the use of the back button.  The browser merely
> >> displays the last page rather than rebuilding it, or at least restoring
> >> the variables.  This leads to a lot of confusion because the server is
> >> on one set of plot values and the browser is now on another.  This seems
> >> to be a common problem.  Is there a solution, or should I just warn the
> >> user not to use the browser back button?
> >
> > How does the user select the point? Entering it in a form field? If so
> > save the plot values (the page state) on the page using a hidden field
> > inside the form:
> > <input type="hidden" name="variable_1" value="99.9">
> > <input type="hidden" name="variable_2" value="33.3">
> >
> > When the form is submitted those values will be available to your script.
>
> What I am doing is this:
>
> def regen_plot(req):
>     <plot logic snipped>
> return """\
> %s
> <div align="center">
> <a href="/demo/index/display_hit">
> <img src="/demo/%s.gif" ismap border=0></a>
> <p>X range is %d through %d seconds</p>
> </div>
> %s
> """ % (_head, dbname, xrng[0], xrng[1], _tail(req))
>
> Then when the user hits a point on the plot, display_hit is called.  I
> translate the x,y args from the URL into plot space, center the point
> around a smaller region, and plot again.  Going forward, it all works.
> Session() vars work, but since I'm not in a form, and there's no submit
> button, the hidden values don't work.  req.form.get('x') fails.
>
> Is it possible to get <form> to use an <img ... ismap> tag in lieu of
> the submit button?

I don't know. What if you just set the the values in the URL? This way
the user could even bookmark each frame of his interest.:

> <a href="/demo/index/display_hit?var_1=99.9&var_2=33.3">

-- 
Clodoaldo Pinto Neto
From kenneth at loafman.com  Tue Mar 20 14:18:39 2007
From: kenneth at loafman.com (Kenneth Loafman)
Date: Tue Mar 20 14:19:09 2007
Subject: [mod_python] Detecting Back Button Usage
In-Reply-To: <a595de7a0703201204x1037d089q566f6abeaa85c477@mail.gmail.com>
References: <45FFE28A.7010104@loafman.com>	
	<a595de7a0703200703m1e43c581y78990bd71d511166@mail.gmail.com>	
	<46002C0B.8070508@loafman.com>
	<a595de7a0703201204x1037d089q566f6abeaa85c477@mail.gmail.com>
Message-ID: <4600338F.2000202@loafman.com>

Clodoaldo wrote:
> 2007/3/20, Kenneth Loafman <kenneth@loafman.com>:
>> Clodoaldo wrote:
>> > 2007/3/20, Kenneth Loafman <kenneth@loafman.com>:
>> >> I'm using mod_python under Ubuntu Edgy 64, doing some basic plots of
>> >> data and allowing users to select a point to center on a region and 
>> gen
>> >> the next plot.  All of that works as long as the user moves forward.
>> >> The problem comes in the use of the back button.  The browser merely
>> >> displays the last page rather than rebuilding it, or at least 
>> restoring
>> >> the variables.  This leads to a lot of confusion because the server is
>> >> on one set of plot values and the browser is now on another.  This 
>> seems
>> >> to be a common problem.  Is there a solution, or should I just warn 
>> the
>> >> user not to use the browser back button?
>> >
>> > How does the user select the point? Entering it in a form field? If so
>> > save the plot values (the page state) on the page using a hidden field
>> > inside the form:
>> > <input type="hidden" name="variable_1" value="99.9">
>> > <input type="hidden" name="variable_2" value="33.3">
>> >
>> > When the form is submitted those values will be available to your 
>> script.
>>
>> What I am doing is this:
>>
>> def regen_plot(req):
>>     <plot logic snipped>
>> return """\
>> %s
>> <div align="center">
>> <a href="/demo/index/display_hit">
>> <img src="/demo/%s.gif" ismap border=0></a>
>> <p>X range is %d through %d seconds</p>
>> </div>
>> %s
>> """ % (_head, dbname, xrng[0], xrng[1], _tail(req))
>>
>> Then when the user hits a point on the plot, display_hit is called.  I
>> translate the x,y args from the URL into plot space, center the point
>> around a smaller region, and plot again.  Going forward, it all works.
>> Session() vars work, but since I'm not in a form, and there's no submit
>> button, the hidden values don't work.  req.form.get('x') fails.
>>
>> Is it possible to get <form> to use an <img ... ismap> tag in lieu of
>> the submit button?
> 
> I don't know. What if you just set the the values in the URL? This way
> the user could even bookmark each frame of his interest.:
> 
>> <a href="/demo/index/display_hit?var_1=99.9&var_2=33.3">

I tried that and the values just go away.  The <img...ismap> tag appends 
the x,y values of the mouse to the url, so what you see in the status 
bar is:

/demo/index/display_hit?var_1=99.9&var_2=33.3?5,9

When the mouse is clicked, the first ?... goes away before being passed.

/demo/index/display_hit?5,9

...Thanks,
...Ken
From ccbean at gmail.com  Tue Mar 20 14:49:14 2007
From: ccbean at gmail.com (Colin Bean)
Date: Tue Mar 20 14:49:17 2007
Subject: [mod_python] Detecting Back Button Usage
In-Reply-To: <4600338F.2000202@loafman.com>
References: <45FFE28A.7010104@loafman.com>
	<a595de7a0703200703m1e43c581y78990bd71d511166@mail.gmail.com>
	<46002C0B.8070508@loafman.com>
	<a595de7a0703201204x1037d089q566f6abeaa85c477@mail.gmail.com>
	<4600338F.2000202@loafman.com>
Message-ID: <29a6ca010703201249u2cd12bf8xfd0787f5d4bac436@mail.gmail.com>

On 3/20/07, Kenneth Loafman <kenneth@loafman.com> wrote:
> Clodoaldo wrote:
> > 2007/3/20, Kenneth Loafman <kenneth@loafman.com>:
> >> Clodoaldo wrote:
> >> > 2007/3/20, Kenneth Loafman <kenneth@loafman.com>:
> >> >> I'm using mod_python under Ubuntu Edgy 64, doing some basic plots of
> >> >> data and allowing users to select a point to center on a region and
> >> gen
> >> >> the next plot.  All of that works as long as the user moves forward.
> >> >> The problem comes in the use of the back button.  The browser merely
> >> >> displays the last page rather than rebuilding it, or at least
> >> restoring
> >> >> the variables.  This leads to a lot of confusion because the server is
> >> >> on one set of plot values and the browser is now on another.  This
> >> seems
> >> >> to be a common problem.  Is there a solution, or should I just warn
> >> the
> >> >> user not to use the browser back button?
> >> >
> >> > How does the user select the point? Entering it in a form field? If so
> >> > save the plot values (the page state) on the page using a hidden field
> >> > inside the form:
> >> > <input type="hidden" name="variable_1" value="99.9">
> >> > <input type="hidden" name="variable_2" value="33.3">
> >> >
> >> > When the form is submitted those values will be available to your
> >> script.
> >>
> >> What I am doing is this:
> >>
> >> def regen_plot(req):
> >>     <plot logic snipped>
> >> return """\
> >> %s
> >> <div align="center">
> >> <a href="/demo/index/display_hit">
> >> <img src="/demo/%s.gif" ismap border=0></a>
> >> <p>X range is %d through %d seconds</p>
> >> </div>
> >> %s
> >> """ % (_head, dbname, xrng[0], xrng[1], _tail(req))
> >>
> >> Then when the user hits a point on the plot, display_hit is called.  I
> >> translate the x,y args from the URL into plot space, center the point
> >> around a smaller region, and plot again.  Going forward, it all works.
> >> Session() vars work, but since I'm not in a form, and there's no submit
> >> button, the hidden values don't work.  req.form.get('x') fails.
> >>
> >> Is it possible to get <form> to use an <img ... ismap> tag in lieu of
> >> the submit button?
> >
> > I don't know. What if you just set the the values in the URL? This way
> > the user could even bookmark each frame of his interest.:
> >
> >> <a href="/demo/index/display_hit?var_1=99.9&var_2=33.3">
>
> I tried that and the values just go away.  The <img...ismap> tag appends
> the x,y values of the mouse to the url, so what you see in the status
> bar is:
>
> /demo/index/display_hit?var_1=99.9&var_2=33.3?5,9
>
> When the mouse is clicked, the first ?... goes away before being passed.
>
> /demo/index/display_hit?5,9


This isn't mod_python related anymore, but if you're willing to go the
Javascript route you could get ditch the image map and get the user's
click coordinates from a Javascript event instead.  You could then add
these to document.location however you like (without overwriting the
existing query args), and an example like Clodoaldo's should work.

Colin

>
> ...Thanks,
> ...Ken
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From clodoaldo.pinto.neto at gmail.com  Tue Mar 20 14:53:33 2007
From: clodoaldo.pinto.neto at gmail.com (Clodoaldo)
Date: Tue Mar 20 14:53:37 2007
Subject: [mod_python] Detecting Back Button Usage
In-Reply-To: <4600338F.2000202@loafman.com>
References: <45FFE28A.7010104@loafman.com>
	<a595de7a0703200703m1e43c581y78990bd71d511166@mail.gmail.com>
	<46002C0B.8070508@loafman.com>
	<a595de7a0703201204x1037d089q566f6abeaa85c477@mail.gmail.com>
	<4600338F.2000202@loafman.com>
Message-ID: <a595de7a0703201253w7706b07cp11f91d731dafec@mail.gmail.com>

2007/3/20, Kenneth Loafman <kenneth@loafman.com>:
> Clodoaldo wrote:
> > 2007/3/20, Kenneth Loafman <kenneth@loafman.com>:
> >> Clodoaldo wrote:
> >> > 2007/3/20, Kenneth Loafman <kenneth@loafman.com>:
> >> >> I'm using mod_python under Ubuntu Edgy 64, doing some basic plots of
> >> >> data and allowing users to select a point to center on a region and
> >> gen
> >> >> the next plot.  All of that works as long as the user moves forward.
> >> >> The problem comes in the use of the back button.  The browser merely
> >> >> displays the last page rather than rebuilding it, or at least
> >> restoring
> >> >> the variables.  This leads to a lot of confusion because the server is
> >> >> on one set of plot values and the browser is now on another.  This
> >> seems
> >> >> to be a common problem.  Is there a solution, or should I just warn
> >> the
> >> >> user not to use the browser back button?
> >> >
> >> > How does the user select the point? Entering it in a form field? If so
> >> > save the plot values (the page state) on the page using a hidden field
> >> > inside the form:
> >> > <input type="hidden" name="variable_1" value="99.9">
> >> > <input type="hidden" name="variable_2" value="33.3">
> >> >
> >> > When the form is submitted those values will be available to your
> >> script.
> >>
> >> What I am doing is this:
> >>
> >> def regen_plot(req):
> >>     <plot logic snipped>
> >> return """\
> >> %s
> >> <div align="center">
> >> <a href="/demo/index/display_hit">
> >> <img src="/demo/%s.gif" ismap border=0></a>
> >> <p>X range is %d through %d seconds</p>
> >> </div>
> >> %s
> >> """ % (_head, dbname, xrng[0], xrng[1], _tail(req))
> >>
> >> Then when the user hits a point on the plot, display_hit is called.  I
> >> translate the x,y args from the URL into plot space, center the point
> >> around a smaller region, and plot again.  Going forward, it all works.
> >> Session() vars work, but since I'm not in a form, and there's no submit
> >> button, the hidden values don't work.  req.form.get('x') fails.
> >>
> >> Is it possible to get <form> to use an <img ... ismap> tag in lieu of
> >> the submit button?
> >
> > I don't know. What if you just set the the values in the URL? This way
> > the user could even bookmark each frame of his interest.:
> >
> >> <a href="/demo/index/display_hit?var_1=99.9&var_2=33.3">
>
> I tried that and the values just go away.  The <img...ismap> tag appends
> the x,y values of the mouse to the url, so what you see in the status
> bar is:
>
> /demo/index/display_hit?var_1=99.9&var_2=33.3?5,9
>
> When the mouse is clicked, the first ?... goes away before being passed.
>
> /demo/index/display_hit?5,9

I tried this and it worked in Firefox 1.5:

<html>
<body>
<form method="get" action="">
<input type="image" name="my_image" src="ado_net_costas.png">
<input type="hidden" name="x" value="99.9">
<input type="hidden" name="y" value="33.3">
</form>
</body>
</html>

When I click the image this URL is sent:
http://teste.s0/python/imagemap.html?my_image.x=293&my_image.y=222&x=99.9&y=33.3


-- 
Clodoaldo Pinto Neto
From graham.dumpleton at gmail.com  Tue Mar 20 15:54:34 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Mar 20 15:54:41 2007
Subject: [mod_python] Compiling mod_python
In-Reply-To: <20070320161924.GA17686@santiago.connexer.com>
References: <5EB03EC6-9F5B-4DDA-8AC1-8778161CA0EC@pharaondev.com>
	<20070320084439.GB8104@santiago.connexer.com>
	<88e286470703200327n31c2eba6t46f320effad6b790@mail.gmail.com>
	<20070320161924.GA17686@santiago.connexer.com>
Message-ID: <88e286470703201354m3524bb09t62f40318b74179e2@mail.gmail.com>

On 21/03/07, Roberto C. S?nchez <roberto@connexer.com> wrote:
> On Tue, Mar 20, 2007 at 09:27:45PM +1100, Graham Dumpleton wrote:
> >
> > One reason for recompiling Python is because the prepackaged binary
> > distributions of Python are generally never built with the
> > --enabled-shared option. This means you only have a static libpython.a
>
> This is not the case on Debian.  From a stock Sarge install:
>
> ldd /usr/lib/apache2/modules/mod_python.so
>         libpython2.3.so.1.0 => /usr/lib/libpython2.3.so.1.0 (0x4001b000)
>         libpthread.so.0 => /lib/libpthread.so.0 (0x40124000)
>         libdl.so.2 => /lib/libdl.so.2 (0x40175000)
>         libutil.so.1 => /lib/libutil.so.1 (0x40179000)
>         libm.so.6 => /lib/libm.so.6 (0x4017c000)
>         libc.so.6 => /lib/libc.so.6 (0x4019e000)
>         /lib/ld-linux.so.2 => /lib/ld-linux.so.2 (0x80000000)

Then we can only assume then that OP compiled his Python from source
code as his doesn't use a shared library. Quoting his original email:

...
/config -Xlinker -export-dynamic -lm -lpython2.5 -lpthread -ldl -
lutil -lm
/usr/bin/ld: /usr/local/lib/python2.5/config/libpython2.5.a
(abstract.o): relocation R_X86_64_32 against `a local symbol' can not
be used when making a shared object; recompile with -fPIC
/usr/local/lib/python2.5/config/libpython2.5.a: could not read
symbols: Bad value
collect2: ld returned 1 exit status
apxs:Error: Command failed with rc=65536

As can be seen, trying to use libpython2.5.a. Therefore suggestion
still stands if for some reason he wants to continue to use version of
Python compiled from source code.

As far as debian binaries using --enable-shared that is good to hear.
If others can comment on whether binary distributions for other Linux
distributions use --enable-shared for Python build, would love to hear
so I know how common a practice it may or may not be across
distributions. If it is common, I can stop grumbling about it. ;-)

Thanks.

Graham

From graham.dumpleton at gmail.com  Tue Mar 20 16:01:00 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Mar 20 16:01:05 2007
Subject: [mod_python] RE: Mod_python Digest, Vol 48, Issue 23
In-Reply-To: <7B73172B331C034198AA90BDF604F5FB02861508@XCH-NW-5V1.nw.nos.boeing.com>
References: <200703201431.l2KEV9Zq032754@modpython.org>
	<7B73172B331C034198AA90BDF604F5FB02861508@XCH-NW-5V1.nw.nos.boeing.com>
Message-ID: <88e286470703201401s4d67541bva9c31d3f710d772e@mail.gmail.com>

On 21/03/07, Posey, Jake E <Jake.E.Posey@boeing.com> wrote:
> I have the same problem with compiling mod_python on 64bit Red Hat with apache 2.2.4 and even after recompiling python 2.5 with --enable-shared everything configures, compiles, and install without any errors but when I run python -V I get the following error:
>
> [root@lcas204 ~]# /usr/local/bin/python -V
> /usr/local/bin/python: error while loading shared libraries: libpython2.5.so.1.0: cannot open shared object file: No such file or directory
> [root@lcas204 ~]#
>
> However the file does exist and it is in my path.
>
> [root@lcas204 lib]# pwd
> /usr/local/lib
> [root@lcas204 lib]# ls -ld *python*
> lrwxrwxrwx   1 root root      19 Mar 20 09:02 libpython2.5.so -> libpython2.5.so.1.0
> -r-xr-xr-x   1 root root 5001973 Mar 20 09:02 libpython2.5.so.1.0
> lrwxrwxrwx   1 root root      19 Mar 20 09:14 libpython.so -> libpython2.5.so.1.0
> drwxr-xr-x  21 root root   20480 Mar 20 09:02 python2.5
> [root@lcas204 lib]#
>
> [root@lcas204 ~]# echo $PATH
> /usr/kerberos/sbin:/usr/kerberos/bin:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/usr/X11R6/bin:/root/bin:/usr/local:/usr/local/lib:/usr/local/lib/python2.5
> [root@lcas204 ~]#
>
> But if I just run ./configure with no options it configure, compiles, and installs with no errors and I'm able to run python -V to check the version and make sure it is working but when I go to compile mod_python I'm back to the original problem.
>
> Any other ideas?

It isn't a Windows system. Only Windows system looks in PATH for DLLs
(shared libraries).

On Linux you have two choices. The first is to set the environment
variable LD_LIBRARY_PATH to list the names of any additional
directories that should be searched for shared libraries. The second,
and perhaps preferable one, is at the time of building Python in the
first place, set the environment variable LD_RUN_PATH to be the
directory where the library will eventually be installed.

The difference between the two is that LD_LIBRARY_PATH is only use at
runtime to find library, whereas value of LD_RUN_PATH is embedded
within the 'python' executable so the executable itself knows to look
in that directory. The latter eliminates the need to set any
environment variables at runtime.

Graham
From roberto at connexer.com  Tue Mar 20 18:39:26 2007
From: roberto at connexer.com (Roberto =?iso-8859-1?Q?C=2E_S=E1nchez?=)
Date: Tue Mar 20 18:39:30 2007
Subject: [mod_python] Compiling mod_python
In-Reply-To: <88e286470703201354m3524bb09t62f40318b74179e2@mail.gmail.com>
References: <5EB03EC6-9F5B-4DDA-8AC1-8778161CA0EC@pharaondev.com>
	<20070320084439.GB8104@santiago.connexer.com>
	<88e286470703200327n31c2eba6t46f320effad6b790@mail.gmail.com>
	<20070320161924.GA17686@santiago.connexer.com>
	<88e286470703201354m3524bb09t62f40318b74179e2@mail.gmail.com>
Message-ID: <20070320233926.GA24135@santiago.connexer.com>

On Wed, Mar 21, 2007 at 07:54:34AM +1100, Graham Dumpleton wrote:
> 
> As far as debian binaries using --enable-shared that is good to hear.
> If others can comment on whether binary distributions for other Linux
> distributions use --enable-shared for Python build, would love to hear
> so I know how common a practice it may or may not be across
> distributions. If it is common, I can stop grumbling about it. ;-)
> 
Here is CentOS 4.4 (and I assume other RHEL4-based distros) on amd64:

ldd /usr/bin/python
        libpython2.3.so.1.0 => /usr/lib64/libpython2.3.so.1.0 (0x000000305d600000)
        libpthread.so.0 => /lib64/tls/libpthread.so.0 (0x00000030c1300000)
        libdl.so.2 => /lib64/libdl.so.2 (0x00000030c0500000)
        libutil.so.1 => /lib64/libutil.so.1 (0x00000030c2000000)
        libm.so.6 => /lib64/tls/libm.so.6 (0x00000030c0900000)
        libc.so.6 => /lib64/tls/libc.so.6 (0x00000030c0200000)
        /lib64/ld-linux-x86-64.so.2 (0x00000030c0000000)

Regards,

-Roberto
-- 
Roberto C. S?nchez
http://people.connexer.com/~roberto
http://www.connexer.com
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070320/1a8b9cf2/attachment.bin
From kenneth at loafman.com  Wed Mar 21 06:38:08 2007
From: kenneth at loafman.com (Kenneth Loafman)
Date: Wed Mar 21 06:38:39 2007
Subject: [mod_python] Detecting Back Button Usage
In-Reply-To: <a595de7a0703201253w7706b07cp11f91d731dafec@mail.gmail.com>
References: <45FFE28A.7010104@loafman.com>	
	<a595de7a0703200703m1e43c581y78990bd71d511166@mail.gmail.com>	
	<46002C0B.8070508@loafman.com>	
	<a595de7a0703201204x1037d089q566f6abeaa85c477@mail.gmail.com>	
	<4600338F.2000202@loafman.com>
	<a595de7a0703201253w7706b07cp11f91d731dafec@mail.gmail.com>
Message-ID: <46011920.1040003@loafman.com>

Clodoaldo wrote:
> 
> I tried this and it worked in Firefox 1.5:
> 
> <html>
> <body>
> <form method="get" action="">
> <input type="image" name="my_image" src="ado_net_costas.png">
> <input type="hidden" name="x" value="99.9">
> <input type="hidden" name="y" value="33.3">
> </form>
> </body>
> </html>
> 
> When I click the image this URL is sent:
> http://teste.s0/python/imagemap.html?my_image.x=293&my_image.y=222&x=99.9&y=33.3 

This works perfectly for what I need.  The other form using the 
<img...ismap> tag would not allow me to get the args with mod_python's 
req.form.get() function, they had to be parsed internally.  Doing this 
and adding a couple of additional vars will allow the graph to be used 
in a bookmark, or served independently of the application.

Thanks for all the help, and the patience!

...Ken
From clodoaldo.pinto.neto at gmail.com  Wed Mar 21 07:39:49 2007
From: clodoaldo.pinto.neto at gmail.com (Clodoaldo)
Date: Wed Mar 21 07:39:52 2007
Subject: [mod_python] Compiling mod_python
In-Reply-To: <88e286470703201354m3524bb09t62f40318b74179e2@mail.gmail.com>
References: <5EB03EC6-9F5B-4DDA-8AC1-8778161CA0EC@pharaondev.com>
	<20070320084439.GB8104@santiago.connexer.com>
	<88e286470703200327n31c2eba6t46f320effad6b790@mail.gmail.com>
	<20070320161924.GA17686@santiago.connexer.com>
	<88e286470703201354m3524bb09t62f40318b74179e2@mail.gmail.com>
Message-ID: <a595de7a0703210539j49d625fco58a2bf76267b0c65@mail.gmail.com>

2007/3/20, Graham Dumpleton <graham.dumpleton@gmail.com>:
> On 21/03/07, Roberto C. S?nchez <roberto@connexer.com> wrote:
> > On Tue, Mar 20, 2007 at 09:27:45PM +1100, Graham Dumpleton wrote:
> > >
> > > One reason for recompiling Python is because the prepackaged binary
> > > distributions of Python are generally never built with the
> > > --enabled-shared option. This means you only have a static libpython.a
> >
> > This is not the case on Debian.  From a stock Sarge install:
> >
> > ldd /usr/lib/apache2/modules/mod_python.so
> >         libpython2.3.so.1.0 => /usr/lib/libpython2.3.so.1.0 (0x4001b000)
> >         libpthread.so.0 => /lib/libpthread.so.0 (0x40124000)
> >         libdl.so.2 => /lib/libdl.so.2 (0x40175000)
> >         libutil.so.1 => /lib/libutil.so.1 (0x40179000)
> >         libm.so.6 => /lib/libm.so.6 (0x4017c000)
> >         libc.so.6 => /lib/libc.so.6 (0x4019e000)
> >         /lib/ld-linux.so.2 => /lib/ld-linux.so.2 (0x80000000)
>
> Then we can only assume then that OP compiled his Python from source
> code as his doesn't use a shared library. Quoting his original email:
>
> ...
> /config -Xlinker -export-dynamic -lm -lpython2.5 -lpthread -ldl -
> lutil -lm
> /usr/bin/ld: /usr/local/lib/python2.5/config/libpython2.5.a
> (abstract.o): relocation R_X86_64_32 against `a local symbol' can not
> be used when making a shared object; recompile with -fPIC
> /usr/local/lib/python2.5/config/libpython2.5.a: could not read
> symbols: Bad value
> collect2: ld returned 1 exit status
> apxs:Error: Command failed with rc=65536
>
> As can be seen, trying to use libpython2.5.a. Therefore suggestion
> still stands if for some reason he wants to continue to use version of
> Python compiled from source code.
>
> As far as debian binaries using --enable-shared that is good to hear.
> If others can comment on whether binary distributions for other Linux
> distributions use --enable-shared for Python build, would love to hear
> so I know how common a practice it may or may not be across
> distributions. If it is common, I can stop grumbling about it. ;-)

FC5:

# uname -a
Linux dkt.localdomain 2.6.20-1.2300.fc5 #1 Sun Mar 11 19:29:11 EDT
2007 i686 athlon i386 GNU/Linux

# ldd /usr/lib/httpd/modules/mod_python.so
        linux-gate.so.1 =>  (0x00e3c000)
        libpthread.so.0 => /lib/libpthread.so.0 (0x00384000)
        libdl.so.2 => /lib/libdl.so.2 (0x00250000)
        libutil.so.1 => /lib/libutil.so.1 (0x00110000)
        libm.so.6 => /lib/libm.so.6 (0x004ee000)
        libc.so.6 => /lib/libc.so.6 (0x00114000)
        /lib/ld-linux.so.2 (0x80000000)

FC6:

# uname -a
Linux s0.localdomain 2.6.20-1.2925.fc6 #1 SMP Sat Mar 10 18:20:58 EST
2007 i686 athlon i386 GNU/Linux

# ldd /usr/lib/httpd/modules/mod_python.so
        linux-gate.so.1 =>  (0x00d70000)
        libpthread.so.0 => /lib/libpthread.so.0 (0x00771000)
        libdl.so.2 => /lib/libdl.so.2 (0x00ea5000)
        libutil.so.1 => /lib/libutil.so.1 (0x00110000)
        libm.so.6 => /lib/libm.so.6 (0x00df1000)
        libc.so.6 => /lib/libc.so.6 (0x00396000)
        /lib/ld-linux.so.2 (0x80000000)

FC6 x86_64:
# uname -a
Linux fc621199.aspadmin.net 2.6.18-1.2849.fc6 #1 SMP Fri Nov 10
12:34:46 EST 2006 x86_64 x86_64 x86_64 GNU/Linux

ldd /usr/lib/httpd/modules/mod_python.so
        linux-gate.so.1 =>  (0x004f6000)
        libpthread.so.0 => /lib/libpthread.so.0 (0x00d67000)
        libdl.so.2 => /lib/libdl.so.2 (0x00823000)
        libutil.so.1 => /lib/libutil.so.1 (0x00110000)
        libm.so.6 => /lib/libm.so.6 (0x00f9e000)
        libc.so.6 => /lib/libc.so.6 (0x00ab2000)
        /lib/ld-linux.so.2 (0x80000000)

Regards,
-- 
Clodoaldo Pinto Neto

From richardlewis at fastmail.co.uk  Wed Mar 21 09:12:33 2007
From: richardlewis at fastmail.co.uk (Richard Lewis)
Date: Wed Mar 21 09:12:55 2007
Subject: [mod_python] Detecting Back Button Usage
In-Reply-To: <46011920.1040003@loafman.com>
References: <45FFE28A.7010104@loafman.com>
	<a595de7a0703201253w7706b07cp11f91d731dafec@mail.gmail.com>
	<46011920.1040003@loafman.com>
Message-ID: <200703211412.34043.richardlewis@fastmail.co.uk>

I've got a web application I'm working on with mod_python and a Java applet 
and it doesn't respond well to back button hits. One thing I thought of 
checking was the referrer. I haven't looked into it yet, but I notice its 
included in the Apache log. I guess there could be a header available to 
mod_python. Then you could check the referrer when you get a hit and see if 
its come from one of your own dynamic pages. Or something.

Richard

On Wednesday 21 March 2007 11:38, Kenneth Loafman wrote:
> Clodoaldo wrote:
> > I tried this and it worked in Firefox 1.5:
> >
> > <html>
> > <body>
> > <form method="get" action="">
> > <input type="image" name="my_image" src="ado_net_costas.png">
> > <input type="hidden" name="x" value="99.9">
> > <input type="hidden" name="y" value="33.3">
> > </form>
> > </body>
> > </html>
> >
> > When I click the image this URL is sent:
> > http://teste.s0/python/imagemap.html?my_image.x=293&my_image.y=222&x=99.9
> >&y=33.3
>
> This works perfectly for what I need.  The other form using the
> <img...ismap> tag would not allow me to get the args with mod_python's
> req.form.get() function, they had to be parsed internally.  Doing this
> and adding a couple of additional vars will allow the graph to be used
> in a bookmark, or served independently of the application.
>
> Thanks for all the help, and the patience!
>
> ...Ken
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

-- 
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
Richard Lewis
http://www.richard-lewis.me.uk/
JID: ironchicken@jabber.earth.li
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
From scott.w.white at gmail.com  Wed Mar 21 09:38:11 2007
From: scott.w.white at gmail.com (Scott White)
Date: Wed Mar 21 09:38:19 2007
Subject: [mod_python] Processing Dynamic Forms
Message-ID: <9f03b2140703210738n7873e332g5de247eeda0f4a41@mail.gmail.com>

I have my template & request handler written & working but I appear to only
be able to declare variables for my post method there are declared in my
form.

Example template:
<form
  <input id="custId"


Example handler:
def post(req, custId


However I have n number of custIds in a format: custId_01, 02, etc.
Therefore I'd like to be able to process all form variables so I can iterate
through them as there are too many to declare.

How would I handle this?   I looked at the req object but didn't any form
related variables.

Thanks,
Scott
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070321/fe696963/attachment.html
From newbarker at btinternet.com  Wed Mar 21 10:01:22 2007
From: newbarker at btinternet.com (PETER BARKER)
Date: Wed Mar 21 10:01:27 2007
Subject: [mod_python] Processing Dynamic Forms
In-Reply-To: <9f03b2140703210738n7873e332g5de247eeda0f4a41@mail.gmail.com>
Message-ID: <829686.21132.qm@web86003.mail.ird.yahoo.com>

req.form['custId_01'] etc.
   
  Regards,
   
  Pete

Scott White <scott.w.white@gmail.com> wrote:
  I have my template & request handler written & working but I appear to only be able to declare variables for my post method there are declared in my form.

Example template:
<form
  <input id="custId" 


Example handler:
def post(req, custId


However I have n number of custIds in a format: custId_01, 02, etc.  Therefore I'd like to be able to process all form variables so I can iterate through them as there are too many to declare. 

How would I handle this?   I looked at the req object but didn't any form related variables.

Thanks,
Scott
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070321/da5718b2/attachment.html
From clodoaldo.pinto.neto at gmail.com  Wed Mar 21 10:27:48 2007
From: clodoaldo.pinto.neto at gmail.com (Clodoaldo)
Date: Wed Mar 21 10:27:54 2007
Subject: [mod_python] Processing Dynamic Forms
In-Reply-To: <9f03b2140703210738n7873e332g5de247eeda0f4a41@mail.gmail.com>
References: <9f03b2140703210738n7873e332g5de247eeda0f4a41@mail.gmail.com>
Message-ID: <a595de7a0703210827u6744ca0fg83bd1f0c0613e674@mail.gmail.com>

2007/3/21, Scott White <scott.w.white@gmail.com>:
> I have my template & request handler written & working but I appear to only
> be able to declare variables for my post method there are declared in my
> form.
>
> Example template:
> <form
>   <input id="custId"
>
>
> Example handler:
> def post(req, custId
>
>
> However I have n number of custIds in a format: custId_01, 02, etc.
> Therefore I'd like to be able to process all form variables so I can iterate
> through them as there are too many to declare.
>
> How would I handle this?   I looked at the req object but didn't any form
> related variables.

If you had this HTML:

<html><body>
<form action="multifield.py" method="post">
<input name="cust_id" type="text">
<input name="cust_id" type="text">
<input name="cust_id" type="text">
<input name="cust_id" type="text">
<input type="submit" value="Submit">
</form>
</body></html>

You could get all cust_id named fields with this publisher function:

def index(req):
   cust_id = req.form.getlist('cust_id')
   return """\
   <html><body>
   <p>%s</p>
   </body></html>
   """ % ', '.join(cust_id)


Regards,
-- 
Clodoaldo Pinto Neto
From cchanone at gmail.com  Wed Mar 21 14:05:43 2007
From: cchanone at gmail.com (Christopher Chan)
Date: Wed Mar 21 14:05:51 2007
Subject: [mod_python] XAMPP with mod_python
Message-ID: <7998dc640703211205r4b0d4f17g4f1cfd4124218d6f@mail.gmail.com>

Anyone using or built mod_python for XAMPP for Linux?


Also, has any tried the mod_python mailman archive at
http://mailman.modpython.org/mailman/listinfo/mod_python, the link to the
archive looks like is set incorrectly or not setup as it's
http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/

- Chris
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070321/08c81746/attachment.html
From graham.dumpleton at gmail.com  Wed Mar 21 16:09:58 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Mar 21 16:10:05 2007
Subject: [mod_python] Processing Dynamic Forms
In-Reply-To: <a595de7a0703210827u6744ca0fg83bd1f0c0613e674@mail.gmail.com>
References: <9f03b2140703210738n7873e332g5de247eeda0f4a41@mail.gmail.com>
	<a595de7a0703210827u6744ca0fg83bd1f0c0613e674@mail.gmail.com>
Message-ID: <88e286470703211409n5b81166bi48ed137a2c5313d7@mail.gmail.com>

On 22/03/07, Clodoaldo <clodoaldo.pinto.neto@gmail.com> wrote:
> 2007/3/21, Scott White <scott.w.white@gmail.com>:
> > I have my template & request handler written & working but I appear to only
> > be able to declare variables for my post method there are declared in my
> > form.
> >
> > Example template:
> > <form
> >   <input id="custId"
> >
> >
> > Example handler:
> > def post(req, custId
> >
> >
> > However I have n number of custIds in a format: custId_01, 02, etc.
> > Therefore I'd like to be able to process all form variables so I can iterate
> > through them as there are too many to declare.
> >
> > How would I handle this?   I looked at the req object but didn't any form
> > related variables.
>
> If you had this HTML:
>
> <html><body>
> <form action="multifield.py" method="post">
> <input name="cust_id" type="text">
> <input name="cust_id" type="text">
> <input name="cust_id" type="text">
> <input name="cust_id" type="text">
> <input type="submit" value="Submit">
> </form>
> </body></html>
>
> You could get all cust_id named fields with this publisher function:
>
> def index(req):
>    cust_id = req.form.getlist('cust_id')
>    return """\
>    <html><body>
>    <p>%s</p>
>    </body></html>
>    """ % ', '.join(cust_id)

Although accessing the form in that way always guarantees a list, one
could also just say:

  def index(req, cust_id):
    if type(cust_id) != type([]):
      cust_id = [cust_id]
    for id in cust_id:
      ...

This is because where a field is non repeating it is passed as single
value. If the field repeats, the values are passed as a list.

Because most people don't bother validating their input fields when
using publisher and always assume it will be a single value, it is
very easy to blow someones code up by passing in repeating fields
explicitly.

The other avenue you can look at is:

  def index(req, **kwargs):
    ...

Using this, any fields for which there are no corresponding parameter
still get passed in kwargs dictionary. The values can be single value
or list for repeating field as above. What one can also do is iterate
other the names of the fields in the dictionary and look for specific
fields. Thus you might have called your fields:

  <html><body>
  <form action="multifield.py" method="post">
  <input name="cust_id-1" type="text">
  <input name="cust_id-2" type="text">
  <input name="cust_id-3" type="text">
  <input name="cust_id-4" type="text">
  <input type="submit" value="Submit">
  </form>
  </body></html>

You could extract all the fields starting with 'cust_id-' from kwargs
and process how you want.

For a more automated way of doing this, look at:

  http://svn.colorstudy.com/FormEncode/trunk/formencode/variabledecode.py

This variable_decode() function in that file can be used to
automatically decode certain conventions for expression arbitrary
lists and dictionaries from form parameters in dictionary.

For an explanation of how it can be used, see 'Structured Form
Parameters' section of:

  http://www.dscpl.com.au/projects/vampire/articles/vampire-003.html

Note that this page details a package that sits on top of mod_python,
so don't expect mod_python by itself to behave as documented.

Graham
From graham.dumpleton at gmail.com  Wed Mar 21 16:13:41 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Mar 21 16:13:45 2007
Subject: [mod_python] XAMPP with mod_python
In-Reply-To: <7998dc640703211205r4b0d4f17g4f1cfd4124218d6f@mail.gmail.com>
References: <7998dc640703211205r4b0d4f17g4f1cfd4124218d6f@mail.gmail.com>
Message-ID: <88e286470703211413pde357b9ia44b22c5369a4737@mail.gmail.com>

On 22/03/07, Christopher Chan <cchanone@gmail.com> wrote:
> Also, has any tried the mod_python mailman archive at
> http://mailman.modpython.org/mailman/listinfo/mod_python ,
> the link to the archive looks like is set incorrectly or not setup as it's
> http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/

Go here instead:

  http://www.modpython.org/pipermail/mod_python/

The archives are linked from the mod_python web site. The broken links
have been noted before but haven't been able to get them fixed.

Graham
From Axel.Thimm at ATrpms.net  Wed Mar 21 16:20:11 2007
From: Axel.Thimm at ATrpms.net (Axel Thimm)
Date: Wed Mar 21 16:20:25 2007
Subject: [mod_python] mod_python on / and authentication on /login (using
	trac)
Message-ID: <20070321212011.GC10053@neu.nirvana>

Hi,

I'm fighting against a strange issue with a setup that involves having
mod_python on Location "/" and authenticating only on certain URLs
like /login. This is for example the typical setup for a trac
dedicated site, see

http://trac.edgewall.org/ticket/3821

for the background. It doesn't happen if mod_python/trac is hooked on
"/trac" and the authentication on "/trac/login".

The combinations that are known to exhibit or not this error are

httpd modpython trac     works
2.2.3 3.6.20    0.10     no
2.2.2 3.3.1     0.10.3   no
2.2.3 3.2.8     0.10.3.1 yes
2.2.2 3.2.10    0.10.3   no

Any ideas what's going wrong or how I could debug this further?

Thanks!
-- 
Axel.Thimm at ATrpms.net
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070321/d161440b/attachment.bin
From graham.dumpleton at gmail.com  Wed Mar 21 16:38:21 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Mar 21 16:38:41 2007
Subject: [mod_python] mod_python on / and authentication on /login (using
	trac)
In-Reply-To: <20070321212011.GC10053@neu.nirvana>
References: <20070321212011.GC10053@neu.nirvana>
Message-ID: <88e286470703211438x6d1d3f6bpc093327b9411e14d@mail.gmail.com>

On 22/03/07, Axel Thimm <Axel.Thimm@atrpms.net> wrote:
> Hi,
>
> I'm fighting against a strange issue with a setup that involves having
> mod_python on Location "/" and authenticating only on certain URLs
> like /login. This is for example the typical setup for a trac
> dedicated site, see
>
> http://trac.edgewall.org/ticket/3821
>
> for the background. It doesn't happen if mod_python/trac is hooked on
> "/trac" and the authentication on "/trac/login".
>
> The combinations that are known to exhibit or not this error are
>
> httpd modpython trac     works
> 2.2.3 3.6.20    0.10     no
> 2.2.2 3.3.1     0.10.3   no
> 2.2.3 3.2.8     0.10.3.1 yes
> 2.2.2 3.2.10    0.10.3   no
>
> Any ideas what's going wrong or how I could debug this further?

I'm not surprised it doesn't work with mod_python 3.6.20 as no such
version exists.

Have you tried setting your DocumentRoot to somewhere outside of your
Trac instance. I'd suggest doing that what would be a bad idea to
start with as the presence of directories/files in there can sometimes
interfere with Apache's matching algorithms for locations. Set it
instead to some empty directory elsewhere if you aren't going to serve
any static files out of document root.

Also, have you tried changing the order of the two Location
directives, ie., those for '/' and '/login' so the later is actually
first. It shouldn't in practice matter, but some Apache configuration
entries are order dependent.

Graham
From Axel.Thimm at ATrpms.net  Wed Mar 21 18:07:32 2007
From: Axel.Thimm at ATrpms.net (Axel Thimm)
Date: Wed Mar 21 18:08:01 2007
Subject: [mod_python] mod_python on / and authentication on /login (using
	trac)
In-Reply-To: <88e286470703211438x6d1d3f6bpc093327b9411e14d@mail.gmail.com>
References: <20070321212011.GC10053@neu.nirvana>
	<88e286470703211438x6d1d3f6bpc093327b9411e14d@mail.gmail.com>
Message-ID: <20070321230732.GA20251@neu.nirvana>

Hi,

On Thu, Mar 22, 2007 at 08:38:21AM +1100, Graham Dumpleton wrote:
> On 22/03/07, Axel Thimm <Axel.Thimm@atrpms.net> wrote:
> >Hi,
> >
> >I'm fighting against a strange issue with a setup that involves having
> >mod_python on Location "/" and authenticating only on certain URLs
> >like /login. This is for example the typical setup for a trac
> >dedicated site, see
> >
> >http://trac.edgewall.org/ticket/3821
> >
> >for the background. It doesn't happen if mod_python/trac is hooked on
> >"/trac" and the authentication on "/trac/login".
> >
> >The combinations that are known to exhibit or not this error are
> >
> >httpd modpython trac     works
> >2.2.3 3.6.20    0.10     no
> >2.2.2 3.3.1     0.10.3   no
> >2.2.3 3.2.8     0.10.3.1 yes
> >2.2.2 3.2.10    0.10.3   no
> >
> >Any ideas what's going wrong or how I could debug this further?
> 
> I'm not surprised it doesn't work with mod_python 3.6.20 as no such
> version exists.
> 
> Have you tried setting your DocumentRoot to somewhere outside of your
> Trac instance. I'd suggest doing that what would be a bad idea to
> start with as the presence of directories/files in there can sometimes
> interfere with Apache's matching algorithms for locations. Set it
> instead to some empty directory elsewhere if you aren't going to serve
> any static files out of document root.

Yes, that's how the setup already was. It was pointing to a folder
with only favicon.ico inside.

> Also, have you tried changing the order of the two Location
> directives, ie., those for '/' and '/login' so the later is actually
> first. It shouldn't in practice matter, but some Apache configuration
> entries are order dependent.

Yes, I tried that, I even replicated the /login section before and
after the / section. The only way I can get it to work is to move the
trac instance further into the URL space, e.g. /trac and /trac/login
instead of / and /login.
-- 
Axel.Thimm at ATrpms.net
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070322/86a4e593/attachment.bin
From graham.dumpleton at gmail.com  Wed Mar 21 19:12:30 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Mar 21 19:12:32 2007
Subject: [mod_python] mod_python on / and authentication on /login (using
	trac)
In-Reply-To: <20070321230732.GA20251@neu.nirvana>
References: <20070321212011.GC10053@neu.nirvana>
	<88e286470703211438x6d1d3f6bpc093327b9411e14d@mail.gmail.com>
	<20070321230732.GA20251@neu.nirvana>
Message-ID: <88e286470703211712g5c4aae3av3375391c2d4da58d@mail.gmail.com>

Do you have any Alias, ScriptAlias or Location directives (normal or
match type) defined outside of the VirtualHost containers? Do you have
any other Auth type or mod_python directives outside of the
VirtualHost container?

If you are only running one VirtualHost, can you see what happens if
you put the definitions outside of the VirtualHost container.

On 22/03/07, Axel Thimm <Axel.Thimm@atrpms.net> wrote:
> Hi,
>
> On Thu, Mar 22, 2007 at 08:38:21AM +1100, Graham Dumpleton wrote:
> > On 22/03/07, Axel Thimm <Axel.Thimm@atrpms.net> wrote:
> > >Hi,
> > >
> > >I'm fighting against a strange issue with a setup that involves having
> > >mod_python on Location "/" and authenticating only on certain URLs
> > >like /login. This is for example the typical setup for a trac
> > >dedicated site, see
> > >
> > >http://trac.edgewall.org/ticket/3821
> > >
> > >for the background. It doesn't happen if mod_python/trac is hooked on
> > >"/trac" and the authentication on "/trac/login".
> > >
> > >The combinations that are known to exhibit or not this error are
> > >
> > >httpd modpython trac     works
> > >2.2.3 3.6.20    0.10     no
> > >2.2.2 3.3.1     0.10.3   no
> > >2.2.3 3.2.8     0.10.3.1 yes
> > >2.2.2 3.2.10    0.10.3   no
> > >
> > >Any ideas what's going wrong or how I could debug this further?
> >
> > I'm not surprised it doesn't work with mod_python 3.6.20 as no such
> > version exists.
> >
> > Have you tried setting your DocumentRoot to somewhere outside of your
> > Trac instance. I'd suggest doing that what would be a bad idea to
> > start with as the presence of directories/files in there can sometimes
> > interfere with Apache's matching algorithms for locations. Set it
> > instead to some empty directory elsewhere if you aren't going to serve
> > any static files out of document root.
>
> Yes, that's how the setup already was. It was pointing to a folder
> with only favicon.ico inside.
>
> > Also, have you tried changing the order of the two Location
> > directives, ie., those for '/' and '/login' so the later is actually
> > first. It shouldn't in practice matter, but some Apache configuration
> > entries are order dependent.
>
> Yes, I tried that, I even replicated the /login section before and
> after the / section. The only way I can get it to work is to move the
> trac instance further into the URL space, e.g. /trac and /trac/login
> instead of / and /login.
> --
> Axel.Thimm at ATrpms.net
>
>
From graham.dumpleton at gmail.com  Wed Mar 21 19:28:10 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Mar 21 19:28:13 2007
Subject: [mod_python] mod_python on / and authentication on /login (using
	trac)
In-Reply-To: <88e286470703211712g5c4aae3av3375391c2d4da58d@mail.gmail.com>
References: <20070321212011.GC10053@neu.nirvana>
	<88e286470703211438x6d1d3f6bpc093327b9411e14d@mail.gmail.com>
	<20070321230732.GA20251@neu.nirvana>
	<88e286470703211712g5c4aae3av3375391c2d4da58d@mail.gmail.com>
Message-ID: <88e286470703211728v58f92617q14b16a4c4634c33@mail.gmail.com>

BTW, it would help if you just sent the bits of the configuration you
are using. That Trac ticket shows using file based basic
authentication, but your posts on Trac users group show you trying to
use LDAP backed basic authentication. Have you tried it with file
based basic authentication instead of LDAP to eliminate that LDAP
isn't the problem, especially since you are setting:

  authzldapauthoritative Off

which to me looks a bit wrong as it suggests that if LDAP has a
problem that it will not error and instead will allow authentication
to fall through to latter authentication handlers but because you
don't have any, it would possibly just pass straight through
unauthenticated on passwd.

Graham

On 22/03/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> Do you have any Alias, ScriptAlias or Location directives (normal or
> match type) defined outside of the VirtualHost containers? Do you have
> any other Auth type or mod_python directives outside of the
> VirtualHost container?
>
> If you are only running one VirtualHost, can you see what happens if
> you put the definitions outside of the VirtualHost container.
>
> On 22/03/07, Axel Thimm <Axel.Thimm@atrpms.net> wrote:
> > Hi,
> >
> > On Thu, Mar 22, 2007 at 08:38:21AM +1100, Graham Dumpleton wrote:
> > > On 22/03/07, Axel Thimm <Axel.Thimm@atrpms.net> wrote:
> > > >Hi,
> > > >
> > > >I'm fighting against a strange issue with a setup that involves having
> > > >mod_python on Location "/" and authenticating only on certain URLs
> > > >like /login. This is for example the typical setup for a trac
> > > >dedicated site, see
> > > >
> > > >http://trac.edgewall.org/ticket/3821
> > > >
> > > >for the background. It doesn't happen if mod_python/trac is hooked on
> > > >"/trac" and the authentication on "/trac/login".
> > > >
> > > >The combinations that are known to exhibit or not this error are
> > > >
> > > >httpd modpython trac     works
> > > >2.2.3 3.6.20    0.10     no
> > > >2.2.2 3.3.1     0.10.3   no
> > > >2.2.3 3.2.8     0.10.3.1 yes
> > > >2.2.2 3.2.10    0.10.3   no
> > > >
> > > >Any ideas what's going wrong or how I could debug this further?
> > >
> > > I'm not surprised it doesn't work with mod_python 3.6.20 as no such
> > > version exists.
> > >
> > > Have you tried setting your DocumentRoot to somewhere outside of your
> > > Trac instance. I'd suggest doing that what would be a bad idea to
> > > start with as the presence of directories/files in there can sometimes
> > > interfere with Apache's matching algorithms for locations. Set it
> > > instead to some empty directory elsewhere if you aren't going to serve
> > > any static files out of document root.
> >
> > Yes, that's how the setup already was. It was pointing to a folder
> > with only favicon.ico inside.
> >
> > > Also, have you tried changing the order of the two Location
> > > directives, ie., those for '/' and '/login' so the later is actually
> > > first. It shouldn't in practice matter, but some Apache configuration
> > > entries are order dependent.
> >
> > Yes, I tried that, I even replicated the /login section before and
> > after the / section. The only way I can get it to work is to move the
> > trac instance further into the URL space, e.g. /trac and /trac/login
> > instead of / and /login.
> > --
> > Axel.Thimm at ATrpms.net
> >
> >
>
From Axel.Thimm at ATrpms.net  Thu Mar 22 14:26:43 2007
From: Axel.Thimm at ATrpms.net (Axel Thimm)
Date: Thu Mar 22 14:27:07 2007
Subject: [mod_python] mod_python on / and authentication on /login (using
	trac)
In-Reply-To: <88e286470703211728v58f92617q14b16a4c4634c33@mail.gmail.com>
References: <20070321212011.GC10053@neu.nirvana>
	<88e286470703211438x6d1d3f6bpc093327b9411e14d@mail.gmail.com>
	<20070321230732.GA20251@neu.nirvana>
	<88e286470703211712g5c4aae3av3375391c2d4da58d@mail.gmail.com>
	<88e286470703211728v58f92617q14b16a4c4634c33@mail.gmail.com>
Message-ID: <20070322192643.GA25302@neu.nirvana>

On Thu, Mar 22, 2007 at 11:28:10AM +1100, Graham Dumpleton wrote:
> BTW, it would help if you just sent the bits of the configuration you
> are using.

OK, see below.

> That Trac ticket shows using file based basic authentication, but
> your posts on Trac users group show you trying to use LDAP backed
> basic authentication. Have you tried it with file based basic
> authentication instead of LDAP to eliminate that LDAP isn't the
> problem, especially since you are setting:

Yes, see below for a tidy example.

> On 22/03/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> >Do you have any Alias, ScriptAlias or Location directives (normal or
> >match type) defined outside of the VirtualHost containers?
> >Do you have any other Auth type or mod_python directives outside of
> >the VirtualHost container?

No, everything is contained in VirtualHosts.


Here is the config (hostname masked away):

<VirtualHost XXX.XXX.XXX:80>
  ServerName XXX.XXX.XXX

  DocumentRoot /ext/test/empty

  <Location "/">
    Order allow,deny
    Allow from all
  </Location>

  <Location "/">
    SetHandler mod_python
    PythonPath "sys.path+['/opt/TWWfsw/trac010/lib/python242']"
    PythonHandler trac.web.modpython_frontend
    PythonOption TracEnv /ext/test/trac
    PythonOption TracUriRoot /
  </Location>

  <Location /login>
    AuthType Basic
    AuthName "MyCompany Trac Server"
    AuthUserFile /ext/test/.htpasswd
    Require valid-user
  </Location>

  ErrorLog \
    /var/opt/TWWfsw/httpd222/log/XXX.XXX.XXX/error
  CustomLog \
    /var/opt/TWWfsw/httpd222/log/XXX.XXX.XXX/access common
</VirtualHost>


> >On 22/03/07, Axel Thimm <Axel.Thimm@atrpms.net> wrote:
> >> Hi,
> >>
> >> On Thu, Mar 22, 2007 at 08:38:21AM +1100, Graham Dumpleton wrote:
> >> > On 22/03/07, Axel Thimm <Axel.Thimm@atrpms.net> wrote:
> >> > >Hi,
> >> > >
> >> > >I'm fighting against a strange issue with a setup that involves having
> >> > >mod_python on Location "/" and authenticating only on certain URLs
> >> > >like /login. This is for example the typical setup for a trac
> >> > >dedicated site, see
> >> > >
> >> > >http://trac.edgewall.org/ticket/3821
> >> > >
> >> > >for the background. It doesn't happen if mod_python/trac is hooked on
> >> > >"/trac" and the authentication on "/trac/login".
> >> > >
> >> > >The combinations that are known to exhibit or not this error are
> >> > >
> >> > >httpd modpython trac     works
> >> > >2.2.3 3.6.20    0.10     no
> >> > >2.2.2 3.3.1     0.10.3   no
> >> > >2.2.3 3.2.8     0.10.3.1 yes
> >> > >2.2.2 3.2.10    0.10.3   no
> >> > >
> >> > >Any ideas what's going wrong or how I could debug this further?
> >> >
> >> > I'm not surprised it doesn't work with mod_python 3.6.20 as no such
> >> > version exists.
> >> >
> >> > Have you tried setting your DocumentRoot to somewhere outside of your
> >> > Trac instance. I'd suggest doing that what would be a bad idea to
> >> > start with as the presence of directories/files in there can sometimes
> >> > interfere with Apache's matching algorithms for locations. Set it
> >> > instead to some empty directory elsewhere if you aren't going to serve
> >> > any static files out of document root.
> >>
> >> Yes, that's how the setup already was. It was pointing to a folder
> >> with only favicon.ico inside.
> >>
> >> > Also, have you tried changing the order of the two Location
> >> > directives, ie., those for '/' and '/login' so the later is actually
> >> > first. It shouldn't in practice matter, but some Apache configuration
> >> > entries are order dependent.
> >>
> >> Yes, I tried that, I even replicated the /login section before and
> >> after the / section. The only way I can get it to work is to move the
> >> trac instance further into the URL space, e.g. /trac and /trac/login
> >> instead of / and /login.
> >>
> >>
> >
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

-- 
Axel.Thimm at ATrpms.net
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070322/46eff9f0/attachment.bin
From graham.dumpleton at gmail.com  Thu Mar 22 17:51:31 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Mar 22 17:51:35 2007
Subject: [mod_python] mod_python on / and authentication on /login (using
	trac)
In-Reply-To: <20070322192643.GA25302@neu.nirvana>
References: <20070321212011.GC10053@neu.nirvana>
	<88e286470703211438x6d1d3f6bpc093327b9411e14d@mail.gmail.com>
	<20070321230732.GA20251@neu.nirvana>
	<88e286470703211712g5c4aae3av3375391c2d4da58d@mail.gmail.com>
	<88e286470703211728v58f92617q14b16a4c4634c33@mail.gmail.com>
	<20070322192643.GA25302@neu.nirvana>
Message-ID: <88e286470703221551l756bf14amb4b8282d37d7a2e2@mail.gmail.com>

On 23/03/07, Axel Thimm <Axel.Thimm@atrpms.net> wrote:
> Here is the config (hostname masked away):
>
> <VirtualHost XXX.XXX.XXX:80>
>   ServerName XXX.XXX.XXX
>
>   DocumentRoot /ext/test/empty
>
>   <Location "/">
>     Order allow,deny
>     Allow from all
>   </Location>

Not sure you really need the above Location section.

>   <Location "/">
>     SetHandler mod_python
>     PythonPath "sys.path+['/opt/TWWfsw/trac010/lib/python242']"
>     PythonHandler trac.web.modpython_frontend
>     PythonOption TracEnv /ext/test/trac
>     PythonOption TracUriRoot /
>   </Location>
>
>   <Location /login>
>     AuthType Basic
>     AuthName "MyCompany Trac Server"
>     AuthUserFile /ext/test/.htpasswd
>     Require valid-user
>   </Location>
>
>   ErrorLog \
>     /var/opt/TWWfsw/httpd222/log/XXX.XXX.XXX/error
>   CustomLog \
>     /var/opt/TWWfsw/httpd222/log/XXX.XXX.XXX/access common
> </VirtualHost>

What happens if you merge all three entries into one under '/'. I
realise this means you can't view Trac pages without first logging in,
but want to see if even that works first. If it doesn't it may point
out where the problem lies, for example, auth files not being readable
properly to Apache user etc.

Only other thing I can suggest is you try experimental mod_wsgi. See:

  http://trac.edgewall.org/wiki/TracModWSGI
  http://code.google.com/p/modwsgi/wiki/IntegrationWithTrac

The configuration using that for what you want to do would be:

  WSGIScriptAlias / /ext/test/trac/apache/trac.wsgi

  <Directory /ext/test/trac/apache>
  Order deny,allow
  Allow from all
  </Directory>

   <Location /login>
   AuthType Basic
   AuthName "MyCompany Trac Server"
   AuthUserFile /ext/test/.htpasswd
   Require valid-user
   </Location>

Create the directory:

  /ext/test/trac/apache

and in it add trac.wsgi containing:

  import os
  os.environ['TRAC_ENV'] = '/ext/test/trac'
  os.environ['PYTHON_EGG_CACHE'] = '/ext/test/trac/mysite/eggs'

  import sys
  path = '/opt/TWWfsw/trac010/lib/python242'
  if not path in sys.path:
    sys.path.append(path)

  import trac.web.main

  application = trac.web.main.dispatch_request

How it does things is a bit different to how you have do things with
mod_python, but the difference might be enough to get around whatever
strangeness is going on with your Apache configuration. Read the
instructions for mod_wsgi to get a better understanding of how to set
it up.

Graham
From Axel.Thimm at ATrpms.net  Thu Mar 22 18:57:52 2007
From: Axel.Thimm at ATrpms.net (Axel Thimm)
Date: Thu Mar 22 18:58:05 2007
Subject: [mod_python] mod_python on / and authentication on /login (using
	trac)
In-Reply-To: <88e286470703221551l756bf14amb4b8282d37d7a2e2@mail.gmail.com>
References: <20070321212011.GC10053@neu.nirvana>
	<88e286470703211438x6d1d3f6bpc093327b9411e14d@mail.gmail.com>
	<20070321230732.GA20251@neu.nirvana>
	<88e286470703211712g5c4aae3av3375391c2d4da58d@mail.gmail.com>
	<88e286470703211728v58f92617q14b16a4c4634c33@mail.gmail.com>
	<20070322192643.GA25302@neu.nirvana>
	<88e286470703221551l756bf14amb4b8282d37d7a2e2@mail.gmail.com>
Message-ID: <20070322235752.GB3448@neu.nirvana>

On Fri, Mar 23, 2007 at 09:51:31AM +1100, Graham Dumpleton wrote:
> On 23/03/07, Axel Thimm <Axel.Thimm@atrpms.net> wrote:
> >Here is the config (hostname masked away):
> >
> ><VirtualHost XXX.XXX.XXX:80>
> >  ServerName XXX.XXX.XXX
> >
> >  DocumentRoot /ext/test/empty
> >
> >  <Location "/">
> >    Order allow,deny
> >    Allow from all
> >  </Location>
> 
> Not sure you really need the above Location section.
> >
> >  <Location "/">
> >    SetHandler mod_python
> >    PythonPath "sys.path+['/opt/TWWfsw/trac010/lib/python242']"
> >    PythonHandler trac.web.modpython_frontend
> >    PythonOption TracEnv /ext/test/trac
> >    PythonOption TracUriRoot /
> >  </Location>
> >
> >  <Location /login>
> >    AuthType Basic
> >    AuthName "MyCompany Trac Server"
> >    AuthUserFile /ext/test/.htpasswd
> >    Require valid-user
> >  </Location>
> >
> >  ErrorLog \
> >    /var/opt/TWWfsw/httpd222/log/XXX.XXX.XXX/error
> >  CustomLog \
> >    /var/opt/TWWfsw/httpd222/log/XXX.XXX.XXX/access common
> ></VirtualHost>
> 
> What happens if you merge all three entries into one under '/'. I
> realise this means you can't view Trac pages without first logging in,
> but want to see if even that works first.

Yes, that works. I had it this way before try to move the auth to
/login only. I just verified that the reduced example above also still
works when merging the sections.

I'll check on your mod_wsgi example, thanks!
-- 
Axel.Thimm at ATrpms.net
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070323/8e3509fd/attachment.bin
From Axel.Thimm at ATrpms.net  Thu Mar 22 20:19:38 2007
From: Axel.Thimm at ATrpms.net (Axel Thimm)
Date: Thu Mar 22 20:19:54 2007
Subject: [mod_python] mod_python on / and authentication on /login (using
	trac)
In-Reply-To: <20070322192643.GA25302@neu.nirvana>
References: <20070321212011.GC10053@neu.nirvana>
	<88e286470703211438x6d1d3f6bpc093327b9411e14d@mail.gmail.com>
	<20070321230732.GA20251@neu.nirvana>
	<88e286470703211712g5c4aae3av3375391c2d4da58d@mail.gmail.com>
	<88e286470703211728v58f92617q14b16a4c4634c33@mail.gmail.com>
	<20070322192643.GA25302@neu.nirvana>
Message-ID: <20070323011938.GC3448@neu.nirvana>

On Thu, Mar 22, 2007 at 08:26:43PM +0100, Axel Thimm wrote:
> On Thu, Mar 22, 2007 at 11:28:10AM +1100, Graham Dumpleton wrote:
> > BTW, it would help if you just sent the bits of the configuration you
> > are using.
> 
> OK, see below.
> 
> > That Trac ticket shows using file based basic authentication, but
> > your posts on Trac users group show you trying to use LDAP backed
> > basic authentication. Have you tried it with file based basic
> > authentication instead of LDAP to eliminate that LDAP isn't the
> > problem, especially since you are setting:
> 
> Yes, see below for a tidy example.
> 
> > On 22/03/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > >Do you have any Alias, ScriptAlias or Location directives (normal or
> > >match type) defined outside of the VirtualHost containers?
> > >Do you have any other Auth type or mod_python directives outside of
> > >the VirtualHost container?
> 
> No, everything is contained in VirtualHosts.
> 
> 
> Here is the config (hostname masked away):
> 
> <VirtualHost XXX.XXX.XXX:80>
>   ServerName XXX.XXX.XXX
> 
>   DocumentRoot /ext/test/empty
> 
>   <Location "/">
>     Order allow,deny
>     Allow from all
>   </Location>
> 
>   <Location "/">
>     SetHandler mod_python
>     PythonPath "sys.path+['/opt/TWWfsw/trac010/lib/python242']"
>     PythonHandler trac.web.modpython_frontend
>     PythonOption TracEnv /ext/test/trac
>     PythonOption TracUriRoot /
>   </Location>
> 

The weird thing is that if I use another SetHandler like none or
server-status in the /login section below it is ignored as well. How
can SetHandler mod_python survive into the next Location section if
explicitly passed to another handler?

And if I start commenting lines in the section "/" above it starts
working the moment I turn off trac (but still keep SetHandler
mod_python).

I don't understand how the Location sections get mixed up like they
do. Doesn't this sound like an apache bug?

>   <Location /login>
>     AuthType Basic
>     AuthName "MyCompany Trac Server"
>     AuthUserFile /ext/test/.htpasswd
>     Require valid-user
>   </Location>
> 
>   ErrorLog \
>     /var/opt/TWWfsw/httpd222/log/XXX.XXX.XXX/error
>   CustomLog \
>     /var/opt/TWWfsw/httpd222/log/XXX.XXX.XXX/access common
> </VirtualHost>
> 
> 
> > >On 22/03/07, Axel Thimm <Axel.Thimm@atrpms.net> wrote:
> > >> Hi,
> > >>
> > >> On Thu, Mar 22, 2007 at 08:38:21AM +1100, Graham Dumpleton wrote:
> > >> > On 22/03/07, Axel Thimm <Axel.Thimm@atrpms.net> wrote:
> > >> > >Hi,
> > >> > >
> > >> > >I'm fighting against a strange issue with a setup that involves having
> > >> > >mod_python on Location "/" and authenticating only on certain URLs
> > >> > >like /login. This is for example the typical setup for a trac
> > >> > >dedicated site, see
> > >> > >
> > >> > >http://trac.edgewall.org/ticket/3821
> > >> > >
> > >> > >for the background. It doesn't happen if mod_python/trac is hooked on
> > >> > >"/trac" and the authentication on "/trac/login".
> > >> > >
> > >> > >The combinations that are known to exhibit or not this error are
> > >> > >
> > >> > >httpd modpython trac     works
> > >> > >2.2.3 3.6.20    0.10     no
> > >> > >2.2.2 3.3.1     0.10.3   no
> > >> > >2.2.3 3.2.8     0.10.3.1 yes
> > >> > >2.2.2 3.2.10    0.10.3   no
> > >> > >
> > >> > >Any ideas what's going wrong or how I could debug this further?
> > >> >
> > >> > I'm not surprised it doesn't work with mod_python 3.6.20 as no such
> > >> > version exists.
> > >> >
> > >> > Have you tried setting your DocumentRoot to somewhere outside of your
> > >> > Trac instance. I'd suggest doing that what would be a bad idea to
> > >> > start with as the presence of directories/files in there can sometimes
> > >> > interfere with Apache's matching algorithms for locations. Set it
> > >> > instead to some empty directory elsewhere if you aren't going to serve
> > >> > any static files out of document root.
> > >>
> > >> Yes, that's how the setup already was. It was pointing to a folder
> > >> with only favicon.ico inside.
> > >>
> > >> > Also, have you tried changing the order of the two Location
> > >> > directives, ie., those for '/' and '/login' so the later is actually
> > >> > first. It shouldn't in practice matter, but some Apache configuration
> > >> > entries are order dependent.
> > >>
> > >> Yes, I tried that, I even replicated the /login section before and
> > >> after the / section. The only way I can get it to work is to move the
> > >> trac instance further into the URL space, e.g. /trac and /trac/login
> > >> instead of / and /login.
> > >>
> > >>
> > >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> 



> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python


-- 
Axel.Thimm at ATrpms.net
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070323/2b3d8ba2/attachment.bin
From liecto at gmail.com  Fri Mar 23 03:49:20 2007
From: liecto at gmail.com (liecto)
Date: Fri Mar 23 03:49:25 2007
Subject: [mod_python] could not import mod_python.apache.\n
Message-ID: <22935d070703230149j745e959eif416d81852bee6c2@mail.gmail.com>

This is in my error.log on my apache.
---------------
[Fri Mar 23 11:53:36 2007] [error] make_obcallback: could not import
mod_python.apache.\n
[Fri Mar 23 11:53:36 2007] [error] make_obcallback: Python path being
used "['F:\\\\mylg\\\\apache-more\\\\local\\\\python\\\\python25.zip',
'.\\\\DLLs', '.\\\\lib', '.\\\\lib\\\\plat-win', '.\\\\lib\\\\lib-tk',
'F:\\\\mylg\\\\apache-more\\\\local\\\\apache\\\\Apache2\\\\bin']".
[Fri Mar 23 11:53:36 2007] [error] get_interpreter: no interpreter
callback found.
[Fri Mar 23 11:53:36 2007] [error] [client 127.0.0.1] python_handler:
Can't get/create interpreter.
-----------------------------------
And when I visit it, it display on my brower.

500 Internal Server Error

what should I do ?
============
winxp sp2
apache 2.2.2
python 2.5
modpython 3.3.1
From graham.dumpleton at gmail.com  Fri Mar 23 04:19:09 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Fri Mar 23 04:19:13 2007
Subject: [mod_python] could not import mod_python.apache.\n
In-Reply-To: <22935d070703230149j745e959eif416d81852bee6c2@mail.gmail.com>
References: <22935d070703230149j745e959eif416d81852bee6c2@mail.gmail.com>
Message-ID: <88e286470703230219l35e55cc5k480726cae6e7a26d@mail.gmail.com>

On 23/03/07, liecto <liecto@gmail.com> wrote:
> This is in my error.log on my apache.
> ---------------
> [Fri Mar 23 11:53:36 2007] [error] make_obcallback: could not import
> mod_python.apache.\n
> [Fri Mar 23 11:53:36 2007] [error] make_obcallback: Python path being
> used "['F:\\\\mylg\\\\apache-more\\\\local\\\\python\\\\python25.zip',
> '.\\\\DLLs', '.\\\\lib', '.\\\\lib\\\\plat-win', '.\\\\lib\\\\lib-tk',
> 'F:\\\\mylg\\\\apache-more\\\\local\\\\apache\\\\Apache2\\\\bin']".
> [Fri Mar 23 11:53:36 2007] [error] get_interpreter: no interpreter
> callback found.
> [Fri Mar 23 11:53:36 2007] [error] [client 127.0.0.1] python_handler:
> Can't get/create interpreter.
> -----------------------------------
> And when I visit it, it display on my brower.
>
> 500 Internal Server Error
>
> what should I do ?

Work out where the mod_python module got installed, usually the Python
site-packages directory. See if the directory (eg site-packages), is
listed in the path above in the errors. If not, fix your Windows
registry settings so Python looks there correctly. Ie., edit:

[HKEY_LOCAL_MACHINE\SOFTWARE\Python\PythonCore\2.5\PythonPath]
@="<path to python>\\Lib;<path to python>\\DLLs;<path to
python>\\Lib\\lib-tk"

See:

http://www.modpython.org/pipermail/mod_python/2006-September/021979.html

for reference.

If you run up Python and at prompt run:

  import mod_python

if it doesn't find module you know the search path is still not correct.

Other possibilities are that you have Apache running as special user
and it doesn't have permissions to read where mod_python is installed.

Graham
From hayat221 at yahoo.com  Fri Mar 23 10:44:03 2007
From: hayat221 at yahoo.com (sikander hayat)
Date: Fri Mar 23 10:44:08 2007
Subject: [mod_python] connection to host server broken
In-Reply-To: <88e286470703230219l35e55cc5k480726cae6e7a26d@mail.gmail.com>
Message-ID: <112213.50585.qm@web38711.mail.mud.yahoo.com>

Hi all,

My apache webserver on linux recently broke down, so i reinstalled it, along with mod_python. Having made the necessary changes in the conf file of apache, i tried some of the simple tests, such as mptest, but i keep on getting the following error.

Connection to host server ... lost.

Why is that, is it because of python or some apache setting.

Thanks,
Sikander

 
---------------------------------
 Get your own web address.
 Have a HUGE year through Yahoo! Small Business.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070323/488168dd/attachment.html
From jpg at jgassociates.ca  Fri Mar 23 11:12:32 2007
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Fri Mar 23 11:10:53 2007
Subject: [mod_python] connection to host server broken
In-Reply-To: <112213.50585.qm@web38711.mail.mud.yahoo.com>
References: <112213.50585.qm@web38711.mail.mud.yahoo.com>
Message-ID: <4603FC70.9020803@jgassociates.ca>

sikander hayat wrote:
> Hi all,
> 
> My apache webserver on linux recently broke down, so i reinstalled it, along with mod_python. Having made the necessary changes in the conf file of apache, i tried some of the simple tests, such as mptest, but i keep on getting the following error.
> 
> Connection to host server ... lost.
> 
> Why is that, is it because of python or some apache setting.

Or network problems?

What do you find in your apache logs?

Jim
From graham.dumpleton at gmail.com  Fri Mar 23 16:15:20 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Fri Mar 23 16:15:30 2007
Subject: [mod_python] could not import mod_python.apache.\n
In-Reply-To: <22935d070703230933p65c570d7i892729109f39d89b@mail.gmail.com>
References: <22935d070703230149j745e959eif416d81852bee6c2@mail.gmail.com>
	<88e286470703230219l35e55cc5k480726cae6e7a26d@mail.gmail.com>
	<22935d070703230933p65c570d7i892729109f39d89b@mail.gmail.com>
Message-ID: <88e286470703231415y489855bg5fd2bca88233dd4@mail.gmail.com>

Please keep follow ups on the mailing list.

As to your question, use Google to look up 'editing windows registry'.
A good place to start is:

  http://en.wikipedia.org/wiki/Windows_registry

Graham

On 24/03/07, liecto <liecto@gmail.com> wrote:
> Hi, thank you for your reply.
> But I don't know what is '@' meaning? how to use it.
> Thank you.
>
>
> On 3/23/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > On 23/03/07, liecto <liecto@gmail.com> wrote:
> > > This is in my error.log on my apache.
> > > ---------------
> > > [Fri Mar 23 11:53:36 2007] [error] make_obcallback: could not import
> > > mod_python.apache.\n
> > > [Fri Mar 23 11:53:36 2007] [error] make_obcallback: Python path being
> > > used "['F:\\\\mylg\\\\apache-more\\\\local\\\\python\\\\python25.zip',
> > > '.\\\\DLLs', '.\\\\lib', '.\\\\lib\\\\plat-win', '.\\\\lib\\\\lib-tk',
> > > 'F:\\\\mylg\\\\apache-more\\\\local\\\\apache\\\\Apache2\\\\bin']".
> > > [Fri Mar 23 11:53:36 2007] [error] get_interpreter: no interpreter
> > > callback found.
> > > [Fri Mar 23 11:53:36 2007] [error] [client 127.0.0.1] python_handler:
> > > Can't get/create interpreter.
> > > -----------------------------------
> > > And when I visit it, it display on my brower.
> > >
> > > 500 Internal Server Error
> > >
> > > what should I do ?
> >
> > Work out where the mod_python module got installed, usually the Python
> > site-packages directory. See if the directory (eg site-packages), is
> > listed in the path above in the errors. If not, fix your Windows
> > registry settings so Python looks there correctly. Ie., edit:
> >
> > [HKEY_LOCAL_MACHINE\SOFTWARE\Python\PythonCore\2.5\PythonPath]
> > @="<path to python>\\Lib;<path to python>\\DLLs;<path to
> > python>\\Lib\\lib-tk"
> >
> > See:
> >
> > http://www.modpython.org/pipermail/mod_python/2006-September/021979.html
> >
> > for reference.
> >
> > If you run up Python and at prompt run:
> >
> >   import mod_python
> >
> > if it doesn't find module you know the search path is still not correct.
> >
> > Other possibilities are that you have Apache running as special user
> > and it doesn't have permissions to read where mod_python is installed.
> >
> > Graham
> >
>
From graham.dumpleton at gmail.com  Fri Mar 23 16:20:32 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Fri Mar 23 16:20:40 2007
Subject: [mod_python] connection to host server broken
In-Reply-To: <4603FC70.9020803@jgassociates.ca>
References: <112213.50585.qm@web38711.mail.mud.yahoo.com>
	<4603FC70.9020803@jgassociates.ca>
Message-ID: <88e286470703231420u38af5335wf1c7515b12aff1bc@mail.gmail.com>

On 24/03/07, Jim Gallacher <jpg@jgassociates.ca> wrote:
> sikander hayat wrote:
> > Hi all,
> >
> > My apache webserver on linux recently broke down, so i reinstalled it, along with mod_python. Having made the necessary changes in the conf file of apache, i tried some of the simple tests, such as mptest, but i keep on getting the following error.
> >
> > Connection to host server ... lost.
> >
> > Why is that, is it because of python or some apache setting.
>
> Or network problems?
>
> What do you find in your apache logs?

The Apache error log would be a good start, as it looks to me like
your Apache child processes are crashing. You may find errors about
segmentation violations or similar in the logs. If you do, check that
the version of mod_python you are using is the correct one for the
version of Python and Apache you are using. Having multiple versions
of Python installed can also cause issues.

BTW, are you using precompiled packages or compiling everything from
source code? What operating system are you using?

Graham
From midreth at gmail.com  Sat Mar 24 10:58:47 2007
From: midreth at gmail.com (Ruben K.)
Date: Sat Mar 24 10:58:58 2007
Subject: [mod_python] mod_python: handling file uploads
Message-ID: <57f09d600703240858l717a544cj4fb1d1a58c961454@mail.gmail.com>

Hello,

How would I go about file uploads without using the publishing handler?

Regards,
RubenK.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070324/64036ce4/attachment.html
From roberto at connexer.com  Sat Mar 24 11:10:40 2007
From: roberto at connexer.com (Roberto =?iso-8859-1?Q?C=2E_S=E1nchez?=)
Date: Sat Mar 24 11:10:44 2007
Subject: [mod_python] mod_python: handling file uploads
In-Reply-To: <57f09d600703240858l717a544cj4fb1d1a58c961454@mail.gmail.com>
References: <57f09d600703240858l717a544cj4fb1d1a58c961454@mail.gmail.com>
Message-ID: <20070324161040.GD16351@santiago.connexer.com>

On Sat, Mar 24, 2007 at 04:58:47PM +0100, Ruben K. wrote:
> Hello,
> 
> How would I go about file uploads without using the publishing handler?
> 
Insufficient information.  Please provide details.

Regards,

-Roberto

-- 
Roberto C. S?nchez
http://people.connexer.com/~roberto
http://www.connexer.com
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070324/75ffe144/attachment.bin
From midreth at gmail.com  Sat Mar 24 11:22:27 2007
From: midreth at gmail.com (Ruben K.)
Date: Sat Mar 24 11:22:31 2007
Subject: [mod_python] mod_python: handling file uploads
In-Reply-To: <20070324161040.GD16351@santiago.connexer.com>
References: <57f09d600703240858l717a544cj4fb1d1a58c961454@mail.gmail.com>
	<20070324161040.GD16351@santiago.connexer.com>
Message-ID: <57f09d600703240922k5ea02905nf438b5a0d1f2b2ee@mail.gmail.com>

I built a simple website framework that is not compatible with the
publishing handler, now I am looking to build a feature into that framework
to handle uploads.

While researching on my own how to do this I found that mod_python's
documention is very lacking
in this area.

I have the following questions:

- In which part of mod_python's instance (usually named req or request) is
the uploaded file information found?
- How would I go about moving temporary files to the target directories?
Would I want to open() a file with w+ or something (create if doesn't exist)
and write() the temporary file's content into it?
- Is there a default handler for actions like this?

Regards,
Ruben K.

On 3/24/07, Roberto C. S?nchez <roberto@connexer.com> wrote:
>
> On Sat, Mar 24, 2007 at 04:58:47PM +0100, Ruben K. wrote:
> > Hello,
> >
> > How would I go about file uploads without using the publishing handler?
> >
> Insufficient information.  Please provide details.
>
> Regards,
>
> -Roberto
>
> --
> Roberto C. S?nchez
> http://people.connexer.com/~roberto
> http://www.connexer.com
>
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v1.4.1 (GNU/Linux)
>
> iD8DBQFGBU2A1snWssAFC08RAhMrAKCIs+nztWDdP70KvW6g+jqxdcFQ9wCfUIYC
> Yi/bytiAo6qUPF90zZM9CY8=
> =J7S8
> -----END PGP SIGNATURE-----
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070324/2e55502c/attachment.html
From nmilkovits at gmail.com  Sat Mar 24 14:31:20 2007
From: nmilkovits at gmail.com (Nicholas Milkovits)
Date: Sat Mar 24 14:31:24 2007
Subject: [mod_python] null pointer to PyObject_CallMethod
Message-ID: <71a75690703241231i12005488g312a83c769492655@mail.gmail.com>

Hello,

I am trying to find out the cause of a segmentation fault that occurs
when occasionally processing database requests. The environment is
Apache 2.0.59 (it happens when run in either prefork or threaded), Mod
Python 3.3.1, Python 2.5 and cx_Oracle 4.3. All of this software was
compiled from source. The database is Oracle 10g (I believe). I have
pasted a stack trace from gdb below but here is my question:

It appears the seg fault is in the database code but in frames 17 - 14
it appears as though the func argument is a NULL pointer. How is it
possible that execution continues after the call from python_handler
into the interpreter when the beginning of the PyObject_CallMethod is
supposed to raise an error if the func argument is NULL. Is this a
problem with gdb or is there something going on that I am missing?
Thanks for the help

PyObject *
PyObject_CallMethod(PyObject *o, char *name, char *format, ...)
{
	va_list va;
	PyObject *args;
	PyObject *func = NULL;
	PyObject *retval = NULL;

	if (o == NULL || name == NULL)
		return null_error();

        .....function continues

#0  0xad8d7ba5 in kpureq2 ()
   from /usr/vendor/pkg/oracle/product/10.2.0/lib/libclntsh.so.10.1
#1  0xad9b6dc3 in OCIStmtPrepare2 ()
   from /usr/vendor/pkg/oracle/product/10.2.0/lib/libclntsh.so.10.1
#2  0x069ac873 in Cursor_InternalPrepare (self=0x9968d80, statement=0x98b326c)
    at Cursor.c:1073
#3  0x069ad82d in Cursor_Execute (self=0xacb8f020, args=0x1774,
    keywordArgs=0x98b326c) at Cursor.c:1397
#4  0x00674561 in PyCFunction_Call (func=0xacba58ec, arg=0xacb48eac,
    kw=0xae41c10c) at Objects/methodobject.c:77
#5  0x006a9ff6 in PyEval_EvalFrameEx (f=0x994c19c, throwflag=0)
    at Python/ceval.c:3566
#6  0x006aaff3 in PyEval_EvalFrameEx (f=0x994c02c, throwflag=0)
    at Python/ceval.c:3652
#7  0x006aaff3 in PyEval_EvalFrameEx (f=0x98198c4, throwflag=0)
    at Python/ceval.c:3652
#8  0x006aaff3 in PyEval_EvalFrameEx (f=0x9819724, throwflag=0)
    at Python/ceval.c:3652
#9  0x006aaff3 in PyEval_EvalFrameEx (f=0x97f3bf4, throwflag=0)
    at Python/ceval.c:3652
#10 0x006ab8a6 in PyEval_EvalCodeEx (co=0xae6585c0, globals=0xae41c10c,
    locals=0x1774, args=0x7, argcount=0, kws=0x97f3b84, kwcount=7, defs=0x0,
    defcount=0, closure=0x0) at Python/ceval.c:2833
#11 0x006a9c6c in PyEval_EvalFrameEx (f=0x97f39fc, throwflag=0)
    at Python/ceval.c:3661
#12 0x006ab8a6 in PyEval_EvalCodeEx (co=0xae658698, globals=0xae41c10c,
    locals=0x1774, args=0x0, argcount=2, kws=0x0, kwcount=0, defs=0x0,
    defcount=0, closure=0x0) at Python/ceval.c:2833
#13 0x00701318 in function_call (func=0xae5dd144, arg=0xad71790c, kw=0x0)
    at Objects/funcobject.c:517
#14 0x0064f397 in PyObject_Call (func=0x0, arg=0x1774, kw=0x1774)
    at Objects/abstract.c:1860
#15 0x00658cee in instancemethod_call (func=0x1774, arg=0xad71790c, kw=0x1774)
    at Objects/classobject.c:2493
#16 0x0064f397 in PyObject_Call (func=0x0, arg=0x1774, kw=0x1774)
    at Objects/abstract.c:1860
#17 0x0064f750 in PyObject_CallMethod (o=0x0, name=0xad72456c "\001",
    format=0x72ae92 "O") at Objects/abstract.c:1891
#18 0x00648c32 in python_handler (req=0x993a038,
    phase=0x71ba44 "PythonHandler") at mod_python.c:1652
#19 0x0064a9ca in PythonHandler (req=0x993a038) at mod_python.c:2878
From alex.greif at gmail.com  Sat Mar 24 17:21:22 2007
From: alex.greif at gmail.com (Alex Greif)
Date: Sat Mar 24 17:21:28 2007
Subject: [mod_python] apache._server.get_options() Problem in 3.3
Message-ID: <778770d80703241521r62e111a8ob8c477441b2d12e8@mail.gmail.com>

Hi,
in 3.2.10 the following worked well:
apache._server.get_options()

is there an equivalent in 3.3? I tried
apache.server.get_options()
apache.mp_server.get_options()
... but had no luck.


ALex.
From graham.dumpleton at gmail.com  Sat Mar 24 20:28:50 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sat Mar 24 20:28:55 2007
Subject: [mod_python] apache._server.get_options() Problem in 3.3
In-Reply-To: <778770d80703241521r62e111a8ob8c477441b2d12e8@mail.gmail.com>
References: <778770d80703241521r62e111a8ob8c477441b2d12e8@mail.gmail.com>
Message-ID: <88e286470703241828j39cfb48ar58b0594b31cc210c@mail.gmail.com>

On 25/03/07, Alex Greif <alex.greif@gmail.com> wrote:
> Hi,
> in 3.2.10 the following worked well:
> apache._server.get_options()
>
> is there an equivalent in 3.3? I tried
> apache.server.get_options()
> apache.mp_server.get_options()
> ... but had no luck.

Officially made public under the name 'apache.main_server' in 3.3.
Previously it was part of private API and shouldn't have been getting
used, plus was giving incorrect results anyway. See documentation:

http://www.modpython.org/live/current/doc-html/pyapi-apmem.html

Graham
From graham.dumpleton at gmail.com  Sat Mar 24 20:30:03 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sat Mar 24 20:30:07 2007
Subject: Fwd: [mod_python] mod_python: handling file uploads
In-Reply-To: <88e286470703241825o61e25dd4p543d04e384af5d14@mail.gmail.com>
References: <57f09d600703240858l717a544cj4fb1d1a58c961454@mail.gmail.com>
	<20070324161040.GD16351@santiago.connexer.com>
	<57f09d600703240922k5ea02905nf438b5a0d1f2b2ee@mail.gmail.com>
	<88e286470703241825o61e25dd4p543d04e384af5d14@mail.gmail.com>
Message-ID: <88e286470703241830x5b467f02qd48669ec55268bb4@mail.gmail.com>

Sorry, I stuffed up this time and didn't send it back to the list. :-(

---------- Forwarded message ----------
From: Graham Dumpleton <graham.dumpleton@gmail.com>
Date: 25-Mar-2007 11:25
Subject: Re: [mod_python] mod_python: handling file uploads
To: "Ruben K." <midreth@gmail.com>


On 25/03/07, Ruben K. <midreth@gmail.com> wrote:
> I built a simple website framework that is not compatible with the
> publishing handler, now I am looking to build a feature into that framework
> to handle uploads.
>
> While researching on my own how to do this I found that mod_python's
> documention is very lacking
> in this area.
>
> I have the following questions:
>
> - In which part of mod_python's instance (usually named req or request) is
> the uploaded file information found?
> - How would I go about moving temporary files to the target directories?
> Would I want to open() a file with w+ or something (create if doesn't exist)
> and write() the temporary file's content into it?
> - Is there a default handler for actions like this?

Have you read the following part of the documentation:

http://www.modpython.org/live/current/doc-html/pyapi-util-fstor.html
http://www.modpython.org/live/current/doc-html/pyapi-util-fstor-examples.html#pyapi-util-fstor-examples

The FieldStorage class which is what is used to decode forms and
handle file uploads has a file_callback constructor argument which can
be used to control how uploaded files are handled and where they are
initially stored.

This at least is one way of doing things such that it is handled
within mod_python.

For a more interesting example which you may be able to adapt, have a
look at Tramline (http://www.infrae.com/products/tramline). This is an
input filter than can intercept file uploads and save them away such
that mod_python response handlers don't have to worry about them. All
that gets passed through to a response handler is a file ID of some
sort which it might then use to refer to the file and do further
processing on it.

Graham
From graham.dumpleton at gmail.com  Sat Mar 24 22:21:10 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sat Mar 24 22:21:13 2007
Subject: [mod_python] null pointer to PyObject_CallMethod
In-Reply-To: <71a75690703241231i12005488g312a83c769492655@mail.gmail.com>
References: <71a75690703241231i12005488g312a83c769492655@mail.gmail.com>
Message-ID: <88e286470703242021u1f4997d2v20ec78153f48f93a@mail.gmail.com>

On 25/03/07, Nicholas Milkovits <nmilkovits@gmail.com> wrote:
> Hello,
>
> I am trying to find out the cause of a segmentation fault that occurs
> when occasionally processing database requests. The environment is
> Apache 2.0.59 (it happens when run in either prefork or threaded), Mod
> Python 3.3.1, Python 2.5 and cx_Oracle 4.3. All of this software was
> compiled from source. The database is Oracle 10g (I believe). I have
> pasted a stack trace from gdb below but here is my question:
>
> It appears the seg fault is in the database code but in frames 17 - 14
> it appears as though the func argument is a NULL pointer. How is it
> possible that execution continues after the call from python_handler
> into the interpreter when the beginning of the PyObject_CallMethod is
> supposed to raise an error if the func argument is NULL. Is this a
> problem with gdb or is there something going on that I am missing?
>
> ...
> #17 0x0064f750 in PyObject_CallMethod (o=0x0, name=0xad72456c "\001",
>     format=0x72ae92 "O") at Objects/abstract.c:1891
> #18 0x00648c32 in python_handler (req=0x993a038,
>     phase=0x71ba44 "PythonHandler") at mod_python.c:1652
> #19 0x0064a9ca in PythonHandler (req=0x993a038) at mod_python.c:2878

Since the code in mod_python calling PyObject_CallMethod() is:

    resultobject = PyObject_CallMethod(idata->obcallback, "HandlerDispatch",
                                       "O", request_obj);

and gdb isn't even showing the string literal argument for name
correctly, ie., "HandlerDispatch", I would say gdb is screwing up
somehow.

What I would suggest, in case the Oracle module hasn't be written
properly to be able to work in sub interpreters, is to force
mod_python to run your application in main Python interpreter rather
than default of sub interpreter. To do this, add:

  PythonInterpreter main_interpreter

into context where you have enabled PythonHandler for your
application. See if the problem goes away when that is done. Confirm
in your application that main interpreter is being used by dumping out
'apache.interpreter' or 'req.interpreter'.

Graham
From cboos at neuf.fr  Sun Mar 25 06:08:54 2007
From: cboos at neuf.fr (Christian Boos)
Date: Sun Mar 25 06:09:14 2007
Subject: [mod_python] null pointer to PyObject_CallMethod
In-Reply-To: <88e286470703242021u1f4997d2v20ec78153f48f93a@mail.gmail.com>
References: <71a75690703241231i12005488g312a83c769492655@mail.gmail.com>
	<88e286470703242021u1f4997d2v20ec78153f48f93a@mail.gmail.com>
Message-ID: <46065846.9070904@neuf.fr>

Graham Dumpleton wrote:
> ..... Confirm in your application that main interpreter is being used 
> by dumping out
> 'apache.interpreter' or 'req.interpreter'.

Interesting, I can see some use for that in Trac, as running in 
sub-interpreters also proves to be problematic for us.

That's a known problem together with the Subversion bindings, but seeing 
now that weird error reported for cx_Oracle and your suggestion, I 
wonder if some other, equally weird error involving mod_python and 
mysql-python couldn't be explained by the same cause (see 
http://trac.edgewall.org/ticket/5012).

-- Christian
From graham.dumpleton at gmail.com  Sun Mar 25 07:00:55 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sun Mar 25 07:00:58 2007
Subject: [mod_python] null pointer to PyObject_CallMethod
In-Reply-To: <46065846.9070904@neuf.fr>
References: <71a75690703241231i12005488g312a83c769492655@mail.gmail.com>
	<88e286470703242021u1f4997d2v20ec78153f48f93a@mail.gmail.com>
	<46065846.9070904@neuf.fr>
Message-ID: <88e286470703250500u7bf766a5pf821c0e803bf8ec9@mail.gmail.com>

On 25/03/07, Christian Boos <cboos@neuf.fr> wrote:
> Graham Dumpleton wrote:
> > ..... Confirm in your application that main interpreter is being used
> > by dumping out
> > 'apache.interpreter' or 'req.interpreter'.
>
> Interesting, I can see some use for that in Trac, as running in
> sub-interpreters also proves to be problematic for us.

This comment suggested you might be involved with the development of
Trac. Is that the case or are you just a dedicated user?

> That's a known problem together with the Subversion bindings,

But which isn't as far I have been able to work out because mod_python
has bugs as some still occasionally suggest, but because of how the
Subversion bindings are implemented. :-(

> but seeing
> now that weird error reported for cx_Oracle and your suggestion, I
> wonder if some other, equally weird error involving mod_python and
> mysql-python couldn't be explained by the same cause (see
> http://trac.edgewall.org/ticket/5012).

Looking at MySQLdb module, the error in that ticket relating to
'connect' not being found within the module looks to me totally
unrelated to issues as to what sub interpreter an application may be
running under within mod_python. This is because MySQLdb is a Python
module and 'connect' is just an attribute of that and should be
unchanging. The actual C code component of MySQLdb is at a lower level
and shouldn't really come into it.

What I would be focusing more on with that ticket is the code in
trac/db/mysql_backend.py at:

    def __init__(self, path, user=None, password=None, host=None,
                 port=None, params={}):
        import MySQLdb

        ....

        if (self._mysqldb_gt_or_eq((1, 2, 1))):
            cnx = MySQLdb.connect(db=path, user=user, passwd=password,
                                  host=host, port=port, charset='utf8')
        else:
            cnx = MySQLdb.connect(db=path, user=user, passwd=password,
                                  host=host, port=port, use_unicode=True)

Given that the import of MySQLdb is done within the function scope, I
presume it is in some way evaluated each time the function is called
and reference obtained via import mechanism. That the error comes up
sometimes suggests that the import mechanism is throwing back an empty
module reference, or the wrong module altogether and thus why
'connect' cannot be found.

What I would have done would have been to move that import to global
scope and see if the problem goes away, or fiddle the code to add a
try/except block and when the error occurs dump out as much
information as possible about what module is bound to MySQLdb
reference to try and identify whether it truely is MySQLdb or
something totally different.

In short, applying some basic debugging techniques to the problem in
that ticket should help to track it down if the original reporter was
willing to look into it properly.  Unfortunately most people just want
a quick fix, preferably from some one else. ;-)

Graham
From cboos at neuf.fr  Sun Mar 25 15:32:32 2007
From: cboos at neuf.fr (Christian Boos)
Date: Sun Mar 25 15:32:51 2007
Subject: [mod_python] null pointer to PyObject_CallMethod
In-Reply-To: <88e286470703250500u7bf766a5pf821c0e803bf8ec9@mail.gmail.com>
References: <71a75690703241231i12005488g312a83c769492655@mail.gmail.com>
	<88e286470703242021u1f4997d2v20ec78153f48f93a@mail.gmail.com>
	<46065846.9070904@neuf.fr>
	<88e286470703250500u7bf766a5pf821c0e803bf8ec9@mail.gmail.com>
Message-ID: <4606DC60.30408@neuf.fr>

Graham Dumpleton wrote:
> On 25/03/07, Christian Boos <cboos@neuf.fr> wrote:
>> Graham Dumpleton wrote:
>> > ..... Confirm in your application that main interpreter is being used
>> > by dumping out
>> > 'apache.interpreter' or 'req.interpreter'.
>>
>> Interesting, I can see some use for that in Trac, as running in
>> sub-interpreters also proves to be problematic for us.
>
> This comment suggested you might be involved with the development of
> Trac. Is that the case or are you just a dedicated user?

I'm indeed a Trac developer, and in the comment above I was referring to 
add those informations to the "system information" we display in the 
About page or sent in the semi-automated error reports, in Trac 0.11 
(when logged as TRAC_ADMINs).

>> That's a known problem together with the Subversion bindings,
>
> But which isn't as far I have been able to work out because mod_python
> has bugs as some still occasionally suggest, but because of how the
> Subversion bindings are implemented. :-(

The problem, as I see it, is that using sub-interpreters with extensions 
is a kind of gray area, as documented in the "Bugs and caveats" 
paragraphs of the Python/C API 
(http://docs.python.org/api/initialization.html). The fact that 
mod_python exposes the web application code to this "dangerous zone" 
contributes to shift the blame on mod_python, even though it just 
uncovers subtle bugs and incompatibilities in the extensions themselves.

> ...
> What I would have done would have been to move that import to global
> scope and see if the problem goes away, or fiddle the code to add a
> try/except block and when the error occurs dump out as much
> information as possible about what module is bound to MySQLdb
> reference to try and identify whether it truely is MySQLdb or
> something totally different.

Yes, this we can do, thanks for the suggestion.

-- Christian

From graham.dumpleton at gmail.com  Sun Mar 25 17:15:52 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sun Mar 25 17:15:55 2007
Subject: [mod_python] mod_python on / and authentication on /login (using
	trac)
In-Reply-To: <20070323011938.GC3448@neu.nirvana>
References: <20070321212011.GC10053@neu.nirvana>
	<88e286470703211438x6d1d3f6bpc093327b9411e14d@mail.gmail.com>
	<20070321230732.GA20251@neu.nirvana>
	<88e286470703211712g5c4aae3av3375391c2d4da58d@mail.gmail.com>
	<88e286470703211728v58f92617q14b16a4c4634c33@mail.gmail.com>
	<20070322192643.GA25302@neu.nirvana>
	<20070323011938.GC3448@neu.nirvana>
Message-ID: <88e286470703251515q6d52d596se21ffd725bd008f2@mail.gmail.com>

Did you get any further with this? I note that the Trac people have
given up on you, closed the ticket for the problem and directed you
back to us or Apache lists.

Did you by chance try mod_wsgi to see if you could get something going
under that instead?

Graham

On 23/03/07, Axel Thimm <Axel.Thimm@atrpms.net> wrote:
> On Thu, Mar 22, 2007 at 08:26:43PM +0100, Axel Thimm wrote:
> > On Thu, Mar 22, 2007 at 11:28:10AM +1100, Graham Dumpleton wrote:
> > > BTW, it would help if you just sent the bits of the configuration you
> > > are using.
> >
> > OK, see below.
> >
> > > That Trac ticket shows using file based basic authentication, but
> > > your posts on Trac users group show you trying to use LDAP backed
> > > basic authentication. Have you tried it with file based basic
> > > authentication instead of LDAP to eliminate that LDAP isn't the
> > > problem, especially since you are setting:
> >
> > Yes, see below for a tidy example.
> >
> > > On 22/03/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > > >Do you have any Alias, ScriptAlias or Location directives (normal or
> > > >match type) defined outside of the VirtualHost containers?
> > > >Do you have any other Auth type or mod_python directives outside of
> > > >the VirtualHost container?
> >
> > No, everything is contained in VirtualHosts.
> >
> >
> > Here is the config (hostname masked away):
> >
> > <VirtualHost XXX.XXX.XXX:80>
> >   ServerName XXX.XXX.XXX
> >
> >   DocumentRoot /ext/test/empty
> >
> >   <Location "/">
> >     Order allow,deny
> >     Allow from all
> >   </Location>
> >
> >   <Location "/">
> >     SetHandler mod_python
> >     PythonPath "sys.path+['/opt/TWWfsw/trac010/lib/python242']"
> >     PythonHandler trac.web.modpython_frontend
> >     PythonOption TracEnv /ext/test/trac
> >     PythonOption TracUriRoot /
> >   </Location>
> >
>
> The weird thing is that if I use another SetHandler like none or
> server-status in the /login section below it is ignored as well. How
> can SetHandler mod_python survive into the next Location section if
> explicitly passed to another handler?
>
> And if I start commenting lines in the section "/" above it starts
> working the moment I turn off trac (but still keep SetHandler
> mod_python).
>
> I don't understand how the Location sections get mixed up like they
> do. Doesn't this sound like an apache bug?
>
> >   <Location /login>
> >     AuthType Basic
> >     AuthName "MyCompany Trac Server"
> >     AuthUserFile /ext/test/.htpasswd
> >     Require valid-user
> >   </Location>
> >
> >   ErrorLog \
> >     /var/opt/TWWfsw/httpd222/log/XXX.XXX.XXX/error
> >   CustomLog \
> >     /var/opt/TWWfsw/httpd222/log/XXX.XXX.XXX/access common
> > </VirtualHost>
> >
> >
> > > >On 22/03/07, Axel Thimm <Axel.Thimm@atrpms.net> wrote:
> > > >> Hi,
> > > >>
> > > >> On Thu, Mar 22, 2007 at 08:38:21AM +1100, Graham Dumpleton wrote:
> > > >> > On 22/03/07, Axel Thimm <Axel.Thimm@atrpms.net> wrote:
> > > >> > >Hi,
> > > >> > >
> > > >> > >I'm fighting against a strange issue with a setup that involves having
> > > >> > >mod_python on Location "/" and authenticating only on certain URLs
> > > >> > >like /login. This is for example the typical setup for a trac
> > > >> > >dedicated site, see
> > > >> > >
> > > >> > >http://trac.edgewall.org/ticket/3821
> > > >> > >
> > > >> > >for the background. It doesn't happen if mod_python/trac is hooked on
> > > >> > >"/trac" and the authentication on "/trac/login".
> > > >> > >
> > > >> > >The combinations that are known to exhibit or not this error are
> > > >> > >
> > > >> > >httpd modpython trac     works
> > > >> > >2.2.3 3.6.20    0.10     no
> > > >> > >2.2.2 3.3.1     0.10.3   no
> > > >> > >2.2.3 3.2.8     0.10.3.1 yes
> > > >> > >2.2.2 3.2.10    0.10.3   no
> > > >> > >
> > > >> > >Any ideas what's going wrong or how I could debug this further?
> > > >> >
> > > >> > I'm not surprised it doesn't work with mod_python 3.6.20 as no such
> > > >> > version exists.
> > > >> >
> > > >> > Have you tried setting your DocumentRoot to somewhere outside of your
> > > >> > Trac instance. I'd suggest doing that what would be a bad idea to
> > > >> > start with as the presence of directories/files in there can sometimes
> > > >> > interfere with Apache's matching algorithms for locations. Set it
> > > >> > instead to some empty directory elsewhere if you aren't going to serve
> > > >> > any static files out of document root.
> > > >>
> > > >> Yes, that's how the setup already was. It was pointing to a folder
> > > >> with only favicon.ico inside.
> > > >>
> > > >> > Also, have you tried changing the order of the two Location
> > > >> > directives, ie., those for '/' and '/login' so the later is actually
> > > >> > first. It shouldn't in practice matter, but some Apache configuration
> > > >> > entries are order dependent.
> > > >>
> > > >> Yes, I tried that, I even replicated the /login section before and
> > > >> after the / section. The only way I can get it to work is to move the
> > > >> trac instance further into the URL space, e.g. /trac and /trac/login
> > > >> instead of / and /login.
> > > >>
> > > >>
> > > >
> > > _______________________________________________
> > > Mod_python mailing list
> > > Mod_python@modpython.org
> > > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
>
>
>
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
> --
> Axel.Thimm at ATrpms.net
>
>
From graham.dumpleton at gmail.com  Sun Mar 25 17:47:31 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sun Mar 25 17:47:35 2007
Subject: [mod_python] null pointer to PyObject_CallMethod
In-Reply-To: <4606DC60.30408@neuf.fr>
References: <71a75690703241231i12005488g312a83c769492655@mail.gmail.com>
	<88e286470703242021u1f4997d2v20ec78153f48f93a@mail.gmail.com>
	<46065846.9070904@neuf.fr>
	<88e286470703250500u7bf766a5pf821c0e803bf8ec9@mail.gmail.com>
	<4606DC60.30408@neuf.fr>
Message-ID: <88e286470703251547j3f71900ft3f4553f1baa19279@mail.gmail.com>

On 26/03/07, Christian Boos <cboos@neuf.fr> wrote:
> Graham Dumpleton wrote:
> > On 25/03/07, Christian Boos <cboos@neuf.fr> wrote:
> >> Graham Dumpleton wrote:
> >> > ..... Confirm in your application that main interpreter is being used
> >> > by dumping out
> >> > 'apache.interpreter' or 'req.interpreter'.
> >>
> >> Interesting, I can see some use for that in Trac, as running in
> >> sub-interpreters also proves to be problematic for us.
> >
> > This comment suggested you might be involved with the development of
> > Trac. Is that the case or are you just a dedicated user?
>
> I'm indeed a Trac developer

Good to see you on the list then and taking an interest what happens
over here in mod_python land. We rarely if at all see any developers
involved with any of the major Python web frameworks or applications
here. This is particularly frustrating sometimes especially when they
make comments in their documentation about mod_python that are wrong
or just don't make sense. They never actually come here and find out
what the truth may be and leaving comments against their documentation
never seems to result in a change or further explanation being given.
As a result you get some packages blaming mod_python for problems
where it looks more like some short coming in the other package. Don't
get me wrong here, this comment is not directed at Trac, I have a
totally different Python web framework in mind when I say this. ;-)

> and in the comment above I was referring to
> add those informations to the "system information" we display in the
> About page or sent in the semi-automated error reports, in Trac 0.11
> (when logged as TRAC_ADMINs).

FWIW, in mod_wsgi which Trac is starting to list references on their
site to, to get the name of the interpreter one currently grabs
'mod_wsgi.application_group' out of the WSGI environment dictionary.
If it is an empty string then it is the main Python interpreter, ie.,
same actual interpreter as 'main_interpreter' in mod_python. This is
the only interpreter that is shared between mod_python and mod_wsgi.

I may need to see about actually having a 'mod_wsgi.interpreter_name'
which is distinct from this though. For now it will be the same value,
but later on when look at distinct back end daemon process, setting
the application group may mean sending it to a daemon process but in
that daemon process that application group may be set to run in the
main interpreter and thus the interpreter name would be different to
the application group name. Anyway, enough rambling.

Graham
From Axel.Thimm at ATrpms.net  Sun Mar 25 17:58:25 2007
From: Axel.Thimm at ATrpms.net (Axel Thimm)
Date: Sun Mar 25 17:58:38 2007
Subject: [mod_python] mod_python on / and authentication on /login (using
	trac)
In-Reply-To: <88e286470703251515q6d52d596se21ffd725bd008f2@mail.gmail.com>
References: <20070321212011.GC10053@neu.nirvana>
	<88e286470703211438x6d1d3f6bpc093327b9411e14d@mail.gmail.com>
	<20070321230732.GA20251@neu.nirvana>
	<88e286470703211712g5c4aae3av3375391c2d4da58d@mail.gmail.com>
	<88e286470703211728v58f92617q14b16a4c4634c33@mail.gmail.com>
	<20070322192643.GA25302@neu.nirvana>
	<20070323011938.GC3448@neu.nirvana>
	<88e286470703251515q6d52d596se21ffd725bd008f2@mail.gmail.com>
Message-ID: <20070325225825.GM4287@neu.nirvana>

On Mon, Mar 26, 2007 at 08:15:52AM +1000, Graham Dumpleton wrote:
> Did you get any further with this? I note that the Trac people have
> given up on you, closed the ticket for the problem and directed you
> back to us or Apache lists.

): Indeed :(

> Did you by chance try mod_wsgi to see if you could get something going
> under that instead?

No, I was scared off by the experimental tag and that no code has yet
been released.

Furthermore the setup spec requires trac under mod_python.

> Graham
> 
> On 23/03/07, Axel Thimm <Axel.Thimm@atrpms.net> wrote:
> >On Thu, Mar 22, 2007 at 08:26:43PM +0100, Axel Thimm wrote:
> >> On Thu, Mar 22, 2007 at 11:28:10AM +1100, Graham Dumpleton wrote:
> >> > BTW, it would help if you just sent the bits of the configuration you
> >> > are using.
> >>
> >> OK, see below.
> >>
> >> > That Trac ticket shows using file based basic authentication, but
> >> > your posts on Trac users group show you trying to use LDAP backed
> >> > basic authentication. Have you tried it with file based basic
> >> > authentication instead of LDAP to eliminate that LDAP isn't the
> >> > problem, especially since you are setting:
> >>
> >> Yes, see below for a tidy example.
> >>
> >> > On 22/03/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> >> > >Do you have any Alias, ScriptAlias or Location directives (normal or
> >> > >match type) defined outside of the VirtualHost containers?
> >> > >Do you have any other Auth type or mod_python directives outside of
> >> > >the VirtualHost container?
> >>
> >> No, everything is contained in VirtualHosts.
> >>
> >>
> >> Here is the config (hostname masked away):
> >>
> >> <VirtualHost XXX.XXX.XXX:80>
> >>   ServerName XXX.XXX.XXX
> >>
> >>   DocumentRoot /ext/test/empty
> >>
> >>   <Location "/">
> >>     Order allow,deny
> >>     Allow from all
> >>   </Location>
> >>
> >>   <Location "/">
> >>     SetHandler mod_python
> >>     PythonPath "sys.path+['/opt/TWWfsw/trac010/lib/python242']"
> >>     PythonHandler trac.web.modpython_frontend
> >>     PythonOption TracEnv /ext/test/trac
> >>     PythonOption TracUriRoot /
> >>   </Location>
> >>
> >
> >The weird thing is that if I use another SetHandler like none or
> >server-status in the /login section below it is ignored as well. How
> >can SetHandler mod_python survive into the next Location section if
> >explicitly passed to another handler?
> >
> >And if I start commenting lines in the section "/" above it starts
> >working the moment I turn off trac (but still keep SetHandler
> >mod_python).
> >
> >I don't understand how the Location sections get mixed up like they
> >do. Doesn't this sound like an apache bug?
> >
> >>   <Location /login>
> >>     AuthType Basic
> >>     AuthName "MyCompany Trac Server"
> >>     AuthUserFile /ext/test/.htpasswd
> >>     Require valid-user
> >>   </Location>
> >>
> >>   ErrorLog \
> >>     /var/opt/TWWfsw/httpd222/log/XXX.XXX.XXX/error
> >>   CustomLog \
> >>     /var/opt/TWWfsw/httpd222/log/XXX.XXX.XXX/access common
> >> </VirtualHost>
> >>
> >>
> >> > >On 22/03/07, Axel Thimm <Axel.Thimm@atrpms.net> wrote:
> >> > >> Hi,
> >> > >>
> >> > >> On Thu, Mar 22, 2007 at 08:38:21AM +1100, Graham Dumpleton wrote:
> >> > >> > On 22/03/07, Axel Thimm <Axel.Thimm@atrpms.net> wrote:
> >> > >> > >Hi,
> >> > >> > >
> >> > >> > >I'm fighting against a strange issue with a setup that involves 
> >having
> >> > >> > >mod_python on Location "/" and authenticating only on certain 
> >URLs
> >> > >> > >like /login. This is for example the typical setup for a trac
> >> > >> > >dedicated site, see
> >> > >> > >
> >> > >> > >http://trac.edgewall.org/ticket/3821
> >> > >> > >
> >> > >> > >for the background. It doesn't happen if mod_python/trac is 
> >hooked on
> >> > >> > >"/trac" and the authentication on "/trac/login".
> >> > >> > >
> >> > >> > >The combinations that are known to exhibit or not this error are
> >> > >> > >
> >> > >> > >httpd modpython trac     works
> >> > >> > >2.2.3 3.6.20    0.10     no
> >> > >> > >2.2.2 3.3.1     0.10.3   no
> >> > >> > >2.2.3 3.2.8     0.10.3.1 yes
> >> > >> > >2.2.2 3.2.10    0.10.3   no
> >> > >> > >
> >> > >> > >Any ideas what's going wrong or how I could debug this further?
> >> > >> >
> >> > >> > I'm not surprised it doesn't work with mod_python 3.6.20 as no 
> >such
> >> > >> > version exists.
> >> > >> >
> >> > >> > Have you tried setting your DocumentRoot to somewhere outside of 
> >your
> >> > >> > Trac instance. I'd suggest doing that what would be a bad idea to
> >> > >> > start with as the presence of directories/files in there can 
> >sometimes
> >> > >> > interfere with Apache's matching algorithms for locations. Set it
> >> > >> > instead to some empty directory elsewhere if you aren't going to 
> >serve
> >> > >> > any static files out of document root.
> >> > >>
> >> > >> Yes, that's how the setup already was. It was pointing to a folder
> >> > >> with only favicon.ico inside.
> >> > >>
> >> > >> > Also, have you tried changing the order of the two Location
> >> > >> > directives, ie., those for '/' and '/login' so the later is 
> >actually
> >> > >> > first. It shouldn't in practice matter, but some Apache 
> >configuration
> >> > >> > entries are order dependent.
> >> > >>
> >> > >> Yes, I tried that, I even replicated the /login section before and
> >> > >> after the / section. The only way I can get it to work is to move 
> >the
> >> > >> trac instance further into the URL space, e.g. /trac and /trac/login
> >> > >> instead of / and /login.
> >> > >>
> >> > >>
> >> > >
> >> > _______________________________________________
> >> > Mod_python mailing list
> >> > Mod_python@modpython.org
> >> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >>
> >
> >
> >
> >> _______________________________________________
> >> Mod_python mailing list
> >> Mod_python@modpython.org
> >> http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> >

-- 
Axel.Thimm at ATrpms.net
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070326/90900cbf/attachment.bin
From liecto at gmail.com  Mon Mar 26 02:31:33 2007
From: liecto at gmail.com (liecto)
Date: Mon Mar 26 02:31:36 2007
Subject: [mod_python] how to use Mysql on mod_python+apache?
Message-ID: <22935d070703260031l6c64758embb1aa8d310d2cbd9@mail.gmail.com>

I want to use Mysql ,mod_python,apache build a web .
I have installed mod_python and apache,
and how to setup mysql and how to use it?
thank you.
From hayat221 at yahoo.com  Mon Mar 26 03:11:58 2007
From: hayat221 at yahoo.com (sikander hayat)
Date: Mon Mar 26 03:12:04 2007
Subject: [mod_python] connection to host server broken
In-Reply-To: <88e286470703231420u38af5335wf1c7515b12aff1bc@mail.gmail.com>
Message-ID: <40463.14148.qm@web38707.mail.mud.yahoo.com>

Hi,

I am using suse 10.1, Apache 2.2.4, python 2.5 and mod_python 3.3.1.

The error log is as follows:
[Mon Mar 26 10:16:48 2007] [warn] RSA server certificate is a CA certificate (BasicConstraints: CA == TRUE !?)
[Mon Mar 26 10:16:48 2007] [warn] RSA server certificate CommonName (CN) `localhost' does NOT match server name!?
[Mon Mar 26 10:16:48 2007] [notice] mod_python: Creating 8 session mutexes based on 256 max processes and 0 max threads.
[Mon Mar 26 10:16:48 2007] [notice] mod_python: using mutex_directory /tmp
[Mon Mar 26 10:16:48 2007] [notice] Apache/2.2.4 (Unix) DAV/2 mod_ssl/2.2.4 OpenSSL/0.9.8d mod_python/3.3.1 Python/2.5 PHP/5.2.1 mod_apreq2-20051231/2.5.7 m
od_perl/2.0.2 Perl/v5.8.7 configured -- resuming normal operations
[Mon Mar 26 10:17:04 2007] [error] [client 134.96.24.83] File does not exist: /opt/lampp/htdocs/favicon.ico
[Mon Mar 26 10:17:35 2007] [notice] mod_python (pid=3230, interpreter='localhost'): Importing module '/opt/lampp/htdocs/parkweb/index.py'
[Mon Mar 26 10:17:35 2007] [notice] mod_python (pid=3231, interpreter='localhost'): Importing module '/opt/lampp/htdocs/parkweb/index.py'
[Mon Mar 26 10:17:36 2007] [notice] child pid 3230 exit signal Segmentation fault (11)
[Mon Mar 26 10:17:36 2007] [notice] child pid 3231 exit signal Segmentation fault (11)

I have recently upgraded to python 2.5. So, to say, i have 2 versions of python on my system. Will try to remove the older one and try again.

****Why is it loading the module twice ...is that normal ???

Kindly let me know if something rings a bell.

Thanks,


Graham Dumpleton <graham.dumpleton@gmail.com> wrote: On 24/03/07, Jim Gallacher  wrote:
> sikander hayat wrote:
> > Hi all,
> >
> > My apache webserver on linux recently broke down, so i reinstalled it, along with mod_python. Having made the necessary changes in the conf file of apache, i tried some of the simple tests, such as mptest, but i keep on getting the following error.
> >
> > Connection to host server ... lost.
> >
> > Why is that, is it because of python or some apache setting.
>
> Or network problems?
>
> What do you find in your apache logs?

The Apache error log would be a good start, as it looks to me like
your Apache child processes are crashing. You may find errors about
segmentation violations or similar in the logs. If you do, check that
the version of mod_python you are using is the correct one for the
version of Python and Apache you are using. Having multiple versions
of Python installed can also cause issues.

BTW, are you using precompiled packages or compiling everything from
source code? What operating system are you using?

Graham


 
---------------------------------
Sucker-punch spam with award-winning protection.
 Try the free Yahoo! Mail Beta.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070326/818b11cb/attachment-0001.html
From roberto at connexer.com  Mon Mar 26 09:07:45 2007
From: roberto at connexer.com (Roberto =?iso-8859-1?Q?C=2E_S=E1nchez?=)
Date: Mon Mar 26 09:07:56 2007
Subject: [mod_python] how to use Mysql on mod_python+apache?
In-Reply-To: <22935d070703260031l6c64758embb1aa8d310d2cbd9@mail.gmail.com>
References: <22935d070703260031l6c64758embb1aa8d310d2cbd9@mail.gmail.com>
Message-ID: <20070326140745.GA31497@santiago.connexer.com>

On Mon, Mar 26, 2007 at 03:31:33PM +0800, liecto wrote:
> I want to use Mysql ,mod_python,apache build a web .
> I have installed mod_python and apache,
> and how to setup mysql and how to use it?
> thank you.

Perhaps you should ask on a MySQL list?  BTW, you really should be using
a real database (as in anything other than MySQL).

Regards,

-Roberto
-- 
Roberto C. S?nchez
http://people.connexer.com/~roberto
http://www.connexer.com
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070326/eddcdd37/attachment.bin
From fred at urlbit.us  Mon Mar 26 09:55:51 2007
From: fred at urlbit.us (Fred of UrlBit.Us)
Date: Mon Mar 26 09:56:06 2007
Subject: [mod_python] how to use Mysql on mod_python+apache?
In-Reply-To: <20070326140745.GA31497@santiago.connexer.com>
References: <22935d070703260031l6c64758embb1aa8d310d2cbd9@mail.gmail.com>
	<20070326140745.GA31497@santiago.connexer.com>
Message-ID: <200703261055.52241.fred@urlbit.us>

On Monday 26 March 2007 10:07, Roberto C. S?nchez uttered thusly:

> Perhaps you should ask on a MySQL list?  BTW, you really should be using
> a real database (as in anything other than MySQL).

Flame bait-r-us!

-- 
http://urlbit.us
Bite those long URLs!

From fred at urlbit.us  Mon Mar 26 09:58:55 2007
From: fred at urlbit.us (Fred of UrlBit.Us)
Date: Mon Mar 26 09:59:01 2007
Subject: [mod_python] how to use Mysql on mod_python+apache?
In-Reply-To: <22935d070703260031l6c64758embb1aa8d310d2cbd9@mail.gmail.com>
References: <22935d070703260031l6c64758embb1aa8d310d2cbd9@mail.gmail.com>
Message-ID: <200703261058.56093.fred@urlbit.us>

On Monday 26 March 2007 03:31, liecto uttered thusly:
> I want to use Mysql ,mod_python,apache build a web .
> I have installed mod_python and apache,
> and how to setup mysql and how to use it?
> thank you.
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

You have to acquire and install the MySQLdb package.

http://urlbit.us/2eh

-- 
http://urlbit.us
Bite those long URLs!
From todd at toddesposito.com  Mon Mar 26 10:08:05 2007
From: todd at toddesposito.com (Todd Esposito)
Date: Mon Mar 26 10:09:55 2007
Subject: [mod_python] how to use Mysql on mod_python+apache?
In-Reply-To: <22935d070703260031l6c64758embb1aa8d310d2cbd9@mail.gmail.com>
References: <22935d070703260031l6c64758embb1aa8d310d2cbd9@mail.gmail.com>
Message-ID: <4607E1D5.1070902@toddesposito.com>

liecto wrote:
> I want to use Mysql ,mod_python,apache build a web .
> I have installed mod_python and apache,
> and how to setup mysql and how to use it?
If you have MySQL installed, you can use the "mysql-python" module just 
as you would in a stand-alone (non-mod_python) python application.  See 
http://sourceforge.net/projects/mysql-python or your distro's package 
management tool for the module.  MySQLdb follows the DBAPI 2 specs.

Hope this helps.

- Todd
From roberto at connexer.com  Mon Mar 26 10:12:52 2007
From: roberto at connexer.com (Roberto =?iso-8859-1?Q?C=2E_S=E1nchez?=)
Date: Mon Mar 26 10:12:57 2007
Subject: [mod_python] how to use Mysql on mod_python+apache?
In-Reply-To: <200703261055.52241.fred@urlbit.us>
References: <22935d070703260031l6c64758embb1aa8d310d2cbd9@mail.gmail.com>
	<20070326140745.GA31497@santiago.connexer.com>
	<200703261055.52241.fred@urlbit.us>
Message-ID: <20070326151252.GE31497@santiago.connexer.com>

On Mon, Mar 26, 2007 at 10:55:51AM -0400, Fred of UrlBit.Us wrote:
> On Monday 26 March 2007 10:07, Roberto C. S?nchez uttered thusly:
> 
> > Perhaps you should ask on a MySQL list?  BTW, you really should be using
> > a real database (as in anything other than MySQL).
> 
> Flame bait-r-us!
> 
It is not intended that way.  The OP appears to be a newbie (at least
his post came across that way).  Given the more than amply documented
deficiencies in MySQL, it is not advisable for a newbie to get started
with.  In fact, I would argue that only the most experienced
professionals should be the ones to decide when MySQL is appropriate.
(I don't even put myself in that category, since I wouldn't know how to
properly deal with MySQL's manifold shortcomings).

Regards,

-Roberto

-- 
Roberto C. S?nchez
http://people.connexer.com/~roberto
http://www.connexer.com
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070326/188b9795/attachment.bin
From graham.dumpleton at gmail.com  Mon Mar 26 17:09:58 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Mar 26 17:10:09 2007
Subject: [mod_python] connection to host server broken
In-Reply-To: <40463.14148.qm@web38707.mail.mud.yahoo.com>
References: <88e286470703231420u38af5335wf1c7515b12aff1bc@mail.gmail.com>
	<40463.14148.qm@web38707.mail.mud.yahoo.com>
Message-ID: <88e286470703261509y17e64269g6f9aa0888570bfdf@mail.gmail.com>

On 26/03/07, sikander hayat <hayat221@yahoo.com> wrote:
> Hi,
>
> I am using suse 10.1, Apache 2.2.4, python 2.5 and mod_python 3.3.1.
>
> The error log is as follows:
> [Mon Mar 26 10:16:48 2007] [warn] RSA server certificate is a CA certificate
> (BasicConstraints: CA == TRUE !?)
> [Mon Mar 26 10:16:48 2007] [warn] RSA server certificate CommonName (CN)
> `localhost' does NOT match server name!?
> [Mon Mar 26 10:16:48 2007] [notice] mod_python: Creating 8 session mutexes
> based on 256 max processes and 0 max threads.
> [Mon Mar 26 10:16:48 2007] [notice] mod_python: using mutex_directory /tmp
> [Mon Mar 26 10:16:48 2007] [notice] Apache/2.2.4 (Unix) DAV/2 mod_ssl/2.2.4
> OpenSSL/0.9.8d mod_python/3.3.1 Python/2.5 PHP/5.2.1
> mod_apreq2-20051231/2.5.7 m
> od_perl/2.0.2 Perl/v5.8.7 configured -- resuming normal operations
> [Mon Mar 26 10:17:04 2007] [error] [client 134.96.24.83] File does not
> exist: /opt/lampp/htdocs/favicon.ico
> [Mon Mar 26 10:17:35 2007] [notice] mod_python (pid=3230,
> interpreter='localhost'): Importing module
> '/opt/lampp/htdocs/parkweb/index.py'
> [Mon Mar 26 10:17:35 2007] [notice] mod_python (pid=3231,
> interpreter='localhost'): Importing module
> '/opt/lampp/htdocs/parkweb/index.py'
> [Mon Mar 26 10:17:36 2007] [notice] child pid 3230 exit signal Segmentation
> fault (11)
> [Mon Mar 26 10:17:36 2007] [notice] child pid 3231 exit signal Segmentation
> fault (11)
>
> I have recently upgraded to python 2.5. So, to say, i have 2 versions of
> python on my system. Will try to remove the older one and try again.

To confirm whether that is necessary, set:

  PythonHandler mod_python.testhandler

In the output from that just verify that the sys.path information is
correct for the version of Python you expect to use. From the above
log entries there probably isn't a problem with versions as mod_python
will actually log some warnings if it finds a different version of
Python than what it was compiled with and that isn't in the log
entries.

> ****Why is it loading the module twice ...is that normal ???

Note how the 'pid' is different for each. This means that there were
two requests and that they so happened to be handled by different
Apache child processes.

> Kindly let me know if something rings a bell.

Since you are using Python 2.5, it should not be the expat version
problem as Python 2.5 is supposed to change things to avoid that one.
I would though still suspect that it is some versioning problem with
shared libraries. For example, if your web application uses some sort
of database and you also have PHP loaded and it is using some
different version of the database client library. This sort of
mismatch can cause a crash as one library will take precedence over
the other and if they are not compatible it can crash.

What you may need to do is start adding debug into your code and the
framework it uses such that you output a log message before and after
every module import. For example:

  from mod_python import apache

  apache.log_error(__file__  + " #1")
  import pyexpat
  apache.log_error(__file__ + " #2")
  import module2
  apache.log_error(__file__ + " #3")

See how many of the messages come out in the Apache error log and slow
narrow it down to a specific module being importer causing the crash.

If the module imports aren't the problem but something in handler
itself, do something similar, logging messages to the Apache log until
you find exactly what call causes it.

Graham

> Thanks,
>
>
> Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
>  On 24/03/07, Jim Gallacher wrote:
> > sikander hayat wrote:
> > > Hi all,
> > >
> > > My apache webserver on linux recently broke down, so i reinstalled it,
> along with mod_python. Having made the necessary changes in the conf file of
> apache, i tried some of the simple tests, such as mptest, but i keep on
> getting the following error.
> > >
> > > Connection to host server ... lost.
> > >
> > > Why is that, is it because of python or some apache setting.
> >
> > Or network problems?
> >
> > What do you find in your apache logs?
>
> The Apache error log would be a good start, as it looks to me like
> your Apache child processes are crashing. You may find errors about
> segmentation violations or similar in the logs. If you do, check that
> the version of mod_python you are using is the correct one for the
> version of Python and Apache you are using. Having multiple versions
> of Python installed can also cause issues.
>
> BTW, are you using precompiled packages or compiling everything from
> source code? What operating system are you using?
>
> Graham
>
>
>
>  ________________________________
> Sucker-punch spam with award-winning protection.
>  Try the free Yahoo! Mail Beta.
>
>
From scarfboy at gmail.com  Tue Mar 27 03:06:16 2007
From: scarfboy at gmail.com (Bart)
Date: Tue Mar 27 03:06:25 2007
Subject: [mod_python] how to use Mysql on mod_python+apache?
In-Reply-To: <20070326151252.GE31497@santiago.connexer.com>
References: <22935d070703260031l6c64758embb1aa8d310d2cbd9@mail.gmail.com>
	<20070326140745.GA31497@santiago.connexer.com>
	<200703261055.52241.fred@urlbit.us>
	<20070326151252.GE31497@santiago.connexer.com>
Message-ID: <b71082d80703270106x7d8051afwe336ec136bde8abb@mail.gmail.com>

On 3/26/07, Roberto C. S?nchez <roberto@connexer.com> wrote:
> On Mon, Mar 26, 2007 at 10:55:51AM -0400, Fred of UrlBit.Us wrote:
> > On Monday 26 March 2007 10:07, Roberto C. S?nchez uttered thusly:
> >
> > > Perhaps you should ask on a MySQL list?  BTW, you really should be using
> > > a real database (as in anything other than MySQL).
> >
> > Flame bait-r-us!
> >
> It is not intended that way.  The OP appears to be a newbie (at least
> his post came across that way).  Given the more than amply documented
> deficiencies in MySQL, it is not advisable for a newbie to get started
> with.  In fact, I would argue that only the most experienced
> professionals should be the ones to decide when MySQL is appropriate.
> (I don't even put myself in that category, since I wouldn't know how to
> properly deal with MySQL's manifold shortcomings).

Sounds accurate enough, except I consider them unnecessary quirks
instead of shortcomings.   I recently gave MySQL a real chance
(in a real app) and yes, you can work with/around all the quirks, but it's
stupid that you have to *know* about (read:trip over) all of them first -
what are RDBMSes for if not the convenience, y'know?
(Not speed, for one, and yet that seems the reason for many of
 MySQL's oddities, which is the reason I have trouble taking it seriously)

But talking about convenience: phpmyadmin is useful, while phppgadmin
is currently hopeless, which is relevant to database servers you don't have
admin control over, since they're typically a pain to poke around.
I've been using postgres for almost all serious things, but for my quick
proof-of-concept projects even on my own server I use mysql
because of just this.

Back to the list/subject:
'course, the MySQLdb module has an annoying quirk in unicode behaviour
until recent versions. I had to write a wrapper around it or have it bork on
still semi-current versions.

I believe SQLObject does some similar wrapping, by the way.

--Bart

From roberto at connexer.com  Tue Mar 27 05:42:03 2007
From: roberto at connexer.com (Roberto =?iso-8859-1?Q?C=2E_S=E1nchez?=)
Date: Tue Mar 27 05:42:07 2007
Subject: [mod_python] how to use Mysql on mod_python+apache?
In-Reply-To: <b71082d80703270106x7d8051afwe336ec136bde8abb@mail.gmail.com>
References: <22935d070703260031l6c64758embb1aa8d310d2cbd9@mail.gmail.com>
	<20070326140745.GA31497@santiago.connexer.com>
	<200703261055.52241.fred@urlbit.us>
	<20070326151252.GE31497@santiago.connexer.com>
	<b71082d80703270106x7d8051afwe336ec136bde8abb@mail.gmail.com>
Message-ID: <20070327104203.GA20241@santiago.connexer.com>

On Tue, Mar 27, 2007 at 10:06:16AM +0200, Bart wrote:
> 
> Sounds accurate enough, except I consider them unnecessary quirks
> instead of shortcomings.   I recently gave MySQL a real chance
> (in a real app) and yes, you can work with/around all the quirks, but it's
> stupid that you have to *know* about (read:trip over) all of them first -
> what are RDBMSes for if not the convenience, y'know?
> (Not speed, for one, and yet that seems the reason for many of
> MySQL's oddities, which is the reason I have trouble taking it seriously)
> 
Sorry, but accepting invalid input without error, truncating overly long
input and clipping overflowed numbers are not "quirks".  They are
serious data integrity issues.  Think about it.  If you develop multiple
applications (by different teams or developers) against the same MySQL
database, the *only* assurance that you have that your data won't get
hosed is that *every* developer implements the proper data integrity
checks in the application layer.  That is wrong on so many levels it is
not evn funny.

> But talking about convenience: phpmyadmin is useful, while phppgadmin
> is currently hopeless, which is relevant to database servers you don't have
> admin control over, since they're typically a pain to poke around.
> I've been using postgres for almost all serious things, but for my quick
> proof-of-concept projects even on my own server I use mysql
> because of just this.
> 
That's fine.  At least you aren't really using MySQL in production :-)

Out of curiousity, what specific shortcomings do you see in phppgadmin?
Have you tried pgadminIII?

I've used both phppgadmin and phpmyadmin and found both to be adequate
tools.

> Back to the list/subject:
> 'course, the MySQLdb module has an annoying quirk in unicode behaviour
> until recent versions. I had to write a wrapper around it or have it bork on
> still semi-current versions.
> 
> I believe SQLObject does some similar wrapping, by the way.
> 
Regards,

-Roberto

-- 
Roberto C. S?nchez
http://people.connexer.com/~roberto
http://www.connexer.com
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070327/5a6e5cc0/attachment.bin
From hayat221 at yahoo.com  Tue Mar 27 10:44:06 2007
From: hayat221 at yahoo.com (sikander hayat)
Date: Tue Mar 27 10:44:16 2007
Subject: [SPAM] Re: [mod_python] connection to host server broken
In-Reply-To: <88e286470703261509y17e64269g6f9aa0888570bfdf@mail.gmail.com>
Message-ID: <284175.5100.qm@web38709.mail.mud.yahoo.com>

Hi,

Thanks for your help. Just wanted to point out that, out of frustation, i installed mod_python 3.2.10 and discarded mod_python 3.3.1 and magically it all works fine !!!

What I would like to conclude from this is, that there might be some dependency in 3.3.1 that caused havoc...(atleast for me). As pointed out previously, 3.3.1 constantly kept on giving the following errors:

child pid 28468 exit signal Segmentation fault (11)
[Tue Mar 27 17:26:14 2007] [notice] child pid 28469 exit signal Segmentation fault (11)
[Tue Mar 27 17:26:40 2007] [error] [client 134.96.24.83] File does not exist: /opt/lampp/htdocs/favicon.ico
[Tue Mar 27 17:29:21 2007] [error] [client 134.96.24.83] File does not exist: /opt/lampp/htdocs/favicon.ico


Why this segmentation error with 3.3.1 and also, i had nothing to do with this favicon.ico. I do not have this icon and do not intend to make one. Why and which process needs this icon... *wondering*

Thanks,
Sikander


Graham Dumpleton <graham.dumpleton@gmail.com> wrote: On 26/03/07, sikander hayat  wrote:
> Hi,
>
> I am using suse 10.1, Apache 2.2.4, python 2.5 and mod_python 3.3.1.
>
> The error log is as follows:
> [Mon Mar 26 10:16:48 2007] [warn] RSA server certificate is a CA certificate
> (BasicConstraints: CA == TRUE !?)
> [Mon Mar 26 10:16:48 2007] [warn] RSA server certificate CommonName (CN)
> `localhost' does NOT match server name!?
> [Mon Mar 26 10:16:48 2007] [notice] mod_python: Creating 8 session mutexes
> based on 256 max processes and 0 max threads.
> [Mon Mar 26 10:16:48 2007] [notice] mod_python: using mutex_directory /tmp
> [Mon Mar 26 10:16:48 2007] [notice] Apache/2.2.4 (Unix) DAV/2 mod_ssl/2.2.4
> OpenSSL/0.9.8d mod_python/3.3.1 Python/2.5 PHP/5.2.1
> mod_apreq2-20051231/2.5.7 m
> od_perl/2.0.2 Perl/v5.8.7 configured -- resuming normal operations
> [Mon Mar 26 10:17:04 2007] [error] [client 134.96.24.83] File does not
> exist: /opt/lampp/htdocs/favicon.ico
> [Mon Mar 26 10:17:35 2007] [notice] mod_python (pid=3230,
> interpreter='localhost'): Importing module
> '/opt/lampp/htdocs/parkweb/index.py'
> [Mon Mar 26 10:17:35 2007] [notice] mod_python (pid=3231,
> interpreter='localhost'): Importing module
> '/opt/lampp/htdocs/parkweb/index.py'
> [Mon Mar 26 10:17:36 2007] [notice] child pid 3230 exit signal Segmentation
> fault (11)
> [Mon Mar 26 10:17:36 2007] [notice] child pid 3231 exit signal Segmentation
> fault (11)
>
> I have recently upgraded to python 2.5. So, to say, i have 2 versions of
> python on my system. Will try to remove the older one and try again.

To confirm whether that is necessary, set:

  PythonHandler mod_python.testhandler

In the output from that just verify that the sys.path information is
correct for the version of Python you expect to use. From the above
log entries there probably isn't a problem with versions as mod_python
will actually log some warnings if it finds a different version of
Python than what it was compiled with and that isn't in the log
entries.

> ****Why is it loading the module twice ...is that normal ???

Note how the 'pid' is different for each. This means that there were
two requests and that they so happened to be handled by different
Apache child processes.

> Kindly let me know if something rings a bell.

Since you are using Python 2.5, it should not be the expat version
problem as Python 2.5 is supposed to change things to avoid that one.
I would though still suspect that it is some versioning problem with
shared libraries. For example, if your web application uses some sort
of database and you also have PHP loaded and it is using some
different version of the database client library. This sort of
mismatch can cause a crash as one library will take precedence over
the other and if they are not compatible it can crash.

What you may need to do is start adding debug into your code and the
framework it uses such that you output a log message before and after
every module import. For example:

  from mod_python import apache

  apache.log_error(__file__  + " #1")
  import pyexpat
  apache.log_error(__file__ + " #2")
  import module2
  apache.log_error(__file__ + " #3")

See how many of the messages come out in the Apache error log and slow
narrow it down to a specific module being importer causing the crash.

If the module imports aren't the problem but something in handler
itself, do something similar, logging messages to the Apache log until
you find exactly what call causes it.

Graham

> Thanks,
>
>
> Graham Dumpleton  wrote:
>  On 24/03/07, Jim Gallacher wrote:
> > sikander hayat wrote:
> > > Hi all,
> > >
> > > My apache webserver on linux recently broke down, so i reinstalled it,
> along with mod_python. Having made the necessary changes in the conf file of
> apache, i tried some of the simple tests, such as mptest, but i keep on
> getting the following error.
> > >
> > > Connection to host server ... lost.
> > >
> > > Why is that, is it because of python or some apache setting.
> >
> > Or network problems?
> >
> > What do you find in your apache logs?
>
> The Apache error log would be a good start, as it looks to me like
> your Apache child processes are crashing. You may find errors about
> segmentation violations or similar in the logs. If you do, check that
> the version of mod_python you are using is the correct one for the
> version of Python and Apache you are using. Having multiple versions
> of Python installed can also cause issues.
>
> BTW, are you using precompiled packages or compiling everything from
> source code? What operating system are you using?
>
> Graham
>
>
>
>  ________________________________
> Sucker-punch spam with award-winning protection.
>  Try the free Yahoo! Mail Beta.
>
>


 
---------------------------------
The fish are biting.
 Get more visitors on your site using Yahoo! Search Marketing.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070327/562c6cae/attachment-0001.html
From jpg at jgassociates.ca  Tue Mar 27 13:38:29 2007
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Tue Mar 27 13:36:04 2007
Subject: [SPAM] Re: [mod_python] connection to host server broken
In-Reply-To: <284175.5100.qm@web38709.mail.mud.yahoo.com>
References: <284175.5100.qm@web38709.mail.mud.yahoo.com>
Message-ID: <460964A5.7000302@jgassociates.ca>

sikander hayat wrote:
> Hi,
> 
> Thanks for your help. Just wanted to point out that, out of frustation, i installed mod_python 3.2.10 and discarded mod_python 3.3.1 and magically it all works fine !!!
> 
> What I would like to conclude from this is, that there might be some dependency in 3.3.1 that caused havoc...(atleast for me). As pointed out previously, 3.3.1 constantly kept on giving the following errors:
> 
> child pid 28468 exit signal Segmentation fault (11)
> [Tue Mar 27 17:26:14 2007] [notice] child pid 28469 exit signal Segmentation fault (11)
> [Tue Mar 27 17:26:40 2007] [error] [client 134.96.24.83] File does not exist: /opt/lampp/htdocs/favicon.ico
> [Tue Mar 27 17:29:21 2007] [error] [client 134.96.24.83] File does not exist: /opt/lampp/htdocs/favicon.ico
> 
> 
> Why this segmentation error with 3.3.1 

Obviously we'd like to sort out why 3.3.1 is segfaulting. Did you try 
Graham's suggestion of doing:

  PythonHandler mod_python.testhandler

and still get a segfault? If not, can you either try it, or share the 
contents of you index.py file that caused the problem?

> and also, i had nothing to do with this favicon.ico. I do not have this icon and
 > do not intend to make one. Why and which process needs this icon... 
*wondering*

This has nothing to do with mod_python. It's your browser that is 
requesting favicon.ico. You don't have one and apache logs that fact, 
and is standard behaviour for a missing file. If you don't intend to 
create one you better get used to having your error logs clogged with 
this message, as I believe some (all?) modern browsers automatically 
request it.

Jim

> Thanks,
> Sikander
> 
> 
> Graham Dumpleton <graham.dumpleton@gmail.com> wrote: On 26/03/07, sikander hayat  wrote:
>> Hi,
>>
>> I am using suse 10.1, Apache 2.2.4, python 2.5 and mod_python 3.3.1.
>>
>> The error log is as follows:
>> [Mon Mar 26 10:16:48 2007] [warn] RSA server certificate is a CA certificate
>> (BasicConstraints: CA == TRUE !?)
>> [Mon Mar 26 10:16:48 2007] [warn] RSA server certificate CommonName (CN)
>> `localhost' does NOT match server name!?
>> [Mon Mar 26 10:16:48 2007] [notice] mod_python: Creating 8 session mutexes
>> based on 256 max processes and 0 max threads.
>> [Mon Mar 26 10:16:48 2007] [notice] mod_python: using mutex_directory /tmp
>> [Mon Mar 26 10:16:48 2007] [notice] Apache/2.2.4 (Unix) DAV/2 mod_ssl/2.2.4
>> OpenSSL/0.9.8d mod_python/3.3.1 Python/2.5 PHP/5.2.1
>> mod_apreq2-20051231/2.5.7 m
>> od_perl/2.0.2 Perl/v5.8.7 configured -- resuming normal operations
>> [Mon Mar 26 10:17:04 2007] [error] [client 134.96.24.83] File does not
>> exist: /opt/lampp/htdocs/favicon.ico
>> [Mon Mar 26 10:17:35 2007] [notice] mod_python (pid=3230,
>> interpreter='localhost'): Importing module
>> '/opt/lampp/htdocs/parkweb/index.py'
>> [Mon Mar 26 10:17:35 2007] [notice] mod_python (pid=3231,
>> interpreter='localhost'): Importing module
>> '/opt/lampp/htdocs/parkweb/index.py'
>> [Mon Mar 26 10:17:36 2007] [notice] child pid 3230 exit signal Segmentation
>> fault (11)
>> [Mon Mar 26 10:17:36 2007] [notice] child pid 3231 exit signal Segmentation
>> fault (11)
>>
>> I have recently upgraded to python 2.5. So, to say, i have 2 versions of
>> python on my system. Will try to remove the older one and try again.
> 
> To confirm whether that is necessary, set:
> 
>   PythonHandler mod_python.testhandler
> 
> In the output from that just verify that the sys.path information is
> correct for the version of Python you expect to use. From the above
> log entries there probably isn't a problem with versions as mod_python
> will actually log some warnings if it finds a different version of
> Python than what it was compiled with and that isn't in the log
> entries.
> 
>> ****Why is it loading the module twice ...is that normal ???
> 
> Note how the 'pid' is different for each. This means that there were
> two requests and that they so happened to be handled by different
> Apache child processes.
> 
>> Kindly let me know if something rings a bell.
> 
> Since you are using Python 2.5, it should not be the expat version
> problem as Python 2.5 is supposed to change things to avoid that one.
> I would though still suspect that it is some versioning problem with
> shared libraries. For example, if your web application uses some sort
> of database and you also have PHP loaded and it is using some
> different version of the database client library. This sort of
> mismatch can cause a crash as one library will take precedence over
> the other and if they are not compatible it can crash.
> 
> What you may need to do is start adding debug into your code and the
> framework it uses such that you output a log message before and after
> every module import. For example:
> 
>   from mod_python import apache
> 
>   apache.log_error(__file__  + " #1")
>   import pyexpat
>   apache.log_error(__file__ + " #2")
>   import module2
>   apache.log_error(__file__ + " #3")
> 
> See how many of the messages come out in the Apache error log and slow
> narrow it down to a specific module being importer causing the crash.
> 
> If the module imports aren't the problem but something in handler
> itself, do something similar, logging messages to the Apache log until
> you find exactly what call causes it.
> 
> Graham
> 
>> Thanks,
>>
>>
>> Graham Dumpleton  wrote:
>>  On 24/03/07, Jim Gallacher wrote:
>>> sikander hayat wrote:
>>>> Hi all,
>>>>
>>>> My apache webserver on linux recently broke down, so i reinstalled it,
>> along with mod_python. Having made the necessary changes in the conf file of
>> apache, i tried some of the simple tests, such as mptest, but i keep on
>> getting the following error.
>>>> Connection to host server ... lost.
>>>>
>>>> Why is that, is it because of python or some apache setting.
>>> Or network problems?
>>>
>>> What do you find in your apache logs?
>> The Apache error log would be a good start, as it looks to me like
>> your Apache child processes are crashing. You may find errors about
>> segmentation violations or similar in the logs. If you do, check that
>> the version of mod_python you are using is the correct one for the
>> version of Python and Apache you are using. Having multiple versions
>> of Python installed can also cause issues.
>>
>> BTW, are you using precompiled packages or compiling everything from
>> source code? What operating system are you using?
>>
>> Graham
>>
>>
>>
>>  ________________________________
>> Sucker-punch spam with award-winning protection.
>>  Try the free Yahoo! Mail Beta.
>>
>>
> 
> 
>  
> ---------------------------------
> The fish are biting.
>  Get more visitors on your site using Yahoo! Search Marketing.
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From fidita48 at hotmail.com  Tue Mar 27 16:00:39 2007
From: fidita48 at hotmail.com (=?iso-8859-1?B?SWRvaWEgVmlsbGFjaeFuIFrhcmF0ZQ==?=)
Date: Tue Mar 27 16:00:48 2007
Subject: [mod_python] [SPAM] Hello
In-Reply-To: <mailman.5355.1175028917.9441.mod_python@modpython.org>
Message-ID: <BAY137-F15E1CC1D3EACE122E13396D46E0@phx.gbl>

An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070327/859624ca/attachment.html
From graham.dumpleton at gmail.com  Tue Mar 27 16:56:34 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Mar 27 16:56:39 2007
Subject: [mod_python] [SPAM] Hello
In-Reply-To: <BAY137-F15E1CC1D3EACE122E13396D46E0@phx.gbl>
References: <mailman.5355.1175028917.9441.mod_python@modpython.org>
	<BAY137-F15E1CC1D3EACE122E13396D46E0@phx.gbl>
Message-ID: <88e286470703271456w544c2e3bt8fc84cd2522e5a14@mail.gmail.com>

You probably haven't configured Apache correctly and it is trying to
run your script as a CGI script and not a mod_python application.

Try procedure and checks detailed in:

  http://www.dscpl.com.au/wiki/ModPython/Articles/GettingModPythonWorking

Check your Apache error logs to ensure that mod_python is loading correctly.

Good idea to upgrade to mod_python 3.3.1 one as it is much more stable
and works better than the old version you have.

Graham

On 28/03/07, Idoia Villaci?n Z?rate <fidita48@hotmail.com> wrote:
>
>
> Hello:
>
> I have a one problem,when I compiled this program in Python
>
> from mod_python import apache
> def handler(req):
>         req.content_type = 'text/plain'
>         req.write("Hello World!")
>         return apache.OK
>
> It leaves following error to me:
>
> Traceback (most recent call last):
>   File "C:\Archivos de programa\Apache
> Group\Apache2\htdocs\mywebdir\mptest.py", line 1, in
> <module>
>     from mod_python import apache
>   File
> "C:\Python25\Lib\site-packages\mod_python\apache.py", line
> 30, in <module>
>     import _apache
> ImportError: No module named _apache
>
> I saw an other pages the error can be by the version,but my versions are
> compatible,I have mod_python 3.1,apache 2.0.59 and python2.5. If somebody
> can help me, thanks
> ________________________________
> Recibe ofertas de empleo adaptadas a tu perfil. Introduce tu CV en MSN
> Empleo.
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>

From dm at ling.ohio-state.edu  Tue Mar 27 18:10:31 2007
From: dm at ling.ohio-state.edu (Detmar Meurers)
Date: Tue Mar 27 18:10:36 2007
Subject: [mod_python] session variable value (partially) dissapearing
Message-ID: <20070327231031.GA10254@ling.ohio-state.edu>

Hi,

I'm experiencing some strange behavior with mod_python sessions
(using the mod_python Session module, which in my setup seems to use
dbm). I'm using Apache/2.2.0 (Unix) mod_ssl/2.2.0 OpenSSL/0.9.8b DAV/2
mod_python/3.3.1 Python/2.4.2 on an Intel Mac (mpm-prefork).

I can store information in the session variable, which I've stored
under req.session, just fine, e.g.

req.session['rememberme'] = 'foobar'

but for some reason in situations I haven't been able to pin down
yet, when I store more complex information, e.g. a dictionary such as

req.session['rememberme'] = {'name' : 'john', 
                             'address': {'road': 'high st',
			                 'nr': 22}}
					 
then often times part of that dictionary value has disappeared when
I look it up again in a later page, e.g. I get a dictionary
containing only the key 'name' instead of both keys. I unfortunately
haven't been able to pin it down further yet (apart from observing
that it seems to appear primarily (?) in situations involving AJAX
POST calls). 

Has someone has seen something like this before? Any hints on what
can cause the disappearance of part of a session variable value? Or
perhaps it for some reason doesnn't read in the session variable
properly in some of the mod_python processes running? Any hints
would be much appreciated!

Best,
Detmar

--
Detmar Meurers, Associate Professor, Dept. of Linguistics, OSU
201a Oxley Hall, 1712 Neil Avenue, Columbus OH 43210-1298, USA
http://ling.osu.edu/~dm/                 GnuPG key on web page
From graham.dumpleton at gmail.com  Tue Mar 27 18:23:03 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Mar 27 18:23:06 2007
Subject: [mod_python] session variable value (partially) dissapearing
In-Reply-To: <20070327231031.GA10254@ling.ohio-state.edu>
References: <20070327231031.GA10254@ling.ohio-state.edu>
Message-ID: <88e286470703271623m356eaa43i804150a6f3c62e01@mail.gmail.com>

Only suggestion is to doubly make sure that you are doing the required
req.session.save() before the request actually returns. If you are
using:

  raise apache.SERVER_RETURN, apache.OK

or similar mechanisms whereby you are using exceptions to jump back up
calling stack in non error conditions, ensure you have try/finally
block where save is being done in finally block.

You might log a message at every point you do a save to ensure it is
always happening as you expect.

You might also try FileSession instead of DBMSession. See
documentation for PythonOption to override which storage mechanism is
used. This will indicate whether it is just somehow DBM database or
all storage mechanisms.

BTW, you aren't every performing an unlock() of session at any point are you?

Graham

On 28/03/07, Detmar Meurers <dm@ling.ohio-state.edu> wrote:
> Hi,
>
> I'm experiencing some strange behavior with mod_python sessions
> (using the mod_python Session module, which in my setup seems to use
> dbm). I'm using Apache/2.2.0 (Unix) mod_ssl/2.2.0 OpenSSL/0.9.8b DAV/2
> mod_python/3.3.1 Python/2.4.2 on an Intel Mac (mpm-prefork).
>
> I can store information in the session variable, which I've stored
> under req.session, just fine, e.g.
>
> req.session['rememberme'] = 'foobar'
>
> but for some reason in situations I haven't been able to pin down
> yet, when I store more complex information, e.g. a dictionary such as
>
> req.session['rememberme'] = {'name' : 'john',
>                              'address': {'road': 'high st',
>                                          'nr': 22}}
>
> then often times part of that dictionary value has disappeared when
> I look it up again in a later page, e.g. I get a dictionary
> containing only the key 'name' instead of both keys. I unfortunately
> haven't been able to pin it down further yet (apart from observing
> that it seems to appear primarily (?) in situations involving AJAX
> POST calls).
>
> Has someone has seen something like this before? Any hints on what
> can cause the disappearance of part of a session variable value? Or
> perhaps it for some reason doesnn't read in the session variable
> properly in some of the mod_python processes running? Any hints
> would be much appreciated!
>
> Best,
> Detmar
>
> --
> Detmar Meurers, Associate Professor, Dept. of Linguistics, OSU
> 201a Oxley Hall, 1712 Neil Avenue, Columbus OH 43210-1298, USA
> http://ling.osu.edu/~dm/                 GnuPG key on web page
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From dm at ling.ohio-state.edu  Tue Mar 27 20:29:09 2007
From: dm at ling.ohio-state.edu (Detmar Meurers)
Date: Tue Mar 27 19:29:54 2007
Subject: [mod_python] session variable value (partially) dissapearing
In-Reply-To: <88e286470703271623m356eaa43i804150a6f3c62e01@mail.gmail.com>
References: <20070327231031.GA10254@ling.ohio-state.edu>
	<88e286470703271623m356eaa43i804150a6f3c62e01@mail.gmail.com>
Message-ID: <20070328012909.GA15833@ling.ohio-state.edu>

Hi Graham,

Thanks for the very quick reply.

The page showing the problem actually is using the publisher handler
(so no special exception handling etc.)

I tried the FileSession and the problem occurs there too - and I'm
not doing any calling of unlock().

I am calling req.session.save() - one question about that though:
Can it possibly cause problems when calling the save() several times
when handling one request?

I'll do some more thorough logging and will report if I find out
what's causing this.

Best,
Detmar



On Wed, Mar 28, 2007 at 09:23:03AM +1000, Graham Dumpleton wrote:
    Only suggestion is to doubly make sure that you are doing the required
    req.session.save() before the request actually returns. If you are
    using:
    
     raise apache.SERVER_RETURN, apache.OK
    
    or similar mechanisms whereby you are using exceptions to jump back up
    calling stack in non error conditions, ensure you have try/finally
    block where save is being done in finally block.
    
    You might log a message at every point you do a save to ensure it is
    always happening as you expect.
    
    You might also try FileSession instead of DBMSession. See
    documentation for PythonOption to override which storage mechanism is
    used. This will indicate whether it is just somehow DBM database or
    all storage mechanisms.
    
    BTW, you aren't every performing an unlock() of session at any point are 
    you?
    
    Graham
    
    On 28/03/07, Detmar Meurers <dm@ling.ohio-state.edu> wrote:
    >Hi,
    >
    >I'm experiencing some strange behavior with mod_python sessions
    >(using the mod_python Session module, which in my setup seems to use
    >dbm). I'm using Apache/2.2.0 (Unix) mod_ssl/2.2.0 OpenSSL/0.9.8b DAV/2
    >mod_python/3.3.1 Python/2.4.2 on an Intel Mac (mpm-prefork).
    >
    >I can store information in the session variable, which I've stored
    >under req.session, just fine, e.g.
    >
    >req.session['rememberme'] = 'foobar'
    >
    >but for some reason in situations I haven't been able to pin down
    >yet, when I store more complex information, e.g. a dictionary such as
    >
    >req.session['rememberme'] = {'name' : 'john',
    >                             'address': {'road': 'high st',
    >                                         'nr': 22}}
    >
    >then often times part of that dictionary value has disappeared when
    >I look it up again in a later page, e.g. I get a dictionary
    >containing only the key 'name' instead of both keys. I unfortunately
    >haven't been able to pin it down further yet (apart from observing
    >that it seems to appear primarily (?) in situations involving AJAX
    >POST calls).
    >
    >Has someone has seen something like this before? Any hints on what
    >can cause the disappearance of part of a session variable value? Or
    >perhaps it for some reason doesnn't read in the session variable
    >properly in some of the mod_python processes running? Any hints
    >would be much appreciated!
    >
    >Best,
    >Detmar
    >
    >--
    >Detmar Meurers, Associate Professor, Dept. of Linguistics, OSU
    >201a Oxley Hall, 1712 Neil Avenue, Columbus OH 43210-1298, USA
    >http://ling.osu.edu/~dm/                 GnuPG key on web page
    >_______________________________________________
    >Mod_python mailing list
    >Mod_python@modpython.org
    >http://mailman.modpython.org/mailman/listinfo/mod_python
    >

-- 
--
Detmar Meurers, Associate Professor, Dept. of Linguistics, OSU
201a Oxley Hall, 1712 Neil Avenue, Columbus OH 43210-1298, USA
http://ling.osu.edu/~dm/                 GnuPG key on web page
From jpg at jgassociates.ca  Tue Mar 27 19:59:48 2007
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Tue Mar 27 19:54:26 2007
Subject: [mod_python] session variable value (partially) dissapearing
In-Reply-To: <20070328012909.GA15833@ling.ohio-state.edu>
References: <20070327231031.GA10254@ling.ohio-state.edu>	<88e286470703271623m356eaa43i804150a6f3c62e01@mail.gmail.com>
	<20070328012909.GA15833@ling.ohio-state.edu>
Message-ID: <4609BE04.2040300@jgassociates.ca>

Detmar Meurers wrote:
> Hi Graham,
> 
> Thanks for the very quick reply.
> 
> The page showing the problem actually is using the publisher handler
> (so no special exception handling etc.)
> 
> I tried the FileSession and the problem occurs there too - and I'm
> not doing any calling of unlock().
> 
> I am calling req.session.save() - one question about that though:
> Can it possibly cause problems when calling the save() several times
> when handling one request?

It shouldn't matter. The session store is locked so only one request can 
read or write at a time. This is the case even if you have session 
locking turned off, or unlock the session manually.

Jim
From hayat221 at yahoo.com  Wed Mar 28 03:11:29 2007
From: hayat221 at yahoo.com (sikander hayat)
Date: Wed Mar 28 03:11:33 2007
Subject: [mod_python] connection to host server broken
In-Reply-To: <460964A5.7000302@jgassociates.ca>
Message-ID: <829078.59411.qm@web38715.mail.mud.yahoo.com>

Hi,

I tried the testhandler and then looked at the first 100 entries of the error log and there it was...the segmentation fault. The code that i tried is as follows:

from mod_python import apache

import module2
apache.log_error(__file__ + " #3")

def handler(req):

        req.content_type = "text/plain"
        req.write("Hello World!")

        return apache.OK

Thanks
Sikander

Jim Gallacher <jpg@jgassociates.ca> wrote: sikander hayat wrote:
> Hi,
> 
> Thanks for your help. Just wanted to point out that, out of frustation, i installed mod_python 3.2.10 and discarded mod_python 3.3.1 and magically it all works fine !!!
> 
> What I would like to conclude from this is, that there might be some dependency in 3.3.1 that caused havoc...(atleast for me). As pointed out previously, 3.3.1 constantly kept on giving the following errors:
> 
> child pid 28468 exit signal Segmentation fault (11)
> [Tue Mar 27 17:26:14 2007] [notice] child pid 28469 exit signal Segmentation fault (11)
> [Tue Mar 27 17:26:40 2007] [error] [client 134.96.24.83] File does not exist: /opt/lampp/htdocs/favicon.ico
> [Tue Mar 27 17:29:21 2007] [error] [client 134.96.24.83] File does not exist: /opt/lampp/htdocs/favicon.ico
> 
> 
> Why this segmentation error with 3.3.1 

Obviously we'd like to sort out why 3.3.1 is segfaulting. Did you try 
Graham's suggestion of doing:

  PythonHandler mod_python.testhandler

and still get a segfault? If not, can you either try it, or share the 
contents of you index.py file that caused the problem?

> and also, i had nothing to do with this favicon.ico. I do not have this icon and
 > do not intend to make one. Why and which process needs this icon... 
*wondering*

This has nothing to do with mod_python. It's your browser that is 
requesting favicon.ico. You don't have one and apache logs that fact, 
and is standard behaviour for a missing file. If you don't intend to 
create one you better get used to having your error logs clogged with 
this message, as I believe some (all?) modern browsers automatically 
request it.

Jim

> Thanks,
> Sikander
> 
> 
> Graham Dumpleton  wrote: On 26/03/07, sikander hayat  wrote:
>> Hi,
>>
>> I am using suse 10.1, Apache 2.2.4, python 2.5 and mod_python 3.3.1.
>>
>> The error log is as follows:
>> [Mon Mar 26 10:16:48 2007] [warn] RSA server certificate is a CA certificate
>> (BasicConstraints: CA == TRUE !?)
>> [Mon Mar 26 10:16:48 2007] [warn] RSA server certificate CommonName (CN)
>> `localhost' does NOT match server name!?
>> [Mon Mar 26 10:16:48 2007] [notice] mod_python: Creating 8 session mutexes
>> based on 256 max processes and 0 max threads.
>> [Mon Mar 26 10:16:48 2007] [notice] mod_python: using mutex_directory /tmp
>> [Mon Mar 26 10:16:48 2007] [notice] Apache/2.2.4 (Unix) DAV/2 mod_ssl/2.2.4
>> OpenSSL/0.9.8d mod_python/3.3.1 Python/2.5 PHP/5.2.1
>> mod_apreq2-20051231/2.5.7 m
>> od_perl/2.0.2 Perl/v5.8.7 configured -- resuming normal operations
>> [Mon Mar 26 10:17:04 2007] [error] [client 134.96.24.83] File does not
>> exist: /opt/lampp/htdocs/favicon.ico
>> [Mon Mar 26 10:17:35 2007] [notice] mod_python (pid=3230,
>> interpreter='localhost'): Importing module
>> '/opt/lampp/htdocs/parkweb/index.py'
>> [Mon Mar 26 10:17:35 2007] [notice] mod_python (pid=3231,
>> interpreter='localhost'): Importing module
>> '/opt/lampp/htdocs/parkweb/index.py'
>> [Mon Mar 26 10:17:36 2007] [notice] child pid 3230 exit signal Segmentation
>> fault (11)
>> [Mon Mar 26 10:17:36 2007] [notice] child pid 3231 exit signal Segmentation
>> fault (11)
>>
>> I have recently upgraded to python 2.5. So, to say, i have 2 versions of
>> python on my system. Will try to remove the older one and try again.
> 
> To confirm whether that is necessary, set:
> 
>   PythonHandler mod_python.testhandler
> 
> In the output from that just verify that the sys.path information is
> correct for the version of Python you expect to use. From the above
> log entries there probably isn't a problem with versions as mod_python
> will actually log some warnings if it finds a different version of
> Python than what it was compiled with and that isn't in the log
> entries.
> 
>> ****Why is it loading the module twice ...is that normal ???
> 
> Note how the 'pid' is different for each. This means that there were
> two requests and that they so happened to be handled by different
> Apache child processes.
> 
>> Kindly let me know if something rings a bell.
> 
> Since you are using Python 2.5, it should not be the expat version
> problem as Python 2.5 is supposed to change things to avoid that one.
> I would though still suspect that it is some versioning problem with
> shared libraries. For example, if your web application uses some sort
> of database and you also have PHP loaded and it is using some
> different version of the database client library. This sort of
> mismatch can cause a crash as one library will take precedence over
> the other and if they are not compatible it can crash.
> 
> What you may need to do is start adding debug into your code and the
> framework it uses such that you output a log message before and after
> every module import. For example:
> 
>   from mod_python import apache
> 
>   apache.log_error(__file__  + " #1")
>   import pyexpat
>   apache.log_error(__file__ + " #2")
>   import module2
>   apache.log_error(__file__ + " #3")
> 
> See how many of the messages come out in the Apache error log and slow
> narrow it down to a specific module being importer causing the crash.
> 
> If the module imports aren't the problem but something in handler
> itself, do something similar, logging messages to the Apache log until
> you find exactly what call causes it.
> 
> Graham
> 
>> Thanks,
>>
>>
>> Graham Dumpleton  wrote:
>>  On 24/03/07, Jim Gallacher wrote:
>>> sikander hayat wrote:
>>>> Hi all,
>>>>
>>>> My apache webserver on linux recently broke down, so i reinstalled it,
>> along with mod_python. Having made the necessary changes in the conf file of
>> apache, i tried some of the simple tests, such as mptest, but i keep on
>> getting the following error.
>>>> Connection to host server ... lost.
>>>>
>>>> Why is that, is it because of python or some apache setting.
>>> Or network problems?
>>>
>>> What do you find in your apache logs?
>> The Apache error log would be a good start, as it looks to me like
>> your Apache child processes are crashing. You may find errors about
>> segmentation violations or similar in the logs. If you do, check that
>> the version of mod_python you are using is the correct one for the
>> version of Python and Apache you are using. Having multiple versions
>> of Python installed can also cause issues.
>>
>> BTW, are you using precompiled packages or compiling everything from
>> source code? What operating system are you using?
>>
>> Graham
>>
>>
>>
>>  ________________________________
>> Sucker-punch spam with award-winning protection.
>>  Try the free Yahoo! Mail Beta.
>>
>>
> 
> 
>  
> ---------------------------------
> The fish are biting.
>  Get more visitors on your site using Yahoo! Search Marketing.
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python



 
---------------------------------
Expecting? Get great news right away with email Auto-Check.
Try the Yahoo! Mail Beta.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070328/cdc2bbbb/attachment.html
From nlv11281 at natlab.research.philips.com  Wed Mar 28 05:02:14 2007
From: nlv11281 at natlab.research.philips.com (Mike Looijmans)
Date: Wed Mar 28 05:02:46 2007
Subject: [mod_python] how to use Mysql on mod_python+apache?
In-Reply-To: <20070327104203.GA20241@santiago.connexer.com>
References: <22935d070703260031l6c64758embb1aa8d310d2cbd9@mail.gmail.com>	<20070326140745.GA31497@santiago.connexer.com>	<200703261055.52241.fred@urlbit.us>	<20070326151252.GE31497@santiago.connexer.com>	<b71082d80703270106x7d8051afwe336ec136bde8abb@mail.gmail.com>
	<20070327104203.GA20241@santiago.connexer.com>
Message-ID: <460A3D26.2030806@natlab.research.philips.com>

This thread is going way of topic, but I'd really hate to see people being turned away from MySQL as 
a DB engine just because of the inaccuracies posted here.

I have several years of experience with many DBMSs, including Informix, Oracle, MS SQLServer, 
Postgress, MySQL and several others. MySQL is my favorite for (non-.NET) web applications, because 
of its scalability, performance, reliability, low maintenance and ease of use.

There are many DBMSs, each with their own pecularities, and none of them I would consider "bad" (or 
even "evil"). Which DBMS to chose for a particular task seems to become a matter of personal taste 
more everyday, because the more general offerings, like the ones I mentioned, all provide the same 
rich feature set (e.g. transactions, subqueries, stored procedures, outer joins). While I would not 
hesitate to recommend in favor of some of the databases I am familiar with, there is not one that i 
would ever tell people to "avoid at all cost". Even FoxPro has its uses.

> Sorry, but accepting invalid input without error, truncating overly long
> input and clipping overflowed numbers are not "quirks".

I agree so far.

>  They are serious data integrity issues.

I disagree here, because the issues you mentioned are configuration settings in MySQL. You can 
change the behaviour of the server in the config file. It is unfortunate that the default settings 
are not the ANSI ones. But you can make the MySQL DB comply to the more general standard of issuing 
an error on overflow and other forms of invalid input.

I suggest reading some documentation before proceeding on the subject.

> That's fine.  At least you aren't really using MySQL in production :-)

I have. On my previous assignment, the customer would loose about $10k per hour in lost machine time 
only (not even taking the engineers cost into account) if the MySQL database went offline. It did go 
offline once in that three year period i worked there - the power went down, the UPS failed and the 
operating system (Solaris) died a horrible dead along with the hard drive. When the power came up, I 
had its replacement up and running in about ten minutes, and no data was lost.


--
Mike Looijmans

From roberto at connexer.com  Wed Mar 28 07:36:29 2007
From: roberto at connexer.com (Roberto =?iso-8859-1?Q?C=2E_S=E1nchez?=)
Date: Wed Mar 28 07:36:34 2007
Subject: [mod_python] how to use Mysql on mod_python+apache?
In-Reply-To: <460A3D26.2030806@natlab.research.philips.com>
References: <22935d070703260031l6c64758embb1aa8d310d2cbd9@mail.gmail.com>
	<20070326140745.GA31497@santiago.connexer.com>
	<200703261055.52241.fred@urlbit.us>
	<20070326151252.GE31497@santiago.connexer.com>
	<b71082d80703270106x7d8051afwe336ec136bde8abb@mail.gmail.com>
	<20070327104203.GA20241@santiago.connexer.com>
	<460A3D26.2030806@natlab.research.philips.com>
Message-ID: <20070328123629.GA25284@santiago.connexer.com>

On Wed, Mar 28, 2007 at 12:02:14PM +0200, Mike Looijmans wrote:
> This thread is going way of topic, but I'd really hate to see people being 
> turned away from MySQL as a DB engine just because of the inaccuracies 
> posted here.
> 

I always welcome a good exchange :-)

> I have several years of experience with many DBMSs, including Informix, 
> Oracle, MS SQLServer, Postgress, MySQL and several others. MySQL is my 
> favorite for (non-.NET) web applications, because of its scalability, 
> performance, reliability, low maintenance and ease of use.
> 
> There are many DBMSs, each with their own pecularities, and none of them I 
> would consider "bad" (or even "evil"). Which DBMS to chose for a particular 
> task seems to become a matter of personal taste more everyday, because the 
> more general offerings, like the ones I mentioned, all provide the same 
> rich feature set (e.g. transactions, subqueries, stored procedures, outer 
> joins). While I would not hesitate to recommend in favor of some of the 
> databases I am familiar with, there is not one that i would ever tell 
> people to "avoid at all cost". Even FoxPro has its uses.
> 
I am only familiar with MySQL and PostgreSQL, so I cannot speak to the
others.  However, in MySQL if you have multiple tables involved in a
transactional query and even *just one* was created as
non-transactional, your *entire* transaction is no longer a transaction,
and MySQL doesn't give an error.  I consider that to be slightly more
than a "peculiarity."

> >Sorry, but accepting invalid input without error, truncating overly long
> >input and clipping overflowed numbers are not "quirks".
> 
> I agree so far.
> 
> > They are serious data integrity issues.
> 
> I disagree here, because the issues you mentioned are configuration 
> settings in MySQL. You can change the behaviour of the server in the config 
> file. It is unfortunate that the default settings are not the ANSI ones. 
> But you can make the MySQL DB comply to the more general standard of 
> issuing an error on overflow and other forms of invalid input.
> 
I'm sorry, but this just bogus.  Here are some things to consider:

 * "hose my data" should *never* be a valid configuration
 * many people fear changing the defaults since it breaks applications
   that are designed to work or tested only against the defaults

> I suggest reading some documentation before proceeding on the subject.
> 
I have.  For many years, the MySQL documentation presented nonsense
arguments against transactions and why they were bad.  Then, in a recent
version they finally introduced real transactional support and those
arguments went away, as in simply disappeared, from the documentation.

There are other examples, but that one alone has (at least in my eyes)
damaged the credibility of the MySQL developers quite badly.

> >That's fine.  At least you aren't really using MySQL in production :-)
> 
> I have. On my previous assignment, the customer would loose about $10k per 
> hour in lost machine time only (not even taking the engineers cost into 
> account) if the MySQL database went offline. It did go offline once in that 
> three year period i worked there - the power went down, the UPS failed and 
> the operating system (Solaris) died a horrible dead along with the hard 
> drive. When the power came up, I had its replacement up and running in 
> about ten minutes, and no data was lost.
> 
That sort of thing should be par for the course for *any* database.
Saying that MySQL can recover well from even a hardware problem (except
maybe for a complete hard disk failure) should be nothing special.

I understand that MySQL is useful.  I understand that it has its place.
However, I still maintain that it should not be the first thing
recommended to newbies (as it often is).  The reason is that its
"peculiarities" are actually often serious issues which newbies often
will not understand (if they are even aware of them in the first place).

If an expert (such as yourself) decides to use MySQL it is with full
knowledge of the situation which you are entering (that is, that you
must modify a host of configuration settings in order to get MySQL to
act more like a proper database).  Someone who is unaware of those
issues is likely to not understand why when he inserts an invalid date
or a number that is too large for its column his database ends up with
invalid or just plain wrong data.

Regards,

-Roberto

-- 
Roberto C. S?nchez
http://people.connexer.com/~roberto
http://www.connexer.com
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070328/89262f53/attachment-0001.bin
From graham.dumpleton at gmail.com  Wed Mar 28 17:05:19 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Mar 28 17:05:53 2007
Subject: [mod_python] Re: Hello
In-Reply-To: <BAY137-F186D4EEB6E3DFE34B46A87D46D0@phx.gbl>
References: <88e286470703271456w544c2e3bt8fc84cd2522e5a14@mail.gmail.com>
	<BAY137-F186D4EEB6E3DFE34B46A87D46D0@phx.gbl>
Message-ID: <88e286470703281505q2a9a6a34g2c3d16365c9503a1@mail.gmail.com>

On 29/03/07, Idoia Villaci?n Z?rate <fidita48@hotmail.com> wrote:
>
>
>
> Hello:
>
> I've looked the web you gave me, but I can't see anywhere how to change the
> configuration of my apache to choose the mod_python script instead of the
> CGI script. I also think that I have the lastest version od the mod_python
> (3.3.1). I'll be gratefull if you could help me or tell me how to resolve
> the problem.

Please use reply-all when responding, thus keeping the conversation on
the mod_python mailing list.

As to your problem, if you cannot ascertain from that document which
bits referred to how to configure Apache, then you need to perhaps
learn more about how to configure Apache and the language it uses to
refer to its directives and where to put them. On that I can only
suggest you go to the Apache documentation and start reading. Some
starting points are:

  http://httpd.apache.org/docs/2.2/
  http://httpd.apache.org/docs/2.2/configuring.html
  http://httpd.apache.org/docs/2.2/sections.html
  http://httpd.apache.org/docs/2.2/howto/cgi.html

Also refer to the mod_python documentation to learn about its own
specific configuration directives:

  http://www.modpython.org/live/current/doc-html/inst-testing.html
  http://www.modpython.org/live/current/doc-html/directives.html

Beyond that we can't really help since you haven't actually included
in your email what snippet of Apache configuration you think you are
using to enable mod_python use in the first place. Thus, cannot say
how it is wrong, or how it is conflicting with existing CGI
configuration in your setup.

The only thing we can tell you as we already have, is that error would
generally arise when your script is run as a CGI program and not
through mod_python. This is because the _apache module is a special
module not available from command line Python and is only available
when code is running inside of mod_python. That the module cannot be
found indicates the code isn't running under mod_python.

Oh, and please do not go sending your complete Apache configuration,
just those bits which would be relevant, such as the mod_python and
CGI sections.

Graham

From graham.dumpleton at gmail.com  Wed Mar 28 21:05:37 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Mar 28 21:05:43 2007
Subject: [mod_python] connection to host server broken
In-Reply-To: <829078.59411.qm@web38715.mail.mud.yahoo.com>
References: <460964A5.7000302@jgassociates.ca>
	<829078.59411.qm@web38715.mail.mud.yahoo.com>
Message-ID: <88e286470703281905t5e864819gc1f1f64f8d832fed@mail.gmail.com>

On 28/03/07, sikander hayat <hayat221@yahoo.com> wrote:
> Hi,
>
> I tried the testhandler and then looked at the first 100 entries of the
> error log and there it was...the segmentation fault.

Yes, but what did the first 100 entries say?

What are you actually saying here? Are you saying you triggered 100
requests of the handler and only then did your handler crash Apache,
or that there was simply 100 unrelated entries that preceded the crash
point, where the crash was the outcome of the very first request? I
would help that you actually posted from the log the entry for the
crash and anything just prior to that point that seems relevant.

It would also help that you post the snippet of your Apache
configuration so we can see how you have set it up to run mod_python
and what handler you might be triggering, whether it be your own or
one from mod_python such as publisher.

> The code that i tried
> is as follows:
>
> from mod_python import apache
>
> import module2

But what is in module2. Did you put log statements in module2 so as to
see what was run in there when import was done and how far it got.?

> apache.log_error(__file__ + " #3")
>
> def handler(req):
>
>         req.content_type = "text/plain"
>         req.write("Hello World!")
>
>         return apache.OK
>
> Thanks
> Sikander
>
> Jim Gallacher <jpg@jgassociates.ca> wrote:
>  sikander hayat wrote:
> > Hi,
> >
> > Thanks for your help. Just wanted to point out that, out of frustation, i
> installed mod_python 3.2.10 and discarded mod_python 3.3.1 and magically it
> all works fine !!!
> >
> > What I would like to conclude from this is, that there might be some
> dependency in 3.3.1 that caused havoc...(atleast for me). As pointed out
> previously, 3.3.1 constantly kept on giving the following errors:
> >
> > child pid 28468 exit signal Segmentation fault (11)
> > [Tue Mar 27 17:26:14 2007] [notice] child pid 28469 exit signal
> Segmentation fault (11)
> > [Tue Mar 27 17:26:40 2007] [error] [client 134.96.24.83] File does not
> exist: /opt/lampp/htdocs/favicon.ico
> > [Tue Mar 27 17:29:21 2007] [error] [client 134.96.24.83] File does not
> exist: /opt/lampp/htdocs/favicon.ico
> >
> >
> > Why this segmentation error with 3.3.1
>
> Obviously we'd like to sort out why 3.3.1 is segfaulting. Did you try
> Graham's suggestion of doing:
>
>  PythonHandler mod_python.testhandler
>
> and still get a segfault? If not, can you either try it, or share the
> contents of you index.py file that caused the problem?
>
> > and also, i had nothing to do with this favicon.ico. I do not have this
> icon and
>  > do not intend to make one. Why and which process needs this icon...
> *wondering*
>
> This has nothing to do with mod_python. It's your browser that is
> requesting favicon.ico. You don't have one and apache logs that fact,
> and is standard behaviour for a missing file. If you don't intend to
> create one you better get used to having your error logs clogged with
> this message, as I believe some (all?) modern browsers automatically
> request it.
>
> Jim
>
> > Thanks,
> > Sikander
> >
> >
> > Graham Dumpleton wrote: On 26/03/07, sikander hayat wrote:
> >> Hi,
> >>
> >> I am using suse 10.1, Apache 2.2.4, python 2.5 and mod_python 3.3.1.
> >>
> >> The error log is as follows:
> >> [Mon Mar 26 10:16:48 2007] [warn] RSA server certificate is a CA
> certificate
> >> (BasicConstraints: CA == TRUE !?)
> >> [Mon Mar 26 10:16:48 2007] [warn] RSA server certificate CommonName (CN)
> >> `localhost' does NOT match server name!?
> >> [Mon Mar 26 10:16:48 2007] [notice] mod_python: Creating 8 session
> mutexes
> >> based on 256 max processes and 0 max threads.
> >> [Mon Mar 26 10:16:48 2007] [notice] mod_python: using mutex_directory
> /tmp
> >> [Mon Mar 26 10:16:48 2007] [notice] Apache/2.2.4 (Unix) DAV/2
> mod_ssl/2.2.4
> >> OpenSSL/0.9.8d mod_python/3.3.1 Python/2.5 PHP/5.2.1
> >> mod_apreq2-20051231/2.5.7 m
> >> od_perl/2.0.2 Perl/v5.8.7 configured -- resuming normal operations
> >> [Mon Mar 26 10:17:04 2007] [error] [client 134.96.24.83] File does not
> >> exist: /opt/lampp/htdocs/favicon.ico
> >> [Mon Mar 26 10:17:35 2007] [notice] mod_python (pid=3230,
> >> interpreter='localhost'): Importing module
> >> '/opt/lampp/htdocs/parkweb/index.py'
> >> [Mon Mar 26 10:17:35 2007] [notice] mod_python (pid=3231,
> >> interpreter='localhost'): Importing module
> >> '/opt/lampp/htdocs/parkweb/index.py'
> >> [Mon Mar 26 10:17:36 2007] [notice] child pid 3230 exit signal
> Segmentation
> >> fault (11)
> >> [Mon Mar 26 10:17:36 2007] [notice] child pid 3231 exit signal
> Segmentation
> >> fault (11)
> >>
> >> I have recently upgraded to python 2.5. So, to say, i have 2 versions of
> >> python on my system. Will try to remove the older one and try again.
> >
> > To confirm whether that is necessary, set:
> >
> > PythonHandler mod_python.testhandler
> >
> > In the output from that just verify that the sys.path information is
> > correct for the version of Python you expect to use. From the above
> > log entries there probably isn't a problem with versions as mod_python
> > will actually log some warnings if it finds a different version of
> > Python than what it was compiled with and that isn't in the log
> > entries.
> >
> >> ****Why is it loading the module twice ...is that normal ???
> >
> > Note how the 'pid' is different for each. This means that there were
> > two requests and that they so happened to be handled by different
> > Apache child processes.
> >
> >> Kindly let me know if something rings a bell.
> >
> > Since you are using Python 2.5, it should not be the expat version
> > problem as Python 2.5 is supposed to change things to avoid that one.
> > I would though still suspect that it is some versioning problem with
> > shared libraries. For example, if your web application uses some sort
> > of database and you also have PHP loaded and it is using some
> > different version of the database client library. This sort of
> > mismatch can cause a crash as one library will take precedence over
> > the other and if they are not compatible it can crash.
> >
> > What you may need to do is start adding debug into your code and the
> > framework it uses such that you output a log message before and after
> > every module import. For example:
> >
> > from mod_python import apache
> >
> > apache.log_error(__file__ + " #1")
> > import pyexpat
> > apache.log_error(__file__ + " #2")
> > import module2
> > apache.log_error(__file__ + " #3")
> >
> > See how many of the messages come out in the Apache error log and slow
> > narrow it down to a specific module being importer causing the crash.
> >
> > If the module imports aren't the problem but something in handler
> > itself, do something similar, logging messages to the Apache log until
> > you find exactly what call causes it.
> >
> > Graham
> >
> >> Thanks,
> >>
> >>
> >> Graham Dumpleton wrote:
> >> On 24/03/07, Jim Gallacher wrote:
> >>> sikander hayat wrote:
> >>>> Hi all,
> >>>>
> >>>> My apache webserver on linux recently broke down, so i reinstalled it,
> >> along with mod_python. Having made the necessary changes in the conf file
> of
> >> apache, i tried some of the simple tests, such as mptest, but i keep on
> >> getting the following error.
> >>>> Connection to host server ... lost.
> >>>>
> >>>> Why is that, is it because of python or some apache setting.
> >>> Or network problems?
> >>>
> >>> What do you find in your apache logs?
> >> The Apache error log would be a good start, as it looks to me like
> >> your Apache child processes are crashing. You may find errors about
> >> segmentation violations or similar in the logs. If you do, check that
> >> the version of mod_python you are using is the correct one for the
> >> version of Python and Apache you are using. Having multiple versions
> >> of Python installed can also cause issues.
> >>
> >> BTW, are you using precompiled packages or compiling everything from
> >> source code? What operating system are you using?
> >>
> >> Graham
> >>
> >>
> >>
> >> ________________________________
> >> Sucker-punch spam with award-winning protection.
> >> Try the free Yahoo! Mail Beta.
> >>
> >>
> >
> >
> >
> > ---------------------------------
> > The fish are biting.
> > Get more visitors on your site using Yahoo! Search Marketing.
> >
> >
> >
> ------------------------------------------------------------------------
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
>
>
>  ________________________________
> Expecting? Get great news right away with email Auto-Check.
> Try the Yahoo! Mail Beta.
>
>
From nitinchandra1 at gmail.com  Thu Mar 29 06:54:38 2007
From: nitinchandra1 at gmail.com (nitin chandra)
Date: Thu Mar 29 06:55:27 2007
Subject: [mod_python] Need Help ...Please!!!
Message-ID: <965122bf0703290454x1fd3ed25y9deda0f1b4f7d9f9@mail.gmail.com>

Hi Everyone!

I need some help here.

I have a WinXP laptop, installed with Python2.4, Apache 2.0.59,
mod_python-3.2.8.win32-py2.4.exe,
psycopg2-2.0.5.1.win32-py2.4-pg8.2.0-release.exe, PostgreSQL 8.2.

Now i have created a DB as "nitin" and a user "nitin", further i
created 13 more tables within the DB. One of the
tables is named as "area". This, "area", table has 11 fields. Two
fields are left blank as they will
be entered through a web interface.

So i am trying to read the complete row and display the existing data
in the table. The display of the data is to be done in various forms
fields over the Web-interface / html(or CSS). Lastly, Enter data in
blank form fields and update the table.


I am writing a 'area.py' script for the above.

======================

from mod_python import apache
import sys, psycopg

conn = psycopg.connect("dbname=nitin user=nitin passwd=" "")

curs = conn.cursor()



<head><title>Owners' Details Entered</title></head>
<body bgcolor="#87CEFA">
<table align=center border=2 cellpadding=6>


curs.execute("SELECT * FROM area")
rows = curs.fetchall()

print <tr><td>rows</td></tr>


</table>
</body>
</head>

===================

And it does not work. When I load the page in IE, HTML works but the
rest of the code is displayed as it is,i.e. as text.

Are there any samples available on the net where i can look at.

Please guide.

Thanks
Reg
Nitin
From martijn at xs4us.nu  Thu Mar 29 06:58:55 2007
From: martijn at xs4us.nu (Martijn Moeling)
Date: Thu Mar 29 07:01:19 2007
Subject: [mod_python] how to use Mysql on mod_python+apache?
Message-ID: <B6C73A5E30565245BB6D32B5F5DF7A52120333@sense.emmastraat.pijnacker>

I don't see the fuzz about mysql either. It is rock solid and I use(d)
it a lot in production environment, together with mysqldb and mod
python.

When using it with mod python there are a few things to be aware of.

First make sure the connection and cursor objects are not created
globally I use:


Def handler(req):
..
..
	req.db = MySQLdb.connect( host=Chost, user=Cuser,
passwd=Cpasswd, db=Cdb, use_unicode=True, charset='utf8')
	req.cursor = req.db.cursor()

#next I close the database in a fixup handler

req.register_cleanup(closedb,req)

...

And the closedb function

def closedb(req):
    try:
        req.cursor.close()
        req.cursor=None
        req.db.close()
        req.db = None
    except:
        pass

with this method of using mysqldb, the database connection is closed
properly, even if the handler code runs into an error, if not and an
error occurs and the connection is kept by MySQL and at the end it will
run out of resources (and/or memory whatever comes first).

And to the off topic part:
People seem to blame software when it behaves as designed and they don't
read manuals and/or know background theory, please keep non mod_python
issues out of this list and respect choices made by other people, even
if you think it is a bad one. The question was "How can I use Mysql with
MP".

To explain this further, I see people asking questions about MP running
on windows, personally I have the opinion that Microsoft sells crap but
that is since I know about unixes, OpenVMS, MVS etc. etc. and windows.
But I'll never suggest : trow out windows and install xxxxx since the
other person might be more familiar with windows, that is the tool of
choice for him.

Getting started with MP has a steep learning curve, not because MP is
difficult to use, but since a lot of different technologies and
standards apply (file protection, apache, mime types, character sets,
HTML, javascript, xml, htttp (headers!), browser incompatibility,
python, etc, etc. 
I have over 30 years of professional experience and I had a lot to learn
when I started with MP.

I am thinking of publishing parts of my system on a dedicated MP
examples website, since I solved a lot of technology difficulties
(uploading pictures, resizing pictures, pictures stored in Mysql,
characterset conversion, a simple spiderbot, a simple templating system
etc.

MP beats a lot of other similar tools but in my eyes there is a lack of
proper simple to understand examples for so called newbie's that are
well documented

Martijn Moeling

-----Oorspronkelijk bericht-----
Van: mod_python-bounces@modpython.org
[mailto:mod_python-bounces@modpython.org] Namens Mike Looijmans
Verzonden: Wednesday, March 28, 2007 12:02 PM
Aan: mod_python@modpython.org
Onderwerp: Re: [mod_python] how to use Mysql on mod_python+apache?

This thread is going way of topic, but I'd really hate to see people
being turned away from MySQL as 
a DB engine just because of the inaccuracies posted here.

I have several years of experience with many DBMSs, including Informix,
Oracle, MS SQLServer, 
Postgress, MySQL and several others. MySQL is my favorite for (non-.NET)
web applications, because 
of its scalability, performance, reliability, low maintenance and ease
of use.

There are many DBMSs, each with their own pecularities, and none of them
I would consider "bad" (or 
even "evil"). Which DBMS to chose for a particular task seems to become
a matter of personal taste 
more everyday, because the more general offerings, like the ones I
mentioned, all provide the same 
rich feature set (e.g. transactions, subqueries, stored procedures,
outer joins). While I would not 
hesitate to recommend in favor of some of the databases I am familiar
with, there is not one that i 
would ever tell people to "avoid at all cost". Even FoxPro has its uses.

> Sorry, but accepting invalid input without error, truncating overly
long
> input and clipping overflowed numbers are not "quirks".

I agree so far.

>  They are serious data integrity issues.

I disagree here, because the issues you mentioned are configuration
settings in MySQL. You can 
change the behaviour of the server in the config file. It is unfortunate
that the default settings 
are not the ANSI ones. But you can make the MySQL DB comply to the more
general standard of issuing 
an error on overflow and other forms of invalid input.

I suggest reading some documentation before proceeding on the subject.

> That's fine.  At least you aren't really using MySQL in production :-)

I have. On my previous assignment, the customer would loose about $10k
per hour in lost machine time 
only (not even taking the engineers cost into account) if the MySQL
database went offline. It did go 
offline once in that three year period i worked there - the power went
down, the UPS failed and the 
operating system (Solaris) died a horrible dead along with the hard
drive. When the power came up, I 
had its replacement up and running in about ten minutes, and no data was
lost.


--
Mike Looijmans

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python

From mctse at vodamail.co.za  Thu Mar 29 07:04:48 2007
From: mctse at vodamail.co.za (Mark)
Date: Thu Mar 29 07:06:02 2007
Subject: [mod_python] Textbooks on psp programming?
In-Reply-To: <88e286470703281905t5e864819gc1f1f64f8d832fed@mail.gmail.com>
References: <460964A5.7000302@jgassociates.ca>	<829078.59411.qm@web38715.mail.mud.yahoo.com>
	<88e286470703281905t5e864819gc1f1f64f8d832fed@mail.gmail.com>
Message-ID: <460BAB60.7090107@vodamail.co.za>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
 
Dear mod_python guru.

I taught myself how to program with php and would love to learn how to
use mod_python.  I learned php from an excellent book called php4 for
beginners (after all that's exactly what I was - and am as regards
python -) and would greatly appreciate it if you could refer me to an
equivalent book on psp programming.


Kindest regards



Mark Coetsee
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (MingW32)
 
iD8DBQFGC6tgLzNh63IR8ssRArusAJ9T9THiyvbu8ZiJtCKuejD+SiiQLQCgm3uG
RlvXnPYgO94PtrCmvus07VI=
=V/8D
-----END PGP SIGNATURE-----

From martijn at xs4us.nu  Thu Mar 29 07:12:11 2007
From: martijn at xs4us.nu (Martijn Moeling)
Date: Thu Mar 29 07:13:47 2007
Subject: [mod_python] session variable value (partially) dissapearing
Message-ID: <B6C73A5E30565245BB6D32B5F5DF7A52120334@sense.emmastraat.pijnacker>

Are you properly saving the session at every request?
Like:

# Created session like this:
# req.session = Session.Session(req)

Req.session.save()

Martijn

-----Oorspronkelijk bericht-----
Van: mod_python-bounces@modpython.org
[mailto:mod_python-bounces@modpython.org] Namens Jim Gallacher
Verzonden: Wednesday, March 28, 2007 3:00 AM
Aan: Detmar Meurers
CC: mod_python@modpython.org; Graham Dumpleton
Onderwerp: Re: [mod_python] session variable value (partially)
dissapearing

Detmar Meurers wrote:
> Hi Graham,
> 
> Thanks for the very quick reply.
> 
> The page showing the problem actually is using the publisher handler
> (so no special exception handling etc.)
> 
> I tried the FileSession and the problem occurs there too - and I'm
> not doing any calling of unlock().
> 
> I am calling req.session.save() - one question about that though:
> Can it possibly cause problems when calling the save() several times
> when handling one request?

It shouldn't matter. The session store is locked so only one request can

read or write at a time. This is the case even if you have session 
locking turned off, or unlock the session manually.

Jim
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python

From sdavis2 at mail.nih.gov  Thu Mar 29 07:20:57 2007
From: sdavis2 at mail.nih.gov (Sean Davis)
Date: Thu Mar 29 07:27:55 2007
Subject: [mod_python] Need Help ...Please!!!
In-Reply-To: <965122bf0703290454x1fd3ed25y9deda0f1b4f7d9f9@mail.gmail.com>
References: <965122bf0703290454x1fd3ed25y9deda0f1b4f7d9f9@mail.gmail.com>
Message-ID: <200703290820.58077.sdavis2@mail.nih.gov>

On Thursday 29 March 2007 07:54, nitin chandra wrote:
> Hi Everyone!
>
> I need some help here.
>
> I have a WinXP laptop, installed with Python2.4, Apache 2.0.59,
> mod_python-3.2.8.win32-py2.4.exe,
> psycopg2-2.0.5.1.win32-py2.4-pg8.2.0-release.exe, PostgreSQL 8.2.
>
> Now i have created a DB as "nitin" and a user "nitin", further i
> created 13 more tables within the DB. One of the
> tables is named as "area". This, "area", table has 11 fields. Two
> fields are left blank as they will
> be entered through a web interface.
>
> So i am trying to read the complete row and display the existing data
> in the table. The display of the data is to be done in various forms
> fields over the Web-interface / html(or CSS). Lastly, Enter data in
> blank form fields and update the table.
>
>
> I am writing a 'area.py' script for the above.
>
> ======================
>
> from mod_python import apache
> import sys, psycopg
>
> conn = psycopg.connect("dbname=nitin user=nitin passwd=" "")
>
> curs = conn.cursor()
>
>
>
> <head><title>Owners' Details Entered</title></head>
> <body bgcolor="#87CEFA">
> <table align=center border=2 cellpadding=6>
>
>
> curs.execute("SELECT * FROM area")
> rows = curs.fetchall()
>
> print <tr><td>rows</td></tr>
>
>
> </table>
> </body>
> </head>
>
> ===================
>
> And it does not work. When I load the page in IE, HTML works but the
> rest of the code is displayed as it is,i.e. as text.
>
> Are there any samples available on the net where i can look at.

You will probably need to read some documentation:

http://www.modpython.org/

I think you will probably need to follow the examples in the manual pretty 
closely.  Also, I would suggest that you do some reading on how the web 
works.  Knowing what HTML is, how dynamic webservers generate and deliver 
content, and how databases get involved are pretty important concepts to 
understand.

Sean
From steino at ccri.net  Thu Mar 29 07:51:40 2007
From: steino at ccri.net (Olaf Stein)
Date: Thu Mar 29 07:53:19 2007
Subject: [mod_python] Remote IP
Message-ID: <C2312E9C.1BEE%steino@ccri.net>

Hi All,

Is there any built in function in mod_python to obtain the remote IP
address. Or any other way?

Thanks
Olaf

From newbarker at btinternet.com  Thu Mar 29 08:23:56 2007
From: newbarker at btinternet.com (PETER BARKER)
Date: Thu Mar 29 08:24:05 2007
Subject: [mod_python] Remote IP
In-Reply-To: <C2312E9C.1BEE%steino@ccri.net>
Message-ID: <454995.30619.qm@web86010.mail.ird.yahoo.com>

I came up with this:
   
  from mod_python import apache
  def handler(req):
    req.content_type = 'text/plain'
    req.add_common_vars()
    req.write('IP address of requester is ' + req.subprocess_env['REMOTE_ADDR']);
    return apache.OK
   
  After reading the page http://www.modpython.org/live/current/doc-html/pyapi-mprequest-mem.html
   
  Hope this helps,
   
  Pete

Olaf Stein <steino@ccri.net> wrote:
  Hi All,

Is there any built in function in mod_python to obtain the remote IP
address. Or any other way?

Thanks
Olaf

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070329/74aad17e/attachment.html
From newbarker at btinternet.com  Thu Mar 29 08:32:34 2007
From: newbarker at btinternet.com (PETER BARKER)
Date: Thu Mar 29 08:32:43 2007
Subject: Fwd: Re: [mod_python] Remote IP
Message-ID: <20070329133234.65390.qmail@web86014.mail.ird.yahoo.com>



Olaf Stein <steino@ccri.net> wrote:  Date: Thu, 29 Mar 2007 09:29:18 -0400
Subject: Re: [mod_python] Remote IP
From: Olaf Stein <steino@ccri.net>
To: PETER BARKER <newbarker@btinternet.com>

Works great
thanks


On 3/29/07 9:23 AM, "PETER BARKER" <newbarker@btinternet.com> wrote:

  I came up with this:
  
 
  
from mod_python import apache
  
def handler(req):
    req.content_type = 'text/plain'
    req.add_common_vars()
    req.write('IP address of requester is ' + req.subprocess_env['REMOTE_ADDR']);
    return apache.OK
  
 
  
After reading the page http://www.modpython.org/live/current/doc-html/pyapi-mprequest-mem.html
  
 
  
Hope this helps,
  
 
  
Pete

Olaf Stein <steino@ccri.net> wrote:
  
  Hi All,

Is there any built in function in mod_python to obtain the remote IP
address. Or any other way?

Thanks
Olaf

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python








------------------------- 
Olaf Stein
DBA
Center for Quantitative and Computational Biology
Columbus Children's Research Institute
700 Children's Drive
phone: 1-614-355-5685
cell: 1-614-843-0432
email: steino@ccri.net

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070329/34c18bcb/attachment.html
From jpg at jgassociates.ca  Thu Mar 29 08:36:11 2007
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Thu Mar 29 08:35:21 2007
Subject: [mod_python] Remote IP
In-Reply-To: <C2312E9C.1BEE%steino@ccri.net>
References: <C2312E9C.1BEE%steino@ccri.net>
Message-ID: <460BC0CB.1010001@jgassociates.ca>

Olaf Stein wrote:
> Hi All,
> 
> Is there any built in function in mod_python to obtain the remote IP
> address. Or any other way?

The Connection object is your friend.

http://www.modpython.org/live/current/doc-html/pyapi-mpconn-mem.html#l2h-159

def handler(req):
     ip = req.connection.remote_ip
     ...

Jim


From dm at ling.ohio-state.edu  Thu Mar 29 14:02:33 2007
From: dm at ling.ohio-state.edu (Detmar Meurers)
Date: Thu Mar 29 14:03:00 2007
Subject: [mod_python] session variable value (partially) dissapearing
In-Reply-To: <B6C73A5E30565245BB6D32B5F5DF7A52120334@sense.emmastraat.pijnacker>
References: <B6C73A5E30565245BB6D32B5F5DF7A52120334@sense.emmastraat.pijnacker>
Message-ID: <20070329190231.GC16374@ling.ohio-state.edu>

Dear Martijn (et al.),

I think I found what the problem was - and the loss of session data
apparently was related to properly saving it, as you and Graham had
suggested: For some of the possible paths through my code doing
partial page updates, the session did not get saved - i.e., I was
missing some req.session.save() calls in the sub-functions handling
those AJAX requests. 

Thanks for the replies - it's great to know there is a community one
can discuss such issues with!

Best,
Detmar

--
Detmar Meurers, Associate Professor, Dept. of Linguistics, OSU
201a Oxley Hall, 1712 Neil Avenue, Columbus OH 43210-1298, USA
http://ling.osu.edu/~dm/                 GnuPG key on web page


On Thu, Mar 29, 2007 at 02:12:11PM +0200, Martijn Moeling wrote:
    Are you properly saving the session at every request?
    Like:
    
    # Created session like this:
    # req.session = Session.Session(req)
    
    Req.session.save()
    
    Martijn
    
    -----Oorspronkelijk bericht-----
    Van: mod_python-bounces@modpython.org
    [mailto:mod_python-bounces@modpython.org] Namens Jim Gallacher
    Verzonden: Wednesday, March 28, 2007 3:00 AM
    Aan: Detmar Meurers
    CC: mod_python@modpython.org; Graham Dumpleton
    Onderwerp: Re: [mod_python] session variable value (partially)
    dissapearing
    
    Detmar Meurers wrote:
    > Hi Graham,
    > 
    > Thanks for the very quick reply.
    > 
    > The page showing the problem actually is using the publisher handler
    > (so no special exception handling etc.)
    > 
    > I tried the FileSession and the problem occurs there too - and I'm
    > not doing any calling of unlock().
    > 
    > I am calling req.session.save() - one question about that though:
    > Can it possibly cause problems when calling the save() several times
    > when handling one request?
    
    It shouldn't matter. The session store is locked so only one request can
    
    read or write at a time. This is the case even if you have session 
    locking turned off, or unlock the session manually.
    
    Jim
    _______________________________________________
    Mod_python mailing list
    Mod_python@modpython.org
    http://mailman.modpython.org/mailman/listinfo/mod_python
From nmilkovits at gmail.com  Thu Mar 29 14:25:01 2007
From: nmilkovits at gmail.com (Nicholas Milkovits)
Date: Thu Mar 29 14:25:11 2007
Subject: [SPAM] Re: [mod_python] Need Help ...Please!!!
Message-ID: <71a75690703291225y6d108881n995f55c4c0017bbf@mail.gmail.com>

nitin,

print <some html> will print to stdout

I think if you want to write html back to the requester you want to do
something like:

req.content_type = "text/html"
req.write(<some string of html>)

-nick

On 3/29/07, mod_python-request@modpython.org
<mod_python-request@modpython.org> wrote:
> Send Mod_python mailing list submissions to
>         mod_python@modpython.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
>         http://mailman.modpython.org/mailman/listinfo/mod_python
> or, via email, send a message with subject or body 'help' to
>         mod_python-request@modpython.org
>
> You can reach the person managing the list at
>         mod_python-owner@modpython.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of Mod_python digest..."
>
>
> Today's Topics:
>
>    1. Re: Hello (Graham Dumpleton)
>    2. Re: connection to host server broken (Graham Dumpleton)
>    3. Need Help ...Please!!! (nitin chandra)
>    4. RE: how to use Mysql on mod_python+apache? (Martijn Moeling)
>    5. Textbooks on psp programming? (Mark)
>    6. RE: session variable value (partially) dissapearing
>       (Martijn Moeling)
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Thu, 29 Mar 2007 08:05:19 +1000
> From: "Graham Dumpleton" <graham.dumpleton@gmail.com>
> Subject: [mod_python] Re: Hello
> To: " Idoia Villaci?n Z?rate " <fidita48@hotmail.com>
> Cc: mod_python@modpython.org
> Message-ID:
>         <88e286470703281505q2a9a6a34g2c3d16365c9503a1@mail.gmail.com>
> Content-Type: text/plain; charset=ISO-8859-1; format=flowed
>
> On 29/03/07, Idoia Villaci?n Z?rate <fidita48@hotmail.com> wrote:
> >
> >
> >
> > Hello:
> >
> > I've looked the web you gave me, but I can't see anywhere how to change the
> > configuration of my apache to choose the mod_python script instead of the
> > CGI script. I also think that I have the lastest version od the mod_python
> > (3.3.1). I'll be gratefull if you could help me or tell me how to resolve
> > the problem.
>
> Please use reply-all when responding, thus keeping the conversation on
> the mod_python mailing list.
>
> As to your problem, if you cannot ascertain from that document which
> bits referred to how to configure Apache, then you need to perhaps
> learn more about how to configure Apache and the language it uses to
> refer to its directives and where to put them. On that I can only
> suggest you go to the Apache documentation and start reading. Some
> starting points are:
>
>   http://httpd.apache.org/docs/2.2/
>   http://httpd.apache.org/docs/2.2/configuring.html
>   http://httpd.apache.org/docs/2.2/sections.html
>   http://httpd.apache.org/docs/2.2/howto/cgi.html
>
> Also refer to the mod_python documentation to learn about its own
> specific configuration directives:
>
>   http://www.modpython.org/live/current/doc-html/inst-testing.html
>   http://www.modpython.org/live/current/doc-html/directives.html
>
> Beyond that we can't really help since you haven't actually included
> in your email what snippet of Apache configuration you think you are
> using to enable mod_python use in the first place. Thus, cannot say
> how it is wrong, or how it is conflicting with existing CGI
> configuration in your setup.
>
> The only thing we can tell you as we already have, is that error would
> generally arise when your script is run as a CGI program and not
> through mod_python. This is because the _apache module is a special
> module not available from command line Python and is only available
> when code is running inside of mod_python. That the module cannot be
> found indicates the code isn't running under mod_python.
>
> Oh, and please do not go sending your complete Apache configuration,
> just those bits which would be relevant, such as the mod_python and
> CGI sections.
>
> Graham
>
>
>
> ------------------------------
>
> Message: 2
> Date: Thu, 29 Mar 2007 12:05:37 +1000
> From: "Graham Dumpleton" <graham.dumpleton@gmail.com>
> Subject: Re: [mod_python] connection to host server broken
> To: "sikander hayat" <hayat221@yahoo.com>
> Cc: Mod_python@modpython.org, Jim Gallacher <jpg@jgassociates.ca>
> Message-ID:
>         <88e286470703281905t5e864819gc1f1f64f8d832fed@mail.gmail.com>
> Content-Type: text/plain; charset=ISO-8859-1; format=flowed
>
> On 28/03/07, sikander hayat <hayat221@yahoo.com> wrote:
> > Hi,
> >
> > I tried the testhandler and then looked at the first 100 entries of the
> > error log and there it was...the segmentation fault.
>
> Yes, but what did the first 100 entries say?
>
> What are you actually saying here? Are you saying you triggered 100
> requests of the handler and only then did your handler crash Apache,
> or that there was simply 100 unrelated entries that preceded the crash
> point, where the crash was the outcome of the very first request? I
> would help that you actually posted from the log the entry for the
> crash and anything just prior to that point that seems relevant.
>
> It would also help that you post the snippet of your Apache
> configuration so we can see how you have set it up to run mod_python
> and what handler you might be triggering, whether it be your own or
> one from mod_python such as publisher.
>
> > The code that i tried
> > is as follows:
> >
> > from mod_python import apache
> >
> > import module2
>
> But what is in module2. Did you put log statements in module2 so as to
> see what was run in there when import was done and how far it got.?
>
> > apache.log_error(__file__ + " #3")
> >
> > def handler(req):
> >
> >         req.content_type = "text/plain"
> >         req.write("Hello World!")
> >
> >         return apache.OK
> >
> > Thanks
> > Sikander
> >
> > Jim Gallacher <jpg@jgassociates.ca> wrote:
> >  sikander hayat wrote:
> > > Hi,
> > >
> > > Thanks for your help. Just wanted to point out that, out of frustation, i
> > installed mod_python 3.2.10 and discarded mod_python 3.3.1 and magically it
> > all works fine !!!
> > >
> > > What I would like to conclude from this is, that there might be some
> > dependency in 3.3.1 that caused havoc...(atleast for me). As pointed out
> > previously, 3.3.1 constantly kept on giving the following errors:
> > >
> > > child pid 28468 exit signal Segmentation fault (11)
> > > [Tue Mar 27 17:26:14 2007] [notice] child pid 28469 exit signal
> > Segmentation fault (11)
> > > [Tue Mar 27 17:26:40 2007] [error] [client 134.96.24.83] File does not
> > exist: /opt/lampp/htdocs/favicon.ico
> > > [Tue Mar 27 17:29:21 2007] [error] [client 134.96.24.83] File does not
> > exist: /opt/lampp/htdocs/favicon.ico
> > >
> > >
> > > Why this segmentation error with 3.3.1
> >
> > Obviously we'd like to sort out why 3.3.1 is segfaulting. Did you try
> > Graham's suggestion of doing:
> >
> >  PythonHandler mod_python.testhandler
> >
> > and still get a segfault? If not, can you either try it, or share the
> > contents of you index.py file that caused the problem?
> >
> > > and also, i had nothing to do with this favicon.ico. I do not have this
> > icon and
> >  > do not intend to make one. Why and which process needs this icon...
> > *wondering*
> >
> > This has nothing to do with mod_python. It's your browser that is
> > requesting favicon.ico. You don't have one and apache logs that fact,
> > and is standard behaviour for a missing file. If you don't intend to
> > create one you better get used to having your error logs clogged with
> > this message, as I believe some (all?) modern browsers automatically
> > request it.
> >
> > Jim
> >
> > > Thanks,
> > > Sikander
> > >
> > >
> > > Graham Dumpleton wrote: On 26/03/07, sikander hayat wrote:
> > >> Hi,
> > >>
> > >> I am using suse 10.1, Apache 2.2.4, python 2.5 and mod_python 3.3.1.
> > >>
> > >> The error log is as follows:
> > >> [Mon Mar 26 10:16:48 2007] [warn] RSA server certificate is a CA
> > certificate
> > >> (BasicConstraints: CA == TRUE !?)
> > >> [Mon Mar 26 10:16:48 2007] [warn] RSA server certificate CommonName (CN)
> > >> `localhost' does NOT match server name!?
> > >> [Mon Mar 26 10:16:48 2007] [notice] mod_python: Creating 8 session
> > mutexes
> > >> based on 256 max processes and 0 max threads.
> > >> [Mon Mar 26 10:16:48 2007] [notice] mod_python: using mutex_directory
> > /tmp
> > >> [Mon Mar 26 10:16:48 2007] [notice] Apache/2.2.4 (Unix) DAV/2
> > mod_ssl/2.2.4
> > >> OpenSSL/0.9.8d mod_python/3.3.1 Python/2.5 PHP/5.2.1
> > >> mod_apreq2-20051231/2.5.7 m
> > >> od_perl/2.0.2 Perl/v5.8.7 configured -- resuming normal operations
> > >> [Mon Mar 26 10:17:04 2007] [error] [client 134.96.24.83] File does not
> > >> exist: /opt/lampp/htdocs/favicon.ico
> > >> [Mon Mar 26 10:17:35 2007] [notice] mod_python (pid=3230,
> > >> interpreter='localhost'): Importing module
> > >> '/opt/lampp/htdocs/parkweb/index.py'
> > >> [Mon Mar 26 10:17:35 2007] [notice] mod_python (pid=3231,
> > >> interpreter='localhost'): Importing module
> > >> '/opt/lampp/htdocs/parkweb/index.py'
> > >> [Mon Mar 26 10:17:36 2007] [notice] child pid 3230 exit signal
> > Segmentation
> > >> fault (11)
> > >> [Mon Mar 26 10:17:36 2007] [notice] child pid 3231 exit signal
> > Segmentation
> > >> fault (11)
> > >>
> > >> I have recently upgraded to python 2.5. So, to say, i have 2 versions of
> > >> python on my system. Will try to remove the older one and try again.
> > >
> > > To confirm whether that is necessary, set:
> > >
> > > PythonHandler mod_python.testhandler
> > >
> > > In the output from that just verify that the sys.path information is
> > > correct for the version of Python you expect to use. From the above
> > > log entries there probably isn't a problem with versions as mod_python
> > > will actually log some warnings if it finds a different version of
> > > Python than what it was compiled with and that isn't in the log
> > > entries.
> > >
> > >> ****Why is it loading the module twice ...is that normal ???
> > >
> > > Note how the 'pid' is different for each. This means that there were
> > > two requests and that they so happened to be handled by different
> > > Apache child processes.
> > >
> > >> Kindly let me know if something rings a bell.
> > >
> > > Since you are using Python 2.5, it should not be the expat version
> > > problem as Python 2.5 is supposed to change things to avoid that one.
> > > I would though still suspect that it is some versioning problem with
> > > shared libraries. For example, if your web application uses some sort
> > > of database and you also have PHP loaded and it is using some
> > > different version of the database client library. This sort of
> > > mismatch can cause a crash as one library will take precedence over
> > > the other and if they are not compatible it can crash.
> > >
> > > What you may need to do is start adding debug into your code and the
> > > framework it uses such that you output a log message before and after
> > > every module import. For example:
> > >
> > > from mod_python import apache
> > >
> > > apache.log_error(__file__ + " #1")
> > > import pyexpat
> > > apache.log_error(__file__ + " #2")
> > > import module2
> > > apache.log_error(__file__ + " #3")
> > >
> > > See how many of the messages come out in the Apache error log and slow
> > > narrow it down to a specific module being importer causing the crash.
> > >
> > > If the module imports aren't the problem but something in handler
> > > itself, do something similar, logging messages to the Apache log until
> > > you find exactly what call causes it.
> > >
> > > Graham
> > >
> > >> Thanks,
> > >>
> > >>
> > >> Graham Dumpleton wrote:
> > >> On 24/03/07, Jim Gallacher wrote:
> > >>> sikander hayat wrote:
> > >>>> Hi all,
> > >>>>
> > >>>> My apache webserver on linux recently broke down, so i reinstalled it,
> > >> along with mod_python. Having made the necessary changes in the conf file
> > of
> > >> apache, i tried some of the simple tests, such as mptest, but i keep on
> > >> getting the following error.
> > >>>> Connection to host server ... lost.
> > >>>>
> > >>>> Why is that, is it because of python or some apache setting.
> > >>> Or network problems?
> > >>>
> > >>> What do you find in your apache logs?
> > >> The Apache error log would be a good start, as it looks to me like
> > >> your Apache child processes are crashing. You may find errors about
> > >> segmentation violations or similar in the logs. If you do, check that
> > >> the version of mod_python you are using is the correct one for the
> > >> version of Python and Apache you are using. Having multiple versions
> > >> of Python installed can also cause issues.
> > >>
> > >> BTW, are you using precompiled packages or compiling everything from
> > >> source code? What operating system are you using?
> > >>
> > >> Graham
> > >>
> > >>
> > >>
> > >> ________________________________
> > >> Sucker-punch spam with award-winning protection.
> > >> Try the free Yahoo! Mail Beta.
> > >>
> > >>
> > >
> > >
> > >
> > > ---------------------------------
> > > The fish are biting.
> > > Get more visitors on your site using Yahoo! Search Marketing.
> > >
> > >
> > >
> > ------------------------------------------------------------------------
> > >
> > > _______________________________________________
> > > Mod_python mailing list
> > > Mod_python@modpython.org
> > > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> >
> >
> >
> >  ________________________________
> > Expecting? Get great news right away with email Auto-Check.
> > Try the Yahoo! Mail Beta.
> >
> >
>
>
> ------------------------------
>
> Message: 3
> Date: Thu, 29 Mar 2007 17:24:38 +0530
> From: "nitin chandra" <nitinchandra1@gmail.com>
> Subject: [mod_python] Need Help ...Please!!!
> To: mod_python@modpython.org
> Message-ID:
>         <965122bf0703290454x1fd3ed25y9deda0f1b4f7d9f9@mail.gmail.com>
> Content-Type: text/plain; charset=ISO-8859-1; format=flowed
>
> Hi Everyone!
>
> I need some help here.
>
> I have a WinXP laptop, installed with Python2.4, Apache 2.0.59,
> mod_python-3.2.8.win32-py2.4.exe,
> psycopg2-2.0.5.1.win32-py2.4-pg8.2.0-release.exe, PostgreSQL 8.2.
>
> Now i have created a DB as "nitin" and a user "nitin", further i
> created 13 more tables within the DB. One of the
> tables is named as "area". This, "area", table has 11 fields. Two
> fields are left blank as they will
> be entered through a web interface.
>
> So i am trying to read the complete row and display the existing data
> in the table. The display of the data is to be done in various forms
> fields over the Web-interface / html(or CSS). Lastly, Enter data in
> blank form fields and update the table.
>
>
> I am writing a 'area.py' script for the above.
>
> ======================
>
> from mod_python import apache
> import sys, psycopg
>
> conn = psycopg.connect("dbname=nitin user=nitin passwd=" "")
>
> curs = conn.cursor()
>
>
>
> <head><title>Owners' Details Entered</title></head>
> <body bgcolor="#87CEFA">
> <table align=center border=2 cellpadding=6>
>
>
> curs.execute("SELECT * FROM area")
> rows = curs.fetchall()
>
> print <tr><td>rows</td></tr>
>
>
> </table>
> </body>
> </head>
>
> ===================
>
> And it does not work. When I load the page in IE, HTML works but the
> rest of the code is displayed as it is,i.e. as text.
>
> Are there any samples available on the net where i can look at.
>
> Please guide.
>
> Thanks
> Reg
> Nitin
>
>
> ------------------------------
>
> Message: 4
> Date: Thu, 29 Mar 2007 13:58:55 +0200
> From: "Martijn Moeling" <martijn@xs4us.nu>
> Subject: RE: [mod_python] how to use Mysql on mod_python+apache?
> To: <mod_python@modpython.org>
> Message-ID:
>         <B6C73A5E30565245BB6D32B5F5DF7A52120333@sense.emmastraat.pijnacker>
> Content-Type: text/plain;       charset="US-ASCII"
>
> I don't see the fuzz about mysql either. It is rock solid and I use(d)
> it a lot in production environment, together with mysqldb and mod
> python.
>
> When using it with mod python there are a few things to be aware of.
>
> First make sure the connection and cursor objects are not created
> globally I use:
>
>
> Def handler(req):
> ..
> ..
>         req.db = MySQLdb.connect( host=Chost, user=Cuser,
> passwd=Cpasswd, db=Cdb, use_unicode=True, charset='utf8')
>         req.cursor = req.db.cursor()
>
> #next I close the database in a fixup handler
>
> req.register_cleanup(closedb,req)
>
> ...
>
> And the closedb function
>
> def closedb(req):
>     try:
>         req.cursor.close()
>         req.cursor=None
>         req.db.close()
>         req.db = None
>     except:
>         pass
>
> with this method of using mysqldb, the database connection is closed
> properly, even if the handler code runs into an error, if not and an
> error occurs and the connection is kept by MySQL and at the end it will
> run out of resources (and/or memory whatever comes first).
>
> And to the off topic part:
> People seem to blame software when it behaves as designed and they don't
> read manuals and/or know background theory, please keep non mod_python
> issues out of this list and respect choices made by other people, even
> if you think it is a bad one. The question was "How can I use Mysql with
> MP".
>
> To explain this further, I see people asking questions about MP running
> on windows, personally I have the opinion that Microsoft sells crap but
> that is since I know about unixes, OpenVMS, MVS etc. etc. and windows.
> But I'll never suggest : trow out windows and install xxxxx since the
> other person might be more familiar with windows, that is the tool of
> choice for him.
>
> Getting started with MP has a steep learning curve, not because MP is
> difficult to use, but since a lot of different technologies and
> standards apply (file protection, apache, mime types, character sets,
> HTML, javascript, xml, htttp (headers!), browser incompatibility,
> python, etc, etc.
> I have over 30 years of professional experience and I had a lot to learn
> when I started with MP.
>
> I am thinking of publishing parts of my system on a dedicated MP
> examples website, since I solved a lot of technology difficulties
> (uploading pictures, resizing pictures, pictures stored in Mysql,
> characterset conversion, a simple spiderbot, a simple templating system
> etc.
>
> MP beats a lot of other similar tools but in my eyes there is a lack of
> proper simple to understand examples for so called newbie's that are
> well documented
>
> Martijn Moeling
>
> -----Oorspronkelijk bericht-----
> Van: mod_python-bounces@modpython.org
> [mailto:mod_python-bounces@modpython.org] Namens Mike Looijmans
> Verzonden: Wednesday, March 28, 2007 12:02 PM
> Aan: mod_python@modpython.org
> Onderwerp: Re: [mod_python] how to use Mysql on mod_python+apache?
>
> This thread is going way of topic, but I'd really hate to see people
> being turned away from MySQL as
> a DB engine just because of the inaccuracies posted here.
>
> I have several years of experience with many DBMSs, including Informix,
> Oracle, MS SQLServer,
> Postgress, MySQL and several others. MySQL is my favorite for (non-.NET)
> web applications, because
> of its scalability, performance, reliability, low maintenance and ease
> of use.
>
> There are many DBMSs, each with their own pecularities, and none of them
> I would consider "bad" (or
> even "evil"). Which DBMS to chose for a particular task seems to become
> a matter of personal taste
> more everyday, because the more general offerings, like the ones I
> mentioned, all provide the same
> rich feature set (e.g. transactions, subqueries, stored procedures,
> outer joins). While I would not
> hesitate to recommend in favor of some of the databases I am familiar
> with, there is not one that i
> would ever tell people to "avoid at all cost". Even FoxPro has its uses.
>
> > Sorry, but accepting invalid input without error, truncating overly
> long
> > input and clipping overflowed numbers are not "quirks".
>
> I agree so far.
>
> >  They are serious data integrity issues.
>
> I disagree here, because the issues you mentioned are configuration
> settings in MySQL. You can
> change the behaviour of the server in the config file. It is unfortunate
> that the default settings
> are not the ANSI ones. But you can make the MySQL DB comply to the more
> general standard of issuing
> an error on overflow and other forms of invalid input.
>
> I suggest reading some documentation before proceeding on the subject.
>
> > That's fine.  At least you aren't really using MySQL in production :-)
>
> I have. On my previous assignment, the customer would loose about $10k
> per hour in lost machine time
> only (not even taking the engineers cost into account) if the MySQL
> database went offline. It did go
> offline once in that three year period i worked there - the power went
> down, the UPS failed and the
> operating system (Solaris) died a horrible dead along with the hard
> drive. When the power came up, I
> had its replacement up and running in about ten minutes, and no data was
> lost.
>
>
> --
> Mike Looijmans
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
>
> ------------------------------
>
> Message: 5
> Date: Thu, 29 Mar 2007 14:04:48 +0200
> From: Mark <mctse@vodamail.co.za>
> Subject: [mod_python] Textbooks on psp programming?
> To: Graham Dumpleton <graham.dumpleton@gmail.com>,
>         Mod_python@modpython.org
> Message-ID: <460BAB60.7090107@vodamail.co.za>
> Content-Type: text/plain; charset=ISO-8859-1
>
> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
>
> Dear mod_python guru.
>
> I taught myself how to program with php and would love to learn how to
> use mod_python.  I learned php from an excellent book called php4 for
> beginners (after all that's exactly what I was - and am as regards
> python -) and would greatly appreciate it if you could refer me to an
> equivalent book on psp programming.
>
>
> Kindest regards
>
>
>
> Mark Coetsee
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v1.4.7 (MingW32)
>
> iD8DBQFGC6tgLzNh63IR8ssRArusAJ9T9THiyvbu8ZiJtCKuejD+SiiQLQCgm3uG
> RlvXnPYgO94PtrCmvus07VI=
> =V/8D
> -----END PGP SIGNATURE-----
>
>
>
> ------------------------------
>
> Message: 6
> Date: Thu, 29 Mar 2007 14:12:11 +0200
> From: "Martijn Moeling" <martijn@xs4us.nu>
> Subject: RE: [mod_python] session variable value (partially)
>         dissapearing
> To: "Jim Gallacher" <jpg@jgassociates.ca>,      "Detmar Meurers"
>         <dm@ling.ohio-state.edu>
> Cc: mod_python@modpython.org, Graham Dumpleton
>         <graham.dumpleton@gmail.com>
> Message-ID:
>         <B6C73A5E30565245BB6D32B5F5DF7A52120334@sense.emmastraat.pijnacker>
> Content-Type: text/plain;       charset="US-ASCII"
>
> Are you properly saving the session at every request?
> Like:
>
> # Created session like this:
> # req.session = Session.Session(req)
>
> Req.session.save()
>
> Martijn
>
> -----Oorspronkelijk bericht-----
> Van: mod_python-bounces@modpython.org
> [mailto:mod_python-bounces@modpython.org] Namens Jim Gallacher
> Verzonden: Wednesday, March 28, 2007 3:00 AM
> Aan: Detmar Meurers
> CC: mod_python@modpython.org; Graham Dumpleton
> Onderwerp: Re: [mod_python] session variable value (partially)
> dissapearing
>
> Detmar Meurers wrote:
> > Hi Graham,
> >
> > Thanks for the very quick reply.
> >
> > The page showing the problem actually is using the publisher handler
> > (so no special exception handling etc.)
> >
> > I tried the FileSession and the problem occurs there too - and I'm
> > not doing any calling of unlock().
> >
> > I am calling req.session.save() - one question about that though:
> > Can it possibly cause problems when calling the save() several times
> > when handling one request?
>
> It shouldn't matter. The session store is locked so only one request can
>
> read or write at a time. This is the case even if you have session
> locking turned off, or unlock the session manually.
>
> Jim
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
>
> ------------------------------
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
> End of Mod_python Digest, Vol 48, Issue 37
> ******************************************
>

From herschel at panix.com  Thu Mar 29 16:06:15 2007
From: herschel at panix.com (Clemens Herschel)
Date: Thu Mar 29 16:06:21 2007
Subject: [mod_python] session variable value (partially) dissapearing
In-Reply-To: <20070329190231.GC16374@ling.ohio-state.edu>
References: <B6C73A5E30565245BB6D32B5F5DF7A52120334@sense.emmastraat.pijnacker>
	<20070329190231.GC16374@ling.ohio-state.edu>
Message-ID: <59137.68.167.134.138.1175202375.squirrel@mail.panix.com>

> Dear Martijn (et al.),
>
> I think I found what the problem was - and the loss of session data
> apparently was related to properly saving it, as you and Graham had
> suggested: For some of the possible paths through my code doing
> partial page updates, the session did not get saved - i.e., I was
> missing some req.session.save() calls in the sub-functions handling
> those AJAX requests.
>
This is off topic. What is the best way to look into AJAX in the python
environment. Thanks Clemens Herschel
> Thanks for the replies - it's great to know there is a community one
> can discuss such issues with!
>
> Best,
> Detmar
>
> --
> Detmar Meurers, Associate Professor, Dept. of Linguistics, OSU
> 201a Oxley Hall, 1712 Neil Avenue, Columbus OH 43210-1298, USA
> http://ling.osu.edu/~dm/                 GnuPG key on web page
>
>
> On Thu, Mar 29, 2007 at 02:12:11PM +0200, Martijn Moeling wrote:
>     Are you properly saving the session at every request?
>     Like:
>
>     # Created session like this:
>     # req.session = Session.Session(req)
>
>     Req.session.save()
>
>     Martijn
>
>     -----Oorspronkelijk bericht-----
>     Van: mod_python-bounces@modpython.org
>     [mailto:mod_python-bounces@modpython.org] Namens Jim Gallacher
>     Verzonden: Wednesday, March 28, 2007 3:00 AM
>     Aan: Detmar Meurers
>     CC: mod_python@modpython.org; Graham Dumpleton
>     Onderwerp: Re: [mod_python] session variable value (partially)
>     dissapearing
>
>     Detmar Meurers wrote:
>     > Hi Graham,
>     >
>     > Thanks for the very quick reply.
>     >
>     > The page showing the problem actually is using the publisher handler
>     > (so no special exception handling etc.)
>     >
>     > I tried the FileSession and the problem occurs there too - and I'm
>     > not doing any calling of unlock().
>     >
>     > I am calling req.session.save() - one question about that though:
>     > Can it possibly cause problems when calling the save() several times
>     > when handling one request?
>
>     It shouldn't matter. The session store is locked so only one request
> can
>
>     read or write at a time. This is the case even if you have session
>     locking turned off, or unlock the session manually.
>
>     Jim
>     _______________________________________________
>     Mod_python mailing list
>     Mod_python@modpython.org
>     http://mailman.modpython.org/mailman/listinfo/mod_python
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>


From dm at ling.ohio-state.edu  Thu Mar 29 16:23:12 2007
From: dm at ling.ohio-state.edu (Detmar Meurers)
Date: Thu Mar 29 16:23:18 2007
Subject: [mod_python] session variable value (partially) dissapearing
In-Reply-To: <59137.68.167.134.138.1175202375.squirrel@mail.panix.com>
References: <B6C73A5E30565245BB6D32B5F5DF7A52120334@sense.emmastraat.pijnacker>
	<20070329190231.GC16374@ling.ohio-state.edu>
	<59137.68.167.134.138.1175202375.squirrel@mail.panix.com>
Message-ID: <20070329212312.GB17292@ling.ohio-state.edu>

Hi Clemens,

    This is off topic. What is the best way to look into AJAX in the python
    environment. Thanks Clemens Herschel

I'm afraid I don't know the best way (and would thus be very curious
to hear others' answers!), but for starting out I found useful:

- simple ajax + json + mod_python with publisher handler example:
  http://jumbo.blindlight.net/~eddie/ajax/json/jsonExample.html

- getting a sensible debugging tool for AJAX requests: firebug, cf.:
  http://ajax.phpmagazine.net/2007/01/firebug_10_in_depth.html

Best,
Detmar
From graham.dumpleton at gmail.com  Thu Mar 29 17:24:52 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Mar 29 17:25:05 2007
Subject: [mod_python] Re: Textbooks on psp programming?
In-Reply-To: <460BAB60.7090107@vodamail.co.za>
References: <460964A5.7000302@jgassociates.ca>
	<829078.59411.qm@web38715.mail.mud.yahoo.com>
	<88e286470703281905t5e864819gc1f1f64f8d832fed@mail.gmail.com>
	<460BAB60.7090107@vodamail.co.za>
Message-ID: <88e286470703291524v1dab188hd9dbe68f6ae031e3@mail.gmail.com>

There are no published books available on mod_python or PSP
programming, and no I have no intention of writing one.

The best you can do is to do a Google search for 'mod_python PSP'. If
you dig through the results you will find references to the mod_python
documentation plus a few articles which people have written which talk
about PSP. You should also search for the archives of the mailing list
by plugging in 'PSP' in the search box on the mod_python web site.

For help, ensure you are subscribed to the mod_python mailing list and
ask your questions there.

Graham

On 29/03/07, Mark <mctse@vodamail.co.za> wrote:
> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
>
> Dear mod_python guru.
>
> I taught myself how to program with php and would love to learn how to
> use mod_python.  I learned php from an excellent book called php4 for
> beginners (after all that's exactly what I was - and am as regards
> python -) and would greatly appreciate it if you could refer me to an
> equivalent book on psp programming.
>
>
> Kindest regards
>
>
>
> Mark Coetsee
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v1.4.7 (MingW32)
>
> iD8DBQFGC6tgLzNh63IR8ssRArusAJ9T9THiyvbu8ZiJtCKuejD+SiiQLQCgm3uG
> RlvXnPYgO94PtrCmvus07VI=
> =V/8D
> -----END PGP SIGNATURE-----
>
>
From nlv11281 at natlab.research.philips.com  Fri Mar 30 01:55:57 2007
From: nlv11281 at natlab.research.philips.com (Mike Looijmans)
Date: Fri Mar 30 01:56:07 2007
Subject: [mod_python] how to use Mysql on mod_python+apache?
In-Reply-To: <B6C73A5E30565245BB6D32B5F5DF7A52120333@sense.emmastraat.pijnacker>
References: <B6C73A5E30565245BB6D32B5F5DF7A52120333@sense.emmastraat.pijnacker>
Message-ID: <460CB47D.3000809@natlab.research.philips.com>

 > ...
> with this method of using mysqldb, the database connection is closed
> properly, even if the handler code runs into an error, if not and an
> error occurs and the connection is kept by MySQL and at the end it will
> run out of resources (and/or memory whatever comes first).

I did notice in the past that when a MySQLdb connection object goes out of scope, it was not 
immediately closed(), so there are probably cyclic dependencies inside. However, the garbage 
collector should pick them up soon enough.

In the past, i have often created something alike a publisher handler, but which allowed the 
callables to accept a "db" parameter. This would trigger the handler to setup a DB connection, and 
using a try..finally... block assured that the connection was being closed (or recycled to the pool) 
asap. Using a connection pool (to prevent re-connect time) turned out to be simple but useless on 
MySQL, I could not measure (and statistically prove) a performance improvement.

Another good tip:
If the MySQL database is running on the same host as the webserver, you can probably disable TCP/IP 
completely for the database server. The MySQLdb interface is using slightly more efficient UNIX 
sockets (or named pipes if on Windows) anyway for local connections, and disabling network 
connections greatly improves security, since you can only make connections from localhost. Putting 
the mysql username/password in a plaintext file is no problem then. I usually use SSH to manage the 
database remotely.


From roberto at connexer.com  Fri Mar 30 05:48:14 2007
From: roberto at connexer.com (Roberto =?iso-8859-1?Q?C=2E_S=E1nchez?=)
Date: Fri Mar 30 05:48:20 2007
Subject: [mod_python] how to use Mysql on mod_python+apache?
In-Reply-To: <460CB47D.3000809@natlab.research.philips.com>
References: <B6C73A5E30565245BB6D32B5F5DF7A52120333@sense.emmastraat.pijnacker>
	<460CB47D.3000809@natlab.research.philips.com>
Message-ID: <20070330104814.GA30880@miami.connexer.com>

On Fri, Mar 30, 2007 at 08:55:57AM +0200, Mike Looijmans wrote:
> 
> Another good tip:
> If the MySQL database is running on the same host as the webserver, you can 
> probably disable TCP/IP completely for the database server. The MySQLdb 
> interface is using slightly more efficient UNIX sockets (or named pipes if 
> on Windows) anyway for local connections, and disabling network connections 
> greatly improves security, since you can only make connections from 
> localhost. Putting the mysql username/password in a plaintext file is no 
> problem then. I usually use SSH to manage the database remotely.
> 
The same can probably be said of any SQL database.  A while back, I read
"The Art of SQL".  There is a section on performance tuning/improvement
where the author talks about how using network connections to talk to
the database incur a fairly large performance hit (I want to say 43%,
but I don't recall for certain).

This is similar to when have X clients speaking to an X server on the
same host.  They use UNIX domain sockets for performance.

Regards,

-Roberto

-- 
Roberto C. S?nchez
http://people.connexer.com/~roberto
http://www.connexer.com
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070330/2cfe49d6/attachment.bin
From mctse at vodamail.co.za  Fri Mar 30 06:10:02 2007
From: mctse at vodamail.co.za (Mark)
Date: Fri Mar 30 06:11:17 2007
Subject: [mod_python] Re: Textbooks on psp programming?
In-Reply-To: <88e286470703291524v1dab188hd9dbe68f6ae031e3@mail.gmail.com>
References: <460964A5.7000302@jgassociates.ca>	
	<829078.59411.qm@web38715.mail.mud.yahoo.com>	
	<88e286470703281905t5e864819gc1f1f64f8d832fed@mail.gmail.com>	
	<460BAB60.7090107@vodamail.co.za>
	<88e286470703291524v1dab188hd9dbe68f6ae031e3@mail.gmail.com>
Message-ID: <460CF00A.7080303@vodamail.co.za>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
 
Dear Graham

Thank you for your prompt reply.  Just one more question - which
course should I follow - "python publisher" or "psp"?


Kindest regards



Mark Coetsee


Graham Dumpleton wrote:
> There are no published books available on mod_python or PSP
> programming, and no I have no intention of writing one.
>
> The best you can do is to do a Google search for 'mod_python PSP'.
> If you dig through the results you will find references to the
> mod_python documentation plus a few articles which people have
> written which talk about PSP. You should also search for the
> archives of the mailing list by plugging in 'PSP' in the search box
> on the mod_python web site.
>
> For help, ensure you are subscribed to the mod_python mailing list
> and ask your questions there.
>
> Graham
>
> On 29/03/07, Mark <mctse@vodamail.co.za> wrote: Dear mod_python
> guru.
>
> I taught myself how to program with php and would love to learn how
> to use mod_python.  I learned php from an excellent book called
> php4 for beginners (after all that's exactly what I was - and am as
> regards python -) and would greatly appreciate it if you could
> refer me to an equivalent book on psp programming.
>
>
> Kindest regards
>
>
>
> Mark Coetsee
>>
>>

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (MingW32)
 
iD8DBQFGDPAKLzNh63IR8ssRAvTvAKDPeGtDWRbf33xU4y1xAwSQl8vqHwCghqet
OiDYcGA3VQIeKqLIk9lAqf4=
=M7JJ
-----END PGP SIGNATURE-----

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070330/4359bbcb/attachment.html
From martijn at xs4us.nu  Fri Mar 30 08:28:30 2007
From: martijn at xs4us.nu (Martijn Moeling)
Date: Fri Mar 30 08:29:06 2007
Subject: [mod_python] session variable value (partially) dissapearing
Message-ID: <B6C73A5E30565245BB6D32B5F5DF7A52120339@sense.emmastraat.pijnacker>

Well you are welcome,

I found this mailinglist usefull especially in the beginning, but still
I see solutions/techniques I start using.

I have been Involved in opensource projects since the Linux kernel 
Had no tcp/ip stack and I contributed to that.
And one of the main things is that people should help each other.

I keep reading all posts and If I think I can help someone I will,
trying to keep the workload of Graham and Jim (and others) somewhat
lighter.

I also try to contribute by sending parts of my work to people who need
it. I am developing a application framework with a desktop in a browser,
which is way from done yet but in order to get my system working on
multiple servers (load balancing) I needed a way to store Sessions
differently so I wrote a replacement for Session.py which stores the
sessions in MySQL (using MySQLdb), unfortunately this relies to much on
3rd party software to become part of mod_python, but for the Interested
it is available as a replacement for the standard session.py

So it is useful to keep reading this mailinglist, even if you know
everything to do your project(s), and help others by sharing your
knowledge, In my eyes the only way to keep mod_python (or similar Open
Source projects) alive and kicking

So thank us by helping others, with that you free up time for the
developers and Graham can leave his laptop home next time he goes away
for the holidays (if he wishes too). But more important for you, you
keep yourself being informed end educated in the process.

Anyway thanks for at least taking the time to thank, it is appreciated.

Martijn 

-----Oorspronkelijk bericht-----
Van: mod_python-bounces@modpython.org
[mailto:mod_python-bounces@modpython.org] Namens Detmar Meurers
Verzonden: Thursday, March 29, 2007 9:03 PM
Aan: mod_python@modpython.org
Onderwerp: Re: [mod_python] session variable value (partially)
dissapearing

Dear Martijn (et al.),

I think I found what the problem was - and the loss of session data
apparently was related to properly saving it, as you and Graham had
suggested: For some of the possible paths through my code doing
partial page updates, the session did not get saved - i.e., I was
missing some req.session.save() calls in the sub-functions handling
those AJAX requests. 

Thanks for the replies - it's great to know there is a community one
can discuss such issues with!

Best,
Detmar

--
Detmar Meurers, Associate Professor, Dept. of Linguistics, OSU
201a Oxley Hall, 1712 Neil Avenue, Columbus OH 43210-1298, USA
http://ling.osu.edu/~dm/                 GnuPG key on web page


On Thu, Mar 29, 2007 at 02:12:11PM +0200, Martijn Moeling wrote:
    Are you properly saving the session at every request?
    Like:
    
    # Created session like this:
    # req.session = Session.Session(req)
    
    Req.session.save()
    
    Martijn
    
    -----Oorspronkelijk bericht-----
    Van: mod_python-bounces@modpython.org
    [mailto:mod_python-bounces@modpython.org] Namens Jim Gallacher
    Verzonden: Wednesday, March 28, 2007 3:00 AM
    Aan: Detmar Meurers
    CC: mod_python@modpython.org; Graham Dumpleton
    Onderwerp: Re: [mod_python] session variable value (partially)
    dissapearing
    
    Detmar Meurers wrote:
    > Hi Graham,
    > 
    > Thanks for the very quick reply.
    > 
    > The page showing the problem actually is using the publisher
handler
    > (so no special exception handling etc.)
    > 
    > I tried the FileSession and the problem occurs there too - and I'm
    > not doing any calling of unlock().
    > 
    > I am calling req.session.save() - one question about that though:
    > Can it possibly cause problems when calling the save() several
times
    > when handling one request?
    
    It shouldn't matter. The session store is locked so only one request
can
    
    read or write at a time. This is the case even if you have session 
    locking turned off, or unlock the session manually.
    
    Jim
    _______________________________________________
    Mod_python mailing list
    Mod_python@modpython.org
    http://mailman.modpython.org/mailman/listinfo/mod_python
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python

From steino at ccri.net  Fri Mar 30 08:59:00 2007
From: steino at ccri.net (Olaf Stein)
Date: Fri Mar 30 08:59:33 2007
Subject: [mod_python] Form variables question
Message-ID: <C2328FE4.1C24%steino@ccri.net>

Hi All

I am not too experienced with mod_python, so excuse me if this is a silly
question.

I have a form (method post):

<input type=text name=userid>
<input type=text name=pw>

When the form button is clicked I call a function login(req,userid,pw)
Within this function I can use the variables userid and pw to authenticate a
user.

Is this the ideal/safest way of passing variables or are there any
other/better mechanisms

Thanks
Olaf

From richardlewis at fastmail.co.uk  Fri Mar 30 10:05:44 2007
From: richardlewis at fastmail.co.uk (Richard Lewis)
Date: Fri Mar 30 10:06:00 2007
Subject: [mod_python] Form variables question
In-Reply-To: <C2328FE4.1C24%steino@ccri.net>
References: <C2328FE4.1C24%steino@ccri.net>
Message-ID: <200703301605.44767.richardlewis@fastmail.co.uk>

Couple of things caught my eye

On Friday 30 March 2007 14:59, Olaf Stein wrote:
>
> I have a form (method post):
>
> <input type=text name=userid>
> <input type=text name=pw>
>
A little OT (for mod_python), but this is not well-formed HTML 4 or XHTML 1. 
You should use quote marks for attribute values and (for XHTML) <input> must 
be an empty element:

<input type="text" name="userid" />

Also note that there is an <input type="password"> element which (on most 
browsers) does not echo input. It's a nice touch ;-)

> When the form button is clicked I call a function login(req,userid,pw)
> Within this function I can use the variables userid and pw to authenticate
> a user.
>
> Is this the ideal/safest way of passing variables or are there any
> other/better mechanisms
>
This is a good way for sending general variables. But you may want a more 
secure method of sending login credentials. (If you're asking about sending 
the variables around inside your Python script, once the variables have 
arrived at the server, you can pass them around your Python script as much as 
you without any security implications.)

You can obfuscate the login details by using POST instad of GET, but this only 
means that the user can't seem them once they submit the login form. The only 
security advantage is that a near-by user can't glance at the URL on his 
neighbour's screen to get the password.

You can use SSL to send information over an encrypted connection.

You can also (and this is easiest, assuming you have access to the Apache 
configuration) use Apache's built-in authentication system. See: 
http://httpd.apache.org/docs/2.0/howto/auth.html. You can access the user 
name and password the user provided via Request.user and 
Request.get_basic_auth_pw().

See:
http://www.modpython.org/live/current/doc-html/pyapi-mprequest-mem.html#l2h-124
http://www.modpython.org/live/current/doc-html/pyapi-mprequest-meth.html#l2h-58

Cheers,
Richard
-- 
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
Richard Lewis
http://www.richard-lewis.me.uk/
JID: ironchicken@jabber.earth.li
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
From sdavis2 at mail.nih.gov  Fri Mar 30 10:35:45 2007
From: sdavis2 at mail.nih.gov (Sean Davis)
Date: Fri Mar 30 10:35:48 2007
Subject: [mod_python] Form variables question
In-Reply-To: <200703301605.44767.richardlewis@fastmail.co.uk>
References: <C2328FE4.1C24%steino@ccri.net>
	<200703301605.44767.richardlewis@fastmail.co.uk>
Message-ID: <200703301135.45221.sdavis2@mail.nih.gov>

On Friday 30 March 2007 11:05, Richard Lewis wrote:
> Couple of things caught my eye
>
> On Friday 30 March 2007 14:59, Olaf Stein wrote:
> > I have a form (method post):
> >
> > <input type=text name=userid>
> > <input type=text name=pw>
>
> A little OT (for mod_python), but this is not well-formed HTML 4 or XHTML
> 1. You should use quote marks for attribute values and (for XHTML) <input>
> must be an empty element:
>
> <input type="text" name="userid" />
>
> Also note that there is an <input type="password"> element which (on most
> browsers) does not echo input. It's a nice touch ;-)
>
> > When the form button is clicked I call a function login(req,userid,pw)
> > Within this function I can use the variables userid and pw to
> > authenticate a user.
> >
> > Is this the ideal/safest way of passing variables or are there any
> > other/better mechanisms
>
> This is a good way for sending general variables. But you may want a more
> secure method of sending login credentials. (If you're asking about sending
> the variables around inside your Python script, once the variables have
> arrived at the server, you can pass them around your Python script as much
> as you without any security implications.)
>
> You can obfuscate the login details by using POST instad of GET, but this
> only means that the user can't seem them once they submit the login form.
> The only security advantage is that a near-by user can't glance at the URL
> on his neighbour's screen to get the password.
>
> You can use SSL to send information over an encrypted connection.

Just a couple of other suggestions....

Or encrypt the password using javascript before sending.

> You can also (and this is easiest, assuming you have access to the Apache
> configuration) use Apache's built-in authentication system. See:
> http://httpd.apache.org/docs/2.0/howto/auth.html. You can access the user
> name and password the user provided via Request.user and
> Request.get_basic_auth_pw().

There is also digest authentication, which is more secure than basic 
authentication.

> See:
> http://www.modpython.org/live/current/doc-html/pyapi-mprequest-mem.html#l2h
>-124
> http://www.modpython.org/live/current/doc-html/pyapi-mprequest-meth.html#l2
>h-58
>
> Cheers,
> Richard
From steino at ccri.net  Fri Mar 30 10:38:46 2007
From: steino at ccri.net (Olaf Stein)
Date: Fri Mar 30 10:39:25 2007
Subject: [mod_python] Templating system issue
Message-ID: <C232A746.1C35%steino@ccri.net>

Hi All,

I am writing a little app using mod_python and PyMeld as a templating
system. I have my own class for handling sessions and now want to pass the
session id from function to function.

PyMeld works fine, except it does not allow me (at least not to my
knowledge) to e.g set values for hidden fields or attach the session id to
the url, it only lets me set "display" values not values for attributes
themselves, which is what I would need in this case.


An PyMeld example ( http://entrian.com/PyMeld/)
------------------------
page = Meld('<html><span id="x">Hello world</span></html>')
page.x = "Goodbye"
-------------------------

The id attribute basically represents the value of displayed in between span
tags, I cannot set values for attributes themselves.

Does anyone know if PyMeld can make this happen or of a templating system
that supports this kind of thing?

Thanks again
Olaf

From steino at ccri.net  Fri Mar 30 10:49:46 2007
From: steino at ccri.net (Olaf Stein)
Date: Fri Mar 30 10:50:15 2007
Subject: [mod_python] Templating system issue
In-Reply-To: <C232A746.1C35%steino@ccri.net>
Message-ID: <C232A9DA.1C39%steino@ccri.net>

Sorry,

Just for out how it works....

Page.x.attributename=whatever


On 3/30/07 11:38 AM, "Olaf Stein" <steino@ccri.net> wrote:

> Hi All,
> 
> I am writing a little app using mod_python and PyMeld as a templating
> system. I have my own class for handling sessions and now want to pass the
> session id from function to function.
> 
> PyMeld works fine, except it does not allow me (at least not to my
> knowledge) to e.g set values for hidden fields or attach the session id to
> the url, it only lets me set "display" values not values for attributes
> themselves, which is what I would need in this case.
> 
> 
> An PyMeld example ( http://entrian.com/PyMeld/)
> ------------------------
> page = Meld('<html><span id="x">Hello world</span></html>')
> page.x = "Goodbye"
> -------------------------
> 
> The id attribute basically represents the value of displayed in between span
> tags, I cannot set values for attributes themselves.
> 
> Does anyone know if PyMeld can make this happen or of a templating system
> that supports this kind of thing?
> 
> Thanks again
> Olaf
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python





-------------------------
Olaf Stein
DBA
Center for Quantitative and Computational Biology
Columbus Children's Research Institute
700 Children's Drive
phone: 1-614-355-5685
cell: 1-614-843-0432
email: steino@ccri.net

From sdavis2 at mail.nih.gov  Fri Mar 30 11:09:30 2007
From: sdavis2 at mail.nih.gov (Sean Davis)
Date: Fri Mar 30 11:09:53 2007
Subject: [mod_python] Templating system issue
In-Reply-To: <C232A9DA.1C39%steino@ccri.net>
References: <C232A9DA.1C39%steino@ccri.net>
Message-ID: <200703301209.30894.sdavis2@mail.nih.gov>

On Friday 30 March 2007 11:49, Olaf Stein wrote:
> Sorry,
>
> Just for out how it works....
>
> Page.x.attributename=whatever
>
> On 3/30/07 11:38 AM, "Olaf Stein" <steino@ccri.net> wrote:
> > Hi All,
> >
> > I am writing a little app using mod_python and PyMeld as a templating
> > system. I have my own class for handling sessions and now want to pass
> > the session id from function to function.
> >
> > PyMeld works fine, except it does not allow me (at least not to my
> > knowledge) to e.g set values for hidden fields or attach the session id
> > to the url, it only lets me set "display" values not values for
> > attributes themselves, which is what I would need in this case.

How about:

<hidden id='sessionid'>12345678</hidden>

Then using pymeld:

Page.sessionid='456789123'

Sean
From martinsenkerik at email.cz  Fri Mar 30 12:33:30 2007
From: martinsenkerik at email.cz (=?iso-8859-2?B?TWFydGluIKllbmtl+O1r?=)
Date: Fri Mar 30 12:33:37 2007
Subject: [mod_python] in modpython ,how to restrict the upload file size?
Message-ID: <op.tp0i14eqju6s6z@localhost>


This solution works fine only for Opera web browser for me. Others (I've  
tested Firefox and IE6) continues with transfer. In http specification is  
about "413: Request Entity Too Large" among others written:

"The server MAY close the connection to prevent the client from continuing  
the request."

I was trying to find way, how force client to stop the transfer and to  
redirect them to some explanation page. But with no result. Do you have  
any ideas? Or is it possible, that problem is somewhere else? e.g. wrong  
configuration of Apache, mod_python...?

(using Apache/2.2.3, mod_python/3.3.1 Python/2.4.4 on Debian)

Best regards Ohin
From graham.dumpleton at gmail.com  Fri Mar 30 20:44:26 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Fri Mar 30 20:44:46 2007
Subject: [mod_python] Re: Textbooks on psp programming?
In-Reply-To: <460CF00A.7080303@vodamail.co.za>
References: <460964A5.7000302@jgassociates.ca>
	<829078.59411.qm@web38715.mail.mud.yahoo.com>
	<88e286470703281905t5e864819gc1f1f64f8d832fed@mail.gmail.com>
	<460BAB60.7090107@vodamail.co.za>
	<88e286470703291524v1dab188hd9dbe68f6ae031e3@mail.gmail.com>
	<460CF00A.7080303@vodamail.co.za>
Message-ID: <88e286470703301844u29a59a73h6fc508b2f328511e@mail.gmail.com>

It really depends on what you want to do. If you are new to
Python/mod_python, what I might suggest is you go have a look at
Django (http://www.djangoproject.com/) instead. This is a much more
higher level framework for building web applications with Python. It
can be run on top of mod_python, but also on a host of other web
hosting technologies for Python as well. All in all, you will probably
find the tutorial introduction to Django and its documentation a
gentler introduction to programming web applications with Python than
mod_python as mod_python operates at a much lower level than what you
may be used to.

Graham

On 30/03/07, Mark <mctse@vodamail.co.za> wrote:
>
>  -----BEGIN PGP SIGNED MESSAGE-----
>  Hash: SHA1
>
>  Dear Graham
>
>  Thank you for your prompt reply.  Just one more question - which
>  course should I follow - "python publisher" or "psp"?
>
>
>  Kindest regards
>
>
>
>  Mark Coetsee
>
>
>  Graham Dumpleton wrote:
>  > There are no published books available on mod_python or PSP
>  > programming, and no I have no intention of writing one.
>  >
>  > The best you can do is to do a Google search for 'mod_python PSP'.
>  > If you dig through the results you will find references to the
>  > mod_python documentation plus a few articles which people have
>  > written which talk about PSP. You should also search for the
>  > archives of the mailing list by plugging in 'PSP' in the search box
>  > on the mod_python web site.
>  >
>  > For help, ensure you are subscribed to the mod_python mailing list
>  > and ask your questions there.
>  >
>  > Graham
>  >
>  > On 29/03/07, Mark <mctse@vodamail.co.za> wrote: Dear mod_python
>  > guru.
>  >
>  > I taught myself how to program with php and would love to learn how
>  > to use mod_python.  I learned php from an excellent book called
>  > php4 for beginners (after all that's exactly what I was - and am as
>  > regards python -) and would greatly appreciate it if you could
>  > refer me to an equivalent book on psp programming.
>  >
>  >
>  > Kindest regards
>  >
>  >
>  >
>  > Mark Coetsee
>  >>
>  >>
>
>  -----BEGIN PGP SIGNATURE-----
>  Version: GnuPG v1.4.7 (MingW32)
>
> iD8DBQFGDPAKLzNh63IR8ssRAvTvAKDPeGtDWRbf33xU4y1xAwSQl8vqHwCghqet
>  OiDYcGA3VQIeKqLIk9lAqf4=
>  =M7JJ
>  -----END PGP SIGNATURE-----
>
>
From graham.dumpleton at gmail.com  Sat Mar 31 00:28:41 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sat Mar 31 00:28:51 2007
Subject: [mod_python] in modpython ,how to restrict the upload file size?
In-Reply-To: <op.tp0i14eqju6s6z@localhost>
References: <op.tp0i14eqju6s6z@localhost>
Message-ID: <88e286470703302228yf82dd1fy5ebf80855a1c6ac@mail.gmail.com>

On 31/03/07, Martin ?enke??k <martinsenkerik@email.cz> wrote:
>
> This solution works fine only for Opera web browser for me. Others (I've
> tested Firefox and IE6) continues with transfer. In http specification is
> about "413: Request Entity Too Large" among others written:
>
> "The server MAY close the connection to prevent the client from continuing
> the request."
>
> I was trying to find way, how force client to stop the transfer and to
> redirect them to some explanation page. But with no result. Do you have
> any ideas? Or is it possible, that problem is somewhere else? e.g. wrong
> configuration of Apache, mod_python...?
>
> (using Apache/2.2.3, mod_python/3.3.1 Python/2.4.4 on Debian)

See:

 http://www.w3.org/Protocols/rfc2616/rfc2616-sec8.html

Especially section 8.2.3

It all depends on whether the browser is using HTTP/1.1 and whether it
is sending an Expect header with value 100-continue and subsequently
waiting for a 100 continue response before sending the content.

If it isn't then the client would be sending the content anyway and
once it does you can't stop it.

Thus, on your server side dump out to the log what headers are being
sent by client and see what browsers are sending the Expect header and
which aren't.

I don't know how you might tell the browser to use this.

Graham

From graham.dumpleton at gmail.com  Sat Mar 31 20:18:22 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sat Mar 31 20:18:29 2007
Subject: [mod_python] in modpython ,how to restrict the upload file size?
In-Reply-To: <op.tp2idnluju6s6z@trilobit>
References: <op.tp0i14eqju6s6z@localhost>
	<88e286470703302228yf82dd1fy5ebf80855a1c6ac@mail.gmail.com>
	<op.tp2idnluju6s6z@trilobit>
Message-ID: <88e286470703311818g107ae776o83dc5c980ab7b102@mail.gmail.com>

On 01/04/07, Martin ?enke??k <martinsenkerik@email.cz> wrote:
> Thank you for your explanation!
>
> I think, now I understand more deeply the machinery around.
>
> I realized that in my case I need to close connection to client at my own.
> Some clients, while sending POST request, don't react to any response from
> the server. However, I was reading through manual and internet but I
> didn't find way, how to do it. The connection object doesn't seem to
> provide a way how to close connection....
>
> So, my question is: what is the way to force closing the TCP connection to
> client?

In general Apache will do that for you, when appropriate. This will
not stop the client sending data straight away. The client may only
detect that the connection has closed after writing some amount of
data and it gets an error. So you can't eliminate the client sending
at least some data except by the client using the 100-continue feature
properly.

BTW, please use reply-all to keep discussion on mailing list.

Graham

> Dne Sat, 31 Mar 2007 07:28:41 +0200 Graham Dumpleton
> <graham.dumpleton@gmail.com> napsal/-a:
>
> > On 31/03/07, Martin ?enke??k <martinsenkerik@email.cz> wrote:
> >>
> >> This solution works fine only for Opera web browser for me. Others (I've
> >> tested Firefox and IE6) continues with transfer. In http specification
> >> is
> >> about "413: Request Entity Too Large" among others written:
> >>
> >> "The server MAY close the connection to prevent the client from
> >> continuing
> >> the request."
> >>
> >> I was trying to find way, how force client to stop the transfer and to
> >> redirect them to some explanation page. But with no result. Do you have
> >> any ideas? Or is it possible, that problem is somewhere else? e.g. wrong
> >> configuration of Apache, mod_python...?
> >>
> >> (using Apache/2.2.3, mod_python/3.3.1 Python/2.4.4 on Debian)
> >
> > See:
> >
> >  http://www.w3.org/Protocols/rfc2616/rfc2616-sec8.html
> >
> > Especially section 8.2.3
> >
> > It all depends on whether the browser is using HTTP/1.1 and whether it
> > is sending an Expect header with value 100-continue and subsequently
> > waiting for a 100 continue response before sending the content.
> >
> > If it isn't then the client would be sending the content anyway and
> > once it does you can't stop it.
> >
> > Thus, on your server side dump out to the log what headers are being
> > sent by client and see what browsers are sending the Expect header and
> > which aren't.
> >
> > I don't know how you might tell the browser to use this.
> >
> > Graham
>
>
>

