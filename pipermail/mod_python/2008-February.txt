From scott at 3floors.com  Fri Feb  1 02:40:39 2008
From: scott at 3floors.com (Scott Bratcher)
Date: Fri Feb  1 02:39:48 2008
Subject: [mod_python] Apache Fails to load mod_python.so with Permission
	denied error under SELinux
In-Reply-To: <88e286470801312010x170d346bn891ea7dd80a3abe4@mail.gmail.com>
References: <D984D547-3319-4444-9C24-C330FB3631A3@3floors.com>
	<47A1F394.4030506@brunson.com>
	<100F2336-310A-4970-B4BB-E27247DF66EE@3floors.com>
	<004f01c86441$6e292060$0200a8c0@TMSMAIN>
	<F593A28B-30EE-4BA9-898C-522D36C034D6@3floors.com>
	<88e286470801311651j4e2c129al2c4cb226c3ca51a0@mail.gmail.com>
	<7B19A3C2-910E-4F06-B9EE-F4FEEEB2ED39@3floors.com>
	<88e286470801312010x170d346bn891ea7dd80a3abe4@mail.gmail.com>
Message-ID: <37640B8D-EA3F-4601-9D46-8FD6009998AD@3floors.com>

Graham,

Great, thanks, and since it's missing...

I reinstalled python with:
# ./configure --enable-shared
# make
# make install

and then rebuilt mod_python with:
# ./configure --with-apxs=/usr/sbin/apxs --with-python=/usr/local/bin/ 
python
# make
# make install

Apache started right up. Thank you for the help in getting over that  
hump.

Now I'm getting an [500] Internal Server Error in the browser with  
this output to my apache error_logs:

[Fri Feb 01 01:12:33 2008] [notice] SELinux policy enabled; httpd  
running as context user_u:system_r:httpd_t:s0
[Fri Feb 01 01:12:33 2008] [notice] suEXEC mechanism enabled  
(wrapper: /usr/sbin/suexec)
[Fri Feb 01 01:12:34 2008] [notice] Digest: generating secret for  
digest authentication ...
[Fri Feb 01 01:12:34 2008] [notice] Digest: done
[Fri Feb 01 01:12:34 2008] [notice] mod_python: Creating 8 session  
mutexes based on 256 max processes and 0 max threads.
[Fri Feb 01 01:12:34 2008] [notice] mod_python: using  
mutex_directory /tmp
[Fri Feb 01 01:12:34 2008] [notice] Apache/2.2.3 (Red Hat) configured  
-- resuming normal operations
[Fri Feb 01 01:12:50 2008] [error] make_obcallback: could not import  
mod_python.apache.\n
ImportError: No module named mod_python.apache
[Fri Feb 01 01:12:50 2008] [error] make_obcallback: Python path being  
used "['/usr/lib/python25.zip', '/usr/lib/python2.5', '/usr/lib/ 
python2.5/plat-linux2', '/usr/lib/python2.5/lib-tk', '/usr/lib/ 
python2.5/lib-dynload', '/usr/lib/python2.5/site-packages']".
[Fri Feb 01 01:12:50 2008] [error] get_interpreter: no interpreter  
callback found.
[Fri Feb 01 01:12:50 2008] [error] [client xx.xx.xx.xx.]  
python_handler: Can't get/create interpreter.

I've looked all over the list archives to find a solution, and this  
seems like a common error output that has, at times, varied causes.  
However, I wasn't able to locate a post that solved this error for  
me. Can you point me in the right direction?

Thanks again for your help,

Scott


Just in case I've checked my SELinux related permissions and didn't  
find anything out of line. I wouldn't know what file specifically to  
check though...

-rwxr-xr-x  root  root system_u:object_r:bin_t          /usr/bin/python
-rwxr-xr-x  root  root system_u:object_r:httpd_modules_t /usr/lib/ 
httpd/modules/mod_python.so
-rwxr-xr-x  root  root system_u:object_r:bin_t          /usr/local/ 
bin/python2.5
drwxr-xr-x  root  root system_u:object_r:lib_t          /usr/local/ 
lib/python2.5/site-packages/mod_python


USING:
--
RHEL5/SELinux
Apache 2.2
Python 2.5.1
mod_pythonn 3.3.1
httpd.conf (not .htaccess)



On Jan 31, 2008, at 10:10 PM, Graham Dumpleton wrote:

> On 01/02/2008, Scott Bratcher <scott@3floors.com> wrote:
>> Thank you for looking in, Graham,
>>
>> DEPENDENCIES:
>> # ldd /etc/httpd/modules/mod_python.so
>>          linux-gate.so.1 =>  (0x00b16000)
>>          libpthread.so.0 => /lib/libpthread.so.0 (0x00f2d000)
>>          libdl.so.2 => /lib/libdl.so.2 (0x00aa7000)
>>          libutil.so.1 => /lib/libutil.so.1 (0x00110000)
>>          libm.so.6 => /lib/libm.so.6 (0x00114000)
>>          libc.so.6 => /lib/libc.so.6 (0x00453000)
>>          /lib/ld-linux.so.2 (0x0076d000)
>>
>> SIZE:
>> # ls -fla /etc/httpd/modules/mod_python.so
>> -rwxr-xr-x 1 root root 4.1M Jan 31 01:51 /etc/httpd/modules/
>> mod_python.so*
>>
>> I'm game to reinstall python, how do I check to see if there is a
>> libpythonX.Y.so file linked to mod_python.so?
>
> It should appear in that list above.
>
> Check out notes in:
>
>   http://code.google.com/p/modwsgi/wiki/InstallationIssues
>
> This is for mod_wsgi, but it has the same issue with the Python  
> library.
>
> Graham
>
>> On Jan 31, 2008, at 6:51 PM, Graham Dumpleton wrote:
>>
>>> How big is your:
>>>
>>>   /etc/httpd/modules/mod_python.so
>>>
>>> file? If you run ldd on it, what does it output as far as  
>>> dependencies
>>> on shared libraries?
>>>
>>> One of the problems with some Python installations is that they  
>>> still
>>> do not provide a shared library and so a static library gets  
>>> embedded
>>> in mod_python.so. This results in some messy adress relocations  
>>> having
>>> to be done when mod_python.so is loaded. I am wandering whether the
>>> 'reloc' mentioned in:
>>>
>>>   cannot restore segment prot after reloc
>>>
>>> is the module loading relocations and it is having a problem with
>>> that.
>>>
>>> If there is no libpythonX.Y.so linked to mod_python.so, then  
>>> reinstall
>>> Python using --enable-shared to configure, possibly fix up missing
>>> libpythonX.Y.so symlink in Python installed config directory and  
>>> then
>>> rebuild mod_python, see if that makes a difference.
>>>
>>> Probably nothing to do with this, but if nothing else works. :-)
>>>
>>> Graham
>>>
>>> On 01/02/2008, Scott Bratcher <scott@3floors.com> wrote:
>>>> Thanks Eric and Tom,
>>>>
>>>> Unresolved however. I did some permissions tests based on your
>>>> feedback.
>>>>
>>>>
>>>> I'm chasing this issue as though it is a permissions issue and have
>>>> identified SELinux as the hold-up. I've tried all of these  
>>>> permission
>>>> sets on the modules actual folder and the modules symlinked folder.
>>>> I did both directories just in case the permissions trickle down to
>>>> the actual files being loaded by mod_python itself:
>>>>
>>>> # chcon -R -h -u system_u -r object_r -t httpd_sys_content_t /usr/
>>>> lib/
>>>> httpd/modules /etc/httpd/modules
>>>> # chcon -R -h -u user_u -r object_r -t httpd_sys_content_t /usr/ 
>>>> lib/
>>>> httpd/modules /etc/httpd/modules
>>>> # chcon -R -h -u user_u -r object_r -t httpd_modules_t /usr/lib/
>>>> httpd/
>>>> modules /etc/httpd/modules
>>>> # chcon -R -h -u system_u -r object_r -t httpd_modules_t /usr/lib/
>>>> httpd/modules /etc/httpd/modules ((( This one is the original
>>>> permission of all apache modules)))
>>>> # chcon -R -h -u system_u -r object_r -t lib_t /usr/lib/httpd/
>>>> modules /etc/httpd/modules
>>>> # chcon -R -h -u system_u -r object_r -t shlib_t /usr/lib/httpd/
>>>> modules /etc/httpd/modules
>>>> # chcon -R -h -u system_u -r object_r -t textrel_shlib_t /usr/lib/
>>>> httpd/modules /etc/httpd/modules
>>>>
>>>> All gave this error:
>>>> ----------
>>>> # service httpd start
>>>> Starting httpd: httpd: Syntax error on line 210 of /etc/httpd/conf/
>>>> httpd.conf: Syntax error on line 6 of /etc/httpd/conf.d/ 
>>>> python.conf:
>>>> Cannot load /etc/httpd/modules/mod_python.so into server: /etc/ 
>>>> httpd/
>>>> modules/mod_python.so: cannot restore segment prot after reloc:
>>>> Permission denied
>>>>                                                              
>>>> [FAILED]
>>>> ----------
>>>>
>>>> ---> This is the only one that gave me a different error.
>>>> ----------
>>>> # chcon -R -h -u system_u -t textrel_shlib_t /usr/lib/httpd/ 
>>>> modules /
>>>> etc/httpd/modules
>>>> # service httpd start
>>>> Starting httpd: httpd: Syntax error on line 148 of /etc/httpd/conf/
>>>> httpd.conf: Cannot load /etc/httpd/modules/mod_auth_basic.so into
>>>> server: /etc/httpd/modules/mod_auth_basic.so: cannot open shared
>>>> object file: Permission denied
>>>>                                                              
>>>> [FAILED]
>>>> ----------
>>>>
>>>>
>>>> ****AGAIN I MUST NOTE: All is solved by turning off SELinux and/or
>>>> All is solved by not loading mod_python. All other modules loaded
>>>> just fine with their original permissions which matched mod_python
>>>> exactly.
>>>>
>>>>
>>>>
>>>>
>>>> Scott
>>>>
>>>>
>>>>
>>>> On Jan 31, 2008, at 1:42 PM, Tom Stambaugh wrote:
>>>>
>>>>> The incantation that I use (for solving different problems,  
>>>>> though)
>>>>> is:
>>>>>
>>>>> chcon -R -h -t httpd_sys_content_t <filename>
>>>>>
>>>>> I think the "-R" makes it recurse to all children, and I think the
>>>>> "httpd_sys_content_t" is more permissive (though that could be
>>>>> mistaken).
>>>>> The -h causes it to apply to sym links.
>>>>>
>>>>> Afterwords, I get:
>>>>>
>>>>> #ls -lZ adminuser
>>>>> -rw-rw-r--  zeetix   zeetix   user_u:object_r:httpd_sys_content_t
>>>>> <filename>
>>>>>
>>>>> I use Fedora core3/core4 linux, so YMMV.
>>>>>
>>>>> Thx,
>>>>> Tom
>>>>>
>>>>> ----- Original Message -----
>>>>> From: "Scott Bratcher" <scott@3floors.com>
>>>>> To: "Eric Brunson" <brunson@brunson.com>
>>>>> Cc: <mod_python@modpython.org>
>>>>> Sent: Thursday, January 31, 2008 1:47 PM
>>>>> Subject: Re: [mod_python] Apache Fails to load mod_python.so with
>>>>> Permissiondenied error under SELinux
>>>>>
>>>>>
>>>>>> Thanks Eric,
>>>>>>
>>>>>> "setenforce 0" THIS WORKED. Apache started right up
>>>>>>
>>>>>> Below are the results of my attempts as you suggested. I think
>>>>>> we are
>>>>>> onto the problem because with SELinux enforced it loads right up.
>>>>>> However, the chcon command failed to clear up the problem. I'm
>>>>>> new to
>>>>>> SELinux. Is there another possible SELinux related permission
>>>>>> that  may be
>>>>>> the solution? It's just mod_python that is giving this problem
>>>>>> even
>>>>>> though all of the others share the same t permission  
>>>>>> httpd_module.
>>>>>>
>>>>>> # ls -Zd modules
>>>>>> drwxr-xr-x  root root system_u:object_r:httpd_modules_t modules/
>>>>>>
>>>>>> So I changed the permissions:
>>>>>>
>>>>>> # chcon -t texrel_shlib_t /etc/httpd/modules/mod_python.so
>>>>>> # service httpd start
>>>>>> Starting httpd: httpd: Syntax error on line 210 of /etc/httpd/ 
>>>>>> conf/
>>>>>> httpd.conf: Syntax error on line 6 of /etc/httpd/conf.d/
>>>>>> python.conf:
>>>>>> Cannot load /etc/httpd/modules/mod_python.so into server: /etc/
>>>>>> httpd/
>>>>>> modules/mod_python.so: cannot restore segment prot after reloc:
>>>>>> Permission denied
>>>>>>                                                             
>>>>>> [FAILED]
>>>>>> # ls -Z /etc/httpd/modules/mod_python.so
>>>>>> -rwxr-xr-x  root root system_u:object_r:textrel_shlib_t /etc/ 
>>>>>> httpd/
>>>>>> modules/mod_python.so*
>>>>>>
>>>>>>
>>>>>>
>>>>>> I also tried changing the permissions of the 2.5 site-packages
>>>>>> to the
>>>>>> same permissions as the previously working 2.4 site-packages,
>>>>>> plus  the
>>>>>> other listed below, and the still Apache Failure occurs.
>>>>>>
>>>>>> # ls -Zd /usr/local/lib/python2.5/site-packages/ /usr/lib/
>>>>>> python2.4/
>>>>>> site-packages/
>>>>>> drwxr-xr-x  root root system_u:object_r:lib_t           /usr/lib/
>>>>>> python2.4/site-packages/
>>>>>> drwxr-xr-x  root root user_u:object_r:lib_t             /usr/ 
>>>>>> local/
>>>>>> lib/python2.5/site-packages/
>>>>>>
>>>>>> system_u:object_r:lib_t
>>>>>> system_u:object_r:textrel_shlib_t
>>>>>> user_u:object_r:textrel_shlib_t
>>>>>>
>>>>>>
>>>>>> If you have other tips I'd appreciate any help you can offer.
>>>>>>
>>>>>> Scott
>>>>>>
>>>>>>
>>>>>>
>>>>>> On Jan 31, 2008, at 10:13 AM, Eric Brunson wrote:
>>>>>>
>>>>>>> Scott Bratcher wrote:
>>>>>>>> Hello all,
>>>>>>>>
>>>>>>>>
>>>>>>>> THE PROBLEM:
>>>>>>>>
>>>>>>>> Starting Apache results in this error:
>>>>>>>>
>>>>>>>> # service httpd start
>>>>>>>> Starting httpd: httpd: Syntax error on line 210 of /etc/httpd/
>>>>>>>> conf/
>>>>>>>> httpd.conf: Syntax error on line 6 of /etc/httpd/conf.d/
>>>>>>>> python.conf:
>>>>>>>> Cannot load /etc/httpd/modules/mod_python.so into  server:
>>>>>>>> /etc/httpd/modules/mod_python.so: cannot restore segment  prot
>>>>>>>> after
>>>>>>>> reloc: Permission denied
>>>>>>>>
>>>>>>>> [FAILED]
>>>>>>>>
>>>>>>>
>>>>>>> This error message is often related to selinux permissions.
>>>>>>>
>>>>>>> A quick check to see if that is the problem is to disable
>>>>>>> selinux  with
>>>>>>> the command (as root) "setenforce 0".  If the module then  loads
>>>>>>> correctly, it can be fixed permanently with the command:
>>>>>>>
>>>>>>> chcon -t texrel_shlib_t /etc/httpd/modules/mod_python.so
>>>>>>>
>>>>>>> Then, re-enable selinux with "setenforce 1".
>>>>>>>
>>>>>>> If disabling selinux does not fix the problem, then more
>>>>>>> investigation
>>>>>>> is required.
>>>>>>>
>>>>>>> Hope that helps,
>>>>>>> e.
>>>>>>>
>>>>>>>> USING:
>>>>>>>>
>>>>>>>> RHEL5 / SELinux
>>>>>>>> Apache 2.2
>>>>>>>> Python 2.5.1
>>>>>>>> mod_pythonn 3.3.1
>>>>>>>> httpd.conf (not .htaccess)
>>>>>>>>
>>>>>>>>
>>>>>>>> TESTED THUS FAR:
>>>>>>>>
>>>>>>>> .so file exists with same permissions as other modules
>>>>>>>> # ls -Z /etc/httpd/modules/mod_python.so
>>>>>>>> -rwxr-xr-x  root root system_u:object_r:httpd_modules_t /etc/
>>>>>>>> httpd/
>>>>>>>> modules/mod_python.so*
>>>>>>>>
>>>>>>>> If I comment out:
>>>>>>>> "#LoadModule python_module modules/mod_python.so"
>>>>>>>> and other related python lines Apache starts just fine without
>>>>>>>> mod_python.
>>>>>>>> # service httpd start
>>>>>>>> Starting httpd:
>>>>>>>> [  OK  ]
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>
>>>>>>
>>>>>> _______________________________________________
>>>>>> Mod_python mailing list
>>>>>> Mod_python@modpython.org
>>>>>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>>>>>
>>>>>
>>>>>
>>>>>
>>>>
>>>> _______________________________________________
>>>> Mod_python mailing list
>>>> Mod_python@modpython.org
>>>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>>>
>>
>>

From graham.dumpleton at gmail.com  Fri Feb  1 02:53:00 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Fri Feb  1 02:53:11 2008
Subject: [mod_python] Apache Fails to load mod_python.so with Permission
	denied error under SELinux
In-Reply-To: <37640B8D-EA3F-4601-9D46-8FD6009998AD@3floors.com>
References: <D984D547-3319-4444-9C24-C330FB3631A3@3floors.com>
	<47A1F394.4030506@brunson.com>
	<100F2336-310A-4970-B4BB-E27247DF66EE@3floors.com>
	<004f01c86441$6e292060$0200a8c0@TMSMAIN>
	<F593A28B-30EE-4BA9-898C-522D36C034D6@3floors.com>
	<88e286470801311651j4e2c129al2c4cb226c3ca51a0@mail.gmail.com>
	<7B19A3C2-910E-4F06-B9EE-F4FEEEB2ED39@3floors.com>
	<88e286470801312010x170d346bn891ea7dd80a3abe4@mail.gmail.com>
	<37640B8D-EA3F-4601-9D46-8FD6009998AD@3floors.com>
Message-ID: <88e286470801312353x12fdcac5n8333ba00aeb8886a@mail.gmail.com>

Python components of mod_python not installed, or not readable by
Apache, or access being blocked by SELinux.

Try validation checks in:

  http://www.dscpl.com.au/wiki/ModPython/Articles/GettingModPythonWorking

Graham

On 01/02/2008, Scott Bratcher <scott@3floors.com> wrote:
> Graham,
>
> Great, thanks, and since it's missing...
>
> I reinstalled python with:
> # ./configure --enable-shared
> # make
> # make install
>
> and then rebuilt mod_python with:
> # ./configure --with-apxs=/usr/sbin/apxs --with-python=/usr/local/bin/
> python
> # make
> # make install
>
> Apache started right up. Thank you for the help in getting over that
> hump.
>
> Now I'm getting an [500] Internal Server Error in the browser with
> this output to my apache error_logs:
>
> [Fri Feb 01 01:12:33 2008] [notice] SELinux policy enabled; httpd
> running as context user_u:system_r:httpd_t:s0
> [Fri Feb 01 01:12:33 2008] [notice] suEXEC mechanism enabled
> (wrapper: /usr/sbin/suexec)
> [Fri Feb 01 01:12:34 2008] [notice] Digest: generating secret for
> digest authentication ...
> [Fri Feb 01 01:12:34 2008] [notice] Digest: done
> [Fri Feb 01 01:12:34 2008] [notice] mod_python: Creating 8 session
> mutexes based on 256 max processes and 0 max threads.
> [Fri Feb 01 01:12:34 2008] [notice] mod_python: using
> mutex_directory /tmp
> [Fri Feb 01 01:12:34 2008] [notice] Apache/2.2.3 (Red Hat) configured
> -- resuming normal operations
> [Fri Feb 01 01:12:50 2008] [error] make_obcallback: could not import
> mod_python.apache.\n
> ImportError: No module named mod_python.apache
> [Fri Feb 01 01:12:50 2008] [error] make_obcallback: Python path being
> used "['/usr/lib/python25.zip', '/usr/lib/python2.5', '/usr/lib/
> python2.5/plat-linux2', '/usr/lib/python2.5/lib-tk', '/usr/lib/
> python2.5/lib-dynload', '/usr/lib/python2.5/site-packages']".
> [Fri Feb 01 01:12:50 2008] [error] get_interpreter: no interpreter
> callback found.
> [Fri Feb 01 01:12:50 2008] [error] [client xx.xx.xx.xx.]
> python_handler: Can't get/create interpreter.
>
> I've looked all over the list archives to find a solution, and this
> seems like a common error output that has, at times, varied causes.
> However, I wasn't able to locate a post that solved this error for
> me. Can you point me in the right direction?
>
> Thanks again for your help,
>
> Scott
>
>
> Just in case I've checked my SELinux related permissions and didn't
> find anything out of line. I wouldn't know what file specifically to
> check though...
>
> -rwxr-xr-x  root  root system_u:object_r:bin_t          /usr/bin/python
> -rwxr-xr-x  root  root system_u:object_r:httpd_modules_t /usr/lib/
> httpd/modules/mod_python.so
> -rwxr-xr-x  root  root system_u:object_r:bin_t          /usr/local/
> bin/python2.5
> drwxr-xr-x  root  root system_u:object_r:lib_t          /usr/local/
> lib/python2.5/site-packages/mod_python
>
>
> USING:
> --
> RHEL5/SELinux
> Apache 2.2
> Python 2.5.1
> mod_pythonn 3.3.1
> httpd.conf (not .htaccess)
>
>
>
> On Jan 31, 2008, at 10:10 PM, Graham Dumpleton wrote:
>
> > On 01/02/2008, Scott Bratcher <scott@3floors.com> wrote:
> >> Thank you for looking in, Graham,
> >>
> >> DEPENDENCIES:
> >> # ldd /etc/httpd/modules/mod_python.so
> >>          linux-gate.so.1 =>  (0x00b16000)
> >>          libpthread.so.0 => /lib/libpthread.so.0 (0x00f2d000)
> >>          libdl.so.2 => /lib/libdl.so.2 (0x00aa7000)
> >>          libutil.so.1 => /lib/libutil.so.1 (0x00110000)
> >>          libm.so.6 => /lib/libm.so.6 (0x00114000)
> >>          libc.so.6 => /lib/libc.so.6 (0x00453000)
> >>          /lib/ld-linux.so.2 (0x0076d000)
> >>
> >> SIZE:
> >> # ls -fla /etc/httpd/modules/mod_python.so
> >> -rwxr-xr-x 1 root root 4.1M Jan 31 01:51 /etc/httpd/modules/
> >> mod_python.so*
> >>
> >> I'm game to reinstall python, how do I check to see if there is a
> >> libpythonX.Y.so file linked to mod_python.so?
> >
> > It should appear in that list above.
> >
> > Check out notes in:
> >
> >   http://code.google.com/p/modwsgi/wiki/InstallationIssues
> >
> > This is for mod_wsgi, but it has the same issue with the Python
> > library.
> >
> > Graham
> >
> >> On Jan 31, 2008, at 6:51 PM, Graham Dumpleton wrote:
> >>
> >>> How big is your:
> >>>
> >>>   /etc/httpd/modules/mod_python.so
> >>>
> >>> file? If you run ldd on it, what does it output as far as
> >>> dependencies
> >>> on shared libraries?
> >>>
> >>> One of the problems with some Python installations is that they
> >>> still
> >>> do not provide a shared library and so a static library gets
> >>> embedded
> >>> in mod_python.so. This results in some messy adress relocations
> >>> having
> >>> to be done when mod_python.so is loaded. I am wandering whether the
> >>> 'reloc' mentioned in:
> >>>
> >>>   cannot restore segment prot after reloc
> >>>
> >>> is the module loading relocations and it is having a problem with
> >>> that.
> >>>
> >>> If there is no libpythonX.Y.so linked to mod_python.so, then
> >>> reinstall
> >>> Python using --enable-shared to configure, possibly fix up missing
> >>> libpythonX.Y.so symlink in Python installed config directory and
> >>> then
> >>> rebuild mod_python, see if that makes a difference.
> >>>
> >>> Probably nothing to do with this, but if nothing else works. :-)
> >>>
> >>> Graham
> >>>
> >>> On 01/02/2008, Scott Bratcher <scott@3floors.com> wrote:
> >>>> Thanks Eric and Tom,
> >>>>
> >>>> Unresolved however. I did some permissions tests based on your
> >>>> feedback.
> >>>>
> >>>>
> >>>> I'm chasing this issue as though it is a permissions issue and have
> >>>> identified SELinux as the hold-up. I've tried all of these
> >>>> permission
> >>>> sets on the modules actual folder and the modules symlinked folder.
> >>>> I did both directories just in case the permissions trickle down to
> >>>> the actual files being loaded by mod_python itself:
> >>>>
> >>>> # chcon -R -h -u system_u -r object_r -t httpd_sys_content_t /usr/
> >>>> lib/
> >>>> httpd/modules /etc/httpd/modules
> >>>> # chcon -R -h -u user_u -r object_r -t httpd_sys_content_t /usr/
> >>>> lib/
> >>>> httpd/modules /etc/httpd/modules
> >>>> # chcon -R -h -u user_u -r object_r -t httpd_modules_t /usr/lib/
> >>>> httpd/
> >>>> modules /etc/httpd/modules
> >>>> # chcon -R -h -u system_u -r object_r -t httpd_modules_t /usr/lib/
> >>>> httpd/modules /etc/httpd/modules ((( This one is the original
> >>>> permission of all apache modules)))
> >>>> # chcon -R -h -u system_u -r object_r -t lib_t /usr/lib/httpd/
> >>>> modules /etc/httpd/modules
> >>>> # chcon -R -h -u system_u -r object_r -t shlib_t /usr/lib/httpd/
> >>>> modules /etc/httpd/modules
> >>>> # chcon -R -h -u system_u -r object_r -t textrel_shlib_t /usr/lib/
> >>>> httpd/modules /etc/httpd/modules
> >>>>
> >>>> All gave this error:
> >>>> ----------
> >>>> # service httpd start
> >>>> Starting httpd: httpd: Syntax error on line 210 of /etc/httpd/conf/
> >>>> httpd.conf: Syntax error on line 6 of /etc/httpd/conf.d/
> >>>> python.conf:
> >>>> Cannot load /etc/httpd/modules/mod_python.so into server: /etc/
> >>>> httpd/
> >>>> modules/mod_python.so: cannot restore segment prot after reloc:
> >>>> Permission denied
> >>>>
> >>>> [FAILED]
> >>>> ----------
> >>>>
> >>>> ---> This is the only one that gave me a different error.
> >>>> ----------
> >>>> # chcon -R -h -u system_u -t textrel_shlib_t /usr/lib/httpd/
> >>>> modules /
> >>>> etc/httpd/modules
> >>>> # service httpd start
> >>>> Starting httpd: httpd: Syntax error on line 148 of /etc/httpd/conf/
> >>>> httpd.conf: Cannot load /etc/httpd/modules/mod_auth_basic.so into
> >>>> server: /etc/httpd/modules/mod_auth_basic.so: cannot open shared
> >>>> object file: Permission denied
> >>>>
> >>>> [FAILED]
> >>>> ----------
> >>>>
> >>>>
> >>>> ****AGAIN I MUST NOTE: All is solved by turning off SELinux and/or
> >>>> All is solved by not loading mod_python. All other modules loaded
> >>>> just fine with their original permissions which matched mod_python
> >>>> exactly.
> >>>>
> >>>>
> >>>>
> >>>>
> >>>> Scott
> >>>>
> >>>>
> >>>>
> >>>> On Jan 31, 2008, at 1:42 PM, Tom Stambaugh wrote:
> >>>>
> >>>>> The incantation that I use (for solving different problems,
> >>>>> though)
> >>>>> is:
> >>>>>
> >>>>> chcon -R -h -t httpd_sys_content_t <filename>
> >>>>>
> >>>>> I think the "-R" makes it recurse to all children, and I think the
> >>>>> "httpd_sys_content_t" is more permissive (though that could be
> >>>>> mistaken).
> >>>>> The -h causes it to apply to sym links.
> >>>>>
> >>>>> Afterwords, I get:
> >>>>>
> >>>>> #ls -lZ adminuser
> >>>>> -rw-rw-r--  zeetix   zeetix   user_u:object_r:httpd_sys_content_t
> >>>>> <filename>
> >>>>>
> >>>>> I use Fedora core3/core4 linux, so YMMV.
> >>>>>
> >>>>> Thx,
> >>>>> Tom
> >>>>>
> >>>>> ----- Original Message -----
> >>>>> From: "Scott Bratcher" <scott@3floors.com>
> >>>>> To: "Eric Brunson" <brunson@brunson.com>
> >>>>> Cc: <mod_python@modpython.org>
> >>>>> Sent: Thursday, January 31, 2008 1:47 PM
> >>>>> Subject: Re: [mod_python] Apache Fails to load mod_python.so with
> >>>>> Permissiondenied error under SELinux
> >>>>>
> >>>>>
> >>>>>> Thanks Eric,
> >>>>>>
> >>>>>> "setenforce 0" THIS WORKED. Apache started right up
> >>>>>>
> >>>>>> Below are the results of my attempts as you suggested. I think
> >>>>>> we are
> >>>>>> onto the problem because with SELinux enforced it loads right up.
> >>>>>> However, the chcon command failed to clear up the problem. I'm
> >>>>>> new to
> >>>>>> SELinux. Is there another possible SELinux related permission
> >>>>>> that  may be
> >>>>>> the solution? It's just mod_python that is giving this problem
> >>>>>> even
> >>>>>> though all of the others share the same t permission
> >>>>>> httpd_module.
> >>>>>>
> >>>>>> # ls -Zd modules
> >>>>>> drwxr-xr-x  root root system_u:object_r:httpd_modules_t modules/
> >>>>>>
> >>>>>> So I changed the permissions:
> >>>>>>
> >>>>>> # chcon -t texrel_shlib_t /etc/httpd/modules/mod_python.so
> >>>>>> # service httpd start
> >>>>>> Starting httpd: httpd: Syntax error on line 210 of /etc/httpd/
> >>>>>> conf/
> >>>>>> httpd.conf: Syntax error on line 6 of /etc/httpd/conf.d/
> >>>>>> python.conf:
> >>>>>> Cannot load /etc/httpd/modules/mod_python.so into server: /etc/
> >>>>>> httpd/
> >>>>>> modules/mod_python.so: cannot restore segment prot after reloc:
> >>>>>> Permission denied
> >>>>>>
> >>>>>> [FAILED]
> >>>>>> # ls -Z /etc/httpd/modules/mod_python.so
> >>>>>> -rwxr-xr-x  root root system_u:object_r:textrel_shlib_t /etc/
> >>>>>> httpd/
> >>>>>> modules/mod_python.so*
> >>>>>>
> >>>>>>
> >>>>>>
> >>>>>> I also tried changing the permissions of the 2.5 site-packages
> >>>>>> to the
> >>>>>> same permissions as the previously working 2.4 site-packages,
> >>>>>> plus  the
> >>>>>> other listed below, and the still Apache Failure occurs.
> >>>>>>
> >>>>>> # ls -Zd /usr/local/lib/python2.5/site-packages/ /usr/lib/
> >>>>>> python2.4/
> >>>>>> site-packages/
> >>>>>> drwxr-xr-x  root root system_u:object_r:lib_t           /usr/lib/
> >>>>>> python2.4/site-packages/
> >>>>>> drwxr-xr-x  root root user_u:object_r:lib_t             /usr/
> >>>>>> local/
> >>>>>> lib/python2.5/site-packages/
> >>>>>>
> >>>>>> system_u:object_r:lib_t
> >>>>>> system_u:object_r:textrel_shlib_t
> >>>>>> user_u:object_r:textrel_shlib_t
> >>>>>>
> >>>>>>
> >>>>>> If you have other tips I'd appreciate any help you can offer.
> >>>>>>
> >>>>>> Scott
> >>>>>>
> >>>>>>
> >>>>>>
> >>>>>> On Jan 31, 2008, at 10:13 AM, Eric Brunson wrote:
> >>>>>>
> >>>>>>> Scott Bratcher wrote:
> >>>>>>>> Hello all,
> >>>>>>>>
> >>>>>>>>
> >>>>>>>> THE PROBLEM:
> >>>>>>>>
> >>>>>>>> Starting Apache results in this error:
> >>>>>>>>
> >>>>>>>> # service httpd start
> >>>>>>>> Starting httpd: httpd: Syntax error on line 210 of /etc/httpd/
> >>>>>>>> conf/
> >>>>>>>> httpd.conf: Syntax error on line 6 of /etc/httpd/conf.d/
> >>>>>>>> python.conf:
> >>>>>>>> Cannot load /etc/httpd/modules/mod_python.so into  server:
> >>>>>>>> /etc/httpd/modules/mod_python.so: cannot restore segment  prot
> >>>>>>>> after
> >>>>>>>> reloc: Permission denied
> >>>>>>>>
> >>>>>>>> [FAILED]
> >>>>>>>>
> >>>>>>>
> >>>>>>> This error message is often related to selinux permissions.
> >>>>>>>
> >>>>>>> A quick check to see if that is the problem is to disable
> >>>>>>> selinux  with
> >>>>>>> the command (as root) "setenforce 0".  If the module then  loads
> >>>>>>> correctly, it can be fixed permanently with the command:
> >>>>>>>
> >>>>>>> chcon -t texrel_shlib_t /etc/httpd/modules/mod_python.so
> >>>>>>>
> >>>>>>> Then, re-enable selinux with "setenforce 1".
> >>>>>>>
> >>>>>>> If disabling selinux does not fix the problem, then more
> >>>>>>> investigation
> >>>>>>> is required.
> >>>>>>>
> >>>>>>> Hope that helps,
> >>>>>>> e.
> >>>>>>>
> >>>>>>>> USING:
> >>>>>>>>
> >>>>>>>> RHEL5 / SELinux
> >>>>>>>> Apache 2.2
> >>>>>>>> Python 2.5.1
> >>>>>>>> mod_pythonn 3.3.1
> >>>>>>>> httpd.conf (not .htaccess)
> >>>>>>>>
> >>>>>>>>
> >>>>>>>> TESTED THUS FAR:
> >>>>>>>>
> >>>>>>>> .so file exists with same permissions as other modules
> >>>>>>>> # ls -Z /etc/httpd/modules/mod_python.so
> >>>>>>>> -rwxr-xr-x  root root system_u:object_r:httpd_modules_t /etc/
> >>>>>>>> httpd/
> >>>>>>>> modules/mod_python.so*
> >>>>>>>>
> >>>>>>>> If I comment out:
> >>>>>>>> "#LoadModule python_module modules/mod_python.so"
> >>>>>>>> and other related python lines Apache starts just fine without
> >>>>>>>> mod_python.
> >>>>>>>> # service httpd start
> >>>>>>>> Starting httpd:
> >>>>>>>> [  OK  ]
> >>>>>>>>
> >>>>>>>>
> >>>>>>>>
> >>>>>>>
> >>>>>>
> >>>>>> _______________________________________________
> >>>>>> Mod_python mailing list
> >>>>>> Mod_python@modpython.org
> >>>>>> http://mailman.modpython.org/mailman/listinfo/mod_python
> >>>>>>
> >>>>>
> >>>>>
> >>>>>
> >>>>
> >>>> _______________________________________________
> >>>> Mod_python mailing list
> >>>> Mod_python@modpython.org
> >>>> http://mailman.modpython.org/mailman/listinfo/mod_python
> >>>>
> >>
> >>
>
>
From martijn at xs4us.nu  Fri Feb  1 06:04:19 2008
From: martijn at xs4us.nu (Martijn Moeling)
Date: Fri Feb  1 06:04:30 2008
Subject: [mod_python] mod_python.Importer.path; set dynamically
References: <B6C73A5E30565245BB6D32B5F5DF7A52172BA2@sense.emmastraat.pijnacker>
	<88e286470801311403u467069a8r75eab9f16184c0fd@mail.gmail.com>
Message-ID: <B6C73A5E30565245BB6D32B5F5DF7A52172BA3@sense.emmastraat.pijnacker>

Graham,

As you might remember I added a MySQLdb section to session.
(to be able to save sessions across computers)

In my system a lot of additional data is added to the req object, which is passed
around. in my case it is req.Session.user.

(I do not use http based auth, since this is in conflict with my web based desktop)

nevertheless, i can change your "example code" to my needs, consider req.user as the distinguisher for ease of thinking.

Martijn



-----Original Message-----
From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
Sent: Thu 31.01.2008 23:03
To: Martijn Moeling
Cc: mod_python@modpython.org
Subject: Re: [mod_python] mod_python.Importer.path; set dynamically
 
On 01/02/2008, Martijn Moeling <martijn@xs4us.nu> wrote:
> Hi!
>
>  I am an extensive mod_python user and my system needs something special.
>
>  Consider the following:
>
>  in httpd.conf I have :
>
>  PythonOption mod_python.importer.path ["/var/www/python_modules"]
>
>  /var/www/html/index.py is linked to ../python_modules/index.py
>
>  the python_modules directory has subdirectories, like; developer1,
> developer2
>
>  the python_modules contains stable modules and developerX holds development
> versions.
>
>  I have load balancing with multiple frond-ends (apache/MP) and one backend
> (MySQL).
>
>  I would like to dynamically change the mod_python.importer.path so that
> developer1 runs code in the corresponding subdir if the module exists,
>  else fall back to the python_modules directory.
>
>  Any tips, suggestions, remarks?

What is the distinguisher used to know which developer it is? Are you
using something like Basic authentication and so could distinguish
based on req.user?

If you tell me what the distinguisher is, probably have an idea.

Graham

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20080201/43851144/attachment.html
From linux at qbox.es  Fri Feb  1 06:05:43 2008
From: linux at qbox.es (=?ISO-8859-1?Q?S=2ER=2EPard=E1?=)
Date: Fri Feb  1 06:05:50 2008
Subject: [mod_python] Physical paths ?
Message-ID: <1201863943.5934.35.camel@ThorUx>

Hi,

Now, thank you to your help,  my applicattion is capable of receive
image files from users using forms.
And app store them into a physical path of the server. 


It's possible to save from the app to an uri folder ? 

Can I know the physical path of one uri ? 


I can save easily to a subfolder of the pyhsical path obtained by
req.filename relative to the page visited, and that can work without
problem.


But I would like the module (the module that implements the form
proccesing) receive the relative route relative to the root of the
application path, so module will not need to know the physical structure
of directories, and can save to a route not descendent of the directory
of my own page.

... And in my app, the root of the app is a directory alias. outside of
the apache document_root '/var/www' 


That's it

	DocumentRoot 	/	      /var/www

	Alias		MyApp	      /home/user/MyApp/

	/MyApp/index.psp   .......... /home/user/MyApp/index.psp

	/MyApp/config/upload.psp  ... /home/user/MyApp/config/index.psp

	/MyApp/images/	............. /home/user/MyApp/images/
	/MyApp/images/users/	..... /home/user/MyApp/images/users/


And I want to obtain from code executed in 

	http:/MyApp/config/upload.psp

the physical path of root of the application:

	

so I can't sent to a function in form.py:

	app_root = ??? 	  # function that returns '/home/user/MyApp/'
	imgs_folder = 'images/users/'

	process(form, directory_to_save = app_root+imgs_folder)


So, the code is independent of the installation directory and the app
path.

Another thing ... if images would be an alias, ? could I know the path ?




Thank You again.

	S.R.Parda

From graham.dumpleton at gmail.com  Fri Feb  1 16:36:09 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Fri Feb  1 16:36:36 2008
Subject: [mod_python] Physical paths ?
In-Reply-To: <1201863943.5934.35.camel@ThorUx>
References: <1201863943.5934.35.camel@ThorUx>
Message-ID: <88e286470802011336p3a5e201bwfc9f6007b7614e45@mail.gmail.com>

I think I only partly understand what you want. Anyway, work out what
the following would do if done in your mod_python handler.

  import os
  req.application_root = os.path.dirname(__file__)

Graham

On 01/02/2008, S.R.Pard? <linux@qbox.es> wrote:
> Hi,
>
> Now, thank you to your help,  my applicattion is capable of receive
> image files from users using forms.
> And app store them into a physical path of the server.
>
>
> It's possible to save from the app to an uri folder ?
>
> Can I know the physical path of one uri ?
>
>
> I can save easily to a subfolder of the pyhsical path obtained by
> req.filename relative to the page visited, and that can work without
> problem.
>
>
> But I would like the module (the module that implements the form
> proccesing) receive the relative route relative to the root of the
> application path, so module will not need to know the physical structure
> of directories, and can save to a route not descendent of the directory
> of my own page.
>
> ... And in my app, the root of the app is a directory alias. outside of
> the apache document_root '/var/www'
>
>
> That's it
>
>         DocumentRoot    /             /var/www
>
>         Alias           MyApp         /home/user/MyApp/
>
>         /MyApp/index.psp   .......... /home/user/MyApp/index.psp
>
>         /MyApp/config/upload.psp  ... /home/user/MyApp/config/index.psp
>
>         /MyApp/images/  ............. /home/user/MyApp/images/
>         /MyApp/images/users/    ..... /home/user/MyApp/images/users/
>
>
> And I want to obtain from code executed in
>
>         http:/MyApp/config/upload.psp
>
> the physical path of root of the application:
>
>
>
> so I can't sent to a function in form.py:
>
>         app_root = ???    # function that returns '/home/user/MyApp/'
>         imgs_folder = 'images/users/'
>
>         process(form, directory_to_save = app_root+imgs_folder)
>
>
> So, the code is independent of the installation directory and the app
> path.
>
> Another thing ... if images would be an alias, ? could I know the path ?
>
>
>
>
> Thank You again.
>
>         S.R.Parda
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From charles.collis at gmail.com  Sat Feb  2 14:30:11 2008
From: charles.collis at gmail.com (Charles Collis)
Date: Sat Feb  2 14:30:19 2008
Subject: [mod_python] Problem getting the Publisher handler to return
	nothing
In-Reply-To: <88e286470801311620n520b3288j22b76b27bc0ec42e@mail.gmail.com>
References: <b44a81310801271138x597f726bxdf39997892289f64@mail.gmail.com>
	<88e286470801271312s2168a1e4g3fc6dc06d0f0a25@mail.gmail.com>
	<b44a81310801271534m3971f347p28f048211f18efe7@mail.gmail.com>
	<88e286470801272158l1092ed52hf269c713a2f4b787@mail.gmail.com>
	<b44a81310801281616p22f031aib79434412d46594e@mail.gmail.com>
	<3787dfa80801291523w22fc2f6ehe9e805de89b9aac0@mail.gmail.com>
	<b44a81310801310147o3fccfe38ldbb6c537d5f3ba63@mail.gmail.com>
	<3787dfa80801310203w2e773e8fo5fd828b9f63175ef@mail.gmail.com>
	<b44a81310801311535n2644471eg70768543c93315f8@mail.gmail.com>
	<88e286470801311620n520b3288j22b76b27bc0ec42e@mail.gmail.com>
Message-ID: <b44a81310802021130r62f87030of9044c83abbb3d4c@mail.gmail.com>

Fantastic, that did the trick!

I have updated the FAQ accordingly (
http://www.modpython.org/FAQ/faqw.py?req=all#2.19). Although the FAQ entry
still mentions "forcing a 200 response" - and I'm not actually sure whether
"raise apache.SERVER_RETURN, apache.HTTP_NO_CONTENT" is still forcing a 200
response or not. If that is now inaccurate perhaps some who knows could
tweak the FAQ entry.

Anyway, thanks for all the help, much appreciated.

Charles.

On Feb 1, 2008 12:20 AM, Graham Dumpleton <graham.dumpleton@gmail.com>
wrote:

> On 01/02/2008, Charles Collis <charles.collis@gmail.com> wrote:
> > Hadn't tried it before, but have now - unfortunately still no joy.
> >
> > If I return 'apache.HTTP_NO_CONTENT' my browser then shows a blank page
> with
> > '24' at the top which presumably is the code for 'HTTP_NO_CONTENT'.
> >
> > If I raise the error:
> >
> > raise apache.HTTP_NO_CONTENT, apache.OK (whether I put ',apache.OK'
> there or
> > not),
>
> Use:
>
>  raise apache.SERVER_RETURN, apache.HTTP_NO_CONTENT
>
> I am not sure though whether that will still trigger Apache to send a
> default error page. You may have to use:
>
>  req.status = apache.HTTP_NO_CONTENT
>  raise apache.SERVER_RETURN, apache.DONE
>
> to be absolutely sure that Apache doesn't further process it.
>
> Graham
>
> > I get an error message in browser saying:
> > 'TypeError: exceptions must be classes, instances, or strings
> (deprecated),
> > not int'
> >
> >
> >
> > >
> > >
> > >
> > >
> > > Have you tried returning apache.HTTP_NO_CONTENT ?
> > > According to [0],
> > > http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html
> > this should
> > > cause clients do nothing. As the behaviour of the client cannot be
> > > controlled except for a status code in the header, this might be an
> > > option easier than creating internal requests using Ajax.
> > >
> >
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> >
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20080202/ec951277/attachment.html
From graham.dumpleton at gmail.com  Sat Feb  2 16:04:20 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sat Feb  2 16:04:27 2008
Subject: Fwd: [mod_python] Physical paths ?
In-Reply-To: <1201947998.7084.72.camel@ThorUx>
References: <1201863943.5934.35.camel@ThorUx>
	<88e286470802011336p3a5e201bwfc9f6007b7614e45@mail.gmail.com>
	<1201947998.7084.72.camel@ThorUx>
Message-ID: <88e286470802021304u74f0f11aq52a8369d69530a36@mail.gmail.com>

Please keep your replies on the list.

FYI. That code was setting req.application_root so you could use it as
a reference, not trying to use it.

Do:

  PythonHandler somemodulenameinrootofpspfilesdirectory .psp
  PythonHandler mod_python.psp .psp

In somemodulenameinrootofpspfilesdirectory.py have:

  import os

  def handler(req):
    req.application_root = os.path,dirname(__file__)
    return apache.OK

Read the documentation about stacked mod_python handlers to see how this works.

Have no time to read all this new mail now, maybe someone else will help.

Graham

---------- Forwarded message ----------
From: S.R.Pard? <linux@qbox.es>
Date: 2 Feb 2008 21:26
Subject: Re: [mod_python] Physical paths ?
To: Graham Dumpleton <graham.dumpleton@gmail.com>


Thank You.

I'm using: PythonHandler mod_python.psp and req.application_root doesn't
exist.
But __file__ is '/usr/lib/python2.5/site-packages/mod_python/psp.pyc' in
the psp page, so it doen't seem related to the root of my app pages
where I wnt to save.



Anyway, I will try to explain it better, so it can help any other person
in the future looking for info like this.

Basically, I want the mod_python psp application, allow content upload
from the user client:

That's done in:         http://SERVER/MyApp/config/upload.psp
(and that page is in /home/user/MyApp/config/index.psp)

And I want to save the user file to a directory accesible later at:
        http://SERVER/MyApp/images/users/USER_FILE
(that page would be in /home/user/MyApp/images/users)

So the upload.psp save the file received from form at that images
directory (instead of the form directory).



I wanted that the code from upload psp will pass a relative path from
the root of the App (/MyApp) to the module that saves the file, that is
something like:
        save_file(USER_FILE,"images/users/", req)

I needed the save_file to obtain the physical path to the URL:
        '//SERVER' + '/MyApp/' + 'images/users/'
        (server + application_root + destiny_folder)
that is, the physical path to save the file:
        '/home/user/MyApp/config/index.psp'

Of course, I didn't wanted the function to use a constant to the root of
the application '/home/user/MyApp' (at code time) to allow to the
application to be independent from the installation directory.



I know req.filename give me the physical path to
http://SERVER/MyApp/config/upload.psp
that is:
/home/user/MyApp/config/upload.psp

so I could save to '/home/user/MyApp/config/' without problem. And the
same in some subdirectory like '/home/user/MyApp/config/images/users/'.
I know.

But, I had an images directory in '/home/user/MyApp/images/', and maybe
I like the things in the hard way. And decide to save to that directory
of images (don't ask me why).
I know that ... application root is at '..' relative to the physical
directory of the page ('/home/user/MyApp/config/').
But I really like the things in the hard way and I wanted the save
function to be usable from any other pages in other directories, and I
don't wanted to send a constant relative path to the app root (remember
'/home/user/MyApp/') from every page to the save function (because, I
want app to be independent of the installation directory, and I don't
want to worry about the constant relative paths if I move the pages).


So, the code I'm using now, take the physical path of the page, and the
uri of the page , and the application root (uri), to obtain the physical
path of the application.
And from that , I can take the pyshical path of any subdirectory
relative to root (only if no subdirectory with alias are involved, of
course).

######
def physicalAppRoot(req):

  rootApp = req.get_options()['mod_python.session.application_path']
  pageDir, pageName = os.path.split(req.parsed_uri[6])

  if pageDir.startswith(rootApp):
     appPageDir = pageDir[len(rootApp):]
  else:
     appPageDir = pageDir

  physPath = os.path.dirname(req.filename)

  i = physPath.rfind(appPageDir)
  physAppRoot = physPath[:i]+os.path.sep

  return physAppRoot
######


The application path is an apache's directory alias, so option
application_path is indicated in the config (like you said me Graham, to
set different paths for cookies from various applications, and that
worked great for me).



That's work for me but, really all I wanted was some function like:

        physicalPath(uri = 'images/users/')
or
        physicalPath(uri = '/MyApp/images/users/')

that give me:  '/home/user/MyApp/images/users/'
for an apache mod_python application installed in /home/user/MyApp,
accessible at 'http://server/MyApp' (because an alias would be set at
apache 'alias /MyApp/ "/home/user/MyApp"').



Sorry, if I can explain it better. Maybe I'm doing a silly thing,
because an apache function available at mod_python does exctly this, but
I didn't found it.



Thank You,


        S.R.Pard?



El s?b, 02-02-2008 a las 08:36 +1100, Graham Dumpleton escribi?:
> I think I only partly understand what you want. Anyway, work out what
> the following would do if done in your mod_python handler.
>
>   import os
>   req.application_root = os.path.dirname(__file__)
>
> Graham
>
> On 01/02/2008, S.R.Pard? <linux@qbox.es> wrote:
> > Hi,
> >
> > Now, thank you to your help,  my applicattion is capable of receive
> > image files from users using forms.
> > And app store them into a physical path of the server.
> >
> >
> > It's possible to save from the app to an uri folder ?
> >
> > Can I know the physical path of one uri ?
> >
> >
> > I can save easily to a subfolder of the pyhsical path obtained by
> > req.filename relative to the page visited, and that can work without
> > problem.
> >
> >
> > But I would like the module (the module that implements the form
> > proccesing) receive the relative route relative to the root of the
> > application path, so module will not need to know the physical structure
> > of directories, and can save to a route not descendent of the directory
> > of my own page.
> >
> > ... And in my app, the root of the app is a directory alias. outside of
> > the apache document_root '/var/www'
> >
> >
> > That's it
> >
> >         DocumentRoot    /             /var/www
> >
> >         Alias           MyApp         /home/user/MyApp/
> >
> >         /MyApp/index.psp   .......... /home/user/MyApp/index.psp
> >
> >         /MyApp/config/upload.psp  ... /home/user/MyApp/config/index.psp
> >
> >         /MyApp/images/  ............. /home/user/MyApp/images/
> >         /MyApp/images/users/    ..... /home/user/MyApp/images/users/
> >
> >
> > And I want to obtain from code executed in
> >
> >         http:/MyApp/config/upload.psp
> >
> > the physical path of root of the application:
> >
> >
> >
> > so I can't sent to a function in form.py:
> >
> >         app_root = ???    # function that returns '/home/user/MyApp/'
> >         imgs_folder = 'images/users/'
> >
> >         process(form, directory_to_save = app_root+imgs_folder)
> >
> >
> > So, the code is independent of the installation directory and the app
> > path.
> >
> > Another thing ... if images would be an alias, ? could I know the path ?
> >
> >
> >
> >
> > Thank You again.
> >
> >         S.R.Parda
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >

From graham.dumpleton at gmail.com  Sat Feb  2 16:08:18 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sat Feb  2 16:08:24 2008
Subject: [mod_python] Problem getting the Publisher handler to return
	nothing
In-Reply-To: <b44a81310802021130r62f87030of9044c83abbb3d4c@mail.gmail.com>
References: <b44a81310801271138x597f726bxdf39997892289f64@mail.gmail.com>
	<b44a81310801271534m3971f347p28f048211f18efe7@mail.gmail.com>
	<88e286470801272158l1092ed52hf269c713a2f4b787@mail.gmail.com>
	<b44a81310801281616p22f031aib79434412d46594e@mail.gmail.com>
	<3787dfa80801291523w22fc2f6ehe9e805de89b9aac0@mail.gmail.com>
	<b44a81310801310147o3fccfe38ldbb6c537d5f3ba63@mail.gmail.com>
	<3787dfa80801310203w2e773e8fo5fd828b9f63175ef@mail.gmail.com>
	<b44a81310801311535n2644471eg70768543c93315f8@mail.gmail.com>
	<88e286470801311620n520b3288j22b76b27bc0ec42e@mail.gmail.com>
	<b44a81310802021130r62f87030of9044c83abbb3d4c@mail.gmail.com>
Message-ID: <88e286470802021308l2be28f92x439b62a24597a074@mail.gmail.com>

No it is wrong as you are actually return a HTTP NO_CONTENT error
response, not a 200, ie HTTP OK response. The original FAQ entry may
have been a bit bogus and only applied to older mod_python versions as
I believe that returning an empty string as response is fixed in
3.3.1.

Graham

On 03/02/2008, Charles Collis <charles.collis@gmail.com> wrote:
> Fantastic, that did the trick!
>
> I have updated the FAQ accordingly
> (http://www.modpython.org/FAQ/faqw.py?req=all#2.19).
> Although the FAQ entry still mentions "forcing a 200 response" - and I'm not
> actually sure whether "raise apache.SERVER_RETURN, apache.HTTP_NO_CONTENT"
> is still forcing a 200 response or not. If that is now inaccurate perhaps
> some who knows could tweak the FAQ entry.
>
> Anyway, thanks for all the help, much appreciated.
>
> Charles.
>
>
> On Feb 1, 2008 12:20 AM, Graham Dumpleton <graham.dumpleton@gmail.com>
> wrote:
>
> >
> > On 01/02/2008, Charles Collis <charles.collis@gmail.com> wrote:
> > > Hadn't tried it before, but have now - unfortunately still no joy.
> > >
> > > If I return 'apache.HTTP_NO_CONTENT' my browser then shows a blank page
> with
> > > '24' at the top which presumably is the code for 'HTTP_NO_CONTENT'.
> > >
> > > If I raise the error:
> > >
> > > raise apache.HTTP_NO_CONTENT, apache.OK (whether I put ',apache.OK'
> there or
> > > not),
> >
> > Use:
> >
> >  raise apache.SERVER_RETURN, apache.HTTP_NO_CONTENT
> >
> > I am not sure though whether that will still trigger Apache to send a
> > default error page. You may have to use:
> >
> >  req.status = apache.HTTP_NO_CONTENT
> >  raise apache.SERVER_RETURN, apache.DONE
> >
> > to be absolutely sure that Apache doesn't further process it.
> >
> > Graham
> >
> >
> > > I get an error message in browser saying:
> > > 'TypeError: exceptions must be classes, instances, or strings
> (deprecated),
> > > not int'
> > >
> > >
> > >
> > > >
> > > >
> > > >
> > > >
> > > > Have you tried returning apache.HTTP_NO_CONTENT ?
> > > > According to [0],
> > > >
> http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html
> > > this should
> > > > cause clients do nothing. As the behaviour of the client cannot be
> > > > controlled except for a status code in the header, this might be an
> > > > option easier than creating internal requests using Ajax.
> > > >
> > >
> > >
> >
> >
> >
> > > _______________________________________________
> > > Mod_python mailing list
> > > Mod_python@modpython.org
> > >
> http://mailman.modpython.org/mailman/listinfo/mod_python
> > >
> > >
> >
>
>
From mcl.office at googlemail.com  Mon Feb  4 08:19:21 2008
From: mcl.office at googlemail.com (MCL Systems)
Date: Mon Feb  4 08:19:37 2008
Subject: [mod_python] Sessions: Confused: Newbie
Message-ID: <46218daf0802040519r5ad612e4j12c283475476bb3c@mail.gmail.com>

I thought I was understanding sessions but the following did not work as I
expected.

I was expecting the first execution to create a session with a PID of 666
and a Hits Value of 1 and on each refresh of that page in the same browser
to increment the hit counter, but the 'is_new' test, returns true every
time.  I have tried this on several computers and with different browsers,
but always the same result.

Where have I gone wrong ?

Richard

MOD_PYTHON, Apache, PYTHON 2.5

Code =====================================
from mod_python import Session, util

def index(req):
    main(req)

def main(req):
    mySess = Session.Session(req)
    if mySess.is_new():
        pid = 666
        mySess['pid'] = str(pid)
        mySess['hits'] = 1
        req.write("NEW Session PID: %s <BR>\n" % mySess['pid'])
        req.write("Hits: %s <br>\n" % mySess['hits'])
    else:
        mySess['hits'] +=1
        req.write("OLD Session PID: %s <BR>\n" % mySess['pid'])
        req.write("Hits: %s <br>\n" % mySess['hits'])
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20080204/c4a6affb/attachment.html
From elias.collas at gulfstream.com  Mon Feb  4 09:04:21 2008
From: elias.collas at gulfstream.com (elias.collas@gulfstream.com)
Date: Mon Feb  4 09:07:23 2008
Subject: [mod_python] Sessions: Confused: Newbie
In-Reply-To: <46218daf0802040519r5ad612e4j12c283475476bb3c@mail.gmail.com>
Message-ID: <OF93CE13A2.01F65683-ON852573E5.004CFAE8-852573E5.004D4D7E@zeus.git.gulfaero.com>

Hi,
I ran into this when I first started messing about with sessions.
Check your apache error_log for session related exceptions. If sessions
aren't properly configured, mod_python may not be able to create or
retrieve the session id.

HTH,
Elias

mod_python-bounces@modpython.org wrote on 02/04/2008 08:19:21 AM:

> I thought I was understanding sessions but the following did not
> work as I expected.
>
> I was expecting the first execution to create a session with a PID
> of 666 and a Hits Value of 1 and on each refresh of that page in the
> same browser to increment the hit counter, but the 'is_new' test,
> returns true every time.  I have tried this on several computers and
> with different browsers, but always the same result.
>
> Where have I gone wrong ?
>
> Richard
>
> MOD_PYTHON, Apache, PYTHON 2.5
>
> Code =====================================
> from mod_python import Session, util
>
> def index(req):
>     main(req)
>
> def main(req):
>     mySess = Session.Session(req)
>     if mySess.is_new():
>         pid = 666
>         mySess['pid'] = str(pid)
>         mySess['hits'] = 1
>         req.write("NEW Session PID: %s <BR>\n" % mySess['pid'])
>         req.write("Hits: %s <br>\n" % mySess['hits'])
>     else:
>         mySess['hits'] +=1
>         req.write("OLD Session PID: %s <BR>\n" % mySess['pid'])
>         req.write("Hits: %s <br>\n" % mySess['hits'])
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From mcl.office at googlemail.com  Mon Feb  4 09:37:55 2008
From: mcl.office at googlemail.com (MCL Systems)
Date: Mon Feb  4 09:37:59 2008
Subject: [mod_python] Sessions: Confused: Newbie
In-Reply-To: <OF93CE13A2.01F65683-ON852573E5.004CFAE8-852573E5.004D4D7E@zeus.git.gulfaero.com>
References: <46218daf0802040519r5ad612e4j12c283475476bb3c@mail.gmail.com>
	<OF93CE13A2.01F65683-ON852573E5.004CFAE8-852573E5.004D4D7E@zeus.git.gulfaero.com>
Message-ID: <46218daf0802040637x376e7221x6da203027f33a413@mail.gmail.com>

Elias,

Thanks for replying.

I am on a hosted system and the only two log files I have access to are:

.nfs..............
access_log............

I have looked at these and can not see any obvious errors.

Errors I made in the original script were recorded eg isnew() does not
exist, when I should have used is_new()

A thought that crossed my mind, is do I have to specify a timeout, as I had
assumed there would be some default value of 60 mins ?

Richard


On 04/02/2008, elias.collas@gulfstream.com <elias.collas@gulfstream.com>
wrote:
>
> Hi,
> I ran into this when I first started messing about with sessions.
> Check your apache error_log for session related exceptions. If sessions
> aren't properly configured, mod_python may not be able to create or
> retrieve the session id.
>
> HTH,
> Elias
>
> mod_python-bounces@modpython.org wrote on 02/04/2008 08:19:21 AM:
>
> > I thought I was understanding sessions but the following did not
> > work as I expected.
> >
> > I was expecting the first execution to create a session with a PID
> > of 666 and a Hits Value of 1 and on each refresh of that page in the
> > same browser to increment the hit counter, but the 'is_new' test,
> > returns true every time.  I have tried this on several computers and
> > with different browsers, but always the same result.
> >
> > Where have I gone wrong ?
> >
> > Richard
> >
> > MOD_PYTHON, Apache, PYTHON 2.5
> >
> > Code =====================================
> > from mod_python import Session, util
> >
> > def index(req):
> >     main(req)
> >
> > def main(req):
> >     mySess = Session.Session(req)
> >     if mySess.is_new():
> >         pid = 666
> >         mySess['pid'] = str(pid)
> >         mySess['hits'] = 1
> >         req.write("NEW Session PID: %s <BR>\n" % mySess['pid'])
> >         req.write("Hits: %s <br>\n" % mySess['hits'])
> >     else:
> >         mySess['hits'] +=1
> >         req.write("OLD Session PID: %s <BR>\n" % mySess['pid'])
> >         req.write("Hits: %s <br>\n" % mySess['hits'])
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20080204/99731e76/attachment.html
From dvaras at lycos.com  Mon Feb  4 10:22:17 2008
From: dvaras at lycos.com (vytas dvaras)
Date: Mon Feb  4 10:22:27 2008
Subject: [mod_python] Authorization problem
Message-ID: <20080204102217.HM.0000000000000I9@dvaras.bos-mail-wwl14.lycos.com>

An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20080204/f45c82d8/attachment.html
From drshade at gmail.com  Mon Feb  4 11:09:06 2008
From: drshade at gmail.com (Tom Wells)
Date: Mon Feb  4 11:09:13 2008
Subject: [mod_python] Import error on multiple interpreters
Message-ID: <ed756d900802040809k69c48d9al243c0c77c8012985@mail.gmail.com>

Hi Everyone

I have been bumbling along with mod_python for about a month using
mod_python as the apache hooks for integrating into a larger single-sign-on
solution, so far so good. However I'm hitting my head against a weird issue,
and can't seem to find any reference to related issues on this list, nor the
FAQ, so here goes:

I'm supporting multiple apache virtual hosts, and separating them by running
each in a different python interpretor (using PythonInterpreter <site_name>
within the VirtualHost configuration for each site.

I hook into apache via PythonAuthenHandler and PythonAuthzHandler (as my app
is only concerned with authentication and authorization) and make web
service calls using ZSI and some cryptographic routines using ncrypt (Python
OpenSSL wrapper) before allowing or disallowing access to the particular
resource.

So the above works nicely, but while testing I occasionally get the
following error (not on startup, but after a few requests):
[Mon Feb 04 17:41:57 2008] [notice] mod_python (pid=26429,
interpreter='ssofilter_interpreter_mobile'): Importing module
'/home/tom/dev/auth/ssofilter-apache-2.2/ssofilter.py'
[Mon Feb 04 17:41:57 2008] [notice] mod_python (pid=26429,
interpreter='ssofilter_interpreter_mobile'): Importing module
'/home/tom/dev/auth/ssofilter-apache-2.2/webserver.py'
[Mon Feb 04 17:41:57 2008] [notice] mod_python (pid=26429,
interpreter='ssofilter_interpreter_mobile'): Importing module
'/home/tom/dev/auth/ssofilter-apache-2.2/cache.py'
[Mon Feb 04 17:41:57 2008] [notice] mod_python (pid=26429,
interpreter='ssofilter_interpreter_mobile'): Importing module
'/home/tom/dev/auth/ssofilter-apache-2.2/authserver.py'
[Mon Feb 04 17:41:57 2008] [notice] mod_python (pid=26429,
interpreter='ssofilter_interpreter_mobile'): Importing module
'/home/tom/dev/auth/ssofilter-apache-2.2/ausService_services.py'
[Mon Feb 04 17:41:57 2008] [notice] mod_python (pid=26429,
interpreter='ssofilter_interpreter_mobile'): Importing module
'/home/tom/dev/auth/ssofilter-apache-2.2/ausService_services_types.py'
[Mon Feb 04 17:41:57 2008] [notice] mod_python (pid=26429,
interpreter='ssofilter_interpreter_mobile'): Importing module
'/home/tom/dev/auth/ssofilter-apache-2.2/utils.py'
[Mon Feb 04 17:41:57 2008] [notice] mod_python (pid=26429,
interpreter='ssofilter_interpreter_mobile'): Importing module
'/home/tom/dev/auth/ssofilter-apache-2.2/cryptography.py'
[Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42] mod_python
(pid=26429, interpreter='ssofilter_interpreter_mobile',
phase='PythonAuthenHandler', handler='ssofilter'): Application error
[Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42] ServerName: '
mobile.domain.co.za'
[Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42] DocumentRoot:
'/home/tom/dev/auth/mobileweb'
[Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42] URI: '/'
[Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42] Location: '/'
[Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42] Directory: None
[Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42] Filename:
'/home/tom/dev/auth/mobileweb/'
[Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42] PathInfo: ''
[Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42] Traceback (most
recent call last):
[Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42]   File
"/usr/lib/python2.5/site-packages/mod_python/importer.py", line 1537, in
HandlerDispatch\n    default=default_handler, arg=req, ilent=hlist.silent)
[Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42]   File
"/usr/lib/python2.5/site-packages/mod_python/importer.py", line 1202, in
_process_target\n    module = import_module(module_name, path=path)
[Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42]   File
"/usr/lib/python2.5/site-packages/mod_python/importer.py", line 296, in
import_module\n    log, import_path)
[Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42]   File
"/usr/lib/python2.5/site-packages/mod_python/importer.py", line 680, in
import_module\n    execfile(file, module.__dict__)
[Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42]   File
"/home/tom/dev/auth/ssofilter-apache-2.2/ssofilter.py", line 10, in
<module>\n    cryptography = apache.import_module('cryptography')
[Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42]   File
"/usr/lib/python2.5/site-packages/mod_python/importer.py", line 296, in
import_module\n    log, import_path)
[Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42]   File
"/usr/lib/python2.5/site-packages/mod_python/importer.py", line 680, in
import_module\n    execfile(file, module.__dict__)
[Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42]   File
"/home/tom/dev/auth/ssofilter-apache-2.2/cryptography.py", line 4, in
<module>\n    cipher = apache.import_module('ncrypt.cipher')
[Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42]   File
"/usr/lib/python2.5/site-packages/mod_python/importer.py", line 304, in
import_module\n    return __import__(module_name, {}, {}, ['*'])
[Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42]   File
"/var/lib/python-support/python2.5/ncrypt/cipher.py", line 1, in
<module>\n    from _ncrypt.cipher import *
[Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42] ImportError: No
module named cipher

Now you may think I'm posting this to the wrong list looking at the
stacktrace, but I'm convinced it's mod_python related. While testing the
first few requests go through fine (and ncrypt is imported correctly), but
it seems like the error occurs when apache has decided to create a new
thread (or spawn a new process, difficult to tell) that the error occurs
(the log entries containing "Importing Module" are spat out by mod_python,
as I use the apache.import_module() function for performing all my imports).

A hint is if I make all my sites run under one single python interpreter (by
giving them the same name) I don't experience the problem, but I'd prefer
not to run under this configuration as I'd need to do a whole lot more work
to ensure that data remains separated per site.

Any comments, suggestions would be greatly appreciated!

Thanks,
Tom

PS> Running mod_python 3.3.1-2, running on ubuntu 7.10 in apache
2.2.4-3build1. My apache runtime configuration looks something like:
[Mon Feb 04 17:40:10 2008] [notice] Apache Configuration:
[Mon Feb 04 17:40:10 2008] [notice]  AP_MPMQ_MAX_DAEMON_USED     -> 2 [Max #
of daemons used so far]
[Mon Feb 04 17:40:10 2008] [notice]  AP_MPMQ_IS_THREADED         -> 1
[0=Unsupported, 1=Static, 2=Dynamic]
[Mon Feb 04 17:40:10 2008] [notice]  AP_MPMQ_IS_FORKED           -> 2
[0=Unsupported, 1=Static, 2=Dynamic]
[Mon Feb 04 17:40:10 2008] [notice]  AP_MPMQ_HARD_LIMIT_DAEMONS  -> 16 [The
compiled max # daemons]
[Mon Feb 04 17:40:10 2008] [notice]  AP_MPMQ_HARD_LIMIT_THREADS  -> 64 [The
compiled max # threads]
[Mon Feb 04 17:40:10 2008] [notice]  AP_MPMQ_MAX_THREADS         -> 25 [# of
threads/child by config]
[Mon Feb 04 17:40:10 2008] [notice]  AP_MPMQ_MIN_SPARE_DAEMONS   -> 0 [Min #
of spare daemons]
[Mon Feb 04 17:40:10 2008] [notice]  AP_MPMQ_MIN_SPARE_THREADS   -> 25 [Min
# of spare threads]
[Mon Feb 04 17:40:10 2008] [notice]  AP_MPMQ_MAX_SPARE_DAEMONS   -> 0 [Max #
of spare daemons]
[Mon Feb 04 17:40:10 2008] [notice]  AP_MPMQ_MAX_SPARE_THREADS   -> 75 [Max
# of spare threads]
[Mon Feb 04 17:40:10 2008] [notice]  AP_MPMQ_MAX_REQUESTS_DAEMON -> 10 [Max
# of requests per daemon]
[Mon Feb 04 17:40:10 2008] [notice]  AP_MPMQ_MAX_DAEMONS         -> 6 [Max #
of daemons by config]
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20080204/7a183054/attachment-0001.html
From linux at qbox.es  Mon Feb  4 12:09:43 2008
From: linux at qbox.es (=?ISO-8859-1?Q?S=2ER=2EPard=E1?=)
Date: Mon Feb  4 12:09:50 2008
Subject: [mod_python] Import error on multiple interpreters
In-Reply-To: <ed756d900802040809k69c48d9al243c0c77c8012985@mail.gmail.com>
References: <ed756d900802040809k69c48d9al243c0c77c8012985@mail.gmail.com>
Message-ID: <1202144983.8137.16.camel@ThorUx>

If you say that you have not used nothing like " from _ncrypt.cipher
import * " in cipher.py.
And your log says:
File "/var/lib/python-support/python2.5/ncrypt/cipher.py", line 1, in
<module>\n    from _ncrypt.cipher import *

I will look for a session storing an instance of an object from a
cipher's class, because I think mod_python is trying to import the
module to make the object available.


You can look for it, waiting for an expert opinion.


Good Luck. 


	S.R.Pard?



From jpg at jgassociates.ca  Mon Feb  4 12:34:03 2008
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Mon Feb  4 12:34:10 2008
Subject: [mod_python] Sessions: Confused: Newbie
In-Reply-To: <46218daf0802040519r5ad612e4j12c283475476bb3c@mail.gmail.com>
References: <46218daf0802040519r5ad612e4j12c283475476bb3c@mail.gmail.com>
Message-ID: <47A74C8B.7010601@jgassociates.ca>

Make sure you call mySess.save(), otherwise the session is never saved 
and you'll get a new session on every request.

Jim

MCL Systems wrote:
> I thought I was understanding sessions but the following did not work as 
> I expected.
> 
> I was expecting the first execution to create a session with a PID of 
> 666 and a Hits Value of 1 and on each refresh of that page in the same 
> browser to increment the hit counter, but the 'is_new' test, returns 
> true every time.  I have tried this on several computers and with 
> different browsers, but always the same result.
> 
> Where have I gone wrong ?
> 
> Richard
> 
> MOD_PYTHON, Apache, PYTHON 2.5
> 
> Code =====================================
> from mod_python import Session, util
> 
> def index(req):
>     main(req)
>    
> def main(req):
>     mySess = Session.Session(req)
>     if mySess.is_new():
>         pid = 666
>         mySess['pid'] = str(pid)
>         mySess['hits'] = 1
>         req.write("NEW Session PID: %s <BR>\n" % mySess['pid'])
>         req.write("Hits: %s <br>\n" % mySess['hits'])
>     else:
>         mySess['hits'] +=1
>         req.write("OLD Session PID: %s <BR>\n" % mySess['pid'])
>         req.write("Hits: %s <br>\n" % mySess['hits'])
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
From mcl.office at googlemail.com  Mon Feb  4 12:54:35 2008
From: mcl.office at googlemail.com (MCL Systems)
Date: Mon Feb  4 12:54:41 2008
Subject: [mod_python] Sessions: Confused: Newbie
In-Reply-To: <47A74C8B.7010601@jgassociates.ca>
References: <46218daf0802040519r5ad612e4j12c283475476bb3c@mail.gmail.com>
	<47A74C8B.7010601@jgassociates.ca>
Message-ID: <46218daf0802040954v161421ebs6b6b4774bb0eb36c@mail.gmail.com>

Jim,

Thank you - how stupid of me.  It now works as I thought it would.

Is there a default timeout and is there anywhere where best practise for
session timeouts is documented.

I had this daft idea of resetting timeouts, if the browser was still active.

Richard

On 04/02/2008, Jim Gallacher <jpg@jgassociates.ca> wrote:
>
> Make sure you call mySess.save(), otherwise the session is never saved
> and you'll get a new session on every request.
>
> Jim
>
> MCL Systems wrote:
> > I thought I was understanding sessions but the following did not work as
> > I expected.
> >
> > I was expecting the first execution to create a session with a PID of
> > 666 and a Hits Value of 1 and on each refresh of that page in the same
> > browser to increment the hit counter, but the 'is_new' test, returns
> > true every time.  I have tried this on several computers and with
> > different browsers, but always the same result.
> >
> > Where have I gone wrong ?
> >
> > Richard
> >
> > MOD_PYTHON, Apache, PYTHON 2.5
> >
> > Code =====================================
> > from mod_python import Session, util
> >
> > def index(req):
> >     main(req)
> >
> > def main(req):
> >     mySess = Session.Session(req)
> >     if mySess.is_new():
> >         pid = 666
> >         mySess['pid'] = str(pid)
> >         mySess['hits'] = 1
> >         req.write("NEW Session PID: %s <BR>\n" % mySess['pid'])
> >         req.write("Hits: %s <br>\n" % mySess['hits'])
> >     else:
> >         mySess['hits'] +=1
> >         req.write("OLD Session PID: %s <BR>\n" % mySess['pid'])
> >         req.write("Hits: %s <br>\n" % mySess['hits'])
> >
> >
> > ------------------------------------------------------------------------
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20080204/f9e8dfc4/attachment.html
From denes1951 at yahoo.ca  Mon Feb  4 14:14:45 2008
From: denes1951 at yahoo.ca (Denes L)
Date: Mon Feb  4 14:24:23 2008
Subject: [mod_python] compile mod_python on iSeries (AS/400)
Message-ID: <767807.37960.qm@web45107.mail.sp1.yahoo.com>

Graham Dumpleton wrote:
>>> In src/include/mod_python.h.in (NOTE the extension is .h.in, not just.h), change:

The program now compiles but I had to make the change in mod_python.h not in the h.in file.

>>> You should do a make distclean and rerun configure.

Since this is not really a unix system I can not do that.

Instead I am creating a SRVPGM, the equivalent of a DLL in windows, but I get some undefined symbols which I have been able to reduce to these:
init_apache
MpConn_FromConn
MpFilter_FromFilter
MpHList_FromHLEntry
MpRequest_FromRequest
MpServer_FromServer
unixd_config
unixd_set_global_mutex_perms

I think I might be able to get rid of the ones starting with Mp by compiling some programs separately but the real question here is that I don't see apxs in the iseries Apache.
I know that it supports APR (Apache Portable Runtime) but is that equivalent to apxs? The created SRVPGM has to be loaded into Apache using a:
LoadModule Module in the config file.

Can mod_python work with APR?.

Thanks.

       
---------------------------------
Be smarter than spam. See how smart SpamGuard is at giving junk email the boot with the All-new Yahoo! Mail  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20080204/a96352ea/attachment.html
From graham.dumpleton at gmail.com  Mon Feb  4 17:10:10 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Feb  4 17:10:30 2008
Subject: [mod_python] compile mod_python on iSeries (AS/400)
In-Reply-To: <767807.37960.qm@web45107.mail.sp1.yahoo.com>
References: <767807.37960.qm@web45107.mail.sp1.yahoo.com>
Message-ID: <88e286470802041410r5e9cc27aj7e7a55e10ccbe754@mail.gmail.com>

On 05/02/2008, Denes L <denes1951@yahoo.ca> wrote:
> Graham Dumpleton wrote:
> >>> In src/include/mod_python.h.in (NOTE the extension is .h.in, not
> just.h), change:
>
> The program now compiles but I had to make the change in mod_python.h not in
> the h.in file.
>
> >>> You should do a make distclean and rerun configure.
>
> Since this is not really a unix system I can not do that.
>
> Instead I am creating a SRVPGM, the equivalent of a DLL in windows, but I
> get some undefined symbols which I have been able to reduce to these:
> init_apache

In 'src/_apachemodule.c'.

> MpConn_FromConn

In 'src/connobject.c'.

> MpFilter_FromFilter
> MpHList_FromHLEntry
> MpRequest_FromRequest
> MpServer_FromServer

Above similarly in other files in the 'src' directory.

> unixd_config
> unixd_set_global_mutex_perms

These are symbols which are part of Apache and will not be able to be
resolved when compiling mod_python. Normally apxs would tell the
linker to ignore undefined symbols.

> I think I might be able to get rid of the ones starting with Mp by compiling
> some programs separately but the real question here is that I don't see apxs
> in the iseries Apache.

Build mod_python on a real UNIX system and watch the build output. You
should see apxs echo back the real compiler command. You just need to
perform the equivalent.

> I know that it supports APR (Apache Portable Runtime) but is that equivalent
> to apxs?

No. The APR is a C library used by Apache in its implementation.

The 'apxs' program is a wrapper script to assist in compiling Apache modules.

> The created SRVPGM has to be loaded into Apache using a:
> LoadModule Module in the config file.
>
> Can mod_python work with APR?.

The mod_python code uses APR C library. Has because of how Apache also uses it.

Are you truly trying to get mod_python running so you can use
mod_python features, or do you simply want a way of running Python web
applications under Apache and don't care about what the Python web
server API is?

Graham
From graham.dumpleton at gmail.com  Mon Feb  4 17:15:02 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Feb  4 17:15:10 2008
Subject: [mod_python] Authorization problem
In-Reply-To: <20080204102217.HM.0000000000000I9@dvaras.bos-mail-wwl14.lycos.com>
References: <20080204102217.HM.0000000000000I9@dvaras.bos-mail-wwl14.lycos.com>
Message-ID: <88e286470802041415x48974d73jaf947c2155f72e9a@mail.gmail.com>

It would help if you told us what you expected to happen and what
actually happens, including any errors. Most people aren't going to
want to take your code and actually run it to try and work that out.
Even doing this might be hard anyway as one would have to assume how
you expected it to work. So, we can assist you in debugging it for
yourself, but you will need to explain the problem properly.

Graham

On 05/02/2008, vytas dvaras <dvaras@lycos.com> wrote:
> Hello everyone,
>
> I was trying to do an application with mod_python, that allows to use it's
> resources only to logged in users:
>
> I have:
> 1. One html page with login, password input fields and a submit button.
> 2. python script (that uses mod_python) and does something
>
> I would like to do so, that if the user is not logged in - he/she is
> redirected back to login page each time she/he tries to access any function
> without logging in.
>
>
> I used the example #1 from:
> http://wiki.apache.org/mod_python/Session_use_with_classes?highlight=%28CategoryExamples%29
>
> The problem is that my script "enhancements" don't work as expected. I was
> trying to solve this problem for some time, but at last I came to a
> conclusion that a help from somebody else is really needed :)
>
> index.html:
>
>
>
>
>
>
>
>
>
>
>
>  Login:
>
>
>  Password:
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
> _sessions.py:
> from mod_python import apache, util, Session
>
> def handler(req):
>  #login = req.form.getfirst('vardas') #this does't work here
>
>  # but I would like to make a session after I authenticate a user
>  if not hasattr(req, 'session'):
>  req.session = Session.Session(req)
>  return apache.OK
>
>
> aha.py:
> from mod_python import apache, util, Session
> from time import time
>
> _tags = (1,2,3,4)
>
> class ExampleSession:
>  def __call__(self, req):
>
>  # these lines work, but the session IS allready created
>  login = req.form.getfirst('vardas')
>  passw = req.form.getfirst('slaptazodis')
>
>  if login != 'testas' or passw != '007':
>  util.redirect(req, '../index.html')
>
>  # these work in _session.py, but don't work here
> # if not hasattr(req, 'session'):
> # util.redirect(req, '../index.html')
>  return self._foo(req)
>
>
>  def __init__(self, *args, **kwargs):
>  # Do something with the args here.
>  return
>
>
>  def _foo(self, req):
>
>  try:
>  delta = int(time()- req.session['last'])
>  except KeyError:
>  delta = 0
>  total = int(time()- req.session.created())
>  try:
>  req.session['hits'] += 1
>  except:
>  req.session['hits'] = 1
>
>  req.session['last'] = req.session.last_accessed()
>  req.session.save()
>  return """Session ID: %s
> This session has been active for %d seconds
> This session was last accessed %d seconds ago
> This session has been accessed %d times
> """ % \
>  (req.session.id(), total, delta, req.session['hits'], 'login', 'passw')
>
> foo = ExampleSession(_tags)
>
>
>
> What am I doing wrong? I can't find any better working examples and I have
> allready read everything I found relating to my problem. So if you have any
> ideas or examples it would be great to have a look at them.
>
> Regards,
> Vytas
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
From graham.dumpleton at gmail.com  Mon Feb  4 17:27:20 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Feb  4 17:27:30 2008
Subject: [mod_python] Import error on multiple interpreters
In-Reply-To: <ed756d900802040809k69c48d9al243c0c77c8012985@mail.gmail.com>
References: <ed756d900802040809k69c48d9al243c0c77c8012985@mail.gmail.com>
Message-ID: <88e286470802041427r3d8766fambc8f121b08c5ffc3@mail.gmail.com>

What settings do you have in your configuration for:

  PythonPath ...
  PythonOption mod_python.importer.path ...

The module importer doesn't add paths automatically to sys.path and
uses its own path which is in part based on the request context. The
locations it can look in can therefore vary based on where your
handler code is located which the request mapped to. As such, you may
need to explicitly set the module importer path option if a specific
directory must always be checked.

The other option is that if you are relying on being able to import
from a module installed on sys.path, ie., standard module, a module
which only exists somewhere on mod_python module path. You can't do
this, when using 'import' in a standard Python module, it will only
look for stuff on sys.path.

Answer these questions, but also make sure you have read up on
import_module function in:

  http://www.modpython.org/live/current/doc-html/pyapi-apmeth.html

if you haven't done so already.

Graham

On 05/02/2008, Tom Wells <drshade@gmail.com> wrote:
> Hi Everyone
>
> I have been bumbling along with mod_python for about a month using
> mod_python as the apache hooks for integrating into a larger single-sign-on
> solution, so far so good. However I'm hitting my head against a weird issue,
> and can't seem to find any reference to related issues on this list, nor the
> FAQ, so here goes:
>
> I'm supporting multiple apache virtual hosts, and separating them by running
> each in a different python interpretor (using PythonInterpreter <site_name>
> within the VirtualHost configuration for each site.
>
> I hook into apache via PythonAuthenHandler and PythonAuthzHandler (as my app
> is only concerned with authentication and authorization) and make web
> service calls using ZSI and some cryptographic routines using ncrypt (Python
> OpenSSL wrapper) before allowing or disallowing access to the particular
> resource.
>
> So the above works nicely, but while testing I occasionally get the
> following error (not on startup, but after a few requests):
> [Mon Feb 04 17:41:57 2008] [notice] mod_python (pid=26429,
> interpreter='ssofilter_interpreter_mobile'): Importing
> module '/home/tom/dev/auth/ssofilter-apache-2.2/ssofilter.py'
>  [Mon Feb 04 17:41:57 2008] [notice] mod_python (pid=26429,
> interpreter='ssofilter_interpreter_mobile'): Importing
> module '/home/tom/dev/auth/ssofilter-apache-2.2/webserver.py'
> [Mon Feb 04 17:41:57 2008] [notice] mod_python (pid=26429,
> interpreter='ssofilter_interpreter_mobile'): Importing
> module '/home/tom/dev/auth/ssofilter-apache-2.2/cache.py'
>  [Mon Feb 04 17:41:57 2008] [notice] mod_python (pid=26429,
> interpreter='ssofilter_interpreter_mobile'): Importing
> module '/home/tom/dev/auth/ssofilter-apache-2.2/authserver.py'
> [Mon Feb 04 17:41:57 2008] [notice] mod_python (pid=26429,
> interpreter='ssofilter_interpreter_mobile'): Importing
> module '/home/tom/dev/auth/ssofilter-apache-2.2/ausService_services.py'
>  [Mon Feb 04 17:41:57 2008] [notice] mod_python (pid=26429,
> interpreter='ssofilter_interpreter_mobile'): Importing
> module
> '/home/tom/dev/auth/ssofilter-apache-2.2/ausService_services_types.py'
> [Mon Feb 04 17:41:57 2008] [notice] mod_python (pid=26429,
> interpreter='ssofilter_interpreter_mobile'): Importing
> module '/home/tom/dev/auth/ssofilter-apache-2.2/utils.py'
>  [Mon Feb 04 17:41:57 2008] [notice] mod_python (pid=26429,
> interpreter='ssofilter_interpreter_mobile'): Importing
> module '/home/tom/dev/auth/ssofilter-apache-2.2/cryptography.py'
> [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42] mod_python
> (pid=26429, interpreter='ssofilter_interpreter_mobile',
> phase='PythonAuthenHandler', handler='ssofilter'): Application error
>  [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42] ServerName:
> 'mobile.domain.co.za'
> [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42] DocumentRoot:
> '/home/tom/dev/auth/mobileweb'
>  [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42] URI: '/'
> [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42] Location: '/'
>  [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42] Directory: None
> [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42] Filename:
> '/home/tom/dev/auth/mobileweb/'
>  [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42] PathInfo: ''
> [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42] Traceback (most
> recent call last):
>  [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42]   File
> "/usr/lib/python2.5/site-packages/mod_python/importer.py",
> line 1537, in HandlerDispatch\n    default=default_handler, arg=req,
> ilent=hlist.silent)
>  [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42]   File
> "/usr/lib/python2.5/site-packages/mod_python/importer.py",
> line 1202, in _process_target\n    module = import_module(module_name,
> path=path)
>  [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42]   File
> "/usr/lib/python2.5/site-packages/mod_python/importer.py",
> line 296, in import_module\n    log, import_path)
>  [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42]   File
> "/usr/lib/python2.5/site-packages/mod_python/importer.py",
> line 680, in import_module\n    execfile(file, module.__dict__)
>  [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42]   File
> "/home/tom/dev/auth/ssofilter-apache-2.2/ssofilter.py", line 10, in
> <module>\n    cryptography = apache.import_module('cryptography')
>  [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42]   File
> "/usr/lib/python2.5/site-packages/mod_python/importer.py",
> line 296, in import_module\n    log, import_path)
>  [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42]   File
> "/usr/lib/python2.5/site-packages/mod_python/importer.py",
> line 680, in import_module\n    execfile(file, module.__dict__)
>  [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42]   File
> "/home/tom/dev/auth/ssofilter-apache-2.2/cryptography.py", line 4, in
> <module>\n    cipher = apache.import_module('ncrypt.cipher')
>  [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42]   File
> "/usr/lib/python2.5/site-packages/mod_python/importer.py",
> line 304, in import_module\n    return __import__(module_name, {}, {},
> ['*'])
>  [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42]   File
> "/var/lib/python-support/python2.5/ncrypt/cipher.py", line
> 1, in <module>\n    from _ncrypt.cipher import *
>  [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42] ImportError: No
> module named cipher
>
> Now you may think I'm posting this to the wrong list looking at the
> stacktrace, but I'm convinced it's mod_python related. While testing the
> first few requests go through fine (and ncrypt is imported correctly), but
> it seems like the error occurs when apache has decided to create a new
> thread (or spawn a new process, difficult to tell) that the error occurs
> (the log entries containing "Importing Module" are spat out by mod_python,
> as I use the apache.import_module() function for performing all my imports).
>
> A hint is if I make all my sites run under one single python interpreter (by
> giving them the same name) I don't experience the problem, but I'd prefer
> not to run under this configuration as I'd need to do a whole lot more work
> to ensure that data remains separated per site.
>
> Any comments, suggestions would be greatly appreciated!
>
> Thanks,
> Tom
>
> PS> Running mod_python 3.3.1-2, running on ubuntu 7.10 in apache
> 2.2.4-3build1. My apache runtime configuration looks something like:
>  [Mon Feb 04 17:40:10 2008] [notice] Apache Configuration:
> [Mon Feb 04 17:40:10 2008] [notice]  AP_MPMQ_MAX_DAEMON_USED     -> 2 [Max #
> of daemons used so far]
> [Mon Feb 04 17:40:10 2008] [notice]  AP_MPMQ_IS_THREADED         -> 1
> [0=Unsupported, 1=Static, 2=Dynamic]
>  [Mon Feb 04 17:40:10 2008] [notice]  AP_MPMQ_IS_FORKED           -> 2
> [0=Unsupported, 1=Static, 2=Dynamic]
> [Mon Feb 04 17:40:10 2008] [notice]  AP_MPMQ_HARD_LIMIT_DAEMONS  -> 16 [The
> compiled max # daemons]
> [Mon Feb 04 17:40:10 2008] [notice]  AP_MPMQ_HARD_LIMIT_THREADS  -> 64 [The
> compiled max # threads]
>  [Mon Feb 04 17:40:10 2008] [notice]  AP_MPMQ_MAX_THREADS         -> 25 [#
> of threads/child by config]
> [Mon Feb 04 17:40:10 2008] [notice]  AP_MPMQ_MIN_SPARE_DAEMONS   -> 0 [Min #
> of spare daemons]
> [Mon Feb 04 17:40:10 2008] [notice]  AP_MPMQ_MIN_SPARE_THREADS   -> 25 [Min
> # of spare threads]
>  [Mon Feb 04 17:40:10 2008] [notice]  AP_MPMQ_MAX_SPARE_DAEMONS   -> 0 [Max
> # of spare daemons]
> [Mon Feb 04 17:40:10 2008] [notice]  AP_MPMQ_MAX_SPARE_THREADS   -> 75 [Max
> # of spare threads]
> [Mon Feb 04 17:40:10 2008] [notice]  AP_MPMQ_MAX_REQUESTS_DAEMON -> 10 [Max
> # of requests per daemon]
>  [Mon Feb 04 17:40:10 2008] [notice]  AP_MPMQ_MAX_DAEMONS         -> 6 [Max
> # of daemons by config]
>
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
From graham.dumpleton at gmail.com  Tue Feb  5 05:12:17 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Feb  5 05:12:46 2008
Subject: [mod_python] mod_python.Importer.path; set dynamically
In-Reply-To: <B6C73A5E30565245BB6D32B5F5DF7A52172BA3@sense.emmastraat.pijnacker>
References: <B6C73A5E30565245BB6D32B5F5DF7A52172BA2@sense.emmastraat.pijnacker>
	<88e286470801311403u467069a8r75eab9f16184c0fd@mail.gmail.com>
	<B6C73A5E30565245BB6D32B5F5DF7A52172BA3@sense.emmastraat.pijnacker>
Message-ID: <88e286470802050212s2355593ds96b743a8061cd159@mail.gmail.com>

Sorry for the delay.

To make things work transparently across a lot of modules, for both
import_module() and 'import' where possible, what you can do is modify
the value of option 'mod_python.importer.path' dynamically from code.
This can be done from memory using:

  req.options['mod_python.importer.path'] = "...."

You obviously can query this first if you need to somehow manipulate
it to add stuff.

All you then need is a level of indirection. Has to be from inside of
handler, can't be at global scope. So,
/var/www/python_modules/index.py might do:

  def index(req, *args, **kwargs):
    req.options['mod_python.importer.path'] = \
        '/var/www/python_modules/%s:/var/www/python_modules' % req.user
    module = apache.import_module('index-core')
    return module.index(req, *args, **kwargs)

If there is only one level of module imports, you could also do just:

  def index(req, *args, **kwargs):
    module = apache.import_module('index-core', \
        path=['/var/www/python_modules/%s:/var/www/python_modules' % req.user]))
    return module.index(req, *args, **kwargs)

but think that if subdirectory uses 'import', then it might not look
in all the directories. Can't remember how it works now.

Anyway the suggestion is look at changing req.options if you haven't already.

Graham

On 01/02/2008, Martijn Moeling <martijn@xs4us.nu> wrote:
>
>
>
> Graham,
>
>  As you might remember I added a MySQLdb section to session.
>  (to be able to save sessions across computers)
>
>  In my system a lot of additional data is added to the req object, which is
> passed
>  around. in my case it is req.Session.user.
>
>  (I do not use http based auth, since this is in conflict with my web based
> desktop)
>
>  nevertheless, i can change your "example code" to my needs, consider
> req.user as the distinguisher for ease of thinking.
>
>  Martijn
>
>
>
>
>  -----Original Message-----
>  From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
>  Sent: Thu 31.01.2008 23:03
>  To: Martijn Moeling
>  Cc: mod_python@modpython.org
>  Subject: Re: [mod_python] mod_python.Importer.path; set dynamically
>
>  On 01/02/2008, Martijn Moeling <martijn@xs4us.nu> wrote:
>  > Hi!
>  >
>  >  I am an extensive mod_python user and my system needs something special.
>  >
>  >  Consider the following:
>  >
>  >  in httpd.conf I have :
>  >
>  >  PythonOption mod_python.importer.path ["/var/www/python_modules"]
>  >
>  >  /var/www/html/index.py is linked to ../python_modules/index.py
>  >
>  >  the python_modules directory has subdirectories, like; developer1,
>  > developer2
>  >
>  >  the python_modules contains stable modules and developerX holds
> development
>  > versions.
>  >
>  >  I have load balancing with multiple frond-ends (apache/MP) and one
> backend
>  > (MySQL).
>  >
>  >  I would like to dynamically change the mod_python.importer.path so that
>  > developer1 runs code in the corresponding subdir if the module exists,
>  >  else fall back to the python_modules directory.
>  >
>  >  Any tips, suggestions, remarks?
>
>  What is the distinguisher used to know which developer it is? Are you
>  using something like Basic authentication and so could distinguish
>  based on req.user?
>
>  If you tell me what the distinguisher is, probably have an idea.
>
>  Graham
>
>
From graham.dumpleton at gmail.com  Tue Feb  5 05:20:34 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Feb  5 05:20:39 2008
Subject: [mod_python] Physical paths ?
In-Reply-To: <88e286470802021304u74f0f11aq52a8369d69530a36@mail.gmail.com>
References: <1201863943.5934.35.camel@ThorUx>
	<88e286470802011336p3a5e201bwfc9f6007b7614e45@mail.gmail.com>
	<1201947998.7084.72.camel@ThorUx>
	<88e286470802021304u74f0f11aq52a8369d69530a36@mail.gmail.com>
Message-ID: <88e286470802050220q31382c0cocf83599fbe4748a7@mail.gmail.com>

Sorry for the delay.

Since you are using .psp files, then you must be using AddHandler. As
a result the following should work to give you the name of the
directory corresponding to the Directory container in Apache
configuration, or .htaccess file, that you defined PythonHandler in.

        root = req.hlist.directory
        parent = req.hlist.parent
        while parent is not None:
            root = parent.directory
            parent = parent.parent

In other words, if in main Apache configuration you have:

  Alias /MyApp/ /home/user/MyApp/

  <Directory /home/user/MyApp>
  AddHandler mod_python .psp
  PythonHandler mod_python.psp | .psp
  ...
  </Directory>

The 'root' should end up being '/home/user/MyApp'.

This only works where PythonHandler in a Directory container or .htaccess file.

You must be using mod_python 3.3.1.

Graham

On 03/02/2008, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> Please keep your replies on the list.
>
> FYI. That code was setting req.application_root so you could use it as
> a reference, not trying to use it.
>
> Do:
>
>   PythonHandler somemodulenameinrootofpspfilesdirectory .psp
>   PythonHandler mod_python.psp .psp
>
> In somemodulenameinrootofpspfilesdirectory.py have:
>
>   import os
>
>   def handler(req):
>     req.application_root = os.path,dirname(__file__)
>     return apache.OK
>
> Read the documentation about stacked mod_python handlers to see how this works.
>
> Have no time to read all this new mail now, maybe someone else will help.
>
> Graham
>
> ---------- Forwarded message ----------
> From: S.R.Pard? <linux@qbox.es>
> Date: 2 Feb 2008 21:26
> Subject: Re: [mod_python] Physical paths ?
> To: Graham Dumpleton <graham.dumpleton@gmail.com>
>
>
> Thank You.
>
> I'm using: PythonHandler mod_python.psp and req.application_root doesn't
> exist.
> But __file__ is '/usr/lib/python2.5/site-packages/mod_python/psp.pyc' in
> the psp page, so it doen't seem related to the root of my app pages
> where I wnt to save.
>
>
>
> Anyway, I will try to explain it better, so it can help any other person
> in the future looking for info like this.
>
> Basically, I want the mod_python psp application, allow content upload
> from the user client:
>
> That's done in:         http://SERVER/MyApp/config/upload.psp
> (and that page is in /home/user/MyApp/config/index.psp)
>
> And I want to save the user file to a directory accesible later at:
>         http://SERVER/MyApp/images/users/USER_FILE
> (that page would be in /home/user/MyApp/images/users)
>
> So the upload.psp save the file received from form at that images
> directory (instead of the form directory).
>
>
>
> I wanted that the code from upload psp will pass a relative path from
> the root of the App (/MyApp) to the module that saves the file, that is
> something like:
>         save_file(USER_FILE,"images/users/", req)
>
> I needed the save_file to obtain the physical path to the URL:
>         '//SERVER' + '/MyApp/' + 'images/users/'
>         (server + application_root + destiny_folder)
> that is, the physical path to save the file:
>         '/home/user/MyApp/config/index.psp'
>
> Of course, I didn't wanted the function to use a constant to the root of
> the application '/home/user/MyApp' (at code time) to allow to the
> application to be independent from the installation directory.
>
>
>
> I know req.filename give me the physical path to
> http://SERVER/MyApp/config/upload.psp
> that is:
> /home/user/MyApp/config/upload.psp
>
> so I could save to '/home/user/MyApp/config/' without problem. And the
> same in some subdirectory like '/home/user/MyApp/config/images/users/'.
> I know.
>
> But, I had an images directory in '/home/user/MyApp/images/', and maybe
> I like the things in the hard way. And decide to save to that directory
> of images (don't ask me why).
> I know that ... application root is at '..' relative to the physical
> directory of the page ('/home/user/MyApp/config/').
> But I really like the things in the hard way and I wanted the save
> function to be usable from any other pages in other directories, and I
> don't wanted to send a constant relative path to the app root (remember
> '/home/user/MyApp/') from every page to the save function (because, I
> want app to be independent of the installation directory, and I don't
> want to worry about the constant relative paths if I move the pages).
>
>
> So, the code I'm using now, take the physical path of the page, and the
> uri of the page , and the application root (uri), to obtain the physical
> path of the application.
> And from that , I can take the pyshical path of any subdirectory
> relative to root (only if no subdirectory with alias are involved, of
> course).
>
> ######
> def physicalAppRoot(req):
>
>   rootApp = req.get_options()['mod_python.session.application_path']
>   pageDir, pageName = os.path.split(req.parsed_uri[6])
>
>   if pageDir.startswith(rootApp):
>      appPageDir = pageDir[len(rootApp):]
>   else:
>      appPageDir = pageDir
>
>   physPath = os.path.dirname(req.filename)
>
>   i = physPath.rfind(appPageDir)
>   physAppRoot = physPath[:i]+os.path.sep
>
>   return physAppRoot
> ######
>
>
> The application path is an apache's directory alias, so option
> application_path is indicated in the config (like you said me Graham, to
> set different paths for cookies from various applications, and that
> worked great for me).
>
>
>
> That's work for me but, really all I wanted was some function like:
>
>         physicalPath(uri = 'images/users/')
> or
>         physicalPath(uri = '/MyApp/images/users/')
>
> that give me:  '/home/user/MyApp/images/users/'
> for an apache mod_python application installed in /home/user/MyApp,
> accessible at 'http://server/MyApp' (because an alias would be set at
> apache 'alias /MyApp/ "/home/user/MyApp"').
>
>
>
> Sorry, if I can explain it better. Maybe I'm doing a silly thing,
> because an apache function available at mod_python does exctly this, but
> I didn't found it.
>
>
>
> Thank You,
>
>
>         S.R.Pard?
>
>
>
> El s?b, 02-02-2008 a las 08:36 +1100, Graham Dumpleton escribi?:
> > I think I only partly understand what you want. Anyway, work out what
> > the following would do if done in your mod_python handler.
> >
> >   import os
> >   req.application_root = os.path.dirname(__file__)
> >
> > Graham
> >
> > On 01/02/2008, S.R.Pard? <linux@qbox.es> wrote:
> > > Hi,
> > >
> > > Now, thank you to your help,  my applicattion is capable of receive
> > > image files from users using forms.
> > > And app store them into a physical path of the server.
> > >
> > >
> > > It's possible to save from the app to an uri folder ?
> > >
> > > Can I know the physical path of one uri ?
> > >
> > >
> > > I can save easily to a subfolder of the pyhsical path obtained by
> > > req.filename relative to the page visited, and that can work without
> > > problem.
> > >
> > >
> > > But I would like the module (the module that implements the form
> > > proccesing) receive the relative route relative to the root of the
> > > application path, so module will not need to know the physical structure
> > > of directories, and can save to a route not descendent of the directory
> > > of my own page.
> > >
> > > ... And in my app, the root of the app is a directory alias. outside of
> > > the apache document_root '/var/www'
> > >
> > >
> > > That's it
> > >
> > >         DocumentRoot    /             /var/www
> > >
> > >         Alias           MyApp         /home/user/MyApp/
> > >
> > >         /MyApp/index.psp   .......... /home/user/MyApp/index.psp
> > >
> > >         /MyApp/config/upload.psp  ... /home/user/MyApp/config/index.psp
> > >
> > >         /MyApp/images/  ............. /home/user/MyApp/images/
> > >         /MyApp/images/users/    ..... /home/user/MyApp/images/users/
> > >
> > >
> > > And I want to obtain from code executed in
> > >
> > >         http:/MyApp/config/upload.psp
> > >
> > > the physical path of root of the application:
> > >
> > >
> > >
> > > so I can't sent to a function in form.py:
> > >
> > >         app_root = ???    # function that returns '/home/user/MyApp/'
> > >         imgs_folder = 'images/users/'
> > >
> > >         process(form, directory_to_save = app_root+imgs_folder)
> > >
> > >
> > > So, the code is independent of the installation directory and the app
> > > path.
> > >
> > > Another thing ... if images would be an alias, ? could I know the path ?
> > >
> > >
> > >
> > >
> > > Thank You again.
> > >
> > >         S.R.Parda
> > >
> > > _______________________________________________
> > > Mod_python mailing list
> > > Mod_python@modpython.org
> > > http://mailman.modpython.org/mailman/listinfo/mod_python
> > >
>

From mateusz at ant.gliwice.pl  Tue Feb  5 06:09:03 2008
From: mateusz at ant.gliwice.pl (Mateusz Korniak)
Date: Tue Feb  5 06:09:26 2008
Subject: [mod_python] Execute python code while having generated page
	content already sent to browser - possible ?
Message-ID: <200802051209.03447.mateusz@ant.gliwice.pl>

Hi !
Is there any way to continue execute python code while having generated page 
content already sent to browser ?

What I would like to implement is:

content = generate_page_content() # It takes 0.02[s]
sent_to_browser(content) # We are not going to send anything more to browser
lazy_processing_of_request() # May take serveral seconds.

I do not want make browser to wait util lazy_processing_of_request() finishes 
to start receiving page contents.

Is it possible ?

Thanks in advance, 

mod_python-3.2.10
linux, mpm

-- 
Mateusz Korniak
From drshade at gmail.com  Tue Feb  5 08:13:53 2008
From: drshade at gmail.com (Tom Wells)
Date: Tue Feb  5 08:14:00 2008
Subject: [mod_python] Import error on multiple interpreters
In-Reply-To: <88e286470802041427r3d8766fambc8f121b08c5ffc3@mail.gmail.com>
References: <ed756d900802040809k69c48d9al243c0c77c8012985@mail.gmail.com>
	<88e286470802041427r3d8766fambc8f121b08c5ffc3@mail.gmail.com>
Message-ID: <ed756d900802050513p6a97a44fk95449ddb24b69b0@mail.gmail.com>

Hi Graham

I think i've nailed this one down - turns out that the ncrypt package
doesn't like to be loaded twice into the same process (although under
different interpreters). Confirmed this by writing a simple
startup.pyscript which contained the following:

from mod_python import apache
cipher = apache.import_module('ncrypt.cipher')
apache.log_error('******** IMPORTED', apache.APLOG_NOTICE)

Then, in my apache config did a:
PythonImport startup interpreter1
PythonImport startup interpreter2

Running this, I see in my log file:
[Tue Feb 05 14:34:23 2008] [notice] SIGUSR1 received.  Doing graceful
restart
[Tue Feb 05 14:34:23 2008] [notice] mod_python: Creating 8 session mutexes
based on 4 max processes and 25 max threads.
[Tue Feb 05 14:34:23 2008] [notice] mod_python: using mutex_directory /tmp
[Tue Feb 05 14:34:23 2008] [notice] Apache/2.2.4 (Ubuntu) mod_python/3.3.1
Python/2.5.1 configured -- resuming normal operations
[Tue Feb 05 14:34:24 2008] [notice] ******** IMPORTED
[Tue Feb 05 14:34:24 2008] [notice] ******** IMPORTED
Traceback (most recent call last):
  File "/usr/lib/python2.5/site-packages/mod_python/importer.py", line 1695,
in ImportDispatch
    module = import_module(module_name, log=debug)
  File "/usr/lib/python2.5/site-packages/mod_python/importer.py", line 296,
in import_module
    log, import_path)
  File "/usr/lib/python2.5/site-packages/mod_python/importer.py", line 680,
in import_module
    execfile(file, module.__dict__)
  File "/home/tom/dev/auth/ssofilter-apache-2.2/startup.py", line 4, in
<module>
    cipher = apache.import_module('ncrypt.cipher')
  File "/usr/lib/python2.5/site-packages/mod_python/importer.py", line 304,
in import_module
    return __import__(module_name, {}, {}, ['*'])
  File "/var/lib/python-support/python2.5/ncrypt/cipher.py", line 1, in
<module>
    from _ncrypt.cipher import *
ImportError: No module named cipher
[Tue Feb 05 14:34:25 2008] [error] directive_PythonImport: error importing
startup
Traceback (most recent call last):
  File "/usr/lib/python2.5/site-packages/mod_python/importer.py", line 1695,
in ImportDispatch
    module = import_module(module_name, log=debug)
  File "/usr/lib/python2.5/site-packages/mod_python/importer.py", line 296,
in import_module
    log, import_path)
  File "/usr/lib/python2.5/site-packages/mod_python/importer.py", line 680,
in import_module
    execfile(file, module.__dict__)
  File "/home/tom/dev/auth/ssofilter-apache-2.2/startup.py", line 4, in
<module>
    cipher = apache.import_module('ncrypt.cipher')
  File "/usr/lib/python2.5/site-packages/mod_python/importer.py", line 304,
in import_module
    return __import__(module_name, {}, {}, ['*'])
  File "/var/lib/python-support/python2.5/ncrypt/cipher.py", line 1, in
<module>
    from _ncrypt.cipher import *
ImportError: No module named cipher
[Tue Feb 05 14:34:25 2008] [error] directive_PythonImport: error importing
startup

The first interpreter imports the module fine (as seen by ******** IMPORTED
log entry), but the second one fails (two exceptions).

So after some head-scratching came upon a theory - the ncrypt package is a
binary .so (called _ncrypt), and maybe it doesn't like being loaded twice
into the same process (not sure about unix, but in the windows environment
have come across similar dll loading issues). So tried a couple of other
binary packages such as socket which did work. So i've decided to ditch
ncrypt as my cryptography package and have opted to use pycrypto instead
(and which is happy being imported twice).

Guess I should post this off to the ncrypt mailing list too!

Ciao,
Tom


On Feb 5, 2008 12:27 AM, Graham Dumpleton <graham.dumpleton@gmail.com>
wrote:

> What settings do you have in your configuration for:
>
>  PythonPath ...
>  PythonOption mod_python.importer.path ...
>
> The module importer doesn't add paths automatically to sys.path and
> uses its own path which is in part based on the request context. The
> locations it can look in can therefore vary based on where your
> handler code is located which the request mapped to. As such, you may
> need to explicitly set the module importer path option if a specific
> directory must always be checked.
>
> The other option is that if you are relying on being able to import
> from a module installed on sys.path, ie., standard module, a module
> which only exists somewhere on mod_python module path. You can't do
> this, when using 'import' in a standard Python module, it will only
> look for stuff on sys.path.
>
> Answer these questions, but also make sure you have read up on
> import_module function in:
>
>  http://www.modpython.org/live/current/doc-html/pyapi-apmeth.html
>
> if you haven't done so already.
>
> Graham
>
> On 05/02/2008, Tom Wells <drshade@gmail.com> wrote:
> > Hi Everyone
> >
> > I have been bumbling along with mod_python for about a month using
> > mod_python as the apache hooks for integrating into a larger
> single-sign-on
> > solution, so far so good. However I'm hitting my head against a weird
> issue,
> > and can't seem to find any reference to related issues on this list, nor
> the
> > FAQ, so here goes:
> >
> > I'm supporting multiple apache virtual hosts, and separating them by
> running
> > each in a different python interpretor (using PythonInterpreter
> <site_name>
> > within the VirtualHost configuration for each site.
> >
> > I hook into apache via PythonAuthenHandler and PythonAuthzHandler (as my
> app
> > is only concerned with authentication and authorization) and make web
> > service calls using ZSI and some cryptographic routines using ncrypt
> (Python
> > OpenSSL wrapper) before allowing or disallowing access to the particular
> > resource.
> >
> > So the above works nicely, but while testing I occasionally get the
> > following error (not on startup, but after a few requests):
> > [Mon Feb 04 17:41:57 2008] [notice] mod_python (pid=26429,
> > interpreter='ssofilter_interpreter_mobile'): Importing
> > module '/home/tom/dev/auth/ssofilter-apache-2.2/ssofilter.py'
> >  [Mon Feb 04 17:41:57 2008] [notice] mod_python (pid=26429,
> > interpreter='ssofilter_interpreter_mobile'): Importing
> > module '/home/tom/dev/auth/ssofilter-apache-2.2/webserver.py'
> > [Mon Feb 04 17:41:57 2008] [notice] mod_python (pid=26429,
> > interpreter='ssofilter_interpreter_mobile'): Importing
> > module '/home/tom/dev/auth/ssofilter-apache-2.2/cache.py'
> >  [Mon Feb 04 17:41:57 2008] [notice] mod_python (pid=26429,
> > interpreter='ssofilter_interpreter_mobile'): Importing
> > module '/home/tom/dev/auth/ssofilter-apache-2.2/authserver.py'
> > [Mon Feb 04 17:41:57 2008] [notice] mod_python (pid=26429,
> > interpreter='ssofilter_interpreter_mobile'): Importing
> > module '/home/tom/dev/auth/ssofilter-apache-2.2/ausService_services.py'
> >  [Mon Feb 04 17:41:57 2008] [notice] mod_python (pid=26429,
> > interpreter='ssofilter_interpreter_mobile'): Importing
> > module
> > '/home/tom/dev/auth/ssofilter-apache-2.2/ausService_services_types.py'
> > [Mon Feb 04 17:41:57 2008] [notice] mod_python (pid=26429,
> > interpreter='ssofilter_interpreter_mobile'): Importing
> > module '/home/tom/dev/auth/ssofilter-apache-2.2/utils.py'
> >  [Mon Feb 04 17:41:57 2008] [notice] mod_python (pid=26429,
> > interpreter='ssofilter_interpreter_mobile'): Importing
> > module '/home/tom/dev/auth/ssofilter-apache-2.2/cryptography.py'
> > [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42] mod_python
> > (pid=26429, interpreter='ssofilter_interpreter_mobile',
> > phase='PythonAuthenHandler', handler='ssofilter'): Application error
> >  [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42] ServerName:
> > 'mobile.domain.co.za'
> > [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42] DocumentRoot:
> > '/home/tom/dev/auth/mobileweb'
> >  [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42] URI: '/'
> > [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42] Location: '/'
> >  [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42] Directory:
> None
> > [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42] Filename:
> > '/home/tom/dev/auth/mobileweb/'
> >  [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42] PathInfo: ''
> > [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42] Traceback
> (most
> > recent call last):
> >  [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42]   File
> > "/usr/lib/python2.5/site-packages/mod_python/importer.py",
> > line 1537, in HandlerDispatch\n    default=default_handler, arg=req,
> > ilent=hlist.silent)
> >  [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42]   File
> > "/usr/lib/python2.5/site-packages/mod_python/importer.py",
> > line 1202, in _process_target\n    module = import_module(module_name,
> > path=path)
> >  [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42]   File
> > "/usr/lib/python2.5/site-packages/mod_python/importer.py",
> > line 296, in import_module\n    log, import_path)
> >  [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42]   File
> > "/usr/lib/python2.5/site-packages/mod_python/importer.py",
> > line 680, in import_module\n    execfile(file, module.__dict__)
> >  [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42]   File
> > "/home/tom/dev/auth/ssofilter-apache-2.2/ssofilter.py", line 10, in
> > <module>\n    cryptography = apache.import_module('cryptography')
> >  [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42]   File
> > "/usr/lib/python2.5/site-packages/mod_python/importer.py",
> > line 296, in import_module\n    log, import_path)
> >  [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42]   File
> > "/usr/lib/python2.5/site-packages/mod_python/importer.py",
> > line 680, in import_module\n    execfile(file, module.__dict__)
> >  [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42]   File
> > "/home/tom/dev/auth/ssofilter-apache-2.2/cryptography.py", line 4, in
> > <module>\n    cipher = apache.import_module('ncrypt.cipher')
> >  [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42]   File
> > "/usr/lib/python2.5/site-packages/mod_python/importer.py",
> > line 304, in import_module\n    return __import__(module_name, {}, {},
> > ['*'])
> >  [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42]   File
> > "/var/lib/python-support/python2.5/ncrypt/cipher.py", line
> > 1, in <module>\n    from _ncrypt.cipher import *
> >  [Mon Feb 04 17:41:57 2008] [error] [client 192.168.16.42] ImportError:
> No
> > module named cipher
> >
> > Now you may think I'm posting this to the wrong list looking at the
> > stacktrace, but I'm convinced it's mod_python related. While testing the
> > first few requests go through fine (and ncrypt is imported correctly),
> but
> > it seems like the error occurs when apache has decided to create a new
> > thread (or spawn a new process, difficult to tell) that the error occurs
> > (the log entries containing "Importing Module" are spat out by
> mod_python,
> > as I use the apache.import_module() function for performing all my
> imports).
> >
> > A hint is if I make all my sites run under one single python interpreter
> (by
> > giving them the same name) I don't experience the problem, but I'd
> prefer
> > not to run under this configuration as I'd need to do a whole lot more
> work
> > to ensure that data remains separated per site.
> >
> > Any comments, suggestions would be greatly appreciated!
> >
> > Thanks,
> > Tom
> >
> > PS> Running mod_python 3.3.1-2, running on ubuntu 7.10 in apache
> > 2.2.4-3build1. My apache runtime configuration looks something like:
> >  [Mon Feb 04 17:40:10 2008] [notice] Apache Configuration:
> > [Mon Feb 04 17:40:10 2008] [notice]  AP_MPMQ_MAX_DAEMON_USED     -> 2
> [Max #
> > of daemons used so far]
> > [Mon Feb 04 17:40:10 2008] [notice]  AP_MPMQ_IS_THREADED         -> 1
> > [0=Unsupported, 1=Static, 2=Dynamic]
> >  [Mon Feb 04 17:40:10 2008] [notice]  AP_MPMQ_IS_FORKED           -> 2
> > [0=Unsupported, 1=Static, 2=Dynamic]
> > [Mon Feb 04 17:40:10 2008] [notice]  AP_MPMQ_HARD_LIMIT_DAEMONS  -> 16
> [The
> > compiled max # daemons]
> > [Mon Feb 04 17:40:10 2008] [notice]  AP_MPMQ_HARD_LIMIT_THREADS  -> 64
> [The
> > compiled max # threads]
> >  [Mon Feb 04 17:40:10 2008] [notice]  AP_MPMQ_MAX_THREADS         -> 25
> [#
> > of threads/child by config]
> > [Mon Feb 04 17:40:10 2008] [notice]  AP_MPMQ_MIN_SPARE_DAEMONS   -> 0
> [Min #
> > of spare daemons]
> > [Mon Feb 04 17:40:10 2008] [notice]  AP_MPMQ_MIN_SPARE_THREADS   -> 25
> [Min
> > # of spare threads]
> >  [Mon Feb 04 17:40:10 2008] [notice]  AP_MPMQ_MAX_SPARE_DAEMONS   -> 0
> [Max
> > # of spare daemons]
> > [Mon Feb 04 17:40:10 2008] [notice]  AP_MPMQ_MAX_SPARE_THREADS   -> 75
> [Max
> > # of spare threads]
> > [Mon Feb 04 17:40:10 2008] [notice]  AP_MPMQ_MAX_REQUESTS_DAEMON -> 10
> [Max
> > # of requests per daemon]
> >  [Mon Feb 04 17:40:10 2008] [notice]  AP_MPMQ_MAX_DAEMONS         -> 6
> [Max
> > # of daemons by config]
> >
> >
> >
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> >
>



-- 
http://www.tomwells.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20080205/ea7cee6d/attachment-0001.html
From linux at qbox.es  Tue Feb  5 11:22:04 2008
From: linux at qbox.es (=?ISO-8859-1?Q?S=2ER=2EPard=E1?=)
Date: Tue Feb  5 11:22:11 2008
Subject: [mod_python] Physical paths ?
In-Reply-To: <88e286470802050220q31382c0cocf83599fbe4748a7@mail.gmail.com>
References: <1201863943.5934.35.camel@ThorUx>
	<88e286470802011336p3a5e201bwfc9f6007b7614e45@mail.gmail.com>
	<1201947998.7084.72.camel@ThorUx>
	<88e286470802021304u74f0f11aq52a8369d69530a36@mail.gmail.com>
	<88e286470802050220q31382c0cocf83599fbe4748a7@mail.gmail.com>
Message-ID: <1202228524.6991.11.camel@ThorUx>


El mar, 05-02-2008 a las 21:20 +1100, Graham Dumpleton escribi?:
> Sorry for the delay.
> 

Not at all.

> Since you are using .psp files, then you must be using AddHandler. As
> a result the following should work to give you the name of the
> directory corresponding to the Directory container in Apache
> configuration, or .htaccess file, that you defined PythonHandler in.
> 
>         root = req.hlist.directory
>         parent = req.hlist.parent
>         while parent is not None:
>             root = parent.directory
>             parent = parent.parent
> 


Thank you, 

That's a good answer to the question of the Pyshical Root Path of an
Application, because my app is an Apache Directory.

In my case, parent is None. Because not stacked handlers ?isn't it?.
So req.hlist.directory has the root. 
But I understand I should use the complete code.

Thank You Again.



> In other words, if in main Apache configuration you have:
> 
>   Alias /MyApp/ /home/user/MyApp/
> 
>   <Directory /home/user/MyApp>
>   AddHandler mod_python .psp
>   PythonHandler mod_python.psp | .psp
>   ...
>   </Directory>
> 
> The 'root' should end up being '/home/user/MyApp'.
> 
> This only works where PythonHandler in a Directory container or .htaccess file.
> 
> You must be using mod_python 3.3.1.
> 
> Graham
> 
> On 03/02/2008, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > Please keep your replies on the list.
> >
> > FYI. That code was setting req.application_root so you could use it as
> > a reference, not trying to use it.
> >
> > Do:
> >
> >   PythonHandler somemodulenameinrootofpspfilesdirectory .psp
> >   PythonHandler mod_python.psp .psp
> >
> > In somemodulenameinrootofpspfilesdirectory.py have:
> >
> >   import os
> >
> >   def handler(req):
> >     req.application_root = os.path,dirname(__file__)
> >     return apache.OK
> >
> > Read the documentation about stacked mod_python handlers to see how this works.
> >
> > Have no time to read all this new mail now, maybe someone else will help.
> >
> > Graham
> >
> > ---------- Forwarded message ----------
> > From: S.R.Pard? <linux@qbox.es>
> > Date: 2 Feb 2008 21:26
> > Subject: Re: [mod_python] Physical paths ?
> > To: Graham Dumpleton <graham.dumpleton@gmail.com>
> >
> >
> > Thank You.
> >
> > I'm using: PythonHandler mod_python.psp and req.application_root doesn't
> > exist.
> > But __file__ is '/usr/lib/python2.5/site-packages/mod_python/psp.pyc' in
> > the psp page, so it doen't seem related to the root of my app pages
> > where I wnt to save.
> >
> >
> >
> > Anyway, I will try to explain it better, so it can help any other person
> > in the future looking for info like this.
> >
> > Basically, I want the mod_python psp application, allow content upload
> > from the user client:
> >
> > That's done in:         http://SERVER/MyApp/config/upload.psp
> > (and that page is in /home/user/MyApp/config/index.psp)
> >
> > And I want to save the user file to a directory accesible later at:
> >         http://SERVER/MyApp/images/users/USER_FILE
> > (that page would be in /home/user/MyApp/images/users)
> >
> > So the upload.psp save the file received from form at that images
> > directory (instead of the form directory).
> >
> >
> >
> > I wanted that the code from upload psp will pass a relative path from
> > the root of the App (/MyApp) to the module that saves the file, that is
> > something like:
> >         save_file(USER_FILE,"images/users/", req)
> >
> > I needed the save_file to obtain the physical path to the URL:
> >         '//SERVER' + '/MyApp/' + 'images/users/'
> >         (server + application_root + destiny_folder)
> > that is, the physical path to save the file:
> >         '/home/user/MyApp/config/index.psp'
> >
> > Of course, I didn't wanted the function to use a constant to the root of
> > the application '/home/user/MyApp' (at code time) to allow to the
> > application to be independent from the installation directory.
> >
> >
> >
> > I know req.filename give me the physical path to
> > http://SERVER/MyApp/config/upload.psp
> > that is:
> > /home/user/MyApp/config/upload.psp
> >
> > so I could save to '/home/user/MyApp/config/' without problem. And the
> > same in some subdirectory like '/home/user/MyApp/config/images/users/'.
> > I know.
> >
> > But, I had an images directory in '/home/user/MyApp/images/', and maybe
> > I like the things in the hard way. And decide to save to that directory
> > of images (don't ask me why).
> > I know that ... application root is at '..' relative to the physical
> > directory of the page ('/home/user/MyApp/config/').
> > But I really like the things in the hard way and I wanted the save
> > function to be usable from any other pages in other directories, and I
> > don't wanted to send a constant relative path to the app root (remember
> > '/home/user/MyApp/') from every page to the save function (because, I
> > want app to be independent of the installation directory, and I don't
> > want to worry about the constant relative paths if I move the pages).
> >
> >
> > So, the code I'm using now, take the physical path of the page, and the
> > uri of the page , and the application root (uri), to obtain the physical
> > path of the application.
> > And from that , I can take the pyshical path of any subdirectory
> > relative to root (only if no subdirectory with alias are involved, of
> > course).
> >
> > ######
> > def physicalAppRoot(req):
> >
> >   rootApp = req.get_options()['mod_python.session.application_path']
> >   pageDir, pageName = os.path.split(req.parsed_uri[6])
> >
> >   if pageDir.startswith(rootApp):
> >      appPageDir = pageDir[len(rootApp):]
> >   else:
> >      appPageDir = pageDir
> >
> >   physPath = os.path.dirname(req.filename)
> >
> >   i = physPath.rfind(appPageDir)
> >   physAppRoot = physPath[:i]+os.path.sep
> >
> >   return physAppRoot
> > ######
> >
> >
> > The application path is an apache's directory alias, so option
> > application_path is indicated in the config (like you said me Graham, to
> > set different paths for cookies from various applications, and that
> > worked great for me).
> >
> >
> >
> > That's work for me but, really all I wanted was some function like:
> >
> >         physicalPath(uri = 'images/users/')
> > or
> >         physicalPath(uri = '/MyApp/images/users/')
> >
> > that give me:  '/home/user/MyApp/images/users/'
> > for an apache mod_python application installed in /home/user/MyApp,
> > accessible at 'http://server/MyApp' (because an alias would be set at
> > apache 'alias /MyApp/ "/home/user/MyApp"').
> >
> >
> >
> > Sorry, if I can explain it better. Maybe I'm doing a silly thing,
> > because an apache function available at mod_python does exctly this, but
> > I didn't found it.
> >
> >
> >
> > Thank You,
> >
> >
> >         S.R.Pard?
> >
> >
> >
> > El s?b, 02-02-2008 a las 08:36 +1100, Graham Dumpleton escribi?:
> > > I think I only partly understand what you want. Anyway, work out what
> > > the following would do if done in your mod_python handler.
> > >
> > >   import os
> > >   req.application_root = os.path.dirname(__file__)
> > >
> > > Graham
> > >
> > > On 01/02/2008, S.R.Pard? <linux@qbox.es> wrote:
> > > > Hi,
> > > >
> > > > Now, thank you to your help,  my applicattion is capable of receive
> > > > image files from users using forms.
> > > > And app store them into a physical path of the server.
> > > >
> > > >
> > > > It's possible to save from the app to an uri folder ?
> > > >
> > > > Can I know the physical path of one uri ?
> > > >
> > > >
> > > > I can save easily to a subfolder of the pyhsical path obtained by
> > > > req.filename relative to the page visited, and that can work without
> > > > problem.
> > > >
> > > >
> > > > But I would like the module (the module that implements the form
> > > > proccesing) receive the relative route relative to the root of the
> > > > application path, so module will not need to know the physical structure
> > > > of directories, and can save to a route not descendent of the directory
> > > > of my own page.
> > > >
> > > > ... And in my app, the root of the app is a directory alias. outside of
> > > > the apache document_root '/var/www'
> > > >
> > > >
> > > > That's it
> > > >
> > > >         DocumentRoot    /             /var/www
> > > >
> > > >         Alias           MyApp         /home/user/MyApp/
> > > >
> > > >         /MyApp/index.psp   .......... /home/user/MyApp/index.psp
> > > >
> > > >         /MyApp/config/upload.psp  ... /home/user/MyApp/config/index.psp
> > > >
> > > >         /MyApp/images/  ............. /home/user/MyApp/images/
> > > >         /MyApp/images/users/    ..... /home/user/MyApp/images/users/
> > > >
> > > >
> > > > And I want to obtain from code executed in
> > > >
> > > >         http:/MyApp/config/upload.psp
> > > >
> > > > the physical path of root of the application:
> > > >
> > > >
> > > >
> > > > so I can't sent to a function in form.py:
> > > >
> > > >         app_root = ???    # function that returns '/home/user/MyApp/'
> > > >         imgs_folder = 'images/users/'
> > > >
> > > >         process(form, directory_to_save = app_root+imgs_folder)
> > > >
> > > >
> > > > So, the code is independent of the installation directory and the app
> > > > path.
> > > >
> > > > Another thing ... if images would be an alias, ? could I know the path ?
> > > >
> > > >
> > > >
> > > >
> > > > Thank You again.
> > > >
> > > >         S.R.Parda
> > > >
> > > > _______________________________________________
> > > > Mod_python mailing list
> > > > Mod_python@modpython.org
> > > > http://mailman.modpython.org/mailman/listinfo/mod_python
> > > >
> >

From graham.dumpleton at gmail.com  Tue Feb  5 15:00:01 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Feb  5 15:00:10 2008
Subject: [mod_python] Physical paths ?
In-Reply-To: <1202228524.6991.11.camel@ThorUx>
References: <1201863943.5934.35.camel@ThorUx>
	<88e286470802011336p3a5e201bwfc9f6007b7614e45@mail.gmail.com>
	<1201947998.7084.72.camel@ThorUx>
	<88e286470802021304u74f0f11aq52a8369d69530a36@mail.gmail.com>
	<88e286470802050220q31382c0cocf83599fbe4748a7@mail.gmail.com>
	<1202228524.6991.11.camel@ThorUx>
Message-ID: <88e286470802051200u7aad9063n6fe3b3b90bbfcba7@mail.gmail.com>

On 06/02/2008, S.R.Pard? <linux@qbox.es> wrote:
>
> El mar, 05-02-2008 a las 21:20 +1100, Graham Dumpleton escribi?:
> > Sorry for the delay.
> >
>
> Not at all.
>
> > Since you are using .psp files, then you must be using AddHandler. As
> > a result the following should work to give you the name of the
> > directory corresponding to the Directory container in Apache
> > configuration, or .htaccess file, that you defined PythonHandler in.
> >
> >         root = req.hlist.directory
> >         parent = req.hlist.parent
> >         while parent is not None:
> >             root = parent.directory
> >             parent = parent.parent
> >
>
>
> Thank you,
>
> That's a good answer to the question of the Pyshical Root Path of an
> Application, because my app is an Apache Directory.
>
> In my case, parent is None. Because not stacked handlers ?isn't it?.
> So req.hlist.directory has the root.
> But I understand I should use the complete code.

Not stacked handlers, but handlers added with req.add_handler().

BTW, you can probably also just use:

  apache.get_handler_root()

It works of a cached copy of that calculation from memory.

Graham

> > In other words, if in main Apache configuration you have:
> >
> >   Alias /MyApp/ /home/user/MyApp/
> >
> >   <Directory /home/user/MyApp>
> >   AddHandler mod_python .psp
> >   PythonHandler mod_python.psp | .psp
> >   ...
> >   </Directory>
> >
> > The 'root' should end up being '/home/user/MyApp'.
> >
> > This only works where PythonHandler in a Directory container or .htaccess file.
> >
> > You must be using mod_python 3.3.1.
> >
> > Graham
> >
> > On 03/02/2008, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > > Please keep your replies on the list.
> > >
> > > FYI. That code was setting req.application_root so you could use it as
> > > a reference, not trying to use it.
> > >
> > > Do:
> > >
> > >   PythonHandler somemodulenameinrootofpspfilesdirectory .psp
> > >   PythonHandler mod_python.psp .psp
> > >
> > > In somemodulenameinrootofpspfilesdirectory.py have:
> > >
> > >   import os
> > >
> > >   def handler(req):
> > >     req.application_root = os.path,dirname(__file__)
> > >     return apache.OK
> > >
> > > Read the documentation about stacked mod_python handlers to see how this works.
> > >
> > > Have no time to read all this new mail now, maybe someone else will help.
> > >
> > > Graham
> > >
> > > ---------- Forwarded message ----------
> > > From: S.R.Pard? <linux@qbox.es>
> > > Date: 2 Feb 2008 21:26
> > > Subject: Re: [mod_python] Physical paths ?
> > > To: Graham Dumpleton <graham.dumpleton@gmail.com>
> > >
> > >
> > > Thank You.
> > >
> > > I'm using: PythonHandler mod_python.psp and req.application_root doesn't
> > > exist.
> > > But __file__ is '/usr/lib/python2.5/site-packages/mod_python/psp.pyc' in
> > > the psp page, so it doen't seem related to the root of my app pages
> > > where I wnt to save.
> > >
> > >
> > >
> > > Anyway, I will try to explain it better, so it can help any other person
> > > in the future looking for info like this.
> > >
> > > Basically, I want the mod_python psp application, allow content upload
> > > from the user client:
> > >
> > > That's done in:         http://SERVER/MyApp/config/upload.psp
> > > (and that page is in /home/user/MyApp/config/index.psp)
> > >
> > > And I want to save the user file to a directory accesible later at:
> > >         http://SERVER/MyApp/images/users/USER_FILE
> > > (that page would be in /home/user/MyApp/images/users)
> > >
> > > So the upload.psp save the file received from form at that images
> > > directory (instead of the form directory).
> > >
> > >
> > >
> > > I wanted that the code from upload psp will pass a relative path from
> > > the root of the App (/MyApp) to the module that saves the file, that is
> > > something like:
> > >         save_file(USER_FILE,"images/users/", req)
> > >
> > > I needed the save_file to obtain the physical path to the URL:
> > >         '//SERVER' + '/MyApp/' + 'images/users/'
> > >         (server + application_root + destiny_folder)
> > > that is, the physical path to save the file:
> > >         '/home/user/MyApp/config/index.psp'
> > >
> > > Of course, I didn't wanted the function to use a constant to the root of
> > > the application '/home/user/MyApp' (at code time) to allow to the
> > > application to be independent from the installation directory.
> > >
> > >
> > >
> > > I know req.filename give me the physical path to
> > > http://SERVER/MyApp/config/upload.psp
> > > that is:
> > > /home/user/MyApp/config/upload.psp
> > >
> > > so I could save to '/home/user/MyApp/config/' without problem. And the
> > > same in some subdirectory like '/home/user/MyApp/config/images/users/'.
> > > I know.
> > >
> > > But, I had an images directory in '/home/user/MyApp/images/', and maybe
> > > I like the things in the hard way. And decide to save to that directory
> > > of images (don't ask me why).
> > > I know that ... application root is at '..' relative to the physical
> > > directory of the page ('/home/user/MyApp/config/').
> > > But I really like the things in the hard way and I wanted the save
> > > function to be usable from any other pages in other directories, and I
> > > don't wanted to send a constant relative path to the app root (remember
> > > '/home/user/MyApp/') from every page to the save function (because, I
> > > want app to be independent of the installation directory, and I don't
> > > want to worry about the constant relative paths if I move the pages).
> > >
> > >
> > > So, the code I'm using now, take the physical path of the page, and the
> > > uri of the page , and the application root (uri), to obtain the physical
> > > path of the application.
> > > And from that , I can take the pyshical path of any subdirectory
> > > relative to root (only if no subdirectory with alias are involved, of
> > > course).
> > >
> > > ######
> > > def physicalAppRoot(req):
> > >
> > >   rootApp = req.get_options()['mod_python.session.application_path']
> > >   pageDir, pageName = os.path.split(req.parsed_uri[6])
> > >
> > >   if pageDir.startswith(rootApp):
> > >      appPageDir = pageDir[len(rootApp):]
> > >   else:
> > >      appPageDir = pageDir
> > >
> > >   physPath = os.path.dirname(req.filename)
> > >
> > >   i = physPath.rfind(appPageDir)
> > >   physAppRoot = physPath[:i]+os.path.sep
> > >
> > >   return physAppRoot
> > > ######
> > >
> > >
> > > The application path is an apache's directory alias, so option
> > > application_path is indicated in the config (like you said me Graham, to
> > > set different paths for cookies from various applications, and that
> > > worked great for me).
> > >
> > >
> > >
> > > That's work for me but, really all I wanted was some function like:
> > >
> > >         physicalPath(uri = 'images/users/')
> > > or
> > >         physicalPath(uri = '/MyApp/images/users/')
> > >
> > > that give me:  '/home/user/MyApp/images/users/'
> > > for an apache mod_python application installed in /home/user/MyApp,
> > > accessible at 'http://server/MyApp' (because an alias would be set at
> > > apache 'alias /MyApp/ "/home/user/MyApp"').
> > >
> > >
> > >
> > > Sorry, if I can explain it better. Maybe I'm doing a silly thing,
> > > because an apache function available at mod_python does exctly this, but
> > > I didn't found it.
> > >
> > >
> > >
> > > Thank You,
> > >
> > >
> > >         S.R.Pard?
> > >
> > >
> > >
> > > El s?b, 02-02-2008 a las 08:36 +1100, Graham Dumpleton escribi?:
> > > > I think I only partly understand what you want. Anyway, work out what
> > > > the following would do if done in your mod_python handler.
> > > >
> > > >   import os
> > > >   req.application_root = os.path.dirname(__file__)
> > > >
> > > > Graham
> > > >
> > > > On 01/02/2008, S.R.Pard? <linux@qbox.es> wrote:
> > > > > Hi,
> > > > >
> > > > > Now, thank you to your help,  my applicattion is capable of receive
> > > > > image files from users using forms.
> > > > > And app store them into a physical path of the server.
> > > > >
> > > > >
> > > > > It's possible to save from the app to an uri folder ?
> > > > >
> > > > > Can I know the physical path of one uri ?
> > > > >
> > > > >
> > > > > I can save easily to a subfolder of the pyhsical path obtained by
> > > > > req.filename relative to the page visited, and that can work without
> > > > > problem.
> > > > >
> > > > >
> > > > > But I would like the module (the module that implements the form
> > > > > proccesing) receive the relative route relative to the root of the
> > > > > application path, so module will not need to know the physical structure
> > > > > of directories, and can save to a route not descendent of the directory
> > > > > of my own page.
> > > > >
> > > > > ... And in my app, the root of the app is a directory alias. outside of
> > > > > the apache document_root '/var/www'
> > > > >
> > > > >
> > > > > That's it
> > > > >
> > > > >         DocumentRoot    /             /var/www
> > > > >
> > > > >         Alias           MyApp         /home/user/MyApp/
> > > > >
> > > > >         /MyApp/index.psp   .......... /home/user/MyApp/index.psp
> > > > >
> > > > >         /MyApp/config/upload.psp  ... /home/user/MyApp/config/index.psp
> > > > >
> > > > >         /MyApp/images/  ............. /home/user/MyApp/images/
> > > > >         /MyApp/images/users/    ..... /home/user/MyApp/images/users/
> > > > >
> > > > >
> > > > > And I want to obtain from code executed in
> > > > >
> > > > >         http:/MyApp/config/upload.psp
> > > > >
> > > > > the physical path of root of the application:
> > > > >
> > > > >
> > > > >
> > > > > so I can't sent to a function in form.py:
> > > > >
> > > > >         app_root = ???    # function that returns '/home/user/MyApp/'
> > > > >         imgs_folder = 'images/users/'
> > > > >
> > > > >         process(form, directory_to_save = app_root+imgs_folder)
> > > > >
> > > > >
> > > > > So, the code is independent of the installation directory and the app
> > > > > path.
> > > > >
> > > > > Another thing ... if images would be an alias, ? could I know the path ?
> > > > >
> > > > >
> > > > >
> > > > >
> > > > > Thank You again.
> > > > >
> > > > >         S.R.Parda
> > > > >
> > > > > _______________________________________________
> > > > > Mod_python mailing list
> > > > > Mod_python@modpython.org
> > > > > http://mailman.modpython.org/mailman/listinfo/mod_python
> > > > >
> > >
>
>

From graham.dumpleton at gmail.com  Tue Feb  5 17:35:25 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Feb  5 17:35:31 2008
Subject: [mod_python] Execute python code while having generated page
	content already sent to browser - possible ?
In-Reply-To: <200802051209.03447.mateusz@ant.gliwice.pl>
References: <200802051209.03447.mateusz@ant.gliwice.pl>
Message-ID: <88e286470802051435o71a12578m9225f62d95edb05c@mail.gmail.com>

On 05/02/2008, Mateusz Korniak <mateusz@ant.gliwice.pl> wrote:
> Hi !
> Is there any way to continue execute python code while having generated page
> content already sent to browser ?
>
> What I would like to implement is:
>
> content = generate_page_content() # It takes 0.02[s]
> sent_to_browser(content) # We are not going to send anything more to browser
> lazy_processing_of_request() # May take serveral seconds.
>
> I do not want make browser to wait util lazy_processing_of_request() finishes
> to start receiving page contents.
>
> Is it possible ?

You can use:

    req.status = apache.HTTP_OK
    req.content_type = "..."
    ....
    req.write("....")

    # do processing

    return apache.OK

The problem with doing this is that although the browser gets the
response and can display it while you do your processing, Apache will
not close the socket connection or be able to reuse it if keep alive
is enabled, until the processing is complete. This could result in
Apache holding lots of connections open longer than it needs to.

Other option is to create a background thread to do the processing, so
long as you give it data which is independent of the request object.
In other words, if you try and access the request object after having
returned from the request, Apache will most likely crash. This is
because mod_python doesn't adequate protect against this happening.
Problem with threads is controlling how many there are, as such you
might need to implement a thread pool and job queuing systems for
processing data so the number of threads doesn't blow out in number.

What is probably the preferred way, is to run a long running back end
process and communicate to it using XML-RPC, passing any data across
which can then be processed by that back end process. Once the handler
has handed off the data, it can just return immediately. Using a back
end process also has the benefit that when Apache is running as a
multiple process server, then subsequent requests could ask about the
status of something by supplying some unique value returned by the
original request. To do this though, the back end process would have
to have some concurrency mechanism to allow processing in parallel
with incoming requests to get status etc.

Graham
From denes1951 at yahoo.ca  Tue Feb  5 17:34:43 2008
From: denes1951 at yahoo.ca (Denes L)
Date: Tue Feb  5 17:37:58 2008
Subject: [mod_python] compile mod_python on iSeries (AS/400)
Message-ID: <481973.42695.qm@web45101.mail.sp1.yahoo.com>

> Graham Dumpleton wrote:
>
> Are you truly trying to get mod_python running so you can use
> mod_python features, or do you simply want a way of running Python web
> applications under Apache and don't care about what the Python web
> server API is?

Currently I am able to use CGI (thru a program of my own) but that spawns a new Python interpreter process every time, resulting in slow response time and high resource use, a well known fact. PSP sounds very interesting, something to try and decide on. The Apache API might come in handy but is not a concern now. So in general mod_python seems to be an excellent alternative to improve on what I have.

Any suggestions are welcome.

Thanks, Denes.

       
---------------------------------
Ask a question on any topic and get answers from real people. Go to Yahoo! Answers. 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20080205/5823f3f2/attachment.html
From graham.dumpleton at gmail.com  Tue Feb  5 17:46:47 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Feb  5 17:46:54 2008
Subject: [mod_python] compile mod_python on iSeries (AS/400)
In-Reply-To: <481973.42695.qm@web45101.mail.sp1.yahoo.com>
References: <481973.42695.qm@web45101.mail.sp1.yahoo.com>
Message-ID: <88e286470802051446m7d0f2e02n43d85be666c51d43@mail.gmail.com>

On 06/02/2008, Denes L <denes1951@yahoo.ca> wrote:
> > Graham Dumpleton wrote:
> >
> > Are you truly trying to get mod_python running so you can use
> > mod_python features, or do you simply want a way of running Python web
> > applications under Apache and don't care about what the Python web
> > server API is?
>
> Currently I am able to use CGI (thru a program of my own) but that spawns a
> new Python interpreter process every time, resulting in slow response time
> and high resource use, a well known fact. PSP sounds very interesting,
> something to try and decide on. The Apache API might come in handy but is
> not a concern now. So in general mod_python seems to be an excellent
> alternative to improve on what I have.
>
> Any suggestions are welcome.

If using CGI now, personally I would suggest you convert your Python
CGI application to WSGI interface (www.wsgi.org) instead. Not only
will this give you a range of deployment options from CGI, mod_python,
mod_wsgi, FASTCGI, CGI, AJP and standalone Python web servers such as
contained in Paste, for Apache hosting you may find mod_wsgi
(www.modwsgi.org) easier to build given that it is all in one file and
doesn't have separate Python code components like mod_python does.

Graham
From denes1951 at yahoo.ca  Tue Feb  5 18:02:34 2008
From: denes1951 at yahoo.ca (Denes L)
Date: Tue Feb  5 18:02:41 2008
Subject: [mod_python] compile mod_python on iSeries (AS/400)
Message-ID: <304713.5187.qm@web45116.mail.sp1.yahoo.com>

> If using CGI now, personally I would suggest you convert your Python
> CGI application to WSGI interface (www.wsgi.org) instead. 

Funny that you mention mod_wsgi since I have been looking into that too, but the problem is that it requires Python to have been compiled with support for threading, which seems to be unavailable on the iseries port:
"import thread" fails with "ImportError: No module named thread"

Denes.

       
---------------------------------
Looking for the perfect gift? Give the gift of Flickr!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20080205/5950b03b/attachment-0001.html
From graham.dumpleton at gmail.com  Tue Feb  5 18:27:58 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Feb  5 18:28:05 2008
Subject: [mod_python] compile mod_python on iSeries (AS/400)
In-Reply-To: <304713.5187.qm@web45116.mail.sp1.yahoo.com>
References: <304713.5187.qm@web45116.mail.sp1.yahoo.com>
Message-ID: <88e286470802051527q13ff3450taff10ed8467afb70@mail.gmail.com>

On 06/02/2008, Denes L <denes1951@yahoo.ca> wrote:
> > If using CGI now, personally I would suggest you convert your Python
> > CGI application to WSGI interface (www.wsgi.org) instead.
>
> Funny that you mention mod_wsgi since I have been looking into that too, but
> the problem is that it requires Python to have been compiled with support
> for threading, which seems to be unavailable on the iseries port:
> "import thread" fails with "ImportError: No module named thread"

Technically speaking, if wanting only embedded mode of mod_wsgi under
a prefork Apache, the code could have been made to be compilable
without threading support in Python, but maintaining it would have
been a pain and not worth it given that would be quite rare that non
threaded Python would be used. As such didn't support that
configuration and reluctant to do so.

Also be aware that although mod_python may be able to be compiled
against non threaded Python, it may not actually work. This is because
that code path wouldn't have actually been compile tested or run
tested for quite a long time. Thus if it works in the end, probably
more luck than anything else.

Anyway, if your Python doesn't even have threads, you probably can't
even use Paste web server if you did port to WSGI. It may be that CGI
is your only practical option.

Graham
From denes1951 at yahoo.ca  Wed Feb  6 18:09:17 2008
From: denes1951 at yahoo.ca (Denes L)
Date: Wed Feb  6 18:09:26 2008
Subject: [mod_python] compile mod_python on iSeries (AS/400)
Message-ID: <382395.50676.qm@web45110.mail.sp1.yahoo.com>

I will continue trying to get mod_python to work, but I consider myself warned that it might not work.

So... the compile of _apachemodule.c fails on line 665:

665    ci->interpreter = strdup(interpreter);
CZM0304  No function prototype given for 'strdup'. 

Is that supposed to say apr_pstrdup ?

Thanks,
Denes.

       
---------------------------------
Looking for the perfect gift? Give the gift of Flickr!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20080206/86230ec7/attachment.html
From graham.dumpleton at gmail.com  Fri Feb  8 23:14:02 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Fri Feb  8 23:14:10 2008
Subject: [mod_python] compile mod_python on iSeries (AS/400)
In-Reply-To: <382395.50676.qm@web45110.mail.sp1.yahoo.com>
References: <382395.50676.qm@web45110.mail.sp1.yahoo.com>
Message-ID: <88e286470802082014t821bd11w3912a001e82a28fd@mail.gmail.com>

On 07/02/2008, Denes L <denes1951@yahoo.ca> wrote:
> I will continue trying to get mod_python to work, but I consider myself
> warned that it might not work.
>
> So... the compile of _apachemodule.c fails on line 665:
>
> 665    ci->interpreter = strdup(interpreter);
> CZM0304  No function prototype given for 'strdup'.
>
> Is that supposed to say apr_pstrdup ?

No, can't use apr_pstrdup() as no pool of adequate scope available at
that point in code.

Change:

    ci->interpreter = strdup(interpreter);

to:

    ci->interpreter = (char *)malloc(strlen(interpreter)+1));
    strcpy(ci->interpreter, interpreter);

Does the same thing.

Graham
From atc at centroin.com.br  Sun Feb 10 10:27:21 2008
From: atc at centroin.com.br (Alexandre Taschetto de Castro)
Date: Sun Feb 10 10:27:09 2008
Subject: [mod_python] apache cannot find mod_python files
Message-ID: <20080210152041.M91017@centroin.com.br>

Hello,

I have the following problem. Apache loads mod_python module correctly:

[Thu Jan 31 15:48:20 2008] [notice] mod_python: using mutex_directory /tmp 
[Thu Jan 31 15:48:20 2008] [notice] Apache/2.2.4 (Linux/SUSE) mod_ssl/2.2.4
OpenSSL/0.9.8e PHP/5.2.5 with Suhosin-Patch mod_python/3.3.1 Python/2.5.1
configured -- resuming normal operations

but cannot find mod_python files:

[Thu Jan 31 15:48:26 2008] [error] make_obcallback: could not import
mod_python.apache.\n
'import site' failed; use -v for traceback
ImportError: No module named mod_python.apache
[Thu Jan 31 15:48:26 2008] [error] make_obcallback: Python path being used
"['/usr/lib/python25.zip', '/usr/lib64/python2.5/',
'/usr/lib64/python2.5/plat-linux2', '/usr/lib64/python2.5/lib-tk',
'/usr/lib64/python2.5/lib-dynload']".
[Thu Jan 31 15:48:26 2008] [error] get_interpreter: no interpreter callback found.


mod_python is installed in usr/lib64/python2.5/site-packages/mod_python, which
is in python's sys.path and can be read by the apache user (www). How can I
tell apache to include this in the python path it is using? I am using
Opensuse 10.3.

Thanks
Alexandre


From graham.dumpleton at gmail.com  Sun Feb 10 14:56:25 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sun Feb 10 14:56:31 2008
Subject: [mod_python] apache cannot find mod_python files
In-Reply-To: <20080210152041.M91017@centroin.com.br>
References: <20080210152041.M91017@centroin.com.br>
Message-ID: <88e286470802101156i744eb504n29c79056c4a9075d@mail.gmail.com>

Finding mod_python files is not the problem. What it can't find is the
'site' module, ie., 'site.py'.

How many different versions of Python do you have on your box? Where
are they located? What is your personal PATH environment variable set
to? How are you stopping and starting Apache? Are you using 'sudo', if
so, using exactly what command line are you using? Have you tried
using 'sudo -H' instead?

Graham

On 11/02/2008, Alexandre Taschetto de Castro <atc@centroin.com.br> wrote:
> Hello,
>
> I have the following problem. Apache loads mod_python module correctly:
>
> [Thu Jan 31 15:48:20 2008] [notice] mod_python: using mutex_directory /tmp
> [Thu Jan 31 15:48:20 2008] [notice] Apache/2.2.4 (Linux/SUSE) mod_ssl/2.2.4
> OpenSSL/0.9.8e PHP/5.2.5 with Suhosin-Patch mod_python/3.3.1 Python/2.5.1
> configured -- resuming normal operations
>
> but cannot find mod_python files:
>
> [Thu Jan 31 15:48:26 2008] [error] make_obcallback: could not import
> mod_python.apache.\n
> 'import site' failed; use -v for traceback
> ImportError: No module named mod_python.apache
> [Thu Jan 31 15:48:26 2008] [error] make_obcallback: Python path being used
> "['/usr/lib/python25.zip', '/usr/lib64/python2.5/',
> '/usr/lib64/python2.5/plat-linux2', '/usr/lib64/python2.5/lib-tk',
> '/usr/lib64/python2.5/lib-dynload']".
> [Thu Jan 31 15:48:26 2008] [error] get_interpreter: no interpreter callback found.
>
>
> mod_python is installed in usr/lib64/python2.5/site-packages/mod_python, which
> is in python's sys.path and can be read by the apache user (www). How can I
> tell apache to include this in the python path it is using? I am using
> Opensuse 10.3.
>
> Thanks
> Alexandre
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From geert at nznl.com  Sun Feb 10 15:52:07 2008
From: geert at nznl.com (Geert Dekkers)
Date: Sun Feb 10 15:52:13 2008
Subject: [mod_python] macosx 10.5 - can't find mod_python.so - why?
Message-ID: <40F512A8-2505-4CFD-B34F-6BBEE89B102B@nznl.com>

Hi all

I'm on macosx leopard (10.5.1), trying to install mod_python. After  
the executing the tweaks for leopard, It seems as if everything makes  
&& make installs ok, but there's no mod_python.so in /usr/libexec,  
where other modules live. Does anyone have similar experiences?

Geert


From graham.dumpleton at gmail.com  Sun Feb 10 16:44:15 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sun Feb 10 16:44:28 2008
Subject: [mod_python] macosx 10.5 - can't find mod_python.so - why?
In-Reply-To: <40F512A8-2505-4CFD-B34F-6BBEE89B102B@nznl.com>
References: <40F512A8-2505-4CFD-B34F-6BBEE89B102B@nznl.com>
Message-ID: <88e286470802101344m52c67f0vd61c279dbaa030fc@mail.gmail.com>

On 11/02/2008, Geert Dekkers <geert@nznl.com> wrote:
> Hi all
>
> I'm on macosx leopard (10.5.1), trying to install mod_python. After
> the executing the tweaks for leopard, It seems as if everything makes
> && make installs ok, but there's no mod_python.so in /usr/libexec,
> where other modules live. Does anyone have similar experiences?

What was the output when you ran 'sudo make install'?

Graham
From graham.dumpleton at gmail.com  Sun Feb 10 17:00:12 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sun Feb 10 17:00:20 2008
Subject: [mod_python] macosx 10.5 - can't find mod_python.so - why?
In-Reply-To: <9CBDDD5C-BCA8-4F58-976D-1E7D934D4877@nznl.com>
References: <40F512A8-2505-4CFD-B34F-6BBEE89B102B@nznl.com>
	<88e286470802101344m52c67f0vd61c279dbaa030fc@mail.gmail.com>
	<9CBDDD5C-BCA8-4F58-976D-1E7D934D4877@nznl.com>
Message-ID: <88e286470802101400s15279f45i5cfbedc25db6fc8f@mail.gmail.com>

Please use reply-all and keep follow ups on the list.

See comment below.

On 11/02/2008, Geert Dekkers <geert@nznl.com> wrote:
> Hi Graham,
>
> Thanks for responding so quickly.
>
> The ouput of the sudo make install:
>
> geert-dekkers-computer:mod_python-3.3.1 geert$ sudo make install
> Password:
> make[3]: `psp_parser.c' is up to date.
> /System/Library/Frameworks/Python.framework/Versions/Current/bin/
> python setup.py build
> running build
> running build_py
> running build_ext
>
> Now su and make install
>    (or, if you only want to perform a partial install,
>     you can use make install_dso and make install_py_lib)
>
>
> Performing DSO installation.
>
> /users/geert/Applications/PhpDocumentor-1.4.0/PhpDocumentor-1.4.0/
> install -c -d /usr/libexec/apache2
> make[1]: execvp: /users/geert/Applications/PhpDocumentor-1.4.0/
> PhpDocumentor-1.4.0/install: Permission denied

And this is obviously your problem.

Change your user PATH such that that PHP stuff is last and not before
'/usr/bin'.

There is obviously a file called 'install' in that directory in your
path and it is getting in the way of /usr/bin/install being used as it
should.

Graham

> make[1]: *** [install_dso] Error 127
> cd dist && make install_py_lib
> make[3]: `psp_parser.c' is up to date.
> if test -z "" ; then \
>                 /System/Library/Frameworks/Python.framework/Versions/Current/bin/
> python setup.py install --optimize 2 --force ; \
>         else \
>                 /System/Library/Frameworks/Python.framework/Versions/Current/bin/
> python setup.py install --optimize 2 --force --root  ; \
>         fi
> running install
> running build
> running build_py
> running build_ext
> running install_lib
> copying build/lib.macosx-10.5-i386-2.5/mod_python/__init__.py -> /
> Library/Python/2.5/site-packages/mod_python
> copying build/lib.macosx-10.5-i386-2.5/mod_python/_psp.so -> /Library/
> Python/2.5/site-packages/mod_python
> copying build/lib.macosx-10.5-i386-2.5/mod_python/apache.py -> /
> Library/Python/2.5/site-packages/mod_python
> copying build/lib.macosx-10.5-i386-2.5/mod_python/cache.py -> /Library/
> Python/2.5/site-packages/mod_python
> copying build/lib.macosx-10.5-i386-2.5/mod_python/cgihandler.py -> /
> Library/Python/2.5/site-packages/mod_python
> copying build/lib.macosx-10.5-i386-2.5/mod_python/Cookie.py -> /
> Library/Python/2.5/site-packages/mod_python
> copying build/lib.macosx-10.5-i386-2.5/mod_python/importer.py -> /
> Library/Python/2.5/site-packages/mod_python
> copying build/lib.macosx-10.5-i386-2.5/mod_python/psp.py -> /Library/
> Python/2.5/site-packages/mod_python
> copying build/lib.macosx-10.5-i386-2.5/mod_python/publisher.py -> /
> Library/Python/2.5/site-packages/mod_python
> copying build/lib.macosx-10.5-i386-2.5/mod_python/python22.py -> /
> Library/Python/2.5/site-packages/mod_python
> copying build/lib.macosx-10.5-i386-2.5/mod_python/Session.py -> /
> Library/Python/2.5/site-packages/mod_python
> copying build/lib.macosx-10.5-i386-2.5/mod_python/testhandler.py -> /
> Library/Python/2.5/site-packages/mod_python
> copying build/lib.macosx-10.5-i386-2.5/mod_python/util.py -> /Library/
> Python/2.5/site-packages/mod_python
> byte-compiling /Library/Python/2.5/site-packages/mod_python/
> __init__.py to __init__.pyc
> byte-compiling /Library/Python/2.5/site-packages/mod_python/apache.py
> to apache.pyc
> byte-compiling /Library/Python/2.5/site-packages/mod_python/cache.py
> to cache.pyc
> byte-compiling /Library/Python/2.5/site-packages/mod_python/
> cgihandler.py to cgihandler.pyc
> byte-compiling /Library/Python/2.5/site-packages/mod_python/Cookie.py
> to Cookie.pyc
> byte-compiling /Library/Python/2.5/site-packages/mod_python/
> importer.py to importer.pyc
> byte-compiling /Library/Python/2.5/site-packages/mod_python/psp.py to
> psp.pyc
> byte-compiling /Library/Python/2.5/site-packages/mod_python/
> publisher.py to publisher.pyc
> byte-compiling /Library/Python/2.5/site-packages/mod_python/
> python22.py to python22.pyc
> byte-compiling /Library/Python/2.5/site-packages/mod_python/Session.py
> to Session.pyc
> byte-compiling /Library/Python/2.5/site-packages/mod_python/
> testhandler.py to testhandler.pyc
> byte-compiling /Library/Python/2.5/site-packages/mod_python/util.py to
> util.pyc
> writing byte-compilation script '/tmp/tmpIVf7U7.py'
> /System/Library/Frameworks/Python.framework/Versions/2.5/Resources/
> Python.app/Contents/MacOS/Python -OO /tmp/tmpIVf7U7.py
> removing /tmp/tmpIVf7U7.py
> running install_egg_info
> Removing /Library/Python/2.5/site-packages/mod_python-3.3.1-py2.5.egg-
> info
> Writing /Library/Python/2.5/site-packages/mod_python-3.3.1-py2.5.egg-
> info
>
> On 10/02/2008, at 10:44 PM, Graham Dumpleton wrote:
>
> > On 11/02/2008, Geert Dekkers <geert@nznl.com> wrote:
> >> Hi all
> >>
> >> I'm on macosx leopard (10.5.1), trying to install mod_python. After
> >> the executing the tweaks for leopard, It seems as if everything makes
> >> && make installs ok, but there's no mod_python.so in /usr/libexec,
> >> where other modules live. Does anyone have similar experiences?
> >
> > What was the output when you ran 'sudo make install'?
> >
> > Graham
>
>
From geert at nznl.com  Mon Feb 11 04:10:06 2008
From: geert at nznl.com (Geert Dekkers)
Date: Mon Feb 11 04:10:17 2008
Subject: [mod_python] macosx 10.5 - can't find mod_python.so - why?
In-Reply-To: <88e286470802101400s15279f45i5cfbedc25db6fc8f@mail.gmail.com>
References: <40F512A8-2505-4CFD-B34F-6BBEE89B102B@nznl.com>
	<88e286470802101344m52c67f0vd61c279dbaa030fc@mail.gmail.com>
	<9CBDDD5C-BCA8-4F58-976D-1E7D934D4877@nznl.com>
	<88e286470802101400s15279f45i5cfbedc25db6fc8f@mail.gmail.com>
Message-ID: <71A04A76-E806-4310-BA30-4BEB31ABD3B9@nznl.com>

Hi all :)

Still having problems. Now apache2 complains mod_python.so has the  
wrong architecture. I've implemented the fixes I've found here and  
there (http://groups.google.com/group/django-users/msg/ 
b211ba1193cb6092 - among others).

A question - wouldn't I have apache2 running in 32 bit mode on my  
first-generation (2006) macbook pro. I found this hint http://forums.macosxhints.com/archive/index.php/t-62551.html 
  - tji, on 10-28-2006, 02:04 PM (halfway down the page) , and lo and  
behold, I seem to be running 32-bit:

Size of Data Types on this System:

Char = 1 bytes
Integer = 4 bytes
Long Integer = 4 bytes
Long Long Integer = 8 bytes
Double = 8 bytes
Pointer = 4 bytes


So, what could the problem be? Am I out of the race now?

Geert



On 10/02/2008, at 11:00 PM, Graham Dumpleton wrote:

> Please use reply-all and keep follow ups on the list.
>
> See comment below.
>
> On 11/02/2008, Geert Dekkers <geert@nznl.com> wrote:
>> Hi Graham,
>>
>> Thanks for responding so quickly.
>>
>> The ouput of the sudo make install:
>>
>> geert-dekkers-computer:mod_python-3.3.1 geert$ sudo make install
>> Password:
>> make[3]: `psp_parser.c' is up to date.
>> /System/Library/Frameworks/Python.framework/Versions/Current/bin/
>> python setup.py build
>> running build
>> running build_py
>> running build_ext
>>
>> Now su and make install
>>   (or, if you only want to perform a partial install,
>>    you can use make install_dso and make install_py_lib)
>>
>>
>> Performing DSO installation.
>>
>> /users/geert/Applications/PhpDocumentor-1.4.0/PhpDocumentor-1.4.0/
>> install -c -d /usr/libexec/apache2
>> make[1]: execvp: /users/geert/Applications/PhpDocumentor-1.4.0/
>> PhpDocumentor-1.4.0/install: Permission denied
>
> And this is obviously your problem.
>
> Change your user PATH such that that PHP stuff is last and not before
> '/usr/bin'.
>
> There is obviously a file called 'install' in that directory in your
> path and it is getting in the way of /usr/bin/install being used as it
> should.
>
> Graham
>
>> make[1]: *** [install_dso] Error 127
>> cd dist && make install_py_lib
>> make[3]: `psp_parser.c' is up to date.
>> if test -z "" ; then \
>>                /System/Library/Frameworks/Python.framework/Versions/ 
>> Current/bin/
>> python setup.py install --optimize 2 --force ; \
>>        else \
>>                /System/Library/Frameworks/Python.framework/Versions/ 
>> Current/bin/
>> python setup.py install --optimize 2 --force --root  ; \
>>        fi
>> running install
>> running build
>> running build_py
>> running build_ext
>> running install_lib
>> copying build/lib.macosx-10.5-i386-2.5/mod_python/__init__.py -> /
>> Library/Python/2.5/site-packages/mod_python
>> copying build/lib.macosx-10.5-i386-2.5/mod_python/_psp.so -> / 
>> Library/
>> Python/2.5/site-packages/mod_python
>> copying build/lib.macosx-10.5-i386-2.5/mod_python/apache.py -> /
>> Library/Python/2.5/site-packages/mod_python
>> copying build/lib.macosx-10.5-i386-2.5/mod_python/cache.py -> / 
>> Library/
>> Python/2.5/site-packages/mod_python
>> copying build/lib.macosx-10.5-i386-2.5/mod_python/cgihandler.py -> /
>> Library/Python/2.5/site-packages/mod_python
>> copying build/lib.macosx-10.5-i386-2.5/mod_python/Cookie.py -> /
>> Library/Python/2.5/site-packages/mod_python
>> copying build/lib.macosx-10.5-i386-2.5/mod_python/importer.py -> /
>> Library/Python/2.5/site-packages/mod_python
>> copying build/lib.macosx-10.5-i386-2.5/mod_python/psp.py -> /Library/
>> Python/2.5/site-packages/mod_python
>> copying build/lib.macosx-10.5-i386-2.5/mod_python/publisher.py -> /
>> Library/Python/2.5/site-packages/mod_python
>> copying build/lib.macosx-10.5-i386-2.5/mod_python/python22.py -> /
>> Library/Python/2.5/site-packages/mod_python
>> copying build/lib.macosx-10.5-i386-2.5/mod_python/Session.py -> /
>> Library/Python/2.5/site-packages/mod_python
>> copying build/lib.macosx-10.5-i386-2.5/mod_python/testhandler.py -> /
>> Library/Python/2.5/site-packages/mod_python
>> copying build/lib.macosx-10.5-i386-2.5/mod_python/util.py -> / 
>> Library/
>> Python/2.5/site-packages/mod_python
>> byte-compiling /Library/Python/2.5/site-packages/mod_python/
>> __init__.py to __init__.pyc
>> byte-compiling /Library/Python/2.5/site-packages/mod_python/apache.py
>> to apache.pyc
>> byte-compiling /Library/Python/2.5/site-packages/mod_python/cache.py
>> to cache.pyc
>> byte-compiling /Library/Python/2.5/site-packages/mod_python/
>> cgihandler.py to cgihandler.pyc
>> byte-compiling /Library/Python/2.5/site-packages/mod_python/Cookie.py
>> to Cookie.pyc
>> byte-compiling /Library/Python/2.5/site-packages/mod_python/
>> importer.py to importer.pyc
>> byte-compiling /Library/Python/2.5/site-packages/mod_python/psp.py to
>> psp.pyc
>> byte-compiling /Library/Python/2.5/site-packages/mod_python/
>> publisher.py to publisher.pyc
>> byte-compiling /Library/Python/2.5/site-packages/mod_python/
>> python22.py to python22.pyc
>> byte-compiling /Library/Python/2.5/site-packages/mod_python/ 
>> Session.py
>> to Session.pyc
>> byte-compiling /Library/Python/2.5/site-packages/mod_python/
>> testhandler.py to testhandler.pyc
>> byte-compiling /Library/Python/2.5/site-packages/mod_python/util.py  
>> to
>> util.pyc
>> writing byte-compilation script '/tmp/tmpIVf7U7.py'
>> /System/Library/Frameworks/Python.framework/Versions/2.5/Resources/
>> Python.app/Contents/MacOS/Python -OO /tmp/tmpIVf7U7.py
>> removing /tmp/tmpIVf7U7.py
>> running install_egg_info
>> Removing /Library/Python/2.5/site-packages/mod_python-3.3.1- 
>> py2.5.egg-
>> info
>> Writing /Library/Python/2.5/site-packages/mod_python-3.3.1-py2.5.egg-
>> info
>>
>> On 10/02/2008, at 10:44 PM, Graham Dumpleton wrote:
>>
>>> On 11/02/2008, Geert Dekkers <geert@nznl.com> wrote:
>>>> Hi all
>>>>
>>>> I'm on macosx leopard (10.5.1), trying to install mod_python. After
>>>> the executing the tweaks for leopard, It seems as if everything  
>>>> makes
>>>> && make installs ok, but there's no mod_python.so in /usr/libexec,
>>>> where other modules live. Does anyone have similar experiences?
>>>
>>> What was the output when you ran 'sudo make install'?
>>>
>>> Graham
>>
>>

From graham.dumpleton at gmail.com  Mon Feb 11 04:48:54 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Feb 11 04:49:00 2008
Subject: [mod_python] macosx 10.5 - can't find mod_python.so - why?
In-Reply-To: <71A04A76-E806-4310-BA30-4BEB31ABD3B9@nznl.com>
References: <40F512A8-2505-4CFD-B34F-6BBEE89B102B@nznl.com>
	<88e286470802101344m52c67f0vd61c279dbaa030fc@mail.gmail.com>
	<9CBDDD5C-BCA8-4F58-976D-1E7D934D4877@nznl.com>
	<88e286470802101400s15279f45i5cfbedc25db6fc8f@mail.gmail.com>
	<71A04A76-E806-4310-BA30-4BEB31ABD3B9@nznl.com>
Message-ID: <88e286470802110148s2d92d177y996b0e355998f775@mail.gmail.com>

Why do you want to get mod_python running? Is it only to run Django or
some other framework capable of running on WSGI compatible hosting
solution? If so, maybe you want to look at mod_wsgi instead. Version
2.0c4 of mod_wsgi will work out of the box on Leopard.

Anyway, without seeing exactly what modifications you made to
src/Makefile can only guess at this point. Also would need to see
exactly what error message you are getting.

You might also read:

  http://code.google.com/p/modwsgi/wiki/InstallationOnMacOSX

for ideas.

Graham

On 11/02/2008, Geert Dekkers <geert@nznl.com> wrote:
> Hi all :)
>
> Still having problems. Now apache2 complains mod_python.so has the
> wrong architecture. I've implemented the fixes I've found here and
> there (http://groups.google.com/group/django-users/msg/
> b211ba1193cb6092 - among others).
>
> A question - wouldn't I have apache2 running in 32 bit mode on my
> first-generation (2006) macbook pro. I found this hint http://forums.macosxhints.com/archive/index.php/t-62551.html
>   - tji, on 10-28-2006, 02:04 PM (halfway down the page) , and lo and
> behold, I seem to be running 32-bit:
>
> Size of Data Types on this System:
>
> Char = 1 bytes
> Integer = 4 bytes
> Long Integer = 4 bytes
> Long Long Integer = 8 bytes
> Double = 8 bytes
> Pointer = 4 bytes
>
>
> So, what could the problem be? Am I out of the race now?
>
> Geert
>
>
>
> On 10/02/2008, at 11:00 PM, Graham Dumpleton wrote:
>
> > Please use reply-all and keep follow ups on the list.
> >
> > See comment below.
> >
> > On 11/02/2008, Geert Dekkers <geert@nznl.com> wrote:
> >> Hi Graham,
> >>
> >> Thanks for responding so quickly.
> >>
> >> The ouput of the sudo make install:
> >>
> >> geert-dekkers-computer:mod_python-3.3.1 geert$ sudo make install
> >> Password:
> >> make[3]: `psp_parser.c' is up to date.
> >> /System/Library/Frameworks/Python.framework/Versions/Current/bin/
> >> python setup.py build
> >> running build
> >> running build_py
> >> running build_ext
> >>
> >> Now su and make install
> >>   (or, if you only want to perform a partial install,
> >>    you can use make install_dso and make install_py_lib)
> >>
> >>
> >> Performing DSO installation.
> >>
> >> /users/geert/Applications/PhpDocumentor-1.4.0/PhpDocumentor-1.4.0/
> >> install -c -d /usr/libexec/apache2
> >> make[1]: execvp: /users/geert/Applications/PhpDocumentor-1.4.0/
> >> PhpDocumentor-1.4.0/install: Permission denied
> >
> > And this is obviously your problem.
> >
> > Change your user PATH such that that PHP stuff is last and not before
> > '/usr/bin'.
> >
> > There is obviously a file called 'install' in that directory in your
> > path and it is getting in the way of /usr/bin/install being used as it
> > should.
> >
> > Graham
> >
> >> make[1]: *** [install_dso] Error 127
> >> cd dist && make install_py_lib
> >> make[3]: `psp_parser.c' is up to date.
> >> if test -z "" ; then \
> >>                /System/Library/Frameworks/Python.framework/Versions/
> >> Current/bin/
> >> python setup.py install --optimize 2 --force ; \
> >>        else \
> >>                /System/Library/Frameworks/Python.framework/Versions/
> >> Current/bin/
> >> python setup.py install --optimize 2 --force --root  ; \
> >>        fi
> >> running install
> >> running build
> >> running build_py
> >> running build_ext
> >> running install_lib
> >> copying build/lib.macosx-10.5-i386-2.5/mod_python/__init__.py -> /
> >> Library/Python/2.5/site-packages/mod_python
> >> copying build/lib.macosx-10.5-i386-2.5/mod_python/_psp.so -> /
> >> Library/
> >> Python/2.5/site-packages/mod_python
> >> copying build/lib.macosx-10.5-i386-2.5/mod_python/apache.py -> /
> >> Library/Python/2.5/site-packages/mod_python
> >> copying build/lib.macosx-10.5-i386-2.5/mod_python/cache.py -> /
> >> Library/
> >> Python/2.5/site-packages/mod_python
> >> copying build/lib.macosx-10.5-i386-2.5/mod_python/cgihandler.py -> /
> >> Library/Python/2.5/site-packages/mod_python
> >> copying build/lib.macosx-10.5-i386-2.5/mod_python/Cookie.py -> /
> >> Library/Python/2.5/site-packages/mod_python
> >> copying build/lib.macosx-10.5-i386-2.5/mod_python/importer.py -> /
> >> Library/Python/2.5/site-packages/mod_python
> >> copying build/lib.macosx-10.5-i386-2.5/mod_python/psp.py -> /Library/
> >> Python/2.5/site-packages/mod_python
> >> copying build/lib.macosx-10.5-i386-2.5/mod_python/publisher.py -> /
> >> Library/Python/2.5/site-packages/mod_python
> >> copying build/lib.macosx-10.5-i386-2.5/mod_python/python22.py -> /
> >> Library/Python/2.5/site-packages/mod_python
> >> copying build/lib.macosx-10.5-i386-2.5/mod_python/Session.py -> /
> >> Library/Python/2.5/site-packages/mod_python
> >> copying build/lib.macosx-10.5-i386-2.5/mod_python/testhandler.py -> /
> >> Library/Python/2.5/site-packages/mod_python
> >> copying build/lib.macosx-10.5-i386-2.5/mod_python/util.py -> /
> >> Library/
> >> Python/2.5/site-packages/mod_python
> >> byte-compiling /Library/Python/2.5/site-packages/mod_python/
> >> __init__.py to __init__.pyc
> >> byte-compiling /Library/Python/2.5/site-packages/mod_python/apache.py
> >> to apache.pyc
> >> byte-compiling /Library/Python/2.5/site-packages/mod_python/cache.py
> >> to cache.pyc
> >> byte-compiling /Library/Python/2.5/site-packages/mod_python/
> >> cgihandler.py to cgihandler.pyc
> >> byte-compiling /Library/Python/2.5/site-packages/mod_python/Cookie.py
> >> to Cookie.pyc
> >> byte-compiling /Library/Python/2.5/site-packages/mod_python/
> >> importer.py to importer.pyc
> >> byte-compiling /Library/Python/2.5/site-packages/mod_python/psp.py to
> >> psp.pyc
> >> byte-compiling /Library/Python/2.5/site-packages/mod_python/
> >> publisher.py to publisher.pyc
> >> byte-compiling /Library/Python/2.5/site-packages/mod_python/
> >> python22.py to python22.pyc
> >> byte-compiling /Library/Python/2.5/site-packages/mod_python/
> >> Session.py
> >> to Session.pyc
> >> byte-compiling /Library/Python/2.5/site-packages/mod_python/
> >> testhandler.py to testhandler.pyc
> >> byte-compiling /Library/Python/2.5/site-packages/mod_python/util.py
> >> to
> >> util.pyc
> >> writing byte-compilation script '/tmp/tmpIVf7U7.py'
> >> /System/Library/Frameworks/Python.framework/Versions/2.5/Resources/
> >> Python.app/Contents/MacOS/Python -OO /tmp/tmpIVf7U7.py
> >> removing /tmp/tmpIVf7U7.py
> >> running install_egg_info
> >> Removing /Library/Python/2.5/site-packages/mod_python-3.3.1-
> >> py2.5.egg-
> >> info
> >> Writing /Library/Python/2.5/site-packages/mod_python-3.3.1-py2.5.egg-
> >> info
> >>
> >> On 10/02/2008, at 10:44 PM, Graham Dumpleton wrote:
> >>
> >>> On 11/02/2008, Geert Dekkers <geert@nznl.com> wrote:
> >>>> Hi all
> >>>>
> >>>> I'm on macosx leopard (10.5.1), trying to install mod_python. After
> >>>> the executing the tweaks for leopard, It seems as if everything
> >>>> makes
> >>>> && make installs ok, but there's no mod_python.so in /usr/libexec,
> >>>> where other modules live. Does anyone have similar experiences?
> >>>
> >>> What was the output when you ran 'sudo make install'?
> >>>
> >>> Graham
> >>
> >>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From vincent.legoll at gmail.com  Mon Feb 11 09:26:43 2008
From: vincent.legoll at gmail.com (Vincent Legoll)
Date: Mon Feb 11 09:26:54 2008
Subject: [mod_python] Doc fix
Message-ID: <4727185d0802110626k6b4fd4b1p2d3beab9fb988f79@mail.gmail.com>

Hello,

please review the attached patch file, it fixes a typo in doc

-- 
Vincent Legoll
-------------- next part --------------
A non-text attachment was scrubbed...
Name: mod_python-3.3.1-docfix-cgihandler.patch
Type: text/x-patch
Size: 878 bytes
Desc: not available
Url : http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20080211/2680bc2e/mod_python-3.3.1-docfix-cgihandler.bin
From atc at centroin.com.br  Mon Feb 11 09:38:29 2008
From: atc at centroin.com.br (Alexandre Taschetto de Castro)
Date: Mon Feb 11 09:38:17 2008
Subject: [mod_python] apache cannot find mod_python files
In-Reply-To: <88e286470802101156i744eb504n29c79056c4a9075d@mail.gmail.com>
References: <20080210152041.M91017@centroin.com.br>
	<88e286470802101156i744eb504n29c79056c4a9075d@mail.gmail.com>
Message-ID: <20080211142551.M73387@centroin.com.br>


I have only one version of python, installed in /usr/lib64/python2.5, where
site.py is located. I don't use sudo, apache is started automatically at boot
or logged in as root (when I am fiddling around with it).

The result of sys.path from python command line is below. It seemed to me that
site.py was ok.

>>> import sys
>>> sys.path
['', '/usr/lib/python25.zip', '/usr/lib64/python2.5',
'/usr/lib64/python2.5/plat-linux2', '/usr/lib64/python2.5/lib-tk',
'/usr/lib64/python2.5/lib-dynload', '/usr/lib64/python2.5/site-packages',
'/usr/lib64/python2.5/site-packages/Numeric',
'/usr/lib64/python2.5/site-packages/mod_python']

The path apache gives in its error.log is identical but for some reason it
stops at /lib-dynload.

Alexandre

---------- Original Message -----------
From: "Graham Dumpleton" <graham.dumpleton@gmail.com>
To: "Alexandre Taschetto de Castro" <atc@centroin.com.br>
Cc: mod_python@modpython.org
Sent: Mon, 11 Feb 2008 06:56:25 +1100
Subject: Re: [mod_python] apache cannot find mod_python files

> Finding mod_python files is not the problem. What it can't find is 
> the 'site' module, ie., 'site.py'.
> 
> How many different versions of Python do you have on your box? Where
> are they located? What is your personal PATH environment variable set
> to? How are you stopping and starting Apache? Are you using 'sudo',
>  if so, using exactly what command line are you using? Have you 
> tried using 'sudo -H' instead?
> 
> Graham
> 
> On 11/02/2008, Alexandre Taschetto de Castro <atc@centroin.com.br> wrote:
> > Hello,
> >
> > I have the following problem. Apache loads mod_python module correctly:
> >
> > [Thu Jan 31 15:48:20 2008] [notice] mod_python: using mutex_directory /tmp
> > [Thu Jan 31 15:48:20 2008] [notice] Apache/2.2.4 (Linux/SUSE) mod_ssl/2.2.4
> > OpenSSL/0.9.8e PHP/5.2.5 with Suhosin-Patch mod_python/3.3.1 Python/2.5.1
> > configured -- resuming normal operations
> >
> > but cannot find mod_python files:
> >
> > [Thu Jan 31 15:48:26 2008] [error] make_obcallback: could not import
> > mod_python.apache.\n
> > 'import site' failed; use -v for traceback
> > ImportError: No module named mod_python.apache
> > [Thu Jan 31 15:48:26 2008] [error] make_obcallback: Python path being used
> > "['/usr/lib/python25.zip', '/usr/lib64/python2.5/',
> > '/usr/lib64/python2.5/plat-linux2', '/usr/lib64/python2.5/lib-tk',
> > '/usr/lib64/python2.5/lib-dynload']".
> > [Thu Jan 31 15:48:26 2008] [error] get_interpreter: no interpreter
callback found.
> >
> >
> > mod_python is installed in usr/lib64/python2.5/site-packages/mod_python, which
> > is in python's sys.path and can be read by the apache user (www). How can I
> > tell apache to include this in the python path it is using? I am using
> > Opensuse 10.3.
> >
> > Thanks
> > Alexandre
> >
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
------- End of Original Message -------

From atc at centroin.com.br  Mon Feb 11 11:36:52 2008
From: atc at centroin.com.br (Alexandre Taschetto de Castro)
Date: Mon Feb 11 11:36:40 2008
Subject: [mod_python] apache cannot find mod_python files
In-Reply-To: <88e286470802101156i744eb504n29c79056c4a9075d@mail.gmail.com>
References: <20080210152041.M91017@centroin.com.br>
	<88e286470802101156i744eb504n29c79056c4a9075d@mail.gmail.com>
Message-ID: <20080211163348.M80418@centroin.com.br>


Graham,

I've just found the problem. There was an error with access permissions for
/usr/lib64. I had only checked the directories under it, which were ok. Once I
corrected that, things worked fine.

Thanks
Alexandre



---------- Original Message -----------
From: "Graham Dumpleton" <graham.dumpleton@gmail.com>
To: "Alexandre Taschetto de Castro" <atc@centroin.com.br>
Cc: mod_python@modpython.org
Sent: Mon, 11 Feb 2008 06:56:25 +1100
Subject: Re: [mod_python] apache cannot find mod_python files

> Finding mod_python files is not the problem. What it can't find is 
> the 'site' module, ie., 'site.py'.
> 
> How many different versions of Python do you have on your box? Where
> are they located? What is your personal PATH environment variable set
> to? How are you stopping and starting Apache? Are you using 'sudo',
>  if so, using exactly what command line are you using? Have you 
> tried using 'sudo -H' instead?
> 
> Graham
> 
> On 11/02/2008, Alexandre Taschetto de Castro <atc@centroin.com.br> wrote:
> > Hello,
> >
> > I have the following problem. Apache loads mod_python module correctly:
> >
> > [Thu Jan 31 15:48:20 2008] [notice] mod_python: using mutex_directory /tmp
> > [Thu Jan 31 15:48:20 2008] [notice] Apache/2.2.4 (Linux/SUSE) mod_ssl/2.2.4
> > OpenSSL/0.9.8e PHP/5.2.5 with Suhosin-Patch mod_python/3.3.1 Python/2.5.1
> > configured -- resuming normal operations
> >
> > but cannot find mod_python files:
> >
> > [Thu Jan 31 15:48:26 2008] [error] make_obcallback: could not import
> > mod_python.apache.\n
> > 'import site' failed; use -v for traceback
> > ImportError: No module named mod_python.apache
> > [Thu Jan 31 15:48:26 2008] [error] make_obcallback: Python path being used
> > "['/usr/lib/python25.zip', '/usr/lib64/python2.5/',
> > '/usr/lib64/python2.5/plat-linux2', '/usr/lib64/python2.5/lib-tk',
> > '/usr/lib64/python2.5/lib-dynload']".
> > [Thu Jan 31 15:48:26 2008] [error] get_interpreter: no interpreter
callback found.
> >
> >
> > mod_python is installed in usr/lib64/python2.5/site-packages/mod_python, which
> > is in python's sys.path and can be read by the apache user (www). How can I
> > tell apache to include this in the python path it is using? I am using
> > Opensuse 10.3.
> >
> > Thanks
> > Alexandre
> >
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
------- End of Original Message -------

From graham.dumpleton at gmail.com  Mon Feb 11 15:22:00 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Feb 11 15:22:06 2008
Subject: [mod_python] Doc fix
In-Reply-To: <4727185d0802110626k6b4fd4b1p2d3beab9fb988f79@mail.gmail.com>
References: <4727185d0802110626k6b4fd4b1p2d3beab9fb988f79@mail.gmail.com>
Message-ID: <88e286470802111222t4b4b2061r7682901dddbeb8e@mail.gmail.com>

Can you create an issue at:

  http://issues.apache.org/jira/browse/MODPYTHON

Otherwise it will just get lost in the mailing list posts by the time
anyone gets to look at making changes to source code and/or
documentation.

Thanks.

Graham

On 12/02/2008, Vincent Legoll <vincent.legoll@gmail.com> wrote:
> Hello,
>
> please review the attached patch file, it fixes a typo in doc
>
> --
> Vincent Legoll
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
>
From martijn at xs4us.nu  Tue Feb 12 04:43:48 2008
From: martijn at xs4us.nu (Martijn Moeling)
Date: Tue Feb 12 04:44:24 2008
Subject: [mod_python] mod_python.Importer.path; set dynamically
In-Reply-To: <88e286470802050212s2355593ds96b743a8061cd159@mail.gmail.com>
References: <B6C73A5E30565245BB6D32B5F5DF7A52172BA2@sense.emmastraat.pijnacker>
	<88e286470801311403u467069a8r75eab9f16184c0fd@mail.gmail.com>
	<B6C73A5E30565245BB6D32B5F5DF7A52172BA3@sense.emmastraat.pijnacker>
	<88e286470802050212s2355593ds96b743a8061cd159@mail.gmail.com>
Message-ID: <056ADD91-48A9-42CE-85C8-2F8901681032@xs4us.nu>

Graham,

Thank you, I did not mess around with it yet, I am planning a  
versioning system to be added to my webbased development platform.
I am still having some trouble with my webdav module, I have to taccle  
that one first.

Your help is usefull one question though:

say the inporterpath is set to:

".../python_modules/me:.../python_modules"

in the apacheconfig the importerpath is set to .../python_modules

in both directories stays:

modulex.py ( in the me directory is the lates version)


in my handler module:

import modulex

de handler(req):
	....... (some code)
	if req.debug and req.session.loggedIn:
		req.options['mod_python.path'] = ".../me:../"
		importedModules=[]
		modules=filesInUserDirectory(req.session.user)
           for module in modules:
			module.append( apache.import_module(module)
		return module.index(req,*args,**kwargs) # return apache.OK?
   ......... (some code)
	return apache.OK

what happens to the interpreter for the next requests? which "modulex"  
is used ? The are supposed to get the "stable" one from .../ 
python_modules/
I don't understand what the return line does, what happens if I return  
apache.OK in this case?


Martijn

On Feb 5, 2008, at 11:12 AM, Graham Dumpleton wrote:

> Sorry for the delay.
>
> To make things work transparently across a lot of modules, for both
> import_module() and 'import' where possible, what you can do is modify
> the value of option 'mod_python.importer.path' dynamically from code.
> This can be done from memory using:
>
> req.options['mod_python.importer.path'] = "...."
>
> You obviously can query this first if you need to somehow manipulate
> it to add stuff.
>
> All you then need is a level of indirection. Has to be from inside of
> handler, can't be at global scope. So,
> /var/www/python_modules/index.py might do:
>
> def index(req, *args, **kwargs):
> req.options['mod_python.importer.path'] = \
>  '/var/www/python_modules/%s:/var/www/python_modules' % req.user
> module = apache.import_module('index-core')
> return module.index(req, *args, **kwargs)
>
> If there is only one level of module imports, you could also do just:
>
> def index(req, *args, **kwargs):
> module = apache.import_module('index-core', \
>  path=['/var/www/python_modules/%s:/var/www/python_modules' %  
> req.user]))
> return module.index(req, *args, **kwargs)
>
> but think that if subdirectory uses 'import', then it might not look
> in all the directories. Can't remember how it works now.
>
> Anyway the suggestion is look at changing req.options if you haven't  
> already.
>
> Graham
>
> On 01/02/2008, Martijn Moeling <martijn@xs4us.nu> wrote:
>>
>>
>>
>> Graham,
>>
>> As you might remember I added a MySQLdb section to session.
>> (to be able to save sessions across computers)
>>
>> In my system a lot of additional data is added to the req object,  
>> which is
>> passed
>> around. in my case it is req.Session.user.
>>
>> (I do not use http based auth, since this is in conflict with my  
>> web based
>> desktop)
>>
>> nevertheless, i can change your "example code" to my needs, consider
>> req.user as the distinguisher for ease of thinking.
>>
>> Martijn
>>
>>
>>
>>
>> -----Original Message-----
>> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
>> Sent: Thu 31.01.2008 23:03
>> To: Martijn Moeling
>> Cc: mod_python@modpython.org
>> Subject: Re: [mod_python] mod_python.Importer.path; set dynamically
>>
>> On 01/02/2008, Martijn Moeling <martijn@xs4us.nu> wrote:
>>> Hi!
>>>
>>> I am an extensive mod_python user and my system needs something  
>>> special.
>>>
>>> Consider the following:
>>>
>>> in httpd.conf I have :
>>>
>>> PythonOption mod_python.importer.path ["/var/www/python_modules"]
>>>
>>> /var/www/html/index.py is linked to ../python_modules/index.py
>>>
>>> the python_modules directory has subdirectories, like; developer1,
>>> developer2
>>>
>>> the python_modules contains stable modules and developerX holds
>> development
>>> versions.
>>>
>>> I have load balancing with multiple frond-ends (apache/MP) and one
>> backend
>>> (MySQL).
>>>
>>> I would like to dynamically change the mod_python.importer.path so  
>>> that
>>> developer1 runs code in the corresponding subdir if the module  
>>> exists,
>>> else fall back to the python_modules directory.
>>>
>>> Any tips, suggestions, remarks?
>>
>> What is the distinguisher used to know which developer it is? Are you
>> using something like Basic authentication and so could distinguish
>> based on req.user?
>>
>> If you tell me what the distinguisher is, probably have an idea.
>>
>> Graham
>>
>>

From vincent.legoll at gmail.com  Tue Feb 12 05:12:54 2008
From: vincent.legoll at gmail.com (Vincent Legoll)
Date: Tue Feb 12 05:13:01 2008
Subject: [mod_python] Doc fix
In-Reply-To: <88e286470802111222t4b4b2061r7682901dddbeb8e@mail.gmail.com>
References: <4727185d0802110626k6b4fd4b1p2d3beab9fb988f79@mail.gmail.com>
	<88e286470802111222t4b4b2061r7682901dddbeb8e@mail.gmail.com>
Message-ID: <4727185d0802120212q47873a36h50b1ac92344afdc0@mail.gmail.com>

On Feb 11, 2008 9:22 PM, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> Can you create an issue at:
>
>   http://issues.apache.org/jira/browse/MODPYTHON
>
> Otherwise it will just get lost in the mailing list posts by the time
> anyone gets to look at making changes to source code and/or
> documentation.

Done
MODPYTHON-247

-- 
Vincent Legoll
From graham.dumpleton at gmail.com  Tue Feb 12 18:40:38 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Feb 12 18:40:44 2008
Subject: [mod_python] mod_python.Importer.path; set dynamically
In-Reply-To: <056ADD91-48A9-42CE-85C8-2F8901681032@xs4us.nu>
References: <B6C73A5E30565245BB6D32B5F5DF7A52172BA2@sense.emmastraat.pijnacker>
	<88e286470801311403u467069a8r75eab9f16184c0fd@mail.gmail.com>
	<B6C73A5E30565245BB6D32B5F5DF7A52172BA3@sense.emmastraat.pijnacker>
	<88e286470802050212s2355593ds96b743a8061cd159@mail.gmail.com>
	<056ADD91-48A9-42CE-85C8-2F8901681032@xs4us.nu>
Message-ID: <88e286470802121540m63992abfuee59ca2f0da7d8a3@mail.gmail.com>

On 12/02/2008, Martijn Moeling <martijn@xs4us.nu> wrote:
> Graham,
>
> Thank you, I did not mess around with it yet, I am planning a
> versioning system to be added to my webbased development platform.
> I am still having some trouble with my webdav module, I have to taccle
> that one first.
>
> Your help is usefull one question though:
>
> say the inporterpath is set to:
>
> ".../python_modules/me:.../python_modules"
>
> in the apacheconfig the importerpath is set to .../python_modules
>
> in both directories stays:
>
> modulex.py ( in the me directory is the lates version)
>
>
> in my handler module:
>
> import modulex
>
> de handler(req):
>         ....... (some code)
>         if req.debug and req.session.loggedIn:
>                 req.options['mod_python.path'] = ".../me:../"
>                 importedModules=[]
>                 modules=filesInUserDirectory(req.session.user)
>            for module in modules:
>                         module.append( apache.import_module(module)
>                 return module.index(req,*args,**kwargs) # return apache.OK?
>    ......... (some code)
>         return apache.OK
>
> what happens to the interpreter for the next requests? which "modulex"
> is used ? The are supposed to get the "stable" one from .../
> python_modules/

Yes. Should always get the one from path specified in Apache
configuration. The dynamic change is only going to apply to those
imports done from handler or as a side effect of running the handler.

> I don't understand what the return line does, what happens if I return
> apache.OK in this case?

Huh.

At least I am a bit confused by your question as the code:

          for module in modules:
                       module.append( apache.import_module(module)
               return module.index(req,*args,**kwargs) # return apache.OK?
  ......... (some code)

doesn't make much sense to me. Don't understand why you are trying to
iterate over a list of modules to import.

Graham

> Martijn
>
> On Feb 5, 2008, at 11:12 AM, Graham Dumpleton wrote:
>
> > Sorry for the delay.
> >
> > To make things work transparently across a lot of modules, for both
> > import_module() and 'import' where possible, what you can do is modify
> > the value of option 'mod_python.importer.path' dynamically from code.
> > This can be done from memory using:
> >
> > req.options['mod_python.importer.path'] = "...."
> >
> > You obviously can query this first if you need to somehow manipulate
> > it to add stuff.
> >
> > All you then need is a level of indirection. Has to be from inside of
> > handler, can't be at global scope. So,
> > /var/www/python_modules/index.py might do:
> >
> > def index(req, *args, **kwargs):
> > req.options['mod_python.importer.path'] = \
> >  '/var/www/python_modules/%s:/var/www/python_modules' % req.user
> > module = apache.import_module('index-core')
> > return module.index(req, *args, **kwargs)
> >
> > If there is only one level of module imports, you could also do just:
> >
> > def index(req, *args, **kwargs):
> > module = apache.import_module('index-core', \
> >  path=['/var/www/python_modules/%s:/var/www/python_modules' %
> > req.user]))
> > return module.index(req, *args, **kwargs)
> >
> > but think that if subdirectory uses 'import', then it might not look
> > in all the directories. Can't remember how it works now.
> >
> > Anyway the suggestion is look at changing req.options if you haven't
> > already.
> >
> > Graham
> >
> > On 01/02/2008, Martijn Moeling <martijn@xs4us.nu> wrote:
> >>
> >>
> >>
> >> Graham,
> >>
> >> As you might remember I added a MySQLdb section to session.
> >> (to be able to save sessions across computers)
> >>
> >> In my system a lot of additional data is added to the req object,
> >> which is
> >> passed
> >> around. in my case it is req.Session.user.
> >>
> >> (I do not use http based auth, since this is in conflict with my
> >> web based
> >> desktop)
> >>
> >> nevertheless, i can change your "example code" to my needs, consider
> >> req.user as the distinguisher for ease of thinking.
> >>
> >> Martijn
> >>
> >>
> >>
> >>
> >> -----Original Message-----
> >> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
> >> Sent: Thu 31.01.2008 23:03
> >> To: Martijn Moeling
> >> Cc: mod_python@modpython.org
> >> Subject: Re: [mod_python] mod_python.Importer.path; set dynamically
> >>
> >> On 01/02/2008, Martijn Moeling <martijn@xs4us.nu> wrote:
> >>> Hi!
> >>>
> >>> I am an extensive mod_python user and my system needs something
> >>> special.
> >>>
> >>> Consider the following:
> >>>
> >>> in httpd.conf I have :
> >>>
> >>> PythonOption mod_python.importer.path ["/var/www/python_modules"]
> >>>
> >>> /var/www/html/index.py is linked to ../python_modules/index.py
> >>>
> >>> the python_modules directory has subdirectories, like; developer1,
> >>> developer2
> >>>
> >>> the python_modules contains stable modules and developerX holds
> >> development
> >>> versions.
> >>>
> >>> I have load balancing with multiple frond-ends (apache/MP) and one
> >> backend
> >>> (MySQL).
> >>>
> >>> I would like to dynamically change the mod_python.importer.path so
> >>> that
> >>> developer1 runs code in the corresponding subdir if the module
> >>> exists,
> >>> else fall back to the python_modules directory.
> >>>
> >>> Any tips, suggestions, remarks?
> >>
> >> What is the distinguisher used to know which developer it is? Are you
> >> using something like Basic authentication and so could distinguish
> >> based on req.user?
> >>
> >> If you tell me what the distinguisher is, probably have an idea.
> >>
> >> Graham
> >>
> >>
>
>
From denes1951 at yahoo.ca  Thu Feb 14 08:14:49 2008
From: denes1951 at yahoo.ca (Denes L)
Date: Thu Feb 14 08:15:12 2008
Subject: [mod_python] compile mod_python on iSeries (AS/400)
Message-ID: <299647.92645.qm@web45101.mail.sp1.yahoo.com>

The suggested change does not work:

strcpy(ci->interpreter, interpreter);       
(__strcpy((ci->interpreter),(interpreter)));
CZM0280  Function argument assignment between types "unsigned char*" and "const unsigned char*" is not allowed.

I also found out that strdup is available in C++, should I be using the C++ compiler for this?.

Denes.

       
---------------------------------
Looking for the perfect gift? Give the gift of Flickr!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20080214/71632e24/attachment.html
From graham.dumpleton at gmail.com  Thu Feb 14 14:56:27 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Feb 14 14:56:38 2008
Subject: [mod_python] compile mod_python on iSeries (AS/400)
In-Reply-To: <299647.92645.qm@web45101.mail.sp1.yahoo.com>
References: <299647.92645.qm@web45101.mail.sp1.yahoo.com>
Message-ID: <88e286470802141156t1082e107o6820caba83af3c02@mail.gmail.com>

On 15/02/2008, Denes L <denes1951@yahoo.ca> wrote:
> The suggested change does not work:
>
> strcpy(ci->interpreter, interpreter);
> (__strcpy((ci->interpreter),(interpreter)));
> CZM0280  Function argument assignment between types "unsigned char*" and
> "const unsigned char*" is not allowed.

Just add a cast then:

   ci->interpreter = (char *)malloc(strlen(interpreter)+1));
   strcpy((char *)ci->interpreter, interpreter);

> I also found out that strdup is available in C++, should I be using the C++
> compiler for this?.

No. You'd probably find your C compiler also has it if the appropriate
preprocessor #define was given to have it work to a specific UNIX API
standard.

Graham
From jan.diener-rodriguez at orange.ch  Fri Feb 15 03:58:21 2008
From: jan.diener-rodriguez at orange.ch (Diener-Rodriguez Jan Raino Eerik)
Date: Fri Feb 15 04:34:04 2008
Subject: [mod_python] compiling on HPUX 11.11
Message-ID: <9FFAEC6056AE3D418CDA54F3FB38656B8A700F@VDCREXEVS01.orange.ch>

Hello guys,
I managed to compile python 2.5.1, which works fine but I don't get
mod_python to compile on my HP box (see below)
 
I am not a compiler/ing expert and it is well possible that I missed
some obvious detail.. would appreciate any hint or direction where to
find a possible solution to my problem.
 
thanks
jan
 
=== configure works, according to my little knowledge ===
# pwd
/tmp/mod_python-3.3.1
# ./configure --with-apxs=/usr/local/apache2/bin/apxs
--with-flex=/usr/local/bin/flex
checking for gcc... gcc
checking for C compiler default output file name... a.out
checking whether the C compiler works... yes
checking whether we are cross compiling... no
checking for suffix of executables...
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether gcc accepts -g... yes
checking for gcc option to accept ANSI C... none needed
checking for ar... ar
checking for a BSD-compatible install... ./install-sh -c
checking whether make sets $(MAKE)... yes
checking for main in -lm... yes
checking for an ANSI C-conforming const... yes
checking your blood pressure... a bit high, but we can proceed
configure: checking whether apxs is available...
checking for --with-apxs... /usr/local/apache2/bin/apxs executable, good
checking Apache version... 2.0.63
checking for Apache libexec directory... /usr/local/apache2/modules
checking for Apache include directory... -I/usr/local/apache2/include
checking for --with-python... no
checking for python... /usr/bin/python
checking Python version... 2.5
checking Python install prefix... /usr/local
checking checking where python libraries are installed...
/usr/local/lib/python2.5
checking for Py_NewInterpreter in -lpython2.5... yes
checking what libraries Python was linked with... -lpython2.5   -lnsl
-lrt -ldld    -lm
checking linker flags used to link Python...
checking where Python include files are...
-I/usr/local/include/python2.5
checking for --with-python-src... no
checking for --with-mutex-dir... no
Using MUTEX_DIR /tmp
checking for --with-max-locks... no
Using 8 MAX_LOCKS.
checking for --with-flex... /usr/local/bin/flex
found /usr/local/bin/flex, we'll use this. Use --with-flex to specify
another.
checking flex version... 2.5.34. Good
configure: creating ./config.status
config.status: creating Makefile
config.status: creating src/Makefile
config.status: creating Doc/Makefile
config.status: creating src/include/mod_python.h
config.status: creating test/Makefile
config.status: creating test/testconf.py
config.status: creating dist/setup.py
config.status: creating dist/Makefile
#
 

=== compiling - fails ====
 
#  gmake
gmake[1]: Entering directory `/tmp/mod_python-3.3.1/src'
 
Compiling for DSO.
 
/usr/local/apache2/bin/apxs -I/tmp/mod_python-3.3.1/src/include
-I/usr/local/apache2/include -I/usr/local/include/python2.5 -c
mod_python.c _apachemodule.c requestobject.c tableobject.c util.c
serverobject.c connobject.c filterobject.c hlist.c hlistobject.c
finfoobject.c -L/usr/local/lib/python2.5/config  -Wl,-E -Wl,+s      -lm
-lpython2.5   -lnsl -lrt -ldld    -lm
/usr/local/apache2/build/libtool --silent --mode=compile gcc -prefer-pic
-DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11 -D_REENTRANT
-D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread -I/usr/local/apache2/include
-I/usr/local/apache2/include   -I/usr/local/apache2/include
-I/tmp/mod_python-3.3.1/src/include -I/usr/local/apache2/include
-I/usr/local/include/python2.5  -c -o mod_python.lo mod_python.c &&
touch mod_python.slo
In file included from /usr/local/include/python2.5/Python.h:8,
                 from /tmp/mod_python-3.3.1/src/include/mod_python.h:80,
                 from mod_python.c:28:
/usr/local/include/python2.5/pyconfig.h:932:1: warning:
"_POSIX_C_SOURCE" redefined
<command-line>: warning: this is the location of the previous definition
mod_python.c: In function 'python_init':
mod_python.c:826: warning: initialization from incompatible pointer type
mod_python.c: In function 'get_interpreter':
mod_python.c:290: warning: passing argument 1 of 'make_obcallback'
discards qualifiers from pointer target type
/usr/local/apache2/build/libtool --silent --mode=compile gcc -prefer-pic
-DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11 -D_REENTRANT
-D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread -I/usr/local/apache2/include
-I/usr/local/apache2/include   -I/usr/local/apache2/include
-I/tmp/mod_python-3.3.1/src/include -I/usr/local/apache2/include
-I/usr/local/include/python2.5  -c -o _apachemodule.lo _apachemodule.c
&& touch _apachemodule.slo
In file included from /usr/local/include/python2.5/Python.h:8,
                 from /tmp/mod_python-3.3.1/src/include/mod_python.h:80,
                 from _apachemodule.c:25:
/usr/local/include/python2.5/pyconfig.h:932:1: warning:
"_POSIX_C_SOURCE" redefined
<command-line>: warning: this is the location of the previous definition
/usr/local/apache2/build/libtool --silent --mode=compile gcc -prefer-pic
-DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11 -D_REENTRANT
-D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread -I/usr/local/apache2/include
-I/usr/local/apache2/include   -I/usr/local/apache2/include
-I/tmp/mod_python-3.3.1/src/include -I/usr/local/apache2/include
-I/usr/local/include/python2.5  -c -o requestobject.lo requestobject.c
&& touch requestobject.slo
In file included from /usr/local/include/python2.5/Python.h:8,
                 from /tmp/mod_python-3.3.1/src/include/mod_python.h:80,
                 from requestobject.c:25:
/usr/local/include/python2.5/pyconfig.h:932:1: warning:
"_POSIX_C_SOURCE" redefined
<command-line>: warning: this is the location of the previous definition
/usr/local/apache2/build/libtool --silent --mode=compile gcc -prefer-pic
-DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11 -D_REENTRANT
-D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread -I/usr/local/apache2/include
-I/usr/local/apache2/include   -I/usr/local/apache2/include
-I/tmp/mod_python-3.3.1/src/include -I/usr/local/apache2/include
-I/usr/local/include/python2.5  -c -o tableobject.lo tableobject.c &&
touch tableobject.slo
In file included from /usr/local/include/python2.5/Python.h:8,
                 from /tmp/mod_python-3.3.1/src/include/mod_python.h:80,
                 from tableobject.c:25:
/usr/local/include/python2.5/pyconfig.h:932:1: warning:
"_POSIX_C_SOURCE" redefined
<command-line>: warning: this is the location of the previous definition
tableobject.c:329: warning: initialization from incompatible pointer
type
tableobject.c:1092: warning: initialization from incompatible pointer
type
/usr/local/apache2/build/libtool --silent --mode=compile gcc -prefer-pic
-DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11 -D_REENTRANT
-D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread -I/usr/local/apache2/include
-I/usr/local/apache2/include   -I/usr/local/apache2/include
-I/tmp/mod_python-3.3.1/src/include -I/usr/local/apache2/include
-I/usr/local/include/python2.5  -c -o util.lo util.c && touch util.slo
In file included from /usr/local/include/python2.5/Python.h:8,
                 from /tmp/mod_python-3.3.1/src/include/mod_python.h:80,
                 from util.c:28:
/usr/local/include/python2.5/pyconfig.h:932:1: warning:
"_POSIX_C_SOURCE" redefined
<command-line>: warning: this is the location of the previous definition
/usr/local/apache2/build/libtool --silent --mode=compile gcc -prefer-pic
-DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11 -D_REENTRANT
-D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread -I/usr/local/apache2/include
-I/usr/local/apache2/include   -I/usr/local/apache2/include
-I/tmp/mod_python-3.3.1/src/include -I/usr/local/apache2/include
-I/usr/local/include/python2.5  -c -o serverobject.lo serverobject.c &&
touch serverobject.slo
In file included from /usr/local/include/python2.5/Python.h:8,
                 from /tmp/mod_python-3.3.1/src/include/mod_python.h:80,
                 from serverobject.c:25:
/usr/local/include/python2.5/pyconfig.h:932:1: warning:
"_POSIX_C_SOURCE" redefined
<command-line>: warning: this is the location of the previous definition
serverobject.c:387: warning: initialization from incompatible pointer
type
/usr/local/apache2/build/libtool --silent --mode=compile gcc -prefer-pic
-DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11 -D_REENTRANT
-D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread -I/usr/local/apache2/include
-I/usr/local/apache2/include   -I/usr/local/apache2/include
-I/tmp/mod_python-3.3.1/src/include -I/usr/local/apache2/include
-I/usr/local/include/python2.5  -c -o connobject.lo connobject.c &&
touch connobject.slo
In file included from /usr/local/include/python2.5/Python.h:8,
                 from /tmp/mod_python-3.3.1/src/include/mod_python.h:80,
                 from connobject.c:30:
/usr/local/include/python2.5/pyconfig.h:932:1: warning:
"_POSIX_C_SOURCE" redefined
<command-line>: warning: this is the location of the previous definition
/usr/local/apache2/build/libtool --silent --mode=compile gcc -prefer-pic
-DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11 -D_REENTRANT
-D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread -I/usr/local/apache2/include
-I/usr/local/apache2/include   -I/usr/local/apache2/include
-I/tmp/mod_python-3.3.1/src/include -I/usr/local/apache2/include
-I/usr/local/include/python2.5  -c -o filterobject.lo filterobject.c &&
touch filterobject.slo
In file included from /usr/local/include/python2.5/Python.h:8,
                 from /tmp/mod_python-3.3.1/src/include/mod_python.h:80,
                 from filterobject.c:28:
/usr/local/include/python2.5/pyconfig.h:932:1: warning:
"_POSIX_C_SOURCE" redefined
<command-line>: warning: this is the location of the previous definition
/usr/local/apache2/build/libtool --silent --mode=compile gcc -prefer-pic
-DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11 -D_REENTRANT
-D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread -I/usr/local/apache2/include
-I/usr/local/apache2/include   -I/usr/local/apache2/include
-I/tmp/mod_python-3.3.1/src/include -I/usr/local/apache2/include
-I/usr/local/include/python2.5  -c -o hlist.lo hlist.c && touch
hlist.slo
In file included from /usr/local/include/python2.5/Python.h:8,
                 from /tmp/mod_python-3.3.1/src/include/mod_python.h:80,
                 from hlist.c:28:
/usr/local/include/python2.5/pyconfig.h:932:1: warning:
"_POSIX_C_SOURCE" redefined
<command-line>: warning: this is the location of the previous definition
/usr/local/apache2/build/libtool --silent --mode=compile gcc -prefer-pic
-DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11 -D_REENTRANT
-D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread -I/usr/local/apache2/include
-I/usr/local/apache2/include   -I/usr/local/apache2/include
-I/tmp/mod_python-3.3.1/src/include -I/usr/local/apache2/include
-I/usr/local/include/python2.5  -c -o hlistobject.lo hlistobject.c &&
touch hlistobject.slo
In file included from /usr/local/include/python2.5/Python.h:8,
                 from /tmp/mod_python-3.3.1/src/include/mod_python.h:80,
                 from hlistobject.c:28:
/usr/local/include/python2.5/pyconfig.h:932:1: warning:
"_POSIX_C_SOURCE" redefined
<command-line>: warning: this is the location of the previous definition
/usr/local/apache2/build/libtool --silent --mode=compile gcc -prefer-pic
-DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11 -D_REENTRANT
-D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread -I/usr/local/apache2/include
-I/usr/local/apache2/include   -I/usr/local/apache2/include
-I/tmp/mod_python-3.3.1/src/include -I/usr/local/apache2/include
-I/usr/local/include/python2.5  -c -o finfoobject.lo finfoobject.c &&
touch finfoobject.slo
In file included from /usr/local/include/python2.5/Python.h:8,
                 from /tmp/mod_python-3.3.1/src/include/mod_python.h:80,
                 from finfoobject.c:25:
/usr/local/include/python2.5/pyconfig.h:932:1: warning:
"_POSIX_C_SOURCE" redefined
<command-line>: warning: this is the location of the previous definition
finfoobject.c:278: warning: 'intargfunc' is deprecated
finfoobject.c:278: warning: initialization from incompatible pointer
type
/usr/local/apache2/build/libtool --silent --mode=link gcc -o
mod_python.la  -rpath /usr/local/apache2/modules -module -avoid-version
finfoobject.lo hlistobject.lo hlist.lo filterobject.lo connobject.lo
serverobject.lo util.lo tableobject.lo requestobject.lo _apachemodule.lo
mod_python.lo -L/usr/local/lib/python2.5/config -Wl,-E -Wl,+s -lm
-lpython2.5 -lnsl -lrt -ldld -lm
/usr/ccs/bin/ld: Invalid loader fixup in text space needed in output
file for symbol "_PyEval_SliceIndex" in input file
"/usr/local/lib/python2.5/config/libpython2.5.a(listobject.o)"
collect2: ld returned 1 exit status
apxs:Error: Command failed with rc=65536
.
gmake[1]: *** [mod_python.so] Error 1
gmake[1]: Leaving directory `/tmp/mod_python-3.3.1/src'
gmake: *** [do_dso] Error 2
#

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20080215/a4d835b9/attachment-0001.html
From graham.dumpleton at gmail.com  Fri Feb 15 19:00:56 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Fri Feb 15 19:01:10 2008
Subject: [mod_python] compiling on HPUX 11.11
In-Reply-To: <9FFAEC6056AE3D418CDA54F3FB38656B8A700F@VDCREXEVS01.orange.ch>
References: <9FFAEC6056AE3D418CDA54F3FB38656B8A700F@VDCREXEVS01.orange.ch>
Message-ID: <88e286470802151600g7628b21an2c45ed5c36982b1e@mail.gmail.com>

You probably aren't installing Python with a shared library and this
is causing problems with libtool. When configuring Python before
compilation, pass '--enable-shared' option to configure script. You
may also need to add symlink manually in Python config directory so
that compiler finds it next to Python static library.

For some comments about these sorts of issues, see mod_wsgi
documentation. Specifically section 'Lack Of Python Shared Library'.

  http://code.google.com/p/modwsgi/wiki/InstallationIssues

Similar sorts of issues exist for mod_python.

Graham

On 15/02/2008, Diener-Rodriguez Jan Raino Eerik
<jan.diener-rodriguez@orange.ch> wrote:
>
>
> Hello guys,
> I managed to compile python 2.5.1, which works fine but I don't get
> mod_python to compile on my HP box (see below)
>
> I am not a compiler/ing expert and it is well possible that I missed some
> obvious detail.. would appreciate any hint or direction where to find a
> possible solution to my problem.
>
> thanks
> jan
>
> === configure works, according to my little knowledge ===
> # pwd
> /tmp/mod_python-3.3.1
> # ./configure --with-apxs=/usr/local/apache2/bin/apxs
> --with-flex=/usr/local/bin/flex
> checking for gcc... gcc
> checking for C compiler default output file name... a.out
> checking whether the C compiler works... yes
> checking whether we are cross compiling... no
> checking for suffix of executables...
> checking for suffix of object files... o
> checking whether we are using the GNU C compiler... yes
> checking whether gcc accepts -g... yes
> checking for gcc option to accept ANSI C... none needed
> checking for ar... ar
> checking for a BSD-compatible install... ./install-sh -c
> checking whether make sets $(MAKE)... yes
> checking for main in -lm... yes
> checking for an ANSI C-conforming const... yes
> checking your blood pressure... a bit high, but we can proceed
> configure: checking whether apxs is available...
> checking for --with-apxs... /usr/local/apache2/bin/apxs executable, good
> checking Apache version... 2.0.63
> checking for Apache libexec directory... /usr/local/apache2/modules
> checking for Apache include directory... -I/usr/local/apache2/include
> checking for --with-python... no
> checking for python... /usr/bin/python
> checking Python version... 2.5
> checking Python install prefix... /usr/local
> checking checking where python libraries are installed...
> /usr/local/lib/python2.5
> checking for Py_NewInterpreter in -lpython2.5... yes
> checking what libraries Python was linked with... -lpython2.5   -lnsl -lrt
> -ldld    -lm
> checking linker flags used to link Python...
> checking where Python include files are... -I/usr/local/include/python2.5
> checking for --with-python-src... no
> checking for --with-mutex-dir... no
> Using MUTEX_DIR /tmp
> checking for --with-max-locks... no
> Using 8 MAX_LOCKS.
> checking for --with-flex... /usr/local/bin/flex
> found /usr/local/bin/flex, we'll use this. Use --with-flex to specify
> another.
> checking flex version... 2.5.34. Good
> configure: creating ./config.status
> config.status: creating Makefile
> config.status: creating src/Makefile
> config.status: creating Doc/Makefile
> config.status: creating src/include/mod_python.h
> config.status: creating test/Makefile
> config.status: creating test/testconf.py
> config.status: creating dist/setup.py
> config.status: creating dist/Makefile
> #
>
>
> === compiling - fails ====
>
> #  gmake
> gmake[1]: Entering directory `/tmp/mod_python-3.3.1/src'
>
> Compiling for DSO.
>
> /usr/local/apache2/bin/apxs -I/tmp/mod_python-3.3.1/src/include
> -I/usr/local/apache2/include -I/usr/local/include/python2.5 -c mod_python.c
> _apachemodule.c requestobject.c tableobject.c util.c serverobject.c
> connobject.c filterobject.c hlist.c hlistobject.c finfoobject.c
> -L/usr/local/lib/python2.5/config  -Wl,-E -Wl,+s      -lm
> -lpython2.5   -lnsl -lrt -ldld    -lm
> /usr/local/apache2/build/libtool --silent --mode=compile
> gcc -prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11
> -D_REENTRANT -D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread
> -I/usr/local/apache2/include  -I/usr/local/apache2/include
> -I/usr/local/apache2/include  -I/tmp/mod_python-3.3.1/src/include
> -I/usr/local/apache2/include -I/usr/local/include/python2.5  -c -o
> mod_python.lo mod_python.c && touch mod_python.slo
> In file included from
> /usr/local/include/python2.5/Python.h:8,
>                  from /tmp/mod_python-3.3.1/src/include/mod_python.h:80,
>                  from mod_python.c:28:
> /usr/local/include/python2.5/pyconfig.h:932:1: warning:
> "_POSIX_C_SOURCE" redefined
> <command-line>: warning: this is the location of the previous definition
> mod_python.c: In function 'python_init':
> mod_python.c:826: warning: initialization from incompatible pointer type
> mod_python.c: In function 'get_interpreter':
> mod_python.c:290: warning: passing argument 1 of 'make_obcallback' discards
> qualifiers from pointer target type
> /usr/local/apache2/build/libtool --silent --mode=compile
> gcc -prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11
> -D_REENTRANT -D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread
> -I/usr/local/apache2/include  -I/usr/local/apache2/include
> -I/usr/local/apache2/include  -I/tmp/mod_python-3.3.1/src/include
> -I/usr/local/apache2/include -I/usr/local/include/python2.5  -c -o
> _apachemodule.lo _apachemodule.c && touch _apachemodule.slo
> In file included from
> /usr/local/include/python2.5/Python.h:8,
>                  from /tmp/mod_python-3.3.1/src/include/mod_python.h:80,
>                  from _apachemodule.c:25:
> /usr/local/include/python2.5/pyconfig.h:932:1: warning:
> "_POSIX_C_SOURCE" redefined
> <command-line>: warning: this is the location of the previous definition
> /usr/local/apache2/build/libtool --silent --mode=compile
> gcc -prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11
> -D_REENTRANT -D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread
> -I/usr/local/apache2/include  -I/usr/local/apache2/include
> -I/usr/local/apache2/include  -I/tmp/mod_python-3.3.1/src/include
> -I/usr/local/apache2/include -I/usr/local/include/python2.5  -c -o
> requestobject.lo requestobject.c && touch requestobject.slo
> In file included from
> /usr/local/include/python2.5/Python.h:8,
>                  from /tmp/mod_python-3.3.1/src/include/mod_python.h:80,
>                  from requestobject.c:25:
> /usr/local/include/python2.5/pyconfig.h:932:1: warning:
> "_POSIX_C_SOURCE" redefined
> <command-line>: warning: this is the location of the previous definition
> /usr/local/apache2/build/libtool --silent --mode=compile
> gcc -prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11
> -D_REENTRANT -D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread
> -I/usr/local/apache2/include  -I/usr/local/apache2/include
> -I/usr/local/apache2/include  -I/tmp/mod_python-3.3.1/src/include
> -I/usr/local/apache2/include -I/usr/local/include/python2.5  -c -o
> tableobject.lo tableobject.c && touch tableobject.slo
> In file included from
> /usr/local/include/python2.5/Python.h:8,
>                  from /tmp/mod_python-3.3.1/src/include/mod_python.h:80,
>                  from tableobject.c:25:
> /usr/local/include/python2.5/pyconfig.h:932:1: warning:
> "_POSIX_C_SOURCE" redefined
> <command-line>: warning: this is the location of the previous definition
> tableobject.c:329: warning: initialization from incompatible pointer type
> tableobject.c:1092: warning: initialization from incompatible pointer type
> /usr/local/apache2/build/libtool --silent --mode=compile
> gcc -prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11
> -D_REENTRANT -D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread
> -I/usr/local/apache2/include  -I/usr/local/apache2/include
> -I/usr/local/apache2/include  -I/tmp/mod_python-3.3.1/src/include
> -I/usr/local/apache2/include -I/usr/local/include/python2.5  -c -o util.lo
> util.c && touch util.slo
> In file included from
> /usr/local/include/python2.5/Python.h:8,
>                  from /tmp/mod_python-3.3.1/src/include/mod_python.h:80,
>                  from util.c:28:
> /usr/local/include/python2.5/pyconfig.h:932:1: warning:
> "_POSIX_C_SOURCE" redefined
> <command-line>: warning: this is the location of the previous definition
> /usr/local/apache2/build/libtool --silent --mode=compile
> gcc -prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11
> -D_REENTRANT -D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread
> -I/usr/local/apache2/include  -I/usr/local/apache2/include
> -I/usr/local/apache2/include  -I/tmp/mod_python-3.3.1/src/include
> -I/usr/local/apache2/include -I/usr/local/include/python2.5  -c -o
> serverobject.lo serverobject.c && touch serverobject.slo
> In file included from
> /usr/local/include/python2.5/Python.h:8,
>                  from /tmp/mod_python-3.3.1/src/include/mod_python.h:80,
>                  from serverobject.c:25:
> /usr/local/include/python2.5/pyconfig.h:932:1: warning:
> "_POSIX_C_SOURCE" redefined
> <command-line>: warning: this is the location of the previous definition
> serverobject.c:387: warning: initialization from incompatible pointer type
> /usr/local/apache2/build/libtool --silent --mode=compile
> gcc -prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11
> -D_REENTRANT -D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread
> -I/usr/local/apache2/include  -I/usr/local/apache2/include
> -I/usr/local/apache2/include  -I/tmp/mod_python-3.3.1/src/include
> -I/usr/local/apache2/include -I/usr/local/include/python2.5  -c -o
> connobject.lo connobject.c && touch connobject.slo
> In file included from
> /usr/local/include/python2.5/Python.h:8,
>                  from /tmp/mod_python-3.3.1/src/include/mod_python.h:80,
>                  from connobject.c:30:
> /usr/local/include/python2.5/pyconfig.h:932:1: warning:
> "_POSIX_C_SOURCE" redefined
> <command-line>: warning: this is the location of the previous definition
> /usr/local/apache2/build/libtool --silent --mode=compile
> gcc -prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11
> -D_REENTRANT -D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread
> -I/usr/local/apache2/include  -I/usr/local/apache2/include
> -I/usr/local/apache2/include  -I/tmp/mod_python-3.3.1/src/include
> -I/usr/local/apache2/include -I/usr/local/include/python2.5  -c -o
> filterobject.lo filterobject.c && touch filterobject.slo
> In file included from
> /usr/local/include/python2.5/Python.h:8,
>                  from /tmp/mod_python-3.3.1/src/include/mod_python.h:80,
>                  from filterobject.c:28:
> /usr/local/include/python2.5/pyconfig.h:932:1: warning:
> "_POSIX_C_SOURCE" redefined
> <command-line>: warning: this is the location of the previous definition
> /usr/local/apache2/build/libtool --silent --mode=compile
> gcc -prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11
> -D_REENTRANT -D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread
> -I/usr/local/apache2/include  -I/usr/local/apache2/include
> -I/usr/local/apache2/include  -I/tmp/mod_python-3.3.1/src/include
> -I/usr/local/apache2/include -I/usr/local/include/python2.5  -c -o hlist.lo
> hlist.c && touch hlist.slo
> In file included from
> /usr/local/include/python2.5/Python.h:8,
>                  from /tmp/mod_python-3.3.1/src/include/mod_python.h:80,
>                  from hlist.c:28:
> /usr/local/include/python2.5/pyconfig.h:932:1: warning:
> "_POSIX_C_SOURCE" redefined
> <command-line>: warning: this is the location of the previous definition
> /usr/local/apache2/build/libtool --silent --mode=compile
> gcc -prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11
> -D_REENTRANT -D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread
> -I/usr/local/apache2/include  -I/usr/local/apache2/include
> -I/usr/local/apache2/include  -I/tmp/mod_python-3.3.1/src/include
> -I/usr/local/apache2/include -I/usr/local/include/python2.5  -c -o
> hlistobject.lo hlistobject.c && touch hlistobject.slo
> In file included from
> /usr/local/include/python2.5/Python.h:8,
>                  from /tmp/mod_python-3.3.1/src/include/mod_python.h:80,
>                  from hlistobject.c:28:
> /usr/local/include/python2.5/pyconfig.h:932:1: warning:
> "_POSIX_C_SOURCE" redefined
> <command-line>: warning: this is the location of the previous definition
> /usr/local/apache2/build/libtool --silent --mode=compile
> gcc -prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11
> -D_REENTRANT -D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread
> -I/usr/local/apache2/include  -I/usr/local/apache2/include
> -I/usr/local/apache2/include  -I/tmp/mod_python-3.3.1/src/include
> -I/usr/local/apache2/include -I/usr/local/include/python2.5  -c -o
> finfoobject.lo finfoobject.c && touch finfoobject.slo
> In file included from
> /usr/local/include/python2.5/Python.h:8,
>                  from /tmp/mod_python-3.3.1/src/include/mod_python.h:80,
>                  from finfoobject.c:25:
> /usr/local/include/python2.5/pyconfig.h:932:1: warning:
> "_POSIX_C_SOURCE" redefined
> <command-line>: warning: this is the location of the previous definition
> finfoobject.c:278: warning: 'intargfunc' is deprecated
> finfoobject.c:278: warning: initialization from incompatible pointer type
> /usr/local/apache2/build/libtool --silent --mode=link gcc
> -o mod_python.la  -rpath /usr/local/apache2/modules -module
> -avoid-version    finfoobject.lo hlistobject.lo hlist.lo filterobject.lo
> connobject.lo serverobject.lo util.lo tableobject.lo requestobject.lo
> _apachemodule.lo mod_python.lo
> -L/usr/local/lib/python2.5/config -Wl,-E -Wl,+s -lm
> -lpython2.5 -lnsl -lrt -ldld -lm
> /usr/ccs/bin/ld: Invalid loader fixup in text space needed in output file
> for symbol "_PyEval_SliceIndex" in input file
> "/usr/local/lib/python2.5/config/libpython2.5.a(listobject.o)"
> collect2: ld returned 1 exit status
> apxs:Error: Command failed with rc=65536
> .
> gmake[1]: *** [mod_python.so] Error 1
> gmake[1]: Leaving directory `/tmp/mod_python-3.3.1/src'
> gmake: *** [do_dso] Error 2
> #
>
> _______________________________________________
>  Mod_python mailing list
>  Mod_python@modpython.org
>  http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
From hagopnarsesian at yahoo.com  Mon Feb 18 07:13:33 2008
From: hagopnarsesian at yahoo.com (Hagop Narsesian)
Date: Mon Feb 18 07:13:41 2008
Subject: [mod_python] Permissions issue
Message-ID: <582230.70551.qm@web63603.mail.re1.yahoo.com>

Dear all,
  I have a problem I can't seem to get my head around, I'm hoping this is common enough for someone to have a standard reply! I have a Python-Pygresql-Postgresql-Apache-Mod_python setup and have  aproblem connecting to the postgresql database. I believe this is a mod_python issue specifically because the same code works fine as pure Python code accessing Postgresql through Pygresql.
   
  There is a shopping basket on a pure html page which sends form data to a mod_python coded page and the following error message is received with apache's debug feature on. This identical code worked on a windows system, and the same connection code works fine as a pure Python module on the said machine. In httpd.conf, the user is Apache and the group is Apache.
   
  I've tried every experiment I can think of. Can anyone help?
  Hagop  
   
  MOD_PYTHON ERROR

ProcessId:      891
Interpreter:    '127.0.0.1'

ServerName:     '127.0.0.1'
DocumentRoot:   '/var/www/html'

URI:            '/csp2/cart.py/p1'
Location:       None
Directory:      None
Filename:       '/var/www/html/csp2/cart.py'
PathInfo:       '/p1'

Phase:          'PythonHandler'
Handler:        'mod_python.publisher'

Traceback (most recent call last):

  File "/usr/lib/python2.5/site-packages/mod_python/importer.py", line 1537, in HandlerDispatch
    default=default_handler, arg=req, silent=hlist.silent)

  File "/usr/lib/python2.5/site-packages/mod_python/importer.py", line 1229, in _process_target
    result = _execute_target(config, req, object, arg)

  File "/usr/lib/python2.5/site-packages/mod_python/importer.py", line 1128, in _execute_target
    result = object(arg)

  File "/usr/lib/python2.5/site-packages/mod_python/publisher.py", line 204, in handler
    module = page_cache[req]

  File "/usr/lib/python2.5/site-packages/mod_python/importer.py", line 1059, in __getitem__
    return import_module(req.filename)

  File "/usr/lib/python2.5/site-packages/mod_python/importer.py", line 296, in import_module
    log, import_path)

  File "/usr/lib/python2.5/site-packages/mod_python/importer.py", line 680, in import_module
    execfile(file, module.__dict__)

  File "/var/www/html/csp2/cart.py", line 3, in <module>
    rs=rsw.rsc()

  File "/var/www/html/csp2/rsw.py", line 7, in __init__
    self.db=pg.connect(dbname='postgres',user='a_super_user',passwd='a_password',host='localhost',port=5432)

InternalError: could not connect to server: Permission denied
 Is the server running on host "localhost" and accepting
 TCP/IP connections on port 5432?



MODULE CACHE DETAILS

Accessed:       Mon Feb 18 12:04:11 2008
Generation:     0

_mp_85c706a52797631fd526e880ea631520 {
  FileName:     '/var/www/html/csp2/cart.py'
  Instance:     1 [IMPORT]
  Generation:   0 [ERROR]
  Modified:     Sat Aug  4 18:34:30 2007
  Children:     '/var/www/html/csp2/rsw.py',
                '/var/www/html/csp2/web_templates.py'
}

_mp_040d2e7b309cbc54463a95573b512c94 {
  FileName:     '/var/www/html/csp2/rsw.py'
  Instance:     1 [IMPORT]
  Generation:   2
  Modified:     Thu Feb 14 15:32:52 2008
  Imported:     Mon Feb 18 12:04:11 2008
}

_mp_7893a0b888652c1d2565a1ac1016c7e4 {
  FileName:     '/var/www/html/csp2/web_templates.py'
  Instance:     1 [IMPORT]
  Generation:   1
  Modified:     Sat Aug  4 21:15:48 2007
  Imported:     Mon Feb 18 12:04:11 2008

   
   

       
---------------------------------
Looking for last minute shopping deals?  Find them fast with Yahoo! Search.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20080218/5b402a2f/attachment.html
From clodoaldo.pinto.neto at gmail.com  Mon Feb 18 08:12:48 2008
From: clodoaldo.pinto.neto at gmail.com (Clodoaldo)
Date: Mon Feb 18 08:12:53 2008
Subject: [mod_python] Permissions issue
In-Reply-To: <582230.70551.qm@web63603.mail.re1.yahoo.com>
References: <582230.70551.qm@web63603.mail.re1.yahoo.com>
Message-ID: <a595de7a0802180512w1fba540frc32b2b624aadad68@mail.gmail.com>

2008/2/18, Hagop Narsesian <hagopnarsesian@yahoo.com>:
> Dear all,
> I have a problem I can't seem to get my head around, I'm hoping this is
> common enough for someone to have a standard reply! I have a
> Python-Pygresql-Postgresql-Apache-Mod_python setup and have
>  aproblem connecting to the postgresql database. I believe this is a
> mod_python issue specifically because the same code works fine as pure
> Python code accessing Postgresql through Pygresql.
>
> There is a shopping basket on a pure html page which sends form data to a
> mod_python coded page and the following error message is received with
> apache's debug feature on. This identical code worked on a windows system,
> and the same connection code works fine as a pure Python module on the said
> machine. In httpd.conf, the user is Apache and the group is Apache.
>
> I've tried every experiment I can think of. Can anyone help?
> Hagop
>
> MOD_PYTHON ERROR
>
> ProcessId:      891
> Interpreter:    '127.0.0.1'
>
> ServerName:     '127.0.0.1'
> DocumentRoot:   '/var/www/html'
>
> URI:            '/csp2/cart.py/p1'
> Location:       None
> Directory:      None
> Filename:       '/var/www/html/csp2/cart.py'
> PathInfo:       '/p1'
>
> Phase:          'PythonHandler'
> Handler:        'mod_python.publisher'
>
> Traceback (most recent call last):
>
>   File
> "/usr/lib/python2.5/site-packages/mod_python/importer.py",
> line 1537, in HandlerDispatch
>     default=default_handler, arg=req, silent=hlist.silent)
>
>   File
> "/usr/lib/python2.5/site-packages/mod_python/importer.py",
> line 1229, in _process_target
>     result = _execute_target(config, req, object, arg)
>
>   File
> "/usr/lib/python2.5/site-packages/mod_python/importer.py",
> line 1128, in _execute_target
>     result = object(arg)
>
>   File
> "/usr/lib/python2.5/site-packages/mod_python/publisher.py",
> line 204, in handler
>     module = page_cache[req]
>
>   File
> "/usr/lib/python2.5/site-packages/mod_python/importer.py",
> line 1059, in __getitem__
>     return import_module(req.filename)
>
>   File
> "/usr/lib/python2.5/site-packages/mod_python/importer.py",
> line 296, in import_module
>     log, import_path)
>
>   File
> "/usr/lib/python2.5/site-packages/mod_python/importer.py",
> line 680, in import_module
>     execfile(file, module.__dict__)
>
>   File "/var/www/html/csp2/cart.py", line 3, in <module>
>     rs=rsw.rsc()
>
>   File "/var/www/html/csp2/rsw.py", line 7, in __init__
>
> self.db=pg.connect(dbname='postgres',user='a_super_user',passwd='a_password',host='localhost',port=5432)
>
> InternalError: could not connect to server: Permission denied
>  Is the server running on host "localhost" and accepting
>  TCP/IP connections on port 5432?
>
>
>
> MODULE CACHE DETAILS
>
> Accessed:       Mon Feb 18 12:04:11 2008
> Generation:     0
>
> _mp_85c706a52797631fd526e880ea631520 {
>   FileName:     '/var/www/html/csp2/cart.py'
>   Instance:     1 [IMPORT]
>   Generation:   0 [ERROR]
>   Modified:     Sat Aug  4 18:34:30 2007
>   Children:     '/var/www/html/csp2/rsw.py',
>                 '/var/www/html/csp2/web_templates.py'
> }
>
> _mp_040d2e7b309cbc54463a95573b512c94 {
>   FileName:     '/var/www/html/csp2/rsw.py'
>   Instance:     1 [IMPORT]
>   Generation:   2
>   Modified:     Thu Feb 14 15:32:52 2008
>   Imported:     Mon Feb 18 12:04:11 2008
> }
>
> _mp_7893a0b888652c1d2565a1ac1016c7e4 {
>   FileName:     '/var/www/html/csp2/web_templates.py'
>   Instance:     1 [IMPORT]
>   Generation:   1
>   Modified:     Sat Aug  4 21:15:48 2007
>   Imported:     Mon Feb 18 12:04:11 2008

Do you have a line starting with 'host' (tcp-ip) in addition to the
line starting with 'local' (unix socket) in the pg_hba.conf file for
that user?

How is your listen_addresses parameter in postgresql.conf configured?

Regards, Clodoaldo Pinto Neto
From gwidion at mpc.com.br  Mon Feb 18 08:14:16 2008
From: gwidion at mpc.com.br (Joao S. O. Bueno)
Date: Mon Feb 18 08:14:26 2008
Subject: [mod_python] Permissions issue
In-Reply-To: <582230.70551.qm@web63603.mail.re1.yahoo.com>
References: <582230.70551.qm@web63603.mail.re1.yahoo.com>
Message-ID: <200802181014.17292.gwidion@mpc.com.br>

Hi,
sorry if I won't dig in deph in your problem, but this binding you are using 
to postgresql - pygresql, is not the most widey used one is it?
Is it thread safe? Maybe your probem lies therein.  

You could try using another python-postgresq biding, such as Psycopg  and see 
if you get any improvements.

regards,	

	js
	-><-


On Mon 18 Feb 2008 09:13:33 Hagop Narsesian wrote:
> Dear all,
>   I have a problem I can't seem to get my head around, I'm hoping this is
> common enough for someone to have a standard reply! I have a
> Python-Pygresql-Postgresql-Apache-Mod_python setup and have  aproblem
> connecting to the postgresql database. I believe this is a mod_python issue
> specifically because the same code works fine as pure Python code accessing
> Postgresql through Pygresql.
>
>   There is a shopping basket on a pure html page which sends form data to a
> mod_python coded page and the following error message is received with
> apache's debug feature on. This identical code worked on a windows system,
> and the same connection code works fine as a pure Python module on the said
> machine. In httpd.conf, the user is Apache and the group is Apache.
>
>   I've tried every experiment I can think of. Can anyone help?
>   Hagop
>
>   MOD_PYTHON ERROR
>
> ProcessId:      891
> Interpreter:    '127.0.0.1'
>
> ServerName:     '127.0.0.1'
> DocumentRoot:   '/var/www/html'
>
> URI:            '/csp2/cart.py/p1'
> Location:       None
> Directory:      None
> Filename:       '/var/www/html/csp2/cart.py'
> PathInfo:       '/p1'
>
> Phase:          'PythonHandler'
> Handler:        'mod_python.publisher'
>
> Traceback (most recent call last):
>
>   File "/usr/lib/python2.5/site-packages/mod_python/importer.py", line
> 1537, in HandlerDispatch default=default_handler, arg=req,
> silent=hlist.silent)
>
>   File "/usr/lib/python2.5/site-packages/mod_python/importer.py", line
> 1229, in _process_target result = _execute_target(config, req, object, arg)
>
>   File "/usr/lib/python2.5/site-packages/mod_python/importer.py", line
> 1128, in _execute_target result = object(arg)
>
>   File "/usr/lib/python2.5/site-packages/mod_python/publisher.py", line
> 204, in handler module = page_cache[req]
>
>   File "/usr/lib/python2.5/site-packages/mod_python/importer.py", line
> 1059, in __getitem__ return import_module(req.filename)
>
>   File "/usr/lib/python2.5/site-packages/mod_python/importer.py", line 296,
> in import_module log, import_path)
>
>   File "/usr/lib/python2.5/site-packages/mod_python/importer.py", line 680,
> in import_module execfile(file, module.__dict__)
>
>   File "/var/www/html/csp2/cart.py", line 3, in <module>
>     rs=rsw.rsc()
>
>   File "/var/www/html/csp2/rsw.py", line 7, in __init__
>    
> self.db=pg.connect(dbname='postgres',user='a_super_user',passwd='a_password
>',host='localhost',port=5432)
>
> InternalError: could not connect to server: Permission denied
>  Is the server running on host "localhost" and accepting
>  TCP/IP connections on port 5432?
>
>
>
> MODULE CACHE DETAILS
>
> Accessed:       Mon Feb 18 12:04:11 2008
> Generation:     0
>
> _mp_85c706a52797631fd526e880ea631520 {
>   FileName:     '/var/www/html/csp2/cart.py'
>   Instance:     1 [IMPORT]
>   Generation:   0 [ERROR]
>   Modified:     Sat Aug  4 18:34:30 2007
>   Children:     '/var/www/html/csp2/rsw.py',
>                 '/var/www/html/csp2/web_templates.py'
> }
>
> _mp_040d2e7b309cbc54463a95573b512c94 {
>   FileName:     '/var/www/html/csp2/rsw.py'
>   Instance:     1 [IMPORT]
>   Generation:   2
>   Modified:     Thu Feb 14 15:32:52 2008
>   Imported:     Mon Feb 18 12:04:11 2008
> }
>
> _mp_7893a0b888652c1d2565a1ac1016c7e4 {
>   FileName:     '/var/www/html/csp2/web_templates.py'
>   Instance:     1 [IMPORT]
>   Generation:   1
>   Modified:     Sat Aug  4 21:15:48 2007
>   Imported:     Mon Feb 18 12:04:11 2008
>
>
>
>
>
> ---------------------------------
> Looking for last minute shopping deals?  Find them fast with Yahoo! Search.


From hagopnarsesian at yahoo.com  Tue Feb 19 05:25:07 2008
From: hagopnarsesian at yahoo.com (Hagop Narsesian)
Date: Tue Feb 19 05:25:15 2008
Subject: [mod_python] Permissions issue
In-Reply-To: <a595de7a0802180512w1fba540frc32b2b624aadad68@mail.gmail.com>
Message-ID: <650278.1935.qm@web63602.mail.re1.yahoo.com>

Dear Clodoaldo,
  I experimented with pg_hba.conf for a while but it is of no avail. The following are the entries in my pg_hba.conf file:
   
  #local (unix domain sockets)
  local all all (blank) password all
  #IPv4
  host all all 127.0.0.1/32 password all
  host all all 0.0.0.0/0 password all
  #IPv6 - no entries here
   
  I had trust initially for the local but that doesn't seem to make a difference (and I don't see why it should as I'm providing a password anyway).
  I'll fiddle about more with this, but I haven't had much success so far!
  Any other thoughts?
  Thanks,
  Hagop
  

Clodoaldo <clodoaldo.pinto.neto@gmail.com> wrote:
  2008/2/18, Hagop Narsesian :
> Dear all,
> I have a problem I can't seem to get my head around, I'm hoping this is
> common enough for someone to have a standard reply! I have a
> Python-Pygresql-Postgresql-Apache-Mod_python setup and have
> aproblem connecting to the postgresql database. I believe this is a
> mod_python issue specifically because the same code works fine as pure
> Python code accessing Postgresql through Pygresql.
>
> There is a shopping basket on a pure html page which sends form data to a
> mod_python coded page and the following error message is received with
> apache's debug feature on. This identical code worked on a windows system,
> and the same connection code works fine as a pure Python module on the said
> machine. In httpd.conf, the user is Apache and the group is Apache.
>
> I've tried every experiment I can think of. Can anyone help?
> Hagop
>
> MOD_PYTHON ERROR
>
> ProcessId: 891
> Interpreter: '127.0.0.1'
>
> ServerName: '127.0.0.1'
> DocumentRoot: '/var/www/html'
>
> URI: '/csp2/cart.py/p1'
> Location: None
> Directory: None
> Filename: '/var/www/html/csp2/cart.py'
> PathInfo: '/p1'
>
> Phase: 'PythonHandler'
> Handler: 'mod_python.publisher'
>
> Traceback (most recent call last):
>
> File
> "/usr/lib/python2.5/site-packages/mod_python/importer.py",
> line 1537, in HandlerDispatch
> default=default_handler, arg=req, silent=hlist.silent)
>
> File
> "/usr/lib/python2.5/site-packages/mod_python/importer.py",
> line 1229, in _process_target
> result = _execute_target(config, req, object, arg)
>
> File
> "/usr/lib/python2.5/site-packages/mod_python/importer.py",
> line 1128, in _execute_target
> result = object(arg)
>
> File
> "/usr/lib/python2.5/site-packages/mod_python/publisher.py",
> line 204, in handler
> module = page_cache[req]
>
> File
> "/usr/lib/python2.5/site-packages/mod_python/importer.py",
> line 1059, in __getitem__
> return import_module(req.filename)
>
> File
> "/usr/lib/python2.5/site-packages/mod_python/importer.py",
> line 296, in import_module
> log, import_path)
>
> File
> "/usr/lib/python2.5/site-packages/mod_python/importer.py",
> line 680, in import_module
> execfile(file, module.__dict__)
>
> File "/var/www/html/csp2/cart.py", line 3, in 
> rs=rsw.rsc()
>
> File "/var/www/html/csp2/rsw.py", line 7, in __init__
>
> self.db=pg.connect(dbname='postgres',user='a_super_user',passwd='a_password',host='localhost',port=5432)
>
> InternalError: could not connect to server: Permission denied
> Is the server running on host "localhost" and accepting
> TCP/IP connections on port 5432?
>
>
>
> MODULE CACHE DETAILS
>
> Accessed: Mon Feb 18 12:04:11 2008
> Generation: 0
>
> _mp_85c706a52797631fd526e880ea631520 {
> FileName: '/var/www/html/csp2/cart.py'
> Instance: 1 [IMPORT]
> Generation: 0 [ERROR]
> Modified: Sat Aug 4 18:34:30 2007
> Children: '/var/www/html/csp2/rsw.py',
> '/var/www/html/csp2/web_templates.py'
> }
>
> _mp_040d2e7b309cbc54463a95573b512c94 {
> FileName: '/var/www/html/csp2/rsw.py'
> Instance: 1 [IMPORT]
> Generation: 2
> Modified: Thu Feb 14 15:32:52 2008
> Imported: Mon Feb 18 12:04:11 2008
> }
>
> _mp_7893a0b888652c1d2565a1ac1016c7e4 {
> FileName: '/var/www/html/csp2/web_templates.py'
> Instance: 1 [IMPORT]
> Generation: 1
> Modified: Sat Aug 4 21:15:48 2007
> Imported: Mon Feb 18 12:04:11 2008

Do you have a line starting with 'host' (tcp-ip) in addition to the
line starting with 'local' (unix socket) in the pg_hba.conf file for
that user?

How is your listen_addresses parameter in postgresql.conf configured?

Regards, Clodoaldo Pinto Neto


       
---------------------------------
Looking for last minute shopping deals?  Find them fast with Yahoo! Search.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20080219/4bf8327f/attachment.html
From hagopnarsesian at yahoo.com  Tue Feb 19 05:43:22 2008
From: hagopnarsesian at yahoo.com (Hagop Narsesian)
Date: Tue Feb 19 05:43:27 2008
Subject: [mod_python] Permissions issue
In-Reply-To: <003e01c87229$484b9e40$0200a8c0@TMSMAIN>
Message-ID: <490101.96888.qm@web63610.mail.re1.yahoo.com>

Tom,
  You were absolutely right, this is an SELinux issue. I had played around with chmods but was under the impression SELinux was not enforced. I temporarily turned it off with
   
  echo 0 >/selinux/enforce
   
  and everything works. Do you know specifically what I need to alter in order to be able to keep SELinux on? I am a complete novice at SELinux so this is terra incognita for me. Is the below command just an example or is httpd_sys_content_t*  what I need to target? Many thanks, it's a great relief after many hours of experimenting, even though i should have thought of this myself.
  Hagop

Tom Stambaugh <tms@zeetix.com> wrote:
  You don't say whether or not you're running a linux with selinux. If so, you 
might make sure you've set your selinux permissions accordingly. I use 
"ls -lZ" to look and see, and the following to change them (from some 
interesting root)

#chcon -R -h -t httpd_sys_content_t *

I assume you've already done the usual chmod experiments with no success.

----- Original Message ----- 
From: "Hagop Narsesian" 
To: 
Sent: Monday, February 18, 2008 7:13 AM
Subject: [mod_python] Permissions issue


> Dear all,
> I have a problem I can't seem to get my head around, I'm hoping this is 
> common enough for someone to have a standard reply! I have a 
> Python-Pygresql-Postgresql-Apache-Mod_python setup and have aproblem 
> connecting to the postgresql database. I believe this is a mod_python 
> issue specifically because the same code works fine as pure Python code 
> accessing Postgresql through Pygresql.
>
> There is a shopping basket on a pure html page which sends form data to a 
> mod_python coded page and the following error message is received with 
> apache's debug feature on. This identical code worked on a windows system, 
> and the same connection code works fine as a pure Python module on the 
> said machine. In httpd.conf, the user is Apache and the group is Apache.
>
> I've tried every experiment I can think of. Can anyone help?
> Hagop
>
> MOD_PYTHON ERROR
>
> ProcessId: 891
> Interpreter: '127.0.0.1'
>
> ServerName: '127.0.0.1'
> DocumentRoot: '/var/www/html'
>
> URI: '/csp2/cart.py/p1'
> Location: None
> Directory: None
> Filename: '/var/www/html/csp2/cart.py'
> PathInfo: '/p1'
>
> Phase: 'PythonHandler'
> Handler: 'mod_python.publisher'
>
> Traceback (most recent call last):
>
> File "/usr/lib/python2.5/site-packages/mod_python/importer.py", line 
> 1537, in HandlerDispatch
> default=default_handler, arg=req, silent=hlist.silent)
>
> File "/usr/lib/python2.5/site-packages/mod_python/importer.py", line 
> 1229, in _process_target
> result = _execute_target(config, req, object, arg)
>
> File "/usr/lib/python2.5/site-packages/mod_python/importer.py", line 
> 1128, in _execute_target
> result = object(arg)
>
> File "/usr/lib/python2.5/site-packages/mod_python/publisher.py", line 
> 204, in handler
> module = page_cache[req]
>
> File "/usr/lib/python2.5/site-packages/mod_python/importer.py", line 
> 1059, in __getitem__
> return import_module(req.filename)
>
> File "/usr/lib/python2.5/site-packages/mod_python/importer.py", line 296, 
> in import_module
> log, import_path)
>
> File "/usr/lib/python2.5/site-packages/mod_python/importer.py", line 680, 
> in import_module
> execfile(file, module.__dict__)
>
> File "/var/www/html/csp2/cart.py", line 3, in 
> rs=rsw.rsc()
>
> File "/var/www/html/csp2/rsw.py", line 7, in __init__
> 
> self.db=pg.connect(dbname='postgres',user='a_super_user',passwd='a_password',host='localhost',port=5432)
>
> InternalError: could not connect to server: Permission denied
> Is the server running on host "localhost" and accepting
> TCP/IP connections on port 5432?
>
>
>
> MODULE CACHE DETAILS
>
> Accessed: Mon Feb 18 12:04:11 2008
> Generation: 0
>
> _mp_85c706a52797631fd526e880ea631520 {
> FileName: '/var/www/html/csp2/cart.py'
> Instance: 1 [IMPORT]
> Generation: 0 [ERROR]
> Modified: Sat Aug 4 18:34:30 2007
> Children: '/var/www/html/csp2/rsw.py',
> '/var/www/html/csp2/web_templates.py'
> }
>
> _mp_040d2e7b309cbc54463a95573b512c94 {
> FileName: '/var/www/html/csp2/rsw.py'
> Instance: 1 [IMPORT]
> Generation: 2
> Modified: Thu Feb 14 15:32:52 2008
> Imported: Mon Feb 18 12:04:11 2008
> }
>
> _mp_7893a0b888652c1d2565a1ac1016c7e4 {
> FileName: '/var/www/html/csp2/web_templates.py'
> Instance: 1 [IMPORT]
> Generation: 1
> Modified: Sat Aug 4 21:15:48 2007
> Imported: Mon Feb 18 12:04:11 2008
>
>
>
>
>
> ---------------------------------
> Looking for last minute shopping deals? Find them fast with Yahoo! 
> Search.


--------------------------------------------------------------------------------


> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 





       
---------------------------------
Never miss a thing.   Make Yahoo your homepage.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20080219/b4edcc25/attachment.html
From kosa at heckler-koch.cz  Tue Feb 19 09:42:18 2008
From: kosa at heckler-koch.cz (kosa@heckler-koch.cz)
Date: Tue Feb 19 09:42:30 2008
Subject: [mod_python] debian etch: testing
Message-ID: <47BAEACA.8070801@heckler-koch.cz>

hi all

please, few days before, i was forced to made dist-upgrade on my debian 
etch, from stable to testing
but after this, i have a problem. Classic mod_python is working correct 
with apache. But unfortunately my work developing environment is not !

we are using, apache prefork and teng together with mod python. Here are 
my versions:

ii  apache2                              2.2.8-1                     
Next generation, scalable, extendable web se
ii  apache2-mpm-prefork                  2.2.8-1                     
Traditional model for Apache HTTPD
ii  apache2-utils                        2.2.8-1                     
utility programs for webservers
ii  apache2.2-common                     2.2.8-1                     
Next generation, scalable, extendable web se
ii  libapache2-mod-python                3.3.1-1                     
Apache 2 module that embeds Python within th
ii  libapache2-mod-python-doc            3.3.1-1                     
Apache 2 module that embeds Python within th

ii  libteng1                             1.0.12                      
Teng -- general purpose templating system

ii  python2.4                            2.4.4-7                     An 
interactive high-level object-oriented la
ii  python2.4-dbg                        2.4.4-7                     
Debug Build of the Python Interpreter (versi
ii  python2.4-fastrpc                    2.0.2                       
Fastrpc -- RPC using XML and Binary protocol
ii  python2.4-minimal                    2.4.4-7                     A 
minimal subset of the Python language (ver
ii  python2.4-teng                       1.0.0                       
Teng module for python
ii  szn-python2.4-dbglog                 1.1.7                       
Debug log library for python

this is the error message i am getting:

MOD_PYTHON ERROR

ProcessId:      22082
Interpreter:    '127.0.0.1'

ServerName:     '127.0.0.1'
DocumentRoot:   '/svn/stream/trunk/www'

URI:            '/'
Location:       None
Directory:      '/'
Filename:       '/svn/stream/trunk/www/'
PathInfo:       ''

Phase:          'PythonHandler'
Handler:        'mp_handler'

Traceback (most recent call last):

  File "/usr/lib/python2.4/site-packages/mod_python/importer.py", line 
1537, in HandlerDispatch
    default=default_handler, arg=req, silent=hlist.silent)

  File "/usr/lib/python2.4/site-packages/mod_python/importer.py", line 
1202, in _process_target
    module = import_module(module_name, path=path)

  File "/usr/lib/python2.4/site-packages/mod_python/importer.py", line 
304, in import_module
    return __import__(module_name, {}, {}, ['*'])


[all the paths are the same as before the dist-upgrade]
so please, if any has some experience with this problem, let me know. if 
this is not enough informations, i will post more.


thank you very much
pavel
From jrraines at comcast.net  Tue Feb 19 11:29:01 2008
From: jrraines at comcast.net (John Raines)
Date: Tue Feb 19 11:29:59 2008
Subject: [mod_python] Leopard Install
Message-ID: <57327B09-F9CD-44C6-BCE8-992872F264FD@comcast.net>

  I've been trying to install mod_python on Leopard on a G4; i think
  using a G4 means that I don't need to worry about the 64 bit issues

which have been discussed before. In the past macs have come with
apache 1.3 and python 2.3. Leopard comes with fairly current
versions and so I decided to use the built in version. I tried to
get rid of old pythons etc left over from Tiger etc. I installed
  with just ./configure, make, sudo make install. When I type httpd -S,
I get an error msg which I think means that there's a version
incompatibility between mod_python and apache. I'm not sure where  
this is going wrong.

  Details of the install :

Mac-in-basement:mod_python-3.3.1 jrraines$ ./configure
checking for gcc... gcc
checking for C compiler default output file name... a.out
checking whether the C compiler works... yes
checking whether we are cross compiling... no
checking for suffix of executables...
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether gcc accepts -g... yes
checking for gcc option to accept ANSI C... none needed
checking for ar... ar
checking for a BSD-compatible install... /usr/bin/install -c
checking whether make sets $(MAKE)... yes
checking for main in -lm... yes
checking for an ANSI C-conforming const... yes
checking your blood pressure... a bit high, but we can proceed
configure: checking whether apxs is available...
checking for --with-apxs... no
checking for apxs in /usr/local/apache/sbin... no
checking for apxs in your PATH... checking for apxs... /usr/sbin/apxs
found /usr/sbin/apxs, we'll use this. Use --with-apxs to specify =20
another.
checking Apache version... 2.2.6
checking for Apache libexec directory... /usr/libexec/apache2
checking for Apache include directory... -I/usr/include/apache2
checking for --with-python... no
checking for python... /usr/bin/python
checking Python version... 2.5
checking Python install prefix... /System/Library/Frameworks/=20
Python.framework/Versions/2.5
checking checking where python libraries are installed... /System/=20
Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5
checking what libraries Python was linked with... -framework  =20
Python    -ldl
checking linker flags used to link Python...
checking where Python include files are... -I/System/Library/=20
Frameworks/Python.framework/Versions/2.5/include/python2.5
checking for --with-python-src... no
checking for --with-mutex-dir... no
Using MUTEX_DIR /tmp
checking for --with-max-locks... no
Using 8 MAX_LOCKS.
checking for --with-flex... no
checking for flex... /usr/bin/flex
found /usr/bin/flex, we'll use this. Use --with-flex to specify another.
checking flex version... 2.5.33. Good
configure: creating ./config.status
config.status: creating Makefile
config.status: creating src/Makefile
config.status: creating Doc/Makefile
config.status: creating src/include/mod_python.h
config.status: creating test/Makefile
config.status: creating test/testconf.py
config.status: creating dist/setup.py
config.status: creating dist/Makefile
Mac-in-basement:mod_python-3.3.1 jrraines$ make

Compiling for DSO.

/usr/sbin/apxs -I/Users/jrraines/Downloads/mod_python-3.3.1/src/=20
include -I/usr/include/apache2 -I/System/Library/Frameworks/=20
Python.framework/Versions/2.5/include/python2.5 -c mod_python.c =20
_apachemodule.c requestobject.c tableobject.c util.c serverobject.c =20
connobject.c filterobject.c hlist.c hlistobject.c finfoobject.c -Wl,-=20
framework,Python  -u _PyMac_Error -framework Python   -Wl,-F.   -lm  - 
=20=

framework  Python    -ldl
/usr/share/apr-1/build-1/libtool --silent --mode=3Dcompile gcc    -=20
DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp  -I/usr/ 
include/=20=

apache2  -I/usr/include/apr-1   -I/usr/include/apr-1  -I/Users/=20
jrraines/Downloads/mod_python-3.3.1/src/include -I/usr/include/ 
apache2 =20=

-I/System/Library/Frameworks/Python.framework/Versions/2.5/include/=20
python2.5  -c -o mod_python.lo mod_python.c && touch mod_python.slo
mod_python.c: In function 'python_init':
mod_python.c:826: warning: initialization from incompatible pointer type
/usr/share/apr-1/build-1/libtool --silent --mode=3Dcompile gcc    -=20
DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp  -I/usr/ 
include/=20=

apache2  -I/usr/include/apr-1   -I/usr/include/apr-1  -I/Users/=20
jrraines/Downloads/mod_python-3.3.1/src/include -I/usr/include/ 
apache2 =20=

-I/System/Library/Frameworks/Python.framework/Versions/2.5/include/=20
python2.5  -c -o _apachemodule.lo _apachemodule.c && touch =20
_apachemodule.slo
/usr/share/apr-1/build-1/libtool --silent --mode=3Dcompile gcc    -=20
DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp  -I/usr/ 
include/=20=

apache2  -I/usr/include/apr-1   -I/usr/include/apr-1  -I/Users/=20
jrraines/Downloads/mod_python-3.3.1/src/include -I/usr/include/ 
apache2 =20=

-I/System/Library/Frameworks/Python.framework/Versions/2.5/include/=20
python2.5  -c -o requestobject.lo requestobject.c && touch =20
requestobject.slo
/usr/share/apr-1/build-1/libtool --silent --mode=3Dcompile gcc    -=20
DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp  -I/usr/ 
include/=20=

apache2  -I/usr/include/apr-1   -I/usr/include/apr-1  -I/Users/=20
jrraines/Downloads/mod_python-3.3.1/src/include -I/usr/include/ 
apache2 =20=

-I/System/Library/Frameworks/Python.framework/Versions/2.5/include/=20
python2.5  -c -o tableobject.lo tableobject.c && touch tableobject.slo
tableobject.c:329: warning: initialization from incompatible pointer =20
type
tableobject.c:1092: warning: initialization from incompatible pointer  
=20=

type
/usr/share/apr-1/build-1/libtool --silent --mode=3Dcompile gcc    -=20
DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp  -I/usr/ 
include/=20=

apache2  -I/usr/include/apr-1   -I/usr/include/apr-1  -I/Users/=20
jrraines/Downloads/mod_python-3.3.1/src/include -I/usr/include/ 
apache2 =20=

-I/System/Library/Frameworks/Python.framework/Versions/2.5/include/=20
python2.5  -c -o util.lo util.c && touch util.slo
/usr/share/apr-1/build-1/libtool --silent --mode=3Dcompile gcc    -=20
DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp  -I/usr/ 
include/=20=

apache2  -I/usr/include/apr-1   -I/usr/include/apr-1  -I/Users/=20
jrraines/Downloads/mod_python-3.3.1/src/include -I/usr/include/ 
apache2 =20=

-I/System/Library/Frameworks/Python.framework/Versions/2.5/include/=20
python2.5  -c -o serverobject.lo serverobject.c && touch =20
serverobject.slo
serverobject.c:387: warning: initialization from incompatible pointer  
=20=

type
/usr/share/apr-1/build-1/libtool --silent --mode=3Dcompile gcc    -=20
DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp  -I/usr/ 
include/=20=

apache2  -I/usr/include/apr-1   -I/usr/include/apr-1  -I/Users/=20
jrraines/Downloads/mod_python-3.3.1/src/include -I/usr/include/ 
apache2 =20=

-I/System/Library/Frameworks/Python.framework/Versions/2.5/include/=20
python2.5  -c -o connobject.lo connobject.c && touch connobject.slo
/usr/share/apr-1/build-1/libtool --silent --mode=3Dcompile gcc    -=20
DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp  -I/usr/ 
include/=20=

apache2  -I/usr/include/apr-1   -I/usr/include/apr-1  -I/Users/=20
jrraines/Downloads/mod_python-3.3.1/src/include -I/usr/include/ 
apache2 =20=

-I/System/Library/Frameworks/Python.framework/Versions/2.5/include/=20
python2.5  -c -o filterobject.lo filterobject.c && touch =20
filterobject.slo
/usr/share/apr-1/build-1/libtool --silent --mode=3Dcompile gcc    -=20
DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp  -I/usr/ 
include/=20=

apache2  -I/usr/include/apr-1   -I/usr/include/apr-1  -I/Users/=20
jrraines/Downloads/mod_python-3.3.1/src/include -I/usr/include/ 
apache2 =20=

-I/System/Library/Frameworks/Python.framework/Versions/2.5/include/=20
python2.5  -c -o hlist.lo hlist.c && touch hlist.slo
/usr/share/apr-1/build-1/libtool --silent --mode=3Dcompile gcc    -=20
DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp  -I/usr/ 
include/=20=

apache2  -I/usr/include/apr-1   -I/usr/include/apr-1  -I/Users/=20
jrraines/Downloads/mod_python-3.3.1/src/include -I/usr/include/ 
apache2 =20=

-I/System/Library/Frameworks/Python.framework/Versions/2.5/include/=20
python2.5  -c -o hlistobject.lo hlistobject.c && touch hlistobject.slo
/usr/share/apr-1/build-1/libtool --silent --mode=3Dcompile gcc    -=20
DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp  -I/usr/ 
include/=20=

apache2  -I/usr/include/apr-1   -I/usr/include/apr-1  -I/Users/=20
jrraines/Downloads/mod_python-3.3.1/src/include -I/usr/include/ 
apache2 =20=

-I/System/Library/Frameworks/Python.framework/Versions/2.5/include/=20
python2.5  -c -o finfoobject.lo finfoobject.c && touch finfoobject.slo
finfoobject.c:278: warning: 'intargfunc' is deprecated
finfoobject.c:278: warning: initialization from incompatible pointer =20
type
/usr/share/apr-1/build-1/libtool --silent --mode=3Dlink gcc -o =20
mod_python.la  -rpath /usr/libexec/apache2 -module -avoid-version    =20
finfoobject.lo hlistobject.lo hlist.lo filterobject.lo connobject.lo =20
serverobject.lo util.lo tableobject.lo requestobject.lo =20
_apachemodule.lo mod_python.lo -Wl,-framework,Python -u _PyMac_Error - 
=20=

framework Python -Wl,-F. -lm -framework Python -ldl
ln -s ../lib/python/mod_python mod_python
ln -s ../src src
make[2]: `psp_parser.c' is up to date.
/usr/bin/python setup.py build
running build
running build_py
creating build
creating build/lib.macosx-10.5-ppc-2.5
creating build/lib.macosx-10.5-ppc-2.5/mod_python
copying /Users/jrraines/Downloads/mod_python-3.3.1/lib/python/=20
mod_python/__init__.py -> build/lib.macosx-10.5-ppc-2.5/mod_python
copying /Users/jrraines/Downloads/mod_python-3.3.1/lib/python/=20
mod_python/apache.py -> build/lib.macosx-10.5-ppc-2.5/mod_python
copying /Users/jrraines/Downloads/mod_python-3.3.1/lib/python/=20
mod_python/cache.py -> build/lib.macosx-10.5-ppc-2.5/mod_python
copying /Users/jrraines/Downloads/mod_python-3.3.1/lib/python/=20
mod_python/cgihandler.py -> build/lib.macosx-10.5-ppc-2.5/mod_python
copying /Users/jrraines/Downloads/mod_python-3.3.1/lib/python/=20
mod_python/Cookie.py -> build/lib.macosx-10.5-ppc-2.5/mod_python
copying /Users/jrraines/Downloads/mod_python-3.3.1/lib/python/=20
mod_python/importer.py -> build/lib.macosx-10.5-ppc-2.5/mod_python
copying /Users/jrraines/Downloads/mod_python-3.3.1/lib/python/=20
mod_python/psp.py -> build/lib.macosx-10.5-ppc-2.5/mod_python
copying /Users/jrraines/Downloads/mod_python-3.3.1/lib/python/=20
mod_python/publisher.py -> build/lib.macosx-10.5-ppc-2.5/mod_python
copying /Users/jrraines/Downloads/mod_python-3.3.1/lib/python/=20
mod_python/python22.py -> build/lib.macosx-10.5-ppc-2.5/mod_python
copying /Users/jrraines/Downloads/mod_python-3.3.1/lib/python/=20
mod_python/Session.py -> build/lib.macosx-10.5-ppc-2.5/mod_python
copying /Users/jrraines/Downloads/mod_python-3.3.1/lib/python/=20
mod_python/testhandler.py -> build/lib.macosx-10.5-ppc-2.5/mod_python
copying /Users/jrraines/Downloads/mod_python-3.3.1/lib/python/=20
mod_python/util.py -> build/lib.macosx-10.5-ppc-2.5/mod_python
running build_ext
building 'mod_python._psp' extension
creating build/temp.macosx-10.5-ppc-2.5
creating build/temp.macosx-10.5-ppc-2.5/Users
creating build/temp.macosx-10.5-ppc-2.5/Users/jrraines
creating build/temp.macosx-10.5-ppc-2.5/Users/jrraines/Downloads
creating build/temp.macosx-10.5-ppc-2.5/Users/jrraines/Downloads/=20
mod_python-3.3.1
creating build/temp.macosx-10.5-ppc-2.5/Users/jrraines/Downloads/=20
mod_python-3.3.1/src
gcc -fno-strict-aliasing -Wno-long-double -no-cpp-precomp -mno-fused-=20
madd -fno-common -dynamic -DNDEBUG -g -Os -Wall -Wstrict-prototypes -=20
DMACOSX -I/usr/include/ffi -DENABLE_DTRACE -arch i386 -arch ppc -pipe  
-=20=

I/Users/jrraines/Downloads/mod_python-3.3.1/src/include -I/System/=20
Library/Frameworks/Python.framework/Versions/2.5/include/python2.5 - 
c /=20=

Users/jrraines/Downloads/mod_python-3.3.1/src/psp_string.c -o build/=20
temp.macosx-10.5-ppc-2.5/Users/jrraines/Downloads/mod_python-3.3.1/ 
src/=20=

psp_string.o
gcc -fno-strict-aliasing -Wno-long-double -no-cpp-precomp -mno-fused-=20
madd -fno-common -dynamic -DNDEBUG -g -Os -Wall -Wstrict-prototypes -=20
DMACOSX -I/usr/include/ffi -DENABLE_DTRACE -arch i386 -arch ppc -pipe  
-=20=

I/Users/jrraines/Downloads/mod_python-3.3.1/src/include -I/System/=20
Library/Frameworks/Python.framework/Versions/2.5/include/python2.5 - 
c /=20=

Users/jrraines/Downloads/mod_python-3.3.1/src/psp_parser.c -o build/=20
temp.macosx-10.5-ppc-2.5/Users/jrraines/Downloads/mod_python-3.3.1/ 
src/=20=

psp_parser.o
psp_parser.c:1436: warning: =91yyunput=92 defined but not used
psp_parser.c:1436: warning: =91yyunput=92 defined but not used
gcc -fno-strict-aliasing -Wno-long-double -no-cpp-precomp -mno-fused-=20
madd -fno-common -dynamic -DNDEBUG -g -Os -Wall -Wstrict-prototypes -=20
DMACOSX -I/usr/include/ffi -DENABLE_DTRACE -arch i386 -arch ppc -pipe  
-=20=

I/Users/jrraines/Downloads/mod_python-3.3.1/src/include -I/System/=20
Library/Frameworks/Python.framework/Versions/2.5/include/python2.5 - 
c /=20=

Users/jrraines/Downloads/mod_python-3.3.1/src/_pspmodule.c -o build/=20
temp.macosx-10.5-ppc-2.5/Users/jrraines/Downloads/mod_python-3.3.1/ 
src/=20=

_pspmodule.o
/Users/jrraines/Downloads/mod_python-3.3.1/src/_pspmodule.c:32: =20
warning: =91yy_init_globals=92 defined but not used
/Users/jrraines/Downloads/mod_python-3.3.1/src/_pspmodule.c:32: =20
warning: =91yy_init_globals=92 defined but not used
gcc -Wl,-F. -bundle -undefined dynamic_lookup -arch i386 -arch ppc =20
build/temp.macosx-10.5-ppc-2.5/Users/jrraines/Downloads/=20
mod_python-3.3.1/src/psp_string.o build/temp.macosx-10.5-ppc-2.5/ 
Users/=20=

jrraines/Downloads/mod_python-3.3.1/src/psp_parser.o build/=20
temp.macosx-10.5-ppc-2.5/Users/jrraines/Downloads/mod_python-3.3.1/ 
src/=20=

_pspmodule.o -o build/lib.macosx-10.5-ppc-2.5/mod_python/_psp.so

Now su and make install
    (or, if you only want to perform a partial install,
     you can use make install_dso and make install_py_lib)

Mac-in-basement:mod_python-3.3.1 jrraines$ sudo make install
Password:
make[2]: `build' is up to date.

Now su and make install
    (or, if you only want to perform a partial install,
     you can use make install_dso and make install_py_lib)


Performing DSO installation.

/usr/bin/install -c -d /usr/libexec/apache2
/usr/bin/install -c src/mod_python.so /usr/libexec/apache2

Now don't forget to edit your main config and add
      LoadModule python_module /usr/libexec/apache2/mod_python.so
and if your configuration uses ClearModuleList, then also
      AddModule mod_python.c

cd dist && make install_py_lib
make[3]: `psp_parser.c' is up to date.
if test -z "" ; then \
		/usr/bin/python setup.py install --optimize 2 --force ; =
\
	else \
		/usr/bin/python setup.py install --optimize 2 --force =
--root  ; \
	fi
running install
running build
running build_py
running build_ext
running install_lib
creating /Library/Python/2.5/site-packages
creating /Library/Python/2.5/site-packages/mod_python
copying build/lib.macosx-10.5-ppc-2.5/mod_python/__init__.py -> /=20
Library/Python/2.5/site-packages/mod_python
copying build/lib.macosx-10.5-ppc-2.5/mod_python/_psp.so -> /Library/=20
Python/2.5/site-packages/mod_python
copying build/lib.macosx-10.5-ppc-2.5/mod_python/apache.py -> / 
Library/=20=

Python/2.5/site-packages/mod_python
copying build/lib.macosx-10.5-ppc-2.5/mod_python/cache.py -> /Library/ 
=20=

Python/2.5/site-packages/mod_python
copying build/lib.macosx-10.5-ppc-2.5/mod_python/cgihandler.py -> /=20
Library/Python/2.5/site-packages/mod_python
copying build/lib.macosx-10.5-ppc-2.5/mod_python/Cookie.py -> / 
Library/=20=

Python/2.5/site-packages/mod_python
copying build/lib.macosx-10.5-ppc-2.5/mod_python/importer.py -> /=20
Library/Python/2.5/site-packages/mod_python
copying build/lib.macosx-10.5-ppc-2.5/mod_python/psp.py -> /Library/=20
Python/2.5/site-packages/mod_python
copying build/lib.macosx-10.5-ppc-2.5/mod_python/publisher.py -> /=20
Library/Python/2.5/site-packages/mod_python
copying build/lib.macosx-10.5-ppc-2.5/mod_python/python22.py -> /=20
Library/Python/2.5/site-packages/mod_python
copying build/lib.macosx-10.5-ppc-2.5/mod_python/Session.py -> /=20
Library/Python/2.5/site-packages/mod_python
copying build/lib.macosx-10.5-ppc-2.5/mod_python/testhandler.py -> /=20
Library/Python/2.5/site-packages/mod_python
copying build/lib.macosx-10.5-ppc-2.5/mod_python/util.py -> /Library/=20
Python/2.5/site-packages/mod_python
byte-compiling /Library/Python/2.5/site-packages/mod_python/=20
__init__.py to __init__.pyc
byte-compiling /Library/Python/2.5/site-packages/mod_python/apache.py  
=20=

to apache.pyc
byte-compiling /Library/Python/2.5/site-packages/mod_python/cache.py =20
to cache.pyc
byte-compiling /Library/Python/2.5/site-packages/mod_python/=20
cgihandler.py to cgihandler.pyc
byte-compiling /Library/Python/2.5/site-packages/mod_python/Cookie.py  
=20=

to Cookie.pyc
byte-compiling /Library/Python/2.5/site-packages/mod_python/=20
importer.py to importer.pyc
byte-compiling /Library/Python/2.5/site-packages/mod_python/psp.py to  
=20=

psp.pyc
byte-compiling /Library/Python/2.5/site-packages/mod_python/=20
publisher.py to publisher.pyc
byte-compiling /Library/Python/2.5/site-packages/mod_python/=20
python22.py to python22.pyc
byte-compiling /Library/Python/2.5/site-packages/mod_python/ 
Session.py =20=

to Session.pyc
byte-compiling /Library/Python/2.5/site-packages/mod_python/=20
testhandler.py to testhandler.pyc
byte-compiling /Library/Python/2.5/site-packages/mod_python/util.py  
to =20=

util.pyc
writing byte-compilation script '/tmp/tmpC0wUET.py'
/System/Library/Frameworks/Python.framework/Versions/2.5/Resources/=20
Python.app/Contents/MacOS/Python -OO /tmp/tmpC0wUET.py
removing /tmp/tmpC0wUET.py
running install_egg_info
Writing /Library/Python/2.5/site-packages/mod_python-3.3.1-py2.5.egg-=20
info
Mac-in-basement:mod_python-3.3.1 jrraines$ httpd -S
httpd: Syntax error on line 118 of /private/etc/apache2/httpd.conf: =20
Can't locate API module structure `Python_module' in file /usr/ 
libexec/=20=

apache2/mod_python.so: dlsym(0x106530, Python_module): symbol not found


From jan.diener-rodriguez at orange.ch  Tue Feb 19 12:08:22 2008
From: jan.diener-rodriguez at orange.ch (Diener-Rodriguez Jan Raino Eerik)
Date: Tue Feb 19 12:10:47 2008
Subject: [mod_python] compiling on HPUX 11.11
In-Reply-To: <88e286470802151600g7628b21an2c45ed5c36982b1e@mail.gmail.com>
References: <9FFAEC6056AE3D418CDA54F3FB38656B8A700F@VDCREXEVS01.orange.ch>
	<88e286470802151600g7628b21an2c45ed5c36982b1e@mail.gmail.com>
Message-ID: <9FFAEC6056AE3D418CDA54F3FB38656B8A702B@VDCREXEVS01.orange.ch>

I re-compiled python with --enable-shared, do now have the shared
library:
  find /usr -name "libpy*"
  /usr/local/lib/python2.5/config/libpython2.5.a
  /usr/local/lib/libpython2.5.sl

=> still don't manage to compile the mod_python..

--- gmake exits as below ---
ld -b
build/temp.hp-ux-B.11.11-9000-800-2.5/tmp/mod_python-3.3.1/src/psp_strin
g.o
build/temp.hp-ux-B.11.11-9000-800-2.5/tmp/mod_python-3.3.1/src/psp_parse
r.o
build/temp.hp-ux-B.11.11-9000-800-2.5/tmp/mod_python-3.3.1/src/_pspmodul
e.o -lpython2.5 -o
build/lib.hp-ux-B.11.11-9000-800-2.5/mod_python/_psp.sl
ld: Can't find library: "python2.5"
error: command 'ld' failed with exit status 1
gmake[1]: *** [build] Error 1
gmake[1]: Leaving directory `/tmp/mod_python-3.3.1/dist' 

jan

-----Original Message-----
From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com] 
Sent: Saturday, 16. February 2008 01:01
To: Diener-Rodriguez Jan Raino Eerik
Cc: Mod_python@modpython.org
Subject: Re: [mod_python] compiling on HPUX 11.11

You probably aren't installing Python with a shared library and this is
causing problems with libtool. When configuring Python before
compilation, pass '--enable-shared' option to configure script. You may
also need to add symlink manually in Python config directory so that
compiler finds it next to Python static library.

For some comments about these sorts of issues, see mod_wsgi
documentation. Specifically section 'Lack Of Python Shared Library'.

  http://code.google.com/p/modwsgi/wiki/InstallationIssues

Similar sorts of issues exist for mod_python.

Graham

On 15/02/2008, Diener-Rodriguez Jan Raino Eerik
<jan.diener-rodriguez@orange.ch> wrote:
>
>
> Hello guys,
> I managed to compile python 2.5.1, which works fine but I don't get 
> mod_python to compile on my HP box (see below)
>
> I am not a compiler/ing expert and it is well possible that I missed 
> some obvious detail.. would appreciate any hint or direction where to 
> find a possible solution to my problem.
>
> thanks
> jan
>
> === configure works, according to my little knowledge === # pwd
> /tmp/mod_python-3.3.1
> # ./configure --with-apxs=/usr/local/apache2/bin/apxs
> --with-flex=/usr/local/bin/flex
> checking for gcc... gcc
> checking for C compiler default output file name... a.out checking 
> whether the C compiler works... yes checking whether we are cross 
> compiling... no checking for suffix of executables...
> checking for suffix of object files... o checking whether we are using

> the GNU C compiler... yes checking whether gcc accepts -g... yes 
> checking for gcc option to accept ANSI C... none needed checking for 
> ar... ar checking for a BSD-compatible install... ./install-sh -c 
> checking whether make sets $(MAKE)... yes checking for main in -lm... 
> yes checking for an ANSI C-conforming const... yes checking your blood

> pressure... a bit high, but we can proceed
> configure: checking whether apxs is available...
> checking for --with-apxs... /usr/local/apache2/bin/apxs executable, 
> good checking Apache version... 2.0.63 checking for Apache libexec 
> directory... /usr/local/apache2/modules checking for Apache include 
> directory... -I/usr/local/apache2/include checking for 
> --with-python... no checking for python... /usr/bin/python checking 
> Python version... 2.5 checking Python install prefix... /usr/local 
> checking checking where python libraries are installed...
> /usr/local/lib/python2.5
> checking for Py_NewInterpreter in -lpython2.5... yes
> checking what libraries Python was linked with... -lpython2.5   -lnsl
-lrt
> -ldld    -lm
> checking linker flags used to link Python...
> checking where Python include files are... 
> -I/usr/local/include/python2.5 checking for --with-python-src... no 
> checking for --with-mutex-dir... no Using MUTEX_DIR /tmp checking for 
> --with-max-locks... no Using 8 MAX_LOCKS.
> checking for --with-flex... /usr/local/bin/flex found 
> /usr/local/bin/flex, we'll use this. Use --with-flex to specify 
> another.
> checking flex version... 2.5.34. Good
> configure: creating ./config.status
> config.status: creating Makefile
> config.status: creating src/Makefile
> config.status: creating Doc/Makefile
> config.status: creating src/include/mod_python.h
> config.status: creating test/Makefile
> config.status: creating test/testconf.py
> config.status: creating dist/setup.py
> config.status: creating dist/Makefile
> #
>
>
> === compiling - fails ====
>
> #  gmake
> gmake[1]: Entering directory `/tmp/mod_python-3.3.1/src'
>
> Compiling for DSO.
>
> /usr/local/apache2/bin/apxs -I/tmp/mod_python-3.3.1/src/include
> -I/usr/local/apache2/include -I/usr/local/include/python2.5 -c 
> mod_python.c _apachemodule.c requestobject.c tableobject.c util.c 
> serverobject.c connobject.c filterobject.c hlist.c hlistobject.c
finfoobject.c
> -L/usr/local/lib/python2.5/config  -Wl,-E -Wl,+s      -lm
> -lpython2.5   -lnsl -lrt -ldld    -lm
> /usr/local/apache2/build/libtool --silent --mode=compile gcc 
> -prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11 -D_REENTRANT 
> -D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread -I/usr/local/apache2/include

> -I/usr/local/apache2/include -I/usr/local/apache2/include  
> -I/tmp/mod_python-3.3.1/src/include
> -I/usr/local/apache2/include -I/usr/local/include/python2.5  -c -o 
> mod_python.lo mod_python.c && touch mod_python.slo In file included 
> from /usr/local/include/python2.5/Python.h:8,
>                  from
/tmp/mod_python-3.3.1/src/include/mod_python.h:80,
>                  from mod_python.c:28:
> /usr/local/include/python2.5/pyconfig.h:932:1: warning:
> "_POSIX_C_SOURCE" redefined
> <command-line>: warning: this is the location of the previous 
> definition
> mod_python.c: In function 'python_init':
> mod_python.c:826: warning: initialization from incompatible pointer 
> type
> mod_python.c: In function 'get_interpreter':
> mod_python.c:290: warning: passing argument 1 of 'make_obcallback' 
> discards qualifiers from pointer target type 
> /usr/local/apache2/build/libtool --silent --mode=compile gcc 
> -prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11 -D_REENTRANT 
> -D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread -I/usr/local/apache2/include

> -I/usr/local/apache2/include -I/usr/local/apache2/include  
> -I/tmp/mod_python-3.3.1/src/include
> -I/usr/local/apache2/include -I/usr/local/include/python2.5  -c -o 
> _apachemodule.lo _apachemodule.c && touch _apachemodule.slo In file 
> included from /usr/local/include/python2.5/Python.h:8,
>                  from
/tmp/mod_python-3.3.1/src/include/mod_python.h:80,
>                  from _apachemodule.c:25:
> /usr/local/include/python2.5/pyconfig.h:932:1: warning:
> "_POSIX_C_SOURCE" redefined
> <command-line>: warning: this is the location of the previous 
> definition /usr/local/apache2/build/libtool --silent --mode=compile 
> gcc -prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11 
> -D_REENTRANT -D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread 
> -I/usr/local/apache2/include  -I/usr/local/apache2/include 
> -I/usr/local/apache2/include  -I/tmp/mod_python-3.3.1/src/include
> -I/usr/local/apache2/include -I/usr/local/include/python2.5  -c -o 
> requestobject.lo requestobject.c && touch requestobject.slo In file 
> included from /usr/local/include/python2.5/Python.h:8,
>                  from
/tmp/mod_python-3.3.1/src/include/mod_python.h:80,
>                  from requestobject.c:25:
> /usr/local/include/python2.5/pyconfig.h:932:1: warning:
> "_POSIX_C_SOURCE" redefined
> <command-line>: warning: this is the location of the previous 
> definition /usr/local/apache2/build/libtool --silent --mode=compile 
> gcc -prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11 
> -D_REENTRANT -D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread 
> -I/usr/local/apache2/include  -I/usr/local/apache2/include 
> -I/usr/local/apache2/include  -I/tmp/mod_python-3.3.1/src/include
> -I/usr/local/apache2/include -I/usr/local/include/python2.5  -c -o 
> tableobject.lo tableobject.c && touch tableobject.slo In file included

> from /usr/local/include/python2.5/Python.h:8,
>                  from
/tmp/mod_python-3.3.1/src/include/mod_python.h:80,
>                  from tableobject.c:25:
> /usr/local/include/python2.5/pyconfig.h:932:1: warning:
> "_POSIX_C_SOURCE" redefined
> <command-line>: warning: this is the location of the previous 
> definition
> tableobject.c:329: warning: initialization from incompatible pointer 
> type
> tableobject.c:1092: warning: initialization from incompatible pointer 
> type /usr/local/apache2/build/libtool --silent --mode=compile gcc 
> -prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11 -D_REENTRANT 
> -D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread -I/usr/local/apache2/include

> -I/usr/local/apache2/include -I/usr/local/apache2/include  
> -I/tmp/mod_python-3.3.1/src/include
> -I/usr/local/apache2/include -I/usr/local/include/python2.5  -c -o 
> util.lo util.c && touch util.slo In file included from 
> /usr/local/include/python2.5/Python.h:8,
>                  from
/tmp/mod_python-3.3.1/src/include/mod_python.h:80,
>                  from util.c:28:
> /usr/local/include/python2.5/pyconfig.h:932:1: warning:
> "_POSIX_C_SOURCE" redefined
> <command-line>: warning: this is the location of the previous 
> definition /usr/local/apache2/build/libtool --silent --mode=compile 
> gcc -prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11 
> -D_REENTRANT -D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread 
> -I/usr/local/apache2/include  -I/usr/local/apache2/include 
> -I/usr/local/apache2/include  -I/tmp/mod_python-3.3.1/src/include
> -I/usr/local/apache2/include -I/usr/local/include/python2.5  -c -o 
> serverobject.lo serverobject.c && touch serverobject.slo In file 
> included from /usr/local/include/python2.5/Python.h:8,
>                  from
/tmp/mod_python-3.3.1/src/include/mod_python.h:80,
>                  from serverobject.c:25:
> /usr/local/include/python2.5/pyconfig.h:932:1: warning:
> "_POSIX_C_SOURCE" redefined
> <command-line>: warning: this is the location of the previous 
> definition
> serverobject.c:387: warning: initialization from incompatible pointer 
> type /usr/local/apache2/build/libtool --silent --mode=compile gcc 
> -prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11 -D_REENTRANT 
> -D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread -I/usr/local/apache2/include

> -I/usr/local/apache2/include -I/usr/local/apache2/include  
> -I/tmp/mod_python-3.3.1/src/include
> -I/usr/local/apache2/include -I/usr/local/include/python2.5  -c -o 
> connobject.lo connobject.c && touch connobject.slo In file included 
> from /usr/local/include/python2.5/Python.h:8,
>                  from
/tmp/mod_python-3.3.1/src/include/mod_python.h:80,
>                  from connobject.c:30:
> /usr/local/include/python2.5/pyconfig.h:932:1: warning:
> "_POSIX_C_SOURCE" redefined
> <command-line>: warning: this is the location of the previous 
> definition /usr/local/apache2/build/libtool --silent --mode=compile 
> gcc -prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11 
> -D_REENTRANT -D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread 
> -I/usr/local/apache2/include  -I/usr/local/apache2/include 
> -I/usr/local/apache2/include  -I/tmp/mod_python-3.3.1/src/include
> -I/usr/local/apache2/include -I/usr/local/include/python2.5  -c -o 
> filterobject.lo filterobject.c && touch filterobject.slo In file 
> included from /usr/local/include/python2.5/Python.h:8,
>                  from
/tmp/mod_python-3.3.1/src/include/mod_python.h:80,
>                  from filterobject.c:28:
> /usr/local/include/python2.5/pyconfig.h:932:1: warning:
> "_POSIX_C_SOURCE" redefined
> <command-line>: warning: this is the location of the previous 
> definition /usr/local/apache2/build/libtool --silent --mode=compile 
> gcc -prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11 
> -D_REENTRANT -D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread 
> -I/usr/local/apache2/include  -I/usr/local/apache2/include 
> -I/usr/local/apache2/include  -I/tmp/mod_python-3.3.1/src/include
> -I/usr/local/apache2/include -I/usr/local/include/python2.5  -c -o 
> hlist.lo hlist.c && touch hlist.slo In file included from 
> /usr/local/include/python2.5/Python.h:8,
>                  from
/tmp/mod_python-3.3.1/src/include/mod_python.h:80,
>                  from hlist.c:28:
> /usr/local/include/python2.5/pyconfig.h:932:1: warning:
> "_POSIX_C_SOURCE" redefined
> <command-line>: warning: this is the location of the previous 
> definition /usr/local/apache2/build/libtool --silent --mode=compile 
> gcc -prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11 
> -D_REENTRANT -D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread 
> -I/usr/local/apache2/include  -I/usr/local/apache2/include 
> -I/usr/local/apache2/include  -I/tmp/mod_python-3.3.1/src/include
> -I/usr/local/apache2/include -I/usr/local/include/python2.5  -c -o 
> hlistobject.lo hlistobject.c && touch hlistobject.slo In file included

> from /usr/local/include/python2.5/Python.h:8,
>                  from
/tmp/mod_python-3.3.1/src/include/mod_python.h:80,
>                  from hlistobject.c:28:
> /usr/local/include/python2.5/pyconfig.h:932:1: warning:
> "_POSIX_C_SOURCE" redefined
> <command-line>: warning: this is the location of the previous 
> definition /usr/local/apache2/build/libtool --silent --mode=compile 
> gcc -prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11 
> -D_REENTRANT -D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread 
> -I/usr/local/apache2/include  -I/usr/local/apache2/include 
> -I/usr/local/apache2/include  -I/tmp/mod_python-3.3.1/src/include
> -I/usr/local/apache2/include -I/usr/local/include/python2.5  -c -o 
> finfoobject.lo finfoobject.c && touch finfoobject.slo In file included

> from /usr/local/include/python2.5/Python.h:8,
>                  from
/tmp/mod_python-3.3.1/src/include/mod_python.h:80,
>                  from finfoobject.c:25:
> /usr/local/include/python2.5/pyconfig.h:932:1: warning:
> "_POSIX_C_SOURCE" redefined
> <command-line>: warning: this is the location of the previous 
> definition
> finfoobject.c:278: warning: 'intargfunc' is deprecated
> finfoobject.c:278: warning: initialization from incompatible pointer 
> type /usr/local/apache2/build/libtool --silent --mode=link gcc -o 
> mod_python.la  -rpath /usr/local/apache2/modules -module
> -avoid-version    finfoobject.lo hlistobject.lo hlist.lo
filterobject.lo
> connobject.lo serverobject.lo util.lo tableobject.lo requestobject.lo 
> _apachemodule.lo mod_python.lo -L/usr/local/lib/python2.5/config 
> -Wl,-E -Wl,+s -lm
> -lpython2.5 -lnsl -lrt -ldld -lm
> /usr/ccs/bin/ld: Invalid loader fixup in text space needed in output 
> file for symbol "_PyEval_SliceIndex" in input file 
> "/usr/local/lib/python2.5/config/libpython2.5.a(listobject.o)"
> collect2: ld returned 1 exit status
> apxs:Error: Command failed with rc=65536 .
> gmake[1]: *** [mod_python.so] Error 1
> gmake[1]: Leaving directory `/tmp/mod_python-3.3.1/src'
> gmake: *** [do_dso] Error 2
> #
>
> _______________________________________________
>  Mod_python mailing list
>  Mod_python@modpython.org
>  http://mailman.modpython.org/mailman/listinfo/mod_python
>
>

From graham.dumpleton at gmail.com  Tue Feb 19 15:42:57 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Feb 19 15:43:08 2008
Subject: [mod_python] debian etch: testing
In-Reply-To: <47BAEACA.8070801@heckler-koch.cz>
References: <47BAEACA.8070801@heckler-koch.cz>
Message-ID: <88e286470802191242l1cc68accs596e84fcf7be17b8@mail.gmail.com>

If this is the first time you have used mod_python 3.3.1, read about
import_module() in:

  http://www.modpython.org/live/current/doc-html/pyapi-apmeth.html

The bahaviour of the module importer has changed in some areas and
some details are described in that document.

Most likely you just need to set PythonPath correctly. Without you
posting the mod_python parts of your Apache configuration and saying
exactly where in the file system your files are so we can see how that
relates to your configuration, we can't really help much.

Graham

On 20/02/2008, kosa@heckler-koch.cz <kosa@heckler-koch.cz> wrote:
> hi all
>
> please, few days before, i was forced to made dist-upgrade on my debian
> etch, from stable to testing
> but after this, i have a problem. Classic mod_python is working correct
> with apache. But unfortunately my work developing environment is not !
>
> we are using, apache prefork and teng together with mod python. Here are
> my versions:
>
> ii  apache2                              2.2.8-1
> Next generation, scalable, extendable web se
> ii  apache2-mpm-prefork                  2.2.8-1
> Traditional model for Apache HTTPD
> ii  apache2-utils                        2.2.8-1
> utility programs for webservers
> ii  apache2.2-common                     2.2.8-1
> Next generation, scalable, extendable web se
> ii  libapache2-mod-python                3.3.1-1
> Apache 2 module that embeds Python within th
> ii  libapache2-mod-python-doc            3.3.1-1
> Apache 2 module that embeds Python within th
>
> ii  libteng1                             1.0.12
> Teng -- general purpose templating system
>
> ii  python2.4                            2.4.4-7                     An
> interactive high-level object-oriented la
> ii  python2.4-dbg                        2.4.4-7
> Debug Build of the Python Interpreter (versi
> ii  python2.4-fastrpc                    2.0.2
> Fastrpc -- RPC using XML and Binary protocol
> ii  python2.4-minimal                    2.4.4-7                     A
> minimal subset of the Python language (ver
> ii  python2.4-teng                       1.0.0
> Teng module for python
> ii  szn-python2.4-dbglog                 1.1.7
> Debug log library for python
>
> this is the error message i am getting:
>
> MOD_PYTHON ERROR
>
> ProcessId:      22082
> Interpreter:    '127.0.0.1'
>
> ServerName:     '127.0.0.1'
> DocumentRoot:   '/svn/stream/trunk/www'
>
> URI:            '/'
> Location:       None
> Directory:      '/'
> Filename:       '/svn/stream/trunk/www/'
> PathInfo:       ''
>
> Phase:          'PythonHandler'
> Handler:        'mp_handler'
>
> Traceback (most recent call last):
>
>   File "/usr/lib/python2.4/site-packages/mod_python/importer.py", line
> 1537, in HandlerDispatch
>     default=default_handler, arg=req, silent=hlist.silent)
>
>   File "/usr/lib/python2.4/site-packages/mod_python/importer.py", line
> 1202, in _process_target
>     module = import_module(module_name, path=path)
>
>   File "/usr/lib/python2.4/site-packages/mod_python/importer.py", line
> 304, in import_module
>     return __import__(module_name, {}, {}, ['*'])
>
>
> [all the paths are the same as before the dist-upgrade]
> so please, if any has some experience with this problem, let me know. if
> this is not enough informations, i will post more.
>
>
> thank you very much
> pavel
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From graham.dumpleton at gmail.com  Tue Feb 19 15:45:00 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Feb 19 15:45:08 2008
Subject: [mod_python] Leopard Install
In-Reply-To: <57327B09-F9CD-44C6-BCE8-992872F264FD@comcast.net>
References: <57327B09-F9CD-44C6-BCE8-992872F264FD@comcast.net>
Message-ID: <88e286470802191245l4af76fbtfd2d3cadeb9b89a9@mail.gmail.com>

You need to say:

   LoadModule python_module /usr/libexec/apache2/mod_python.so

Did you perhaps say:

   LoadModule Python_module /usr/libexec/apache2/mod_python.so

The case of the name matters.

Graham

On 20/02/2008, John Raines <jrraines@comcast.net> wrote:
>   I've been trying to install mod_python on Leopard on a G4; i think
>   using a G4 means that I don't need to worry about the 64 bit issues
>
> which have been discussed before. In the past macs have come with
> apache 1.3 and python 2.3. Leopard comes with fairly current
> versions and so I decided to use the built in version. I tried to
> get rid of old pythons etc left over from Tiger etc. I installed
>   with just ./configure, make, sudo make install. When I type httpd -S,
> I get an error msg which I think means that there's a version
> incompatibility between mod_python and apache. I'm not sure where
> this is going wrong.
>
>   Details of the install :
>
> Mac-in-basement:mod_python-3.3.1 jrraines$ ./configure
> checking for gcc... gcc
> checking for C compiler default output file name... a.out
> checking whether the C compiler works... yes
> checking whether we are cross compiling... no
> checking for suffix of executables...
> checking for suffix of object files... o
> checking whether we are using the GNU C compiler... yes
> checking whether gcc accepts -g... yes
> checking for gcc option to accept ANSI C... none needed
> checking for ar... ar
> checking for a BSD-compatible install... /usr/bin/install -c
> checking whether make sets $(MAKE)... yes
> checking for main in -lm... yes
> checking for an ANSI C-conforming const... yes
> checking your blood pressure... a bit high, but we can proceed
> configure: checking whether apxs is available...
> checking for --with-apxs... no
> checking for apxs in /usr/local/apache/sbin... no
> checking for apxs in your PATH... checking for apxs... /usr/sbin/apxs
> found /usr/sbin/apxs, we'll use this. Use --with-apxs to specify =20
> another.
> checking Apache version... 2.2.6
> checking for Apache libexec directory... /usr/libexec/apache2
> checking for Apache include directory... -I/usr/include/apache2
> checking for --with-python... no
> checking for python... /usr/bin/python
> checking Python version... 2.5
> checking Python install prefix... /System/Library/Frameworks/=20
> Python.framework/Versions/2.5
> checking checking where python libraries are installed... /System/=20
> Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5
> checking what libraries Python was linked with... -framework  =20
> Python    -ldl
> checking linker flags used to link Python...
> checking where Python include files are... -I/System/Library/=20
> Frameworks/Python.framework/Versions/2.5/include/python2.5
> checking for --with-python-src... no
> checking for --with-mutex-dir... no
> Using MUTEX_DIR /tmp
> checking for --with-max-locks... no
> Using 8 MAX_LOCKS.
> checking for --with-flex... no
> checking for flex... /usr/bin/flex
> found /usr/bin/flex, we'll use this. Use --with-flex to specify another.
> checking flex version... 2.5.33. Good
> configure: creating ./config.status
> config.status: creating Makefile
> config.status: creating src/Makefile
> config.status: creating Doc/Makefile
> config.status: creating src/include/mod_python.h
> config.status: creating test/Makefile
> config.status: creating test/testconf.py
> config.status: creating dist/setup.py
> config.status: creating dist/Makefile
> Mac-in-basement:mod_python-3.3.1 jrraines$ make
>
> Compiling for DSO.
>
> /usr/sbin/apxs -I/Users/jrraines/Downloads/mod_python-3.3.1/src/=20
> include -I/usr/include/apache2 -I/System/Library/Frameworks/=20
> Python.framework/Versions/2.5/include/python2.5 -c mod_python.c =20
> _apachemodule.c requestobject.c tableobject.c util.c serverobject.c =20
> connobject.c filterobject.c hlist.c hlistobject.c finfoobject.c -Wl,-=20
> framework,Python  -u _PyMac_Error -framework Python   -Wl,-F.   -lm  -
> =20=
>
> framework  Python    -ldl
> /usr/share/apr-1/build-1/libtool --silent --mode=3Dcompile gcc    -=20
> DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp  -I/usr/
> include/=20=
>
> apache2  -I/usr/include/apr-1   -I/usr/include/apr-1  -I/Users/=20
> jrraines/Downloads/mod_python-3.3.1/src/include -I/usr/include/
> apache2 =20=
>
> -I/System/Library/Frameworks/Python.framework/Versions/2.5/include/=20
> python2.5  -c -o mod_python.lo mod_python.c && touch mod_python.slo
> mod_python.c: In function 'python_init':
> mod_python.c:826: warning: initialization from incompatible pointer type
> /usr/share/apr-1/build-1/libtool --silent --mode=3Dcompile gcc    -=20
> DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp  -I/usr/
> include/=20=
>
> apache2  -I/usr/include/apr-1   -I/usr/include/apr-1  -I/Users/=20
> jrraines/Downloads/mod_python-3.3.1/src/include -I/usr/include/
> apache2 =20=
>
> -I/System/Library/Frameworks/Python.framework/Versions/2.5/include/=20
> python2.5  -c -o _apachemodule.lo _apachemodule.c && touch =20
> _apachemodule.slo
> /usr/share/apr-1/build-1/libtool --silent --mode=3Dcompile gcc    -=20
> DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp  -I/usr/
> include/=20=
>
> apache2  -I/usr/include/apr-1   -I/usr/include/apr-1  -I/Users/=20
> jrraines/Downloads/mod_python-3.3.1/src/include -I/usr/include/
> apache2 =20=
>
> -I/System/Library/Frameworks/Python.framework/Versions/2.5/include/=20
> python2.5  -c -o requestobject.lo requestobject.c && touch =20
> requestobject.slo
> /usr/share/apr-1/build-1/libtool --silent --mode=3Dcompile gcc    -=20
> DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp  -I/usr/
> include/=20=
>
> apache2  -I/usr/include/apr-1   -I/usr/include/apr-1  -I/Users/=20
> jrraines/Downloads/mod_python-3.3.1/src/include -I/usr/include/
> apache2 =20=
>
> -I/System/Library/Frameworks/Python.framework/Versions/2.5/include/=20
> python2.5  -c -o tableobject.lo tableobject.c && touch tableobject.slo
> tableobject.c:329: warning: initialization from incompatible pointer =20
> type
> tableobject.c:1092: warning: initialization from incompatible pointer
> =20=
>
> type
> /usr/share/apr-1/build-1/libtool --silent --mode=3Dcompile gcc    -=20
> DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp  -I/usr/
> include/=20=
>
> apache2  -I/usr/include/apr-1   -I/usr/include/apr-1  -I/Users/=20
> jrraines/Downloads/mod_python-3.3.1/src/include -I/usr/include/
> apache2 =20=
>
> -I/System/Library/Frameworks/Python.framework/Versions/2.5/include/=20
> python2.5  -c -o util.lo util.c && touch util.slo
> /usr/share/apr-1/build-1/libtool --silent --mode=3Dcompile gcc    -=20
> DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp  -I/usr/
> include/=20=
>
> apache2  -I/usr/include/apr-1   -I/usr/include/apr-1  -I/Users/=20
> jrraines/Downloads/mod_python-3.3.1/src/include -I/usr/include/
> apache2 =20=
>
> -I/System/Library/Frameworks/Python.framework/Versions/2.5/include/=20
> python2.5  -c -o serverobject.lo serverobject.c && touch =20
> serverobject.slo
> serverobject.c:387: warning: initialization from incompatible pointer
> =20=
>
> type
> /usr/share/apr-1/build-1/libtool --silent --mode=3Dcompile gcc    -=20
> DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp  -I/usr/
> include/=20=
>
> apache2  -I/usr/include/apr-1   -I/usr/include/apr-1  -I/Users/=20
> jrraines/Downloads/mod_python-3.3.1/src/include -I/usr/include/
> apache2 =20=
>
> -I/System/Library/Frameworks/Python.framework/Versions/2.5/include/=20
> python2.5  -c -o connobject.lo connobject.c && touch connobject.slo
> /usr/share/apr-1/build-1/libtool --silent --mode=3Dcompile gcc    -=20
> DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp  -I/usr/
> include/=20=
>
> apache2  -I/usr/include/apr-1   -I/usr/include/apr-1  -I/Users/=20
> jrraines/Downloads/mod_python-3.3.1/src/include -I/usr/include/
> apache2 =20=
>
> -I/System/Library/Frameworks/Python.framework/Versions/2.5/include/=20
> python2.5  -c -o filterobject.lo filterobject.c && touch =20
> filterobject.slo
> /usr/share/apr-1/build-1/libtool --silent --mode=3Dcompile gcc    -=20
> DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp  -I/usr/
> include/=20=
>
> apache2  -I/usr/include/apr-1   -I/usr/include/apr-1  -I/Users/=20
> jrraines/Downloads/mod_python-3.3.1/src/include -I/usr/include/
> apache2 =20=
>
> -I/System/Library/Frameworks/Python.framework/Versions/2.5/include/=20
> python2.5  -c -o hlist.lo hlist.c && touch hlist.slo
> /usr/share/apr-1/build-1/libtool --silent --mode=3Dcompile gcc    -=20
> DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp  -I/usr/
> include/=20=
>
> apache2  -I/usr/include/apr-1   -I/usr/include/apr-1  -I/Users/=20
> jrraines/Downloads/mod_python-3.3.1/src/include -I/usr/include/
> apache2 =20=
>
> -I/System/Library/Frameworks/Python.framework/Versions/2.5/include/=20
> python2.5  -c -o hlistobject.lo hlistobject.c && touch hlistobject.slo
> /usr/share/apr-1/build-1/libtool --silent --mode=3Dcompile gcc    -=20
> DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp  -I/usr/
> include/=20=
>
> apache2  -I/usr/include/apr-1   -I/usr/include/apr-1  -I/Users/=20
> jrraines/Downloads/mod_python-3.3.1/src/include -I/usr/include/
> apache2 =20=
>
> -I/System/Library/Frameworks/Python.framework/Versions/2.5/include/=20
> python2.5  -c -o finfoobject.lo finfoobject.c && touch finfoobject.slo
> finfoobject.c:278: warning: 'intargfunc' is deprecated
> finfoobject.c:278: warning: initialization from incompatible pointer =20
> type
> /usr/share/apr-1/build-1/libtool --silent --mode=3Dlink gcc -o =20
> mod_python.la  -rpath /usr/libexec/apache2 -module -avoid-version    =20
> finfoobject.lo hlistobject.lo hlist.lo filterobject.lo connobject.lo =20
> serverobject.lo util.lo tableobject.lo requestobject.lo =20
> _apachemodule.lo mod_python.lo -Wl,-framework,Python -u _PyMac_Error -
> =20=
>
> framework Python -Wl,-F. -lm -framework Python -ldl
> ln -s ../lib/python/mod_python mod_python
> ln -s ../src src
> make[2]: `psp_parser.c' is up to date.
> /usr/bin/python setup.py build
> running build
> running build_py
> creating build
> creating build/lib.macosx-10.5-ppc-2.5
> creating build/lib.macosx-10.5-ppc-2.5/mod_python
> copying /Users/jrraines/Downloads/mod_python-3.3.1/lib/python/=20
> mod_python/__init__.py -> build/lib.macosx-10.5-ppc-2.5/mod_python
> copying /Users/jrraines/Downloads/mod_python-3.3.1/lib/python/=20
> mod_python/apache.py -> build/lib.macosx-10.5-ppc-2.5/mod_python
> copying /Users/jrraines/Downloads/mod_python-3.3.1/lib/python/=20
> mod_python/cache.py -> build/lib.macosx-10.5-ppc-2.5/mod_python
> copying /Users/jrraines/Downloads/mod_python-3.3.1/lib/python/=20
> mod_python/cgihandler.py -> build/lib.macosx-10.5-ppc-2.5/mod_python
> copying /Users/jrraines/Downloads/mod_python-3.3.1/lib/python/=20
> mod_python/Cookie.py -> build/lib.macosx-10.5-ppc-2.5/mod_python
> copying /Users/jrraines/Downloads/mod_python-3.3.1/lib/python/=20
> mod_python/importer.py -> build/lib.macosx-10.5-ppc-2.5/mod_python
> copying /Users/jrraines/Downloads/mod_python-3.3.1/lib/python/=20
> mod_python/psp.py -> build/lib.macosx-10.5-ppc-2.5/mod_python
> copying /Users/jrraines/Downloads/mod_python-3.3.1/lib/python/=20
> mod_python/publisher.py -> build/lib.macosx-10.5-ppc-2.5/mod_python
> copying /Users/jrraines/Downloads/mod_python-3.3.1/lib/python/=20
> mod_python/python22.py -> build/lib.macosx-10.5-ppc-2.5/mod_python
> copying /Users/jrraines/Downloads/mod_python-3.3.1/lib/python/=20
> mod_python/Session.py -> build/lib.macosx-10.5-ppc-2.5/mod_python
> copying /Users/jrraines/Downloads/mod_python-3.3.1/lib/python/=20
> mod_python/testhandler.py -> build/lib.macosx-10.5-ppc-2.5/mod_python
> copying /Users/jrraines/Downloads/mod_python-3.3.1/lib/python/=20
> mod_python/util.py -> build/lib.macosx-10.5-ppc-2.5/mod_python
> running build_ext
> building 'mod_python._psp' extension
> creating build/temp.macosx-10.5-ppc-2.5
> creating build/temp.macosx-10.5-ppc-2.5/Users
> creating build/temp.macosx-10.5-ppc-2.5/Users/jrraines
> creating build/temp.macosx-10.5-ppc-2.5/Users/jrraines/Downloads
> creating build/temp.macosx-10.5-ppc-2.5/Users/jrraines/Downloads/=20
> mod_python-3.3.1
> creating build/temp.macosx-10.5-ppc-2.5/Users/jrraines/Downloads/=20
> mod_python-3.3.1/src
> gcc -fno-strict-aliasing -Wno-long-double -no-cpp-precomp -mno-fused-=20
> madd -fno-common -dynamic -DNDEBUG -g -Os -Wall -Wstrict-prototypes -=20
> DMACOSX -I/usr/include/ffi -DENABLE_DTRACE -arch i386 -arch ppc -pipe
> -=20=
>
> I/Users/jrraines/Downloads/mod_python-3.3.1/src/include -I/System/=20
> Library/Frameworks/Python.framework/Versions/2.5/include/python2.5 -
> c /=20=
>
> Users/jrraines/Downloads/mod_python-3.3.1/src/psp_string.c -o build/=20
> temp.macosx-10.5-ppc-2.5/Users/jrraines/Downloads/mod_python-3.3.1/
> src/=20=
>
> psp_string.o
> gcc -fno-strict-aliasing -Wno-long-double -no-cpp-precomp -mno-fused-=20
> madd -fno-common -dynamic -DNDEBUG -g -Os -Wall -Wstrict-prototypes -=20
> DMACOSX -I/usr/include/ffi -DENABLE_DTRACE -arch i386 -arch ppc -pipe
> -=20=
>
> I/Users/jrraines/Downloads/mod_python-3.3.1/src/include -I/System/=20
> Library/Frameworks/Python.framework/Versions/2.5/include/python2.5 -
> c /=20=
>
> Users/jrraines/Downloads/mod_python-3.3.1/src/psp_parser.c -o build/=20
> temp.macosx-10.5-ppc-2.5/Users/jrraines/Downloads/mod_python-3.3.1/
> src/=20=
>
> psp_parser.o
> psp_parser.c:1436: warning: =91yyunput=92 defined but not used
> psp_parser.c:1436: warning: =91yyunput=92 defined but not used
> gcc -fno-strict-aliasing -Wno-long-double -no-cpp-precomp -mno-fused-=20
> madd -fno-common -dynamic -DNDEBUG -g -Os -Wall -Wstrict-prototypes -=20
> DMACOSX -I/usr/include/ffi -DENABLE_DTRACE -arch i386 -arch ppc -pipe
> -=20=
>
> I/Users/jrraines/Downloads/mod_python-3.3.1/src/include -I/System/=20
> Library/Frameworks/Python.framework/Versions/2.5/include/python2.5 -
> c /=20=
>
> Users/jrraines/Downloads/mod_python-3.3.1/src/_pspmodule.c -o build/=20
> temp.macosx-10.5-ppc-2.5/Users/jrraines/Downloads/mod_python-3.3.1/
> src/=20=
>
> _pspmodule.o
> /Users/jrraines/Downloads/mod_python-3.3.1/src/_pspmodule.c:32: =20
> warning: =91yy_init_globals=92 defined but not used
> /Users/jrraines/Downloads/mod_python-3.3.1/src/_pspmodule.c:32: =20
> warning: =91yy_init_globals=92 defined but not used
> gcc -Wl,-F. -bundle -undefined dynamic_lookup -arch i386 -arch ppc =20
> build/temp.macosx-10.5-ppc-2.5/Users/jrraines/Downloads/=20
> mod_python-3.3.1/src/psp_string.o build/temp.macosx-10.5-ppc-2.5/
> Users/=20=
>
> jrraines/Downloads/mod_python-3.3.1/src/psp_parser.o build/=20
> temp.macosx-10.5-ppc-2.5/Users/jrraines/Downloads/mod_python-3.3.1/
> src/=20=
>
> _pspmodule.o -o build/lib.macosx-10.5-ppc-2.5/mod_python/_psp.so
>
> Now su and make install
>     (or, if you only want to perform a partial install,
>      you can use make install_dso and make install_py_lib)
>
> Mac-in-basement:mod_python-3.3.1 jrraines$ sudo make install
> Password:
> make[2]: `build' is up to date.
>
> Now su and make install
>     (or, if you only want to perform a partial install,
>      you can use make install_dso and make install_py_lib)
>
>
> Performing DSO installation.
>
> /usr/bin/install -c -d /usr/libexec/apache2
> /usr/bin/install -c src/mod_python.so /usr/libexec/apache2
>
> Now don't forget to edit your main config and add
>       LoadModule python_module /usr/libexec/apache2/mod_python.so
> and if your configuration uses ClearModuleList, then also
>       AddModule mod_python.c
>
> cd dist && make install_py_lib
> make[3]: `psp_parser.c' is up to date.
> if test -z "" ; then \
>                 /usr/bin/python setup.py install --optimize 2 --force ; =
> \
>         else \
>                 /usr/bin/python setup.py install --optimize 2 --force =
> --root  ; \
>         fi
> running install
> running build
> running build_py
> running build_ext
> running install_lib
> creating /Library/Python/2.5/site-packages
> creating /Library/Python/2.5/site-packages/mod_python
> copying build/lib.macosx-10.5-ppc-2.5/mod_python/__init__.py -> /=20
> Library/Python/2.5/site-packages/mod_python
> copying build/lib.macosx-10.5-ppc-2.5/mod_python/_psp.so -> /Library/=20
> Python/2.5/site-packages/mod_python
> copying build/lib.macosx-10.5-ppc-2.5/mod_python/apache.py -> /
> Library/=20=
>
> Python/2.5/site-packages/mod_python
> copying build/lib.macosx-10.5-ppc-2.5/mod_python/cache.py -> /Library/
> =20=
>
> Python/2.5/site-packages/mod_python
> copying build/lib.macosx-10.5-ppc-2.5/mod_python/cgihandler.py -> /=20
> Library/Python/2.5/site-packages/mod_python
> copying build/lib.macosx-10.5-ppc-2.5/mod_python/Cookie.py -> /
> Library/=20=
>
> Python/2.5/site-packages/mod_python
> copying build/lib.macosx-10.5-ppc-2.5/mod_python/importer.py -> /=20
> Library/Python/2.5/site-packages/mod_python
> copying build/lib.macosx-10.5-ppc-2.5/mod_python/psp.py -> /Library/=20
> Python/2.5/site-packages/mod_python
> copying build/lib.macosx-10.5-ppc-2.5/mod_python/publisher.py -> /=20
> Library/Python/2.5/site-packages/mod_python
> copying build/lib.macosx-10.5-ppc-2.5/mod_python/python22.py -> /=20
> Library/Python/2.5/site-packages/mod_python
> copying build/lib.macosx-10.5-ppc-2.5/mod_python/Session.py -> /=20
> Library/Python/2.5/site-packages/mod_python
> copying build/lib.macosx-10.5-ppc-2.5/mod_python/testhandler.py -> /=20
> Library/Python/2.5/site-packages/mod_python
> copying build/lib.macosx-10.5-ppc-2.5/mod_python/util.py -> /Library/=20
> Python/2.5/site-packages/mod_python
> byte-compiling /Library/Python/2.5/site-packages/mod_python/=20
> __init__.py to __init__.pyc
> byte-compiling /Library/Python/2.5/site-packages/mod_python/apache.py
> =20=
>
> to apache.pyc
> byte-compiling /Library/Python/2.5/site-packages/mod_python/cache.py =20
> to cache.pyc
> byte-compiling /Library/Python/2.5/site-packages/mod_python/=20
> cgihandler.py to cgihandler.pyc
> byte-compiling /Library/Python/2.5/site-packages/mod_python/Cookie.py
> =20=
>
> to Cookie.pyc
> byte-compiling /Library/Python/2.5/site-packages/mod_python/=20
> importer.py to importer.pyc
> byte-compiling /Library/Python/2.5/site-packages/mod_python/psp.py to
> =20=
>
> psp.pyc
> byte-compiling /Library/Python/2.5/site-packages/mod_python/=20
> publisher.py to publisher.pyc
> byte-compiling /Library/Python/2.5/site-packages/mod_python/=20
> python22.py to python22.pyc
> byte-compiling /Library/Python/2.5/site-packages/mod_python/
> Session.py =20=
>
> to Session.pyc
> byte-compiling /Library/Python/2.5/site-packages/mod_python/=20
> testhandler.py to testhandler.pyc
> byte-compiling /Library/Python/2.5/site-packages/mod_python/util.py
> to =20=
>
> util.pyc
> writing byte-compilation script '/tmp/tmpC0wUET.py'
> /System/Library/Frameworks/Python.framework/Versions/2.5/Resources/=20
> Python.app/Contents/MacOS/Python -OO /tmp/tmpC0wUET.py
> removing /tmp/tmpC0wUET.py
> running install_egg_info
> Writing /Library/Python/2.5/site-packages/mod_python-3.3.1-py2.5.egg-=20
> info
> Mac-in-basement:mod_python-3.3.1 jrraines$ httpd -S
> httpd: Syntax error on line 118 of /private/etc/apache2/httpd.conf: =20
> Can't locate API module structure `Python_module' in file /usr/
> libexec/=20=
>
> apache2/mod_python.so: dlsym(0x106530, Python_module): symbol not found
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From graham.dumpleton at gmail.com  Tue Feb 19 15:47:52 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Feb 19 15:47:55 2008
Subject: [mod_python] compiling on HPUX 11.11
In-Reply-To: <9FFAEC6056AE3D418CDA54F3FB38656B8A702B@VDCREXEVS01.orange.ch>
References: <9FFAEC6056AE3D418CDA54F3FB38656B8A700F@VDCREXEVS01.orange.ch>
	<88e286470802151600g7628b21an2c45ed5c36982b1e@mail.gmail.com>
	<9FFAEC6056AE3D418CDA54F3FB38656B8A702B@VDCREXEVS01.orange.ch>
Message-ID: <88e286470802191247y5ebd7ae3y2ce0df0ae44393fe@mail.gmail.com>

Search the mailing list archives using search box on
www.modpython.org. I vaguely remember these being some problem with
libtool on HP not handling .sl files correctly.
 First link I find is:

  http://www.modpython.org/pipermail/mod_python/2006-November/022620.html

Haven't time to go searching for it properly at the moment or try and
remember what it was about and whether it is the same.

Grahan

On 20/02/2008, Diener-Rodriguez Jan Raino Eerik
<jan.diener-rodriguez@orange.ch> wrote:
> I re-compiled python with --enable-shared, do now have the shared
> library:
>   find /usr -name "libpy*"
>   /usr/local/lib/python2.5/config/libpython2.5.a
>   /usr/local/lib/libpython2.5.sl
>
> => still don't manage to compile the mod_python..
>
> --- gmake exits as below ---
> ld -b
> build/temp.hp-ux-B.11.11-9000-800-2.5/tmp/mod_python-3.3.1/src/psp_strin
> g.o
> build/temp.hp-ux-B.11.11-9000-800-2.5/tmp/mod_python-3.3.1/src/psp_parse
> r.o
> build/temp.hp-ux-B.11.11-9000-800-2.5/tmp/mod_python-3.3.1/src/_pspmodul
> e.o -lpython2.5 -o
> build/lib.hp-ux-B.11.11-9000-800-2.5/mod_python/_psp.sl
> ld: Can't find library: "python2.5"
> error: command 'ld' failed with exit status 1
> gmake[1]: *** [build] Error 1
> gmake[1]: Leaving directory `/tmp/mod_python-3.3.1/dist'
>
> jan
>
> -----Original Message-----
> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
> Sent: Saturday, 16. February 2008 01:01
> To: Diener-Rodriguez Jan Raino Eerik
> Cc: Mod_python@modpython.org
> Subject: Re: [mod_python] compiling on HPUX 11.11
>
> You probably aren't installing Python with a shared library and this is
> causing problems with libtool. When configuring Python before
> compilation, pass '--enable-shared' option to configure script. You may
> also need to add symlink manually in Python config directory so that
> compiler finds it next to Python static library.
>
> For some comments about these sorts of issues, see mod_wsgi
> documentation. Specifically section 'Lack Of Python Shared Library'.
>
>   http://code.google.com/p/modwsgi/wiki/InstallationIssues
>
> Similar sorts of issues exist for mod_python.
>
> Graham
>
> On 15/02/2008, Diener-Rodriguez Jan Raino Eerik
> <jan.diener-rodriguez@orange.ch> wrote:
> >
> >
> > Hello guys,
> > I managed to compile python 2.5.1, which works fine but I don't get
> > mod_python to compile on my HP box (see below)
> >
> > I am not a compiler/ing expert and it is well possible that I missed
> > some obvious detail.. would appreciate any hint or direction where to
> > find a possible solution to my problem.
> >
> > thanks
> > jan
> >
> > === configure works, according to my little knowledge === # pwd
> > /tmp/mod_python-3.3.1
> > # ./configure --with-apxs=/usr/local/apache2/bin/apxs
> > --with-flex=/usr/local/bin/flex
> > checking for gcc... gcc
> > checking for C compiler default output file name... a.out checking
> > whether the C compiler works... yes checking whether we are cross
> > compiling... no checking for suffix of executables...
> > checking for suffix of object files... o checking whether we are using
>
> > the GNU C compiler... yes checking whether gcc accepts -g... yes
> > checking for gcc option to accept ANSI C... none needed checking for
> > ar... ar checking for a BSD-compatible install... ./install-sh -c
> > checking whether make sets $(MAKE)... yes checking for main in -lm...
> > yes checking for an ANSI C-conforming const... yes checking your blood
>
> > pressure... a bit high, but we can proceed
> > configure: checking whether apxs is available...
> > checking for --with-apxs... /usr/local/apache2/bin/apxs executable,
> > good checking Apache version... 2.0.63 checking for Apache libexec
> > directory... /usr/local/apache2/modules checking for Apache include
> > directory... -I/usr/local/apache2/include checking for
> > --with-python... no checking for python... /usr/bin/python checking
> > Python version... 2.5 checking Python install prefix... /usr/local
> > checking checking where python libraries are installed...
> > /usr/local/lib/python2.5
> > checking for Py_NewInterpreter in -lpython2.5... yes
> > checking what libraries Python was linked with... -lpython2.5   -lnsl
> -lrt
> > -ldld    -lm
> > checking linker flags used to link Python...
> > checking where Python include files are...
> > -I/usr/local/include/python2.5 checking for --with-python-src... no
> > checking for --with-mutex-dir... no Using MUTEX_DIR /tmp checking for
> > --with-max-locks... no Using 8 MAX_LOCKS.
> > checking for --with-flex... /usr/local/bin/flex found
> > /usr/local/bin/flex, we'll use this. Use --with-flex to specify
> > another.
> > checking flex version... 2.5.34. Good
> > configure: creating ./config.status
> > config.status: creating Makefile
> > config.status: creating src/Makefile
> > config.status: creating Doc/Makefile
> > config.status: creating src/include/mod_python.h
> > config.status: creating test/Makefile
> > config.status: creating test/testconf.py
> > config.status: creating dist/setup.py
> > config.status: creating dist/Makefile
> > #
> >
> >
> > === compiling - fails ====
> >
> > #  gmake
> > gmake[1]: Entering directory `/tmp/mod_python-3.3.1/src'
> >
> > Compiling for DSO.
> >
> > /usr/local/apache2/bin/apxs -I/tmp/mod_python-3.3.1/src/include
> > -I/usr/local/apache2/include -I/usr/local/include/python2.5 -c
> > mod_python.c _apachemodule.c requestobject.c tableobject.c util.c
> > serverobject.c connobject.c filterobject.c hlist.c hlistobject.c
> finfoobject.c
> > -L/usr/local/lib/python2.5/config  -Wl,-E -Wl,+s      -lm
> > -lpython2.5   -lnsl -lrt -ldld    -lm
> > /usr/local/apache2/build/libtool --silent --mode=compile gcc
> > -prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11 -D_REENTRANT
> > -D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread -I/usr/local/apache2/include
>
> > -I/usr/local/apache2/include -I/usr/local/apache2/include
> > -I/tmp/mod_python-3.3.1/src/include
> > -I/usr/local/apache2/include -I/usr/local/include/python2.5  -c -o
> > mod_python.lo mod_python.c && touch mod_python.slo In file included
> > from /usr/local/include/python2.5/Python.h:8,
> >                  from
> /tmp/mod_python-3.3.1/src/include/mod_python.h:80,
> >                  from mod_python.c:28:
> > /usr/local/include/python2.5/pyconfig.h:932:1: warning:
> > "_POSIX_C_SOURCE" redefined
> > <command-line>: warning: this is the location of the previous
> > definition
> > mod_python.c: In function 'python_init':
> > mod_python.c:826: warning: initialization from incompatible pointer
> > type
> > mod_python.c: In function 'get_interpreter':
> > mod_python.c:290: warning: passing argument 1 of 'make_obcallback'
> > discards qualifiers from pointer target type
> > /usr/local/apache2/build/libtool --silent --mode=compile gcc
> > -prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11 -D_REENTRANT
> > -D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread -I/usr/local/apache2/include
>
> > -I/usr/local/apache2/include -I/usr/local/apache2/include
> > -I/tmp/mod_python-3.3.1/src/include
> > -I/usr/local/apache2/include -I/usr/local/include/python2.5  -c -o
> > _apachemodule.lo _apachemodule.c && touch _apachemodule.slo In file
> > included from /usr/local/include/python2.5/Python.h:8,
> >                  from
> /tmp/mod_python-3.3.1/src/include/mod_python.h:80,
> >                  from _apachemodule.c:25:
> > /usr/local/include/python2.5/pyconfig.h:932:1: warning:
> > "_POSIX_C_SOURCE" redefined
> > <command-line>: warning: this is the location of the previous
> > definition /usr/local/apache2/build/libtool --silent --mode=compile
> > gcc -prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11
> > -D_REENTRANT -D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread
> > -I/usr/local/apache2/include  -I/usr/local/apache2/include
> > -I/usr/local/apache2/include  -I/tmp/mod_python-3.3.1/src/include
> > -I/usr/local/apache2/include -I/usr/local/include/python2.5  -c -o
> > requestobject.lo requestobject.c && touch requestobject.slo In file
> > included from /usr/local/include/python2.5/Python.h:8,
> >                  from
> /tmp/mod_python-3.3.1/src/include/mod_python.h:80,
> >                  from requestobject.c:25:
> > /usr/local/include/python2.5/pyconfig.h:932:1: warning:
> > "_POSIX_C_SOURCE" redefined
> > <command-line>: warning: this is the location of the previous
> > definition /usr/local/apache2/build/libtool --silent --mode=compile
> > gcc -prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11
> > -D_REENTRANT -D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread
> > -I/usr/local/apache2/include  -I/usr/local/apache2/include
> > -I/usr/local/apache2/include  -I/tmp/mod_python-3.3.1/src/include
> > -I/usr/local/apache2/include -I/usr/local/include/python2.5  -c -o
> > tableobject.lo tableobject.c && touch tableobject.slo In file included
>
> > from /usr/local/include/python2.5/Python.h:8,
> >                  from
> /tmp/mod_python-3.3.1/src/include/mod_python.h:80,
> >                  from tableobject.c:25:
> > /usr/local/include/python2.5/pyconfig.h:932:1: warning:
> > "_POSIX_C_SOURCE" redefined
> > <command-line>: warning: this is the location of the previous
> > definition
> > tableobject.c:329: warning: initialization from incompatible pointer
> > type
> > tableobject.c:1092: warning: initialization from incompatible pointer
> > type /usr/local/apache2/build/libtool --silent --mode=compile gcc
> > -prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11 -D_REENTRANT
> > -D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread -I/usr/local/apache2/include
>
> > -I/usr/local/apache2/include -I/usr/local/apache2/include
> > -I/tmp/mod_python-3.3.1/src/include
> > -I/usr/local/apache2/include -I/usr/local/include/python2.5  -c -o
> > util.lo util.c && touch util.slo In file included from
> > /usr/local/include/python2.5/Python.h:8,
> >                  from
> /tmp/mod_python-3.3.1/src/include/mod_python.h:80,
> >                  from util.c:28:
> > /usr/local/include/python2.5/pyconfig.h:932:1: warning:
> > "_POSIX_C_SOURCE" redefined
> > <command-line>: warning: this is the location of the previous
> > definition /usr/local/apache2/build/libtool --silent --mode=compile
> > gcc -prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11
> > -D_REENTRANT -D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread
> > -I/usr/local/apache2/include  -I/usr/local/apache2/include
> > -I/usr/local/apache2/include  -I/tmp/mod_python-3.3.1/src/include
> > -I/usr/local/apache2/include -I/usr/local/include/python2.5  -c -o
> > serverobject.lo serverobject.c && touch serverobject.slo In file
> > included from /usr/local/include/python2.5/Python.h:8,
> >                  from
> /tmp/mod_python-3.3.1/src/include/mod_python.h:80,
> >                  from serverobject.c:25:
> > /usr/local/include/python2.5/pyconfig.h:932:1: warning:
> > "_POSIX_C_SOURCE" redefined
> > <command-line>: warning: this is the location of the previous
> > definition
> > serverobject.c:387: warning: initialization from incompatible pointer
> > type /usr/local/apache2/build/libtool --silent --mode=compile gcc
> > -prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11 -D_REENTRANT
> > -D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread -I/usr/local/apache2/include
>
> > -I/usr/local/apache2/include -I/usr/local/apache2/include
> > -I/tmp/mod_python-3.3.1/src/include
> > -I/usr/local/apache2/include -I/usr/local/include/python2.5  -c -o
> > connobject.lo connobject.c && touch connobject.slo In file included
> > from /usr/local/include/python2.5/Python.h:8,
> >                  from
> /tmp/mod_python-3.3.1/src/include/mod_python.h:80,
> >                  from connobject.c:30:
> > /usr/local/include/python2.5/pyconfig.h:932:1: warning:
> > "_POSIX_C_SOURCE" redefined
> > <command-line>: warning: this is the location of the previous
> > definition /usr/local/apache2/build/libtool --silent --mode=compile
> > gcc -prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11
> > -D_REENTRANT -D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread
> > -I/usr/local/apache2/include  -I/usr/local/apache2/include
> > -I/usr/local/apache2/include  -I/tmp/mod_python-3.3.1/src/include
> > -I/usr/local/apache2/include -I/usr/local/include/python2.5  -c -o
> > filterobject.lo filterobject.c && touch filterobject.slo In file
> > included from /usr/local/include/python2.5/Python.h:8,
> >                  from
> /tmp/mod_python-3.3.1/src/include/mod_python.h:80,
> >                  from filterobject.c:28:
> > /usr/local/include/python2.5/pyconfig.h:932:1: warning:
> > "_POSIX_C_SOURCE" redefined
> > <command-line>: warning: this is the location of the previous
> > definition /usr/local/apache2/build/libtool --silent --mode=compile
> > gcc -prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11
> > -D_REENTRANT -D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread
> > -I/usr/local/apache2/include  -I/usr/local/apache2/include
> > -I/usr/local/apache2/include  -I/tmp/mod_python-3.3.1/src/include
> > -I/usr/local/apache2/include -I/usr/local/include/python2.5  -c -o
> > hlist.lo hlist.c && touch hlist.slo In file included from
> > /usr/local/include/python2.5/Python.h:8,
> >                  from
> /tmp/mod_python-3.3.1/src/include/mod_python.h:80,
> >                  from hlist.c:28:
> > /usr/local/include/python2.5/pyconfig.h:932:1: warning:
> > "_POSIX_C_SOURCE" redefined
> > <command-line>: warning: this is the location of the previous
> > definition /usr/local/apache2/build/libtool --silent --mode=compile
> > gcc -prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11
> > -D_REENTRANT -D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread
> > -I/usr/local/apache2/include  -I/usr/local/apache2/include
> > -I/usr/local/apache2/include  -I/tmp/mod_python-3.3.1/src/include
> > -I/usr/local/apache2/include -I/usr/local/include/python2.5  -c -o
> > hlistobject.lo hlistobject.c && touch hlistobject.slo In file included
>
> > from /usr/local/include/python2.5/Python.h:8,
> >                  from
> /tmp/mod_python-3.3.1/src/include/mod_python.h:80,
> >                  from hlistobject.c:28:
> > /usr/local/include/python2.5/pyconfig.h:932:1: warning:
> > "_POSIX_C_SOURCE" redefined
> > <command-line>: warning: this is the location of the previous
> > definition /usr/local/apache2/build/libtool --silent --mode=compile
> > gcc -prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -DHPUX11
> > -D_REENTRANT -D_XOPEN_SOURCE_EXTENDED -g -O2 -pthread
> > -I/usr/local/apache2/include  -I/usr/local/apache2/include
> > -I/usr/local/apache2/include  -I/tmp/mod_python-3.3.1/src/include
> > -I/usr/local/apache2/include -I/usr/local/include/python2.5  -c -o
> > finfoobject.lo finfoobject.c && touch finfoobject.slo In file included
>
> > from /usr/local/include/python2.5/Python.h:8,
> >                  from
> /tmp/mod_python-3.3.1/src/include/mod_python.h:80,
> >                  from finfoobject.c:25:
> > /usr/local/include/python2.5/pyconfig.h:932:1: warning:
> > "_POSIX_C_SOURCE" redefined
> > <command-line>: warning: this is the location of the previous
> > definition
> > finfoobject.c:278: warning: 'intargfunc' is deprecated
> > finfoobject.c:278: warning: initialization from incompatible pointer
> > type /usr/local/apache2/build/libtool --silent --mode=link gcc -o
> > mod_python.la  -rpath /usr/local/apache2/modules -module
> > -avoid-version    finfoobject.lo hlistobject.lo hlist.lo
> filterobject.lo
> > connobject.lo serverobject.lo util.lo tableobject.lo requestobject.lo
> > _apachemodule.lo mod_python.lo -L/usr/local/lib/python2.5/config
> > -Wl,-E -Wl,+s -lm
> > -lpython2.5 -lnsl -lrt -ldld -lm
> > /usr/ccs/bin/ld: Invalid loader fixup in text space needed in output
> > file for symbol "_PyEval_SliceIndex" in input file
> > "/usr/local/lib/python2.5/config/libpython2.5.a(listobject.o)"
> > collect2: ld returned 1 exit status
> > apxs:Error: Command failed with rc=65536 .
> > gmake[1]: *** [mod_python.so] Error 1
> > gmake[1]: Leaving directory `/tmp/mod_python-3.3.1/src'
> > gmake: *** [do_dso] Error 2
> > #
> >
> > _______________________________________________
> >  Mod_python mailing list
> >  Mod_python@modpython.org
> >  http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> >
>
From jnbes at atreal.net  Wed Feb 20 04:16:34 2008
From: jnbes at atreal.net (Jean-Nicolas Bes)
Date: Wed Feb 20 04:25:21 2008
Subject: [mod_python] mod_python
Message-ID: <fpgr5j$l1u$1@ger.gmane.org>

Hi!


I was wondering how mod_python manages to launch multiple python 
interpreters within the same process. I had a look at the source code, 
but I'll be pleased if someone could explain me quickly how it works.


Best regards,
	Jean-Nicolas B?s.

From graham.dumpleton at gmail.com  Wed Feb 20 05:31:25 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Feb 20 05:31:56 2008
Subject: [mod_python] mod_python
In-Reply-To: <fpgr5j$l1u$1@ger.gmane.org>
References: <fpgr5j$l1u$1@ger.gmane.org>
Message-ID: <88e286470802200231r6be9716ag970cb3c441349fff@mail.gmail.com>

On 20/02/2008, Jean-Nicolas Bes <jnbes@atreal.net> wrote:
> Hi!
>
> I was wondering how mod_python manages to launch multiple python
> interpreters within the same process. I had a look at the source code,
> but I'll be pleased if someone could explain me quickly how it works.

It inherits the main Python interpreter instance from the
Py_Initialize() call and It uses the Py_NewInterpreter() call to
create additional sub interpreters when required. See Python C API
documentation for more information.

Graham
From jnbes at atreal.net  Wed Feb 20 06:39:53 2008
From: jnbes at atreal.net (Jean-Nicolas Bes)
Date: Wed Feb 20 06:40:09 2008
Subject: [mod_python] Re: mod_python
In-Reply-To: <88e286470802200231r6be9716ag970cb3c441349fff@mail.gmail.com>
References: <fpgr5j$l1u$1@ger.gmane.org>
	<88e286470802200231r6be9716ag970cb3c441349fff@mail.gmail.com>
Message-ID: <fph3i9$jvq$1@ger.gmane.org>

Graham Dumpleton wrote:
> On 20/02/2008, Jean-Nicolas Bes <jnbes@atreal.net> wrote:
>> Hi!
>>
>> I was wondering how mod_python manages to launch multiple python
>> interpreters within the same process. I had a look at the source code,
>> but I'll be pleased if someone could explain me quickly how it works.
> 
> It inherits the main Python interpreter instance from the
> Py_Initialize() call and It uses the Py_NewInterpreter() call to
> create additional sub interpreters when required. See Python C API
> documentation for more information.


Yeah, I figured this out, but what I wanted to know if the GIL was 
common to every interpreter or if mod_python managed a separate GIL for 
every interpreter.


Regards,
	Jean-Nicolas.

From argriffi at ncsu.edu  Wed Feb 20 12:23:19 2008
From: argriffi at ncsu.edu (argriffi)
Date: Wed Feb 20 12:23:30 2008
Subject: [mod_python] Re: mod_python and C extensions
In-Reply-To: <88e286470802191239uf22331ct6082523c5e3163@mail.gmail.com>
References: <47BB1A31.3060306@ncsu.edu>
	<88e286470802191239uf22331ct6082523c5e3163@mail.gmail.com>
Message-ID: <47BC6207.5020809@ncsu.edu>

Hi guys,

I'm having a problem getting Apache and mod_python to use my C extension 
module mymodule.so instead of my raw python module mymodule.py.  Both 
modules have been tested outside of Apache/mod_python.

There is no error when I have mymodule.py in the directory, but when I 
replace it with mymodule.so (in the same directory), I get an error.  
This seems to rule out problems with the python path.

The .py and .so modules that I have tried both have the same owner and 
group, and have the same permissions except that the .so file has 
execute permissions.  This seems to rule out problems with Apache user 
permissions.

I tried some stuff from googling and from BasicsOfModuleImporting and 
ModuleImportingIsBroken, but I've had no luck and I'm about to start 
using CherryPy or something.

Alex





Graham Dumpleton wrote:
> Can you please use the mod_python mailing list to ask questions.
>
>   http://mailman.modpython.org/mailman/listinfo/mod_python
>
> Your problem though sounds like you need to either set PythonPath, or
> the file, or directories it is in are not readable to the user that
> Apache runs as.
>
> Graham
>
>
>   
>> Hi,
>>
>> I'm using mod_python to provide some web apps, and I recently rewrote
>> mymodule.py as the C extension mymodule.so.  I was glad to see that it
>> runs about 100x as fast, but I was unhappy to see that it apparently
>> cannot be imported when I am using mod_python.  I get the ImportError
>> "No module named mymodule".  Since I seem to fail at googling, do you
>> have any tips to help me solve this?
>>
>>
>>
>>
>>
>>
>>     

From graham.dumpleton at gmail.com  Wed Feb 20 15:27:00 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Feb 20 15:27:07 2008
Subject: [mod_python] Re: mod_python
In-Reply-To: <fph3i9$jvq$1@ger.gmane.org>
References: <fpgr5j$l1u$1@ger.gmane.org>
	<88e286470802200231r6be9716ag970cb3c441349fff@mail.gmail.com>
	<fph3i9$jvq$1@ger.gmane.org>
Message-ID: <88e286470802201227l74a149eqd79aa6d4c898f972@mail.gmail.com>

There is only one GIL across all interpreters within the process.

On 20/02/2008, Jean-Nicolas Bes <jnbes@atreal.net> wrote:
> Graham Dumpleton wrote:
> > On 20/02/2008, Jean-Nicolas Bes <jnbes@atreal.net> wrote:
> >> Hi!
> >>
> >> I was wondering how mod_python manages to launch multiple python
> >> interpreters within the same process. I had a look at the source code,
> >> but I'll be pleased if someone could explain me quickly how it works.
> >
> > It inherits the main Python interpreter instance from the
> > Py_Initialize() call and It uses the Py_NewInterpreter() call to
> > create additional sub interpreters when required. See Python C API
> > documentation for more information.
>
>
> Yeah, I figured this out, but what I wanted to know if the GIL was
> common to every interpreter or if mod_python managed a separate GIL for
> every interpreter.
>
>
> Regards,
>         Jean-Nicolas.
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From graham.dumpleton at gmail.com  Wed Feb 20 15:35:32 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Feb 20 15:35:39 2008
Subject: [mod_python] Re: mod_python and C extensions
In-Reply-To: <47BC6207.5020809@ncsu.edu>
References: <47BB1A31.3060306@ncsu.edu>
	<88e286470802191239uf22331ct6082523c5e3163@mail.gmail.com>
	<47BC6207.5020809@ncsu.edu>
Message-ID: <88e286470802201235x24ee3c3cte35c737f438191ca@mail.gmail.com>

In mod_python 3.3.1, Python packages, nor C extension modules will be
found if they reside in the document directory which is the target of
the URL and thus PythonHandler directive. Only .py files are used.
Python packages and C extension modules must be in a physical
directory specified in PythonPath or otherwise on sys.path. It isn't
recommended to be putting the document tree directory in PythonPath
because it causes an overlap between mod_python module importer path
and standard module search path. Thus, put your .so file outside of
the document tree somewhere with that directory in PythonPath, and use
handler .py wrapper in document tree to import it from that location
and relay the call. The two will obviously need to have a different
basename now.

For more details about module importer see import_module() documentation in:

  http://www.modpython.org/live/current/doc-html/pyapi-apmeth.html

Other than that suggestion, need to see the mod_python configuration
from Apache and for you to also say what directory path your files are
in so can relate that to the configuration.

Graham

On 21/02/2008, argriffi <argriffi@ncsu.edu> wrote:
> Hi guys,
>
> I'm having a problem getting Apache and mod_python to use my C extension
> module mymodule.so instead of my raw python module mymodule.py.  Both
> modules have been tested outside of Apache/mod_python.
>
> There is no error when I have mymodule.py in the directory, but when I
> replace it with mymodule.so (in the same directory), I get an error.
> This seems to rule out problems with the python path.
>
> The .py and .so modules that I have tried both have the same owner and
> group, and have the same permissions except that the .so file has
> execute permissions.  This seems to rule out problems with Apache user
> permissions.
>
> I tried some stuff from googling and from BasicsOfModuleImporting and
> ModuleImportingIsBroken, but I've had no luck and I'm about to start
> using CherryPy or something.
>
> Alex
>
>
>
>
>
> Graham Dumpleton wrote:
> > Can you please use the mod_python mailing list to ask questions.
> >
> >   http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> > Your problem though sounds like you need to either set PythonPath, or
> > the file, or directories it is in are not readable to the user that
> > Apache runs as.
> >
> > Graham
> >
> >
> >
> >> Hi,
> >>
> >> I'm using mod_python to provide some web apps, and I recently rewrote
> >> mymodule.py as the C extension mymodule.so.  I was glad to see that it
> >> runs about 100x as fast, but I was unhappy to see that it apparently
> >> cannot be imported when I am using mod_python.  I get the ImportError
> >> "No module named mymodule".  Since I seem to fail at googling, do you
> >> have any tips to help me solve this?
> >>
> >>
> >>
> >>
> >>
> >>
> >>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From ajcoon at gmail.com  Wed Feb 20 20:12:22 2008
From: ajcoon at gmail.com (AJ Coon)
Date: Wed Feb 20 20:12:28 2008
Subject: [mod_python] sys.path problem
Message-ID: <7a360be50802201712t3c059c6erf534c0ad24efd34e@mail.gmail.com>

Hello,

I have an issue with two different handlers running on the same apache
server.

They seem to be "sharing" (read: overwriting each other's) sys.path.  I'm
printing the output of sys.path before any of my import statements in each
handler to verify this.  It seems like I can make several requests to
handler "A" with no problem, but then if handler "B" is called, and then
subsequently handler "A" is called again, sys.path has been overwritten by
handler "B" for handler "A".  Ugh.

- Each handler is defined in its own virtual host in apache.
- Each handler is named differently (i.e. PythonHandler handlerA,
PythonHandler handlerB)
- Each handler runs in its own sub-directory (i.e. /var/handlerA,
/var/handlerB)
- In the doc root of each handler's virtual host, I have a .htaccess file
that contains a PythonInterpreter directive, defining a different named
interpreter to be used (i.e. PythonInterpreter InterpA, PythonInterpreter
InterpB)


How can I ensure that each handler has its own sys.path that is not affected
by the other handler, ever?


I am running on the following stack:

Apache/2.0.54 (Debian GNU/Linux) mod_python/3.3.1 Python/2.3.5
mod_ssl/2.0.54 OpenSSL/0.9.7e


Thanks,
-aj
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20080220/b489f400/attachment.html
From graham.dumpleton at gmail.com  Wed Feb 20 20:42:22 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Feb 20 20:42:31 2008
Subject: [mod_python] sys.path problem
In-Reply-To: <7a360be50802201712t3c059c6erf534c0ad24efd34e@mail.gmail.com>
References: <7a360be50802201712t3c059c6erf534c0ad24efd34e@mail.gmail.com>
Message-ID: <88e286470802201742o2af32aecw41ffc31b1d6258c1@mail.gmail.com>

Don't use PythonPath directive. Instead, read about the new module
importer in mod_python 3.3.1 which avoids these sort of problems. See
documentation for 'import_module()' in:

   http://www.modpython.org/live/current/doc-html/pyapi-apmeth.html

To explain better, would need to see the exact configuration you are
using for mod_python.

Graham

On 21/02/2008, AJ Coon <ajcoon@gmail.com> wrote:
> Hello,
>
> I have an issue with two different handlers running on the same apache
> server.
>
> They seem to be "sharing" (read: overwriting each other's) sys.path.  I'm
> printing the output of sys.path before any of my import statements in each
> handler to verify this.  It seems like I can make several requests to
> handler "A" with no problem, but then if handler "B" is called, and then
> subsequently handler "A" is called again, sys.path has been overwritten by
> handler "B" for handler "A".  Ugh.
>
> - Each handler is defined in its own virtual host in apache.
> - Each handler is named differently (i.e. PythonHandler handlerA,
> PythonHandler handlerB)
> - Each handler runs in its own sub-directory (i.e. /var/handlerA,
> /var/handlerB)
>  - In the doc root of each handler's virtual host, I have a .htaccess file
> that contains a PythonInterpreter directive, defining a different named
> interpreter to be used (i.e. PythonInterpreter InterpA, PythonInterpreter
> InterpB)
>
>
> How can I ensure that each handler has its own sys.path that is not affected
> by the other handler, ever?
>
>
> I am running on the following stack:
>
> Apache/2.0.54 (Debian GNU/Linux) mod_python/3.3.1 Python/2.3.5
> mod_ssl/2.0.54 OpenSSL/0.9.7e
>
>
> Thanks,
> -aj
>
> _______________________________________________
>  Mod_python mailing list
>  Mod_python@modpython.org
>  http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
From ajcoon at gmail.com  Wed Feb 20 21:23:49 2008
From: ajcoon at gmail.com (AJ Coon)
Date: Wed Feb 20 21:23:56 2008
Subject: [mod_python] sys.path problem
In-Reply-To: <88e286470802201742o2af32aecw41ffc31b1d6258c1@mail.gmail.com>
References: <7a360be50802201712t3c059c6erf534c0ad24efd34e@mail.gmail.com>
	<88e286470802201742o2af32aecw41ffc31b1d6258c1@mail.gmail.com>
Message-ID: <7a360be50802201823w27a95099t9f72c9c33b1bc3b0@mail.gmail.com>

Hi Graham,

I'm not using PythonPath anywhere, though my handlers both make
sys.path.append() calls to add various library paths needed by each.
Inconveniently, each of these handlers use different versions of some of the
same libraries.  It's a bit of a mess, but this all worked fine on 3.1.3.
Now that I upgraded to 3.3.1 (and changed nothing else), it's broken.
Rolling back seems the obvious choice, but I think what I'm trying to do
*is* do-able, no?


As you requested, I have included my configuration below.  I'm just
developing on a workstation and DNS is managed by /etc/hosts, hence the
.localdomain host names.  Without further adieu:

aj@aj-5150:~$ cat cat /etc/apache2/mods-enabled/mod_python.load
LoadModule python_module /usr/lib/apache2/modules/mod_python.so

aj@aj-5150:~$ cat /etc/apache2/sites-enabled/000-handlera
<VirtualHost handlera.localdomain>
    DocumentRoot /var/handlerA/www
    ScriptAlias /handlerA/ "/var/handlerA/www/handlerA_root"

    <Directory "/var/handlerA/www/handlerA_root">
    SetHandler mod_python
    PythonHandler handlerA
    PythonDebug On
    PythonAutoReload On
    PythonOption CACHE Off
    </Directory>

    ServerName handlera.localdomain

    ErrorLog /var/log/apache2/handlerA-error_log
    CustomLog /var/log/apache2/handlerA-access_log combined
</VirtualHost>

aj@aj-5150:~$ cat /etc/apache2/sites-enabled/001-handlerb
<VirtualHost handlerb.localdomain>
    DocumentRoot /var/handlerB/www
    ScriptAlias /handlerB/ "/var/handlerB/www/handlerB_root"

    <Directory "/var/handlerB/www/handlerB_root">
    SetHandler mod_python
    PythonHandler handlerB
    PythonDebug On
    PythonAutoReload On
    PythonOption CACHE Off
    </Directory>

    ServerName handlerb.localdomain

    ErrorLog /var/log/apache2/handlerB-error_log
    CustomLog /var/log/apache2/handlerB-access_log combined
</VirtualHost>

aj@aj-5150:~$ cat /var/handlerA/www/.htaccess
PythonInterpreter InterpA
Options -Indexes

aj@aj-5150:~$ cat /var/handlerB/www/.htaccess
PythonInterpreter InterpB
Options -Indexes


I hope this makes things more clear.  I hope I'm not asking for the
impossible.

-aj



On Wed, Feb 20, 2008 at 8:42 PM, Graham Dumpleton <
graham.dumpleton@gmail.com> wrote:

> Don't use PythonPath directive. Instead, read about the new module
> importer in mod_python 3.3.1 which avoids these sort of problems. See
> documentation for 'import_module()' in:
>
>   http://www.modpython.org/live/current/doc-html/pyapi-apmeth.html
>
> To explain better, would need to see the exact configuration you are
> using for mod_python.
>
> Graham
>
> On 21/02/2008, AJ Coon <ajcoon@gmail.com> wrote:
> > Hello,
> >
> > I have an issue with two different handlers running on the same apache
> > server.
> >
> > They seem to be "sharing" (read: overwriting each other's) sys.path.
>  I'm
> > printing the output of sys.path before any of my import statements in
> each
> > handler to verify this.  It seems like I can make several requests to
> > handler "A" with no problem, but then if handler "B" is called, and then
> > subsequently handler "A" is called again, sys.path has been overwritten
> by
> > handler "B" for handler "A".  Ugh.
> >
> > - Each handler is defined in its own virtual host in apache.
> > - Each handler is named differently (i.e. PythonHandler handlerA,
> > PythonHandler handlerB)
> > - Each handler runs in its own sub-directory (i.e. /var/handlerA,
> > /var/handlerB)
> >  - In the doc root of each handler's virtual host, I have a .htaccess
> file
> > that contains a PythonInterpreter directive, defining a different named
> > interpreter to be used (i.e. PythonInterpreter InterpA,
> PythonInterpreter
> > InterpB)
> >
> >
> > How can I ensure that each handler has its own sys.path that is not
> affected
> > by the other handler, ever?
> >
> >
> > I am running on the following stack:
> >
> > Apache/2.0.54 (Debian GNU/Linux) mod_python/3.3.1 Python/2.3.5
> > mod_ssl/2.0.54 OpenSSL/0.9.7e
> >
> >
> > Thanks,
> > -aj
> >
> > _______________________________________________
> >  Mod_python mailing list
> >  Mod_python@modpython.org
> >  http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> >
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20080220/c7bd8201/attachment-0001.html
From graham.dumpleton at gmail.com  Wed Feb 20 21:41:03 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Feb 20 21:41:09 2008
Subject: [mod_python] sys.path problem
In-Reply-To: <7a360be50802201823w27a95099t9f72c9c33b1bc3b0@mail.gmail.com>
References: <7a360be50802201712t3c059c6erf534c0ad24efd34e@mail.gmail.com>
	<88e286470802201742o2af32aecw41ffc31b1d6258c1@mail.gmail.com>
	<7a360be50802201823w27a95099t9f72c9c33b1bc3b0@mail.gmail.com>
Message-ID: <88e286470802201841r70c0392amb8ce10cbc51572ba@mail.gmail.com>

On 21/02/2008, AJ Coon <ajcoon@gmail.com> wrote:
> Hi Graham,
>
> I'm not using PythonPath anywhere, though my handlers both make
> sys.path.append() calls to add various library paths needed by each.
> Inconveniently, each of these handlers use different versions of some of the
> same libraries.  It's a bit of a mess, but this all worked fine on 3.1.3.
> Now that I upgraded to 3.3.1 (and changed nothing else), it's broken.
> Rolling back seems the obvious choice, but I think what I'm trying to do
> *is* do-able, no?

As per the documentation I pointed out, try setting:

  PythonOption mod_python.legacy.importer name

this will restore the old module importer functionality. If it still
doesn't work, possibly something in Apache configuration causing
issues instead.

In principle I can't see a problem with what you are trying to do,
although see comments below.

> As you requested, I have included my configuration below.  I'm just
> developing on a workstation and DNS is managed by /etc/hosts, hence the
> .localdomain host names.  Without further adieu:

Do those names map to distinct IP addresses or the same?

In Apache documentation it doesn't recommend that you use FQDN in
VirtualHost argument, but an IP address. Ie., in:

  http://httpd.apache.org/docs/2.2/mod/core.html#virtualhost

It says:

  """A fully qualified domain name for the IP address of the virtual
host (not recommended)"""

The ServerName within the VirtualHost is what actually distinguishes
them if using name based lookup against the same IP address.

If using IPs or names rather than just *:80 then NameVirtualHost isn't
required, but there have been cases where lack of NameVirtualHost in
Apache configuration has caused mod_python to somehow merge sites when
it shouldn't have been. Not know whether this is a bug in mod_python
or not as when people got it working by adding NameVirtualHost, they
were then interested in helping to debug the underlying problem.

> aj@aj-5150:~$ cat /var/handlerA/www/.htaccess
> PythonInterpreter InterpA
> Options -Indexes
>
> aj@aj-5150:~$ cat /var/handlerB/www/.htaccess
>  PythonInterpreter InterpB
> Options -Indexes

Have you confirmed that the .htaccess files are in fact being
consulted. You can do this by introducing a syntax error in them. Ie.,
add a line consisting of 'CRAP'. If when making request you then get a
500 error they are being consulted. The lack of an AllowOverride for
the directories suggests they may not even be getting consulted and so
the PythonInterpreter directives may not be getting applied. This may
be combining with NameVirtualHost issues to end up with stuff running
in same interpreter.

You can work out which interpreter code is running in by printing out
'apache.interpreter' from mod_python module.

Graham
From ajcoon at gmail.com  Thu Feb 21 00:05:45 2008
From: ajcoon at gmail.com (AJ Coon)
Date: Thu Feb 21 00:05:52 2008
Subject: [mod_python] sys.path problem
In-Reply-To: <88e286470802201841r70c0392amb8ce10cbc51572ba@mail.gmail.com>
References: <7a360be50802201712t3c059c6erf534c0ad24efd34e@mail.gmail.com>
	<88e286470802201742o2af32aecw41ffc31b1d6258c1@mail.gmail.com>
	<7a360be50802201823w27a95099t9f72c9c33b1bc3b0@mail.gmail.com>
	<88e286470802201841r70c0392amb8ce10cbc51572ba@mail.gmail.com>
Message-ID: <7a360be50802202105n3025357es330f512a233dca04@mail.gmail.com>

Hi Graham,

Thanks for the further suggestions.

Here's what I've tried, still able to replicate issue:

- Verified that my .htaccess files are being read.  I believe that
AllowOverride is set globally on my Apache server (probably not safe in real
life)
- Added PythonOption mod_python.legacy.importer config directives to both
handlers' .htaccess files
- Replaced hostnames with IP/port values in VirtualHost configuration

sys.path is evil.


-aj

On Wed, Feb 20, 2008 at 9:41 PM, Graham Dumpleton <
graham.dumpleton@gmail.com> wrote:

> On 21/02/2008, AJ Coon <ajcoon@gmail.com> wrote:
> > Hi Graham,
> >
> > I'm not using PythonPath anywhere, though my handlers both make
> > sys.path.append() calls to add various library paths needed by each.
> > Inconveniently, each of these handlers use different versions of some of
> the
> > same libraries.  It's a bit of a mess, but this all worked fine on 3.1.3
> .
> > Now that I upgraded to 3.3.1 (and changed nothing else), it's broken.
> > Rolling back seems the obvious choice, but I think what I'm trying to do
> > *is* do-able, no?
>
> As per the documentation I pointed out, try setting:
>
>  PythonOption mod_python.legacy.importer name
>
> this will restore the old module importer functionality. If it still
> doesn't work, possibly something in Apache configuration causing
> issues instead.
>
> In principle I can't see a problem with what you are trying to do,
> although see comments below.
>
> > As you requested, I have included my configuration below.  I'm just
> > developing on a workstation and DNS is managed by /etc/hosts, hence the
> > .localdomain host names.  Without further adieu:
>
> Do those names map to distinct IP addresses or the same?
>
> In Apache documentation it doesn't recommend that you use FQDN in
> VirtualHost argument, but an IP address. Ie., in:
>
>  http://httpd.apache.org/docs/2.2/mod/core.html#virtualhost
>
> It says:
>
>  """A fully qualified domain name for the IP address of the virtual
> host (not recommended)"""
>
> The ServerName within the VirtualHost is what actually distinguishes
> them if using name based lookup against the same IP address.
>
> If using IPs or names rather than just *:80 then NameVirtualHost isn't
> required, but there have been cases where lack of NameVirtualHost in
> Apache configuration has caused mod_python to somehow merge sites when
> it shouldn't have been. Not know whether this is a bug in mod_python
> or not as when people got it working by adding NameVirtualHost, they
> were then interested in helping to debug the underlying problem.
>
> > aj@aj-5150:~$ cat /var/handlerA/www/.htaccess
> > PythonInterpreter InterpA
> > Options -Indexes
> >
> > aj@aj-5150:~$ cat /var/handlerB/www/.htaccess
> >  PythonInterpreter InterpB
> > Options -Indexes
>
> Have you confirmed that the .htaccess files are in fact being
> consulted. You can do this by introducing a syntax error in them. Ie.,
> add a line consisting of 'CRAP'. If when making request you then get a
> 500 error they are being consulted. The lack of an AllowOverride for
> the directories suggests they may not even be getting consulted and so
> the PythonInterpreter directives may not be getting applied. This may
> be combining with NameVirtualHost issues to end up with stuff running
> in same interpreter.
>
> You can work out which interpreter code is running in by printing out
> 'apache.interpreter' from mod_python module.
>
> Graham
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20080221/bb480047/attachment.html
From ajcoon at gmail.com  Thu Feb 21 00:13:13 2008
From: ajcoon at gmail.com (AJ Coon)
Date: Thu Feb 21 00:13:20 2008
Subject: [mod_python] sys.path problem
In-Reply-To: <88e286470802201841r70c0392amb8ce10cbc51572ba@mail.gmail.com>
References: <7a360be50802201712t3c059c6erf534c0ad24efd34e@mail.gmail.com>
	<88e286470802201742o2af32aecw41ffc31b1d6258c1@mail.gmail.com>
	<7a360be50802201823w27a95099t9f72c9c33b1bc3b0@mail.gmail.com>
	<88e286470802201841r70c0392amb8ce10cbc51572ba@mail.gmail.com>
Message-ID: <7a360be50802202113s75db126eibf90f6010955a10a@mail.gmail.com>

Hi Graham,

I wonder if this is a useful piece of information.  I just noticed this in
my logs:

[Wed Feb 20 23:02:46 2008] [warn] mod_python (pid=29597,
interpreter='InterpB'): Module directory listed in "sys.path". This may
cause problems. Please check code. File being imported is
"/var/handlerB/www/handlerB_root/ProjectModule.py".

I'm not sure I understand what it's complaining about?


-aj



On Wed, Feb 20, 2008 at 9:41 PM, Graham Dumpleton <
graham.dumpleton@gmail.com> wrote:

> On 21/02/2008, AJ Coon <ajcoon@gmail.com> wrote:
> > Hi Graham,
> >
> > I'm not using PythonPath anywhere, though my handlers both make
> > sys.path.append() calls to add various library paths needed by each.
> > Inconveniently, each of these handlers use different versions of some of
> the
> > same libraries.  It's a bit of a mess, but this all worked fine on 3.1.3
> .
> > Now that I upgraded to 3.3.1 (and changed nothing else), it's broken.
> > Rolling back seems the obvious choice, but I think what I'm trying to do
> > *is* do-able, no?
>
> As per the documentation I pointed out, try setting:
>
>  PythonOption mod_python.legacy.importer name
>
> this will restore the old module importer functionality. If it still
> doesn't work, possibly something in Apache configuration causing
> issues instead.
>
> In principle I can't see a problem with what you are trying to do,
> although see comments below.
>
> > As you requested, I have included my configuration below.  I'm just
> > developing on a workstation and DNS is managed by /etc/hosts, hence the
> > .localdomain host names.  Without further adieu:
>
> Do those names map to distinct IP addresses or the same?
>
> In Apache documentation it doesn't recommend that you use FQDN in
> VirtualHost argument, but an IP address. Ie., in:
>
>  http://httpd.apache.org/docs/2.2/mod/core.html#virtualhost
>
> It says:
>
>  """A fully qualified domain name for the IP address of the virtual
> host (not recommended)"""
>
> The ServerName within the VirtualHost is what actually distinguishes
> them if using name based lookup against the same IP address.
>
> If using IPs or names rather than just *:80 then NameVirtualHost isn't
> required, but there have been cases where lack of NameVirtualHost in
> Apache configuration has caused mod_python to somehow merge sites when
> it shouldn't have been. Not know whether this is a bug in mod_python
> or not as when people got it working by adding NameVirtualHost, they
> were then interested in helping to debug the underlying problem.
>
> > aj@aj-5150:~$ cat /var/handlerA/www/.htaccess
> > PythonInterpreter InterpA
> > Options -Indexes
> >
> > aj@aj-5150:~$ cat /var/handlerB/www/.htaccess
> >  PythonInterpreter InterpB
> > Options -Indexes
>
> Have you confirmed that the .htaccess files are in fact being
> consulted. You can do this by introducing a syntax error in them. Ie.,
> add a line consisting of 'CRAP'. If when making request you then get a
> 500 error they are being consulted. The lack of an AllowOverride for
> the directories suggests they may not even be getting consulted and so
> the PythonInterpreter directives may not be getting applied. This may
> be combining with NameVirtualHost issues to end up with stuff running
> in same interpreter.
>
> You can work out which interpreter code is running in by printing out
> 'apache.interpreter' from mod_python module.
>
> Graham
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20080221/744c9e75/attachment.html
From graham.dumpleton at gmail.com  Thu Feb 21 00:14:49 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Feb 21 00:14:55 2008
Subject: [mod_python] sys.path problem
In-Reply-To: <7a360be50802202105n3025357es330f512a233dca04@mail.gmail.com>
References: <7a360be50802201712t3c059c6erf534c0ad24efd34e@mail.gmail.com>
	<88e286470802201742o2af32aecw41ffc31b1d6258c1@mail.gmail.com>
	<7a360be50802201823w27a95099t9f72c9c33b1bc3b0@mail.gmail.com>
	<88e286470802201841r70c0392amb8ce10cbc51572ba@mail.gmail.com>
	<7a360be50802202105n3025357es330f512a233dca04@mail.gmail.com>
Message-ID: <88e286470802202114w3bf2f669iec58682f1f54d9a9@mail.gmail.com>

On 21/02/2008, AJ Coon <ajcoon@gmail.com> wrote:
> Hi Graham,
>
> Thanks for the further suggestions.
>
> Here's what I've tried, still able to replicate issue:
>
> - Verified that my .htaccess files are being read.  I believe that
> AllowOverride is set globally on my Apache server (probably not safe in real
> life)
>  - Added PythonOption mod_python.legacy.importer config directives to both
> handlers' .htaccess files
> - Replaced hostnames with IP/port values in VirtualHost configuration

Did you setup appropriate NameVirtualHost definitions at same time:

  http://httpd.apache.org/docs/2.2/mod/core.html#namevirtualhost

> sys.path is evil.

Used to be worse. See:

  http://www.dscpl.com.au/wiki/ModPython/Articles/ModuleImportingIsBroken

What was mod_python.apache.interpreter giving in each location?

You might even set PythonHandler to be:

  PythonHandler mod_python.testhandler

in each location as may help in debugging what the differences are in
the configuration passed through.

BTW, what is the application? Are you heavily dependent on mod_python
specific features?

Graham

> -aj
>
>
>
> On Wed, Feb 20, 2008 at 9:41 PM, Graham Dumpleton
> <graham.dumpleton@gmail.com> wrote:
> >
> > On 21/02/2008, AJ Coon <ajcoon@gmail.com> wrote:
> >
> > > Hi Graham,
> > >
> > > I'm not using PythonPath anywhere, though my handlers both make
> > > sys.path.append() calls to add various library paths needed by each.
> > > Inconveniently, each of these handlers use different versions of some of
> the
> > > same libraries.  It's a bit of a mess, but this all worked fine on
> 3.1.3.
> > > Now that I upgraded to 3.3.1 (and changed nothing else), it's broken.
> > > Rolling back seems the obvious choice, but I think what I'm trying to do
> > > *is* do-able, no?
> >
> > As per the documentation I pointed out, try setting:
> >
> >  PythonOption mod_python.legacy.importer name
> >
> > this will restore the old module importer functionality. If it still
> > doesn't work, possibly something in Apache configuration causing
> > issues instead.
> >
> > In principle I can't see a problem with what you are trying to do,
> > although see comments below.
> >
> >
> > > As you requested, I have included my configuration below.  I'm just
> > > developing on a workstation and DNS is managed by /etc/hosts, hence the
> > > .localdomain host names.  Without further adieu:
> >
> > Do those names map to distinct IP addresses or the same?
> >
> > In Apache documentation it doesn't recommend that you use FQDN in
> > VirtualHost argument, but an IP address. Ie., in:
> >
> >
> http://httpd.apache.org/docs/2.2/mod/core.html#virtualhost
> >
> > It says:
> >
> >  """A fully qualified domain name for the IP address of the virtual
> > host (not recommended)"""
> >
> > The ServerName within the VirtualHost is what actually distinguishes
> > them if using name based lookup against the same IP address.
> >
> > If using IPs or names rather than just *:80 then NameVirtualHost isn't
> > required, but there have been cases where lack of NameVirtualHost in
> > Apache configuration has caused mod_python to somehow merge sites when
> > it shouldn't have been. Not know whether this is a bug in mod_python
> > or not as when people got it working by adding NameVirtualHost, they
> > were then interested in helping to debug the underlying problem.
> >
> >
> > > aj@aj-5150:~$ cat /var/handlerA/www/.htaccess
> > > PythonInterpreter InterpA
> > > Options -Indexes
> > >
> > > aj@aj-5150:~$ cat /var/handlerB/www/.htaccess
> > >  PythonInterpreter InterpB
> > > Options -Indexes
> >
> > Have you confirmed that the .htaccess files are in fact being
> > consulted. You can do this by introducing a syntax error in them. Ie.,
> > add a line consisting of 'CRAP'. If when making request you then get a
> > 500 error they are being consulted. The lack of an AllowOverride for
> > the directories suggests they may not even be getting consulted and so
> > the PythonInterpreter directives may not be getting applied. This may
> > be combining with NameVirtualHost issues to end up with stuff running
> > in same interpreter.
> >
> > You can work out which interpreter code is running in by printing out
> > 'apache.interpreter' from mod_python module.
> >
> > Graham
> >
>
>
From graham.dumpleton at gmail.com  Thu Feb 21 00:25:44 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Feb 21 00:25:50 2008
Subject: [mod_python] sys.path problem
In-Reply-To: <7a360be50802202113s75db126eibf90f6010955a10a@mail.gmail.com>
References: <7a360be50802201712t3c059c6erf534c0ad24efd34e@mail.gmail.com>
	<88e286470802201742o2af32aecw41ffc31b1d6258c1@mail.gmail.com>
	<7a360be50802201823w27a95099t9f72c9c33b1bc3b0@mail.gmail.com>
	<88e286470802201841r70c0392amb8ce10cbc51572ba@mail.gmail.com>
	<7a360be50802202113s75db126eibf90f6010955a10a@mail.gmail.com>
Message-ID: <88e286470802202125r4c7aa0dbwaba205d9c48a28a3@mail.gmail.com>

On 21/02/2008, AJ Coon <ajcoon@gmail.com> wrote:
> Hi Graham,
>
> I wonder if this is a useful piece of information.  I just noticed this in
> my logs:
>
> [Wed Feb 20 23:02:46 2008] [warn] mod_python (pid=29597,
> interpreter='InterpB'): Module directory listed in "sys.path". This may
> cause problems. Please check code. File being imported is
> "/var/handlerB/www/handlerB_root/ProjectModule.py".
>
> I'm not sure I understand what it's complaining about?

The new module importer underlaying import_module() and as also used
by Python*Handler tries to keep mod_python module importer path
separate from sys.path. This is because an overlap can cause problems
with modules load duplicate times. You must be explicitly adding the
document directory to sys.path in your script, which you shouldn't do.

Can you show first part of script where you set sys.path.

Graham

>
> -aj
>
>
>
>
> On Wed, Feb 20, 2008 at 9:41 PM, Graham Dumpleton
> <graham.dumpleton@gmail.com> wrote:
>
> >
> > On 21/02/2008, AJ Coon <ajcoon@gmail.com> wrote:
> >
> > > Hi Graham,
> > >
> > > I'm not using PythonPath anywhere, though my handlers both make
> > > sys.path.append() calls to add various library paths needed by each.
> > > Inconveniently, each of these handlers use different versions of some of
> the
> > > same libraries.  It's a bit of a mess, but this all worked fine on
> 3.1.3.
> > > Now that I upgraded to 3.3.1 (and changed nothing else), it's broken.
> > > Rolling back seems the obvious choice, but I think what I'm trying to do
> > > *is* do-able, no?
> >
> > As per the documentation I pointed out, try setting:
> >
> >  PythonOption mod_python.legacy.importer name
> >
> > this will restore the old module importer functionality. If it still
> > doesn't work, possibly something in Apache configuration causing
> > issues instead.
> >
> > In principle I can't see a problem with what you are trying to do,
> > although see comments below.
> >
> >
> > > As you requested, I have included my configuration below.  I'm just
> > > developing on a workstation and DNS is managed by /etc/hosts, hence the
> > > .localdomain host names.  Without further adieu:
> >
> > Do those names map to distinct IP addresses or the same?
> >
> > In Apache documentation it doesn't recommend that you use FQDN in
> > VirtualHost argument, but an IP address. Ie., in:
> >
> >
> http://httpd.apache.org/docs/2.2/mod/core.html#virtualhost
> >
> > It says:
> >
> >  """A fully qualified domain name for the IP address of the virtual
> > host (not recommended)"""
> >
> > The ServerName within the VirtualHost is what actually distinguishes
> > them if using name based lookup against the same IP address.
> >
> > If using IPs or names rather than just *:80 then NameVirtualHost isn't
> > required, but there have been cases where lack of NameVirtualHost in
> > Apache configuration has caused mod_python to somehow merge sites when
> > it shouldn't have been. Not know whether this is a bug in mod_python
> > or not as when people got it working by adding NameVirtualHost, they
> > were then interested in helping to debug the underlying problem.
> >
> >
> > > aj@aj-5150:~$ cat /var/handlerA/www/.htaccess
> > > PythonInterpreter InterpA
> > > Options -Indexes
> > >
> > > aj@aj-5150:~$ cat /var/handlerB/www/.htaccess
> > >  PythonInterpreter InterpB
> > > Options -Indexes
> >
> > Have you confirmed that the .htaccess files are in fact being
> > consulted. You can do this by introducing a syntax error in them. Ie.,
> > add a line consisting of 'CRAP'. If when making request you then get a
> > 500 error they are being consulted. The lack of an AllowOverride for
> > the directories suggests they may not even be getting consulted and so
> > the PythonInterpreter directives may not be getting applied. This may
> > be combining with NameVirtualHost issues to end up with stuff running
> > in same interpreter.
> >
> > You can work out which interpreter code is running in by printing out
> > 'apache.interpreter' from mod_python module.
> >
> > Graham
> >
>
>
From ajcoon at gmail.com  Thu Feb 21 00:40:32 2008
From: ajcoon at gmail.com (AJ Coon)
Date: Thu Feb 21 00:40:37 2008
Subject: [mod_python] sys.path problem
In-Reply-To: <88e286470802202125r4c7aa0dbwaba205d9c48a28a3@mail.gmail.com>
References: <7a360be50802201712t3c059c6erf534c0ad24efd34e@mail.gmail.com>
	<88e286470802201742o2af32aecw41ffc31b1d6258c1@mail.gmail.com>
	<7a360be50802201823w27a95099t9f72c9c33b1bc3b0@mail.gmail.com>
	<88e286470802201841r70c0392amb8ce10cbc51572ba@mail.gmail.com>
	<7a360be50802202113s75db126eibf90f6010955a10a@mail.gmail.com>
	<88e286470802202125r4c7aa0dbwaba205d9c48a28a3@mail.gmail.com>
Message-ID: <7a360be50802202140t9b7ba91vd1bc3d2c710a16f6@mail.gmail.com>

Hi Graham,

Actually I have a separate module called Path that handles the
sys.pathtomfoolery.  It basically reads in a text file where each line
is a path I
want to append to sys.path, and does the appending for me.  In that file I
do have the path to the module directory listed explicitly.  I've removed
that and it still seems to be broken to the same extent (not worse).  Yay.


Something else I just noticed...watching the logs as I replicate this
condition, I'm logging sys.path explicitly at the top of my handlerA module,
right after I import mod_python stuff and my Path module.  What's
interesting is that it doesn't always log there.  It's as if some of the
requests being handled re-use the same handler instance- which is great
because I'm sure this is giving me the performance boost that I want from
mod_python. (That should answer your question about "why mod_python".
Basically, CGI is too slow for what I need to handle).

So the first time a new handlerA instance is created after the first
handlerB instance is created, the sys.path that gets logged for handlerA
shows me what I know handlerB is setting it to.  The odd thing is, it
doesn't go both ways.  I can invoke one or the other first after an apache
restart, the sequence isn't important.  handlerA is the only one that seems
to suffer this fate.


I tried to modify my VirtualHost configurations to use the .testhandler
thing but it didn't work.  I'm not sure if you saw, but I'm using SetHandler
mod_python and then PythonHandler handlerA.  I tried changing it to
SetHandler mod_python.testhandler but then that broke everything.  I started
getting 404's.  Is that expected?  I wouldn't think so...


Thanks,
-aj

On Thu, Feb 21, 2008 at 12:25 AM, Graham Dumpleton <
graham.dumpleton@gmail.com> wrote:

> On 21/02/2008, AJ Coon <ajcoon@gmail.com> wrote:
> > Hi Graham,
> >
> > I wonder if this is a useful piece of information.  I just noticed this
> in
> > my logs:
> >
> > [Wed Feb 20 23:02:46 2008] [warn] mod_python (pid=29597,
> > interpreter='InterpB'): Module directory listed in "sys.path". This may
> > cause problems. Please check code. File being imported is
> > "/var/handlerB/www/handlerB_root/ProjectModule.py".
> >
> > I'm not sure I understand what it's complaining about?
>
> The new module importer underlaying import_module() and as also used
> by Python*Handler tries to keep mod_python module importer path
> separate from sys.path. This is because an overlap can cause problems
> with modules load duplicate times. You must be explicitly adding the
> document directory to sys.path in your script, which you shouldn't do.
>
> Can you show first part of script where you set sys.path.
>
> Graham
>
> >
> > -aj
> >
> >
> >
> >
> > On Wed, Feb 20, 2008 at 9:41 PM, Graham Dumpleton
> > <graham.dumpleton@gmail.com> wrote:
> >
> > >
> > > On 21/02/2008, AJ Coon <ajcoon@gmail.com> wrote:
> > >
> > > > Hi Graham,
> > > >
> > > > I'm not using PythonPath anywhere, though my handlers both make
> > > > sys.path.append() calls to add various library paths needed by each.
> > > > Inconveniently, each of these handlers use different versions of
> some of
> > the
> > > > same libraries.  It's a bit of a mess, but this all worked fine on
> > 3.1.3.
> > > > Now that I upgraded to 3.3.1 (and changed nothing else), it's
> broken.
> > > > Rolling back seems the obvious choice, but I think what I'm trying
> to do
> > > > *is* do-able, no?
> > >
> > > As per the documentation I pointed out, try setting:
> > >
> > >  PythonOption mod_python.legacy.importer name
> > >
> > > this will restore the old module importer functionality. If it still
> > > doesn't work, possibly something in Apache configuration causing
> > > issues instead.
> > >
> > > In principle I can't see a problem with what you are trying to do,
> > > although see comments below.
> > >
> > >
> > > > As you requested, I have included my configuration below.  I'm just
> > > > developing on a workstation and DNS is managed by /etc/hosts, hence
> the
> > > > .localdomain host names.  Without further adieu:
> > >
> > > Do those names map to distinct IP addresses or the same?
> > >
> > > In Apache documentation it doesn't recommend that you use FQDN in
> > > VirtualHost argument, but an IP address. Ie., in:
> > >
> > >
> > http://httpd.apache.org/docs/2.2/mod/core.html#virtualhost
> > >
> > > It says:
> > >
> > >  """A fully qualified domain name for the IP address of the virtual
> > > host (not recommended)"""
> > >
> > > The ServerName within the VirtualHost is what actually distinguishes
> > > them if using name based lookup against the same IP address.
> > >
> > > If using IPs or names rather than just *:80 then NameVirtualHost isn't
> > > required, but there have been cases where lack of NameVirtualHost in
> > > Apache configuration has caused mod_python to somehow merge sites when
> > > it shouldn't have been. Not know whether this is a bug in mod_python
> > > or not as when people got it working by adding NameVirtualHost, they
> > > were then interested in helping to debug the underlying problem.
> > >
> > >
> > > > aj@aj-5150:~$ cat /var/handlerA/www/.htaccess
> > > > PythonInterpreter InterpA
> > > > Options -Indexes
> > > >
> > > > aj@aj-5150:~$ cat /var/handlerB/www/.htaccess
> > > >  PythonInterpreter InterpB
> > > > Options -Indexes
> > >
> > > Have you confirmed that the .htaccess files are in fact being
> > > consulted. You can do this by introducing a syntax error in them. Ie.,
> > > add a line consisting of 'CRAP'. If when making request you then get a
> > > 500 error they are being consulted. The lack of an AllowOverride for
> > > the directories suggests they may not even be getting consulted and so
> > > the PythonInterpreter directives may not be getting applied. This may
> > > be combining with NameVirtualHost issues to end up with stuff running
> > > in same interpreter.
> > >
> > > You can work out which interpreter code is running in by printing out
> > > 'apache.interpreter' from mod_python module.
> > >
> > > Graham
> > >
> >
> >
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20080221/0353a64d/attachment.html
From graham.dumpleton at gmail.com  Thu Feb 21 00:49:39 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Feb 21 00:49:45 2008
Subject: [mod_python] sys.path problem
In-Reply-To: <7a360be50802202140t9b7ba91vd1bc3d2c710a16f6@mail.gmail.com>
References: <7a360be50802201712t3c059c6erf534c0ad24efd34e@mail.gmail.com>
	<88e286470802201742o2af32aecw41ffc31b1d6258c1@mail.gmail.com>
	<7a360be50802201823w27a95099t9f72c9c33b1bc3b0@mail.gmail.com>
	<88e286470802201841r70c0392amb8ce10cbc51572ba@mail.gmail.com>
	<7a360be50802202113s75db126eibf90f6010955a10a@mail.gmail.com>
	<88e286470802202125r4c7aa0dbwaba205d9c48a28a3@mail.gmail.com>
	<7a360be50802202140t9b7ba91vd1bc3d2c710a16f6@mail.gmail.com>
Message-ID: <88e286470802202149u1fe1ea96lc0e4d6731fbc0522@mail.gmail.com>

On 21/02/2008, AJ Coon <ajcoon@gmail.com> wrote:
> Hi Graham,
>
> Actually I have a separate module called Path that handles the sys.path
> tomfoolery.  It basically reads in a text file where each line is a path I
> want to append to sys.path, and does the appending for me.  In that file I
> do have the path to the module directory listed explicitly.  I've removed
> that and it still seems to be broken to the same extent (not worse).  Yay.
>
>
> Something else I just noticed...watching the logs as I replicate this
> condition, I'm logging sys.path explicitly at the top of my handlerA module,
> right after I import mod_python stuff and my Path module.  What's
> interesting is that it doesn't always log there.  It's as if some of the
> requests being handled re-use the same handler instance- which is great
> because I'm sure this is giving me the performance boost that I want from
> mod_python. (That should answer your question about "why mod_python".
> Basically, CGI is too slow for what I need to handle).

No it doesn't really answer my question. The mod_python module isn't
the only module for Apache/Python stuff anymore. If your code wasn't
heavily bound to mod_python specific features and could be modified to
be a WSGI application you could use mod_wsgi instead. I am more
confident in mod_wsgi not having problems with multiple VirtualHost
that mod_python some times seems to have.

> So the first time a new handlerA instance is created after the first
> handlerB instance is created, the sys.path that gets logged for handlerA
> shows me what I know handlerB is setting it to.  The odd thing is, it
> doesn't go both ways.  I can invoke one or the other first after an apache
> restart, the sequence isn't important.  handlerA is the only one that seems
> to suffer this fate.
>
> I tried to modify my VirtualHost configurations to use the .testhandler
> thing but it didn't work.  I'm not sure if you saw, but I'm using SetHandler
> mod_python and then PythonHandler handlerA.  I tried changing it to
> SetHandler mod_python.testhandler but then that broke everything.  I started
> getting 404's.  Is that expected?  I wouldn't think so...

I said to use:

  PythonHandler mod_python.testhandler

not use SetHandler. I want you to replace your handler with this test handler.

Have you dumped out mod_python.apache.interpreter yet and seen whether
it is correct for each application?

Graham

> On Thu, Feb 21, 2008 at 12:25 AM, Graham Dumpleton
> <graham.dumpleton@gmail.com> wrote:
> >
> > On 21/02/2008, AJ Coon <ajcoon@gmail.com> wrote:
> > > Hi Graham,
> > >
> >
> > > I wonder if this is a useful piece of information.  I just noticed this
> in
> > > my logs:
> > >
> > > [Wed Feb 20 23:02:46 2008] [warn] mod_python (pid=29597,
> > > interpreter='InterpB'): Module directory listed in "sys.path". This may
> > > cause problems. Please check code. File being imported is
> > > "/var/handlerB/www/handlerB_root/ProjectModule.py".
> > >
> > > I'm not sure I understand what it's complaining about?
> >
> > The new module importer underlaying import_module() and as also used
> > by Python*Handler tries to keep mod_python module importer path
> > separate from sys.path. This is because an overlap can cause problems
> > with modules load duplicate times. You must be explicitly adding the
> > document directory to sys.path in your script, which you shouldn't do.
> >
> > Can you show first part of script where you set sys.path.
> >
> > Graham
> >
> >
> >
> >
> > >
> > > -aj
> > >
> > >
> > >
> > >
> > > On Wed, Feb 20, 2008 at 9:41 PM, Graham Dumpleton
> > > <graham.dumpleton@gmail.com> wrote:
> > >
> > > >
> > > > On 21/02/2008, AJ Coon <ajcoon@gmail.com> wrote:
> > > >
> > > > > Hi Graham,
> > > > >
> > > > > I'm not using PythonPath anywhere, though my handlers both make
> > > > > sys.path.append() calls to add various library paths needed by each.
> > > > > Inconveniently, each of these handlers use different versions of
> some of
> > > the
> > > > > same libraries.  It's a bit of a mess, but this all worked fine on
> > > 3.1.3.
> > > > > Now that I upgraded to 3.3.1 (and changed nothing else), it's
> broken.
> > > > > Rolling back seems the obvious choice, but I think what I'm trying
> to do
> > > > > *is* do-able, no?
> > > >
> > > > As per the documentation I pointed out, try setting:
> > > >
> > > >  PythonOption mod_python.legacy.importer name
> > > >
> > > > this will restore the old module importer functionality. If it still
> > > > doesn't work, possibly something in Apache configuration causing
> > > > issues instead.
> > > >
> > > > In principle I can't see a problem with what you are trying to do,
> > > > although see comments below.
> > > >
> > > >
> > > > > As you requested, I have included my configuration below.  I'm just
> > > > > developing on a workstation and DNS is managed by /etc/hosts, hence
> the
> > > > > .localdomain host names.  Without further adieu:
> > > >
> > > > Do those names map to distinct IP addresses or the same?
> > > >
> > > > In Apache documentation it doesn't recommend that you use FQDN in
> > > > VirtualHost argument, but an IP address. Ie., in:
> > > >
> > > >
> > >
> http://httpd.apache.org/docs/2.2/mod/core.html#virtualhost
> > > >
> > > > It says:
> > > >
> > > >  """A fully qualified domain name for the IP address of the virtual
> > > > host (not recommended)"""
> > > >
> > > > The ServerName within the VirtualHost is what actually distinguishes
> > > > them if using name based lookup against the same IP address.
> > > >
> > > > If using IPs or names rather than just *:80 then NameVirtualHost isn't
> > > > required, but there have been cases where lack of NameVirtualHost in
> > > > Apache configuration has caused mod_python to somehow merge sites when
> > > > it shouldn't have been. Not know whether this is a bug in mod_python
> > > > or not as when people got it working by adding NameVirtualHost, they
> > > > were then interested in helping to debug the underlying problem.
> > > >
> > > >
> > > > > aj@aj-5150:~$ cat /var/handlerA/www/.htaccess
> > > > > PythonInterpreter InterpA
> > > > > Options -Indexes
> > > > >
> > > > > aj@aj-5150:~$ cat /var/handlerB/www/.htaccess
> > > > >  PythonInterpreter InterpB
> > > > > Options -Indexes
> > > >
> > > > Have you confirmed that the .htaccess files are in fact being
> > > > consulted. You can do this by introducing a syntax error in them. Ie.,
> > > > add a line consisting of 'CRAP'. If when making request you then get a
> > > > 500 error they are being consulted. The lack of an AllowOverride for
> > > > the directories suggests they may not even be getting consulted and so
> > > > the PythonInterpreter directives may not be getting applied. This may
> > > > be combining with NameVirtualHost issues to end up with stuff running
> > > > in same interpreter.
> > > >
> > > > You can work out which interpreter code is running in by printing out
> > > > 'apache.interpreter' from mod_python module.
> > > >
> > > > Graham
> > > >
> > >
> > >
> >
>
>
From martijn at xs4us.nu  Fri Feb 22 07:42:39 2008
From: martijn at xs4us.nu (Martijn Moeling)
Date: Fri Feb 22 07:42:54 2008
Subject: [mod_python] mod_python.Importer.path; set dynamically
References: <B6C73A5E30565245BB6D32B5F5DF7A52172BA2@sense.emmastraat.pijnacker><88e286470801311403u467069a8r75eab9f16184c0fd@mail.gmail.com><B6C73A5E30565245BB6D32B5F5DF7A52172BA3@sense.emmastraat.pijnacker><88e286470802050212s2355593ds96b743a8061cd159@mail.gmail.com><056ADD91-48A9-42CE-85C8-2F8901681032@xs4us.nu>
	<88e286470802121540m63992abfuee59ca2f0da7d8a3@mail.gmail.com>
Message-ID: <B6C73A5E30565245BB6D32B5F5DF7A52172C33@sense.emmastraat.pijnacker>

Graham,
 
Sorry for the delay I have been extremely busy on some other stuff.
 
>                 modules=filesInUserDirectory(req.session.user)
>            for module in modules:
>                         module.append( apache.import_module(module)
>                 return module.index(req,*args,**kwargs) # return apache.OK?
>    ......... (some code)
>         return apache.OK
>

As you can see the line "modules=filesInUserDirectory(req.session.user)" loads a tuple with modules in the userdirectory to import over the stable versions.
 
Then I have to iterate to see which ones I nee to import, please note that this is explanational code not actual code, I'm designing not implementing.
 
what does the line: "return module.index(req,*args,**kwargs) # return apache.OK?" do, and what if I return Apache.OK, I do not understand (or find explanation of the "return module.index(req,*args,**kwargs)" part.

It seems to me that in this way I cannot load more than one module and I should (re)load all modules in the userdir.....

 

Martijn


 

________________________________

Van: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
Verzonden: wo 13.02.2008 0:40
Aan: Martijn Moeling
CC: mod_python@modpython.org
Onderwerp: Re: [mod_python] mod_python.Importer.path; set dynamically



On 12/02/2008, Martijn Moeling <martijn@xs4us.nu> wrote:
> Graham,
>
> Thank you, I did not mess around with it yet, I am planning a
> versioning system to be added to my webbased development platform.
> I am still having some trouble with my webdav module, I have to taccle
> that one first.
>
> Your help is usefull one question though:
>
> say the inporterpath is set to:
>
> ".../python_modules/me:.../python_modules"
>
> in the apacheconfig the importerpath is set to .../python_modules
>
> in both directories stays:
>
> modulex.py ( in the me directory is the lates version)
>
>
> in my handler module:
>
> import modulex
>
> de handler(req):
>         ....... (some code)
>         if req.debug and req.session.loggedIn:
>                 req.options['mod_python.path'] = ".../me:../"
>                 importedModules=[]
>                 modules=filesInUserDirectory(req.session.user)
>            for module in modules:
>                         module.append( apache.import_module(module)
>                 return module.index(req,*args,**kwargs) # return apache.OK?
>    ......... (some code)
>         return apache.OK
>
> what happens to the interpreter for the next requests? which "modulex"
> is used ? The are supposed to get the "stable" one from .../
> python_modules/

Yes. Should always get the one from path specified in Apache
configuration. The dynamic change is only going to apply to those
imports done from handler or as a side effect of running the handler.

> I don't understand what the return line does, what happens if I return
> apache.OK in this case?

Huh.

At least I am a bit confused by your question as the code:

          for module in modules:
                       module.append( apache.import_module(module)
               return module.index(req,*args,**kwargs) # return apache.OK?
  ......... (some code)

doesn't make much sense to me. Don't understand why you are trying to
iterate over a list of modules to import.

Graham

> Martijn
>
> On Feb 5, 2008, at 11:12 AM, Graham Dumpleton wrote:
>
> > Sorry for the delay.
> >
> > To make things work transparently across a lot of modules, for both
> > import_module() and 'import' where possible, what you can do is modify
> > the value of option 'mod_python.importer.path' dynamically from code.
> > This can be done from memory using:
> >
> > req.options['mod_python.importer.path'] = "...."
> >
> > You obviously can query this first if you need to somehow manipulate
> > it to add stuff.
> >
> > All you then need is a level of indirection. Has to be from inside of
> > handler, can't be at global scope. So,
> > /var/www/python_modules/index.py might do:
> >
> > def index(req, *args, **kwargs):
> > req.options['mod_python.importer.path'] = \
> >  '/var/www/python_modules/%s:/var/www/python_modules' % req.user
> > module = apache.import_module('index-core')
> > return module.index(req, *args, **kwargs)
> >
> > If there is only one level of module imports, you could also do just:
> >
> > def index(req, *args, **kwargs):
> > module = apache.import_module('index-core', \
> >  path=['/var/www/python_modules/%s:/var/www/python_modules' %
> > req.user]))
> > return module.index(req, *args, **kwargs)
> >
> > but think that if subdirectory uses 'import', then it might not look
> > in all the directories. Can't remember how it works now.
> >
> > Anyway the suggestion is look at changing req.options if you haven't
> > already.
> >
> > Graham
> >
> > On 01/02/2008, Martijn Moeling <martijn@xs4us.nu> wrote:
> >>
> >>
> >>
> >> Graham,
> >>
> >> As you might remember I added a MySQLdb section to session.
> >> (to be able to save sessions across computers)
> >>
> >> In my system a lot of additional data is added to the req object,
> >> which is
> >> passed
> >> around. in my case it is req.Session.user.
> >>
> >> (I do not use http based auth, since this is in conflict with my
> >> web based
> >> desktop)
> >>
> >> nevertheless, i can change your "example code" to my needs, consider
> >> req.user as the distinguisher for ease of thinking.
> >>
> >> Martijn
> >>
> >>
> >>
> >>
> >> -----Original Message-----
> >> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
> >> Sent: Thu 31.01.2008 23:03
> >> To: Martijn Moeling
> >> Cc: mod_python@modpython.org
> >> Subject: Re: [mod_python] mod_python.Importer.path; set dynamically
> >>
> >> On 01/02/2008, Martijn Moeling <martijn@xs4us.nu> wrote:
> >>> Hi!
> >>>
> >>> I am an extensive mod_python user and my system needs something
> >>> special.
> >>>
> >>> Consider the following:
> >>>
> >>> in httpd.conf I have :
> >>>
> >>> PythonOption mod_python.importer.path ["/var/www/python_modules"]
> >>>
> >>> /var/www/html/index.py is linked to ../python_modules/index.py
> >>>
> >>> the python_modules directory has subdirectories, like; developer1,
> >>> developer2
> >>>
> >>> the python_modules contains stable modules and developerX holds
> >> development
> >>> versions.
> >>>
> >>> I have load balancing with multiple frond-ends (apache/MP) and one
> >> backend
> >>> (MySQL).
> >>>
> >>> I would like to dynamically change the mod_python.importer.path so
> >>> that
> >>> developer1 runs code in the corresponding subdir if the module
> >>> exists,
> >>> else fall back to the python_modules directory.
> >>>
> >>> Any tips, suggestions, remarks?
> >>
> >> What is the distinguisher used to know which developer it is? Are you
> >> using something like Basic authentication and so could distinguish
> >> based on req.user?
> >>
> >> If you tell me what the distinguisher is, probably have an idea.
> >>
> >> Graham
> >>
> >>
>
>


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20080222/e02452ae/attachment.html
From zimet at manray.com  Fri Feb 22 18:34:04 2008
From: zimet at manray.com (Martha Zimet)
Date: Fri Feb 22 18:34:17 2008
Subject: [mod_python] mod_python and os.system and os.popen
Message-ID: <52160.1203723244@manray.com>

I am attempting to call os.system and os.popen from within
a mod_python script and nothing happens. That is, the commands
perform no action. I am attempting to use os.system and os.popen
to execute wget, and I wonder if there any tricks that I am not
aware of. I have been googling and didn't find anything useful. 
Any assistance would be appreciated. 

Here is some code where 'update' is called from an HTML form. 
I have tried both os.system and os.popen with the same result.
I read about Popen, rather than os.popen, but that does not 
seem to exist in my implementation.

Thanks in advance.

Regards,

/martha

from mod_python import apache
import cgi
import pg
from cgi import escape
from urllib import unquote
import sys
import os

def update(req):

    # The getfirst() method returns the value of the first field
    # with the name passed as the method argument
    host = req.form.getfirst('host', '')
    user = req.form.getfirst('user', '')
    password = req.form.getfirst('password', '')    

    # Escape the user input to avoid script injection attacks
    host = cgi.escape(host)
    user = cgi.escape(user)
    password = cgi.escape(password)

    try:
        output = ''
        command = "wget --user %s --password %s
http://%s/svn/backend/able1.0/db/db.sql" % (user, password, host)
        req.write(command)
        req.write('\n')
        ouput = os.popen(command).read
        req.write(output)
        req.write('\n')        

    except Exception, e:
        r = sys.exc_info()
        generator = (str(x) for x in r)
        newstring = ''.join(generator)
        req.write(newstring)
        req.write('\n')







From argriffi at ncsu.edu  Fri Feb 22 18:39:14 2008
From: argriffi at ncsu.edu (argriffi)
Date: Fri Feb 22 18:39:21 2008
Subject: [mod_python] mod_python and os.system and os.popen
In-Reply-To: <52160.1203723244@manray.com>
References: <52160.1203723244@manray.com>
Message-ID: <47BF5D22.3030808@ncsu.edu>

ouput = os.popen(command).read







Martha Zimet wrote:
> I am attempting to call os.system and os.popen from within
> a mod_python script and nothing happens. That is, the commands
> perform no action. I am attempting to use os.system and os.popen
> to execute wget, and I wonder if there any tricks that I am not
> aware of. I have been googling and didn't find anything useful. 
> Any assistance would be appreciated. 
>
> Here is some code where 'update' is called from an HTML form. 
> I have tried both os.system and os.popen with the same result.
> I read about Popen, rather than os.popen, but that does not 
> seem to exist in my implementation.
>
> Thanks in advance.
>
> Regards,
>
> /martha
>
> from mod_python import apache
> import cgi
> import pg
> from cgi import escape
> from urllib import unquote
> import sys
> import os
>
> def update(req):
>
>     # The getfirst() method returns the value of the first field
>     # with the name passed as the method argument
>     host = req.form.getfirst('host', '')
>     user = req.form.getfirst('user', '')
>     password = req.form.getfirst('password', '')    
>
>     # Escape the user input to avoid script injection attacks
>     host = cgi.escape(host)
>     user = cgi.escape(user)
>     password = cgi.escape(password)
>
>     try:
>         output = ''
>         command = "wget --user %s --password %s
> http://%s/svn/backend/able1.0/db/db.sql" % (user, password, host)
>         req.write(command)
>         req.write('\n')
>         ouput = os.popen(command).read
>         req.write(output)
>         req.write('\n')        
>
>     except Exception, e:
>         r = sys.exc_info()
>         generator = (str(x) for x in r)
>         newstring = ''.join(generator)
>         req.write(newstring)
>         req.write('\n')
>
>
>
>
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>   

From zimet at manray.com  Fri Feb 22 18:41:16 2008
From: zimet at manray.com (Martha Zimet)
Date: Fri Feb 22 18:42:23 2008
Subject: [mod_python] mod_python and os.system and os.popen
Message-ID: <34984.1203723677@manray.com>

My bad.. I also tried that in my various versions
of the code. Same result. 

On Fri Feb 22 18:39 , argriffi  sent:

>ouput = os.popen(command).read
>
>
>
>
>
>
>
>Martha Zimet wrote:
>> I am attempting to call os.system and os.popen from within
>> a mod_python script and nothing happens. That is, the commands
>> perform no action. I am attempting to use os.system and os.popen
>> to execute wget, and I wonder if there any tricks that I am not
>> aware of. I have been googling and didn't find anything useful. 
>> Any assistance would be appreciated. 
>>
>> Here is some code where 'update' is called from an HTML form. 
>> I have tried both os.system and os.popen with the same result.
>> I read about Popen, rather than os.popen, but that does not 
>> seem to exist in my implementation.
>>
>> Thanks in advance.
>>
>> Regards,
>>
>> /martha
>>
>> from mod_python import apache
>> import cgi
>> import pg
>> from cgi import escape
>> from urllib import unquote
>> import sys
>> import os
>>
>> def update(req):
>>
>>     # The getfirst() method returns the value of the first field
>>     # with the name passed as the method argument
>>     host = req.form.getfirst('host', '')
>>     user = req.form.getfirst('user', '')
>>     password = req.form.getfirst('password', '')    
>>
>>     # Escape the user input to avoid script injection attacks
>>     host = cgi.escape(host)
>>     user = cgi.escape(user)
>>     password = cgi.escape(password)
>>
>>     try:
>>         output = ''
>>         command = "wget --user %s --password %s
>> http://%s/svn/backend/able1.0/db/db.sql" % (user, password, host)
>>         req.write(command)
>>         req.write('\n')
>>         ouput = os.popen(command).read
>>         req.write(output)
>>         req.write('\n')        
>>
>>     except Exception, e:
>>         r = sys.exc_info()
>>         generator = (str(x) for x in r)
>>         newstring = ''.join(generator)
>>         req.write(newstring)
>>         req.write('\n')
>>
>>
>>
>>
>>
>>
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>   
>



From argriffi at ncsu.edu  Fri Feb 22 18:48:00 2008
From: argriffi at ncsu.edu (argriffi)
Date: Fri Feb 22 18:48:07 2008
Subject: [mod_python] mod_python and os.system and os.popen
In-Reply-To: <34984.1203723677@manray.com>
References: <34984.1203723677@manray.com>
Message-ID: <47BF5F30.4030900@ncsu.edu>

What I meant was that there are at least a couple of problems with this 
line.
First, you probably want "output" instead of "ouput".
Second, you probably want "read()" instead of "read".
If you've already tried those versions then I'm just being dense :)


Martha Zimet wrote:
> My bad.. I also tried that in my various versions
> of the code. Same result. 
>
> On Fri Feb 22 18:39 , argriffi  sent:
>
>   
>> ouput = os.popen(command).read
>>
>>
>>
>>
>>
>>
>>
>> Martha Zimet wrote:
>>     
>>> I am attempting to call os.system and os.popen from within
>>> a mod_python script and nothing happens. That is, the commands
>>> perform no action. I am attempting to use os.system and os.popen
>>> to execute wget, and I wonder if there any tricks that I am not
>>> aware of. I have been googling and didn't find anything useful. 
>>> Any assistance would be appreciated. 
>>>
>>> Here is some code where 'update' is called from an HTML form. 
>>> I have tried both os.system and os.popen with the same result.
>>> I read about Popen, rather than os.popen, but that does not 
>>> seem to exist in my implementation.
>>>
>>> Thanks in advance.
>>>
>>> Regards,
>>>
>>> /martha
>>>
>>> from mod_python import apache
>>> import cgi
>>> import pg
>>> from cgi import escape
>>> from urllib import unquote
>>> import sys
>>> import os
>>>
>>> def update(req):
>>>
>>>     # The getfirst() method returns the value of the first field
>>>     # with the name passed as the method argument
>>>     host = req.form.getfirst('host', '')
>>>     user = req.form.getfirst('user', '')
>>>     password = req.form.getfirst('password', '')    
>>>
>>>     # Escape the user input to avoid script injection attacks
>>>     host = cgi.escape(host)
>>>     user = cgi.escape(user)
>>>     password = cgi.escape(password)
>>>
>>>     try:
>>>         output = ''
>>>         command = "wget --user %s --password %s
>>> http://%s/svn/backend/able1.0/db/db.sql" % (user, password, host)
>>>         req.write(command)
>>>         req.write('\n')
>>>         ouput = os.popen(command).read
>>>         req.write(output)
>>>         req.write('\n')        
>>>
>>>     except Exception, e:
>>>         r = sys.exc_info()
>>>         generator = (str(x) for x in r)
>>>         newstring = ''.join(generator)
>>>         req.write(newstring)
>>>         req.write('\n')
>>>
>>>
>>>
>>>
>>>
>>>
>>>
>>> _______________________________________________
>>> Mod_python mailing list
>>> Mod_python@modpython.org
>>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>>   
>>>       
>
>
>   

From zimet at manray.com  Fri Feb 22 20:06:47 2008
From: zimet at manray.com (Martha Zimet)
Date: Fri Feb 22 20:07:28 2008
Subject: [mod_python] mod_python and os.system and os.popen
Message-ID: <33230.1203728807@manray.com>

I got it work by adding the following: 

import subprocess
...
...

p = subprocess.Popen(command, stdout=subprocess.PIPE)
for line in p.stdout:
  req.write(line)
req.write(p.wait())

...

I still don't know why the other way didn't work, but I am fine now.

On Fri Feb 22 18:48 , argriffi  sent:

>What I meant was that there are at least a couple of problems with this 
>line.
>First, you probably want "output" instead of "ouput".
>Second, you probably want "read()" instead of "read".
>If you've already tried those versions then I'm just being dense :)
>
>
>Martha Zimet wrote:
>> My bad.. I also tried that in my various versions
>> of the code. Same result. 
>>
>> On Fri Feb 22 18:39 , argriffi  sent:
>>
>>   
>>> ouput = os.popen(command).read
>>>
>>>
>>>
>>>
>>>
>>>
>>>
>>> Martha Zimet wrote:
>>>     
>>>> I am attempting to call os.system and os.popen from within
>>>> a mod_python script and nothing happens. That is, the commands
>>>> perform no action. I am attempting to use os.system and os.popen
>>>> to execute wget, and I wonder if there any tricks that I am not
>>>> aware of. I have been googling and didn't find anything useful. 
>>>> Any assistance would be appreciated. 
>>>>
>>>> Here is some code where 'update' is called from an HTML form. 
>>>> I have tried both os.system and os.popen with the same result.
>>>> I read about Popen, rather than os.popen, but that does not 
>>>> seem to exist in my implementation.
>>>>
>>>> Thanks in advance.
>>>>
>>>> Regards,
>>>>
>>>> /martha
>>>>
>>>> from mod_python import apache
>>>> import cgi
>>>> import pg
>>>> from cgi import escape
>>>> from urllib import unquote
>>>> import sys
>>>> import os
>>>>
>>>> def update(req):
>>>>
>>>>     # The getfirst() method returns the value of the first field
>>>>     # with the name passed as the method argument
>>>>     host = req.form.getfirst('host', '')
>>>>     user = req.form.getfirst('user', '')
>>>>     password = req.form.getfirst('password', '')    
>>>>
>>>>     # Escape the user input to avoid script injection attacks
>>>>     host = cgi.escape(host)
>>>>     user = cgi.escape(user)
>>>>     password = cgi.escape(password)
>>>>
>>>>     try:
>>>>         output = ''
>>>>         command = "wget --user %s --password %s
>>>> http://%s/svn/backend/able1.0/db/db.sql" % (user, password, host)
>>>>         req.write(command)
>>>>         req.write('\n')
>>>>         ouput = os.popen(command).read
>>>>         req.write(output)
>>>>         req.write('\n')        
>>>>
>>>>     except Exception, e:
>>>>         r = sys.exc_info()
>>>>         generator = (str(x) for x in r)
>>>>         newstring = ''.join(generator)
>>>>         req.write(newstring)
>>>>         req.write('\n')
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>
>>>> _______________________________________________
>>>> Mod_python mailing list
>>>> Mod_python@modpython.org
>>>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>>>   
>>>>       
>>
>>
>>   
>



From necmettin.begiter at gmail.com  Mon Feb 25 04:55:31 2008
From: necmettin.begiter at gmail.com (Necmettin Begiter)
Date: Mon Feb 25 04:55:45 2008
Subject: [mod_python] Re: print help content in a Command Prompt
In-Reply-To: <4f2909d7-df2a-442c-bc43-5ecc04e1ad14@q78g2000hsh.googlegroups.com>
References: <4f2909d7-df2a-442c-bc43-5ecc04e1ad14@q78g2000hsh.googlegroups.com>
Message-ID: <200802251155.31905.necmettin.begiter@gmail.com>

25 February 2008 Monday 11:15:14 tarihinde bkamrani@gmail.com ?unlar? yazm??t?:
> Hi,
> This is a basic problem, but I want to print help content in a Command
> Prompt in WinXP and scrolling back to see the first lines. If I start
> a command prompt and run python, and then for example,
> 
> >>> help(list)
> 
> it starts showing the help, which can be controlled by page or raw
> using Spacebar or Enter but after this ends, it seems that I can't
> scroll back to see again the first lines.

Try PgUp

> In the  Command Prompt Properties, layout tab, my Screen buffer size
> is Width:80, Height:3000 and windows size 80x40 (W&H).
> 
> Any idea...? thanks in advance!!
> /Ben

Also try python -c 'help(list)'

From graham.dumpleton at gmail.com  Mon Feb 25 05:07:07 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Feb 25 05:07:15 2008
Subject: [mod_python] Re: print help content in a Command Prompt
In-Reply-To: <200802251155.31905.necmettin.begiter@gmail.com>
References: <4f2909d7-df2a-442c-bc43-5ecc04e1ad14@q78g2000hsh.googlegroups.com>
	<200802251155.31905.necmettin.begiter@gmail.com>
Message-ID: <88e286470802250207v6c951b56i6218bf3a6736d5c2@mail.gmail.com>

On 25/02/2008, Necmettin Begiter <necmettin.begiter@gmail.com> wrote:
> 25 February 2008 Monday 11:15:14 tarihinde bkamrani@gmail.com ?unlar? yazm??t?:
>  > Hi,
>  > This is a basic problem, but I want to print help content in a Command
>  > Prompt in WinXP and scrolling back to see the first lines. If I start
>  > a command prompt and run python, and then for example,
>  >
>  > >>> help(list)
>  >
>  > it starts showing the help, which can be controlled by page or raw
>  > using Spacebar or Enter but after this ends, it seems that I can't
>  > scroll back to see again the first lines.
>
>  Try PgUp
>
>  > In the  Command Prompt Properties, layout tab, my Screen buffer size
>  > is Width:80, Height:3000 and windows size 80x40 (W&H).
>  >
>  > Any idea...? thanks in advance!!
>  > /Ben
>
>  Also try python -c 'help(list)'

Wrong mailing list. Use:

  http://groups.google.com/group/comp.lang.python/topics?lnk=lr

This list you are posting to here is specifically about mod_python,
and is not a general Python group.

From syahreza.octadian at gmail.com  Tue Feb 26 22:21:50 2008
From: syahreza.octadian at gmail.com (Syahreza Octadian)
Date: Tue Feb 26 23:24:20 2008
Subject: [mod_python] Chart with mod_python
Message-ID: <4818f68b0802261921u6f10cf2dh8b993252517c04df@mail.gmail.com>

Dear all,

i am beginner with mod_python, now i'm trying to create web application that
will show chart of data from mysql database. I'm confuse what kind of class
that i can use to make a chart, is somebody have try this please help me....


Thank for your advices.


Best Regards
Syahreza Octadian
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20080227/e9604d60/attachment.html
From roberto at connexer.com  Tue Feb 26 23:34:13 2008
From: roberto at connexer.com (Roberto =?iso-8859-1?Q?C=2E_S=E1nchez?=)
Date: Tue Feb 26 23:34:20 2008
Subject: [mod_python] Chart with mod_python
In-Reply-To: <4818f68b0802261921u6f10cf2dh8b993252517c04df@mail.gmail.com>
References: <4818f68b0802261921u6f10cf2dh8b993252517c04df@mail.gmail.com>
Message-ID: <20080227043413.GC19231@connexer.com>

On Wed, Feb 27, 2008 at 10:21:50AM +0700, Syahreza Octadian wrote:
> Dear all,
> 
> i am beginner with mod_python, now i'm trying to create web application that
> will show chart of data from mysql database. I'm confuse what kind of class
> that i can use to make a chart, is somebody have try this please help me....
> 
First it depends what sort of data you are charting.  However, some
possible alternatives include:

  - The Python GD library
  - The Python Imaging library
  - Calling GNUplot via os.system() with your data

If you would like a more detailed reply, then please provide more
information.

Regards,

-Roberto

P.S.  If you are a beginner, please swith to PostgreSQL.

-- 
Roberto C. S?nchez
http://people.connexer.com/~roberto
http://www.connexer.com
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20080226/595ba810/attachment.bin
From brunson at brunson.com  Tue Feb 26 23:48:20 2008
From: brunson at brunson.com (Eric Brunson)
Date: Tue Feb 26 23:48:29 2008
Subject: [mod_python] Chart with mod_python
In-Reply-To: <20080227043413.GC19231@connexer.com>
References: <4818f68b0802261921u6f10cf2dh8b993252517c04df@mail.gmail.com>
	<20080227043413.GC19231@connexer.com>
Message-ID: <47C4EB94.9010903@brunson.com>

Roberto C. S?nchez wrote:
> On Wed, Feb 27, 2008 at 10:21:50AM +0700, Syahreza Octadian wrote:
>   
>> Dear all,
>>
>> i am beginner with mod_python, now i'm trying to create web application that
>> will show chart of data from mysql database. I'm confuse what kind of class
>> that i can use to make a chart, is somebody have try this please help me....
>>
>>     
> First it depends what sort of data you are charting.  However, some
> possible alternatives include:
>
>   - The Python GD library
>   - The Python Imaging library
>   - Calling GNUplot via os.system() with your data
>
> If you would like a more detailed reply, then please provide more
> information.
>   

We've just started switching all our graphing over to using mod_python 
and OpenFlashChart.  We find it an extremely flexible and interactive 
solution.

http://teethgrinder.co.uk/open-flash-chart

> Regards,
>
> -Roberto
>
> P.S.  If you are a beginner, please swith to PostgreSQL.
>   

Whatever.



From auther_bin at 21cn.com  Wed Feb 27 00:16:03 2008
From: auther_bin at 21cn.com (auther_bin)
Date: Wed Feb 27 00:18:31 2008
Subject: [mod_python] Help about apache mod_python Segmentation fault
Message-ID: <200802271315514506355@21cn.com>

Dear friends,

	When I compiling the apache python mod_python and install it into my uClibc envirentment, but when I 
runing httpd -X, send a very little request with index.html it crashed. after some debuging work, I find there should be something wrong in mod_python.c line(about 1561) which looks like:
--------------------------------- with my debug printing :) ------------------------
printf("JJJJJJJJ %s -> python_handler\n", phase);
printf("JJJJJJJJ %x[%d]\n", &req->per_dir_config, (&python_module)->module_index);
    /* get configuration */
    conf = (py_config *) ap_get_module_config(req->per_dir_config,
                                                  &python_module);
printf("JJJJJJJJ a %s conf=%x -> python_handler\n", phase,conf);
.............
------------------------------ end source --------------------------------------

I guess that, there should be a regester error in it. with some debug message I print:
------------- printing -------------------------------
JJJJJJJJJ PythonPostReadRequestHandler
JJJJJJJJ PythonInitHandler -> python_handler
JJJJJJJJ 820a544[29]
Segmentation fault
------------- end printing ---------------------------

any advices pls?

apache: 2.2.6 mod_python:3.3.1 python:2.5.1
 				
auther_bin
auther_bin@21cn.com
2008-02-25

From graham.dumpleton at gmail.com  Wed Feb 27 00:29:48 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Feb 27 00:29:53 2008
Subject: [mod_python] Help about apache mod_python Segmentation fault
In-Reply-To: <200802271315514506355@21cn.com>
References: <200802271315514506355@21cn.com>
Message-ID: <88e286470802262129s77d47709p5518fa57ae0abc0d@mail.gmail.com>

On 27/02/2008, auther_bin <auther_bin@21cn.com> wrote:
> Dear friends,
>
>         When I compiling the apache python mod_python and install it into my uClibc envirentment, but when I
>  runing httpd -X, send a very little request with index.html it crashed. after some debuging work, I find there should be something wrong in mod_python.c line(about 1561) which looks like:
>  --------------------------------- with my debug printing :) ------------------------
>  printf("JJJJJJJJ %s -> python_handler\n", phase);
>  printf("JJJJJJJJ %x[%d]\n", &req->per_dir_config, (&python_module)->module_index);
>     /* get configuration */
>     conf = (py_config *) ap_get_module_config(req->per_dir_config,
>                                                   &python_module);
>  printf("JJJJJJJJ a %s conf=%x -> python_handler\n", phase,conf);
>  .............
>  ------------------------------ end source --------------------------------------
>
>  I guess that, there should be a regester error in it. with some debug message I print:
>  ------------- printing -------------------------------
>  JJJJJJJJJ PythonPostReadRequestHandler
>  JJJJJJJJ PythonInitHandler -> python_handler
>  JJJJJJJJ 820a544[29]
>  Segmentation fault
>  ------------- end printing ---------------------------
>
>  any advices pls?

Unfortunately that doesn't help much.

You need a stack trace to show the true location in code.

Use procedure documented in section 'Debugging Crashes With GDB' of:

  http://code.google.com/p/modwsgi/wiki/DebuggingTechniques

to run up httpd inside of gdb and get a stack trace of where crash is occurring.

This documentation is for mod_wgsi, but same procedure used for mod_python.

There is a similar procedure documented on Apache site, but can't
remember where.

Graham
From happybrowndog at hotmail.com  Wed Feb 27 14:25:10 2008
From: happybrowndog at hotmail.com (happybrowndog)
Date: Wed Feb 27 14:25:39 2008
Subject: [mod_python] How do I serve dynamic images?
Message-ID: <fq4deu$g7o$1@ger.gmane.org>

I've searched the web but have only seen code to serve dynamically 
generated images in the following way:
	buff = StringIO.StringIO()
	img.save(buff,...)
	req.write(buff.getvalue())
and setting the appropriate html headers.  This is fine if I want to 
serve the image in its own page.

But how do I serve dynamically generated images inside an <img> tag?

* note: I don't want to create the image on disk first, I wish to only 
serve it directly from python in memory.

From ccbean at gmail.com  Wed Feb 27 14:44:14 2008
From: ccbean at gmail.com (Colin Bean)
Date: Wed Feb 27 14:44:20 2008
Subject: [mod_python] How do I serve dynamic images?
In-Reply-To: <fq4deu$g7o$1@ger.gmane.org>
References: <fq4deu$g7o$1@ger.gmane.org>
Message-ID: <29a6ca010802271144y7a5b0e52r4243c72252e60f48@mail.gmail.com>

It works the same way; just point the src attribute of your img tag to
the URL for your custom image handler.  You should be able to include
query parameters or whatever else you need in the URL.  Think of the
an img tag as telling the browser "request the source URL, and then
display the request content in the page (if it's a valid image)".

Colin

On Wed, Feb 27, 2008 at 11:25 AM, happybrowndog
<happybrowndog@hotmail.com> wrote:
> I've searched the web but have only seen code to serve dynamically
>  generated images in the following way:
>         buff = StringIO.StringIO()
>         img.save(buff,...)
>         req.write(buff.getvalue())
>  and setting the appropriate html headers.  This is fine if I want to
>  serve the image in its own page.
>
>  But how do I serve dynamically generated images inside an <img> tag?
>
>  * note: I don't want to create the image on disk first, I wish to only
>  serve it directly from python in memory.
>
>  _______________________________________________
>  Mod_python mailing list
>  Mod_python@modpython.org
>  http://mailman.modpython.org/mailman/listinfo/mod_python
>
From sdavis2 at mail.nih.gov  Wed Feb 27 14:53:46 2008
From: sdavis2 at mail.nih.gov (Sean Davis)
Date: Wed Feb 27 14:53:54 2008
Subject: [mod_python] How do I serve dynamic images?
In-Reply-To: <fq4deu$g7o$1@ger.gmane.org>
References: <fq4deu$g7o$1@ger.gmane.org>
Message-ID: <264855a00802271153g38f5d1bfudfa113b77655a444@mail.gmail.com>

On Wed, Feb 27, 2008 at 2:25 PM, happybrowndog
<happybrowndog@hotmail.com> wrote:
> I've searched the web but have only seen code to serve dynamically
>  generated images in the following way:
>         buff = StringIO.StringIO()
>         img.save(buff,...)
>         req.write(buff.getvalue())
>  and setting the appropriate html headers.  This is fine if I want to
>  serve the image in its own page.
>
>  But how do I serve dynamically generated images inside an <img> tag?

You simply have the URL of the image generation code in the <img> tag.

<img src='http://myserver.com/mygraphmaker.py' />

Of course, you might need to include a query parameter in there if the
image code needs some parameters....  You could also make javascript
calls to do the same thing.

There is not a way to print the buffer directly to the page.

Sean
From bruno at tikami.com.br  Wed Feb 27 23:41:16 2008
From: bruno at tikami.com.br (Bruno Tikami)
Date: Wed Feb 27 23:41:24 2008
Subject: [mod_python] Import Error on Windows 2000
Message-ID: <6fd74a2a0802272041k4bc8f9d4x9b306bbf17949f84@mail.gmail.com>

Hello fellows,

I've just subscribed to the list and I'm writing to ask for help on a error
that (as far as I could serach on Google) lot of people have already faced:
Import error.



   - Mod_python version. - 3.3.1
   - Your operating system type, Windows 2000
   - Your Python version, 2.5
   - Your Apache version. 2.2
   - Relevant parts of the Apache config, .htaccess + Relevant parts of
   the Python code. : I'm just trying the mpinfo trobleshooting
   - Error:


ImportError: No module named mod_python.apache
[Thu Feb 28 01:08:37 2008] [error] make_obcallback: Python path being used
"['C:\\\\Python25\\\\', 'C:\\\\Python25\\\\Scripts', 'C:\\\\tkmsoft\\\\',
'C:\\\\tkmsoft\\\\srm', '', 'C:\\\\WINNT\\\\system32\\\\python25.zip',
'C:\\\\Python25\\\\Lib', 'C:\\\\Python25\\\\DLLs',
'C:\\\\Python25\\\\Lib\\\\lib-tk', '', 'C:\\\\Program Files\\\\Apache
Software Foundation\\\\Apache2.2\\\\bin']".
[Thu Feb 28 01:08:37 2008] [error] get_interpreter: no interpreter callback
found.
[Thu Feb 28 01:08:37 2008] [error] [client 127.0.0.1] python_handler: Can't
get/create interpreter.

Does anyone know how to solve it ?

Regards,

Tkm

<http://djangopeople.net/brunotikami/>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20080228/eb1b5eda/attachment.html
From graham.dumpleton at gmail.com  Thu Feb 28 19:51:05 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Feb 28 19:51:12 2008
Subject: [mod_python] Import Error on Windows 2000
In-Reply-To: <6fd74a2a0802272041k4bc8f9d4x9b306bbf17949f84@mail.gmail.com>
References: <6fd74a2a0802272041k4bc8f9d4x9b306bbf17949f84@mail.gmail.com>
Message-ID: <88e286470802281651k147f7656hd4cf4ed963190e91@mail.gmail.com>

Read section 'Python Requirements' of:

  http://code.google.com/p/modwsgi/wiki/InstallationOnWindows

Same things apply to mod_python.

In short, install Python/Apache as Administrator. If you haven't done
this, uninstall them as user you installed them as, and reinstall them
as Administrator. Also heed notes about multiple Python installations.

Graham

2008/2/28 Bruno Tikami <bruno@tikami.com.br>:
> Hello fellows,
>
> I've just subscribed to the list and I'm writing to ask for help on a error
> that (as far as I could serach on Google) lot of people have already faced:
> Import error.
>
>
>
> Mod_python version. - 3.3.1
>
> Your operating system type, Windows 2000
>
> Your Python version, 2.5
> Your Apache version. 2.2
>
> Relevant parts of the Apache config, .htaccess + Relevant parts of the
> Python code. : I'm just trying the mpinfo trobleshooting
> Error:
>
> ImportError: No module named mod_python.apache
>  [Thu Feb 28 01:08:37 2008] [error] make_obcallback: Python path being used
> "['C:\\\\Python25\\\\', 'C:\\\\Python25\\\\Scripts', 'C:\\\\tkmsoft\\\\',
> 'C:\\\\tkmsoft\\\\srm', '', 'C:\\\\WINNT\\\\system32\\\\python25.zip',
> 'C:\\\\Python25\\\\Lib', 'C:\\\\Python25\\\\DLLs',
> 'C:\\\\Python25\\\\Lib\\\\lib-tk', '', 'C:\\\\Program Files\\\\Apache
> Software Foundation\\\\Apache2.2\\\\bin']".
>  [Thu Feb 28 01:08:37 2008] [error] get_interpreter: no interpreter callback
> found.
> [Thu Feb 28 01:08:37 2008] [error] [client 127.0.0.1] python_handler: Can't
> get/create interpreter.
>
> Does anyone know how to solve it ?
>
> Regards,
>
> Tkm
>
>
> _______________________________________________
>  Mod_python mailing list
>  Mod_python@modpython.org
>  http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
From bruno at tikami.com.br  Thu Feb 28 20:14:55 2008
From: bruno at tikami.com.br (Bruno Tikami)
Date: Thu Feb 28 20:14:58 2008
Subject: [mod_python] Import Error on Windows 2000
In-Reply-To: <88e286470802281651k147f7656hd4cf4ed963190e91@mail.gmail.com>
References: <6fd74a2a0802272041k4bc8f9d4x9b306bbf17949f84@mail.gmail.com>
	<88e286470802281651k147f7656hd4cf4ed963190e91@mail.gmail.com>
Message-ID: <6fd74a2a0802281714w4da11a87s86473a955ec67710@mail.gmail.com>

Graham,


thanks for your reply man but I have Administrator privileges on the server
and only Python2.5 installed. I've already uninstalled either Apache and
mod_python and then reisntalled them. I've also rebooted the server beetween
this procedures. Do you think I can try something else ?

Regards,

Tkm

On 2/28/08, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
>
> Read section 'Python Requirements' of:
>
>   http://code.google.com/p/modwsgi/wiki/InstallationOnWindows
>
> Same things apply to mod_python.
>
> In short, install Python/Apache as Administrator. If you haven't done
> this, uninstall them as user you installed them as, and reinstall them
> as Administrator. Also heed notes about multiple Python installations.
>
> Graham
>
> 2008/2/28 Bruno Tikami <bruno@tikami.com.br>:
>
> > Hello fellows,
> >
> > I've just subscribed to the list and I'm writing to ask for help on a
> error
> > that (as far as I could serach on Google) lot of people have already
> faced:
> > Import error.
> >
> >
> >
> > Mod_python version. - 3.3.1
> >
> > Your operating system type, Windows 2000
> >
> > Your Python version, 2.5
> > Your Apache version. 2.2
> >
> > Relevant parts of the Apache config, .htaccess + Relevant parts of the
> > Python code. : I'm just trying the mpinfo trobleshooting
> > Error:
> >
> > ImportError: No module named mod_python.apache
> >  [Thu Feb 28 01:08:37 2008] [error] make_obcallback: Python path being
> used
> > "['C:\\\\Python25\\\\', 'C:\\\\Python25\\\\Scripts',
> 'C:\\\\tkmsoft\\\\',
> > 'C:\\\\tkmsoft\\\\srm', '', 'C:\\\\WINNT\\\\system32\\\\python25.zip',
> > 'C:\\\\Python25\\\\Lib', 'C:\\\\Python25\\\\DLLs',
> > 'C:\\\\Python25\\\\Lib\\\\lib-tk', '', 'C:\\\\Program Files\\\\Apache
> > Software Foundation\\\\Apache2.2\\\\bin']".
> >  [Thu Feb 28 01:08:37 2008] [error] get_interpreter: no interpreter
> callback
> > found.
> > [Thu Feb 28 01:08:37 2008] [error] [client 127.0.0.1] python_handler:
> Can't
> > get/create interpreter.
> >
> > Does anyone know how to solve it ?
> >
> > Regards,
> >
> > Tkm
> >
> >
>
> > _______________________________________________
> >  Mod_python mailing list
> >  Mod_python@modpython.org
> >  http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> >
>



-- 
[]s!

Tkm
http://djangopeople.net/brunotikami/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20080228/e8204a90/attachment.html
From bruno at tikami.com.br  Thu Feb 28 20:23:07 2008
From: bruno at tikami.com.br (Bruno Tikami)
Date: Thu Feb 28 20:23:10 2008
Subject: [mod_python] Import Error on Windows 2000
In-Reply-To: <6fd74a2a0802281714w4da11a87s86473a955ec67710@mail.gmail.com>
References: <6fd74a2a0802272041k4bc8f9d4x9b306bbf17949f84@mail.gmail.com>
	<88e286470802281651k147f7656hd4cf4ed963190e91@mail.gmail.com>
	<6fd74a2a0802281714w4da11a87s86473a955ec67710@mail.gmail.com>
Message-ID: <6fd74a2a0802281723t5856022cg2b97f0b1782a1b6b@mail.gmail.com>

One more thing: msvcr71.dll exists on Windows system directory

On 2/28/08, Bruno Tikami <bruno@tikami.com.br> wrote:
>
> Graham,
>
>
> thanks for your reply man but I have Administrator privileges on the
> server and only Python2.5 installed. I've already uninstalled either
> Apache and mod_python and then reisntalled them. I've also rebooted the
> server beetween this procedures. Do you think I can try something else ?
>
> Regards,
>
> Tkm
>
> On 2/28/08, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> >
> > Read section 'Python Requirements' of:
> >
> >   http://code.google.com/p/modwsgi/wiki/InstallationOnWindows
> >
> > Same things apply to mod_python.
> >
> > In short, install Python/Apache as Administrator. If you haven't done
> > this, uninstall them as user you installed them as, and reinstall them
> > as Administrator. Also heed notes about multiple Python installations.
> >
> > Graham
> >
> > 2008/2/28 Bruno Tikami <bruno@tikami.com.br>:
> >
> > > Hello fellows,
> > >
> > > I've just subscribed to the list and I'm writing to ask for help on a
> > error
> > > that (as far as I could serach on Google) lot of people have already
> > faced:
> > > Import error.
> > >
> > >
> > >
> > > Mod_python version. - 3.3.1
> > >
> > > Your operating system type, Windows 2000
> > >
> > > Your Python version, 2.5
> > > Your Apache version. 2.2
> > >
> > > Relevant parts of the Apache config, .htaccess + Relevant parts of the
> > > Python code. : I'm just trying the mpinfo trobleshooting
> > > Error:
> > >
> > > ImportError: No module named mod_python.apache
> > >  [Thu Feb 28 01:08:37 2008] [error] make_obcallback: Python path being
> > used
> > > "['C:\\\\Python25\\\\', 'C:\\\\Python25\\\\Scripts',
> > 'C:\\\\tkmsoft\\\\',
> > > 'C:\\\\tkmsoft\\\\srm', '', 'C:\\\\WINNT\\\\system32\\\\python25.zip',
> > > 'C:\\\\Python25\\\\Lib', 'C:\\\\Python25\\\\DLLs',
> > > 'C:\\\\Python25\\\\Lib\\\\lib-tk', '', 'C:\\\\Program Files\\\\Apache
> > > Software Foundation\\\\Apache2.2\\\\bin']".
> > >  [Thu Feb 28 01:08:37 2008] [error] get_interpreter: no interpreter
> > callback
> > > found.
> > > [Thu Feb 28 01:08:37 2008] [error] [client 127.0.0.1] python_handler:
> > Can't
> > > get/create interpreter.
> > >
> > > Does anyone know how to solve it ?
> > >
> > > Regards,
> > >
> > > Tkm
> > >
> > >
> >
> > > _______________________________________________
> > >  Mod_python mailing list
> > >  Mod_python@modpython.org
> > >  http://mailman.modpython.org/mailman/listinfo/mod_python
> > >
> > >
> >
>
>
>
> --
> []s!
>
> Tkm
> http://djangopeople.net/brunotikami/




-- 
[]s!

Tkm
http://djangopeople.net/brunotikami/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20080228/5a2cb302/attachment.html
From graham.dumpleton at gmail.com  Thu Feb 28 20:48:21 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Feb 28 20:48:25 2008
Subject: [mod_python] Import Error on Windows 2000
In-Reply-To: <6fd74a2a0802281723t5856022cg2b97f0b1782a1b6b@mail.gmail.com>
References: <6fd74a2a0802272041k4bc8f9d4x9b306bbf17949f84@mail.gmail.com>
	<88e286470802281651k147f7656hd4cf4ed963190e91@mail.gmail.com>
	<6fd74a2a0802281714w4da11a87s86473a955ec67710@mail.gmail.com>
	<6fd74a2a0802281723t5856022cg2b97f0b1782a1b6b@mail.gmail.com>
Message-ID: <88e286470802281748s56d0a0bfg7a261918abaf88de@mail.gmail.com>

Do a search of your whole box for any copies of python25.dll. Where are they?

Graham

2008/2/29 Bruno Tikami <bruno@tikami.com.br>:
> One more thing: msvcr71.dll exists on Windows system directory
>
>
>
> On 2/28/08, Bruno Tikami <bruno@tikami.com.br> wrote:
> > Graham,
> >
> >
> > thanks for your reply man but I have Administrator privileges on the
> server and only Python2.5 installed. I've already uninstalled either Apache
> and mod_python and then reisntalled them. I've also rebooted the server
> beetween this procedures. Do you think I can try something else ?
> >
> > Regards,
> >
> > Tkm
> >
> >
> >
> > On 2/28/08, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > > Read section 'Python Requirements' of:
> > >
> > >   http://code.google.com/p/modwsgi/wiki/InstallationOnWindows
> > >
> > > Same things apply to mod_python.
> > >
> > > In short, install Python/Apache as Administrator. If you haven't done
> > > this, uninstall them as user you installed them as, and reinstall them
> > > as Administrator. Also heed notes about multiple Python installations.
> > >
> > > Graham
> > >
> > > 2008/2/28 Bruno Tikami <bruno@tikami.com.br>:
> > >
> > > > Hello fellows,
> > > >
> > > > I've just subscribed to the list and I'm writing to ask for help on a
> error
> > > > that (as far as I could serach on Google) lot of people have already
> faced:
> > > > Import error.
> > > >
> > > >
> > > >
> > > > Mod_python version. - 3.3.1
> > > >
> > > > Your operating system type, Windows 2000
> > > >
> > > > Your Python version, 2.5
> > > > Your Apache version. 2.2
> > > >
> > > > Relevant parts of the Apache config, .htaccess + Relevant parts of the
> > > > Python code. : I'm just trying the mpinfo trobleshooting
> > > > Error:
> > > >
> > > > ImportError: No module named mod_python.apache
> > > >  [Thu Feb 28 01:08:37 2008] [error] make_obcallback: Python path being
> used
> > > > "['C:\\\\Python25\\\\', 'C:\\\\Python25\\\\Scripts',
> 'C:\\\\tkmsoft\\\\',
> > > > 'C:\\\\tkmsoft\\\\srm', '', 'C:\\\\WINNT\\\\system32\\\\python25.zip',
> > > > 'C:\\\\Python25\\\\Lib', 'C:\\\\Python25\\\\DLLs',
> > > > 'C:\\\\Python25\\\\Lib\\\\lib-tk', '', 'C:\\\\Program Files\\\\Apache
> > > > Software Foundation\\\\Apache2.2\\\\bin']".
> > > >  [Thu Feb 28 01:08:37 2008] [error] get_interpreter: no interpreter
> callback
> > > > found.
> > > > [Thu Feb 28 01:08:37 2008] [error] [client 127.0.0.1] python_handler:
> Can't
> > > > get/create interpreter.
> > > >
> > > > Does anyone know how to solve it ?
> > > >
> > > > Regards,
> > > >
> > > > Tkm
> > > >
> > > >
> > >
> > > > _______________________________________________
> > > >  Mod_python mailing list
> > > >  Mod_python@modpython.org
> > > >  http://mailman.modpython.org/mailman/listinfo/mod_python
> > > >
> > > >
> > >
> >
> >
> >
> > --
> > []s!
> >
> > Tkm
> > http://djangopeople.net/brunotikami/
>
>
>
> --
> []s!
>
> Tkm
> http://djangopeople.net/brunotikami/
From bruno at tikami.com.br  Thu Feb 28 20:56:38 2008
From: bruno at tikami.com.br (Bruno Tikami)
Date: Thu Feb 28 20:56:45 2008
Subject: [mod_python] Import Error on Windows 2000
In-Reply-To: <88e286470802281748s56d0a0bfg7a261918abaf88de@mail.gmail.com>
References: <6fd74a2a0802272041k4bc8f9d4x9b306bbf17949f84@mail.gmail.com>
	<88e286470802281651k147f7656hd4cf4ed963190e91@mail.gmail.com>
	<6fd74a2a0802281714w4da11a87s86473a955ec67710@mail.gmail.com>
	<6fd74a2a0802281723t5856022cg2b97f0b1782a1b6b@mail.gmail.com>
	<88e286470802281748s56d0a0bfg7a261918abaf88de@mail.gmail.com>
Message-ID: <6fd74a2a0802281756o33d5634cod146bfb2bd53fa29@mail.gmail.com>

C:\Windows\system32

Tkm

On 2/28/08, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
>
> Do a search of your whole box for any copies of python25.dll. Where are
> they?
>
> Graham
>
> 2008/2/29 Bruno Tikami <bruno@tikami.com.br>:
>
> > One more thing: msvcr71.dll exists on Windows system directory
> >
> >
> >
> > On 2/28/08, Bruno Tikami <bruno@tikami.com.br> wrote:
> > > Graham,
> > >
> > >
> > > thanks for your reply man but I have Administrator privileges on the
> > server and only Python2.5 installed. I've already uninstalled either
> Apache
> > and mod_python and then reisntalled them. I've also rebooted the server
> > beetween this procedures. Do you think I can try something else ?
> > >
> > > Regards,
> > >
> > > Tkm
> > >
> > >
> > >
> > > On 2/28/08, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > > > Read section 'Python Requirements' of:
> > > >
> > > >   http://code.google.com/p/modwsgi/wiki/InstallationOnWindows
> > > >
> > > > Same things apply to mod_python.
> > > >
> > > > In short, install Python/Apache as Administrator. If you haven't
> done
> > > > this, uninstall them as user you installed them as, and reinstall
> them
> > > > as Administrator. Also heed notes about multiple Python
> installations.
> > > >
> > > > Graham
> > > >
> > > > 2008/2/28 Bruno Tikami <bruno@tikami.com.br>:
> > > >
> > > > > Hello fellows,
> > > > >
> > > > > I've just subscribed to the list and I'm writing to ask for help
> on a
> > error
> > > > > that (as far as I could serach on Google) lot of people have
> already
> > faced:
> > > > > Import error.
> > > > >
> > > > >
> > > > >
> > > > > Mod_python version. - 3.3.1
> > > > >
> > > > > Your operating system type, Windows 2000
> > > > >
> > > > > Your Python version, 2.5
> > > > > Your Apache version. 2.2
> > > > >
> > > > > Relevant parts of the Apache config, .htaccess + Relevant parts of
> the
> > > > > Python code. : I'm just trying the mpinfo trobleshooting
> > > > > Error:
> > > > >
> > > > > ImportError: No module named mod_python.apache
> > > > >  [Thu Feb 28 01:08:37 2008] [error] make_obcallback: Python path
> being
> > used
> > > > > "['C:\\\\Python25\\\\', 'C:\\\\Python25\\\\Scripts',
> > 'C:\\\\tkmsoft\\\\',
> > > > > 'C:\\\\tkmsoft\\\\srm', '',
> 'C:\\\\WINNT\\\\system32\\\\python25.zip',
> > > > > 'C:\\\\Python25\\\\Lib', 'C:\\\\Python25\\\\DLLs',
> > > > > 'C:\\\\Python25\\\\Lib\\\\lib-tk', '', 'C:\\\\Program
> Files\\\\Apache
> > > > > Software Foundation\\\\Apache2.2\\\\bin']".
> > > > >  [Thu Feb 28 01:08:37 2008] [error] get_interpreter: no
> interpreter
> > callback
> > > > > found.
> > > > > [Thu Feb 28 01:08:37 2008] [error] [client 127.0.0.1]
> python_handler:
> > Can't
> > > > > get/create interpreter.
> > > > >
> > > > > Does anyone know how to solve it ?
> > > > >
> > > > > Regards,
> > > > >
> > > > > Tkm
> > > > >
> > > > >
> > > >
> > > > > _______________________________________________
> > > > >  Mod_python mailing list
> > > > >  Mod_python@modpython.org
> > > > >  http://mailman.modpython.org/mailman/listinfo/mod_python
> > > > >
> > > > >
> > > >
> > >
> > >
> > >
> > > --
> > > []s!
> > >
> > > Tkm
> > > http://djangopeople.net/brunotikami/
> >
> >
> >
> > --
> > []s!
> >
> > Tkm
> > http://djangopeople.net/brunotikami/
>



-- 
[]s!

Tkm
http://djangopeople.net/brunotikami/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20080228/a202586f/attachment-0001.html
From graham.dumpleton at gmail.com  Thu Feb 28 21:01:41 2008
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Feb 28 21:01:47 2008
Subject: [mod_python] Import Error on Windows 2000
In-Reply-To: <6fd74a2a0802281756o33d5634cod146bfb2bd53fa29@mail.gmail.com>
References: <6fd74a2a0802272041k4bc8f9d4x9b306bbf17949f84@mail.gmail.com>
	<88e286470802281651k147f7656hd4cf4ed963190e91@mail.gmail.com>
	<6fd74a2a0802281714w4da11a87s86473a955ec67710@mail.gmail.com>
	<6fd74a2a0802281723t5856022cg2b97f0b1782a1b6b@mail.gmail.com>
	<88e286470802281748s56d0a0bfg7a261918abaf88de@mail.gmail.com>
	<6fd74a2a0802281756o33d5634cod146bfb2bd53fa29@mail.gmail.com>
Message-ID: <88e286470802281801u630fc0d4of2d07225e90fef46@mail.gmail.com>

Is Apache being run as a service, or as you? If run as a service and
thus potentially a different user, does that user have correct access
privileges to everything under Python25 directory?

Graham

2008/2/29 Bruno Tikami <bruno@tikami.com.br>:
> C:\Windows\system32
>
>
>
> Tkm
>
> On 2/28/08, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > Do a search of your whole box for any copies of python25.dll. Where are
> they?
> >
> > Graham
> >
> > 2008/2/29 Bruno Tikami <bruno@tikami.com.br>:
> >
> > > One more thing: msvcr71.dll exists on Windows system directory
> > >
> > >
> > >
> > > On 2/28/08, Bruno Tikami <bruno@tikami.com.br> wrote:
> > > > Graham,
> > > >
> > > >
> > > > thanks for your reply man but I have Administrator privileges on the
> > > server and only Python2.5 installed. I've already uninstalled either
> Apache
> > > and mod_python and then reisntalled them. I've also rebooted the server
> > > beetween this procedures. Do you think I can try something else ?
> > > >
> > > > Regards,
> > > >
> > > > Tkm
> > > >
> > > >
> > > >
> > > > On 2/28/08, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > > > > Read section 'Python Requirements' of:
> > > > >
> > > > >   http://code.google.com/p/modwsgi/wiki/InstallationOnWindows
> > > > >
> > > > > Same things apply to mod_python.
> > > > >
> > > > > In short, install Python/Apache as Administrator. If you haven't
> done
> > > > > this, uninstall them as user you installed them as, and reinstall
> them
> > > > > as Administrator. Also heed notes about multiple Python
> installations.
> > > > >
> > > > > Graham
> > > > >
> > > > > 2008/2/28 Bruno Tikami <bruno@tikami.com.br>:
> > > > >
> > > > > > Hello fellows,
> > > > > >
> > > > > > I've just subscribed to the list and I'm writing to ask for help
> on a
> > > error
> > > > > > that (as far as I could serach on Google) lot of people have
> already
> > > faced:
> > > > > > Import error.
> > > > > >
> > > > > >
> > > > > >
> > > > > > Mod_python version. - 3.3.1
> > > > > >
> > > > > > Your operating system type, Windows 2000
> > > > > >
> > > > > > Your Python version, 2.5
> > > > > > Your Apache version. 2.2
> > > > > >
> > > > > > Relevant parts of the Apache config, .htaccess + Relevant parts of
> the
> > > > > > Python code. : I'm just trying the mpinfo trobleshooting
> > > > > > Error:
> > > > > >
> > > > > > ImportError: No module named mod_python.apache
> > > > > >  [Thu Feb 28 01:08:37 2008] [error] make_obcallback: Python path
> being
> > > used
> > > > > > "['C:\\\\Python25\\\\', 'C:\\\\Python25\\\\Scripts',
> > > 'C:\\\\tkmsoft\\\\',
> > > > > > 'C:\\\\tkmsoft\\\\srm', '',
> 'C:\\\\WINNT\\\\system32\\\\python25.zip',
> > > > > > 'C:\\\\Python25\\\\Lib', 'C:\\\\Python25\\\\DLLs',
> > > > > > 'C:\\\\Python25\\\\Lib\\\\lib-tk', '', 'C:\\\\Program
> Files\\\\Apache
> > > > > > Software Foundation\\\\Apache2.2\\\\bin']".
> > > > > >  [Thu Feb 28 01:08:37 2008] [error] get_interpreter: no
> interpreter
> > > callback
> > > > > > found.
> > > > > > [Thu Feb 28 01:08:37 2008] [error] [client 127.0.0.1]
> python_handler:
> > > Can't
> > > > > > get/create interpreter.
> > > > > >
> > > > > > Does anyone know how to solve it ?
> > > > > >
> > > > > > Regards,
> > > > > >
> > > > > > Tkm
> > > > > >
> > > > > >
> > > > >
> > > > > > _______________________________________________
> > > > > >  Mod_python mailing list
> > > > > >  Mod_python@modpython.org
> > > > > >  http://mailman.modpython.org/mailman/listinfo/mod_python
> > > > > >
> > > > > >
> > > > >
> > > >
> > > >
> > > >
> > > > --
> > > > []s!
> > > >
> > > > Tkm
> > > > http://djangopeople.net/brunotikami/
> > >
> > >
> > >
> > > --
> > > []s!
> > >
> > > Tkm
> > > http://djangopeople.net/brunotikami/
> >
>
>
>
> --
>
> []s!
>
> Tkm
> http://djangopeople.net/brunotikami/
From kosa at heckler-koch.cz  Fri Feb 29 17:35:45 2008
From: kosa at heckler-koch.cz (kosa@heckler-koch.cz)
Date: Fri Feb 29 17:35:56 2008
Subject: [mod_python] semicolon problem
Message-ID: <47C888C1.8090504@heckler-koch.cz>

hi all

i have found out, that when sending text from our python based site from 
ajax to python i get lost all the strings after the semicolon.
for example if i wrote

hi;all

ajax will send me hi;all, but python receives only hi . I was searching 
a while for some post/get errors with semicolon, but did not succeed. I 
believe there should be some problem in our mod python handler or this 
should be fixed on other place?

should i add some more rule to handler or not?

thank you for advice
pavel
From clodoaldo.pinto.neto at gmail.com  Fri Feb 29 19:00:04 2008
From: clodoaldo.pinto.neto at gmail.com (Clodoaldo)
Date: Fri Feb 29 19:00:10 2008
Subject: [mod_python] semicolon problem
In-Reply-To: <47C888C1.8090504@heckler-koch.cz>
References: <47C888C1.8090504@heckler-koch.cz>
Message-ID: <a595de7a0802291600r203d9c5bh1f107bf24477344a@mail.gmail.com>

2008/2/29, kosa@heckler-koch.cz <kosa@heckler-koch.cz>:
> hi all
>
>  i have found out, that when sending text from our python based site from
>  ajax to python i get lost all the strings after the semicolon.
>  for example if i wrote
>
>  hi;all
>
>  ajax will send me hi;all, but python receives only hi . I was searching
>  a while for some post/get errors with semicolon, but did not succeed. I
>  believe there should be some problem in our mod python handler or this
>  should be fixed on other place?

Are you using get? If so try replacing the ; for %3b and see if it helps.

Regards, Clodoaldo Pinto Neto

>
>  should i add some more rule to handler or not?
>
>  thank you for advice
>  pavel
>  _______________________________________________
>  Mod_python mailing list
>  Mod_python@modpython.org
>  http://mailman.modpython.org/mailman/listinfo/mod_python
>
From kosa at heckler-koch.cz  Fri Feb 29 20:00:22 2008
From: kosa at heckler-koch.cz (kosa@heckler-koch.cz)
Date: Fri Feb 29 20:00:27 2008
Subject: [mod_python] semicolon problem
In-Reply-To: <a595de7a0802291600r203d9c5bh1f107bf24477344a@mail.gmail.com>
References: <47C888C1.8090504@heckler-koch.cz>
	<a595de7a0802291600r203d9c5bh1f107bf24477344a@mail.gmail.com>
Message-ID: <47C8AAA6.8000200@heckler-koch.cz>

Clodoaldo wrote:
> 2008/2/29, kosa@heckler-koch.cz <kosa@heckler-koch.cz>:
>   
>> hi all
>>
>>  i have found out, that when sending text from our python based site from
>>  ajax to python i get lost all the strings after the semicolon.
>>  for example if i wrote
>>
>>  hi;all
>>
>>  ajax will send me hi;all, but python receives only hi . I was searching
>>  a while for some post/get errors with semicolon, but did not succeed. I
>>  believe there should be some problem in our mod python handler or this
>>  should be fixed on other place?
>>     
>
> Are you using get? If so try replacing the ; for %3b and see if it helps.
>
> Regards, Clodoaldo Pinto Neto
>
>   
>>  should i add some more rule to handler or not?
>>
>>  thank you for advice
>>  pavel
>>  _______________________________________________
>>  Mod_python mailing list
>>  Mod_python@modpython.org
>>  http://mailman.modpython.org/mailman/listinfo/mod_python
>>
>>     
>
>   
hi and thankx for fast answer.
Yes i am using get. Unfortunately the part of ajax is black box for
me(and i know ajax is escaping spaces and other characters, but not
semicolon)
so i am looking rather for python solution.

pavel

From auther_bin at 21cn.com  Mon Feb 25 06:35:57 2008
From: auther_bin at 21cn.com (auther_bin)
Date: Mon Mar  3 17:16:34 2008
Subject: [mod_python] Help about apache mod_python Segmentation fault
Message-ID: <200802251935575881748@21cn.com>

Dear friends,

	When I compiling the apache python mod_python and install it into my uClibc envirentment, but when I 
runing httpd -X, send a very little request with index.html it crashed. after some debuging work, I find there should be something wrong in mod_python.c line(about 1561) which looks like:
--------------------------------- with my debug printing :) ------------------------
printf("JJJJJJJJ %s -> python_handler\n", phase);
printf("JJJJJJJJ %x[%d]\n", &req->per_dir_config, (&python_module)->module_index);
    /* get configuration */
    conf = (py_config *) ap_get_module_config(req->per_dir_config,
                                                  &python_module);
printf("JJJJJJJJ a %s conf=%x -> python_handler\n", phase,conf);
.............
------------------------------ end source --------------------------------------

I guess that, there should be a regester error in it. with some debug message I print:
------------- printing -------------------------------
JJJJJJJJJ PythonPostReadRequestHandler
JJJJJJJJ PythonInitHandler -> python_handler
JJJJJJJJ 820a544[29]
Segmentation fault
------------- end printing ---------------------------

any advices pls?

apache: 2.2.6 mod_python:3.3.1 python:2.5.1
 				
auther_bin
auther_bin@21cn.com
2008-02-25

