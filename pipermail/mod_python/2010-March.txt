From martijn at xs4us.nu  Mon Mar  1 12:58:09 2010
From: martijn at xs4us.nu (Martijn Moeling)
Date: Mon Mar  1 12:58:31 2010
Subject: [mod_python] migrating to mod_wsg
In-Reply-To: <b4545ff11003010118vd7d59eaidcc1a01ea9452a6@mail.gmail.com>
References: <b4545ff11002250308l7cc9baf2wa1e0db9cb05d053f@mail.gmail.com>
	<14A2B587-68EF-4CD3-B156-592B126024C1@xs4us.nu>
	<b4545ff11003010118vd7d59eaidcc1a01ea9452a6@mail.gmail.com>
Message-ID: <AF467476-C4B7-4B16-B040-B0FB323E50A9@xs4us.nu>

Lu/Ruben and others.

Some things I am working on...

I have set up a SourceForge project called "mptomwsgi" and it can be found on http://mptomwsgi.sourceforge.net
Please be patient, it has a CVS but no code uploaded yet.

I have to do some work on the Session.Py since I forgot to mention I use SQLAclhemy and my mptomwsgi version is using that.
The nice thing about SQLAlchemy (Database to Object mapper) is that it works on any Python DBAPI compatibe database. I have a MySQL Session object added to the original version too but that one is dependent on MP for now, I have to merge the two.

At this point I have a seemingly good working Req object, with support for register_cleanup.
I have no real Python package yet, and this adapter CANNOT be installed when Mod_Python is on the system since you will have to copy the files to the: python/site-packages/mod_python directory (for code compatibility)

you will get a sample index.wsgi and there you will have to do: import your_original_module_with_handler as app.

Can you (Lu/Ruben) send me a message with what parts of MP you use and what OS you are on so I can work out what I have to do to help you with reasonable documentation?
Some hints:
Authentication
stuff from mod_python.util like fieldstorage (which might just work, I just do not know at the moment)
Are you using SQLAlchemy?
etc.

Be aware that I do not have looked into publisher (never ever used it), I have to bother Graham with that but for now I will not support that.

Updates will follow soon!

Martijn






On Mar 1, 2010, at 10:18 AM, Lu wrote:

> Great!
> Thanks for your time,
> luca
> 
> On Mon, Mar 1, 2010 at 12:29 AM, Martijn Moeling <martijn@xs4us.nu> wrote:
> Please give me some time to build instructions and a zip file, I'm extremely busy until next wednesday, I hope i can find the time to get it done in between!
> 
> On Feb 25, 2010, at 12:08 PM, Lu wrote:
> 
>> I have written an adapter for mod_wsgi which is code compatible for Mod_python programs.
>> My mod_python CMS runs now on top of mod_wsgi without any changes to the code.
>> 
>> It is really small and consists of one index.wsgi to created the req object and call the handler and a "fake" python package for the apache.py, Session.Py, Cookie.py etc. (I did need to change some stuff in there)
>> I did this for my own use since I like the Req object and to pass it around, so my code is very dependent on MP. I have completely turned over Session.Py for my own session management which stores in MySQL and has License stuff etc.
>> 
>> I consider it Beta since I am the only one running it and do not touch all the code.
>> 
>> This code is free to use by anybody (Be aware it should be GPL or so). At the moment there is no CVS or License simply because I do not have the time to set stuff like that up (never did that before). I just started coding Python with Eclipse and Pydev as preparation on starting CVS use.
>> 
>> Drop me an email if u r interested I'll help you out using email/MSN Messenger/Skype etc
>> 
>> Hi Martijn,
>> I'm interested in your code, can you please sent to me a copy ?
>> thanks,
>> luca
> 
> 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20100301/fed92cee/attachment.html
From graham.dumpleton at gmail.com  Mon Mar  1 17:47:39 2010
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Mar  1 17:47:44 2010
Subject: [mod_python] migrating to mod_wsg
In-Reply-To: <AF467476-C4B7-4B16-B040-B0FB323E50A9@xs4us.nu>
References: <b4545ff11002250308l7cc9baf2wa1e0db9cb05d053f@mail.gmail.com>
	<14A2B587-68EF-4CD3-B156-592B126024C1@xs4us.nu>
	<b4545ff11003010118vd7d59eaidcc1a01ea9452a6@mail.gmail.com>
	<AF467476-C4B7-4B16-B040-B0FB323E50A9@xs4us.nu>
Message-ID: <88e286471003011447o789c2dbbw80d535c3d4bc5bfa@mail.gmail.com>

2010/3/2 Martijn Moeling <martijn@xs4us.nu>:
> Lu/Ruben and others.
> Some things I am working on...
> I have set up a SourceForge project called "mptomwsgi" and it can be found
> on?http://mptomwsgi.sourceforge.net
> Please be patient, it has a CVS but no code uploaded yet.
> I have to do some work on the Session.Py since I forgot to mention I use
> SQLAclhemy and my mptomwsgi version is using that.
> The nice thing about SQLAlchemy (Database to Object mapper) is that it works
> on any Python DBAPI compatibe database. I have a MySQL Session object added
> to the original version too but that one is dependent on MP for now, I have
> to merge the two.
> At this point I have a seemingly good working Req object, with support for
> register_cleanup.
> I have no real Python package yet, and this adapter CANNOT be installed when
> Mod_Python is on the system since you will have to copy the files to the:
> python/site-packages/mod_python directory (for code compatibility)

There are ways around that. You can have it under some other namespace
and then in the adapter from WSGI you push module references direct
into sys.modules.

Graham

> you will get a sample index.wsgi and there you will have to do: import
> your_original_module_with_handler as app.
> Can you (Lu/Ruben) send me a message with what parts of MP you use and what
> OS you are on so I can work out what I have to do to help you with
> reasonable documentation?
> Some hints:
> Authentication
> stuff from mod_python.util like fieldstorage (which might just work, I just
> do not know at the moment)
> Are you using SQLAlchemy?
> etc.
> Be aware that I do not have looked into publisher (never ever used it), I
> have to bother Graham with that but for now I will not support that.
> Updates will follow soon!
> Martijn
>
>
>
>
>
> On Mar 1, 2010, at 10:18 AM, Lu wrote:
>
> Great!
> Thanks for your time,
> luca
> On Mon, Mar 1, 2010 at 12:29 AM, Martijn Moeling <martijn@xs4us.nu> wrote:
>>
>> Please give me some time to build instructions and a zip file, I'm
>> extremely busy until next wednesday, I hope i can find the time to get it
>> done in between!
>> On Feb 25, 2010, at 12:08 PM, Lu wrote:
>>>
>>> I have written an adapter for mod_wsgi which is code compatible for
>>> Mod_python programs.
>>>
>>> My mod_python CMS runs now on top of mod_wsgi without any changes to the
>>> code.
>>>
>>> It is really small and consists of one index.wsgi to created the req
>>> object and call the handler and a "fake" python package for the apache.py,
>>> Session.Py, Cookie.py etc. (I did need to change some stuff in there)
>>>
>>> I did this for my own use since I like the Req object and to pass it
>>> around, so my code is very dependent on MP. I have completely turned over
>>> Session.Py for my own session management which stores in MySQL and has
>>> License stuff etc.
>>>
>>> I consider it Beta since I am the only one running it and do not touch
>>> all the code.
>>>
>>> This code is free to use by anybody (Be aware it should be GPL or so). At
>>> the moment there is no CVS or License simply because I do not have the time
>>> to set stuff like that up (never did that before). I just started coding
>>> Python with Eclipse and Pydev as preparation on starting CVS use.
>>>
>>> Drop me an email if u r interested I'll help you out using email/MSN
>>> Messenger/Skype etc
>>
>> Hi Martijn,
>> I'm interested in your code, can you please sent to me a copy ?
>> thanks,
>> luca
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>

From lgp171188 at gmail.com  Tue Mar  2 09:36:07 2010
From: lgp171188 at gmail.com (L.Guruprasad)
Date: Tue Mar  2 09:37:09 2010
Subject: [mod_python] Setting the cookie domain name using mod_python's
	Cookie class
Message-ID: <4B8D2257.7000107@gmail.com>

Hi all,
Is it possible to set the domain for which a cookie is valid using
mod_python's Cookie class? I need to know about this because I want to
share cookies between 2 subdomains of a common superdomain.

This is how my workflow goes:

Login into Web app1 -> Authenticates and sets cookie for
subdomain1.domain.com.

Open Web app2 -> Check for session cookie, if it isn't there, redirect
to web app1 with referring_url set to web-app2 domain. Web app1, checks
for cookie in the browser which will be there if the user has logged in.
It takes the session id and sees if user of that session id has
privilege for app2 and if it is true, it sets cookie for
subdomain2.domain.com and redirects to the initially set referrer_url.

Is this possible with mod_python?

Regards,
Guruprasad
From graham.dumpleton at gmail.com  Tue Mar  2 18:11:34 2010
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Mar  2 18:11:42 2010
Subject: [mod_python] Setting the cookie domain name using mod_python's 
	Cookie class
In-Reply-To: <4B8D2257.7000107@gmail.com>
References: <4B8D2257.7000107@gmail.com>
Message-ID: <88e286471003021511r3056fe70re228d0dff16127ac@mail.gmail.com>

On 3 March 2010 01:36, L.Guruprasad <lgp171188@gmail.com> wrote:
> Hi all,
> Is it possible to set the domain for which a cookie is valid using
> mod_python's Cookie class? I need to know about this because I want to
> share cookies between 2 subdomains of a common superdomain.
>
> This is how my workflow goes:
>
> Login into Web app1 -> Authenticates and sets cookie for
> subdomain1.domain.com.
>
> Open Web app2 -> Check for session cookie, if it isn't there, redirect
> to web app1 with referring_url set to web-app2 domain. Web app1, checks
> for cookie in the browser which will be there if the user has logged in.
> It takes the session id and sees if user of that session id has
> privilege for app2 and if it is true, it sets cookie for
> subdomain2.domain.com and redirects to the initially set referrer_url.
>
> Is this possible with mod_python?

The documentation mentions the 'domain' attribute is available.

http://www.modpython.org/live/current/doc-html/pyapi-cookie-classes.html

Read some general documentation about cookies to work out what it can be set to.

In short, by default you cannot share a cookie between two distinct
hosts, you can however share it across hosts in same parent domain by
setting the 'domain' to the parent domain.

Graham
From sosoba at coig.katowice.pl  Wed Mar  3 02:51:21 2010
From: sosoba at coig.katowice.pl (=?utf-8?Q?S=C5=82awomir_Osoba?=)
Date: Wed Mar  3 02:51:33 2010
Subject: [mod_python] Apache mod_wsgi and auth handlers
In-Reply-To: <88e286471003021511r3056fe70re228d0dff16127ac@mail.gmail.com>
References: <4B8D2257.7000107@gmail.com>
	<88e286471003021511r3056fe70re228d0dff16127ac@mail.gmail.com>
Message-ID: <6CA1B282375D462DB0FE3255497C9677@win.coig.com>

I use mod_python for handling authentication and authorization (Directive 
PythonAccessHandler and PythonAuthenHandler) static files and PHP 
applications. Is it possible to transfer this functionality to mod_wsgi? 

From graham.dumpleton at gmail.com  Wed Mar  3 04:16:06 2010
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Mar  3 04:16:13 2010
Subject: [mod_python] Apache mod_wsgi and auth handlers
In-Reply-To: <6CA1B282375D462DB0FE3255497C9677@win.coig.com>
References: <4B8D2257.7000107@gmail.com>
	<88e286471003021511r3056fe70re228d0dff16127ac@mail.gmail.com>
	<6CA1B282375D462DB0FE3255497C9677@win.coig.com>
Message-ID: <88e286471003030116la1c80a0la8cef2260d1747ed@mail.gmail.com>

2010/3/3 S?awomir Osoba <sosoba@coig.katowice.pl>:
> I use mod_python for handling authentication and authorization (Directive
> PythonAccessHandler and PythonAuthenHandler) static files and PHP
> applications. Is it possible to transfer this functionality to mod_wsgi?

Read:

  http://code.google.com/p/modwsgi/wiki/AccessControlMechanisms

The mod_wsgi module implements the newer Apache concept of
authentication providers whereby you only need to authenticate the
user and not actually generate the error page, Apache will do the
latter for you, or you can use an ErrorDocument directive to redirect
to a custom page of your own.

For access handler, mod_wsgi provides a simpler mechanism for what is
the common idiom that hook is used for. That is indicating whether a
remote client should be allowed access.

Graham

From legal at mianos.com  Wed Mar  3 06:28:07 2010
From: legal at mianos.com (Rob Fowler)
Date: Wed Mar  3 06:28:20 2010
Subject: [mod_python] passing parameters from index() to POST method
Message-ID: <4B8E47C7.8050801@mianos.com>

Excuse me if this has been answered, I have searched for an answer but I 
am open to someone saying 'FAQ ask this'.
I have a web form with this in it:
..
<FORM value="form" action="wifikeys.py/gen_keys" method="post">
..
the function 'gen_keys' needs a dictionary already read in the index 
function.

Is there a normal way to get an objects from 'index' to 'gen_keys' (in 
other words from the initial python function to the function called by 
the post)?

 From my understanding, apache calls the index function to get the data 
to populate the reply then the function yields back to apache, with 
nothing called until the client 'POSTS' then apache calls the post 
function specified.

I use a database so I already solved the lack of database handle on the 
post method using a singleton and simply instancing it in the post 
function (globals by any other name) but this function needs different 
data depending on the form.

TIA,
  Rob Fowler
From martijn at xs4us.nu  Wed Mar  3 08:24:37 2010
From: martijn at xs4us.nu (Martijn Moeling)
Date: Wed Mar  3 08:24:49 2010
Subject: [mod_python] Bitbucket.org link for MP2MWSGI
Message-ID: <676951AB-2BBB-48B0-8E68-D72CCDFAA4BD@xs4us.nu>

Due to Graham (Thanks man, bb is indeed far better than SourceForge) I have created a repository on Bitbucket.org.
After a lot of fiddling with my Eclipse I managed to get it all working and now I can set my focus on getting version 0.1Beta ready for distribution (Still some work to do)

Updates will be posted here, but code can be viewed at:

http://bitbucket.org/mmoeling/mp2mwsgi/

Martijn



From martijn at xs4us.nu  Wed Mar  3 08:30:27 2010
From: martijn at xs4us.nu (Martijn Moeling)
Date: Wed Mar  3 08:30:51 2010
Subject: [mod_python] passing parameters from index() to POST method
In-Reply-To: <4B8E47C7.8050801@mianos.com>
References: <4B8E47C7.8050801@mianos.com>
Message-ID: <4CC38516-1880-4A84-89DC-F29866BF2406@xs4us.nu>

I'm nut excacly sure what you are trying to achieve.

In your index.py handler you can:

from wifikeys import gen_keys

def handler(req):
	If req.method == "POST":
		gen_keys(parameters here)
	else:
		normal handler code
	retrun apache.OK



On Mar 3, 2010, at 12:28 PM, Rob Fowler wrote:

> Excuse me if this has been answered, I have searched for an answer but I am open to someone saying 'FAQ ask this'.
> I have a web form with this in it:
> ..
> <FORM value="form" action="wifikeys.py/gen_keys" method="post">
> ..
> the function 'gen_keys' needs a dictionary already read in the index function.
> 
> Is there a normal way to get an objects from 'index' to 'gen_keys' (in other words from the initial python function to the function called by the post)?
> 
> From my understanding, apache calls the index function to get the data to populate the reply then the function yields back to apache, with nothing called until the client 'POSTS' then apache calls the post function specified.
> 
> I use a database so I already solved the lack of database handle on the post method using a singleton and simply instancing it in the post function (globals by any other name) but this function needs different data depending on the form.
> 
> TIA,
> Rob Fowler
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python


From legal at mianos.com  Wed Mar  3 19:27:53 2010
From: legal at mianos.com (Rob Fowler)
Date: Wed Mar  3 19:28:05 2010
Subject: [mod_python] passing parameters from index() to POST method
In-Reply-To: <4CC38516-1880-4A84-89DC-F29866BF2406@xs4us.nu>
References: <4B8E47C7.8050801@mianos.com>
	<4CC38516-1880-4A84-89DC-F29866BF2406@xs4us.nu>
Message-ID: <4B8EFE89.6060605@mianos.com>

Although that works fine and will call my post function, the apache 
server calls the handler a second time so all the local variables are 
new. What I want to do is pass a parameter to the 'POST' function 
(gen_keys here).
For example, to change my example to the model suggested below:

def gen_keys(dictionary):
     do stuff

def handler(req):
     If req.method == "POST":
         gen_keys(specificDictionary )
     else:
         specificDictionary = readDictionary("/blah/specialdict.txt", 
"rule 1")
         req.write("""<HTML ... <FORM value="form" 
action="handler.py/handler" method="post"> etc
     return apache.OK

Just use global variables? I don't like to use them in apache modules, 
just the vibe.

On 4/03/2010 12:30 AM, Martijn Moeling wrote:
> I'm nut excacly sure what you are trying to achieve.
>
> In your index.py handler you can:
>
> from wifikeys import gen_keys
>
> def handler(req):
> 	If req.method == "POST":
> 		gen_keys(parameters here)
> 	else:
> 		normal handler code
> 	retrun apache.OK
>
>
>
> On Mar 3, 2010, at 12:28 PM, Rob Fowler wrote:
>
>    
>

From graham.dumpleton at gmail.com  Wed Mar  3 19:41:11 2010
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Mar  3 19:41:17 2010
Subject: [mod_python] passing parameters from index() to POST method
In-Reply-To: <4B8EFE89.6060605@mianos.com>
References: <4B8E47C7.8050801@mianos.com>
	<4CC38516-1880-4A84-89DC-F29866BF2406@xs4us.nu>
	<4B8EFE89.6060605@mianos.com>
Message-ID: <88e286471003031641p73789352la5985bbfb5d1adcf@mail.gmail.com>

On 4 March 2010 11:27, Rob Fowler <legal@mianos.com> wrote:
> Although that works fine and will call my post function, the apache server
> calls the handler a second time so all the local variables are new.

You better explain that a bit better. The handler function should not
be called multiple times for the same request.

Dump out req.uri to see what URL is being accessed on each call. They
may actually be two separate requests. This can occur where a web
browser keeps requesting a favicon.ico and it doesn't exist.

Graham

> What I
> want to do is pass a parameter to the 'POST' function (gen_keys here).
> For example, to change my example to the model suggested below:
>
> def gen_keys(dictionary):
> ? ?do stuff
>
> def handler(req):
> ? ?If req.method == "POST":
> ? ? ? ?gen_keys(specificDictionary )
> ? ?else:
> ? ? ? ?specificDictionary = readDictionary("/blah/specialdict.txt", "rule
> 1")
> ? ? ? ?req.write("""<HTML ... <FORM value="form" action="handler.py/handler"
> method="post"> etc
> ? ?return apache.OK
>
> Just use global variables? I don't like to use them in apache modules, just
> the vibe.
>
> On 4/03/2010 12:30 AM, Martijn Moeling wrote:
>>
>> I'm nut excacly sure what you are trying to achieve.
>>
>> In your index.py handler you can:
>>
>> from wifikeys import gen_keys
>>
>> def handler(req):
>> ? ? ? ?If req.method == "POST":
>> ? ? ? ? ? ? ? ?gen_keys(parameters here)
>> ? ? ? ?else:
>> ? ? ? ? ? ? ? ?normal handler code
>> ? ? ? ?retrun apache.OK
>>
>>
>>
>> On Mar 3, 2010, at 12:28 PM, Rob Fowler wrote:
>>
>>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From graham.dumpleton at gmail.com  Wed Mar  3 19:42:04 2010
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Mar  3 19:42:09 2010
Subject: [mod_python] passing parameters from index() to POST method
In-Reply-To: <88e286471003031641p73789352la5985bbfb5d1adcf@mail.gmail.com>
References: <4B8E47C7.8050801@mianos.com>
	<4CC38516-1880-4A84-89DC-F29866BF2406@xs4us.nu>
	<4B8EFE89.6060605@mianos.com>
	<88e286471003031641p73789352la5985bbfb5d1adcf@mail.gmail.com>
Message-ID: <88e286471003031642l798c61es7b4bd5e1f811dc69@mail.gmail.com>

On 4 March 2010 11:41, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> On 4 March 2010 11:27, Rob Fowler <legal@mianos.com> wrote:
>> Although that works fine and will call my post function, the apache server
>> calls the handler a second time so all the local variables are new.
>
> You better explain that a bit better. The handler function should not
> be called multiple times for the same request.
>
> Dump out req.uri to see what URL is being accessed on each call. They
> may actually be two separate requests. This can occur where a web
> browser keeps requesting a favicon.ico and it doesn't exist.

It could also occur if you have mucked up your Apache configuration
and have listed the handler more than once using mod_python
directives.

Graham

> Graham
>
>> What I
>> want to do is pass a parameter to the 'POST' function (gen_keys here).
>> For example, to change my example to the model suggested below:
>>
>> def gen_keys(dictionary):
>> ? ?do stuff
>>
>> def handler(req):
>> ? ?If req.method == "POST":
>> ? ? ? ?gen_keys(specificDictionary )
>> ? ?else:
>> ? ? ? ?specificDictionary = readDictionary("/blah/specialdict.txt", "rule
>> 1")
>> ? ? ? ?req.write("""<HTML ... <FORM value="form" action="handler.py/handler"
>> method="post"> etc
>> ? ?return apache.OK
>>
>> Just use global variables? I don't like to use them in apache modules, just
>> the vibe.
>>
>> On 4/03/2010 12:30 AM, Martijn Moeling wrote:
>>>
>>> I'm nut excacly sure what you are trying to achieve.
>>>
>>> In your index.py handler you can:
>>>
>>> from wifikeys import gen_keys
>>>
>>> def handler(req):
>>> ? ? ? ?If req.method == "POST":
>>> ? ? ? ? ? ? ? ?gen_keys(parameters here)
>>> ? ? ? ?else:
>>> ? ? ? ? ? ? ? ?normal handler code
>>> ? ? ? ?retrun apache.OK
>>>
>>>
>>>
>>> On Mar 3, 2010, at 12:28 PM, Rob Fowler wrote:
>>>
>>>
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>
>

From legal at mianos.com  Wed Mar  3 19:47:52 2010
From: legal at mianos.com (Rob Fowler)
Date: Wed Mar  3 19:48:03 2010
Subject: [mod_python] passing parameters from index() to POST method
In-Reply-To: <88e286471003031641p73789352la5985bbfb5d1adcf@mail.gmail.com>
References: <4B8E47C7.8050801@mianos.com>	
	<4CC38516-1880-4A84-89DC-F29866BF2406@xs4us.nu>	
	<4B8EFE89.6060605@mianos.com>
	<88e286471003031641p73789352la5985bbfb5d1adcf@mail.gmail.com>
Message-ID: <4B8F0338.40107@mianos.com>

 From my earlier example, it was not called twice. I made it called 
twice as suggested here.
Maybe this is more clear: Ideally I simply want to have an index 
function to set the stuff up and show the form and another function that 
gets called when the client does the post (the easy bit) but I want some 
variables that are set up in the index to be present in the function 
called on post. Is there a standard way to post variable between the 
handler and the post functions?


On 4/03/2010 11:41 AM, Graham Dumpleton wrote:
> On 4 March 2010 11:27, Rob Fowler<legal@mianos.com>  wrote:
>    
>> Although that works fine and will call my post function, the apache server
>> calls the handler a second time so all the local variables are new.
>>      
> You better explain that a bit better. The handler function should not
> be called multiple times for the same request.
>
> Dump out req.uri to see what URL is being accessed on each call. They
> may actually be two separate requests. This can occur where a web
> browser keeps requesting a favicon.ico and it doesn't exist.
>
> Graham
>
>    

From diazona at gmail.com  Wed Mar  3 19:56:02 2010
From: diazona at gmail.com (David Zaslavsky)
Date: Wed Mar  3 19:56:18 2010
Subject: [mod_python] passing parameters from index() to POST method
In-Reply-To: <4B8E47C7.8050801@mianos.com>
References: <4B8E47C7.8050801@mianos.com>
Message-ID: <201003031956.08556.diazona@gmail.com>

If I understand correctly: you're talking about a situation where the client 
visits the URL wifikeys.py/index, which generates the page that includes the 
HTML form; then the user fills in the form and submits it via POST method to 
the URL wifikeys.py/gen_keys, at which time mod_python calls the gen_keys 
method, right?

The normal way to pass data to a form handler (your gen_keys method) is to 
encode it as hidden input fields in the form.  For each pair "name"="value" 
that you want to transmit to gen_keys, the form should include an element like
 <input type="hidden" name="name" value="value">
These input elements will not show up in the browser but their names and 
values will be submitted along with the visible form fields, just like any 
other input elements in the form.  (Note that a technically savvy user can 
change the values)

Another way to handle it would be to store the data in a session.

:) David

On Wednesday 03 March 2010 6:28:07 am Rob Fowler wrote:
> Excuse me if this has been answered, I have searched for an answer but I
> am open to someone saying 'FAQ ask this'.
> I have a web form with this in it:
> ..
> <FORM value="form" action="wifikeys.py/gen_keys" method="post">
> ..
> the function 'gen_keys' needs a dictionary already read in the index
> function.
> 
> Is there a normal way to get an objects from 'index' to 'gen_keys' (in
> other words from the initial python function to the function called by
> the post)?
> 
>  From my understanding, apache calls the index function to get the data
> to populate the reply then the function yields back to apache, with
> nothing called until the client 'POSTS' then apache calls the post
> function specified.
> 
> I use a database so I already solved the lack of database handle on the
> post method using a singleton and simply instancing it in the post
> function (globals by any other name) but this function needs different
> data depending on the form.
> 
> TIA,
>   Rob Fowler
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 198 bytes
Desc: This is a digitally signed message part.
Url : http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20100303/7b8c88e9/attachment.bin
From martijn at xs4us.nu  Thu Mar  4 04:58:12 2010
From: martijn at xs4us.nu (Martijn Moeling)
Date: Thu Mar  4 04:58:44 2010
Subject: [mod_python] passing parameters from index() to POST method
In-Reply-To: <4B8F0338.40107@mianos.com>
References: <4B8E47C7.8050801@mianos.com>	
	<4CC38516-1880-4A84-89DC-F29866BF2406@xs4us.nu>	
	<4B8EFE89.6060605@mianos.com>
	<88e286471003031641p73789352la5985bbfb5d1adcf@mail.gmail.com>
	<4B8F0338.40107@mianos.com>
Message-ID: <E0DD4B63-C69B-4BD3-B277-F8BAB91C23C5@xs4us.nu>

I agree with both David and Graham,

Favicon.ico confuses a lot of people and setting HIDDEN PARAMETERS to the form might be a good solution. Indeed global variables are not the way to go since it will go horribly wrong when multiple users are using it, and with a reload (depending on your apache config/multiple processes/maxrequests etc. globals are not set correctly if the post is handled by a different process than the process serving the get of the form)

another small tip is to look at your apache access_log and error_log.

I have never ever seen requests come in twice, and I do a lot of low level HTTP stuff in my work (like building webdav, caldav servers etc.) . Dump your code and the Apache config together with  your access_log and error_log (clear them, and make one request and post)
so we can see what is really going on.

Martijn

On Mar 4, 2010, at 1:47 AM, Rob Fowler wrote:

> From my earlier example, it was not called twice. I made it called twice as suggested here.
> Maybe this is more clear: Ideally I simply want to have an index function to set the stuff up and show the form and another function that gets called when the client does the post (the easy bit) but I want some variables that are set up in the index to be present in the function called on post. Is there a standard way to post variable between the handler and the post functions?
> 
> 
> On 4/03/2010 11:41 AM, Graham Dumpleton wrote:
>> On 4 March 2010 11:27, Rob Fowler<legal@mianos.com>  wrote:
>>   
>>> Although that works fine and will call my post function, the apache server
>>> calls the handler a second time so all the local variables are new.
>>>     
>> You better explain that a bit better. The handler function should not
>> be called multiple times for the same request.
>> 
>> Dump out req.uri to see what URL is being accessed on each call. They
>> may actually be two separate requests. This can occur where a web
>> browser keeps requesting a favicon.ico and it doesn't exist.
>> 
>> Graham
>> 
>>   
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python


From manikandank at tce.edu  Thu Mar  4 08:57:12 2010
From: manikandank at tce.edu (K.Manikandan)
Date: Thu Mar  4 08:57:28 2010
Subject: [mod_python] Session management implementation in mod_python
Message-ID: <75a24068c943dc6aaf462d56ddc923f3.squirrel@mail.tce.edu>

Hi,

We have created two web applications within the a single domain. We are
using mod_python cookies. And I have set the cookies with domain as the
main domain. Now, I am unable to access the cookie that I had set in one
application from the other. What things, other than setting the domain of
the cookie should be done so as to enable the access of a cookie of one
application from another ?

Regards,
Manikandan K


-----------------------------------------
This email was sent using TCEMail Service.
Thiagarajar College of Engineering
Madurai-625 015, India

From lgp171188 at gmail.com  Thu Mar  4 08:57:36 2010
From: lgp171188 at gmail.com (L.Guruprasad)
Date: Thu Mar  4 08:58:08 2010
Subject: [mod_python] The link in the mailing list home that points to the
 'archives' is invalid
Message-ID: <4B8FBC50.1050403@gmail.com>

Hi all,
The link in the mailing list home page points to
'http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python'
instead of the correct 'http://modpython.org/pipermail/mod_python'. Can
the list admin look into this and get it corrected?

Regards,
Guruprasad
From martijn at xs4us.nu  Thu Mar  4 09:24:56 2010
From: martijn at xs4us.nu (Martijn Moeling)
Date: Thu Mar  4 09:25:16 2010
Subject: [mod_python] Session management implementation in mod_python
In-Reply-To: <75a24068c943dc6aaf462d56ddc923f3.squirrel@mail.tce.edu>
References: <75a24068c943dc6aaf462d56ddc923f3.squirrel@mail.tce.edu>
Message-ID: <5693EE1C-78F8-4B56-972B-0D4207090911@xs4us.nu>

Can you tell me what the domains are, this is important to help you

I think you mean:

host1.domain.com
host2.domain.com

and you want to set the cookie for *.domain.com

is that true?

Martijn

On Mar 4, 2010, at 2:57 PM, K.Manikandan wrote:

> Hi,
> 
> We have created two web applications within the a single domain. We are
> using mod_python cookies. And I have set the cookies with domain as the
> main domain. Now, I am unable to access the cookie that I had set in one
> application from the other. What things, other than setting the domain of
> the cookie should be done so as to enable the access of a cookie of one
> application from another ?
> 
> Regards,
> Manikandan K
> 
> 
> -----------------------------------------
> This email was sent using TCEMail Service.
> Thiagarajar College of Engineering
> Madurai-625 015, India
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From victor.gil.sepulveda at gmail.com  Thu Mar  4 10:49:18 2010
From: victor.gil.sepulveda at gmail.com (=?ISO-8859-1?B?Vu1jdG9y?=)
Date: Thu Mar  4 10:49:45 2010
Subject: [mod_python] About retrieving cookies...
Message-ID: <db308f471003040749i234c8396y96ab009377a1a05e@mail.gmail.com>

Dear all,

I've got a bunch of problems using cookies. First, it seems that if
you want to store a cookie, you MUST do it before any req.write()
sentence, isn't it?

Next... I've managed to store a simple cookie named "login_cookie"
with value 100. I can see it in the cookies manager in firefox, and it
has the right value. The cookie has an expiration time of 30 days from
now.

The problem is that... it's absolutely impossible to retrieve it from
the browser.

I have a small test page with this javascript function (it uses prototype):

function accessPage(){
				new Ajax.Request(access_base_dir+'access', {
			
					method: 'post',
					
					onSuccess: function(response) {
						$("resultados").innerHTML =response.responseText;
					},
					
					onFailure:function(response) {
						$("resultados").innerHTML= "Failed to access."+response.responseText;

					}
				});
				
			}

This function just asks 'access' to return the content. 'access' looks
like this:

@_session_getter
def access(req):
	
	(logged,user_id) = getSessionData(req)
	
	all_cookies = Cookie.get_cookies(req)
	
	req.write("Access: " +str(all_cookies))

And guess what, it only writes Access: {'pysid': } , the session
cookie, but "login_cookie" is not anywhere.

My apache config for this folder is:


<Directory "htdocs/python/test">
	AddHandler mod_python .py
	PythonHandler mod_python.publisher
	PythonDebug On
</Directory>

Do you know If I'm missing anything obvious that prevents the cookie
retrieval to work?

Thanks!,
-- 

V?ctor Gil Sep?lveda
E. Informatica - FIB - UPC

From manikandank at tce.edu  Thu Mar  4 11:27:43 2010
From: manikandank at tce.edu (K.Manikandan)
Date: Thu Mar  4 11:28:00 2010
Subject: [mod_python] Session management implementation in mod_python
In-Reply-To: <5693EE1C-78F8-4B56-972B-0D4207090911@xs4us.nu>
References: <75a24068c943dc6aaf462d56ddc923f3.squirrel@mail.tce.edu>
	<5693EE1C-78F8-4B56-972B-0D4207090911@xs4us.nu>
Message-ID: <5313e190396855a70aeddc53591d6090.squirrel@mail.tce.edu>


> Can you tell me what the domains are, this is important to help you
>
> I think you mean:
>
> host1.domain.com
> host2.domain.com
>
> and you want to set the cookie for *.domain.com
>
> is that true?
>
> Martijn
>

Yes. We had set a cookie from host1.domain.com with its domain as
'.domain.com' .. After opening the 'host1/domain.com, the web browser
shows its cookie and its domain as '.domain.com/ .Now if we try to use

c = Cookie.get_cookies(req) from the host2.domain.com, the cookie is not
found. And of course the cookie that we had set for this host is
accessible...

Regards,
Manikandan K


-----------------------------------------
This email was sent using TCEMail Service.
Thiagarajar College of Engineering
Madurai-625 015, India

From martijn at xs4us.nu  Thu Mar  4 11:39:36 2010
From: martijn at xs4us.nu (Martijn Moeling)
Date: Thu Mar  4 11:39:54 2010
Subject: [mod_python] About retrieving cookies...
In-Reply-To: <db308f471003040749i234c8396y96ab009377a1a05e@mail.gmail.com>
References: <db308f471003040749i234c8396y96ab009377a1a05e@mail.gmail.com>
Message-ID: <36BC0A40-3CB5-43FA-804A-A30402019555@xs4us.nu>

Hi Victor,

Cookies are send to the browser in the HTTP header, so yes set them before any write operation as the headers are send at the first write.

Next, Why are you trying to get the contents from a cookie which is stored on the "client" via a call to the server, it is not logical, 
I suggest you read about cookies and how they work. I can give you a very long description about how cookies work but this is not mod_python related.

If you really want to do this (I do not see any reason though). Google on "access cookies from javascript" or do a search on "document.cookie". Like Firefox (I think FF uses javascript for this too).
you CAN access it locally. Use Firebug (javascript debug plugin) to investigate stuff.

I hope this helps

Martijn



On Mar 4, 2010, at 4:49 PM, V?ctor wrote:

> Dear all,
> 
> I've got a bunch of problems using cookies. First, it seems that if
> you want to store a cookie, you MUST do it before any req.write()
> sentence, isn't it?
> 
> Next... I've managed to store a simple cookie named "login_cookie"
> with value 100. I can see it in the cookies manager in firefox, and it
> has the right value. The cookie has an expiration time of 30 days from
> now.
> 
> The problem is that... it's absolutely impossible to retrieve it from
> the browser.
> 
> I have a small test page with this javascript function (it uses prototype):
> 
> function accessPage(){
> 				new Ajax.Request(access_base_dir+'access', {
> 			
> 					method: 'post',
> 					
> 					onSuccess: function(response) {
> 						$("resultados").innerHTML =response.responseText;
> 					},
> 					
> 					onFailure:function(response) {
> 						$("resultados").innerHTML= "Failed to access."+response.responseText;
> 
> 					}
> 				});
> 				
> 			}
> 
> This function just asks 'access' to return the content. 'access' looks
> like this:
> 
> @_session_getter
> def access(req):
> 	
> 	(logged,user_id) = getSessionData(req)
> 	
> 	all_cookies = Cookie.get_cookies(req)
> 	
> 	req.write("Access: " +str(all_cookies))
> 
> And guess what, it only writes Access: {'pysid': } , the session
> cookie, but "login_cookie" is not anywhere.
> 
> My apache config for this folder is:
> 
> 
> <Directory "htdocs/python/test">
> 	AddHandler mod_python .py
> 	PythonHandler mod_python.publisher
> 	PythonDebug On
> </Directory>
> 
> Do you know If I'm missing anything obvious that prevents the cookie
> retrieval to work?
> 
> Thanks!,
> -- 
> 
> V?ctor Gil Sep?lveda
> E. Informatica - FIB - UPC
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python


From martijn at xs4us.nu  Thu Mar  4 11:55:35 2010
From: martijn at xs4us.nu (Martijn Moeling)
Date: Thu Mar  4 11:55:49 2010
Subject: [mod_python] Session management implementation in mod_python
In-Reply-To: <5313e190396855a70aeddc53591d6090.squirrel@mail.tce.edu>
References: <75a24068c943dc6aaf462d56ddc923f3.squirrel@mail.tce.edu>
	<5693EE1C-78F8-4B56-972B-0D4207090911@xs4us.nu>
	<5313e190396855a70aeddc53591d6090.squirrel@mail.tce.edu>
Message-ID: <B2059C96-D231-4D60-8660-7528F43D6178@xs4us.nu>

I remembered there was an issue on this, which is fixed in MP 3.3.1
If you have an older version look at the patch in http://issues.apache.org/jira/browse/MODPYTHON-149

also have a look at the mod_python docs for python option mod_python.session.application_domain

I think that will help you out

Martijn

On Mar 4, 2010, at 5:27 PM, K.Manikandan wrote:

> 
>> Can you tell me what the domains are, this is important to help you
>> 
>> I think you mean:
>> 
>> host1.domain.com
>> host2.domain.com
>> 
>> and you want to set the cookie for *.domain.com
>> 
>> is that true?
>> 
>> Martijn
>> 
> 
> Yes. We had set a cookie from host1.domain.com with its domain as
> '.domain.com' .. After opening the 'host1/domain.com, the web browser
> shows its cookie and its domain as '.domain.com/ .Now if we try to use
> 
> c = Cookie.get_cookies(req) from the host2.domain.com, the cookie is not
> found. And of course the cookie that we had set for this host is
> accessible...
> 
> Regards,
> Manikandan K
> 
> 
> -----------------------------------------
> This email was sent using TCEMail Service.
> Thiagarajar College of Engineering
> Madurai-625 015, India
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python


From graham.dumpleton at gmail.com  Thu Mar  4 23:49:34 2010
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Mar  4 23:49:41 2010
Subject: [mod_python] The link in the mailing list home that points to the
	'archives' is invalid
In-Reply-To: <4B8FBC50.1050403@gmail.com>
References: <4B8FBC50.1050403@gmail.com>
Message-ID: <88e286471003042049m5d5bc424scc03a9a3512876d5@mail.gmail.com>

On 5 March 2010 00:57, L.Guruprasad <lgp171188@gmail.com> wrote:
> Hi all,
> The link in the mailing list home page points to
> 'http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python'
> instead of the correct 'http://modpython.org/pipermail/mod_python'. Can
> the list admin look into this and get it corrected?

It has been like that for a long time and for an even longer time the
attachment links in archived emails have been broken. I have cc'd
Grisha on this to see if he is listening, given he answered a recent
email, and maybe we can finally get it fixed even though have asked if
Grisha can fix it before.

Graham
From manikandank at tce.edu  Fri Mar  5 04:19:10 2010
From: manikandank at tce.edu (K.Manikandan)
Date: Fri Mar  5 04:19:51 2010
Subject: [mod_python] Session management implementation in mod_python
In-Reply-To: <B2059C96-D231-4D60-8660-7528F43D6178@xs4us.nu>
References: <75a24068c943dc6aaf462d56ddc923f3.squirrel@mail.tce.edu>
	<5693EE1C-78F8-4B56-972B-0D4207090911@xs4us.nu>
	<5313e190396855a70aeddc53591d6090.squirrel@mail.tce.edu>
	<B2059C96-D231-4D60-8660-7528F43D6178@xs4us.nu>
Message-ID: <e2ef67b2f798a699aa6c63e93a067d68.squirrel@mail.tcenet>


> I remembered there was an issue on this, which is fixed in MP 3.3.1
> If you have an older version look at the patch in
> http://issues.apache.org/jira/browse/MODPYTHON-149
>
> also have a look at the mod_python docs for python option
> mod_python.session.application_domain
>
> I think that will help you out
>
> Martijn
>

We are using mod-python 3.3.1 in debian lenny. We are aiming to get the
cookie that is set from webapp1 running in a system from another webapp2
in the same system. We create a cookie from webapp1, the browser shows it
with the domain as '.domain.com' (we had set it like that). Now when we
try to access the cookie from webapp2, it is not accessible. When i create
a cookie from webapp2, then this creates another cookie for the same
domain '.domain.com'. But the cookie of one webapp is not accessible from
the other.

Regards,
Manikandan K


-----------------------------------------
This email was sent using TCEMail Service.
Thiagarajar College of Engineering
Madurai-625 015, India

From martijn at xs4us.nu  Fri Mar  5 04:22:33 2010
From: martijn at xs4us.nu (Martijn Moeling)
Date: Fri Mar  5 04:22:51 2010
Subject: [mod_python] Session management implementation in mod_python
In-Reply-To: <e2ef67b2f798a699aa6c63e93a067d68.squirrel@mail.tcenet>
References: <75a24068c943dc6aaf462d56ddc923f3.squirrel@mail.tce.edu>
	<5693EE1C-78F8-4B56-972B-0D4207090911@xs4us.nu>
	<5313e190396855a70aeddc53591d6090.squirrel@mail.tce.edu>
	<B2059C96-D231-4D60-8660-7528F43D6178@xs4us.nu>
	<e2ef67b2f798a699aa6c63e93a067d68.squirrel@mail.tcenet>
Message-ID: <626C7F60-6E85-4023-BD34-29A0BCF90E4C@xs4us.nu>

Did you set the Python Option mod_python.session.application_domain in the apache config?

Martijn

On Mar 5, 2010, at 10:19 AM, K.Manikandan wrote:

> 
>> I remembered there was an issue on this, which is fixed in MP 3.3.1
>> If you have an older version look at the patch in
>> http://issues.apache.org/jira/browse/MODPYTHON-149
>> 
>> also have a look at the mod_python docs for python option
>> mod_python.session.application_domain
>> 
>> I think that will help you out
>> 
>> Martijn
>> 
> 
> We are using mod-python 3.3.1 in debian lenny. We are aiming to get the
> cookie that is set from webapp1 running in a system from another webapp2
> in the same system. We create a cookie from webapp1, the browser shows it
> with the domain as '.domain.com' (we had set it like that). Now when we
> try to access the cookie from webapp2, it is not accessible. When i create
> a cookie from webapp2, then this creates another cookie for the same
> domain '.domain.com'. But the cookie of one webapp is not accessible from
> the other.
> 
> Regards,
> Manikandan K
> 
> 
> -----------------------------------------
> This email was sent using TCEMail Service.
> Thiagarajar College of Engineering
> Madurai-625 015, India
> 


From manikandank at tce.edu  Fri Mar  5 04:45:35 2010
From: manikandank at tce.edu (K.Manikandan)
Date: Fri Mar  5 04:46:10 2010
Subject: [mod_python] Session management implementation in mod_python
In-Reply-To: <626C7F60-6E85-4023-BD34-29A0BCF90E4C@xs4us.nu>
References: <75a24068c943dc6aaf462d56ddc923f3.squirrel@mail.tce.edu>
	<5693EE1C-78F8-4B56-972B-0D4207090911@xs4us.nu>
	<5313e190396855a70aeddc53591d6090.squirrel@mail.tce.edu>
	<B2059C96-D231-4D60-8660-7528F43D6178@xs4us.nu>
	<e2ef67b2f798a699aa6c63e93a067d68.squirrel@mail.tcenet>
	<626C7F60-6E85-4023-BD34-29A0BCF90E4C@xs4us.nu>
Message-ID: <7821a722fd2fc5779ffd3d424c1f37b7.squirrel@mail.tcenet>


> Did you set the Python Option mod_python.session.application_domain in the
> apache config?
>
> Martijn
>

I have not used mod-python's session management.We have written some
webservices for the session management. In those webservices, we have
borrowed most of the functionalities from mod_python's Session.py.
Is the setting of mod_python.session.application_domain still relevant?

Regards,
Manikandan K



-----------------------------------------
This email was sent using TCEMail Service.
Thiagarajar College of Engineering
Madurai-625 015, India

From chris at vindaloo.com  Sat Mar  6 16:20:21 2010
From: chris at vindaloo.com (Christopher Sean Hilton)
Date: Sat Mar  6 16:20:29 2010
Subject: [mod_python] ModPython + Virtual Hosting Apache2 instance = poor
	performance.
Message-ID: <35B3B94C-F8B4-47B8-BF5A-5A5CF54625B1@vindaloo.com>

I'm getting slowdowns from my apache 2.0.63 + mod_python 3.3.1 server. This server is built on FreeBSD 7.2 using stock components from the FreeBSD ports collection. The webserver is doing multiple virtual hosts with a mixture of static and dynamic content. The dynamic pages are currently a php5. I intended to add mod_python to the mix so I could put together some sites with Django but I noticed a slowdown on the webserver immediately after adding mod_python as an apache DSO and adding:

     LoadModule libexec/apache2/mod_python.so

to my httpd.conf file. This slowdown condition occurs for all content. It's especially apparent on a small collection of photos that I'm serving completely statically. Commenting out the LoadModule line for mod_python.so restores my performance to normal. 

I plan to continue investigating this but I have to say that it has me baffled. Has anyone got any ideas?

-- Chris

----------------------------------------------------------------------------
                                       "There will be an answer, Let it be."
                                                          chris@vindaloo.com




From chris at vindaloo.com  Sat Mar  6 16:25:26 2010
From: chris at vindaloo.com (Christopher Sean Hilton)
Date: Sat Mar  6 16:25:35 2010
Subject: [mod_python] Re: ModPython + Virtual Hosting Apache2 instance =
	poor performance.
In-Reply-To: <35B3B94C-F8B4-47B8-BF5A-5A5CF54625B1@vindaloo.com>
References: <35B3B94C-F8B4-47B8-BF5A-5A5CF54625B1@vindaloo.com>
Message-ID: <E7DC2322-EA7D-4975-83CB-727228A3615B@vindaloo.com>


On Mar 6, 2010, at 4:20 PM, Christopher Sean Hilton wrote:

> I'm getting slowdowns from my apache 2.0.63 + mod_python 3.3.1 server. This server is built on FreeBSD 7.2 using stock components from the FreeBSD ports collection. The webserver is doing multiple virtual hosts with a mixture of static and dynamic content. The dynamic pages are currently a php5. I intended to add mod_python to the mix so I could put together some sites with Django but I noticed a slowdown on the webserver immediately after adding mod_python as an apache DSO and adding:


[snip]

I should add that at the time I did this I also upgraded from python 2.5 to python 2.6.

-- Chris

Chris Hilton                       tildeChris -- http://myblog.vindaloo.com
                                        email -- chris/at/vindaloo/dot/com
.~~.--.~~.--.~~.--.~~.--.~~.--.~~.--.~~.--.~~.--.~~.--.~~.--.~~.--.~~.--.~~.
                         "I'm on the outside looking inside, What do I see?
                               Much confusion, disillution, all around me."
                                         -- Ian McDonald / Peter Sinfield


From martijn at xs4us.nu  Sat Mar  6 17:06:05 2010
From: martijn at xs4us.nu (Martijn Moeling)
Date: Sat Mar  6 17:05:30 2010
Subject: [mod_python] Re: ModPython + Virtual Hosting Apache2 instance
	=poor performance.
In-Reply-To: <E7DC2322-EA7D-4975-83CB-727228A3615B@vindaloo.com>
References: <35B3B94C-F8B4-47B8-BF5A-5A5CF54625B1@vindaloo.com>
	<E7DC2322-EA7D-4975-83CB-727228A3615B@vindaloo.com>
Message-ID: <CF13EEFE-FEE2-444B-A920-956FD3B1B557@xs4us.nu>

It migt have someting to do with some libraries being static in php  
and shared in mp, or the other way around search the net or this  
mailinglist on that.

Martijn

On 6 mrt 2010, at 22:35, "Christopher Sean Hilton"  
<chris@vindaloo.com> wrote:

>
> On Mar 6, 2010, at 4:20 PM, Christopher Sean Hilton wrote:
>
>> I'm getting slowdowns from my apache 2.0.63 + mod_python 3.3.1  
>> server. This server is built on FreeBSD 7.2 using stock components  
>> from the FreeBSD ports collection. The webserver is doing multiple  
>> virtual hosts with a mixture of static and dynamic content. The  
>> dynamic pages are currently a php5. I intended to add mod_python to  
>> the mix so I could put together some sites with Django but I  
>> noticed a slowdown on the webserver immediately after adding  
>> mod_python as an apache DSO and adding:
>
>
> [snip]
>
> I should add that at the time I did this I also upgraded from python  
> 2.5 to python 2.6.
>
> -- Chris
>
> Chris Hilton                       tildeChris -- http://myblog.vindaloo.com
>                                        email -- chris/at/vindaloo/ 
> dot/com
> .~~ 
> .-- 
> .~~.--.~~.--.~~.--.~~.--.~~.--.~~.--.~~.--.~~.--.~~.--.~~.--.~~.--.~~.
>                         "I'm on the outside looking inside, What do  
> I see?
>                               Much confusion, disillution, all  
> around me."
>                                         -- Ian McDonald / Peter  
> Sinfield
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
From graham.dumpleton at gmail.com  Sun Mar  7 04:28:32 2010
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sun Mar  7 04:28:39 2010
Subject: [mod_python] ModPython + Virtual Hosting Apache2 instance = poor 
	performance.
In-Reply-To: <35B3B94C-F8B4-47B8-BF5A-5A5CF54625B1@vindaloo.com>
References: <35B3B94C-F8B4-47B8-BF5A-5A5CF54625B1@vindaloo.com>
Message-ID: <88e286471003070128i7466c7a8x1981d2b45a1582b7@mail.gmail.com>

FWIW, run mod_python with prefork Apache and with a configuration set
up for PHP and static file hosting alone is a bad idea. Read:

  http://blog.dscpl.com.au/2009/03/load-spikes-and-excessive-memory-usage.html

Graham

On 7 March 2010 08:20, Christopher Sean Hilton <chris@vindaloo.com> wrote:
> I'm getting slowdowns from my apache 2.0.63 + mod_python 3.3.1 server. This server is built on FreeBSD 7.2 using stock components from the FreeBSD ports collection. The webserver is doing multiple virtual hosts with a mixture of static and dynamic content. The dynamic pages are currently a php5. I intended to add mod_python to the mix so I could put together some sites with Django but I noticed a slowdown on the webserver immediately after adding mod_python as an apache DSO and adding:
>
> ? ? LoadModule libexec/apache2/mod_python.so
>
> to my httpd.conf file. This slowdown condition occurs for all content. It's especially apparent on a small collection of photos that I'm serving completely statically. Commenting out the LoadModule line for mod_python.so restores my performance to normal.
>
> I plan to continue investigating this but I have to say that it has me baffled. Has anyone got any ideas?
>
> -- Chris
>
> ----------------------------------------------------------------------------
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? "There will be an answer, Let it be."
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?chris@vindaloo.com
>
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From graham.dumpleton at gmail.com  Sun Mar  7 18:06:41 2010
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sun Mar  7 18:06:47 2010
Subject: Isolated: Was: [mod_python] ModPython + Virtual Hosting Apache2 
	instance = poor performance.
In-Reply-To: <C2AE7956-2850-4233-B270-3C26D99E4D23@vindaloo.com>
References: <35B3B94C-F8B4-47B8-BF5A-5A5CF54625B1@vindaloo.com>
	<88e286471003070128i7466c7a8x1981d2b45a1582b7@mail.gmail.com>
	<C2AE7956-2850-4233-B270-3C26D99E4D23@vindaloo.com>
Message-ID: <88e286471003071506n421114dchf3fbb633b79e28f@mail.gmail.com>

On 8 March 2010 09:28, Christopher Sean Hilton <chris@vindaloo.com> wrote:
>
> On Mar 7, 2010, at 4:28 AM, Graham Dumpleton wrote:
>
>> FWIW, run mod_python with prefork Apache and with a configuration set
>> up for PHP and static file hosting alone is a bad idea. Read:
>>
>> ?http://blog.dscpl.com.au/2009/03/load-spikes-and-excessive-memory-usage.html
>>
>
> I found this and did understand it. The practical issue for me is configuring FreeBSD to run with the Worker MPM but I can figure that out. In the end the issue is the prefork MPM and I will switch to using mod_wsgi + Worker MPM. But I still needed a short term solution. As far as this problem goes the earlier poster correctly identified it as a threading issue. I was able to rectify the performance issue by rebuild python w/out threads and rebuilding mod_python on top of the new python.
>
> In the future, if you want FreeBSD + Apache + Mod_Python you would be well served to build Python without threads or use a different combination of tools to get the jog done.

You said you were using PHP, so you cant use worker MPM with Apache.
You can still use mod_wsgi with prefork MPM, just ensure you run WSGI
application in daemon mode of mod_wsgi to avoid issues discussed in
article. Do note though that you can't use mod_wsgi with a Python
installation which hasn't been compiled with thread support. You also
cannot use daemon mode with a APR library for Apache that doesn't have
thread support.

Rebuilding Python without threading should not cause such a dramatic
improvement especially considering I recollect you had only loaded
mod_python and not used it. I would suggest your rebuilding has seen
some other change. I also don't know what earlier post you are talking
about as there was no such post in this current thread on mod_python
list.

PS. I have cc'd this back on to the mod_python mailing list, please
keep the discussion there.

Graham

From chris at vindaloo.com  Sun Mar  7 21:42:44 2010
From: chris at vindaloo.com (Christopher Sean Hilton)
Date: Sun Mar  7 21:42:53 2010
Subject: Isolated: Was: [mod_python] ModPython + Virtual Hosting Apache2
	instance = poor performance.
In-Reply-To: <88e286471003071506n421114dchf3fbb633b79e28f@mail.gmail.com>
References: <35B3B94C-F8B4-47B8-BF5A-5A5CF54625B1@vindaloo.com>
	<88e286471003070128i7466c7a8x1981d2b45a1582b7@mail.gmail.com>
	<C2AE7956-2850-4233-B270-3C26D99E4D23@vindaloo.com>
	<88e286471003071506n421114dchf3fbb633b79e28f@mail.gmail.com>
Message-ID: <6C62ED43-E3F0-4B7B-B334-179EF107B700@vindaloo.com>


On Mar 7, 2010, at 6:06 PM, Graham Dumpleton wrote:

> 
> You said you were using PHP, so you cant use worker MPM with Apache.
> You can still use mod_wsgi with prefork MPM, just ensure you run WSGI
> application in daemon mode of mod_wsgi to avoid issues discussed in
> article. Do note though that you can't use mod_wsgi with a Python
> installation which hasn't been compiled with thread support. You also
> cannot use daemon mode with a APR library for Apache that doesn't have
> thread support.
> 

Thanks for the tip, That would have been a real huge problem. 

> Rebuilding Python without threading should not cause such a dramatic
> improvement especially considering I recollect you had only loaded
> mod_python and not used it. I would suggest your rebuilding has seen
> some other change. I also don't know what earlier post you are talking
> about as there was no such post in this current thread on mod_python
> list.
> 


I didn't make any quantitative measurements. Here's what I observed:

Browsing this page with the "broken" configuration took approximately 1min to load all of the thumbnails. In the "fixed" configuration it loads instantly. N.B. that I'm looking at this over 100Mbit LAN.
 
     http://fileshare.vindaloo.com/SoccerPhotos/page-0001.html

The thread Martin pointed to seemed to conjecture that the problem has to do with apache under FreeBSD being single threaded and thus depending on libc.so while a threaded python and thus a mod_python built to use it depends on libc_r.so. I believe the thread mentions a patch by you but it may be a different Graham.

     http://osdir.com/ml/apache.mod-python.devel/2008-10/msg00000.html

I confess that I didn't understand the whole thing. What I took from it is that I'm going to have problems using a non-threaded apache with a threaded mod_python. I tested this conjecture by building a fresh FreeBSD install with fresh installs of apache 2.0.63, python2.6 and mod_python. And I can make the problem appear and disappear by simply changing the configuration of the python 2.6 build from threaded to non-threaded. I feel that I may have the logic about the reason wrong. I think its a weird libc.so vs libc_r.so issue. But I'm confident that I've trapped the problem. 

To tell the truth it doesn't matter. My end goal is to run Django and nowadays Django want's mod_wsgi so I'm moving over there. What I'm learning talking to you is that as far as performance goes python want's a worker MPM apache which php cannot do. 

One of the things I did yesterday was download NetBSD 5.0.2 Sparc64 which I can use on my Netra T1 downstairs. Perhaps my solution is to just build a separate webserver for my python/Django needs?


--Chris

----------------------------------------------------------------------------
                                       "There will be an answer, Let it be."
                                                          chris@vindaloo.com




From chris at vindaloo.com  Sun Mar  7 17:28:44 2010
From: chris at vindaloo.com (Christopher Sean Hilton)
Date: Sun Mar  7 21:44:49 2010
Subject: Isolated: Was: [mod_python] ModPython + Virtual Hosting Apache2
	instance = poor performance.
In-Reply-To: <88e286471003070128i7466c7a8x1981d2b45a1582b7@mail.gmail.com>
References: <35B3B94C-F8B4-47B8-BF5A-5A5CF54625B1@vindaloo.com>
	<88e286471003070128i7466c7a8x1981d2b45a1582b7@mail.gmail.com>
Message-ID: <C2AE7956-2850-4233-B270-3C26D99E4D23@vindaloo.com>


On Mar 7, 2010, at 4:28 AM, Graham Dumpleton wrote:

> FWIW, run mod_python with prefork Apache and with a configuration set
> up for PHP and static file hosting alone is a bad idea. Read:
> 
>  http://blog.dscpl.com.au/2009/03/load-spikes-and-excessive-memory-usage.html
> 

I found this and did understand it. The practical issue for me is configuring FreeBSD to run with the Worker MPM but I can figure that out. In the end the issue is the prefork MPM and I will switch to using mod_wsgi + Worker MPM. But I still needed a short term solution. As far as this problem goes the earlier poster correctly identified it as a threading issue. I was able to rectify the performance issue by rebuild python w/out threads and rebuilding mod_python on top of the new python.

In the future, if you want FreeBSD + Apache + Mod_Python you would be well served to build Python without threads or use a different combination of tools to get the jog done.

-- Chris

Chris Hilton                                   e: chris|at|vindaloo|dot|com
----------------------------------------------------------------------------
                  "The pattern juggler lifts his hand; The orchestra begin.
      As slowly turns the grinding wheel in the court of the crimson king."
                                           -- Ian McDonald / Peter Sinfield




From graham.dumpleton at gmail.com  Sun Mar  7 21:59:16 2010
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sun Mar  7 21:59:24 2010
Subject: Isolated: Was: [mod_python] ModPython + Virtual Hosting Apache2 
	instance = poor performance.
In-Reply-To: <6C62ED43-E3F0-4B7B-B334-179EF107B700@vindaloo.com>
References: <35B3B94C-F8B4-47B8-BF5A-5A5CF54625B1@vindaloo.com>
	<88e286471003070128i7466c7a8x1981d2b45a1582b7@mail.gmail.com>
	<C2AE7956-2850-4233-B270-3C26D99E4D23@vindaloo.com>
	<88e286471003071506n421114dchf3fbb633b79e28f@mail.gmail.com>
	<6C62ED43-E3F0-4B7B-B334-179EF107B700@vindaloo.com>
Message-ID: <88e286471003071859s59edebf9pa8dcf1906809222c@mail.gmail.com>

On 8 March 2010 13:42, Christopher Sean Hilton <chris@vindaloo.com> wrote:
>
> On Mar 7, 2010, at 6:06 PM, Graham Dumpleton wrote:
>
>>
>> You said you were using PHP, so you cant use worker MPM with Apache.
>> You can still use mod_wsgi with prefork MPM, just ensure you run WSGI
>> application in daemon mode of mod_wsgi to avoid issues discussed in
>> article. Do note though that you can't use mod_wsgi with a Python
>> installation which hasn't been compiled with thread support. You also
>> cannot use daemon mode with a APR library for Apache that doesn't have
>> thread support.
>>
>
> Thanks for the tip, That would have been a real huge problem.
>
>> Rebuilding Python without threading should not cause such a dramatic
>> improvement especially considering I recollect you had only loaded
>> mod_python and not used it. I would suggest your rebuilding has seen
>> some other change. I also don't know what earlier post you are talking
>> about as there was no such post in this current thread on mod_python
>> list.
>>
>
>
> I didn't make any quantitative measurements. Here's what I observed:
>
> Browsing this page with the "broken" configuration took approximately 1min to load all of the thumbnails. In the "fixed" configuration it loads instantly. N.B. that I'm looking at this over 100Mbit LAN.
>
> ? ? http://fileshare.vindaloo.com/SoccerPhotos/page-0001.html
>
> The thread Martin pointed to seemed to conjecture that the problem has to do with apache under FreeBSD being single threaded and thus depending on libc.so while a threaded python and thus a mod_python built to use it depends on libc_r.so. I believe the thread mentions a patch by you but it may be a different Graham.
>
> ? ? http://osdir.com/ml/apache.mod-python.devel/2008-10/msg00000.html
>
> I confess that I didn't understand the whole thing. What I took from it is that I'm going to have problems using a non-threaded apache with a threaded mod_python. I tested this conjecture by building a fresh FreeBSD install with fresh installs of apache 2.0.63, python2.6 and mod_python. And I can make the problem appear and disappear by simply changing the configuration of the python 2.6 build from threaded to non-threaded. I feel that I may have the logic about the reason wrong. I think its a weird libc.so vs libc_r.so issue. But I'm confident that I've trapped the problem.

Don't know then. Not what I would have expected unless there is a
conflict in PHP or elsewhere in Apache with forcing use of rentrant C
library.

> To tell the truth it doesn't matter. My end goal is to run Django and nowadays Django want's mod_wsgi so I'm moving over there. What I'm learning talking to you is that as far as performance goes python want's a worker MPM apache which php cannot do.

No, neither mod_wsgi or Python require Apache worker MPM. You can
still use mod_wsgi with Apache prefork MPM, thus allowing you to still
use PHP, but you would want to ensure you configure mod_wsgi such that
it creates a separate daemon process group to run your Django instance
in, similar to how FASTCGI works. This separate daemon process group
can be multithreaded, regarded of fact that single threaded Apache
prefork MPM is used, and so can have a single Python process, keeping
memory footprint down. It is because the mod_wsgi daemon process
supports threading that Python and APR have to also support threading,
even if you aren't using threading in main Apache server processes
managed under prefork MPM.

Perhaps have a read of:

  http://code.google.com/p/modwsgi/wiki/ProcessesAndThreading

Graham

From chris at vindaloo.com  Mon Mar  8 12:58:49 2010
From: chris at vindaloo.com (Christopher Sean Hilton)
Date: Mon Mar  8 12:58:56 2010
Subject: Solved: [mod_python] ModPython + Virtual Hosting Apache2 instance =
	poor performance.
In-Reply-To: <88e286471003071859s59edebf9pa8dcf1906809222c@mail.gmail.com>
References: <35B3B94C-F8B4-47B8-BF5A-5A5CF54625B1@vindaloo.com>
	<88e286471003070128i7466c7a8x1981d2b45a1582b7@mail.gmail.com>
	<C2AE7956-2850-4233-B270-3C26D99E4D23@vindaloo.com>
	<88e286471003071506n421114dchf3fbb633b79e28f@mail.gmail.com>
	<6C62ED43-E3F0-4B7B-B334-179EF107B700@vindaloo.com>
	<88e286471003071859s59edebf9pa8dcf1906809222c@mail.gmail.com>
Message-ID: <DC09D1ED-01EC-4418-B00E-10DB2CC47FE5@vindaloo.com>

To call it solved would mean that I actually know what going on. This is more of a work around. Here's what I found:

Apache 2.0.63 + mod_python 3.3.1 + python 2.x (threaded) 

   yields poor performance under freebsd for static content and dynamic content using php5.

Changing from threaded python to non-threaded python fixes the performance issues.

Django requires threaded python.

Apache 2.2.21 + the threaded APR from devel/apr + mod_python 3.3.1 + python 2.6 with threads works!

There isn't much difference configuring Apache 2.2 compared to Apache 2.0 but the mod_python port isn't as helpful. It doesn't put the line:

     LoadModule python_module libexec/apache22/mod_python.so

Into the configuration.

Given that it should also include:

     <IfModule python_module>
     PythonOptimize Off
     PythonDebug Off
     </IfModule>

lines in also, that's okay.

Here's the output from Apache:

tatooine apache22 # httpd -V
httpd -V
Server version: Apache/2.2.14 (FreeBSD)
Server built:   Mar  8 2010 12:21:44
Server's Module Magic Number: 20051115:23
Server loaded:  APR 1.3.9, APR-Util 1.3.9
Compiled using: APR 1.3.9, APR-Util 1.3.9
Architecture:   32-bit
Server MPM:     Prefork
  threaded:     no
    forked:     yes (variable process count)
Server compiled with....
 -D APACHE_MPM_DIR="server/mpm/prefork"
 -D APR_HAS_SENDFILE
 -D APR_HAS_MMAP
 -D APR_HAVE_IPV6 (IPv4-mapped addresses enabled)
 -D APR_USE_FLOCK_SERIALIZE
 -D APR_USE_PTHREAD_SERIALIZE
 -D SINGLE_LISTEN_UNSERIALIZED_ACCEPT
 -D APR_HAS_OTHER_CHILD
 -D AP_HAVE_RELIABLE_PIPED_LOGS
 -D DYNAMIC_MODULE_LIMIT=128
 -D HTTPD_ROOT="/usr/local"
 -D SUEXEC_BIN="/usr/local/bin/suexec"
 -D DEFAULT_PIDLOG="/var/run/httpd.pid"
 -D DEFAULT_SCOREBOARD="/var/run/apache_runtime_status"
 -D DEFAULT_LOCKFILE="/var/run/accept.lock"
 -D DEFAULT_ERRORLOG="/var/log/httpd-error.log"
 -D AP_TYPES_CONFIG_FILE="etc/apache22/mime.types"
 -D SERVER_CONFIG_FILE="etc/apache22/httpd.conf"

-- Chris


----------------------------------------------------------------------------
                                       "There will be an answer, Let it be."
                                                          chris@vindaloo.com




From Wayne.Collier at noaa.gov  Mon Mar  8 13:54:16 2010
From: Wayne.Collier at noaa.gov (wayne collier)
Date: Mon Mar  8 13:54:23 2010
Subject: [mod_python] Upgrading expat for apache question
Message-ID: <4B9547D8.5020802@noaa.gov>

Hello all. I need some help solving the dreaded segmentation fault that 
has cropped several time on this board. I have read the link 
http://www.dscpl.com.au/wiki/ModPython/Articles/ExpatCausingApacheCrash 
<http://www.dscpl.com.au/wiki/ModPython/Articles/ExpatCausingApacheCrash>and 
followed the step and have uncovered the following.


 > ldd    /usr/local/httpd-2.2.11/bin/httpd | grep expat
    libexpat.so.0 => /lib/libexpat.so.0 (0x00d70000)

 > strings /lib/libexpat.so.0  | grep expat_
expat_1.95.8

 >  ps aux | grep http | head -3
webuser  14986  0.0  2.1  54236 19048 ?        S    Mar04   0:01 
/usr/local/httpd-2.2.11/bin/httpd -d /usr/local/httpd-2.2.11 -f 
/usr/local/httpd-2.2.11/conf/httpd.conf
webuser  14987  0.0  3.2 144128 29540 ?        S    Mar04   0:01 
/usr/local/httpd-2.2.11/bin/httpd -d /usr/local/httpd-2.2.11 -f 
/usr/local/httpd-2.2.11/conf/httpd.conf
webuser  14998  0.0  3.2 144212 29660 ?        S    Mar04   0:01 
/usr/local/httpd-2.2.11/bin/httpd -d /usr/local/httpd-2.2.11 -f 
/usr/local/httpd-2.2.11/conf/httpd.conf

 >  /usr/sbin/lsof -p 14986 | grep expat

httpd   14986 webuser  mem    REG     3,5   572313  972637 
/opt/Python/lib/python2.6/lib-dynload/pyexpat.so
httpd   14986 webuser  mem    REG     3,5   133120 1883791 
/lib/libexpat.so.0.5.0

*I am not sure why I get 2 shared libaries here.*

 >  strings  /lib/libexpat.so.0.5.0 | grep expat_
expat_1.95.8


 > strings /opt/Python/lib/python2.6/lib-dynload/pyexpat.so | grep expat_
pyexpat.expat_CAPI 1.0
expat_CAPI
expat_2.0.0


 >>> import pyexpat
 >>> pyexpat.version_info
(2, 0, 0)


So it seems like I need get expat_1.95.8 apache is using up to 
expat_2.0.0. Can I simply try replacing the 1.95.8 library with 2.0.0. 
Or do I have recompile with Apache? If I do recompile I need to 
recompile apache with mod_python as well?



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20100308/a19b09a9/attachment.html
From graham.dumpleton at gmail.com  Mon Mar  8 17:46:06 2010
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Mar  8 17:46:13 2010
Subject: [mod_python] Re: Upgrading expat for apache question
In-Reply-To: <4B9547D8.5020802@noaa.gov>
References: <4B9547D8.5020802@noaa.gov>
Message-ID: <88e286471003081446r5ba3da58tc5183beabadba30f@mail.gmail.com>

That is not your problem, quoting:

http://code.google.com/p/modwsgi/wiki/IssuesWithExpatLibrary

which is more up to date in respect of this issue, even if the
mod_wsgi variant of that document:

"""Note that this only applies to Python versions prior to Python 2.5.
>From Python 2.5 onwards, the copy of the "expat" library bundled in
with Python is name space prefixed, thereby avoid name clashes with an
"expat" library which has previously been loaded."""

You are using Python 2.6, so you cannot be affected by this problem.

Graham

On 9 March 2010 05:54, wayne collier <Wayne.Collier@noaa.gov> wrote:
> Hello all. I need some help solving the dreaded segmentation fault that has
> cropped several time on this board. I have read the link
> http://www.dscpl.com.au/wiki/ModPython/Articles/ExpatCausingApacheCrash and
> followed the step and have uncovered the following.
>
>
>> ldd??? /usr/local/httpd-2.2.11/bin/httpd | grep expat
> ??? libexpat.so.0 => /lib/libexpat.so.0 (0x00d70000)
>
>> strings /lib/libexpat.so.0? | grep expat_
> expat_1.95.8
>
>>? ps aux | grep http | head -3
> webuser? 14986? 0.0? 2.1? 54236 19048 ???????? S??? Mar04?? 0:01
> /usr/local/httpd-2.2.11/bin/httpd -d /usr/local/httpd-2.2.11 -f
> /usr/local/httpd-2.2.11/conf/httpd.conf
> webuser? 14987? 0.0? 3.2 144128 29540 ???????? S??? Mar04?? 0:01
> /usr/local/httpd-2.2.11/bin/httpd -d /usr/local/httpd-2.2.11 -f
> /usr/local/httpd-2.2.11/conf/httpd.conf
> webuser? 14998? 0.0? 3.2 144212 29660 ???????? S??? Mar04?? 0:01
> /usr/local/httpd-2.2.11/bin/httpd -d /usr/local/httpd-2.2.11 -f
> /usr/local/httpd-2.2.11/conf/httpd.conf
>
>>? /usr/sbin/lsof -p 14986 | grep expat
>
> httpd?? 14986 webuser? mem??? REG???? 3,5?? 572313? 972637
> /opt/Python/lib/python2.6/lib-dynload/pyexpat.so
> httpd?? 14986 webuser? mem??? REG???? 3,5?? 133120 1883791
> /lib/libexpat.so.0.5.0
>
> I am not sure why I get 2 shared libaries here.
>
>>? strings? /lib/libexpat.so.0.5.0 | grep expat_
> expat_1.95.8
>
>
>> strings /opt/Python/lib/python2.6/lib-dynload/pyexpat.so | grep expat_
> pyexpat.expat_CAPI 1.0
> expat_CAPI
> expat_2.0.0
>
>
>>>> import pyexpat
>>>> pyexpat.version_info
> (2, 0, 0)
>
>
> So it seems like I need get expat_1.95.8 apache is using up to expat_2.0.0.
> Can I simply try replacing the 1.95.8 library with 2.0.0. Or do I have
> recompile with Apache? If I do recompile I need to recompile apache with
> mod_python as well?
>
>
>
>

From graham.dumpleton at gmail.com  Mon Mar  8 17:50:31 2010
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Mar  8 17:50:36 2010
Subject: Solved: [mod_python] ModPython + Virtual Hosting Apache2 instance
	= poor performance.
In-Reply-To: <DC09D1ED-01EC-4418-B00E-10DB2CC47FE5@vindaloo.com>
References: <35B3B94C-F8B4-47B8-BF5A-5A5CF54625B1@vindaloo.com>
	<88e286471003070128i7466c7a8x1981d2b45a1582b7@mail.gmail.com>
	<C2AE7956-2850-4233-B270-3C26D99E4D23@vindaloo.com>
	<88e286471003071506n421114dchf3fbb633b79e28f@mail.gmail.com>
	<6C62ED43-E3F0-4B7B-B334-179EF107B700@vindaloo.com>
	<88e286471003071859s59edebf9pa8dcf1906809222c@mail.gmail.com>
	<DC09D1ED-01EC-4418-B00E-10DB2CC47FE5@vindaloo.com>
Message-ID: <88e286471003081450j43735d8am94e0026de61984be@mail.gmail.com>

On 9 March 2010 04:58, Christopher Sean Hilton <chris@vindaloo.com> wrote:
> To call it solved would mean that I actually know what going on. This is more of a work around. Here's what I found:
>
> Apache 2.0.63 + mod_python 3.3.1 + python 2.x (threaded)
>
> ? yields poor performance under freebsd for static content and dynamic content using php5.
>
> Changing from threaded python to non-threaded python fixes the performance issues.
>
> Django requires threaded python.

It should perhaps be qualified that Django doesn't require threads to
work and the conservative would run it in single threaded prefork MPM.
Whether it expects the threading module to still be importable is a
different matter though.

> Apache 2.2.21 + the threaded APR from devel/apr + mod_python 3.3.1 + python 2.6 with threads works!
>
> There isn't much difference configuring Apache 2.2 compared to Apache 2.0 but the mod_python port isn't as helpful. It doesn't put the line:
>
> ? ? LoadModule python_module libexec/apache22/mod_python.so
>
> Into the configuration.
>
> Given that it should also include:
>
> ? ? <IfModule python_module>
> ? ? PythonOptimize Off

That is not a valid option to PythonOptimize and with that value
results would be unpredictable. It is off by default anyway.

> ? ? PythonDebug Off

This is also off by default.

> ? ? </IfModule>

In other words, you didn't need either of those definitions.

Graham

> lines in also, that's okay.
>
> Here's the output from Apache:
>
> tatooine apache22 # httpd -V
> httpd -V
> Server version: Apache/2.2.14 (FreeBSD)
> Server built: ? Mar ?8 2010 12:21:44
> Server's Module Magic Number: 20051115:23
> Server loaded: ?APR 1.3.9, APR-Util 1.3.9
> Compiled using: APR 1.3.9, APR-Util 1.3.9
> Architecture: ? 32-bit
> Server MPM: ? ? Prefork
> ?threaded: ? ? no
> ? ?forked: ? ? yes (variable process count)
> Server compiled with....
> ?-D APACHE_MPM_DIR="server/mpm/prefork"
> ?-D APR_HAS_SENDFILE
> ?-D APR_HAS_MMAP
> ?-D APR_HAVE_IPV6 (IPv4-mapped addresses enabled)
> ?-D APR_USE_FLOCK_SERIALIZE
> ?-D APR_USE_PTHREAD_SERIALIZE
> ?-D SINGLE_LISTEN_UNSERIALIZED_ACCEPT
> ?-D APR_HAS_OTHER_CHILD
> ?-D AP_HAVE_RELIABLE_PIPED_LOGS
> ?-D DYNAMIC_MODULE_LIMIT=128
> ?-D HTTPD_ROOT="/usr/local"
> ?-D SUEXEC_BIN="/usr/local/bin/suexec"
> ?-D DEFAULT_PIDLOG="/var/run/httpd.pid"
> ?-D DEFAULT_SCOREBOARD="/var/run/apache_runtime_status"
> ?-D DEFAULT_LOCKFILE="/var/run/accept.lock"
> ?-D DEFAULT_ERRORLOG="/var/log/httpd-error.log"
> ?-D AP_TYPES_CONFIG_FILE="etc/apache22/mime.types"
> ?-D SERVER_CONFIG_FILE="etc/apache22/httpd.conf"
>
> -- Chris
>
>
> ----------------------------------------------------------------------------
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? "There will be an answer, Let it be."
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?chris@vindaloo.com
>
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From martijn at xs4us.nu  Tue Mar  9 04:40:09 2010
From: martijn at xs4us.nu (Martijn Moeling)
Date: Tue Mar  9 04:40:25 2010
Subject: [mod_python] Session management implementation in mod_python
In-Reply-To: <88190270ad17a137e71d84884ff1cbe5.squirrel@mail.tcenet>
References: <75a24068c943dc6aaf462d56ddc923f3.squirrel@mail.tce.edu>
	<5693EE1C-78F8-4B56-972B-0D4207090911@xs4us.nu>
	<5313e190396855a70aeddc53591d6090.squirrel@mail.tce.edu>
	<B2059C96-D231-4D60-8660-7528F43D6178@xs4us.nu>
	<e2ef67b2f798a699aa6c63e93a067d68.squirrel@mail.tcenet>
	<626C7F60-6E85-4023-BD34-29A0BCF90E4C@xs4us.nu>
	<7821a722fd2fc5779ffd3d424c1f37b7.squirrel@mail.tcenet>
	<BA52DD57-F2AA-41F1-93D3-317CB2DBA095@xs4us.nu>
	<dd2bdbf7fe5f3eec8a59161e91824ff9.squirrel@mail.tce.edu>
	<EB220387-1F74-419A-AD0C-95BAA3957647@xs4us.nu>
	<88190270ad17a137e71d84884ff1cbe5.squirrel@mail.tcenet>
Message-ID: <EFF609AE-30EE-4EE2-AF54-80A60AB8FC44@xs4us.nu>

Are the different webapps in different paths?
besides c.domain, you also need/can set c.path = "/" (or whatever path, "/" might do the trick)

since normally with the original Session.py is t's just adding PythonOption mod_python.session.application_path

You need to set it to the same path in every index.py

Martijn

On Mar 9, 2010, at 10:24 AM, K.Manikandan wrote:

>> 8<--------------
>> with Session code implementing following in make_cookie() method:
>> 
>>        if config.has_key("mod_python.Session.application_domain"):
>>            c.domain = config["mod_python.Session.application_domain"]
>> 8<--------------
>> 
>> So look up the part where you create the cookie and set
>> "YOUR_COOKIE_OBJECT.domain = ".domain.com"
>> Which is sort of the same as using the Python option in the code above.
>> 
>> That should do the trick!
>> 
>> Martijn
> 
> hi, sorry for that. here is my cookie snippet.
> 
> This is in the index.py of webapp1.
> 
> c = Cookie.Cookie('name','Manikandan')
> c.domain = '.cs.tcenet'
> Cookie.add_cookie(req,c)
> 
> Here, i set the cookie with domain as given. Now in index.py inside
> another web application in the same domain, I create another cookie for
> this new webapp.
> 
> c = Cookie.Cookie('Other','Guru')
> c.domain = '.cs.tcenet'
> Cookie.add_cookie(req,c)
> 
> In the new webapp i access the cookie as
> 
> c = Cookie.get_cookies(req)
> 
> I get only the {other:guru} cookie but not the {name:mani}. In the first
> webapp i get {name:mani} but not the {other:guru}.
> 
> Now I want to access the {name:mani} in the new webapp. Please suggest a
> way to do it...
> 
> Regards,
> Manikandan K
> 
> 
> 
> 
> 
> -----------------------------------------
> This email was sent using TCEMail Service.
> Thiagarajar College of Engineering
> Madurai-625 015, India
> 


From manikandank at tce.edu  Tue Mar  9 05:07:11 2010
From: manikandank at tce.edu (K.Manikandan)
Date: Tue Mar  9 05:07:29 2010
Subject: [mod_python] Session management implementation in mod_python
In-Reply-To: <EFF609AE-30EE-4EE2-AF54-80A60AB8FC44@xs4us.nu>
References: <75a24068c943dc6aaf462d56ddc923f3.squirrel@mail.tce.edu>
	<5693EE1C-78F8-4B56-972B-0D4207090911@xs4us.nu>
	<5313e190396855a70aeddc53591d6090.squirrel@mail.tce.edu>
	<B2059C96-D231-4D60-8660-7528F43D6178@xs4us.nu>
	<e2ef67b2f798a699aa6c63e93a067d68.squirrel@mail.tcenet>
	<626C7F60-6E85-4023-BD34-29A0BCF90E4C@xs4us.nu>
	<7821a722fd2fc5779ffd3d424c1f37b7.squirrel@mail.tcenet>
	<BA52DD57-F2AA-41F1-93D3-317CB2DBA095@xs4us.nu>
	<dd2bdbf7fe5f3eec8a59161e91824ff9.squirrel@mail.tce.edu>
	<EB220387-1F74-419A-AD0C-95BAA3957647@xs4us.nu>
	<88190270ad17a137e71d84884ff1cbe5.squirrel@mail.tcenet>
	<EFF609AE-30EE-4EE2-AF54-80A60AB8FC44@xs4us.nu>
Message-ID: <ae6762939fb49dd5e7262c2d2665b866.squirrel@mail.tcenet>


> Are the different webapps in different paths?
> besides c.domain, you also need/can set c.path = "/" (or whatever path,
> "/" might do the trick)
>
> since normally with the original Session.py is t's just adding
> PythonOption mod_python.session.application_path
>
> You need to set it to the same path in every index.py
>
> Martijn
>

Atlast, We got what we needed. I was able to get the cookie of one webapp
from the other. Thanks a lot.

Now, if we have two web applications in two different domains, then the
setting of cookie.domain will help right? We will try that.

We will get back if we have any other problems...

Regards,
Manikandan K


-----------------------------------------
This email was sent using TCEMail Service.
Thiagarajar College of Engineering
Madurai-625 015, India

From martijn at xs4us.nu  Tue Mar  9 05:22:42 2010
From: martijn at xs4us.nu (Martijn Moeling)
Date: Tue Mar  9 05:23:08 2010
Subject: [mod_python] Session management implementation in mod_python
In-Reply-To: <ae6762939fb49dd5e7262c2d2665b866.squirrel@mail.tcenet>
References: <75a24068c943dc6aaf462d56ddc923f3.squirrel@mail.tce.edu>
	<5693EE1C-78F8-4B56-972B-0D4207090911@xs4us.nu>
	<5313e190396855a70aeddc53591d6090.squirrel@mail.tce.edu>
	<B2059C96-D231-4D60-8660-7528F43D6178@xs4us.nu>
	<e2ef67b2f798a699aa6c63e93a067d68.squirrel@mail.tcenet>
	<626C7F60-6E85-4023-BD34-29A0BCF90E4C@xs4us.nu>
	<7821a722fd2fc5779ffd3d424c1f37b7.squirrel@mail.tcenet>
	<BA52DD57-F2AA-41F1-93D3-317CB2DBA095@xs4us.nu>
	<dd2bdbf7fe5f3eec8a59161e91824ff9.squirrel@mail.tce.edu>
	<EB220387-1F74-419A-AD0C-95BAA3957647@xs4us.nu>
	<88190270ad17a137e71d84884ff1cbe5.squirrel@mail.tcenet>
	<EFF609AE-30EE-4EE2-AF54-80A60AB8FC44@xs4us.nu>
	<ae6762939fb49dd5e7262c2d2665b866.squirrel@mail.tcenet>
Message-ID: <12BEC4EE-B1C9-4FEE-ACEB-014305BE9412@xs4us.nu>

Great to hear you got it working,

Remember to give as much info as you have so you can be helped out more quickly.

Indeed if you have multiple domains, you need to set the domain property of the cookie (do not set a cookie for .com .org etc since that will go out to a lot of websites!!!).

Both are important for the browser to know wether to the cookie has to be in the headers of the request.

say if you point your browser to www.yyy.com/test, the browser looks for cookies to fit.

a cookie with domain .yyy.com and path / will fit, a cookie with domain www.yyy.com and path /test will fit too

if you go to www2.yyy.com/  you will need a cookie with domain www2.yyy.com or .yyy.com and path set to "/"

the browser will look for a "path" above the current path or current path so "/" will fit /test too, /test will fit for /test, /test/test2 but not for /

Martijn



On Mar 9, 2010, at 11:07 AM, K.Manikandan wrote:

> 
>> Are the different webapps in different paths?
>> besides c.domain, you also need/can set c.path = "/" (or whatever path,
>> "/" might do the trick)
>> 
>> since normally with the original Session.py is t's just adding
>> PythonOption mod_python.session.application_path
>> 
>> You need to set it to the same path in every index.py
>> 
>> Martijn
>> 
> 
> Atlast, We got what we needed. I was able to get the cookie of one webapp
> from the other. Thanks a lot.
> 
> Now, if we have two web applications in two different domains, then the
> setting of cookie.domain will help right? We will try that.
> 
> We will get back if we have any other problems...
> 
> Regards,
> Manikandan K
> 
> 
> -----------------------------------------
> This email was sent using TCEMail Service.
> Thiagarajar College of Engineering
> Madurai-625 015, India
> 


From Wayne.Collier at noaa.gov  Tue Mar  9 12:18:48 2010
From: Wayne.Collier at noaa.gov (wayne collier)
Date: Tue Mar  9 12:18:53 2010
Subject: [mod_python] Re: Upgrading expat for apache question
In-Reply-To: <88e286471003081446r5ba3da58tc5183beabadba30f@mail.gmail.com>
References: <4B9547D8.5020802@noaa.gov>
	<88e286471003081446r5ba3da58tc5183beabadba30f@mail.gmail.com>
Message-ID: <4B9682F8.8040503@noaa.gov>

Okay I guess I will look else where. However, I keep getting 
segmentation faults when try an execute the ldap command

t=l.simple_bind_s(dn,pw). It is only line of code that crashes. If the have the classic expat problem, would that mean I would get a segmentation
fault problem from the start.  Also, ldap script works okay as a stand alone script. Thanks.

Wayne



Graham Dumpleton wrote:
> That is not your problem, quoting:
>
> http://code.google.com/p/modwsgi/wiki/IssuesWithExpatLibrary
>
> which is more up to date in respect of this issue, even if the
> mod_wsgi variant of that document:
>
> """Note that this only applies to Python versions prior to Python 2.5.
> >From Python 2.5 onwards, the copy of the "expat" library bundled in
> with Python is name space prefixed, thereby avoid name clashes with an
> "expat" library which has previously been loaded."""
>
> You are using Python 2.6, so you cannot be affected by this problem.
>
> Graham
>
> On 9 March 2010 05:54, wayne collier <Wayne.Collier@noaa.gov> wrote:
>   
>> Hello all. I need some help solving the dreaded segmentation fault that has
>> cropped several time on this board. I have read the link
>> http://www.dscpl.com.au/wiki/ModPython/Articles/ExpatCausingApacheCrash and
>> followed the step and have uncovered the following.
>>
>>
>>     
>>> ldd    /usr/local/httpd-2.2.11/bin/httpd | grep expat
>>>       
>>     libexpat.so.0 => /lib/libexpat.so.0 (0x00d70000)
>>
>>     
>>> strings /lib/libexpat.so.0  | grep expat_
>>>       
>> expat_1.95.8
>>
>>     
>>>   ps aux | grep http | head -3
>>>       
>> webuser  14986  0.0  2.1  54236 19048 ?        S    Mar04   0:01
>> /usr/local/httpd-2.2.11/bin/httpd -d /usr/local/httpd-2.2.11 -f
>> /usr/local/httpd-2.2.11/conf/httpd.conf
>> webuser  14987  0.0  3.2 144128 29540 ?        S    Mar04   0:01
>> /usr/local/httpd-2.2.11/bin/httpd -d /usr/local/httpd-2.2.11 -f
>> /usr/local/httpd-2.2.11/conf/httpd.conf
>> webuser  14998  0.0  3.2 144212 29660 ?        S    Mar04   0:01
>> /usr/local/httpd-2.2.11/bin/httpd -d /usr/local/httpd-2.2.11 -f
>> /usr/local/httpd-2.2.11/conf/httpd.conf
>>
>>     
>>>   /usr/sbin/lsof -p 14986 | grep expat
>>>       
>> httpd   14986 webuser  mem    REG     3,5   572313  972637
>> /opt/Python/lib/python2.6/lib-dynload/pyexpat.so
>> httpd   14986 webuser  mem    REG     3,5   133120 1883791
>> /lib/libexpat.so.0.5.0
>>
>> I am not sure why I get 2 shared libaries here.
>>
>>     
>>>   strings  /lib/libexpat.so.0.5.0 | grep expat_
>>>       
>> expat_1.95.8
>>
>>
>>     
>>> strings /opt/Python/lib/python2.6/lib-dynload/pyexpat.so | grep expat_
>>>       
>> pyexpat.expat_CAPI 1.0
>> expat_CAPI
>> expat_2.0.0
>>
>>
>>     
>>>>> import pyexpat
>>>>> pyexpat.version_info
>>>>>           
>> (2, 0, 0)
>>
>>
>> So it seems like I need get expat_1.95.8 apache is using up to expat_2.0.0.
>> Can I simply try replacing the 1.95.8 library with 2.0.0. Or do I have
>> recompile with Apache? If I do recompile I need to recompile apache with
>> mod_python as well?
>>
>>
>>
>>
>>     
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>   

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20100309/6e80c992/attachment.html
From graham.dumpleton at gmail.com  Tue Mar  9 17:16:16 2010
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Mar  9 17:16:20 2010
Subject: [mod_python] Re: Upgrading expat for apache question
In-Reply-To: <4B9682F8.8040503@noaa.gov>
References: <4B9547D8.5020802@noaa.gov>
	<88e286471003081446r5ba3da58tc5183beabadba30f@mail.gmail.com>
	<4B9682F8.8040503@noaa.gov>
Message-ID: <88e286471003091416w74f87d44w8f4e4d0d0aab4416@mail.gmail.com>

A segmentation fault can occur for other reasons. If it is happening
when you use LDAP, it could be a conflict in versions of LDAP
libraries being used by Apache or PHP and Python LDAP module.

You should use the 'ldd' command to determine what LDAP shared library
is used by mod_authnz_ldap and compare that to the LDAP library being
used by the C extension module component of the Python module you are
using to access LDAP. Similarly find any PHP extension modules which
use LDAP and look at those.

If mod_authnz_ldap is loaded into Apache and you don't need it, then
don't load it and see if problem goes away. Also try not loading PHP
if it is being loaded. Narrow down which is in conflict.

As far as I remember, Apache itself doesn't link to LDAP library and
even possible that mod_authnz_ldap uses an internal LDAP library
rather than linking external library. All the same even use ldd on
Apache binary itself to see which LDAP library may be linked.

Graham

On 10 March 2010 04:18, wayne collier <Wayne.Collier@noaa.gov> wrote:
> Okay I guess I will look else where. However, I keep getting segmentation
> faults when try an execute the ldap command
>
> t=l.simple_bind_s(dn,pw). It is only line of code that crashes. If the have
> the classic expat problem, would that mean I would get a segmentation
> fault problem from the start.  Also, ldap script works okay as a stand alone
> script. Thanks.
>
> Wayne
>
>
> Graham Dumpleton wrote:
>
> That is not your problem, quoting:
>
> http://code.google.com/p/modwsgi/wiki/IssuesWithExpatLibrary
>
> which is more up to date in respect of this issue, even if the
> mod_wsgi variant of that document:
>
> """Note that this only applies to Python versions prior to Python 2.5.
> >From Python 2.5 onwards, the copy of the "expat" library bundled in
> with Python is name space prefixed, thereby avoid name clashes with an
> "expat" library which has previously been loaded."""
>
> You are using Python 2.6, so you cannot be affected by this problem.
>
> Graham
>
> On 9 March 2010 05:54, wayne collier <Wayne.Collier@noaa.gov> wrote:
>
>
> Hello all. I need some help solving the dreaded segmentation fault that has
> cropped several time on this board. I have read the link
> http://www.dscpl.com.au/wiki/ModPython/Articles/ExpatCausingApacheCrash and
> followed the step and have uncovered the following.
>
>
>
>
> ldd??? /usr/local/httpd-2.2.11/bin/httpd | grep expat
>
>
> ??? libexpat.so.0 => /lib/libexpat.so.0 (0x00d70000)
>
>
>
> strings /lib/libexpat.so.0? | grep expat_
>
>
> expat_1.95.8
>
>
>
> ? ps aux | grep http | head -3
>
>
> webuser? 14986? 0.0? 2.1? 54236 19048 ???????? S??? Mar04?? 0:01
> /usr/local/httpd-2.2.11/bin/httpd -d /usr/local/httpd-2.2.11 -f
> /usr/local/httpd-2.2.11/conf/httpd.conf
> webuser? 14987? 0.0? 3.2 144128 29540 ???????? S??? Mar04?? 0:01
> /usr/local/httpd-2.2.11/bin/httpd -d /usr/local/httpd-2.2.11 -f
> /usr/local/httpd-2.2.11/conf/httpd.conf
> webuser? 14998? 0.0? 3.2 144212 29660 ???????? S??? Mar04?? 0:01
> /usr/local/httpd-2.2.11/bin/httpd -d /usr/local/httpd-2.2.11 -f
> /usr/local/httpd-2.2.11/conf/httpd.conf
>
>
>
> ? /usr/sbin/lsof -p 14986 | grep expat
>
>
> httpd?? 14986 webuser? mem??? REG???? 3,5?? 572313? 972637
> /opt/Python/lib/python2.6/lib-dynload/pyexpat.so
> httpd?? 14986 webuser? mem??? REG???? 3,5?? 133120 1883791
> /lib/libexpat.so.0.5.0
>
> I am not sure why I get 2 shared libaries here.
>
>
>
> ? strings? /lib/libexpat.so.0.5.0 | grep expat_
>
>
> expat_1.95.8
>
>
>
>
> strings /opt/Python/lib/python2.6/lib-dynload/pyexpat.so | grep expat_
>
>
> pyexpat.expat_CAPI 1.0
> expat_CAPI
> expat_2.0.0
>
>
>
>
> import pyexpat
> pyexpat.version_info
>
>
> (2, 0, 0)
>
>
> So it seems like I need get expat_1.95.8 apache is using up to expat_2.0.0.
> Can I simply try replacing the 1.95.8 library with 2.0.0. Or do I have
> recompile with Apache? If I do recompile I need to recompile apache with
> mod_python as well?
>
>
>
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
>

From Mark.Brown at greenskycredit.com  Thu Mar 11 17:09:05 2010
From: Mark.Brown at greenskycredit.com (Mark Brown)
Date: Thu Mar 11 17:09:12 2010
Subject: [mod_python] Paramiko connection to SFTP web-based client
Message-ID: <0B1220B1BC53C04384C8EACA4EEA24C2814EE259A6@GS-EXCH-01.greensky.local>

Sorry that I am really, really new to Python but I have run into a wall and need some help:

Basically, I am trying to create a web-client for a sftp server.

You enter your user name and password and you authenticate against the sftp server, see a list of all the files on the server, can browse the server, and if you click on a link download the file.

I have tried several different methods to keep the network-resource in the session, but nothing thus far has worked. My research seems to indicate that in order to achieve this I would need to write a daemon that handles the connection, and pass the session id to the daemon to match connection to web request.

I have found some articles on how to turn a python script into a daemon, but I need some help understanding what is really going.
Anyways, the script  I have tested thus far using mod_python is below:


from mod_python import apache
from mod_python import Session
import paramiko


def handler(req):
      session=Session.Session(req)
      req.content_type="text/html"

      try:
            session['hits'] +=1
            #dirlist=session['sftp'].listdir('.')
            req.write('From Session')
      except:
            t=paramiko.Transport(('[SERVER NAME],22))
            t.connect(username='[USER NAME]',password='[PASSWORD]')
            sftp=paramiko.SFTPClient.from_transport(t)
            dirlist = sftp.listdir('.')
            session['hits']=1
            session['sftp']=sftp
            req.write('New Session')

      session.save()
      req.write('Hits %d\n' % session['hits'])
      req.write(dirlist)

      return apache.OK


Mark Brown
Credit & Operations Manager
GreenSky
mark.brown@greenskycredit.com<mailto:esmith@greenskycredit.com>
Office: 404.832.4147
Fax: 404.832.4111


________________________________
This electronic message transmission contains information from GreenSky Trade Credit, LLC which may be confidential & privileged. Recipients should not file copies of this e-mail with publicly accessed records. The information is intended to be for the use of the individual(s) named above. If you are not the intended recipient, please be aware that any disclosure, copying, distribution or use of this message is prohibited. If you have received this electronic transmission in error, please notify us by e-mail immediately.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20100311/9da14353/attachment.html
From graham.dumpleton at gmail.com  Thu Mar 11 19:32:31 2010
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Mar 11 19:32:35 2010
Subject: [mod_python] Paramiko connection to SFTP web-based client
In-Reply-To: <0B1220B1BC53C04384C8EACA4EEA24C2814EE259A6@GS-EXCH-01.greensky.local>
References: <0B1220B1BC53C04384C8EACA4EEA24C2814EE259A6@GS-EXCH-01.greensky.local>
Message-ID: <88e286471003111632n539a7a9aue451c806337244c1@mail.gmail.com>

On 12 March 2010 09:09, Mark Brown <Mark.Brown@greenskycredit.com> wrote:
> Sorry that I am really, really new to Python but I have run into a wall and
> need some help:
>
> Basically, I am trying to create a web-client for a sftp server.
>
>
>
> You enter your user name and password and you authenticate against the sftp
> server, see a list of all the files on the server, can browse the server,
> and if you click on a link download the file.
>
> I have tried several different methods to keep the network-resource in the
> session, but nothing thus far has worked. My research seems to indicate that
> in order to achieve this I would need to write a daemon that handles the
> connection, and pass the session id to the daemon to match connection to web
> request.
>
>
>
> I have found some articles on how to turn a python script into a daemon, but
> I need some help understanding what is really going.
>
> Anyways, the script? I have tested thus far using mod_python is below:
>
>
>
> from mod_python import apache
> from mod_python import Session
> import paramiko
>
>
>
> def handler(req):
> ????? session=Session.Session(req)
> ????? req.content_type="text/html"
>
> ????? try:
> ??????????? session['hits'] +=1
> ??????????? #dirlist=session['sftp'].listdir('.')
> ??????????? req.write('From Session')
> ????? except:
> ??????????? t=paramiko.Transport(('[SERVER NAME],22))
> ??????????? t.connect(username='[USER NAME]',password='[PASSWORD]')
> ??????????? sftp=paramiko.SFTPClient.from_transport(t)
> ??????????? dirlist = sftp.listdir('.')
> ??????????? session['hits']=1
> ??????????? session['sftp']=sftp
> ??????????? req.write('New Session')
>
> ????? session.save()
> ????? req.write('Hits %d\n' % session['hits'])
> ????? req.write(dirlist)
>
> ????? return apache.OK

To ensure portability and overall guarantee it will always work, you
should only store in session basic Python data types. Even class
objects should be avoided even if they can be pickled. This is because
normally the session is stored in a database outside of the process.
Complex objects such as a socket handle obviously cant therefore be
stored.

The only time doing so would work is on Windows. That is because in
that case the session database is in memory and isn't actually written
to a separate database. You could only make it work on UNIX systems by
changing your Apache configuration such that it only ever used a
single server child process such that all requests handled by same
process and forcing the use of in memory session database. Forcing a
single process when using mod_python on UNIX sort of defeats the
problem of using Apache.

You could use this single process model by instead using mod_wsgi as
at least with that you could use its daemon mode and force your web
application to run in single dedicated process separate to the Apache
server child processes. You then though have to learn WSGI or use one
of the WSGI frameworks/toolkits. You still couldn't use traditional
session layers though and would need to maintain your own data
structure with active pool of connections in memory.

BTW, are you sure there aren't already web interfaces to SFTP clients?
Sure there would be one somewhere, albeit maybe implemented in a
different language.

Graham

From Mark.Brown at greenskycredit.com  Thu Mar 11 22:50:33 2010
From: Mark.Brown at greenskycredit.com (Mark Brown)
Date: Thu Mar 11 22:50:47 2010
Subject: [mod_python] Paramiko connection to SFTP web-based client
In-Reply-To: <88e286471003111632n539a7a9aue451c806337244c1@mail.gmail.com>
References: <0B1220B1BC53C04384C8EACA4EEA24C2814EE259A6@GS-EXCH-01.greensky.local>,
	<88e286471003111632n539a7a9aue451c806337244c1@mail.gmail.com>
Message-ID: <0B1220B1BC53C04384C8EACA4EEA24C2814EE98D08@GS-EXCH-01.greensky.local>

Yeah, I've looked everywhere for a sftp web client, and did find one written as a java applet. Unfortunately, I want pure html and not an embedded applet in a webpage.

Can you expand some more on what you mean by this:

"You then though have to learn WSGI or use one
of the WSGI frameworks/toolkits. You still couldn't use traditional
session layers though and would need to maintain your own data
structure with active pool of connections in memory."

Also, I have read some stuff about twisted and cherrypy. Would either of these help me out?

Sorry if I am being naive, I am by no means an expert in apache or python.



________________________________________
From: Graham Dumpleton [graham.dumpleton@gmail.com]
Sent: Thursday, March 11, 2010 7:32 PM
To: Mark Brown
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Paramiko connection to SFTP web-based client

On 12 March 2010 09:09, Mark Brown <Mark.Brown@greenskycredit.com> wrote:
> Sorry that I am really, really new to Python but I have run into a wall and
> need some help:
>
> Basically, I am trying to create a web-client for a sftp server.
>
>
>
> You enter your user name and password and you authenticate against the sftp
> server, see a list of all the files on the server, can browse the server,
> and if you click on a link download the file.
>
> I have tried several different methods to keep the network-resource in the
> session, but nothing thus far has worked. My research seems to indicate that
> in order to achieve this I would need to write a daemon that handles the
> connection, and pass the session id to the daemon to match connection to web
> request.
>
>
>
> I have found some articles on how to turn a python script into a daemon, but
> I need some help understanding what is really going.
>
> Anyways, the script  I have tested thus far using mod_python is below:
>
>
>
> from mod_python import apache
> from mod_python import Session
> import paramiko
>
>
>
> def handler(req):
>       session=Session.Session(req)
>       req.content_type="text/html"
>
>       try:
>             session['hits'] +=1
>             #dirlist=session['sftp'].listdir('.')
>             req.write('From Session')
>       except:
>             t=paramiko.Transport(('[SERVER NAME],22))
>             t.connect(username='[USER NAME]',password='[PASSWORD]')
>             sftp=paramiko.SFTPClient.from_transport(t)
>             dirlist = sftp.listdir('.')
>             session['hits']=1
>             session['sftp']=sftp
>             req.write('New Session')
>
>       session.save()
>       req.write('Hits %d\n' % session['hits'])
>       req.write(dirlist)
>
>       return apache.OK

To ensure portability and overall guarantee it will always work, you
should only store in session basic Python data types. Even class
objects should be avoided even if they can be pickled. This is because
normally the session is stored in a database outside of the process.
Complex objects such as a socket handle obviously cant therefore be
stored.

The only time doing so would work is on Windows. That is because in
that case the session database is in memory and isn't actually written
to a separate database. You could only make it work on UNIX systems by
changing your Apache configuration such that it only ever used a
single server child process such that all requests handled by same
process and forcing the use of in memory session database. Forcing a
single process when using mod_python on UNIX sort of defeats the
problem of using Apache.

You could use this single process model by instead using mod_wsgi as
at least with that you could use its daemon mode and force your web
application to run in single dedicated process separate to the Apache
server child processes. You then though have to learn WSGI or use one
of the WSGI frameworks/toolkits. You still couldn't use traditional
session layers though and would need to maintain your own data
structure with active pool of connections in memory.

BTW, are you sure there aren't already web interfaces to SFTP clients?
Sure there would be one somewhere, albeit maybe implemented in a
different language.

Graham

--
This message was scanned by ESVA and is believed to be clean.

This electronic message transmission contains information from GreenSky Trade Credit, LLC which may be confidential & privileged.  Recipients should not file copies of this e-mail with publicly accessed records.  The information is intended to be for the use of the individual(s) named above. If you are not the intended recipient, please be aware that any disclosure, copying, distribution or use of this message is prohibited. If you have received this electronic transmission in error, please notify us by e-mail immediately.

From graham.dumpleton at gmail.com  Thu Mar 11 23:31:40 2010
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Mar 11 23:31:43 2010
Subject: [mod_python] Paramiko connection to SFTP web-based client
In-Reply-To: <0B1220B1BC53C04384C8EACA4EEA24C2814EE98D08@GS-EXCH-01.greensky.local>
References: <0B1220B1BC53C04384C8EACA4EEA24C2814EE259A6@GS-EXCH-01.greensky.local>
	<88e286471003111632n539a7a9aue451c806337244c1@mail.gmail.com>
	<0B1220B1BC53C04384C8EACA4EEA24C2814EE98D08@GS-EXCH-01.greensky.local>
Message-ID: <88e286471003112031u653e3004o5d66fd2ee82196e6@mail.gmail.com>

On 12 March 2010 14:50, Mark Brown <Mark.Brown@greenskycredit.com> wrote:
> Yeah, I've looked everywhere for a sftp web client, and did find one written as a java applet. Unfortunately, I want pure html and not an embedded applet in a webpage.
>
> Can you expand some more on what you mean by this:
>
> "You then though have to learn WSGI or use one
> of the WSGI frameworks/toolkits. You still couldn't use traditional
> session layers though and would need to maintain your own data
> structure with active pool of connections in memory."

For details about WSGI, read:

http://www.wsgi.org/wsgi/

For the same reasons as in mod_python, you can't store stuff like
network connections in session databases if using WSGI based solutions
if session database is not in memory.

In short WSGI is just another way of hosting Python web applications
which supports many hosting implementations and not just one like
mod_python. So, not bound to the one solution.

> Also, I have read some stuff about twisted and cherrypy. Would either of these help me out?

Twisted supports running WSGI applications within it. CherryPy
framework uses WSGI interface and so can host on its own WSGI server,
on top of Twisted or on top of any other WSGI hosting mechanism.

Twisted may be a good (but complicated) choice, because it has various
components for dealing with communicating with Internet services,
perhaps including SFTP.

> Sorry if I am being naive, I am by no means an expert in apache or python.

Then you have a lot of reading and learning to do. :-)

Graham


> ________________________________________
> From: Graham Dumpleton [graham.dumpleton@gmail.com]
> Sent: Thursday, March 11, 2010 7:32 PM
> To: Mark Brown
> Cc: mod_python@modpython.org
> Subject: Re: [mod_python] Paramiko connection to SFTP web-based client
>
> On 12 March 2010 09:09, Mark Brown <Mark.Brown@greenskycredit.com> wrote:
>> Sorry that I am really, really new to Python but I have run into a wall and
>> need some help:
>>
>> Basically, I am trying to create a web-client for a sftp server.
>>
>>
>>
>> You enter your user name and password and you authenticate against the sftp
>> server, see a list of all the files on the server, can browse the server,
>> and if you click on a link download the file.
>>
>> I have tried several different methods to keep the network-resource in the
>> session, but nothing thus far has worked. My research seems to indicate that
>> in order to achieve this I would need to write a daemon that handles the
>> connection, and pass the session id to the daemon to match connection to web
>> request.
>>
>>
>>
>> I have found some articles on how to turn a python script into a daemon, but
>> I need some help understanding what is really going.
>>
>> Anyways, the script ?I have tested thus far using mod_python is below:
>>
>>
>>
>> from mod_python import apache
>> from mod_python import Session
>> import paramiko
>>
>>
>>
>> def handler(req):
>> ? ? ? session=Session.Session(req)
>> ? ? ? req.content_type="text/html"
>>
>> ? ? ? try:
>> ? ? ? ? ? ? session['hits'] +=1
>> ? ? ? ? ? ? #dirlist=session['sftp'].listdir('.')
>> ? ? ? ? ? ? req.write('From Session')
>> ? ? ? except:
>> ? ? ? ? ? ? t=paramiko.Transport(('[SERVER NAME],22))
>> ? ? ? ? ? ? t.connect(username='[USER NAME]',password='[PASSWORD]')
>> ? ? ? ? ? ? sftp=paramiko.SFTPClient.from_transport(t)
>> ? ? ? ? ? ? dirlist = sftp.listdir('.')
>> ? ? ? ? ? ? session['hits']=1
>> ? ? ? ? ? ? session['sftp']=sftp
>> ? ? ? ? ? ? req.write('New Session')
>>
>> ? ? ? session.save()
>> ? ? ? req.write('Hits %d\n' % session['hits'])
>> ? ? ? req.write(dirlist)
>>
>> ? ? ? return apache.OK
>
> To ensure portability and overall guarantee it will always work, you
> should only store in session basic Python data types. Even class
> objects should be avoided even if they can be pickled. This is because
> normally the session is stored in a database outside of the process.
> Complex objects such as a socket handle obviously cant therefore be
> stored.
>
> The only time doing so would work is on Windows. That is because in
> that case the session database is in memory and isn't actually written
> to a separate database. You could only make it work on UNIX systems by
> changing your Apache configuration such that it only ever used a
> single server child process such that all requests handled by same
> process and forcing the use of in memory session database. Forcing a
> single process when using mod_python on UNIX sort of defeats the
> problem of using Apache.
>
> You could use this single process model by instead using mod_wsgi as
> at least with that you could use its daemon mode and force your web
> application to run in single dedicated process separate to the Apache
> server child processes. You then though have to learn WSGI or use one
> of the WSGI frameworks/toolkits. You still couldn't use traditional
> session layers though and would need to maintain your own data
> structure with active pool of connections in memory.
>
> BTW, are you sure there aren't already web interfaces to SFTP clients?
> Sure there would be one somewhere, albeit maybe implemented in a
> different language.
>
> Graham
>
> --
> This message was scanned by ESVA and is believed to be clean.
>
> This electronic message transmission contains information from GreenSky Trade Credit, LLC which may be confidential & privileged. ?Recipients should not file copies of this e-mail with publicly accessed records. ?The information is intended to be for the use of the individual(s) named above. If you are not the intended recipient, please be aware that any disclosure, copying, distribution or use of this message is prohibited. If you have received this electronic transmission in error, please notify us by e-mail immediately.
>

From manikandank at tce.edu  Fri Mar 12 01:47:15 2010
From: manikandank at tce.edu (K.Manikandan)
Date: Fri Mar 12 01:47:31 2010
Subject: [mod_python] Session management implementation in mod_python
In-Reply-To: <12BEC4EE-B1C9-4FEE-ACEB-014305BE9412@xs4us.nu>
References: <75a24068c943dc6aaf462d56ddc923f3.squirrel@mail.tce.edu>
	<5693EE1C-78F8-4B56-972B-0D4207090911@xs4us.nu>
	<5313e190396855a70aeddc53591d6090.squirrel@mail.tce.edu>
	<B2059C96-D231-4D60-8660-7528F43D6178@xs4us.nu>
	<e2ef67b2f798a699aa6c63e93a067d68.squirrel@mail.tcenet>
	<626C7F60-6E85-4023-BD34-29A0BCF90E4C@xs4us.nu>
	<7821a722fd2fc5779ffd3d424c1f37b7.squirrel@mail.tcenet>
	<BA52DD57-F2AA-41F1-93D3-317CB2DBA095@xs4us.nu>
	<dd2bdbf7fe5f3eec8a59161e91824ff9.squirrel@mail.tce.edu>
	<EB220387-1F74-419A-AD0C-95BAA3957647@xs4us.nu>
	<88190270ad17a137e71d84884ff1cbe5.squirrel@mail.tcenet>
	<EFF609AE-30EE-4EE2-AF54-80A60AB8FC44@xs4us.nu>
	<ae6762939fb49dd5e7262c2d2665b866.squirrel@mail.tcenet>
	<12BEC4EE-B1C9-4FEE-ACEB-014305BE9412@xs4us.nu>
Message-ID: <f6152e0cb23518cd5f0baf61331faffe.squirrel@mail.tcenet>


Hi,

I now want to delete the cookie in the browser when I press the log-out
button. I learned somewhere that we can set the expiring time of the
cookie to be a past time. Is this a correct way?

Regards,
Manikandan K


-----------------------------------------
This email was sent using TCEMail Service.
Thiagarajar College of Engineering
Madurai-625 015, India

From Wayne.Collier at noaa.gov  Fri Mar 12 19:28:49 2010
From: Wayne.Collier at noaa.gov (wayne collier)
Date: Fri Mar 12 19:28:57 2010
Subject: [mod_python] Re: Upgrading expat for apache question
In-Reply-To: <88e286471003091416w74f87d44w8f4e4d0d0aab4416@mail.gmail.com>
References: <4B9547D8.5020802@noaa.gov>
	<88e286471003081446r5ba3da58tc5183beabadba30f@mail.gmail.com>
	<4B9682F8.8040503@noaa.gov>
	<88e286471003091416w74f87d44w8f4e4d0d0aab4416@mail.gmail.com>
Message-ID: <4B9ADC41.3010000@noaa.gov>

Okay I am running RH linux and I don't seem to have mod_ldap or 
mod_authnz_ldap shared objects loaded in my httpd.conf file. Also I ran 
ldd and got the following results:


 > *ldd /usr/local/httpd-2.2.11/bin/httpd*
    linux-gate.so.1 =>  (0x00157000)
    libm.so.6 => /lib/libm.so.6 (0x00ce8000)
    libaprutil-1.so.0 => /usr/local/httpd-2.2.11/lib/libaprutil-1.so.0 
(0x00315000)
    libexpat.so.0 => /lib/libexpat.so.0 (0x00d70000)
    libapr-1.so.0 => /usr/local/httpd-2.2.11/lib/libapr-1.so.0 (0x00844000)
    libuuid.so.1 => /lib/libuuid.so.1 (0x002f2000)
    librt.so.1 => /lib/librt.so.1 (0x00d65000)
    libcrypt.so.1 => /lib/libcrypt.so.1 (0x07e07000)
    libpthread.so.0 => /lib/libpthread.so.0 (0x00d17000)
    libdl.so.2 => /lib/libdl.so.2 (0x00d11000)
    libc.so.6 => /lib/libc.so.6 (0x00ba0000)
    /lib/ld-linux.so.2 (0x00b82000)

 >* ldd /usr/local/httpd-2.2.11/modules/mod_python.so*
    linux-gate.so.1 =>  (0x00aec000)
    libpthread.so.0 => /lib/libpthread.so.0 (0x00730000)
    libdl.so.2 => /lib/libdl.so.2 (0x0027f000)
    libutil.so.1 => /lib/libutil.so.1 (0x00f70000)
    libm.so.6 => /lib/libm.so.6 (0x009b1000)
    libc.so.6 => /lib/libc.so.6 (0x00110000)
    /lib/ld-linux.so.2 (0x00b82000)

I don't seem to have anything with ldap listed. Am I on the right track.?


Wayne

Graham Dumpleton wrote:
> A segmentation fault can occur for other reasons. If it is happening
> when you use LDAP, it could be a conflict in versions of LDAP
> libraries being used by Apache or PHP and Python LDAP module.
>
> You should use the 'ldd' command to determine what LDAP shared library
> is used by mod_authnz_ldap and compare that to the LDAP library being
> used by the C extension module component of the Python module you are
> using to access LDAP. Similarly find any PHP extension modules which
> use LDAP and look at those.
>
> If mod_authnz_ldap is loaded into Apache and you don't need it, then
> don't load it and see if problem goes away. Also try not loading PHP
> if it is being loaded. Narrow down which is in conflict.
>
> As far as I remember, Apache itself doesn't link to LDAP library and
> even possible that mod_authnz_ldap uses an internal LDAP library
> rather than linking external library. All the same even use ldd on
> Apache binary itself to see which LDAP library may be linked.
>
> Graham
>
> On 10 March 2010 04:18, wayne collier <Wayne.Collier@noaa.gov> wrote:
>   
>> Okay I guess I will look else where. However, I keep getting segmentation
>> faults when try an execute the ldap command
>>
>> t=l.simple_bind_s(dn,pw). It is only line of code that crashes. If the have
>> the classic expat problem, would that mean I would get a segmentation
>> fault problem from the start.  Also, ldap script works okay as a stand alone
>> script. Thanks.
>>
>> Wayne
>>
>>
>> Graham Dumpleton wrote:
>>
>> That is not your problem, quoting:
>>
>> http://code.google.com/p/modwsgi/wiki/IssuesWithExpatLibrary
>>
>> which is more up to date in respect of this issue, even if the
>> mod_wsgi variant of that document:
>>
>> """Note that this only applies to Python versions prior to Python 2.5.
>> >From Python 2.5 onwards, the copy of the "expat" library bundled in
>> with Python is name space prefixed, thereby avoid name clashes with an
>> "expat" library which has previously been loaded."""
>>
>> You are using Python 2.6, so you cannot be affected by this problem.
>>
>> Graham
>>
>> On 9 March 2010 05:54, wayne collier <Wayne.Collier@noaa.gov> wrote:
>>
>>
>> Hello all. I need some help solving the dreaded segmentation fault that has
>> cropped several time on this board. I have read the link
>> http://www.dscpl.com.au/wiki/ModPython/Articles/ExpatCausingApacheCrash and
>> followed the step and have uncovered the following.
>>
>>
>>
>>
>> ldd    /usr/local/httpd-2.2.11/bin/httpd | grep expat
>>
>>
>>     libexpat.so.0 => /lib/libexpat.so.0 (0x00d70000)
>>
>>
>>
>> strings /lib/libexpat.so.0  | grep expat_
>>
>>
>> expat_1.95.8
>>
>>
>>
>>   ps aux | grep http | head -3
>>
>>
>> webuser  14986  0.0  2.1  54236 19048 ?        S    Mar04   0:01
>> /usr/local/httpd-2.2.11/bin/httpd -d /usr/local/httpd-2.2.11 -f
>> /usr/local/httpd-2.2.11/conf/httpd.conf
>> webuser  14987  0.0  3.2 144128 29540 ?        S    Mar04   0:01
>> /usr/local/httpd-2.2.11/bin/httpd -d /usr/local/httpd-2.2.11 -f
>> /usr/local/httpd-2.2.11/conf/httpd.conf
>> webuser  14998  0.0  3.2 144212 29660 ?        S    Mar04   0:01
>> /usr/local/httpd-2.2.11/bin/httpd -d /usr/local/httpd-2.2.11 -f
>> /usr/local/httpd-2.2.11/conf/httpd.conf
>>
>>
>>
>>   /usr/sbin/lsof -p 14986 | grep expat
>>
>>
>> httpd   14986 webuser  mem    REG     3,5   572313  972637
>> /opt/Python/lib/python2.6/lib-dynload/pyexpat.so
>> httpd   14986 webuser  mem    REG     3,5   133120 1883791
>> /lib/libexpat.so.0.5.0
>>
>> I am not sure why I get 2 shared libaries here.
>>
>>
>>
>>   strings  /lib/libexpat.so.0.5.0 | grep expat_
>>
>>
>> expat_1.95.8
>>
>>
>>
>>
>> strings /opt/Python/lib/python2.6/lib-dynload/pyexpat.so | grep expat_
>>
>>
>> pyexpat.expat_CAPI 1.0
>> expat_CAPI
>> expat_2.0.0
>>
>>
>>
>>
>> import pyexpat
>> pyexpat.version_info
>>
>>
>> (2, 0, 0)
>>
>>
>> So it seems like I need get expat_1.95.8 apache is using up to expat_2.0.0.
>> Can I simply try replacing the 1.95.8 library with 2.0.0. Or do I have
>> recompile with Apache? If I do recompile I need to recompile apache with
>> mod_python as well?
>>
>>
>>
>>
>>
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>
>>
>>
>>     
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>   

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20100312/9e127048/attachment.html
From graham.dumpleton at gmail.com  Fri Mar 12 22:09:24 2010
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Fri Mar 12 22:09:30 2010
Subject: [mod_python] Re: Upgrading expat for apache question
In-Reply-To: <4B9ADC41.3010000@noaa.gov>
References: <4B9547D8.5020802@noaa.gov>
	<88e286471003081446r5ba3da58tc5183beabadba30f@mail.gmail.com>
	<4B9682F8.8040503@noaa.gov>
	<88e286471003091416w74f87d44w8f4e4d0d0aab4416@mail.gmail.com>
	<4B9ADC41.3010000@noaa.gov>
Message-ID: <88e286471003121909ve3ab1c4gda060385c57d21c4@mail.gmail.com>

On 13 March 2010 11:28, wayne collier <Wayne.Collier@noaa.gov> wrote:
> Okay I am running RH linux and I don't seem to have mod_ldap or
> mod_authnz_ldap shared objects loaded in my httpd.conf file.

They may not be loaded from httpd.conf but from a configuration file
snippet loaded into Apache. I don't know RH Apache configuration
layout, but check all snippet files in subdirectories to the
httpd.conf directory.

The conflict may also be because you are loading mod_php.

Ultimately you may have to use gdb to work out exactly where it
crashes. Hopefully not too much symbol information has been stripped
and gdb will be able to tell you from which library LDAP code that is
crashing is coming from.

Use first documented procedure for running Apache in single process
under gdb in:

  http://code.google.com/p/modwsgi/wiki/DebuggingTechniques#Debugging_Crashes_With_GDB

This is for mod_wsgi, but same can be done for mod_python.

Graham

> Also I ran ldd
> and got the following results:
>
>
>> ldd /usr/local/httpd-2.2.11/bin/httpd
> ??? linux-gate.so.1 =>? (0x00157000)
> ??? libm.so.6 => /lib/libm.so.6 (0x00ce8000)
> ??? libaprutil-1.so.0 => /usr/local/httpd-2.2.11/lib/libaprutil-1.so.0
> (0x00315000)
> ??? libexpat.so.0 => /lib/libexpat.so.0 (0x00d70000)
> ??? libapr-1.so.0 => /usr/local/httpd-2.2.11/lib/libapr-1.so.0 (0x00844000)
> ??? libuuid.so.1 => /lib/libuuid.so.1 (0x002f2000)
> ??? librt.so.1 => /lib/librt.so.1 (0x00d65000)
> ??? libcrypt.so.1 => /lib/libcrypt.so.1 (0x07e07000)
> ??? libpthread.so.0 => /lib/libpthread.so.0 (0x00d17000)
> ??? libdl.so.2 => /lib/libdl.so.2 (0x00d11000)
> ??? libc.so.6 => /lib/libc.so.6 (0x00ba0000)
> ??? /lib/ld-linux.so.2 (0x00b82000)
>
>> ldd /usr/local/httpd-2.2.11/modules/mod_python.so
> ??? linux-gate.so.1 =>? (0x00aec000)
> ??? libpthread.so.0 => /lib/libpthread.so.0 (0x00730000)
> ??? libdl.so.2 => /lib/libdl.so.2 (0x0027f000)
> ??? libutil.so.1 => /lib/libutil.so.1 (0x00f70000)
> ??? libm.so.6 => /lib/libm.so.6 (0x009b1000)
> ??? libc.so.6 => /lib/libc.so.6 (0x00110000)
> ??? /lib/ld-linux.so.2 (0x00b82000)
>
> I don't seem to have anything with ldap listed. Am I on the right track.?
>
>
> Wayne
>
> Graham Dumpleton wrote:
>
> A segmentation fault can occur for other reasons. If it is happening
> when you use LDAP, it could be a conflict in versions of LDAP
> libraries being used by Apache or PHP and Python LDAP module.
>
> You should use the 'ldd' command to determine what LDAP shared library
> is used by mod_authnz_ldap and compare that to the LDAP library being
> used by the C extension module component of the Python module you are
> using to access LDAP. Similarly find any PHP extension modules which
> use LDAP and look at those.
>
> If mod_authnz_ldap is loaded into Apache and you don't need it, then
> don't load it and see if problem goes away. Also try not loading PHP
> if it is being loaded. Narrow down which is in conflict.
>
> As far as I remember, Apache itself doesn't link to LDAP library and
> even possible that mod_authnz_ldap uses an internal LDAP library
> rather than linking external library. All the same even use ldd on
> Apache binary itself to see which LDAP library may be linked.
>
> Graham
>
> On 10 March 2010 04:18, wayne collier <Wayne.Collier@noaa.gov> wrote:
>
>
> Okay I guess I will look else where. However, I keep getting segmentation
> faults when try an execute the ldap command
>
> t=l.simple_bind_s(dn,pw). It is only line of code that crashes. If the have
> the classic expat problem, would that mean I would get a segmentation
> fault problem from the start.  Also, ldap script works okay as a stand alone
> script. Thanks.
>
> Wayne
>
>
> Graham Dumpleton wrote:
>
> That is not your problem, quoting:
>
> http://code.google.com/p/modwsgi/wiki/IssuesWithExpatLibrary
>
> which is more up to date in respect of this issue, even if the
> mod_wsgi variant of that document:
>
> """Note that this only applies to Python versions prior to Python 2.5.
> >From Python 2.5 onwards, the copy of the "expat" library bundled in
> with Python is name space prefixed, thereby avoid name clashes with an
> "expat" library which has previously been loaded."""
>
> You are using Python 2.6, so you cannot be affected by this problem.
>
> Graham
>
> On 9 March 2010 05:54, wayne collier <Wayne.Collier@noaa.gov> wrote:
>
>
> Hello all. I need some help solving the dreaded segmentation fault that has
> cropped several time on this board. I have read the link
> http://www.dscpl.com.au/wiki/ModPython/Articles/ExpatCausingApacheCrash and
> followed the step and have uncovered the following.
>
>
>
>
> ldd??? /usr/local/httpd-2.2.11/bin/httpd | grep expat
>
>
> ??? libexpat.so.0 => /lib/libexpat.so.0 (0x00d70000)
>
>
>
> strings /lib/libexpat.so.0? | grep expat_
>
>
> expat_1.95.8
>
>
>
> ? ps aux | grep http | head -3
>
>
> webuser? 14986? 0.0? 2.1? 54236 19048 ???????? S??? Mar04?? 0:01
> /usr/local/httpd-2.2.11/bin/httpd -d /usr/local/httpd-2.2.11 -f
> /usr/local/httpd-2.2.11/conf/httpd.conf
> webuser? 14987? 0.0? 3.2 144128 29540 ???????? S??? Mar04?? 0:01
> /usr/local/httpd-2.2.11/bin/httpd -d /usr/local/httpd-2.2.11 -f
> /usr/local/httpd-2.2.11/conf/httpd.conf
> webuser? 14998? 0.0? 3.2 144212 29660 ???????? S??? Mar04?? 0:01
> /usr/local/httpd-2.2.11/bin/httpd -d /usr/local/httpd-2.2.11 -f
> /usr/local/httpd-2.2.11/conf/httpd.conf
>
>
>
> ? /usr/sbin/lsof -p 14986 | grep expat
>
>
> httpd?? 14986 webuser? mem??? REG???? 3,5?? 572313? 972637
> /opt/Python/lib/python2.6/lib-dynload/pyexpat.so
> httpd?? 14986 webuser? mem??? REG???? 3,5?? 133120 1883791
> /lib/libexpat.so.0.5.0
>
> I am not sure why I get 2 shared libaries here.
>
>
>
> ? strings? /lib/libexpat.so.0.5.0 | grep expat_
>
>
> expat_1.95.8
>
>
>
>
> strings /opt/Python/lib/python2.6/lib-dynload/pyexpat.so | grep expat_
>
>
> pyexpat.expat_CAPI 1.0
> expat_CAPI
> expat_2.0.0
>
>
>
>
> import pyexpat
> pyexpat.version_info
>
>
> (2, 0, 0)
>
>
> So it seems like I need get expat_1.95.8 apache is using up to expat_2.0.0.
> Can I simply try replacing the 1.95.8 library with 2.0.0. Or do I have
> recompile with Apache? If I do recompile I need to recompile apache with
> mod_python as well?
>
>
>
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
>

From Wayne.Collier at noaa.gov  Thu Mar 18 16:48:39 2010
From: Wayne.Collier at noaa.gov (wayne collier)
Date: Thu Mar 18 16:48:46 2010
Subject: [mod_python] Re: Upgrading expat for apache question
In-Reply-To: <88e286471003121909ve3ab1c4gda060385c57d21c4@mail.gmail.com>
References: <4B9547D8.5020802@noaa.gov>
	<88e286471003081446r5ba3da58tc5183beabadba30f@mail.gmail.com>
	<4B9682F8.8040503@noaa.gov>
	<88e286471003091416w74f87d44w8f4e4d0d0aab4416@mail.gmail.com>
	<4B9ADC41.3010000@noaa.gov>
	<88e286471003121909ve3ab1c4gda060385c57d21c4@mail.gmail.com>
Message-ID: <4BA291A7.3050103@noaa.gov>

Graham -my understanding of RH apache  is  modules have to   explicitly 
loaded  in httpd.con file.  I check all the snippet  files  and  no  
php  shared object file is being loaded.  I noticed before that did not 
seem to have any mod_authz_ldap shared object loaded in my configuration 
file. Do I need to set things up like i am doing authorization and 
authentication thru apache?  Is possible that needs to be included?

Also, I went thru some of the troubleshooting steps. I ran my web code 
to reproduce the seg fault and then gbc to attach the process id.  I got 
the following before getting really lost here. Any suggestions here 
would greatly appreciated. Thanks.

Wayne

*GBD WORK .....*

Detaching from program: /usr/local/httpd-2.2.11/bin/httpd, process 18421
[root@mingus psp]# gdb /usr/local/httpd-2.2.11/bin/httpd 18421
GNU gdb Fedora (6.8-37.el5)
Copyright (C) 2008 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later 
<http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "i386-redhat-linux-gnu"...
Attaching to program: /usr/local/httpd-2.2.11/bin/httpd, process 18421

warning: .dynamic section for "/usr/lib/libgssapi_krb5.so.2" is not at 
the expected address

warning: difference appears to be caused by prelink, adjusting expectations

warning: .dynamic section for "/usr/lib/libkrb5.so.3" is not at the 
expected address

warning: difference appears to be caused by prelink, adjusting expectations

warning: .dynamic section for "/lib/libcom_err.so.2" is not at the 
expected address

warning: difference appears to be caused by prelink, adjusting expectations

warning: .dynamic section for "/usr/lib/libk5crypto.so.3" is not at the 
expected address

warning: difference appears to be caused by prelink, adjusting expectations

warning: .dynamic section for "/lib/libresolv.so.2" is not at the 
expected address

warning: difference appears to be caused by prelink, adjusting expectations

warning: .dynamic section for "/usr/lib/libkrb5support.so.0" is not at 
the expected address

warning: difference appears to be caused by prelink, adjusting expectations

warning: .dynamic section for "/lib/libkeyutils.so.1" is not at the 
expected address

warning: difference appears to be caused by prelink, adjusting expectations

warning: .dynamic section for "/lib/libselinux.so.1" is not at the 
expected address

warning: difference appears to be caused by prelink, adjusting expectations

warning: .dynamic section for "/lib/libsepol.so.1" is not at the 
expected address

warning: difference appears to be caused by prelink, adjusting expectations

warning: .dynamic section for "/usr/lib/liblber-2.3.so.0" is not at the 
expected address

warning: difference appears to be caused by prelink, adjusting expectations
Reading symbols from /lib/libm.so.6...done.
Loaded symbols for /lib/libm.so.6
Reading symbols from /usr/local/httpd-2.2.11/lib/libaprutil-1.so.0...done.
Loaded symbols for /usr/local/httpd-2.2.11/lib/libaprutil-1.so.0
Reading symbols from /lib/libexpat.so.0...done.
Loaded symbols for /lib/libexpat.so.0
Reading symbols from /usr/local/httpd-2.2.11/lib/libapr-1.so.0...done.
Loaded symbols for /usr/local/httpd-2.2.11/lib/libapr-1.so.0
Reading symbols from /lib/libuuid.so.1...done.
Loaded symbols for /lib/libuuid.so.1
Reading symbols from /lib/librt.so.1...done.
Loaded symbols for /lib/librt.so.1
Reading symbols from /lib/libcrypt.so.1...done.
Loaded symbols for /lib/libcrypt.so.1
Reading symbols from /lib/libpthread.so.0...done.
[Thread debugging using libthread_db enabled]
[New Thread 0x135700 (LWP 18421)]
Loaded symbols for /lib/libpthread.so.0
Reading symbols from /lib/libdl.so.2...done.
Loaded symbols for /lib/libdl.so.2
Reading symbols from /lib/libc.so.6...done.
Loaded symbols for /lib/libc.so.6
Reading symbols from /lib/ld-linux.so.2...done.
Loaded symbols for /lib/ld-linux.so.2
Reading symbols from /lib/libnss_files.so.2...done.
Loaded symbols for /lib/libnss_files.so.2


(gdb) print PyRun_SimpleString("import traceback; traceback.print_stact()")

Program received signal SIGSEGV, Segmentation fault.
PyImport_AddModule (name=0x5596b3 "__main__") at Python/import.c:366
366             PyInterpreterState *interp = PyThreadState_GET()->interp;
The program being debugged was signaled while in a function called from GDB.
GDB remains in the frame where the signal was received.
To change this behavior use "set unwindonsignal on"
Evaluation of the expression containing the function 
(PyRun_SimpleString) will be abandoned.
(gdb)                              






Graham Dumpleton wrote:
> On 13 March 2010 11:28, wayne collier <Wayne.Collier@noaa.gov> wrote:
>   
>> Okay I am running RH linux and I don't seem to have mod_ldap or
>> mod_authnz_ldap shared objects loaded in my httpd.conf file.
>>     
>
> They may not be loaded from httpd.conf but from a configuration file
> snippet loaded into Apache. I don't know RH Apache configuration
> layout, but check all snippet files in subdirectories to the
> httpd.conf directory.
>
> The conflict may also be because you are loading mod_php.
>
> Ultimately you may have to use gdb to work out exactly where it
> crashes. Hopefully not too much symbol information has been stripped
> and gdb will be able to tell you from which library LDAP code that is
> crashing is coming from.
>
> Use first documented procedure for running Apache in single process
> under gdb in:
>
>   http://code.google.com/p/modwsgi/wiki/DebuggingTechniques#Debugging_Crashes_With_GDB
>
> This is for mod_wsgi, but same can be done for mod_python.
>
> Graham
>
>   
>> Also I ran ldd
>> and got the following results:
>>
>>
>>     
>>> ldd /usr/local/httpd-2.2.11/bin/httpd
>>>       
>>     linux-gate.so.1 =>  (0x00157000)
>>     libm.so.6 => /lib/libm.so.6 (0x00ce8000)
>>     libaprutil-1.so.0 => /usr/local/httpd-2.2.11/lib/libaprutil-1.so.0
>> (0x00315000)
>>     libexpat.so.0 => /lib/libexpat.so.0 (0x00d70000)
>>     libapr-1.so.0 => /usr/local/httpd-2.2.11/lib/libapr-1.so.0 (0x00844000)
>>     libuuid.so.1 => /lib/libuuid.so.1 (0x002f2000)
>>     librt.so.1 => /lib/librt.so.1 (0x00d65000)
>>     libcrypt.so.1 => /lib/libcrypt.so.1 (0x07e07000)
>>     libpthread.so.0 => /lib/libpthread.so.0 (0x00d17000)
>>     libdl.so.2 => /lib/libdl.so.2 (0x00d11000)
>>     libc.so.6 => /lib/libc.so.6 (0x00ba0000)
>>     /lib/ld-linux.so.2 (0x00b82000)
>>
>>     
>>> ldd /usr/local/httpd-2.2.11/modules/mod_python.so
>>>       
>>     linux-gate.so.1 =>  (0x00aec000)
>>     libpthread.so.0 => /lib/libpthread.so.0 (0x00730000)
>>     libdl.so.2 => /lib/libdl.so.2 (0x0027f000)
>>     libutil.so.1 => /lib/libutil.so.1 (0x00f70000)
>>     libm.so.6 => /lib/libm.so.6 (0x009b1000)
>>     libc.so.6 => /lib/libc.so.6 (0x00110000)
>>     /lib/ld-linux.so.2 (0x00b82000)
>>
>> I don't seem to have anything with ldap listed. Am I on the right track.?
>>
>>
>> Wayne
>>
>> Graham Dumpleton wrote:
>>
>> A segmentation fault can occur for other reasons. If it is happening
>> when you use LDAP, it could be a conflict in versions of LDAP
>> libraries being used by Apache or PHP and Python LDAP module.
>>
>> You should use the 'ldd' command to determine what LDAP shared library
>> is used by mod_authnz_ldap and compare that to the LDAP library being
>> used by the C extension module component of the Python module you are
>> using to access LDAP. Similarly find any PHP extension modules which
>> use LDAP and look at those.
>>
>> If mod_authnz_ldap is loaded into Apache and you don't need it, then
>> don't load it and see if problem goes away. Also try not loading PHP
>> if it is being loaded. Narrow down which is in conflict.
>>
>> As far as I remember, Apache itself doesn't link to LDAP library and
>> even possible that mod_authnz_ldap uses an internal LDAP library
>> rather than linking external library. All the same even use ldd on
>> Apache binary itself to see which LDAP library may be linked.
>>
>> Graham
>>
>> On 10 March 2010 04:18, wayne collier <Wayne.Collier@noaa.gov> wrote:
>>
>>
>> Okay I guess I will look else where. However, I keep getting segmentation
>> faults when try an execute the ldap command
>>
>> t=l.simple_bind_s(dn,pw). It is only line of code that crashes. If the have
>> the classic expat problem, would that mean I would get a segmentation
>> fault problem from the start.  Also, ldap script works okay as a stand alone
>> script. Thanks.
>>
>> Wayne
>>
>>
>> Graham Dumpleton wrote:
>>
>> That is not your problem, quoting:
>>
>> http://code.google.com/p/modwsgi/wiki/IssuesWithExpatLibrary
>>
>> which is more up to date in respect of this issue, even if the
>> mod_wsgi variant of that document:
>>
>> """Note that this only applies to Python versions prior to Python 2.5.
>> >From Python 2.5 onwards, the copy of the "expat" library bundled in
>> with Python is name space prefixed, thereby avoid name clashes with an
>> "expat" library which has previously been loaded."""
>>
>> You are using Python 2.6, so you cannot be affected by this problem.
>>
>> Graham
>>
>> On 9 March 2010 05:54, wayne collier <Wayne.Collier@noaa.gov> wrote:
>>
>>
>> Hello all. I need some help solving the dreaded segmentation fault that has
>> cropped several time on this board. I have read the link
>> http://www.dscpl.com.au/wiki/ModPython/Articles/ExpatCausingApacheCrash and
>> followed the step and have uncovered the following.
>>
>>
>>
>>
>> ldd    /usr/local/httpd-2.2.11/bin/httpd | grep expat
>>
>>
>>     libexpat.so.0 => /lib/libexpat.so.0 (0x00d70000)
>>
>>
>>
>> strings /lib/libexpat.so.0  | grep expat_
>>
>>
>> expat_1.95.8
>>
>>
>>
>>   ps aux | grep http | head -3
>>
>>
>> webuser  14986  0.0  2.1  54236 19048 ?        S    Mar04   0:01
>> /usr/local/httpd-2.2.11/bin/httpd -d /usr/local/httpd-2.2.11 -f
>> /usr/local/httpd-2.2.11/conf/httpd.conf
>> webuser  14987  0.0  3.2 144128 29540 ?        S    Mar04   0:01
>> /usr/local/httpd-2.2.11/bin/httpd -d /usr/local/httpd-2.2.11 -f
>> /usr/local/httpd-2.2.11/conf/httpd.conf
>> webuser  14998  0.0  3.2 144212 29660 ?        S    Mar04   0:01
>> /usr/local/httpd-2.2.11/bin/httpd -d /usr/local/httpd-2.2.11 -f
>> /usr/local/httpd-2.2.11/conf/httpd.conf
>>
>>
>>
>>   /usr/sbin/lsof -p 14986 | grep expat
>>
>>
>> httpd   14986 webuser  mem    REG     3,5   572313  972637
>> /opt/Python/lib/python2.6/lib-dynload/pyexpat.so
>> httpd   14986 webuser  mem    REG     3,5   133120 1883791
>> /lib/libexpat.so.0.5.0
>>
>> I am not sure why I get 2 shared libaries here.
>>
>>
>>
>>   strings  /lib/libexpat.so.0.5.0 | grep expat_
>>
>>
>> expat_1.95.8
>>
>>
>>
>>
>> strings /opt/Python/lib/python2.6/lib-dynload/pyexpat.so | grep expat_
>>
>>
>> pyexpat.expat_CAPI 1.0
>> expat_CAPI
>> expat_2.0.0
>>
>>
>>
>>
>> import pyexpat
>> pyexpat.version_info
>>
>>
>> (2, 0, 0)
>>
>>
>> So it seems like I need get expat_1.95.8 apache is using up to expat_2.0.0.
>> Can I simply try replacing the 1.95.8 library with 2.0.0. Or do I have
>> recompile with Apache? If I do recompile I need to recompile apache with
>> mod_python as well?
>>
>>
>>
>>
>>
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>
>>
>>
>>
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>
>>
>>
>>     
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>   

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20100318/2576e622/attachment.html
From manikandank at tce.edu  Fri Mar 19 02:53:41 2010
From: manikandank at tce.edu (K.Manikandan)
Date: Fri Mar 19 02:54:09 2010
Subject: [mod_python] Session management implementation in mod_python
In-Reply-To: <12BEC4EE-B1C9-4FEE-ACEB-014305BE9412@xs4us.nu>
References: <75a24068c943dc6aaf462d56ddc923f3.squirrel@mail.tce.edu>
	<5693EE1C-78F8-4B56-972B-0D4207090911@xs4us.nu>
	<5313e190396855a70aeddc53591d6090.squirrel@mail.tce.edu>
	<B2059C96-D231-4D60-8660-7528F43D6178@xs4us.nu>
	<e2ef67b2f798a699aa6c63e93a067d68.squirrel@mail.tcenet>
	<626C7F60-6E85-4023-BD34-29A0BCF90E4C@xs4us.nu>
	<7821a722fd2fc5779ffd3d424c1f37b7.squirrel@mail.tcenet>
	<BA52DD57-F2AA-41F1-93D3-317CB2DBA095@xs4us.nu>
	<dd2bdbf7fe5f3eec8a59161e91824ff9.squirrel@mail.tce.edu>
	<EB220387-1F74-419A-AD0C-95BAA3957647@xs4us.nu>
	<88190270ad17a137e71d84884ff1cbe5.squirrel@mail.tcenet>
	<EFF609AE-30EE-4EE2-AF54-80A60AB8FC44@xs4us.nu>
	<ae6762939fb49dd5e7262c2d2665b866.squirrel@mail.tcenet>
	<12BEC4EE-B1C9-4FEE-ACEB-014305BE9412@xs4us.nu>
Message-ID: <982f6d445726dc9e2e5db4065a6ea49a.squirrel@mail.tce.edu>

Hi,

We have implemented the inter application session management. Now, once we
logout from one webapp, we delete the session details from the db. But,
the cookie (session_id) , is still there in the browser. Now, we have to
remove this cookie after we click logout. We have used Cookie in python.
That cookie contains only session_id. eg {session_id:12345}. Now, how
should I remove this cookie from the browser.

Please help us out of this.

Regards,
Manikandan K


-----------------------------------------
This email was sent using TCEMail Service.
Thiagarajar College of Engineering
Madurai-625 015, India

From graham.dumpleton at gmail.com  Sat Mar 20 07:06:38 2010
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sat Mar 20 07:06:45 2010
Subject: [mod_python] Re: Upgrading expat for apache question
In-Reply-To: <4BA291A7.3050103@noaa.gov>
References: <4B9547D8.5020802@noaa.gov>
	<88e286471003081446r5ba3da58tc5183beabadba30f@mail.gmail.com>
	<4B9682F8.8040503@noaa.gov>
	<88e286471003091416w74f87d44w8f4e4d0d0aab4416@mail.gmail.com>
	<4B9ADC41.3010000@noaa.gov>
	<88e286471003121909ve3ab1c4gda060385c57d21c4@mail.gmail.com>
	<4BA291A7.3050103@noaa.gov>
Message-ID: <88e286471003200406m6e34b0dfv787cc41548099a79@mail.gmail.com>

On 19 March 2010 07:48, wayne collier <Wayne.Collier@noaa.gov> wrote:
> Graham -my understanding of RH apache? is? modules have to?? explicitly
> loaded? in httpd.con file.? I check all the snippet? files? and? no? php
> shared object file is being loaded.? I noticed before that did not seem to
> have any mod_authz_ldap shared object loaded in my configuration file. Do I
> need to set things up like i am doing authorization and authentication thru
> apache?? Is possible that needs to be included?
>
> Also, I went thru some of the troubleshooting steps. I ran my web code to
> reproduce the seg fault and then gbc to attach the process id.? I got the
> following before getting really lost here. Any suggestions here would
> greatly appreciated. Thanks.
>
> Wayne
>
> GBD WORK .....
>
> Detaching from program: /usr/local/httpd-2.2.11/bin/httpd, process 18421
> [root@mingus psp]# gdb /usr/local/httpd-2.2.11/bin/httpd 18421
> GNU gdb Fedora (6.8-37.el5)
> Copyright (C) 2008 Free Software Foundation, Inc.
> License GPLv3+: GNU GPL version 3 or later
> <http://gnu.org/licenses/gpl.html>
> This is free software: you are free to change and redistribute it.
> There is NO WARRANTY, to the extent permitted by law.? Type "show copying"
> and "show warranty" for details.
> This GDB was configured as "i386-redhat-linux-gnu"...
> Attaching to program: /usr/local/httpd-2.2.11/bin/httpd, process 18421
>
> warning: .dynamic section for "/usr/lib/libgssapi_krb5.so.2" is not at the
> expected address
>
> warning: difference appears to be caused by prelink, adjusting expectations
>
> warning: .dynamic section for "/usr/lib/libkrb5.so.3" is not at the expected
> address
>
> warning: difference appears to be caused by prelink, adjusting expectations
>
> warning: .dynamic section for "/lib/libcom_err.so.2" is not at the expected
> address
>
> warning: difference appears to be caused by prelink, adjusting expectations
>
> warning: .dynamic section for "/usr/lib/libk5crypto.so.3" is not at the
> expected address
>
> warning: difference appears to be caused by prelink, adjusting expectations
>
> warning: .dynamic section for "/lib/libresolv.so.2" is not at the expected
> address
>
> warning: difference appears to be caused by prelink, adjusting expectations
>
> warning: .dynamic section for "/usr/lib/libkrb5support.so.0" is not at the
> expected address
>
> warning: difference appears to be caused by prelink, adjusting expectations
>
> warning: .dynamic section for "/lib/libkeyutils.so.1" is not at the expected
> address
>
> warning: difference appears to be caused by prelink, adjusting expectations
>
> warning: .dynamic section for "/lib/libselinux.so.1" is not at the expected
> address
>
> warning: difference appears to be caused by prelink, adjusting expectations
>
> warning: .dynamic section for "/lib/libsepol.so.1" is not at the expected
> address
>
> warning: difference appears to be caused by prelink, adjusting expectations
>
> warning: .dynamic section for "/usr/lib/liblber-2.3.so.0" is not at the
> expected address
>
> warning: difference appears to be caused by prelink, adjusting expectations
> Reading symbols from /lib/libm.so.6...done.
> Loaded symbols for /lib/libm.so.6
> Reading symbols from /usr/local/httpd-2.2.11/lib/libaprutil-1.so.0...done.
> Loaded symbols for /usr/local/httpd-2.2.11/lib/libaprutil-1.so.0
> Reading symbols from /lib/libexpat.so.0...done.
> Loaded symbols for /lib/libexpat.so.0
> Reading symbols from /usr/local/httpd-2.2.11/lib/libapr-1.so.0...done.
> Loaded symbols for /usr/local/httpd-2.2.11/lib/libapr-1.so.0
> Reading symbols from /lib/libuuid.so.1...done.
> Loaded symbols for /lib/libuuid.so.1
> Reading symbols from /lib/librt.so.1...done.
> Loaded symbols for /lib/librt.so.1
> Reading symbols from /lib/libcrypt.so.1...done.
> Loaded symbols for /lib/libcrypt.so.1
> Reading symbols from /lib/libpthread.so.0...done.
> [Thread debugging using libthread_db enabled]
> [New Thread 0x135700 (LWP 18421)]
> Loaded symbols for /lib/libpthread.so.0
> Reading symbols from /lib/libdl.so.2...done.
> Loaded symbols for /lib/libdl.so.2
> Reading symbols from /lib/libc.so.6...done.
> Loaded symbols for /lib/libc.so.6
> Reading symbols from /lib/ld-linux.so.2...done.
> Loaded symbols for /lib/ld-linux.so.2
> Reading symbols from /lib/libnss_files.so.2...done.
> Loaded symbols for /lib/libnss_files.so.2
>
>
> (gdb) print PyRun_SimpleString("import traceback; traceback.print_stact()")
>
> Program received signal SIGSEGV, Segmentation fault.
> PyImport_AddModule (name=0x5596b3 "__main__") at Python/import.c:366
> 366???????????? PyInterpreterState *interp = PyThreadState_GET()->interp;
> The program being debugged was signaled while in a function called from GDB.
> GDB remains in the frame where the signal was received.
> To change this behavior use "set unwindonsignal on"
> Evaluation of the expression containing the function (PyRun_SimpleString)
> will be abandoned.
> (gdb)

I don't want a Python stack trace, I want a C stack trace as
documented in that page I sent you to. Use:

  (gdb) thread apply all bt

Graham

> Graham Dumpleton wrote:
>
> On 13 March 2010 11:28, wayne collier <Wayne.Collier@noaa.gov> wrote:
>
>
> Okay I am running RH linux and I don't seem to have mod_ldap or
> mod_authnz_ldap shared objects loaded in my httpd.conf file.
>
>
> They may not be loaded from httpd.conf but from a configuration file
> snippet loaded into Apache. I don't know RH Apache configuration
> layout, but check all snippet files in subdirectories to the
> httpd.conf directory.
>
> The conflict may also be because you are loading mod_php.
>
> Ultimately you may have to use gdb to work out exactly where it
> crashes. Hopefully not too much symbol information has been stripped
> and gdb will be able to tell you from which library LDAP code that is
> crashing is coming from.
>
> Use first documented procedure for running Apache in single process
> under gdb in:
>
>
> http://code.google.com/p/modwsgi/wiki/DebuggingTechniques#Debugging_Crashes_With_GDB
>
> This is for mod_wsgi, but same can be done for mod_python.
>
> Graham
>
>
>
> Also I ran ldd
> and got the following results:
>
>
>
>
> ldd /usr/local/httpd-2.2.11/bin/httpd
>
>
> ??? linux-gate.so.1 =>? (0x00157000)
> ??? libm.so.6 => /lib/libm.so.6 (0x00ce8000)
> ??? libaprutil-1.so.0 => /usr/local/httpd-2.2.11/lib/libaprutil-1.so.0
> (0x00315000)
> ??? libexpat.so.0 => /lib/libexpat.so.0 (0x00d70000)
> ??? libapr-1.so.0 => /usr/local/httpd-2.2.11/lib/libapr-1.so.0 (0x00844000)
> ??? libuuid.so.1 => /lib/libuuid.so.1 (0x002f2000)
> ??? librt.so.1 => /lib/librt.so.1 (0x00d65000)
> ??? libcrypt.so.1 => /lib/libcrypt.so.1 (0x07e07000)
> ??? libpthread.so.0 => /lib/libpthread.so.0 (0x00d17000)
> ??? libdl.so.2 => /lib/libdl.so.2 (0x00d11000)
> ??? libc.so.6 => /lib/libc.so.6 (0x00ba0000)
> ??? /lib/ld-linux.so.2 (0x00b82000)
>
>
>
> ldd /usr/local/httpd-2.2.11/modules/mod_python.so
>
>
> ??? linux-gate.so.1 =>? (0x00aec000)
> ??? libpthread.so.0 => /lib/libpthread.so.0 (0x00730000)
> ??? libdl.so.2 => /lib/libdl.so.2 (0x0027f000)
> ??? libutil.so.1 => /lib/libutil.so.1 (0x00f70000)
> ??? libm.so.6 => /lib/libm.so.6 (0x009b1000)
> ??? libc.so.6 => /lib/libc.so.6 (0x00110000)
> ??? /lib/ld-linux.so.2 (0x00b82000)
>
> I don't seem to have anything with ldap listed. Am I on the right track.?
>
>
> Wayne
>
> Graham Dumpleton wrote:
>
> A segmentation fault can occur for other reasons. If it is happening
> when you use LDAP, it could be a conflict in versions of LDAP
> libraries being used by Apache or PHP and Python LDAP module.
>
> You should use the 'ldd' command to determine what LDAP shared library
> is used by mod_authnz_ldap and compare that to the LDAP library being
> used by the C extension module component of the Python module you are
> using to access LDAP. Similarly find any PHP extension modules which
> use LDAP and look at those.
>
> If mod_authnz_ldap is loaded into Apache and you don't need it, then
> don't load it and see if problem goes away. Also try not loading PHP
> if it is being loaded. Narrow down which is in conflict.
>
> As far as I remember, Apache itself doesn't link to LDAP library and
> even possible that mod_authnz_ldap uses an internal LDAP library
> rather than linking external library. All the same even use ldd on
> Apache binary itself to see which LDAP library may be linked.
>
> Graham
>
> On 10 March 2010 04:18, wayne collier <Wayne.Collier@noaa.gov> wrote:
>
>
> Okay I guess I will look else where. However, I keep getting segmentation
> faults when try an execute the ldap command
>
> t=l.simple_bind_s(dn,pw). It is only line of code that crashes. If the have
> the classic expat problem, would that mean I would get a segmentation
> fault problem from the start.  Also, ldap script works okay as a stand alone
> script. Thanks.
>
> Wayne
>
>
> Graham Dumpleton wrote:
>
> That is not your problem, quoting:
>
> http://code.google.com/p/modwsgi/wiki/IssuesWithExpatLibrary
>
> which is more up to date in respect of this issue, even if the
> mod_wsgi variant of that document:
>
> """Note that this only applies to Python versions prior to Python 2.5.
> >From Python 2.5 onwards, the copy of the "expat" library bundled in
> with Python is name space prefixed, thereby avoid name clashes with an
> "expat" library which has previously been loaded."""
>
> You are using Python 2.6, so you cannot be affected by this problem.
>
> Graham
>
> On 9 March 2010 05:54, wayne collier <Wayne.Collier@noaa.gov> wrote:
>
>
> Hello all. I need some help solving the dreaded segmentation fault that has
> cropped several time on this board. I have read the link
> http://www.dscpl.com.au/wiki/ModPython/Articles/ExpatCausingApacheCrash and
> followed the step and have uncovered the following.
>
>
>
>
> ldd??? /usr/local/httpd-2.2.11/bin/httpd | grep expat
>
>
> ??? libexpat.so.0 => /lib/libexpat.so.0 (0x00d70000)
>
>
>
> strings /lib/libexpat.so.0? | grep expat_
>
>
> expat_1.95.8
>
>
>
> ? ps aux | grep http | head -3
>
>
> webuser? 14986? 0.0? 2.1? 54236 19048 ???????? S??? Mar04?? 0:01
> /usr/local/httpd-2.2.11/bin/httpd -d /usr/local/httpd-2.2.11 -f
> /usr/local/httpd-2.2.11/conf/httpd.conf
> webuser? 14987? 0.0? 3.2 144128 29540 ???????? S??? Mar04?? 0:01
> /usr/local/httpd-2.2.11/bin/httpd -d /usr/local/httpd-2.2.11 -f
> /usr/local/httpd-2.2.11/conf/httpd.conf
> webuser? 14998? 0.0? 3.2 144212 29660 ???????? S??? Mar04?? 0:01
> /usr/local/httpd-2.2.11/bin/httpd -d /usr/local/httpd-2.2.11 -f
> /usr/local/httpd-2.2.11/conf/httpd.conf
>
>
>
> ? /usr/sbin/lsof -p 14986 | grep expat
>
>
> httpd?? 14986 webuser? mem??? REG???? 3,5?? 572313? 972637
> /opt/Python/lib/python2.6/lib-dynload/pyexpat.so
> httpd?? 14986 webuser? mem??? REG???? 3,5?? 133120 1883791
> /lib/libexpat.so.0.5.0
>
> I am not sure why I get 2 shared libaries here.
>
>
>
> ? strings? /lib/libexpat.so.0.5.0 | grep expat_
>
>
> expat_1.95.8
>
>
>
>
> strings /opt/Python/lib/python2.6/lib-dynload/pyexpat.so | grep expat_
>
>
> pyexpat.expat_CAPI 1.0
> expat_CAPI
> expat_2.0.0
>
>
>
>
> import pyexpat
> pyexpat.version_info
>
>
> (2, 0, 0)
>
>
> So it seems like I need get expat_1.95.8 apache is using up to expat_2.0.0.
> Can I simply try replacing the 1.95.8 library with 2.0.0. Or do I have
> recompile with Apache? If I do recompile I need to recompile apache with
> mod_python as well?
>
>
>
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
>

From Wayne.Collier at noaa.gov  Mon Mar 22 14:20:58 2010
From: Wayne.Collier at noaa.gov (wayne collier)
Date: Mon Mar 22 14:21:05 2010
Subject: [mod_python] Re: Upgrading expat for apache question
In-Reply-To: <88e286471003200406m6e34b0dfv787cc41548099a79@mail.gmail.com>
References: <4B9547D8.5020802@noaa.gov>
	<88e286471003081446r5ba3da58tc5183beabadba30f@mail.gmail.com>
	<4B9682F8.8040503@noaa.gov>
	<88e286471003091416w74f87d44w8f4e4d0d0aab4416@mail.gmail.com>
	<4B9ADC41.3010000@noaa.gov>
	<88e286471003121909ve3ab1c4gda060385c57d21c4@mail.gmail.com>
	<4BA291A7.3050103@noaa.gov>
	<88e286471003200406m6e34b0dfv787cc41548099a79@mail.gmail.com>
Message-ID: <4BA7B50A.5040108@noaa.gov>

Okay Graham.  I ran the "thread apply all bt" that dicuss in the link 
and got the following:

(gdb) thread apply all bt

Thread 1 (Thread 0x135700 (LWP 28732)):
#0  0x001ef402 in __kernel_vsyscall ()
#1  0x00c735bb in semop () from /lib/libc.so.6
#2  0x0012420a in proc_mutex_sysv_acquire (mutex=0x134934)
    at locks/unix/proc_mutex.c:226
#3  0x00123242 in apr_proc_mutex_lock (mutex=0x9123098)
    at locks/unix/proc_mutex.c:878
---Type <return> to continue, or q <return> to quit---
#4  0x081ac7a0 in child_main (child_num_arg=<value optimized out>)
    at prefork.c:205
#5  0x081acb77 in make_child (s=0x909d9a8, slot=12) at prefork.c:746
#6  0x081ad4d0 in ap_mpm_run (_pconf=0x90960a8, plog=0x90d41a0, s=0x909d9a8)
    at prefork.c:881
#7  0x08088945 in main (argc=151601312, argv=0x91d5338) at main.c:740
(gdb)                                                    


*The line 740 and 741 of  main.c is as follows:
*
740      if (ap_mpm_run(pconf, plog, server_conf))
741            break;

*Here are the lines from prefolk.c:*

881                make_child(ap_server_conf, free_slots[i]);
746        child_main(slot);
205    apr_status_t rv = apr_proc_mutex_lock(accept_mutex);


* Here are the lines from locks/unix/proc_mutex.c :*

876  APR_DECLARE(apr_status_t) apr_proc_mutex_lock(apr_proc_mutex_t *mutex)
877  {
*878      return mutex->meth->acquire(mutex);    #<=====line 878*
879  }


static apr_status_t proc_mutex_sysv_acquire(apr_proc_mutex_t *mutex)
{
    int rc;

    do {
        rc = semop(mutex->interproc->filedes, &proc_mutex_op_on, 
1);       *#<=====line 226*
    } while (rc < 0 && errno == EINTR);
    if (rc < 0) {
        return errno;
    }
    mutex->curr_locked = 1;
    return APR_SUCCESS;
}


Can you detect what might be an issue from?

Wayne

Graham Dumpleton wrote:
> On 19 March 2010 07:48, wayne collier <Wayne.Collier@noaa.gov> wrote:
>   
>> Graham -my understanding of RH apache  is  modules have to   explicitly
>> loaded  in httpd.con file.  I check all the snippet  files  and  no  php
>> shared object file is being loaded.  I noticed before that did not seem to
>> have any mod_authz_ldap shared object loaded in my configuration file. Do I
>> need to set things up like i am doing authorization and authentication thru
>> apache?  Is possible that needs to be included?
>>
>> Also, I went thru some of the troubleshooting steps. I ran my web code to
>> reproduce the seg fault and then gbc to attach the process id.  I got the
>> following before getting really lost here. Any suggestions here would
>> greatly appreciated. Thanks.
>>
>> Wayne
>>
>> GBD WORK .....
>>
>> Detaching from program: /usr/local/httpd-2.2.11/bin/httpd, process 18421
>> [root@mingus psp]# gdb /usr/local/httpd-2.2.11/bin/httpd 18421
>> GNU gdb Fedora (6.8-37.el5)
>> Copyright (C) 2008 Free Software Foundation, Inc.
>> License GPLv3+: GNU GPL version 3 or later
>> <http://gnu.org/licenses/gpl.html>
>> This is free software: you are free to change and redistribute it.
>> There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
>> and "show warranty" for details.
>> This GDB was configured as "i386-redhat-linux-gnu"...
>> Attaching to program: /usr/local/httpd-2.2.11/bin/httpd, process 18421
>>
>> warning: .dynamic section for "/usr/lib/libgssapi_krb5.so.2" is not at the
>> expected address
>>
>> warning: difference appears to be caused by prelink, adjusting expectations
>>
>> warning: .dynamic section for "/usr/lib/libkrb5.so.3" is not at the expected
>> address
>>
>> warning: difference appears to be caused by prelink, adjusting expectations
>>
>> warning: .dynamic section for "/lib/libcom_err.so.2" is not at the expected
>> address
>>
>> warning: difference appears to be caused by prelink, adjusting expectations
>>
>> warning: .dynamic section for "/usr/lib/libk5crypto.so.3" is not at the
>> expected address
>>
>> warning: difference appears to be caused by prelink, adjusting expectations
>>
>> warning: .dynamic section for "/lib/libresolv.so.2" is not at the expected
>> address
>>
>> warning: difference appears to be caused by prelink, adjusting expectations
>>
>> warning: .dynamic section for "/usr/lib/libkrb5support.so.0" is not at the
>> expected address
>>
>> warning: difference appears to be caused by prelink, adjusting expectations
>>
>> warning: .dynamic section for "/lib/libkeyutils.so.1" is not at the expected
>> address
>>
>> warning: difference appears to be caused by prelink, adjusting expectations
>>
>> warning: .dynamic section for "/lib/libselinux.so.1" is not at the expected
>> address
>>
>> warning: difference appears to be caused by prelink, adjusting expectations
>>
>> warning: .dynamic section for "/lib/libsepol.so.1" is not at the expected
>> address
>>
>> warning: difference appears to be caused by prelink, adjusting expectations
>>
>> warning: .dynamic section for "/usr/lib/liblber-2.3.so.0" is not at the
>> expected address
>>
>> warning: difference appears to be caused by prelink, adjusting expectations
>> Reading symbols from /lib/libm.so.6...done.
>> Loaded symbols for /lib/libm.so.6
>> Reading symbols from /usr/local/httpd-2.2.11/lib/libaprutil-1.so.0...done.
>> Loaded symbols for /usr/local/httpd-2.2.11/lib/libaprutil-1.so.0
>> Reading symbols from /lib/libexpat.so.0...done.
>> Loaded symbols for /lib/libexpat.so.0
>> Reading symbols from /usr/local/httpd-2.2.11/lib/libapr-1.so.0...done.
>> Loaded symbols for /usr/local/httpd-2.2.11/lib/libapr-1.so.0
>> Reading symbols from /lib/libuuid.so.1...done.
>> Loaded symbols for /lib/libuuid.so.1
>> Reading symbols from /lib/librt.so.1...done.
>> Loaded symbols for /lib/librt.so.1
>> Reading symbols from /lib/libcrypt.so.1...done.
>> Loaded symbols for /lib/libcrypt.so.1
>> Reading symbols from /lib/libpthread.so.0...done.
>> [Thread debugging using libthread_db enabled]
>> [New Thread 0x135700 (LWP 18421)]
>> Loaded symbols for /lib/libpthread.so.0
>> Reading symbols from /lib/libdl.so.2...done.
>> Loaded symbols for /lib/libdl.so.2
>> Reading symbols from /lib/libc.so.6...done.
>> Loaded symbols for /lib/libc.so.6
>> Reading symbols from /lib/ld-linux.so.2...done.
>> Loaded symbols for /lib/ld-linux.so.2
>> Reading symbols from /lib/libnss_files.so.2...done.
>> Loaded symbols for /lib/libnss_files.so.2
>>
>>
>> (gdb) print PyRun_SimpleString("import traceback; traceback.print_stact()")
>>
>> Program received signal SIGSEGV, Segmentation fault.
>> PyImport_AddModule (name=0x5596b3 "__main__") at Python/import.c:366
>> 366             PyInterpreterState *interp = PyThreadState_GET()->interp;
>> The program being debugged was signaled while in a function called from GDB.
>> GDB remains in the frame where the signal was received.
>> To change this behavior use "set unwindonsignal on"
>> Evaluation of the expression containing the function (PyRun_SimpleString)
>> will be abandoned.
>> (gdb)
>>     
>
> I don't want a Python stack trace, I want a C stack trace as
> documented in that page I sent you to. Use:
>
>   (gdb) thread apply all bt
>
> Graham
>
>   
>> Graham Dumpleton wrote:
>>
>> On 13 March 2010 11:28, wayne collier <Wayne.Collier@noaa.gov> wrote:
>>
>>
>> Okay I am running RH linux and I don't seem to have mod_ldap or
>> mod_authnz_ldap shared objects loaded in my httpd.conf file.
>>
>>
>> They may not be loaded from httpd.conf but from a configuration file
>> snippet loaded into Apache. I don't know RH Apache configuration
>> layout, but check all snippet files in subdirectories to the
>> httpd.conf directory.
>>
>> The conflict may also be because you are loading mod_php.
>>
>> Ultimately you may have to use gdb to work out exactly where it
>> crashes. Hopefully not too much symbol information has been stripped
>> and gdb will be able to tell you from which library LDAP code that is
>> crashing is coming from.
>>
>> Use first documented procedure for running Apache in single process
>> under gdb in:
>>
>>
>> http://code.google.com/p/modwsgi/wiki/DebuggingTechniques#Debugging_Crashes_With_GDB
>>
>> This is for mod_wsgi, but same can be done for mod_python.
>>
>> Graham
>>
>>
>>
>> Also I ran ldd
>> and got the following results:
>>
>>
>>
>>
>> ldd /usr/local/httpd-2.2.11/bin/httpd
>>
>>
>>     linux-gate.so.1 =>  (0x00157000)
>>     libm.so.6 => /lib/libm.so.6 (0x00ce8000)
>>     libaprutil-1.so.0 => /usr/local/httpd-2.2.11/lib/libaprutil-1.so.0
>> (0x00315000)
>>     libexpat.so.0 => /lib/libexpat.so.0 (0x00d70000)
>>     libapr-1.so.0 => /usr/local/httpd-2.2.11/lib/libapr-1.so.0 (0x00844000)
>>     libuuid.so.1 => /lib/libuuid.so.1 (0x002f2000)
>>     librt.so.1 => /lib/librt.so.1 (0x00d65000)
>>     libcrypt.so.1 => /lib/libcrypt.so.1 (0x07e07000)
>>     libpthread.so.0 => /lib/libpthread.so.0 (0x00d17000)
>>     libdl.so.2 => /lib/libdl.so.2 (0x00d11000)
>>     libc.so.6 => /lib/libc.so.6 (0x00ba0000)
>>     /lib/ld-linux.so.2 (0x00b82000)
>>
>>
>>
>> ldd /usr/local/httpd-2.2.11/modules/mod_python.so
>>
>>
>>     linux-gate.so.1 =>  (0x00aec000)
>>     libpthread.so.0 => /lib/libpthread.so.0 (0x00730000)
>>     libdl.so.2 => /lib/libdl.so.2 (0x0027f000)
>>     libutil.so.1 => /lib/libutil.so.1 (0x00f70000)
>>     libm.so.6 => /lib/libm.so.6 (0x009b1000)
>>     libc.so.6 => /lib/libc.so.6 (0x00110000)
>>     /lib/ld-linux.so.2 (0x00b82000)
>>
>> I don't seem to have anything with ldap listed. Am I on the right track.?
>>
>>
>> Wayne
>>
>> Graham Dumpleton wrote:
>>
>> A segmentation fault can occur for other reasons. If it is happening
>> when you use LDAP, it could be a conflict in versions of LDAP
>> libraries being used by Apache or PHP and Python LDAP module.
>>
>> You should use the 'ldd' command to determine what LDAP shared library
>> is used by mod_authnz_ldap and compare that to the LDAP library being
>> used by the C extension module component of the Python module you are
>> using to access LDAP. Similarly find any PHP extension modules which
>> use LDAP and look at those.
>>
>> If mod_authnz_ldap is loaded into Apache and you don't need it, then
>> don't load it and see if problem goes away. Also try not loading PHP
>> if it is being loaded. Narrow down which is in conflict.
>>
>> As far as I remember, Apache itself doesn't link to LDAP library and
>> even possible that mod_authnz_ldap uses an internal LDAP library
>> rather than linking external library. All the same even use ldd on
>> Apache binary itself to see which LDAP library may be linked.
>>
>> Graham
>>
>> On 10 March 2010 04:18, wayne collier <Wayne.Collier@noaa.gov> wrote:
>>
>>
>> Okay I guess I will look else where. However, I keep getting segmentation
>> faults when try an execute the ldap command
>>
>> t=l.simple_bind_s(dn,pw). It is only line of code that crashes. If the have
>> the classic expat problem, would that mean I would get a segmentation
>> fault problem from the start.  Also, ldap script works okay as a stand alone
>> script. Thanks.
>>
>> Wayne
>>
>>
>> Graham Dumpleton wrote:
>>
>> That is not your problem, quoting:
>>
>> http://code.google.com/p/modwsgi/wiki/IssuesWithExpatLibrary
>>
>> which is more up to date in respect of this issue, even if the
>> mod_wsgi variant of that document:
>>
>> """Note that this only applies to Python versions prior to Python 2.5.
>> >From Python 2.5 onwards, the copy of the "expat" library bundled in
>> with Python is name space prefixed, thereby avoid name clashes with an
>> "expat" library which has previously been loaded."""
>>
>> You are using Python 2.6, so you cannot be affected by this problem.
>>
>> Graham
>>
>> On 9 March 2010 05:54, wayne collier <Wayne.Collier@noaa.gov> wrote:
>>
>>
>> Hello all. I need some help solving the dreaded segmentation fault that has
>> cropped several time on this board. I have read the link
>> http://www.dscpl.com.au/wiki/ModPython/Articles/ExpatCausingApacheCrash and
>> followed the step and have uncovered the following.
>>
>>
>>
>>
>> ldd    /usr/local/httpd-2.2.11/bin/httpd | grep expat
>>
>>
>>     libexpat.so.0 => /lib/libexpat.so.0 (0x00d70000)
>>
>>
>>
>> strings /lib/libexpat.so.0  | grep expat_
>>
>>
>> expat_1.95.8
>>
>>
>>
>>   ps aux | grep http | head -3
>>
>>
>> webuser  14986  0.0  2.1  54236 19048 ?        S    Mar04   0:01
>> /usr/local/httpd-2.2.11/bin/httpd -d /usr/local/httpd-2.2.11 -f
>> /usr/local/httpd-2.2.11/conf/httpd.conf
>> webuser  14987  0.0  3.2 144128 29540 ?        S    Mar04   0:01
>> /usr/local/httpd-2.2.11/bin/httpd -d /usr/local/httpd-2.2.11 -f
>> /usr/local/httpd-2.2.11/conf/httpd.conf
>> webuser  14998  0.0  3.2 144212 29660 ?        S    Mar04   0:01
>> /usr/local/httpd-2.2.11/bin/httpd -d /usr/local/httpd-2.2.11 -f
>> /usr/local/httpd-2.2.11/conf/httpd.conf
>>
>>
>>
>>   /usr/sbin/lsof -p 14986 | grep expat
>>
>>
>> httpd   14986 webuser  mem    REG     3,5   572313  972637
>> /opt/Python/lib/python2.6/lib-dynload/pyexpat.so
>> httpd   14986 webuser  mem    REG     3,5   133120 1883791
>> /lib/libexpat.so.0.5.0
>>
>> I am not sure why I get 2 shared libaries here.
>>
>>
>>
>>   strings  /lib/libexpat.so.0.5.0 | grep expat_
>>
>>
>> expat_1.95.8
>>
>>
>>
>>
>> strings /opt/Python/lib/python2.6/lib-dynload/pyexpat.so | grep expat_
>>
>>
>> pyexpat.expat_CAPI 1.0
>> expat_CAPI
>> expat_2.0.0
>>
>>
>>
>>
>> import pyexpat
>> pyexpat.version_info
>>
>>
>> (2, 0, 0)
>>
>>
>> So it seems like I need get expat_1.95.8 apache is using up to expat_2.0.0.
>> Can I simply try replacing the 1.95.8 library with 2.0.0. Or do I have
>> recompile with Apache? If I do recompile I need to recompile apache with
>> mod_python as well?
>>
>>
>>
>>
>>
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>
>>
>>
>>
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>
>>
>>
>>
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>
>>
>>
>>     
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>   

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20100322/55c34695/attachment-0001.html
From graham.dumpleton at gmail.com  Mon Mar 22 21:48:46 2010
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Mar 22 21:48:51 2010
Subject: [mod_python] Re: Upgrading expat for apache question
In-Reply-To: <4BA7B50A.5040108@noaa.gov>
References: <4B9547D8.5020802@noaa.gov>
	<88e286471003081446r5ba3da58tc5183beabadba30f@mail.gmail.com>
	<4B9682F8.8040503@noaa.gov>
	<88e286471003091416w74f87d44w8f4e4d0d0aab4416@mail.gmail.com>
	<4B9ADC41.3010000@noaa.gov>
	<88e286471003121909ve3ab1c4gda060385c57d21c4@mail.gmail.com>
	<4BA291A7.3050103@noaa.gov>
	<88e286471003200406m6e34b0dfv787cc41548099a79@mail.gmail.com>
	<4BA7B50A.5040108@noaa.gov>
Message-ID: <88e286471003221848i73d79c4exbff385be85da1748@mail.gmail.com>

On 23 March 2010 05:20, wayne collier <Wayne.Collier@noaa.gov> wrote:
> Okay Graham.? I ran the "thread apply all bt" that dicuss in the link and
> got the following:

That looks to be showing where the process got interrupted when you
attached gdb from what I can tell as got nothing to do with your ldap
code.

If you are going to access running process. You need to configure
Apache to only start a single child process.

Once attached to the child process, go 'cont' in gdb and then trigger
the request which causes it to crash. This will interrupt the gdb
session again and then you can generate the stack trace using 'where'
for current thread, or 'thread apply all bt' if need be to dump stack
for all threads.

Is this what you posted the stack trace from after doing the request
and it crashing?

Graham

> (gdb) thread apply all bt
>
> Thread 1 (Thread 0x135700 (LWP 28732)):
> #0? 0x001ef402 in __kernel_vsyscall ()
> #1? 0x00c735bb in semop () from /lib/libc.so.6
> #2? 0x0012420a in proc_mutex_sysv_acquire (mutex=0x134934)
> ??? at locks/unix/proc_mutex.c:226
> #3? 0x00123242 in apr_proc_mutex_lock (mutex=0x9123098)
> ??? at locks/unix/proc_mutex.c:878
> ---Type <return> to continue, or q <return> to quit---
> #4? 0x081ac7a0 in child_main (child_num_arg=<value optimized out>)
> ??? at prefork.c:205
> #5? 0x081acb77 in make_child (s=0x909d9a8, slot=12) at prefork.c:746
> #6? 0x081ad4d0 in ap_mpm_run (_pconf=0x90960a8, plog=0x90d41a0, s=0x909d9a8)
> ??? at prefork.c:881
> #7? 0x08088945 in main (argc=151601312, argv=0x91d5338) at main.c:740
> (gdb)
>
>
> The line 740 and 741 of? main.c is as follows:
>
> 740 ???? if (ap_mpm_run(pconf, plog, server_conf))
> 741 ?????????? break;
>
> Here are the lines from prefolk.c:
>
> 881??????????????? make_child(ap_server_conf, free_slots[i]);
> 746??????? child_main(slot);
> 205??? apr_status_t rv = apr_proc_mutex_lock(accept_mutex);
>
>
> Here are the lines from locks/unix/proc_mutex.c :
>
> 876? APR_DECLARE(apr_status_t) apr_proc_mutex_lock(apr_proc_mutex_t *mutex)
> 877? {
> 878????? return mutex->meth->acquire(mutex);??? #<=====line 878
> 879? }
>
>
> static apr_status_t proc_mutex_sysv_acquire(apr_proc_mutex_t *mutex)
> {
> ??? int rc;
>
> ??? do {
> ??????? rc = semop(mutex->interproc->filedes, &proc_mutex_op_on, 1);
> #<=====line 226
> ??? } while (rc < 0 && errno == EINTR);
> ??? if (rc < 0) {
> ??????? return errno;
> ??? }
> ??? mutex->curr_locked = 1;
> ??? return APR_SUCCESS;
> }
>
>
> Can you detect what might be an issue from?
>
> Wayne
>
> Graham Dumpleton wrote:
>
> On 19 March 2010 07:48, wayne collier <Wayne.Collier@noaa.gov> wrote:
>
>
> Graham -my understanding of RH apache? is? modules have to?? explicitly
> loaded? in httpd.con file.? I check all the snippet? files? and? no? php
> shared object file is being loaded.? I noticed before that did not seem to
> have any mod_authz_ldap shared object loaded in my configuration file. Do I
> need to set things up like i am doing authorization and authentication thru
> apache?? Is possible that needs to be included?
>
> Also, I went thru some of the troubleshooting steps. I ran my web code to
> reproduce the seg fault and then gbc to attach the process id.? I got the
> following before getting really lost here. Any suggestions here would
> greatly appreciated. Thanks.
>
> Wayne
>
> GBD WORK .....
>
> Detaching from program: /usr/local/httpd-2.2.11/bin/httpd, process 18421
> [root@mingus psp]# gdb /usr/local/httpd-2.2.11/bin/httpd 18421
> GNU gdb Fedora (6.8-37.el5)
> Copyright (C) 2008 Free Software Foundation, Inc.
> License GPLv3+: GNU GPL version 3 or later
> <http://gnu.org/licenses/gpl.html>
> This is free software: you are free to change and redistribute it.
> There is NO WARRANTY, to the extent permitted by law.? Type "show copying"
> and "show warranty" for details.
> This GDB was configured as "i386-redhat-linux-gnu"...
> Attaching to program: /usr/local/httpd-2.2.11/bin/httpd, process 18421
>
> warning: .dynamic section for "/usr/lib/libgssapi_krb5.so.2" is not at the
> expected address
>
> warning: difference appears to be caused by prelink, adjusting expectations
>
> warning: .dynamic section for "/usr/lib/libkrb5.so.3" is not at the expected
> address
>
> warning: difference appears to be caused by prelink, adjusting expectations
>
> warning: .dynamic section for "/lib/libcom_err.so.2" is not at the expected
> address
>
> warning: difference appears to be caused by prelink, adjusting expectations
>
> warning: .dynamic section for "/usr/lib/libk5crypto.so.3" is not at the
> expected address
>
> warning: difference appears to be caused by prelink, adjusting expectations
>
> warning: .dynamic section for "/lib/libresolv.so.2" is not at the expected
> address
>
> warning: difference appears to be caused by prelink, adjusting expectations
>
> warning: .dynamic section for "/usr/lib/libkrb5support.so.0" is not at the
> expected address
>
> warning: difference appears to be caused by prelink, adjusting expectations
>
> warning: .dynamic section for "/lib/libkeyutils.so.1" is not at the expected
> address
>
> warning: difference appears to be caused by prelink, adjusting expectations
>
> warning: .dynamic section for "/lib/libselinux.so.1" is not at the expected
> address
>
> warning: difference appears to be caused by prelink, adjusting expectations
>
> warning: .dynamic section for "/lib/libsepol.so.1" is not at the expected
> address
>
> warning: difference appears to be caused by prelink, adjusting expectations
>
> warning: .dynamic section for "/usr/lib/liblber-2.3.so.0" is not at the
> expected address
>
> warning: difference appears to be caused by prelink, adjusting expectations
> Reading symbols from /lib/libm.so.6...done.
> Loaded symbols for /lib/libm.so.6
> Reading symbols from /usr/local/httpd-2.2.11/lib/libaprutil-1.so.0...done.
> Loaded symbols for /usr/local/httpd-2.2.11/lib/libaprutil-1.so.0
> Reading symbols from /lib/libexpat.so.0...done.
> Loaded symbols for /lib/libexpat.so.0
> Reading symbols from /usr/local/httpd-2.2.11/lib/libapr-1.so.0...done.
> Loaded symbols for /usr/local/httpd-2.2.11/lib/libapr-1.so.0
> Reading symbols from /lib/libuuid.so.1...done.
> Loaded symbols for /lib/libuuid.so.1
> Reading symbols from /lib/librt.so.1...done.
> Loaded symbols for /lib/librt.so.1
> Reading symbols from /lib/libcrypt.so.1...done.
> Loaded symbols for /lib/libcrypt.so.1
> Reading symbols from /lib/libpthread.so.0...done.
> [Thread debugging using libthread_db enabled]
> [New Thread 0x135700 (LWP 18421)]
> Loaded symbols for /lib/libpthread.so.0
> Reading symbols from /lib/libdl.so.2...done.
> Loaded symbols for /lib/libdl.so.2
> Reading symbols from /lib/libc.so.6...done.
> Loaded symbols for /lib/libc.so.6
> Reading symbols from /lib/ld-linux.so.2...done.
> Loaded symbols for /lib/ld-linux.so.2
> Reading symbols from /lib/libnss_files.so.2...done.
> Loaded symbols for /lib/libnss_files.so.2
>
>
> (gdb) print PyRun_SimpleString("import traceback; traceback.print_stact()")
>
> Program received signal SIGSEGV, Segmentation fault.
> PyImport_AddModule (name=0x5596b3 "__main__") at Python/import.c:366
> 366???????????? PyInterpreterState *interp = PyThreadState_GET()->interp;
> The program being debugged was signaled while in a function called from GDB.
> GDB remains in the frame where the signal was received.
> To change this behavior use "set unwindonsignal on"
> Evaluation of the expression containing the function (PyRun_SimpleString)
> will be abandoned.
> (gdb)
>
>
> I don't want a Python stack trace, I want a C stack trace as
> documented in that page I sent you to. Use:
>
>   (gdb) thread apply all bt
>
> Graham
>
>
>
> Graham Dumpleton wrote:
>
> On 13 March 2010 11:28, wayne collier <Wayne.Collier@noaa.gov> wrote:
>
>
> Okay I am running RH linux and I don't seem to have mod_ldap or
> mod_authnz_ldap shared objects loaded in my httpd.conf file.
>
>
> They may not be loaded from httpd.conf but from a configuration file
> snippet loaded into Apache. I don't know RH Apache configuration
> layout, but check all snippet files in subdirectories to the
> httpd.conf directory.
>
> The conflict may also be because you are loading mod_php.
>
> Ultimately you may have to use gdb to work out exactly where it
> crashes. Hopefully not too much symbol information has been stripped
> and gdb will be able to tell you from which library LDAP code that is
> crashing is coming from.
>
> Use first documented procedure for running Apache in single process
> under gdb in:
>
>
> http://code.google.com/p/modwsgi/wiki/DebuggingTechniques#Debugging_Crashes_With_GDB
>
> This is for mod_wsgi, but same can be done for mod_python.
>
> Graham
>
>
>
> Also I ran ldd
> and got the following results:
>
>
>
>
> ldd /usr/local/httpd-2.2.11/bin/httpd
>
>
> ??? linux-gate.so.1 =>? (0x00157000)
> ??? libm.so.6 => /lib/libm.so.6 (0x00ce8000)
> ??? libaprutil-1.so.0 => /usr/local/httpd-2.2.11/lib/libaprutil-1.so.0
> (0x00315000)
> ??? libexpat.so.0 => /lib/libexpat.so.0 (0x00d70000)
> ??? libapr-1.so.0 => /usr/local/httpd-2.2.11/lib/libapr-1.so.0 (0x00844000)
> ??? libuuid.so.1 => /lib/libuuid.so.1 (0x002f2000)
> ??? librt.so.1 => /lib/librt.so.1 (0x00d65000)
> ??? libcrypt.so.1 => /lib/libcrypt.so.1 (0x07e07000)
> ??? libpthread.so.0 => /lib/libpthread.so.0 (0x00d17000)
> ??? libdl.so.2 => /lib/libdl.so.2 (0x00d11000)
> ??? libc.so.6 => /lib/libc.so.6 (0x00ba0000)
> ??? /lib/ld-linux.so.2 (0x00b82000)
>
>
>
> ldd /usr/local/httpd-2.2.11/modules/mod_python.so
>
>
> ??? linux-gate.so.1 =>? (0x00aec000)
> ??? libpthread.so.0 => /lib/libpthread.so.0 (0x00730000)
> ??? libdl.so.2 => /lib/libdl.so.2 (0x0027f000)
> ??? libutil.so.1 => /lib/libutil.so.1 (0x00f70000)
> ??? libm.so.6 => /lib/libm.so.6 (0x009b1000)
> ??? libc.so.6 => /lib/libc.so.6 (0x00110000)
> ??? /lib/ld-linux.so.2 (0x00b82000)
>
> I don't seem to have anything with ldap listed. Am I on the right track.?
>
>
> Wayne
>
> Graham Dumpleton wrote:
>
> A segmentation fault can occur for other reasons. If it is happening
> when you use LDAP, it could be a conflict in versions of LDAP
> libraries being used by Apache or PHP and Python LDAP module.
>
> You should use the 'ldd' command to determine what LDAP shared library
> is used by mod_authnz_ldap and compare that to the LDAP library being
> used by the C extension module component of the Python module you are
> using to access LDAP. Similarly find any PHP extension modules which
> use LDAP and look at those.
>
> If mod_authnz_ldap is loaded into Apache and you don't need it, then
> don't load it and see if problem goes away. Also try not loading PHP
> if it is being loaded. Narrow down which is in conflict.
>
> As far as I remember, Apache itself doesn't link to LDAP library and
> even possible that mod_authnz_ldap uses an internal LDAP library
> rather than linking external library. All the same even use ldd on
> Apache binary itself to see which LDAP library may be linked.
>
> Graham
>
> On 10 March 2010 04:18, wayne collier <Wayne.Collier@noaa.gov> wrote:
>
>
> Okay I guess I will look else where. However, I keep getting segmentation
> faults when try an execute the ldap command
>
> t=l.simple_bind_s(dn,pw). It is only line of code that crashes. If the have
> the classic expat problem, would that mean I would get a segmentation
> fault problem from the start.  Also, ldap script works okay as a stand alone
> script. Thanks.
>
> Wayne
>
>
> Graham Dumpleton wrote:
>
> That is not your problem, quoting:
>
> http://code.google.com/p/modwsgi/wiki/IssuesWithExpatLibrary
>
> which is more up to date in respect of this issue, even if the
> mod_wsgi variant of that document:
>
> """Note that this only applies to Python versions prior to Python 2.5.
> >From Python 2.5 onwards, the copy of the "expat" library bundled in
> with Python is name space prefixed, thereby avoid name clashes with an
> "expat" library which has previously been loaded."""
>
> You are using Python 2.6, so you cannot be affected by this problem.
>
> Graham
>
> On 9 March 2010 05:54, wayne collier <Wayne.Collier@noaa.gov> wrote:
>
>
> Hello all. I need some help solving the dreaded segmentation fault that has
> cropped several time on this board. I have read the link
> http://www.dscpl.com.au/wiki/ModPython/Articles/ExpatCausingApacheCrash and
> followed the step and have uncovered the following.
>
>
>
>
> ldd??? /usr/local/httpd-2.2.11/bin/httpd | grep expat
>
>
> ??? libexpat.so.0 => /lib/libexpat.so.0 (0x00d70000)
>
>
>
> strings /lib/libexpat.so.0? | grep expat_
>
>
> expat_1.95.8
>
>
>
> ? ps aux | grep http | head -3
>
>
> webuser? 14986? 0.0? 2.1? 54236 19048 ???????? S??? Mar04?? 0:01
> /usr/local/httpd-2.2.11/bin/httpd -d /usr/local/httpd-2.2.11 -f
> /usr/local/httpd-2.2.11/conf/httpd.conf
> webuser? 14987? 0.0? 3.2 144128 29540 ???????? S??? Mar04?? 0:01
> /usr/local/httpd-2.2.11/bin/httpd -d /usr/local/httpd-2.2.11 -f
> /usr/local/httpd-2.2.11/conf/httpd.conf
> webuser? 14998? 0.0? 3.2 144212 29660 ???????? S??? Mar04?? 0:01
> /usr/local/httpd-2.2.11/bin/httpd -d /usr/local/httpd-2.2.11 -f
> /usr/local/httpd-2.2.11/conf/httpd.conf
>
>
>
> ? /usr/sbin/lsof -p 14986 | grep expat
>
>
> httpd?? 14986 webuser? mem??? REG???? 3,5?? 572313? 972637
> /opt/Python/lib/python2.6/lib-dynload/pyexpat.so
> httpd?? 14986 webuser? mem??? REG???? 3,5?? 133120 1883791
> /lib/libexpat.so.0.5.0
>
> I am not sure why I get 2 shared libaries here.
>
>
>
> ? strings? /lib/libexpat.so.0.5.0 | grep expat_
>
>
> expat_1.95.8
>
>
>
>
> strings /opt/Python/lib/python2.6/lib-dynload/pyexpat.so | grep expat_
>
>
> pyexpat.expat_CAPI 1.0
> expat_CAPI
> expat_2.0.0
>
>
>
>
> import pyexpat
> pyexpat.version_info
>
>
> (2, 0, 0)
>
>
> So it seems like I need get expat_1.95.8 apache is using up to expat_2.0.0.
> Can I simply try replacing the 1.95.8 library with 2.0.0. Or do I have
> recompile with Apache? If I do recompile I need to recompile apache with
> mod_python as well?
>
>
>
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
>

From martijn at xs4us.nu  Tue Mar 30 04:32:45 2010
From: martijn at xs4us.nu (Martijn Moeling)
Date: Tue Mar 30 04:33:05 2010
Subject: [mod_python] mod_python (source compatible) middleware for mod_wsgi
Message-ID: <5D0C2808-EC5E-435F-9BBF-8C93B1256A17@xs4us.nu>

Hi,

Just to advertise my project here the link to the repository on Bitbucket.org:

http://www.bitbucket.org/mmoeling/mp2mwsgi/overview/

MP2MWSGI is an adapter/middleware to run existing ModPython code on top of ModWsgi

Working source code is online now, with an example.wsgi file.

Todo:

Authhandler support (add code for that to Request.py)
modify the MP Session.Py (get around _apache calls)
get Util working (get around the _apache.parse_qs and _apache.parse_qsl calls who can help me with that? Graham?)

No support for Publisher (I have not evaluated a contribution to that part yet)

The repository holds eclipse/pydev project files Install Mercurial eclipse plugin.

Comments are welcome

Martijn



