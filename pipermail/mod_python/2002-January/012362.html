<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Web sessions and threading.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Web%20sessions%20and%20threading.&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012358.html">
   <LINK REL="Next"  HREF="012363.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Web sessions and threading.</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Alan Kennedy</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Web%20sessions%20and%20threading.&In-Reply-To="
       TITLE="[mod_python] Web sessions and threading.">modpython at xhaus.com
       </A><BR>
    <I>Fri Jan 25 09:35:06 EST 2002</I>
    <P><UL>
        <LI>Previous message: <A HREF="012358.html">[mod_python] installing --with-python Python 2.2
</A></li>
        <LI>Next message: <A HREF="012363.html">[mod_python] Web sessions and threading.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12362">[ date ]</a>
              <a href="thread.html#12362">[ thread ]</a>
              <a href="subject.html#12362">[ subject ]</a>
              <a href="author.html#12362">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Greetings All,

I'm putting together a session tracking mechanism for
Apache and mod_python, on Win and Linux. And my mind is
being twisted trying to decide if I need to worry about
thread safety or not.

My confusion arises from trying to juggle the concepts of
the Python Global Interpreter Lock and the way that
Apache handles simultaneous requests.

On Windows, Apache spawns a single child, which then
creates a thread to service every request received. On
Linux, Apache maintains a pool of single-threaded child
processes, which compete to service incoming requests.

So, imagine I have a mod_python handler function, which
is going to extract a session ID from incoming requests,
and use that as a key to retrieve a corresponding session
object from some storage (say, a memory mapped file,
rdbms(?)).

That session object can then be modified by the handler
function, and thus must then be written back to storage.

Since it is possible for two requests from the same
session to be handled by different threads
windows)/processes(linux), I obviously have a concurrent
access problem.

On Linux, there are no threading issues, since all of
the processes serving requests are single-threaded.

However, it is obviously different on multi-threaded 
Windows. On Windows, I don't know if it is possible for
two threads to update the same python object at the same
time, i.e. I don't know the effect of the Global
Interpreter Lock(GIL).

On Windows, the two threads will definitely be run in
the same interpreter (the default configuration for
mod_python).

So, my question: do I need to protect the session objects
against concurrent access from multiple threads (and thus
complicate the code)? Or can I ignore the issue, i.e. is
access to the object serialised by the GIL?

I know I could probably answer my question by reading and
understanding the python and mod_python source code. But I
was hoping someone might be able to give me pointers to
documentation which might throw some light on the scenario?

Many thanks,

Alan.



---------------------------------------------
This message was sent using WebMail by CyberGate.
<A HREF="http://www.gate.net/webmail">http://www.gate.net/webmail</A>



</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012358.html">[mod_python] installing --with-python Python 2.2
</A></li>
	<LI>Next message: <A HREF="012363.html">[mod_python] Web sessions and threading.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12362">[ date ]</a>
              <a href="thread.html#12362">[ thread ]</a>
              <a href="subject.html#12362">[ subject ]</a>
              <a href="author.html#12362">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
