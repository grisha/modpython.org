<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Tutorials, FieldStorage and sys.py. A depressing
	saga.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Tutorials%2C%20FieldStorage%20and%20sys.py.%20A%20depressing%0A%09saga.&In-Reply-To=20030522134004.GA25157%40mx1.neteconomist.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006273.html">
   <LINK REL="Next"  HREF="006269.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Tutorials, FieldStorage and sys.py. A depressing
	saga.</H1>
    <B>Terry MacDonald</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Tutorials%2C%20FieldStorage%20and%20sys.py.%20A%20depressing%0A%09saga.&In-Reply-To=20030522134004.GA25157%40mx1.neteconomist.com"
       TITLE="[mod_python] Tutorials, FieldStorage and sys.py. A depressing
	saga.">terry at i3technologies.co.uk
       </A><BR>
    <I>Thu May 22 19:36:24 EST 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="006273.html">[mod_python] Tutorials, FieldStorage and sys.py. A depressing
	 saga.
</A></li>
        <LI>Next message: <A HREF="006269.html">[mod_python] Tutorials, FieldStorage and sys.py. A depressing
 saga.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6268">[ date ]</a>
              <a href="thread.html#6268">[ thread ]</a>
              <a href="subject.html#6268">[ subject ]</a>
              <a href="author.html#6268">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<table border=0 width="100%"><tr><td>
<!--beginarticle-->
<PRE>Hi again,

Thankyou very much for your replies, You seem a nice bunch in here. 
I look forward to conversing with you over time (hopefully not all bug related!)

Anyways your advice solved one issue but unfortunately moved me on to the next.  
I am reaching the end of my patience as I have tried various work arounds to my 
ills and I just go up more garden paths to more problems (this should not be that 
difficult I know!).

Forgive me but I have decided to post the code to see if you can tell what is wrong 
cos I just can't get it to work as it is supposed to. The code is primarily example 
code but has been rejigged a little while trying to get it to work.

Problems occuring now is that the subn function is giving a mulitple repeat error.
When I comment out the offending code I just get Object not found in the browser. 
Also I have to put full pathnames in for the html files otherwise they cannot be 
found (I know this can't be right - but i'm trying anything to get this to work)

Ultimately the example should print a form, fetch the contents and display them 
back to you in another page (I think!) not exactly rocket science.

Below is the .py file and the two basic html files. Enjoy !

Cheers

Terry

================================================================================
#!/usr/bin/python
                                                                                                              
from mod_python import apache
from mod_python import util
import re
                                                                                                              
# specify the filename of the template file
TemplateFile = &quot;/var/www/html/python/template.html&quot;
                                                                                                              
# Display  takes one parameter - a string to Display
def Display(Content):
    TemplateHandle = open(TemplateFile, &quot;r&quot;)  # open in read only mode
    # read the entire file as a string
    TemplateInput = TemplateHandle.read()
    TemplateHandle.close()                    # close the file
                                                                                                              
    # this defines an exception string in case our
    # template file is messed up
    BadTemplateException = &quot;There was a problem with the HTML template.&quot;
                                                                                                              
    SubResult = re.subn( &quot;&lt;!-- *** INSERT CONTENT HERE *** --&gt;&quot;, Content, TemplateInput )
    if SubResult[1] == 0:
        raise BadTemplateException
                                                                                                              
    print &quot;Content-Type: text/html\n\n&quot;
    print SubResult[0]
                                                                                                              
                                                                                                              
def ProcessForm(req):
                                                                                                              
    form = util.FieldStorage(req)
                                                                                                              
    # extract the information from the form in easily digestible format
    try:
        name = form[&quot;name&quot;].value
    except:
        # name is required, so output an error if
        # not given and exit script
        Display(&quot;You need to at least supply a name. Please go back.&quot;)
        raise SystemExit
    try:
        email = form[&quot;email&quot;].value
    except:
        email = None
    try:
        color = form[&quot;color&quot;].value
    except:
        color = None
    try:
        comment = form[&quot;comment&quot;].value
    except:
        comment = None
                                                                                                              
    Output = &quot;&quot;  # our output buffer, empty at first
                                                                                                              
    Output = Output + &quot;Hello, &quot;
                                                                                                              
    if email != None:
        Output = Output + &quot;&lt;A HREF=mailto:&quot; + email + &quot;&gt;&quot; + name + &quot;&lt;/A&gt;.&lt;P&gt;&quot;
    else:
        Output = Output + name + &quot;.&lt;P&gt;&quot;
                                                                                                              
    if color == &quot;swallow&quot;:
        Output = Output + &quot;You must be a Monty Python fan.&lt;P&gt;&quot;
    elif color != None:
        Output = Output + &quot;Your favorite color was &quot; + color + &quot;&lt;P&gt;&quot;
    else:
        Output = Output + &quot;You cheated!  You didn't specify a color!&lt;P&gt;&quot;
                                                                                                              
    if comment != None:
        Output = Output + &quot;In addition, you said:&lt;BR&gt;&quot; + comment + &quot;&lt;P&gt;&quot;
                                                                                                              
    Display(Output)
                                                                                                              
###
### Begin actual script
###
                                                                                                              
#### &quot;key&quot; is a hidden form element with an
### action command such as &quot;process&quot;
#try:
#    key = form[&quot;key&quot;].value
#    key = form[&quot;key&quot;].value
##except:
#    key = None
                                                                                                              
#if key == &quot;process&quot;:
#    ProcessForm(form)
#else:
#    DisplayForm()
                                                                                                              
# Open and display the form
FormFile = &quot;/var/www/html/python/form2.html&quot;
FormHandle = open(FormFile, &quot;r&quot;)
FormInput = FormHandle.read()
FormHandle.close()
Display(FormInput)
                                                                         
=======================================================================================

Form2.html.........

&lt;FORM METHOD=&quot;POST&quot; ACTION=&quot;sample.py/processform&quot;&gt;
      &lt;INPUT TYPE=HIDDEN NAME=&quot;key&quot; VALUE=&quot;process&quot;&gt;
      Your name:&lt;BR&gt;
      &lt;INPUT TYPE=TEXT NAME=&quot;name&quot; size=60&gt;
      &lt;BR&gt;
      Email: (optional)&lt;BR&gt;
      &lt;INPUT TYPE=TEXT NAME=&quot;email&quot; size=60&gt;
      &lt;BR&gt;
      Favorite Color:&lt;BR&gt;
      &lt;INPUT TYPE=RADIO NAME=&quot;color&quot; VALUE=&quot;blue&quot; CHECKED&gt;Blue
      &lt;INPUT TYPE=RADIO NAME=&quot;color&quot; VALUE=&quot;yellow&quot;&gt;No, Yellow...
      &lt;INPUT TYPE=RADIO NAME=&quot;color&quot; VALUE=&quot;swallow&quot;&gt;What do you mean, an African or European swallow?
      &lt;P&gt;
      Comments:&lt;BR&gt;
      &lt;TEXTAREA NAME=&quot;comment&quot; ROWS=8 COLS=60&gt;
      &lt;/TEXTAREA&gt;
      &lt;P&gt;
        &lt;INPUT TYPE=&quot;SUBMIT&quot; VALUE=&quot;Okay&quot;&gt;
&lt;/FORM&gt;
=======================================================================================
Template.html........

&lt;!DOCTYPE HTML PUBLIC &quot;-//IETF//DTD HTML//EN&quot;&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;META NAME=&quot;keywords&quot; CONTENT=&quot;blah blah -- your ad here&quot;&gt;
    &lt;title&gt;Python is Fun!&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
                &lt;!-- *** INSERT CONTENT HERE *** --&gt;
  &lt;/body&gt;
&lt;/html&gt;
                                                                                                              


</PRE>
<!--endarticle-->
</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006273.html">[mod_python] Tutorials, FieldStorage and sys.py. A depressing
	 saga.
</A></li>
	<LI>Next message: <A HREF="006269.html">[mod_python] Tutorials, FieldStorage and sys.py. A depressing
 saga.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6268">[ date ]</a>
              <a href="thread.html#6268">[ thread ]</a>
              <a href="subject.html#6268">[ subject ]</a>
              <a href="author.html#6268">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
