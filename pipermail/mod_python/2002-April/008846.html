<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] .value in FieldStorage
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20.value%20in%20FieldStorage&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008845.html">
   <LINK REL="Next"  HREF="008847.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
<table border=0 width="100%"><tr><td valign="top">
   <H1>[mod_python] .value in FieldStorage</H1>
    <B>Markus Demleitner</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20.value%20in%20FieldStorage&In-Reply-To="
       TITLE="[mod_python] .value in FieldStorage">msdemlei at cl.uni-heidelberg.de
       </A><BR>
    <I>Wed Apr 17 20:55:12 EST 2002</I>
    <P><UL>
        <LI>Previous message: <A HREF="008845.html">[mod_python] Simulating non parsed header scripts
</A></li>
        <LI>Next message: <A HREF="008847.html">[mod_python] .value in FieldStorage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8846">[ date ]</a>
              <a href="thread.html#8846">[ thread ]</a>
              <a href="subject.html#8846">[ subject ]</a>
              <a href="author.html#8846">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I'm again working on my project of migrating from CGI to mod_python.
This time, it's FieldStorage.  For some reason, FieldStorage.__getitem__
may return strings instead of fields.  When you want to keep your
classes compatible with cgi's FieldStorage, that's of course a
major showstopper, since every access to the value attribute
raises an exception.

As an emergency patch (I needed to get this done, since some
gadget of mine was causing excessive server loads when it
didn't need to), I added

import UserString

class StringWithValue(UserString.UserString):
  def __init__(self, val):
    UserString.UserString.__init__(self, val)
    self.value = val

at the top of util.py and changed then end of FieldStorage's
__getitem__ to
        if len(found) == 1:
          if isinstance(found[0], Field):
            return found[0]
          else:
            return StringWithValue(found[0])
        else:
          return found


This is of course super-ugly and will break when someone updates
mod_python.

Is FieldStorage's behaviour again due to my stupidity?  If not,
are there any plans to change it so it always returns Fields?

Cheers,

       Markus

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008845.html">[mod_python] Simulating non parsed header scripts
</A></li>
	<LI>Next message: <A HREF="008847.html">[mod_python] .value in FieldStorage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8846">[ date ]</a>
              <a href="thread.html#8846">[ thread ]</a>
              <a href="subject.html#8846">[ subject ]</a>
              <a href="author.html#8846">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
