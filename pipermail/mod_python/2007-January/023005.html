<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Several handlers
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Several%20handlers&In-Reply-To=45AB4C4A.8469.14ED24E4%40export.hope.cz">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023004.html">
   <LINK REL="Next"  HREF="023008.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Several handlers</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Several%20handlers&In-Reply-To=45AB4C4A.8469.14ED24E4%40export.hope.cz"
       TITLE="[mod_python] Several handlers">grahamd at dscpl.com.au
       </A><BR>
    <I>Mon Jan 15 04:14:36 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="023004.html">[mod_python] Several handlers
</A></li>
        <LI>Next message: <A HREF="023008.html">[mod_python] Several handlers- not releasing memory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23005">[ date ]</a>
              <a href="thread.html#23005">[ thread ]</a>
              <a href="subject.html#23005">[ subject ]</a>
              <a href="author.html#23005">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On 15/01/2007, at 7:41 PM, <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">export at hope.cz</A> wrote:

&gt;<i>  Graham,
</I>&gt;<i> Thank you for your reply and help.
</I>&gt;<i>  So,now my input filter looks like this:
</I>&gt;<i>
</I>&gt;<i>  def inputfilter(filter):
</I>&gt;<i>      if filter.req.method != 'POST':
</I>&gt;<i>          filter.pass_on()
</I>&gt;<i>          return
</I>&gt;<i>      filter.req.log_error('first read')
</I>&gt;<i>      s = filter.read()
</I>&gt;<i>      while s:
</I>&gt;<i>          filter.req.log_error('writing (%s)' % len(s))
</I>&gt;<i>          filter.write(s)
</I>&gt;<i>          s = filter.read()
</I>&gt;<i>      if s is None:
</I>&gt;<i>          filter.req.log_error('closing')
</I>&gt;<i>          filter.close()
</I>&gt;<i>
</I>&gt;<i>  When I check error log I can see list of
</I>&gt;<i>   writing (8000)
</I>&gt;<i>  which could be good.I think it says that data is read /write in  
</I>&gt;<i> 8000bytes chunks.
</I>&gt;<i>
</I>&gt;<i>  But still memory is NOT released but increases in the process of  
</I>&gt;<i> reading.
</I>&gt;<i>  Should  memory be released after each writing?
</I>&gt;<i>  What should I check to find out the  reason that  causes resources  
</I>&gt;<i> are run out?
</I>&gt;<i>  Thank you for helo and reply
</I>
Are you still running Django as the content handler? Are you sure that
the increase in memory size isn't something to do with Django?

Instead of running Django as the response handler write a small
custom handler which does:

def handler(req):
   req.content_type = 'text/plain'
   req.write(req.read())
   return apache.OK

You will then need to create a static HTML page with a POST form that
posts to the URL which matches the handler. This should have the
result of exercising the filter with the contents of the POST being
returned as the response.

See if that small example still uses increasing resources.

Graham
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023004.html">[mod_python] Several handlers
</A></li>
	<LI>Next message: <A HREF="023008.html">[mod_python] Several handlers- not releasing memory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23005">[ date ]</a>
              <a href="thread.html#23005">[ thread ]</a>
              <a href="subject.html#23005">[ subject ]</a>
              <a href="author.html#23005">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
