From rekla_ma_ at publicist.com  Sun Jul  1 19:43:52 2001
From: rekla_ma_ at publicist.com (E-mail Reklama)
Date: Fri Jan  9 21:46:23 2004
Subject: [mod_python] =?windows-1251?Q?E-mail_-_=F0=E5=EA=EB=E0=EC=E0?=
Message-ID: <181362001701154352292@publicist.com>

????????????!

? ?????? ??????? ??????? ?? ????? ?? ?????? ??????????? ??????? ???? ???????, ? ??????? ?? ????? ???????????. ??? ????? ???????? ??????????? ???????? ????? ????????? ?????????? ?? ????????? ??????? ??????? (?? 30???. ?? 1???., ??? ?? ??????, ??? ? ?? ???? ?????? ? ???). ??????????? ?????????/?????? ??? ???? ????? ????? ??????.

?? ??????????????? ?????????? ???????????? ?????????? 4 ????. ???? ?????????? ??????? - ?????????? ????????? ????????, ??????? ????? ??????, ??? ????????????? e-mail ???????? ??-?? ?????? ?????? ????????? ?????????? ???? ? ???????? ?? ??????????? ???????????! ???????, ?????????? ???????? ???? ???, ?????????? ? ??? ????? ? ?????. ?????? ?????? ??????? ?????? e-mail ???????, ?? ??????????? ????? ?? ?? ??????????? (???, ??????, ? ???? ????????) ?? ????? ? ?????????? ????????? ??? ???????????????, ??? ??? ?? ????? ????? ? ??????????? ????????? ??? ????????????? ???????????????? ????????. ? ?????? ??????, ??? ???????? ????????? ?????? ????????? ?????????? ?????, ??? ???? ????? ???? ????? ? ?????????? ???????? ?? ?????? ????????????.

?? ????? ??? ??? e-mail ??????? ? ????? ??? ??? ????, ????? ???????? ??? ???????? ?? ???? ?????? ??? ?????????. ??? ??????? ???? ??????????????????? ??????????? ? ???????????????? ?????? ??????? ? ???????? ? ?????????? ??????, ??????????? ???????? smtp-??????? ?? ???????, ? ????? ??????????? ???????????? ????????? ? ???-??? ?  ???? ???????.

?? ????? ?????? ???????? ???, ??? ??? ????? ?? ???????? ?????? ??????.

???? ?? ??????????????? ? ????????? ? ?????? ???????? ?? ??? ????? ?????? ??????????, ???????? ?????? ? ???????????? ????? ? ???? ??????, ????? ? ????? ???????? ????????? "????????", ??? ?? ??????: reklama@publicist.com.

??? ???? ? ???? "???? ?????????" ??????????? ???????: "????????".




From woodm at equire.com  Tue Jul  3 00:14:32 2001
From: woodm at equire.com (Matthew Wood)
Date: Fri Jan  9 21:46:23 2004
Subject: [mod_python] Session data (Sorry for bringing this up again...)
Message-ID: <16299780187.20010703001432@equire.com>

Hello  all.   I  would  like  to  apologize  for bringing up the whole
session thing again.  However, I have a somewhat specific question.

I guess my question has more to do with persistent data in general.

One of the main reasons that one would keep persistent data is to keep
database connections open.  (Or any connection for that matter)
The other is to keep session data on the users of your site.

Obviously,   the session data can be kept in the database, and the key
to  the  table can be kept in a cookie or passed via the url.  (That's
one way to do it, there are many ways, including a text-file-pickeling
based scheme, but I think that a database would work quite well.)

However,  the  problem  is that you can't keep database connections in
the  database.   All  the other persistent data can be kept there, but
not the database connection.

The  problem  with  persistent  data in general is the multiple memory
spaces  used  by  apache.   But  it  would be a shame to re-create the
database  connection every single time someone logs into a page.  That
just seems ridiculous to me.

This brings me to my question:
Would  it  be appropriate to keep a database connection in each of the
memory  spaces?

Such  a connection is not very dynamic (I think) and thus you wouldn't
have to worry about having different types of connections or different
values of connections in the different memory spaces. (As you would if
you stored session data, that changes often.)

What  would be the down side to such an arrangement?  I would probably
need to create a method to time out the connections, so they don't sit
there  forever  if  I change something...  Is that correct?  What am I
missing?


Once  again, let me apologize for bringing up the session issue again.
I  have read all the posts here for the last few months, and I thought
I would see what the up/down sides to this plan would be.



From woodm at equire.com  Tue Jul  3 00:20:40 2001
From: woodm at equire.com (Matthew Wood)
Date: Fri Jan  9 21:46:23 2004
Subject: [mod_python] HTMLgen
Message-ID: <67100148213.20010703002040@equire.com>

I don't know how many of you are familiar with HTMLgen, but it's a set
of objects which aid in the construction of web-pages.

My question is this:

How useful would it be to integrate HTMLgen into a handler, instead of
importing it in each page I write?

The import statement, as well as the initial instanciation of the page
object  (I  can't remember exactly what the name of the object is...).
One  could  even  call  the  'Print  self'  function at the end of the
handler.

Would  this  help anything?  Would it make anything run faster?  Would
it make the code more readable?  Would this be a good idea at all?


I have hardly any experience with mod-python or mod-snake, so I really
don't have enough experience to answer this question.

Thanks in advance for all your help.



From benno at sesgroup.net  Tue Jul  3 16:24:54 2001
From: benno at sesgroup.net (Ben Leslie)
Date: Fri Jan  9 21:46:23 2004
Subject: [mod_python] Session data (Sorry for bringing this up again...)
In-Reply-To: <16299780187.20010703001432@equire.com>; from woodm@equire.com on Tue, Jul 03, 2001 at 12:14:32AM -0600
References: <16299780187.20010703001432@equire.com>
Message-ID: <20010703162453.C11798@sesgroup.net>

On Tue, 03 Jul 2001, Matthew Wood wrote:

<snip>

>
> This brings me to my question:
> Would  it  be appropriate to keep a database connection in each of the
> memory  spaces?


Yes. This is exactly what I do.

In your handler you have a global variable holding the db connection. In 
the handler you check the db handler is alive and recreate if necessary 
(this should really only happen the first time that process is used)

Benno

From piet at cs.uu.nl  Tue Jul  3 09:51:00 2001
From: piet at cs.uu.nl (piet@cs.uu.nl)
Date: Fri Jan  9 21:46:23 2004
Subject: [mod_python] Session data (Sorry for bringing this up again...)
In-Reply-To: Ben Leslie's message of "Tue, 3 Jul 2001 16:24:54 +1000"
References: <16299780187.20010703001432@equire.com>
	<20010703162453.C11798@sesgroup.net>
Message-ID: <u3d8esb6j.fsf@cs.uu.nl>

>>>>> Ben Leslie <benno@sesgroup.net> (BL) writes:

BL> On Tue, 03 Jul 2001, Matthew Wood wrote:
BL> <snip>

>> 
>> This brings me to my question:
>> Would  it  be appropriate to keep a database connection in each of the
>> memory  spaces?


BL> Yes. This is exactly what I do.

BL> In your handler you have a global variable holding the db connection. In 
BL> the handler you check the db handler is alive and recreate if necessary 
BL> (this should really only happen the first time that process is used)

You would have to be careful with multithreading. This applies to Apache on
MS Windows and with 2.0 also on Unix systems. You would need a connection
per thread. Or have a pool where each thread can try to grab a connection.
The pool administration would have to be protected with semaphores or locks
or similar. 
-- 
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl


From vincentwong at ionetbiz.com  Tue Jul  3 16:37:52 2001
From: vincentwong at ionetbiz.com (Vincent Wong)
Date: Fri Jan  9 21:46:23 2004
Subject: [mod_python] Error: No such file or directory
Message-ID: <00ae01c1039b$72f11160$3f00a8c0@ns1.ionetbiz.com>



I encountered the following error when I called the module test.py with  "test.py/saveform":



----
Mod_python error: "PythonHandler mod_python.publisher"

Traceback (most recent call last):

  File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line 193, in Dispatch
    result = object(req)

  File "/usr/local/lib/python2.1/site-packages/mod_python/publisher.py", line 128, in handler
    module = apache.import_module(module_name, _req, [path])

  File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line 356, in import_module
    if os.path.exists(filepath[:-1]) :

  File "/usr/local/lib/python2.1/posixpath.py", line 171, in exists
    st = os.stat(path)

OSError: [Errno 2] No such file or directory: '/home/demo/cgi-bin/test.p'

-----

the test.py file:

import os, sys

def saveform(req):
  return "OK."




Regards,

Vincent


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010703/cdf6c498/attachment.htm
From matthias at my.gnus.org  Tue Jul  3 12:18:43 2001
From: matthias at my.gnus.org (Matthias Wiehl)
Date: Fri Jan  9 21:46:23 2004
Subject: [mod_python] Error: No such file or directory
In-Reply-To: <00ae01c1039b$72f11160$3f00a8c0@ns1.ionetbiz.com> ("Vincent
 Wong"'s message of "Tue, 3 Jul 2001 16:37:52 +0800")
References: <00ae01c1039b$72f11160$3f00a8c0@ns1.ionetbiz.com>
Message-ID: <871ynyqprw.agb@fulmine.dhs.org>

Vincent Wong <vincentwong@ionetbiz.com> writes:
> OSError: [Errno 2] No such file or directory: '/home/demo/cgi-bin/test.p'

Have a closer look at the filename.  I think this is a typo.

From daniel at copyleft.no  Tue Jul  3 12:48:55 2001
From: daniel at copyleft.no (Hr. Daniel Mikkelsen)
Date: Fri Jan  9 21:46:23 2004
Subject: [mod_python] Error: No such file or directory
In-Reply-To: <871ynyqprw.agb@fulmine.dhs.org>
Message-ID: <Pine.LNX.4.31.0107031247070.13943-100000@unity.copyleft.no>

>> OSError: [Errno 2] No such file or directory: '/home/demo/cgi-bin/test.p'

> Have a closer look at the filename.  I think this is a typo.

I don't know if it's the same thing here, but I'm running FreeBSD, and
mod_python erranously cuts the last character of filename of the handler
I've given. I had to remove a [:-1] suffix a couple of places in apache.py
(I think) to get it to work.

I'll post more details if it's interesting to anyone.

-- Daniel Mikkelsen, Copyleft Software AS



From CHagner at fool.com  Tue Jul  3 08:50:12 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:46:23 2004
Subject: [mod_python] Session data (Sorry for bringing this up again..
	.)
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E47FAF@rover.foolhq.com>

An alternative would be to have a separate daemon running on the server
(outside of apache/mod_python) that creates/serves/pools/persists your
connections.  Thus, each apache child process/python subinterp would hit
this daemon to get connections.  This model (or something similar) is almost
required if you're going to run apache with many child procs... or multiple
apache instances on the same box.  Either way, you don't really want 100
connections (or more! ack) open to the database.  Heck, if you're running
multiple web servers all hitting a single database, you can easily see how
the total number of connections gets painfully large.  You probably want
something along the lines of 5-10 connections in a db connection pool
(although this is highly dependent on the design of the pool and the
daemon).

Chris

-----Original Message-----
From: Ben Leslie [mailto:benno@sesgroup.net]
Sent: Tuesday, July 03, 2001 2:25 AM
To: Matthew Wood
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Session data (Sorry for bringing this up
again...)


On Tue, 03 Jul 2001, Matthew Wood wrote:

<snip>

>
> This brings me to my question:
> Would  it  be appropriate to keep a database connection in each of the
> memory  spaces?


Yes. This is exactly what I do.

In your handler you have a global variable holding the db connection. In 
the handler you check the db handler is alive and recreate if necessary 
(this should really only happen the first time that process is used)

Benno
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python

From vincentwong at ionetbiz.com  Tue Jul  3 21:38:48 2001
From: vincentwong at ionetbiz.com (Vincent Wong)
Date: Fri Jan  9 21:46:23 2004
Subject: [mod_python] Error: No such file or directory
References: <Pine.LNX.4.31.0107031247070.13943-100000@unity.copyleft.no>
Message-ID: <012301c103c5$7d3ee8c0$3f00a8c0@ns1.ionetbiz.com>

Thanks, Daniel.  So far it work after I change a few of [:-1] to [:].  I
wounldn't know if there is any side effect.


----- Original Message -----
From: Hr. Daniel Mikkelsen <daniel@copyleft.no>
To: Matthias Wiehl <matthias@my.gnus.org>
Cc: Vincent Wong <vincentwong@ionetbiz.com>; Mod_python Mailing List
<mod_python@modpython.org>
Sent: Tuesday, July 03, 2001 6:48 PM
Subject: Re: [mod_python] Error: No such file or directory


> >> OSError: [Errno 2] No such file or directory:
'/home/demo/cgi-bin/test.p'
>
> > Have a closer look at the filename.  I think this is a typo.
>
> I don't know if it's the same thing here, but I'm running FreeBSD, and
> mod_python erranously cuts the last character of filename of the handler
> I've given. I had to remove a [:-1] suffix a couple of places in apache.py
> (I think) to get it to work.
>
> I'll post more details if it's interesting to anyone.
>
> -- Daniel Mikkelsen, Copyleft Software AS
>


From seant at webreply.com  Tue Jul  3 14:02:13 2001
From: seant at webreply.com (Sean True)
Date: Fri Jan  9 21:46:23 2004
Subject: [mod_python] Translation handler help?
Message-ID: <MJEHLHJKGINLONDMMKNEIECFDHAA.seant@webreply.com>

We're implementing a bunch of stuff on top of mod_python, and have avoided
using the
translation handler. Until today.

I'd like to rewrite the URI -- but req.uri is readonly. I can't find a
req.uri() method ...

I'd like to find the equivalent of the CGI document root -- but
apache.build_cgi_env() is not happy about running inside the transhandler():

File /usr/local/pythonpackages/mod_python/apache.py", line 189, in Dispatch
    result = object(self.req)
File "/usr/local/pythonpackages/phtml/phtml.py", line 14, in transhandler
    env = apache.build_cgi_env(req)
File "/usr/local/pythonpackages/mod_python/apache.py", line 418, in
build_cgi_env
    env[k] = req.subprocess_env[k]
KeyError: SCRIPT_FILENAME

Does anyone have a creative or even functional example of a translation
handler?

-- Sean
-------
Sean True
WebReply.Com, Inc.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Sean True.vcf
Type: text/x-vcard
Size: 309 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20010703/f6dc2e8a/SeanTrue.vcf
From grisha at modpython.org  Tue Jul  3 14:57:44 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:23 2004
Subject: [mod_python] Translation handler help?
In-Reply-To: <MJEHLHJKGINLONDMMKNEIECFDHAA.seant@webreply.com>
Message-ID: <Pine.BSF.4.32.0107031455280.93646-100000@localhost>

This is probably a screw up on my end - req.uri should be read only for
the translation handler to be useful... ;-)

It's not that hard to add that in - just look at how other read/write
variables are implemented - you have to put a couple of lines of code in
the set_attr function... If this is too much trouble, you 'll have to wait
until the next release.

Grisha

On Tue, 3 Jul 2001, Sean True wrote:

> We're implementing a bunch of stuff on top of mod_python, and have avoided
> using the
> translation handler. Until today.
>
> I'd like to rewrite the URI -- but req.uri is readonly. I can't find a
> req.uri() method ...
>
> I'd like to find the equivalent of the CGI document root -- but
> apache.build_cgi_env() is not happy about running inside the transhandler():
>
> File /usr/local/pythonpackages/mod_python/apache.py", line 189, in Dispatch
>     result = object(self.req)
> File "/usr/local/pythonpackages/phtml/phtml.py", line 14, in transhandler
>     env = apache.build_cgi_env(req)
> File "/usr/local/pythonpackages/mod_python/apache.py", line 418, in
> build_cgi_env
>     env[k] = req.subprocess_env[k]
> KeyError: SCRIPT_FILENAME
>
> Does anyone have a creative or even functional example of a translation
> handler?
>
> -- Sean
> -------
> Sean True
> WebReply.Com, Inc.
>


From matt at designscape.com.au  Wed Jul  4 11:59:39 2001
From: matt at designscape.com.au (Matt Beauregard)
Date: Fri Jan  9 21:46:23 2004
Subject: [mod_python] undefined symbol "floor"
Message-ID: <20010704115939.K14594@designscape.com.au>

We just set up mod_python and are getting the following strange error:

Mod_python error: "PythonHandler modpython"

Traceback (most recent call last):
  File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line 189, in Dispatch
    result = object(self.req)
  File "/usr/home/marauder/exchange/modpython.py", line 7, in handler
ImportError: /usr/local/lib/python2.1/lib-dynload/struct.so: Undefined symbol "floor"

We get this any time some code tries to import struct, when running
through mod_python, but not when running from the interpreter.  Any
clues for fixing it would be appreciated.

Using mod_python 2.7.5
Python 2.1 (#2, Jul  3 2001, 17:40:45) 
[GCC 2.95.2 19991024 (release)] on freebsd4
FreeBSD bofh.designscape.com.au 4.2-RELEASE FreeBSD 4.2-RELEASE #0:
Tue Feb 27 12:11:29 EST 2001 marauder@bofh.designscape.com.au:/usr/src/sys/compile/BOFH  i386

thanks,

-- 
Matt Beauregard
BOFH, Designscape
Ph: +61 2 9361 4233   Fx: +61 2 9361 4633

Permission is given for unlimited distribution of this work under the
Copyright Act 1968 (2001 amended).  Unless otherwise stated, you agree
that these terms also cover works which you send in response.


From grisha at modpython.org  Tue Jul  3 22:53:53 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:23 2004
Subject: [mod_python] undefined symbol "floor"
In-Reply-To: <20010704115939.K14594@designscape.com.au>
Message-ID: <Pine.BSF.4.32.0107032247370.293-100000@localhost>

floor() lives in libm, make sure that when you compile it, "-lm" is one of
the options.

On Wed, 4 Jul 2001, Matt Beauregard wrote:

> We just set up mod_python and are getting the following strange error:
>
> Mod_python error: "PythonHandler modpython"
>
> Traceback (most recent call last):
>   File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line 189, in Dispatch
>     result = object(self.req)
>   File "/usr/home/marauder/exchange/modpython.py", line 7, in handler
> ImportError: /usr/local/lib/python2.1/lib-dynload/struct.so: Undefined symbol "floor"
>
> We get this any time some code tries to import struct, when running
> through mod_python, but not when running from the interpreter.  Any
> clues for fixing it would be appreciated.
>
> Using mod_python 2.7.5
> Python 2.1 (#2, Jul  3 2001, 17:40:45)
> [GCC 2.95.2 19991024 (release)] on freebsd4
> FreeBSD bofh.designscape.com.au 4.2-RELEASE FreeBSD 4.2-RELEASE #0:
> Tue Feb 27 12:11:29 EST 2001 marauder@bofh.designscape.com.au:/usr/src/sys/compile/BOFH  i386
>
> thanks,
>
> --
> Matt Beauregard
> BOFH, Designscape
> Ph: +61 2 9361 4233   Fx: +61 2 9361 4633
>
> Permission is given for unlimited distribution of this work under the
> Copyright Act 1968 (2001 amended).  Unless otherwise stated, you agree
> that these terms also cover works which you send in response.
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From matt at designscape.com.au  Wed Jul  4 13:04:42 2001
From: matt at designscape.com.au (Matt Beauregard)
Date: Fri Jan  9 21:46:23 2004
Subject: [mod_python] undefined symbol "floor"
In-Reply-To: <Pine.BSF.4.32.0107032247370.293-100000@localhost>; from grisha@modpython.org on Tue, Jul 03, 2001 at 10:53:53PM -0400
References: <20010704115939.K14594@designscape.com.au> <Pine.BSF.4.32.0107032247370.293-100000@localhost>
Message-ID: <20010704130442.A40751@designscape.com.au>

On Tue, Jul 03, 2001 at 10:53:53PM -0400, Gregory (Grisha) Trubetskoy wrote:
> 
> floor() lives in libm, make sure that when you compile it, "-lm" is one of
> the options.

Hi Gregory,

I think the relevant compile lines are 
/usr/local/sbin/apxs -I/usr/ports/www/mod_python/work/mod_python-2.7.5/src/include -I/usr/local/include/apache -I/usr/ports/www/mod_python/work/Python-2.1 -I/usr/ports/www/mod_python/work/Python-2.1/Include -c mod_python.o  _apachemodule.o  requestobject.o  tableobject.o  util.o  serverobject.o  connobject.o -lm  /usr/ports/www/mod_python/work/Python-2.1/libpython2.1.a      -lm
gcc -shared -o mod_python.so mod_python.o _apachemodule.o requestobject.o tableobject.o util.o serverobject.o connobject.o -lm /usr/ports/www/mod_python/work/Python-2.1/libpython2.1.a -lm 

Output from objdump:
!815 root@bofh:/usr/ports/www/mod_python/work/mod_python-2.7.5/src# objdump -t mod_python.so|grep floor
00000000       F *UND*  00000000 floor
!816 root@bofh:/usr/ports/www/mod_python/work/mod_python-2.7.5/src# objdump -T mod_python.so|grep floor
00000000      DF *UND*  00000000 floor

Any clues?

thanks,

-- 
Matt Beauregard
Technical Director, Designscape
Ph: +61 2 9361 4233   Fx: +61 2 9361 4633

Permission is given for unlimited distribution of this work under the
Copyright Act 1968 (2001 amended).  Unless otherwise stated, you agree
that these terms also cover works which you send in response.


From mark_miller_ca at yahoo.com  Wed Jul  4 01:31:11 2001
From: mark_miller_ca at yahoo.com (Mark Miller)
Date: Fri Jan  9 21:46:23 2004
Subject: [mod_python] mod_python and testing error
Message-ID: <ALEBINNPGFGFAJGIFGHPAEGICBAA.mark_miller_ca@yahoo.com>

when i try to run the test script as stated in the manual,
i originally was getting the text of the script displayed on the screen, but
i just ran it now, and i got from apache: internal server error.

Within the apache error_log file, i have [Wed Jul 4 01:07:41 2001] [error]
[client 192.168.0.92] python_handler: make_obcallback returned no
obCallBack!

Can anyone guide me beyond this point, i get the feeling that i am close, if
it comes down to it, i will include my httpd.conf, but i don't imagine the
problem is within the file.

Thanks

Mark Miller


_________________________________________________________
Do You Yahoo!?
Get your free @yahoo.com address at http://mail.yahoo.com


From daniel at copyleft.no  Wed Jul  4 09:35:14 2001
From: daniel at copyleft.no (Hr. Daniel Mikkelsen)
Date: Fri Jan  9 21:46:23 2004
Subject: [mod_python] undefined symbol "floor"
In-Reply-To: <Pine.BSF.4.32.0107032247370.293-100000@localhost>
Message-ID: <Pine.LNX.4.31.0107040933280.13943-100000@unity.copyleft.no>

> floor() lives in libm, make sure that when you compile it, "-lm" is one of
> the options.

It is my experience, on FreeBSD, that I have to recompile Apache with
"-lm" in order for this to work. Linking it with mod_python doesn't seem
to cut it (unless one perhaps linked it statically).

-- Daniel Mikkelsen, Copyleft Software AS



From matt at designscape.com.au  Wed Jul  4 17:51:15 2001
From: matt at designscape.com.au (Matt Beauregard)
Date: Fri Jan  9 21:46:23 2004
Subject: [mod_python] undefined symbol "floor"
In-Reply-To: <Pine.LNX.4.31.0107040933280.13943-100000@unity.copyleft.no>; from daniel@copyleft.no on Wed, Jul 04, 2001 at 09:35:14AM +0200
References: <Pine.BSF.4.32.0107032247370.293-100000@localhost> <Pine.LNX.4.31.0107040933280.13943-100000@unity.copyleft.no>
Message-ID: <20010704175115.F40751@designscape.com.au>

On Wed, Jul 04, 2001 at 09:35:14AM +0200, Hr. Daniel Mikkelsen wrote:
> > floor() lives in libm, make sure that when you compile it, "-lm" is one of
> > the options.
> 
> It is my experience, on FreeBSD, that I have to recompile Apache with
> "-lm" in order for this to work. Linking it with mod_python doesn't seem
> to cut it (unless one perhaps linked it statically).

Hooray!  Thanks Daniel, one step closer...

Now it's finding floor, but I'm getting 
ImportError: /usr/local/lib/python2.1/lib-dynload/_socket.so: Undefined symbol "PyThread_acquire_lock"

Is this another linker problem?  What do I link in to get this solved?

thanks,

-- 
Matt Beauregard
Technical Director, Designscape
Ph: +61 2 9361 4233   Fx: +61 2 9361 4633

Permission is given for unlimited distribution of this work under the
Copyright Act 1968 (2001 amended).  Unless otherwise stated, you agree
that these terms also cover works which you send in response.


From vincentwong at ionetbiz.com  Wed Jul  4 16:36:18 2001
From: vincentwong at ionetbiz.com (Vincent Wong)
Date: Fri Jan  9 21:46:24 2004
Subject: [mod_python] os.system problem
Message-ID: <007401c10464$65bb50e0$3f00a8c0@ns1.ionetbiz.com>

When I use os.system('some command') within the interactive interpreter, everything works fine.  But when I use the same os.system('some command') together with mod_python, no error reported but the effect of the command does not occur.  Anyone know what is happenning here?

Regards.
Vincent

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010704/247ee969/attachment.htm
From daniel at copyleft.no  Wed Jul  4 10:31:50 2001
From: daniel at copyleft.no (Hr. Daniel Mikkelsen)
Date: Fri Jan  9 21:46:24 2004
Subject: [mod_python] undefined symbol "floor" 
Message-ID: <Pine.LNX.4.31.0107041031270.13943-100000@unity.copyleft.no>

>> It is my experience, on FreeBSD, that I have to recompile Apache with
>> "-lm" in order for this to work. Linking it with mod_python doesn't seem
>> to cut it (unless one perhaps linked it statically).

> Now it's finding floor, but I'm getting ImportError:
> /usr/local/lib/python2.1/lib-dynload/_socket.so: Undefined symbol
> "PyThread_acquire_lock" Is this another linker problem?  What do I
> link in to get this solved?

I got this one too, at one point, but I can't remember what I did. I think
it had something to do with Python's /usr/local/lib/python2.1 binaries
being compiled with threading.

Perhaps a separate install of a threadless python, in another directory,
and linking against that, will help you. Only, I can't recall doing this,
and things are working for me now.

There were also more problems like this, one with mxDateTime. I feel every
time I want to set up mod_python after a few months of not using it, I
have to spend days fucking with it. :)

-- Daniel Mikkelsen, Copyleft Software AS



From mai99dgf at studserv.uni-leipzig.de  Wed Jul  4 13:34:08 2001
From: mai99dgf at studserv.uni-leipzig.de (Georg Martius)
Date: Fri Jan  9 21:46:24 2004
Subject: [mod_python] apache-1.3.14 Suse/Linux & mod_python toubles
Message-ID: <3B42FF30.BA021F5F@studserv.uni-leipzig.de>

Hi

I have same troubles with the mod_python module and my apache. 
I have SuSE 7.1 and the apache logs the following:

[notice] Apache/1.3.14 (Unix)  (SuSE/Linux) mod_python/2.7.1 Python/2.0
mod_throttle/3.0 mod_layout/1.0 mod_fastcgi/2.2.2 mod_perl/1.24
PHP/3.0.17-dev configured -- resuming normal operations 

I have copied the mptest.py into my cgi-bin directory with the right
permissions.

the splitter of my httpd.conf is:

<Directory /usr/local/httpd/cgi-bin>
  AddHandler python-program .py
  PythonHandler mptest
  PythonDebug On
</Directory>      


If perform a request to mptest.py I get in internal server error and the
logfile shows:
[error] (8)Exec format error: exec of /usr/local/httpd/cgi-bin/mptest.py
failed
[error] [client 192.168.155.55] Premature end of script headers:
/usr/local/httpd/cgi-bin/mptest.py     

Thanks for any help!

Ciao Bethoven

From M.Izydorski at rubikon.pl  Wed Jul  4 16:15:51 2001
From: M.Izydorski at rubikon.pl (Michal Izydorski)
Date: Fri Jan  9 21:46:24 2004
Subject: [mod_python] Configuration problems
Message-ID: <1646860855.20010704161551@rubikon.pl>

Hello!!

I have configuration problems with Apache 1.3.20 under W2k

The error is:

> Syntax error on line 211 of c:/program files/apache group/apache/conf/httpd.conf
> :
> Cannot load c:/program files/apache group/apche/modules/mod_python.dll into serv
> er: (126) Nie mo?na odnale?? okre?lonego modu-u:


           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
I don't know, why marked part is in my w2k local language, it means No
such modules.

I load other modules, esp. PHP, and there isn't problem, the same dir,
proprietary LoadModule Directives, bup Python don't work.

Please help and send answer to my email too.


-- 
Regards,
 Michal                          mailto:M.Izydorski@rubikon.pl



From grisha at modpython.org  Wed Jul  4 10:18:12 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:24 2004
Subject: [mod_python] undefined symbol "floor"
In-Reply-To: <20010704175115.F40751@designscape.com.au>
Message-ID: <Pine.BSF.4.32.0107041016050.8569-100000@localhost>

oh, this is an easy one - recompile Python without threads and use
--with-python to compile mod_python.

the mod_python port used to take care of all of that very nicely, but it
seems to be a bit outdated at 2.7.3... although you might be able to tweak
the Makefile just a little bit to make it compile the latest version -
there isn't all that much difference.

grisha

On Wed, 4 Jul 2001, Matt Beauregard wrote:

> On Wed, Jul 04, 2001 at 09:35:14AM +0200, Hr. Daniel Mikkelsen wrote:
> > > floor() lives in libm, make sure that when you compile it, "-lm" is one of
> > > the options.
> >
> > It is my experience, on FreeBSD, that I have to recompile Apache with
> > "-lm" in order for this to work. Linking it with mod_python doesn't seem
> > to cut it (unless one perhaps linked it statically).
>
> Hooray!  Thanks Daniel, one step closer...
>
> Now it's finding floor, but I'm getting
> ImportError: /usr/local/lib/python2.1/lib-dynload/_socket.so: Undefined symbol "PyThread_acquire_lock"
>
> Is this another linker problem?  What do I link in to get this solved?
>
> thanks,
>
> --
> Matt Beauregard
> Technical Director, Designscape
> Ph: +61 2 9361 4233   Fx: +61 2 9361 4633
>
> Permission is given for unlimited distribution of this work under the
> Copyright Act 1968 (2001 amended).  Unless otherwise stated, you agree
> that these terms also cover works which you send in response.
>


From vincentwong at ionetbiz.com  Thu Jul  5 12:00:46 2001
From: vincentwong at ionetbiz.com (Vincent Wong)
Date: Fri Jan  9 21:46:24 2004
Subject: [mod_python] link to image files broken
Message-ID: <00fc01c10507$1218a700$3f00a8c0@ns1.ionetbiz.com>

I have a html file call thanks.html.  When I open this file and return the content from my test.py file, all links to image (.gif) files are broken.  Did anyone know the solution?

Thanks.

Vincent

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010705/b1386738/attachment.htm
From piet at cs.uu.nl  Thu Jul  5 11:01:29 2001
From: piet at cs.uu.nl (piet@cs.uu.nl)
Date: Fri Jan  9 21:46:24 2004
Subject: [mod_python] link to image files broken
In-Reply-To: "Vincent Wong"'s message of "Thu, 5 Jul 2001 12:00:46 +0800"
References: <00fc01c10507$1218a700$3f00a8c0@ns1.ionetbiz.com>
Message-ID: <ubsmzoil2.fsf@cs.uu.nl>

>>>>> "Vincent Wong" <vincentwong@ionetbiz.com> (VW) writes:

VW> I have a html file call thanks.html. When I open this file and return
VW> the content from my test.py file, all links to image (.gif) files are
VW> broken. Did anyone know the solution?

Not without knowing how the links to the images are coded in thanks.html.
-- 
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl


From vincentwong at ionetbiz.com  Fri Jul  6 14:18:45 2001
From: vincentwong at ionetbiz.com (Vincent Wong)
Date: Fri Jan  9 21:46:24 2004
Subject: [mod_python] link to image files broken
References: <014901c10542$3c018ec0$3f00a8c0@ns1.ionetbiz.com>
Message-ID: <012801c105e3$833099c0$3f00a8c0@ns1.ionetbiz.com>

these are the test.py and thanks.html

---test.py---


import os, sys
def saveform(req):
  input = open('../../thanks.html', 'r')

  return input.read()


---thanks.html---

<html>
<head>
<title>Desa Millennia E-Community</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<script language="JavaScript">
<!--
function MM_preloadImages() { file://v3.0
  var d=document; if(d.images){ if(!d.MM_p) d.MM_p=new Array();
    var i,j=d.MM_p.length,a=MM_preloadImages.arguments; for(i=0; i<a.length;
i++)
    if (a[i].indexOf("#")!=0){ d.MM_p[j]=new Image; d.MM_p[j++].src=a[i];}}
}

function MM_swapImgRestore() { file://v3.0
  var i,x,a=document.MM_sr; for(i=0;a&&i<a.length&&(x=a[i])&&x.oSrc;i++)
x.src=x.oSrc;
}

function MM_findObj(n, d) { file://v4.0
  var p,i,x;  if(!d) d=document;
if((p=n.indexOf("?"))>0&&parent.frames.length) {
    d=parent.frames[n.substring(p+1)].document; n=n.substring(0,p);}
  if(!(x=d[n])&&d.all) x=d.all[n]; for (i=0;!x&&i<d.forms.length;i++)
x=d.forms[i][n];
  for(i=0;!x&&d.layers&&i<d.layers.length;i++)
x=MM_findObj(n,d.layers[i].document);
  if(!x && document.getElementById) x=document.getElementById(n); return x;
}

function MM_swapImage() { file://v3.0
  var i,j=0,x,a=MM_swapImage.arguments; document.MM_sr=new Array;
for(i=0;i<(a.length-2);i+=3)
   if ((x=MM_findObj(a[i]))!=null){document.MM_sr[j++]=x; if(!x.oSrc)
x.oSrc=x.src; x.src=a[i+2];}
}
file://-->
</script>
</head>

<body bgcolor="#FFFFFF" text="#000000" leftmargin="0" topmargin="0"
marginwidth="0" marginheight="0" background="main/002darkgreen.gif"
onLoad="MM_preloadImages('main/016community1.gif','main/017security1.gif','m
ain/018events1.gif','main/019onlinepay1.gif','main/20onlinebook1.gif','main/
21shopping1.gif','main/22food1.gif','main/23entertain1.gif','main/24gettinga
round1.gif','main/25thetown1.gif','main/26news1.gif','main/27technical1.gif'
,'main/28infodesk1.gif','main/29faq1.gif','main/41a.gif','main/015home1.gif'
)">
<div align="center">
  <table width="100%" border="0" cellspacing="0" cellpadding="0"
bgcolor="#FFFFFF">
    <tr>
      <td>
        <div align="center"><img src="main/000none.gif" width="10"
height="10"><br>
          <img src="main/00logo.gif" width="197" height="38"><img
src="main/000none.gif" width="80" height="8">
          <img src="main/00newlaunch_banner.gif" width="480" height="60">
<img src="main/000none.gif" width="20" height="8"><br>
          <img src="main/000none.gif" width="10" height="3"></div>
      </td>
    </tr>
  </table>
  <table width="100%" border="0" cellspacing="0" cellpadding="0">
    <tr>
      <td height="3" background="main/001blackwhiteline.gif"><img
src="main/000none.gif" width="1" height="1"></td>
    </tr>
  </table>
  <table width="761" border="0" cellspacing="0" cellpadding="0">
    <tr>
      <td><br>
        <table width="767" border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td width="375"><img src="main/000none.gif" width="175"
height="1"><img src="main/45.gif" width="112" height="41"></td>
            <td width="386">
              <table width="100%" border="0" cellspacing="0"
cellpadding="0">
                <tr>
                  <td><b><font face="Arial, Helvetica, sans-serif" size="1"
color="#CCCCCC">Username
                    :<img src="main/000none.gif" width="10"
height="8"></font></b></td>
                  <td>
                    <input type="text" name="textfield" size="10">
                    <b><font face="Arial, Helvetica, sans-serif" size="1"
color="#CCCCCC"><img src="main/000none.gif" width="20"
height="8"></font></b>
                  </td>
                  <td><b><font face="Arial, Helvetica, sans-serif" size="1"
color="#CCCCCC">Password
                    :<img src="main/000none.gif" width="10" height="8">
</font></b></td>
                  <td>
                    <input type="text" name="textfield2" size="10">
                  </td>
                  <td>
                    <div align="right"><img src="main/004go.gif" width="22"
height="22"></div>
                  </td>
                </tr>
              </table>
            </td>
          </tr>
        </table>
        <table width="761" border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td width="111" valign=top background="main/013.gif">
              <p><img src="main/002darkgreen.gif" width="111"
height="3"><br>
                <font color="#FFFFFF"><b><font face="Verdana, Tahoma, Arial"
size="1">Search
                For :<br>
                <img src="main/000none.gif" width="8" height="8"><br>
                <input type="text" name="textfield3" size="13">
                <br>
                </font><font color="#FFFFFF"><b><font face="Verdana, Tahoma,
Arial" size="1"><img src="main/000none.gif" width="8"
height="8"></font></b></font><br>
                <img src="main/000none.gif" width="28" height="1"><img
src="main/014searchbutton.gif" width="74" height="16"><br>
                <br>
                <a href="index.html" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image15','','main/015home1.gif',1)"><img
src="main/015home.gif" width="111" height="24" border="0"
name="Image15"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image1','','main/016community1.gif',1)"><img
src="main/016community.gif" width="111" height="24" border="0"
name="Image1"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image2','','main/017security1.gif',1)"><img
src="main/017security.gif" width="111" height="24" border="0"
name="Image2"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image3','','main/018events1.gif',1)"><img
src="main/018events.gif" width="111" height="24" border="0"
name="Image3"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image4','','main/019onlinepay1.gif',1)"><img
src="main/019onlinepay.gif" width="111" height="24" border="0"
name="Image4"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image5','','main/20onlinebook1.gif',1)"><img
src="main/20onlinebook.gif" width="111" height="24" border="0"
name="Image5"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image6','','main/21shopping1.gif',1)"><img
src="main/21shopping.gif" width="111" height="24" border="0"
name="Image6"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image7','','main/22food1.gif',1)"><img
src="main/22food.gif" width="111" height="24" border="0"
name="Image7"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image8','','main/23entertain1.gif',1)"><img
src="main/23entertain.gif" width="111" height="24" border="0"
name="Image8"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image9','','main/24gettingaround1.gif',1)"><img
src="main/24gettingaround.gif" width="111" height="24" border="0"
name="Image9"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image10','','main/25thetown1.gif',1)"><img
src="main/25thetown.gif" width="111" height="24" border="0"
name="Image10"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image11','','main/26news1.gif',1)"><img
src="main/26news.gif" width="111" height="24" border="0"
name="Image11"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image12','','main/27technical1.gif',1)"><img
src="main/27technical.gif" width="111" height="24" border="0"
name="Image12"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image13','','main/28infodesk1.gif',1)"><img
src="main/28infodesk.gif" width="111" height="24" border="0"
name="Image13"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image14','','main/29faq1.gif',1)"><img
src="main/29faq.gif" width="111" height="24" border="0"
name="Image14"></a></b></font></p>
              <p align="center"><img src="main/30advert.gif" width="102"
height="113"><br>
                <br>
              </p>
            </td>
            <td width="11" valign=top background="main/007.gif"><img
src="main/008.gif" width="11" height="32"></td>
            <td width="627" valign=top bgcolor="#FFFFFF">
              <div align="left">
                <table width="100%" border="0" cellspacing="0"
cellpadding="0">
                  <tr>
                    <td background="main/43.gif"><img src="main/44.gif"
width="167" height="27"></td>
                  </tr>
                </table>
                <br>
                <br>
                <br>
                <br>
                <table width="85%" border="0" cellspacing="0"
cellpadding="0" align="center">
                  <tr>
                    <td>
                      <div align="center">
                        <p><b><font face="Verdana, Arial, Helvetica,
sans-serif" size="1" color="#000000">THANK
                          YOU !</font></b></p>
                        <p align="center"><b><font face="Verdana, Arial,
Helvetica, sans-serif" size="1" color="#000000"><font color="#003300">Your
                          registration is successfull ! To learn how to
install
                          your e-mail, please <font color="#333333"><a
href="faq2.html"><font color="#000000">click
                          here</font></a></font>!</font></font></b></p>
                        </div>
                    </td>
                  </tr>
                </table>
                <div align="center"><br>
                  <br>
                  <table width="85%" border="0" cellspacing="0"
cellpadding="0" align="center">
                    <tr>
                      <td width="50%"><b><font face="Verdana, Arial,
Helvetica, sans-serif" size="1" color="#000000"><a href="invite.html"
target="_blank"><img src="main/02.jpg" width="73" height="61"
border="0"></a><a href="invite.html" target="_blank"><img src="main/38.gif"
width="171" height="61" border="0"></a><br>
                        <br>
                        <b><font face="Arial, Helvetica, sans-serif"
size="1" color="#CCCCCC"><img src="main/000none.gif" width="8"
height="4"></font></b><br>
                        <img src="main/32line.gif" width="254"
height="1"><br>
                        <img src="main/33.gif" width="98" height="89"><img
src="main/34.gif" width="154" height="89" usemap="#Map3" border="0"><br>
                        <img src="main/35.gif" width="99" height="94"><img
src="main/36.gif" width="153" height="94" usemap="#Map4Map" border="0"><br>
                        <br>
                        <map name="Map3">
                          <area shape="rect" coords="74,58,153,73"
href="http://www.emasonline.com/millenniumland/Showhouse/Main.asp"
target="_blank">
                        </map>
                        </font></b><b><font face="Verdana, Arial, Helvetica,
sans-serif" size="1" color="#000000">
                        <map name="Map4Map">
                          <area shape="rect" coords="73,68,152,81"
href="http://www.emasonline.com/millenniumland/demo.asp" target="_blank">
                        </map>
                        </font></b></td>
                      <td width="50%">
                        <div align="center">
                          <p align="center"><img src="main/54suggest.gif"
width="153" height="180" usemap="#Map" border="0">
                            <map name="Map">
                              <area shape="rect" coords="63,137,144,151"
href="mailto:feedback@desamillennia.com" alt="SUGESST ??" title="SUGESST
??">
                            </map>
                            <b><font face="Verdana, Arial, Helvetica,
sans-serif" size="1" color="#000000">
                            <map name="Map4">
                              <area shape="rect" coords="73,68,152,81"
href="http://www.emasonline.com/millenniumland/demo.asp" target="_blank">
                            </map>
                            </font></b></p>
                        </div>
                      </td>
                    </tr>
                  </table>
                  <br>
                </div>
                <div align="center"><br>
                </div>
                <p align="center">&nbsp;</p>
                <p align="center">&nbsp;</p>
              </div>
            </td>
            <td width="12" background="main/005.gif" valign=top><img
src="main/006.gif" width="12" height="30"></td>
          </tr>
        </table>
        <table width="761" border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td width="114">
              <div align="right"><img src="main/50.gif" width="4"
height="10"></div>
            </td>
            <td width="647" background="main/48.gif">
              <div align="right"><img src="main/49.gif" width="8"
height="10"></div>
            </td>
          </tr>
        </table>
        <table width="761" border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td width="114">
              <div align="right"></div>
            </td>
            <td width="647">
              <div align="center"><br>
                <font size="1" face="Arial, Helvetica, sans-serif"
color="#CCCCCC">
                Home | Community | Security Access | Events | Online Payment
|
                Online Booking | Shopping | Food &amp; Dining |
Entertainment
                | Getting Around | The Town | News &amp; Archives |
Technical
                Support | Information Desk | FAQ<br>
                <font color="#666666"><br>
                Copyright 2001 &copy; . Desa Millennia Sdn Bhd. Your Smart
Township.
                Site constructed by zecnet.com and
ionetbiz.com.</font></font></div>
            </td>
          </tr>
        </table>

      </td>
    </tr>
  </table>
  <br>
</div>
</body>
</html>






From piet at cs.uu.nl  Fri Jul  6 11:30:42 2001
From: piet at cs.uu.nl (piet@cs.uu.nl)
Date: Fri Jan  9 21:46:24 2004
Subject: [mod_python] link to image files broken
In-Reply-To: "Vincent Wong"'s message of "Fri, 6 Jul 2001 14:18:45 +0800"
References: <014901c10542$3c018ec0$3f00a8c0@ns1.ionetbiz.com>
	<012801c105e3$833099c0$3f00a8c0@ns1.ionetbiz.com>
Message-ID: <uhewqiev1.fsf@cs.uu.nl>

>>>>> "Vincent Wong" <vincentwong@ionetbiz.com> (VW) writes:

VW> these are the test.py and thanks.html
VW> ---test.py---


VW> import os, sys
VW> def saveform(req):
VW>   input = open('../../thanks.html', 'r')

VW>   return input.read()


VW> ---thanks.html---
....
VW> marginwidth="0" marginheight="0" background="main/002darkgreen.gif"
VW> onLoad="MM_preloadImages('main/016community1.gif','main/017security1.gif','m

It is difficult to know without the context, but I guess the problem is
that your images are supposed to come from the directory `main', which I
suppose is relative to the directory where thanks.html is found. But the
browser doesn't know that the HTML file comes from ../.., it works relative
to the directory where your python script is located (or the original
script that calls this one).

So you could:
1. Change the image locations in thanks.html to ../../main
2. Move the main directory to the sirectory where your python scripts are
   (but this doesn't help if you also need to refer to thanks.html
   directly)
3. Put a <BASE HREF="actual location of the thanks.html file"> in
   thanks.html or in the copy that you write.
I think 3 is the best solution.
-- 
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl


From seant at webreply.com  Fri Jul  6 12:34:27 2001
From: seant at webreply.com (Sean True)
Date: Fri Jan  9 21:46:24 2004
Subject: [mod_python] More translation handler help?
In-Reply-To: <ubsmzoil2.fsf@cs.uu.nl>
Message-ID: <MJEHLHJKGINLONDMMKNEEEENDHAA.seant@webreply.com>

With a little bit of help from Grisha, I got past my first problem (I needed
a writable req.uri)
and am onto a second one.

I stripped out the following handlers from a much larger system, and they
reproduce the problem.
The production handler (handler) attempts to do a lookup_uri on the inbound
URI. If there is no translation handler
called for in the conf file, all is well, and the lookup works.

If there is a translation handler declared using PythonTransHandler, the
Transhandler gets called twice,
and the server process appears to go into a loop -- never exits the
production handler. I'm suspecting
that there is a reentrancy issue here of some sort, but the Apache code
specifically suggests calling lookup_uri() to
get the mapping of "/" to filename, instead of using document_root().

Comments on the rules of when one can and can't call lookup_uri() would be
welcome.

-- Sean


Configuration:

# Connections for general test site
<VirtualHost www.foo.com>
    DocumentRoot /usr/local/apache/htdocs/www.foo.com
    ServerName www.foo.com
    AddHandler python-program .phtml
    PythonInterpreter xphtml
    PythonHandler phtml.xphtml
    PythonTransHandler phtml.xphtml
</VirtualHost>


xphtml.py:



from mod_python import apache
from phtmllog import log, logIO

def transhandler(req):
    log("transhandler "+`req.uri`)
    return apache.DECLINED

def handler(req):
    log("lookup_uri "+req.lookup_uri(req.uri).filename)
    return apache.OK


requestobject.c code for lookup_uri:

/**
 ** request.lookup_uri(request self, uri)
 **
 *    An interface to the ap_lookup_uri function.
 */

static PyObject * req_lookup_uri(requestobject *self, PyObject *args)
{
  const char *uri;
  request_rec *req;


  if (! PyArg_ParseTuple(args, "s", &uri))
    return NULL;

  req = (request_rec *)ap_sub_req_lookup_uri(uri,self->request_rec);
  if (! req) {
    Py_INCREF(Py_None);
    return Py_None;
  }
  else {
    return MpRequest_FromRequest(req);
  }
}


...


    {"lookup_uri",           (PyCFunction) req_lookup_uri,
METH_VARARGS},
    { NULL, NULL } /* sentinel */
};

...




From vincentwong at ionetbiz.com  Sat Jul  7 12:34:35 2001
From: vincentwong at ionetbiz.com (Vincent Wong)
Date: Fri Jan  9 21:46:24 2004
Subject: [mod_python] link to image files broken
References: <014901c10542$3c018ec0$3f00a8c0@ns1.ionetbiz.com><012801c105e3$833099c0$3f00a8c0@ns1.ionetbiz.com> <uhewqiev1.fsf@cs.uu.nl>
Message-ID: <001b01c1069e$206e8d40$3f00a8c0@ns1.ionetbiz.com>

Thanks.  I have make it work.  This is what I did.

--- test.py ---

import os, sys
from mod_python import apache

def saveform(req):
  input = open('/home/demo/html/thanks.html', 'r')
  req.write(input.read())
  return apache.OK


--- thanks.html ---

add the line:

<base href="http://demo.ionetbiz2.com/">


A question here:  the open statement above does not work with relative path,
why?



Regards,
Vincent




From vincentwong at ionetbiz.com  Sat Jul  7 13:10:30 2001
From: vincentwong at ionetbiz.com (Vincent Wong)
Date: Fri Jan  9 21:46:24 2004
Subject: [mod_python] link to image files broken
Message-ID: <003601c106a3$2805f700$3f00a8c0@ns1.ionetbiz.com>

Thanks.  I have make it work.  This is what I did.

--- test.py ---

import os, sys
from mod_python import apache

def saveform(req):
  input = open('/home/demo/html/thanks.html', 'r')
  req.write(input.read())
  return apache.OK


--- thanks.html ---

add the line:

<base href="http://demo.ionetbiz2.com/">


A question here:  the open statement above does not work with relative path,
why?



Regards,
Vincent



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010707/76bd17c3/attachment.htm
From wart at softhome.net  Sat Jul  7 13:03:10 2001
From: wart at softhome.net (Wartan Hachaturow)
Date: Fri Jan  9 21:46:24 2004
Subject: [mod_python] link to image files broken
In-Reply-To: <003601c106a3$2805f700$3f00a8c0@ns1.ionetbiz.com>
Message-ID: <20010707130310.A9632@penguin.aktivist.ru>

On Sat, Jul 07, 2001 at 01:10:30PM +0800, Vincent Wong wrote:

> A question here:  the open statement above does not work with relative path,
> why?

Because it opens the file from the filesystem, and not the one 
served by the web server.

-- 
Regards, Wartan.
echo "Your stdio isn't very std." 
		-- Larry Wall in Configure from the perl distribution

From kees.serier at relan.nl  Sat Jul  7 11:48:09 2001
From: kees.serier at relan.nl (Serier, Kees)
Date: Fri Jan  9 21:46:24 2004
Subject: [mod_python] ld error when trying to build mod-python
Message-ID: <AA2536FEE0A9D311887000508B5EDF1E0219634B@ab00s003.abab.cadans.nl>

Hi,

I'm trying to build mod_python 2.7.5 on AIX, but get the following error
from ld, any ideas or hints?

ld: 0711-244 ERROR: No csects or exported symbols have been saved.
apxs:Break: Command failed with rc=8

Kees Serier mailto:kees.serier@ordina.nl

General information:
   AIX        4.2.1
   GCC        2.95.2 (locally build and installed from source)
   GNU-make   3.79.1 (locally build and installed from source)
   Python     2.0    (locally build from source without threads)
   Apache     1.3.20 (locally build and installed from source with DSO)
   Mod_python 2.7.5

This is the output of configure and make;

[/usr/local/src/mod_python-2.7.5]# ./configure
--with-apxs=/usr/local/apache/bin/apxs --with-apache=../apache_1.3.20
--with-python=../Python-2.0/
creating cache ./config.cache
checking for gcc... gcc
checking whether the C compiler (gcc  ) works... yes
checking whether the C compiler (gcc  ) is a cross-compiler... no
checking whether we are using GNU C... yes
checking whether gcc accepts -g... yes
checking for ranlib... ranlib
checking for ar... ar
checking for a BSD compatible install... ./install-sh -c
checking whether make sets ${MAKE}... yes
checking for main in -lm... yes
checking for working const... yes
checking your blood pressure... a bit high, but we can proceed
checking whether apxs is available
checking for --with-apxs... /usr/local/apache/bin/apxs executable, good
checking for Apache libexec directory... /usr/local/apache/libexec
checking for Apache include directory... -I/usr/local/apache/include
checking for --with-apache... /usr/local/src/apache_1.3.20
checking for --with-python... /usr/local/src/Python-2.0
checking for python... /usr/local/src/Python-2.0/python
checking Python version... 2.0
checking whether Python is compiled with thread support... no threads, good
checking Python install prefix... /usr/local
checking what libraries Python was linked with...
/usr/local/src/Python-2.0/libpython2.0.a   -ldl    -lm
checking linker flags used to link Python...  -Wl,-bE:python.exp -lld
checking where Python include files are... -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include
checking for mkdep... no
checking for makedepend... /usr/bin/X11/makedepend
updating cache ./config.cache
creating ./config.status
creating Makefile
creating src/Makefile
creating src/libpython.module
creating Doc/Makefile
analyzing dependencies
sant[/usr/local/src/mod_python-2.7.5]= gmake
gmake[1]: Entering directory `/usr/local/src/mod_python-2.7.5/src'
gcc  -I/usr/local/src/mod_python-2.7.5/src/include
-I/usr/local/src/apache_1.3.20/src/include
-I/usr/local/src/apache_1.3.20/src/os/unix -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include    -c -o mod_python.o mod_python.c
gcc  -I/usr/local/src/mod_python-2.7.5/src/include
-I/usr/local/src/apache_1.3.20/src/include
-I/usr/local/src/apache_1.3.20/src/os/unix -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include    -c -o _apachemodule.o _apachemodule.c
gcc  -I/usr/local/src/mod_python-2.7.5/src/include
-I/usr/local/src/apache_1.3.20/src/include
-I/usr/local/src/apache_1.3.20/src/os/unix -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include    -c -o requestobject.o requestobject.c
gcc  -I/usr/local/src/mod_python-2.7.5/src/include
-I/usr/local/src/apache_1.3.20/src/include
-I/usr/local/src/apache_1.3.20/src/os/unix -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include    -c -o tableobject.o tableobject.c
gcc  -I/usr/local/src/mod_python-2.7.5/src/include
-I/usr/local/src/apache_1.3.20/src/include
-I/usr/local/src/apache_1.3.20/src/os/unix -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include    -c -o util.o util.c
gcc  -I/usr/local/src/mod_python-2.7.5/src/include
-I/usr/local/src/apache_1.3.20/src/include
-I/usr/local/src/apache_1.3.20/src/os/unix -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include    -c -o serverobject.o serverobject.c
gcc  -I/usr/local/src/mod_python-2.7.5/src/include
-I/usr/local/src/apache_1.3.20/src/include
-I/usr/local/src/apache_1.3.20/src/os/unix -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include    -c -o connobject.o connobject.c

Compiling for DSO. For static, do "make static"

/usr/local/apache/bin/apxs -I/usr/local/src/mod_python-2.7.5/src/include
-I/usr/local/src/apache_1.3.20/src/include
-I/usr/local/src/apache_1.3.20/src/os/unix -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include -c mod_python.o _apachemodule.o
requestobject.o tableobject.o util.o serverobject.o connobject.o  -lm
/usr/local/src/Python-2.0/libpython2.0.a   -ldl    -lm  
ld -H512 -T512 -bhalt:4 -bM:SRE -bnoentry
-bI:/usr/local/apache/libexec/httpd.exp -lc -o mod_python.so mod_python.o
_apachemodule.o requestobject.o tableobject.o util.o serverobject.o
connobject.o -lm /usr/local/src/Python-2.0/libpython2.0.a -ldl -lm
ld: 0711-244 ERROR: No csects or exported symbols have been saved.
apxs:Break: Command failed with rc=8
gmake[1]: *** [mod_python.so] Error 1
gmake[1]: Leaving directory `/usr/local/src/mod_python-2.7.5/src'
gmake: *** [do_dso] Error 2


From WAGLET at uk.ibm.com  Tue Jul 10 17:24:57 2001
From: WAGLET at uk.ibm.com (Tushar Wagle)
Date: Fri Jan  9 21:46:24 2004
Subject: [mod_python] database access within handler problem
Message-ID: <OFA5D85E79.491D0EC1-ON80256A85.00569389@portsmouth.uk.ibm.com>

Hello,

I've got mod_python up and running, but am having a problem connecting to 
my database from inside an AuthenHandler. The code runs fine outside
of mod_python under the 'apache' user, ie the user name/password is
okay, and I've correctly set permissions to allow the user database 
access.

I'm using the latest Python/mod_python with DB2 (and the Python DB2 
wrapper).

Any ideas of what might be wrong?

Are there some restrictions on what can be done (eg different user 
permissions)
from within an Apache Handler??

Could this be a configuration problem?...

Any help appreciated! :)

Best Regards,
Tushar.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010710/e0ad1c98/attachment.htm
From laprice at efn.org  Tue Jul 10 14:51:34 2001
From: laprice at efn.org (larry a price)
Date: Fri Jan  9 21:46:24 2004
Subject: [mod_python] ModPython problems
In-Reply-To: <B770C6FE.38FB%tr@outputlinks.com>
Message-ID: <Pine.GSU.4.21.0107101432040.2738-100000@garcia.efn.org>

Hi, i'm trying to get WebWare 0.5 working with mod_python
i keep on getting this ImportError: module _apache not found
when trying to launch the ModPythonAppServer,
mod_python seems to work fine on it's own, the only thing i can see is
that there is no _apachemodule.so in lib-dynload, though there is an
_apachemodule.o in the build directory from which i installed mod_python,
can i just cp and rename that file or do i need to grovel through the
MakeFile and make sure that it's built as a shared library.

I'm running:
apache 1.3
mod_python 2.7.3
Webware 0.5
on
Debian 2.2.19pre17

Larry Price      |  "We have seen the truth.
laprice@efn.org  |   And the truth makes no sense." -chesterton
_______________________________________________________________





From ChuckEsterbrook at yahoo.com  Tue Jul 10 18:32:25 2001
From: ChuckEsterbrook at yahoo.com (Chuck Esterbrook)
Date: Fri Jan  9 21:46:24 2004
Subject: [mod_python] Re: [Webware-discuss] ModPython problems
In-Reply-To: <Pine.GSU.4.21.0107101432040.2738-100000@garcia.efn.org>
References: <B770C6FE.38FB%tr@outputlinks.com>
Message-ID: <5.0.2.1.0.20010710182905.027669f0@mail.mindspring.com>

At 02:51 PM 7/10/2001 -0700, larry a price wrote:
>Hi, i'm trying to get WebWare 0.5 working with mod_python
>i keep on getting this ImportError: module _apache not found
>when trying to launch the ModPythonAppServer,
>mod_python seems to work fine on it's own, the only thing i can see is
>that there is no _apachemodule.so in lib-dynload, though there is an
>_apachemodule.o in the build directory from which i installed mod_python,
>can i just cp and rename that file or do i need to grovel through the
>MakeFile and make sure that it's built as a shared library.
>
>I'm running:
>apache 1.3
>mod_python 2.7.3
>Webware 0.5
>on
>Debian 2.2.19pre17

I'm sorry to say I don't know the answer to your question, but I'm 
wondering if you really want to run the ModPythonAppServer, as opposed to 
the ModPython adapter which connects to a separately launched app server. 
That is the usual technique (e.g., your choice of adapter, plus the WebKit 
app server) used to run WebKit, because you can then restart the app server 
separate from the web server.

You should consider embedding the app server inside a web server to be more 
experimental, and I suppose the docs should reflect that.

In any case, it might help with diagnosing your problem if you could try 
the ModPythonAdapter and see if that suffers the same problems.


-Chuck


From laprice at efn.org  Tue Jul 10 15:59:49 2001
From: laprice at efn.org (larry a price)
Date: Fri Jan  9 21:46:24 2004
Subject: [mod_python] Re: [Webware-discuss] ModPython problems
In-Reply-To: <5.0.2.1.0.20010710182905.027669f0@mail.mindspring.com>
Message-ID: <Pine.GSU.4.21.0107101547330.5384-100000@garcia.efn.org>

On Tue, 10 Jul 2001, Chuck Esterbrook wrote:
> 
> I'm sorry to say I don't know the answer to your question, but I'm 
> wondering if you really want to run the ModPythonAppServer, as opposed to 
> the ModPython adapter which connects to a separately launched app server. 
> That is the usual technique (e.g., your choice of adapter, plus the WebKit 
> app server) used to run WebKit, because you can then restart the app server 
> separate from the web server.
>
OK, i did get the Webkit.cgi to work and the ModPythonAdapter seems to
work, does the correct redirect, I guess i was under the impression from
the docs that ModPythonAdapter 'required' ModPythonAppserver to work
correctly. Since that's not the case I'm not sure i understand why
ModPythonAppServer exists... it doesn't look like it enables any 
additional functionality. (aside from diddling the apache API)
the import _apache failure still bugs me though (anyone on the mod_python
front who can offer their wisdom?)


From ChuckEsterbrook at yahoo.com  Tue Jul 10 19:13:01 2001
From: ChuckEsterbrook at yahoo.com (Chuck Esterbrook)
Date: Fri Jan  9 21:46:24 2004
Subject: [mod_python] Re: [Webware-discuss] ModPython problems
In-Reply-To: <Pine.GSU.4.21.0107101547330.5384-100000@garcia.efn.org>
References: <5.0.2.1.0.20010710182905.027669f0@mail.mindspring.com>
Message-ID: <5.0.2.1.0.20010710191019.02ca79a0@mail.mindspring.com>

At 03:59 PM 7/10/2001 -0700, larry a price wrote:
>OK, i did get the Webkit.cgi to work and the ModPythonAdapter seems to
>work, does the correct redirect, I guess i was under the impression from
>the docs that ModPythonAdapter 'required' ModPythonAppserver to work
>correctly. Since that's not the case I'm not sure i understand why
>ModPythonAppServer exists... it doesn't look like it enables any
>additional functionality. (aside from diddling the apache API)
>the import _apache failure still bugs me though (anyone on the mod_python
>front who can offer their wisdom?)

Most WebKit app server flavors run as separate Python processes launched 
from the command line:

python Launch.py ThreadedAppServer


But ModPythonAppServer is special: He lives *inside* Apache/mod_python. 
That also means he needs no adapter to shuttle requests and responses 
between himself and the web server.

Presumably this reduces the overhead of having the web and app server talk 
via TCP/IP for greater performance. However, you probably also get multiple 
child process versions of your app server which could easily confound your 
application logic at the very least. And the inability to restart the app 
server independently (as I mentioned earlier).

ModPythonAppServer is due to be moved to an Experimental/ subdirectory.


-Chuck


From jal at faxnet.com  Wed Jul 11 14:22:23 2001
From: jal at faxnet.com (Jonathan LaCour)
Date: Fri Jan  9 21:46:24 2004
Subject: [mod_python] SOAP Handler questions...
Message-ID: <994875744.20546.1.camel@dev7>

Hello,

I am a developer working at a small software company, and we are
researching using mod_python to help us in making a fast SOAP server.
All of the SOAP implementations that I can find use either the built in
Python HTTPServer (which is slow) or Medusa (which has other issues that
I would like to avoid).

Has someone out there developed a Handler for mod_python that would
allow me to easily provide SOAP web services?  If so, please let me know
where I can find the handler.  If not, I would consider developing this
myself.  I just don't want to re-invent the wheel here =)

Thanks in advance!  Also note that I am not subscribed to this list, so
please CC your resposes to me.

Jonathan LaCour



From rsalz at zolera.com  Wed Jul 11 15:12:01 2001
From: rsalz at zolera.com (Rich Salz)
Date: Fri Jan  9 21:46:24 2004
Subject: [mod_python] SOAP Handler questions...
References: <994875744.20546.1.camel@dev7>
Message-ID: <3B4CA501.5ED2429E@zolera.com>

> Has someone out there developed a Handler for mod_python that would
> allow me to easily provide SOAP web services?

ZSI, the Zolera Soap Infrastructure, can work this way -- that's how we
use it (and why we wrote it :).  I believe the ActZero SOAP.py
(pywebsvcs.sf.net) can also work under mod_python.  Both are open
source; ZSI will be released in a week or two
(www.zolera.com/resources/opensrc); documentation is avail at the
referenced link.
	/r$
-- 
Zolera Systems, Securing Web services (XML, SOAP, Signatures,
Encryption)
http://www.zolera.com

From jonas.b at home.se  Thu Jul 12 03:50:29 2001
From: jonas.b at home.se (Jonas Bengtsson)
Date: Fri Jan  9 21:46:24 2004
Subject: [mod_python] Problems getting mod_python up n' running
Message-ID: <NEBBLNLDOLDEJIKDPCBOCEBHCEAA.jonas.b@home.se>

Hi,
I can't get mod_python to work. I get this error message when I'm restarting
Apache:
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
And when I try to look at a .py page I get following error:
[Thu Jul 12 03:33:12 2001] [error] [client 127.0.0.1] python_handler:
make_obcallback returned no obCallBack!

What is wrong?
I've got: Apache/1.3.19 (Win32) mod_python/2.7.4 Python/2.1
Running under Windows 2000

I have put mod_python.dll.in E:\program\apache\modules and following rows to
httpd.conf:
#DSO section
LoadModule python_module e:/program/apache/modules/mod_python.dll
#under my main directory
    AddHandler python-program .py
    PythonHandler mptest
    PythonDebug on

Furthermore I have put following files under
e:\program\python21\libs\mod_python:
__init__.py
apache.py
cgihandler.py
httpdapi.py
publisher.py
util.py
zhandler.py

And my environment path contains:
E:\Program\Python21;e:\Program\Python21\libs


What can be the problem?

TIA
Jonas Bengtsson



From mhughe at ucalgary.ca  Wed Jul 11 22:41:49 2001
From: mhughe at ucalgary.ca (Matt Hughes)
Date: Fri Jan  9 21:46:24 2004
Subject: [mod_python] patch for default functions in the publisher handler (fwd)
Message-ID: <Pine.A41.4.10.10107112241270.125366-200000@acs4.acs.ucalgary.ca>

This is sort of a follow up to this message:
http://www.modpython.org/pipermail/mod_python/2001-June/001421.html, which
discussed how to call a default function from a file using the publisher
handler. 

I wanted similar functionality, but didn't want to resort to the redirect
directive suggested in the last message of that thread. This patch looks
for the PATH_INFO as before, but instead of raising an
apache.HTTP_NOT_FOUND, it puts "default" in func_path as the default
function to call. 

The default function could be made a configuration directive, but I
haven't investigated that. 

This patch also solves some problems I was having when importing modules
in sub-directories. I had a structure like this:

/
/subdir1
/subdir1/subdir2
/subdir1/subdir2/subdir3

and so on, with each directory containing a index.py file which is
configured as the index with the DirectoryIndex directive. The problem was
that a URL refering to /subdir1/subdir2/subdir3 or whatever always found
the index.py file in /. 

This patch fixes this by treating directories off the root as packages.
It's a compelete hack, but it works for me. 


//
// Matt Hughes
// http://www.ucalgary.ca/~mhughe
//

-------------- next part --------------
--- orig-pub.py	Mon Jul  9 20:43:40 2001
+++ publisher.py	Mon Jul  9 20:53:26 2001
@@ -65,6 +65,8 @@
 
 import new
 
+import sys
+
 # list of suffixes - .py, .pyc, etc.
 suffixes = map(lambda x: x[0], imp.get_suffixes())
 
@@ -81,10 +83,11 @@
 
     # get the path PATH_INFO (everthing after script)
     if not _req.subprocess_env.has_key("PATH_INFO"):
-        raise apache.SERVER_RETURN, apache.HTTP_NOT_FOUND
-    
-    func_path = _req.subprocess_env["PATH_INFO"][1:] # skip fist /
-    func_path = string.replace(func_path, "/", ".")
+        func_path = "default"  # Call for a default method
+    else:
+        func_path = _req.subprocess_env["PATH_INFO"][1:] # skip fist /
+        func_path = string.replace(func_path, "/", ".")
+        
     if func_path[-1] == ".":
         func_path = func_path[:-1] 
 
@@ -118,11 +121,19 @@
     # add req
     args["req"] = req
 
-    # import the script
-    path, module_name =  os.path.split(_req.filename)
+    l = len(sys.path[0])
+    module_name = _req.filename[l:]
 
-    # get rid of the suffix
+    # get rid of the suffix... 
     module_name = suff_matcher.sub("", module_name)
+
+    # An alternate way to get rid of the suffix
+    #pos = string.rfind(module_name, '.')
+    #module_name = module_name[:pos]      
+
+    module_name = string.replace(module_name, '/', '.')
+
+    path = _req.filename[0:l]
 
     # import module (or reload if needed)
     module = apache.import_module(module_name, _req, [path])
From Daryl.Johnson at RebusHR.com  Thu Jul 12 14:52:46 2001
From: Daryl.Johnson at RebusHR.com (Daryl.Johnson@RebusHR.com)
Date: Fri Jan  9 21:46:24 2004
Subject: [mod_python] Problems with apxs
Message-ID: <DDA89578AFB4D411AF4700B0D068618C0802BA@PSN004>

I have RedHat 6.2, Apache 1.3.20 and Python2.1.
I have downloaded mod_python-2.7.5.
I have compiled Apache with DSO support and compiled Python without thread
support.
I am unable to compile mod_python as a DSO.
apxs reports an error - rc=255.
I have re-arranged the parameters to apxs but only seem able to get two
responses from it.  It either displays its short help text or reports back
with - rc=255.  Any ideas?  I am at the end of my tether.

Thanks in advance
Daryl Johnson
(RebusHR)


From piet at cs.uu.nl  Thu Jul 12 23:26:32 2001
From: piet at cs.uu.nl (Piet van Oostrum)
Date: Fri Jan  9 21:46:25 2004
Subject: [mod_python] Problems getting mod_python up n' running
In-Reply-To: "Jonas Bengtsson"'s message of "Thu, 12 Jul 2001 03:50:29 +0200"
References: <NEBBLNLDOLDEJIKDPCBOCEBHCEAA.jonas.b@home.se>
Message-ID: <wz66cxrg8n.fsf@sunshine.cs.uu.nl>

>>>>> "Jonas Bengtsson" <jonas.b@home.se> (JB) writes:

JB> Furthermore I have put following files under
JB> e:\program\python21\libs\mod_python:

That should be in e:\program\python21\mod_python

JB> And my environment path contains:
JB> E:\Program\Python21;e:\Program\Python21\libs

You mean PATH? The last part is not necessary.

JB> What can be the problem?

See above.
-- 
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl

From jonas.b at home.se  Thu Jul 12 23:38:11 2001
From: jonas.b at home.se (Jonas Bengtsson)
Date: Fri Jan  9 21:46:25 2004
Subject: [mod_python] Problems getting mod_python up n' running
In-Reply-To: <wz66cxrg8n.fsf@sunshine.cs.uu.nl>
Message-ID: <NEBBLNLDOLDEJIKDPCBOAEBICEAA.jonas.b@home.se>

Thanks... now I got rid off the :
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.

But : [Thu Jul 12 23:30:34 2001] [error] [client 127.0.0.1] python_handler:
make_obcallback returned no obCallBack!
Still occurs... any ideas


/Jonas Bengtsson

-----Original Message-----
From: piet@cs.uu.nl [mailto:piet@cs.uu.nl]
Sent: Thursday, July 12, 2001 11:27 PM
To: Jonas Bengtsson
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Problems getting mod_python up n' running

>>>>> "Jonas Bengtsson" <jonas.b@home.se> (JB) writes:

JB> Furthermore I have put following files under
JB> e:\program\python21\libs\mod_python:

That should be in e:\program\python21\mod_python

JB> And my environment path contains:
JB> E:\Program\Python21;e:\Program\Python21\libs

You mean PATH? The last part is not necessary.

JB> What can be the problem?

See above.
--
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl


From Daryl.Johnson at RebusHR.com  Fri Jul 13 11:08:12 2001
From: Daryl.Johnson at RebusHR.com (Daryl.Johnson@RebusHR.com)
Date: Fri Jan  9 21:46:25 2004
Subject: [mod_python] Problems getting mod_python up n' running
Message-ID: <DDA89578AFB4D411AF4700B0D068618C0802BD@PSN004>

I was getting messages very similar to these right up until yesterday.
Although I'm using Linux and you are using Windows, I think the problem
might stem from the same thing.
Mine turned out to be a linker problem when mod_python.so (I think .dll in
your case) was being built.
The mod_python.so file was only half the size that it is now that it is
working.
It was about 700Kb and is now about 1.5Mb.  These sizes might be different
on Windows, but it is clear to me that mod_python.so had not linked in a
whole sack of libraries that it would need.
I hope this is of some help

Daryl Johnson.

-----Original Message-----
From: Jonas Bengtsson [mailto:jonas.b@home.se]
Sent: Thursday, July 12, 2001 10:38 PM
To: piet@cs.uu.nl
Cc: mod_python@modpython.org
Subject: RE: [mod_python] Problems getting mod_python up n' running


Thanks... now I got rid off the :
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.

But : [Thu Jul 12 23:30:34 2001] [error] [client 127.0.0.1] python_handler:
make_obcallback returned no obCallBack!
Still occurs... any ideas


/Jonas Bengtsson

-----Original Message-----
From: piet@cs.uu.nl [mailto:piet@cs.uu.nl]
Sent: Thursday, July 12, 2001 11:27 PM
To: Jonas Bengtsson
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Problems getting mod_python up n' running

>>>>> "Jonas Bengtsson" <jonas.b@home.se> (JB) writes:

JB> Furthermore I have put following files under
JB> e:\program\python21\libs\mod_python:

That should be in e:\program\python21\mod_python

JB> And my environment path contains:
JB> E:\Program\Python21;e:\Program\Python21\libs

You mean PATH? The last part is not necessary.

JB> What can be the problem?

See above.
--
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python

From grisha at modpython.org  Fri Jul 13 11:14:07 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:25 2004
Subject: [mod_python] Error: No such file or directory
In-Reply-To: <Pine.LNX.4.31.0107031247070.13943-100000@unity.copyleft.no>
Message-ID: <Pine.BSF.4.32.0107131113440.94495-100000@localhost>

I've added a FAQ entry on this one:

http://www.modpython.org/FAQ/faqw.py?req=all#2.3

Grisha

On Tue, 3 Jul 2001, Hr. Daniel Mikkelsen wrote:

> >> OSError: [Errno 2] No such file or directory: '/home/demo/cgi-bin/test.p'
>
> > Have a closer look at the filename.  I think this is a typo.
>
> I don't know if it's the same thing here, but I'm running FreeBSD, and
> mod_python erranously cuts the last character of filename of the handler
> I've given. I had to remove a [:-1] suffix a couple of places in apache.py
> (I think) to get it to work.
>
> I'll post more details if it's interesting to anyone.
>
> -- Daniel Mikkelsen, Copyleft Software AS
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From jonas.b at home.se  Fri Jul 13 19:33:57 2001
From: jonas.b at home.se (Jonas Bengtsson)
Date: Fri Jan  9 21:46:25 2004
Subject: [mod_python] Problems getting mod_python up n' running
In-Reply-To: <DDA89578AFB4D411AF4700B0D068618C0802BD@PSN004>
Message-ID: <NEBBLNLDOLDEJIKDPCBOGEBKCEAA.jonas.b@home.se>

I don't think that is the problem in my case. My mod_python.dll is about 45
kb and that seems normal

Does any one else have a clue? I'm about to look elsewhere for Python
support in Apache... mod_python seems to work very poorly under Windows.


Jonas Bengtsson

-----Original Message-----
From: Daryl.Johnson@RebusHR.com [mailto:Daryl.Johnson@RebusHR.com]
Sent: Friday, July 13, 2001 12:08 PM
To: jonas.b@home.se
Cc: mod_python@modpython.org
Subject: RE: [mod_python] Problems getting mod_python up n' running

I was getting messages very similar to these right up until yesterday.
Although I'm using Linux and you are using Windows, I think the problem
might stem from the same thing.
Mine turned out to be a linker problem when mod_python.so (I think .dll in
your case) was being built.
The mod_python.so file was only half the size that it is now that it is
working.
It was about 700Kb and is now about 1.5Mb.  These sizes might be different
on Windows, but it is clear to me that mod_python.so had not linked in a
whole sack of libraries that it would need.
I hope this is of some help

Daryl Johnson.

-----Original Message-----
From: Jonas Bengtsson [mailto:jonas.b@home.se]
Sent: Thursday, July 12, 2001 10:38 PM
To: piet@cs.uu.nl
Cc: mod_python@modpython.org
Subject: RE: [mod_python] Problems getting mod_python up n' running


Thanks... now I got rid off the :
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.

But : [Thu Jul 12 23:30:34 2001] [error] [client 127.0.0.1] python_handler:
make_obcallback returned no obCallBack!
Still occurs... any ideas


/Jonas Bengtsson

-----Original Message-----
From: piet@cs.uu.nl [mailto:piet@cs.uu.nl]
Sent: Thursday, July 12, 2001 11:27 PM
To: Jonas Bengtsson
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Problems getting mod_python up n' running

>>>>> "Jonas Bengtsson" <jonas.b@home.se> (JB) writes:

JB> Furthermore I have put following files under
JB> e:\program\python21\libs\mod_python:

That should be in e:\program\python21\mod_python

JB> And my environment path contains:
JB> E:\Program\Python21;e:\Program\Python21\libs

You mean PATH? The last part is not necessary.

JB> What can be the problem?

See above.
--
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python


From piet at cs.uu.nl  Fri Jul 13 21:48:40 2001
From: piet at cs.uu.nl (Piet van Oostrum)
Date: Fri Jan  9 21:46:25 2004
Subject: [mod_python] Problems getting mod_python up n' running
In-Reply-To: "Jonas Bengtsson"'s message of "Fri, 13 Jul 2001 19:33:57 +0200"
References: <NEBBLNLDOLDEJIKDPCBOGEBKCEAA.jonas.b@home.se>
Message-ID: <wz4rsgmwyv.fsf@sunshine.cs.uu.nl>

>>>>> "Jonas Bengtsson" <jonas.b@home.se> (JB) writes:

JB> I don't think that is the problem in my case. My mod_python.dll is about 45
JB> kb and that seems normal

JB> Does any one else have a clue? I'm about to look elsewhere for Python
JB> support in Apache... mod_python seems to work very poorly under Windows.

That is not true. However you must be careful to install it properly:
- use the correct version of the dll (corresponding to the python version)
- put the dll in the Apache module directory
- add the LoadModule clause to Apache's config file
- add the handler declaration to Apache's config
- put the .py files n the proper Python directory
-- 
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl

From jonas.b at home.se  Sat Jul 14 11:19:50 2001
From: jonas.b at home.se (Jonas Bengtsson)
Date: Fri Jan  9 21:46:25 2004
Subject: [mod_python] Problems getting mod_python up n' running
In-Reply-To: <wz4rsgmwyv.fsf@sunshine.cs.uu.nl>
Message-ID: <NEBBLNLDOLDEJIKDPCBOGEBLCEAA.jonas.b@home.se>

Ahh... Now I got it to work. It wasn't the environment PATH variable that I
should change but the PythonPath variable in the Registry.

Now I get the following error:
"""
Mod_python error: "PythonHandler mptest"

Traceback (most recent call last):

  File "e:\program\python21\mod_python\apache.py", line 181, in Dispatch
    module = import_module(module_name, _req)

  File "e:\program\python21\mod_python\apache.py", line 335, in
import_module
    f, p, d = imp.find_module(parts[i], path)

ImportError: No module named mptest
"""
But I have not looked into it to see why this occurs so I guess it is just
something trivial..

Thanks for all help!

/Jonas B

-----Original Message-----
From: piet@cs.uu.nl [mailto:piet@cs.uu.nl]
Sent: Friday, July 13, 2001 9:49 PM
To: Jonas Bengtsson
Cc: Daryl.Johnson@RebusHR.com; mod_python@modpython.org
Subject: Re: [mod_python] Problems getting mod_python up n' running

>>>>> "Jonas Bengtsson" <jonas.b@home.se> (JB) writes:

JB> I don't think that is the problem in my case. My mod_python.dll is about
45
JB> kb and that seems normal

JB> Does any one else have a clue? I'm about to look elsewhere for Python
JB> support in Apache... mod_python seems to work very poorly under Windows.

That is not true. However you must be careful to install it properly:
- use the correct version of the dll (corresponding to the python version)
- put the dll in the Apache module directory
- add the LoadModule clause to Apache's config file
- add the handler declaration to Apache's config
- put the .py files n the proper Python directory
--
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl


From piet at cs.uu.nl  Sun Jul 15 16:11:44 2001
From: piet at cs.uu.nl (Piet van Oostrum)
Date: Fri Jan  9 21:46:25 2004
Subject: [mod_python] Problems getting mod_python up n' running
In-Reply-To: "Jonas Bengtsson"'s message of "Sat, 14 Jul 2001 11:19:50 +0200"
References: <NEBBLNLDOLDEJIKDPCBOGEBLCEAA.jonas.b@home.se>
Message-ID: <wzsnfygu3j.fsf@sunshine.cs.uu.nl>

>>>>> "Jonas Bengtsson" <jonas.b@home.se> (JB) writes:

JB> Ahh... Now I got it to work. It wasn't the environment PATH variable that I
JB> should change but the PythonPath variable in the Registry.

In fact, if you put the files in the subdirectory mod_python of your main
Python directory, this is not necessary. Anyway, the libs directory is the
wrong one, because it is meant for .lib files (which you only need if you
compile python extensions).

JB> Now I get the following error:
JB> """
JB> Mod_python error: "PythonHandler mptest"

JB> Traceback (most recent call last):

JB>   File "e:\program\python21\mod_python\apache.py", line 181, in Dispatch
JB>     module = import_module(module_name, _req)

JB>   File "e:\program\python21\mod_python\apache.py", line 335, in
JB> import_module
JB>     f, p, d = imp.find_module(parts[i], path)

JB> ImportError: No module named mptest
JB> """
JB> But I have not looked into it to see why this occurs so I guess it is just
JB> something trivial..

It probably means that mptest.py is not in the directory that is mentioned
as the PythonHandler in your Apache config file. Maybe you gave it another
name. 
-- 
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl

From tree at basistech.com  Tue Jul 17 15:54:07 2001
From: tree at basistech.com (Tom Emerson)
Date: Fri Jan  9 21:46:25 2004
Subject: [mod_python] Import errors in 2.7.5
Message-ID: <15188.38879.991539.849967@cymru.basistech.com>

I'm repeatedly getting an error using mod_python 2.7.5, Python 2.0
with exceptions patch, Apache 1.3.19, on FreeBSD 4.2:

ue Jul 17 16:29:46 2001] [error] PythonHandler mod_python.publisher: Traceback (most recent call last):
[Tue Jul 17 16:29:46 2001] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.0/site-packages/mod_python/apache.py", line 193, in Dispatch
    result = object(req)
[Tue Jul 17 16:29:46 2001] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.0/site-packages/mod_python/publisher.py", line 128, in handler
    module = apache.import_module(module_name, _req, [path])
[Tue Jul 17 16:29:46 2001] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.0/site-packages/mod_python/apache.py", line 364, in import_module
    module = reload(module)
[Tue Jul 17 16:29:46 2001] [error] PythonHandler mod_python.publisher: ImportError: No module named add

I have to shutdown the server and start it back up to make this go
away, at which point things are fine for a while, then it comes
back. Suffice it to say this is annoying.

Before I start digging, has anyone else seen this? I never saw this in
2.7.1 (the previous version I had installed).

TIA,

    -tree

-- 
Tom Emerson                                          Basis Technology Corp.
Sr. Sinostringologist                              http://www.basistech.com
  "Beware the lollipop of mediocrity: lick it once and you suck forever"

From a_mayerson at yahoo.com  Tue Jul 17 20:12:05 2001
From: a_mayerson at yahoo.com (aaron mayerson)
Date: Fri Jan  9 21:46:25 2004
Subject: [mod_python] Function sequence error
Message-ID: <20010718031205.98105.qmail@web10906.mail.yahoo.com>

Greetings,

  I have a script that works from the command line but
not with mod_python and apache.  I've looked elsewhere
and found that this error relates to the odbc calls
being called out of order.
  I'm not exactly sure why the heck the calls would be
out of order when running through mod_python and
apache and not when run from the command line. 
Anybody have a clue as to why this is happening?
  Thanks for the help...

The error:

Mod_python error: "PythonHandler stats"

Traceback (most recent call last):

  File "d:\python21\lib\mod_python\apache.py", line
181, in Dispatch

  File "d:\python21\lib\mod_python\apache.py", line
364, in import_module

  File "c:/program files/apache
group/apache/htdocs/python/\stats.py", line 7, in ?
    db = mx.DriverConnect('DSN=stats')

InternalError: ('S1010', 0, '[Microsoft][ODBC Driver
Manager] Function sequence error', 5806)

The code:

import sping.PIL as pid
import mx.ODBC.Windows as mx
from os import chdir



db = mx.DriverConnect('DSN=stats')
cur = db.cursor()
cur.execute('select * from address_count')
values = cur.fetchall()
cur.close()
db.close()

hits = 0
for value in values:
    hits += value[1]

canvas = pid.PILCanvas(size=(600,
(len(values)*15)+15))
canvas.defaultLineWidth = 7.5
canvas.defaultLineColor = pid.red
y1 = 15
x1 = 100
y2 = 15
for value in values:
    x2 = 100 + (3000 * (float(value[1])/hits))
    canvas.drawLine(x1, y1, x2, y2)
    canvas.drawString(value[0], 5, (y1+2.5),
pid.Font(face="monospaced",size=10),
                      color=pid.black)
    canvas.drawString(str(value[1]), (x2+10),
(y1+2.5), pid.Font(face="monospaced",size=10),
                      color=pid.black)
    y1 += 15
    y2 += 15

canvas.flush()
chdir(r'c:\program files\apache
group\apache\htdocs\python')
canvas.save('hits', format='gif')

__________________________________________________
Do You Yahoo!?
Get personalized email addresses from Yahoo! Mail
http://personal.mail.yahoo.com/

From garyp at asti-usa.com  Wed Jul 18 16:10:51 2001
From: garyp at asti-usa.com (Gary Perez)
Date: Fri Jan  9 21:46:25 2004
Subject: [mod_python] Dispatch() returned nothing (?)
Message-ID: <3B55ED4A.63051A14@asti-usa.com>

Hi, all.

Looking forward to getting this working... either that or it's back to
Zope! ;)

Here's the installation info:
SuSE Linux 7.2, kernel 2.4.4, reiserfs
Apache 1.3.19 + Python 2.0 + mod_python 2.7.2

(Note: I attempted to install mod_python 2.7.5 from source, and that
completely hosed Apache, so I went back to the YAST2-based 2.7.2 installation.)

I'm stuck at the "2.4 Testing" section; Apache is throwing an internal
server error on attempt to load http://localhost/test/mptest.py . Here
are pieces of the relevant files:

ERROR LOG
[Wed Jul 18 15:58:02 2001] [notice] Apache/1.3.19 (Unix)  (SuSE/Linux)
mod_layout/1.0 mod_throttle/3.0 mod_fastcgi/2.2.2 mod_ssl/2.8.3
OpenSSL/0.9.6a PHP/4.0.4pl1 mod_perl/1.25 mod_dtcl mod_python/2.7.2
Python/2.0 configured -- resuming normal operations
[Wed Jul 18 15:58:02 2001] [notice] suEXEC mechanism enabled (wrapper: /usr/sbin/suexec)
[Wed Jul 18 15:58:18 2001] [error] [client 192.168.100.100]
python_handler: Dispatch() returned nothing.

HTTPD.CONF
<Directory "/usr/local/httpd/htdocs/test">
    AddHandler python-program .py
    PythonHandler mptest
    PythonDebug On
    AllowOverride All
</Directory>

.HTACCESS
AddHandler python-program .py
PythonHandler mptest
PythonDebug On

I also tried it without the "AllowOverride" line in httpd.conf and no
.htaccess file in the directory, but it throws the same error.

Any ideas as to what I'm doing wrong? Thanks in advance for your help!
-Gary

From mikael.johansson at sema.se  Thu Jul 19 13:52:10 2001
From: mikael.johansson at sema.se (Mikael Johansson)
Date: Fri Jan  9 21:46:25 2004
Subject: [mod_python] Compiling problem.
Message-ID: <01c201c11049$3e77f330$036716ac@got.sema.se>

Hello everyone.

I have a problem to include pyhton into my apache configuration.

I'm running HP-UX Ver 11.0

I have downloade apache 1.13.12

I have downloaded and installed Python 1.5.2 (configure, make and make install)

I have downloded mod_python 2.7.5 and have run configure, make and make install... 

No problem so fare... (not so many anyway..)

My problem is when I go back to Apache and run..

./configure --activate-module=src/modules/python/libpython.a

It runs whith no error, after that I try to the small command make, output below, any Ideas ? 

=== cut ==

<=== src/modules

cc -c -I./os/unix -I./include -DHPUX11 -Aa -Ae -D_HPUX_SOURCE -DUSE_HSREGEX -DUSE_EXPAT -I./lib/expat-lite -DNO_DL_NEEDEc

cc -c -I./os/unix -I./include -DHPUX11 -Aa -Ae -D_HPUX_SOURCE -DUSE_HSREGEX -DUSE_EXPAT -I./lib/expat-lite -DNO_DL_NEEDEc

cc -DHPUX11 -Aa -Ae -D_HPUX_SOURCE -DUSE_HSREGEX -DUSE_EXPAT -I./lib/expat-lite -DNO_DL_NEEDED `./apaci` \

-o httpd buildmark.o modules.o modules/python/libpython.a modules/standard/libstandard.a main/libmain.a ./os/unixd

/usr/ccs/bin/ld: Unsatisfied symbols:

PyObject_HasAttrString (code)

PyString_AsString (code)

PyModule_GetDict (code)

Py_OptimizeFlag (data)

PyThreadState_Delete (code)

PyExc_TypeError (data)

PySequence_Index (code)

PyDict_New (code)

PyCObject_AsVoidPtr (code)

PyImport_ImportModule (code)

PyCObject_FromVoidPtr (code)

_PyString_Resize (code)

PyErr_Fetch (code)

PyObject_Str (code)

PyList_Size (code)

PyString_ConcatAndDel (code)

PyDict_GetItem (code)

PyDict_SetItem (code)

Py_BuildValue (code)

PyEval_SaveThread (code)

PyCallable_Check (code)

PyObject_CallMethod (code)

PyExc_IndexError (data)

PyErr_NoMemory (code)

Py_FindMethod (code)

PyTuple_SetItem (code)

PyMember_Set (code)

PyDict_GetItemString (code)

PyMapping_HasKeyString (code)

PyErr_NewException (code)

PyList_New (code)

PyList_SetItem (code)

PyExc_AttributeError (data)

PyObject_CallFunction (code)

PyErr_Print (code)

PyInt_Type (data)

PyType_Type (data)

PyObject_GetAttrString (code)

PyThreadState_Swap (code)

PyErr_Occurred (code)

PyString_Type (data)

PyDict_SetItemString (code)

PyThreadState_New (code)

PyString_FromString (code)

PyMember_Get (code)

Py_Initialize (code)

PyInt_AsLong (code)

PyExc_ValueError (data)

PyEval_RestoreThread (code)

PyErr_BadArgument (code)

PyArg_ParseTuple (code)

Py_IsInitialized (code)

Py_NewInterpreter (code)

PyExc_KeyError (data)

PyExc_IOError (data)

PyList_Append (code)

PyString_FromStringAndSize (code)

Py_InitModule4 (code)

PyErr_SetObject (code)

PyList_SetSlice (code)

PyErr_Clear (code)

Py_Finalize (code)

_Py_NoneStruct (data)

PyErr_SetString (code)

Py_GetVersion (code)

PyInt_FromLong (code)

PyTuple_New (code)

*** Error exit code 1

Stop.

*** Error exit code 1

Stop.

*** Error exit code 1

Stop.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010719/390bb364/attachment.htm
From markus.hillebrand at apis-group.net  Thu Jul 19 13:57:54 2001
From: markus.hillebrand at apis-group.net (markus.hillebrand@apis-group.net)
Date: Fri Jan  9 21:46:25 2004
Subject: [mod_python] mod_python + MySQLdb => does it work?
Message-ID: <XFMail.010719135754.markus.hillebrand@apis.intra>


 Hello to all you out there!

I tried to bring mod_python and MySQLdb together,
but I crashed on some problems.

First of all: mod_python runs quite fine.
Also MySQLdb runs quite well.

But when I try to import MySQLdb from a python-script
that was invoked by mod_python I get a

ImportError: _mysql: init failed 
(whole error message is in the attachement)

System: Linux 6.4(i386) - Kernel 2.2.14(4)
        apache 1.3.19
        Python 2.0
        mod_python 2.7.5
        MySQLdb 0.9.0

Has somebody out there a running system like this?
Would be very helpfull to bring mod_python and MySQLdb
together - or is there another solution to access
a MySQL database?

        Bye, Markus        

-- 
Markus Hillebrand, Dipl.Inf.(FH), Software-Engineer
Apis networks GmbH, Kronstadter Str. 11, 81677 Muenchen, Germany
Tel.: +49 (089) 357147-23 ; eMail: markus.hillebrand@apis-group.net
-------------- next part --------------
A non-text attachment was scrubbed...
Name: error.html
Type: application/octet-stream
Size: 639 bytes
Desc: error.html
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20010719/6957c32e/error.obj
From tree at basistech.com  Thu Jul 19 07:37:26 2001
From: tree at basistech.com (Tom Emerson)
Date: Fri Jan  9 21:46:25 2004
Subject: [mod_python] mod_python + MySQLdb => does it work?
In-Reply-To: <XFMail.010719135754.markus.hillebrand@apis.intra>
References: <XFMail.010719135754.markus.hillebrand@apis.intra>
Message-ID: <15190.50806.775640.191120@cymru.basistech.com>

markus.hillebrand@apis-group.net writes:
> I tried to bring mod_python and MySQLdb together,
> but I crashed on some problems.

This works very well.

> First of all: mod_python runs quite fine.
> Also MySQLdb runs quite well.
> 
> But when I try to import MySQLdb from a python-script
> that was invoked by mod_python I get a
> 
> ImportError: _mysql: init failed 
> (whole error message is in the attachement)

Check your Python load path within mod_python, and make sure that the
directory containing the MySQLdb modules is there. Also make sure that
the MySQLdb shared object can be found in the library search path.


-- 
Tom Emerson                                          Basis Technology Corp.
Sr. Sinostringologist                              http://www.basistech.com
  "Beware the lollipop of mediocrity: lick it once and you suck forever"

From markus.hillebrand at apis-group.net  Thu Jul 19 14:47:07 2001
From: markus.hillebrand at apis-group.net (markus.hillebrand@apis-group.net)
Date: Fri Jan  9 21:46:25 2004
Subject: [mod_python] mod_python + MySQLdb => does it work?
In-Reply-To: <15190.50806.775640.191120@cymru.basistech.com>
Message-ID: <XFMail.010719144707.markus.hillebrand@apis.intra>

On 19-Jul-01 Tom Emerson wrote:
> markus.hillebrand@apis-group.net writes:
>> I tried to bring mod_python and MySQLdb together,
>> but I crashed on some problems.
> 
> This works very well.
Fine to hear that, so my tries are making sense ;)

>> First of all: mod_python runs quite fine.
>> Also MySQLdb runs quite well.
>> 
>> But when I try to import MySQLdb from a python-script
>> that was invoked by mod_python I get a
>> 
>> ImportError: _mysql: init failed 
>> (whole error message is in the attachement)
> 
> Check your Python load path within mod_python, and make sure that the
> directory containing the MySQLdb modules is there. Also make sure that
> the MySQLdb shared object can be found in the library search path.

I did this already and I created a script,
that I started with mod_python and I called

oRequest.write( str( imp.find_module("MySQLdb"))) 
  Result:(None,'/opt/<...>/site-packages/MySQLdb' , ('', '',5))

oRequest.write( str( imp.find_module("_mysql")))
  Result:(,'/opt/<...>/sitepackages/_mysql.so', ('.so', 'rb',3))

I think I have another problem. But which one?
Maybe my special configuration does not work,
may you tell me yours, Tom?

-- 
Markus Hillebrand, Dipl.Inf.(FH), Software-Engineer
Apis networks GmbH, Kronstadter Str. 11, 81677 Muenchen, Germany
Tel.: +49 (089) 357147-23 ; eMail: markus.hillebrand@apis-group.net

From tree at basistech.com  Thu Jul 19 08:51:34 2001
From: tree at basistech.com (Tom Emerson)
Date: Fri Jan  9 21:46:25 2004
Subject: [mod_python] mod_python + MySQLdb => does it work?
In-Reply-To: <XFMail.010719144707.markus.hillebrand@apis.intra>
References: <15190.50806.775640.191120@cymru.basistech.com>
	<XFMail.010719144707.markus.hillebrand@apis.intra>
Message-ID: <15190.55254.949564.915370@cymru.basistech.com>

markus.hillebrand@apis-group.net writes:
> I did this already and I created a script,
> that I started with mod_python and I called

I'm currently running the following setup:

FreeBSD 4.2-RELEASE, with recent security updates
Apache 1.3.19
  PHP/4.0.4pl1
  mod_python/2.7.5
  Python/2.0 (with patch for the exception problem)
MySQL 3.23.37
MySQLdb, 2000-11-30 release

Does your server errorlog or machine's messages log give any clues as
to why the failure is happening? Do you have more than one Python
installation on the machine? I had problems with this in the past.

Otherwise I'm stumped.

-- 
Tom Emerson                                          Basis Technology Corp.
Sr. Sinostringologist                              http://www.basistech.com
  "Beware the lollipop of mediocrity: lick it once and you suck forever"

From tree at basistech.com  Thu Jul 19 09:06:47 2001
From: tree at basistech.com (Tom Emerson)
Date: Fri Jan  9 21:46:25 2004
Subject: [mod_python] mod_python mailing list archive issue
Message-ID: <15190.56167.224323.751981@cymru.basistech.com>

The link to download the full raw archive of the mod_python mailing
list doesn't work for me: can anyone else get the whole lot of
messages?

-- 
Tom Emerson                                          Basis Technology Corp.
Sr. Sinostringologist                              http://www.basistech.com
  "Beware the lollipop of mediocrity: lick it once and you suck forever"

From tree at basistech.com  Thu Jul 19 09:16:14 2001
From: tree at basistech.com (Tom Emerson)
Date: Fri Jan  9 21:46:25 2004
Subject: [mod_python] More on import errors in 2.7.5
Message-ID: <15190.56734.977727.647366@cymru.basistech.com>

A couple of days ago I posted a question about strange import
behaviors with 2.7.5,

<http://www.modpython.org/pipermail/mod_python/2001-July/001519.html>

I haven't heard from anyone with a solution, though scanning the
archives it appears that this has been an issue for a while for some
people. So I started digging.

The short: the problem is still there.

The long:

- I reverted to 2.7.2 and the problem is still there. <sigh>

- I added some log_error() calls in various places in both publisher.py
  and apache.py to verify the state of the world upto the point
  apache.py attempts to reload the module. As far as I can tell,
  everything is valid up to the point of the reload call: sys.modules
  includes an entry for the module I'm reloading, the pathnames to the
  module are correct, everything looks fine, but reload() is throwing
  an ImportError.

  I observed that this problem usually happens in the following
  scenario:

  1) The module is loaded successfully.
  2) You make a modification to the module source which causes
     mod_python to reload the module. This works fine.
  3) You make another modification to the module that will cause an
     error when the module is being parsed when it is reloaded.
  4) You fix the error and reload.
  5) Bam, ImportError.

  Could it be the case that the module is partially initialized and
  isn't really reloadable?

Also, FWIW, the server doesn't have write access to the directory
containing these modules, so the .pyc files are not being created.

Food for thought.

    -tree

-- 
Tom Emerson                                          Basis Technology Corp.
Sr. Sinostringologist                              http://www.basistech.com
  "Beware the lollipop of mediocrity: lick it once and you suck forever"

From Alain.Tesio at actfs.fr  Thu Jul 19 16:02:50 2001
From: Alain.Tesio at actfs.fr (Alain.Tesio@actfs.fr)
Date: Fri Jan  9 21:46:25 2004
Subject: [mod_python] mod_python + MySQLdb => does it work
Message-ID: <OFA20499D4.3F551BBF-ONC1256A8E.004C5B52@actfs.fr>

Hi, it works for me on Linux Debian with Python 2.1, MySQLdb and mod_python
installed from source.

If it works when starting python from a shell, it means that the there is
something
missing in the environment of the user running apache.

Maybe try one of these commands to add this before "import MySQLdb" :

sys.path.append("/path/where/is/mysqldb")
os.environ["LD_LIBRARY_PATH"]="/path/to/the/shared/object"

Alain





______________________________________________________________________________


The views and opinions expressed in this email message are the sender's and
do not necessarily represent the views and opinions of ACT Financial
Systems S.A.
______________________________________________________________________________




From markus.hillebrand at apis-group.net  Thu Jul 19 18:50:32 2001
From: markus.hillebrand at apis-group.net (markus.hillebrand@apis-group.net)
Date: Fri Jan  9 21:46:25 2004
Subject: [mod_python] mod_python + MySQLdb => does it work? YES!
In-Reply-To: <XFMail.010719135754.markus.hillebrand@apis.intra>
Message-ID: <XFMail.010719185032.markus.hillebrand@apis.intra>

On 19-Jul-01 markus.hillebrand@apis-group.net wrote:
> 
>  Hello to all you out there!
> 
> I tried to bring mod_python and MySQLdb together,
> but I crashed on some problems.

Okay, after playing around with all these
pathes and settings ... I recompiled 
the python-component v2.1.1c1 --without-threads
And what shall I say. Now it works fine.
I'm quite happy now (until the next problem occurs).

Thanx to all of you.
-- 
Markus Hillebrand, Dipl.Inf.(FH), Software-Engineer
Apis networks GmbH, Kronstadter Str. 11, 81677 Muenchen, Germany
Tel.: +49 (089) 357147-23 ; eMail: markus.hillebrand@apis-group.net

From mikael.johansson at sema.se  Fri Jul 20 09:38:56 2001
From: mikael.johansson at sema.se (Mikael Johansson)
Date: Fri Jan  9 21:46:25 2004
Subject: [mod_python] (no subject)
Message-ID: <003601c110ef$08b93c30$036716ac@got.sema.se>

Any Ideas for my installation problem ?   

HPUX 11.0, Pyhton 1.5., Mod_Pyhton 2.7.5

/MiJo/

================cut=========================



root@gotuh03> ./configure --with-apxs=/opt/apache/bin/apxs

loading cache ./config.cache

checking for gcc... no

checking for cc... cc

checking whether the C compiler (cc ) works... yes

checking whether the C compiler (cc ) is a cross-compiler... no

checking whether we are using GNU C... no

checking whether cc accepts -g... yes

checking for ranlib... ranlib

checking for ar... ar

checking for a BSD compatible install... /opt/imake/bin/install -c

checking whether make sets ${MAKE}... yes

checking for main in -lm... yes

checking for working const... yes

checking your blood pressure... a bit high, but we can proceed

checking whether apxs is available

checking for --with-apxs... /opt/apache/bin/apxs executable, good

checking for Apache libexec directory... /opt/apache/libexec

checking for Apache include directory... -I/opt/apache/include

checking for --with-apache... no

configure: warning: **** No apache sources specified, static compilation will not be available.

configure: warning: **** You can use --with-apache to specify where your Apache sources are.

checking for --with-python... no

checking for python... /usr/local/bin/python

checking Python version... 1.5

checking whether Python is compiled with thread support... no threads, good

checking Python install prefix... /usr/local

checking what libraries Python was linked with... /usr/local/lib/python1.5/config/libpython1.5.a -lnet -lnsl -ldld -lm 

checking linker flags used to link Python... 

checking where Python include files are... -I/usr/local/include/python1.5

checking for mkdep... no

checking for makedepend... /opt/imake/bin/makedepend

updating cache ./config.cache

creating ./config.status

creating Makefile

creating src/Makefile

creating src/libpython.module

creating Doc/Makefile

analyzing dependencies





root@gotuh03> make dso

Compiling for DSO. For static, do "make static"

/opt/apache/bin/apxs -I/opt/install/mod_python-2.7.5/src/include -I/opt/apache/include -I/usr/local/include/python1.5 -c mo 

ld -b -o mod_python.so mod_python.o _apachemodule.o requestobject.o tableobject.o util.o serverobject.o connobject.o -lm /usr/local 

ld: Invalid loader fixup in text space needed in output file for symbol "$000000B1" in input file "/usr/local/lib/python1.5/config/"

apxs:Break: Command failed with rc=65536

*** Error exit code 1

Stop.

*** Error exit code 1

Stop.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010720/6b0783f9/attachment.htm
From polygnwnd at yahoo.com  Tue Jul 24 20:20:06 2001
From: polygnwnd at yahoo.com (polygnwnd)
Date: Fri Jan  9 21:46:25 2004
Subject: [mod_python] example test fails-- how to convince apache to search the correct path for python modules?
Message-ID: <20010725032006.88880.qmail@web12507.mail.yahoo.com>

Well, I am interested in mod_python, but am having a
hard time getting it to work. I notice
that my specific problem has come up on both Windows
and Linux and I cannot find a working
solution in the mail archives (maybe I overlooked
something?). 

What I "know"...

Platform: Linux 2.4 kernel, atop old, but vanilla
Debian

All packages used here are installed below
/home/polygnwnd/httpd:
  Python: python/2.0.1/(bin, lib, etc.)
  Apache: apache/1.3.20/(bin,libexec, etc.)

Configured options:
  Python: --without-threads
  Apache: --enable-module=rewrite
--enable-shared=rewrite
  mod_python:
--with-apxs=/home/polygnwnd/httpd/apache/1.3.20/bin/apxs
\
             
--with-python=/home/polygnwnd/src/httpd/python/2.0.1
              # I pointed with-python to the python
src build dir, makes configure happy

An strace on the httpd process reveals many
unsuccessful attempts to access
the system python library. The result:

  stat("/usr/lib/python2.0/mod_python", 0xbfffeaec) =
-1 ENOENT (No such file or directory)
  open("/usr/lib/python2.0/mod_python.so", O_RDONLY) =
-1 ENOENT (No such file or directory)
  open("/usr/lib/python2.0/mod_pythonmodule.so",
O_RDONLY) = -1 ENOENT (No such file or directory)
  open("/usr/lib/python2.0/mod_python.py", O_RDONLY) =
-1 ENOENT (No such file or directory)
  open("/usr/lib/python2.0/mod_python.pyc", O_RDONLY)
= -1 ENOENT (No such file or directory)
  stat("/usr/lib/python2.0/plat-linux2/mod_python",
0xbfffeaec) = -1 ENOENT (No such file or directory)
  open("/usr/lib/python2.0/plat-linux2/mod_python.so",
O_RDONLY) = -1 ENOENT (No such file or directory)
 
open("/usr/lib/python2.0/plat-linux2/mod_pythonmodule.so",
O_RDONLY) = -1 ENOENT (No such file or directory)
  open("/usr/lib/python2.0/plat-linux2/mod_python.py",
O_RDONLY) = -1 ENOENT (No such file or directory)
 
open("/usr/lib/python2.0/plat-linux2/mod_python.pyc",
O_RDONLY) = -1 ENOENT (No such file or directory)
  stat("/usr/lib/python2.0/lib-tk/mod_python",
0xbfffeaec) = -1 ENOENT (No such file or directory)
  stat("/usr/lib/python2.0/site-packages/mod_python",
0xbfffeaec) = -1 ENOENT (No such file or directory)
 
open("/usr/lib/python2.0/site-packages/mod_python.so",
O_RDONLY) = -1 ENOENT (No such file or directory)
 
open("/usr/lib/python2.0/site-packages/mod_pythonmodule.so",
O_RDONLY) = -1 ENOENT (No such file or directory)
 
open("/usr/lib/python2.0/site-packages/mod_python.py",
O_RDONLY) = -1 ENOENT (No such file or directory)
 
open("/usr/lib/python2.0/site-packages/mod_python.pyc",
O_RDONLY) = -1 ENOENT (Nosuch file or directory)
  write(2, "make_obcallback(): could not imp"..., 55)
= 55
  write(2, "make_obcallback(): could not cal"..., 40)
= 40
  time(NULL)                              = 996027790
  write(15, "[Wed Jul 25 03:23:10 2001] [erro"...,
115) = 115
  alarm(300)                              = 0
  alarm(0)                                = 300
  alarm(300)                              = 0
  alarm(0)                                = 300
  alarm(300)                              = 0
  alarm(0)                                = 300
  write(4, "HTTP/1.1 500 Internal Server Err"..., 843)
= 843

This is odd because my system python version is 1.5
and I have a special version in a private 
directory which I specified (as above) at compile
time.

grepping apache (incl. mod_python.so) and python
binaries for "/usr/lib" did not reveal anything of
immediate
interest. Recompiling with python 2.1 renders
essentially the same result (substitude "2.1" for
"2.0" in the
trace output).

The problem is obviously something like the PYTHONPATH
not being set properly. 

  -Setting the PythonPath (as was suggested in a prior
exchange) seems ineffective-- strace behaviour was not

   changed (in fact specifying an arbitrary string set
for the PythonPath directive did not appear in trace
output).
  
  -setting the PYTHONPATH variable in the shell before
starting httpd had no effect

  -using the specially compiled python shell to try
"from mod_python import apache" failed when it could
   not find the "_apache" module, leading me to
believe it did find the mod_python module. I did this
   experiment using the same permissions as httpd, and
have tried experimentally running httpd with my own 
   permissions without success.

The mod_python.so file is 2.7MB with python 2.0 and
1.5MB with 2.1, leading me to believe it is being
linked
properly-- I have scrutinized the build process for
errors and not seen anything interesting. Thus I find
myself
among the ranks of unhappy people looking at:

  [Wed Jul 25 04:03:20 2001] [info] Server built: Jul
25 2001 00:55:54
  make_obcallback(): could not import
mod_python.apache.
  make_obcallback(): could not call init.
  [Wed Jul 25 04:03:22 2001] [error] [client
192.168.0.0.2] python_handler: make_ob
  callback returned no obCallBack!

I look forward to being able to move out of
AOLserver-land (filters and threading are coming to
Apache. yay). 
Any clues?

cheers,
jamie



__________________________________________________
Do You Yahoo!?
Make international calls for as low as $.04/minute with Yahoo! Messenger
http://phonecard.yahoo.com/

From piet at cs.uu.nl  Wed Jul 25 11:09:47 2001
From: piet at cs.uu.nl (piet@cs.uu.nl)
Date: Fri Jan  9 21:46:25 2004
Subject: [mod_python] example test fails-- how to convince apache to search the correct path for python modules?
In-Reply-To: polygnwnd's message of "Tue, 24 Jul 2001 20:20:06 -0700 (PDT)"
References: <20010725032006.88880.qmail@web12507.mail.yahoo.com>
Message-ID: <uy9pd2x44.fsf@cs.uu.nl>

Can you start up an interactive session with your private python
interpreter and type the following:

import sys
print sys.path

I guess it will have /usr/lib/python2.0 in it.
If that is so, the this is where your python expects its modules.
-- 
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl


From riesch at nieuw.nl  Thu Jul 26 16:26:59 2001
From: riesch at nieuw.nl (riesch@nieuw.nl)
Date: Fri Jan  9 21:46:25 2004
Subject: [mod_python] Cookies
Message-ID: <20010726162659.A8236@godel>

Hi there,

I'm currently making a web-site with mod-python and since I want to make use of cookies, I was wondering how I can set a cookie.
I've been looking through the documentation provided on the web-site, but I'm not able to find something. So if anyone could give me pointer, or even better comething that works, I'd be much obliged.


Thanks ahead,
Richard

From bl at netgroup.dk  Thu Jul 26 16:54:26 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:46:25 2004
Subject: [mod_python] Cookies
References: <20010726162659.A8236@godel>
Message-ID: <3B602F22.17C6C7B8@netgroup.dk>

riesch@nieuw.nl wrote:

> I'm currently making a web-site with mod-python and since I want to make use of cookies, I was wondering how I can set a cookie.
> I've been looking through the documentation provided on the web-site, but I'm not able to find something. So if anyone could give me pointer, or even better comething that works, I'd be much obliged.

You find them in the header fields (headers_in / headers_out ) in the Request class.

If you like to set a cookie you do something like this :

    req.headers_out[ "Set-Cookie" ] = "my_session_id=42"

and the next time this user sends back a request back to you ( and if he support it) it will contain it in your input headers, and you will be able to fetch it like this :

    raw_cookie = req.headers_in[ "Cookie" ]

Now you only need to parse the input cookie string (raw_cookie), that have the syntax as descried in RFC-2109.

mod_python does not have any helper classes for either in- or outgoing cookies, but the format is strait forward, even I could make one :-)

Hope this helped

Regards

/BL


From CHagner at fool.com  Thu Jul 26 11:11:54 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:46:25 2004
Subject: [mod_python] Cookies
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E48053@rover.foolhq.com>

There's a module called Cookie which provides an Dictionary-like interface
to access the multiple cookies in a request.  In addition, each cookie class
has an output method that returns an HTTP-header-friendly string
("Set-Cookie: fig=newton").  The doc strings in Cookie.py give some pretty
good code examples.

In this module, a 'raw' cookie is called a morsel, so the terminology could
be a little confusing.

One warning though.  The Cookie module is only designed to handle a single
value for each cookie (i.e. "Set-Cookie: MyCookie=MyValue") .  Thus, if you
use a cookie to store more than one value (i.e. "Set-Cookie:
MyCookie=key1=value=&key2=value2&key3=value3"), you'll need to wrap Cookie
with your own class to handle the 'internal' values (or just build/parse the
value string yourself each time).

Chris

-----Original Message-----
From: Bo Lorentsen [mailto:bl@netgroup.dk]
Sent: Thursday, July 26, 2001 10:54 AM
To: riesch@nieuw.nl
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Cookies


riesch@nieuw.nl wrote:

> I'm currently making a web-site with mod-python and since I want to make
use of cookies, I was wondering how I can set a cookie.
> I've been looking through the documentation provided on the web-site, but
I'm not able to find something. So if anyone could give me pointer, or even
better comething that works, I'd be much obliged.

You find them in the header fields (headers_in / headers_out ) in the
Request class.

If you like to set a cookie you do something like this :

    req.headers_out[ "Set-Cookie" ] = "my_session_id=42"

and the next time this user sends back a request back to you ( and if he
support it) it will contain it in your input headers, and you will be able
to fetch it like this :

    raw_cookie = req.headers_in[ "Cookie" ]

Now you only need to parse the input cookie string (raw_cookie), that have
the syntax as descried in RFC-2109.

mod_python does not have any helper classes for either in- or outgoing
cookies, but the format is strait forward, even I could make one :-)

Hope this helped

Regards

/BL

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python

From garyp at asti-usa.com  Thu Jul 26 12:32:01 2001
From: garyp at asti-usa.com (Gary Perez)
Date: Fri Jan  9 21:46:26 2004
Subject: [mod_python] Try 2: python_handler: Dispatch() returned nothing
Message-ID: <3B604602.C7BC25E0@asti-usa.com>

Hi, all.

I've reinstalled apache, reinstalled Python (no threads), reinstalled
mod_python in hopes to clear this up. No dice. Does anyone have any suggestions?

Here's the dirt:
SuSE Linux 7.2, kernel 2.4.4, reiserfs
Apache 1.3.19 + Python 2.0 + mod_python 2.7.2

HTTPD.CONF
<Directory "/usr/local/httpd/htdocs/test">
    AddHandler python-program .py
    PythonHandler mptest
    PythonDebug On
</Directory>

The mptest.py module in "test" is the standard one from the
documentation (verified, no typos).

When I hit the URL (localhost/test/mptest.py) I get an internal server error:

ERROR LOG
[Wed Jul 18 15:58:02 2001] [notice] Apache/1.3.19 (Unix)  (SuSE/Linux)
mod_layout/1.0 mod_throttle/3.0 mod_fastcgi/2.2.2 mod_ssl/2.8.3
OpenSSL/0.9.6a PHP/4.0.4pl1 mod_perl/1.25 mod_dtcl mod_python/2.7.2
Python/2.0 configured -- resuming normal operations
[Wed Jul 18 15:58:02 2001] [notice] suEXEC mechanism enabled (wrapper: /usr/sbin/suexec)
[Wed Jul 18 15:58:18 2001] [error] [client 192.168.100.100]
python_handler: Dispatch() returned nothing.

Thanks in advance for your help.
-Gary

From jpareja at ntsp.nec.co.jp  Fri Jul 27 19:48:57 2001
From: jpareja at ntsp.nec.co.jp (Joel)
Date: Fri Jan  9 21:46:26 2004
Subject: [mod_python] Apache 2.x support
References: <200107261602.f6QG24G65883@eden.ispol.com>
Message-ID: <3B615529.2060207@ntsp.nec.co.jp>

Hello all,

       I am just starting to install mod_python. But the manual says 2.0 
not yet supported.
Is there a target date for a release that supports Apache 2.x.


Thank you.


From bl at netgroup.dk  Fri Jul 27 11:04:14 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:46:26 2004
Subject: [mod_python] Cookies
References: <13CDDE6A53DBD311BC3200508B6F0C4805E48053@rover.foolhq.com>
Message-ID: <3B612E8E.2BB63B3F@netgroup.dk>

Chris Hagner wrote:

> There's a module called Cookie which provides an Dictionary-like interface
> to access the multiple cookies in a request.  In addition, each cookie class
> has an output method that returns an HTTP-header-friendly string
> ("Set-Cookie: fig=newton").  The doc strings in Cookie.py give some pretty
> good code examples.

Ups sorry, I have only looked into the manual, maby its time to take a trip
into the mod_python code :-)

/BL


From CHagner at fool.com  Fri Jul 27 07:40:36 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:46:26 2004
Subject: [mod_python] Cookies
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E48060@rover.foolhq.com>

Cookie is a module within Python (not mod_python).  Is that what you mean?

http://www.python.org/doc/2.1.1/lib/module-Cookie.html

Chris

-----Original Message-----
From: Bo Lorentsen [mailto:bl@netgroup.dk]
Sent: Friday, July 27, 2001 5:04 AM
To: Chris Hagner
Cc: riesch@nieuw.nl; mod_python@modpython.org
Subject: Re: [mod_python] Cookies


Chris Hagner wrote:

> There's a module called Cookie which provides an Dictionary-like interface
> to access the multiple cookies in a request.  In addition, each cookie
class
> has an output method that returns an HTTP-header-friendly string
> ("Set-Cookie: fig=newton").  The doc strings in Cookie.py give some pretty
> good code examples.

Ups sorry, I have only looked into the manual, maby its time to take a trip
into the mod_python code :-)

/BL

From bl at netgroup.dk  Fri Jul 27 13:59:51 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:46:26 2004
Subject: [mod_python] usign the apache log ?
Message-ID: <3B6157B7.F05239DB@netgroup.dk>

Hi ...

I have been writing a system using this mod_python module, and it just
work out fine for me. Its really a nice Python tool, keep up the good
work. But (there is always a but :-)) I really like to be able to se
more about what is going in inside my code, and I therefor looked for a
way to write to the apache log file, but found nothing in mod_python.

In the O'reilly book "Writing Apache modules with Perl and C" they have
an example where they got a logger out of the Request class (or whatever
they call it i Perl :-)). This don't seem to be the case in mod_python,
and the only reference I could find to logging is the PythonLogHandler,
and that don't sound like anything I could use.

Is there something i have misunderstood, or is there a way do redirect
stdout/err to the log or something fancy like that ?

Thanks in advance !

/BL


From bl at netgroup.dk  Fri Jul 27 14:08:01 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:46:26 2004
Subject: [mod_python] Cookies
References: <13CDDE6A53DBD311BC3200508B6F0C4805E48060@rover.foolhq.com>
Message-ID: <3B6159A1.40AB4F73@netgroup.dk>

Chris Hagner wrote:

> Cookie is a module within Python (not mod_python).  Is that what you mean?

Ahh, I hav'nt seen it in the python lib. as I'm using a quite old Python
(1.5.2), to prevent to much update fun in the production env. ( we use
Debian/potato on the servers :-))

So much for code reuse :-)

Thanks anyway, yet a stone on the road to be a Python expert :-)

/BL


From CHagner at fool.com  Fri Jul 27 08:20:07 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:46:26 2004
Subject: [mod_python] Cookies
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E48061@rover.foolhq.com>

Fortunately, the Cookie module was actually developed completely independent
of the main Python distribution.  Thus, you should be able to find a copy of
Cookie.py and simply use that with Python 1.5.2.  This is what WebWare does
(or used to... not sure if they nixed their Cookie.py when it became a
standard Python module).  It's a pretty straight-forward module, so I
wouldn't be shocked if Cookie.py from a 2.0 distro works in 1.5.2.

Chris

-----Original Message-----
From: Bo Lorentsen [mailto:bl@netgroup.dk]
Sent: Friday, July 27, 2001 8:08 AM
To: Chris Hagner
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Cookies


Chris Hagner wrote:

> Cookie is a module within Python (not mod_python).  Is that what you mean?

Ahh, I hav'nt seen it in the python lib. as I'm using a quite old Python
(1.5.2), to prevent to much update fun in the production env. ( we use
Debian/potato on the servers :-))

So much for code reuse :-)

Thanks anyway, yet a stone on the road to be a Python expert :-)

/BL

From bl at netgroup.dk  Fri Jul 27 14:34:39 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:46:26 2004
Subject: [mod_python] Cookies
References: <13CDDE6A53DBD311BC3200508B6F0C4805E48061@rover.foolhq.com>
Message-ID: <3B615FDF.D0BED081@netgroup.dk>

Chris Hagner wrote:

> Fortunately, the Cookie module was actually developed completely independent
> of the main Python distribution.  Thus, you should be able to find a copy of
> Cookie.py and simply use that with Python 1.5.2.  This is what WebWare does
> (or used to... not sure if they nixed their Cookie.py when it became a
> standard Python module).  It's a pretty straight-forward module, so I
> wouldn't be shocked if Cookie.py from a 2.0 distro works in 1.5.2.

Look what I found ! Hope others may have good use of this too.

    http://starship.python.net/crew/jrush/Webbot

Thanks for the advise, I think I just will include this in my code, and be more
careful to search python.org before writing another parser :-)

/BL


From CHagner at fool.com  Fri Jul 27 08:45:16 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:46:26 2004
Subject: [mod_python] Cookies
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E48063@rover.foolhq.com>

Bo,

I would recommend that you instead go with the actual Cookie.py file that
has made it into the main Python distribution.  I started using it before it
was included (since it was a part of WebWare's libs) and was pleasantly
surprised when I found a Cookie.py in the 2.0 distro.  I was even more
surprised when I saw that the file was identical to the one that I had been
using. :)  Good karma I guess.

Chris

-----Original Message-----
From: Bo Lorentsen [mailto:bl@netgroup.dk]
Sent: Friday, July 27, 2001 8:35 AM
To: Chris Hagner
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Cookies


Chris Hagner wrote:

> Fortunately, the Cookie module was actually developed completely
independent
> of the main Python distribution.  Thus, you should be able to find a copy
of
> Cookie.py and simply use that with Python 1.5.2.  This is what WebWare
does
> (or used to... not sure if they nixed their Cookie.py when it became a
> standard Python module).  It's a pretty straight-forward module, so I
> wouldn't be shocked if Cookie.py from a 2.0 distro works in 1.5.2.

Look what I found ! Hope others may have good use of this too.

    http://starship.python.net/crew/jrush/Webbot

Thanks for the advise, I think I just will include this in my code, and be
more
careful to search python.org before writing another parser :-)

/BL

From miguel at yorku.ca  Fri Jul 27 08:54:41 2001
From: miguel at yorku.ca (Miguel Marques)
Date: Fri Jan  9 21:46:26 2004
Subject: [mod_python] usign the apache log ?
In-Reply-To: <3B6157B7.F05239DB@netgroup.dk>
References: <3B6157B7.F05239DB@netgroup.dk>
Message-ID: <20010727085441P.miguel@yorku.ca>

Greetings...
On Fri, 27 Jul 2001 13:59:51 +0200, Bo Lorentsen <bl@netgroup.dk> wrote:
> Hi ...
> 
> I have been writing a system using this mod_python module, and it just
> work out fine for me. Its really a nice Python tool, keep up the good
> work. But (there is always a but :-)) I really like to be able to se
> more about what is going in inside my code, and I therefor looked for a
> way to write to the apache log file, but found nothing in mod_python.
> 
> In the O'reilly book "Writing Apache modules with Perl and C" they have
> an example where they got a logger out of the Request class (or whatever
> they call it i Perl :-)). This don't seem to be the case in mod_python,
> and the only reference I could find to logging is the PythonLogHandler,
> and that don't sound like anything I could use.
> 
> Is there something i have misunderstood, or is there a way do redirect
> stdout/err to the log or something fancy like that ?
> 
> Thanks in advance !

4.3 apache - Access to Apache Internals.
http://www.modpython.org/live/mod_python-2.7.5/doc-html/module-apache.html

Specifically: log_error(message[, level, server])

							Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830

From bl at netgroup.dk  Fri Jul 27 15:02:14 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:46:26 2004
Subject: [mod_python] usign the apache log ?
References: <3B6157B7.F05239DB@netgroup.dk> <20010727085441P.miguel@yorku.ca>
Message-ID: <3B616656.A572E8F3@netgroup.dk>

Miguel Marques wrote:

> 4.3 apache - Access to Apache Internals.
> http://www.modpython.org/live/mod_python-2.7.5/doc-html/module-apache.html
>
> Specifically: log_error(message[, level, server])

Thanks, I guess I just was looking in the wrong direction.

/BL


From riesch at nieuw.nl  Fri Jul 27 15:15:58 2001
From: riesch at nieuw.nl (riesch@nieuw.nl)
Date: Fri Jan  9 21:46:26 2004
Subject: [mod_python] usign the apache log ?
In-Reply-To: <3B6157B7.F05239DB@netgroup.dk>; from bl@netgroup.dk on Fri, Jul 27, 2001 at 01:59:51PM +0200
References: <3B6157B7.F05239DB@netgroup.dk>
Message-ID: <20010727151558.B20191@godel>

hi there,


what you can do is write your own log-class. I've done something like this:


class Log:
   def __init__(self, file, mode):
      if __debug__:
         delf.__descriptor = open(file, mode)
   
   def __del__(self):
      self.close()

   def append(self, string):
      self.__descriptor.write(string + "\n\n")
      # add some more information if you please

   def close(self):
      self.__descriptor.close()


   # Variables
   __descriptor = []
#

global log
log = Log("log.txt")


When you import this module, the log-instance will be known and be the same for every file that imports this module (the global takes care of this) and every write (wherever) happens in the same file.
To write stuff:

import from Log *

log.append("something happened")


I hope this helps,
Richard

      


On Fri, Jul 27, 2001 at 01:59:51PM +0200, Bo Lorentsen wrote:
> Hi ...
> 
> I have been writing a system using this mod_python module, and it just
> work out fine for me. Its really a nice Python tool, keep up the good
> work. But (there is always a but :-)) I really like to be able to se
> more about what is going in inside my code, and I therefor looked for a
> way to write to the apache log file, but found nothing in mod_python.
> 
> In the O'reilly book "Writing Apache modules with Perl and C" they have
> an example where they got a logger out of the Request class (or whatever
> they call it i Perl :-)). This don't seem to be the case in mod_python,
> and the only reference I could find to logging is the PythonLogHandler,
> and that don't sound like anything I could use.
> 
> Is there something i have misunderstood, or is there a way do redirect
> stdout/err to the log or something fancy like that ?
> 
> Thanks in advance !
> 
> /BL
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

From rsalz at zolera.com  Fri Jul 27 09:53:12 2001
From: rsalz at zolera.com (Rich Salz)
Date: Fri Jan  9 21:46:26 2004
Subject: [mod_python] usign the apache log ?
References: <3B6157B7.F05239DB@netgroup.dk> <20010727151558.B20191@godel>
Message-ID: <3B617248.1F8AC4BF@zolera.com>

In mod_python sys.stderr is attached to the apache error log.
There is also a log_error method in the apache module (not sure what
version added it); see the docs -- it's like the ap_log_error()
function.

-- 
Zolera Systems, Your Key to Online Integrity
Securing Web services: XML, SOAP, Dig-sig, Encryption
http://www.zolera.com

From riesch at nieuw.nl  Mon Jul 30 13:55:00 2001
From: riesch at nieuw.nl (riesch@nieuw.nl)
Date: Fri Jan  9 21:46:26 2004
Subject: [mod_python] standard path
Message-ID: <20010730135500.A8125@godel>

Hi there,


I'm wondering. I now have setup for my apacha-server (httpd.conf) similar to the following:

<directory />
   SetHandler python-program
   PythonHandler main
   PythonDebug On
</directory>


The file with the mod-python handler (aka the entrance) now has to be placed in a standard path, which can be located by the python-interpreter. Now it isn't very attractive for me to use these paths. Is there a way around this. I've been trying something like:

PythonPath /home/user/site/

but this generated errors.

Any hints ?


Richard.

From riesch at nieuw.nl  Mon Jul 30 14:33:30 2001
From: riesch at nieuw.nl (riesch@nieuw.nl)
Date: Fri Jan  9 21:46:26 2004
Subject: [mod_python] standard path
In-Reply-To: <20010730135500.A8125@godel>; from riesch@nieuw.nl on Mon, Jul 30, 2001 at 01:55:00PM +0200
References: <20010730135500.A8125@godel>
Message-ID: <20010730143330.B8125@godel>

Sorry all,


I've already found the error of my ways :)
It should have been:


PythonPath "sys.path + ['/home/mysite/']"

I found it in the mod-python manual


Thanx again,
Richard

From bl at netgroup.dk  Tue Jul 31 10:19:06 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:46:26 2004
Subject: [mod_python] Internal_redirect ?
Message-ID: <3B6669FA.A18D4564@netgroup.dk>

Hi ...

I have been working on a larger site setup where I like to force a
redirection to a internal login page if user is unknown (cookie thing).

The only way of redirection I can find is the one described in the
mod_python FAQ, but this often gives a small annoying page telling the
user about a redirection, but what I want is to do it seamless to the
browser.

Now in the Apache doc, I found some info. about a function calls
"internal_redirect", that does exactly what I like to do, but its not
part of the mod_python API, or I cant find it, at least :-)

Have anyone a good hint for me at this point ?

Also, is it correct that its not possible to set a cookie together with
a redirect ?

Hopeful regards

/BL


From CHagner at fool.com  Tue Jul 31 09:13:26 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:46:26 2004
Subject: [mod_python] Internal_redirect ?
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E48089@rover.foolhq.com>

If I remember correctly, Grisha stated that this feature has been highly
requested (and is do-able) but has not yet been implemented.

Chris

-----Original Message-----
From: Bo Lorentsen [mailto:bl@netgroup.dk]
Sent: Tuesday, July 31, 2001 4:19 AM
To: mod_python list
Subject: [mod_python] Internal_redirect ?


Hi ...

I have been working on a larger site setup where I like to force a
redirection to a internal login page if user is unknown (cookie thing).

The only way of redirection I can find is the one described in the
mod_python FAQ, but this often gives a small annoying page telling the
user about a redirection, but what I want is to do it seamless to the
browser.

Now in the Apache doc, I found some info. about a function calls
"internal_redirect", that does exactly what I like to do, but its not
part of the mod_python API, or I cant find it, at least :-)

Have anyone a good hint for me at this point ?

Also, is it correct that its not possible to set a cookie together with
a redirect ?

Hopeful regards

/BL

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python

From miguel at yorku.ca  Tue Jul 31 09:39:07 2001
From: miguel at yorku.ca (Miguel Marques)
Date: Fri Jan  9 21:46:26 2004
Subject: [mod_python] Internal_redirect ?
In-Reply-To: <13CDDE6A53DBD311BC3200508B6F0C4805E48089@rover.foolhq.com>
References: <13CDDE6A53DBD311BC3200508B6F0C4805E48089@rover.foolhq.com>
Message-ID: <20010731093907E.miguel@yorku.ca>

Greetings...
On Tue, 31 Jul 2001 09:13:26 -0400, Chris Hagner <CHagner@fool.com> wrote:
> If I remember correctly, Grisha stated that this feature has been highly
> requested (and is do-able) but has not yet been implemented.
> 
> Chris
> 
> -----Original Message-----
> From: Bo Lorentsen [mailto:bl@netgroup.dk]
> Sent: Tuesday, July 31, 2001 4:19 AM
> To: mod_python list
> Subject: [mod_python] Internal_redirect ?
> 
> 
> Hi ...
> 
> I have been working on a larger site setup where I like to force a
> redirection to a internal login page if user is unknown (cookie thing).
> 
> The only way of redirection I can find is the one described in the
> mod_python FAQ, but this often gives a small annoying page telling the
> user about a redirection, but what I want is to do it seamless to the
> browser.
> 
> Now in the Apache doc, I found some info. about a function calls
> "internal_redirect", that does exactly what I like to do, but its not
> part of the mod_python API, or I cant find it, at least :-)
> 
> Have anyone a good hint for me at this point ?

With apache I do exactly what you are trying to accomplish by setting
a cookie in req.err_headers_out and returning apache.HTTP_FORBIDDEN.
Then in the apache configuration file you use 
ErrorDocument 403 http://yourloginpage 
in the directory/ies you are trying to protect...
Hope that helps...

						Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830

From bl at netgroup.dk  Tue Jul 31 15:54:47 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:46:26 2004
Subject: [mod_python] Internal_redirect ?
References: <13CDDE6A53DBD311BC3200508B6F0C4805E48089@rover.foolhq.com>
Message-ID: <3B66B8A7.FE84A88F@netgroup.dk>

Chris Hagner wrote:

> If I remember correctly, Grisha stated that this feature has been highly
> requested (and is do-able) but has not yet been implemented.

I will then sign up on this request :-)

/BL


From bl at netgroup.dk  Tue Jul 31 15:59:14 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:46:26 2004
Subject: [mod_python] Internal_redirect ?
References: <13CDDE6A53DBD311BC3200508B6F0C4805E48089@rover.foolhq.com> <20010731093907E.miguel@yorku.ca>
Message-ID: <3B66B9B2.8E549FA@netgroup.dk>

Miguel Marques wrote:

> With apache I do exactly what you are trying to accomplish by setting
> a cookie in req.err_headers_out and returning apache.HTTP_FORBIDDEN.
> Then in the apache configuration file you use
> ErrorDocument 403 http://yourloginpage
> in the directory/ies you are trying to protect...

Thats sweet, and the cookie will be set because its part of the
"err_headers_out" ?

> Hope that helps...

Thats a good hint and another interesting way of solving this problem.

Thanks, but I like to do it the propper way --- I think :-)

/BL


From miguel at yorku.ca  Tue Jul 31 10:02:10 2001
From: miguel at yorku.ca (Miguel Marques)
Date: Fri Jan  9 21:46:26 2004
Subject: [mod_python] Internal_redirect ?
In-Reply-To: <3B66B9B2.8E549FA@netgroup.dk>
References: <13CDDE6A53DBD311BC3200508B6F0C4805E48089@rover.foolhq.com>
	<20010731093907E.miguel@yorku.ca>
	<3B66B9B2.8E549FA@netgroup.dk>
Message-ID: <20010731100210L.miguel@yorku.ca>

Greetings...
On Tue, 31 Jul 2001 15:59:14 +0200, Bo Lorentsen <bl@netgroup.dk> wrote:
> Miguel Marques wrote:
> 
> > With apache I do exactly what you are trying to accomplish by setting
> > a cookie in req.err_headers_out and returning apache.HTTP_FORBIDDEN.
> > Then in the apache configuration file you use
> > ErrorDocument 403 http://yourloginpage
> > in the directory/ies you are trying to protect...
> 
> Thats sweet, and the cookie will be set because its part of the
> "err_headers_out" ?
Yes.

> 
> > Hope that helps...
> 
> Thats a good hint and another interesting way of solving this problem.
> 
> Thanks, but I like to do it the propper way --- I think :-)
I couldn't wait... 8-)

						Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830

From tree at basistech.com  Tue Jul 31 15:31:26 2001
From: tree at basistech.com (Tom Emerson)
Date: Fri Jan  9 21:46:26 2004
Subject: [mod_python] Patch to 2.7.5 for internal_redirect
In-Reply-To: <3B66B9B2.8E549FA@netgroup.dk>
References: <13CDDE6A53DBD311BC3200508B6F0C4805E48089@rover.foolhq.com>
	<20010731093907E.miguel@yorku.ca>
	<3B66B9B2.8E549FA@netgroup.dk>
Message-ID: <15207.1934.890865.157761@cymru.basistech.com>

Attached is a small patch to mod_python 2.7.5 which provides support
for doing an internal_redirect. I've only done minimal testing on this
but it appears to work.

I added a new method to the request object, internal_redirect. It
takes a single string argument which is the local URI to redirect
to. After calling this method your handler should just return
apache.OK.

  from mod_python import apache
 
  def handler(req):
      req.internal_redirect("/redirected.html")
      return apache.OK

I also added an exception class, InternalRedirect, to
mod_python.apache. It takes a single argument which is the local URI
to redirect to. This is used by a modification to Publisher which
allows you to perform an internal redirect simply by raising an
InternalRedirect exception:

  from mod_python import apache
 
  def test(req):
      raise apache.InternalRedirect("/redirected.html")

The request object's "main" member is None if the current request is
the "main" request.

Share and enjoy.

-------------- next part --------------
*** ./lib/python/mod_python/publisher.py.orig	Mon May 14 18:17:21 2001
--- ./lib/python/mod_python/publisher.py	Tue Jul 31 15:46:33 2001
***************
*** 168,174 ****
              if name not in expected:
                  del args[name]
  
!         result = apply(object, (), args)
  
      if result:
          result = str(result)
--- 168,178 ----
              if name not in expected:
                  del args[name]
  
!         try:
!             result = apply(object, (), args)
!         except apache.InternalRedirect, e:
!             req.internal_redirect(e.uri)
!             return apache.OK
  
      if result:
          result = str(result)
*** ./lib/python/mod_python/apache.py.orig	Tue Jul 31 16:00:17 2001
--- ./lib/python/mod_python/apache.py	Tue Jul 31 15:44:16 2001
***************
*** 53,58 ****
--- 53,63 ----
  import imp
  import types
  import _apache
+ import exceptions
+ 
+ class InternalRedirect (exceptions.Exception):
+     def __init__(self, uri):
+         self.uri = uri
  
  # a small hack to improve PythonPath performance. This
  # variable stores the last PythonPath in raw (unevaled) form.
*** ./src/requestobject.c.orig	Tue May 22 22:49:43 2001
--- ./src/requestobject.c	Tue Jul 31 15:08:21 2001
***************
*** 438,443 ****
--- 438,462 ----
  }
  
  /**
+  ** request.internal_redirect(request self, string uri)
+  **
+  *    An interface to the ap_internal_redirect function.
+  *    Tom Emerson, <tree@basistech.com>, 2001-07-31
+  */
+ static PyObject * req_internal_redirect(requestobject *self, PyObject *args)
+ {
+     char *uri;
+ 
+     if (! PyArg_ParseTuple(args, "s", &uri))
+         return NULL;
+ 
+     ap_internal_redirect(uri, self->request_rec);
+     
+     Py_INCREF(Py_None);
+     return Py_None;
+ }
+ 
+ /**
   ** request.get_options(request self)
   **
   */
***************
*** 792,797 ****
--- 811,817 ----
      {"get_dirs",             (PyCFunction) req_get_dirs,             METH_VARARGS},
      {"get_remote_host",      (PyCFunction) req_get_remote_host,      METH_VARARGS},
      {"get_options",          (PyCFunction) req_get_options,          METH_VARARGS},
+     {"internal_redirect",    (PyCFunction) req_internal_redirect,    METH_VARARGS},
      {"read",                 (PyCFunction) req_read,                 METH_VARARGS},
      {"readline",             (PyCFunction) req_readline,             METH_VARARGS},
      {"register_cleanup",     (PyCFunction) req_register_cleanup,     METH_VARARGS},
-------------- next part --------------

-- 
Tom Emerson                                          Basis Technology Corp.
Sr. Sinostringologist                              http://www.basistech.com
  "Beware the lollipop of mediocrity: lick it once and you suck forever"
From rekla_ma_ at publicist.com  Sun Jul  1 19:43:52 2001
From: rekla_ma_ at publicist.com (E-mail Reklama)
Date: Fri Jan  9 21:52:28 2004
Subject: [mod_python] =?windows-1251?Q?E-mail_-_=F0=E5=EA=EB=E0=EC=E0?=
Message-ID: <181362001701154352292@publicist.com>

????????????!

? ?????? ??????? ??????? ?? ????? ?? ?????? ??????????? ??????? ???? ???????, ? ??????? ?? ????? ???????????. ??? ????? ???????? ??????????? ???????? ????? ????????? ?????????? ?? ????????? ??????? ??????? (?? 30???. ?? 1???., ??? ?? ??????, ??? ? ?? ???? ?????? ? ???). ??????????? ?????????/?????? ??? ???? ????? ????? ??????.

?? ??????????????? ?????????? ???????????? ?????????? 4 ????. ???? ?????????? ??????? - ?????????? ????????? ????????, ??????? ????? ??????, ??? ????????????? e-mail ???????? ??-?? ?????? ?????? ????????? ?????????? ???? ? ???????? ?? ??????????? ???????????! ???????, ?????????? ???????? ???? ???, ?????????? ? ??? ????? ? ?????. ?????? ?????? ??????? ?????? e-mail ???????, ?? ??????????? ????? ?? ?? ??????????? (???, ??????, ? ???? ????????) ?? ????? ? ?????????? ????????? ??? ???????????????, ??? ??? ?? ????? ????? ? ??????????? ????????? ??? ????????????? ???????????????? ????????. ? ?????? ??????, ??? ???????? ????????? ?????? ????????? ?????????? ?????, ??? ???? ????? ???? ????? ? ?????????? ???????? ?? ?????? ????????????.

?? ????? ??? ??? e-mail ??????? ? ????? ??? ??? ????, ????? ???????? ??? ???????? ?? ???? ?????? ??? ?????????. ??? ??????? ???? ??????????????????? ??????????? ? ???????????????? ?????? ??????? ? ???????? ? ?????????? ??????, ??????????? ???????? smtp-??????? ?? ???????, ? ????? ??????????? ???????????? ????????? ? ???-??? ?  ???? ???????.

?? ????? ?????? ???????? ???, ??? ??? ????? ?? ???????? ?????? ??????.

???? ?? ??????????????? ? ????????? ? ?????? ???????? ?? ??? ????? ?????? ??????????, ???????? ?????? ? ???????????? ????? ? ???? ??????, ????? ? ????? ???????? ????????? "????????", ??? ?? ??????: reklama@publicist.com.

??? ???? ? ???? "???? ?????????" ??????????? ???????: "????????".




From woodm at equire.com  Tue Jul  3 00:14:32 2001
From: woodm at equire.com (Matthew Wood)
Date: Fri Jan  9 21:52:28 2004
Subject: [mod_python] Session data (Sorry for bringing this up again...)
Message-ID: <16299780187.20010703001432@equire.com>

Hello  all.   I  would  like  to  apologize  for bringing up the whole
session thing again.  However, I have a somewhat specific question.

I guess my question has more to do with persistent data in general.

One of the main reasons that one would keep persistent data is to keep
database connections open.  (Or any connection for that matter)
The other is to keep session data on the users of your site.

Obviously,   the session data can be kept in the database, and the key
to  the  table can be kept in a cookie or passed via the url.  (That's
one way to do it, there are many ways, including a text-file-pickeling
based scheme, but I think that a database would work quite well.)

However,  the  problem  is that you can't keep database connections in
the  database.   All  the other persistent data can be kept there, but
not the database connection.

The  problem  with  persistent  data in general is the multiple memory
spaces  used  by  apache.   But  it  would be a shame to re-create the
database  connection every single time someone logs into a page.  That
just seems ridiculous to me.

This brings me to my question:
Would  it  be appropriate to keep a database connection in each of the
memory  spaces?

Such  a connection is not very dynamic (I think) and thus you wouldn't
have to worry about having different types of connections or different
values of connections in the different memory spaces. (As you would if
you stored session data, that changes often.)

What  would be the down side to such an arrangement?  I would probably
need to create a method to time out the connections, so they don't sit
there  forever  if  I change something...  Is that correct?  What am I
missing?


Once  again, let me apologize for bringing up the session issue again.
I  have read all the posts here for the last few months, and I thought
I would see what the up/down sides to this plan would be.



From woodm at equire.com  Tue Jul  3 00:20:40 2001
From: woodm at equire.com (Matthew Wood)
Date: Fri Jan  9 21:52:28 2004
Subject: [mod_python] HTMLgen
Message-ID: <67100148213.20010703002040@equire.com>

I don't know how many of you are familiar with HTMLgen, but it's a set
of objects which aid in the construction of web-pages.

My question is this:

How useful would it be to integrate HTMLgen into a handler, instead of
importing it in each page I write?

The import statement, as well as the initial instanciation of the page
object  (I  can't remember exactly what the name of the object is...).
One  could  even  call  the  'Print  self'  function at the end of the
handler.

Would  this  help anything?  Would it make anything run faster?  Would
it make the code more readable?  Would this be a good idea at all?


I have hardly any experience with mod-python or mod-snake, so I really
don't have enough experience to answer this question.

Thanks in advance for all your help.



From benno at sesgroup.net  Tue Jul  3 16:24:54 2001
From: benno at sesgroup.net (Ben Leslie)
Date: Fri Jan  9 21:52:28 2004
Subject: [mod_python] Session data (Sorry for bringing this up again...)
In-Reply-To: <16299780187.20010703001432@equire.com>; from woodm@equire.com on Tue, Jul 03, 2001 at 12:14:32AM -0600
References: <16299780187.20010703001432@equire.com>
Message-ID: <20010703162453.C11798@sesgroup.net>

On Tue, 03 Jul 2001, Matthew Wood wrote:

<snip>

>
> This brings me to my question:
> Would  it  be appropriate to keep a database connection in each of the
> memory  spaces?


Yes. This is exactly what I do.

In your handler you have a global variable holding the db connection. In 
the handler you check the db handler is alive and recreate if necessary 
(this should really only happen the first time that process is used)

Benno

From piet at cs.uu.nl  Tue Jul  3 09:51:00 2001
From: piet at cs.uu.nl (piet@cs.uu.nl)
Date: Fri Jan  9 21:52:28 2004
Subject: [mod_python] Session data (Sorry for bringing this up again...)
In-Reply-To: Ben Leslie's message of "Tue, 3 Jul 2001 16:24:54 +1000"
References: <16299780187.20010703001432@equire.com>
	<20010703162453.C11798@sesgroup.net>
Message-ID: <u3d8esb6j.fsf@cs.uu.nl>

>>>>> Ben Leslie <benno@sesgroup.net> (BL) writes:

BL> On Tue, 03 Jul 2001, Matthew Wood wrote:
BL> <snip>

>> 
>> This brings me to my question:
>> Would  it  be appropriate to keep a database connection in each of the
>> memory  spaces?


BL> Yes. This is exactly what I do.

BL> In your handler you have a global variable holding the db connection. In 
BL> the handler you check the db handler is alive and recreate if necessary 
BL> (this should really only happen the first time that process is used)

You would have to be careful with multithreading. This applies to Apache on
MS Windows and with 2.0 also on Unix systems. You would need a connection
per thread. Or have a pool where each thread can try to grab a connection.
The pool administration would have to be protected with semaphores or locks
or similar. 
-- 
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl


From vincentwong at ionetbiz.com  Tue Jul  3 16:37:52 2001
From: vincentwong at ionetbiz.com (Vincent Wong)
Date: Fri Jan  9 21:52:28 2004
Subject: [mod_python] Error: No such file or directory
Message-ID: <00ae01c1039b$72f11160$3f00a8c0@ns1.ionetbiz.com>



I encountered the following error when I called the module test.py with  "test.py/saveform":



----
Mod_python error: "PythonHandler mod_python.publisher"

Traceback (most recent call last):

  File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line 193, in Dispatch
    result = object(req)

  File "/usr/local/lib/python2.1/site-packages/mod_python/publisher.py", line 128, in handler
    module = apache.import_module(module_name, _req, [path])

  File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line 356, in import_module
    if os.path.exists(filepath[:-1]) :

  File "/usr/local/lib/python2.1/posixpath.py", line 171, in exists
    st = os.stat(path)

OSError: [Errno 2] No such file or directory: '/home/demo/cgi-bin/test.p'

-----

the test.py file:

import os, sys

def saveform(req):
  return "OK."




Regards,

Vincent


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010703/cdf6c498/attachment-0001.htm
From matthias at my.gnus.org  Tue Jul  3 12:18:43 2001
From: matthias at my.gnus.org (Matthias Wiehl)
Date: Fri Jan  9 21:52:28 2004
Subject: [mod_python] Error: No such file or directory
In-Reply-To: <00ae01c1039b$72f11160$3f00a8c0@ns1.ionetbiz.com> ("Vincent
 Wong"'s message of "Tue, 3 Jul 2001 16:37:52 +0800")
References: <00ae01c1039b$72f11160$3f00a8c0@ns1.ionetbiz.com>
Message-ID: <871ynyqprw.agb@fulmine.dhs.org>

Vincent Wong <vincentwong@ionetbiz.com> writes:
> OSError: [Errno 2] No such file or directory: '/home/demo/cgi-bin/test.p'

Have a closer look at the filename.  I think this is a typo.

From daniel at copyleft.no  Tue Jul  3 12:48:55 2001
From: daniel at copyleft.no (Hr. Daniel Mikkelsen)
Date: Fri Jan  9 21:52:28 2004
Subject: [mod_python] Error: No such file or directory
In-Reply-To: <871ynyqprw.agb@fulmine.dhs.org>
Message-ID: <Pine.LNX.4.31.0107031247070.13943-100000@unity.copyleft.no>

>> OSError: [Errno 2] No such file or directory: '/home/demo/cgi-bin/test.p'

> Have a closer look at the filename.  I think this is a typo.

I don't know if it's the same thing here, but I'm running FreeBSD, and
mod_python erranously cuts the last character of filename of the handler
I've given. I had to remove a [:-1] suffix a couple of places in apache.py
(I think) to get it to work.

I'll post more details if it's interesting to anyone.

-- Daniel Mikkelsen, Copyleft Software AS



From CHagner at fool.com  Tue Jul  3 08:50:12 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:52:28 2004
Subject: [mod_python] Session data (Sorry for bringing this up again..
	.)
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E47FAF@rover.foolhq.com>

An alternative would be to have a separate daemon running on the server
(outside of apache/mod_python) that creates/serves/pools/persists your
connections.  Thus, each apache child process/python subinterp would hit
this daemon to get connections.  This model (or something similar) is almost
required if you're going to run apache with many child procs... or multiple
apache instances on the same box.  Either way, you don't really want 100
connections (or more! ack) open to the database.  Heck, if you're running
multiple web servers all hitting a single database, you can easily see how
the total number of connections gets painfully large.  You probably want
something along the lines of 5-10 connections in a db connection pool
(although this is highly dependent on the design of the pool and the
daemon).

Chris

-----Original Message-----
From: Ben Leslie [mailto:benno@sesgroup.net]
Sent: Tuesday, July 03, 2001 2:25 AM
To: Matthew Wood
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Session data (Sorry for bringing this up
again...)


On Tue, 03 Jul 2001, Matthew Wood wrote:

<snip>

>
> This brings me to my question:
> Would  it  be appropriate to keep a database connection in each of the
> memory  spaces?


Yes. This is exactly what I do.

In your handler you have a global variable holding the db connection. In 
the handler you check the db handler is alive and recreate if necessary 
(this should really only happen the first time that process is used)

Benno
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python

From vincentwong at ionetbiz.com  Tue Jul  3 21:38:48 2001
From: vincentwong at ionetbiz.com (Vincent Wong)
Date: Fri Jan  9 21:52:28 2004
Subject: [mod_python] Error: No such file or directory
References: <Pine.LNX.4.31.0107031247070.13943-100000@unity.copyleft.no>
Message-ID: <012301c103c5$7d3ee8c0$3f00a8c0@ns1.ionetbiz.com>

Thanks, Daniel.  So far it work after I change a few of [:-1] to [:].  I
wounldn't know if there is any side effect.


----- Original Message -----
From: Hr. Daniel Mikkelsen <daniel@copyleft.no>
To: Matthias Wiehl <matthias@my.gnus.org>
Cc: Vincent Wong <vincentwong@ionetbiz.com>; Mod_python Mailing List
<mod_python@modpython.org>
Sent: Tuesday, July 03, 2001 6:48 PM
Subject: Re: [mod_python] Error: No such file or directory


> >> OSError: [Errno 2] No such file or directory:
'/home/demo/cgi-bin/test.p'
>
> > Have a closer look at the filename.  I think this is a typo.
>
> I don't know if it's the same thing here, but I'm running FreeBSD, and
> mod_python erranously cuts the last character of filename of the handler
> I've given. I had to remove a [:-1] suffix a couple of places in apache.py
> (I think) to get it to work.
>
> I'll post more details if it's interesting to anyone.
>
> -- Daniel Mikkelsen, Copyleft Software AS
>


From seant at webreply.com  Tue Jul  3 14:02:13 2001
From: seant at webreply.com (Sean True)
Date: Fri Jan  9 21:52:28 2004
Subject: [mod_python] Translation handler help?
Message-ID: <MJEHLHJKGINLONDMMKNEIECFDHAA.seant@webreply.com>

We're implementing a bunch of stuff on top of mod_python, and have avoided
using the
translation handler. Until today.

I'd like to rewrite the URI -- but req.uri is readonly. I can't find a
req.uri() method ...

I'd like to find the equivalent of the CGI document root -- but
apache.build_cgi_env() is not happy about running inside the transhandler():

File /usr/local/pythonpackages/mod_python/apache.py", line 189, in Dispatch
    result = object(self.req)
File "/usr/local/pythonpackages/phtml/phtml.py", line 14, in transhandler
    env = apache.build_cgi_env(req)
File "/usr/local/pythonpackages/mod_python/apache.py", line 418, in
build_cgi_env
    env[k] = req.subprocess_env[k]
KeyError: SCRIPT_FILENAME

Does anyone have a creative or even functional example of a translation
handler?

-- Sean
-------
Sean True
WebReply.Com, Inc.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Sean True.vcf
Type: text/x-vcard
Size: 309 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20010703/f6dc2e8a/SeanTrue-0001.vcf
From grisha at modpython.org  Tue Jul  3 14:57:44 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:28 2004
Subject: [mod_python] Translation handler help?
In-Reply-To: <MJEHLHJKGINLONDMMKNEIECFDHAA.seant@webreply.com>
Message-ID: <Pine.BSF.4.32.0107031455280.93646-100000@localhost>

This is probably a screw up on my end - req.uri should be read only for
the translation handler to be useful... ;-)

It's not that hard to add that in - just look at how other read/write
variables are implemented - you have to put a couple of lines of code in
the set_attr function... If this is too much trouble, you 'll have to wait
until the next release.

Grisha

On Tue, 3 Jul 2001, Sean True wrote:

> We're implementing a bunch of stuff on top of mod_python, and have avoided
> using the
> translation handler. Until today.
>
> I'd like to rewrite the URI -- but req.uri is readonly. I can't find a
> req.uri() method ...
>
> I'd like to find the equivalent of the CGI document root -- but
> apache.build_cgi_env() is not happy about running inside the transhandler():
>
> File /usr/local/pythonpackages/mod_python/apache.py", line 189, in Dispatch
>     result = object(self.req)
> File "/usr/local/pythonpackages/phtml/phtml.py", line 14, in transhandler
>     env = apache.build_cgi_env(req)
> File "/usr/local/pythonpackages/mod_python/apache.py", line 418, in
> build_cgi_env
>     env[k] = req.subprocess_env[k]
> KeyError: SCRIPT_FILENAME
>
> Does anyone have a creative or even functional example of a translation
> handler?
>
> -- Sean
> -------
> Sean True
> WebReply.Com, Inc.
>


From matt at designscape.com.au  Wed Jul  4 11:59:39 2001
From: matt at designscape.com.au (Matt Beauregard)
Date: Fri Jan  9 21:52:28 2004
Subject: [mod_python] undefined symbol "floor"
Message-ID: <20010704115939.K14594@designscape.com.au>

We just set up mod_python and are getting the following strange error:

Mod_python error: "PythonHandler modpython"

Traceback (most recent call last):
  File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line 189, in Dispatch
    result = object(self.req)
  File "/usr/home/marauder/exchange/modpython.py", line 7, in handler
ImportError: /usr/local/lib/python2.1/lib-dynload/struct.so: Undefined symbol "floor"

We get this any time some code tries to import struct, when running
through mod_python, but not when running from the interpreter.  Any
clues for fixing it would be appreciated.

Using mod_python 2.7.5
Python 2.1 (#2, Jul  3 2001, 17:40:45) 
[GCC 2.95.2 19991024 (release)] on freebsd4
FreeBSD bofh.designscape.com.au 4.2-RELEASE FreeBSD 4.2-RELEASE #0:
Tue Feb 27 12:11:29 EST 2001 marauder@bofh.designscape.com.au:/usr/src/sys/compile/BOFH  i386

thanks,

-- 
Matt Beauregard
BOFH, Designscape
Ph: +61 2 9361 4233   Fx: +61 2 9361 4633

Permission is given for unlimited distribution of this work under the
Copyright Act 1968 (2001 amended).  Unless otherwise stated, you agree
that these terms also cover works which you send in response.


From grisha at modpython.org  Tue Jul  3 22:53:53 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:28 2004
Subject: [mod_python] undefined symbol "floor"
In-Reply-To: <20010704115939.K14594@designscape.com.au>
Message-ID: <Pine.BSF.4.32.0107032247370.293-100000@localhost>

floor() lives in libm, make sure that when you compile it, "-lm" is one of
the options.

On Wed, 4 Jul 2001, Matt Beauregard wrote:

> We just set up mod_python and are getting the following strange error:
>
> Mod_python error: "PythonHandler modpython"
>
> Traceback (most recent call last):
>   File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line 189, in Dispatch
>     result = object(self.req)
>   File "/usr/home/marauder/exchange/modpython.py", line 7, in handler
> ImportError: /usr/local/lib/python2.1/lib-dynload/struct.so: Undefined symbol "floor"
>
> We get this any time some code tries to import struct, when running
> through mod_python, but not when running from the interpreter.  Any
> clues for fixing it would be appreciated.
>
> Using mod_python 2.7.5
> Python 2.1 (#2, Jul  3 2001, 17:40:45)
> [GCC 2.95.2 19991024 (release)] on freebsd4
> FreeBSD bofh.designscape.com.au 4.2-RELEASE FreeBSD 4.2-RELEASE #0:
> Tue Feb 27 12:11:29 EST 2001 marauder@bofh.designscape.com.au:/usr/src/sys/compile/BOFH  i386
>
> thanks,
>
> --
> Matt Beauregard
> BOFH, Designscape
> Ph: +61 2 9361 4233   Fx: +61 2 9361 4633
>
> Permission is given for unlimited distribution of this work under the
> Copyright Act 1968 (2001 amended).  Unless otherwise stated, you agree
> that these terms also cover works which you send in response.
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From matt at designscape.com.au  Wed Jul  4 13:04:42 2001
From: matt at designscape.com.au (Matt Beauregard)
Date: Fri Jan  9 21:52:28 2004
Subject: [mod_python] undefined symbol "floor"
In-Reply-To: <Pine.BSF.4.32.0107032247370.293-100000@localhost>; from grisha@modpython.org on Tue, Jul 03, 2001 at 10:53:53PM -0400
References: <20010704115939.K14594@designscape.com.au> <Pine.BSF.4.32.0107032247370.293-100000@localhost>
Message-ID: <20010704130442.A40751@designscape.com.au>

On Tue, Jul 03, 2001 at 10:53:53PM -0400, Gregory (Grisha) Trubetskoy wrote:
> 
> floor() lives in libm, make sure that when you compile it, "-lm" is one of
> the options.

Hi Gregory,

I think the relevant compile lines are 
/usr/local/sbin/apxs -I/usr/ports/www/mod_python/work/mod_python-2.7.5/src/include -I/usr/local/include/apache -I/usr/ports/www/mod_python/work/Python-2.1 -I/usr/ports/www/mod_python/work/Python-2.1/Include -c mod_python.o  _apachemodule.o  requestobject.o  tableobject.o  util.o  serverobject.o  connobject.o -lm  /usr/ports/www/mod_python/work/Python-2.1/libpython2.1.a      -lm
gcc -shared -o mod_python.so mod_python.o _apachemodule.o requestobject.o tableobject.o util.o serverobject.o connobject.o -lm /usr/ports/www/mod_python/work/Python-2.1/libpython2.1.a -lm 

Output from objdump:
!815 root@bofh:/usr/ports/www/mod_python/work/mod_python-2.7.5/src# objdump -t mod_python.so|grep floor
00000000       F *UND*  00000000 floor
!816 root@bofh:/usr/ports/www/mod_python/work/mod_python-2.7.5/src# objdump -T mod_python.so|grep floor
00000000      DF *UND*  00000000 floor

Any clues?

thanks,

-- 
Matt Beauregard
Technical Director, Designscape
Ph: +61 2 9361 4233   Fx: +61 2 9361 4633

Permission is given for unlimited distribution of this work under the
Copyright Act 1968 (2001 amended).  Unless otherwise stated, you agree
that these terms also cover works which you send in response.


From mark_miller_ca at yahoo.com  Wed Jul  4 01:31:11 2001
From: mark_miller_ca at yahoo.com (Mark Miller)
Date: Fri Jan  9 21:52:28 2004
Subject: [mod_python] mod_python and testing error
Message-ID: <ALEBINNPGFGFAJGIFGHPAEGICBAA.mark_miller_ca@yahoo.com>

when i try to run the test script as stated in the manual,
i originally was getting the text of the script displayed on the screen, but
i just ran it now, and i got from apache: internal server error.

Within the apache error_log file, i have [Wed Jul 4 01:07:41 2001] [error]
[client 192.168.0.92] python_handler: make_obcallback returned no
obCallBack!

Can anyone guide me beyond this point, i get the feeling that i am close, if
it comes down to it, i will include my httpd.conf, but i don't imagine the
problem is within the file.

Thanks

Mark Miller


_________________________________________________________
Do You Yahoo!?
Get your free @yahoo.com address at http://mail.yahoo.com


From daniel at copyleft.no  Wed Jul  4 09:35:14 2001
From: daniel at copyleft.no (Hr. Daniel Mikkelsen)
Date: Fri Jan  9 21:52:28 2004
Subject: [mod_python] undefined symbol "floor"
In-Reply-To: <Pine.BSF.4.32.0107032247370.293-100000@localhost>
Message-ID: <Pine.LNX.4.31.0107040933280.13943-100000@unity.copyleft.no>

> floor() lives in libm, make sure that when you compile it, "-lm" is one of
> the options.

It is my experience, on FreeBSD, that I have to recompile Apache with
"-lm" in order for this to work. Linking it with mod_python doesn't seem
to cut it (unless one perhaps linked it statically).

-- Daniel Mikkelsen, Copyleft Software AS



From matt at designscape.com.au  Wed Jul  4 17:51:15 2001
From: matt at designscape.com.au (Matt Beauregard)
Date: Fri Jan  9 21:52:28 2004
Subject: [mod_python] undefined symbol "floor"
In-Reply-To: <Pine.LNX.4.31.0107040933280.13943-100000@unity.copyleft.no>; from daniel@copyleft.no on Wed, Jul 04, 2001 at 09:35:14AM +0200
References: <Pine.BSF.4.32.0107032247370.293-100000@localhost> <Pine.LNX.4.31.0107040933280.13943-100000@unity.copyleft.no>
Message-ID: <20010704175115.F40751@designscape.com.au>

On Wed, Jul 04, 2001 at 09:35:14AM +0200, Hr. Daniel Mikkelsen wrote:
> > floor() lives in libm, make sure that when you compile it, "-lm" is one of
> > the options.
> 
> It is my experience, on FreeBSD, that I have to recompile Apache with
> "-lm" in order for this to work. Linking it with mod_python doesn't seem
> to cut it (unless one perhaps linked it statically).

Hooray!  Thanks Daniel, one step closer...

Now it's finding floor, but I'm getting 
ImportError: /usr/local/lib/python2.1/lib-dynload/_socket.so: Undefined symbol "PyThread_acquire_lock"

Is this another linker problem?  What do I link in to get this solved?

thanks,

-- 
Matt Beauregard
Technical Director, Designscape
Ph: +61 2 9361 4233   Fx: +61 2 9361 4633

Permission is given for unlimited distribution of this work under the
Copyright Act 1968 (2001 amended).  Unless otherwise stated, you agree
that these terms also cover works which you send in response.


From vincentwong at ionetbiz.com  Wed Jul  4 16:36:18 2001
From: vincentwong at ionetbiz.com (Vincent Wong)
Date: Fri Jan  9 21:52:29 2004
Subject: [mod_python] os.system problem
Message-ID: <007401c10464$65bb50e0$3f00a8c0@ns1.ionetbiz.com>

When I use os.system('some command') within the interactive interpreter, everything works fine.  But when I use the same os.system('some command') together with mod_python, no error reported but the effect of the command does not occur.  Anyone know what is happenning here?

Regards.
Vincent

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010704/247ee969/attachment-0001.htm
From daniel at copyleft.no  Wed Jul  4 10:31:50 2001
From: daniel at copyleft.no (Hr. Daniel Mikkelsen)
Date: Fri Jan  9 21:52:29 2004
Subject: [mod_python] undefined symbol "floor" 
Message-ID: <Pine.LNX.4.31.0107041031270.13943-100000@unity.copyleft.no>

>> It is my experience, on FreeBSD, that I have to recompile Apache with
>> "-lm" in order for this to work. Linking it with mod_python doesn't seem
>> to cut it (unless one perhaps linked it statically).

> Now it's finding floor, but I'm getting ImportError:
> /usr/local/lib/python2.1/lib-dynload/_socket.so: Undefined symbol
> "PyThread_acquire_lock" Is this another linker problem?  What do I
> link in to get this solved?

I got this one too, at one point, but I can't remember what I did. I think
it had something to do with Python's /usr/local/lib/python2.1 binaries
being compiled with threading.

Perhaps a separate install of a threadless python, in another directory,
and linking against that, will help you. Only, I can't recall doing this,
and things are working for me now.

There were also more problems like this, one with mxDateTime. I feel every
time I want to set up mod_python after a few months of not using it, I
have to spend days fucking with it. :)

-- Daniel Mikkelsen, Copyleft Software AS



From mai99dgf at studserv.uni-leipzig.de  Wed Jul  4 13:34:08 2001
From: mai99dgf at studserv.uni-leipzig.de (Georg Martius)
Date: Fri Jan  9 21:52:29 2004
Subject: [mod_python] apache-1.3.14 Suse/Linux & mod_python toubles
Message-ID: <3B42FF30.BA021F5F@studserv.uni-leipzig.de>

Hi

I have same troubles with the mod_python module and my apache. 
I have SuSE 7.1 and the apache logs the following:

[notice] Apache/1.3.14 (Unix)  (SuSE/Linux) mod_python/2.7.1 Python/2.0
mod_throttle/3.0 mod_layout/1.0 mod_fastcgi/2.2.2 mod_perl/1.24
PHP/3.0.17-dev configured -- resuming normal operations 

I have copied the mptest.py into my cgi-bin directory with the right
permissions.

the splitter of my httpd.conf is:

<Directory /usr/local/httpd/cgi-bin>
  AddHandler python-program .py
  PythonHandler mptest
  PythonDebug On
</Directory>      


If perform a request to mptest.py I get in internal server error and the
logfile shows:
[error] (8)Exec format error: exec of /usr/local/httpd/cgi-bin/mptest.py
failed
[error] [client 192.168.155.55] Premature end of script headers:
/usr/local/httpd/cgi-bin/mptest.py     

Thanks for any help!

Ciao Bethoven

From M.Izydorski at rubikon.pl  Wed Jul  4 16:15:51 2001
From: M.Izydorski at rubikon.pl (Michal Izydorski)
Date: Fri Jan  9 21:52:29 2004
Subject: [mod_python] Configuration problems
Message-ID: <1646860855.20010704161551@rubikon.pl>

Hello!!

I have configuration problems with Apache 1.3.20 under W2k

The error is:

> Syntax error on line 211 of c:/program files/apache group/apache/conf/httpd.conf
> :
> Cannot load c:/program files/apache group/apche/modules/mod_python.dll into serv
> er: (126) Nie mo?na odnale?? okre?lonego modu-u:


           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
I don't know, why marked part is in my w2k local language, it means No
such modules.

I load other modules, esp. PHP, and there isn't problem, the same dir,
proprietary LoadModule Directives, bup Python don't work.

Please help and send answer to my email too.


-- 
Regards,
 Michal                          mailto:M.Izydorski@rubikon.pl



From grisha at modpython.org  Wed Jul  4 10:18:12 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:29 2004
Subject: [mod_python] undefined symbol "floor"
In-Reply-To: <20010704175115.F40751@designscape.com.au>
Message-ID: <Pine.BSF.4.32.0107041016050.8569-100000@localhost>

oh, this is an easy one - recompile Python without threads and use
--with-python to compile mod_python.

the mod_python port used to take care of all of that very nicely, but it
seems to be a bit outdated at 2.7.3... although you might be able to tweak
the Makefile just a little bit to make it compile the latest version -
there isn't all that much difference.

grisha

On Wed, 4 Jul 2001, Matt Beauregard wrote:

> On Wed, Jul 04, 2001 at 09:35:14AM +0200, Hr. Daniel Mikkelsen wrote:
> > > floor() lives in libm, make sure that when you compile it, "-lm" is one of
> > > the options.
> >
> > It is my experience, on FreeBSD, that I have to recompile Apache with
> > "-lm" in order for this to work. Linking it with mod_python doesn't seem
> > to cut it (unless one perhaps linked it statically).
>
> Hooray!  Thanks Daniel, one step closer...
>
> Now it's finding floor, but I'm getting
> ImportError: /usr/local/lib/python2.1/lib-dynload/_socket.so: Undefined symbol "PyThread_acquire_lock"
>
> Is this another linker problem?  What do I link in to get this solved?
>
> thanks,
>
> --
> Matt Beauregard
> Technical Director, Designscape
> Ph: +61 2 9361 4233   Fx: +61 2 9361 4633
>
> Permission is given for unlimited distribution of this work under the
> Copyright Act 1968 (2001 amended).  Unless otherwise stated, you agree
> that these terms also cover works which you send in response.
>


From vincentwong at ionetbiz.com  Thu Jul  5 12:00:46 2001
From: vincentwong at ionetbiz.com (Vincent Wong)
Date: Fri Jan  9 21:52:29 2004
Subject: [mod_python] link to image files broken
Message-ID: <00fc01c10507$1218a700$3f00a8c0@ns1.ionetbiz.com>

I have a html file call thanks.html.  When I open this file and return the content from my test.py file, all links to image (.gif) files are broken.  Did anyone know the solution?

Thanks.

Vincent

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010705/b1386738/attachment-0001.htm
From piet at cs.uu.nl  Thu Jul  5 11:01:29 2001
From: piet at cs.uu.nl (piet@cs.uu.nl)
Date: Fri Jan  9 21:52:29 2004
Subject: [mod_python] link to image files broken
In-Reply-To: "Vincent Wong"'s message of "Thu, 5 Jul 2001 12:00:46 +0800"
References: <00fc01c10507$1218a700$3f00a8c0@ns1.ionetbiz.com>
Message-ID: <ubsmzoil2.fsf@cs.uu.nl>

>>>>> "Vincent Wong" <vincentwong@ionetbiz.com> (VW) writes:

VW> I have a html file call thanks.html. When I open this file and return
VW> the content from my test.py file, all links to image (.gif) files are
VW> broken. Did anyone know the solution?

Not without knowing how the links to the images are coded in thanks.html.
-- 
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl


From vincentwong at ionetbiz.com  Fri Jul  6 14:18:45 2001
From: vincentwong at ionetbiz.com (Vincent Wong)
Date: Fri Jan  9 21:52:29 2004
Subject: [mod_python] link to image files broken
References: <014901c10542$3c018ec0$3f00a8c0@ns1.ionetbiz.com>
Message-ID: <012801c105e3$833099c0$3f00a8c0@ns1.ionetbiz.com>

these are the test.py and thanks.html

---test.py---


import os, sys
def saveform(req):
  input = open('../../thanks.html', 'r')

  return input.read()


---thanks.html---

<html>
<head>
<title>Desa Millennia E-Community</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<script language="JavaScript">
<!--
function MM_preloadImages() { file://v3.0
  var d=document; if(d.images){ if(!d.MM_p) d.MM_p=new Array();
    var i,j=d.MM_p.length,a=MM_preloadImages.arguments; for(i=0; i<a.length;
i++)
    if (a[i].indexOf("#")!=0){ d.MM_p[j]=new Image; d.MM_p[j++].src=a[i];}}
}

function MM_swapImgRestore() { file://v3.0
  var i,x,a=document.MM_sr; for(i=0;a&&i<a.length&&(x=a[i])&&x.oSrc;i++)
x.src=x.oSrc;
}

function MM_findObj(n, d) { file://v4.0
  var p,i,x;  if(!d) d=document;
if((p=n.indexOf("?"))>0&&parent.frames.length) {
    d=parent.frames[n.substring(p+1)].document; n=n.substring(0,p);}
  if(!(x=d[n])&&d.all) x=d.all[n]; for (i=0;!x&&i<d.forms.length;i++)
x=d.forms[i][n];
  for(i=0;!x&&d.layers&&i<d.layers.length;i++)
x=MM_findObj(n,d.layers[i].document);
  if(!x && document.getElementById) x=document.getElementById(n); return x;
}

function MM_swapImage() { file://v3.0
  var i,j=0,x,a=MM_swapImage.arguments; document.MM_sr=new Array;
for(i=0;i<(a.length-2);i+=3)
   if ((x=MM_findObj(a[i]))!=null){document.MM_sr[j++]=x; if(!x.oSrc)
x.oSrc=x.src; x.src=a[i+2];}
}
file://-->
</script>
</head>

<body bgcolor="#FFFFFF" text="#000000" leftmargin="0" topmargin="0"
marginwidth="0" marginheight="0" background="main/002darkgreen.gif"
onLoad="MM_preloadImages('main/016community1.gif','main/017security1.gif','m
ain/018events1.gif','main/019onlinepay1.gif','main/20onlinebook1.gif','main/
21shopping1.gif','main/22food1.gif','main/23entertain1.gif','main/24gettinga
round1.gif','main/25thetown1.gif','main/26news1.gif','main/27technical1.gif'
,'main/28infodesk1.gif','main/29faq1.gif','main/41a.gif','main/015home1.gif'
)">
<div align="center">
  <table width="100%" border="0" cellspacing="0" cellpadding="0"
bgcolor="#FFFFFF">
    <tr>
      <td>
        <div align="center"><img src="main/000none.gif" width="10"
height="10"><br>
          <img src="main/00logo.gif" width="197" height="38"><img
src="main/000none.gif" width="80" height="8">
          <img src="main/00newlaunch_banner.gif" width="480" height="60">
<img src="main/000none.gif" width="20" height="8"><br>
          <img src="main/000none.gif" width="10" height="3"></div>
      </td>
    </tr>
  </table>
  <table width="100%" border="0" cellspacing="0" cellpadding="0">
    <tr>
      <td height="3" background="main/001blackwhiteline.gif"><img
src="main/000none.gif" width="1" height="1"></td>
    </tr>
  </table>
  <table width="761" border="0" cellspacing="0" cellpadding="0">
    <tr>
      <td><br>
        <table width="767" border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td width="375"><img src="main/000none.gif" width="175"
height="1"><img src="main/45.gif" width="112" height="41"></td>
            <td width="386">
              <table width="100%" border="0" cellspacing="0"
cellpadding="0">
                <tr>
                  <td><b><font face="Arial, Helvetica, sans-serif" size="1"
color="#CCCCCC">Username
                    :<img src="main/000none.gif" width="10"
height="8"></font></b></td>
                  <td>
                    <input type="text" name="textfield" size="10">
                    <b><font face="Arial, Helvetica, sans-serif" size="1"
color="#CCCCCC"><img src="main/000none.gif" width="20"
height="8"></font></b>
                  </td>
                  <td><b><font face="Arial, Helvetica, sans-serif" size="1"
color="#CCCCCC">Password
                    :<img src="main/000none.gif" width="10" height="8">
</font></b></td>
                  <td>
                    <input type="text" name="textfield2" size="10">
                  </td>
                  <td>
                    <div align="right"><img src="main/004go.gif" width="22"
height="22"></div>
                  </td>
                </tr>
              </table>
            </td>
          </tr>
        </table>
        <table width="761" border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td width="111" valign=top background="main/013.gif">
              <p><img src="main/002darkgreen.gif" width="111"
height="3"><br>
                <font color="#FFFFFF"><b><font face="Verdana, Tahoma, Arial"
size="1">Search
                For :<br>
                <img src="main/000none.gif" width="8" height="8"><br>
                <input type="text" name="textfield3" size="13">
                <br>
                </font><font color="#FFFFFF"><b><font face="Verdana, Tahoma,
Arial" size="1"><img src="main/000none.gif" width="8"
height="8"></font></b></font><br>
                <img src="main/000none.gif" width="28" height="1"><img
src="main/014searchbutton.gif" width="74" height="16"><br>
                <br>
                <a href="index.html" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image15','','main/015home1.gif',1)"><img
src="main/015home.gif" width="111" height="24" border="0"
name="Image15"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image1','','main/016community1.gif',1)"><img
src="main/016community.gif" width="111" height="24" border="0"
name="Image1"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image2','','main/017security1.gif',1)"><img
src="main/017security.gif" width="111" height="24" border="0"
name="Image2"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image3','','main/018events1.gif',1)"><img
src="main/018events.gif" width="111" height="24" border="0"
name="Image3"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image4','','main/019onlinepay1.gif',1)"><img
src="main/019onlinepay.gif" width="111" height="24" border="0"
name="Image4"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image5','','main/20onlinebook1.gif',1)"><img
src="main/20onlinebook.gif" width="111" height="24" border="0"
name="Image5"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image6','','main/21shopping1.gif',1)"><img
src="main/21shopping.gif" width="111" height="24" border="0"
name="Image6"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image7','','main/22food1.gif',1)"><img
src="main/22food.gif" width="111" height="24" border="0"
name="Image7"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image8','','main/23entertain1.gif',1)"><img
src="main/23entertain.gif" width="111" height="24" border="0"
name="Image8"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image9','','main/24gettingaround1.gif',1)"><img
src="main/24gettingaround.gif" width="111" height="24" border="0"
name="Image9"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image10','','main/25thetown1.gif',1)"><img
src="main/25thetown.gif" width="111" height="24" border="0"
name="Image10"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image11','','main/26news1.gif',1)"><img
src="main/26news.gif" width="111" height="24" border="0"
name="Image11"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image12','','main/27technical1.gif',1)"><img
src="main/27technical.gif" width="111" height="24" border="0"
name="Image12"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image13','','main/28infodesk1.gif',1)"><img
src="main/28infodesk.gif" width="111" height="24" border="0"
name="Image13"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image14','','main/29faq1.gif',1)"><img
src="main/29faq.gif" width="111" height="24" border="0"
name="Image14"></a></b></font></p>
              <p align="center"><img src="main/30advert.gif" width="102"
height="113"><br>
                <br>
              </p>
            </td>
            <td width="11" valign=top background="main/007.gif"><img
src="main/008.gif" width="11" height="32"></td>
            <td width="627" valign=top bgcolor="#FFFFFF">
              <div align="left">
                <table width="100%" border="0" cellspacing="0"
cellpadding="0">
                  <tr>
                    <td background="main/43.gif"><img src="main/44.gif"
width="167" height="27"></td>
                  </tr>
                </table>
                <br>
                <br>
                <br>
                <br>
                <table width="85%" border="0" cellspacing="0"
cellpadding="0" align="center">
                  <tr>
                    <td>
                      <div align="center">
                        <p><b><font face="Verdana, Arial, Helvetica,
sans-serif" size="1" color="#000000">THANK
                          YOU !</font></b></p>
                        <p align="center"><b><font face="Verdana, Arial,
Helvetica, sans-serif" size="1" color="#000000"><font color="#003300">Your
                          registration is successfull ! To learn how to
install
                          your e-mail, please <font color="#333333"><a
href="faq2.html"><font color="#000000">click
                          here</font></a></font>!</font></font></b></p>
                        </div>
                    </td>
                  </tr>
                </table>
                <div align="center"><br>
                  <br>
                  <table width="85%" border="0" cellspacing="0"
cellpadding="0" align="center">
                    <tr>
                      <td width="50%"><b><font face="Verdana, Arial,
Helvetica, sans-serif" size="1" color="#000000"><a href="invite.html"
target="_blank"><img src="main/02.jpg" width="73" height="61"
border="0"></a><a href="invite.html" target="_blank"><img src="main/38.gif"
width="171" height="61" border="0"></a><br>
                        <br>
                        <b><font face="Arial, Helvetica, sans-serif"
size="1" color="#CCCCCC"><img src="main/000none.gif" width="8"
height="4"></font></b><br>
                        <img src="main/32line.gif" width="254"
height="1"><br>
                        <img src="main/33.gif" width="98" height="89"><img
src="main/34.gif" width="154" height="89" usemap="#Map3" border="0"><br>
                        <img src="main/35.gif" width="99" height="94"><img
src="main/36.gif" width="153" height="94" usemap="#Map4Map" border="0"><br>
                        <br>
                        <map name="Map3">
                          <area shape="rect" coords="74,58,153,73"
href="http://www.emasonline.com/millenniumland/Showhouse/Main.asp"
target="_blank">
                        </map>
                        </font></b><b><font face="Verdana, Arial, Helvetica,
sans-serif" size="1" color="#000000">
                        <map name="Map4Map">
                          <area shape="rect" coords="73,68,152,81"
href="http://www.emasonline.com/millenniumland/demo.asp" target="_blank">
                        </map>
                        </font></b></td>
                      <td width="50%">
                        <div align="center">
                          <p align="center"><img src="main/54suggest.gif"
width="153" height="180" usemap="#Map" border="0">
                            <map name="Map">
                              <area shape="rect" coords="63,137,144,151"
href="mailto:feedback@desamillennia.com" alt="SUGESST ??" title="SUGESST
??">
                            </map>
                            <b><font face="Verdana, Arial, Helvetica,
sans-serif" size="1" color="#000000">
                            <map name="Map4">
                              <area shape="rect" coords="73,68,152,81"
href="http://www.emasonline.com/millenniumland/demo.asp" target="_blank">
                            </map>
                            </font></b></p>
                        </div>
                      </td>
                    </tr>
                  </table>
                  <br>
                </div>
                <div align="center"><br>
                </div>
                <p align="center">&nbsp;</p>
                <p align="center">&nbsp;</p>
              </div>
            </td>
            <td width="12" background="main/005.gif" valign=top><img
src="main/006.gif" width="12" height="30"></td>
          </tr>
        </table>
        <table width="761" border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td width="114">
              <div align="right"><img src="main/50.gif" width="4"
height="10"></div>
            </td>
            <td width="647" background="main/48.gif">
              <div align="right"><img src="main/49.gif" width="8"
height="10"></div>
            </td>
          </tr>
        </table>
        <table width="761" border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td width="114">
              <div align="right"></div>
            </td>
            <td width="647">
              <div align="center"><br>
                <font size="1" face="Arial, Helvetica, sans-serif"
color="#CCCCCC">
                Home | Community | Security Access | Events | Online Payment
|
                Online Booking | Shopping | Food &amp; Dining |
Entertainment
                | Getting Around | The Town | News &amp; Archives |
Technical
                Support | Information Desk | FAQ<br>
                <font color="#666666"><br>
                Copyright 2001 &copy; . Desa Millennia Sdn Bhd. Your Smart
Township.
                Site constructed by zecnet.com and
ionetbiz.com.</font></font></div>
            </td>
          </tr>
        </table>

      </td>
    </tr>
  </table>
  <br>
</div>
</body>
</html>






From piet at cs.uu.nl  Fri Jul  6 11:30:42 2001
From: piet at cs.uu.nl (piet@cs.uu.nl)
Date: Fri Jan  9 21:52:29 2004
Subject: [mod_python] link to image files broken
In-Reply-To: "Vincent Wong"'s message of "Fri, 6 Jul 2001 14:18:45 +0800"
References: <014901c10542$3c018ec0$3f00a8c0@ns1.ionetbiz.com>
	<012801c105e3$833099c0$3f00a8c0@ns1.ionetbiz.com>
Message-ID: <uhewqiev1.fsf@cs.uu.nl>

>>>>> "Vincent Wong" <vincentwong@ionetbiz.com> (VW) writes:

VW> these are the test.py and thanks.html
VW> ---test.py---


VW> import os, sys
VW> def saveform(req):
VW>   input = open('../../thanks.html', 'r')

VW>   return input.read()


VW> ---thanks.html---
....
VW> marginwidth="0" marginheight="0" background="main/002darkgreen.gif"
VW> onLoad="MM_preloadImages('main/016community1.gif','main/017security1.gif','m

It is difficult to know without the context, but I guess the problem is
that your images are supposed to come from the directory `main', which I
suppose is relative to the directory where thanks.html is found. But the
browser doesn't know that the HTML file comes from ../.., it works relative
to the directory where your python script is located (or the original
script that calls this one).

So you could:
1. Change the image locations in thanks.html to ../../main
2. Move the main directory to the sirectory where your python scripts are
   (but this doesn't help if you also need to refer to thanks.html
   directly)
3. Put a <BASE HREF="actual location of the thanks.html file"> in
   thanks.html or in the copy that you write.
I think 3 is the best solution.
-- 
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl


From seant at webreply.com  Fri Jul  6 12:34:27 2001
From: seant at webreply.com (Sean True)
Date: Fri Jan  9 21:52:29 2004
Subject: [mod_python] More translation handler help?
In-Reply-To: <ubsmzoil2.fsf@cs.uu.nl>
Message-ID: <MJEHLHJKGINLONDMMKNEEEENDHAA.seant@webreply.com>

With a little bit of help from Grisha, I got past my first problem (I needed
a writable req.uri)
and am onto a second one.

I stripped out the following handlers from a much larger system, and they
reproduce the problem.
The production handler (handler) attempts to do a lookup_uri on the inbound
URI. If there is no translation handler
called for in the conf file, all is well, and the lookup works.

If there is a translation handler declared using PythonTransHandler, the
Transhandler gets called twice,
and the server process appears to go into a loop -- never exits the
production handler. I'm suspecting
that there is a reentrancy issue here of some sort, but the Apache code
specifically suggests calling lookup_uri() to
get the mapping of "/" to filename, instead of using document_root().

Comments on the rules of when one can and can't call lookup_uri() would be
welcome.

-- Sean


Configuration:

# Connections for general test site
<VirtualHost www.foo.com>
    DocumentRoot /usr/local/apache/htdocs/www.foo.com
    ServerName www.foo.com
    AddHandler python-program .phtml
    PythonInterpreter xphtml
    PythonHandler phtml.xphtml
    PythonTransHandler phtml.xphtml
</VirtualHost>


xphtml.py:



from mod_python import apache
from phtmllog import log, logIO

def transhandler(req):
    log("transhandler "+`req.uri`)
    return apache.DECLINED

def handler(req):
    log("lookup_uri "+req.lookup_uri(req.uri).filename)
    return apache.OK


requestobject.c code for lookup_uri:

/**
 ** request.lookup_uri(request self, uri)
 **
 *    An interface to the ap_lookup_uri function.
 */

static PyObject * req_lookup_uri(requestobject *self, PyObject *args)
{
  const char *uri;
  request_rec *req;


  if (! PyArg_ParseTuple(args, "s", &uri))
    return NULL;

  req = (request_rec *)ap_sub_req_lookup_uri(uri,self->request_rec);
  if (! req) {
    Py_INCREF(Py_None);
    return Py_None;
  }
  else {
    return MpRequest_FromRequest(req);
  }
}


...


    {"lookup_uri",           (PyCFunction) req_lookup_uri,
METH_VARARGS},
    { NULL, NULL } /* sentinel */
};

...




From vincentwong at ionetbiz.com  Sat Jul  7 12:34:35 2001
From: vincentwong at ionetbiz.com (Vincent Wong)
Date: Fri Jan  9 21:52:29 2004
Subject: [mod_python] link to image files broken
References: <014901c10542$3c018ec0$3f00a8c0@ns1.ionetbiz.com><012801c105e3$833099c0$3f00a8c0@ns1.ionetbiz.com> <uhewqiev1.fsf@cs.uu.nl>
Message-ID: <001b01c1069e$206e8d40$3f00a8c0@ns1.ionetbiz.com>

Thanks.  I have make it work.  This is what I did.

--- test.py ---

import os, sys
from mod_python import apache

def saveform(req):
  input = open('/home/demo/html/thanks.html', 'r')
  req.write(input.read())
  return apache.OK


--- thanks.html ---

add the line:

<base href="http://demo.ionetbiz2.com/">


A question here:  the open statement above does not work with relative path,
why?



Regards,
Vincent




From vincentwong at ionetbiz.com  Sat Jul  7 13:10:30 2001
From: vincentwong at ionetbiz.com (Vincent Wong)
Date: Fri Jan  9 21:52:29 2004
Subject: [mod_python] link to image files broken
Message-ID: <003601c106a3$2805f700$3f00a8c0@ns1.ionetbiz.com>

Thanks.  I have make it work.  This is what I did.

--- test.py ---

import os, sys
from mod_python import apache

def saveform(req):
  input = open('/home/demo/html/thanks.html', 'r')
  req.write(input.read())
  return apache.OK


--- thanks.html ---

add the line:

<base href="http://demo.ionetbiz2.com/">


A question here:  the open statement above does not work with relative path,
why?



Regards,
Vincent



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010707/76bd17c3/attachment-0001.htm
From wart at softhome.net  Sat Jul  7 13:03:10 2001
From: wart at softhome.net (Wartan Hachaturow)
Date: Fri Jan  9 21:52:29 2004
Subject: [mod_python] link to image files broken
In-Reply-To: <003601c106a3$2805f700$3f00a8c0@ns1.ionetbiz.com>
Message-ID: <20010707130310.A9632@penguin.aktivist.ru>

On Sat, Jul 07, 2001 at 01:10:30PM +0800, Vincent Wong wrote:

> A question here:  the open statement above does not work with relative path,
> why?

Because it opens the file from the filesystem, and not the one 
served by the web server.

-- 
Regards, Wartan.
echo "Your stdio isn't very std." 
		-- Larry Wall in Configure from the perl distribution

From kees.serier at relan.nl  Sat Jul  7 11:48:09 2001
From: kees.serier at relan.nl (Serier, Kees)
Date: Fri Jan  9 21:52:29 2004
Subject: [mod_python] ld error when trying to build mod-python
Message-ID: <AA2536FEE0A9D311887000508B5EDF1E0219634B@ab00s003.abab.cadans.nl>

Hi,

I'm trying to build mod_python 2.7.5 on AIX, but get the following error
from ld, any ideas or hints?

ld: 0711-244 ERROR: No csects or exported symbols have been saved.
apxs:Break: Command failed with rc=8

Kees Serier mailto:kees.serier@ordina.nl

General information:
   AIX        4.2.1
   GCC        2.95.2 (locally build and installed from source)
   GNU-make   3.79.1 (locally build and installed from source)
   Python     2.0    (locally build from source without threads)
   Apache     1.3.20 (locally build and installed from source with DSO)
   Mod_python 2.7.5

This is the output of configure and make;

[/usr/local/src/mod_python-2.7.5]# ./configure
--with-apxs=/usr/local/apache/bin/apxs --with-apache=../apache_1.3.20
--with-python=../Python-2.0/
creating cache ./config.cache
checking for gcc... gcc
checking whether the C compiler (gcc  ) works... yes
checking whether the C compiler (gcc  ) is a cross-compiler... no
checking whether we are using GNU C... yes
checking whether gcc accepts -g... yes
checking for ranlib... ranlib
checking for ar... ar
checking for a BSD compatible install... ./install-sh -c
checking whether make sets ${MAKE}... yes
checking for main in -lm... yes
checking for working const... yes
checking your blood pressure... a bit high, but we can proceed
checking whether apxs is available
checking for --with-apxs... /usr/local/apache/bin/apxs executable, good
checking for Apache libexec directory... /usr/local/apache/libexec
checking for Apache include directory... -I/usr/local/apache/include
checking for --with-apache... /usr/local/src/apache_1.3.20
checking for --with-python... /usr/local/src/Python-2.0
checking for python... /usr/local/src/Python-2.0/python
checking Python version... 2.0
checking whether Python is compiled with thread support... no threads, good
checking Python install prefix... /usr/local
checking what libraries Python was linked with...
/usr/local/src/Python-2.0/libpython2.0.a   -ldl    -lm
checking linker flags used to link Python...  -Wl,-bE:python.exp -lld
checking where Python include files are... -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include
checking for mkdep... no
checking for makedepend... /usr/bin/X11/makedepend
updating cache ./config.cache
creating ./config.status
creating Makefile
creating src/Makefile
creating src/libpython.module
creating Doc/Makefile
analyzing dependencies
sant[/usr/local/src/mod_python-2.7.5]= gmake
gmake[1]: Entering directory `/usr/local/src/mod_python-2.7.5/src'
gcc  -I/usr/local/src/mod_python-2.7.5/src/include
-I/usr/local/src/apache_1.3.20/src/include
-I/usr/local/src/apache_1.3.20/src/os/unix -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include    -c -o mod_python.o mod_python.c
gcc  -I/usr/local/src/mod_python-2.7.5/src/include
-I/usr/local/src/apache_1.3.20/src/include
-I/usr/local/src/apache_1.3.20/src/os/unix -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include    -c -o _apachemodule.o _apachemodule.c
gcc  -I/usr/local/src/mod_python-2.7.5/src/include
-I/usr/local/src/apache_1.3.20/src/include
-I/usr/local/src/apache_1.3.20/src/os/unix -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include    -c -o requestobject.o requestobject.c
gcc  -I/usr/local/src/mod_python-2.7.5/src/include
-I/usr/local/src/apache_1.3.20/src/include
-I/usr/local/src/apache_1.3.20/src/os/unix -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include    -c -o tableobject.o tableobject.c
gcc  -I/usr/local/src/mod_python-2.7.5/src/include
-I/usr/local/src/apache_1.3.20/src/include
-I/usr/local/src/apache_1.3.20/src/os/unix -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include    -c -o util.o util.c
gcc  -I/usr/local/src/mod_python-2.7.5/src/include
-I/usr/local/src/apache_1.3.20/src/include
-I/usr/local/src/apache_1.3.20/src/os/unix -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include    -c -o serverobject.o serverobject.c
gcc  -I/usr/local/src/mod_python-2.7.5/src/include
-I/usr/local/src/apache_1.3.20/src/include
-I/usr/local/src/apache_1.3.20/src/os/unix -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include    -c -o connobject.o connobject.c

Compiling for DSO. For static, do "make static"

/usr/local/apache/bin/apxs -I/usr/local/src/mod_python-2.7.5/src/include
-I/usr/local/src/apache_1.3.20/src/include
-I/usr/local/src/apache_1.3.20/src/os/unix -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include -c mod_python.o _apachemodule.o
requestobject.o tableobject.o util.o serverobject.o connobject.o  -lm
/usr/local/src/Python-2.0/libpython2.0.a   -ldl    -lm  
ld -H512 -T512 -bhalt:4 -bM:SRE -bnoentry
-bI:/usr/local/apache/libexec/httpd.exp -lc -o mod_python.so mod_python.o
_apachemodule.o requestobject.o tableobject.o util.o serverobject.o
connobject.o -lm /usr/local/src/Python-2.0/libpython2.0.a -ldl -lm
ld: 0711-244 ERROR: No csects or exported symbols have been saved.
apxs:Break: Command failed with rc=8
gmake[1]: *** [mod_python.so] Error 1
gmake[1]: Leaving directory `/usr/local/src/mod_python-2.7.5/src'
gmake: *** [do_dso] Error 2


From WAGLET at uk.ibm.com  Tue Jul 10 17:24:57 2001
From: WAGLET at uk.ibm.com (Tushar Wagle)
Date: Fri Jan  9 21:52:29 2004
Subject: [mod_python] database access within handler problem
Message-ID: <OFA5D85E79.491D0EC1-ON80256A85.00569389@portsmouth.uk.ibm.com>

Hello,

I've got mod_python up and running, but am having a problem connecting to 
my database from inside an AuthenHandler. The code runs fine outside
of mod_python under the 'apache' user, ie the user name/password is
okay, and I've correctly set permissions to allow the user database 
access.

I'm using the latest Python/mod_python with DB2 (and the Python DB2 
wrapper).

Any ideas of what might be wrong?

Are there some restrictions on what can be done (eg different user 
permissions)
from within an Apache Handler??

Could this be a configuration problem?...

Any help appreciated! :)

Best Regards,
Tushar.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010710/e0ad1c98/attachment-0001.htm
From laprice at efn.org  Tue Jul 10 14:51:34 2001
From: laprice at efn.org (larry a price)
Date: Fri Jan  9 21:52:29 2004
Subject: [mod_python] ModPython problems
In-Reply-To: <B770C6FE.38FB%tr@outputlinks.com>
Message-ID: <Pine.GSU.4.21.0107101432040.2738-100000@garcia.efn.org>

Hi, i'm trying to get WebWare 0.5 working with mod_python
i keep on getting this ImportError: module _apache not found
when trying to launch the ModPythonAppServer,
mod_python seems to work fine on it's own, the only thing i can see is
that there is no _apachemodule.so in lib-dynload, though there is an
_apachemodule.o in the build directory from which i installed mod_python,
can i just cp and rename that file or do i need to grovel through the
MakeFile and make sure that it's built as a shared library.

I'm running:
apache 1.3
mod_python 2.7.3
Webware 0.5
on
Debian 2.2.19pre17

Larry Price      |  "We have seen the truth.
laprice@efn.org  |   And the truth makes no sense." -chesterton
_______________________________________________________________





From ChuckEsterbrook at yahoo.com  Tue Jul 10 18:32:25 2001
From: ChuckEsterbrook at yahoo.com (Chuck Esterbrook)
Date: Fri Jan  9 21:52:29 2004
Subject: [mod_python] Re: [Webware-discuss] ModPython problems
In-Reply-To: <Pine.GSU.4.21.0107101432040.2738-100000@garcia.efn.org>
References: <B770C6FE.38FB%tr@outputlinks.com>
Message-ID: <5.0.2.1.0.20010710182905.027669f0@mail.mindspring.com>

At 02:51 PM 7/10/2001 -0700, larry a price wrote:
>Hi, i'm trying to get WebWare 0.5 working with mod_python
>i keep on getting this ImportError: module _apache not found
>when trying to launch the ModPythonAppServer,
>mod_python seems to work fine on it's own, the only thing i can see is
>that there is no _apachemodule.so in lib-dynload, though there is an
>_apachemodule.o in the build directory from which i installed mod_python,
>can i just cp and rename that file or do i need to grovel through the
>MakeFile and make sure that it's built as a shared library.
>
>I'm running:
>apache 1.3
>mod_python 2.7.3
>Webware 0.5
>on
>Debian 2.2.19pre17

I'm sorry to say I don't know the answer to your question, but I'm 
wondering if you really want to run the ModPythonAppServer, as opposed to 
the ModPython adapter which connects to a separately launched app server. 
That is the usual technique (e.g., your choice of adapter, plus the WebKit 
app server) used to run WebKit, because you can then restart the app server 
separate from the web server.

You should consider embedding the app server inside a web server to be more 
experimental, and I suppose the docs should reflect that.

In any case, it might help with diagnosing your problem if you could try 
the ModPythonAdapter and see if that suffers the same problems.


-Chuck


From laprice at efn.org  Tue Jul 10 15:59:49 2001
From: laprice at efn.org (larry a price)
Date: Fri Jan  9 21:52:29 2004
Subject: [mod_python] Re: [Webware-discuss] ModPython problems
In-Reply-To: <5.0.2.1.0.20010710182905.027669f0@mail.mindspring.com>
Message-ID: <Pine.GSU.4.21.0107101547330.5384-100000@garcia.efn.org>

On Tue, 10 Jul 2001, Chuck Esterbrook wrote:
> 
> I'm sorry to say I don't know the answer to your question, but I'm 
> wondering if you really want to run the ModPythonAppServer, as opposed to 
> the ModPython adapter which connects to a separately launched app server. 
> That is the usual technique (e.g., your choice of adapter, plus the WebKit 
> app server) used to run WebKit, because you can then restart the app server 
> separate from the web server.
>
OK, i did get the Webkit.cgi to work and the ModPythonAdapter seems to
work, does the correct redirect, I guess i was under the impression from
the docs that ModPythonAdapter 'required' ModPythonAppserver to work
correctly. Since that's not the case I'm not sure i understand why
ModPythonAppServer exists... it doesn't look like it enables any 
additional functionality. (aside from diddling the apache API)
the import _apache failure still bugs me though (anyone on the mod_python
front who can offer their wisdom?)


From ChuckEsterbrook at yahoo.com  Tue Jul 10 19:13:01 2001
From: ChuckEsterbrook at yahoo.com (Chuck Esterbrook)
Date: Fri Jan  9 21:52:29 2004
Subject: [mod_python] Re: [Webware-discuss] ModPython problems
In-Reply-To: <Pine.GSU.4.21.0107101547330.5384-100000@garcia.efn.org>
References: <5.0.2.1.0.20010710182905.027669f0@mail.mindspring.com>
Message-ID: <5.0.2.1.0.20010710191019.02ca79a0@mail.mindspring.com>

At 03:59 PM 7/10/2001 -0700, larry a price wrote:
>OK, i did get the Webkit.cgi to work and the ModPythonAdapter seems to
>work, does the correct redirect, I guess i was under the impression from
>the docs that ModPythonAdapter 'required' ModPythonAppserver to work
>correctly. Since that's not the case I'm not sure i understand why
>ModPythonAppServer exists... it doesn't look like it enables any
>additional functionality. (aside from diddling the apache API)
>the import _apache failure still bugs me though (anyone on the mod_python
>front who can offer their wisdom?)

Most WebKit app server flavors run as separate Python processes launched 
from the command line:

python Launch.py ThreadedAppServer


But ModPythonAppServer is special: He lives *inside* Apache/mod_python. 
That also means he needs no adapter to shuttle requests and responses 
between himself and the web server.

Presumably this reduces the overhead of having the web and app server talk 
via TCP/IP for greater performance. However, you probably also get multiple 
child process versions of your app server which could easily confound your 
application logic at the very least. And the inability to restart the app 
server independently (as I mentioned earlier).

ModPythonAppServer is due to be moved to an Experimental/ subdirectory.


-Chuck


From jal at faxnet.com  Wed Jul 11 14:22:23 2001
From: jal at faxnet.com (Jonathan LaCour)
Date: Fri Jan  9 21:52:29 2004
Subject: [mod_python] SOAP Handler questions...
Message-ID: <994875744.20546.1.camel@dev7>

Hello,

I am a developer working at a small software company, and we are
researching using mod_python to help us in making a fast SOAP server.
All of the SOAP implementations that I can find use either the built in
Python HTTPServer (which is slow) or Medusa (which has other issues that
I would like to avoid).

Has someone out there developed a Handler for mod_python that would
allow me to easily provide SOAP web services?  If so, please let me know
where I can find the handler.  If not, I would consider developing this
myself.  I just don't want to re-invent the wheel here =)

Thanks in advance!  Also note that I am not subscribed to this list, so
please CC your resposes to me.

Jonathan LaCour



From rsalz at zolera.com  Wed Jul 11 15:12:01 2001
From: rsalz at zolera.com (Rich Salz)
Date: Fri Jan  9 21:52:29 2004
Subject: [mod_python] SOAP Handler questions...
References: <994875744.20546.1.camel@dev7>
Message-ID: <3B4CA501.5ED2429E@zolera.com>

> Has someone out there developed a Handler for mod_python that would
> allow me to easily provide SOAP web services?

ZSI, the Zolera Soap Infrastructure, can work this way -- that's how we
use it (and why we wrote it :).  I believe the ActZero SOAP.py
(pywebsvcs.sf.net) can also work under mod_python.  Both are open
source; ZSI will be released in a week or two
(www.zolera.com/resources/opensrc); documentation is avail at the
referenced link.
	/r$
-- 
Zolera Systems, Securing Web services (XML, SOAP, Signatures,
Encryption)
http://www.zolera.com

From jonas.b at home.se  Thu Jul 12 03:50:29 2001
From: jonas.b at home.se (Jonas Bengtsson)
Date: Fri Jan  9 21:52:29 2004
Subject: [mod_python] Problems getting mod_python up n' running
Message-ID: <NEBBLNLDOLDEJIKDPCBOCEBHCEAA.jonas.b@home.se>

Hi,
I can't get mod_python to work. I get this error message when I'm restarting
Apache:
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
And when I try to look at a .py page I get following error:
[Thu Jul 12 03:33:12 2001] [error] [client 127.0.0.1] python_handler:
make_obcallback returned no obCallBack!

What is wrong?
I've got: Apache/1.3.19 (Win32) mod_python/2.7.4 Python/2.1
Running under Windows 2000

I have put mod_python.dll.in E:\program\apache\modules and following rows to
httpd.conf:
#DSO section
LoadModule python_module e:/program/apache/modules/mod_python.dll
#under my main directory
    AddHandler python-program .py
    PythonHandler mptest
    PythonDebug on

Furthermore I have put following files under
e:\program\python21\libs\mod_python:
__init__.py
apache.py
cgihandler.py
httpdapi.py
publisher.py
util.py
zhandler.py

And my environment path contains:
E:\Program\Python21;e:\Program\Python21\libs


What can be the problem?

TIA
Jonas Bengtsson



From mhughe at ucalgary.ca  Wed Jul 11 22:41:49 2001
From: mhughe at ucalgary.ca (Matt Hughes)
Date: Fri Jan  9 21:52:29 2004
Subject: [mod_python] patch for default functions in the publisher handler (fwd)
Message-ID: <Pine.A41.4.10.10107112241270.125366-200000@acs4.acs.ucalgary.ca>

This is sort of a follow up to this message:
http://www.modpython.org/pipermail/mod_python/2001-June/001421.html, which
discussed how to call a default function from a file using the publisher
handler. 

I wanted similar functionality, but didn't want to resort to the redirect
directive suggested in the last message of that thread. This patch looks
for the PATH_INFO as before, but instead of raising an
apache.HTTP_NOT_FOUND, it puts "default" in func_path as the default
function to call. 

The default function could be made a configuration directive, but I
haven't investigated that. 

This patch also solves some problems I was having when importing modules
in sub-directories. I had a structure like this:

/
/subdir1
/subdir1/subdir2
/subdir1/subdir2/subdir3

and so on, with each directory containing a index.py file which is
configured as the index with the DirectoryIndex directive. The problem was
that a URL refering to /subdir1/subdir2/subdir3 or whatever always found
the index.py file in /. 

This patch fixes this by treating directories off the root as packages.
It's a compelete hack, but it works for me. 


//
// Matt Hughes
// http://www.ucalgary.ca/~mhughe
//

-------------- next part --------------
--- orig-pub.py	Mon Jul  9 20:43:40 2001
+++ publisher.py	Mon Jul  9 20:53:26 2001
@@ -65,6 +65,8 @@
 
 import new
 
+import sys
+
 # list of suffixes - .py, .pyc, etc.
 suffixes = map(lambda x: x[0], imp.get_suffixes())
 
@@ -81,10 +83,11 @@
 
     # get the path PATH_INFO (everthing after script)
     if not _req.subprocess_env.has_key("PATH_INFO"):
-        raise apache.SERVER_RETURN, apache.HTTP_NOT_FOUND
-    
-    func_path = _req.subprocess_env["PATH_INFO"][1:] # skip fist /
-    func_path = string.replace(func_path, "/", ".")
+        func_path = "default"  # Call for a default method
+    else:
+        func_path = _req.subprocess_env["PATH_INFO"][1:] # skip fist /
+        func_path = string.replace(func_path, "/", ".")
+        
     if func_path[-1] == ".":
         func_path = func_path[:-1] 
 
@@ -118,11 +121,19 @@
     # add req
     args["req"] = req
 
-    # import the script
-    path, module_name =  os.path.split(_req.filename)
+    l = len(sys.path[0])
+    module_name = _req.filename[l:]
 
-    # get rid of the suffix
+    # get rid of the suffix... 
     module_name = suff_matcher.sub("", module_name)
+
+    # An alternate way to get rid of the suffix
+    #pos = string.rfind(module_name, '.')
+    #module_name = module_name[:pos]      
+
+    module_name = string.replace(module_name, '/', '.')
+
+    path = _req.filename[0:l]
 
     # import module (or reload if needed)
     module = apache.import_module(module_name, _req, [path])
From Daryl.Johnson at RebusHR.com  Thu Jul 12 14:52:46 2001
From: Daryl.Johnson at RebusHR.com (Daryl.Johnson@RebusHR.com)
Date: Fri Jan  9 21:52:29 2004
Subject: [mod_python] Problems with apxs
Message-ID: <DDA89578AFB4D411AF4700B0D068618C0802BA@PSN004>

I have RedHat 6.2, Apache 1.3.20 and Python2.1.
I have downloaded mod_python-2.7.5.
I have compiled Apache with DSO support and compiled Python without thread
support.
I am unable to compile mod_python as a DSO.
apxs reports an error - rc=255.
I have re-arranged the parameters to apxs but only seem able to get two
responses from it.  It either displays its short help text or reports back
with - rc=255.  Any ideas?  I am at the end of my tether.

Thanks in advance
Daryl Johnson
(RebusHR)


From piet at cs.uu.nl  Thu Jul 12 23:26:32 2001
From: piet at cs.uu.nl (Piet van Oostrum)
Date: Fri Jan  9 21:52:29 2004
Subject: [mod_python] Problems getting mod_python up n' running
In-Reply-To: "Jonas Bengtsson"'s message of "Thu, 12 Jul 2001 03:50:29 +0200"
References: <NEBBLNLDOLDEJIKDPCBOCEBHCEAA.jonas.b@home.se>
Message-ID: <wz66cxrg8n.fsf@sunshine.cs.uu.nl>

>>>>> "Jonas Bengtsson" <jonas.b@home.se> (JB) writes:

JB> Furthermore I have put following files under
JB> e:\program\python21\libs\mod_python:

That should be in e:\program\python21\mod_python

JB> And my environment path contains:
JB> E:\Program\Python21;e:\Program\Python21\libs

You mean PATH? The last part is not necessary.

JB> What can be the problem?

See above.
-- 
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl

From jonas.b at home.se  Thu Jul 12 23:38:11 2001
From: jonas.b at home.se (Jonas Bengtsson)
Date: Fri Jan  9 21:52:29 2004
Subject: [mod_python] Problems getting mod_python up n' running
In-Reply-To: <wz66cxrg8n.fsf@sunshine.cs.uu.nl>
Message-ID: <NEBBLNLDOLDEJIKDPCBOAEBICEAA.jonas.b@home.se>

Thanks... now I got rid off the :
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.

But : [Thu Jul 12 23:30:34 2001] [error] [client 127.0.0.1] python_handler:
make_obcallback returned no obCallBack!
Still occurs... any ideas


/Jonas Bengtsson

-----Original Message-----
From: piet@cs.uu.nl [mailto:piet@cs.uu.nl]
Sent: Thursday, July 12, 2001 11:27 PM
To: Jonas Bengtsson
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Problems getting mod_python up n' running

>>>>> "Jonas Bengtsson" <jonas.b@home.se> (JB) writes:

JB> Furthermore I have put following files under
JB> e:\program\python21\libs\mod_python:

That should be in e:\program\python21\mod_python

JB> And my environment path contains:
JB> E:\Program\Python21;e:\Program\Python21\libs

You mean PATH? The last part is not necessary.

JB> What can be the problem?

See above.
--
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl


From Daryl.Johnson at RebusHR.com  Fri Jul 13 11:08:12 2001
From: Daryl.Johnson at RebusHR.com (Daryl.Johnson@RebusHR.com)
Date: Fri Jan  9 21:52:29 2004
Subject: [mod_python] Problems getting mod_python up n' running
Message-ID: <DDA89578AFB4D411AF4700B0D068618C0802BD@PSN004>

I was getting messages very similar to these right up until yesterday.
Although I'm using Linux and you are using Windows, I think the problem
might stem from the same thing.
Mine turned out to be a linker problem when mod_python.so (I think .dll in
your case) was being built.
The mod_python.so file was only half the size that it is now that it is
working.
It was about 700Kb and is now about 1.5Mb.  These sizes might be different
on Windows, but it is clear to me that mod_python.so had not linked in a
whole sack of libraries that it would need.
I hope this is of some help

Daryl Johnson.

-----Original Message-----
From: Jonas Bengtsson [mailto:jonas.b@home.se]
Sent: Thursday, July 12, 2001 10:38 PM
To: piet@cs.uu.nl
Cc: mod_python@modpython.org
Subject: RE: [mod_python] Problems getting mod_python up n' running


Thanks... now I got rid off the :
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.

But : [Thu Jul 12 23:30:34 2001] [error] [client 127.0.0.1] python_handler:
make_obcallback returned no obCallBack!
Still occurs... any ideas


/Jonas Bengtsson

-----Original Message-----
From: piet@cs.uu.nl [mailto:piet@cs.uu.nl]
Sent: Thursday, July 12, 2001 11:27 PM
To: Jonas Bengtsson
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Problems getting mod_python up n' running

>>>>> "Jonas Bengtsson" <jonas.b@home.se> (JB) writes:

JB> Furthermore I have put following files under
JB> e:\program\python21\libs\mod_python:

That should be in e:\program\python21\mod_python

JB> And my environment path contains:
JB> E:\Program\Python21;e:\Program\Python21\libs

You mean PATH? The last part is not necessary.

JB> What can be the problem?

See above.
--
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python

From grisha at modpython.org  Fri Jul 13 11:14:07 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:30 2004
Subject: [mod_python] Error: No such file or directory
In-Reply-To: <Pine.LNX.4.31.0107031247070.13943-100000@unity.copyleft.no>
Message-ID: <Pine.BSF.4.32.0107131113440.94495-100000@localhost>

I've added a FAQ entry on this one:

http://www.modpython.org/FAQ/faqw.py?req=all#2.3

Grisha

On Tue, 3 Jul 2001, Hr. Daniel Mikkelsen wrote:

> >> OSError: [Errno 2] No such file or directory: '/home/demo/cgi-bin/test.p'
>
> > Have a closer look at the filename.  I think this is a typo.
>
> I don't know if it's the same thing here, but I'm running FreeBSD, and
> mod_python erranously cuts the last character of filename of the handler
> I've given. I had to remove a [:-1] suffix a couple of places in apache.py
> (I think) to get it to work.
>
> I'll post more details if it's interesting to anyone.
>
> -- Daniel Mikkelsen, Copyleft Software AS
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From jonas.b at home.se  Fri Jul 13 19:33:57 2001
From: jonas.b at home.se (Jonas Bengtsson)
Date: Fri Jan  9 21:52:30 2004
Subject: [mod_python] Problems getting mod_python up n' running
In-Reply-To: <DDA89578AFB4D411AF4700B0D068618C0802BD@PSN004>
Message-ID: <NEBBLNLDOLDEJIKDPCBOGEBKCEAA.jonas.b@home.se>

I don't think that is the problem in my case. My mod_python.dll is about 45
kb and that seems normal

Does any one else have a clue? I'm about to look elsewhere for Python
support in Apache... mod_python seems to work very poorly under Windows.


Jonas Bengtsson

-----Original Message-----
From: Daryl.Johnson@RebusHR.com [mailto:Daryl.Johnson@RebusHR.com]
Sent: Friday, July 13, 2001 12:08 PM
To: jonas.b@home.se
Cc: mod_python@modpython.org
Subject: RE: [mod_python] Problems getting mod_python up n' running

I was getting messages very similar to these right up until yesterday.
Although I'm using Linux and you are using Windows, I think the problem
might stem from the same thing.
Mine turned out to be a linker problem when mod_python.so (I think .dll in
your case) was being built.
The mod_python.so file was only half the size that it is now that it is
working.
It was about 700Kb and is now about 1.5Mb.  These sizes might be different
on Windows, but it is clear to me that mod_python.so had not linked in a
whole sack of libraries that it would need.
I hope this is of some help

Daryl Johnson.

-----Original Message-----
From: Jonas Bengtsson [mailto:jonas.b@home.se]
Sent: Thursday, July 12, 2001 10:38 PM
To: piet@cs.uu.nl
Cc: mod_python@modpython.org
Subject: RE: [mod_python] Problems getting mod_python up n' running


Thanks... now I got rid off the :
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.

But : [Thu Jul 12 23:30:34 2001] [error] [client 127.0.0.1] python_handler:
make_obcallback returned no obCallBack!
Still occurs... any ideas


/Jonas Bengtsson

-----Original Message-----
From: piet@cs.uu.nl [mailto:piet@cs.uu.nl]
Sent: Thursday, July 12, 2001 11:27 PM
To: Jonas Bengtsson
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Problems getting mod_python up n' running

>>>>> "Jonas Bengtsson" <jonas.b@home.se> (JB) writes:

JB> Furthermore I have put following files under
JB> e:\program\python21\libs\mod_python:

That should be in e:\program\python21\mod_python

JB> And my environment path contains:
JB> E:\Program\Python21;e:\Program\Python21\libs

You mean PATH? The last part is not necessary.

JB> What can be the problem?

See above.
--
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python


From piet at cs.uu.nl  Fri Jul 13 21:48:40 2001
From: piet at cs.uu.nl (Piet van Oostrum)
Date: Fri Jan  9 21:52:30 2004
Subject: [mod_python] Problems getting mod_python up n' running
In-Reply-To: "Jonas Bengtsson"'s message of "Fri, 13 Jul 2001 19:33:57 +0200"
References: <NEBBLNLDOLDEJIKDPCBOGEBKCEAA.jonas.b@home.se>
Message-ID: <wz4rsgmwyv.fsf@sunshine.cs.uu.nl>

>>>>> "Jonas Bengtsson" <jonas.b@home.se> (JB) writes:

JB> I don't think that is the problem in my case. My mod_python.dll is about 45
JB> kb and that seems normal

JB> Does any one else have a clue? I'm about to look elsewhere for Python
JB> support in Apache... mod_python seems to work very poorly under Windows.

That is not true. However you must be careful to install it properly:
- use the correct version of the dll (corresponding to the python version)
- put the dll in the Apache module directory
- add the LoadModule clause to Apache's config file
- add the handler declaration to Apache's config
- put the .py files n the proper Python directory
-- 
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl

From jonas.b at home.se  Sat Jul 14 11:19:50 2001
From: jonas.b at home.se (Jonas Bengtsson)
Date: Fri Jan  9 21:52:30 2004
Subject: [mod_python] Problems getting mod_python up n' running
In-Reply-To: <wz4rsgmwyv.fsf@sunshine.cs.uu.nl>
Message-ID: <NEBBLNLDOLDEJIKDPCBOGEBLCEAA.jonas.b@home.se>

Ahh... Now I got it to work. It wasn't the environment PATH variable that I
should change but the PythonPath variable in the Registry.

Now I get the following error:
"""
Mod_python error: "PythonHandler mptest"

Traceback (most recent call last):

  File "e:\program\python21\mod_python\apache.py", line 181, in Dispatch
    module = import_module(module_name, _req)

  File "e:\program\python21\mod_python\apache.py", line 335, in
import_module
    f, p, d = imp.find_module(parts[i], path)

ImportError: No module named mptest
"""
But I have not looked into it to see why this occurs so I guess it is just
something trivial..

Thanks for all help!

/Jonas B

-----Original Message-----
From: piet@cs.uu.nl [mailto:piet@cs.uu.nl]
Sent: Friday, July 13, 2001 9:49 PM
To: Jonas Bengtsson
Cc: Daryl.Johnson@RebusHR.com; mod_python@modpython.org
Subject: Re: [mod_python] Problems getting mod_python up n' running

>>>>> "Jonas Bengtsson" <jonas.b@home.se> (JB) writes:

JB> I don't think that is the problem in my case. My mod_python.dll is about
45
JB> kb and that seems normal

JB> Does any one else have a clue? I'm about to look elsewhere for Python
JB> support in Apache... mod_python seems to work very poorly under Windows.

That is not true. However you must be careful to install it properly:
- use the correct version of the dll (corresponding to the python version)
- put the dll in the Apache module directory
- add the LoadModule clause to Apache's config file
- add the handler declaration to Apache's config
- put the .py files n the proper Python directory
--
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl


From piet at cs.uu.nl  Sun Jul 15 16:11:44 2001
From: piet at cs.uu.nl (Piet van Oostrum)
Date: Fri Jan  9 21:52:30 2004
Subject: [mod_python] Problems getting mod_python up n' running
In-Reply-To: "Jonas Bengtsson"'s message of "Sat, 14 Jul 2001 11:19:50 +0200"
References: <NEBBLNLDOLDEJIKDPCBOGEBLCEAA.jonas.b@home.se>
Message-ID: <wzsnfygu3j.fsf@sunshine.cs.uu.nl>

>>>>> "Jonas Bengtsson" <jonas.b@home.se> (JB) writes:

JB> Ahh... Now I got it to work. It wasn't the environment PATH variable that I
JB> should change but the PythonPath variable in the Registry.

In fact, if you put the files in the subdirectory mod_python of your main
Python directory, this is not necessary. Anyway, the libs directory is the
wrong one, because it is meant for .lib files (which you only need if you
compile python extensions).

JB> Now I get the following error:
JB> """
JB> Mod_python error: "PythonHandler mptest"

JB> Traceback (most recent call last):

JB>   File "e:\program\python21\mod_python\apache.py", line 181, in Dispatch
JB>     module = import_module(module_name, _req)

JB>   File "e:\program\python21\mod_python\apache.py", line 335, in
JB> import_module
JB>     f, p, d = imp.find_module(parts[i], path)

JB> ImportError: No module named mptest
JB> """
JB> But I have not looked into it to see why this occurs so I guess it is just
JB> something trivial..

It probably means that mptest.py is not in the directory that is mentioned
as the PythonHandler in your Apache config file. Maybe you gave it another
name. 
-- 
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl

From tree at basistech.com  Tue Jul 17 15:54:07 2001
From: tree at basistech.com (Tom Emerson)
Date: Fri Jan  9 21:52:30 2004
Subject: [mod_python] Import errors in 2.7.5
Message-ID: <15188.38879.991539.849967@cymru.basistech.com>

I'm repeatedly getting an error using mod_python 2.7.5, Python 2.0
with exceptions patch, Apache 1.3.19, on FreeBSD 4.2:

ue Jul 17 16:29:46 2001] [error] PythonHandler mod_python.publisher: Traceback (most recent call last):
[Tue Jul 17 16:29:46 2001] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.0/site-packages/mod_python/apache.py", line 193, in Dispatch
    result = object(req)
[Tue Jul 17 16:29:46 2001] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.0/site-packages/mod_python/publisher.py", line 128, in handler
    module = apache.import_module(module_name, _req, [path])
[Tue Jul 17 16:29:46 2001] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.0/site-packages/mod_python/apache.py", line 364, in import_module
    module = reload(module)
[Tue Jul 17 16:29:46 2001] [error] PythonHandler mod_python.publisher: ImportError: No module named add

I have to shutdown the server and start it back up to make this go
away, at which point things are fine for a while, then it comes
back. Suffice it to say this is annoying.

Before I start digging, has anyone else seen this? I never saw this in
2.7.1 (the previous version I had installed).

TIA,

    -tree

-- 
Tom Emerson                                          Basis Technology Corp.
Sr. Sinostringologist                              http://www.basistech.com
  "Beware the lollipop of mediocrity: lick it once and you suck forever"

From a_mayerson at yahoo.com  Tue Jul 17 20:12:05 2001
From: a_mayerson at yahoo.com (aaron mayerson)
Date: Fri Jan  9 21:52:30 2004
Subject: [mod_python] Function sequence error
Message-ID: <20010718031205.98105.qmail@web10906.mail.yahoo.com>

Greetings,

  I have a script that works from the command line but
not with mod_python and apache.  I've looked elsewhere
and found that this error relates to the odbc calls
being called out of order.
  I'm not exactly sure why the heck the calls would be
out of order when running through mod_python and
apache and not when run from the command line. 
Anybody have a clue as to why this is happening?
  Thanks for the help...

The error:

Mod_python error: "PythonHandler stats"

Traceback (most recent call last):

  File "d:\python21\lib\mod_python\apache.py", line
181, in Dispatch

  File "d:\python21\lib\mod_python\apache.py", line
364, in import_module

  File "c:/program files/apache
group/apache/htdocs/python/\stats.py", line 7, in ?
    db = mx.DriverConnect('DSN=stats')

InternalError: ('S1010', 0, '[Microsoft][ODBC Driver
Manager] Function sequence error', 5806)

The code:

import sping.PIL as pid
import mx.ODBC.Windows as mx
from os import chdir



db = mx.DriverConnect('DSN=stats')
cur = db.cursor()
cur.execute('select * from address_count')
values = cur.fetchall()
cur.close()
db.close()

hits = 0
for value in values:
    hits += value[1]

canvas = pid.PILCanvas(size=(600,
(len(values)*15)+15))
canvas.defaultLineWidth = 7.5
canvas.defaultLineColor = pid.red
y1 = 15
x1 = 100
y2 = 15
for value in values:
    x2 = 100 + (3000 * (float(value[1])/hits))
    canvas.drawLine(x1, y1, x2, y2)
    canvas.drawString(value[0], 5, (y1+2.5),
pid.Font(face="monospaced",size=10),
                      color=pid.black)
    canvas.drawString(str(value[1]), (x2+10),
(y1+2.5), pid.Font(face="monospaced",size=10),
                      color=pid.black)
    y1 += 15
    y2 += 15

canvas.flush()
chdir(r'c:\program files\apache
group\apache\htdocs\python')
canvas.save('hits', format='gif')

__________________________________________________
Do You Yahoo!?
Get personalized email addresses from Yahoo! Mail
http://personal.mail.yahoo.com/

From garyp at asti-usa.com  Wed Jul 18 16:10:51 2001
From: garyp at asti-usa.com (Gary Perez)
Date: Fri Jan  9 21:52:30 2004
Subject: [mod_python] Dispatch() returned nothing (?)
Message-ID: <3B55ED4A.63051A14@asti-usa.com>

Hi, all.

Looking forward to getting this working... either that or it's back to
Zope! ;)

Here's the installation info:
SuSE Linux 7.2, kernel 2.4.4, reiserfs
Apache 1.3.19 + Python 2.0 + mod_python 2.7.2

(Note: I attempted to install mod_python 2.7.5 from source, and that
completely hosed Apache, so I went back to the YAST2-based 2.7.2 installation.)

I'm stuck at the "2.4 Testing" section; Apache is throwing an internal
server error on attempt to load http://localhost/test/mptest.py . Here
are pieces of the relevant files:

ERROR LOG
[Wed Jul 18 15:58:02 2001] [notice] Apache/1.3.19 (Unix)  (SuSE/Linux)
mod_layout/1.0 mod_throttle/3.0 mod_fastcgi/2.2.2 mod_ssl/2.8.3
OpenSSL/0.9.6a PHP/4.0.4pl1 mod_perl/1.25 mod_dtcl mod_python/2.7.2
Python/2.0 configured -- resuming normal operations
[Wed Jul 18 15:58:02 2001] [notice] suEXEC mechanism enabled (wrapper: /usr/sbin/suexec)
[Wed Jul 18 15:58:18 2001] [error] [client 192.168.100.100]
python_handler: Dispatch() returned nothing.

HTTPD.CONF
<Directory "/usr/local/httpd/htdocs/test">
    AddHandler python-program .py
    PythonHandler mptest
    PythonDebug On
    AllowOverride All
</Directory>

.HTACCESS
AddHandler python-program .py
PythonHandler mptest
PythonDebug On

I also tried it without the "AllowOverride" line in httpd.conf and no
.htaccess file in the directory, but it throws the same error.

Any ideas as to what I'm doing wrong? Thanks in advance for your help!
-Gary

From mikael.johansson at sema.se  Thu Jul 19 13:52:10 2001
From: mikael.johansson at sema.se (Mikael Johansson)
Date: Fri Jan  9 21:52:30 2004
Subject: [mod_python] Compiling problem.
Message-ID: <01c201c11049$3e77f330$036716ac@got.sema.se>

Hello everyone.

I have a problem to include pyhton into my apache configuration.

I'm running HP-UX Ver 11.0

I have downloade apache 1.13.12

I have downloaded and installed Python 1.5.2 (configure, make and make install)

I have downloded mod_python 2.7.5 and have run configure, make and make install... 

No problem so fare... (not so many anyway..)

My problem is when I go back to Apache and run..

./configure --activate-module=src/modules/python/libpython.a

It runs whith no error, after that I try to the small command make, output below, any Ideas ? 

=== cut ==

<=== src/modules

cc -c -I./os/unix -I./include -DHPUX11 -Aa -Ae -D_HPUX_SOURCE -DUSE_HSREGEX -DUSE_EXPAT -I./lib/expat-lite -DNO_DL_NEEDEc

cc -c -I./os/unix -I./include -DHPUX11 -Aa -Ae -D_HPUX_SOURCE -DUSE_HSREGEX -DUSE_EXPAT -I./lib/expat-lite -DNO_DL_NEEDEc

cc -DHPUX11 -Aa -Ae -D_HPUX_SOURCE -DUSE_HSREGEX -DUSE_EXPAT -I./lib/expat-lite -DNO_DL_NEEDED `./apaci` \

-o httpd buildmark.o modules.o modules/python/libpython.a modules/standard/libstandard.a main/libmain.a ./os/unixd

/usr/ccs/bin/ld: Unsatisfied symbols:

PyObject_HasAttrString (code)

PyString_AsString (code)

PyModule_GetDict (code)

Py_OptimizeFlag (data)

PyThreadState_Delete (code)

PyExc_TypeError (data)

PySequence_Index (code)

PyDict_New (code)

PyCObject_AsVoidPtr (code)

PyImport_ImportModule (code)

PyCObject_FromVoidPtr (code)

_PyString_Resize (code)

PyErr_Fetch (code)

PyObject_Str (code)

PyList_Size (code)

PyString_ConcatAndDel (code)

PyDict_GetItem (code)

PyDict_SetItem (code)

Py_BuildValue (code)

PyEval_SaveThread (code)

PyCallable_Check (code)

PyObject_CallMethod (code)

PyExc_IndexError (data)

PyErr_NoMemory (code)

Py_FindMethod (code)

PyTuple_SetItem (code)

PyMember_Set (code)

PyDict_GetItemString (code)

PyMapping_HasKeyString (code)

PyErr_NewException (code)

PyList_New (code)

PyList_SetItem (code)

PyExc_AttributeError (data)

PyObject_CallFunction (code)

PyErr_Print (code)

PyInt_Type (data)

PyType_Type (data)

PyObject_GetAttrString (code)

PyThreadState_Swap (code)

PyErr_Occurred (code)

PyString_Type (data)

PyDict_SetItemString (code)

PyThreadState_New (code)

PyString_FromString (code)

PyMember_Get (code)

Py_Initialize (code)

PyInt_AsLong (code)

PyExc_ValueError (data)

PyEval_RestoreThread (code)

PyErr_BadArgument (code)

PyArg_ParseTuple (code)

Py_IsInitialized (code)

Py_NewInterpreter (code)

PyExc_KeyError (data)

PyExc_IOError (data)

PyList_Append (code)

PyString_FromStringAndSize (code)

Py_InitModule4 (code)

PyErr_SetObject (code)

PyList_SetSlice (code)

PyErr_Clear (code)

Py_Finalize (code)

_Py_NoneStruct (data)

PyErr_SetString (code)

Py_GetVersion (code)

PyInt_FromLong (code)

PyTuple_New (code)

*** Error exit code 1

Stop.

*** Error exit code 1

Stop.

*** Error exit code 1

Stop.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010719/390bb364/attachment-0001.htm
From markus.hillebrand at apis-group.net  Thu Jul 19 13:57:54 2001
From: markus.hillebrand at apis-group.net (markus.hillebrand@apis-group.net)
Date: Fri Jan  9 21:52:30 2004
Subject: [mod_python] mod_python + MySQLdb => does it work?
Message-ID: <XFMail.010719135754.markus.hillebrand@apis.intra>


 Hello to all you out there!

I tried to bring mod_python and MySQLdb together,
but I crashed on some problems.

First of all: mod_python runs quite fine.
Also MySQLdb runs quite well.

But when I try to import MySQLdb from a python-script
that was invoked by mod_python I get a

ImportError: _mysql: init failed 
(whole error message is in the attachement)

System: Linux 6.4(i386) - Kernel 2.2.14(4)
        apache 1.3.19
        Python 2.0
        mod_python 2.7.5
        MySQLdb 0.9.0

Has somebody out there a running system like this?
Would be very helpfull to bring mod_python and MySQLdb
together - or is there another solution to access
a MySQL database?

        Bye, Markus        

-- 
Markus Hillebrand, Dipl.Inf.(FH), Software-Engineer
Apis networks GmbH, Kronstadter Str. 11, 81677 Muenchen, Germany
Tel.: +49 (089) 357147-23 ; eMail: markus.hillebrand@apis-group.net
-------------- next part --------------
A non-text attachment was scrubbed...
Name: error.html
Type: application/octet-stream
Size: 639 bytes
Desc: error.html
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20010719/6957c32e/error-0001.obj
From tree at basistech.com  Thu Jul 19 07:37:26 2001
From: tree at basistech.com (Tom Emerson)
Date: Fri Jan  9 21:52:30 2004
Subject: [mod_python] mod_python + MySQLdb => does it work?
In-Reply-To: <XFMail.010719135754.markus.hillebrand@apis.intra>
References: <XFMail.010719135754.markus.hillebrand@apis.intra>
Message-ID: <15190.50806.775640.191120@cymru.basistech.com>

markus.hillebrand@apis-group.net writes:
> I tried to bring mod_python and MySQLdb together,
> but I crashed on some problems.

This works very well.

> First of all: mod_python runs quite fine.
> Also MySQLdb runs quite well.
> 
> But when I try to import MySQLdb from a python-script
> that was invoked by mod_python I get a
> 
> ImportError: _mysql: init failed 
> (whole error message is in the attachement)

Check your Python load path within mod_python, and make sure that the
directory containing the MySQLdb modules is there. Also make sure that
the MySQLdb shared object can be found in the library search path.


-- 
Tom Emerson                                          Basis Technology Corp.
Sr. Sinostringologist                              http://www.basistech.com
  "Beware the lollipop of mediocrity: lick it once and you suck forever"

From markus.hillebrand at apis-group.net  Thu Jul 19 14:47:07 2001
From: markus.hillebrand at apis-group.net (markus.hillebrand@apis-group.net)
Date: Fri Jan  9 21:52:30 2004
Subject: [mod_python] mod_python + MySQLdb => does it work?
In-Reply-To: <15190.50806.775640.191120@cymru.basistech.com>
Message-ID: <XFMail.010719144707.markus.hillebrand@apis.intra>

On 19-Jul-01 Tom Emerson wrote:
> markus.hillebrand@apis-group.net writes:
>> I tried to bring mod_python and MySQLdb together,
>> but I crashed on some problems.
> 
> This works very well.
Fine to hear that, so my tries are making sense ;)

>> First of all: mod_python runs quite fine.
>> Also MySQLdb runs quite well.
>> 
>> But when I try to import MySQLdb from a python-script
>> that was invoked by mod_python I get a
>> 
>> ImportError: _mysql: init failed 
>> (whole error message is in the attachement)
> 
> Check your Python load path within mod_python, and make sure that the
> directory containing the MySQLdb modules is there. Also make sure that
> the MySQLdb shared object can be found in the library search path.

I did this already and I created a script,
that I started with mod_python and I called

oRequest.write( str( imp.find_module("MySQLdb"))) 
  Result:(None,'/opt/<...>/site-packages/MySQLdb' , ('', '',5))

oRequest.write( str( imp.find_module("_mysql")))
  Result:(,'/opt/<...>/sitepackages/_mysql.so', ('.so', 'rb',3))

I think I have another problem. But which one?
Maybe my special configuration does not work,
may you tell me yours, Tom?

-- 
Markus Hillebrand, Dipl.Inf.(FH), Software-Engineer
Apis networks GmbH, Kronstadter Str. 11, 81677 Muenchen, Germany
Tel.: +49 (089) 357147-23 ; eMail: markus.hillebrand@apis-group.net

From tree at basistech.com  Thu Jul 19 08:51:34 2001
From: tree at basistech.com (Tom Emerson)
Date: Fri Jan  9 21:52:30 2004
Subject: [mod_python] mod_python + MySQLdb => does it work?
In-Reply-To: <XFMail.010719144707.markus.hillebrand@apis.intra>
References: <15190.50806.775640.191120@cymru.basistech.com>
	<XFMail.010719144707.markus.hillebrand@apis.intra>
Message-ID: <15190.55254.949564.915370@cymru.basistech.com>

markus.hillebrand@apis-group.net writes:
> I did this already and I created a script,
> that I started with mod_python and I called

I'm currently running the following setup:

FreeBSD 4.2-RELEASE, with recent security updates
Apache 1.3.19
  PHP/4.0.4pl1
  mod_python/2.7.5
  Python/2.0 (with patch for the exception problem)
MySQL 3.23.37
MySQLdb, 2000-11-30 release

Does your server errorlog or machine's messages log give any clues as
to why the failure is happening? Do you have more than one Python
installation on the machine? I had problems with this in the past.

Otherwise I'm stumped.

-- 
Tom Emerson                                          Basis Technology Corp.
Sr. Sinostringologist                              http://www.basistech.com
  "Beware the lollipop of mediocrity: lick it once and you suck forever"

From tree at basistech.com  Thu Jul 19 09:06:47 2001
From: tree at basistech.com (Tom Emerson)
Date: Fri Jan  9 21:52:30 2004
Subject: [mod_python] mod_python mailing list archive issue
Message-ID: <15190.56167.224323.751981@cymru.basistech.com>

The link to download the full raw archive of the mod_python mailing
list doesn't work for me: can anyone else get the whole lot of
messages?

-- 
Tom Emerson                                          Basis Technology Corp.
Sr. Sinostringologist                              http://www.basistech.com
  "Beware the lollipop of mediocrity: lick it once and you suck forever"

From tree at basistech.com  Thu Jul 19 09:16:14 2001
From: tree at basistech.com (Tom Emerson)
Date: Fri Jan  9 21:52:30 2004
Subject: [mod_python] More on import errors in 2.7.5
Message-ID: <15190.56734.977727.647366@cymru.basistech.com>

A couple of days ago I posted a question about strange import
behaviors with 2.7.5,

<http://www.modpython.org/pipermail/mod_python/2001-July/001519.html>

I haven't heard from anyone with a solution, though scanning the
archives it appears that this has been an issue for a while for some
people. So I started digging.

The short: the problem is still there.

The long:

- I reverted to 2.7.2 and the problem is still there. <sigh>

- I added some log_error() calls in various places in both publisher.py
  and apache.py to verify the state of the world upto the point
  apache.py attempts to reload the module. As far as I can tell,
  everything is valid up to the point of the reload call: sys.modules
  includes an entry for the module I'm reloading, the pathnames to the
  module are correct, everything looks fine, but reload() is throwing
  an ImportError.

  I observed that this problem usually happens in the following
  scenario:

  1) The module is loaded successfully.
  2) You make a modification to the module source which causes
     mod_python to reload the module. This works fine.
  3) You make another modification to the module that will cause an
     error when the module is being parsed when it is reloaded.
  4) You fix the error and reload.
  5) Bam, ImportError.

  Could it be the case that the module is partially initialized and
  isn't really reloadable?

Also, FWIW, the server doesn't have write access to the directory
containing these modules, so the .pyc files are not being created.

Food for thought.

    -tree

-- 
Tom Emerson                                          Basis Technology Corp.
Sr. Sinostringologist                              http://www.basistech.com
  "Beware the lollipop of mediocrity: lick it once and you suck forever"

From Alain.Tesio at actfs.fr  Thu Jul 19 16:02:50 2001
From: Alain.Tesio at actfs.fr (Alain.Tesio@actfs.fr)
Date: Fri Jan  9 21:52:30 2004
Subject: [mod_python] mod_python + MySQLdb => does it work
Message-ID: <OFA20499D4.3F551BBF-ONC1256A8E.004C5B52@actfs.fr>

Hi, it works for me on Linux Debian with Python 2.1, MySQLdb and mod_python
installed from source.

If it works when starting python from a shell, it means that the there is
something
missing in the environment of the user running apache.

Maybe try one of these commands to add this before "import MySQLdb" :

sys.path.append("/path/where/is/mysqldb")
os.environ["LD_LIBRARY_PATH"]="/path/to/the/shared/object"

Alain





______________________________________________________________________________


The views and opinions expressed in this email message are the sender's and
do not necessarily represent the views and opinions of ACT Financial
Systems S.A.
______________________________________________________________________________




From markus.hillebrand at apis-group.net  Thu Jul 19 18:50:32 2001
From: markus.hillebrand at apis-group.net (markus.hillebrand@apis-group.net)
Date: Fri Jan  9 21:52:30 2004
Subject: [mod_python] mod_python + MySQLdb => does it work? YES!
In-Reply-To: <XFMail.010719135754.markus.hillebrand@apis.intra>
Message-ID: <XFMail.010719185032.markus.hillebrand@apis.intra>

On 19-Jul-01 markus.hillebrand@apis-group.net wrote:
> 
>  Hello to all you out there!
> 
> I tried to bring mod_python and MySQLdb together,
> but I crashed on some problems.

Okay, after playing around with all these
pathes and settings ... I recompiled 
the python-component v2.1.1c1 --without-threads
And what shall I say. Now it works fine.
I'm quite happy now (until the next problem occurs).

Thanx to all of you.
-- 
Markus Hillebrand, Dipl.Inf.(FH), Software-Engineer
Apis networks GmbH, Kronstadter Str. 11, 81677 Muenchen, Germany
Tel.: +49 (089) 357147-23 ; eMail: markus.hillebrand@apis-group.net

From mikael.johansson at sema.se  Fri Jul 20 09:38:56 2001
From: mikael.johansson at sema.se (Mikael Johansson)
Date: Fri Jan  9 21:52:30 2004
Subject: [mod_python] (no subject)
Message-ID: <003601c110ef$08b93c30$036716ac@got.sema.se>

Any Ideas for my installation problem ?   

HPUX 11.0, Pyhton 1.5., Mod_Pyhton 2.7.5

/MiJo/

================cut=========================



root@gotuh03> ./configure --with-apxs=/opt/apache/bin/apxs

loading cache ./config.cache

checking for gcc... no

checking for cc... cc

checking whether the C compiler (cc ) works... yes

checking whether the C compiler (cc ) is a cross-compiler... no

checking whether we are using GNU C... no

checking whether cc accepts -g... yes

checking for ranlib... ranlib

checking for ar... ar

checking for a BSD compatible install... /opt/imake/bin/install -c

checking whether make sets ${MAKE}... yes

checking for main in -lm... yes

checking for working const... yes

checking your blood pressure... a bit high, but we can proceed

checking whether apxs is available

checking for --with-apxs... /opt/apache/bin/apxs executable, good

checking for Apache libexec directory... /opt/apache/libexec

checking for Apache include directory... -I/opt/apache/include

checking for --with-apache... no

configure: warning: **** No apache sources specified, static compilation will not be available.

configure: warning: **** You can use --with-apache to specify where your Apache sources are.

checking for --with-python... no

checking for python... /usr/local/bin/python

checking Python version... 1.5

checking whether Python is compiled with thread support... no threads, good

checking Python install prefix... /usr/local

checking what libraries Python was linked with... /usr/local/lib/python1.5/config/libpython1.5.a -lnet -lnsl -ldld -lm 

checking linker flags used to link Python... 

checking where Python include files are... -I/usr/local/include/python1.5

checking for mkdep... no

checking for makedepend... /opt/imake/bin/makedepend

updating cache ./config.cache

creating ./config.status

creating Makefile

creating src/Makefile

creating src/libpython.module

creating Doc/Makefile

analyzing dependencies





root@gotuh03> make dso

Compiling for DSO. For static, do "make static"

/opt/apache/bin/apxs -I/opt/install/mod_python-2.7.5/src/include -I/opt/apache/include -I/usr/local/include/python1.5 -c mo 

ld -b -o mod_python.so mod_python.o _apachemodule.o requestobject.o tableobject.o util.o serverobject.o connobject.o -lm /usr/local 

ld: Invalid loader fixup in text space needed in output file for symbol "$000000B1" in input file "/usr/local/lib/python1.5/config/"

apxs:Break: Command failed with rc=65536

*** Error exit code 1

Stop.

*** Error exit code 1

Stop.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010720/6b0783f9/attachment-0001.htm
From polygnwnd at yahoo.com  Tue Jul 24 20:20:06 2001
From: polygnwnd at yahoo.com (polygnwnd)
Date: Fri Jan  9 21:52:30 2004
Subject: [mod_python] example test fails-- how to convince apache to search the correct path for python modules?
Message-ID: <20010725032006.88880.qmail@web12507.mail.yahoo.com>

Well, I am interested in mod_python, but am having a
hard time getting it to work. I notice
that my specific problem has come up on both Windows
and Linux and I cannot find a working
solution in the mail archives (maybe I overlooked
something?). 

What I "know"...

Platform: Linux 2.4 kernel, atop old, but vanilla
Debian

All packages used here are installed below
/home/polygnwnd/httpd:
  Python: python/2.0.1/(bin, lib, etc.)
  Apache: apache/1.3.20/(bin,libexec, etc.)

Configured options:
  Python: --without-threads
  Apache: --enable-module=rewrite
--enable-shared=rewrite
  mod_python:
--with-apxs=/home/polygnwnd/httpd/apache/1.3.20/bin/apxs
\
             
--with-python=/home/polygnwnd/src/httpd/python/2.0.1
              # I pointed with-python to the python
src build dir, makes configure happy

An strace on the httpd process reveals many
unsuccessful attempts to access
the system python library. The result:

  stat("/usr/lib/python2.0/mod_python", 0xbfffeaec) =
-1 ENOENT (No such file or directory)
  open("/usr/lib/python2.0/mod_python.so", O_RDONLY) =
-1 ENOENT (No such file or directory)
  open("/usr/lib/python2.0/mod_pythonmodule.so",
O_RDONLY) = -1 ENOENT (No such file or directory)
  open("/usr/lib/python2.0/mod_python.py", O_RDONLY) =
-1 ENOENT (No such file or directory)
  open("/usr/lib/python2.0/mod_python.pyc", O_RDONLY)
= -1 ENOENT (No such file or directory)
  stat("/usr/lib/python2.0/plat-linux2/mod_python",
0xbfffeaec) = -1 ENOENT (No such file or directory)
  open("/usr/lib/python2.0/plat-linux2/mod_python.so",
O_RDONLY) = -1 ENOENT (No such file or directory)
 
open("/usr/lib/python2.0/plat-linux2/mod_pythonmodule.so",
O_RDONLY) = -1 ENOENT (No such file or directory)
  open("/usr/lib/python2.0/plat-linux2/mod_python.py",
O_RDONLY) = -1 ENOENT (No such file or directory)
 
open("/usr/lib/python2.0/plat-linux2/mod_python.pyc",
O_RDONLY) = -1 ENOENT (No such file or directory)
  stat("/usr/lib/python2.0/lib-tk/mod_python",
0xbfffeaec) = -1 ENOENT (No such file or directory)
  stat("/usr/lib/python2.0/site-packages/mod_python",
0xbfffeaec) = -1 ENOENT (No such file or directory)
 
open("/usr/lib/python2.0/site-packages/mod_python.so",
O_RDONLY) = -1 ENOENT (No such file or directory)
 
open("/usr/lib/python2.0/site-packages/mod_pythonmodule.so",
O_RDONLY) = -1 ENOENT (No such file or directory)
 
open("/usr/lib/python2.0/site-packages/mod_python.py",
O_RDONLY) = -1 ENOENT (No such file or directory)
 
open("/usr/lib/python2.0/site-packages/mod_python.pyc",
O_RDONLY) = -1 ENOENT (Nosuch file or directory)
  write(2, "make_obcallback(): could not imp"..., 55)
= 55
  write(2, "make_obcallback(): could not cal"..., 40)
= 40
  time(NULL)                              = 996027790
  write(15, "[Wed Jul 25 03:23:10 2001] [erro"...,
115) = 115
  alarm(300)                              = 0
  alarm(0)                                = 300
  alarm(300)                              = 0
  alarm(0)                                = 300
  alarm(300)                              = 0
  alarm(0)                                = 300
  write(4, "HTTP/1.1 500 Internal Server Err"..., 843)
= 843

This is odd because my system python version is 1.5
and I have a special version in a private 
directory which I specified (as above) at compile
time.

grepping apache (incl. mod_python.so) and python
binaries for "/usr/lib" did not reveal anything of
immediate
interest. Recompiling with python 2.1 renders
essentially the same result (substitude "2.1" for
"2.0" in the
trace output).

The problem is obviously something like the PYTHONPATH
not being set properly. 

  -Setting the PythonPath (as was suggested in a prior
exchange) seems ineffective-- strace behaviour was not

   changed (in fact specifying an arbitrary string set
for the PythonPath directive did not appear in trace
output).
  
  -setting the PYTHONPATH variable in the shell before
starting httpd had no effect

  -using the specially compiled python shell to try
"from mod_python import apache" failed when it could
   not find the "_apache" module, leading me to
believe it did find the mod_python module. I did this
   experiment using the same permissions as httpd, and
have tried experimentally running httpd with my own 
   permissions without success.

The mod_python.so file is 2.7MB with python 2.0 and
1.5MB with 2.1, leading me to believe it is being
linked
properly-- I have scrutinized the build process for
errors and not seen anything interesting. Thus I find
myself
among the ranks of unhappy people looking at:

  [Wed Jul 25 04:03:20 2001] [info] Server built: Jul
25 2001 00:55:54
  make_obcallback(): could not import
mod_python.apache.
  make_obcallback(): could not call init.
  [Wed Jul 25 04:03:22 2001] [error] [client
192.168.0.0.2] python_handler: make_ob
  callback returned no obCallBack!

I look forward to being able to move out of
AOLserver-land (filters and threading are coming to
Apache. yay). 
Any clues?

cheers,
jamie



__________________________________________________
Do You Yahoo!?
Make international calls for as low as $.04/minute with Yahoo! Messenger
http://phonecard.yahoo.com/

From piet at cs.uu.nl  Wed Jul 25 11:09:47 2001
From: piet at cs.uu.nl (piet@cs.uu.nl)
Date: Fri Jan  9 21:52:30 2004
Subject: [mod_python] example test fails-- how to convince apache to search the correct path for python modules?
In-Reply-To: polygnwnd's message of "Tue, 24 Jul 2001 20:20:06 -0700 (PDT)"
References: <20010725032006.88880.qmail@web12507.mail.yahoo.com>
Message-ID: <uy9pd2x44.fsf@cs.uu.nl>

Can you start up an interactive session with your private python
interpreter and type the following:

import sys
print sys.path

I guess it will have /usr/lib/python2.0 in it.
If that is so, the this is where your python expects its modules.
-- 
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl


From riesch at nieuw.nl  Thu Jul 26 16:26:59 2001
From: riesch at nieuw.nl (riesch@nieuw.nl)
Date: Fri Jan  9 21:52:30 2004
Subject: [mod_python] Cookies
Message-ID: <20010726162659.A8236@godel>

Hi there,

I'm currently making a web-site with mod-python and since I want to make use of cookies, I was wondering how I can set a cookie.
I've been looking through the documentation provided on the web-site, but I'm not able to find something. So if anyone could give me pointer, or even better comething that works, I'd be much obliged.


Thanks ahead,
Richard

From bl at netgroup.dk  Thu Jul 26 16:54:26 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:52:30 2004
Subject: [mod_python] Cookies
References: <20010726162659.A8236@godel>
Message-ID: <3B602F22.17C6C7B8@netgroup.dk>

riesch@nieuw.nl wrote:

> I'm currently making a web-site with mod-python and since I want to make use of cookies, I was wondering how I can set a cookie.
> I've been looking through the documentation provided on the web-site, but I'm not able to find something. So if anyone could give me pointer, or even better comething that works, I'd be much obliged.

You find them in the header fields (headers_in / headers_out ) in the Request class.

If you like to set a cookie you do something like this :

    req.headers_out[ "Set-Cookie" ] = "my_session_id=42"

and the next time this user sends back a request back to you ( and if he support it) it will contain it in your input headers, and you will be able to fetch it like this :

    raw_cookie = req.headers_in[ "Cookie" ]

Now you only need to parse the input cookie string (raw_cookie), that have the syntax as descried in RFC-2109.

mod_python does not have any helper classes for either in- or outgoing cookies, but the format is strait forward, even I could make one :-)

Hope this helped

Regards

/BL


From CHagner at fool.com  Thu Jul 26 11:11:54 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:52:30 2004
Subject: [mod_python] Cookies
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E48053@rover.foolhq.com>

There's a module called Cookie which provides an Dictionary-like interface
to access the multiple cookies in a request.  In addition, each cookie class
has an output method that returns an HTTP-header-friendly string
("Set-Cookie: fig=newton").  The doc strings in Cookie.py give some pretty
good code examples.

In this module, a 'raw' cookie is called a morsel, so the terminology could
be a little confusing.

One warning though.  The Cookie module is only designed to handle a single
value for each cookie (i.e. "Set-Cookie: MyCookie=MyValue") .  Thus, if you
use a cookie to store more than one value (i.e. "Set-Cookie:
MyCookie=key1=value=&key2=value2&key3=value3"), you'll need to wrap Cookie
with your own class to handle the 'internal' values (or just build/parse the
value string yourself each time).

Chris

-----Original Message-----
From: Bo Lorentsen [mailto:bl@netgroup.dk]
Sent: Thursday, July 26, 2001 10:54 AM
To: riesch@nieuw.nl
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Cookies


riesch@nieuw.nl wrote:

> I'm currently making a web-site with mod-python and since I want to make
use of cookies, I was wondering how I can set a cookie.
> I've been looking through the documentation provided on the web-site, but
I'm not able to find something. So if anyone could give me pointer, or even
better comething that works, I'd be much obliged.

You find them in the header fields (headers_in / headers_out ) in the
Request class.

If you like to set a cookie you do something like this :

    req.headers_out[ "Set-Cookie" ] = "my_session_id=42"

and the next time this user sends back a request back to you ( and if he
support it) it will contain it in your input headers, and you will be able
to fetch it like this :

    raw_cookie = req.headers_in[ "Cookie" ]

Now you only need to parse the input cookie string (raw_cookie), that have
the syntax as descried in RFC-2109.

mod_python does not have any helper classes for either in- or outgoing
cookies, but the format is strait forward, even I could make one :-)

Hope this helped

Regards

/BL

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python

From garyp at asti-usa.com  Thu Jul 26 12:32:01 2001
From: garyp at asti-usa.com (Gary Perez)
Date: Fri Jan  9 21:52:30 2004
Subject: [mod_python] Try 2: python_handler: Dispatch() returned nothing
Message-ID: <3B604602.C7BC25E0@asti-usa.com>

Hi, all.

I've reinstalled apache, reinstalled Python (no threads), reinstalled
mod_python in hopes to clear this up. No dice. Does anyone have any suggestions?

Here's the dirt:
SuSE Linux 7.2, kernel 2.4.4, reiserfs
Apache 1.3.19 + Python 2.0 + mod_python 2.7.2

HTTPD.CONF
<Directory "/usr/local/httpd/htdocs/test">
    AddHandler python-program .py
    PythonHandler mptest
    PythonDebug On
</Directory>

The mptest.py module in "test" is the standard one from the
documentation (verified, no typos).

When I hit the URL (localhost/test/mptest.py) I get an internal server error:

ERROR LOG
[Wed Jul 18 15:58:02 2001] [notice] Apache/1.3.19 (Unix)  (SuSE/Linux)
mod_layout/1.0 mod_throttle/3.0 mod_fastcgi/2.2.2 mod_ssl/2.8.3
OpenSSL/0.9.6a PHP/4.0.4pl1 mod_perl/1.25 mod_dtcl mod_python/2.7.2
Python/2.0 configured -- resuming normal operations
[Wed Jul 18 15:58:02 2001] [notice] suEXEC mechanism enabled (wrapper: /usr/sbin/suexec)
[Wed Jul 18 15:58:18 2001] [error] [client 192.168.100.100]
python_handler: Dispatch() returned nothing.

Thanks in advance for your help.
-Gary

From jpareja at ntsp.nec.co.jp  Fri Jul 27 19:48:57 2001
From: jpareja at ntsp.nec.co.jp (Joel)
Date: Fri Jan  9 21:52:30 2004
Subject: [mod_python] Apache 2.x support
References: <200107261602.f6QG24G65883@eden.ispol.com>
Message-ID: <3B615529.2060207@ntsp.nec.co.jp>

Hello all,

       I am just starting to install mod_python. But the manual says 2.0 
not yet supported.
Is there a target date for a release that supports Apache 2.x.


Thank you.


From bl at netgroup.dk  Fri Jul 27 11:04:14 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:52:30 2004
Subject: [mod_python] Cookies
References: <13CDDE6A53DBD311BC3200508B6F0C4805E48053@rover.foolhq.com>
Message-ID: <3B612E8E.2BB63B3F@netgroup.dk>

Chris Hagner wrote:

> There's a module called Cookie which provides an Dictionary-like interface
> to access the multiple cookies in a request.  In addition, each cookie class
> has an output method that returns an HTTP-header-friendly string
> ("Set-Cookie: fig=newton").  The doc strings in Cookie.py give some pretty
> good code examples.

Ups sorry, I have only looked into the manual, maby its time to take a trip
into the mod_python code :-)

/BL


From CHagner at fool.com  Fri Jul 27 07:40:36 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:52:30 2004
Subject: [mod_python] Cookies
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E48060@rover.foolhq.com>

Cookie is a module within Python (not mod_python).  Is that what you mean?

http://www.python.org/doc/2.1.1/lib/module-Cookie.html

Chris

-----Original Message-----
From: Bo Lorentsen [mailto:bl@netgroup.dk]
Sent: Friday, July 27, 2001 5:04 AM
To: Chris Hagner
Cc: riesch@nieuw.nl; mod_python@modpython.org
Subject: Re: [mod_python] Cookies


Chris Hagner wrote:

> There's a module called Cookie which provides an Dictionary-like interface
> to access the multiple cookies in a request.  In addition, each cookie
class
> has an output method that returns an HTTP-header-friendly string
> ("Set-Cookie: fig=newton").  The doc strings in Cookie.py give some pretty
> good code examples.

Ups sorry, I have only looked into the manual, maby its time to take a trip
into the mod_python code :-)

/BL

From bl at netgroup.dk  Fri Jul 27 13:59:51 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:52:30 2004
Subject: [mod_python] usign the apache log ?
Message-ID: <3B6157B7.F05239DB@netgroup.dk>

Hi ...

I have been writing a system using this mod_python module, and it just
work out fine for me. Its really a nice Python tool, keep up the good
work. But (there is always a but :-)) I really like to be able to se
more about what is going in inside my code, and I therefor looked for a
way to write to the apache log file, but found nothing in mod_python.

In the O'reilly book "Writing Apache modules with Perl and C" they have
an example where they got a logger out of the Request class (or whatever
they call it i Perl :-)). This don't seem to be the case in mod_python,
and the only reference I could find to logging is the PythonLogHandler,
and that don't sound like anything I could use.

Is there something i have misunderstood, or is there a way do redirect
stdout/err to the log or something fancy like that ?

Thanks in advance !

/BL


From bl at netgroup.dk  Fri Jul 27 14:08:01 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:52:30 2004
Subject: [mod_python] Cookies
References: <13CDDE6A53DBD311BC3200508B6F0C4805E48060@rover.foolhq.com>
Message-ID: <3B6159A1.40AB4F73@netgroup.dk>

Chris Hagner wrote:

> Cookie is a module within Python (not mod_python).  Is that what you mean?

Ahh, I hav'nt seen it in the python lib. as I'm using a quite old Python
(1.5.2), to prevent to much update fun in the production env. ( we use
Debian/potato on the servers :-))

So much for code reuse :-)

Thanks anyway, yet a stone on the road to be a Python expert :-)

/BL


From CHagner at fool.com  Fri Jul 27 08:20:07 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:52:31 2004
Subject: [mod_python] Cookies
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E48061@rover.foolhq.com>

Fortunately, the Cookie module was actually developed completely independent
of the main Python distribution.  Thus, you should be able to find a copy of
Cookie.py and simply use that with Python 1.5.2.  This is what WebWare does
(or used to... not sure if they nixed their Cookie.py when it became a
standard Python module).  It's a pretty straight-forward module, so I
wouldn't be shocked if Cookie.py from a 2.0 distro works in 1.5.2.

Chris

-----Original Message-----
From: Bo Lorentsen [mailto:bl@netgroup.dk]
Sent: Friday, July 27, 2001 8:08 AM
To: Chris Hagner
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Cookies


Chris Hagner wrote:

> Cookie is a module within Python (not mod_python).  Is that what you mean?

Ahh, I hav'nt seen it in the python lib. as I'm using a quite old Python
(1.5.2), to prevent to much update fun in the production env. ( we use
Debian/potato on the servers :-))

So much for code reuse :-)

Thanks anyway, yet a stone on the road to be a Python expert :-)

/BL

From bl at netgroup.dk  Fri Jul 27 14:34:39 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:52:31 2004
Subject: [mod_python] Cookies
References: <13CDDE6A53DBD311BC3200508B6F0C4805E48061@rover.foolhq.com>
Message-ID: <3B615FDF.D0BED081@netgroup.dk>

Chris Hagner wrote:

> Fortunately, the Cookie module was actually developed completely independent
> of the main Python distribution.  Thus, you should be able to find a copy of
> Cookie.py and simply use that with Python 1.5.2.  This is what WebWare does
> (or used to... not sure if they nixed their Cookie.py when it became a
> standard Python module).  It's a pretty straight-forward module, so I
> wouldn't be shocked if Cookie.py from a 2.0 distro works in 1.5.2.

Look what I found ! Hope others may have good use of this too.

    http://starship.python.net/crew/jrush/Webbot

Thanks for the advise, I think I just will include this in my code, and be more
careful to search python.org before writing another parser :-)

/BL


From CHagner at fool.com  Fri Jul 27 08:45:16 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:52:31 2004
Subject: [mod_python] Cookies
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E48063@rover.foolhq.com>

Bo,

I would recommend that you instead go with the actual Cookie.py file that
has made it into the main Python distribution.  I started using it before it
was included (since it was a part of WebWare's libs) and was pleasantly
surprised when I found a Cookie.py in the 2.0 distro.  I was even more
surprised when I saw that the file was identical to the one that I had been
using. :)  Good karma I guess.

Chris

-----Original Message-----
From: Bo Lorentsen [mailto:bl@netgroup.dk]
Sent: Friday, July 27, 2001 8:35 AM
To: Chris Hagner
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Cookies


Chris Hagner wrote:

> Fortunately, the Cookie module was actually developed completely
independent
> of the main Python distribution.  Thus, you should be able to find a copy
of
> Cookie.py and simply use that with Python 1.5.2.  This is what WebWare
does
> (or used to... not sure if they nixed their Cookie.py when it became a
> standard Python module).  It's a pretty straight-forward module, so I
> wouldn't be shocked if Cookie.py from a 2.0 distro works in 1.5.2.

Look what I found ! Hope others may have good use of this too.

    http://starship.python.net/crew/jrush/Webbot

Thanks for the advise, I think I just will include this in my code, and be
more
careful to search python.org before writing another parser :-)

/BL

From miguel at yorku.ca  Fri Jul 27 08:54:41 2001
From: miguel at yorku.ca (Miguel Marques)
Date: Fri Jan  9 21:52:31 2004
Subject: [mod_python] usign the apache log ?
In-Reply-To: <3B6157B7.F05239DB@netgroup.dk>
References: <3B6157B7.F05239DB@netgroup.dk>
Message-ID: <20010727085441P.miguel@yorku.ca>

Greetings...
On Fri, 27 Jul 2001 13:59:51 +0200, Bo Lorentsen <bl@netgroup.dk> wrote:
> Hi ...
> 
> I have been writing a system using this mod_python module, and it just
> work out fine for me. Its really a nice Python tool, keep up the good
> work. But (there is always a but :-)) I really like to be able to se
> more about what is going in inside my code, and I therefor looked for a
> way to write to the apache log file, but found nothing in mod_python.
> 
> In the O'reilly book "Writing Apache modules with Perl and C" they have
> an example where they got a logger out of the Request class (or whatever
> they call it i Perl :-)). This don't seem to be the case in mod_python,
> and the only reference I could find to logging is the PythonLogHandler,
> and that don't sound like anything I could use.
> 
> Is there something i have misunderstood, or is there a way do redirect
> stdout/err to the log or something fancy like that ?
> 
> Thanks in advance !

4.3 apache - Access to Apache Internals.
http://www.modpython.org/live/mod_python-2.7.5/doc-html/module-apache.html

Specifically: log_error(message[, level, server])

							Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830

From bl at netgroup.dk  Fri Jul 27 15:02:14 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:52:31 2004
Subject: [mod_python] usign the apache log ?
References: <3B6157B7.F05239DB@netgroup.dk> <20010727085441P.miguel@yorku.ca>
Message-ID: <3B616656.A572E8F3@netgroup.dk>

Miguel Marques wrote:

> 4.3 apache - Access to Apache Internals.
> http://www.modpython.org/live/mod_python-2.7.5/doc-html/module-apache.html
>
> Specifically: log_error(message[, level, server])

Thanks, I guess I just was looking in the wrong direction.

/BL


From riesch at nieuw.nl  Fri Jul 27 15:15:58 2001
From: riesch at nieuw.nl (riesch@nieuw.nl)
Date: Fri Jan  9 21:52:31 2004
Subject: [mod_python] usign the apache log ?
In-Reply-To: <3B6157B7.F05239DB@netgroup.dk>; from bl@netgroup.dk on Fri, Jul 27, 2001 at 01:59:51PM +0200
References: <3B6157B7.F05239DB@netgroup.dk>
Message-ID: <20010727151558.B20191@godel>

hi there,


what you can do is write your own log-class. I've done something like this:


class Log:
   def __init__(self, file, mode):
      if __debug__:
         delf.__descriptor = open(file, mode)
   
   def __del__(self):
      self.close()

   def append(self, string):
      self.__descriptor.write(string + "\n\n")
      # add some more information if you please

   def close(self):
      self.__descriptor.close()


   # Variables
   __descriptor = []
#

global log
log = Log("log.txt")


When you import this module, the log-instance will be known and be the same for every file that imports this module (the global takes care of this) and every write (wherever) happens in the same file.
To write stuff:

import from Log *

log.append("something happened")


I hope this helps,
Richard

      


On Fri, Jul 27, 2001 at 01:59:51PM +0200, Bo Lorentsen wrote:
> Hi ...
> 
> I have been writing a system using this mod_python module, and it just
> work out fine for me. Its really a nice Python tool, keep up the good
> work. But (there is always a but :-)) I really like to be able to se
> more about what is going in inside my code, and I therefor looked for a
> way to write to the apache log file, but found nothing in mod_python.
> 
> In the O'reilly book "Writing Apache modules with Perl and C" they have
> an example where they got a logger out of the Request class (or whatever
> they call it i Perl :-)). This don't seem to be the case in mod_python,
> and the only reference I could find to logging is the PythonLogHandler,
> and that don't sound like anything I could use.
> 
> Is there something i have misunderstood, or is there a way do redirect
> stdout/err to the log or something fancy like that ?
> 
> Thanks in advance !
> 
> /BL
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

From rsalz at zolera.com  Fri Jul 27 09:53:12 2001
From: rsalz at zolera.com (Rich Salz)
Date: Fri Jan  9 21:52:31 2004
Subject: [mod_python] usign the apache log ?
References: <3B6157B7.F05239DB@netgroup.dk> <20010727151558.B20191@godel>
Message-ID: <3B617248.1F8AC4BF@zolera.com>

In mod_python sys.stderr is attached to the apache error log.
There is also a log_error method in the apache module (not sure what
version added it); see the docs -- it's like the ap_log_error()
function.

-- 
Zolera Systems, Your Key to Online Integrity
Securing Web services: XML, SOAP, Dig-sig, Encryption
http://www.zolera.com

From riesch at nieuw.nl  Mon Jul 30 13:55:00 2001
From: riesch at nieuw.nl (riesch@nieuw.nl)
Date: Fri Jan  9 21:52:31 2004
Subject: [mod_python] standard path
Message-ID: <20010730135500.A8125@godel>

Hi there,


I'm wondering. I now have setup for my apacha-server (httpd.conf) similar to the following:

<directory />
   SetHandler python-program
   PythonHandler main
   PythonDebug On
</directory>


The file with the mod-python handler (aka the entrance) now has to be placed in a standard path, which can be located by the python-interpreter. Now it isn't very attractive for me to use these paths. Is there a way around this. I've been trying something like:

PythonPath /home/user/site/

but this generated errors.

Any hints ?


Richard.

From riesch at nieuw.nl  Mon Jul 30 14:33:30 2001
From: riesch at nieuw.nl (riesch@nieuw.nl)
Date: Fri Jan  9 21:52:31 2004
Subject: [mod_python] standard path
In-Reply-To: <20010730135500.A8125@godel>; from riesch@nieuw.nl on Mon, Jul 30, 2001 at 01:55:00PM +0200
References: <20010730135500.A8125@godel>
Message-ID: <20010730143330.B8125@godel>

Sorry all,


I've already found the error of my ways :)
It should have been:


PythonPath "sys.path + ['/home/mysite/']"

I found it in the mod-python manual


Thanx again,
Richard

From bl at netgroup.dk  Tue Jul 31 10:19:06 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:52:31 2004
Subject: [mod_python] Internal_redirect ?
Message-ID: <3B6669FA.A18D4564@netgroup.dk>

Hi ...

I have been working on a larger site setup where I like to force a
redirection to a internal login page if user is unknown (cookie thing).

The only way of redirection I can find is the one described in the
mod_python FAQ, but this often gives a small annoying page telling the
user about a redirection, but what I want is to do it seamless to the
browser.

Now in the Apache doc, I found some info. about a function calls
"internal_redirect", that does exactly what I like to do, but its not
part of the mod_python API, or I cant find it, at least :-)

Have anyone a good hint for me at this point ?

Also, is it correct that its not possible to set a cookie together with
a redirect ?

Hopeful regards

/BL


From CHagner at fool.com  Tue Jul 31 09:13:26 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:52:31 2004
Subject: [mod_python] Internal_redirect ?
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E48089@rover.foolhq.com>

If I remember correctly, Grisha stated that this feature has been highly
requested (and is do-able) but has not yet been implemented.

Chris

-----Original Message-----
From: Bo Lorentsen [mailto:bl@netgroup.dk]
Sent: Tuesday, July 31, 2001 4:19 AM
To: mod_python list
Subject: [mod_python] Internal_redirect ?


Hi ...

I have been working on a larger site setup where I like to force a
redirection to a internal login page if user is unknown (cookie thing).

The only way of redirection I can find is the one described in the
mod_python FAQ, but this often gives a small annoying page telling the
user about a redirection, but what I want is to do it seamless to the
browser.

Now in the Apache doc, I found some info. about a function calls
"internal_redirect", that does exactly what I like to do, but its not
part of the mod_python API, or I cant find it, at least :-)

Have anyone a good hint for me at this point ?

Also, is it correct that its not possible to set a cookie together with
a redirect ?

Hopeful regards

/BL

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python

From miguel at yorku.ca  Tue Jul 31 09:39:07 2001
From: miguel at yorku.ca (Miguel Marques)
Date: Fri Jan  9 21:52:31 2004
Subject: [mod_python] Internal_redirect ?
In-Reply-To: <13CDDE6A53DBD311BC3200508B6F0C4805E48089@rover.foolhq.com>
References: <13CDDE6A53DBD311BC3200508B6F0C4805E48089@rover.foolhq.com>
Message-ID: <20010731093907E.miguel@yorku.ca>

Greetings...
On Tue, 31 Jul 2001 09:13:26 -0400, Chris Hagner <CHagner@fool.com> wrote:
> If I remember correctly, Grisha stated that this feature has been highly
> requested (and is do-able) but has not yet been implemented.
> 
> Chris
> 
> -----Original Message-----
> From: Bo Lorentsen [mailto:bl@netgroup.dk]
> Sent: Tuesday, July 31, 2001 4:19 AM
> To: mod_python list
> Subject: [mod_python] Internal_redirect ?
> 
> 
> Hi ...
> 
> I have been working on a larger site setup where I like to force a
> redirection to a internal login page if user is unknown (cookie thing).
> 
> The only way of redirection I can find is the one described in the
> mod_python FAQ, but this often gives a small annoying page telling the
> user about a redirection, but what I want is to do it seamless to the
> browser.
> 
> Now in the Apache doc, I found some info. about a function calls
> "internal_redirect", that does exactly what I like to do, but its not
> part of the mod_python API, or I cant find it, at least :-)
> 
> Have anyone a good hint for me at this point ?

With apache I do exactly what you are trying to accomplish by setting
a cookie in req.err_headers_out and returning apache.HTTP_FORBIDDEN.
Then in the apache configuration file you use 
ErrorDocument 403 http://yourloginpage 
in the directory/ies you are trying to protect...
Hope that helps...

						Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830

From bl at netgroup.dk  Tue Jul 31 15:54:47 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:52:31 2004
Subject: [mod_python] Internal_redirect ?
References: <13CDDE6A53DBD311BC3200508B6F0C4805E48089@rover.foolhq.com>
Message-ID: <3B66B8A7.FE84A88F@netgroup.dk>

Chris Hagner wrote:

> If I remember correctly, Grisha stated that this feature has been highly
> requested (and is do-able) but has not yet been implemented.

I will then sign up on this request :-)

/BL


From bl at netgroup.dk  Tue Jul 31 15:59:14 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:52:31 2004
Subject: [mod_python] Internal_redirect ?
References: <13CDDE6A53DBD311BC3200508B6F0C4805E48089@rover.foolhq.com> <20010731093907E.miguel@yorku.ca>
Message-ID: <3B66B9B2.8E549FA@netgroup.dk>

Miguel Marques wrote:

> With apache I do exactly what you are trying to accomplish by setting
> a cookie in req.err_headers_out and returning apache.HTTP_FORBIDDEN.
> Then in the apache configuration file you use
> ErrorDocument 403 http://yourloginpage
> in the directory/ies you are trying to protect...

Thats sweet, and the cookie will be set because its part of the
"err_headers_out" ?

> Hope that helps...

Thats a good hint and another interesting way of solving this problem.

Thanks, but I like to do it the propper way --- I think :-)

/BL


From miguel at yorku.ca  Tue Jul 31 10:02:10 2001
From: miguel at yorku.ca (Miguel Marques)
Date: Fri Jan  9 21:52:31 2004
Subject: [mod_python] Internal_redirect ?
In-Reply-To: <3B66B9B2.8E549FA@netgroup.dk>
References: <13CDDE6A53DBD311BC3200508B6F0C4805E48089@rover.foolhq.com>
	<20010731093907E.miguel@yorku.ca>
	<3B66B9B2.8E549FA@netgroup.dk>
Message-ID: <20010731100210L.miguel@yorku.ca>

Greetings...
On Tue, 31 Jul 2001 15:59:14 +0200, Bo Lorentsen <bl@netgroup.dk> wrote:
> Miguel Marques wrote:
> 
> > With apache I do exactly what you are trying to accomplish by setting
> > a cookie in req.err_headers_out and returning apache.HTTP_FORBIDDEN.
> > Then in the apache configuration file you use
> > ErrorDocument 403 http://yourloginpage
> > in the directory/ies you are trying to protect...
> 
> Thats sweet, and the cookie will be set because its part of the
> "err_headers_out" ?
Yes.

> 
> > Hope that helps...
> 
> Thats a good hint and another interesting way of solving this problem.
> 
> Thanks, but I like to do it the propper way --- I think :-)
I couldn't wait... 8-)

						Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830

From tree at basistech.com  Tue Jul 31 15:31:26 2001
From: tree at basistech.com (Tom Emerson)
Date: Fri Jan  9 21:52:31 2004
Subject: [mod_python] Patch to 2.7.5 for internal_redirect
In-Reply-To: <3B66B9B2.8E549FA@netgroup.dk>
References: <13CDDE6A53DBD311BC3200508B6F0C4805E48089@rover.foolhq.com>
	<20010731093907E.miguel@yorku.ca>
	<3B66B9B2.8E549FA@netgroup.dk>
Message-ID: <15207.1934.890865.157761@cymru.basistech.com>

Attached is a small patch to mod_python 2.7.5 which provides support
for doing an internal_redirect. I've only done minimal testing on this
but it appears to work.

I added a new method to the request object, internal_redirect. It
takes a single string argument which is the local URI to redirect
to. After calling this method your handler should just return
apache.OK.

  from mod_python import apache
 
  def handler(req):
      req.internal_redirect("/redirected.html")
      return apache.OK

I also added an exception class, InternalRedirect, to
mod_python.apache. It takes a single argument which is the local URI
to redirect to. This is used by a modification to Publisher which
allows you to perform an internal redirect simply by raising an
InternalRedirect exception:

  from mod_python import apache
 
  def test(req):
      raise apache.InternalRedirect("/redirected.html")

The request object's "main" member is None if the current request is
the "main" request.

Share and enjoy.

-------------- next part --------------
*** ./lib/python/mod_python/publisher.py.orig	Mon May 14 18:17:21 2001
--- ./lib/python/mod_python/publisher.py	Tue Jul 31 15:46:33 2001
***************
*** 168,174 ****
              if name not in expected:
                  del args[name]
  
!         result = apply(object, (), args)
  
      if result:
          result = str(result)
--- 168,178 ----
              if name not in expected:
                  del args[name]
  
!         try:
!             result = apply(object, (), args)
!         except apache.InternalRedirect, e:
!             req.internal_redirect(e.uri)
!             return apache.OK
  
      if result:
          result = str(result)
*** ./lib/python/mod_python/apache.py.orig	Tue Jul 31 16:00:17 2001
--- ./lib/python/mod_python/apache.py	Tue Jul 31 15:44:16 2001
***************
*** 53,58 ****
--- 53,63 ----
  import imp
  import types
  import _apache
+ import exceptions
+ 
+ class InternalRedirect (exceptions.Exception):
+     def __init__(self, uri):
+         self.uri = uri
  
  # a small hack to improve PythonPath performance. This
  # variable stores the last PythonPath in raw (unevaled) form.
*** ./src/requestobject.c.orig	Tue May 22 22:49:43 2001
--- ./src/requestobject.c	Tue Jul 31 15:08:21 2001
***************
*** 438,443 ****
--- 438,462 ----
  }
  
  /**
+  ** request.internal_redirect(request self, string uri)
+  **
+  *    An interface to the ap_internal_redirect function.
+  *    Tom Emerson, <tree@basistech.com>, 2001-07-31
+  */
+ static PyObject * req_internal_redirect(requestobject *self, PyObject *args)
+ {
+     char *uri;
+ 
+     if (! PyArg_ParseTuple(args, "s", &uri))
+         return NULL;
+ 
+     ap_internal_redirect(uri, self->request_rec);
+     
+     Py_INCREF(Py_None);
+     return Py_None;
+ }
+ 
+ /**
   ** request.get_options(request self)
   **
   */
***************
*** 792,797 ****
--- 811,817 ----
      {"get_dirs",             (PyCFunction) req_get_dirs,             METH_VARARGS},
      {"get_remote_host",      (PyCFunction) req_get_remote_host,      METH_VARARGS},
      {"get_options",          (PyCFunction) req_get_options,          METH_VARARGS},
+     {"internal_redirect",    (PyCFunction) req_internal_redirect,    METH_VARARGS},
      {"read",                 (PyCFunction) req_read,                 METH_VARARGS},
      {"readline",             (PyCFunction) req_readline,             METH_VARARGS},
      {"register_cleanup",     (PyCFunction) req_register_cleanup,     METH_VARARGS},
-------------- next part --------------

-- 
Tom Emerson                                          Basis Technology Corp.
Sr. Sinostringologist                              http://www.basistech.com
  "Beware the lollipop of mediocrity: lick it once and you suck forever"
From rekla_ma_ at publicist.com  Sun Jul  1 19:43:52 2001
From: rekla_ma_ at publicist.com (E-mail Reklama)
Date: Fri Jan  9 21:58:59 2004
Subject: [mod_python] =?windows-1251?Q?E-mail_-_=F0=E5=EA=EB=E0=EC=E0?=
Message-ID: <181362001701154352292@publicist.com>

????????????!

? ?????? ??????? ??????? ?? ????? ?? ?????? ??????????? ??????? ???? ???????, ? ??????? ?? ????? ???????????. ??? ????? ???????? ??????????? ???????? ????? ????????? ?????????? ?? ????????? ??????? ??????? (?? 30???. ?? 1???., ??? ?? ??????, ??? ? ?? ???? ?????? ? ???). ??????????? ?????????/?????? ??? ???? ????? ????? ??????.

?? ??????????????? ?????????? ???????????? ?????????? 4 ????. ???? ?????????? ??????? - ?????????? ????????? ????????, ??????? ????? ??????, ??? ????????????? e-mail ???????? ??-?? ?????? ?????? ????????? ?????????? ???? ? ???????? ?? ??????????? ???????????! ???????, ?????????? ???????? ???? ???, ?????????? ? ??? ????? ? ?????. ?????? ?????? ??????? ?????? e-mail ???????, ?? ??????????? ????? ?? ?? ??????????? (???, ??????, ? ???? ????????) ?? ????? ? ?????????? ????????? ??? ???????????????, ??? ??? ?? ????? ????? ? ??????????? ????????? ??? ????????????? ???????????????? ????????. ? ?????? ??????, ??? ???????? ????????? ?????? ????????? ?????????? ?????, ??? ???? ????? ???? ????? ? ?????????? ???????? ?? ?????? ????????????.

?? ????? ??? ??? e-mail ??????? ? ????? ??? ??? ????, ????? ???????? ??? ???????? ?? ???? ?????? ??? ?????????. ??? ??????? ???? ??????????????????? ??????????? ? ???????????????? ?????? ??????? ? ???????? ? ?????????? ??????, ??????????? ???????? smtp-??????? ?? ???????, ? ????? ??????????? ???????????? ????????? ? ???-??? ?  ???? ???????.

?? ????? ?????? ???????? ???, ??? ??? ????? ?? ???????? ?????? ??????.

???? ?? ??????????????? ? ????????? ? ?????? ???????? ?? ??? ????? ?????? ??????????, ???????? ?????? ? ???????????? ????? ? ???? ??????, ????? ? ????? ???????? ????????? "????????", ??? ?? ??????: reklama@publicist.com.

??? ???? ? ???? "???? ?????????" ??????????? ???????: "????????".




From woodm at equire.com  Tue Jul  3 00:14:32 2001
From: woodm at equire.com (Matthew Wood)
Date: Fri Jan  9 21:58:59 2004
Subject: [mod_python] Session data (Sorry for bringing this up again...)
Message-ID: <16299780187.20010703001432@equire.com>

Hello  all.   I  would  like  to  apologize  for bringing up the whole
session thing again.  However, I have a somewhat specific question.

I guess my question has more to do with persistent data in general.

One of the main reasons that one would keep persistent data is to keep
database connections open.  (Or any connection for that matter)
The other is to keep session data on the users of your site.

Obviously,   the session data can be kept in the database, and the key
to  the  table can be kept in a cookie or passed via the url.  (That's
one way to do it, there are many ways, including a text-file-pickeling
based scheme, but I think that a database would work quite well.)

However,  the  problem  is that you can't keep database connections in
the  database.   All  the other persistent data can be kept there, but
not the database connection.

The  problem  with  persistent  data in general is the multiple memory
spaces  used  by  apache.   But  it  would be a shame to re-create the
database  connection every single time someone logs into a page.  That
just seems ridiculous to me.

This brings me to my question:
Would  it  be appropriate to keep a database connection in each of the
memory  spaces?

Such  a connection is not very dynamic (I think) and thus you wouldn't
have to worry about having different types of connections or different
values of connections in the different memory spaces. (As you would if
you stored session data, that changes often.)

What  would be the down side to such an arrangement?  I would probably
need to create a method to time out the connections, so they don't sit
there  forever  if  I change something...  Is that correct?  What am I
missing?


Once  again, let me apologize for bringing up the session issue again.
I  have read all the posts here for the last few months, and I thought
I would see what the up/down sides to this plan would be.



From woodm at equire.com  Tue Jul  3 00:20:40 2001
From: woodm at equire.com (Matthew Wood)
Date: Fri Jan  9 21:58:59 2004
Subject: [mod_python] HTMLgen
Message-ID: <67100148213.20010703002040@equire.com>

I don't know how many of you are familiar with HTMLgen, but it's a set
of objects which aid in the construction of web-pages.

My question is this:

How useful would it be to integrate HTMLgen into a handler, instead of
importing it in each page I write?

The import statement, as well as the initial instanciation of the page
object  (I  can't remember exactly what the name of the object is...).
One  could  even  call  the  'Print  self'  function at the end of the
handler.

Would  this  help anything?  Would it make anything run faster?  Would
it make the code more readable?  Would this be a good idea at all?


I have hardly any experience with mod-python or mod-snake, so I really
don't have enough experience to answer this question.

Thanks in advance for all your help.



From benno at sesgroup.net  Tue Jul  3 16:24:54 2001
From: benno at sesgroup.net (Ben Leslie)
Date: Fri Jan  9 21:58:59 2004
Subject: [mod_python] Session data (Sorry for bringing this up again...)
In-Reply-To: <16299780187.20010703001432@equire.com>; from woodm@equire.com on Tue, Jul 03, 2001 at 12:14:32AM -0600
References: <16299780187.20010703001432@equire.com>
Message-ID: <20010703162453.C11798@sesgroup.net>

On Tue, 03 Jul 2001, Matthew Wood wrote:

<snip>

>
> This brings me to my question:
> Would  it  be appropriate to keep a database connection in each of the
> memory  spaces?


Yes. This is exactly what I do.

In your handler you have a global variable holding the db connection. In 
the handler you check the db handler is alive and recreate if necessary 
(this should really only happen the first time that process is used)

Benno

From piet at cs.uu.nl  Tue Jul  3 09:51:00 2001
From: piet at cs.uu.nl (piet@cs.uu.nl)
Date: Fri Jan  9 21:58:59 2004
Subject: [mod_python] Session data (Sorry for bringing this up again...)
In-Reply-To: Ben Leslie's message of "Tue, 3 Jul 2001 16:24:54 +1000"
References: <16299780187.20010703001432@equire.com>
	<20010703162453.C11798@sesgroup.net>
Message-ID: <u3d8esb6j.fsf@cs.uu.nl>

>>>>> Ben Leslie <benno@sesgroup.net> (BL) writes:

BL> On Tue, 03 Jul 2001, Matthew Wood wrote:
BL> <snip>

>> 
>> This brings me to my question:
>> Would  it  be appropriate to keep a database connection in each of the
>> memory  spaces?


BL> Yes. This is exactly what I do.

BL> In your handler you have a global variable holding the db connection. In 
BL> the handler you check the db handler is alive and recreate if necessary 
BL> (this should really only happen the first time that process is used)

You would have to be careful with multithreading. This applies to Apache on
MS Windows and with 2.0 also on Unix systems. You would need a connection
per thread. Or have a pool where each thread can try to grab a connection.
The pool administration would have to be protected with semaphores or locks
or similar. 
-- 
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl


From vincentwong at ionetbiz.com  Tue Jul  3 16:37:52 2001
From: vincentwong at ionetbiz.com (Vincent Wong)
Date: Fri Jan  9 21:59:00 2004
Subject: [mod_python] Error: No such file or directory
Message-ID: <00ae01c1039b$72f11160$3f00a8c0@ns1.ionetbiz.com>



I encountered the following error when I called the module test.py with  "test.py/saveform":



----
Mod_python error: "PythonHandler mod_python.publisher"

Traceback (most recent call last):

  File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line 193, in Dispatch
    result = object(req)

  File "/usr/local/lib/python2.1/site-packages/mod_python/publisher.py", line 128, in handler
    module = apache.import_module(module_name, _req, [path])

  File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line 356, in import_module
    if os.path.exists(filepath[:-1]) :

  File "/usr/local/lib/python2.1/posixpath.py", line 171, in exists
    st = os.stat(path)

OSError: [Errno 2] No such file or directory: '/home/demo/cgi-bin/test.p'

-----

the test.py file:

import os, sys

def saveform(req):
  return "OK."




Regards,

Vincent


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010703/cdf6c498/attachment-0002.htm
From matthias at my.gnus.org  Tue Jul  3 12:18:43 2001
From: matthias at my.gnus.org (Matthias Wiehl)
Date: Fri Jan  9 21:59:00 2004
Subject: [mod_python] Error: No such file or directory
In-Reply-To: <00ae01c1039b$72f11160$3f00a8c0@ns1.ionetbiz.com> ("Vincent
 Wong"'s message of "Tue, 3 Jul 2001 16:37:52 +0800")
References: <00ae01c1039b$72f11160$3f00a8c0@ns1.ionetbiz.com>
Message-ID: <871ynyqprw.agb@fulmine.dhs.org>

Vincent Wong <vincentwong@ionetbiz.com> writes:
> OSError: [Errno 2] No such file or directory: '/home/demo/cgi-bin/test.p'

Have a closer look at the filename.  I think this is a typo.

From daniel at copyleft.no  Tue Jul  3 12:48:55 2001
From: daniel at copyleft.no (Hr. Daniel Mikkelsen)
Date: Fri Jan  9 21:59:00 2004
Subject: [mod_python] Error: No such file or directory
In-Reply-To: <871ynyqprw.agb@fulmine.dhs.org>
Message-ID: <Pine.LNX.4.31.0107031247070.13943-100000@unity.copyleft.no>

>> OSError: [Errno 2] No such file or directory: '/home/demo/cgi-bin/test.p'

> Have a closer look at the filename.  I think this is a typo.

I don't know if it's the same thing here, but I'm running FreeBSD, and
mod_python erranously cuts the last character of filename of the handler
I've given. I had to remove a [:-1] suffix a couple of places in apache.py
(I think) to get it to work.

I'll post more details if it's interesting to anyone.

-- Daniel Mikkelsen, Copyleft Software AS



From CHagner at fool.com  Tue Jul  3 08:50:12 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:59:00 2004
Subject: [mod_python] Session data (Sorry for bringing this up again..
	.)
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E47FAF@rover.foolhq.com>

An alternative would be to have a separate daemon running on the server
(outside of apache/mod_python) that creates/serves/pools/persists your
connections.  Thus, each apache child process/python subinterp would hit
this daemon to get connections.  This model (or something similar) is almost
required if you're going to run apache with many child procs... or multiple
apache instances on the same box.  Either way, you don't really want 100
connections (or more! ack) open to the database.  Heck, if you're running
multiple web servers all hitting a single database, you can easily see how
the total number of connections gets painfully large.  You probably want
something along the lines of 5-10 connections in a db connection pool
(although this is highly dependent on the design of the pool and the
daemon).

Chris

-----Original Message-----
From: Ben Leslie [mailto:benno@sesgroup.net]
Sent: Tuesday, July 03, 2001 2:25 AM
To: Matthew Wood
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Session data (Sorry for bringing this up
again...)


On Tue, 03 Jul 2001, Matthew Wood wrote:

<snip>

>
> This brings me to my question:
> Would  it  be appropriate to keep a database connection in each of the
> memory  spaces?


Yes. This is exactly what I do.

In your handler you have a global variable holding the db connection. In 
the handler you check the db handler is alive and recreate if necessary 
(this should really only happen the first time that process is used)

Benno
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python

From vincentwong at ionetbiz.com  Tue Jul  3 21:38:48 2001
From: vincentwong at ionetbiz.com (Vincent Wong)
Date: Fri Jan  9 21:59:00 2004
Subject: [mod_python] Error: No such file or directory
References: <Pine.LNX.4.31.0107031247070.13943-100000@unity.copyleft.no>
Message-ID: <012301c103c5$7d3ee8c0$3f00a8c0@ns1.ionetbiz.com>

Thanks, Daniel.  So far it work after I change a few of [:-1] to [:].  I
wounldn't know if there is any side effect.


----- Original Message -----
From: Hr. Daniel Mikkelsen <daniel@copyleft.no>
To: Matthias Wiehl <matthias@my.gnus.org>
Cc: Vincent Wong <vincentwong@ionetbiz.com>; Mod_python Mailing List
<mod_python@modpython.org>
Sent: Tuesday, July 03, 2001 6:48 PM
Subject: Re: [mod_python] Error: No such file or directory


> >> OSError: [Errno 2] No such file or directory:
'/home/demo/cgi-bin/test.p'
>
> > Have a closer look at the filename.  I think this is a typo.
>
> I don't know if it's the same thing here, but I'm running FreeBSD, and
> mod_python erranously cuts the last character of filename of the handler
> I've given. I had to remove a [:-1] suffix a couple of places in apache.py
> (I think) to get it to work.
>
> I'll post more details if it's interesting to anyone.
>
> -- Daniel Mikkelsen, Copyleft Software AS
>


From seant at webreply.com  Tue Jul  3 14:02:13 2001
From: seant at webreply.com (Sean True)
Date: Fri Jan  9 21:59:00 2004
Subject: [mod_python] Translation handler help?
Message-ID: <MJEHLHJKGINLONDMMKNEIECFDHAA.seant@webreply.com>

We're implementing a bunch of stuff on top of mod_python, and have avoided
using the
translation handler. Until today.

I'd like to rewrite the URI -- but req.uri is readonly. I can't find a
req.uri() method ...

I'd like to find the equivalent of the CGI document root -- but
apache.build_cgi_env() is not happy about running inside the transhandler():

File /usr/local/pythonpackages/mod_python/apache.py", line 189, in Dispatch
    result = object(self.req)
File "/usr/local/pythonpackages/phtml/phtml.py", line 14, in transhandler
    env = apache.build_cgi_env(req)
File "/usr/local/pythonpackages/mod_python/apache.py", line 418, in
build_cgi_env
    env[k] = req.subprocess_env[k]
KeyError: SCRIPT_FILENAME

Does anyone have a creative or even functional example of a translation
handler?

-- Sean
-------
Sean True
WebReply.Com, Inc.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Sean True.vcf
Type: text/x-vcard
Size: 309 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20010703/f6dc2e8a/SeanTrue-0002.vcf
From grisha at modpython.org  Tue Jul  3 14:57:44 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:00 2004
Subject: [mod_python] Translation handler help?
In-Reply-To: <MJEHLHJKGINLONDMMKNEIECFDHAA.seant@webreply.com>
Message-ID: <Pine.BSF.4.32.0107031455280.93646-100000@localhost>

This is probably a screw up on my end - req.uri should be read only for
the translation handler to be useful... ;-)

It's not that hard to add that in - just look at how other read/write
variables are implemented - you have to put a couple of lines of code in
the set_attr function... If this is too much trouble, you 'll have to wait
until the next release.

Grisha

On Tue, 3 Jul 2001, Sean True wrote:

> We're implementing a bunch of stuff on top of mod_python, and have avoided
> using the
> translation handler. Until today.
>
> I'd like to rewrite the URI -- but req.uri is readonly. I can't find a
> req.uri() method ...
>
> I'd like to find the equivalent of the CGI document root -- but
> apache.build_cgi_env() is not happy about running inside the transhandler():
>
> File /usr/local/pythonpackages/mod_python/apache.py", line 189, in Dispatch
>     result = object(self.req)
> File "/usr/local/pythonpackages/phtml/phtml.py", line 14, in transhandler
>     env = apache.build_cgi_env(req)
> File "/usr/local/pythonpackages/mod_python/apache.py", line 418, in
> build_cgi_env
>     env[k] = req.subprocess_env[k]
> KeyError: SCRIPT_FILENAME
>
> Does anyone have a creative or even functional example of a translation
> handler?
>
> -- Sean
> -------
> Sean True
> WebReply.Com, Inc.
>


From matt at designscape.com.au  Wed Jul  4 11:59:39 2001
From: matt at designscape.com.au (Matt Beauregard)
Date: Fri Jan  9 21:59:00 2004
Subject: [mod_python] undefined symbol "floor"
Message-ID: <20010704115939.K14594@designscape.com.au>

We just set up mod_python and are getting the following strange error:

Mod_python error: "PythonHandler modpython"

Traceback (most recent call last):
  File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line 189, in Dispatch
    result = object(self.req)
  File "/usr/home/marauder/exchange/modpython.py", line 7, in handler
ImportError: /usr/local/lib/python2.1/lib-dynload/struct.so: Undefined symbol "floor"

We get this any time some code tries to import struct, when running
through mod_python, but not when running from the interpreter.  Any
clues for fixing it would be appreciated.

Using mod_python 2.7.5
Python 2.1 (#2, Jul  3 2001, 17:40:45) 
[GCC 2.95.2 19991024 (release)] on freebsd4
FreeBSD bofh.designscape.com.au 4.2-RELEASE FreeBSD 4.2-RELEASE #0:
Tue Feb 27 12:11:29 EST 2001 marauder@bofh.designscape.com.au:/usr/src/sys/compile/BOFH  i386

thanks,

-- 
Matt Beauregard
BOFH, Designscape
Ph: +61 2 9361 4233   Fx: +61 2 9361 4633

Permission is given for unlimited distribution of this work under the
Copyright Act 1968 (2001 amended).  Unless otherwise stated, you agree
that these terms also cover works which you send in response.


From grisha at modpython.org  Tue Jul  3 22:53:53 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:00 2004
Subject: [mod_python] undefined symbol "floor"
In-Reply-To: <20010704115939.K14594@designscape.com.au>
Message-ID: <Pine.BSF.4.32.0107032247370.293-100000@localhost>

floor() lives in libm, make sure that when you compile it, "-lm" is one of
the options.

On Wed, 4 Jul 2001, Matt Beauregard wrote:

> We just set up mod_python and are getting the following strange error:
>
> Mod_python error: "PythonHandler modpython"
>
> Traceback (most recent call last):
>   File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line 189, in Dispatch
>     result = object(self.req)
>   File "/usr/home/marauder/exchange/modpython.py", line 7, in handler
> ImportError: /usr/local/lib/python2.1/lib-dynload/struct.so: Undefined symbol "floor"
>
> We get this any time some code tries to import struct, when running
> through mod_python, but not when running from the interpreter.  Any
> clues for fixing it would be appreciated.
>
> Using mod_python 2.7.5
> Python 2.1 (#2, Jul  3 2001, 17:40:45)
> [GCC 2.95.2 19991024 (release)] on freebsd4
> FreeBSD bofh.designscape.com.au 4.2-RELEASE FreeBSD 4.2-RELEASE #0:
> Tue Feb 27 12:11:29 EST 2001 marauder@bofh.designscape.com.au:/usr/src/sys/compile/BOFH  i386
>
> thanks,
>
> --
> Matt Beauregard
> BOFH, Designscape
> Ph: +61 2 9361 4233   Fx: +61 2 9361 4633
>
> Permission is given for unlimited distribution of this work under the
> Copyright Act 1968 (2001 amended).  Unless otherwise stated, you agree
> that these terms also cover works which you send in response.
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From matt at designscape.com.au  Wed Jul  4 13:04:42 2001
From: matt at designscape.com.au (Matt Beauregard)
Date: Fri Jan  9 21:59:00 2004
Subject: [mod_python] undefined symbol "floor"
In-Reply-To: <Pine.BSF.4.32.0107032247370.293-100000@localhost>; from grisha@modpython.org on Tue, Jul 03, 2001 at 10:53:53PM -0400
References: <20010704115939.K14594@designscape.com.au> <Pine.BSF.4.32.0107032247370.293-100000@localhost>
Message-ID: <20010704130442.A40751@designscape.com.au>

On Tue, Jul 03, 2001 at 10:53:53PM -0400, Gregory (Grisha) Trubetskoy wrote:
> 
> floor() lives in libm, make sure that when you compile it, "-lm" is one of
> the options.

Hi Gregory,

I think the relevant compile lines are 
/usr/local/sbin/apxs -I/usr/ports/www/mod_python/work/mod_python-2.7.5/src/include -I/usr/local/include/apache -I/usr/ports/www/mod_python/work/Python-2.1 -I/usr/ports/www/mod_python/work/Python-2.1/Include -c mod_python.o  _apachemodule.o  requestobject.o  tableobject.o  util.o  serverobject.o  connobject.o -lm  /usr/ports/www/mod_python/work/Python-2.1/libpython2.1.a      -lm
gcc -shared -o mod_python.so mod_python.o _apachemodule.o requestobject.o tableobject.o util.o serverobject.o connobject.o -lm /usr/ports/www/mod_python/work/Python-2.1/libpython2.1.a -lm 

Output from objdump:
!815 root@bofh:/usr/ports/www/mod_python/work/mod_python-2.7.5/src# objdump -t mod_python.so|grep floor
00000000       F *UND*  00000000 floor
!816 root@bofh:/usr/ports/www/mod_python/work/mod_python-2.7.5/src# objdump -T mod_python.so|grep floor
00000000      DF *UND*  00000000 floor

Any clues?

thanks,

-- 
Matt Beauregard
Technical Director, Designscape
Ph: +61 2 9361 4233   Fx: +61 2 9361 4633

Permission is given for unlimited distribution of this work under the
Copyright Act 1968 (2001 amended).  Unless otherwise stated, you agree
that these terms also cover works which you send in response.


From mark_miller_ca at yahoo.com  Wed Jul  4 01:31:11 2001
From: mark_miller_ca at yahoo.com (Mark Miller)
Date: Fri Jan  9 21:59:00 2004
Subject: [mod_python] mod_python and testing error
Message-ID: <ALEBINNPGFGFAJGIFGHPAEGICBAA.mark_miller_ca@yahoo.com>

when i try to run the test script as stated in the manual,
i originally was getting the text of the script displayed on the screen, but
i just ran it now, and i got from apache: internal server error.

Within the apache error_log file, i have [Wed Jul 4 01:07:41 2001] [error]
[client 192.168.0.92] python_handler: make_obcallback returned no
obCallBack!

Can anyone guide me beyond this point, i get the feeling that i am close, if
it comes down to it, i will include my httpd.conf, but i don't imagine the
problem is within the file.

Thanks

Mark Miller


_________________________________________________________
Do You Yahoo!?
Get your free @yahoo.com address at http://mail.yahoo.com


From daniel at copyleft.no  Wed Jul  4 09:35:14 2001
From: daniel at copyleft.no (Hr. Daniel Mikkelsen)
Date: Fri Jan  9 21:59:00 2004
Subject: [mod_python] undefined symbol "floor"
In-Reply-To: <Pine.BSF.4.32.0107032247370.293-100000@localhost>
Message-ID: <Pine.LNX.4.31.0107040933280.13943-100000@unity.copyleft.no>

> floor() lives in libm, make sure that when you compile it, "-lm" is one of
> the options.

It is my experience, on FreeBSD, that I have to recompile Apache with
"-lm" in order for this to work. Linking it with mod_python doesn't seem
to cut it (unless one perhaps linked it statically).

-- Daniel Mikkelsen, Copyleft Software AS



From matt at designscape.com.au  Wed Jul  4 17:51:15 2001
From: matt at designscape.com.au (Matt Beauregard)
Date: Fri Jan  9 21:59:00 2004
Subject: [mod_python] undefined symbol "floor"
In-Reply-To: <Pine.LNX.4.31.0107040933280.13943-100000@unity.copyleft.no>; from daniel@copyleft.no on Wed, Jul 04, 2001 at 09:35:14AM +0200
References: <Pine.BSF.4.32.0107032247370.293-100000@localhost> <Pine.LNX.4.31.0107040933280.13943-100000@unity.copyleft.no>
Message-ID: <20010704175115.F40751@designscape.com.au>

On Wed, Jul 04, 2001 at 09:35:14AM +0200, Hr. Daniel Mikkelsen wrote:
> > floor() lives in libm, make sure that when you compile it, "-lm" is one of
> > the options.
> 
> It is my experience, on FreeBSD, that I have to recompile Apache with
> "-lm" in order for this to work. Linking it with mod_python doesn't seem
> to cut it (unless one perhaps linked it statically).

Hooray!  Thanks Daniel, one step closer...

Now it's finding floor, but I'm getting 
ImportError: /usr/local/lib/python2.1/lib-dynload/_socket.so: Undefined symbol "PyThread_acquire_lock"

Is this another linker problem?  What do I link in to get this solved?

thanks,

-- 
Matt Beauregard
Technical Director, Designscape
Ph: +61 2 9361 4233   Fx: +61 2 9361 4633

Permission is given for unlimited distribution of this work under the
Copyright Act 1968 (2001 amended).  Unless otherwise stated, you agree
that these terms also cover works which you send in response.


From vincentwong at ionetbiz.com  Wed Jul  4 16:36:18 2001
From: vincentwong at ionetbiz.com (Vincent Wong)
Date: Fri Jan  9 21:59:00 2004
Subject: [mod_python] os.system problem
Message-ID: <007401c10464$65bb50e0$3f00a8c0@ns1.ionetbiz.com>

When I use os.system('some command') within the interactive interpreter, everything works fine.  But when I use the same os.system('some command') together with mod_python, no error reported but the effect of the command does not occur.  Anyone know what is happenning here?

Regards.
Vincent

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010704/247ee969/attachment-0002.htm
From daniel at copyleft.no  Wed Jul  4 10:31:50 2001
From: daniel at copyleft.no (Hr. Daniel Mikkelsen)
Date: Fri Jan  9 21:59:00 2004
Subject: [mod_python] undefined symbol "floor" 
Message-ID: <Pine.LNX.4.31.0107041031270.13943-100000@unity.copyleft.no>

>> It is my experience, on FreeBSD, that I have to recompile Apache with
>> "-lm" in order for this to work. Linking it with mod_python doesn't seem
>> to cut it (unless one perhaps linked it statically).

> Now it's finding floor, but I'm getting ImportError:
> /usr/local/lib/python2.1/lib-dynload/_socket.so: Undefined symbol
> "PyThread_acquire_lock" Is this another linker problem?  What do I
> link in to get this solved?

I got this one too, at one point, but I can't remember what I did. I think
it had something to do with Python's /usr/local/lib/python2.1 binaries
being compiled with threading.

Perhaps a separate install of a threadless python, in another directory,
and linking against that, will help you. Only, I can't recall doing this,
and things are working for me now.

There were also more problems like this, one with mxDateTime. I feel every
time I want to set up mod_python after a few months of not using it, I
have to spend days fucking with it. :)

-- Daniel Mikkelsen, Copyleft Software AS



From mai99dgf at studserv.uni-leipzig.de  Wed Jul  4 13:34:08 2001
From: mai99dgf at studserv.uni-leipzig.de (Georg Martius)
Date: Fri Jan  9 21:59:00 2004
Subject: [mod_python] apache-1.3.14 Suse/Linux & mod_python toubles
Message-ID: <3B42FF30.BA021F5F@studserv.uni-leipzig.de>

Hi

I have same troubles with the mod_python module and my apache. 
I have SuSE 7.1 and the apache logs the following:

[notice] Apache/1.3.14 (Unix)  (SuSE/Linux) mod_python/2.7.1 Python/2.0
mod_throttle/3.0 mod_layout/1.0 mod_fastcgi/2.2.2 mod_perl/1.24
PHP/3.0.17-dev configured -- resuming normal operations 

I have copied the mptest.py into my cgi-bin directory with the right
permissions.

the splitter of my httpd.conf is:

<Directory /usr/local/httpd/cgi-bin>
  AddHandler python-program .py
  PythonHandler mptest
  PythonDebug On
</Directory>      


If perform a request to mptest.py I get in internal server error and the
logfile shows:
[error] (8)Exec format error: exec of /usr/local/httpd/cgi-bin/mptest.py
failed
[error] [client 192.168.155.55] Premature end of script headers:
/usr/local/httpd/cgi-bin/mptest.py     

Thanks for any help!

Ciao Bethoven

From M.Izydorski at rubikon.pl  Wed Jul  4 16:15:51 2001
From: M.Izydorski at rubikon.pl (Michal Izydorski)
Date: Fri Jan  9 21:59:00 2004
Subject: [mod_python] Configuration problems
Message-ID: <1646860855.20010704161551@rubikon.pl>

Hello!!

I have configuration problems with Apache 1.3.20 under W2k

The error is:

> Syntax error on line 211 of c:/program files/apache group/apache/conf/httpd.conf
> :
> Cannot load c:/program files/apache group/apche/modules/mod_python.dll into serv
> er: (126) Nie mo?na odnale?? okre?lonego modu-u:


           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
I don't know, why marked part is in my w2k local language, it means No
such modules.

I load other modules, esp. PHP, and there isn't problem, the same dir,
proprietary LoadModule Directives, bup Python don't work.

Please help and send answer to my email too.


-- 
Regards,
 Michal                          mailto:M.Izydorski@rubikon.pl



From grisha at modpython.org  Wed Jul  4 10:18:12 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:00 2004
Subject: [mod_python] undefined symbol "floor"
In-Reply-To: <20010704175115.F40751@designscape.com.au>
Message-ID: <Pine.BSF.4.32.0107041016050.8569-100000@localhost>

oh, this is an easy one - recompile Python without threads and use
--with-python to compile mod_python.

the mod_python port used to take care of all of that very nicely, but it
seems to be a bit outdated at 2.7.3... although you might be able to tweak
the Makefile just a little bit to make it compile the latest version -
there isn't all that much difference.

grisha

On Wed, 4 Jul 2001, Matt Beauregard wrote:

> On Wed, Jul 04, 2001 at 09:35:14AM +0200, Hr. Daniel Mikkelsen wrote:
> > > floor() lives in libm, make sure that when you compile it, "-lm" is one of
> > > the options.
> >
> > It is my experience, on FreeBSD, that I have to recompile Apache with
> > "-lm" in order for this to work. Linking it with mod_python doesn't seem
> > to cut it (unless one perhaps linked it statically).
>
> Hooray!  Thanks Daniel, one step closer...
>
> Now it's finding floor, but I'm getting
> ImportError: /usr/local/lib/python2.1/lib-dynload/_socket.so: Undefined symbol "PyThread_acquire_lock"
>
> Is this another linker problem?  What do I link in to get this solved?
>
> thanks,
>
> --
> Matt Beauregard
> Technical Director, Designscape
> Ph: +61 2 9361 4233   Fx: +61 2 9361 4633
>
> Permission is given for unlimited distribution of this work under the
> Copyright Act 1968 (2001 amended).  Unless otherwise stated, you agree
> that these terms also cover works which you send in response.
>


From vincentwong at ionetbiz.com  Thu Jul  5 12:00:46 2001
From: vincentwong at ionetbiz.com (Vincent Wong)
Date: Fri Jan  9 21:59:00 2004
Subject: [mod_python] link to image files broken
Message-ID: <00fc01c10507$1218a700$3f00a8c0@ns1.ionetbiz.com>

I have a html file call thanks.html.  When I open this file and return the content from my test.py file, all links to image (.gif) files are broken.  Did anyone know the solution?

Thanks.

Vincent

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010705/b1386738/attachment-0002.htm
From piet at cs.uu.nl  Thu Jul  5 11:01:29 2001
From: piet at cs.uu.nl (piet@cs.uu.nl)
Date: Fri Jan  9 21:59:00 2004
Subject: [mod_python] link to image files broken
In-Reply-To: "Vincent Wong"'s message of "Thu, 5 Jul 2001 12:00:46 +0800"
References: <00fc01c10507$1218a700$3f00a8c0@ns1.ionetbiz.com>
Message-ID: <ubsmzoil2.fsf@cs.uu.nl>

>>>>> "Vincent Wong" <vincentwong@ionetbiz.com> (VW) writes:

VW> I have a html file call thanks.html. When I open this file and return
VW> the content from my test.py file, all links to image (.gif) files are
VW> broken. Did anyone know the solution?

Not without knowing how the links to the images are coded in thanks.html.
-- 
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl


From vincentwong at ionetbiz.com  Fri Jul  6 14:18:45 2001
From: vincentwong at ionetbiz.com (Vincent Wong)
Date: Fri Jan  9 21:59:00 2004
Subject: [mod_python] link to image files broken
References: <014901c10542$3c018ec0$3f00a8c0@ns1.ionetbiz.com>
Message-ID: <012801c105e3$833099c0$3f00a8c0@ns1.ionetbiz.com>

these are the test.py and thanks.html

---test.py---


import os, sys
def saveform(req):
  input = open('../../thanks.html', 'r')

  return input.read()


---thanks.html---

<html>
<head>
<title>Desa Millennia E-Community</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<script language="JavaScript">
<!--
function MM_preloadImages() { file://v3.0
  var d=document; if(d.images){ if(!d.MM_p) d.MM_p=new Array();
    var i,j=d.MM_p.length,a=MM_preloadImages.arguments; for(i=0; i<a.length;
i++)
    if (a[i].indexOf("#")!=0){ d.MM_p[j]=new Image; d.MM_p[j++].src=a[i];}}
}

function MM_swapImgRestore() { file://v3.0
  var i,x,a=document.MM_sr; for(i=0;a&&i<a.length&&(x=a[i])&&x.oSrc;i++)
x.src=x.oSrc;
}

function MM_findObj(n, d) { file://v4.0
  var p,i,x;  if(!d) d=document;
if((p=n.indexOf("?"))>0&&parent.frames.length) {
    d=parent.frames[n.substring(p+1)].document; n=n.substring(0,p);}
  if(!(x=d[n])&&d.all) x=d.all[n]; for (i=0;!x&&i<d.forms.length;i++)
x=d.forms[i][n];
  for(i=0;!x&&d.layers&&i<d.layers.length;i++)
x=MM_findObj(n,d.layers[i].document);
  if(!x && document.getElementById) x=document.getElementById(n); return x;
}

function MM_swapImage() { file://v3.0
  var i,j=0,x,a=MM_swapImage.arguments; document.MM_sr=new Array;
for(i=0;i<(a.length-2);i+=3)
   if ((x=MM_findObj(a[i]))!=null){document.MM_sr[j++]=x; if(!x.oSrc)
x.oSrc=x.src; x.src=a[i+2];}
}
file://-->
</script>
</head>

<body bgcolor="#FFFFFF" text="#000000" leftmargin="0" topmargin="0"
marginwidth="0" marginheight="0" background="main/002darkgreen.gif"
onLoad="MM_preloadImages('main/016community1.gif','main/017security1.gif','m
ain/018events1.gif','main/019onlinepay1.gif','main/20onlinebook1.gif','main/
21shopping1.gif','main/22food1.gif','main/23entertain1.gif','main/24gettinga
round1.gif','main/25thetown1.gif','main/26news1.gif','main/27technical1.gif'
,'main/28infodesk1.gif','main/29faq1.gif','main/41a.gif','main/015home1.gif'
)">
<div align="center">
  <table width="100%" border="0" cellspacing="0" cellpadding="0"
bgcolor="#FFFFFF">
    <tr>
      <td>
        <div align="center"><img src="main/000none.gif" width="10"
height="10"><br>
          <img src="main/00logo.gif" width="197" height="38"><img
src="main/000none.gif" width="80" height="8">
          <img src="main/00newlaunch_banner.gif" width="480" height="60">
<img src="main/000none.gif" width="20" height="8"><br>
          <img src="main/000none.gif" width="10" height="3"></div>
      </td>
    </tr>
  </table>
  <table width="100%" border="0" cellspacing="0" cellpadding="0">
    <tr>
      <td height="3" background="main/001blackwhiteline.gif"><img
src="main/000none.gif" width="1" height="1"></td>
    </tr>
  </table>
  <table width="761" border="0" cellspacing="0" cellpadding="0">
    <tr>
      <td><br>
        <table width="767" border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td width="375"><img src="main/000none.gif" width="175"
height="1"><img src="main/45.gif" width="112" height="41"></td>
            <td width="386">
              <table width="100%" border="0" cellspacing="0"
cellpadding="0">
                <tr>
                  <td><b><font face="Arial, Helvetica, sans-serif" size="1"
color="#CCCCCC">Username
                    :<img src="main/000none.gif" width="10"
height="8"></font></b></td>
                  <td>
                    <input type="text" name="textfield" size="10">
                    <b><font face="Arial, Helvetica, sans-serif" size="1"
color="#CCCCCC"><img src="main/000none.gif" width="20"
height="8"></font></b>
                  </td>
                  <td><b><font face="Arial, Helvetica, sans-serif" size="1"
color="#CCCCCC">Password
                    :<img src="main/000none.gif" width="10" height="8">
</font></b></td>
                  <td>
                    <input type="text" name="textfield2" size="10">
                  </td>
                  <td>
                    <div align="right"><img src="main/004go.gif" width="22"
height="22"></div>
                  </td>
                </tr>
              </table>
            </td>
          </tr>
        </table>
        <table width="761" border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td width="111" valign=top background="main/013.gif">
              <p><img src="main/002darkgreen.gif" width="111"
height="3"><br>
                <font color="#FFFFFF"><b><font face="Verdana, Tahoma, Arial"
size="1">Search
                For :<br>
                <img src="main/000none.gif" width="8" height="8"><br>
                <input type="text" name="textfield3" size="13">
                <br>
                </font><font color="#FFFFFF"><b><font face="Verdana, Tahoma,
Arial" size="1"><img src="main/000none.gif" width="8"
height="8"></font></b></font><br>
                <img src="main/000none.gif" width="28" height="1"><img
src="main/014searchbutton.gif" width="74" height="16"><br>
                <br>
                <a href="index.html" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image15','','main/015home1.gif',1)"><img
src="main/015home.gif" width="111" height="24" border="0"
name="Image15"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image1','','main/016community1.gif',1)"><img
src="main/016community.gif" width="111" height="24" border="0"
name="Image1"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image2','','main/017security1.gif',1)"><img
src="main/017security.gif" width="111" height="24" border="0"
name="Image2"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image3','','main/018events1.gif',1)"><img
src="main/018events.gif" width="111" height="24" border="0"
name="Image3"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image4','','main/019onlinepay1.gif',1)"><img
src="main/019onlinepay.gif" width="111" height="24" border="0"
name="Image4"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image5','','main/20onlinebook1.gif',1)"><img
src="main/20onlinebook.gif" width="111" height="24" border="0"
name="Image5"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image6','','main/21shopping1.gif',1)"><img
src="main/21shopping.gif" width="111" height="24" border="0"
name="Image6"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image7','','main/22food1.gif',1)"><img
src="main/22food.gif" width="111" height="24" border="0"
name="Image7"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image8','','main/23entertain1.gif',1)"><img
src="main/23entertain.gif" width="111" height="24" border="0"
name="Image8"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image9','','main/24gettingaround1.gif',1)"><img
src="main/24gettingaround.gif" width="111" height="24" border="0"
name="Image9"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image10','','main/25thetown1.gif',1)"><img
src="main/25thetown.gif" width="111" height="24" border="0"
name="Image10"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image11','','main/26news1.gif',1)"><img
src="main/26news.gif" width="111" height="24" border="0"
name="Image11"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image12','','main/27technical1.gif',1)"><img
src="main/27technical.gif" width="111" height="24" border="0"
name="Image12"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image13','','main/28infodesk1.gif',1)"><img
src="main/28infodesk.gif" width="111" height="24" border="0"
name="Image13"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image14','','main/29faq1.gif',1)"><img
src="main/29faq.gif" width="111" height="24" border="0"
name="Image14"></a></b></font></p>
              <p align="center"><img src="main/30advert.gif" width="102"
height="113"><br>
                <br>
              </p>
            </td>
            <td width="11" valign=top background="main/007.gif"><img
src="main/008.gif" width="11" height="32"></td>
            <td width="627" valign=top bgcolor="#FFFFFF">
              <div align="left">
                <table width="100%" border="0" cellspacing="0"
cellpadding="0">
                  <tr>
                    <td background="main/43.gif"><img src="main/44.gif"
width="167" height="27"></td>
                  </tr>
                </table>
                <br>
                <br>
                <br>
                <br>
                <table width="85%" border="0" cellspacing="0"
cellpadding="0" align="center">
                  <tr>
                    <td>
                      <div align="center">
                        <p><b><font face="Verdana, Arial, Helvetica,
sans-serif" size="1" color="#000000">THANK
                          YOU !</font></b></p>
                        <p align="center"><b><font face="Verdana, Arial,
Helvetica, sans-serif" size="1" color="#000000"><font color="#003300">Your
                          registration is successfull ! To learn how to
install
                          your e-mail, please <font color="#333333"><a
href="faq2.html"><font color="#000000">click
                          here</font></a></font>!</font></font></b></p>
                        </div>
                    </td>
                  </tr>
                </table>
                <div align="center"><br>
                  <br>
                  <table width="85%" border="0" cellspacing="0"
cellpadding="0" align="center">
                    <tr>
                      <td width="50%"><b><font face="Verdana, Arial,
Helvetica, sans-serif" size="1" color="#000000"><a href="invite.html"
target="_blank"><img src="main/02.jpg" width="73" height="61"
border="0"></a><a href="invite.html" target="_blank"><img src="main/38.gif"
width="171" height="61" border="0"></a><br>
                        <br>
                        <b><font face="Arial, Helvetica, sans-serif"
size="1" color="#CCCCCC"><img src="main/000none.gif" width="8"
height="4"></font></b><br>
                        <img src="main/32line.gif" width="254"
height="1"><br>
                        <img src="main/33.gif" width="98" height="89"><img
src="main/34.gif" width="154" height="89" usemap="#Map3" border="0"><br>
                        <img src="main/35.gif" width="99" height="94"><img
src="main/36.gif" width="153" height="94" usemap="#Map4Map" border="0"><br>
                        <br>
                        <map name="Map3">
                          <area shape="rect" coords="74,58,153,73"
href="http://www.emasonline.com/millenniumland/Showhouse/Main.asp"
target="_blank">
                        </map>
                        </font></b><b><font face="Verdana, Arial, Helvetica,
sans-serif" size="1" color="#000000">
                        <map name="Map4Map">
                          <area shape="rect" coords="73,68,152,81"
href="http://www.emasonline.com/millenniumland/demo.asp" target="_blank">
                        </map>
                        </font></b></td>
                      <td width="50%">
                        <div align="center">
                          <p align="center"><img src="main/54suggest.gif"
width="153" height="180" usemap="#Map" border="0">
                            <map name="Map">
                              <area shape="rect" coords="63,137,144,151"
href="mailto:feedback@desamillennia.com" alt="SUGESST ??" title="SUGESST
??">
                            </map>
                            <b><font face="Verdana, Arial, Helvetica,
sans-serif" size="1" color="#000000">
                            <map name="Map4">
                              <area shape="rect" coords="73,68,152,81"
href="http://www.emasonline.com/millenniumland/demo.asp" target="_blank">
                            </map>
                            </font></b></p>
                        </div>
                      </td>
                    </tr>
                  </table>
                  <br>
                </div>
                <div align="center"><br>
                </div>
                <p align="center">&nbsp;</p>
                <p align="center">&nbsp;</p>
              </div>
            </td>
            <td width="12" background="main/005.gif" valign=top><img
src="main/006.gif" width="12" height="30"></td>
          </tr>
        </table>
        <table width="761" border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td width="114">
              <div align="right"><img src="main/50.gif" width="4"
height="10"></div>
            </td>
            <td width="647" background="main/48.gif">
              <div align="right"><img src="main/49.gif" width="8"
height="10"></div>
            </td>
          </tr>
        </table>
        <table width="761" border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td width="114">
              <div align="right"></div>
            </td>
            <td width="647">
              <div align="center"><br>
                <font size="1" face="Arial, Helvetica, sans-serif"
color="#CCCCCC">
                Home | Community | Security Access | Events | Online Payment
|
                Online Booking | Shopping | Food &amp; Dining |
Entertainment
                | Getting Around | The Town | News &amp; Archives |
Technical
                Support | Information Desk | FAQ<br>
                <font color="#666666"><br>
                Copyright 2001 &copy; . Desa Millennia Sdn Bhd. Your Smart
Township.
                Site constructed by zecnet.com and
ionetbiz.com.</font></font></div>
            </td>
          </tr>
        </table>

      </td>
    </tr>
  </table>
  <br>
</div>
</body>
</html>






From piet at cs.uu.nl  Fri Jul  6 11:30:42 2001
From: piet at cs.uu.nl (piet@cs.uu.nl)
Date: Fri Jan  9 21:59:00 2004
Subject: [mod_python] link to image files broken
In-Reply-To: "Vincent Wong"'s message of "Fri, 6 Jul 2001 14:18:45 +0800"
References: <014901c10542$3c018ec0$3f00a8c0@ns1.ionetbiz.com>
	<012801c105e3$833099c0$3f00a8c0@ns1.ionetbiz.com>
Message-ID: <uhewqiev1.fsf@cs.uu.nl>

>>>>> "Vincent Wong" <vincentwong@ionetbiz.com> (VW) writes:

VW> these are the test.py and thanks.html
VW> ---test.py---


VW> import os, sys
VW> def saveform(req):
VW>   input = open('../../thanks.html', 'r')

VW>   return input.read()


VW> ---thanks.html---
....
VW> marginwidth="0" marginheight="0" background="main/002darkgreen.gif"
VW> onLoad="MM_preloadImages('main/016community1.gif','main/017security1.gif','m

It is difficult to know without the context, but I guess the problem is
that your images are supposed to come from the directory `main', which I
suppose is relative to the directory where thanks.html is found. But the
browser doesn't know that the HTML file comes from ../.., it works relative
to the directory where your python script is located (or the original
script that calls this one).

So you could:
1. Change the image locations in thanks.html to ../../main
2. Move the main directory to the sirectory where your python scripts are
   (but this doesn't help if you also need to refer to thanks.html
   directly)
3. Put a <BASE HREF="actual location of the thanks.html file"> in
   thanks.html or in the copy that you write.
I think 3 is the best solution.
-- 
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl


From seant at webreply.com  Fri Jul  6 12:34:27 2001
From: seant at webreply.com (Sean True)
Date: Fri Jan  9 21:59:00 2004
Subject: [mod_python] More translation handler help?
In-Reply-To: <ubsmzoil2.fsf@cs.uu.nl>
Message-ID: <MJEHLHJKGINLONDMMKNEEEENDHAA.seant@webreply.com>

With a little bit of help from Grisha, I got past my first problem (I needed
a writable req.uri)
and am onto a second one.

I stripped out the following handlers from a much larger system, and they
reproduce the problem.
The production handler (handler) attempts to do a lookup_uri on the inbound
URI. If there is no translation handler
called for in the conf file, all is well, and the lookup works.

If there is a translation handler declared using PythonTransHandler, the
Transhandler gets called twice,
and the server process appears to go into a loop -- never exits the
production handler. I'm suspecting
that there is a reentrancy issue here of some sort, but the Apache code
specifically suggests calling lookup_uri() to
get the mapping of "/" to filename, instead of using document_root().

Comments on the rules of when one can and can't call lookup_uri() would be
welcome.

-- Sean


Configuration:

# Connections for general test site
<VirtualHost www.foo.com>
    DocumentRoot /usr/local/apache/htdocs/www.foo.com
    ServerName www.foo.com
    AddHandler python-program .phtml
    PythonInterpreter xphtml
    PythonHandler phtml.xphtml
    PythonTransHandler phtml.xphtml
</VirtualHost>


xphtml.py:



from mod_python import apache
from phtmllog import log, logIO

def transhandler(req):
    log("transhandler "+`req.uri`)
    return apache.DECLINED

def handler(req):
    log("lookup_uri "+req.lookup_uri(req.uri).filename)
    return apache.OK


requestobject.c code for lookup_uri:

/**
 ** request.lookup_uri(request self, uri)
 **
 *    An interface to the ap_lookup_uri function.
 */

static PyObject * req_lookup_uri(requestobject *self, PyObject *args)
{
  const char *uri;
  request_rec *req;


  if (! PyArg_ParseTuple(args, "s", &uri))
    return NULL;

  req = (request_rec *)ap_sub_req_lookup_uri(uri,self->request_rec);
  if (! req) {
    Py_INCREF(Py_None);
    return Py_None;
  }
  else {
    return MpRequest_FromRequest(req);
  }
}


...


    {"lookup_uri",           (PyCFunction) req_lookup_uri,
METH_VARARGS},
    { NULL, NULL } /* sentinel */
};

...




From vincentwong at ionetbiz.com  Sat Jul  7 12:34:35 2001
From: vincentwong at ionetbiz.com (Vincent Wong)
Date: Fri Jan  9 21:59:00 2004
Subject: [mod_python] link to image files broken
References: <014901c10542$3c018ec0$3f00a8c0@ns1.ionetbiz.com><012801c105e3$833099c0$3f00a8c0@ns1.ionetbiz.com> <uhewqiev1.fsf@cs.uu.nl>
Message-ID: <001b01c1069e$206e8d40$3f00a8c0@ns1.ionetbiz.com>

Thanks.  I have make it work.  This is what I did.

--- test.py ---

import os, sys
from mod_python import apache

def saveform(req):
  input = open('/home/demo/html/thanks.html', 'r')
  req.write(input.read())
  return apache.OK


--- thanks.html ---

add the line:

<base href="http://demo.ionetbiz2.com/">


A question here:  the open statement above does not work with relative path,
why?



Regards,
Vincent




From vincentwong at ionetbiz.com  Sat Jul  7 13:10:30 2001
From: vincentwong at ionetbiz.com (Vincent Wong)
Date: Fri Jan  9 21:59:00 2004
Subject: [mod_python] link to image files broken
Message-ID: <003601c106a3$2805f700$3f00a8c0@ns1.ionetbiz.com>

Thanks.  I have make it work.  This is what I did.

--- test.py ---

import os, sys
from mod_python import apache

def saveform(req):
  input = open('/home/demo/html/thanks.html', 'r')
  req.write(input.read())
  return apache.OK


--- thanks.html ---

add the line:

<base href="http://demo.ionetbiz2.com/">


A question here:  the open statement above does not work with relative path,
why?



Regards,
Vincent



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010707/76bd17c3/attachment-0002.htm
From wart at softhome.net  Sat Jul  7 13:03:10 2001
From: wart at softhome.net (Wartan Hachaturow)
Date: Fri Jan  9 21:59:00 2004
Subject: [mod_python] link to image files broken
In-Reply-To: <003601c106a3$2805f700$3f00a8c0@ns1.ionetbiz.com>
Message-ID: <20010707130310.A9632@penguin.aktivist.ru>

On Sat, Jul 07, 2001 at 01:10:30PM +0800, Vincent Wong wrote:

> A question here:  the open statement above does not work with relative path,
> why?

Because it opens the file from the filesystem, and not the one 
served by the web server.

-- 
Regards, Wartan.
echo "Your stdio isn't very std." 
		-- Larry Wall in Configure from the perl distribution

From kees.serier at relan.nl  Sat Jul  7 11:48:09 2001
From: kees.serier at relan.nl (Serier, Kees)
Date: Fri Jan  9 21:59:00 2004
Subject: [mod_python] ld error when trying to build mod-python
Message-ID: <AA2536FEE0A9D311887000508B5EDF1E0219634B@ab00s003.abab.cadans.nl>

Hi,

I'm trying to build mod_python 2.7.5 on AIX, but get the following error
from ld, any ideas or hints?

ld: 0711-244 ERROR: No csects or exported symbols have been saved.
apxs:Break: Command failed with rc=8

Kees Serier mailto:kees.serier@ordina.nl

General information:
   AIX        4.2.1
   GCC        2.95.2 (locally build and installed from source)
   GNU-make   3.79.1 (locally build and installed from source)
   Python     2.0    (locally build from source without threads)
   Apache     1.3.20 (locally build and installed from source with DSO)
   Mod_python 2.7.5

This is the output of configure and make;

[/usr/local/src/mod_python-2.7.5]# ./configure
--with-apxs=/usr/local/apache/bin/apxs --with-apache=../apache_1.3.20
--with-python=../Python-2.0/
creating cache ./config.cache
checking for gcc... gcc
checking whether the C compiler (gcc  ) works... yes
checking whether the C compiler (gcc  ) is a cross-compiler... no
checking whether we are using GNU C... yes
checking whether gcc accepts -g... yes
checking for ranlib... ranlib
checking for ar... ar
checking for a BSD compatible install... ./install-sh -c
checking whether make sets ${MAKE}... yes
checking for main in -lm... yes
checking for working const... yes
checking your blood pressure... a bit high, but we can proceed
checking whether apxs is available
checking for --with-apxs... /usr/local/apache/bin/apxs executable, good
checking for Apache libexec directory... /usr/local/apache/libexec
checking for Apache include directory... -I/usr/local/apache/include
checking for --with-apache... /usr/local/src/apache_1.3.20
checking for --with-python... /usr/local/src/Python-2.0
checking for python... /usr/local/src/Python-2.0/python
checking Python version... 2.0
checking whether Python is compiled with thread support... no threads, good
checking Python install prefix... /usr/local
checking what libraries Python was linked with...
/usr/local/src/Python-2.0/libpython2.0.a   -ldl    -lm
checking linker flags used to link Python...  -Wl,-bE:python.exp -lld
checking where Python include files are... -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include
checking for mkdep... no
checking for makedepend... /usr/bin/X11/makedepend
updating cache ./config.cache
creating ./config.status
creating Makefile
creating src/Makefile
creating src/libpython.module
creating Doc/Makefile
analyzing dependencies
sant[/usr/local/src/mod_python-2.7.5]= gmake
gmake[1]: Entering directory `/usr/local/src/mod_python-2.7.5/src'
gcc  -I/usr/local/src/mod_python-2.7.5/src/include
-I/usr/local/src/apache_1.3.20/src/include
-I/usr/local/src/apache_1.3.20/src/os/unix -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include    -c -o mod_python.o mod_python.c
gcc  -I/usr/local/src/mod_python-2.7.5/src/include
-I/usr/local/src/apache_1.3.20/src/include
-I/usr/local/src/apache_1.3.20/src/os/unix -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include    -c -o _apachemodule.o _apachemodule.c
gcc  -I/usr/local/src/mod_python-2.7.5/src/include
-I/usr/local/src/apache_1.3.20/src/include
-I/usr/local/src/apache_1.3.20/src/os/unix -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include    -c -o requestobject.o requestobject.c
gcc  -I/usr/local/src/mod_python-2.7.5/src/include
-I/usr/local/src/apache_1.3.20/src/include
-I/usr/local/src/apache_1.3.20/src/os/unix -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include    -c -o tableobject.o tableobject.c
gcc  -I/usr/local/src/mod_python-2.7.5/src/include
-I/usr/local/src/apache_1.3.20/src/include
-I/usr/local/src/apache_1.3.20/src/os/unix -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include    -c -o util.o util.c
gcc  -I/usr/local/src/mod_python-2.7.5/src/include
-I/usr/local/src/apache_1.3.20/src/include
-I/usr/local/src/apache_1.3.20/src/os/unix -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include    -c -o serverobject.o serverobject.c
gcc  -I/usr/local/src/mod_python-2.7.5/src/include
-I/usr/local/src/apache_1.3.20/src/include
-I/usr/local/src/apache_1.3.20/src/os/unix -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include    -c -o connobject.o connobject.c

Compiling for DSO. For static, do "make static"

/usr/local/apache/bin/apxs -I/usr/local/src/mod_python-2.7.5/src/include
-I/usr/local/src/apache_1.3.20/src/include
-I/usr/local/src/apache_1.3.20/src/os/unix -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include -c mod_python.o _apachemodule.o
requestobject.o tableobject.o util.o serverobject.o connobject.o  -lm
/usr/local/src/Python-2.0/libpython2.0.a   -ldl    -lm  
ld -H512 -T512 -bhalt:4 -bM:SRE -bnoentry
-bI:/usr/local/apache/libexec/httpd.exp -lc -o mod_python.so mod_python.o
_apachemodule.o requestobject.o tableobject.o util.o serverobject.o
connobject.o -lm /usr/local/src/Python-2.0/libpython2.0.a -ldl -lm
ld: 0711-244 ERROR: No csects or exported symbols have been saved.
apxs:Break: Command failed with rc=8
gmake[1]: *** [mod_python.so] Error 1
gmake[1]: Leaving directory `/usr/local/src/mod_python-2.7.5/src'
gmake: *** [do_dso] Error 2


From WAGLET at uk.ibm.com  Tue Jul 10 17:24:57 2001
From: WAGLET at uk.ibm.com (Tushar Wagle)
Date: Fri Jan  9 21:59:01 2004
Subject: [mod_python] database access within handler problem
Message-ID: <OFA5D85E79.491D0EC1-ON80256A85.00569389@portsmouth.uk.ibm.com>

Hello,

I've got mod_python up and running, but am having a problem connecting to 
my database from inside an AuthenHandler. The code runs fine outside
of mod_python under the 'apache' user, ie the user name/password is
okay, and I've correctly set permissions to allow the user database 
access.

I'm using the latest Python/mod_python with DB2 (and the Python DB2 
wrapper).

Any ideas of what might be wrong?

Are there some restrictions on what can be done (eg different user 
permissions)
from within an Apache Handler??

Could this be a configuration problem?...

Any help appreciated! :)

Best Regards,
Tushar.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010710/e0ad1c98/attachment-0002.htm
From laprice at efn.org  Tue Jul 10 14:51:34 2001
From: laprice at efn.org (larry a price)
Date: Fri Jan  9 21:59:01 2004
Subject: [mod_python] ModPython problems
In-Reply-To: <B770C6FE.38FB%tr@outputlinks.com>
Message-ID: <Pine.GSU.4.21.0107101432040.2738-100000@garcia.efn.org>

Hi, i'm trying to get WebWare 0.5 working with mod_python
i keep on getting this ImportError: module _apache not found
when trying to launch the ModPythonAppServer,
mod_python seems to work fine on it's own, the only thing i can see is
that there is no _apachemodule.so in lib-dynload, though there is an
_apachemodule.o in the build directory from which i installed mod_python,
can i just cp and rename that file or do i need to grovel through the
MakeFile and make sure that it's built as a shared library.

I'm running:
apache 1.3
mod_python 2.7.3
Webware 0.5
on
Debian 2.2.19pre17

Larry Price      |  "We have seen the truth.
laprice@efn.org  |   And the truth makes no sense." -chesterton
_______________________________________________________________





From ChuckEsterbrook at yahoo.com  Tue Jul 10 18:32:25 2001
From: ChuckEsterbrook at yahoo.com (Chuck Esterbrook)
Date: Fri Jan  9 21:59:01 2004
Subject: [mod_python] Re: [Webware-discuss] ModPython problems
In-Reply-To: <Pine.GSU.4.21.0107101432040.2738-100000@garcia.efn.org>
References: <B770C6FE.38FB%tr@outputlinks.com>
Message-ID: <5.0.2.1.0.20010710182905.027669f0@mail.mindspring.com>

At 02:51 PM 7/10/2001 -0700, larry a price wrote:
>Hi, i'm trying to get WebWare 0.5 working with mod_python
>i keep on getting this ImportError: module _apache not found
>when trying to launch the ModPythonAppServer,
>mod_python seems to work fine on it's own, the only thing i can see is
>that there is no _apachemodule.so in lib-dynload, though there is an
>_apachemodule.o in the build directory from which i installed mod_python,
>can i just cp and rename that file or do i need to grovel through the
>MakeFile and make sure that it's built as a shared library.
>
>I'm running:
>apache 1.3
>mod_python 2.7.3
>Webware 0.5
>on
>Debian 2.2.19pre17

I'm sorry to say I don't know the answer to your question, but I'm 
wondering if you really want to run the ModPythonAppServer, as opposed to 
the ModPython adapter which connects to a separately launched app server. 
That is the usual technique (e.g., your choice of adapter, plus the WebKit 
app server) used to run WebKit, because you can then restart the app server 
separate from the web server.

You should consider embedding the app server inside a web server to be more 
experimental, and I suppose the docs should reflect that.

In any case, it might help with diagnosing your problem if you could try 
the ModPythonAdapter and see if that suffers the same problems.


-Chuck


From laprice at efn.org  Tue Jul 10 15:59:49 2001
From: laprice at efn.org (larry a price)
Date: Fri Jan  9 21:59:01 2004
Subject: [mod_python] Re: [Webware-discuss] ModPython problems
In-Reply-To: <5.0.2.1.0.20010710182905.027669f0@mail.mindspring.com>
Message-ID: <Pine.GSU.4.21.0107101547330.5384-100000@garcia.efn.org>

On Tue, 10 Jul 2001, Chuck Esterbrook wrote:
> 
> I'm sorry to say I don't know the answer to your question, but I'm 
> wondering if you really want to run the ModPythonAppServer, as opposed to 
> the ModPython adapter which connects to a separately launched app server. 
> That is the usual technique (e.g., your choice of adapter, plus the WebKit 
> app server) used to run WebKit, because you can then restart the app server 
> separate from the web server.
>
OK, i did get the Webkit.cgi to work and the ModPythonAdapter seems to
work, does the correct redirect, I guess i was under the impression from
the docs that ModPythonAdapter 'required' ModPythonAppserver to work
correctly. Since that's not the case I'm not sure i understand why
ModPythonAppServer exists... it doesn't look like it enables any 
additional functionality. (aside from diddling the apache API)
the import _apache failure still bugs me though (anyone on the mod_python
front who can offer their wisdom?)


From ChuckEsterbrook at yahoo.com  Tue Jul 10 19:13:01 2001
From: ChuckEsterbrook at yahoo.com (Chuck Esterbrook)
Date: Fri Jan  9 21:59:01 2004
Subject: [mod_python] Re: [Webware-discuss] ModPython problems
In-Reply-To: <Pine.GSU.4.21.0107101547330.5384-100000@garcia.efn.org>
References: <5.0.2.1.0.20010710182905.027669f0@mail.mindspring.com>
Message-ID: <5.0.2.1.0.20010710191019.02ca79a0@mail.mindspring.com>

At 03:59 PM 7/10/2001 -0700, larry a price wrote:
>OK, i did get the Webkit.cgi to work and the ModPythonAdapter seems to
>work, does the correct redirect, I guess i was under the impression from
>the docs that ModPythonAdapter 'required' ModPythonAppserver to work
>correctly. Since that's not the case I'm not sure i understand why
>ModPythonAppServer exists... it doesn't look like it enables any
>additional functionality. (aside from diddling the apache API)
>the import _apache failure still bugs me though (anyone on the mod_python
>front who can offer their wisdom?)

Most WebKit app server flavors run as separate Python processes launched 
from the command line:

python Launch.py ThreadedAppServer


But ModPythonAppServer is special: He lives *inside* Apache/mod_python. 
That also means he needs no adapter to shuttle requests and responses 
between himself and the web server.

Presumably this reduces the overhead of having the web and app server talk 
via TCP/IP for greater performance. However, you probably also get multiple 
child process versions of your app server which could easily confound your 
application logic at the very least. And the inability to restart the app 
server independently (as I mentioned earlier).

ModPythonAppServer is due to be moved to an Experimental/ subdirectory.


-Chuck


From jal at faxnet.com  Wed Jul 11 14:22:23 2001
From: jal at faxnet.com (Jonathan LaCour)
Date: Fri Jan  9 21:59:01 2004
Subject: [mod_python] SOAP Handler questions...
Message-ID: <994875744.20546.1.camel@dev7>

Hello,

I am a developer working at a small software company, and we are
researching using mod_python to help us in making a fast SOAP server.
All of the SOAP implementations that I can find use either the built in
Python HTTPServer (which is slow) or Medusa (which has other issues that
I would like to avoid).

Has someone out there developed a Handler for mod_python that would
allow me to easily provide SOAP web services?  If so, please let me know
where I can find the handler.  If not, I would consider developing this
myself.  I just don't want to re-invent the wheel here =)

Thanks in advance!  Also note that I am not subscribed to this list, so
please CC your resposes to me.

Jonathan LaCour



From rsalz at zolera.com  Wed Jul 11 15:12:01 2001
From: rsalz at zolera.com (Rich Salz)
Date: Fri Jan  9 21:59:01 2004
Subject: [mod_python] SOAP Handler questions...
References: <994875744.20546.1.camel@dev7>
Message-ID: <3B4CA501.5ED2429E@zolera.com>

> Has someone out there developed a Handler for mod_python that would
> allow me to easily provide SOAP web services?

ZSI, the Zolera Soap Infrastructure, can work this way -- that's how we
use it (and why we wrote it :).  I believe the ActZero SOAP.py
(pywebsvcs.sf.net) can also work under mod_python.  Both are open
source; ZSI will be released in a week or two
(www.zolera.com/resources/opensrc); documentation is avail at the
referenced link.
	/r$
-- 
Zolera Systems, Securing Web services (XML, SOAP, Signatures,
Encryption)
http://www.zolera.com

From jonas.b at home.se  Thu Jul 12 03:50:29 2001
From: jonas.b at home.se (Jonas Bengtsson)
Date: Fri Jan  9 21:59:01 2004
Subject: [mod_python] Problems getting mod_python up n' running
Message-ID: <NEBBLNLDOLDEJIKDPCBOCEBHCEAA.jonas.b@home.se>

Hi,
I can't get mod_python to work. I get this error message when I'm restarting
Apache:
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
And when I try to look at a .py page I get following error:
[Thu Jul 12 03:33:12 2001] [error] [client 127.0.0.1] python_handler:
make_obcallback returned no obCallBack!

What is wrong?
I've got: Apache/1.3.19 (Win32) mod_python/2.7.4 Python/2.1
Running under Windows 2000

I have put mod_python.dll.in E:\program\apache\modules and following rows to
httpd.conf:
#DSO section
LoadModule python_module e:/program/apache/modules/mod_python.dll
#under my main directory
    AddHandler python-program .py
    PythonHandler mptest
    PythonDebug on

Furthermore I have put following files under
e:\program\python21\libs\mod_python:
__init__.py
apache.py
cgihandler.py
httpdapi.py
publisher.py
util.py
zhandler.py

And my environment path contains:
E:\Program\Python21;e:\Program\Python21\libs


What can be the problem?

TIA
Jonas Bengtsson



From mhughe at ucalgary.ca  Wed Jul 11 22:41:49 2001
From: mhughe at ucalgary.ca (Matt Hughes)
Date: Fri Jan  9 21:59:01 2004
Subject: [mod_python] patch for default functions in the publisher handler (fwd)
Message-ID: <Pine.A41.4.10.10107112241270.125366-200000@acs4.acs.ucalgary.ca>

This is sort of a follow up to this message:
http://www.modpython.org/pipermail/mod_python/2001-June/001421.html, which
discussed how to call a default function from a file using the publisher
handler. 

I wanted similar functionality, but didn't want to resort to the redirect
directive suggested in the last message of that thread. This patch looks
for the PATH_INFO as before, but instead of raising an
apache.HTTP_NOT_FOUND, it puts "default" in func_path as the default
function to call. 

The default function could be made a configuration directive, but I
haven't investigated that. 

This patch also solves some problems I was having when importing modules
in sub-directories. I had a structure like this:

/
/subdir1
/subdir1/subdir2
/subdir1/subdir2/subdir3

and so on, with each directory containing a index.py file which is
configured as the index with the DirectoryIndex directive. The problem was
that a URL refering to /subdir1/subdir2/subdir3 or whatever always found
the index.py file in /. 

This patch fixes this by treating directories off the root as packages.
It's a compelete hack, but it works for me. 


//
// Matt Hughes
// http://www.ucalgary.ca/~mhughe
//

-------------- next part --------------
--- orig-pub.py	Mon Jul  9 20:43:40 2001
+++ publisher.py	Mon Jul  9 20:53:26 2001
@@ -65,6 +65,8 @@
 
 import new
 
+import sys
+
 # list of suffixes - .py, .pyc, etc.
 suffixes = map(lambda x: x[0], imp.get_suffixes())
 
@@ -81,10 +83,11 @@
 
     # get the path PATH_INFO (everthing after script)
     if not _req.subprocess_env.has_key("PATH_INFO"):
-        raise apache.SERVER_RETURN, apache.HTTP_NOT_FOUND
-    
-    func_path = _req.subprocess_env["PATH_INFO"][1:] # skip fist /
-    func_path = string.replace(func_path, "/", ".")
+        func_path = "default"  # Call for a default method
+    else:
+        func_path = _req.subprocess_env["PATH_INFO"][1:] # skip fist /
+        func_path = string.replace(func_path, "/", ".")
+        
     if func_path[-1] == ".":
         func_path = func_path[:-1] 
 
@@ -118,11 +121,19 @@
     # add req
     args["req"] = req
 
-    # import the script
-    path, module_name =  os.path.split(_req.filename)
+    l = len(sys.path[0])
+    module_name = _req.filename[l:]
 
-    # get rid of the suffix
+    # get rid of the suffix... 
     module_name = suff_matcher.sub("", module_name)
+
+    # An alternate way to get rid of the suffix
+    #pos = string.rfind(module_name, '.')
+    #module_name = module_name[:pos]      
+
+    module_name = string.replace(module_name, '/', '.')
+
+    path = _req.filename[0:l]
 
     # import module (or reload if needed)
     module = apache.import_module(module_name, _req, [path])
From Daryl.Johnson at RebusHR.com  Thu Jul 12 14:52:46 2001
From: Daryl.Johnson at RebusHR.com (Daryl.Johnson@RebusHR.com)
Date: Fri Jan  9 21:59:01 2004
Subject: [mod_python] Problems with apxs
Message-ID: <DDA89578AFB4D411AF4700B0D068618C0802BA@PSN004>

I have RedHat 6.2, Apache 1.3.20 and Python2.1.
I have downloaded mod_python-2.7.5.
I have compiled Apache with DSO support and compiled Python without thread
support.
I am unable to compile mod_python as a DSO.
apxs reports an error - rc=255.
I have re-arranged the parameters to apxs but only seem able to get two
responses from it.  It either displays its short help text or reports back
with - rc=255.  Any ideas?  I am at the end of my tether.

Thanks in advance
Daryl Johnson
(RebusHR)


From piet at cs.uu.nl  Thu Jul 12 23:26:32 2001
From: piet at cs.uu.nl (Piet van Oostrum)
Date: Fri Jan  9 21:59:01 2004
Subject: [mod_python] Problems getting mod_python up n' running
In-Reply-To: "Jonas Bengtsson"'s message of "Thu, 12 Jul 2001 03:50:29 +0200"
References: <NEBBLNLDOLDEJIKDPCBOCEBHCEAA.jonas.b@home.se>
Message-ID: <wz66cxrg8n.fsf@sunshine.cs.uu.nl>

>>>>> "Jonas Bengtsson" <jonas.b@home.se> (JB) writes:

JB> Furthermore I have put following files under
JB> e:\program\python21\libs\mod_python:

That should be in e:\program\python21\mod_python

JB> And my environment path contains:
JB> E:\Program\Python21;e:\Program\Python21\libs

You mean PATH? The last part is not necessary.

JB> What can be the problem?

See above.
-- 
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl

From jonas.b at home.se  Thu Jul 12 23:38:11 2001
From: jonas.b at home.se (Jonas Bengtsson)
Date: Fri Jan  9 21:59:01 2004
Subject: [mod_python] Problems getting mod_python up n' running
In-Reply-To: <wz66cxrg8n.fsf@sunshine.cs.uu.nl>
Message-ID: <NEBBLNLDOLDEJIKDPCBOAEBICEAA.jonas.b@home.se>

Thanks... now I got rid off the :
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.

But : [Thu Jul 12 23:30:34 2001] [error] [client 127.0.0.1] python_handler:
make_obcallback returned no obCallBack!
Still occurs... any ideas


/Jonas Bengtsson

-----Original Message-----
From: piet@cs.uu.nl [mailto:piet@cs.uu.nl]
Sent: Thursday, July 12, 2001 11:27 PM
To: Jonas Bengtsson
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Problems getting mod_python up n' running

>>>>> "Jonas Bengtsson" <jonas.b@home.se> (JB) writes:

JB> Furthermore I have put following files under
JB> e:\program\python21\libs\mod_python:

That should be in e:\program\python21\mod_python

JB> And my environment path contains:
JB> E:\Program\Python21;e:\Program\Python21\libs

You mean PATH? The last part is not necessary.

JB> What can be the problem?

See above.
--
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl


From Daryl.Johnson at RebusHR.com  Fri Jul 13 11:08:12 2001
From: Daryl.Johnson at RebusHR.com (Daryl.Johnson@RebusHR.com)
Date: Fri Jan  9 21:59:01 2004
Subject: [mod_python] Problems getting mod_python up n' running
Message-ID: <DDA89578AFB4D411AF4700B0D068618C0802BD@PSN004>

I was getting messages very similar to these right up until yesterday.
Although I'm using Linux and you are using Windows, I think the problem
might stem from the same thing.
Mine turned out to be a linker problem when mod_python.so (I think .dll in
your case) was being built.
The mod_python.so file was only half the size that it is now that it is
working.
It was about 700Kb and is now about 1.5Mb.  These sizes might be different
on Windows, but it is clear to me that mod_python.so had not linked in a
whole sack of libraries that it would need.
I hope this is of some help

Daryl Johnson.

-----Original Message-----
From: Jonas Bengtsson [mailto:jonas.b@home.se]
Sent: Thursday, July 12, 2001 10:38 PM
To: piet@cs.uu.nl
Cc: mod_python@modpython.org
Subject: RE: [mod_python] Problems getting mod_python up n' running


Thanks... now I got rid off the :
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.

But : [Thu Jul 12 23:30:34 2001] [error] [client 127.0.0.1] python_handler:
make_obcallback returned no obCallBack!
Still occurs... any ideas


/Jonas Bengtsson

-----Original Message-----
From: piet@cs.uu.nl [mailto:piet@cs.uu.nl]
Sent: Thursday, July 12, 2001 11:27 PM
To: Jonas Bengtsson
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Problems getting mod_python up n' running

>>>>> "Jonas Bengtsson" <jonas.b@home.se> (JB) writes:

JB> Furthermore I have put following files under
JB> e:\program\python21\libs\mod_python:

That should be in e:\program\python21\mod_python

JB> And my environment path contains:
JB> E:\Program\Python21;e:\Program\Python21\libs

You mean PATH? The last part is not necessary.

JB> What can be the problem?

See above.
--
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python

From grisha at modpython.org  Fri Jul 13 11:14:07 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:01 2004
Subject: [mod_python] Error: No such file or directory
In-Reply-To: <Pine.LNX.4.31.0107031247070.13943-100000@unity.copyleft.no>
Message-ID: <Pine.BSF.4.32.0107131113440.94495-100000@localhost>

I've added a FAQ entry on this one:

http://www.modpython.org/FAQ/faqw.py?req=all#2.3

Grisha

On Tue, 3 Jul 2001, Hr. Daniel Mikkelsen wrote:

> >> OSError: [Errno 2] No such file or directory: '/home/demo/cgi-bin/test.p'
>
> > Have a closer look at the filename.  I think this is a typo.
>
> I don't know if it's the same thing here, but I'm running FreeBSD, and
> mod_python erranously cuts the last character of filename of the handler
> I've given. I had to remove a [:-1] suffix a couple of places in apache.py
> (I think) to get it to work.
>
> I'll post more details if it's interesting to anyone.
>
> -- Daniel Mikkelsen, Copyleft Software AS
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From jonas.b at home.se  Fri Jul 13 19:33:57 2001
From: jonas.b at home.se (Jonas Bengtsson)
Date: Fri Jan  9 21:59:01 2004
Subject: [mod_python] Problems getting mod_python up n' running
In-Reply-To: <DDA89578AFB4D411AF4700B0D068618C0802BD@PSN004>
Message-ID: <NEBBLNLDOLDEJIKDPCBOGEBKCEAA.jonas.b@home.se>

I don't think that is the problem in my case. My mod_python.dll is about 45
kb and that seems normal

Does any one else have a clue? I'm about to look elsewhere for Python
support in Apache... mod_python seems to work very poorly under Windows.


Jonas Bengtsson

-----Original Message-----
From: Daryl.Johnson@RebusHR.com [mailto:Daryl.Johnson@RebusHR.com]
Sent: Friday, July 13, 2001 12:08 PM
To: jonas.b@home.se
Cc: mod_python@modpython.org
Subject: RE: [mod_python] Problems getting mod_python up n' running

I was getting messages very similar to these right up until yesterday.
Although I'm using Linux and you are using Windows, I think the problem
might stem from the same thing.
Mine turned out to be a linker problem when mod_python.so (I think .dll in
your case) was being built.
The mod_python.so file was only half the size that it is now that it is
working.
It was about 700Kb and is now about 1.5Mb.  These sizes might be different
on Windows, but it is clear to me that mod_python.so had not linked in a
whole sack of libraries that it would need.
I hope this is of some help

Daryl Johnson.

-----Original Message-----
From: Jonas Bengtsson [mailto:jonas.b@home.se]
Sent: Thursday, July 12, 2001 10:38 PM
To: piet@cs.uu.nl
Cc: mod_python@modpython.org
Subject: RE: [mod_python] Problems getting mod_python up n' running


Thanks... now I got rid off the :
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.

But : [Thu Jul 12 23:30:34 2001] [error] [client 127.0.0.1] python_handler:
make_obcallback returned no obCallBack!
Still occurs... any ideas


/Jonas Bengtsson

-----Original Message-----
From: piet@cs.uu.nl [mailto:piet@cs.uu.nl]
Sent: Thursday, July 12, 2001 11:27 PM
To: Jonas Bengtsson
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Problems getting mod_python up n' running

>>>>> "Jonas Bengtsson" <jonas.b@home.se> (JB) writes:

JB> Furthermore I have put following files under
JB> e:\program\python21\libs\mod_python:

That should be in e:\program\python21\mod_python

JB> And my environment path contains:
JB> E:\Program\Python21;e:\Program\Python21\libs

You mean PATH? The last part is not necessary.

JB> What can be the problem?

See above.
--
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python


From piet at cs.uu.nl  Fri Jul 13 21:48:40 2001
From: piet at cs.uu.nl (Piet van Oostrum)
Date: Fri Jan  9 21:59:01 2004
Subject: [mod_python] Problems getting mod_python up n' running
In-Reply-To: "Jonas Bengtsson"'s message of "Fri, 13 Jul 2001 19:33:57 +0200"
References: <NEBBLNLDOLDEJIKDPCBOGEBKCEAA.jonas.b@home.se>
Message-ID: <wz4rsgmwyv.fsf@sunshine.cs.uu.nl>

>>>>> "Jonas Bengtsson" <jonas.b@home.se> (JB) writes:

JB> I don't think that is the problem in my case. My mod_python.dll is about 45
JB> kb and that seems normal

JB> Does any one else have a clue? I'm about to look elsewhere for Python
JB> support in Apache... mod_python seems to work very poorly under Windows.

That is not true. However you must be careful to install it properly:
- use the correct version of the dll (corresponding to the python version)
- put the dll in the Apache module directory
- add the LoadModule clause to Apache's config file
- add the handler declaration to Apache's config
- put the .py files n the proper Python directory
-- 
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl

From jonas.b at home.se  Sat Jul 14 11:19:50 2001
From: jonas.b at home.se (Jonas Bengtsson)
Date: Fri Jan  9 21:59:01 2004
Subject: [mod_python] Problems getting mod_python up n' running
In-Reply-To: <wz4rsgmwyv.fsf@sunshine.cs.uu.nl>
Message-ID: <NEBBLNLDOLDEJIKDPCBOGEBLCEAA.jonas.b@home.se>

Ahh... Now I got it to work. It wasn't the environment PATH variable that I
should change but the PythonPath variable in the Registry.

Now I get the following error:
"""
Mod_python error: "PythonHandler mptest"

Traceback (most recent call last):

  File "e:\program\python21\mod_python\apache.py", line 181, in Dispatch
    module = import_module(module_name, _req)

  File "e:\program\python21\mod_python\apache.py", line 335, in
import_module
    f, p, d = imp.find_module(parts[i], path)

ImportError: No module named mptest
"""
But I have not looked into it to see why this occurs so I guess it is just
something trivial..

Thanks for all help!

/Jonas B

-----Original Message-----
From: piet@cs.uu.nl [mailto:piet@cs.uu.nl]
Sent: Friday, July 13, 2001 9:49 PM
To: Jonas Bengtsson
Cc: Daryl.Johnson@RebusHR.com; mod_python@modpython.org
Subject: Re: [mod_python] Problems getting mod_python up n' running

>>>>> "Jonas Bengtsson" <jonas.b@home.se> (JB) writes:

JB> I don't think that is the problem in my case. My mod_python.dll is about
45
JB> kb and that seems normal

JB> Does any one else have a clue? I'm about to look elsewhere for Python
JB> support in Apache... mod_python seems to work very poorly under Windows.

That is not true. However you must be careful to install it properly:
- use the correct version of the dll (corresponding to the python version)
- put the dll in the Apache module directory
- add the LoadModule clause to Apache's config file
- add the handler declaration to Apache's config
- put the .py files n the proper Python directory
--
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl


From piet at cs.uu.nl  Sun Jul 15 16:11:44 2001
From: piet at cs.uu.nl (Piet van Oostrum)
Date: Fri Jan  9 21:59:01 2004
Subject: [mod_python] Problems getting mod_python up n' running
In-Reply-To: "Jonas Bengtsson"'s message of "Sat, 14 Jul 2001 11:19:50 +0200"
References: <NEBBLNLDOLDEJIKDPCBOGEBLCEAA.jonas.b@home.se>
Message-ID: <wzsnfygu3j.fsf@sunshine.cs.uu.nl>

>>>>> "Jonas Bengtsson" <jonas.b@home.se> (JB) writes:

JB> Ahh... Now I got it to work. It wasn't the environment PATH variable that I
JB> should change but the PythonPath variable in the Registry.

In fact, if you put the files in the subdirectory mod_python of your main
Python directory, this is not necessary. Anyway, the libs directory is the
wrong one, because it is meant for .lib files (which you only need if you
compile python extensions).

JB> Now I get the following error:
JB> """
JB> Mod_python error: "PythonHandler mptest"

JB> Traceback (most recent call last):

JB>   File "e:\program\python21\mod_python\apache.py", line 181, in Dispatch
JB>     module = import_module(module_name, _req)

JB>   File "e:\program\python21\mod_python\apache.py", line 335, in
JB> import_module
JB>     f, p, d = imp.find_module(parts[i], path)

JB> ImportError: No module named mptest
JB> """
JB> But I have not looked into it to see why this occurs so I guess it is just
JB> something trivial..

It probably means that mptest.py is not in the directory that is mentioned
as the PythonHandler in your Apache config file. Maybe you gave it another
name. 
-- 
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl

From tree at basistech.com  Tue Jul 17 15:54:07 2001
From: tree at basistech.com (Tom Emerson)
Date: Fri Jan  9 21:59:01 2004
Subject: [mod_python] Import errors in 2.7.5
Message-ID: <15188.38879.991539.849967@cymru.basistech.com>

I'm repeatedly getting an error using mod_python 2.7.5, Python 2.0
with exceptions patch, Apache 1.3.19, on FreeBSD 4.2:

ue Jul 17 16:29:46 2001] [error] PythonHandler mod_python.publisher: Traceback (most recent call last):
[Tue Jul 17 16:29:46 2001] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.0/site-packages/mod_python/apache.py", line 193, in Dispatch
    result = object(req)
[Tue Jul 17 16:29:46 2001] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.0/site-packages/mod_python/publisher.py", line 128, in handler
    module = apache.import_module(module_name, _req, [path])
[Tue Jul 17 16:29:46 2001] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.0/site-packages/mod_python/apache.py", line 364, in import_module
    module = reload(module)
[Tue Jul 17 16:29:46 2001] [error] PythonHandler mod_python.publisher: ImportError: No module named add

I have to shutdown the server and start it back up to make this go
away, at which point things are fine for a while, then it comes
back. Suffice it to say this is annoying.

Before I start digging, has anyone else seen this? I never saw this in
2.7.1 (the previous version I had installed).

TIA,

    -tree

-- 
Tom Emerson                                          Basis Technology Corp.
Sr. Sinostringologist                              http://www.basistech.com
  "Beware the lollipop of mediocrity: lick it once and you suck forever"

From a_mayerson at yahoo.com  Tue Jul 17 20:12:05 2001
From: a_mayerson at yahoo.com (aaron mayerson)
Date: Fri Jan  9 21:59:01 2004
Subject: [mod_python] Function sequence error
Message-ID: <20010718031205.98105.qmail@web10906.mail.yahoo.com>

Greetings,

  I have a script that works from the command line but
not with mod_python and apache.  I've looked elsewhere
and found that this error relates to the odbc calls
being called out of order.
  I'm not exactly sure why the heck the calls would be
out of order when running through mod_python and
apache and not when run from the command line. 
Anybody have a clue as to why this is happening?
  Thanks for the help...

The error:

Mod_python error: "PythonHandler stats"

Traceback (most recent call last):

  File "d:\python21\lib\mod_python\apache.py", line
181, in Dispatch

  File "d:\python21\lib\mod_python\apache.py", line
364, in import_module

  File "c:/program files/apache
group/apache/htdocs/python/\stats.py", line 7, in ?
    db = mx.DriverConnect('DSN=stats')

InternalError: ('S1010', 0, '[Microsoft][ODBC Driver
Manager] Function sequence error', 5806)

The code:

import sping.PIL as pid
import mx.ODBC.Windows as mx
from os import chdir



db = mx.DriverConnect('DSN=stats')
cur = db.cursor()
cur.execute('select * from address_count')
values = cur.fetchall()
cur.close()
db.close()

hits = 0
for value in values:
    hits += value[1]

canvas = pid.PILCanvas(size=(600,
(len(values)*15)+15))
canvas.defaultLineWidth = 7.5
canvas.defaultLineColor = pid.red
y1 = 15
x1 = 100
y2 = 15
for value in values:
    x2 = 100 + (3000 * (float(value[1])/hits))
    canvas.drawLine(x1, y1, x2, y2)
    canvas.drawString(value[0], 5, (y1+2.5),
pid.Font(face="monospaced",size=10),
                      color=pid.black)
    canvas.drawString(str(value[1]), (x2+10),
(y1+2.5), pid.Font(face="monospaced",size=10),
                      color=pid.black)
    y1 += 15
    y2 += 15

canvas.flush()
chdir(r'c:\program files\apache
group\apache\htdocs\python')
canvas.save('hits', format='gif')

__________________________________________________
Do You Yahoo!?
Get personalized email addresses from Yahoo! Mail
http://personal.mail.yahoo.com/

From garyp at asti-usa.com  Wed Jul 18 16:10:51 2001
From: garyp at asti-usa.com (Gary Perez)
Date: Fri Jan  9 21:59:01 2004
Subject: [mod_python] Dispatch() returned nothing (?)
Message-ID: <3B55ED4A.63051A14@asti-usa.com>

Hi, all.

Looking forward to getting this working... either that or it's back to
Zope! ;)

Here's the installation info:
SuSE Linux 7.2, kernel 2.4.4, reiserfs
Apache 1.3.19 + Python 2.0 + mod_python 2.7.2

(Note: I attempted to install mod_python 2.7.5 from source, and that
completely hosed Apache, so I went back to the YAST2-based 2.7.2 installation.)

I'm stuck at the "2.4 Testing" section; Apache is throwing an internal
server error on attempt to load http://localhost/test/mptest.py . Here
are pieces of the relevant files:

ERROR LOG
[Wed Jul 18 15:58:02 2001] [notice] Apache/1.3.19 (Unix)  (SuSE/Linux)
mod_layout/1.0 mod_throttle/3.0 mod_fastcgi/2.2.2 mod_ssl/2.8.3
OpenSSL/0.9.6a PHP/4.0.4pl1 mod_perl/1.25 mod_dtcl mod_python/2.7.2
Python/2.0 configured -- resuming normal operations
[Wed Jul 18 15:58:02 2001] [notice] suEXEC mechanism enabled (wrapper: /usr/sbin/suexec)
[Wed Jul 18 15:58:18 2001] [error] [client 192.168.100.100]
python_handler: Dispatch() returned nothing.

HTTPD.CONF
<Directory "/usr/local/httpd/htdocs/test">
    AddHandler python-program .py
    PythonHandler mptest
    PythonDebug On
    AllowOverride All
</Directory>

.HTACCESS
AddHandler python-program .py
PythonHandler mptest
PythonDebug On

I also tried it without the "AllowOverride" line in httpd.conf and no
.htaccess file in the directory, but it throws the same error.

Any ideas as to what I'm doing wrong? Thanks in advance for your help!
-Gary

From mikael.johansson at sema.se  Thu Jul 19 13:52:10 2001
From: mikael.johansson at sema.se (Mikael Johansson)
Date: Fri Jan  9 21:59:01 2004
Subject: [mod_python] Compiling problem.
Message-ID: <01c201c11049$3e77f330$036716ac@got.sema.se>

Hello everyone.

I have a problem to include pyhton into my apache configuration.

I'm running HP-UX Ver 11.0

I have downloade apache 1.13.12

I have downloaded and installed Python 1.5.2 (configure, make and make install)

I have downloded mod_python 2.7.5 and have run configure, make and make install... 

No problem so fare... (not so many anyway..)

My problem is when I go back to Apache and run..

./configure --activate-module=src/modules/python/libpython.a

It runs whith no error, after that I try to the small command make, output below, any Ideas ? 

=== cut ==

<=== src/modules

cc -c -I./os/unix -I./include -DHPUX11 -Aa -Ae -D_HPUX_SOURCE -DUSE_HSREGEX -DUSE_EXPAT -I./lib/expat-lite -DNO_DL_NEEDEc

cc -c -I./os/unix -I./include -DHPUX11 -Aa -Ae -D_HPUX_SOURCE -DUSE_HSREGEX -DUSE_EXPAT -I./lib/expat-lite -DNO_DL_NEEDEc

cc -DHPUX11 -Aa -Ae -D_HPUX_SOURCE -DUSE_HSREGEX -DUSE_EXPAT -I./lib/expat-lite -DNO_DL_NEEDED `./apaci` \

-o httpd buildmark.o modules.o modules/python/libpython.a modules/standard/libstandard.a main/libmain.a ./os/unixd

/usr/ccs/bin/ld: Unsatisfied symbols:

PyObject_HasAttrString (code)

PyString_AsString (code)

PyModule_GetDict (code)

Py_OptimizeFlag (data)

PyThreadState_Delete (code)

PyExc_TypeError (data)

PySequence_Index (code)

PyDict_New (code)

PyCObject_AsVoidPtr (code)

PyImport_ImportModule (code)

PyCObject_FromVoidPtr (code)

_PyString_Resize (code)

PyErr_Fetch (code)

PyObject_Str (code)

PyList_Size (code)

PyString_ConcatAndDel (code)

PyDict_GetItem (code)

PyDict_SetItem (code)

Py_BuildValue (code)

PyEval_SaveThread (code)

PyCallable_Check (code)

PyObject_CallMethod (code)

PyExc_IndexError (data)

PyErr_NoMemory (code)

Py_FindMethod (code)

PyTuple_SetItem (code)

PyMember_Set (code)

PyDict_GetItemString (code)

PyMapping_HasKeyString (code)

PyErr_NewException (code)

PyList_New (code)

PyList_SetItem (code)

PyExc_AttributeError (data)

PyObject_CallFunction (code)

PyErr_Print (code)

PyInt_Type (data)

PyType_Type (data)

PyObject_GetAttrString (code)

PyThreadState_Swap (code)

PyErr_Occurred (code)

PyString_Type (data)

PyDict_SetItemString (code)

PyThreadState_New (code)

PyString_FromString (code)

PyMember_Get (code)

Py_Initialize (code)

PyInt_AsLong (code)

PyExc_ValueError (data)

PyEval_RestoreThread (code)

PyErr_BadArgument (code)

PyArg_ParseTuple (code)

Py_IsInitialized (code)

Py_NewInterpreter (code)

PyExc_KeyError (data)

PyExc_IOError (data)

PyList_Append (code)

PyString_FromStringAndSize (code)

Py_InitModule4 (code)

PyErr_SetObject (code)

PyList_SetSlice (code)

PyErr_Clear (code)

Py_Finalize (code)

_Py_NoneStruct (data)

PyErr_SetString (code)

Py_GetVersion (code)

PyInt_FromLong (code)

PyTuple_New (code)

*** Error exit code 1

Stop.

*** Error exit code 1

Stop.

*** Error exit code 1

Stop.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010719/390bb364/attachment-0002.htm
From markus.hillebrand at apis-group.net  Thu Jul 19 13:57:54 2001
From: markus.hillebrand at apis-group.net (markus.hillebrand@apis-group.net)
Date: Fri Jan  9 21:59:01 2004
Subject: [mod_python] mod_python + MySQLdb => does it work?
Message-ID: <XFMail.010719135754.markus.hillebrand@apis.intra>


 Hello to all you out there!

I tried to bring mod_python and MySQLdb together,
but I crashed on some problems.

First of all: mod_python runs quite fine.
Also MySQLdb runs quite well.

But when I try to import MySQLdb from a python-script
that was invoked by mod_python I get a

ImportError: _mysql: init failed 
(whole error message is in the attachement)

System: Linux 6.4(i386) - Kernel 2.2.14(4)
        apache 1.3.19
        Python 2.0
        mod_python 2.7.5
        MySQLdb 0.9.0

Has somebody out there a running system like this?
Would be very helpfull to bring mod_python and MySQLdb
together - or is there another solution to access
a MySQL database?

        Bye, Markus        

-- 
Markus Hillebrand, Dipl.Inf.(FH), Software-Engineer
Apis networks GmbH, Kronstadter Str. 11, 81677 Muenchen, Germany
Tel.: +49 (089) 357147-23 ; eMail: markus.hillebrand@apis-group.net
-------------- next part --------------
A non-text attachment was scrubbed...
Name: error.html
Type: application/octet-stream
Size: 639 bytes
Desc: error.html
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20010719/6957c32e/error-0002.obj
From tree at basistech.com  Thu Jul 19 07:37:26 2001
From: tree at basistech.com (Tom Emerson)
Date: Fri Jan  9 21:59:01 2004
Subject: [mod_python] mod_python + MySQLdb => does it work?
In-Reply-To: <XFMail.010719135754.markus.hillebrand@apis.intra>
References: <XFMail.010719135754.markus.hillebrand@apis.intra>
Message-ID: <15190.50806.775640.191120@cymru.basistech.com>

markus.hillebrand@apis-group.net writes:
> I tried to bring mod_python and MySQLdb together,
> but I crashed on some problems.

This works very well.

> First of all: mod_python runs quite fine.
> Also MySQLdb runs quite well.
> 
> But when I try to import MySQLdb from a python-script
> that was invoked by mod_python I get a
> 
> ImportError: _mysql: init failed 
> (whole error message is in the attachement)

Check your Python load path within mod_python, and make sure that the
directory containing the MySQLdb modules is there. Also make sure that
the MySQLdb shared object can be found in the library search path.


-- 
Tom Emerson                                          Basis Technology Corp.
Sr. Sinostringologist                              http://www.basistech.com
  "Beware the lollipop of mediocrity: lick it once and you suck forever"

From markus.hillebrand at apis-group.net  Thu Jul 19 14:47:07 2001
From: markus.hillebrand at apis-group.net (markus.hillebrand@apis-group.net)
Date: Fri Jan  9 21:59:01 2004
Subject: [mod_python] mod_python + MySQLdb => does it work?
In-Reply-To: <15190.50806.775640.191120@cymru.basistech.com>
Message-ID: <XFMail.010719144707.markus.hillebrand@apis.intra>

On 19-Jul-01 Tom Emerson wrote:
> markus.hillebrand@apis-group.net writes:
>> I tried to bring mod_python and MySQLdb together,
>> but I crashed on some problems.
> 
> This works very well.
Fine to hear that, so my tries are making sense ;)

>> First of all: mod_python runs quite fine.
>> Also MySQLdb runs quite well.
>> 
>> But when I try to import MySQLdb from a python-script
>> that was invoked by mod_python I get a
>> 
>> ImportError: _mysql: init failed 
>> (whole error message is in the attachement)
> 
> Check your Python load path within mod_python, and make sure that the
> directory containing the MySQLdb modules is there. Also make sure that
> the MySQLdb shared object can be found in the library search path.

I did this already and I created a script,
that I started with mod_python and I called

oRequest.write( str( imp.find_module("MySQLdb"))) 
  Result:(None,'/opt/<...>/site-packages/MySQLdb' , ('', '',5))

oRequest.write( str( imp.find_module("_mysql")))
  Result:(,'/opt/<...>/sitepackages/_mysql.so', ('.so', 'rb',3))

I think I have another problem. But which one?
Maybe my special configuration does not work,
may you tell me yours, Tom?

-- 
Markus Hillebrand, Dipl.Inf.(FH), Software-Engineer
Apis networks GmbH, Kronstadter Str. 11, 81677 Muenchen, Germany
Tel.: +49 (089) 357147-23 ; eMail: markus.hillebrand@apis-group.net

From tree at basistech.com  Thu Jul 19 08:51:34 2001
From: tree at basistech.com (Tom Emerson)
Date: Fri Jan  9 21:59:01 2004
Subject: [mod_python] mod_python + MySQLdb => does it work?
In-Reply-To: <XFMail.010719144707.markus.hillebrand@apis.intra>
References: <15190.50806.775640.191120@cymru.basistech.com>
	<XFMail.010719144707.markus.hillebrand@apis.intra>
Message-ID: <15190.55254.949564.915370@cymru.basistech.com>

markus.hillebrand@apis-group.net writes:
> I did this already and I created a script,
> that I started with mod_python and I called

I'm currently running the following setup:

FreeBSD 4.2-RELEASE, with recent security updates
Apache 1.3.19
  PHP/4.0.4pl1
  mod_python/2.7.5
  Python/2.0 (with patch for the exception problem)
MySQL 3.23.37
MySQLdb, 2000-11-30 release

Does your server errorlog or machine's messages log give any clues as
to why the failure is happening? Do you have more than one Python
installation on the machine? I had problems with this in the past.

Otherwise I'm stumped.

-- 
Tom Emerson                                          Basis Technology Corp.
Sr. Sinostringologist                              http://www.basistech.com
  "Beware the lollipop of mediocrity: lick it once and you suck forever"

From tree at basistech.com  Thu Jul 19 09:06:47 2001
From: tree at basistech.com (Tom Emerson)
Date: Fri Jan  9 21:59:01 2004
Subject: [mod_python] mod_python mailing list archive issue
Message-ID: <15190.56167.224323.751981@cymru.basistech.com>

The link to download the full raw archive of the mod_python mailing
list doesn't work for me: can anyone else get the whole lot of
messages?

-- 
Tom Emerson                                          Basis Technology Corp.
Sr. Sinostringologist                              http://www.basistech.com
  "Beware the lollipop of mediocrity: lick it once and you suck forever"

From tree at basistech.com  Thu Jul 19 09:16:14 2001
From: tree at basistech.com (Tom Emerson)
Date: Fri Jan  9 21:59:01 2004
Subject: [mod_python] More on import errors in 2.7.5
Message-ID: <15190.56734.977727.647366@cymru.basistech.com>

A couple of days ago I posted a question about strange import
behaviors with 2.7.5,

<http://www.modpython.org/pipermail/mod_python/2001-July/001519.html>

I haven't heard from anyone with a solution, though scanning the
archives it appears that this has been an issue for a while for some
people. So I started digging.

The short: the problem is still there.

The long:

- I reverted to 2.7.2 and the problem is still there. <sigh>

- I added some log_error() calls in various places in both publisher.py
  and apache.py to verify the state of the world upto the point
  apache.py attempts to reload the module. As far as I can tell,
  everything is valid up to the point of the reload call: sys.modules
  includes an entry for the module I'm reloading, the pathnames to the
  module are correct, everything looks fine, but reload() is throwing
  an ImportError.

  I observed that this problem usually happens in the following
  scenario:

  1) The module is loaded successfully.
  2) You make a modification to the module source which causes
     mod_python to reload the module. This works fine.
  3) You make another modification to the module that will cause an
     error when the module is being parsed when it is reloaded.
  4) You fix the error and reload.
  5) Bam, ImportError.

  Could it be the case that the module is partially initialized and
  isn't really reloadable?

Also, FWIW, the server doesn't have write access to the directory
containing these modules, so the .pyc files are not being created.

Food for thought.

    -tree

-- 
Tom Emerson                                          Basis Technology Corp.
Sr. Sinostringologist                              http://www.basistech.com
  "Beware the lollipop of mediocrity: lick it once and you suck forever"

From Alain.Tesio at actfs.fr  Thu Jul 19 16:02:50 2001
From: Alain.Tesio at actfs.fr (Alain.Tesio@actfs.fr)
Date: Fri Jan  9 21:59:01 2004
Subject: [mod_python] mod_python + MySQLdb => does it work
Message-ID: <OFA20499D4.3F551BBF-ONC1256A8E.004C5B52@actfs.fr>

Hi, it works for me on Linux Debian with Python 2.1, MySQLdb and mod_python
installed from source.

If it works when starting python from a shell, it means that the there is
something
missing in the environment of the user running apache.

Maybe try one of these commands to add this before "import MySQLdb" :

sys.path.append("/path/where/is/mysqldb")
os.environ["LD_LIBRARY_PATH"]="/path/to/the/shared/object"

Alain





______________________________________________________________________________


The views and opinions expressed in this email message are the sender's and
do not necessarily represent the views and opinions of ACT Financial
Systems S.A.
______________________________________________________________________________




From markus.hillebrand at apis-group.net  Thu Jul 19 18:50:32 2001
From: markus.hillebrand at apis-group.net (markus.hillebrand@apis-group.net)
Date: Fri Jan  9 21:59:01 2004
Subject: [mod_python] mod_python + MySQLdb => does it work? YES!
In-Reply-To: <XFMail.010719135754.markus.hillebrand@apis.intra>
Message-ID: <XFMail.010719185032.markus.hillebrand@apis.intra>

On 19-Jul-01 markus.hillebrand@apis-group.net wrote:
> 
>  Hello to all you out there!
> 
> I tried to bring mod_python and MySQLdb together,
> but I crashed on some problems.

Okay, after playing around with all these
pathes and settings ... I recompiled 
the python-component v2.1.1c1 --without-threads
And what shall I say. Now it works fine.
I'm quite happy now (until the next problem occurs).

Thanx to all of you.
-- 
Markus Hillebrand, Dipl.Inf.(FH), Software-Engineer
Apis networks GmbH, Kronstadter Str. 11, 81677 Muenchen, Germany
Tel.: +49 (089) 357147-23 ; eMail: markus.hillebrand@apis-group.net

From mikael.johansson at sema.se  Fri Jul 20 09:38:56 2001
From: mikael.johansson at sema.se (Mikael Johansson)
Date: Fri Jan  9 21:59:02 2004
Subject: [mod_python] (no subject)
Message-ID: <003601c110ef$08b93c30$036716ac@got.sema.se>

Any Ideas for my installation problem ?   

HPUX 11.0, Pyhton 1.5., Mod_Pyhton 2.7.5

/MiJo/

================cut=========================



root@gotuh03> ./configure --with-apxs=/opt/apache/bin/apxs

loading cache ./config.cache

checking for gcc... no

checking for cc... cc

checking whether the C compiler (cc ) works... yes

checking whether the C compiler (cc ) is a cross-compiler... no

checking whether we are using GNU C... no

checking whether cc accepts -g... yes

checking for ranlib... ranlib

checking for ar... ar

checking for a BSD compatible install... /opt/imake/bin/install -c

checking whether make sets ${MAKE}... yes

checking for main in -lm... yes

checking for working const... yes

checking your blood pressure... a bit high, but we can proceed

checking whether apxs is available

checking for --with-apxs... /opt/apache/bin/apxs executable, good

checking for Apache libexec directory... /opt/apache/libexec

checking for Apache include directory... -I/opt/apache/include

checking for --with-apache... no

configure: warning: **** No apache sources specified, static compilation will not be available.

configure: warning: **** You can use --with-apache to specify where your Apache sources are.

checking for --with-python... no

checking for python... /usr/local/bin/python

checking Python version... 1.5

checking whether Python is compiled with thread support... no threads, good

checking Python install prefix... /usr/local

checking what libraries Python was linked with... /usr/local/lib/python1.5/config/libpython1.5.a -lnet -lnsl -ldld -lm 

checking linker flags used to link Python... 

checking where Python include files are... -I/usr/local/include/python1.5

checking for mkdep... no

checking for makedepend... /opt/imake/bin/makedepend

updating cache ./config.cache

creating ./config.status

creating Makefile

creating src/Makefile

creating src/libpython.module

creating Doc/Makefile

analyzing dependencies





root@gotuh03> make dso

Compiling for DSO. For static, do "make static"

/opt/apache/bin/apxs -I/opt/install/mod_python-2.7.5/src/include -I/opt/apache/include -I/usr/local/include/python1.5 -c mo 

ld -b -o mod_python.so mod_python.o _apachemodule.o requestobject.o tableobject.o util.o serverobject.o connobject.o -lm /usr/local 

ld: Invalid loader fixup in text space needed in output file for symbol "$000000B1" in input file "/usr/local/lib/python1.5/config/"

apxs:Break: Command failed with rc=65536

*** Error exit code 1

Stop.

*** Error exit code 1

Stop.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010720/6b0783f9/attachment-0002.htm
From polygnwnd at yahoo.com  Tue Jul 24 20:20:06 2001
From: polygnwnd at yahoo.com (polygnwnd)
Date: Fri Jan  9 21:59:02 2004
Subject: [mod_python] example test fails-- how to convince apache to search the correct path for python modules?
Message-ID: <20010725032006.88880.qmail@web12507.mail.yahoo.com>

Well, I am interested in mod_python, but am having a
hard time getting it to work. I notice
that my specific problem has come up on both Windows
and Linux and I cannot find a working
solution in the mail archives (maybe I overlooked
something?). 

What I "know"...

Platform: Linux 2.4 kernel, atop old, but vanilla
Debian

All packages used here are installed below
/home/polygnwnd/httpd:
  Python: python/2.0.1/(bin, lib, etc.)
  Apache: apache/1.3.20/(bin,libexec, etc.)

Configured options:
  Python: --without-threads
  Apache: --enable-module=rewrite
--enable-shared=rewrite
  mod_python:
--with-apxs=/home/polygnwnd/httpd/apache/1.3.20/bin/apxs
\
             
--with-python=/home/polygnwnd/src/httpd/python/2.0.1
              # I pointed with-python to the python
src build dir, makes configure happy

An strace on the httpd process reveals many
unsuccessful attempts to access
the system python library. The result:

  stat("/usr/lib/python2.0/mod_python", 0xbfffeaec) =
-1 ENOENT (No such file or directory)
  open("/usr/lib/python2.0/mod_python.so", O_RDONLY) =
-1 ENOENT (No such file or directory)
  open("/usr/lib/python2.0/mod_pythonmodule.so",
O_RDONLY) = -1 ENOENT (No such file or directory)
  open("/usr/lib/python2.0/mod_python.py", O_RDONLY) =
-1 ENOENT (No such file or directory)
  open("/usr/lib/python2.0/mod_python.pyc", O_RDONLY)
= -1 ENOENT (No such file or directory)
  stat("/usr/lib/python2.0/plat-linux2/mod_python",
0xbfffeaec) = -1 ENOENT (No such file or directory)
  open("/usr/lib/python2.0/plat-linux2/mod_python.so",
O_RDONLY) = -1 ENOENT (No such file or directory)
 
open("/usr/lib/python2.0/plat-linux2/mod_pythonmodule.so",
O_RDONLY) = -1 ENOENT (No such file or directory)
  open("/usr/lib/python2.0/plat-linux2/mod_python.py",
O_RDONLY) = -1 ENOENT (No such file or directory)
 
open("/usr/lib/python2.0/plat-linux2/mod_python.pyc",
O_RDONLY) = -1 ENOENT (No such file or directory)
  stat("/usr/lib/python2.0/lib-tk/mod_python",
0xbfffeaec) = -1 ENOENT (No such file or directory)
  stat("/usr/lib/python2.0/site-packages/mod_python",
0xbfffeaec) = -1 ENOENT (No such file or directory)
 
open("/usr/lib/python2.0/site-packages/mod_python.so",
O_RDONLY) = -1 ENOENT (No such file or directory)
 
open("/usr/lib/python2.0/site-packages/mod_pythonmodule.so",
O_RDONLY) = -1 ENOENT (No such file or directory)
 
open("/usr/lib/python2.0/site-packages/mod_python.py",
O_RDONLY) = -1 ENOENT (No such file or directory)
 
open("/usr/lib/python2.0/site-packages/mod_python.pyc",
O_RDONLY) = -1 ENOENT (Nosuch file or directory)
  write(2, "make_obcallback(): could not imp"..., 55)
= 55
  write(2, "make_obcallback(): could not cal"..., 40)
= 40
  time(NULL)                              = 996027790
  write(15, "[Wed Jul 25 03:23:10 2001] [erro"...,
115) = 115
  alarm(300)                              = 0
  alarm(0)                                = 300
  alarm(300)                              = 0
  alarm(0)                                = 300
  alarm(300)                              = 0
  alarm(0)                                = 300
  write(4, "HTTP/1.1 500 Internal Server Err"..., 843)
= 843

This is odd because my system python version is 1.5
and I have a special version in a private 
directory which I specified (as above) at compile
time.

grepping apache (incl. mod_python.so) and python
binaries for "/usr/lib" did not reveal anything of
immediate
interest. Recompiling with python 2.1 renders
essentially the same result (substitude "2.1" for
"2.0" in the
trace output).

The problem is obviously something like the PYTHONPATH
not being set properly. 

  -Setting the PythonPath (as was suggested in a prior
exchange) seems ineffective-- strace behaviour was not

   changed (in fact specifying an arbitrary string set
for the PythonPath directive did not appear in trace
output).
  
  -setting the PYTHONPATH variable in the shell before
starting httpd had no effect

  -using the specially compiled python shell to try
"from mod_python import apache" failed when it could
   not find the "_apache" module, leading me to
believe it did find the mod_python module. I did this
   experiment using the same permissions as httpd, and
have tried experimentally running httpd with my own 
   permissions without success.

The mod_python.so file is 2.7MB with python 2.0 and
1.5MB with 2.1, leading me to believe it is being
linked
properly-- I have scrutinized the build process for
errors and not seen anything interesting. Thus I find
myself
among the ranks of unhappy people looking at:

  [Wed Jul 25 04:03:20 2001] [info] Server built: Jul
25 2001 00:55:54
  make_obcallback(): could not import
mod_python.apache.
  make_obcallback(): could not call init.
  [Wed Jul 25 04:03:22 2001] [error] [client
192.168.0.0.2] python_handler: make_ob
  callback returned no obCallBack!

I look forward to being able to move out of
AOLserver-land (filters and threading are coming to
Apache. yay). 
Any clues?

cheers,
jamie



__________________________________________________
Do You Yahoo!?
Make international calls for as low as $.04/minute with Yahoo! Messenger
http://phonecard.yahoo.com/

From piet at cs.uu.nl  Wed Jul 25 11:09:47 2001
From: piet at cs.uu.nl (piet@cs.uu.nl)
Date: Fri Jan  9 21:59:02 2004
Subject: [mod_python] example test fails-- how to convince apache to search the correct path for python modules?
In-Reply-To: polygnwnd's message of "Tue, 24 Jul 2001 20:20:06 -0700 (PDT)"
References: <20010725032006.88880.qmail@web12507.mail.yahoo.com>
Message-ID: <uy9pd2x44.fsf@cs.uu.nl>

Can you start up an interactive session with your private python
interpreter and type the following:

import sys
print sys.path

I guess it will have /usr/lib/python2.0 in it.
If that is so, the this is where your python expects its modules.
-- 
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl


From riesch at nieuw.nl  Thu Jul 26 16:26:59 2001
From: riesch at nieuw.nl (riesch@nieuw.nl)
Date: Fri Jan  9 21:59:02 2004
Subject: [mod_python] Cookies
Message-ID: <20010726162659.A8236@godel>

Hi there,

I'm currently making a web-site with mod-python and since I want to make use of cookies, I was wondering how I can set a cookie.
I've been looking through the documentation provided on the web-site, but I'm not able to find something. So if anyone could give me pointer, or even better comething that works, I'd be much obliged.


Thanks ahead,
Richard

From bl at netgroup.dk  Thu Jul 26 16:54:26 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:59:02 2004
Subject: [mod_python] Cookies
References: <20010726162659.A8236@godel>
Message-ID: <3B602F22.17C6C7B8@netgroup.dk>

riesch@nieuw.nl wrote:

> I'm currently making a web-site with mod-python and since I want to make use of cookies, I was wondering how I can set a cookie.
> I've been looking through the documentation provided on the web-site, but I'm not able to find something. So if anyone could give me pointer, or even better comething that works, I'd be much obliged.

You find them in the header fields (headers_in / headers_out ) in the Request class.

If you like to set a cookie you do something like this :

    req.headers_out[ "Set-Cookie" ] = "my_session_id=42"

and the next time this user sends back a request back to you ( and if he support it) it will contain it in your input headers, and you will be able to fetch it like this :

    raw_cookie = req.headers_in[ "Cookie" ]

Now you only need to parse the input cookie string (raw_cookie), that have the syntax as descried in RFC-2109.

mod_python does not have any helper classes for either in- or outgoing cookies, but the format is strait forward, even I could make one :-)

Hope this helped

Regards

/BL


From CHagner at fool.com  Thu Jul 26 11:11:54 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:59:02 2004
Subject: [mod_python] Cookies
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E48053@rover.foolhq.com>

There's a module called Cookie which provides an Dictionary-like interface
to access the multiple cookies in a request.  In addition, each cookie class
has an output method that returns an HTTP-header-friendly string
("Set-Cookie: fig=newton").  The doc strings in Cookie.py give some pretty
good code examples.

In this module, a 'raw' cookie is called a morsel, so the terminology could
be a little confusing.

One warning though.  The Cookie module is only designed to handle a single
value for each cookie (i.e. "Set-Cookie: MyCookie=MyValue") .  Thus, if you
use a cookie to store more than one value (i.e. "Set-Cookie:
MyCookie=key1=value=&key2=value2&key3=value3"), you'll need to wrap Cookie
with your own class to handle the 'internal' values (or just build/parse the
value string yourself each time).

Chris

-----Original Message-----
From: Bo Lorentsen [mailto:bl@netgroup.dk]
Sent: Thursday, July 26, 2001 10:54 AM
To: riesch@nieuw.nl
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Cookies


riesch@nieuw.nl wrote:

> I'm currently making a web-site with mod-python and since I want to make
use of cookies, I was wondering how I can set a cookie.
> I've been looking through the documentation provided on the web-site, but
I'm not able to find something. So if anyone could give me pointer, or even
better comething that works, I'd be much obliged.

You find them in the header fields (headers_in / headers_out ) in the
Request class.

If you like to set a cookie you do something like this :

    req.headers_out[ "Set-Cookie" ] = "my_session_id=42"

and the next time this user sends back a request back to you ( and if he
support it) it will contain it in your input headers, and you will be able
to fetch it like this :

    raw_cookie = req.headers_in[ "Cookie" ]

Now you only need to parse the input cookie string (raw_cookie), that have
the syntax as descried in RFC-2109.

mod_python does not have any helper classes for either in- or outgoing
cookies, but the format is strait forward, even I could make one :-)

Hope this helped

Regards

/BL

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python

From garyp at asti-usa.com  Thu Jul 26 12:32:01 2001
From: garyp at asti-usa.com (Gary Perez)
Date: Fri Jan  9 21:59:02 2004
Subject: [mod_python] Try 2: python_handler: Dispatch() returned nothing
Message-ID: <3B604602.C7BC25E0@asti-usa.com>

Hi, all.

I've reinstalled apache, reinstalled Python (no threads), reinstalled
mod_python in hopes to clear this up. No dice. Does anyone have any suggestions?

Here's the dirt:
SuSE Linux 7.2, kernel 2.4.4, reiserfs
Apache 1.3.19 + Python 2.0 + mod_python 2.7.2

HTTPD.CONF
<Directory "/usr/local/httpd/htdocs/test">
    AddHandler python-program .py
    PythonHandler mptest
    PythonDebug On
</Directory>

The mptest.py module in "test" is the standard one from the
documentation (verified, no typos).

When I hit the URL (localhost/test/mptest.py) I get an internal server error:

ERROR LOG
[Wed Jul 18 15:58:02 2001] [notice] Apache/1.3.19 (Unix)  (SuSE/Linux)
mod_layout/1.0 mod_throttle/3.0 mod_fastcgi/2.2.2 mod_ssl/2.8.3
OpenSSL/0.9.6a PHP/4.0.4pl1 mod_perl/1.25 mod_dtcl mod_python/2.7.2
Python/2.0 configured -- resuming normal operations
[Wed Jul 18 15:58:02 2001] [notice] suEXEC mechanism enabled (wrapper: /usr/sbin/suexec)
[Wed Jul 18 15:58:18 2001] [error] [client 192.168.100.100]
python_handler: Dispatch() returned nothing.

Thanks in advance for your help.
-Gary

From jpareja at ntsp.nec.co.jp  Fri Jul 27 19:48:57 2001
From: jpareja at ntsp.nec.co.jp (Joel)
Date: Fri Jan  9 21:59:02 2004
Subject: [mod_python] Apache 2.x support
References: <200107261602.f6QG24G65883@eden.ispol.com>
Message-ID: <3B615529.2060207@ntsp.nec.co.jp>

Hello all,

       I am just starting to install mod_python. But the manual says 2.0 
not yet supported.
Is there a target date for a release that supports Apache 2.x.


Thank you.


From bl at netgroup.dk  Fri Jul 27 11:04:14 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:59:02 2004
Subject: [mod_python] Cookies
References: <13CDDE6A53DBD311BC3200508B6F0C4805E48053@rover.foolhq.com>
Message-ID: <3B612E8E.2BB63B3F@netgroup.dk>

Chris Hagner wrote:

> There's a module called Cookie which provides an Dictionary-like interface
> to access the multiple cookies in a request.  In addition, each cookie class
> has an output method that returns an HTTP-header-friendly string
> ("Set-Cookie: fig=newton").  The doc strings in Cookie.py give some pretty
> good code examples.

Ups sorry, I have only looked into the manual, maby its time to take a trip
into the mod_python code :-)

/BL


From CHagner at fool.com  Fri Jul 27 07:40:36 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:59:02 2004
Subject: [mod_python] Cookies
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E48060@rover.foolhq.com>

Cookie is a module within Python (not mod_python).  Is that what you mean?

http://www.python.org/doc/2.1.1/lib/module-Cookie.html

Chris

-----Original Message-----
From: Bo Lorentsen [mailto:bl@netgroup.dk]
Sent: Friday, July 27, 2001 5:04 AM
To: Chris Hagner
Cc: riesch@nieuw.nl; mod_python@modpython.org
Subject: Re: [mod_python] Cookies


Chris Hagner wrote:

> There's a module called Cookie which provides an Dictionary-like interface
> to access the multiple cookies in a request.  In addition, each cookie
class
> has an output method that returns an HTTP-header-friendly string
> ("Set-Cookie: fig=newton").  The doc strings in Cookie.py give some pretty
> good code examples.

Ups sorry, I have only looked into the manual, maby its time to take a trip
into the mod_python code :-)

/BL

From bl at netgroup.dk  Fri Jul 27 13:59:51 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:59:02 2004
Subject: [mod_python] usign the apache log ?
Message-ID: <3B6157B7.F05239DB@netgroup.dk>

Hi ...

I have been writing a system using this mod_python module, and it just
work out fine for me. Its really a nice Python tool, keep up the good
work. But (there is always a but :-)) I really like to be able to se
more about what is going in inside my code, and I therefor looked for a
way to write to the apache log file, but found nothing in mod_python.

In the O'reilly book "Writing Apache modules with Perl and C" they have
an example where they got a logger out of the Request class (or whatever
they call it i Perl :-)). This don't seem to be the case in mod_python,
and the only reference I could find to logging is the PythonLogHandler,
and that don't sound like anything I could use.

Is there something i have misunderstood, or is there a way do redirect
stdout/err to the log or something fancy like that ?

Thanks in advance !

/BL


From bl at netgroup.dk  Fri Jul 27 14:08:01 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:59:02 2004
Subject: [mod_python] Cookies
References: <13CDDE6A53DBD311BC3200508B6F0C4805E48060@rover.foolhq.com>
Message-ID: <3B6159A1.40AB4F73@netgroup.dk>

Chris Hagner wrote:

> Cookie is a module within Python (not mod_python).  Is that what you mean?

Ahh, I hav'nt seen it in the python lib. as I'm using a quite old Python
(1.5.2), to prevent to much update fun in the production env. ( we use
Debian/potato on the servers :-))

So much for code reuse :-)

Thanks anyway, yet a stone on the road to be a Python expert :-)

/BL


From CHagner at fool.com  Fri Jul 27 08:20:07 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:59:02 2004
Subject: [mod_python] Cookies
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E48061@rover.foolhq.com>

Fortunately, the Cookie module was actually developed completely independent
of the main Python distribution.  Thus, you should be able to find a copy of
Cookie.py and simply use that with Python 1.5.2.  This is what WebWare does
(or used to... not sure if they nixed their Cookie.py when it became a
standard Python module).  It's a pretty straight-forward module, so I
wouldn't be shocked if Cookie.py from a 2.0 distro works in 1.5.2.

Chris

-----Original Message-----
From: Bo Lorentsen [mailto:bl@netgroup.dk]
Sent: Friday, July 27, 2001 8:08 AM
To: Chris Hagner
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Cookies


Chris Hagner wrote:

> Cookie is a module within Python (not mod_python).  Is that what you mean?

Ahh, I hav'nt seen it in the python lib. as I'm using a quite old Python
(1.5.2), to prevent to much update fun in the production env. ( we use
Debian/potato on the servers :-))

So much for code reuse :-)

Thanks anyway, yet a stone on the road to be a Python expert :-)

/BL

From bl at netgroup.dk  Fri Jul 27 14:34:39 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:59:02 2004
Subject: [mod_python] Cookies
References: <13CDDE6A53DBD311BC3200508B6F0C4805E48061@rover.foolhq.com>
Message-ID: <3B615FDF.D0BED081@netgroup.dk>

Chris Hagner wrote:

> Fortunately, the Cookie module was actually developed completely independent
> of the main Python distribution.  Thus, you should be able to find a copy of
> Cookie.py and simply use that with Python 1.5.2.  This is what WebWare does
> (or used to... not sure if they nixed their Cookie.py when it became a
> standard Python module).  It's a pretty straight-forward module, so I
> wouldn't be shocked if Cookie.py from a 2.0 distro works in 1.5.2.

Look what I found ! Hope others may have good use of this too.

    http://starship.python.net/crew/jrush/Webbot

Thanks for the advise, I think I just will include this in my code, and be more
careful to search python.org before writing another parser :-)

/BL


From CHagner at fool.com  Fri Jul 27 08:45:16 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:59:02 2004
Subject: [mod_python] Cookies
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E48063@rover.foolhq.com>

Bo,

I would recommend that you instead go with the actual Cookie.py file that
has made it into the main Python distribution.  I started using it before it
was included (since it was a part of WebWare's libs) and was pleasantly
surprised when I found a Cookie.py in the 2.0 distro.  I was even more
surprised when I saw that the file was identical to the one that I had been
using. :)  Good karma I guess.

Chris

-----Original Message-----
From: Bo Lorentsen [mailto:bl@netgroup.dk]
Sent: Friday, July 27, 2001 8:35 AM
To: Chris Hagner
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Cookies


Chris Hagner wrote:

> Fortunately, the Cookie module was actually developed completely
independent
> of the main Python distribution.  Thus, you should be able to find a copy
of
> Cookie.py and simply use that with Python 1.5.2.  This is what WebWare
does
> (or used to... not sure if they nixed their Cookie.py when it became a
> standard Python module).  It's a pretty straight-forward module, so I
> wouldn't be shocked if Cookie.py from a 2.0 distro works in 1.5.2.

Look what I found ! Hope others may have good use of this too.

    http://starship.python.net/crew/jrush/Webbot

Thanks for the advise, I think I just will include this in my code, and be
more
careful to search python.org before writing another parser :-)

/BL

From miguel at yorku.ca  Fri Jul 27 08:54:41 2001
From: miguel at yorku.ca (Miguel Marques)
Date: Fri Jan  9 21:59:02 2004
Subject: [mod_python] usign the apache log ?
In-Reply-To: <3B6157B7.F05239DB@netgroup.dk>
References: <3B6157B7.F05239DB@netgroup.dk>
Message-ID: <20010727085441P.miguel@yorku.ca>

Greetings...
On Fri, 27 Jul 2001 13:59:51 +0200, Bo Lorentsen <bl@netgroup.dk> wrote:
> Hi ...
> 
> I have been writing a system using this mod_python module, and it just
> work out fine for me. Its really a nice Python tool, keep up the good
> work. But (there is always a but :-)) I really like to be able to se
> more about what is going in inside my code, and I therefor looked for a
> way to write to the apache log file, but found nothing in mod_python.
> 
> In the O'reilly book "Writing Apache modules with Perl and C" they have
> an example where they got a logger out of the Request class (or whatever
> they call it i Perl :-)). This don't seem to be the case in mod_python,
> and the only reference I could find to logging is the PythonLogHandler,
> and that don't sound like anything I could use.
> 
> Is there something i have misunderstood, or is there a way do redirect
> stdout/err to the log or something fancy like that ?
> 
> Thanks in advance !

4.3 apache - Access to Apache Internals.
http://www.modpython.org/live/mod_python-2.7.5/doc-html/module-apache.html

Specifically: log_error(message[, level, server])

							Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830

From bl at netgroup.dk  Fri Jul 27 15:02:14 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:59:02 2004
Subject: [mod_python] usign the apache log ?
References: <3B6157B7.F05239DB@netgroup.dk> <20010727085441P.miguel@yorku.ca>
Message-ID: <3B616656.A572E8F3@netgroup.dk>

Miguel Marques wrote:

> 4.3 apache - Access to Apache Internals.
> http://www.modpython.org/live/mod_python-2.7.5/doc-html/module-apache.html
>
> Specifically: log_error(message[, level, server])

Thanks, I guess I just was looking in the wrong direction.

/BL


From riesch at nieuw.nl  Fri Jul 27 15:15:58 2001
From: riesch at nieuw.nl (riesch@nieuw.nl)
Date: Fri Jan  9 21:59:02 2004
Subject: [mod_python] usign the apache log ?
In-Reply-To: <3B6157B7.F05239DB@netgroup.dk>; from bl@netgroup.dk on Fri, Jul 27, 2001 at 01:59:51PM +0200
References: <3B6157B7.F05239DB@netgroup.dk>
Message-ID: <20010727151558.B20191@godel>

hi there,


what you can do is write your own log-class. I've done something like this:


class Log:
   def __init__(self, file, mode):
      if __debug__:
         delf.__descriptor = open(file, mode)
   
   def __del__(self):
      self.close()

   def append(self, string):
      self.__descriptor.write(string + "\n\n")
      # add some more information if you please

   def close(self):
      self.__descriptor.close()


   # Variables
   __descriptor = []
#

global log
log = Log("log.txt")


When you import this module, the log-instance will be known and be the same for every file that imports this module (the global takes care of this) and every write (wherever) happens in the same file.
To write stuff:

import from Log *

log.append("something happened")


I hope this helps,
Richard

      


On Fri, Jul 27, 2001 at 01:59:51PM +0200, Bo Lorentsen wrote:
> Hi ...
> 
> I have been writing a system using this mod_python module, and it just
> work out fine for me. Its really a nice Python tool, keep up the good
> work. But (there is always a but :-)) I really like to be able to se
> more about what is going in inside my code, and I therefor looked for a
> way to write to the apache log file, but found nothing in mod_python.
> 
> In the O'reilly book "Writing Apache modules with Perl and C" they have
> an example where they got a logger out of the Request class (or whatever
> they call it i Perl :-)). This don't seem to be the case in mod_python,
> and the only reference I could find to logging is the PythonLogHandler,
> and that don't sound like anything I could use.
> 
> Is there something i have misunderstood, or is there a way do redirect
> stdout/err to the log or something fancy like that ?
> 
> Thanks in advance !
> 
> /BL
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

From rsalz at zolera.com  Fri Jul 27 09:53:12 2001
From: rsalz at zolera.com (Rich Salz)
Date: Fri Jan  9 21:59:02 2004
Subject: [mod_python] usign the apache log ?
References: <3B6157B7.F05239DB@netgroup.dk> <20010727151558.B20191@godel>
Message-ID: <3B617248.1F8AC4BF@zolera.com>

In mod_python sys.stderr is attached to the apache error log.
There is also a log_error method in the apache module (not sure what
version added it); see the docs -- it's like the ap_log_error()
function.

-- 
Zolera Systems, Your Key to Online Integrity
Securing Web services: XML, SOAP, Dig-sig, Encryption
http://www.zolera.com

From riesch at nieuw.nl  Mon Jul 30 13:55:00 2001
From: riesch at nieuw.nl (riesch@nieuw.nl)
Date: Fri Jan  9 21:59:02 2004
Subject: [mod_python] standard path
Message-ID: <20010730135500.A8125@godel>

Hi there,


I'm wondering. I now have setup for my apacha-server (httpd.conf) similar to the following:

<directory />
   SetHandler python-program
   PythonHandler main
   PythonDebug On
</directory>


The file with the mod-python handler (aka the entrance) now has to be placed in a standard path, which can be located by the python-interpreter. Now it isn't very attractive for me to use these paths. Is there a way around this. I've been trying something like:

PythonPath /home/user/site/

but this generated errors.

Any hints ?


Richard.

From riesch at nieuw.nl  Mon Jul 30 14:33:30 2001
From: riesch at nieuw.nl (riesch@nieuw.nl)
Date: Fri Jan  9 21:59:02 2004
Subject: [mod_python] standard path
In-Reply-To: <20010730135500.A8125@godel>; from riesch@nieuw.nl on Mon, Jul 30, 2001 at 01:55:00PM +0200
References: <20010730135500.A8125@godel>
Message-ID: <20010730143330.B8125@godel>

Sorry all,


I've already found the error of my ways :)
It should have been:


PythonPath "sys.path + ['/home/mysite/']"

I found it in the mod-python manual


Thanx again,
Richard

From bl at netgroup.dk  Tue Jul 31 10:19:06 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:59:02 2004
Subject: [mod_python] Internal_redirect ?
Message-ID: <3B6669FA.A18D4564@netgroup.dk>

Hi ...

I have been working on a larger site setup where I like to force a
redirection to a internal login page if user is unknown (cookie thing).

The only way of redirection I can find is the one described in the
mod_python FAQ, but this often gives a small annoying page telling the
user about a redirection, but what I want is to do it seamless to the
browser.

Now in the Apache doc, I found some info. about a function calls
"internal_redirect", that does exactly what I like to do, but its not
part of the mod_python API, or I cant find it, at least :-)

Have anyone a good hint for me at this point ?

Also, is it correct that its not possible to set a cookie together with
a redirect ?

Hopeful regards

/BL


From CHagner at fool.com  Tue Jul 31 09:13:26 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 21:59:02 2004
Subject: [mod_python] Internal_redirect ?
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E48089@rover.foolhq.com>

If I remember correctly, Grisha stated that this feature has been highly
requested (and is do-able) but has not yet been implemented.

Chris

-----Original Message-----
From: Bo Lorentsen [mailto:bl@netgroup.dk]
Sent: Tuesday, July 31, 2001 4:19 AM
To: mod_python list
Subject: [mod_python] Internal_redirect ?


Hi ...

I have been working on a larger site setup where I like to force a
redirection to a internal login page if user is unknown (cookie thing).

The only way of redirection I can find is the one described in the
mod_python FAQ, but this often gives a small annoying page telling the
user about a redirection, but what I want is to do it seamless to the
browser.

Now in the Apache doc, I found some info. about a function calls
"internal_redirect", that does exactly what I like to do, but its not
part of the mod_python API, or I cant find it, at least :-)

Have anyone a good hint for me at this point ?

Also, is it correct that its not possible to set a cookie together with
a redirect ?

Hopeful regards

/BL

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python

From miguel at yorku.ca  Tue Jul 31 09:39:07 2001
From: miguel at yorku.ca (Miguel Marques)
Date: Fri Jan  9 21:59:02 2004
Subject: [mod_python] Internal_redirect ?
In-Reply-To: <13CDDE6A53DBD311BC3200508B6F0C4805E48089@rover.foolhq.com>
References: <13CDDE6A53DBD311BC3200508B6F0C4805E48089@rover.foolhq.com>
Message-ID: <20010731093907E.miguel@yorku.ca>

Greetings...
On Tue, 31 Jul 2001 09:13:26 -0400, Chris Hagner <CHagner@fool.com> wrote:
> If I remember correctly, Grisha stated that this feature has been highly
> requested (and is do-able) but has not yet been implemented.
> 
> Chris
> 
> -----Original Message-----
> From: Bo Lorentsen [mailto:bl@netgroup.dk]
> Sent: Tuesday, July 31, 2001 4:19 AM
> To: mod_python list
> Subject: [mod_python] Internal_redirect ?
> 
> 
> Hi ...
> 
> I have been working on a larger site setup where I like to force a
> redirection to a internal login page if user is unknown (cookie thing).
> 
> The only way of redirection I can find is the one described in the
> mod_python FAQ, but this often gives a small annoying page telling the
> user about a redirection, but what I want is to do it seamless to the
> browser.
> 
> Now in the Apache doc, I found some info. about a function calls
> "internal_redirect", that does exactly what I like to do, but its not
> part of the mod_python API, or I cant find it, at least :-)
> 
> Have anyone a good hint for me at this point ?

With apache I do exactly what you are trying to accomplish by setting
a cookie in req.err_headers_out and returning apache.HTTP_FORBIDDEN.
Then in the apache configuration file you use 
ErrorDocument 403 http://yourloginpage 
in the directory/ies you are trying to protect...
Hope that helps...

						Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830

From bl at netgroup.dk  Tue Jul 31 15:54:47 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:59:02 2004
Subject: [mod_python] Internal_redirect ?
References: <13CDDE6A53DBD311BC3200508B6F0C4805E48089@rover.foolhq.com>
Message-ID: <3B66B8A7.FE84A88F@netgroup.dk>

Chris Hagner wrote:

> If I remember correctly, Grisha stated that this feature has been highly
> requested (and is do-able) but has not yet been implemented.

I will then sign up on this request :-)

/BL


From bl at netgroup.dk  Tue Jul 31 15:59:14 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 21:59:02 2004
Subject: [mod_python] Internal_redirect ?
References: <13CDDE6A53DBD311BC3200508B6F0C4805E48089@rover.foolhq.com> <20010731093907E.miguel@yorku.ca>
Message-ID: <3B66B9B2.8E549FA@netgroup.dk>

Miguel Marques wrote:

> With apache I do exactly what you are trying to accomplish by setting
> a cookie in req.err_headers_out and returning apache.HTTP_FORBIDDEN.
> Then in the apache configuration file you use
> ErrorDocument 403 http://yourloginpage
> in the directory/ies you are trying to protect...

Thats sweet, and the cookie will be set because its part of the
"err_headers_out" ?

> Hope that helps...

Thats a good hint and another interesting way of solving this problem.

Thanks, but I like to do it the propper way --- I think :-)

/BL


From miguel at yorku.ca  Tue Jul 31 10:02:10 2001
From: miguel at yorku.ca (Miguel Marques)
Date: Fri Jan  9 21:59:02 2004
Subject: [mod_python] Internal_redirect ?
In-Reply-To: <3B66B9B2.8E549FA@netgroup.dk>
References: <13CDDE6A53DBD311BC3200508B6F0C4805E48089@rover.foolhq.com>
	<20010731093907E.miguel@yorku.ca>
	<3B66B9B2.8E549FA@netgroup.dk>
Message-ID: <20010731100210L.miguel@yorku.ca>

Greetings...
On Tue, 31 Jul 2001 15:59:14 +0200, Bo Lorentsen <bl@netgroup.dk> wrote:
> Miguel Marques wrote:
> 
> > With apache I do exactly what you are trying to accomplish by setting
> > a cookie in req.err_headers_out and returning apache.HTTP_FORBIDDEN.
> > Then in the apache configuration file you use
> > ErrorDocument 403 http://yourloginpage
> > in the directory/ies you are trying to protect...
> 
> Thats sweet, and the cookie will be set because its part of the
> "err_headers_out" ?
Yes.

> 
> > Hope that helps...
> 
> Thats a good hint and another interesting way of solving this problem.
> 
> Thanks, but I like to do it the propper way --- I think :-)
I couldn't wait... 8-)

						Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830

From tree at basistech.com  Tue Jul 31 15:31:26 2001
From: tree at basistech.com (Tom Emerson)
Date: Fri Jan  9 21:59:02 2004
Subject: [mod_python] Patch to 2.7.5 for internal_redirect
In-Reply-To: <3B66B9B2.8E549FA@netgroup.dk>
References: <13CDDE6A53DBD311BC3200508B6F0C4805E48089@rover.foolhq.com>
	<20010731093907E.miguel@yorku.ca>
	<3B66B9B2.8E549FA@netgroup.dk>
Message-ID: <15207.1934.890865.157761@cymru.basistech.com>

Attached is a small patch to mod_python 2.7.5 which provides support
for doing an internal_redirect. I've only done minimal testing on this
but it appears to work.

I added a new method to the request object, internal_redirect. It
takes a single string argument which is the local URI to redirect
to. After calling this method your handler should just return
apache.OK.

  from mod_python import apache
 
  def handler(req):
      req.internal_redirect("/redirected.html")
      return apache.OK

I also added an exception class, InternalRedirect, to
mod_python.apache. It takes a single argument which is the local URI
to redirect to. This is used by a modification to Publisher which
allows you to perform an internal redirect simply by raising an
InternalRedirect exception:

  from mod_python import apache
 
  def test(req):
      raise apache.InternalRedirect("/redirected.html")

The request object's "main" member is None if the current request is
the "main" request.

Share and enjoy.

-------------- next part --------------
*** ./lib/python/mod_python/publisher.py.orig	Mon May 14 18:17:21 2001
--- ./lib/python/mod_python/publisher.py	Tue Jul 31 15:46:33 2001
***************
*** 168,174 ****
              if name not in expected:
                  del args[name]
  
!         result = apply(object, (), args)
  
      if result:
          result = str(result)
--- 168,178 ----
              if name not in expected:
                  del args[name]
  
!         try:
!             result = apply(object, (), args)
!         except apache.InternalRedirect, e:
!             req.internal_redirect(e.uri)
!             return apache.OK
  
      if result:
          result = str(result)
*** ./lib/python/mod_python/apache.py.orig	Tue Jul 31 16:00:17 2001
--- ./lib/python/mod_python/apache.py	Tue Jul 31 15:44:16 2001
***************
*** 53,58 ****
--- 53,63 ----
  import imp
  import types
  import _apache
+ import exceptions
+ 
+ class InternalRedirect (exceptions.Exception):
+     def __init__(self, uri):
+         self.uri = uri
  
  # a small hack to improve PythonPath performance. This
  # variable stores the last PythonPath in raw (unevaled) form.
*** ./src/requestobject.c.orig	Tue May 22 22:49:43 2001
--- ./src/requestobject.c	Tue Jul 31 15:08:21 2001
***************
*** 438,443 ****
--- 438,462 ----
  }
  
  /**
+  ** request.internal_redirect(request self, string uri)
+  **
+  *    An interface to the ap_internal_redirect function.
+  *    Tom Emerson, <tree@basistech.com>, 2001-07-31
+  */
+ static PyObject * req_internal_redirect(requestobject *self, PyObject *args)
+ {
+     char *uri;
+ 
+     if (! PyArg_ParseTuple(args, "s", &uri))
+         return NULL;
+ 
+     ap_internal_redirect(uri, self->request_rec);
+     
+     Py_INCREF(Py_None);
+     return Py_None;
+ }
+ 
+ /**
   ** request.get_options(request self)
   **
   */
***************
*** 792,797 ****
--- 811,817 ----
      {"get_dirs",             (PyCFunction) req_get_dirs,             METH_VARARGS},
      {"get_remote_host",      (PyCFunction) req_get_remote_host,      METH_VARARGS},
      {"get_options",          (PyCFunction) req_get_options,          METH_VARARGS},
+     {"internal_redirect",    (PyCFunction) req_internal_redirect,    METH_VARARGS},
      {"read",                 (PyCFunction) req_read,                 METH_VARARGS},
      {"readline",             (PyCFunction) req_readline,             METH_VARARGS},
      {"register_cleanup",     (PyCFunction) req_register_cleanup,     METH_VARARGS},
-------------- next part --------------

-- 
Tom Emerson                                          Basis Technology Corp.
Sr. Sinostringologist                              http://www.basistech.com
  "Beware the lollipop of mediocrity: lick it once and you suck forever"
From rekla_ma_ at publicist.com  Sun Jul  1 19:43:52 2001
From: rekla_ma_ at publicist.com (E-mail Reklama)
Date: Fri Jan  9 22:02:49 2004
Subject: [mod_python] =?windows-1251?Q?E-mail_-_=F0=E5=EA=EB=E0=EC=E0?=
Message-ID: <181362001701154352292@publicist.com>

????????????!

? ?????? ??????? ??????? ?? ????? ?? ?????? ??????????? ??????? ???? ???????, ? ??????? ?? ????? ???????????. ??? ????? ???????? ??????????? ???????? ????? ????????? ?????????? ?? ????????? ??????? ??????? (?? 30???. ?? 1???., ??? ?? ??????, ??? ? ?? ???? ?????? ? ???). ??????????? ?????????/?????? ??? ???? ????? ????? ??????.

?? ??????????????? ?????????? ???????????? ?????????? 4 ????. ???? ?????????? ??????? - ?????????? ????????? ????????, ??????? ????? ??????, ??? ????????????? e-mail ???????? ??-?? ?????? ?????? ????????? ?????????? ???? ? ???????? ?? ??????????? ???????????! ???????, ?????????? ???????? ???? ???, ?????????? ? ??? ????? ? ?????. ?????? ?????? ??????? ?????? e-mail ???????, ?? ??????????? ????? ?? ?? ??????????? (???, ??????, ? ???? ????????) ?? ????? ? ?????????? ????????? ??? ???????????????, ??? ??? ?? ????? ????? ? ??????????? ????????? ??? ????????????? ???????????????? ????????. ? ?????? ??????, ??? ???????? ????????? ?????? ????????? ?????????? ?????, ??? ???? ????? ???? ????? ? ?????????? ???????? ?? ?????? ????????????.

?? ????? ??? ??? e-mail ??????? ? ????? ??? ??? ????, ????? ???????? ??? ???????? ?? ???? ?????? ??? ?????????. ??? ??????? ???? ??????????????????? ??????????? ? ???????????????? ?????? ??????? ? ???????? ? ?????????? ??????, ??????????? ???????? smtp-??????? ?? ???????, ? ????? ??????????? ???????????? ????????? ? ???-??? ?  ???? ???????.

?? ????? ?????? ???????? ???, ??? ??? ????? ?? ???????? ?????? ??????.

???? ?? ??????????????? ? ????????? ? ?????? ???????? ?? ??? ????? ?????? ??????????, ???????? ?????? ? ???????????? ????? ? ???? ??????, ????? ? ????? ???????? ????????? "????????", ??? ?? ??????: reklama@publicist.com.

??? ???? ? ???? "???? ?????????" ??????????? ???????: "????????".




From woodm at equire.com  Tue Jul  3 00:14:32 2001
From: woodm at equire.com (Matthew Wood)
Date: Fri Jan  9 22:02:49 2004
Subject: [mod_python] Session data (Sorry for bringing this up again...)
Message-ID: <16299780187.20010703001432@equire.com>

Hello  all.   I  would  like  to  apologize  for bringing up the whole
session thing again.  However, I have a somewhat specific question.

I guess my question has more to do with persistent data in general.

One of the main reasons that one would keep persistent data is to keep
database connections open.  (Or any connection for that matter)
The other is to keep session data on the users of your site.

Obviously,   the session data can be kept in the database, and the key
to  the  table can be kept in a cookie or passed via the url.  (That's
one way to do it, there are many ways, including a text-file-pickeling
based scheme, but I think that a database would work quite well.)

However,  the  problem  is that you can't keep database connections in
the  database.   All  the other persistent data can be kept there, but
not the database connection.

The  problem  with  persistent  data in general is the multiple memory
spaces  used  by  apache.   But  it  would be a shame to re-create the
database  connection every single time someone logs into a page.  That
just seems ridiculous to me.

This brings me to my question:
Would  it  be appropriate to keep a database connection in each of the
memory  spaces?

Such  a connection is not very dynamic (I think) and thus you wouldn't
have to worry about having different types of connections or different
values of connections in the different memory spaces. (As you would if
you stored session data, that changes often.)

What  would be the down side to such an arrangement?  I would probably
need to create a method to time out the connections, so they don't sit
there  forever  if  I change something...  Is that correct?  What am I
missing?


Once  again, let me apologize for bringing up the session issue again.
I  have read all the posts here for the last few months, and I thought
I would see what the up/down sides to this plan would be.



From woodm at equire.com  Tue Jul  3 00:20:40 2001
From: woodm at equire.com (Matthew Wood)
Date: Fri Jan  9 22:02:49 2004
Subject: [mod_python] HTMLgen
Message-ID: <67100148213.20010703002040@equire.com>

I don't know how many of you are familiar with HTMLgen, but it's a set
of objects which aid in the construction of web-pages.

My question is this:

How useful would it be to integrate HTMLgen into a handler, instead of
importing it in each page I write?

The import statement, as well as the initial instanciation of the page
object  (I  can't remember exactly what the name of the object is...).
One  could  even  call  the  'Print  self'  function at the end of the
handler.

Would  this  help anything?  Would it make anything run faster?  Would
it make the code more readable?  Would this be a good idea at all?


I have hardly any experience with mod-python or mod-snake, so I really
don't have enough experience to answer this question.

Thanks in advance for all your help.



From benno at sesgroup.net  Tue Jul  3 16:24:54 2001
From: benno at sesgroup.net (Ben Leslie)
Date: Fri Jan  9 22:02:49 2004
Subject: [mod_python] Session data (Sorry for bringing this up again...)
In-Reply-To: <16299780187.20010703001432@equire.com>; from woodm@equire.com on Tue, Jul 03, 2001 at 12:14:32AM -0600
References: <16299780187.20010703001432@equire.com>
Message-ID: <20010703162453.C11798@sesgroup.net>

On Tue, 03 Jul 2001, Matthew Wood wrote:

<snip>

>
> This brings me to my question:
> Would  it  be appropriate to keep a database connection in each of the
> memory  spaces?


Yes. This is exactly what I do.

In your handler you have a global variable holding the db connection. In 
the handler you check the db handler is alive and recreate if necessary 
(this should really only happen the first time that process is used)

Benno

From piet at cs.uu.nl  Tue Jul  3 09:51:00 2001
From: piet at cs.uu.nl (piet@cs.uu.nl)
Date: Fri Jan  9 22:02:49 2004
Subject: [mod_python] Session data (Sorry for bringing this up again...)
In-Reply-To: Ben Leslie's message of "Tue, 3 Jul 2001 16:24:54 +1000"
References: <16299780187.20010703001432@equire.com>
	<20010703162453.C11798@sesgroup.net>
Message-ID: <u3d8esb6j.fsf@cs.uu.nl>

>>>>> Ben Leslie <benno@sesgroup.net> (BL) writes:

BL> On Tue, 03 Jul 2001, Matthew Wood wrote:
BL> <snip>

>> 
>> This brings me to my question:
>> Would  it  be appropriate to keep a database connection in each of the
>> memory  spaces?


BL> Yes. This is exactly what I do.

BL> In your handler you have a global variable holding the db connection. In 
BL> the handler you check the db handler is alive and recreate if necessary 
BL> (this should really only happen the first time that process is used)

You would have to be careful with multithreading. This applies to Apache on
MS Windows and with 2.0 also on Unix systems. You would need a connection
per thread. Or have a pool where each thread can try to grab a connection.
The pool administration would have to be protected with semaphores or locks
or similar. 
-- 
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl


From vincentwong at ionetbiz.com  Tue Jul  3 16:37:52 2001
From: vincentwong at ionetbiz.com (Vincent Wong)
Date: Fri Jan  9 22:02:49 2004
Subject: [mod_python] Error: No such file or directory
Message-ID: <00ae01c1039b$72f11160$3f00a8c0@ns1.ionetbiz.com>



I encountered the following error when I called the module test.py with  "test.py/saveform":



----
Mod_python error: "PythonHandler mod_python.publisher"

Traceback (most recent call last):

  File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line 193, in Dispatch
    result = object(req)

  File "/usr/local/lib/python2.1/site-packages/mod_python/publisher.py", line 128, in handler
    module = apache.import_module(module_name, _req, [path])

  File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line 356, in import_module
    if os.path.exists(filepath[:-1]) :

  File "/usr/local/lib/python2.1/posixpath.py", line 171, in exists
    st = os.stat(path)

OSError: [Errno 2] No such file or directory: '/home/demo/cgi-bin/test.p'

-----

the test.py file:

import os, sys

def saveform(req):
  return "OK."




Regards,

Vincent


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010703/cdf6c498/attachment-0003.htm
From matthias at my.gnus.org  Tue Jul  3 12:18:43 2001
From: matthias at my.gnus.org (Matthias Wiehl)
Date: Fri Jan  9 22:02:49 2004
Subject: [mod_python] Error: No such file or directory
In-Reply-To: <00ae01c1039b$72f11160$3f00a8c0@ns1.ionetbiz.com> ("Vincent
 Wong"'s message of "Tue, 3 Jul 2001 16:37:52 +0800")
References: <00ae01c1039b$72f11160$3f00a8c0@ns1.ionetbiz.com>
Message-ID: <871ynyqprw.agb@fulmine.dhs.org>

Vincent Wong <vincentwong@ionetbiz.com> writes:
> OSError: [Errno 2] No such file or directory: '/home/demo/cgi-bin/test.p'

Have a closer look at the filename.  I think this is a typo.

From daniel at copyleft.no  Tue Jul  3 12:48:55 2001
From: daniel at copyleft.no (Hr. Daniel Mikkelsen)
Date: Fri Jan  9 22:02:49 2004
Subject: [mod_python] Error: No such file or directory
In-Reply-To: <871ynyqprw.agb@fulmine.dhs.org>
Message-ID: <Pine.LNX.4.31.0107031247070.13943-100000@unity.copyleft.no>

>> OSError: [Errno 2] No such file or directory: '/home/demo/cgi-bin/test.p'

> Have a closer look at the filename.  I think this is a typo.

I don't know if it's the same thing here, but I'm running FreeBSD, and
mod_python erranously cuts the last character of filename of the handler
I've given. I had to remove a [:-1] suffix a couple of places in apache.py
(I think) to get it to work.

I'll post more details if it's interesting to anyone.

-- Daniel Mikkelsen, Copyleft Software AS



From CHagner at fool.com  Tue Jul  3 08:50:12 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 22:02:49 2004
Subject: [mod_python] Session data (Sorry for bringing this up again..
	.)
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E47FAF@rover.foolhq.com>

An alternative would be to have a separate daemon running on the server
(outside of apache/mod_python) that creates/serves/pools/persists your
connections.  Thus, each apache child process/python subinterp would hit
this daemon to get connections.  This model (or something similar) is almost
required if you're going to run apache with many child procs... or multiple
apache instances on the same box.  Either way, you don't really want 100
connections (or more! ack) open to the database.  Heck, if you're running
multiple web servers all hitting a single database, you can easily see how
the total number of connections gets painfully large.  You probably want
something along the lines of 5-10 connections in a db connection pool
(although this is highly dependent on the design of the pool and the
daemon).

Chris

-----Original Message-----
From: Ben Leslie [mailto:benno@sesgroup.net]
Sent: Tuesday, July 03, 2001 2:25 AM
To: Matthew Wood
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Session data (Sorry for bringing this up
again...)


On Tue, 03 Jul 2001, Matthew Wood wrote:

<snip>

>
> This brings me to my question:
> Would  it  be appropriate to keep a database connection in each of the
> memory  spaces?


Yes. This is exactly what I do.

In your handler you have a global variable holding the db connection. In 
the handler you check the db handler is alive and recreate if necessary 
(this should really only happen the first time that process is used)

Benno
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python

From vincentwong at ionetbiz.com  Tue Jul  3 21:38:48 2001
From: vincentwong at ionetbiz.com (Vincent Wong)
Date: Fri Jan  9 22:02:49 2004
Subject: [mod_python] Error: No such file or directory
References: <Pine.LNX.4.31.0107031247070.13943-100000@unity.copyleft.no>
Message-ID: <012301c103c5$7d3ee8c0$3f00a8c0@ns1.ionetbiz.com>

Thanks, Daniel.  So far it work after I change a few of [:-1] to [:].  I
wounldn't know if there is any side effect.


----- Original Message -----
From: Hr. Daniel Mikkelsen <daniel@copyleft.no>
To: Matthias Wiehl <matthias@my.gnus.org>
Cc: Vincent Wong <vincentwong@ionetbiz.com>; Mod_python Mailing List
<mod_python@modpython.org>
Sent: Tuesday, July 03, 2001 6:48 PM
Subject: Re: [mod_python] Error: No such file or directory


> >> OSError: [Errno 2] No such file or directory:
'/home/demo/cgi-bin/test.p'
>
> > Have a closer look at the filename.  I think this is a typo.
>
> I don't know if it's the same thing here, but I'm running FreeBSD, and
> mod_python erranously cuts the last character of filename of the handler
> I've given. I had to remove a [:-1] suffix a couple of places in apache.py
> (I think) to get it to work.
>
> I'll post more details if it's interesting to anyone.
>
> -- Daniel Mikkelsen, Copyleft Software AS
>


From seant at webreply.com  Tue Jul  3 14:02:13 2001
From: seant at webreply.com (Sean True)
Date: Fri Jan  9 22:02:49 2004
Subject: [mod_python] Translation handler help?
Message-ID: <MJEHLHJKGINLONDMMKNEIECFDHAA.seant@webreply.com>

We're implementing a bunch of stuff on top of mod_python, and have avoided
using the
translation handler. Until today.

I'd like to rewrite the URI -- but req.uri is readonly. I can't find a
req.uri() method ...

I'd like to find the equivalent of the CGI document root -- but
apache.build_cgi_env() is not happy about running inside the transhandler():

File /usr/local/pythonpackages/mod_python/apache.py", line 189, in Dispatch
    result = object(self.req)
File "/usr/local/pythonpackages/phtml/phtml.py", line 14, in transhandler
    env = apache.build_cgi_env(req)
File "/usr/local/pythonpackages/mod_python/apache.py", line 418, in
build_cgi_env
    env[k] = req.subprocess_env[k]
KeyError: SCRIPT_FILENAME

Does anyone have a creative or even functional example of a translation
handler?

-- Sean
-------
Sean True
WebReply.Com, Inc.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Sean True.vcf
Type: text/x-vcard
Size: 309 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20010703/f6dc2e8a/SeanTrue-0003.vcf
From grisha at modpython.org  Tue Jul  3 14:57:44 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:02:49 2004
Subject: [mod_python] Translation handler help?
In-Reply-To: <MJEHLHJKGINLONDMMKNEIECFDHAA.seant@webreply.com>
Message-ID: <Pine.BSF.4.32.0107031455280.93646-100000@localhost>

This is probably a screw up on my end - req.uri should be read only for
the translation handler to be useful... ;-)

It's not that hard to add that in - just look at how other read/write
variables are implemented - you have to put a couple of lines of code in
the set_attr function... If this is too much trouble, you 'll have to wait
until the next release.

Grisha

On Tue, 3 Jul 2001, Sean True wrote:

> We're implementing a bunch of stuff on top of mod_python, and have avoided
> using the
> translation handler. Until today.
>
> I'd like to rewrite the URI -- but req.uri is readonly. I can't find a
> req.uri() method ...
>
> I'd like to find the equivalent of the CGI document root -- but
> apache.build_cgi_env() is not happy about running inside the transhandler():
>
> File /usr/local/pythonpackages/mod_python/apache.py", line 189, in Dispatch
>     result = object(self.req)
> File "/usr/local/pythonpackages/phtml/phtml.py", line 14, in transhandler
>     env = apache.build_cgi_env(req)
> File "/usr/local/pythonpackages/mod_python/apache.py", line 418, in
> build_cgi_env
>     env[k] = req.subprocess_env[k]
> KeyError: SCRIPT_FILENAME
>
> Does anyone have a creative or even functional example of a translation
> handler?
>
> -- Sean
> -------
> Sean True
> WebReply.Com, Inc.
>


From matt at designscape.com.au  Wed Jul  4 11:59:39 2001
From: matt at designscape.com.au (Matt Beauregard)
Date: Fri Jan  9 22:02:49 2004
Subject: [mod_python] undefined symbol "floor"
Message-ID: <20010704115939.K14594@designscape.com.au>

We just set up mod_python and are getting the following strange error:

Mod_python error: "PythonHandler modpython"

Traceback (most recent call last):
  File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line 189, in Dispatch
    result = object(self.req)
  File "/usr/home/marauder/exchange/modpython.py", line 7, in handler
ImportError: /usr/local/lib/python2.1/lib-dynload/struct.so: Undefined symbol "floor"

We get this any time some code tries to import struct, when running
through mod_python, but not when running from the interpreter.  Any
clues for fixing it would be appreciated.

Using mod_python 2.7.5
Python 2.1 (#2, Jul  3 2001, 17:40:45) 
[GCC 2.95.2 19991024 (release)] on freebsd4
FreeBSD bofh.designscape.com.au 4.2-RELEASE FreeBSD 4.2-RELEASE #0:
Tue Feb 27 12:11:29 EST 2001 marauder@bofh.designscape.com.au:/usr/src/sys/compile/BOFH  i386

thanks,

-- 
Matt Beauregard
BOFH, Designscape
Ph: +61 2 9361 4233   Fx: +61 2 9361 4633

Permission is given for unlimited distribution of this work under the
Copyright Act 1968 (2001 amended).  Unless otherwise stated, you agree
that these terms also cover works which you send in response.


From grisha at modpython.org  Tue Jul  3 22:53:53 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:02:49 2004
Subject: [mod_python] undefined symbol "floor"
In-Reply-To: <20010704115939.K14594@designscape.com.au>
Message-ID: <Pine.BSF.4.32.0107032247370.293-100000@localhost>

floor() lives in libm, make sure that when you compile it, "-lm" is one of
the options.

On Wed, 4 Jul 2001, Matt Beauregard wrote:

> We just set up mod_python and are getting the following strange error:
>
> Mod_python error: "PythonHandler modpython"
>
> Traceback (most recent call last):
>   File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line 189, in Dispatch
>     result = object(self.req)
>   File "/usr/home/marauder/exchange/modpython.py", line 7, in handler
> ImportError: /usr/local/lib/python2.1/lib-dynload/struct.so: Undefined symbol "floor"
>
> We get this any time some code tries to import struct, when running
> through mod_python, but not when running from the interpreter.  Any
> clues for fixing it would be appreciated.
>
> Using mod_python 2.7.5
> Python 2.1 (#2, Jul  3 2001, 17:40:45)
> [GCC 2.95.2 19991024 (release)] on freebsd4
> FreeBSD bofh.designscape.com.au 4.2-RELEASE FreeBSD 4.2-RELEASE #0:
> Tue Feb 27 12:11:29 EST 2001 marauder@bofh.designscape.com.au:/usr/src/sys/compile/BOFH  i386
>
> thanks,
>
> --
> Matt Beauregard
> BOFH, Designscape
> Ph: +61 2 9361 4233   Fx: +61 2 9361 4633
>
> Permission is given for unlimited distribution of this work under the
> Copyright Act 1968 (2001 amended).  Unless otherwise stated, you agree
> that these terms also cover works which you send in response.
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From matt at designscape.com.au  Wed Jul  4 13:04:42 2001
From: matt at designscape.com.au (Matt Beauregard)
Date: Fri Jan  9 22:02:49 2004
Subject: [mod_python] undefined symbol "floor"
In-Reply-To: <Pine.BSF.4.32.0107032247370.293-100000@localhost>; from grisha@modpython.org on Tue, Jul 03, 2001 at 10:53:53PM -0400
References: <20010704115939.K14594@designscape.com.au> <Pine.BSF.4.32.0107032247370.293-100000@localhost>
Message-ID: <20010704130442.A40751@designscape.com.au>

On Tue, Jul 03, 2001 at 10:53:53PM -0400, Gregory (Grisha) Trubetskoy wrote:
> 
> floor() lives in libm, make sure that when you compile it, "-lm" is one of
> the options.

Hi Gregory,

I think the relevant compile lines are 
/usr/local/sbin/apxs -I/usr/ports/www/mod_python/work/mod_python-2.7.5/src/include -I/usr/local/include/apache -I/usr/ports/www/mod_python/work/Python-2.1 -I/usr/ports/www/mod_python/work/Python-2.1/Include -c mod_python.o  _apachemodule.o  requestobject.o  tableobject.o  util.o  serverobject.o  connobject.o -lm  /usr/ports/www/mod_python/work/Python-2.1/libpython2.1.a      -lm
gcc -shared -o mod_python.so mod_python.o _apachemodule.o requestobject.o tableobject.o util.o serverobject.o connobject.o -lm /usr/ports/www/mod_python/work/Python-2.1/libpython2.1.a -lm 

Output from objdump:
!815 root@bofh:/usr/ports/www/mod_python/work/mod_python-2.7.5/src# objdump -t mod_python.so|grep floor
00000000       F *UND*  00000000 floor
!816 root@bofh:/usr/ports/www/mod_python/work/mod_python-2.7.5/src# objdump -T mod_python.so|grep floor
00000000      DF *UND*  00000000 floor

Any clues?

thanks,

-- 
Matt Beauregard
Technical Director, Designscape
Ph: +61 2 9361 4233   Fx: +61 2 9361 4633

Permission is given for unlimited distribution of this work under the
Copyright Act 1968 (2001 amended).  Unless otherwise stated, you agree
that these terms also cover works which you send in response.


From mark_miller_ca at yahoo.com  Wed Jul  4 01:31:11 2001
From: mark_miller_ca at yahoo.com (Mark Miller)
Date: Fri Jan  9 22:02:50 2004
Subject: [mod_python] mod_python and testing error
Message-ID: <ALEBINNPGFGFAJGIFGHPAEGICBAA.mark_miller_ca@yahoo.com>

when i try to run the test script as stated in the manual,
i originally was getting the text of the script displayed on the screen, but
i just ran it now, and i got from apache: internal server error.

Within the apache error_log file, i have [Wed Jul 4 01:07:41 2001] [error]
[client 192.168.0.92] python_handler: make_obcallback returned no
obCallBack!

Can anyone guide me beyond this point, i get the feeling that i am close, if
it comes down to it, i will include my httpd.conf, but i don't imagine the
problem is within the file.

Thanks

Mark Miller


_________________________________________________________
Do You Yahoo!?
Get your free @yahoo.com address at http://mail.yahoo.com


From daniel at copyleft.no  Wed Jul  4 09:35:14 2001
From: daniel at copyleft.no (Hr. Daniel Mikkelsen)
Date: Fri Jan  9 22:02:50 2004
Subject: [mod_python] undefined symbol "floor"
In-Reply-To: <Pine.BSF.4.32.0107032247370.293-100000@localhost>
Message-ID: <Pine.LNX.4.31.0107040933280.13943-100000@unity.copyleft.no>

> floor() lives in libm, make sure that when you compile it, "-lm" is one of
> the options.

It is my experience, on FreeBSD, that I have to recompile Apache with
"-lm" in order for this to work. Linking it with mod_python doesn't seem
to cut it (unless one perhaps linked it statically).

-- Daniel Mikkelsen, Copyleft Software AS



From matt at designscape.com.au  Wed Jul  4 17:51:15 2001
From: matt at designscape.com.au (Matt Beauregard)
Date: Fri Jan  9 22:02:50 2004
Subject: [mod_python] undefined symbol "floor"
In-Reply-To: <Pine.LNX.4.31.0107040933280.13943-100000@unity.copyleft.no>; from daniel@copyleft.no on Wed, Jul 04, 2001 at 09:35:14AM +0200
References: <Pine.BSF.4.32.0107032247370.293-100000@localhost> <Pine.LNX.4.31.0107040933280.13943-100000@unity.copyleft.no>
Message-ID: <20010704175115.F40751@designscape.com.au>

On Wed, Jul 04, 2001 at 09:35:14AM +0200, Hr. Daniel Mikkelsen wrote:
> > floor() lives in libm, make sure that when you compile it, "-lm" is one of
> > the options.
> 
> It is my experience, on FreeBSD, that I have to recompile Apache with
> "-lm" in order for this to work. Linking it with mod_python doesn't seem
> to cut it (unless one perhaps linked it statically).

Hooray!  Thanks Daniel, one step closer...

Now it's finding floor, but I'm getting 
ImportError: /usr/local/lib/python2.1/lib-dynload/_socket.so: Undefined symbol "PyThread_acquire_lock"

Is this another linker problem?  What do I link in to get this solved?

thanks,

-- 
Matt Beauregard
Technical Director, Designscape
Ph: +61 2 9361 4233   Fx: +61 2 9361 4633

Permission is given for unlimited distribution of this work under the
Copyright Act 1968 (2001 amended).  Unless otherwise stated, you agree
that these terms also cover works which you send in response.


From vincentwong at ionetbiz.com  Wed Jul  4 16:36:18 2001
From: vincentwong at ionetbiz.com (Vincent Wong)
Date: Fri Jan  9 22:02:50 2004
Subject: [mod_python] os.system problem
Message-ID: <007401c10464$65bb50e0$3f00a8c0@ns1.ionetbiz.com>

When I use os.system('some command') within the interactive interpreter, everything works fine.  But when I use the same os.system('some command') together with mod_python, no error reported but the effect of the command does not occur.  Anyone know what is happenning here?

Regards.
Vincent

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010704/247ee969/attachment-0003.htm
From daniel at copyleft.no  Wed Jul  4 10:31:50 2001
From: daniel at copyleft.no (Hr. Daniel Mikkelsen)
Date: Fri Jan  9 22:02:50 2004
Subject: [mod_python] undefined symbol "floor" 
Message-ID: <Pine.LNX.4.31.0107041031270.13943-100000@unity.copyleft.no>

>> It is my experience, on FreeBSD, that I have to recompile Apache with
>> "-lm" in order for this to work. Linking it with mod_python doesn't seem
>> to cut it (unless one perhaps linked it statically).

> Now it's finding floor, but I'm getting ImportError:
> /usr/local/lib/python2.1/lib-dynload/_socket.so: Undefined symbol
> "PyThread_acquire_lock" Is this another linker problem?  What do I
> link in to get this solved?

I got this one too, at one point, but I can't remember what I did. I think
it had something to do with Python's /usr/local/lib/python2.1 binaries
being compiled with threading.

Perhaps a separate install of a threadless python, in another directory,
and linking against that, will help you. Only, I can't recall doing this,
and things are working for me now.

There were also more problems like this, one with mxDateTime. I feel every
time I want to set up mod_python after a few months of not using it, I
have to spend days fucking with it. :)

-- Daniel Mikkelsen, Copyleft Software AS



From mai99dgf at studserv.uni-leipzig.de  Wed Jul  4 13:34:08 2001
From: mai99dgf at studserv.uni-leipzig.de (Georg Martius)
Date: Fri Jan  9 22:02:50 2004
Subject: [mod_python] apache-1.3.14 Suse/Linux & mod_python toubles
Message-ID: <3B42FF30.BA021F5F@studserv.uni-leipzig.de>

Hi

I have same troubles with the mod_python module and my apache. 
I have SuSE 7.1 and the apache logs the following:

[notice] Apache/1.3.14 (Unix)  (SuSE/Linux) mod_python/2.7.1 Python/2.0
mod_throttle/3.0 mod_layout/1.0 mod_fastcgi/2.2.2 mod_perl/1.24
PHP/3.0.17-dev configured -- resuming normal operations 

I have copied the mptest.py into my cgi-bin directory with the right
permissions.

the splitter of my httpd.conf is:

<Directory /usr/local/httpd/cgi-bin>
  AddHandler python-program .py
  PythonHandler mptest
  PythonDebug On
</Directory>      


If perform a request to mptest.py I get in internal server error and the
logfile shows:
[error] (8)Exec format error: exec of /usr/local/httpd/cgi-bin/mptest.py
failed
[error] [client 192.168.155.55] Premature end of script headers:
/usr/local/httpd/cgi-bin/mptest.py     

Thanks for any help!

Ciao Bethoven

From M.Izydorski at rubikon.pl  Wed Jul  4 16:15:51 2001
From: M.Izydorski at rubikon.pl (Michal Izydorski)
Date: Fri Jan  9 22:02:50 2004
Subject: [mod_python] Configuration problems
Message-ID: <1646860855.20010704161551@rubikon.pl>

Hello!!

I have configuration problems with Apache 1.3.20 under W2k

The error is:

> Syntax error on line 211 of c:/program files/apache group/apache/conf/httpd.conf
> :
> Cannot load c:/program files/apache group/apche/modules/mod_python.dll into serv
> er: (126) Nie mo?na odnale?? okre?lonego modu-u:


           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
I don't know, why marked part is in my w2k local language, it means No
such modules.

I load other modules, esp. PHP, and there isn't problem, the same dir,
proprietary LoadModule Directives, bup Python don't work.

Please help and send answer to my email too.


-- 
Regards,
 Michal                          mailto:M.Izydorski@rubikon.pl



From grisha at modpython.org  Wed Jul  4 10:18:12 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:02:50 2004
Subject: [mod_python] undefined symbol "floor"
In-Reply-To: <20010704175115.F40751@designscape.com.au>
Message-ID: <Pine.BSF.4.32.0107041016050.8569-100000@localhost>

oh, this is an easy one - recompile Python without threads and use
--with-python to compile mod_python.

the mod_python port used to take care of all of that very nicely, but it
seems to be a bit outdated at 2.7.3... although you might be able to tweak
the Makefile just a little bit to make it compile the latest version -
there isn't all that much difference.

grisha

On Wed, 4 Jul 2001, Matt Beauregard wrote:

> On Wed, Jul 04, 2001 at 09:35:14AM +0200, Hr. Daniel Mikkelsen wrote:
> > > floor() lives in libm, make sure that when you compile it, "-lm" is one of
> > > the options.
> >
> > It is my experience, on FreeBSD, that I have to recompile Apache with
> > "-lm" in order for this to work. Linking it with mod_python doesn't seem
> > to cut it (unless one perhaps linked it statically).
>
> Hooray!  Thanks Daniel, one step closer...
>
> Now it's finding floor, but I'm getting
> ImportError: /usr/local/lib/python2.1/lib-dynload/_socket.so: Undefined symbol "PyThread_acquire_lock"
>
> Is this another linker problem?  What do I link in to get this solved?
>
> thanks,
>
> --
> Matt Beauregard
> Technical Director, Designscape
> Ph: +61 2 9361 4233   Fx: +61 2 9361 4633
>
> Permission is given for unlimited distribution of this work under the
> Copyright Act 1968 (2001 amended).  Unless otherwise stated, you agree
> that these terms also cover works which you send in response.
>


From vincentwong at ionetbiz.com  Thu Jul  5 12:00:46 2001
From: vincentwong at ionetbiz.com (Vincent Wong)
Date: Fri Jan  9 22:02:50 2004
Subject: [mod_python] link to image files broken
Message-ID: <00fc01c10507$1218a700$3f00a8c0@ns1.ionetbiz.com>

I have a html file call thanks.html.  When I open this file and return the content from my test.py file, all links to image (.gif) files are broken.  Did anyone know the solution?

Thanks.

Vincent

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010705/b1386738/attachment-0003.htm
From piet at cs.uu.nl  Thu Jul  5 11:01:29 2001
From: piet at cs.uu.nl (piet@cs.uu.nl)
Date: Fri Jan  9 22:02:50 2004
Subject: [mod_python] link to image files broken
In-Reply-To: "Vincent Wong"'s message of "Thu, 5 Jul 2001 12:00:46 +0800"
References: <00fc01c10507$1218a700$3f00a8c0@ns1.ionetbiz.com>
Message-ID: <ubsmzoil2.fsf@cs.uu.nl>

>>>>> "Vincent Wong" <vincentwong@ionetbiz.com> (VW) writes:

VW> I have a html file call thanks.html. When I open this file and return
VW> the content from my test.py file, all links to image (.gif) files are
VW> broken. Did anyone know the solution?

Not without knowing how the links to the images are coded in thanks.html.
-- 
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl


From vincentwong at ionetbiz.com  Fri Jul  6 14:18:45 2001
From: vincentwong at ionetbiz.com (Vincent Wong)
Date: Fri Jan  9 22:02:50 2004
Subject: [mod_python] link to image files broken
References: <014901c10542$3c018ec0$3f00a8c0@ns1.ionetbiz.com>
Message-ID: <012801c105e3$833099c0$3f00a8c0@ns1.ionetbiz.com>

these are the test.py and thanks.html

---test.py---


import os, sys
def saveform(req):
  input = open('../../thanks.html', 'r')

  return input.read()


---thanks.html---

<html>
<head>
<title>Desa Millennia E-Community</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<script language="JavaScript">
<!--
function MM_preloadImages() { file://v3.0
  var d=document; if(d.images){ if(!d.MM_p) d.MM_p=new Array();
    var i,j=d.MM_p.length,a=MM_preloadImages.arguments; for(i=0; i<a.length;
i++)
    if (a[i].indexOf("#")!=0){ d.MM_p[j]=new Image; d.MM_p[j++].src=a[i];}}
}

function MM_swapImgRestore() { file://v3.0
  var i,x,a=document.MM_sr; for(i=0;a&&i<a.length&&(x=a[i])&&x.oSrc;i++)
x.src=x.oSrc;
}

function MM_findObj(n, d) { file://v4.0
  var p,i,x;  if(!d) d=document;
if((p=n.indexOf("?"))>0&&parent.frames.length) {
    d=parent.frames[n.substring(p+1)].document; n=n.substring(0,p);}
  if(!(x=d[n])&&d.all) x=d.all[n]; for (i=0;!x&&i<d.forms.length;i++)
x=d.forms[i][n];
  for(i=0;!x&&d.layers&&i<d.layers.length;i++)
x=MM_findObj(n,d.layers[i].document);
  if(!x && document.getElementById) x=document.getElementById(n); return x;
}

function MM_swapImage() { file://v3.0
  var i,j=0,x,a=MM_swapImage.arguments; document.MM_sr=new Array;
for(i=0;i<(a.length-2);i+=3)
   if ((x=MM_findObj(a[i]))!=null){document.MM_sr[j++]=x; if(!x.oSrc)
x.oSrc=x.src; x.src=a[i+2];}
}
file://-->
</script>
</head>

<body bgcolor="#FFFFFF" text="#000000" leftmargin="0" topmargin="0"
marginwidth="0" marginheight="0" background="main/002darkgreen.gif"
onLoad="MM_preloadImages('main/016community1.gif','main/017security1.gif','m
ain/018events1.gif','main/019onlinepay1.gif','main/20onlinebook1.gif','main/
21shopping1.gif','main/22food1.gif','main/23entertain1.gif','main/24gettinga
round1.gif','main/25thetown1.gif','main/26news1.gif','main/27technical1.gif'
,'main/28infodesk1.gif','main/29faq1.gif','main/41a.gif','main/015home1.gif'
)">
<div align="center">
  <table width="100%" border="0" cellspacing="0" cellpadding="0"
bgcolor="#FFFFFF">
    <tr>
      <td>
        <div align="center"><img src="main/000none.gif" width="10"
height="10"><br>
          <img src="main/00logo.gif" width="197" height="38"><img
src="main/000none.gif" width="80" height="8">
          <img src="main/00newlaunch_banner.gif" width="480" height="60">
<img src="main/000none.gif" width="20" height="8"><br>
          <img src="main/000none.gif" width="10" height="3"></div>
      </td>
    </tr>
  </table>
  <table width="100%" border="0" cellspacing="0" cellpadding="0">
    <tr>
      <td height="3" background="main/001blackwhiteline.gif"><img
src="main/000none.gif" width="1" height="1"></td>
    </tr>
  </table>
  <table width="761" border="0" cellspacing="0" cellpadding="0">
    <tr>
      <td><br>
        <table width="767" border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td width="375"><img src="main/000none.gif" width="175"
height="1"><img src="main/45.gif" width="112" height="41"></td>
            <td width="386">
              <table width="100%" border="0" cellspacing="0"
cellpadding="0">
                <tr>
                  <td><b><font face="Arial, Helvetica, sans-serif" size="1"
color="#CCCCCC">Username
                    :<img src="main/000none.gif" width="10"
height="8"></font></b></td>
                  <td>
                    <input type="text" name="textfield" size="10">
                    <b><font face="Arial, Helvetica, sans-serif" size="1"
color="#CCCCCC"><img src="main/000none.gif" width="20"
height="8"></font></b>
                  </td>
                  <td><b><font face="Arial, Helvetica, sans-serif" size="1"
color="#CCCCCC">Password
                    :<img src="main/000none.gif" width="10" height="8">
</font></b></td>
                  <td>
                    <input type="text" name="textfield2" size="10">
                  </td>
                  <td>
                    <div align="right"><img src="main/004go.gif" width="22"
height="22"></div>
                  </td>
                </tr>
              </table>
            </td>
          </tr>
        </table>
        <table width="761" border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td width="111" valign=top background="main/013.gif">
              <p><img src="main/002darkgreen.gif" width="111"
height="3"><br>
                <font color="#FFFFFF"><b><font face="Verdana, Tahoma, Arial"
size="1">Search
                For :<br>
                <img src="main/000none.gif" width="8" height="8"><br>
                <input type="text" name="textfield3" size="13">
                <br>
                </font><font color="#FFFFFF"><b><font face="Verdana, Tahoma,
Arial" size="1"><img src="main/000none.gif" width="8"
height="8"></font></b></font><br>
                <img src="main/000none.gif" width="28" height="1"><img
src="main/014searchbutton.gif" width="74" height="16"><br>
                <br>
                <a href="index.html" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image15','','main/015home1.gif',1)"><img
src="main/015home.gif" width="111" height="24" border="0"
name="Image15"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image1','','main/016community1.gif',1)"><img
src="main/016community.gif" width="111" height="24" border="0"
name="Image1"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image2','','main/017security1.gif',1)"><img
src="main/017security.gif" width="111" height="24" border="0"
name="Image2"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image3','','main/018events1.gif',1)"><img
src="main/018events.gif" width="111" height="24" border="0"
name="Image3"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image4','','main/019onlinepay1.gif',1)"><img
src="main/019onlinepay.gif" width="111" height="24" border="0"
name="Image4"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image5','','main/20onlinebook1.gif',1)"><img
src="main/20onlinebook.gif" width="111" height="24" border="0"
name="Image5"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image6','','main/21shopping1.gif',1)"><img
src="main/21shopping.gif" width="111" height="24" border="0"
name="Image6"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image7','','main/22food1.gif',1)"><img
src="main/22food.gif" width="111" height="24" border="0"
name="Image7"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image8','','main/23entertain1.gif',1)"><img
src="main/23entertain.gif" width="111" height="24" border="0"
name="Image8"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image9','','main/24gettingaround1.gif',1)"><img
src="main/24gettingaround.gif" width="111" height="24" border="0"
name="Image9"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image10','','main/25thetown1.gif',1)"><img
src="main/25thetown.gif" width="111" height="24" border="0"
name="Image10"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image11','','main/26news1.gif',1)"><img
src="main/26news.gif" width="111" height="24" border="0"
name="Image11"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image12','','main/27technical1.gif',1)"><img
src="main/27technical.gif" width="111" height="24" border="0"
name="Image12"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image13','','main/28infodesk1.gif',1)"><img
src="main/28infodesk.gif" width="111" height="24" border="0"
name="Image13"></a><br>
                <a href="javascript:;" onMouseOut="MM_swapImgRestore()"
onMouseOver="MM_swapImage('Image14','','main/29faq1.gif',1)"><img
src="main/29faq.gif" width="111" height="24" border="0"
name="Image14"></a></b></font></p>
              <p align="center"><img src="main/30advert.gif" width="102"
height="113"><br>
                <br>
              </p>
            </td>
            <td width="11" valign=top background="main/007.gif"><img
src="main/008.gif" width="11" height="32"></td>
            <td width="627" valign=top bgcolor="#FFFFFF">
              <div align="left">
                <table width="100%" border="0" cellspacing="0"
cellpadding="0">
                  <tr>
                    <td background="main/43.gif"><img src="main/44.gif"
width="167" height="27"></td>
                  </tr>
                </table>
                <br>
                <br>
                <br>
                <br>
                <table width="85%" border="0" cellspacing="0"
cellpadding="0" align="center">
                  <tr>
                    <td>
                      <div align="center">
                        <p><b><font face="Verdana, Arial, Helvetica,
sans-serif" size="1" color="#000000">THANK
                          YOU !</font></b></p>
                        <p align="center"><b><font face="Verdana, Arial,
Helvetica, sans-serif" size="1" color="#000000"><font color="#003300">Your
                          registration is successfull ! To learn how to
install
                          your e-mail, please <font color="#333333"><a
href="faq2.html"><font color="#000000">click
                          here</font></a></font>!</font></font></b></p>
                        </div>
                    </td>
                  </tr>
                </table>
                <div align="center"><br>
                  <br>
                  <table width="85%" border="0" cellspacing="0"
cellpadding="0" align="center">
                    <tr>
                      <td width="50%"><b><font face="Verdana, Arial,
Helvetica, sans-serif" size="1" color="#000000"><a href="invite.html"
target="_blank"><img src="main/02.jpg" width="73" height="61"
border="0"></a><a href="invite.html" target="_blank"><img src="main/38.gif"
width="171" height="61" border="0"></a><br>
                        <br>
                        <b><font face="Arial, Helvetica, sans-serif"
size="1" color="#CCCCCC"><img src="main/000none.gif" width="8"
height="4"></font></b><br>
                        <img src="main/32line.gif" width="254"
height="1"><br>
                        <img src="main/33.gif" width="98" height="89"><img
src="main/34.gif" width="154" height="89" usemap="#Map3" border="0"><br>
                        <img src="main/35.gif" width="99" height="94"><img
src="main/36.gif" width="153" height="94" usemap="#Map4Map" border="0"><br>
                        <br>
                        <map name="Map3">
                          <area shape="rect" coords="74,58,153,73"
href="http://www.emasonline.com/millenniumland/Showhouse/Main.asp"
target="_blank">
                        </map>
                        </font></b><b><font face="Verdana, Arial, Helvetica,
sans-serif" size="1" color="#000000">
                        <map name="Map4Map">
                          <area shape="rect" coords="73,68,152,81"
href="http://www.emasonline.com/millenniumland/demo.asp" target="_blank">
                        </map>
                        </font></b></td>
                      <td width="50%">
                        <div align="center">
                          <p align="center"><img src="main/54suggest.gif"
width="153" height="180" usemap="#Map" border="0">
                            <map name="Map">
                              <area shape="rect" coords="63,137,144,151"
href="mailto:feedback@desamillennia.com" alt="SUGESST ??" title="SUGESST
??">
                            </map>
                            <b><font face="Verdana, Arial, Helvetica,
sans-serif" size="1" color="#000000">
                            <map name="Map4">
                              <area shape="rect" coords="73,68,152,81"
href="http://www.emasonline.com/millenniumland/demo.asp" target="_blank">
                            </map>
                            </font></b></p>
                        </div>
                      </td>
                    </tr>
                  </table>
                  <br>
                </div>
                <div align="center"><br>
                </div>
                <p align="center">&nbsp;</p>
                <p align="center">&nbsp;</p>
              </div>
            </td>
            <td width="12" background="main/005.gif" valign=top><img
src="main/006.gif" width="12" height="30"></td>
          </tr>
        </table>
        <table width="761" border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td width="114">
              <div align="right"><img src="main/50.gif" width="4"
height="10"></div>
            </td>
            <td width="647" background="main/48.gif">
              <div align="right"><img src="main/49.gif" width="8"
height="10"></div>
            </td>
          </tr>
        </table>
        <table width="761" border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td width="114">
              <div align="right"></div>
            </td>
            <td width="647">
              <div align="center"><br>
                <font size="1" face="Arial, Helvetica, sans-serif"
color="#CCCCCC">
                Home | Community | Security Access | Events | Online Payment
|
                Online Booking | Shopping | Food &amp; Dining |
Entertainment
                | Getting Around | The Town | News &amp; Archives |
Technical
                Support | Information Desk | FAQ<br>
                <font color="#666666"><br>
                Copyright 2001 &copy; . Desa Millennia Sdn Bhd. Your Smart
Township.
                Site constructed by zecnet.com and
ionetbiz.com.</font></font></div>
            </td>
          </tr>
        </table>

      </td>
    </tr>
  </table>
  <br>
</div>
</body>
</html>






From piet at cs.uu.nl  Fri Jul  6 11:30:42 2001
From: piet at cs.uu.nl (piet@cs.uu.nl)
Date: Fri Jan  9 22:02:50 2004
Subject: [mod_python] link to image files broken
In-Reply-To: "Vincent Wong"'s message of "Fri, 6 Jul 2001 14:18:45 +0800"
References: <014901c10542$3c018ec0$3f00a8c0@ns1.ionetbiz.com>
	<012801c105e3$833099c0$3f00a8c0@ns1.ionetbiz.com>
Message-ID: <uhewqiev1.fsf@cs.uu.nl>

>>>>> "Vincent Wong" <vincentwong@ionetbiz.com> (VW) writes:

VW> these are the test.py and thanks.html
VW> ---test.py---


VW> import os, sys
VW> def saveform(req):
VW>   input = open('../../thanks.html', 'r')

VW>   return input.read()


VW> ---thanks.html---
....
VW> marginwidth="0" marginheight="0" background="main/002darkgreen.gif"
VW> onLoad="MM_preloadImages('main/016community1.gif','main/017security1.gif','m

It is difficult to know without the context, but I guess the problem is
that your images are supposed to come from the directory `main', which I
suppose is relative to the directory where thanks.html is found. But the
browser doesn't know that the HTML file comes from ../.., it works relative
to the directory where your python script is located (or the original
script that calls this one).

So you could:
1. Change the image locations in thanks.html to ../../main
2. Move the main directory to the sirectory where your python scripts are
   (but this doesn't help if you also need to refer to thanks.html
   directly)
3. Put a <BASE HREF="actual location of the thanks.html file"> in
   thanks.html or in the copy that you write.
I think 3 is the best solution.
-- 
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl


From seant at webreply.com  Fri Jul  6 12:34:27 2001
From: seant at webreply.com (Sean True)
Date: Fri Jan  9 22:02:50 2004
Subject: [mod_python] More translation handler help?
In-Reply-To: <ubsmzoil2.fsf@cs.uu.nl>
Message-ID: <MJEHLHJKGINLONDMMKNEEEENDHAA.seant@webreply.com>

With a little bit of help from Grisha, I got past my first problem (I needed
a writable req.uri)
and am onto a second one.

I stripped out the following handlers from a much larger system, and they
reproduce the problem.
The production handler (handler) attempts to do a lookup_uri on the inbound
URI. If there is no translation handler
called for in the conf file, all is well, and the lookup works.

If there is a translation handler declared using PythonTransHandler, the
Transhandler gets called twice,
and the server process appears to go into a loop -- never exits the
production handler. I'm suspecting
that there is a reentrancy issue here of some sort, but the Apache code
specifically suggests calling lookup_uri() to
get the mapping of "/" to filename, instead of using document_root().

Comments on the rules of when one can and can't call lookup_uri() would be
welcome.

-- Sean


Configuration:

# Connections for general test site
<VirtualHost www.foo.com>
    DocumentRoot /usr/local/apache/htdocs/www.foo.com
    ServerName www.foo.com
    AddHandler python-program .phtml
    PythonInterpreter xphtml
    PythonHandler phtml.xphtml
    PythonTransHandler phtml.xphtml
</VirtualHost>


xphtml.py:



from mod_python import apache
from phtmllog import log, logIO

def transhandler(req):
    log("transhandler "+`req.uri`)
    return apache.DECLINED

def handler(req):
    log("lookup_uri "+req.lookup_uri(req.uri).filename)
    return apache.OK


requestobject.c code for lookup_uri:

/**
 ** request.lookup_uri(request self, uri)
 **
 *    An interface to the ap_lookup_uri function.
 */

static PyObject * req_lookup_uri(requestobject *self, PyObject *args)
{
  const char *uri;
  request_rec *req;


  if (! PyArg_ParseTuple(args, "s", &uri))
    return NULL;

  req = (request_rec *)ap_sub_req_lookup_uri(uri,self->request_rec);
  if (! req) {
    Py_INCREF(Py_None);
    return Py_None;
  }
  else {
    return MpRequest_FromRequest(req);
  }
}


...


    {"lookup_uri",           (PyCFunction) req_lookup_uri,
METH_VARARGS},
    { NULL, NULL } /* sentinel */
};

...




From vincentwong at ionetbiz.com  Sat Jul  7 12:34:35 2001
From: vincentwong at ionetbiz.com (Vincent Wong)
Date: Fri Jan  9 22:02:50 2004
Subject: [mod_python] link to image files broken
References: <014901c10542$3c018ec0$3f00a8c0@ns1.ionetbiz.com><012801c105e3$833099c0$3f00a8c0@ns1.ionetbiz.com> <uhewqiev1.fsf@cs.uu.nl>
Message-ID: <001b01c1069e$206e8d40$3f00a8c0@ns1.ionetbiz.com>

Thanks.  I have make it work.  This is what I did.

--- test.py ---

import os, sys
from mod_python import apache

def saveform(req):
  input = open('/home/demo/html/thanks.html', 'r')
  req.write(input.read())
  return apache.OK


--- thanks.html ---

add the line:

<base href="http://demo.ionetbiz2.com/">


A question here:  the open statement above does not work with relative path,
why?



Regards,
Vincent




From vincentwong at ionetbiz.com  Sat Jul  7 13:10:30 2001
From: vincentwong at ionetbiz.com (Vincent Wong)
Date: Fri Jan  9 22:02:50 2004
Subject: [mod_python] link to image files broken
Message-ID: <003601c106a3$2805f700$3f00a8c0@ns1.ionetbiz.com>

Thanks.  I have make it work.  This is what I did.

--- test.py ---

import os, sys
from mod_python import apache

def saveform(req):
  input = open('/home/demo/html/thanks.html', 'r')
  req.write(input.read())
  return apache.OK


--- thanks.html ---

add the line:

<base href="http://demo.ionetbiz2.com/">


A question here:  the open statement above does not work with relative path,
why?



Regards,
Vincent



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010707/76bd17c3/attachment-0003.htm
From wart at softhome.net  Sat Jul  7 13:03:10 2001
From: wart at softhome.net (Wartan Hachaturow)
Date: Fri Jan  9 22:02:50 2004
Subject: [mod_python] link to image files broken
In-Reply-To: <003601c106a3$2805f700$3f00a8c0@ns1.ionetbiz.com>
Message-ID: <20010707130310.A9632@penguin.aktivist.ru>

On Sat, Jul 07, 2001 at 01:10:30PM +0800, Vincent Wong wrote:

> A question here:  the open statement above does not work with relative path,
> why?

Because it opens the file from the filesystem, and not the one 
served by the web server.

-- 
Regards, Wartan.
echo "Your stdio isn't very std." 
		-- Larry Wall in Configure from the perl distribution

From kees.serier at relan.nl  Sat Jul  7 11:48:09 2001
From: kees.serier at relan.nl (Serier, Kees)
Date: Fri Jan  9 22:02:50 2004
Subject: [mod_python] ld error when trying to build mod-python
Message-ID: <AA2536FEE0A9D311887000508B5EDF1E0219634B@ab00s003.abab.cadans.nl>

Hi,

I'm trying to build mod_python 2.7.5 on AIX, but get the following error
from ld, any ideas or hints?

ld: 0711-244 ERROR: No csects or exported symbols have been saved.
apxs:Break: Command failed with rc=8

Kees Serier mailto:kees.serier@ordina.nl

General information:
   AIX        4.2.1
   GCC        2.95.2 (locally build and installed from source)
   GNU-make   3.79.1 (locally build and installed from source)
   Python     2.0    (locally build from source without threads)
   Apache     1.3.20 (locally build and installed from source with DSO)
   Mod_python 2.7.5

This is the output of configure and make;

[/usr/local/src/mod_python-2.7.5]# ./configure
--with-apxs=/usr/local/apache/bin/apxs --with-apache=../apache_1.3.20
--with-python=../Python-2.0/
creating cache ./config.cache
checking for gcc... gcc
checking whether the C compiler (gcc  ) works... yes
checking whether the C compiler (gcc  ) is a cross-compiler... no
checking whether we are using GNU C... yes
checking whether gcc accepts -g... yes
checking for ranlib... ranlib
checking for ar... ar
checking for a BSD compatible install... ./install-sh -c
checking whether make sets ${MAKE}... yes
checking for main in -lm... yes
checking for working const... yes
checking your blood pressure... a bit high, but we can proceed
checking whether apxs is available
checking for --with-apxs... /usr/local/apache/bin/apxs executable, good
checking for Apache libexec directory... /usr/local/apache/libexec
checking for Apache include directory... -I/usr/local/apache/include
checking for --with-apache... /usr/local/src/apache_1.3.20
checking for --with-python... /usr/local/src/Python-2.0
checking for python... /usr/local/src/Python-2.0/python
checking Python version... 2.0
checking whether Python is compiled with thread support... no threads, good
checking Python install prefix... /usr/local
checking what libraries Python was linked with...
/usr/local/src/Python-2.0/libpython2.0.a   -ldl    -lm
checking linker flags used to link Python...  -Wl,-bE:python.exp -lld
checking where Python include files are... -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include
checking for mkdep... no
checking for makedepend... /usr/bin/X11/makedepend
updating cache ./config.cache
creating ./config.status
creating Makefile
creating src/Makefile
creating src/libpython.module
creating Doc/Makefile
analyzing dependencies
sant[/usr/local/src/mod_python-2.7.5]= gmake
gmake[1]: Entering directory `/usr/local/src/mod_python-2.7.5/src'
gcc  -I/usr/local/src/mod_python-2.7.5/src/include
-I/usr/local/src/apache_1.3.20/src/include
-I/usr/local/src/apache_1.3.20/src/os/unix -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include    -c -o mod_python.o mod_python.c
gcc  -I/usr/local/src/mod_python-2.7.5/src/include
-I/usr/local/src/apache_1.3.20/src/include
-I/usr/local/src/apache_1.3.20/src/os/unix -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include    -c -o _apachemodule.o _apachemodule.c
gcc  -I/usr/local/src/mod_python-2.7.5/src/include
-I/usr/local/src/apache_1.3.20/src/include
-I/usr/local/src/apache_1.3.20/src/os/unix -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include    -c -o requestobject.o requestobject.c
gcc  -I/usr/local/src/mod_python-2.7.5/src/include
-I/usr/local/src/apache_1.3.20/src/include
-I/usr/local/src/apache_1.3.20/src/os/unix -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include    -c -o tableobject.o tableobject.c
gcc  -I/usr/local/src/mod_python-2.7.5/src/include
-I/usr/local/src/apache_1.3.20/src/include
-I/usr/local/src/apache_1.3.20/src/os/unix -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include    -c -o util.o util.c
gcc  -I/usr/local/src/mod_python-2.7.5/src/include
-I/usr/local/src/apache_1.3.20/src/include
-I/usr/local/src/apache_1.3.20/src/os/unix -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include    -c -o serverobject.o serverobject.c
gcc  -I/usr/local/src/mod_python-2.7.5/src/include
-I/usr/local/src/apache_1.3.20/src/include
-I/usr/local/src/apache_1.3.20/src/os/unix -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include    -c -o connobject.o connobject.c

Compiling for DSO. For static, do "make static"

/usr/local/apache/bin/apxs -I/usr/local/src/mod_python-2.7.5/src/include
-I/usr/local/src/apache_1.3.20/src/include
-I/usr/local/src/apache_1.3.20/src/os/unix -I/usr/local/src/Python-2.0
-I/usr/local/src/Python-2.0/Include -c mod_python.o _apachemodule.o
requestobject.o tableobject.o util.o serverobject.o connobject.o  -lm
/usr/local/src/Python-2.0/libpython2.0.a   -ldl    -lm  
ld -H512 -T512 -bhalt:4 -bM:SRE -bnoentry
-bI:/usr/local/apache/libexec/httpd.exp -lc -o mod_python.so mod_python.o
_apachemodule.o requestobject.o tableobject.o util.o serverobject.o
connobject.o -lm /usr/local/src/Python-2.0/libpython2.0.a -ldl -lm
ld: 0711-244 ERROR: No csects or exported symbols have been saved.
apxs:Break: Command failed with rc=8
gmake[1]: *** [mod_python.so] Error 1
gmake[1]: Leaving directory `/usr/local/src/mod_python-2.7.5/src'
gmake: *** [do_dso] Error 2


From WAGLET at uk.ibm.com  Tue Jul 10 17:24:57 2001
From: WAGLET at uk.ibm.com (Tushar Wagle)
Date: Fri Jan  9 22:02:50 2004
Subject: [mod_python] database access within handler problem
Message-ID: <OFA5D85E79.491D0EC1-ON80256A85.00569389@portsmouth.uk.ibm.com>

Hello,

I've got mod_python up and running, but am having a problem connecting to 
my database from inside an AuthenHandler. The code runs fine outside
of mod_python under the 'apache' user, ie the user name/password is
okay, and I've correctly set permissions to allow the user database 
access.

I'm using the latest Python/mod_python with DB2 (and the Python DB2 
wrapper).

Any ideas of what might be wrong?

Are there some restrictions on what can be done (eg different user 
permissions)
from within an Apache Handler??

Could this be a configuration problem?...

Any help appreciated! :)

Best Regards,
Tushar.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010710/e0ad1c98/attachment-0003.htm
From laprice at efn.org  Tue Jul 10 14:51:34 2001
From: laprice at efn.org (larry a price)
Date: Fri Jan  9 22:02:50 2004
Subject: [mod_python] ModPython problems
In-Reply-To: <B770C6FE.38FB%tr@outputlinks.com>
Message-ID: <Pine.GSU.4.21.0107101432040.2738-100000@garcia.efn.org>

Hi, i'm trying to get WebWare 0.5 working with mod_python
i keep on getting this ImportError: module _apache not found
when trying to launch the ModPythonAppServer,
mod_python seems to work fine on it's own, the only thing i can see is
that there is no _apachemodule.so in lib-dynload, though there is an
_apachemodule.o in the build directory from which i installed mod_python,
can i just cp and rename that file or do i need to grovel through the
MakeFile and make sure that it's built as a shared library.

I'm running:
apache 1.3
mod_python 2.7.3
Webware 0.5
on
Debian 2.2.19pre17

Larry Price      |  "We have seen the truth.
laprice@efn.org  |   And the truth makes no sense." -chesterton
_______________________________________________________________





From ChuckEsterbrook at yahoo.com  Tue Jul 10 18:32:25 2001
From: ChuckEsterbrook at yahoo.com (Chuck Esterbrook)
Date: Fri Jan  9 22:02:50 2004
Subject: [mod_python] Re: [Webware-discuss] ModPython problems
In-Reply-To: <Pine.GSU.4.21.0107101432040.2738-100000@garcia.efn.org>
References: <B770C6FE.38FB%tr@outputlinks.com>
Message-ID: <5.0.2.1.0.20010710182905.027669f0@mail.mindspring.com>

At 02:51 PM 7/10/2001 -0700, larry a price wrote:
>Hi, i'm trying to get WebWare 0.5 working with mod_python
>i keep on getting this ImportError: module _apache not found
>when trying to launch the ModPythonAppServer,
>mod_python seems to work fine on it's own, the only thing i can see is
>that there is no _apachemodule.so in lib-dynload, though there is an
>_apachemodule.o in the build directory from which i installed mod_python,
>can i just cp and rename that file or do i need to grovel through the
>MakeFile and make sure that it's built as a shared library.
>
>I'm running:
>apache 1.3
>mod_python 2.7.3
>Webware 0.5
>on
>Debian 2.2.19pre17

I'm sorry to say I don't know the answer to your question, but I'm 
wondering if you really want to run the ModPythonAppServer, as opposed to 
the ModPython adapter which connects to a separately launched app server. 
That is the usual technique (e.g., your choice of adapter, plus the WebKit 
app server) used to run WebKit, because you can then restart the app server 
separate from the web server.

You should consider embedding the app server inside a web server to be more 
experimental, and I suppose the docs should reflect that.

In any case, it might help with diagnosing your problem if you could try 
the ModPythonAdapter and see if that suffers the same problems.


-Chuck


From laprice at efn.org  Tue Jul 10 15:59:49 2001
From: laprice at efn.org (larry a price)
Date: Fri Jan  9 22:02:50 2004
Subject: [mod_python] Re: [Webware-discuss] ModPython problems
In-Reply-To: <5.0.2.1.0.20010710182905.027669f0@mail.mindspring.com>
Message-ID: <Pine.GSU.4.21.0107101547330.5384-100000@garcia.efn.org>

On Tue, 10 Jul 2001, Chuck Esterbrook wrote:
> 
> I'm sorry to say I don't know the answer to your question, but I'm 
> wondering if you really want to run the ModPythonAppServer, as opposed to 
> the ModPython adapter which connects to a separately launched app server. 
> That is the usual technique (e.g., your choice of adapter, plus the WebKit 
> app server) used to run WebKit, because you can then restart the app server 
> separate from the web server.
>
OK, i did get the Webkit.cgi to work and the ModPythonAdapter seems to
work, does the correct redirect, I guess i was under the impression from
the docs that ModPythonAdapter 'required' ModPythonAppserver to work
correctly. Since that's not the case I'm not sure i understand why
ModPythonAppServer exists... it doesn't look like it enables any 
additional functionality. (aside from diddling the apache API)
the import _apache failure still bugs me though (anyone on the mod_python
front who can offer their wisdom?)


From ChuckEsterbrook at yahoo.com  Tue Jul 10 19:13:01 2001
From: ChuckEsterbrook at yahoo.com (Chuck Esterbrook)
Date: Fri Jan  9 22:02:50 2004
Subject: [mod_python] Re: [Webware-discuss] ModPython problems
In-Reply-To: <Pine.GSU.4.21.0107101547330.5384-100000@garcia.efn.org>
References: <5.0.2.1.0.20010710182905.027669f0@mail.mindspring.com>
Message-ID: <5.0.2.1.0.20010710191019.02ca79a0@mail.mindspring.com>

At 03:59 PM 7/10/2001 -0700, larry a price wrote:
>OK, i did get the Webkit.cgi to work and the ModPythonAdapter seems to
>work, does the correct redirect, I guess i was under the impression from
>the docs that ModPythonAdapter 'required' ModPythonAppserver to work
>correctly. Since that's not the case I'm not sure i understand why
>ModPythonAppServer exists... it doesn't look like it enables any
>additional functionality. (aside from diddling the apache API)
>the import _apache failure still bugs me though (anyone on the mod_python
>front who can offer their wisdom?)

Most WebKit app server flavors run as separate Python processes launched 
from the command line:

python Launch.py ThreadedAppServer


But ModPythonAppServer is special: He lives *inside* Apache/mod_python. 
That also means he needs no adapter to shuttle requests and responses 
between himself and the web server.

Presumably this reduces the overhead of having the web and app server talk 
via TCP/IP for greater performance. However, you probably also get multiple 
child process versions of your app server which could easily confound your 
application logic at the very least. And the inability to restart the app 
server independently (as I mentioned earlier).

ModPythonAppServer is due to be moved to an Experimental/ subdirectory.


-Chuck


From jal at faxnet.com  Wed Jul 11 14:22:23 2001
From: jal at faxnet.com (Jonathan LaCour)
Date: Fri Jan  9 22:02:50 2004
Subject: [mod_python] SOAP Handler questions...
Message-ID: <994875744.20546.1.camel@dev7>

Hello,

I am a developer working at a small software company, and we are
researching using mod_python to help us in making a fast SOAP server.
All of the SOAP implementations that I can find use either the built in
Python HTTPServer (which is slow) or Medusa (which has other issues that
I would like to avoid).

Has someone out there developed a Handler for mod_python that would
allow me to easily provide SOAP web services?  If so, please let me know
where I can find the handler.  If not, I would consider developing this
myself.  I just don't want to re-invent the wheel here =)

Thanks in advance!  Also note that I am not subscribed to this list, so
please CC your resposes to me.

Jonathan LaCour



From rsalz at zolera.com  Wed Jul 11 15:12:01 2001
From: rsalz at zolera.com (Rich Salz)
Date: Fri Jan  9 22:02:50 2004
Subject: [mod_python] SOAP Handler questions...
References: <994875744.20546.1.camel@dev7>
Message-ID: <3B4CA501.5ED2429E@zolera.com>

> Has someone out there developed a Handler for mod_python that would
> allow me to easily provide SOAP web services?

ZSI, the Zolera Soap Infrastructure, can work this way -- that's how we
use it (and why we wrote it :).  I believe the ActZero SOAP.py
(pywebsvcs.sf.net) can also work under mod_python.  Both are open
source; ZSI will be released in a week or two
(www.zolera.com/resources/opensrc); documentation is avail at the
referenced link.
	/r$
-- 
Zolera Systems, Securing Web services (XML, SOAP, Signatures,
Encryption)
http://www.zolera.com

From jonas.b at home.se  Thu Jul 12 03:50:29 2001
From: jonas.b at home.se (Jonas Bengtsson)
Date: Fri Jan  9 22:02:50 2004
Subject: [mod_python] Problems getting mod_python up n' running
Message-ID: <NEBBLNLDOLDEJIKDPCBOCEBHCEAA.jonas.b@home.se>

Hi,
I can't get mod_python to work. I get this error message when I'm restarting
Apache:
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
And when I try to look at a .py page I get following error:
[Thu Jul 12 03:33:12 2001] [error] [client 127.0.0.1] python_handler:
make_obcallback returned no obCallBack!

What is wrong?
I've got: Apache/1.3.19 (Win32) mod_python/2.7.4 Python/2.1
Running under Windows 2000

I have put mod_python.dll.in E:\program\apache\modules and following rows to
httpd.conf:
#DSO section
LoadModule python_module e:/program/apache/modules/mod_python.dll
#under my main directory
    AddHandler python-program .py
    PythonHandler mptest
    PythonDebug on

Furthermore I have put following files under
e:\program\python21\libs\mod_python:
__init__.py
apache.py
cgihandler.py
httpdapi.py
publisher.py
util.py
zhandler.py

And my environment path contains:
E:\Program\Python21;e:\Program\Python21\libs


What can be the problem?

TIA
Jonas Bengtsson



From mhughe at ucalgary.ca  Wed Jul 11 22:41:49 2001
From: mhughe at ucalgary.ca (Matt Hughes)
Date: Fri Jan  9 22:02:50 2004
Subject: [mod_python] patch for default functions in the publisher handler (fwd)
Message-ID: <Pine.A41.4.10.10107112241270.125366-200000@acs4.acs.ucalgary.ca>

This is sort of a follow up to this message:
http://www.modpython.org/pipermail/mod_python/2001-June/001421.html, which
discussed how to call a default function from a file using the publisher
handler. 

I wanted similar functionality, but didn't want to resort to the redirect
directive suggested in the last message of that thread. This patch looks
for the PATH_INFO as before, but instead of raising an
apache.HTTP_NOT_FOUND, it puts "default" in func_path as the default
function to call. 

The default function could be made a configuration directive, but I
haven't investigated that. 

This patch also solves some problems I was having when importing modules
in sub-directories. I had a structure like this:

/
/subdir1
/subdir1/subdir2
/subdir1/subdir2/subdir3

and so on, with each directory containing a index.py file which is
configured as the index with the DirectoryIndex directive. The problem was
that a URL refering to /subdir1/subdir2/subdir3 or whatever always found
the index.py file in /. 

This patch fixes this by treating directories off the root as packages.
It's a compelete hack, but it works for me. 


//
// Matt Hughes
// http://www.ucalgary.ca/~mhughe
//

-------------- next part --------------
--- orig-pub.py	Mon Jul  9 20:43:40 2001
+++ publisher.py	Mon Jul  9 20:53:26 2001
@@ -65,6 +65,8 @@
 
 import new
 
+import sys
+
 # list of suffixes - .py, .pyc, etc.
 suffixes = map(lambda x: x[0], imp.get_suffixes())
 
@@ -81,10 +83,11 @@
 
     # get the path PATH_INFO (everthing after script)
     if not _req.subprocess_env.has_key("PATH_INFO"):
-        raise apache.SERVER_RETURN, apache.HTTP_NOT_FOUND
-    
-    func_path = _req.subprocess_env["PATH_INFO"][1:] # skip fist /
-    func_path = string.replace(func_path, "/", ".")
+        func_path = "default"  # Call for a default method
+    else:
+        func_path = _req.subprocess_env["PATH_INFO"][1:] # skip fist /
+        func_path = string.replace(func_path, "/", ".")
+        
     if func_path[-1] == ".":
         func_path = func_path[:-1] 
 
@@ -118,11 +121,19 @@
     # add req
     args["req"] = req
 
-    # import the script
-    path, module_name =  os.path.split(_req.filename)
+    l = len(sys.path[0])
+    module_name = _req.filename[l:]
 
-    # get rid of the suffix
+    # get rid of the suffix... 
     module_name = suff_matcher.sub("", module_name)
+
+    # An alternate way to get rid of the suffix
+    #pos = string.rfind(module_name, '.')
+    #module_name = module_name[:pos]      
+
+    module_name = string.replace(module_name, '/', '.')
+
+    path = _req.filename[0:l]
 
     # import module (or reload if needed)
     module = apache.import_module(module_name, _req, [path])
From Daryl.Johnson at RebusHR.com  Thu Jul 12 14:52:46 2001
From: Daryl.Johnson at RebusHR.com (Daryl.Johnson@RebusHR.com)
Date: Fri Jan  9 22:02:50 2004
Subject: [mod_python] Problems with apxs
Message-ID: <DDA89578AFB4D411AF4700B0D068618C0802BA@PSN004>

I have RedHat 6.2, Apache 1.3.20 and Python2.1.
I have downloaded mod_python-2.7.5.
I have compiled Apache with DSO support and compiled Python without thread
support.
I am unable to compile mod_python as a DSO.
apxs reports an error - rc=255.
I have re-arranged the parameters to apxs but only seem able to get two
responses from it.  It either displays its short help text or reports back
with - rc=255.  Any ideas?  I am at the end of my tether.

Thanks in advance
Daryl Johnson
(RebusHR)


From piet at cs.uu.nl  Thu Jul 12 23:26:32 2001
From: piet at cs.uu.nl (Piet van Oostrum)
Date: Fri Jan  9 22:02:50 2004
Subject: [mod_python] Problems getting mod_python up n' running
In-Reply-To: "Jonas Bengtsson"'s message of "Thu, 12 Jul 2001 03:50:29 +0200"
References: <NEBBLNLDOLDEJIKDPCBOCEBHCEAA.jonas.b@home.se>
Message-ID: <wz66cxrg8n.fsf@sunshine.cs.uu.nl>

>>>>> "Jonas Bengtsson" <jonas.b@home.se> (JB) writes:

JB> Furthermore I have put following files under
JB> e:\program\python21\libs\mod_python:

That should be in e:\program\python21\mod_python

JB> And my environment path contains:
JB> E:\Program\Python21;e:\Program\Python21\libs

You mean PATH? The last part is not necessary.

JB> What can be the problem?

See above.
-- 
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl

From jonas.b at home.se  Thu Jul 12 23:38:11 2001
From: jonas.b at home.se (Jonas Bengtsson)
Date: Fri Jan  9 22:02:51 2004
Subject: [mod_python] Problems getting mod_python up n' running
In-Reply-To: <wz66cxrg8n.fsf@sunshine.cs.uu.nl>
Message-ID: <NEBBLNLDOLDEJIKDPCBOAEBICEAA.jonas.b@home.se>

Thanks... now I got rid off the :
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.

But : [Thu Jul 12 23:30:34 2001] [error] [client 127.0.0.1] python_handler:
make_obcallback returned no obCallBack!
Still occurs... any ideas


/Jonas Bengtsson

-----Original Message-----
From: piet@cs.uu.nl [mailto:piet@cs.uu.nl]
Sent: Thursday, July 12, 2001 11:27 PM
To: Jonas Bengtsson
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Problems getting mod_python up n' running

>>>>> "Jonas Bengtsson" <jonas.b@home.se> (JB) writes:

JB> Furthermore I have put following files under
JB> e:\program\python21\libs\mod_python:

That should be in e:\program\python21\mod_python

JB> And my environment path contains:
JB> E:\Program\Python21;e:\Program\Python21\libs

You mean PATH? The last part is not necessary.

JB> What can be the problem?

See above.
--
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl


From Daryl.Johnson at RebusHR.com  Fri Jul 13 11:08:12 2001
From: Daryl.Johnson at RebusHR.com (Daryl.Johnson@RebusHR.com)
Date: Fri Jan  9 22:02:51 2004
Subject: [mod_python] Problems getting mod_python up n' running
Message-ID: <DDA89578AFB4D411AF4700B0D068618C0802BD@PSN004>

I was getting messages very similar to these right up until yesterday.
Although I'm using Linux and you are using Windows, I think the problem
might stem from the same thing.
Mine turned out to be a linker problem when mod_python.so (I think .dll in
your case) was being built.
The mod_python.so file was only half the size that it is now that it is
working.
It was about 700Kb and is now about 1.5Mb.  These sizes might be different
on Windows, but it is clear to me that mod_python.so had not linked in a
whole sack of libraries that it would need.
I hope this is of some help

Daryl Johnson.

-----Original Message-----
From: Jonas Bengtsson [mailto:jonas.b@home.se]
Sent: Thursday, July 12, 2001 10:38 PM
To: piet@cs.uu.nl
Cc: mod_python@modpython.org
Subject: RE: [mod_python] Problems getting mod_python up n' running


Thanks... now I got rid off the :
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.

But : [Thu Jul 12 23:30:34 2001] [error] [client 127.0.0.1] python_handler:
make_obcallback returned no obCallBack!
Still occurs... any ideas


/Jonas Bengtsson

-----Original Message-----
From: piet@cs.uu.nl [mailto:piet@cs.uu.nl]
Sent: Thursday, July 12, 2001 11:27 PM
To: Jonas Bengtsson
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Problems getting mod_python up n' running

>>>>> "Jonas Bengtsson" <jonas.b@home.se> (JB) writes:

JB> Furthermore I have put following files under
JB> e:\program\python21\libs\mod_python:

That should be in e:\program\python21\mod_python

JB> And my environment path contains:
JB> E:\Program\Python21;e:\Program\Python21\libs

You mean PATH? The last part is not necessary.

JB> What can be the problem?

See above.
--
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python

From grisha at modpython.org  Fri Jul 13 11:14:07 2001
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:02:51 2004
Subject: [mod_python] Error: No such file or directory
In-Reply-To: <Pine.LNX.4.31.0107031247070.13943-100000@unity.copyleft.no>
Message-ID: <Pine.BSF.4.32.0107131113440.94495-100000@localhost>

I've added a FAQ entry on this one:

http://www.modpython.org/FAQ/faqw.py?req=all#2.3

Grisha

On Tue, 3 Jul 2001, Hr. Daniel Mikkelsen wrote:

> >> OSError: [Errno 2] No such file or directory: '/home/demo/cgi-bin/test.p'
>
> > Have a closer look at the filename.  I think this is a typo.
>
> I don't know if it's the same thing here, but I'm running FreeBSD, and
> mod_python erranously cuts the last character of filename of the handler
> I've given. I had to remove a [:-1] suffix a couple of places in apache.py
> (I think) to get it to work.
>
> I'll post more details if it's interesting to anyone.
>
> -- Daniel Mikkelsen, Copyleft Software AS
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From jonas.b at home.se  Fri Jul 13 19:33:57 2001
From: jonas.b at home.se (Jonas Bengtsson)
Date: Fri Jan  9 22:02:51 2004
Subject: [mod_python] Problems getting mod_python up n' running
In-Reply-To: <DDA89578AFB4D411AF4700B0D068618C0802BD@PSN004>
Message-ID: <NEBBLNLDOLDEJIKDPCBOGEBKCEAA.jonas.b@home.se>

I don't think that is the problem in my case. My mod_python.dll is about 45
kb and that seems normal

Does any one else have a clue? I'm about to look elsewhere for Python
support in Apache... mod_python seems to work very poorly under Windows.


Jonas Bengtsson

-----Original Message-----
From: Daryl.Johnson@RebusHR.com [mailto:Daryl.Johnson@RebusHR.com]
Sent: Friday, July 13, 2001 12:08 PM
To: jonas.b@home.se
Cc: mod_python@modpython.org
Subject: RE: [mod_python] Problems getting mod_python up n' running

I was getting messages very similar to these right up until yesterday.
Although I'm using Linux and you are using Windows, I think the problem
might stem from the same thing.
Mine turned out to be a linker problem when mod_python.so (I think .dll in
your case) was being built.
The mod_python.so file was only half the size that it is now that it is
working.
It was about 700Kb and is now about 1.5Mb.  These sizes might be different
on Windows, but it is clear to me that mod_python.so had not linked in a
whole sack of libraries that it would need.
I hope this is of some help

Daryl Johnson.

-----Original Message-----
From: Jonas Bengtsson [mailto:jonas.b@home.se]
Sent: Thursday, July 12, 2001 10:38 PM
To: piet@cs.uu.nl
Cc: mod_python@modpython.org
Subject: RE: [mod_python] Problems getting mod_python up n' running


Thanks... now I got rid off the :
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.

But : [Thu Jul 12 23:30:34 2001] [error] [client 127.0.0.1] python_handler:
make_obcallback returned no obCallBack!
Still occurs... any ideas


/Jonas Bengtsson

-----Original Message-----
From: piet@cs.uu.nl [mailto:piet@cs.uu.nl]
Sent: Thursday, July 12, 2001 11:27 PM
To: Jonas Bengtsson
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Problems getting mod_python up n' running

>>>>> "Jonas Bengtsson" <jonas.b@home.se> (JB) writes:

JB> Furthermore I have put following files under
JB> e:\program\python21\libs\mod_python:

That should be in e:\program\python21\mod_python

JB> And my environment path contains:
JB> E:\Program\Python21;e:\Program\Python21\libs

You mean PATH? The last part is not necessary.

JB> What can be the problem?

See above.
--
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python


From piet at cs.uu.nl  Fri Jul 13 21:48:40 2001
From: piet at cs.uu.nl (Piet van Oostrum)
Date: Fri Jan  9 22:02:51 2004
Subject: [mod_python] Problems getting mod_python up n' running
In-Reply-To: "Jonas Bengtsson"'s message of "Fri, 13 Jul 2001 19:33:57 +0200"
References: <NEBBLNLDOLDEJIKDPCBOGEBKCEAA.jonas.b@home.se>
Message-ID: <wz4rsgmwyv.fsf@sunshine.cs.uu.nl>

>>>>> "Jonas Bengtsson" <jonas.b@home.se> (JB) writes:

JB> I don't think that is the problem in my case. My mod_python.dll is about 45
JB> kb and that seems normal

JB> Does any one else have a clue? I'm about to look elsewhere for Python
JB> support in Apache... mod_python seems to work very poorly under Windows.

That is not true. However you must be careful to install it properly:
- use the correct version of the dll (corresponding to the python version)
- put the dll in the Apache module directory
- add the LoadModule clause to Apache's config file
- add the handler declaration to Apache's config
- put the .py files n the proper Python directory
-- 
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl

From jonas.b at home.se  Sat Jul 14 11:19:50 2001
From: jonas.b at home.se (Jonas Bengtsson)
Date: Fri Jan  9 22:02:51 2004
Subject: [mod_python] Problems getting mod_python up n' running
In-Reply-To: <wz4rsgmwyv.fsf@sunshine.cs.uu.nl>
Message-ID: <NEBBLNLDOLDEJIKDPCBOGEBLCEAA.jonas.b@home.se>

Ahh... Now I got it to work. It wasn't the environment PATH variable that I
should change but the PythonPath variable in the Registry.

Now I get the following error:
"""
Mod_python error: "PythonHandler mptest"

Traceback (most recent call last):

  File "e:\program\python21\mod_python\apache.py", line 181, in Dispatch
    module = import_module(module_name, _req)

  File "e:\program\python21\mod_python\apache.py", line 335, in
import_module
    f, p, d = imp.find_module(parts[i], path)

ImportError: No module named mptest
"""
But I have not looked into it to see why this occurs so I guess it is just
something trivial..

Thanks for all help!

/Jonas B

-----Original Message-----
From: piet@cs.uu.nl [mailto:piet@cs.uu.nl]
Sent: Friday, July 13, 2001 9:49 PM
To: Jonas Bengtsson
Cc: Daryl.Johnson@RebusHR.com; mod_python@modpython.org
Subject: Re: [mod_python] Problems getting mod_python up n' running

>>>>> "Jonas Bengtsson" <jonas.b@home.se> (JB) writes:

JB> I don't think that is the problem in my case. My mod_python.dll is about
45
JB> kb and that seems normal

JB> Does any one else have a clue? I'm about to look elsewhere for Python
JB> support in Apache... mod_python seems to work very poorly under Windows.

That is not true. However you must be careful to install it properly:
- use the correct version of the dll (corresponding to the python version)
- put the dll in the Apache module directory
- add the LoadModule clause to Apache's config file
- add the handler declaration to Apache's config
- put the .py files n the proper Python directory
--
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl


From piet at cs.uu.nl  Sun Jul 15 16:11:44 2001
From: piet at cs.uu.nl (Piet van Oostrum)
Date: Fri Jan  9 22:02:51 2004
Subject: [mod_python] Problems getting mod_python up n' running
In-Reply-To: "Jonas Bengtsson"'s message of "Sat, 14 Jul 2001 11:19:50 +0200"
References: <NEBBLNLDOLDEJIKDPCBOGEBLCEAA.jonas.b@home.se>
Message-ID: <wzsnfygu3j.fsf@sunshine.cs.uu.nl>

>>>>> "Jonas Bengtsson" <jonas.b@home.se> (JB) writes:

JB> Ahh... Now I got it to work. It wasn't the environment PATH variable that I
JB> should change but the PythonPath variable in the Registry.

In fact, if you put the files in the subdirectory mod_python of your main
Python directory, this is not necessary. Anyway, the libs directory is the
wrong one, because it is meant for .lib files (which you only need if you
compile python extensions).

JB> Now I get the following error:
JB> """
JB> Mod_python error: "PythonHandler mptest"

JB> Traceback (most recent call last):

JB>   File "e:\program\python21\mod_python\apache.py", line 181, in Dispatch
JB>     module = import_module(module_name, _req)

JB>   File "e:\program\python21\mod_python\apache.py", line 335, in
JB> import_module
JB>     f, p, d = imp.find_module(parts[i], path)

JB> ImportError: No module named mptest
JB> """
JB> But I have not looked into it to see why this occurs so I guess it is just
JB> something trivial..

It probably means that mptest.py is not in the directory that is mentioned
as the PythonHandler in your Apache config file. Maybe you gave it another
name. 
-- 
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl

From tree at basistech.com  Tue Jul 17 15:54:07 2001
From: tree at basistech.com (Tom Emerson)
Date: Fri Jan  9 22:02:51 2004
Subject: [mod_python] Import errors in 2.7.5
Message-ID: <15188.38879.991539.849967@cymru.basistech.com>

I'm repeatedly getting an error using mod_python 2.7.5, Python 2.0
with exceptions patch, Apache 1.3.19, on FreeBSD 4.2:

ue Jul 17 16:29:46 2001] [error] PythonHandler mod_python.publisher: Traceback (most recent call last):
[Tue Jul 17 16:29:46 2001] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.0/site-packages/mod_python/apache.py", line 193, in Dispatch
    result = object(req)
[Tue Jul 17 16:29:46 2001] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.0/site-packages/mod_python/publisher.py", line 128, in handler
    module = apache.import_module(module_name, _req, [path])
[Tue Jul 17 16:29:46 2001] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.0/site-packages/mod_python/apache.py", line 364, in import_module
    module = reload(module)
[Tue Jul 17 16:29:46 2001] [error] PythonHandler mod_python.publisher: ImportError: No module named add

I have to shutdown the server and start it back up to make this go
away, at which point things are fine for a while, then it comes
back. Suffice it to say this is annoying.

Before I start digging, has anyone else seen this? I never saw this in
2.7.1 (the previous version I had installed).

TIA,

    -tree

-- 
Tom Emerson                                          Basis Technology Corp.
Sr. Sinostringologist                              http://www.basistech.com
  "Beware the lollipop of mediocrity: lick it once and you suck forever"

From a_mayerson at yahoo.com  Tue Jul 17 20:12:05 2001
From: a_mayerson at yahoo.com (aaron mayerson)
Date: Fri Jan  9 22:02:51 2004
Subject: [mod_python] Function sequence error
Message-ID: <20010718031205.98105.qmail@web10906.mail.yahoo.com>

Greetings,

  I have a script that works from the command line but
not with mod_python and apache.  I've looked elsewhere
and found that this error relates to the odbc calls
being called out of order.
  I'm not exactly sure why the heck the calls would be
out of order when running through mod_python and
apache and not when run from the command line. 
Anybody have a clue as to why this is happening?
  Thanks for the help...

The error:

Mod_python error: "PythonHandler stats"

Traceback (most recent call last):

  File "d:\python21\lib\mod_python\apache.py", line
181, in Dispatch

  File "d:\python21\lib\mod_python\apache.py", line
364, in import_module

  File "c:/program files/apache
group/apache/htdocs/python/\stats.py", line 7, in ?
    db = mx.DriverConnect('DSN=stats')

InternalError: ('S1010', 0, '[Microsoft][ODBC Driver
Manager] Function sequence error', 5806)

The code:

import sping.PIL as pid
import mx.ODBC.Windows as mx
from os import chdir



db = mx.DriverConnect('DSN=stats')
cur = db.cursor()
cur.execute('select * from address_count')
values = cur.fetchall()
cur.close()
db.close()

hits = 0
for value in values:
    hits += value[1]

canvas = pid.PILCanvas(size=(600,
(len(values)*15)+15))
canvas.defaultLineWidth = 7.5
canvas.defaultLineColor = pid.red
y1 = 15
x1 = 100
y2 = 15
for value in values:
    x2 = 100 + (3000 * (float(value[1])/hits))
    canvas.drawLine(x1, y1, x2, y2)
    canvas.drawString(value[0], 5, (y1+2.5),
pid.Font(face="monospaced",size=10),
                      color=pid.black)
    canvas.drawString(str(value[1]), (x2+10),
(y1+2.5), pid.Font(face="monospaced",size=10),
                      color=pid.black)
    y1 += 15
    y2 += 15

canvas.flush()
chdir(r'c:\program files\apache
group\apache\htdocs\python')
canvas.save('hits', format='gif')

__________________________________________________
Do You Yahoo!?
Get personalized email addresses from Yahoo! Mail
http://personal.mail.yahoo.com/

From garyp at asti-usa.com  Wed Jul 18 16:10:51 2001
From: garyp at asti-usa.com (Gary Perez)
Date: Fri Jan  9 22:02:51 2004
Subject: [mod_python] Dispatch() returned nothing (?)
Message-ID: <3B55ED4A.63051A14@asti-usa.com>

Hi, all.

Looking forward to getting this working... either that or it's back to
Zope! ;)

Here's the installation info:
SuSE Linux 7.2, kernel 2.4.4, reiserfs
Apache 1.3.19 + Python 2.0 + mod_python 2.7.2

(Note: I attempted to install mod_python 2.7.5 from source, and that
completely hosed Apache, so I went back to the YAST2-based 2.7.2 installation.)

I'm stuck at the "2.4 Testing" section; Apache is throwing an internal
server error on attempt to load http://localhost/test/mptest.py . Here
are pieces of the relevant files:

ERROR LOG
[Wed Jul 18 15:58:02 2001] [notice] Apache/1.3.19 (Unix)  (SuSE/Linux)
mod_layout/1.0 mod_throttle/3.0 mod_fastcgi/2.2.2 mod_ssl/2.8.3
OpenSSL/0.9.6a PHP/4.0.4pl1 mod_perl/1.25 mod_dtcl mod_python/2.7.2
Python/2.0 configured -- resuming normal operations
[Wed Jul 18 15:58:02 2001] [notice] suEXEC mechanism enabled (wrapper: /usr/sbin/suexec)
[Wed Jul 18 15:58:18 2001] [error] [client 192.168.100.100]
python_handler: Dispatch() returned nothing.

HTTPD.CONF
<Directory "/usr/local/httpd/htdocs/test">
    AddHandler python-program .py
    PythonHandler mptest
    PythonDebug On
    AllowOverride All
</Directory>

.HTACCESS
AddHandler python-program .py
PythonHandler mptest
PythonDebug On

I also tried it without the "AllowOverride" line in httpd.conf and no
.htaccess file in the directory, but it throws the same error.

Any ideas as to what I'm doing wrong? Thanks in advance for your help!
-Gary

From mikael.johansson at sema.se  Thu Jul 19 13:52:10 2001
From: mikael.johansson at sema.se (Mikael Johansson)
Date: Fri Jan  9 22:02:51 2004
Subject: [mod_python] Compiling problem.
Message-ID: <01c201c11049$3e77f330$036716ac@got.sema.se>

Hello everyone.

I have a problem to include pyhton into my apache configuration.

I'm running HP-UX Ver 11.0

I have downloade apache 1.13.12

I have downloaded and installed Python 1.5.2 (configure, make and make install)

I have downloded mod_python 2.7.5 and have run configure, make and make install... 

No problem so fare... (not so many anyway..)

My problem is when I go back to Apache and run..

./configure --activate-module=src/modules/python/libpython.a

It runs whith no error, after that I try to the small command make, output below, any Ideas ? 

=== cut ==

<=== src/modules

cc -c -I./os/unix -I./include -DHPUX11 -Aa -Ae -D_HPUX_SOURCE -DUSE_HSREGEX -DUSE_EXPAT -I./lib/expat-lite -DNO_DL_NEEDEc

cc -c -I./os/unix -I./include -DHPUX11 -Aa -Ae -D_HPUX_SOURCE -DUSE_HSREGEX -DUSE_EXPAT -I./lib/expat-lite -DNO_DL_NEEDEc

cc -DHPUX11 -Aa -Ae -D_HPUX_SOURCE -DUSE_HSREGEX -DUSE_EXPAT -I./lib/expat-lite -DNO_DL_NEEDED `./apaci` \

-o httpd buildmark.o modules.o modules/python/libpython.a modules/standard/libstandard.a main/libmain.a ./os/unixd

/usr/ccs/bin/ld: Unsatisfied symbols:

PyObject_HasAttrString (code)

PyString_AsString (code)

PyModule_GetDict (code)

Py_OptimizeFlag (data)

PyThreadState_Delete (code)

PyExc_TypeError (data)

PySequence_Index (code)

PyDict_New (code)

PyCObject_AsVoidPtr (code)

PyImport_ImportModule (code)

PyCObject_FromVoidPtr (code)

_PyString_Resize (code)

PyErr_Fetch (code)

PyObject_Str (code)

PyList_Size (code)

PyString_ConcatAndDel (code)

PyDict_GetItem (code)

PyDict_SetItem (code)

Py_BuildValue (code)

PyEval_SaveThread (code)

PyCallable_Check (code)

PyObject_CallMethod (code)

PyExc_IndexError (data)

PyErr_NoMemory (code)

Py_FindMethod (code)

PyTuple_SetItem (code)

PyMember_Set (code)

PyDict_GetItemString (code)

PyMapping_HasKeyString (code)

PyErr_NewException (code)

PyList_New (code)

PyList_SetItem (code)

PyExc_AttributeError (data)

PyObject_CallFunction (code)

PyErr_Print (code)

PyInt_Type (data)

PyType_Type (data)

PyObject_GetAttrString (code)

PyThreadState_Swap (code)

PyErr_Occurred (code)

PyString_Type (data)

PyDict_SetItemString (code)

PyThreadState_New (code)

PyString_FromString (code)

PyMember_Get (code)

Py_Initialize (code)

PyInt_AsLong (code)

PyExc_ValueError (data)

PyEval_RestoreThread (code)

PyErr_BadArgument (code)

PyArg_ParseTuple (code)

Py_IsInitialized (code)

Py_NewInterpreter (code)

PyExc_KeyError (data)

PyExc_IOError (data)

PyList_Append (code)

PyString_FromStringAndSize (code)

Py_InitModule4 (code)

PyErr_SetObject (code)

PyList_SetSlice (code)

PyErr_Clear (code)

Py_Finalize (code)

_Py_NoneStruct (data)

PyErr_SetString (code)

Py_GetVersion (code)

PyInt_FromLong (code)

PyTuple_New (code)

*** Error exit code 1

Stop.

*** Error exit code 1

Stop.

*** Error exit code 1

Stop.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010719/390bb364/attachment-0003.htm
From markus.hillebrand at apis-group.net  Thu Jul 19 13:57:54 2001
From: markus.hillebrand at apis-group.net (markus.hillebrand@apis-group.net)
Date: Fri Jan  9 22:02:51 2004
Subject: [mod_python] mod_python + MySQLdb => does it work?
Message-ID: <XFMail.010719135754.markus.hillebrand@apis.intra>


 Hello to all you out there!

I tried to bring mod_python and MySQLdb together,
but I crashed on some problems.

First of all: mod_python runs quite fine.
Also MySQLdb runs quite well.

But when I try to import MySQLdb from a python-script
that was invoked by mod_python I get a

ImportError: _mysql: init failed 
(whole error message is in the attachement)

System: Linux 6.4(i386) - Kernel 2.2.14(4)
        apache 1.3.19
        Python 2.0
        mod_python 2.7.5
        MySQLdb 0.9.0

Has somebody out there a running system like this?
Would be very helpfull to bring mod_python and MySQLdb
together - or is there another solution to access
a MySQL database?

        Bye, Markus        

-- 
Markus Hillebrand, Dipl.Inf.(FH), Software-Engineer
Apis networks GmbH, Kronstadter Str. 11, 81677 Muenchen, Germany
Tel.: +49 (089) 357147-23 ; eMail: markus.hillebrand@apis-group.net
-------------- next part --------------
A non-text attachment was scrubbed...
Name: error.html
Type: application/octet-stream
Size: 639 bytes
Desc: error.html
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20010719/6957c32e/error-0003.obj
From tree at basistech.com  Thu Jul 19 07:37:26 2001
From: tree at basistech.com (Tom Emerson)
Date: Fri Jan  9 22:02:51 2004
Subject: [mod_python] mod_python + MySQLdb => does it work?
In-Reply-To: <XFMail.010719135754.markus.hillebrand@apis.intra>
References: <XFMail.010719135754.markus.hillebrand@apis.intra>
Message-ID: <15190.50806.775640.191120@cymru.basistech.com>

markus.hillebrand@apis-group.net writes:
> I tried to bring mod_python and MySQLdb together,
> but I crashed on some problems.

This works very well.

> First of all: mod_python runs quite fine.
> Also MySQLdb runs quite well.
> 
> But when I try to import MySQLdb from a python-script
> that was invoked by mod_python I get a
> 
> ImportError: _mysql: init failed 
> (whole error message is in the attachement)

Check your Python load path within mod_python, and make sure that the
directory containing the MySQLdb modules is there. Also make sure that
the MySQLdb shared object can be found in the library search path.


-- 
Tom Emerson                                          Basis Technology Corp.
Sr. Sinostringologist                              http://www.basistech.com
  "Beware the lollipop of mediocrity: lick it once and you suck forever"

From markus.hillebrand at apis-group.net  Thu Jul 19 14:47:07 2001
From: markus.hillebrand at apis-group.net (markus.hillebrand@apis-group.net)
Date: Fri Jan  9 22:02:51 2004
Subject: [mod_python] mod_python + MySQLdb => does it work?
In-Reply-To: <15190.50806.775640.191120@cymru.basistech.com>
Message-ID: <XFMail.010719144707.markus.hillebrand@apis.intra>

On 19-Jul-01 Tom Emerson wrote:
> markus.hillebrand@apis-group.net writes:
>> I tried to bring mod_python and MySQLdb together,
>> but I crashed on some problems.
> 
> This works very well.
Fine to hear that, so my tries are making sense ;)

>> First of all: mod_python runs quite fine.
>> Also MySQLdb runs quite well.
>> 
>> But when I try to import MySQLdb from a python-script
>> that was invoked by mod_python I get a
>> 
>> ImportError: _mysql: init failed 
>> (whole error message is in the attachement)
> 
> Check your Python load path within mod_python, and make sure that the
> directory containing the MySQLdb modules is there. Also make sure that
> the MySQLdb shared object can be found in the library search path.

I did this already and I created a script,
that I started with mod_python and I called

oRequest.write( str( imp.find_module("MySQLdb"))) 
  Result:(None,'/opt/<...>/site-packages/MySQLdb' , ('', '',5))

oRequest.write( str( imp.find_module("_mysql")))
  Result:(,'/opt/<...>/sitepackages/_mysql.so', ('.so', 'rb',3))

I think I have another problem. But which one?
Maybe my special configuration does not work,
may you tell me yours, Tom?

-- 
Markus Hillebrand, Dipl.Inf.(FH), Software-Engineer
Apis networks GmbH, Kronstadter Str. 11, 81677 Muenchen, Germany
Tel.: +49 (089) 357147-23 ; eMail: markus.hillebrand@apis-group.net

From tree at basistech.com  Thu Jul 19 08:51:34 2001
From: tree at basistech.com (Tom Emerson)
Date: Fri Jan  9 22:02:51 2004
Subject: [mod_python] mod_python + MySQLdb => does it work?
In-Reply-To: <XFMail.010719144707.markus.hillebrand@apis.intra>
References: <15190.50806.775640.191120@cymru.basistech.com>
	<XFMail.010719144707.markus.hillebrand@apis.intra>
Message-ID: <15190.55254.949564.915370@cymru.basistech.com>

markus.hillebrand@apis-group.net writes:
> I did this already and I created a script,
> that I started with mod_python and I called

I'm currently running the following setup:

FreeBSD 4.2-RELEASE, with recent security updates
Apache 1.3.19
  PHP/4.0.4pl1
  mod_python/2.7.5
  Python/2.0 (with patch for the exception problem)
MySQL 3.23.37
MySQLdb, 2000-11-30 release

Does your server errorlog or machine's messages log give any clues as
to why the failure is happening? Do you have more than one Python
installation on the machine? I had problems with this in the past.

Otherwise I'm stumped.

-- 
Tom Emerson                                          Basis Technology Corp.
Sr. Sinostringologist                              http://www.basistech.com
  "Beware the lollipop of mediocrity: lick it once and you suck forever"

From tree at basistech.com  Thu Jul 19 09:06:47 2001
From: tree at basistech.com (Tom Emerson)
Date: Fri Jan  9 22:02:51 2004
Subject: [mod_python] mod_python mailing list archive issue
Message-ID: <15190.56167.224323.751981@cymru.basistech.com>

The link to download the full raw archive of the mod_python mailing
list doesn't work for me: can anyone else get the whole lot of
messages?

-- 
Tom Emerson                                          Basis Technology Corp.
Sr. Sinostringologist                              http://www.basistech.com
  "Beware the lollipop of mediocrity: lick it once and you suck forever"

From tree at basistech.com  Thu Jul 19 09:16:14 2001
From: tree at basistech.com (Tom Emerson)
Date: Fri Jan  9 22:02:51 2004
Subject: [mod_python] More on import errors in 2.7.5
Message-ID: <15190.56734.977727.647366@cymru.basistech.com>

A couple of days ago I posted a question about strange import
behaviors with 2.7.5,

<http://www.modpython.org/pipermail/mod_python/2001-July/001519.html>

I haven't heard from anyone with a solution, though scanning the
archives it appears that this has been an issue for a while for some
people. So I started digging.

The short: the problem is still there.

The long:

- I reverted to 2.7.2 and the problem is still there. <sigh>

- I added some log_error() calls in various places in both publisher.py
  and apache.py to verify the state of the world upto the point
  apache.py attempts to reload the module. As far as I can tell,
  everything is valid up to the point of the reload call: sys.modules
  includes an entry for the module I'm reloading, the pathnames to the
  module are correct, everything looks fine, but reload() is throwing
  an ImportError.

  I observed that this problem usually happens in the following
  scenario:

  1) The module is loaded successfully.
  2) You make a modification to the module source which causes
     mod_python to reload the module. This works fine.
  3) You make another modification to the module that will cause an
     error when the module is being parsed when it is reloaded.
  4) You fix the error and reload.
  5) Bam, ImportError.

  Could it be the case that the module is partially initialized and
  isn't really reloadable?

Also, FWIW, the server doesn't have write access to the directory
containing these modules, so the .pyc files are not being created.

Food for thought.

    -tree

-- 
Tom Emerson                                          Basis Technology Corp.
Sr. Sinostringologist                              http://www.basistech.com
  "Beware the lollipop of mediocrity: lick it once and you suck forever"

From Alain.Tesio at actfs.fr  Thu Jul 19 16:02:50 2001
From: Alain.Tesio at actfs.fr (Alain.Tesio@actfs.fr)
Date: Fri Jan  9 22:02:51 2004
Subject: [mod_python] mod_python + MySQLdb => does it work
Message-ID: <OFA20499D4.3F551BBF-ONC1256A8E.004C5B52@actfs.fr>

Hi, it works for me on Linux Debian with Python 2.1, MySQLdb and mod_python
installed from source.

If it works when starting python from a shell, it means that the there is
something
missing in the environment of the user running apache.

Maybe try one of these commands to add this before "import MySQLdb" :

sys.path.append("/path/where/is/mysqldb")
os.environ["LD_LIBRARY_PATH"]="/path/to/the/shared/object"

Alain





______________________________________________________________________________


The views and opinions expressed in this email message are the sender's and
do not necessarily represent the views and opinions of ACT Financial
Systems S.A.
______________________________________________________________________________




From markus.hillebrand at apis-group.net  Thu Jul 19 18:50:32 2001
From: markus.hillebrand at apis-group.net (markus.hillebrand@apis-group.net)
Date: Fri Jan  9 22:02:51 2004
Subject: [mod_python] mod_python + MySQLdb => does it work? YES!
In-Reply-To: <XFMail.010719135754.markus.hillebrand@apis.intra>
Message-ID: <XFMail.010719185032.markus.hillebrand@apis.intra>

On 19-Jul-01 markus.hillebrand@apis-group.net wrote:
> 
>  Hello to all you out there!
> 
> I tried to bring mod_python and MySQLdb together,
> but I crashed on some problems.

Okay, after playing around with all these
pathes and settings ... I recompiled 
the python-component v2.1.1c1 --without-threads
And what shall I say. Now it works fine.
I'm quite happy now (until the next problem occurs).

Thanx to all of you.
-- 
Markus Hillebrand, Dipl.Inf.(FH), Software-Engineer
Apis networks GmbH, Kronstadter Str. 11, 81677 Muenchen, Germany
Tel.: +49 (089) 357147-23 ; eMail: markus.hillebrand@apis-group.net

From mikael.johansson at sema.se  Fri Jul 20 09:38:56 2001
From: mikael.johansson at sema.se (Mikael Johansson)
Date: Fri Jan  9 22:02:51 2004
Subject: [mod_python] (no subject)
Message-ID: <003601c110ef$08b93c30$036716ac@got.sema.se>

Any Ideas for my installation problem ?   

HPUX 11.0, Pyhton 1.5., Mod_Pyhton 2.7.5

/MiJo/

================cut=========================



root@gotuh03> ./configure --with-apxs=/opt/apache/bin/apxs

loading cache ./config.cache

checking for gcc... no

checking for cc... cc

checking whether the C compiler (cc ) works... yes

checking whether the C compiler (cc ) is a cross-compiler... no

checking whether we are using GNU C... no

checking whether cc accepts -g... yes

checking for ranlib... ranlib

checking for ar... ar

checking for a BSD compatible install... /opt/imake/bin/install -c

checking whether make sets ${MAKE}... yes

checking for main in -lm... yes

checking for working const... yes

checking your blood pressure... a bit high, but we can proceed

checking whether apxs is available

checking for --with-apxs... /opt/apache/bin/apxs executable, good

checking for Apache libexec directory... /opt/apache/libexec

checking for Apache include directory... -I/opt/apache/include

checking for --with-apache... no

configure: warning: **** No apache sources specified, static compilation will not be available.

configure: warning: **** You can use --with-apache to specify where your Apache sources are.

checking for --with-python... no

checking for python... /usr/local/bin/python

checking Python version... 1.5

checking whether Python is compiled with thread support... no threads, good

checking Python install prefix... /usr/local

checking what libraries Python was linked with... /usr/local/lib/python1.5/config/libpython1.5.a -lnet -lnsl -ldld -lm 

checking linker flags used to link Python... 

checking where Python include files are... -I/usr/local/include/python1.5

checking for mkdep... no

checking for makedepend... /opt/imake/bin/makedepend

updating cache ./config.cache

creating ./config.status

creating Makefile

creating src/Makefile

creating src/libpython.module

creating Doc/Makefile

analyzing dependencies





root@gotuh03> make dso

Compiling for DSO. For static, do "make static"

/opt/apache/bin/apxs -I/opt/install/mod_python-2.7.5/src/include -I/opt/apache/include -I/usr/local/include/python1.5 -c mo 

ld -b -o mod_python.so mod_python.o _apachemodule.o requestobject.o tableobject.o util.o serverobject.o connobject.o -lm /usr/local 

ld: Invalid loader fixup in text space needed in output file for symbol "$000000B1" in input file "/usr/local/lib/python1.5/config/"

apxs:Break: Command failed with rc=65536

*** Error exit code 1

Stop.

*** Error exit code 1

Stop.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010720/6b0783f9/attachment-0003.htm
From polygnwnd at yahoo.com  Tue Jul 24 20:20:06 2001
From: polygnwnd at yahoo.com (polygnwnd)
Date: Fri Jan  9 22:02:51 2004
Subject: [mod_python] example test fails-- how to convince apache to search the correct path for python modules?
Message-ID: <20010725032006.88880.qmail@web12507.mail.yahoo.com>

Well, I am interested in mod_python, but am having a
hard time getting it to work. I notice
that my specific problem has come up on both Windows
and Linux and I cannot find a working
solution in the mail archives (maybe I overlooked
something?). 

What I "know"...

Platform: Linux 2.4 kernel, atop old, but vanilla
Debian

All packages used here are installed below
/home/polygnwnd/httpd:
  Python: python/2.0.1/(bin, lib, etc.)
  Apache: apache/1.3.20/(bin,libexec, etc.)

Configured options:
  Python: --without-threads
  Apache: --enable-module=rewrite
--enable-shared=rewrite
  mod_python:
--with-apxs=/home/polygnwnd/httpd/apache/1.3.20/bin/apxs
\
             
--with-python=/home/polygnwnd/src/httpd/python/2.0.1
              # I pointed with-python to the python
src build dir, makes configure happy

An strace on the httpd process reveals many
unsuccessful attempts to access
the system python library. The result:

  stat("/usr/lib/python2.0/mod_python", 0xbfffeaec) =
-1 ENOENT (No such file or directory)
  open("/usr/lib/python2.0/mod_python.so", O_RDONLY) =
-1 ENOENT (No such file or directory)
  open("/usr/lib/python2.0/mod_pythonmodule.so",
O_RDONLY) = -1 ENOENT (No such file or directory)
  open("/usr/lib/python2.0/mod_python.py", O_RDONLY) =
-1 ENOENT (No such file or directory)
  open("/usr/lib/python2.0/mod_python.pyc", O_RDONLY)
= -1 ENOENT (No such file or directory)
  stat("/usr/lib/python2.0/plat-linux2/mod_python",
0xbfffeaec) = -1 ENOENT (No such file or directory)
  open("/usr/lib/python2.0/plat-linux2/mod_python.so",
O_RDONLY) = -1 ENOENT (No such file or directory)
 
open("/usr/lib/python2.0/plat-linux2/mod_pythonmodule.so",
O_RDONLY) = -1 ENOENT (No such file or directory)
  open("/usr/lib/python2.0/plat-linux2/mod_python.py",
O_RDONLY) = -1 ENOENT (No such file or directory)
 
open("/usr/lib/python2.0/plat-linux2/mod_python.pyc",
O_RDONLY) = -1 ENOENT (No such file or directory)
  stat("/usr/lib/python2.0/lib-tk/mod_python",
0xbfffeaec) = -1 ENOENT (No such file or directory)
  stat("/usr/lib/python2.0/site-packages/mod_python",
0xbfffeaec) = -1 ENOENT (No such file or directory)
 
open("/usr/lib/python2.0/site-packages/mod_python.so",
O_RDONLY) = -1 ENOENT (No such file or directory)
 
open("/usr/lib/python2.0/site-packages/mod_pythonmodule.so",
O_RDONLY) = -1 ENOENT (No such file or directory)
 
open("/usr/lib/python2.0/site-packages/mod_python.py",
O_RDONLY) = -1 ENOENT (No such file or directory)
 
open("/usr/lib/python2.0/site-packages/mod_python.pyc",
O_RDONLY) = -1 ENOENT (Nosuch file or directory)
  write(2, "make_obcallback(): could not imp"..., 55)
= 55
  write(2, "make_obcallback(): could not cal"..., 40)
= 40
  time(NULL)                              = 996027790
  write(15, "[Wed Jul 25 03:23:10 2001] [erro"...,
115) = 115
  alarm(300)                              = 0
  alarm(0)                                = 300
  alarm(300)                              = 0
  alarm(0)                                = 300
  alarm(300)                              = 0
  alarm(0)                                = 300
  write(4, "HTTP/1.1 500 Internal Server Err"..., 843)
= 843

This is odd because my system python version is 1.5
and I have a special version in a private 
directory which I specified (as above) at compile
time.

grepping apache (incl. mod_python.so) and python
binaries for "/usr/lib" did not reveal anything of
immediate
interest. Recompiling with python 2.1 renders
essentially the same result (substitude "2.1" for
"2.0" in the
trace output).

The problem is obviously something like the PYTHONPATH
not being set properly. 

  -Setting the PythonPath (as was suggested in a prior
exchange) seems ineffective-- strace behaviour was not

   changed (in fact specifying an arbitrary string set
for the PythonPath directive did not appear in trace
output).
  
  -setting the PYTHONPATH variable in the shell before
starting httpd had no effect

  -using the specially compiled python shell to try
"from mod_python import apache" failed when it could
   not find the "_apache" module, leading me to
believe it did find the mod_python module. I did this
   experiment using the same permissions as httpd, and
have tried experimentally running httpd with my own 
   permissions without success.

The mod_python.so file is 2.7MB with python 2.0 and
1.5MB with 2.1, leading me to believe it is being
linked
properly-- I have scrutinized the build process for
errors and not seen anything interesting. Thus I find
myself
among the ranks of unhappy people looking at:

  [Wed Jul 25 04:03:20 2001] [info] Server built: Jul
25 2001 00:55:54
  make_obcallback(): could not import
mod_python.apache.
  make_obcallback(): could not call init.
  [Wed Jul 25 04:03:22 2001] [error] [client
192.168.0.0.2] python_handler: make_ob
  callback returned no obCallBack!

I look forward to being able to move out of
AOLserver-land (filters and threading are coming to
Apache. yay). 
Any clues?

cheers,
jamie



__________________________________________________
Do You Yahoo!?
Make international calls for as low as $.04/minute with Yahoo! Messenger
http://phonecard.yahoo.com/

From piet at cs.uu.nl  Wed Jul 25 11:09:47 2001
From: piet at cs.uu.nl (piet@cs.uu.nl)
Date: Fri Jan  9 22:02:51 2004
Subject: [mod_python] example test fails-- how to convince apache to search the correct path for python modules?
In-Reply-To: polygnwnd's message of "Tue, 24 Jul 2001 20:20:06 -0700 (PDT)"
References: <20010725032006.88880.qmail@web12507.mail.yahoo.com>
Message-ID: <uy9pd2x44.fsf@cs.uu.nl>

Can you start up an interactive session with your private python
interpreter and type the following:

import sys
print sys.path

I guess it will have /usr/lib/python2.0 in it.
If that is so, the this is where your python expects its modules.
-- 
Piet van Oostrum <piet@cs.uu.nl>
URL: http://www.cs.uu.nl/~piet [PGP]
Private email: P.van.Oostrum@hccnet.nl


From riesch at nieuw.nl  Thu Jul 26 16:26:59 2001
From: riesch at nieuw.nl (riesch@nieuw.nl)
Date: Fri Jan  9 22:02:51 2004
Subject: [mod_python] Cookies
Message-ID: <20010726162659.A8236@godel>

Hi there,

I'm currently making a web-site with mod-python and since I want to make use of cookies, I was wondering how I can set a cookie.
I've been looking through the documentation provided on the web-site, but I'm not able to find something. So if anyone could give me pointer, or even better comething that works, I'd be much obliged.


Thanks ahead,
Richard

From bl at netgroup.dk  Thu Jul 26 16:54:26 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 22:02:51 2004
Subject: [mod_python] Cookies
References: <20010726162659.A8236@godel>
Message-ID: <3B602F22.17C6C7B8@netgroup.dk>

riesch@nieuw.nl wrote:

> I'm currently making a web-site with mod-python and since I want to make use of cookies, I was wondering how I can set a cookie.
> I've been looking through the documentation provided on the web-site, but I'm not able to find something. So if anyone could give me pointer, or even better comething that works, I'd be much obliged.

You find them in the header fields (headers_in / headers_out ) in the Request class.

If you like to set a cookie you do something like this :

    req.headers_out[ "Set-Cookie" ] = "my_session_id=42"

and the next time this user sends back a request back to you ( and if he support it) it will contain it in your input headers, and you will be able to fetch it like this :

    raw_cookie = req.headers_in[ "Cookie" ]

Now you only need to parse the input cookie string (raw_cookie), that have the syntax as descried in RFC-2109.

mod_python does not have any helper classes for either in- or outgoing cookies, but the format is strait forward, even I could make one :-)

Hope this helped

Regards

/BL


From CHagner at fool.com  Thu Jul 26 11:11:54 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 22:02:51 2004
Subject: [mod_python] Cookies
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E48053@rover.foolhq.com>

There's a module called Cookie which provides an Dictionary-like interface
to access the multiple cookies in a request.  In addition, each cookie class
has an output method that returns an HTTP-header-friendly string
("Set-Cookie: fig=newton").  The doc strings in Cookie.py give some pretty
good code examples.

In this module, a 'raw' cookie is called a morsel, so the terminology could
be a little confusing.

One warning though.  The Cookie module is only designed to handle a single
value for each cookie (i.e. "Set-Cookie: MyCookie=MyValue") .  Thus, if you
use a cookie to store more than one value (i.e. "Set-Cookie:
MyCookie=key1=value=&key2=value2&key3=value3"), you'll need to wrap Cookie
with your own class to handle the 'internal' values (or just build/parse the
value string yourself each time).

Chris

-----Original Message-----
From: Bo Lorentsen [mailto:bl@netgroup.dk]
Sent: Thursday, July 26, 2001 10:54 AM
To: riesch@nieuw.nl
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Cookies


riesch@nieuw.nl wrote:

> I'm currently making a web-site with mod-python and since I want to make
use of cookies, I was wondering how I can set a cookie.
> I've been looking through the documentation provided on the web-site, but
I'm not able to find something. So if anyone could give me pointer, or even
better comething that works, I'd be much obliged.

You find them in the header fields (headers_in / headers_out ) in the
Request class.

If you like to set a cookie you do something like this :

    req.headers_out[ "Set-Cookie" ] = "my_session_id=42"

and the next time this user sends back a request back to you ( and if he
support it) it will contain it in your input headers, and you will be able
to fetch it like this :

    raw_cookie = req.headers_in[ "Cookie" ]

Now you only need to parse the input cookie string (raw_cookie), that have
the syntax as descried in RFC-2109.

mod_python does not have any helper classes for either in- or outgoing
cookies, but the format is strait forward, even I could make one :-)

Hope this helped

Regards

/BL

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python

From garyp at asti-usa.com  Thu Jul 26 12:32:01 2001
From: garyp at asti-usa.com (Gary Perez)
Date: Fri Jan  9 22:02:51 2004
Subject: [mod_python] Try 2: python_handler: Dispatch() returned nothing
Message-ID: <3B604602.C7BC25E0@asti-usa.com>

Hi, all.

I've reinstalled apache, reinstalled Python (no threads), reinstalled
mod_python in hopes to clear this up. No dice. Does anyone have any suggestions?

Here's the dirt:
SuSE Linux 7.2, kernel 2.4.4, reiserfs
Apache 1.3.19 + Python 2.0 + mod_python 2.7.2

HTTPD.CONF
<Directory "/usr/local/httpd/htdocs/test">
    AddHandler python-program .py
    PythonHandler mptest
    PythonDebug On
</Directory>

The mptest.py module in "test" is the standard one from the
documentation (verified, no typos).

When I hit the URL (localhost/test/mptest.py) I get an internal server error:

ERROR LOG
[Wed Jul 18 15:58:02 2001] [notice] Apache/1.3.19 (Unix)  (SuSE/Linux)
mod_layout/1.0 mod_throttle/3.0 mod_fastcgi/2.2.2 mod_ssl/2.8.3
OpenSSL/0.9.6a PHP/4.0.4pl1 mod_perl/1.25 mod_dtcl mod_python/2.7.2
Python/2.0 configured -- resuming normal operations
[Wed Jul 18 15:58:02 2001] [notice] suEXEC mechanism enabled (wrapper: /usr/sbin/suexec)
[Wed Jul 18 15:58:18 2001] [error] [client 192.168.100.100]
python_handler: Dispatch() returned nothing.

Thanks in advance for your help.
-Gary

From jpareja at ntsp.nec.co.jp  Fri Jul 27 19:48:57 2001
From: jpareja at ntsp.nec.co.jp (Joel)
Date: Fri Jan  9 22:02:51 2004
Subject: [mod_python] Apache 2.x support
References: <200107261602.f6QG24G65883@eden.ispol.com>
Message-ID: <3B615529.2060207@ntsp.nec.co.jp>

Hello all,

       I am just starting to install mod_python. But the manual says 2.0 
not yet supported.
Is there a target date for a release that supports Apache 2.x.


Thank you.


From bl at netgroup.dk  Fri Jul 27 11:04:14 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 22:02:51 2004
Subject: [mod_python] Cookies
References: <13CDDE6A53DBD311BC3200508B6F0C4805E48053@rover.foolhq.com>
Message-ID: <3B612E8E.2BB63B3F@netgroup.dk>

Chris Hagner wrote:

> There's a module called Cookie which provides an Dictionary-like interface
> to access the multiple cookies in a request.  In addition, each cookie class
> has an output method that returns an HTTP-header-friendly string
> ("Set-Cookie: fig=newton").  The doc strings in Cookie.py give some pretty
> good code examples.

Ups sorry, I have only looked into the manual, maby its time to take a trip
into the mod_python code :-)

/BL


From CHagner at fool.com  Fri Jul 27 07:40:36 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 22:02:52 2004
Subject: [mod_python] Cookies
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E48060@rover.foolhq.com>

Cookie is a module within Python (not mod_python).  Is that what you mean?

http://www.python.org/doc/2.1.1/lib/module-Cookie.html

Chris

-----Original Message-----
From: Bo Lorentsen [mailto:bl@netgroup.dk]
Sent: Friday, July 27, 2001 5:04 AM
To: Chris Hagner
Cc: riesch@nieuw.nl; mod_python@modpython.org
Subject: Re: [mod_python] Cookies


Chris Hagner wrote:

> There's a module called Cookie which provides an Dictionary-like interface
> to access the multiple cookies in a request.  In addition, each cookie
class
> has an output method that returns an HTTP-header-friendly string
> ("Set-Cookie: fig=newton").  The doc strings in Cookie.py give some pretty
> good code examples.

Ups sorry, I have only looked into the manual, maby its time to take a trip
into the mod_python code :-)

/BL

From bl at netgroup.dk  Fri Jul 27 13:59:51 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 22:02:52 2004
Subject: [mod_python] usign the apache log ?
Message-ID: <3B6157B7.F05239DB@netgroup.dk>

Hi ...

I have been writing a system using this mod_python module, and it just
work out fine for me. Its really a nice Python tool, keep up the good
work. But (there is always a but :-)) I really like to be able to se
more about what is going in inside my code, and I therefor looked for a
way to write to the apache log file, but found nothing in mod_python.

In the O'reilly book "Writing Apache modules with Perl and C" they have
an example where they got a logger out of the Request class (or whatever
they call it i Perl :-)). This don't seem to be the case in mod_python,
and the only reference I could find to logging is the PythonLogHandler,
and that don't sound like anything I could use.

Is there something i have misunderstood, or is there a way do redirect
stdout/err to the log or something fancy like that ?

Thanks in advance !

/BL


From bl at netgroup.dk  Fri Jul 27 14:08:01 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 22:02:52 2004
Subject: [mod_python] Cookies
References: <13CDDE6A53DBD311BC3200508B6F0C4805E48060@rover.foolhq.com>
Message-ID: <3B6159A1.40AB4F73@netgroup.dk>

Chris Hagner wrote:

> Cookie is a module within Python (not mod_python).  Is that what you mean?

Ahh, I hav'nt seen it in the python lib. as I'm using a quite old Python
(1.5.2), to prevent to much update fun in the production env. ( we use
Debian/potato on the servers :-))

So much for code reuse :-)

Thanks anyway, yet a stone on the road to be a Python expert :-)

/BL


From CHagner at fool.com  Fri Jul 27 08:20:07 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 22:02:52 2004
Subject: [mod_python] Cookies
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E48061@rover.foolhq.com>

Fortunately, the Cookie module was actually developed completely independent
of the main Python distribution.  Thus, you should be able to find a copy of
Cookie.py and simply use that with Python 1.5.2.  This is what WebWare does
(or used to... not sure if they nixed their Cookie.py when it became a
standard Python module).  It's a pretty straight-forward module, so I
wouldn't be shocked if Cookie.py from a 2.0 distro works in 1.5.2.

Chris

-----Original Message-----
From: Bo Lorentsen [mailto:bl@netgroup.dk]
Sent: Friday, July 27, 2001 8:08 AM
To: Chris Hagner
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Cookies


Chris Hagner wrote:

> Cookie is a module within Python (not mod_python).  Is that what you mean?

Ahh, I hav'nt seen it in the python lib. as I'm using a quite old Python
(1.5.2), to prevent to much update fun in the production env. ( we use
Debian/potato on the servers :-))

So much for code reuse :-)

Thanks anyway, yet a stone on the road to be a Python expert :-)

/BL

From bl at netgroup.dk  Fri Jul 27 14:34:39 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 22:02:52 2004
Subject: [mod_python] Cookies
References: <13CDDE6A53DBD311BC3200508B6F0C4805E48061@rover.foolhq.com>
Message-ID: <3B615FDF.D0BED081@netgroup.dk>

Chris Hagner wrote:

> Fortunately, the Cookie module was actually developed completely independent
> of the main Python distribution.  Thus, you should be able to find a copy of
> Cookie.py and simply use that with Python 1.5.2.  This is what WebWare does
> (or used to... not sure if they nixed their Cookie.py when it became a
> standard Python module).  It's a pretty straight-forward module, so I
> wouldn't be shocked if Cookie.py from a 2.0 distro works in 1.5.2.

Look what I found ! Hope others may have good use of this too.

    http://starship.python.net/crew/jrush/Webbot

Thanks for the advise, I think I just will include this in my code, and be more
careful to search python.org before writing another parser :-)

/BL


From CHagner at fool.com  Fri Jul 27 08:45:16 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 22:02:52 2004
Subject: [mod_python] Cookies
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E48063@rover.foolhq.com>

Bo,

I would recommend that you instead go with the actual Cookie.py file that
has made it into the main Python distribution.  I started using it before it
was included (since it was a part of WebWare's libs) and was pleasantly
surprised when I found a Cookie.py in the 2.0 distro.  I was even more
surprised when I saw that the file was identical to the one that I had been
using. :)  Good karma I guess.

Chris

-----Original Message-----
From: Bo Lorentsen [mailto:bl@netgroup.dk]
Sent: Friday, July 27, 2001 8:35 AM
To: Chris Hagner
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Cookies


Chris Hagner wrote:

> Fortunately, the Cookie module was actually developed completely
independent
> of the main Python distribution.  Thus, you should be able to find a copy
of
> Cookie.py and simply use that with Python 1.5.2.  This is what WebWare
does
> (or used to... not sure if they nixed their Cookie.py when it became a
> standard Python module).  It's a pretty straight-forward module, so I
> wouldn't be shocked if Cookie.py from a 2.0 distro works in 1.5.2.

Look what I found ! Hope others may have good use of this too.

    http://starship.python.net/crew/jrush/Webbot

Thanks for the advise, I think I just will include this in my code, and be
more
careful to search python.org before writing another parser :-)

/BL

From miguel at yorku.ca  Fri Jul 27 08:54:41 2001
From: miguel at yorku.ca (Miguel Marques)
Date: Fri Jan  9 22:02:52 2004
Subject: [mod_python] usign the apache log ?
In-Reply-To: <3B6157B7.F05239DB@netgroup.dk>
References: <3B6157B7.F05239DB@netgroup.dk>
Message-ID: <20010727085441P.miguel@yorku.ca>

Greetings...
On Fri, 27 Jul 2001 13:59:51 +0200, Bo Lorentsen <bl@netgroup.dk> wrote:
> Hi ...
> 
> I have been writing a system using this mod_python module, and it just
> work out fine for me. Its really a nice Python tool, keep up the good
> work. But (there is always a but :-)) I really like to be able to se
> more about what is going in inside my code, and I therefor looked for a
> way to write to the apache log file, but found nothing in mod_python.
> 
> In the O'reilly book "Writing Apache modules with Perl and C" they have
> an example where they got a logger out of the Request class (or whatever
> they call it i Perl :-)). This don't seem to be the case in mod_python,
> and the only reference I could find to logging is the PythonLogHandler,
> and that don't sound like anything I could use.
> 
> Is there something i have misunderstood, or is there a way do redirect
> stdout/err to the log or something fancy like that ?
> 
> Thanks in advance !

4.3 apache - Access to Apache Internals.
http://www.modpython.org/live/mod_python-2.7.5/doc-html/module-apache.html

Specifically: log_error(message[, level, server])

							Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830

From bl at netgroup.dk  Fri Jul 27 15:02:14 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 22:02:52 2004
Subject: [mod_python] usign the apache log ?
References: <3B6157B7.F05239DB@netgroup.dk> <20010727085441P.miguel@yorku.ca>
Message-ID: <3B616656.A572E8F3@netgroup.dk>

Miguel Marques wrote:

> 4.3 apache - Access to Apache Internals.
> http://www.modpython.org/live/mod_python-2.7.5/doc-html/module-apache.html
>
> Specifically: log_error(message[, level, server])

Thanks, I guess I just was looking in the wrong direction.

/BL


From riesch at nieuw.nl  Fri Jul 27 15:15:58 2001
From: riesch at nieuw.nl (riesch@nieuw.nl)
Date: Fri Jan  9 22:02:52 2004
Subject: [mod_python] usign the apache log ?
In-Reply-To: <3B6157B7.F05239DB@netgroup.dk>; from bl@netgroup.dk on Fri, Jul 27, 2001 at 01:59:51PM +0200
References: <3B6157B7.F05239DB@netgroup.dk>
Message-ID: <20010727151558.B20191@godel>

hi there,


what you can do is write your own log-class. I've done something like this:


class Log:
   def __init__(self, file, mode):
      if __debug__:
         delf.__descriptor = open(file, mode)
   
   def __del__(self):
      self.close()

   def append(self, string):
      self.__descriptor.write(string + "\n\n")
      # add some more information if you please

   def close(self):
      self.__descriptor.close()


   # Variables
   __descriptor = []
#

global log
log = Log("log.txt")


When you import this module, the log-instance will be known and be the same for every file that imports this module (the global takes care of this) and every write (wherever) happens in the same file.
To write stuff:

import from Log *

log.append("something happened")


I hope this helps,
Richard

      


On Fri, Jul 27, 2001 at 01:59:51PM +0200, Bo Lorentsen wrote:
> Hi ...
> 
> I have been writing a system using this mod_python module, and it just
> work out fine for me. Its really a nice Python tool, keep up the good
> work. But (there is always a but :-)) I really like to be able to se
> more about what is going in inside my code, and I therefor looked for a
> way to write to the apache log file, but found nothing in mod_python.
> 
> In the O'reilly book "Writing Apache modules with Perl and C" they have
> an example where they got a logger out of the Request class (or whatever
> they call it i Perl :-)). This don't seem to be the case in mod_python,
> and the only reference I could find to logging is the PythonLogHandler,
> and that don't sound like anything I could use.
> 
> Is there something i have misunderstood, or is there a way do redirect
> stdout/err to the log or something fancy like that ?
> 
> Thanks in advance !
> 
> /BL
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

From rsalz at zolera.com  Fri Jul 27 09:53:12 2001
From: rsalz at zolera.com (Rich Salz)
Date: Fri Jan  9 22:02:52 2004
Subject: [mod_python] usign the apache log ?
References: <3B6157B7.F05239DB@netgroup.dk> <20010727151558.B20191@godel>
Message-ID: <3B617248.1F8AC4BF@zolera.com>

In mod_python sys.stderr is attached to the apache error log.
There is also a log_error method in the apache module (not sure what
version added it); see the docs -- it's like the ap_log_error()
function.

-- 
Zolera Systems, Your Key to Online Integrity
Securing Web services: XML, SOAP, Dig-sig, Encryption
http://www.zolera.com

From riesch at nieuw.nl  Mon Jul 30 13:55:00 2001
From: riesch at nieuw.nl (riesch@nieuw.nl)
Date: Fri Jan  9 22:02:52 2004
Subject: [mod_python] standard path
Message-ID: <20010730135500.A8125@godel>

Hi there,


I'm wondering. I now have setup for my apacha-server (httpd.conf) similar to the following:

<directory />
   SetHandler python-program
   PythonHandler main
   PythonDebug On
</directory>


The file with the mod-python handler (aka the entrance) now has to be placed in a standard path, which can be located by the python-interpreter. Now it isn't very attractive for me to use these paths. Is there a way around this. I've been trying something like:

PythonPath /home/user/site/

but this generated errors.

Any hints ?


Richard.

From riesch at nieuw.nl  Mon Jul 30 14:33:30 2001
From: riesch at nieuw.nl (riesch@nieuw.nl)
Date: Fri Jan  9 22:02:52 2004
Subject: [mod_python] standard path
In-Reply-To: <20010730135500.A8125@godel>; from riesch@nieuw.nl on Mon, Jul 30, 2001 at 01:55:00PM +0200
References: <20010730135500.A8125@godel>
Message-ID: <20010730143330.B8125@godel>

Sorry all,


I've already found the error of my ways :)
It should have been:


PythonPath "sys.path + ['/home/mysite/']"

I found it in the mod-python manual


Thanx again,
Richard

From bl at netgroup.dk  Tue Jul 31 10:19:06 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 22:02:52 2004
Subject: [mod_python] Internal_redirect ?
Message-ID: <3B6669FA.A18D4564@netgroup.dk>

Hi ...

I have been working on a larger site setup where I like to force a
redirection to a internal login page if user is unknown (cookie thing).

The only way of redirection I can find is the one described in the
mod_python FAQ, but this often gives a small annoying page telling the
user about a redirection, but what I want is to do it seamless to the
browser.

Now in the Apache doc, I found some info. about a function calls
"internal_redirect", that does exactly what I like to do, but its not
part of the mod_python API, or I cant find it, at least :-)

Have anyone a good hint for me at this point ?

Also, is it correct that its not possible to set a cookie together with
a redirect ?

Hopeful regards

/BL


From CHagner at fool.com  Tue Jul 31 09:13:26 2001
From: CHagner at fool.com (Chris Hagner)
Date: Fri Jan  9 22:02:52 2004
Subject: [mod_python] Internal_redirect ?
Message-ID: <13CDDE6A53DBD311BC3200508B6F0C4805E48089@rover.foolhq.com>

If I remember correctly, Grisha stated that this feature has been highly
requested (and is do-able) but has not yet been implemented.

Chris

-----Original Message-----
From: Bo Lorentsen [mailto:bl@netgroup.dk]
Sent: Tuesday, July 31, 2001 4:19 AM
To: mod_python list
Subject: [mod_python] Internal_redirect ?


Hi ...

I have been working on a larger site setup where I like to force a
redirection to a internal login page if user is unknown (cookie thing).

The only way of redirection I can find is the one described in the
mod_python FAQ, but this often gives a small annoying page telling the
user about a redirection, but what I want is to do it seamless to the
browser.

Now in the Apache doc, I found some info. about a function calls
"internal_redirect", that does exactly what I like to do, but its not
part of the mod_python API, or I cant find it, at least :-)

Have anyone a good hint for me at this point ?

Also, is it correct that its not possible to set a cookie together with
a redirect ?

Hopeful regards

/BL

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python

From miguel at yorku.ca  Tue Jul 31 09:39:07 2001
From: miguel at yorku.ca (Miguel Marques)
Date: Fri Jan  9 22:02:52 2004
Subject: [mod_python] Internal_redirect ?
In-Reply-To: <13CDDE6A53DBD311BC3200508B6F0C4805E48089@rover.foolhq.com>
References: <13CDDE6A53DBD311BC3200508B6F0C4805E48089@rover.foolhq.com>
Message-ID: <20010731093907E.miguel@yorku.ca>

Greetings...
On Tue, 31 Jul 2001 09:13:26 -0400, Chris Hagner <CHagner@fool.com> wrote:
> If I remember correctly, Grisha stated that this feature has been highly
> requested (and is do-able) but has not yet been implemented.
> 
> Chris
> 
> -----Original Message-----
> From: Bo Lorentsen [mailto:bl@netgroup.dk]
> Sent: Tuesday, July 31, 2001 4:19 AM
> To: mod_python list
> Subject: [mod_python] Internal_redirect ?
> 
> 
> Hi ...
> 
> I have been working on a larger site setup where I like to force a
> redirection to a internal login page if user is unknown (cookie thing).
> 
> The only way of redirection I can find is the one described in the
> mod_python FAQ, but this often gives a small annoying page telling the
> user about a redirection, but what I want is to do it seamless to the
> browser.
> 
> Now in the Apache doc, I found some info. about a function calls
> "internal_redirect", that does exactly what I like to do, but its not
> part of the mod_python API, or I cant find it, at least :-)
> 
> Have anyone a good hint for me at this point ?

With apache I do exactly what you are trying to accomplish by setting
a cookie in req.err_headers_out and returning apache.HTTP_FORBIDDEN.
Then in the apache configuration file you use 
ErrorDocument 403 http://yourloginpage 
in the directory/ies you are trying to protect...
Hope that helps...

						Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830

From bl at netgroup.dk  Tue Jul 31 15:54:47 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 22:02:52 2004
Subject: [mod_python] Internal_redirect ?
References: <13CDDE6A53DBD311BC3200508B6F0C4805E48089@rover.foolhq.com>
Message-ID: <3B66B8A7.FE84A88F@netgroup.dk>

Chris Hagner wrote:

> If I remember correctly, Grisha stated that this feature has been highly
> requested (and is do-able) but has not yet been implemented.

I will then sign up on this request :-)

/BL


From bl at netgroup.dk  Tue Jul 31 15:59:14 2001
From: bl at netgroup.dk (Bo Lorentsen)
Date: Fri Jan  9 22:02:52 2004
Subject: [mod_python] Internal_redirect ?
References: <13CDDE6A53DBD311BC3200508B6F0C4805E48089@rover.foolhq.com> <20010731093907E.miguel@yorku.ca>
Message-ID: <3B66B9B2.8E549FA@netgroup.dk>

Miguel Marques wrote:

> With apache I do exactly what you are trying to accomplish by setting
> a cookie in req.err_headers_out and returning apache.HTTP_FORBIDDEN.
> Then in the apache configuration file you use
> ErrorDocument 403 http://yourloginpage
> in the directory/ies you are trying to protect...

Thats sweet, and the cookie will be set because its part of the
"err_headers_out" ?

> Hope that helps...

Thats a good hint and another interesting way of solving this problem.

Thanks, but I like to do it the propper way --- I think :-)

/BL


From miguel at yorku.ca  Tue Jul 31 10:02:10 2001
From: miguel at yorku.ca (Miguel Marques)
Date: Fri Jan  9 22:02:52 2004
Subject: [mod_python] Internal_redirect ?
In-Reply-To: <3B66B9B2.8E549FA@netgroup.dk>
References: <13CDDE6A53DBD311BC3200508B6F0C4805E48089@rover.foolhq.com>
	<20010731093907E.miguel@yorku.ca>
	<3B66B9B2.8E549FA@netgroup.dk>
Message-ID: <20010731100210L.miguel@yorku.ca>

Greetings...
On Tue, 31 Jul 2001 15:59:14 +0200, Bo Lorentsen <bl@netgroup.dk> wrote:
> Miguel Marques wrote:
> 
> > With apache I do exactly what you are trying to accomplish by setting
> > a cookie in req.err_headers_out and returning apache.HTTP_FORBIDDEN.
> > Then in the apache configuration file you use
> > ErrorDocument 403 http://yourloginpage
> > in the directory/ies you are trying to protect...
> 
> Thats sweet, and the cookie will be set because its part of the
> "err_headers_out" ?
Yes.

> 
> > Hope that helps...
> 
> Thats a good hint and another interesting way of solving this problem.
> 
> Thanks, but I like to do it the propper way --- I think :-)
I couldn't wait... 8-)

						Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830

From tree at basistech.com  Tue Jul 31 15:31:26 2001
From: tree at basistech.com (Tom Emerson)
Date: Fri Jan  9 22:02:52 2004
Subject: [mod_python] Patch to 2.7.5 for internal_redirect
In-Reply-To: <3B66B9B2.8E549FA@netgroup.dk>
References: <13CDDE6A53DBD311BC3200508B6F0C4805E48089@rover.foolhq.com>
	<20010731093907E.miguel@yorku.ca>
	<3B66B9B2.8E549FA@netgroup.dk>
Message-ID: <15207.1934.890865.157761@cymru.basistech.com>

Attached is a small patch to mod_python 2.7.5 which provides support
for doing an internal_redirect. I've only done minimal testing on this
but it appears to work.

I added a new method to the request object, internal_redirect. It
takes a single string argument which is the local URI to redirect
to. After calling this method your handler should just return
apache.OK.

  from mod_python import apache
 
  def handler(req):
      req.internal_redirect("/redirected.html")
      return apache.OK

I also added an exception class, InternalRedirect, to
mod_python.apache. It takes a single argument which is the local URI
to redirect to. This is used by a modification to Publisher which
allows you to perform an internal redirect simply by raising an
InternalRedirect exception:

  from mod_python import apache
 
  def test(req):
      raise apache.InternalRedirect("/redirected.html")

The request object's "main" member is None if the current request is
the "main" request.

Share and enjoy.

-------------- next part --------------
*** ./lib/python/mod_python/publisher.py.orig	Mon May 14 18:17:21 2001
--- ./lib/python/mod_python/publisher.py	Tue Jul 31 15:46:33 2001
***************
*** 168,174 ****
              if name not in expected:
                  del args[name]
  
!         result = apply(object, (), args)
  
      if result:
          result = str(result)
--- 168,178 ----
              if name not in expected:
                  del args[name]
  
!         try:
!             result = apply(object, (), args)
!         except apache.InternalRedirect, e:
!             req.internal_redirect(e.uri)
!             return apache.OK
  
      if result:
          result = str(result)
*** ./lib/python/mod_python/apache.py.orig	Tue Jul 31 16:00:17 2001
--- ./lib/python/mod_python/apache.py	Tue Jul 31 15:44:16 2001
***************
*** 53,58 ****
--- 53,63 ----
  import imp
  import types
  import _apache
+ import exceptions
+ 
+ class InternalRedirect (exceptions.Exception):
+     def __init__(self, uri):
+         self.uri = uri
  
  # a small hack to improve PythonPath performance. This
  # variable stores the last PythonPath in raw (unevaled) form.
*** ./src/requestobject.c.orig	Tue May 22 22:49:43 2001
--- ./src/requestobject.c	Tue Jul 31 15:08:21 2001
***************
*** 438,443 ****
--- 438,462 ----
  }
  
  /**
+  ** request.internal_redirect(request self, string uri)
+  **
+  *    An interface to the ap_internal_redirect function.
+  *    Tom Emerson, <tree@basistech.com>, 2001-07-31
+  */
+ static PyObject * req_internal_redirect(requestobject *self, PyObject *args)
+ {
+     char *uri;
+ 
+     if (! PyArg_ParseTuple(args, "s", &uri))
+         return NULL;
+ 
+     ap_internal_redirect(uri, self->request_rec);
+     
+     Py_INCREF(Py_None);
+     return Py_None;
+ }
+ 
+ /**
   ** request.get_options(request self)
   **
   */
***************
*** 792,797 ****
--- 811,817 ----
      {"get_dirs",             (PyCFunction) req_get_dirs,             METH_VARARGS},
      {"get_remote_host",      (PyCFunction) req_get_remote_host,      METH_VARARGS},
      {"get_options",          (PyCFunction) req_get_options,          METH_VARARGS},
+     {"internal_redirect",    (PyCFunction) req_internal_redirect,    METH_VARARGS},
      {"read",                 (PyCFunction) req_read,                 METH_VARARGS},
      {"readline",             (PyCFunction) req_readline,             METH_VARARGS},
      {"register_cleanup",     (PyCFunction) req_register_cleanup,     METH_VARARGS},
-------------- next part --------------

-- 
Tom Emerson                                          Basis Technology Corp.
Sr. Sinostringologist                              http://www.basistech.com
  "Beware the lollipop of mediocrity: lick it once and you suck forever"
