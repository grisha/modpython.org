<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Help with memory problems
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Help%20with%20memory%20problems&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018667.html">
   <LINK REL="Next"  HREF="018665.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Help with memory problems</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>dharana</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Help%20with%20memory%20problems&In-Reply-To="
       TITLE="[mod_python] Help with memory problems">dharana at dharana.net
       </A><BR>
    <I>Tue Jul 12 19:29:43 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="018667.html">[mod_python] Text appended to the page when refreshing
</A></li>
        <LI>Next message: <A HREF="018665.html">[mod_python] Help with memory problems
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18664">[ date ]</a>
              <a href="thread.html#18664">[ thread ]</a>
              <a href="subject.html#18664">[ subject ]</a>
              <a href="author.html#18664">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>look at this screenshot:

<A HREF="http://dharana.net/memory_concerns.png">http://dharana.net/memory_concerns.png</A>

It shows two screenshots of the same page of my webapp. The lower one was shoot 
just after an apachectl start. The second one was shot after 6 consecutive 
refreshes where memory usage increased every time by a lot of Mbs.

I use a lot of custom modules, from db calls to xslt transformations (with 
libxml). But in the page shown in the screenshot it does little. The strange 
thing is that after a few more page refreshes the memory load goes back to 23Mb 
and then increases again.

I use some light module-level caching (I cache the 3 queries executed in the 
lower page). But I don't think this is causing the heavy memory usage because 
after it goes back to 23Mb it does query again (ie: the caching mechanism still 
has it's cache).

I use apache prefork and Maxrequestperchild 0. After every page refresh the unr 
obj var shown on the page doesn't changes. It's either 63 or 0.

mem, resident and stack come from this script:

<A HREF="http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/286222">http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/286222</A>

unr obj is just the output of gc.collect() after everything else is done (the 
debug print is printed just before return apache.OK.

What I am asking is for some help or pointers in how to track down who is 
causing this or where to look for reducing the memory usage.


Thanks,

-- 
dharana

</PRE>












<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018667.html">[mod_python] Text appended to the page when refreshing
</A></li>
	<LI>Next message: <A HREF="018665.html">[mod_python] Help with memory problems
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18664">[ date ]</a>
              <a href="thread.html#18664">[ thread ]</a>
              <a href="subject.html#18664">[ subject ]</a>
              <a href="author.html#18664">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
