<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] global var on 2.7
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20global%20var%20on%202.7&In-Reply-To=e2219c8a0507100428320d53df%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018644.html">
   <LINK REL="Next"  HREF="018646.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] global var on 2.7</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20global%20var%20on%202.7&In-Reply-To=e2219c8a0507100428320d53df%40mail.gmail.com"
       TITLE="[mod_python] global var on 2.7">grahamd at dscpl.com.au
       </A><BR>
    <I>Sun Jul 10 07:43:38 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="018644.html">[mod_python] global var on 2.7
</A></li>
        <LI>Next message: <A HREF="018646.html">[mod_python] global var on 2.7
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18645">[ date ]</a>
              <a href="thread.html#18645">[ thread ]</a>
              <a href="subject.html#18645">[ subject ]</a>
              <a href="author.html#18645">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>You misunderstand how Apache/mod_python works.

If Apache is running in prefork mode each unique request is not
necessarily managed within the same process. As a result, setting
a global variable doesn't mean the next request will see the same
value as it could be executing in a different process.

More than likely, your Apache 2 configuration was set to run in
worker mode. That is, all requests were handled in the same
process but possibly as different threads. Thus it always saw
the updated value. Not so with prefork mode though.

Since you don't have access to sessions in mod_python 2.7, you
are going to have to come up with your own way of saving state
out to the file system somehow to track such things.

Graham

On 10/07/2005, at 9:28 PM, antoine wrote:

&gt;<i> Hello,
</I>&gt;<i>
</I>&gt;<i> I've this problem trying to get a particular var to be loaded once and
</I>&gt;<i> for all using mod_python 2.7 on apache 1.3 (debian sarge stable) with
</I>&gt;<i> python 2.1. The same code worked perfectly well with mod_python
</I>&gt;<i> 3.1/apache2/python2.3 but I've been a little bit too optimistic on my
</I>&gt;<i> hosting server uptodateness and spent the last week with downgrading
</I>&gt;<i> issues...
</I>&gt;<i>
</I>&gt;<i> So I'm using the publisher handler and here is a resume of my index.py:
</I>&gt;<i>
</I>&gt;<i> bigdic = None
</I>&gt;<i>
</I>&gt;<i> def index(req):
</I>&gt;<i>   global bigdic
</I>&gt;<i>   if bigdic:
</I>&gt;<i>     req.write(&quot;bigdic already loaded&quot;)
</I>&gt;<i>   else
</I>&gt;<i>     req.write(&quot;bigdic loading...&quot;)
</I>&gt;<i>     bigdic = loooong_and_painfull_process()
</I>&gt;<i>     req.write(&quot;done, pfiouh&quot;)
</I>&gt;<i>
</I>&gt;<i> this work perfectly well with the new components (apache2 and all) but
</I>&gt;<i> not with the old one (apache1.3 and company) which I _have to_ use,
</I>&gt;<i> meaning I get the &quot;bigdic loading....done&quot; message every time I reload
</I>&gt;<i> the page.
</I>&gt;<i>
</I>&gt;<i> I tried the PythonImport but it segfaults apache (wether at the
</I>&gt;<i> virtual host level or the directory level)
</I>&gt;<i>
</I>&gt;<i> I'm not running out of idea yet but before I get into crazy mode
</I>&gt;<i> looking for a complicated solution has any of you encounter and
</I>&gt;<i> resolved the same problem before?
</I>&gt;<i>
</I>&gt;<i> Just to make it clear : upgrading any of the component is not an
</I>&gt;<i> option, I could rewrite/patch the publisher handler though.
</I>&gt;<i>
</I>&gt;<i> Thanks for your time
</I>&gt;<i> -- 
</I>&gt;<i> Antoine
</I>&gt;<i> <A HREF="http://delaunay.org/antoine">http://delaunay.org/antoine</A>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018644.html">[mod_python] global var on 2.7
</A></li>
	<LI>Next message: <A HREF="018646.html">[mod_python] global var on 2.7
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18645">[ date ]</a>
              <a href="thread.html#18645">[ thread ]</a>
              <a href="subject.html#18645">[ subject ]</a>
              <a href="author.html#18645">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
