<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] severe memory leak problem with mod_python
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20severe%20memory%20leak%20problem%20with%20mod_python&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018621.html">
   <LINK REL="Next"  HREF="018617.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] severe memory leak problem with mod_python</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Manjeet Chaudhary</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20severe%20memory%20leak%20problem%20with%20mod_python&In-Reply-To="
       TITLE="[mod_python] severe memory leak problem with mod_python">manjeet at infogridpacific.com
       </A><BR>
    <I>Thu Jul  7 04:55:42 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="018621.html">[mod_python] Vampire for module reloading
</A></li>
        <LI>Next message: <A HREF="018617.html">[mod_python] severe memory leak problem with mod_python
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18615">[ date ]</a>
              <a href="thread.html#18615">[ thread ]</a>
              <a href="subject.html#18615">[ subject ]</a>
              <a href="author.html#18615">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Guys

We are facing memory leak problem; most probably due to mod_python.
Our application is web-based application using below mentioned Apache 
server version including mod-python. We are using Publisher Handler in 
mod-python.
We are facing a severe memory leak problem [ memory is used and never 
being freed , it is freed only when we stop apache server (httpd) or 
restart it]. We are using dbxml(2.1.8) as our backend database. Our 
program (python module) in cgi-bin dir is processing the url request. 
The module is accessing the document from the dbxml container through 
Simple - XML -RPC communication and returning to the browser. As the no. 
of requests increases memory is used up [never freed again] and the 
server crashes [CentOS automatically kill the process], but if we stop 
or restart httpd the memory is released in huge amount . There were 
similar problems in dbxml version 2.0.9 , but those were solved when we 
upgraded it to version 2.1.8.

I have already updated my kernel, mod_python, dbxml.
I used Valgrind to check memory leak. But in summary report it is not 
showing any type of memory leak.

I also read that is there is some problem with Python and it's memory 
management. ( <A HREF="http://evanjones.ca/python-memory.html">http://evanjones.ca/python-memory.html</A> ). Is this a 
problem due to Python's memory management. But our other 
application/servers are working fine.

It seems that apache/mod_python process is leaking memory.
This is a serious problem and so we need a solution for it.

Please help me out for solving this problem.
Maybe somebody here has any idea what is going on.

Thank you in advance and all the best,
Manjeet Chaudhary

Summary:
-----------------------------------------------------------
.................
Hardware/Softwares and OS we are using :-
Pentium4 machine with 1GB DDR-RAM.
CentOS 4.0 - kernel 2.6.9-11-EL. Upgraded from 2.6.9-3
Dbxml - 2.1.8 upgraded from 2.0.9
Mod_Python - 3.1.4 with Patches
Python - 2.3.4.
HTTPD server - Apache/2.0.52
Pybsdbd - bsddb3-4.3.3
.................
Httpd Configurations: (mod_python specific. We are using .htaccess in 
cgi-bin directory )

&lt;Directory &quot;/var/www/cgi-bin&quot;&gt;
AllowOverride FileInfo
Options FollowSymLinks
Order allow,deny
Allow from all
&lt;/Directory&gt;
.................
.htaccess file:

AddHandler mod_python .py
SetHandler mod_python
PythonHandler mod_python.publisher
PythonDebug On
.................
Remedies i applied:
1. Updated Kernel from 2.6.9-3 to 2.6.9-11.EL as suggested in 
<A HREF="http://lists.centos.org/pipermail/centos/2005-June/007113.html">http://lists.centos.org/pipermail/centos/2005-June/007113.html</A>
2. Updated DbXml from 2.0.9 to 2.1.8 as suggested in
<A HREF="http://www.sleepycat.com/xml_update/2.1.8/if.2.1.8.html">http://www.sleepycat.com/xml_update/2.1.8/if.2.1.8.html</A>
3. Reinstalled mod_python with patches as mentioned in
<A HREF="http://www.dscpl.com.au/projects/vampire/patches.html">http://www.dscpl.com.au/projects/vampire/patches.html</A>
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018621.html">[mod_python] Vampire for module reloading
</A></li>
	<LI>Next message: <A HREF="018617.html">[mod_python] severe memory leak problem with mod_python
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18615">[ date ]</a>
              <a href="thread.html#18615">[ thread ]</a>
              <a href="subject.html#18615">[ subject ]</a>
              <a href="author.html#18615">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
