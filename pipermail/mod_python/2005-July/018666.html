<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Text appended to the page when refreshing
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Text%20appended%20to%20the%20page%20when%20refreshing&In-Reply-To=42D43F87.9080400%40gmx.de">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018663.html">
   <LINK REL="Next"  HREF="018667.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Text appended to the page when refreshing</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>R. Pelizzi</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Text%20appended%20to%20the%20page%20when%20refreshing&In-Reply-To=42D43F87.9080400%40gmx.de"
       TITLE="[mod_python] Text appended to the page when refreshing">r.pelizzi at virgilio.it
       </A><BR>
    <I>Tue Jul 12 20:13:10 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="018663.html">[mod_python] Text appended to the page when refreshing
</A></li>
        <LI>Next message: <A HREF="018667.html">[mod_python] Text appended to the page when refreshing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18666">[ date ]</a>
              <a href="thread.html#18666">[ thread ]</a>
              <a href="subject.html#18666">[ subject ]</a>
              <a href="author.html#18666">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Wojtek Dabrowski wrote:

&gt;&gt;<i>I'm using the publisher handler and when i refresh a page that returns
</I>&gt;&gt;<i>some html code (a full page, enclosed in html tags) the output is
</I>&gt;&gt;<i>appended to the page (duplicated, if the python script isn't changed).
</I>&gt;&gt;<i>    
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>I have had a similiar problem. In my case, the output was generated as a
</I>&gt;<i>list of lines, kind of like:
</I>&gt;<i>
</I>&gt;<i>def handler(req):
</I>&gt;<i>  page=bla()
</I>&gt;<i>  for line in page.x:
</I>&gt;<i>    req.write(line)
</I>&gt;<i>
</I>&gt;<i>class bla:
</I>&gt;<i>  x = list()
</I>&gt;<i>  def __init__(self):
</I>&gt;<i>    self.x.append(&quot;HTML lines&quot;)
</I>&gt;<i>
</I>&gt;<i>Now x=list didn't generate an empty list, but x sometimes still held the
</I>&gt;<i>output generated last time the page was called. I corrected this by
</I>&gt;<i>adding an x=[] in the __init__ to get:
</I>&gt;<i>
</I>&gt;<i>class bla:
</I>&gt;<i>  x = list()
</I>&gt;<i>  def __init__(self):
</I>&gt;<i>    x=[]
</I>&gt;<i>    self.x.append(&quot;HTML lines&quot;)
</I>&gt;<i>
</I>&gt;<i>This cleared x of any garbage that might have been there, and it works
</I>&gt;<i>fine now.
</I>&gt;<i>
</I>&gt;<i>I don't know why x=list() didn't generate an empty list, I just know it
</I>&gt;<i>didn't ;) If there's anybody who can actually explain why this happened,
</I>&gt;<i>I'd be grateful.
</I>&gt;<i>  
</I>&gt;<i>
</I>Strange: you're using a class variable but every instance deletes it.
What's the purpose of such a list anyway? Couldn't you just set self.x
in __init__? Also, since i think mod_python reuses the same interpreter
(python session) for multiple requests (opposed to cgi), it is
predictable that class attributes are shared among requests. My class,
though, has only instance variables. These shouldn't be (and arent')
shared in normal-python scripting. Now, i wonder how using mod_python
messes everything up.
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018663.html">[mod_python] Text appended to the page when refreshing
</A></li>
	<LI>Next message: <A HREF="018667.html">[mod_python] Text appended to the page when refreshing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18666">[ date ]</a>
              <a href="thread.html#18666">[ thread ]</a>
              <a href="subject.html#18666">[ subject ]</a>
              <a href="author.html#18666">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
