<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] PostReadRequestHandler
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20PostReadRequestHandler&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018693.html">
   <LINK REL="Next"  HREF="018700.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] PostReadRequestHandler</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Jim Hefferon</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20PostReadRequestHandler&In-Reply-To="
       TITLE="[mod_python] PostReadRequestHandler">jim at joshua.smcvt.edu
       </A><BR>
    <I>Fri Jul 15 15:50:09 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="018693.html">[mod_python] Directory wildcard handling
</A></li>
        <LI>Next message: <A HREF="018700.html">[mod_python] PostReadRequestHandler
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18697">[ date ]</a>
              <a href="thread.html#18697">[ thread ]</a>
              <a href="subject.html#18697">[ subject ]</a>
              <a href="author.html#18697">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,  

I'm sorry to bother folks, but I have a &quot;Hello World&quot;-type question.  

I want to write a small handler that redirects if the URI satisfies some
criteria (I have pre-made some autoindex pages and so want to redirect
to those if possible).  My understanding of handlers is very weak, but I
thought that a PostReadRequestHandler is the right thing, as then all
the URI translations, etc. can do their stuff after I reroute some
URI's.  That is, I had in mind something like his:
  def postreadrequesthandler(req):
     uriPath=req.parsed_uri[apache.URI_PATH]
     if uriPath satisfies criteria:
        redirect
        return apache.OK
     return apache.DECLINED

I put these lines in my 000-default in a virtual host context:
  setHandler mod_python
  PythonPath &quot;sys.path+['/dir/containing/py/file']&quot;
  PythonPostReadRequestHandler filename
  PythonDebug On
The error.log says something about mod_python 3.1.3 resuming normal
operations, so I think I am OK.

I wrote a small handler, just as a test.  It says only
  def postreadrequesthandler(req):
    return apache.DECLINED
(I've also experimented with apache.OK)  I expected it to have no effect
on the behavior of apache as my understanding was that the request would
go to the next handler up the line.

Instead, when I restart apache, it gives me a 404 every time, and every
time sends me a copy of the cgi program that is the 404 error handler. 
That is, that the 404 should be executed as a cgi is gone (of course, it
works if I comment out the lines above from the 000-default and restart
and ask for something that isn't there).  The error.log says &quot;attempt to
serve directory&quot; so it is not looking for the index.html file in the
dir.  So I'm thinking that all subsequent handlers are not being
invoked, or else that I am just clueless (I suspect that latter!).

I have the latest Debian, am using Apache 2.0, and got mod_python
pre-packaged (that is, I didn't compile it myself, or anything). 

No doubt I'm doing something dopey, but I usually write by starting with
a small script that works and expanding.  I'm unable to get the small
script to go here.  If someone has a suggestion, I'd be very grateful.

Thanks,
Jim Hefferon

-- 
If there&#8217;s one thing we&#8217;ve learned, it&#8217;s that there is no such thing as
cheap meta-data.  --Tim Bray

</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018693.html">[mod_python] Directory wildcard handling
</A></li>
	<LI>Next message: <A HREF="018700.html">[mod_python] PostReadRequestHandler
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18697">[ date ]</a>
              <a href="thread.html#18697">[ thread ]</a>
              <a href="subject.html#18697">[ subject ]</a>
              <a href="author.html#18697">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
