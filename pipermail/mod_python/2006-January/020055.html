<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] PYC download prompt (resolved)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20PYC%20download%20prompt%20%28resolved%29&In-Reply-To=43D14DEC.7070509%40jgassociates.ca">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020051.html">
   <LINK REL="Next"  HREF="020056.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] PYC download prompt (resolved)</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Sean Jamieson</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20PYC%20download%20prompt%20%28resolved%29&In-Reply-To=43D14DEC.7070509%40jgassociates.ca"
       TITLE="[mod_python] PYC download prompt (resolved)">sean at barriescene.com
       </A><BR>
    <I>Fri Jan 20 19:00:42 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="020051.html">[mod_python] PYC download prompt
</A></li>
        <LI>Next message: <A HREF="020056.html">[mod_python] PYC download prompt (resolved)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20055">[ date ]</a>
              <a href="thread.html#20055">[ thread ]</a>
              <a href="subject.html#20055">[ subject ]</a>
              <a href="author.html#20055">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Jim Gallacher wrote:

&gt;<i> Sean Jamieson wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Jim Gallacher wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Sean Jamieson wrote:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> apache2/error.log is showing more than a few segfaults...
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Segfaults! Now we are getting somewhere. There are likely some 
</I>&gt;&gt;&gt;<i> subtle differences in the python libraries and apache modules being 
</I>&gt;&gt;&gt;<i> used on the server and laptop. The usual culprits libexpat and mysql 
</I>&gt;&gt;&gt;<i> clientlib used by php, but other libs can cause problems too. These 
</I>&gt;&gt;&gt;<i> links may help you sort it out:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> <A HREF="http://www.dscpl.com.au/articles/modpython-006.html">http://www.dscpl.com.au/articles/modpython-006.html</A>
</I>&gt;&gt;&gt;<i> <A HREF="http://www.modpython.org/FAQ/faqw.py?req=all#2.13">http://www.modpython.org/FAQ/faqw.py?req=all#2.13</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Jim
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I made the segfault stop, but I'm not sure why exactly...
</I>&gt;&gt;<i> to start at the beginning, there was another weirdness going on with 
</I>&gt;&gt;<i> mod_python, that was not a big deal, and I assumed to be &quot;just how it 
</I>&gt;&gt;<i> works&quot;:
</I>&gt;&gt;<i> if my project is in a subdirectory under the document root, I'd have 
</I>&gt;&gt;<i> to do my imports from the document root.
</I>&gt;&gt;<i> i.e.
</I>&gt;&gt;<i> DocumentRoot /var/www
</I>&gt;&gt;<i> Project Root /var/www/project
</I>&gt;&gt;<i> /var/www/project/index.py:
</I>&gt;&gt;<i>    import project.package.module
</I>&gt;&gt;<i> this seems strange as I sholud only have to do
</I>&gt;&gt;<i>    import package.module
</I>&gt;&gt;<i> with out having to include the directory that index.py actually 
</I>&gt;&gt;<i> resides in...
</I>&gt;&gt;<i> Now, keeping that in mind, I uploaded the source to my dev server, 
</I>&gt;&gt;<i> and to stop the segfaults I simply changes the imports to the second 
</I>&gt;&gt;<i> (expected) from, excluding the 'project' directory from the import path.
</I>&gt;&gt;<i> *inhale*
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I don't know if that really fixed anything, or just caused some other 
</I>&gt;&gt;<i> error to be happening that prevents the whatever code is segfaulting 
</I>&gt;&gt;<i> from actually being run.
</I>&gt;&gt;<i> But, in either case, I get no error or output or log messages telling 
</I>&gt;&gt;<i> me useful. All I do get is:
</I>&gt;&gt;<i> [notice] mod_python: (Re)importing module 'index' with path set to 
</I>&gt;&gt;<i> '['/.....']'
</I>&gt;&gt;<i> and once in a while this is above it:
</I>&gt;&gt;<i> [notice] mod_python: (Re)importing module 'mod_python.publisher'
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Publisher has it's own import and reload mechanism. Using a python 
</I>&gt;<i> import statement for modules that may also be imported by 
</I>&gt;<i> mod_python.publisher may give interesting results. If your 
</I>&gt;<i> project.package.module does not contain functions that are published 
</I>&gt;<i> directly I would suggest moving it completely out of your DocumentRoot 
</I>&gt;<i> and put it somewhere on your python path, or use the apache PythonPath 
</I>&gt;<i> directive to add it to the path. eg.
</I>&gt;<i>
</I>&gt;<i>   PythonPath &quot;['/home/sean/website-modules/',] + sys.path&quot;
</I>&gt;<i>
</I>&gt;<i> This import issue is not likely related to the segfaults however.
</I>&gt;<i>
</I>&gt;&gt;<i> OTOH, that link you gave me about PHP's mysql libs conflicting with 
</I>&gt;&gt;<i> mod_python and MySQLdb might be the very thing causing problems, but 
</I>&gt;&gt;<i> BOTH my laptop and my dev server have php4.4.0 installed... and both 
</I>&gt;&gt;<i> are from ubuntu's apt (infact, I haven't custom compiled anything on 
</I>&gt;&gt;<i> either machine since I built them, all are package managed, and 
</I>&gt;&gt;<i> recently updated)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> A few weeks ago I ran apt-get update for python related packages on 
</I>&gt;<i> one of my debian machines and immediately started getting apache 
</I>&gt;<i> segfaults. Turned out that php4-mysql was using libmysqlclient.so.10 
</I>&gt;<i> and the new python was using libmysqlclient.so.12. Updating php4-mysql 
</I>&gt;<i> brought the 2 libs in line and the segfault went away. I don't think 
</I>&gt;<i> this sort of problem is easily solved by any package manager, so it's 
</I>&gt;<i> something to keep in mind when doing updates.
</I>&gt;<i>
</I>&gt;<i> Jim
</I>&gt;<i>
</I>&gt;<i> PS. It's a good idea to keep discussions on list.
</I>
OK, so after many hours of hair pulling, I finally figured out the 
problem *is* with PHP's mysql library.

Disabling PHP entirely allowed my python code, which uses MySQLdb, to work.

Tomorrow I'm going to figure out how to make PHP and MySQLdb play 
nicely, taking your comment above into consideration.

Thanks for all the help.

Sean
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020051.html">[mod_python] PYC download prompt
</A></li>
	<LI>Next message: <A HREF="020056.html">[mod_python] PYC download prompt (resolved)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20055">[ date ]</a>
              <a href="thread.html#20055">[ thread ]</a>
              <a href="subject.html#20055">[ subject ]</a>
              <a href="author.html#20055">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
