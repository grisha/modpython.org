<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] mod_python executing old versions of my code
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20mod_python%20executing%20old%20versions%20of%20my%20code&In-Reply-To=EDED69E2-F224-4027-9F1C-481D4F98A9B9%40packet-addiction.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020120.html">
   <LINK REL="Next"  HREF="020125.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] mod_python executing old versions of my code</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Jim Gallacher</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20mod_python%20executing%20old%20versions%20of%20my%20code&In-Reply-To=EDED69E2-F224-4027-9F1C-481D4F98A9B9%40packet-addiction.org"
       TITLE="[mod_python] mod_python executing old versions of my code">jpg at jgassociates.ca
       </A><BR>
    <I>Thu Jan 26 19:36:07 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="020120.html">[mod_python] mod_python executing old versions of my code
</A></li>
        <LI>Next message: <A HREF="020125.html">[mod_python] mod_python executing old versions of my code
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20123">[ date ]</a>
              <a href="thread.html#20123">[ thread ]</a>
              <a href="subject.html#20123">[ subject ]</a>
              <a href="author.html#20123">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Peter Sanchez wrote:
&gt;<i> I have been a little slow on this thread. This is something I had  
</I>&gt;<i> planned on emailing the list about myself.
</I>&gt;<i> 
</I>&gt;<i> I have a page hosted using mod_python.publisher (mod_python version  
</I>&gt;<i> 3.2.5b) The page returns results from a PSP formatted template  system. 
</I>&gt;<i> On a lot of pages I use a variable named &quot;info_msg&quot;
</I>&gt;<i> 
</I>&gt;<i> Say I login to an account, info_msg is set to 'You have logged in.'  Go 
</I>&gt;<i> to a new page, info_msg isn't used, but the template page does  
</I>&gt;<i> reference it (in case it was used) and you see 'You have logged in' I  
</I>&gt;<i> have been trying to figure it out, but no such luck. I just found  this 
</I>&gt;<i> thread :)
</I>
 From what you are describing here I don't think this is a module reload 
problem. How are you passing info_msg between your requests? In the 
apache preform-mpm and worker-mpm models there will be a python 
interpreter for each apache child process. Each interpeter gets it's own 
copy of the module data. The value for a module variable set in a 
request in one child will only be visible to subsequent requests handled 
by that same child. If you want to share some data between different 
requests you'll need to use sessions, cookies, dump it into a database, 
or some other persistent store.

&gt;<i> As for the &quot;MaxRequestsPerChild 1&quot; work around. How big of a  
</I>&gt;<i> performance hit does this give? Seems like it would slow things down  a 
</I>&gt;<i> bit. 
</I>
Wrong. It'll slow it down *alot*. This trick should really only be used 
on a development machine. Consider the following results for a random 
bit of mod_python code on my machine.

Using ab -n 1000 and the following apache config:
StartServers         5
MinSpareServers      5
MaxSpareServers      10
MaxClients          50


For MaxRequestsPerChild 0
-------------------------
Concurrency Level:      1
Time taken for tests:   4.593905 seconds
Complete requests:      1000
Requests per second:    217.68 [#/sec] (mean)
Time per request:       4.594 [ms] (mean)
Transfer rate:          1061.84 [Kbytes/sec] received


For MaxRequestsPerChild 1
-------------------------
Concurrency Level:      1
Time taken for tests:   378.930349 seconds
Complete requests:      1000
Requests per second:    2.64 [#/sec] (mean)
Time per request:       378.930 [ms] (mean)
Transfer rate:          12.87 [Kbytes/sec] received

Ouch. Performance drops by a factor of 100 for MaxRequestsPerChild == 1. 
You could set StartServers to compensate, but it's not a general solution.

&gt;<i> When will 3.2.6 be available?
</I>
Unofficially, now. ;) Officially... well, we are likely going to have 
that discussion on the python-dev list in the next day or so.

Jim

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020120.html">[mod_python] mod_python executing old versions of my code
</A></li>
	<LI>Next message: <A HREF="020125.html">[mod_python] mod_python executing old versions of my code
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20123">[ date ]</a>
              <a href="thread.html#20123">[ thread ]</a>
              <a href="subject.html#20123">[ subject ]</a>
              <a href="author.html#20123">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
