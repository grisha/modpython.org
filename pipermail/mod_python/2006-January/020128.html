<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] mod_python executing old versions of my code
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20mod_python%20executing%20old%20versions%20of%20my%20code&In-Reply-To=25DD6FB7-BF79-459A-B4C7-9C082809D987%40packet-addiction.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020125.html">
   <LINK REL="Next"  HREF="020093.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] mod_python executing old versions of my code</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Jim Gallacher</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20mod_python%20executing%20old%20versions%20of%20my%20code&In-Reply-To=25DD6FB7-BF79-459A-B4C7-9C082809D987%40packet-addiction.org"
       TITLE="[mod_python] mod_python executing old versions of my code">jpg at jgassociates.ca
       </A><BR>
    <I>Thu Jan 26 20:08:32 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="020125.html">[mod_python] mod_python executing old versions of my code
</A></li>
        <LI>Next message: <A HREF="020093.html">[mod_python] Syntax error in generated psp code
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20128">[ date ]</a>
              <a href="thread.html#20128">[ thread ]</a>
              <a href="subject.html#20128">[ subject ]</a>
              <a href="author.html#20128">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Peter Sanchez wrote:
&gt;<i> On Jan 26, 2006, at 4:36 PM, Jim Gallacher wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> Peter Sanchez wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I have been a little slow on this thread. This is something I had   
</I>&gt;&gt;&gt;<i> planned on emailing the list about myself.
</I>&gt;&gt;&gt;<i> I have a page hosted using mod_python.publisher (mod_python  version  
</I>&gt;&gt;&gt;<i> 3.2.5b) The page returns results from a PSP formatted  template  
</I>&gt;&gt;&gt;<i> system. On a lot of pages I use a variable named &quot;info_msg&quot;
</I>&gt;&gt;&gt;<i> Say I login to an account, info_msg is set to 'You have logged  in.'  
</I>&gt;&gt;&gt;<i> Go to a new page, info_msg isn't used, but the template page  does  
</I>&gt;&gt;&gt;<i> reference it (in case it was used) and you see 'You have  logged in' 
</I>&gt;&gt;&gt;<i> I  have been trying to figure it out, but no such luck.  I just 
</I>&gt;&gt;&gt;<i> found  this thread :)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> From what you are describing here I don't think this is a module  
</I>&gt;&gt;<i> reload problem. How are you passing info_msg between your requests?  
</I>&gt;&gt;<i> In the apache preform-mpm and worker-mpm models there will be a  
</I>&gt;&gt;<i> python interpreter for each apache child process. Each interpeter  
</I>&gt;&gt;<i> gets it's own copy of the module data. The value for a module  
</I>&gt;&gt;<i> variable set in a request in one child will only be visible to  
</I>&gt;&gt;<i> subsequent requests handled by that same child. If you want to  share 
</I>&gt;&gt;<i> some data between different requests you'll need to use  sessions, 
</I>&gt;&gt;<i> cookies, dump it into a database, or some other  persistent store.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> OK, here is the layout.
</I>&gt;<i> 
</I>&gt;<i> acvars.py contains a dictionary named &quot;ns&quot; that is used for PSP  
</I>&gt;<i> template page data. The ns dictionary contains an entry for  'info_msg' 
</I>&gt;<i> ( ns = {'info_msg':  '&amp;nbsp;'} )
</I>&gt;<i> 
</I>&gt;<i> Now, index.py has
</I>&gt;<i> 
</I>&gt;<i> from acvars import *
</I>&gt;<i> 
</I>&gt;<i> When a function has completed, and warrants some sort of user update,  
</I>&gt;<i> the index.py function will do:
</I>&gt;<i> 
</I>&gt;<i> ns['info_msg'] = 'Some updating message for the users benefit'
</I>&gt;<i> 
</I>&gt;<i> ns is then passed to the PSP engine to format the HTML and the result  
</I>&gt;<i> is printed to the user.
</I>&gt;<i> 
</I>&gt;<i> This is the same thing for all functions in the index.py script  (which 
</I>&gt;<i> is the front end)
</I>&gt;<i> 
</I>&gt;<i> Should I not be using from ... import * ?
</I>
It's not so much that you shouldn't use import, it's just that each 
intepreter will get it's own copy of of your ns dictionary. You have to 
get into a different mindset when working with the apache prefork. 
Pretend that each apache child is a completely independent application 
and you'll get some insight into what's going on. The way you are doing 
things will work in threaded-mpm but it's a non-starter for prefork or 
worker. It's also a useful for pulling static data, such as 
configuration data, into you application.

The problems with old versions of code seeming to persist are related to 
changes to apache modules on disk, which is a different issue to what 
you are seeing.

Jim
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020125.html">[mod_python] mod_python executing old versions of my code
</A></li>
	<LI>Next message: <A HREF="020093.html">[mod_python] Syntax error in generated psp code
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20128">[ date ]</a>
              <a href="thread.html#20128">[ thread ]</a>
              <a href="subject.html#20128">[ subject ]</a>
              <a href="author.html#20128">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
