<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] basic cgi not working with mp 3.0.3
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20basic%20cgi%20not%20working%20with%20mp%203.0.3&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014407.html">
   <LINK REL="Next"  HREF="014408.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] basic cgi not working with mp 3.0.3</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Jim Peterson</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20basic%20cgi%20not%20working%20with%20mp%203.0.3&In-Reply-To="
       TITLE="[mod_python] basic cgi not working with mp 3.0.3">jpeterson at ainet.com
       </A><BR>
    <I>Fri Oct 31 12:43:39 EST 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="014407.html">[mod_python] Re: invalid literal for float solved addendum
</A></li>
        <LI>Next message: <A HREF="014408.html">[mod_python] is mod_python threadsafe?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14409">[ date ]</a>
              <a href="thread.html#14409">[ thread ]</a>
              <a href="subject.html#14409">[ subject ]</a>
              <a href="author.html#14409">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

total newb to python, apache, mod_python, spyce.

running Apache/2.0.47 (Win32) mod_python/3.0.3 Python/2.2.2 Spyce 1.3.11
under Win2K, using ActiveState Python.

i'm trying to use the 'production ready', stable stuff.

Here's the details.  TIA

---------------------------------------------------------------------

Trying to port my CGI app to mod_python. It was blowing up until I 
traced the failure line to mod_python.apache.  I diffed the file against 
a beta version, found a patch there, and applied the patch to my 
apache.py.  The patch stopped the bomb but I'm not getting any form fields.

     #################################
     # original code
     #for k in sav_env:
     #    osenv[k] = env[k]

     # after the patch
     for k in sav_env:
         osenv[k] = sav_env[k]

I don't have any idea if that is relevant.

My test code works in a true CGI environment but not under the mp cgi 
handler.  I'm using Apache aliases to configure both true CGI and mp cgi
against the same directory.

# --------------------------------------------------------
# this configures a conventional CGI setup
ScriptAlias /xcgi-bin/ /Jim/Home/Web/CGI/
&lt;Location /xcgi-bin/ &gt;
     AllowOverride None
     Options +Indexes +ExecCGI
     Order allow,deny
     Allow from all
&lt;/Location&gt;
# --------------------------------------------------------
# this configures a mod_python CGI handler, I guess
Alias /cgi-bin/ /Jim/Home/Web/CGI/
&lt;Location /cgi-bin/ &gt;
   SetHandler python-program
   PythonHandler mod_python.cgihandler
   PythonDebug On
&lt;/Location&gt;

I invoke my test code with either URL.

I test mod_python handling with url of this form:
/cgi-bin/cgitest.py?fielda='asdf'&amp;fieldb='qwer'

I test true cgi handling with url of this form:
/xcgi-bin/cgitest.py?fielda='asdf'&amp;fieldb='qwer'

Throughout my app I pass values thru the URL/querystring.

Under true CGI, my script gets values in the form fields.  Under mp cgi, 
it gets None.

Here is the CGI script:

# ------------------- cut here --------------------
#!python

# cgitest.py
#
# test cgi port to mod_python cgi handler
#

import cgi
form = cgi.FieldStorage()

# print content type here to enable html rendering of debug form
print &quot;Content-Type: text/html\n\n&quot;

# prints dict of env vars, for debugging
#cgi.print_environ()

# prints dict of form args, for debugging
cgi.print_form(form)

# extract the data from the query string
fielda = form.getvalue('fielda')
fieldb = form.getvalue('fieldb')

# content-type printed above

html = \
'''
&lt;html&gt;
&lt;head&gt;
&lt;title&gt; cgitest.py &lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;hr /&gt;
&lt;table&gt;
&lt;tr&gt;&lt;td&gt; fielda &lt;/td&gt;&lt;td&gt; %s &lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt; fieldb &lt;/td&gt;&lt;td&gt; %s &lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;
&lt;hr /&gt;
&lt;/body&gt;
&lt;/html&gt;
'''

print html % (fielda, fieldb)


# ---------------------------------------------------------------
# cgitest.py - end of file
# ---------------------------------------------------------------
#



</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014407.html">[mod_python] Re: invalid literal for float solved addendum
</A></li>
	<LI>Next message: <A HREF="014408.html">[mod_python] is mod_python threadsafe?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14409">[ date ]</a>
              <a href="thread.html#14409">[ thread ]</a>
              <a href="subject.html#14409">[ subject ]</a>
              <a href="author.html#14409">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
