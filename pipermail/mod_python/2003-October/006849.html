<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] 
 I can access mod_ssl cert env vars using PerlAuthenHandler, but howto do
 it with a PythonAuthenHandler?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20%0A%20I%20can%20access%20mod_ssl%20cert%20env%20vars%20using%20PerlAuthenHandler%2C%20but%20howto%20do%0A%20it%20with%20a%20PythonAuthenHandler%3F&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006848.html">
   <LINK REL="Next"  HREF="006854.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] 
 I can access mod_ssl cert env vars using PerlAuthenHandler, but howto do
 it with a PythonAuthenHandler?</H1>
    <B>perry.tew at cibavision.novartis.com</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20%0A%20I%20can%20access%20mod_ssl%20cert%20env%20vars%20using%20PerlAuthenHandler%2C%20but%20howto%20do%0A%20it%20with%20a%20PythonAuthenHandler%3F&In-Reply-To="
       TITLE="[mod_python] 
 I can access mod_ssl cert env vars using PerlAuthenHandler, but howto do
 it with a PythonAuthenHandler?">perry.tew at cibavision.novartis.com
       </A><BR>
    <I>Wed Oct  1 16:39:32 EST 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="006848.html">[mod_python] writing to a file from mod_python
</A></li>
        <LI>Next message: <A HREF="006854.html">[mod_python]  I can access mod_ssl cert env vars using
 PerlAuthenHandler, but howto do it with a PythonAuthenHandler?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6849">[ date ]</a>
              <a href="thread.html#6849">[ thread ]</a>
              <a href="subject.html#6849">[ subject ]</a>
              <a href="author.html#6849">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<table border=0 width="100%"><tr><td>
<!--beginarticle-->
<PRE>Hello,
   I'm trying to port a mod_perl handler to mod_python. 
The mod_perl handler was based off an Authentication Handler discussed 
in Chapter 6 of the &quot;Writing Apache Modules in Perl and C&quot; book by 
MacEachern 
(page 326 for those who have the book).   At any rate, concerning how to 
access 
environment variables set by mod_ssl, the book states correctly the 
following:

&quot;&quot;&quot;
The handler then issues a subrequest and retrieves the value of 
SSL_CLIENT_DN from 
the subrequest's environment table.  The subrequest is necessary because 
the parsed 
certificate fields aren't placed into the table until the fixup stage, 
which ordinarily occurs 
after the authorization phase.
&quot;&quot;&quot;


So, my perl code looks like this:
##########################################
my $subr = $r-&gt;lookup_uri($r-&gt;uri);
my $env = $subr-&gt;subprocess_env;
my $cn = $env-&gt;{'SSL_CLIENT_S_DN_CN'};
my $dn = $env-&gt;{'SSL_CLIENT_S_DN'};
##########################################




I'm trying to do the same thing in python with this:
############################################
        req.internal_redirect(req.unparsed_uri)
        req.add_common_vars()
        for k, v in req.subprocess_env.items():
                msg = k + &quot;=&quot; + v
                apache.log_error( msg , apache.APLOG_NOTICE )

############################################

However, the SSL vars aren't in the env table when my handler dumps the 
items to the log. 
The handler is being called and it dumps a lot of
env variables to the log, but no SSL vars.  The PythonAuthenHandler that 
contains the code above 
protects the printenv script, which I call to test the handlers.  The 
printenv script is displaying all
of the SSL env vars correctly, so I know I have the mod_ssl directives 
correct.

Does anyone see an error in what I'm doing wrong (or need to do)?  This is 
my first attempt as writing an AuthenHandler
and I would greatly appreciate any insight.

Thanks,
Perry Tew
</PRE>
<!--endarticle-->
</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006848.html">[mod_python] writing to a file from mod_python
</A></li>
	<LI>Next message: <A HREF="006854.html">[mod_python]  I can access mod_ssl cert env vars using
 PerlAuthenHandler, but howto do it with a PythonAuthenHandler?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6849">[ date ]</a>
              <a href="thread.html#6849">[ thread ]</a>
              <a href="subject.html#6849">[ subject ]</a>
              <a href="author.html#6849">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
