<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Interpreters and global names
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Interpreters%20and%20global%20names&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024155.html">
   <LINK REL="Next"  HREF="024157.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Interpreters and global names</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Rolf van de Krol</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Interpreters%20and%20global%20names&In-Reply-To="
       TITLE="[mod_python] Interpreters and global names">mod_python at rolfvandekrol.nl
       </A><BR>
    <I>Tue Aug 28 11:52:14 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="024155.html">[mod_python] Aliasing extensions in mod_python
</A></li>
        <LI>Next message: <A HREF="024157.html">[mod_python] Interpreters and global names
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24156">[ date ]</a>
              <a href="thread.html#24156">[ thread ]</a>
              <a href="subject.html#24156">[ subject ]</a>
              <a href="author.html#24156">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi everybody at this list,

I've got a problem. To me it seems quite complex so explaining it takes 
some code to write. But i'm a total newbie to mod_python. I've read the 
documentation, I understand it, I managed to setup a running mod_python 
installation and I can write some simple applications with it. That's it.
So, my apologies for the amount of code in the message,  I hope you can 
bring the effort to read it to understand my problem. I enclosed python 
code in &lt;code&gt; tags to show where the code begins and ends.

I've set up two VirtualHosts with the following directives in 
httpd.conf. (I changed some names, because the domainnames used for this 
are not to be published.)

NameVirtualHost *:80
&lt;VirtualHost *:80&gt;
    ServerName domain1.ext
    ServerAdmin <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">admin at domain1.ext</A>
    &lt;Location /&gt;
        Order Allow,Deny
        Allow from all
      
        SetHandler mod_python
        PythonInterpreter domain1interpreter
        PythonHandler D:/main.py
        PythonDebug On
    &lt;/Location&gt;
&lt;/VirtualHost&gt;

&lt;VirtualHost *:80&gt;
   ServerName admin.domain1.ext
   ServerAdmin <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">admin at domain1.ext</A>
     &lt;Location /&gt;
       Order Allow,Deny
       Allow from all
             SetHandler mod_python
       PythonInterpreter domain1interpreter
       PythonHandler D:/radmin.py
       PythonDebug On
   &lt;/Location&gt;
&lt;/VirtualHost&gt;

As you can see, they both share the same interpreter. The setup works. 
With the following python code in main.py and radmin.py they both print 
the same name.

&lt;code&gt;
from mod_python import apache
def handler(req):
    req.content_type = 'text/plain'
    req.write(req.interpreter)
    return apache.OK
&lt;/code&gt;

I changed main.py to the following code:

&lt;code&gt;
from mod_python import apache
import collections

def handler(req):
    if not globals().has_key('aPool'):
        aPool = collections.deque()
        global aPool
    else:
        global aPool

    # code to use aPool and print some output
&lt;/code&gt;

aPool is used to create a database connection pool, but that's not 
important to the problem. The code above works fine.

I change radmin.py to the following:

&lt;code&gt;
from mod_python import apache
import collections
import pprint

def handler(req):
    req.content_type = 'text/plain'
    req.write(pprint.pformat(globals()))
&lt;/code&gt;

What I expected was that I could find aPool in the output of radmin.py. 
But I couldn't. It just isn't there. It seems that the global names 
aren't as global as they seem to be. Is there a way to make variables 
set in main.py accessable to radmin.py?

I hope any of you knows the answer.

Rolf van de Krol

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024155.html">[mod_python] Aliasing extensions in mod_python
</A></li>
	<LI>Next message: <A HREF="024157.html">[mod_python] Interpreters and global names
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24156">[ date ]</a>
              <a href="thread.html#24156">[ thread ]</a>
              <a href="subject.html#24156">[ subject ]</a>
              <a href="author.html#24156">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
