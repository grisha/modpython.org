<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Headers not being sent when input/output is over a
	certain size
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Headers%20not%20being%20sent%20when%20input/output%20is%20over%20a%0A%09certain%20size&In-Reply-To=A32BEB83ADE348AFBFAEB21171B296B4%40topia">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024165.html">
   <LINK REL="Next"  HREF="024171.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Headers not being sent when input/output is over a
	certain size</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Headers%20not%20being%20sent%20when%20input/output%20is%20over%20a%0A%09certain%20size&In-Reply-To=A32BEB83ADE348AFBFAEB21171B296B4%40topia"
       TITLE="[mod_python] Headers not being sent when input/output is over a
	certain size">graham.dumpleton at gmail.com
       </A><BR>
    <I>Wed Aug 29 06:12:15 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="024165.html">[mod_python] Headers not being sent when input/output is over a
	certain size
</A></li>
        <LI>Next message: <A HREF="024171.html">[mod_python] Headers not being sent when input/output is over a
	certain size
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24167">[ date ]</a>
              <a href="thread.html#24167">[ thread ]</a>
              <a href="subject.html#24167">[ subject ]</a>
              <a href="author.html#24167">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 29/08/2007, Sidnei da Silva &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">sidnei at enfoldsystems.com</A>&gt; wrote:
&gt;<i> ----- Original Message -----
</I>&gt;<i> &gt; Do you get a content length header if you enable the Apache
</I>&gt;<i> &gt; CONTENT_LENGTH output filter?
</I>&gt;<i>
</I>&gt;<i> I haven't actually tried that, but is it really relevant? The fact is that
</I>&gt;<i> what I'm seeing is that Content-Length *and* Content-Type does get properly
</I>&gt;<i> set when the request has a small size, but not when it goes over a certain
</I>&gt;<i> size. I'm suspecting on the 'automatically send the headers on first
</I>&gt;<i> write()' feature, but haven't dug enough to have 100% confidence that is the
</I>&gt;<i> issue.
</I>&gt;<i>
</I>&gt;<i> &gt; Part of the problem may be that output filters in Apache are a
</I>&gt;<i> &gt; resource filter and are only possibly supposed to operate on the
</I>&gt;<i> &gt; actual body content. I'm not sure if resource filters are supposed to
</I>&gt;<i> &gt; be able to operate on headers.
</I>&gt;<i>
</I>&gt;<i> Could be, but that would not explain why it does work for small requests.
</I>
But you indicated you were buffering all output so sending headers on
first write shouldn't be different for the two.

The reason for suggesting CONTENT_LENGTH is that it is a filter which
is specifically meant to update headers. As I pointed out it registers
itself as a different type of output filter. There may be something
about the filter type that provides guarantees which the filter type
used by mod_python doesn't. Thus, whether it works for small write may
just be undefined behaviour.

&gt;<i> &gt; The CONTENT_LENGTH output filter for example which does operate on
</I>&gt;<i> &gt; headers, is registered as a protocol filter and not a resource filter.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I don't have the time to investigate this now, but might be able to
</I>&gt;<i> &gt; look at what the differences are later and whether you can even set
</I>&gt;<i> &gt; headers in mod_python output filters.
</I>&gt;<i>
</I>&gt;<i> I will give CONTENT_LENGTH a try later this week. Leaving home to attend the
</I>&gt;<i> 3rd PyConBrasil right now.
</I>
I'll see if I can work out something from the code you sent in the mean time.

Have fun at PyConBrasil. When you get back you will have to tell me
whether there was any talk about mod_wsgi. ;-)

Graham
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024165.html">[mod_python] Headers not being sent when input/output is over a
	certain size
</A></li>
	<LI>Next message: <A HREF="024171.html">[mod_python] Headers not being sent when input/output is over a
	certain size
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24167">[ date ]</a>
              <a href="thread.html#24167">[ thread ]</a>
              <a href="subject.html#24167">[ subject ]</a>
              <a href="author.html#24167">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
