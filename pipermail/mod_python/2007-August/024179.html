<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Re: Debian bug#433038: mod_python collides with
	mod_php5
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Re%3A%20Debian%20bug%23433038%3A%20mod_python%20collides%20with%0A%09mod_php5&In-Reply-To=20070831062814.GA25163%40mycre.ws">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024187.html">
   <LINK REL="Next"  HREF="024180.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Re: Debian bug#433038: mod_python collides with
	mod_php5</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Re%3A%20Debian%20bug%23433038%3A%20mod_python%20collides%20with%0A%09mod_php5&In-Reply-To=20070831062814.GA25163%40mycre.ws"
       TITLE="[mod_python] Re: Debian bug#433038: mod_python collides with
	mod_php5">graham.dumpleton at gmail.com
       </A><BR>
    <I>Fri Aug 31 02:46:00 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="024187.html">[mod_python] Howto force reload of all modules
</A></li>
        <LI>Next message: <A HREF="024180.html">[mod_python] Re: Debian bug#433038: mod_python collides with
	mod_php5
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24179">[ date ]</a>
              <a href="thread.html#24179">[ thread ]</a>
              <a href="subject.html#24179">[ subject ]</a>
              <a href="author.html#24179">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>More information. In libmhash2 it has:

lib/.libs/libmhash.a(md5.o):
00000a60 T _MD5Final
00000000 T _MD5Init
00000040 T _MD5Transform
00000940 T _MD5Update
         U _mutils_bzero
         U _mutils_memcpy
         U _mutils_word32nswap
         U dyld_stub_binding_helper

In Python (&lt;2.5), it has its own md5c.c file. If this is compiled
correctly, it should end up with:

00001288 T __Py_MD5Final
00001174 T __Py_MD5Init
000011b4 T __Py_MD5Update

Ie., Python should prefix the symbols so there is no clash.

You should check that this prefixing is actually occurring by doing an
nm on md5.so in Python modules directory. If it isn't, that could be
the problem.

Graham

On 31/08/2007, Robert Edmonds &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">edmonds at debian.org</A>&gt; wrote:
&gt;<i> Hi, Graham:
</I>&gt;<i>
</I>&gt;<i> Thanks for the fast follow-up.  I'm adding the bug report to the To: so
</I>&gt;<i> that the original bug submitter will see your response.
</I>&gt;<i>
</I>&gt;<i> Graham Dumpleton wrote:
</I>&gt;<i> &gt; In 411487 it mentions:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &quot;&quot;&quot;So, it seems it's directly related to libmhash2 (as [2] suggests).&quot;&quot;&quot;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Disabling of mhash module may not be enough if one of the other PHP
</I>&gt;<i> &gt; modules they list in 433038 also use libmhash2 library. Quite possible
</I>&gt;<i> &gt; that one of the crypto libraries use it, or the ldap module mentioned
</I>&gt;<i> &gt; in the mod_python mailing list mail.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Can you run ldd on main PHP module and all PHP modules and see which
</I>&gt;<i> &gt; one has a dependency on libmhash2, or any other md5 hash library.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Basic problem as we understand it is that libmhash2 uses a symbol name
</I>&gt;<i> &gt; which clashes with one used by Python md5 module. Which ever gets
</I>&gt;<i> &gt; loaded first, usually PHP version, takes precedence and since that is
</I>&gt;<i> &gt; not compatible with other package a crash occurs.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; If it can be determined that it is libmhash2 and then which symbol in
</I>&gt;<i> &gt; it clashes with one in Python md5 module, one or the other could
</I>&gt;<i> &gt; somehow be namespace escaped to avoid the problem.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Graham
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; On 31/08/2007, Robert Edmonds &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">edmonds at debian.org</A>&gt; wrote:
</I>&gt;<i> &gt; &gt; Hi,
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; I'm one of the Debian maintainers of the libapache2-mod-python package.
</I>&gt;<i> &gt; &gt; Could someone please take a look at the report filed here?
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;     <A HREF="http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=433038">http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=433038</A>
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; The user writes,
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;     If libapache2-mod-python is installed together with libapache2-mod-php5,
</I>&gt;<i> &gt; &gt;     (at least) the mod_python.psp handler fails immediately without any proper
</I>&gt;<i> &gt; &gt;     error message.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;     This also happens if the php5 mhash module is uninstalled, purged and
</I>&gt;<i> &gt; &gt;     apache is restarted.  mod_python starts working immediately if mod-php5 is
</I>&gt;<i> &gt; &gt;     disabled using &quot;a2dismod php5&quot; and restarting apache.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;     [...]
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;     This effectively renders mod_python.psp unusuable as soon as mod-php5
</I>&gt;<i> &gt; &gt;     (maybe together with some specific modules) is installed and it's also hard
</I>&gt;<i> &gt; &gt;     to debug as there's no indication whatsoever of what is going wrong, other
</I>&gt;<i> &gt; &gt;     than that it &quot;doesn't work&quot;.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; More details are on the page.  I'm afraid I'm having difficulties
</I>&gt;<i> &gt; &gt; tracking down the root cause of the user's problem.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; --
</I>&gt;<i> &gt; &gt; Robert Edmonds
</I>&gt;<i> &gt; &gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">edmonds at debian.org</A>
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Robert Edmonds
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">edmonds at debian.org</A>
</I>&gt;<i>
</I></PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024187.html">[mod_python] Howto force reload of all modules
</A></li>
	<LI>Next message: <A HREF="024180.html">[mod_python] Re: Debian bug#433038: mod_python collides with
	mod_php5
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24179">[ date ]</a>
              <a href="thread.html#24179">[ thread ]</a>
              <a href="subject.html#24179">[ subject ]</a>
              <a href="author.html#24179">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
