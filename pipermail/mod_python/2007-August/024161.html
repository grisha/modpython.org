<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Session-related hang
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Session-related%20hang&In-Reply-To=b2c603da0708281926w45322828s194214a0212b443%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024159.html">
   <LINK REL="Next"  HREF="024170.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Session-related hang</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Session-related%20hang&In-Reply-To=b2c603da0708281926w45322828s194214a0212b443%40mail.gmail.com"
       TITLE="[mod_python] Session-related hang">graham.dumpleton at gmail.com
       </A><BR>
    <I>Tue Aug 28 23:25:09 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="024159.html">[mod_python] Session-related hang
</A></li>
        <LI>Next message: <A HREF="024170.html">[mod_python] Session-related hang
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24161">[ date ]</a>
              <a href="thread.html#24161">[ thread ]</a>
              <a href="subject.html#24161">[ subject ]</a>
              <a href="author.html#24161">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>You are likely trying to create a session object when one has already
been created for that request already and thus dead locking on
yourself. There are lots of examples of people doing this in the
www.modpython.org mailing list archives, search from www.modpython.org
search box.

What is in generate_content(...)? Without seeing how you are
manipulating sessions can say exactly what you are doing wrong

BTW, why are you creating a derived session object type?

Also, using reload() like that is not recommended. Upgrade to
mod_python 3.3.1 and read about import_module() function in:

  <A HREF="http://www.modpython.org/live/current/doc-html/pyapi-apmeth.html">http://www.modpython.org/live/current/doc-html/pyapi-apmeth.html</A>

Graham

On 29/08/2007, Boris Du&#353;ek &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">boris.dusek at gmail.com</A>&gt; wrote:
&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I am using Apache 2.2.3, mod_python 2.3.8. I experience a hang that is
</I>&gt;<i> related to Session.
</I>&gt;<i> I have such a class:
</I>&gt;<i>
</I>&gt;<i> file nanosession.py:
</I>&gt;<i> class NanoSession(Session.DbmSession):
</I>&gt;<i>     def __init__(self, req):
</I>&gt;<i>         logging.debug(&quot;In NanoSession.__init__&quot;)
</I>&gt;<i>         logging.debug(&quot;Calling DbmSession.__init__&quot;)
</I>&gt;<i>         Session.DbmSession.__init__(self, req)
</I>&gt;<i>
</I>&gt;<i>     def ...
</I>&gt;<i>
</I>&gt;<i> in the index.py file, that gets displayed by mod_python.publisher,
</I>&gt;<i> there is following code:
</I>&gt;<i>
</I>&gt;<i> def index(req, **vars):
</I>&gt;<i>     logging.debug(&quot;Entered index.py/index&quot;)
</I>&gt;<i>
</I>&gt;<i>     logging.debug(&quot;Reloading module 1&quot;)
</I>&gt;<i>     reload(module1)
</I>&gt;<i>
</I>&gt;<i>     logging.debug(&quot;Reloading module nanosession&quot;)
</I>&gt;<i>     reload(nanosession)
</I>&gt;<i>
</I>&gt;<i>     logging.debug(&quot;Reloading module 2&quot;)
</I>&gt;<i>     reload(module2)
</I>&gt;<i>
</I>&gt;<i>     logging.debug(&quot;Generating page content&quot;)
</I>&gt;<i>     content = generate_content(...)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> When I hit for the index.py page, it was working for the first time. I
</I>&gt;<i> am not really sure what I have been doing then, probably just surfing
</I>&gt;<i> the other pages on the same site. And then suddenly, from then on,
</I>&gt;<i> when I wanted to display some page, it took forever (I mean not long,
</I>&gt;<i> I mean it did not display, Firefox displaying &quot;Waiting for ...&quot;,
</I>&gt;<i> netcat displaying no output available). Then I asked a friend at a
</I>&gt;<i> different computer (with a different IP) to try to access the same
</I>&gt;<i> webpage - he could access it, and it displayed immediately. However,
</I>&gt;<i> then he hit the reload button in his browser, and he was immediately
</I>&gt;<i> from then on experiencing the same &quot;never loads&quot; behavior for any
</I>&gt;<i> webpage that uses sessions.
</I>&gt;<i>
</I>&gt;<i> The logging output from the above code shows that it hangs on
</I>&gt;<i> DbmSession.__init__:
</I>&gt;<i>
</I>&gt;<i> DEBUG:root:Entered index.py/index
</I>&gt;<i> DEBUG:root:Reloading module webpage
</I>&gt;<i> DEBUG:root:Reloading module webpage
</I>&gt;<i> DEBUG:root:Reloading module webpage
</I>&gt;<i> DEBUG:root:Creating session
</I>&gt;<i> DEBUG:root:nanosession.py/NanoSession.__init__
</I>&gt;<i> DEBUG:root:calling DbnSession.__init__
</I>&gt;<i> DEBUG:root:Entered index.py/index
</I>&gt;<i> DEBUG:root:Reloading module webpage
</I>&gt;<i> DEBUG:root:Reloading module webpage
</I>&gt;<i> DEBUG:root:Reloading module webpage
</I>&gt;<i> DEBUG:root:Creating session
</I>&gt;<i> DEBUG:root:nanosession.py/NanoSession.__init__
</I>&gt;<i> DEBUG:root:calling DbmSession.__init__
</I>&gt;<i> ...
</I>&gt;<i> and so on...
</I>&gt;<i>
</I>&gt;<i> Do you please have any suggestions about possible cause and workarounds?
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i> Boris Du&#353;ek
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i>
</I>
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024159.html">[mod_python] Session-related hang
</A></li>
	<LI>Next message: <A HREF="024170.html">[mod_python] Session-related hang
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24161">[ date ]</a>
              <a href="thread.html#24161">[ thread ]</a>
              <a href="subject.html#24161">[ subject ]</a>
              <a href="author.html#24161">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
