<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] O/S SendFile call
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20O/S%20SendFile%20call&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014965.html">
   <LINK REL="Next"  HREF="014967.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] O/S SendFile call</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Oliver Nelson</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20O/S%20SendFile%20call&In-Reply-To="
       TITLE="[mod_python] O/S SendFile call">flxkid at techemail.com
       </A><BR>
    <I>Fri Feb  6 12:31:05 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="014965.html">[mod_python] Reload scripts without restarting Apache?
</A></li>
        <LI>Next message: <A HREF="014967.html">[mod_python] Issue after upgrade
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14964">[ date ]</a>
              <a href="thread.html#14964">[ thread ]</a>
              <a href="subject.html#14964">[ subject ]</a>
              <a href="author.html#14964">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Conrad,

Thanx for the tip.  Had 3.1.2b2 or something and it wasn't working.  Went to the CVS and found some notes that your patch had been changed from write_file to sendfile.  Just FYI.

Thanx again,

OLIVER


--- Conrad Steenberg &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">conrad at hep.caltech.edu</A>&gt; wrote:
Hi Oliver

The request class in newer versions (3.1b2+ I think) has a write_file
method that you can use as follows:

# First init the offset and bytes variables, then:
  try:
    while bytes&gt;0:
      sent=0
      sent=req.write_file(filename,offset,bytes)
      if sent&lt;0: raise OSError(5,&quot;Error sending file&quot;)
      offset=offset+sent
      bytes=bytes-sent
  except:
    # handle error
    pass
  return apache.OK

HTH

Conrad

On Wed, 2004-02-04 at 22:16, Oliver Nelson wrote:
&gt;<i> I read in the apache docs that if possible you should try and have an O/S version that has the sendfile call so that apache doesn't have to do a read and a send of files.
</I>&gt;<i> 
</I>&gt;<i> I am writing a python handler that has to go out on a network, find a file and then pass then return that file to the client browser.  Right now I'm reading in the file and then writing it the output stream.  It seems that there should be a much better way to do this like apache does it with sendfile.  Is it possible to use this (the sendfile os call) from inside my python handler?
</I>&gt;<i> 
</I>&gt;<i> OLIVER
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>-- 
Conrad Steenberg &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">conrad at hep.caltech.edu</A>&gt;
-- 
Conrad Steenberg &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">conrad at hep.caltech.edu</A>&gt;
</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014965.html">[mod_python] Reload scripts without restarting Apache?
</A></li>
	<LI>Next message: <A HREF="014967.html">[mod_python] Issue after upgrade
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14964">[ date ]</a>
              <a href="thread.html#14964">[ thread ]</a>
              <a href="subject.html#14964">[ subject ]</a>
              <a href="author.html#14964">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
