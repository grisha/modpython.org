<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Any support for on-time Initialization?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Any%20support%20for%20on-time%20Initialization%3F&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014939.html">
   <LINK REL="Next"  HREF="014933.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Any support for on-time Initialization?</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>perry.tew at cibavision.novartis.com</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Any%20support%20for%20on-time%20Initialization%3F&In-Reply-To="
       TITLE="[mod_python] Any support for on-time Initialization?">perry.tew at cibavision.novartis.com
       </A><BR>
    <I>Mon Feb  2 22:44:33 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="014939.html">[mod_python] Any support for on-time Initialization?
</A></li>
        <LI>Next message: <A HREF="014933.html">[mod_python] DirectoryIndex index.py?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14932">[ date ]</a>
              <a href="thread.html#14932">[ thread ]</a>
              <a href="subject.html#14932">[ subject ]</a>
              <a href="author.html#14932">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Grisha,
   Alas, I fear I have offended.  Let me elaborate on the errors I 
received.  While using the worker MPM, I was making calls to an oracle 
database using cx_Oracle (bad idea) and later the DCOracle2 
implementation.  Under low stress, the worker MPM contained no errors. 
However, under heavy load, I started to receive errors thrown from the 
jonpy dbpool.py class, specifically in the _connection_notinuse method. It 
would recurse until the apache child died.    When I switched to the 
prefork model I could not reproduce the error at all.  And I pounded the 
site using ab and 250 clients. 
    Without knowing for sure that the jonpy module was absolutely correct, 
it is unfair for me to say that it's mod_python's fault.  However, it is 
fair for me to say that the combination of mod_python with the jon.dbpool 
class did not work under the worker MPM, and does work under the prefork.  
I could not and do not know how to validate the dbpool.py class.  I'm new 
to python and have yet to understand weak references and some other 
things.  It was easy for me to recompile apache using a different MPM.   I 
hope that sheds some more light onto the situation I'm encountered and 
gives mod_python a fairer shake.

    Let me also say that I feel really bad speaking negatively about free 
open source software.  I know you've worked hard for the past several 
years to provide a really good python module for apache.  I do appreciate 
it.   I also know that since I've paid zero dollars to use it, it's bad 
mojo to criticize.  However, I was only trying to help another developer 
having similar issues as I was.

    I do intend to contribute to this project. But, I come from a strong 
java background and am learning python and C as I go.  Man, do I _love_ 
python.  Right now I am but a grasshopper.   I will commit to 
troubleshooting the jonpy module under the worker MPM and report back what 
the root cause failure analysis is (as best as I understand it).   I did 
not do it previously because of deadlines (I know we all got 'em).  When I 
can, I will investigate.      It would help if anyone has any experience 
with the jonpy modules and can report on their experiences.  It would also 
help if someone could suggest another pooling module to manage db 
connections under a threaded model.  I don't know of another.

    In the meantime, is there anything I can do from a low-tech or 
non-tech perspective that doesn't require a critical timeline?

Thanks,
Perry Tew






At 09:41 PM 2/2/2004 -0500, you wrote:


&gt;<i>On Mon, 2 Feb 2004, Daniel West wrote:
</I>&gt;<i>
</I>&gt;<i> &gt; At 02:33 PM 2/2/2004 -0500, you wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt;Like Daniel said, going with a threaded MPM is not for the faint of
</I>&gt;<i> &gt; &gt;heart, as MySQLdb doesn't like sharing connections very much.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Actually, database connections can successfully be shared among 
</I>multiple
&gt;<i> &gt; threads with the standard Python Queue module plus some support
</I>&gt;<i> &gt; code.  However, mod_python seems to have problems in general with
</I>&gt;<i> &gt; multi-threaded environments.
</I>&gt;<i>
</I>&gt;<i>Just to be fair - mod_python does not have problems with multi-threaded
</I>&gt;<i>environments, none that I am aware of at least. It is used quite a bit in
</I>&gt;<i>mutlithreaded environments, not the least of which is Windows, where
</I>&gt;<i>multi-threaded is the only option.
</I>&gt;<i>
</I>&gt;<i>What does have a problem with multi-threaded environment is one of the
</I>&gt;<i>commonly used MySQL Python modules, which doesn't really have much to do
</I>&gt;<i>with mod_python itself.
</I>

Grisha,

I posted a problem I ran into a couple weeks ago to this list (subject: 
3.1.2b and worker_mpm).  Seems the output filter under load was mixing up 
requests.  When making a request I would get part of my request plus part 
of another request.  When I changed to a prefork model, that problem went 
away.  The only response I got to my message was from Perry who claims &quot;it 

went to pieces under stress testing&quot; and &quot;I saw some
wicked nasty recursion errors&quot; in reference to the worker_mpm and 
mod_python.  Since I didn't get any response from you or anyone else in 
the 
know about these things, I was left to assume that this was a weak area 
for 
mod_python which would receive attention in due time.  I even offered my 
assistance for testing.  I don't know how else to describe the problem I 
experienced except for a threading issue.

Perhaps there's something there that you're not aware of.  I, for one, 
would love to be able to use worker_mpm again.

-Dan


_______________________________________________
Mod_python mailing list
<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>



</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014939.html">[mod_python] Any support for on-time Initialization?
</A></li>
	<LI>Next message: <A HREF="014933.html">[mod_python] DirectoryIndex index.py?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14932">[ date ]</a>
              <a href="thread.html#14932">[ thread ]</a>
              <a href="subject.html#14932">[ subject ]</a>
              <a href="author.html#14932">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
