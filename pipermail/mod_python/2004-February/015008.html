<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Mod_Python and win32com
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Mod_Python%20and%20win32com&In-Reply-To=40288278.80302%40sjsoft.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015005.html">
   <LINK REL="Next"  HREF="015010.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Mod_Python and win32com</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Ryan Felder</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Mod_Python%20and%20win32com&In-Reply-To=40288278.80302%40sjsoft.com"
       TITLE="[mod_python] Mod_Python and win32com">rfelder at globaltecsolutions.com
       </A><BR>
    <I>Tue Feb 10 09:41:40 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="015005.html">[mod_python] Mod_Python and win32com
</A></li>
        <LI>Next message: <A HREF="015010.html">[mod_python] Mod_Python and win32com
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15008">[ date ]</a>
              <a href="thread.html#15008">[ thread ]</a>
              <a href="subject.html#15008">[ subject ]</a>
              <a href="author.html#15008">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Sorry for not including my version numbers.
Apache/2.0.43 (Win32) mod_ssl/2.0.43 OpenSSL/0.9.6h mod_python/3.0.4
Python/2.3.3

I am using the most recent version of python from python.org, and the
win32all
that is included with it. My version of apache is from the swamp
distribution
of apache for windows.

I have done another example to verify that this is not an issue with the
third party dll I am calling. The example code is very similar to my
previous example code.

This code properly opens up excel from a command prompt, but when run
from under mod_python, it seems to ignore the com calls entirely.

This code will return &quot;aha&quot; to my web browser, as expected.

def index():
	import win32com.client
	a=win32com.client.Dispatch('Excel.Application')
	a.Visible = 1
	a.Workbooks.Add()
	a.ActiveSheet.Cells(1,1).Value = 'aha'
	return &quot;aha&quot;

if __name__ == &quot;__main__&quot;:
	print index()

Thanks again.

- Ryan

-----Original Message-----
From: David Fraser [mailto:<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">davidf at sjsoft.com</A>]
Sent: Tuesday, February 10, 2004 1:04 AM
To: Ryan Felder
Cc: <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mod_python at modpython.org</A>
Subject: Re: [mod_python] Mod_Python and win32com

This sounds wierd
We use win32com.client without any problems from within mod_python (also
using similar versions to you, but Python 2.2).
Which version of win32all are you using? It may be interesting to try
stepping into the win32com code and adding traces, to see whether the
COM call is actually made and nothing is returned, or whether it never
gets there and isn't producing an error though it should be.

David

Ryan Felder wrote:

&gt;<i>Hi all, I'm pretty new to working with Mod_Python, and the project I am
</I>&gt;<i>working on requires me to be able to poll for some data through COM.
</I>&gt;<i>
</I>&gt;<i>I am developing in windows 2000 professional, and will be running
</I>&gt;<i>my code on windows apache 2.0 with mod python. More specifically,
</I>&gt;<i>I am using the distribution of apache ssl and others named Swamp.
</I>&gt;<i>
</I>&gt;<i>The code works fine when I run it standalone, however, when I attempt
</I>&gt;<i>to run it on my development site, the calls to the com object that work
</I>&gt;<i>beautifully alone, simply fail to return data. As follows is a brief
</I>&gt;<i>code sample which demonstrates this behaviour. This code functions
</I>&gt;<i>properly from a command prompt or in the interpreter.
</I>&gt;<i>
</I>&gt;<i>def index():
</I>&gt;<i>	import win32com.client
</I>&gt;<i>	a=win32com.client.Dispatch('MyDataSource')
</I>&gt;<i>	b=str(a.GetOrders(account_identifier,'',2,0))
</I>&gt;<i>	return str(len(b))
</I>&gt;<i>
</I>&gt;<i>if __name__ == &quot;__main__&quot;:
</I>&gt;<i>	print index()
</I>&gt;<i>
</I>&gt;<i>When this code runs standalone, it will return a non-zero value,
</I>&gt;<i>and when run from mod_python, it returns a zero value, due to
</I>&gt;<i>the len() function measuring the length of the output of my data call.
</I>&gt;<i>
</I>&gt;<i>By way of typos, I have been able to produce exceptions in my testing
</I>&gt;<i>browser, so this leads me to believe that it is not passing any exceptions.
</I>&gt;<i>
</I>&gt;<i>My research online has suggested that I try importing my modules through
</I>&gt;<i>apache.import_module. This gives me a number of different issues where
</I>&gt;<i>if I instantiate an instance of win32com, then try to address
</I>&gt;<i>that.client.Dispatch,
</I>&gt;<i>I recieve &quot;module does not have 'client'&quot;, or similarly, if I try to
</I>&gt;<i>instantiate
</I>&gt;<i>an instance of win32com.client, I recieve &quot;module does not have
</I>'Dispatch'&quot;.
&gt;<i>
</I>&gt;<i>I have also seen it suggested that I initialize the com properly, and
</I>&gt;<i>manually,
</I>&gt;<i>by
</I>&gt;<i>	import sys
</I>&gt;<i>	sys.coinit_flags = 0
</I>&gt;<i>
</I>&gt;<i>as well as
</I>&gt;<i>
</I>&gt;<i>	import pythoncom
</I>&gt;<i>	pythoncom.CoInitializeEx(pythoncom.COINIT_MULTITHREADED)
</I>&gt;<i>
</I>&gt;<i>which I do before attemting to import win32com, but to no avail,
</I>&gt;<i>in many, and in all permutations.
</I>&gt;<i>
</I>&gt;<i>I have tried every permutation of apache.import_module and import,
</I>&gt;<i>that I can muster, and I am hitting a brick wall.
</I>&gt;<i>
</I>&gt;<i>It seems that there is a breakdown in communications between myself and the
</I>&gt;<i>com objects when I try to import them. Any help that you all can offer me
</I>&gt;<i>would be hugely appreciated!
</I>&gt;<i>
</I>&gt;<i>- Ryan
</I>&gt;<i>
</I>&gt;<i>
</I>

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015005.html">[mod_python] Mod_Python and win32com
</A></li>
	<LI>Next message: <A HREF="015010.html">[mod_python] Mod_Python and win32com
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15008">[ date ]</a>
              <a href="thread.html#15008">[ thread ]</a>
              <a href="subject.html#15008">[ subject ]</a>
              <a href="author.html#15008">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
