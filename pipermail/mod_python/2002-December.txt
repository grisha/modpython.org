From stephane.bidoul at softwareag.com  Mon Dec  2 18:15:47 2002
From: stephane.bidoul at softwareag.com (Stéphane Bidoul)
Date: Fri Jan  9 21:47:08 2004
Subject: [mod_python] mp_server.register_cleanup
Message-ID: <000001c29a26$78d78460$56241eac@acsesbi>

Hi Grisha,

I'm back using mod_python, on a real project this time.
We've been using 3.0 beta for a few weeks and it works great!

Now I'm trying to use mp_server.register_cleanup, and that fails
with a "ValueError: first argument must be a Request object".

My first diagnostic (unless I'm doing something silly)
is that it's a remnant of mod_python 2.x,
since the Request class seems to have disappeared
from apache.py.

Is that an easy fix for you? 
Or should I dig it a little bit more?

-sbi




From tigrux at avantel.net  Mon Dec  2 15:01:55 2002
From: tigrux at avantel.net (Sandino Flores Moreno)
Date: Fri Jan  9 21:47:08 2004
Subject: [mod_python] mp_server.register_cleanup
In-Reply-To: <000001c29a26$78d78460$56241eac@acsesbi>
References: <000001c29a26$78d78460$56241eac@acsesbi>
Message-ID: <1038859317.19550.9.camel@TigruXtatioN>

In my code (http://mamba.sf.net)
I'm using it in in this way:

def endRequest(mamba):
        if mamba.processor.globals.has_key('endRequest'):
                endRequest = mamba.processor.globals['endRequest']
                endRequest()
        
def endChild(mamba):
        if mamba.processor.globals.has_key('endChild'):
                endChild = mamba.processor.globals['endChild']
                endChild()


req.register_cleanup(endRequest, (mamba,) )
req.server.register_cleanup(req, endChild, (mamba,) )


From markusjais at yahoo.de  Mon Dec  2 22:31:41 2002
From: markusjais at yahoo.de (Markus Jais)
Date: Fri Jan  9 21:47:08 2004
Subject: [mod_python] beginners question
In-Reply-To: <001f01c29a3b$e92ddc40$6401a8c0@darwin>
References: <1038180652.3173.2.camel@eagle> 
	<001f01c29a3b$e92ddc40$6401a8c0@darwin>
Message-ID: <1038864704.2017.1.camel@eagle>

On Mon, 2002-11-25 at 01:48, Antonio Rodriguez wrote:
> Markus,
> 
> Go into the src directory of the dist and in the OPTIONS= line add -DEAPI.
> apxs will do the right thing and you will stop getting that warning.

thanks, but I found no OPTIONS in all the Make files
I then added 
OPTIONS=-DEAPI
to the Makefile, but this hat not effect.

markus

...

__________________________________________________________________

Gesendet von Yahoo! Mail - http://mail.yahoo.de
Möchten Sie mit einem Gruß antworten? http://grusskarten.yahoo.de

From antonio at memora.com  Mon Dec  2 16:46:54 2002
From: antonio at memora.com (Antonio Rodriguez)
Date: Fri Jan  9 21:47:09 2004
Subject: [mod_python] beginners question -- LIST moderation?
In-Reply-To: <1038864704.2017.1.camel@eagle>
Message-ID: <9297B926-063F-11D7-9E16-00039300D690@memora.com>

in the src directory near the top of the make file there is a line:
OPT=

and you want to make it:
OPT=-DEAPI

Sorry about the confusion.

One other important thing: is this list moderated or something? I 
posted this to you over a week ago and I just received my own post. If 
it is, I kind of wish it wasn't as it impedes the flow of 
communications.

AR


On Monday, December 2, 2002, at 04:31 PM, Markus Jais wrote:

> On Mon, 2002-11-25 at 01:48, Antonio Rodriguez wrote:
>> Markus,
>>
>> Go into the src directory of the dist and in the OPTIONS= line add 
>> -DEAPI.
>> apxs will do the right thing and you will stop getting that warning.
>
> thanks, but I found no OPTIONS in all the Make files
> I then added
> OPTIONS=-DEAPI
> to the Makefile, but this hat not effect.
>
> markus
>
> ...
>
> __________________________________________________________________
>
> Gesendet von Yahoo! Mail - http://mail.yahoo.de
> M?chten Sie mit einem Gru? antworten? http://grusskarten.yahoo.de
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>



From grisha at modpython.org  Mon Dec  2 16:52:26 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:47:09 2004
Subject: [mod_python] mp_server.register_cleanup
In-Reply-To: <000001c29a26$78d78460$56241eac@acsesbi>
Message-ID: <20021202164818.R5868-100000@eden.ispol.com>

Stephane -

Yes, it looks like server.register_cleanup was left forgotten....

Try applying this set of patches (this includes patches to the test
suite), I'll add this to HEAD.

RCS file: /home/cvs/httpd-python/src/serverobject.c,v
retrieving revision 1.13
diff -u -r1.13 serverobject.c
--- src/serverobject.c  8 Nov 2002 00:15:11 -0000       1.13
+++ src/serverobject.c  2 Dec 2002 21:47:52 -0000
@@ -117,30 +117,20 @@
     cleanup_info *ci;
     PyObject *handler = NULL;
     PyObject *data = NULL;
-    PyObject *Req = NULL;
     requestobject *req = NULL;

-    if (! PyArg_ParseTuple(args, "OO|O", &Req, &handler, &data))
+    if (! PyArg_ParseTuple(args, "OO|O", &req, &handler, &data))
        return NULL;

-    if (! PyObject_HasAttrString(Req, "_req")) {
-       PyErr_SetString(PyExc_ValueError, "first argument must be a Request object");
-       return NULL;
+    if (! MpRequest_Check(req)) {
+        PyErr_SetString(PyExc_ValueError,
+                        "first argument must be a request object");
+        return NULL;
     }
-    else {
-
-       req = (requestobject *) PyObject_GetAttrString(Req, "_req");
-
-       if (! MpRequest_Check(req)) {
-           PyErr_SetString(PyExc_ValueError,
-                           "first argument must be a request object");
-           return NULL;
-       }
-       else if(!PyCallable_Check(handler)) {
-           PyErr_SetString(PyExc_ValueError,
-                           "second argument must be a callable object");
-           return NULL;
-       }
+    else if(!PyCallable_Check(handler)) {
+        PyErr_SetString(PyExc_ValueError,
+                        "second argument must be a callable object");
+        return NULL;
     }

     ci = (cleanup_info *)malloc(sizeof(cleanup_info));
Index: test/test.py
===================================================================
RCS file: /home/cvs/httpd-python/test/test.py,v
retrieving revision 1.20
diff -u -r1.20 test.py
--- test/test.py        29 Oct 2002 21:52:18 -0000      1.20
+++ test/test.py        2 Dec 2002 21:47:52 -0000
@@ -776,12 +776,39 @@

         self.failUnless(result.wasSuccessful())

+    def test_srv_register_cleanup(self):
+
+        print "\n* Testing server.register_cleanup()..."
+
+        c = Directory(DOCUMENT_ROOT,
+                      SetHandler("python-program"),
+                      PythonHandler("tests::srv_register_cleanup"),
+                      PythonDebug("On"))
+
+        self.makeConfig(str(c))
+
+        self.startHttpd()
+
+        f = urllib.urlopen("http://127.0.0.1:%s/tests.py" % PORT)
+        f.read()
+        f.close()
+
+        self.stopHttpd()
+
+        # see what's in the log now
+        time.sleep(1)
+        f = open(os.path.join(SERVER_ROOT, "logs/error_log"))
+        log = f.read()
+        f.close()
+        if log.find("test ok") == -1:
+            self.fail("Could not find test message in error_log")

 def suite():

     mpTestSuite = unittest.TestSuite()
     mpTestSuite.addTest(PerInstanceTestCase("testLoadModule"))
     mpTestSuite.addTest(PerInstanceTestCase("testPerRequestTests"))
+    mpTestSuite.addTest(PerInstanceTestCase("test_srv_register_cleanup"))
     return mpTestSuite

 tr = unittest.TextTestRunner()
Index: test/htdocs/tests.py
===================================================================
RCS file: /home/cvs/httpd-python/test/htdocs/tests.py,v
retrieving revision 1.19
diff -u -r1.19 tests.py
--- test/htdocs/tests.py        29 Oct 2002 21:52:18 -0000      1.19
+++ test/htdocs/tests.py        2 Dec 2002 21:47:52 -0000
@@ -505,6 +505,14 @@

     data.log_error(data.cleanup_data)

+def srv_register_cleanup(req):
+
+    req.cleanup_data = "test ok"
+    req.server.register_cleanup(req, cleanup, req)
+    req.write("registered server cleanup that will write to log")
+
+    return apache.OK
+
 def util_fieldstorage(req):

     from mod_python import util


Grisha

On Mon, 2 Dec 2002, St?phane Bidoul wrote:

> Hi Grisha,
>
> I'm back using mod_python, on a real project this time.
> We've been using 3.0 beta for a few weeks and it works great!
>
> Now I'm trying to use mp_server.register_cleanup, and that fails
> with a "ValueError: first argument must be a Request object".
>
> My first diagnostic (unless I'm doing something silly)
> is that it's a remnant of mod_python 2.x,
> since the Request class seems to have disappeared
> from apache.py.
>
> Is that an easy fix for you?
> Or should I dig it a little bit more?
>
> -sbi
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From harrington_chad at hotmail.com  Mon Dec  2 17:22:23 2002
From: harrington_chad at hotmail.com (Chad Harrington)
Date: Fri Jan  9 21:47:09 2004
Subject: [mod_python] can't find mod_python.so
Message-ID: <F63lff3ECr3ni8hEUJ90001c3fa@hotmail.com>

An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20021202/685bb448/attachment.htm
From mkurjano at tjhsst.edu  Mon Dec  2 22:10:08 2002
From: mkurjano at tjhsst.edu (Matthew Kurjanowicz)
Date: Fri Jan  9 21:47:09 2004
Subject: [mod_python] Problems with mp tutorial
Message-ID: <Pine.LNX.4.44.0212022155500.15170-100000@phosphorus.tjhsst.edu>

Hi there,
First off, I'm new to the list, so if this question has been answered, I
am sorry.  I checked the archives and documentation but could not find
anything helpful in this case.

I am running a new, clean install of RH 8.0, with Apache 2.0.40 (rpm rev
8) and mod_python 3.0.0 (rpm rev 10).  I try the first part of the
tutorial (just hello world) and it works fine.  However, when I try to run
the authentication part of the tutorial, I get these errors (relevent part
of error_log listed below).  Apache is asking for the AuthUserFile of some
sort.  I've used Apache before, and know about basic authentication using
the files, but I'd love to be able to use python.  Any assistance is
appreciated.
Let me know if you need more info or any different files.
Thanks for your time,
Matt Kurjanowicz (mkurjano@tjhsst.edu)

[Sun Dec 01 23:53:28 2002] [notice] Digest: generating secret for digest
authentication ...
[Sun Dec 01 23:53:28 2002] [notice] Digest: done
[Sun Dec 01 23:53:29 2002] [notice] Apache/2.0.40 (Red Hat Linux)
configured -- resuming normal operations
[Sun Dec 01 23:53:40 2002] [crit] [client 127.0.0.1] configuration error:
couldn't check user.  No user file?: /python/authen.py, referer:
http://localhost/python/
[Sun Dec 01 23:53:57 2002] [crit] [client 127.0.0.1] configuration error:
couldn't check user.  No user file?: /python/a.py



From markusjais at yahoo.de  Tue Dec  3 09:29:26 2002
From: markusjais at yahoo.de (=?iso-8859-1?q?Markus=20Jais?=)
Date: Fri Jan  9 21:47:09 2004
Subject: [mod_python] beginners question -- LIST moderation?
In-Reply-To: <9297B926-063F-11D7-9E16-00039300D690@memora.com>
Message-ID: <20021203082926.42999.qmail@web12405.mail.yahoo.com>

 --- Antonio Rodriguez <antonio@memora.com> schrieb: >
in the src directory near the top of the make file
> there is a line:
> OPT=
> 
> and you want to make it:
> OPT=-DEAPI
> 

thank you very much!

> Sorry about the confusion.
> 
> One other important thing: is this list moderated or
> something? I 
> posted this to you over a week ago and I just
> received my own post. If 
> it is, I kind of wish it wasn't as it impedes the
> flow of 
> communications.

I hat the same problems. some postings needed several
days to arrive.

markus





__________________________________________________________________

Gesendet von Yahoo! Mail - http://mail.yahoo.de
Weihnachts-Eink?ufe ohne Stress! http://shopping.yahoo.de

From ray_drew at yahoo.co.uk  Tue Dec  3 11:18:49 2002
From: ray_drew at yahoo.co.uk (Ray Drew)
Date: Fri Jan  9 21:47:09 2004
Subject: [mod_python] 3.0.1 on Apache 2.0.43/Python 2.2.1 on Windows XP Prof.
Message-ID: <002901c29abd$c1ba1750$e4ae5651@RDREWXP>

I seem to have the same problem that others are having - I can't get this to
run.

Apache runs fine until I add...

    LoadModule python_module modules/mod_python.so to the modules section of
httpd.conf

... then Apache fails to start.

I have mod_python.so in the apache modules directory.

Under Apache 1.3x and mod_python 2.76 the apache module was a dll.

Does anyone have this combination working?

Thanks,

Ray





__________________________________________________
Do You Yahoo!?
Sign up for SBC Yahoo! Dial - First Month Free
http://sbc.yahoo.com

From neo at https.ru  Tue Dec  3 15:09:03 2002
From: neo at https.ru (Neo Eureka)
Date: Fri Jan  9 21:47:09 2004
Subject: [mod_python] mod_python on Windows
Message-ID: <1484824066.20021203150903@https.ru>

Hi !

  I have no cygwin installed but I had just the same problem with
mod_python 3 on WinNT. I posted this question a logn-long time ago.
There are about ten people who have reported the same issue since that
time...

>
> 
> Grisha,
> Unfortunately, I think it must be more involved than that...
> I have the identical problem, but I use python 2.2.1
> 
> I am running mod_python 3.0.1, Python 2.2.1, Apache 2.0.43, Windows
> 2000 Professional.  I also have cygwin installed, if that might make
> a difference.  It appears that the Mark (the original poster) also
> has cygwin.  I also played with the permissions and owners to no
> avail.  Are there any other things I should try?    
> Chad Harrington 
> harrington_chad@hotmail.com 

--- 
Neo Eureka / mailto:neo@https.ru


From heha at iki.fi  Tue Dec  3 16:13:00 2002
From: heha at iki.fi (Heikki Halonen)
Date: Fri Jan  9 21:47:09 2004
Subject: [mod_python] mod_python with 4Suite tools
Message-ID: <Pine.LNX.4.44.0212031452160.3043-100000@a204b.ud.ton.tut.fi>

Hi

I'm having hard time trying to make 4Suite tools co-operate with
mod_python (or vice versa). I'm using Python 2.2.2, Apache 2.0.43,
mod_python 3.0.1 and newest 4Suite development version. My system is
Debian unstable. python2.2-xml package is not installed.

The test program is in the end of this mail, the xml files used can be
found at http://www.heha.iki.fi/~heha/poll_dev/quiz2html.xsl and
http://www.heha.iki.fi/~heha/poll_dev/polls/quiz_1.xml. Test program works
perfectly when run from the command line. When requested by mod_python,
however, it 'obfuscates' the XML document. Characters used in marking
print out fine but everything else is some random binary data. I figured
out that it probably has something to do with encoding and added the
following lines to sitecustomize.py, as somebody advised in some distantly
similar problem:

u'hello'.encode( 'UTF-8' )
u'hello'.encode( 'iso8859-1' )

This did not help, whatsoever. I have no clue anymore where the problem
could be or how it could be corrected. Any suggestions? The same kind of
code works fine in mod_python 2.7.8 running in Apache 1.3.26 with Python
2.1 and 4Suite version 0.11.1.




#!/usr/bin/python2.2

import sys, os, string

from Ft.Lib import Uri
from Ft.Xml.Xslt import XmlWriter, Processor, OutputParameters
from Ft.Xml import Domlette, InputSource

def processXML():
    mypath = '/home/heha/public_html/poll_dev/'
    pollfile = mypath+'polls/quiz_1.xml'
    pollxsl = mypath+'quiz2html.xsl'

    debugfile = open( mypath+'poll.log', 'w' )
    processor = Processor.Processor()
    node = Domlette.NonvalidatingReader.parseUri( pollfile )
    Domlette.Print( node, debugfile, encoding='iso8859-1' )
    stylesheet = InputSource.DefaultFactory.fromUri( pollxsl )
    processor.appendStylesheet( stylesheet )

    processed_node = processor.runNode( node, Uri.OsPathToUri(
        pollfile, 1) )

    debugfile.write( processed_node )
    debugfile.close()

    return processed_node

    #print writer.getResult()

if __name__ == "__main__":
    print processXML()
else:
    from mod_python import apache

    def handler( req ):
        req.write( processXML() )
        return apache.OK



     Heikki Halonen # heha@iki.fi # iki.fi/heha # +358 40 828 9972
            "The easy way ain't hard enough and the hard way
                     is such a lonely lonely path"


From gdamjan at mail.net.mk  Tue Dec  3 16:12:44 2002
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 21:47:09 2004
Subject: [mod_python] bug/misfeature in publisher/mod_python
Message-ID: <20021203151244.GB16590@legolas.on.net.mk>

My setup:
 apache 2.0.43, mod_python 3.0.1, python 2.2.1

httpd.conf:
<Directory /home/www/htdocs> # The root of the web server
...
    SetHandler python-program
    PythonHandler mod_python.publisher | .py
    PythonDebug On
</Directory>
...

I expect this setup to handle all files ending in ".py" through
the publisher handler.

I have the script "hello.py" from the mod_python manual in the root of the
web-server. Trying to get "http://127.1/hello.py/say" mod_python
throws an exception (traceback atached).

The exception is: "ImportError: No module named py"

I've foloved the problem to the publisher handler, line 139. 
When publisher tries to strip the suffixes, it gets them by
calling "req.get_addhandler_exts()". Obviosly in my case this
call return None (I dont have the AddHandler directive). So
publsiher doesn't strip anything, thus trying to import the
module "py" (which is the extension of the script).

The solution for this problem would be for get_addhandler_exts()
alsa to return the extensions as specified in the 
"PythonHandler ... | .ext" directive.



-- 
Damjan Georgievski
-------------- next part --------------

Mod_python error: "PythonHandler mod_python.publisher"

Traceback (most recent call last):

  File "/usr/lib/python2.2/site-packages/mod_python/apache.py", line 335, in HandlerDispatch
    result = object(req)

  File "/usr/lib/python2.2/site-packages/mod_python/publisher.py", line 149, in handler
    module = apache.import_module(module_name, req.get_config(), [path])

  File "/usr/lib/python2.2/site-packages/mod_python/apache.py", line 499, in import_module
    f, p, d = imp.find_module(parts[i], path)

ImportError: No module named py
From duncan at rcp.co.uk  Tue Dec  3 15:58:39 2002
From: duncan at rcp.co.uk (Duncan Booth)
Date: Fri Jan  9 21:47:09 2004
Subject: [mod_python] mod_python 3.0.1 on Apache 2.0.43 solution
Message-ID: <3DECD4AF.28805.1664047@localhost>

It appears that the binaries for mod_python 3.0.1 have been built 
using Microsoft Visual Studio version 7. This means that 
mod_python.so has a dependency on the file msvcr70.dll, but the 
distribution doesn't include this file.

If you have the latest Microsoft compiler installed, or any other 
applications that use this DLL, then mod_python.so works fine. If not 
it fails horribly.

The workaround (at least on one machine that had this problem) is to 
copy msvcr70.dll into \winnt\system32. Get the file from anywhere 
that already has a copy (e.g. www.dll-files.com/dllindex/dll-
files.shtml?msvcr70). Fortunately this dll has no further 
dependencies.  

The long term solution would be to distribute mod_python as a .MSI 
file including dependencies, or even to build it with the same version 
of the C runtime library as used for the rest of Apache and Python.



From grisha at modpython.org  Tue Dec  3 11:00:17 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:47:09 2004
Subject: [mod_python] can't find mod_python.so
In-Reply-To: <F63lff3ECr3ni8hEUJ90001c3fa@hotmail.com>
Message-ID: <20021203105848.L19817-100000@eden.ispol.com>

I've recompiled mod_python.so and placed the new file out there. I tested
it and it works fine for me on Win2K, apache 2.0.43 and Python 2.2.1 (from
www.python.org). I think something went amuck with the original file.

Grisha

On Mon, 2 Dec 2002, Chad Harrington wrote:

>
>
>
> Grisha,
>
> Unfortunately, I think it must be more involved than that...
>
> I have the identical problem, but I use python 2.2.1
>
> I am running mod_python 3.0.1, Python 2.2.1, Apache 2.0.43, Windows 2000 Professional.  I also have cygwin installed, if that might make a difference.  It
> appears that the Mark (the original poster) also has cygwin.  I also played with the permissions and owners to no avail.  Are there any other things I should
> try?
>
> Chad Harrington
> harrington_chad@hotmail.com
> ----Original Message Follows----
> From: "Gregory (Grisha) Trubetskoy"
> To: Mark Messer
> CC: mod_python@modpython.org
> Subject: Re: [mod_python] can't find mod_python.so
> Date: Sat, 30 Nov 2002 23:06:10 -0500 (EST)
> This is possibly because the mod_python.so that is out there is for Python
> 2.2.1. I don't have one for 2.2.2 compiled (yet).
> Grisha
> On Sat, 30 Nov 2002, Mark Messer wrote:
> > I put mod_python.so into the modules directory, but I get an error when
> > starting Apache:
> >
> > C:\tools\Apache2\bin>apache
> > Syntax error on line 173 of C:/tools/Apache2/conf/httpd.conf:
> > Cannot load C:/tools/Apache2/modules/mod_python.so into server: The
> > specified module could not be found.
> >
> > I added this to the LoadModule section of httpd.conf: LoadModule
> > python_module modules/mod_python.so
> >
> > Here's the directory listing:
> > C:\tools\Apache2\modules>ls -al mod_p*
> > -rwxrwx--- 1 Administ SYSTEM 40960 Oct 3 06:58 mod_proxy.so
> > -rwxrwx--- 1 Administ SYSTEM 20480 Oct 3 06:58 mod_proxy_connect.so
> > -rwxrwx--- 1 Administ SYSTEM 28672 Oct 3 06:58 mod_proxy_ftp.so
> > -rwxrwx--- 1 Administ SYSTEM 24576 Oct 3 06:58 mod_proxy_http.so
> > -rwxrwx--- 1 Administ SYSTEM 65536 Nov 26 17:49 mod_python.so
> >
> > I am running mod_python 3.0.1, Python 2.2.2, Apache 2.0.43, Windows XP
> > Professional. Tried changing perms and ownership to match what was there,
> > but that did not work.
> >
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://www.modpython.org/mailman/listinfo/mod_python
> >
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>
> ____________________________________________________________________________________________________________________________________________________________________
> MSN 8 helps ELIMINATE E-MAIL VIRUSES. Get 2 months FREE*.
>


From harrington_chad at hotmail.com  Tue Dec  3 08:48:10 2002
From: harrington_chad at hotmail.com (Chad Harrington)
Date: Fri Jan  9 21:47:09 2004
Subject: [mod_python] can't find mod_python.so
Message-ID: <F153XRyOLjauzQmvaR300012ca1@hotmail.com>

An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20021203/8eb6acf8/attachment.htm
From gstein at lyra.org  Tue Dec  3 10:20:30 2002
From: gstein at lyra.org (Greg Stein)
Date: Fri Jan  9 21:47:09 2004
Subject: [mod_python] 3.0.1 on Apache 2.0.43/Python 2.2.1 on Windows XP Prof.
In-Reply-To: <002901c29abd$c1ba1750$e4ae5651@RDREWXP>; from ray_drew@yahoo.co.uk on Tue, Dec 03, 2002 at 11:18:49AM -0000
References: <002901c29abd$c1ba1750$e4ae5651@RDREWXP>
Message-ID: <20021203102030.D17655@lyra.org>

On Tue, Dec 03, 2002 at 11:18:49AM -0000, Ray Drew wrote:
>...
> I have mod_python.so in the apache modules directory.
> 
> Under Apache 1.3x and mod_python 2.76 the apache module was a dll.

FYI... it is still a DLL, just with a different extension.

Cheers,
-g

-- 
Greg Stein, http://www.lyra.org/

From webmaster at obramaestraonline.com  Tue Dec  3 16:39:22 2002
From: webmaster at obramaestraonline.com (Webmaster)
Date: Fri Jan  9 21:47:09 2004
Subject: [mod_python] mod_python on Win32 Apache 1.3.27
Message-ID: <000101c29b0c$115e9800$22383242@Family>

Is mod python compatible with Apache 1.3.27?

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20021203/a5ee485b/attachment.htm
From ray_drew at yahoo.co.uk  Tue Dec  3 23:44:24 2002
From: ray_drew at yahoo.co.uk (Ray Drew)
Date: Fri Jan  9 21:47:09 2004
Subject: [mod_python] mod_python os.environ bug?
Message-ID: <012e01c29b25$e9d99040$e4ae5651@RDREWXP>

Hi Grisha,

I'm using mod_python in conjunction with quixote
www.mems-exchange.org/software/quixote/

In moving from Apache 1.3.22/mp 2.78 to Apache 2.043/mp 3.01 I get a
TypeError on the quixote function environ.get(key, default). The default in
this function is None and this is what returns the Type Error. If I change
the default argument to an empty string everything works ok. It's been
suggested that there may be a bug in mod_python, see below:

-----------------------------------------------
On Tue, Dec 03, 2002 at 09:55:57PM -0000, Ray Drew wrote:
> Moving from...
>
> Apache 1.3.22 Python 2.2.1 mod_python 2.7.8 Quixote 0.5.1 Windows XP
>
> ...to...
>
> Apache 2.043 mod_python 3.0.1 rest as above.

>     return self.environ.get(key, default)
> TypeError: get() argument 2 must be string, not None

I would guess it is a mod_python bug.  I suppose it replaces os.environ
with an object that does incorrect type checking on the second argument
to get().
-----------------------------------------------

Would that be right?

Thanks,

Ray

__________________________________________________
Do you Yahoo!?
Yahoo! Mail Plus - Powerful. Affordable. Sign up now.
http://mailplus.yahoo.com

From ray_drew at yahoo.co.uk  Wed Dec  4 09:57:08 2002
From: ray_drew at yahoo.co.uk (Ray Drew)
Date: Fri Jan  9 21:47:09 2004
Subject: [mod_python] mod_python 3.0.1 on Apache 2.0.43 solution
References: <3DECD4AF.28805.1664047@localhost>
Message-ID: <002f01c29b7b$838d1860$e4ae5651@RDREWXP>

Duncan wrote:

#
The workaround (at least on one machine that had this problem) is to 
copy msvcr70.dll into \winnt\system32. Get the file from anywhere 
that already has a copy (e.g. www.dll-files.com/dllindex/dll-
files.shtml?msvcr70). 
#

Duncan,

THANKYOU THANKYOU THANKYOU

That worked for me on Windows XP professional.

Ray





__________________________________________________
Do you Yahoo!?
Yahoo! Mail Plus - Powerful. Affordable. Sign up now.
http://mailplus.yahoo.com

From scott at activestudios.com  Wed Dec  4 08:20:12 2002
From: scott at activestudios.com (Scott Russell)
Date: Fri Jan  9 21:47:09 2004
Subject: [mod_python] mod_xslt filtering of mod_python output
Message-ID: <1039008012.13748.35.camel@heckle.activestudios.com>

Hi. I'm a a beginner with mod_python, and I'm trying to use mod_python
and mod_xslt together.

mod_python gets called via a "SetHandler python-program", and inside
python I set the content-type to text/xml.

mod_xslt is called via "AddOutputFilterByType mod-xslt "text/xml")  

--- httpd.conf stanza: ---

<Location /the_dir>
    SetHandler python-program
    PythonPath "sys.path + ['/path/']"
    PythonHandler mymodule
    AddOutputFilterByType mod-xslt text/xml
</Location>
--- end ---

--- /path/mymodule.py excerpt ---

def handler(req):
        
  ... generate xml, place in out ...

  req.content_type = "text/xml"
  req.write(out)
  return apache.OK
--- end ---

Both work fine standalone - mod_xslt filters xml files, and mod_python
is generating dynamic content, but I don't know how to get mod_xslt to
filter dynamic content from mod_python...

What am I missing?  

Apache 2.0.40, mod_python 3.0.0, python 2.2.1 (all stock installs on on
RH 8) mod_xslt 1.0.5 (built locally)


From cameron at toolhouse.com  Wed Dec  4 13:46:48 2002
From: cameron at toolhouse.com (Cameron S. Watters)
Date: Fri Jan  9 21:47:09 2004
Subject: [mod_python] make problems
Message-ID: <E43EADFC-07D1-11D7-83C3-00306599D91A@toolhouse.com>

Hello all,

figured you could help.

I keep getting this message when I try to make mod_python 3.0.1

*** Warning: This library needs some functionality provided by 
-lpython2.2.
*** I have the capability to make that library automatically link in 
when
*** you link to this library.  But I can only do this if you have a
*** shared version of the library, which you do not appear to have.

*** Warning: libtool could not satisfy all declared inter-library
*** dependencies of module mod_python.  Therefore, libtool will create
*** a static module, that should work as long as the dlopening
*** application is linked with the -dlopen flag.

I installed apache 2.0.43 and python 2.2.2 from source on FreeBSD. I'm 
explicitly passing --with-python and --with-apxs to the configure 
script.

Any help would be appreciated.

--cameron


From grisha at modpython.org  Wed Dec  4 17:37:20 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:47:09 2004
Subject: [mod_python] make problems
In-Reply-To: <E43EADFC-07D1-11D7-83C3-00306599D91A@toolhouse.com>
Message-ID: <20021204172744.D39475-100000@eden.ispol.com>

You don't mention your FreeBSD version, it's possible that you have a
really old libtool. Also make sure that Apache is compiled with
--enable-threads. See the FreeBSD section in mod_python README.

Grisha

On Wed, 4 Dec 2002, Cameron S. Watters wrote:

> Hello all,
>
> figured you could help.
>
> I keep getting this message when I try to make mod_python 3.0.1
>
> *** Warning: This library needs some functionality provided by
> -lpython2.2.
> *** I have the capability to make that library automatically link in
> when
> *** you link to this library.  But I can only do this if you have a
> *** shared version of the library, which you do not appear to have.
>
> *** Warning: libtool could not satisfy all declared inter-library
> *** dependencies of module mod_python.  Therefore, libtool will create
> *** a static module, that should work as long as the dlopening
> *** application is linked with the -dlopen flag.
>
> I installed apache 2.0.43 and python 2.2.2 from source on FreeBSD. I'm
> explicitly passing --with-python and --with-apxs to the configure
> script.
>
> Any help would be appreciated.
>
> --cameron
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From webmaster at obramaestraonline.com  Wed Dec  4 19:09:11 2002
From: webmaster at obramaestraonline.com (Rafael Fernandez)
Date: Fri Jan  9 21:47:09 2004
Subject: [mod_python] Mod_python on Win32; Apache 1.3.27
Message-ID: <000001c29bea$2b711900$b0383242@Family>

Is mod_python compatible with Apache 1.3.27 on Win32?

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20021204/b891a606/attachment.htm
From gdamjan at mail.net.mk  Thu Dec  5 00:18:15 2002
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 21:47:09 2004
Subject: [mod_python] make problems
In-Reply-To: <20021204172744.D39475-100000@eden.ispol.com>
References: <E43EADFC-07D1-11D7-83C3-00306599D91A@toolhouse.com> <20021204172744.D39475-100000@eden.ispol.com>
Message-ID: <20021204231815.GA15577@legolas.on.net.mk>

> 
> You don't mention your FreeBSD version, it's possible that you have a
> really old libtool. Also make sure that Apache is compiled with
> --enable-threads. See the FreeBSD section in mod_python README.
> 
> > *** Warning: This library needs some functionality provided by
> > -lpython2.2.
> > *** I have the capability to make that library automatically link in
> > when


This same thing happend on my slackware 8.1 box,
libtool = ltmain.sh (GNU libtool) 1.4.2 (1.922.2.53 2001/09/11 03:18:52)

I solved it by making a /usr/lib/libpython.2.2.so shared library.
The procedure is (if I remember good): 
  mkdir /tmp/libpython;  cd /tmp/libpython
  ar x /usr/lib/python2.2/config/libpython2.2.a
  ld -shared -export-dynamic *.o -ldl -lpthread -lutil -lm -lc\
	-o /usr/lib/libpython2.2.so
  



-- 
Damjan Georgievski

From cameron at toolhouse.com  Wed Dec  4 16:16:46 2002
From: cameron at toolhouse.com (Cameron S. Watters)
Date: Fri Jan  9 21:47:09 2004
Subject: [mod_python] make problems
In-Reply-To: <20021204172744.D39475-100000@eden.ispol.com>
Message-ID: <D748DF36-07E6-11D7-83C3-00306599D91A@toolhouse.com>

> You don't mention your FreeBSD version, it's possible that you have a
> really old libtool. Also make sure that Apache is compiled with
> --enable-threads. See the FreeBSD section in mod_python README.

FreeBSD 4.7-RELEASE
libtool 1.3.4 (installed from ports)

Thanks for the pointer to the FreeBSD note in the readme, I had missed 
it, BUT....

I still get the same message after recompiling apache with the 
--enable-threads flag set. I think it has more to do with the fact that 
there isn't a libpython2.2.so built (as mentioned by 
gdamjan@mail.net.mk).

I would suggest adding that either to the docs on the website (and to 
the README of future releases). The standard python built from source 
doesn't appear to do it for you and according to the python FAQ, item 
3.30, Why is the Python interpreter not built as a shared library?, it 
won't until v2.3. If this IS required by mod_python, it should be at 
least given a mention, and optimally, there would be instructions about 
how to create it.

> Grisha
>
> On Wed, 4 Dec 2002, Cameron S. Watters wrote:
>
>> Hello all,
>>
>> figured you could help.
>>
>> I keep getting this message when I try to make mod_python 3.0.1
>>
>> *** Warning: This library needs some functionality provided by
>> -lpython2.2.
>> *** I have the capability to make that library automatically link in
>> when
>> *** you link to this library.  But I can only do this if you have a
>> *** shared version of the library, which you do not appear to have.
>>
>> *** Warning: libtool could not satisfy all declared inter-library
>> *** dependencies of module mod_python.  Therefore, libtool will create
>> *** a static module, that should work as long as the dlopening
>> *** application is linked with the -dlopen flag.
>>
>> I installed apache 2.0.43 and python 2.2.2 from source on FreeBSD. I'm
>> explicitly passing --with-python and --with-apxs to the configure
>> script.
>>
>> Any help would be appreciated.
>>
>> --cameron
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://www.modpython.org/mailman/listinfo/mod_python
>>
>
>


From grisha at modpython.org  Wed Dec  4 19:34:39 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:47:09 2004
Subject: [mod_python] make problems
In-Reply-To: <D748DF36-07E6-11D7-83C3-00306599D91A@toolhouse.com>
Message-ID: <20021204192952.W41195-100000@eden.ispol.com>

No, shared lib is not required. I have Python 2.2.1 and apache 2.0.43
installed from ports on a FreeBSD 4.7-RELEASE-p1 box and mod_python
compiles just fine. There is no libpython2.2.so.

If your apache installation is not from ports, then another thing you
might try is to rebuild apache after running ./buildconf (then
./configure), then make. Apxs uses the libtool script that is packaged
with apache, and it in turn is created by ./buildconf, so it may have
something to do with that.

Grisha

On Wed, 4 Dec 2002, Cameron S. Watters wrote:

> > You don't mention your FreeBSD version, it's possible that you have a
> > really old libtool. Also make sure that Apache is compiled with
> > --enable-threads. See the FreeBSD section in mod_python README.
>
> FreeBSD 4.7-RELEASE
> libtool 1.3.4 (installed from ports)
>
> Thanks for the pointer to the FreeBSD note in the readme, I had missed
> it, BUT....
>
> I still get the same message after recompiling apache with the
> --enable-threads flag set. I think it has more to do with the fact that
> there isn't a libpython2.2.so built (as mentioned by
> gdamjan@mail.net.mk).
>
> I would suggest adding that either to the docs on the website (and to
> the README of future releases). The standard python built from source
> doesn't appear to do it for you and according to the python FAQ, item
> 3.30, Why is the Python interpreter not built as a shared library?, it
> won't until v2.3. If this IS required by mod_python, it should be at
> least given a mention, and optimally, there would be instructions about
> how to create it.
>
> > Grisha
> >
> > On Wed, 4 Dec 2002, Cameron S. Watters wrote:
> >
> >> Hello all,
> >>
> >> figured you could help.
> >>
> >> I keep getting this message when I try to make mod_python 3.0.1
> >>
> >> *** Warning: This library needs some functionality provided by
> >> -lpython2.2.
> >> *** I have the capability to make that library automatically link in
> >> when
> >> *** you link to this library.  But I can only do this if you have a
> >> *** shared version of the library, which you do not appear to have.
> >>
> >> *** Warning: libtool could not satisfy all declared inter-library
> >> *** dependencies of module mod_python.  Therefore, libtool will create
> >> *** a static module, that should work as long as the dlopening
> >> *** application is linked with the -dlopen flag.
> >>
> >> I installed apache 2.0.43 and python 2.2.2 from source on FreeBSD. I'm
> >> explicitly passing --with-python and --with-apxs to the configure
> >> script.
> >>
> >> Any help would be appreciated.
> >>
> >> --cameron
> >>
> >> _______________________________________________
> >> Mod_python mailing list
> >> Mod_python@modpython.org
> >> http://www.modpython.org/mailman/listinfo/mod_python
> >>
> >
> >
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From cameron at toolhouse.com  Wed Dec  4 17:43:16 2002
From: cameron at toolhouse.com (Cameron S. Watters)
Date: Fri Jan  9 21:47:09 2004
Subject: [mod_python] make problems
In-Reply-To: <20021204192952.W41195-100000@eden.ispol.com>
Message-ID: <EC6ED012-07F2-11D7-83C3-00306599D91A@toolhouse.com>

> No, shared lib is not required. I have Python 2.2.1 and apache 2.0.43
> installed from ports on a FreeBSD 4.7-RELEASE-p1 box and mod_python
> compiles just fine. There is no libpython2.2.so.
>
> If your apache installation is not from ports, then another thing you
> might try is to rebuild apache after running ./buildconf (then
> ./configure), then make. Apxs uses the libtool script that is packaged
> with apache, and it in turn is created by ./buildconf, so it may have
> something to do with that.

That worked.

./buildconf
./configure --a mass of configure options
make
make install

I will say that building libpython2.2.so also makes the error messages 
go away (not that that makes it the correct solution). Anybody want to 
comment on what difference it actually makes?

Thanks for your help.

--cameron


From nathanr at nathanr.net  Thu Dec  5 14:54:29 2002
From: nathanr at nathanr.net (Nathan Robertson)
Date: Fri Jan  9 21:47:09 2004
Subject: [mod_python] Embedded python support
Message-ID: <1039060470.334.8.camel@moosehead>

Hi,

Before mod_snake was killed, I quite liked its embedded python support.
As mod_snake is now dead, I've ported their epy modules to mod_python
and made them available. For those of you who aren't familiar with the
epy feature, it allows you to embed fragments of python into html code,
in the same way VBScript and JScript can be done in ASP, Java in JSP,
PHP in PHP (??), etc.

From jirka.machotka at seznam.cz  Thu Dec  5 12:18:05 2002
From: jirka.machotka at seznam.cz (=?iso-8859-2?Q?Jirka=20Machotka?=)
Date: Fri Jan  9 21:47:09 2004
Subject: [mod_python] =?iso-8859-2?Q?Problems=20with=20mptest=2Epy=20=28Windows=29?=
Message-ID: <3939.5433-10072-616945501-1039087085@seznam.cz>

Hello there,

I have probably a very basic question. However, I could not find
anything relevant (a searching machine would be fine)

I had had problems with running the mod_python for Apache 2.0.43.
Following the advice I had gotten the msvcr70.dll, put it to the
required directory and restarted the Apache. The Apache starts,
however, when I try to fetch mptest.py (it looks exactly as described
in the manual, the configuration file httpd has been modified
accordingly) I receive an error:

make_obcallback: could not import mod_python.apache

To my understanding the problem relates rather to Python (my version
is 2.2.1). The manual mentions that Python environment must be
recompiled, or what. I'm afraid that's not possible for me
(recompiled in what?) Or am I missing something inportant?


Please help. Thanks in advance.

Jiri

______________________________________________________________________
Reklama:
Sout?? o auto na v?kend, autor?dio Clarion a dal?? ceny: http://ad2.seznam.cz/redir.cgi?instance=12345%26url=http://www.auto-plus.cz
 - nejlep?? syst?m prodeje ojet?ch voz? na internetu


From gdamjan at mail.net.mk  Thu Dec  5 19:40:15 2002
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 21:47:09 2004
Subject: [mod_python] make problems
In-Reply-To: <EC6ED012-07F2-11D7-83C3-00306599D91A@toolhouse.com>
References: <20021204192952.W41195-100000@eden.ispol.com> <EC6ED012-07F2-11D7-83C3-00306599D91A@toolhouse.com>
Message-ID: <20021205184015.GA676@legolas.on.net.mk>

> 
> I will say that building libpython2.2.so also makes the error messages 
> go away (not that that makes it the correct solution). Anybody want to 
> comment on what difference it actually makes?

the presence of libpython2.2.so only allows the build proces to
continue, I can confirm that mod_python is STATICALLY linked with
libpython anyway. This seems like a problem with the build
enviroment, but I don't have enough knowledge to investigate it
any further.







-- 
Damjan Georgievski

From webmaster at obramaestraonline.com  Thu Dec  5 15:37:44 2002
From: webmaster at obramaestraonline.com (Rafael Fernandez)
Date: Fri Jan  9 21:47:09 2004
Subject: [mod_python] Apache1.3.27 with mod_python on Win 32?
Message-ID: <002001c29c95$d1db8540$f7383242@Family>

Is Apache 1.3.27 compatible with mod_python?

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20021205/982faa8f/attachment.htm
From jirka.machotka at seznam.cz  Fri Dec  6 15:55:45 2002
From: jirka.machotka at seznam.cz (=?iso-8859-2?Q?Jirka=20Machotka?=)
Date: Fri Jan  9 21:47:09 2004
Subject: [mod_python] =?iso-8859-2?Q?Re=3A=20R=3A=20=5Bmod=5Fpython=5D=20Problems=20with=20mptest=2Epy=20=28Windows=29?=
In-Reply-To: <52DC70C1C1575C418CB033523A29CF140E0570@exchange2000.manord.com>
Message-ID: <2088.9028-27840-818706865-1039186545@seznam.cz>

Signore,

no comprendo italiano. 

The transaltion I got by AltaVista Babelfish:
and approximately the problem that it gave you? 

The problem is that I don't know what to do. It is obvious that there
is a problem to connect Apache with Python interpret or vice versa.
The question is whether the interpret is called at all (I guess it
is). If so, it seems it is not able to see imported objects enabling
passing the data from/to the Apache. In the manual there is no hint
how to proceed in this case even though I'm sure that everyone has to
go through this problem anyhow.


Dne 5.?prosinec?2002, Manera, Villiam, <vmanera@manord.com> napsal:

> e circa il problema che dava a te?
> 
> -----Messaggio originale-----
> Da: Jirka Machotka [mailto:jirka.machotka@seznam.cz]
> Inviato: giovedi 5 dicembre 2002 12.18
> A: mod_python@modpython.org
> Oggetto: [mod_python] Problems with mptest.py (Windows)
> 

______________________________________________________________________
Reklama:
Nokia 3410 za 4.577 Kc. Nejvyhodnejsi nabidka telefonu na trhu!
http://ad2.seznam.cz/redir.cgi?instance=38871%26url=http://www.oskarmobil.cz/handsets/handset.php


From mcassiano at manord.com  Fri Dec  6 18:19:09 2002
From: mcassiano at manord.com (Cassiano, Marco)
Date: Fri Jan  9 21:47:09 2004
Subject: [mod_python] Win32 : Can't locate API module structure `mod_python'
Message-ID: <52DC70C1C1575C418CB033523A29CF140B8D9B@exchange2000.manord.com>

Hello,

I'm using 
- Windows 2000 Server,
- Apache 2.0.43
- Active State active python 2.2.2
- mod_python 3.0.1 (I should put the mod_python-3.0.1\lib\python\mod_python
folder from the distribution into the c:\Python22\lib folder, right?)
- mod_python.so for activestate into the Apache modules folder. 
- I have also the msvcr70.dll into \winnt\system32.

When I try to start Apache it fails and I get the following error in the
registry : 

"Can't locate API module structure `mod_python' in file C:/Program
Files/Apache Group/Apache2/modules/mod_python.so: No error "

I read on the list that many of you, after the "msvcr70.dll" hint, succeeded
in making mod_python work.
What am I missing ?
Thank you!

> Marco Cassiano
> Resp. Reti e Sistemi
> 
> Manifatture del Nord srl
> viale Regina Elena 13-15
> 42100 Reggio Emilia RE
> ITALY
> 
> Tel. +39 0522 508206
> Fax +39 0522 514001
> email : mcassiano@manord.com
> www.pennyblack.com
> 
> 

From marius at netroedge.com  Fri Dec  6 11:21:22 2002
From: marius at netroedge.com (Marius Nita)
Date: Fri Jan  9 21:47:10 2004
Subject: [mod_python] dev list
Message-ID: <20021206192122.GC8713@netroedge.com>

hello,

i'm having trouble subscribing to the dev list, it seems. i never got
a confirmation message, nor any messages...

just wondering if anyone else has had problems with it.

marius

From jgarzon at indra.es  Mon Dec  9 10:46:42 2002
From: jgarzon at indra.es (Garzon Maldonado, Jesus Javier)
Date: Fri Jan  9 21:47:10 2004
Subject: [mod_python] Problem with --enable-threads
Message-ID: <C6A2439F4F6BE04CAF457A5E24A376FA3634D2@madtormail2.indra.es>

Hello all:

I'm trying to configure Apache 2.0.43+mod_ssl+mod_rewrite+php4.2.3+mod_python-3.0 beta4 on a FreeBSD 4.7 machine.
According to what is said in the documentation, mod_python needs apache configured with --enable-threads, so this is what I typed to configure the source code.
./configure --prefix=/usr/local/apache2 --enable-so --enable-ssl --enable-rewrite --enable-threads

This works and I can compile and install apache, but I cannot start it. When I type ./apachectl startssl (or just start) only one process is launched:
root   23785  0.0  0.9  7064 4836  ??  Is    3:19PM   0:00.01 /usr/local/apache2/bin/httpd -k start -DSSL

But this process doesn't work, (doesn't serve html pages), and cannot be killed with ./apachectl stop

However if I do:
./configure --prefix=/usr/local/apache2 --enable-so --enable-ssl --enable-rewrite

all works fine (though I cannot use mod_python).

What am I doing wrong?

Thanks.

Javi Garzon


From zoper at libero.it  Tue Dec 10 08:54:42 2002
From: zoper at libero.it (Zoper)
Date: Fri Jan  9 21:47:10 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
Message-ID: <002001c2a021$66b50720$1c291a97@sorpippo>

Hi All!

After making my mod_python I try to make install but...

...............CUT....................
Performing DSO installation.

/usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
/usr/bin/install: src/mod_python.so: No such file or directory
make[1]: *** [install_dso] Error 1
make[1]: Leaving directory `/usr/src/mod_python-3.0.1'
make: *** [install] Error 2
..........................................

What does it mean?

Regards.

Gius.


From nathanr at nathanr.net  Tue Dec 10 19:03:09 2002
From: nathanr at nathanr.net (Nathan Robertson)
Date: Fri Jan  9 21:47:10 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
In-Reply-To: <002001c2a021$66b50720$1c291a97@sorpippo>
References: <002001c2a021$66b50720$1c291a97@sorpippo>
Message-ID: <1039507390.8428.0.camel@moosehead>

On Tue, 2002-12-10 at 18:54, Zoper wrote:
> Hi All!
> 
> After making my mod_python I try to make install but...
> 
> ...............CUT....................
> Performing DSO installation.
> 
> /usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
> /usr/bin/install: src/mod_python.so: No such file or directory
> make[1]: *** [install_dso] Error 1
> make[1]: Leaving directory `/usr/src/mod_python-3.0.1'
> make: *** [install] Error 2
> ..........................................

I saw this today. Are you running RedHat 8.0?

Nathan.



From zoper at libero.it  Tue Dec 10 12:54:31 2002
From: zoper at libero.it (Zoper)
Date: Fri Jan  9 21:47:10 2004
Subject: [mod_python] mod_python 3.0.1: error after make install ---> Debian
References: <002001c2a021$66b50720$1c291a97@sorpippo> <1039507390.8428.0.camel@moosehead>
Message-ID: <001501c2a042$e99c1040$2c281a97@sorpippo>

----- Original Message -----
From: "Nathan Robertson" <nathanr@nathanr.net>
To: "Zoper" <zoper@libero.it>
Cc: "modpython" <mod_python@modpython.org>
Sent: Tuesday, December 10, 2002 9:03 AM
Subject: Re: [mod_python] mod_python 3.0.1: error after make install



> I saw this today. Are you running RedHat 8.0?

I'm running Debian 2.2 r5.
Have you any idea about this ugly message?
                /usr/bin/install: src/mod_python.so: No such file or
directory

Thanks a lot.

Giuseppe.


From i at mindlace.net  Tue Dec 10 08:59:06 2002
From: i at mindlace.net (emf)
Date: Fri Jan  9 21:47:10 2004
Subject: [mod_python] mod_python 3.0.1: error after make install --->
 Debian
In-Reply-To: <001501c2a042$e99c1040$2c281a97@sorpippo>
References: <002001c2a021$66b50720$1c291a97@sorpippo> <1039507390.8428.0.camel@moosehead> <001501c2a042$e99c1040$2c281a97@sorpippo>
Message-ID: <3DF5F32A.60005@mindlace.net>

Zoper wrote:

> I'm running Debian 2.2 r5.

You know, if you upgrade to a mixed testing/unstable distribution you 
can just

apt-get -t unstable install mod_python

(assuming you've already

apt-get -t unstable install apache2

)

See section 3.8 for more info:

http://www.debian.org/doc/manuals/apt-howto/ch-apt-get.en.html

~mindlace


From jayaare at earthlink.net  Tue Dec 10 10:56:03 2002
From: jayaare at earthlink.net (john riehl aka j.r.)
Date: Fri Jan  9 21:47:10 2004
Subject: [mod_python] [Fwd: suse 8.0 obcallback problem.]
Message-ID: <3DF638C3.6090508@earthlink.net>


-------- Original Message --------
Subject: suse 8.0 obcallback problem.
Date: Sun, 08 Dec 2002 21:45:51 -0800
From: john riehl aka j.r. <jayaare@earthlink.net>
To: mod_python@modpython.org

This is an informational item.  I want others to avoid the pain I had.
I was about to ask the list for help, when I solved the problem.

The system:  suse 8.0, patched, on intel xeon 2.0 ghz system
(hyperthreading).  apache 1.3.23-142, python-2.2-105,
mod_python-2.7.8-6, mod_ssl-2.8.7-110

The problem:
calling the hello world test script mptest returns an internal error 500
code, with the following messages:
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
[Sun Dec  8 20:57:06 2002] [error] [client 66.215.65.63] python_handler:
make_obcallback returned no obCallBack!

I tried all sorts of stuff, based on complaints/suggestions in web logs,
which made no effect (checking permissions, links from apache to
mod_python, setting PythonPath, PythonInterpreter, setting .htaccess).

The problem was a missing link, from the python libraries to the
mod_python libraries.  with the suse configuration, that means that
/usr/lib/python2.2/site-packages/mod_python should be a symbolic link
pointing to /usr/lib/apache/lib/python2.2/site-packages/mod_python.
To correct, go to /usr/lib/python2.2/site-packages/, and link it thusly:
ln -s /usr/lib/apache/lib/python2.2/site-packages/mod_python/ mod_python

none of the problems/solutions that I reviewed addressed this facet.

Hope it helps,

jr







From conrad at hep.caltech.edu  Tue Dec 10 11:19:16 2002
From: conrad at hep.caltech.edu (Conrad Steenberg)
Date: Fri Jan  9 21:47:10 2004
Subject: [mod_python] [Fwd: suse 8.0 obcallback problem.]
In-Reply-To: <3DF638C3.6090508@earthlink.net>
References: <3DF638C3.6090508@earthlink.net>
Message-ID: <1039547956.312.42.camel@heppc22.hep.caltech.edu>

Hi

Just to add to this: one way to diagnose module/library load problems
with mod_python in general is to strace a single-process apache server
e.g.:

strace /usr/sbin/httpd -X 2> error_log

You will see all the paths that apache/python tries to look for modules.

Cheers

COnrad

On Tue, 2002-12-10 at 10:56, john riehl aka j.r. wrote:
> -------- Original Message --------
> Subject: suse 8.0 obcallback problem.
> Date: Sun, 08 Dec 2002 21:45:51 -0800
> From: john riehl aka j.r. <jayaare@earthlink.net>
> To: mod_python@modpython.org
> 
> This is an informational item.  I want others to avoid the pain I had.
> I was about to ask the list for help, when I solved the problem.
> 
> The system:  suse 8.0, patched, on intel xeon 2.0 ghz system
> (hyperthreading).  apache 1.3.23-142, python-2.2-105,
> mod_python-2.7.8-6, mod_ssl-2.8.7-110
> 
> The problem:
> calling the hello world test script mptest returns an internal error 500
> code, with the following messages:
> make_obcallback(): could not import mod_python.apache.
> make_obcallback(): could not call init.
> [Sun Dec  8 20:57:06 2002] [error] [client 66.215.65.63] python_handler:
> make_obcallback returned no obCallBack!
> 
> I tried all sorts of stuff, based on complaints/suggestions in web logs,
> which made no effect (checking permissions, links from apache to
> mod_python, setting PythonPath, PythonInterpreter, setting .htaccess).
> 
> The problem was a missing link, from the python libraries to the
> mod_python libraries.  with the suse configuration, that means that
> /usr/lib/python2.2/site-packages/mod_python should be a symbolic link
> pointing to /usr/lib/apache/lib/python2.2/site-packages/mod_python.
> To correct, go to /usr/lib/python2.2/site-packages/, and link it thusly:
> ln -s /usr/lib/apache/lib/python2.2/site-packages/mod_python/ mod_python
> 
> none of the problems/solutions that I reviewed addressed this facet.
> 
> Hope it helps,
> 
> jr
> 
> 
> 
> 
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
-- 
Conrad Steenberg <conrad@hep.caltech.edu>


From vmanera at manord.com  Thu Dec 12 17:47:45 2002
From: vmanera at manord.com (Manera, Villiam)
Date: Fri Jan  9 21:47:10 2004
Subject: [mod_python] problem with file download in mod-python 3.0.1
Message-ID: <52DC70C1C1575C418CB033523A29CF14104883@exchange2000.manord.com>

I'm testing mod-python 3.0.1 with apache 2.0.43 and python 2.2.2

I've founded a older problem in file download (from python 2.1 to 2.2)

the workaround is still the same:

in publisher.py:

 class File:
     """ Like a file, but also has headers and filename
     """
     def __init__(self, field):
         # steal all the file-like methods
         for m in dir(field.file):            
		 self.__dict__[m] = getattr(field.file, m)
 
         self.headers = field.headers
         self.filename = field.filename
======================workaround
==============================================
 class File:
     """ Like a file, but also has headers and filename
     """
     def __init__(self, field):
         # steal all the file-like methods
         #for m in dir(field.file):    #dont' work
         for m in self.sim_methods(field.file):
             self.__dict__[m] = getattr(field.file, m)
 
         self.headers = field.headers
         self.filename = field.filename
    
	#new--------	
     def sim_methods(self,obj):
         from types import BuiltinMethodType   
         return filter(lambda s, t=obj:
            type(getattr(t, s)) == BuiltinMethodType, dir(obj))
 
 
I hope it will be put in place

regards

Villiam Manera

From brianh at exelixis.com  Thu Dec 12 11:26:42 2002
From: brianh at exelixis.com (Brian Hawthorne)
Date: Fri Jan  9 21:47:10 2004
Subject: [mod_python] problem with file download in mod-python 3.0.1
In-Reply-To: <52DC70C1C1575C418CB033523A29CF14104883@exchange2000.manord.com>
Message-ID: <Pine.GSO.4.05.10212121123570.4656-100000@timeless.exelixis.com>

i'm not sure what the point is of wrapping the field object like this.
why not just use the field object itself as the value for the file upload
arg?  i cut this part out of my publisher because it seemed unnecessary.

brian hawthorne


On Thu, 12 Dec 2002, Manera, Villiam wrote:

> I'm testing mod-python 3.0.1 with apache 2.0.43 and python 2.2.2
> 
> I've founded a older problem in file download (from python 2.1 to 2.2)
> 
> the workaround is still the same:
> 
> in publisher.py:
> 
>  class File:
>      """ Like a file, but also has headers and filename
>      """
>      def __init__(self, field):
>          # steal all the file-like methods
>          for m in dir(field.file):            
> 		 self.__dict__[m] = getattr(field.file, m)
>  
>          self.headers = field.headers
>          self.filename = field.filename
> ======================workaround
> ==============================================
>  class File:
>      """ Like a file, but also has headers and filename
>      """
>      def __init__(self, field):
>          # steal all the file-like methods
>          #for m in dir(field.file):    #dont' work
>          for m in self.sim_methods(field.file):
>              self.__dict__[m] = getattr(field.file, m)
>  
>          self.headers = field.headers
>          self.filename = field.filename
>     
> 	#new--------	
>      def sim_methods(self,obj):
>          from types import BuiltinMethodType   
>          return filter(lambda s, t=obj:
>             type(getattr(t, s)) == BuiltinMethodType, dir(obj))
>  
>  
> I hope it will be put in place
> 
> regards
> 
> Villiam Manera
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From listmail at xs4all.nl  Thu Dec 12 22:30:15 2002
From: listmail at xs4all.nl (bvr)
Date: Fri Jan  9 21:47:10 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
In-Reply-To: <002001c2a021$66b50720$1c291a97@sorpippo>
References: <002001c2a021$66b50720$1c291a97@sorpippo>
Message-ID: <3DF8FFE7.7070100@xs4all.nl>

Hi,

Same problem here, tried several installations with RH 7.3.

tried installing these:
python2-2.2-16.i386.rpm
python2-devel-2.2-16.i386.rpm
python2-docs-2.2-16.i386.rpm

and:
untar Python-2.2.2.tgz
configure --without-threads
make && make install

both with no errors, cli interpreter works fine

compiled mod python 3.0.1 like this:

configure --with-apxs=/usr/local/apache2/bin/apxs 
--with-python=/usr/local/bin/python2
make

everything looks fine untill I get these warnings at the end:

/usr/local/apache/build/libtool --silent --mode=link gcc -o 
mod_python.la -I/store/install/mod_python-3.0.1/src/include 
-I/usr/local/apache/include -I/usr/local/include/python2.2  -rpath 
/usr/local/apache/modules -module -avoid-version  hlistobject.lo 
hlist.lo filterobject.lo connobject.lo serverobject.lo util.lo 
tableobject.lo requestobject.lo _apachemodule.lo mod_python.lo 
-L/usr/local/lib/python2.2/config -Xlinker -export-dynamic -lm 
-lpython2.2 -ldl -lutil -lm

*** Warning: This library needs some functionality provided by -lpython2.2.
*** I have the capability to make that library automatically link in when
*** you link to this library.  But I can only do this if you have a
*** shared version of the library, which you do not appear to have.

*** Warning: libtool could not satisfy all declared inter-library
*** dependencies of module mod_python.  Therefore, libtool will create
*** a static module, that should work as long as the dlopening
*** application is linked with the -dlopen flag.

afterwards it appears src/mod_python.so has not been created.

my best guess is that i need a libpython2.2.so but i can't figure how
to get it ??


please help!

bvr.


Zoper wrote:
> Hi All!
> 
> After making my mod_python I try to make install but...
> 
> ...............CUT....................
> Performing DSO installation.
> 
> /usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
> /usr/bin/install: src/mod_python.so: No such file or directory
> make[1]: *** [install_dso] Error 1
> make[1]: Leaving directory `/usr/src/mod_python-3.0.1'
> make: *** [install] Error 2
> ..........................................


From grisha at modpython.org  Thu Dec 12 21:13:22 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:47:10 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
In-Reply-To: <3DF8FFE7.7070100@xs4all.nl>
Message-ID: <20021212211044.R53709-100000@eden.ispol.com>

You don't need without-threads when compiling python. I don't know if its
the cause of the problem, but it's a start. Also, make sure you have
libtool 1.4.x. Lastly, if you compiled your own apache, try recompiling it
by first running ./buildconf, then ./configure, etc.

On Thu, 12 Dec 2002, bvr wrote:

>
> Hi,
>
> Same problem here, tried several installations with RH 7.3.
>
> tried installing these:
> python2-2.2-16.i386.rpm
> python2-devel-2.2-16.i386.rpm
> python2-docs-2.2-16.i386.rpm
>
> and:
> untar Python-2.2.2.tgz
> configure --without-threads
> make && make install
>
> both with no errors, cli interpreter works fine
>
> compiled mod python 3.0.1 like this:
>
> configure --with-apxs=/usr/local/apache2/bin/apxs
> --with-python=/usr/local/bin/python2
> make
>
> everything looks fine untill I get these warnings at the end:
>
> /usr/local/apache/build/libtool --silent --mode=link gcc -o
> mod_python.la -I/store/install/mod_python-3.0.1/src/include
> -I/usr/local/apache/include -I/usr/local/include/python2.2  -rpath
> /usr/local/apache/modules -module -avoid-version  hlistobject.lo
> hlist.lo filterobject.lo connobject.lo serverobject.lo util.lo
> tableobject.lo requestobject.lo _apachemodule.lo mod_python.lo
> -L/usr/local/lib/python2.2/config -Xlinker -export-dynamic -lm
> -lpython2.2 -ldl -lutil -lm
>
> *** Warning: This library needs some functionality provided by -lpython2.2.
> *** I have the capability to make that library automatically link in when
> *** you link to this library.  But I can only do this if you have a
> *** shared version of the library, which you do not appear to have.
>
> *** Warning: libtool could not satisfy all declared inter-library
> *** dependencies of module mod_python.  Therefore, libtool will create
> *** a static module, that should work as long as the dlopening
> *** application is linked with the -dlopen flag.
>
> afterwards it appears src/mod_python.so has not been created.
>
> my best guess is that i need a libpython2.2.so but i can't figure how
> to get it ??
>
>
> please help!
>
> bvr.
>
>
> Zoper wrote:
> > Hi All!
> >
> > After making my mod_python I try to make install but...
> >
> > ...............CUT....................
> > Performing DSO installation.
> >
> > /usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
> > /usr/bin/install: src/mod_python.so: No such file or directory
> > make[1]: *** [install_dso] Error 1
> > make[1]: Leaving directory `/usr/src/mod_python-3.0.1'
> > make: *** [install] Error 2
> > ..........................................
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From vmanera at manord.com  Fri Dec 13 08:58:14 2002
From: vmanera at manord.com (Manera, Villiam)
Date: Fri Jan  9 21:47:10 2004
Subject: R: [mod_python] problem with file download in mod-python 3.0.1
Message-ID: <52DC70C1C1575C418CB033523A29CF140E0589@exchange2000.manord.com>

Ok, but on  Fri, 7 Jun 2002 Grisha wrote to me about this problem:

Yes, whatever free time I have I try to spend on the 3.0 version that will
run on Apache 2.0. Probably the simplest way to tackle this one is for
someone to add the publisher patch to the FAQ, at least for the time
being.

Grisha

So I hope that in mod-python 3.0.2 a patch for this problem will be added

Villiam Manera
-----Messaggio originale-----
Da: Brian Hawthorne [mailto:brianh@exelixis.com]
Inviato: gioved? 12 dicembre 2002 20.27
A: Manera, Villiam
Cc: Mod_python@modpython.org
Oggetto: Re: [mod_python] problem with file download in mod-python 3.0.1


i'm not sure what the point is of wrapping the field object like this.
why not just use the field object itself as the value for the file upload
arg?  i cut this part out of my publisher because it seemed unnecessary.

brian hawthorne


On Thu, 12 Dec 2002, Manera, Villiam wrote:

> I'm testing mod-python 3.0.1 with apache 2.0.43 and python 2.2.2
> 
> I've founded a older problem in file download (from python 2.1 to 2.2)
> 
> the workaround is still the same:
> 
> in publisher.py:
> 
>  class File:
>      """ Like a file, but also has headers and filename
>      """
>      def __init__(self, field):
>          # steal all the file-like methods
>          for m in dir(field.file):            
> 		 self.__dict__[m] = getattr(field.file, m)
>  
>          self.headers = field.headers
>          self.filename = field.filename
> ======================workaround
> ==============================================
>  class File:
>      """ Like a file, but also has headers and filename
>      """
>      def __init__(self, field):
>          # steal all the file-like methods
>          #for m in dir(field.file):    #dont' work
>          for m in self.sim_methods(field.file):
>              self.__dict__[m] = getattr(field.file, m)
>  
>          self.headers = field.headers
>          self.filename = field.filename
>     
> 	#new--------	
>      def sim_methods(self,obj):
>          from types import BuiltinMethodType   
>          return filter(lambda s, t=obj:
>             type(getattr(t, s)) == BuiltinMethodType, dir(obj))
>  
>  
> I hope it will be put in place
> 
> regards
> 
> Villiam Manera
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From fuf at mobil.cz  Fri Dec 13 09:10:35 2002
From: fuf at mobil.cz (Michal Vitecek)
Date: Fri Jan  9 21:47:10 2004
Subject: [mod_python] problem with file download in mod-python 3.0.1
In-Reply-To: <52DC70C1C1575C418CB033523A29CF14104883@exchange2000.manord.com>
References: <52DC70C1C1575C418CB033523A29CF14104883@exchange2000.manord.com>
Message-ID: <20021213081034.GA5296@diana.mobil.cz>

Manera, Villiam wrote:

[snip]

>     def sim_methods(self,obj):
>         from types import BuiltinMethodType   
>         return filter(lambda s, t=obj:
>            type(getattr(t, s)) == BuiltinMethodType, dir(obj))

 I just wanted to say that code using lambda functions is considerably
 slower than when it uses list comprehensions. thus the above is faster
 with:
    
    def sim_methods(self, obj):
	from types import BuiltinMethodType
	return [attribute for attribute in dir(obj) if (type(getattr(obj,
		attribute)) == BuiltinMethodType)]

-- 
		fuf		(fuf@mobil.cz)

From listmail at xs4all.nl  Sat Dec 14 00:09:57 2002
From: listmail at xs4all.nl (baz)
Date: Fri Jan  9 21:47:10 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
In-Reply-To: <20021212211044.R53709-100000@eden.ispol.com>
References: <20021212211044.R53709-100000@eden.ispol.com>
Message-ID: <3DFA68C5.5070806@xs4all.nl>

thanks for the input, but..

did try without the without-threads before,
but had the same problem.

using this rpm version of libtool
libtool-libs-1.4.2-7
libtool-1.4.2-7

tried buildconf for apache, didn't change the problem at all

my questions are: is there such a thing as a libpython.so for python 2.2 
? if so, how would i normally produce this file ?

really hoped i could've made some progress on this issue, really want to 
move on to actually programming something .. ;)

grtz,
baz.

Gregory (Grisha) Trubetskoy wrote:
> You don't need without-threads when compiling python. I don't know if its
> the cause of the problem, but it's a start. Also, make sure you have
> libtool 1.4.x. Lastly, if you compiled your own apache, try recompiling it
> by first running ./buildconf, then ./configure, etc.
> 
> On Thu, 12 Dec 2002, bvr wrote:
>>Hi,
>>
>>Same problem here, tried several installations running RH 7.3.


From geertj at boskant.nl  Sun Dec 15 19:39:09 2002
From: geertj at boskant.nl (Geert Jansen)
Date: Fri Jan  9 21:47:10 2004
Subject: [mod_python] Annouce: Draco dynamic content system
Message-ID: <20021215183909.GD8533@vader.boskant.nl>

Hello fellow Pythoneers,

I'd like to announce the free availability of my latest mod_python project
to the list: the Draco dynamic content system.

Draco is a framework for creating dynamic web sites and and web applications.

What I like about Draco is that it is structured around a nice paradigm for a
clean separation of code (Python) and markup (html). Program code in Draco is
split in two parts: program logic and markup logic. Program logic is put in
the so-called handlers.  These handlers process the user's request and put the
result in a namespace called the interface. On the other hand, markup logic is
put in a template. The template is a regular template as seen in many dynamic
content systems but its task in Draco is much more limited. It should only
format the data in the interface in the html and nothing more.

Draco offers a large standard library with functionality that is often used in
dynamic web sites. This includes: automated session management, a limited form
of user management, easy form parsing and feedback, events, task scheduling (no
more cron!) and tag rewriting.

Draco is freely available under the GPL. More information can be found on
the Draco website at http://draco.boskant.nl/.

Thanks,
Geert Jansen

From jirka.machotka at seznam.cz  Sun Dec 15 21:04:20 2002
From: jirka.machotka at seznam.cz (=?iso-8859-2?Q?Jirka=20Machotka?=)
Date: Fri Jan  9 21:47:10 2004
Subject: [mod_python] =?iso-8859-2?Q?Re=3A=20R=3A=20=5Bmod=5Fpython=5D=20Problems=20with=20mptest=2Epy=20=28Windows=29?=
In-Reply-To: <52DC70C1C1575C418CB033523A29CF140E0570@exchange2000.manord.com>
Message-ID: <3912.4583-28975-439333470-1039982660@seznam.cz>

This is an informational issue covering somehow the solution to my
problem. It sums up few other answers - thanx for all of them! - and
as such it should be a simple handy to anyone who wants to run the
Apache with mod_python on Windows. I'd love to have something like
that a month ago (it'd spare me from few white hairs by now)

1. if you install the Apache and you want to connact it to the python
interpret all you need is a file called mod_python.so

Put it to the /modules subdirectory and add the line
   LoadModule python_module modules/mod_python.so 
to the httpd.conf

Restart the Apache server. If you get an error (cannot load
C:\...\modules\mod_python.so into server: the module could not be
found ) you need to get a file called msvcr70.dll (e.g. from
www.dll-files.com/dllindex/dll-files.shtml?msvcr70) and copy it into
\winnt\system32 (thanx to Duncan Booth for this hint). Do not forget
to restart the Apache when it's done.

This and the modification of httpd.conf file as described in the
manual should be enough so that the Apache sends all the file with
*.py extension to be processed by python

2. in order to be able to use Apache related objects in python you
need also their sources. Get the mod_python-3.0.1.tgz file, unpack
it, find the subdirectory called \site-packages and copy it into the
subdirectory of the same name of your Python installation. I know it
sounds obvious for anyone who knows about it, but honestly I could
not get this point from the manual. 

If you don't do it you will face the same problems as I did (just
scroll below for details)


Dne 5.?prosinec?2002, Manera, Villiam, <vmanera@manord.com> napsal:

> e circa il problema che dava a te?
> 
> -----Messaggio originale-----
> Da: Jirka Machotka [mailto:jirka.machotka@seznam.cz]
> Inviato: giovedi 5 dicembre 2002 12.18
> A: mod_python@modpython.org
> Oggetto: [mod_python] Problems with mptest.py (Windows)
> 
> 
> Hello there,
> 
> I have probably a very basic question. However, I could not find
> anything relevant (a searching machine would be fine)
> 
> I had had problems with running the mod_python for Apache 2.0.43.
> Following the advice I had gotten the msvcr70.dll, put it to the
> required directory and restarted the Apache. The Apache starts,
> however, when I try to fetch mptest.py (it looks exactly as described
> in the manual, the configuration file httpd has been modified
> accordingly) I receive an error:
> 
> make_obcallback: could not import mod_python.apache
> 
> To my understanding the problem relates rather to Python (my version
> is 2.2.1). The manual mentions that Python environment must be
> recompiled, or what. I'm afraid that's not possible for me
> (recompiled in what?) Or am I missing something inportant?
> 
> 
> Please help. Thanks in advance.
> 
> Jiri
> 
> ______________________________________________________________________
> Reklama:
> Sout?? o auto na v?kend, autor?dio Clarion a dal?? ceny:
> http://ad2.seznam.cz/redir.cgi?instance=12345%26url=http://www.auto-plus.cz
>  - nejlep?? syst?m prodeje ojet?ch voz? na internetu
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 

______________________________________________________________________
Reklama:
Vyhrajte cenu za 100.000,- Kc v soute?i "Svetem Financ?
za 30 dn?" na http://soutez.finance.cz. Ne? V?s predbehnou jin?!


From jw9 at softhome.net  Sun Dec 15 16:44:56 2002
From: jw9 at softhome.net (jw9@softhome.net)
Date: Fri Jan  9 21:47:10 2004
Subject: [mod_python] How to use CGI handler?
Message-ID: <000901c2a483$39291560$4b00a8c0@laptop>

I got a big python CGI script which I would like to rewrite using
mod_python. In the meanwhile, I want to try CGI handler.

Did a simple test using CGI handler, doesn't work well. Here is my config
files, all my scripts are in cgi-bin folder:

httpd.conf:
.......
<Directory "D:/Apache2/cgi-bin">
AddHandler python-program .py
AllowOverride All
PythonDebug ON
</Directory>

.htaccess file under D:/Apache2/cgi-bin:
***********************
SetHandler python-program
PythonHandler mod_python.cgihandler

very simple test script:
***********************
print 'Content-type: text/html\n'
print 'Hello World!'


result:
***********************
Mod_python error: "PythonHandler mod_python.cgihandler" Traceback (most
recent call last): File "D:\PYTHON22\Lib\mod_python\apache.py", line 335, in
HandlerDispatch result = object(req) File
"D:\PYTHON22\Lib\mod_python\cgihandler.py", line 140, in handler
apache.restore_nocgi(env, si, so) File
"D:\PYTHON22\Lib\mod_python\apache.py", line 764, in restore_nocgi for k in
osenv: RuntimeError: dictionary changed size during iteration

I don't what is wrong.  Anybody have the same experience? By the way, the
mptest.py worked, so I guess at least the installation was succesful.

Thanks!


From sebastian.tusk at gmx.net  Sun Dec 15 23:09:02 2002
From: sebastian.tusk at gmx.net (Sebastian Tusk)
Date: Fri Jan  9 21:47:10 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
In-Reply-To: <3DFA68C5.5070806@xs4all.nl>
References: <20021212211044.R53709-100000@eden.ispol.com> <3DFA68C5.5070806@xs4all.nl>
Message-ID: <3DFCFD7E.7000105@gmx.net>

 > *** Warning: This library needs some functionality provided by
 > -lpython2.2.
 > *** I have the capability to make that library automatically link in
 > when
 > *** you link to this library.  But I can only do this if you have a
 > *** shared version of the library, which you do not appear to have.

The problem is that apache 2 comes with an old version of libtool and 
uses that. mod_python uses via apxs the same outdated version. So you 
need to replace libtool in the apache 2 source distribution and rebuild 
apache and then rebuild mod_python. At least that works for me.

Sebastian



From geo at overweb.it  Mon Dec 16 17:42:50 2002
From: geo at overweb.it (Geo)
Date: Fri Jan  9 21:47:10 2004
Subject: [mod_python] Different PythonHander
Message-ID: <1040056970.3dfe028ae35eb@phpgroupware.overweb.it>

How can I set httpd.conf to have a different PythonHandler
for each user?

I need something like this:

<Directory "/usr/home/*/public_html">
      AddHandler python-program .py
      PythonHandler mptest
      PythonDebug on
</Directory>

Thanks

-- 
Gerolamo Valcamonica

From zoper at libero.it  Tue Dec 17 13:40:04 2002
From: zoper at libero.it (Zoper)
Date: Fri Jan  9 21:47:10 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
References: <20021212211044.R53709-100000@eden.ispol.com> <3DFA68C5.5070806@xs4all.nl> <3DFCFD7E.7000105@gmx.net>
Message-ID: <001e01c2a5c9$91e4dda0$c4281a97@sorpippo>

Hi All.

> The problem is that apache 2 comes with an old version of libtool and 
> uses that. mod_python uses via apxs the same outdated version. So you 
> need to replace libtool in the apache 2 source distribution and rebuild 
> apache and then rebuild mod_python. At least that works for me.

How can I replace libtool in the apache 2 source distribution?

Is this the right way to preceed?

tar xvfz libtool-1.4.2.tar.gz
cd libtool-1.4.2 
./configure --prefix=/usr
make
make install 

and then 

cd httpd-2.0.39 
./configure 
make ; make install


Thanks in advance.


Gius.



From sebastian.tusk at gmx.net  Tue Dec 17 13:50:26 2002
From: sebastian.tusk at gmx.net (Sebastian Tusk)
Date: Fri Jan  9 21:47:10 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
In-Reply-To: <001e01c2a5c9$91e4dda0$c4281a97@sorpippo>
References: <20021212211044.R53709-100000@eden.ispol.com> <3DFA68C5.5070806@xs4all.nl> <3DFCFD7E.7000105@gmx.net> <001e01c2a5c9$91e4dda0$c4281a97@sorpippo>
Message-ID: <3DFF1D92.1010204@gmx.net>

> How can I replace libtool in the apache 2 source distribution?
> 
> Is this the right way to preceed?
> 
> tar xvfz libtool-1.4.2.tar.gz
> cd libtool-1.4.2 
> ./configure --prefix=/usr
> make
> make install 
> 
> and then 
> 
> cd httpd-2.0.39 
> ./configure 
> make ; make install

That will not work. Apache comes with its own libtool. Replace 
httpd-2.0.43/srclib/apr/libtool with that from your system (e.g. 
/usr/local/bin/libtool) Then rebuild apache and mod_python.

Sebastian


From grisha at modpython.org  Tue Dec 17 10:08:57 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:47:10 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
In-Reply-To: <001e01c2a5c9$91e4dda0$c4281a97@sorpippo>
Message-ID: <20021217100543.X15809-100000@eden.ispol.com>

You can replace the libtool apache comes with by running ./buildconf just
before running apache's ./configure. Among other things, ./buildconf takes
the libtool on the system and incorporates it into apache. I think what's
happening is 2.0.43 in particular came bundled with an outdated libtool by
mistake.

Grisha

On Tue, 17 Dec 2002, Zoper wrote:

> Hi All.
>
> > The problem is that apache 2 comes with an old version of libtool and
> > uses that. mod_python uses via apxs the same outdated version. So you
> > need to replace libtool in the apache 2 source distribution and rebuild
> > apache and then rebuild mod_python. At least that works for me.
>
> How can I replace libtool in the apache 2 source distribution?
>
> Is this the right way to preceed?
>
> tar xvfz libtool-1.4.2.tar.gz
> cd libtool-1.4.2
> ./configure --prefix=/usr
> make
> make install
>
> and then
>
> cd httpd-2.0.39
> ./configure
> make ; make install
>
>
> Thanks in advance.
>
>
> Gius.
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From grisha at modpython.org  Tue Dec 17 16:30:53 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:47:10 2004
Subject: [mod_python] bug/misfeature in publisher/mod_python
In-Reply-To: <20021203151244.GB16590@legolas.on.net.mk>
Message-ID: <20021217162845.N19724-100000@eden.ispol.com>

On Tue, 3 Dec 2002, Damjan wrote:

> My setup:
>  apache 2.0.43, mod_python 3.0.1, python 2.2.1
>
> httpd.conf:
> <Directory /home/www/htdocs> # The root of the web server
> ...
>     SetHandler python-program
>     PythonHandler mod_python.publisher | .py
>     PythonDebug On
> </Directory>
> ...
>
> I expect this setup to handle all files ending in ".py" through
> the publisher handler.
>
> I have the script "hello.py" from the mod_python manual in the root of the
> web-server. Trying to get "http://127.1/hello.py/say" mod_python
> throws an exception (traceback atached).
>
> The exception is: "ImportError: No module named py"

But http://127.1/hello/say (without .py) should work.

(I still agree that this is a problem, just wanted to point out that there
is one way to make it work)

Grisha



From listmail at xs4all.nl  Wed Dec 18 00:11:46 2002
From: listmail at xs4all.nl (baz)
Date: Fri Jan  9 21:47:10 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
In-Reply-To: <002001c2a021$66b50720$1c291a97@sorpippo>
References: <002001c2a021$66b50720$1c291a97@sorpippo>
Message-ID: <3DFFAF32.1010600@xs4all.nl>

i solved my problem, maybe you've got the same so check this:

try
# locate libpython2.2.so

if nothing comes up you don't have the python shared library, which is 
needed by mod python.

i used the following commands to build it from source and install it:

cd Python-2.2.2/
make distclean
./configure
make OPT="-fpic -O2"
mkdir .extract
(cd .extract; ar xv ../libpython2.2.a)
gcc -shared -o libpython2.2.so .extract/*.o
rm -rf .extract
make install

or you may install the separate debian package for this file

have fun!

baz.

Zoper wrote:
> Hi All!
> 
> After making my mod_python I try to make install but...
> 
> ...............CUT....................
> Performing DSO installation.
> 
> /usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
> /usr/bin/install: src/mod_python.so: No such file or directory
> make[1]: *** [install_dso] Error 1
> make[1]: Leaving directory `/usr/src/mod_python-3.0.1'
> make: *** [install] Error 2
> ..........................................
> 


From zoper at libero.it  Wed Dec 18 17:06:23 2002
From: zoper at libero.it (Zoper)
Date: Fri Jan  9 21:47:10 2004
Subject: [mod_python] mod_python 3.0.1: problem with libtool and apache
Message-ID: <001301c2a6af$6cbfec40$602b1a97@sorpippo>

Hi All.

Thanks a lot for the previous answers.
I replaced the old libtool apache come with, but when I make apache I obtain
an ugly message...

libtool: link: cannot find the library `'
make[1]: *** [httpd] Error 1
make[1]: Leaving directory `/usr/src/httpd-2.0.43'
make: *** [all-recursive] Error 1

What does it mean?

Thanks in advance.

Gius.


From webmaster at obramaestraonline.com  Wed Dec 18 13:26:37 2002
From: webmaster at obramaestraonline.com (Rafael Fernandez)
Date: Fri Jan  9 21:47:10 2004
Subject: [mod_python] mod_python in Win32, Apache 2.0.43
Message-ID: <002d01c2a6ba$c8321b10$cc393242@Family>

Can somebody send me the code for running mod_python in Apache 2.0.43 in
the Win32 Platform?

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20021218/dac86ef0/attachment.htm
From grisha at modpython.org  Wed Dec 18 15:08:13 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:47:10 2004
Subject: [mod_python] bug/misfeature in publisher/mod_python
In-Reply-To: <20021217162845.N19724-100000@eden.ispol.com>
Message-ID: <20021218150543.C29444-100000@eden.ispol.com>

I take it back, what I said below isn't true, it won't work :)

But I did patch up the latest CVS code so that it addresses this issue.

Grisha

On Tue, 17 Dec 2002, Gregory (Grisha) Trubetskoy wrote:

>
> On Tue, 3 Dec 2002, Damjan wrote:
>
> > My setup:
> >  apache 2.0.43, mod_python 3.0.1, python 2.2.1
> >
> > httpd.conf:
> > <Directory /home/www/htdocs> # The root of the web server
> > ...
> >     SetHandler python-program
> >     PythonHandler mod_python.publisher | .py
> >     PythonDebug On
> > </Directory>
> > ...
> >
> > I expect this setup to handle all files ending in ".py" through
> > the publisher handler.
> >
> > I have the script "hello.py" from the mod_python manual in the root of the
> > web-server. Trying to get "http://127.1/hello.py/say" mod_python
> > throws an exception (traceback atached).
> >
> > The exception is: "ImportError: No module named py"
>
> But http://127.1/hello/say (without .py) should work.
>
> (I still agree that this is a problem, just wanted to point out that there
> is one way to make it work)
>
> Grisha
>
>
>


From cameron at toolhouse.com  Wed Dec 18 14:28:52 2002
From: cameron at toolhouse.com (Cameron S. Watters)
Date: Fri Jan  9 21:47:10 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
In-Reply-To: <3DFFAF32.1010600@xs4all.nl>
Message-ID: <16154ED8-12D8-11D7-979F-00306599D91A@toolhouse.com>

Since I posted almost EXACTLY the same comment as the quoted one on 
December 4th, I thought I'd reply.

My understanding is that this shouldn't be necessary, but is, in fact, 
an issue with the version of libtool supplied with apache.

I was able to fix my problem by building apache from source by running:

tar -xzvf apache-tarball.tgz
cd apache-src-dir/
./buildconf
./configure --a mass of configure options
make
make install

you probably want to make sure you have a newish libtool installed 
BEFORE you do the above.

this made it stop freaking out because it couldn't find a 
libpython2.2.so. It is also my understanding that building libpython2.2 
doesn't actually do anything other than fool
the install portion of the build into continuing with the process and 
not erroring out.

I mention this mostly because this may NOT, in fact, be the most 
correct solution to this problem.

--cameron

> i solved my problem, maybe you've got the same so check this:
>
> try
> # locate libpython2.2.so
>
> if nothing comes up you don't have the python shared library, which is 
> needed by mod python.
>
> i used the following commands to build it from source and install it:
>
> cd Python-2.2.2/
> make distclean
> ./configure
> make OPT="-fpic -O2"
> mkdir .extract
> (cd .extract; ar xv ../libpython2.2.a)
> gcc -shared -o libpython2.2.so .extract/*.o
> rm -rf .extract
> make install
>
> or you may install the separate debian package for this file
>
> have fun!
>
> baz.
>
> Zoper wrote:
>> Hi All!
>> After making my mod_python I try to make install but...
>> ...............CUT....................
>> Performing DSO installation.
>> /usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
>> /usr/bin/install: src/mod_python.so: No such file or directory
>> make[1]: *** [install_dso] Error 1
>> make[1]: Leaving directory `/usr/src/mod_python-3.0.1'
>> make: *** [install] Error 2
>> ..........................................
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From gnb at itga.com.au  Thu Dec 19 18:27:04 2002
From: gnb at itga.com.au (Gregory Bond)
Date: Fri Jan  9 21:47:10 2004
Subject: [mod_python] import mod_puthon.util fails
Message-ID: <200212190727.SAA10103@lightning.itga.com.au>

[I'm brand new to mod_python and this list....]

FreeBSD 4-Stable (as of the other day, so it's after 4.7)

Apache 2.0.43, built from the FreeBSD port, with USE_THREADS

mod_python 3.0.1, built using "./configure && make"

hellcat$ python -c "import mod_python.util"
Traceback (most recent call last):
  File "<string>", line 1, in ?
  File "/usr/local/lib/python2.2/site-packages/mod_python/util.py", line 58, in ?
    import _apache
ImportError: No module named _apache
hellcat$ 

And indeed there is nothing that looks like _apache.so.  There is a src/
_apachemodule.c, which is compiled and linked into mod_python.so, which has 
what seems to be the intended contents of the _apache module, but this is 
never turned into the appropriate .so file.

Am I doing something wrong?



From zoper at libero.it  Thu Dec 19 15:53:53 2002
From: zoper at libero.it (Zoper)
Date: Fri Jan  9 21:47:10 2004
Subject: [mod_python] mod_python 3.0.1: problem with libtool and apache
Message-ID: <004e01c2a76e$74dbd3c0$022b1a97@sorpippo>

Hi All.

Thanks a lot for the previous answers.
I replaced the old libtool apache come with, but when I make apache I obtain
an ugly message...

libtool: link: cannot find the library `'
make[1]: *** [httpd] Error 1
make[1]: Leaving directory `/usr/src/httpd-2.0.43'
make: *** [all-recursive] Error 1

What does it mean?

Thanks in advance.

Gius.


From zoper at libero.it  Thu Dec 19 15:57:26 2002
From: zoper at libero.it (Zoper)
Date: Fri Jan  9 21:47:10 2004
Subject: [mod_python] mod_python 3.0.1: problem with libtool and apache
Message-ID: <006f01c2a76e$f2cda600$022b1a97@sorpippo>

Hi All.

Thanks a lot for the previous answers.
I replaced the old libtool apache come with, but when I make apache I obtain
an ugly message...

libtool: link: cannot find the library `'
make[1]: *** [httpd] Error 1
make[1]: Leaving directory `/usr/src/httpd-2.0.43'
make: *** [all-recursive] Error 1

What does it mean?

Thanks in advance.

Gius.


From grisha at modpython.org  Thu Dec 19 10:24:45 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:47:11 2004
Subject: [mod_python] import mod_puthon.util fails
In-Reply-To: <200212190727.SAA10103@lightning.itga.com.au>
Message-ID: <20021219102330.X43686-100000@eden.ispol.com>

No, you're not doing anything wrong, _apache is only available when
mod_python is loaded as an apache module, you can't really use any of
those modules from the command line.

On Thu, 19 Dec 2002, Gregory Bond wrote:

> [I'm brand new to mod_python and this list....]
>
> FreeBSD 4-Stable (as of the other day, so it's after 4.7)
>
> Apache 2.0.43, built from the FreeBSD port, with USE_THREADS
>
> mod_python 3.0.1, built using "./configure && make"
>
> hellcat$ python -c "import mod_python.util"
> Traceback (most recent call last):
>   File "<string>", line 1, in ?
>   File "/usr/local/lib/python2.2/site-packages/mod_python/util.py", line 58, in ?
>     import _apache
> ImportError: No module named _apache
> hellcat$
>
> And indeed there is nothing that looks like _apache.so.  There is a src/
> _apachemodule.c, which is compiled and linked into mod_python.so, which has
> what seems to be the intended contents of the _apache module, but this is
> never turned into the appropriate .so file.
>
> Am I doing something wrong?
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From sebastian.tusk at gmx.net  Thu Dec 19 20:15:12 2002
From: sebastian.tusk at gmx.net (Sebastian Tusk)
Date: Fri Jan  9 21:47:11 2004
Subject: [mod_python] AddOutputFilterByType not working
Message-ID: <3E021AC0.4010504@gmx.net>

The apache directive AddOutputFilterByType doesn't work for content 
generated by mod_python. The reason for this is the following line in 
requestobject.c

self->request_rec->content_type =
     apr_pstrdup(self->request_rec->pool, PyString_AsString(val));

which should read

ap_set_content_type(self->request_rec, PyString_AsString(val));


Sebastian


From gnb at itga.com.au  Fri Dec 20 09:28:58 2002
From: gnb at itga.com.au (Gregory Bond)
Date: Fri Jan  9 21:47:11 2004
Subject: [mod_python] import mod_puthon.util fails 
In-Reply-To: Your message of Thu, 19 Dec 2002 10:24:45 -0500.
Message-ID: <200212192228.JAA12799@lightning.itga.com.au>

>No, you're not doing anything wrong, _apache is only available when
>mod_python is loaded as an apache module, you can't really use any of
>those modules from the command line.

<lightbulb>Aha!</lightbulb>

Thanks.  I've submited an FAQ update.  [That faq wizard is kewl]



From gnb at itga.com.au  Fri Dec 20 17:33:18 2002
From: gnb at itga.com.au (Gregory Bond)
Date: Fri Jan  9 21:47:11 2004
Subject: [mod_python] cgi handler bug?
Message-ID: <200212200633.RAA17433@lightning.itga.com.au>

[FreeBSD 4.7, python 2.2.2, Apache 2.0.43, mod_python 3.0.1]

When I try and run something using cgihandler, I get the following error:

[Fri Dec 20 16:54:25 2002] [error] [client 192.168.71.163] PythonHandler mod_python.cgihandler:   File "/usr/local/lib/python2.2/site-packages/mod_python/apache.py", line 764, in restore_nocgi
    for k in osenv:
[Fri Dec 20 16:54:25 2002] [error] [client 192.168.71.163] PythonHandler mod_python.cgihandler: RuntimeError: dictionary changed size during iteration

Looking at mod_python/apache.py:restore_nocgi(), this does:
    for k in osenv:
        del osenv[k]

This is never going to be legal in Python 2.2.  Shouldn't this be 

    for k in osenv.keys():
        del osenv[k]

?

Having made that change, and a few little fixes to the cgi program, (__name__
== "__main__" is no longer true, "foo-bar.py" is not a good name as "import
foo-bar" is a syntax error) my cgi now runs inside mod_python.  But the HTML
generated by the CGI is sent twice, so my page displays double.  I've added 
debugging and the HTML is only being sent from the script once, as far as I 
can tell.  (i.e. I print a string of length 2132 bytes, but View Page Info 
shows 4215 bytes.   No, I have no idea where the missing 49 bytes are!)

Any clues?

Greg.



From grisha at modpython.org  Fri Dec 20 16:34:37 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:47:11 2004
Subject: [mod_python] problem with file download in mod-python 3.0.1
In-Reply-To: <52DC70C1C1575C418CB033523A29CF14104883@exchange2000.manord.com>
Message-ID: <20021220151113.I61260-100000@eden.ispol.com>

I must be missing something obvious, but without testing it and just by
looking at the code, I'm not sure I understand what the benefit is of
filtering out BuiltinMethodType, as opposed to just using straight
dir(obj).

The above might be a moot point since just as Brian Hawthorne suggested
I'm not sure why we don't need the File class at all and am in the process
of trying to fish out any memories from my tired brain about how it came
about in the fist place....

Grisha

On Thu, 12 Dec 2002, Manera, Villiam wrote:

> I'm testing mod-python 3.0.1 with apache 2.0.43 and python 2.2.2
>
> I've founded a older problem in file download (from python 2.1 to 2.2)
>
> the workaround is still the same:
>
> in publisher.py:
>
>  class File:
>      """ Like a file, but also has headers and filename
>      """
>      def __init__(self, field):
>          # steal all the file-like methods
>          for m in dir(field.file):
> 		 self.__dict__[m] = getattr(field.file, m)
>
>          self.headers = field.headers
>          self.filename = field.filename
> ======================workaround
> ==============================================
>  class File:
>      """ Like a file, but also has headers and filename
>      """
>      def __init__(self, field):
>          # steal all the file-like methods
>          #for m in dir(field.file):    #dont' work
>          for m in self.sim_methods(field.file):
>              self.__dict__[m] = getattr(field.file, m)
>
>          self.headers = field.headers
>          self.filename = field.filename
>
> 	#new--------
>      def sim_methods(self,obj):
>          from types import BuiltinMethodType
>          return filter(lambda s, t=obj:
>             type(getattr(t, s)) == BuiltinMethodType, dir(obj))
>
>
> I hope it will be put in place
>
> regards
>
> Villiam Manera
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>




From LBerezhny at DevIS.com  Sat Dec 21 20:53:41 2002
From: LBerezhny at DevIS.com (Lex Berezhny)
Date: Fri Jan  9 21:47:11 2004
Subject: [mod_python] installation problems
Message-ID: <1040522021.12314.421.camel@hortus>

hi all,

  I'm having trouble installing mod_python.

My environment:
Red Hat Linux release 7.3
gcc 2.96


My install process:

wget http://www.apache.org/dist/httpd/httpd-2.0.43.tar.gz
tar xzvf httpd-2.0.43.tar.gz
wget http://apache.webmeta.com/dist/httpd/modpython/mod_python-3.0.1.tgz
tar xzvf mod_python-3.0.1.tgz
wget http://www.python.org/ftp/python/2.2.2/Python-2.2.2.tgz
tar xzvf Python-2.2.2.tgz

cd httpd-2.0.43
./configure --prefix=/usr/local/apache2
make
make install 

cd ../Python-2.2.2/
./configure
make
make install

cd ../mod_python-3.0.1/
./configure --with-apxs=/usr/local/apache2/bin/apxs
--with-python=/usr/local/bin/python2.2
make
make install


Warning messages I get (during make):

*** Warning: This library needs some functionality provided by
-lpython2.2.
*** I have the capability to make that library automatically link in
when
*** you link to this library.  But I can only do this if you have a
*** shared version of the library, which you do not appear to have.

*** Warning: libtool could not satisfy all declared inter-library
*** dependencies of module mod_python.  Therefore, libtool will create
*** a static module, that should work as long as the dlopening
*** application is linked with the -dlopen flag.


The final, fatal, error (during make install):

make[2]: Leaving directory
`/usr/local/apache2install/mod_python-3.0.1/src'

Performing DSO installation.

/usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
/usr/bin/install: cannot stat `src/mod_python.so': No such file or
directory
make[1]: *** [install_dso] Error 1
make[1]: Leaving directory `/usr/local/apache2install/mod_python-3.0.1'
make: *** [install] Error 2




any help or pointers would be greatly appreciated,

 - lex


From grisha at modpython.org  Sat Dec 21 21:45:58 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:47:11 2004
Subject: [mod_python] installation problems
In-Reply-To: <1040522021.12314.421.camel@hortus>
Message-ID: <20021221214317.K81120-100000@eden.ispol.com>

Try this:

Make sure you have libtool 1.4.x, you can do this with libtool --version.

If/when you do, rebuild your apache like this:

cd httpd-2.0.43
./buildconf
./configure --prefix=/usr/local/apache2
make
make install

then ./configure and make mod_python.

On 21 Dec 2002, Lex Berezhny wrote:

> hi all,
>
>   I'm having trouble installing mod_python.
>
> My environment:
> Red Hat Linux release 7.3
> gcc 2.96
>
>
> My install process:
>
> wget http://www.apache.org/dist/httpd/httpd-2.0.43.tar.gz
> tar xzvf httpd-2.0.43.tar.gz
> wget http://apache.webmeta.com/dist/httpd/modpython/mod_python-3.0.1.tgz
> tar xzvf mod_python-3.0.1.tgz
> wget http://www.python.org/ftp/python/2.2.2/Python-2.2.2.tgz
> tar xzvf Python-2.2.2.tgz
>
> cd httpd-2.0.43
> ./configure --prefix=/usr/local/apache2
> make
> make install
>
> cd ../Python-2.2.2/
> ./configure
> make
> make install
>
> cd ../mod_python-3.0.1/
> ./configure --with-apxs=/usr/local/apache2/bin/apxs
> --with-python=/usr/local/bin/python2.2
> make
> make install
>
>
> Warning messages I get (during make):
>
> *** Warning: This library needs some functionality provided by
> -lpython2.2.
> *** I have the capability to make that library automatically link in
> when
> *** you link to this library.  But I can only do this if you have a
> *** shared version of the library, which you do not appear to have.
>
> *** Warning: libtool could not satisfy all declared inter-library
> *** dependencies of module mod_python.  Therefore, libtool will create
> *** a static module, that should work as long as the dlopening
> *** application is linked with the -dlopen flag.
>
>
> The final, fatal, error (during make install):
>
> make[2]: Leaving directory
> `/usr/local/apache2install/mod_python-3.0.1/src'
>
> Performing DSO installation.
>
> /usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
> /usr/bin/install: cannot stat `src/mod_python.so': No such file or
> directory
> make[1]: *** [install_dso] Error 1
> make[1]: Leaving directory `/usr/local/apache2install/mod_python-3.0.1'
> make: *** [install] Error 2
>
>
>
>
> any help or pointers would be greatly appreciated,
>
>  - lex
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From skremer at q.cis.uoguelph.ca  Sun Dec 22 01:47:25 2002
From: skremer at q.cis.uoguelph.ca (Stefan C. Kremer)
Date: Fri Jan  9 21:47:11 2004
Subject: [mod_python] Warning: This library needs some functionality provided by -lpython2.2.
Message-ID: <Pine.LNX.4.44.0212220126580.17196-100000@q.cis.uoguelph.ca>

Hi,

I just read another post about this message by Lex Berezhny and Gregory 
(Grisha) Trubetskoy after experiencing exactly the same problem.

It turns out that the command:

wget http://www.apache.org/dist/httpd/httpd-2.0.43.tar.gz

Provides a very old version of libtool:

$ /usr/local/apache/build/libtool --version
ltmain.sh (GNU libtool) 1.3.4-freebsd-ports (1.385.2.196 1999/12/07 
21:47:57)

By contrast, httpd-2.0.42 has libtool-1.4.2.
(wget http://www.apache.org/dist/httpd/old/httpd-2.0.42.tar.gz)
Any the mod_python install goes smoothly.

Anyone know what's going on with this?!?  Did someone at apache just
screw-up and include the wrong version?  Or is there a reason for this 
downgrade?

Is there an easy remedy to patch 2.0.43 to work correctly?  Can I 
just copy one libtool over the other?  Anyone willing 
to share advice/experiences is greatly appreciated.

Thanks,

	-Stefan

-- 
--
Dr. Stefan C. Kremer, Associate Prof.
Reynolds Building, 106
Dept. of Computing and Information Science
University of Guelph, Guelph, Ontario	N1G 2W1

WWW: http://q.cis.uoguelph.ca/~skremer
Tel: (519)824-4120 Ext.8913  Fax: (519)837-0323
E-mail:  skremer@uoguelph.ca


From alphasquad at web.de  Sun Dec 22 20:21:37 2002
From: alphasquad at web.de ([FTSB]Hawk)
Date: Fri Jan  9 21:47:11 2004
Subject: [mod_python] mod_python cgihandler bug?
Message-ID: <JFEBLGLFKE2CHD65CBA69EAFAJFQP.3e0610c1@Hawk>

Hello

I found some questions on the same topic but no answers.
I installed mod_python 3.0.1 on Win2k and Apache 2.0.43.
Everything seemed to be fine.
But when I tried to use the cgihandler I got an error.
The python script consists of two lines only:

print "content-type: text/plain \n\n"
print "<b>something</b>"

So I do not expect the error to be there. With PythonDebug On I got this message


<b>something</b>
<b>something</b>

Mod_python error: "PythonHandler mod_python.cgihandler"

Traceback (most recent call last):

  File "G:\PYTHON\PYTHON\lib\site-packages\mod_python\apache.py", line 335, in HandlerDispatch
    result = object(req)

  File "G:\PYTHON\PYTHON\lib\site-packages\mod_python\cgihandler.py", line 140, in handler
    apache.restore_nocgi(env, si, so)

  File "G:\PYTHON\PYTHON\lib\site-packages\mod_python\apache.py", line 764, in restore_nocgi
    for k in osenv:

RuntimeError: dictionary changed size during iteration


I need this cgihandler for a port of a rather large project.

Hawk





From grisha at modpython.org  Sun Dec 22 16:41:45 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:47:11 2004
Subject: [mod_python] Warning: This library needs some functionality
 provided by -lpython2.2.
In-Reply-To: <Pine.LNX.4.44.0212220126580.17196-100000@q.cis.uoguelph.ca>
Message-ID: <20021222164004.S90422-100000@eden.ispol.com>

On Sun, 22 Dec 2002, Stefan C. Kremer wrote:

> It turns out that the command:
>
> wget http://www.apache.org/dist/httpd/httpd-2.0.43.tar.gz
>
> Provides a very old version of libtool:
>
> $ /usr/local/apache/build/libtool --version
> ltmain.sh (GNU libtool) 1.3.4-freebsd-ports (1.385.2.196 1999/12/07
> 21:47:57)
>
> By contrast, httpd-2.0.42 has libtool-1.4.2.
> (wget http://www.apache.org/dist/httpd/old/httpd-2.0.42.tar.gz)
> Any the mod_python install goes smoothly.
>
> Anyone know what's going on with this?!?  Did someone at apache just
> screw-up and include the wrong version?

This seems to be the case.

> Is there an easy remedy to patch 2.0.43 to work correctly?

Yes, simply running ./buildconf make apache adopt the version of libtool
on the system.

Grisha


From gnb at itga.com.au  Mon Dec 23 09:15:50 2002
From: gnb at itga.com.au (Gregory Bond)
Date: Fri Jan  9 21:47:11 2004
Subject: [mod_python] mod_python cgihandler bug? 
In-Reply-To: Your message of Sun, 22 Dec 2002 20:21:37 +0100.
Message-ID: <200212222215.JAA00265@lightning.itga.com.au>

In the line:
  File "G:\PYTHON\PYTHON\lib\site-packages\mod_python\apache.py", line 764, in restore_nocgi
    for k in osenv:

Change this to 
	for k in osenv.keys():
and it gets past this problem.  I have still other problems with cgihandler 
tho (see my message from the other day).



From LBerezhny at DevIS.com  Sun Dec 22 18:29:18 2002
From: LBerezhny at DevIS.com (Lex Berezhny)
Date: Fri Jan  9 21:47:11 2004
Subject: [mod_python] ImportError: No module named mod_python.apache
Message-ID: <1040599758.21517.25.camel@buddha>

hello again,

  Thanks for the ./buildconf pointer, it is working great! (i have
attached an updated bash script to get others started, it's only been
tested on RH7, don't forget to su first ;-)

  The next phase of my mod_python escapade involved trying to get the
example working, that's when I hit my next snag.

  The following additions were made to httpd.conf:

    230 LoadModule python_module
/usr/local/apache2/modules/mod_python.so

    361 <Directory "/usr/local/apache2/htdocs/test">
    362     AddHandler python-program .py
    363     PythonHandler mptest
    364     PythonDebug On
    365 </Directory>


  I started apache as follows:

# ./apachectl -k start -DONE_PROCESS


  Going to http://localhost/test/mptest.py produced an Internal Server
Error with the following message in error_log:

[Sun Dec 22 17:57:55 2002] [error] make_obcallback: could not import
mod_python.apache.

ImportError: No module named mod_python.apache

  Is there any simple way to get mod_python to print out its sys.path?
What could cause an incorrect import path? Any suggestions on resolving
this?

thanks a lot,
 - lex
-------------- next part --------------
A non-text attachment was scrubbed...
Name: install.sh
Type: text/x-sh
Size: 563 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20021222/3ba3579e/install.bin
From LBerezhny at DevIS.com  Sun Dec 22 19:04:34 2002
From: LBerezhny at DevIS.com (Lex Berezhny)
Date: Fri Jan  9 21:47:11 2004
Subject: [mod_python] ImportError: No module named mod_python.apache
In-Reply-To: <1040599758.21517.25.camel@buddha>
References: <1040599758.21517.25.camel@buddha>
Message-ID: <1040601873.21517.40.camel@buddha>

heya,

>   Is there any simple way to get mod_python to print out its sys.path?

i found a way to answer my first question (after looking through the
mod_python mailing list archive i found an email by Conrad Steenberg
suggesting strace). I had to adapt his example to work on my machine:

i started apache:
# ./apachectl -k start -DONE_PROCESS

then i got the process id and ran strace like so:
$ strace -p 29405

Every time I went to the URL of my script strace printed out the
following:

......
stat64("/usr/lib/python2.2/mod_python", 0xbfffeb30) = -1 ENOENT (No such
file or directory)
open("/usr/lib/python2.2/mod_python.so", O_RDONLY|O_LARGEFILE) = -1
ENOENT (No such file or directory)
open("/usr/lib/python2.2/mod_pythonmodule.so", O_RDONLY|O_LARGEFILE) =
-1 ENOENT (No such file or directory)
open("/usr/lib/python2.2/mod_python.py", O_RDONLY|O_LARGEFILE) = -1
ENOENT (No such file or directory)
open("/usr/lib/python2.2/mod_python.pyc", O_RDONLY|O_LARGEFILE) = -1
ENOENT (No such file or directory)
....

For some reason mod_python uses the wrong python install directory (i
have two, one that came with my redhat system under /usr/lib/python2.2
and one that i install as part of my script /usr/local/lib/python2.2).

So, where does mod_python make the decision on which python to use?
Again my ./configure for mod_python was this:

./configure --with-apxs=/usr/local/apache2/bin/apxs
--with-python=/usr/local/bin/python2.2

> What could cause an incorrect import path? Any suggestions on resolving
> this?

Thanks again,
 - lex


From gnb at itga.com.au  Mon Dec 23 11:24:46 2002
From: gnb at itga.com.au (Gregory Bond)
Date: Fri Jan  9 21:47:11 2004
Subject: [mod_python] cgi handler bug? 
In-Reply-To: Your message of Fri, 20 Dec 2002 17:33:18 +1100.
Message-ID: <200212230024.LAA08767@lightning.itga.com.au>

I wrote: 

> But the HTML
> generated by the CGI is sent twice, so my page displays double. 

Found it.

In mod_python.apache.py, in the CGIStdout::write() routine, the
self.headers_sent variable is never being set, so the first chunk of stuff from
the CGI program (in my case, all but the last newline) is being handled and
sent twice.

The following patch fixes both CGIhandler problems, and my CGIs now happily 
operate under mod_python:

diff -u ~gnb/mod_python-3.0.1/lib/python/mod_python/apache.py /usr/local/lib/python2.2/site-packages/mod_python/apache.py
--- /home/users/gnb/mod_python-3.0.1/lib/python/mod_python/apache.py    Fri Nov  8 11:15:11 2002
+++ /usr/local/lib/python2.2/site-packages/mod_python/apache.py Mon Dec 23 11:18:56 2002
@@ -723,6 +723,7 @@
                     else:
                         self.req.headers_out.add(h, v)
 
+               self.headers_sent = 1
                 # write the body if any at this point
                 self.req.write(ss[1])
         else:
@@ -761,7 +762,7 @@
     osenv = os.environ
 
     # restore env
-    for k in osenv:
+    for k in osenv.keys():
         del osenv[k]
     for k in sav_env:
         osenv[k] = env[k]




From jim at thario.net  Sun Dec 22 22:17:09 2002
From: jim at thario.net (Jim Thario)
Date: Fri Jan  9 21:47:11 2004
Subject: [mod_python] Problems with PythonAuthenHandler on Red Hat 8.0?
Message-ID: <33470.63.227.22.21.1040620629.squirrel@webmail.thario.com>

Hi. I recently stared working with mod_python. I am using the stock Red
Hat 8.0 installation which includes:

httpd-2.0.40-11
python-2.2.1-17
mod_python-3.0.0-10

I am having trouble with the example from "3.4 Now something More
Complicated - Authentication". My configuration in httpd.conf looks like:

<Directory /var/www/html/python>
        AddHandler python-program .py
        PythonHandler myscript
        PythonAuthenHandler myscript
        PythonDebug On
        AuthType Basic
        AuthName "Restricted Area"
        require valid-user
</Directory>

After getting prompted for the user and password, I get a "Server error!"
page and an entry in the /var/log/httpd/error_log:

"configuration error:  couldn't check user.  No user file?: /python"

Apache seems to want an AuthUserFile in there to read. The best I can
guess is there is a problem with the version of mod_python shipped with
Red Hat 8.0.

Any ideas?

Thanks in advance,
Jim




From tsyang at webtech360.com  Thu Dec 26 13:56:52 2002
From: tsyang at webtech360.com (T.-S. Yang)
Date: Fri Jan  9 21:47:11 2004
Subject: [mod_python] Problems with PythonAuthenHandler on Red Hat 8.0?
In-Reply-To: <33470.63.227.22.21.1040620629.squirrel@webmail.thario.com>
References: <33470.63.227.22.21.1040620629.squirrel@webmail.thario.com>
Message-ID: <3E0B7B24.30505@webtech360.com>

Jim,

I'm able to reproduce the error that you described using RedHat 8.
The problem is fixed under ReHat 8.0.92 (Phoebe).

I don't know the cause of the problem. The related packages in Phoebe
are

httpd-2.0.40-14
python-2.2.2-7
mod_python-3.0.1-1

Happy Holidays,
-tsy


Jim Thario wrote:
> Hi. I recently stared working with mod_python. I am using the stock Red
> Hat 8.0 installation which includes:
> 
> httpd-2.0.40-11
> python-2.2.1-17
> mod_python-3.0.0-10
> 
> I am having trouble with the example from "3.4 Now something More
> Complicated - Authentication". My configuration in httpd.conf looks like:
> 
> <Directory /var/www/html/python>
>         AddHandler python-program .py
>         PythonHandler myscript
>         PythonAuthenHandler myscript
>         PythonDebug On
>         AuthType Basic
>         AuthName "Restricted Area"
>         require valid-user
> </Directory>
> 
> After getting prompted for the user and password, I get a "Server error!"
> page and an entry in the /var/log/httpd/error_log:
> 
> "configuration error:  couldn't check user.  No user file?: /python"
> 
> Apache seems to want an AuthUserFile in there to read. The best I can
> guess is there is a problem with the version of mod_python shipped with
> Red Hat 8.0.
> 
> Any ideas?
> 
> Thanks in advance,
> Jim
> 


From jim at thario.net  Thu Dec 26 16:43:27 2002
From: jim at thario.net (Jim Thario)
Date: Fri Jan  9 21:47:11 2004
Subject: [mod_python] Problems with PythonAuthenHandler on Red Hat 8.0?
In-Reply-To: <3E0B7B24.30505@webtech360.com>
References: <33470.63.227.22.21.1040620629.squirrel@webmail.thario.com>
        <3E0B7B24.30505@webtech360.com>
Message-ID: <32892.63.227.22.21.1040946207.squirrel@webmail.thario.com>

Thanks for taking time to reproduce this. I am going to open a bug against
Red Hat 8.0 and see what they are willing to do.

Thanks,
Jim


T.-S. Yang said:
> Jim,
>
> I'm able to reproduce the error that you described using RedHat 8. The
> problem is fixed under ReHat 8.0.92 (Phoebe).
>
> I don't know the cause of the problem. The related packages in Phoebe
> are
>
> httpd-2.0.40-14
> python-2.2.2-7
> mod_python-3.0.1-1
>
> Happy Holidays,
> -tsy
>
>
> Jim Thario wrote:
>> Hi. I recently stared working with mod_python. I am using the stock
>> Red Hat 8.0 installation which includes:
>>
>> httpd-2.0.40-11
>> python-2.2.1-17
>> mod_python-3.0.0-10
>>
>> I am having trouble with the example from "3.4 Now something More
>> Complicated - Authentication". My configuration in httpd.conf looks
>> like:
>>
>> <Directory /var/www/html/python>
>>         AddHandler python-program .py
>>         PythonHandler myscript
>>         PythonAuthenHandler myscript
>>         PythonDebug On
>>         AuthType Basic
>>         AuthName "Restricted Area"
>>         require valid-user
>> </Directory>
>>
>> After getting prompted for the user and password, I get a "Server
>> error!" page and an entry in the /var/log/httpd/error_log:
>>
>> "configuration error:  couldn't check user.  No user file?: /python"
>>
>> Apache seems to want an AuthUserFile in there to read. The best I can
>> guess is there is a problem with the version of mod_python shipped
>> with Red Hat 8.0.
>>
>> Any ideas?
>>
>> Thanks in advance,
>> Jim
>>




From andy at nervebox.com  Fri Dec 27 00:16:36 2002
From: andy at nervebox.com (andy@nervebox.com)
Date: Fri Jan  9 21:47:11 2004
Subject: [mod_python] http 1.1 persistent connections
Message-ID: <7838526.1040976996296.JavaMail.SYSTEM@Obatala>

Hi all,
I'm new to Python and mod_python - and I'm having trouble finding out if mod_python supports  http1.1's persistent connections.  

I need to be able to have long-running scripts flush a single document - a little at a time, as it's generated - out through Apache to the client.  It might take a minute or an hour.  

Cold Fusion makes this dirt simple.  You can simply insert <cfflush> anywhere in your template and whatever data is generated thus far will be flushed out to Apache - which will hold the HTTP connection open until the template finishes executing.  It can be kept open for hours and makes a good sort of server push.

Can this be done with Python/mod_python?

 - thanks,
 - andy c
      
      
      
    

From stephane.bidoul at softwareag.com  Mon Dec  2 18:15:47 2002
From: stephane.bidoul at softwareag.com (Stéphane Bidoul)
Date: Fri Jan  9 21:53:15 2004
Subject: [mod_python] mp_server.register_cleanup
Message-ID: <000001c29a26$78d78460$56241eac@acsesbi>

Hi Grisha,

I'm back using mod_python, on a real project this time.
We've been using 3.0 beta for a few weeks and it works great!

Now I'm trying to use mp_server.register_cleanup, and that fails
with a "ValueError: first argument must be a Request object".

My first diagnostic (unless I'm doing something silly)
is that it's a remnant of mod_python 2.x,
since the Request class seems to have disappeared
from apache.py.

Is that an easy fix for you? 
Or should I dig it a little bit more?

-sbi




From tigrux at avantel.net  Mon Dec  2 15:01:55 2002
From: tigrux at avantel.net (Sandino Flores Moreno)
Date: Fri Jan  9 21:53:16 2004
Subject: [mod_python] mp_server.register_cleanup
In-Reply-To: <000001c29a26$78d78460$56241eac@acsesbi>
References: <000001c29a26$78d78460$56241eac@acsesbi>
Message-ID: <1038859317.19550.9.camel@TigruXtatioN>

In my code (http://mamba.sf.net)
I'm using it in in this way:

def endRequest(mamba):
        if mamba.processor.globals.has_key('endRequest'):
                endRequest = mamba.processor.globals['endRequest']
                endRequest()
        
def endChild(mamba):
        if mamba.processor.globals.has_key('endChild'):
                endChild = mamba.processor.globals['endChild']
                endChild()


req.register_cleanup(endRequest, (mamba,) )
req.server.register_cleanup(req, endChild, (mamba,) )


From markusjais at yahoo.de  Mon Dec  2 22:31:41 2002
From: markusjais at yahoo.de (Markus Jais)
Date: Fri Jan  9 21:53:16 2004
Subject: [mod_python] beginners question
In-Reply-To: <001f01c29a3b$e92ddc40$6401a8c0@darwin>
References: <1038180652.3173.2.camel@eagle> 
	<001f01c29a3b$e92ddc40$6401a8c0@darwin>
Message-ID: <1038864704.2017.1.camel@eagle>

On Mon, 2002-11-25 at 01:48, Antonio Rodriguez wrote:
> Markus,
> 
> Go into the src directory of the dist and in the OPTIONS= line add -DEAPI.
> apxs will do the right thing and you will stop getting that warning.

thanks, but I found no OPTIONS in all the Make files
I then added 
OPTIONS=-DEAPI
to the Makefile, but this hat not effect.

markus

...

__________________________________________________________________

Gesendet von Yahoo! Mail - http://mail.yahoo.de
Möchten Sie mit einem Gruß antworten? http://grusskarten.yahoo.de

From antonio at memora.com  Mon Dec  2 16:46:54 2002
From: antonio at memora.com (Antonio Rodriguez)
Date: Fri Jan  9 21:53:16 2004
Subject: [mod_python] beginners question -- LIST moderation?
In-Reply-To: <1038864704.2017.1.camel@eagle>
Message-ID: <9297B926-063F-11D7-9E16-00039300D690@memora.com>

in the src directory near the top of the make file there is a line:
OPT=

and you want to make it:
OPT=-DEAPI

Sorry about the confusion.

One other important thing: is this list moderated or something? I 
posted this to you over a week ago and I just received my own post. If 
it is, I kind of wish it wasn't as it impedes the flow of 
communications.

AR


On Monday, December 2, 2002, at 04:31 PM, Markus Jais wrote:

> On Mon, 2002-11-25 at 01:48, Antonio Rodriguez wrote:
>> Markus,
>>
>> Go into the src directory of the dist and in the OPTIONS= line add 
>> -DEAPI.
>> apxs will do the right thing and you will stop getting that warning.
>
> thanks, but I found no OPTIONS in all the Make files
> I then added
> OPTIONS=-DEAPI
> to the Makefile, but this hat not effect.
>
> markus
>
> ...
>
> __________________________________________________________________
>
> Gesendet von Yahoo! Mail - http://mail.yahoo.de
> M?chten Sie mit einem Gru? antworten? http://grusskarten.yahoo.de
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>



From grisha at modpython.org  Mon Dec  2 16:52:26 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:53:16 2004
Subject: [mod_python] mp_server.register_cleanup
In-Reply-To: <000001c29a26$78d78460$56241eac@acsesbi>
Message-ID: <20021202164818.R5868-100000@eden.ispol.com>

Stephane -

Yes, it looks like server.register_cleanup was left forgotten....

Try applying this set of patches (this includes patches to the test
suite), I'll add this to HEAD.

RCS file: /home/cvs/httpd-python/src/serverobject.c,v
retrieving revision 1.13
diff -u -r1.13 serverobject.c
--- src/serverobject.c  8 Nov 2002 00:15:11 -0000       1.13
+++ src/serverobject.c  2 Dec 2002 21:47:52 -0000
@@ -117,30 +117,20 @@
     cleanup_info *ci;
     PyObject *handler = NULL;
     PyObject *data = NULL;
-    PyObject *Req = NULL;
     requestobject *req = NULL;

-    if (! PyArg_ParseTuple(args, "OO|O", &Req, &handler, &data))
+    if (! PyArg_ParseTuple(args, "OO|O", &req, &handler, &data))
        return NULL;

-    if (! PyObject_HasAttrString(Req, "_req")) {
-       PyErr_SetString(PyExc_ValueError, "first argument must be a Request object");
-       return NULL;
+    if (! MpRequest_Check(req)) {
+        PyErr_SetString(PyExc_ValueError,
+                        "first argument must be a request object");
+        return NULL;
     }
-    else {
-
-       req = (requestobject *) PyObject_GetAttrString(Req, "_req");
-
-       if (! MpRequest_Check(req)) {
-           PyErr_SetString(PyExc_ValueError,
-                           "first argument must be a request object");
-           return NULL;
-       }
-       else if(!PyCallable_Check(handler)) {
-           PyErr_SetString(PyExc_ValueError,
-                           "second argument must be a callable object");
-           return NULL;
-       }
+    else if(!PyCallable_Check(handler)) {
+        PyErr_SetString(PyExc_ValueError,
+                        "second argument must be a callable object");
+        return NULL;
     }

     ci = (cleanup_info *)malloc(sizeof(cleanup_info));
Index: test/test.py
===================================================================
RCS file: /home/cvs/httpd-python/test/test.py,v
retrieving revision 1.20
diff -u -r1.20 test.py
--- test/test.py        29 Oct 2002 21:52:18 -0000      1.20
+++ test/test.py        2 Dec 2002 21:47:52 -0000
@@ -776,12 +776,39 @@

         self.failUnless(result.wasSuccessful())

+    def test_srv_register_cleanup(self):
+
+        print "\n* Testing server.register_cleanup()..."
+
+        c = Directory(DOCUMENT_ROOT,
+                      SetHandler("python-program"),
+                      PythonHandler("tests::srv_register_cleanup"),
+                      PythonDebug("On"))
+
+        self.makeConfig(str(c))
+
+        self.startHttpd()
+
+        f = urllib.urlopen("http://127.0.0.1:%s/tests.py" % PORT)
+        f.read()
+        f.close()
+
+        self.stopHttpd()
+
+        # see what's in the log now
+        time.sleep(1)
+        f = open(os.path.join(SERVER_ROOT, "logs/error_log"))
+        log = f.read()
+        f.close()
+        if log.find("test ok") == -1:
+            self.fail("Could not find test message in error_log")

 def suite():

     mpTestSuite = unittest.TestSuite()
     mpTestSuite.addTest(PerInstanceTestCase("testLoadModule"))
     mpTestSuite.addTest(PerInstanceTestCase("testPerRequestTests"))
+    mpTestSuite.addTest(PerInstanceTestCase("test_srv_register_cleanup"))
     return mpTestSuite

 tr = unittest.TextTestRunner()
Index: test/htdocs/tests.py
===================================================================
RCS file: /home/cvs/httpd-python/test/htdocs/tests.py,v
retrieving revision 1.19
diff -u -r1.19 tests.py
--- test/htdocs/tests.py        29 Oct 2002 21:52:18 -0000      1.19
+++ test/htdocs/tests.py        2 Dec 2002 21:47:52 -0000
@@ -505,6 +505,14 @@

     data.log_error(data.cleanup_data)

+def srv_register_cleanup(req):
+
+    req.cleanup_data = "test ok"
+    req.server.register_cleanup(req, cleanup, req)
+    req.write("registered server cleanup that will write to log")
+
+    return apache.OK
+
 def util_fieldstorage(req):

     from mod_python import util


Grisha

On Mon, 2 Dec 2002, St?phane Bidoul wrote:

> Hi Grisha,
>
> I'm back using mod_python, on a real project this time.
> We've been using 3.0 beta for a few weeks and it works great!
>
> Now I'm trying to use mp_server.register_cleanup, and that fails
> with a "ValueError: first argument must be a Request object".
>
> My first diagnostic (unless I'm doing something silly)
> is that it's a remnant of mod_python 2.x,
> since the Request class seems to have disappeared
> from apache.py.
>
> Is that an easy fix for you?
> Or should I dig it a little bit more?
>
> -sbi
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From harrington_chad at hotmail.com  Mon Dec  2 17:22:23 2002
From: harrington_chad at hotmail.com (Chad Harrington)
Date: Fri Jan  9 21:53:16 2004
Subject: [mod_python] can't find mod_python.so
Message-ID: <F63lff3ECr3ni8hEUJ90001c3fa@hotmail.com>

An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20021202/685bb448/attachment-0001.htm
From mkurjano at tjhsst.edu  Mon Dec  2 22:10:08 2002
From: mkurjano at tjhsst.edu (Matthew Kurjanowicz)
Date: Fri Jan  9 21:53:16 2004
Subject: [mod_python] Problems with mp tutorial
Message-ID: <Pine.LNX.4.44.0212022155500.15170-100000@phosphorus.tjhsst.edu>

Hi there,
First off, I'm new to the list, so if this question has been answered, I
am sorry.  I checked the archives and documentation but could not find
anything helpful in this case.

I am running a new, clean install of RH 8.0, with Apache 2.0.40 (rpm rev
8) and mod_python 3.0.0 (rpm rev 10).  I try the first part of the
tutorial (just hello world) and it works fine.  However, when I try to run
the authentication part of the tutorial, I get these errors (relevent part
of error_log listed below).  Apache is asking for the AuthUserFile of some
sort.  I've used Apache before, and know about basic authentication using
the files, but I'd love to be able to use python.  Any assistance is
appreciated.
Let me know if you need more info or any different files.
Thanks for your time,
Matt Kurjanowicz (mkurjano@tjhsst.edu)

[Sun Dec 01 23:53:28 2002] [notice] Digest: generating secret for digest
authentication ...
[Sun Dec 01 23:53:28 2002] [notice] Digest: done
[Sun Dec 01 23:53:29 2002] [notice] Apache/2.0.40 (Red Hat Linux)
configured -- resuming normal operations
[Sun Dec 01 23:53:40 2002] [crit] [client 127.0.0.1] configuration error:
couldn't check user.  No user file?: /python/authen.py, referer:
http://localhost/python/
[Sun Dec 01 23:53:57 2002] [crit] [client 127.0.0.1] configuration error:
couldn't check user.  No user file?: /python/a.py



From markusjais at yahoo.de  Tue Dec  3 09:29:26 2002
From: markusjais at yahoo.de (=?iso-8859-1?q?Markus=20Jais?=)
Date: Fri Jan  9 21:53:16 2004
Subject: [mod_python] beginners question -- LIST moderation?
In-Reply-To: <9297B926-063F-11D7-9E16-00039300D690@memora.com>
Message-ID: <20021203082926.42999.qmail@web12405.mail.yahoo.com>

 --- Antonio Rodriguez <antonio@memora.com> schrieb: >
in the src directory near the top of the make file
> there is a line:
> OPT=
> 
> and you want to make it:
> OPT=-DEAPI
> 

thank you very much!

> Sorry about the confusion.
> 
> One other important thing: is this list moderated or
> something? I 
> posted this to you over a week ago and I just
> received my own post. If 
> it is, I kind of wish it wasn't as it impedes the
> flow of 
> communications.

I hat the same problems. some postings needed several
days to arrive.

markus





__________________________________________________________________

Gesendet von Yahoo! Mail - http://mail.yahoo.de
Weihnachts-Eink?ufe ohne Stress! http://shopping.yahoo.de

From ray_drew at yahoo.co.uk  Tue Dec  3 11:18:49 2002
From: ray_drew at yahoo.co.uk (Ray Drew)
Date: Fri Jan  9 21:53:16 2004
Subject: [mod_python] 3.0.1 on Apache 2.0.43/Python 2.2.1 on Windows XP Prof.
Message-ID: <002901c29abd$c1ba1750$e4ae5651@RDREWXP>

I seem to have the same problem that others are having - I can't get this to
run.

Apache runs fine until I add...

    LoadModule python_module modules/mod_python.so to the modules section of
httpd.conf

... then Apache fails to start.

I have mod_python.so in the apache modules directory.

Under Apache 1.3x and mod_python 2.76 the apache module was a dll.

Does anyone have this combination working?

Thanks,

Ray





__________________________________________________
Do You Yahoo!?
Sign up for SBC Yahoo! Dial - First Month Free
http://sbc.yahoo.com

From neo at https.ru  Tue Dec  3 15:09:03 2002
From: neo at https.ru (Neo Eureka)
Date: Fri Jan  9 21:53:16 2004
Subject: [mod_python] mod_python on Windows
Message-ID: <1484824066.20021203150903@https.ru>

Hi !

  I have no cygwin installed but I had just the same problem with
mod_python 3 on WinNT. I posted this question a logn-long time ago.
There are about ten people who have reported the same issue since that
time...

>
> 
> Grisha,
> Unfortunately, I think it must be more involved than that...
> I have the identical problem, but I use python 2.2.1
> 
> I am running mod_python 3.0.1, Python 2.2.1, Apache 2.0.43, Windows
> 2000 Professional.  I also have cygwin installed, if that might make
> a difference.  It appears that the Mark (the original poster) also
> has cygwin.  I also played with the permissions and owners to no
> avail.  Are there any other things I should try?    
> Chad Harrington 
> harrington_chad@hotmail.com 

--- 
Neo Eureka / mailto:neo@https.ru


From heha at iki.fi  Tue Dec  3 16:13:00 2002
From: heha at iki.fi (Heikki Halonen)
Date: Fri Jan  9 21:53:16 2004
Subject: [mod_python] mod_python with 4Suite tools
Message-ID: <Pine.LNX.4.44.0212031452160.3043-100000@a204b.ud.ton.tut.fi>

Hi

I'm having hard time trying to make 4Suite tools co-operate with
mod_python (or vice versa). I'm using Python 2.2.2, Apache 2.0.43,
mod_python 3.0.1 and newest 4Suite development version. My system is
Debian unstable. python2.2-xml package is not installed.

The test program is in the end of this mail, the xml files used can be
found at http://www.heha.iki.fi/~heha/poll_dev/quiz2html.xsl and
http://www.heha.iki.fi/~heha/poll_dev/polls/quiz_1.xml. Test program works
perfectly when run from the command line. When requested by mod_python,
however, it 'obfuscates' the XML document. Characters used in marking
print out fine but everything else is some random binary data. I figured
out that it probably has something to do with encoding and added the
following lines to sitecustomize.py, as somebody advised in some distantly
similar problem:

u'hello'.encode( 'UTF-8' )
u'hello'.encode( 'iso8859-1' )

This did not help, whatsoever. I have no clue anymore where the problem
could be or how it could be corrected. Any suggestions? The same kind of
code works fine in mod_python 2.7.8 running in Apache 1.3.26 with Python
2.1 and 4Suite version 0.11.1.




#!/usr/bin/python2.2

import sys, os, string

from Ft.Lib import Uri
from Ft.Xml.Xslt import XmlWriter, Processor, OutputParameters
from Ft.Xml import Domlette, InputSource

def processXML():
    mypath = '/home/heha/public_html/poll_dev/'
    pollfile = mypath+'polls/quiz_1.xml'
    pollxsl = mypath+'quiz2html.xsl'

    debugfile = open( mypath+'poll.log', 'w' )
    processor = Processor.Processor()
    node = Domlette.NonvalidatingReader.parseUri( pollfile )
    Domlette.Print( node, debugfile, encoding='iso8859-1' )
    stylesheet = InputSource.DefaultFactory.fromUri( pollxsl )
    processor.appendStylesheet( stylesheet )

    processed_node = processor.runNode( node, Uri.OsPathToUri(
        pollfile, 1) )

    debugfile.write( processed_node )
    debugfile.close()

    return processed_node

    #print writer.getResult()

if __name__ == "__main__":
    print processXML()
else:
    from mod_python import apache

    def handler( req ):
        req.write( processXML() )
        return apache.OK



     Heikki Halonen # heha@iki.fi # iki.fi/heha # +358 40 828 9972
            "The easy way ain't hard enough and the hard way
                     is such a lonely lonely path"


From gdamjan at mail.net.mk  Tue Dec  3 16:12:44 2002
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 21:53:16 2004
Subject: [mod_python] bug/misfeature in publisher/mod_python
Message-ID: <20021203151244.GB16590@legolas.on.net.mk>

My setup:
 apache 2.0.43, mod_python 3.0.1, python 2.2.1

httpd.conf:
<Directory /home/www/htdocs> # The root of the web server
...
    SetHandler python-program
    PythonHandler mod_python.publisher | .py
    PythonDebug On
</Directory>
...

I expect this setup to handle all files ending in ".py" through
the publisher handler.

I have the script "hello.py" from the mod_python manual in the root of the
web-server. Trying to get "http://127.1/hello.py/say" mod_python
throws an exception (traceback atached).

The exception is: "ImportError: No module named py"

I've foloved the problem to the publisher handler, line 139. 
When publisher tries to strip the suffixes, it gets them by
calling "req.get_addhandler_exts()". Obviosly in my case this
call return None (I dont have the AddHandler directive). So
publsiher doesn't strip anything, thus trying to import the
module "py" (which is the extension of the script).

The solution for this problem would be for get_addhandler_exts()
alsa to return the extensions as specified in the 
"PythonHandler ... | .ext" directive.



-- 
Damjan Georgievski
-------------- next part --------------

Mod_python error: "PythonHandler mod_python.publisher"

Traceback (most recent call last):

  File "/usr/lib/python2.2/site-packages/mod_python/apache.py", line 335, in HandlerDispatch
    result = object(req)

  File "/usr/lib/python2.2/site-packages/mod_python/publisher.py", line 149, in handler
    module = apache.import_module(module_name, req.get_config(), [path])

  File "/usr/lib/python2.2/site-packages/mod_python/apache.py", line 499, in import_module
    f, p, d = imp.find_module(parts[i], path)

ImportError: No module named py
From duncan at rcp.co.uk  Tue Dec  3 15:58:39 2002
From: duncan at rcp.co.uk (Duncan Booth)
Date: Fri Jan  9 21:53:16 2004
Subject: [mod_python] mod_python 3.0.1 on Apache 2.0.43 solution
Message-ID: <3DECD4AF.28805.1664047@localhost>

It appears that the binaries for mod_python 3.0.1 have been built 
using Microsoft Visual Studio version 7. This means that 
mod_python.so has a dependency on the file msvcr70.dll, but the 
distribution doesn't include this file.

If you have the latest Microsoft compiler installed, or any other 
applications that use this DLL, then mod_python.so works fine. If not 
it fails horribly.

The workaround (at least on one machine that had this problem) is to 
copy msvcr70.dll into \winnt\system32. Get the file from anywhere 
that already has a copy (e.g. www.dll-files.com/dllindex/dll-
files.shtml?msvcr70). Fortunately this dll has no further 
dependencies.  

The long term solution would be to distribute mod_python as a .MSI 
file including dependencies, or even to build it with the same version 
of the C runtime library as used for the rest of Apache and Python.



From grisha at modpython.org  Tue Dec  3 11:00:17 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:53:16 2004
Subject: [mod_python] can't find mod_python.so
In-Reply-To: <F63lff3ECr3ni8hEUJ90001c3fa@hotmail.com>
Message-ID: <20021203105848.L19817-100000@eden.ispol.com>

I've recompiled mod_python.so and placed the new file out there. I tested
it and it works fine for me on Win2K, apache 2.0.43 and Python 2.2.1 (from
www.python.org). I think something went amuck with the original file.

Grisha

On Mon, 2 Dec 2002, Chad Harrington wrote:

>
>
>
> Grisha,
>
> Unfortunately, I think it must be more involved than that...
>
> I have the identical problem, but I use python 2.2.1
>
> I am running mod_python 3.0.1, Python 2.2.1, Apache 2.0.43, Windows 2000 Professional.  I also have cygwin installed, if that might make a difference.  It
> appears that the Mark (the original poster) also has cygwin.  I also played with the permissions and owners to no avail.  Are there any other things I should
> try?
>
> Chad Harrington
> harrington_chad@hotmail.com
> ----Original Message Follows----
> From: "Gregory (Grisha) Trubetskoy"
> To: Mark Messer
> CC: mod_python@modpython.org
> Subject: Re: [mod_python] can't find mod_python.so
> Date: Sat, 30 Nov 2002 23:06:10 -0500 (EST)
> This is possibly because the mod_python.so that is out there is for Python
> 2.2.1. I don't have one for 2.2.2 compiled (yet).
> Grisha
> On Sat, 30 Nov 2002, Mark Messer wrote:
> > I put mod_python.so into the modules directory, but I get an error when
> > starting Apache:
> >
> > C:\tools\Apache2\bin>apache
> > Syntax error on line 173 of C:/tools/Apache2/conf/httpd.conf:
> > Cannot load C:/tools/Apache2/modules/mod_python.so into server: The
> > specified module could not be found.
> >
> > I added this to the LoadModule section of httpd.conf: LoadModule
> > python_module modules/mod_python.so
> >
> > Here's the directory listing:
> > C:\tools\Apache2\modules>ls -al mod_p*
> > -rwxrwx--- 1 Administ SYSTEM 40960 Oct 3 06:58 mod_proxy.so
> > -rwxrwx--- 1 Administ SYSTEM 20480 Oct 3 06:58 mod_proxy_connect.so
> > -rwxrwx--- 1 Administ SYSTEM 28672 Oct 3 06:58 mod_proxy_ftp.so
> > -rwxrwx--- 1 Administ SYSTEM 24576 Oct 3 06:58 mod_proxy_http.so
> > -rwxrwx--- 1 Administ SYSTEM 65536 Nov 26 17:49 mod_python.so
> >
> > I am running mod_python 3.0.1, Python 2.2.2, Apache 2.0.43, Windows XP
> > Professional. Tried changing perms and ownership to match what was there,
> > but that did not work.
> >
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://www.modpython.org/mailman/listinfo/mod_python
> >
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>
> ____________________________________________________________________________________________________________________________________________________________________
> MSN 8 helps ELIMINATE E-MAIL VIRUSES. Get 2 months FREE*.
>


From harrington_chad at hotmail.com  Tue Dec  3 08:48:10 2002
From: harrington_chad at hotmail.com (Chad Harrington)
Date: Fri Jan  9 21:53:16 2004
Subject: [mod_python] can't find mod_python.so
Message-ID: <F153XRyOLjauzQmvaR300012ca1@hotmail.com>

An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20021203/8eb6acf8/attachment-0001.htm
From gstein at lyra.org  Tue Dec  3 10:20:30 2002
From: gstein at lyra.org (Greg Stein)
Date: Fri Jan  9 21:53:16 2004
Subject: [mod_python] 3.0.1 on Apache 2.0.43/Python 2.2.1 on Windows XP Prof.
In-Reply-To: <002901c29abd$c1ba1750$e4ae5651@RDREWXP>; from ray_drew@yahoo.co.uk on Tue, Dec 03, 2002 at 11:18:49AM -0000
References: <002901c29abd$c1ba1750$e4ae5651@RDREWXP>
Message-ID: <20021203102030.D17655@lyra.org>

On Tue, Dec 03, 2002 at 11:18:49AM -0000, Ray Drew wrote:
>...
> I have mod_python.so in the apache modules directory.
> 
> Under Apache 1.3x and mod_python 2.76 the apache module was a dll.

FYI... it is still a DLL, just with a different extension.

Cheers,
-g

-- 
Greg Stein, http://www.lyra.org/

From webmaster at obramaestraonline.com  Tue Dec  3 16:39:22 2002
From: webmaster at obramaestraonline.com (Webmaster)
Date: Fri Jan  9 21:53:16 2004
Subject: [mod_python] mod_python on Win32 Apache 1.3.27
Message-ID: <000101c29b0c$115e9800$22383242@Family>

Is mod python compatible with Apache 1.3.27?

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20021203/a5ee485b/attachment-0001.htm
From ray_drew at yahoo.co.uk  Tue Dec  3 23:44:24 2002
From: ray_drew at yahoo.co.uk (Ray Drew)
Date: Fri Jan  9 21:53:16 2004
Subject: [mod_python] mod_python os.environ bug?
Message-ID: <012e01c29b25$e9d99040$e4ae5651@RDREWXP>

Hi Grisha,

I'm using mod_python in conjunction with quixote
www.mems-exchange.org/software/quixote/

In moving from Apache 1.3.22/mp 2.78 to Apache 2.043/mp 3.01 I get a
TypeError on the quixote function environ.get(key, default). The default in
this function is None and this is what returns the Type Error. If I change
the default argument to an empty string everything works ok. It's been
suggested that there may be a bug in mod_python, see below:

-----------------------------------------------
On Tue, Dec 03, 2002 at 09:55:57PM -0000, Ray Drew wrote:
> Moving from...
>
> Apache 1.3.22 Python 2.2.1 mod_python 2.7.8 Quixote 0.5.1 Windows XP
>
> ...to...
>
> Apache 2.043 mod_python 3.0.1 rest as above.

>     return self.environ.get(key, default)
> TypeError: get() argument 2 must be string, not None

I would guess it is a mod_python bug.  I suppose it replaces os.environ
with an object that does incorrect type checking on the second argument
to get().
-----------------------------------------------

Would that be right?

Thanks,

Ray

__________________________________________________
Do you Yahoo!?
Yahoo! Mail Plus - Powerful. Affordable. Sign up now.
http://mailplus.yahoo.com

From ray_drew at yahoo.co.uk  Wed Dec  4 09:57:08 2002
From: ray_drew at yahoo.co.uk (Ray Drew)
Date: Fri Jan  9 21:53:16 2004
Subject: [mod_python] mod_python 3.0.1 on Apache 2.0.43 solution
References: <3DECD4AF.28805.1664047@localhost>
Message-ID: <002f01c29b7b$838d1860$e4ae5651@RDREWXP>

Duncan wrote:

#
The workaround (at least on one machine that had this problem) is to 
copy msvcr70.dll into \winnt\system32. Get the file from anywhere 
that already has a copy (e.g. www.dll-files.com/dllindex/dll-
files.shtml?msvcr70). 
#

Duncan,

THANKYOU THANKYOU THANKYOU

That worked for me on Windows XP professional.

Ray





__________________________________________________
Do you Yahoo!?
Yahoo! Mail Plus - Powerful. Affordable. Sign up now.
http://mailplus.yahoo.com

From scott at activestudios.com  Wed Dec  4 08:20:12 2002
From: scott at activestudios.com (Scott Russell)
Date: Fri Jan  9 21:53:16 2004
Subject: [mod_python] mod_xslt filtering of mod_python output
Message-ID: <1039008012.13748.35.camel@heckle.activestudios.com>

Hi. I'm a a beginner with mod_python, and I'm trying to use mod_python
and mod_xslt together.

mod_python gets called via a "SetHandler python-program", and inside
python I set the content-type to text/xml.

mod_xslt is called via "AddOutputFilterByType mod-xslt "text/xml")  

--- httpd.conf stanza: ---

<Location /the_dir>
    SetHandler python-program
    PythonPath "sys.path + ['/path/']"
    PythonHandler mymodule
    AddOutputFilterByType mod-xslt text/xml
</Location>
--- end ---

--- /path/mymodule.py excerpt ---

def handler(req):
        
  ... generate xml, place in out ...

  req.content_type = "text/xml"
  req.write(out)
  return apache.OK
--- end ---

Both work fine standalone - mod_xslt filters xml files, and mod_python
is generating dynamic content, but I don't know how to get mod_xslt to
filter dynamic content from mod_python...

What am I missing?  

Apache 2.0.40, mod_python 3.0.0, python 2.2.1 (all stock installs on on
RH 8) mod_xslt 1.0.5 (built locally)


From cameron at toolhouse.com  Wed Dec  4 13:46:48 2002
From: cameron at toolhouse.com (Cameron S. Watters)
Date: Fri Jan  9 21:53:16 2004
Subject: [mod_python] make problems
Message-ID: <E43EADFC-07D1-11D7-83C3-00306599D91A@toolhouse.com>

Hello all,

figured you could help.

I keep getting this message when I try to make mod_python 3.0.1

*** Warning: This library needs some functionality provided by 
-lpython2.2.
*** I have the capability to make that library automatically link in 
when
*** you link to this library.  But I can only do this if you have a
*** shared version of the library, which you do not appear to have.

*** Warning: libtool could not satisfy all declared inter-library
*** dependencies of module mod_python.  Therefore, libtool will create
*** a static module, that should work as long as the dlopening
*** application is linked with the -dlopen flag.

I installed apache 2.0.43 and python 2.2.2 from source on FreeBSD. I'm 
explicitly passing --with-python and --with-apxs to the configure 
script.

Any help would be appreciated.

--cameron


From grisha at modpython.org  Wed Dec  4 17:37:20 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:53:16 2004
Subject: [mod_python] make problems
In-Reply-To: <E43EADFC-07D1-11D7-83C3-00306599D91A@toolhouse.com>
Message-ID: <20021204172744.D39475-100000@eden.ispol.com>

You don't mention your FreeBSD version, it's possible that you have a
really old libtool. Also make sure that Apache is compiled with
--enable-threads. See the FreeBSD section in mod_python README.

Grisha

On Wed, 4 Dec 2002, Cameron S. Watters wrote:

> Hello all,
>
> figured you could help.
>
> I keep getting this message when I try to make mod_python 3.0.1
>
> *** Warning: This library needs some functionality provided by
> -lpython2.2.
> *** I have the capability to make that library automatically link in
> when
> *** you link to this library.  But I can only do this if you have a
> *** shared version of the library, which you do not appear to have.
>
> *** Warning: libtool could not satisfy all declared inter-library
> *** dependencies of module mod_python.  Therefore, libtool will create
> *** a static module, that should work as long as the dlopening
> *** application is linked with the -dlopen flag.
>
> I installed apache 2.0.43 and python 2.2.2 from source on FreeBSD. I'm
> explicitly passing --with-python and --with-apxs to the configure
> script.
>
> Any help would be appreciated.
>
> --cameron
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From webmaster at obramaestraonline.com  Wed Dec  4 19:09:11 2002
From: webmaster at obramaestraonline.com (Rafael Fernandez)
Date: Fri Jan  9 21:53:16 2004
Subject: [mod_python] Mod_python on Win32; Apache 1.3.27
Message-ID: <000001c29bea$2b711900$b0383242@Family>

Is mod_python compatible with Apache 1.3.27 on Win32?

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20021204/b891a606/attachment-0001.htm
From gdamjan at mail.net.mk  Thu Dec  5 00:18:15 2002
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 21:53:16 2004
Subject: [mod_python] make problems
In-Reply-To: <20021204172744.D39475-100000@eden.ispol.com>
References: <E43EADFC-07D1-11D7-83C3-00306599D91A@toolhouse.com> <20021204172744.D39475-100000@eden.ispol.com>
Message-ID: <20021204231815.GA15577@legolas.on.net.mk>

> 
> You don't mention your FreeBSD version, it's possible that you have a
> really old libtool. Also make sure that Apache is compiled with
> --enable-threads. See the FreeBSD section in mod_python README.
> 
> > *** Warning: This library needs some functionality provided by
> > -lpython2.2.
> > *** I have the capability to make that library automatically link in
> > when


This same thing happend on my slackware 8.1 box,
libtool = ltmain.sh (GNU libtool) 1.4.2 (1.922.2.53 2001/09/11 03:18:52)

I solved it by making a /usr/lib/libpython.2.2.so shared library.
The procedure is (if I remember good): 
  mkdir /tmp/libpython;  cd /tmp/libpython
  ar x /usr/lib/python2.2/config/libpython2.2.a
  ld -shared -export-dynamic *.o -ldl -lpthread -lutil -lm -lc\
	-o /usr/lib/libpython2.2.so
  



-- 
Damjan Georgievski

From cameron at toolhouse.com  Wed Dec  4 16:16:46 2002
From: cameron at toolhouse.com (Cameron S. Watters)
Date: Fri Jan  9 21:53:16 2004
Subject: [mod_python] make problems
In-Reply-To: <20021204172744.D39475-100000@eden.ispol.com>
Message-ID: <D748DF36-07E6-11D7-83C3-00306599D91A@toolhouse.com>

> You don't mention your FreeBSD version, it's possible that you have a
> really old libtool. Also make sure that Apache is compiled with
> --enable-threads. See the FreeBSD section in mod_python README.

FreeBSD 4.7-RELEASE
libtool 1.3.4 (installed from ports)

Thanks for the pointer to the FreeBSD note in the readme, I had missed 
it, BUT....

I still get the same message after recompiling apache with the 
--enable-threads flag set. I think it has more to do with the fact that 
there isn't a libpython2.2.so built (as mentioned by 
gdamjan@mail.net.mk).

I would suggest adding that either to the docs on the website (and to 
the README of future releases). The standard python built from source 
doesn't appear to do it for you and according to the python FAQ, item 
3.30, Why is the Python interpreter not built as a shared library?, it 
won't until v2.3. If this IS required by mod_python, it should be at 
least given a mention, and optimally, there would be instructions about 
how to create it.

> Grisha
>
> On Wed, 4 Dec 2002, Cameron S. Watters wrote:
>
>> Hello all,
>>
>> figured you could help.
>>
>> I keep getting this message when I try to make mod_python 3.0.1
>>
>> *** Warning: This library needs some functionality provided by
>> -lpython2.2.
>> *** I have the capability to make that library automatically link in
>> when
>> *** you link to this library.  But I can only do this if you have a
>> *** shared version of the library, which you do not appear to have.
>>
>> *** Warning: libtool could not satisfy all declared inter-library
>> *** dependencies of module mod_python.  Therefore, libtool will create
>> *** a static module, that should work as long as the dlopening
>> *** application is linked with the -dlopen flag.
>>
>> I installed apache 2.0.43 and python 2.2.2 from source on FreeBSD. I'm
>> explicitly passing --with-python and --with-apxs to the configure
>> script.
>>
>> Any help would be appreciated.
>>
>> --cameron
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://www.modpython.org/mailman/listinfo/mod_python
>>
>
>


From grisha at modpython.org  Wed Dec  4 19:34:39 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:53:16 2004
Subject: [mod_python] make problems
In-Reply-To: <D748DF36-07E6-11D7-83C3-00306599D91A@toolhouse.com>
Message-ID: <20021204192952.W41195-100000@eden.ispol.com>

No, shared lib is not required. I have Python 2.2.1 and apache 2.0.43
installed from ports on a FreeBSD 4.7-RELEASE-p1 box and mod_python
compiles just fine. There is no libpython2.2.so.

If your apache installation is not from ports, then another thing you
might try is to rebuild apache after running ./buildconf (then
./configure), then make. Apxs uses the libtool script that is packaged
with apache, and it in turn is created by ./buildconf, so it may have
something to do with that.

Grisha

On Wed, 4 Dec 2002, Cameron S. Watters wrote:

> > You don't mention your FreeBSD version, it's possible that you have a
> > really old libtool. Also make sure that Apache is compiled with
> > --enable-threads. See the FreeBSD section in mod_python README.
>
> FreeBSD 4.7-RELEASE
> libtool 1.3.4 (installed from ports)
>
> Thanks for the pointer to the FreeBSD note in the readme, I had missed
> it, BUT....
>
> I still get the same message after recompiling apache with the
> --enable-threads flag set. I think it has more to do with the fact that
> there isn't a libpython2.2.so built (as mentioned by
> gdamjan@mail.net.mk).
>
> I would suggest adding that either to the docs on the website (and to
> the README of future releases). The standard python built from source
> doesn't appear to do it for you and according to the python FAQ, item
> 3.30, Why is the Python interpreter not built as a shared library?, it
> won't until v2.3. If this IS required by mod_python, it should be at
> least given a mention, and optimally, there would be instructions about
> how to create it.
>
> > Grisha
> >
> > On Wed, 4 Dec 2002, Cameron S. Watters wrote:
> >
> >> Hello all,
> >>
> >> figured you could help.
> >>
> >> I keep getting this message when I try to make mod_python 3.0.1
> >>
> >> *** Warning: This library needs some functionality provided by
> >> -lpython2.2.
> >> *** I have the capability to make that library automatically link in
> >> when
> >> *** you link to this library.  But I can only do this if you have a
> >> *** shared version of the library, which you do not appear to have.
> >>
> >> *** Warning: libtool could not satisfy all declared inter-library
> >> *** dependencies of module mod_python.  Therefore, libtool will create
> >> *** a static module, that should work as long as the dlopening
> >> *** application is linked with the -dlopen flag.
> >>
> >> I installed apache 2.0.43 and python 2.2.2 from source on FreeBSD. I'm
> >> explicitly passing --with-python and --with-apxs to the configure
> >> script.
> >>
> >> Any help would be appreciated.
> >>
> >> --cameron
> >>
> >> _______________________________________________
> >> Mod_python mailing list
> >> Mod_python@modpython.org
> >> http://www.modpython.org/mailman/listinfo/mod_python
> >>
> >
> >
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From cameron at toolhouse.com  Wed Dec  4 17:43:16 2002
From: cameron at toolhouse.com (Cameron S. Watters)
Date: Fri Jan  9 21:53:16 2004
Subject: [mod_python] make problems
In-Reply-To: <20021204192952.W41195-100000@eden.ispol.com>
Message-ID: <EC6ED012-07F2-11D7-83C3-00306599D91A@toolhouse.com>

> No, shared lib is not required. I have Python 2.2.1 and apache 2.0.43
> installed from ports on a FreeBSD 4.7-RELEASE-p1 box and mod_python
> compiles just fine. There is no libpython2.2.so.
>
> If your apache installation is not from ports, then another thing you
> might try is to rebuild apache after running ./buildconf (then
> ./configure), then make. Apxs uses the libtool script that is packaged
> with apache, and it in turn is created by ./buildconf, so it may have
> something to do with that.

That worked.

./buildconf
./configure --a mass of configure options
make
make install

I will say that building libpython2.2.so also makes the error messages 
go away (not that that makes it the correct solution). Anybody want to 
comment on what difference it actually makes?

Thanks for your help.

--cameron


From nathanr at nathanr.net  Thu Dec  5 14:54:29 2002
From: nathanr at nathanr.net (Nathan Robertson)
Date: Fri Jan  9 21:53:16 2004
Subject: [mod_python] Embedded python support
Message-ID: <1039060470.334.8.camel@moosehead>

Hi,

Before mod_snake was killed, I quite liked its embedded python support.
As mod_snake is now dead, I've ported their epy modules to mod_python
and made them available. For those of you who aren't familiar with the
epy feature, it allows you to embed fragments of python into html code,
in the same way VBScript and JScript can be done in ASP, Java in JSP,
PHP in PHP (??), etc.

From jirka.machotka at seznam.cz  Thu Dec  5 12:18:05 2002
From: jirka.machotka at seznam.cz (=?iso-8859-2?Q?Jirka=20Machotka?=)
Date: Fri Jan  9 21:53:16 2004
Subject: [mod_python] =?iso-8859-2?Q?Problems=20with=20mptest=2Epy=20=28Windows=29?=
Message-ID: <3939.5433-10072-616945501-1039087085@seznam.cz>

Hello there,

I have probably a very basic question. However, I could not find
anything relevant (a searching machine would be fine)

I had had problems with running the mod_python for Apache 2.0.43.
Following the advice I had gotten the msvcr70.dll, put it to the
required directory and restarted the Apache. The Apache starts,
however, when I try to fetch mptest.py (it looks exactly as described
in the manual, the configuration file httpd has been modified
accordingly) I receive an error:

make_obcallback: could not import mod_python.apache

To my understanding the problem relates rather to Python (my version
is 2.2.1). The manual mentions that Python environment must be
recompiled, or what. I'm afraid that's not possible for me
(recompiled in what?) Or am I missing something inportant?


Please help. Thanks in advance.

Jiri

______________________________________________________________________
Reklama:
Sout?? o auto na v?kend, autor?dio Clarion a dal?? ceny: http://ad2.seznam.cz/redir.cgi?instance=12345%26url=http://www.auto-plus.cz
 - nejlep?? syst?m prodeje ojet?ch voz? na internetu


From gdamjan at mail.net.mk  Thu Dec  5 19:40:15 2002
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 21:53:17 2004
Subject: [mod_python] make problems
In-Reply-To: <EC6ED012-07F2-11D7-83C3-00306599D91A@toolhouse.com>
References: <20021204192952.W41195-100000@eden.ispol.com> <EC6ED012-07F2-11D7-83C3-00306599D91A@toolhouse.com>
Message-ID: <20021205184015.GA676@legolas.on.net.mk>

> 
> I will say that building libpython2.2.so also makes the error messages 
> go away (not that that makes it the correct solution). Anybody want to 
> comment on what difference it actually makes?

the presence of libpython2.2.so only allows the build proces to
continue, I can confirm that mod_python is STATICALLY linked with
libpython anyway. This seems like a problem with the build
enviroment, but I don't have enough knowledge to investigate it
any further.







-- 
Damjan Georgievski

From webmaster at obramaestraonline.com  Thu Dec  5 15:37:44 2002
From: webmaster at obramaestraonline.com (Rafael Fernandez)
Date: Fri Jan  9 21:53:17 2004
Subject: [mod_python] Apache1.3.27 with mod_python on Win 32?
Message-ID: <002001c29c95$d1db8540$f7383242@Family>

Is Apache 1.3.27 compatible with mod_python?

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20021205/982faa8f/attachment-0001.htm
From jirka.machotka at seznam.cz  Fri Dec  6 15:55:45 2002
From: jirka.machotka at seznam.cz (=?iso-8859-2?Q?Jirka=20Machotka?=)
Date: Fri Jan  9 21:53:17 2004
Subject: [mod_python] =?iso-8859-2?Q?Re=3A=20R=3A=20=5Bmod=5Fpython=5D=20Problems=20with=20mptest=2Epy=20=28Windows=29?=
In-Reply-To: <52DC70C1C1575C418CB033523A29CF140E0570@exchange2000.manord.com>
Message-ID: <2088.9028-27840-818706865-1039186545@seznam.cz>

Signore,

no comprendo italiano. 

The transaltion I got by AltaVista Babelfish:
and approximately the problem that it gave you? 

The problem is that I don't know what to do. It is obvious that there
is a problem to connect Apache with Python interpret or vice versa.
The question is whether the interpret is called at all (I guess it
is). If so, it seems it is not able to see imported objects enabling
passing the data from/to the Apache. In the manual there is no hint
how to proceed in this case even though I'm sure that everyone has to
go through this problem anyhow.


Dne 5.?prosinec?2002, Manera, Villiam, <vmanera@manord.com> napsal:

> e circa il problema che dava a te?
> 
> -----Messaggio originale-----
> Da: Jirka Machotka [mailto:jirka.machotka@seznam.cz]
> Inviato: giovedi 5 dicembre 2002 12.18
> A: mod_python@modpython.org
> Oggetto: [mod_python] Problems with mptest.py (Windows)
> 

______________________________________________________________________
Reklama:
Nokia 3410 za 4.577 Kc. Nejvyhodnejsi nabidka telefonu na trhu!
http://ad2.seznam.cz/redir.cgi?instance=38871%26url=http://www.oskarmobil.cz/handsets/handset.php


From mcassiano at manord.com  Fri Dec  6 18:19:09 2002
From: mcassiano at manord.com (Cassiano, Marco)
Date: Fri Jan  9 21:53:17 2004
Subject: [mod_python] Win32 : Can't locate API module structure `mod_python'
Message-ID: <52DC70C1C1575C418CB033523A29CF140B8D9B@exchange2000.manord.com>

Hello,

I'm using 
- Windows 2000 Server,
- Apache 2.0.43
- Active State active python 2.2.2
- mod_python 3.0.1 (I should put the mod_python-3.0.1\lib\python\mod_python
folder from the distribution into the c:\Python22\lib folder, right?)
- mod_python.so for activestate into the Apache modules folder. 
- I have also the msvcr70.dll into \winnt\system32.

When I try to start Apache it fails and I get the following error in the
registry : 

"Can't locate API module structure `mod_python' in file C:/Program
Files/Apache Group/Apache2/modules/mod_python.so: No error "

I read on the list that many of you, after the "msvcr70.dll" hint, succeeded
in making mod_python work.
What am I missing ?
Thank you!

> Marco Cassiano
> Resp. Reti e Sistemi
> 
> Manifatture del Nord srl
> viale Regina Elena 13-15
> 42100 Reggio Emilia RE
> ITALY
> 
> Tel. +39 0522 508206
> Fax +39 0522 514001
> email : mcassiano@manord.com
> www.pennyblack.com
> 
> 

From marius at netroedge.com  Fri Dec  6 11:21:22 2002
From: marius at netroedge.com (Marius Nita)
Date: Fri Jan  9 21:53:17 2004
Subject: [mod_python] dev list
Message-ID: <20021206192122.GC8713@netroedge.com>

hello,

i'm having trouble subscribing to the dev list, it seems. i never got
a confirmation message, nor any messages...

just wondering if anyone else has had problems with it.

marius

From jgarzon at indra.es  Mon Dec  9 10:46:42 2002
From: jgarzon at indra.es (Garzon Maldonado, Jesus Javier)
Date: Fri Jan  9 21:53:17 2004
Subject: [mod_python] Problem with --enable-threads
Message-ID: <C6A2439F4F6BE04CAF457A5E24A376FA3634D2@madtormail2.indra.es>

Hello all:

I'm trying to configure Apache 2.0.43+mod_ssl+mod_rewrite+php4.2.3+mod_python-3.0 beta4 on a FreeBSD 4.7 machine.
According to what is said in the documentation, mod_python needs apache configured with --enable-threads, so this is what I typed to configure the source code.
./configure --prefix=/usr/local/apache2 --enable-so --enable-ssl --enable-rewrite --enable-threads

This works and I can compile and install apache, but I cannot start it. When I type ./apachectl startssl (or just start) only one process is launched:
root   23785  0.0  0.9  7064 4836  ??  Is    3:19PM   0:00.01 /usr/local/apache2/bin/httpd -k start -DSSL

But this process doesn't work, (doesn't serve html pages), and cannot be killed with ./apachectl stop

However if I do:
./configure --prefix=/usr/local/apache2 --enable-so --enable-ssl --enable-rewrite

all works fine (though I cannot use mod_python).

What am I doing wrong?

Thanks.

Javi Garzon


From zoper at libero.it  Tue Dec 10 08:54:42 2002
From: zoper at libero.it (Zoper)
Date: Fri Jan  9 21:53:17 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
Message-ID: <002001c2a021$66b50720$1c291a97@sorpippo>

Hi All!

After making my mod_python I try to make install but...

...............CUT....................
Performing DSO installation.

/usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
/usr/bin/install: src/mod_python.so: No such file or directory
make[1]: *** [install_dso] Error 1
make[1]: Leaving directory `/usr/src/mod_python-3.0.1'
make: *** [install] Error 2
..........................................

What does it mean?

Regards.

Gius.


From nathanr at nathanr.net  Tue Dec 10 19:03:09 2002
From: nathanr at nathanr.net (Nathan Robertson)
Date: Fri Jan  9 21:53:17 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
In-Reply-To: <002001c2a021$66b50720$1c291a97@sorpippo>
References: <002001c2a021$66b50720$1c291a97@sorpippo>
Message-ID: <1039507390.8428.0.camel@moosehead>

On Tue, 2002-12-10 at 18:54, Zoper wrote:
> Hi All!
> 
> After making my mod_python I try to make install but...
> 
> ...............CUT....................
> Performing DSO installation.
> 
> /usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
> /usr/bin/install: src/mod_python.so: No such file or directory
> make[1]: *** [install_dso] Error 1
> make[1]: Leaving directory `/usr/src/mod_python-3.0.1'
> make: *** [install] Error 2
> ..........................................

I saw this today. Are you running RedHat 8.0?

Nathan.



From zoper at libero.it  Tue Dec 10 12:54:31 2002
From: zoper at libero.it (Zoper)
Date: Fri Jan  9 21:53:17 2004
Subject: [mod_python] mod_python 3.0.1: error after make install ---> Debian
References: <002001c2a021$66b50720$1c291a97@sorpippo> <1039507390.8428.0.camel@moosehead>
Message-ID: <001501c2a042$e99c1040$2c281a97@sorpippo>

----- Original Message -----
From: "Nathan Robertson" <nathanr@nathanr.net>
To: "Zoper" <zoper@libero.it>
Cc: "modpython" <mod_python@modpython.org>
Sent: Tuesday, December 10, 2002 9:03 AM
Subject: Re: [mod_python] mod_python 3.0.1: error after make install



> I saw this today. Are you running RedHat 8.0?

I'm running Debian 2.2 r5.
Have you any idea about this ugly message?
                /usr/bin/install: src/mod_python.so: No such file or
directory

Thanks a lot.

Giuseppe.


From i at mindlace.net  Tue Dec 10 08:59:06 2002
From: i at mindlace.net (emf)
Date: Fri Jan  9 21:53:17 2004
Subject: [mod_python] mod_python 3.0.1: error after make install --->
 Debian
In-Reply-To: <001501c2a042$e99c1040$2c281a97@sorpippo>
References: <002001c2a021$66b50720$1c291a97@sorpippo> <1039507390.8428.0.camel@moosehead> <001501c2a042$e99c1040$2c281a97@sorpippo>
Message-ID: <3DF5F32A.60005@mindlace.net>

Zoper wrote:

> I'm running Debian 2.2 r5.

You know, if you upgrade to a mixed testing/unstable distribution you 
can just

apt-get -t unstable install mod_python

(assuming you've already

apt-get -t unstable install apache2

)

See section 3.8 for more info:

http://www.debian.org/doc/manuals/apt-howto/ch-apt-get.en.html

~mindlace


From jayaare at earthlink.net  Tue Dec 10 10:56:03 2002
From: jayaare at earthlink.net (john riehl aka j.r.)
Date: Fri Jan  9 21:53:17 2004
Subject: [mod_python] [Fwd: suse 8.0 obcallback problem.]
Message-ID: <3DF638C3.6090508@earthlink.net>


-------- Original Message --------
Subject: suse 8.0 obcallback problem.
Date: Sun, 08 Dec 2002 21:45:51 -0800
From: john riehl aka j.r. <jayaare@earthlink.net>
To: mod_python@modpython.org

This is an informational item.  I want others to avoid the pain I had.
I was about to ask the list for help, when I solved the problem.

The system:  suse 8.0, patched, on intel xeon 2.0 ghz system
(hyperthreading).  apache 1.3.23-142, python-2.2-105,
mod_python-2.7.8-6, mod_ssl-2.8.7-110

The problem:
calling the hello world test script mptest returns an internal error 500
code, with the following messages:
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
[Sun Dec  8 20:57:06 2002] [error] [client 66.215.65.63] python_handler:
make_obcallback returned no obCallBack!

I tried all sorts of stuff, based on complaints/suggestions in web logs,
which made no effect (checking permissions, links from apache to
mod_python, setting PythonPath, PythonInterpreter, setting .htaccess).

The problem was a missing link, from the python libraries to the
mod_python libraries.  with the suse configuration, that means that
/usr/lib/python2.2/site-packages/mod_python should be a symbolic link
pointing to /usr/lib/apache/lib/python2.2/site-packages/mod_python.
To correct, go to /usr/lib/python2.2/site-packages/, and link it thusly:
ln -s /usr/lib/apache/lib/python2.2/site-packages/mod_python/ mod_python

none of the problems/solutions that I reviewed addressed this facet.

Hope it helps,

jr







From conrad at hep.caltech.edu  Tue Dec 10 11:19:16 2002
From: conrad at hep.caltech.edu (Conrad Steenberg)
Date: Fri Jan  9 21:53:17 2004
Subject: [mod_python] [Fwd: suse 8.0 obcallback problem.]
In-Reply-To: <3DF638C3.6090508@earthlink.net>
References: <3DF638C3.6090508@earthlink.net>
Message-ID: <1039547956.312.42.camel@heppc22.hep.caltech.edu>

Hi

Just to add to this: one way to diagnose module/library load problems
with mod_python in general is to strace a single-process apache server
e.g.:

strace /usr/sbin/httpd -X 2> error_log

You will see all the paths that apache/python tries to look for modules.

Cheers

COnrad

On Tue, 2002-12-10 at 10:56, john riehl aka j.r. wrote:
> -------- Original Message --------
> Subject: suse 8.0 obcallback problem.
> Date: Sun, 08 Dec 2002 21:45:51 -0800
> From: john riehl aka j.r. <jayaare@earthlink.net>
> To: mod_python@modpython.org
> 
> This is an informational item.  I want others to avoid the pain I had.
> I was about to ask the list for help, when I solved the problem.
> 
> The system:  suse 8.0, patched, on intel xeon 2.0 ghz system
> (hyperthreading).  apache 1.3.23-142, python-2.2-105,
> mod_python-2.7.8-6, mod_ssl-2.8.7-110
> 
> The problem:
> calling the hello world test script mptest returns an internal error 500
> code, with the following messages:
> make_obcallback(): could not import mod_python.apache.
> make_obcallback(): could not call init.
> [Sun Dec  8 20:57:06 2002] [error] [client 66.215.65.63] python_handler:
> make_obcallback returned no obCallBack!
> 
> I tried all sorts of stuff, based on complaints/suggestions in web logs,
> which made no effect (checking permissions, links from apache to
> mod_python, setting PythonPath, PythonInterpreter, setting .htaccess).
> 
> The problem was a missing link, from the python libraries to the
> mod_python libraries.  with the suse configuration, that means that
> /usr/lib/python2.2/site-packages/mod_python should be a symbolic link
> pointing to /usr/lib/apache/lib/python2.2/site-packages/mod_python.
> To correct, go to /usr/lib/python2.2/site-packages/, and link it thusly:
> ln -s /usr/lib/apache/lib/python2.2/site-packages/mod_python/ mod_python
> 
> none of the problems/solutions that I reviewed addressed this facet.
> 
> Hope it helps,
> 
> jr
> 
> 
> 
> 
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
-- 
Conrad Steenberg <conrad@hep.caltech.edu>


From vmanera at manord.com  Thu Dec 12 17:47:45 2002
From: vmanera at manord.com (Manera, Villiam)
Date: Fri Jan  9 21:53:17 2004
Subject: [mod_python] problem with file download in mod-python 3.0.1
Message-ID: <52DC70C1C1575C418CB033523A29CF14104883@exchange2000.manord.com>

I'm testing mod-python 3.0.1 with apache 2.0.43 and python 2.2.2

I've founded a older problem in file download (from python 2.1 to 2.2)

the workaround is still the same:

in publisher.py:

 class File:
     """ Like a file, but also has headers and filename
     """
     def __init__(self, field):
         # steal all the file-like methods
         for m in dir(field.file):            
		 self.__dict__[m] = getattr(field.file, m)
 
         self.headers = field.headers
         self.filename = field.filename
======================workaround
==============================================
 class File:
     """ Like a file, but also has headers and filename
     """
     def __init__(self, field):
         # steal all the file-like methods
         #for m in dir(field.file):    #dont' work
         for m in self.sim_methods(field.file):
             self.__dict__[m] = getattr(field.file, m)
 
         self.headers = field.headers
         self.filename = field.filename
    
	#new--------	
     def sim_methods(self,obj):
         from types import BuiltinMethodType   
         return filter(lambda s, t=obj:
            type(getattr(t, s)) == BuiltinMethodType, dir(obj))
 
 
I hope it will be put in place

regards

Villiam Manera

From brianh at exelixis.com  Thu Dec 12 11:26:42 2002
From: brianh at exelixis.com (Brian Hawthorne)
Date: Fri Jan  9 21:53:17 2004
Subject: [mod_python] problem with file download in mod-python 3.0.1
In-Reply-To: <52DC70C1C1575C418CB033523A29CF14104883@exchange2000.manord.com>
Message-ID: <Pine.GSO.4.05.10212121123570.4656-100000@timeless.exelixis.com>

i'm not sure what the point is of wrapping the field object like this.
why not just use the field object itself as the value for the file upload
arg?  i cut this part out of my publisher because it seemed unnecessary.

brian hawthorne


On Thu, 12 Dec 2002, Manera, Villiam wrote:

> I'm testing mod-python 3.0.1 with apache 2.0.43 and python 2.2.2
> 
> I've founded a older problem in file download (from python 2.1 to 2.2)
> 
> the workaround is still the same:
> 
> in publisher.py:
> 
>  class File:
>      """ Like a file, but also has headers and filename
>      """
>      def __init__(self, field):
>          # steal all the file-like methods
>          for m in dir(field.file):            
> 		 self.__dict__[m] = getattr(field.file, m)
>  
>          self.headers = field.headers
>          self.filename = field.filename
> ======================workaround
> ==============================================
>  class File:
>      """ Like a file, but also has headers and filename
>      """
>      def __init__(self, field):
>          # steal all the file-like methods
>          #for m in dir(field.file):    #dont' work
>          for m in self.sim_methods(field.file):
>              self.__dict__[m] = getattr(field.file, m)
>  
>          self.headers = field.headers
>          self.filename = field.filename
>     
> 	#new--------	
>      def sim_methods(self,obj):
>          from types import BuiltinMethodType   
>          return filter(lambda s, t=obj:
>             type(getattr(t, s)) == BuiltinMethodType, dir(obj))
>  
>  
> I hope it will be put in place
> 
> regards
> 
> Villiam Manera
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From listmail at xs4all.nl  Thu Dec 12 22:30:15 2002
From: listmail at xs4all.nl (bvr)
Date: Fri Jan  9 21:53:17 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
In-Reply-To: <002001c2a021$66b50720$1c291a97@sorpippo>
References: <002001c2a021$66b50720$1c291a97@sorpippo>
Message-ID: <3DF8FFE7.7070100@xs4all.nl>

Hi,

Same problem here, tried several installations with RH 7.3.

tried installing these:
python2-2.2-16.i386.rpm
python2-devel-2.2-16.i386.rpm
python2-docs-2.2-16.i386.rpm

and:
untar Python-2.2.2.tgz
configure --without-threads
make && make install

both with no errors, cli interpreter works fine

compiled mod python 3.0.1 like this:

configure --with-apxs=/usr/local/apache2/bin/apxs 
--with-python=/usr/local/bin/python2
make

everything looks fine untill I get these warnings at the end:

/usr/local/apache/build/libtool --silent --mode=link gcc -o 
mod_python.la -I/store/install/mod_python-3.0.1/src/include 
-I/usr/local/apache/include -I/usr/local/include/python2.2  -rpath 
/usr/local/apache/modules -module -avoid-version  hlistobject.lo 
hlist.lo filterobject.lo connobject.lo serverobject.lo util.lo 
tableobject.lo requestobject.lo _apachemodule.lo mod_python.lo 
-L/usr/local/lib/python2.2/config -Xlinker -export-dynamic -lm 
-lpython2.2 -ldl -lutil -lm

*** Warning: This library needs some functionality provided by -lpython2.2.
*** I have the capability to make that library automatically link in when
*** you link to this library.  But I can only do this if you have a
*** shared version of the library, which you do not appear to have.

*** Warning: libtool could not satisfy all declared inter-library
*** dependencies of module mod_python.  Therefore, libtool will create
*** a static module, that should work as long as the dlopening
*** application is linked with the -dlopen flag.

afterwards it appears src/mod_python.so has not been created.

my best guess is that i need a libpython2.2.so but i can't figure how
to get it ??


please help!

bvr.


Zoper wrote:
> Hi All!
> 
> After making my mod_python I try to make install but...
> 
> ...............CUT....................
> Performing DSO installation.
> 
> /usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
> /usr/bin/install: src/mod_python.so: No such file or directory
> make[1]: *** [install_dso] Error 1
> make[1]: Leaving directory `/usr/src/mod_python-3.0.1'
> make: *** [install] Error 2
> ..........................................


From grisha at modpython.org  Thu Dec 12 21:13:22 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:53:17 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
In-Reply-To: <3DF8FFE7.7070100@xs4all.nl>
Message-ID: <20021212211044.R53709-100000@eden.ispol.com>

You don't need without-threads when compiling python. I don't know if its
the cause of the problem, but it's a start. Also, make sure you have
libtool 1.4.x. Lastly, if you compiled your own apache, try recompiling it
by first running ./buildconf, then ./configure, etc.

On Thu, 12 Dec 2002, bvr wrote:

>
> Hi,
>
> Same problem here, tried several installations with RH 7.3.
>
> tried installing these:
> python2-2.2-16.i386.rpm
> python2-devel-2.2-16.i386.rpm
> python2-docs-2.2-16.i386.rpm
>
> and:
> untar Python-2.2.2.tgz
> configure --without-threads
> make && make install
>
> both with no errors, cli interpreter works fine
>
> compiled mod python 3.0.1 like this:
>
> configure --with-apxs=/usr/local/apache2/bin/apxs
> --with-python=/usr/local/bin/python2
> make
>
> everything looks fine untill I get these warnings at the end:
>
> /usr/local/apache/build/libtool --silent --mode=link gcc -o
> mod_python.la -I/store/install/mod_python-3.0.1/src/include
> -I/usr/local/apache/include -I/usr/local/include/python2.2  -rpath
> /usr/local/apache/modules -module -avoid-version  hlistobject.lo
> hlist.lo filterobject.lo connobject.lo serverobject.lo util.lo
> tableobject.lo requestobject.lo _apachemodule.lo mod_python.lo
> -L/usr/local/lib/python2.2/config -Xlinker -export-dynamic -lm
> -lpython2.2 -ldl -lutil -lm
>
> *** Warning: This library needs some functionality provided by -lpython2.2.
> *** I have the capability to make that library automatically link in when
> *** you link to this library.  But I can only do this if you have a
> *** shared version of the library, which you do not appear to have.
>
> *** Warning: libtool could not satisfy all declared inter-library
> *** dependencies of module mod_python.  Therefore, libtool will create
> *** a static module, that should work as long as the dlopening
> *** application is linked with the -dlopen flag.
>
> afterwards it appears src/mod_python.so has not been created.
>
> my best guess is that i need a libpython2.2.so but i can't figure how
> to get it ??
>
>
> please help!
>
> bvr.
>
>
> Zoper wrote:
> > Hi All!
> >
> > After making my mod_python I try to make install but...
> >
> > ...............CUT....................
> > Performing DSO installation.
> >
> > /usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
> > /usr/bin/install: src/mod_python.so: No such file or directory
> > make[1]: *** [install_dso] Error 1
> > make[1]: Leaving directory `/usr/src/mod_python-3.0.1'
> > make: *** [install] Error 2
> > ..........................................
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From vmanera at manord.com  Fri Dec 13 08:58:14 2002
From: vmanera at manord.com (Manera, Villiam)
Date: Fri Jan  9 21:53:17 2004
Subject: R: [mod_python] problem with file download in mod-python 3.0.1
Message-ID: <52DC70C1C1575C418CB033523A29CF140E0589@exchange2000.manord.com>

Ok, but on  Fri, 7 Jun 2002 Grisha wrote to me about this problem:

Yes, whatever free time I have I try to spend on the 3.0 version that will
run on Apache 2.0. Probably the simplest way to tackle this one is for
someone to add the publisher patch to the FAQ, at least for the time
being.

Grisha

So I hope that in mod-python 3.0.2 a patch for this problem will be added

Villiam Manera
-----Messaggio originale-----
Da: Brian Hawthorne [mailto:brianh@exelixis.com]
Inviato: gioved? 12 dicembre 2002 20.27
A: Manera, Villiam
Cc: Mod_python@modpython.org
Oggetto: Re: [mod_python] problem with file download in mod-python 3.0.1


i'm not sure what the point is of wrapping the field object like this.
why not just use the field object itself as the value for the file upload
arg?  i cut this part out of my publisher because it seemed unnecessary.

brian hawthorne


On Thu, 12 Dec 2002, Manera, Villiam wrote:

> I'm testing mod-python 3.0.1 with apache 2.0.43 and python 2.2.2
> 
> I've founded a older problem in file download (from python 2.1 to 2.2)
> 
> the workaround is still the same:
> 
> in publisher.py:
> 
>  class File:
>      """ Like a file, but also has headers and filename
>      """
>      def __init__(self, field):
>          # steal all the file-like methods
>          for m in dir(field.file):            
> 		 self.__dict__[m] = getattr(field.file, m)
>  
>          self.headers = field.headers
>          self.filename = field.filename
> ======================workaround
> ==============================================
>  class File:
>      """ Like a file, but also has headers and filename
>      """
>      def __init__(self, field):
>          # steal all the file-like methods
>          #for m in dir(field.file):    #dont' work
>          for m in self.sim_methods(field.file):
>              self.__dict__[m] = getattr(field.file, m)
>  
>          self.headers = field.headers
>          self.filename = field.filename
>     
> 	#new--------	
>      def sim_methods(self,obj):
>          from types import BuiltinMethodType   
>          return filter(lambda s, t=obj:
>             type(getattr(t, s)) == BuiltinMethodType, dir(obj))
>  
>  
> I hope it will be put in place
> 
> regards
> 
> Villiam Manera
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From fuf at mobil.cz  Fri Dec 13 09:10:35 2002
From: fuf at mobil.cz (Michal Vitecek)
Date: Fri Jan  9 21:53:17 2004
Subject: [mod_python] problem with file download in mod-python 3.0.1
In-Reply-To: <52DC70C1C1575C418CB033523A29CF14104883@exchange2000.manord.com>
References: <52DC70C1C1575C418CB033523A29CF14104883@exchange2000.manord.com>
Message-ID: <20021213081034.GA5296@diana.mobil.cz>

Manera, Villiam wrote:

[snip]

>     def sim_methods(self,obj):
>         from types import BuiltinMethodType   
>         return filter(lambda s, t=obj:
>            type(getattr(t, s)) == BuiltinMethodType, dir(obj))

 I just wanted to say that code using lambda functions is considerably
 slower than when it uses list comprehensions. thus the above is faster
 with:
    
    def sim_methods(self, obj):
	from types import BuiltinMethodType
	return [attribute for attribute in dir(obj) if (type(getattr(obj,
		attribute)) == BuiltinMethodType)]

-- 
		fuf		(fuf@mobil.cz)

From listmail at xs4all.nl  Sat Dec 14 00:09:57 2002
From: listmail at xs4all.nl (baz)
Date: Fri Jan  9 21:53:17 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
In-Reply-To: <20021212211044.R53709-100000@eden.ispol.com>
References: <20021212211044.R53709-100000@eden.ispol.com>
Message-ID: <3DFA68C5.5070806@xs4all.nl>

thanks for the input, but..

did try without the without-threads before,
but had the same problem.

using this rpm version of libtool
libtool-libs-1.4.2-7
libtool-1.4.2-7

tried buildconf for apache, didn't change the problem at all

my questions are: is there such a thing as a libpython.so for python 2.2 
? if so, how would i normally produce this file ?

really hoped i could've made some progress on this issue, really want to 
move on to actually programming something .. ;)

grtz,
baz.

Gregory (Grisha) Trubetskoy wrote:
> You don't need without-threads when compiling python. I don't know if its
> the cause of the problem, but it's a start. Also, make sure you have
> libtool 1.4.x. Lastly, if you compiled your own apache, try recompiling it
> by first running ./buildconf, then ./configure, etc.
> 
> On Thu, 12 Dec 2002, bvr wrote:
>>Hi,
>>
>>Same problem here, tried several installations running RH 7.3.


From geertj at boskant.nl  Sun Dec 15 19:39:09 2002
From: geertj at boskant.nl (Geert Jansen)
Date: Fri Jan  9 21:53:17 2004
Subject: [mod_python] Annouce: Draco dynamic content system
Message-ID: <20021215183909.GD8533@vader.boskant.nl>

Hello fellow Pythoneers,

I'd like to announce the free availability of my latest mod_python project
to the list: the Draco dynamic content system.

Draco is a framework for creating dynamic web sites and and web applications.

What I like about Draco is that it is structured around a nice paradigm for a
clean separation of code (Python) and markup (html). Program code in Draco is
split in two parts: program logic and markup logic. Program logic is put in
the so-called handlers.  These handlers process the user's request and put the
result in a namespace called the interface. On the other hand, markup logic is
put in a template. The template is a regular template as seen in many dynamic
content systems but its task in Draco is much more limited. It should only
format the data in the interface in the html and nothing more.

Draco offers a large standard library with functionality that is often used in
dynamic web sites. This includes: automated session management, a limited form
of user management, easy form parsing and feedback, events, task scheduling (no
more cron!) and tag rewriting.

Draco is freely available under the GPL. More information can be found on
the Draco website at http://draco.boskant.nl/.

Thanks,
Geert Jansen

From jirka.machotka at seznam.cz  Sun Dec 15 21:04:20 2002
From: jirka.machotka at seznam.cz (=?iso-8859-2?Q?Jirka=20Machotka?=)
Date: Fri Jan  9 21:53:17 2004
Subject: [mod_python] =?iso-8859-2?Q?Re=3A=20R=3A=20=5Bmod=5Fpython=5D=20Problems=20with=20mptest=2Epy=20=28Windows=29?=
In-Reply-To: <52DC70C1C1575C418CB033523A29CF140E0570@exchange2000.manord.com>
Message-ID: <3912.4583-28975-439333470-1039982660@seznam.cz>

This is an informational issue covering somehow the solution to my
problem. It sums up few other answers - thanx for all of them! - and
as such it should be a simple handy to anyone who wants to run the
Apache with mod_python on Windows. I'd love to have something like
that a month ago (it'd spare me from few white hairs by now)

1. if you install the Apache and you want to connact it to the python
interpret all you need is a file called mod_python.so

Put it to the /modules subdirectory and add the line
   LoadModule python_module modules/mod_python.so 
to the httpd.conf

Restart the Apache server. If you get an error (cannot load
C:\...\modules\mod_python.so into server: the module could not be
found ) you need to get a file called msvcr70.dll (e.g. from
www.dll-files.com/dllindex/dll-files.shtml?msvcr70) and copy it into
\winnt\system32 (thanx to Duncan Booth for this hint). Do not forget
to restart the Apache when it's done.

This and the modification of httpd.conf file as described in the
manual should be enough so that the Apache sends all the file with
*.py extension to be processed by python

2. in order to be able to use Apache related objects in python you
need also their sources. Get the mod_python-3.0.1.tgz file, unpack
it, find the subdirectory called \site-packages and copy it into the
subdirectory of the same name of your Python installation. I know it
sounds obvious for anyone who knows about it, but honestly I could
not get this point from the manual. 

If you don't do it you will face the same problems as I did (just
scroll below for details)


Dne 5.?prosinec?2002, Manera, Villiam, <vmanera@manord.com> napsal:

> e circa il problema che dava a te?
> 
> -----Messaggio originale-----
> Da: Jirka Machotka [mailto:jirka.machotka@seznam.cz]
> Inviato: giovedi 5 dicembre 2002 12.18
> A: mod_python@modpython.org
> Oggetto: [mod_python] Problems with mptest.py (Windows)
> 
> 
> Hello there,
> 
> I have probably a very basic question. However, I could not find
> anything relevant (a searching machine would be fine)
> 
> I had had problems with running the mod_python for Apache 2.0.43.
> Following the advice I had gotten the msvcr70.dll, put it to the
> required directory and restarted the Apache. The Apache starts,
> however, when I try to fetch mptest.py (it looks exactly as described
> in the manual, the configuration file httpd has been modified
> accordingly) I receive an error:
> 
> make_obcallback: could not import mod_python.apache
> 
> To my understanding the problem relates rather to Python (my version
> is 2.2.1). The manual mentions that Python environment must be
> recompiled, or what. I'm afraid that's not possible for me
> (recompiled in what?) Or am I missing something inportant?
> 
> 
> Please help. Thanks in advance.
> 
> Jiri
> 
> ______________________________________________________________________
> Reklama:
> Sout?? o auto na v?kend, autor?dio Clarion a dal?? ceny:
> http://ad2.seznam.cz/redir.cgi?instance=12345%26url=http://www.auto-plus.cz
>  - nejlep?? syst?m prodeje ojet?ch voz? na internetu
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 

______________________________________________________________________
Reklama:
Vyhrajte cenu za 100.000,- Kc v soute?i "Svetem Financ?
za 30 dn?" na http://soutez.finance.cz. Ne? V?s predbehnou jin?!


From jw9 at softhome.net  Sun Dec 15 16:44:56 2002
From: jw9 at softhome.net (jw9@softhome.net)
Date: Fri Jan  9 21:53:17 2004
Subject: [mod_python] How to use CGI handler?
Message-ID: <000901c2a483$39291560$4b00a8c0@laptop>

I got a big python CGI script which I would like to rewrite using
mod_python. In the meanwhile, I want to try CGI handler.

Did a simple test using CGI handler, doesn't work well. Here is my config
files, all my scripts are in cgi-bin folder:

httpd.conf:
.......
<Directory "D:/Apache2/cgi-bin">
AddHandler python-program .py
AllowOverride All
PythonDebug ON
</Directory>

.htaccess file under D:/Apache2/cgi-bin:
***********************
SetHandler python-program
PythonHandler mod_python.cgihandler

very simple test script:
***********************
print 'Content-type: text/html\n'
print 'Hello World!'


result:
***********************
Mod_python error: "PythonHandler mod_python.cgihandler" Traceback (most
recent call last): File "D:\PYTHON22\Lib\mod_python\apache.py", line 335, in
HandlerDispatch result = object(req) File
"D:\PYTHON22\Lib\mod_python\cgihandler.py", line 140, in handler
apache.restore_nocgi(env, si, so) File
"D:\PYTHON22\Lib\mod_python\apache.py", line 764, in restore_nocgi for k in
osenv: RuntimeError: dictionary changed size during iteration

I don't what is wrong.  Anybody have the same experience? By the way, the
mptest.py worked, so I guess at least the installation was succesful.

Thanks!


From sebastian.tusk at gmx.net  Sun Dec 15 23:09:02 2002
From: sebastian.tusk at gmx.net (Sebastian Tusk)
Date: Fri Jan  9 21:53:17 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
In-Reply-To: <3DFA68C5.5070806@xs4all.nl>
References: <20021212211044.R53709-100000@eden.ispol.com> <3DFA68C5.5070806@xs4all.nl>
Message-ID: <3DFCFD7E.7000105@gmx.net>

 > *** Warning: This library needs some functionality provided by
 > -lpython2.2.
 > *** I have the capability to make that library automatically link in
 > when
 > *** you link to this library.  But I can only do this if you have a
 > *** shared version of the library, which you do not appear to have.

The problem is that apache 2 comes with an old version of libtool and 
uses that. mod_python uses via apxs the same outdated version. So you 
need to replace libtool in the apache 2 source distribution and rebuild 
apache and then rebuild mod_python. At least that works for me.

Sebastian



From geo at overweb.it  Mon Dec 16 17:42:50 2002
From: geo at overweb.it (Geo)
Date: Fri Jan  9 21:53:17 2004
Subject: [mod_python] Different PythonHander
Message-ID: <1040056970.3dfe028ae35eb@phpgroupware.overweb.it>

How can I set httpd.conf to have a different PythonHandler
for each user?

I need something like this:

<Directory "/usr/home/*/public_html">
      AddHandler python-program .py
      PythonHandler mptest
      PythonDebug on
</Directory>

Thanks

-- 
Gerolamo Valcamonica

From zoper at libero.it  Tue Dec 17 13:40:04 2002
From: zoper at libero.it (Zoper)
Date: Fri Jan  9 21:53:17 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
References: <20021212211044.R53709-100000@eden.ispol.com> <3DFA68C5.5070806@xs4all.nl> <3DFCFD7E.7000105@gmx.net>
Message-ID: <001e01c2a5c9$91e4dda0$c4281a97@sorpippo>

Hi All.

> The problem is that apache 2 comes with an old version of libtool and 
> uses that. mod_python uses via apxs the same outdated version. So you 
> need to replace libtool in the apache 2 source distribution and rebuild 
> apache and then rebuild mod_python. At least that works for me.

How can I replace libtool in the apache 2 source distribution?

Is this the right way to preceed?

tar xvfz libtool-1.4.2.tar.gz
cd libtool-1.4.2 
./configure --prefix=/usr
make
make install 

and then 

cd httpd-2.0.39 
./configure 
make ; make install


Thanks in advance.


Gius.



From sebastian.tusk at gmx.net  Tue Dec 17 13:50:26 2002
From: sebastian.tusk at gmx.net (Sebastian Tusk)
Date: Fri Jan  9 21:53:17 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
In-Reply-To: <001e01c2a5c9$91e4dda0$c4281a97@sorpippo>
References: <20021212211044.R53709-100000@eden.ispol.com> <3DFA68C5.5070806@xs4all.nl> <3DFCFD7E.7000105@gmx.net> <001e01c2a5c9$91e4dda0$c4281a97@sorpippo>
Message-ID: <3DFF1D92.1010204@gmx.net>

> How can I replace libtool in the apache 2 source distribution?
> 
> Is this the right way to preceed?
> 
> tar xvfz libtool-1.4.2.tar.gz
> cd libtool-1.4.2 
> ./configure --prefix=/usr
> make
> make install 
> 
> and then 
> 
> cd httpd-2.0.39 
> ./configure 
> make ; make install

That will not work. Apache comes with its own libtool. Replace 
httpd-2.0.43/srclib/apr/libtool with that from your system (e.g. 
/usr/local/bin/libtool) Then rebuild apache and mod_python.

Sebastian


From grisha at modpython.org  Tue Dec 17 10:08:57 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:53:17 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
In-Reply-To: <001e01c2a5c9$91e4dda0$c4281a97@sorpippo>
Message-ID: <20021217100543.X15809-100000@eden.ispol.com>

You can replace the libtool apache comes with by running ./buildconf just
before running apache's ./configure. Among other things, ./buildconf takes
the libtool on the system and incorporates it into apache. I think what's
happening is 2.0.43 in particular came bundled with an outdated libtool by
mistake.

Grisha

On Tue, 17 Dec 2002, Zoper wrote:

> Hi All.
>
> > The problem is that apache 2 comes with an old version of libtool and
> > uses that. mod_python uses via apxs the same outdated version. So you
> > need to replace libtool in the apache 2 source distribution and rebuild
> > apache and then rebuild mod_python. At least that works for me.
>
> How can I replace libtool in the apache 2 source distribution?
>
> Is this the right way to preceed?
>
> tar xvfz libtool-1.4.2.tar.gz
> cd libtool-1.4.2
> ./configure --prefix=/usr
> make
> make install
>
> and then
>
> cd httpd-2.0.39
> ./configure
> make ; make install
>
>
> Thanks in advance.
>
>
> Gius.
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From grisha at modpython.org  Tue Dec 17 16:30:53 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:53:17 2004
Subject: [mod_python] bug/misfeature in publisher/mod_python
In-Reply-To: <20021203151244.GB16590@legolas.on.net.mk>
Message-ID: <20021217162845.N19724-100000@eden.ispol.com>

On Tue, 3 Dec 2002, Damjan wrote:

> My setup:
>  apache 2.0.43, mod_python 3.0.1, python 2.2.1
>
> httpd.conf:
> <Directory /home/www/htdocs> # The root of the web server
> ...
>     SetHandler python-program
>     PythonHandler mod_python.publisher | .py
>     PythonDebug On
> </Directory>
> ...
>
> I expect this setup to handle all files ending in ".py" through
> the publisher handler.
>
> I have the script "hello.py" from the mod_python manual in the root of the
> web-server. Trying to get "http://127.1/hello.py/say" mod_python
> throws an exception (traceback atached).
>
> The exception is: "ImportError: No module named py"

But http://127.1/hello/say (without .py) should work.

(I still agree that this is a problem, just wanted to point out that there
is one way to make it work)

Grisha



From listmail at xs4all.nl  Wed Dec 18 00:11:46 2002
From: listmail at xs4all.nl (baz)
Date: Fri Jan  9 21:53:17 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
In-Reply-To: <002001c2a021$66b50720$1c291a97@sorpippo>
References: <002001c2a021$66b50720$1c291a97@sorpippo>
Message-ID: <3DFFAF32.1010600@xs4all.nl>

i solved my problem, maybe you've got the same so check this:

try
# locate libpython2.2.so

if nothing comes up you don't have the python shared library, which is 
needed by mod python.

i used the following commands to build it from source and install it:

cd Python-2.2.2/
make distclean
./configure
make OPT="-fpic -O2"
mkdir .extract
(cd .extract; ar xv ../libpython2.2.a)
gcc -shared -o libpython2.2.so .extract/*.o
rm -rf .extract
make install

or you may install the separate debian package for this file

have fun!

baz.

Zoper wrote:
> Hi All!
> 
> After making my mod_python I try to make install but...
> 
> ...............CUT....................
> Performing DSO installation.
> 
> /usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
> /usr/bin/install: src/mod_python.so: No such file or directory
> make[1]: *** [install_dso] Error 1
> make[1]: Leaving directory `/usr/src/mod_python-3.0.1'
> make: *** [install] Error 2
> ..........................................
> 


From zoper at libero.it  Wed Dec 18 17:06:23 2002
From: zoper at libero.it (Zoper)
Date: Fri Jan  9 21:53:17 2004
Subject: [mod_python] mod_python 3.0.1: problem with libtool and apache
Message-ID: <001301c2a6af$6cbfec40$602b1a97@sorpippo>

Hi All.

Thanks a lot for the previous answers.
I replaced the old libtool apache come with, but when I make apache I obtain
an ugly message...

libtool: link: cannot find the library `'
make[1]: *** [httpd] Error 1
make[1]: Leaving directory `/usr/src/httpd-2.0.43'
make: *** [all-recursive] Error 1

What does it mean?

Thanks in advance.

Gius.


From webmaster at obramaestraonline.com  Wed Dec 18 13:26:37 2002
From: webmaster at obramaestraonline.com (Rafael Fernandez)
Date: Fri Jan  9 21:53:17 2004
Subject: [mod_python] mod_python in Win32, Apache 2.0.43
Message-ID: <002d01c2a6ba$c8321b10$cc393242@Family>

Can somebody send me the code for running mod_python in Apache 2.0.43 in
the Win32 Platform?

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20021218/dac86ef0/attachment-0001.htm
From grisha at modpython.org  Wed Dec 18 15:08:13 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:53:18 2004
Subject: [mod_python] bug/misfeature in publisher/mod_python
In-Reply-To: <20021217162845.N19724-100000@eden.ispol.com>
Message-ID: <20021218150543.C29444-100000@eden.ispol.com>

I take it back, what I said below isn't true, it won't work :)

But I did patch up the latest CVS code so that it addresses this issue.

Grisha

On Tue, 17 Dec 2002, Gregory (Grisha) Trubetskoy wrote:

>
> On Tue, 3 Dec 2002, Damjan wrote:
>
> > My setup:
> >  apache 2.0.43, mod_python 3.0.1, python 2.2.1
> >
> > httpd.conf:
> > <Directory /home/www/htdocs> # The root of the web server
> > ...
> >     SetHandler python-program
> >     PythonHandler mod_python.publisher | .py
> >     PythonDebug On
> > </Directory>
> > ...
> >
> > I expect this setup to handle all files ending in ".py" through
> > the publisher handler.
> >
> > I have the script "hello.py" from the mod_python manual in the root of the
> > web-server. Trying to get "http://127.1/hello.py/say" mod_python
> > throws an exception (traceback atached).
> >
> > The exception is: "ImportError: No module named py"
>
> But http://127.1/hello/say (without .py) should work.
>
> (I still agree that this is a problem, just wanted to point out that there
> is one way to make it work)
>
> Grisha
>
>
>


From cameron at toolhouse.com  Wed Dec 18 14:28:52 2002
From: cameron at toolhouse.com (Cameron S. Watters)
Date: Fri Jan  9 21:53:18 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
In-Reply-To: <3DFFAF32.1010600@xs4all.nl>
Message-ID: <16154ED8-12D8-11D7-979F-00306599D91A@toolhouse.com>

Since I posted almost EXACTLY the same comment as the quoted one on 
December 4th, I thought I'd reply.

My understanding is that this shouldn't be necessary, but is, in fact, 
an issue with the version of libtool supplied with apache.

I was able to fix my problem by building apache from source by running:

tar -xzvf apache-tarball.tgz
cd apache-src-dir/
./buildconf
./configure --a mass of configure options
make
make install

you probably want to make sure you have a newish libtool installed 
BEFORE you do the above.

this made it stop freaking out because it couldn't find a 
libpython2.2.so. It is also my understanding that building libpython2.2 
doesn't actually do anything other than fool
the install portion of the build into continuing with the process and 
not erroring out.

I mention this mostly because this may NOT, in fact, be the most 
correct solution to this problem.

--cameron

> i solved my problem, maybe you've got the same so check this:
>
> try
> # locate libpython2.2.so
>
> if nothing comes up you don't have the python shared library, which is 
> needed by mod python.
>
> i used the following commands to build it from source and install it:
>
> cd Python-2.2.2/
> make distclean
> ./configure
> make OPT="-fpic -O2"
> mkdir .extract
> (cd .extract; ar xv ../libpython2.2.a)
> gcc -shared -o libpython2.2.so .extract/*.o
> rm -rf .extract
> make install
>
> or you may install the separate debian package for this file
>
> have fun!
>
> baz.
>
> Zoper wrote:
>> Hi All!
>> After making my mod_python I try to make install but...
>> ...............CUT....................
>> Performing DSO installation.
>> /usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
>> /usr/bin/install: src/mod_python.so: No such file or directory
>> make[1]: *** [install_dso] Error 1
>> make[1]: Leaving directory `/usr/src/mod_python-3.0.1'
>> make: *** [install] Error 2
>> ..........................................
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From gnb at itga.com.au  Thu Dec 19 18:27:04 2002
From: gnb at itga.com.au (Gregory Bond)
Date: Fri Jan  9 21:53:18 2004
Subject: [mod_python] import mod_puthon.util fails
Message-ID: <200212190727.SAA10103@lightning.itga.com.au>

[I'm brand new to mod_python and this list....]

FreeBSD 4-Stable (as of the other day, so it's after 4.7)

Apache 2.0.43, built from the FreeBSD port, with USE_THREADS

mod_python 3.0.1, built using "./configure && make"

hellcat$ python -c "import mod_python.util"
Traceback (most recent call last):
  File "<string>", line 1, in ?
  File "/usr/local/lib/python2.2/site-packages/mod_python/util.py", line 58, in ?
    import _apache
ImportError: No module named _apache
hellcat$ 

And indeed there is nothing that looks like _apache.so.  There is a src/
_apachemodule.c, which is compiled and linked into mod_python.so, which has 
what seems to be the intended contents of the _apache module, but this is 
never turned into the appropriate .so file.

Am I doing something wrong?



From zoper at libero.it  Thu Dec 19 15:53:53 2002
From: zoper at libero.it (Zoper)
Date: Fri Jan  9 21:53:18 2004
Subject: [mod_python] mod_python 3.0.1: problem with libtool and apache
Message-ID: <004e01c2a76e$74dbd3c0$022b1a97@sorpippo>

Hi All.

Thanks a lot for the previous answers.
I replaced the old libtool apache come with, but when I make apache I obtain
an ugly message...

libtool: link: cannot find the library `'
make[1]: *** [httpd] Error 1
make[1]: Leaving directory `/usr/src/httpd-2.0.43'
make: *** [all-recursive] Error 1

What does it mean?

Thanks in advance.

Gius.


From zoper at libero.it  Thu Dec 19 15:57:26 2002
From: zoper at libero.it (Zoper)
Date: Fri Jan  9 21:53:18 2004
Subject: [mod_python] mod_python 3.0.1: problem with libtool and apache
Message-ID: <006f01c2a76e$f2cda600$022b1a97@sorpippo>

Hi All.

Thanks a lot for the previous answers.
I replaced the old libtool apache come with, but when I make apache I obtain
an ugly message...

libtool: link: cannot find the library `'
make[1]: *** [httpd] Error 1
make[1]: Leaving directory `/usr/src/httpd-2.0.43'
make: *** [all-recursive] Error 1

What does it mean?

Thanks in advance.

Gius.


From grisha at modpython.org  Thu Dec 19 10:24:45 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:53:18 2004
Subject: [mod_python] import mod_puthon.util fails
In-Reply-To: <200212190727.SAA10103@lightning.itga.com.au>
Message-ID: <20021219102330.X43686-100000@eden.ispol.com>

No, you're not doing anything wrong, _apache is only available when
mod_python is loaded as an apache module, you can't really use any of
those modules from the command line.

On Thu, 19 Dec 2002, Gregory Bond wrote:

> [I'm brand new to mod_python and this list....]
>
> FreeBSD 4-Stable (as of the other day, so it's after 4.7)
>
> Apache 2.0.43, built from the FreeBSD port, with USE_THREADS
>
> mod_python 3.0.1, built using "./configure && make"
>
> hellcat$ python -c "import mod_python.util"
> Traceback (most recent call last):
>   File "<string>", line 1, in ?
>   File "/usr/local/lib/python2.2/site-packages/mod_python/util.py", line 58, in ?
>     import _apache
> ImportError: No module named _apache
> hellcat$
>
> And indeed there is nothing that looks like _apache.so.  There is a src/
> _apachemodule.c, which is compiled and linked into mod_python.so, which has
> what seems to be the intended contents of the _apache module, but this is
> never turned into the appropriate .so file.
>
> Am I doing something wrong?
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From sebastian.tusk at gmx.net  Thu Dec 19 20:15:12 2002
From: sebastian.tusk at gmx.net (Sebastian Tusk)
Date: Fri Jan  9 21:53:18 2004
Subject: [mod_python] AddOutputFilterByType not working
Message-ID: <3E021AC0.4010504@gmx.net>

The apache directive AddOutputFilterByType doesn't work for content 
generated by mod_python. The reason for this is the following line in 
requestobject.c

self->request_rec->content_type =
     apr_pstrdup(self->request_rec->pool, PyString_AsString(val));

which should read

ap_set_content_type(self->request_rec, PyString_AsString(val));


Sebastian


From gnb at itga.com.au  Fri Dec 20 09:28:58 2002
From: gnb at itga.com.au (Gregory Bond)
Date: Fri Jan  9 21:53:18 2004
Subject: [mod_python] import mod_puthon.util fails 
In-Reply-To: Your message of Thu, 19 Dec 2002 10:24:45 -0500.
Message-ID: <200212192228.JAA12799@lightning.itga.com.au>

>No, you're not doing anything wrong, _apache is only available when
>mod_python is loaded as an apache module, you can't really use any of
>those modules from the command line.

<lightbulb>Aha!</lightbulb>

Thanks.  I've submited an FAQ update.  [That faq wizard is kewl]



From gnb at itga.com.au  Fri Dec 20 17:33:18 2002
From: gnb at itga.com.au (Gregory Bond)
Date: Fri Jan  9 21:53:18 2004
Subject: [mod_python] cgi handler bug?
Message-ID: <200212200633.RAA17433@lightning.itga.com.au>

[FreeBSD 4.7, python 2.2.2, Apache 2.0.43, mod_python 3.0.1]

When I try and run something using cgihandler, I get the following error:

[Fri Dec 20 16:54:25 2002] [error] [client 192.168.71.163] PythonHandler mod_python.cgihandler:   File "/usr/local/lib/python2.2/site-packages/mod_python/apache.py", line 764, in restore_nocgi
    for k in osenv:
[Fri Dec 20 16:54:25 2002] [error] [client 192.168.71.163] PythonHandler mod_python.cgihandler: RuntimeError: dictionary changed size during iteration

Looking at mod_python/apache.py:restore_nocgi(), this does:
    for k in osenv:
        del osenv[k]

This is never going to be legal in Python 2.2.  Shouldn't this be 

    for k in osenv.keys():
        del osenv[k]

?

Having made that change, and a few little fixes to the cgi program, (__name__
== "__main__" is no longer true, "foo-bar.py" is not a good name as "import
foo-bar" is a syntax error) my cgi now runs inside mod_python.  But the HTML
generated by the CGI is sent twice, so my page displays double.  I've added 
debugging and the HTML is only being sent from the script once, as far as I 
can tell.  (i.e. I print a string of length 2132 bytes, but View Page Info 
shows 4215 bytes.   No, I have no idea where the missing 49 bytes are!)

Any clues?

Greg.



From grisha at modpython.org  Fri Dec 20 16:34:37 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:53:18 2004
Subject: [mod_python] problem with file download in mod-python 3.0.1
In-Reply-To: <52DC70C1C1575C418CB033523A29CF14104883@exchange2000.manord.com>
Message-ID: <20021220151113.I61260-100000@eden.ispol.com>

I must be missing something obvious, but without testing it and just by
looking at the code, I'm not sure I understand what the benefit is of
filtering out BuiltinMethodType, as opposed to just using straight
dir(obj).

The above might be a moot point since just as Brian Hawthorne suggested
I'm not sure why we don't need the File class at all and am in the process
of trying to fish out any memories from my tired brain about how it came
about in the fist place....

Grisha

On Thu, 12 Dec 2002, Manera, Villiam wrote:

> I'm testing mod-python 3.0.1 with apache 2.0.43 and python 2.2.2
>
> I've founded a older problem in file download (from python 2.1 to 2.2)
>
> the workaround is still the same:
>
> in publisher.py:
>
>  class File:
>      """ Like a file, but also has headers and filename
>      """
>      def __init__(self, field):
>          # steal all the file-like methods
>          for m in dir(field.file):
> 		 self.__dict__[m] = getattr(field.file, m)
>
>          self.headers = field.headers
>          self.filename = field.filename
> ======================workaround
> ==============================================
>  class File:
>      """ Like a file, but also has headers and filename
>      """
>      def __init__(self, field):
>          # steal all the file-like methods
>          #for m in dir(field.file):    #dont' work
>          for m in self.sim_methods(field.file):
>              self.__dict__[m] = getattr(field.file, m)
>
>          self.headers = field.headers
>          self.filename = field.filename
>
> 	#new--------
>      def sim_methods(self,obj):
>          from types import BuiltinMethodType
>          return filter(lambda s, t=obj:
>             type(getattr(t, s)) == BuiltinMethodType, dir(obj))
>
>
> I hope it will be put in place
>
> regards
>
> Villiam Manera
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>




From LBerezhny at DevIS.com  Sat Dec 21 20:53:41 2002
From: LBerezhny at DevIS.com (Lex Berezhny)
Date: Fri Jan  9 21:53:18 2004
Subject: [mod_python] installation problems
Message-ID: <1040522021.12314.421.camel@hortus>

hi all,

  I'm having trouble installing mod_python.

My environment:
Red Hat Linux release 7.3
gcc 2.96


My install process:

wget http://www.apache.org/dist/httpd/httpd-2.0.43.tar.gz
tar xzvf httpd-2.0.43.tar.gz
wget http://apache.webmeta.com/dist/httpd/modpython/mod_python-3.0.1.tgz
tar xzvf mod_python-3.0.1.tgz
wget http://www.python.org/ftp/python/2.2.2/Python-2.2.2.tgz
tar xzvf Python-2.2.2.tgz

cd httpd-2.0.43
./configure --prefix=/usr/local/apache2
make
make install 

cd ../Python-2.2.2/
./configure
make
make install

cd ../mod_python-3.0.1/
./configure --with-apxs=/usr/local/apache2/bin/apxs
--with-python=/usr/local/bin/python2.2
make
make install


Warning messages I get (during make):

*** Warning: This library needs some functionality provided by
-lpython2.2.
*** I have the capability to make that library automatically link in
when
*** you link to this library.  But I can only do this if you have a
*** shared version of the library, which you do not appear to have.

*** Warning: libtool could not satisfy all declared inter-library
*** dependencies of module mod_python.  Therefore, libtool will create
*** a static module, that should work as long as the dlopening
*** application is linked with the -dlopen flag.


The final, fatal, error (during make install):

make[2]: Leaving directory
`/usr/local/apache2install/mod_python-3.0.1/src'

Performing DSO installation.

/usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
/usr/bin/install: cannot stat `src/mod_python.so': No such file or
directory
make[1]: *** [install_dso] Error 1
make[1]: Leaving directory `/usr/local/apache2install/mod_python-3.0.1'
make: *** [install] Error 2




any help or pointers would be greatly appreciated,

 - lex


From grisha at modpython.org  Sat Dec 21 21:45:58 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:53:18 2004
Subject: [mod_python] installation problems
In-Reply-To: <1040522021.12314.421.camel@hortus>
Message-ID: <20021221214317.K81120-100000@eden.ispol.com>

Try this:

Make sure you have libtool 1.4.x, you can do this with libtool --version.

If/when you do, rebuild your apache like this:

cd httpd-2.0.43
./buildconf
./configure --prefix=/usr/local/apache2
make
make install

then ./configure and make mod_python.

On 21 Dec 2002, Lex Berezhny wrote:

> hi all,
>
>   I'm having trouble installing mod_python.
>
> My environment:
> Red Hat Linux release 7.3
> gcc 2.96
>
>
> My install process:
>
> wget http://www.apache.org/dist/httpd/httpd-2.0.43.tar.gz
> tar xzvf httpd-2.0.43.tar.gz
> wget http://apache.webmeta.com/dist/httpd/modpython/mod_python-3.0.1.tgz
> tar xzvf mod_python-3.0.1.tgz
> wget http://www.python.org/ftp/python/2.2.2/Python-2.2.2.tgz
> tar xzvf Python-2.2.2.tgz
>
> cd httpd-2.0.43
> ./configure --prefix=/usr/local/apache2
> make
> make install
>
> cd ../Python-2.2.2/
> ./configure
> make
> make install
>
> cd ../mod_python-3.0.1/
> ./configure --with-apxs=/usr/local/apache2/bin/apxs
> --with-python=/usr/local/bin/python2.2
> make
> make install
>
>
> Warning messages I get (during make):
>
> *** Warning: This library needs some functionality provided by
> -lpython2.2.
> *** I have the capability to make that library automatically link in
> when
> *** you link to this library.  But I can only do this if you have a
> *** shared version of the library, which you do not appear to have.
>
> *** Warning: libtool could not satisfy all declared inter-library
> *** dependencies of module mod_python.  Therefore, libtool will create
> *** a static module, that should work as long as the dlopening
> *** application is linked with the -dlopen flag.
>
>
> The final, fatal, error (during make install):
>
> make[2]: Leaving directory
> `/usr/local/apache2install/mod_python-3.0.1/src'
>
> Performing DSO installation.
>
> /usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
> /usr/bin/install: cannot stat `src/mod_python.so': No such file or
> directory
> make[1]: *** [install_dso] Error 1
> make[1]: Leaving directory `/usr/local/apache2install/mod_python-3.0.1'
> make: *** [install] Error 2
>
>
>
>
> any help or pointers would be greatly appreciated,
>
>  - lex
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From skremer at q.cis.uoguelph.ca  Sun Dec 22 01:47:25 2002
From: skremer at q.cis.uoguelph.ca (Stefan C. Kremer)
Date: Fri Jan  9 21:53:18 2004
Subject: [mod_python] Warning: This library needs some functionality provided by -lpython2.2.
Message-ID: <Pine.LNX.4.44.0212220126580.17196-100000@q.cis.uoguelph.ca>

Hi,

I just read another post about this message by Lex Berezhny and Gregory 
(Grisha) Trubetskoy after experiencing exactly the same problem.

It turns out that the command:

wget http://www.apache.org/dist/httpd/httpd-2.0.43.tar.gz

Provides a very old version of libtool:

$ /usr/local/apache/build/libtool --version
ltmain.sh (GNU libtool) 1.3.4-freebsd-ports (1.385.2.196 1999/12/07 
21:47:57)

By contrast, httpd-2.0.42 has libtool-1.4.2.
(wget http://www.apache.org/dist/httpd/old/httpd-2.0.42.tar.gz)
Any the mod_python install goes smoothly.

Anyone know what's going on with this?!?  Did someone at apache just
screw-up and include the wrong version?  Or is there a reason for this 
downgrade?

Is there an easy remedy to patch 2.0.43 to work correctly?  Can I 
just copy one libtool over the other?  Anyone willing 
to share advice/experiences is greatly appreciated.

Thanks,

	-Stefan

-- 
--
Dr. Stefan C. Kremer, Associate Prof.
Reynolds Building, 106
Dept. of Computing and Information Science
University of Guelph, Guelph, Ontario	N1G 2W1

WWW: http://q.cis.uoguelph.ca/~skremer
Tel: (519)824-4120 Ext.8913  Fax: (519)837-0323
E-mail:  skremer@uoguelph.ca


From alphasquad at web.de  Sun Dec 22 20:21:37 2002
From: alphasquad at web.de ([FTSB]Hawk)
Date: Fri Jan  9 21:53:18 2004
Subject: [mod_python] mod_python cgihandler bug?
Message-ID: <JFEBLGLFKE2CHD65CBA69EAFAJFQP.3e0610c1@Hawk>

Hello

I found some questions on the same topic but no answers.
I installed mod_python 3.0.1 on Win2k and Apache 2.0.43.
Everything seemed to be fine.
But when I tried to use the cgihandler I got an error.
The python script consists of two lines only:

print "content-type: text/plain \n\n"
print "<b>something</b>"

So I do not expect the error to be there. With PythonDebug On I got this message


<b>something</b>
<b>something</b>

Mod_python error: "PythonHandler mod_python.cgihandler"

Traceback (most recent call last):

  File "G:\PYTHON\PYTHON\lib\site-packages\mod_python\apache.py", line 335, in HandlerDispatch
    result = object(req)

  File "G:\PYTHON\PYTHON\lib\site-packages\mod_python\cgihandler.py", line 140, in handler
    apache.restore_nocgi(env, si, so)

  File "G:\PYTHON\PYTHON\lib\site-packages\mod_python\apache.py", line 764, in restore_nocgi
    for k in osenv:

RuntimeError: dictionary changed size during iteration


I need this cgihandler for a port of a rather large project.

Hawk





From grisha at modpython.org  Sun Dec 22 16:41:45 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:53:18 2004
Subject: [mod_python] Warning: This library needs some functionality
 provided by -lpython2.2.
In-Reply-To: <Pine.LNX.4.44.0212220126580.17196-100000@q.cis.uoguelph.ca>
Message-ID: <20021222164004.S90422-100000@eden.ispol.com>

On Sun, 22 Dec 2002, Stefan C. Kremer wrote:

> It turns out that the command:
>
> wget http://www.apache.org/dist/httpd/httpd-2.0.43.tar.gz
>
> Provides a very old version of libtool:
>
> $ /usr/local/apache/build/libtool --version
> ltmain.sh (GNU libtool) 1.3.4-freebsd-ports (1.385.2.196 1999/12/07
> 21:47:57)
>
> By contrast, httpd-2.0.42 has libtool-1.4.2.
> (wget http://www.apache.org/dist/httpd/old/httpd-2.0.42.tar.gz)
> Any the mod_python install goes smoothly.
>
> Anyone know what's going on with this?!?  Did someone at apache just
> screw-up and include the wrong version?

This seems to be the case.

> Is there an easy remedy to patch 2.0.43 to work correctly?

Yes, simply running ./buildconf make apache adopt the version of libtool
on the system.

Grisha


From gnb at itga.com.au  Mon Dec 23 09:15:50 2002
From: gnb at itga.com.au (Gregory Bond)
Date: Fri Jan  9 21:53:18 2004
Subject: [mod_python] mod_python cgihandler bug? 
In-Reply-To: Your message of Sun, 22 Dec 2002 20:21:37 +0100.
Message-ID: <200212222215.JAA00265@lightning.itga.com.au>

In the line:
  File "G:\PYTHON\PYTHON\lib\site-packages\mod_python\apache.py", line 764, in restore_nocgi
    for k in osenv:

Change this to 
	for k in osenv.keys():
and it gets past this problem.  I have still other problems with cgihandler 
tho (see my message from the other day).



From LBerezhny at DevIS.com  Sun Dec 22 18:29:18 2002
From: LBerezhny at DevIS.com (Lex Berezhny)
Date: Fri Jan  9 21:53:18 2004
Subject: [mod_python] ImportError: No module named mod_python.apache
Message-ID: <1040599758.21517.25.camel@buddha>

hello again,

  Thanks for the ./buildconf pointer, it is working great! (i have
attached an updated bash script to get others started, it's only been
tested on RH7, don't forget to su first ;-)

  The next phase of my mod_python escapade involved trying to get the
example working, that's when I hit my next snag.

  The following additions were made to httpd.conf:

    230 LoadModule python_module
/usr/local/apache2/modules/mod_python.so

    361 <Directory "/usr/local/apache2/htdocs/test">
    362     AddHandler python-program .py
    363     PythonHandler mptest
    364     PythonDebug On
    365 </Directory>


  I started apache as follows:

# ./apachectl -k start -DONE_PROCESS


  Going to http://localhost/test/mptest.py produced an Internal Server
Error with the following message in error_log:

[Sun Dec 22 17:57:55 2002] [error] make_obcallback: could not import
mod_python.apache.

ImportError: No module named mod_python.apache

  Is there any simple way to get mod_python to print out its sys.path?
What could cause an incorrect import path? Any suggestions on resolving
this?

thanks a lot,
 - lex
-------------- next part --------------
A non-text attachment was scrubbed...
Name: install.sh
Type: text/x-sh
Size: 563 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20021222/3ba3579e/install-0001.bin
From LBerezhny at DevIS.com  Sun Dec 22 19:04:34 2002
From: LBerezhny at DevIS.com (Lex Berezhny)
Date: Fri Jan  9 21:53:18 2004
Subject: [mod_python] ImportError: No module named mod_python.apache
In-Reply-To: <1040599758.21517.25.camel@buddha>
References: <1040599758.21517.25.camel@buddha>
Message-ID: <1040601873.21517.40.camel@buddha>

heya,

>   Is there any simple way to get mod_python to print out its sys.path?

i found a way to answer my first question (after looking through the
mod_python mailing list archive i found an email by Conrad Steenberg
suggesting strace). I had to adapt his example to work on my machine:

i started apache:
# ./apachectl -k start -DONE_PROCESS

then i got the process id and ran strace like so:
$ strace -p 29405

Every time I went to the URL of my script strace printed out the
following:

......
stat64("/usr/lib/python2.2/mod_python", 0xbfffeb30) = -1 ENOENT (No such
file or directory)
open("/usr/lib/python2.2/mod_python.so", O_RDONLY|O_LARGEFILE) = -1
ENOENT (No such file or directory)
open("/usr/lib/python2.2/mod_pythonmodule.so", O_RDONLY|O_LARGEFILE) =
-1 ENOENT (No such file or directory)
open("/usr/lib/python2.2/mod_python.py", O_RDONLY|O_LARGEFILE) = -1
ENOENT (No such file or directory)
open("/usr/lib/python2.2/mod_python.pyc", O_RDONLY|O_LARGEFILE) = -1
ENOENT (No such file or directory)
....

For some reason mod_python uses the wrong python install directory (i
have two, one that came with my redhat system under /usr/lib/python2.2
and one that i install as part of my script /usr/local/lib/python2.2).

So, where does mod_python make the decision on which python to use?
Again my ./configure for mod_python was this:

./configure --with-apxs=/usr/local/apache2/bin/apxs
--with-python=/usr/local/bin/python2.2

> What could cause an incorrect import path? Any suggestions on resolving
> this?

Thanks again,
 - lex


From gnb at itga.com.au  Mon Dec 23 11:24:46 2002
From: gnb at itga.com.au (Gregory Bond)
Date: Fri Jan  9 21:53:18 2004
Subject: [mod_python] cgi handler bug? 
In-Reply-To: Your message of Fri, 20 Dec 2002 17:33:18 +1100.
Message-ID: <200212230024.LAA08767@lightning.itga.com.au>

I wrote: 

> But the HTML
> generated by the CGI is sent twice, so my page displays double. 

Found it.

In mod_python.apache.py, in the CGIStdout::write() routine, the
self.headers_sent variable is never being set, so the first chunk of stuff from
the CGI program (in my case, all but the last newline) is being handled and
sent twice.

The following patch fixes both CGIhandler problems, and my CGIs now happily 
operate under mod_python:

diff -u ~gnb/mod_python-3.0.1/lib/python/mod_python/apache.py /usr/local/lib/python2.2/site-packages/mod_python/apache.py
--- /home/users/gnb/mod_python-3.0.1/lib/python/mod_python/apache.py    Fri Nov  8 11:15:11 2002
+++ /usr/local/lib/python2.2/site-packages/mod_python/apache.py Mon Dec 23 11:18:56 2002
@@ -723,6 +723,7 @@
                     else:
                         self.req.headers_out.add(h, v)
 
+               self.headers_sent = 1
                 # write the body if any at this point
                 self.req.write(ss[1])
         else:
@@ -761,7 +762,7 @@
     osenv = os.environ
 
     # restore env
-    for k in osenv:
+    for k in osenv.keys():
         del osenv[k]
     for k in sav_env:
         osenv[k] = env[k]




From jim at thario.net  Sun Dec 22 22:17:09 2002
From: jim at thario.net (Jim Thario)
Date: Fri Jan  9 21:53:18 2004
Subject: [mod_python] Problems with PythonAuthenHandler on Red Hat 8.0?
Message-ID: <33470.63.227.22.21.1040620629.squirrel@webmail.thario.com>

Hi. I recently stared working with mod_python. I am using the stock Red
Hat 8.0 installation which includes:

httpd-2.0.40-11
python-2.2.1-17
mod_python-3.0.0-10

I am having trouble with the example from "3.4 Now something More
Complicated - Authentication". My configuration in httpd.conf looks like:

<Directory /var/www/html/python>
        AddHandler python-program .py
        PythonHandler myscript
        PythonAuthenHandler myscript
        PythonDebug On
        AuthType Basic
        AuthName "Restricted Area"
        require valid-user
</Directory>

After getting prompted for the user and password, I get a "Server error!"
page and an entry in the /var/log/httpd/error_log:

"configuration error:  couldn't check user.  No user file?: /python"

Apache seems to want an AuthUserFile in there to read. The best I can
guess is there is a problem with the version of mod_python shipped with
Red Hat 8.0.

Any ideas?

Thanks in advance,
Jim




From tsyang at webtech360.com  Thu Dec 26 13:56:52 2002
From: tsyang at webtech360.com (T.-S. Yang)
Date: Fri Jan  9 21:53:18 2004
Subject: [mod_python] Problems with PythonAuthenHandler on Red Hat 8.0?
In-Reply-To: <33470.63.227.22.21.1040620629.squirrel@webmail.thario.com>
References: <33470.63.227.22.21.1040620629.squirrel@webmail.thario.com>
Message-ID: <3E0B7B24.30505@webtech360.com>

Jim,

I'm able to reproduce the error that you described using RedHat 8.
The problem is fixed under ReHat 8.0.92 (Phoebe).

I don't know the cause of the problem. The related packages in Phoebe
are

httpd-2.0.40-14
python-2.2.2-7
mod_python-3.0.1-1

Happy Holidays,
-tsy


Jim Thario wrote:
> Hi. I recently stared working with mod_python. I am using the stock Red
> Hat 8.0 installation which includes:
> 
> httpd-2.0.40-11
> python-2.2.1-17
> mod_python-3.0.0-10
> 
> I am having trouble with the example from "3.4 Now something More
> Complicated - Authentication". My configuration in httpd.conf looks like:
> 
> <Directory /var/www/html/python>
>         AddHandler python-program .py
>         PythonHandler myscript
>         PythonAuthenHandler myscript
>         PythonDebug On
>         AuthType Basic
>         AuthName "Restricted Area"
>         require valid-user
> </Directory>
> 
> After getting prompted for the user and password, I get a "Server error!"
> page and an entry in the /var/log/httpd/error_log:
> 
> "configuration error:  couldn't check user.  No user file?: /python"
> 
> Apache seems to want an AuthUserFile in there to read. The best I can
> guess is there is a problem with the version of mod_python shipped with
> Red Hat 8.0.
> 
> Any ideas?
> 
> Thanks in advance,
> Jim
> 


From jim at thario.net  Thu Dec 26 16:43:27 2002
From: jim at thario.net (Jim Thario)
Date: Fri Jan  9 21:53:18 2004
Subject: [mod_python] Problems with PythonAuthenHandler on Red Hat 8.0?
In-Reply-To: <3E0B7B24.30505@webtech360.com>
References: <33470.63.227.22.21.1040620629.squirrel@webmail.thario.com>
        <3E0B7B24.30505@webtech360.com>
Message-ID: <32892.63.227.22.21.1040946207.squirrel@webmail.thario.com>

Thanks for taking time to reproduce this. I am going to open a bug against
Red Hat 8.0 and see what they are willing to do.

Thanks,
Jim


T.-S. Yang said:
> Jim,
>
> I'm able to reproduce the error that you described using RedHat 8. The
> problem is fixed under ReHat 8.0.92 (Phoebe).
>
> I don't know the cause of the problem. The related packages in Phoebe
> are
>
> httpd-2.0.40-14
> python-2.2.2-7
> mod_python-3.0.1-1
>
> Happy Holidays,
> -tsy
>
>
> Jim Thario wrote:
>> Hi. I recently stared working with mod_python. I am using the stock
>> Red Hat 8.0 installation which includes:
>>
>> httpd-2.0.40-11
>> python-2.2.1-17
>> mod_python-3.0.0-10
>>
>> I am having trouble with the example from "3.4 Now something More
>> Complicated - Authentication". My configuration in httpd.conf looks
>> like:
>>
>> <Directory /var/www/html/python>
>>         AddHandler python-program .py
>>         PythonHandler myscript
>>         PythonAuthenHandler myscript
>>         PythonDebug On
>>         AuthType Basic
>>         AuthName "Restricted Area"
>>         require valid-user
>> </Directory>
>>
>> After getting prompted for the user and password, I get a "Server
>> error!" page and an entry in the /var/log/httpd/error_log:
>>
>> "configuration error:  couldn't check user.  No user file?: /python"
>>
>> Apache seems to want an AuthUserFile in there to read. The best I can
>> guess is there is a problem with the version of mod_python shipped
>> with Red Hat 8.0.
>>
>> Any ideas?
>>
>> Thanks in advance,
>> Jim
>>




From andy at nervebox.com  Fri Dec 27 00:16:36 2002
From: andy at nervebox.com (andy@nervebox.com)
Date: Fri Jan  9 21:53:18 2004
Subject: [mod_python] http 1.1 persistent connections
Message-ID: <7838526.1040976996296.JavaMail.SYSTEM@Obatala>

Hi all,
I'm new to Python and mod_python - and I'm having trouble finding out if mod_python supports  http1.1's persistent connections.  

I need to be able to have long-running scripts flush a single document - a little at a time, as it's generated - out through Apache to the client.  It might take a minute or an hour.  

Cold Fusion makes this dirt simple.  You can simply insert <cfflush> anywhere in your template and whatever data is generated thus far will be flushed out to Apache - which will hold the HTTP connection open until the template finishes executing.  It can be kept open for hours and makes a good sort of server push.

Can this be done with Python/mod_python?

 - thanks,
 - andy c
      
      
      
    

From stephane.bidoul at softwareag.com  Mon Dec  2 18:15:47 2002
From: stephane.bidoul at softwareag.com (Stéphane Bidoul)
Date: Fri Jan  9 21:59:47 2004
Subject: [mod_python] mp_server.register_cleanup
Message-ID: <000001c29a26$78d78460$56241eac@acsesbi>

Hi Grisha,

I'm back using mod_python, on a real project this time.
We've been using 3.0 beta for a few weeks and it works great!

Now I'm trying to use mp_server.register_cleanup, and that fails
with a "ValueError: first argument must be a Request object".

My first diagnostic (unless I'm doing something silly)
is that it's a remnant of mod_python 2.x,
since the Request class seems to have disappeared
from apache.py.

Is that an easy fix for you? 
Or should I dig it a little bit more?

-sbi




From tigrux at avantel.net  Mon Dec  2 15:01:55 2002
From: tigrux at avantel.net (Sandino Flores Moreno)
Date: Fri Jan  9 21:59:47 2004
Subject: [mod_python] mp_server.register_cleanup
In-Reply-To: <000001c29a26$78d78460$56241eac@acsesbi>
References: <000001c29a26$78d78460$56241eac@acsesbi>
Message-ID: <1038859317.19550.9.camel@TigruXtatioN>

In my code (http://mamba.sf.net)
I'm using it in in this way:

def endRequest(mamba):
        if mamba.processor.globals.has_key('endRequest'):
                endRequest = mamba.processor.globals['endRequest']
                endRequest()
        
def endChild(mamba):
        if mamba.processor.globals.has_key('endChild'):
                endChild = mamba.processor.globals['endChild']
                endChild()


req.register_cleanup(endRequest, (mamba,) )
req.server.register_cleanup(req, endChild, (mamba,) )


From markusjais at yahoo.de  Mon Dec  2 22:31:41 2002
From: markusjais at yahoo.de (Markus Jais)
Date: Fri Jan  9 21:59:47 2004
Subject: [mod_python] beginners question
In-Reply-To: <001f01c29a3b$e92ddc40$6401a8c0@darwin>
References: <1038180652.3173.2.camel@eagle> 
	<001f01c29a3b$e92ddc40$6401a8c0@darwin>
Message-ID: <1038864704.2017.1.camel@eagle>

On Mon, 2002-11-25 at 01:48, Antonio Rodriguez wrote:
> Markus,
> 
> Go into the src directory of the dist and in the OPTIONS= line add -DEAPI.
> apxs will do the right thing and you will stop getting that warning.

thanks, but I found no OPTIONS in all the Make files
I then added 
OPTIONS=-DEAPI
to the Makefile, but this hat not effect.

markus

...

__________________________________________________________________

Gesendet von Yahoo! Mail - http://mail.yahoo.de
Möchten Sie mit einem Gruß antworten? http://grusskarten.yahoo.de

From antonio at memora.com  Mon Dec  2 16:46:54 2002
From: antonio at memora.com (Antonio Rodriguez)
Date: Fri Jan  9 21:59:47 2004
Subject: [mod_python] beginners question -- LIST moderation?
In-Reply-To: <1038864704.2017.1.camel@eagle>
Message-ID: <9297B926-063F-11D7-9E16-00039300D690@memora.com>

in the src directory near the top of the make file there is a line:
OPT=

and you want to make it:
OPT=-DEAPI

Sorry about the confusion.

One other important thing: is this list moderated or something? I 
posted this to you over a week ago and I just received my own post. If 
it is, I kind of wish it wasn't as it impedes the flow of 
communications.

AR


On Monday, December 2, 2002, at 04:31 PM, Markus Jais wrote:

> On Mon, 2002-11-25 at 01:48, Antonio Rodriguez wrote:
>> Markus,
>>
>> Go into the src directory of the dist and in the OPTIONS= line add 
>> -DEAPI.
>> apxs will do the right thing and you will stop getting that warning.
>
> thanks, but I found no OPTIONS in all the Make files
> I then added
> OPTIONS=-DEAPI
> to the Makefile, but this hat not effect.
>
> markus
>
> ...
>
> __________________________________________________________________
>
> Gesendet von Yahoo! Mail - http://mail.yahoo.de
> M?chten Sie mit einem Gru? antworten? http://grusskarten.yahoo.de
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>



From grisha at modpython.org  Mon Dec  2 16:52:26 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:47 2004
Subject: [mod_python] mp_server.register_cleanup
In-Reply-To: <000001c29a26$78d78460$56241eac@acsesbi>
Message-ID: <20021202164818.R5868-100000@eden.ispol.com>

Stephane -

Yes, it looks like server.register_cleanup was left forgotten....

Try applying this set of patches (this includes patches to the test
suite), I'll add this to HEAD.

RCS file: /home/cvs/httpd-python/src/serverobject.c,v
retrieving revision 1.13
diff -u -r1.13 serverobject.c
--- src/serverobject.c  8 Nov 2002 00:15:11 -0000       1.13
+++ src/serverobject.c  2 Dec 2002 21:47:52 -0000
@@ -117,30 +117,20 @@
     cleanup_info *ci;
     PyObject *handler = NULL;
     PyObject *data = NULL;
-    PyObject *Req = NULL;
     requestobject *req = NULL;

-    if (! PyArg_ParseTuple(args, "OO|O", &Req, &handler, &data))
+    if (! PyArg_ParseTuple(args, "OO|O", &req, &handler, &data))
        return NULL;

-    if (! PyObject_HasAttrString(Req, "_req")) {
-       PyErr_SetString(PyExc_ValueError, "first argument must be a Request object");
-       return NULL;
+    if (! MpRequest_Check(req)) {
+        PyErr_SetString(PyExc_ValueError,
+                        "first argument must be a request object");
+        return NULL;
     }
-    else {
-
-       req = (requestobject *) PyObject_GetAttrString(Req, "_req");
-
-       if (! MpRequest_Check(req)) {
-           PyErr_SetString(PyExc_ValueError,
-                           "first argument must be a request object");
-           return NULL;
-       }
-       else if(!PyCallable_Check(handler)) {
-           PyErr_SetString(PyExc_ValueError,
-                           "second argument must be a callable object");
-           return NULL;
-       }
+    else if(!PyCallable_Check(handler)) {
+        PyErr_SetString(PyExc_ValueError,
+                        "second argument must be a callable object");
+        return NULL;
     }

     ci = (cleanup_info *)malloc(sizeof(cleanup_info));
Index: test/test.py
===================================================================
RCS file: /home/cvs/httpd-python/test/test.py,v
retrieving revision 1.20
diff -u -r1.20 test.py
--- test/test.py        29 Oct 2002 21:52:18 -0000      1.20
+++ test/test.py        2 Dec 2002 21:47:52 -0000
@@ -776,12 +776,39 @@

         self.failUnless(result.wasSuccessful())

+    def test_srv_register_cleanup(self):
+
+        print "\n* Testing server.register_cleanup()..."
+
+        c = Directory(DOCUMENT_ROOT,
+                      SetHandler("python-program"),
+                      PythonHandler("tests::srv_register_cleanup"),
+                      PythonDebug("On"))
+
+        self.makeConfig(str(c))
+
+        self.startHttpd()
+
+        f = urllib.urlopen("http://127.0.0.1:%s/tests.py" % PORT)
+        f.read()
+        f.close()
+
+        self.stopHttpd()
+
+        # see what's in the log now
+        time.sleep(1)
+        f = open(os.path.join(SERVER_ROOT, "logs/error_log"))
+        log = f.read()
+        f.close()
+        if log.find("test ok") == -1:
+            self.fail("Could not find test message in error_log")

 def suite():

     mpTestSuite = unittest.TestSuite()
     mpTestSuite.addTest(PerInstanceTestCase("testLoadModule"))
     mpTestSuite.addTest(PerInstanceTestCase("testPerRequestTests"))
+    mpTestSuite.addTest(PerInstanceTestCase("test_srv_register_cleanup"))
     return mpTestSuite

 tr = unittest.TextTestRunner()
Index: test/htdocs/tests.py
===================================================================
RCS file: /home/cvs/httpd-python/test/htdocs/tests.py,v
retrieving revision 1.19
diff -u -r1.19 tests.py
--- test/htdocs/tests.py        29 Oct 2002 21:52:18 -0000      1.19
+++ test/htdocs/tests.py        2 Dec 2002 21:47:52 -0000
@@ -505,6 +505,14 @@

     data.log_error(data.cleanup_data)

+def srv_register_cleanup(req):
+
+    req.cleanup_data = "test ok"
+    req.server.register_cleanup(req, cleanup, req)
+    req.write("registered server cleanup that will write to log")
+
+    return apache.OK
+
 def util_fieldstorage(req):

     from mod_python import util


Grisha

On Mon, 2 Dec 2002, St?phane Bidoul wrote:

> Hi Grisha,
>
> I'm back using mod_python, on a real project this time.
> We've been using 3.0 beta for a few weeks and it works great!
>
> Now I'm trying to use mp_server.register_cleanup, and that fails
> with a "ValueError: first argument must be a Request object".
>
> My first diagnostic (unless I'm doing something silly)
> is that it's a remnant of mod_python 2.x,
> since the Request class seems to have disappeared
> from apache.py.
>
> Is that an easy fix for you?
> Or should I dig it a little bit more?
>
> -sbi
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From harrington_chad at hotmail.com  Mon Dec  2 17:22:23 2002
From: harrington_chad at hotmail.com (Chad Harrington)
Date: Fri Jan  9 21:59:47 2004
Subject: [mod_python] can't find mod_python.so
Message-ID: <F63lff3ECr3ni8hEUJ90001c3fa@hotmail.com>

An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20021202/685bb448/attachment-0002.htm
From mkurjano at tjhsst.edu  Mon Dec  2 22:10:08 2002
From: mkurjano at tjhsst.edu (Matthew Kurjanowicz)
Date: Fri Jan  9 21:59:47 2004
Subject: [mod_python] Problems with mp tutorial
Message-ID: <Pine.LNX.4.44.0212022155500.15170-100000@phosphorus.tjhsst.edu>

Hi there,
First off, I'm new to the list, so if this question has been answered, I
am sorry.  I checked the archives and documentation but could not find
anything helpful in this case.

I am running a new, clean install of RH 8.0, with Apache 2.0.40 (rpm rev
8) and mod_python 3.0.0 (rpm rev 10).  I try the first part of the
tutorial (just hello world) and it works fine.  However, when I try to run
the authentication part of the tutorial, I get these errors (relevent part
of error_log listed below).  Apache is asking for the AuthUserFile of some
sort.  I've used Apache before, and know about basic authentication using
the files, but I'd love to be able to use python.  Any assistance is
appreciated.
Let me know if you need more info or any different files.
Thanks for your time,
Matt Kurjanowicz (mkurjano@tjhsst.edu)

[Sun Dec 01 23:53:28 2002] [notice] Digest: generating secret for digest
authentication ...
[Sun Dec 01 23:53:28 2002] [notice] Digest: done
[Sun Dec 01 23:53:29 2002] [notice] Apache/2.0.40 (Red Hat Linux)
configured -- resuming normal operations
[Sun Dec 01 23:53:40 2002] [crit] [client 127.0.0.1] configuration error:
couldn't check user.  No user file?: /python/authen.py, referer:
http://localhost/python/
[Sun Dec 01 23:53:57 2002] [crit] [client 127.0.0.1] configuration error:
couldn't check user.  No user file?: /python/a.py



From markusjais at yahoo.de  Tue Dec  3 09:29:26 2002
From: markusjais at yahoo.de (=?iso-8859-1?q?Markus=20Jais?=)
Date: Fri Jan  9 21:59:47 2004
Subject: [mod_python] beginners question -- LIST moderation?
In-Reply-To: <9297B926-063F-11D7-9E16-00039300D690@memora.com>
Message-ID: <20021203082926.42999.qmail@web12405.mail.yahoo.com>

 --- Antonio Rodriguez <antonio@memora.com> schrieb: >
in the src directory near the top of the make file
> there is a line:
> OPT=
> 
> and you want to make it:
> OPT=-DEAPI
> 

thank you very much!

> Sorry about the confusion.
> 
> One other important thing: is this list moderated or
> something? I 
> posted this to you over a week ago and I just
> received my own post. If 
> it is, I kind of wish it wasn't as it impedes the
> flow of 
> communications.

I hat the same problems. some postings needed several
days to arrive.

markus





__________________________________________________________________

Gesendet von Yahoo! Mail - http://mail.yahoo.de
Weihnachts-Eink?ufe ohne Stress! http://shopping.yahoo.de

From ray_drew at yahoo.co.uk  Tue Dec  3 11:18:49 2002
From: ray_drew at yahoo.co.uk (Ray Drew)
Date: Fri Jan  9 21:59:47 2004
Subject: [mod_python] 3.0.1 on Apache 2.0.43/Python 2.2.1 on Windows XP Prof.
Message-ID: <002901c29abd$c1ba1750$e4ae5651@RDREWXP>

I seem to have the same problem that others are having - I can't get this to
run.

Apache runs fine until I add...

    LoadModule python_module modules/mod_python.so to the modules section of
httpd.conf

... then Apache fails to start.

I have mod_python.so in the apache modules directory.

Under Apache 1.3x and mod_python 2.76 the apache module was a dll.

Does anyone have this combination working?

Thanks,

Ray





__________________________________________________
Do You Yahoo!?
Sign up for SBC Yahoo! Dial - First Month Free
http://sbc.yahoo.com

From neo at https.ru  Tue Dec  3 15:09:03 2002
From: neo at https.ru (Neo Eureka)
Date: Fri Jan  9 21:59:47 2004
Subject: [mod_python] mod_python on Windows
Message-ID: <1484824066.20021203150903@https.ru>

Hi !

  I have no cygwin installed but I had just the same problem with
mod_python 3 on WinNT. I posted this question a logn-long time ago.
There are about ten people who have reported the same issue since that
time...

>
> 
> Grisha,
> Unfortunately, I think it must be more involved than that...
> I have the identical problem, but I use python 2.2.1
> 
> I am running mod_python 3.0.1, Python 2.2.1, Apache 2.0.43, Windows
> 2000 Professional.  I also have cygwin installed, if that might make
> a difference.  It appears that the Mark (the original poster) also
> has cygwin.  I also played with the permissions and owners to no
> avail.  Are there any other things I should try?    
> Chad Harrington 
> harrington_chad@hotmail.com 

--- 
Neo Eureka / mailto:neo@https.ru


From heha at iki.fi  Tue Dec  3 16:13:00 2002
From: heha at iki.fi (Heikki Halonen)
Date: Fri Jan  9 21:59:47 2004
Subject: [mod_python] mod_python with 4Suite tools
Message-ID: <Pine.LNX.4.44.0212031452160.3043-100000@a204b.ud.ton.tut.fi>

Hi

I'm having hard time trying to make 4Suite tools co-operate with
mod_python (or vice versa). I'm using Python 2.2.2, Apache 2.0.43,
mod_python 3.0.1 and newest 4Suite development version. My system is
Debian unstable. python2.2-xml package is not installed.

The test program is in the end of this mail, the xml files used can be
found at http://www.heha.iki.fi/~heha/poll_dev/quiz2html.xsl and
http://www.heha.iki.fi/~heha/poll_dev/polls/quiz_1.xml. Test program works
perfectly when run from the command line. When requested by mod_python,
however, it 'obfuscates' the XML document. Characters used in marking
print out fine but everything else is some random binary data. I figured
out that it probably has something to do with encoding and added the
following lines to sitecustomize.py, as somebody advised in some distantly
similar problem:

u'hello'.encode( 'UTF-8' )
u'hello'.encode( 'iso8859-1' )

This did not help, whatsoever. I have no clue anymore where the problem
could be or how it could be corrected. Any suggestions? The same kind of
code works fine in mod_python 2.7.8 running in Apache 1.3.26 with Python
2.1 and 4Suite version 0.11.1.




#!/usr/bin/python2.2

import sys, os, string

from Ft.Lib import Uri
from Ft.Xml.Xslt import XmlWriter, Processor, OutputParameters
from Ft.Xml import Domlette, InputSource

def processXML():
    mypath = '/home/heha/public_html/poll_dev/'
    pollfile = mypath+'polls/quiz_1.xml'
    pollxsl = mypath+'quiz2html.xsl'

    debugfile = open( mypath+'poll.log', 'w' )
    processor = Processor.Processor()
    node = Domlette.NonvalidatingReader.parseUri( pollfile )
    Domlette.Print( node, debugfile, encoding='iso8859-1' )
    stylesheet = InputSource.DefaultFactory.fromUri( pollxsl )
    processor.appendStylesheet( stylesheet )

    processed_node = processor.runNode( node, Uri.OsPathToUri(
        pollfile, 1) )

    debugfile.write( processed_node )
    debugfile.close()

    return processed_node

    #print writer.getResult()

if __name__ == "__main__":
    print processXML()
else:
    from mod_python import apache

    def handler( req ):
        req.write( processXML() )
        return apache.OK



     Heikki Halonen # heha@iki.fi # iki.fi/heha # +358 40 828 9972
            "The easy way ain't hard enough and the hard way
                     is such a lonely lonely path"


From gdamjan at mail.net.mk  Tue Dec  3 16:12:44 2002
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 21:59:47 2004
Subject: [mod_python] bug/misfeature in publisher/mod_python
Message-ID: <20021203151244.GB16590@legolas.on.net.mk>

My setup:
 apache 2.0.43, mod_python 3.0.1, python 2.2.1

httpd.conf:
<Directory /home/www/htdocs> # The root of the web server
...
    SetHandler python-program
    PythonHandler mod_python.publisher | .py
    PythonDebug On
</Directory>
...

I expect this setup to handle all files ending in ".py" through
the publisher handler.

I have the script "hello.py" from the mod_python manual in the root of the
web-server. Trying to get "http://127.1/hello.py/say" mod_python
throws an exception (traceback atached).

The exception is: "ImportError: No module named py"

I've foloved the problem to the publisher handler, line 139. 
When publisher tries to strip the suffixes, it gets them by
calling "req.get_addhandler_exts()". Obviosly in my case this
call return None (I dont have the AddHandler directive). So
publsiher doesn't strip anything, thus trying to import the
module "py" (which is the extension of the script).

The solution for this problem would be for get_addhandler_exts()
alsa to return the extensions as specified in the 
"PythonHandler ... | .ext" directive.



-- 
Damjan Georgievski
-------------- next part --------------

Mod_python error: "PythonHandler mod_python.publisher"

Traceback (most recent call last):

  File "/usr/lib/python2.2/site-packages/mod_python/apache.py", line 335, in HandlerDispatch
    result = object(req)

  File "/usr/lib/python2.2/site-packages/mod_python/publisher.py", line 149, in handler
    module = apache.import_module(module_name, req.get_config(), [path])

  File "/usr/lib/python2.2/site-packages/mod_python/apache.py", line 499, in import_module
    f, p, d = imp.find_module(parts[i], path)

ImportError: No module named py
From duncan at rcp.co.uk  Tue Dec  3 15:58:39 2002
From: duncan at rcp.co.uk (Duncan Booth)
Date: Fri Jan  9 21:59:47 2004
Subject: [mod_python] mod_python 3.0.1 on Apache 2.0.43 solution
Message-ID: <3DECD4AF.28805.1664047@localhost>

It appears that the binaries for mod_python 3.0.1 have been built 
using Microsoft Visual Studio version 7. This means that 
mod_python.so has a dependency on the file msvcr70.dll, but the 
distribution doesn't include this file.

If you have the latest Microsoft compiler installed, or any other 
applications that use this DLL, then mod_python.so works fine. If not 
it fails horribly.

The workaround (at least on one machine that had this problem) is to 
copy msvcr70.dll into \winnt\system32. Get the file from anywhere 
that already has a copy (e.g. www.dll-files.com/dllindex/dll-
files.shtml?msvcr70). Fortunately this dll has no further 
dependencies.  

The long term solution would be to distribute mod_python as a .MSI 
file including dependencies, or even to build it with the same version 
of the C runtime library as used for the rest of Apache and Python.



From grisha at modpython.org  Tue Dec  3 11:00:17 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:47 2004
Subject: [mod_python] can't find mod_python.so
In-Reply-To: <F63lff3ECr3ni8hEUJ90001c3fa@hotmail.com>
Message-ID: <20021203105848.L19817-100000@eden.ispol.com>

I've recompiled mod_python.so and placed the new file out there. I tested
it and it works fine for me on Win2K, apache 2.0.43 and Python 2.2.1 (from
www.python.org). I think something went amuck with the original file.

Grisha

On Mon, 2 Dec 2002, Chad Harrington wrote:

>
>
>
> Grisha,
>
> Unfortunately, I think it must be more involved than that...
>
> I have the identical problem, but I use python 2.2.1
>
> I am running mod_python 3.0.1, Python 2.2.1, Apache 2.0.43, Windows 2000 Professional.  I also have cygwin installed, if that might make a difference.  It
> appears that the Mark (the original poster) also has cygwin.  I also played with the permissions and owners to no avail.  Are there any other things I should
> try?
>
> Chad Harrington
> harrington_chad@hotmail.com
> ----Original Message Follows----
> From: "Gregory (Grisha) Trubetskoy"
> To: Mark Messer
> CC: mod_python@modpython.org
> Subject: Re: [mod_python] can't find mod_python.so
> Date: Sat, 30 Nov 2002 23:06:10 -0500 (EST)
> This is possibly because the mod_python.so that is out there is for Python
> 2.2.1. I don't have one for 2.2.2 compiled (yet).
> Grisha
> On Sat, 30 Nov 2002, Mark Messer wrote:
> > I put mod_python.so into the modules directory, but I get an error when
> > starting Apache:
> >
> > C:\tools\Apache2\bin>apache
> > Syntax error on line 173 of C:/tools/Apache2/conf/httpd.conf:
> > Cannot load C:/tools/Apache2/modules/mod_python.so into server: The
> > specified module could not be found.
> >
> > I added this to the LoadModule section of httpd.conf: LoadModule
> > python_module modules/mod_python.so
> >
> > Here's the directory listing:
> > C:\tools\Apache2\modules>ls -al mod_p*
> > -rwxrwx--- 1 Administ SYSTEM 40960 Oct 3 06:58 mod_proxy.so
> > -rwxrwx--- 1 Administ SYSTEM 20480 Oct 3 06:58 mod_proxy_connect.so
> > -rwxrwx--- 1 Administ SYSTEM 28672 Oct 3 06:58 mod_proxy_ftp.so
> > -rwxrwx--- 1 Administ SYSTEM 24576 Oct 3 06:58 mod_proxy_http.so
> > -rwxrwx--- 1 Administ SYSTEM 65536 Nov 26 17:49 mod_python.so
> >
> > I am running mod_python 3.0.1, Python 2.2.2, Apache 2.0.43, Windows XP
> > Professional. Tried changing perms and ownership to match what was there,
> > but that did not work.
> >
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://www.modpython.org/mailman/listinfo/mod_python
> >
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>
> ____________________________________________________________________________________________________________________________________________________________________
> MSN 8 helps ELIMINATE E-MAIL VIRUSES. Get 2 months FREE*.
>


From harrington_chad at hotmail.com  Tue Dec  3 08:48:10 2002
From: harrington_chad at hotmail.com (Chad Harrington)
Date: Fri Jan  9 21:59:47 2004
Subject: [mod_python] can't find mod_python.so
Message-ID: <F153XRyOLjauzQmvaR300012ca1@hotmail.com>

An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20021203/8eb6acf8/attachment-0002.htm
From gstein at lyra.org  Tue Dec  3 10:20:30 2002
From: gstein at lyra.org (Greg Stein)
Date: Fri Jan  9 21:59:47 2004
Subject: [mod_python] 3.0.1 on Apache 2.0.43/Python 2.2.1 on Windows XP Prof.
In-Reply-To: <002901c29abd$c1ba1750$e4ae5651@RDREWXP>; from ray_drew@yahoo.co.uk on Tue, Dec 03, 2002 at 11:18:49AM -0000
References: <002901c29abd$c1ba1750$e4ae5651@RDREWXP>
Message-ID: <20021203102030.D17655@lyra.org>

On Tue, Dec 03, 2002 at 11:18:49AM -0000, Ray Drew wrote:
>...
> I have mod_python.so in the apache modules directory.
> 
> Under Apache 1.3x and mod_python 2.76 the apache module was a dll.

FYI... it is still a DLL, just with a different extension.

Cheers,
-g

-- 
Greg Stein, http://www.lyra.org/

From webmaster at obramaestraonline.com  Tue Dec  3 16:39:22 2002
From: webmaster at obramaestraonline.com (Webmaster)
Date: Fri Jan  9 21:59:47 2004
Subject: [mod_python] mod_python on Win32 Apache 1.3.27
Message-ID: <000101c29b0c$115e9800$22383242@Family>

Is mod python compatible with Apache 1.3.27?

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20021203/a5ee485b/attachment-0002.htm
From ray_drew at yahoo.co.uk  Tue Dec  3 23:44:24 2002
From: ray_drew at yahoo.co.uk (Ray Drew)
Date: Fri Jan  9 21:59:47 2004
Subject: [mod_python] mod_python os.environ bug?
Message-ID: <012e01c29b25$e9d99040$e4ae5651@RDREWXP>

Hi Grisha,

I'm using mod_python in conjunction with quixote
www.mems-exchange.org/software/quixote/

In moving from Apache 1.3.22/mp 2.78 to Apache 2.043/mp 3.01 I get a
TypeError on the quixote function environ.get(key, default). The default in
this function is None and this is what returns the Type Error. If I change
the default argument to an empty string everything works ok. It's been
suggested that there may be a bug in mod_python, see below:

-----------------------------------------------
On Tue, Dec 03, 2002 at 09:55:57PM -0000, Ray Drew wrote:
> Moving from...
>
> Apache 1.3.22 Python 2.2.1 mod_python 2.7.8 Quixote 0.5.1 Windows XP
>
> ...to...
>
> Apache 2.043 mod_python 3.0.1 rest as above.

>     return self.environ.get(key, default)
> TypeError: get() argument 2 must be string, not None

I would guess it is a mod_python bug.  I suppose it replaces os.environ
with an object that does incorrect type checking on the second argument
to get().
-----------------------------------------------

Would that be right?

Thanks,

Ray

__________________________________________________
Do you Yahoo!?
Yahoo! Mail Plus - Powerful. Affordable. Sign up now.
http://mailplus.yahoo.com

From ray_drew at yahoo.co.uk  Wed Dec  4 09:57:08 2002
From: ray_drew at yahoo.co.uk (Ray Drew)
Date: Fri Jan  9 21:59:47 2004
Subject: [mod_python] mod_python 3.0.1 on Apache 2.0.43 solution
References: <3DECD4AF.28805.1664047@localhost>
Message-ID: <002f01c29b7b$838d1860$e4ae5651@RDREWXP>

Duncan wrote:

#
The workaround (at least on one machine that had this problem) is to 
copy msvcr70.dll into \winnt\system32. Get the file from anywhere 
that already has a copy (e.g. www.dll-files.com/dllindex/dll-
files.shtml?msvcr70). 
#

Duncan,

THANKYOU THANKYOU THANKYOU

That worked for me on Windows XP professional.

Ray





__________________________________________________
Do you Yahoo!?
Yahoo! Mail Plus - Powerful. Affordable. Sign up now.
http://mailplus.yahoo.com

From scott at activestudios.com  Wed Dec  4 08:20:12 2002
From: scott at activestudios.com (Scott Russell)
Date: Fri Jan  9 21:59:47 2004
Subject: [mod_python] mod_xslt filtering of mod_python output
Message-ID: <1039008012.13748.35.camel@heckle.activestudios.com>

Hi. I'm a a beginner with mod_python, and I'm trying to use mod_python
and mod_xslt together.

mod_python gets called via a "SetHandler python-program", and inside
python I set the content-type to text/xml.

mod_xslt is called via "AddOutputFilterByType mod-xslt "text/xml")  

--- httpd.conf stanza: ---

<Location /the_dir>
    SetHandler python-program
    PythonPath "sys.path + ['/path/']"
    PythonHandler mymodule
    AddOutputFilterByType mod-xslt text/xml
</Location>
--- end ---

--- /path/mymodule.py excerpt ---

def handler(req):
        
  ... generate xml, place in out ...

  req.content_type = "text/xml"
  req.write(out)
  return apache.OK
--- end ---

Both work fine standalone - mod_xslt filters xml files, and mod_python
is generating dynamic content, but I don't know how to get mod_xslt to
filter dynamic content from mod_python...

What am I missing?  

Apache 2.0.40, mod_python 3.0.0, python 2.2.1 (all stock installs on on
RH 8) mod_xslt 1.0.5 (built locally)


From cameron at toolhouse.com  Wed Dec  4 13:46:48 2002
From: cameron at toolhouse.com (Cameron S. Watters)
Date: Fri Jan  9 21:59:47 2004
Subject: [mod_python] make problems
Message-ID: <E43EADFC-07D1-11D7-83C3-00306599D91A@toolhouse.com>

Hello all,

figured you could help.

I keep getting this message when I try to make mod_python 3.0.1

*** Warning: This library needs some functionality provided by 
-lpython2.2.
*** I have the capability to make that library automatically link in 
when
*** you link to this library.  But I can only do this if you have a
*** shared version of the library, which you do not appear to have.

*** Warning: libtool could not satisfy all declared inter-library
*** dependencies of module mod_python.  Therefore, libtool will create
*** a static module, that should work as long as the dlopening
*** application is linked with the -dlopen flag.

I installed apache 2.0.43 and python 2.2.2 from source on FreeBSD. I'm 
explicitly passing --with-python and --with-apxs to the configure 
script.

Any help would be appreciated.

--cameron


From grisha at modpython.org  Wed Dec  4 17:37:20 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:47 2004
Subject: [mod_python] make problems
In-Reply-To: <E43EADFC-07D1-11D7-83C3-00306599D91A@toolhouse.com>
Message-ID: <20021204172744.D39475-100000@eden.ispol.com>

You don't mention your FreeBSD version, it's possible that you have a
really old libtool. Also make sure that Apache is compiled with
--enable-threads. See the FreeBSD section in mod_python README.

Grisha

On Wed, 4 Dec 2002, Cameron S. Watters wrote:

> Hello all,
>
> figured you could help.
>
> I keep getting this message when I try to make mod_python 3.0.1
>
> *** Warning: This library needs some functionality provided by
> -lpython2.2.
> *** I have the capability to make that library automatically link in
> when
> *** you link to this library.  But I can only do this if you have a
> *** shared version of the library, which you do not appear to have.
>
> *** Warning: libtool could not satisfy all declared inter-library
> *** dependencies of module mod_python.  Therefore, libtool will create
> *** a static module, that should work as long as the dlopening
> *** application is linked with the -dlopen flag.
>
> I installed apache 2.0.43 and python 2.2.2 from source on FreeBSD. I'm
> explicitly passing --with-python and --with-apxs to the configure
> script.
>
> Any help would be appreciated.
>
> --cameron
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From webmaster at obramaestraonline.com  Wed Dec  4 19:09:11 2002
From: webmaster at obramaestraonline.com (Rafael Fernandez)
Date: Fri Jan  9 21:59:47 2004
Subject: [mod_python] Mod_python on Win32; Apache 1.3.27
Message-ID: <000001c29bea$2b711900$b0383242@Family>

Is mod_python compatible with Apache 1.3.27 on Win32?

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20021204/b891a606/attachment-0002.htm
From gdamjan at mail.net.mk  Thu Dec  5 00:18:15 2002
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 21:59:47 2004
Subject: [mod_python] make problems
In-Reply-To: <20021204172744.D39475-100000@eden.ispol.com>
References: <E43EADFC-07D1-11D7-83C3-00306599D91A@toolhouse.com> <20021204172744.D39475-100000@eden.ispol.com>
Message-ID: <20021204231815.GA15577@legolas.on.net.mk>

> 
> You don't mention your FreeBSD version, it's possible that you have a
> really old libtool. Also make sure that Apache is compiled with
> --enable-threads. See the FreeBSD section in mod_python README.
> 
> > *** Warning: This library needs some functionality provided by
> > -lpython2.2.
> > *** I have the capability to make that library automatically link in
> > when


This same thing happend on my slackware 8.1 box,
libtool = ltmain.sh (GNU libtool) 1.4.2 (1.922.2.53 2001/09/11 03:18:52)

I solved it by making a /usr/lib/libpython.2.2.so shared library.
The procedure is (if I remember good): 
  mkdir /tmp/libpython;  cd /tmp/libpython
  ar x /usr/lib/python2.2/config/libpython2.2.a
  ld -shared -export-dynamic *.o -ldl -lpthread -lutil -lm -lc\
	-o /usr/lib/libpython2.2.so
  



-- 
Damjan Georgievski

From cameron at toolhouse.com  Wed Dec  4 16:16:46 2002
From: cameron at toolhouse.com (Cameron S. Watters)
Date: Fri Jan  9 21:59:47 2004
Subject: [mod_python] make problems
In-Reply-To: <20021204172744.D39475-100000@eden.ispol.com>
Message-ID: <D748DF36-07E6-11D7-83C3-00306599D91A@toolhouse.com>

> You don't mention your FreeBSD version, it's possible that you have a
> really old libtool. Also make sure that Apache is compiled with
> --enable-threads. See the FreeBSD section in mod_python README.

FreeBSD 4.7-RELEASE
libtool 1.3.4 (installed from ports)

Thanks for the pointer to the FreeBSD note in the readme, I had missed 
it, BUT....

I still get the same message after recompiling apache with the 
--enable-threads flag set. I think it has more to do with the fact that 
there isn't a libpython2.2.so built (as mentioned by 
gdamjan@mail.net.mk).

I would suggest adding that either to the docs on the website (and to 
the README of future releases). The standard python built from source 
doesn't appear to do it for you and according to the python FAQ, item 
3.30, Why is the Python interpreter not built as a shared library?, it 
won't until v2.3. If this IS required by mod_python, it should be at 
least given a mention, and optimally, there would be instructions about 
how to create it.

> Grisha
>
> On Wed, 4 Dec 2002, Cameron S. Watters wrote:
>
>> Hello all,
>>
>> figured you could help.
>>
>> I keep getting this message when I try to make mod_python 3.0.1
>>
>> *** Warning: This library needs some functionality provided by
>> -lpython2.2.
>> *** I have the capability to make that library automatically link in
>> when
>> *** you link to this library.  But I can only do this if you have a
>> *** shared version of the library, which you do not appear to have.
>>
>> *** Warning: libtool could not satisfy all declared inter-library
>> *** dependencies of module mod_python.  Therefore, libtool will create
>> *** a static module, that should work as long as the dlopening
>> *** application is linked with the -dlopen flag.
>>
>> I installed apache 2.0.43 and python 2.2.2 from source on FreeBSD. I'm
>> explicitly passing --with-python and --with-apxs to the configure
>> script.
>>
>> Any help would be appreciated.
>>
>> --cameron
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://www.modpython.org/mailman/listinfo/mod_python
>>
>
>


From grisha at modpython.org  Wed Dec  4 19:34:39 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:47 2004
Subject: [mod_python] make problems
In-Reply-To: <D748DF36-07E6-11D7-83C3-00306599D91A@toolhouse.com>
Message-ID: <20021204192952.W41195-100000@eden.ispol.com>

No, shared lib is not required. I have Python 2.2.1 and apache 2.0.43
installed from ports on a FreeBSD 4.7-RELEASE-p1 box and mod_python
compiles just fine. There is no libpython2.2.so.

If your apache installation is not from ports, then another thing you
might try is to rebuild apache after running ./buildconf (then
./configure), then make. Apxs uses the libtool script that is packaged
with apache, and it in turn is created by ./buildconf, so it may have
something to do with that.

Grisha

On Wed, 4 Dec 2002, Cameron S. Watters wrote:

> > You don't mention your FreeBSD version, it's possible that you have a
> > really old libtool. Also make sure that Apache is compiled with
> > --enable-threads. See the FreeBSD section in mod_python README.
>
> FreeBSD 4.7-RELEASE
> libtool 1.3.4 (installed from ports)
>
> Thanks for the pointer to the FreeBSD note in the readme, I had missed
> it, BUT....
>
> I still get the same message after recompiling apache with the
> --enable-threads flag set. I think it has more to do with the fact that
> there isn't a libpython2.2.so built (as mentioned by
> gdamjan@mail.net.mk).
>
> I would suggest adding that either to the docs on the website (and to
> the README of future releases). The standard python built from source
> doesn't appear to do it for you and according to the python FAQ, item
> 3.30, Why is the Python interpreter not built as a shared library?, it
> won't until v2.3. If this IS required by mod_python, it should be at
> least given a mention, and optimally, there would be instructions about
> how to create it.
>
> > Grisha
> >
> > On Wed, 4 Dec 2002, Cameron S. Watters wrote:
> >
> >> Hello all,
> >>
> >> figured you could help.
> >>
> >> I keep getting this message when I try to make mod_python 3.0.1
> >>
> >> *** Warning: This library needs some functionality provided by
> >> -lpython2.2.
> >> *** I have the capability to make that library automatically link in
> >> when
> >> *** you link to this library.  But I can only do this if you have a
> >> *** shared version of the library, which you do not appear to have.
> >>
> >> *** Warning: libtool could not satisfy all declared inter-library
> >> *** dependencies of module mod_python.  Therefore, libtool will create
> >> *** a static module, that should work as long as the dlopening
> >> *** application is linked with the -dlopen flag.
> >>
> >> I installed apache 2.0.43 and python 2.2.2 from source on FreeBSD. I'm
> >> explicitly passing --with-python and --with-apxs to the configure
> >> script.
> >>
> >> Any help would be appreciated.
> >>
> >> --cameron
> >>
> >> _______________________________________________
> >> Mod_python mailing list
> >> Mod_python@modpython.org
> >> http://www.modpython.org/mailman/listinfo/mod_python
> >>
> >
> >
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From cameron at toolhouse.com  Wed Dec  4 17:43:16 2002
From: cameron at toolhouse.com (Cameron S. Watters)
Date: Fri Jan  9 21:59:47 2004
Subject: [mod_python] make problems
In-Reply-To: <20021204192952.W41195-100000@eden.ispol.com>
Message-ID: <EC6ED012-07F2-11D7-83C3-00306599D91A@toolhouse.com>

> No, shared lib is not required. I have Python 2.2.1 and apache 2.0.43
> installed from ports on a FreeBSD 4.7-RELEASE-p1 box and mod_python
> compiles just fine. There is no libpython2.2.so.
>
> If your apache installation is not from ports, then another thing you
> might try is to rebuild apache after running ./buildconf (then
> ./configure), then make. Apxs uses the libtool script that is packaged
> with apache, and it in turn is created by ./buildconf, so it may have
> something to do with that.

That worked.

./buildconf
./configure --a mass of configure options
make
make install

I will say that building libpython2.2.so also makes the error messages 
go away (not that that makes it the correct solution). Anybody want to 
comment on what difference it actually makes?

Thanks for your help.

--cameron


From nathanr at nathanr.net  Thu Dec  5 14:54:29 2002
From: nathanr at nathanr.net (Nathan Robertson)
Date: Fri Jan  9 21:59:48 2004
Subject: [mod_python] Embedded python support
Message-ID: <1039060470.334.8.camel@moosehead>

Hi,

Before mod_snake was killed, I quite liked its embedded python support.
As mod_snake is now dead, I've ported their epy modules to mod_python
and made them available. For those of you who aren't familiar with the
epy feature, it allows you to embed fragments of python into html code,
in the same way VBScript and JScript can be done in ASP, Java in JSP,
PHP in PHP (??), etc.

From jirka.machotka at seznam.cz  Thu Dec  5 12:18:05 2002
From: jirka.machotka at seznam.cz (=?iso-8859-2?Q?Jirka=20Machotka?=)
Date: Fri Jan  9 21:59:48 2004
Subject: [mod_python] =?iso-8859-2?Q?Problems=20with=20mptest=2Epy=20=28Windows=29?=
Message-ID: <3939.5433-10072-616945501-1039087085@seznam.cz>

Hello there,

I have probably a very basic question. However, I could not find
anything relevant (a searching machine would be fine)

I had had problems with running the mod_python for Apache 2.0.43.
Following the advice I had gotten the msvcr70.dll, put it to the
required directory and restarted the Apache. The Apache starts,
however, when I try to fetch mptest.py (it looks exactly as described
in the manual, the configuration file httpd has been modified
accordingly) I receive an error:

make_obcallback: could not import mod_python.apache

To my understanding the problem relates rather to Python (my version
is 2.2.1). The manual mentions that Python environment must be
recompiled, or what. I'm afraid that's not possible for me
(recompiled in what?) Or am I missing something inportant?


Please help. Thanks in advance.

Jiri

______________________________________________________________________
Reklama:
Sout?? o auto na v?kend, autor?dio Clarion a dal?? ceny: http://ad2.seznam.cz/redir.cgi?instance=12345%26url=http://www.auto-plus.cz
 - nejlep?? syst?m prodeje ojet?ch voz? na internetu


From gdamjan at mail.net.mk  Thu Dec  5 19:40:15 2002
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 21:59:48 2004
Subject: [mod_python] make problems
In-Reply-To: <EC6ED012-07F2-11D7-83C3-00306599D91A@toolhouse.com>
References: <20021204192952.W41195-100000@eden.ispol.com> <EC6ED012-07F2-11D7-83C3-00306599D91A@toolhouse.com>
Message-ID: <20021205184015.GA676@legolas.on.net.mk>

> 
> I will say that building libpython2.2.so also makes the error messages 
> go away (not that that makes it the correct solution). Anybody want to 
> comment on what difference it actually makes?

the presence of libpython2.2.so only allows the build proces to
continue, I can confirm that mod_python is STATICALLY linked with
libpython anyway. This seems like a problem with the build
enviroment, but I don't have enough knowledge to investigate it
any further.







-- 
Damjan Georgievski

From webmaster at obramaestraonline.com  Thu Dec  5 15:37:44 2002
From: webmaster at obramaestraonline.com (Rafael Fernandez)
Date: Fri Jan  9 21:59:48 2004
Subject: [mod_python] Apache1.3.27 with mod_python on Win 32?
Message-ID: <002001c29c95$d1db8540$f7383242@Family>

Is Apache 1.3.27 compatible with mod_python?

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20021205/982faa8f/attachment-0002.htm
From jirka.machotka at seznam.cz  Fri Dec  6 15:55:45 2002
From: jirka.machotka at seznam.cz (=?iso-8859-2?Q?Jirka=20Machotka?=)
Date: Fri Jan  9 21:59:48 2004
Subject: [mod_python] =?iso-8859-2?Q?Re=3A=20R=3A=20=5Bmod=5Fpython=5D=20Problems=20with=20mptest=2Epy=20=28Windows=29?=
In-Reply-To: <52DC70C1C1575C418CB033523A29CF140E0570@exchange2000.manord.com>
Message-ID: <2088.9028-27840-818706865-1039186545@seznam.cz>

Signore,

no comprendo italiano. 

The transaltion I got by AltaVista Babelfish:
and approximately the problem that it gave you? 

The problem is that I don't know what to do. It is obvious that there
is a problem to connect Apache with Python interpret or vice versa.
The question is whether the interpret is called at all (I guess it
is). If so, it seems it is not able to see imported objects enabling
passing the data from/to the Apache. In the manual there is no hint
how to proceed in this case even though I'm sure that everyone has to
go through this problem anyhow.


Dne 5.?prosinec?2002, Manera, Villiam, <vmanera@manord.com> napsal:

> e circa il problema che dava a te?
> 
> -----Messaggio originale-----
> Da: Jirka Machotka [mailto:jirka.machotka@seznam.cz]
> Inviato: giovedi 5 dicembre 2002 12.18
> A: mod_python@modpython.org
> Oggetto: [mod_python] Problems with mptest.py (Windows)
> 

______________________________________________________________________
Reklama:
Nokia 3410 za 4.577 Kc. Nejvyhodnejsi nabidka telefonu na trhu!
http://ad2.seznam.cz/redir.cgi?instance=38871%26url=http://www.oskarmobil.cz/handsets/handset.php


From mcassiano at manord.com  Fri Dec  6 18:19:09 2002
From: mcassiano at manord.com (Cassiano, Marco)
Date: Fri Jan  9 21:59:48 2004
Subject: [mod_python] Win32 : Can't locate API module structure `mod_python'
Message-ID: <52DC70C1C1575C418CB033523A29CF140B8D9B@exchange2000.manord.com>

Hello,

I'm using 
- Windows 2000 Server,
- Apache 2.0.43
- Active State active python 2.2.2
- mod_python 3.0.1 (I should put the mod_python-3.0.1\lib\python\mod_python
folder from the distribution into the c:\Python22\lib folder, right?)
- mod_python.so for activestate into the Apache modules folder. 
- I have also the msvcr70.dll into \winnt\system32.

When I try to start Apache it fails and I get the following error in the
registry : 

"Can't locate API module structure `mod_python' in file C:/Program
Files/Apache Group/Apache2/modules/mod_python.so: No error "

I read on the list that many of you, after the "msvcr70.dll" hint, succeeded
in making mod_python work.
What am I missing ?
Thank you!

> Marco Cassiano
> Resp. Reti e Sistemi
> 
> Manifatture del Nord srl
> viale Regina Elena 13-15
> 42100 Reggio Emilia RE
> ITALY
> 
> Tel. +39 0522 508206
> Fax +39 0522 514001
> email : mcassiano@manord.com
> www.pennyblack.com
> 
> 

From marius at netroedge.com  Fri Dec  6 11:21:22 2002
From: marius at netroedge.com (Marius Nita)
Date: Fri Jan  9 21:59:48 2004
Subject: [mod_python] dev list
Message-ID: <20021206192122.GC8713@netroedge.com>

hello,

i'm having trouble subscribing to the dev list, it seems. i never got
a confirmation message, nor any messages...

just wondering if anyone else has had problems with it.

marius

From jgarzon at indra.es  Mon Dec  9 10:46:42 2002
From: jgarzon at indra.es (Garzon Maldonado, Jesus Javier)
Date: Fri Jan  9 21:59:48 2004
Subject: [mod_python] Problem with --enable-threads
Message-ID: <C6A2439F4F6BE04CAF457A5E24A376FA3634D2@madtormail2.indra.es>

Hello all:

I'm trying to configure Apache 2.0.43+mod_ssl+mod_rewrite+php4.2.3+mod_python-3.0 beta4 on a FreeBSD 4.7 machine.
According to what is said in the documentation, mod_python needs apache configured with --enable-threads, so this is what I typed to configure the source code.
./configure --prefix=/usr/local/apache2 --enable-so --enable-ssl --enable-rewrite --enable-threads

This works and I can compile and install apache, but I cannot start it. When I type ./apachectl startssl (or just start) only one process is launched:
root   23785  0.0  0.9  7064 4836  ??  Is    3:19PM   0:00.01 /usr/local/apache2/bin/httpd -k start -DSSL

But this process doesn't work, (doesn't serve html pages), and cannot be killed with ./apachectl stop

However if I do:
./configure --prefix=/usr/local/apache2 --enable-so --enable-ssl --enable-rewrite

all works fine (though I cannot use mod_python).

What am I doing wrong?

Thanks.

Javi Garzon


From zoper at libero.it  Tue Dec 10 08:54:42 2002
From: zoper at libero.it (Zoper)
Date: Fri Jan  9 21:59:48 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
Message-ID: <002001c2a021$66b50720$1c291a97@sorpippo>

Hi All!

After making my mod_python I try to make install but...

...............CUT....................
Performing DSO installation.

/usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
/usr/bin/install: src/mod_python.so: No such file or directory
make[1]: *** [install_dso] Error 1
make[1]: Leaving directory `/usr/src/mod_python-3.0.1'
make: *** [install] Error 2
..........................................

What does it mean?

Regards.

Gius.


From nathanr at nathanr.net  Tue Dec 10 19:03:09 2002
From: nathanr at nathanr.net (Nathan Robertson)
Date: Fri Jan  9 21:59:48 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
In-Reply-To: <002001c2a021$66b50720$1c291a97@sorpippo>
References: <002001c2a021$66b50720$1c291a97@sorpippo>
Message-ID: <1039507390.8428.0.camel@moosehead>

On Tue, 2002-12-10 at 18:54, Zoper wrote:
> Hi All!
> 
> After making my mod_python I try to make install but...
> 
> ...............CUT....................
> Performing DSO installation.
> 
> /usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
> /usr/bin/install: src/mod_python.so: No such file or directory
> make[1]: *** [install_dso] Error 1
> make[1]: Leaving directory `/usr/src/mod_python-3.0.1'
> make: *** [install] Error 2
> ..........................................

I saw this today. Are you running RedHat 8.0?

Nathan.



From zoper at libero.it  Tue Dec 10 12:54:31 2002
From: zoper at libero.it (Zoper)
Date: Fri Jan  9 21:59:48 2004
Subject: [mod_python] mod_python 3.0.1: error after make install ---> Debian
References: <002001c2a021$66b50720$1c291a97@sorpippo> <1039507390.8428.0.camel@moosehead>
Message-ID: <001501c2a042$e99c1040$2c281a97@sorpippo>

----- Original Message -----
From: "Nathan Robertson" <nathanr@nathanr.net>
To: "Zoper" <zoper@libero.it>
Cc: "modpython" <mod_python@modpython.org>
Sent: Tuesday, December 10, 2002 9:03 AM
Subject: Re: [mod_python] mod_python 3.0.1: error after make install



> I saw this today. Are you running RedHat 8.0?

I'm running Debian 2.2 r5.
Have you any idea about this ugly message?
                /usr/bin/install: src/mod_python.so: No such file or
directory

Thanks a lot.

Giuseppe.


From i at mindlace.net  Tue Dec 10 08:59:06 2002
From: i at mindlace.net (emf)
Date: Fri Jan  9 21:59:48 2004
Subject: [mod_python] mod_python 3.0.1: error after make install --->
 Debian
In-Reply-To: <001501c2a042$e99c1040$2c281a97@sorpippo>
References: <002001c2a021$66b50720$1c291a97@sorpippo> <1039507390.8428.0.camel@moosehead> <001501c2a042$e99c1040$2c281a97@sorpippo>
Message-ID: <3DF5F32A.60005@mindlace.net>

Zoper wrote:

> I'm running Debian 2.2 r5.

You know, if you upgrade to a mixed testing/unstable distribution you 
can just

apt-get -t unstable install mod_python

(assuming you've already

apt-get -t unstable install apache2

)

See section 3.8 for more info:

http://www.debian.org/doc/manuals/apt-howto/ch-apt-get.en.html

~mindlace


From jayaare at earthlink.net  Tue Dec 10 10:56:03 2002
From: jayaare at earthlink.net (john riehl aka j.r.)
Date: Fri Jan  9 21:59:48 2004
Subject: [mod_python] [Fwd: suse 8.0 obcallback problem.]
Message-ID: <3DF638C3.6090508@earthlink.net>


-------- Original Message --------
Subject: suse 8.0 obcallback problem.
Date: Sun, 08 Dec 2002 21:45:51 -0800
From: john riehl aka j.r. <jayaare@earthlink.net>
To: mod_python@modpython.org

This is an informational item.  I want others to avoid the pain I had.
I was about to ask the list for help, when I solved the problem.

The system:  suse 8.0, patched, on intel xeon 2.0 ghz system
(hyperthreading).  apache 1.3.23-142, python-2.2-105,
mod_python-2.7.8-6, mod_ssl-2.8.7-110

The problem:
calling the hello world test script mptest returns an internal error 500
code, with the following messages:
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
[Sun Dec  8 20:57:06 2002] [error] [client 66.215.65.63] python_handler:
make_obcallback returned no obCallBack!

I tried all sorts of stuff, based on complaints/suggestions in web logs,
which made no effect (checking permissions, links from apache to
mod_python, setting PythonPath, PythonInterpreter, setting .htaccess).

The problem was a missing link, from the python libraries to the
mod_python libraries.  with the suse configuration, that means that
/usr/lib/python2.2/site-packages/mod_python should be a symbolic link
pointing to /usr/lib/apache/lib/python2.2/site-packages/mod_python.
To correct, go to /usr/lib/python2.2/site-packages/, and link it thusly:
ln -s /usr/lib/apache/lib/python2.2/site-packages/mod_python/ mod_python

none of the problems/solutions that I reviewed addressed this facet.

Hope it helps,

jr







From conrad at hep.caltech.edu  Tue Dec 10 11:19:16 2002
From: conrad at hep.caltech.edu (Conrad Steenberg)
Date: Fri Jan  9 21:59:48 2004
Subject: [mod_python] [Fwd: suse 8.0 obcallback problem.]
In-Reply-To: <3DF638C3.6090508@earthlink.net>
References: <3DF638C3.6090508@earthlink.net>
Message-ID: <1039547956.312.42.camel@heppc22.hep.caltech.edu>

Hi

Just to add to this: one way to diagnose module/library load problems
with mod_python in general is to strace a single-process apache server
e.g.:

strace /usr/sbin/httpd -X 2> error_log

You will see all the paths that apache/python tries to look for modules.

Cheers

COnrad

On Tue, 2002-12-10 at 10:56, john riehl aka j.r. wrote:
> -------- Original Message --------
> Subject: suse 8.0 obcallback problem.
> Date: Sun, 08 Dec 2002 21:45:51 -0800
> From: john riehl aka j.r. <jayaare@earthlink.net>
> To: mod_python@modpython.org
> 
> This is an informational item.  I want others to avoid the pain I had.
> I was about to ask the list for help, when I solved the problem.
> 
> The system:  suse 8.0, patched, on intel xeon 2.0 ghz system
> (hyperthreading).  apache 1.3.23-142, python-2.2-105,
> mod_python-2.7.8-6, mod_ssl-2.8.7-110
> 
> The problem:
> calling the hello world test script mptest returns an internal error 500
> code, with the following messages:
> make_obcallback(): could not import mod_python.apache.
> make_obcallback(): could not call init.
> [Sun Dec  8 20:57:06 2002] [error] [client 66.215.65.63] python_handler:
> make_obcallback returned no obCallBack!
> 
> I tried all sorts of stuff, based on complaints/suggestions in web logs,
> which made no effect (checking permissions, links from apache to
> mod_python, setting PythonPath, PythonInterpreter, setting .htaccess).
> 
> The problem was a missing link, from the python libraries to the
> mod_python libraries.  with the suse configuration, that means that
> /usr/lib/python2.2/site-packages/mod_python should be a symbolic link
> pointing to /usr/lib/apache/lib/python2.2/site-packages/mod_python.
> To correct, go to /usr/lib/python2.2/site-packages/, and link it thusly:
> ln -s /usr/lib/apache/lib/python2.2/site-packages/mod_python/ mod_python
> 
> none of the problems/solutions that I reviewed addressed this facet.
> 
> Hope it helps,
> 
> jr
> 
> 
> 
> 
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
-- 
Conrad Steenberg <conrad@hep.caltech.edu>


From vmanera at manord.com  Thu Dec 12 17:47:45 2002
From: vmanera at manord.com (Manera, Villiam)
Date: Fri Jan  9 21:59:48 2004
Subject: [mod_python] problem with file download in mod-python 3.0.1
Message-ID: <52DC70C1C1575C418CB033523A29CF14104883@exchange2000.manord.com>

I'm testing mod-python 3.0.1 with apache 2.0.43 and python 2.2.2

I've founded a older problem in file download (from python 2.1 to 2.2)

the workaround is still the same:

in publisher.py:

 class File:
     """ Like a file, but also has headers and filename
     """
     def __init__(self, field):
         # steal all the file-like methods
         for m in dir(field.file):            
		 self.__dict__[m] = getattr(field.file, m)
 
         self.headers = field.headers
         self.filename = field.filename
======================workaround
==============================================
 class File:
     """ Like a file, but also has headers and filename
     """
     def __init__(self, field):
         # steal all the file-like methods
         #for m in dir(field.file):    #dont' work
         for m in self.sim_methods(field.file):
             self.__dict__[m] = getattr(field.file, m)
 
         self.headers = field.headers
         self.filename = field.filename
    
	#new--------	
     def sim_methods(self,obj):
         from types import BuiltinMethodType   
         return filter(lambda s, t=obj:
            type(getattr(t, s)) == BuiltinMethodType, dir(obj))
 
 
I hope it will be put in place

regards

Villiam Manera

From brianh at exelixis.com  Thu Dec 12 11:26:42 2002
From: brianh at exelixis.com (Brian Hawthorne)
Date: Fri Jan  9 21:59:48 2004
Subject: [mod_python] problem with file download in mod-python 3.0.1
In-Reply-To: <52DC70C1C1575C418CB033523A29CF14104883@exchange2000.manord.com>
Message-ID: <Pine.GSO.4.05.10212121123570.4656-100000@timeless.exelixis.com>

i'm not sure what the point is of wrapping the field object like this.
why not just use the field object itself as the value for the file upload
arg?  i cut this part out of my publisher because it seemed unnecessary.

brian hawthorne


On Thu, 12 Dec 2002, Manera, Villiam wrote:

> I'm testing mod-python 3.0.1 with apache 2.0.43 and python 2.2.2
> 
> I've founded a older problem in file download (from python 2.1 to 2.2)
> 
> the workaround is still the same:
> 
> in publisher.py:
> 
>  class File:
>      """ Like a file, but also has headers and filename
>      """
>      def __init__(self, field):
>          # steal all the file-like methods
>          for m in dir(field.file):            
> 		 self.__dict__[m] = getattr(field.file, m)
>  
>          self.headers = field.headers
>          self.filename = field.filename
> ======================workaround
> ==============================================
>  class File:
>      """ Like a file, but also has headers and filename
>      """
>      def __init__(self, field):
>          # steal all the file-like methods
>          #for m in dir(field.file):    #dont' work
>          for m in self.sim_methods(field.file):
>              self.__dict__[m] = getattr(field.file, m)
>  
>          self.headers = field.headers
>          self.filename = field.filename
>     
> 	#new--------	
>      def sim_methods(self,obj):
>          from types import BuiltinMethodType   
>          return filter(lambda s, t=obj:
>             type(getattr(t, s)) == BuiltinMethodType, dir(obj))
>  
>  
> I hope it will be put in place
> 
> regards
> 
> Villiam Manera
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From listmail at xs4all.nl  Thu Dec 12 22:30:15 2002
From: listmail at xs4all.nl (bvr)
Date: Fri Jan  9 21:59:48 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
In-Reply-To: <002001c2a021$66b50720$1c291a97@sorpippo>
References: <002001c2a021$66b50720$1c291a97@sorpippo>
Message-ID: <3DF8FFE7.7070100@xs4all.nl>

Hi,

Same problem here, tried several installations with RH 7.3.

tried installing these:
python2-2.2-16.i386.rpm
python2-devel-2.2-16.i386.rpm
python2-docs-2.2-16.i386.rpm

and:
untar Python-2.2.2.tgz
configure --without-threads
make && make install

both with no errors, cli interpreter works fine

compiled mod python 3.0.1 like this:

configure --with-apxs=/usr/local/apache2/bin/apxs 
--with-python=/usr/local/bin/python2
make

everything looks fine untill I get these warnings at the end:

/usr/local/apache/build/libtool --silent --mode=link gcc -o 
mod_python.la -I/store/install/mod_python-3.0.1/src/include 
-I/usr/local/apache/include -I/usr/local/include/python2.2  -rpath 
/usr/local/apache/modules -module -avoid-version  hlistobject.lo 
hlist.lo filterobject.lo connobject.lo serverobject.lo util.lo 
tableobject.lo requestobject.lo _apachemodule.lo mod_python.lo 
-L/usr/local/lib/python2.2/config -Xlinker -export-dynamic -lm 
-lpython2.2 -ldl -lutil -lm

*** Warning: This library needs some functionality provided by -lpython2.2.
*** I have the capability to make that library automatically link in when
*** you link to this library.  But I can only do this if you have a
*** shared version of the library, which you do not appear to have.

*** Warning: libtool could not satisfy all declared inter-library
*** dependencies of module mod_python.  Therefore, libtool will create
*** a static module, that should work as long as the dlopening
*** application is linked with the -dlopen flag.

afterwards it appears src/mod_python.so has not been created.

my best guess is that i need a libpython2.2.so but i can't figure how
to get it ??


please help!

bvr.


Zoper wrote:
> Hi All!
> 
> After making my mod_python I try to make install but...
> 
> ...............CUT....................
> Performing DSO installation.
> 
> /usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
> /usr/bin/install: src/mod_python.so: No such file or directory
> make[1]: *** [install_dso] Error 1
> make[1]: Leaving directory `/usr/src/mod_python-3.0.1'
> make: *** [install] Error 2
> ..........................................


From grisha at modpython.org  Thu Dec 12 21:13:22 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:48 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
In-Reply-To: <3DF8FFE7.7070100@xs4all.nl>
Message-ID: <20021212211044.R53709-100000@eden.ispol.com>

You don't need without-threads when compiling python. I don't know if its
the cause of the problem, but it's a start. Also, make sure you have
libtool 1.4.x. Lastly, if you compiled your own apache, try recompiling it
by first running ./buildconf, then ./configure, etc.

On Thu, 12 Dec 2002, bvr wrote:

>
> Hi,
>
> Same problem here, tried several installations with RH 7.3.
>
> tried installing these:
> python2-2.2-16.i386.rpm
> python2-devel-2.2-16.i386.rpm
> python2-docs-2.2-16.i386.rpm
>
> and:
> untar Python-2.2.2.tgz
> configure --without-threads
> make && make install
>
> both with no errors, cli interpreter works fine
>
> compiled mod python 3.0.1 like this:
>
> configure --with-apxs=/usr/local/apache2/bin/apxs
> --with-python=/usr/local/bin/python2
> make
>
> everything looks fine untill I get these warnings at the end:
>
> /usr/local/apache/build/libtool --silent --mode=link gcc -o
> mod_python.la -I/store/install/mod_python-3.0.1/src/include
> -I/usr/local/apache/include -I/usr/local/include/python2.2  -rpath
> /usr/local/apache/modules -module -avoid-version  hlistobject.lo
> hlist.lo filterobject.lo connobject.lo serverobject.lo util.lo
> tableobject.lo requestobject.lo _apachemodule.lo mod_python.lo
> -L/usr/local/lib/python2.2/config -Xlinker -export-dynamic -lm
> -lpython2.2 -ldl -lutil -lm
>
> *** Warning: This library needs some functionality provided by -lpython2.2.
> *** I have the capability to make that library automatically link in when
> *** you link to this library.  But I can only do this if you have a
> *** shared version of the library, which you do not appear to have.
>
> *** Warning: libtool could not satisfy all declared inter-library
> *** dependencies of module mod_python.  Therefore, libtool will create
> *** a static module, that should work as long as the dlopening
> *** application is linked with the -dlopen flag.
>
> afterwards it appears src/mod_python.so has not been created.
>
> my best guess is that i need a libpython2.2.so but i can't figure how
> to get it ??
>
>
> please help!
>
> bvr.
>
>
> Zoper wrote:
> > Hi All!
> >
> > After making my mod_python I try to make install but...
> >
> > ...............CUT....................
> > Performing DSO installation.
> >
> > /usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
> > /usr/bin/install: src/mod_python.so: No such file or directory
> > make[1]: *** [install_dso] Error 1
> > make[1]: Leaving directory `/usr/src/mod_python-3.0.1'
> > make: *** [install] Error 2
> > ..........................................
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From vmanera at manord.com  Fri Dec 13 08:58:14 2002
From: vmanera at manord.com (Manera, Villiam)
Date: Fri Jan  9 21:59:48 2004
Subject: R: [mod_python] problem with file download in mod-python 3.0.1
Message-ID: <52DC70C1C1575C418CB033523A29CF140E0589@exchange2000.manord.com>

Ok, but on  Fri, 7 Jun 2002 Grisha wrote to me about this problem:

Yes, whatever free time I have I try to spend on the 3.0 version that will
run on Apache 2.0. Probably the simplest way to tackle this one is for
someone to add the publisher patch to the FAQ, at least for the time
being.

Grisha

So I hope that in mod-python 3.0.2 a patch for this problem will be added

Villiam Manera
-----Messaggio originale-----
Da: Brian Hawthorne [mailto:brianh@exelixis.com]
Inviato: gioved? 12 dicembre 2002 20.27
A: Manera, Villiam
Cc: Mod_python@modpython.org
Oggetto: Re: [mod_python] problem with file download in mod-python 3.0.1


i'm not sure what the point is of wrapping the field object like this.
why not just use the field object itself as the value for the file upload
arg?  i cut this part out of my publisher because it seemed unnecessary.

brian hawthorne


On Thu, 12 Dec 2002, Manera, Villiam wrote:

> I'm testing mod-python 3.0.1 with apache 2.0.43 and python 2.2.2
> 
> I've founded a older problem in file download (from python 2.1 to 2.2)
> 
> the workaround is still the same:
> 
> in publisher.py:
> 
>  class File:
>      """ Like a file, but also has headers and filename
>      """
>      def __init__(self, field):
>          # steal all the file-like methods
>          for m in dir(field.file):            
> 		 self.__dict__[m] = getattr(field.file, m)
>  
>          self.headers = field.headers
>          self.filename = field.filename
> ======================workaround
> ==============================================
>  class File:
>      """ Like a file, but also has headers and filename
>      """
>      def __init__(self, field):
>          # steal all the file-like methods
>          #for m in dir(field.file):    #dont' work
>          for m in self.sim_methods(field.file):
>              self.__dict__[m] = getattr(field.file, m)
>  
>          self.headers = field.headers
>          self.filename = field.filename
>     
> 	#new--------	
>      def sim_methods(self,obj):
>          from types import BuiltinMethodType   
>          return filter(lambda s, t=obj:
>             type(getattr(t, s)) == BuiltinMethodType, dir(obj))
>  
>  
> I hope it will be put in place
> 
> regards
> 
> Villiam Manera
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From fuf at mobil.cz  Fri Dec 13 09:10:35 2002
From: fuf at mobil.cz (Michal Vitecek)
Date: Fri Jan  9 21:59:48 2004
Subject: [mod_python] problem with file download in mod-python 3.0.1
In-Reply-To: <52DC70C1C1575C418CB033523A29CF14104883@exchange2000.manord.com>
References: <52DC70C1C1575C418CB033523A29CF14104883@exchange2000.manord.com>
Message-ID: <20021213081034.GA5296@diana.mobil.cz>

Manera, Villiam wrote:

[snip]

>     def sim_methods(self,obj):
>         from types import BuiltinMethodType   
>         return filter(lambda s, t=obj:
>            type(getattr(t, s)) == BuiltinMethodType, dir(obj))

 I just wanted to say that code using lambda functions is considerably
 slower than when it uses list comprehensions. thus the above is faster
 with:
    
    def sim_methods(self, obj):
	from types import BuiltinMethodType
	return [attribute for attribute in dir(obj) if (type(getattr(obj,
		attribute)) == BuiltinMethodType)]

-- 
		fuf		(fuf@mobil.cz)

From listmail at xs4all.nl  Sat Dec 14 00:09:57 2002
From: listmail at xs4all.nl (baz)
Date: Fri Jan  9 21:59:48 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
In-Reply-To: <20021212211044.R53709-100000@eden.ispol.com>
References: <20021212211044.R53709-100000@eden.ispol.com>
Message-ID: <3DFA68C5.5070806@xs4all.nl>

thanks for the input, but..

did try without the without-threads before,
but had the same problem.

using this rpm version of libtool
libtool-libs-1.4.2-7
libtool-1.4.2-7

tried buildconf for apache, didn't change the problem at all

my questions are: is there such a thing as a libpython.so for python 2.2 
? if so, how would i normally produce this file ?

really hoped i could've made some progress on this issue, really want to 
move on to actually programming something .. ;)

grtz,
baz.

Gregory (Grisha) Trubetskoy wrote:
> You don't need without-threads when compiling python. I don't know if its
> the cause of the problem, but it's a start. Also, make sure you have
> libtool 1.4.x. Lastly, if you compiled your own apache, try recompiling it
> by first running ./buildconf, then ./configure, etc.
> 
> On Thu, 12 Dec 2002, bvr wrote:
>>Hi,
>>
>>Same problem here, tried several installations running RH 7.3.


From geertj at boskant.nl  Sun Dec 15 19:39:09 2002
From: geertj at boskant.nl (Geert Jansen)
Date: Fri Jan  9 21:59:48 2004
Subject: [mod_python] Annouce: Draco dynamic content system
Message-ID: <20021215183909.GD8533@vader.boskant.nl>

Hello fellow Pythoneers,

I'd like to announce the free availability of my latest mod_python project
to the list: the Draco dynamic content system.

Draco is a framework for creating dynamic web sites and and web applications.

What I like about Draco is that it is structured around a nice paradigm for a
clean separation of code (Python) and markup (html). Program code in Draco is
split in two parts: program logic and markup logic. Program logic is put in
the so-called handlers.  These handlers process the user's request and put the
result in a namespace called the interface. On the other hand, markup logic is
put in a template. The template is a regular template as seen in many dynamic
content systems but its task in Draco is much more limited. It should only
format the data in the interface in the html and nothing more.

Draco offers a large standard library with functionality that is often used in
dynamic web sites. This includes: automated session management, a limited form
of user management, easy form parsing and feedback, events, task scheduling (no
more cron!) and tag rewriting.

Draco is freely available under the GPL. More information can be found on
the Draco website at http://draco.boskant.nl/.

Thanks,
Geert Jansen

From jirka.machotka at seznam.cz  Sun Dec 15 21:04:20 2002
From: jirka.machotka at seznam.cz (=?iso-8859-2?Q?Jirka=20Machotka?=)
Date: Fri Jan  9 21:59:48 2004
Subject: [mod_python] =?iso-8859-2?Q?Re=3A=20R=3A=20=5Bmod=5Fpython=5D=20Problems=20with=20mptest=2Epy=20=28Windows=29?=
In-Reply-To: <52DC70C1C1575C418CB033523A29CF140E0570@exchange2000.manord.com>
Message-ID: <3912.4583-28975-439333470-1039982660@seznam.cz>

This is an informational issue covering somehow the solution to my
problem. It sums up few other answers - thanx for all of them! - and
as such it should be a simple handy to anyone who wants to run the
Apache with mod_python on Windows. I'd love to have something like
that a month ago (it'd spare me from few white hairs by now)

1. if you install the Apache and you want to connact it to the python
interpret all you need is a file called mod_python.so

Put it to the /modules subdirectory and add the line
   LoadModule python_module modules/mod_python.so 
to the httpd.conf

Restart the Apache server. If you get an error (cannot load
C:\...\modules\mod_python.so into server: the module could not be
found ) you need to get a file called msvcr70.dll (e.g. from
www.dll-files.com/dllindex/dll-files.shtml?msvcr70) and copy it into
\winnt\system32 (thanx to Duncan Booth for this hint). Do not forget
to restart the Apache when it's done.

This and the modification of httpd.conf file as described in the
manual should be enough so that the Apache sends all the file with
*.py extension to be processed by python

2. in order to be able to use Apache related objects in python you
need also their sources. Get the mod_python-3.0.1.tgz file, unpack
it, find the subdirectory called \site-packages and copy it into the
subdirectory of the same name of your Python installation. I know it
sounds obvious for anyone who knows about it, but honestly I could
not get this point from the manual. 

If you don't do it you will face the same problems as I did (just
scroll below for details)


Dne 5.?prosinec?2002, Manera, Villiam, <vmanera@manord.com> napsal:

> e circa il problema che dava a te?
> 
> -----Messaggio originale-----
> Da: Jirka Machotka [mailto:jirka.machotka@seznam.cz]
> Inviato: giovedi 5 dicembre 2002 12.18
> A: mod_python@modpython.org
> Oggetto: [mod_python] Problems with mptest.py (Windows)
> 
> 
> Hello there,
> 
> I have probably a very basic question. However, I could not find
> anything relevant (a searching machine would be fine)
> 
> I had had problems with running the mod_python for Apache 2.0.43.
> Following the advice I had gotten the msvcr70.dll, put it to the
> required directory and restarted the Apache. The Apache starts,
> however, when I try to fetch mptest.py (it looks exactly as described
> in the manual, the configuration file httpd has been modified
> accordingly) I receive an error:
> 
> make_obcallback: could not import mod_python.apache
> 
> To my understanding the problem relates rather to Python (my version
> is 2.2.1). The manual mentions that Python environment must be
> recompiled, or what. I'm afraid that's not possible for me
> (recompiled in what?) Or am I missing something inportant?
> 
> 
> Please help. Thanks in advance.
> 
> Jiri
> 
> ______________________________________________________________________
> Reklama:
> Sout?? o auto na v?kend, autor?dio Clarion a dal?? ceny:
> http://ad2.seznam.cz/redir.cgi?instance=12345%26url=http://www.auto-plus.cz
>  - nejlep?? syst?m prodeje ojet?ch voz? na internetu
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 

______________________________________________________________________
Reklama:
Vyhrajte cenu za 100.000,- Kc v soute?i "Svetem Financ?
za 30 dn?" na http://soutez.finance.cz. Ne? V?s predbehnou jin?!


From jw9 at softhome.net  Sun Dec 15 16:44:56 2002
From: jw9 at softhome.net (jw9@softhome.net)
Date: Fri Jan  9 21:59:48 2004
Subject: [mod_python] How to use CGI handler?
Message-ID: <000901c2a483$39291560$4b00a8c0@laptop>

I got a big python CGI script which I would like to rewrite using
mod_python. In the meanwhile, I want to try CGI handler.

Did a simple test using CGI handler, doesn't work well. Here is my config
files, all my scripts are in cgi-bin folder:

httpd.conf:
.......
<Directory "D:/Apache2/cgi-bin">
AddHandler python-program .py
AllowOverride All
PythonDebug ON
</Directory>

.htaccess file under D:/Apache2/cgi-bin:
***********************
SetHandler python-program
PythonHandler mod_python.cgihandler

very simple test script:
***********************
print 'Content-type: text/html\n'
print 'Hello World!'


result:
***********************
Mod_python error: "PythonHandler mod_python.cgihandler" Traceback (most
recent call last): File "D:\PYTHON22\Lib\mod_python\apache.py", line 335, in
HandlerDispatch result = object(req) File
"D:\PYTHON22\Lib\mod_python\cgihandler.py", line 140, in handler
apache.restore_nocgi(env, si, so) File
"D:\PYTHON22\Lib\mod_python\apache.py", line 764, in restore_nocgi for k in
osenv: RuntimeError: dictionary changed size during iteration

I don't what is wrong.  Anybody have the same experience? By the way, the
mptest.py worked, so I guess at least the installation was succesful.

Thanks!


From sebastian.tusk at gmx.net  Sun Dec 15 23:09:02 2002
From: sebastian.tusk at gmx.net (Sebastian Tusk)
Date: Fri Jan  9 21:59:48 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
In-Reply-To: <3DFA68C5.5070806@xs4all.nl>
References: <20021212211044.R53709-100000@eden.ispol.com> <3DFA68C5.5070806@xs4all.nl>
Message-ID: <3DFCFD7E.7000105@gmx.net>

 > *** Warning: This library needs some functionality provided by
 > -lpython2.2.
 > *** I have the capability to make that library automatically link in
 > when
 > *** you link to this library.  But I can only do this if you have a
 > *** shared version of the library, which you do not appear to have.

The problem is that apache 2 comes with an old version of libtool and 
uses that. mod_python uses via apxs the same outdated version. So you 
need to replace libtool in the apache 2 source distribution and rebuild 
apache and then rebuild mod_python. At least that works for me.

Sebastian



From geo at overweb.it  Mon Dec 16 17:42:50 2002
From: geo at overweb.it (Geo)
Date: Fri Jan  9 21:59:48 2004
Subject: [mod_python] Different PythonHander
Message-ID: <1040056970.3dfe028ae35eb@phpgroupware.overweb.it>

How can I set httpd.conf to have a different PythonHandler
for each user?

I need something like this:

<Directory "/usr/home/*/public_html">
      AddHandler python-program .py
      PythonHandler mptest
      PythonDebug on
</Directory>

Thanks

-- 
Gerolamo Valcamonica

From zoper at libero.it  Tue Dec 17 13:40:04 2002
From: zoper at libero.it (Zoper)
Date: Fri Jan  9 21:59:48 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
References: <20021212211044.R53709-100000@eden.ispol.com> <3DFA68C5.5070806@xs4all.nl> <3DFCFD7E.7000105@gmx.net>
Message-ID: <001e01c2a5c9$91e4dda0$c4281a97@sorpippo>

Hi All.

> The problem is that apache 2 comes with an old version of libtool and 
> uses that. mod_python uses via apxs the same outdated version. So you 
> need to replace libtool in the apache 2 source distribution and rebuild 
> apache and then rebuild mod_python. At least that works for me.

How can I replace libtool in the apache 2 source distribution?

Is this the right way to preceed?

tar xvfz libtool-1.4.2.tar.gz
cd libtool-1.4.2 
./configure --prefix=/usr
make
make install 

and then 

cd httpd-2.0.39 
./configure 
make ; make install


Thanks in advance.


Gius.



From sebastian.tusk at gmx.net  Tue Dec 17 13:50:26 2002
From: sebastian.tusk at gmx.net (Sebastian Tusk)
Date: Fri Jan  9 21:59:48 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
In-Reply-To: <001e01c2a5c9$91e4dda0$c4281a97@sorpippo>
References: <20021212211044.R53709-100000@eden.ispol.com> <3DFA68C5.5070806@xs4all.nl> <3DFCFD7E.7000105@gmx.net> <001e01c2a5c9$91e4dda0$c4281a97@sorpippo>
Message-ID: <3DFF1D92.1010204@gmx.net>

> How can I replace libtool in the apache 2 source distribution?
> 
> Is this the right way to preceed?
> 
> tar xvfz libtool-1.4.2.tar.gz
> cd libtool-1.4.2 
> ./configure --prefix=/usr
> make
> make install 
> 
> and then 
> 
> cd httpd-2.0.39 
> ./configure 
> make ; make install

That will not work. Apache comes with its own libtool. Replace 
httpd-2.0.43/srclib/apr/libtool with that from your system (e.g. 
/usr/local/bin/libtool) Then rebuild apache and mod_python.

Sebastian


From grisha at modpython.org  Tue Dec 17 10:08:57 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:48 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
In-Reply-To: <001e01c2a5c9$91e4dda0$c4281a97@sorpippo>
Message-ID: <20021217100543.X15809-100000@eden.ispol.com>

You can replace the libtool apache comes with by running ./buildconf just
before running apache's ./configure. Among other things, ./buildconf takes
the libtool on the system and incorporates it into apache. I think what's
happening is 2.0.43 in particular came bundled with an outdated libtool by
mistake.

Grisha

On Tue, 17 Dec 2002, Zoper wrote:

> Hi All.
>
> > The problem is that apache 2 comes with an old version of libtool and
> > uses that. mod_python uses via apxs the same outdated version. So you
> > need to replace libtool in the apache 2 source distribution and rebuild
> > apache and then rebuild mod_python. At least that works for me.
>
> How can I replace libtool in the apache 2 source distribution?
>
> Is this the right way to preceed?
>
> tar xvfz libtool-1.4.2.tar.gz
> cd libtool-1.4.2
> ./configure --prefix=/usr
> make
> make install
>
> and then
>
> cd httpd-2.0.39
> ./configure
> make ; make install
>
>
> Thanks in advance.
>
>
> Gius.
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From grisha at modpython.org  Tue Dec 17 16:30:53 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:48 2004
Subject: [mod_python] bug/misfeature in publisher/mod_python
In-Reply-To: <20021203151244.GB16590@legolas.on.net.mk>
Message-ID: <20021217162845.N19724-100000@eden.ispol.com>

On Tue, 3 Dec 2002, Damjan wrote:

> My setup:
>  apache 2.0.43, mod_python 3.0.1, python 2.2.1
>
> httpd.conf:
> <Directory /home/www/htdocs> # The root of the web server
> ...
>     SetHandler python-program
>     PythonHandler mod_python.publisher | .py
>     PythonDebug On
> </Directory>
> ...
>
> I expect this setup to handle all files ending in ".py" through
> the publisher handler.
>
> I have the script "hello.py" from the mod_python manual in the root of the
> web-server. Trying to get "http://127.1/hello.py/say" mod_python
> throws an exception (traceback atached).
>
> The exception is: "ImportError: No module named py"

But http://127.1/hello/say (without .py) should work.

(I still agree that this is a problem, just wanted to point out that there
is one way to make it work)

Grisha



From listmail at xs4all.nl  Wed Dec 18 00:11:46 2002
From: listmail at xs4all.nl (baz)
Date: Fri Jan  9 21:59:49 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
In-Reply-To: <002001c2a021$66b50720$1c291a97@sorpippo>
References: <002001c2a021$66b50720$1c291a97@sorpippo>
Message-ID: <3DFFAF32.1010600@xs4all.nl>

i solved my problem, maybe you've got the same so check this:

try
# locate libpython2.2.so

if nothing comes up you don't have the python shared library, which is 
needed by mod python.

i used the following commands to build it from source and install it:

cd Python-2.2.2/
make distclean
./configure
make OPT="-fpic -O2"
mkdir .extract
(cd .extract; ar xv ../libpython2.2.a)
gcc -shared -o libpython2.2.so .extract/*.o
rm -rf .extract
make install

or you may install the separate debian package for this file

have fun!

baz.

Zoper wrote:
> Hi All!
> 
> After making my mod_python I try to make install but...
> 
> ...............CUT....................
> Performing DSO installation.
> 
> /usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
> /usr/bin/install: src/mod_python.so: No such file or directory
> make[1]: *** [install_dso] Error 1
> make[1]: Leaving directory `/usr/src/mod_python-3.0.1'
> make: *** [install] Error 2
> ..........................................
> 


From zoper at libero.it  Wed Dec 18 17:06:23 2002
From: zoper at libero.it (Zoper)
Date: Fri Jan  9 21:59:49 2004
Subject: [mod_python] mod_python 3.0.1: problem with libtool and apache
Message-ID: <001301c2a6af$6cbfec40$602b1a97@sorpippo>

Hi All.

Thanks a lot for the previous answers.
I replaced the old libtool apache come with, but when I make apache I obtain
an ugly message...

libtool: link: cannot find the library `'
make[1]: *** [httpd] Error 1
make[1]: Leaving directory `/usr/src/httpd-2.0.43'
make: *** [all-recursive] Error 1

What does it mean?

Thanks in advance.

Gius.


From webmaster at obramaestraonline.com  Wed Dec 18 13:26:37 2002
From: webmaster at obramaestraonline.com (Rafael Fernandez)
Date: Fri Jan  9 21:59:49 2004
Subject: [mod_python] mod_python in Win32, Apache 2.0.43
Message-ID: <002d01c2a6ba$c8321b10$cc393242@Family>

Can somebody send me the code for running mod_python in Apache 2.0.43 in
the Win32 Platform?

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20021218/dac86ef0/attachment-0002.htm
From grisha at modpython.org  Wed Dec 18 15:08:13 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:49 2004
Subject: [mod_python] bug/misfeature in publisher/mod_python
In-Reply-To: <20021217162845.N19724-100000@eden.ispol.com>
Message-ID: <20021218150543.C29444-100000@eden.ispol.com>

I take it back, what I said below isn't true, it won't work :)

But I did patch up the latest CVS code so that it addresses this issue.

Grisha

On Tue, 17 Dec 2002, Gregory (Grisha) Trubetskoy wrote:

>
> On Tue, 3 Dec 2002, Damjan wrote:
>
> > My setup:
> >  apache 2.0.43, mod_python 3.0.1, python 2.2.1
> >
> > httpd.conf:
> > <Directory /home/www/htdocs> # The root of the web server
> > ...
> >     SetHandler python-program
> >     PythonHandler mod_python.publisher | .py
> >     PythonDebug On
> > </Directory>
> > ...
> >
> > I expect this setup to handle all files ending in ".py" through
> > the publisher handler.
> >
> > I have the script "hello.py" from the mod_python manual in the root of the
> > web-server. Trying to get "http://127.1/hello.py/say" mod_python
> > throws an exception (traceback atached).
> >
> > The exception is: "ImportError: No module named py"
>
> But http://127.1/hello/say (without .py) should work.
>
> (I still agree that this is a problem, just wanted to point out that there
> is one way to make it work)
>
> Grisha
>
>
>


From cameron at toolhouse.com  Wed Dec 18 14:28:52 2002
From: cameron at toolhouse.com (Cameron S. Watters)
Date: Fri Jan  9 21:59:49 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
In-Reply-To: <3DFFAF32.1010600@xs4all.nl>
Message-ID: <16154ED8-12D8-11D7-979F-00306599D91A@toolhouse.com>

Since I posted almost EXACTLY the same comment as the quoted one on 
December 4th, I thought I'd reply.

My understanding is that this shouldn't be necessary, but is, in fact, 
an issue with the version of libtool supplied with apache.

I was able to fix my problem by building apache from source by running:

tar -xzvf apache-tarball.tgz
cd apache-src-dir/
./buildconf
./configure --a mass of configure options
make
make install

you probably want to make sure you have a newish libtool installed 
BEFORE you do the above.

this made it stop freaking out because it couldn't find a 
libpython2.2.so. It is also my understanding that building libpython2.2 
doesn't actually do anything other than fool
the install portion of the build into continuing with the process and 
not erroring out.

I mention this mostly because this may NOT, in fact, be the most 
correct solution to this problem.

--cameron

> i solved my problem, maybe you've got the same so check this:
>
> try
> # locate libpython2.2.so
>
> if nothing comes up you don't have the python shared library, which is 
> needed by mod python.
>
> i used the following commands to build it from source and install it:
>
> cd Python-2.2.2/
> make distclean
> ./configure
> make OPT="-fpic -O2"
> mkdir .extract
> (cd .extract; ar xv ../libpython2.2.a)
> gcc -shared -o libpython2.2.so .extract/*.o
> rm -rf .extract
> make install
>
> or you may install the separate debian package for this file
>
> have fun!
>
> baz.
>
> Zoper wrote:
>> Hi All!
>> After making my mod_python I try to make install but...
>> ...............CUT....................
>> Performing DSO installation.
>> /usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
>> /usr/bin/install: src/mod_python.so: No such file or directory
>> make[1]: *** [install_dso] Error 1
>> make[1]: Leaving directory `/usr/src/mod_python-3.0.1'
>> make: *** [install] Error 2
>> ..........................................
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From gnb at itga.com.au  Thu Dec 19 18:27:04 2002
From: gnb at itga.com.au (Gregory Bond)
Date: Fri Jan  9 21:59:49 2004
Subject: [mod_python] import mod_puthon.util fails
Message-ID: <200212190727.SAA10103@lightning.itga.com.au>

[I'm brand new to mod_python and this list....]

FreeBSD 4-Stable (as of the other day, so it's after 4.7)

Apache 2.0.43, built from the FreeBSD port, with USE_THREADS

mod_python 3.0.1, built using "./configure && make"

hellcat$ python -c "import mod_python.util"
Traceback (most recent call last):
  File "<string>", line 1, in ?
  File "/usr/local/lib/python2.2/site-packages/mod_python/util.py", line 58, in ?
    import _apache
ImportError: No module named _apache
hellcat$ 

And indeed there is nothing that looks like _apache.so.  There is a src/
_apachemodule.c, which is compiled and linked into mod_python.so, which has 
what seems to be the intended contents of the _apache module, but this is 
never turned into the appropriate .so file.

Am I doing something wrong?



From zoper at libero.it  Thu Dec 19 15:53:53 2002
From: zoper at libero.it (Zoper)
Date: Fri Jan  9 21:59:49 2004
Subject: [mod_python] mod_python 3.0.1: problem with libtool and apache
Message-ID: <004e01c2a76e$74dbd3c0$022b1a97@sorpippo>

Hi All.

Thanks a lot for the previous answers.
I replaced the old libtool apache come with, but when I make apache I obtain
an ugly message...

libtool: link: cannot find the library `'
make[1]: *** [httpd] Error 1
make[1]: Leaving directory `/usr/src/httpd-2.0.43'
make: *** [all-recursive] Error 1

What does it mean?

Thanks in advance.

Gius.


From zoper at libero.it  Thu Dec 19 15:57:26 2002
From: zoper at libero.it (Zoper)
Date: Fri Jan  9 21:59:49 2004
Subject: [mod_python] mod_python 3.0.1: problem with libtool and apache
Message-ID: <006f01c2a76e$f2cda600$022b1a97@sorpippo>

Hi All.

Thanks a lot for the previous answers.
I replaced the old libtool apache come with, but when I make apache I obtain
an ugly message...

libtool: link: cannot find the library `'
make[1]: *** [httpd] Error 1
make[1]: Leaving directory `/usr/src/httpd-2.0.43'
make: *** [all-recursive] Error 1

What does it mean?

Thanks in advance.

Gius.


From grisha at modpython.org  Thu Dec 19 10:24:45 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:49 2004
Subject: [mod_python] import mod_puthon.util fails
In-Reply-To: <200212190727.SAA10103@lightning.itga.com.au>
Message-ID: <20021219102330.X43686-100000@eden.ispol.com>

No, you're not doing anything wrong, _apache is only available when
mod_python is loaded as an apache module, you can't really use any of
those modules from the command line.

On Thu, 19 Dec 2002, Gregory Bond wrote:

> [I'm brand new to mod_python and this list....]
>
> FreeBSD 4-Stable (as of the other day, so it's after 4.7)
>
> Apache 2.0.43, built from the FreeBSD port, with USE_THREADS
>
> mod_python 3.0.1, built using "./configure && make"
>
> hellcat$ python -c "import mod_python.util"
> Traceback (most recent call last):
>   File "<string>", line 1, in ?
>   File "/usr/local/lib/python2.2/site-packages/mod_python/util.py", line 58, in ?
>     import _apache
> ImportError: No module named _apache
> hellcat$
>
> And indeed there is nothing that looks like _apache.so.  There is a src/
> _apachemodule.c, which is compiled and linked into mod_python.so, which has
> what seems to be the intended contents of the _apache module, but this is
> never turned into the appropriate .so file.
>
> Am I doing something wrong?
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From sebastian.tusk at gmx.net  Thu Dec 19 20:15:12 2002
From: sebastian.tusk at gmx.net (Sebastian Tusk)
Date: Fri Jan  9 21:59:49 2004
Subject: [mod_python] AddOutputFilterByType not working
Message-ID: <3E021AC0.4010504@gmx.net>

The apache directive AddOutputFilterByType doesn't work for content 
generated by mod_python. The reason for this is the following line in 
requestobject.c

self->request_rec->content_type =
     apr_pstrdup(self->request_rec->pool, PyString_AsString(val));

which should read

ap_set_content_type(self->request_rec, PyString_AsString(val));


Sebastian


From gnb at itga.com.au  Fri Dec 20 09:28:58 2002
From: gnb at itga.com.au (Gregory Bond)
Date: Fri Jan  9 21:59:49 2004
Subject: [mod_python] import mod_puthon.util fails 
In-Reply-To: Your message of Thu, 19 Dec 2002 10:24:45 -0500.
Message-ID: <200212192228.JAA12799@lightning.itga.com.au>

>No, you're not doing anything wrong, _apache is only available when
>mod_python is loaded as an apache module, you can't really use any of
>those modules from the command line.

<lightbulb>Aha!</lightbulb>

Thanks.  I've submited an FAQ update.  [That faq wizard is kewl]



From gnb at itga.com.au  Fri Dec 20 17:33:18 2002
From: gnb at itga.com.au (Gregory Bond)
Date: Fri Jan  9 21:59:49 2004
Subject: [mod_python] cgi handler bug?
Message-ID: <200212200633.RAA17433@lightning.itga.com.au>

[FreeBSD 4.7, python 2.2.2, Apache 2.0.43, mod_python 3.0.1]

When I try and run something using cgihandler, I get the following error:

[Fri Dec 20 16:54:25 2002] [error] [client 192.168.71.163] PythonHandler mod_python.cgihandler:   File "/usr/local/lib/python2.2/site-packages/mod_python/apache.py", line 764, in restore_nocgi
    for k in osenv:
[Fri Dec 20 16:54:25 2002] [error] [client 192.168.71.163] PythonHandler mod_python.cgihandler: RuntimeError: dictionary changed size during iteration

Looking at mod_python/apache.py:restore_nocgi(), this does:
    for k in osenv:
        del osenv[k]

This is never going to be legal in Python 2.2.  Shouldn't this be 

    for k in osenv.keys():
        del osenv[k]

?

Having made that change, and a few little fixes to the cgi program, (__name__
== "__main__" is no longer true, "foo-bar.py" is not a good name as "import
foo-bar" is a syntax error) my cgi now runs inside mod_python.  But the HTML
generated by the CGI is sent twice, so my page displays double.  I've added 
debugging and the HTML is only being sent from the script once, as far as I 
can tell.  (i.e. I print a string of length 2132 bytes, but View Page Info 
shows 4215 bytes.   No, I have no idea where the missing 49 bytes are!)

Any clues?

Greg.



From grisha at modpython.org  Fri Dec 20 16:34:37 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:49 2004
Subject: [mod_python] problem with file download in mod-python 3.0.1
In-Reply-To: <52DC70C1C1575C418CB033523A29CF14104883@exchange2000.manord.com>
Message-ID: <20021220151113.I61260-100000@eden.ispol.com>

I must be missing something obvious, but without testing it and just by
looking at the code, I'm not sure I understand what the benefit is of
filtering out BuiltinMethodType, as opposed to just using straight
dir(obj).

The above might be a moot point since just as Brian Hawthorne suggested
I'm not sure why we don't need the File class at all and am in the process
of trying to fish out any memories from my tired brain about how it came
about in the fist place....

Grisha

On Thu, 12 Dec 2002, Manera, Villiam wrote:

> I'm testing mod-python 3.0.1 with apache 2.0.43 and python 2.2.2
>
> I've founded a older problem in file download (from python 2.1 to 2.2)
>
> the workaround is still the same:
>
> in publisher.py:
>
>  class File:
>      """ Like a file, but also has headers and filename
>      """
>      def __init__(self, field):
>          # steal all the file-like methods
>          for m in dir(field.file):
> 		 self.__dict__[m] = getattr(field.file, m)
>
>          self.headers = field.headers
>          self.filename = field.filename
> ======================workaround
> ==============================================
>  class File:
>      """ Like a file, but also has headers and filename
>      """
>      def __init__(self, field):
>          # steal all the file-like methods
>          #for m in dir(field.file):    #dont' work
>          for m in self.sim_methods(field.file):
>              self.__dict__[m] = getattr(field.file, m)
>
>          self.headers = field.headers
>          self.filename = field.filename
>
> 	#new--------
>      def sim_methods(self,obj):
>          from types import BuiltinMethodType
>          return filter(lambda s, t=obj:
>             type(getattr(t, s)) == BuiltinMethodType, dir(obj))
>
>
> I hope it will be put in place
>
> regards
>
> Villiam Manera
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>




From LBerezhny at DevIS.com  Sat Dec 21 20:53:41 2002
From: LBerezhny at DevIS.com (Lex Berezhny)
Date: Fri Jan  9 21:59:49 2004
Subject: [mod_python] installation problems
Message-ID: <1040522021.12314.421.camel@hortus>

hi all,

  I'm having trouble installing mod_python.

My environment:
Red Hat Linux release 7.3
gcc 2.96


My install process:

wget http://www.apache.org/dist/httpd/httpd-2.0.43.tar.gz
tar xzvf httpd-2.0.43.tar.gz
wget http://apache.webmeta.com/dist/httpd/modpython/mod_python-3.0.1.tgz
tar xzvf mod_python-3.0.1.tgz
wget http://www.python.org/ftp/python/2.2.2/Python-2.2.2.tgz
tar xzvf Python-2.2.2.tgz

cd httpd-2.0.43
./configure --prefix=/usr/local/apache2
make
make install 

cd ../Python-2.2.2/
./configure
make
make install

cd ../mod_python-3.0.1/
./configure --with-apxs=/usr/local/apache2/bin/apxs
--with-python=/usr/local/bin/python2.2
make
make install


Warning messages I get (during make):

*** Warning: This library needs some functionality provided by
-lpython2.2.
*** I have the capability to make that library automatically link in
when
*** you link to this library.  But I can only do this if you have a
*** shared version of the library, which you do not appear to have.

*** Warning: libtool could not satisfy all declared inter-library
*** dependencies of module mod_python.  Therefore, libtool will create
*** a static module, that should work as long as the dlopening
*** application is linked with the -dlopen flag.


The final, fatal, error (during make install):

make[2]: Leaving directory
`/usr/local/apache2install/mod_python-3.0.1/src'

Performing DSO installation.

/usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
/usr/bin/install: cannot stat `src/mod_python.so': No such file or
directory
make[1]: *** [install_dso] Error 1
make[1]: Leaving directory `/usr/local/apache2install/mod_python-3.0.1'
make: *** [install] Error 2




any help or pointers would be greatly appreciated,

 - lex


From grisha at modpython.org  Sat Dec 21 21:45:58 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:49 2004
Subject: [mod_python] installation problems
In-Reply-To: <1040522021.12314.421.camel@hortus>
Message-ID: <20021221214317.K81120-100000@eden.ispol.com>

Try this:

Make sure you have libtool 1.4.x, you can do this with libtool --version.

If/when you do, rebuild your apache like this:

cd httpd-2.0.43
./buildconf
./configure --prefix=/usr/local/apache2
make
make install

then ./configure and make mod_python.

On 21 Dec 2002, Lex Berezhny wrote:

> hi all,
>
>   I'm having trouble installing mod_python.
>
> My environment:
> Red Hat Linux release 7.3
> gcc 2.96
>
>
> My install process:
>
> wget http://www.apache.org/dist/httpd/httpd-2.0.43.tar.gz
> tar xzvf httpd-2.0.43.tar.gz
> wget http://apache.webmeta.com/dist/httpd/modpython/mod_python-3.0.1.tgz
> tar xzvf mod_python-3.0.1.tgz
> wget http://www.python.org/ftp/python/2.2.2/Python-2.2.2.tgz
> tar xzvf Python-2.2.2.tgz
>
> cd httpd-2.0.43
> ./configure --prefix=/usr/local/apache2
> make
> make install
>
> cd ../Python-2.2.2/
> ./configure
> make
> make install
>
> cd ../mod_python-3.0.1/
> ./configure --with-apxs=/usr/local/apache2/bin/apxs
> --with-python=/usr/local/bin/python2.2
> make
> make install
>
>
> Warning messages I get (during make):
>
> *** Warning: This library needs some functionality provided by
> -lpython2.2.
> *** I have the capability to make that library automatically link in
> when
> *** you link to this library.  But I can only do this if you have a
> *** shared version of the library, which you do not appear to have.
>
> *** Warning: libtool could not satisfy all declared inter-library
> *** dependencies of module mod_python.  Therefore, libtool will create
> *** a static module, that should work as long as the dlopening
> *** application is linked with the -dlopen flag.
>
>
> The final, fatal, error (during make install):
>
> make[2]: Leaving directory
> `/usr/local/apache2install/mod_python-3.0.1/src'
>
> Performing DSO installation.
>
> /usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
> /usr/bin/install: cannot stat `src/mod_python.so': No such file or
> directory
> make[1]: *** [install_dso] Error 1
> make[1]: Leaving directory `/usr/local/apache2install/mod_python-3.0.1'
> make: *** [install] Error 2
>
>
>
>
> any help or pointers would be greatly appreciated,
>
>  - lex
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From skremer at q.cis.uoguelph.ca  Sun Dec 22 01:47:25 2002
From: skremer at q.cis.uoguelph.ca (Stefan C. Kremer)
Date: Fri Jan  9 21:59:49 2004
Subject: [mod_python] Warning: This library needs some functionality provided by -lpython2.2.
Message-ID: <Pine.LNX.4.44.0212220126580.17196-100000@q.cis.uoguelph.ca>

Hi,

I just read another post about this message by Lex Berezhny and Gregory 
(Grisha) Trubetskoy after experiencing exactly the same problem.

It turns out that the command:

wget http://www.apache.org/dist/httpd/httpd-2.0.43.tar.gz

Provides a very old version of libtool:

$ /usr/local/apache/build/libtool --version
ltmain.sh (GNU libtool) 1.3.4-freebsd-ports (1.385.2.196 1999/12/07 
21:47:57)

By contrast, httpd-2.0.42 has libtool-1.4.2.
(wget http://www.apache.org/dist/httpd/old/httpd-2.0.42.tar.gz)
Any the mod_python install goes smoothly.

Anyone know what's going on with this?!?  Did someone at apache just
screw-up and include the wrong version?  Or is there a reason for this 
downgrade?

Is there an easy remedy to patch 2.0.43 to work correctly?  Can I 
just copy one libtool over the other?  Anyone willing 
to share advice/experiences is greatly appreciated.

Thanks,

	-Stefan

-- 
--
Dr. Stefan C. Kremer, Associate Prof.
Reynolds Building, 106
Dept. of Computing and Information Science
University of Guelph, Guelph, Ontario	N1G 2W1

WWW: http://q.cis.uoguelph.ca/~skremer
Tel: (519)824-4120 Ext.8913  Fax: (519)837-0323
E-mail:  skremer@uoguelph.ca


From alphasquad at web.de  Sun Dec 22 20:21:37 2002
From: alphasquad at web.de ([FTSB]Hawk)
Date: Fri Jan  9 21:59:49 2004
Subject: [mod_python] mod_python cgihandler bug?
Message-ID: <JFEBLGLFKE2CHD65CBA69EAFAJFQP.3e0610c1@Hawk>

Hello

I found some questions on the same topic but no answers.
I installed mod_python 3.0.1 on Win2k and Apache 2.0.43.
Everything seemed to be fine.
But when I tried to use the cgihandler I got an error.
The python script consists of two lines only:

print "content-type: text/plain \n\n"
print "<b>something</b>"

So I do not expect the error to be there. With PythonDebug On I got this message


<b>something</b>
<b>something</b>

Mod_python error: "PythonHandler mod_python.cgihandler"

Traceback (most recent call last):

  File "G:\PYTHON\PYTHON\lib\site-packages\mod_python\apache.py", line 335, in HandlerDispatch
    result = object(req)

  File "G:\PYTHON\PYTHON\lib\site-packages\mod_python\cgihandler.py", line 140, in handler
    apache.restore_nocgi(env, si, so)

  File "G:\PYTHON\PYTHON\lib\site-packages\mod_python\apache.py", line 764, in restore_nocgi
    for k in osenv:

RuntimeError: dictionary changed size during iteration


I need this cgihandler for a port of a rather large project.

Hawk





From grisha at modpython.org  Sun Dec 22 16:41:45 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:49 2004
Subject: [mod_python] Warning: This library needs some functionality
 provided by -lpython2.2.
In-Reply-To: <Pine.LNX.4.44.0212220126580.17196-100000@q.cis.uoguelph.ca>
Message-ID: <20021222164004.S90422-100000@eden.ispol.com>

On Sun, 22 Dec 2002, Stefan C. Kremer wrote:

> It turns out that the command:
>
> wget http://www.apache.org/dist/httpd/httpd-2.0.43.tar.gz
>
> Provides a very old version of libtool:
>
> $ /usr/local/apache/build/libtool --version
> ltmain.sh (GNU libtool) 1.3.4-freebsd-ports (1.385.2.196 1999/12/07
> 21:47:57)
>
> By contrast, httpd-2.0.42 has libtool-1.4.2.
> (wget http://www.apache.org/dist/httpd/old/httpd-2.0.42.tar.gz)
> Any the mod_python install goes smoothly.
>
> Anyone know what's going on with this?!?  Did someone at apache just
> screw-up and include the wrong version?

This seems to be the case.

> Is there an easy remedy to patch 2.0.43 to work correctly?

Yes, simply running ./buildconf make apache adopt the version of libtool
on the system.

Grisha


From gnb at itga.com.au  Mon Dec 23 09:15:50 2002
From: gnb at itga.com.au (Gregory Bond)
Date: Fri Jan  9 21:59:49 2004
Subject: [mod_python] mod_python cgihandler bug? 
In-Reply-To: Your message of Sun, 22 Dec 2002 20:21:37 +0100.
Message-ID: <200212222215.JAA00265@lightning.itga.com.au>

In the line:
  File "G:\PYTHON\PYTHON\lib\site-packages\mod_python\apache.py", line 764, in restore_nocgi
    for k in osenv:

Change this to 
	for k in osenv.keys():
and it gets past this problem.  I have still other problems with cgihandler 
tho (see my message from the other day).



From LBerezhny at DevIS.com  Sun Dec 22 18:29:18 2002
From: LBerezhny at DevIS.com (Lex Berezhny)
Date: Fri Jan  9 21:59:49 2004
Subject: [mod_python] ImportError: No module named mod_python.apache
Message-ID: <1040599758.21517.25.camel@buddha>

hello again,

  Thanks for the ./buildconf pointer, it is working great! (i have
attached an updated bash script to get others started, it's only been
tested on RH7, don't forget to su first ;-)

  The next phase of my mod_python escapade involved trying to get the
example working, that's when I hit my next snag.

  The following additions were made to httpd.conf:

    230 LoadModule python_module
/usr/local/apache2/modules/mod_python.so

    361 <Directory "/usr/local/apache2/htdocs/test">
    362     AddHandler python-program .py
    363     PythonHandler mptest
    364     PythonDebug On
    365 </Directory>


  I started apache as follows:

# ./apachectl -k start -DONE_PROCESS


  Going to http://localhost/test/mptest.py produced an Internal Server
Error with the following message in error_log:

[Sun Dec 22 17:57:55 2002] [error] make_obcallback: could not import
mod_python.apache.

ImportError: No module named mod_python.apache

  Is there any simple way to get mod_python to print out its sys.path?
What could cause an incorrect import path? Any suggestions on resolving
this?

thanks a lot,
 - lex
-------------- next part --------------
A non-text attachment was scrubbed...
Name: install.sh
Type: text/x-sh
Size: 563 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20021222/3ba3579e/install-0002.bin
From LBerezhny at DevIS.com  Sun Dec 22 19:04:34 2002
From: LBerezhny at DevIS.com (Lex Berezhny)
Date: Fri Jan  9 21:59:49 2004
Subject: [mod_python] ImportError: No module named mod_python.apache
In-Reply-To: <1040599758.21517.25.camel@buddha>
References: <1040599758.21517.25.camel@buddha>
Message-ID: <1040601873.21517.40.camel@buddha>

heya,

>   Is there any simple way to get mod_python to print out its sys.path?

i found a way to answer my first question (after looking through the
mod_python mailing list archive i found an email by Conrad Steenberg
suggesting strace). I had to adapt his example to work on my machine:

i started apache:
# ./apachectl -k start -DONE_PROCESS

then i got the process id and ran strace like so:
$ strace -p 29405

Every time I went to the URL of my script strace printed out the
following:

......
stat64("/usr/lib/python2.2/mod_python", 0xbfffeb30) = -1 ENOENT (No such
file or directory)
open("/usr/lib/python2.2/mod_python.so", O_RDONLY|O_LARGEFILE) = -1
ENOENT (No such file or directory)
open("/usr/lib/python2.2/mod_pythonmodule.so", O_RDONLY|O_LARGEFILE) =
-1 ENOENT (No such file or directory)
open("/usr/lib/python2.2/mod_python.py", O_RDONLY|O_LARGEFILE) = -1
ENOENT (No such file or directory)
open("/usr/lib/python2.2/mod_python.pyc", O_RDONLY|O_LARGEFILE) = -1
ENOENT (No such file or directory)
....

For some reason mod_python uses the wrong python install directory (i
have two, one that came with my redhat system under /usr/lib/python2.2
and one that i install as part of my script /usr/local/lib/python2.2).

So, where does mod_python make the decision on which python to use?
Again my ./configure for mod_python was this:

./configure --with-apxs=/usr/local/apache2/bin/apxs
--with-python=/usr/local/bin/python2.2

> What could cause an incorrect import path? Any suggestions on resolving
> this?

Thanks again,
 - lex


From gnb at itga.com.au  Mon Dec 23 11:24:46 2002
From: gnb at itga.com.au (Gregory Bond)
Date: Fri Jan  9 21:59:49 2004
Subject: [mod_python] cgi handler bug? 
In-Reply-To: Your message of Fri, 20 Dec 2002 17:33:18 +1100.
Message-ID: <200212230024.LAA08767@lightning.itga.com.au>

I wrote: 

> But the HTML
> generated by the CGI is sent twice, so my page displays double. 

Found it.

In mod_python.apache.py, in the CGIStdout::write() routine, the
self.headers_sent variable is never being set, so the first chunk of stuff from
the CGI program (in my case, all but the last newline) is being handled and
sent twice.

The following patch fixes both CGIhandler problems, and my CGIs now happily 
operate under mod_python:

diff -u ~gnb/mod_python-3.0.1/lib/python/mod_python/apache.py /usr/local/lib/python2.2/site-packages/mod_python/apache.py
--- /home/users/gnb/mod_python-3.0.1/lib/python/mod_python/apache.py    Fri Nov  8 11:15:11 2002
+++ /usr/local/lib/python2.2/site-packages/mod_python/apache.py Mon Dec 23 11:18:56 2002
@@ -723,6 +723,7 @@
                     else:
                         self.req.headers_out.add(h, v)
 
+               self.headers_sent = 1
                 # write the body if any at this point
                 self.req.write(ss[1])
         else:
@@ -761,7 +762,7 @@
     osenv = os.environ
 
     # restore env
-    for k in osenv:
+    for k in osenv.keys():
         del osenv[k]
     for k in sav_env:
         osenv[k] = env[k]




From jim at thario.net  Sun Dec 22 22:17:09 2002
From: jim at thario.net (Jim Thario)
Date: Fri Jan  9 21:59:49 2004
Subject: [mod_python] Problems with PythonAuthenHandler on Red Hat 8.0?
Message-ID: <33470.63.227.22.21.1040620629.squirrel@webmail.thario.com>

Hi. I recently stared working with mod_python. I am using the stock Red
Hat 8.0 installation which includes:

httpd-2.0.40-11
python-2.2.1-17
mod_python-3.0.0-10

I am having trouble with the example from "3.4 Now something More
Complicated - Authentication". My configuration in httpd.conf looks like:

<Directory /var/www/html/python>
        AddHandler python-program .py
        PythonHandler myscript
        PythonAuthenHandler myscript
        PythonDebug On
        AuthType Basic
        AuthName "Restricted Area"
        require valid-user
</Directory>

After getting prompted for the user and password, I get a "Server error!"
page and an entry in the /var/log/httpd/error_log:

"configuration error:  couldn't check user.  No user file?: /python"

Apache seems to want an AuthUserFile in there to read. The best I can
guess is there is a problem with the version of mod_python shipped with
Red Hat 8.0.

Any ideas?

Thanks in advance,
Jim




From tsyang at webtech360.com  Thu Dec 26 13:56:52 2002
From: tsyang at webtech360.com (T.-S. Yang)
Date: Fri Jan  9 21:59:49 2004
Subject: [mod_python] Problems with PythonAuthenHandler on Red Hat 8.0?
In-Reply-To: <33470.63.227.22.21.1040620629.squirrel@webmail.thario.com>
References: <33470.63.227.22.21.1040620629.squirrel@webmail.thario.com>
Message-ID: <3E0B7B24.30505@webtech360.com>

Jim,

I'm able to reproduce the error that you described using RedHat 8.
The problem is fixed under ReHat 8.0.92 (Phoebe).

I don't know the cause of the problem. The related packages in Phoebe
are

httpd-2.0.40-14
python-2.2.2-7
mod_python-3.0.1-1

Happy Holidays,
-tsy


Jim Thario wrote:
> Hi. I recently stared working with mod_python. I am using the stock Red
> Hat 8.0 installation which includes:
> 
> httpd-2.0.40-11
> python-2.2.1-17
> mod_python-3.0.0-10
> 
> I am having trouble with the example from "3.4 Now something More
> Complicated - Authentication". My configuration in httpd.conf looks like:
> 
> <Directory /var/www/html/python>
>         AddHandler python-program .py
>         PythonHandler myscript
>         PythonAuthenHandler myscript
>         PythonDebug On
>         AuthType Basic
>         AuthName "Restricted Area"
>         require valid-user
> </Directory>
> 
> After getting prompted for the user and password, I get a "Server error!"
> page and an entry in the /var/log/httpd/error_log:
> 
> "configuration error:  couldn't check user.  No user file?: /python"
> 
> Apache seems to want an AuthUserFile in there to read. The best I can
> guess is there is a problem with the version of mod_python shipped with
> Red Hat 8.0.
> 
> Any ideas?
> 
> Thanks in advance,
> Jim
> 


From jim at thario.net  Thu Dec 26 16:43:27 2002
From: jim at thario.net (Jim Thario)
Date: Fri Jan  9 21:59:49 2004
Subject: [mod_python] Problems with PythonAuthenHandler on Red Hat 8.0?
In-Reply-To: <3E0B7B24.30505@webtech360.com>
References: <33470.63.227.22.21.1040620629.squirrel@webmail.thario.com>
        <3E0B7B24.30505@webtech360.com>
Message-ID: <32892.63.227.22.21.1040946207.squirrel@webmail.thario.com>

Thanks for taking time to reproduce this. I am going to open a bug against
Red Hat 8.0 and see what they are willing to do.

Thanks,
Jim


T.-S. Yang said:
> Jim,
>
> I'm able to reproduce the error that you described using RedHat 8. The
> problem is fixed under ReHat 8.0.92 (Phoebe).
>
> I don't know the cause of the problem. The related packages in Phoebe
> are
>
> httpd-2.0.40-14
> python-2.2.2-7
> mod_python-3.0.1-1
>
> Happy Holidays,
> -tsy
>
>
> Jim Thario wrote:
>> Hi. I recently stared working with mod_python. I am using the stock
>> Red Hat 8.0 installation which includes:
>>
>> httpd-2.0.40-11
>> python-2.2.1-17
>> mod_python-3.0.0-10
>>
>> I am having trouble with the example from "3.4 Now something More
>> Complicated - Authentication". My configuration in httpd.conf looks
>> like:
>>
>> <Directory /var/www/html/python>
>>         AddHandler python-program .py
>>         PythonHandler myscript
>>         PythonAuthenHandler myscript
>>         PythonDebug On
>>         AuthType Basic
>>         AuthName "Restricted Area"
>>         require valid-user
>> </Directory>
>>
>> After getting prompted for the user and password, I get a "Server
>> error!" page and an entry in the /var/log/httpd/error_log:
>>
>> "configuration error:  couldn't check user.  No user file?: /python"
>>
>> Apache seems to want an AuthUserFile in there to read. The best I can
>> guess is there is a problem with the version of mod_python shipped
>> with Red Hat 8.0.
>>
>> Any ideas?
>>
>> Thanks in advance,
>> Jim
>>




From andy at nervebox.com  Fri Dec 27 00:16:36 2002
From: andy at nervebox.com (andy@nervebox.com)
Date: Fri Jan  9 21:59:49 2004
Subject: [mod_python] http 1.1 persistent connections
Message-ID: <7838526.1040976996296.JavaMail.SYSTEM@Obatala>

Hi all,
I'm new to Python and mod_python - and I'm having trouble finding out if mod_python supports  http1.1's persistent connections.  

I need to be able to have long-running scripts flush a single document - a little at a time, as it's generated - out through Apache to the client.  It might take a minute or an hour.  

Cold Fusion makes this dirt simple.  You can simply insert <cfflush> anywhere in your template and whatever data is generated thus far will be flushed out to Apache - which will hold the HTTP connection open until the template finishes executing.  It can be kept open for hours and makes a good sort of server push.

Can this be done with Python/mod_python?

 - thanks,
 - andy c
      
      
      
    

From stephane.bidoul at softwareag.com  Mon Dec  2 18:15:47 2002
From: stephane.bidoul at softwareag.com (Stéphane Bidoul)
Date: Fri Jan  9 22:03:36 2004
Subject: [mod_python] mp_server.register_cleanup
Message-ID: <000001c29a26$78d78460$56241eac@acsesbi>

Hi Grisha,

I'm back using mod_python, on a real project this time.
We've been using 3.0 beta for a few weeks and it works great!

Now I'm trying to use mp_server.register_cleanup, and that fails
with a "ValueError: first argument must be a Request object".

My first diagnostic (unless I'm doing something silly)
is that it's a remnant of mod_python 2.x,
since the Request class seems to have disappeared
from apache.py.

Is that an easy fix for you? 
Or should I dig it a little bit more?

-sbi




From tigrux at avantel.net  Mon Dec  2 15:01:55 2002
From: tigrux at avantel.net (Sandino Flores Moreno)
Date: Fri Jan  9 22:03:36 2004
Subject: [mod_python] mp_server.register_cleanup
In-Reply-To: <000001c29a26$78d78460$56241eac@acsesbi>
References: <000001c29a26$78d78460$56241eac@acsesbi>
Message-ID: <1038859317.19550.9.camel@TigruXtatioN>

In my code (http://mamba.sf.net)
I'm using it in in this way:

def endRequest(mamba):
        if mamba.processor.globals.has_key('endRequest'):
                endRequest = mamba.processor.globals['endRequest']
                endRequest()
        
def endChild(mamba):
        if mamba.processor.globals.has_key('endChild'):
                endChild = mamba.processor.globals['endChild']
                endChild()


req.register_cleanup(endRequest, (mamba,) )
req.server.register_cleanup(req, endChild, (mamba,) )


From markusjais at yahoo.de  Mon Dec  2 22:31:41 2002
From: markusjais at yahoo.de (Markus Jais)
Date: Fri Jan  9 22:03:37 2004
Subject: [mod_python] beginners question
In-Reply-To: <001f01c29a3b$e92ddc40$6401a8c0@darwin>
References: <1038180652.3173.2.camel@eagle> 
	<001f01c29a3b$e92ddc40$6401a8c0@darwin>
Message-ID: <1038864704.2017.1.camel@eagle>

On Mon, 2002-11-25 at 01:48, Antonio Rodriguez wrote:
> Markus,
> 
> Go into the src directory of the dist and in the OPTIONS= line add -DEAPI.
> apxs will do the right thing and you will stop getting that warning.

thanks, but I found no OPTIONS in all the Make files
I then added 
OPTIONS=-DEAPI
to the Makefile, but this hat not effect.

markus

...

__________________________________________________________________

Gesendet von Yahoo! Mail - http://mail.yahoo.de
Möchten Sie mit einem Gruß antworten? http://grusskarten.yahoo.de

From antonio at memora.com  Mon Dec  2 16:46:54 2002
From: antonio at memora.com (Antonio Rodriguez)
Date: Fri Jan  9 22:03:37 2004
Subject: [mod_python] beginners question -- LIST moderation?
In-Reply-To: <1038864704.2017.1.camel@eagle>
Message-ID: <9297B926-063F-11D7-9E16-00039300D690@memora.com>

in the src directory near the top of the make file there is a line:
OPT=

and you want to make it:
OPT=-DEAPI

Sorry about the confusion.

One other important thing: is this list moderated or something? I 
posted this to you over a week ago and I just received my own post. If 
it is, I kind of wish it wasn't as it impedes the flow of 
communications.

AR


On Monday, December 2, 2002, at 04:31 PM, Markus Jais wrote:

> On Mon, 2002-11-25 at 01:48, Antonio Rodriguez wrote:
>> Markus,
>>
>> Go into the src directory of the dist and in the OPTIONS= line add 
>> -DEAPI.
>> apxs will do the right thing and you will stop getting that warning.
>
> thanks, but I found no OPTIONS in all the Make files
> I then added
> OPTIONS=-DEAPI
> to the Makefile, but this hat not effect.
>
> markus
>
> ...
>
> __________________________________________________________________
>
> Gesendet von Yahoo! Mail - http://mail.yahoo.de
> M?chten Sie mit einem Gru? antworten? http://grusskarten.yahoo.de
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>



From grisha at modpython.org  Mon Dec  2 16:52:26 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:37 2004
Subject: [mod_python] mp_server.register_cleanup
In-Reply-To: <000001c29a26$78d78460$56241eac@acsesbi>
Message-ID: <20021202164818.R5868-100000@eden.ispol.com>

Stephane -

Yes, it looks like server.register_cleanup was left forgotten....

Try applying this set of patches (this includes patches to the test
suite), I'll add this to HEAD.

RCS file: /home/cvs/httpd-python/src/serverobject.c,v
retrieving revision 1.13
diff -u -r1.13 serverobject.c
--- src/serverobject.c  8 Nov 2002 00:15:11 -0000       1.13
+++ src/serverobject.c  2 Dec 2002 21:47:52 -0000
@@ -117,30 +117,20 @@
     cleanup_info *ci;
     PyObject *handler = NULL;
     PyObject *data = NULL;
-    PyObject *Req = NULL;
     requestobject *req = NULL;

-    if (! PyArg_ParseTuple(args, "OO|O", &Req, &handler, &data))
+    if (! PyArg_ParseTuple(args, "OO|O", &req, &handler, &data))
        return NULL;

-    if (! PyObject_HasAttrString(Req, "_req")) {
-       PyErr_SetString(PyExc_ValueError, "first argument must be a Request object");
-       return NULL;
+    if (! MpRequest_Check(req)) {
+        PyErr_SetString(PyExc_ValueError,
+                        "first argument must be a request object");
+        return NULL;
     }
-    else {
-
-       req = (requestobject *) PyObject_GetAttrString(Req, "_req");
-
-       if (! MpRequest_Check(req)) {
-           PyErr_SetString(PyExc_ValueError,
-                           "first argument must be a request object");
-           return NULL;
-       }
-       else if(!PyCallable_Check(handler)) {
-           PyErr_SetString(PyExc_ValueError,
-                           "second argument must be a callable object");
-           return NULL;
-       }
+    else if(!PyCallable_Check(handler)) {
+        PyErr_SetString(PyExc_ValueError,
+                        "second argument must be a callable object");
+        return NULL;
     }

     ci = (cleanup_info *)malloc(sizeof(cleanup_info));
Index: test/test.py
===================================================================
RCS file: /home/cvs/httpd-python/test/test.py,v
retrieving revision 1.20
diff -u -r1.20 test.py
--- test/test.py        29 Oct 2002 21:52:18 -0000      1.20
+++ test/test.py        2 Dec 2002 21:47:52 -0000
@@ -776,12 +776,39 @@

         self.failUnless(result.wasSuccessful())

+    def test_srv_register_cleanup(self):
+
+        print "\n* Testing server.register_cleanup()..."
+
+        c = Directory(DOCUMENT_ROOT,
+                      SetHandler("python-program"),
+                      PythonHandler("tests::srv_register_cleanup"),
+                      PythonDebug("On"))
+
+        self.makeConfig(str(c))
+
+        self.startHttpd()
+
+        f = urllib.urlopen("http://127.0.0.1:%s/tests.py" % PORT)
+        f.read()
+        f.close()
+
+        self.stopHttpd()
+
+        # see what's in the log now
+        time.sleep(1)
+        f = open(os.path.join(SERVER_ROOT, "logs/error_log"))
+        log = f.read()
+        f.close()
+        if log.find("test ok") == -1:
+            self.fail("Could not find test message in error_log")

 def suite():

     mpTestSuite = unittest.TestSuite()
     mpTestSuite.addTest(PerInstanceTestCase("testLoadModule"))
     mpTestSuite.addTest(PerInstanceTestCase("testPerRequestTests"))
+    mpTestSuite.addTest(PerInstanceTestCase("test_srv_register_cleanup"))
     return mpTestSuite

 tr = unittest.TextTestRunner()
Index: test/htdocs/tests.py
===================================================================
RCS file: /home/cvs/httpd-python/test/htdocs/tests.py,v
retrieving revision 1.19
diff -u -r1.19 tests.py
--- test/htdocs/tests.py        29 Oct 2002 21:52:18 -0000      1.19
+++ test/htdocs/tests.py        2 Dec 2002 21:47:52 -0000
@@ -505,6 +505,14 @@

     data.log_error(data.cleanup_data)

+def srv_register_cleanup(req):
+
+    req.cleanup_data = "test ok"
+    req.server.register_cleanup(req, cleanup, req)
+    req.write("registered server cleanup that will write to log")
+
+    return apache.OK
+
 def util_fieldstorage(req):

     from mod_python import util


Grisha

On Mon, 2 Dec 2002, St?phane Bidoul wrote:

> Hi Grisha,
>
> I'm back using mod_python, on a real project this time.
> We've been using 3.0 beta for a few weeks and it works great!
>
> Now I'm trying to use mp_server.register_cleanup, and that fails
> with a "ValueError: first argument must be a Request object".
>
> My first diagnostic (unless I'm doing something silly)
> is that it's a remnant of mod_python 2.x,
> since the Request class seems to have disappeared
> from apache.py.
>
> Is that an easy fix for you?
> Or should I dig it a little bit more?
>
> -sbi
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From harrington_chad at hotmail.com  Mon Dec  2 17:22:23 2002
From: harrington_chad at hotmail.com (Chad Harrington)
Date: Fri Jan  9 22:03:37 2004
Subject: [mod_python] can't find mod_python.so
Message-ID: <F63lff3ECr3ni8hEUJ90001c3fa@hotmail.com>

An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20021202/685bb448/attachment-0003.htm
From mkurjano at tjhsst.edu  Mon Dec  2 22:10:08 2002
From: mkurjano at tjhsst.edu (Matthew Kurjanowicz)
Date: Fri Jan  9 22:03:37 2004
Subject: [mod_python] Problems with mp tutorial
Message-ID: <Pine.LNX.4.44.0212022155500.15170-100000@phosphorus.tjhsst.edu>

Hi there,
First off, I'm new to the list, so if this question has been answered, I
am sorry.  I checked the archives and documentation but could not find
anything helpful in this case.

I am running a new, clean install of RH 8.0, with Apache 2.0.40 (rpm rev
8) and mod_python 3.0.0 (rpm rev 10).  I try the first part of the
tutorial (just hello world) and it works fine.  However, when I try to run
the authentication part of the tutorial, I get these errors (relevent part
of error_log listed below).  Apache is asking for the AuthUserFile of some
sort.  I've used Apache before, and know about basic authentication using
the files, but I'd love to be able to use python.  Any assistance is
appreciated.
Let me know if you need more info or any different files.
Thanks for your time,
Matt Kurjanowicz (mkurjano@tjhsst.edu)

[Sun Dec 01 23:53:28 2002] [notice] Digest: generating secret for digest
authentication ...
[Sun Dec 01 23:53:28 2002] [notice] Digest: done
[Sun Dec 01 23:53:29 2002] [notice] Apache/2.0.40 (Red Hat Linux)
configured -- resuming normal operations
[Sun Dec 01 23:53:40 2002] [crit] [client 127.0.0.1] configuration error:
couldn't check user.  No user file?: /python/authen.py, referer:
http://localhost/python/
[Sun Dec 01 23:53:57 2002] [crit] [client 127.0.0.1] configuration error:
couldn't check user.  No user file?: /python/a.py



From markusjais at yahoo.de  Tue Dec  3 09:29:26 2002
From: markusjais at yahoo.de (=?iso-8859-1?q?Markus=20Jais?=)
Date: Fri Jan  9 22:03:37 2004
Subject: [mod_python] beginners question -- LIST moderation?
In-Reply-To: <9297B926-063F-11D7-9E16-00039300D690@memora.com>
Message-ID: <20021203082926.42999.qmail@web12405.mail.yahoo.com>

 --- Antonio Rodriguez <antonio@memora.com> schrieb: >
in the src directory near the top of the make file
> there is a line:
> OPT=
> 
> and you want to make it:
> OPT=-DEAPI
> 

thank you very much!

> Sorry about the confusion.
> 
> One other important thing: is this list moderated or
> something? I 
> posted this to you over a week ago and I just
> received my own post. If 
> it is, I kind of wish it wasn't as it impedes the
> flow of 
> communications.

I hat the same problems. some postings needed several
days to arrive.

markus





__________________________________________________________________

Gesendet von Yahoo! Mail - http://mail.yahoo.de
Weihnachts-Eink?ufe ohne Stress! http://shopping.yahoo.de

From ray_drew at yahoo.co.uk  Tue Dec  3 11:18:49 2002
From: ray_drew at yahoo.co.uk (Ray Drew)
Date: Fri Jan  9 22:03:37 2004
Subject: [mod_python] 3.0.1 on Apache 2.0.43/Python 2.2.1 on Windows XP Prof.
Message-ID: <002901c29abd$c1ba1750$e4ae5651@RDREWXP>

I seem to have the same problem that others are having - I can't get this to
run.

Apache runs fine until I add...

    LoadModule python_module modules/mod_python.so to the modules section of
httpd.conf

... then Apache fails to start.

I have mod_python.so in the apache modules directory.

Under Apache 1.3x and mod_python 2.76 the apache module was a dll.

Does anyone have this combination working?

Thanks,

Ray





__________________________________________________
Do You Yahoo!?
Sign up for SBC Yahoo! Dial - First Month Free
http://sbc.yahoo.com

From neo at https.ru  Tue Dec  3 15:09:03 2002
From: neo at https.ru (Neo Eureka)
Date: Fri Jan  9 22:03:37 2004
Subject: [mod_python] mod_python on Windows
Message-ID: <1484824066.20021203150903@https.ru>

Hi !

  I have no cygwin installed but I had just the same problem with
mod_python 3 on WinNT. I posted this question a logn-long time ago.
There are about ten people who have reported the same issue since that
time...

>
> 
> Grisha,
> Unfortunately, I think it must be more involved than that...
> I have the identical problem, but I use python 2.2.1
> 
> I am running mod_python 3.0.1, Python 2.2.1, Apache 2.0.43, Windows
> 2000 Professional.  I also have cygwin installed, if that might make
> a difference.  It appears that the Mark (the original poster) also
> has cygwin.  I also played with the permissions and owners to no
> avail.  Are there any other things I should try?    
> Chad Harrington 
> harrington_chad@hotmail.com 

--- 
Neo Eureka / mailto:neo@https.ru


From heha at iki.fi  Tue Dec  3 16:13:00 2002
From: heha at iki.fi (Heikki Halonen)
Date: Fri Jan  9 22:03:37 2004
Subject: [mod_python] mod_python with 4Suite tools
Message-ID: <Pine.LNX.4.44.0212031452160.3043-100000@a204b.ud.ton.tut.fi>

Hi

I'm having hard time trying to make 4Suite tools co-operate with
mod_python (or vice versa). I'm using Python 2.2.2, Apache 2.0.43,
mod_python 3.0.1 and newest 4Suite development version. My system is
Debian unstable. python2.2-xml package is not installed.

The test program is in the end of this mail, the xml files used can be
found at http://www.heha.iki.fi/~heha/poll_dev/quiz2html.xsl and
http://www.heha.iki.fi/~heha/poll_dev/polls/quiz_1.xml. Test program works
perfectly when run from the command line. When requested by mod_python,
however, it 'obfuscates' the XML document. Characters used in marking
print out fine but everything else is some random binary data. I figured
out that it probably has something to do with encoding and added the
following lines to sitecustomize.py, as somebody advised in some distantly
similar problem:

u'hello'.encode( 'UTF-8' )
u'hello'.encode( 'iso8859-1' )

This did not help, whatsoever. I have no clue anymore where the problem
could be or how it could be corrected. Any suggestions? The same kind of
code works fine in mod_python 2.7.8 running in Apache 1.3.26 with Python
2.1 and 4Suite version 0.11.1.




#!/usr/bin/python2.2

import sys, os, string

from Ft.Lib import Uri
from Ft.Xml.Xslt import XmlWriter, Processor, OutputParameters
from Ft.Xml import Domlette, InputSource

def processXML():
    mypath = '/home/heha/public_html/poll_dev/'
    pollfile = mypath+'polls/quiz_1.xml'
    pollxsl = mypath+'quiz2html.xsl'

    debugfile = open( mypath+'poll.log', 'w' )
    processor = Processor.Processor()
    node = Domlette.NonvalidatingReader.parseUri( pollfile )
    Domlette.Print( node, debugfile, encoding='iso8859-1' )
    stylesheet = InputSource.DefaultFactory.fromUri( pollxsl )
    processor.appendStylesheet( stylesheet )

    processed_node = processor.runNode( node, Uri.OsPathToUri(
        pollfile, 1) )

    debugfile.write( processed_node )
    debugfile.close()

    return processed_node

    #print writer.getResult()

if __name__ == "__main__":
    print processXML()
else:
    from mod_python import apache

    def handler( req ):
        req.write( processXML() )
        return apache.OK



     Heikki Halonen # heha@iki.fi # iki.fi/heha # +358 40 828 9972
            "The easy way ain't hard enough and the hard way
                     is such a lonely lonely path"


From gdamjan at mail.net.mk  Tue Dec  3 16:12:44 2002
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 22:03:37 2004
Subject: [mod_python] bug/misfeature in publisher/mod_python
Message-ID: <20021203151244.GB16590@legolas.on.net.mk>

My setup:
 apache 2.0.43, mod_python 3.0.1, python 2.2.1

httpd.conf:
<Directory /home/www/htdocs> # The root of the web server
...
    SetHandler python-program
    PythonHandler mod_python.publisher | .py
    PythonDebug On
</Directory>
...

I expect this setup to handle all files ending in ".py" through
the publisher handler.

I have the script "hello.py" from the mod_python manual in the root of the
web-server. Trying to get "http://127.1/hello.py/say" mod_python
throws an exception (traceback atached).

The exception is: "ImportError: No module named py"

I've foloved the problem to the publisher handler, line 139. 
When publisher tries to strip the suffixes, it gets them by
calling "req.get_addhandler_exts()". Obviosly in my case this
call return None (I dont have the AddHandler directive). So
publsiher doesn't strip anything, thus trying to import the
module "py" (which is the extension of the script).

The solution for this problem would be for get_addhandler_exts()
alsa to return the extensions as specified in the 
"PythonHandler ... | .ext" directive.



-- 
Damjan Georgievski
-------------- next part --------------

Mod_python error: "PythonHandler mod_python.publisher"

Traceback (most recent call last):

  File "/usr/lib/python2.2/site-packages/mod_python/apache.py", line 335, in HandlerDispatch
    result = object(req)

  File "/usr/lib/python2.2/site-packages/mod_python/publisher.py", line 149, in handler
    module = apache.import_module(module_name, req.get_config(), [path])

  File "/usr/lib/python2.2/site-packages/mod_python/apache.py", line 499, in import_module
    f, p, d = imp.find_module(parts[i], path)

ImportError: No module named py
From duncan at rcp.co.uk  Tue Dec  3 15:58:39 2002
From: duncan at rcp.co.uk (Duncan Booth)
Date: Fri Jan  9 22:03:37 2004
Subject: [mod_python] mod_python 3.0.1 on Apache 2.0.43 solution
Message-ID: <3DECD4AF.28805.1664047@localhost>

It appears that the binaries for mod_python 3.0.1 have been built 
using Microsoft Visual Studio version 7. This means that 
mod_python.so has a dependency on the file msvcr70.dll, but the 
distribution doesn't include this file.

If you have the latest Microsoft compiler installed, or any other 
applications that use this DLL, then mod_python.so works fine. If not 
it fails horribly.

The workaround (at least on one machine that had this problem) is to 
copy msvcr70.dll into \winnt\system32. Get the file from anywhere 
that already has a copy (e.g. www.dll-files.com/dllindex/dll-
files.shtml?msvcr70). Fortunately this dll has no further 
dependencies.  

The long term solution would be to distribute mod_python as a .MSI 
file including dependencies, or even to build it with the same version 
of the C runtime library as used for the rest of Apache and Python.



From grisha at modpython.org  Tue Dec  3 11:00:17 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:37 2004
Subject: [mod_python] can't find mod_python.so
In-Reply-To: <F63lff3ECr3ni8hEUJ90001c3fa@hotmail.com>
Message-ID: <20021203105848.L19817-100000@eden.ispol.com>

I've recompiled mod_python.so and placed the new file out there. I tested
it and it works fine for me on Win2K, apache 2.0.43 and Python 2.2.1 (from
www.python.org). I think something went amuck with the original file.

Grisha

On Mon, 2 Dec 2002, Chad Harrington wrote:

>
>
>
> Grisha,
>
> Unfortunately, I think it must be more involved than that...
>
> I have the identical problem, but I use python 2.2.1
>
> I am running mod_python 3.0.1, Python 2.2.1, Apache 2.0.43, Windows 2000 Professional.  I also have cygwin installed, if that might make a difference.  It
> appears that the Mark (the original poster) also has cygwin.  I also played with the permissions and owners to no avail.  Are there any other things I should
> try?
>
> Chad Harrington
> harrington_chad@hotmail.com
> ----Original Message Follows----
> From: "Gregory (Grisha) Trubetskoy"
> To: Mark Messer
> CC: mod_python@modpython.org
> Subject: Re: [mod_python] can't find mod_python.so
> Date: Sat, 30 Nov 2002 23:06:10 -0500 (EST)
> This is possibly because the mod_python.so that is out there is for Python
> 2.2.1. I don't have one for 2.2.2 compiled (yet).
> Grisha
> On Sat, 30 Nov 2002, Mark Messer wrote:
> > I put mod_python.so into the modules directory, but I get an error when
> > starting Apache:
> >
> > C:\tools\Apache2\bin>apache
> > Syntax error on line 173 of C:/tools/Apache2/conf/httpd.conf:
> > Cannot load C:/tools/Apache2/modules/mod_python.so into server: The
> > specified module could not be found.
> >
> > I added this to the LoadModule section of httpd.conf: LoadModule
> > python_module modules/mod_python.so
> >
> > Here's the directory listing:
> > C:\tools\Apache2\modules>ls -al mod_p*
> > -rwxrwx--- 1 Administ SYSTEM 40960 Oct 3 06:58 mod_proxy.so
> > -rwxrwx--- 1 Administ SYSTEM 20480 Oct 3 06:58 mod_proxy_connect.so
> > -rwxrwx--- 1 Administ SYSTEM 28672 Oct 3 06:58 mod_proxy_ftp.so
> > -rwxrwx--- 1 Administ SYSTEM 24576 Oct 3 06:58 mod_proxy_http.so
> > -rwxrwx--- 1 Administ SYSTEM 65536 Nov 26 17:49 mod_python.so
> >
> > I am running mod_python 3.0.1, Python 2.2.2, Apache 2.0.43, Windows XP
> > Professional. Tried changing perms and ownership to match what was there,
> > but that did not work.
> >
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://www.modpython.org/mailman/listinfo/mod_python
> >
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>
> ____________________________________________________________________________________________________________________________________________________________________
> MSN 8 helps ELIMINATE E-MAIL VIRUSES. Get 2 months FREE*.
>


From harrington_chad at hotmail.com  Tue Dec  3 08:48:10 2002
From: harrington_chad at hotmail.com (Chad Harrington)
Date: Fri Jan  9 22:03:37 2004
Subject: [mod_python] can't find mod_python.so
Message-ID: <F153XRyOLjauzQmvaR300012ca1@hotmail.com>

An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20021203/8eb6acf8/attachment-0003.htm
From gstein at lyra.org  Tue Dec  3 10:20:30 2002
From: gstein at lyra.org (Greg Stein)
Date: Fri Jan  9 22:03:37 2004
Subject: [mod_python] 3.0.1 on Apache 2.0.43/Python 2.2.1 on Windows XP Prof.
In-Reply-To: <002901c29abd$c1ba1750$e4ae5651@RDREWXP>; from ray_drew@yahoo.co.uk on Tue, Dec 03, 2002 at 11:18:49AM -0000
References: <002901c29abd$c1ba1750$e4ae5651@RDREWXP>
Message-ID: <20021203102030.D17655@lyra.org>

On Tue, Dec 03, 2002 at 11:18:49AM -0000, Ray Drew wrote:
>...
> I have mod_python.so in the apache modules directory.
> 
> Under Apache 1.3x and mod_python 2.76 the apache module was a dll.

FYI... it is still a DLL, just with a different extension.

Cheers,
-g

-- 
Greg Stein, http://www.lyra.org/

From webmaster at obramaestraonline.com  Tue Dec  3 16:39:22 2002
From: webmaster at obramaestraonline.com (Webmaster)
Date: Fri Jan  9 22:03:37 2004
Subject: [mod_python] mod_python on Win32 Apache 1.3.27
Message-ID: <000101c29b0c$115e9800$22383242@Family>

Is mod python compatible with Apache 1.3.27?

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20021203/a5ee485b/attachment-0003.htm
From ray_drew at yahoo.co.uk  Tue Dec  3 23:44:24 2002
From: ray_drew at yahoo.co.uk (Ray Drew)
Date: Fri Jan  9 22:03:37 2004
Subject: [mod_python] mod_python os.environ bug?
Message-ID: <012e01c29b25$e9d99040$e4ae5651@RDREWXP>

Hi Grisha,

I'm using mod_python in conjunction with quixote
www.mems-exchange.org/software/quixote/

In moving from Apache 1.3.22/mp 2.78 to Apache 2.043/mp 3.01 I get a
TypeError on the quixote function environ.get(key, default). The default in
this function is None and this is what returns the Type Error. If I change
the default argument to an empty string everything works ok. It's been
suggested that there may be a bug in mod_python, see below:

-----------------------------------------------
On Tue, Dec 03, 2002 at 09:55:57PM -0000, Ray Drew wrote:
> Moving from...
>
> Apache 1.3.22 Python 2.2.1 mod_python 2.7.8 Quixote 0.5.1 Windows XP
>
> ...to...
>
> Apache 2.043 mod_python 3.0.1 rest as above.

>     return self.environ.get(key, default)
> TypeError: get() argument 2 must be string, not None

I would guess it is a mod_python bug.  I suppose it replaces os.environ
with an object that does incorrect type checking on the second argument
to get().
-----------------------------------------------

Would that be right?

Thanks,

Ray

__________________________________________________
Do you Yahoo!?
Yahoo! Mail Plus - Powerful. Affordable. Sign up now.
http://mailplus.yahoo.com

From ray_drew at yahoo.co.uk  Wed Dec  4 09:57:08 2002
From: ray_drew at yahoo.co.uk (Ray Drew)
Date: Fri Jan  9 22:03:37 2004
Subject: [mod_python] mod_python 3.0.1 on Apache 2.0.43 solution
References: <3DECD4AF.28805.1664047@localhost>
Message-ID: <002f01c29b7b$838d1860$e4ae5651@RDREWXP>

Duncan wrote:

#
The workaround (at least on one machine that had this problem) is to 
copy msvcr70.dll into \winnt\system32. Get the file from anywhere 
that already has a copy (e.g. www.dll-files.com/dllindex/dll-
files.shtml?msvcr70). 
#

Duncan,

THANKYOU THANKYOU THANKYOU

That worked for me on Windows XP professional.

Ray





__________________________________________________
Do you Yahoo!?
Yahoo! Mail Plus - Powerful. Affordable. Sign up now.
http://mailplus.yahoo.com

From scott at activestudios.com  Wed Dec  4 08:20:12 2002
From: scott at activestudios.com (Scott Russell)
Date: Fri Jan  9 22:03:37 2004
Subject: [mod_python] mod_xslt filtering of mod_python output
Message-ID: <1039008012.13748.35.camel@heckle.activestudios.com>

Hi. I'm a a beginner with mod_python, and I'm trying to use mod_python
and mod_xslt together.

mod_python gets called via a "SetHandler python-program", and inside
python I set the content-type to text/xml.

mod_xslt is called via "AddOutputFilterByType mod-xslt "text/xml")  

--- httpd.conf stanza: ---

<Location /the_dir>
    SetHandler python-program
    PythonPath "sys.path + ['/path/']"
    PythonHandler mymodule
    AddOutputFilterByType mod-xslt text/xml
</Location>
--- end ---

--- /path/mymodule.py excerpt ---

def handler(req):
        
  ... generate xml, place in out ...

  req.content_type = "text/xml"
  req.write(out)
  return apache.OK
--- end ---

Both work fine standalone - mod_xslt filters xml files, and mod_python
is generating dynamic content, but I don't know how to get mod_xslt to
filter dynamic content from mod_python...

What am I missing?  

Apache 2.0.40, mod_python 3.0.0, python 2.2.1 (all stock installs on on
RH 8) mod_xslt 1.0.5 (built locally)


From cameron at toolhouse.com  Wed Dec  4 13:46:48 2002
From: cameron at toolhouse.com (Cameron S. Watters)
Date: Fri Jan  9 22:03:37 2004
Subject: [mod_python] make problems
Message-ID: <E43EADFC-07D1-11D7-83C3-00306599D91A@toolhouse.com>

Hello all,

figured you could help.

I keep getting this message when I try to make mod_python 3.0.1

*** Warning: This library needs some functionality provided by 
-lpython2.2.
*** I have the capability to make that library automatically link in 
when
*** you link to this library.  But I can only do this if you have a
*** shared version of the library, which you do not appear to have.

*** Warning: libtool could not satisfy all declared inter-library
*** dependencies of module mod_python.  Therefore, libtool will create
*** a static module, that should work as long as the dlopening
*** application is linked with the -dlopen flag.

I installed apache 2.0.43 and python 2.2.2 from source on FreeBSD. I'm 
explicitly passing --with-python and --with-apxs to the configure 
script.

Any help would be appreciated.

--cameron


From grisha at modpython.org  Wed Dec  4 17:37:20 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:37 2004
Subject: [mod_python] make problems
In-Reply-To: <E43EADFC-07D1-11D7-83C3-00306599D91A@toolhouse.com>
Message-ID: <20021204172744.D39475-100000@eden.ispol.com>

You don't mention your FreeBSD version, it's possible that you have a
really old libtool. Also make sure that Apache is compiled with
--enable-threads. See the FreeBSD section in mod_python README.

Grisha

On Wed, 4 Dec 2002, Cameron S. Watters wrote:

> Hello all,
>
> figured you could help.
>
> I keep getting this message when I try to make mod_python 3.0.1
>
> *** Warning: This library needs some functionality provided by
> -lpython2.2.
> *** I have the capability to make that library automatically link in
> when
> *** you link to this library.  But I can only do this if you have a
> *** shared version of the library, which you do not appear to have.
>
> *** Warning: libtool could not satisfy all declared inter-library
> *** dependencies of module mod_python.  Therefore, libtool will create
> *** a static module, that should work as long as the dlopening
> *** application is linked with the -dlopen flag.
>
> I installed apache 2.0.43 and python 2.2.2 from source on FreeBSD. I'm
> explicitly passing --with-python and --with-apxs to the configure
> script.
>
> Any help would be appreciated.
>
> --cameron
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From webmaster at obramaestraonline.com  Wed Dec  4 19:09:11 2002
From: webmaster at obramaestraonline.com (Rafael Fernandez)
Date: Fri Jan  9 22:03:37 2004
Subject: [mod_python] Mod_python on Win32; Apache 1.3.27
Message-ID: <000001c29bea$2b711900$b0383242@Family>

Is mod_python compatible with Apache 1.3.27 on Win32?

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20021204/b891a606/attachment-0003.htm
From gdamjan at mail.net.mk  Thu Dec  5 00:18:15 2002
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 22:03:37 2004
Subject: [mod_python] make problems
In-Reply-To: <20021204172744.D39475-100000@eden.ispol.com>
References: <E43EADFC-07D1-11D7-83C3-00306599D91A@toolhouse.com> <20021204172744.D39475-100000@eden.ispol.com>
Message-ID: <20021204231815.GA15577@legolas.on.net.mk>

> 
> You don't mention your FreeBSD version, it's possible that you have a
> really old libtool. Also make sure that Apache is compiled with
> --enable-threads. See the FreeBSD section in mod_python README.
> 
> > *** Warning: This library needs some functionality provided by
> > -lpython2.2.
> > *** I have the capability to make that library automatically link in
> > when


This same thing happend on my slackware 8.1 box,
libtool = ltmain.sh (GNU libtool) 1.4.2 (1.922.2.53 2001/09/11 03:18:52)

I solved it by making a /usr/lib/libpython.2.2.so shared library.
The procedure is (if I remember good): 
  mkdir /tmp/libpython;  cd /tmp/libpython
  ar x /usr/lib/python2.2/config/libpython2.2.a
  ld -shared -export-dynamic *.o -ldl -lpthread -lutil -lm -lc\
	-o /usr/lib/libpython2.2.so
  



-- 
Damjan Georgievski

From cameron at toolhouse.com  Wed Dec  4 16:16:46 2002
From: cameron at toolhouse.com (Cameron S. Watters)
Date: Fri Jan  9 22:03:37 2004
Subject: [mod_python] make problems
In-Reply-To: <20021204172744.D39475-100000@eden.ispol.com>
Message-ID: <D748DF36-07E6-11D7-83C3-00306599D91A@toolhouse.com>

> You don't mention your FreeBSD version, it's possible that you have a
> really old libtool. Also make sure that Apache is compiled with
> --enable-threads. See the FreeBSD section in mod_python README.

FreeBSD 4.7-RELEASE
libtool 1.3.4 (installed from ports)

Thanks for the pointer to the FreeBSD note in the readme, I had missed 
it, BUT....

I still get the same message after recompiling apache with the 
--enable-threads flag set. I think it has more to do with the fact that 
there isn't a libpython2.2.so built (as mentioned by 
gdamjan@mail.net.mk).

I would suggest adding that either to the docs on the website (and to 
the README of future releases). The standard python built from source 
doesn't appear to do it for you and according to the python FAQ, item 
3.30, Why is the Python interpreter not built as a shared library?, it 
won't until v2.3. If this IS required by mod_python, it should be at 
least given a mention, and optimally, there would be instructions about 
how to create it.

> Grisha
>
> On Wed, 4 Dec 2002, Cameron S. Watters wrote:
>
>> Hello all,
>>
>> figured you could help.
>>
>> I keep getting this message when I try to make mod_python 3.0.1
>>
>> *** Warning: This library needs some functionality provided by
>> -lpython2.2.
>> *** I have the capability to make that library automatically link in
>> when
>> *** you link to this library.  But I can only do this if you have a
>> *** shared version of the library, which you do not appear to have.
>>
>> *** Warning: libtool could not satisfy all declared inter-library
>> *** dependencies of module mod_python.  Therefore, libtool will create
>> *** a static module, that should work as long as the dlopening
>> *** application is linked with the -dlopen flag.
>>
>> I installed apache 2.0.43 and python 2.2.2 from source on FreeBSD. I'm
>> explicitly passing --with-python and --with-apxs to the configure
>> script.
>>
>> Any help would be appreciated.
>>
>> --cameron
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://www.modpython.org/mailman/listinfo/mod_python
>>
>
>


From grisha at modpython.org  Wed Dec  4 19:34:39 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:37 2004
Subject: [mod_python] make problems
In-Reply-To: <D748DF36-07E6-11D7-83C3-00306599D91A@toolhouse.com>
Message-ID: <20021204192952.W41195-100000@eden.ispol.com>

No, shared lib is not required. I have Python 2.2.1 and apache 2.0.43
installed from ports on a FreeBSD 4.7-RELEASE-p1 box and mod_python
compiles just fine. There is no libpython2.2.so.

If your apache installation is not from ports, then another thing you
might try is to rebuild apache after running ./buildconf (then
./configure), then make. Apxs uses the libtool script that is packaged
with apache, and it in turn is created by ./buildconf, so it may have
something to do with that.

Grisha

On Wed, 4 Dec 2002, Cameron S. Watters wrote:

> > You don't mention your FreeBSD version, it's possible that you have a
> > really old libtool. Also make sure that Apache is compiled with
> > --enable-threads. See the FreeBSD section in mod_python README.
>
> FreeBSD 4.7-RELEASE
> libtool 1.3.4 (installed from ports)
>
> Thanks for the pointer to the FreeBSD note in the readme, I had missed
> it, BUT....
>
> I still get the same message after recompiling apache with the
> --enable-threads flag set. I think it has more to do with the fact that
> there isn't a libpython2.2.so built (as mentioned by
> gdamjan@mail.net.mk).
>
> I would suggest adding that either to the docs on the website (and to
> the README of future releases). The standard python built from source
> doesn't appear to do it for you and according to the python FAQ, item
> 3.30, Why is the Python interpreter not built as a shared library?, it
> won't until v2.3. If this IS required by mod_python, it should be at
> least given a mention, and optimally, there would be instructions about
> how to create it.
>
> > Grisha
> >
> > On Wed, 4 Dec 2002, Cameron S. Watters wrote:
> >
> >> Hello all,
> >>
> >> figured you could help.
> >>
> >> I keep getting this message when I try to make mod_python 3.0.1
> >>
> >> *** Warning: This library needs some functionality provided by
> >> -lpython2.2.
> >> *** I have the capability to make that library automatically link in
> >> when
> >> *** you link to this library.  But I can only do this if you have a
> >> *** shared version of the library, which you do not appear to have.
> >>
> >> *** Warning: libtool could not satisfy all declared inter-library
> >> *** dependencies of module mod_python.  Therefore, libtool will create
> >> *** a static module, that should work as long as the dlopening
> >> *** application is linked with the -dlopen flag.
> >>
> >> I installed apache 2.0.43 and python 2.2.2 from source on FreeBSD. I'm
> >> explicitly passing --with-python and --with-apxs to the configure
> >> script.
> >>
> >> Any help would be appreciated.
> >>
> >> --cameron
> >>
> >> _______________________________________________
> >> Mod_python mailing list
> >> Mod_python@modpython.org
> >> http://www.modpython.org/mailman/listinfo/mod_python
> >>
> >
> >
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From cameron at toolhouse.com  Wed Dec  4 17:43:16 2002
From: cameron at toolhouse.com (Cameron S. Watters)
Date: Fri Jan  9 22:03:37 2004
Subject: [mod_python] make problems
In-Reply-To: <20021204192952.W41195-100000@eden.ispol.com>
Message-ID: <EC6ED012-07F2-11D7-83C3-00306599D91A@toolhouse.com>

> No, shared lib is not required. I have Python 2.2.1 and apache 2.0.43
> installed from ports on a FreeBSD 4.7-RELEASE-p1 box and mod_python
> compiles just fine. There is no libpython2.2.so.
>
> If your apache installation is not from ports, then another thing you
> might try is to rebuild apache after running ./buildconf (then
> ./configure), then make. Apxs uses the libtool script that is packaged
> with apache, and it in turn is created by ./buildconf, so it may have
> something to do with that.

That worked.

./buildconf
./configure --a mass of configure options
make
make install

I will say that building libpython2.2.so also makes the error messages 
go away (not that that makes it the correct solution). Anybody want to 
comment on what difference it actually makes?

Thanks for your help.

--cameron


From nathanr at nathanr.net  Thu Dec  5 14:54:29 2002
From: nathanr at nathanr.net (Nathan Robertson)
Date: Fri Jan  9 22:03:37 2004
Subject: [mod_python] Embedded python support
Message-ID: <1039060470.334.8.camel@moosehead>

Hi,

Before mod_snake was killed, I quite liked its embedded python support.
As mod_snake is now dead, I've ported their epy modules to mod_python
and made them available. For those of you who aren't familiar with the
epy feature, it allows you to embed fragments of python into html code,
in the same way VBScript and JScript can be done in ASP, Java in JSP,
PHP in PHP (??), etc.

From jirka.machotka at seznam.cz  Thu Dec  5 12:18:05 2002
From: jirka.machotka at seznam.cz (=?iso-8859-2?Q?Jirka=20Machotka?=)
Date: Fri Jan  9 22:03:37 2004
Subject: [mod_python] =?iso-8859-2?Q?Problems=20with=20mptest=2Epy=20=28Windows=29?=
Message-ID: <3939.5433-10072-616945501-1039087085@seznam.cz>

Hello there,

I have probably a very basic question. However, I could not find
anything relevant (a searching machine would be fine)

I had had problems with running the mod_python for Apache 2.0.43.
Following the advice I had gotten the msvcr70.dll, put it to the
required directory and restarted the Apache. The Apache starts,
however, when I try to fetch mptest.py (it looks exactly as described
in the manual, the configuration file httpd has been modified
accordingly) I receive an error:

make_obcallback: could not import mod_python.apache

To my understanding the problem relates rather to Python (my version
is 2.2.1). The manual mentions that Python environment must be
recompiled, or what. I'm afraid that's not possible for me
(recompiled in what?) Or am I missing something inportant?


Please help. Thanks in advance.

Jiri

______________________________________________________________________
Reklama:
Sout?? o auto na v?kend, autor?dio Clarion a dal?? ceny: http://ad2.seznam.cz/redir.cgi?instance=12345%26url=http://www.auto-plus.cz
 - nejlep?? syst?m prodeje ojet?ch voz? na internetu


From gdamjan at mail.net.mk  Thu Dec  5 19:40:15 2002
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 22:03:37 2004
Subject: [mod_python] make problems
In-Reply-To: <EC6ED012-07F2-11D7-83C3-00306599D91A@toolhouse.com>
References: <20021204192952.W41195-100000@eden.ispol.com> <EC6ED012-07F2-11D7-83C3-00306599D91A@toolhouse.com>
Message-ID: <20021205184015.GA676@legolas.on.net.mk>

> 
> I will say that building libpython2.2.so also makes the error messages 
> go away (not that that makes it the correct solution). Anybody want to 
> comment on what difference it actually makes?

the presence of libpython2.2.so only allows the build proces to
continue, I can confirm that mod_python is STATICALLY linked with
libpython anyway. This seems like a problem with the build
enviroment, but I don't have enough knowledge to investigate it
any further.







-- 
Damjan Georgievski

From webmaster at obramaestraonline.com  Thu Dec  5 15:37:44 2002
From: webmaster at obramaestraonline.com (Rafael Fernandez)
Date: Fri Jan  9 22:03:37 2004
Subject: [mod_python] Apache1.3.27 with mod_python on Win 32?
Message-ID: <002001c29c95$d1db8540$f7383242@Family>

Is Apache 1.3.27 compatible with mod_python?

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20021205/982faa8f/attachment-0003.htm
From jirka.machotka at seznam.cz  Fri Dec  6 15:55:45 2002
From: jirka.machotka at seznam.cz (=?iso-8859-2?Q?Jirka=20Machotka?=)
Date: Fri Jan  9 22:03:37 2004
Subject: [mod_python] =?iso-8859-2?Q?Re=3A=20R=3A=20=5Bmod=5Fpython=5D=20Problems=20with=20mptest=2Epy=20=28Windows=29?=
In-Reply-To: <52DC70C1C1575C418CB033523A29CF140E0570@exchange2000.manord.com>
Message-ID: <2088.9028-27840-818706865-1039186545@seznam.cz>

Signore,

no comprendo italiano. 

The transaltion I got by AltaVista Babelfish:
and approximately the problem that it gave you? 

The problem is that I don't know what to do. It is obvious that there
is a problem to connect Apache with Python interpret or vice versa.
The question is whether the interpret is called at all (I guess it
is). If so, it seems it is not able to see imported objects enabling
passing the data from/to the Apache. In the manual there is no hint
how to proceed in this case even though I'm sure that everyone has to
go through this problem anyhow.


Dne 5.?prosinec?2002, Manera, Villiam, <vmanera@manord.com> napsal:

> e circa il problema che dava a te?
> 
> -----Messaggio originale-----
> Da: Jirka Machotka [mailto:jirka.machotka@seznam.cz]
> Inviato: giovedi 5 dicembre 2002 12.18
> A: mod_python@modpython.org
> Oggetto: [mod_python] Problems with mptest.py (Windows)
> 

______________________________________________________________________
Reklama:
Nokia 3410 za 4.577 Kc. Nejvyhodnejsi nabidka telefonu na trhu!
http://ad2.seznam.cz/redir.cgi?instance=38871%26url=http://www.oskarmobil.cz/handsets/handset.php


From mcassiano at manord.com  Fri Dec  6 18:19:09 2002
From: mcassiano at manord.com (Cassiano, Marco)
Date: Fri Jan  9 22:03:38 2004
Subject: [mod_python] Win32 : Can't locate API module structure `mod_python'
Message-ID: <52DC70C1C1575C418CB033523A29CF140B8D9B@exchange2000.manord.com>

Hello,

I'm using 
- Windows 2000 Server,
- Apache 2.0.43
- Active State active python 2.2.2
- mod_python 3.0.1 (I should put the mod_python-3.0.1\lib\python\mod_python
folder from the distribution into the c:\Python22\lib folder, right?)
- mod_python.so for activestate into the Apache modules folder. 
- I have also the msvcr70.dll into \winnt\system32.

When I try to start Apache it fails and I get the following error in the
registry : 

"Can't locate API module structure `mod_python' in file C:/Program
Files/Apache Group/Apache2/modules/mod_python.so: No error "

I read on the list that many of you, after the "msvcr70.dll" hint, succeeded
in making mod_python work.
What am I missing ?
Thank you!

> Marco Cassiano
> Resp. Reti e Sistemi
> 
> Manifatture del Nord srl
> viale Regina Elena 13-15
> 42100 Reggio Emilia RE
> ITALY
> 
> Tel. +39 0522 508206
> Fax +39 0522 514001
> email : mcassiano@manord.com
> www.pennyblack.com
> 
> 

From marius at netroedge.com  Fri Dec  6 11:21:22 2002
From: marius at netroedge.com (Marius Nita)
Date: Fri Jan  9 22:03:38 2004
Subject: [mod_python] dev list
Message-ID: <20021206192122.GC8713@netroedge.com>

hello,

i'm having trouble subscribing to the dev list, it seems. i never got
a confirmation message, nor any messages...

just wondering if anyone else has had problems with it.

marius

From jgarzon at indra.es  Mon Dec  9 10:46:42 2002
From: jgarzon at indra.es (Garzon Maldonado, Jesus Javier)
Date: Fri Jan  9 22:03:38 2004
Subject: [mod_python] Problem with --enable-threads
Message-ID: <C6A2439F4F6BE04CAF457A5E24A376FA3634D2@madtormail2.indra.es>

Hello all:

I'm trying to configure Apache 2.0.43+mod_ssl+mod_rewrite+php4.2.3+mod_python-3.0 beta4 on a FreeBSD 4.7 machine.
According to what is said in the documentation, mod_python needs apache configured with --enable-threads, so this is what I typed to configure the source code.
./configure --prefix=/usr/local/apache2 --enable-so --enable-ssl --enable-rewrite --enable-threads

This works and I can compile and install apache, but I cannot start it. When I type ./apachectl startssl (or just start) only one process is launched:
root   23785  0.0  0.9  7064 4836  ??  Is    3:19PM   0:00.01 /usr/local/apache2/bin/httpd -k start -DSSL

But this process doesn't work, (doesn't serve html pages), and cannot be killed with ./apachectl stop

However if I do:
./configure --prefix=/usr/local/apache2 --enable-so --enable-ssl --enable-rewrite

all works fine (though I cannot use mod_python).

What am I doing wrong?

Thanks.

Javi Garzon


From zoper at libero.it  Tue Dec 10 08:54:42 2002
From: zoper at libero.it (Zoper)
Date: Fri Jan  9 22:03:38 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
Message-ID: <002001c2a021$66b50720$1c291a97@sorpippo>

Hi All!

After making my mod_python I try to make install but...

...............CUT....................
Performing DSO installation.

/usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
/usr/bin/install: src/mod_python.so: No such file or directory
make[1]: *** [install_dso] Error 1
make[1]: Leaving directory `/usr/src/mod_python-3.0.1'
make: *** [install] Error 2
..........................................

What does it mean?

Regards.

Gius.


From nathanr at nathanr.net  Tue Dec 10 19:03:09 2002
From: nathanr at nathanr.net (Nathan Robertson)
Date: Fri Jan  9 22:03:38 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
In-Reply-To: <002001c2a021$66b50720$1c291a97@sorpippo>
References: <002001c2a021$66b50720$1c291a97@sorpippo>
Message-ID: <1039507390.8428.0.camel@moosehead>

On Tue, 2002-12-10 at 18:54, Zoper wrote:
> Hi All!
> 
> After making my mod_python I try to make install but...
> 
> ...............CUT....................
> Performing DSO installation.
> 
> /usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
> /usr/bin/install: src/mod_python.so: No such file or directory
> make[1]: *** [install_dso] Error 1
> make[1]: Leaving directory `/usr/src/mod_python-3.0.1'
> make: *** [install] Error 2
> ..........................................

I saw this today. Are you running RedHat 8.0?

Nathan.



From zoper at libero.it  Tue Dec 10 12:54:31 2002
From: zoper at libero.it (Zoper)
Date: Fri Jan  9 22:03:38 2004
Subject: [mod_python] mod_python 3.0.1: error after make install ---> Debian
References: <002001c2a021$66b50720$1c291a97@sorpippo> <1039507390.8428.0.camel@moosehead>
Message-ID: <001501c2a042$e99c1040$2c281a97@sorpippo>

----- Original Message -----
From: "Nathan Robertson" <nathanr@nathanr.net>
To: "Zoper" <zoper@libero.it>
Cc: "modpython" <mod_python@modpython.org>
Sent: Tuesday, December 10, 2002 9:03 AM
Subject: Re: [mod_python] mod_python 3.0.1: error after make install



> I saw this today. Are you running RedHat 8.0?

I'm running Debian 2.2 r5.
Have you any idea about this ugly message?
                /usr/bin/install: src/mod_python.so: No such file or
directory

Thanks a lot.

Giuseppe.


From i at mindlace.net  Tue Dec 10 08:59:06 2002
From: i at mindlace.net (emf)
Date: Fri Jan  9 22:03:38 2004
Subject: [mod_python] mod_python 3.0.1: error after make install --->
 Debian
In-Reply-To: <001501c2a042$e99c1040$2c281a97@sorpippo>
References: <002001c2a021$66b50720$1c291a97@sorpippo> <1039507390.8428.0.camel@moosehead> <001501c2a042$e99c1040$2c281a97@sorpippo>
Message-ID: <3DF5F32A.60005@mindlace.net>

Zoper wrote:

> I'm running Debian 2.2 r5.

You know, if you upgrade to a mixed testing/unstable distribution you 
can just

apt-get -t unstable install mod_python

(assuming you've already

apt-get -t unstable install apache2

)

See section 3.8 for more info:

http://www.debian.org/doc/manuals/apt-howto/ch-apt-get.en.html

~mindlace


From jayaare at earthlink.net  Tue Dec 10 10:56:03 2002
From: jayaare at earthlink.net (john riehl aka j.r.)
Date: Fri Jan  9 22:03:38 2004
Subject: [mod_python] [Fwd: suse 8.0 obcallback problem.]
Message-ID: <3DF638C3.6090508@earthlink.net>


-------- Original Message --------
Subject: suse 8.0 obcallback problem.
Date: Sun, 08 Dec 2002 21:45:51 -0800
From: john riehl aka j.r. <jayaare@earthlink.net>
To: mod_python@modpython.org

This is an informational item.  I want others to avoid the pain I had.
I was about to ask the list for help, when I solved the problem.

The system:  suse 8.0, patched, on intel xeon 2.0 ghz system
(hyperthreading).  apache 1.3.23-142, python-2.2-105,
mod_python-2.7.8-6, mod_ssl-2.8.7-110

The problem:
calling the hello world test script mptest returns an internal error 500
code, with the following messages:
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
[Sun Dec  8 20:57:06 2002] [error] [client 66.215.65.63] python_handler:
make_obcallback returned no obCallBack!

I tried all sorts of stuff, based on complaints/suggestions in web logs,
which made no effect (checking permissions, links from apache to
mod_python, setting PythonPath, PythonInterpreter, setting .htaccess).

The problem was a missing link, from the python libraries to the
mod_python libraries.  with the suse configuration, that means that
/usr/lib/python2.2/site-packages/mod_python should be a symbolic link
pointing to /usr/lib/apache/lib/python2.2/site-packages/mod_python.
To correct, go to /usr/lib/python2.2/site-packages/, and link it thusly:
ln -s /usr/lib/apache/lib/python2.2/site-packages/mod_python/ mod_python

none of the problems/solutions that I reviewed addressed this facet.

Hope it helps,

jr







From conrad at hep.caltech.edu  Tue Dec 10 11:19:16 2002
From: conrad at hep.caltech.edu (Conrad Steenberg)
Date: Fri Jan  9 22:03:38 2004
Subject: [mod_python] [Fwd: suse 8.0 obcallback problem.]
In-Reply-To: <3DF638C3.6090508@earthlink.net>
References: <3DF638C3.6090508@earthlink.net>
Message-ID: <1039547956.312.42.camel@heppc22.hep.caltech.edu>

Hi

Just to add to this: one way to diagnose module/library load problems
with mod_python in general is to strace a single-process apache server
e.g.:

strace /usr/sbin/httpd -X 2> error_log

You will see all the paths that apache/python tries to look for modules.

Cheers

COnrad

On Tue, 2002-12-10 at 10:56, john riehl aka j.r. wrote:
> -------- Original Message --------
> Subject: suse 8.0 obcallback problem.
> Date: Sun, 08 Dec 2002 21:45:51 -0800
> From: john riehl aka j.r. <jayaare@earthlink.net>
> To: mod_python@modpython.org
> 
> This is an informational item.  I want others to avoid the pain I had.
> I was about to ask the list for help, when I solved the problem.
> 
> The system:  suse 8.0, patched, on intel xeon 2.0 ghz system
> (hyperthreading).  apache 1.3.23-142, python-2.2-105,
> mod_python-2.7.8-6, mod_ssl-2.8.7-110
> 
> The problem:
> calling the hello world test script mptest returns an internal error 500
> code, with the following messages:
> make_obcallback(): could not import mod_python.apache.
> make_obcallback(): could not call init.
> [Sun Dec  8 20:57:06 2002] [error] [client 66.215.65.63] python_handler:
> make_obcallback returned no obCallBack!
> 
> I tried all sorts of stuff, based on complaints/suggestions in web logs,
> which made no effect (checking permissions, links from apache to
> mod_python, setting PythonPath, PythonInterpreter, setting .htaccess).
> 
> The problem was a missing link, from the python libraries to the
> mod_python libraries.  with the suse configuration, that means that
> /usr/lib/python2.2/site-packages/mod_python should be a symbolic link
> pointing to /usr/lib/apache/lib/python2.2/site-packages/mod_python.
> To correct, go to /usr/lib/python2.2/site-packages/, and link it thusly:
> ln -s /usr/lib/apache/lib/python2.2/site-packages/mod_python/ mod_python
> 
> none of the problems/solutions that I reviewed addressed this facet.
> 
> Hope it helps,
> 
> jr
> 
> 
> 
> 
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
-- 
Conrad Steenberg <conrad@hep.caltech.edu>


From vmanera at manord.com  Thu Dec 12 17:47:45 2002
From: vmanera at manord.com (Manera, Villiam)
Date: Fri Jan  9 22:03:38 2004
Subject: [mod_python] problem with file download in mod-python 3.0.1
Message-ID: <52DC70C1C1575C418CB033523A29CF14104883@exchange2000.manord.com>

I'm testing mod-python 3.0.1 with apache 2.0.43 and python 2.2.2

I've founded a older problem in file download (from python 2.1 to 2.2)

the workaround is still the same:

in publisher.py:

 class File:
     """ Like a file, but also has headers and filename
     """
     def __init__(self, field):
         # steal all the file-like methods
         for m in dir(field.file):            
		 self.__dict__[m] = getattr(field.file, m)
 
         self.headers = field.headers
         self.filename = field.filename
======================workaround
==============================================
 class File:
     """ Like a file, but also has headers and filename
     """
     def __init__(self, field):
         # steal all the file-like methods
         #for m in dir(field.file):    #dont' work
         for m in self.sim_methods(field.file):
             self.__dict__[m] = getattr(field.file, m)
 
         self.headers = field.headers
         self.filename = field.filename
    
	#new--------	
     def sim_methods(self,obj):
         from types import BuiltinMethodType   
         return filter(lambda s, t=obj:
            type(getattr(t, s)) == BuiltinMethodType, dir(obj))
 
 
I hope it will be put in place

regards

Villiam Manera

From brianh at exelixis.com  Thu Dec 12 11:26:42 2002
From: brianh at exelixis.com (Brian Hawthorne)
Date: Fri Jan  9 22:03:38 2004
Subject: [mod_python] problem with file download in mod-python 3.0.1
In-Reply-To: <52DC70C1C1575C418CB033523A29CF14104883@exchange2000.manord.com>
Message-ID: <Pine.GSO.4.05.10212121123570.4656-100000@timeless.exelixis.com>

i'm not sure what the point is of wrapping the field object like this.
why not just use the field object itself as the value for the file upload
arg?  i cut this part out of my publisher because it seemed unnecessary.

brian hawthorne


On Thu, 12 Dec 2002, Manera, Villiam wrote:

> I'm testing mod-python 3.0.1 with apache 2.0.43 and python 2.2.2
> 
> I've founded a older problem in file download (from python 2.1 to 2.2)
> 
> the workaround is still the same:
> 
> in publisher.py:
> 
>  class File:
>      """ Like a file, but also has headers and filename
>      """
>      def __init__(self, field):
>          # steal all the file-like methods
>          for m in dir(field.file):            
> 		 self.__dict__[m] = getattr(field.file, m)
>  
>          self.headers = field.headers
>          self.filename = field.filename
> ======================workaround
> ==============================================
>  class File:
>      """ Like a file, but also has headers and filename
>      """
>      def __init__(self, field):
>          # steal all the file-like methods
>          #for m in dir(field.file):    #dont' work
>          for m in self.sim_methods(field.file):
>              self.__dict__[m] = getattr(field.file, m)
>  
>          self.headers = field.headers
>          self.filename = field.filename
>     
> 	#new--------	
>      def sim_methods(self,obj):
>          from types import BuiltinMethodType   
>          return filter(lambda s, t=obj:
>             type(getattr(t, s)) == BuiltinMethodType, dir(obj))
>  
>  
> I hope it will be put in place
> 
> regards
> 
> Villiam Manera
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From listmail at xs4all.nl  Thu Dec 12 22:30:15 2002
From: listmail at xs4all.nl (bvr)
Date: Fri Jan  9 22:03:38 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
In-Reply-To: <002001c2a021$66b50720$1c291a97@sorpippo>
References: <002001c2a021$66b50720$1c291a97@sorpippo>
Message-ID: <3DF8FFE7.7070100@xs4all.nl>

Hi,

Same problem here, tried several installations with RH 7.3.

tried installing these:
python2-2.2-16.i386.rpm
python2-devel-2.2-16.i386.rpm
python2-docs-2.2-16.i386.rpm

and:
untar Python-2.2.2.tgz
configure --without-threads
make && make install

both with no errors, cli interpreter works fine

compiled mod python 3.0.1 like this:

configure --with-apxs=/usr/local/apache2/bin/apxs 
--with-python=/usr/local/bin/python2
make

everything looks fine untill I get these warnings at the end:

/usr/local/apache/build/libtool --silent --mode=link gcc -o 
mod_python.la -I/store/install/mod_python-3.0.1/src/include 
-I/usr/local/apache/include -I/usr/local/include/python2.2  -rpath 
/usr/local/apache/modules -module -avoid-version  hlistobject.lo 
hlist.lo filterobject.lo connobject.lo serverobject.lo util.lo 
tableobject.lo requestobject.lo _apachemodule.lo mod_python.lo 
-L/usr/local/lib/python2.2/config -Xlinker -export-dynamic -lm 
-lpython2.2 -ldl -lutil -lm

*** Warning: This library needs some functionality provided by -lpython2.2.
*** I have the capability to make that library automatically link in when
*** you link to this library.  But I can only do this if you have a
*** shared version of the library, which you do not appear to have.

*** Warning: libtool could not satisfy all declared inter-library
*** dependencies of module mod_python.  Therefore, libtool will create
*** a static module, that should work as long as the dlopening
*** application is linked with the -dlopen flag.

afterwards it appears src/mod_python.so has not been created.

my best guess is that i need a libpython2.2.so but i can't figure how
to get it ??


please help!

bvr.


Zoper wrote:
> Hi All!
> 
> After making my mod_python I try to make install but...
> 
> ...............CUT....................
> Performing DSO installation.
> 
> /usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
> /usr/bin/install: src/mod_python.so: No such file or directory
> make[1]: *** [install_dso] Error 1
> make[1]: Leaving directory `/usr/src/mod_python-3.0.1'
> make: *** [install] Error 2
> ..........................................


From grisha at modpython.org  Thu Dec 12 21:13:22 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:38 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
In-Reply-To: <3DF8FFE7.7070100@xs4all.nl>
Message-ID: <20021212211044.R53709-100000@eden.ispol.com>

You don't need without-threads when compiling python. I don't know if its
the cause of the problem, but it's a start. Also, make sure you have
libtool 1.4.x. Lastly, if you compiled your own apache, try recompiling it
by first running ./buildconf, then ./configure, etc.

On Thu, 12 Dec 2002, bvr wrote:

>
> Hi,
>
> Same problem here, tried several installations with RH 7.3.
>
> tried installing these:
> python2-2.2-16.i386.rpm
> python2-devel-2.2-16.i386.rpm
> python2-docs-2.2-16.i386.rpm
>
> and:
> untar Python-2.2.2.tgz
> configure --without-threads
> make && make install
>
> both with no errors, cli interpreter works fine
>
> compiled mod python 3.0.1 like this:
>
> configure --with-apxs=/usr/local/apache2/bin/apxs
> --with-python=/usr/local/bin/python2
> make
>
> everything looks fine untill I get these warnings at the end:
>
> /usr/local/apache/build/libtool --silent --mode=link gcc -o
> mod_python.la -I/store/install/mod_python-3.0.1/src/include
> -I/usr/local/apache/include -I/usr/local/include/python2.2  -rpath
> /usr/local/apache/modules -module -avoid-version  hlistobject.lo
> hlist.lo filterobject.lo connobject.lo serverobject.lo util.lo
> tableobject.lo requestobject.lo _apachemodule.lo mod_python.lo
> -L/usr/local/lib/python2.2/config -Xlinker -export-dynamic -lm
> -lpython2.2 -ldl -lutil -lm
>
> *** Warning: This library needs some functionality provided by -lpython2.2.
> *** I have the capability to make that library automatically link in when
> *** you link to this library.  But I can only do this if you have a
> *** shared version of the library, which you do not appear to have.
>
> *** Warning: libtool could not satisfy all declared inter-library
> *** dependencies of module mod_python.  Therefore, libtool will create
> *** a static module, that should work as long as the dlopening
> *** application is linked with the -dlopen flag.
>
> afterwards it appears src/mod_python.so has not been created.
>
> my best guess is that i need a libpython2.2.so but i can't figure how
> to get it ??
>
>
> please help!
>
> bvr.
>
>
> Zoper wrote:
> > Hi All!
> >
> > After making my mod_python I try to make install but...
> >
> > ...............CUT....................
> > Performing DSO installation.
> >
> > /usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
> > /usr/bin/install: src/mod_python.so: No such file or directory
> > make[1]: *** [install_dso] Error 1
> > make[1]: Leaving directory `/usr/src/mod_python-3.0.1'
> > make: *** [install] Error 2
> > ..........................................
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From vmanera at manord.com  Fri Dec 13 08:58:14 2002
From: vmanera at manord.com (Manera, Villiam)
Date: Fri Jan  9 22:03:38 2004
Subject: R: [mod_python] problem with file download in mod-python 3.0.1
Message-ID: <52DC70C1C1575C418CB033523A29CF140E0589@exchange2000.manord.com>

Ok, but on  Fri, 7 Jun 2002 Grisha wrote to me about this problem:

Yes, whatever free time I have I try to spend on the 3.0 version that will
run on Apache 2.0. Probably the simplest way to tackle this one is for
someone to add the publisher patch to the FAQ, at least for the time
being.

Grisha

So I hope that in mod-python 3.0.2 a patch for this problem will be added

Villiam Manera
-----Messaggio originale-----
Da: Brian Hawthorne [mailto:brianh@exelixis.com]
Inviato: gioved? 12 dicembre 2002 20.27
A: Manera, Villiam
Cc: Mod_python@modpython.org
Oggetto: Re: [mod_python] problem with file download in mod-python 3.0.1


i'm not sure what the point is of wrapping the field object like this.
why not just use the field object itself as the value for the file upload
arg?  i cut this part out of my publisher because it seemed unnecessary.

brian hawthorne


On Thu, 12 Dec 2002, Manera, Villiam wrote:

> I'm testing mod-python 3.0.1 with apache 2.0.43 and python 2.2.2
> 
> I've founded a older problem in file download (from python 2.1 to 2.2)
> 
> the workaround is still the same:
> 
> in publisher.py:
> 
>  class File:
>      """ Like a file, but also has headers and filename
>      """
>      def __init__(self, field):
>          # steal all the file-like methods
>          for m in dir(field.file):            
> 		 self.__dict__[m] = getattr(field.file, m)
>  
>          self.headers = field.headers
>          self.filename = field.filename
> ======================workaround
> ==============================================
>  class File:
>      """ Like a file, but also has headers and filename
>      """
>      def __init__(self, field):
>          # steal all the file-like methods
>          #for m in dir(field.file):    #dont' work
>          for m in self.sim_methods(field.file):
>              self.__dict__[m] = getattr(field.file, m)
>  
>          self.headers = field.headers
>          self.filename = field.filename
>     
> 	#new--------	
>      def sim_methods(self,obj):
>          from types import BuiltinMethodType   
>          return filter(lambda s, t=obj:
>             type(getattr(t, s)) == BuiltinMethodType, dir(obj))
>  
>  
> I hope it will be put in place
> 
> regards
> 
> Villiam Manera
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From fuf at mobil.cz  Fri Dec 13 09:10:35 2002
From: fuf at mobil.cz (Michal Vitecek)
Date: Fri Jan  9 22:03:38 2004
Subject: [mod_python] problem with file download in mod-python 3.0.1
In-Reply-To: <52DC70C1C1575C418CB033523A29CF14104883@exchange2000.manord.com>
References: <52DC70C1C1575C418CB033523A29CF14104883@exchange2000.manord.com>
Message-ID: <20021213081034.GA5296@diana.mobil.cz>

Manera, Villiam wrote:

[snip]

>     def sim_methods(self,obj):
>         from types import BuiltinMethodType   
>         return filter(lambda s, t=obj:
>            type(getattr(t, s)) == BuiltinMethodType, dir(obj))

 I just wanted to say that code using lambda functions is considerably
 slower than when it uses list comprehensions. thus the above is faster
 with:
    
    def sim_methods(self, obj):
	from types import BuiltinMethodType
	return [attribute for attribute in dir(obj) if (type(getattr(obj,
		attribute)) == BuiltinMethodType)]

-- 
		fuf		(fuf@mobil.cz)

From listmail at xs4all.nl  Sat Dec 14 00:09:57 2002
From: listmail at xs4all.nl (baz)
Date: Fri Jan  9 22:03:38 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
In-Reply-To: <20021212211044.R53709-100000@eden.ispol.com>
References: <20021212211044.R53709-100000@eden.ispol.com>
Message-ID: <3DFA68C5.5070806@xs4all.nl>

thanks for the input, but..

did try without the without-threads before,
but had the same problem.

using this rpm version of libtool
libtool-libs-1.4.2-7
libtool-1.4.2-7

tried buildconf for apache, didn't change the problem at all

my questions are: is there such a thing as a libpython.so for python 2.2 
? if so, how would i normally produce this file ?

really hoped i could've made some progress on this issue, really want to 
move on to actually programming something .. ;)

grtz,
baz.

Gregory (Grisha) Trubetskoy wrote:
> You don't need without-threads when compiling python. I don't know if its
> the cause of the problem, but it's a start. Also, make sure you have
> libtool 1.4.x. Lastly, if you compiled your own apache, try recompiling it
> by first running ./buildconf, then ./configure, etc.
> 
> On Thu, 12 Dec 2002, bvr wrote:
>>Hi,
>>
>>Same problem here, tried several installations running RH 7.3.


From geertj at boskant.nl  Sun Dec 15 19:39:09 2002
From: geertj at boskant.nl (Geert Jansen)
Date: Fri Jan  9 22:03:38 2004
Subject: [mod_python] Annouce: Draco dynamic content system
Message-ID: <20021215183909.GD8533@vader.boskant.nl>

Hello fellow Pythoneers,

I'd like to announce the free availability of my latest mod_python project
to the list: the Draco dynamic content system.

Draco is a framework for creating dynamic web sites and and web applications.

What I like about Draco is that it is structured around a nice paradigm for a
clean separation of code (Python) and markup (html). Program code in Draco is
split in two parts: program logic and markup logic. Program logic is put in
the so-called handlers.  These handlers process the user's request and put the
result in a namespace called the interface. On the other hand, markup logic is
put in a template. The template is a regular template as seen in many dynamic
content systems but its task in Draco is much more limited. It should only
format the data in the interface in the html and nothing more.

Draco offers a large standard library with functionality that is often used in
dynamic web sites. This includes: automated session management, a limited form
of user management, easy form parsing and feedback, events, task scheduling (no
more cron!) and tag rewriting.

Draco is freely available under the GPL. More information can be found on
the Draco website at http://draco.boskant.nl/.

Thanks,
Geert Jansen

From jirka.machotka at seznam.cz  Sun Dec 15 21:04:20 2002
From: jirka.machotka at seznam.cz (=?iso-8859-2?Q?Jirka=20Machotka?=)
Date: Fri Jan  9 22:03:38 2004
Subject: [mod_python] =?iso-8859-2?Q?Re=3A=20R=3A=20=5Bmod=5Fpython=5D=20Problems=20with=20mptest=2Epy=20=28Windows=29?=
In-Reply-To: <52DC70C1C1575C418CB033523A29CF140E0570@exchange2000.manord.com>
Message-ID: <3912.4583-28975-439333470-1039982660@seznam.cz>

This is an informational issue covering somehow the solution to my
problem. It sums up few other answers - thanx for all of them! - and
as such it should be a simple handy to anyone who wants to run the
Apache with mod_python on Windows. I'd love to have something like
that a month ago (it'd spare me from few white hairs by now)

1. if you install the Apache and you want to connact it to the python
interpret all you need is a file called mod_python.so

Put it to the /modules subdirectory and add the line
   LoadModule python_module modules/mod_python.so 
to the httpd.conf

Restart the Apache server. If you get an error (cannot load
C:\...\modules\mod_python.so into server: the module could not be
found ) you need to get a file called msvcr70.dll (e.g. from
www.dll-files.com/dllindex/dll-files.shtml?msvcr70) and copy it into
\winnt\system32 (thanx to Duncan Booth for this hint). Do not forget
to restart the Apache when it's done.

This and the modification of httpd.conf file as described in the
manual should be enough so that the Apache sends all the file with
*.py extension to be processed by python

2. in order to be able to use Apache related objects in python you
need also their sources. Get the mod_python-3.0.1.tgz file, unpack
it, find the subdirectory called \site-packages and copy it into the
subdirectory of the same name of your Python installation. I know it
sounds obvious for anyone who knows about it, but honestly I could
not get this point from the manual. 

If you don't do it you will face the same problems as I did (just
scroll below for details)


Dne 5.?prosinec?2002, Manera, Villiam, <vmanera@manord.com> napsal:

> e circa il problema che dava a te?
> 
> -----Messaggio originale-----
> Da: Jirka Machotka [mailto:jirka.machotka@seznam.cz]
> Inviato: giovedi 5 dicembre 2002 12.18
> A: mod_python@modpython.org
> Oggetto: [mod_python] Problems with mptest.py (Windows)
> 
> 
> Hello there,
> 
> I have probably a very basic question. However, I could not find
> anything relevant (a searching machine would be fine)
> 
> I had had problems with running the mod_python for Apache 2.0.43.
> Following the advice I had gotten the msvcr70.dll, put it to the
> required directory and restarted the Apache. The Apache starts,
> however, when I try to fetch mptest.py (it looks exactly as described
> in the manual, the configuration file httpd has been modified
> accordingly) I receive an error:
> 
> make_obcallback: could not import mod_python.apache
> 
> To my understanding the problem relates rather to Python (my version
> is 2.2.1). The manual mentions that Python environment must be
> recompiled, or what. I'm afraid that's not possible for me
> (recompiled in what?) Or am I missing something inportant?
> 
> 
> Please help. Thanks in advance.
> 
> Jiri
> 
> ______________________________________________________________________
> Reklama:
> Sout?? o auto na v?kend, autor?dio Clarion a dal?? ceny:
> http://ad2.seznam.cz/redir.cgi?instance=12345%26url=http://www.auto-plus.cz
>  - nejlep?? syst?m prodeje ojet?ch voz? na internetu
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 

______________________________________________________________________
Reklama:
Vyhrajte cenu za 100.000,- Kc v soute?i "Svetem Financ?
za 30 dn?" na http://soutez.finance.cz. Ne? V?s predbehnou jin?!


From jw9 at softhome.net  Sun Dec 15 16:44:56 2002
From: jw9 at softhome.net (jw9@softhome.net)
Date: Fri Jan  9 22:03:38 2004
Subject: [mod_python] How to use CGI handler?
Message-ID: <000901c2a483$39291560$4b00a8c0@laptop>

I got a big python CGI script which I would like to rewrite using
mod_python. In the meanwhile, I want to try CGI handler.

Did a simple test using CGI handler, doesn't work well. Here is my config
files, all my scripts are in cgi-bin folder:

httpd.conf:
.......
<Directory "D:/Apache2/cgi-bin">
AddHandler python-program .py
AllowOverride All
PythonDebug ON
</Directory>

.htaccess file under D:/Apache2/cgi-bin:
***********************
SetHandler python-program
PythonHandler mod_python.cgihandler

very simple test script:
***********************
print 'Content-type: text/html\n'
print 'Hello World!'


result:
***********************
Mod_python error: "PythonHandler mod_python.cgihandler" Traceback (most
recent call last): File "D:\PYTHON22\Lib\mod_python\apache.py", line 335, in
HandlerDispatch result = object(req) File
"D:\PYTHON22\Lib\mod_python\cgihandler.py", line 140, in handler
apache.restore_nocgi(env, si, so) File
"D:\PYTHON22\Lib\mod_python\apache.py", line 764, in restore_nocgi for k in
osenv: RuntimeError: dictionary changed size during iteration

I don't what is wrong.  Anybody have the same experience? By the way, the
mptest.py worked, so I guess at least the installation was succesful.

Thanks!


From sebastian.tusk at gmx.net  Sun Dec 15 23:09:02 2002
From: sebastian.tusk at gmx.net (Sebastian Tusk)
Date: Fri Jan  9 22:03:38 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
In-Reply-To: <3DFA68C5.5070806@xs4all.nl>
References: <20021212211044.R53709-100000@eden.ispol.com> <3DFA68C5.5070806@xs4all.nl>
Message-ID: <3DFCFD7E.7000105@gmx.net>

 > *** Warning: This library needs some functionality provided by
 > -lpython2.2.
 > *** I have the capability to make that library automatically link in
 > when
 > *** you link to this library.  But I can only do this if you have a
 > *** shared version of the library, which you do not appear to have.

The problem is that apache 2 comes with an old version of libtool and 
uses that. mod_python uses via apxs the same outdated version. So you 
need to replace libtool in the apache 2 source distribution and rebuild 
apache and then rebuild mod_python. At least that works for me.

Sebastian



From geo at overweb.it  Mon Dec 16 17:42:50 2002
From: geo at overweb.it (Geo)
Date: Fri Jan  9 22:03:38 2004
Subject: [mod_python] Different PythonHander
Message-ID: <1040056970.3dfe028ae35eb@phpgroupware.overweb.it>

How can I set httpd.conf to have a different PythonHandler
for each user?

I need something like this:

<Directory "/usr/home/*/public_html">
      AddHandler python-program .py
      PythonHandler mptest
      PythonDebug on
</Directory>

Thanks

-- 
Gerolamo Valcamonica

From zoper at libero.it  Tue Dec 17 13:40:04 2002
From: zoper at libero.it (Zoper)
Date: Fri Jan  9 22:03:38 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
References: <20021212211044.R53709-100000@eden.ispol.com> <3DFA68C5.5070806@xs4all.nl> <3DFCFD7E.7000105@gmx.net>
Message-ID: <001e01c2a5c9$91e4dda0$c4281a97@sorpippo>

Hi All.

> The problem is that apache 2 comes with an old version of libtool and 
> uses that. mod_python uses via apxs the same outdated version. So you 
> need to replace libtool in the apache 2 source distribution and rebuild 
> apache and then rebuild mod_python. At least that works for me.

How can I replace libtool in the apache 2 source distribution?

Is this the right way to preceed?

tar xvfz libtool-1.4.2.tar.gz
cd libtool-1.4.2 
./configure --prefix=/usr
make
make install 

and then 

cd httpd-2.0.39 
./configure 
make ; make install


Thanks in advance.


Gius.



From sebastian.tusk at gmx.net  Tue Dec 17 13:50:26 2002
From: sebastian.tusk at gmx.net (Sebastian Tusk)
Date: Fri Jan  9 22:03:38 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
In-Reply-To: <001e01c2a5c9$91e4dda0$c4281a97@sorpippo>
References: <20021212211044.R53709-100000@eden.ispol.com> <3DFA68C5.5070806@xs4all.nl> <3DFCFD7E.7000105@gmx.net> <001e01c2a5c9$91e4dda0$c4281a97@sorpippo>
Message-ID: <3DFF1D92.1010204@gmx.net>

> How can I replace libtool in the apache 2 source distribution?
> 
> Is this the right way to preceed?
> 
> tar xvfz libtool-1.4.2.tar.gz
> cd libtool-1.4.2 
> ./configure --prefix=/usr
> make
> make install 
> 
> and then 
> 
> cd httpd-2.0.39 
> ./configure 
> make ; make install

That will not work. Apache comes with its own libtool. Replace 
httpd-2.0.43/srclib/apr/libtool with that from your system (e.g. 
/usr/local/bin/libtool) Then rebuild apache and mod_python.

Sebastian


From grisha at modpython.org  Tue Dec 17 10:08:57 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:38 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
In-Reply-To: <001e01c2a5c9$91e4dda0$c4281a97@sorpippo>
Message-ID: <20021217100543.X15809-100000@eden.ispol.com>

You can replace the libtool apache comes with by running ./buildconf just
before running apache's ./configure. Among other things, ./buildconf takes
the libtool on the system and incorporates it into apache. I think what's
happening is 2.0.43 in particular came bundled with an outdated libtool by
mistake.

Grisha

On Tue, 17 Dec 2002, Zoper wrote:

> Hi All.
>
> > The problem is that apache 2 comes with an old version of libtool and
> > uses that. mod_python uses via apxs the same outdated version. So you
> > need to replace libtool in the apache 2 source distribution and rebuild
> > apache and then rebuild mod_python. At least that works for me.
>
> How can I replace libtool in the apache 2 source distribution?
>
> Is this the right way to preceed?
>
> tar xvfz libtool-1.4.2.tar.gz
> cd libtool-1.4.2
> ./configure --prefix=/usr
> make
> make install
>
> and then
>
> cd httpd-2.0.39
> ./configure
> make ; make install
>
>
> Thanks in advance.
>
>
> Gius.
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From grisha at modpython.org  Tue Dec 17 16:30:53 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:38 2004
Subject: [mod_python] bug/misfeature in publisher/mod_python
In-Reply-To: <20021203151244.GB16590@legolas.on.net.mk>
Message-ID: <20021217162845.N19724-100000@eden.ispol.com>

On Tue, 3 Dec 2002, Damjan wrote:

> My setup:
>  apache 2.0.43, mod_python 3.0.1, python 2.2.1
>
> httpd.conf:
> <Directory /home/www/htdocs> # The root of the web server
> ...
>     SetHandler python-program
>     PythonHandler mod_python.publisher | .py
>     PythonDebug On
> </Directory>
> ...
>
> I expect this setup to handle all files ending in ".py" through
> the publisher handler.
>
> I have the script "hello.py" from the mod_python manual in the root of the
> web-server. Trying to get "http://127.1/hello.py/say" mod_python
> throws an exception (traceback atached).
>
> The exception is: "ImportError: No module named py"

But http://127.1/hello/say (without .py) should work.

(I still agree that this is a problem, just wanted to point out that there
is one way to make it work)

Grisha



From listmail at xs4all.nl  Wed Dec 18 00:11:46 2002
From: listmail at xs4all.nl (baz)
Date: Fri Jan  9 22:03:38 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
In-Reply-To: <002001c2a021$66b50720$1c291a97@sorpippo>
References: <002001c2a021$66b50720$1c291a97@sorpippo>
Message-ID: <3DFFAF32.1010600@xs4all.nl>

i solved my problem, maybe you've got the same so check this:

try
# locate libpython2.2.so

if nothing comes up you don't have the python shared library, which is 
needed by mod python.

i used the following commands to build it from source and install it:

cd Python-2.2.2/
make distclean
./configure
make OPT="-fpic -O2"
mkdir .extract
(cd .extract; ar xv ../libpython2.2.a)
gcc -shared -o libpython2.2.so .extract/*.o
rm -rf .extract
make install

or you may install the separate debian package for this file

have fun!

baz.

Zoper wrote:
> Hi All!
> 
> After making my mod_python I try to make install but...
> 
> ...............CUT....................
> Performing DSO installation.
> 
> /usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
> /usr/bin/install: src/mod_python.so: No such file or directory
> make[1]: *** [install_dso] Error 1
> make[1]: Leaving directory `/usr/src/mod_python-3.0.1'
> make: *** [install] Error 2
> ..........................................
> 


From zoper at libero.it  Wed Dec 18 17:06:23 2002
From: zoper at libero.it (Zoper)
Date: Fri Jan  9 22:03:38 2004
Subject: [mod_python] mod_python 3.0.1: problem with libtool and apache
Message-ID: <001301c2a6af$6cbfec40$602b1a97@sorpippo>

Hi All.

Thanks a lot for the previous answers.
I replaced the old libtool apache come with, but when I make apache I obtain
an ugly message...

libtool: link: cannot find the library `'
make[1]: *** [httpd] Error 1
make[1]: Leaving directory `/usr/src/httpd-2.0.43'
make: *** [all-recursive] Error 1

What does it mean?

Thanks in advance.

Gius.


From webmaster at obramaestraonline.com  Wed Dec 18 13:26:37 2002
From: webmaster at obramaestraonline.com (Rafael Fernandez)
Date: Fri Jan  9 22:03:38 2004
Subject: [mod_python] mod_python in Win32, Apache 2.0.43
Message-ID: <002d01c2a6ba$c8321b10$cc393242@Family>

Can somebody send me the code for running mod_python in Apache 2.0.43 in
the Win32 Platform?

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20021218/dac86ef0/attachment-0003.htm
From grisha at modpython.org  Wed Dec 18 15:08:13 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:38 2004
Subject: [mod_python] bug/misfeature in publisher/mod_python
In-Reply-To: <20021217162845.N19724-100000@eden.ispol.com>
Message-ID: <20021218150543.C29444-100000@eden.ispol.com>

I take it back, what I said below isn't true, it won't work :)

But I did patch up the latest CVS code so that it addresses this issue.

Grisha

On Tue, 17 Dec 2002, Gregory (Grisha) Trubetskoy wrote:

>
> On Tue, 3 Dec 2002, Damjan wrote:
>
> > My setup:
> >  apache 2.0.43, mod_python 3.0.1, python 2.2.1
> >
> > httpd.conf:
> > <Directory /home/www/htdocs> # The root of the web server
> > ...
> >     SetHandler python-program
> >     PythonHandler mod_python.publisher | .py
> >     PythonDebug On
> > </Directory>
> > ...
> >
> > I expect this setup to handle all files ending in ".py" through
> > the publisher handler.
> >
> > I have the script "hello.py" from the mod_python manual in the root of the
> > web-server. Trying to get "http://127.1/hello.py/say" mod_python
> > throws an exception (traceback atached).
> >
> > The exception is: "ImportError: No module named py"
>
> But http://127.1/hello/say (without .py) should work.
>
> (I still agree that this is a problem, just wanted to point out that there
> is one way to make it work)
>
> Grisha
>
>
>


From cameron at toolhouse.com  Wed Dec 18 14:28:52 2002
From: cameron at toolhouse.com (Cameron S. Watters)
Date: Fri Jan  9 22:03:38 2004
Subject: [mod_python] mod_python 3.0.1: error after make install
In-Reply-To: <3DFFAF32.1010600@xs4all.nl>
Message-ID: <16154ED8-12D8-11D7-979F-00306599D91A@toolhouse.com>

Since I posted almost EXACTLY the same comment as the quoted one on 
December 4th, I thought I'd reply.

My understanding is that this shouldn't be necessary, but is, in fact, 
an issue with the version of libtool supplied with apache.

I was able to fix my problem by building apache from source by running:

tar -xzvf apache-tarball.tgz
cd apache-src-dir/
./buildconf
./configure --a mass of configure options
make
make install

you probably want to make sure you have a newish libtool installed 
BEFORE you do the above.

this made it stop freaking out because it couldn't find a 
libpython2.2.so. It is also my understanding that building libpython2.2 
doesn't actually do anything other than fool
the install portion of the build into continuing with the process and 
not erroring out.

I mention this mostly because this may NOT, in fact, be the most 
correct solution to this problem.

--cameron

> i solved my problem, maybe you've got the same so check this:
>
> try
> # locate libpython2.2.so
>
> if nothing comes up you don't have the python shared library, which is 
> needed by mod python.
>
> i used the following commands to build it from source and install it:
>
> cd Python-2.2.2/
> make distclean
> ./configure
> make OPT="-fpic -O2"
> mkdir .extract
> (cd .extract; ar xv ../libpython2.2.a)
> gcc -shared -o libpython2.2.so .extract/*.o
> rm -rf .extract
> make install
>
> or you may install the separate debian package for this file
>
> have fun!
>
> baz.
>
> Zoper wrote:
>> Hi All!
>> After making my mod_python I try to make install but...
>> ...............CUT....................
>> Performing DSO installation.
>> /usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
>> /usr/bin/install: src/mod_python.so: No such file or directory
>> make[1]: *** [install_dso] Error 1
>> make[1]: Leaving directory `/usr/src/mod_python-3.0.1'
>> make: *** [install] Error 2
>> ..........................................
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From gnb at itga.com.au  Thu Dec 19 18:27:04 2002
From: gnb at itga.com.au (Gregory Bond)
Date: Fri Jan  9 22:03:38 2004
Subject: [mod_python] import mod_puthon.util fails
Message-ID: <200212190727.SAA10103@lightning.itga.com.au>

[I'm brand new to mod_python and this list....]

FreeBSD 4-Stable (as of the other day, so it's after 4.7)

Apache 2.0.43, built from the FreeBSD port, with USE_THREADS

mod_python 3.0.1, built using "./configure && make"

hellcat$ python -c "import mod_python.util"
Traceback (most recent call last):
  File "<string>", line 1, in ?
  File "/usr/local/lib/python2.2/site-packages/mod_python/util.py", line 58, in ?
    import _apache
ImportError: No module named _apache
hellcat$ 

And indeed there is nothing that looks like _apache.so.  There is a src/
_apachemodule.c, which is compiled and linked into mod_python.so, which has 
what seems to be the intended contents of the _apache module, but this is 
never turned into the appropriate .so file.

Am I doing something wrong?



From zoper at libero.it  Thu Dec 19 15:53:53 2002
From: zoper at libero.it (Zoper)
Date: Fri Jan  9 22:03:38 2004
Subject: [mod_python] mod_python 3.0.1: problem with libtool and apache
Message-ID: <004e01c2a76e$74dbd3c0$022b1a97@sorpippo>

Hi All.

Thanks a lot for the previous answers.
I replaced the old libtool apache come with, but when I make apache I obtain
an ugly message...

libtool: link: cannot find the library `'
make[1]: *** [httpd] Error 1
make[1]: Leaving directory `/usr/src/httpd-2.0.43'
make: *** [all-recursive] Error 1

What does it mean?

Thanks in advance.

Gius.


From zoper at libero.it  Thu Dec 19 15:57:26 2002
From: zoper at libero.it (Zoper)
Date: Fri Jan  9 22:03:39 2004
Subject: [mod_python] mod_python 3.0.1: problem with libtool and apache
Message-ID: <006f01c2a76e$f2cda600$022b1a97@sorpippo>

Hi All.

Thanks a lot for the previous answers.
I replaced the old libtool apache come with, but when I make apache I obtain
an ugly message...

libtool: link: cannot find the library `'
make[1]: *** [httpd] Error 1
make[1]: Leaving directory `/usr/src/httpd-2.0.43'
make: *** [all-recursive] Error 1

What does it mean?

Thanks in advance.

Gius.


From grisha at modpython.org  Thu Dec 19 10:24:45 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:39 2004
Subject: [mod_python] import mod_puthon.util fails
In-Reply-To: <200212190727.SAA10103@lightning.itga.com.au>
Message-ID: <20021219102330.X43686-100000@eden.ispol.com>

No, you're not doing anything wrong, _apache is only available when
mod_python is loaded as an apache module, you can't really use any of
those modules from the command line.

On Thu, 19 Dec 2002, Gregory Bond wrote:

> [I'm brand new to mod_python and this list....]
>
> FreeBSD 4-Stable (as of the other day, so it's after 4.7)
>
> Apache 2.0.43, built from the FreeBSD port, with USE_THREADS
>
> mod_python 3.0.1, built using "./configure && make"
>
> hellcat$ python -c "import mod_python.util"
> Traceback (most recent call last):
>   File "<string>", line 1, in ?
>   File "/usr/local/lib/python2.2/site-packages/mod_python/util.py", line 58, in ?
>     import _apache
> ImportError: No module named _apache
> hellcat$
>
> And indeed there is nothing that looks like _apache.so.  There is a src/
> _apachemodule.c, which is compiled and linked into mod_python.so, which has
> what seems to be the intended contents of the _apache module, but this is
> never turned into the appropriate .so file.
>
> Am I doing something wrong?
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From sebastian.tusk at gmx.net  Thu Dec 19 20:15:12 2002
From: sebastian.tusk at gmx.net (Sebastian Tusk)
Date: Fri Jan  9 22:03:39 2004
Subject: [mod_python] AddOutputFilterByType not working
Message-ID: <3E021AC0.4010504@gmx.net>

The apache directive AddOutputFilterByType doesn't work for content 
generated by mod_python. The reason for this is the following line in 
requestobject.c

self->request_rec->content_type =
     apr_pstrdup(self->request_rec->pool, PyString_AsString(val));

which should read

ap_set_content_type(self->request_rec, PyString_AsString(val));


Sebastian


From gnb at itga.com.au  Fri Dec 20 09:28:58 2002
From: gnb at itga.com.au (Gregory Bond)
Date: Fri Jan  9 22:03:39 2004
Subject: [mod_python] import mod_puthon.util fails 
In-Reply-To: Your message of Thu, 19 Dec 2002 10:24:45 -0500.
Message-ID: <200212192228.JAA12799@lightning.itga.com.au>

>No, you're not doing anything wrong, _apache is only available when
>mod_python is loaded as an apache module, you can't really use any of
>those modules from the command line.

<lightbulb>Aha!</lightbulb>

Thanks.  I've submited an FAQ update.  [That faq wizard is kewl]



From gnb at itga.com.au  Fri Dec 20 17:33:18 2002
From: gnb at itga.com.au (Gregory Bond)
Date: Fri Jan  9 22:03:39 2004
Subject: [mod_python] cgi handler bug?
Message-ID: <200212200633.RAA17433@lightning.itga.com.au>

[FreeBSD 4.7, python 2.2.2, Apache 2.0.43, mod_python 3.0.1]

When I try and run something using cgihandler, I get the following error:

[Fri Dec 20 16:54:25 2002] [error] [client 192.168.71.163] PythonHandler mod_python.cgihandler:   File "/usr/local/lib/python2.2/site-packages/mod_python/apache.py", line 764, in restore_nocgi
    for k in osenv:
[Fri Dec 20 16:54:25 2002] [error] [client 192.168.71.163] PythonHandler mod_python.cgihandler: RuntimeError: dictionary changed size during iteration

Looking at mod_python/apache.py:restore_nocgi(), this does:
    for k in osenv:
        del osenv[k]

This is never going to be legal in Python 2.2.  Shouldn't this be 

    for k in osenv.keys():
        del osenv[k]

?

Having made that change, and a few little fixes to the cgi program, (__name__
== "__main__" is no longer true, "foo-bar.py" is not a good name as "import
foo-bar" is a syntax error) my cgi now runs inside mod_python.  But the HTML
generated by the CGI is sent twice, so my page displays double.  I've added 
debugging and the HTML is only being sent from the script once, as far as I 
can tell.  (i.e. I print a string of length 2132 bytes, but View Page Info 
shows 4215 bytes.   No, I have no idea where the missing 49 bytes are!)

Any clues?

Greg.



From grisha at modpython.org  Fri Dec 20 16:34:37 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:39 2004
Subject: [mod_python] problem with file download in mod-python 3.0.1
In-Reply-To: <52DC70C1C1575C418CB033523A29CF14104883@exchange2000.manord.com>
Message-ID: <20021220151113.I61260-100000@eden.ispol.com>

I must be missing something obvious, but without testing it and just by
looking at the code, I'm not sure I understand what the benefit is of
filtering out BuiltinMethodType, as opposed to just using straight
dir(obj).

The above might be a moot point since just as Brian Hawthorne suggested
I'm not sure why we don't need the File class at all and am in the process
of trying to fish out any memories from my tired brain about how it came
about in the fist place....

Grisha

On Thu, 12 Dec 2002, Manera, Villiam wrote:

> I'm testing mod-python 3.0.1 with apache 2.0.43 and python 2.2.2
>
> I've founded a older problem in file download (from python 2.1 to 2.2)
>
> the workaround is still the same:
>
> in publisher.py:
>
>  class File:
>      """ Like a file, but also has headers and filename
>      """
>      def __init__(self, field):
>          # steal all the file-like methods
>          for m in dir(field.file):
> 		 self.__dict__[m] = getattr(field.file, m)
>
>          self.headers = field.headers
>          self.filename = field.filename
> ======================workaround
> ==============================================
>  class File:
>      """ Like a file, but also has headers and filename
>      """
>      def __init__(self, field):
>          # steal all the file-like methods
>          #for m in dir(field.file):    #dont' work
>          for m in self.sim_methods(field.file):
>              self.__dict__[m] = getattr(field.file, m)
>
>          self.headers = field.headers
>          self.filename = field.filename
>
> 	#new--------
>      def sim_methods(self,obj):
>          from types import BuiltinMethodType
>          return filter(lambda s, t=obj:
>             type(getattr(t, s)) == BuiltinMethodType, dir(obj))
>
>
> I hope it will be put in place
>
> regards
>
> Villiam Manera
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>




From LBerezhny at DevIS.com  Sat Dec 21 20:53:41 2002
From: LBerezhny at DevIS.com (Lex Berezhny)
Date: Fri Jan  9 22:03:39 2004
Subject: [mod_python] installation problems
Message-ID: <1040522021.12314.421.camel@hortus>

hi all,

  I'm having trouble installing mod_python.

My environment:
Red Hat Linux release 7.3
gcc 2.96


My install process:

wget http://www.apache.org/dist/httpd/httpd-2.0.43.tar.gz
tar xzvf httpd-2.0.43.tar.gz
wget http://apache.webmeta.com/dist/httpd/modpython/mod_python-3.0.1.tgz
tar xzvf mod_python-3.0.1.tgz
wget http://www.python.org/ftp/python/2.2.2/Python-2.2.2.tgz
tar xzvf Python-2.2.2.tgz

cd httpd-2.0.43
./configure --prefix=/usr/local/apache2
make
make install 

cd ../Python-2.2.2/
./configure
make
make install

cd ../mod_python-3.0.1/
./configure --with-apxs=/usr/local/apache2/bin/apxs
--with-python=/usr/local/bin/python2.2
make
make install


Warning messages I get (during make):

*** Warning: This library needs some functionality provided by
-lpython2.2.
*** I have the capability to make that library automatically link in
when
*** you link to this library.  But I can only do this if you have a
*** shared version of the library, which you do not appear to have.

*** Warning: libtool could not satisfy all declared inter-library
*** dependencies of module mod_python.  Therefore, libtool will create
*** a static module, that should work as long as the dlopening
*** application is linked with the -dlopen flag.


The final, fatal, error (during make install):

make[2]: Leaving directory
`/usr/local/apache2install/mod_python-3.0.1/src'

Performing DSO installation.

/usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
/usr/bin/install: cannot stat `src/mod_python.so': No such file or
directory
make[1]: *** [install_dso] Error 1
make[1]: Leaving directory `/usr/local/apache2install/mod_python-3.0.1'
make: *** [install] Error 2




any help or pointers would be greatly appreciated,

 - lex


From grisha at modpython.org  Sat Dec 21 21:45:58 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:39 2004
Subject: [mod_python] installation problems
In-Reply-To: <1040522021.12314.421.camel@hortus>
Message-ID: <20021221214317.K81120-100000@eden.ispol.com>

Try this:

Make sure you have libtool 1.4.x, you can do this with libtool --version.

If/when you do, rebuild your apache like this:

cd httpd-2.0.43
./buildconf
./configure --prefix=/usr/local/apache2
make
make install

then ./configure and make mod_python.

On 21 Dec 2002, Lex Berezhny wrote:

> hi all,
>
>   I'm having trouble installing mod_python.
>
> My environment:
> Red Hat Linux release 7.3
> gcc 2.96
>
>
> My install process:
>
> wget http://www.apache.org/dist/httpd/httpd-2.0.43.tar.gz
> tar xzvf httpd-2.0.43.tar.gz
> wget http://apache.webmeta.com/dist/httpd/modpython/mod_python-3.0.1.tgz
> tar xzvf mod_python-3.0.1.tgz
> wget http://www.python.org/ftp/python/2.2.2/Python-2.2.2.tgz
> tar xzvf Python-2.2.2.tgz
>
> cd httpd-2.0.43
> ./configure --prefix=/usr/local/apache2
> make
> make install
>
> cd ../Python-2.2.2/
> ./configure
> make
> make install
>
> cd ../mod_python-3.0.1/
> ./configure --with-apxs=/usr/local/apache2/bin/apxs
> --with-python=/usr/local/bin/python2.2
> make
> make install
>
>
> Warning messages I get (during make):
>
> *** Warning: This library needs some functionality provided by
> -lpython2.2.
> *** I have the capability to make that library automatically link in
> when
> *** you link to this library.  But I can only do this if you have a
> *** shared version of the library, which you do not appear to have.
>
> *** Warning: libtool could not satisfy all declared inter-library
> *** dependencies of module mod_python.  Therefore, libtool will create
> *** a static module, that should work as long as the dlopening
> *** application is linked with the -dlopen flag.
>
>
> The final, fatal, error (during make install):
>
> make[2]: Leaving directory
> `/usr/local/apache2install/mod_python-3.0.1/src'
>
> Performing DSO installation.
>
> /usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
> /usr/bin/install: cannot stat `src/mod_python.so': No such file or
> directory
> make[1]: *** [install_dso] Error 1
> make[1]: Leaving directory `/usr/local/apache2install/mod_python-3.0.1'
> make: *** [install] Error 2
>
>
>
>
> any help or pointers would be greatly appreciated,
>
>  - lex
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From skremer at q.cis.uoguelph.ca  Sun Dec 22 01:47:25 2002
From: skremer at q.cis.uoguelph.ca (Stefan C. Kremer)
Date: Fri Jan  9 22:03:39 2004
Subject: [mod_python] Warning: This library needs some functionality provided by -lpython2.2.
Message-ID: <Pine.LNX.4.44.0212220126580.17196-100000@q.cis.uoguelph.ca>

Hi,

I just read another post about this message by Lex Berezhny and Gregory 
(Grisha) Trubetskoy after experiencing exactly the same problem.

It turns out that the command:

wget http://www.apache.org/dist/httpd/httpd-2.0.43.tar.gz

Provides a very old version of libtool:

$ /usr/local/apache/build/libtool --version
ltmain.sh (GNU libtool) 1.3.4-freebsd-ports (1.385.2.196 1999/12/07 
21:47:57)

By contrast, httpd-2.0.42 has libtool-1.4.2.
(wget http://www.apache.org/dist/httpd/old/httpd-2.0.42.tar.gz)
Any the mod_python install goes smoothly.

Anyone know what's going on with this?!?  Did someone at apache just
screw-up and include the wrong version?  Or is there a reason for this 
downgrade?

Is there an easy remedy to patch 2.0.43 to work correctly?  Can I 
just copy one libtool over the other?  Anyone willing 
to share advice/experiences is greatly appreciated.

Thanks,

	-Stefan

-- 
--
Dr. Stefan C. Kremer, Associate Prof.
Reynolds Building, 106
Dept. of Computing and Information Science
University of Guelph, Guelph, Ontario	N1G 2W1

WWW: http://q.cis.uoguelph.ca/~skremer
Tel: (519)824-4120 Ext.8913  Fax: (519)837-0323
E-mail:  skremer@uoguelph.ca


From alphasquad at web.de  Sun Dec 22 20:21:37 2002
From: alphasquad at web.de ([FTSB]Hawk)
Date: Fri Jan  9 22:03:39 2004
Subject: [mod_python] mod_python cgihandler bug?
Message-ID: <JFEBLGLFKE2CHD65CBA69EAFAJFQP.3e0610c1@Hawk>

Hello

I found some questions on the same topic but no answers.
I installed mod_python 3.0.1 on Win2k and Apache 2.0.43.
Everything seemed to be fine.
But when I tried to use the cgihandler I got an error.
The python script consists of two lines only:

print "content-type: text/plain \n\n"
print "<b>something</b>"

So I do not expect the error to be there. With PythonDebug On I got this message


<b>something</b>
<b>something</b>

Mod_python error: "PythonHandler mod_python.cgihandler"

Traceback (most recent call last):

  File "G:\PYTHON\PYTHON\lib\site-packages\mod_python\apache.py", line 335, in HandlerDispatch
    result = object(req)

  File "G:\PYTHON\PYTHON\lib\site-packages\mod_python\cgihandler.py", line 140, in handler
    apache.restore_nocgi(env, si, so)

  File "G:\PYTHON\PYTHON\lib\site-packages\mod_python\apache.py", line 764, in restore_nocgi
    for k in osenv:

RuntimeError: dictionary changed size during iteration


I need this cgihandler for a port of a rather large project.

Hawk





From grisha at modpython.org  Sun Dec 22 16:41:45 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:39 2004
Subject: [mod_python] Warning: This library needs some functionality
 provided by -lpython2.2.
In-Reply-To: <Pine.LNX.4.44.0212220126580.17196-100000@q.cis.uoguelph.ca>
Message-ID: <20021222164004.S90422-100000@eden.ispol.com>

On Sun, 22 Dec 2002, Stefan C. Kremer wrote:

> It turns out that the command:
>
> wget http://www.apache.org/dist/httpd/httpd-2.0.43.tar.gz
>
> Provides a very old version of libtool:
>
> $ /usr/local/apache/build/libtool --version
> ltmain.sh (GNU libtool) 1.3.4-freebsd-ports (1.385.2.196 1999/12/07
> 21:47:57)
>
> By contrast, httpd-2.0.42 has libtool-1.4.2.
> (wget http://www.apache.org/dist/httpd/old/httpd-2.0.42.tar.gz)
> Any the mod_python install goes smoothly.
>
> Anyone know what's going on with this?!?  Did someone at apache just
> screw-up and include the wrong version?

This seems to be the case.

> Is there an easy remedy to patch 2.0.43 to work correctly?

Yes, simply running ./buildconf make apache adopt the version of libtool
on the system.

Grisha


From gnb at itga.com.au  Mon Dec 23 09:15:50 2002
From: gnb at itga.com.au (Gregory Bond)
Date: Fri Jan  9 22:03:39 2004
Subject: [mod_python] mod_python cgihandler bug? 
In-Reply-To: Your message of Sun, 22 Dec 2002 20:21:37 +0100.
Message-ID: <200212222215.JAA00265@lightning.itga.com.au>

In the line:
  File "G:\PYTHON\PYTHON\lib\site-packages\mod_python\apache.py", line 764, in restore_nocgi
    for k in osenv:

Change this to 
	for k in osenv.keys():
and it gets past this problem.  I have still other problems with cgihandler 
tho (see my message from the other day).



From LBerezhny at DevIS.com  Sun Dec 22 18:29:18 2002
From: LBerezhny at DevIS.com (Lex Berezhny)
Date: Fri Jan  9 22:03:39 2004
Subject: [mod_python] ImportError: No module named mod_python.apache
Message-ID: <1040599758.21517.25.camel@buddha>

hello again,

  Thanks for the ./buildconf pointer, it is working great! (i have
attached an updated bash script to get others started, it's only been
tested on RH7, don't forget to su first ;-)

  The next phase of my mod_python escapade involved trying to get the
example working, that's when I hit my next snag.

  The following additions were made to httpd.conf:

    230 LoadModule python_module
/usr/local/apache2/modules/mod_python.so

    361 <Directory "/usr/local/apache2/htdocs/test">
    362     AddHandler python-program .py
    363     PythonHandler mptest
    364     PythonDebug On
    365 </Directory>


  I started apache as follows:

# ./apachectl -k start -DONE_PROCESS


  Going to http://localhost/test/mptest.py produced an Internal Server
Error with the following message in error_log:

[Sun Dec 22 17:57:55 2002] [error] make_obcallback: could not import
mod_python.apache.

ImportError: No module named mod_python.apache

  Is there any simple way to get mod_python to print out its sys.path?
What could cause an incorrect import path? Any suggestions on resolving
this?

thanks a lot,
 - lex
-------------- next part --------------
A non-text attachment was scrubbed...
Name: install.sh
Type: text/x-sh
Size: 563 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20021222/3ba3579e/install-0003.bin
From LBerezhny at DevIS.com  Sun Dec 22 19:04:34 2002
From: LBerezhny at DevIS.com (Lex Berezhny)
Date: Fri Jan  9 22:03:39 2004
Subject: [mod_python] ImportError: No module named mod_python.apache
In-Reply-To: <1040599758.21517.25.camel@buddha>
References: <1040599758.21517.25.camel@buddha>
Message-ID: <1040601873.21517.40.camel@buddha>

heya,

>   Is there any simple way to get mod_python to print out its sys.path?

i found a way to answer my first question (after looking through the
mod_python mailing list archive i found an email by Conrad Steenberg
suggesting strace). I had to adapt his example to work on my machine:

i started apache:
# ./apachectl -k start -DONE_PROCESS

then i got the process id and ran strace like so:
$ strace -p 29405

Every time I went to the URL of my script strace printed out the
following:

......
stat64("/usr/lib/python2.2/mod_python", 0xbfffeb30) = -1 ENOENT (No such
file or directory)
open("/usr/lib/python2.2/mod_python.so", O_RDONLY|O_LARGEFILE) = -1
ENOENT (No such file or directory)
open("/usr/lib/python2.2/mod_pythonmodule.so", O_RDONLY|O_LARGEFILE) =
-1 ENOENT (No such file or directory)
open("/usr/lib/python2.2/mod_python.py", O_RDONLY|O_LARGEFILE) = -1
ENOENT (No such file or directory)
open("/usr/lib/python2.2/mod_python.pyc", O_RDONLY|O_LARGEFILE) = -1
ENOENT (No such file or directory)
....

For some reason mod_python uses the wrong python install directory (i
have two, one that came with my redhat system under /usr/lib/python2.2
and one that i install as part of my script /usr/local/lib/python2.2).

So, where does mod_python make the decision on which python to use?
Again my ./configure for mod_python was this:

./configure --with-apxs=/usr/local/apache2/bin/apxs
--with-python=/usr/local/bin/python2.2

> What could cause an incorrect import path? Any suggestions on resolving
> this?

Thanks again,
 - lex


From gnb at itga.com.au  Mon Dec 23 11:24:46 2002
From: gnb at itga.com.au (Gregory Bond)
Date: Fri Jan  9 22:03:39 2004
Subject: [mod_python] cgi handler bug? 
In-Reply-To: Your message of Fri, 20 Dec 2002 17:33:18 +1100.
Message-ID: <200212230024.LAA08767@lightning.itga.com.au>

I wrote: 

> But the HTML
> generated by the CGI is sent twice, so my page displays double. 

Found it.

In mod_python.apache.py, in the CGIStdout::write() routine, the
self.headers_sent variable is never being set, so the first chunk of stuff from
the CGI program (in my case, all but the last newline) is being handled and
sent twice.

The following patch fixes both CGIhandler problems, and my CGIs now happily 
operate under mod_python:

diff -u ~gnb/mod_python-3.0.1/lib/python/mod_python/apache.py /usr/local/lib/python2.2/site-packages/mod_python/apache.py
--- /home/users/gnb/mod_python-3.0.1/lib/python/mod_python/apache.py    Fri Nov  8 11:15:11 2002
+++ /usr/local/lib/python2.2/site-packages/mod_python/apache.py Mon Dec 23 11:18:56 2002
@@ -723,6 +723,7 @@
                     else:
                         self.req.headers_out.add(h, v)
 
+               self.headers_sent = 1
                 # write the body if any at this point
                 self.req.write(ss[1])
         else:
@@ -761,7 +762,7 @@
     osenv = os.environ
 
     # restore env
-    for k in osenv:
+    for k in osenv.keys():
         del osenv[k]
     for k in sav_env:
         osenv[k] = env[k]




From jim at thario.net  Sun Dec 22 22:17:09 2002
From: jim at thario.net (Jim Thario)
Date: Fri Jan  9 22:03:39 2004
Subject: [mod_python] Problems with PythonAuthenHandler on Red Hat 8.0?
Message-ID: <33470.63.227.22.21.1040620629.squirrel@webmail.thario.com>

Hi. I recently stared working with mod_python. I am using the stock Red
Hat 8.0 installation which includes:

httpd-2.0.40-11
python-2.2.1-17
mod_python-3.0.0-10

I am having trouble with the example from "3.4 Now something More
Complicated - Authentication". My configuration in httpd.conf looks like:

<Directory /var/www/html/python>
        AddHandler python-program .py
        PythonHandler myscript
        PythonAuthenHandler myscript
        PythonDebug On
        AuthType Basic
        AuthName "Restricted Area"
        require valid-user
</Directory>

After getting prompted for the user and password, I get a "Server error!"
page and an entry in the /var/log/httpd/error_log:

"configuration error:  couldn't check user.  No user file?: /python"

Apache seems to want an AuthUserFile in there to read. The best I can
guess is there is a problem with the version of mod_python shipped with
Red Hat 8.0.

Any ideas?

Thanks in advance,
Jim




From tsyang at webtech360.com  Thu Dec 26 13:56:52 2002
From: tsyang at webtech360.com (T.-S. Yang)
Date: Fri Jan  9 22:03:39 2004
Subject: [mod_python] Problems with PythonAuthenHandler on Red Hat 8.0?
In-Reply-To: <33470.63.227.22.21.1040620629.squirrel@webmail.thario.com>
References: <33470.63.227.22.21.1040620629.squirrel@webmail.thario.com>
Message-ID: <3E0B7B24.30505@webtech360.com>

Jim,

I'm able to reproduce the error that you described using RedHat 8.
The problem is fixed under ReHat 8.0.92 (Phoebe).

I don't know the cause of the problem. The related packages in Phoebe
are

httpd-2.0.40-14
python-2.2.2-7
mod_python-3.0.1-1

Happy Holidays,
-tsy


Jim Thario wrote:
> Hi. I recently stared working with mod_python. I am using the stock Red
> Hat 8.0 installation which includes:
> 
> httpd-2.0.40-11
> python-2.2.1-17
> mod_python-3.0.0-10
> 
> I am having trouble with the example from "3.4 Now something More
> Complicated - Authentication". My configuration in httpd.conf looks like:
> 
> <Directory /var/www/html/python>
>         AddHandler python-program .py
>         PythonHandler myscript
>         PythonAuthenHandler myscript
>         PythonDebug On
>         AuthType Basic
>         AuthName "Restricted Area"
>         require valid-user
> </Directory>
> 
> After getting prompted for the user and password, I get a "Server error!"
> page and an entry in the /var/log/httpd/error_log:
> 
> "configuration error:  couldn't check user.  No user file?: /python"
> 
> Apache seems to want an AuthUserFile in there to read. The best I can
> guess is there is a problem with the version of mod_python shipped with
> Red Hat 8.0.
> 
> Any ideas?
> 
> Thanks in advance,
> Jim
> 


From jim at thario.net  Thu Dec 26 16:43:27 2002
From: jim at thario.net (Jim Thario)
Date: Fri Jan  9 22:03:39 2004
Subject: [mod_python] Problems with PythonAuthenHandler on Red Hat 8.0?
In-Reply-To: <3E0B7B24.30505@webtech360.com>
References: <33470.63.227.22.21.1040620629.squirrel@webmail.thario.com>
        <3E0B7B24.30505@webtech360.com>
Message-ID: <32892.63.227.22.21.1040946207.squirrel@webmail.thario.com>

Thanks for taking time to reproduce this. I am going to open a bug against
Red Hat 8.0 and see what they are willing to do.

Thanks,
Jim


T.-S. Yang said:
> Jim,
>
> I'm able to reproduce the error that you described using RedHat 8. The
> problem is fixed under ReHat 8.0.92 (Phoebe).
>
> I don't know the cause of the problem. The related packages in Phoebe
> are
>
> httpd-2.0.40-14
> python-2.2.2-7
> mod_python-3.0.1-1
>
> Happy Holidays,
> -tsy
>
>
> Jim Thario wrote:
>> Hi. I recently stared working with mod_python. I am using the stock
>> Red Hat 8.0 installation which includes:
>>
>> httpd-2.0.40-11
>> python-2.2.1-17
>> mod_python-3.0.0-10
>>
>> I am having trouble with the example from "3.4 Now something More
>> Complicated - Authentication". My configuration in httpd.conf looks
>> like:
>>
>> <Directory /var/www/html/python>
>>         AddHandler python-program .py
>>         PythonHandler myscript
>>         PythonAuthenHandler myscript
>>         PythonDebug On
>>         AuthType Basic
>>         AuthName "Restricted Area"
>>         require valid-user
>> </Directory>
>>
>> After getting prompted for the user and password, I get a "Server
>> error!" page and an entry in the /var/log/httpd/error_log:
>>
>> "configuration error:  couldn't check user.  No user file?: /python"
>>
>> Apache seems to want an AuthUserFile in there to read. The best I can
>> guess is there is a problem with the version of mod_python shipped
>> with Red Hat 8.0.
>>
>> Any ideas?
>>
>> Thanks in advance,
>> Jim
>>




From andy at nervebox.com  Fri Dec 27 00:16:36 2002
From: andy at nervebox.com (andy@nervebox.com)
Date: Fri Jan  9 22:03:39 2004
Subject: [mod_python] http 1.1 persistent connections
Message-ID: <7838526.1040976996296.JavaMail.SYSTEM@Obatala>

Hi all,
I'm new to Python and mod_python - and I'm having trouble finding out if mod_python supports  http1.1's persistent connections.  

I need to be able to have long-running scripts flush a single document - a little at a time, as it's generated - out through Apache to the client.  It might take a minute or an hour.  

Cold Fusion makes this dirt simple.  You can simply insert <cfflush> anywhere in your template and whatever data is generated thus far will be flushed out to Apache - which will hold the HTTP connection open until the template finishes executing.  It can be kept open for hours and makes a good sort of server push.

Can this be done with Python/mod_python?

 - thanks,
 - andy c
      
      
      
    

