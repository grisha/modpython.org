<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Child process init handler
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Child%20process%20init%20handler&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014902.html">
   <LINK REL="Next"  HREF="014895.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Child process init handler</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Michael C. Neel</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Child%20process%20init%20handler&In-Reply-To="
       TITLE="[mod_python] Child process init handler">neel at mediapulse.com
       </A><BR>
    <I>Tue Jan 27 17:28:26 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="014902.html">[mod_python] Child process init handler
</A></li>
        <LI>Next message: <A HREF="014895.html">[mod_python] running mod_python on Panther? 
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14903">[ date ]</a>
              <a href="thread.html#14903">[ thread ]</a>
              <a href="subject.html#14903">[ subject ]</a>
              <a href="author.html#14903">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>sorry, hit some crtl combo and my email was sent early... :/

Mod_perl is able is so this somehow:

'''
PerlChildInitHandler and PerlChildExitHandler do not refer to parts of
the request loop, they are to allow your modules to initialize data
structures and to clean up at the child process start-up and shutdown
respectively, for example by allocating and deallocating memory.

PerlInitHandler changes its behaviour depending upon where it is used.
In any case it is the first handler to be invoked in serving a request.
If found outside any &lt;Location&gt;, &lt;Directory&gt; or &lt;Files&gt; section (at the
top level), it is an alias for PerlPostReadRequestHandler. When inside
any such section it is an alias for PerlHeaderParserHandler.
'''

So I think this could be used in a virual host setting, and be able to
get options in that scope.  Though it's been a while since I mod_perl'd
anything...

My C is rusty, but they might be pulling this from some combo of the
Apache Api functions:

static void modulename_child_init(server_rec *s, pool *p);

and maybe something in 
static void *modulename_create_server_config(pool *p, server_rec *s);
static void *modulename_merge_server_config(pool *p, void *server1_conf,
void *server2_conf);

...at work right now, but when I get home I'll browse source and abuse
my apache home box with my unstable C code =)

Mike

&gt;<i> -----Original Message-----
</I>&gt;<i> From: Gregory (Grisha) Trubetskoy [mailto:<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">grisha at modpython.org</A>] 
</I>&gt;<i> Sent: Tuesday, January 27, 2004 4:09 PM
</I>&gt;<i> To: Michael C. Neel
</I>&gt;<i> Cc: <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> Subject: Re: [mod_python] Child process init handler
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Apache doesn't really lend itself to this kind of thinking. I've never
</I>&gt;<i> been able to clearly pinpoint what the problem is, but it 
</I>&gt;<i> basically has to
</I>&gt;<i> do with a lot of request parameters being generated on the 
</I>&gt;<i> fly as a result
</I>&gt;<i> of the combination of the particular's of the request and the apache
</I>&gt;<i> configuration directives applicable to that request (which too are
</I>&gt;<i> determined at runtime).
</I>&gt;<i> 
</I>&gt;<i> Or, to put it another way - Apache's approach is &quot;reactive&quot; 
</I>&gt;<i> rather than
</I>&gt;<i> &quot;proactive&quot;. When it parses its config it takes very little 
</I>&gt;<i> action on the
</I>&gt;<i> things it sees in it. Virtual servers just get piled into a 
</I>&gt;<i> hash list, and
</I>&gt;<i> only when a request for that particular server comes in is a 
</I>&gt;<i> meaningful
</I>&gt;<i> combination of a server and request object created. It's not like it
</I>&gt;<i> &quot;intializes&quot; virtual servers at any point during start up, so 
</I>&gt;<i> there is no
</I>&gt;<i> &quot;virtual server init&quot; hook.
</I>&gt;<i> 
</I>&gt;<i> In theory, when a child is spawned, mod_python could try to walk the
</I>&gt;<i> config and try to make sense of it and create and call some sort of a
</I>&gt;<i> per-server init hook, but that would more trouble than it's worth IMO.
</I>&gt;<i> 
</I>&gt;<i> Grisha
</I>&gt;<i> 
</I>&gt;<i> On Tue, 27 Jan 2004, Michael C. Neel wrote:
</I>&gt;<i> 
</I>&gt;<i> &gt; What I want to do:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; 	Run some initialization code when Apache spawns the child
</I>&gt;<i> &gt; process.  I do not want to call this handler for every 
</I>&gt;<i> request, but I do
</I>&gt;<i> &gt; want to have access to the configuration, specifically PythonOptions
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; In looking though the docs, I'm not sure PythonInitHandler 
</I>&gt;<i> works this
</I>&gt;<i> &gt; way, and PythonImport may not be able to access the PythonOption
</I>&gt;<i> &gt; directives.  Is there something I'm overlooking?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Mike
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Mod_python mailing list
</I>&gt;<i> &gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> &gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i> &gt;
</I>&gt;<i> 
</I>
</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014902.html">[mod_python] Child process init handler
</A></li>
	<LI>Next message: <A HREF="014895.html">[mod_python] running mod_python on Panther? 
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14903">[ date ]</a>
              <a href="thread.html#14903">[ thread ]</a>
              <a href="subject.html#14903">[ subject ]</a>
              <a href="author.html#14903">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
