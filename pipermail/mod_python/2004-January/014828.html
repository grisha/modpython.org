<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Re: Mod_python 3.1.2b, sethandler + dir listning
 problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Re%3A%20Mod_python%203.1.2b%2C%20sethandler%20%2B%20dir%20listning%0A%20problem&In-Reply-To=20031107100013.GB1233%40itea.ntnu.no">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014817.html">
   <LINK REL="Next"  HREF="014829.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Re: Mod_python 3.1.2b, sethandler + dir listning
 problem</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Gregory (Grisha) Trubetskoy</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Re%3A%20Mod_python%203.1.2b%2C%20sethandler%20%2B%20dir%20listning%0A%20problem&In-Reply-To=20031107100013.GB1233%40itea.ntnu.no"
       TITLE="[mod_python] Re: Mod_python 3.1.2b, sethandler + dir listning
 problem">grisha at modpython.org
       </A><BR>
    <I>Tue Jan 13 21:52:38 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="014817.html">[mod_python] mod_python-3.0.4 available at Python-Hosting.com
</A></li>
        <LI>Next message: <A HREF="014829.html">[mod_python] Session instances can't be stored in req?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14828">[ date ]</a>
              <a href="thread.html#14828">[ thread ]</a>
              <a href="subject.html#14828">[ subject ]</a>
              <a href="author.html#14828">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Sorry for a late response, but this behaviour is (was - fixed in CVS) a
bug. The error message in the log should only show up (and only makes
sense) when you return OK, meaning the user has been authenticated, but
req.user has no value. The bug was that it didn't check for return value,
but always threw an error whenver req.user had no value.

P.S. You have a potential problem lurking in the code below. req.user is
initially None, so instead of:

  if user != &quot;&quot;:

use

  if user:

because None is not equal to &quot;&quot; as far as Python is concerned.

Grisha

On Fri, 7 Nov 2003, Stian [iso-8859-1] S?iland wrote:

&gt;<i> We've found out with 3.1.2b that the AuthenHandler-thingie is not fully
</I>&gt;<i> functional.
</I>&gt;<i>
</I>&gt;<i> We tried the simple example from the documentations, and even made it
</I>&gt;<i> simpler:
</I>&gt;<i>
</I>&gt;<i> .htaccess
</I>&gt;<i> ---------
</I>&gt;<i> PythonPath &quot;['/our/libs'] + sys.path&quot;
</I>&gt;<i> PythonAuthenHandler Cerebrum.web.login
</I>&gt;<i> AuthType Basic
</I>&gt;<i> AuthName &quot;Cerebrum&quot;
</I>&gt;<i> require valid-user
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Cerebrum/web/login.py
</I>&gt;<i> ---------------------
</I>&gt;<i> from mod_python import apache
</I>&gt;<i>
</I>&gt;<i> def authenhandler(req):
</I>&gt;<i>     pw = req.get_basic_auth_pw()
</I>&gt;<i>     user = req.user
</I>&gt;<i>     if user != &quot;&quot;:
</I>&gt;<i>         return apache.OK
</I>&gt;<i>     return apache.HTTP_UNAUTHORIZED
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> This failed with a 500 Server Error. Watching the apache log reveals a
</I>&gt;<i> hint:
</I>&gt;<i>
</I>&gt;<i> [Fri Nov 07 10:49:42 2003] [error] [client 129.241.56.39]
</I>&gt;<i> python_handler: After PythonAuthenHandler req-&gt;user is NULL. Assign
</I>&gt;<i> req.user to avoid this error.
</I>&gt;<i>
</I></PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014817.html">[mod_python] mod_python-3.0.4 available at Python-Hosting.com
</A></li>
	<LI>Next message: <A HREF="014829.html">[mod_python] Session instances can't be stored in req?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14828">[ date ]</a>
              <a href="thread.html#14828">[ thread ]</a>
              <a href="subject.html#14828">[ subject ]</a>
              <a href="author.html#14828">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
