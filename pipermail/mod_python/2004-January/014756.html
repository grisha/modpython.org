<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] RE: Session handling: example needed
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20RE%3A%20Session%20handling%3A%20example%20needed&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014766.html">
   <LINK REL="Next"  HREF="014759.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] RE: Session handling: example needed</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Christoph Spoerri</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20RE%3A%20Session%20handling%3A%20example%20needed&In-Reply-To="
       TITLE="[mod_python] RE: Session handling: example needed">spoerri at duke.edu
       </A><BR>
    <I>Thu Jan  8 10:33:40 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="014766.html">[mod_python] mod_python and SMP
</A></li>
        <LI>Next message: <A HREF="014759.html">[mod_python] Re: mysqldb / mod_python problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14756">[ date ]</a>
              <a href="thread.html#14756">[ thread ]</a>
              <a href="subject.html#14756">[ subject ]</a>
              <a href="author.html#14756">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi list users,

I saw that recently somebody added for an example of using the session 
handler. I was looking for the same with out any luck, but was able to get 
things working (love the trial-and-error stuff ;) ).

I have attached a short script that uses two counters (int and object) to 
count the number of visits by the users during a session.

Notes:
- use is_new() to check if you have a new session or not before you use it (as 
mentioned in the manual)
- you need to save the session object at the end otherwise, the ID and any 
other stuff won't be saved (!), and you'll be wondering what happend to the 
session (as I did).

cheers,
Christoph

PS: I'm new to python, so forgive me any strange python coding.

***************** session_sample.py ***********************

from mod_python import apache

class simpelCountClass:
	count = 0
	def __init__(self,c):
		self.count = c
	def increment(self):
		self.count = self.count+1
	def asString(self):
		return str(self.count)


def sessionTest(req):
	req.content_type = &quot;text/html&quot;
	s = &quot;&lt;html&gt;&lt;body&gt;testing&lt;br&gt;&quot;

	t = Session.DbmSession(req)
	if (t.is_new()):
		s += &quot;new session id: &quot;+str(t.id())+&quot;&lt;br&gt;&quot;
		t['count']=1
		t['countObj']=simpelCountClass(1)

	else:
		s += &quot;session id: &quot;+str(t.id())+&quot;&lt;br&gt;&quot;
		t['count']=t['count']+1
		t['countObj'].increment()

	s += &quot;count: &quot;+str(t['count'])+&quot;&lt;br&gt;&quot;
	s += &quot;countObj: &quot;+t['countObj'].asString()+&quot;&lt;br&gt;&quot;
	s += &quot;timeout: &quot;+str(t.timeout())+&quot;&lt;br&gt;&quot;
	s += &quot;created: &quot;+str(t.created())+&quot;&lt;br&gt;&quot;
	s += &quot;last_accessed: &quot;+str(t.last_accessed())+&quot;&lt;br&gt;&quot;
	s += &quot;&lt;/body&gt;&lt;/html&gt;&quot;
	t.save() # DON'T FORGET THIS ONE!!!
	return s

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014766.html">[mod_python] mod_python and SMP
</A></li>
	<LI>Next message: <A HREF="014759.html">[mod_python] Re: mysqldb / mod_python problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14756">[ date ]</a>
              <a href="thread.html#14756">[ thread ]</a>
              <a href="subject.html#14756">[ subject ]</a>
              <a href="author.html#14756">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
