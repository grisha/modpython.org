<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Startup Options
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Startup%20Options&In-Reply-To=5.2.1.1.2.20040114210126.03307008%40mail.pyxos.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014835.html">
   <LINK REL="Next"  HREF="014837.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Startup Options</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>David Fraser</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Startup%20Options&In-Reply-To=5.2.1.1.2.20040114210126.03307008%40mail.pyxos.com"
       TITLE="[mod_python] Startup Options">davidf at sjsoft.com
       </A><BR>
    <I>Thu Jan 15 07:48:04 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="014835.html">[mod_python] Startup Options
</A></li>
        <LI>Next message: <A HREF="014837.html">[mod_python] mod_python and apache configuration problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14836">[ date ]</a>
              <a href="thread.html#14836">[ thread ]</a>
              <a href="subject.html#14836">[ subject ]</a>
              <a href="author.html#14836">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Daniel West wrote:

&gt;<i>
</I>&gt;<i> mod_python's PythonImport is a neat feature; it allows you to run a 
</I>&gt;<i> script when an Apache process fires up.  However, it doesn't work 
</I>&gt;<i> under VirtualHosts, only the main server config (mod_python 3.0 and 
</I>&gt;<i> up).  I need to support multiple users all who have their own 
</I>&gt;<i> VirtualHosts and all whom need PythonImport to setup database 
</I>&gt;<i> connections under their VirtualHost's interpreter.  The startup 
</I>&gt;<i> scripts and handler code are naturally located under each users' home 
</I>&gt;<i> directory for privacy.
</I>&gt;<i>
</I>&gt;<i> My first attempt was simply to use PythonPath and PythonImport under 
</I>&gt;<i> each VirtualHost.  This is straight forward and simple.  Append to the 
</I>&gt;<i> path so that the Import can find the startup code in the home 
</I>&gt;<i> directory of each user and then issue the PythonImport for their 
</I>&gt;<i> startup script.  This doesn't work because PythonImport only works in 
</I>&gt;<i> the main server config.
</I>&gt;<i>
</I>&gt;<i> My second attempt was to use a generic loader with PythonImport 
</I>&gt;<i> (located in site-packages) and then use PythonOption to pass it the 
</I>&gt;<i> path and actual startup script for each interpreter (VirtualHost).  
</I>&gt;<i> This doesn't work because you can't access PythonOption variables 
</I>&gt;<i> until a request is made.
</I>&gt;<i>
</I>&gt;<i> My third thought was to setup individual scripts for each VirtualHost 
</I>&gt;<i> in the site-packages directory with the startup information for each 
</I>&gt;<i> user.  The problem here is that the startup scripts have to be owned 
</I>&gt;<i> by the user and not world readable (their database passwords are in 
</I>&gt;<i> there).  This causes a read problem for server processes run as the 
</I>&gt;<i> user nobody.
</I>&gt;<i>
</I>&gt;<i> I'm not sure how else to make this happen and it's very frustrating.  
</I>&gt;<i> I have all the elements I need, I just can't find a way to put them 
</I>&gt;<i> together to accomplish a seemingly simple task.
</I>&gt;<i>
</I>&gt;<i> It sure would be nice if PyhtonImport could be made to run under 
</I>&gt;<i> VirtualHosts.  Failing that, a way to get to a VirtualHost's 
</I>&gt;<i> PythonOptions would do.  Grisha?
</I>&gt;<i>
</I>&gt;<i> -Dan
</I>
You can always write some code that calculates the import needed for 
each request, and imports it. Then you can cache all the imports in some 
way but the reimporting should be painless anyway. That's what we do, 
depending on PythonOptions.

David

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014835.html">[mod_python] Startup Options
</A></li>
	<LI>Next message: <A HREF="014837.html">[mod_python] mod_python and apache configuration problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14836">[ date ]</a>
              <a href="thread.html#14836">[ thread ]</a>
              <a href="subject.html#14836">[ subject ]</a>
              <a href="author.html#14836">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
