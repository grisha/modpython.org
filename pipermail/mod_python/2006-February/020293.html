<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Re: reading mod_ssl variables from mod_python
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Re%3A%20reading%20mod_ssl%20variables%20from%20mod_python&In-Reply-To=1F698EA4-D2A6-440D-A01C-5066044DE0CB%40dscpl.com.au">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020290.html">
   <LINK REL="Next"  HREF="020291.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Re: reading mod_ssl variables from mod_python</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Deron Meranda</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Re%3A%20reading%20mod_ssl%20variables%20from%20mod_python&In-Reply-To=1F698EA4-D2A6-440D-A01C-5066044DE0CB%40dscpl.com.au"
       TITLE="[mod_python] Re: reading mod_ssl variables from mod_python">deron.meranda at gmail.com
       </A><BR>
    <I>Wed Feb 15 17:11:39 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="020290.html">[mod_python] Re: reading mod_ssl variables from mod_python
</A></li>
        <LI>Next message: <A HREF="020291.html">[mod_python] Re: One observation about the mod_ssl-mod_python
	problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20293">[ date ]</a>
              <a href="thread.html#20293">[ thread ]</a>
              <a href="subject.html#20293">[ subject ]</a>
              <a href="author.html#20293">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Tomasz,

I'm not sure what your _mp_mod_ssl module is (perhaps you said
off this list?).  I'm assuming it's a wrapper of sorts around my ssl
patches in MODPYTHON-94.

Please keep in mind though that if you're using my patch as it was
attached in issue <A HREF="http://issues.apache.org/jira/browse/MODPYTHON-94">http://issues.apache.org/jira/browse/MODPYTHON-94</A>
that we have since decided to rename the function ssl_var() to
be ssl_var_lookup() .   Just so you won't be surprised when it finally
makes it into a release.


&gt;<i> On 16/02/2006, at 6:10 AM, Tomasz Wlodek wrote:
</I>&gt;<i> &gt; def authenhandler(req):
</I>&gt;<i> &gt;     req.add_common_vars()
</I>&gt;<i> &gt;     name='SSL_CLIENT_S_DN'
</I>
Make sure that your apache mod_ssl SSLOptions directive has
the ExportCertData option enabled.

&gt;<i> &gt;     is_https = _mp_mod_ssl.is_https(req)
</I>&gt;<i> &gt;     if is_https!=1:
</I>
Drop the &quot;!=1&quot; part.  This may become a boolean True/False
at some point.

&gt;<i> &gt;         return apache.HTTP_FORBIDDEN
</I>&gt;<i> &gt;     else:
</I>&gt;<i> &gt;         lookup = _mp_mod_ssl.var_lookup(req,name)
</I>&gt;<i> &gt;         req.write(lookup)
</I>&gt;<i> &gt;         return apache.OK
</I>

&gt;<i> &gt; The problem is that the code does not seem to be stable: sometimes it
</I>&gt;<i> &gt; returns correctly my DN. Sometimes it fails on the lookup =
</I>&gt;<i> &gt; _mp_mod_ssl.var_lookup(req,name) line.
</I>
&gt;<i> &gt; [Wed Feb 15 14:00:13 2006] [error] (13)Permission denied: Cannot open
</I>&gt;<i> &gt; SSLSessionCache DBM file `/var/cache/mod_ssl/scache' for scanning
</I>
Hmm.  This apache error would seem to be somewhat important.
Can you try using a different SSL cache type (the mod_ssl
SSLSessionCache directive).

Also check on your SSLMutex option.  What you set it too may depend
on the type of apache MPM you're using.

Also you should try to determine why the permission denied errors
are occuring in the first place.  Are you perhaps running under
SELinux or something?

--
Deron Meranda

</PRE>




















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020290.html">[mod_python] Re: reading mod_ssl variables from mod_python
</A></li>
	<LI>Next message: <A HREF="020291.html">[mod_python] Re: One observation about the mod_ssl-mod_python
	problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20293">[ date ]</a>
              <a href="thread.html#20293">[ thread ]</a>
              <a href="subject.html#20293">[ subject ]</a>
              <a href="author.html#20293">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
