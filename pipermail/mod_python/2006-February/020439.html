<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Why Apache does not execute cgi scripts
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Why%20Apache%20does%20not%20execute%20cgi%20scripts&In-Reply-To=Pine.GSO.4.58.0602241639420.24884%40rcf2.rhic.bnl.gov">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020433.html">
   <LINK REL="Next"  HREF="020200.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Why Apache does not execute cgi scripts</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Why%20Apache%20does%20not%20execute%20cgi%20scripts&In-Reply-To=Pine.GSO.4.58.0602241639420.24884%40rcf2.rhic.bnl.gov"
       TITLE="[mod_python] Why Apache does not execute cgi scripts">grahamd at dscpl.com.au
       </A><BR>
    <I>Sat Feb 25 01:07:47 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="020433.html">[mod_python] Why Apache does not execute cgi scripts
</A></li>
        <LI>Next message: <A HREF="020200.html">[mod_python] Trouble compiling mod_python
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20439">[ date ]</a>
              <a href="thread.html#20439">[ thread ]</a>
              <a href="subject.html#20439">[ subject ]</a>
              <a href="author.html#20439">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I don't know why, but if you define Require directive, but don't  
define AuthType
and authenhandler returns apache.OK, it doesn't work. Also, it skips  
the type
checker and fixup handler phases as well, going direct to the  
response handler
phase.

To at least get it working, include:

   AuthType Dummy

This sort of strange behaviour probably confirms my thinking that  
authenhandler
support in mod_python was incomplete and why I have added changes as
described in:

   <A HREF="http://issues.apache.org/jira/browse/MODPYTHON-124">http://issues.apache.org/jira/browse/MODPYTHON-124</A>

for mod_python 3.3. One can't make short cuts when writing  
authenhandlers, they
need to be done properly or weird things like this could well happen.

Graham

On 25/02/2006, at 8:41 AM, Tomasz Wlodek wrote:

&gt;<i> Ok, one detai, which I discovered by trial and error:
</I>&gt;<i>
</I>&gt;<i> If I remove the line
</I>&gt;<i>
</I>&gt;<i> require valid-user
</I>&gt;<i>
</I>&gt;<i> then Apache allows me to execute the cgi scripts.
</I>&gt;<i>
</I>&gt;<i> If I leave it then it displays them as text.
</I>&gt;<i>
</I>&gt;<i> Does anyone understand this behavior?
</I>&gt;<i>
</I>&gt;<i> Tomasz Wlodek                        | tel 631-344-7448
</I>&gt;<i> Brookhaven Laboratory, Building 510M | fax 631-344-7616
</I>&gt;<i> Upton NY 11973-5000                  |
</I>&gt;<i>
</I>&gt;<i> On Fri, 24 Feb 2006, Tomasz Wlodek wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Hello experts,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I am not sure whether this issue belongs to Apache proper or mod  
</I>&gt;&gt;<i> python or
</I>&gt;&gt;<i> both.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> here is the problem: I use mod_python authentication handler to
</I>&gt;&gt;<i> authenticate users who come to some directory. This part of the  
</I>&gt;&gt;<i> code works
</I>&gt;&gt;<i> fine.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> After the user is authenticated mod_python returns apache.OK and then
</I>&gt;&gt;<i> Apache is supposed to execute cgi script which is located in this
</I>&gt;&gt;<i> directory. For the time being the cgi script is a simple &quot;Hello  
</I>&gt;&gt;<i> world&quot; in
</I>&gt;&gt;<i> python.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Now comes the problem: users are authenticated, then Apache takes  
</I>&gt;&gt;<i> the cgi
</I>&gt;&gt;<i> script but instead of executing it it displays its content as text  
</I>&gt;&gt;<i> file.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The funny thing is that the same cgi script when I move it to  
</I>&gt;&gt;<i> another cgi
</I>&gt;&gt;<i> directory (where I do not use mod_python for authentication) works  
</I>&gt;&gt;<i> fine.
</I>&gt;&gt;<i> It executes as cgi script.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Apparently when I protect a directory by mod_python authentication  
</I>&gt;&gt;<i> handler
</I>&gt;&gt;<i> then Apache does not want to execute underlying cgi scripts from this
</I>&gt;&gt;<i> directory!
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Here comes the configuration file for this directory:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Alias /GridHyperNews &quot;/var/www/cgi-bin/GridHyperNews&quot;
</I>&gt;&gt;<i>     &lt;Directory /var/www/cgi-bin/GridHyperNews&gt;
</I>&gt;&gt;<i> 	AllowOverride None
</I>&gt;&gt;<i> 	#I want the directory to contain cgi scripts
</I>&gt;&gt;<i>         Options +ExecCGI
</I>&gt;&gt;<i> 	SetHandler cgi-script
</I>&gt;&gt;<i> 	# users who come to this directory must be authenticated by
</I>&gt;&gt;<i> 	# myhandler2
</I>&gt;&gt;<i> 	PythonAuthenHandler myhandler2
</I>&gt;&gt;<i> 	PythonDebug on
</I>&gt;&gt;<i> 	PythonPath &quot;sys.path + ['/root/mod_python_handlers']&quot;
</I>&gt;&gt;<i> 	require valid-user
</I>&gt;&gt;<i>     &lt;/Directory&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The myhandler2.py code is very simple
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> from mod_python import apache
</I>&gt;&gt;<i> from mod_python import util
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> import _mp_mod_ssl
</I>&gt;&gt;<i> import os,string
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> def authenhandler(req):
</I>&gt;&gt;<i>     req.add_common_vars()
</I>&gt;&gt;<i>     req.user=&quot;unknown_user&quot;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     return apache.OK
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Now, no matter what I do scripts under the directory
</I>&gt;&gt;<i> /var/www/cgi-bin/GridHyperNews are not treated by Apache as cgi  
</I>&gt;&gt;<i> but as
</I>&gt;&gt;<i> text files.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Tomasz Wlodek                        | tel 631-344-7448
</I>&gt;&gt;<i> Brookhaven Laboratory, Building 510M | fax 631-344-7616
</I>&gt;&gt;<i> Upton NY 11973-5000                  |
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Mod_python mailing list
</I>&gt;&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020433.html">[mod_python] Why Apache does not execute cgi scripts
</A></li>
	<LI>Next message: <A HREF="020200.html">[mod_python] Trouble compiling mod_python
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20439">[ date ]</a>
              <a href="thread.html#20439">[ thread ]</a>
              <a href="subject.html#20439">[ subject ]</a>
              <a href="author.html#20439">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
