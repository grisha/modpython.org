<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] PSP TypeError: cannot concatenate 'str' and 
	'instance' objects
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20PSP%20TypeError%3A%20cannot%20concatenate%20%27str%27%20and%20%0A%09%27instance%27%20objects&In-Reply-To=65D86267-0357-4616-BF9D-C6648D7663EE%40dscpl.com.au">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020337.html">
   <LINK REL="Next"  HREF="020338.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] PSP TypeError: cannot concatenate 'str' and 
	'instance' objects</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Corey McGuire</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20PSP%20TypeError%3A%20cannot%20concatenate%20%27str%27%20and%20%0A%09%27instance%27%20objects&In-Reply-To=65D86267-0357-4616-BF9D-C6648D7663EE%40dscpl.com.au"
       TITLE="[mod_python] PSP TypeError: cannot concatenate 'str' and 
	'instance' objects">coreyfro at coreyfro.com
       </A><BR>
    <I>Fri Feb 17 11:24:31 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="020337.html">[mod_python] PSP TypeError: cannot concatenate 'str' and
	'instance' objects
</A></li>
        <LI>Next message: <A HREF="020338.html">[mod_python] Questions about PSP vs other solutions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20343">[ date ]</a>
              <a href="thread.html#20343">[ thread ]</a>
              <a href="subject.html#20343">[ subject ]</a>
              <a href="author.html#20343">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Ahhhh, ok.  I think I miss understood how PSP worked.  I was thinking one
had to process everything first, and THEN inject it in to a template.  I
didn't realize it could be assembled on the fly.

OK, thanks!

&gt;<i> The PSP class always writes it output direct to the request object
</I>&gt;<i> and it
</I>&gt;<i> is not available as a string without doing some trickery. Even if using
</I>&gt;<i> publisher, you can do something like:
</I>&gt;<i>
</I>&gt;<i>      req.content_type            = 'text/html'
</I>&gt;<i>      gallery_tmpl                = psp.PSP(req, filename='gallery.tmpl')
</I>&gt;<i>      req.write(&quot;some HTML prologue&quot;)
</I>&gt;<i>      gallery_tmpl.run(vars       = { 'title': title, 'caption':
</I>&gt;<i> caption, 'body': body  })
</I>&gt;<i>      req.write(&quot;some HTML epilogue&quot;)
</I>&gt;<i>
</I>&gt;<i> Ie., don't try and concatenate anything as strings, just write the
</I>&gt;<i> bits out
</I>&gt;<i> in sequence.
</I>&gt;<i>
</I>&gt;<i> If you really need to capture the PSP output in a string have a read of:
</I>&gt;<i>
</I>&gt;<i>    <A HREF="http://www.modpython.org/pipermail/mod_python/2005-June/018231.html">http://www.modpython.org/pipermail/mod_python/2005-June/018231.html</A>
</I>&gt;<i>
</I>&gt;<i> Graham
</I>&gt;<i>
</I>&gt;<i> On 17/02/2006, at 8:39 PM, Corey McGuire wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Hello all,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I am learning python and PSP at the same time, which may be a bit of a
</I>&gt;&gt;<i> mistake, but I think I am doing well.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I am working on moving my PHP image gallery:
</I>&gt;&gt;<i> <A HREF="http://www.coreyfro.com/~coreyfro/gallery.php?gallery=b-man-2003">http://www.coreyfro.com/~coreyfro/gallery.php?gallery=b-man-2003</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> To python:
</I>&gt;&gt;<i> <A HREF="http://127.0.0.1/~coreyfro/gallery/gallery">http://127.0.0.1/~coreyfro/gallery/gallery</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> This is really just an exercise, but it's kinda my own version of
</I>&gt;&gt;<i> &quot;Hello
</I>&gt;&gt;<i> World&quot;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I am getting hung up ok this block of code:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> cell_tmpl = psp.PSP(req, filename='cell.tmpl', vars = {'gallery':
</I>&gt;&gt;<i> gallery,
</I>&gt;&gt;<i> 'i': i, 'path': path, 'file': dirList[i], 'caption': caption})
</I>&gt;&gt;<i> body = body + cell_tmpl
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Now, the kicker is &quot;body = body + cell_tmpl&quot;... If I leave it like
</I>&gt;&gt;<i> that, I
</I>&gt;&gt;<i> get the following
</I>&gt;&gt;<i> <A HREF="http://127.0.0.1/~coreyfro/frozen/gallery1/gallery/?gallery=b-man-2003">http://127.0.0.1/~coreyfro/frozen/gallery1/gallery/?gallery=b-man-2003</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> If I try converting it to a string (like &quot;body = body + str
</I>&gt;&gt;<i> (cell_tmpl)&quot;)
</I>&gt;&gt;<i> something TOTALY wacky happens
</I>&gt;&gt;<i> <A HREF="http://127.0.0.1/~coreyfro/frozen/gallery2/gallery/?gallery=b-man-2003">http://127.0.0.1/~coreyfro/frozen/gallery2/gallery/?gallery=b-man-2003</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> It's outputting the HTML I am trying to append to body and NOT
</I>&gt;&gt;<i> concatinating it with body.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> How do I put two and two together?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Here's the code in full
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> from mod_python import psp
</I>&gt;&gt;<i> import os
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> def report(req, title, caption, body):
</I>&gt;&gt;<i>     req.content_type            = 'text/html'
</I>&gt;&gt;<i>     gallery_tmpl                = psp.PSP(req,
</I>&gt;&gt;<i> filename='gallery.tmpl')
</I>&gt;&gt;<i>     gallery_tmpl.run(vars       = { 'title': title, 'caption':
</I>&gt;&gt;<i> caption,
</I>&gt;&gt;<i> 'body': body  })
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> def index(req):
</I>&gt;&gt;<i>     title                       = &quot;Coreyfro's Handy, Dandy, Super-
</I>&gt;&gt;<i> duper,
</I>&gt;&gt;<i> Gallery Engine!&quot;
</I>&gt;&gt;<i>     caption                     = &quot;It's free, it's fast, it's
</I>&gt;&gt;<i> incomplete!&quot;
</I>&gt;&gt;<i>     body                        = &quot;You are probably here by
</I>&gt;&gt;<i> mistake&lt;br&gt;\
</I>&gt;&gt;<i>                                    Please feel free to be
</I>&gt;&gt;<i> confused&lt;br&gt;\
</I>&gt;&gt;<i>                                    I know I am&quot;
</I>&gt;&gt;<i>     report(req, title, caption, body)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> def gallery(req, gallery='', columns=''):
</I>&gt;&gt;<i>     if columns:
</I>&gt;&gt;<i>         columns                 = int(columns)
</I>&gt;&gt;<i>     else:
</I>&gt;&gt;<i>         columns                 = 5
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     if gallery:
</I>&gt;&gt;<i>         i                       = 0
</I>&gt;&gt;<i>         column                  = 1
</I>&gt;&gt;<i>         title                   = gallery
</I>&gt;&gt;<i>         caption                 = &quot;Click on an image below to see it's
</I>&gt;&gt;<i> full sized version&quot;
</I>&gt;&gt;<i>         path                    = &quot;/home/coreyfro/public_html/gallery&quot;
</I>&gt;&gt;<i>         dirList                 = os.listdir(path+&quot;/&quot;+gallery+&quot;/ds&quot;)
</I>&gt;&gt;<i>         body                    = &quot; &quot; * 6 + &quot;&lt;table&gt;\n&quot; + &quot; &quot; * 8 +
</I>&gt;&gt;<i> &quot;&lt;tr&gt;\n&quot;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         while i &lt; len(dirList):
</I>&gt;&gt;<i>             if column &lt; columns:
</I>&gt;&gt;<i>                 column          = column + 1
</I>&gt;&gt;<i>             else:
</I>&gt;&gt;<i>                 column          = 1
</I>&gt;&gt;<i>                 body            = body + &quot; &quot; * 8 + &quot;&lt;/tr&gt;\n&quot; + &quot; &quot;
</I>&gt;&gt;<i> * 8 +
</I>&gt;&gt;<i> &quot;&lt;tr&gt;\n&quot;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>             cell_tmpl           = psp.PSP(req,
</I>&gt;&gt;<i> filename='cell.tmpl', vars
</I>&gt;&gt;<i> = {'gallery': gallery, 'i': i, 'path': path, 'file':
</I>&gt;&gt;<i> dirList[i], 'caption': caption})
</I>&gt;&gt;<i>             body                = body + cell_tmpl
</I>&gt;&gt;<i>             i                   = i + 1
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         body                    = body + &quot; &quot; * 8 + &quot;&lt;/tr&gt;\n&quot; + &quot; &quot;
</I>&gt;&gt;<i> * 6 +
</I>&gt;&gt;<i> &quot;&lt;/table&gt;&quot;
</I>&gt;&gt;<i>         report(req, title, caption, body)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     else:
</I>&gt;&gt;<i>         index(req)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> def view(req, gallery, index):
</I>&gt;&gt;<i>     pass
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Mod_python mailing list
</I>&gt;&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i>
</I>

</PRE>













<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020337.html">[mod_python] PSP TypeError: cannot concatenate 'str' and
	'instance' objects
</A></li>
	<LI>Next message: <A HREF="020338.html">[mod_python] Questions about PSP vs other solutions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20343">[ date ]</a>
              <a href="thread.html#20343">[ thread ]</a>
              <a href="subject.html#20343">[ subject ]</a>
              <a href="author.html#20343">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
