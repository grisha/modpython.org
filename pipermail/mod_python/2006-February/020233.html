<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Re: forks, daemons and other beasts
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Re%3A%20forks%2C%20daemons%20and%20other%20beasts&In-Reply-To=5f56302b0602111458h3a6f7355v9eb5daa9b6a76d1d%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020232.html">
   <LINK REL="Next"  HREF="020234.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Re: forks, daemons and other beasts</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Re%3A%20forks%2C%20daemons%20and%20other%20beasts&In-Reply-To=5f56302b0602111458h3a6f7355v9eb5daa9b6a76d1d%40mail.gmail.com"
       TITLE="[mod_python] Re: forks, daemons and other beasts">grahamd at dscpl.com.au
       </A><BR>
    <I>Sat Feb 11 18:08:23 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="020232.html">[mod_python] Re: forks, daemons and other beasts
</A></li>
        <LI>Next message: <A HREF="020234.html">[mod_python] Re: forks, daemons and other beasts
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20233">[ date ]</a>
              <a href="thread.html#20233">[ thread ]</a>
              <a href="subject.html#20233">[ subject ]</a>
              <a href="author.html#20233">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On 12/02/2006, at 9:58 AM, Daniel Nogradi wrote:

&gt;&gt;&gt;&gt;&gt;<i> Anyway, I have the feeling that there must be a more sane and
</I>&gt;&gt;&gt;&gt;&gt;<i> probably
</I>&gt;&gt;&gt;&gt;&gt;<i> safe way of achieving what I would like by a much simpler method.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Any ideas?
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> A quick one.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Run a small separate daemon process which embeds an  XML-RPC
</I>&gt;&gt;&gt;&gt;<i> server and have your web pages use XML-RPC to call that daemon
</I>&gt;&gt;&gt;&gt;<i> process to trigger off the task. The daemon process can still fork
</I>&gt;&gt;&gt;&gt;<i> exec
</I>&gt;&gt;&gt;&gt;<i> as necessary.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> This way you eliminate a fork in Apache child process which may be
</I>&gt;&gt;&gt;&gt;<i> problematic because of the socket connections etc that are  
</I>&gt;&gt;&gt;&gt;<i> inherited.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Well, that still looks like to me that I'm shooting a bird with a
</I>&gt;&gt;&gt;<i> cannon. The reason is that I need to do something really simple:  
</I>&gt;&gt;&gt;<i> users
</I>&gt;&gt;&gt;<i> upload a zip file (remember my questions about the zipfile  
</I>&gt;&gt;&gt;<i> module? :))
</I>&gt;&gt;&gt;<i> and should get an acknowledgement that the upload was successful.  
</I>&gt;&gt;&gt;<i> The
</I>&gt;&gt;&gt;<i> server should start unpacking the archive, check if the files are  
</I>&gt;&gt;&gt;<i> okay
</I>&gt;&gt;&gt;<i> and move them to a directory. All of this can take quite long, so  
</I>&gt;&gt;&gt;<i> the
</I>&gt;&gt;&gt;<i> acknowledgement should be sent before this unpacking/checking/moving
</I>&gt;&gt;&gt;<i> finishes.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The suggestion I gave wouldn't preclude an acknowledgement being
</I>&gt;&gt;<i> sent before the unpacking begins.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Have you simply considered using a separate thread to do the  
</I>&gt;&gt;<i> unpacking?
</I>&gt;<i>
</I>&gt;<i> Hmmmmm, what do you mean exactly? When I do an os.fork the whole
</I>&gt;<i> apache forks, you mean that I should start a brand new thread, outside
</I>&gt;<i> of apache?
</I>
Using threads you wouldn't need to do an os.fork(). Simply create a  
new thread
using the Python &quot;threading&quot; module inside the Apache process to do the
unpacking. You probably just need to detach the thread so it finishes  
up properly
and doesn't need another thread to wait on it to finish.

Sorry, can't give an example right now as trying to rebuild OS on one  
of my
machines.

Graham
</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020232.html">[mod_python] Re: forks, daemons and other beasts
</A></li>
	<LI>Next message: <A HREF="020234.html">[mod_python] Re: forks, daemons and other beasts
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20233">[ date ]</a>
              <a href="thread.html#20233">[ thread ]</a>
              <a href="subject.html#20233">[ subject ]</a>
              <a href="author.html#20233">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
