<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] SQL question
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20SQL%20question&In-Reply-To=000601c62749%247ce276b0%24f8dbebc9%40luis">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020175.html">
   <LINK REL="Next"  HREF="020176.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] SQL question</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Mike Looijmans</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20SQL%20question&In-Reply-To=000601c62749%247ce276b0%24f8dbebc9%40luis"
       TITLE="[mod_python] SQL question">nlv11281 at natlab.research.philips.com
       </A><BR>
    <I>Thu Feb  2 03:30:27 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="020175.html">[mod_python] SQL question
</A></li>
        <LI>Next message: <A HREF="020176.html">[mod_python] SQL question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20184">[ date ]</a>
              <a href="thread.html#20184">[ thread ]</a>
              <a href="subject.html#20184">[ subject ]</a>
              <a href="author.html#20184">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> The script assumes that the first field of each table is a primary key, 
</I>&gt;<i> and this is necessary for performing updates on the table.
</I>&gt;<i> In those cases where the tables don't have a primary key, or when the 
</I>&gt;<i> primary key is composed of two fields, the update cannot be performed 
</I>&gt;<i> correctly.
</I>
Another solution is to use an update-where-all scheme (like Delphi uses 
for some table queries). This also helps detect race conditions (other 
people editing the same records) as a side effect. (unrelated to your 
question: I typically use the update-where-changed system so that 
concurrent edits are possible as long as they do not touch the same 
entries. It also gives you the opportunity to present the changes 
someone else made, and have the user decide on how to merge them.)

So if you have a row where &quot;SELECT * FROM customer&quot; returns (51, &quot;Mike&quot;, 
&quot;MiLo Software&quot;), and the user edits &quot;Mike&quot; into &quot;Graham&quot;, the query to 
be run in update-where-all mode is:

c.execute(&quot;UPDATE customer SET owner=%s WHERE customer_id=%s AND 
owner=%s AND name=%s&quot;, (&quot;Graham&quot;, 51, &quot;Mike&quot;, &quot;MiLo Software&quot;))

This will work regardless of the DBMS used, and whether the table has a 
primary key at all (rows should still be unique though...)

Mike.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020175.html">[mod_python] SQL question
</A></li>
	<LI>Next message: <A HREF="020176.html">[mod_python] SQL question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20184">[ date ]</a>
              <a href="thread.html#20184">[ thread ]</a>
              <a href="subject.html#20184">[ subject ]</a>
              <a href="author.html#20184">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
