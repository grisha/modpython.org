<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Re: forks, daemons and other beasts
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Re%3A%20forks%2C%20daemons%20and%20other%20beasts&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020240.html">
   <LINK REL="Next"  HREF="020238.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Re: forks, daemons and other beasts</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Robert Brewer</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Re%3A%20forks%2C%20daemons%20and%20other%20beasts&In-Reply-To="
       TITLE="[mod_python] Re: forks, daemons and other beasts">fumanchu at amor.org
       </A><BR>
    <I>Sat Feb 11 19:48:25 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="020240.html">[mod_python] Re: forks, daemons and other beasts
</A></li>
        <LI>Next message: <A HREF="020238.html">[mod_python] Re: forks, daemons and other beasts
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20236">[ date ]</a>
              <a href="thread.html#20236">[ thread ]</a>
              <a href="subject.html#20236">[ subject ]</a>
              <a href="author.html#20236">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Daniel Nogradi wrote:
&gt;<i> users upload a zip file and should get an acknowledgement
</I>&gt;<i> that the upload was successful. The server should start
</I>&gt;<i> unpacking the archive, check if the files are okay and
</I>&gt;<i> move them to a directory. All of this can take quite long,
</I>&gt;<i> so the acknowledgement should be sent before this
</I>&gt;<i> unpacking/checking/moving finishes.
</I>
and Graham Dumpleton replied:
&gt;<i> The suggestion I gave wouldn't preclude an acknowledgement
</I>&gt;<i> being sent before the unpacking begins.
</I>&gt;<i> 
</I>&gt;<i> Have you simply considered using a separate thread to do the
</I>&gt;<i> unpacking?
</I>&gt;<i> ...
</I>&gt;<i> Using threads you wouldn't need to do an os.fork(). Simply
</I>&gt;<i> create a new thread using the Python &quot;threading&quot; module
</I>&gt;<i> inside the Apache process to do the unpacking. You probably
</I>&gt;<i> just need to detach the thread so it finishes up properly
</I>&gt;<i> and doesn't need another thread to wait on it to finish.
</I>
If you're using a multi-threaded MPM, you might not even want to detach it. It can be useful to let Apache return a &quot;server unavailable&quot; (503) response if all of your threads are busy unzipping files. If you're using a multi-process MPM, you might just do it in the same process to achieve the same effect.

The thread or process won't die just because the client closes the connection. Right away, I'd give them the option: &quot;Thanks for the file! It's being unzipped and processed now. You can trust me and close your browser, or wait for a final confirmation message when I'm done.&quot; Then, when the long process is done, write out the &quot;final confirmation message&quot; whether they're connected or not--Apache won't choke on that if they've left.


Robert Brewer
System Architect
Amor Ministries
<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">fumanchu at amor.org</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20060211/bbd7289d/attachment.html">http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20060211/bbd7289d/attachment.html</A>
</PRE>














<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020240.html">[mod_python] Re: forks, daemons and other beasts
</A></li>
	<LI>Next message: <A HREF="020238.html">[mod_python] Re: forks, daemons and other beasts
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20236">[ date ]</a>
              <a href="thread.html#20236">[ thread ]</a>
              <a href="subject.html#20236">[ subject ]</a>
              <a href="author.html#20236">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
