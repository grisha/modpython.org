<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Problem with PSP and unicode
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Problem%20with%20PSP%20and%20unicode&In-Reply-To=c298f2d70602161231k7905e2c5i%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020316.html">
   <LINK REL="Next"  HREF="020314.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Problem with PSP and unicode</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Dan Eloff</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Problem%20with%20PSP%20and%20unicode&In-Reply-To=c298f2d70602161231k7905e2c5i%40mail.gmail.com"
       TITLE="[mod_python] Problem with PSP and unicode">dan.eloff at gmail.com
       </A><BR>
    <I>Thu Feb 16 17:34:09 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="020316.html">[mod_python] Problem with PSP and unicode
</A></li>
        <LI>Next message: <A HREF="020314.html">[mod_python] Problem with PSP and unicode
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20323">[ date ]</a>
              <a href="thread.html#20323">[ thread ]</a>
              <a href="subject.html#20323">[ subject ]</a>
              <a href="author.html#20323">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&quot;I know they are limited on purpose, but I can't bear to be
forced to jump through hoops to please a development philosophy that
mostly gets in the way IMHO.&quot;

Exactly. Leave purism to the pursits. For the rest of us there's work to be
done. There's no one way to do everthing that will work for everybody, go
with what works.

I keep code specific to display, formatting, or html in the psp templates. I
leave back-end logic in the backend, I find it's easier to maintain that
way. But I expect the full power of python for both tasks, and I'm loathe to
use some seperate third-party template language that holds me back. PSP was
convienient because it allowed pure python statements in my templates, but
now I'm thinking it's holding me back, I want to personalize it a little,
like add some shortcut tags to simplify common tasks where python is too
verbose.

for example two things I use a lot are:

&lt;%=vars['varname']%&gt; and &lt;%=lang['category']['phrase']%&gt;

why not &lt;$varname$&gt; or &lt;@category phrase@&gt;

Asside from being shorter and easier to read, this would give a second
benefit, I could pre-compile (cache) the templates in each language instead
of doing it at execution time. Just thinking out loud.

I'm of the opinion that psp is not tied to mod_python, nor does it have
anything to do with mod_python. It should be a seperate entity and
maintained by those who use it. Just like there's no reason for mod_python
developers to have a cheetah module and have to maintain that.

-Dan

On 2/16/06, Nicolas Lehuen &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">nicolas at lehuen.com</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> Well, in fact, I'm not using PSP, but my own templating system. The
</I>&gt;<i> whole code is around 500 lines of pure Python. It uses a regular
</I>&gt;<i> expression based tokenizer, a recursive hand-written parser (the
</I>&gt;<i> grammar is simple enough), and the result of a template compilation is
</I>&gt;<i> an optimized (simplified) AST that is visited each time the template
</I>&gt;<i> needs to be evaluated (it is not Python code that gets compiled
</I>&gt;<i> afterwards, I don't feel the need to do so).
</I>&gt;<i>
</I>&gt;<i> The template markup are close to those used in the Velocity Java
</I>&gt;<i> template engine, that is to say you cannot insert any Python code in
</I>&gt;<i> the template, you have to play by some rules as far as flow control is
</I>&gt;<i> concerned.
</I>&gt;<i>
</I>&gt;<i> However, the evaluation tags can contain full Python evaluation, so
</I>&gt;<i> they are not as limited as the one you can find in Zope's TAL, Kid or
</I>&gt;<i> Django. I know they are limited on purpose, but I can't bear to be
</I>&gt;<i> forced to jump through hoops to please a development philosophy that
</I>&gt;<i> mostly gets in the way IMHO. There is no need to prevent your
</I>&gt;<i> developers to write full blown Python expression in their templates ;
</I>&gt;<i> if they have a little discipline, it is a real time saver.
</I>&gt;<i>
</I>&gt;<i> The template are used by modules published by the
</I>&gt;<i> mod_python.publisher. Like it was mentioned in a thread a few weeks
</I>&gt;<i> ago, I use a Python decorator to specify that the dictionary returned
</I>&gt;<i> by a published function or method must be used with a given template -
</I>&gt;<i> the decorator handle all the fuss about computing the relative path of
</I>&gt;<i> the template, and calling the template cache.
</I>&gt;<i>
</I>&gt;<i> All this is not perfect yet but I've been happily using it for nearly
</I>&gt;<i> a year now on various projects which are currently in production
</I>&gt;<i> (though under a quite moderate load so I cannot boast about its
</I>&gt;<i> performance apart that saying it is not a problem at all).
</I>&gt;<i>
</I>&gt;<i> All this to say that yes, writing an efficient pure Python template is
</I>&gt;<i> possible, there already exists a zillion and if none please you, then
</I>&gt;<i> with about 500 lines of code you have something good enough. Now, why
</I>&gt;<i> should we have to maintain some fairly obscure C code for the PSP
</I>&gt;<i> module, that eludes me  :).
</I>&gt;<i>
</I>&gt;<i> Regards,
</I>&gt;<i> Nicolas
</I>&gt;<i>
</I>&gt;<i> 2006/2/16, Nick &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">nick at dd.revealed.net</A>&gt;:
</I>&gt;<i> &gt; Nicolas Lehuen wrote:
</I>&gt;<i> &gt; &gt; If it were up to me, I would reimplement it in pure Python, and I
</I>&gt;<i> &gt; &gt; don't think the performance loss would be so big. Granted, compilation
</I>&gt;<i> &gt; &gt; would be a little slower, but once the PSP is compiled, performance
</I>&gt;<i> &gt; &gt; should be exactly the same - and implementing a compiler cache is
</I>&gt;<i> &gt; &gt; extremely easy. Plus, the code being more easy to maintain, we could
</I>&gt;<i> &gt; &gt; easily optimize it. Call it &quot;doing it the PyPy way&quot; if you like ;).
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; The original PSE parser I did worked very similar to PSP.  I used
</I>&gt;<i> HTMLParser
</I>&gt;<i> &gt; in the standard lib to do it.  However, it was different in that it was
</I>&gt;<i> not
</I>&gt;<i> &gt; PHP/ASP-ish where code could just be stuck anywhere; it had to be
</I>&gt;<i> parsable
</I>&gt;<i> &gt; HTML.  But I suspect you could just use a regular expression to do what
</I>&gt;<i> the
</I>&gt;<i> &gt; PSP parser does.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Nick
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20060216/c862faba/attachment-0001.html">http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20060216/c862faba/attachment-0001.html</A>
</PRE>













<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020316.html">[mod_python] Problem with PSP and unicode
</A></li>
	<LI>Next message: <A HREF="020314.html">[mod_python] Problem with PSP and unicode
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20323">[ date ]</a>
              <a href="thread.html#20323">[ thread ]</a>
              <a href="subject.html#20323">[ subject ]</a>
              <a href="author.html#20323">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
