<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] mod_python and mod_dav
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20mod_python%20and%20mod_dav&In-Reply-To=5ef0bc720602250319p203bfc16q6a20c71b98bcf9d8%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020443.html">
   <LINK REL="Next"  HREF="020447.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] mod_python and mod_dav</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20mod_python%20and%20mod_dav&In-Reply-To=5ef0bc720602250319p203bfc16q6a20c71b98bcf9d8%40mail.gmail.com"
       TITLE="[mod_python] mod_python and mod_dav">grahamd at dscpl.com.au
       </A><BR>
    <I>Sat Feb 25 06:56:55 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="020443.html">[mod_python] mod_python and mod_dav
</A></li>
        <LI>Next message: <A HREF="020447.html">[mod_python] apache core dumped after mod_python 2.7.11 installation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20444">[ date ]</a>
              <a href="thread.html#20444">[ thread ]</a>
              <a href="subject.html#20444">[ subject ]</a>
              <a href="author.html#20444">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The JIRA web site is down at the moment, otherwise I would refer you
to patches for mod_python that allow callouts from mod_include (ie.,
server side include) into mod_python. In this case though, what is  
required
is for mod_python to export the optional functions so a mod_dav_python
module could call it, which is opposite to that for mod_include where
mod_python is a user of the functions.

Getting late here, so I'll post more about the whole mod_dav issue  
tomorrow
when JIRA is working again. I think I even understand what functions  
need
to be exported now, so may be able to post some patches for it if you  
or some
one else wants to seriously pursue this.

Graham

On 25/02/2006, at 10:19 PM, Troy Kruthoff wrote:

&gt;<i> Graham,
</I>&gt;<i>
</I>&gt;<i> The below link describes making mod_include call into mod_cgi, so I
</I>&gt;<i> get how cool it would be to have the proper APR_RETRIEVE_OPTIONAL_FN()
</I>&gt;<i> interfaces for mod_python.  This looks like it may be beyond my scope,
</I>&gt;<i> but if no-one else is looking at doing this anytime soon I can take a
</I>&gt;<i> look at it.  Although I'd probabely be more of a help putting the code
</I>&gt;<i> behind the interface created by someone more familiar with the
</I>&gt;<i> workings of mod_python.
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://www.onlamp.com/pub/a/apache/2001/09/27/apache_2.html">http://www.onlamp.com/pub/a/apache/2001/09/27/apache_2.html</A>
</I>&gt;<i>
</I>&gt;<i> Troy
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On 2/25/06, Graham Dumpleton &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">grahamd at dscpl.com.au</A>&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On 25/02/2006, at 8:55 PM, Troy Kruthoff wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I'm trying to figure out the best way to add webdav capability to a
</I>&gt;&gt;&gt;<i> mod_python web app.   In short, I want to send/update calendar files
</I>&gt;&gt;&gt;<i> via calendar information stored in a database.  I've googled for
</I>&gt;&gt;&gt;<i> python based webdav server modules, and found 2, but the newest one
</I>&gt;&gt;&gt;<i> was last updated in 2000.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> My first thought was to write something in C that allowed mod_python
</I>&gt;&gt;&gt;<i> to control mod_dav, but this looks tricky and looks like it will  
</I>&gt;&gt;&gt;<i> take
</I>&gt;&gt;&gt;<i> me too long and crush my ego by confirming that I suck at C.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Second thought is to dig up the wevdav RFC and make a webdav server
</I>&gt;&gt;&gt;<i> module that will work as a mod_python handler (or at least called  
</I>&gt;&gt;&gt;<i> from
</I>&gt;&gt;&gt;<i> one).
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Third thought is to use a fixup handler.  This is where I'd really
</I>&gt;&gt;&gt;<i> like some feedback!  Can I (in a fixup) ascertain that the content
</I>&gt;&gt;&gt;<i> handler will be mod_dav, query the database, and write the requested
</I>&gt;&gt;&gt;<i> file to disk just before mod_dav is asked to push it to the client?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I have a idea of how mod_dav_python could be constructed. I had put
</I>&gt;&gt;<i> the idea on the back burner for the moment. Here is email where I  
</I>&gt;&gt;<i> have
</I>&gt;&gt;<i> posted a little bit about my ideas before when someone raised the  
</I>&gt;&gt;<i> idea
</I>&gt;&gt;<i> of mod_dav/mod_python integration.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> See below:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> On 30/01/2006, at 9:49 PM, Matt Carpenter wrote:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Graham Dumpleton wrote:
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Others may know what you are talking about, but I plead ignorance.
</I>&gt;&gt;&gt;&gt;&gt;<i> Can
</I>&gt;&gt;&gt;&gt;&gt;<i> you perhaps describe further what you are talking about, how it
</I>&gt;&gt;&gt;&gt;&gt;<i> would be
</I>&gt;&gt;&gt;&gt;&gt;<i> used etc. A URL to stuff that could be read to understand similar
</I>&gt;&gt;&gt;&gt;&gt;<i> things
</I>&gt;&gt;&gt;&gt;&gt;<i> would also help.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Graham
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> What I am trying to achieve:
</I>&gt;&gt;&gt;&gt;<i> I'm writing a module for our system for managing documents that're
</I>&gt;&gt;&gt;&gt;<i> attached to records in our database, updates to these documents are
</I>&gt;&gt;&gt;&gt;<i> recorded into the database along with what user made the user that
</I>&gt;&gt;&gt;&gt;<i> made the edit, and various other information depending on what type
</I>&gt;&gt;&gt;&gt;<i> of document (the system manages templates, and mailmerges with
</I>&gt;&gt;&gt;&gt;<i> virtual .csv files pulling data from the database as well). The
</I>&gt;&gt;&gt;&gt;<i> directory structure is entirely virtual, the structure on the
</I>&gt;&gt;&gt;&gt;<i> servers is just a few directories for each type of file, and the
</I>&gt;&gt;&gt;&gt;<i> files are named after their record in the database.
</I>&gt;&gt;&gt;&gt;<i> mod_dav implements hooks (see <A HREF="http://mailman.lyra.org/pipermail/">http://mailman.lyra.org/pipermail/</A> 
</I>&gt;&gt;&gt;&gt;<i> dav-
</I>&gt;&gt;&gt;&gt;<i> dev/2005-April/005926.html), but I'm not a C programmer, so I'd
</I>&gt;&gt;&gt;&gt;<i> like a these hooks to be able to call python functions instead.
</I>&gt;&gt;&gt;&gt;<i> Hope that makes sense.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Regardless of how you might use it, from a technical standpoint I
</I>&gt;&gt;&gt;<i> would say that it is not going to be possible at present.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> One could imagine being able to write a separate C based Apache
</I>&gt;&gt;&gt;<i> module
</I>&gt;&gt;&gt;<i> which provides Python based wrappings for the DAV specific data
</I>&gt;&gt;&gt;<i> structures   that the repository hook function use. As documented  
</I>&gt;&gt;&gt;<i> in:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>    <A HREF="http://docx.webperf.org/structdav__hooks__repository.html">http://docx.webperf.org/structdav__hooks__repository.html</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> But, there are a few things missing. First, is there is no way to
</I>&gt;&gt;&gt;<i> obtain references to the Python interpreter instances held by
</I>&gt;&gt;&gt;<i> mod_python, the mechanisms for creating them and acquiring locks
</I>&gt;&gt;&gt;<i> against
</I>&gt;&gt;&gt;<i> them from a distinct Apache   module. Similarly, there is there  
</I>&gt;&gt;&gt;<i> is no
</I>&gt;&gt;&gt;<i> way to access the mod_python Python   request_rec wrapper object  
</I>&gt;&gt;&gt;<i> etc.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Both of these and possibly other stuff would be required. You do not
</I>&gt;&gt;&gt;<i> want to go having to duplicate all this stuff as it sort of defeats
</I>&gt;&gt;&gt;<i> the
</I>&gt;&gt;&gt;<i> purpose   and would possibly prevent use of mod_python and your  
</I>&gt;&gt;&gt;<i> module
</I>&gt;&gt;&gt;<i> in the same Apache instance.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> What would be an interesting area for investigation in the future
</I>&gt;&gt;&gt;<i> would be to work out whether there are functions within the  
</I>&gt;&gt;&gt;<i> mod_python
</I>&gt;&gt;&gt;<i> module   which could be exposed using the Apache
</I>&gt;&gt;&gt;<i> APR_RETRIEVE_OPTIONAL_FN() interface. This would allow distinct
</I>&gt;&gt;&gt;<i> modules
</I>&gt;&gt;&gt;<i> to dynamically obtain references to   some of the internals of
</I>&gt;&gt;&gt;<i> mod_python so as to perhaps make use of all the   machinery it has
</I>&gt;&gt;&gt;<i> already for manipulating Python interpreters, as well as   existing
</I>&gt;&gt;&gt;<i> Python object wrappers for Apache structures.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> The end result would be the ability to create distinct C based  
</I>&gt;&gt;&gt;<i> Apache
</I>&gt;&gt;&gt;<i> modules which themselves can also make use of Python by
</I>&gt;&gt;&gt;<i> bootstrapping of
</I>&gt;&gt;&gt;<i> mod_python. It may be tricky to work out how to do it and come up
</I>&gt;&gt;&gt;<i> with a
</I>&gt;&gt;&gt;<i> good   interface design, but certainly would be interesting.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Graham
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020443.html">[mod_python] mod_python and mod_dav
</A></li>
	<LI>Next message: <A HREF="020447.html">[mod_python] apache core dumped after mod_python 2.7.11 installation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20444">[ date ]</a>
              <a href="thread.html#20444">[ thread ]</a>
              <a href="subject.html#20444">[ subject ]</a>
              <a href="author.html#20444">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
