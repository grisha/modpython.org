<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Reg Word Document Reading
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Reg%20Word%20Document%20Reading&In-Reply-To=c298f2d70602232239s724113b3r%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020417.html">
   <LINK REL="Next"  HREF="020419.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Reg Word Document Reading</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Nicolas Lehuen</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Reg%20Word%20Document%20Reading&In-Reply-To=c298f2d70602232239s724113b3r%40mail.gmail.com"
       TITLE="[mod_python] Reg Word Document Reading">nicolas at lehuen.com
       </A><BR>
    <I>Fri Feb 24 01:51:17 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="020417.html">[mod_python] Reg Word Document Reading
</A></li>
        <LI>Next message: <A HREF="020419.html">[mod_python] Reg Word Document Reading
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20418">[ date ]</a>
              <a href="thread.html#20418">[ thread ]</a>
              <a href="subject.html#20418">[ subject ]</a>
              <a href="author.html#20418">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Oh - of course it's only a starting point, since using ActiveDocument
and Documents.Close is a big no-no in a server process where multiple
request can be handled concurrently. You don't want one request to
access the text from another request's document. But there are other
ways to do so, see the doc.

Plus, you have to make sure that the Word COM object are properly
removed from memory if you don't want to see Word processes staying in
memory.

Regards,
Nicolas

2006/2/24, Nicolas Lehuen &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">nicolas at lehuen.com</A>&gt;:
&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> This has *nothing* to do whatsoever with mod_python. Nothing. Please
</I>&gt;<i> ask this on comp.lang.python, where you should receive half a dozen
</I>&gt;<i> response in a  quite short time.
</I>&gt;<i>
</I>&gt;<i> A pretty simple way to access comp.lang.python if you don't know ho
</I>&gt;<i> newsgroup work is to  use Google Groups :
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://groups.google.com/group/comp.lang.python">http://groups.google.com/group/comp.lang.python</A>
</I>&gt;<i>
</I>&gt;<i> After writing that, I shouldn't help you, as it will only make you
</I>&gt;<i> keep asking irrelevant questions here, but hey, I'm only human, so
</I>&gt;<i> I'll give you a few pointers.
</I>&gt;<i>
</I>&gt;<i>  .doc files are opaque, binary files, so you cannot read them as
</I>&gt;<i> easily as plain text files. You have to use the Word API, which is
</I>&gt;<i> exposed as COM objects, with the pywin32 modules.
</I>&gt;<i>
</I>&gt;<i> Now, behold the power of Google :
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://www.google.com/search?q=word+COM+python">http://www.google.com/search?q=word+COM+python</A>
</I>&gt;<i>
</I>&gt;<i> A few clicks here and there take me to this page :
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://wikipython.flibuste.net/moin.py/CodeWindows">http://wikipython.flibuste.net/moin.py/CodeWindows</A>
</I>&gt;<i>
</I>&gt;<i> It's French but I guess I could have seen this elsewhere :
</I>&gt;<i>
</I>&gt;<i> import win32com.client
</I>&gt;<i>
</I>&gt;<i> word = win32com.client.Dispatch(&quot;Word.Application&quot;)
</I>&gt;<i> word.Documents.Open(&quot;D:/partage/python/wordtxt/test.doc&quot;) # full path needed
</I>&gt;<i> text = word.ActiveDocument.content.text
</I>&gt;<i> word.Documents.Close()
</I>&gt;<i>
</I>&gt;<i> text = text.encode('Latin-1')
</I>&gt;<i>
</I>&gt;<i> print text
</I>&gt;<i>
</I>&gt;<i> Regards,
</I>&gt;<i> Nicolas
</I>&gt;<i>
</I>&gt;<i> P.S. since you've been asking quite a few questions on this list,
</I>&gt;<i> having something like part of your real name would be nice - I cannot
</I>&gt;<i> be brought to start a mail by &quot;Hello, Python Eager !&quot;, which looks
</I>&gt;<i> plain stupid.
</I>&gt;<i>
</I>&gt;<i> 2006/2/24, python eager &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">python_eager at yahoo.com</A>&gt;:
</I>&gt;<i> &gt; Hi,
</I>&gt;<i> &gt; &gt; &gt;   This is my code snippet. This code will not read the characters
</I>&gt;<i> &gt; in
</I>&gt;<i> &gt; &gt; &gt; Ms Word Document. I got the below output. But if i use any *txt*
</I>&gt;<i> &gt; &gt; &gt; format this will be display properly. Instead of txt format i am
</I>&gt;<i> &gt; &gt; &gt; using doc format. I got error while reading. please help me to
</I>&gt;<i> &gt; solve
</I>&gt;<i> &gt; &gt; &gt; this problem
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt;           req = self.request()
</I>&gt;<i> &gt; &gt; &gt;           inp = file('C:\\Python.doc','r')
</I>&gt;<i> &gt; &gt; &gt;           for line in inp:
</I>&gt;<i> &gt; &gt; &gt;              self.writeln(line)
</I>&gt;<i> &gt; &gt; &gt;           inp.close()
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; *Output :*
</I>&gt;<i> &gt; &gt; &gt; *    &#208;&#207;&#224;&#161;&#177;*
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; regards!
</I>&gt;<i> &gt; &gt; &gt; Python eager
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;  ________________________________
</I>&gt;<i> &gt; Brings words and photos together (easily) with
</I>&gt;<i> &gt;  PhotoMail - it's free and works with Yahoo! Mail.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Mod_python mailing list
</I>&gt;<i> &gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> &gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020417.html">[mod_python] Reg Word Document Reading
</A></li>
	<LI>Next message: <A HREF="020419.html">[mod_python] Reg Word Document Reading
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20418">[ date ]</a>
              <a href="thread.html#20418">[ thread ]</a>
              <a href="subject.html#20418">[ subject ]</a>
              <a href="author.html#20418">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
