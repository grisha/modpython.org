<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Session variables
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Session%20variables&In-Reply-To=64C3682A-9179-11D8-B9A8-003065477776%40webcrunchers.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015454.html">
   <LINK REL="Next"  HREF="015457.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Session variables</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Terry MacDonald</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Session%20variables&In-Reply-To=64C3682A-9179-11D8-B9A8-003065477776%40webcrunchers.com"
       TITLE="[mod_python] Session variables">terry.macdonald at dsl.pipex.com
       </A><BR>
    <I>Sun Apr 18 23:21:24 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="015454.html">[mod_python] Session variables
</A></li>
        <LI>Next message: <A HREF="015457.html">[mod_python] Session variables
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15455">[ date ]</a>
              <a href="thread.html#15455">[ thread ]</a>
              <a href="subject.html#15455">[ subject ]</a>
              <a href="author.html#15455">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all,

Here is a working example of a function using the session class and
setting some session variables.  This is an authentication handler and
the variables will be available to the main handler via the
request.session variable.

There is a quirk where the req.session.unlock() needs to be called to
release the session for the following handler. I thought this would have
been done in the session code, so could be a bug. The docs state
themselves that lock and unlock are unlikely to be called by apps,
however, I have found this not usually the case.

======================================================================
def authenhandler( req ) :
    &quot;&quot;&quot; This handler is only called if the AuthName, AuthType and
        Requires apache directives are set for a directory &quot;&quot;&quot;

    status = apache.OK
    # Get the session id from a cookie or create a new session. If it's
    # not new the user must already have been authenticated
    req.session = Session.Session(req, secret=&quot;xxxxxxxx&quot;)
    if req.session.is_new() :
        # Get user details...
        user = _dbGetUser(req, req.user)
        if user :
            # Authenticate user...
            if user[0] == req.get_basic_auth_pw() :
                # Store team id and name with the new session
                req.session['tid'] = user[1]
                req.session['team'] = user[2]
                req.session.save()
                req.log_error( &quot;%s logged in (session=%s)&quot; %
(req.session['team'], req.session.id()), apache.APLOG_NOTICE )
            else:
                req.log_error( &quot;Invalid password for %s&quot; % req.user,
apache.APLOG_NOTICE )
                status = apache.HTTP_UNAUTHORIZED
        else:
            status = apache.HTTP_UNAUTHORIZED
    req.session.unlock()
    return status
==========================================================================

Hope this helps.

Anyone have any answers to a previous email I sent entitled 'index.py'.
I mistakenly added it to another unrelated thread when, in fact, it
should be its own thread.

Cheers
-- 
Terry
Registered Linux User # 311806
www.taumu.com


&gt;<i> On Sun, 2004-04-18 at 21:45, John Draper wrote:
</I>&gt;<i> On Apr 1, 2004, at 8:58 AM, <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">jakob at simon-gaarde.dk</A> wrote:
</I>&gt;<i> 
</I>&gt;<i> &gt; Hello.
</I>&gt;<i> &gt; I can see that you can save and load session values from mod_python 
</I>&gt;<i> &gt; 3.1,
</I>&gt;<i> &gt; but unfortunately I don't understand how this works. Could someone
</I>&gt;<i> &gt; elabourate with an example please?
</I>&gt;<i> 
</I>&gt;<i> You're not the only one looking for examples.   I'm trying to put 
</I>&gt;<i> together
</I>&gt;<i> some examples myself,  but so far,  none of my code is working.  
</I>&gt;<i> Probably
</I>&gt;<i> due to the fact that none of us can read the author's mind and figure
</I>&gt;<i> out much of anything,  because there is no clue we can use to guide us
</I>&gt;<i> on how it's all supposed to be toed together.    Hopefully,  someone
</I>&gt;<i> might beat me to it.
</I>&gt;<i> 
</I>&gt;<i> John
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015454.html">[mod_python] Session variables
</A></li>
	<LI>Next message: <A HREF="015457.html">[mod_python] Session variables
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15455">[ date ]</a>
              <a href="thread.html#15455">[ thread ]</a>
              <a href="subject.html#15455">[ subject ]</a>
              <a href="author.html#15455">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
