<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] BMP upload problems
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20BMP%20upload%20problems&In-Reply-To=001501c42379%248d7a3d30%246701a8c0%40mortimer">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015443.html">
   <LINK REL="Next"  HREF="015446.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] BMP upload problems</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>David Fraser</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20BMP%20upload%20problems&In-Reply-To=001501c42379%248d7a3d30%246701a8c0%40mortimer"
       TITLE="[mod_python] BMP upload problems">davidf at sjsoft.com
       </A><BR>
    <I>Fri Apr 16 08:40:10 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="015443.html">[mod_python] BMP upload problems
</A></li>
        <LI>Next message: <A HREF="015446.html">[mod_python] index.py
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15444">[ date ]</a>
              <a href="thread.html#15444">[ thread ]</a>
              <a href="subject.html#15444">[ subject ]</a>
              <a href="author.html#15444">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Aaron Prillaman wrote:

&gt;<i> In uploading a bmp file with the following setup, something is 
</I>&gt;<i> corrupting the data.
</I>&gt;<i>  
</I>&gt;<i> I have a very simple python script:
</I>&gt;<i> tst.py..........
</I>&gt;<i>  
</I>&gt;<i> from mod_python import util
</I>&gt;<i> datadir = '/Documents and Settings/owner/desktop/www/data/'
</I>&gt;<i>  
</I>&gt;<i> def upload(req,sfl):
</I>&gt;<i>     sdata = req.form['sfl'].file.read()
</I>&gt;<i>     ofl = open(datadir+&quot;tst.bmp&quot;,&quot;w&quot;)
</I>&gt;<i>     ofl.write(sdata)
</I>&gt;<i>     return &quot;ok&quot;
</I>&gt;<i>  
</I>&gt;<i> and a simple form:
</I>&gt;<i> <A HREF="http://mollysgrave.no-ip.com:82/tst.html">http://mollysgrave.no-ip.com:82/tst.html</A>
</I>&gt;<i> tst.html............
</I>&gt;<i>  
</I>&gt;<i> &lt;html&gt;
</I>&gt;<i> &lt;form action=&quot;/cgi-bin/tst.py/upload&quot; method=&quot;post&quot; 
</I>&gt;<i> enctype=&quot;multipart/form-data&quot;&gt;&lt;br&gt;
</I>&gt;<i> file: &lt;input type=&quot;file&quot; name=&quot;sfl&quot;&gt;
</I>&gt;<i> &lt;input type=&quot;submit&quot;&gt;
</I>&gt;<i> &lt;/form&gt;
</I>&gt;<i> &lt;/html&gt;
</I>&gt;<i> I upload <A HREF="http://mollysgrave.no-ip.com:82/brown1.bmp">http://mollysgrave.no-ip.com:82/brown1.bmp</A>
</I>&gt;<i> and <A HREF="http://mollysgrave.no-ip.com:82/tst.bmp">http://mollysgrave.no-ip.com:82/tst.bmp</A> is the result.
</I>&gt;<i> I'm not really sure what the inconsistency is.  Just wondering if 
</I>&gt;<i> anyone has ideas.
</I>&gt;<i>  
</I>&gt;<i> Thanks,
</I>&gt;<i> Aaron Prillaman
</I>
tst.bmp is the same as unix2dos of brown1.bmp i.e. all the LFs are being 
replaced by CR LF
So the likely reason is when writing the file you need to open it in 
binary form (&quot;wb&quot; instead of &quot;w&quot;)

David
</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015443.html">[mod_python] BMP upload problems
</A></li>
	<LI>Next message: <A HREF="015446.html">[mod_python] index.py
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15444">[ date ]</a>
              <a href="thread.html#15444">[ thread ]</a>
              <a href="subject.html#15444">[ subject ]</a>
              <a href="author.html#15444">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
