<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Bug in Windows installation
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Bug%20in%20Windows%20installation&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015465.html">
   <LINK REL="Next"  HREF="015474.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Bug in Windows installation</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Eddie Diener</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Bug%20in%20Windows%20installation&In-Reply-To="
       TITLE="[mod_python] Bug in Windows installation">eddielee at tropicsoft.com
       </A><BR>
    <I>Sun Apr 25 13:47:33 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="015465.html">[mod_python] how to configure apache?
</A></li>
        <LI>Next message: <A HREF="015474.html">[mod_python] Bug in Windows installation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15467">[ date ]</a>
              <a href="thread.html#15467">[ thread ]</a>
              <a href="subject.html#15467">[ subject ]</a>
              <a href="author.html#15467">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Mod_python's postinstall script assumes that the Apache key in the Windows registry is in HKLM. However if one installs Apache Web Server on Windows and chooses to install for the current user in order to start Apache manually from the Console Window, the entry is under HKCU. Because of this an exception is thrown in the script when attempting to open HKLM/Apache Group/Apache and the postinstall script never finishes.

Here is the exception trace:

Traceback (most recent call last):
File &quot;H:\UTILIT~1\Python23\Scripts\win32_postinstall.py&quot;, line 86, in ?
apachediroptions = getApacheDirOptions()
File &quot;H:\UTILIT~1\Python23\Scripts\win32_postinstall.py&quot;, line 45, in
getApacheDirOptions
apachekey = regkey(win32con.HKEY_LOCAL_MACHINE, &quot;Software&quot;).childkey(&quot;Apache
Group&quot;).childkey(&quot;Apache&quot;)
File &quot;H:\UTILIT~1\Python23\Scripts\win32_postinstall.py&quot;, line 34, in
childkey
return regkey(self.key, subkeyname)
File &quot;H:\UTILIT~1\Python23\Scripts\win32_postinstall.py&quot;, line 32, in
_init_
self.key = win32api.RegOpenKey(parent, subkeyname)
pywintypes.error: (2, 'RegOpenKeyEx', 'The system cannot find the file
specified.')
Exception exceptions.AttributeError: &quot;regkey instance has no attribute
'key'&quot; in &lt;bound method regkey._del_ of &lt;_main_.regkey instance at
0x011C8468&gt;&gt; ignored
*** run_installscript: internal error 0xFFFFFFFF ***

A workaround is to temporarily duplicate the Apache registry keys from HKCU to HKLM and add the ServerRoot key value, poinitng it to the root directory where Apache is installed. The installing mod_python works OK.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://mailman.modpython.org/pipermail/mod_python/attachments/20040425/d1025e71/attachment.html">http://mailman.modpython.org/pipermail/mod_python/attachments/20040425/d1025e71/attachment.html</A>
</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015465.html">[mod_python] how to configure apache?
</A></li>
	<LI>Next message: <A HREF="015474.html">[mod_python] Bug in Windows installation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15467">[ date ]</a>
              <a href="thread.html#15467">[ thread ]</a>
              <a href="subject.html#15467">[ subject ]</a>
              <a href="author.html#15467">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
