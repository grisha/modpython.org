From alexis at mobiliant.com  Fri Mar  1 10:57:15 2002
From: alexis at mobiliant.com (=?iso-8859-1?Q?Ulf_Engstr=F6m?=)
Date: Fri Jan  9 21:46:39 2004
Subject: [mod_python] Install on Solaris
Message-ID: <00a701c1c107$791cffc0$4ede14d4@THENEWONE>

Hello :)
I'm having some problems installing on Solaris and I hope that someone could
help me a little. I've been searching the net and I've found many questions
regarding similar problems, but I havn't found a solution that works for me.

Problem is:
/usr/local/apache/> /bin/apachectl start
Syntax error on line 207 of /usr/local/apache/conf/httpd.conf:
Cannot load /usr/local/apache/libexec/mod_python.so into server: ld.so.1:
/usr/local/apache/bin/httpd: fatal: relocation error: file
/usr/local/apache/libexec/mod_python.so: symbol ap_log_error: referenced
symbol not found
/bin/apachectl start: httpd could not be started

(ap_log_error symbol exists in /usr/local/apache/include)

Other information:
> ldd -r /usr/local/apache/libexec/mod_python.so
        libm.so.1 =>     /usr/lib/libm.so.1
        libsocket.so.1 =>        /usr/lib/libsocket.so.1
        libnsl.so.1 =>   /usr/lib/libnsl.so.1
        libdl.so.1 =>    /usr/lib/libdl.so.1
        libc.so.1 =>     /usr/lib/libc.so.1
        libmp.so.2 =>    /usr/lib/libmp.so.2
        /usr/platform/SUNW,Sun-Blade-100/lib/libc_psr.so.1
        symbol not found: ap_log_error
(/usr/local/apache/libexec/mod_python.so)
        symbol not found: ap_log_error
(/usr/local/apache/libexec/mod_python.so)
        symbol not found: ap_log_error
(/usr/local/apache/libexec/mod_python.so)
<snipped many more symbols)

> uname -a
SunOS sol 5.8 Generic_108528-07 sun4u sparc SUNW,Sun-Blade-100

> which gcc
/usr/local/bin/gcc

> gcc -v
Reading specs from /usr/local/lib/gcc-lib/sparc-sun-solaris2.8/3.0.3/specs
Configured with:
../configure --with-as=/usr/local/bin/as --with-ld=/usr/local/bin/ld --enabl
e-libgcj
Thread model: posix
gcc version 3.0.3

> echo $LD_LIBRARY_PATH
/usr/lib:/lib:/usr/local/lib:/usr/local/mysql/lib:/usr/local/lib/

Python version 2.1.1
Apache version 1.3.23

I've also tried static compiling of mod_python, but that gave me the
following error during make of apache
connobject.o(.text+0x5d4): undefined reference to `PyMember_Set'

And many, many other rows of missing references.

Any more information needed, just let me know, I'd be very thankful for
anything that could help me with this:)

Regards
Ulf


From stony8 at gmx.de  Sun Mar  3 14:27:14 2002
From: stony8 at gmx.de (Alexander Steinert)
Date: Fri Jan  9 21:46:39 2004
Subject: [mod_python] Distinguish HTTP and HTTPS
Message-ID: <20020303142714.A9355@tyche.svt.tu-harburg.de>

My application wants to distinguish between requests sent with http and
those sent with https. Is that possible with mod_python? How?

TIA

Stony

From dustin at ywlcs.org  Sun Mar  3 09:28:12 2002
From: dustin at ywlcs.org (Dustin Mitchell)
Date: Fri Jan  9 21:46:39 2004
Subject: [mod_python] Distinguish HTTP and HTTPS
In-Reply-To: <20020303142714.A9355@tyche.svt.tu-harburg.de>
References: <20020303142714.A9355@tyche.svt.tu-harburg.de>
Message-ID: <20020303152812.GT3092@eleanor.internal.ywlcs.org>

Best way I've found to distinguish the two is to look at the port number:

def is_secure(req):
  # This seems the best way to do this
  return req.server.port == 443

Dustin

-- 

  Dustin Mitchell
  dustin@ywlcs.org

From jijang at tronwell.net  Tue Mar  5 16:34:46 2002
From: jijang at tronwell.net (=?ks_c_5601-1987?B?wOXBpMDO?=)
Date: Fri Jan  9 21:46:39 2004
Subject: [mod_python] pyo?
Message-ID: <HOEJLPEAEKDEMPJEOFLKAEDBCAAA.jijang@tronwell.net>

 .py ===> python file
 .pyc ===> python file -> compile
 .pyo ===> what is it?

From L.A.Timochouk at ukc.ac.uk  Tue Mar  5 12:09:45 2002
From: L.A.Timochouk at ukc.ac.uk (Leonid Timochouk)
Date: Fri Jan  9 21:46:39 2004
Subject: [mod_python] pyo?
In-Reply-To: <HOEJLPEAEKDEMPJEOFLKAEDBCAAA.jijang@tronwell.net>
Message-ID: <Pine.GSO.4.43.0203051207420.18140-100000@myrtle.ukc.ac.uk>

That is a Python byte-code file if compiled with optimisation.
If you run a command like

python -O some_file.py

it will produce "some_file.pyo" byte-code file instead of "some_file.pyc".

Leonid Timochouk
University of Kent at Canterbury


From jijang at tronwell.net  Wed Mar  6 12:19:20 2002
From: jijang at tronwell.net (=?ks_c_5601-1987?B?wOXBpMDO?=)
Date: Fri Jan  9 21:46:39 2004
Subject: [mod_python] i know .pyo...
Message-ID: <HOEJLPEAEKDEMPJEOFLKOEDBCAAA.jijang@tronwell.net>

 
 thx...everybody

 however, .pyc make is py_compile.compile()
 how is make .pyo?

From alain at onesite.org  Wed Mar  6 05:21:50 2002
From: alain at onesite.org (Alain Tesio)
Date: Fri Jan  9 21:46:39 2004
Subject: [mod_python] i know .pyo...
In-Reply-To: <HOEJLPEAEKDEMPJEOFLKOEDBCAAA.jijang@tronwell.net>
References: <HOEJLPEAEKDEMPJEOFLKOEDBCAAA.jijang@tronwell.net>
Message-ID: <20020306052150.310d8489.alain@onesite.org>

On Wed, 6 Mar 2002 12:19:20 +0900
 <jijang@tronwell.net> wrote:

>  
>  thx...everybody
> 
>  however, .pyc make is py_compile.compile()
>  how is make .pyo?

With the same command from a python session started
with python -O

Alain

From llsousa at ualg.pt  Wed Mar  6 15:55:55 2002
From: llsousa at ualg.pt (Luis Sousa)
Date: Fri Jan  9 21:46:39 2004
Subject: [mod_python] Not finding handler on public_html
Message-ID: <3C863C0B.2060901@ualg.pt>

Hi everybody

I installed mod_python on apache 1.3.23-1 and everything went OK.
Reading the documentation I tried to test my server writing some simple 
tests. I created a directory in /var/www called test and I haved copeid 
to her the file mptest.py. I changed the configuration of apache 
introducing new lines to that directory, like in the example in 3.2, 
from the documentation.
Everything went OK.

Then I tried to do the same thing but in my home directory, in 
public_html. Here it gave some errors:

Mod_python error: "PythonHandler mptest"

Traceback (most recent call last):

  File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 181, in Dispatch
    module = import_module(module_name, _req)

  File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 335, in import_module
    f, p, d = imp.find_module(parts[i], path)

ImportError: No module named mptest

What could be the problem that I'm having ?

Thanks in advance.

Luis Sousa




From grisha at modpython.org  Wed Mar  6 14:13:57 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:39 2004
Subject: [mod_python] Not finding handler on public_html
In-Reply-To: <3C863C0B.2060901@ualg.pt>
Message-ID: <Pine.BSF.4.32.0203061402330.55328-100000@localhost>

mod_python prepends to sys.path the directory in which the PythonHandler
directive is specified. So if the PythonHandler is at the top level in
your config file, then you have to set the sys.path manually to make sure
Python can find your script. You can do this using the PythonPath
directive.

On Wed, 6 Mar 2002, Luis Sousa wrote:

> Hi everybody
>
> I installed mod_python on apache 1.3.23-1 and everything went OK.
> Reading the documentation I tried to test my server writing some simple
> tests. I created a directory in /var/www called test and I haved copeid
> to her the file mptest.py. I changed the configuration of apache
> introducing new lines to that directory, like in the example in 3.2,
> from the documentation.
> Everything went OK.
>
> Then I tried to do the same thing but in my home directory, in
> public_html. Here it gave some errors:
>
> Mod_python error: "PythonHandler mptest"
>
> Traceback (most recent call last):
>
>   File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 181, in Dispatch
>     module = import_module(module_name, _req)
>
>   File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 335, in import_module
>     f, p, d = imp.find_module(parts[i], path)
>
> ImportError: No module named mptest
>
> What could be the problem that I'm having ?
>
> Thanks in advance.
>
> Luis Sousa
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From llsousa at ualg.pt  Thu Mar  7 09:45:03 2002
From: llsousa at ualg.pt (Luis Sousa)
Date: Fri Jan  9 21:46:39 2004
Subject: [mod_python] Not finding handler on public_html
References: <Pine.BSF.4.32.0203061402330.55328-100000@localhost>
Message-ID: <3C87369F.40100@ualg.pt>

I put this line in the directory definition of /home/llsousa/public_html 
and It's working:
    PythonPath "sys.path+['/home/llsousa/public_html']"

I tried to put in the directory definition /home/*/public_html a line 
like this and did not worked:
    PythonPath "sys.path+['/home/*/public_html']"
to all home public_html.

Is there a simple way to do this ?

Thanks, Luis Sousa


Gregory (Grisha) Trubetskoy wrote:

>mod_python prepends to sys.path the directory in which the PythonHandler
>directive is specified. So if the PythonHandler is at the top level in
>your config file, then you have to set the sys.path manually to make sure
>Python can find your script. You can do this using the PythonPath
>directive.
>
>On Wed, 6 Mar 2002, Luis Sousa wrote:
>
>>Hi everybody
>>
>>I installed mod_python on apache 1.3.23-1 and everything went OK.
>>Reading the documentation I tried to test my server writing some simple
>>tests. I created a directory in /var/www called test and I haved copeid
>>to her the file mptest.py. I changed the configuration of apache
>>introducing new lines to that directory, like in the example in 3.2,
>>from the documentation.
>>Everything went OK.
>>
>>Then I tried to do the same thing but in my home directory, in
>>public_html. Here it gave some errors:
>>
>>Mod_python error: "PythonHandler mptest"
>>
>>Traceback (most recent call last):
>>
>>  File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 181, in Dispatch
>>    module = import_module(module_name, _req)
>>
>>  File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 335, in import_module
>>    f, p, d = imp.find_module(parts[i], path)
>>
>>ImportError: No module named mptest
>>
>>What could be the problem that I'm having ?
>>
>>Thanks in advance.
>>
>>Luis Sousa
>>
>>
>>
>>_______________________________________________
>>Mod_python mailing list
>>Mod_python@modpython.org
>>http://www.modpython.org/mailman/listinfo/mod_python
>>
>
>
>




From alf at proweb.co.uk  Thu Mar  7 11:37:10 2002
From: alf at proweb.co.uk (alf)
Date: Fri Jan  9 21:46:39 2004
Subject: [mod_python] md5 & MySQLdb
Message-ID: <000d01c1c5cc$6c00b330$6501a8c0@fwoom>

Hi,

I'm having a great time with mod_python, it's doing everything I want so far

except this :

I can import most modules re, string, os, sys, even my own modules but for
some reason when I try and import md5 or MySQLdb I get :
ImportError: No module named md5

When I use the python console I get the expected :
Python 2.2 (#1, Feb 12 2002, 21:26:35)
[GCC 2.95.2 19991024 (release)] on freebsd4T
ype "help", "copyright", "credits" or "license" for more information.
>>> from mod_python import apache
Traceback (most recent call last):  File "<stdin>", line 1, in ?
File "/usr/local/lib/python2.2/site-packages/mod_python/apache.py", line 55,
in ?
import _apache
ImportError: No module named _apache
>>> import md5
>>>

I've ended up writing a routine :

def getMD5(txt) :
    md5fn = "/tmp/md5" + `getpid()`
    system("echo -n \"" + txt + "\" | md5 > " + md5fn)
    md5f = open(md5fn)
    md5l = md5f.readlines()
    md5f.close()
    unlink(md5fn)
    return md5l[0]

presumably it's something to do with md5 & MySQLdb being a c external

any solution?

cheers

Matt


From alain at onesite.org  Thu Mar  7 12:55:25 2002
From: alain at onesite.org (Alain Tesio)
Date: Fri Jan  9 21:46:39 2004
Subject: [mod_python] md5 & MySQLdb
In-Reply-To: <000d01c1c5cc$6c00b330$6501a8c0@fwoom>
References: <000d01c1c5cc$6c00b330$6501a8c0@fwoom>
Message-ID: <20020307125525.2ddc81ac.alain@onesite.org>

On Thu, 7 Mar 2002 11:37:10 -0000
"alf" <alf@proweb.co.uk> wrote:

> Hi,
> 
> I'm having a great time with mod_python, it's doing everything I want so far
> 
> except this :
> 
> I can import most modules re, string, os, sys, even my own modules but for
> some reason when I try and import md5 or MySQLdb I get :
> ImportError: No module named md5
> 
> When I use the python console I get the expected :
> Python 2.2 (#1, Feb 12 2002, 21:26:35)
> [GCC 2.95.2 19991024 (release)] on freebsd4T
> ype "help", "copyright", "credits" or "license" for more information.
> >>> from mod_python import apache
> Traceback (most recent call last):  File "<stdin>", line 1, in ?
> File "/usr/local/lib/python2.2/site-packages/mod_python/apache.py", line 55,
> in ?
> import _apache
> ImportError: No module named _apache
> >>> import md5
> >>>
> 
> I've ended up writing a routine :
> 
> def getMD5(txt) :
>     md5fn = "/tmp/md5" + `getpid()`
>     system("echo -n \"" + txt + "\" | md5 > " + md5fn)
>     md5f = open(md5fn)
>     md5l = md5f.readlines()
>     md5f.close()
>     unlink(md5fn)
>     return md5l[0]
> 
> presumably it's something to do with md5 & MySQLdb being a c external
> 
> any solution?
> 
> cheers
> 
> Matt

Hi, I can import MySQLdb fine, maybe you can add the path to the module
in sys.path
Btw in your function, you could also use a pipe instead of a temporary
file.

Alain

From matt at proweb.co.uk  Thu Mar  7 13:03:54 2002
From: matt at proweb.co.uk (Matt H)
Date: Fri Jan  9 21:46:39 2004
Subject: [mod_python] md5 & MySQLdb
References: <000d01c1c5cc$6c00b330$6501a8c0@fwoom> <20020307125525.2ddc81ac.alain@onesite.org>
Message-ID: <008a01c1c5d8$89c85560$6501a8c0@fwoom>

> Hi, I can import MySQLdb fine, maybe you can add the path to the module in
sys.path

Thanks, knowing it was possible made me fix it.

and I've managed to fix them both
MySQLdb was in /usr/local/lib/python2.2/site-packages
and
md5.so was in /usr/local/lib/python2.2/lib-dynload

so I added them to my PythonPath :

PythonPath "['/usr/local/lib/python2.2', '/usr/local/lib/python2.2/site
-packages', '/usr/local/lib/python2.2/lib-dynload', '/www/python']"

and now they import just fine


shame the PythonPath doesn't do subdirectories!

> Btw in your function, you could also use a pipe instead of a temporary
> file.

y thanks. That light came on for me this morning. tbh I figured someone
would tell me how to import md5 and I could scrap the lot so quick and dirty
would do in order to do the proof of concept


From grisha at modpython.org  Thu Mar  7 10:12:00 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:39 2004
Subject: [mod_python] Not finding handler on public_html
In-Reply-To: <3C87369F.40100@ualg.pt>
Message-ID: <Pine.BSF.4.32.0203071009100.67065-100000@localhost>

This is because "*" doesn't mean anything to Python.

One thing you could do is to AllowOverride FileInfo for all your users,
then they could specify their own PythonHandler or PythonPath in an
.htaccess file in their public_html directory.


Grisha

On Thu, 7 Mar 2002, Luis Sousa wrote:

> I put this line in the directory definition of /home/llsousa/public_html
> and It's working:
>     PythonPath "sys.path+['/home/llsousa/public_html']"
>
> I tried to put in the directory definition /home/*/public_html a line
> like this and did not worked:
>     PythonPath "sys.path+['/home/*/public_html']"
> to all home public_html.
>
> Is there a simple way to do this ?
>
> Thanks, Luis Sousa
>
>
> Gregory (Grisha) Trubetskoy wrote:
>
> >mod_python prepends to sys.path the directory in which the PythonHandler
> >directive is specified. So if the PythonHandler is at the top level in
> >your config file, then you have to set the sys.path manually to make sure
> >Python can find your script. You can do this using the PythonPath
> >directive.
> >
> >On Wed, 6 Mar 2002, Luis Sousa wrote:
> >
> >>Hi everybody
> >>
> >>I installed mod_python on apache 1.3.23-1 and everything went OK.
> >>Reading the documentation I tried to test my server writing some simple
> >>tests. I created a directory in /var/www called test and I haved copeid
> >>to her the file mptest.py. I changed the configuration of apache
> >>introducing new lines to that directory, like in the example in 3.2,
> >>from the documentation.
> >>Everything went OK.
> >>
> >>Then I tried to do the same thing but in my home directory, in
> >>public_html. Here it gave some errors:
> >>
> >>Mod_python error: "PythonHandler mptest"
> >>
> >>Traceback (most recent call last):
> >>
> >>  File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 181, in Dispatch
> >>    module = import_module(module_name, _req)
> >>
> >>  File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 335, in import_module
> >>    f, p, d = imp.find_module(parts[i], path)
> >>
> >>ImportError: No module named mptest
> >>
> >>What could be the problem that I'm having ?
> >>
> >>Thanks in advance.
> >>
> >>Luis Sousa
> >>
> >>
> >>
> >>_______________________________________________
> >>Mod_python mailing list
> >>Mod_python@modpython.org
> >>http://www.modpython.org/mailman/listinfo/mod_python
> >>
> >
> >
> >
>
>
>


From rien at yeepa.org  Thu Mar  7 18:45:31 2002
From: rien at yeepa.org (Adrien Pisson)
Date: Fri Jan  9 21:46:39 2004
Subject: [mod_python] Multiple cookies (not writing, but reading...)
Message-ID: <000701c1c5ff$e186ba40$2cee4cd4@RANDOM>

in all the mailing list archive, i've found many posts asking how to set
multiple cookies.
that's right, it's in the manual, use the method add.

but, if i can write multiple cookies, i can't figure out how i can read
multiple cookies from headers_in.
is there any counterparts to add ? (the manual does not mention it, neither
do the source code for table)

thanks.

--
rien



From grisha at modpython.org  Thu Mar  7 13:11:14 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:39 2004
Subject: [mod_python] Multiple cookies (not writing, but reading...)
In-Reply-To: <000701c1c5ff$e186ba40$2cee4cd4@RANDOM>
Message-ID: <Pine.BSF.4.32.0203071309310.68895-100000@localhost>

If headers_in contains multiple keys with the same name, then when you try
to retrieve this key, the result will be a list. That's bascially all
there is to it :)

On Thu, 7 Mar 2002, Adrien Pisson wrote:

> in all the mailing list archive, i've found many posts asking how to set
> multiple cookies.
> that's right, it's in the manual, use the method add.
>
> but, if i can write multiple cookies, i can't figure out how i can read
> multiple cookies from headers_in.
> is there any counterparts to add ? (the manual does not mention it, neither
> do the source code for table)
>
> thanks.
>
> --
> rien
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From llsousa at ualg.pt  Fri Mar  8 09:35:53 2002
From: llsousa at ualg.pt (Luis Sousa)
Date: Fri Jan  9 21:46:39 2004
Subject: [mod_python] [Fwd: Defining classes using mod_python]
Message-ID: <3C8885F9.2000300@ualg.pt>

Where can I find some examples to implement classes using mod_python ?

I'm using the example that is in the documentation in python.org to 
build a class but something is going wrong.

Thanks, Luis Sousa



From matt at proweb.co.uk  Fri Mar  8 09:38:02 2002
From: matt at proweb.co.uk (Matt H)
Date: Fri Jan  9 21:46:39 2004
Subject: [mod_python] [Fwd: Defining classes using mod_python]
In-Reply-To: <3C8885F9.2000300@ualg.pt>
References: <3C8885F9.2000300@ualg.pt>
Message-ID: <20020308093802.450c7dc1.matt@proweb.co.uk>

On Fri, 08 Mar 2002 09:35:53 +0000
"Luis Sousa" <llsousa@ualg.pt> wrote:

> Where can I find some examples to implement classes using mod_python ?
> 
> I'm using the example that is in the documentation in python.org to 
> build a class but something is going wrong.

I can build classes just fine, what's the actual problem?
 
> Thanks, Luis Sousa
>

From llsousa at ualg.pt  Fri Mar  8 10:56:08 2002
From: llsousa at ualg.pt (Luis Sousa)
Date: Fri Jan  9 21:46:39 2004
Subject: [mod_python] [Fwd: Defining classes using mod_python]
References: <3C8885F9.2000300@ualg.pt> <20020308093802.450c7dc1.matt@proweb.co.uk>
Message-ID: <3C8898C8.6000203@ualg.pt>

I know the problem is mine, so there's goes a simple example !

I have two files, one that I used to define a class and other one that 
calls the class:
    - file that defines the class: pessoalWEB.py

                class MyClass:
                    def __init__ (self):
                        self.x = ''
                        self.y = ''

    - file that uses the class: callClassWEB.py
               
                import pessoal

                def testFunc():
                    MyClass = pessoal.MyClass()
                    saida = MyClass.x
                    saida = MyClass.y
                    if saida=='':
                        saida="NULL"
   
                    return saida

I call this file using 
http://machinename/~llsousa/gpessoal/callClassWEB.py/testFunc in my browser.

The definition that I'm using on httpd.conf for this directory in apache is:

<Directory /home/llsousa/public_html/gpessoal>
    AddHandler python-program .py
    PythonHandler mod_python.publisher
    PythonDebug On
    PythonPath "sys.path+['/home/llsousa/public_html/gpessoal']"
</Directory>

The output that I will expect to return was NULL.
The problem is that in the browser, if I make Reload several times, 
sometimes I get what I expect, other times I got this message:

Mod_python error: "PythonHandler mod_python.publisher"

Traceback (most recent call last):

  File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 
193, in Dispatch
    result = object(req)

  File "/usr/lib/python2.1/site-packages/mod_python/publisher.py", line 
171, in handler
    result = apply(object, (), args)

  File "/home/llsousa/public_html/gpessoal/callClassWEB.py", line 6, in 
testFunc
    saida = MyClass.x

AttributeError: MyClass instance has no attribute 'x'

I was suppose to work all the time. Using the same example in python, 
everything went OK !.

What I'm I doing wrong ????

Thanks, Luis Sousa


Matt H wrote:

>On Fri, 08 Mar 2002 09:35:53 +0000
>"Luis Sousa" <llsousa@ualg.pt> wrote:
>
>>Where can I find some examples to implement classes using mod_python ?
>>
>>I'm using the example that is in the documentation in python.org to 
>>build a class but something is going wrong.
>>
>
>I can build classes just fine, what's the actual problem?
> 
>
>>Thanks, Luis Sousa
>>
>
>




From llsousa at ualg.pt  Fri Mar  8 10:59:18 2002
From: llsousa at ualg.pt (Luis Sousa)
Date: Fri Jan  9 21:46:39 2004
Subject: [Fwd: Re: [mod_python] [Fwd: Defining classes using mod_python]]
Message-ID: <3C889986.9050003@ualg.pt>

Where you read import pessoal, should read import pessoalWEB
----------

I know the problem is mine, so there's goes a simple example !

I have two files, one that I used to define a class and other one that 
calls the class:
    - file that defines the class: pessoalWEB.py

                class MyClass:
                    def __init__ (self):
                        self.x = ''
                        self.y = ''

    - file that uses the class: callClassWEB.py
               
                import pessoal

                def testFunc():
                    MyClass = pessoal.MyClass()
                    saida = MyClass.x
                    saida = MyClass.y
                    if saida=='':
                        saida="NULL"
   
                    return saida

I call this file using 
http://machinename/~llsousa/gpessoal/callClassWEB.py/testFunc in my browser.

The definition that I'm using on httpd.conf for this directory in apache is:

<>
    AddHandler python-program .py
    PythonHandler mod_python.publisher
    PythonDebug On
    PythonPath "sys.path+['/home/llsousa/public_html/gpessoal']"


The output that I will expect to return was NULL.
The problem is that in the browser, if I make Reload several times, 
sometimes I get what I expect, other times I got this message:

Mod_python error: "PythonHandler mod_python.publisher"

Traceback (most recent call last):

  File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 
193, in Dispatch
    result = object(req)

  File "/usr/lib/python2.1/site-packages/mod_python/publisher.py", line 
171, in handler
    result = apply(object, (), args)

  File "/home/llsousa/public_html/gpessoal/callClassWEB.py", line 6, in 
testFunc
    saida = MyClass.x

AttributeError: MyClass instance has no attribute 'x'

I was suppose to work all the time. Using the same example in python, 
everything went OK !.

What I'm I doing wrong ????

Thanks, Luis Sousa


Matt H wrote:

>On Fri, 08 Mar 2002 09:35:53 +0000
>"Luis Sousa" < @ualg.pt=""> wrote:
>
>>Where can I find some examples to implement classes using mod_python ?
>>
>>I'm using the example that is in the documentation in python.org to 
>>build a class but something is going wrong.
>>
>
>I can build classes just fine, what's the actual problem?
> 
>
>>Thanks, Luis Sousa
>>
>
>





From matt at proweb.co.uk  Fri Mar  8 10:40:42 2002
From: matt at proweb.co.uk (Matt H)
Date: Fri Jan  9 21:46:39 2004
Subject: [mod_python] [Fwd: Defining classes using mod_python]
In-Reply-To: <3C8898C8.6000203@ualg.pt>
References: <3C8885F9.2000300@ualg.pt>
	<20020308093802.450c7dc1.matt@proweb.co.uk>
	<3C8898C8.6000203@ualg.pt>
Message-ID: <20020308104042.0a1634a2.matt@proweb.co.uk>

On Fr
> 
> I was suppose to work all the time. Using the same example in python, 
> everything went OK !.
> 
> What I'm I doing wrong ????
> 

ah, I don't use mod_python.publisher 

sorry

From llsousa at ualg.pt  Fri Mar  8 11:19:10 2002
From: llsousa at ualg.pt (Luis Sousa)
Date: Fri Jan  9 21:46:39 2004
Subject: [mod_python] [Fwd: Defining classes using mod_python]
References: <3C8885F9.2000300@ualg.pt>	<20020308093802.450c7dc1.matt@proweb.co.uk>	<3C8898C8.6000203@ualg.pt> <20020308104042.0a1634a2.matt@proweb.co.uk>
Message-ID: <3C889E2E.3010002@ualg.pt>

What do you use then ??


Matt H wrote:

>On Fr
>
>>I was suppose to work all the time. Using the same example in python, 
>>everything went OK !.
>>
>>What I'm I doing wrong ????
>>
>
>ah, I don't use mod_python.publisher 
>
>sorry
>
>




From ts1 at cma.co.jp  Fri Mar  8 20:21:14 2002
From: ts1 at cma.co.jp (SONE Takeshi)
Date: Fri Jan  9 21:46:39 2004
Subject: [Fwd: Re: [mod_python] [Fwd: Defining classes using mod_python]]
In-Reply-To: <3C889986.9050003@ualg.pt>
References: <3C889986.9050003@ualg.pt>
Message-ID: <20020308112113.GA3865@cma.co.jp>

On Fri, Mar 08, 2002 at 10:59:18AM +0000, Luis Sousa wrote:
> What I'm I doing wrong ????

Try reloading (restarting) apache.

-- 
Takeshi

From llsousa at ualg.pt  Fri Mar  8 11:25:46 2002
From: llsousa at ualg.pt (Luis Sousa)
Date: Fri Jan  9 21:46:39 2004
Subject: [Fwd: Re: [mod_python] [Fwd: Defining classes using mod_python]]
References: <3C889986.9050003@ualg.pt>
Message-ID: <3C889FBA.1070107@ualg.pt>

> I have two files, one that I used to define a class and other one that 
> calls the class:
>    - file that defines the class: pessoalWEB.py
>
>                class MyClass:
>                    def __init__ (self):
>                        self.x = ''
>                        self.y = ''
>
>    - file that uses the class: callClassWEB.py
>                 import pessoalWEB
>
>                def testFunc():
>                    MyClass = pessoalWEB.MyClass()
>                    saida = MyClass.x
>                    saida = MyClass.y
>                    if saida=='':
>                        saida="NULL"
>                      return saida
>
> I call this file using 
> http://machinename/~llsousa/gpessoal/callClassWEB.py/testFunc in my 
> browser.

I already saw what was the problem. The object. was not well 
initialized. It was MyClass = pessoal.MyClass() instead of MyClass = 
pessoalWEB.MyClass()

But now I notice something strange. When I define saida = MyClass.k it 
gave no error.
Souldn't it gave an error like this: AttributeError: MyClass instance 
has no attribute 'k' ???

Why it doesn't do that ?

Thanks, Luis Sousa


From matt at proweb.co.uk  Fri Mar  8 11:06:10 2002
From: matt at proweb.co.uk (Matt H)
Date: Fri Jan  9 21:46:39 2004
Subject: [mod_python] [Fwd: Defining classes using mod_python]
In-Reply-To: <3C889E2E.3010002@ualg.pt>
References: <3C8885F9.2000300@ualg.pt>
	<20020308093802.450c7dc1.matt@proweb.co.uk>
	<3C8898C8.6000203@ualg.pt>
	<20020308104042.0a1634a2.matt@proweb.co.uk>
	<3C889E2E.3010002@ualg.pt>
Message-ID: <20020308110610.3aeca7e2.matt@proweb.co.uk>

On Fri, 08 Mar 2002 11:19:10 +0000
"Luis Sousa" <llsousa@ualg.pt> wrote:

> What do you use then ??

something like this :
--- httpd.conf ----------
<Directory /www/python>
  AddHandler python-program .py
  PythonHandler contentAdmin
  PythonDebug On
</Directory>
-------------------------



------- contentAdmin.py -

from mod_python import apache
from mod_python import util

def handler(request):
        global req
        req = request
        req.content_type = "text/html"
        req.send_http_header()

        req.write(getTheHTML())
	

        return apache.OK

-------------------------

I also use this inside a <VirtualHost
---------httpd.conf----------------
	<Location /profile>
                AddHandler python-program .py
                PythonAuthenHandler authHandler
                PythonDebug On
	</Location>
----------

(Directory is a class of my own)

---- authHandler.py --
import Directory
import md5

from mod_python import apache
from mod_python import util


def authenhandler(req):
        pwd = req.get_basic_auth_pw()
        usr = req.connection.user
        if pwd and usr :
                d = Directory.Directory("/www/Users/" + usr)
                mdu = d.getLines('md5')
                if mdu[0][:-1] == md5.new(pwd).hexdigest() :
                         return apache.OK
                else :
                         return apache.HTTP_UNAUTHORIZED
        return apache.HTTP_UNAUTHORIZED


-------------------------

From llsousa at ualg.pt  Fri Mar  8 11:46:42 2002
From: llsousa at ualg.pt (Luis Sousa)
Date: Fri Jan  9 21:46:40 2004
Subject: [mod_python] [Fwd: Defining classes using mod_python]
References: <3C8885F9.2000300@ualg.pt>	<20020308093802.450c7dc1.matt@proweb.co.uk>	<3C8898C8.6000203@ualg.pt>	<20020308104042.0a1634a2.matt@proweb.co.uk>	<3C889E2E.3010002@ualg.pt> <20020308110610.3aeca7e2.matt@proweb.co.uk>
Message-ID: <3C88A4A2.8010809@ualg.pt>

But in this way, there's only an handler for that directory, is that 
correct ?
Suppose that I want to have more than one handler in that directory, for 
my organization

Why do you use a virtual host ? That I didn't get it !!!!


Matt H wrote:

>On Fri, 08 Mar 2002 11:19:10 +0000
>"Luis Sousa" <llsousa@ualg.pt> wrote:
>
>>What do you use then ??
>>
>
>something like this :
>--- httpd.conf ----------
><Directory /www/python>
>  AddHandler python-program .py
>  PythonHandler contentAdmin
>  PythonDebug On
></Directory>
>-------------------------
>
>
>
>------- contentAdmin.py -
>
>from mod_python import apache
>from mod_python import util
>
>def handler(request):
>        global req
>        req = request
>        req.content_type = "text/html"
>        req.send_http_header()
>
>        req.write(getTheHTML())
>	
>
>        return apache.OK
>
>-------------------------
>
>I also use this inside a <VirtualHost
>---------httpd.conf----------------
>	<Location /profile>
>                AddHandler python-program .py
>                PythonAuthenHandler authHandler
>                PythonDebug On
>	</Location>
>----------
>
>(Directory is a class of my own)
>
>---- authHandler.py --
>import Directory
>import md5
>
>from mod_python import apache
>from mod_python import util
>
>
>def authenhandler(req):
>        pwd = req.get_basic_auth_pw()
>        usr = req.connection.user
>        if pwd and usr :
>                d = Directory.Directory("/www/Users/" + usr)
>                mdu = d.getLines('md5')
>                if mdu[0][:-1] == md5.new(pwd).hexdigest() :
>                         return apache.OK
>                else :
>                         return apache.HTTP_UNAUTHORIZED
>        return apache.HTTP_UNAUTHORIZED
>
>
>-------------------------
>
>




From matt at proweb.co.uk  Fri Mar  8 11:48:20 2002
From: matt at proweb.co.uk (Matt H)
Date: Fri Jan  9 21:46:40 2004
Subject: [mod_python] [Fwd: Defining classes using mod_python]
In-Reply-To: <3C88A4A2.8010809@ualg.pt>
References: <3C8885F9.2000300@ualg.pt>
	<20020308093802.450c7dc1.matt@proweb.co.uk>
	<3C8898C8.6000203@ualg.pt>
	<20020308104042.0a1634a2.matt@proweb.co.uk>
	<3C889E2E.3010002@ualg.pt>
	<20020308110610.3aeca7e2.matt@proweb.co.uk>
	<3C88A4A2.8010809@ualg.pt>
Message-ID: <20020308114820.5c359c46.matt@proweb.co.uk>

On Fri, 08 Mar 2002 11:46:42 +0000
"Luis Sousa" <llsousa@ualg.pt> wrote:

> But in this way, there's only an handler for that directory, is that 
> correct ?
> Suppose that I want to have more than one handler in that directory, for
> my organization
> 
> Why do you use a virtual host ? That I didn't get it !!!!
> 

I should have pointed out that /www/python is aliased as my cgi-bin

The bit in the virtual host is just for HTTP authentication of that
particular directory


My setup is probably not correct for all setups. 
I'm the only user so I have a tendancy to do what works today :)

From grisha at modpython.org  Fri Mar  8 10:26:18 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:40 2004
Subject: [Fwd: Re: [mod_python] [Fwd: Defining classes using mod_python]]
In-Reply-To: <3C889FBA.1070107@ualg.pt>
Message-ID: <Pine.BSF.4.32.0203081022130.79915-100000@localhost>

This is probably because you're chaning pessoalWEB but the Python
interpreter ignores those changes because the pessoalWEB module is already
imported. You need to reload pessoalWEB or restart apache. There is a note
about that in the FAQ:

http://www.modpython.org/FAQ/faqw.py?req=all#3.1

P.S. There is nothing wrong with the publisher handler, it should work for
you just fine.

Grisha


On Fri, 8 Mar 2002, Luis Sousa wrote:

> > I have two files, one that I used to define a class and other one that
> > calls the class:
> >    - file that defines the class: pessoalWEB.py
> >
> >                class MyClass:
> >                    def __init__ (self):
> >                        self.x = ''
> >                        self.y = ''
> >
> >    - file that uses the class: callClassWEB.py
> >                 import pessoalWEB
> >
> >                def testFunc():
> >                    MyClass = pessoalWEB.MyClass()
> >                    saida = MyClass.x
> >                    saida = MyClass.y
> >                    if saida=='':
> >                        saida="NULL"
> >                      return saida
> >
> > I call this file using
> > http://machinename/~llsousa/gpessoal/callClassWEB.py/testFunc in my
> > browser.
>
> I already saw what was the problem. The object. was not well
> initialized. It was MyClass = pessoal.MyClass() instead of MyClass =
> pessoalWEB.MyClass()
>
> But now I notice something strange. When I define saida = MyClass.k it
> gave no error.
> Souldn't it gave an error like this: AttributeError: MyClass instance
> has no attribute 'k' ???
>
> Why it doesn't do that ?
>
> Thanks, Luis Sousa
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From llsousa at ualg.pt  Fri Mar  8 16:22:54 2002
From: llsousa at ualg.pt (Luis Sousa)
Date: Fri Jan  9 21:46:40 2004
Subject: [Fwd: Re: [mod_python] [Fwd: Defining classes using mod_python]]
References: <Pine.BSF.4.32.0203081022130.79915-100000@localhost>
Message-ID: <3C88E55E.2030605@ualg.pt>

I tried the sugestion that you gave me but it still working without 
giving me an error !!!
I tried putting the PythonHandler in apache directly to file and it gave 
me the error that I was expecting.

Probably it's some problem in my configuration, or something else !!!
What could it be ?

Luis Sousa

Gregory (Grisha) Trubetskoy wrote:

>This is probably because you're chaning pessoalWEB but the Python
>interpreter ignores those changes because the pessoalWEB module is already
>imported. You need to reload pessoalWEB or restart apache. There is a note
>about that in the FAQ:
>
>http://www.modpython.org/FAQ/faqw.py?req=all#3.1
>
>P.S. There is nothing wrong with the publisher handler, it should work for
>you just fine.
>
>Grisha
>
>
>On Fri, 8 Mar 2002, Luis Sousa wrote:
>
>>>I have two files, one that I used to define a class and other one that
>>>calls the class:
>>>   - file that defines the class: pessoalWEB.py
>>>
>>>               class MyClass:
>>>                   def __init__ (self):
>>>                       self.x = ''
>>>                       self.y = ''
>>>
>>>   - file that uses the class: callClassWEB.py
>>>                import pessoalWEB
>>>
>>>               def testFunc():
>>>                   MyClass = pessoalWEB.MyClass()
>>>                   saida = MyClass.x
>>>                   saida = MyClass.y
>>>                   if saida=='':
>>>                       saida="NULL"
>>>                     return saida
>>>
>>>I call this file using
>>>http://machinename/~llsousa/gpessoal/callClassWEB.py/testFunc in my
>>>browser.
>>>
>>I already saw what was the problem. The object. was not well
>>initialized. It was MyClass = pessoal.MyClass() instead of MyClass =
>>pessoalWEB.MyClass()
>>
>>But now I notice something strange. When I define saida = MyClass.k it
>>gave no error.
>>Souldn't it gave an error like this: AttributeError: MyClass instance
>>has no attribute 'k' ???
>>
>>Why it doesn't do that ?
>>
>>Thanks, Luis Sousa
>>
>>_______________________________________________
>>Mod_python mailing list
>>Mod_python@modpython.org
>>http://www.modpython.org/mailman/listinfo/mod_python
>>
>
>
>




From reitz at inworks.de  Mon Mar 11 19:19:04 2002
From: reitz at inworks.de (Andre Reitz)
Date: Fri Jan  9 21:46:40 2004
Subject: [mod_python] BUG IN cgihandler / setup_cgi
Message-ID: <3C8CF518.FCBFD053@inworks.de>

def setup_cgi(req):
    """
    Replace sys.stdin and stdout with an objects that read/write to
    the socket, as well as substitute the os.environ.
    Returns (environ, stdin, stdout) which you must save and then use
    with restore_nocgi().
    """

    # save env
    env = os.environ.copy() <<<< 1 !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

    si = sys.stdin
    so = sys.stdout

    env = build_cgi_env(req) <<<<< 2 !!!!!!!!!!!!!!!!!!!

    for k in env.keys():
        os.environ[k] = env[k]

    sys.stdout = CGIStdout(req)
    sys.stdin = CGIStdin(req)

    sys.argv = [] # keeps cgi.py happy

    return env, si, so <<<< 3 !!!!!!!!!!!!!!!!!!!!!!!!!


- The env (1) perhaps should be called originalenv
- (2) keep as is
- (3) change to: return originalenv, si, so


Will somebody patch it?

This can cause critical bugs!

Greetings, Andre'

--
_____________________________________________
inworks GmbH            Andre Reitz
Magirusstrasse 44       Tel. 0731/93 80 7-21
89077 Ulm               http://www.inworks.de

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020311/a753796f/attachment.htm
From reitz at inworks.de  Mon Mar 11 19:26:28 2002
From: reitz at inworks.de (Andre Reitz)
Date: Fri Jan  9 21:46:40 2004
Subject: [mod_python] Several Python Installations
Message-ID: <3C8CF6D3.469BA1C2@inworks.de>

I have two python installations on a single machine:

    /usr/bin/python2.1 (with threads, SuSE rpm installation)

and

    /opt/inworks/bin/python2.1   (no threads for mod_python)


Anything compiled good.

mod_python - libs are only installed in
    /opt/inworks/lib/python2.1/site-packages/mod_python

Anything works fine.

BUT: if there is a symbolic link:
  /usr/bin/python -> /usr/bin/python2.1
then mod_python tries to import mod_python.apache from
/usr/lib/python2.1/site-packages and fails.

if I delete  the symbolic link /usr/bin/python and
restart apache anything is good again.


WHY DOES IT BEHAVE LIKE THIS? is it a problem of libpython???

Thank you very much in advance.

--
_____________________________________________
inworks GmbH            Andre Reitz
Magirusstrasse 44       Tel. 0731/93 80 7-21
89077 Ulm               http://www.inworks.de

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020311/c623a917/attachment.htm
From grisha at modpython.org  Mon Mar 11 14:13:19 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:40 2004
Subject: [mod_python] BUG IN cgihandler / setup_cgi
In-Reply-To: <3C8CF518.FCBFD053@inworks.de>
Message-ID: <Pine.BSF.4.32.0203111411110.20785-100000@localhost>

This is clearly a booboo, thanks Andre for pointing it out. I'll make sure
to patch it up in cvs.

On Mon, 11 Mar 2002, Andre Reitz wrote:

> def setup_cgi(req):
>     """
>     Replace sys.stdin and stdout with an objects that read/write to
>     the socket, as well as substitute the os.environ.
>     Returns (environ, stdin, stdout) which you must save and then use
>     with restore_nocgi().
>     """
>
>     # save env
>     env = os.environ.copy() <<<< 1 !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
>
>     si = sys.stdin
>     so = sys.stdout
>
>     env = build_cgi_env(req) <<<<< 2 !!!!!!!!!!!!!!!!!!!
>
>     for k in env.keys():
>         os.environ[k] = env[k]
>
>     sys.stdout = CGIStdout(req)
>     sys.stdin = CGIStdin(req)
>
>     sys.argv = [] # keeps cgi.py happy
>
>     return env, si, so <<<< 3 !!!!!!!!!!!!!!!!!!!!!!!!!
>
>
> - The env (1) perhaps should be called originalenv
> - (2) keep as is
> - (3) change to: return originalenv, si, so
>
>
> Will somebody patch it?
>
> This can cause critical bugs!
>
> Greetings, Andre'
>
> --
> _____________________________________________
> inworks GmbH            Andre Reitz
> Magirusstrasse 44       Tel. 0731/93 80 7-21
> 89077 Ulm               http://www.inworks.de
>
>


From grisha at modpython.org  Mon Mar 11 14:15:22 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:40 2004
Subject: [mod_python] Several Python Installations
In-Reply-To: <3C8CF6D3.469BA1C2@inworks.de>
Message-ID: <Pine.BSF.4.32.0203111414160.20785-100000@localhost>

I don't believe mod_python does anything with those, so its probably
something in libpython..

On Mon, 11 Mar 2002, Andre Reitz wrote:

> I have two python installations on a single machine:
>
>     /usr/bin/python2.1 (with threads, SuSE rpm installation)
>
> and
>
>     /opt/inworks/bin/python2.1   (no threads for mod_python)
>
>
> Anything compiled good.
>
> mod_python - libs are only installed in
>     /opt/inworks/lib/python2.1/site-packages/mod_python
>
> Anything works fine.
>
> BUT: if there is a symbolic link:
>   /usr/bin/python -> /usr/bin/python2.1
> then mod_python tries to import mod_python.apache from
> /usr/lib/python2.1/site-packages and fails.
>
> if I delete  the symbolic link /usr/bin/python and
> restart apache anything is good again.
>
>
> WHY DOES IT BEHAVE LIKE THIS? is it a problem of libpython???
>
> Thank you very much in advance.
>
> --
> _____________________________________________
> inworks GmbH            Andre Reitz
> Magirusstrasse 44       Tel. 0731/93 80 7-21
> 89077 Ulm               http://www.inworks.de
>
>


From EmailCenter at 163.com  Thu Mar 14 14:33:36 2002
From: EmailCenter at 163.com (March 8)
Date: Fri Jan  9 21:46:40 2004
Subject: [mod_python] Pozdravlyaem !!!   March 8 - Sweetness Love  Passion  Happiness  for YOU !!!
Message-ID: <200203140634.g2E6YKs53870@eden.ispol.com>

An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020314/f1e32903/attachment.htm
From barbara.joshua at worldnet.att.net  Sun Mar 17 10:27:54 2002
From: barbara.joshua at worldnet.att.net (Barbara & Joshua Fierer)
Date: Fri Jan  9 21:46:40 2004
Subject: [mod_python] uploading files via forms causes occasional errors
Message-ID: <001e01c1cde1$75fdfd80$096a580c@pavilion>

Hi,

I am trying to upload files HTML forms and mod_python.publisher. I am using the "form"
member of the req object.

Sometimes the upload works fine, just like expected, but then all of a sudden it doesn't work and I get "Internal Server Error".

I am running Apache 1.3.22/mod_python 2.7.6/python 2.1.1 on Redhat 7.1. Below you find the error message from the apache 
errorlog file.

Does anyone know how to fix this ? I really appreciate your help.
thanks.

Stephan Altmueller 


Apache Error log:
=============

[Sat Mar 16 16:44:49 2002] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line 193, in Dispatch
    result = object(req)
[Sat Mar 16 16:44:49 2002] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.1/site-packages/mod_python/publisher.py", line 96, in handler
    fs = util.FieldStorage(req, keep_blank_values=1)
[Sat Mar 16 16:44:49 2002] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.1/site-packages/mod_python/util.py", line 180, in __init__
    file = self.make_file()
[Sat Mar 16 16:44:49 2002] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.1/site-packages/mod_python/util.py", line 207, in make_file
    return tempfile.TemporaryFile("w+b")
[Sat Mar 16 16:44:49 2002] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.1/tempfile.py", line 149, in TemporaryFile
    name = mktemp(suffix)
[Sat Mar 16 16:44:49 2002] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.1/tempfile.py", line 116, in mktemp
    if not os.path.exists(file):
[Sat Mar 16 16:44:49 2002] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.1/posixpath.py", line 171, in exists
    st = os.stat(path)
[Sat Mar 16 16:44:49 2002] [error] PythonHandler mod_python.publisher: OSError: [Errno 2] No such file or directory: '/tmp/@8407.10'

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020317/c0097d26/attachment.htm
From mvolkov at sympatico.ca  Sun Mar 17 13:44:21 2002
From: mvolkov at sympatico.ca (Maxim Volkov)
Date: Fri Jan  9 21:46:40 2004
Subject: [mod_python] Manual ... Installation ... Confusion
Message-ID: <BFEMIAHPFOMFALAEFBKGGENGCAAA.mvolkov@sympatico.ca>

Hello everyone,

Sorry, installation question again.

Is the following statement true :
"Using mod_python you can configure httpd.conf for one and only one script
with .py extension"?
In manual case the file is mptest.py.

If above statement is NOT true can you please give me suggestion about how
httpd.conf or/and mod_python should be modified from mod_python's manual
version :

<Directory /some/directory/htdocs/test>
	AddHandler python-program .py
	PythonHandler mptest
	PythonDebug On
</Directory>

to something more practical?

Yes, I did read manual.
Yes, I do understand how handlers work.
Yes, I paid extra attention to the manual's section 3.2.
Still no luck. Ether only mptest.py runs for all .py files or doesn't work
at all.

My layout: Win2k, Apache 1.3, Python 2.2, mod_python 2.7.6. Mod_python
configured in accordance to the manual (Release 2.7.6).

Or may be mod_python is not really right environment to learn how to use
Python for the Web applications?

Thank you in advance for any suggestions, links or book references.

Maxim Volkov






From bs at wasd.dk  Sun Mar 17 22:53:56 2002
From: bs at wasd.dk (=?iso-8859-1?Q?Bjarke_S=F8rensen?=)
Date: Fri Jan  9 21:46:40 2004
Subject: [mod_python] Manual ... Installation ... Confusion
In-Reply-To: <BFEMIAHPFOMFALAEFBKGGENGCAAA.mvolkov@sympatico.ca>
References: <BFEMIAHPFOMFALAEFBKGGENGCAAA.mvolkov@sympatico.ca>
Message-ID: <32873.80.196.15.227.1016402036.squirrel@wasd.dk>

Maxim Volkov skrev:
> Is the following statement true :
> "Using mod_python you can configure httpd.conf for one and only one
> script with .py extension"?
> In manual case the file is mptest.py.

As I see it you can create Handlers in mod_python, which then serve your
.something files.

I agree  that the manual is a bit unclear.
But installing a 3rd party mod_python like maki made things clearer to me.

> Yes, I do understand how handlers work.

Sure?

mod_python allows Python developers to write modules which plugs into the
Apache webserver, and have access to some of the internals.


> Yes, I paid extra attention to the manual's section 3.2.

I read that 4 times, I first understood after the maki mentioned above.


> Still no luck. Ether only mptest.py runs for all .py files or doesn't
> work at all.

Yup.


> Or may be mod_python is not really right environment to learn how to
> use Python for the Web applications?

mod_snake offers Python embedded in html (? l? php).
(Sorry if that is inapropiate for this list.)

> Thank you in advance for any suggestions, links or book references.

maki: http://maki.sourceforge.net/
mod_snake: http://modsnake.sourceforge.net/

> Maxim Volkov

Any relations? (Sorry, couldn't resist ;)

-- 
+-----------------+
| Bjarke S?rensen |
|  <bs@wasd.dk>   |
| http://wasd.dk/ |
+-----------------+



From jw9 at softhome.net  Mon Mar 18 22:34:07 2002
From: jw9 at softhome.net (jw9@softhome.net)
Date: Fri Jan  9 21:46:40 2004
Subject: [mod_python] Windows 2000 + Apache 1.3.23 + python2.2 + mod_python 2.76, Error
Message-ID: <003e01c1cef6$ed0e2b50$a4c9cd80@laptop>

"""
Syntax error on line 627 of d:/apache group/apache/conf/httpd.conf:
Invalid command 'PythonHandler', perhaps mis-spelled or defined by a module
not included in the server configuration
Note the errors or messages above, and press the <ESC> key to exit.  26...
""
Can anybody help me?

Actually the mod_python.dll I downloaded is for apache 1.3.22,  Could that
be the problem?

My httpd.conf file is attached, just in case.

Thanks!
-------------- next part --------------
A non-text attachment was scrubbed...
Name: httpd.conf
Type: application/octet-stream
Size: 35903 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20020318/c8d356db/httpd.obj
From rien at yeepa.org  Tue Mar 19 19:13:59 2002
From: rien at yeepa.org (Adrien Pisson)
Date: Fri Jan  9 21:46:40 2004
Subject: [mod_python] Windows 2000 + Apache 1.3.23 + python2.2 + mod_python 2.76, Error
References: <003e01c1cef6$ed0e2b50$a4c9cd80@laptop>
Message-ID: <002401c1cf71$d92d18f0$2cee4cd4@RANDOM>

I'm using windows 2000 too.

When i first added the "LoadModule python_module modules/mod_python.dll",
the server complained about not being able to do something i don't remember
with a *.c file.
So i added "AddModule mod_python.c" and even if i don't have any
mod_python.c, it works fine.

In case this do not help in any way, enable the server-info module by
uncommenting the following lines:
LoadModule info_module modules/mod_info.so
AddModule mod_info.c
and all other lines related to server-info (you may have to change the
"Location /server-info" directive to allow it from all) .
Then launch a browser, and type http://localhost/server-info/. From this
page you can look at the modules loaded, and see if mod_python is correctly
installed.

--
rien

ps: btw, it seems there are some many errors in the mod_python manual
concerning windows installation... or the manual is unclear...
i'm not sure of all i say but if anybody as some explanations, they are
welcome. Here it is

- point 1:
  * "Move (or just drag & drop) the mod python-x folder into the Python lib
     folder (i.e C:\ Program Files\ Python\ lib)."
    i'm not sure of it, but i think the mod_python-x folder should be also
    renamed 'mod_python'

  * "Move the files in the folder lib inside the mod python folder (C:\
     Program Files\ Python\ lib\ mod_python-x\ lib\ mod python) to the
     C:\ Program Files\ Python\ lib\ mod_python folder. It's safe to delete
these folders we
     just emptied."
    the first path is incorrect: it's
'...\lib\mod_python-x\python\mod_python\'

- point 2:
  * it talks about adding the LoadModule directive, but on my installation,
i
    had also to add a AddModule directive (i don't really know why...)


From jw9 at softhome.net  Wed Mar 20 01:08:01 2002
From: jw9 at softhome.net (jw9@softhome.net)
Date: Fri Jan  9 21:46:40 2004
Subject: [mod_python] Windows 2000 + Apache 1.3.23 + python2.2 + mod_python 2.76, Error
References: <003e01c1cef6$ed0e2b50$a4c9cd80@laptop> <002401c1cf71$d92d18f0$2cee4cd4@RANDOM>
Message-ID: <002001c1cfd5$97533180$4a00a8c0@laptop>

just put in "AddModule mod_python.c", and it works just fine.

Thanks, Adrien, and maybe somebody should put this into the mod_python
manual.

----- Original Message -----
From: "Adrien Pisson" <rien@yeepa.org>
To: <jw9@softhome.net>; <mod_python@modpython.org>
Sent: Tuesday, March 19, 2002 1:13 PM
Subject: Re: [mod_python] Windows 2000 + Apache 1.3.23 + python2.2 +
mod_python 2.76, Error


> I'm using windows 2000 too.
>
> When i first added the "LoadModule python_module modules/mod_python.dll",
> the server complained about not being able to do something i don't
remember
> with a *.c file.
> So i added "AddModule mod_python.c" and even if i don't have any
> mod_python.c, it works fine.
>
> In case this do not help in any way, enable the server-info module by
> uncommenting the following lines:
> LoadModule info_module modules/mod_info.so
> AddModule mod_info.c
> and all other lines related to server-info (you may have to change the
> "Location /server-info" directive to allow it from all) .
> Then launch a browser, and type http://localhost/server-info/. From this
> page you can look at the modules loaded, and see if mod_python is
correctly
> installed.
>
> --
> rien
>
> ps: btw, it seems there are some many errors in the mod_python manual
> concerning windows installation... or the manual is unclear...
> i'm not sure of all i say but if anybody as some explanations, they are
> welcome. Here it is
>
> - point 1:
>   * "Move (or just drag & drop) the mod python-x folder into the Python
lib
>      folder (i.e C:\ Program Files\ Python\ lib)."
>     i'm not sure of it, but i think the mod_python-x folder should be also
>     renamed 'mod_python'
>
>   * "Move the files in the folder lib inside the mod python folder (C:\
>      Program Files\ Python\ lib\ mod_python-x\ lib\ mod python) to the
>      C:\ Program Files\ Python\ lib\ mod_python folder. It's safe to
delete
> these folders we
>      just emptied."
>     the first path is incorrect: it's
> '...\lib\mod_python-x\python\mod_python\'
>
> - point 2:
>   * it talks about adding the LoadModule directive, but on my
installation,
> i
>     had also to add a AddModule directive (i don't really know why...)
>


From bob at redivi.com  Wed Mar 20 11:12:20 2002
From: bob at redivi.com (Bob Ippolito)
Date: Fri Jan  9 21:46:40 2004
Subject: [mod_python] Compiling on MacOS X
In-Reply-To: <2174778112.1014679254@kelethin>
Message-ID: <41D1077D-3C1D-11D6-9796-0003938210D6@redivi.com>

I have successfully compiled mod_python on MacOS X 10.1.3.  I did it the 
other night bored at the hotel on a business trip, because I didn't have 
net access and wanted to debug some stuff.

I have actually planned on releasing it more properly, but I was having 
issues with metapackages.. anyhow, here you go:

http://redivi.com/~bob/mod_python-2.7.6-osx.dmg.gz

-bob

On Monday, February 25, 2002, at 06:20 PM, Brian Brown wrote:

> Greetings!
>  I am trying to compile mod_python 2.7.6 on MacOS 10.1.3 with no 
> success. I get the following:
>
> cc: cannot specify -o with -c or -S with multiple compilations
>
>
> I tried to take the -c out of the src/Makefile, but it had no effect on 
> the make process... any ideas?
>
> Brian
>
> /-----------------
> Brian Brown
> ICCE Technologies, Inc.
> http://www.icce-t.com
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From bob at redivi.com  Wed Mar 20 11:18:10 2002
From: bob at redivi.com (Bob Ippolito)
Date: Fri Jan  9 21:46:40 2004
Subject: [mod_python] File upload progress indicator
Message-ID: <126119D2-3C1E-11D6-9796-0003938210D6@redivi.com>

I'm developing an application using mod_python and I'd like to include 
file upload progress indication.. However, I don't see any obvious way 
on how do to such a thing.

It's possible in mod_perl, and I've done it before, using 
Apache::Request (see http://httpd.apache.org/apreq/Apache-Request.html)

Is this functionality possible in the current incarnation of mod_python 
or should I write this component in mod_perl or C?

-bob


From bakey at traq.com  Wed Mar 20 10:52:29 2002
From: bakey at traq.com (Brian Akey)
Date: Fri Jan  9 21:46:40 2004
Subject: [mod_python] File upload progress indicator
Message-ID: <780A5D64B1CC9544AB7B702F39219C1E60E0@traqexch.traq.com>

I have a cgi python script that does upload. It should be easy to convert.
#!/usr/bin/python

import cgi
form = cgi.FieldStorage()
print 'Content-type: text/html'
print

if not form:
        print """
        <html><head><title>File Upload</title></head><body>
        <form action"/cgi-bin/file.py" method="POST"
enctype="multipart/form-data">
        <input type="file" name="filename">
        <input type="submit" name="Send_File" value="Send_File">
        </form>
        <p>Please compress the file(s) with Winzip or some other compression

tool before sending the file.
        </body></html>
        """
elif form.has_key("filename"):
        item = form["filename"]
        if item.file:
                data = item.file.read()
                filen = item.filename
                filen1 = filen.split('\\')
                filen2 = filen1[len(filen1)-1]
                #filen2 = 'd.txt'
                open('/www/download/' + filen2 + '.tmp','wb').write(data)
                print """
                <html><head><title>File Upload</title></head><body>
                Thank you for the file
                """
                print cgi.escape(filen2)
                print '</body></html>'

-----Original Message-----
From: Bob Ippolito [mailto:bob@redivi.com]
Sent: Wednesday, March 20, 2002 10:18 AM
To: mod_python@modpython.org
Subject: [mod_python] File upload progress indicator


I'm developing an application using mod_python and I'd like to include 
file upload progress indication.. However, I don't see any obvious way 
on how do to such a thing.

From bob at redivi.com  Wed Mar 20 12:10:28 2002
From: bob at redivi.com (Bob Ippolito)
Date: Fri Jan  9 21:46:40 2004
Subject: [mod_python] File upload progress indicator
In-Reply-To: <780A5D64B1CC9544AB7B702F39219C1E60E0@traqexch.traq.com>
Message-ID: <604E6B08-3C25-11D6-9796-0003938210D6@redivi.com>

Brian,

The problem isn't with file uploading in general, I want to generate 
near-realtime progress indications of the file upload's progress.  Which 
should be possible by examining the Content-length header and making a 
separate connection to the webserver, tracked via a session cookie.  
It's actually really nice to be able to do this asynchronously in Flash 
5.0+ using XML sockets, which I may or may not end up doing.  I'll 
probably open source this component of it since it's really quite 
useful, given that the status bars in IE don't tell you the progress of 
a file upload, only if it's still going or not (and even then, not very 
obviously).

The problem is that when you use FieldStorage, you have already 
processed the file upload.  You don't get callbacks when apache is 
reading.

My client is going to be dealing with large files quite often, and 
although I didn't specify that I was going to provide them this advanced 
functionality, I would like to give it to them anyway as it's really 
nice from a UI standpoint.

-bob

On Wednesday, March 20, 2002, at 11:52 AM, Brian Akey wrote:

> I have a cgi python script that does upload. It should be easy to 
> convert.
> --snip--
>
> -----Original Message-----
> From: Bob Ippolito [mailto:bob@redivi.com]
> Sent: Wednesday, March 20, 2002 10:18 AM
> To: mod_python@modpython.org
> Subject: [mod_python] File upload progress indicator
>
>
> I'm developing an application using mod_python and I'd like to include
> file upload progress indication.. However, I don't see any obvious way
> on how do to such a thing.


From bob at redivi.com  Wed Mar 20 12:36:15 2002
From: bob at redivi.com (Bob Ippolito)
Date: Fri Jan  9 21:46:40 2004
Subject: [mod_python] Compiling on MacOS X
In-Reply-To: <41D1077D-3C1D-11D6-9796-0003938210D6@redivi.com>
Message-ID: <FA803D73-3C28-11D6-9796-0003938210D6@redivi.com>

fyi, I setup a small container page for it and released on 
versiontracker.. prepare for the flood of new osx users of mod_python 
(hopefully) :)

http://redivi.com/~bob/mod_python.html
http://www.versiontracker.com/moreinfo.fcgi?id=14075&db=macosx

-bob

On Wednesday, March 20, 2002, at 11:12 AM, Bob Ippolito wrote:

> I have successfully compiled mod_python on MacOS X 10.1.3.  I did it 
> the other night bored at the hotel on a business trip, because I didn't 
> have net access and wanted to debug some stuff.
>
> I have actually planned on releasing it more properly, but I was having 
> issues with metapackages.. anyhow, here you go:
>
> http://redivi.com/~bob/mod_python-2.7.6-osx.dmg.gz
>
> -bob
>
> On Monday, February 25, 2002, at 06:20 PM, Brian Brown wrote:
>
>> Greetings!
>>  I am trying to compile mod_python 2.7.6 on MacOS 10.1.3 with no 
>> success. I get the following:
>>
>> cc: cannot specify -o with -c or -S with multiple compilations
>>
>>
>> I tried to take the -c out of the src/Makefile, but it had no effect 
>> on the make process... any ideas?
>>
>> Brian
>>
>> /-----------------
>> Brian Brown
>> ICCE Technologies, Inc.
>> http://www.icce-t.com
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://www.modpython.org/mailman/listinfo/mod_python
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From bbrown at icce-t.com  Wed Mar 20 13:31:18 2002
From: bbrown at icce-t.com (Brian Brown)
Date: Fri Jan  9 21:46:40 2004
Subject: [mod_python] Compiling on MacOS X
In-Reply-To: <FA803D73-3C28-11D6-9796-0003938210D6@redivi.com>
References: <FA803D73-3C28-11D6-9796-0003938210D6@redivi.com>
Message-ID: <26200000.1016656278@kelethin.icce-t.com>

--On Wednesday, March 20, 2002 12:36:15 PM -0500 Bob Ippolito 
<bob@redivi.com> wrote:

> fyi, I setup a small container page for it and released on
> versiontracker.. prepare for the flood of new osx users of mod_python
> (hopefully) :)
>

Thanks Bob! You're a lifesaver :)



> http://redivi.com/~bob/mod_python.html
> http://www.versiontracker.com/moreinfo.fcgi?id=14075&db=macosx
>
> -bob
>
> On Wednesday, March 20, 2002, at 11:12 AM, Bob Ippolito wrote:
>
>> I have successfully compiled mod_python on MacOS X 10.1.3.  I did it
>> the other night bored at the hotel on a business trip, because I didn't
>> have net access and wanted to debug some stuff.
>>
>> I have actually planned on releasing it more properly, but I was having
>> issues with metapackages.. anyhow, here you go:
>>
>> http://redivi.com/~bob/mod_python-2.7.6-osx.dmg.gz
>>
>> -bob
>>
>> On Monday, February 25, 2002, at 06:20 PM, Brian Brown wrote:
>>
>>> Greetings!
>>>  I am trying to compile mod_python 2.7.6 on MacOS 10.1.3 with no
>>> success. I get the following:
>>>
>>> cc: cannot specify -o with -c or -S with multiple compilations
>>>
>>>
>>> I tried to take the -c out of the src/Makefile, but it had no effect
>>> on the make process... any ideas?
>>>
>>> Brian
>>>
>>> /-----------------
>>> Brian Brown
>>> ICCE Technologies, Inc.
>>> http://www.icce-t.com
>>> _______________________________________________
>>> Mod_python mailing list
>>> Mod_python@modpython.org
>>> http://www.modpython.org/mailman/listinfo/mod_python
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://www.modpython.org/mailman/listinfo/mod_python
>
>
>

/-----------------
Brian Brown
ICCE Technologies, Inc.
http://www.icce-t.com

From ian at veryfresh.com  Wed Mar 20 17:31:10 2002
From: ian at veryfresh.com (Ian Clelland)
Date: Fri Jan  9 21:46:40 2004
Subject: [mod_python] Problems with GET after POST
Message-ID: <20020321013110.GE1811@fullfactor.com>

I have been experimenting with mod_python to evaluate it for some 
upcoming projects, and I recently came across what appeared to be a bug 
in mod_python.  (After three days of scratching my head over this, the 
solution came to me as I was writing this message, but I'm sending it 
anyway in case someone else comes across this problem. -- Should this 
sort of thing go into the FAQ?)

The problem was essentially that whenever I performed a GET request on 
a URL immediately following a POST request to that same URL, Apache 
would seem to confuse the two requests, and after the GET, I would 
receive an error message like this:

HTTP/1.1 501 Method Not Implemented

key=valueGET to /pytest not supported
Invalid method in request key=valueGET /pytest


Running tcpdump on the communication between the browser and server 
showed that the requests were all well-formed, and there was nothing 
unusual in the headers to suggest that anything but Apache/mod_python 
was at fault.


The simplest script I could produce to replicate the problem was this:

# -------------------------------------------------------------------
import sys
from mod_python import apache

def handler(req):

  if req.method == 'GET':
  
    req.content_type = "text/html"
    req.send_http_header()
    req.write("""<html>
<head>
  <title>python test</title>
</head>
<body>
  <form method=\"post\" action=\"/pytest\">
    <input name=\"key\" value=\"value\"> <input type=\"submit\">
  </form>
</body>
</html>
""")

    return apache.OK

  elif req.method == 'POST':

    req.content_type = "text/html"
    req.send_http_header()
    req.write("""<html>
<head>
  <title>python test part 2</title>
</head>
<body>
  <p>POST successful. <a href=\"/pytest\">Click here</a></p>
</body>
</html>
""")
    return apache.OK

  else:
    return apache.DECLINED
# -------------------------------------------------------------------

It was supported by these Apache configuration directives:

<Location "/pytest">
  SetHandler python-program
  PythonPath "sys.path+['/home/ian/src/pytest']"
  PythonHandler python_test
</Location>


The script is accessable from the virtual URL /pytest, which runs the 
python_test.py module from a non-web-accessable directory. Going to the 
URL /pytest in Mozilla, hitting the submit button, then clicking on the 
'Click here' link brings up the error message.

The problem with this code (as it became apparent to me while writing 
this message) is that the POST handler never actually reads the POST 
data, and so it stays on stdin, and Apache treats it as the beginning 
of the next request. Simply inserting the line 'postdata = req.read()' 
gets rid of the error.

Questions:

Is this the correct behaviour for mod_python? Is it the python module 
writer's responsibility to read all POST data in all situations? What 
if the data is very large (say, a 5MB file when I expected a small text 
field) and I just want to discard it?


Ian
<ian@veryfresh.com>

From charney at charneyday.com  Wed Mar 20 21:34:32 2002
From: charney at charneyday.com (Reginald Charney)
Date: Fri Jan  9 21:46:40 2004
Subject: [mod_python] Installation problems
Message-ID: <200203210536.g2L5akf61316@mail.via.net>

I am unable to get mod_python working on my system. I think I have followed everything needed and documented, but when I enter the following URLs, I get:

/test/mptest.py  - I am asked what program to use to execute this file
/test/mptest      - lists the ASCII source of the file

The following is what I believe is the relevant information from my installation. Any help would be appreciated. TIA.

Reg. Charney

Partial contents of /etc/httpd/httpd.conf
=========================================

    #
    # And for PHP 4.x, use:
    #
    <IfModule mod_php4.c>
    AddType application/x-httpd-php .php
    AddType application/x-httpd-php .php4
    AddType application/x-httpd-php-source .phps
    </IfModule>

    #
    # And for mod_python, use:
    #
    <IfModule mod_python.c>
    AddType application/x-httpd-py .py
    </IfModule>
...
<Directory /usr/local/httpd/htdocs/test>
    AddHandler python-program .py
    PythonHandler mptest
    PythonDebug On
</Directory>


Test file /test/mptest.py
=========================

from mod_python import apache

def handler(req):
        req.send_http_header()
        req.write("hello world!")
        return apache.OK


Output from phpinfo()
=====================
System:		Linux x330-2 2.4.9 #3 SMP Wed Feb 13 15:02:07
Server Root:	/usr/local/httpd
Loaded Modules:	mod_userdir, mod_python, mod_php4, mod_perl, mod_setenvif, mod_unique_id, mod_usertrack, mod_headers, mod_expires, mod_cern_meta, mod_proxy, mod_digest, mod_auth_db, mod_auth_dbm, mod_auth_anon, mod_auth, mod_access, mod_rewrite, mod_alias, mod_speling, mod_actions, mod_imap, mod_asis, mod_cgi, mod_dir, mod_autoindex, mod_include, mod_info, mod_status, mod_negotiation, mod_mime, mod_mime_magic, mod_log_referer, mod_log_agent, mod_log_config, mod_define, mod_env, mod_vhost_alias, mod_mmap_static, mod_so, http_core

PYTHONPATH:	/usr/lib/python2.1:/usr/lib/python2.1/plat-linux2:/usr/lib/python2.1/lib-tk:/usr/lib/python2.1/lib-dynload:/usr/lib/python2.1/site-packages:/usr/lib/apache/lib/python/site-packages

SERVER_SOFTWARE: Apache/1.3.20 (Linux/SuSE) mod_python/2.7.5 Python/2.1.1 PHP/4.0.6 mod_perl/1.26

HTTP_ENV_VARS["PATH"]:	/usr/sbin:/bin:/usr/bin:/sbin:/usr/X11R6/bin 

From jeffstearns at attbi.com  Wed Mar 20 23:50:22 2002
From: jeffstearns at attbi.com (Jeff Stearns)
Date: Fri Jan  9 21:46:40 2004
Subject: [mod_python] Broken reload algorithm?
Message-ID: <4C727568-3CA0-11D6-9CF0-0030653DCC28@attbi.com>

I'm using the publisher handler with mod_python 2.7.6.  I'm doing 
development, so auto-reload is turned on.

This causes broken behavior.  I blame it on line 365 in apache.py:

     # if module is newer - reload
     if (autoreload and (oldmtime < mtime)):
         module = reload(module)

The code here assumes that the module can be found in sys.path. But 
that's not guaranteed when using publisher. The module may be found 
anywhere in the document tree.  Unfortunately, that provokes an 
exception.

I believe that the call to reload() should be replaced with 
imp.load_module(). The imp.load_module function *does* handle reloading, 
and it can be given the path to the module.  Unfortunately, the code 
needs to be reworked to test this theory.

Comments?  Am I missing the point here?

thx - jeff stearns


From ian at veryfresh.com  Thu Mar 21 03:16:59 2002
From: ian at veryfresh.com (Ian Clelland)
Date: Fri Jan  9 21:46:40 2004
Subject: [mod_python] Installation problems
In-Reply-To: <200203210536.g2L5akf61316@mail.via.net>
References: <200203210536.g2L5akf61316@mail.via.net>
Message-ID: <20020321111659.GA8699@fullfactor.com>

I believe that your problems stem from the fact that you are trying to 
use mod_python as if it was a 'traditional' scripting language like PHP 
or ASP.

With either of those languages, you can simply write scripts with the 
appropriate extensions, place them in a web-accessable directory, and 
they're automatically executable.

With mod_python, you are actually writing Apache modules in the python 
language. You need to use Apache directives to configure those modules 
to be activated at the appropriate times.

Depending on how you want to do things, I see two ways to get your test 
script to run:

1) Install the script as a handler. This is the closest to what you are 
   currently doing. The problem is that Python cannot find your module. 
   You can just add the line

     PythonPath "sys.path+['/usr/local/httpd/htdocs/test']"

   to your <Directory> entry, and the module should load.

2) Use the supplied Publisher handler (check the tutorial at 
   www.modpython.org). This is a great hack which allows a single 
   handler to load .py files from anywhere in your site. It appears to 
   be closer to what you intended to do, which is to just run a .py 
   file out of a URL.


I hope that helps clear things up.

A couple of quick points about your original email:

> /test/mptest.py  - I am asked what program to use to execute this file
This is because you have associated a MIME type with the .py extension, 
and Apache doesn't know what to do with it. (The mod_python module 
doesn't deal with MIME types like mod_php). The only thing it can do is 
offer the file for download.

> /test/mptest      - lists the ASCII source of the file
In this case, Apache's content negotiation is finding the best match 
for /mptest and returning that to you as a text document.

>     <IfModule mod_python.c>
>     AddType application/x-httpd-py .py
>     </IfModule>
This section is unnecessary, and should probably be deleted.

> PYTHONPATH:	/usr/lib/python2.1:/usr/lib/python2.1/plat-linux2:
> /usr/lib/python2.1/lib-tk:/usr/lib/python2.1/lib-dynload:/usr/lib/
> python2.1/site-packages:/usr/lib/apache/lib/python/site-packages
This variable shows the locations where Python will look for modules 
when you use an import statement (or a Python*Handler directive). Since 
/usr/local/httpd/htdocs/test is not in the list, Python cannot find 
your mptest module.


Regards,
Ian
<ian@veryfresh.com>

From maynard at mpi-cbg.de  Thu Mar 21 13:15:18 2002
From: maynard at mpi-cbg.de (Gary Maynard)
Date: Fri Jan  9 21:46:41 2004
Subject: [mod_python] persistant variables
In-Reply-To: <20020321111659.GA8699@fullfactor.com>
Message-ID: <NCEILGMPEAMDGEALMLEMKEJFCAAA.maynard@mpi-cbg.de>

Hi,
  I want to know how to store persistant variables in mod_python. I have
written some simple code that works like this:

def handler(req):
        global testthis
        try:
                d = testthis
        except:
                testthis = 1
        req.send_http_header()
        req.write(str(testthis))
        testthis = testthis + 1
        return apache.OK

each time the script is run it should print the last value of testthis and
then increment it.

However, because Apache has several servers running, I end up with several
instances of testhis, one of which gets printed and incremented each time.

How can I force mod_python to only have one instance of the variable? Or
should I be trying to do this in an entirely different way?

I can set Apache to only start with one server (which makes it work),
however it will spawn more servers if it gets two hits at the same time, so
this won't really work.

thanks
Gary




From grisha at modpython.org  Thu Mar 21 09:54:57 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:41 2004
Subject: [mod_python] Installation problems
In-Reply-To: <200203210536.g2L5akf61316@mail.via.net>
Message-ID: <Pine.BSF.4.32.0203210950420.55815-100000@localhost>

Just before sending headers, add a line like this:

        req.content_type = "text/plain"
        req.send_http_header()

and try the url which asks you what program to use, it might just work.
Apache sets different content-types based on your configuration, which can
vary, so sometimes you have to force it to text/plain or text/html.

Grisha


On Wed, 20 Mar 2002, Reginald Charney wrote:

> I am unable to get mod_python working on my system. I think I have followed everything needed and documented, but when I enter the following URLs, I get:
>
> /test/mptest.py  - I am asked what program to use to execute this file
> /test/mptest      - lists the ASCII source of the file
>
> The following is what I believe is the relevant information from my installation. Any help would be appreciated. TIA.
>
> Reg. Charney
>
> Partial contents of /etc/httpd/httpd.conf
> =========================================
>
>     #
>     # And for PHP 4.x, use:
>     #
>     <IfModule mod_php4.c>
>     AddType application/x-httpd-php .php
>     AddType application/x-httpd-php .php4
>     AddType application/x-httpd-php-source .phps
>     </IfModule>
>
>     #
>     # And for mod_python, use:
>     #
>     <IfModule mod_python.c>
>     AddType application/x-httpd-py .py
>     </IfModule>
> ...
> <Directory /usr/local/httpd/htdocs/test>
>     AddHandler python-program .py
>     PythonHandler mptest
>     PythonDebug On
> </Directory>
>
>
> Test file /test/mptest.py
> =========================
>
> from mod_python import apache
>
> def handler(req):
>         req.send_http_header()
>         req.write("hello world!")
>         return apache.OK
>
>
> Output from phpinfo()
> =====================
> System:		Linux x330-2 2.4.9 #3 SMP Wed Feb 13 15:02:07
> Server Root:	/usr/local/httpd
> Loaded Modules:	mod_userdir, mod_python, mod_php4, mod_perl, mod_setenvif, mod_unique_id, mod_usertrack, mod_headers, mod_expires, mod_cern_meta, mod_proxy, mod_digest, mod_auth_db, mod_auth_dbm, mod_auth_anon, mod_auth, mod_access, mod_rewrite, mod_alias, mod_speling, mod_actions, mod_imap, mod_asis, mod_cgi, mod_dir, mod_autoindex, mod_include, mod_info, mod_status, mod_negotiation, mod_mime, mod_mime_magic, mod_log_referer, mod_log_agent, mod_log_config, mod_define, mod_env, mod_vhost_alias, mod_mmap_static, mod_so, http_core
>
> PYTHONPATH:	/usr/lib/python2.1:/usr/lib/python2.1/plat-linux2:/usr/lib/python2.1/lib-tk:/usr/lib/python2.1/lib-dynload:/usr/lib/python2.1/site-packages:/usr/lib/apache/lib/python/site-packages
>
> SERVER_SOFTWARE: Apache/1.3.20 (Linux/SuSE) mod_python/2.7.5 Python/2.1.1 PHP/4.0.6 mod_perl/1.26
>
> HTTP_ENV_VARS["PATH"]:	/usr/sbin:/bin:/usr/bin:/sbin:/usr/X11R6/bin
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From grisha at modpython.org  Thu Mar 21 10:05:09 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:41 2004
Subject: [mod_python] Broken reload algorithm?
In-Reply-To: <4C727568-3CA0-11D6-9CF0-0030653DCC28@attbi.com>
Message-ID: <Pine.BSF.4.32.0203210957210.55815-100000@localhost>

It looks like you're right about this - I looked at the Python code
(Python/import.c) and it seems like it searches the path again for reload.
When I wrote this I was under the impression that Python would just reload
the original file from which the module came.

I'll make a note of this.

My mod_python todo list is just getting so huge...

Grisha


On Wed, 20 Mar 2002, Jeff Stearns wrote:

> I'm using the publisher handler with mod_python 2.7.6.  I'm doing
> development, so auto-reload is turned on.
>
> This causes broken behavior.  I blame it on line 365 in apache.py:
>
>      # if module is newer - reload
>      if (autoreload and (oldmtime < mtime)):
>          module = reload(module)
>
> The code here assumes that the module can be found in sys.path. But
> that's not guaranteed when using publisher. The module may be found
> anywhere in the document tree.  Unfortunately, that provokes an
> exception.
>
> I believe that the call to reload() should be replaced with
> imp.load_module(). The imp.load_module function *does* handle reloading,
> and it can be given the path to the module.  Unfortunately, the code
> needs to be reworked to test this theory.
>
> Comments?  Am I missing the point here?
>
> thx - jeff stearns
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From stony8 at gmx.de  Fri Mar 22 17:18:50 2002
From: stony8 at gmx.de (Alexander Steinert)
Date: Fri Jan  9 21:46:41 2004
Subject: [mod_python] persistant variables
In-Reply-To: <NCEILGMPEAMDGEALMLEMKEJFCAAA.maynard@mpi-cbg.de>; from maynard@mpi-cbg.de on Thu, Mar 21, 2002 at 01:15:18PM +0100
References: <20020321111659.GA8699@fullfactor.com> <NCEILGMPEAMDGEALMLEMKEJFCAAA.maynard@mpi-cbg.de>
Message-ID: <20020322171850.A1049@tyche.svt.tu-harburg.de>

> How can I force mod_python to only have one instance of the variable? Or
> should I be trying to do this in an entirely different way?
> 
> I can set Apache to only start with one server (which makes it work),
> however it will spawn more servers if it gets two hits at the same time, so
> this won't really work.

I thought about this topic a few weeks ago and came to the conclusion
that that you can't force the wished behaviour (if apache is forking).

You need persistent storage in a DBMS or a file and must take care of
concurrent accesses.

HTH

Stony


From ian at veryfresh.com  Fri Mar 22 10:09:59 2002
From: ian at veryfresh.com (Ian Clelland)
Date: Fri Jan  9 21:46:41 2004
Subject: [mod_python] persistant variables
In-Reply-To: <20020322171850.A1049@tyche.svt.tu-harburg.de>
References: <20020321111659.GA8699@fullfactor.com> <NCEILGMPEAMDGEALMLEMKEJFCAAA.maynard@mpi-cbg.de> <20020322171850.A1049@tyche.svt.tu-harburg.de>
Message-ID: <20020322180959.GB9162@fullfactor.com>

On Fri, Mar 22, 2002 at 05:18:50PM +0100, Alexander Steinert wrote:
> > How can I force mod_python to only have one instance of the variable? Or
> > should I be trying to do this in an entirely different way?
> > 
> > I can set Apache to only start with one server (which makes it work),
> > however it will spawn more servers if it gets two hits at the same time, so
> > this won't really work.
> 
> I thought about this topic a few weeks ago and came to the conclusion
> that that you can't force the wished behaviour (if apache is forking).
> 
> You need persistent storage in a DBMS or a file and must take care of
> concurrent accesses.

I've come to the same conclusion myself, after a fair bit of 
experimentation and research (there was a lengthy discussion on this 
list about a year ago: 
http://www.modpython.org/pipermail/mod_python/2001-April/001254.html ).

Because Apache (on Unix) forks new processes for its children, they 
must necessarily run in isolated memory spaces. However, since each 
child process is long-lived, you can retain some persistent data (like 
a database connection handle) between requests /to that child/. It's 
not quite the same thing as global persistent data, but it works for 
some applications.

Apparently mod_perl developers can get around this limitation by using 
the IPC::Shareable module -- has anybody in the Python community done 
any work on something similar?


Ian
<ian@veryfresh.com>

From bakey at traq.com  Fri Mar 22 13:53:47 2002
From: bakey at traq.com (Brian Akey)
Date: Fri Jan  9 21:46:41 2004
Subject: [mod_python] persistant variables
Message-ID: <780A5D64B1CC9544AB7B702F39219C1E60F0@traqexch.traq.com>

Is there a way to leverage the MM library that people compile in for
mod_ssl?

-----Original Message-----
From: Ian Clelland [mailto:ian@veryfresh.com]
Sent: Friday, March 22, 2002 12:10 PM
To: mod_python@modpython.org
Subject: Re: [mod_python] persistant variables


On Fri, Mar 22, 2002 at 05:18:50PM +0100, Alexander Steinert wrote:
> > How can I force mod_python to only have one instance of the variable? Or
> > should I be trying to do this in an entirely different way?
> > 
> > I can set Apache to only start with one server (which makes it work),
> > however it will spawn more servers if it gets two hits at the same time,
so
> > this won't really work.
> 
> I thought about this topic a few weeks ago and came to the conclusion
> that that you can't force the wished behaviour (if apache is forking).
> 
> You need persistent storage in a DBMS or a file and must take care of
> concurrent accesses.

I've come to the same conclusion myself, after a fair bit of 
experimentation and research (there was a lengthy discussion on this 
list about a year ago: 
http://www.modpython.org/pipermail/mod_python/2001-April/001254.html ).

Because Apache (on Unix) forks new processes for its children, they 
must necessarily run in isolated memory spaces. However, since each 
child process is long-lived, you can retain some persistent data (like 
a database connection handle) between requests /to that child/. It's 
not quite the same thing as global persistent data, but it works for 
some applications.

Apparently mod_perl developers can get around this limitation by using 
the IPC::Shareable module -- has anybody in the Python community done 
any work on something similar?


Ian
<ian@veryfresh.com>
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python

From s_lott at yahoo.com  Sat Mar 23 07:53:14 2002
From: s_lott at yahoo.com (Steven Lott)
Date: Fri Jan  9 21:46:41 2004
Subject: [mod_python] (no subject)
Message-ID: <20020323155314.50780.qmail@web9608.mail.yahoo.com>

Context:
Server version: Apache/1.3.20 (Unix)  (Red-Hat/Linux)
Python 2.2 (#2, Mar 23 2002, 07:48:23)
Mod_python 2.7.6

Did a rebuild of Python --without-threads
Did a build of mod_python --with-apxs pointing to my apxs in
/usr/sbin

Start apache with /usr/sbin/httpd -dHAVE_PYTHON

[Sat Mar 23 10:24:42 2002] [warn] Loaded DSO
modules/mod_python.so uses plain Apache 1.3 API, this module
might crash under EAPI! (please recompile it with -DEAPI)

What do I change in the config to include -DEAPI?
Or can I ignore this?




=====
--
S. Lott, CCP :-{)
S_LOTT@YAHOO.COM
http://www.mindspring.com/~slott1
Buccaneer #468: KaDiMa

Macintosh user: drinking upstream from the herd.

__________________________________________________
Do You Yahoo!?
Yahoo! Movies - coverage of the 74th Academy Awards
http://movies.yahoo.com/

From geert at boskant.nl  Sat Mar 23 18:57:30 2002
From: geert at boskant.nl (Geert Jansen)
Date: Fri Jan  9 21:46:41 2004
Subject: [mod_python] (no subject)
In-Reply-To: <20020323155314.50780.qmail@web9608.mail.yahoo.com>
Message-ID: <POEGJAKPNOCGNJMONMFKEEOLCDAA.geert@boskant.nl>

Hello Steven,

I got this error too and some searching with google indicated that this is
not a grave error. Only if mod_python used mod_ssl (mod_ssl uses the
"Extended API" or EAPI of Apache), there would be a problem.

BTW: recompiling with -DEAPI doesn't change one bit

Greet
--
long long email=0X78DC806B91FCA334,i=0,j; main(){j=(email>>4*i)&15;
putchar(j+j/2+j/5-j/12+(j<13?97:-65+7*j));i/15?exit(0):++i,main();}

> -----Original Message-----
> From: mod_python-admin@modpython.org
> [mailto:mod_python-admin@modpython.org]On Behalf Of Steven Lott
> Sent: Saturday, March 23, 2002 4:53 PM
> To: mod_python@modpython.org
> Subject: [mod_python] (no subject)
>
>
> Context:
> Server version: Apache/1.3.20 (Unix)  (Red-Hat/Linux)
> Python 2.2 (#2, Mar 23 2002, 07:48:23)
> Mod_python 2.7.6
>
> Did a rebuild of Python --without-threads
> Did a build of mod_python --with-apxs pointing to my apxs in
> /usr/sbin
>
> Start apache with /usr/sbin/httpd -dHAVE_PYTHON
>
> [Sat Mar 23 10:24:42 2002] [warn] Loaded DSO
> modules/mod_python.so uses plain Apache 1.3 API, this module
> might crash under EAPI! (please recompile it with -DEAPI)
>
> What do I change in the config to include -DEAPI?
> Or can I ignore this?
>
>
>
>
> =====
> --
> S. Lott, CCP :-{)
> S_LOTT@YAHOO.COM
> http://www.mindspring.com/~slott1
> Buccaneer #468: KaDiMa
>
> Macintosh user: drinking upstream from the herd.
>
> __________________________________________________
> Do You Yahoo!?
> Yahoo! Movies - coverage of the 74th Academy Awards.
> http://movies.yahoo.com/
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From bs at wasd.dk  Sun Mar 24 12:04:11 2002
From: bs at wasd.dk (Bjarke =?iso-8859-1?Q?S=F8rensen?=)
Date: Fri Jan  9 21:46:41 2004
Subject: [mod_python] -DEAPI
In-Reply-To: <POEGJAKPNOCGNJMONMFKEEOLCDAA.geert@boskant.nl>
References: <20020323155314.50780.qmail@web9608.mail.yahoo.com> <POEGJAKPNOCGNJMONMFKEEOLCDAA.geert@boskant.nl>
Message-ID: <20020324110411.GA3729@wasd.dk>

On Sat, Mar 23, 2002 at 06:57:30PM +0100, Geert Jansen wrote:
> Hello Steven,
> 
> I got this error too and some searching with google indicated that this is
> not a grave error. Only if mod_python used mod_ssl (mod_ssl uses the
> "Extended API" or EAPI of Apache), there would be a problem.
> 
> BTW: recompiling with -DEAPI doesn't change one bit

Where do you put it?


> > [Sat Mar 23 10:24:42 2002] [warn] Loaded DSO
> > modules/mod_python.so uses plain Apache 1.3 API, this module
> > might crash under EAPI! (please recompile it with -DEAPI)

As I see it, it's apxs that should be given the -DEAPI and you have to do that manually in Makefile.



> > What do I change in the config to include -DEAPI?
> > Or can I ignore this?


I would rather correct it, as it could kill apache threads.



/bs

bs@wasd.dk
http://wasd.dk/

From matt at proweb.co.uk  Tue Mar 26 12:53:06 2002
From: matt at proweb.co.uk (Matt H)
Date: Fri Jan  9 21:46:41 2004
Subject: [mod_python] Please deinstall & rebuild/reinstall Python withWITHOUT_THREADS set.
Message-ID: <20020326125306.4f93066c.matt@proweb.co.uk>

I'm doing a new install in FreeBSd 4.5
I'm getting 

Error: Python installation in /usr/local uses threads. mod_python requires
it to be built without threads. Please deinstall & rebuild/reinstall Python with
WITHOUT_THREADS set.

and yet here's partial output from the python install (blank lines for highlighting)

checking for --with-libs... no
checking for --with-signal-module... yes
checking for --with-dec-threads... no

checking for --with-threads... no

checking if --enable-ipv6 is specified... yes
checking if RFC2553 API is available... yes
checking ipv6 stack type... kame
using libc



oh what to do, I need to get my site back up again!

Matt

From matt at proweb.co.uk  Tue Mar 26 17:50:58 2002
From: matt at proweb.co.uk (Matt H)
Date: Fri Jan  9 21:46:41 2004
Subject: [mod_python] Please deinstall & rebuild  << FIXED
In-Reply-To: <200203261609.g2QG90f03946@lewis.abi.tconline.net>
References: <20020326125306.4f93066c.matt@proweb.co.uk>
	<200203261609.g2QG90f03946@lewis.abi.tconline.net>
Message-ID: <20020326175058.0148020b.matt@proweb.co.uk>

Predictably it was my own fault

Originally I installed from /usr/ports/www/mod_python

which lists python as a dependancy and then proceeds to build and install
it with threads

for the rebuild I hacked the Makefile for python and got it wrong

doh!

thanks to Bob & Lewis for taking the time to star tto help me

it was writing my reply that made me look again and find what I'd done


----

What I generally do is just compile an entirely separate version of 
python, i.e. in /usr/local/apache/python .. I use threaded python for 
everything else, so taking threads out globally isn't really an option 
for me.


I'd be interested to know how to do that

I tried moving /usr/local/lib/python2.2 without success

It would be great if someone could add a faq or howto on having the two
seperate python's installed. 

Dropping thread support kills py-curl for a start, 
I either need both or re-write my stuff that relies on py-curl

I'm definately in love with mod_python

m



From reitz at inworks.de  Tue Mar 26 18:58:42 2002
From: reitz at inworks.de (andre@orion)
Date: Fri Jan  9 21:46:41 2004
Subject: [mod_python] make install
References: <20020326125306.4f93066c.matt@proweb.co.uk><200203261609.g2QG90f03946@lewis.abi.tconline.net> <20020326175058.0148020b.matt@proweb.co.uk>
Message-ID: <018f01c1d4ef$ddc6a560$1900a8c0@venus>

Would it be possible to add a configure option with which python
installation the libs will be compiled / installed....


e.g.:
./configure --with-python-binary=/usr/local/bin/python2.2

The "make install" uses always the python which is found in $PATH.


P.S.: When will the next Release be released?

Greetings, Andre'


From grisha at modpython.org  Tue Mar 26 14:28:26 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:41 2004
Subject: [mod_python] Please deinstall & rebuild/reinstall Python
 withWITHOUT_THREADS set.
In-Reply-To: <20020326125306.4f93066c.matt@proweb.co.uk>
Message-ID: <Pine.BSF.4.32.0203261427560.23911-100000@localhost>

This is in the FAQ.

do "rm config.cache"

Grisha

On Tue, 26 Mar 2002, Matt H wrote:

>
> I'm doing a new install in FreeBSd 4.5
> I'm getting
>
> Error: Python installation in /usr/local uses threads. mod_python requires
> it to be built without threads. Please deinstall & rebuild/reinstall Python with
> WITHOUT_THREADS set.
>
> and yet here's partial output from the python install (blank lines for highlighting)
>
> checking for --with-libs... no
> checking for --with-signal-module... yes
> checking for --with-dec-threads... no
>
> checking for --with-threads... no
>
> checking if --enable-ipv6 is specified... yes
> checking if RFC2553 API is available... yes
> checking ipv6 stack type... kame
> using libc
>
>
>
> oh what to do, I need to get my site back up again!
>
> Matt
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From jasper at objectionable.org  Thu Mar 28 21:06:24 2002
From: jasper at objectionable.org (Jasper Hargreaves)
Date: Fri Jan  9 21:46:41 2004
Subject: [mod_python] invalid command 'PythonHandler'
Message-ID: <3CA385D0.7171.102CC2@localhost>

An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020328/90668ecc/attachment.htm
From grisha at modpython.org  Thu Mar 28 16:36:21 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:41 2004
Subject: [mod_python] invalid command 'PythonHandler'
In-Reply-To: <3CA385D0.7171.102CC2@localhost>
Message-ID: <Pine.BSF.4.32.0203281634250.59245-100000@localhost>

If you're new to Apache, then check the config to make sure it doesn't
have a ClearModuleList directive. If it does, then following it there
should also be an AddModule mod_python.c line somewhere, else the module
is never activated by apache.

Grisha

On Thu, 28 Mar 2002, Jasper Hargreaves wrote:

> I've been trying to get Python scripts working with Apache under Windows.
>
> Running Apache 1.3.22 on Windows2000 Pro (ntfs partition), with
> Version  2.7.6 of ModPython, with Python 2.2 installed in the back, supported by Win32all v146
>
> From a completely clean install of Python & Apache, and following the documentation word for word given for "Windows
> Installation" on the documentation section of the site, it's not giving any joy, giving a
>
> "Invalid command 'PythonHandler', perhaps mis-spelled or defined by a module not included in the server configuration."
>
> when Apache tries to start. I'm new to configuring Apache - so I'm unsure if there's a particular "cgi" section of the
> httpd.conf, or if it's simply covered by the "alias" section.
>
> I've also set file extensions .py to be associated with Python, and added environment variable PYTHONPATH, and PATH to point to
> the python directory.
>
> Any advice?
>
> Many thanks,
> Jasper Hargreaves
> --------------------
> Jasper Hargreaves
> jasper@objectionable.org
> ICQ : 41235322; AIM : cloudyshai
> http://www.objectionable.org
> --------------------
> Information is not knowledge. Knowledge is not wisdom. Wisdom is not truth. Truth is not beauty. Beauty is not love. Love is not
> music. Music is the best. Wisdom is the domain of the Wiz, which is extinct.
> Beauty is a french phoenetic corruption of a short cloth neck ornament currently in resurgence.
>                 -Frank Zappa, "Packard Goose"
> ---------------------
> _______________________________________________ Mod_python mailing list Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From anburger76 at hotmail.com  Sat Mar 30 18:18:48 2002
From: anburger76 at hotmail.com (Tony Burger)
Date: Fri Jan  9 21:46:41 2004
Subject: [mod_python] "openpty" installation problem with Python 2.2.1c2
Message-ID: <F10mRBaYFkuutSgcOrB0000613d@hotmail.com>

An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020330/d7eb1e1c/attachment.htm
From anburger76 at hotmail.com  Sat Mar 30 19:01:14 2002
From: anburger76 at hotmail.com (Tony Burger)
Date: Fri Jan  9 21:46:41 2004
Subject: [mod_python] fixed "openpty" problem with Python 2.2.1c2
Message-ID: <F176GgdKn3khQCaqSGB00019337@hotmail.com>

An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020330/6d58d96a/attachment.htm
From anburger76 at hotmail.com  Sun Mar 31 23:18:27 2002
From: anburger76 at hotmail.com (Tony Burger)
Date: Fri Jan  9 21:46:41 2004
Subject: [mod_python] popen/popen2 usage?
Message-ID: <F68hGtK25DgRbwri5Dp00003dcd@hotmail.com>

An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020331/af96f458/attachment.htm
From conrad at hep.caltech.edu  Sun Mar 31 20:40:27 2002
From: conrad at hep.caltech.edu (Conrad Steenberg)
Date: Fri Jan  9 21:46:41 2004
Subject: [mod_python] popen/popen2 usage?
In-Reply-To: <F68hGtK25DgRbwri5Dp00003dcd@hotmail.com>
References: <F68hGtK25DgRbwri5Dp00003dcd@hotmail.com>
Message-ID: <1017636029.9948.13.camel@Tafelberg.caltech.edu>

On Sun, 2002-03-31 at 20:18, Tony Burger wrote:
I am calling a C executable from within mod_python using the popen2
function imported from os.  I need to get standard output from the C
function and assign it to a mod_python variable which isn't working. The
C function does a basic (void)fprinf(stdout,"%s\n",myVar). I tested the
C function by writing to stderr instead and that works (logged fprintf
output to the Apache error_log). I just can't get any output. Might
anyone know how mod_python handles this function or what it might be
doing? Thanks.

Check whether the stdout of the forked process doesn't get written to
the browser in this case. You need to write to a different file
descriptor. From man popen:
"      Writing to such  a  stream
       writes to the standard input of the command; the command's
       standard output is the same as that of  the  process  that
       called  popen(),  unless  this  is  altered by the command
       itself."

Unless you wanted the child process' output written to the client
browser??

Otherwise doing a pipe() and then a fork() separately should work, e.g.:

  int my_pipe[2]

  pipe(my_pipe);
  child_pid=fork()

  switch (child_pid)
  {  case -1:
              perror ("Error: unable to fork");
              return 0;
              
     case 0: /* the child */
              close(my_pipe[0]); /* close the read end*/

             /* do an exec/execv etc. here */

     default: /* the parent */
              close(my_pipe[1]); /* close the write end */
  }

You may of course have more than one pipe if you want bi-directional
communication: just close the write end in the child and the read end in
the parent of the seconf pipe.

Cheers!

Conrad
_______________________________________________ Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python


From alexis at mobiliant.com  Fri Mar  1 10:57:15 2002
From: alexis at mobiliant.com (=?iso-8859-1?Q?Ulf_Engstr=F6m?=)
Date: Fri Jan  9 21:52:43 2004
Subject: [mod_python] Install on Solaris
Message-ID: <00a701c1c107$791cffc0$4ede14d4@THENEWONE>

Hello :)
I'm having some problems installing on Solaris and I hope that someone could
help me a little. I've been searching the net and I've found many questions
regarding similar problems, but I havn't found a solution that works for me.

Problem is:
/usr/local/apache/> /bin/apachectl start
Syntax error on line 207 of /usr/local/apache/conf/httpd.conf:
Cannot load /usr/local/apache/libexec/mod_python.so into server: ld.so.1:
/usr/local/apache/bin/httpd: fatal: relocation error: file
/usr/local/apache/libexec/mod_python.so: symbol ap_log_error: referenced
symbol not found
/bin/apachectl start: httpd could not be started

(ap_log_error symbol exists in /usr/local/apache/include)

Other information:
> ldd -r /usr/local/apache/libexec/mod_python.so
        libm.so.1 =>     /usr/lib/libm.so.1
        libsocket.so.1 =>        /usr/lib/libsocket.so.1
        libnsl.so.1 =>   /usr/lib/libnsl.so.1
        libdl.so.1 =>    /usr/lib/libdl.so.1
        libc.so.1 =>     /usr/lib/libc.so.1
        libmp.so.2 =>    /usr/lib/libmp.so.2
        /usr/platform/SUNW,Sun-Blade-100/lib/libc_psr.so.1
        symbol not found: ap_log_error
(/usr/local/apache/libexec/mod_python.so)
        symbol not found: ap_log_error
(/usr/local/apache/libexec/mod_python.so)
        symbol not found: ap_log_error
(/usr/local/apache/libexec/mod_python.so)
<snipped many more symbols)

> uname -a
SunOS sol 5.8 Generic_108528-07 sun4u sparc SUNW,Sun-Blade-100

> which gcc
/usr/local/bin/gcc

> gcc -v
Reading specs from /usr/local/lib/gcc-lib/sparc-sun-solaris2.8/3.0.3/specs
Configured with:
../configure --with-as=/usr/local/bin/as --with-ld=/usr/local/bin/ld --enabl
e-libgcj
Thread model: posix
gcc version 3.0.3

> echo $LD_LIBRARY_PATH
/usr/lib:/lib:/usr/local/lib:/usr/local/mysql/lib:/usr/local/lib/

Python version 2.1.1
Apache version 1.3.23

I've also tried static compiling of mod_python, but that gave me the
following error during make of apache
connobject.o(.text+0x5d4): undefined reference to `PyMember_Set'

And many, many other rows of missing references.

Any more information needed, just let me know, I'd be very thankful for
anything that could help me with this:)

Regards
Ulf


From stony8 at gmx.de  Sun Mar  3 14:27:14 2002
From: stony8 at gmx.de (Alexander Steinert)
Date: Fri Jan  9 21:52:44 2004
Subject: [mod_python] Distinguish HTTP and HTTPS
Message-ID: <20020303142714.A9355@tyche.svt.tu-harburg.de>

My application wants to distinguish between requests sent with http and
those sent with https. Is that possible with mod_python? How?

TIA

Stony

From dustin at ywlcs.org  Sun Mar  3 09:28:12 2002
From: dustin at ywlcs.org (Dustin Mitchell)
Date: Fri Jan  9 21:52:44 2004
Subject: [mod_python] Distinguish HTTP and HTTPS
In-Reply-To: <20020303142714.A9355@tyche.svt.tu-harburg.de>
References: <20020303142714.A9355@tyche.svt.tu-harburg.de>
Message-ID: <20020303152812.GT3092@eleanor.internal.ywlcs.org>

Best way I've found to distinguish the two is to look at the port number:

def is_secure(req):
  # This seems the best way to do this
  return req.server.port == 443

Dustin

-- 

  Dustin Mitchell
  dustin@ywlcs.org

From jijang at tronwell.net  Tue Mar  5 16:34:46 2002
From: jijang at tronwell.net (=?ks_c_5601-1987?B?wOXBpMDO?=)
Date: Fri Jan  9 21:52:44 2004
Subject: [mod_python] pyo?
Message-ID: <HOEJLPEAEKDEMPJEOFLKAEDBCAAA.jijang@tronwell.net>

 .py ===> python file
 .pyc ===> python file -> compile
 .pyo ===> what is it?

From L.A.Timochouk at ukc.ac.uk  Tue Mar  5 12:09:45 2002
From: L.A.Timochouk at ukc.ac.uk (Leonid Timochouk)
Date: Fri Jan  9 21:52:44 2004
Subject: [mod_python] pyo?
In-Reply-To: <HOEJLPEAEKDEMPJEOFLKAEDBCAAA.jijang@tronwell.net>
Message-ID: <Pine.GSO.4.43.0203051207420.18140-100000@myrtle.ukc.ac.uk>

That is a Python byte-code file if compiled with optimisation.
If you run a command like

python -O some_file.py

it will produce "some_file.pyo" byte-code file instead of "some_file.pyc".

Leonid Timochouk
University of Kent at Canterbury


From jijang at tronwell.net  Wed Mar  6 12:19:20 2002
From: jijang at tronwell.net (=?ks_c_5601-1987?B?wOXBpMDO?=)
Date: Fri Jan  9 21:52:44 2004
Subject: [mod_python] i know .pyo...
Message-ID: <HOEJLPEAEKDEMPJEOFLKOEDBCAAA.jijang@tronwell.net>

 
 thx...everybody

 however, .pyc make is py_compile.compile()
 how is make .pyo?

From alain at onesite.org  Wed Mar  6 05:21:50 2002
From: alain at onesite.org (Alain Tesio)
Date: Fri Jan  9 21:52:44 2004
Subject: [mod_python] i know .pyo...
In-Reply-To: <HOEJLPEAEKDEMPJEOFLKOEDBCAAA.jijang@tronwell.net>
References: <HOEJLPEAEKDEMPJEOFLKOEDBCAAA.jijang@tronwell.net>
Message-ID: <20020306052150.310d8489.alain@onesite.org>

On Wed, 6 Mar 2002 12:19:20 +0900
 <jijang@tronwell.net> wrote:

>  
>  thx...everybody
> 
>  however, .pyc make is py_compile.compile()
>  how is make .pyo?

With the same command from a python session started
with python -O

Alain

From llsousa at ualg.pt  Wed Mar  6 15:55:55 2002
From: llsousa at ualg.pt (Luis Sousa)
Date: Fri Jan  9 21:52:44 2004
Subject: [mod_python] Not finding handler on public_html
Message-ID: <3C863C0B.2060901@ualg.pt>

Hi everybody

I installed mod_python on apache 1.3.23-1 and everything went OK.
Reading the documentation I tried to test my server writing some simple 
tests. I created a directory in /var/www called test and I haved copeid 
to her the file mptest.py. I changed the configuration of apache 
introducing new lines to that directory, like in the example in 3.2, 
from the documentation.
Everything went OK.

Then I tried to do the same thing but in my home directory, in 
public_html. Here it gave some errors:

Mod_python error: "PythonHandler mptest"

Traceback (most recent call last):

  File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 181, in Dispatch
    module = import_module(module_name, _req)

  File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 335, in import_module
    f, p, d = imp.find_module(parts[i], path)

ImportError: No module named mptest

What could be the problem that I'm having ?

Thanks in advance.

Luis Sousa




From grisha at modpython.org  Wed Mar  6 14:13:57 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:44 2004
Subject: [mod_python] Not finding handler on public_html
In-Reply-To: <3C863C0B.2060901@ualg.pt>
Message-ID: <Pine.BSF.4.32.0203061402330.55328-100000@localhost>

mod_python prepends to sys.path the directory in which the PythonHandler
directive is specified. So if the PythonHandler is at the top level in
your config file, then you have to set the sys.path manually to make sure
Python can find your script. You can do this using the PythonPath
directive.

On Wed, 6 Mar 2002, Luis Sousa wrote:

> Hi everybody
>
> I installed mod_python on apache 1.3.23-1 and everything went OK.
> Reading the documentation I tried to test my server writing some simple
> tests. I created a directory in /var/www called test and I haved copeid
> to her the file mptest.py. I changed the configuration of apache
> introducing new lines to that directory, like in the example in 3.2,
> from the documentation.
> Everything went OK.
>
> Then I tried to do the same thing but in my home directory, in
> public_html. Here it gave some errors:
>
> Mod_python error: "PythonHandler mptest"
>
> Traceback (most recent call last):
>
>   File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 181, in Dispatch
>     module = import_module(module_name, _req)
>
>   File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 335, in import_module
>     f, p, d = imp.find_module(parts[i], path)
>
> ImportError: No module named mptest
>
> What could be the problem that I'm having ?
>
> Thanks in advance.
>
> Luis Sousa
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From llsousa at ualg.pt  Thu Mar  7 09:45:03 2002
From: llsousa at ualg.pt (Luis Sousa)
Date: Fri Jan  9 21:52:44 2004
Subject: [mod_python] Not finding handler on public_html
References: <Pine.BSF.4.32.0203061402330.55328-100000@localhost>
Message-ID: <3C87369F.40100@ualg.pt>

I put this line in the directory definition of /home/llsousa/public_html 
and It's working:
    PythonPath "sys.path+['/home/llsousa/public_html']"

I tried to put in the directory definition /home/*/public_html a line 
like this and did not worked:
    PythonPath "sys.path+['/home/*/public_html']"
to all home public_html.

Is there a simple way to do this ?

Thanks, Luis Sousa


Gregory (Grisha) Trubetskoy wrote:

>mod_python prepends to sys.path the directory in which the PythonHandler
>directive is specified. So if the PythonHandler is at the top level in
>your config file, then you have to set the sys.path manually to make sure
>Python can find your script. You can do this using the PythonPath
>directive.
>
>On Wed, 6 Mar 2002, Luis Sousa wrote:
>
>>Hi everybody
>>
>>I installed mod_python on apache 1.3.23-1 and everything went OK.
>>Reading the documentation I tried to test my server writing some simple
>>tests. I created a directory in /var/www called test and I haved copeid
>>to her the file mptest.py. I changed the configuration of apache
>>introducing new lines to that directory, like in the example in 3.2,
>>from the documentation.
>>Everything went OK.
>>
>>Then I tried to do the same thing but in my home directory, in
>>public_html. Here it gave some errors:
>>
>>Mod_python error: "PythonHandler mptest"
>>
>>Traceback (most recent call last):
>>
>>  File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 181, in Dispatch
>>    module = import_module(module_name, _req)
>>
>>  File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 335, in import_module
>>    f, p, d = imp.find_module(parts[i], path)
>>
>>ImportError: No module named mptest
>>
>>What could be the problem that I'm having ?
>>
>>Thanks in advance.
>>
>>Luis Sousa
>>
>>
>>
>>_______________________________________________
>>Mod_python mailing list
>>Mod_python@modpython.org
>>http://www.modpython.org/mailman/listinfo/mod_python
>>
>
>
>




From alf at proweb.co.uk  Thu Mar  7 11:37:10 2002
From: alf at proweb.co.uk (alf)
Date: Fri Jan  9 21:52:44 2004
Subject: [mod_python] md5 & MySQLdb
Message-ID: <000d01c1c5cc$6c00b330$6501a8c0@fwoom>

Hi,

I'm having a great time with mod_python, it's doing everything I want so far

except this :

I can import most modules re, string, os, sys, even my own modules but for
some reason when I try and import md5 or MySQLdb I get :
ImportError: No module named md5

When I use the python console I get the expected :
Python 2.2 (#1, Feb 12 2002, 21:26:35)
[GCC 2.95.2 19991024 (release)] on freebsd4T
ype "help", "copyright", "credits" or "license" for more information.
>>> from mod_python import apache
Traceback (most recent call last):  File "<stdin>", line 1, in ?
File "/usr/local/lib/python2.2/site-packages/mod_python/apache.py", line 55,
in ?
import _apache
ImportError: No module named _apache
>>> import md5
>>>

I've ended up writing a routine :

def getMD5(txt) :
    md5fn = "/tmp/md5" + `getpid()`
    system("echo -n \"" + txt + "\" | md5 > " + md5fn)
    md5f = open(md5fn)
    md5l = md5f.readlines()
    md5f.close()
    unlink(md5fn)
    return md5l[0]

presumably it's something to do with md5 & MySQLdb being a c external

any solution?

cheers

Matt


From alain at onesite.org  Thu Mar  7 12:55:25 2002
From: alain at onesite.org (Alain Tesio)
Date: Fri Jan  9 21:52:44 2004
Subject: [mod_python] md5 & MySQLdb
In-Reply-To: <000d01c1c5cc$6c00b330$6501a8c0@fwoom>
References: <000d01c1c5cc$6c00b330$6501a8c0@fwoom>
Message-ID: <20020307125525.2ddc81ac.alain@onesite.org>

On Thu, 7 Mar 2002 11:37:10 -0000
"alf" <alf@proweb.co.uk> wrote:

> Hi,
> 
> I'm having a great time with mod_python, it's doing everything I want so far
> 
> except this :
> 
> I can import most modules re, string, os, sys, even my own modules but for
> some reason when I try and import md5 or MySQLdb I get :
> ImportError: No module named md5
> 
> When I use the python console I get the expected :
> Python 2.2 (#1, Feb 12 2002, 21:26:35)
> [GCC 2.95.2 19991024 (release)] on freebsd4T
> ype "help", "copyright", "credits" or "license" for more information.
> >>> from mod_python import apache
> Traceback (most recent call last):  File "<stdin>", line 1, in ?
> File "/usr/local/lib/python2.2/site-packages/mod_python/apache.py", line 55,
> in ?
> import _apache
> ImportError: No module named _apache
> >>> import md5
> >>>
> 
> I've ended up writing a routine :
> 
> def getMD5(txt) :
>     md5fn = "/tmp/md5" + `getpid()`
>     system("echo -n \"" + txt + "\" | md5 > " + md5fn)
>     md5f = open(md5fn)
>     md5l = md5f.readlines()
>     md5f.close()
>     unlink(md5fn)
>     return md5l[0]
> 
> presumably it's something to do with md5 & MySQLdb being a c external
> 
> any solution?
> 
> cheers
> 
> Matt

Hi, I can import MySQLdb fine, maybe you can add the path to the module
in sys.path
Btw in your function, you could also use a pipe instead of a temporary
file.

Alain

From matt at proweb.co.uk  Thu Mar  7 13:03:54 2002
From: matt at proweb.co.uk (Matt H)
Date: Fri Jan  9 21:52:44 2004
Subject: [mod_python] md5 & MySQLdb
References: <000d01c1c5cc$6c00b330$6501a8c0@fwoom> <20020307125525.2ddc81ac.alain@onesite.org>
Message-ID: <008a01c1c5d8$89c85560$6501a8c0@fwoom>

> Hi, I can import MySQLdb fine, maybe you can add the path to the module in
sys.path

Thanks, knowing it was possible made me fix it.

and I've managed to fix them both
MySQLdb was in /usr/local/lib/python2.2/site-packages
and
md5.so was in /usr/local/lib/python2.2/lib-dynload

so I added them to my PythonPath :

PythonPath "['/usr/local/lib/python2.2', '/usr/local/lib/python2.2/site
-packages', '/usr/local/lib/python2.2/lib-dynload', '/www/python']"

and now they import just fine


shame the PythonPath doesn't do subdirectories!

> Btw in your function, you could also use a pipe instead of a temporary
> file.

y thanks. That light came on for me this morning. tbh I figured someone
would tell me how to import md5 and I could scrap the lot so quick and dirty
would do in order to do the proof of concept


From grisha at modpython.org  Thu Mar  7 10:12:00 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:44 2004
Subject: [mod_python] Not finding handler on public_html
In-Reply-To: <3C87369F.40100@ualg.pt>
Message-ID: <Pine.BSF.4.32.0203071009100.67065-100000@localhost>

This is because "*" doesn't mean anything to Python.

One thing you could do is to AllowOverride FileInfo for all your users,
then they could specify their own PythonHandler or PythonPath in an
.htaccess file in their public_html directory.


Grisha

On Thu, 7 Mar 2002, Luis Sousa wrote:

> I put this line in the directory definition of /home/llsousa/public_html
> and It's working:
>     PythonPath "sys.path+['/home/llsousa/public_html']"
>
> I tried to put in the directory definition /home/*/public_html a line
> like this and did not worked:
>     PythonPath "sys.path+['/home/*/public_html']"
> to all home public_html.
>
> Is there a simple way to do this ?
>
> Thanks, Luis Sousa
>
>
> Gregory (Grisha) Trubetskoy wrote:
>
> >mod_python prepends to sys.path the directory in which the PythonHandler
> >directive is specified. So if the PythonHandler is at the top level in
> >your config file, then you have to set the sys.path manually to make sure
> >Python can find your script. You can do this using the PythonPath
> >directive.
> >
> >On Wed, 6 Mar 2002, Luis Sousa wrote:
> >
> >>Hi everybody
> >>
> >>I installed mod_python on apache 1.3.23-1 and everything went OK.
> >>Reading the documentation I tried to test my server writing some simple
> >>tests. I created a directory in /var/www called test and I haved copeid
> >>to her the file mptest.py. I changed the configuration of apache
> >>introducing new lines to that directory, like in the example in 3.2,
> >>from the documentation.
> >>Everything went OK.
> >>
> >>Then I tried to do the same thing but in my home directory, in
> >>public_html. Here it gave some errors:
> >>
> >>Mod_python error: "PythonHandler mptest"
> >>
> >>Traceback (most recent call last):
> >>
> >>  File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 181, in Dispatch
> >>    module = import_module(module_name, _req)
> >>
> >>  File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 335, in import_module
> >>    f, p, d = imp.find_module(parts[i], path)
> >>
> >>ImportError: No module named mptest
> >>
> >>What could be the problem that I'm having ?
> >>
> >>Thanks in advance.
> >>
> >>Luis Sousa
> >>
> >>
> >>
> >>_______________________________________________
> >>Mod_python mailing list
> >>Mod_python@modpython.org
> >>http://www.modpython.org/mailman/listinfo/mod_python
> >>
> >
> >
> >
>
>
>


From rien at yeepa.org  Thu Mar  7 18:45:31 2002
From: rien at yeepa.org (Adrien Pisson)
Date: Fri Jan  9 21:52:44 2004
Subject: [mod_python] Multiple cookies (not writing, but reading...)
Message-ID: <000701c1c5ff$e186ba40$2cee4cd4@RANDOM>

in all the mailing list archive, i've found many posts asking how to set
multiple cookies.
that's right, it's in the manual, use the method add.

but, if i can write multiple cookies, i can't figure out how i can read
multiple cookies from headers_in.
is there any counterparts to add ? (the manual does not mention it, neither
do the source code for table)

thanks.

--
rien



From grisha at modpython.org  Thu Mar  7 13:11:14 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:44 2004
Subject: [mod_python] Multiple cookies (not writing, but reading...)
In-Reply-To: <000701c1c5ff$e186ba40$2cee4cd4@RANDOM>
Message-ID: <Pine.BSF.4.32.0203071309310.68895-100000@localhost>

If headers_in contains multiple keys with the same name, then when you try
to retrieve this key, the result will be a list. That's bascially all
there is to it :)

On Thu, 7 Mar 2002, Adrien Pisson wrote:

> in all the mailing list archive, i've found many posts asking how to set
> multiple cookies.
> that's right, it's in the manual, use the method add.
>
> but, if i can write multiple cookies, i can't figure out how i can read
> multiple cookies from headers_in.
> is there any counterparts to add ? (the manual does not mention it, neither
> do the source code for table)
>
> thanks.
>
> --
> rien
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From llsousa at ualg.pt  Fri Mar  8 09:35:53 2002
From: llsousa at ualg.pt (Luis Sousa)
Date: Fri Jan  9 21:52:44 2004
Subject: [mod_python] [Fwd: Defining classes using mod_python]
Message-ID: <3C8885F9.2000300@ualg.pt>

Where can I find some examples to implement classes using mod_python ?

I'm using the example that is in the documentation in python.org to 
build a class but something is going wrong.

Thanks, Luis Sousa



From matt at proweb.co.uk  Fri Mar  8 09:38:02 2002
From: matt at proweb.co.uk (Matt H)
Date: Fri Jan  9 21:52:44 2004
Subject: [mod_python] [Fwd: Defining classes using mod_python]
In-Reply-To: <3C8885F9.2000300@ualg.pt>
References: <3C8885F9.2000300@ualg.pt>
Message-ID: <20020308093802.450c7dc1.matt@proweb.co.uk>

On Fri, 08 Mar 2002 09:35:53 +0000
"Luis Sousa" <llsousa@ualg.pt> wrote:

> Where can I find some examples to implement classes using mod_python ?
> 
> I'm using the example that is in the documentation in python.org to 
> build a class but something is going wrong.

I can build classes just fine, what's the actual problem?
 
> Thanks, Luis Sousa
>

From llsousa at ualg.pt  Fri Mar  8 10:56:08 2002
From: llsousa at ualg.pt (Luis Sousa)
Date: Fri Jan  9 21:52:44 2004
Subject: [mod_python] [Fwd: Defining classes using mod_python]
References: <3C8885F9.2000300@ualg.pt> <20020308093802.450c7dc1.matt@proweb.co.uk>
Message-ID: <3C8898C8.6000203@ualg.pt>

I know the problem is mine, so there's goes a simple example !

I have two files, one that I used to define a class and other one that 
calls the class:
    - file that defines the class: pessoalWEB.py

                class MyClass:
                    def __init__ (self):
                        self.x = ''
                        self.y = ''

    - file that uses the class: callClassWEB.py
               
                import pessoal

                def testFunc():
                    MyClass = pessoal.MyClass()
                    saida = MyClass.x
                    saida = MyClass.y
                    if saida=='':
                        saida="NULL"
   
                    return saida

I call this file using 
http://machinename/~llsousa/gpessoal/callClassWEB.py/testFunc in my browser.

The definition that I'm using on httpd.conf for this directory in apache is:

<Directory /home/llsousa/public_html/gpessoal>
    AddHandler python-program .py
    PythonHandler mod_python.publisher
    PythonDebug On
    PythonPath "sys.path+['/home/llsousa/public_html/gpessoal']"
</Directory>

The output that I will expect to return was NULL.
The problem is that in the browser, if I make Reload several times, 
sometimes I get what I expect, other times I got this message:

Mod_python error: "PythonHandler mod_python.publisher"

Traceback (most recent call last):

  File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 
193, in Dispatch
    result = object(req)

  File "/usr/lib/python2.1/site-packages/mod_python/publisher.py", line 
171, in handler
    result = apply(object, (), args)

  File "/home/llsousa/public_html/gpessoal/callClassWEB.py", line 6, in 
testFunc
    saida = MyClass.x

AttributeError: MyClass instance has no attribute 'x'

I was suppose to work all the time. Using the same example in python, 
everything went OK !.

What I'm I doing wrong ????

Thanks, Luis Sousa


Matt H wrote:

>On Fri, 08 Mar 2002 09:35:53 +0000
>"Luis Sousa" <llsousa@ualg.pt> wrote:
>
>>Where can I find some examples to implement classes using mod_python ?
>>
>>I'm using the example that is in the documentation in python.org to 
>>build a class but something is going wrong.
>>
>
>I can build classes just fine, what's the actual problem?
> 
>
>>Thanks, Luis Sousa
>>
>
>




From llsousa at ualg.pt  Fri Mar  8 10:59:18 2002
From: llsousa at ualg.pt (Luis Sousa)
Date: Fri Jan  9 21:52:44 2004
Subject: [Fwd: Re: [mod_python] [Fwd: Defining classes using mod_python]]
Message-ID: <3C889986.9050003@ualg.pt>

Where you read import pessoal, should read import pessoalWEB
----------

I know the problem is mine, so there's goes a simple example !

I have two files, one that I used to define a class and other one that 
calls the class:
    - file that defines the class: pessoalWEB.py

                class MyClass:
                    def __init__ (self):
                        self.x = ''
                        self.y = ''

    - file that uses the class: callClassWEB.py
               
                import pessoal

                def testFunc():
                    MyClass = pessoal.MyClass()
                    saida = MyClass.x
                    saida = MyClass.y
                    if saida=='':
                        saida="NULL"
   
                    return saida

I call this file using 
http://machinename/~llsousa/gpessoal/callClassWEB.py/testFunc in my browser.

The definition that I'm using on httpd.conf for this directory in apache is:

<>
    AddHandler python-program .py
    PythonHandler mod_python.publisher
    PythonDebug On
    PythonPath "sys.path+['/home/llsousa/public_html/gpessoal']"


The output that I will expect to return was NULL.
The problem is that in the browser, if I make Reload several times, 
sometimes I get what I expect, other times I got this message:

Mod_python error: "PythonHandler mod_python.publisher"

Traceback (most recent call last):

  File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 
193, in Dispatch
    result = object(req)

  File "/usr/lib/python2.1/site-packages/mod_python/publisher.py", line 
171, in handler
    result = apply(object, (), args)

  File "/home/llsousa/public_html/gpessoal/callClassWEB.py", line 6, in 
testFunc
    saida = MyClass.x

AttributeError: MyClass instance has no attribute 'x'

I was suppose to work all the time. Using the same example in python, 
everything went OK !.

What I'm I doing wrong ????

Thanks, Luis Sousa


Matt H wrote:

>On Fri, 08 Mar 2002 09:35:53 +0000
>"Luis Sousa" < @ualg.pt=""> wrote:
>
>>Where can I find some examples to implement classes using mod_python ?
>>
>>I'm using the example that is in the documentation in python.org to 
>>build a class but something is going wrong.
>>
>
>I can build classes just fine, what's the actual problem?
> 
>
>>Thanks, Luis Sousa
>>
>
>





From matt at proweb.co.uk  Fri Mar  8 10:40:42 2002
From: matt at proweb.co.uk (Matt H)
Date: Fri Jan  9 21:52:44 2004
Subject: [mod_python] [Fwd: Defining classes using mod_python]
In-Reply-To: <3C8898C8.6000203@ualg.pt>
References: <3C8885F9.2000300@ualg.pt>
	<20020308093802.450c7dc1.matt@proweb.co.uk>
	<3C8898C8.6000203@ualg.pt>
Message-ID: <20020308104042.0a1634a2.matt@proweb.co.uk>

On Fr
> 
> I was suppose to work all the time. Using the same example in python, 
> everything went OK !.
> 
> What I'm I doing wrong ????
> 

ah, I don't use mod_python.publisher 

sorry

From llsousa at ualg.pt  Fri Mar  8 11:19:10 2002
From: llsousa at ualg.pt (Luis Sousa)
Date: Fri Jan  9 21:52:44 2004
Subject: [mod_python] [Fwd: Defining classes using mod_python]
References: <3C8885F9.2000300@ualg.pt>	<20020308093802.450c7dc1.matt@proweb.co.uk>	<3C8898C8.6000203@ualg.pt> <20020308104042.0a1634a2.matt@proweb.co.uk>
Message-ID: <3C889E2E.3010002@ualg.pt>

What do you use then ??


Matt H wrote:

>On Fr
>
>>I was suppose to work all the time. Using the same example in python, 
>>everything went OK !.
>>
>>What I'm I doing wrong ????
>>
>
>ah, I don't use mod_python.publisher 
>
>sorry
>
>




From ts1 at cma.co.jp  Fri Mar  8 20:21:14 2002
From: ts1 at cma.co.jp (SONE Takeshi)
Date: Fri Jan  9 21:52:44 2004
Subject: [Fwd: Re: [mod_python] [Fwd: Defining classes using mod_python]]
In-Reply-To: <3C889986.9050003@ualg.pt>
References: <3C889986.9050003@ualg.pt>
Message-ID: <20020308112113.GA3865@cma.co.jp>

On Fri, Mar 08, 2002 at 10:59:18AM +0000, Luis Sousa wrote:
> What I'm I doing wrong ????

Try reloading (restarting) apache.

-- 
Takeshi

From llsousa at ualg.pt  Fri Mar  8 11:25:46 2002
From: llsousa at ualg.pt (Luis Sousa)
Date: Fri Jan  9 21:52:44 2004
Subject: [Fwd: Re: [mod_python] [Fwd: Defining classes using mod_python]]
References: <3C889986.9050003@ualg.pt>
Message-ID: <3C889FBA.1070107@ualg.pt>

> I have two files, one that I used to define a class and other one that 
> calls the class:
>    - file that defines the class: pessoalWEB.py
>
>                class MyClass:
>                    def __init__ (self):
>                        self.x = ''
>                        self.y = ''
>
>    - file that uses the class: callClassWEB.py
>                 import pessoalWEB
>
>                def testFunc():
>                    MyClass = pessoalWEB.MyClass()
>                    saida = MyClass.x
>                    saida = MyClass.y
>                    if saida=='':
>                        saida="NULL"
>                      return saida
>
> I call this file using 
> http://machinename/~llsousa/gpessoal/callClassWEB.py/testFunc in my 
> browser.

I already saw what was the problem. The object. was not well 
initialized. It was MyClass = pessoal.MyClass() instead of MyClass = 
pessoalWEB.MyClass()

But now I notice something strange. When I define saida = MyClass.k it 
gave no error.
Souldn't it gave an error like this: AttributeError: MyClass instance 
has no attribute 'k' ???

Why it doesn't do that ?

Thanks, Luis Sousa


From matt at proweb.co.uk  Fri Mar  8 11:06:10 2002
From: matt at proweb.co.uk (Matt H)
Date: Fri Jan  9 21:52:44 2004
Subject: [mod_python] [Fwd: Defining classes using mod_python]
In-Reply-To: <3C889E2E.3010002@ualg.pt>
References: <3C8885F9.2000300@ualg.pt>
	<20020308093802.450c7dc1.matt@proweb.co.uk>
	<3C8898C8.6000203@ualg.pt>
	<20020308104042.0a1634a2.matt@proweb.co.uk>
	<3C889E2E.3010002@ualg.pt>
Message-ID: <20020308110610.3aeca7e2.matt@proweb.co.uk>

On Fri, 08 Mar 2002 11:19:10 +0000
"Luis Sousa" <llsousa@ualg.pt> wrote:

> What do you use then ??

something like this :
--- httpd.conf ----------
<Directory /www/python>
  AddHandler python-program .py
  PythonHandler contentAdmin
  PythonDebug On
</Directory>
-------------------------



------- contentAdmin.py -

from mod_python import apache
from mod_python import util

def handler(request):
        global req
        req = request
        req.content_type = "text/html"
        req.send_http_header()

        req.write(getTheHTML())
	

        return apache.OK

-------------------------

I also use this inside a <VirtualHost
---------httpd.conf----------------
	<Location /profile>
                AddHandler python-program .py
                PythonAuthenHandler authHandler
                PythonDebug On
	</Location>
----------

(Directory is a class of my own)

---- authHandler.py --
import Directory
import md5

from mod_python import apache
from mod_python import util


def authenhandler(req):
        pwd = req.get_basic_auth_pw()
        usr = req.connection.user
        if pwd and usr :
                d = Directory.Directory("/www/Users/" + usr)
                mdu = d.getLines('md5')
                if mdu[0][:-1] == md5.new(pwd).hexdigest() :
                         return apache.OK
                else :
                         return apache.HTTP_UNAUTHORIZED
        return apache.HTTP_UNAUTHORIZED


-------------------------

From llsousa at ualg.pt  Fri Mar  8 11:46:42 2002
From: llsousa at ualg.pt (Luis Sousa)
Date: Fri Jan  9 21:52:44 2004
Subject: [mod_python] [Fwd: Defining classes using mod_python]
References: <3C8885F9.2000300@ualg.pt>	<20020308093802.450c7dc1.matt@proweb.co.uk>	<3C8898C8.6000203@ualg.pt>	<20020308104042.0a1634a2.matt@proweb.co.uk>	<3C889E2E.3010002@ualg.pt> <20020308110610.3aeca7e2.matt@proweb.co.uk>
Message-ID: <3C88A4A2.8010809@ualg.pt>

But in this way, there's only an handler for that directory, is that 
correct ?
Suppose that I want to have more than one handler in that directory, for 
my organization

Why do you use a virtual host ? That I didn't get it !!!!


Matt H wrote:

>On Fri, 08 Mar 2002 11:19:10 +0000
>"Luis Sousa" <llsousa@ualg.pt> wrote:
>
>>What do you use then ??
>>
>
>something like this :
>--- httpd.conf ----------
><Directory /www/python>
>  AddHandler python-program .py
>  PythonHandler contentAdmin
>  PythonDebug On
></Directory>
>-------------------------
>
>
>
>------- contentAdmin.py -
>
>from mod_python import apache
>from mod_python import util
>
>def handler(request):
>        global req
>        req = request
>        req.content_type = "text/html"
>        req.send_http_header()
>
>        req.write(getTheHTML())
>	
>
>        return apache.OK
>
>-------------------------
>
>I also use this inside a <VirtualHost
>---------httpd.conf----------------
>	<Location /profile>
>                AddHandler python-program .py
>                PythonAuthenHandler authHandler
>                PythonDebug On
>	</Location>
>----------
>
>(Directory is a class of my own)
>
>---- authHandler.py --
>import Directory
>import md5
>
>from mod_python import apache
>from mod_python import util
>
>
>def authenhandler(req):
>        pwd = req.get_basic_auth_pw()
>        usr = req.connection.user
>        if pwd and usr :
>                d = Directory.Directory("/www/Users/" + usr)
>                mdu = d.getLines('md5')
>                if mdu[0][:-1] == md5.new(pwd).hexdigest() :
>                         return apache.OK
>                else :
>                         return apache.HTTP_UNAUTHORIZED
>        return apache.HTTP_UNAUTHORIZED
>
>
>-------------------------
>
>




From matt at proweb.co.uk  Fri Mar  8 11:48:20 2002
From: matt at proweb.co.uk (Matt H)
Date: Fri Jan  9 21:52:44 2004
Subject: [mod_python] [Fwd: Defining classes using mod_python]
In-Reply-To: <3C88A4A2.8010809@ualg.pt>
References: <3C8885F9.2000300@ualg.pt>
	<20020308093802.450c7dc1.matt@proweb.co.uk>
	<3C8898C8.6000203@ualg.pt>
	<20020308104042.0a1634a2.matt@proweb.co.uk>
	<3C889E2E.3010002@ualg.pt>
	<20020308110610.3aeca7e2.matt@proweb.co.uk>
	<3C88A4A2.8010809@ualg.pt>
Message-ID: <20020308114820.5c359c46.matt@proweb.co.uk>

On Fri, 08 Mar 2002 11:46:42 +0000
"Luis Sousa" <llsousa@ualg.pt> wrote:

> But in this way, there's only an handler for that directory, is that 
> correct ?
> Suppose that I want to have more than one handler in that directory, for
> my organization
> 
> Why do you use a virtual host ? That I didn't get it !!!!
> 

I should have pointed out that /www/python is aliased as my cgi-bin

The bit in the virtual host is just for HTTP authentication of that
particular directory


My setup is probably not correct for all setups. 
I'm the only user so I have a tendancy to do what works today :)

From grisha at modpython.org  Fri Mar  8 10:26:18 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:44 2004
Subject: [Fwd: Re: [mod_python] [Fwd: Defining classes using mod_python]]
In-Reply-To: <3C889FBA.1070107@ualg.pt>
Message-ID: <Pine.BSF.4.32.0203081022130.79915-100000@localhost>

This is probably because you're chaning pessoalWEB but the Python
interpreter ignores those changes because the pessoalWEB module is already
imported. You need to reload pessoalWEB or restart apache. There is a note
about that in the FAQ:

http://www.modpython.org/FAQ/faqw.py?req=all#3.1

P.S. There is nothing wrong with the publisher handler, it should work for
you just fine.

Grisha


On Fri, 8 Mar 2002, Luis Sousa wrote:

> > I have two files, one that I used to define a class and other one that
> > calls the class:
> >    - file that defines the class: pessoalWEB.py
> >
> >                class MyClass:
> >                    def __init__ (self):
> >                        self.x = ''
> >                        self.y = ''
> >
> >    - file that uses the class: callClassWEB.py
> >                 import pessoalWEB
> >
> >                def testFunc():
> >                    MyClass = pessoalWEB.MyClass()
> >                    saida = MyClass.x
> >                    saida = MyClass.y
> >                    if saida=='':
> >                        saida="NULL"
> >                      return saida
> >
> > I call this file using
> > http://machinename/~llsousa/gpessoal/callClassWEB.py/testFunc in my
> > browser.
>
> I already saw what was the problem. The object. was not well
> initialized. It was MyClass = pessoal.MyClass() instead of MyClass =
> pessoalWEB.MyClass()
>
> But now I notice something strange. When I define saida = MyClass.k it
> gave no error.
> Souldn't it gave an error like this: AttributeError: MyClass instance
> has no attribute 'k' ???
>
> Why it doesn't do that ?
>
> Thanks, Luis Sousa
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From llsousa at ualg.pt  Fri Mar  8 16:22:54 2002
From: llsousa at ualg.pt (Luis Sousa)
Date: Fri Jan  9 21:52:44 2004
Subject: [Fwd: Re: [mod_python] [Fwd: Defining classes using mod_python]]
References: <Pine.BSF.4.32.0203081022130.79915-100000@localhost>
Message-ID: <3C88E55E.2030605@ualg.pt>

I tried the sugestion that you gave me but it still working without 
giving me an error !!!
I tried putting the PythonHandler in apache directly to file and it gave 
me the error that I was expecting.

Probably it's some problem in my configuration, or something else !!!
What could it be ?

Luis Sousa

Gregory (Grisha) Trubetskoy wrote:

>This is probably because you're chaning pessoalWEB but the Python
>interpreter ignores those changes because the pessoalWEB module is already
>imported. You need to reload pessoalWEB or restart apache. There is a note
>about that in the FAQ:
>
>http://www.modpython.org/FAQ/faqw.py?req=all#3.1
>
>P.S. There is nothing wrong with the publisher handler, it should work for
>you just fine.
>
>Grisha
>
>
>On Fri, 8 Mar 2002, Luis Sousa wrote:
>
>>>I have two files, one that I used to define a class and other one that
>>>calls the class:
>>>   - file that defines the class: pessoalWEB.py
>>>
>>>               class MyClass:
>>>                   def __init__ (self):
>>>                       self.x = ''
>>>                       self.y = ''
>>>
>>>   - file that uses the class: callClassWEB.py
>>>                import pessoalWEB
>>>
>>>               def testFunc():
>>>                   MyClass = pessoalWEB.MyClass()
>>>                   saida = MyClass.x
>>>                   saida = MyClass.y
>>>                   if saida=='':
>>>                       saida="NULL"
>>>                     return saida
>>>
>>>I call this file using
>>>http://machinename/~llsousa/gpessoal/callClassWEB.py/testFunc in my
>>>browser.
>>>
>>I already saw what was the problem. The object. was not well
>>initialized. It was MyClass = pessoal.MyClass() instead of MyClass =
>>pessoalWEB.MyClass()
>>
>>But now I notice something strange. When I define saida = MyClass.k it
>>gave no error.
>>Souldn't it gave an error like this: AttributeError: MyClass instance
>>has no attribute 'k' ???
>>
>>Why it doesn't do that ?
>>
>>Thanks, Luis Sousa
>>
>>_______________________________________________
>>Mod_python mailing list
>>Mod_python@modpython.org
>>http://www.modpython.org/mailman/listinfo/mod_python
>>
>
>
>




From reitz at inworks.de  Mon Mar 11 19:19:04 2002
From: reitz at inworks.de (Andre Reitz)
Date: Fri Jan  9 21:52:45 2004
Subject: [mod_python] BUG IN cgihandler / setup_cgi
Message-ID: <3C8CF518.FCBFD053@inworks.de>

def setup_cgi(req):
    """
    Replace sys.stdin and stdout with an objects that read/write to
    the socket, as well as substitute the os.environ.
    Returns (environ, stdin, stdout) which you must save and then use
    with restore_nocgi().
    """

    # save env
    env = os.environ.copy() <<<< 1 !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

    si = sys.stdin
    so = sys.stdout

    env = build_cgi_env(req) <<<<< 2 !!!!!!!!!!!!!!!!!!!

    for k in env.keys():
        os.environ[k] = env[k]

    sys.stdout = CGIStdout(req)
    sys.stdin = CGIStdin(req)

    sys.argv = [] # keeps cgi.py happy

    return env, si, so <<<< 3 !!!!!!!!!!!!!!!!!!!!!!!!!


- The env (1) perhaps should be called originalenv
- (2) keep as is
- (3) change to: return originalenv, si, so


Will somebody patch it?

This can cause critical bugs!

Greetings, Andre'

--
_____________________________________________
inworks GmbH            Andre Reitz
Magirusstrasse 44       Tel. 0731/93 80 7-21
89077 Ulm               http://www.inworks.de

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020311/a753796f/attachment-0001.htm
From reitz at inworks.de  Mon Mar 11 19:26:28 2002
From: reitz at inworks.de (Andre Reitz)
Date: Fri Jan  9 21:52:45 2004
Subject: [mod_python] Several Python Installations
Message-ID: <3C8CF6D3.469BA1C2@inworks.de>

I have two python installations on a single machine:

    /usr/bin/python2.1 (with threads, SuSE rpm installation)

and

    /opt/inworks/bin/python2.1   (no threads for mod_python)


Anything compiled good.

mod_python - libs are only installed in
    /opt/inworks/lib/python2.1/site-packages/mod_python

Anything works fine.

BUT: if there is a symbolic link:
  /usr/bin/python -> /usr/bin/python2.1
then mod_python tries to import mod_python.apache from
/usr/lib/python2.1/site-packages and fails.

if I delete  the symbolic link /usr/bin/python and
restart apache anything is good again.


WHY DOES IT BEHAVE LIKE THIS? is it a problem of libpython???

Thank you very much in advance.

--
_____________________________________________
inworks GmbH            Andre Reitz
Magirusstrasse 44       Tel. 0731/93 80 7-21
89077 Ulm               http://www.inworks.de

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020311/c623a917/attachment-0001.htm
From grisha at modpython.org  Mon Mar 11 14:13:19 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:45 2004
Subject: [mod_python] BUG IN cgihandler / setup_cgi
In-Reply-To: <3C8CF518.FCBFD053@inworks.de>
Message-ID: <Pine.BSF.4.32.0203111411110.20785-100000@localhost>

This is clearly a booboo, thanks Andre for pointing it out. I'll make sure
to patch it up in cvs.

On Mon, 11 Mar 2002, Andre Reitz wrote:

> def setup_cgi(req):
>     """
>     Replace sys.stdin and stdout with an objects that read/write to
>     the socket, as well as substitute the os.environ.
>     Returns (environ, stdin, stdout) which you must save and then use
>     with restore_nocgi().
>     """
>
>     # save env
>     env = os.environ.copy() <<<< 1 !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
>
>     si = sys.stdin
>     so = sys.stdout
>
>     env = build_cgi_env(req) <<<<< 2 !!!!!!!!!!!!!!!!!!!
>
>     for k in env.keys():
>         os.environ[k] = env[k]
>
>     sys.stdout = CGIStdout(req)
>     sys.stdin = CGIStdin(req)
>
>     sys.argv = [] # keeps cgi.py happy
>
>     return env, si, so <<<< 3 !!!!!!!!!!!!!!!!!!!!!!!!!
>
>
> - The env (1) perhaps should be called originalenv
> - (2) keep as is
> - (3) change to: return originalenv, si, so
>
>
> Will somebody patch it?
>
> This can cause critical bugs!
>
> Greetings, Andre'
>
> --
> _____________________________________________
> inworks GmbH            Andre Reitz
> Magirusstrasse 44       Tel. 0731/93 80 7-21
> 89077 Ulm               http://www.inworks.de
>
>


From grisha at modpython.org  Mon Mar 11 14:15:22 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:45 2004
Subject: [mod_python] Several Python Installations
In-Reply-To: <3C8CF6D3.469BA1C2@inworks.de>
Message-ID: <Pine.BSF.4.32.0203111414160.20785-100000@localhost>

I don't believe mod_python does anything with those, so its probably
something in libpython..

On Mon, 11 Mar 2002, Andre Reitz wrote:

> I have two python installations on a single machine:
>
>     /usr/bin/python2.1 (with threads, SuSE rpm installation)
>
> and
>
>     /opt/inworks/bin/python2.1   (no threads for mod_python)
>
>
> Anything compiled good.
>
> mod_python - libs are only installed in
>     /opt/inworks/lib/python2.1/site-packages/mod_python
>
> Anything works fine.
>
> BUT: if there is a symbolic link:
>   /usr/bin/python -> /usr/bin/python2.1
> then mod_python tries to import mod_python.apache from
> /usr/lib/python2.1/site-packages and fails.
>
> if I delete  the symbolic link /usr/bin/python and
> restart apache anything is good again.
>
>
> WHY DOES IT BEHAVE LIKE THIS? is it a problem of libpython???
>
> Thank you very much in advance.
>
> --
> _____________________________________________
> inworks GmbH            Andre Reitz
> Magirusstrasse 44       Tel. 0731/93 80 7-21
> 89077 Ulm               http://www.inworks.de
>
>


From EmailCenter at 163.com  Thu Mar 14 14:33:36 2002
From: EmailCenter at 163.com (March 8)
Date: Fri Jan  9 21:52:45 2004
Subject: [mod_python] Pozdravlyaem !!!   March 8 - Sweetness Love  Passion  Happiness  for YOU !!!
Message-ID: <200203140634.g2E6YKs53870@eden.ispol.com>

An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020314/f1e32903/attachment-0001.htm
From barbara.joshua at worldnet.att.net  Sun Mar 17 10:27:54 2002
From: barbara.joshua at worldnet.att.net (Barbara & Joshua Fierer)
Date: Fri Jan  9 21:52:45 2004
Subject: [mod_python] uploading files via forms causes occasional errors
Message-ID: <001e01c1cde1$75fdfd80$096a580c@pavilion>

Hi,

I am trying to upload files HTML forms and mod_python.publisher. I am using the "form"
member of the req object.

Sometimes the upload works fine, just like expected, but then all of a sudden it doesn't work and I get "Internal Server Error".

I am running Apache 1.3.22/mod_python 2.7.6/python 2.1.1 on Redhat 7.1. Below you find the error message from the apache 
errorlog file.

Does anyone know how to fix this ? I really appreciate your help.
thanks.

Stephan Altmueller 


Apache Error log:
=============

[Sat Mar 16 16:44:49 2002] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line 193, in Dispatch
    result = object(req)
[Sat Mar 16 16:44:49 2002] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.1/site-packages/mod_python/publisher.py", line 96, in handler
    fs = util.FieldStorage(req, keep_blank_values=1)
[Sat Mar 16 16:44:49 2002] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.1/site-packages/mod_python/util.py", line 180, in __init__
    file = self.make_file()
[Sat Mar 16 16:44:49 2002] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.1/site-packages/mod_python/util.py", line 207, in make_file
    return tempfile.TemporaryFile("w+b")
[Sat Mar 16 16:44:49 2002] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.1/tempfile.py", line 149, in TemporaryFile
    name = mktemp(suffix)
[Sat Mar 16 16:44:49 2002] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.1/tempfile.py", line 116, in mktemp
    if not os.path.exists(file):
[Sat Mar 16 16:44:49 2002] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.1/posixpath.py", line 171, in exists
    st = os.stat(path)
[Sat Mar 16 16:44:49 2002] [error] PythonHandler mod_python.publisher: OSError: [Errno 2] No such file or directory: '/tmp/@8407.10'

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020317/c0097d26/attachment-0001.htm
From mvolkov at sympatico.ca  Sun Mar 17 13:44:21 2002
From: mvolkov at sympatico.ca (Maxim Volkov)
Date: Fri Jan  9 21:52:45 2004
Subject: [mod_python] Manual ... Installation ... Confusion
Message-ID: <BFEMIAHPFOMFALAEFBKGGENGCAAA.mvolkov@sympatico.ca>

Hello everyone,

Sorry, installation question again.

Is the following statement true :
"Using mod_python you can configure httpd.conf for one and only one script
with .py extension"?
In manual case the file is mptest.py.

If above statement is NOT true can you please give me suggestion about how
httpd.conf or/and mod_python should be modified from mod_python's manual
version :

<Directory /some/directory/htdocs/test>
	AddHandler python-program .py
	PythonHandler mptest
	PythonDebug On
</Directory>

to something more practical?

Yes, I did read manual.
Yes, I do understand how handlers work.
Yes, I paid extra attention to the manual's section 3.2.
Still no luck. Ether only mptest.py runs for all .py files or doesn't work
at all.

My layout: Win2k, Apache 1.3, Python 2.2, mod_python 2.7.6. Mod_python
configured in accordance to the manual (Release 2.7.6).

Or may be mod_python is not really right environment to learn how to use
Python for the Web applications?

Thank you in advance for any suggestions, links or book references.

Maxim Volkov






From bs at wasd.dk  Sun Mar 17 22:53:56 2002
From: bs at wasd.dk (=?iso-8859-1?Q?Bjarke_S=F8rensen?=)
Date: Fri Jan  9 21:52:45 2004
Subject: [mod_python] Manual ... Installation ... Confusion
In-Reply-To: <BFEMIAHPFOMFALAEFBKGGENGCAAA.mvolkov@sympatico.ca>
References: <BFEMIAHPFOMFALAEFBKGGENGCAAA.mvolkov@sympatico.ca>
Message-ID: <32873.80.196.15.227.1016402036.squirrel@wasd.dk>

Maxim Volkov skrev:
> Is the following statement true :
> "Using mod_python you can configure httpd.conf for one and only one
> script with .py extension"?
> In manual case the file is mptest.py.

As I see it you can create Handlers in mod_python, which then serve your
.something files.

I agree  that the manual is a bit unclear.
But installing a 3rd party mod_python like maki made things clearer to me.

> Yes, I do understand how handlers work.

Sure?

mod_python allows Python developers to write modules which plugs into the
Apache webserver, and have access to some of the internals.


> Yes, I paid extra attention to the manual's section 3.2.

I read that 4 times, I first understood after the maki mentioned above.


> Still no luck. Ether only mptest.py runs for all .py files or doesn't
> work at all.

Yup.


> Or may be mod_python is not really right environment to learn how to
> use Python for the Web applications?

mod_snake offers Python embedded in html (? l? php).
(Sorry if that is inapropiate for this list.)

> Thank you in advance for any suggestions, links or book references.

maki: http://maki.sourceforge.net/
mod_snake: http://modsnake.sourceforge.net/

> Maxim Volkov

Any relations? (Sorry, couldn't resist ;)

-- 
+-----------------+
| Bjarke S?rensen |
|  <bs@wasd.dk>   |
| http://wasd.dk/ |
+-----------------+



From jw9 at softhome.net  Mon Mar 18 22:34:07 2002
From: jw9 at softhome.net (jw9@softhome.net)
Date: Fri Jan  9 21:52:45 2004
Subject: [mod_python] Windows 2000 + Apache 1.3.23 + python2.2 + mod_python 2.76, Error
Message-ID: <003e01c1cef6$ed0e2b50$a4c9cd80@laptop>

"""
Syntax error on line 627 of d:/apache group/apache/conf/httpd.conf:
Invalid command 'PythonHandler', perhaps mis-spelled or defined by a module
not included in the server configuration
Note the errors or messages above, and press the <ESC> key to exit.  26...
""
Can anybody help me?

Actually the mod_python.dll I downloaded is for apache 1.3.22,  Could that
be the problem?

My httpd.conf file is attached, just in case.

Thanks!
-------------- next part --------------
A non-text attachment was scrubbed...
Name: httpd.conf
Type: application/octet-stream
Size: 35903 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20020318/c8d356db/httpd-0001.obj
From rien at yeepa.org  Tue Mar 19 19:13:59 2002
From: rien at yeepa.org (Adrien Pisson)
Date: Fri Jan  9 21:52:45 2004
Subject: [mod_python] Windows 2000 + Apache 1.3.23 + python2.2 + mod_python 2.76, Error
References: <003e01c1cef6$ed0e2b50$a4c9cd80@laptop>
Message-ID: <002401c1cf71$d92d18f0$2cee4cd4@RANDOM>

I'm using windows 2000 too.

When i first added the "LoadModule python_module modules/mod_python.dll",
the server complained about not being able to do something i don't remember
with a *.c file.
So i added "AddModule mod_python.c" and even if i don't have any
mod_python.c, it works fine.

In case this do not help in any way, enable the server-info module by
uncommenting the following lines:
LoadModule info_module modules/mod_info.so
AddModule mod_info.c
and all other lines related to server-info (you may have to change the
"Location /server-info" directive to allow it from all) .
Then launch a browser, and type http://localhost/server-info/. From this
page you can look at the modules loaded, and see if mod_python is correctly
installed.

--
rien

ps: btw, it seems there are some many errors in the mod_python manual
concerning windows installation... or the manual is unclear...
i'm not sure of all i say but if anybody as some explanations, they are
welcome. Here it is

- point 1:
  * "Move (or just drag & drop) the mod python-x folder into the Python lib
     folder (i.e C:\ Program Files\ Python\ lib)."
    i'm not sure of it, but i think the mod_python-x folder should be also
    renamed 'mod_python'

  * "Move the files in the folder lib inside the mod python folder (C:\
     Program Files\ Python\ lib\ mod_python-x\ lib\ mod python) to the
     C:\ Program Files\ Python\ lib\ mod_python folder. It's safe to delete
these folders we
     just emptied."
    the first path is incorrect: it's
'...\lib\mod_python-x\python\mod_python\'

- point 2:
  * it talks about adding the LoadModule directive, but on my installation,
i
    had also to add a AddModule directive (i don't really know why...)


From jw9 at softhome.net  Wed Mar 20 01:08:01 2002
From: jw9 at softhome.net (jw9@softhome.net)
Date: Fri Jan  9 21:52:45 2004
Subject: [mod_python] Windows 2000 + Apache 1.3.23 + python2.2 + mod_python 2.76, Error
References: <003e01c1cef6$ed0e2b50$a4c9cd80@laptop> <002401c1cf71$d92d18f0$2cee4cd4@RANDOM>
Message-ID: <002001c1cfd5$97533180$4a00a8c0@laptop>

just put in "AddModule mod_python.c", and it works just fine.

Thanks, Adrien, and maybe somebody should put this into the mod_python
manual.

----- Original Message -----
From: "Adrien Pisson" <rien@yeepa.org>
To: <jw9@softhome.net>; <mod_python@modpython.org>
Sent: Tuesday, March 19, 2002 1:13 PM
Subject: Re: [mod_python] Windows 2000 + Apache 1.3.23 + python2.2 +
mod_python 2.76, Error


> I'm using windows 2000 too.
>
> When i first added the "LoadModule python_module modules/mod_python.dll",
> the server complained about not being able to do something i don't
remember
> with a *.c file.
> So i added "AddModule mod_python.c" and even if i don't have any
> mod_python.c, it works fine.
>
> In case this do not help in any way, enable the server-info module by
> uncommenting the following lines:
> LoadModule info_module modules/mod_info.so
> AddModule mod_info.c
> and all other lines related to server-info (you may have to change the
> "Location /server-info" directive to allow it from all) .
> Then launch a browser, and type http://localhost/server-info/. From this
> page you can look at the modules loaded, and see if mod_python is
correctly
> installed.
>
> --
> rien
>
> ps: btw, it seems there are some many errors in the mod_python manual
> concerning windows installation... or the manual is unclear...
> i'm not sure of all i say but if anybody as some explanations, they are
> welcome. Here it is
>
> - point 1:
>   * "Move (or just drag & drop) the mod python-x folder into the Python
lib
>      folder (i.e C:\ Program Files\ Python\ lib)."
>     i'm not sure of it, but i think the mod_python-x folder should be also
>     renamed 'mod_python'
>
>   * "Move the files in the folder lib inside the mod python folder (C:\
>      Program Files\ Python\ lib\ mod_python-x\ lib\ mod python) to the
>      C:\ Program Files\ Python\ lib\ mod_python folder. It's safe to
delete
> these folders we
>      just emptied."
>     the first path is incorrect: it's
> '...\lib\mod_python-x\python\mod_python\'
>
> - point 2:
>   * it talks about adding the LoadModule directive, but on my
installation,
> i
>     had also to add a AddModule directive (i don't really know why...)
>


From bob at redivi.com  Wed Mar 20 11:12:20 2002
From: bob at redivi.com (Bob Ippolito)
Date: Fri Jan  9 21:52:45 2004
Subject: [mod_python] Compiling on MacOS X
In-Reply-To: <2174778112.1014679254@kelethin>
Message-ID: <41D1077D-3C1D-11D6-9796-0003938210D6@redivi.com>

I have successfully compiled mod_python on MacOS X 10.1.3.  I did it the 
other night bored at the hotel on a business trip, because I didn't have 
net access and wanted to debug some stuff.

I have actually planned on releasing it more properly, but I was having 
issues with metapackages.. anyhow, here you go:

http://redivi.com/~bob/mod_python-2.7.6-osx.dmg.gz

-bob

On Monday, February 25, 2002, at 06:20 PM, Brian Brown wrote:

> Greetings!
>  I am trying to compile mod_python 2.7.6 on MacOS 10.1.3 with no 
> success. I get the following:
>
> cc: cannot specify -o with -c or -S with multiple compilations
>
>
> I tried to take the -c out of the src/Makefile, but it had no effect on 
> the make process... any ideas?
>
> Brian
>
> /-----------------
> Brian Brown
> ICCE Technologies, Inc.
> http://www.icce-t.com
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From bob at redivi.com  Wed Mar 20 11:18:10 2002
From: bob at redivi.com (Bob Ippolito)
Date: Fri Jan  9 21:52:45 2004
Subject: [mod_python] File upload progress indicator
Message-ID: <126119D2-3C1E-11D6-9796-0003938210D6@redivi.com>

I'm developing an application using mod_python and I'd like to include 
file upload progress indication.. However, I don't see any obvious way 
on how do to such a thing.

It's possible in mod_perl, and I've done it before, using 
Apache::Request (see http://httpd.apache.org/apreq/Apache-Request.html)

Is this functionality possible in the current incarnation of mod_python 
or should I write this component in mod_perl or C?

-bob


From bakey at traq.com  Wed Mar 20 10:52:29 2002
From: bakey at traq.com (Brian Akey)
Date: Fri Jan  9 21:52:45 2004
Subject: [mod_python] File upload progress indicator
Message-ID: <780A5D64B1CC9544AB7B702F39219C1E60E0@traqexch.traq.com>

I have a cgi python script that does upload. It should be easy to convert.
#!/usr/bin/python

import cgi
form = cgi.FieldStorage()
print 'Content-type: text/html'
print

if not form:
        print """
        <html><head><title>File Upload</title></head><body>
        <form action"/cgi-bin/file.py" method="POST"
enctype="multipart/form-data">
        <input type="file" name="filename">
        <input type="submit" name="Send_File" value="Send_File">
        </form>
        <p>Please compress the file(s) with Winzip or some other compression

tool before sending the file.
        </body></html>
        """
elif form.has_key("filename"):
        item = form["filename"]
        if item.file:
                data = item.file.read()
                filen = item.filename
                filen1 = filen.split('\\')
                filen2 = filen1[len(filen1)-1]
                #filen2 = 'd.txt'
                open('/www/download/' + filen2 + '.tmp','wb').write(data)
                print """
                <html><head><title>File Upload</title></head><body>
                Thank you for the file
                """
                print cgi.escape(filen2)
                print '</body></html>'

-----Original Message-----
From: Bob Ippolito [mailto:bob@redivi.com]
Sent: Wednesday, March 20, 2002 10:18 AM
To: mod_python@modpython.org
Subject: [mod_python] File upload progress indicator


I'm developing an application using mod_python and I'd like to include 
file upload progress indication.. However, I don't see any obvious way 
on how do to such a thing.

From bob at redivi.com  Wed Mar 20 12:10:28 2002
From: bob at redivi.com (Bob Ippolito)
Date: Fri Jan  9 21:52:45 2004
Subject: [mod_python] File upload progress indicator
In-Reply-To: <780A5D64B1CC9544AB7B702F39219C1E60E0@traqexch.traq.com>
Message-ID: <604E6B08-3C25-11D6-9796-0003938210D6@redivi.com>

Brian,

The problem isn't with file uploading in general, I want to generate 
near-realtime progress indications of the file upload's progress.  Which 
should be possible by examining the Content-length header and making a 
separate connection to the webserver, tracked via a session cookie.  
It's actually really nice to be able to do this asynchronously in Flash 
5.0+ using XML sockets, which I may or may not end up doing.  I'll 
probably open source this component of it since it's really quite 
useful, given that the status bars in IE don't tell you the progress of 
a file upload, only if it's still going or not (and even then, not very 
obviously).

The problem is that when you use FieldStorage, you have already 
processed the file upload.  You don't get callbacks when apache is 
reading.

My client is going to be dealing with large files quite often, and 
although I didn't specify that I was going to provide them this advanced 
functionality, I would like to give it to them anyway as it's really 
nice from a UI standpoint.

-bob

On Wednesday, March 20, 2002, at 11:52 AM, Brian Akey wrote:

> I have a cgi python script that does upload. It should be easy to 
> convert.
> --snip--
>
> -----Original Message-----
> From: Bob Ippolito [mailto:bob@redivi.com]
> Sent: Wednesday, March 20, 2002 10:18 AM
> To: mod_python@modpython.org
> Subject: [mod_python] File upload progress indicator
>
>
> I'm developing an application using mod_python and I'd like to include
> file upload progress indication.. However, I don't see any obvious way
> on how do to such a thing.


From bob at redivi.com  Wed Mar 20 12:36:15 2002
From: bob at redivi.com (Bob Ippolito)
Date: Fri Jan  9 21:52:45 2004
Subject: [mod_python] Compiling on MacOS X
In-Reply-To: <41D1077D-3C1D-11D6-9796-0003938210D6@redivi.com>
Message-ID: <FA803D73-3C28-11D6-9796-0003938210D6@redivi.com>

fyi, I setup a small container page for it and released on 
versiontracker.. prepare for the flood of new osx users of mod_python 
(hopefully) :)

http://redivi.com/~bob/mod_python.html
http://www.versiontracker.com/moreinfo.fcgi?id=14075&db=macosx

-bob

On Wednesday, March 20, 2002, at 11:12 AM, Bob Ippolito wrote:

> I have successfully compiled mod_python on MacOS X 10.1.3.  I did it 
> the other night bored at the hotel on a business trip, because I didn't 
> have net access and wanted to debug some stuff.
>
> I have actually planned on releasing it more properly, but I was having 
> issues with metapackages.. anyhow, here you go:
>
> http://redivi.com/~bob/mod_python-2.7.6-osx.dmg.gz
>
> -bob
>
> On Monday, February 25, 2002, at 06:20 PM, Brian Brown wrote:
>
>> Greetings!
>>  I am trying to compile mod_python 2.7.6 on MacOS 10.1.3 with no 
>> success. I get the following:
>>
>> cc: cannot specify -o with -c or -S with multiple compilations
>>
>>
>> I tried to take the -c out of the src/Makefile, but it had no effect 
>> on the make process... any ideas?
>>
>> Brian
>>
>> /-----------------
>> Brian Brown
>> ICCE Technologies, Inc.
>> http://www.icce-t.com
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://www.modpython.org/mailman/listinfo/mod_python
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From bbrown at icce-t.com  Wed Mar 20 13:31:18 2002
From: bbrown at icce-t.com (Brian Brown)
Date: Fri Jan  9 21:52:45 2004
Subject: [mod_python] Compiling on MacOS X
In-Reply-To: <FA803D73-3C28-11D6-9796-0003938210D6@redivi.com>
References: <FA803D73-3C28-11D6-9796-0003938210D6@redivi.com>
Message-ID: <26200000.1016656278@kelethin.icce-t.com>

--On Wednesday, March 20, 2002 12:36:15 PM -0500 Bob Ippolito 
<bob@redivi.com> wrote:

> fyi, I setup a small container page for it and released on
> versiontracker.. prepare for the flood of new osx users of mod_python
> (hopefully) :)
>

Thanks Bob! You're a lifesaver :)



> http://redivi.com/~bob/mod_python.html
> http://www.versiontracker.com/moreinfo.fcgi?id=14075&db=macosx
>
> -bob
>
> On Wednesday, March 20, 2002, at 11:12 AM, Bob Ippolito wrote:
>
>> I have successfully compiled mod_python on MacOS X 10.1.3.  I did it
>> the other night bored at the hotel on a business trip, because I didn't
>> have net access and wanted to debug some stuff.
>>
>> I have actually planned on releasing it more properly, but I was having
>> issues with metapackages.. anyhow, here you go:
>>
>> http://redivi.com/~bob/mod_python-2.7.6-osx.dmg.gz
>>
>> -bob
>>
>> On Monday, February 25, 2002, at 06:20 PM, Brian Brown wrote:
>>
>>> Greetings!
>>>  I am trying to compile mod_python 2.7.6 on MacOS 10.1.3 with no
>>> success. I get the following:
>>>
>>> cc: cannot specify -o with -c or -S with multiple compilations
>>>
>>>
>>> I tried to take the -c out of the src/Makefile, but it had no effect
>>> on the make process... any ideas?
>>>
>>> Brian
>>>
>>> /-----------------
>>> Brian Brown
>>> ICCE Technologies, Inc.
>>> http://www.icce-t.com
>>> _______________________________________________
>>> Mod_python mailing list
>>> Mod_python@modpython.org
>>> http://www.modpython.org/mailman/listinfo/mod_python
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://www.modpython.org/mailman/listinfo/mod_python
>
>
>

/-----------------
Brian Brown
ICCE Technologies, Inc.
http://www.icce-t.com

From ian at veryfresh.com  Wed Mar 20 17:31:10 2002
From: ian at veryfresh.com (Ian Clelland)
Date: Fri Jan  9 21:52:45 2004
Subject: [mod_python] Problems with GET after POST
Message-ID: <20020321013110.GE1811@fullfactor.com>

I have been experimenting with mod_python to evaluate it for some 
upcoming projects, and I recently came across what appeared to be a bug 
in mod_python.  (After three days of scratching my head over this, the 
solution came to me as I was writing this message, but I'm sending it 
anyway in case someone else comes across this problem. -- Should this 
sort of thing go into the FAQ?)

The problem was essentially that whenever I performed a GET request on 
a URL immediately following a POST request to that same URL, Apache 
would seem to confuse the two requests, and after the GET, I would 
receive an error message like this:

HTTP/1.1 501 Method Not Implemented

key=valueGET to /pytest not supported
Invalid method in request key=valueGET /pytest


Running tcpdump on the communication between the browser and server 
showed that the requests were all well-formed, and there was nothing 
unusual in the headers to suggest that anything but Apache/mod_python 
was at fault.


The simplest script I could produce to replicate the problem was this:

# -------------------------------------------------------------------
import sys
from mod_python import apache

def handler(req):

  if req.method == 'GET':
  
    req.content_type = "text/html"
    req.send_http_header()
    req.write("""<html>
<head>
  <title>python test</title>
</head>
<body>
  <form method=\"post\" action=\"/pytest\">
    <input name=\"key\" value=\"value\"> <input type=\"submit\">
  </form>
</body>
</html>
""")

    return apache.OK

  elif req.method == 'POST':

    req.content_type = "text/html"
    req.send_http_header()
    req.write("""<html>
<head>
  <title>python test part 2</title>
</head>
<body>
  <p>POST successful. <a href=\"/pytest\">Click here</a></p>
</body>
</html>
""")
    return apache.OK

  else:
    return apache.DECLINED
# -------------------------------------------------------------------

It was supported by these Apache configuration directives:

<Location "/pytest">
  SetHandler python-program
  PythonPath "sys.path+['/home/ian/src/pytest']"
  PythonHandler python_test
</Location>


The script is accessable from the virtual URL /pytest, which runs the 
python_test.py module from a non-web-accessable directory. Going to the 
URL /pytest in Mozilla, hitting the submit button, then clicking on the 
'Click here' link brings up the error message.

The problem with this code (as it became apparent to me while writing 
this message) is that the POST handler never actually reads the POST 
data, and so it stays on stdin, and Apache treats it as the beginning 
of the next request. Simply inserting the line 'postdata = req.read()' 
gets rid of the error.

Questions:

Is this the correct behaviour for mod_python? Is it the python module 
writer's responsibility to read all POST data in all situations? What 
if the data is very large (say, a 5MB file when I expected a small text 
field) and I just want to discard it?


Ian
<ian@veryfresh.com>

From charney at charneyday.com  Wed Mar 20 21:34:32 2002
From: charney at charneyday.com (Reginald Charney)
Date: Fri Jan  9 21:52:45 2004
Subject: [mod_python] Installation problems
Message-ID: <200203210536.g2L5akf61316@mail.via.net>

I am unable to get mod_python working on my system. I think I have followed everything needed and documented, but when I enter the following URLs, I get:

/test/mptest.py  - I am asked what program to use to execute this file
/test/mptest      - lists the ASCII source of the file

The following is what I believe is the relevant information from my installation. Any help would be appreciated. TIA.

Reg. Charney

Partial contents of /etc/httpd/httpd.conf
=========================================

    #
    # And for PHP 4.x, use:
    #
    <IfModule mod_php4.c>
    AddType application/x-httpd-php .php
    AddType application/x-httpd-php .php4
    AddType application/x-httpd-php-source .phps
    </IfModule>

    #
    # And for mod_python, use:
    #
    <IfModule mod_python.c>
    AddType application/x-httpd-py .py
    </IfModule>
...
<Directory /usr/local/httpd/htdocs/test>
    AddHandler python-program .py
    PythonHandler mptest
    PythonDebug On
</Directory>


Test file /test/mptest.py
=========================

from mod_python import apache

def handler(req):
        req.send_http_header()
        req.write("hello world!")
        return apache.OK


Output from phpinfo()
=====================
System:		Linux x330-2 2.4.9 #3 SMP Wed Feb 13 15:02:07
Server Root:	/usr/local/httpd
Loaded Modules:	mod_userdir, mod_python, mod_php4, mod_perl, mod_setenvif, mod_unique_id, mod_usertrack, mod_headers, mod_expires, mod_cern_meta, mod_proxy, mod_digest, mod_auth_db, mod_auth_dbm, mod_auth_anon, mod_auth, mod_access, mod_rewrite, mod_alias, mod_speling, mod_actions, mod_imap, mod_asis, mod_cgi, mod_dir, mod_autoindex, mod_include, mod_info, mod_status, mod_negotiation, mod_mime, mod_mime_magic, mod_log_referer, mod_log_agent, mod_log_config, mod_define, mod_env, mod_vhost_alias, mod_mmap_static, mod_so, http_core

PYTHONPATH:	/usr/lib/python2.1:/usr/lib/python2.1/plat-linux2:/usr/lib/python2.1/lib-tk:/usr/lib/python2.1/lib-dynload:/usr/lib/python2.1/site-packages:/usr/lib/apache/lib/python/site-packages

SERVER_SOFTWARE: Apache/1.3.20 (Linux/SuSE) mod_python/2.7.5 Python/2.1.1 PHP/4.0.6 mod_perl/1.26

HTTP_ENV_VARS["PATH"]:	/usr/sbin:/bin:/usr/bin:/sbin:/usr/X11R6/bin 

From jeffstearns at attbi.com  Wed Mar 20 23:50:22 2002
From: jeffstearns at attbi.com (Jeff Stearns)
Date: Fri Jan  9 21:52:45 2004
Subject: [mod_python] Broken reload algorithm?
Message-ID: <4C727568-3CA0-11D6-9CF0-0030653DCC28@attbi.com>

I'm using the publisher handler with mod_python 2.7.6.  I'm doing 
development, so auto-reload is turned on.

This causes broken behavior.  I blame it on line 365 in apache.py:

     # if module is newer - reload
     if (autoreload and (oldmtime < mtime)):
         module = reload(module)

The code here assumes that the module can be found in sys.path. But 
that's not guaranteed when using publisher. The module may be found 
anywhere in the document tree.  Unfortunately, that provokes an 
exception.

I believe that the call to reload() should be replaced with 
imp.load_module(). The imp.load_module function *does* handle reloading, 
and it can be given the path to the module.  Unfortunately, the code 
needs to be reworked to test this theory.

Comments?  Am I missing the point here?

thx - jeff stearns


From ian at veryfresh.com  Thu Mar 21 03:16:59 2002
From: ian at veryfresh.com (Ian Clelland)
Date: Fri Jan  9 21:52:45 2004
Subject: [mod_python] Installation problems
In-Reply-To: <200203210536.g2L5akf61316@mail.via.net>
References: <200203210536.g2L5akf61316@mail.via.net>
Message-ID: <20020321111659.GA8699@fullfactor.com>

I believe that your problems stem from the fact that you are trying to 
use mod_python as if it was a 'traditional' scripting language like PHP 
or ASP.

With either of those languages, you can simply write scripts with the 
appropriate extensions, place them in a web-accessable directory, and 
they're automatically executable.

With mod_python, you are actually writing Apache modules in the python 
language. You need to use Apache directives to configure those modules 
to be activated at the appropriate times.

Depending on how you want to do things, I see two ways to get your test 
script to run:

1) Install the script as a handler. This is the closest to what you are 
   currently doing. The problem is that Python cannot find your module. 
   You can just add the line

     PythonPath "sys.path+['/usr/local/httpd/htdocs/test']"

   to your <Directory> entry, and the module should load.

2) Use the supplied Publisher handler (check the tutorial at 
   www.modpython.org). This is a great hack which allows a single 
   handler to load .py files from anywhere in your site. It appears to 
   be closer to what you intended to do, which is to just run a .py 
   file out of a URL.


I hope that helps clear things up.

A couple of quick points about your original email:

> /test/mptest.py  - I am asked what program to use to execute this file
This is because you have associated a MIME type with the .py extension, 
and Apache doesn't know what to do with it. (The mod_python module 
doesn't deal with MIME types like mod_php). The only thing it can do is 
offer the file for download.

> /test/mptest      - lists the ASCII source of the file
In this case, Apache's content negotiation is finding the best match 
for /mptest and returning that to you as a text document.

>     <IfModule mod_python.c>
>     AddType application/x-httpd-py .py
>     </IfModule>
This section is unnecessary, and should probably be deleted.

> PYTHONPATH:	/usr/lib/python2.1:/usr/lib/python2.1/plat-linux2:
> /usr/lib/python2.1/lib-tk:/usr/lib/python2.1/lib-dynload:/usr/lib/
> python2.1/site-packages:/usr/lib/apache/lib/python/site-packages
This variable shows the locations where Python will look for modules 
when you use an import statement (or a Python*Handler directive). Since 
/usr/local/httpd/htdocs/test is not in the list, Python cannot find 
your mptest module.


Regards,
Ian
<ian@veryfresh.com>

From maynard at mpi-cbg.de  Thu Mar 21 13:15:18 2002
From: maynard at mpi-cbg.de (Gary Maynard)
Date: Fri Jan  9 21:52:45 2004
Subject: [mod_python] persistant variables
In-Reply-To: <20020321111659.GA8699@fullfactor.com>
Message-ID: <NCEILGMPEAMDGEALMLEMKEJFCAAA.maynard@mpi-cbg.de>

Hi,
  I want to know how to store persistant variables in mod_python. I have
written some simple code that works like this:

def handler(req):
        global testthis
        try:
                d = testthis
        except:
                testthis = 1
        req.send_http_header()
        req.write(str(testthis))
        testthis = testthis + 1
        return apache.OK

each time the script is run it should print the last value of testthis and
then increment it.

However, because Apache has several servers running, I end up with several
instances of testhis, one of which gets printed and incremented each time.

How can I force mod_python to only have one instance of the variable? Or
should I be trying to do this in an entirely different way?

I can set Apache to only start with one server (which makes it work),
however it will spawn more servers if it gets two hits at the same time, so
this won't really work.

thanks
Gary




From grisha at modpython.org  Thu Mar 21 09:54:57 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:45 2004
Subject: [mod_python] Installation problems
In-Reply-To: <200203210536.g2L5akf61316@mail.via.net>
Message-ID: <Pine.BSF.4.32.0203210950420.55815-100000@localhost>

Just before sending headers, add a line like this:

        req.content_type = "text/plain"
        req.send_http_header()

and try the url which asks you what program to use, it might just work.
Apache sets different content-types based on your configuration, which can
vary, so sometimes you have to force it to text/plain or text/html.

Grisha


On Wed, 20 Mar 2002, Reginald Charney wrote:

> I am unable to get mod_python working on my system. I think I have followed everything needed and documented, but when I enter the following URLs, I get:
>
> /test/mptest.py  - I am asked what program to use to execute this file
> /test/mptest      - lists the ASCII source of the file
>
> The following is what I believe is the relevant information from my installation. Any help would be appreciated. TIA.
>
> Reg. Charney
>
> Partial contents of /etc/httpd/httpd.conf
> =========================================
>
>     #
>     # And for PHP 4.x, use:
>     #
>     <IfModule mod_php4.c>
>     AddType application/x-httpd-php .php
>     AddType application/x-httpd-php .php4
>     AddType application/x-httpd-php-source .phps
>     </IfModule>
>
>     #
>     # And for mod_python, use:
>     #
>     <IfModule mod_python.c>
>     AddType application/x-httpd-py .py
>     </IfModule>
> ...
> <Directory /usr/local/httpd/htdocs/test>
>     AddHandler python-program .py
>     PythonHandler mptest
>     PythonDebug On
> </Directory>
>
>
> Test file /test/mptest.py
> =========================
>
> from mod_python import apache
>
> def handler(req):
>         req.send_http_header()
>         req.write("hello world!")
>         return apache.OK
>
>
> Output from phpinfo()
> =====================
> System:		Linux x330-2 2.4.9 #3 SMP Wed Feb 13 15:02:07
> Server Root:	/usr/local/httpd
> Loaded Modules:	mod_userdir, mod_python, mod_php4, mod_perl, mod_setenvif, mod_unique_id, mod_usertrack, mod_headers, mod_expires, mod_cern_meta, mod_proxy, mod_digest, mod_auth_db, mod_auth_dbm, mod_auth_anon, mod_auth, mod_access, mod_rewrite, mod_alias, mod_speling, mod_actions, mod_imap, mod_asis, mod_cgi, mod_dir, mod_autoindex, mod_include, mod_info, mod_status, mod_negotiation, mod_mime, mod_mime_magic, mod_log_referer, mod_log_agent, mod_log_config, mod_define, mod_env, mod_vhost_alias, mod_mmap_static, mod_so, http_core
>
> PYTHONPATH:	/usr/lib/python2.1:/usr/lib/python2.1/plat-linux2:/usr/lib/python2.1/lib-tk:/usr/lib/python2.1/lib-dynload:/usr/lib/python2.1/site-packages:/usr/lib/apache/lib/python/site-packages
>
> SERVER_SOFTWARE: Apache/1.3.20 (Linux/SuSE) mod_python/2.7.5 Python/2.1.1 PHP/4.0.6 mod_perl/1.26
>
> HTTP_ENV_VARS["PATH"]:	/usr/sbin:/bin:/usr/bin:/sbin:/usr/X11R6/bin
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From grisha at modpython.org  Thu Mar 21 10:05:09 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:45 2004
Subject: [mod_python] Broken reload algorithm?
In-Reply-To: <4C727568-3CA0-11D6-9CF0-0030653DCC28@attbi.com>
Message-ID: <Pine.BSF.4.32.0203210957210.55815-100000@localhost>

It looks like you're right about this - I looked at the Python code
(Python/import.c) and it seems like it searches the path again for reload.
When I wrote this I was under the impression that Python would just reload
the original file from which the module came.

I'll make a note of this.

My mod_python todo list is just getting so huge...

Grisha


On Wed, 20 Mar 2002, Jeff Stearns wrote:

> I'm using the publisher handler with mod_python 2.7.6.  I'm doing
> development, so auto-reload is turned on.
>
> This causes broken behavior.  I blame it on line 365 in apache.py:
>
>      # if module is newer - reload
>      if (autoreload and (oldmtime < mtime)):
>          module = reload(module)
>
> The code here assumes that the module can be found in sys.path. But
> that's not guaranteed when using publisher. The module may be found
> anywhere in the document tree.  Unfortunately, that provokes an
> exception.
>
> I believe that the call to reload() should be replaced with
> imp.load_module(). The imp.load_module function *does* handle reloading,
> and it can be given the path to the module.  Unfortunately, the code
> needs to be reworked to test this theory.
>
> Comments?  Am I missing the point here?
>
> thx - jeff stearns
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From stony8 at gmx.de  Fri Mar 22 17:18:50 2002
From: stony8 at gmx.de (Alexander Steinert)
Date: Fri Jan  9 21:52:45 2004
Subject: [mod_python] persistant variables
In-Reply-To: <NCEILGMPEAMDGEALMLEMKEJFCAAA.maynard@mpi-cbg.de>; from maynard@mpi-cbg.de on Thu, Mar 21, 2002 at 01:15:18PM +0100
References: <20020321111659.GA8699@fullfactor.com> <NCEILGMPEAMDGEALMLEMKEJFCAAA.maynard@mpi-cbg.de>
Message-ID: <20020322171850.A1049@tyche.svt.tu-harburg.de>

> How can I force mod_python to only have one instance of the variable? Or
> should I be trying to do this in an entirely different way?
> 
> I can set Apache to only start with one server (which makes it work),
> however it will spawn more servers if it gets two hits at the same time, so
> this won't really work.

I thought about this topic a few weeks ago and came to the conclusion
that that you can't force the wished behaviour (if apache is forking).

You need persistent storage in a DBMS or a file and must take care of
concurrent accesses.

HTH

Stony


From ian at veryfresh.com  Fri Mar 22 10:09:59 2002
From: ian at veryfresh.com (Ian Clelland)
Date: Fri Jan  9 21:52:45 2004
Subject: [mod_python] persistant variables
In-Reply-To: <20020322171850.A1049@tyche.svt.tu-harburg.de>
References: <20020321111659.GA8699@fullfactor.com> <NCEILGMPEAMDGEALMLEMKEJFCAAA.maynard@mpi-cbg.de> <20020322171850.A1049@tyche.svt.tu-harburg.de>
Message-ID: <20020322180959.GB9162@fullfactor.com>

On Fri, Mar 22, 2002 at 05:18:50PM +0100, Alexander Steinert wrote:
> > How can I force mod_python to only have one instance of the variable? Or
> > should I be trying to do this in an entirely different way?
> > 
> > I can set Apache to only start with one server (which makes it work),
> > however it will spawn more servers if it gets two hits at the same time, so
> > this won't really work.
> 
> I thought about this topic a few weeks ago and came to the conclusion
> that that you can't force the wished behaviour (if apache is forking).
> 
> You need persistent storage in a DBMS or a file and must take care of
> concurrent accesses.

I've come to the same conclusion myself, after a fair bit of 
experimentation and research (there was a lengthy discussion on this 
list about a year ago: 
http://www.modpython.org/pipermail/mod_python/2001-April/001254.html ).

Because Apache (on Unix) forks new processes for its children, they 
must necessarily run in isolated memory spaces. However, since each 
child process is long-lived, you can retain some persistent data (like 
a database connection handle) between requests /to that child/. It's 
not quite the same thing as global persistent data, but it works for 
some applications.

Apparently mod_perl developers can get around this limitation by using 
the IPC::Shareable module -- has anybody in the Python community done 
any work on something similar?


Ian
<ian@veryfresh.com>

From bakey at traq.com  Fri Mar 22 13:53:47 2002
From: bakey at traq.com (Brian Akey)
Date: Fri Jan  9 21:52:46 2004
Subject: [mod_python] persistant variables
Message-ID: <780A5D64B1CC9544AB7B702F39219C1E60F0@traqexch.traq.com>

Is there a way to leverage the MM library that people compile in for
mod_ssl?

-----Original Message-----
From: Ian Clelland [mailto:ian@veryfresh.com]
Sent: Friday, March 22, 2002 12:10 PM
To: mod_python@modpython.org
Subject: Re: [mod_python] persistant variables


On Fri, Mar 22, 2002 at 05:18:50PM +0100, Alexander Steinert wrote:
> > How can I force mod_python to only have one instance of the variable? Or
> > should I be trying to do this in an entirely different way?
> > 
> > I can set Apache to only start with one server (which makes it work),
> > however it will spawn more servers if it gets two hits at the same time,
so
> > this won't really work.
> 
> I thought about this topic a few weeks ago and came to the conclusion
> that that you can't force the wished behaviour (if apache is forking).
> 
> You need persistent storage in a DBMS or a file and must take care of
> concurrent accesses.

I've come to the same conclusion myself, after a fair bit of 
experimentation and research (there was a lengthy discussion on this 
list about a year ago: 
http://www.modpython.org/pipermail/mod_python/2001-April/001254.html ).

Because Apache (on Unix) forks new processes for its children, they 
must necessarily run in isolated memory spaces. However, since each 
child process is long-lived, you can retain some persistent data (like 
a database connection handle) between requests /to that child/. It's 
not quite the same thing as global persistent data, but it works for 
some applications.

Apparently mod_perl developers can get around this limitation by using 
the IPC::Shareable module -- has anybody in the Python community done 
any work on something similar?


Ian
<ian@veryfresh.com>
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python

From s_lott at yahoo.com  Sat Mar 23 07:53:14 2002
From: s_lott at yahoo.com (Steven Lott)
Date: Fri Jan  9 21:52:46 2004
Subject: [mod_python] (no subject)
Message-ID: <20020323155314.50780.qmail@web9608.mail.yahoo.com>

Context:
Server version: Apache/1.3.20 (Unix)  (Red-Hat/Linux)
Python 2.2 (#2, Mar 23 2002, 07:48:23)
Mod_python 2.7.6

Did a rebuild of Python --without-threads
Did a build of mod_python --with-apxs pointing to my apxs in
/usr/sbin

Start apache with /usr/sbin/httpd -dHAVE_PYTHON

[Sat Mar 23 10:24:42 2002] [warn] Loaded DSO
modules/mod_python.so uses plain Apache 1.3 API, this module
might crash under EAPI! (please recompile it with -DEAPI)

What do I change in the config to include -DEAPI?
Or can I ignore this?




=====
--
S. Lott, CCP :-{)
S_LOTT@YAHOO.COM
http://www.mindspring.com/~slott1
Buccaneer #468: KaDiMa

Macintosh user: drinking upstream from the herd.

__________________________________________________
Do You Yahoo!?
Yahoo! Movies - coverage of the 74th Academy Awards
http://movies.yahoo.com/

From geert at boskant.nl  Sat Mar 23 18:57:30 2002
From: geert at boskant.nl (Geert Jansen)
Date: Fri Jan  9 21:52:46 2004
Subject: [mod_python] (no subject)
In-Reply-To: <20020323155314.50780.qmail@web9608.mail.yahoo.com>
Message-ID: <POEGJAKPNOCGNJMONMFKEEOLCDAA.geert@boskant.nl>

Hello Steven,

I got this error too and some searching with google indicated that this is
not a grave error. Only if mod_python used mod_ssl (mod_ssl uses the
"Extended API" or EAPI of Apache), there would be a problem.

BTW: recompiling with -DEAPI doesn't change one bit

Greet
--
long long email=0X78DC806B91FCA334,i=0,j; main(){j=(email>>4*i)&15;
putchar(j+j/2+j/5-j/12+(j<13?97:-65+7*j));i/15?exit(0):++i,main();}

> -----Original Message-----
> From: mod_python-admin@modpython.org
> [mailto:mod_python-admin@modpython.org]On Behalf Of Steven Lott
> Sent: Saturday, March 23, 2002 4:53 PM
> To: mod_python@modpython.org
> Subject: [mod_python] (no subject)
>
>
> Context:
> Server version: Apache/1.3.20 (Unix)  (Red-Hat/Linux)
> Python 2.2 (#2, Mar 23 2002, 07:48:23)
> Mod_python 2.7.6
>
> Did a rebuild of Python --without-threads
> Did a build of mod_python --with-apxs pointing to my apxs in
> /usr/sbin
>
> Start apache with /usr/sbin/httpd -dHAVE_PYTHON
>
> [Sat Mar 23 10:24:42 2002] [warn] Loaded DSO
> modules/mod_python.so uses plain Apache 1.3 API, this module
> might crash under EAPI! (please recompile it with -DEAPI)
>
> What do I change in the config to include -DEAPI?
> Or can I ignore this?
>
>
>
>
> =====
> --
> S. Lott, CCP :-{)
> S_LOTT@YAHOO.COM
> http://www.mindspring.com/~slott1
> Buccaneer #468: KaDiMa
>
> Macintosh user: drinking upstream from the herd.
>
> __________________________________________________
> Do You Yahoo!?
> Yahoo! Movies - coverage of the 74th Academy Awards.
> http://movies.yahoo.com/
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From bs at wasd.dk  Sun Mar 24 12:04:11 2002
From: bs at wasd.dk (Bjarke =?iso-8859-1?Q?S=F8rensen?=)
Date: Fri Jan  9 21:52:46 2004
Subject: [mod_python] -DEAPI
In-Reply-To: <POEGJAKPNOCGNJMONMFKEEOLCDAA.geert@boskant.nl>
References: <20020323155314.50780.qmail@web9608.mail.yahoo.com> <POEGJAKPNOCGNJMONMFKEEOLCDAA.geert@boskant.nl>
Message-ID: <20020324110411.GA3729@wasd.dk>

On Sat, Mar 23, 2002 at 06:57:30PM +0100, Geert Jansen wrote:
> Hello Steven,
> 
> I got this error too and some searching with google indicated that this is
> not a grave error. Only if mod_python used mod_ssl (mod_ssl uses the
> "Extended API" or EAPI of Apache), there would be a problem.
> 
> BTW: recompiling with -DEAPI doesn't change one bit

Where do you put it?


> > [Sat Mar 23 10:24:42 2002] [warn] Loaded DSO
> > modules/mod_python.so uses plain Apache 1.3 API, this module
> > might crash under EAPI! (please recompile it with -DEAPI)

As I see it, it's apxs that should be given the -DEAPI and you have to do that manually in Makefile.



> > What do I change in the config to include -DEAPI?
> > Or can I ignore this?


I would rather correct it, as it could kill apache threads.



/bs

bs@wasd.dk
http://wasd.dk/

From matt at proweb.co.uk  Tue Mar 26 12:53:06 2002
From: matt at proweb.co.uk (Matt H)
Date: Fri Jan  9 21:52:46 2004
Subject: [mod_python] Please deinstall & rebuild/reinstall Python withWITHOUT_THREADS set.
Message-ID: <20020326125306.4f93066c.matt@proweb.co.uk>

I'm doing a new install in FreeBSd 4.5
I'm getting 

Error: Python installation in /usr/local uses threads. mod_python requires
it to be built without threads. Please deinstall & rebuild/reinstall Python with
WITHOUT_THREADS set.

and yet here's partial output from the python install (blank lines for highlighting)

checking for --with-libs... no
checking for --with-signal-module... yes
checking for --with-dec-threads... no

checking for --with-threads... no

checking if --enable-ipv6 is specified... yes
checking if RFC2553 API is available... yes
checking ipv6 stack type... kame
using libc



oh what to do, I need to get my site back up again!

Matt

From matt at proweb.co.uk  Tue Mar 26 17:50:58 2002
From: matt at proweb.co.uk (Matt H)
Date: Fri Jan  9 21:52:46 2004
Subject: [mod_python] Please deinstall & rebuild  << FIXED
In-Reply-To: <200203261609.g2QG90f03946@lewis.abi.tconline.net>
References: <20020326125306.4f93066c.matt@proweb.co.uk>
	<200203261609.g2QG90f03946@lewis.abi.tconline.net>
Message-ID: <20020326175058.0148020b.matt@proweb.co.uk>

Predictably it was my own fault

Originally I installed from /usr/ports/www/mod_python

which lists python as a dependancy and then proceeds to build and install
it with threads

for the rebuild I hacked the Makefile for python and got it wrong

doh!

thanks to Bob & Lewis for taking the time to star tto help me

it was writing my reply that made me look again and find what I'd done


----

What I generally do is just compile an entirely separate version of 
python, i.e. in /usr/local/apache/python .. I use threaded python for 
everything else, so taking threads out globally isn't really an option 
for me.


I'd be interested to know how to do that

I tried moving /usr/local/lib/python2.2 without success

It would be great if someone could add a faq or howto on having the two
seperate python's installed. 

Dropping thread support kills py-curl for a start, 
I either need both or re-write my stuff that relies on py-curl

I'm definately in love with mod_python

m



From reitz at inworks.de  Tue Mar 26 18:58:42 2002
From: reitz at inworks.de (andre@orion)
Date: Fri Jan  9 21:52:46 2004
Subject: [mod_python] make install
References: <20020326125306.4f93066c.matt@proweb.co.uk><200203261609.g2QG90f03946@lewis.abi.tconline.net> <20020326175058.0148020b.matt@proweb.co.uk>
Message-ID: <018f01c1d4ef$ddc6a560$1900a8c0@venus>

Would it be possible to add a configure option with which python
installation the libs will be compiled / installed....


e.g.:
./configure --with-python-binary=/usr/local/bin/python2.2

The "make install" uses always the python which is found in $PATH.


P.S.: When will the next Release be released?

Greetings, Andre'


From grisha at modpython.org  Tue Mar 26 14:28:26 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:46 2004
Subject: [mod_python] Please deinstall & rebuild/reinstall Python
 withWITHOUT_THREADS set.
In-Reply-To: <20020326125306.4f93066c.matt@proweb.co.uk>
Message-ID: <Pine.BSF.4.32.0203261427560.23911-100000@localhost>

This is in the FAQ.

do "rm config.cache"

Grisha

On Tue, 26 Mar 2002, Matt H wrote:

>
> I'm doing a new install in FreeBSd 4.5
> I'm getting
>
> Error: Python installation in /usr/local uses threads. mod_python requires
> it to be built without threads. Please deinstall & rebuild/reinstall Python with
> WITHOUT_THREADS set.
>
> and yet here's partial output from the python install (blank lines for highlighting)
>
> checking for --with-libs... no
> checking for --with-signal-module... yes
> checking for --with-dec-threads... no
>
> checking for --with-threads... no
>
> checking if --enable-ipv6 is specified... yes
> checking if RFC2553 API is available... yes
> checking ipv6 stack type... kame
> using libc
>
>
>
> oh what to do, I need to get my site back up again!
>
> Matt
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From jasper at objectionable.org  Thu Mar 28 21:06:24 2002
From: jasper at objectionable.org (Jasper Hargreaves)
Date: Fri Jan  9 21:52:46 2004
Subject: [mod_python] invalid command 'PythonHandler'
Message-ID: <3CA385D0.7171.102CC2@localhost>

An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020328/90668ecc/attachment-0001.htm
From grisha at modpython.org  Thu Mar 28 16:36:21 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:46 2004
Subject: [mod_python] invalid command 'PythonHandler'
In-Reply-To: <3CA385D0.7171.102CC2@localhost>
Message-ID: <Pine.BSF.4.32.0203281634250.59245-100000@localhost>

If you're new to Apache, then check the config to make sure it doesn't
have a ClearModuleList directive. If it does, then following it there
should also be an AddModule mod_python.c line somewhere, else the module
is never activated by apache.

Grisha

On Thu, 28 Mar 2002, Jasper Hargreaves wrote:

> I've been trying to get Python scripts working with Apache under Windows.
>
> Running Apache 1.3.22 on Windows2000 Pro (ntfs partition), with
> Version  2.7.6 of ModPython, with Python 2.2 installed in the back, supported by Win32all v146
>
> From a completely clean install of Python & Apache, and following the documentation word for word given for "Windows
> Installation" on the documentation section of the site, it's not giving any joy, giving a
>
> "Invalid command 'PythonHandler', perhaps mis-spelled or defined by a module not included in the server configuration."
>
> when Apache tries to start. I'm new to configuring Apache - so I'm unsure if there's a particular "cgi" section of the
> httpd.conf, or if it's simply covered by the "alias" section.
>
> I've also set file extensions .py to be associated with Python, and added environment variable PYTHONPATH, and PATH to point to
> the python directory.
>
> Any advice?
>
> Many thanks,
> Jasper Hargreaves
> --------------------
> Jasper Hargreaves
> jasper@objectionable.org
> ICQ : 41235322; AIM : cloudyshai
> http://www.objectionable.org
> --------------------
> Information is not knowledge. Knowledge is not wisdom. Wisdom is not truth. Truth is not beauty. Beauty is not love. Love is not
> music. Music is the best. Wisdom is the domain of the Wiz, which is extinct.
> Beauty is a french phoenetic corruption of a short cloth neck ornament currently in resurgence.
>                 -Frank Zappa, "Packard Goose"
> ---------------------
> _______________________________________________ Mod_python mailing list Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From anburger76 at hotmail.com  Sat Mar 30 18:18:48 2002
From: anburger76 at hotmail.com (Tony Burger)
Date: Fri Jan  9 21:52:46 2004
Subject: [mod_python] "openpty" installation problem with Python 2.2.1c2
Message-ID: <F10mRBaYFkuutSgcOrB0000613d@hotmail.com>

An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020330/d7eb1e1c/attachment-0001.htm
From anburger76 at hotmail.com  Sat Mar 30 19:01:14 2002
From: anburger76 at hotmail.com (Tony Burger)
Date: Fri Jan  9 21:52:46 2004
Subject: [mod_python] fixed "openpty" problem with Python 2.2.1c2
Message-ID: <F176GgdKn3khQCaqSGB00019337@hotmail.com>

An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020330/6d58d96a/attachment-0001.htm
From anburger76 at hotmail.com  Sun Mar 31 23:18:27 2002
From: anburger76 at hotmail.com (Tony Burger)
Date: Fri Jan  9 21:52:46 2004
Subject: [mod_python] popen/popen2 usage?
Message-ID: <F68hGtK25DgRbwri5Dp00003dcd@hotmail.com>

An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020331/af96f458/attachment-0001.htm
From conrad at hep.caltech.edu  Sun Mar 31 20:40:27 2002
From: conrad at hep.caltech.edu (Conrad Steenberg)
Date: Fri Jan  9 21:52:46 2004
Subject: [mod_python] popen/popen2 usage?
In-Reply-To: <F68hGtK25DgRbwri5Dp00003dcd@hotmail.com>
References: <F68hGtK25DgRbwri5Dp00003dcd@hotmail.com>
Message-ID: <1017636029.9948.13.camel@Tafelberg.caltech.edu>

On Sun, 2002-03-31 at 20:18, Tony Burger wrote:
I am calling a C executable from within mod_python using the popen2
function imported from os.  I need to get standard output from the C
function and assign it to a mod_python variable which isn't working. The
C function does a basic (void)fprinf(stdout,"%s\n",myVar). I tested the
C function by writing to stderr instead and that works (logged fprintf
output to the Apache error_log). I just can't get any output. Might
anyone know how mod_python handles this function or what it might be
doing? Thanks.

Check whether the stdout of the forked process doesn't get written to
the browser in this case. You need to write to a different file
descriptor. From man popen:
"      Writing to such  a  stream
       writes to the standard input of the command; the command's
       standard output is the same as that of  the  process  that
       called  popen(),  unless  this  is  altered by the command
       itself."

Unless you wanted the child process' output written to the client
browser??

Otherwise doing a pipe() and then a fork() separately should work, e.g.:

  int my_pipe[2]

  pipe(my_pipe);
  child_pid=fork()

  switch (child_pid)
  {  case -1:
              perror ("Error: unable to fork");
              return 0;
              
     case 0: /* the child */
              close(my_pipe[0]); /* close the read end*/

             /* do an exec/execv etc. here */

     default: /* the parent */
              close(my_pipe[1]); /* close the write end */
  }

You may of course have more than one pipe if you want bi-directional
communication: just close the write end in the child and the read end in
the parent of the seconf pipe.

Cheers!

Conrad
_______________________________________________ Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python


From alexis at mobiliant.com  Fri Mar  1 10:57:15 2002
From: alexis at mobiliant.com (=?iso-8859-1?Q?Ulf_Engstr=F6m?=)
Date: Fri Jan  9 21:59:15 2004
Subject: [mod_python] Install on Solaris
Message-ID: <00a701c1c107$791cffc0$4ede14d4@THENEWONE>

Hello :)
I'm having some problems installing on Solaris and I hope that someone could
help me a little. I've been searching the net and I've found many questions
regarding similar problems, but I havn't found a solution that works for me.

Problem is:
/usr/local/apache/> /bin/apachectl start
Syntax error on line 207 of /usr/local/apache/conf/httpd.conf:
Cannot load /usr/local/apache/libexec/mod_python.so into server: ld.so.1:
/usr/local/apache/bin/httpd: fatal: relocation error: file
/usr/local/apache/libexec/mod_python.so: symbol ap_log_error: referenced
symbol not found
/bin/apachectl start: httpd could not be started

(ap_log_error symbol exists in /usr/local/apache/include)

Other information:
> ldd -r /usr/local/apache/libexec/mod_python.so
        libm.so.1 =>     /usr/lib/libm.so.1
        libsocket.so.1 =>        /usr/lib/libsocket.so.1
        libnsl.so.1 =>   /usr/lib/libnsl.so.1
        libdl.so.1 =>    /usr/lib/libdl.so.1
        libc.so.1 =>     /usr/lib/libc.so.1
        libmp.so.2 =>    /usr/lib/libmp.so.2
        /usr/platform/SUNW,Sun-Blade-100/lib/libc_psr.so.1
        symbol not found: ap_log_error
(/usr/local/apache/libexec/mod_python.so)
        symbol not found: ap_log_error
(/usr/local/apache/libexec/mod_python.so)
        symbol not found: ap_log_error
(/usr/local/apache/libexec/mod_python.so)
<snipped many more symbols)

> uname -a
SunOS sol 5.8 Generic_108528-07 sun4u sparc SUNW,Sun-Blade-100

> which gcc
/usr/local/bin/gcc

> gcc -v
Reading specs from /usr/local/lib/gcc-lib/sparc-sun-solaris2.8/3.0.3/specs
Configured with:
../configure --with-as=/usr/local/bin/as --with-ld=/usr/local/bin/ld --enabl
e-libgcj
Thread model: posix
gcc version 3.0.3

> echo $LD_LIBRARY_PATH
/usr/lib:/lib:/usr/local/lib:/usr/local/mysql/lib:/usr/local/lib/

Python version 2.1.1
Apache version 1.3.23

I've also tried static compiling of mod_python, but that gave me the
following error during make of apache
connobject.o(.text+0x5d4): undefined reference to `PyMember_Set'

And many, many other rows of missing references.

Any more information needed, just let me know, I'd be very thankful for
anything that could help me with this:)

Regards
Ulf


From stony8 at gmx.de  Sun Mar  3 14:27:14 2002
From: stony8 at gmx.de (Alexander Steinert)
Date: Fri Jan  9 21:59:15 2004
Subject: [mod_python] Distinguish HTTP and HTTPS
Message-ID: <20020303142714.A9355@tyche.svt.tu-harburg.de>

My application wants to distinguish between requests sent with http and
those sent with https. Is that possible with mod_python? How?

TIA

Stony

From dustin at ywlcs.org  Sun Mar  3 09:28:12 2002
From: dustin at ywlcs.org (Dustin Mitchell)
Date: Fri Jan  9 21:59:15 2004
Subject: [mod_python] Distinguish HTTP and HTTPS
In-Reply-To: <20020303142714.A9355@tyche.svt.tu-harburg.de>
References: <20020303142714.A9355@tyche.svt.tu-harburg.de>
Message-ID: <20020303152812.GT3092@eleanor.internal.ywlcs.org>

Best way I've found to distinguish the two is to look at the port number:

def is_secure(req):
  # This seems the best way to do this
  return req.server.port == 443

Dustin

-- 

  Dustin Mitchell
  dustin@ywlcs.org

From jijang at tronwell.net  Tue Mar  5 16:34:46 2002
From: jijang at tronwell.net (=?ks_c_5601-1987?B?wOXBpMDO?=)
Date: Fri Jan  9 21:59:15 2004
Subject: [mod_python] pyo?
Message-ID: <HOEJLPEAEKDEMPJEOFLKAEDBCAAA.jijang@tronwell.net>

 .py ===> python file
 .pyc ===> python file -> compile
 .pyo ===> what is it?

From L.A.Timochouk at ukc.ac.uk  Tue Mar  5 12:09:45 2002
From: L.A.Timochouk at ukc.ac.uk (Leonid Timochouk)
Date: Fri Jan  9 21:59:15 2004
Subject: [mod_python] pyo?
In-Reply-To: <HOEJLPEAEKDEMPJEOFLKAEDBCAAA.jijang@tronwell.net>
Message-ID: <Pine.GSO.4.43.0203051207420.18140-100000@myrtle.ukc.ac.uk>

That is a Python byte-code file if compiled with optimisation.
If you run a command like

python -O some_file.py

it will produce "some_file.pyo" byte-code file instead of "some_file.pyc".

Leonid Timochouk
University of Kent at Canterbury


From jijang at tronwell.net  Wed Mar  6 12:19:20 2002
From: jijang at tronwell.net (=?ks_c_5601-1987?B?wOXBpMDO?=)
Date: Fri Jan  9 21:59:15 2004
Subject: [mod_python] i know .pyo...
Message-ID: <HOEJLPEAEKDEMPJEOFLKOEDBCAAA.jijang@tronwell.net>

 
 thx...everybody

 however, .pyc make is py_compile.compile()
 how is make .pyo?

From alain at onesite.org  Wed Mar  6 05:21:50 2002
From: alain at onesite.org (Alain Tesio)
Date: Fri Jan  9 21:59:15 2004
Subject: [mod_python] i know .pyo...
In-Reply-To: <HOEJLPEAEKDEMPJEOFLKOEDBCAAA.jijang@tronwell.net>
References: <HOEJLPEAEKDEMPJEOFLKOEDBCAAA.jijang@tronwell.net>
Message-ID: <20020306052150.310d8489.alain@onesite.org>

On Wed, 6 Mar 2002 12:19:20 +0900
 <jijang@tronwell.net> wrote:

>  
>  thx...everybody
> 
>  however, .pyc make is py_compile.compile()
>  how is make .pyo?

With the same command from a python session started
with python -O

Alain

From llsousa at ualg.pt  Wed Mar  6 15:55:55 2002
From: llsousa at ualg.pt (Luis Sousa)
Date: Fri Jan  9 21:59:15 2004
Subject: [mod_python] Not finding handler on public_html
Message-ID: <3C863C0B.2060901@ualg.pt>

Hi everybody

I installed mod_python on apache 1.3.23-1 and everything went OK.
Reading the documentation I tried to test my server writing some simple 
tests. I created a directory in /var/www called test and I haved copeid 
to her the file mptest.py. I changed the configuration of apache 
introducing new lines to that directory, like in the example in 3.2, 
from the documentation.
Everything went OK.

Then I tried to do the same thing but in my home directory, in 
public_html. Here it gave some errors:

Mod_python error: "PythonHandler mptest"

Traceback (most recent call last):

  File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 181, in Dispatch
    module = import_module(module_name, _req)

  File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 335, in import_module
    f, p, d = imp.find_module(parts[i], path)

ImportError: No module named mptest

What could be the problem that I'm having ?

Thanks in advance.

Luis Sousa




From grisha at modpython.org  Wed Mar  6 14:13:57 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:15 2004
Subject: [mod_python] Not finding handler on public_html
In-Reply-To: <3C863C0B.2060901@ualg.pt>
Message-ID: <Pine.BSF.4.32.0203061402330.55328-100000@localhost>

mod_python prepends to sys.path the directory in which the PythonHandler
directive is specified. So if the PythonHandler is at the top level in
your config file, then you have to set the sys.path manually to make sure
Python can find your script. You can do this using the PythonPath
directive.

On Wed, 6 Mar 2002, Luis Sousa wrote:

> Hi everybody
>
> I installed mod_python on apache 1.3.23-1 and everything went OK.
> Reading the documentation I tried to test my server writing some simple
> tests. I created a directory in /var/www called test and I haved copeid
> to her the file mptest.py. I changed the configuration of apache
> introducing new lines to that directory, like in the example in 3.2,
> from the documentation.
> Everything went OK.
>
> Then I tried to do the same thing but in my home directory, in
> public_html. Here it gave some errors:
>
> Mod_python error: "PythonHandler mptest"
>
> Traceback (most recent call last):
>
>   File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 181, in Dispatch
>     module = import_module(module_name, _req)
>
>   File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 335, in import_module
>     f, p, d = imp.find_module(parts[i], path)
>
> ImportError: No module named mptest
>
> What could be the problem that I'm having ?
>
> Thanks in advance.
>
> Luis Sousa
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From llsousa at ualg.pt  Thu Mar  7 09:45:03 2002
From: llsousa at ualg.pt (Luis Sousa)
Date: Fri Jan  9 21:59:15 2004
Subject: [mod_python] Not finding handler on public_html
References: <Pine.BSF.4.32.0203061402330.55328-100000@localhost>
Message-ID: <3C87369F.40100@ualg.pt>

I put this line in the directory definition of /home/llsousa/public_html 
and It's working:
    PythonPath "sys.path+['/home/llsousa/public_html']"

I tried to put in the directory definition /home/*/public_html a line 
like this and did not worked:
    PythonPath "sys.path+['/home/*/public_html']"
to all home public_html.

Is there a simple way to do this ?

Thanks, Luis Sousa


Gregory (Grisha) Trubetskoy wrote:

>mod_python prepends to sys.path the directory in which the PythonHandler
>directive is specified. So if the PythonHandler is at the top level in
>your config file, then you have to set the sys.path manually to make sure
>Python can find your script. You can do this using the PythonPath
>directive.
>
>On Wed, 6 Mar 2002, Luis Sousa wrote:
>
>>Hi everybody
>>
>>I installed mod_python on apache 1.3.23-1 and everything went OK.
>>Reading the documentation I tried to test my server writing some simple
>>tests. I created a directory in /var/www called test and I haved copeid
>>to her the file mptest.py. I changed the configuration of apache
>>introducing new lines to that directory, like in the example in 3.2,
>>from the documentation.
>>Everything went OK.
>>
>>Then I tried to do the same thing but in my home directory, in
>>public_html. Here it gave some errors:
>>
>>Mod_python error: "PythonHandler mptest"
>>
>>Traceback (most recent call last):
>>
>>  File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 181, in Dispatch
>>    module = import_module(module_name, _req)
>>
>>  File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 335, in import_module
>>    f, p, d = imp.find_module(parts[i], path)
>>
>>ImportError: No module named mptest
>>
>>What could be the problem that I'm having ?
>>
>>Thanks in advance.
>>
>>Luis Sousa
>>
>>
>>
>>_______________________________________________
>>Mod_python mailing list
>>Mod_python@modpython.org
>>http://www.modpython.org/mailman/listinfo/mod_python
>>
>
>
>




From alf at proweb.co.uk  Thu Mar  7 11:37:10 2002
From: alf at proweb.co.uk (alf)
Date: Fri Jan  9 21:59:15 2004
Subject: [mod_python] md5 & MySQLdb
Message-ID: <000d01c1c5cc$6c00b330$6501a8c0@fwoom>

Hi,

I'm having a great time with mod_python, it's doing everything I want so far

except this :

I can import most modules re, string, os, sys, even my own modules but for
some reason when I try and import md5 or MySQLdb I get :
ImportError: No module named md5

When I use the python console I get the expected :
Python 2.2 (#1, Feb 12 2002, 21:26:35)
[GCC 2.95.2 19991024 (release)] on freebsd4T
ype "help", "copyright", "credits" or "license" for more information.
>>> from mod_python import apache
Traceback (most recent call last):  File "<stdin>", line 1, in ?
File "/usr/local/lib/python2.2/site-packages/mod_python/apache.py", line 55,
in ?
import _apache
ImportError: No module named _apache
>>> import md5
>>>

I've ended up writing a routine :

def getMD5(txt) :
    md5fn = "/tmp/md5" + `getpid()`
    system("echo -n \"" + txt + "\" | md5 > " + md5fn)
    md5f = open(md5fn)
    md5l = md5f.readlines()
    md5f.close()
    unlink(md5fn)
    return md5l[0]

presumably it's something to do with md5 & MySQLdb being a c external

any solution?

cheers

Matt


From alain at onesite.org  Thu Mar  7 12:55:25 2002
From: alain at onesite.org (Alain Tesio)
Date: Fri Jan  9 21:59:15 2004
Subject: [mod_python] md5 & MySQLdb
In-Reply-To: <000d01c1c5cc$6c00b330$6501a8c0@fwoom>
References: <000d01c1c5cc$6c00b330$6501a8c0@fwoom>
Message-ID: <20020307125525.2ddc81ac.alain@onesite.org>

On Thu, 7 Mar 2002 11:37:10 -0000
"alf" <alf@proweb.co.uk> wrote:

> Hi,
> 
> I'm having a great time with mod_python, it's doing everything I want so far
> 
> except this :
> 
> I can import most modules re, string, os, sys, even my own modules but for
> some reason when I try and import md5 or MySQLdb I get :
> ImportError: No module named md5
> 
> When I use the python console I get the expected :
> Python 2.2 (#1, Feb 12 2002, 21:26:35)
> [GCC 2.95.2 19991024 (release)] on freebsd4T
> ype "help", "copyright", "credits" or "license" for more information.
> >>> from mod_python import apache
> Traceback (most recent call last):  File "<stdin>", line 1, in ?
> File "/usr/local/lib/python2.2/site-packages/mod_python/apache.py", line 55,
> in ?
> import _apache
> ImportError: No module named _apache
> >>> import md5
> >>>
> 
> I've ended up writing a routine :
> 
> def getMD5(txt) :
>     md5fn = "/tmp/md5" + `getpid()`
>     system("echo -n \"" + txt + "\" | md5 > " + md5fn)
>     md5f = open(md5fn)
>     md5l = md5f.readlines()
>     md5f.close()
>     unlink(md5fn)
>     return md5l[0]
> 
> presumably it's something to do with md5 & MySQLdb being a c external
> 
> any solution?
> 
> cheers
> 
> Matt

Hi, I can import MySQLdb fine, maybe you can add the path to the module
in sys.path
Btw in your function, you could also use a pipe instead of a temporary
file.

Alain

From matt at proweb.co.uk  Thu Mar  7 13:03:54 2002
From: matt at proweb.co.uk (Matt H)
Date: Fri Jan  9 21:59:15 2004
Subject: [mod_python] md5 & MySQLdb
References: <000d01c1c5cc$6c00b330$6501a8c0@fwoom> <20020307125525.2ddc81ac.alain@onesite.org>
Message-ID: <008a01c1c5d8$89c85560$6501a8c0@fwoom>

> Hi, I can import MySQLdb fine, maybe you can add the path to the module in
sys.path

Thanks, knowing it was possible made me fix it.

and I've managed to fix them both
MySQLdb was in /usr/local/lib/python2.2/site-packages
and
md5.so was in /usr/local/lib/python2.2/lib-dynload

so I added them to my PythonPath :

PythonPath "['/usr/local/lib/python2.2', '/usr/local/lib/python2.2/site
-packages', '/usr/local/lib/python2.2/lib-dynload', '/www/python']"

and now they import just fine


shame the PythonPath doesn't do subdirectories!

> Btw in your function, you could also use a pipe instead of a temporary
> file.

y thanks. That light came on for me this morning. tbh I figured someone
would tell me how to import md5 and I could scrap the lot so quick and dirty
would do in order to do the proof of concept


From grisha at modpython.org  Thu Mar  7 10:12:00 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:15 2004
Subject: [mod_python] Not finding handler on public_html
In-Reply-To: <3C87369F.40100@ualg.pt>
Message-ID: <Pine.BSF.4.32.0203071009100.67065-100000@localhost>

This is because "*" doesn't mean anything to Python.

One thing you could do is to AllowOverride FileInfo for all your users,
then they could specify their own PythonHandler or PythonPath in an
.htaccess file in their public_html directory.


Grisha

On Thu, 7 Mar 2002, Luis Sousa wrote:

> I put this line in the directory definition of /home/llsousa/public_html
> and It's working:
>     PythonPath "sys.path+['/home/llsousa/public_html']"
>
> I tried to put in the directory definition /home/*/public_html a line
> like this and did not worked:
>     PythonPath "sys.path+['/home/*/public_html']"
> to all home public_html.
>
> Is there a simple way to do this ?
>
> Thanks, Luis Sousa
>
>
> Gregory (Grisha) Trubetskoy wrote:
>
> >mod_python prepends to sys.path the directory in which the PythonHandler
> >directive is specified. So if the PythonHandler is at the top level in
> >your config file, then you have to set the sys.path manually to make sure
> >Python can find your script. You can do this using the PythonPath
> >directive.
> >
> >On Wed, 6 Mar 2002, Luis Sousa wrote:
> >
> >>Hi everybody
> >>
> >>I installed mod_python on apache 1.3.23-1 and everything went OK.
> >>Reading the documentation I tried to test my server writing some simple
> >>tests. I created a directory in /var/www called test and I haved copeid
> >>to her the file mptest.py. I changed the configuration of apache
> >>introducing new lines to that directory, like in the example in 3.2,
> >>from the documentation.
> >>Everything went OK.
> >>
> >>Then I tried to do the same thing but in my home directory, in
> >>public_html. Here it gave some errors:
> >>
> >>Mod_python error: "PythonHandler mptest"
> >>
> >>Traceback (most recent call last):
> >>
> >>  File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 181, in Dispatch
> >>    module = import_module(module_name, _req)
> >>
> >>  File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 335, in import_module
> >>    f, p, d = imp.find_module(parts[i], path)
> >>
> >>ImportError: No module named mptest
> >>
> >>What could be the problem that I'm having ?
> >>
> >>Thanks in advance.
> >>
> >>Luis Sousa
> >>
> >>
> >>
> >>_______________________________________________
> >>Mod_python mailing list
> >>Mod_python@modpython.org
> >>http://www.modpython.org/mailman/listinfo/mod_python
> >>
> >
> >
> >
>
>
>


From rien at yeepa.org  Thu Mar  7 18:45:31 2002
From: rien at yeepa.org (Adrien Pisson)
Date: Fri Jan  9 21:59:15 2004
Subject: [mod_python] Multiple cookies (not writing, but reading...)
Message-ID: <000701c1c5ff$e186ba40$2cee4cd4@RANDOM>

in all the mailing list archive, i've found many posts asking how to set
multiple cookies.
that's right, it's in the manual, use the method add.

but, if i can write multiple cookies, i can't figure out how i can read
multiple cookies from headers_in.
is there any counterparts to add ? (the manual does not mention it, neither
do the source code for table)

thanks.

--
rien



From grisha at modpython.org  Thu Mar  7 13:11:14 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:15 2004
Subject: [mod_python] Multiple cookies (not writing, but reading...)
In-Reply-To: <000701c1c5ff$e186ba40$2cee4cd4@RANDOM>
Message-ID: <Pine.BSF.4.32.0203071309310.68895-100000@localhost>

If headers_in contains multiple keys with the same name, then when you try
to retrieve this key, the result will be a list. That's bascially all
there is to it :)

On Thu, 7 Mar 2002, Adrien Pisson wrote:

> in all the mailing list archive, i've found many posts asking how to set
> multiple cookies.
> that's right, it's in the manual, use the method add.
>
> but, if i can write multiple cookies, i can't figure out how i can read
> multiple cookies from headers_in.
> is there any counterparts to add ? (the manual does not mention it, neither
> do the source code for table)
>
> thanks.
>
> --
> rien
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From llsousa at ualg.pt  Fri Mar  8 09:35:53 2002
From: llsousa at ualg.pt (Luis Sousa)
Date: Fri Jan  9 21:59:15 2004
Subject: [mod_python] [Fwd: Defining classes using mod_python]
Message-ID: <3C8885F9.2000300@ualg.pt>

Where can I find some examples to implement classes using mod_python ?

I'm using the example that is in the documentation in python.org to 
build a class but something is going wrong.

Thanks, Luis Sousa



From matt at proweb.co.uk  Fri Mar  8 09:38:02 2002
From: matt at proweb.co.uk (Matt H)
Date: Fri Jan  9 21:59:15 2004
Subject: [mod_python] [Fwd: Defining classes using mod_python]
In-Reply-To: <3C8885F9.2000300@ualg.pt>
References: <3C8885F9.2000300@ualg.pt>
Message-ID: <20020308093802.450c7dc1.matt@proweb.co.uk>

On Fri, 08 Mar 2002 09:35:53 +0000
"Luis Sousa" <llsousa@ualg.pt> wrote:

> Where can I find some examples to implement classes using mod_python ?
> 
> I'm using the example that is in the documentation in python.org to 
> build a class but something is going wrong.

I can build classes just fine, what's the actual problem?
 
> Thanks, Luis Sousa
>

From llsousa at ualg.pt  Fri Mar  8 10:56:08 2002
From: llsousa at ualg.pt (Luis Sousa)
Date: Fri Jan  9 21:59:15 2004
Subject: [mod_python] [Fwd: Defining classes using mod_python]
References: <3C8885F9.2000300@ualg.pt> <20020308093802.450c7dc1.matt@proweb.co.uk>
Message-ID: <3C8898C8.6000203@ualg.pt>

I know the problem is mine, so there's goes a simple example !

I have two files, one that I used to define a class and other one that 
calls the class:
    - file that defines the class: pessoalWEB.py

                class MyClass:
                    def __init__ (self):
                        self.x = ''
                        self.y = ''

    - file that uses the class: callClassWEB.py
               
                import pessoal

                def testFunc():
                    MyClass = pessoal.MyClass()
                    saida = MyClass.x
                    saida = MyClass.y
                    if saida=='':
                        saida="NULL"
   
                    return saida

I call this file using 
http://machinename/~llsousa/gpessoal/callClassWEB.py/testFunc in my browser.

The definition that I'm using on httpd.conf for this directory in apache is:

<Directory /home/llsousa/public_html/gpessoal>
    AddHandler python-program .py
    PythonHandler mod_python.publisher
    PythonDebug On
    PythonPath "sys.path+['/home/llsousa/public_html/gpessoal']"
</Directory>

The output that I will expect to return was NULL.
The problem is that in the browser, if I make Reload several times, 
sometimes I get what I expect, other times I got this message:

Mod_python error: "PythonHandler mod_python.publisher"

Traceback (most recent call last):

  File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 
193, in Dispatch
    result = object(req)

  File "/usr/lib/python2.1/site-packages/mod_python/publisher.py", line 
171, in handler
    result = apply(object, (), args)

  File "/home/llsousa/public_html/gpessoal/callClassWEB.py", line 6, in 
testFunc
    saida = MyClass.x

AttributeError: MyClass instance has no attribute 'x'

I was suppose to work all the time. Using the same example in python, 
everything went OK !.

What I'm I doing wrong ????

Thanks, Luis Sousa


Matt H wrote:

>On Fri, 08 Mar 2002 09:35:53 +0000
>"Luis Sousa" <llsousa@ualg.pt> wrote:
>
>>Where can I find some examples to implement classes using mod_python ?
>>
>>I'm using the example that is in the documentation in python.org to 
>>build a class but something is going wrong.
>>
>
>I can build classes just fine, what's the actual problem?
> 
>
>>Thanks, Luis Sousa
>>
>
>




From llsousa at ualg.pt  Fri Mar  8 10:59:18 2002
From: llsousa at ualg.pt (Luis Sousa)
Date: Fri Jan  9 21:59:15 2004
Subject: [Fwd: Re: [mod_python] [Fwd: Defining classes using mod_python]]
Message-ID: <3C889986.9050003@ualg.pt>

Where you read import pessoal, should read import pessoalWEB
----------

I know the problem is mine, so there's goes a simple example !

I have two files, one that I used to define a class and other one that 
calls the class:
    - file that defines the class: pessoalWEB.py

                class MyClass:
                    def __init__ (self):
                        self.x = ''
                        self.y = ''

    - file that uses the class: callClassWEB.py
               
                import pessoal

                def testFunc():
                    MyClass = pessoal.MyClass()
                    saida = MyClass.x
                    saida = MyClass.y
                    if saida=='':
                        saida="NULL"
   
                    return saida

I call this file using 
http://machinename/~llsousa/gpessoal/callClassWEB.py/testFunc in my browser.

The definition that I'm using on httpd.conf for this directory in apache is:

<>
    AddHandler python-program .py
    PythonHandler mod_python.publisher
    PythonDebug On
    PythonPath "sys.path+['/home/llsousa/public_html/gpessoal']"


The output that I will expect to return was NULL.
The problem is that in the browser, if I make Reload several times, 
sometimes I get what I expect, other times I got this message:

Mod_python error: "PythonHandler mod_python.publisher"

Traceback (most recent call last):

  File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 
193, in Dispatch
    result = object(req)

  File "/usr/lib/python2.1/site-packages/mod_python/publisher.py", line 
171, in handler
    result = apply(object, (), args)

  File "/home/llsousa/public_html/gpessoal/callClassWEB.py", line 6, in 
testFunc
    saida = MyClass.x

AttributeError: MyClass instance has no attribute 'x'

I was suppose to work all the time. Using the same example in python, 
everything went OK !.

What I'm I doing wrong ????

Thanks, Luis Sousa


Matt H wrote:

>On Fri, 08 Mar 2002 09:35:53 +0000
>"Luis Sousa" < @ualg.pt=""> wrote:
>
>>Where can I find some examples to implement classes using mod_python ?
>>
>>I'm using the example that is in the documentation in python.org to 
>>build a class but something is going wrong.
>>
>
>I can build classes just fine, what's the actual problem?
> 
>
>>Thanks, Luis Sousa
>>
>
>





From matt at proweb.co.uk  Fri Mar  8 10:40:42 2002
From: matt at proweb.co.uk (Matt H)
Date: Fri Jan  9 21:59:15 2004
Subject: [mod_python] [Fwd: Defining classes using mod_python]
In-Reply-To: <3C8898C8.6000203@ualg.pt>
References: <3C8885F9.2000300@ualg.pt>
	<20020308093802.450c7dc1.matt@proweb.co.uk>
	<3C8898C8.6000203@ualg.pt>
Message-ID: <20020308104042.0a1634a2.matt@proweb.co.uk>

On Fr
> 
> I was suppose to work all the time. Using the same example in python, 
> everything went OK !.
> 
> What I'm I doing wrong ????
> 

ah, I don't use mod_python.publisher 

sorry

From llsousa at ualg.pt  Fri Mar  8 11:19:10 2002
From: llsousa at ualg.pt (Luis Sousa)
Date: Fri Jan  9 21:59:15 2004
Subject: [mod_python] [Fwd: Defining classes using mod_python]
References: <3C8885F9.2000300@ualg.pt>	<20020308093802.450c7dc1.matt@proweb.co.uk>	<3C8898C8.6000203@ualg.pt> <20020308104042.0a1634a2.matt@proweb.co.uk>
Message-ID: <3C889E2E.3010002@ualg.pt>

What do you use then ??


Matt H wrote:

>On Fr
>
>>I was suppose to work all the time. Using the same example in python, 
>>everything went OK !.
>>
>>What I'm I doing wrong ????
>>
>
>ah, I don't use mod_python.publisher 
>
>sorry
>
>




From ts1 at cma.co.jp  Fri Mar  8 20:21:14 2002
From: ts1 at cma.co.jp (SONE Takeshi)
Date: Fri Jan  9 21:59:15 2004
Subject: [Fwd: Re: [mod_python] [Fwd: Defining classes using mod_python]]
In-Reply-To: <3C889986.9050003@ualg.pt>
References: <3C889986.9050003@ualg.pt>
Message-ID: <20020308112113.GA3865@cma.co.jp>

On Fri, Mar 08, 2002 at 10:59:18AM +0000, Luis Sousa wrote:
> What I'm I doing wrong ????

Try reloading (restarting) apache.

-- 
Takeshi

From llsousa at ualg.pt  Fri Mar  8 11:25:46 2002
From: llsousa at ualg.pt (Luis Sousa)
Date: Fri Jan  9 21:59:15 2004
Subject: [Fwd: Re: [mod_python] [Fwd: Defining classes using mod_python]]
References: <3C889986.9050003@ualg.pt>
Message-ID: <3C889FBA.1070107@ualg.pt>

> I have two files, one that I used to define a class and other one that 
> calls the class:
>    - file that defines the class: pessoalWEB.py
>
>                class MyClass:
>                    def __init__ (self):
>                        self.x = ''
>                        self.y = ''
>
>    - file that uses the class: callClassWEB.py
>                 import pessoalWEB
>
>                def testFunc():
>                    MyClass = pessoalWEB.MyClass()
>                    saida = MyClass.x
>                    saida = MyClass.y
>                    if saida=='':
>                        saida="NULL"
>                      return saida
>
> I call this file using 
> http://machinename/~llsousa/gpessoal/callClassWEB.py/testFunc in my 
> browser.

I already saw what was the problem. The object. was not well 
initialized. It was MyClass = pessoal.MyClass() instead of MyClass = 
pessoalWEB.MyClass()

But now I notice something strange. When I define saida = MyClass.k it 
gave no error.
Souldn't it gave an error like this: AttributeError: MyClass instance 
has no attribute 'k' ???

Why it doesn't do that ?

Thanks, Luis Sousa


From matt at proweb.co.uk  Fri Mar  8 11:06:10 2002
From: matt at proweb.co.uk (Matt H)
Date: Fri Jan  9 21:59:15 2004
Subject: [mod_python] [Fwd: Defining classes using mod_python]
In-Reply-To: <3C889E2E.3010002@ualg.pt>
References: <3C8885F9.2000300@ualg.pt>
	<20020308093802.450c7dc1.matt@proweb.co.uk>
	<3C8898C8.6000203@ualg.pt>
	<20020308104042.0a1634a2.matt@proweb.co.uk>
	<3C889E2E.3010002@ualg.pt>
Message-ID: <20020308110610.3aeca7e2.matt@proweb.co.uk>

On Fri, 08 Mar 2002 11:19:10 +0000
"Luis Sousa" <llsousa@ualg.pt> wrote:

> What do you use then ??

something like this :
--- httpd.conf ----------
<Directory /www/python>
  AddHandler python-program .py
  PythonHandler contentAdmin
  PythonDebug On
</Directory>
-------------------------



------- contentAdmin.py -

from mod_python import apache
from mod_python import util

def handler(request):
        global req
        req = request
        req.content_type = "text/html"
        req.send_http_header()

        req.write(getTheHTML())
	

        return apache.OK

-------------------------

I also use this inside a <VirtualHost
---------httpd.conf----------------
	<Location /profile>
                AddHandler python-program .py
                PythonAuthenHandler authHandler
                PythonDebug On
	</Location>
----------

(Directory is a class of my own)

---- authHandler.py --
import Directory
import md5

from mod_python import apache
from mod_python import util


def authenhandler(req):
        pwd = req.get_basic_auth_pw()
        usr = req.connection.user
        if pwd and usr :
                d = Directory.Directory("/www/Users/" + usr)
                mdu = d.getLines('md5')
                if mdu[0][:-1] == md5.new(pwd).hexdigest() :
                         return apache.OK
                else :
                         return apache.HTTP_UNAUTHORIZED
        return apache.HTTP_UNAUTHORIZED


-------------------------

From llsousa at ualg.pt  Fri Mar  8 11:46:42 2002
From: llsousa at ualg.pt (Luis Sousa)
Date: Fri Jan  9 21:59:15 2004
Subject: [mod_python] [Fwd: Defining classes using mod_python]
References: <3C8885F9.2000300@ualg.pt>	<20020308093802.450c7dc1.matt@proweb.co.uk>	<3C8898C8.6000203@ualg.pt>	<20020308104042.0a1634a2.matt@proweb.co.uk>	<3C889E2E.3010002@ualg.pt> <20020308110610.3aeca7e2.matt@proweb.co.uk>
Message-ID: <3C88A4A2.8010809@ualg.pt>

But in this way, there's only an handler for that directory, is that 
correct ?
Suppose that I want to have more than one handler in that directory, for 
my organization

Why do you use a virtual host ? That I didn't get it !!!!


Matt H wrote:

>On Fri, 08 Mar 2002 11:19:10 +0000
>"Luis Sousa" <llsousa@ualg.pt> wrote:
>
>>What do you use then ??
>>
>
>something like this :
>--- httpd.conf ----------
><Directory /www/python>
>  AddHandler python-program .py
>  PythonHandler contentAdmin
>  PythonDebug On
></Directory>
>-------------------------
>
>
>
>------- contentAdmin.py -
>
>from mod_python import apache
>from mod_python import util
>
>def handler(request):
>        global req
>        req = request
>        req.content_type = "text/html"
>        req.send_http_header()
>
>        req.write(getTheHTML())
>	
>
>        return apache.OK
>
>-------------------------
>
>I also use this inside a <VirtualHost
>---------httpd.conf----------------
>	<Location /profile>
>                AddHandler python-program .py
>                PythonAuthenHandler authHandler
>                PythonDebug On
>	</Location>
>----------
>
>(Directory is a class of my own)
>
>---- authHandler.py --
>import Directory
>import md5
>
>from mod_python import apache
>from mod_python import util
>
>
>def authenhandler(req):
>        pwd = req.get_basic_auth_pw()
>        usr = req.connection.user
>        if pwd and usr :
>                d = Directory.Directory("/www/Users/" + usr)
>                mdu = d.getLines('md5')
>                if mdu[0][:-1] == md5.new(pwd).hexdigest() :
>                         return apache.OK
>                else :
>                         return apache.HTTP_UNAUTHORIZED
>        return apache.HTTP_UNAUTHORIZED
>
>
>-------------------------
>
>




From matt at proweb.co.uk  Fri Mar  8 11:48:20 2002
From: matt at proweb.co.uk (Matt H)
Date: Fri Jan  9 21:59:15 2004
Subject: [mod_python] [Fwd: Defining classes using mod_python]
In-Reply-To: <3C88A4A2.8010809@ualg.pt>
References: <3C8885F9.2000300@ualg.pt>
	<20020308093802.450c7dc1.matt@proweb.co.uk>
	<3C8898C8.6000203@ualg.pt>
	<20020308104042.0a1634a2.matt@proweb.co.uk>
	<3C889E2E.3010002@ualg.pt>
	<20020308110610.3aeca7e2.matt@proweb.co.uk>
	<3C88A4A2.8010809@ualg.pt>
Message-ID: <20020308114820.5c359c46.matt@proweb.co.uk>

On Fri, 08 Mar 2002 11:46:42 +0000
"Luis Sousa" <llsousa@ualg.pt> wrote:

> But in this way, there's only an handler for that directory, is that 
> correct ?
> Suppose that I want to have more than one handler in that directory, for
> my organization
> 
> Why do you use a virtual host ? That I didn't get it !!!!
> 

I should have pointed out that /www/python is aliased as my cgi-bin

The bit in the virtual host is just for HTTP authentication of that
particular directory


My setup is probably not correct for all setups. 
I'm the only user so I have a tendancy to do what works today :)

From grisha at modpython.org  Fri Mar  8 10:26:18 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:16 2004
Subject: [Fwd: Re: [mod_python] [Fwd: Defining classes using mod_python]]
In-Reply-To: <3C889FBA.1070107@ualg.pt>
Message-ID: <Pine.BSF.4.32.0203081022130.79915-100000@localhost>

This is probably because you're chaning pessoalWEB but the Python
interpreter ignores those changes because the pessoalWEB module is already
imported. You need to reload pessoalWEB or restart apache. There is a note
about that in the FAQ:

http://www.modpython.org/FAQ/faqw.py?req=all#3.1

P.S. There is nothing wrong with the publisher handler, it should work for
you just fine.

Grisha


On Fri, 8 Mar 2002, Luis Sousa wrote:

> > I have two files, one that I used to define a class and other one that
> > calls the class:
> >    - file that defines the class: pessoalWEB.py
> >
> >                class MyClass:
> >                    def __init__ (self):
> >                        self.x = ''
> >                        self.y = ''
> >
> >    - file that uses the class: callClassWEB.py
> >                 import pessoalWEB
> >
> >                def testFunc():
> >                    MyClass = pessoalWEB.MyClass()
> >                    saida = MyClass.x
> >                    saida = MyClass.y
> >                    if saida=='':
> >                        saida="NULL"
> >                      return saida
> >
> > I call this file using
> > http://machinename/~llsousa/gpessoal/callClassWEB.py/testFunc in my
> > browser.
>
> I already saw what was the problem. The object. was not well
> initialized. It was MyClass = pessoal.MyClass() instead of MyClass =
> pessoalWEB.MyClass()
>
> But now I notice something strange. When I define saida = MyClass.k it
> gave no error.
> Souldn't it gave an error like this: AttributeError: MyClass instance
> has no attribute 'k' ???
>
> Why it doesn't do that ?
>
> Thanks, Luis Sousa
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From llsousa at ualg.pt  Fri Mar  8 16:22:54 2002
From: llsousa at ualg.pt (Luis Sousa)
Date: Fri Jan  9 21:59:16 2004
Subject: [Fwd: Re: [mod_python] [Fwd: Defining classes using mod_python]]
References: <Pine.BSF.4.32.0203081022130.79915-100000@localhost>
Message-ID: <3C88E55E.2030605@ualg.pt>

I tried the sugestion that you gave me but it still working without 
giving me an error !!!
I tried putting the PythonHandler in apache directly to file and it gave 
me the error that I was expecting.

Probably it's some problem in my configuration, or something else !!!
What could it be ?

Luis Sousa

Gregory (Grisha) Trubetskoy wrote:

>This is probably because you're chaning pessoalWEB but the Python
>interpreter ignores those changes because the pessoalWEB module is already
>imported. You need to reload pessoalWEB or restart apache. There is a note
>about that in the FAQ:
>
>http://www.modpython.org/FAQ/faqw.py?req=all#3.1
>
>P.S. There is nothing wrong with the publisher handler, it should work for
>you just fine.
>
>Grisha
>
>
>On Fri, 8 Mar 2002, Luis Sousa wrote:
>
>>>I have two files, one that I used to define a class and other one that
>>>calls the class:
>>>   - file that defines the class: pessoalWEB.py
>>>
>>>               class MyClass:
>>>                   def __init__ (self):
>>>                       self.x = ''
>>>                       self.y = ''
>>>
>>>   - file that uses the class: callClassWEB.py
>>>                import pessoalWEB
>>>
>>>               def testFunc():
>>>                   MyClass = pessoalWEB.MyClass()
>>>                   saida = MyClass.x
>>>                   saida = MyClass.y
>>>                   if saida=='':
>>>                       saida="NULL"
>>>                     return saida
>>>
>>>I call this file using
>>>http://machinename/~llsousa/gpessoal/callClassWEB.py/testFunc in my
>>>browser.
>>>
>>I already saw what was the problem. The object. was not well
>>initialized. It was MyClass = pessoal.MyClass() instead of MyClass =
>>pessoalWEB.MyClass()
>>
>>But now I notice something strange. When I define saida = MyClass.k it
>>gave no error.
>>Souldn't it gave an error like this: AttributeError: MyClass instance
>>has no attribute 'k' ???
>>
>>Why it doesn't do that ?
>>
>>Thanks, Luis Sousa
>>
>>_______________________________________________
>>Mod_python mailing list
>>Mod_python@modpython.org
>>http://www.modpython.org/mailman/listinfo/mod_python
>>
>
>
>




From reitz at inworks.de  Mon Mar 11 19:19:04 2002
From: reitz at inworks.de (Andre Reitz)
Date: Fri Jan  9 21:59:16 2004
Subject: [mod_python] BUG IN cgihandler / setup_cgi
Message-ID: <3C8CF518.FCBFD053@inworks.de>

def setup_cgi(req):
    """
    Replace sys.stdin and stdout with an objects that read/write to
    the socket, as well as substitute the os.environ.
    Returns (environ, stdin, stdout) which you must save and then use
    with restore_nocgi().
    """

    # save env
    env = os.environ.copy() <<<< 1 !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

    si = sys.stdin
    so = sys.stdout

    env = build_cgi_env(req) <<<<< 2 !!!!!!!!!!!!!!!!!!!

    for k in env.keys():
        os.environ[k] = env[k]

    sys.stdout = CGIStdout(req)
    sys.stdin = CGIStdin(req)

    sys.argv = [] # keeps cgi.py happy

    return env, si, so <<<< 3 !!!!!!!!!!!!!!!!!!!!!!!!!


- The env (1) perhaps should be called originalenv
- (2) keep as is
- (3) change to: return originalenv, si, so


Will somebody patch it?

This can cause critical bugs!

Greetings, Andre'

--
_____________________________________________
inworks GmbH            Andre Reitz
Magirusstrasse 44       Tel. 0731/93 80 7-21
89077 Ulm               http://www.inworks.de

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020311/a753796f/attachment-0002.htm
From reitz at inworks.de  Mon Mar 11 19:26:28 2002
From: reitz at inworks.de (Andre Reitz)
Date: Fri Jan  9 21:59:16 2004
Subject: [mod_python] Several Python Installations
Message-ID: <3C8CF6D3.469BA1C2@inworks.de>

I have two python installations on a single machine:

    /usr/bin/python2.1 (with threads, SuSE rpm installation)

and

    /opt/inworks/bin/python2.1   (no threads for mod_python)


Anything compiled good.

mod_python - libs are only installed in
    /opt/inworks/lib/python2.1/site-packages/mod_python

Anything works fine.

BUT: if there is a symbolic link:
  /usr/bin/python -> /usr/bin/python2.1
then mod_python tries to import mod_python.apache from
/usr/lib/python2.1/site-packages and fails.

if I delete  the symbolic link /usr/bin/python and
restart apache anything is good again.


WHY DOES IT BEHAVE LIKE THIS? is it a problem of libpython???

Thank you very much in advance.

--
_____________________________________________
inworks GmbH            Andre Reitz
Magirusstrasse 44       Tel. 0731/93 80 7-21
89077 Ulm               http://www.inworks.de

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020311/c623a917/attachment-0002.htm
From grisha at modpython.org  Mon Mar 11 14:13:19 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:16 2004
Subject: [mod_python] BUG IN cgihandler / setup_cgi
In-Reply-To: <3C8CF518.FCBFD053@inworks.de>
Message-ID: <Pine.BSF.4.32.0203111411110.20785-100000@localhost>

This is clearly a booboo, thanks Andre for pointing it out. I'll make sure
to patch it up in cvs.

On Mon, 11 Mar 2002, Andre Reitz wrote:

> def setup_cgi(req):
>     """
>     Replace sys.stdin and stdout with an objects that read/write to
>     the socket, as well as substitute the os.environ.
>     Returns (environ, stdin, stdout) which you must save and then use
>     with restore_nocgi().
>     """
>
>     # save env
>     env = os.environ.copy() <<<< 1 !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
>
>     si = sys.stdin
>     so = sys.stdout
>
>     env = build_cgi_env(req) <<<<< 2 !!!!!!!!!!!!!!!!!!!
>
>     for k in env.keys():
>         os.environ[k] = env[k]
>
>     sys.stdout = CGIStdout(req)
>     sys.stdin = CGIStdin(req)
>
>     sys.argv = [] # keeps cgi.py happy
>
>     return env, si, so <<<< 3 !!!!!!!!!!!!!!!!!!!!!!!!!
>
>
> - The env (1) perhaps should be called originalenv
> - (2) keep as is
> - (3) change to: return originalenv, si, so
>
>
> Will somebody patch it?
>
> This can cause critical bugs!
>
> Greetings, Andre'
>
> --
> _____________________________________________
> inworks GmbH            Andre Reitz
> Magirusstrasse 44       Tel. 0731/93 80 7-21
> 89077 Ulm               http://www.inworks.de
>
>


From grisha at modpython.org  Mon Mar 11 14:15:22 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:16 2004
Subject: [mod_python] Several Python Installations
In-Reply-To: <3C8CF6D3.469BA1C2@inworks.de>
Message-ID: <Pine.BSF.4.32.0203111414160.20785-100000@localhost>

I don't believe mod_python does anything with those, so its probably
something in libpython..

On Mon, 11 Mar 2002, Andre Reitz wrote:

> I have two python installations on a single machine:
>
>     /usr/bin/python2.1 (with threads, SuSE rpm installation)
>
> and
>
>     /opt/inworks/bin/python2.1   (no threads for mod_python)
>
>
> Anything compiled good.
>
> mod_python - libs are only installed in
>     /opt/inworks/lib/python2.1/site-packages/mod_python
>
> Anything works fine.
>
> BUT: if there is a symbolic link:
>   /usr/bin/python -> /usr/bin/python2.1
> then mod_python tries to import mod_python.apache from
> /usr/lib/python2.1/site-packages and fails.
>
> if I delete  the symbolic link /usr/bin/python and
> restart apache anything is good again.
>
>
> WHY DOES IT BEHAVE LIKE THIS? is it a problem of libpython???
>
> Thank you very much in advance.
>
> --
> _____________________________________________
> inworks GmbH            Andre Reitz
> Magirusstrasse 44       Tel. 0731/93 80 7-21
> 89077 Ulm               http://www.inworks.de
>
>


From EmailCenter at 163.com  Thu Mar 14 14:33:36 2002
From: EmailCenter at 163.com (March 8)
Date: Fri Jan  9 21:59:16 2004
Subject: [mod_python] Pozdravlyaem !!!   March 8 - Sweetness Love  Passion  Happiness  for YOU !!!
Message-ID: <200203140634.g2E6YKs53870@eden.ispol.com>

An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020314/f1e32903/attachment-0002.htm
From barbara.joshua at worldnet.att.net  Sun Mar 17 10:27:54 2002
From: barbara.joshua at worldnet.att.net (Barbara & Joshua Fierer)
Date: Fri Jan  9 21:59:16 2004
Subject: [mod_python] uploading files via forms causes occasional errors
Message-ID: <001e01c1cde1$75fdfd80$096a580c@pavilion>

Hi,

I am trying to upload files HTML forms and mod_python.publisher. I am using the "form"
member of the req object.

Sometimes the upload works fine, just like expected, but then all of a sudden it doesn't work and I get "Internal Server Error".

I am running Apache 1.3.22/mod_python 2.7.6/python 2.1.1 on Redhat 7.1. Below you find the error message from the apache 
errorlog file.

Does anyone know how to fix this ? I really appreciate your help.
thanks.

Stephan Altmueller 


Apache Error log:
=============

[Sat Mar 16 16:44:49 2002] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line 193, in Dispatch
    result = object(req)
[Sat Mar 16 16:44:49 2002] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.1/site-packages/mod_python/publisher.py", line 96, in handler
    fs = util.FieldStorage(req, keep_blank_values=1)
[Sat Mar 16 16:44:49 2002] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.1/site-packages/mod_python/util.py", line 180, in __init__
    file = self.make_file()
[Sat Mar 16 16:44:49 2002] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.1/site-packages/mod_python/util.py", line 207, in make_file
    return tempfile.TemporaryFile("w+b")
[Sat Mar 16 16:44:49 2002] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.1/tempfile.py", line 149, in TemporaryFile
    name = mktemp(suffix)
[Sat Mar 16 16:44:49 2002] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.1/tempfile.py", line 116, in mktemp
    if not os.path.exists(file):
[Sat Mar 16 16:44:49 2002] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.1/posixpath.py", line 171, in exists
    st = os.stat(path)
[Sat Mar 16 16:44:49 2002] [error] PythonHandler mod_python.publisher: OSError: [Errno 2] No such file or directory: '/tmp/@8407.10'

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020317/c0097d26/attachment-0002.htm
From mvolkov at sympatico.ca  Sun Mar 17 13:44:21 2002
From: mvolkov at sympatico.ca (Maxim Volkov)
Date: Fri Jan  9 21:59:16 2004
Subject: [mod_python] Manual ... Installation ... Confusion
Message-ID: <BFEMIAHPFOMFALAEFBKGGENGCAAA.mvolkov@sympatico.ca>

Hello everyone,

Sorry, installation question again.

Is the following statement true :
"Using mod_python you can configure httpd.conf for one and only one script
with .py extension"?
In manual case the file is mptest.py.

If above statement is NOT true can you please give me suggestion about how
httpd.conf or/and mod_python should be modified from mod_python's manual
version :

<Directory /some/directory/htdocs/test>
	AddHandler python-program .py
	PythonHandler mptest
	PythonDebug On
</Directory>

to something more practical?

Yes, I did read manual.
Yes, I do understand how handlers work.
Yes, I paid extra attention to the manual's section 3.2.
Still no luck. Ether only mptest.py runs for all .py files or doesn't work
at all.

My layout: Win2k, Apache 1.3, Python 2.2, mod_python 2.7.6. Mod_python
configured in accordance to the manual (Release 2.7.6).

Or may be mod_python is not really right environment to learn how to use
Python for the Web applications?

Thank you in advance for any suggestions, links or book references.

Maxim Volkov






From bs at wasd.dk  Sun Mar 17 22:53:56 2002
From: bs at wasd.dk (=?iso-8859-1?Q?Bjarke_S=F8rensen?=)
Date: Fri Jan  9 21:59:16 2004
Subject: [mod_python] Manual ... Installation ... Confusion
In-Reply-To: <BFEMIAHPFOMFALAEFBKGGENGCAAA.mvolkov@sympatico.ca>
References: <BFEMIAHPFOMFALAEFBKGGENGCAAA.mvolkov@sympatico.ca>
Message-ID: <32873.80.196.15.227.1016402036.squirrel@wasd.dk>

Maxim Volkov skrev:
> Is the following statement true :
> "Using mod_python you can configure httpd.conf for one and only one
> script with .py extension"?
> In manual case the file is mptest.py.

As I see it you can create Handlers in mod_python, which then serve your
.something files.

I agree  that the manual is a bit unclear.
But installing a 3rd party mod_python like maki made things clearer to me.

> Yes, I do understand how handlers work.

Sure?

mod_python allows Python developers to write modules which plugs into the
Apache webserver, and have access to some of the internals.


> Yes, I paid extra attention to the manual's section 3.2.

I read that 4 times, I first understood after the maki mentioned above.


> Still no luck. Ether only mptest.py runs for all .py files or doesn't
> work at all.

Yup.


> Or may be mod_python is not really right environment to learn how to
> use Python for the Web applications?

mod_snake offers Python embedded in html (? l? php).
(Sorry if that is inapropiate for this list.)

> Thank you in advance for any suggestions, links or book references.

maki: http://maki.sourceforge.net/
mod_snake: http://modsnake.sourceforge.net/

> Maxim Volkov

Any relations? (Sorry, couldn't resist ;)

-- 
+-----------------+
| Bjarke S?rensen |
|  <bs@wasd.dk>   |
| http://wasd.dk/ |
+-----------------+



From jw9 at softhome.net  Mon Mar 18 22:34:07 2002
From: jw9 at softhome.net (jw9@softhome.net)
Date: Fri Jan  9 21:59:16 2004
Subject: [mod_python] Windows 2000 + Apache 1.3.23 + python2.2 + mod_python 2.76, Error
Message-ID: <003e01c1cef6$ed0e2b50$a4c9cd80@laptop>

"""
Syntax error on line 627 of d:/apache group/apache/conf/httpd.conf:
Invalid command 'PythonHandler', perhaps mis-spelled or defined by a module
not included in the server configuration
Note the errors or messages above, and press the <ESC> key to exit.  26...
""
Can anybody help me?

Actually the mod_python.dll I downloaded is for apache 1.3.22,  Could that
be the problem?

My httpd.conf file is attached, just in case.

Thanks!
-------------- next part --------------
A non-text attachment was scrubbed...
Name: httpd.conf
Type: application/octet-stream
Size: 35903 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20020318/c8d356db/httpd-0002.obj
From rien at yeepa.org  Tue Mar 19 19:13:59 2002
From: rien at yeepa.org (Adrien Pisson)
Date: Fri Jan  9 21:59:16 2004
Subject: [mod_python] Windows 2000 + Apache 1.3.23 + python2.2 + mod_python 2.76, Error
References: <003e01c1cef6$ed0e2b50$a4c9cd80@laptop>
Message-ID: <002401c1cf71$d92d18f0$2cee4cd4@RANDOM>

I'm using windows 2000 too.

When i first added the "LoadModule python_module modules/mod_python.dll",
the server complained about not being able to do something i don't remember
with a *.c file.
So i added "AddModule mod_python.c" and even if i don't have any
mod_python.c, it works fine.

In case this do not help in any way, enable the server-info module by
uncommenting the following lines:
LoadModule info_module modules/mod_info.so
AddModule mod_info.c
and all other lines related to server-info (you may have to change the
"Location /server-info" directive to allow it from all) .
Then launch a browser, and type http://localhost/server-info/. From this
page you can look at the modules loaded, and see if mod_python is correctly
installed.

--
rien

ps: btw, it seems there are some many errors in the mod_python manual
concerning windows installation... or the manual is unclear...
i'm not sure of all i say but if anybody as some explanations, they are
welcome. Here it is

- point 1:
  * "Move (or just drag & drop) the mod python-x folder into the Python lib
     folder (i.e C:\ Program Files\ Python\ lib)."
    i'm not sure of it, but i think the mod_python-x folder should be also
    renamed 'mod_python'

  * "Move the files in the folder lib inside the mod python folder (C:\
     Program Files\ Python\ lib\ mod_python-x\ lib\ mod python) to the
     C:\ Program Files\ Python\ lib\ mod_python folder. It's safe to delete
these folders we
     just emptied."
    the first path is incorrect: it's
'...\lib\mod_python-x\python\mod_python\'

- point 2:
  * it talks about adding the LoadModule directive, but on my installation,
i
    had also to add a AddModule directive (i don't really know why...)


From jw9 at softhome.net  Wed Mar 20 01:08:01 2002
From: jw9 at softhome.net (jw9@softhome.net)
Date: Fri Jan  9 21:59:16 2004
Subject: [mod_python] Windows 2000 + Apache 1.3.23 + python2.2 + mod_python 2.76, Error
References: <003e01c1cef6$ed0e2b50$a4c9cd80@laptop> <002401c1cf71$d92d18f0$2cee4cd4@RANDOM>
Message-ID: <002001c1cfd5$97533180$4a00a8c0@laptop>

just put in "AddModule mod_python.c", and it works just fine.

Thanks, Adrien, and maybe somebody should put this into the mod_python
manual.

----- Original Message -----
From: "Adrien Pisson" <rien@yeepa.org>
To: <jw9@softhome.net>; <mod_python@modpython.org>
Sent: Tuesday, March 19, 2002 1:13 PM
Subject: Re: [mod_python] Windows 2000 + Apache 1.3.23 + python2.2 +
mod_python 2.76, Error


> I'm using windows 2000 too.
>
> When i first added the "LoadModule python_module modules/mod_python.dll",
> the server complained about not being able to do something i don't
remember
> with a *.c file.
> So i added "AddModule mod_python.c" and even if i don't have any
> mod_python.c, it works fine.
>
> In case this do not help in any way, enable the server-info module by
> uncommenting the following lines:
> LoadModule info_module modules/mod_info.so
> AddModule mod_info.c
> and all other lines related to server-info (you may have to change the
> "Location /server-info" directive to allow it from all) .
> Then launch a browser, and type http://localhost/server-info/. From this
> page you can look at the modules loaded, and see if mod_python is
correctly
> installed.
>
> --
> rien
>
> ps: btw, it seems there are some many errors in the mod_python manual
> concerning windows installation... or the manual is unclear...
> i'm not sure of all i say but if anybody as some explanations, they are
> welcome. Here it is
>
> - point 1:
>   * "Move (or just drag & drop) the mod python-x folder into the Python
lib
>      folder (i.e C:\ Program Files\ Python\ lib)."
>     i'm not sure of it, but i think the mod_python-x folder should be also
>     renamed 'mod_python'
>
>   * "Move the files in the folder lib inside the mod python folder (C:\
>      Program Files\ Python\ lib\ mod_python-x\ lib\ mod python) to the
>      C:\ Program Files\ Python\ lib\ mod_python folder. It's safe to
delete
> these folders we
>      just emptied."
>     the first path is incorrect: it's
> '...\lib\mod_python-x\python\mod_python\'
>
> - point 2:
>   * it talks about adding the LoadModule directive, but on my
installation,
> i
>     had also to add a AddModule directive (i don't really know why...)
>


From bob at redivi.com  Wed Mar 20 11:12:20 2002
From: bob at redivi.com (Bob Ippolito)
Date: Fri Jan  9 21:59:16 2004
Subject: [mod_python] Compiling on MacOS X
In-Reply-To: <2174778112.1014679254@kelethin>
Message-ID: <41D1077D-3C1D-11D6-9796-0003938210D6@redivi.com>

I have successfully compiled mod_python on MacOS X 10.1.3.  I did it the 
other night bored at the hotel on a business trip, because I didn't have 
net access and wanted to debug some stuff.

I have actually planned on releasing it more properly, but I was having 
issues with metapackages.. anyhow, here you go:

http://redivi.com/~bob/mod_python-2.7.6-osx.dmg.gz

-bob

On Monday, February 25, 2002, at 06:20 PM, Brian Brown wrote:

> Greetings!
>  I am trying to compile mod_python 2.7.6 on MacOS 10.1.3 with no 
> success. I get the following:
>
> cc: cannot specify -o with -c or -S with multiple compilations
>
>
> I tried to take the -c out of the src/Makefile, but it had no effect on 
> the make process... any ideas?
>
> Brian
>
> /-----------------
> Brian Brown
> ICCE Technologies, Inc.
> http://www.icce-t.com
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From bob at redivi.com  Wed Mar 20 11:18:10 2002
From: bob at redivi.com (Bob Ippolito)
Date: Fri Jan  9 21:59:16 2004
Subject: [mod_python] File upload progress indicator
Message-ID: <126119D2-3C1E-11D6-9796-0003938210D6@redivi.com>

I'm developing an application using mod_python and I'd like to include 
file upload progress indication.. However, I don't see any obvious way 
on how do to such a thing.

It's possible in mod_perl, and I've done it before, using 
Apache::Request (see http://httpd.apache.org/apreq/Apache-Request.html)

Is this functionality possible in the current incarnation of mod_python 
or should I write this component in mod_perl or C?

-bob


From bakey at traq.com  Wed Mar 20 10:52:29 2002
From: bakey at traq.com (Brian Akey)
Date: Fri Jan  9 21:59:16 2004
Subject: [mod_python] File upload progress indicator
Message-ID: <780A5D64B1CC9544AB7B702F39219C1E60E0@traqexch.traq.com>

I have a cgi python script that does upload. It should be easy to convert.
#!/usr/bin/python

import cgi
form = cgi.FieldStorage()
print 'Content-type: text/html'
print

if not form:
        print """
        <html><head><title>File Upload</title></head><body>
        <form action"/cgi-bin/file.py" method="POST"
enctype="multipart/form-data">
        <input type="file" name="filename">
        <input type="submit" name="Send_File" value="Send_File">
        </form>
        <p>Please compress the file(s) with Winzip or some other compression

tool before sending the file.
        </body></html>
        """
elif form.has_key("filename"):
        item = form["filename"]
        if item.file:
                data = item.file.read()
                filen = item.filename
                filen1 = filen.split('\\')
                filen2 = filen1[len(filen1)-1]
                #filen2 = 'd.txt'
                open('/www/download/' + filen2 + '.tmp','wb').write(data)
                print """
                <html><head><title>File Upload</title></head><body>
                Thank you for the file
                """
                print cgi.escape(filen2)
                print '</body></html>'

-----Original Message-----
From: Bob Ippolito [mailto:bob@redivi.com]
Sent: Wednesday, March 20, 2002 10:18 AM
To: mod_python@modpython.org
Subject: [mod_python] File upload progress indicator


I'm developing an application using mod_python and I'd like to include 
file upload progress indication.. However, I don't see any obvious way 
on how do to such a thing.

From bob at redivi.com  Wed Mar 20 12:10:28 2002
From: bob at redivi.com (Bob Ippolito)
Date: Fri Jan  9 21:59:16 2004
Subject: [mod_python] File upload progress indicator
In-Reply-To: <780A5D64B1CC9544AB7B702F39219C1E60E0@traqexch.traq.com>
Message-ID: <604E6B08-3C25-11D6-9796-0003938210D6@redivi.com>

Brian,

The problem isn't with file uploading in general, I want to generate 
near-realtime progress indications of the file upload's progress.  Which 
should be possible by examining the Content-length header and making a 
separate connection to the webserver, tracked via a session cookie.  
It's actually really nice to be able to do this asynchronously in Flash 
5.0+ using XML sockets, which I may or may not end up doing.  I'll 
probably open source this component of it since it's really quite 
useful, given that the status bars in IE don't tell you the progress of 
a file upload, only if it's still going or not (and even then, not very 
obviously).

The problem is that when you use FieldStorage, you have already 
processed the file upload.  You don't get callbacks when apache is 
reading.

My client is going to be dealing with large files quite often, and 
although I didn't specify that I was going to provide them this advanced 
functionality, I would like to give it to them anyway as it's really 
nice from a UI standpoint.

-bob

On Wednesday, March 20, 2002, at 11:52 AM, Brian Akey wrote:

> I have a cgi python script that does upload. It should be easy to 
> convert.
> --snip--
>
> -----Original Message-----
> From: Bob Ippolito [mailto:bob@redivi.com]
> Sent: Wednesday, March 20, 2002 10:18 AM
> To: mod_python@modpython.org
> Subject: [mod_python] File upload progress indicator
>
>
> I'm developing an application using mod_python and I'd like to include
> file upload progress indication.. However, I don't see any obvious way
> on how do to such a thing.


From bob at redivi.com  Wed Mar 20 12:36:15 2002
From: bob at redivi.com (Bob Ippolito)
Date: Fri Jan  9 21:59:16 2004
Subject: [mod_python] Compiling on MacOS X
In-Reply-To: <41D1077D-3C1D-11D6-9796-0003938210D6@redivi.com>
Message-ID: <FA803D73-3C28-11D6-9796-0003938210D6@redivi.com>

fyi, I setup a small container page for it and released on 
versiontracker.. prepare for the flood of new osx users of mod_python 
(hopefully) :)

http://redivi.com/~bob/mod_python.html
http://www.versiontracker.com/moreinfo.fcgi?id=14075&db=macosx

-bob

On Wednesday, March 20, 2002, at 11:12 AM, Bob Ippolito wrote:

> I have successfully compiled mod_python on MacOS X 10.1.3.  I did it 
> the other night bored at the hotel on a business trip, because I didn't 
> have net access and wanted to debug some stuff.
>
> I have actually planned on releasing it more properly, but I was having 
> issues with metapackages.. anyhow, here you go:
>
> http://redivi.com/~bob/mod_python-2.7.6-osx.dmg.gz
>
> -bob
>
> On Monday, February 25, 2002, at 06:20 PM, Brian Brown wrote:
>
>> Greetings!
>>  I am trying to compile mod_python 2.7.6 on MacOS 10.1.3 with no 
>> success. I get the following:
>>
>> cc: cannot specify -o with -c or -S with multiple compilations
>>
>>
>> I tried to take the -c out of the src/Makefile, but it had no effect 
>> on the make process... any ideas?
>>
>> Brian
>>
>> /-----------------
>> Brian Brown
>> ICCE Technologies, Inc.
>> http://www.icce-t.com
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://www.modpython.org/mailman/listinfo/mod_python
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From bbrown at icce-t.com  Wed Mar 20 13:31:18 2002
From: bbrown at icce-t.com (Brian Brown)
Date: Fri Jan  9 21:59:16 2004
Subject: [mod_python] Compiling on MacOS X
In-Reply-To: <FA803D73-3C28-11D6-9796-0003938210D6@redivi.com>
References: <FA803D73-3C28-11D6-9796-0003938210D6@redivi.com>
Message-ID: <26200000.1016656278@kelethin.icce-t.com>

--On Wednesday, March 20, 2002 12:36:15 PM -0500 Bob Ippolito 
<bob@redivi.com> wrote:

> fyi, I setup a small container page for it and released on
> versiontracker.. prepare for the flood of new osx users of mod_python
> (hopefully) :)
>

Thanks Bob! You're a lifesaver :)



> http://redivi.com/~bob/mod_python.html
> http://www.versiontracker.com/moreinfo.fcgi?id=14075&db=macosx
>
> -bob
>
> On Wednesday, March 20, 2002, at 11:12 AM, Bob Ippolito wrote:
>
>> I have successfully compiled mod_python on MacOS X 10.1.3.  I did it
>> the other night bored at the hotel on a business trip, because I didn't
>> have net access and wanted to debug some stuff.
>>
>> I have actually planned on releasing it more properly, but I was having
>> issues with metapackages.. anyhow, here you go:
>>
>> http://redivi.com/~bob/mod_python-2.7.6-osx.dmg.gz
>>
>> -bob
>>
>> On Monday, February 25, 2002, at 06:20 PM, Brian Brown wrote:
>>
>>> Greetings!
>>>  I am trying to compile mod_python 2.7.6 on MacOS 10.1.3 with no
>>> success. I get the following:
>>>
>>> cc: cannot specify -o with -c or -S with multiple compilations
>>>
>>>
>>> I tried to take the -c out of the src/Makefile, but it had no effect
>>> on the make process... any ideas?
>>>
>>> Brian
>>>
>>> /-----------------
>>> Brian Brown
>>> ICCE Technologies, Inc.
>>> http://www.icce-t.com
>>> _______________________________________________
>>> Mod_python mailing list
>>> Mod_python@modpython.org
>>> http://www.modpython.org/mailman/listinfo/mod_python
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://www.modpython.org/mailman/listinfo/mod_python
>
>
>

/-----------------
Brian Brown
ICCE Technologies, Inc.
http://www.icce-t.com

From ian at veryfresh.com  Wed Mar 20 17:31:10 2002
From: ian at veryfresh.com (Ian Clelland)
Date: Fri Jan  9 21:59:16 2004
Subject: [mod_python] Problems with GET after POST
Message-ID: <20020321013110.GE1811@fullfactor.com>

I have been experimenting with mod_python to evaluate it for some 
upcoming projects, and I recently came across what appeared to be a bug 
in mod_python.  (After three days of scratching my head over this, the 
solution came to me as I was writing this message, but I'm sending it 
anyway in case someone else comes across this problem. -- Should this 
sort of thing go into the FAQ?)

The problem was essentially that whenever I performed a GET request on 
a URL immediately following a POST request to that same URL, Apache 
would seem to confuse the two requests, and after the GET, I would 
receive an error message like this:

HTTP/1.1 501 Method Not Implemented

key=valueGET to /pytest not supported
Invalid method in request key=valueGET /pytest


Running tcpdump on the communication between the browser and server 
showed that the requests were all well-formed, and there was nothing 
unusual in the headers to suggest that anything but Apache/mod_python 
was at fault.


The simplest script I could produce to replicate the problem was this:

# -------------------------------------------------------------------
import sys
from mod_python import apache

def handler(req):

  if req.method == 'GET':
  
    req.content_type = "text/html"
    req.send_http_header()
    req.write("""<html>
<head>
  <title>python test</title>
</head>
<body>
  <form method=\"post\" action=\"/pytest\">
    <input name=\"key\" value=\"value\"> <input type=\"submit\">
  </form>
</body>
</html>
""")

    return apache.OK

  elif req.method == 'POST':

    req.content_type = "text/html"
    req.send_http_header()
    req.write("""<html>
<head>
  <title>python test part 2</title>
</head>
<body>
  <p>POST successful. <a href=\"/pytest\">Click here</a></p>
</body>
</html>
""")
    return apache.OK

  else:
    return apache.DECLINED
# -------------------------------------------------------------------

It was supported by these Apache configuration directives:

<Location "/pytest">
  SetHandler python-program
  PythonPath "sys.path+['/home/ian/src/pytest']"
  PythonHandler python_test
</Location>


The script is accessable from the virtual URL /pytest, which runs the 
python_test.py module from a non-web-accessable directory. Going to the 
URL /pytest in Mozilla, hitting the submit button, then clicking on the 
'Click here' link brings up the error message.

The problem with this code (as it became apparent to me while writing 
this message) is that the POST handler never actually reads the POST 
data, and so it stays on stdin, and Apache treats it as the beginning 
of the next request. Simply inserting the line 'postdata = req.read()' 
gets rid of the error.

Questions:

Is this the correct behaviour for mod_python? Is it the python module 
writer's responsibility to read all POST data in all situations? What 
if the data is very large (say, a 5MB file when I expected a small text 
field) and I just want to discard it?


Ian
<ian@veryfresh.com>

From charney at charneyday.com  Wed Mar 20 21:34:32 2002
From: charney at charneyday.com (Reginald Charney)
Date: Fri Jan  9 21:59:16 2004
Subject: [mod_python] Installation problems
Message-ID: <200203210536.g2L5akf61316@mail.via.net>

I am unable to get mod_python working on my system. I think I have followed everything needed and documented, but when I enter the following URLs, I get:

/test/mptest.py  - I am asked what program to use to execute this file
/test/mptest      - lists the ASCII source of the file

The following is what I believe is the relevant information from my installation. Any help would be appreciated. TIA.

Reg. Charney

Partial contents of /etc/httpd/httpd.conf
=========================================

    #
    # And for PHP 4.x, use:
    #
    <IfModule mod_php4.c>
    AddType application/x-httpd-php .php
    AddType application/x-httpd-php .php4
    AddType application/x-httpd-php-source .phps
    </IfModule>

    #
    # And for mod_python, use:
    #
    <IfModule mod_python.c>
    AddType application/x-httpd-py .py
    </IfModule>
...
<Directory /usr/local/httpd/htdocs/test>
    AddHandler python-program .py
    PythonHandler mptest
    PythonDebug On
</Directory>


Test file /test/mptest.py
=========================

from mod_python import apache

def handler(req):
        req.send_http_header()
        req.write("hello world!")
        return apache.OK


Output from phpinfo()
=====================
System:		Linux x330-2 2.4.9 #3 SMP Wed Feb 13 15:02:07
Server Root:	/usr/local/httpd
Loaded Modules:	mod_userdir, mod_python, mod_php4, mod_perl, mod_setenvif, mod_unique_id, mod_usertrack, mod_headers, mod_expires, mod_cern_meta, mod_proxy, mod_digest, mod_auth_db, mod_auth_dbm, mod_auth_anon, mod_auth, mod_access, mod_rewrite, mod_alias, mod_speling, mod_actions, mod_imap, mod_asis, mod_cgi, mod_dir, mod_autoindex, mod_include, mod_info, mod_status, mod_negotiation, mod_mime, mod_mime_magic, mod_log_referer, mod_log_agent, mod_log_config, mod_define, mod_env, mod_vhost_alias, mod_mmap_static, mod_so, http_core

PYTHONPATH:	/usr/lib/python2.1:/usr/lib/python2.1/plat-linux2:/usr/lib/python2.1/lib-tk:/usr/lib/python2.1/lib-dynload:/usr/lib/python2.1/site-packages:/usr/lib/apache/lib/python/site-packages

SERVER_SOFTWARE: Apache/1.3.20 (Linux/SuSE) mod_python/2.7.5 Python/2.1.1 PHP/4.0.6 mod_perl/1.26

HTTP_ENV_VARS["PATH"]:	/usr/sbin:/bin:/usr/bin:/sbin:/usr/X11R6/bin 

From jeffstearns at attbi.com  Wed Mar 20 23:50:22 2002
From: jeffstearns at attbi.com (Jeff Stearns)
Date: Fri Jan  9 21:59:16 2004
Subject: [mod_python] Broken reload algorithm?
Message-ID: <4C727568-3CA0-11D6-9CF0-0030653DCC28@attbi.com>

I'm using the publisher handler with mod_python 2.7.6.  I'm doing 
development, so auto-reload is turned on.

This causes broken behavior.  I blame it on line 365 in apache.py:

     # if module is newer - reload
     if (autoreload and (oldmtime < mtime)):
         module = reload(module)

The code here assumes that the module can be found in sys.path. But 
that's not guaranteed when using publisher. The module may be found 
anywhere in the document tree.  Unfortunately, that provokes an 
exception.

I believe that the call to reload() should be replaced with 
imp.load_module(). The imp.load_module function *does* handle reloading, 
and it can be given the path to the module.  Unfortunately, the code 
needs to be reworked to test this theory.

Comments?  Am I missing the point here?

thx - jeff stearns


From ian at veryfresh.com  Thu Mar 21 03:16:59 2002
From: ian at veryfresh.com (Ian Clelland)
Date: Fri Jan  9 21:59:16 2004
Subject: [mod_python] Installation problems
In-Reply-To: <200203210536.g2L5akf61316@mail.via.net>
References: <200203210536.g2L5akf61316@mail.via.net>
Message-ID: <20020321111659.GA8699@fullfactor.com>

I believe that your problems stem from the fact that you are trying to 
use mod_python as if it was a 'traditional' scripting language like PHP 
or ASP.

With either of those languages, you can simply write scripts with the 
appropriate extensions, place them in a web-accessable directory, and 
they're automatically executable.

With mod_python, you are actually writing Apache modules in the python 
language. You need to use Apache directives to configure those modules 
to be activated at the appropriate times.

Depending on how you want to do things, I see two ways to get your test 
script to run:

1) Install the script as a handler. This is the closest to what you are 
   currently doing. The problem is that Python cannot find your module. 
   You can just add the line

     PythonPath "sys.path+['/usr/local/httpd/htdocs/test']"

   to your <Directory> entry, and the module should load.

2) Use the supplied Publisher handler (check the tutorial at 
   www.modpython.org). This is a great hack which allows a single 
   handler to load .py files from anywhere in your site. It appears to 
   be closer to what you intended to do, which is to just run a .py 
   file out of a URL.


I hope that helps clear things up.

A couple of quick points about your original email:

> /test/mptest.py  - I am asked what program to use to execute this file
This is because you have associated a MIME type with the .py extension, 
and Apache doesn't know what to do with it. (The mod_python module 
doesn't deal with MIME types like mod_php). The only thing it can do is 
offer the file for download.

> /test/mptest      - lists the ASCII source of the file
In this case, Apache's content negotiation is finding the best match 
for /mptest and returning that to you as a text document.

>     <IfModule mod_python.c>
>     AddType application/x-httpd-py .py
>     </IfModule>
This section is unnecessary, and should probably be deleted.

> PYTHONPATH:	/usr/lib/python2.1:/usr/lib/python2.1/plat-linux2:
> /usr/lib/python2.1/lib-tk:/usr/lib/python2.1/lib-dynload:/usr/lib/
> python2.1/site-packages:/usr/lib/apache/lib/python/site-packages
This variable shows the locations where Python will look for modules 
when you use an import statement (or a Python*Handler directive). Since 
/usr/local/httpd/htdocs/test is not in the list, Python cannot find 
your mptest module.


Regards,
Ian
<ian@veryfresh.com>

From maynard at mpi-cbg.de  Thu Mar 21 13:15:18 2002
From: maynard at mpi-cbg.de (Gary Maynard)
Date: Fri Jan  9 21:59:16 2004
Subject: [mod_python] persistant variables
In-Reply-To: <20020321111659.GA8699@fullfactor.com>
Message-ID: <NCEILGMPEAMDGEALMLEMKEJFCAAA.maynard@mpi-cbg.de>

Hi,
  I want to know how to store persistant variables in mod_python. I have
written some simple code that works like this:

def handler(req):
        global testthis
        try:
                d = testthis
        except:
                testthis = 1
        req.send_http_header()
        req.write(str(testthis))
        testthis = testthis + 1
        return apache.OK

each time the script is run it should print the last value of testthis and
then increment it.

However, because Apache has several servers running, I end up with several
instances of testhis, one of which gets printed and incremented each time.

How can I force mod_python to only have one instance of the variable? Or
should I be trying to do this in an entirely different way?

I can set Apache to only start with one server (which makes it work),
however it will spawn more servers if it gets two hits at the same time, so
this won't really work.

thanks
Gary




From grisha at modpython.org  Thu Mar 21 09:54:57 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:17 2004
Subject: [mod_python] Installation problems
In-Reply-To: <200203210536.g2L5akf61316@mail.via.net>
Message-ID: <Pine.BSF.4.32.0203210950420.55815-100000@localhost>

Just before sending headers, add a line like this:

        req.content_type = "text/plain"
        req.send_http_header()

and try the url which asks you what program to use, it might just work.
Apache sets different content-types based on your configuration, which can
vary, so sometimes you have to force it to text/plain or text/html.

Grisha


On Wed, 20 Mar 2002, Reginald Charney wrote:

> I am unable to get mod_python working on my system. I think I have followed everything needed and documented, but when I enter the following URLs, I get:
>
> /test/mptest.py  - I am asked what program to use to execute this file
> /test/mptest      - lists the ASCII source of the file
>
> The following is what I believe is the relevant information from my installation. Any help would be appreciated. TIA.
>
> Reg. Charney
>
> Partial contents of /etc/httpd/httpd.conf
> =========================================
>
>     #
>     # And for PHP 4.x, use:
>     #
>     <IfModule mod_php4.c>
>     AddType application/x-httpd-php .php
>     AddType application/x-httpd-php .php4
>     AddType application/x-httpd-php-source .phps
>     </IfModule>
>
>     #
>     # And for mod_python, use:
>     #
>     <IfModule mod_python.c>
>     AddType application/x-httpd-py .py
>     </IfModule>
> ...
> <Directory /usr/local/httpd/htdocs/test>
>     AddHandler python-program .py
>     PythonHandler mptest
>     PythonDebug On
> </Directory>
>
>
> Test file /test/mptest.py
> =========================
>
> from mod_python import apache
>
> def handler(req):
>         req.send_http_header()
>         req.write("hello world!")
>         return apache.OK
>
>
> Output from phpinfo()
> =====================
> System:		Linux x330-2 2.4.9 #3 SMP Wed Feb 13 15:02:07
> Server Root:	/usr/local/httpd
> Loaded Modules:	mod_userdir, mod_python, mod_php4, mod_perl, mod_setenvif, mod_unique_id, mod_usertrack, mod_headers, mod_expires, mod_cern_meta, mod_proxy, mod_digest, mod_auth_db, mod_auth_dbm, mod_auth_anon, mod_auth, mod_access, mod_rewrite, mod_alias, mod_speling, mod_actions, mod_imap, mod_asis, mod_cgi, mod_dir, mod_autoindex, mod_include, mod_info, mod_status, mod_negotiation, mod_mime, mod_mime_magic, mod_log_referer, mod_log_agent, mod_log_config, mod_define, mod_env, mod_vhost_alias, mod_mmap_static, mod_so, http_core
>
> PYTHONPATH:	/usr/lib/python2.1:/usr/lib/python2.1/plat-linux2:/usr/lib/python2.1/lib-tk:/usr/lib/python2.1/lib-dynload:/usr/lib/python2.1/site-packages:/usr/lib/apache/lib/python/site-packages
>
> SERVER_SOFTWARE: Apache/1.3.20 (Linux/SuSE) mod_python/2.7.5 Python/2.1.1 PHP/4.0.6 mod_perl/1.26
>
> HTTP_ENV_VARS["PATH"]:	/usr/sbin:/bin:/usr/bin:/sbin:/usr/X11R6/bin
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From grisha at modpython.org  Thu Mar 21 10:05:09 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:17 2004
Subject: [mod_python] Broken reload algorithm?
In-Reply-To: <4C727568-3CA0-11D6-9CF0-0030653DCC28@attbi.com>
Message-ID: <Pine.BSF.4.32.0203210957210.55815-100000@localhost>

It looks like you're right about this - I looked at the Python code
(Python/import.c) and it seems like it searches the path again for reload.
When I wrote this I was under the impression that Python would just reload
the original file from which the module came.

I'll make a note of this.

My mod_python todo list is just getting so huge...

Grisha


On Wed, 20 Mar 2002, Jeff Stearns wrote:

> I'm using the publisher handler with mod_python 2.7.6.  I'm doing
> development, so auto-reload is turned on.
>
> This causes broken behavior.  I blame it on line 365 in apache.py:
>
>      # if module is newer - reload
>      if (autoreload and (oldmtime < mtime)):
>          module = reload(module)
>
> The code here assumes that the module can be found in sys.path. But
> that's not guaranteed when using publisher. The module may be found
> anywhere in the document tree.  Unfortunately, that provokes an
> exception.
>
> I believe that the call to reload() should be replaced with
> imp.load_module(). The imp.load_module function *does* handle reloading,
> and it can be given the path to the module.  Unfortunately, the code
> needs to be reworked to test this theory.
>
> Comments?  Am I missing the point here?
>
> thx - jeff stearns
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From stony8 at gmx.de  Fri Mar 22 17:18:50 2002
From: stony8 at gmx.de (Alexander Steinert)
Date: Fri Jan  9 21:59:17 2004
Subject: [mod_python] persistant variables
In-Reply-To: <NCEILGMPEAMDGEALMLEMKEJFCAAA.maynard@mpi-cbg.de>; from maynard@mpi-cbg.de on Thu, Mar 21, 2002 at 01:15:18PM +0100
References: <20020321111659.GA8699@fullfactor.com> <NCEILGMPEAMDGEALMLEMKEJFCAAA.maynard@mpi-cbg.de>
Message-ID: <20020322171850.A1049@tyche.svt.tu-harburg.de>

> How can I force mod_python to only have one instance of the variable? Or
> should I be trying to do this in an entirely different way?
> 
> I can set Apache to only start with one server (which makes it work),
> however it will spawn more servers if it gets two hits at the same time, so
> this won't really work.

I thought about this topic a few weeks ago and came to the conclusion
that that you can't force the wished behaviour (if apache is forking).

You need persistent storage in a DBMS or a file and must take care of
concurrent accesses.

HTH

Stony


From ian at veryfresh.com  Fri Mar 22 10:09:59 2002
From: ian at veryfresh.com (Ian Clelland)
Date: Fri Jan  9 21:59:17 2004
Subject: [mod_python] persistant variables
In-Reply-To: <20020322171850.A1049@tyche.svt.tu-harburg.de>
References: <20020321111659.GA8699@fullfactor.com> <NCEILGMPEAMDGEALMLEMKEJFCAAA.maynard@mpi-cbg.de> <20020322171850.A1049@tyche.svt.tu-harburg.de>
Message-ID: <20020322180959.GB9162@fullfactor.com>

On Fri, Mar 22, 2002 at 05:18:50PM +0100, Alexander Steinert wrote:
> > How can I force mod_python to only have one instance of the variable? Or
> > should I be trying to do this in an entirely different way?
> > 
> > I can set Apache to only start with one server (which makes it work),
> > however it will spawn more servers if it gets two hits at the same time, so
> > this won't really work.
> 
> I thought about this topic a few weeks ago and came to the conclusion
> that that you can't force the wished behaviour (if apache is forking).
> 
> You need persistent storage in a DBMS or a file and must take care of
> concurrent accesses.

I've come to the same conclusion myself, after a fair bit of 
experimentation and research (there was a lengthy discussion on this 
list about a year ago: 
http://www.modpython.org/pipermail/mod_python/2001-April/001254.html ).

Because Apache (on Unix) forks new processes for its children, they 
must necessarily run in isolated memory spaces. However, since each 
child process is long-lived, you can retain some persistent data (like 
a database connection handle) between requests /to that child/. It's 
not quite the same thing as global persistent data, but it works for 
some applications.

Apparently mod_perl developers can get around this limitation by using 
the IPC::Shareable module -- has anybody in the Python community done 
any work on something similar?


Ian
<ian@veryfresh.com>

From bakey at traq.com  Fri Mar 22 13:53:47 2002
From: bakey at traq.com (Brian Akey)
Date: Fri Jan  9 21:59:17 2004
Subject: [mod_python] persistant variables
Message-ID: <780A5D64B1CC9544AB7B702F39219C1E60F0@traqexch.traq.com>

Is there a way to leverage the MM library that people compile in for
mod_ssl?

-----Original Message-----
From: Ian Clelland [mailto:ian@veryfresh.com]
Sent: Friday, March 22, 2002 12:10 PM
To: mod_python@modpython.org
Subject: Re: [mod_python] persistant variables


On Fri, Mar 22, 2002 at 05:18:50PM +0100, Alexander Steinert wrote:
> > How can I force mod_python to only have one instance of the variable? Or
> > should I be trying to do this in an entirely different way?
> > 
> > I can set Apache to only start with one server (which makes it work),
> > however it will spawn more servers if it gets two hits at the same time,
so
> > this won't really work.
> 
> I thought about this topic a few weeks ago and came to the conclusion
> that that you can't force the wished behaviour (if apache is forking).
> 
> You need persistent storage in a DBMS or a file and must take care of
> concurrent accesses.

I've come to the same conclusion myself, after a fair bit of 
experimentation and research (there was a lengthy discussion on this 
list about a year ago: 
http://www.modpython.org/pipermail/mod_python/2001-April/001254.html ).

Because Apache (on Unix) forks new processes for its children, they 
must necessarily run in isolated memory spaces. However, since each 
child process is long-lived, you can retain some persistent data (like 
a database connection handle) between requests /to that child/. It's 
not quite the same thing as global persistent data, but it works for 
some applications.

Apparently mod_perl developers can get around this limitation by using 
the IPC::Shareable module -- has anybody in the Python community done 
any work on something similar?


Ian
<ian@veryfresh.com>
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python

From s_lott at yahoo.com  Sat Mar 23 07:53:14 2002
From: s_lott at yahoo.com (Steven Lott)
Date: Fri Jan  9 21:59:17 2004
Subject: [mod_python] (no subject)
Message-ID: <20020323155314.50780.qmail@web9608.mail.yahoo.com>

Context:
Server version: Apache/1.3.20 (Unix)  (Red-Hat/Linux)
Python 2.2 (#2, Mar 23 2002, 07:48:23)
Mod_python 2.7.6

Did a rebuild of Python --without-threads
Did a build of mod_python --with-apxs pointing to my apxs in
/usr/sbin

Start apache with /usr/sbin/httpd -dHAVE_PYTHON

[Sat Mar 23 10:24:42 2002] [warn] Loaded DSO
modules/mod_python.so uses plain Apache 1.3 API, this module
might crash under EAPI! (please recompile it with -DEAPI)

What do I change in the config to include -DEAPI?
Or can I ignore this?




=====
--
S. Lott, CCP :-{)
S_LOTT@YAHOO.COM
http://www.mindspring.com/~slott1
Buccaneer #468: KaDiMa

Macintosh user: drinking upstream from the herd.

__________________________________________________
Do You Yahoo!?
Yahoo! Movies - coverage of the 74th Academy Awards
http://movies.yahoo.com/

From geert at boskant.nl  Sat Mar 23 18:57:30 2002
From: geert at boskant.nl (Geert Jansen)
Date: Fri Jan  9 21:59:17 2004
Subject: [mod_python] (no subject)
In-Reply-To: <20020323155314.50780.qmail@web9608.mail.yahoo.com>
Message-ID: <POEGJAKPNOCGNJMONMFKEEOLCDAA.geert@boskant.nl>

Hello Steven,

I got this error too and some searching with google indicated that this is
not a grave error. Only if mod_python used mod_ssl (mod_ssl uses the
"Extended API" or EAPI of Apache), there would be a problem.

BTW: recompiling with -DEAPI doesn't change one bit

Greet
--
long long email=0X78DC806B91FCA334,i=0,j; main(){j=(email>>4*i)&15;
putchar(j+j/2+j/5-j/12+(j<13?97:-65+7*j));i/15?exit(0):++i,main();}

> -----Original Message-----
> From: mod_python-admin@modpython.org
> [mailto:mod_python-admin@modpython.org]On Behalf Of Steven Lott
> Sent: Saturday, March 23, 2002 4:53 PM
> To: mod_python@modpython.org
> Subject: [mod_python] (no subject)
>
>
> Context:
> Server version: Apache/1.3.20 (Unix)  (Red-Hat/Linux)
> Python 2.2 (#2, Mar 23 2002, 07:48:23)
> Mod_python 2.7.6
>
> Did a rebuild of Python --without-threads
> Did a build of mod_python --with-apxs pointing to my apxs in
> /usr/sbin
>
> Start apache with /usr/sbin/httpd -dHAVE_PYTHON
>
> [Sat Mar 23 10:24:42 2002] [warn] Loaded DSO
> modules/mod_python.so uses plain Apache 1.3 API, this module
> might crash under EAPI! (please recompile it with -DEAPI)
>
> What do I change in the config to include -DEAPI?
> Or can I ignore this?
>
>
>
>
> =====
> --
> S. Lott, CCP :-{)
> S_LOTT@YAHOO.COM
> http://www.mindspring.com/~slott1
> Buccaneer #468: KaDiMa
>
> Macintosh user: drinking upstream from the herd.
>
> __________________________________________________
> Do You Yahoo!?
> Yahoo! Movies - coverage of the 74th Academy Awards.
> http://movies.yahoo.com/
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From bs at wasd.dk  Sun Mar 24 12:04:11 2002
From: bs at wasd.dk (Bjarke =?iso-8859-1?Q?S=F8rensen?=)
Date: Fri Jan  9 21:59:17 2004
Subject: [mod_python] -DEAPI
In-Reply-To: <POEGJAKPNOCGNJMONMFKEEOLCDAA.geert@boskant.nl>
References: <20020323155314.50780.qmail@web9608.mail.yahoo.com> <POEGJAKPNOCGNJMONMFKEEOLCDAA.geert@boskant.nl>
Message-ID: <20020324110411.GA3729@wasd.dk>

On Sat, Mar 23, 2002 at 06:57:30PM +0100, Geert Jansen wrote:
> Hello Steven,
> 
> I got this error too and some searching with google indicated that this is
> not a grave error. Only if mod_python used mod_ssl (mod_ssl uses the
> "Extended API" or EAPI of Apache), there would be a problem.
> 
> BTW: recompiling with -DEAPI doesn't change one bit

Where do you put it?


> > [Sat Mar 23 10:24:42 2002] [warn] Loaded DSO
> > modules/mod_python.so uses plain Apache 1.3 API, this module
> > might crash under EAPI! (please recompile it with -DEAPI)

As I see it, it's apxs that should be given the -DEAPI and you have to do that manually in Makefile.



> > What do I change in the config to include -DEAPI?
> > Or can I ignore this?


I would rather correct it, as it could kill apache threads.



/bs

bs@wasd.dk
http://wasd.dk/

From matt at proweb.co.uk  Tue Mar 26 12:53:06 2002
From: matt at proweb.co.uk (Matt H)
Date: Fri Jan  9 21:59:17 2004
Subject: [mod_python] Please deinstall & rebuild/reinstall Python withWITHOUT_THREADS set.
Message-ID: <20020326125306.4f93066c.matt@proweb.co.uk>

I'm doing a new install in FreeBSd 4.5
I'm getting 

Error: Python installation in /usr/local uses threads. mod_python requires
it to be built without threads. Please deinstall & rebuild/reinstall Python with
WITHOUT_THREADS set.

and yet here's partial output from the python install (blank lines for highlighting)

checking for --with-libs... no
checking for --with-signal-module... yes
checking for --with-dec-threads... no

checking for --with-threads... no

checking if --enable-ipv6 is specified... yes
checking if RFC2553 API is available... yes
checking ipv6 stack type... kame
using libc



oh what to do, I need to get my site back up again!

Matt

From matt at proweb.co.uk  Tue Mar 26 17:50:58 2002
From: matt at proweb.co.uk (Matt H)
Date: Fri Jan  9 21:59:17 2004
Subject: [mod_python] Please deinstall & rebuild  << FIXED
In-Reply-To: <200203261609.g2QG90f03946@lewis.abi.tconline.net>
References: <20020326125306.4f93066c.matt@proweb.co.uk>
	<200203261609.g2QG90f03946@lewis.abi.tconline.net>
Message-ID: <20020326175058.0148020b.matt@proweb.co.uk>

Predictably it was my own fault

Originally I installed from /usr/ports/www/mod_python

which lists python as a dependancy and then proceeds to build and install
it with threads

for the rebuild I hacked the Makefile for python and got it wrong

doh!

thanks to Bob & Lewis for taking the time to star tto help me

it was writing my reply that made me look again and find what I'd done


----

What I generally do is just compile an entirely separate version of 
python, i.e. in /usr/local/apache/python .. I use threaded python for 
everything else, so taking threads out globally isn't really an option 
for me.


I'd be interested to know how to do that

I tried moving /usr/local/lib/python2.2 without success

It would be great if someone could add a faq or howto on having the two
seperate python's installed. 

Dropping thread support kills py-curl for a start, 
I either need both or re-write my stuff that relies on py-curl

I'm definately in love with mod_python

m



From reitz at inworks.de  Tue Mar 26 18:58:42 2002
From: reitz at inworks.de (andre@orion)
Date: Fri Jan  9 21:59:17 2004
Subject: [mod_python] make install
References: <20020326125306.4f93066c.matt@proweb.co.uk><200203261609.g2QG90f03946@lewis.abi.tconline.net> <20020326175058.0148020b.matt@proweb.co.uk>
Message-ID: <018f01c1d4ef$ddc6a560$1900a8c0@venus>

Would it be possible to add a configure option with which python
installation the libs will be compiled / installed....


e.g.:
./configure --with-python-binary=/usr/local/bin/python2.2

The "make install" uses always the python which is found in $PATH.


P.S.: When will the next Release be released?

Greetings, Andre'


From grisha at modpython.org  Tue Mar 26 14:28:26 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:17 2004
Subject: [mod_python] Please deinstall & rebuild/reinstall Python
 withWITHOUT_THREADS set.
In-Reply-To: <20020326125306.4f93066c.matt@proweb.co.uk>
Message-ID: <Pine.BSF.4.32.0203261427560.23911-100000@localhost>

This is in the FAQ.

do "rm config.cache"

Grisha

On Tue, 26 Mar 2002, Matt H wrote:

>
> I'm doing a new install in FreeBSd 4.5
> I'm getting
>
> Error: Python installation in /usr/local uses threads. mod_python requires
> it to be built without threads. Please deinstall & rebuild/reinstall Python with
> WITHOUT_THREADS set.
>
> and yet here's partial output from the python install (blank lines for highlighting)
>
> checking for --with-libs... no
> checking for --with-signal-module... yes
> checking for --with-dec-threads... no
>
> checking for --with-threads... no
>
> checking if --enable-ipv6 is specified... yes
> checking if RFC2553 API is available... yes
> checking ipv6 stack type... kame
> using libc
>
>
>
> oh what to do, I need to get my site back up again!
>
> Matt
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From jasper at objectionable.org  Thu Mar 28 21:06:24 2002
From: jasper at objectionable.org (Jasper Hargreaves)
Date: Fri Jan  9 21:59:17 2004
Subject: [mod_python] invalid command 'PythonHandler'
Message-ID: <3CA385D0.7171.102CC2@localhost>

An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020328/90668ecc/attachment-0002.htm
From grisha at modpython.org  Thu Mar 28 16:36:21 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:17 2004
Subject: [mod_python] invalid command 'PythonHandler'
In-Reply-To: <3CA385D0.7171.102CC2@localhost>
Message-ID: <Pine.BSF.4.32.0203281634250.59245-100000@localhost>

If you're new to Apache, then check the config to make sure it doesn't
have a ClearModuleList directive. If it does, then following it there
should also be an AddModule mod_python.c line somewhere, else the module
is never activated by apache.

Grisha

On Thu, 28 Mar 2002, Jasper Hargreaves wrote:

> I've been trying to get Python scripts working with Apache under Windows.
>
> Running Apache 1.3.22 on Windows2000 Pro (ntfs partition), with
> Version  2.7.6 of ModPython, with Python 2.2 installed in the back, supported by Win32all v146
>
> From a completely clean install of Python & Apache, and following the documentation word for word given for "Windows
> Installation" on the documentation section of the site, it's not giving any joy, giving a
>
> "Invalid command 'PythonHandler', perhaps mis-spelled or defined by a module not included in the server configuration."
>
> when Apache tries to start. I'm new to configuring Apache - so I'm unsure if there's a particular "cgi" section of the
> httpd.conf, or if it's simply covered by the "alias" section.
>
> I've also set file extensions .py to be associated with Python, and added environment variable PYTHONPATH, and PATH to point to
> the python directory.
>
> Any advice?
>
> Many thanks,
> Jasper Hargreaves
> --------------------
> Jasper Hargreaves
> jasper@objectionable.org
> ICQ : 41235322; AIM : cloudyshai
> http://www.objectionable.org
> --------------------
> Information is not knowledge. Knowledge is not wisdom. Wisdom is not truth. Truth is not beauty. Beauty is not love. Love is not
> music. Music is the best. Wisdom is the domain of the Wiz, which is extinct.
> Beauty is a french phoenetic corruption of a short cloth neck ornament currently in resurgence.
>                 -Frank Zappa, "Packard Goose"
> ---------------------
> _______________________________________________ Mod_python mailing list Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From anburger76 at hotmail.com  Sat Mar 30 18:18:48 2002
From: anburger76 at hotmail.com (Tony Burger)
Date: Fri Jan  9 21:59:17 2004
Subject: [mod_python] "openpty" installation problem with Python 2.2.1c2
Message-ID: <F10mRBaYFkuutSgcOrB0000613d@hotmail.com>

An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020330/d7eb1e1c/attachment-0002.htm
From anburger76 at hotmail.com  Sat Mar 30 19:01:14 2002
From: anburger76 at hotmail.com (Tony Burger)
Date: Fri Jan  9 21:59:17 2004
Subject: [mod_python] fixed "openpty" problem with Python 2.2.1c2
Message-ID: <F176GgdKn3khQCaqSGB00019337@hotmail.com>

An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020330/6d58d96a/attachment-0002.htm
From anburger76 at hotmail.com  Sun Mar 31 23:18:27 2002
From: anburger76 at hotmail.com (Tony Burger)
Date: Fri Jan  9 21:59:17 2004
Subject: [mod_python] popen/popen2 usage?
Message-ID: <F68hGtK25DgRbwri5Dp00003dcd@hotmail.com>

An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020331/af96f458/attachment-0002.htm
From conrad at hep.caltech.edu  Sun Mar 31 20:40:27 2002
From: conrad at hep.caltech.edu (Conrad Steenberg)
Date: Fri Jan  9 21:59:17 2004
Subject: [mod_python] popen/popen2 usage?
In-Reply-To: <F68hGtK25DgRbwri5Dp00003dcd@hotmail.com>
References: <F68hGtK25DgRbwri5Dp00003dcd@hotmail.com>
Message-ID: <1017636029.9948.13.camel@Tafelberg.caltech.edu>

On Sun, 2002-03-31 at 20:18, Tony Burger wrote:
I am calling a C executable from within mod_python using the popen2
function imported from os.  I need to get standard output from the C
function and assign it to a mod_python variable which isn't working. The
C function does a basic (void)fprinf(stdout,"%s\n",myVar). I tested the
C function by writing to stderr instead and that works (logged fprintf
output to the Apache error_log). I just can't get any output. Might
anyone know how mod_python handles this function or what it might be
doing? Thanks.

Check whether the stdout of the forked process doesn't get written to
the browser in this case. You need to write to a different file
descriptor. From man popen:
"      Writing to such  a  stream
       writes to the standard input of the command; the command's
       standard output is the same as that of  the  process  that
       called  popen(),  unless  this  is  altered by the command
       itself."

Unless you wanted the child process' output written to the client
browser??

Otherwise doing a pipe() and then a fork() separately should work, e.g.:

  int my_pipe[2]

  pipe(my_pipe);
  child_pid=fork()

  switch (child_pid)
  {  case -1:
              perror ("Error: unable to fork");
              return 0;
              
     case 0: /* the child */
              close(my_pipe[0]); /* close the read end*/

             /* do an exec/execv etc. here */

     default: /* the parent */
              close(my_pipe[1]); /* close the write end */
  }

You may of course have more than one pipe if you want bi-directional
communication: just close the write end in the child and the read end in
the parent of the seconf pipe.

Cheers!

Conrad
_______________________________________________ Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python


From alexis at mobiliant.com  Fri Mar  1 10:57:15 2002
From: alexis at mobiliant.com (=?iso-8859-1?Q?Ulf_Engstr=F6m?=)
Date: Fri Jan  9 22:03:04 2004
Subject: [mod_python] Install on Solaris
Message-ID: <00a701c1c107$791cffc0$4ede14d4@THENEWONE>

Hello :)
I'm having some problems installing on Solaris and I hope that someone could
help me a little. I've been searching the net and I've found many questions
regarding similar problems, but I havn't found a solution that works for me.

Problem is:
/usr/local/apache/> /bin/apachectl start
Syntax error on line 207 of /usr/local/apache/conf/httpd.conf:
Cannot load /usr/local/apache/libexec/mod_python.so into server: ld.so.1:
/usr/local/apache/bin/httpd: fatal: relocation error: file
/usr/local/apache/libexec/mod_python.so: symbol ap_log_error: referenced
symbol not found
/bin/apachectl start: httpd could not be started

(ap_log_error symbol exists in /usr/local/apache/include)

Other information:
> ldd -r /usr/local/apache/libexec/mod_python.so
        libm.so.1 =>     /usr/lib/libm.so.1
        libsocket.so.1 =>        /usr/lib/libsocket.so.1
        libnsl.so.1 =>   /usr/lib/libnsl.so.1
        libdl.so.1 =>    /usr/lib/libdl.so.1
        libc.so.1 =>     /usr/lib/libc.so.1
        libmp.so.2 =>    /usr/lib/libmp.so.2
        /usr/platform/SUNW,Sun-Blade-100/lib/libc_psr.so.1
        symbol not found: ap_log_error
(/usr/local/apache/libexec/mod_python.so)
        symbol not found: ap_log_error
(/usr/local/apache/libexec/mod_python.so)
        symbol not found: ap_log_error
(/usr/local/apache/libexec/mod_python.so)
<snipped many more symbols)

> uname -a
SunOS sol 5.8 Generic_108528-07 sun4u sparc SUNW,Sun-Blade-100

> which gcc
/usr/local/bin/gcc

> gcc -v
Reading specs from /usr/local/lib/gcc-lib/sparc-sun-solaris2.8/3.0.3/specs
Configured with:
../configure --with-as=/usr/local/bin/as --with-ld=/usr/local/bin/ld --enabl
e-libgcj
Thread model: posix
gcc version 3.0.3

> echo $LD_LIBRARY_PATH
/usr/lib:/lib:/usr/local/lib:/usr/local/mysql/lib:/usr/local/lib/

Python version 2.1.1
Apache version 1.3.23

I've also tried static compiling of mod_python, but that gave me the
following error during make of apache
connobject.o(.text+0x5d4): undefined reference to `PyMember_Set'

And many, many other rows of missing references.

Any more information needed, just let me know, I'd be very thankful for
anything that could help me with this:)

Regards
Ulf


From stony8 at gmx.de  Sun Mar  3 14:27:14 2002
From: stony8 at gmx.de (Alexander Steinert)
Date: Fri Jan  9 22:03:04 2004
Subject: [mod_python] Distinguish HTTP and HTTPS
Message-ID: <20020303142714.A9355@tyche.svt.tu-harburg.de>

My application wants to distinguish between requests sent with http and
those sent with https. Is that possible with mod_python? How?

TIA

Stony

From dustin at ywlcs.org  Sun Mar  3 09:28:12 2002
From: dustin at ywlcs.org (Dustin Mitchell)
Date: Fri Jan  9 22:03:04 2004
Subject: [mod_python] Distinguish HTTP and HTTPS
In-Reply-To: <20020303142714.A9355@tyche.svt.tu-harburg.de>
References: <20020303142714.A9355@tyche.svt.tu-harburg.de>
Message-ID: <20020303152812.GT3092@eleanor.internal.ywlcs.org>

Best way I've found to distinguish the two is to look at the port number:

def is_secure(req):
  # This seems the best way to do this
  return req.server.port == 443

Dustin

-- 

  Dustin Mitchell
  dustin@ywlcs.org

From jijang at tronwell.net  Tue Mar  5 16:34:46 2002
From: jijang at tronwell.net (=?ks_c_5601-1987?B?wOXBpMDO?=)
Date: Fri Jan  9 22:03:05 2004
Subject: [mod_python] pyo?
Message-ID: <HOEJLPEAEKDEMPJEOFLKAEDBCAAA.jijang@tronwell.net>

 .py ===> python file
 .pyc ===> python file -> compile
 .pyo ===> what is it?

From L.A.Timochouk at ukc.ac.uk  Tue Mar  5 12:09:45 2002
From: L.A.Timochouk at ukc.ac.uk (Leonid Timochouk)
Date: Fri Jan  9 22:03:05 2004
Subject: [mod_python] pyo?
In-Reply-To: <HOEJLPEAEKDEMPJEOFLKAEDBCAAA.jijang@tronwell.net>
Message-ID: <Pine.GSO.4.43.0203051207420.18140-100000@myrtle.ukc.ac.uk>

That is a Python byte-code file if compiled with optimisation.
If you run a command like

python -O some_file.py

it will produce "some_file.pyo" byte-code file instead of "some_file.pyc".

Leonid Timochouk
University of Kent at Canterbury


From jijang at tronwell.net  Wed Mar  6 12:19:20 2002
From: jijang at tronwell.net (=?ks_c_5601-1987?B?wOXBpMDO?=)
Date: Fri Jan  9 22:03:05 2004
Subject: [mod_python] i know .pyo...
Message-ID: <HOEJLPEAEKDEMPJEOFLKOEDBCAAA.jijang@tronwell.net>

 
 thx...everybody

 however, .pyc make is py_compile.compile()
 how is make .pyo?

From alain at onesite.org  Wed Mar  6 05:21:50 2002
From: alain at onesite.org (Alain Tesio)
Date: Fri Jan  9 22:03:05 2004
Subject: [mod_python] i know .pyo...
In-Reply-To: <HOEJLPEAEKDEMPJEOFLKOEDBCAAA.jijang@tronwell.net>
References: <HOEJLPEAEKDEMPJEOFLKOEDBCAAA.jijang@tronwell.net>
Message-ID: <20020306052150.310d8489.alain@onesite.org>

On Wed, 6 Mar 2002 12:19:20 +0900
 <jijang@tronwell.net> wrote:

>  
>  thx...everybody
> 
>  however, .pyc make is py_compile.compile()
>  how is make .pyo?

With the same command from a python session started
with python -O

Alain

From llsousa at ualg.pt  Wed Mar  6 15:55:55 2002
From: llsousa at ualg.pt (Luis Sousa)
Date: Fri Jan  9 22:03:05 2004
Subject: [mod_python] Not finding handler on public_html
Message-ID: <3C863C0B.2060901@ualg.pt>

Hi everybody

I installed mod_python on apache 1.3.23-1 and everything went OK.
Reading the documentation I tried to test my server writing some simple 
tests. I created a directory in /var/www called test and I haved copeid 
to her the file mptest.py. I changed the configuration of apache 
introducing new lines to that directory, like in the example in 3.2, 
from the documentation.
Everything went OK.

Then I tried to do the same thing but in my home directory, in 
public_html. Here it gave some errors:

Mod_python error: "PythonHandler mptest"

Traceback (most recent call last):

  File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 181, in Dispatch
    module = import_module(module_name, _req)

  File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 335, in import_module
    f, p, d = imp.find_module(parts[i], path)

ImportError: No module named mptest

What could be the problem that I'm having ?

Thanks in advance.

Luis Sousa




From grisha at modpython.org  Wed Mar  6 14:13:57 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:05 2004
Subject: [mod_python] Not finding handler on public_html
In-Reply-To: <3C863C0B.2060901@ualg.pt>
Message-ID: <Pine.BSF.4.32.0203061402330.55328-100000@localhost>

mod_python prepends to sys.path the directory in which the PythonHandler
directive is specified. So if the PythonHandler is at the top level in
your config file, then you have to set the sys.path manually to make sure
Python can find your script. You can do this using the PythonPath
directive.

On Wed, 6 Mar 2002, Luis Sousa wrote:

> Hi everybody
>
> I installed mod_python on apache 1.3.23-1 and everything went OK.
> Reading the documentation I tried to test my server writing some simple
> tests. I created a directory in /var/www called test and I haved copeid
> to her the file mptest.py. I changed the configuration of apache
> introducing new lines to that directory, like in the example in 3.2,
> from the documentation.
> Everything went OK.
>
> Then I tried to do the same thing but in my home directory, in
> public_html. Here it gave some errors:
>
> Mod_python error: "PythonHandler mptest"
>
> Traceback (most recent call last):
>
>   File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 181, in Dispatch
>     module = import_module(module_name, _req)
>
>   File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 335, in import_module
>     f, p, d = imp.find_module(parts[i], path)
>
> ImportError: No module named mptest
>
> What could be the problem that I'm having ?
>
> Thanks in advance.
>
> Luis Sousa
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From llsousa at ualg.pt  Thu Mar  7 09:45:03 2002
From: llsousa at ualg.pt (Luis Sousa)
Date: Fri Jan  9 22:03:05 2004
Subject: [mod_python] Not finding handler on public_html
References: <Pine.BSF.4.32.0203061402330.55328-100000@localhost>
Message-ID: <3C87369F.40100@ualg.pt>

I put this line in the directory definition of /home/llsousa/public_html 
and It's working:
    PythonPath "sys.path+['/home/llsousa/public_html']"

I tried to put in the directory definition /home/*/public_html a line 
like this and did not worked:
    PythonPath "sys.path+['/home/*/public_html']"
to all home public_html.

Is there a simple way to do this ?

Thanks, Luis Sousa


Gregory (Grisha) Trubetskoy wrote:

>mod_python prepends to sys.path the directory in which the PythonHandler
>directive is specified. So if the PythonHandler is at the top level in
>your config file, then you have to set the sys.path manually to make sure
>Python can find your script. You can do this using the PythonPath
>directive.
>
>On Wed, 6 Mar 2002, Luis Sousa wrote:
>
>>Hi everybody
>>
>>I installed mod_python on apache 1.3.23-1 and everything went OK.
>>Reading the documentation I tried to test my server writing some simple
>>tests. I created a directory in /var/www called test and I haved copeid
>>to her the file mptest.py. I changed the configuration of apache
>>introducing new lines to that directory, like in the example in 3.2,
>>from the documentation.
>>Everything went OK.
>>
>>Then I tried to do the same thing but in my home directory, in
>>public_html. Here it gave some errors:
>>
>>Mod_python error: "PythonHandler mptest"
>>
>>Traceback (most recent call last):
>>
>>  File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 181, in Dispatch
>>    module = import_module(module_name, _req)
>>
>>  File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 335, in import_module
>>    f, p, d = imp.find_module(parts[i], path)
>>
>>ImportError: No module named mptest
>>
>>What could be the problem that I'm having ?
>>
>>Thanks in advance.
>>
>>Luis Sousa
>>
>>
>>
>>_______________________________________________
>>Mod_python mailing list
>>Mod_python@modpython.org
>>http://www.modpython.org/mailman/listinfo/mod_python
>>
>
>
>




From alf at proweb.co.uk  Thu Mar  7 11:37:10 2002
From: alf at proweb.co.uk (alf)
Date: Fri Jan  9 22:03:05 2004
Subject: [mod_python] md5 & MySQLdb
Message-ID: <000d01c1c5cc$6c00b330$6501a8c0@fwoom>

Hi,

I'm having a great time with mod_python, it's doing everything I want so far

except this :

I can import most modules re, string, os, sys, even my own modules but for
some reason when I try and import md5 or MySQLdb I get :
ImportError: No module named md5

When I use the python console I get the expected :
Python 2.2 (#1, Feb 12 2002, 21:26:35)
[GCC 2.95.2 19991024 (release)] on freebsd4T
ype "help", "copyright", "credits" or "license" for more information.
>>> from mod_python import apache
Traceback (most recent call last):  File "<stdin>", line 1, in ?
File "/usr/local/lib/python2.2/site-packages/mod_python/apache.py", line 55,
in ?
import _apache
ImportError: No module named _apache
>>> import md5
>>>

I've ended up writing a routine :

def getMD5(txt) :
    md5fn = "/tmp/md5" + `getpid()`
    system("echo -n \"" + txt + "\" | md5 > " + md5fn)
    md5f = open(md5fn)
    md5l = md5f.readlines()
    md5f.close()
    unlink(md5fn)
    return md5l[0]

presumably it's something to do with md5 & MySQLdb being a c external

any solution?

cheers

Matt


From alain at onesite.org  Thu Mar  7 12:55:25 2002
From: alain at onesite.org (Alain Tesio)
Date: Fri Jan  9 22:03:05 2004
Subject: [mod_python] md5 & MySQLdb
In-Reply-To: <000d01c1c5cc$6c00b330$6501a8c0@fwoom>
References: <000d01c1c5cc$6c00b330$6501a8c0@fwoom>
Message-ID: <20020307125525.2ddc81ac.alain@onesite.org>

On Thu, 7 Mar 2002 11:37:10 -0000
"alf" <alf@proweb.co.uk> wrote:

> Hi,
> 
> I'm having a great time with mod_python, it's doing everything I want so far
> 
> except this :
> 
> I can import most modules re, string, os, sys, even my own modules but for
> some reason when I try and import md5 or MySQLdb I get :
> ImportError: No module named md5
> 
> When I use the python console I get the expected :
> Python 2.2 (#1, Feb 12 2002, 21:26:35)
> [GCC 2.95.2 19991024 (release)] on freebsd4T
> ype "help", "copyright", "credits" or "license" for more information.
> >>> from mod_python import apache
> Traceback (most recent call last):  File "<stdin>", line 1, in ?
> File "/usr/local/lib/python2.2/site-packages/mod_python/apache.py", line 55,
> in ?
> import _apache
> ImportError: No module named _apache
> >>> import md5
> >>>
> 
> I've ended up writing a routine :
> 
> def getMD5(txt) :
>     md5fn = "/tmp/md5" + `getpid()`
>     system("echo -n \"" + txt + "\" | md5 > " + md5fn)
>     md5f = open(md5fn)
>     md5l = md5f.readlines()
>     md5f.close()
>     unlink(md5fn)
>     return md5l[0]
> 
> presumably it's something to do with md5 & MySQLdb being a c external
> 
> any solution?
> 
> cheers
> 
> Matt

Hi, I can import MySQLdb fine, maybe you can add the path to the module
in sys.path
Btw in your function, you could also use a pipe instead of a temporary
file.

Alain

From matt at proweb.co.uk  Thu Mar  7 13:03:54 2002
From: matt at proweb.co.uk (Matt H)
Date: Fri Jan  9 22:03:05 2004
Subject: [mod_python] md5 & MySQLdb
References: <000d01c1c5cc$6c00b330$6501a8c0@fwoom> <20020307125525.2ddc81ac.alain@onesite.org>
Message-ID: <008a01c1c5d8$89c85560$6501a8c0@fwoom>

> Hi, I can import MySQLdb fine, maybe you can add the path to the module in
sys.path

Thanks, knowing it was possible made me fix it.

and I've managed to fix them both
MySQLdb was in /usr/local/lib/python2.2/site-packages
and
md5.so was in /usr/local/lib/python2.2/lib-dynload

so I added them to my PythonPath :

PythonPath "['/usr/local/lib/python2.2', '/usr/local/lib/python2.2/site
-packages', '/usr/local/lib/python2.2/lib-dynload', '/www/python']"

and now they import just fine


shame the PythonPath doesn't do subdirectories!

> Btw in your function, you could also use a pipe instead of a temporary
> file.

y thanks. That light came on for me this morning. tbh I figured someone
would tell me how to import md5 and I could scrap the lot so quick and dirty
would do in order to do the proof of concept


From grisha at modpython.org  Thu Mar  7 10:12:00 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:05 2004
Subject: [mod_python] Not finding handler on public_html
In-Reply-To: <3C87369F.40100@ualg.pt>
Message-ID: <Pine.BSF.4.32.0203071009100.67065-100000@localhost>

This is because "*" doesn't mean anything to Python.

One thing you could do is to AllowOverride FileInfo for all your users,
then they could specify their own PythonHandler or PythonPath in an
.htaccess file in their public_html directory.


Grisha

On Thu, 7 Mar 2002, Luis Sousa wrote:

> I put this line in the directory definition of /home/llsousa/public_html
> and It's working:
>     PythonPath "sys.path+['/home/llsousa/public_html']"
>
> I tried to put in the directory definition /home/*/public_html a line
> like this and did not worked:
>     PythonPath "sys.path+['/home/*/public_html']"
> to all home public_html.
>
> Is there a simple way to do this ?
>
> Thanks, Luis Sousa
>
>
> Gregory (Grisha) Trubetskoy wrote:
>
> >mod_python prepends to sys.path the directory in which the PythonHandler
> >directive is specified. So if the PythonHandler is at the top level in
> >your config file, then you have to set the sys.path manually to make sure
> >Python can find your script. You can do this using the PythonPath
> >directive.
> >
> >On Wed, 6 Mar 2002, Luis Sousa wrote:
> >
> >>Hi everybody
> >>
> >>I installed mod_python on apache 1.3.23-1 and everything went OK.
> >>Reading the documentation I tried to test my server writing some simple
> >>tests. I created a directory in /var/www called test and I haved copeid
> >>to her the file mptest.py. I changed the configuration of apache
> >>introducing new lines to that directory, like in the example in 3.2,
> >>from the documentation.
> >>Everything went OK.
> >>
> >>Then I tried to do the same thing but in my home directory, in
> >>public_html. Here it gave some errors:
> >>
> >>Mod_python error: "PythonHandler mptest"
> >>
> >>Traceback (most recent call last):
> >>
> >>  File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 181, in Dispatch
> >>    module = import_module(module_name, _req)
> >>
> >>  File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 335, in import_module
> >>    f, p, d = imp.find_module(parts[i], path)
> >>
> >>ImportError: No module named mptest
> >>
> >>What could be the problem that I'm having ?
> >>
> >>Thanks in advance.
> >>
> >>Luis Sousa
> >>
> >>
> >>
> >>_______________________________________________
> >>Mod_python mailing list
> >>Mod_python@modpython.org
> >>http://www.modpython.org/mailman/listinfo/mod_python
> >>
> >
> >
> >
>
>
>


From rien at yeepa.org  Thu Mar  7 18:45:31 2002
From: rien at yeepa.org (Adrien Pisson)
Date: Fri Jan  9 22:03:05 2004
Subject: [mod_python] Multiple cookies (not writing, but reading...)
Message-ID: <000701c1c5ff$e186ba40$2cee4cd4@RANDOM>

in all the mailing list archive, i've found many posts asking how to set
multiple cookies.
that's right, it's in the manual, use the method add.

but, if i can write multiple cookies, i can't figure out how i can read
multiple cookies from headers_in.
is there any counterparts to add ? (the manual does not mention it, neither
do the source code for table)

thanks.

--
rien



From grisha at modpython.org  Thu Mar  7 13:11:14 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:05 2004
Subject: [mod_python] Multiple cookies (not writing, but reading...)
In-Reply-To: <000701c1c5ff$e186ba40$2cee4cd4@RANDOM>
Message-ID: <Pine.BSF.4.32.0203071309310.68895-100000@localhost>

If headers_in contains multiple keys with the same name, then when you try
to retrieve this key, the result will be a list. That's bascially all
there is to it :)

On Thu, 7 Mar 2002, Adrien Pisson wrote:

> in all the mailing list archive, i've found many posts asking how to set
> multiple cookies.
> that's right, it's in the manual, use the method add.
>
> but, if i can write multiple cookies, i can't figure out how i can read
> multiple cookies from headers_in.
> is there any counterparts to add ? (the manual does not mention it, neither
> do the source code for table)
>
> thanks.
>
> --
> rien
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From llsousa at ualg.pt  Fri Mar  8 09:35:53 2002
From: llsousa at ualg.pt (Luis Sousa)
Date: Fri Jan  9 22:03:05 2004
Subject: [mod_python] [Fwd: Defining classes using mod_python]
Message-ID: <3C8885F9.2000300@ualg.pt>

Where can I find some examples to implement classes using mod_python ?

I'm using the example that is in the documentation in python.org to 
build a class but something is going wrong.

Thanks, Luis Sousa



From matt at proweb.co.uk  Fri Mar  8 09:38:02 2002
From: matt at proweb.co.uk (Matt H)
Date: Fri Jan  9 22:03:05 2004
Subject: [mod_python] [Fwd: Defining classes using mod_python]
In-Reply-To: <3C8885F9.2000300@ualg.pt>
References: <3C8885F9.2000300@ualg.pt>
Message-ID: <20020308093802.450c7dc1.matt@proweb.co.uk>

On Fri, 08 Mar 2002 09:35:53 +0000
"Luis Sousa" <llsousa@ualg.pt> wrote:

> Where can I find some examples to implement classes using mod_python ?
> 
> I'm using the example that is in the documentation in python.org to 
> build a class but something is going wrong.

I can build classes just fine, what's the actual problem?
 
> Thanks, Luis Sousa
>

From llsousa at ualg.pt  Fri Mar  8 10:56:08 2002
From: llsousa at ualg.pt (Luis Sousa)
Date: Fri Jan  9 22:03:05 2004
Subject: [mod_python] [Fwd: Defining classes using mod_python]
References: <3C8885F9.2000300@ualg.pt> <20020308093802.450c7dc1.matt@proweb.co.uk>
Message-ID: <3C8898C8.6000203@ualg.pt>

I know the problem is mine, so there's goes a simple example !

I have two files, one that I used to define a class and other one that 
calls the class:
    - file that defines the class: pessoalWEB.py

                class MyClass:
                    def __init__ (self):
                        self.x = ''
                        self.y = ''

    - file that uses the class: callClassWEB.py
               
                import pessoal

                def testFunc():
                    MyClass = pessoal.MyClass()
                    saida = MyClass.x
                    saida = MyClass.y
                    if saida=='':
                        saida="NULL"
   
                    return saida

I call this file using 
http://machinename/~llsousa/gpessoal/callClassWEB.py/testFunc in my browser.

The definition that I'm using on httpd.conf for this directory in apache is:

<Directory /home/llsousa/public_html/gpessoal>
    AddHandler python-program .py
    PythonHandler mod_python.publisher
    PythonDebug On
    PythonPath "sys.path+['/home/llsousa/public_html/gpessoal']"
</Directory>

The output that I will expect to return was NULL.
The problem is that in the browser, if I make Reload several times, 
sometimes I get what I expect, other times I got this message:

Mod_python error: "PythonHandler mod_python.publisher"

Traceback (most recent call last):

  File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 
193, in Dispatch
    result = object(req)

  File "/usr/lib/python2.1/site-packages/mod_python/publisher.py", line 
171, in handler
    result = apply(object, (), args)

  File "/home/llsousa/public_html/gpessoal/callClassWEB.py", line 6, in 
testFunc
    saida = MyClass.x

AttributeError: MyClass instance has no attribute 'x'

I was suppose to work all the time. Using the same example in python, 
everything went OK !.

What I'm I doing wrong ????

Thanks, Luis Sousa


Matt H wrote:

>On Fri, 08 Mar 2002 09:35:53 +0000
>"Luis Sousa" <llsousa@ualg.pt> wrote:
>
>>Where can I find some examples to implement classes using mod_python ?
>>
>>I'm using the example that is in the documentation in python.org to 
>>build a class but something is going wrong.
>>
>
>I can build classes just fine, what's the actual problem?
> 
>
>>Thanks, Luis Sousa
>>
>
>




From llsousa at ualg.pt  Fri Mar  8 10:59:18 2002
From: llsousa at ualg.pt (Luis Sousa)
Date: Fri Jan  9 22:03:05 2004
Subject: [Fwd: Re: [mod_python] [Fwd: Defining classes using mod_python]]
Message-ID: <3C889986.9050003@ualg.pt>

Where you read import pessoal, should read import pessoalWEB
----------

I know the problem is mine, so there's goes a simple example !

I have two files, one that I used to define a class and other one that 
calls the class:
    - file that defines the class: pessoalWEB.py

                class MyClass:
                    def __init__ (self):
                        self.x = ''
                        self.y = ''

    - file that uses the class: callClassWEB.py
               
                import pessoal

                def testFunc():
                    MyClass = pessoal.MyClass()
                    saida = MyClass.x
                    saida = MyClass.y
                    if saida=='':
                        saida="NULL"
   
                    return saida

I call this file using 
http://machinename/~llsousa/gpessoal/callClassWEB.py/testFunc in my browser.

The definition that I'm using on httpd.conf for this directory in apache is:

<>
    AddHandler python-program .py
    PythonHandler mod_python.publisher
    PythonDebug On
    PythonPath "sys.path+['/home/llsousa/public_html/gpessoal']"


The output that I will expect to return was NULL.
The problem is that in the browser, if I make Reload several times, 
sometimes I get what I expect, other times I got this message:

Mod_python error: "PythonHandler mod_python.publisher"

Traceback (most recent call last):

  File "/usr/lib/python2.1/site-packages/mod_python/apache.py", line 
193, in Dispatch
    result = object(req)

  File "/usr/lib/python2.1/site-packages/mod_python/publisher.py", line 
171, in handler
    result = apply(object, (), args)

  File "/home/llsousa/public_html/gpessoal/callClassWEB.py", line 6, in 
testFunc
    saida = MyClass.x

AttributeError: MyClass instance has no attribute 'x'

I was suppose to work all the time. Using the same example in python, 
everything went OK !.

What I'm I doing wrong ????

Thanks, Luis Sousa


Matt H wrote:

>On Fri, 08 Mar 2002 09:35:53 +0000
>"Luis Sousa" < @ualg.pt=""> wrote:
>
>>Where can I find some examples to implement classes using mod_python ?
>>
>>I'm using the example that is in the documentation in python.org to 
>>build a class but something is going wrong.
>>
>
>I can build classes just fine, what's the actual problem?
> 
>
>>Thanks, Luis Sousa
>>
>
>





From matt at proweb.co.uk  Fri Mar  8 10:40:42 2002
From: matt at proweb.co.uk (Matt H)
Date: Fri Jan  9 22:03:05 2004
Subject: [mod_python] [Fwd: Defining classes using mod_python]
In-Reply-To: <3C8898C8.6000203@ualg.pt>
References: <3C8885F9.2000300@ualg.pt>
	<20020308093802.450c7dc1.matt@proweb.co.uk>
	<3C8898C8.6000203@ualg.pt>
Message-ID: <20020308104042.0a1634a2.matt@proweb.co.uk>

On Fr
> 
> I was suppose to work all the time. Using the same example in python, 
> everything went OK !.
> 
> What I'm I doing wrong ????
> 

ah, I don't use mod_python.publisher 

sorry

From llsousa at ualg.pt  Fri Mar  8 11:19:10 2002
From: llsousa at ualg.pt (Luis Sousa)
Date: Fri Jan  9 22:03:05 2004
Subject: [mod_python] [Fwd: Defining classes using mod_python]
References: <3C8885F9.2000300@ualg.pt>	<20020308093802.450c7dc1.matt@proweb.co.uk>	<3C8898C8.6000203@ualg.pt> <20020308104042.0a1634a2.matt@proweb.co.uk>
Message-ID: <3C889E2E.3010002@ualg.pt>

What do you use then ??


Matt H wrote:

>On Fr
>
>>I was suppose to work all the time. Using the same example in python, 
>>everything went OK !.
>>
>>What I'm I doing wrong ????
>>
>
>ah, I don't use mod_python.publisher 
>
>sorry
>
>




From ts1 at cma.co.jp  Fri Mar  8 20:21:14 2002
From: ts1 at cma.co.jp (SONE Takeshi)
Date: Fri Jan  9 22:03:05 2004
Subject: [Fwd: Re: [mod_python] [Fwd: Defining classes using mod_python]]
In-Reply-To: <3C889986.9050003@ualg.pt>
References: <3C889986.9050003@ualg.pt>
Message-ID: <20020308112113.GA3865@cma.co.jp>

On Fri, Mar 08, 2002 at 10:59:18AM +0000, Luis Sousa wrote:
> What I'm I doing wrong ????

Try reloading (restarting) apache.

-- 
Takeshi

From llsousa at ualg.pt  Fri Mar  8 11:25:46 2002
From: llsousa at ualg.pt (Luis Sousa)
Date: Fri Jan  9 22:03:05 2004
Subject: [Fwd: Re: [mod_python] [Fwd: Defining classes using mod_python]]
References: <3C889986.9050003@ualg.pt>
Message-ID: <3C889FBA.1070107@ualg.pt>

> I have two files, one that I used to define a class and other one that 
> calls the class:
>    - file that defines the class: pessoalWEB.py
>
>                class MyClass:
>                    def __init__ (self):
>                        self.x = ''
>                        self.y = ''
>
>    - file that uses the class: callClassWEB.py
>                 import pessoalWEB
>
>                def testFunc():
>                    MyClass = pessoalWEB.MyClass()
>                    saida = MyClass.x
>                    saida = MyClass.y
>                    if saida=='':
>                        saida="NULL"
>                      return saida
>
> I call this file using 
> http://machinename/~llsousa/gpessoal/callClassWEB.py/testFunc in my 
> browser.

I already saw what was the problem. The object. was not well 
initialized. It was MyClass = pessoal.MyClass() instead of MyClass = 
pessoalWEB.MyClass()

But now I notice something strange. When I define saida = MyClass.k it 
gave no error.
Souldn't it gave an error like this: AttributeError: MyClass instance 
has no attribute 'k' ???

Why it doesn't do that ?

Thanks, Luis Sousa


From matt at proweb.co.uk  Fri Mar  8 11:06:10 2002
From: matt at proweb.co.uk (Matt H)
Date: Fri Jan  9 22:03:05 2004
Subject: [mod_python] [Fwd: Defining classes using mod_python]
In-Reply-To: <3C889E2E.3010002@ualg.pt>
References: <3C8885F9.2000300@ualg.pt>
	<20020308093802.450c7dc1.matt@proweb.co.uk>
	<3C8898C8.6000203@ualg.pt>
	<20020308104042.0a1634a2.matt@proweb.co.uk>
	<3C889E2E.3010002@ualg.pt>
Message-ID: <20020308110610.3aeca7e2.matt@proweb.co.uk>

On Fri, 08 Mar 2002 11:19:10 +0000
"Luis Sousa" <llsousa@ualg.pt> wrote:

> What do you use then ??

something like this :
--- httpd.conf ----------
<Directory /www/python>
  AddHandler python-program .py
  PythonHandler contentAdmin
  PythonDebug On
</Directory>
-------------------------



------- contentAdmin.py -

from mod_python import apache
from mod_python import util

def handler(request):
        global req
        req = request
        req.content_type = "text/html"
        req.send_http_header()

        req.write(getTheHTML())
	

        return apache.OK

-------------------------

I also use this inside a <VirtualHost
---------httpd.conf----------------
	<Location /profile>
                AddHandler python-program .py
                PythonAuthenHandler authHandler
                PythonDebug On
	</Location>
----------

(Directory is a class of my own)

---- authHandler.py --
import Directory
import md5

from mod_python import apache
from mod_python import util


def authenhandler(req):
        pwd = req.get_basic_auth_pw()
        usr = req.connection.user
        if pwd and usr :
                d = Directory.Directory("/www/Users/" + usr)
                mdu = d.getLines('md5')
                if mdu[0][:-1] == md5.new(pwd).hexdigest() :
                         return apache.OK
                else :
                         return apache.HTTP_UNAUTHORIZED
        return apache.HTTP_UNAUTHORIZED


-------------------------

From llsousa at ualg.pt  Fri Mar  8 11:46:42 2002
From: llsousa at ualg.pt (Luis Sousa)
Date: Fri Jan  9 22:03:05 2004
Subject: [mod_python] [Fwd: Defining classes using mod_python]
References: <3C8885F9.2000300@ualg.pt>	<20020308093802.450c7dc1.matt@proweb.co.uk>	<3C8898C8.6000203@ualg.pt>	<20020308104042.0a1634a2.matt@proweb.co.uk>	<3C889E2E.3010002@ualg.pt> <20020308110610.3aeca7e2.matt@proweb.co.uk>
Message-ID: <3C88A4A2.8010809@ualg.pt>

But in this way, there's only an handler for that directory, is that 
correct ?
Suppose that I want to have more than one handler in that directory, for 
my organization

Why do you use a virtual host ? That I didn't get it !!!!


Matt H wrote:

>On Fri, 08 Mar 2002 11:19:10 +0000
>"Luis Sousa" <llsousa@ualg.pt> wrote:
>
>>What do you use then ??
>>
>
>something like this :
>--- httpd.conf ----------
><Directory /www/python>
>  AddHandler python-program .py
>  PythonHandler contentAdmin
>  PythonDebug On
></Directory>
>-------------------------
>
>
>
>------- contentAdmin.py -
>
>from mod_python import apache
>from mod_python import util
>
>def handler(request):
>        global req
>        req = request
>        req.content_type = "text/html"
>        req.send_http_header()
>
>        req.write(getTheHTML())
>	
>
>        return apache.OK
>
>-------------------------
>
>I also use this inside a <VirtualHost
>---------httpd.conf----------------
>	<Location /profile>
>                AddHandler python-program .py
>                PythonAuthenHandler authHandler
>                PythonDebug On
>	</Location>
>----------
>
>(Directory is a class of my own)
>
>---- authHandler.py --
>import Directory
>import md5
>
>from mod_python import apache
>from mod_python import util
>
>
>def authenhandler(req):
>        pwd = req.get_basic_auth_pw()
>        usr = req.connection.user
>        if pwd and usr :
>                d = Directory.Directory("/www/Users/" + usr)
>                mdu = d.getLines('md5')
>                if mdu[0][:-1] == md5.new(pwd).hexdigest() :
>                         return apache.OK
>                else :
>                         return apache.HTTP_UNAUTHORIZED
>        return apache.HTTP_UNAUTHORIZED
>
>
>-------------------------
>
>




From matt at proweb.co.uk  Fri Mar  8 11:48:20 2002
From: matt at proweb.co.uk (Matt H)
Date: Fri Jan  9 22:03:05 2004
Subject: [mod_python] [Fwd: Defining classes using mod_python]
In-Reply-To: <3C88A4A2.8010809@ualg.pt>
References: <3C8885F9.2000300@ualg.pt>
	<20020308093802.450c7dc1.matt@proweb.co.uk>
	<3C8898C8.6000203@ualg.pt>
	<20020308104042.0a1634a2.matt@proweb.co.uk>
	<3C889E2E.3010002@ualg.pt>
	<20020308110610.3aeca7e2.matt@proweb.co.uk>
	<3C88A4A2.8010809@ualg.pt>
Message-ID: <20020308114820.5c359c46.matt@proweb.co.uk>

On Fri, 08 Mar 2002 11:46:42 +0000
"Luis Sousa" <llsousa@ualg.pt> wrote:

> But in this way, there's only an handler for that directory, is that 
> correct ?
> Suppose that I want to have more than one handler in that directory, for
> my organization
> 
> Why do you use a virtual host ? That I didn't get it !!!!
> 

I should have pointed out that /www/python is aliased as my cgi-bin

The bit in the virtual host is just for HTTP authentication of that
particular directory


My setup is probably not correct for all setups. 
I'm the only user so I have a tendancy to do what works today :)

From grisha at modpython.org  Fri Mar  8 10:26:18 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:05 2004
Subject: [Fwd: Re: [mod_python] [Fwd: Defining classes using mod_python]]
In-Reply-To: <3C889FBA.1070107@ualg.pt>
Message-ID: <Pine.BSF.4.32.0203081022130.79915-100000@localhost>

This is probably because you're chaning pessoalWEB but the Python
interpreter ignores those changes because the pessoalWEB module is already
imported. You need to reload pessoalWEB or restart apache. There is a note
about that in the FAQ:

http://www.modpython.org/FAQ/faqw.py?req=all#3.1

P.S. There is nothing wrong with the publisher handler, it should work for
you just fine.

Grisha


On Fri, 8 Mar 2002, Luis Sousa wrote:

> > I have two files, one that I used to define a class and other one that
> > calls the class:
> >    - file that defines the class: pessoalWEB.py
> >
> >                class MyClass:
> >                    def __init__ (self):
> >                        self.x = ''
> >                        self.y = ''
> >
> >    - file that uses the class: callClassWEB.py
> >                 import pessoalWEB
> >
> >                def testFunc():
> >                    MyClass = pessoalWEB.MyClass()
> >                    saida = MyClass.x
> >                    saida = MyClass.y
> >                    if saida=='':
> >                        saida="NULL"
> >                      return saida
> >
> > I call this file using
> > http://machinename/~llsousa/gpessoal/callClassWEB.py/testFunc in my
> > browser.
>
> I already saw what was the problem. The object. was not well
> initialized. It was MyClass = pessoal.MyClass() instead of MyClass =
> pessoalWEB.MyClass()
>
> But now I notice something strange. When I define saida = MyClass.k it
> gave no error.
> Souldn't it gave an error like this: AttributeError: MyClass instance
> has no attribute 'k' ???
>
> Why it doesn't do that ?
>
> Thanks, Luis Sousa
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From llsousa at ualg.pt  Fri Mar  8 16:22:54 2002
From: llsousa at ualg.pt (Luis Sousa)
Date: Fri Jan  9 22:03:05 2004
Subject: [Fwd: Re: [mod_python] [Fwd: Defining classes using mod_python]]
References: <Pine.BSF.4.32.0203081022130.79915-100000@localhost>
Message-ID: <3C88E55E.2030605@ualg.pt>

I tried the sugestion that you gave me but it still working without 
giving me an error !!!
I tried putting the PythonHandler in apache directly to file and it gave 
me the error that I was expecting.

Probably it's some problem in my configuration, or something else !!!
What could it be ?

Luis Sousa

Gregory (Grisha) Trubetskoy wrote:

>This is probably because you're chaning pessoalWEB but the Python
>interpreter ignores those changes because the pessoalWEB module is already
>imported. You need to reload pessoalWEB or restart apache. There is a note
>about that in the FAQ:
>
>http://www.modpython.org/FAQ/faqw.py?req=all#3.1
>
>P.S. There is nothing wrong with the publisher handler, it should work for
>you just fine.
>
>Grisha
>
>
>On Fri, 8 Mar 2002, Luis Sousa wrote:
>
>>>I have two files, one that I used to define a class and other one that
>>>calls the class:
>>>   - file that defines the class: pessoalWEB.py
>>>
>>>               class MyClass:
>>>                   def __init__ (self):
>>>                       self.x = ''
>>>                       self.y = ''
>>>
>>>   - file that uses the class: callClassWEB.py
>>>                import pessoalWEB
>>>
>>>               def testFunc():
>>>                   MyClass = pessoalWEB.MyClass()
>>>                   saida = MyClass.x
>>>                   saida = MyClass.y
>>>                   if saida=='':
>>>                       saida="NULL"
>>>                     return saida
>>>
>>>I call this file using
>>>http://machinename/~llsousa/gpessoal/callClassWEB.py/testFunc in my
>>>browser.
>>>
>>I already saw what was the problem. The object. was not well
>>initialized. It was MyClass = pessoal.MyClass() instead of MyClass =
>>pessoalWEB.MyClass()
>>
>>But now I notice something strange. When I define saida = MyClass.k it
>>gave no error.
>>Souldn't it gave an error like this: AttributeError: MyClass instance
>>has no attribute 'k' ???
>>
>>Why it doesn't do that ?
>>
>>Thanks, Luis Sousa
>>
>>_______________________________________________
>>Mod_python mailing list
>>Mod_python@modpython.org
>>http://www.modpython.org/mailman/listinfo/mod_python
>>
>
>
>




From reitz at inworks.de  Mon Mar 11 19:19:04 2002
From: reitz at inworks.de (Andre Reitz)
Date: Fri Jan  9 22:03:05 2004
Subject: [mod_python] BUG IN cgihandler / setup_cgi
Message-ID: <3C8CF518.FCBFD053@inworks.de>

def setup_cgi(req):
    """
    Replace sys.stdin and stdout with an objects that read/write to
    the socket, as well as substitute the os.environ.
    Returns (environ, stdin, stdout) which you must save and then use
    with restore_nocgi().
    """

    # save env
    env = os.environ.copy() <<<< 1 !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

    si = sys.stdin
    so = sys.stdout

    env = build_cgi_env(req) <<<<< 2 !!!!!!!!!!!!!!!!!!!

    for k in env.keys():
        os.environ[k] = env[k]

    sys.stdout = CGIStdout(req)
    sys.stdin = CGIStdin(req)

    sys.argv = [] # keeps cgi.py happy

    return env, si, so <<<< 3 !!!!!!!!!!!!!!!!!!!!!!!!!


- The env (1) perhaps should be called originalenv
- (2) keep as is
- (3) change to: return originalenv, si, so


Will somebody patch it?

This can cause critical bugs!

Greetings, Andre'

--
_____________________________________________
inworks GmbH            Andre Reitz
Magirusstrasse 44       Tel. 0731/93 80 7-21
89077 Ulm               http://www.inworks.de

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020311/a753796f/attachment-0003.htm
From reitz at inworks.de  Mon Mar 11 19:26:28 2002
From: reitz at inworks.de (Andre Reitz)
Date: Fri Jan  9 22:03:05 2004
Subject: [mod_python] Several Python Installations
Message-ID: <3C8CF6D3.469BA1C2@inworks.de>

I have two python installations on a single machine:

    /usr/bin/python2.1 (with threads, SuSE rpm installation)

and

    /opt/inworks/bin/python2.1   (no threads for mod_python)


Anything compiled good.

mod_python - libs are only installed in
    /opt/inworks/lib/python2.1/site-packages/mod_python

Anything works fine.

BUT: if there is a symbolic link:
  /usr/bin/python -> /usr/bin/python2.1
then mod_python tries to import mod_python.apache from
/usr/lib/python2.1/site-packages and fails.

if I delete  the symbolic link /usr/bin/python and
restart apache anything is good again.


WHY DOES IT BEHAVE LIKE THIS? is it a problem of libpython???

Thank you very much in advance.

--
_____________________________________________
inworks GmbH            Andre Reitz
Magirusstrasse 44       Tel. 0731/93 80 7-21
89077 Ulm               http://www.inworks.de

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020311/c623a917/attachment-0003.htm
From grisha at modpython.org  Mon Mar 11 14:13:19 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:06 2004
Subject: [mod_python] BUG IN cgihandler / setup_cgi
In-Reply-To: <3C8CF518.FCBFD053@inworks.de>
Message-ID: <Pine.BSF.4.32.0203111411110.20785-100000@localhost>

This is clearly a booboo, thanks Andre for pointing it out. I'll make sure
to patch it up in cvs.

On Mon, 11 Mar 2002, Andre Reitz wrote:

> def setup_cgi(req):
>     """
>     Replace sys.stdin and stdout with an objects that read/write to
>     the socket, as well as substitute the os.environ.
>     Returns (environ, stdin, stdout) which you must save and then use
>     with restore_nocgi().
>     """
>
>     # save env
>     env = os.environ.copy() <<<< 1 !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
>
>     si = sys.stdin
>     so = sys.stdout
>
>     env = build_cgi_env(req) <<<<< 2 !!!!!!!!!!!!!!!!!!!
>
>     for k in env.keys():
>         os.environ[k] = env[k]
>
>     sys.stdout = CGIStdout(req)
>     sys.stdin = CGIStdin(req)
>
>     sys.argv = [] # keeps cgi.py happy
>
>     return env, si, so <<<< 3 !!!!!!!!!!!!!!!!!!!!!!!!!
>
>
> - The env (1) perhaps should be called originalenv
> - (2) keep as is
> - (3) change to: return originalenv, si, so
>
>
> Will somebody patch it?
>
> This can cause critical bugs!
>
> Greetings, Andre'
>
> --
> _____________________________________________
> inworks GmbH            Andre Reitz
> Magirusstrasse 44       Tel. 0731/93 80 7-21
> 89077 Ulm               http://www.inworks.de
>
>


From grisha at modpython.org  Mon Mar 11 14:15:22 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:06 2004
Subject: [mod_python] Several Python Installations
In-Reply-To: <3C8CF6D3.469BA1C2@inworks.de>
Message-ID: <Pine.BSF.4.32.0203111414160.20785-100000@localhost>

I don't believe mod_python does anything with those, so its probably
something in libpython..

On Mon, 11 Mar 2002, Andre Reitz wrote:

> I have two python installations on a single machine:
>
>     /usr/bin/python2.1 (with threads, SuSE rpm installation)
>
> and
>
>     /opt/inworks/bin/python2.1   (no threads for mod_python)
>
>
> Anything compiled good.
>
> mod_python - libs are only installed in
>     /opt/inworks/lib/python2.1/site-packages/mod_python
>
> Anything works fine.
>
> BUT: if there is a symbolic link:
>   /usr/bin/python -> /usr/bin/python2.1
> then mod_python tries to import mod_python.apache from
> /usr/lib/python2.1/site-packages and fails.
>
> if I delete  the symbolic link /usr/bin/python and
> restart apache anything is good again.
>
>
> WHY DOES IT BEHAVE LIKE THIS? is it a problem of libpython???
>
> Thank you very much in advance.
>
> --
> _____________________________________________
> inworks GmbH            Andre Reitz
> Magirusstrasse 44       Tel. 0731/93 80 7-21
> 89077 Ulm               http://www.inworks.de
>
>


From EmailCenter at 163.com  Thu Mar 14 14:33:36 2002
From: EmailCenter at 163.com (March 8)
Date: Fri Jan  9 22:03:06 2004
Subject: [mod_python] Pozdravlyaem !!!   March 8 - Sweetness Love  Passion  Happiness  for YOU !!!
Message-ID: <200203140634.g2E6YKs53870@eden.ispol.com>

An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020314/f1e32903/attachment-0003.htm
From barbara.joshua at worldnet.att.net  Sun Mar 17 10:27:54 2002
From: barbara.joshua at worldnet.att.net (Barbara & Joshua Fierer)
Date: Fri Jan  9 22:03:06 2004
Subject: [mod_python] uploading files via forms causes occasional errors
Message-ID: <001e01c1cde1$75fdfd80$096a580c@pavilion>

Hi,

I am trying to upload files HTML forms and mod_python.publisher. I am using the "form"
member of the req object.

Sometimes the upload works fine, just like expected, but then all of a sudden it doesn't work and I get "Internal Server Error".

I am running Apache 1.3.22/mod_python 2.7.6/python 2.1.1 on Redhat 7.1. Below you find the error message from the apache 
errorlog file.

Does anyone know how to fix this ? I really appreciate your help.
thanks.

Stephan Altmueller 


Apache Error log:
=============

[Sat Mar 16 16:44:49 2002] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line 193, in Dispatch
    result = object(req)
[Sat Mar 16 16:44:49 2002] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.1/site-packages/mod_python/publisher.py", line 96, in handler
    fs = util.FieldStorage(req, keep_blank_values=1)
[Sat Mar 16 16:44:49 2002] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.1/site-packages/mod_python/util.py", line 180, in __init__
    file = self.make_file()
[Sat Mar 16 16:44:49 2002] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.1/site-packages/mod_python/util.py", line 207, in make_file
    return tempfile.TemporaryFile("w+b")
[Sat Mar 16 16:44:49 2002] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.1/tempfile.py", line 149, in TemporaryFile
    name = mktemp(suffix)
[Sat Mar 16 16:44:49 2002] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.1/tempfile.py", line 116, in mktemp
    if not os.path.exists(file):
[Sat Mar 16 16:44:49 2002] [error] PythonHandler mod_python.publisher:   File "/usr/local/lib/python2.1/posixpath.py", line 171, in exists
    st = os.stat(path)
[Sat Mar 16 16:44:49 2002] [error] PythonHandler mod_python.publisher: OSError: [Errno 2] No such file or directory: '/tmp/@8407.10'

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020317/c0097d26/attachment-0003.htm
From mvolkov at sympatico.ca  Sun Mar 17 13:44:21 2002
From: mvolkov at sympatico.ca (Maxim Volkov)
Date: Fri Jan  9 22:03:06 2004
Subject: [mod_python] Manual ... Installation ... Confusion
Message-ID: <BFEMIAHPFOMFALAEFBKGGENGCAAA.mvolkov@sympatico.ca>

Hello everyone,

Sorry, installation question again.

Is the following statement true :
"Using mod_python you can configure httpd.conf for one and only one script
with .py extension"?
In manual case the file is mptest.py.

If above statement is NOT true can you please give me suggestion about how
httpd.conf or/and mod_python should be modified from mod_python's manual
version :

<Directory /some/directory/htdocs/test>
	AddHandler python-program .py
	PythonHandler mptest
	PythonDebug On
</Directory>

to something more practical?

Yes, I did read manual.
Yes, I do understand how handlers work.
Yes, I paid extra attention to the manual's section 3.2.
Still no luck. Ether only mptest.py runs for all .py files or doesn't work
at all.

My layout: Win2k, Apache 1.3, Python 2.2, mod_python 2.7.6. Mod_python
configured in accordance to the manual (Release 2.7.6).

Or may be mod_python is not really right environment to learn how to use
Python for the Web applications?

Thank you in advance for any suggestions, links or book references.

Maxim Volkov






From bs at wasd.dk  Sun Mar 17 22:53:56 2002
From: bs at wasd.dk (=?iso-8859-1?Q?Bjarke_S=F8rensen?=)
Date: Fri Jan  9 22:03:06 2004
Subject: [mod_python] Manual ... Installation ... Confusion
In-Reply-To: <BFEMIAHPFOMFALAEFBKGGENGCAAA.mvolkov@sympatico.ca>
References: <BFEMIAHPFOMFALAEFBKGGENGCAAA.mvolkov@sympatico.ca>
Message-ID: <32873.80.196.15.227.1016402036.squirrel@wasd.dk>

Maxim Volkov skrev:
> Is the following statement true :
> "Using mod_python you can configure httpd.conf for one and only one
> script with .py extension"?
> In manual case the file is mptest.py.

As I see it you can create Handlers in mod_python, which then serve your
.something files.

I agree  that the manual is a bit unclear.
But installing a 3rd party mod_python like maki made things clearer to me.

> Yes, I do understand how handlers work.

Sure?

mod_python allows Python developers to write modules which plugs into the
Apache webserver, and have access to some of the internals.


> Yes, I paid extra attention to the manual's section 3.2.

I read that 4 times, I first understood after the maki mentioned above.


> Still no luck. Ether only mptest.py runs for all .py files or doesn't
> work at all.

Yup.


> Or may be mod_python is not really right environment to learn how to
> use Python for the Web applications?

mod_snake offers Python embedded in html (? l? php).
(Sorry if that is inapropiate for this list.)

> Thank you in advance for any suggestions, links or book references.

maki: http://maki.sourceforge.net/
mod_snake: http://modsnake.sourceforge.net/

> Maxim Volkov

Any relations? (Sorry, couldn't resist ;)

-- 
+-----------------+
| Bjarke S?rensen |
|  <bs@wasd.dk>   |
| http://wasd.dk/ |
+-----------------+



From jw9 at softhome.net  Mon Mar 18 22:34:07 2002
From: jw9 at softhome.net (jw9@softhome.net)
Date: Fri Jan  9 22:03:06 2004
Subject: [mod_python] Windows 2000 + Apache 1.3.23 + python2.2 + mod_python 2.76, Error
Message-ID: <003e01c1cef6$ed0e2b50$a4c9cd80@laptop>

"""
Syntax error on line 627 of d:/apache group/apache/conf/httpd.conf:
Invalid command 'PythonHandler', perhaps mis-spelled or defined by a module
not included in the server configuration
Note the errors or messages above, and press the <ESC> key to exit.  26...
""
Can anybody help me?

Actually the mod_python.dll I downloaded is for apache 1.3.22,  Could that
be the problem?

My httpd.conf file is attached, just in case.

Thanks!
-------------- next part --------------
A non-text attachment was scrubbed...
Name: httpd.conf
Type: application/octet-stream
Size: 35903 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20020318/c8d356db/httpd-0003.obj
From rien at yeepa.org  Tue Mar 19 19:13:59 2002
From: rien at yeepa.org (Adrien Pisson)
Date: Fri Jan  9 22:03:06 2004
Subject: [mod_python] Windows 2000 + Apache 1.3.23 + python2.2 + mod_python 2.76, Error
References: <003e01c1cef6$ed0e2b50$a4c9cd80@laptop>
Message-ID: <002401c1cf71$d92d18f0$2cee4cd4@RANDOM>

I'm using windows 2000 too.

When i first added the "LoadModule python_module modules/mod_python.dll",
the server complained about not being able to do something i don't remember
with a *.c file.
So i added "AddModule mod_python.c" and even if i don't have any
mod_python.c, it works fine.

In case this do not help in any way, enable the server-info module by
uncommenting the following lines:
LoadModule info_module modules/mod_info.so
AddModule mod_info.c
and all other lines related to server-info (you may have to change the
"Location /server-info" directive to allow it from all) .
Then launch a browser, and type http://localhost/server-info/. From this
page you can look at the modules loaded, and see if mod_python is correctly
installed.

--
rien

ps: btw, it seems there are some many errors in the mod_python manual
concerning windows installation... or the manual is unclear...
i'm not sure of all i say but if anybody as some explanations, they are
welcome. Here it is

- point 1:
  * "Move (or just drag & drop) the mod python-x folder into the Python lib
     folder (i.e C:\ Program Files\ Python\ lib)."
    i'm not sure of it, but i think the mod_python-x folder should be also
    renamed 'mod_python'

  * "Move the files in the folder lib inside the mod python folder (C:\
     Program Files\ Python\ lib\ mod_python-x\ lib\ mod python) to the
     C:\ Program Files\ Python\ lib\ mod_python folder. It's safe to delete
these folders we
     just emptied."
    the first path is incorrect: it's
'...\lib\mod_python-x\python\mod_python\'

- point 2:
  * it talks about adding the LoadModule directive, but on my installation,
i
    had also to add a AddModule directive (i don't really know why...)


From jw9 at softhome.net  Wed Mar 20 01:08:01 2002
From: jw9 at softhome.net (jw9@softhome.net)
Date: Fri Jan  9 22:03:06 2004
Subject: [mod_python] Windows 2000 + Apache 1.3.23 + python2.2 + mod_python 2.76, Error
References: <003e01c1cef6$ed0e2b50$a4c9cd80@laptop> <002401c1cf71$d92d18f0$2cee4cd4@RANDOM>
Message-ID: <002001c1cfd5$97533180$4a00a8c0@laptop>

just put in "AddModule mod_python.c", and it works just fine.

Thanks, Adrien, and maybe somebody should put this into the mod_python
manual.

----- Original Message -----
From: "Adrien Pisson" <rien@yeepa.org>
To: <jw9@softhome.net>; <mod_python@modpython.org>
Sent: Tuesday, March 19, 2002 1:13 PM
Subject: Re: [mod_python] Windows 2000 + Apache 1.3.23 + python2.2 +
mod_python 2.76, Error


> I'm using windows 2000 too.
>
> When i first added the "LoadModule python_module modules/mod_python.dll",
> the server complained about not being able to do something i don't
remember
> with a *.c file.
> So i added "AddModule mod_python.c" and even if i don't have any
> mod_python.c, it works fine.
>
> In case this do not help in any way, enable the server-info module by
> uncommenting the following lines:
> LoadModule info_module modules/mod_info.so
> AddModule mod_info.c
> and all other lines related to server-info (you may have to change the
> "Location /server-info" directive to allow it from all) .
> Then launch a browser, and type http://localhost/server-info/. From this
> page you can look at the modules loaded, and see if mod_python is
correctly
> installed.
>
> --
> rien
>
> ps: btw, it seems there are some many errors in the mod_python manual
> concerning windows installation... or the manual is unclear...
> i'm not sure of all i say but if anybody as some explanations, they are
> welcome. Here it is
>
> - point 1:
>   * "Move (or just drag & drop) the mod python-x folder into the Python
lib
>      folder (i.e C:\ Program Files\ Python\ lib)."
>     i'm not sure of it, but i think the mod_python-x folder should be also
>     renamed 'mod_python'
>
>   * "Move the files in the folder lib inside the mod python folder (C:\
>      Program Files\ Python\ lib\ mod_python-x\ lib\ mod python) to the
>      C:\ Program Files\ Python\ lib\ mod_python folder. It's safe to
delete
> these folders we
>      just emptied."
>     the first path is incorrect: it's
> '...\lib\mod_python-x\python\mod_python\'
>
> - point 2:
>   * it talks about adding the LoadModule directive, but on my
installation,
> i
>     had also to add a AddModule directive (i don't really know why...)
>


From bob at redivi.com  Wed Mar 20 11:12:20 2002
From: bob at redivi.com (Bob Ippolito)
Date: Fri Jan  9 22:03:06 2004
Subject: [mod_python] Compiling on MacOS X
In-Reply-To: <2174778112.1014679254@kelethin>
Message-ID: <41D1077D-3C1D-11D6-9796-0003938210D6@redivi.com>

I have successfully compiled mod_python on MacOS X 10.1.3.  I did it the 
other night bored at the hotel on a business trip, because I didn't have 
net access and wanted to debug some stuff.

I have actually planned on releasing it more properly, but I was having 
issues with metapackages.. anyhow, here you go:

http://redivi.com/~bob/mod_python-2.7.6-osx.dmg.gz

-bob

On Monday, February 25, 2002, at 06:20 PM, Brian Brown wrote:

> Greetings!
>  I am trying to compile mod_python 2.7.6 on MacOS 10.1.3 with no 
> success. I get the following:
>
> cc: cannot specify -o with -c or -S with multiple compilations
>
>
> I tried to take the -c out of the src/Makefile, but it had no effect on 
> the make process... any ideas?
>
> Brian
>
> /-----------------
> Brian Brown
> ICCE Technologies, Inc.
> http://www.icce-t.com
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From bob at redivi.com  Wed Mar 20 11:18:10 2002
From: bob at redivi.com (Bob Ippolito)
Date: Fri Jan  9 22:03:06 2004
Subject: [mod_python] File upload progress indicator
Message-ID: <126119D2-3C1E-11D6-9796-0003938210D6@redivi.com>

I'm developing an application using mod_python and I'd like to include 
file upload progress indication.. However, I don't see any obvious way 
on how do to such a thing.

It's possible in mod_perl, and I've done it before, using 
Apache::Request (see http://httpd.apache.org/apreq/Apache-Request.html)

Is this functionality possible in the current incarnation of mod_python 
or should I write this component in mod_perl or C?

-bob


From bakey at traq.com  Wed Mar 20 10:52:29 2002
From: bakey at traq.com (Brian Akey)
Date: Fri Jan  9 22:03:06 2004
Subject: [mod_python] File upload progress indicator
Message-ID: <780A5D64B1CC9544AB7B702F39219C1E60E0@traqexch.traq.com>

I have a cgi python script that does upload. It should be easy to convert.
#!/usr/bin/python

import cgi
form = cgi.FieldStorage()
print 'Content-type: text/html'
print

if not form:
        print """
        <html><head><title>File Upload</title></head><body>
        <form action"/cgi-bin/file.py" method="POST"
enctype="multipart/form-data">
        <input type="file" name="filename">
        <input type="submit" name="Send_File" value="Send_File">
        </form>
        <p>Please compress the file(s) with Winzip or some other compression

tool before sending the file.
        </body></html>
        """
elif form.has_key("filename"):
        item = form["filename"]
        if item.file:
                data = item.file.read()
                filen = item.filename
                filen1 = filen.split('\\')
                filen2 = filen1[len(filen1)-1]
                #filen2 = 'd.txt'
                open('/www/download/' + filen2 + '.tmp','wb').write(data)
                print """
                <html><head><title>File Upload</title></head><body>
                Thank you for the file
                """
                print cgi.escape(filen2)
                print '</body></html>'

-----Original Message-----
From: Bob Ippolito [mailto:bob@redivi.com]
Sent: Wednesday, March 20, 2002 10:18 AM
To: mod_python@modpython.org
Subject: [mod_python] File upload progress indicator


I'm developing an application using mod_python and I'd like to include 
file upload progress indication.. However, I don't see any obvious way 
on how do to such a thing.

From bob at redivi.com  Wed Mar 20 12:10:28 2002
From: bob at redivi.com (Bob Ippolito)
Date: Fri Jan  9 22:03:06 2004
Subject: [mod_python] File upload progress indicator
In-Reply-To: <780A5D64B1CC9544AB7B702F39219C1E60E0@traqexch.traq.com>
Message-ID: <604E6B08-3C25-11D6-9796-0003938210D6@redivi.com>

Brian,

The problem isn't with file uploading in general, I want to generate 
near-realtime progress indications of the file upload's progress.  Which 
should be possible by examining the Content-length header and making a 
separate connection to the webserver, tracked via a session cookie.  
It's actually really nice to be able to do this asynchronously in Flash 
5.0+ using XML sockets, which I may or may not end up doing.  I'll 
probably open source this component of it since it's really quite 
useful, given that the status bars in IE don't tell you the progress of 
a file upload, only if it's still going or not (and even then, not very 
obviously).

The problem is that when you use FieldStorage, you have already 
processed the file upload.  You don't get callbacks when apache is 
reading.

My client is going to be dealing with large files quite often, and 
although I didn't specify that I was going to provide them this advanced 
functionality, I would like to give it to them anyway as it's really 
nice from a UI standpoint.

-bob

On Wednesday, March 20, 2002, at 11:52 AM, Brian Akey wrote:

> I have a cgi python script that does upload. It should be easy to 
> convert.
> --snip--
>
> -----Original Message-----
> From: Bob Ippolito [mailto:bob@redivi.com]
> Sent: Wednesday, March 20, 2002 10:18 AM
> To: mod_python@modpython.org
> Subject: [mod_python] File upload progress indicator
>
>
> I'm developing an application using mod_python and I'd like to include
> file upload progress indication.. However, I don't see any obvious way
> on how do to such a thing.


From bob at redivi.com  Wed Mar 20 12:36:15 2002
From: bob at redivi.com (Bob Ippolito)
Date: Fri Jan  9 22:03:06 2004
Subject: [mod_python] Compiling on MacOS X
In-Reply-To: <41D1077D-3C1D-11D6-9796-0003938210D6@redivi.com>
Message-ID: <FA803D73-3C28-11D6-9796-0003938210D6@redivi.com>

fyi, I setup a small container page for it and released on 
versiontracker.. prepare for the flood of new osx users of mod_python 
(hopefully) :)

http://redivi.com/~bob/mod_python.html
http://www.versiontracker.com/moreinfo.fcgi?id=14075&db=macosx

-bob

On Wednesday, March 20, 2002, at 11:12 AM, Bob Ippolito wrote:

> I have successfully compiled mod_python on MacOS X 10.1.3.  I did it 
> the other night bored at the hotel on a business trip, because I didn't 
> have net access and wanted to debug some stuff.
>
> I have actually planned on releasing it more properly, but I was having 
> issues with metapackages.. anyhow, here you go:
>
> http://redivi.com/~bob/mod_python-2.7.6-osx.dmg.gz
>
> -bob
>
> On Monday, February 25, 2002, at 06:20 PM, Brian Brown wrote:
>
>> Greetings!
>>  I am trying to compile mod_python 2.7.6 on MacOS 10.1.3 with no 
>> success. I get the following:
>>
>> cc: cannot specify -o with -c or -S with multiple compilations
>>
>>
>> I tried to take the -c out of the src/Makefile, but it had no effect 
>> on the make process... any ideas?
>>
>> Brian
>>
>> /-----------------
>> Brian Brown
>> ICCE Technologies, Inc.
>> http://www.icce-t.com
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://www.modpython.org/mailman/listinfo/mod_python
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From bbrown at icce-t.com  Wed Mar 20 13:31:18 2002
From: bbrown at icce-t.com (Brian Brown)
Date: Fri Jan  9 22:03:06 2004
Subject: [mod_python] Compiling on MacOS X
In-Reply-To: <FA803D73-3C28-11D6-9796-0003938210D6@redivi.com>
References: <FA803D73-3C28-11D6-9796-0003938210D6@redivi.com>
Message-ID: <26200000.1016656278@kelethin.icce-t.com>

--On Wednesday, March 20, 2002 12:36:15 PM -0500 Bob Ippolito 
<bob@redivi.com> wrote:

> fyi, I setup a small container page for it and released on
> versiontracker.. prepare for the flood of new osx users of mod_python
> (hopefully) :)
>

Thanks Bob! You're a lifesaver :)



> http://redivi.com/~bob/mod_python.html
> http://www.versiontracker.com/moreinfo.fcgi?id=14075&db=macosx
>
> -bob
>
> On Wednesday, March 20, 2002, at 11:12 AM, Bob Ippolito wrote:
>
>> I have successfully compiled mod_python on MacOS X 10.1.3.  I did it
>> the other night bored at the hotel on a business trip, because I didn't
>> have net access and wanted to debug some stuff.
>>
>> I have actually planned on releasing it more properly, but I was having
>> issues with metapackages.. anyhow, here you go:
>>
>> http://redivi.com/~bob/mod_python-2.7.6-osx.dmg.gz
>>
>> -bob
>>
>> On Monday, February 25, 2002, at 06:20 PM, Brian Brown wrote:
>>
>>> Greetings!
>>>  I am trying to compile mod_python 2.7.6 on MacOS 10.1.3 with no
>>> success. I get the following:
>>>
>>> cc: cannot specify -o with -c or -S with multiple compilations
>>>
>>>
>>> I tried to take the -c out of the src/Makefile, but it had no effect
>>> on the make process... any ideas?
>>>
>>> Brian
>>>
>>> /-----------------
>>> Brian Brown
>>> ICCE Technologies, Inc.
>>> http://www.icce-t.com
>>> _______________________________________________
>>> Mod_python mailing list
>>> Mod_python@modpython.org
>>> http://www.modpython.org/mailman/listinfo/mod_python
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://www.modpython.org/mailman/listinfo/mod_python
>
>
>

/-----------------
Brian Brown
ICCE Technologies, Inc.
http://www.icce-t.com

From ian at veryfresh.com  Wed Mar 20 17:31:10 2002
From: ian at veryfresh.com (Ian Clelland)
Date: Fri Jan  9 22:03:06 2004
Subject: [mod_python] Problems with GET after POST
Message-ID: <20020321013110.GE1811@fullfactor.com>

I have been experimenting with mod_python to evaluate it for some 
upcoming projects, and I recently came across what appeared to be a bug 
in mod_python.  (After three days of scratching my head over this, the 
solution came to me as I was writing this message, but I'm sending it 
anyway in case someone else comes across this problem. -- Should this 
sort of thing go into the FAQ?)

The problem was essentially that whenever I performed a GET request on 
a URL immediately following a POST request to that same URL, Apache 
would seem to confuse the two requests, and after the GET, I would 
receive an error message like this:

HTTP/1.1 501 Method Not Implemented

key=valueGET to /pytest not supported
Invalid method in request key=valueGET /pytest


Running tcpdump on the communication between the browser and server 
showed that the requests were all well-formed, and there was nothing 
unusual in the headers to suggest that anything but Apache/mod_python 
was at fault.


The simplest script I could produce to replicate the problem was this:

# -------------------------------------------------------------------
import sys
from mod_python import apache

def handler(req):

  if req.method == 'GET':
  
    req.content_type = "text/html"
    req.send_http_header()
    req.write("""<html>
<head>
  <title>python test</title>
</head>
<body>
  <form method=\"post\" action=\"/pytest\">
    <input name=\"key\" value=\"value\"> <input type=\"submit\">
  </form>
</body>
</html>
""")

    return apache.OK

  elif req.method == 'POST':

    req.content_type = "text/html"
    req.send_http_header()
    req.write("""<html>
<head>
  <title>python test part 2</title>
</head>
<body>
  <p>POST successful. <a href=\"/pytest\">Click here</a></p>
</body>
</html>
""")
    return apache.OK

  else:
    return apache.DECLINED
# -------------------------------------------------------------------

It was supported by these Apache configuration directives:

<Location "/pytest">
  SetHandler python-program
  PythonPath "sys.path+['/home/ian/src/pytest']"
  PythonHandler python_test
</Location>


The script is accessable from the virtual URL /pytest, which runs the 
python_test.py module from a non-web-accessable directory. Going to the 
URL /pytest in Mozilla, hitting the submit button, then clicking on the 
'Click here' link brings up the error message.

The problem with this code (as it became apparent to me while writing 
this message) is that the POST handler never actually reads the POST 
data, and so it stays on stdin, and Apache treats it as the beginning 
of the next request. Simply inserting the line 'postdata = req.read()' 
gets rid of the error.

Questions:

Is this the correct behaviour for mod_python? Is it the python module 
writer's responsibility to read all POST data in all situations? What 
if the data is very large (say, a 5MB file when I expected a small text 
field) and I just want to discard it?


Ian
<ian@veryfresh.com>

From charney at charneyday.com  Wed Mar 20 21:34:32 2002
From: charney at charneyday.com (Reginald Charney)
Date: Fri Jan  9 22:03:06 2004
Subject: [mod_python] Installation problems
Message-ID: <200203210536.g2L5akf61316@mail.via.net>

I am unable to get mod_python working on my system. I think I have followed everything needed and documented, but when I enter the following URLs, I get:

/test/mptest.py  - I am asked what program to use to execute this file
/test/mptest      - lists the ASCII source of the file

The following is what I believe is the relevant information from my installation. Any help would be appreciated. TIA.

Reg. Charney

Partial contents of /etc/httpd/httpd.conf
=========================================

    #
    # And for PHP 4.x, use:
    #
    <IfModule mod_php4.c>
    AddType application/x-httpd-php .php
    AddType application/x-httpd-php .php4
    AddType application/x-httpd-php-source .phps
    </IfModule>

    #
    # And for mod_python, use:
    #
    <IfModule mod_python.c>
    AddType application/x-httpd-py .py
    </IfModule>
...
<Directory /usr/local/httpd/htdocs/test>
    AddHandler python-program .py
    PythonHandler mptest
    PythonDebug On
</Directory>


Test file /test/mptest.py
=========================

from mod_python import apache

def handler(req):
        req.send_http_header()
        req.write("hello world!")
        return apache.OK


Output from phpinfo()
=====================
System:		Linux x330-2 2.4.9 #3 SMP Wed Feb 13 15:02:07
Server Root:	/usr/local/httpd
Loaded Modules:	mod_userdir, mod_python, mod_php4, mod_perl, mod_setenvif, mod_unique_id, mod_usertrack, mod_headers, mod_expires, mod_cern_meta, mod_proxy, mod_digest, mod_auth_db, mod_auth_dbm, mod_auth_anon, mod_auth, mod_access, mod_rewrite, mod_alias, mod_speling, mod_actions, mod_imap, mod_asis, mod_cgi, mod_dir, mod_autoindex, mod_include, mod_info, mod_status, mod_negotiation, mod_mime, mod_mime_magic, mod_log_referer, mod_log_agent, mod_log_config, mod_define, mod_env, mod_vhost_alias, mod_mmap_static, mod_so, http_core

PYTHONPATH:	/usr/lib/python2.1:/usr/lib/python2.1/plat-linux2:/usr/lib/python2.1/lib-tk:/usr/lib/python2.1/lib-dynload:/usr/lib/python2.1/site-packages:/usr/lib/apache/lib/python/site-packages

SERVER_SOFTWARE: Apache/1.3.20 (Linux/SuSE) mod_python/2.7.5 Python/2.1.1 PHP/4.0.6 mod_perl/1.26

HTTP_ENV_VARS["PATH"]:	/usr/sbin:/bin:/usr/bin:/sbin:/usr/X11R6/bin 

From jeffstearns at attbi.com  Wed Mar 20 23:50:22 2002
From: jeffstearns at attbi.com (Jeff Stearns)
Date: Fri Jan  9 22:03:06 2004
Subject: [mod_python] Broken reload algorithm?
Message-ID: <4C727568-3CA0-11D6-9CF0-0030653DCC28@attbi.com>

I'm using the publisher handler with mod_python 2.7.6.  I'm doing 
development, so auto-reload is turned on.

This causes broken behavior.  I blame it on line 365 in apache.py:

     # if module is newer - reload
     if (autoreload and (oldmtime < mtime)):
         module = reload(module)

The code here assumes that the module can be found in sys.path. But 
that's not guaranteed when using publisher. The module may be found 
anywhere in the document tree.  Unfortunately, that provokes an 
exception.

I believe that the call to reload() should be replaced with 
imp.load_module(). The imp.load_module function *does* handle reloading, 
and it can be given the path to the module.  Unfortunately, the code 
needs to be reworked to test this theory.

Comments?  Am I missing the point here?

thx - jeff stearns


From ian at veryfresh.com  Thu Mar 21 03:16:59 2002
From: ian at veryfresh.com (Ian Clelland)
Date: Fri Jan  9 22:03:06 2004
Subject: [mod_python] Installation problems
In-Reply-To: <200203210536.g2L5akf61316@mail.via.net>
References: <200203210536.g2L5akf61316@mail.via.net>
Message-ID: <20020321111659.GA8699@fullfactor.com>

I believe that your problems stem from the fact that you are trying to 
use mod_python as if it was a 'traditional' scripting language like PHP 
or ASP.

With either of those languages, you can simply write scripts with the 
appropriate extensions, place them in a web-accessable directory, and 
they're automatically executable.

With mod_python, you are actually writing Apache modules in the python 
language. You need to use Apache directives to configure those modules 
to be activated at the appropriate times.

Depending on how you want to do things, I see two ways to get your test 
script to run:

1) Install the script as a handler. This is the closest to what you are 
   currently doing. The problem is that Python cannot find your module. 
   You can just add the line

     PythonPath "sys.path+['/usr/local/httpd/htdocs/test']"

   to your <Directory> entry, and the module should load.

2) Use the supplied Publisher handler (check the tutorial at 
   www.modpython.org). This is a great hack which allows a single 
   handler to load .py files from anywhere in your site. It appears to 
   be closer to what you intended to do, which is to just run a .py 
   file out of a URL.


I hope that helps clear things up.

A couple of quick points about your original email:

> /test/mptest.py  - I am asked what program to use to execute this file
This is because you have associated a MIME type with the .py extension, 
and Apache doesn't know what to do with it. (The mod_python module 
doesn't deal with MIME types like mod_php). The only thing it can do is 
offer the file for download.

> /test/mptest      - lists the ASCII source of the file
In this case, Apache's content negotiation is finding the best match 
for /mptest and returning that to you as a text document.

>     <IfModule mod_python.c>
>     AddType application/x-httpd-py .py
>     </IfModule>
This section is unnecessary, and should probably be deleted.

> PYTHONPATH:	/usr/lib/python2.1:/usr/lib/python2.1/plat-linux2:
> /usr/lib/python2.1/lib-tk:/usr/lib/python2.1/lib-dynload:/usr/lib/
> python2.1/site-packages:/usr/lib/apache/lib/python/site-packages
This variable shows the locations where Python will look for modules 
when you use an import statement (or a Python*Handler directive). Since 
/usr/local/httpd/htdocs/test is not in the list, Python cannot find 
your mptest module.


Regards,
Ian
<ian@veryfresh.com>

From maynard at mpi-cbg.de  Thu Mar 21 13:15:18 2002
From: maynard at mpi-cbg.de (Gary Maynard)
Date: Fri Jan  9 22:03:06 2004
Subject: [mod_python] persistant variables
In-Reply-To: <20020321111659.GA8699@fullfactor.com>
Message-ID: <NCEILGMPEAMDGEALMLEMKEJFCAAA.maynard@mpi-cbg.de>

Hi,
  I want to know how to store persistant variables in mod_python. I have
written some simple code that works like this:

def handler(req):
        global testthis
        try:
                d = testthis
        except:
                testthis = 1
        req.send_http_header()
        req.write(str(testthis))
        testthis = testthis + 1
        return apache.OK

each time the script is run it should print the last value of testthis and
then increment it.

However, because Apache has several servers running, I end up with several
instances of testhis, one of which gets printed and incremented each time.

How can I force mod_python to only have one instance of the variable? Or
should I be trying to do this in an entirely different way?

I can set Apache to only start with one server (which makes it work),
however it will spawn more servers if it gets two hits at the same time, so
this won't really work.

thanks
Gary




From grisha at modpython.org  Thu Mar 21 09:54:57 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:06 2004
Subject: [mod_python] Installation problems
In-Reply-To: <200203210536.g2L5akf61316@mail.via.net>
Message-ID: <Pine.BSF.4.32.0203210950420.55815-100000@localhost>

Just before sending headers, add a line like this:

        req.content_type = "text/plain"
        req.send_http_header()

and try the url which asks you what program to use, it might just work.
Apache sets different content-types based on your configuration, which can
vary, so sometimes you have to force it to text/plain or text/html.

Grisha


On Wed, 20 Mar 2002, Reginald Charney wrote:

> I am unable to get mod_python working on my system. I think I have followed everything needed and documented, but when I enter the following URLs, I get:
>
> /test/mptest.py  - I am asked what program to use to execute this file
> /test/mptest      - lists the ASCII source of the file
>
> The following is what I believe is the relevant information from my installation. Any help would be appreciated. TIA.
>
> Reg. Charney
>
> Partial contents of /etc/httpd/httpd.conf
> =========================================
>
>     #
>     # And for PHP 4.x, use:
>     #
>     <IfModule mod_php4.c>
>     AddType application/x-httpd-php .php
>     AddType application/x-httpd-php .php4
>     AddType application/x-httpd-php-source .phps
>     </IfModule>
>
>     #
>     # And for mod_python, use:
>     #
>     <IfModule mod_python.c>
>     AddType application/x-httpd-py .py
>     </IfModule>
> ...
> <Directory /usr/local/httpd/htdocs/test>
>     AddHandler python-program .py
>     PythonHandler mptest
>     PythonDebug On
> </Directory>
>
>
> Test file /test/mptest.py
> =========================
>
> from mod_python import apache
>
> def handler(req):
>         req.send_http_header()
>         req.write("hello world!")
>         return apache.OK
>
>
> Output from phpinfo()
> =====================
> System:		Linux x330-2 2.4.9 #3 SMP Wed Feb 13 15:02:07
> Server Root:	/usr/local/httpd
> Loaded Modules:	mod_userdir, mod_python, mod_php4, mod_perl, mod_setenvif, mod_unique_id, mod_usertrack, mod_headers, mod_expires, mod_cern_meta, mod_proxy, mod_digest, mod_auth_db, mod_auth_dbm, mod_auth_anon, mod_auth, mod_access, mod_rewrite, mod_alias, mod_speling, mod_actions, mod_imap, mod_asis, mod_cgi, mod_dir, mod_autoindex, mod_include, mod_info, mod_status, mod_negotiation, mod_mime, mod_mime_magic, mod_log_referer, mod_log_agent, mod_log_config, mod_define, mod_env, mod_vhost_alias, mod_mmap_static, mod_so, http_core
>
> PYTHONPATH:	/usr/lib/python2.1:/usr/lib/python2.1/plat-linux2:/usr/lib/python2.1/lib-tk:/usr/lib/python2.1/lib-dynload:/usr/lib/python2.1/site-packages:/usr/lib/apache/lib/python/site-packages
>
> SERVER_SOFTWARE: Apache/1.3.20 (Linux/SuSE) mod_python/2.7.5 Python/2.1.1 PHP/4.0.6 mod_perl/1.26
>
> HTTP_ENV_VARS["PATH"]:	/usr/sbin:/bin:/usr/bin:/sbin:/usr/X11R6/bin
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From grisha at modpython.org  Thu Mar 21 10:05:09 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:06 2004
Subject: [mod_python] Broken reload algorithm?
In-Reply-To: <4C727568-3CA0-11D6-9CF0-0030653DCC28@attbi.com>
Message-ID: <Pine.BSF.4.32.0203210957210.55815-100000@localhost>

It looks like you're right about this - I looked at the Python code
(Python/import.c) and it seems like it searches the path again for reload.
When I wrote this I was under the impression that Python would just reload
the original file from which the module came.

I'll make a note of this.

My mod_python todo list is just getting so huge...

Grisha


On Wed, 20 Mar 2002, Jeff Stearns wrote:

> I'm using the publisher handler with mod_python 2.7.6.  I'm doing
> development, so auto-reload is turned on.
>
> This causes broken behavior.  I blame it on line 365 in apache.py:
>
>      # if module is newer - reload
>      if (autoreload and (oldmtime < mtime)):
>          module = reload(module)
>
> The code here assumes that the module can be found in sys.path. But
> that's not guaranteed when using publisher. The module may be found
> anywhere in the document tree.  Unfortunately, that provokes an
> exception.
>
> I believe that the call to reload() should be replaced with
> imp.load_module(). The imp.load_module function *does* handle reloading,
> and it can be given the path to the module.  Unfortunately, the code
> needs to be reworked to test this theory.
>
> Comments?  Am I missing the point here?
>
> thx - jeff stearns
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From stony8 at gmx.de  Fri Mar 22 17:18:50 2002
From: stony8 at gmx.de (Alexander Steinert)
Date: Fri Jan  9 22:03:06 2004
Subject: [mod_python] persistant variables
In-Reply-To: <NCEILGMPEAMDGEALMLEMKEJFCAAA.maynard@mpi-cbg.de>; from maynard@mpi-cbg.de on Thu, Mar 21, 2002 at 01:15:18PM +0100
References: <20020321111659.GA8699@fullfactor.com> <NCEILGMPEAMDGEALMLEMKEJFCAAA.maynard@mpi-cbg.de>
Message-ID: <20020322171850.A1049@tyche.svt.tu-harburg.de>

> How can I force mod_python to only have one instance of the variable? Or
> should I be trying to do this in an entirely different way?
> 
> I can set Apache to only start with one server (which makes it work),
> however it will spawn more servers if it gets two hits at the same time, so
> this won't really work.

I thought about this topic a few weeks ago and came to the conclusion
that that you can't force the wished behaviour (if apache is forking).

You need persistent storage in a DBMS or a file and must take care of
concurrent accesses.

HTH

Stony


From ian at veryfresh.com  Fri Mar 22 10:09:59 2002
From: ian at veryfresh.com (Ian Clelland)
Date: Fri Jan  9 22:03:06 2004
Subject: [mod_python] persistant variables
In-Reply-To: <20020322171850.A1049@tyche.svt.tu-harburg.de>
References: <20020321111659.GA8699@fullfactor.com> <NCEILGMPEAMDGEALMLEMKEJFCAAA.maynard@mpi-cbg.de> <20020322171850.A1049@tyche.svt.tu-harburg.de>
Message-ID: <20020322180959.GB9162@fullfactor.com>

On Fri, Mar 22, 2002 at 05:18:50PM +0100, Alexander Steinert wrote:
> > How can I force mod_python to only have one instance of the variable? Or
> > should I be trying to do this in an entirely different way?
> > 
> > I can set Apache to only start with one server (which makes it work),
> > however it will spawn more servers if it gets two hits at the same time, so
> > this won't really work.
> 
> I thought about this topic a few weeks ago and came to the conclusion
> that that you can't force the wished behaviour (if apache is forking).
> 
> You need persistent storage in a DBMS or a file and must take care of
> concurrent accesses.

I've come to the same conclusion myself, after a fair bit of 
experimentation and research (there was a lengthy discussion on this 
list about a year ago: 
http://www.modpython.org/pipermail/mod_python/2001-April/001254.html ).

Because Apache (on Unix) forks new processes for its children, they 
must necessarily run in isolated memory spaces. However, since each 
child process is long-lived, you can retain some persistent data (like 
a database connection handle) between requests /to that child/. It's 
not quite the same thing as global persistent data, but it works for 
some applications.

Apparently mod_perl developers can get around this limitation by using 
the IPC::Shareable module -- has anybody in the Python community done 
any work on something similar?


Ian
<ian@veryfresh.com>

From bakey at traq.com  Fri Mar 22 13:53:47 2002
From: bakey at traq.com (Brian Akey)
Date: Fri Jan  9 22:03:06 2004
Subject: [mod_python] persistant variables
Message-ID: <780A5D64B1CC9544AB7B702F39219C1E60F0@traqexch.traq.com>

Is there a way to leverage the MM library that people compile in for
mod_ssl?

-----Original Message-----
From: Ian Clelland [mailto:ian@veryfresh.com]
Sent: Friday, March 22, 2002 12:10 PM
To: mod_python@modpython.org
Subject: Re: [mod_python] persistant variables


On Fri, Mar 22, 2002 at 05:18:50PM +0100, Alexander Steinert wrote:
> > How can I force mod_python to only have one instance of the variable? Or
> > should I be trying to do this in an entirely different way?
> > 
> > I can set Apache to only start with one server (which makes it work),
> > however it will spawn more servers if it gets two hits at the same time,
so
> > this won't really work.
> 
> I thought about this topic a few weeks ago and came to the conclusion
> that that you can't force the wished behaviour (if apache is forking).
> 
> You need persistent storage in a DBMS or a file and must take care of
> concurrent accesses.

I've come to the same conclusion myself, after a fair bit of 
experimentation and research (there was a lengthy discussion on this 
list about a year ago: 
http://www.modpython.org/pipermail/mod_python/2001-April/001254.html ).

Because Apache (on Unix) forks new processes for its children, they 
must necessarily run in isolated memory spaces. However, since each 
child process is long-lived, you can retain some persistent data (like 
a database connection handle) between requests /to that child/. It's 
not quite the same thing as global persistent data, but it works for 
some applications.

Apparently mod_perl developers can get around this limitation by using 
the IPC::Shareable module -- has anybody in the Python community done 
any work on something similar?


Ian
<ian@veryfresh.com>
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python

From s_lott at yahoo.com  Sat Mar 23 07:53:14 2002
From: s_lott at yahoo.com (Steven Lott)
Date: Fri Jan  9 22:03:06 2004
Subject: [mod_python] (no subject)
Message-ID: <20020323155314.50780.qmail@web9608.mail.yahoo.com>

Context:
Server version: Apache/1.3.20 (Unix)  (Red-Hat/Linux)
Python 2.2 (#2, Mar 23 2002, 07:48:23)
Mod_python 2.7.6

Did a rebuild of Python --without-threads
Did a build of mod_python --with-apxs pointing to my apxs in
/usr/sbin

Start apache with /usr/sbin/httpd -dHAVE_PYTHON

[Sat Mar 23 10:24:42 2002] [warn] Loaded DSO
modules/mod_python.so uses plain Apache 1.3 API, this module
might crash under EAPI! (please recompile it with -DEAPI)

What do I change in the config to include -DEAPI?
Or can I ignore this?




=====
--
S. Lott, CCP :-{)
S_LOTT@YAHOO.COM
http://www.mindspring.com/~slott1
Buccaneer #468: KaDiMa

Macintosh user: drinking upstream from the herd.

__________________________________________________
Do You Yahoo!?
Yahoo! Movies - coverage of the 74th Academy Awards
http://movies.yahoo.com/

From geert at boskant.nl  Sat Mar 23 18:57:30 2002
From: geert at boskant.nl (Geert Jansen)
Date: Fri Jan  9 22:03:06 2004
Subject: [mod_python] (no subject)
In-Reply-To: <20020323155314.50780.qmail@web9608.mail.yahoo.com>
Message-ID: <POEGJAKPNOCGNJMONMFKEEOLCDAA.geert@boskant.nl>

Hello Steven,

I got this error too and some searching with google indicated that this is
not a grave error. Only if mod_python used mod_ssl (mod_ssl uses the
"Extended API" or EAPI of Apache), there would be a problem.

BTW: recompiling with -DEAPI doesn't change one bit

Greet
--
long long email=0X78DC806B91FCA334,i=0,j; main(){j=(email>>4*i)&15;
putchar(j+j/2+j/5-j/12+(j<13?97:-65+7*j));i/15?exit(0):++i,main();}

> -----Original Message-----
> From: mod_python-admin@modpython.org
> [mailto:mod_python-admin@modpython.org]On Behalf Of Steven Lott
> Sent: Saturday, March 23, 2002 4:53 PM
> To: mod_python@modpython.org
> Subject: [mod_python] (no subject)
>
>
> Context:
> Server version: Apache/1.3.20 (Unix)  (Red-Hat/Linux)
> Python 2.2 (#2, Mar 23 2002, 07:48:23)
> Mod_python 2.7.6
>
> Did a rebuild of Python --without-threads
> Did a build of mod_python --with-apxs pointing to my apxs in
> /usr/sbin
>
> Start apache with /usr/sbin/httpd -dHAVE_PYTHON
>
> [Sat Mar 23 10:24:42 2002] [warn] Loaded DSO
> modules/mod_python.so uses plain Apache 1.3 API, this module
> might crash under EAPI! (please recompile it with -DEAPI)
>
> What do I change in the config to include -DEAPI?
> Or can I ignore this?
>
>
>
>
> =====
> --
> S. Lott, CCP :-{)
> S_LOTT@YAHOO.COM
> http://www.mindspring.com/~slott1
> Buccaneer #468: KaDiMa
>
> Macintosh user: drinking upstream from the herd.
>
> __________________________________________________
> Do You Yahoo!?
> Yahoo! Movies - coverage of the 74th Academy Awards.
> http://movies.yahoo.com/
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From bs at wasd.dk  Sun Mar 24 12:04:11 2002
From: bs at wasd.dk (Bjarke =?iso-8859-1?Q?S=F8rensen?=)
Date: Fri Jan  9 22:03:07 2004
Subject: [mod_python] -DEAPI
In-Reply-To: <POEGJAKPNOCGNJMONMFKEEOLCDAA.geert@boskant.nl>
References: <20020323155314.50780.qmail@web9608.mail.yahoo.com> <POEGJAKPNOCGNJMONMFKEEOLCDAA.geert@boskant.nl>
Message-ID: <20020324110411.GA3729@wasd.dk>

On Sat, Mar 23, 2002 at 06:57:30PM +0100, Geert Jansen wrote:
> Hello Steven,
> 
> I got this error too and some searching with google indicated that this is
> not a grave error. Only if mod_python used mod_ssl (mod_ssl uses the
> "Extended API" or EAPI of Apache), there would be a problem.
> 
> BTW: recompiling with -DEAPI doesn't change one bit

Where do you put it?


> > [Sat Mar 23 10:24:42 2002] [warn] Loaded DSO
> > modules/mod_python.so uses plain Apache 1.3 API, this module
> > might crash under EAPI! (please recompile it with -DEAPI)

As I see it, it's apxs that should be given the -DEAPI and you have to do that manually in Makefile.



> > What do I change in the config to include -DEAPI?
> > Or can I ignore this?


I would rather correct it, as it could kill apache threads.



/bs

bs@wasd.dk
http://wasd.dk/

From matt at proweb.co.uk  Tue Mar 26 12:53:06 2002
From: matt at proweb.co.uk (Matt H)
Date: Fri Jan  9 22:03:07 2004
Subject: [mod_python] Please deinstall & rebuild/reinstall Python withWITHOUT_THREADS set.
Message-ID: <20020326125306.4f93066c.matt@proweb.co.uk>

I'm doing a new install in FreeBSd 4.5
I'm getting 

Error: Python installation in /usr/local uses threads. mod_python requires
it to be built without threads. Please deinstall & rebuild/reinstall Python with
WITHOUT_THREADS set.

and yet here's partial output from the python install (blank lines for highlighting)

checking for --with-libs... no
checking for --with-signal-module... yes
checking for --with-dec-threads... no

checking for --with-threads... no

checking if --enable-ipv6 is specified... yes
checking if RFC2553 API is available... yes
checking ipv6 stack type... kame
using libc



oh what to do, I need to get my site back up again!

Matt

From matt at proweb.co.uk  Tue Mar 26 17:50:58 2002
From: matt at proweb.co.uk (Matt H)
Date: Fri Jan  9 22:03:07 2004
Subject: [mod_python] Please deinstall & rebuild  << FIXED
In-Reply-To: <200203261609.g2QG90f03946@lewis.abi.tconline.net>
References: <20020326125306.4f93066c.matt@proweb.co.uk>
	<200203261609.g2QG90f03946@lewis.abi.tconline.net>
Message-ID: <20020326175058.0148020b.matt@proweb.co.uk>

Predictably it was my own fault

Originally I installed from /usr/ports/www/mod_python

which lists python as a dependancy and then proceeds to build and install
it with threads

for the rebuild I hacked the Makefile for python and got it wrong

doh!

thanks to Bob & Lewis for taking the time to star tto help me

it was writing my reply that made me look again and find what I'd done


----

What I generally do is just compile an entirely separate version of 
python, i.e. in /usr/local/apache/python .. I use threaded python for 
everything else, so taking threads out globally isn't really an option 
for me.


I'd be interested to know how to do that

I tried moving /usr/local/lib/python2.2 without success

It would be great if someone could add a faq or howto on having the two
seperate python's installed. 

Dropping thread support kills py-curl for a start, 
I either need both or re-write my stuff that relies on py-curl

I'm definately in love with mod_python

m



From reitz at inworks.de  Tue Mar 26 18:58:42 2002
From: reitz at inworks.de (andre@orion)
Date: Fri Jan  9 22:03:07 2004
Subject: [mod_python] make install
References: <20020326125306.4f93066c.matt@proweb.co.uk><200203261609.g2QG90f03946@lewis.abi.tconline.net> <20020326175058.0148020b.matt@proweb.co.uk>
Message-ID: <018f01c1d4ef$ddc6a560$1900a8c0@venus>

Would it be possible to add a configure option with which python
installation the libs will be compiled / installed....


e.g.:
./configure --with-python-binary=/usr/local/bin/python2.2

The "make install" uses always the python which is found in $PATH.


P.S.: When will the next Release be released?

Greetings, Andre'


From grisha at modpython.org  Tue Mar 26 14:28:26 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:07 2004
Subject: [mod_python] Please deinstall & rebuild/reinstall Python
 withWITHOUT_THREADS set.
In-Reply-To: <20020326125306.4f93066c.matt@proweb.co.uk>
Message-ID: <Pine.BSF.4.32.0203261427560.23911-100000@localhost>

This is in the FAQ.

do "rm config.cache"

Grisha

On Tue, 26 Mar 2002, Matt H wrote:

>
> I'm doing a new install in FreeBSd 4.5
> I'm getting
>
> Error: Python installation in /usr/local uses threads. mod_python requires
> it to be built without threads. Please deinstall & rebuild/reinstall Python with
> WITHOUT_THREADS set.
>
> and yet here's partial output from the python install (blank lines for highlighting)
>
> checking for --with-libs... no
> checking for --with-signal-module... yes
> checking for --with-dec-threads... no
>
> checking for --with-threads... no
>
> checking if --enable-ipv6 is specified... yes
> checking if RFC2553 API is available... yes
> checking ipv6 stack type... kame
> using libc
>
>
>
> oh what to do, I need to get my site back up again!
>
> Matt
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From jasper at objectionable.org  Thu Mar 28 21:06:24 2002
From: jasper at objectionable.org (Jasper Hargreaves)
Date: Fri Jan  9 22:03:07 2004
Subject: [mod_python] invalid command 'PythonHandler'
Message-ID: <3CA385D0.7171.102CC2@localhost>

An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020328/90668ecc/attachment-0003.htm
From grisha at modpython.org  Thu Mar 28 16:36:21 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:07 2004
Subject: [mod_python] invalid command 'PythonHandler'
In-Reply-To: <3CA385D0.7171.102CC2@localhost>
Message-ID: <Pine.BSF.4.32.0203281634250.59245-100000@localhost>

If you're new to Apache, then check the config to make sure it doesn't
have a ClearModuleList directive. If it does, then following it there
should also be an AddModule mod_python.c line somewhere, else the module
is never activated by apache.

Grisha

On Thu, 28 Mar 2002, Jasper Hargreaves wrote:

> I've been trying to get Python scripts working with Apache under Windows.
>
> Running Apache 1.3.22 on Windows2000 Pro (ntfs partition), with
> Version  2.7.6 of ModPython, with Python 2.2 installed in the back, supported by Win32all v146
>
> From a completely clean install of Python & Apache, and following the documentation word for word given for "Windows
> Installation" on the documentation section of the site, it's not giving any joy, giving a
>
> "Invalid command 'PythonHandler', perhaps mis-spelled or defined by a module not included in the server configuration."
>
> when Apache tries to start. I'm new to configuring Apache - so I'm unsure if there's a particular "cgi" section of the
> httpd.conf, or if it's simply covered by the "alias" section.
>
> I've also set file extensions .py to be associated with Python, and added environment variable PYTHONPATH, and PATH to point to
> the python directory.
>
> Any advice?
>
> Many thanks,
> Jasper Hargreaves
> --------------------
> Jasper Hargreaves
> jasper@objectionable.org
> ICQ : 41235322; AIM : cloudyshai
> http://www.objectionable.org
> --------------------
> Information is not knowledge. Knowledge is not wisdom. Wisdom is not truth. Truth is not beauty. Beauty is not love. Love is not
> music. Music is the best. Wisdom is the domain of the Wiz, which is extinct.
> Beauty is a french phoenetic corruption of a short cloth neck ornament currently in resurgence.
>                 -Frank Zappa, "Packard Goose"
> ---------------------
> _______________________________________________ Mod_python mailing list Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From anburger76 at hotmail.com  Sat Mar 30 18:18:48 2002
From: anburger76 at hotmail.com (Tony Burger)
Date: Fri Jan  9 22:03:07 2004
Subject: [mod_python] "openpty" installation problem with Python 2.2.1c2
Message-ID: <F10mRBaYFkuutSgcOrB0000613d@hotmail.com>

An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020330/d7eb1e1c/attachment-0003.htm
From anburger76 at hotmail.com  Sat Mar 30 19:01:14 2002
From: anburger76 at hotmail.com (Tony Burger)
Date: Fri Jan  9 22:03:07 2004
Subject: [mod_python] fixed "openpty" problem with Python 2.2.1c2
Message-ID: <F176GgdKn3khQCaqSGB00019337@hotmail.com>

An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020330/6d58d96a/attachment-0003.htm
From anburger76 at hotmail.com  Sun Mar 31 23:18:27 2002
From: anburger76 at hotmail.com (Tony Burger)
Date: Fri Jan  9 22:03:07 2004
Subject: [mod_python] popen/popen2 usage?
Message-ID: <F68hGtK25DgRbwri5Dp00003dcd@hotmail.com>

An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020331/af96f458/attachment-0003.htm
From conrad at hep.caltech.edu  Sun Mar 31 20:40:27 2002
From: conrad at hep.caltech.edu (Conrad Steenberg)
Date: Fri Jan  9 22:03:07 2004
Subject: [mod_python] popen/popen2 usage?
In-Reply-To: <F68hGtK25DgRbwri5Dp00003dcd@hotmail.com>
References: <F68hGtK25DgRbwri5Dp00003dcd@hotmail.com>
Message-ID: <1017636029.9948.13.camel@Tafelberg.caltech.edu>

On Sun, 2002-03-31 at 20:18, Tony Burger wrote:
I am calling a C executable from within mod_python using the popen2
function imported from os.  I need to get standard output from the C
function and assign it to a mod_python variable which isn't working. The
C function does a basic (void)fprinf(stdout,"%s\n",myVar). I tested the
C function by writing to stderr instead and that works (logged fprintf
output to the Apache error_log). I just can't get any output. Might
anyone know how mod_python handles this function or what it might be
doing? Thanks.

Check whether the stdout of the forked process doesn't get written to
the browser in this case. You need to write to a different file
descriptor. From man popen:
"      Writing to such  a  stream
       writes to the standard input of the command; the command's
       standard output is the same as that of  the  process  that
       called  popen(),  unless  this  is  altered by the command
       itself."

Unless you wanted the child process' output written to the client
browser??

Otherwise doing a pipe() and then a fork() separately should work, e.g.:

  int my_pipe[2]

  pipe(my_pipe);
  child_pid=fork()

  switch (child_pid)
  {  case -1:
              perror ("Error: unable to fork");
              return 0;
              
     case 0: /* the child */
              close(my_pipe[0]); /* close the read end*/

             /* do an exec/execv etc. here */

     default: /* the parent */
              close(my_pipe[1]); /* close the write end */
  }

You may of course have more than one pipe if you want bi-directional
communication: just close the write end in the child and the read end in
the parent of the seconf pipe.

Cheers!

Conrad
_______________________________________________ Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python


