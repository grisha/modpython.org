<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] ValueError: Failed to acquire global mutex lock
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20ValueError%3A%20Failed%20to%20acquire%20global%20mutex%20lock&In-Reply-To=000a01c81631%247eb419c0%248201020a%40api104b4843840">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024372.html">
   <LINK REL="Next"  HREF="024374.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] ValueError: Failed to acquire global mutex lock</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20ValueError%3A%20Failed%20to%20acquire%20global%20mutex%20lock&In-Reply-To=000a01c81631%247eb419c0%248201020a%40api104b4843840"
       TITLE="[mod_python] ValueError: Failed to acquire global mutex lock">graham.dumpleton at gmail.com
       </A><BR>
    <I>Wed Oct 24 23:04:05 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="024372.html">[mod_python] Problems with Apache
</A></li>
        <LI>Next message: <A HREF="024374.html">[mod_python] Multiple Django Applications
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24373">[ date ]</a>
              <a href="thread.html#24373">[ thread ]</a>
              <a href="subject.html#24373">[ subject ]</a>
              <a href="author.html#24373">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Going by errors posted by someone else for other thread, seems that if
semaphores exhausted, error would occur at mod_python startup not when
locking the mutex.

I'll have to go back and read all your emails again. You said you were
using 'worker' MPM now didn't you. Your not using some strange MPM
like perchild or ITK-MPM are you. I know that these cause problems for
these mutexes in mod_python because of how different processes wanting
to lock the mutex run as different users.

Graham

On 24/10/2007, Michael Robokoff &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mike.robokoff at apioutsourcing.com</A>&gt; wrote:
&gt;<i> # ipcs
</I>&gt;<i> IPC status from &lt;running system&gt; as of Wed Oct 24 06:25:17 CDT 2007
</I>&gt;<i> T         ID      KEY        MODE        OWNER    GROUP
</I>&gt;<i> Message Queues:
</I>&gt;<i> Shared Memory:
</I>&gt;<i> Semaphores:
</I>&gt;<i> s          2   0          --ra-------      api    other
</I>&gt;<i>
</I>&gt;<i> Not sure how to read that.
</I>&gt;<i>
</I>&gt;<i> If the problem is the semaphores, Shouldn't I be able to use the following
</I>&gt;<i> set semsys:seminfo_semmni=2048
</I>&gt;<i> set semsys:seminfo_semmns=2048
</I>&gt;<i> set semsys:seminfo_semmnu=1024
</I>&gt;<i> set semsys:seminfo_semmsl=300
</I>&gt;<i> set semsys:seminfo_semopm=128
</I>&gt;<i> set semsys:seminfo_semume=64
</I>&gt;<i>
</I>&gt;<i> to make more semaphores available?
</I>&gt;<i>
</I>&gt;<i> I tried that but it didn't change anything, do you think that was not
</I>&gt;<i> enough?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --Mike
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -----Original Message-----
</I>&gt;<i> From: Graham Dumpleton [mailto:<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">graham.dumpleton at gmail.com</A>]
</I>&gt;<i> Sent: Tuesday, October 23, 2007 7:08 PM
</I>&gt;<i> To: Michael Robokoff
</I>&gt;<i> Cc: mod_python
</I>&gt;<i> Subject: Re: [mod_python] ValueError: Failed to acquire global mutex lock
</I>&gt;<i>
</I>&gt;<i> If you run 'ipcs' what is the output? Something must be using all the
</I>&gt;<i> semaphores, can't be anything else.
</I>&gt;<i>
</I>&gt;<i> Graham
</I>&gt;<i>
</I>&gt;<i> On 24/10/2007, Michael Robokoff &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mike.robokoff at apioutsourcing.com</A>&gt; wrote:
</I>&gt;<i> &gt; Ok the directive did take effect as the log entry below shows:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; [Tue Oct 23 07:20:32 2007] [notice] mod_python: Creating 4 session mutexes
</I>&gt;<i> &gt; based on 6 max processes and 25 max threads.
</I>&gt;<i> &gt; [Tue Oct 23 07:20:32 2007] [notice] mod_python: using mutex_directory /tmp
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Still see this however:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; ValueError: Failed to acquire global mutex lock
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I will try recompiling with the option you mentioned and see what happens.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; --Mike
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; -----Original Message-----
</I>&gt;<i> &gt; From: Graham Dumpleton [mailto:<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">graham.dumpleton at gmail.com</A>]
</I>&gt;<i> &gt; Sent: Tuesday, October 23, 2007 6:40 AM
</I>&gt;<i> &gt; To: Michael Robokoff
</I>&gt;<i> &gt; Cc: mod_python
</I>&gt;<i> &gt; Subject: Re: [mod_python] ValueError: Failed to acquire global mutex lock
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; On 23/10/2007, Michael Robokoff &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mike.robokoff at apioutsourcing.com</A>&gt; wrote:
</I>&gt;<i> &gt; &gt; [Thu Oct 18 07:37:38 2007] [notice] mod_python: Creating 8 session
</I>&gt;<i> mutexes
</I>&gt;<i> &gt; &gt; based on 6 max processes and 25 max threads.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; BTW, what did you end up setting mod_python.mutex_locks to? If you use
</I>&gt;<i> &gt; 4 like I said, then it can't have been in correct part of Apache
</I>&gt;<i> &gt; configuration, outside of all VirtualHost, as error log still shows '8
</I>&gt;<i> &gt; session mutexes'.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; if you can't get this to work, you might rebuild mod_python and
</I>&gt;<i> &gt; specific --with-max-locks=4 option to configure to force lower value
</I>&gt;<i> &gt; to be compiled in.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Graham
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I></PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024372.html">[mod_python] Problems with Apache
</A></li>
	<LI>Next message: <A HREF="024374.html">[mod_python] Multiple Django Applications
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24373">[ date ]</a>
              <a href="thread.html#24373">[ thread ]</a>
              <a href="subject.html#24373">[ subject ]</a>
              <a href="author.html#24373">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
