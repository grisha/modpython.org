<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Which handler? (WebDav AA system)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Which%20handler%3F%20%28WebDav%20AA%20system%29&In-Reply-To=28f0f01f0710080806i5e579e89t2ca55115b7d53e81%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024305.html">
   <LINK REL="Next"  HREF="024316.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Which handler? (WebDav AA system)</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Which%20handler%3F%20%28WebDav%20AA%20system%29&In-Reply-To=28f0f01f0710080806i5e579e89t2ca55115b7d53e81%40mail.gmail.com"
       TITLE="[mod_python] Which handler? (WebDav AA system)">graham.dumpleton at gmail.com
       </A><BR>
    <I>Tue Oct  9 05:40:50 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="024305.html">[mod_python] Which handler? (WebDav AA system)
</A></li>
        <LI>Next message: <A HREF="024316.html">[mod_python] Which handler? (WebDav AA system)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24311">[ date ]</a>
              <a href="thread.html#24311">[ thread ]</a>
              <a href="subject.html#24311">[ subject ]</a>
              <a href="author.html#24311">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 09/10/2007, Damjan Georgievski &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">gdamjan at gmail.com</A>&gt; wrote:
&gt;<i> I'm trying to build a simple handler that will multi-user WebDav
</I>&gt;<i> storage. Of course I intend to use the DAV support in Apache, and just
</I>&gt;<i> want to write a simple wrapper that will allow or deny access acording
</I>&gt;<i> to some criteria. It seemed to me that I'd that easyest with python
</I>&gt;<i> and mod_python.
</I>&gt;<i>
</I>&gt;<i> A bit of context.
</I>&gt;<i> WebDav uses several HTTP methods, but we can generally separate them
</I>&gt;<i> in two classes: GET&amp;HEAD are public, every other can be considered
</I>&gt;<i> restricted. My idea is that a user has full rw access to his own part
</I>&gt;<i> of DAV storage (for ex. '$DAVROOT/username'), everything stored there
</I>&gt;<i> is publically readable unless stored in the special folder
</I>&gt;<i> '$DAVROOT/username/private'.
</I>&gt;<i>
</I>&gt;<i> Now, the question is what handler to use.
</I>&gt;<i>
</I>&gt;<i> I tried the accesshandler, but it seems I can't return
</I>&gt;<i> HTTP_UNAUTHORIZED from it (it gets converted to FOBIDDEN somewhere).
</I>&gt;<i>
</I>&gt;<i> I tried authenhandler, but it needs peculiar setup in apache's
</I>&gt;<i> configuration, and it requires authorization no matter what.
</I>
You need to use a combination of authenhandler and authzhandler. It
isn't trivial to get right and to do it anything near properly needs
mod_python 3.3.1.

If your authenhandler determines that something is public, it can fake
that a user has logged in by setting req.user, req.ap_auth_type
appropriately and returning OK.

There are some examples that might get you started in the mailing list
archives searchable from the www.modpython.org site. Beyond that you
need to sketch out a bit better what your ideas are for doing it as
far as hooking into user databases and directive options for Require
that you might want to use. Depending on user database source, there
are possibly other modules for Apache available that could also be
used.

Graham

&gt;<i> I also tried PythonHandler (and SetHandler mod_pytohn) but the problem
</I>&gt;<i> is that it doesn't handle requests for methods other than the standard
</I>&gt;<i> GET, POST, etc. (it misses PROPFIND for ex.).
</I>&gt;<i>
</I>&gt;<i> I tried inithandler too, it seemed like it doesn't execute.
</I>&gt;<i>
</I>&gt;<i> So the question is, which handler I can use so that I can allow public
</I>&gt;<i> access in some cases, FORBID access in other casses, and ask for
</I>&gt;<i> authorization in third cases?
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i>
</I></PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024305.html">[mod_python] Which handler? (WebDav AA system)
</A></li>
	<LI>Next message: <A HREF="024316.html">[mod_python] Which handler? (WebDav AA system)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24311">[ date ]</a>
              <a href="thread.html#24311">[ thread ]</a>
              <a href="subject.html#24311">[ subject ]</a>
              <a href="author.html#24311">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
