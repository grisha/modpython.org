<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Trouble on OSX - Leopard
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Trouble%20on%20OSX%20-%20Leopard&In-Reply-To=95043BA8-0A7D-4F01-9879-D4607865D034%40mitchellfamily.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024389.html">
   <LINK REL="Next"  HREF="024391.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Trouble on OSX - Leopard</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Trouble%20on%20OSX%20-%20Leopard&In-Reply-To=95043BA8-0A7D-4F01-9879-D4607865D034%40mitchellfamily.com"
       TITLE="[mod_python] Trouble on OSX - Leopard">graham.dumpleton at gmail.com
       </A><BR>
    <I>Tue Oct 30 01:47:02 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="024389.html">[mod_python] Trouble on OSX - Leopard
</A></li>
        <LI>Next message: <A HREF="024391.html">[mod_python] Trouble on OSX - Leopard
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24390">[ date ]</a>
              <a href="thread.html#24390">[ thread ]</a>
              <a href="subject.html#24390">[ subject ]</a>
              <a href="author.html#24390">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The one with mod_wsgi looks like it isn't linking Python Framework any
more. So, keep also checking with otool -L as well to make sure Python
library dependency is there.

Let me know what you work out.

Graham

On 30/10/2007, Ben Mitchell &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">ben at mitchellfamily.com</A>&gt; wrote:
&gt;<i> Hrmmm...
</I>&gt;<i>
</I>&gt;<i> Not working.  I had to add the same flags to both CFLAGS and LDFLAGS to get
</I>&gt;<i> it to make a 64-bit version (not sure that was the right move).  But now I
</I>&gt;<i> get this:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> sh-3.2# file /usr/libexec/apache2/mod_python.so
</I>&gt;<i> /usr/libexec/apache2/mod_python.so: Mach-O 64-bit bundle
</I>&gt;<i> x86_64
</I>&gt;<i> sh-3.2# apachectl configtest
</I>&gt;<i> httpd: Syntax error on line 116 of
</I>&gt;<i> /private/etc/apache2/httpd.conf: Can't locate API module
</I>&gt;<i> structure `python_module' in file
</I>&gt;<i> /usr/libexec/apache2/mod_python.so: dlsym(0x1002179c0,
</I>&gt;<i> python_module): symbol not found
</I>&gt;<i>
</I>&gt;<i> Got something similar for mod_wsgi:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> sh-3.2# apachectl configtest
</I>&gt;<i> httpd: Syntax error on line 117 of
</I>&gt;<i> /private/etc/apache2/httpd.conf: Cannot load
</I>&gt;<i> /usr/libexec/apache2/mod_wsgi.so into server:
</I>&gt;<i> dlopen(/usr/libexec/apache2/mod_wsgi.so, 10): Symbol not
</I>&gt;<i> found: _PyExc_RuntimeError\n  Referenced from:
</I>&gt;<i> /usr/libexec/apache2/mod_wsgi.so\n  Expected in: dynamic
</I>&gt;<i> lookup\n
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Anyway, I don't want to consume your evening with this :-)  I'll keep
</I>&gt;<i> plugging away at it.  I really appreciate the help.  I think I'm at least on
</I>&gt;<i> the right track now.
</I>&gt;<i>
</I>&gt;<i> -Ben
</I>&gt;<i>
</I>&gt;<i> On Oct 29, 2007, at 10:23 PM, Graham Dumpleton wrote:
</I>&gt;<i> Try editing Makefile and adding option to CFLAGS:
</I>&gt;<i>
</I>&gt;<i>   CFLAGS = -Wc,-m64
</I>&gt;<i>
</I>&gt;<i> At least I think that -m64 is the option. The -Wc, bit is to get it
</I>&gt;<i> past apxs/libtool build tool.
</I>&gt;<i>
</I>&gt;<i> Graham
</I>&gt;<i>
</I>&gt;<i> On 30/10/2007, Ben Mitchell &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">ben at mitchellfamily.com</A>&gt; wrote:
</I>&gt;<i> You're on the right track, but off by a hair ;-)
</I>&gt;<i>
</I>&gt;<i> Turns out httpd is an Intel (64 bit) process
</I>&gt;<i>
</I>&gt;<i> Sooo...  I need to figure out how to get a 64-bit version of the .so
</I>&gt;<i> built, when it's building only the 32-bit version by default.
</I>&gt;<i>
</I>&gt;<i> Any thoughts on that?
</I>&gt;<i>
</I>&gt;<i> And thanks.  I _never_ would've figured this one out on my own.
</I>&gt;<i>
</I>&gt;<i> -Ben
</I>&gt;<i>
</I>&gt;<i> On Oct 29, 2007, at 10:05 PM, Graham Dumpleton wrote:
</I>&gt;<i>
</I>&gt;<i> Okay, might now what the issue is now.
</I>&gt;<i>
</I>&gt;<i> What may be happening is that Apache server is running up in Rosetta
</I>&gt;<i> (ie., PPC), and because the mod_wsgi/mod_python .so files are Intel
</I>&gt;<i> only it isn't working.
</I>&gt;<i>
</I>&gt;<i> First step is to determine what Apache is running as. Think you can do
</I>&gt;<i> this by running 'Activity Viewer' or whatever they now call it. Ensure
</I>&gt;<i> that 'Kind' column is viewable and see what is against httpd
</I>&gt;<i> processes. Will be PowerPC or Intel. If it shows PowerPC, that will be
</I>&gt;<i> the problem.
</I>&gt;<i>
</I>&gt;<i> To fix I think you run Finder, select Go-&gt;Go To Folder and enter
</I>&gt;<i> '/usr/sbin'. Then find 'httpd' and go File-&gt;GetInfo. From memory in
</I>&gt;<i> there somewhere is a way of marking the process to run as Intel rather
</I>&gt;<i> than PowerPC.
</I>&gt;<i>
</I>&gt;<i> The question is that if this is necessary, why it is running as
</I>&gt;<i> PowerPC by default.
</I>&gt;<i>
</I>&gt;<i> Graham
</I>&gt;<i>
</I>&gt;<i> On 30/10/2007, Ben Mitchell &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">ben at mitchellfamily.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;<i> Sorry.  Missed what you were asking for.  Looks like most of them
</I>&gt;<i>
</I>&gt;<i> have all
</I>&gt;<i>
</I>&gt;<i> the architectures, but the Mach-O bundle i386 seems to be the same
</I>&gt;<i>
</I>&gt;<i> for the
</I>&gt;<i>
</I>&gt;<i> wsgi one and the others.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> [Macintosh:~/Documents/Development] benha% file
</I>&gt;<i>
</I>&gt;<i> /usr/libexec/apache2/*.so
</I>&gt;<i>
</I>&gt;<i> /usr/libexec/apache2/libphp5.so:             Mach-O
</I>&gt;<i>
</I>&gt;<i> universal binary with 4 architectures
</I>&gt;<i>
</I>&gt;<i> /usr/libexec/apache2/libphp5.so (for architecture ppc7400): Mach-O
</I>&gt;<i>
</I>&gt;<i> bundle
</I>&gt;<i>
</I>&gt;<i> ppc
</I>&gt;<i>
</I>&gt;<i> /usr/libexec/apache2/libphp5.so (for architecture ppc64): Mach-O 64-
</I>&gt;<i>
</I>&gt;<i> bit
</I>&gt;<i>
</I>&gt;<i> bundle ppc64
</I>&gt;<i>
</I>&gt;<i> /usr/libexec/apache2/libphp5.so (for architecture i386): Mach-O
</I>&gt;<i>
</I>&gt;<i> bundle i386
</I>&gt;<i>
</I>&gt;<i> /usr/libexec/apache2/libphp5.so (for architecture x86_64): Mach-O 64-
</I>&gt;<i>
</I>&gt;<i> bit
</I>&gt;<i>
</I>&gt;<i> bundle x86_64
</I>&gt;<i>
</I>&gt;<i> /usr/libexec/apache2/mod_actions.so:         Mach-O
</I>&gt;<i>
</I>&gt;<i> universal binary with 4 architectures
</I>&gt;<i>
</I>&gt;<i> /usr/libexec/apache2/mod_actions.so (for architecture
</I>&gt;<i>
</I>&gt;<i> ppc7400): Mach-O bundle ppc
</I>&gt;<i>
</I>&gt;<i> /usr/libexec/apache2/mod_actions.so (for architecture
</I>&gt;<i>
</I>&gt;<i> ppc64): Mach-O 64-bit bundle ppc64
</I>&gt;<i>
</I>&gt;<i> /usr/libexec/apache2/mod_actions.so (for architecture
</I>&gt;<i>
</I>&gt;<i> i386): Mach-O bundle i386
</I>&gt;<i>
</I>&gt;<i> /usr/libexec/apache2/mod_actions.so (for architecture
</I>&gt;<i>
</I>&gt;<i> x86_64): Mach-O 64-bit bundle x86_64
</I>&gt;<i>
</I>&gt;<i> ...
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Oct 29, 2007, at 9:47 PM, Graham Dumpleton wrote:
</I>&gt;<i>
</I>&gt;<i> Was there no other .so files besides mod_wsgi.so in:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  /usr/libexec/apache2
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Was wanting to see what 'file' yielded on other .so files in that
</I>&gt;<i>
</I>&gt;<i> directory.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> if there is no other .so files, would suggest that they are static
</I>&gt;<i>
</I>&gt;<i> linking core Apache modules, which they haven't done in the past.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Anyway, I will bring it all up on Apache modules-dev list in case
</I>&gt;<i>
</I>&gt;<i> others have heard about such issues.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Graham
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On 30/10/2007, Ben Mitchell &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">ben at mitchellfamily.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Looks ok to me, though we're way out of my depth at this point :-)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> [Macintosh:~/Documents/Development] benha% file
</I>&gt;<i>
</I>&gt;<i> /usr/sbin/httpd
</I>&gt;<i>
</I>&gt;<i> /usr/sbin/httpd: Mach-O universal binary with 4 architectures
</I>&gt;<i>
</I>&gt;<i> /usr/sbin/httpd (for architecture ppc7400): Mach-O executable ppc
</I>&gt;<i>
</I>&gt;<i> /usr/sbin/httpd (for architecture ppc64): Mach-O 64-bit executable
</I>&gt;<i>
</I>&gt;<i> ppc64
</I>&gt;<i>
</I>&gt;<i> /usr/sbin/httpd (for architecture i386): Mach-O executable i386
</I>&gt;<i>
</I>&gt;<i> /usr/sbin/httpd (for architecture x86_64): Mach-O 64-bit executable
</I>&gt;<i>
</I>&gt;<i> x86_64
</I>&gt;<i>
</I>&gt;<i> [Macintosh:~/Documents/Development] benha% file
</I>&gt;<i>
</I>&gt;<i> /usr/libexec/apache2/mod_wsgi.so
</I>&gt;<i>
</I>&gt;<i> /usr/libexec/apache2/mod_wsgi.so: Mach-O bundle i386
</I>&gt;<i>
</I>&gt;<i> [Macintosh:~/Documents/Development] benha%
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Oct 29, 2007, at 9:35 PM, Graham Dumpleton wrote:
</I>&gt;<i>
</I>&gt;<i> One more and then I will have exhausted my ideas and may have to
</I>&gt;<i>
</I>&gt;<i> research elsewhere.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  file /usr/sbin/httpd
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Change path if this isn't what Apache server executable is called.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  file /usr/libexec/apache2/*.so
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> This is to see what other Apache and other modules are compiled as.
</I>&gt;<i>
</I>&gt;<i> Ie., Intel only or dual architecture etc.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Graham
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On 30/10/2007, Ben Mitchell &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">ben at mitchellfamily.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> [Macintosh:local/src/PyGreSQL-3.8.1] benha% otool -L
</I>&gt;<i>
</I>&gt;<i> /usr/libexec/apache2/mod_wsgi.so
</I>&gt;<i>
</I>&gt;<i> /usr/libexec/apache2/mod_wsgi.so:
</I>&gt;<i>
</I>&gt;<i> /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current
</I>&gt;<i>
</I>&gt;<i> version
</I>&gt;<i>
</I>&gt;<i> 111.0.0)
</I>&gt;<i>
</I>&gt;<i> /Library/Frameworks/Python.framework/Versions/2.5/Python
</I>&gt;<i>
</I>&gt;<i> (compatibility version 2.5.0, current version 2.5.0)
</I>&gt;<i>
</I>&gt;<i> /usr/lib/libgcc_s.1.dylib (compatibility version 1.0.0, current
</I>&gt;<i>
</I>&gt;<i> version
</I>&gt;<i>
</I>&gt;<i> 1.0.0)
</I>&gt;<i>
</I>&gt;<i> [Macintosh:local/src/PyGreSQL-3.8.1] benha%
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Oct 29, 2007, at 9:18 PM, Graham Dumpleton wrote:
</I>&gt;<i>
</I>&gt;<i> How about:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  otool -L /usr/libexec/apache2/mod_wsgi.so
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Should refer to standard Python framework.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Graham
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On 30/10/2007, Ben Mitchell &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">ben at mitchellfamily.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I started off yesterday doing an &quot;Upgrade.&quot;  But I found enough
</I>&gt;<i>
</I>&gt;<i> weirdness
</I>&gt;<i>
</I>&gt;<i> that I did an &quot;Archive and Install&quot; tonight.  It's an intel MacBook
</I>&gt;<i>
</I>&gt;<i> Pro.
</I>&gt;<i>
</I>&gt;<i> ...
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> [Message clipped]
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I></PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024389.html">[mod_python] Trouble on OSX - Leopard
</A></li>
	<LI>Next message: <A HREF="024391.html">[mod_python] Trouble on OSX - Leopard
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24390">[ date ]</a>
              <a href="thread.html#24390">[ thread ]</a>
              <a href="subject.html#24390">[ subject ]</a>
              <a href="author.html#24390">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
