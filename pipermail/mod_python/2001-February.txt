From brett at bookshop.unsw.edu.au  Thu Feb  1 14:36:05 2001
From: brett at bookshop.unsw.edu.au (Brett Haydon)
Date: Fri Jan  9 21:46:10 2004
Subject: [mod_python] modpublisher security model
Message-ID: <NCBBKMABOKFCDLPIKKGIMEHGCJAA.brett@bookshop.unsw.edu.au>

Evidently Zope currently uses the doc string to 
explicity allow access to functions via URL.

The new Python 2.1 will allow functions to have
attributes.

I am currently renaming all imported modules with
an underscore to avoid unintentional security problems
(and global objects)
but I like the idea of explicitly allowing access.

Any plans to move in this direction.

regards,
______________________________________________
Brett Haydon


From x at vex.net  Tue Feb  6 13:59:21 2001
From: x at vex.net (T. Muddletin)
Date: Fri Jan  9 21:46:11 2004
Subject: [mod_python] math import
Message-ID: <158300828588.20010206135921@vex.net>

I'm playing with netbsd 1.5/apache 1.3.17/python 2.0/mod_python 2.7.1
(DSO).

Using the cgihandler... when i try to import the standard python math
module i get...

PythonHandler mod_python.cgihandler: Traceback (most recent call last):
PythonHandler mod_python.cgihandler:   File "/usr/pkg/lib/python2.0/site-packages/mod_python/apache.py", line 189, in Dispatch
    result = object(self.req)
PythonHandler mod_python.cgihandler:   File "/usr/pkg/lib/python2.0/site-packages/mod_python/cgihandler.py", line 122, in handler
    imp.load_module(module_name, fd, path, desc)
PythonHandler mod_python.cgihandler:   File "/usr/home/x/public_html/test.py", line 21, in ?
    import math
PythonHandler mod_python.cgihandler: ImportError: error in dynamic linking

Is this a DSO issue? I hope not, because i haven't been able to get
apache to static compile with the mod yet either...

-- 
Tim Middleton | Cain Gang Ltd | There are a thousand hacking at the branches
x@veX.net     | www.Vex.Net   | of evil [but who] at the root. --Thoreau (W)



From brent at rcfile.org  Wed Feb  7 08:59:53 2001
From: brent at rcfile.org (Brent Verner)
Date: Fri Jan  9 21:46:11 2004
Subject: [mod_python] [RFC] mod_python embedded python module
Message-ID: <20010207085953.B4193@rcfile.org>

Hi,
  
  First off, Gregory, thanks for writing this nice software :)

  Secondly, after looking into mod_python and mod_snake, I've 
decided that _I_ like mod_python (the base python/apache binding)
much better than mod_snake. Now, I'm not a python programmer, but
there's no better way to learn than to do, so last night I started
hacking up a module/handler to handle documents having embedded
HTML, the feature which drew me toward mod_snake at first.

  What I intend to do with this module is have it:
    1) parse (so to speak) a document containing HTML-embedded python
       code into pure python code. My tentative direction is to:
        a) create a python file that looks like
========================================================
env = {}
def embedded_output_hook(req):
  env = req.subprocess_env
  req.write("""<html>
<head>
<title>"""
  req.write( req.uri )
  req.write("""</title>
</head>
<body>
"""
  for i in env.keys():
    req.write("""<b>""")
    req.write( i )
    req.write(""": """)
    req.write( env[i] )
    req.write("""</b><br>
""")
  # for
  req.write("""</body
</html>
""")

========================================================
from an HTML-embedded file of:
========================================================
<html>
<head>
<title><?= req.uri ?></title>
</head>
<body>
<?
  for i in env.keys():
?>
<b><?= i ?>: <?= env[i] ?></b><br>
<?
  # for
?>
</body>
</html>
========================================================

       and the module will call embedded_output_hook(req) from 
       the loaded module. Also, I've thought of having calls to
       content_type/auth/cleanup functions which may be defined in
       the document...
    2) save those parsed files to a cache directory, where they'll
       actually be loaded from when the correspondeing HTML-embedded
       file is requested via the handler. Of course I'm stat()ing
       the files to make sure the parsed/cached file is up to date.

That is all fairly simple, from the overview, but I do have a few 
questions before I go too far down the wrong road :):
  1) is this approach sane, or is there a more elegant/efficient
     way to handle this?
  2) To create the pure-python file from the embedded document, I'm
     pretty sure some restrictions will have to be made on the
     location/designation of functions. What is a reasonable set
     of restrictions that can/should be placed on this so the module
     doesn't become a major-hack-of-a-buncha-special-cases :)
  3) I'm using load_module(...) to load the pure-python files. Is
     there any way (a different one?) that will allow the loaded
     module to access globals from the module's environment, i.e.,
     database connections, et. al.
  4) Is there any way to have multile 'AddHandler' types in the same 
     config section? If not, will you accept clean patches to do so?


comments and discussion are requested. I'm going to do this, I just
want to make sure I do something that is maximally useful :) I'll
not be resonding to this thread until the weekend, cause I've got
some real (non-python :() work that _must_ get done to free up my
weekend to get on with this hack.

thanks.
  brent

-- 
"We want to help, but we wouldn't want to deprive you of a valuable 
learning experience."
                                          http://openbsd.org/mail.html

From jmcbray at carcosa.net  Wed Feb  7 14:19:28 2001
From: jmcbray at carcosa.net (Jason F. McBrayer)
Date: Fri Jan  9 21:46:11 2004
Subject: [mod_python] [RFC] mod_python embedded python module
In-Reply-To: <20010207085953.B4193@rcfile.org>; from brent@rcfile.org on Wed, Feb 07, 2001 at 08:59:53AM -0500
References: <20010207085953.B4193@rcfile.org>
Message-ID: <20010207141928.B19360@bertrand.carcosa.net>

On Wed, Feb 07, 2001 at 08:59:53AM -0500, Brent Verner wrote:

>   Secondly, after looking into mod_python and mod_snake, I've 
> decided that _I_ like mod_python (the base python/apache binding)
> much better than mod_snake. Now, I'm not a python programmer, but
> there's no better way to learn than to do, so last night I started
> hacking up a module/handler to handle documents having embedded
> HTML, the feature which drew me toward mod_snake at first.

You might also take a look at PMZ (Poor Man's Zope,
pmz.sourceforge.net), which already does this very well.  I did some
work to make it usable as a mod_python module, but I think the
original author has also done so in parallel.  In any case, it's not
too hard to do -- just get PMZ and work on wrapping it in a handler
function, redirecting IO appropriately.

-- 
+----------------------------------------------------------------+
| Jason F. McBrayer                         jmcbray@carcosa.net  |
| The scalloped tatters of the King in Yellow must hide Yhtill   |
| forever.                    R.W. Chambers _The King in Yellow_ |

From miguel at yorku.ca  Wed Feb  7 14:35:45 2001
From: miguel at yorku.ca (Miguel Marques)
Date: Fri Jan  9 21:46:11 2004
Subject: [mod_python] [RFC] mod_python embedded python module
In-Reply-To: <20010207141928.B19360@bertrand.carcosa.net>
References: <20010207085953.B4193@rcfile.org>
	<20010207141928.B19360@bertrand.carcosa.net>
Message-ID: <20010207143545G.miguel@yorku.ca>

Greetings...
On Wed, 7 Feb 2001 14:19:28 -0500, "Jason F. McBrayer" <jmcbray@carcosa.net> wrote:
> On Wed, Feb 07, 2001 at 08:59:53AM -0500, Brent Verner wrote:
> 
> >   Secondly, after looking into mod_python and mod_snake, I've 
> > decided that _I_ like mod_python (the base python/apache binding)
> > much better than mod_snake. Now, I'm not a python programmer, but
> > there's no better way to learn than to do, so last night I started
> > hacking up a module/handler to handle documents having embedded
> > HTML, the feature which drew me toward mod_snake at first.
> 
> You might also take a look at PMZ (Poor Man's Zope,
> pmz.sourceforge.net), which already does this very well.  I did some
> work to make it usable as a mod_python module, but I think the
> original author has also done so in parallel.  In any case, it's not
> too hard to do -- just get PMZ and work on wrapping it in a handler
> function, redirecting IO appropriately.
> 
Another option is getting Zope and extracting DocumentTemplate and
using it.  It allows you to easily insert data from python objects 
into html templates and it has some very nice helper functions you can
use in your templates.

I've several web applications using mod_python and DocumentTemplate
and they work rather nicely.  I believe PMZ offers similar functionality
but you may want to look at DocumentTemplate and see which you like better.

							Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830


From grisha at verio.net  Sat Feb 10 21:26:12 2001
From: grisha at verio.net (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:11 2004
Subject: [mod_python] 2.7.2
Message-ID: <Pine.BSF.4.32.0102102124360.22089-100000@localhost>

2.7.2 is available for download.

If you are using the publisher handler, you should upgrade, since 2.7.2
fixes the issue with being able access standard library modules from the
web. It also adds some new authentication features to the publisher
handler.

Grisha


From daniel at copyleft.no  Sun Feb 11 16:16:23 2001
From: daniel at copyleft.no (Hr. Daniel Mikkelsen)
Date: Fri Jan  9 21:46:11 2004
Subject: [mod_python] File uploads.
Message-ID: <Pine.LNX.4.31.0102111613590.27696-100000@unity.copyleft.no>

Hi.

Does anyone have any example code for accepting file uploads with
mod_python? I understand one uses req.read() to get the POSTed data
as usual, and then one parses th query-string in a particular
manner.

Thanks in advance!

-- Daniel Mikkelsen, Copyleft Software AS



From teep at inet.co.th  Mon Feb 12 15:28:03 2001
From: teep at inet.co.th (Prateep Siamwalla)
Date: Fri Jan  9 21:46:11 2004
Subject: [mod_python] Regarding 2.7.2 on windows
Message-ID: <002401c094cd$bb3086a0$0c05a8c0@taramansion.bangkok>

Hi All,

I have been using 2.7.1 on windows for a couple of weeks now [ many thanks
to Enrique Vaamonde for the excellent installation instructions ], and its
been quite a ride.  I'm eager to download the new 2.7.2 which was recently
uploaded.

Question :
Since I'm running compiler impared windows box, will I need to wait for a
new mod_python.dll to be uploaded before installing mod_python 2.7.2?  Or
are the new changes made only to the python files in python20\lib\mod_python
?

Thanks in advance
teep



From jd at pdx.edu  Mon Feb 12 15:19:47 2001
From: jd at pdx.edu (jd@pdx.edu)
Date: Fri Jan  9 21:46:11 2004
Subject: [mod_python] Mod_Python and Solaris Compile Problems
Message-ID: <982019987.3a886f93b61d1@webmail.pdx.edu>

Hi!  I'm trying to install mod_python on my Solaris server and I keep getting
comple problems.  I'm using Apache 1.3.14, PHP 4.0.2pl1, and Mod_Python 2.7.2.  

Here's what happens when I try to compile Apache with the Static Mod_Python (it
also fails on compiling the DSO, see below):

<=== src/modules/python
<=== src/modules
gcc -c  -I./os/unix -I./include   -DSOLARIS2=280 -I/usr/share/src/php-4.0.4pl1
-I/usr/share/src/php-4.0.4pl1/main -I/usr/share/src/php-4.0.4pl1/main
-I/usr/share/src/php-4.0.4pl1/Zend -I/usr/share/src/php-4.0.4pl1/Zend
-I/usr/share/src/php-4.0.4pl1/TSRM -I/usr/share/src/php-4.0.4pl1/TSRM
-I/usr/share/src/php-4.0.4pl1 -DUSE_EXPAT -I./lib/expat-lite `./apaci` modules.c
gcc -c  -I./os/unix -I./include   -DSOLARIS2=280 -I/usr/share/src/php-4.0.4pl1
-I/usr/share/src/php-4.0.4pl1/main -I/usr/share/src/php-4.0.4pl1/main
-I/usr/share/src/php-4.0.4pl1/Zend -I/usr/share/src/php-4.0.4pl1/Zend
-I/usr/share/src/php-4.0.4pl1/TSRM -I/usr/share/src/php-4.0.4pl1/TSRM
-I/usr/share/src/php-4.0.4pl1 -DUSE_EXPAT -I./lib/expat-lite `./apaci`
buildmark.c
gcc  -DSOLARIS2=280 -I/usr/share/src/php-4.0.4pl1
-I/usr/share/src/php-4.0.4pl1/main -I/usr/share/src/php-4.0.4pl1/main
-I/usr/share/src/php-4.0.4pl1/Zend -I/usr/share/src/php-4.0.4pl1/Zend
-I/usr/share/src/php-4.0.4pl1/TSRM -I/usr/share/src/php-4.0.4pl1/TSRM
-I/usr/share/src/php-4.0.4pl1 -DUSE_EXPAT -I./lib/expat-lite `./apaci`    \
      -o httpd buildmark.o modules.o  modules/php4/libphp4.a 
modules/python/libpython.a  modules/standard/libstandard.a  main/libmain.a 
./os/unix/libos.a  ap/libap.a  lib/expat-lite/libexpat.a  -R/usr/ucblib
-R/usr/local/lib/gcc-lib/sparc-sun-solaris2.8/2.95.2  -L/usr/ucblib
-L/usr/local/lib/gcc-lib/sparc-sun-solaris2.8/2.95.2 -Lmodules/php4
-L../modules/php4 -L../../modules/php4 -lmodphp4  -lpam  -ldl -lresolv -lresolv
-lm -ldl -lcrypt -lnsl -lsocket  -lsocket -lgcc   -lsocket -lnsl -ldl
Undefined                       first referenced
 symbol                             in file
PySequence_Index                    modules/python/libpython.a(mod_python.o)
Py_InitModule4                      modules/python/libpython.a(_apachemodule.o)
PyString_FromStringAndSize          modules/python/libpython.a(_apachemodule.o)
PyExc_TypeError                     modules/python/libpython.a(tableobject.o)
PyEval_RestoreThread                modules/python/libpython.a(mod_python.o)
PyCallable_Check                    modules/python/libpython.a(requestobject.o)
PyErr_BadArgument                   modules/python/libpython.a(_apachemodule.o)
Py_Finalize                         modules/python/libpython.a(mod_python.o)
Py_NewInterpreter                   modules/python/libpython.a(mod_python.o)
PyErr_Print                         modules/python/libpython.a(mod_python.o)
PyExc_IndexError                    modules/python/libpython.a(requestobject.o)
PyMember_Set                        modules/python/libpython.a(requestobject.o)
Py_FindMethod                       modules/python/libpython.a(requestobject.o)
PyExc_IOError                       modules/python/libpython.a(requestobject.o)
PyString_FromString                 modules/python/libpython.a(mod_python.o)
PyThreadState_Swap                  modules/python/libpython.a(mod_python.o)
PyType_Type                         modules/python/libpython.a(_apachemodule.o)
Py_BuildValue                       modules/python/libpython.a(_apachemodule.o)
PyErr_Occurred                      modules/python/libpython.a(mod_python.o)
PyString_AsString                   modules/python/libpython.a(mod_python.o)
PyList_SetItem                      modules/python/libpython.a(tableobject.o)
PyModule_GetDict                    modules/python/libpython.a(_apachemodule.o)
PyObject_CallMethod                 modules/python/libpython.a(mod_python.o)
PyList_Append                       modules/python/libpython.a(_apachemodule.o)
Py_IsInitialized                    modules/python/libpython.a(mod_python.o)
PyInt_Type                          modules/python/libpython.a(mod_python.o)
_Py_NoneStruct                      modules/python/libpython.a(_apachemodule.o)
PyExc_AttributeError                modules/python/libpython.a(requestobject.o)
PyObject_Str                        modules/python/libpython.a(mod_python.o)
PyArg_ParseTuple                    modules/python/libpython.a(_apachemodule.o)
PyExc_ValueError                    modules/python/libpython.a(requestobject.o)
PyErr_SetString                     modules/python/libpython.a(requestobject.o)
PyList_SetSlice                     modules/python/libpython.a(mod_python.o)
PyTuple_New                         modules/python/libpython.a(util.o)
PyEval_SaveThread                   modules/python/libpython.a(mod_python.o)
PyDict_SetItemString                modules/python/libpython.a(mod_python.o)
PyObject_HasAttrString              modules/python/libpython.a(serverobject.o)
PyDict_GetItem                      modules/python/libpython.a(_apachemodule.o)
PyMapping_HasKeyString              modules/python/libpython.a(_apachemodule.o)
PyCObject_FromVoidPtr               modules/python/libpython.a(mod_python.o)
PyString_ConcatAndDel               modules/python/libpython.a(tableobject.o)
PyErr_NewException                  modules/python/libpython.a(_apachemodule.o)
PyObject_GetAttrString              modules/python/libpython.a(mod_python.o)
PyList_New                          modules/python/libpython.a(_apachemodule.o)
Py_OptimizeFlag                     modules/python/libpython.a(mod_python.o)
PyDict_SetItem                      modules/python/libpython.a(_apachemodule.o)
PyExc_KeyError                      modules/python/libpython.a(tableobject.o)
PyDict_New                          modules/python/libpython.a(mod_python.o)
PyTuple_SetItem                     modules/python/libpython.a(util.o)
PyThreadState_New                   modules/python/libpython.a(mod_python.o)
PyErr_Clear                         modules/python/libpython.a(requestobject.o)
Py_GetVersion                       modules/python/libpython.a(mod_python.o)
PyMember_Get                        modules/python/libpython.a(requestobject.o)
PyInt_FromLong                      modules/python/libpython.a(requestobject.o)
PyDict_GetItemString                modules/python/libpython.a(mod_python.o)
PyCObject_AsVoidPtr                 modules/python/libpython.a(mod_python.o)
PyErr_NoMemory                      modules/python/libpython.a(requestobject.o)
PyInt_AsLong                        modules/python/libpython.a(mod_python.o)
PyList_Size                         modules/python/libpython.a(_apachemodule.o)
PyImport_ImportModule               modules/python/libpython.a(mod_python.o)
PyObject_CallFunction               modules/python/libpython.a(mod_python.o)
PyErr_Fetch                         modules/python/libpython.a(mod_python.o)
PyThreadState_Delete                modules/python/libpython.a(mod_python.o)
_PyString_Resize                    modules/python/libpython.a(_apachemodule.o)
Py_Initialize                       modules/python/libpython.a(mod_python.o)
PyErr_SetObject                     modules/python/libpython.a(requestobject.o)
PyString_Type                       modules/python/libpython.a(tableobject.o)
ld: fatal: Symbol referencing errors. No output written to httpd
collect2: ld returned 1 exit status
*** Error code 1
make: Fatal error: Command failed for target `target_static'
Current working directory /usr/share/src/apache_1.3.14/src
*** Error code 1
make: Fatal error: Command failed for target `build-std'
Current working directory /usr/share/src/apache_1.3.14
*** Error code 1
make: Fatal error: Command failed for target `build'


*** So I tried to install the DSO version, hoping that would be my hero.  But
this is what I get when compiling Mod_Python with the DSO support:


Compiling for DSO. For static, do "make static"

/usr/local/apachePHP/bin/apxs -I/usr/share/src/mod_python-2.7.2/src/include
-I/usr/local/apachePHP/include -I/usr/local/include/python1.5 -c mod_python.o 
_apachemodule.o  requestobject.o  tableobject.o  util.o  serverobject.o 
connobject.o -lm  /usr/local/lib/python1.5/config/libpython1.5.a   -lsocket
-lnsl -ldl    -lm
  -o mod_python.so mod_python.o _apachemodule.o requestobject.o tableobject.o
util.o serverobject.o connobject.o -lm
/usr/local/lib/python1.5/config/libpython1.5.a -lsocket -lnsl -ldl -lm 
apxs:Break: Command failed with rc=255
*** Error code 1
make: Fatal error: Command failed for target `mod_python.so'
Current working directory /usr/share/src/mod_python-2.7.2/src
*** Error code 1
make: Fatal error: Command failed for target `do_dso'

Please Help me!  I will give you any additional information that you request.  I
really want to use this module in Solaris!!!  Thanks in advance!

From joost.damad at siemens.atea.be  Thu Feb 15 15:07:34 2001
From: joost.damad at siemens.atea.be (Joost Yervante Damad)
Date: Fri Jan  9 21:46:11 2004
Subject: [mod_python] some issues
Message-ID: <20010215150733.A20391@siemens.atea.be>

Hello,

A friend of me discovered wierd bug in publisher :

def tst(req, arg='none', test='none', longname='none'):
        req._content_type_set = 0
        return "Arguments are '%s', '%s' and '%s'" % (arg, test, longname)

if we now do:

https://r2d2.iplab.atea.be:8081/py/test.py/tst?arg=x&test=y&longname=z

the result is:

Arguments are '', '' and 'z'

Aparently short names are not getting into the functions.
Long names are. Or is this caused by name clashes?

We tested this both with 2.7.1 and 2.7.2 on Solaris 2.6
with apache 1.3.14 with SSL and mod_python statically linked.

Another error I found:

The handling of _content_type_set seems to be broken.

publisher no longer functioned, bailin out at:

if not req._content_type_set:

giving an exeception stating that that variable was not found.

Removing that part and setting the content_type to
"text/html" is our current workaround.

Any thoughts?

Joost

P.S.: but we love mod_python :)

-- 
Joost Damad - Siemens ICN D NC A - +3214252297
--
Five is a sufficiently close approximation to infinity.
       -- Robert Firth
"One, two, five."
       -- Monty Python and the Holy Grail

From joost.damad at siemens.atea.be  Thu Feb 15 15:17:26 2001
From: joost.damad at siemens.atea.be (Joost Yervante Damad)
Date: Fri Jan  9 21:46:11 2004
Subject: [mod_python] Re: Mod_Python and Solaris Compile Problems
Message-ID: <20010215151726.A21817@siemens.atea.be>

I added a non-multithreaded libpython.a
to the directory of mod_python and
hacked the Makefile to force it to staticaly
link in that one.

Worked fine for me.

Joost

-- 
Joost Damad - Siemens ICN D NC A - +3214252297
--
Five is a sufficiently close approximation to infinity.
       -- Robert Firth
"One, two, five."
       -- Monty Python and the Holy Grail

From Zhu.James at iac.com.tw  Fri Feb 16 14:59:59 2001
From: Zhu.James at iac.com.tw (Zhu.James@iac.com.tw)
Date: Fri Jan  9 21:46:11 2004
Subject: [mod_python] How to install Python 2.7.2 on Windows NT
Message-ID: <939C21A81E55D311806D0008C759857F0117E18E@isc-mx1.isc.inventec>

Hi All,

   I an a newbie to python. I want to install Python 2.7.2 on my NT machine,
but i cannot find the windows installation guide. Can someone tell me how to
do it?
Thanks in advance.

Regards
James




-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010216/dafc01c5/attachment.htm
From joost.damad at siemens.atea.be  Fri Feb 16 08:31:41 2001
From: joost.damad at siemens.atea.be (Joost Yervante Damad)
Date: Fri Jan  9 21:46:11 2004
Subject: [mod_python] some issues
In-Reply-To: <20010215150733.A20391@siemens.atea.be>; from joost.damad@siemens.atea.be on Thu, Feb 15, 2001 at 03:07:34PM +0100
References: <20010215150733.A20391@siemens.atea.be>
Message-ID: <20010216083141.A10720@siemens.atea.be>

'Joost Yervante Damad' wrote about '[mod_python] some issues' - Thu, Feb 15, 2001 at 03:07:34PM CET
> Hello,
> 
> A friend of me discovered wierd bug in publisher :
> 
> def tst(req, arg='none', test='none', longname='none'):
>         req._content_type_set = 0
>         return "Arguments are '%s', '%s' and '%s'" % (arg, test, longname)
> 
> if we now do:
> 
> https://r2d2.iplab.atea.be:8081/py/test.py/tst?arg=x&test=y&longname=z
> 
> the result is:
> 
> Arguments are '', '' and 'z'
> 
> Aparently short names are not getting into the functions.
> Long names are. Or is this caused by name clashes?
> 
> We tested this both with 2.7.1 and 2.7.2 on Solaris 2.6
> with apache 1.3.14 with SSL and mod_python statically linked.
> 
> Another error I found:
> 
> The handling of _content_type_set seems to be broken.
> 
> publisher no longer functioned, bailin out at:
> 
> if not req._content_type_set:
> 
> giving an exeception stating that that variable was not found.
> 
> Removing that part and setting the content_type to
> "text/html" is our current workaround.
> 
> Any thoughts?
> 

After careful examining we found that somehow 2.7.1 and 2.7.2
got mixed during our building, causing the _content_type_set
breakage. Sorry for that bad intel.

The other problem (short params) remains though.

-- 
Joost Damad - Siemens ICN D NC A - +3214252297
--
Five is a sufficiently close approximation to infinity.
       -- Robert Firth
"One, two, five."
       -- Monty Python and the Holy Grail

From Christian.Vergnaud at hcuge.ch  Tue Feb 20 18:33:02 2001
From: Christian.Vergnaud at hcuge.ch (Christian VERGNAUD)
Date: Fri Jan  9 21:46:11 2004
Subject: [mod_python] Can't locate API module structure `mod_python'
Message-ID: <sa92b870.002@diogenes.hcuge.ch>

I get the following message when I start httpd :
Can't locate API module structure `mod_python' in file /home/Impact/orbix/apache/libexec/mod_python.so: ld.so.1: /home/Impact/orbix/apache/bin/httpd: fatal: mod_python: can't find symbol

OS vesrion: SunOS 5.6, python2.0, Apache 1.3.17, mod_python 2.7.2

I don't know if it's related or not but when installing mod_python, I had to force the library libgcc.a in the Makefile of the src directory in order to avoid unsatisfied entry points (__eprintf for instance) problems.

I'm now stuck and have no idea of what to do. Can someone help?

Thanks


From grisha at verio.net  Tue Feb 20 13:25:39 2001
From: grisha at verio.net (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:11 2004
Subject: [mod_python] Can't locate API module structure `mod_python'
In-Reply-To: <sa92b870.002@diogenes.hcuge.ch>
Message-ID: <Pine.BSF.4.32.0102201325010.20282-100000@localhost>

I believe someone else was reporting a similar issue and they resolved by
compiling python separately without threads.

Grisha

On Tue, 20 Feb 2001, Christian VERGNAUD wrote:

>
> I get the following message when I start httpd :
> Can't locate API module structure `mod_python' in file /home/Impact/orbix/apache/libexec/mod_python.so: ld.so.1: /home/Impact/orbix/apache/bin/httpd: fatal: mod_python: can't find symbol
>
> OS vesrion: SunOS 5.6, python2.0, Apache 1.3.17, mod_python 2.7.2
>
> I don't know if it's related or not but when installing mod_python, I had to force the library libgcc.a in the Makefile of the src directory in order to avoid unsatisfied entry points (__eprintf for instance) problems.
>
> I'm now stuck and have no idea of what to do. Can someone help?
>
> Thanks
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From brett at bookshop.unsw.edu.au  Wed Feb 21 11:33:11 2001
From: brett at bookshop.unsw.edu.au (Brett Haydon)
Date: Fri Jan  9 21:46:11 2004
Subject: [mod_python] Windows version of 2.7.2
Message-ID: <NCBBKMABOKFCDLPIKKGICELMCJAA.brett@bookshop.unsw.edu.au>

I know others have asked but:

Is the modpython dll being recompiled for 2.7.2 for win?

The new modpublisher module looks at the req._content_type_set
attribute which appears not to be in the dll for 2.7.1

regards,
______________________________________________
Brett Haydon


From joost.damad at siemens.atea.be  Wed Feb 21 10:23:46 2001
From: joost.damad at siemens.atea.be (Joost Yervante Damad)
Date: Fri Jan  9 21:46:11 2004
Subject: [mod_python] mod_python/publisher/solaris truncation problems
Message-ID: <20010221102346.A15890@siemens.atea.be>

Hi!

A while ago I send a mail reporting a bug stating that
cgi attribute/value pairs get truncated in our Solaris 2.6
apachessl with latest mod_python, when xxx=yyy total
length smaller then 8 bytes.

It seems to be related to the python/C interfacing...
and it also looks like a 32bit/64bit alike problem.
Anyway, we (I and a colleage) found the following workaround,
basically eliminating some of the Python/C interface calls
from the function "parse_qsl" in
_apachemodule.c

Note that this seems to be a Solaris only problem since
we did not have it on Linux.

Attached is a modified _apachemodule.c with a
working, but probably not the best...fix.
But at least it works for us, and we don't need the
performance.

Any thoughts on this?

Thanks,

-- 
Joost Damad - Siemens IC D NC A - +3214252297
--
Five is a sufficiently close approximation to infinity.
       -- Robert Firth
"One, two, five."
       -- Monty Python and the Holy Grail

From joost.damad at siemens.atea.be  Wed Feb 21 10:29:39 2001
From: joost.damad at siemens.atea.be (Joost Yervante Damad)
Date: Fri Jan  9 21:46:11 2004
Subject: [mod_python] mod_python/publisher/solaris truncation problems
In-Reply-To: <20010221102346.A15890@siemens.atea.be>; from joost.damad@siemens.atea.be on Wed, Feb 21, 2001 at 10:23:46AM +0100
References: <20010221102346.A15890@siemens.atea.be>
Message-ID: <20010221102939.A16904@siemens.atea.be>

'Joost Yervante Damad' wrote about '[mod_python] mod_python/publisher/solaris truncation problems' - Wed, Feb 21, 2001 at 10:23:46AM CET
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

<forgot the attachment...>

-- 
Joost Damad - Siemens IC D NC A - +3214252297
--
Five is a sufficiently close approximation to infinity.
       -- Robert Firth
"One, two, five."
       -- Monty Python and the Holy Grail
-------------- next part --------------
A non-text attachment was scrubbed...
Name: _apachemodule.c
Type: text/x-csrc
Size: 10218 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20010221/52c70a09/_apachemodule.bin
From grisha at verio.net  Wed Feb 21 10:25:01 2001
From: grisha at verio.net (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:11 2004
Subject: [mod_python] mod_python/publisher/solaris truncation problems
In-Reply-To: <20010221102346.A15890@siemens.atea.be>
Message-ID: <Pine.BSF.4.32.0102211023480.30708-100000@localhost>

Interesting... I'll have to look into this. It makes sense, since Solaris
is a 64 bit OS whereas Linux on i386 is 32 bit. I haven't done much
Solaris testing, I guess I'll have to do more.

Grisha

On Wed, 21 Feb 2001, Joost Yervante Damad wrote:

> Hi!
>
> A while ago I send a mail reporting a bug stating that
> cgi attribute/value pairs get truncated in our Solaris 2.6
> apachessl with latest mod_python, when xxx=yyy total
> length smaller then 8 bytes.
>
> It seems to be related to the python/C interfacing...
> and it also looks like a 32bit/64bit alike problem.
> Anyway, we (I and a colleage) found the following workaround,
> basically eliminating some of the Python/C interface calls
> from the function "parse_qsl" in
> _apachemodule.c
>
> Note that this seems to be a Solaris only problem since
> we did not have it on Linux.
>
> Attached is a modified _apachemodule.c with a
> working, but probably not the best...fix.
> But at least it works for us, and we don't need the
> performance.
>
> Any thoughts on this?
>
> Thanks,
>
> --
> Joost Damad - Siemens IC D NC A - +3214252297
> --
> Five is a sufficiently close approximation to infinity.
>        -- Robert Firth
> "One, two, five."
>        -- Monty Python and the Holy Grail
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From petar at metamarkets.com  Wed Feb 21 12:08:07 2001
From: petar at metamarkets.com (Petar Karafezov)
Date: Fri Jan  9 21:46:11 2004
Subject: [mod_python] mod_python2.7.2 and server redirects
Message-ID: <86FC34EA3C4F074AA6BBFFE52ED83FED27BDA3@METAEXCH.sfo.metamarkets.com>

hello all -

let me fist say that I love mod_python - works great - much faster than any
cgi! Thanks, Grisha! 

I am seeing some weirdness when working with server redirects - I'm simply
trying to catch the headers from the server, modify the location key and
then send it to the client. It work ok under the CGI, but when I see the
headers that my .py reports when accessed with lynx -mime_header option
(which simply prints the headers and body and exits) instead of HTTP/1.1 302
Found, I see HTTP/1.1 200 OK. I am not sure why this is happening.. Any
ideas ??

Regards,
Petar Karafezov

MetaMarkets.com
415-575-3015
-------------------------------------------
Investing Out Loud at
http://www.metamarkets.com
-------------------------------------------

From brent at rcfile.org  Wed Feb 21 16:17:38 2001
From: brent at rcfile.org (Brent Verner)
Date: Fri Jan  9 21:46:11 2004
Subject: [mod_python] mod_python2.7.2 and server redirects
In-Reply-To: <86FC34EA3C4F074AA6BBFFE52ED83FED27BDA3@METAEXCH.sfo.metamarkets.com>; from petar@metamarkets.com on Wed, Feb 21, 2001 at 12:08:07PM -0800
References: <86FC34EA3C4F074AA6BBFFE52ED83FED27BDA3@METAEXCH.sfo.metamarkets.com>
Message-ID: <20010221161738.A9355@rcfile.org>

On 21 Feb 2001 at 12:08 (-0800), Petar Karafezov wrote:
| hello all -
| 
| let me fist say that I love mod_python - works great - much faster than any
| cgi! Thanks, Grisha! 
| 
| I am seeing some weirdness when working with server redirects - I'm simply
| trying to catch the headers from the server, modify the location key and
| then send it to the client. It work ok under the CGI, but when I see the
| headers that my .py reports when accessed with lynx -mime_header option
| (which simply prints the headers and body and exits) instead of HTTP/1.1 302
| Found, I see HTTP/1.1 200 OK. I am not sure why this is happening.. Any
| ideas ??

this faq entry may help.

http://www.modpython.org/FAQ/faqw.py?req=show&file=faq03.002.htp

  brent

-- 
"We want to help, but we wouldn't want to deprive you of a valuable 
learning experience."
                                          http://openbsd.org/mail.html

From joost.damad at siemens.atea.be  Thu Feb 22 08:09:37 2001
From: joost.damad at siemens.atea.be (Joost Yervante Damad)
Date: Fri Jan  9 21:46:11 2004
Subject: [mod_python] mod_python/publisher/solaris truncation problems
In-Reply-To: <3A93D1D5.45555DBB@caveosystems.com>; from rsalz@caveosystems.com on Wed, Feb 21, 2001 at 09:33:57AM -0500
References: <20010221102346.A15890@siemens.atea.be> <20010221102939.A16904@siemens.atea.be> <3A93D1D5.45555DBB@caveosystems.com>
Message-ID: <20010222080937.A27533@siemens.atea.be>

'Rich Salz' wrote about 'Re: [mod_python] mod_python/publisher/solaris truncation problems' - Wed, Feb 21, 2001 at 03:33:57PM CET
> a diff would be more useful. ...

True... but the changes I made are not really meant as a
solution. They merely show how we solved it to have a workable
mod_python. I can get you a diff if you want. (see attachment)
It's not a very usefull diff imho tho :)

-- 
Joost Damad - Siemens IC D NC A - +3214252297
--
Five is a sufficiently close approximation to infinity.
       -- Robert Firth
"One, two, five."
       -- Monty Python and the Holy Grail
-------------- next part --------------
--- mod_python-2.7.2/src/_apachemodule.c	Mon Dec 18 20:50:03 2000
+++ ../delta/changed_src/_apachemodule.c	Wed Feb 21 10:15:03 2001
@@ -48,10 +48,14 @@
  *
  */
 
 #include "mod_python.h"
 
+#ifdef ATEA_DEBUG
+#undef ATEA_DEBUG
+#endif
+ 
 /** 
  ** log_error
  **
  *  A wrpapper to ap_log_error
  * 
@@ -253,11 +257,11 @@
 static PyObject *parse_qsl(PyObject *self, PyObject *args)
 {
 
     PyObject *pairs;
     int i, len;
-    char *qs;
+    char *qs, *cpair;
     int keep_blank_values = 0;
     int strict_parsing = 0; /* XXX not implemented */
 
     if (! PyArg_ParseTuple(args, "s|ii", &qs, &keep_blank_values, 
 			   &strict_parsing)) 
@@ -269,83 +273,131 @@
 	return NULL;
 
     i = 0;
     len = strlen(qs);
 
+	cpair=calloc(1,len);
+	
     while (i < len) {
 
-	PyObject *pair, *key, *val;
-	char *cpair, *ckey, *cval;
+	/*PyObject *pair, *key, *val;*/
+	PyObject *key, *val;
+	/*char *cpair, *ckey, *cval;*/
+	char *ckey, *cval;
 	int plen, j, p, k, v;
 
-	pair = PyString_FromStringAndSize(NULL, len);
+	/* pair = PyString_FromStringAndSize(NULL, len);
 	if (pair == NULL)
-	    return NULL;
+	    return NULL;*/
 
 	/* split by '&' or ';' */
-	cpair = PyString_AS_STRING(pair);
+	/*cpair = PyString_AS_STRING(pair);
+	  cpair=calloc(1,len);*/
+#ifdef ATEA_DEBUG
+	fprintf(stderr, "all pairs: %s\n", cpair);
+#endif
 	j = 0;
 	while ((qs[i] != '&') && (qs[i] != ';') && (i < len)) {
 	    /* replace '+' with ' ' */
 	    cpair[j] = (qs[i] == '+') ? ' ' : qs[i];
 	    i++;
 	    j++;
 	}
 	cpair[j] = '\0';
-	_PyString_Resize(&pair, j);
+	/*_PyString_Resize(&pair, j);*/
 
 	/* split the "abc=def" pair */
-
+#ifdef ATEA_DEBUG
+	fprintf(stderr,"[foo] cpair == %s\n", cpair);
+#endif
 	plen = strlen(cpair);
-	key = PyString_FromStringAndSize(NULL, plen);
-	if (key == NULL) 
-	    return NULL;
-	val = PyString_FromStringAndSize(NULL, plen);
-	if (val == NULL) 
-	    return NULL;
-
-	ckey = PyString_AS_STRING(key);
-	cval = PyString_AS_STRING(val);
+#ifdef ATEA_DEBUG
+	fprintf(stderr,"plen == %d\n", plen);
+#endif
+	/*key = PyString_FromStringAndSize(NULL, plen);
+	  if (key == NULL)
+	      return NULL;
+	  val = PyString_FromStringAndSize(NULL, plen);
+	  if (val == NULL)
+	      return NULL;*/
 
+	/*ckey = PyString_AS_STRING(key);
+	  cval = PyString_AS_STRING(val);*/
+	
+	ckey = calloc(1,plen);
+	cval = calloc(1,plen);
+	/*memset(ckey,0,plen);
+	  memset(cval,0,plen);*/
+#ifdef ATEA_DEBUG
+	fprintf(stderr,"ckey=%s, cval=%s (should be empty)\n", ckey, cval);
+#endif
+	
 	p = 0;
 	k = 0;
 	v = 0;
 	while (p < plen) {
-	    if (cpair[p] != '=') {
-		ckey[k] = cpair[p];
-		k++;
-		p++;
+	    if (cpair[p] != '=')
+		{
+#ifdef ATEA_DEBUG
+			fprintf(stderr,"%d cpair=%s ckey=%s, cval=%s (parsing before '=')\n", p, cpair, ckey, cval);
+#endif
+			ckey[k] = cpair[p];
+			k++;
+			p++;
 	    }
 	    else {
-		p++;      /* skip '=' */
-		while (p < plen) {
-		    cval[v] = cpair[p];
-		    v++;
-		    p++;
-		}
+			p++;      /* skip '=' */
+#ifdef ATEA_DEBUG
+			fprintf(stderr, ">>> entering else branch...\n");
+#endif
+			while (p < plen)
+			{
+#ifdef ATEA_DEBUG
+				fprintf(stderr,"%d cpair=%s ckey=%s, cval=%s (parsing after '=')\n", p, cpair, ckey, cval);
+#endif
+		    	cval[v] = cpair[p];
+		    	v++;
+		    	p++;
+			}
 	    }
 	}
 	ckey[k] = '\0';
 	cval[v] = '\0';
+#ifdef ATEA_DEBUG
+	fprintf(stderr,"ckey=%s, cval=%s\n (final)", ckey, cval);
+#endif
 
 	if (keep_blank_values || (v > 0)) {
 
 	    ap_unescape_url(ckey);
 	    ap_unescape_url(cval);
 
-	    _PyString_Resize(&key, strlen(ckey));
-	    _PyString_Resize(&val, strlen(cval));
+	    /*_PyString_Resize(&key, strlen(ckey));
+	      _PyString_Resize(&val, strlen(cval));*/
 
+		key = PyString_FromStringAndSize(ckey, strlen(ckey));
+		if (key == NULL) {
+		  	free(ckey); free(cval); free(cpair);
+	    	return NULL;
+		}
+		val = PyString_FromStringAndSize(cval, strlen(cval));
+		if (val == NULL) {
+		  	free(ckey); free(cval); free(cpair);
+		    return NULL;
+		}
+		
 	    PyList_Append(pairs, Py_BuildValue("(O,O)", key, val));
 
 	}
-	Py_DECREF(pair);
+	/*Py_DECREF(pair);*/
 	Py_DECREF(key);
 	Py_DECREF(val);
 	i++;
+	free(ckey);
+	free(cval);
     }
-
+	free(cpair);
     return pairs;
 }
 
 
 /* methods of _apache */
From r.fortnagel at 21torr.com  Thu Feb 22 11:41:01 2001
From: r.fortnagel at 21torr.com (Ralf Fortnagel)
Date: Fri Jan  9 21:46:11 2004
Subject: [mod_python] Problem to run .py scripts thru apache
Message-ID: <NEBBJGBIKKHHFMNEPEKKKEHMCAAA.r.fortnagel@21torr.com>

Hi Folks!

I use Apache/1.3.14 (Win32) mod_python/2.7.1 Python/2.0 on a Win/NT4.0
machine
If i try to start any .py file thru apache, i get following error:

Mod_python error: "PythonHandler test"
Traceback (most recent call last):
  File "c:\programme\python20\lib\mod_python\apache.py", line 180, in
Dispatch
    object = resolve_object(self.req, module, object_str, silent)
  File "c:\programme\python20\lib\mod_python\apache.py", line 396, in
resolve_object
    raise AttributeError, s
AttributeError: module 'c:\programme\python20\lib\test\__init__.py' contains
no 'handler'

please help me, i don't know what's wrong... :(
--
Ralf Fortnagel                21TORR AGENCY gmbh
r.fortnagel@21torr.com        Engineering
tel: +49-7121-348-221         Heinestrasse 72
fax: +49-7121-348-259         D-72762 Reutlignen

21TORR - die neue medien leidenschaft
www.21torr.com


From joost.damad at siemens.atea.be  Thu Feb 22 11:55:49 2001
From: joost.damad at siemens.atea.be (Joost Yervante Damad)
Date: Fri Jan  9 21:46:11 2004
Subject: [mod_python] Problem to run .py scripts thru apache
In-Reply-To: <NEBBJGBIKKHHFMNEPEKKKEHMCAAA.r.fortnagel@21torr.com>; from r.fortnagel@21torr.com on Thu, Feb 22, 2001 at 11:41:01AM +0100
References: <NEBBJGBIKKHHFMNEPEKKKEHMCAAA.r.fortnagel@21torr.com>
Message-ID: <20010222115549.A27399@siemens.atea.be>

'Ralf Fortnagel' wrote about '[mod_python] Problem to run .py scripts thru apache' - Thu, Feb 22, 2001 at 11:41:01AM CET
> Hi Folks!
>
> I use Apache/1.3.14 (Win32) mod_python/2.7.1 Python/2.0 on a Win/NT4.0
> machine
> If i try to start any .py file thru apache, i get following error:
>
> Mod_python error: "PythonHandler test"
> Traceback (most recent call last):
>   File "c:\programme\python20\lib\mod_python\apache.py", line 180, in
> Dispatch
>     object = resolve_object(self.req, module, object_str, silent)
>   File "c:\programme\python20\lib\mod_python\apache.py", line 396, in
> resolve_object
>     raise AttributeError, s
> AttributeError: module 'c:\programme\python20\lib\test\__init__.py' contains
> no 'handler'
>
> please help me, i don't know what's wrong... :(
> --
> Ralf Fortnagel                21TORR AGENCY gmbh
> r.fortnagel@21torr.com        Engineering
> tel: +49-7121-348-221         Heinestrasse 72
> fax: +49-7121-348-259         D-72762 Reutlignen
> 
> 21TORR - die neue medien leidenschaft
> www.21torr.com
> 

I asume you have in your apache config file:

PythonHandler test

This means that mod_python needs to look for a pythonscript called 'test'.

But :) In your Pythonpath you also have the dir c:\programme\python20\lib\
and the directory c:\programme\python20\lib\test\ matches your handler.

Python then looks for an __init__.py to 'execute' the directory as a
pythonscript, and this is obviously not what you want.

Joost

-- 
Joost Damad - Siemens IC D NC A - +3214252297
--
Five is a sufficiently close approximation to infinity.
       -- Robert Firth
"One, two, five."
       -- Monty Python and the Holy Grail

From brianh at exelixis.com  Thu Feb 22 20:11:38 2001
From: brianh at exelixis.com (Brian Hawthorne)
Date: Fri Jan  9 21:46:11 2004
Subject: [mod_python] Stackless python
Message-ID: <Pine.GSO.4.05.10102222009490.13571-100000@timeless.exelixis.com>

i wonder, 
has anyone embedded stackless python in apache using mod_python?

brian


From ensim.ml.mod_python at ensim.com  Thu Feb 22 22:41:45 2001
From: ensim.ml.mod_python at ensim.com (Ensim-Newsgroups.Mailing-Lists.Mod_Python-List)
Date: Fri Jan  9 21:46:11 2004
Subject: [mod_python] browser connection state
Message-ID: <9AC41B8C4781464695BB013F106FCA3181A5A5@nasdaq.ms.ensim.com>

is there a way in mod python to check whether the browser connection has
been aborted?  ie, given a single request, before writing each chunk of
response data to the browser, can we check whether the browser user pressed
the stop button (or pressed escape).

From miguel at yorku.ca  Fri Feb 23 08:40:13 2001
From: miguel at yorku.ca (Miguel Marques)
Date: Fri Jan  9 21:46:11 2004
Subject: [mod_python] browser connection state
In-Reply-To: <9AC41B8C4781464695BB013F106FCA3181A5A5@nasdaq.ms.ensim.com>
References: <9AC41B8C4781464695BB013F106FCA3181A5A5@nasdaq.ms.ensim.com>
Message-ID: <20010223084013J.miguel@yorku.ca>

Greetings...
On Thu, 22 Feb 2001 22:41:45 -0800, "Ensim-Newsgroups.Mailing-Lists.Mod_Python-List" <ensim.ml.mod_python@ensim.com> wrote:
> is there a way in mod python to check whether the browser connection has
> been aborted?  ie, given a single request, before writing each chunk of
> response data to the browser, can we check whether the browser user pressed
> the stop button (or pressed escape).
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

If the browser goes away for any reason (stop, reload, etc) and you
try to write to the client, you get an IOError exception which you can
catch.  

I usually have req.write(" ")'s just before database writes and the
such to try and cause this exception to be thrown so I can clean up
and exit and not do anything.

						      Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830

From sergio at royalwebhosting.com  Fri Feb 23 15:39:41 2001
From: sergio at royalwebhosting.com (Sergio Baca)
Date: Fri Jan  9 21:46:11 2004
Subject: [mod_python] mod_python vs java servlets
Message-ID: <157254279584.20010223153941@royalwebhosting.com>

Hello mod,

  How is comparable mod_python with java servlets? Because using
  JPython comparison can be easy made, have anybody thought about
  this?

-- 
Best regards,
 Sergio                          mailto:sergio@royalwebhosting.com



From naris at ensim.com  Fri Feb 23 11:00:39 2001
From: naris at ensim.com (Naris Siamwalla)
Date: Fri Jan  9 21:46:11 2004
Subject: [mod_python] browser connection state
Message-ID: <9AC41B8C4781464695BB013F106FCA3181A5AA@nasdaq.ms.ensim.com>

catching the IOError exception is fine, but can i assume for -*all*- IOError
exceptions thrown when i req.write was because of a stop/reload?  could an
IOError be thrown for other reasons (e.g. apache itself causing mod_python
to throw the IOError exception) ?  if there are no other reaons, then i
guess it's safe to write a try block that assumes so.

-----Original Message-----
From: Miguel Marques [mailto:miguel@yorku.ca]
Sent: Friday, February 23, 2001 5:40 AM
To: ensim.ml.mod_python@ensim.com
Cc: mod_python@modpython.org
Subject: Re: [mod_python] browser connection state


Greetings...
On Thu, 22 Feb 2001 22:41:45 -0800,
"Ensim-Newsgroups.Mailing-Lists.Mod_Python-List"
<ensim.ml.mod_python@ensim.com> wrote:
> is there a way in mod python to check whether the browser connection has
> been aborted?  ie, given a single request, before writing each chunk of
> response data to the browser, can we check whether the browser user
pressed
> the stop button (or pressed escape).
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

If the browser goes away for any reason (stop, reload, etc) and you
try to write to the client, you get an IOError exception which you can
catch.  

I usually have req.write(" ")'s just before database writes and the
such to try and cause this exception to be thrown so I can clean up
and exit and not do anything.

						      Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python

From ensim.ml.mod_python at ensim.com  Fri Feb 23 11:36:51 2001
From: ensim.ml.mod_python at ensim.com (Ensim-Newsgroups.Mailing-Lists.Mod_Python-List)
Date: Fri Jan  9 21:46:12 2004
Subject: [mod_python] browser connection state
Message-ID: <9AC41B8C4781464695BB013F106FCA3181A5AC@nasdaq.ms.ensim.com>

catching the IOError exception is fine, but can i assume for -*all*- IOError
exceptions thrown when i req.write was because of a stop/reload?  could an
IOError be thrown for other reasons (e.g. apache itself causing mod_python
to throw the IOError exception) ?  if there are no other reaons, then i
guess it's safe to write a try block that assumes so.

-----Original Message-----
From: Miguel Marques [mailto:miguel@yorku.ca]
Sent: Friday, February 23, 2001 5:40 AM
To: ensim.ml.mod_python@ensim.com
Cc: mod_python@modpython.org
Subject: Re: [mod_python] browser connection state


Greetings...
On Thu, 22 Feb 2001 22:41:45 -0800,
"Ensim-Newsgroups.Mailing-Lists.Mod_Python-List"
<ensim.ml.mod_python@ensim.com> wrote:
> is there a way in mod python to check whether the browser connection has
> been aborted?  ie, given a single request, before writing each chunk of
> response data to the browser, can we check whether the browser user
pressed
> the stop button (or pressed escape).
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

If the browser goes away for any reason (stop, reload, etc) and you
try to write to the client, you get an IOError exception which you can
catch.  

I usually have req.write(" ")'s just before database writes and the
such to try and cause this exception to be thrown so I can clean up
and exit and not do anything.

						      Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python

From miguel at yorku.ca  Fri Feb 23 14:40:04 2001
From: miguel at yorku.ca (Miguel Marques)
Date: Fri Jan  9 21:46:12 2004
Subject: [mod_python] browser connection state
In-Reply-To: <9AC41B8C4781464695BB013F106FCA3181A5AA@nasdaq.ms.ensim.com>
References: <9AC41B8C4781464695BB013F106FCA3181A5AA@nasdaq.ms.ensim.com>
Message-ID: <20010223144004T.miguel@yorku.ca>

On Fri, 23 Feb 2001 11:00:39 -0800, Naris Siamwalla <naris@ensim.com> wrote:
> catching the IOError exception is fine, but can i assume for -*all*- IOError
> exceptions thrown when i req.write was because of a stop/reload?  could an
> IOError be thrown for other reasons (e.g. apache itself causing mod_python
> to throw the IOError exception) ?  if there are no other reaons, then i
> guess it's safe to write a try block that assumes so.

Gregory would better be able to answer that than me.  
I'm just a mod_python user...

However, IMHO, even if the IOError error happens inside of apache or
for some other reason, it means you lost the connection to the browser and
therefore that you won't be able to send a response to the user.
In that case you probably should abort whatever the user requested
since s/he will probably assume it didn't work since no page got sent
back.  Or am I missing the point?

       						Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830


From ensim.ml.mod_python at ensim.com  Fri Feb 23 11:49:34 2001
From: ensim.ml.mod_python at ensim.com (Ensim-Newsgroups.Mailing-Lists.Mod_Python-List)
Date: Fri Jan  9 21:46:12 2004
Subject: [mod_python] browser connection state
Message-ID: <9AC41B8C4781464695BB013F106FCA3181A5AE@nasdaq.ms.ensim.com>

you're right....i guess i'm over-analyzing :-)

IOError raised during req.write means you had a problem writing, plain and
simple.  and if you had a problem writing, your python code should handle it
accordingly.

-----Original Message-----
From: Miguel Marques [mailto:miguel@yorku.ca]
Sent: Friday, February 23, 2001 11:40 AM
To: naris@ensim.com
Cc: mod_python@modpython.org
Subject: Re: RE: [mod_python] browser connection state


On Fri, 23 Feb 2001 11:00:39 -0800, Naris Siamwalla <naris@ensim.com> wrote:
> catching the IOError exception is fine, but can i assume for -*all*-
IOError
> exceptions thrown when i req.write was because of a stop/reload?  could an
> IOError be thrown for other reasons (e.g. apache itself causing mod_python
> to throw the IOError exception) ?  if there are no other reaons, then i
> guess it's safe to write a try block that assumes so.

Gregory would better be able to answer that than me.  
I'm just a mod_python user...

However, IMHO, even if the IOError error happens inside of apache or
for some other reason, it means you lost the connection to the browser and
therefore that you won't be able to send a response to the user.
In that case you probably should abort whatever the user requested
since s/he will probably assume it didn't work since no page got sent
back.  Or am I missing the point?

       						Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830

From rbeer at uni-goettingen.de  Sat Feb 24 18:53:30 2001
From: rbeer at uni-goettingen.de (Ragnar Beer)
Date: Fri Jan  9 21:46:12 2004
Subject: [mod_python] Apache children RAM use
Message-ID: <p04330104b6bda4a03c43@[134.76.136.114]>

Howdy!

I'm absolutely new to mod_python and I wonder what happens to the 
memory use of apache children when mod_python is compiled in. Coming 
from mod_perl I'm expecting the worst. How about mod_python?

Ragnar Beer

From gege at china.com  Mon Feb 26 23:04:33 2001
From: gege at china.com (gege@china.com)
Date: Fri Jan  9 21:46:12 2004
Subject: [mod_python] help
Message-ID: <8z989773769566.05317@mail2.china.com>

 under windows 98 apache 1.3.17

I copy mod_python.dll to /apache/modules

copy mod_python to c:\python20\lib

add row LoadModule python_module modules/mod_python.dll to httpd.conf

add 

<Directory "C:/Apache/htdocs/python">
    AddHandler python-program .py
    PythonHandler mptest
    PythonDebug On
</Directory>

to httpd.conf too.

then restart apache. when i enter http://localhost/python, i can see mptest.py.

but when i click mptest.py, the browser tells me

Internal Server Error
The server encountered an internal error or misconfiguration and was unable to complete your request.

what happens?

error.log looks like:

[Mon Feb 26 15:50:18 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
'import site' failed; use -v for traceback
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
Apache server shutdown initiated...
'import site' failed; use -v for traceback
'import site' failed; use -v for traceback
[Mon Feb 26 20:26:18 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:37 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:39 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:40 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:41 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:41 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:41 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:42 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:42 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:42 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:42 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:42 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:43 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:43 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:43:04 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:44:42 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:46:02 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
'import site' failed; use -v for traceback
'import site' failed; use -v for traceback
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
'import site' failed; use -v for traceback
[Mon Feb 26 20:57:49 2001] [error] [

************************************

http://hospital.china.com/

http://lovesky.china.com

From petar at metamarkets.com  Mon Feb 26 11:03:33 2001
From: petar at metamarkets.com (Petar Karafezov)
Date: Fri Jan  9 21:46:12 2004
Subject: [mod_python] RE: my_file.pyc is not created anymore ...what changed ?
Message-ID: <86FC34EA3C4F074AA6BBFFE52ED83FED27BDBC@METAEXCH.sfo.metamarkets.com>

Hello all -

I was going through a lot of reconfiguration of my apache+mod_python setup,
including migrating it to different server and it seems that somewhere in
all changes made I have "lost" the .pyc files functionality. Before I'd see
a .pyc file being created after mod_python would process my .py handlers.
According to the docs - it would not recompile again if the .py file doesn't
get changed and just use the pre-compiled byte code.

I did a fresh install of apache and mod_python 2.7.2 both with python 1.5.2
(the standard RPm that comes with RH6.2) and with compiled from source
Python2.0 - and I still don't see the .pyc iles created. Any ideas ??

Thanks all for your help!

Regards,
Petar Karafezov

From gege at china.com  Tue Feb 27 03:26:18 2001
From: gege at china.com (gege@china.com)
Date: Fri Jan  9 21:46:12 2004
Subject: [mod_python] what's happen?
Message-ID: <Di989772967381.12116@mail3.china.com>

under redhat 6.2 python 2.1a2 mod_python 2.7.2 apache 1.3.12

lynx http://localhost/python/mptest.py

it appears Hello World!

but when I type lynx http://localhost/python/test.py or some other filename.py

it also appears Hello World!

I don't understand...

from other client by using IE, it gives the same result.
************************************

http://hospital.china.com/

http://lovesky.china.com

From gege at china.com  Tue Feb 27 03:25:48 2001
From: gege at china.com (gege@china.com)
Date: Fri Jan  9 21:46:12 2004
Subject: [mod_python] what's happen?
Message-ID: <Ac989772967451.24452@mail3.china.com>

under redhat 6.2 python 2.1a2 mod_python 2.7.2 apache 1.3.12

lynx http://localhost/python/mptest.py

it appears Hello World!

but when I type lynx http://localhost/python/test.py or some other filename.py

it also appears Hello World!

I don't understand...

from other client by using IE, it gives the same result.
************************************

http://hospital.china.com/

http://lovesky.china.com

From gege at china.com  Tue Feb 27 03:25:18 2001
From: gege at china.com (gege@china.com)
Date: Fri Jan  9 21:46:12 2004
Subject: [mod_python] what's happen?
Message-ID: <EJ989772967481.12100@mail3.china.com>

under redhat 6.2 python 2.1a2 mod_python 2.7.2 apache 1.3.12

lynx http://localhost/python/mptest.py

it appears Hello World!

but when I type lynx http://localhost/python/test.py or some other filename.py

it also appears Hello World!

I don't understand...

from other client by using IE, it gives the same result.
************************************

http://hospital.china.com/

http://lovesky.china.com

From brent at rcfile.org  Mon Feb 26 14:34:16 2001
From: brent at rcfile.org (Brent Verner)
Date: Fri Jan  9 21:46:12 2004
Subject: [mod_python] RE: my_file.pyc is not created anymore ...what changed ?
In-Reply-To: <86FC34EA3C4F074AA6BBFFE52ED83FED27BDBC@METAEXCH.sfo.metamarkets.com>; from petar@metamarkets.com on Mon, Feb 26, 2001 at 11:03:33AM -0800
References: <86FC34EA3C4F074AA6BBFFE52ED83FED27BDBC@METAEXCH.sfo.metamarkets.com>
Message-ID: <20010226143416.A53686@rcfile.org>

On 26 Feb 2001 at 11:03 (-0800), Petar Karafezov wrote:
| Hello all -
| 
| I was going through a lot of reconfiguration of my apache+mod_python setup,
| including migrating it to different server and it seems that somewhere in
| all changes made I have "lost" the .pyc files functionality. Before I'd see
| a .pyc file being created after mod_python would process my .py handlers.
| According to the docs - it would not recompile again if the .py file doesn't
| get changed and just use the pre-compiled byte code.
| 
| I did a fresh install of apache and mod_python 2.7.2 both with python 1.5.2
| (the standard RPm that comes with RH6.2) and with compiled from source
| Python2.0 - and I still don't see the .pyc iles created. Any ideas ??

perhaps the directory where your .py files (and the desired .pyc) files
live is not writable by the user the web server is running as? I've found
it very useful to create a new group, add myself and the web server user
to that group, then own the python web directories to that group and chmod
it g+w.

hth.
	brent

From miguel at yorku.ca  Mon Feb 26 15:01:24 2001
From: miguel at yorku.ca (Miguel Marques)
Date: Fri Jan  9 21:46:12 2004
Subject: [mod_python] what's happen?
In-Reply-To: <Ac989772967451.24452@mail3.china.com>
References: <Ac989772967451.24452@mail3.china.com>
Message-ID: <20010226150124M.miguel@yorku.ca>

On Tue, 27 Feb 2001 03:25:48 +0800 (CST), gege@china.com wrote:
> under redhat 6.2 python 2.1a2 mod_python 2.7.2 apache 1.3.12
> 
> lynx http://localhost/python/mptest.py
> 
> it appears Hello World!
> 
> but when I type lynx http://localhost/python/test.py or some other filename.py
> 
> it also appears Hello World!
> 
> I don't understand...

AddHandler python-program .py
specifies .py files are to be handled by the handler python-program.

The handler for files of type python-program in that directory is
whatever you specified as the PythonHandler in your apache
configuration file.

So any filename ending in .py gets handled by running mptest.py (I'm
guessing that's what you specified).
If you wanted to do something based on the filename you could 
look at req.uri in mptest.py.

If for instance you use 
SetHandler python-program
instead of
AddHandler python-program .py
then any reference to a file in that directory runs mptest.py
regardless of extension.

Hope this helps.

							Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830

From petar at metamarkets.com  Mon Feb 26 12:03:18 2001
From: petar at metamarkets.com (Petar Karafezov)
Date: Fri Jan  9 21:46:12 2004
Subject: [mod_python] RE: my_file.pyc is not created anymore ...what c
	hanged ?
Message-ID: <86FC34EA3C4F074AA6BBFFE52ED83FED27BDBD@METAEXCH.sfo.metamarkets.com>

duh! of course ... :) Thanks, Brent!

-----Original Message-----
From: Brent Verner [mailto:brent@rcfile.org]
Sent: Monday, February 26, 2001 11:34 AM
To: Petar Karafezov
Cc: mod_python@modpython.org
Subject: Re: [mod_python] RE: my_file.pyc is not created anymore ...what
changed ?


On 26 Feb 2001 at 11:03 (-0800), Petar Karafezov wrote:
| Hello all -
| 
| I was going through a lot of reconfiguration of my apache+mod_python
setup,
| including migrating it to different server and it seems that somewhere in
| all changes made I have "lost" the .pyc files functionality. Before I'd
see
| a .pyc file being created after mod_python would process my .py handlers.
| According to the docs - it would not recompile again if the .py file
doesn't
| get changed and just use the pre-compiled byte code.
| 
| I did a fresh install of apache and mod_python 2.7.2 both with python
1.5.2
| (the standard RPm that comes with RH6.2) and with compiled from source
| Python2.0 - and I still don't see the .pyc iles created. Any ideas ??

perhaps the directory where your .py files (and the desired .pyc) files
live is not writable by the user the web server is running as? I've found
it very useful to create a new group, add myself and the web server user
to that group, then own the python web directories to that group and chmod
it g+w.

hth.
	brent

From mail4myx at yahoo.de  Wed Feb 28 17:06:12 2001
From: mail4myx at yahoo.de (=?iso-8859-1?q?anja=20schmidt?=)
Date: Fri Jan  9 21:46:12 2004
Subject: [mod_python] mod_python, NT, PythonPath
Message-ID: <20010228160612.48560.qmail@web12803.mail.yahoo.com>

Hi,
okay, I've spent almost the whole day trying to
integrate mod_python in NT and I'm getting craaaaazy
now!

I've browsed through the archives and I'm getting the
same error message like George Jempty(5th of December
2000). But he didn't get a reply so I try once again:

The error message in the apache error.log is: 
python_handler: make_obcallback returned no
obCallBack!

After browsing the archives I sort of understand that
the extracted python files of mod_python-2.7.2.tgz
can't be located. I've put them in the
C:\Programme\Python20\Lib\mod_python-2.7.2 directory
and I've pointed the PYTHONPATH env-variable to this.
Didn't work.

The lines in the httpd.conf-file look like

<Directory "C:/Programme/Apache
Group/Apache/htdocs/python">
	AddHandler python-program .py
	PythonHandler mptest
	PythonDebug on
</Directory> 

I also tried to define the PythonPath-variable in
between the <Directory /> tags: PythonPath
"C:/Programme/Python20/Lib/mod_python-2.7.2/" Didn't
work! (And I also tried with other python files, so it
has nothing to do with the name of the .py file,
mptest or test).

So, if anyone knows the answer: Please be so kind to
tell me. Thanks a lot in advance!!

Anja

__________________________________________________________________
Do You Yahoo!?
Gesendet von Yahoo! Mail - http://mail.yahoo.de

From victor at prodigy.net  Wed Feb 28 11:28:24 2001
From: victor at prodigy.net (Victor Muslin)
Date: Fri Jan  9 21:46:12 2004
Subject: [mod_python] mod_python, NT, PythonPath
In-Reply-To: <20010228160612.48560.qmail@web12803.mail.yahoo.com>
Message-ID: <5.0.0.25.0.20010228111927.03518980@localhost>

I used to get the same error before I set things up so that mod_python 
PACKAGE is found.

Make sure you mod_python Python PACKAGE (not the DLL files) and make sure 
that PYTHONPATH environmental variable points to the directory where the 
package is located. The mod_python package is a set of python files in a 
mod_python directory and a bunch of subdirectories.

For example, if you put the package in C:\python_packages (so that you now 
have c:\python_packages\mod_python\...) make sure PYTHONPATH has 
C:\python_packages in it. Then restart Apache.

What you want to do is define PYTHONPATH in your environment BEFORE 
starting the Apache (so that Apache process inherits it). You can then also 
do in httpd.conf:

PassEnv PYTHONPATH

though I don't think it makes a difference.

Hope this helps.


At 05:06 PM 2/28/2001 +0100, anja schmidt wrote:
>Hi,
>okay, I've spent almost the whole day trying to
>integrate mod_python in NT and I'm getting craaaaazy
>now!
>
>I've browsed through the archives and I'm getting the
>same error message like George Jempty(5th of December
>2000). But he didn't get a reply so I try once again:
>
>The error message in the apache error.log is:
>python_handler: make_obcallback returned no
>obCallBack!
>
>After browsing the archives I sort of understand that
>the extracted python files of mod_python-2.7.2.tgz
>can't be located. I've put them in the
>C:\Programme\Python20\Lib\mod_python-2.7.2 directory
>and I've pointed the PYTHONPATH env-variable to this.
>Didn't work.
>
>The lines in the httpd.conf-file look like
>
><Directory "C:/Programme/Apache
>Group/Apache/htdocs/python">
>         AddHandler python-program .py
>         PythonHandler mptest
>         PythonDebug on
></Directory>
>
>I also tried to define the PythonPath-variable in
>between the <Directory /> tags: PythonPath
>"C:/Programme/Python20/Lib/mod_python-2.7.2/" Didn't
>work! (And I also tried with other python files, so it
>has nothing to do with the name of the .py file,
>mptest or test).
>
>So, if anyone knows the answer: Please be so kind to
>tell me. Thanks a lot in advance!!
>
>Anja
>
>__________________________________________________________________
>Do You Yahoo!?
>Gesendet von Yahoo! Mail - http://mail.yahoo.de
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://www.modpython.org/mailman/listinfo/mod_python

_________________________________________________________________________
Victor Muslin    The power of accurate observation is frequently called
                       cynicism by those who don't have it.
                           - George Bernard Shaw
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010228/adaf2ea4/attachment.htm
From brett at bookshop.unsw.edu.au  Thu Feb  1 14:36:05 2001
From: brett at bookshop.unsw.edu.au (Brett Haydon)
Date: Fri Jan  9 21:52:15 2004
Subject: [mod_python] modpublisher security model
Message-ID: <NCBBKMABOKFCDLPIKKGIMEHGCJAA.brett@bookshop.unsw.edu.au>

Evidently Zope currently uses the doc string to 
explicity allow access to functions via URL.

The new Python 2.1 will allow functions to have
attributes.

I am currently renaming all imported modules with
an underscore to avoid unintentional security problems
(and global objects)
but I like the idea of explicitly allowing access.

Any plans to move in this direction.

regards,
______________________________________________
Brett Haydon


From x at vex.net  Tue Feb  6 13:59:21 2001
From: x at vex.net (T. Muddletin)
Date: Fri Jan  9 21:52:15 2004
Subject: [mod_python] math import
Message-ID: <158300828588.20010206135921@vex.net>

I'm playing with netbsd 1.5/apache 1.3.17/python 2.0/mod_python 2.7.1
(DSO).

Using the cgihandler... when i try to import the standard python math
module i get...

PythonHandler mod_python.cgihandler: Traceback (most recent call last):
PythonHandler mod_python.cgihandler:   File "/usr/pkg/lib/python2.0/site-packages/mod_python/apache.py", line 189, in Dispatch
    result = object(self.req)
PythonHandler mod_python.cgihandler:   File "/usr/pkg/lib/python2.0/site-packages/mod_python/cgihandler.py", line 122, in handler
    imp.load_module(module_name, fd, path, desc)
PythonHandler mod_python.cgihandler:   File "/usr/home/x/public_html/test.py", line 21, in ?
    import math
PythonHandler mod_python.cgihandler: ImportError: error in dynamic linking

Is this a DSO issue? I hope not, because i haven't been able to get
apache to static compile with the mod yet either...

-- 
Tim Middleton | Cain Gang Ltd | There are a thousand hacking at the branches
x@veX.net     | www.Vex.Net   | of evil [but who] at the root. --Thoreau (W)



From brent at rcfile.org  Wed Feb  7 08:59:53 2001
From: brent at rcfile.org (Brent Verner)
Date: Fri Jan  9 21:52:15 2004
Subject: [mod_python] [RFC] mod_python embedded python module
Message-ID: <20010207085953.B4193@rcfile.org>

Hi,
  
  First off, Gregory, thanks for writing this nice software :)

  Secondly, after looking into mod_python and mod_snake, I've 
decided that _I_ like mod_python (the base python/apache binding)
much better than mod_snake. Now, I'm not a python programmer, but
there's no better way to learn than to do, so last night I started
hacking up a module/handler to handle documents having embedded
HTML, the feature which drew me toward mod_snake at first.

  What I intend to do with this module is have it:
    1) parse (so to speak) a document containing HTML-embedded python
       code into pure python code. My tentative direction is to:
        a) create a python file that looks like
========================================================
env = {}
def embedded_output_hook(req):
  env = req.subprocess_env
  req.write("""<html>
<head>
<title>"""
  req.write( req.uri )
  req.write("""</title>
</head>
<body>
"""
  for i in env.keys():
    req.write("""<b>""")
    req.write( i )
    req.write(""": """)
    req.write( env[i] )
    req.write("""</b><br>
""")
  # for
  req.write("""</body
</html>
""")

========================================================
from an HTML-embedded file of:
========================================================
<html>
<head>
<title><?= req.uri ?></title>
</head>
<body>
<?
  for i in env.keys():
?>
<b><?= i ?>: <?= env[i] ?></b><br>
<?
  # for
?>
</body>
</html>
========================================================

       and the module will call embedded_output_hook(req) from 
       the loaded module. Also, I've thought of having calls to
       content_type/auth/cleanup functions which may be defined in
       the document...
    2) save those parsed files to a cache directory, where they'll
       actually be loaded from when the correspondeing HTML-embedded
       file is requested via the handler. Of course I'm stat()ing
       the files to make sure the parsed/cached file is up to date.

That is all fairly simple, from the overview, but I do have a few 
questions before I go too far down the wrong road :):
  1) is this approach sane, or is there a more elegant/efficient
     way to handle this?
  2) To create the pure-python file from the embedded document, I'm
     pretty sure some restrictions will have to be made on the
     location/designation of functions. What is a reasonable set
     of restrictions that can/should be placed on this so the module
     doesn't become a major-hack-of-a-buncha-special-cases :)
  3) I'm using load_module(...) to load the pure-python files. Is
     there any way (a different one?) that will allow the loaded
     module to access globals from the module's environment, i.e.,
     database connections, et. al.
  4) Is there any way to have multile 'AddHandler' types in the same 
     config section? If not, will you accept clean patches to do so?


comments and discussion are requested. I'm going to do this, I just
want to make sure I do something that is maximally useful :) I'll
not be resonding to this thread until the weekend, cause I've got
some real (non-python :() work that _must_ get done to free up my
weekend to get on with this hack.

thanks.
  brent

-- 
"We want to help, but we wouldn't want to deprive you of a valuable 
learning experience."
                                          http://openbsd.org/mail.html

From jmcbray at carcosa.net  Wed Feb  7 14:19:28 2001
From: jmcbray at carcosa.net (Jason F. McBrayer)
Date: Fri Jan  9 21:52:16 2004
Subject: [mod_python] [RFC] mod_python embedded python module
In-Reply-To: <20010207085953.B4193@rcfile.org>; from brent@rcfile.org on Wed, Feb 07, 2001 at 08:59:53AM -0500
References: <20010207085953.B4193@rcfile.org>
Message-ID: <20010207141928.B19360@bertrand.carcosa.net>

On Wed, Feb 07, 2001 at 08:59:53AM -0500, Brent Verner wrote:

>   Secondly, after looking into mod_python and mod_snake, I've 
> decided that _I_ like mod_python (the base python/apache binding)
> much better than mod_snake. Now, I'm not a python programmer, but
> there's no better way to learn than to do, so last night I started
> hacking up a module/handler to handle documents having embedded
> HTML, the feature which drew me toward mod_snake at first.

You might also take a look at PMZ (Poor Man's Zope,
pmz.sourceforge.net), which already does this very well.  I did some
work to make it usable as a mod_python module, but I think the
original author has also done so in parallel.  In any case, it's not
too hard to do -- just get PMZ and work on wrapping it in a handler
function, redirecting IO appropriately.

-- 
+----------------------------------------------------------------+
| Jason F. McBrayer                         jmcbray@carcosa.net  |
| The scalloped tatters of the King in Yellow must hide Yhtill   |
| forever.                    R.W. Chambers _The King in Yellow_ |

From miguel at yorku.ca  Wed Feb  7 14:35:45 2001
From: miguel at yorku.ca (Miguel Marques)
Date: Fri Jan  9 21:52:16 2004
Subject: [mod_python] [RFC] mod_python embedded python module
In-Reply-To: <20010207141928.B19360@bertrand.carcosa.net>
References: <20010207085953.B4193@rcfile.org>
	<20010207141928.B19360@bertrand.carcosa.net>
Message-ID: <20010207143545G.miguel@yorku.ca>

Greetings...
On Wed, 7 Feb 2001 14:19:28 -0500, "Jason F. McBrayer" <jmcbray@carcosa.net> wrote:
> On Wed, Feb 07, 2001 at 08:59:53AM -0500, Brent Verner wrote:
> 
> >   Secondly, after looking into mod_python and mod_snake, I've 
> > decided that _I_ like mod_python (the base python/apache binding)
> > much better than mod_snake. Now, I'm not a python programmer, but
> > there's no better way to learn than to do, so last night I started
> > hacking up a module/handler to handle documents having embedded
> > HTML, the feature which drew me toward mod_snake at first.
> 
> You might also take a look at PMZ (Poor Man's Zope,
> pmz.sourceforge.net), which already does this very well.  I did some
> work to make it usable as a mod_python module, but I think the
> original author has also done so in parallel.  In any case, it's not
> too hard to do -- just get PMZ and work on wrapping it in a handler
> function, redirecting IO appropriately.
> 
Another option is getting Zope and extracting DocumentTemplate and
using it.  It allows you to easily insert data from python objects 
into html templates and it has some very nice helper functions you can
use in your templates.

I've several web applications using mod_python and DocumentTemplate
and they work rather nicely.  I believe PMZ offers similar functionality
but you may want to look at DocumentTemplate and see which you like better.

							Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830


From grisha at verio.net  Sat Feb 10 21:26:12 2001
From: grisha at verio.net (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:16 2004
Subject: [mod_python] 2.7.2
Message-ID: <Pine.BSF.4.32.0102102124360.22089-100000@localhost>

2.7.2 is available for download.

If you are using the publisher handler, you should upgrade, since 2.7.2
fixes the issue with being able access standard library modules from the
web. It also adds some new authentication features to the publisher
handler.

Grisha


From daniel at copyleft.no  Sun Feb 11 16:16:23 2001
From: daniel at copyleft.no (Hr. Daniel Mikkelsen)
Date: Fri Jan  9 21:52:16 2004
Subject: [mod_python] File uploads.
Message-ID: <Pine.LNX.4.31.0102111613590.27696-100000@unity.copyleft.no>

Hi.

Does anyone have any example code for accepting file uploads with
mod_python? I understand one uses req.read() to get the POSTed data
as usual, and then one parses th query-string in a particular
manner.

Thanks in advance!

-- Daniel Mikkelsen, Copyleft Software AS



From teep at inet.co.th  Mon Feb 12 15:28:03 2001
From: teep at inet.co.th (Prateep Siamwalla)
Date: Fri Jan  9 21:52:16 2004
Subject: [mod_python] Regarding 2.7.2 on windows
Message-ID: <002401c094cd$bb3086a0$0c05a8c0@taramansion.bangkok>

Hi All,

I have been using 2.7.1 on windows for a couple of weeks now [ many thanks
to Enrique Vaamonde for the excellent installation instructions ], and its
been quite a ride.  I'm eager to download the new 2.7.2 which was recently
uploaded.

Question :
Since I'm running compiler impared windows box, will I need to wait for a
new mod_python.dll to be uploaded before installing mod_python 2.7.2?  Or
are the new changes made only to the python files in python20\lib\mod_python
?

Thanks in advance
teep



From jd at pdx.edu  Mon Feb 12 15:19:47 2001
From: jd at pdx.edu (jd@pdx.edu)
Date: Fri Jan  9 21:52:16 2004
Subject: [mod_python] Mod_Python and Solaris Compile Problems
Message-ID: <982019987.3a886f93b61d1@webmail.pdx.edu>

Hi!  I'm trying to install mod_python on my Solaris server and I keep getting
comple problems.  I'm using Apache 1.3.14, PHP 4.0.2pl1, and Mod_Python 2.7.2.  

Here's what happens when I try to compile Apache with the Static Mod_Python (it
also fails on compiling the DSO, see below):

<=== src/modules/python
<=== src/modules
gcc -c  -I./os/unix -I./include   -DSOLARIS2=280 -I/usr/share/src/php-4.0.4pl1
-I/usr/share/src/php-4.0.4pl1/main -I/usr/share/src/php-4.0.4pl1/main
-I/usr/share/src/php-4.0.4pl1/Zend -I/usr/share/src/php-4.0.4pl1/Zend
-I/usr/share/src/php-4.0.4pl1/TSRM -I/usr/share/src/php-4.0.4pl1/TSRM
-I/usr/share/src/php-4.0.4pl1 -DUSE_EXPAT -I./lib/expat-lite `./apaci` modules.c
gcc -c  -I./os/unix -I./include   -DSOLARIS2=280 -I/usr/share/src/php-4.0.4pl1
-I/usr/share/src/php-4.0.4pl1/main -I/usr/share/src/php-4.0.4pl1/main
-I/usr/share/src/php-4.0.4pl1/Zend -I/usr/share/src/php-4.0.4pl1/Zend
-I/usr/share/src/php-4.0.4pl1/TSRM -I/usr/share/src/php-4.0.4pl1/TSRM
-I/usr/share/src/php-4.0.4pl1 -DUSE_EXPAT -I./lib/expat-lite `./apaci`
buildmark.c
gcc  -DSOLARIS2=280 -I/usr/share/src/php-4.0.4pl1
-I/usr/share/src/php-4.0.4pl1/main -I/usr/share/src/php-4.0.4pl1/main
-I/usr/share/src/php-4.0.4pl1/Zend -I/usr/share/src/php-4.0.4pl1/Zend
-I/usr/share/src/php-4.0.4pl1/TSRM -I/usr/share/src/php-4.0.4pl1/TSRM
-I/usr/share/src/php-4.0.4pl1 -DUSE_EXPAT -I./lib/expat-lite `./apaci`    \
      -o httpd buildmark.o modules.o  modules/php4/libphp4.a 
modules/python/libpython.a  modules/standard/libstandard.a  main/libmain.a 
./os/unix/libos.a  ap/libap.a  lib/expat-lite/libexpat.a  -R/usr/ucblib
-R/usr/local/lib/gcc-lib/sparc-sun-solaris2.8/2.95.2  -L/usr/ucblib
-L/usr/local/lib/gcc-lib/sparc-sun-solaris2.8/2.95.2 -Lmodules/php4
-L../modules/php4 -L../../modules/php4 -lmodphp4  -lpam  -ldl -lresolv -lresolv
-lm -ldl -lcrypt -lnsl -lsocket  -lsocket -lgcc   -lsocket -lnsl -ldl
Undefined                       first referenced
 symbol                             in file
PySequence_Index                    modules/python/libpython.a(mod_python.o)
Py_InitModule4                      modules/python/libpython.a(_apachemodule.o)
PyString_FromStringAndSize          modules/python/libpython.a(_apachemodule.o)
PyExc_TypeError                     modules/python/libpython.a(tableobject.o)
PyEval_RestoreThread                modules/python/libpython.a(mod_python.o)
PyCallable_Check                    modules/python/libpython.a(requestobject.o)
PyErr_BadArgument                   modules/python/libpython.a(_apachemodule.o)
Py_Finalize                         modules/python/libpython.a(mod_python.o)
Py_NewInterpreter                   modules/python/libpython.a(mod_python.o)
PyErr_Print                         modules/python/libpython.a(mod_python.o)
PyExc_IndexError                    modules/python/libpython.a(requestobject.o)
PyMember_Set                        modules/python/libpython.a(requestobject.o)
Py_FindMethod                       modules/python/libpython.a(requestobject.o)
PyExc_IOError                       modules/python/libpython.a(requestobject.o)
PyString_FromString                 modules/python/libpython.a(mod_python.o)
PyThreadState_Swap                  modules/python/libpython.a(mod_python.o)
PyType_Type                         modules/python/libpython.a(_apachemodule.o)
Py_BuildValue                       modules/python/libpython.a(_apachemodule.o)
PyErr_Occurred                      modules/python/libpython.a(mod_python.o)
PyString_AsString                   modules/python/libpython.a(mod_python.o)
PyList_SetItem                      modules/python/libpython.a(tableobject.o)
PyModule_GetDict                    modules/python/libpython.a(_apachemodule.o)
PyObject_CallMethod                 modules/python/libpython.a(mod_python.o)
PyList_Append                       modules/python/libpython.a(_apachemodule.o)
Py_IsInitialized                    modules/python/libpython.a(mod_python.o)
PyInt_Type                          modules/python/libpython.a(mod_python.o)
_Py_NoneStruct                      modules/python/libpython.a(_apachemodule.o)
PyExc_AttributeError                modules/python/libpython.a(requestobject.o)
PyObject_Str                        modules/python/libpython.a(mod_python.o)
PyArg_ParseTuple                    modules/python/libpython.a(_apachemodule.o)
PyExc_ValueError                    modules/python/libpython.a(requestobject.o)
PyErr_SetString                     modules/python/libpython.a(requestobject.o)
PyList_SetSlice                     modules/python/libpython.a(mod_python.o)
PyTuple_New                         modules/python/libpython.a(util.o)
PyEval_SaveThread                   modules/python/libpython.a(mod_python.o)
PyDict_SetItemString                modules/python/libpython.a(mod_python.o)
PyObject_HasAttrString              modules/python/libpython.a(serverobject.o)
PyDict_GetItem                      modules/python/libpython.a(_apachemodule.o)
PyMapping_HasKeyString              modules/python/libpython.a(_apachemodule.o)
PyCObject_FromVoidPtr               modules/python/libpython.a(mod_python.o)
PyString_ConcatAndDel               modules/python/libpython.a(tableobject.o)
PyErr_NewException                  modules/python/libpython.a(_apachemodule.o)
PyObject_GetAttrString              modules/python/libpython.a(mod_python.o)
PyList_New                          modules/python/libpython.a(_apachemodule.o)
Py_OptimizeFlag                     modules/python/libpython.a(mod_python.o)
PyDict_SetItem                      modules/python/libpython.a(_apachemodule.o)
PyExc_KeyError                      modules/python/libpython.a(tableobject.o)
PyDict_New                          modules/python/libpython.a(mod_python.o)
PyTuple_SetItem                     modules/python/libpython.a(util.o)
PyThreadState_New                   modules/python/libpython.a(mod_python.o)
PyErr_Clear                         modules/python/libpython.a(requestobject.o)
Py_GetVersion                       modules/python/libpython.a(mod_python.o)
PyMember_Get                        modules/python/libpython.a(requestobject.o)
PyInt_FromLong                      modules/python/libpython.a(requestobject.o)
PyDict_GetItemString                modules/python/libpython.a(mod_python.o)
PyCObject_AsVoidPtr                 modules/python/libpython.a(mod_python.o)
PyErr_NoMemory                      modules/python/libpython.a(requestobject.o)
PyInt_AsLong                        modules/python/libpython.a(mod_python.o)
PyList_Size                         modules/python/libpython.a(_apachemodule.o)
PyImport_ImportModule               modules/python/libpython.a(mod_python.o)
PyObject_CallFunction               modules/python/libpython.a(mod_python.o)
PyErr_Fetch                         modules/python/libpython.a(mod_python.o)
PyThreadState_Delete                modules/python/libpython.a(mod_python.o)
_PyString_Resize                    modules/python/libpython.a(_apachemodule.o)
Py_Initialize                       modules/python/libpython.a(mod_python.o)
PyErr_SetObject                     modules/python/libpython.a(requestobject.o)
PyString_Type                       modules/python/libpython.a(tableobject.o)
ld: fatal: Symbol referencing errors. No output written to httpd
collect2: ld returned 1 exit status
*** Error code 1
make: Fatal error: Command failed for target `target_static'
Current working directory /usr/share/src/apache_1.3.14/src
*** Error code 1
make: Fatal error: Command failed for target `build-std'
Current working directory /usr/share/src/apache_1.3.14
*** Error code 1
make: Fatal error: Command failed for target `build'


*** So I tried to install the DSO version, hoping that would be my hero.  But
this is what I get when compiling Mod_Python with the DSO support:


Compiling for DSO. For static, do "make static"

/usr/local/apachePHP/bin/apxs -I/usr/share/src/mod_python-2.7.2/src/include
-I/usr/local/apachePHP/include -I/usr/local/include/python1.5 -c mod_python.o 
_apachemodule.o  requestobject.o  tableobject.o  util.o  serverobject.o 
connobject.o -lm  /usr/local/lib/python1.5/config/libpython1.5.a   -lsocket
-lnsl -ldl    -lm
  -o mod_python.so mod_python.o _apachemodule.o requestobject.o tableobject.o
util.o serverobject.o connobject.o -lm
/usr/local/lib/python1.5/config/libpython1.5.a -lsocket -lnsl -ldl -lm 
apxs:Break: Command failed with rc=255
*** Error code 1
make: Fatal error: Command failed for target `mod_python.so'
Current working directory /usr/share/src/mod_python-2.7.2/src
*** Error code 1
make: Fatal error: Command failed for target `do_dso'

Please Help me!  I will give you any additional information that you request.  I
really want to use this module in Solaris!!!  Thanks in advance!

From joost.damad at siemens.atea.be  Thu Feb 15 15:07:34 2001
From: joost.damad at siemens.atea.be (Joost Yervante Damad)
Date: Fri Jan  9 21:52:16 2004
Subject: [mod_python] some issues
Message-ID: <20010215150733.A20391@siemens.atea.be>

Hello,

A friend of me discovered wierd bug in publisher :

def tst(req, arg='none', test='none', longname='none'):
        req._content_type_set = 0
        return "Arguments are '%s', '%s' and '%s'" % (arg, test, longname)

if we now do:

https://r2d2.iplab.atea.be:8081/py/test.py/tst?arg=x&test=y&longname=z

the result is:

Arguments are '', '' and 'z'

Aparently short names are not getting into the functions.
Long names are. Or is this caused by name clashes?

We tested this both with 2.7.1 and 2.7.2 on Solaris 2.6
with apache 1.3.14 with SSL and mod_python statically linked.

Another error I found:

The handling of _content_type_set seems to be broken.

publisher no longer functioned, bailin out at:

if not req._content_type_set:

giving an exeception stating that that variable was not found.

Removing that part and setting the content_type to
"text/html" is our current workaround.

Any thoughts?

Joost

P.S.: but we love mod_python :)

-- 
Joost Damad - Siemens ICN D NC A - +3214252297
--
Five is a sufficiently close approximation to infinity.
       -- Robert Firth
"One, two, five."
       -- Monty Python and the Holy Grail

From joost.damad at siemens.atea.be  Thu Feb 15 15:17:26 2001
From: joost.damad at siemens.atea.be (Joost Yervante Damad)
Date: Fri Jan  9 21:52:16 2004
Subject: [mod_python] Re: Mod_Python and Solaris Compile Problems
Message-ID: <20010215151726.A21817@siemens.atea.be>

I added a non-multithreaded libpython.a
to the directory of mod_python and
hacked the Makefile to force it to staticaly
link in that one.

Worked fine for me.

Joost

-- 
Joost Damad - Siemens ICN D NC A - +3214252297
--
Five is a sufficiently close approximation to infinity.
       -- Robert Firth
"One, two, five."
       -- Monty Python and the Holy Grail

From Zhu.James at iac.com.tw  Fri Feb 16 14:59:59 2001
From: Zhu.James at iac.com.tw (Zhu.James@iac.com.tw)
Date: Fri Jan  9 21:52:16 2004
Subject: [mod_python] How to install Python 2.7.2 on Windows NT
Message-ID: <939C21A81E55D311806D0008C759857F0117E18E@isc-mx1.isc.inventec>

Hi All,

   I an a newbie to python. I want to install Python 2.7.2 on my NT machine,
but i cannot find the windows installation guide. Can someone tell me how to
do it?
Thanks in advance.

Regards
James




-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010216/dafc01c5/attachment-0001.htm
From joost.damad at siemens.atea.be  Fri Feb 16 08:31:41 2001
From: joost.damad at siemens.atea.be (Joost Yervante Damad)
Date: Fri Jan  9 21:52:16 2004
Subject: [mod_python] some issues
In-Reply-To: <20010215150733.A20391@siemens.atea.be>; from joost.damad@siemens.atea.be on Thu, Feb 15, 2001 at 03:07:34PM +0100
References: <20010215150733.A20391@siemens.atea.be>
Message-ID: <20010216083141.A10720@siemens.atea.be>

'Joost Yervante Damad' wrote about '[mod_python] some issues' - Thu, Feb 15, 2001 at 03:07:34PM CET
> Hello,
> 
> A friend of me discovered wierd bug in publisher :
> 
> def tst(req, arg='none', test='none', longname='none'):
>         req._content_type_set = 0
>         return "Arguments are '%s', '%s' and '%s'" % (arg, test, longname)
> 
> if we now do:
> 
> https://r2d2.iplab.atea.be:8081/py/test.py/tst?arg=x&test=y&longname=z
> 
> the result is:
> 
> Arguments are '', '' and 'z'
> 
> Aparently short names are not getting into the functions.
> Long names are. Or is this caused by name clashes?
> 
> We tested this both with 2.7.1 and 2.7.2 on Solaris 2.6
> with apache 1.3.14 with SSL and mod_python statically linked.
> 
> Another error I found:
> 
> The handling of _content_type_set seems to be broken.
> 
> publisher no longer functioned, bailin out at:
> 
> if not req._content_type_set:
> 
> giving an exeception stating that that variable was not found.
> 
> Removing that part and setting the content_type to
> "text/html" is our current workaround.
> 
> Any thoughts?
> 

After careful examining we found that somehow 2.7.1 and 2.7.2
got mixed during our building, causing the _content_type_set
breakage. Sorry for that bad intel.

The other problem (short params) remains though.

-- 
Joost Damad - Siemens ICN D NC A - +3214252297
--
Five is a sufficiently close approximation to infinity.
       -- Robert Firth
"One, two, five."
       -- Monty Python and the Holy Grail

From Christian.Vergnaud at hcuge.ch  Tue Feb 20 18:33:02 2001
From: Christian.Vergnaud at hcuge.ch (Christian VERGNAUD)
Date: Fri Jan  9 21:52:16 2004
Subject: [mod_python] Can't locate API module structure `mod_python'
Message-ID: <sa92b870.002@diogenes.hcuge.ch>

I get the following message when I start httpd :
Can't locate API module structure `mod_python' in file /home/Impact/orbix/apache/libexec/mod_python.so: ld.so.1: /home/Impact/orbix/apache/bin/httpd: fatal: mod_python: can't find symbol

OS vesrion: SunOS 5.6, python2.0, Apache 1.3.17, mod_python 2.7.2

I don't know if it's related or not but when installing mod_python, I had to force the library libgcc.a in the Makefile of the src directory in order to avoid unsatisfied entry points (__eprintf for instance) problems.

I'm now stuck and have no idea of what to do. Can someone help?

Thanks


From grisha at verio.net  Tue Feb 20 13:25:39 2001
From: grisha at verio.net (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:16 2004
Subject: [mod_python] Can't locate API module structure `mod_python'
In-Reply-To: <sa92b870.002@diogenes.hcuge.ch>
Message-ID: <Pine.BSF.4.32.0102201325010.20282-100000@localhost>

I believe someone else was reporting a similar issue and they resolved by
compiling python separately without threads.

Grisha

On Tue, 20 Feb 2001, Christian VERGNAUD wrote:

>
> I get the following message when I start httpd :
> Can't locate API module structure `mod_python' in file /home/Impact/orbix/apache/libexec/mod_python.so: ld.so.1: /home/Impact/orbix/apache/bin/httpd: fatal: mod_python: can't find symbol
>
> OS vesrion: SunOS 5.6, python2.0, Apache 1.3.17, mod_python 2.7.2
>
> I don't know if it's related or not but when installing mod_python, I had to force the library libgcc.a in the Makefile of the src directory in order to avoid unsatisfied entry points (__eprintf for instance) problems.
>
> I'm now stuck and have no idea of what to do. Can someone help?
>
> Thanks
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From brett at bookshop.unsw.edu.au  Wed Feb 21 11:33:11 2001
From: brett at bookshop.unsw.edu.au (Brett Haydon)
Date: Fri Jan  9 21:52:16 2004
Subject: [mod_python] Windows version of 2.7.2
Message-ID: <NCBBKMABOKFCDLPIKKGICELMCJAA.brett@bookshop.unsw.edu.au>

I know others have asked but:

Is the modpython dll being recompiled for 2.7.2 for win?

The new modpublisher module looks at the req._content_type_set
attribute which appears not to be in the dll for 2.7.1

regards,
______________________________________________
Brett Haydon


From joost.damad at siemens.atea.be  Wed Feb 21 10:23:46 2001
From: joost.damad at siemens.atea.be (Joost Yervante Damad)
Date: Fri Jan  9 21:52:16 2004
Subject: [mod_python] mod_python/publisher/solaris truncation problems
Message-ID: <20010221102346.A15890@siemens.atea.be>

Hi!

A while ago I send a mail reporting a bug stating that
cgi attribute/value pairs get truncated in our Solaris 2.6
apachessl with latest mod_python, when xxx=yyy total
length smaller then 8 bytes.

It seems to be related to the python/C interfacing...
and it also looks like a 32bit/64bit alike problem.
Anyway, we (I and a colleage) found the following workaround,
basically eliminating some of the Python/C interface calls
from the function "parse_qsl" in
_apachemodule.c

Note that this seems to be a Solaris only problem since
we did not have it on Linux.

Attached is a modified _apachemodule.c with a
working, but probably not the best...fix.
But at least it works for us, and we don't need the
performance.

Any thoughts on this?

Thanks,

-- 
Joost Damad - Siemens IC D NC A - +3214252297
--
Five is a sufficiently close approximation to infinity.
       -- Robert Firth
"One, two, five."
       -- Monty Python and the Holy Grail

From joost.damad at siemens.atea.be  Wed Feb 21 10:29:39 2001
From: joost.damad at siemens.atea.be (Joost Yervante Damad)
Date: Fri Jan  9 21:52:16 2004
Subject: [mod_python] mod_python/publisher/solaris truncation problems
In-Reply-To: <20010221102346.A15890@siemens.atea.be>; from joost.damad@siemens.atea.be on Wed, Feb 21, 2001 at 10:23:46AM +0100
References: <20010221102346.A15890@siemens.atea.be>
Message-ID: <20010221102939.A16904@siemens.atea.be>

'Joost Yervante Damad' wrote about '[mod_python] mod_python/publisher/solaris truncation problems' - Wed, Feb 21, 2001 at 10:23:46AM CET
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

<forgot the attachment...>

-- 
Joost Damad - Siemens IC D NC A - +3214252297
--
Five is a sufficiently close approximation to infinity.
       -- Robert Firth
"One, two, five."
       -- Monty Python and the Holy Grail
-------------- next part --------------
A non-text attachment was scrubbed...
Name: _apachemodule.c
Type: text/x-csrc
Size: 10218 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20010221/52c70a09/_apachemodule-0001.bin
From grisha at verio.net  Wed Feb 21 10:25:01 2001
From: grisha at verio.net (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:16 2004
Subject: [mod_python] mod_python/publisher/solaris truncation problems
In-Reply-To: <20010221102346.A15890@siemens.atea.be>
Message-ID: <Pine.BSF.4.32.0102211023480.30708-100000@localhost>

Interesting... I'll have to look into this. It makes sense, since Solaris
is a 64 bit OS whereas Linux on i386 is 32 bit. I haven't done much
Solaris testing, I guess I'll have to do more.

Grisha

On Wed, 21 Feb 2001, Joost Yervante Damad wrote:

> Hi!
>
> A while ago I send a mail reporting a bug stating that
> cgi attribute/value pairs get truncated in our Solaris 2.6
> apachessl with latest mod_python, when xxx=yyy total
> length smaller then 8 bytes.
>
> It seems to be related to the python/C interfacing...
> and it also looks like a 32bit/64bit alike problem.
> Anyway, we (I and a colleage) found the following workaround,
> basically eliminating some of the Python/C interface calls
> from the function "parse_qsl" in
> _apachemodule.c
>
> Note that this seems to be a Solaris only problem since
> we did not have it on Linux.
>
> Attached is a modified _apachemodule.c with a
> working, but probably not the best...fix.
> But at least it works for us, and we don't need the
> performance.
>
> Any thoughts on this?
>
> Thanks,
>
> --
> Joost Damad - Siemens IC D NC A - +3214252297
> --
> Five is a sufficiently close approximation to infinity.
>        -- Robert Firth
> "One, two, five."
>        -- Monty Python and the Holy Grail
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From petar at metamarkets.com  Wed Feb 21 12:08:07 2001
From: petar at metamarkets.com (Petar Karafezov)
Date: Fri Jan  9 21:52:16 2004
Subject: [mod_python] mod_python2.7.2 and server redirects
Message-ID: <86FC34EA3C4F074AA6BBFFE52ED83FED27BDA3@METAEXCH.sfo.metamarkets.com>

hello all -

let me fist say that I love mod_python - works great - much faster than any
cgi! Thanks, Grisha! 

I am seeing some weirdness when working with server redirects - I'm simply
trying to catch the headers from the server, modify the location key and
then send it to the client. It work ok under the CGI, but when I see the
headers that my .py reports when accessed with lynx -mime_header option
(which simply prints the headers and body and exits) instead of HTTP/1.1 302
Found, I see HTTP/1.1 200 OK. I am not sure why this is happening.. Any
ideas ??

Regards,
Petar Karafezov

MetaMarkets.com
415-575-3015
-------------------------------------------
Investing Out Loud at
http://www.metamarkets.com
-------------------------------------------

From brent at rcfile.org  Wed Feb 21 16:17:38 2001
From: brent at rcfile.org (Brent Verner)
Date: Fri Jan  9 21:52:16 2004
Subject: [mod_python] mod_python2.7.2 and server redirects
In-Reply-To: <86FC34EA3C4F074AA6BBFFE52ED83FED27BDA3@METAEXCH.sfo.metamarkets.com>; from petar@metamarkets.com on Wed, Feb 21, 2001 at 12:08:07PM -0800
References: <86FC34EA3C4F074AA6BBFFE52ED83FED27BDA3@METAEXCH.sfo.metamarkets.com>
Message-ID: <20010221161738.A9355@rcfile.org>

On 21 Feb 2001 at 12:08 (-0800), Petar Karafezov wrote:
| hello all -
| 
| let me fist say that I love mod_python - works great - much faster than any
| cgi! Thanks, Grisha! 
| 
| I am seeing some weirdness when working with server redirects - I'm simply
| trying to catch the headers from the server, modify the location key and
| then send it to the client. It work ok under the CGI, but when I see the
| headers that my .py reports when accessed with lynx -mime_header option
| (which simply prints the headers and body and exits) instead of HTTP/1.1 302
| Found, I see HTTP/1.1 200 OK. I am not sure why this is happening.. Any
| ideas ??

this faq entry may help.

http://www.modpython.org/FAQ/faqw.py?req=show&file=faq03.002.htp

  brent

-- 
"We want to help, but we wouldn't want to deprive you of a valuable 
learning experience."
                                          http://openbsd.org/mail.html

From joost.damad at siemens.atea.be  Thu Feb 22 08:09:37 2001
From: joost.damad at siemens.atea.be (Joost Yervante Damad)
Date: Fri Jan  9 21:52:16 2004
Subject: [mod_python] mod_python/publisher/solaris truncation problems
In-Reply-To: <3A93D1D5.45555DBB@caveosystems.com>; from rsalz@caveosystems.com on Wed, Feb 21, 2001 at 09:33:57AM -0500
References: <20010221102346.A15890@siemens.atea.be> <20010221102939.A16904@siemens.atea.be> <3A93D1D5.45555DBB@caveosystems.com>
Message-ID: <20010222080937.A27533@siemens.atea.be>

'Rich Salz' wrote about 'Re: [mod_python] mod_python/publisher/solaris truncation problems' - Wed, Feb 21, 2001 at 03:33:57PM CET
> a diff would be more useful. ...

True... but the changes I made are not really meant as a
solution. They merely show how we solved it to have a workable
mod_python. I can get you a diff if you want. (see attachment)
It's not a very usefull diff imho tho :)

-- 
Joost Damad - Siemens IC D NC A - +3214252297
--
Five is a sufficiently close approximation to infinity.
       -- Robert Firth
"One, two, five."
       -- Monty Python and the Holy Grail
-------------- next part --------------
--- mod_python-2.7.2/src/_apachemodule.c	Mon Dec 18 20:50:03 2000
+++ ../delta/changed_src/_apachemodule.c	Wed Feb 21 10:15:03 2001
@@ -48,10 +48,14 @@
  *
  */
 
 #include "mod_python.h"
 
+#ifdef ATEA_DEBUG
+#undef ATEA_DEBUG
+#endif
+ 
 /** 
  ** log_error
  **
  *  A wrpapper to ap_log_error
  * 
@@ -253,11 +257,11 @@
 static PyObject *parse_qsl(PyObject *self, PyObject *args)
 {
 
     PyObject *pairs;
     int i, len;
-    char *qs;
+    char *qs, *cpair;
     int keep_blank_values = 0;
     int strict_parsing = 0; /* XXX not implemented */
 
     if (! PyArg_ParseTuple(args, "s|ii", &qs, &keep_blank_values, 
 			   &strict_parsing)) 
@@ -269,83 +273,131 @@
 	return NULL;
 
     i = 0;
     len = strlen(qs);
 
+	cpair=calloc(1,len);
+	
     while (i < len) {
 
-	PyObject *pair, *key, *val;
-	char *cpair, *ckey, *cval;
+	/*PyObject *pair, *key, *val;*/
+	PyObject *key, *val;
+	/*char *cpair, *ckey, *cval;*/
+	char *ckey, *cval;
 	int plen, j, p, k, v;
 
-	pair = PyString_FromStringAndSize(NULL, len);
+	/* pair = PyString_FromStringAndSize(NULL, len);
 	if (pair == NULL)
-	    return NULL;
+	    return NULL;*/
 
 	/* split by '&' or ';' */
-	cpair = PyString_AS_STRING(pair);
+	/*cpair = PyString_AS_STRING(pair);
+	  cpair=calloc(1,len);*/
+#ifdef ATEA_DEBUG
+	fprintf(stderr, "all pairs: %s\n", cpair);
+#endif
 	j = 0;
 	while ((qs[i] != '&') && (qs[i] != ';') && (i < len)) {
 	    /* replace '+' with ' ' */
 	    cpair[j] = (qs[i] == '+') ? ' ' : qs[i];
 	    i++;
 	    j++;
 	}
 	cpair[j] = '\0';
-	_PyString_Resize(&pair, j);
+	/*_PyString_Resize(&pair, j);*/
 
 	/* split the "abc=def" pair */
-
+#ifdef ATEA_DEBUG
+	fprintf(stderr,"[foo] cpair == %s\n", cpair);
+#endif
 	plen = strlen(cpair);
-	key = PyString_FromStringAndSize(NULL, plen);
-	if (key == NULL) 
-	    return NULL;
-	val = PyString_FromStringAndSize(NULL, plen);
-	if (val == NULL) 
-	    return NULL;
-
-	ckey = PyString_AS_STRING(key);
-	cval = PyString_AS_STRING(val);
+#ifdef ATEA_DEBUG
+	fprintf(stderr,"plen == %d\n", plen);
+#endif
+	/*key = PyString_FromStringAndSize(NULL, plen);
+	  if (key == NULL)
+	      return NULL;
+	  val = PyString_FromStringAndSize(NULL, plen);
+	  if (val == NULL)
+	      return NULL;*/
 
+	/*ckey = PyString_AS_STRING(key);
+	  cval = PyString_AS_STRING(val);*/
+	
+	ckey = calloc(1,plen);
+	cval = calloc(1,plen);
+	/*memset(ckey,0,plen);
+	  memset(cval,0,plen);*/
+#ifdef ATEA_DEBUG
+	fprintf(stderr,"ckey=%s, cval=%s (should be empty)\n", ckey, cval);
+#endif
+	
 	p = 0;
 	k = 0;
 	v = 0;
 	while (p < plen) {
-	    if (cpair[p] != '=') {
-		ckey[k] = cpair[p];
-		k++;
-		p++;
+	    if (cpair[p] != '=')
+		{
+#ifdef ATEA_DEBUG
+			fprintf(stderr,"%d cpair=%s ckey=%s, cval=%s (parsing before '=')\n", p, cpair, ckey, cval);
+#endif
+			ckey[k] = cpair[p];
+			k++;
+			p++;
 	    }
 	    else {
-		p++;      /* skip '=' */
-		while (p < plen) {
-		    cval[v] = cpair[p];
-		    v++;
-		    p++;
-		}
+			p++;      /* skip '=' */
+#ifdef ATEA_DEBUG
+			fprintf(stderr, ">>> entering else branch...\n");
+#endif
+			while (p < plen)
+			{
+#ifdef ATEA_DEBUG
+				fprintf(stderr,"%d cpair=%s ckey=%s, cval=%s (parsing after '=')\n", p, cpair, ckey, cval);
+#endif
+		    	cval[v] = cpair[p];
+		    	v++;
+		    	p++;
+			}
 	    }
 	}
 	ckey[k] = '\0';
 	cval[v] = '\0';
+#ifdef ATEA_DEBUG
+	fprintf(stderr,"ckey=%s, cval=%s\n (final)", ckey, cval);
+#endif
 
 	if (keep_blank_values || (v > 0)) {
 
 	    ap_unescape_url(ckey);
 	    ap_unescape_url(cval);
 
-	    _PyString_Resize(&key, strlen(ckey));
-	    _PyString_Resize(&val, strlen(cval));
+	    /*_PyString_Resize(&key, strlen(ckey));
+	      _PyString_Resize(&val, strlen(cval));*/
 
+		key = PyString_FromStringAndSize(ckey, strlen(ckey));
+		if (key == NULL) {
+		  	free(ckey); free(cval); free(cpair);
+	    	return NULL;
+		}
+		val = PyString_FromStringAndSize(cval, strlen(cval));
+		if (val == NULL) {
+		  	free(ckey); free(cval); free(cpair);
+		    return NULL;
+		}
+		
 	    PyList_Append(pairs, Py_BuildValue("(O,O)", key, val));
 
 	}
-	Py_DECREF(pair);
+	/*Py_DECREF(pair);*/
 	Py_DECREF(key);
 	Py_DECREF(val);
 	i++;
+	free(ckey);
+	free(cval);
     }
-
+	free(cpair);
     return pairs;
 }
 
 
 /* methods of _apache */
From r.fortnagel at 21torr.com  Thu Feb 22 11:41:01 2001
From: r.fortnagel at 21torr.com (Ralf Fortnagel)
Date: Fri Jan  9 21:52:16 2004
Subject: [mod_python] Problem to run .py scripts thru apache
Message-ID: <NEBBJGBIKKHHFMNEPEKKKEHMCAAA.r.fortnagel@21torr.com>

Hi Folks!

I use Apache/1.3.14 (Win32) mod_python/2.7.1 Python/2.0 on a Win/NT4.0
machine
If i try to start any .py file thru apache, i get following error:

Mod_python error: "PythonHandler test"
Traceback (most recent call last):
  File "c:\programme\python20\lib\mod_python\apache.py", line 180, in
Dispatch
    object = resolve_object(self.req, module, object_str, silent)
  File "c:\programme\python20\lib\mod_python\apache.py", line 396, in
resolve_object
    raise AttributeError, s
AttributeError: module 'c:\programme\python20\lib\test\__init__.py' contains
no 'handler'

please help me, i don't know what's wrong... :(
--
Ralf Fortnagel                21TORR AGENCY gmbh
r.fortnagel@21torr.com        Engineering
tel: +49-7121-348-221         Heinestrasse 72
fax: +49-7121-348-259         D-72762 Reutlignen

21TORR - die neue medien leidenschaft
www.21torr.com


From joost.damad at siemens.atea.be  Thu Feb 22 11:55:49 2001
From: joost.damad at siemens.atea.be (Joost Yervante Damad)
Date: Fri Jan  9 21:52:16 2004
Subject: [mod_python] Problem to run .py scripts thru apache
In-Reply-To: <NEBBJGBIKKHHFMNEPEKKKEHMCAAA.r.fortnagel@21torr.com>; from r.fortnagel@21torr.com on Thu, Feb 22, 2001 at 11:41:01AM +0100
References: <NEBBJGBIKKHHFMNEPEKKKEHMCAAA.r.fortnagel@21torr.com>
Message-ID: <20010222115549.A27399@siemens.atea.be>

'Ralf Fortnagel' wrote about '[mod_python] Problem to run .py scripts thru apache' - Thu, Feb 22, 2001 at 11:41:01AM CET
> Hi Folks!
>
> I use Apache/1.3.14 (Win32) mod_python/2.7.1 Python/2.0 on a Win/NT4.0
> machine
> If i try to start any .py file thru apache, i get following error:
>
> Mod_python error: "PythonHandler test"
> Traceback (most recent call last):
>   File "c:\programme\python20\lib\mod_python\apache.py", line 180, in
> Dispatch
>     object = resolve_object(self.req, module, object_str, silent)
>   File "c:\programme\python20\lib\mod_python\apache.py", line 396, in
> resolve_object
>     raise AttributeError, s
> AttributeError: module 'c:\programme\python20\lib\test\__init__.py' contains
> no 'handler'
>
> please help me, i don't know what's wrong... :(
> --
> Ralf Fortnagel                21TORR AGENCY gmbh
> r.fortnagel@21torr.com        Engineering
> tel: +49-7121-348-221         Heinestrasse 72
> fax: +49-7121-348-259         D-72762 Reutlignen
> 
> 21TORR - die neue medien leidenschaft
> www.21torr.com
> 

I asume you have in your apache config file:

PythonHandler test

This means that mod_python needs to look for a pythonscript called 'test'.

But :) In your Pythonpath you also have the dir c:\programme\python20\lib\
and the directory c:\programme\python20\lib\test\ matches your handler.

Python then looks for an __init__.py to 'execute' the directory as a
pythonscript, and this is obviously not what you want.

Joost

-- 
Joost Damad - Siemens IC D NC A - +3214252297
--
Five is a sufficiently close approximation to infinity.
       -- Robert Firth
"One, two, five."
       -- Monty Python and the Holy Grail

From brianh at exelixis.com  Thu Feb 22 20:11:38 2001
From: brianh at exelixis.com (Brian Hawthorne)
Date: Fri Jan  9 21:52:16 2004
Subject: [mod_python] Stackless python
Message-ID: <Pine.GSO.4.05.10102222009490.13571-100000@timeless.exelixis.com>

i wonder, 
has anyone embedded stackless python in apache using mod_python?

brian


From ensim.ml.mod_python at ensim.com  Thu Feb 22 22:41:45 2001
From: ensim.ml.mod_python at ensim.com (Ensim-Newsgroups.Mailing-Lists.Mod_Python-List)
Date: Fri Jan  9 21:52:16 2004
Subject: [mod_python] browser connection state
Message-ID: <9AC41B8C4781464695BB013F106FCA3181A5A5@nasdaq.ms.ensim.com>

is there a way in mod python to check whether the browser connection has
been aborted?  ie, given a single request, before writing each chunk of
response data to the browser, can we check whether the browser user pressed
the stop button (or pressed escape).

From miguel at yorku.ca  Fri Feb 23 08:40:13 2001
From: miguel at yorku.ca (Miguel Marques)
Date: Fri Jan  9 21:52:16 2004
Subject: [mod_python] browser connection state
In-Reply-To: <9AC41B8C4781464695BB013F106FCA3181A5A5@nasdaq.ms.ensim.com>
References: <9AC41B8C4781464695BB013F106FCA3181A5A5@nasdaq.ms.ensim.com>
Message-ID: <20010223084013J.miguel@yorku.ca>

Greetings...
On Thu, 22 Feb 2001 22:41:45 -0800, "Ensim-Newsgroups.Mailing-Lists.Mod_Python-List" <ensim.ml.mod_python@ensim.com> wrote:
> is there a way in mod python to check whether the browser connection has
> been aborted?  ie, given a single request, before writing each chunk of
> response data to the browser, can we check whether the browser user pressed
> the stop button (or pressed escape).
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

If the browser goes away for any reason (stop, reload, etc) and you
try to write to the client, you get an IOError exception which you can
catch.  

I usually have req.write(" ")'s just before database writes and the
such to try and cause this exception to be thrown so I can clean up
and exit and not do anything.

						      Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830

From sergio at royalwebhosting.com  Fri Feb 23 15:39:41 2001
From: sergio at royalwebhosting.com (Sergio Baca)
Date: Fri Jan  9 21:52:16 2004
Subject: [mod_python] mod_python vs java servlets
Message-ID: <157254279584.20010223153941@royalwebhosting.com>

Hello mod,

  How is comparable mod_python with java servlets? Because using
  JPython comparison can be easy made, have anybody thought about
  this?

-- 
Best regards,
 Sergio                          mailto:sergio@royalwebhosting.com



From naris at ensim.com  Fri Feb 23 11:00:39 2001
From: naris at ensim.com (Naris Siamwalla)
Date: Fri Jan  9 21:52:16 2004
Subject: [mod_python] browser connection state
Message-ID: <9AC41B8C4781464695BB013F106FCA3181A5AA@nasdaq.ms.ensim.com>

catching the IOError exception is fine, but can i assume for -*all*- IOError
exceptions thrown when i req.write was because of a stop/reload?  could an
IOError be thrown for other reasons (e.g. apache itself causing mod_python
to throw the IOError exception) ?  if there are no other reaons, then i
guess it's safe to write a try block that assumes so.

-----Original Message-----
From: Miguel Marques [mailto:miguel@yorku.ca]
Sent: Friday, February 23, 2001 5:40 AM
To: ensim.ml.mod_python@ensim.com
Cc: mod_python@modpython.org
Subject: Re: [mod_python] browser connection state


Greetings...
On Thu, 22 Feb 2001 22:41:45 -0800,
"Ensim-Newsgroups.Mailing-Lists.Mod_Python-List"
<ensim.ml.mod_python@ensim.com> wrote:
> is there a way in mod python to check whether the browser connection has
> been aborted?  ie, given a single request, before writing each chunk of
> response data to the browser, can we check whether the browser user
pressed
> the stop button (or pressed escape).
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

If the browser goes away for any reason (stop, reload, etc) and you
try to write to the client, you get an IOError exception which you can
catch.  

I usually have req.write(" ")'s just before database writes and the
such to try and cause this exception to be thrown so I can clean up
and exit and not do anything.

						      Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python

From ensim.ml.mod_python at ensim.com  Fri Feb 23 11:36:51 2001
From: ensim.ml.mod_python at ensim.com (Ensim-Newsgroups.Mailing-Lists.Mod_Python-List)
Date: Fri Jan  9 21:52:16 2004
Subject: [mod_python] browser connection state
Message-ID: <9AC41B8C4781464695BB013F106FCA3181A5AC@nasdaq.ms.ensim.com>

catching the IOError exception is fine, but can i assume for -*all*- IOError
exceptions thrown when i req.write was because of a stop/reload?  could an
IOError be thrown for other reasons (e.g. apache itself causing mod_python
to throw the IOError exception) ?  if there are no other reaons, then i
guess it's safe to write a try block that assumes so.

-----Original Message-----
From: Miguel Marques [mailto:miguel@yorku.ca]
Sent: Friday, February 23, 2001 5:40 AM
To: ensim.ml.mod_python@ensim.com
Cc: mod_python@modpython.org
Subject: Re: [mod_python] browser connection state


Greetings...
On Thu, 22 Feb 2001 22:41:45 -0800,
"Ensim-Newsgroups.Mailing-Lists.Mod_Python-List"
<ensim.ml.mod_python@ensim.com> wrote:
> is there a way in mod python to check whether the browser connection has
> been aborted?  ie, given a single request, before writing each chunk of
> response data to the browser, can we check whether the browser user
pressed
> the stop button (or pressed escape).
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

If the browser goes away for any reason (stop, reload, etc) and you
try to write to the client, you get an IOError exception which you can
catch.  

I usually have req.write(" ")'s just before database writes and the
such to try and cause this exception to be thrown so I can clean up
and exit and not do anything.

						      Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python

From miguel at yorku.ca  Fri Feb 23 14:40:04 2001
From: miguel at yorku.ca (Miguel Marques)
Date: Fri Jan  9 21:52:16 2004
Subject: [mod_python] browser connection state
In-Reply-To: <9AC41B8C4781464695BB013F106FCA3181A5AA@nasdaq.ms.ensim.com>
References: <9AC41B8C4781464695BB013F106FCA3181A5AA@nasdaq.ms.ensim.com>
Message-ID: <20010223144004T.miguel@yorku.ca>

On Fri, 23 Feb 2001 11:00:39 -0800, Naris Siamwalla <naris@ensim.com> wrote:
> catching the IOError exception is fine, but can i assume for -*all*- IOError
> exceptions thrown when i req.write was because of a stop/reload?  could an
> IOError be thrown for other reasons (e.g. apache itself causing mod_python
> to throw the IOError exception) ?  if there are no other reaons, then i
> guess it's safe to write a try block that assumes so.

Gregory would better be able to answer that than me.  
I'm just a mod_python user...

However, IMHO, even if the IOError error happens inside of apache or
for some other reason, it means you lost the connection to the browser and
therefore that you won't be able to send a response to the user.
In that case you probably should abort whatever the user requested
since s/he will probably assume it didn't work since no page got sent
back.  Or am I missing the point?

       						Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830


From ensim.ml.mod_python at ensim.com  Fri Feb 23 11:49:34 2001
From: ensim.ml.mod_python at ensim.com (Ensim-Newsgroups.Mailing-Lists.Mod_Python-List)
Date: Fri Jan  9 21:52:16 2004
Subject: [mod_python] browser connection state
Message-ID: <9AC41B8C4781464695BB013F106FCA3181A5AE@nasdaq.ms.ensim.com>

you're right....i guess i'm over-analyzing :-)

IOError raised during req.write means you had a problem writing, plain and
simple.  and if you had a problem writing, your python code should handle it
accordingly.

-----Original Message-----
From: Miguel Marques [mailto:miguel@yorku.ca]
Sent: Friday, February 23, 2001 11:40 AM
To: naris@ensim.com
Cc: mod_python@modpython.org
Subject: Re: RE: [mod_python] browser connection state


On Fri, 23 Feb 2001 11:00:39 -0800, Naris Siamwalla <naris@ensim.com> wrote:
> catching the IOError exception is fine, but can i assume for -*all*-
IOError
> exceptions thrown when i req.write was because of a stop/reload?  could an
> IOError be thrown for other reasons (e.g. apache itself causing mod_python
> to throw the IOError exception) ?  if there are no other reaons, then i
> guess it's safe to write a try block that assumes so.

Gregory would better be able to answer that than me.  
I'm just a mod_python user...

However, IMHO, even if the IOError error happens inside of apache or
for some other reason, it means you lost the connection to the browser and
therefore that you won't be able to send a response to the user.
In that case you probably should abort whatever the user requested
since s/he will probably assume it didn't work since no page got sent
back.  Or am I missing the point?

       						Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830

From rbeer at uni-goettingen.de  Sat Feb 24 18:53:30 2001
From: rbeer at uni-goettingen.de (Ragnar Beer)
Date: Fri Jan  9 21:52:16 2004
Subject: [mod_python] Apache children RAM use
Message-ID: <p04330104b6bda4a03c43@[134.76.136.114]>

Howdy!

I'm absolutely new to mod_python and I wonder what happens to the 
memory use of apache children when mod_python is compiled in. Coming 
from mod_perl I'm expecting the worst. How about mod_python?

Ragnar Beer

From gege at china.com  Mon Feb 26 23:04:33 2001
From: gege at china.com (gege@china.com)
Date: Fri Jan  9 21:52:16 2004
Subject: [mod_python] help
Message-ID: <8z989773769566.05317@mail2.china.com>

 under windows 98 apache 1.3.17

I copy mod_python.dll to /apache/modules

copy mod_python to c:\python20\lib

add row LoadModule python_module modules/mod_python.dll to httpd.conf

add 

<Directory "C:/Apache/htdocs/python">
    AddHandler python-program .py
    PythonHandler mptest
    PythonDebug On
</Directory>

to httpd.conf too.

then restart apache. when i enter http://localhost/python, i can see mptest.py.

but when i click mptest.py, the browser tells me

Internal Server Error
The server encountered an internal error or misconfiguration and was unable to complete your request.

what happens?

error.log looks like:

[Mon Feb 26 15:50:18 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
'import site' failed; use -v for traceback
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
Apache server shutdown initiated...
'import site' failed; use -v for traceback
'import site' failed; use -v for traceback
[Mon Feb 26 20:26:18 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:37 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:39 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:40 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:41 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:41 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:41 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:42 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:42 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:42 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:42 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:42 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:43 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:43 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:43:04 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:44:42 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:46:02 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
'import site' failed; use -v for traceback
'import site' failed; use -v for traceback
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
'import site' failed; use -v for traceback
[Mon Feb 26 20:57:49 2001] [error] [

************************************

http://hospital.china.com/

http://lovesky.china.com

From petar at metamarkets.com  Mon Feb 26 11:03:33 2001
From: petar at metamarkets.com (Petar Karafezov)
Date: Fri Jan  9 21:52:17 2004
Subject: [mod_python] RE: my_file.pyc is not created anymore ...what changed ?
Message-ID: <86FC34EA3C4F074AA6BBFFE52ED83FED27BDBC@METAEXCH.sfo.metamarkets.com>

Hello all -

I was going through a lot of reconfiguration of my apache+mod_python setup,
including migrating it to different server and it seems that somewhere in
all changes made I have "lost" the .pyc files functionality. Before I'd see
a .pyc file being created after mod_python would process my .py handlers.
According to the docs - it would not recompile again if the .py file doesn't
get changed and just use the pre-compiled byte code.

I did a fresh install of apache and mod_python 2.7.2 both with python 1.5.2
(the standard RPm that comes with RH6.2) and with compiled from source
Python2.0 - and I still don't see the .pyc iles created. Any ideas ??

Thanks all for your help!

Regards,
Petar Karafezov

From gege at china.com  Tue Feb 27 03:26:18 2001
From: gege at china.com (gege@china.com)
Date: Fri Jan  9 21:52:17 2004
Subject: [mod_python] what's happen?
Message-ID: <Di989772967381.12116@mail3.china.com>

under redhat 6.2 python 2.1a2 mod_python 2.7.2 apache 1.3.12

lynx http://localhost/python/mptest.py

it appears Hello World!

but when I type lynx http://localhost/python/test.py or some other filename.py

it also appears Hello World!

I don't understand...

from other client by using IE, it gives the same result.
************************************

http://hospital.china.com/

http://lovesky.china.com

From gege at china.com  Tue Feb 27 03:25:48 2001
From: gege at china.com (gege@china.com)
Date: Fri Jan  9 21:52:17 2004
Subject: [mod_python] what's happen?
Message-ID: <Ac989772967451.24452@mail3.china.com>

under redhat 6.2 python 2.1a2 mod_python 2.7.2 apache 1.3.12

lynx http://localhost/python/mptest.py

it appears Hello World!

but when I type lynx http://localhost/python/test.py or some other filename.py

it also appears Hello World!

I don't understand...

from other client by using IE, it gives the same result.
************************************

http://hospital.china.com/

http://lovesky.china.com

From gege at china.com  Tue Feb 27 03:25:18 2001
From: gege at china.com (gege@china.com)
Date: Fri Jan  9 21:52:17 2004
Subject: [mod_python] what's happen?
Message-ID: <EJ989772967481.12100@mail3.china.com>

under redhat 6.2 python 2.1a2 mod_python 2.7.2 apache 1.3.12

lynx http://localhost/python/mptest.py

it appears Hello World!

but when I type lynx http://localhost/python/test.py or some other filename.py

it also appears Hello World!

I don't understand...

from other client by using IE, it gives the same result.
************************************

http://hospital.china.com/

http://lovesky.china.com

From brent at rcfile.org  Mon Feb 26 14:34:16 2001
From: brent at rcfile.org (Brent Verner)
Date: Fri Jan  9 21:52:17 2004
Subject: [mod_python] RE: my_file.pyc is not created anymore ...what changed ?
In-Reply-To: <86FC34EA3C4F074AA6BBFFE52ED83FED27BDBC@METAEXCH.sfo.metamarkets.com>; from petar@metamarkets.com on Mon, Feb 26, 2001 at 11:03:33AM -0800
References: <86FC34EA3C4F074AA6BBFFE52ED83FED27BDBC@METAEXCH.sfo.metamarkets.com>
Message-ID: <20010226143416.A53686@rcfile.org>

On 26 Feb 2001 at 11:03 (-0800), Petar Karafezov wrote:
| Hello all -
| 
| I was going through a lot of reconfiguration of my apache+mod_python setup,
| including migrating it to different server and it seems that somewhere in
| all changes made I have "lost" the .pyc files functionality. Before I'd see
| a .pyc file being created after mod_python would process my .py handlers.
| According to the docs - it would not recompile again if the .py file doesn't
| get changed and just use the pre-compiled byte code.
| 
| I did a fresh install of apache and mod_python 2.7.2 both with python 1.5.2
| (the standard RPm that comes with RH6.2) and with compiled from source
| Python2.0 - and I still don't see the .pyc iles created. Any ideas ??

perhaps the directory where your .py files (and the desired .pyc) files
live is not writable by the user the web server is running as? I've found
it very useful to create a new group, add myself and the web server user
to that group, then own the python web directories to that group and chmod
it g+w.

hth.
	brent

From miguel at yorku.ca  Mon Feb 26 15:01:24 2001
From: miguel at yorku.ca (Miguel Marques)
Date: Fri Jan  9 21:52:17 2004
Subject: [mod_python] what's happen?
In-Reply-To: <Ac989772967451.24452@mail3.china.com>
References: <Ac989772967451.24452@mail3.china.com>
Message-ID: <20010226150124M.miguel@yorku.ca>

On Tue, 27 Feb 2001 03:25:48 +0800 (CST), gege@china.com wrote:
> under redhat 6.2 python 2.1a2 mod_python 2.7.2 apache 1.3.12
> 
> lynx http://localhost/python/mptest.py
> 
> it appears Hello World!
> 
> but when I type lynx http://localhost/python/test.py or some other filename.py
> 
> it also appears Hello World!
> 
> I don't understand...

AddHandler python-program .py
specifies .py files are to be handled by the handler python-program.

The handler for files of type python-program in that directory is
whatever you specified as the PythonHandler in your apache
configuration file.

So any filename ending in .py gets handled by running mptest.py (I'm
guessing that's what you specified).
If you wanted to do something based on the filename you could 
look at req.uri in mptest.py.

If for instance you use 
SetHandler python-program
instead of
AddHandler python-program .py
then any reference to a file in that directory runs mptest.py
regardless of extension.

Hope this helps.

							Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830

From petar at metamarkets.com  Mon Feb 26 12:03:18 2001
From: petar at metamarkets.com (Petar Karafezov)
Date: Fri Jan  9 21:52:17 2004
Subject: [mod_python] RE: my_file.pyc is not created anymore ...what c
	hanged ?
Message-ID: <86FC34EA3C4F074AA6BBFFE52ED83FED27BDBD@METAEXCH.sfo.metamarkets.com>

duh! of course ... :) Thanks, Brent!

-----Original Message-----
From: Brent Verner [mailto:brent@rcfile.org]
Sent: Monday, February 26, 2001 11:34 AM
To: Petar Karafezov
Cc: mod_python@modpython.org
Subject: Re: [mod_python] RE: my_file.pyc is not created anymore ...what
changed ?


On 26 Feb 2001 at 11:03 (-0800), Petar Karafezov wrote:
| Hello all -
| 
| I was going through a lot of reconfiguration of my apache+mod_python
setup,
| including migrating it to different server and it seems that somewhere in
| all changes made I have "lost" the .pyc files functionality. Before I'd
see
| a .pyc file being created after mod_python would process my .py handlers.
| According to the docs - it would not recompile again if the .py file
doesn't
| get changed and just use the pre-compiled byte code.
| 
| I did a fresh install of apache and mod_python 2.7.2 both with python
1.5.2
| (the standard RPm that comes with RH6.2) and with compiled from source
| Python2.0 - and I still don't see the .pyc iles created. Any ideas ??

perhaps the directory where your .py files (and the desired .pyc) files
live is not writable by the user the web server is running as? I've found
it very useful to create a new group, add myself and the web server user
to that group, then own the python web directories to that group and chmod
it g+w.

hth.
	brent

From mail4myx at yahoo.de  Wed Feb 28 17:06:12 2001
From: mail4myx at yahoo.de (=?iso-8859-1?q?anja=20schmidt?=)
Date: Fri Jan  9 21:52:17 2004
Subject: [mod_python] mod_python, NT, PythonPath
Message-ID: <20010228160612.48560.qmail@web12803.mail.yahoo.com>

Hi,
okay, I've spent almost the whole day trying to
integrate mod_python in NT and I'm getting craaaaazy
now!

I've browsed through the archives and I'm getting the
same error message like George Jempty(5th of December
2000). But he didn't get a reply so I try once again:

The error message in the apache error.log is: 
python_handler: make_obcallback returned no
obCallBack!

After browsing the archives I sort of understand that
the extracted python files of mod_python-2.7.2.tgz
can't be located. I've put them in the
C:\Programme\Python20\Lib\mod_python-2.7.2 directory
and I've pointed the PYTHONPATH env-variable to this.
Didn't work.

The lines in the httpd.conf-file look like

<Directory "C:/Programme/Apache
Group/Apache/htdocs/python">
	AddHandler python-program .py
	PythonHandler mptest
	PythonDebug on
</Directory> 

I also tried to define the PythonPath-variable in
between the <Directory /> tags: PythonPath
"C:/Programme/Python20/Lib/mod_python-2.7.2/" Didn't
work! (And I also tried with other python files, so it
has nothing to do with the name of the .py file,
mptest or test).

So, if anyone knows the answer: Please be so kind to
tell me. Thanks a lot in advance!!

Anja

__________________________________________________________________
Do You Yahoo!?
Gesendet von Yahoo! Mail - http://mail.yahoo.de

From victor at prodigy.net  Wed Feb 28 11:28:24 2001
From: victor at prodigy.net (Victor Muslin)
Date: Fri Jan  9 21:52:17 2004
Subject: [mod_python] mod_python, NT, PythonPath
In-Reply-To: <20010228160612.48560.qmail@web12803.mail.yahoo.com>
Message-ID: <5.0.0.25.0.20010228111927.03518980@localhost>

I used to get the same error before I set things up so that mod_python 
PACKAGE is found.

Make sure you mod_python Python PACKAGE (not the DLL files) and make sure 
that PYTHONPATH environmental variable points to the directory where the 
package is located. The mod_python package is a set of python files in a 
mod_python directory and a bunch of subdirectories.

For example, if you put the package in C:\python_packages (so that you now 
have c:\python_packages\mod_python\...) make sure PYTHONPATH has 
C:\python_packages in it. Then restart Apache.

What you want to do is define PYTHONPATH in your environment BEFORE 
starting the Apache (so that Apache process inherits it). You can then also 
do in httpd.conf:

PassEnv PYTHONPATH

though I don't think it makes a difference.

Hope this helps.


At 05:06 PM 2/28/2001 +0100, anja schmidt wrote:
>Hi,
>okay, I've spent almost the whole day trying to
>integrate mod_python in NT and I'm getting craaaaazy
>now!
>
>I've browsed through the archives and I'm getting the
>same error message like George Jempty(5th of December
>2000). But he didn't get a reply so I try once again:
>
>The error message in the apache error.log is:
>python_handler: make_obcallback returned no
>obCallBack!
>
>After browsing the archives I sort of understand that
>the extracted python files of mod_python-2.7.2.tgz
>can't be located. I've put them in the
>C:\Programme\Python20\Lib\mod_python-2.7.2 directory
>and I've pointed the PYTHONPATH env-variable to this.
>Didn't work.
>
>The lines in the httpd.conf-file look like
>
><Directory "C:/Programme/Apache
>Group/Apache/htdocs/python">
>         AddHandler python-program .py
>         PythonHandler mptest
>         PythonDebug on
></Directory>
>
>I also tried to define the PythonPath-variable in
>between the <Directory /> tags: PythonPath
>"C:/Programme/Python20/Lib/mod_python-2.7.2/" Didn't
>work! (And I also tried with other python files, so it
>has nothing to do with the name of the .py file,
>mptest or test).
>
>So, if anyone knows the answer: Please be so kind to
>tell me. Thanks a lot in advance!!
>
>Anja
>
>__________________________________________________________________
>Do You Yahoo!?
>Gesendet von Yahoo! Mail - http://mail.yahoo.de
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://www.modpython.org/mailman/listinfo/mod_python

_________________________________________________________________________
Victor Muslin    The power of accurate observation is frequently called
                       cynicism by those who don't have it.
                           - George Bernard Shaw
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010228/adaf2ea4/attachment-0001.htm
From brett at bookshop.unsw.edu.au  Thu Feb  1 14:36:05 2001
From: brett at bookshop.unsw.edu.au (Brett Haydon)
Date: Fri Jan  9 21:58:47 2004
Subject: [mod_python] modpublisher security model
Message-ID: <NCBBKMABOKFCDLPIKKGIMEHGCJAA.brett@bookshop.unsw.edu.au>

Evidently Zope currently uses the doc string to 
explicity allow access to functions via URL.

The new Python 2.1 will allow functions to have
attributes.

I am currently renaming all imported modules with
an underscore to avoid unintentional security problems
(and global objects)
but I like the idea of explicitly allowing access.

Any plans to move in this direction.

regards,
______________________________________________
Brett Haydon


From x at vex.net  Tue Feb  6 13:59:21 2001
From: x at vex.net (T. Muddletin)
Date: Fri Jan  9 21:58:47 2004
Subject: [mod_python] math import
Message-ID: <158300828588.20010206135921@vex.net>

I'm playing with netbsd 1.5/apache 1.3.17/python 2.0/mod_python 2.7.1
(DSO).

Using the cgihandler... when i try to import the standard python math
module i get...

PythonHandler mod_python.cgihandler: Traceback (most recent call last):
PythonHandler mod_python.cgihandler:   File "/usr/pkg/lib/python2.0/site-packages/mod_python/apache.py", line 189, in Dispatch
    result = object(self.req)
PythonHandler mod_python.cgihandler:   File "/usr/pkg/lib/python2.0/site-packages/mod_python/cgihandler.py", line 122, in handler
    imp.load_module(module_name, fd, path, desc)
PythonHandler mod_python.cgihandler:   File "/usr/home/x/public_html/test.py", line 21, in ?
    import math
PythonHandler mod_python.cgihandler: ImportError: error in dynamic linking

Is this a DSO issue? I hope not, because i haven't been able to get
apache to static compile with the mod yet either...

-- 
Tim Middleton | Cain Gang Ltd | There are a thousand hacking at the branches
x@veX.net     | www.Vex.Net   | of evil [but who] at the root. --Thoreau (W)



From brent at rcfile.org  Wed Feb  7 08:59:53 2001
From: brent at rcfile.org (Brent Verner)
Date: Fri Jan  9 21:58:47 2004
Subject: [mod_python] [RFC] mod_python embedded python module
Message-ID: <20010207085953.B4193@rcfile.org>

Hi,
  
  First off, Gregory, thanks for writing this nice software :)

  Secondly, after looking into mod_python and mod_snake, I've 
decided that _I_ like mod_python (the base python/apache binding)
much better than mod_snake. Now, I'm not a python programmer, but
there's no better way to learn than to do, so last night I started
hacking up a module/handler to handle documents having embedded
HTML, the feature which drew me toward mod_snake at first.

  What I intend to do with this module is have it:
    1) parse (so to speak) a document containing HTML-embedded python
       code into pure python code. My tentative direction is to:
        a) create a python file that looks like
========================================================
env = {}
def embedded_output_hook(req):
  env = req.subprocess_env
  req.write("""<html>
<head>
<title>"""
  req.write( req.uri )
  req.write("""</title>
</head>
<body>
"""
  for i in env.keys():
    req.write("""<b>""")
    req.write( i )
    req.write(""": """)
    req.write( env[i] )
    req.write("""</b><br>
""")
  # for
  req.write("""</body
</html>
""")

========================================================
from an HTML-embedded file of:
========================================================
<html>
<head>
<title><?= req.uri ?></title>
</head>
<body>
<?
  for i in env.keys():
?>
<b><?= i ?>: <?= env[i] ?></b><br>
<?
  # for
?>
</body>
</html>
========================================================

       and the module will call embedded_output_hook(req) from 
       the loaded module. Also, I've thought of having calls to
       content_type/auth/cleanup functions which may be defined in
       the document...
    2) save those parsed files to a cache directory, where they'll
       actually be loaded from when the correspondeing HTML-embedded
       file is requested via the handler. Of course I'm stat()ing
       the files to make sure the parsed/cached file is up to date.

That is all fairly simple, from the overview, but I do have a few 
questions before I go too far down the wrong road :):
  1) is this approach sane, or is there a more elegant/efficient
     way to handle this?
  2) To create the pure-python file from the embedded document, I'm
     pretty sure some restrictions will have to be made on the
     location/designation of functions. What is a reasonable set
     of restrictions that can/should be placed on this so the module
     doesn't become a major-hack-of-a-buncha-special-cases :)
  3) I'm using load_module(...) to load the pure-python files. Is
     there any way (a different one?) that will allow the loaded
     module to access globals from the module's environment, i.e.,
     database connections, et. al.
  4) Is there any way to have multile 'AddHandler' types in the same 
     config section? If not, will you accept clean patches to do so?


comments and discussion are requested. I'm going to do this, I just
want to make sure I do something that is maximally useful :) I'll
not be resonding to this thread until the weekend, cause I've got
some real (non-python :() work that _must_ get done to free up my
weekend to get on with this hack.

thanks.
  brent

-- 
"We want to help, but we wouldn't want to deprive you of a valuable 
learning experience."
                                          http://openbsd.org/mail.html

From jmcbray at carcosa.net  Wed Feb  7 14:19:28 2001
From: jmcbray at carcosa.net (Jason F. McBrayer)
Date: Fri Jan  9 21:58:47 2004
Subject: [mod_python] [RFC] mod_python embedded python module
In-Reply-To: <20010207085953.B4193@rcfile.org>; from brent@rcfile.org on Wed, Feb 07, 2001 at 08:59:53AM -0500
References: <20010207085953.B4193@rcfile.org>
Message-ID: <20010207141928.B19360@bertrand.carcosa.net>

On Wed, Feb 07, 2001 at 08:59:53AM -0500, Brent Verner wrote:

>   Secondly, after looking into mod_python and mod_snake, I've 
> decided that _I_ like mod_python (the base python/apache binding)
> much better than mod_snake. Now, I'm not a python programmer, but
> there's no better way to learn than to do, so last night I started
> hacking up a module/handler to handle documents having embedded
> HTML, the feature which drew me toward mod_snake at first.

You might also take a look at PMZ (Poor Man's Zope,
pmz.sourceforge.net), which already does this very well.  I did some
work to make it usable as a mod_python module, but I think the
original author has also done so in parallel.  In any case, it's not
too hard to do -- just get PMZ and work on wrapping it in a handler
function, redirecting IO appropriately.

-- 
+----------------------------------------------------------------+
| Jason F. McBrayer                         jmcbray@carcosa.net  |
| The scalloped tatters of the King in Yellow must hide Yhtill   |
| forever.                    R.W. Chambers _The King in Yellow_ |

From miguel at yorku.ca  Wed Feb  7 14:35:45 2001
From: miguel at yorku.ca (Miguel Marques)
Date: Fri Jan  9 21:58:47 2004
Subject: [mod_python] [RFC] mod_python embedded python module
In-Reply-To: <20010207141928.B19360@bertrand.carcosa.net>
References: <20010207085953.B4193@rcfile.org>
	<20010207141928.B19360@bertrand.carcosa.net>
Message-ID: <20010207143545G.miguel@yorku.ca>

Greetings...
On Wed, 7 Feb 2001 14:19:28 -0500, "Jason F. McBrayer" <jmcbray@carcosa.net> wrote:
> On Wed, Feb 07, 2001 at 08:59:53AM -0500, Brent Verner wrote:
> 
> >   Secondly, after looking into mod_python and mod_snake, I've 
> > decided that _I_ like mod_python (the base python/apache binding)
> > much better than mod_snake. Now, I'm not a python programmer, but
> > there's no better way to learn than to do, so last night I started
> > hacking up a module/handler to handle documents having embedded
> > HTML, the feature which drew me toward mod_snake at first.
> 
> You might also take a look at PMZ (Poor Man's Zope,
> pmz.sourceforge.net), which already does this very well.  I did some
> work to make it usable as a mod_python module, but I think the
> original author has also done so in parallel.  In any case, it's not
> too hard to do -- just get PMZ and work on wrapping it in a handler
> function, redirecting IO appropriately.
> 
Another option is getting Zope and extracting DocumentTemplate and
using it.  It allows you to easily insert data from python objects 
into html templates and it has some very nice helper functions you can
use in your templates.

I've several web applications using mod_python and DocumentTemplate
and they work rather nicely.  I believe PMZ offers similar functionality
but you may want to look at DocumentTemplate and see which you like better.

							Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830


From grisha at verio.net  Sat Feb 10 21:26:12 2001
From: grisha at verio.net (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:58:47 2004
Subject: [mod_python] 2.7.2
Message-ID: <Pine.BSF.4.32.0102102124360.22089-100000@localhost>

2.7.2 is available for download.

If you are using the publisher handler, you should upgrade, since 2.7.2
fixes the issue with being able access standard library modules from the
web. It also adds some new authentication features to the publisher
handler.

Grisha


From daniel at copyleft.no  Sun Feb 11 16:16:23 2001
From: daniel at copyleft.no (Hr. Daniel Mikkelsen)
Date: Fri Jan  9 21:58:47 2004
Subject: [mod_python] File uploads.
Message-ID: <Pine.LNX.4.31.0102111613590.27696-100000@unity.copyleft.no>

Hi.

Does anyone have any example code for accepting file uploads with
mod_python? I understand one uses req.read() to get the POSTed data
as usual, and then one parses th query-string in a particular
manner.

Thanks in advance!

-- Daniel Mikkelsen, Copyleft Software AS



From teep at inet.co.th  Mon Feb 12 15:28:03 2001
From: teep at inet.co.th (Prateep Siamwalla)
Date: Fri Jan  9 21:58:47 2004
Subject: [mod_python] Regarding 2.7.2 on windows
Message-ID: <002401c094cd$bb3086a0$0c05a8c0@taramansion.bangkok>

Hi All,

I have been using 2.7.1 on windows for a couple of weeks now [ many thanks
to Enrique Vaamonde for the excellent installation instructions ], and its
been quite a ride.  I'm eager to download the new 2.7.2 which was recently
uploaded.

Question :
Since I'm running compiler impared windows box, will I need to wait for a
new mod_python.dll to be uploaded before installing mod_python 2.7.2?  Or
are the new changes made only to the python files in python20\lib\mod_python
?

Thanks in advance
teep



From jd at pdx.edu  Mon Feb 12 15:19:47 2001
From: jd at pdx.edu (jd@pdx.edu)
Date: Fri Jan  9 21:58:47 2004
Subject: [mod_python] Mod_Python and Solaris Compile Problems
Message-ID: <982019987.3a886f93b61d1@webmail.pdx.edu>

Hi!  I'm trying to install mod_python on my Solaris server and I keep getting
comple problems.  I'm using Apache 1.3.14, PHP 4.0.2pl1, and Mod_Python 2.7.2.  

Here's what happens when I try to compile Apache with the Static Mod_Python (it
also fails on compiling the DSO, see below):

<=== src/modules/python
<=== src/modules
gcc -c  -I./os/unix -I./include   -DSOLARIS2=280 -I/usr/share/src/php-4.0.4pl1
-I/usr/share/src/php-4.0.4pl1/main -I/usr/share/src/php-4.0.4pl1/main
-I/usr/share/src/php-4.0.4pl1/Zend -I/usr/share/src/php-4.0.4pl1/Zend
-I/usr/share/src/php-4.0.4pl1/TSRM -I/usr/share/src/php-4.0.4pl1/TSRM
-I/usr/share/src/php-4.0.4pl1 -DUSE_EXPAT -I./lib/expat-lite `./apaci` modules.c
gcc -c  -I./os/unix -I./include   -DSOLARIS2=280 -I/usr/share/src/php-4.0.4pl1
-I/usr/share/src/php-4.0.4pl1/main -I/usr/share/src/php-4.0.4pl1/main
-I/usr/share/src/php-4.0.4pl1/Zend -I/usr/share/src/php-4.0.4pl1/Zend
-I/usr/share/src/php-4.0.4pl1/TSRM -I/usr/share/src/php-4.0.4pl1/TSRM
-I/usr/share/src/php-4.0.4pl1 -DUSE_EXPAT -I./lib/expat-lite `./apaci`
buildmark.c
gcc  -DSOLARIS2=280 -I/usr/share/src/php-4.0.4pl1
-I/usr/share/src/php-4.0.4pl1/main -I/usr/share/src/php-4.0.4pl1/main
-I/usr/share/src/php-4.0.4pl1/Zend -I/usr/share/src/php-4.0.4pl1/Zend
-I/usr/share/src/php-4.0.4pl1/TSRM -I/usr/share/src/php-4.0.4pl1/TSRM
-I/usr/share/src/php-4.0.4pl1 -DUSE_EXPAT -I./lib/expat-lite `./apaci`    \
      -o httpd buildmark.o modules.o  modules/php4/libphp4.a 
modules/python/libpython.a  modules/standard/libstandard.a  main/libmain.a 
./os/unix/libos.a  ap/libap.a  lib/expat-lite/libexpat.a  -R/usr/ucblib
-R/usr/local/lib/gcc-lib/sparc-sun-solaris2.8/2.95.2  -L/usr/ucblib
-L/usr/local/lib/gcc-lib/sparc-sun-solaris2.8/2.95.2 -Lmodules/php4
-L../modules/php4 -L../../modules/php4 -lmodphp4  -lpam  -ldl -lresolv -lresolv
-lm -ldl -lcrypt -lnsl -lsocket  -lsocket -lgcc   -lsocket -lnsl -ldl
Undefined                       first referenced
 symbol                             in file
PySequence_Index                    modules/python/libpython.a(mod_python.o)
Py_InitModule4                      modules/python/libpython.a(_apachemodule.o)
PyString_FromStringAndSize          modules/python/libpython.a(_apachemodule.o)
PyExc_TypeError                     modules/python/libpython.a(tableobject.o)
PyEval_RestoreThread                modules/python/libpython.a(mod_python.o)
PyCallable_Check                    modules/python/libpython.a(requestobject.o)
PyErr_BadArgument                   modules/python/libpython.a(_apachemodule.o)
Py_Finalize                         modules/python/libpython.a(mod_python.o)
Py_NewInterpreter                   modules/python/libpython.a(mod_python.o)
PyErr_Print                         modules/python/libpython.a(mod_python.o)
PyExc_IndexError                    modules/python/libpython.a(requestobject.o)
PyMember_Set                        modules/python/libpython.a(requestobject.o)
Py_FindMethod                       modules/python/libpython.a(requestobject.o)
PyExc_IOError                       modules/python/libpython.a(requestobject.o)
PyString_FromString                 modules/python/libpython.a(mod_python.o)
PyThreadState_Swap                  modules/python/libpython.a(mod_python.o)
PyType_Type                         modules/python/libpython.a(_apachemodule.o)
Py_BuildValue                       modules/python/libpython.a(_apachemodule.o)
PyErr_Occurred                      modules/python/libpython.a(mod_python.o)
PyString_AsString                   modules/python/libpython.a(mod_python.o)
PyList_SetItem                      modules/python/libpython.a(tableobject.o)
PyModule_GetDict                    modules/python/libpython.a(_apachemodule.o)
PyObject_CallMethod                 modules/python/libpython.a(mod_python.o)
PyList_Append                       modules/python/libpython.a(_apachemodule.o)
Py_IsInitialized                    modules/python/libpython.a(mod_python.o)
PyInt_Type                          modules/python/libpython.a(mod_python.o)
_Py_NoneStruct                      modules/python/libpython.a(_apachemodule.o)
PyExc_AttributeError                modules/python/libpython.a(requestobject.o)
PyObject_Str                        modules/python/libpython.a(mod_python.o)
PyArg_ParseTuple                    modules/python/libpython.a(_apachemodule.o)
PyExc_ValueError                    modules/python/libpython.a(requestobject.o)
PyErr_SetString                     modules/python/libpython.a(requestobject.o)
PyList_SetSlice                     modules/python/libpython.a(mod_python.o)
PyTuple_New                         modules/python/libpython.a(util.o)
PyEval_SaveThread                   modules/python/libpython.a(mod_python.o)
PyDict_SetItemString                modules/python/libpython.a(mod_python.o)
PyObject_HasAttrString              modules/python/libpython.a(serverobject.o)
PyDict_GetItem                      modules/python/libpython.a(_apachemodule.o)
PyMapping_HasKeyString              modules/python/libpython.a(_apachemodule.o)
PyCObject_FromVoidPtr               modules/python/libpython.a(mod_python.o)
PyString_ConcatAndDel               modules/python/libpython.a(tableobject.o)
PyErr_NewException                  modules/python/libpython.a(_apachemodule.o)
PyObject_GetAttrString              modules/python/libpython.a(mod_python.o)
PyList_New                          modules/python/libpython.a(_apachemodule.o)
Py_OptimizeFlag                     modules/python/libpython.a(mod_python.o)
PyDict_SetItem                      modules/python/libpython.a(_apachemodule.o)
PyExc_KeyError                      modules/python/libpython.a(tableobject.o)
PyDict_New                          modules/python/libpython.a(mod_python.o)
PyTuple_SetItem                     modules/python/libpython.a(util.o)
PyThreadState_New                   modules/python/libpython.a(mod_python.o)
PyErr_Clear                         modules/python/libpython.a(requestobject.o)
Py_GetVersion                       modules/python/libpython.a(mod_python.o)
PyMember_Get                        modules/python/libpython.a(requestobject.o)
PyInt_FromLong                      modules/python/libpython.a(requestobject.o)
PyDict_GetItemString                modules/python/libpython.a(mod_python.o)
PyCObject_AsVoidPtr                 modules/python/libpython.a(mod_python.o)
PyErr_NoMemory                      modules/python/libpython.a(requestobject.o)
PyInt_AsLong                        modules/python/libpython.a(mod_python.o)
PyList_Size                         modules/python/libpython.a(_apachemodule.o)
PyImport_ImportModule               modules/python/libpython.a(mod_python.o)
PyObject_CallFunction               modules/python/libpython.a(mod_python.o)
PyErr_Fetch                         modules/python/libpython.a(mod_python.o)
PyThreadState_Delete                modules/python/libpython.a(mod_python.o)
_PyString_Resize                    modules/python/libpython.a(_apachemodule.o)
Py_Initialize                       modules/python/libpython.a(mod_python.o)
PyErr_SetObject                     modules/python/libpython.a(requestobject.o)
PyString_Type                       modules/python/libpython.a(tableobject.o)
ld: fatal: Symbol referencing errors. No output written to httpd
collect2: ld returned 1 exit status
*** Error code 1
make: Fatal error: Command failed for target `target_static'
Current working directory /usr/share/src/apache_1.3.14/src
*** Error code 1
make: Fatal error: Command failed for target `build-std'
Current working directory /usr/share/src/apache_1.3.14
*** Error code 1
make: Fatal error: Command failed for target `build'


*** So I tried to install the DSO version, hoping that would be my hero.  But
this is what I get when compiling Mod_Python with the DSO support:


Compiling for DSO. For static, do "make static"

/usr/local/apachePHP/bin/apxs -I/usr/share/src/mod_python-2.7.2/src/include
-I/usr/local/apachePHP/include -I/usr/local/include/python1.5 -c mod_python.o 
_apachemodule.o  requestobject.o  tableobject.o  util.o  serverobject.o 
connobject.o -lm  /usr/local/lib/python1.5/config/libpython1.5.a   -lsocket
-lnsl -ldl    -lm
  -o mod_python.so mod_python.o _apachemodule.o requestobject.o tableobject.o
util.o serverobject.o connobject.o -lm
/usr/local/lib/python1.5/config/libpython1.5.a -lsocket -lnsl -ldl -lm 
apxs:Break: Command failed with rc=255
*** Error code 1
make: Fatal error: Command failed for target `mod_python.so'
Current working directory /usr/share/src/mod_python-2.7.2/src
*** Error code 1
make: Fatal error: Command failed for target `do_dso'

Please Help me!  I will give you any additional information that you request.  I
really want to use this module in Solaris!!!  Thanks in advance!

From joost.damad at siemens.atea.be  Thu Feb 15 15:07:34 2001
From: joost.damad at siemens.atea.be (Joost Yervante Damad)
Date: Fri Jan  9 21:58:47 2004
Subject: [mod_python] some issues
Message-ID: <20010215150733.A20391@siemens.atea.be>

Hello,

A friend of me discovered wierd bug in publisher :

def tst(req, arg='none', test='none', longname='none'):
        req._content_type_set = 0
        return "Arguments are '%s', '%s' and '%s'" % (arg, test, longname)

if we now do:

https://r2d2.iplab.atea.be:8081/py/test.py/tst?arg=x&test=y&longname=z

the result is:

Arguments are '', '' and 'z'

Aparently short names are not getting into the functions.
Long names are. Or is this caused by name clashes?

We tested this both with 2.7.1 and 2.7.2 on Solaris 2.6
with apache 1.3.14 with SSL and mod_python statically linked.

Another error I found:

The handling of _content_type_set seems to be broken.

publisher no longer functioned, bailin out at:

if not req._content_type_set:

giving an exeception stating that that variable was not found.

Removing that part and setting the content_type to
"text/html" is our current workaround.

Any thoughts?

Joost

P.S.: but we love mod_python :)

-- 
Joost Damad - Siemens ICN D NC A - +3214252297
--
Five is a sufficiently close approximation to infinity.
       -- Robert Firth
"One, two, five."
       -- Monty Python and the Holy Grail

From joost.damad at siemens.atea.be  Thu Feb 15 15:17:26 2001
From: joost.damad at siemens.atea.be (Joost Yervante Damad)
Date: Fri Jan  9 21:58:47 2004
Subject: [mod_python] Re: Mod_Python and Solaris Compile Problems
Message-ID: <20010215151726.A21817@siemens.atea.be>

I added a non-multithreaded libpython.a
to the directory of mod_python and
hacked the Makefile to force it to staticaly
link in that one.

Worked fine for me.

Joost

-- 
Joost Damad - Siemens ICN D NC A - +3214252297
--
Five is a sufficiently close approximation to infinity.
       -- Robert Firth
"One, two, five."
       -- Monty Python and the Holy Grail

From Zhu.James at iac.com.tw  Fri Feb 16 14:59:59 2001
From: Zhu.James at iac.com.tw (Zhu.James@iac.com.tw)
Date: Fri Jan  9 21:58:47 2004
Subject: [mod_python] How to install Python 2.7.2 on Windows NT
Message-ID: <939C21A81E55D311806D0008C759857F0117E18E@isc-mx1.isc.inventec>

Hi All,

   I an a newbie to python. I want to install Python 2.7.2 on my NT machine,
but i cannot find the windows installation guide. Can someone tell me how to
do it?
Thanks in advance.

Regards
James




-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010216/dafc01c5/attachment-0002.htm
From joost.damad at siemens.atea.be  Fri Feb 16 08:31:41 2001
From: joost.damad at siemens.atea.be (Joost Yervante Damad)
Date: Fri Jan  9 21:58:47 2004
Subject: [mod_python] some issues
In-Reply-To: <20010215150733.A20391@siemens.atea.be>; from joost.damad@siemens.atea.be on Thu, Feb 15, 2001 at 03:07:34PM +0100
References: <20010215150733.A20391@siemens.atea.be>
Message-ID: <20010216083141.A10720@siemens.atea.be>

'Joost Yervante Damad' wrote about '[mod_python] some issues' - Thu, Feb 15, 2001 at 03:07:34PM CET
> Hello,
> 
> A friend of me discovered wierd bug in publisher :
> 
> def tst(req, arg='none', test='none', longname='none'):
>         req._content_type_set = 0
>         return "Arguments are '%s', '%s' and '%s'" % (arg, test, longname)
> 
> if we now do:
> 
> https://r2d2.iplab.atea.be:8081/py/test.py/tst?arg=x&test=y&longname=z
> 
> the result is:
> 
> Arguments are '', '' and 'z'
> 
> Aparently short names are not getting into the functions.
> Long names are. Or is this caused by name clashes?
> 
> We tested this both with 2.7.1 and 2.7.2 on Solaris 2.6
> with apache 1.3.14 with SSL and mod_python statically linked.
> 
> Another error I found:
> 
> The handling of _content_type_set seems to be broken.
> 
> publisher no longer functioned, bailin out at:
> 
> if not req._content_type_set:
> 
> giving an exeception stating that that variable was not found.
> 
> Removing that part and setting the content_type to
> "text/html" is our current workaround.
> 
> Any thoughts?
> 

After careful examining we found that somehow 2.7.1 and 2.7.2
got mixed during our building, causing the _content_type_set
breakage. Sorry for that bad intel.

The other problem (short params) remains though.

-- 
Joost Damad - Siemens ICN D NC A - +3214252297
--
Five is a sufficiently close approximation to infinity.
       -- Robert Firth
"One, two, five."
       -- Monty Python and the Holy Grail

From Christian.Vergnaud at hcuge.ch  Tue Feb 20 18:33:02 2001
From: Christian.Vergnaud at hcuge.ch (Christian VERGNAUD)
Date: Fri Jan  9 21:58:47 2004
Subject: [mod_python] Can't locate API module structure `mod_python'
Message-ID: <sa92b870.002@diogenes.hcuge.ch>

I get the following message when I start httpd :
Can't locate API module structure `mod_python' in file /home/Impact/orbix/apache/libexec/mod_python.so: ld.so.1: /home/Impact/orbix/apache/bin/httpd: fatal: mod_python: can't find symbol

OS vesrion: SunOS 5.6, python2.0, Apache 1.3.17, mod_python 2.7.2

I don't know if it's related or not but when installing mod_python, I had to force the library libgcc.a in the Makefile of the src directory in order to avoid unsatisfied entry points (__eprintf for instance) problems.

I'm now stuck and have no idea of what to do. Can someone help?

Thanks


From grisha at verio.net  Tue Feb 20 13:25:39 2001
From: grisha at verio.net (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:58:47 2004
Subject: [mod_python] Can't locate API module structure `mod_python'
In-Reply-To: <sa92b870.002@diogenes.hcuge.ch>
Message-ID: <Pine.BSF.4.32.0102201325010.20282-100000@localhost>

I believe someone else was reporting a similar issue and they resolved by
compiling python separately without threads.

Grisha

On Tue, 20 Feb 2001, Christian VERGNAUD wrote:

>
> I get the following message when I start httpd :
> Can't locate API module structure `mod_python' in file /home/Impact/orbix/apache/libexec/mod_python.so: ld.so.1: /home/Impact/orbix/apache/bin/httpd: fatal: mod_python: can't find symbol
>
> OS vesrion: SunOS 5.6, python2.0, Apache 1.3.17, mod_python 2.7.2
>
> I don't know if it's related or not but when installing mod_python, I had to force the library libgcc.a in the Makefile of the src directory in order to avoid unsatisfied entry points (__eprintf for instance) problems.
>
> I'm now stuck and have no idea of what to do. Can someone help?
>
> Thanks
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From brett at bookshop.unsw.edu.au  Wed Feb 21 11:33:11 2001
From: brett at bookshop.unsw.edu.au (Brett Haydon)
Date: Fri Jan  9 21:58:47 2004
Subject: [mod_python] Windows version of 2.7.2
Message-ID: <NCBBKMABOKFCDLPIKKGICELMCJAA.brett@bookshop.unsw.edu.au>

I know others have asked but:

Is the modpython dll being recompiled for 2.7.2 for win?

The new modpublisher module looks at the req._content_type_set
attribute which appears not to be in the dll for 2.7.1

regards,
______________________________________________
Brett Haydon


From joost.damad at siemens.atea.be  Wed Feb 21 10:23:46 2001
From: joost.damad at siemens.atea.be (Joost Yervante Damad)
Date: Fri Jan  9 21:58:47 2004
Subject: [mod_python] mod_python/publisher/solaris truncation problems
Message-ID: <20010221102346.A15890@siemens.atea.be>

Hi!

A while ago I send a mail reporting a bug stating that
cgi attribute/value pairs get truncated in our Solaris 2.6
apachessl with latest mod_python, when xxx=yyy total
length smaller then 8 bytes.

It seems to be related to the python/C interfacing...
and it also looks like a 32bit/64bit alike problem.
Anyway, we (I and a colleage) found the following workaround,
basically eliminating some of the Python/C interface calls
from the function "parse_qsl" in
_apachemodule.c

Note that this seems to be a Solaris only problem since
we did not have it on Linux.

Attached is a modified _apachemodule.c with a
working, but probably not the best...fix.
But at least it works for us, and we don't need the
performance.

Any thoughts on this?

Thanks,

-- 
Joost Damad - Siemens IC D NC A - +3214252297
--
Five is a sufficiently close approximation to infinity.
       -- Robert Firth
"One, two, five."
       -- Monty Python and the Holy Grail

From joost.damad at siemens.atea.be  Wed Feb 21 10:29:39 2001
From: joost.damad at siemens.atea.be (Joost Yervante Damad)
Date: Fri Jan  9 21:58:47 2004
Subject: [mod_python] mod_python/publisher/solaris truncation problems
In-Reply-To: <20010221102346.A15890@siemens.atea.be>; from joost.damad@siemens.atea.be on Wed, Feb 21, 2001 at 10:23:46AM +0100
References: <20010221102346.A15890@siemens.atea.be>
Message-ID: <20010221102939.A16904@siemens.atea.be>

'Joost Yervante Damad' wrote about '[mod_python] mod_python/publisher/solaris truncation problems' - Wed, Feb 21, 2001 at 10:23:46AM CET
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

<forgot the attachment...>

-- 
Joost Damad - Siemens IC D NC A - +3214252297
--
Five is a sufficiently close approximation to infinity.
       -- Robert Firth
"One, two, five."
       -- Monty Python and the Holy Grail
-------------- next part --------------
A non-text attachment was scrubbed...
Name: _apachemodule.c
Type: text/x-csrc
Size: 10218 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20010221/52c70a09/_apachemodule-0002.bin
From grisha at verio.net  Wed Feb 21 10:25:01 2001
From: grisha at verio.net (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:58:47 2004
Subject: [mod_python] mod_python/publisher/solaris truncation problems
In-Reply-To: <20010221102346.A15890@siemens.atea.be>
Message-ID: <Pine.BSF.4.32.0102211023480.30708-100000@localhost>

Interesting... I'll have to look into this. It makes sense, since Solaris
is a 64 bit OS whereas Linux on i386 is 32 bit. I haven't done much
Solaris testing, I guess I'll have to do more.

Grisha

On Wed, 21 Feb 2001, Joost Yervante Damad wrote:

> Hi!
>
> A while ago I send a mail reporting a bug stating that
> cgi attribute/value pairs get truncated in our Solaris 2.6
> apachessl with latest mod_python, when xxx=yyy total
> length smaller then 8 bytes.
>
> It seems to be related to the python/C interfacing...
> and it also looks like a 32bit/64bit alike problem.
> Anyway, we (I and a colleage) found the following workaround,
> basically eliminating some of the Python/C interface calls
> from the function "parse_qsl" in
> _apachemodule.c
>
> Note that this seems to be a Solaris only problem since
> we did not have it on Linux.
>
> Attached is a modified _apachemodule.c with a
> working, but probably not the best...fix.
> But at least it works for us, and we don't need the
> performance.
>
> Any thoughts on this?
>
> Thanks,
>
> --
> Joost Damad - Siemens IC D NC A - +3214252297
> --
> Five is a sufficiently close approximation to infinity.
>        -- Robert Firth
> "One, two, five."
>        -- Monty Python and the Holy Grail
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From petar at metamarkets.com  Wed Feb 21 12:08:07 2001
From: petar at metamarkets.com (Petar Karafezov)
Date: Fri Jan  9 21:58:47 2004
Subject: [mod_python] mod_python2.7.2 and server redirects
Message-ID: <86FC34EA3C4F074AA6BBFFE52ED83FED27BDA3@METAEXCH.sfo.metamarkets.com>

hello all -

let me fist say that I love mod_python - works great - much faster than any
cgi! Thanks, Grisha! 

I am seeing some weirdness when working with server redirects - I'm simply
trying to catch the headers from the server, modify the location key and
then send it to the client. It work ok under the CGI, but when I see the
headers that my .py reports when accessed with lynx -mime_header option
(which simply prints the headers and body and exits) instead of HTTP/1.1 302
Found, I see HTTP/1.1 200 OK. I am not sure why this is happening.. Any
ideas ??

Regards,
Petar Karafezov

MetaMarkets.com
415-575-3015
-------------------------------------------
Investing Out Loud at
http://www.metamarkets.com
-------------------------------------------

From brent at rcfile.org  Wed Feb 21 16:17:38 2001
From: brent at rcfile.org (Brent Verner)
Date: Fri Jan  9 21:58:48 2004
Subject: [mod_python] mod_python2.7.2 and server redirects
In-Reply-To: <86FC34EA3C4F074AA6BBFFE52ED83FED27BDA3@METAEXCH.sfo.metamarkets.com>; from petar@metamarkets.com on Wed, Feb 21, 2001 at 12:08:07PM -0800
References: <86FC34EA3C4F074AA6BBFFE52ED83FED27BDA3@METAEXCH.sfo.metamarkets.com>
Message-ID: <20010221161738.A9355@rcfile.org>

On 21 Feb 2001 at 12:08 (-0800), Petar Karafezov wrote:
| hello all -
| 
| let me fist say that I love mod_python - works great - much faster than any
| cgi! Thanks, Grisha! 
| 
| I am seeing some weirdness when working with server redirects - I'm simply
| trying to catch the headers from the server, modify the location key and
| then send it to the client. It work ok under the CGI, but when I see the
| headers that my .py reports when accessed with lynx -mime_header option
| (which simply prints the headers and body and exits) instead of HTTP/1.1 302
| Found, I see HTTP/1.1 200 OK. I am not sure why this is happening.. Any
| ideas ??

this faq entry may help.

http://www.modpython.org/FAQ/faqw.py?req=show&file=faq03.002.htp

  brent

-- 
"We want to help, but we wouldn't want to deprive you of a valuable 
learning experience."
                                          http://openbsd.org/mail.html

From joost.damad at siemens.atea.be  Thu Feb 22 08:09:37 2001
From: joost.damad at siemens.atea.be (Joost Yervante Damad)
Date: Fri Jan  9 21:58:48 2004
Subject: [mod_python] mod_python/publisher/solaris truncation problems
In-Reply-To: <3A93D1D5.45555DBB@caveosystems.com>; from rsalz@caveosystems.com on Wed, Feb 21, 2001 at 09:33:57AM -0500
References: <20010221102346.A15890@siemens.atea.be> <20010221102939.A16904@siemens.atea.be> <3A93D1D5.45555DBB@caveosystems.com>
Message-ID: <20010222080937.A27533@siemens.atea.be>

'Rich Salz' wrote about 'Re: [mod_python] mod_python/publisher/solaris truncation problems' - Wed, Feb 21, 2001 at 03:33:57PM CET
> a diff would be more useful. ...

True... but the changes I made are not really meant as a
solution. They merely show how we solved it to have a workable
mod_python. I can get you a diff if you want. (see attachment)
It's not a very usefull diff imho tho :)

-- 
Joost Damad - Siemens IC D NC A - +3214252297
--
Five is a sufficiently close approximation to infinity.
       -- Robert Firth
"One, two, five."
       -- Monty Python and the Holy Grail
-------------- next part --------------
--- mod_python-2.7.2/src/_apachemodule.c	Mon Dec 18 20:50:03 2000
+++ ../delta/changed_src/_apachemodule.c	Wed Feb 21 10:15:03 2001
@@ -48,10 +48,14 @@
  *
  */
 
 #include "mod_python.h"
 
+#ifdef ATEA_DEBUG
+#undef ATEA_DEBUG
+#endif
+ 
 /** 
  ** log_error
  **
  *  A wrpapper to ap_log_error
  * 
@@ -253,11 +257,11 @@
 static PyObject *parse_qsl(PyObject *self, PyObject *args)
 {
 
     PyObject *pairs;
     int i, len;
-    char *qs;
+    char *qs, *cpair;
     int keep_blank_values = 0;
     int strict_parsing = 0; /* XXX not implemented */
 
     if (! PyArg_ParseTuple(args, "s|ii", &qs, &keep_blank_values, 
 			   &strict_parsing)) 
@@ -269,83 +273,131 @@
 	return NULL;
 
     i = 0;
     len = strlen(qs);
 
+	cpair=calloc(1,len);
+	
     while (i < len) {
 
-	PyObject *pair, *key, *val;
-	char *cpair, *ckey, *cval;
+	/*PyObject *pair, *key, *val;*/
+	PyObject *key, *val;
+	/*char *cpair, *ckey, *cval;*/
+	char *ckey, *cval;
 	int plen, j, p, k, v;
 
-	pair = PyString_FromStringAndSize(NULL, len);
+	/* pair = PyString_FromStringAndSize(NULL, len);
 	if (pair == NULL)
-	    return NULL;
+	    return NULL;*/
 
 	/* split by '&' or ';' */
-	cpair = PyString_AS_STRING(pair);
+	/*cpair = PyString_AS_STRING(pair);
+	  cpair=calloc(1,len);*/
+#ifdef ATEA_DEBUG
+	fprintf(stderr, "all pairs: %s\n", cpair);
+#endif
 	j = 0;
 	while ((qs[i] != '&') && (qs[i] != ';') && (i < len)) {
 	    /* replace '+' with ' ' */
 	    cpair[j] = (qs[i] == '+') ? ' ' : qs[i];
 	    i++;
 	    j++;
 	}
 	cpair[j] = '\0';
-	_PyString_Resize(&pair, j);
+	/*_PyString_Resize(&pair, j);*/
 
 	/* split the "abc=def" pair */
-
+#ifdef ATEA_DEBUG
+	fprintf(stderr,"[foo] cpair == %s\n", cpair);
+#endif
 	plen = strlen(cpair);
-	key = PyString_FromStringAndSize(NULL, plen);
-	if (key == NULL) 
-	    return NULL;
-	val = PyString_FromStringAndSize(NULL, plen);
-	if (val == NULL) 
-	    return NULL;
-
-	ckey = PyString_AS_STRING(key);
-	cval = PyString_AS_STRING(val);
+#ifdef ATEA_DEBUG
+	fprintf(stderr,"plen == %d\n", plen);
+#endif
+	/*key = PyString_FromStringAndSize(NULL, plen);
+	  if (key == NULL)
+	      return NULL;
+	  val = PyString_FromStringAndSize(NULL, plen);
+	  if (val == NULL)
+	      return NULL;*/
 
+	/*ckey = PyString_AS_STRING(key);
+	  cval = PyString_AS_STRING(val);*/
+	
+	ckey = calloc(1,plen);
+	cval = calloc(1,plen);
+	/*memset(ckey,0,plen);
+	  memset(cval,0,plen);*/
+#ifdef ATEA_DEBUG
+	fprintf(stderr,"ckey=%s, cval=%s (should be empty)\n", ckey, cval);
+#endif
+	
 	p = 0;
 	k = 0;
 	v = 0;
 	while (p < plen) {
-	    if (cpair[p] != '=') {
-		ckey[k] = cpair[p];
-		k++;
-		p++;
+	    if (cpair[p] != '=')
+		{
+#ifdef ATEA_DEBUG
+			fprintf(stderr,"%d cpair=%s ckey=%s, cval=%s (parsing before '=')\n", p, cpair, ckey, cval);
+#endif
+			ckey[k] = cpair[p];
+			k++;
+			p++;
 	    }
 	    else {
-		p++;      /* skip '=' */
-		while (p < plen) {
-		    cval[v] = cpair[p];
-		    v++;
-		    p++;
-		}
+			p++;      /* skip '=' */
+#ifdef ATEA_DEBUG
+			fprintf(stderr, ">>> entering else branch...\n");
+#endif
+			while (p < plen)
+			{
+#ifdef ATEA_DEBUG
+				fprintf(stderr,"%d cpair=%s ckey=%s, cval=%s (parsing after '=')\n", p, cpair, ckey, cval);
+#endif
+		    	cval[v] = cpair[p];
+		    	v++;
+		    	p++;
+			}
 	    }
 	}
 	ckey[k] = '\0';
 	cval[v] = '\0';
+#ifdef ATEA_DEBUG
+	fprintf(stderr,"ckey=%s, cval=%s\n (final)", ckey, cval);
+#endif
 
 	if (keep_blank_values || (v > 0)) {
 
 	    ap_unescape_url(ckey);
 	    ap_unescape_url(cval);
 
-	    _PyString_Resize(&key, strlen(ckey));
-	    _PyString_Resize(&val, strlen(cval));
+	    /*_PyString_Resize(&key, strlen(ckey));
+	      _PyString_Resize(&val, strlen(cval));*/
 
+		key = PyString_FromStringAndSize(ckey, strlen(ckey));
+		if (key == NULL) {
+		  	free(ckey); free(cval); free(cpair);
+	    	return NULL;
+		}
+		val = PyString_FromStringAndSize(cval, strlen(cval));
+		if (val == NULL) {
+		  	free(ckey); free(cval); free(cpair);
+		    return NULL;
+		}
+		
 	    PyList_Append(pairs, Py_BuildValue("(O,O)", key, val));
 
 	}
-	Py_DECREF(pair);
+	/*Py_DECREF(pair);*/
 	Py_DECREF(key);
 	Py_DECREF(val);
 	i++;
+	free(ckey);
+	free(cval);
     }
-
+	free(cpair);
     return pairs;
 }
 
 
 /* methods of _apache */
From r.fortnagel at 21torr.com  Thu Feb 22 11:41:01 2001
From: r.fortnagel at 21torr.com (Ralf Fortnagel)
Date: Fri Jan  9 21:58:48 2004
Subject: [mod_python] Problem to run .py scripts thru apache
Message-ID: <NEBBJGBIKKHHFMNEPEKKKEHMCAAA.r.fortnagel@21torr.com>

Hi Folks!

I use Apache/1.3.14 (Win32) mod_python/2.7.1 Python/2.0 on a Win/NT4.0
machine
If i try to start any .py file thru apache, i get following error:

Mod_python error: "PythonHandler test"
Traceback (most recent call last):
  File "c:\programme\python20\lib\mod_python\apache.py", line 180, in
Dispatch
    object = resolve_object(self.req, module, object_str, silent)
  File "c:\programme\python20\lib\mod_python\apache.py", line 396, in
resolve_object
    raise AttributeError, s
AttributeError: module 'c:\programme\python20\lib\test\__init__.py' contains
no 'handler'

please help me, i don't know what's wrong... :(
--
Ralf Fortnagel                21TORR AGENCY gmbh
r.fortnagel@21torr.com        Engineering
tel: +49-7121-348-221         Heinestrasse 72
fax: +49-7121-348-259         D-72762 Reutlignen

21TORR - die neue medien leidenschaft
www.21torr.com


From joost.damad at siemens.atea.be  Thu Feb 22 11:55:49 2001
From: joost.damad at siemens.atea.be (Joost Yervante Damad)
Date: Fri Jan  9 21:58:48 2004
Subject: [mod_python] Problem to run .py scripts thru apache
In-Reply-To: <NEBBJGBIKKHHFMNEPEKKKEHMCAAA.r.fortnagel@21torr.com>; from r.fortnagel@21torr.com on Thu, Feb 22, 2001 at 11:41:01AM +0100
References: <NEBBJGBIKKHHFMNEPEKKKEHMCAAA.r.fortnagel@21torr.com>
Message-ID: <20010222115549.A27399@siemens.atea.be>

'Ralf Fortnagel' wrote about '[mod_python] Problem to run .py scripts thru apache' - Thu, Feb 22, 2001 at 11:41:01AM CET
> Hi Folks!
>
> I use Apache/1.3.14 (Win32) mod_python/2.7.1 Python/2.0 on a Win/NT4.0
> machine
> If i try to start any .py file thru apache, i get following error:
>
> Mod_python error: "PythonHandler test"
> Traceback (most recent call last):
>   File "c:\programme\python20\lib\mod_python\apache.py", line 180, in
> Dispatch
>     object = resolve_object(self.req, module, object_str, silent)
>   File "c:\programme\python20\lib\mod_python\apache.py", line 396, in
> resolve_object
>     raise AttributeError, s
> AttributeError: module 'c:\programme\python20\lib\test\__init__.py' contains
> no 'handler'
>
> please help me, i don't know what's wrong... :(
> --
> Ralf Fortnagel                21TORR AGENCY gmbh
> r.fortnagel@21torr.com        Engineering
> tel: +49-7121-348-221         Heinestrasse 72
> fax: +49-7121-348-259         D-72762 Reutlignen
> 
> 21TORR - die neue medien leidenschaft
> www.21torr.com
> 

I asume you have in your apache config file:

PythonHandler test

This means that mod_python needs to look for a pythonscript called 'test'.

But :) In your Pythonpath you also have the dir c:\programme\python20\lib\
and the directory c:\programme\python20\lib\test\ matches your handler.

Python then looks for an __init__.py to 'execute' the directory as a
pythonscript, and this is obviously not what you want.

Joost

-- 
Joost Damad - Siemens IC D NC A - +3214252297
--
Five is a sufficiently close approximation to infinity.
       -- Robert Firth
"One, two, five."
       -- Monty Python and the Holy Grail

From brianh at exelixis.com  Thu Feb 22 20:11:38 2001
From: brianh at exelixis.com (Brian Hawthorne)
Date: Fri Jan  9 21:58:48 2004
Subject: [mod_python] Stackless python
Message-ID: <Pine.GSO.4.05.10102222009490.13571-100000@timeless.exelixis.com>

i wonder, 
has anyone embedded stackless python in apache using mod_python?

brian


From ensim.ml.mod_python at ensim.com  Thu Feb 22 22:41:45 2001
From: ensim.ml.mod_python at ensim.com (Ensim-Newsgroups.Mailing-Lists.Mod_Python-List)
Date: Fri Jan  9 21:58:48 2004
Subject: [mod_python] browser connection state
Message-ID: <9AC41B8C4781464695BB013F106FCA3181A5A5@nasdaq.ms.ensim.com>

is there a way in mod python to check whether the browser connection has
been aborted?  ie, given a single request, before writing each chunk of
response data to the browser, can we check whether the browser user pressed
the stop button (or pressed escape).

From miguel at yorku.ca  Fri Feb 23 08:40:13 2001
From: miguel at yorku.ca (Miguel Marques)
Date: Fri Jan  9 21:58:48 2004
Subject: [mod_python] browser connection state
In-Reply-To: <9AC41B8C4781464695BB013F106FCA3181A5A5@nasdaq.ms.ensim.com>
References: <9AC41B8C4781464695BB013F106FCA3181A5A5@nasdaq.ms.ensim.com>
Message-ID: <20010223084013J.miguel@yorku.ca>

Greetings...
On Thu, 22 Feb 2001 22:41:45 -0800, "Ensim-Newsgroups.Mailing-Lists.Mod_Python-List" <ensim.ml.mod_python@ensim.com> wrote:
> is there a way in mod python to check whether the browser connection has
> been aborted?  ie, given a single request, before writing each chunk of
> response data to the browser, can we check whether the browser user pressed
> the stop button (or pressed escape).
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

If the browser goes away for any reason (stop, reload, etc) and you
try to write to the client, you get an IOError exception which you can
catch.  

I usually have req.write(" ")'s just before database writes and the
such to try and cause this exception to be thrown so I can clean up
and exit and not do anything.

						      Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830

From sergio at royalwebhosting.com  Fri Feb 23 15:39:41 2001
From: sergio at royalwebhosting.com (Sergio Baca)
Date: Fri Jan  9 21:58:48 2004
Subject: [mod_python] mod_python vs java servlets
Message-ID: <157254279584.20010223153941@royalwebhosting.com>

Hello mod,

  How is comparable mod_python with java servlets? Because using
  JPython comparison can be easy made, have anybody thought about
  this?

-- 
Best regards,
 Sergio                          mailto:sergio@royalwebhosting.com



From naris at ensim.com  Fri Feb 23 11:00:39 2001
From: naris at ensim.com (Naris Siamwalla)
Date: Fri Jan  9 21:58:48 2004
Subject: [mod_python] browser connection state
Message-ID: <9AC41B8C4781464695BB013F106FCA3181A5AA@nasdaq.ms.ensim.com>

catching the IOError exception is fine, but can i assume for -*all*- IOError
exceptions thrown when i req.write was because of a stop/reload?  could an
IOError be thrown for other reasons (e.g. apache itself causing mod_python
to throw the IOError exception) ?  if there are no other reaons, then i
guess it's safe to write a try block that assumes so.

-----Original Message-----
From: Miguel Marques [mailto:miguel@yorku.ca]
Sent: Friday, February 23, 2001 5:40 AM
To: ensim.ml.mod_python@ensim.com
Cc: mod_python@modpython.org
Subject: Re: [mod_python] browser connection state


Greetings...
On Thu, 22 Feb 2001 22:41:45 -0800,
"Ensim-Newsgroups.Mailing-Lists.Mod_Python-List"
<ensim.ml.mod_python@ensim.com> wrote:
> is there a way in mod python to check whether the browser connection has
> been aborted?  ie, given a single request, before writing each chunk of
> response data to the browser, can we check whether the browser user
pressed
> the stop button (or pressed escape).
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

If the browser goes away for any reason (stop, reload, etc) and you
try to write to the client, you get an IOError exception which you can
catch.  

I usually have req.write(" ")'s just before database writes and the
such to try and cause this exception to be thrown so I can clean up
and exit and not do anything.

						      Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python

From ensim.ml.mod_python at ensim.com  Fri Feb 23 11:36:51 2001
From: ensim.ml.mod_python at ensim.com (Ensim-Newsgroups.Mailing-Lists.Mod_Python-List)
Date: Fri Jan  9 21:58:48 2004
Subject: [mod_python] browser connection state
Message-ID: <9AC41B8C4781464695BB013F106FCA3181A5AC@nasdaq.ms.ensim.com>

catching the IOError exception is fine, but can i assume for -*all*- IOError
exceptions thrown when i req.write was because of a stop/reload?  could an
IOError be thrown for other reasons (e.g. apache itself causing mod_python
to throw the IOError exception) ?  if there are no other reaons, then i
guess it's safe to write a try block that assumes so.

-----Original Message-----
From: Miguel Marques [mailto:miguel@yorku.ca]
Sent: Friday, February 23, 2001 5:40 AM
To: ensim.ml.mod_python@ensim.com
Cc: mod_python@modpython.org
Subject: Re: [mod_python] browser connection state


Greetings...
On Thu, 22 Feb 2001 22:41:45 -0800,
"Ensim-Newsgroups.Mailing-Lists.Mod_Python-List"
<ensim.ml.mod_python@ensim.com> wrote:
> is there a way in mod python to check whether the browser connection has
> been aborted?  ie, given a single request, before writing each chunk of
> response data to the browser, can we check whether the browser user
pressed
> the stop button (or pressed escape).
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

If the browser goes away for any reason (stop, reload, etc) and you
try to write to the client, you get an IOError exception which you can
catch.  

I usually have req.write(" ")'s just before database writes and the
such to try and cause this exception to be thrown so I can clean up
and exit and not do anything.

						      Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python

From miguel at yorku.ca  Fri Feb 23 14:40:04 2001
From: miguel at yorku.ca (Miguel Marques)
Date: Fri Jan  9 21:58:48 2004
Subject: [mod_python] browser connection state
In-Reply-To: <9AC41B8C4781464695BB013F106FCA3181A5AA@nasdaq.ms.ensim.com>
References: <9AC41B8C4781464695BB013F106FCA3181A5AA@nasdaq.ms.ensim.com>
Message-ID: <20010223144004T.miguel@yorku.ca>

On Fri, 23 Feb 2001 11:00:39 -0800, Naris Siamwalla <naris@ensim.com> wrote:
> catching the IOError exception is fine, but can i assume for -*all*- IOError
> exceptions thrown when i req.write was because of a stop/reload?  could an
> IOError be thrown for other reasons (e.g. apache itself causing mod_python
> to throw the IOError exception) ?  if there are no other reaons, then i
> guess it's safe to write a try block that assumes so.

Gregory would better be able to answer that than me.  
I'm just a mod_python user...

However, IMHO, even if the IOError error happens inside of apache or
for some other reason, it means you lost the connection to the browser and
therefore that you won't be able to send a response to the user.
In that case you probably should abort whatever the user requested
since s/he will probably assume it didn't work since no page got sent
back.  Or am I missing the point?

       						Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830


From ensim.ml.mod_python at ensim.com  Fri Feb 23 11:49:34 2001
From: ensim.ml.mod_python at ensim.com (Ensim-Newsgroups.Mailing-Lists.Mod_Python-List)
Date: Fri Jan  9 21:58:48 2004
Subject: [mod_python] browser connection state
Message-ID: <9AC41B8C4781464695BB013F106FCA3181A5AE@nasdaq.ms.ensim.com>

you're right....i guess i'm over-analyzing :-)

IOError raised during req.write means you had a problem writing, plain and
simple.  and if you had a problem writing, your python code should handle it
accordingly.

-----Original Message-----
From: Miguel Marques [mailto:miguel@yorku.ca]
Sent: Friday, February 23, 2001 11:40 AM
To: naris@ensim.com
Cc: mod_python@modpython.org
Subject: Re: RE: [mod_python] browser connection state


On Fri, 23 Feb 2001 11:00:39 -0800, Naris Siamwalla <naris@ensim.com> wrote:
> catching the IOError exception is fine, but can i assume for -*all*-
IOError
> exceptions thrown when i req.write was because of a stop/reload?  could an
> IOError be thrown for other reasons (e.g. apache itself causing mod_python
> to throw the IOError exception) ?  if there are no other reaons, then i
> guess it's safe to write a try block that assumes so.

Gregory would better be able to answer that than me.  
I'm just a mod_python user...

However, IMHO, even if the IOError error happens inside of apache or
for some other reason, it means you lost the connection to the browser and
therefore that you won't be able to send a response to the user.
In that case you probably should abort whatever the user requested
since s/he will probably assume it didn't work since no page got sent
back.  Or am I missing the point?

       						Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830

From rbeer at uni-goettingen.de  Sat Feb 24 18:53:30 2001
From: rbeer at uni-goettingen.de (Ragnar Beer)
Date: Fri Jan  9 21:58:48 2004
Subject: [mod_python] Apache children RAM use
Message-ID: <p04330104b6bda4a03c43@[134.76.136.114]>

Howdy!

I'm absolutely new to mod_python and I wonder what happens to the 
memory use of apache children when mod_python is compiled in. Coming 
from mod_perl I'm expecting the worst. How about mod_python?

Ragnar Beer

From gege at china.com  Mon Feb 26 23:04:33 2001
From: gege at china.com (gege@china.com)
Date: Fri Jan  9 21:58:48 2004
Subject: [mod_python] help
Message-ID: <8z989773769566.05317@mail2.china.com>

 under windows 98 apache 1.3.17

I copy mod_python.dll to /apache/modules

copy mod_python to c:\python20\lib

add row LoadModule python_module modules/mod_python.dll to httpd.conf

add 

<Directory "C:/Apache/htdocs/python">
    AddHandler python-program .py
    PythonHandler mptest
    PythonDebug On
</Directory>

to httpd.conf too.

then restart apache. when i enter http://localhost/python, i can see mptest.py.

but when i click mptest.py, the browser tells me

Internal Server Error
The server encountered an internal error or misconfiguration and was unable to complete your request.

what happens?

error.log looks like:

[Mon Feb 26 15:50:18 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
'import site' failed; use -v for traceback
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
Apache server shutdown initiated...
'import site' failed; use -v for traceback
'import site' failed; use -v for traceback
[Mon Feb 26 20:26:18 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:37 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:39 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:40 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:41 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:41 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:41 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:42 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:42 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:42 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:42 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:42 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:43 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:43 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:43:04 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:44:42 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:46:02 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
'import site' failed; use -v for traceback
'import site' failed; use -v for traceback
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
'import site' failed; use -v for traceback
[Mon Feb 26 20:57:49 2001] [error] [

************************************

http://hospital.china.com/

http://lovesky.china.com

From petar at metamarkets.com  Mon Feb 26 11:03:33 2001
From: petar at metamarkets.com (Petar Karafezov)
Date: Fri Jan  9 21:58:48 2004
Subject: [mod_python] RE: my_file.pyc is not created anymore ...what changed ?
Message-ID: <86FC34EA3C4F074AA6BBFFE52ED83FED27BDBC@METAEXCH.sfo.metamarkets.com>

Hello all -

I was going through a lot of reconfiguration of my apache+mod_python setup,
including migrating it to different server and it seems that somewhere in
all changes made I have "lost" the .pyc files functionality. Before I'd see
a .pyc file being created after mod_python would process my .py handlers.
According to the docs - it would not recompile again if the .py file doesn't
get changed and just use the pre-compiled byte code.

I did a fresh install of apache and mod_python 2.7.2 both with python 1.5.2
(the standard RPm that comes with RH6.2) and with compiled from source
Python2.0 - and I still don't see the .pyc iles created. Any ideas ??

Thanks all for your help!

Regards,
Petar Karafezov

From gege at china.com  Tue Feb 27 03:26:18 2001
From: gege at china.com (gege@china.com)
Date: Fri Jan  9 21:58:48 2004
Subject: [mod_python] what's happen?
Message-ID: <Di989772967381.12116@mail3.china.com>

under redhat 6.2 python 2.1a2 mod_python 2.7.2 apache 1.3.12

lynx http://localhost/python/mptest.py

it appears Hello World!

but when I type lynx http://localhost/python/test.py or some other filename.py

it also appears Hello World!

I don't understand...

from other client by using IE, it gives the same result.
************************************

http://hospital.china.com/

http://lovesky.china.com

From gege at china.com  Tue Feb 27 03:25:48 2001
From: gege at china.com (gege@china.com)
Date: Fri Jan  9 21:58:48 2004
Subject: [mod_python] what's happen?
Message-ID: <Ac989772967451.24452@mail3.china.com>

under redhat 6.2 python 2.1a2 mod_python 2.7.2 apache 1.3.12

lynx http://localhost/python/mptest.py

it appears Hello World!

but when I type lynx http://localhost/python/test.py or some other filename.py

it also appears Hello World!

I don't understand...

from other client by using IE, it gives the same result.
************************************

http://hospital.china.com/

http://lovesky.china.com

From gege at china.com  Tue Feb 27 03:25:18 2001
From: gege at china.com (gege@china.com)
Date: Fri Jan  9 21:58:48 2004
Subject: [mod_python] what's happen?
Message-ID: <EJ989772967481.12100@mail3.china.com>

under redhat 6.2 python 2.1a2 mod_python 2.7.2 apache 1.3.12

lynx http://localhost/python/mptest.py

it appears Hello World!

but when I type lynx http://localhost/python/test.py or some other filename.py

it also appears Hello World!

I don't understand...

from other client by using IE, it gives the same result.
************************************

http://hospital.china.com/

http://lovesky.china.com

From brent at rcfile.org  Mon Feb 26 14:34:16 2001
From: brent at rcfile.org (Brent Verner)
Date: Fri Jan  9 21:58:48 2004
Subject: [mod_python] RE: my_file.pyc is not created anymore ...what changed ?
In-Reply-To: <86FC34EA3C4F074AA6BBFFE52ED83FED27BDBC@METAEXCH.sfo.metamarkets.com>; from petar@metamarkets.com on Mon, Feb 26, 2001 at 11:03:33AM -0800
References: <86FC34EA3C4F074AA6BBFFE52ED83FED27BDBC@METAEXCH.sfo.metamarkets.com>
Message-ID: <20010226143416.A53686@rcfile.org>

On 26 Feb 2001 at 11:03 (-0800), Petar Karafezov wrote:
| Hello all -
| 
| I was going through a lot of reconfiguration of my apache+mod_python setup,
| including migrating it to different server and it seems that somewhere in
| all changes made I have "lost" the .pyc files functionality. Before I'd see
| a .pyc file being created after mod_python would process my .py handlers.
| According to the docs - it would not recompile again if the .py file doesn't
| get changed and just use the pre-compiled byte code.
| 
| I did a fresh install of apache and mod_python 2.7.2 both with python 1.5.2
| (the standard RPm that comes with RH6.2) and with compiled from source
| Python2.0 - and I still don't see the .pyc iles created. Any ideas ??

perhaps the directory where your .py files (and the desired .pyc) files
live is not writable by the user the web server is running as? I've found
it very useful to create a new group, add myself and the web server user
to that group, then own the python web directories to that group and chmod
it g+w.

hth.
	brent

From miguel at yorku.ca  Mon Feb 26 15:01:24 2001
From: miguel at yorku.ca (Miguel Marques)
Date: Fri Jan  9 21:58:48 2004
Subject: [mod_python] what's happen?
In-Reply-To: <Ac989772967451.24452@mail3.china.com>
References: <Ac989772967451.24452@mail3.china.com>
Message-ID: <20010226150124M.miguel@yorku.ca>

On Tue, 27 Feb 2001 03:25:48 +0800 (CST), gege@china.com wrote:
> under redhat 6.2 python 2.1a2 mod_python 2.7.2 apache 1.3.12
> 
> lynx http://localhost/python/mptest.py
> 
> it appears Hello World!
> 
> but when I type lynx http://localhost/python/test.py or some other filename.py
> 
> it also appears Hello World!
> 
> I don't understand...

AddHandler python-program .py
specifies .py files are to be handled by the handler python-program.

The handler for files of type python-program in that directory is
whatever you specified as the PythonHandler in your apache
configuration file.

So any filename ending in .py gets handled by running mptest.py (I'm
guessing that's what you specified).
If you wanted to do something based on the filename you could 
look at req.uri in mptest.py.

If for instance you use 
SetHandler python-program
instead of
AddHandler python-program .py
then any reference to a file in that directory runs mptest.py
regardless of extension.

Hope this helps.

							Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830

From petar at metamarkets.com  Mon Feb 26 12:03:18 2001
From: petar at metamarkets.com (Petar Karafezov)
Date: Fri Jan  9 21:58:48 2004
Subject: [mod_python] RE: my_file.pyc is not created anymore ...what c
	hanged ?
Message-ID: <86FC34EA3C4F074AA6BBFFE52ED83FED27BDBD@METAEXCH.sfo.metamarkets.com>

duh! of course ... :) Thanks, Brent!

-----Original Message-----
From: Brent Verner [mailto:brent@rcfile.org]
Sent: Monday, February 26, 2001 11:34 AM
To: Petar Karafezov
Cc: mod_python@modpython.org
Subject: Re: [mod_python] RE: my_file.pyc is not created anymore ...what
changed ?


On 26 Feb 2001 at 11:03 (-0800), Petar Karafezov wrote:
| Hello all -
| 
| I was going through a lot of reconfiguration of my apache+mod_python
setup,
| including migrating it to different server and it seems that somewhere in
| all changes made I have "lost" the .pyc files functionality. Before I'd
see
| a .pyc file being created after mod_python would process my .py handlers.
| According to the docs - it would not recompile again if the .py file
doesn't
| get changed and just use the pre-compiled byte code.
| 
| I did a fresh install of apache and mod_python 2.7.2 both with python
1.5.2
| (the standard RPm that comes with RH6.2) and with compiled from source
| Python2.0 - and I still don't see the .pyc iles created. Any ideas ??

perhaps the directory where your .py files (and the desired .pyc) files
live is not writable by the user the web server is running as? I've found
it very useful to create a new group, add myself and the web server user
to that group, then own the python web directories to that group and chmod
it g+w.

hth.
	brent

From mail4myx at yahoo.de  Wed Feb 28 17:06:12 2001
From: mail4myx at yahoo.de (=?iso-8859-1?q?anja=20schmidt?=)
Date: Fri Jan  9 21:58:48 2004
Subject: [mod_python] mod_python, NT, PythonPath
Message-ID: <20010228160612.48560.qmail@web12803.mail.yahoo.com>

Hi,
okay, I've spent almost the whole day trying to
integrate mod_python in NT and I'm getting craaaaazy
now!

I've browsed through the archives and I'm getting the
same error message like George Jempty(5th of December
2000). But he didn't get a reply so I try once again:

The error message in the apache error.log is: 
python_handler: make_obcallback returned no
obCallBack!

After browsing the archives I sort of understand that
the extracted python files of mod_python-2.7.2.tgz
can't be located. I've put them in the
C:\Programme\Python20\Lib\mod_python-2.7.2 directory
and I've pointed the PYTHONPATH env-variable to this.
Didn't work.

The lines in the httpd.conf-file look like

<Directory "C:/Programme/Apache
Group/Apache/htdocs/python">
	AddHandler python-program .py
	PythonHandler mptest
	PythonDebug on
</Directory> 

I also tried to define the PythonPath-variable in
between the <Directory /> tags: PythonPath
"C:/Programme/Python20/Lib/mod_python-2.7.2/" Didn't
work! (And I also tried with other python files, so it
has nothing to do with the name of the .py file,
mptest or test).

So, if anyone knows the answer: Please be so kind to
tell me. Thanks a lot in advance!!

Anja

__________________________________________________________________
Do You Yahoo!?
Gesendet von Yahoo! Mail - http://mail.yahoo.de

From victor at prodigy.net  Wed Feb 28 11:28:24 2001
From: victor at prodigy.net (Victor Muslin)
Date: Fri Jan  9 21:58:48 2004
Subject: [mod_python] mod_python, NT, PythonPath
In-Reply-To: <20010228160612.48560.qmail@web12803.mail.yahoo.com>
Message-ID: <5.0.0.25.0.20010228111927.03518980@localhost>

I used to get the same error before I set things up so that mod_python 
PACKAGE is found.

Make sure you mod_python Python PACKAGE (not the DLL files) and make sure 
that PYTHONPATH environmental variable points to the directory where the 
package is located. The mod_python package is a set of python files in a 
mod_python directory and a bunch of subdirectories.

For example, if you put the package in C:\python_packages (so that you now 
have c:\python_packages\mod_python\...) make sure PYTHONPATH has 
C:\python_packages in it. Then restart Apache.

What you want to do is define PYTHONPATH in your environment BEFORE 
starting the Apache (so that Apache process inherits it). You can then also 
do in httpd.conf:

PassEnv PYTHONPATH

though I don't think it makes a difference.

Hope this helps.


At 05:06 PM 2/28/2001 +0100, anja schmidt wrote:
>Hi,
>okay, I've spent almost the whole day trying to
>integrate mod_python in NT and I'm getting craaaaazy
>now!
>
>I've browsed through the archives and I'm getting the
>same error message like George Jempty(5th of December
>2000). But he didn't get a reply so I try once again:
>
>The error message in the apache error.log is:
>python_handler: make_obcallback returned no
>obCallBack!
>
>After browsing the archives I sort of understand that
>the extracted python files of mod_python-2.7.2.tgz
>can't be located. I've put them in the
>C:\Programme\Python20\Lib\mod_python-2.7.2 directory
>and I've pointed the PYTHONPATH env-variable to this.
>Didn't work.
>
>The lines in the httpd.conf-file look like
>
><Directory "C:/Programme/Apache
>Group/Apache/htdocs/python">
>         AddHandler python-program .py
>         PythonHandler mptest
>         PythonDebug on
></Directory>
>
>I also tried to define the PythonPath-variable in
>between the <Directory /> tags: PythonPath
>"C:/Programme/Python20/Lib/mod_python-2.7.2/" Didn't
>work! (And I also tried with other python files, so it
>has nothing to do with the name of the .py file,
>mptest or test).
>
>So, if anyone knows the answer: Please be so kind to
>tell me. Thanks a lot in advance!!
>
>Anja
>
>__________________________________________________________________
>Do You Yahoo!?
>Gesendet von Yahoo! Mail - http://mail.yahoo.de
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://www.modpython.org/mailman/listinfo/mod_python

_________________________________________________________________________
Victor Muslin    The power of accurate observation is frequently called
                       cynicism by those who don't have it.
                           - George Bernard Shaw
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010228/adaf2ea4/attachment-0002.htm
From brett at bookshop.unsw.edu.au  Thu Feb  1 14:36:05 2001
From: brett at bookshop.unsw.edu.au (Brett Haydon)
Date: Fri Jan  9 22:02:36 2004
Subject: [mod_python] modpublisher security model
Message-ID: <NCBBKMABOKFCDLPIKKGIMEHGCJAA.brett@bookshop.unsw.edu.au>

Evidently Zope currently uses the doc string to 
explicity allow access to functions via URL.

The new Python 2.1 will allow functions to have
attributes.

I am currently renaming all imported modules with
an underscore to avoid unintentional security problems
(and global objects)
but I like the idea of explicitly allowing access.

Any plans to move in this direction.

regards,
______________________________________________
Brett Haydon


From x at vex.net  Tue Feb  6 13:59:21 2001
From: x at vex.net (T. Muddletin)
Date: Fri Jan  9 22:02:36 2004
Subject: [mod_python] math import
Message-ID: <158300828588.20010206135921@vex.net>

I'm playing with netbsd 1.5/apache 1.3.17/python 2.0/mod_python 2.7.1
(DSO).

Using the cgihandler... when i try to import the standard python math
module i get...

PythonHandler mod_python.cgihandler: Traceback (most recent call last):
PythonHandler mod_python.cgihandler:   File "/usr/pkg/lib/python2.0/site-packages/mod_python/apache.py", line 189, in Dispatch
    result = object(self.req)
PythonHandler mod_python.cgihandler:   File "/usr/pkg/lib/python2.0/site-packages/mod_python/cgihandler.py", line 122, in handler
    imp.load_module(module_name, fd, path, desc)
PythonHandler mod_python.cgihandler:   File "/usr/home/x/public_html/test.py", line 21, in ?
    import math
PythonHandler mod_python.cgihandler: ImportError: error in dynamic linking

Is this a DSO issue? I hope not, because i haven't been able to get
apache to static compile with the mod yet either...

-- 
Tim Middleton | Cain Gang Ltd | There are a thousand hacking at the branches
x@veX.net     | www.Vex.Net   | of evil [but who] at the root. --Thoreau (W)



From brent at rcfile.org  Wed Feb  7 08:59:53 2001
From: brent at rcfile.org (Brent Verner)
Date: Fri Jan  9 22:02:36 2004
Subject: [mod_python] [RFC] mod_python embedded python module
Message-ID: <20010207085953.B4193@rcfile.org>

Hi,
  
  First off, Gregory, thanks for writing this nice software :)

  Secondly, after looking into mod_python and mod_snake, I've 
decided that _I_ like mod_python (the base python/apache binding)
much better than mod_snake. Now, I'm not a python programmer, but
there's no better way to learn than to do, so last night I started
hacking up a module/handler to handle documents having embedded
HTML, the feature which drew me toward mod_snake at first.

  What I intend to do with this module is have it:
    1) parse (so to speak) a document containing HTML-embedded python
       code into pure python code. My tentative direction is to:
        a) create a python file that looks like
========================================================
env = {}
def embedded_output_hook(req):
  env = req.subprocess_env
  req.write("""<html>
<head>
<title>"""
  req.write( req.uri )
  req.write("""</title>
</head>
<body>
"""
  for i in env.keys():
    req.write("""<b>""")
    req.write( i )
    req.write(""": """)
    req.write( env[i] )
    req.write("""</b><br>
""")
  # for
  req.write("""</body
</html>
""")

========================================================
from an HTML-embedded file of:
========================================================
<html>
<head>
<title><?= req.uri ?></title>
</head>
<body>
<?
  for i in env.keys():
?>
<b><?= i ?>: <?= env[i] ?></b><br>
<?
  # for
?>
</body>
</html>
========================================================

       and the module will call embedded_output_hook(req) from 
       the loaded module. Also, I've thought of having calls to
       content_type/auth/cleanup functions which may be defined in
       the document...
    2) save those parsed files to a cache directory, where they'll
       actually be loaded from when the correspondeing HTML-embedded
       file is requested via the handler. Of course I'm stat()ing
       the files to make sure the parsed/cached file is up to date.

That is all fairly simple, from the overview, but I do have a few 
questions before I go too far down the wrong road :):
  1) is this approach sane, or is there a more elegant/efficient
     way to handle this?
  2) To create the pure-python file from the embedded document, I'm
     pretty sure some restrictions will have to be made on the
     location/designation of functions. What is a reasonable set
     of restrictions that can/should be placed on this so the module
     doesn't become a major-hack-of-a-buncha-special-cases :)
  3) I'm using load_module(...) to load the pure-python files. Is
     there any way (a different one?) that will allow the loaded
     module to access globals from the module's environment, i.e.,
     database connections, et. al.
  4) Is there any way to have multile 'AddHandler' types in the same 
     config section? If not, will you accept clean patches to do so?


comments and discussion are requested. I'm going to do this, I just
want to make sure I do something that is maximally useful :) I'll
not be resonding to this thread until the weekend, cause I've got
some real (non-python :() work that _must_ get done to free up my
weekend to get on with this hack.

thanks.
  brent

-- 
"We want to help, but we wouldn't want to deprive you of a valuable 
learning experience."
                                          http://openbsd.org/mail.html

From jmcbray at carcosa.net  Wed Feb  7 14:19:28 2001
From: jmcbray at carcosa.net (Jason F. McBrayer)
Date: Fri Jan  9 22:02:36 2004
Subject: [mod_python] [RFC] mod_python embedded python module
In-Reply-To: <20010207085953.B4193@rcfile.org>; from brent@rcfile.org on Wed, Feb 07, 2001 at 08:59:53AM -0500
References: <20010207085953.B4193@rcfile.org>
Message-ID: <20010207141928.B19360@bertrand.carcosa.net>

On Wed, Feb 07, 2001 at 08:59:53AM -0500, Brent Verner wrote:

>   Secondly, after looking into mod_python and mod_snake, I've 
> decided that _I_ like mod_python (the base python/apache binding)
> much better than mod_snake. Now, I'm not a python programmer, but
> there's no better way to learn than to do, so last night I started
> hacking up a module/handler to handle documents having embedded
> HTML, the feature which drew me toward mod_snake at first.

You might also take a look at PMZ (Poor Man's Zope,
pmz.sourceforge.net), which already does this very well.  I did some
work to make it usable as a mod_python module, but I think the
original author has also done so in parallel.  In any case, it's not
too hard to do -- just get PMZ and work on wrapping it in a handler
function, redirecting IO appropriately.

-- 
+----------------------------------------------------------------+
| Jason F. McBrayer                         jmcbray@carcosa.net  |
| The scalloped tatters of the King in Yellow must hide Yhtill   |
| forever.                    R.W. Chambers _The King in Yellow_ |

From miguel at yorku.ca  Wed Feb  7 14:35:45 2001
From: miguel at yorku.ca (Miguel Marques)
Date: Fri Jan  9 22:02:37 2004
Subject: [mod_python] [RFC] mod_python embedded python module
In-Reply-To: <20010207141928.B19360@bertrand.carcosa.net>
References: <20010207085953.B4193@rcfile.org>
	<20010207141928.B19360@bertrand.carcosa.net>
Message-ID: <20010207143545G.miguel@yorku.ca>

Greetings...
On Wed, 7 Feb 2001 14:19:28 -0500, "Jason F. McBrayer" <jmcbray@carcosa.net> wrote:
> On Wed, Feb 07, 2001 at 08:59:53AM -0500, Brent Verner wrote:
> 
> >   Secondly, after looking into mod_python and mod_snake, I've 
> > decided that _I_ like mod_python (the base python/apache binding)
> > much better than mod_snake. Now, I'm not a python programmer, but
> > there's no better way to learn than to do, so last night I started
> > hacking up a module/handler to handle documents having embedded
> > HTML, the feature which drew me toward mod_snake at first.
> 
> You might also take a look at PMZ (Poor Man's Zope,
> pmz.sourceforge.net), which already does this very well.  I did some
> work to make it usable as a mod_python module, but I think the
> original author has also done so in parallel.  In any case, it's not
> too hard to do -- just get PMZ and work on wrapping it in a handler
> function, redirecting IO appropriately.
> 
Another option is getting Zope and extracting DocumentTemplate and
using it.  It allows you to easily insert data from python objects 
into html templates and it has some very nice helper functions you can
use in your templates.

I've several web applications using mod_python and DocumentTemplate
and they work rather nicely.  I believe PMZ offers similar functionality
but you may want to look at DocumentTemplate and see which you like better.

							Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830


From grisha at verio.net  Sat Feb 10 21:26:12 2001
From: grisha at verio.net (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:02:37 2004
Subject: [mod_python] 2.7.2
Message-ID: <Pine.BSF.4.32.0102102124360.22089-100000@localhost>

2.7.2 is available for download.

If you are using the publisher handler, you should upgrade, since 2.7.2
fixes the issue with being able access standard library modules from the
web. It also adds some new authentication features to the publisher
handler.

Grisha


From daniel at copyleft.no  Sun Feb 11 16:16:23 2001
From: daniel at copyleft.no (Hr. Daniel Mikkelsen)
Date: Fri Jan  9 22:02:37 2004
Subject: [mod_python] File uploads.
Message-ID: <Pine.LNX.4.31.0102111613590.27696-100000@unity.copyleft.no>

Hi.

Does anyone have any example code for accepting file uploads with
mod_python? I understand one uses req.read() to get the POSTed data
as usual, and then one parses th query-string in a particular
manner.

Thanks in advance!

-- Daniel Mikkelsen, Copyleft Software AS



From teep at inet.co.th  Mon Feb 12 15:28:03 2001
From: teep at inet.co.th (Prateep Siamwalla)
Date: Fri Jan  9 22:02:37 2004
Subject: [mod_python] Regarding 2.7.2 on windows
Message-ID: <002401c094cd$bb3086a0$0c05a8c0@taramansion.bangkok>

Hi All,

I have been using 2.7.1 on windows for a couple of weeks now [ many thanks
to Enrique Vaamonde for the excellent installation instructions ], and its
been quite a ride.  I'm eager to download the new 2.7.2 which was recently
uploaded.

Question :
Since I'm running compiler impared windows box, will I need to wait for a
new mod_python.dll to be uploaded before installing mod_python 2.7.2?  Or
are the new changes made only to the python files in python20\lib\mod_python
?

Thanks in advance
teep



From jd at pdx.edu  Mon Feb 12 15:19:47 2001
From: jd at pdx.edu (jd@pdx.edu)
Date: Fri Jan  9 22:02:37 2004
Subject: [mod_python] Mod_Python and Solaris Compile Problems
Message-ID: <982019987.3a886f93b61d1@webmail.pdx.edu>

Hi!  I'm trying to install mod_python on my Solaris server and I keep getting
comple problems.  I'm using Apache 1.3.14, PHP 4.0.2pl1, and Mod_Python 2.7.2.  

Here's what happens when I try to compile Apache with the Static Mod_Python (it
also fails on compiling the DSO, see below):

<=== src/modules/python
<=== src/modules
gcc -c  -I./os/unix -I./include   -DSOLARIS2=280 -I/usr/share/src/php-4.0.4pl1
-I/usr/share/src/php-4.0.4pl1/main -I/usr/share/src/php-4.0.4pl1/main
-I/usr/share/src/php-4.0.4pl1/Zend -I/usr/share/src/php-4.0.4pl1/Zend
-I/usr/share/src/php-4.0.4pl1/TSRM -I/usr/share/src/php-4.0.4pl1/TSRM
-I/usr/share/src/php-4.0.4pl1 -DUSE_EXPAT -I./lib/expat-lite `./apaci` modules.c
gcc -c  -I./os/unix -I./include   -DSOLARIS2=280 -I/usr/share/src/php-4.0.4pl1
-I/usr/share/src/php-4.0.4pl1/main -I/usr/share/src/php-4.0.4pl1/main
-I/usr/share/src/php-4.0.4pl1/Zend -I/usr/share/src/php-4.0.4pl1/Zend
-I/usr/share/src/php-4.0.4pl1/TSRM -I/usr/share/src/php-4.0.4pl1/TSRM
-I/usr/share/src/php-4.0.4pl1 -DUSE_EXPAT -I./lib/expat-lite `./apaci`
buildmark.c
gcc  -DSOLARIS2=280 -I/usr/share/src/php-4.0.4pl1
-I/usr/share/src/php-4.0.4pl1/main -I/usr/share/src/php-4.0.4pl1/main
-I/usr/share/src/php-4.0.4pl1/Zend -I/usr/share/src/php-4.0.4pl1/Zend
-I/usr/share/src/php-4.0.4pl1/TSRM -I/usr/share/src/php-4.0.4pl1/TSRM
-I/usr/share/src/php-4.0.4pl1 -DUSE_EXPAT -I./lib/expat-lite `./apaci`    \
      -o httpd buildmark.o modules.o  modules/php4/libphp4.a 
modules/python/libpython.a  modules/standard/libstandard.a  main/libmain.a 
./os/unix/libos.a  ap/libap.a  lib/expat-lite/libexpat.a  -R/usr/ucblib
-R/usr/local/lib/gcc-lib/sparc-sun-solaris2.8/2.95.2  -L/usr/ucblib
-L/usr/local/lib/gcc-lib/sparc-sun-solaris2.8/2.95.2 -Lmodules/php4
-L../modules/php4 -L../../modules/php4 -lmodphp4  -lpam  -ldl -lresolv -lresolv
-lm -ldl -lcrypt -lnsl -lsocket  -lsocket -lgcc   -lsocket -lnsl -ldl
Undefined                       first referenced
 symbol                             in file
PySequence_Index                    modules/python/libpython.a(mod_python.o)
Py_InitModule4                      modules/python/libpython.a(_apachemodule.o)
PyString_FromStringAndSize          modules/python/libpython.a(_apachemodule.o)
PyExc_TypeError                     modules/python/libpython.a(tableobject.o)
PyEval_RestoreThread                modules/python/libpython.a(mod_python.o)
PyCallable_Check                    modules/python/libpython.a(requestobject.o)
PyErr_BadArgument                   modules/python/libpython.a(_apachemodule.o)
Py_Finalize                         modules/python/libpython.a(mod_python.o)
Py_NewInterpreter                   modules/python/libpython.a(mod_python.o)
PyErr_Print                         modules/python/libpython.a(mod_python.o)
PyExc_IndexError                    modules/python/libpython.a(requestobject.o)
PyMember_Set                        modules/python/libpython.a(requestobject.o)
Py_FindMethod                       modules/python/libpython.a(requestobject.o)
PyExc_IOError                       modules/python/libpython.a(requestobject.o)
PyString_FromString                 modules/python/libpython.a(mod_python.o)
PyThreadState_Swap                  modules/python/libpython.a(mod_python.o)
PyType_Type                         modules/python/libpython.a(_apachemodule.o)
Py_BuildValue                       modules/python/libpython.a(_apachemodule.o)
PyErr_Occurred                      modules/python/libpython.a(mod_python.o)
PyString_AsString                   modules/python/libpython.a(mod_python.o)
PyList_SetItem                      modules/python/libpython.a(tableobject.o)
PyModule_GetDict                    modules/python/libpython.a(_apachemodule.o)
PyObject_CallMethod                 modules/python/libpython.a(mod_python.o)
PyList_Append                       modules/python/libpython.a(_apachemodule.o)
Py_IsInitialized                    modules/python/libpython.a(mod_python.o)
PyInt_Type                          modules/python/libpython.a(mod_python.o)
_Py_NoneStruct                      modules/python/libpython.a(_apachemodule.o)
PyExc_AttributeError                modules/python/libpython.a(requestobject.o)
PyObject_Str                        modules/python/libpython.a(mod_python.o)
PyArg_ParseTuple                    modules/python/libpython.a(_apachemodule.o)
PyExc_ValueError                    modules/python/libpython.a(requestobject.o)
PyErr_SetString                     modules/python/libpython.a(requestobject.o)
PyList_SetSlice                     modules/python/libpython.a(mod_python.o)
PyTuple_New                         modules/python/libpython.a(util.o)
PyEval_SaveThread                   modules/python/libpython.a(mod_python.o)
PyDict_SetItemString                modules/python/libpython.a(mod_python.o)
PyObject_HasAttrString              modules/python/libpython.a(serverobject.o)
PyDict_GetItem                      modules/python/libpython.a(_apachemodule.o)
PyMapping_HasKeyString              modules/python/libpython.a(_apachemodule.o)
PyCObject_FromVoidPtr               modules/python/libpython.a(mod_python.o)
PyString_ConcatAndDel               modules/python/libpython.a(tableobject.o)
PyErr_NewException                  modules/python/libpython.a(_apachemodule.o)
PyObject_GetAttrString              modules/python/libpython.a(mod_python.o)
PyList_New                          modules/python/libpython.a(_apachemodule.o)
Py_OptimizeFlag                     modules/python/libpython.a(mod_python.o)
PyDict_SetItem                      modules/python/libpython.a(_apachemodule.o)
PyExc_KeyError                      modules/python/libpython.a(tableobject.o)
PyDict_New                          modules/python/libpython.a(mod_python.o)
PyTuple_SetItem                     modules/python/libpython.a(util.o)
PyThreadState_New                   modules/python/libpython.a(mod_python.o)
PyErr_Clear                         modules/python/libpython.a(requestobject.o)
Py_GetVersion                       modules/python/libpython.a(mod_python.o)
PyMember_Get                        modules/python/libpython.a(requestobject.o)
PyInt_FromLong                      modules/python/libpython.a(requestobject.o)
PyDict_GetItemString                modules/python/libpython.a(mod_python.o)
PyCObject_AsVoidPtr                 modules/python/libpython.a(mod_python.o)
PyErr_NoMemory                      modules/python/libpython.a(requestobject.o)
PyInt_AsLong                        modules/python/libpython.a(mod_python.o)
PyList_Size                         modules/python/libpython.a(_apachemodule.o)
PyImport_ImportModule               modules/python/libpython.a(mod_python.o)
PyObject_CallFunction               modules/python/libpython.a(mod_python.o)
PyErr_Fetch                         modules/python/libpython.a(mod_python.o)
PyThreadState_Delete                modules/python/libpython.a(mod_python.o)
_PyString_Resize                    modules/python/libpython.a(_apachemodule.o)
Py_Initialize                       modules/python/libpython.a(mod_python.o)
PyErr_SetObject                     modules/python/libpython.a(requestobject.o)
PyString_Type                       modules/python/libpython.a(tableobject.o)
ld: fatal: Symbol referencing errors. No output written to httpd
collect2: ld returned 1 exit status
*** Error code 1
make: Fatal error: Command failed for target `target_static'
Current working directory /usr/share/src/apache_1.3.14/src
*** Error code 1
make: Fatal error: Command failed for target `build-std'
Current working directory /usr/share/src/apache_1.3.14
*** Error code 1
make: Fatal error: Command failed for target `build'


*** So I tried to install the DSO version, hoping that would be my hero.  But
this is what I get when compiling Mod_Python with the DSO support:


Compiling for DSO. For static, do "make static"

/usr/local/apachePHP/bin/apxs -I/usr/share/src/mod_python-2.7.2/src/include
-I/usr/local/apachePHP/include -I/usr/local/include/python1.5 -c mod_python.o 
_apachemodule.o  requestobject.o  tableobject.o  util.o  serverobject.o 
connobject.o -lm  /usr/local/lib/python1.5/config/libpython1.5.a   -lsocket
-lnsl -ldl    -lm
  -o mod_python.so mod_python.o _apachemodule.o requestobject.o tableobject.o
util.o serverobject.o connobject.o -lm
/usr/local/lib/python1.5/config/libpython1.5.a -lsocket -lnsl -ldl -lm 
apxs:Break: Command failed with rc=255
*** Error code 1
make: Fatal error: Command failed for target `mod_python.so'
Current working directory /usr/share/src/mod_python-2.7.2/src
*** Error code 1
make: Fatal error: Command failed for target `do_dso'

Please Help me!  I will give you any additional information that you request.  I
really want to use this module in Solaris!!!  Thanks in advance!

From joost.damad at siemens.atea.be  Thu Feb 15 15:07:34 2001
From: joost.damad at siemens.atea.be (Joost Yervante Damad)
Date: Fri Jan  9 22:02:37 2004
Subject: [mod_python] some issues
Message-ID: <20010215150733.A20391@siemens.atea.be>

Hello,

A friend of me discovered wierd bug in publisher :

def tst(req, arg='none', test='none', longname='none'):
        req._content_type_set = 0
        return "Arguments are '%s', '%s' and '%s'" % (arg, test, longname)

if we now do:

https://r2d2.iplab.atea.be:8081/py/test.py/tst?arg=x&test=y&longname=z

the result is:

Arguments are '', '' and 'z'

Aparently short names are not getting into the functions.
Long names are. Or is this caused by name clashes?

We tested this both with 2.7.1 and 2.7.2 on Solaris 2.6
with apache 1.3.14 with SSL and mod_python statically linked.

Another error I found:

The handling of _content_type_set seems to be broken.

publisher no longer functioned, bailin out at:

if not req._content_type_set:

giving an exeception stating that that variable was not found.

Removing that part and setting the content_type to
"text/html" is our current workaround.

Any thoughts?

Joost

P.S.: but we love mod_python :)

-- 
Joost Damad - Siemens ICN D NC A - +3214252297
--
Five is a sufficiently close approximation to infinity.
       -- Robert Firth
"One, two, five."
       -- Monty Python and the Holy Grail

From joost.damad at siemens.atea.be  Thu Feb 15 15:17:26 2001
From: joost.damad at siemens.atea.be (Joost Yervante Damad)
Date: Fri Jan  9 22:02:37 2004
Subject: [mod_python] Re: Mod_Python and Solaris Compile Problems
Message-ID: <20010215151726.A21817@siemens.atea.be>

I added a non-multithreaded libpython.a
to the directory of mod_python and
hacked the Makefile to force it to staticaly
link in that one.

Worked fine for me.

Joost

-- 
Joost Damad - Siemens ICN D NC A - +3214252297
--
Five is a sufficiently close approximation to infinity.
       -- Robert Firth
"One, two, five."
       -- Monty Python and the Holy Grail

From Zhu.James at iac.com.tw  Fri Feb 16 14:59:59 2001
From: Zhu.James at iac.com.tw (Zhu.James@iac.com.tw)
Date: Fri Jan  9 22:02:37 2004
Subject: [mod_python] How to install Python 2.7.2 on Windows NT
Message-ID: <939C21A81E55D311806D0008C759857F0117E18E@isc-mx1.isc.inventec>

Hi All,

   I an a newbie to python. I want to install Python 2.7.2 on my NT machine,
but i cannot find the windows installation guide. Can someone tell me how to
do it?
Thanks in advance.

Regards
James




-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010216/dafc01c5/attachment-0003.htm
From joost.damad at siemens.atea.be  Fri Feb 16 08:31:41 2001
From: joost.damad at siemens.atea.be (Joost Yervante Damad)
Date: Fri Jan  9 22:02:37 2004
Subject: [mod_python] some issues
In-Reply-To: <20010215150733.A20391@siemens.atea.be>; from joost.damad@siemens.atea.be on Thu, Feb 15, 2001 at 03:07:34PM +0100
References: <20010215150733.A20391@siemens.atea.be>
Message-ID: <20010216083141.A10720@siemens.atea.be>

'Joost Yervante Damad' wrote about '[mod_python] some issues' - Thu, Feb 15, 2001 at 03:07:34PM CET
> Hello,
> 
> A friend of me discovered wierd bug in publisher :
> 
> def tst(req, arg='none', test='none', longname='none'):
>         req._content_type_set = 0
>         return "Arguments are '%s', '%s' and '%s'" % (arg, test, longname)
> 
> if we now do:
> 
> https://r2d2.iplab.atea.be:8081/py/test.py/tst?arg=x&test=y&longname=z
> 
> the result is:
> 
> Arguments are '', '' and 'z'
> 
> Aparently short names are not getting into the functions.
> Long names are. Or is this caused by name clashes?
> 
> We tested this both with 2.7.1 and 2.7.2 on Solaris 2.6
> with apache 1.3.14 with SSL and mod_python statically linked.
> 
> Another error I found:
> 
> The handling of _content_type_set seems to be broken.
> 
> publisher no longer functioned, bailin out at:
> 
> if not req._content_type_set:
> 
> giving an exeception stating that that variable was not found.
> 
> Removing that part and setting the content_type to
> "text/html" is our current workaround.
> 
> Any thoughts?
> 

After careful examining we found that somehow 2.7.1 and 2.7.2
got mixed during our building, causing the _content_type_set
breakage. Sorry for that bad intel.

The other problem (short params) remains though.

-- 
Joost Damad - Siemens ICN D NC A - +3214252297
--
Five is a sufficiently close approximation to infinity.
       -- Robert Firth
"One, two, five."
       -- Monty Python and the Holy Grail

From Christian.Vergnaud at hcuge.ch  Tue Feb 20 18:33:02 2001
From: Christian.Vergnaud at hcuge.ch (Christian VERGNAUD)
Date: Fri Jan  9 22:02:37 2004
Subject: [mod_python] Can't locate API module structure `mod_python'
Message-ID: <sa92b870.002@diogenes.hcuge.ch>

I get the following message when I start httpd :
Can't locate API module structure `mod_python' in file /home/Impact/orbix/apache/libexec/mod_python.so: ld.so.1: /home/Impact/orbix/apache/bin/httpd: fatal: mod_python: can't find symbol

OS vesrion: SunOS 5.6, python2.0, Apache 1.3.17, mod_python 2.7.2

I don't know if it's related or not but when installing mod_python, I had to force the library libgcc.a in the Makefile of the src directory in order to avoid unsatisfied entry points (__eprintf for instance) problems.

I'm now stuck and have no idea of what to do. Can someone help?

Thanks


From grisha at verio.net  Tue Feb 20 13:25:39 2001
From: grisha at verio.net (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:02:37 2004
Subject: [mod_python] Can't locate API module structure `mod_python'
In-Reply-To: <sa92b870.002@diogenes.hcuge.ch>
Message-ID: <Pine.BSF.4.32.0102201325010.20282-100000@localhost>

I believe someone else was reporting a similar issue and they resolved by
compiling python separately without threads.

Grisha

On Tue, 20 Feb 2001, Christian VERGNAUD wrote:

>
> I get the following message when I start httpd :
> Can't locate API module structure `mod_python' in file /home/Impact/orbix/apache/libexec/mod_python.so: ld.so.1: /home/Impact/orbix/apache/bin/httpd: fatal: mod_python: can't find symbol
>
> OS vesrion: SunOS 5.6, python2.0, Apache 1.3.17, mod_python 2.7.2
>
> I don't know if it's related or not but when installing mod_python, I had to force the library libgcc.a in the Makefile of the src directory in order to avoid unsatisfied entry points (__eprintf for instance) problems.
>
> I'm now stuck and have no idea of what to do. Can someone help?
>
> Thanks
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From brett at bookshop.unsw.edu.au  Wed Feb 21 11:33:11 2001
From: brett at bookshop.unsw.edu.au (Brett Haydon)
Date: Fri Jan  9 22:02:37 2004
Subject: [mod_python] Windows version of 2.7.2
Message-ID: <NCBBKMABOKFCDLPIKKGICELMCJAA.brett@bookshop.unsw.edu.au>

I know others have asked but:

Is the modpython dll being recompiled for 2.7.2 for win?

The new modpublisher module looks at the req._content_type_set
attribute which appears not to be in the dll for 2.7.1

regards,
______________________________________________
Brett Haydon


From joost.damad at siemens.atea.be  Wed Feb 21 10:23:46 2001
From: joost.damad at siemens.atea.be (Joost Yervante Damad)
Date: Fri Jan  9 22:02:37 2004
Subject: [mod_python] mod_python/publisher/solaris truncation problems
Message-ID: <20010221102346.A15890@siemens.atea.be>

Hi!

A while ago I send a mail reporting a bug stating that
cgi attribute/value pairs get truncated in our Solaris 2.6
apachessl with latest mod_python, when xxx=yyy total
length smaller then 8 bytes.

It seems to be related to the python/C interfacing...
and it also looks like a 32bit/64bit alike problem.
Anyway, we (I and a colleage) found the following workaround,
basically eliminating some of the Python/C interface calls
from the function "parse_qsl" in
_apachemodule.c

Note that this seems to be a Solaris only problem since
we did not have it on Linux.

Attached is a modified _apachemodule.c with a
working, but probably not the best...fix.
But at least it works for us, and we don't need the
performance.

Any thoughts on this?

Thanks,

-- 
Joost Damad - Siemens IC D NC A - +3214252297
--
Five is a sufficiently close approximation to infinity.
       -- Robert Firth
"One, two, five."
       -- Monty Python and the Holy Grail

From joost.damad at siemens.atea.be  Wed Feb 21 10:29:39 2001
From: joost.damad at siemens.atea.be (Joost Yervante Damad)
Date: Fri Jan  9 22:02:37 2004
Subject: [mod_python] mod_python/publisher/solaris truncation problems
In-Reply-To: <20010221102346.A15890@siemens.atea.be>; from joost.damad@siemens.atea.be on Wed, Feb 21, 2001 at 10:23:46AM +0100
References: <20010221102346.A15890@siemens.atea.be>
Message-ID: <20010221102939.A16904@siemens.atea.be>

'Joost Yervante Damad' wrote about '[mod_python] mod_python/publisher/solaris truncation problems' - Wed, Feb 21, 2001 at 10:23:46AM CET
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

<forgot the attachment...>

-- 
Joost Damad - Siemens IC D NC A - +3214252297
--
Five is a sufficiently close approximation to infinity.
       -- Robert Firth
"One, two, five."
       -- Monty Python and the Holy Grail
-------------- next part --------------
A non-text attachment was scrubbed...
Name: _apachemodule.c
Type: text/x-csrc
Size: 10218 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20010221/52c70a09/_apachemodule-0003.bin
From grisha at verio.net  Wed Feb 21 10:25:01 2001
From: grisha at verio.net (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:02:37 2004
Subject: [mod_python] mod_python/publisher/solaris truncation problems
In-Reply-To: <20010221102346.A15890@siemens.atea.be>
Message-ID: <Pine.BSF.4.32.0102211023480.30708-100000@localhost>

Interesting... I'll have to look into this. It makes sense, since Solaris
is a 64 bit OS whereas Linux on i386 is 32 bit. I haven't done much
Solaris testing, I guess I'll have to do more.

Grisha

On Wed, 21 Feb 2001, Joost Yervante Damad wrote:

> Hi!
>
> A while ago I send a mail reporting a bug stating that
> cgi attribute/value pairs get truncated in our Solaris 2.6
> apachessl with latest mod_python, when xxx=yyy total
> length smaller then 8 bytes.
>
> It seems to be related to the python/C interfacing...
> and it also looks like a 32bit/64bit alike problem.
> Anyway, we (I and a colleage) found the following workaround,
> basically eliminating some of the Python/C interface calls
> from the function "parse_qsl" in
> _apachemodule.c
>
> Note that this seems to be a Solaris only problem since
> we did not have it on Linux.
>
> Attached is a modified _apachemodule.c with a
> working, but probably not the best...fix.
> But at least it works for us, and we don't need the
> performance.
>
> Any thoughts on this?
>
> Thanks,
>
> --
> Joost Damad - Siemens IC D NC A - +3214252297
> --
> Five is a sufficiently close approximation to infinity.
>        -- Robert Firth
> "One, two, five."
>        -- Monty Python and the Holy Grail
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From petar at metamarkets.com  Wed Feb 21 12:08:07 2001
From: petar at metamarkets.com (Petar Karafezov)
Date: Fri Jan  9 22:02:37 2004
Subject: [mod_python] mod_python2.7.2 and server redirects
Message-ID: <86FC34EA3C4F074AA6BBFFE52ED83FED27BDA3@METAEXCH.sfo.metamarkets.com>

hello all -

let me fist say that I love mod_python - works great - much faster than any
cgi! Thanks, Grisha! 

I am seeing some weirdness when working with server redirects - I'm simply
trying to catch the headers from the server, modify the location key and
then send it to the client. It work ok under the CGI, but when I see the
headers that my .py reports when accessed with lynx -mime_header option
(which simply prints the headers and body and exits) instead of HTTP/1.1 302
Found, I see HTTP/1.1 200 OK. I am not sure why this is happening.. Any
ideas ??

Regards,
Petar Karafezov

MetaMarkets.com
415-575-3015
-------------------------------------------
Investing Out Loud at
http://www.metamarkets.com
-------------------------------------------

From brent at rcfile.org  Wed Feb 21 16:17:38 2001
From: brent at rcfile.org (Brent Verner)
Date: Fri Jan  9 22:02:37 2004
Subject: [mod_python] mod_python2.7.2 and server redirects
In-Reply-To: <86FC34EA3C4F074AA6BBFFE52ED83FED27BDA3@METAEXCH.sfo.metamarkets.com>; from petar@metamarkets.com on Wed, Feb 21, 2001 at 12:08:07PM -0800
References: <86FC34EA3C4F074AA6BBFFE52ED83FED27BDA3@METAEXCH.sfo.metamarkets.com>
Message-ID: <20010221161738.A9355@rcfile.org>

On 21 Feb 2001 at 12:08 (-0800), Petar Karafezov wrote:
| hello all -
| 
| let me fist say that I love mod_python - works great - much faster than any
| cgi! Thanks, Grisha! 
| 
| I am seeing some weirdness when working with server redirects - I'm simply
| trying to catch the headers from the server, modify the location key and
| then send it to the client. It work ok under the CGI, but when I see the
| headers that my .py reports when accessed with lynx -mime_header option
| (which simply prints the headers and body and exits) instead of HTTP/1.1 302
| Found, I see HTTP/1.1 200 OK. I am not sure why this is happening.. Any
| ideas ??

this faq entry may help.

http://www.modpython.org/FAQ/faqw.py?req=show&file=faq03.002.htp

  brent

-- 
"We want to help, but we wouldn't want to deprive you of a valuable 
learning experience."
                                          http://openbsd.org/mail.html

From joost.damad at siemens.atea.be  Thu Feb 22 08:09:37 2001
From: joost.damad at siemens.atea.be (Joost Yervante Damad)
Date: Fri Jan  9 22:02:37 2004
Subject: [mod_python] mod_python/publisher/solaris truncation problems
In-Reply-To: <3A93D1D5.45555DBB@caveosystems.com>; from rsalz@caveosystems.com on Wed, Feb 21, 2001 at 09:33:57AM -0500
References: <20010221102346.A15890@siemens.atea.be> <20010221102939.A16904@siemens.atea.be> <3A93D1D5.45555DBB@caveosystems.com>
Message-ID: <20010222080937.A27533@siemens.atea.be>

'Rich Salz' wrote about 'Re: [mod_python] mod_python/publisher/solaris truncation problems' - Wed, Feb 21, 2001 at 03:33:57PM CET
> a diff would be more useful. ...

True... but the changes I made are not really meant as a
solution. They merely show how we solved it to have a workable
mod_python. I can get you a diff if you want. (see attachment)
It's not a very usefull diff imho tho :)

-- 
Joost Damad - Siemens IC D NC A - +3214252297
--
Five is a sufficiently close approximation to infinity.
       -- Robert Firth
"One, two, five."
       -- Monty Python and the Holy Grail
-------------- next part --------------
--- mod_python-2.7.2/src/_apachemodule.c	Mon Dec 18 20:50:03 2000
+++ ../delta/changed_src/_apachemodule.c	Wed Feb 21 10:15:03 2001
@@ -48,10 +48,14 @@
  *
  */
 
 #include "mod_python.h"
 
+#ifdef ATEA_DEBUG
+#undef ATEA_DEBUG
+#endif
+ 
 /** 
  ** log_error
  **
  *  A wrpapper to ap_log_error
  * 
@@ -253,11 +257,11 @@
 static PyObject *parse_qsl(PyObject *self, PyObject *args)
 {
 
     PyObject *pairs;
     int i, len;
-    char *qs;
+    char *qs, *cpair;
     int keep_blank_values = 0;
     int strict_parsing = 0; /* XXX not implemented */
 
     if (! PyArg_ParseTuple(args, "s|ii", &qs, &keep_blank_values, 
 			   &strict_parsing)) 
@@ -269,83 +273,131 @@
 	return NULL;
 
     i = 0;
     len = strlen(qs);
 
+	cpair=calloc(1,len);
+	
     while (i < len) {
 
-	PyObject *pair, *key, *val;
-	char *cpair, *ckey, *cval;
+	/*PyObject *pair, *key, *val;*/
+	PyObject *key, *val;
+	/*char *cpair, *ckey, *cval;*/
+	char *ckey, *cval;
 	int plen, j, p, k, v;
 
-	pair = PyString_FromStringAndSize(NULL, len);
+	/* pair = PyString_FromStringAndSize(NULL, len);
 	if (pair == NULL)
-	    return NULL;
+	    return NULL;*/
 
 	/* split by '&' or ';' */
-	cpair = PyString_AS_STRING(pair);
+	/*cpair = PyString_AS_STRING(pair);
+	  cpair=calloc(1,len);*/
+#ifdef ATEA_DEBUG
+	fprintf(stderr, "all pairs: %s\n", cpair);
+#endif
 	j = 0;
 	while ((qs[i] != '&') && (qs[i] != ';') && (i < len)) {
 	    /* replace '+' with ' ' */
 	    cpair[j] = (qs[i] == '+') ? ' ' : qs[i];
 	    i++;
 	    j++;
 	}
 	cpair[j] = '\0';
-	_PyString_Resize(&pair, j);
+	/*_PyString_Resize(&pair, j);*/
 
 	/* split the "abc=def" pair */
-
+#ifdef ATEA_DEBUG
+	fprintf(stderr,"[foo] cpair == %s\n", cpair);
+#endif
 	plen = strlen(cpair);
-	key = PyString_FromStringAndSize(NULL, plen);
-	if (key == NULL) 
-	    return NULL;
-	val = PyString_FromStringAndSize(NULL, plen);
-	if (val == NULL) 
-	    return NULL;
-
-	ckey = PyString_AS_STRING(key);
-	cval = PyString_AS_STRING(val);
+#ifdef ATEA_DEBUG
+	fprintf(stderr,"plen == %d\n", plen);
+#endif
+	/*key = PyString_FromStringAndSize(NULL, plen);
+	  if (key == NULL)
+	      return NULL;
+	  val = PyString_FromStringAndSize(NULL, plen);
+	  if (val == NULL)
+	      return NULL;*/
 
+	/*ckey = PyString_AS_STRING(key);
+	  cval = PyString_AS_STRING(val);*/
+	
+	ckey = calloc(1,plen);
+	cval = calloc(1,plen);
+	/*memset(ckey,0,plen);
+	  memset(cval,0,plen);*/
+#ifdef ATEA_DEBUG
+	fprintf(stderr,"ckey=%s, cval=%s (should be empty)\n", ckey, cval);
+#endif
+	
 	p = 0;
 	k = 0;
 	v = 0;
 	while (p < plen) {
-	    if (cpair[p] != '=') {
-		ckey[k] = cpair[p];
-		k++;
-		p++;
+	    if (cpair[p] != '=')
+		{
+#ifdef ATEA_DEBUG
+			fprintf(stderr,"%d cpair=%s ckey=%s, cval=%s (parsing before '=')\n", p, cpair, ckey, cval);
+#endif
+			ckey[k] = cpair[p];
+			k++;
+			p++;
 	    }
 	    else {
-		p++;      /* skip '=' */
-		while (p < plen) {
-		    cval[v] = cpair[p];
-		    v++;
-		    p++;
-		}
+			p++;      /* skip '=' */
+#ifdef ATEA_DEBUG
+			fprintf(stderr, ">>> entering else branch...\n");
+#endif
+			while (p < plen)
+			{
+#ifdef ATEA_DEBUG
+				fprintf(stderr,"%d cpair=%s ckey=%s, cval=%s (parsing after '=')\n", p, cpair, ckey, cval);
+#endif
+		    	cval[v] = cpair[p];
+		    	v++;
+		    	p++;
+			}
 	    }
 	}
 	ckey[k] = '\0';
 	cval[v] = '\0';
+#ifdef ATEA_DEBUG
+	fprintf(stderr,"ckey=%s, cval=%s\n (final)", ckey, cval);
+#endif
 
 	if (keep_blank_values || (v > 0)) {
 
 	    ap_unescape_url(ckey);
 	    ap_unescape_url(cval);
 
-	    _PyString_Resize(&key, strlen(ckey));
-	    _PyString_Resize(&val, strlen(cval));
+	    /*_PyString_Resize(&key, strlen(ckey));
+	      _PyString_Resize(&val, strlen(cval));*/
 
+		key = PyString_FromStringAndSize(ckey, strlen(ckey));
+		if (key == NULL) {
+		  	free(ckey); free(cval); free(cpair);
+	    	return NULL;
+		}
+		val = PyString_FromStringAndSize(cval, strlen(cval));
+		if (val == NULL) {
+		  	free(ckey); free(cval); free(cpair);
+		    return NULL;
+		}
+		
 	    PyList_Append(pairs, Py_BuildValue("(O,O)", key, val));
 
 	}
-	Py_DECREF(pair);
+	/*Py_DECREF(pair);*/
 	Py_DECREF(key);
 	Py_DECREF(val);
 	i++;
+	free(ckey);
+	free(cval);
     }
-
+	free(cpair);
     return pairs;
 }
 
 
 /* methods of _apache */
From r.fortnagel at 21torr.com  Thu Feb 22 11:41:01 2001
From: r.fortnagel at 21torr.com (Ralf Fortnagel)
Date: Fri Jan  9 22:02:37 2004
Subject: [mod_python] Problem to run .py scripts thru apache
Message-ID: <NEBBJGBIKKHHFMNEPEKKKEHMCAAA.r.fortnagel@21torr.com>

Hi Folks!

I use Apache/1.3.14 (Win32) mod_python/2.7.1 Python/2.0 on a Win/NT4.0
machine
If i try to start any .py file thru apache, i get following error:

Mod_python error: "PythonHandler test"
Traceback (most recent call last):
  File "c:\programme\python20\lib\mod_python\apache.py", line 180, in
Dispatch
    object = resolve_object(self.req, module, object_str, silent)
  File "c:\programme\python20\lib\mod_python\apache.py", line 396, in
resolve_object
    raise AttributeError, s
AttributeError: module 'c:\programme\python20\lib\test\__init__.py' contains
no 'handler'

please help me, i don't know what's wrong... :(
--
Ralf Fortnagel                21TORR AGENCY gmbh
r.fortnagel@21torr.com        Engineering
tel: +49-7121-348-221         Heinestrasse 72
fax: +49-7121-348-259         D-72762 Reutlignen

21TORR - die neue medien leidenschaft
www.21torr.com


From joost.damad at siemens.atea.be  Thu Feb 22 11:55:49 2001
From: joost.damad at siemens.atea.be (Joost Yervante Damad)
Date: Fri Jan  9 22:02:37 2004
Subject: [mod_python] Problem to run .py scripts thru apache
In-Reply-To: <NEBBJGBIKKHHFMNEPEKKKEHMCAAA.r.fortnagel@21torr.com>; from r.fortnagel@21torr.com on Thu, Feb 22, 2001 at 11:41:01AM +0100
References: <NEBBJGBIKKHHFMNEPEKKKEHMCAAA.r.fortnagel@21torr.com>
Message-ID: <20010222115549.A27399@siemens.atea.be>

'Ralf Fortnagel' wrote about '[mod_python] Problem to run .py scripts thru apache' - Thu, Feb 22, 2001 at 11:41:01AM CET
> Hi Folks!
>
> I use Apache/1.3.14 (Win32) mod_python/2.7.1 Python/2.0 on a Win/NT4.0
> machine
> If i try to start any .py file thru apache, i get following error:
>
> Mod_python error: "PythonHandler test"
> Traceback (most recent call last):
>   File "c:\programme\python20\lib\mod_python\apache.py", line 180, in
> Dispatch
>     object = resolve_object(self.req, module, object_str, silent)
>   File "c:\programme\python20\lib\mod_python\apache.py", line 396, in
> resolve_object
>     raise AttributeError, s
> AttributeError: module 'c:\programme\python20\lib\test\__init__.py' contains
> no 'handler'
>
> please help me, i don't know what's wrong... :(
> --
> Ralf Fortnagel                21TORR AGENCY gmbh
> r.fortnagel@21torr.com        Engineering
> tel: +49-7121-348-221         Heinestrasse 72
> fax: +49-7121-348-259         D-72762 Reutlignen
> 
> 21TORR - die neue medien leidenschaft
> www.21torr.com
> 

I asume you have in your apache config file:

PythonHandler test

This means that mod_python needs to look for a pythonscript called 'test'.

But :) In your Pythonpath you also have the dir c:\programme\python20\lib\
and the directory c:\programme\python20\lib\test\ matches your handler.

Python then looks for an __init__.py to 'execute' the directory as a
pythonscript, and this is obviously not what you want.

Joost

-- 
Joost Damad - Siemens IC D NC A - +3214252297
--
Five is a sufficiently close approximation to infinity.
       -- Robert Firth
"One, two, five."
       -- Monty Python and the Holy Grail

From brianh at exelixis.com  Thu Feb 22 20:11:38 2001
From: brianh at exelixis.com (Brian Hawthorne)
Date: Fri Jan  9 22:02:37 2004
Subject: [mod_python] Stackless python
Message-ID: <Pine.GSO.4.05.10102222009490.13571-100000@timeless.exelixis.com>

i wonder, 
has anyone embedded stackless python in apache using mod_python?

brian


From ensim.ml.mod_python at ensim.com  Thu Feb 22 22:41:45 2001
From: ensim.ml.mod_python at ensim.com (Ensim-Newsgroups.Mailing-Lists.Mod_Python-List)
Date: Fri Jan  9 22:02:37 2004
Subject: [mod_python] browser connection state
Message-ID: <9AC41B8C4781464695BB013F106FCA3181A5A5@nasdaq.ms.ensim.com>

is there a way in mod python to check whether the browser connection has
been aborted?  ie, given a single request, before writing each chunk of
response data to the browser, can we check whether the browser user pressed
the stop button (or pressed escape).

From miguel at yorku.ca  Fri Feb 23 08:40:13 2001
From: miguel at yorku.ca (Miguel Marques)
Date: Fri Jan  9 22:02:37 2004
Subject: [mod_python] browser connection state
In-Reply-To: <9AC41B8C4781464695BB013F106FCA3181A5A5@nasdaq.ms.ensim.com>
References: <9AC41B8C4781464695BB013F106FCA3181A5A5@nasdaq.ms.ensim.com>
Message-ID: <20010223084013J.miguel@yorku.ca>

Greetings...
On Thu, 22 Feb 2001 22:41:45 -0800, "Ensim-Newsgroups.Mailing-Lists.Mod_Python-List" <ensim.ml.mod_python@ensim.com> wrote:
> is there a way in mod python to check whether the browser connection has
> been aborted?  ie, given a single request, before writing each chunk of
> response data to the browser, can we check whether the browser user pressed
> the stop button (or pressed escape).
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

If the browser goes away for any reason (stop, reload, etc) and you
try to write to the client, you get an IOError exception which you can
catch.  

I usually have req.write(" ")'s just before database writes and the
such to try and cause this exception to be thrown so I can clean up
and exit and not do anything.

						      Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830

From sergio at royalwebhosting.com  Fri Feb 23 15:39:41 2001
From: sergio at royalwebhosting.com (Sergio Baca)
Date: Fri Jan  9 22:02:37 2004
Subject: [mod_python] mod_python vs java servlets
Message-ID: <157254279584.20010223153941@royalwebhosting.com>

Hello mod,

  How is comparable mod_python with java servlets? Because using
  JPython comparison can be easy made, have anybody thought about
  this?

-- 
Best regards,
 Sergio                          mailto:sergio@royalwebhosting.com



From naris at ensim.com  Fri Feb 23 11:00:39 2001
From: naris at ensim.com (Naris Siamwalla)
Date: Fri Jan  9 22:02:37 2004
Subject: [mod_python] browser connection state
Message-ID: <9AC41B8C4781464695BB013F106FCA3181A5AA@nasdaq.ms.ensim.com>

catching the IOError exception is fine, but can i assume for -*all*- IOError
exceptions thrown when i req.write was because of a stop/reload?  could an
IOError be thrown for other reasons (e.g. apache itself causing mod_python
to throw the IOError exception) ?  if there are no other reaons, then i
guess it's safe to write a try block that assumes so.

-----Original Message-----
From: Miguel Marques [mailto:miguel@yorku.ca]
Sent: Friday, February 23, 2001 5:40 AM
To: ensim.ml.mod_python@ensim.com
Cc: mod_python@modpython.org
Subject: Re: [mod_python] browser connection state


Greetings...
On Thu, 22 Feb 2001 22:41:45 -0800,
"Ensim-Newsgroups.Mailing-Lists.Mod_Python-List"
<ensim.ml.mod_python@ensim.com> wrote:
> is there a way in mod python to check whether the browser connection has
> been aborted?  ie, given a single request, before writing each chunk of
> response data to the browser, can we check whether the browser user
pressed
> the stop button (or pressed escape).
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

If the browser goes away for any reason (stop, reload, etc) and you
try to write to the client, you get an IOError exception which you can
catch.  

I usually have req.write(" ")'s just before database writes and the
such to try and cause this exception to be thrown so I can clean up
and exit and not do anything.

						      Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python

From ensim.ml.mod_python at ensim.com  Fri Feb 23 11:36:51 2001
From: ensim.ml.mod_python at ensim.com (Ensim-Newsgroups.Mailing-Lists.Mod_Python-List)
Date: Fri Jan  9 22:02:37 2004
Subject: [mod_python] browser connection state
Message-ID: <9AC41B8C4781464695BB013F106FCA3181A5AC@nasdaq.ms.ensim.com>

catching the IOError exception is fine, but can i assume for -*all*- IOError
exceptions thrown when i req.write was because of a stop/reload?  could an
IOError be thrown for other reasons (e.g. apache itself causing mod_python
to throw the IOError exception) ?  if there are no other reaons, then i
guess it's safe to write a try block that assumes so.

-----Original Message-----
From: Miguel Marques [mailto:miguel@yorku.ca]
Sent: Friday, February 23, 2001 5:40 AM
To: ensim.ml.mod_python@ensim.com
Cc: mod_python@modpython.org
Subject: Re: [mod_python] browser connection state


Greetings...
On Thu, 22 Feb 2001 22:41:45 -0800,
"Ensim-Newsgroups.Mailing-Lists.Mod_Python-List"
<ensim.ml.mod_python@ensim.com> wrote:
> is there a way in mod python to check whether the browser connection has
> been aborted?  ie, given a single request, before writing each chunk of
> response data to the browser, can we check whether the browser user
pressed
> the stop button (or pressed escape).
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

If the browser goes away for any reason (stop, reload, etc) and you
try to write to the client, you get an IOError exception which you can
catch.  

I usually have req.write(" ")'s just before database writes and the
such to try and cause this exception to be thrown so I can clean up
and exit and not do anything.

						      Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://www.modpython.org/mailman/listinfo/mod_python

From miguel at yorku.ca  Fri Feb 23 14:40:04 2001
From: miguel at yorku.ca (Miguel Marques)
Date: Fri Jan  9 22:02:37 2004
Subject: [mod_python] browser connection state
In-Reply-To: <9AC41B8C4781464695BB013F106FCA3181A5AA@nasdaq.ms.ensim.com>
References: <9AC41B8C4781464695BB013F106FCA3181A5AA@nasdaq.ms.ensim.com>
Message-ID: <20010223144004T.miguel@yorku.ca>

On Fri, 23 Feb 2001 11:00:39 -0800, Naris Siamwalla <naris@ensim.com> wrote:
> catching the IOError exception is fine, but can i assume for -*all*- IOError
> exceptions thrown when i req.write was because of a stop/reload?  could an
> IOError be thrown for other reasons (e.g. apache itself causing mod_python
> to throw the IOError exception) ?  if there are no other reaons, then i
> guess it's safe to write a try block that assumes so.

Gregory would better be able to answer that than me.  
I'm just a mod_python user...

However, IMHO, even if the IOError error happens inside of apache or
for some other reason, it means you lost the connection to the browser and
therefore that you won't be able to send a response to the user.
In that case you probably should abort whatever the user requested
since s/he will probably assume it didn't work since no page got sent
back.  Or am I missing the point?

       						Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830


From ensim.ml.mod_python at ensim.com  Fri Feb 23 11:49:34 2001
From: ensim.ml.mod_python at ensim.com (Ensim-Newsgroups.Mailing-Lists.Mod_Python-List)
Date: Fri Jan  9 22:02:37 2004
Subject: [mod_python] browser connection state
Message-ID: <9AC41B8C4781464695BB013F106FCA3181A5AE@nasdaq.ms.ensim.com>

you're right....i guess i'm over-analyzing :-)

IOError raised during req.write means you had a problem writing, plain and
simple.  and if you had a problem writing, your python code should handle it
accordingly.

-----Original Message-----
From: Miguel Marques [mailto:miguel@yorku.ca]
Sent: Friday, February 23, 2001 11:40 AM
To: naris@ensim.com
Cc: mod_python@modpython.org
Subject: Re: RE: [mod_python] browser connection state


On Fri, 23 Feb 2001 11:00:39 -0800, Naris Siamwalla <naris@ensim.com> wrote:
> catching the IOError exception is fine, but can i assume for -*all*-
IOError
> exceptions thrown when i req.write was because of a stop/reload?  could an
> IOError be thrown for other reasons (e.g. apache itself causing mod_python
> to throw the IOError exception) ?  if there are no other reaons, then i
> guess it's safe to write a try block that assumes so.

Gregory would better be able to answer that than me.  
I'm just a mod_python user...

However, IMHO, even if the IOError error happens inside of apache or
for some other reason, it means you lost the connection to the browser and
therefore that you won't be able to send a response to the user.
In that case you probably should abort whatever the user requested
since s/he will probably assume it didn't work since no page got sent
back.  Or am I missing the point?

       						Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830

From rbeer at uni-goettingen.de  Sat Feb 24 18:53:30 2001
From: rbeer at uni-goettingen.de (Ragnar Beer)
Date: Fri Jan  9 22:02:37 2004
Subject: [mod_python] Apache children RAM use
Message-ID: <p04330104b6bda4a03c43@[134.76.136.114]>

Howdy!

I'm absolutely new to mod_python and I wonder what happens to the 
memory use of apache children when mod_python is compiled in. Coming 
from mod_perl I'm expecting the worst. How about mod_python?

Ragnar Beer

From gege at china.com  Mon Feb 26 23:04:33 2001
From: gege at china.com (gege@china.com)
Date: Fri Jan  9 22:02:37 2004
Subject: [mod_python] help
Message-ID: <8z989773769566.05317@mail2.china.com>

 under windows 98 apache 1.3.17

I copy mod_python.dll to /apache/modules

copy mod_python to c:\python20\lib

add row LoadModule python_module modules/mod_python.dll to httpd.conf

add 

<Directory "C:/Apache/htdocs/python">
    AddHandler python-program .py
    PythonHandler mptest
    PythonDebug On
</Directory>

to httpd.conf too.

then restart apache. when i enter http://localhost/python, i can see mptest.py.

but when i click mptest.py, the browser tells me

Internal Server Error
The server encountered an internal error or misconfiguration and was unable to complete your request.

what happens?

error.log looks like:

[Mon Feb 26 15:50:18 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
'import site' failed; use -v for traceback
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
Apache server shutdown initiated...
'import site' failed; use -v for traceback
'import site' failed; use -v for traceback
[Mon Feb 26 20:26:18 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:37 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:39 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:40 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:41 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:41 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:41 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:42 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:42 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:42 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:42 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:42 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:43 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:42:43 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:43:04 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:44:42 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
[Mon Feb 26 20:46:02 2001] [error] [client 127.0.0.1] python_handler: make_obcallback returned no obCallBack!
'import site' failed; use -v for traceback
'import site' failed; use -v for traceback
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
'import site' failed; use -v for traceback
[Mon Feb 26 20:57:49 2001] [error] [

************************************

http://hospital.china.com/

http://lovesky.china.com

From petar at metamarkets.com  Mon Feb 26 11:03:33 2001
From: petar at metamarkets.com (Petar Karafezov)
Date: Fri Jan  9 22:02:37 2004
Subject: [mod_python] RE: my_file.pyc is not created anymore ...what changed ?
Message-ID: <86FC34EA3C4F074AA6BBFFE52ED83FED27BDBC@METAEXCH.sfo.metamarkets.com>

Hello all -

I was going through a lot of reconfiguration of my apache+mod_python setup,
including migrating it to different server and it seems that somewhere in
all changes made I have "lost" the .pyc files functionality. Before I'd see
a .pyc file being created after mod_python would process my .py handlers.
According to the docs - it would not recompile again if the .py file doesn't
get changed and just use the pre-compiled byte code.

I did a fresh install of apache and mod_python 2.7.2 both with python 1.5.2
(the standard RPm that comes with RH6.2) and with compiled from source
Python2.0 - and I still don't see the .pyc iles created. Any ideas ??

Thanks all for your help!

Regards,
Petar Karafezov

From gege at china.com  Tue Feb 27 03:26:18 2001
From: gege at china.com (gege@china.com)
Date: Fri Jan  9 22:02:38 2004
Subject: [mod_python] what's happen?
Message-ID: <Di989772967381.12116@mail3.china.com>

under redhat 6.2 python 2.1a2 mod_python 2.7.2 apache 1.3.12

lynx http://localhost/python/mptest.py

it appears Hello World!

but when I type lynx http://localhost/python/test.py or some other filename.py

it also appears Hello World!

I don't understand...

from other client by using IE, it gives the same result.
************************************

http://hospital.china.com/

http://lovesky.china.com

From gege at china.com  Tue Feb 27 03:25:48 2001
From: gege at china.com (gege@china.com)
Date: Fri Jan  9 22:02:38 2004
Subject: [mod_python] what's happen?
Message-ID: <Ac989772967451.24452@mail3.china.com>

under redhat 6.2 python 2.1a2 mod_python 2.7.2 apache 1.3.12

lynx http://localhost/python/mptest.py

it appears Hello World!

but when I type lynx http://localhost/python/test.py or some other filename.py

it also appears Hello World!

I don't understand...

from other client by using IE, it gives the same result.
************************************

http://hospital.china.com/

http://lovesky.china.com

From gege at china.com  Tue Feb 27 03:25:18 2001
From: gege at china.com (gege@china.com)
Date: Fri Jan  9 22:02:38 2004
Subject: [mod_python] what's happen?
Message-ID: <EJ989772967481.12100@mail3.china.com>

under redhat 6.2 python 2.1a2 mod_python 2.7.2 apache 1.3.12

lynx http://localhost/python/mptest.py

it appears Hello World!

but when I type lynx http://localhost/python/test.py or some other filename.py

it also appears Hello World!

I don't understand...

from other client by using IE, it gives the same result.
************************************

http://hospital.china.com/

http://lovesky.china.com

From brent at rcfile.org  Mon Feb 26 14:34:16 2001
From: brent at rcfile.org (Brent Verner)
Date: Fri Jan  9 22:02:38 2004
Subject: [mod_python] RE: my_file.pyc is not created anymore ...what changed ?
In-Reply-To: <86FC34EA3C4F074AA6BBFFE52ED83FED27BDBC@METAEXCH.sfo.metamarkets.com>; from petar@metamarkets.com on Mon, Feb 26, 2001 at 11:03:33AM -0800
References: <86FC34EA3C4F074AA6BBFFE52ED83FED27BDBC@METAEXCH.sfo.metamarkets.com>
Message-ID: <20010226143416.A53686@rcfile.org>

On 26 Feb 2001 at 11:03 (-0800), Petar Karafezov wrote:
| Hello all -
| 
| I was going through a lot of reconfiguration of my apache+mod_python setup,
| including migrating it to different server and it seems that somewhere in
| all changes made I have "lost" the .pyc files functionality. Before I'd see
| a .pyc file being created after mod_python would process my .py handlers.
| According to the docs - it would not recompile again if the .py file doesn't
| get changed and just use the pre-compiled byte code.
| 
| I did a fresh install of apache and mod_python 2.7.2 both with python 1.5.2
| (the standard RPm that comes with RH6.2) and with compiled from source
| Python2.0 - and I still don't see the .pyc iles created. Any ideas ??

perhaps the directory where your .py files (and the desired .pyc) files
live is not writable by the user the web server is running as? I've found
it very useful to create a new group, add myself and the web server user
to that group, then own the python web directories to that group and chmod
it g+w.

hth.
	brent

From miguel at yorku.ca  Mon Feb 26 15:01:24 2001
From: miguel at yorku.ca (Miguel Marques)
Date: Fri Jan  9 22:02:38 2004
Subject: [mod_python] what's happen?
In-Reply-To: <Ac989772967451.24452@mail3.china.com>
References: <Ac989772967451.24452@mail3.china.com>
Message-ID: <20010226150124M.miguel@yorku.ca>

On Tue, 27 Feb 2001 03:25:48 +0800 (CST), gege@china.com wrote:
> under redhat 6.2 python 2.1a2 mod_python 2.7.2 apache 1.3.12
> 
> lynx http://localhost/python/mptest.py
> 
> it appears Hello World!
> 
> but when I type lynx http://localhost/python/test.py or some other filename.py
> 
> it also appears Hello World!
> 
> I don't understand...

AddHandler python-program .py
specifies .py files are to be handled by the handler python-program.

The handler for files of type python-program in that directory is
whatever you specified as the PythonHandler in your apache
configuration file.

So any filename ending in .py gets handled by running mptest.py (I'm
guessing that's what you specified).
If you wanted to do something based on the filename you could 
look at req.uri in mptest.py.

If for instance you use 
SetHandler python-program
instead of
AddHandler python-program .py
then any reference to a file in that directory runs mptest.py
regardless of extension.

Hope this helps.

							Miguel

C. Miguel Marques, York University, Computing & Network Services
e-mail: miguel@yorku.ca, voice: (416)736-2100x22684, fax: (416)736-5830

From petar at metamarkets.com  Mon Feb 26 12:03:18 2001
From: petar at metamarkets.com (Petar Karafezov)
Date: Fri Jan  9 22:02:38 2004
Subject: [mod_python] RE: my_file.pyc is not created anymore ...what c
	hanged ?
Message-ID: <86FC34EA3C4F074AA6BBFFE52ED83FED27BDBD@METAEXCH.sfo.metamarkets.com>

duh! of course ... :) Thanks, Brent!

-----Original Message-----
From: Brent Verner [mailto:brent@rcfile.org]
Sent: Monday, February 26, 2001 11:34 AM
To: Petar Karafezov
Cc: mod_python@modpython.org
Subject: Re: [mod_python] RE: my_file.pyc is not created anymore ...what
changed ?


On 26 Feb 2001 at 11:03 (-0800), Petar Karafezov wrote:
| Hello all -
| 
| I was going through a lot of reconfiguration of my apache+mod_python
setup,
| including migrating it to different server and it seems that somewhere in
| all changes made I have "lost" the .pyc files functionality. Before I'd
see
| a .pyc file being created after mod_python would process my .py handlers.
| According to the docs - it would not recompile again if the .py file
doesn't
| get changed and just use the pre-compiled byte code.
| 
| I did a fresh install of apache and mod_python 2.7.2 both with python
1.5.2
| (the standard RPm that comes with RH6.2) and with compiled from source
| Python2.0 - and I still don't see the .pyc iles created. Any ideas ??

perhaps the directory where your .py files (and the desired .pyc) files
live is not writable by the user the web server is running as? I've found
it very useful to create a new group, add myself and the web server user
to that group, then own the python web directories to that group and chmod
it g+w.

hth.
	brent

From mail4myx at yahoo.de  Wed Feb 28 17:06:12 2001
From: mail4myx at yahoo.de (=?iso-8859-1?q?anja=20schmidt?=)
Date: Fri Jan  9 22:02:38 2004
Subject: [mod_python] mod_python, NT, PythonPath
Message-ID: <20010228160612.48560.qmail@web12803.mail.yahoo.com>

Hi,
okay, I've spent almost the whole day trying to
integrate mod_python in NT and I'm getting craaaaazy
now!

I've browsed through the archives and I'm getting the
same error message like George Jempty(5th of December
2000). But he didn't get a reply so I try once again:

The error message in the apache error.log is: 
python_handler: make_obcallback returned no
obCallBack!

After browsing the archives I sort of understand that
the extracted python files of mod_python-2.7.2.tgz
can't be located. I've put them in the
C:\Programme\Python20\Lib\mod_python-2.7.2 directory
and I've pointed the PYTHONPATH env-variable to this.
Didn't work.

The lines in the httpd.conf-file look like

<Directory "C:/Programme/Apache
Group/Apache/htdocs/python">
	AddHandler python-program .py
	PythonHandler mptest
	PythonDebug on
</Directory> 

I also tried to define the PythonPath-variable in
between the <Directory /> tags: PythonPath
"C:/Programme/Python20/Lib/mod_python-2.7.2/" Didn't
work! (And I also tried with other python files, so it
has nothing to do with the name of the .py file,
mptest or test).

So, if anyone knows the answer: Please be so kind to
tell me. Thanks a lot in advance!!

Anja

__________________________________________________________________
Do You Yahoo!?
Gesendet von Yahoo! Mail - http://mail.yahoo.de

From victor at prodigy.net  Wed Feb 28 11:28:24 2001
From: victor at prodigy.net (Victor Muslin)
Date: Fri Jan  9 22:02:38 2004
Subject: [mod_python] mod_python, NT, PythonPath
In-Reply-To: <20010228160612.48560.qmail@web12803.mail.yahoo.com>
Message-ID: <5.0.0.25.0.20010228111927.03518980@localhost>

I used to get the same error before I set things up so that mod_python 
PACKAGE is found.

Make sure you mod_python Python PACKAGE (not the DLL files) and make sure 
that PYTHONPATH environmental variable points to the directory where the 
package is located. The mod_python package is a set of python files in a 
mod_python directory and a bunch of subdirectories.

For example, if you put the package in C:\python_packages (so that you now 
have c:\python_packages\mod_python\...) make sure PYTHONPATH has 
C:\python_packages in it. Then restart Apache.

What you want to do is define PYTHONPATH in your environment BEFORE 
starting the Apache (so that Apache process inherits it). You can then also 
do in httpd.conf:

PassEnv PYTHONPATH

though I don't think it makes a difference.

Hope this helps.


At 05:06 PM 2/28/2001 +0100, anja schmidt wrote:
>Hi,
>okay, I've spent almost the whole day trying to
>integrate mod_python in NT and I'm getting craaaaazy
>now!
>
>I've browsed through the archives and I'm getting the
>same error message like George Jempty(5th of December
>2000). But he didn't get a reply so I try once again:
>
>The error message in the apache error.log is:
>python_handler: make_obcallback returned no
>obCallBack!
>
>After browsing the archives I sort of understand that
>the extracted python files of mod_python-2.7.2.tgz
>can't be located. I've put them in the
>C:\Programme\Python20\Lib\mod_python-2.7.2 directory
>and I've pointed the PYTHONPATH env-variable to this.
>Didn't work.
>
>The lines in the httpd.conf-file look like
>
><Directory "C:/Programme/Apache
>Group/Apache/htdocs/python">
>         AddHandler python-program .py
>         PythonHandler mptest
>         PythonDebug on
></Directory>
>
>I also tried to define the PythonPath-variable in
>between the <Directory /> tags: PythonPath
>"C:/Programme/Python20/Lib/mod_python-2.7.2/" Didn't
>work! (And I also tried with other python files, so it
>has nothing to do with the name of the .py file,
>mptest or test).
>
>So, if anyone knows the answer: Please be so kind to
>tell me. Thanks a lot in advance!!
>
>Anja
>
>__________________________________________________________________
>Do You Yahoo!?
>Gesendet von Yahoo! Mail - http://mail.yahoo.de
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://www.modpython.org/mailman/listinfo/mod_python

_________________________________________________________________________
Victor Muslin    The power of accurate observation is frequently called
                       cynicism by those who don't have it.
                           - George Bernard Shaw
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010228/adaf2ea4/attachment-0003.htm
