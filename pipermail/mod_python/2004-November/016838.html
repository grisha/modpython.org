<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Secure storage of sensitive variables,
	such as passwords
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Secure%20storage%20of%20sensitive%20variables%2C%0A%09such%20as%20passwords&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016834.html">
   <LINK REL="Next"  HREF="016839.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Secure storage of sensitive variables,
	such as passwords</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Jorey Bump</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Secure%20storage%20of%20sensitive%20variables%2C%0A%09such%20as%20passwords&In-Reply-To="
       TITLE="[mod_python] Secure storage of sensitive variables,
	such as passwords">list at joreybump.com
       </A><BR>
    <I>Wed Nov 24 12:47:58 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="016834.html">[mod_python] Vampire 1.3 is now available.
</A></li>
        <LI>Next message: <A HREF="016839.html">[mod_python] Secure storage of sensitive variables,
	such as passwords
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16838">[ date ]</a>
              <a href="thread.html#16838">[ thread ]</a>
              <a href="subject.html#16838">[ subject ]</a>
              <a href="author.html#16838">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'd like to know if anyone has any recommendations for securely storing 
information such as db passwords. I don't like to include login 
information anywhere within the DocumentRoot, in case an interpreter 
failure or server misconfiguration exposes the code. To this end, I'm 
using the following system:

1. I create a different user for each VirtualHost. Within the user's 
home directory, I create a site directory that serves as the DocumentRoot.

2. I then create a Python directory in the home directory, and add it to 
the VirtualHost's PYTHONPATH using:

  PythonPath &quot;sys.path + ['/var/www/virtual/user/Python']&quot;

Or one could do this within the script itself:

  sys.path.append('/var/www/virtual/user/Python')

This gives me a safe place outside of the DocumentRoot to store settings 
in modules, without placing them in the default PYTHONPATH of every 
other user on the system.

3. To store settings, I create a package structure:

  cd ~/Python
  mkdir Conf
  cd Conf
  touch __init__.py

This allows me to create files with settings specific to an application 
and import them. So, for application foo, I would create foo.py here and 
list the values I need, or even wrap them up neatly in a function:

  # ~/Python/Conf/foo.py
  import MySQLdb

  bees = 0
  eric = 0.5

  def get_dbh():
      &quot;&quot;&quot;
      Set up db connection and return handle.
      &quot;&quot;&quot;
      dbhost = &quot;localhost&quot;
      dbuser = &quot;cyril&quot;
      dbpwd  = &quot;ladidi123&quot;
      dbname = &quot;menagerie&quot;
      dbh = MySQLdb.connect(dbhost, dbuser, dbpwd, dbname)
      return dbh

Then, in my mod_python application, I import the values:

  # ~/site/foo.py
  from Conf.foo import *

  bees += eric
  dbh = get_dbh()
  # db handle is now ready to use for queries/updates

I find this approach a lot simpler than using a configuration parser, 
especially because there is no new syntax to learn and the resources are 
immediately available to the application. Creating a package to hold the 
settings also helps to avoid namespace clashes.

The usual caveats apply here as they do to any embedded interpreter, 
with the main concern being that other system users now theoretically 
have access to the code, which must be readable by the user apache runs 
as. The main payoff is that the application is a bit more resistant to 
remote exploits, because the code is stored outside the DocumentRoot.

I'd be interested in how others handle sensitive information or in any 
suggestions for hardening the approach I've outlined above. I generally 
use Publisher in a prefork environment, if that helps.


</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016834.html">[mod_python] Vampire 1.3 is now available.
</A></li>
	<LI>Next message: <A HREF="016839.html">[mod_python] Secure storage of sensitive variables,
	such as passwords
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16838">[ date ]</a>
              <a href="thread.html#16838">[ thread ]</a>
              <a href="subject.html#16838">[ subject ]</a>
              <a href="author.html#16838">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
