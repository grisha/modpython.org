<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] How to keep globals
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20How%20to%20keep%20globals&In-Reply-To=41A7A2A2.6020504%40qalabs.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016860.html">
   <LINK REL="Next"  HREF="016858.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] How to keep globals</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Jorey Bump</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20How%20to%20keep%20globals&In-Reply-To=41A7A2A2.6020504%40qalabs.com"
       TITLE="[mod_python] How to keep globals">list at joreybump.com
       </A><BR>
    <I>Sat Nov 27 18:15:04 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="016860.html">[mod_python] How to keep globals
</A></li>
        <LI>Next message: <A HREF="016858.html">[mod_python] DirectoryIndex and mod_python problem?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16863">[ date ]</a>
              <a href="thread.html#16863">[ thread ]</a>
              <a href="subject.html#16863">[ subject ]</a>
              <a href="author.html#16863">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Trevor West wrote:
&gt;<i> When I was asking about my database problems. Someone mentioned to me 
</I>&gt;<i> that they kept a single global database connection and just pulled 
</I>&gt;<i> cursers off that. And while I know how to do that in the context of a 
</I>&gt;<i> thick client add (we build a big app with wxPython), I'm not sure how to 
</I>&gt;<i> keep globals in apache other than using the session. I've seen lots of 
</I>&gt;<i> examples on the web but none of it seems to make much sense...
</I>
I don't quite have a grip on creating db connection pools, but I've 
discovered a nice side effect of a solution I posted about earlier about 
hiding db connection passwords.

In order to keep passwords out of the DocumentRoot, I've created a 
python directory in my home directory and added it to the VirtualHost's 
PythonPath. This allows me to simply import modules of variables that 
serve as configuration settings. I've discovered that if I also set up 
my db connection in this module, it gets reused quite a lot before it is 
destroyed and replaced by a new one.

For example, here is ~/python/settings.py:

  &quot;&quot;&quot;
  Settings for applications that use the menagerie database.
  &quot;&quot;&quot;
  import MySQLdb

  dbhost = &quot;localhost&quot;
  dbuser = &quot;cyril&quot;
  dbpwd  = &quot;ladidi123&quot;
  dbname = &quot;menagerie&quot;
  dbh = MySQLdb.connect(dbhost, dbuser, dbpwd, dbname)

Then in my application, I import all of the values:

  from settings import *

Now I can use the same dbh for the life of the interpreter, rather than 
  creating a new one within the script. IOW, each apache process seems 
to get a db handle, instead of each request. The handle is also shared 
by any other scripts that import the settings module within a single 
interpreter.

This is on Debian woody:
Apache/1.3.26 (Unix) Debian GNU/Linux mod_python/2.7.8 Python/2.1.3
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016860.html">[mod_python] How to keep globals
</A></li>
	<LI>Next message: <A HREF="016858.html">[mod_python] DirectoryIndex and mod_python problem?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16863">[ date ]</a>
              <a href="thread.html#16863">[ thread ]</a>
              <a href="subject.html#16863">[ subject ]</a>
              <a href="author.html#16863">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
