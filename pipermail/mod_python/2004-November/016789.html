<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python]  Hello all,	Questions about Mod Python sessions
	on Linux
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20%20Hello%20all%2C%09Questions%20about%20Mod%20Python%20sessions%0A%09on%20Linux&In-Reply-To=9B74C86A-336D-11D9-9530-000A95DA37D6%40zzzcomputing.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016786.html">
   <LINK REL="Next"  HREF="016790.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python]  Hello all,	Questions about Mod Python sessions
	on Linux</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Trevor West</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20%20Hello%20all%2C%09Questions%20about%20Mod%20Python%20sessions%0A%09on%20Linux&In-Reply-To=9B74C86A-336D-11D9-9530-000A95DA37D6%40zzzcomputing.com"
       TITLE="[mod_python]  Hello all,	Questions about Mod Python sessions
	on Linux">trevorw at qalabs.com
       </A><BR>
    <I>Fri Nov 12 18:54:54 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="016786.html">[mod_python]  Hello all,
	Questions about Mod Python sessions on Linux
</A></li>
        <LI>Next message: <A HREF="016790.html">[mod_python]  Hello all,
	Questions about Mod Python sessions on Linux
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16789">[ date ]</a>
              <a href="thread.html#16789">[ thread ]</a>
              <a href="subject.html#16789">[ subject ]</a>
              <a href="author.html#16789">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Michael,

The really funny thing is that it should be an instance, and it is the 
user specific information instance that I want to keep in the session. 
Something is really strange between my linux and windows build though. I 
can do very little with sessions on Linux for some reason. I've pulled 
apart my instance so that I'm now only trying to save the database 
connection (again something that works on Windows) and I get this error 
instead:

Mod_python error: &quot;PythonHandler mod_python.publisher&quot;

Traceback (most recent call last):

  File &quot;/usr/local/lib/python2.3/site-packages/mod_python/apache.py&quot;, line 299, in HandlerDispatch
    result = object(req)

  File &quot;/usr/local/lib/python2.3/site-packages/mod_python/publisher.py&quot;, line 136, in handler
    result = util.apply_fs_data(object, req.form, req=req)

  File &quot;/usr/local/lib/python2.3/site-packages/mod_python/util.py&quot;, line 361, in apply_fs_data
    return object(**args)

  File &quot;/usr/local/apache2/htdocs/test/mptest.py&quot;, line 43, in login
    sess.save()

  File &quot;/usr/local/lib/python2.3/site-packages/mod_python/Session.py&quot;, line 204, in save
    self.do_save(dict)

  File &quot;/usr/local/lib/python2.3/site-packages/mod_python/Session.py&quot;, line 329, in do_save
    dbm[self._sid] = cPickle.dumps(dict)

  File &quot;/usr/local/lib/python2.3/copy_reg.py&quot;, line 70, in _reduce_ex
    state = base(self)

TypeError: connect() argument 1 must be string, not Connection

I'm wondering if my installation should be done again, or if I'm not 
doing the configuration of apache correctly, because as far as I can 
tell I'm writing the code correctly, and I'm running it on another OS 
and it works fine (I pulled it apart like you suggested so that all I'm 
saving now is the database connection, the username and a couple other 
small pieces of data).

Cheers

Trevor West


michael bayer wrote:

&gt;<i> seems like you are trying to store a Python module in the Session, and 
</I>&gt;<i> Pickle isnt able to do that.
</I>&gt;<i>
</I>&gt;<i> regardless of which platforms this may or may not work on, it 
</I>&gt;<i> generally doesn't make sense to store a module in the session, since a 
</I>&gt;<i> Python module and its instance variables, assuming normal usage via 
</I>&gt;<i> &quot;import&quot;, are all shared amongst many requests and possibly across 
</I>&gt;<i> multiple concurrent threads, whereas the Session stores information 
</I>&gt;<i> specific to one user and that user's subset of requests.
</I>&gt;<i>
</I>&gt;<i> you probably want to figure out what application state it is exactly 
</I>&gt;<i> you want to store on a per-session basis, and stick it into an object 
</I>&gt;<i> instance that you can safely pickle away.
</I>&gt;<i>
</I>&gt;<i> if you are unsure what object in your Session is a module, you can 
</I>&gt;<i> always try walking through all the elements in the session and test 
</I>&gt;<i> obj.__class__.__name__ == 'module' to see who the offending element is.
</I>&gt;<i>
</I>&gt;<i> On Nov 10, 2004, at 4:24 PM, Trevor West wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Setups for use in the below discussion:
</I>&gt;&gt;<i> Machine 1:
</I>&gt;&gt;<i> Windows 2000
</I>&gt;&gt;<i> Apache 2.0.52
</I>&gt;&gt;<i> Mod Python 3.1.3
</I>&gt;&gt;<i> MySQL_Python
</I>&gt;&gt;<i> Python 2.3
</I>&gt;&gt;<i> wxPython
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Machine 2:
</I>&gt;&gt;<i> Fedora Core 2
</I>&gt;&gt;<i> Apache 2.0.52
</I>&gt;&gt;<i> Mod Python 3.1.3
</I>&gt;&gt;<i> MySQL_Python
</I>&gt;&gt;<i> Python 2.3
</I>&gt;&gt;<i> wxPython
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I'm writing a thin-client to a wxPython application and when I run 
</I>&gt;&gt;<i> the thin client on Machine 1(the windows box) everything works great, 
</I>&gt;&gt;<i> no problem. While when I try to move it to what is now the production 
</I>&gt;&gt;<i> box, Machine 2 (linux box), I get this error:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Mod_python error: &quot;PythonHandler mod_python.publisher&quot;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Traceback (most recent call last):
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  File &quot;/usr/local/lib/python2.3/site-packages/mod_python/apache.py&quot;, 
</I>&gt;&gt;<i> line 299, in HandlerDispatch
</I>&gt;&gt;<i>    result = object(req)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  File 
</I>&gt;&gt;<i> &quot;/usr/local/lib/python2.3/site-packages/mod_python/publisher.py&quot;, 
</I>&gt;&gt;<i> line 136, in handler
</I>&gt;&gt;<i>    result = util.apply_fs_data(object, req.form, req=req)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  File &quot;/usr/local/lib/python2.3/site-packages/mod_python/util.py&quot;, 
</I>&gt;&gt;<i> line 361, in apply_fs_data
</I>&gt;&gt;<i>    return object(**args)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  File &quot;/usr/local/apache2/htdocs/test/mptest.py&quot;, line 42, in login
</I>&gt;&gt;<i>    sess.save()
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  File &quot;/usr/local/lib/python2.3/site-packages/mod_python/Session.py&quot;, 
</I>&gt;&gt;<i> line 204, in save
</I>&gt;&gt;<i>    self.do_save(dict)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  File &quot;/usr/local/lib/python2.3/site-packages/mod_python/Session.py&quot;, 
</I>&gt;&gt;<i> line 329, in do_save
</I>&gt;&gt;<i>    dbm[self._sid] = cPickle.dumps(dict)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  File &quot;/usr/local/lib/python2.3/copy_reg.py&quot;, line 69, in _reduce_ex
</I>&gt;&gt;<i>    raise TypeError, &quot;can't pickle %s objects&quot; % base.__name__
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> TypeError: can't pickle module objects
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> So, as far as I can tell, on my Windows box I'm able to add class 
</I>&gt;&gt;<i> instances to the session (in this case, I'm sure it's my database 
</I>&gt;&gt;<i> class that is causing this) but on Linux, it won't add it to the 
</I>&gt;&gt;<i> session.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> If anyone can give him a heads up that would be great. I've been 
</I>&gt;&gt;<i> beating my head against the wall with the linux box because the 
</I>&gt;&gt;<i> windows setup was SO easy, and being a big linux fan I was 
</I>&gt;&gt;<i> disappointed in the strange problems I've run into.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Anyway, thanks in advance.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Trevor West
</I>&gt;&gt;<i> ------------------------
</I>&gt;&gt;<i> Developer for QA Labs
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Mod_python mailing list
</I>&gt;&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i>
</I></PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016786.html">[mod_python]  Hello all,
	Questions about Mod Python sessions on Linux
</A></li>
	<LI>Next message: <A HREF="016790.html">[mod_python]  Hello all,
	Questions about Mod Python sessions on Linux
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16789">[ date ]</a>
              <a href="thread.html#16789">[ thread ]</a>
              <a href="subject.html#16789">[ subject ]</a>
              <a href="author.html#16789">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
