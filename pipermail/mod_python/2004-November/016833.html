<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] mod_python, best practices
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20mod_python%2C%20best%20practices&In-Reply-To=3B607FC3-3DFC-11D9-B86F-000A956CC60E%40scanmine.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016832.html">
   <LINK REL="Next"  HREF="016835.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] mod_python, best practices</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20mod_python%2C%20best%20practices&In-Reply-To=3B607FC3-3DFC-11D9-B86F-000A956CC60E%40scanmine.com"
       TITLE="[mod_python] mod_python, best practices">grahamd at dscpl.com.au
       </A><BR>
    <I>Wed Nov 24 05:36:39 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="016832.html">[mod_python] mod_python, best practices
</A></li>
        <LI>Next message: <A HREF="016835.html">[mod_python] mod_python, best practices
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16833">[ date ]</a>
              <a href="thread.html#16833">[ thread ]</a>
              <a href="subject.html#16833">[ subject ]</a>
              <a href="author.html#16833">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Wednesday, November 24, 2004, at 08:35  PM, Rune Hansen wrote:

&gt;<i> Hi,
</I>&gt;<i> I've written a rather long and winding document which I've called 
</I>&gt;<i> &quot;mod_python, best practices&quot;.
</I>&gt;<i>
</I>&gt;<i> A better name would be &quot;mod_python, assumptions made on shaky ground - 
</I>&gt;<i> kept in a light tone to mask my inherent fear of making a complete 
</I>&gt;<i> fool of my self.&quot; Obviously, that title is to long.
</I>&gt;<i>
</I>&gt;<i> Anyway, the document can be found here <A HREF="http://www.scanmine.com/mp/">http://www.scanmine.com/mp/</A>
</I>&gt;<i>
</I>&gt;<i> I'd really like thoughts, comments and corrections... keep your smirks 
</I>&gt;<i> and laughs to your self :)
</I>&gt;<i>
</I>&gt;<i> As you read the document it will become apparent that english is not 
</I>&gt;<i> my native tongue, feel free to comment on that too.
</I>
You sent this at a really bad time as am just about to go on week and
a half holiday and will not have internet access. I also don't have
the time now to respond to your posting properly. A few quick points
though.

On the first issue, you really seem to complicate things using the
RewriteRule directive. Have a look at Vampire and how it works.
You should be able to avoid the rewrite rule using Vampire as it
will automatically map a &quot;search.html&quot; request to &quot;search.py&quot;.
You will have to write your handlers in the default content handler
style and not mod_python.publisher style though. Thus something
like:

# index.py

from mod_python import apache

def handler_html(req,**args):
     req.content_type = &quot;text/html&quot;
     req.send_http_header()
     req.write(&quot;&lt;html&gt;&lt;head&gt;&lt;title&gt;Search Index 
Page&lt;/title&gt;&lt;head&gt;&lt;body&gt;## 'index' got called once&lt;/body&gt;&lt;/html&gt;&quot;)
     return apache.OK

# search.py

from mod_python import apache

def handler_html(req,**args):
     req.content_type = &quot;text/html&quot;
     req.send_http_header()
     req.write(&quot;&lt;html&gt;&lt;head&gt;&lt;title&gt;Search /search 
Page&lt;/title&gt;&lt;head&gt;&lt;body&gt;## '/search' got called once&lt;/body&gt;&lt;/html&gt;&quot;)
     return apache.OK

Not sure what may happen if PythonAuthenHandler is used though and
whether you will still see excessive calls to it.

On the issue of authorisation, when using mod_python.publisher did
you look at the the __auth__, __auth_realm__ etc support it provides
whereby authorisation could be handled in each Python code file
rather than by PythonAuthenHandler? Vampire provides the same sort
of authentication hooks in each content handler file.

On the issue of configuration files, again, look at Vampire. It
provides a mechanism for configuration which also uses ConfigParser.
It has though a smart search ability to find the config file. Ie.,
rather than having to specify the exact location of the config file,
you simply ask for config file of certain name, and using the req
object will search back up the directory hierarchy until found,
or will stop searching if go up as far as where the PythonHandler
definition was found. Thus instead of writing:

def handler(req):
     global CONFIG,cfgfile
     if not CONFIG:
        CONFIG = 
Cfgparser(&quot;/&quot;.join([os.path.dirname(__file__),cfgfile]),req.server)
        CONFIG.getConfig()
     req.CONFIG = CONFIG

one can write something like:

def handler_html(req):
     config = vampire.loadConfig(req,&quot;Globals.cfg&quot;)

This means that you don't have to specify fixed relative pathnames in
subdirectory content handlers to refer to a config somewhere above
that directory, instead it will be automatically found. This allows
one to freely move stuff around and not have to fix up any fixed
location paths.

The config object you get back also has some default values set which
allow one to easily create URLs which reference back to the root of
your application, again avoiding issues of having hardcoded relative
paths. Unfortunately, haven't yet released a newer version of Vampire I
have which takes this a bit further and makes it even more useful.

Configs are cached automatically, but the cache will also reload them
automatically when it detects that the actual config file has changed.

Anyway, could probably go on longer and provide better examples, but
no time to do so. I realise the above doesn't adequately explain stuff
either, so all I can suggest is you have a dig through Vampire and
see what you can work out and I'll see where things are at when I get
back from holidays.

Vampire can be found at:

   <A HREF="http://www.dscpl.com.au/projects/vampire">http://www.dscpl.com.au/projects/vampire</A>

--
Graham Dumpleton (<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">grahamd at dscpl.com.au</A>)

</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016832.html">[mod_python] mod_python, best practices
</A></li>
	<LI>Next message: <A HREF="016835.html">[mod_python] mod_python, best practices
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16833">[ date ]</a>
              <a href="thread.html#16833">[ thread ]</a>
              <a href="subject.html#16833">[ subject ]</a>
              <a href="author.html#16833">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
