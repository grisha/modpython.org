<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] module caching problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20module%20caching%20problem&In-Reply-To=20041124000232.06D9AB526%40fiona.siteprotect.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016830.html">
   <LINK REL="Next"  HREF="016892.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] module caching problem</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Damjan</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20module%20caching%20problem&In-Reply-To=20041124000232.06D9AB526%40fiona.siteprotect.com"
       TITLE="[mod_python] module caching problem">gdamjan at mail.net.mk
       </A><BR>
    <I>Tue Nov 23 19:49:06 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="016830.html">[mod_python] module caching problem
</A></li>
        <LI>Next message: <A HREF="016892.html">[mod_python] module caching problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16829">[ date ]</a>
              <a href="thread.html#16829">[ thread ]</a>
              <a href="subject.html#16829">[ subject ]</a>
              <a href="author.html#16829">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> I am running into a problem with mod_python in that, I am importing a module
</I>&gt;<i> in the handler which creates a singleton in memory.  I am using the module
</I>&gt;<i> to hold cache information for any other modules that import the same module.
</I>&gt;<i> 
</I>&gt;<i> I started testing the cache mechanism when I noticed that the module was
</I>&gt;<i> being imported multiple times and not just once after the first request
</I>&gt;<i> after apache had started.  To test this, I put a few lines of code in the
</I>&gt;<i> module to write to a file the time it was last imported.  I noticed that
</I>&gt;<i> after restarting apache, the first time it writes to the file.  If I hit
</I>&gt;<i> refresh on my page immediately, multiple times, it doesn't write.  If I wait
</I>&gt;<i> like 10 seconds or more and then hit refresh again, it reimports that module
</I>&gt;<i> that should have been cached.
</I>&gt;<i> 
</I>&gt;<i> Also, If I make a request for a page from two different clients, it
</I>&gt;<i> reimports the module from each client.  Am I mistaken in thinking that any
</I>&gt;<i> module imported in the handler then is cached in mod_python's module cache
</I>&gt;<i> and subsequent imports of that module then are simply served up from the
</I>&gt;<i> cache.  Under what conditions then would the same module get reimported if
</I>&gt;<i> no modifications were made to that module?
</I>
I guess your are runnig Apache with mpm_prefork? 
In that case there's a completely different python interpreter for each
Apache process, so your caching module is loaded in each of them.

Your testing showed how apache processes get to serve requests, if it gets
two simultaneus requests two apache processes will be active, each
serving one of the request. But if you only generate one request after
another, its most likely that the same process will serve  both
requests... of course this depends on OS implementation... I think you
are running on Linux, no?

-- 
damjan | &#1076;&#1072;&#1084;&#1112;&#1072;&#1085;
This is my jabber ID --&gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">damjan at bagra.net.mk</A> &lt;-- not my mail address!!!
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016830.html">[mod_python] module caching problem
</A></li>
	<LI>Next message: <A HREF="016892.html">[mod_python] module caching problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16829">[ date ]</a>
              <a href="thread.html#16829">[ thread ]</a>
              <a href="subject.html#16829">[ subject ]</a>
              <a href="author.html#16829">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
