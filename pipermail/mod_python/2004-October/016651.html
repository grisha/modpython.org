<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] vampire form validation
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20vampire%20form%20validation&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016669.html">
   <LINK REL="Next"  HREF="016655.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] vampire form validation</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Johannes Erdfelt</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20vampire%20form%20validation&In-Reply-To="
       TITLE="[mod_python] vampire form validation">johannes at erdfelt.com
       </A><BR>
    <I>Tue Oct 19 17:11:25 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="016669.html">[mod_python] Re: [patch] vampire 1.1 remove unknown query variables
</A></li>
        <LI>Next message: <A HREF="016655.html">[mod_python] vampire form validation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16651">[ date ]</a>
              <a href="thread.html#16651">[ thread ]</a>
              <a href="subject.html#16651">[ subject ]</a>
              <a href="author.html#16651">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>As a follow up to my previous patch to make query variable a bit easier
to use in vampire, I have a further reaching suggestion I wanted to
offer up.

In some of my applications, I have some fairly complicated forms that are
in general are a pain to validate that the client sent the correct
variables. When I say validation, I mean at a minimum, requiring the
client send certain variables, and are of the correct base type (integer,
string, etc)

I've written a validator for another project that I'm porting over to
vampire right now. Would there be any interest for a feature like this?

The idea would be that you would specify a new module variable, similar
to the __auth__ variable, called __form_vars__. It would describe the
variables, which are required, what type they should be and possibly a
default value.

The list is built using objects, allowing for extensibility, and is
passed to the application as a class object with the members
automatically created from the name of the variable.

Something like this (I'm in the middle of porting and making some
changes to existing code, so this is a rough draft):

from vampire import form

__form_vars__ = [
  form.integer(&quot;userid&quot;, required = 0),
  form.submit(&quot;submit&quot;, [
    form.string(&quot;name&quot;, required = 1),	# 1 could be the default
    form.string(&quot;address&quot;),
    form.string(&quot;city&quot;),
    form.string(&quot;state&quot;),
    form.string(&quot;country&quot;, default = &quot;US&quot;),
  ]),
]

The handler would then expect a variable called 'form', which could be
used like this:

  req.write(&quot;you requested we create a user with this address:\n&quot;)
  req.write(&quot;  %s\n&quot; % form.name)
  req.write(&quot;  %s\n&quot; % form.address)
  req.write(&quot;  %s, %s\n&quot; % (form.city, form.state))
  req.write(&quot;  %s\n&quot; % form.state)

Perhaps a form object could be created for HTML radio buttons, allowing
finer grained control over what variables are required:

__form_vars__ = [
  form.radiobutton(&quot;choice&quot;, {
    &quot;modify&quot;: [
      form.string(&quot;userid&quot;),
    ],
    &quot;create&quot;: [
      form.string(&quot;name&quot;),
      form.string(&quot;address&quot;),
      ...
    ],
  }),
]

  if form.choice == &quot;modify&quot;:
    # modify user
  else:
    # we know this has to be &quot;create&quot; because of the form validation
    # create user

JE

</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016669.html">[mod_python] Re: [patch] vampire 1.1 remove unknown query variables
</A></li>
	<LI>Next message: <A HREF="016655.html">[mod_python] vampire form validation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16651">[ date ]</a>
              <a href="thread.html#16651">[ thread ]</a>
              <a href="subject.html#16651">[ subject ]</a>
              <a href="author.html#16651">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
