<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Udate python modules without restarting Apache
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Udate%20python%20modules%20without%20restarting%20Apache&In-Reply-To=16742.41717.581031.231622%40fenway.local.">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016598.html">
   <LINK REL="Next"  HREF="016602.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Udate python modules without restarting Apache</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Udate%20python%20modules%20without%20restarting%20Apache&In-Reply-To=16742.41717.581031.231622%40fenway.local."
       TITLE="[mod_python] Udate python modules without restarting Apache">grahamd at dscpl.com.au
       </A><BR>
    <I>Sat Oct  9 13:26:23 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="016598.html">[mod_python] Udate python modules without restarting Apache
</A></li>
        <LI>Next message: <A HREF="016602.html">[mod_python] Udate python modules without restarting Apache
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16600">[ date ]</a>
              <a href="thread.html#16600">[ thread ]</a>
              <a href="subject.html#16600">[ subject ]</a>
              <a href="author.html#16600">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On 09/10/2004, at 12:23 AM, Daniel Popowich wrote:

&gt;&gt;<i> BTW, mpservlet doesn't use &quot;imp&quot; module to do module importing of
</I>&gt;&gt;<i> .mps files but instead uses execfile(). By using execfile() it
</I>&gt;&gt;<i> effectively throws away the prior module before reimporting it.
</I>&gt;<i>
</I>&gt;<i> The main reason I used execfile is because I wanted to build a cache
</I>&gt;<i> of servlet classes keyed on the full filename.  This means I avoid
</I>&gt;<i> problems of /somedir/index.mps and /somedir/subdir/index.mps
</I>&gt;<i> colliding.  Also, there are so many gnarly issues with using the
</I>&gt;<i> import system, I believe I've avoided many a head-ache (e.g., dealing
</I>&gt;<i> with pythonpath; wanting to import files that end in .mps).
</I>
The ability to distinguish between index.py in two different directories
is possible with &quot;imp&quot; module functions. The trick is that when you  
finally
call imp.load_module, rather than passing the name of the module as the
first argument, you pass it some encoded name which incorporates the  
full
pathname to the module code file. In doing this you have to ensure  
though
to get rid of any magic characters that might cause problems. I have  
also
a long long time ago had issues with the length of the name used, thus
a scheme to shorten it is possibly a good idea as well.

But then, I think you perhaps know this, as I recollect mpservlets not
using execfile() in an older version, or was that some other package for
mod_python I am thinking of.

FWIW, to see how Vampire mangles the names so as to still be able to use
the &quot;imp&quot; module, check out:

    
<A HREF="http://www.dscpl.com.au/projects/vampire/examples-01/python-">http://www.dscpl.com.au/projects/vampire/examples-01/python-</A> 
modules.html

The &quot;label&quot; field is the name which the module appears as in  
sys.modules.
Those starting with &quot;_vampire_&quot; are the mangled names which Vampire uses
in its module importing and caching system and which are getting passed
as first argument to imp.load_module. It is a strange combination of md5
hashing and base64 encoding of the full pathname.

BTW, with the latest version of Vampire, I show how you can integrate  
use
of mpservlets package. Unfortunately my public web site isn't Apache 2.0
so can't host a working example. You can see the source code though at
for the mpservlets demo at:

    
<A HREF="http://www.dscpl.com.au/projects/vampire/source/examples-06/servlet-">http://www.dscpl.com.au/projects/vampire/source/examples-06/servlet-</A> 
demo.py

When using Vampire, your code is in &quot;.py&quot; file and not &quot;.mps&quot; and you  
don't
have to access it as &quot;.mps&quot; either. If you want extensions, you can set  
it
up to use &quot;.html&quot; or &quot;.mps&quot;. If you want no extension to be used, you  
can do
that also. Thus a bit more flexible.

Anyway, I will be making a announcement about latest version of Vampire
shortly.

--
Graham Dumpleton (<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">grahamd at dscpl.com.au</A>)

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016598.html">[mod_python] Udate python modules without restarting Apache
</A></li>
	<LI>Next message: <A HREF="016602.html">[mod_python] Udate python modules without restarting Apache
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16600">[ date ]</a>
              <a href="thread.html#16600">[ thread ]</a>
              <a href="subject.html#16600">[ subject ]</a>
              <a href="author.html#16600">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
