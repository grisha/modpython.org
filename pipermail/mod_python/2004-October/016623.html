<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] does add_handler even work?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20does%20add_handler%20even%20work%3F&In-Reply-To=4A21E616-1CD6-11D9-89A5-000A95D2D288%40apache.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016622.html">
   <LINK REL="Next"  HREF="016625.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] does add_handler even work?</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20does%20add_handler%20even%20work%3F&In-Reply-To=4A21E616-1CD6-11D9-89A5-000A95D2D288%40apache.org"
       TITLE="[mod_python] does add_handler even work?">grahamd at dscpl.com.au
       </A><BR>
    <I>Wed Oct 13 01:25:06 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="016622.html">[mod_python] does add_handler even work?
</A></li>
        <LI>Next message: <A HREF="016625.html">[mod_python] bug in apache.build_cgi_env
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16623">[ date ]</a>
              <a href="thread.html#16623">[ thread ]</a>
              <a href="subject.html#16623">[ subject ]</a>
              <a href="author.html#16623">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Oct 12 22:11, Scott Sanders &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">sanders at apache.org</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> Subject: Re: [mod_python] does add_handler even work?
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; If I add a SetHandler, then everything works, but then other modules
</I>&gt;<i> &gt; like PHP and mod_autoindex stop working.
</I>&gt;<i> &gt;
</I>&gt;<i> You either need to add the optional type after the SetHandler, or with 
</I>&gt;<i> your AddHandler, your handler needs to return apache.DECLINED on 
</I>&gt;<i> requests that you do not want to handle.
</I>
According to Apache documentation, you can't supply anything after the
SetHandler directive. If you do add something, you will get an internal
server error deriving from a misconfiguration of your configuration file.

The point of using SetHandler is to have every request under that directory
go through mod_python. This includes those with and without extensions.
Thus, it doesn't make sense to have an extension on SetHandler.

If you wanted to only process certain extensions, you would have used
AddHandler in the first place, which is what it is for. The problem is that the
AddHandler directive can't be used to intercept requests which don't have
any extension at all, thus why one ends up having to use SetHandler
if you want to catch those cases where there is no specific extension.

Having a content handler return apache.DECLINED doesn't help in the case
of PHP, because even though the request is passed back to Apache by
mod_python, the SetHandler directive seems to cause Apache not to
pass the file through the PHP module for processing. All it does when the
value apache.DECLINED is returned is return the raw PHP file, unprocessed.

This is why the solution seems to be to explicitly disable the SetHandler
altogether when the request is for a .php file. Ie.,

  SetHandler python-program
  PythonHandler vampire

  &lt;Files *.php&gt;
  SetHandler None
  &lt;/Files&gt;

What happens when this is done, is that for a .php file, Apache doesn't even
bother handing off to mod_python and sends it direct to the PHP module.
Thus, returning apache.DECLINED isn't relevant anyway, as never gets to
that point.

Hopefully this more detailed explaination than my previous email is useful.

--
Graham Dumpleton (<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">grahamd at dscpl.com.au</A>)
</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016622.html">[mod_python] does add_handler even work?
</A></li>
	<LI>Next message: <A HREF="016625.html">[mod_python] bug in apache.build_cgi_env
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16623">[ date ]</a>
              <a href="thread.html#16623">[ thread ]</a>
              <a href="subject.html#16623">[ subject ]</a>
              <a href="author.html#16623">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
