From gerard.patel at nerim.net  Mon Jul  1 23:43:06 2002
From: gerard.patel at nerim.net (Gerard Patel)
Date: Fri Jan  9 21:46:49 2004
Subject: [mod_python] Apache 2.0.39 and publisher
Message-ID: <1.5.4.32.20020701214306.417866e0@pop.nerim.net>

Hello,

First thing first : I'm a rank beginner with Apache *and* Python :-)

I want to learn both and am trying to setup a very small web site
to test.
I am giving mod_python a try, with Apache 2.0.39, mod_python
from CVS, Python 2.2

Hum, a little question : docu states that Python should be compiled
with no threading support, however in the code I see a 
WITH_THREAD flag, is this restriction still valid for current
CVS ? It seems to work, but my testing is somewhat 
limited for now.

Now, the problems :

First problem : mod_python does not compile

fix :

--- requestobject.c.orig        Mon Jun  3 16:31:15 2002
+++ requestobject.c     Sun Jun 30 11:05:05 2002
@@ -743,7 +743,6 @@
     {"bytes_sent",         T_LONG,      OFF(bytes_sent),           RO},
     {"mtime",              T_LONG,      OFF(mtime),                RO},
     {"chunked",            T_INT,       OFF(chunked),              RO},
-    {"boundary",           T_STRING,    OFF(boundary),             RO},
     {"range",              T_STRING,    OFF(range),                RO},
     {"clength",            T_LONG,      OFF(clength),              RO},
     {"remaining",          T_LONG,      OFF(remaining),            RO},

The Apache guys removed this field from the last version I downloaded
(the aborted 2.0.37) and 2.0.39. Strange.


Second problem : the publisher.

I test it with a minimal app that just displays the one field of
my page :

def Bouton1(req, TextField1):

    s = TextField1
    return s

It works fine, but if I reload the form immediately after, it does
not work unless I wait about 15 seconds.

Fix :
--- apache.py.orig      Wed Apr 10 23:24:24 2002
+++ apache.py   Mon Jul  1 23:21:25 2002
@@ -399,8 +399,9 @@

         # but is it in the path?
         file = module.__dict__.get("__file__")
-        if not file or (path and not file in path):
-                raise SERVER_RETURN, HTTP_NOT_FOUND
+       pathfile, filefile = os.path.split(file)
+        if not file or (path and not pathfile in path):
+               raise SERVER_RETURN, HTTP_NOT_FOUND

         if autoreload:
             oldmtime = module.__dict__.get("__mtime__", 0)

I suspect that this is not elegant Python or even correct, 
please remember that I have written a grand total of about 
300 lines of Python so far.

Anyway, with the change it seems to work better at least.

Thanks for your comments, I am ready to try any
better ideas that you want me to test, and sorry
if I have just misconfigured the beast; I have read
the archive a bit and seen something similar
to my second problem, but no solution AFAICT.


Gerard Patel


From mateusz at ant.gliwice.pl  Wed Jul  3 00:57:10 2002
From: mateusz at ant.gliwice.pl (Mateusz Korniak)
Date: Fri Jan  9 21:46:49 2004
Subject: [mod_python] How to make 307 Temporary Redirect using mod_python ?
Message-ID: <200207022257.g62MvFs10490@eden.ispol.com>

I can't make temporary redirect using mod_python.

I tried code:

def handler(req):
	# some code genereting url - where to redirect
	req.headers_out["Location"] = url
	req.send_http_header()
	return apache.HTTP_TEMPORARY_REDIRECT

but it produces such (not as intended) HTTP talk:

browser:
GET /abbon/advsel/advsel.py?a=1;u=388 HTTP/1.1
Connection: Keep-Alive
User-Agent: Mozilla/5.0 (compatible; Konqueror/2.2-11; Linux)
Pragma: no-cache
Cache-control: no-cache
Accept: text/*, image/jpeg, image/png, image/*, */*
Accept-Encoding: x-gzip, gzip, identity
Accept-Charset: iso-8859-2, utf-8, *
Accept-Language: en_GB, pl_PL, en
Host: appserver.ant.cipe
Cookie: SES=1

server response:
HTTP/1.1 200 OK
Date: Tue, 02 Jul 2002 21:14:01 GMT
Server: Apache/1.3.23 (Unix)  (Red-Hat/Linux) mod_python/2.7.8 Python/1.5.2
Location: http://www.noblisci.bnet.pl
Connection: close
Transfer-Encoding: chunked
Content-Type: text/plain

21c
HTTP/1.1 200 OK
Date: Tue, 02 Jul 2002 21:14:01 GMT
Server: Apache/1.3.23 (Unix)  (Red-Hat/Linux) mod_python/2.7.8 Python/1.5.2
Location: http://www.noblisci.bnet.pl
Connection: close
Transfer-Encoding: chunked
Content-Type: text/html; charset=iso-8859-1

<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<HTML><HEAD>
<TITLE>200 OK</TITLE>
</HEAD><BODY>
<H1>OK</H1>
The document has moved <A HREF="http://www.noblisci.bnet.pl">here</A>.<P>
<HR>
<ADDRESS>Apache/1.3.23 Server at appserver.ant.cipe Port 80</ADDRESS>
</BODY></HTML>


Server returns HTTP/1.1 200 OK instead of 307 <whatever> ...
What I'm doing wrong ?
TIA for any help.

-- 
Mateusz Korniak


From ps0 at igmp.com.ar  Tue Jul  2 19:48:03 2002
From: ps0 at igmp.com.ar (ps0@igmp.com.ar)
Date: Fri Jan  9 21:46:49 2004
Subject: [mod_python] Problems creating files from mod_python
Message-ID: <20020702194803.A27995@igmp.com.ar>

Apache: 1.3.24
mod_python: 2.7.8
Python: 2.2 (w/threads) [i have to recompile it
without threads]


fd=open("/tmp/bleh.txt", "w")
fd.write("HOLA\n")
fd.close()

On the fd.close() it make this error:
IOError: [Errno 9] Bad file Descriptor 

The file is created but i can't write on it.


The perms are corectly applied, from a python script ( out of apache )
the thinks work ok.

Sugestions apreciated.

Tnks in advance.

Hector.

From peter at webreply.com  Tue Jul  2 19:21:37 2002
From: peter at webreply.com (Peter McA'Nulty)
Date: Fri Jan  9 21:46:49 2004
Subject: [mod_python] How to make 307 Temporary Redirect using mod_python ?
References: <200207022257.g62MvFs10490@eden.ispol.com>
Message-ID: <000701c2221f$36f8a2b0$0201a8c0@Peter8100>

before you call req.send_http_header(), you have to set the req.status
field:
req.status = HTTP_TEMPORARY_REDIRECT

peter

----- Original Message -----
From: "Mateusz Korniak" <mateusz@ant.gliwice.pl>
To: <mod_python@modpython.org>
Sent: Tuesday, July 02, 2002 6:57 PM
Subject: [mod_python] How to make 307 Temporary Redirect using mod_python ?


> I can't make temporary redirect using mod_python.
>
> I tried code:
>
> def handler(req):
> # some code genereting url - where to redirect
> req.headers_out["Location"] = url
> req.send_http_header()
> return apache.HTTP_TEMPORARY_REDIRECT
>
> but it produces such (not as intended) HTTP talk:
>
> browser:
> GET /abbon/advsel/advsel.py?a=1;u=388 HTTP/1.1
> Connection: Keep-Alive
> User-Agent: Mozilla/5.0 (compatible; Konqueror/2.2-11; Linux)
> Pragma: no-cache
> Cache-control: no-cache
> Accept: text/*, image/jpeg, image/png, image/*, */*
> Accept-Encoding: x-gzip, gzip, identity
> Accept-Charset: iso-8859-2, utf-8, *
> Accept-Language: en_GB, pl_PL, en
> Host: appserver.ant.cipe
> Cookie: SES=1
>
> server response:
> HTTP/1.1 200 OK
> Date: Tue, 02 Jul 2002 21:14:01 GMT
> Server: Apache/1.3.23 (Unix)  (Red-Hat/Linux) mod_python/2.7.8
Python/1.5.2
> Location: http://www.noblisci.bnet.pl
> Connection: close
> Transfer-Encoding: chunked
> Content-Type: text/plain
>
> 21c
> HTTP/1.1 200 OK
> Date: Tue, 02 Jul 2002 21:14:01 GMT
> Server: Apache/1.3.23 (Unix)  (Red-Hat/Linux) mod_python/2.7.8
Python/1.5.2
> Location: http://www.noblisci.bnet.pl
> Connection: close
> Transfer-Encoding: chunked
> Content-Type: text/html; charset=iso-8859-1
>
> <!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
> <HTML><HEAD>
> <TITLE>200 OK</TITLE>
> </HEAD><BODY>
> <H1>OK</H1>
> The document has moved <A HREF="http://www.noblisci.bnet.pl">here</A>.<P>
> <HR>
> <ADDRESS>Apache/1.3.23 Server at appserver.ant.cipe Port 80</ADDRESS>
> </BODY></HTML>
>
>
> Server returns HTTP/1.1 200 OK instead of 307 <whatever> ...
> What I'm doing wrong ?
> TIA for any help.
>
> --
> Mateusz Korniak
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>



From pk1u at yahoo.com  Tue Jul  2 19:33:07 2002
From: pk1u at yahoo.com (Praveen Kumar)
Date: Fri Jan  9 21:46:49 2004
Subject: [mod_python] shared object files
Message-ID: <20020703023307.85661.qmail@web10403.mail.yahoo.com>

How do I make mod_python aware of the location of
shared object files ?

My system consists of rh7.2, apache1.3.26,
mod_python-2.7.8, python2.1.3


Eg, I'm trying to use the DCOracle2 db module; it uses
Oracle's libclntsh.so.9.0 ; I see the following when
my program accesses the DCOracle2 module:

  File
"/usr/lib/python2.1/site-packages/DCOracle2/__init__.py",
line 37, in ?
    from DCOracle2 import   *

  File
"/usr/lib/python2.1/site-packages/DCOracle2/DCOracle2.py",
line 104, in ?
    import dco2

ImportError: libclntsh.so.9.0: cannot open shared
object file: No such file or directory



I've tried the following:

Placed libclntsh.so.9.0 in /oralib and:

Placed /oralib in the PythonPath directive:

eg; httpd.conf:

<Directory /usr/local/apache/htdocs>
    AddHandler python-program .py
    PythonPath "sys.path+[ ...., '/oralib']"
    PythonHandler reqhandler
    PythonDebug On 
</Directory>

--

set LD_LIBRARY_PATH from the same shell where I start
apache:

export LD_LIBRARY_PATH=/oralib

--

Placed libclntsh.so.9.0 in
/usr/lib/python2.1/site-packages/DCOracle2 .

None of these work. The DCOracle2 module works fine
when I use it from a standalone program. Any
suggestions would be greatly appreciated.

pk


__________________________________________________
Do You Yahoo!?
Sign up for SBC Yahoo! Dial - First Month Free
http://sbc.yahoo.com

From lisicky at datis.cdrail.cz  Wed Jul  3 09:22:38 2002
From: lisicky at datis.cdrail.cz (Jiri Lisicky)
Date: Fri Jan  9 21:46:49 2004
Subject: [mod_python] Problems creating files from mod_python
In-Reply-To: <20020702194803.A27995@igmp.com.ar>
References: <20020702194803.A27995@igmp.com.ar>
Message-ID: <ch95ius9pgmdhso3cnuc6fv6m034o12p8j@4ax.com>

On Tue, 2 Jul 2002 19:48:03 -0300, you wrote:

>Apache: 1.3.24
>mod_python: 2.7.8
>Python: 2.2 (w/threads) [i have to recompile it
>without threads]
>
>
>fd=open("/tmp/bleh.txt", "w")
>fd.write("HOLA\n")
>fd.close()
>
>On the fd.close() it make this error:
>IOError: [Errno 9] Bad file Descriptor 
>
>The file is created but i can't write on it.
>
>
>The perms are corectly applied, from a python script ( out of apache )
>the thinks work ok.
>
>Sugestions apreciated.
Exists file /tmp/bleh.txt before running script from mod_python? 
Maybe you create this file by generic python script under your
username. When call it under mod_python, it is under apache account =
permission problem.
--
        Ji?? Lisick?                      ?D KM?P Olomouc
e-mail: lisicky@datis.cdrail.cz           V?de?sk? 15
 phone: +420-068-578-2272                 Olomouc, Czech Republic
              >>> ?e?tina ISO-8859-2 Compatible <<<

From R.Barrett at ftel.co.uk  Wed Jul  3 10:00:19 2002
From: R.Barrett at ftel.co.uk (Richard Barrett)
Date: Fri Jan  9 21:46:49 2004
Subject: [mod_python] Zope
In-Reply-To: <20010830170753.B23002@godel>
Message-ID: <5.1.0.14.2.20020703095730.00b08148@pop.ftel.co.uk>

At 17:07 30/08/2001 +0200, riesch@nieuw.nl wrote:
>Hi there,
>
>
>Off-topic as it is :
>
>Has anyone experience with using zope and more specificaly with its 
>database ? Is it possible to separate the database from the 
>zope-architecture ? I can't figure out how .. but it would be usefull 
>since it looks nice
>
>
>Thanks ahead,
>Richard

You want http://www.amk.ca/zodb/ and http://www.zope.org/Products/StandaloneZODB


From s_lott at yahoo.com  Wed Jul  3 03:56:37 2002
From: s_lott at yahoo.com (Steven Lott)
Date: Fri Jan  9 21:46:49 2004
Subject: [mod_python] Zope
In-Reply-To: <5.1.0.14.2.20020703095730.00b08148@pop.ftel.co.uk>
Message-ID: <20020703105637.12600.qmail@web9606.mail.yahoo.com>

The ZOPE (Z Object Persistence Environment) Object database
(ZODB), once known as BOBOBase, is available as a separate
download from ZOPE.org.

http://www.python.org/workshops/2000-01/proceedings/papers/fulton/zodb3.html

http://www.python.org/topics/database/persistence.html

http://www.zope.org/Members/michel/HowTos/ZODB-How-To

--- Richard Barrett <R.Barrett@ftel.co.uk> wrote:
> At 17:07 30/08/2001 +0200, riesch@nieuw.nl wrote:
> >Hi there,
> >
> >
> >Off-topic as it is :
> >
> >Has anyone experience with using zope and more specificaly
> with its 
> >database ? Is it possible to separate the database from the 
> >zope-architecture ? I can't figure out how .. but it would be
> usefull 
> >since it looks nice
> >
> >
> >Thanks ahead,
> >Richard
> 
> You want http://www.amk.ca/zodb/ and
> http://www.zope.org/Products/StandaloneZODB
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


=====
--
S. Lott, CCP :-{)
S_LOTT@YAHOO.COM
http://www.mindspring.com/~slott1
Buccaneer #468: KaDiMa

Macintosh user: drinking upstream from the herd.

__________________________________________________
Do You Yahoo!?
Yahoo! - Official partner of 2002 FIFA World Cup
http://fifaworldcup.yahoo.com

From lawrence_jesse at yahoo.ca  Wed Jul  3 08:24:55 2002
From: lawrence_jesse at yahoo.ca (Jesse Lawrence)
Date: Fri Jan  9 21:46:49 2004
Subject: [mod_python] make problems
Message-ID: <20020703122455.30604.qmail@web11303.mail.yahoo.com>

Hello everyone,

I've tried finding an answer to this in the mailing
list archive, but haven't been successful. I run the
following:

./configure --with-apxs=/usr/sbin/apxs 

and it seems to be fine, but when I run make dso or
just make, I get the following message:

[jalaw@soniceast mod_python-2.7.8]# make dso
make[1]: Entering directory
`/home/jalaw/mod_python-2.7.8/src'
gcc  -I/home/jalaw/mod_python-2.7.8/src/include
-I/usr/include/apache -I/usr/include/python2.1    -c
-o mod_python.o mod_python.c
In file included from mod_python.c:54:
/home/jalaw/mod_python-2.7.8/src/include/mod_python.h:77:20:
Python.h: No such file or directory
/home/jalaw/mod_python-2.7.8/src/include/mod_python.h:78:26:
structmember.h: No
such file or directory
make[1]: *** [mod_python.o] Error 1
make[1]: Leaving directory
`/home/jalaw/mod_python-2.7.8/src'
make: *** [do_dso] Error 2

Can anyone please tell me what is happening here?  Any
help will be greatly appreciated.

Thank you,

Jesse Lawrence

______________________________________________________________________ 
Post your ad for free now! http://personals.yahoo.ca

From fuf at mobil.cz  Wed Jul  3 14:31:23 2002
From: fuf at mobil.cz (Michal Vitecek)
Date: Fri Jan  9 21:46:49 2004
Subject: [mod_python] make problems
In-Reply-To: <20020703122455.30604.qmail@web11303.mail.yahoo.com>
References: <20020703122455.30604.qmail@web11303.mail.yahoo.com>
Message-ID: <20020703123123.GJ28418@diana.mobil.cz>

 you're missing the python header files. most probably because you are on
 some system with package system and haven't installed the appropriate
 package. for RH this could be python-devel-something.

Jesse Lawrence wrote:
>Hello everyone,
>
>I've tried finding an answer to this in the mailing
>list archive, but haven't been successful. I run the
>following:
>
>./configure --with-apxs=/usr/sbin/apxs 
>
>and it seems to be fine, but when I run make dso or
>just make, I get the following message:
>
>[jalaw@soniceast mod_python-2.7.8]# make dso
>make[1]: Entering directory
>`/home/jalaw/mod_python-2.7.8/src'
>gcc  -I/home/jalaw/mod_python-2.7.8/src/include
>-I/usr/include/apache -I/usr/include/python2.1    -c
>-o mod_python.o mod_python.c
>In file included from mod_python.c:54:
>/home/jalaw/mod_python-2.7.8/src/include/mod_python.h:77:20:
>Python.h: No such file or directory
>/home/jalaw/mod_python-2.7.8/src/include/mod_python.h:78:26:
>structmember.h: No
>such file or directory
>make[1]: *** [mod_python.o] Error 1
>make[1]: Leaving directory
>`/home/jalaw/mod_python-2.7.8/src'
>make: *** [do_dso] Error 2
>
>Can anyone please tell me what is happening here?  Any
>help will be greatly appreciated.
>
>Thank you,
>
>Jesse Lawrence
>
>______________________________________________________________________ 
>Post your ad for free now! http://personals.yahoo.ca
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://www.modpython.org/mailman/listinfo/mod_python

-- 
		fuf		(fuf@mobil.cz)

From clee at spiralis.merseine.nu  Wed Jul  3 07:52:00 2002
From: clee at spiralis.merseine.nu (clee@spiralis.merseine.nu)
Date: Fri Jan  9 21:46:49 2004
Subject: [mod_python] make problems
In-Reply-To: <20020703122455.30604.qmail@web11303.mail.yahoo.com>
References: <20020703122455.30604.qmail@web11303.mail.yahoo.com>
Message-ID: <15650.62320.759265.205900@spiralis.merseine.nu>

>>>>> "Jesse" == Jesse Lawrence <lawrence_jesse@yahoo.ca> writes:

    Jesse> Hello everyone, I've tried finding an answer to this in the
    Jesse> mailing list archive, but haven't been successful. I run
    Jesse> the following:

    Jesse> ./configure --with-apxs=/usr/sbin/apxs

On my linux system, I need to specify where the python source
distribution is.  For example:

  ./configure  --with-apxs=/usr/sbin/apxs --with-python=/usr/local/src/Python-2.1.3


From lawrence_jesse at yahoo.ca  Wed Jul  3 09:58:15 2002
From: lawrence_jesse at yahoo.ca (Jesse Lawrence)
Date: Fri Jan  9 21:46:49 2004
Subject: [mod_python] make problems
In-Reply-To: <20020703123123.GJ28418@diana.mobil.cz>
Message-ID: <20020703135815.41942.qmail@web11303.mail.yahoo.com>

Thanks a lot for the pointer.  It did the trick.  Now
I'm having problems with my apache configuration. 
I've got the AddModule and 
LoadModule ok, but I'm a little confused as to the
proper way to set up the AddHandler and PythonHandler,
the documentation seems a little hazy on this point. 
Any help will be greatly appreciated,
Thanks,
Jesse

--- Michal Vitecek <fuf@mobil.cz> wrote:
>  you're missing the python header files. most
> probably because you are on
>  some system with package system and haven't
> installed the appropriate
>  package. for RH this could be
> python-devel-something.
> 
> Jesse Lawrence wrote:
> >Hello everyone,
> >
> >I've tried finding an answer to this in the mailing
> >list archive, but haven't been successful. I run
> the
> >following:
> >
> >./configure --with-apxs=/usr/sbin/apxs 
> >
> >and it seems to be fine, but when I run make dso or
> >just make, I get the following message:
> >
> >[jalaw@soniceast mod_python-2.7.8]# make dso
> >make[1]: Entering directory
> >`/home/jalaw/mod_python-2.7.8/src'
> >gcc  -I/home/jalaw/mod_python-2.7.8/src/include
> >-I/usr/include/apache -I/usr/include/python2.1   
> -c
> >-o mod_python.o mod_python.c
> >In file included from mod_python.c:54:
>
>/home/jalaw/mod_python-2.7.8/src/include/mod_python.h:77:20:
> >Python.h: No such file or directory
>
>/home/jalaw/mod_python-2.7.8/src/include/mod_python.h:78:26:
> >structmember.h: No
> >such file or directory
> >make[1]: *** [mod_python.o] Error 1
> >make[1]: Leaving directory
> >`/home/jalaw/mod_python-2.7.8/src'
> >make: *** [do_dso] Error 2
> >
> >Can anyone please tell me what is happening here? 
> Any
> >help will be greatly appreciated.
> >
> >Thank you,
> >
> >Jesse Lawrence
> >
>
>______________________________________________________________________
> 
> >Post your ad for free now!
> http://personals.yahoo.ca
> >_______________________________________________
> >Mod_python mailing list
> >Mod_python@modpython.org
>
>http://www.modpython.org/mailman/listinfo/mod_python
> 
> -- 
> 		fuf		(fuf@mobil.cz)
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


______________________________________________________________________ 
Post your ad for free now! http://personals.yahoo.ca

From ps0 at igmp.com.ar  Wed Jul  3 11:35:08 2002
From: ps0 at igmp.com.ar (ps0@igmp.com.ar)
Date: Fri Jan  9 21:46:50 2004
Subject: [mod_python] Problems creating files from mod_python
In-Reply-To: <ch95ius9pgmdhso3cnuc6fv6m034o12p8j@4ax.com>; from lisicky@datis.cdrail.cz on Wed, Jul 03, 2002 at 09:22:38AM +0200
References: <20020702194803.A27995@igmp.com.ar> <ch95ius9pgmdhso3cnuc6fv6m034o12p8j@4ax.com>
Message-ID: <20020703113508.A11838@igmp.com.ar>

On Wed, Jul 03, 2002 at 09:22:38AM +0200, Jiri Lisicky wrote:
> On Tue, 2 Jul 2002 19:48:03 -0300, you wrote:
> 
> >Apache: 1.3.24
> >mod_python: 2.7.8
> >Python: 2.2 (w/threads) [i have to recompile it
> >without threads]
> >
> >
> >fd=open("/tmp/bleh.txt", "w")
> >fd.write("HOLA\n")
> >fd.close()
> >
> >On the fd.close() it make this error:
> >IOError: [Errno 9] Bad file Descriptor 
> >
> >The file is created but i can't write on it.
> >
> >
> >The perms are corectly applied, from a python script ( out of apache )
> >the thinks work ok.
> >
> >Sugestions apreciated.
> Exists file /tmp/bleh.txt before running script from mod_python? 
> Maybe you create this file by generic python script under your
> username. When call it under mod_python, it is under apache account =
> permission problem.
> --
>         Ji?? Lisick?                      ?D KM?P Olomouc
> e-mail: lisicky@datis.cdrail.cz           V?de?sk? 15
>  phone: +420-068-578-2272                 Olomouc, Czech Republic
>               >>> ?e?tina ISO-8859-2 Compatible <<<
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

no , the file doesn't exist before running the script in mod_python, i
aready check that.

Regards

From gerard.patel at nerim.net  Wed Jul  3 17:42:14 2002
From: gerard.patel at nerim.net (Gerard Patel)
Date: Fri Jan  9 21:46:50 2004
Subject: [mod_python] Problems creating files from mod_python
Message-ID: <1.5.4.32.20020703154214.4178bebc@pop.nerim.net>

At 11:35 AM 7/3/02 -0300, you wrote:

(...)
>> >On the fd.close() it make this error:
>> >IOError: [Errno 9] Bad file Descriptor 
>> >
>> >The file is created but i can't write on it.
>> >
>> >
>> >The perms are corectly applied, from a python script ( out of apache )
>> >the thinks work ok.
>
>
>no , the file doesn't exist before running the script in mod_python, i
>aready check that.

Maybe you could check by hand if the apache user has
the correct rights ? Here is what I would do in the same
situation - on my system Apache runs as nobody :

su
<enter root password>

su nobody

try to create a file; if it fails, the user has no rights and it's
a system configuration question.

Hope this helps

Gerard Patel



From vmilitaru at sympatico.ca  Wed Jul  3 15:32:39 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 21:46:50 2004
Subject: [mod_python] Tips and Tricks initiative
Message-ID: <20020703153239.A772@eye.neb>

Hello,
Inspired by Apache's excellent "URL Rewriting Guide" (http://httpd.apache.org/docs/misc/rewriteguide.html), I would like to suggest that the mod_python maintainers compile a similar document, focussed exclusively on short, practical tricks and tips documenting how mod_python can help to solve some typical problems. This would, to some extent, cut off on redundant posts to the list, as well as help spread knowledge from the more experienced to the more 'mod_python challenged' (like myself). There is no better selling argument for mod_python than a few well written lines of 'mod_python' code ...

An example of a possible entry to the 'mod_python Tips&Tricks' list:


Generic Redirect

Description:
  problem description blah blah ... In this example: basically simulating mod_rewrite in mod_python.

Solution:
  additional blah blah explaining how we are going to brilliantly solve that mind boggling problem in 2 lines of code ...

  def handler(REQUEST):
    # some code generating our url goes here

    url = 'http://www.yahoo.com' # an example url to test the redirect code
    REQUEST.headers_out["Location"] = url
    REQUEST.status = 302
    REQUEST.send_http_header()


For instance, I'd be very interested to read in such a tricks and tips list how to avoid the overhead of creating a database connection at each call to 'handler'. And so on.

Cheers, Vio

From vmilitaru at sympatico.ca  Wed Jul  3 16:10:32 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 21:46:50 2004
Subject: [mod_python] Tips and Tricks initiative ... some followup contribution
Message-ID: <20020703161032.A828@eye.neb>

Generic Cookies

Description:
  How do we bake cookies in mod_python?

Solution:
  def handler(REQUEST):
    header_key = 'Set-Cookie'
    # set cookie values
    for header_value in (
'MyCookie1Var=homepop-shown=1; expires=Wed, 03-Jul-2002 05:18:07 GMT; path=/; domain=zzzz;', 
'MyCookie2Var=homepop-shown=0; expires=Wed, 03-Jul-2002 05:18:07 GMT; path=/; domain=zzzz;',
'MyCookieN=homepop-shown=0; expires=Wed, 03-Jul-2002 05:18:07 GMT; path=/; domain=zzzz;'
    ):
      REQUEST.headers_out.add(header_key,header_value)

    # set additional header arguments here

    # send header to client
    REQUEST.send_http_header()
    return apache.OK

From vmilitaru at sympatico.ca  Wed Jul  3 16:37:49 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 21:46:50 2004
Subject: [mod_python] Tips and Tricks initiative ... some followup contribution /3
Message-ID: <20020703163749.A873@eye.neb>

Already reaching the bottom of my mod_python tricks basket:


REQUEST Attributes Made Easy

Description:
  How can I see all REQUEST's attributes in one swoop.

Solution:
  (one amongst many, I believe)

  def handler(REQUEST):
      # set headers
      REQUEST.content_type = "text/html"
      REQUEST.send_http_header()

      # list all REQUEST's attributes
      REQUEST.write('<HTML><BODY>\n\n')
      for item in dir(REQUEST):
              exec('x = REQUEST.' + str(item))
              REQUEST.write('REQUEST.' + str(item) + ' = ' + str(x))
              REQUEST.write('\n\n<BR>\n\n')

      REQUEST.write('\n\n</BODY></HTML>\n')
      return apache.OK

I hope some may find these little code snipplets useful. I guess other tips&tricks are similarly welcome.

Cheers, Vio

From alain at onesite.org  Wed Jul  3 22:49:47 2002
From: alain at onesite.org (Alain Tesio)
Date: Fri Jan  9 21:46:50 2004
Subject: [mod_python] Tips and Tricks initiative
In-Reply-To: <20020703153239.A772@eye.neb>
References: <20020703153239.A772@eye.neb>
Message-ID: <20020703224947.403225e9.alain@onesite.org>

On Wed, 3 Jul 2002 15:32:39 -0500
vio <vmilitaru@sympatico.ca> wrote:

Technically a wiki is nice for public contributions :
http://moin.sourceforge.net/

> For instance, I'd be very interested to read in such a tricks and tips list how to avoid the
> overhead of creating a database connection at each call to 'handler'. And so on.

Just make the connection a global variable.

Alain


From dustin at ywlcs.org  Wed Jul  3 16:01:39 2002
From: dustin at ywlcs.org (Dustin Mitchell)
Date: Fri Jan  9 21:46:50 2004
Subject: [mod_python] Tips and Tricks initiative ... some followup contribution /3
In-Reply-To: <20020703163749.A873@eye.neb>
References: <20020703163749.A873@eye.neb>
Message-ID: <20020703210138.GQ9517@eleanor.internal.ywlcs.org>

On Wed, Jul 03, 2002 at 04:37:49PM -0500, vio wrote:
> Already reaching the bottom of my mod_python tricks basket:
> 
> 
> REQUEST Attributes Made Easy
> 
> Description:
>   How can I see all REQUEST's attributes in one swoop.
> 
> Solution:
>   (one amongst many, I believe)
> 
>   def handler(REQUEST):
>       # set headers
>       REQUEST.content_type = "text/html"
>       REQUEST.send_http_header()
> 
>       # list all REQUEST's attributes
>       REQUEST.write('<HTML><BODY>\n\n')
>       for item in dir(REQUEST):
>               exec('x = REQUEST.' + str(item))
>               REQUEST.write('REQUEST.' + str(item) + ' = ' + str(x))
>               REQUEST.write('\n\n<BR>\n\n')
 let's avoid 'exec'; how about
                x = getattr(REQUEST, item)
                REQUEST.write('REQUEST.%s = %s\n\n<br>\n\n' % item, `x`)
> 
>       REQUEST.write('\n\n</BODY></HTML>\n')
>       return apache.OK

-- 

  Dustin Mitchell
  dustin@ywlcs.org
  http://people.cs.uchicago.edu/~dustin/

From vmilitaru at sympatico.ca  Wed Jul  3 17:38:49 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 21:46:50 2004
Subject: [mod_python] Tips and Tricks initiative
In-Reply-To: <20020703224947.403225e9.alain@onesite.org>; from alain@onesite.org on Wed, Jul 03, 2002 at 10:49:47PM +0200
References: <20020703153239.A772@eye.neb> <20020703224947.403225e9.alain@onesite.org>
Message-ID: <20020703173849.A937@eye.neb>

* Alain Tesio <alain@onesite.org> [020703 17:11]:

> > For instance, I'd be very interested to read in such a tricks and tips list how to avoid the
> > overhead of creating a database connection at each call to 'handler'. And so on.
> 
> Just make the connection a global variable.

I think I tried that, initialized the db connection at the module level. But somehow my cursor got corrupted, or something. I forgot oracle's error number, only that my workaround was to do something like (we're at module level here):

db = DCOracle2.connect(my_login_string)
def get_db_cursor():
    "create database connection"
    cursor = db.cursor() # Allocate a cursor
    return cursor

In fact I see that I am re-using the same connection here, so let me re-phrase my initial question: how do I re-use the same *cursor* (or it this a bad idea in the first place). I wonder what would happen in such a multi-threaded environment (well, I'm saling in Linuxland) where multiple httpd instances will hit on the db server (ora8i in my case) with the same cursor *concurrently* (never got to that point of desperation, though - but just from contemplating such possibility sounds like total anarchy). What I did try but eventually got an error on was to re-use the same cursor sequentially (in a non-threaded application).

Cheers, Vio

From alain at onesite.org  Thu Jul  4 00:06:08 2002
From: alain at onesite.org (Alain Tesio)
Date: Fri Jan  9 21:46:50 2004
Subject: [mod_python] Tips and Tricks initiative
In-Reply-To: <20020703173849.A937@eye.neb>
References: <20020703153239.A772@eye.neb>
	<20020703224947.403225e9.alain@onesite.org>
	<20020703173849.A937@eye.neb>
Message-ID: <20020704000608.5bf2dea3.alain@onesite.org>

On Wed, 3 Jul 2002 17:38:49 -0500
vio <vmilitaru@sympatico.ca> wrote:

> In fact I see that I am re-using the same connection here, so let me re-phrase my initial
> question: how do I re-use the same *cursor* (or it this a bad idea in the first place).

I think a cursor is not designed to be re-used, what I usually do with cursors is:

- open it
- execute a query
- fetch the rows
- close and remove it (manually with del)

Maybe I'm wrong and a closed cursor can be reopened, I have no idea what
ressources it takes just to create it.

If this works and you want to do it, it can't be shared by two users, you can
use a pool of reusable cursors in a global variable, with a correct lock handling
to make sure you don't get the same cursor from the pool for two users.

Alain

From barr at cs.cornell.edu  Sun Jul  7 19:32:18 2002
From: barr at cs.cornell.edu (Rimon Barr)
Date: Fri Jan  9 21:46:50 2004
Subject: [mod_python] spyce v1.1.22
Message-ID: <Pine.LNX.4.44.0207071930240.8857-100000@pompom.u.cs.cornell.edu>

Most important changes since last posting (v1.1.18)
 - easier install; .rpm should work on more systems
 - does not rely on mod_python by default... too hard to get right
   automatically, and users don't get to play with Spyce
 - downgraded some code to run on Python v2.1.1 and up.
   (requires nested scoping, so can't go further than that)
 - removed use of Python threads
 - new filter module
 - improved installation documentation, and explained how modules work
... and lots more.

Spyce still works under mod_python. To get it to work, you'll need a
properly running mod_python, and then just to comment and uncomment a few
lines in your httpd.conf. See:
  http://spyce.sourceforge.net/download.html#modpython

----------
SPYCE - Server Python Pages

SPYCE is a webserver plugin that supports simple and efficient
Python-based dynamic HTML scripting. Those who like Python and are
familiar with JSP, or PHP, or ASP, should have a look at this engine. It
allows one to generate dynamic HTML content just as easily, using Python
for the dynamic parts. Its modular design makes it very flexible and
extensible. It supports FastCGI, CGI and mod_python to plugin into Apache
and most other webservers. It can also be used as a command-line utility
for HTML pre-processing.

v1.1.22 released on 7 July 2002.

Get it at:
  http://spyce.sourceforge.net

----------
Partial change log:

v1.1.22
  fixed Python v2.1.1-related bugs.
  improved installation process and documentation
  rpm more likely to succeed - uses fcgi or drops back to cgi
  no longer mod_python based by default

v1.1.21 (faulty release)
  stochastic session clean up; no more threading dependency
  documentation: better installation notes
  peep-hole optimizer

v1.1.20 (faulty release)
  created explicit (swappable) cache infrastructure
  BUG ** Spyce also works on Python v2.1
  request - request.post(),post1() works in includes
  documentation: cheetah install, ...

v1.1.19
  filter module

v1.1.18
  fcgi support added
  X-Spyce header added
  documentation: how to write new modules

v1.1.17
  feature request - compaction algorithm improved
...

Enjoy,
Rimon.
-- 
 * Rimon Barr       Ph.D. candidate, Computer Science, Cornell University
 | barr@cs.cornell.edu - http://www.cs.cornell.edu/barr - Y!IM: batripler
 |
 | Understanding is a kind of ecstasy.
 +----                                   -- Carl Sagan



From johannes at erdfelt.com  Wed Jul  3 18:34:27 2002
From: johannes at erdfelt.com (Johannes Erdfelt)
Date: Fri Jan  9 21:46:50 2004
Subject: [mod_python] Tips and Tricks initiative
In-Reply-To: <20020703153239.A772@eye.neb>; from vmilitaru@sympatico.ca on Wed, Jul 03, 2002 at 03:32:39PM -0500
References: <20020703153239.A772@eye.neb>
Message-ID: <20020703183427.M2452@sventech.com>

On Wed, Jul 03, 2002, vio <vmilitaru@sympatico.ca> wrote:
> Hello,
> Inspired by Apache's excellent "URL Rewriting Guide" (http://httpd.apache.org/docs/misc/rewriteguide.html), I would like to suggest that the mod_python maintainers compile a similar document, focussed exclusively on short, practical tricks and tips documenting how mod_python can help to solve some typical problems. This would, to some extent, cut off on redundant posts to the list, as well as help spread knowledge from the more experienced to the more 'mod_python challenged' (like myself). There is no better selling argument for mod_python than a few well written lines of 'mod_python' code ...

While not the most appropriate name, why doesn't the FAQ work for you?

http://www.modpython.org/FAQ/faqw.py

> For instance, I'd be very interested to read in such a tricks and tips list how to avoid the overhead of creating a database connection at each call to 'handler'. And so on.

http://www.modpython.org/FAQ/faqw.py?req=all#3.3

JE


From bob at redivi.com  Wed Jul  3 18:36:04 2002
From: bob at redivi.com (Bob Ippolito)
Date: Fri Jan  9 21:46:50 2004
Subject: [mod_python] Tips and Tricks initiative
In-Reply-To: <20020703173849.A937@eye.neb>
Message-ID: <4207FDD5-8ED5-11D6-9214-0003938210D6@redivi.com>

It depends on the particular db module, some modules have threadsafe 
database instances, some don't.  Some have threadsafe database cursors, 
and some don't.  Read the docs.  If it's DBAPI compliant, check its 
thread safe level.  I have never used anything that's thread safe level 
3, most are level 2 or 1 in my experience.

from http://www.python.org/topics/database/DatabaseAPI-2.0.html
threadsafety
Integer constant stating the level of thread safety the interface 
supports. Possible values are:
0	= Threads may not share the module.
1	= Threads may share the module, but not connections.
2	= Threads may share the module and connections.
3	= Threads may share the module, connections and cursors.

Sharing in the above context means that two threads may use a resource 
without wrapping it using a mutex semaphore to implement resource 
locking. Note that you cannot always make external resources thread safe 
bymanaging access using a mutex: the resource may rely on global 
variables or other external sources that are beyond your control.

-bob

On Wednesday, July 3, 2002, at 06:38 PM, vio wrote:

> * Alain Tesio <alain@onesite.org> [020703 17:11]:
>
>>> For instance, I'd be very interested to read in such a tricks and 
>>> tips list how to avoid the
>>> overhead of creating a database connection at each call to 'handler'. 
>>> And so on.
>>
>> Just make the connection a global variable.
>
> I think I tried that, initialized the db connection at the module 
> level. But somehow my cursor got corrupted, or something. I forgot 
> oracle's error number, only that my workaround was to do something like 
> (we're at module level here):
>
> db = DCOracle2.connect(my_login_string)
> def get_db_cursor():
>     "create database connection"
>     cursor = db.cursor() # Allocate a cursor
>     return cursor
>
> In fact I see that I am re-using the same connection here, so let me 
> re-phrase my initial question: how do I re-use the same *cursor* (or it 
> this a bad idea in the first place). I wonder what would happen in such 
> a multi-threaded environment (well, I'm saling in Linuxland) where 
> multiple httpd instances will hit on the db server (ora8i in my case) 
> with the same cursor *concurrently* (never got to that point of 
> desperation, though - but just from contemplating such possibility 
> sounds like total anarchy). What I did try but eventually got an error 
> on was to re-use the same cursor sequentially (in a non-threaded 
> application).
>
> Cheers, Vio
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From pk1u at yahoo.com  Mon Jul  8 17:10:12 2002
From: pk1u at yahoo.com (Praveen Kumar)
Date: Fri Jan  9 21:46:50 2004
Subject: [mod_python] DCOracle2 w/ apache + mod_python under rh7.2 ?
Message-ID: <20020709001012.18211.qmail@web10403.mail.yahoo.com>

Same problem I posted last week; I've tried a few more
things ( described below ). Is anyone running this
config ?

Any suggestions on how I can go about debugging this
would be appreciated.

> Has anyone successfully used DCOracle2 w/ apache +
> mod_python under rh7.2 ?
> 
> My system consists of rh7.2, apache1.3.26,
> mod_python-2.7.8, python2.1.3, Oracle9i .
> 
> I see the following when my program accesses the
> DCOracle2 module:
> 
>   File
>
"/usr/lib/python2.1/site-packages/DCOracle2/__init__.py",
> line 37, in ?
>     from DCOracle2 import   *
> 
>   File
>
"/usr/lib/python2.1/site-packages/DCOracle2/DCOracle2.py",
> line 104, in ?
>     import dco2
> 
> ImportError: libclntsh.so.9.0: cannot open shared
> object file: No such file or directory
> 
> 
> 
> I've tried the following:
> 
> -----
> 
> Setting LD_LIBRARY_PATH from the same shell where I
> start apache:
> 
> export LD_LIBRARY_PATH=/home/pk/OraHome1/lib
> 
> -----
> 
> Setting LD_LIBRARY_PATH to /home/pk/OraHome1/lib via
> Apache's PassEnv and SetEnv directives.
> 
> -----
> 
> Placed libclntsh.so.9.0 in
> /usr/lib/python2.1/site-packages/DCOracle2 ( same
> path
> as dco2.so ).
> 
> -----
> 
> Added /home/pk/OraHome1/lib to /etc/ld.so.conf , and
> executed /sbin/ldconfig as root.
> 
> -----
> 
> Tried adding each of:
> 
> os.putenv( 'LD_LIBRARY_PATH',
> '/home/pk/OraHome1/lib'
> )
> 
> os.environ[ 'LD_LIBRARY_PATH' ] =
> '/home/pk/OraHome1/lib'
> 
> in DCOracle2/DCOracle2.py before the "import dco2"
> statement
> 
> -----
> 
> /home/pk/OraHome1/lib is readable by all ; but tried
> the following anyway, to eliminate a
> permissions-issue
> as the cause:
> 
> As root, copied /home/pk/OraHome1/lib to /oralib ;
> tried all of the above, using /oralib
> 
> -----
> 
> "/home/pk/OraHome1/lib/libclntsh.so.9.0" exists, yet
> none of these work. The DCOracle2 module works fine
> when I use it from a standalone program. It would be
> helpful to know if anyone has gotten this config to
> work; also, any suggestions would be appreciated.
> 
> pk
> 
> 
> __________________________________________________
> Do You Yahoo!?
> Sign up for SBC Yahoo! Dial - First Month Free
> http://sbc.yahoo.com
> 
> 
> _______________________________________________
> DB-SIG maillist  -  DB-SIG@python.org
> http://mail.python.org/mailman/listinfo/db-sig


__________________________________________________
Do You Yahoo!?
Sign up for SBC Yahoo! Dial - First Month Free
http://sbc.yahoo.com

From marklists at mceahern.com  Tue Jul  9 12:41:27 2002
From: marklists at mceahern.com (Mark McEahern)
Date: Fri Jan  9 21:46:50 2004
Subject: [mod_python] configuration error
Message-ID: <JHEOKEOOLIGLDHCMAHMOMEJPDAAA.marklists@mceahern.com>

Hi, I'm trying to configure mod_python with Apache.  When I run the test, I
get Internal Server Error.  Here's what I see in Apache's error_log:

[Tue Jul  9 12:10:18 2002] [notice] Apache/1.3.26 (Unix) mod_python/2.7.8
Python/2.2.1 configured -- resuming normal operations
[Tue Jul  9 12:10:18 2002] [notice] Accept mutex: sysvsem (Default: sysvsem)
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
[Tue Jul  9 12:10:46 2002] [error] [client 192.168.0.1] python_handler:
make_obcallback returned no obCallBack!

Here's how I compiled mod_python and installed it:

  ./configure --with-apxs=/usr/local/apache/bin/apxs
  ./make
  sudo make install

I then edited httpd.conf, adding:

LoadModule python_module /usr/local/apache/libexec/mod_python.so

and

<Directory /home/.../pytest/>
  AddHandler python-program .py
  PythonHandler mptest
  PythonDebug On
</Directory>

This is mptest.py:

from mod_python import apache

def handler(req):
    req.send_http_header()
    req.write("Hello World!")
    return apache.OK

I'm running Apache 1.3.26 on Red Hat Linux 7.3.  I'm using Python 2.2.1.
mod_python installed into:

	/usr/local/lib/python2.2/site-packages/mod_python/

which is world readable.  All the files in mod_python are world readable.
Interestingly, the .py files are world executable, but the .pyc files are
NOT world executable--I don't think that makes a difference?

Is there something obvious I'm doing wrong in configuring Apache?

I found this thread and the threads it points to:

  http://www.modpython.org/pipermail/mod_python/2000-September/000881.html

The problem he encountered was that mod_python was installed as
mod_python$version, which he solved by using a symbolic link.  I don't think
that's the problem I'm having.

Interestingly, if I start Apache with httpd -X, Hello World works just fine.
However, when I start Apache normally, it doesn't work, but the above dump
from error log is all I have to go on.

Any ideas?

Thanks,

// mark

-


From marklists at mceahern.com  Tue Jul  9 13:30:20 2002
From: marklists at mceahern.com (Mark McEahern)
Date: Fri Jan  9 21:46:50 2004
Subject: [mod_python] configuration error
In-Reply-To: <JHEOKEOOLIGLDHCMAHMOMEJPDAAA.marklists@mceahern.com>
Message-ID: <JHEOKEOOLIGLDHCMAHMOGEKEDAAA.marklists@mceahern.com>

I was able to fix this by recompiling Python like so:

  ./configure --without-threads

What I wonder is how come mod_python's configure didn't warn me about this
as implied here:


http://www.modpython.org/live/mod_python-2.7.8/doc-html/inst-configure.html

Cheers,

// mark

> -----Original Message-----
> From: mod_python-admin@modpython.org
> [mailto:mod_python-admin@modpython.org]On Behalf Of Mark McEahern
> Sent: Tuesday, July 09, 2002 12:41 PM
> To: mod_python@modpython.org
> Subject: [mod_python] configuration error
>
>
> Hi, I'm trying to configure mod_python with Apache.  When I run
> the test, I
> get Internal Server Error.  Here's what I see in Apache's error_log:
>
> [Tue Jul  9 12:10:18 2002] [notice] Apache/1.3.26 (Unix) mod_python/2.7.8
> Python/2.2.1 configured -- resuming normal operations
> [Tue Jul  9 12:10:18 2002] [notice] Accept mutex: sysvsem
> (Default: sysvsem)
> make_obcallback(): could not import mod_python.apache.
> make_obcallback(): could not call init.
> [Tue Jul  9 12:10:46 2002] [error] [client 192.168.0.1] python_handler:
> make_obcallback returned no obCallBack!
>
> Here's how I compiled mod_python and installed it:
>
>   ./configure --with-apxs=/usr/local/apache/bin/apxs
>   ./make
>   sudo make install
>
> I then edited httpd.conf, adding:
>
> LoadModule python_module /usr/local/apache/libexec/mod_python.so
>
> and
>
> <Directory /home/.../pytest/>
>   AddHandler python-program .py
>   PythonHandler mptest
>   PythonDebug On
> </Directory>
>
> This is mptest.py:
>
> from mod_python import apache
>
> def handler(req):
>     req.send_http_header()
>     req.write("Hello World!")
>     return apache.OK
>
> I'm running Apache 1.3.26 on Red Hat Linux 7.3.  I'm using Python 2.2.1.
> mod_python installed into:
>
> 	/usr/local/lib/python2.2/site-packages/mod_python/
>
> which is world readable.  All the files in mod_python are world readable.
> Interestingly, the .py files are world executable, but the .pyc files are
> NOT world executable--I don't think that makes a difference?
>
> Is there something obvious I'm doing wrong in configuring Apache?
>
> I found this thread and the threads it points to:
>
>   http://www.modpython.org/pipermail/mod_python/2000-September/000881.html
>
> The problem he encountered was that mod_python was installed as
> mod_python$version, which he solved by using a symbolic link.  I
> don't think
> that's the problem I'm having.
>
> Interestingly, if I start Apache with httpd -X, Hello World works
> just fine.
> However, when I start Apache normally, it doesn't work, but the above dump
> from error log is all I have to go on.
>
> Any ideas?
>
> Thanks,
>
> // mark
>
> -
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> -
>
>

-


From vmilitaru at sympatico.ca  Tue Jul  9 15:09:59 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 21:46:50 2004
Subject: [mod_python] Tips and Tricks initiative
In-Reply-To: <4207FDD5-8ED5-11D6-9214-0003938210D6@redivi.com>; from bob@redivi.com on Wed, Jul 03, 2002 at 06:36:04PM -0400
References: <20020703173849.A937@eye.neb> <4207FDD5-8ED5-11D6-9214-0003938210D6@redivi.com>
Message-ID: <20020709150959.A461@eye.neb>

Admittedly, the intent of re-using a cursor can only be summed up as pure
greed, or the art of sucking up the last atom of speed from a given system.
In dark moonless nights, I almost pitty myself.

Thanks for the intro on threadsafety. Most interesting.

* Bob Ippolito <bob@redivi.com> [020708 22:35]:
> It depends on the particular db module, some modules have threadsafe 
> database instances, some don't.  Some have threadsafe database cursors, 
> and some don't.  Read the docs.  If it's DBAPI compliant, check its 
> thread safe level.  I have never used anything that's thread safe level 
> 3, most are level 2 or 1 in my experience.
> 
> from http://www.python.org/topics/database/DatabaseAPI-2.0.html
> threadsafety
> Integer constant stating the level of thread safety the interface 
> supports. Possible values are:
> 0	= Threads may not share the module.
> 1	= Threads may share the module, but not connections.
> 2	= Threads may share the module and connections.
> 3	= Threads may share the module, connections and cursors.
> 
> Sharing in the above context means that two threads may use a resource 
> without wrapping it using a mutex semaphore to implement resource 
> locking. Note that you cannot always make external resources thread safe 
> bymanaging access using a mutex: the resource may rely on global 
> variables or other external sources that are beyond your control.
> 
> -bob
> 
> On Wednesday, July 3, 2002, at 06:38 PM, vio wrote:
> 
> > * Alain Tesio <alain@onesite.org> [020703 17:11]:
> >
> >>> For instance, I'd be very interested to read in such a tricks and 
> >>> tips list how to avoid the
> >>> overhead of creating a database connection at each call to 'handler'. 
> >>> And so on.
> >>
> >> Just make the connection a global variable.
> >
> > I think I tried that, initialized the db connection at the module 
> > level. But somehow my cursor got corrupted, or something. I forgot 
> > oracle's error number, only that my workaround was to do something like 
> > (we're at module level here):
> >
> > db = DCOracle2.connect(my_login_string)
> > def get_db_cursor():
> >     "create database connection"
> >     cursor = db.cursor() # Allocate a cursor
> >     return cursor
> >
> > In fact I see that I am re-using the same connection here, so let me 
> > re-phrase my initial question: how do I re-use the same *cursor* (or it 
> > this a bad idea in the first place). I wonder what would happen in such 
> > a multi-threaded environment (well, I'm saling in Linuxland) where 
> > multiple httpd instances will hit on the db server (ora8i in my case) 
> > with the same cursor *concurrently* (never got to that point of 
> > desperation, though - but just from contemplating such possibility 
> > sounds like total anarchy). What I did try but eventually got an error 
> > on was to re-use the same cursor sequentially (in a non-threaded 
> > application).
> >
> > Cheers, Vio
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://www.modpython.org/mailman/listinfo/mod_python
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

From vmilitaru at sympatico.ca  Tue Jul  9 15:18:48 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 21:46:50 2004
Subject: [mod_python] configuration error
In-Reply-To: <JHEOKEOOLIGLDHCMAHMOMEJPDAAA.marklists@mceahern.com>; from marklists@mceahern.com on Tue, Jul 09, 2002 at 12:41:27PM -0500
References: <JHEOKEOOLIGLDHCMAHMOMEJPDAAA.marklists@mceahern.com>
Message-ID: <20020709151848.B461@eye.neb>

> ...
> I then edited httpd.conf, adding:
> 
> LoadModule python_module /usr/local/apache/libexec/mod_python.so
> 

I believe just here should be something like:

	AddModule mod_python.c

> and
> 
> <Directory /home/.../pytest/>
>   AddHandler python-program .py
>   PythonHandler mptest
>   PythonDebug On
> </Directory>
> 

Hope this solves your bobo,
Vio

From marklists at mceahern.com  Tue Jul  9 14:35:13 2002
From: marklists at mceahern.com (Mark McEahern)
Date: Fri Jan  9 21:46:50 2004
Subject: [mod_python] configuration error
In-Reply-To: <20020709151848.B461@eye.neb>
Message-ID: <JHEOKEOOLIGLDHCMAHMOAEKKDAAA.marklists@mceahern.com>

> I believe just here should be something like:
>
> 	AddModule mod_python.c

That's only required if you have ClearModuleList, which I don't.

As I noted in a follow up, I solved the problem by recompiling Python
without thread support.

Cheers,

// mark

-


From gbenson at redhat.com  Sat Jul 13 12:51:32 2002
From: gbenson at redhat.com (Gary Benson)
Date: Fri Jan  9 21:46:50 2004
Subject: [mod_python] Ping?
Message-ID: <Pine.LNX.4.44.0207131250410.31967-100000@slippy.wire.rat>

It seems that I am getting messages from this list with a four day lag. 
Is anyone else experiencing this?

Cheers,
Gary

[ gbenson@redhat.com ][ GnuPG 85A8F78B ][ http://inauspicious.org/ ]


From fabbe at paniq.net  Sun Jul 14 11:33:07 2002
From: fabbe at paniq.net (Fabian Fagerholm)
Date: Fri Jan  9 21:46:50 2004
Subject: [mod_python] Understanding mod_python
Message-ID: <1026635587.26526.30.camel@kernel>

Hello, World!

I've just begun to get to know Python and mod_python. So far, I like
what I see, but there are a few things that are a bit confusing. I
suspect it's just a matter of differing conventions - my previous
experience programming web applications is with Perl (cgi), PHP and Java
(Servlets).

Since I like to know exactly what I'm doing, I've read through all the
docs I could find, and browsed through the mailing list archives. I now
have two issues that I would like to bring up.


First, I would like to convince myself that I have understood the
Handler concept and the Publisher Handler. Therefore, I've made two
drawings based on the mod_python docs. The first drawing is
    http://www.paniq.net/fabbe/mod_python/Handler_order.ps
and it tries to show what happens when a request is made to Apache. In
particular, I'm trying to understand in which *order* the Handlers are
called and what each Handler is for.
The second drawing is
    http://www.paniq.net/fabbe/mod_python/Publisher_handler.ps
and it tries to show how the Publisher Handler handles a request. It
also shows the different parts of an URI from the Publisher's point of
view.

        * Are these drawings correct or have I misunderstood anything?
        * I would like to combine the drawings into one. Where would I
          attach the second drawing to the first?
        * I didn't quite understand how the __auth__, __access__ and
          __auth_realm__ stuff in Publisher works. I'm confused by the
          phrase "at each traversal step, the Publisher checks for...".
          I understand one object might refer to or contain another, but
          the benefits and practical use of this is is not clear to me
          and would need further explanation.
        * Could these drawings be beneficial to someone else? If so, I'd
          be happy to modify them for some particular purpose.


Second, while reading the mailing list archives, I found that many of
the posts were about how to build a web application with a sensible
structure (separating content from presentation), authorization, session
management etc. with mod_python. A very valid question IMO, because the
tutorial in the docs is quite sparse and shows an example that is mostly
achievable by using traditional CGI.
Using Python's OO features, it should be possible to create quite
complex web applications. As far as I can see, mod_python is able to
replace a Java Servlet-based solution with little effort. In fact, this
is my exact reason for looking at mod_python. :)

There were also some posts about a mod_python "cookbook", and another
poster suggested the on-line FAQ would be a good place for the
"recipes". I totally agree - well-written example code is the best way
to learn.
I'd like to suggest that a new category be created in the FAQ for these
snippets of example code.


Cheers,
Fabian Fagerholm

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 240 bytes
Desc: This is a digitally signed message part
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20020714/e9156aa3/attachment.bin
From pk1u at yahoo.com  Sun Jul 14 16:58:17 2002
From: pk1u at yahoo.com (Praveen Kumar)
Date: Fri Jan  9 21:46:50 2004
Subject: [mod_python] Re: DCOracle2 w/ apache + mod_python under rh7.2 ?
In-Reply-To: <20020709073832.GV14854@glas.net>
Message-ID: <20020714235817.90778.qmail@web10411.mail.yahoo.com>

> 1) make sure you have set ORACLE_HOME env var.
> 2) make sure you have set LD_LIBRARY_PATH (to
> $ORACLE_HOME/lib) env var.
> 3) make sure that both of them are set _before_ the
> ecript execution.

Didn't work. I got around it by using mod_python as a
DSO, and using apache's LoadFile directive; in
httpd.conf:

LoadFile /home/pk/OraHome1/lib/libclntsh.so.9.0 

Not ideal, but it works.

pk

--- "Eugene V. Dvurechenski" <jno@glasnet.ru> wrote:
> On Mon, Jul 08, 2002 at 04:55:05PM -0700, Praveen
> Kumar wrote:
> >     import dco2
> > 
> > ImportError: libclntsh.so.9.0: cannot open shared
> > object file: No such file or directory
> 
> 1) make sure you have set ORACLE_HOME env var.
> 2) make sure you have set LD_LIBRARY_PATH (to
> $ORACLE_HOME/lib) env var.
> 3) make sure that both of them are set _before_ the
> ecript execution.
> 
> the last point is essential - os.environ doesn't
> help much.

Orig msg:

> Has anyone successfully used DCOracle2 w/ apache +
> mod_python under rh7.2 ?
> 
> My system consists of rh7.2, apache1.3.26,
> mod_python-2.7.8, python2.1.3, Oracle9i .
> 
> I see the following when my program accesses the
> DCOracle2 module:
> 
>   File
>
"/usr/lib/python2.1/site-packages/DCOracle2/__init__.py",
> line 37, in ?
>     from DCOracle2 import   *
> 
>   File
>
"/usr/lib/python2.1/site-packages/DCOracle2/DCOracle2.py",
> line 104, in ?
>     import dco2
> 
> ImportError: libclntsh.so.9.0: cannot open shared
> object file: No such file or directory
> 
> 
> 
> I've tried the following:
> 
> -----
> 
> Setting LD_LIBRARY_PATH from the same shell where I
> start apache:
> 
> export LD_LIBRARY_PATH=/home/pk/OraHome1/lib
> 
> -----
> 
> Setting LD_LIBRARY_PATH to /home/pk/OraHome1/lib via
> Apache's PassEnv and SetEnv directives.
> 
> -----
> 
> Placed libclntsh.so.9.0 in
> /usr/lib/python2.1/site-packages/DCOracle2 ( same
> path
> as dco2.so ).
> 
> -----
> 
> Added /home/pk/OraHome1/lib to /etc/ld.so.conf , and
> executed /sbin/ldconfig as root.
> 
> -----
> 
> Tried adding each of:
> 
> os.putenv( 'LD_LIBRARY_PATH',
> '/home/pk/OraHome1/lib'
> )
> 
> os.environ[ 'LD_LIBRARY_PATH' ] =
> '/home/pk/OraHome1/lib'
> 
> in DCOracle2/DCOracle2.py before the "import dco2"
> statement
> 
> -----
> 
> /home/pk/OraHome1/lib is readable by all ; but tried
> the following anyway, to eliminate a
> permissions-issue
> as the cause:
> 
> As root, copied /home/pk/OraHome1/lib to /oralib ;
> tried all of the above, using /oralib
> 
> -----
> 
> "/home/pk/OraHome1/lib/libclntsh.so.9.0" exists, yet
> none of these work. The DCOracle2 module works fine
> when I use it from a standalone program. It would be
> helpful to know if anyone has gotten this config to
> work; also, any suggestions would be appreciated.
> 
> pk
> 


__________________________________________________
Do You Yahoo!?
Yahoo! Autos - Get free new car price quotes
http://autos.yahoo.com

From jdaily at kc.rr.com  Sun Jul 14 20:01:21 2002
From: jdaily at kc.rr.com (james daily)
Date: Fri Jan  9 21:46:50 2004
Subject: [mod_python] please, old fool needs help with getting apache mod_python on windows 98 to run
Message-ID: <NDBBIADKLJIPFGPECIJPOELOCMAA.jdaily@kc.rr.com>

the mod_python online manual at:
    http://www.modpython.org/live/mod_python-2.7.8/doc-html/app-wininst.html

says:
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
A. Windows Installation

Notes originally created by Enrique Vaamonde evaamo@loquesea.com

Your mileage may vary with these instructions

You need to have the following packages properly installed and configured in
your system:


Python 1.5.2 or 2.0
Apache 1.3
Winzip 6.x or later.

You need to download both the mod_python.dll and the mod_python-x.tgz (where
x is the version number) files from the main page. Once you have all the
things above mentioned we're good to go.


Installing mod_python libraries

Use Winzip to extract the distribution file (mod_python-x.tgz) into a
temporary folder (i.e C:\temp):

NOTE: If Winzip shows this warning "Archive contains one file, should Winzip
decompress it to a temporary folder?" just click on Yes, the content of the
file should appear in Winzip right after.

Select all the files in Winzip and click on the Extract button, then type-in
the path or just browse your way to the temporary folder and click extract.

Open your Windows Explorer and locate the temporary folder where you
extracted the distribution file, you should have a new folder in your
temporary folder
(C:\temp\mod_python-x).

Move (or just drag & drop) the mod_python-x folder into the Python lib
folder
(i.e C:\Program Files\Python\lib).

Move the files in the folder lib inside the mod_python folder
(C:\Program Files\Python\lib\mod_python-x\lib\mod_python) to the
C:\Program Files\Python\lib\mod_python folder.
It's safe to delete these folders we just emptied.

xxxxxxxxxxx
also put the files from
    "mod_python-2.7.8\src\include\"
into
    "D:\Program Files\python211\Python21\include"
which allowed apache to start.
xxxxxxxxxxx

Integrating it with Apache
Once the distribution file is correctly extracted and later moved into the
Python directory, it's time to modify your Apache configuration (httpd.conf)
and integrate the server with mod_python. These are a few steps we must do
first:


Locate the file mod_python.dll that you downloaded before and move it to
Apache's modules folder (i.e C:\Program Files\Apache Group\Apache\modules).

Go to the Apache configuration folder (i.e C:\Program Files\Apache
Group\Apache\conf\) and edit the httpd.conf file.
Add the following line in the section "Dynamic Shared Object (DSO) Support"
of the httpd.conf file:


LoadModule python_module modules/mod_python.dll


Add the following lines in the section ScriptAlias and CGI of the
httpd.conf:


<Directory "<Your Document Root>/python">
   AddHandler python-program .py
   PythonHandler mptest
   PythonDebug on
</Directory>

NOTE: Replace the <Your Document Root> above with the Document Root you
specified on the DocumentRoot directive in the Apache's httpd.conf file.


Last, create a folder under your Document Root called python.


Testing

Create a text file in the folder we created above and call it mptest.py (you
can use Notepad for this).

Insert the following lines and save the file (Make sure it gets saved with
the .py extension):


from mod_python import apache

def handler(req):
   req.content_type = "text/plain"
   req.send_http_header()
   req.write("Hello World!")
   return apache.OK


Make sure Apache is running (or launch it!) and then point your browser to
the URL referring to the mptest.py, you should see "Hello World!".

That's it, you're ready to roll!! If you don't see the "Hello World!"
message, the next section is for you.
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

Apache/1.3.14 (Win32) running...
Python 2.1.1

all i get in the browser is the text of mptest.py

any suggestions?

if someone has it actually running on their windows 98 system,
could you please send me the ***relevant*** portions from your
apache httpd.conf file?

i have tried numerous different approaches to no avail.

alas, i am a programmer but not (yet) an apache guru.

any help would be greatly appreciated.


---------------------------------------------
James Daily
Phone : 816 943 9891
Email : wndrer@earthling.net (or hit reply button)
Web   : http://tellmama.com/
Philosophy:
                            4     2                              1000
( cos(? - r) - sin ? ) * ( r  - 2r  cos(2? + 2.4) + 0.9) + 0.62r)     < 0

Education is a progressive discovery of our own ignorance.
                                               Will Durant


From bill at immosys.com  Mon Jul 15 16:46:21 2002
From: bill at immosys.com (Bill Anderson)
Date: Fri Jan  9 21:46:50 2004
Subject: [mod_python] new to mod_python, with a question.
Message-ID: <1026773181.12028.7.camel@locutus>

OK, so here is what I am doing. I am using PageTemplates (from zope) and
mod_python. or at least, I am trying to. :)


if I do _NOT_ use the request object (i.e. I return a fully formed html
string/document), it works fine. but of course, that means no use of
mod-python's request objects functions such as cookie/header
construction, usage, etc.

To wit:
def sayit(req,x=12):
	if not x:
		return "I need x"
	if not master:
		return "I need a master object"
	pt=PageTemplate()
	filestring =
"".join(open("/home/ucntcme/public_html/pythonapps/test.pt").readlines())
	pt.write(filestring)
	myx=int(x)
        req.content_type="text/html"
        req.send_http_headers()
	req.write( pt(x=myx,master=master) )
	return apache.OK

returns my rendered template, but at the bottom has:

HTTP/1.1 200 OK Date: Mon, 15 Jul 2002 22:44:27 GMT Server:
Apache/1.3.22 (Unix) (Red-Hat/Linux) mod_python/2.7.8 Python/2.2.1
mod_ssl/2.8.5 OpenSSL/0.9.6b DAV/1.0.2 PHP/4.0.6 mod_perl/1.26
Connection: close Transfer-Encoding: chunked Content-Type: text/html;
charset=iso-8859-1
OK
The server encountered an internal error or misconfiguration and was
unable to complete your request.



Debug is on, and there are no mesages in the error_log.

Now, if I just return the content using return (content), it works fine.

Why is this/what am I doing wrong here?

Cheers, Bill







From gbenson at redhat.com  Tue Jul 16 10:15:59 2002
From: gbenson at redhat.com (Gary Benson)
Date: Fri Jan  9 21:46:50 2004
Subject: [mod_python] [PATCH] last httpd-2.0.36
Message-ID: <Pine.LNX.4.44.0207161015330.16859-200000@slippy.wire.rat>


Hi,

The attached patch brings the input filtering API in mod_python into line 
with that in httpd-2.0.36.  This is the last thing that I know of that 
needed fixing to work with 2.0.36, although I beleive some more fixes will 
be in order to build against 2.0.39 or whatever it is now :)

Cheers,
Gary

[ gbenson@redhat.com ][ GnuPG 85A8F78B ][ http://inauspicious.org/ ]
-------------- next part --------------
Bring input filter API in line with 2.0.36

Index: src/filterobject.c
===================================================================
RCS file: /cvsroot/modpython/mod_python/src/filterobject.c,v
retrieving revision 1.5
diff -u -r1.5 filterobject.c
--- src/filterobject.c	3 Jun 2002 14:31:15 -0000	1.5
+++ src/filterobject.c	9 Jul 2002 16:21:27 -0000
@@ -61,7 +61,7 @@
  */
 
 PyObject *MpFilter_FromFilter(ap_filter_t *f, apr_bucket_brigade *bb, int is_input,
-			      ap_input_mode_t mode, apr_size_t *readbytes,
+			      ap_input_mode_t mode, apr_size_t readbytes,
 			      char * handler, char *dir)
 {
     filterobject *result;
@@ -86,7 +86,7 @@
 	result->bb_in = bb;
 	result->bb_out = NULL;
 	result->mode = 0;
-	result->readbytes = NULL;
+	result->readbytes = 0;
     }
 
     result->closed = 0;
@@ -142,7 +142,7 @@
 
 	Py_BEGIN_ALLOW_THREADS;
 	self->rc = ap_get_brigade(self->f->next, self->bb_in, self->mode, 
-				  APR_BLOCK_READ, *self->readbytes);
+				  APR_BLOCK_READ, self->readbytes);
 	Py_END_ALLOW_THREADS;
 
 	if (! APR_STATUS_IS_SUCCESS(self->rc)) {
@@ -239,7 +239,7 @@
 
 		Py_BEGIN_ALLOW_THREADS;
 		self->rc = ap_get_brigade(self->f->next, self->bb_in, self->mode, 
-					  APR_BLOCK_READ, *self->readbytes);
+					  APR_BLOCK_READ, self->readbytes);
 		Py_END_ALLOW_THREADS;
 
 		if (! APR_STATUS_IS_SUCCESS(self->rc)) {
Index: src/mod_python.c
===================================================================
RCS file: /cvsroot/modpython/mod_python/src/mod_python.c,v
retrieving revision 1.60
diff -u -r1.60 mod_python.c
--- src/mod_python.c	3 Jun 2002 14:31:15 -0000	1.60
+++ src/mod_python.c	9 Jul 2002 16:21:35 -0000
@@ -1023,7 +1023,8 @@
 static apr_status_t python_filter(int is_input, ap_filter_t *f, 
 				  apr_bucket_brigade *bb,
 				  ap_input_mode_t mode,
-				  apr_size_t *readbytes) {
+				  apr_read_type_e block,
+				  apr_size_t readbytes) {
 
     PyObject *resultobject = NULL;
     interpreterdata *idata;
@@ -1052,8 +1053,7 @@
        so a fitler can spit out an error without causing infinite loop */
     if (ctx->transparent) {
 	if (is_input) 
-	    return ap_get_brigade(f->next, bb, mode, APR_BLOCK_READ, 
-				  *readbytes);
+	    return ap_get_brigade(f->next, bb, mode, block, readbytes);
 	else
 	    return ap_pass_brigade(f->next, bb);
     }
@@ -1201,9 +1201,10 @@
 static apr_status_t python_input_filter(ap_filter_t *f, 
 					apr_bucket_brigade *bb,
 					ap_input_mode_t mode,
-					apr_size_t *readbytes) 
+					apr_read_type_e block,
+					apr_off_t readbytes)
 {
-    return python_filter(1, f, bb, mode, readbytes);
+    return python_filter(1, f, bb, mode, block, readbytes);
 }
 
 
@@ -1216,7 +1217,7 @@
 static apr_status_t python_output_filter(ap_filter_t *f, 
 					 apr_bucket_brigade *bb)
 {
-    return python_filter(0, f, bb, 0, NULL);
+    return python_filter(0, f, bb, 0, 0, 0);
 }
 
 
Index: src/include/filterobject.h
===================================================================
RCS file: /cvsroot/modpython/mod_python/src/include/filterobject.h,v
retrieving revision 1.4
diff -u -r1.4 filterobject.h
--- src/include/filterobject.h	3 Jun 2002 14:31:16 -0000	1.4
+++ src/include/filterobject.h	9 Jul 2002 16:21:36 -0000
@@ -67,7 +67,7 @@
 
 	int is_input;
 	ap_input_mode_t mode;
-	apr_size_t *readbytes;
+	apr_size_t readbytes;
 
 	int closed;
 	int softspace;
@@ -88,7 +88,7 @@
     extern DL_IMPORT(PyObject *) 
 	MpFilter_FromFilter Py_PROTO((ap_filter_t *f, apr_bucket_brigade *bb_in, 
 				      int is_input, ap_input_mode_t mode, 
-				      apr_size_t *readbytes, char *hadler, char *dir));
+				      apr_size_t readbytes, char *hadler, char *dir));
 
 #ifdef __cplusplus
 }
From ecastanedo at hotmail.com  Wed Jul 17 01:04:14 2002
From: ecastanedo at hotmail.com (Edgar Castanedo)
Date: Fri Jan  9 21:46:50 2004
Subject: [mod_python] freebsd
Message-ID: <F1478v6eoHvEmsgTFsF000136d0@hotmail.com>

I have installed Python on FreeBSD from the ports collection. When I try and 
install mod_python (from the ports collection also), a message is returned 
which states that Python needs to be installed WITHOUT threads. I am not 
sure if this is okay since I write lots of Python script and don't know how 
this will affect Pythons performance. Can anyone shed some light on this for 
me as I do not want to disable threads if it means that my scripts will not 
work the way they used to.

Thanks,

*************************************
Edgar Castanedo
ecastanedo@hotmail.com
*************************************


_________________________________________________________________
Chat with friends online, try MSN Messenger: http://messenger.msn.com


From gharris at centauri.mb.ca  Fri Jul 19 00:18:58 2002
From: gharris at centauri.mb.ca (George Harrison)
Date: Fri Jan  9 21:46:50 2004
Subject: [mod_python] Installing mod_python on Win98/Apache
Message-ID: <5.1.0.14.2.20020718231601.027cfec0@pop.mb.sympatico.ca>

After following the instructions in the documentation and copying the files 
from D:\Program Files\Python22\lib\mod_python-x\lib\mod_python to 
D:\Program Files\Python22\lib\mod_python;  I can launch Apache but when I 
try to open mptest.py I get the following message in the error log:

[Thu Jul 18 23:50:19 2002] [error] [client 127.0.0.1] python_handler: 
make_obcallback returned no obCallBack!

Does anyone know what is happening, or have a listing of where the files 
are supposed to be in the python directory for this to work?

Thanks

gh



From gbenson at redhat.com  Wed Jul 10 11:42:21 2002
From: gbenson at redhat.com (Gary Benson)
Date: Fri Jan  9 21:46:50 2004
Subject: [mod_python] [PATCH] last httpd-2.0.36
Message-ID: <Pine.LNX.4.44.0207101139450.20893-200000@slippy.wire.rat>


Hi,

The attached patch brings the input filtering API in mod_python into line 
with that in httpd-2.0.36.  This is the last thing that I know of that 
needed fixing to work with 2.0.36, although I beleive some more fixes will 
be in order to build against 2.0.39 or whatever it is now :)

Cheers,
Gary

[ gbenson@redhat.com ][ GnuPG 85A8F78B ][ http://inauspicious.org/ ]

-------------- next part --------------
Bring input filter API in line with 2.0.36

Index: src/filterobject.c
===================================================================
RCS file: /cvsroot/modpython/mod_python/src/filterobject.c,v
retrieving revision 1.5
diff -u -r1.5 filterobject.c
--- src/filterobject.c	3 Jun 2002 14:31:15 -0000	1.5
+++ src/filterobject.c	9 Jul 2002 16:21:27 -0000
@@ -61,7 +61,7 @@
  */
 
 PyObject *MpFilter_FromFilter(ap_filter_t *f, apr_bucket_brigade *bb, int is_input,
-			      ap_input_mode_t mode, apr_size_t *readbytes,
+			      ap_input_mode_t mode, apr_size_t readbytes,
 			      char * handler, char *dir)
 {
     filterobject *result;
@@ -86,7 +86,7 @@
 	result->bb_in = bb;
 	result->bb_out = NULL;
 	result->mode = 0;
-	result->readbytes = NULL;
+	result->readbytes = 0;
     }
 
     result->closed = 0;
@@ -142,7 +142,7 @@
 
 	Py_BEGIN_ALLOW_THREADS;
 	self->rc = ap_get_brigade(self->f->next, self->bb_in, self->mode, 
-				  APR_BLOCK_READ, *self->readbytes);
+				  APR_BLOCK_READ, self->readbytes);
 	Py_END_ALLOW_THREADS;
 
 	if (! APR_STATUS_IS_SUCCESS(self->rc)) {
@@ -239,7 +239,7 @@
 
 		Py_BEGIN_ALLOW_THREADS;
 		self->rc = ap_get_brigade(self->f->next, self->bb_in, self->mode, 
-					  APR_BLOCK_READ, *self->readbytes);
+					  APR_BLOCK_READ, self->readbytes);
 		Py_END_ALLOW_THREADS;
 
 		if (! APR_STATUS_IS_SUCCESS(self->rc)) {
Index: src/mod_python.c
===================================================================
RCS file: /cvsroot/modpython/mod_python/src/mod_python.c,v
retrieving revision 1.60
diff -u -r1.60 mod_python.c
--- src/mod_python.c	3 Jun 2002 14:31:15 -0000	1.60
+++ src/mod_python.c	9 Jul 2002 16:21:35 -0000
@@ -1023,7 +1023,8 @@
 static apr_status_t python_filter(int is_input, ap_filter_t *f, 
 				  apr_bucket_brigade *bb,
 				  ap_input_mode_t mode,
-				  apr_size_t *readbytes) {
+				  apr_read_type_e block,
+				  apr_size_t readbytes) {
 
     PyObject *resultobject = NULL;
     interpreterdata *idata;
@@ -1052,8 +1053,7 @@
        so a fitler can spit out an error without causing infinite loop */
     if (ctx->transparent) {
 	if (is_input) 
-	    return ap_get_brigade(f->next, bb, mode, APR_BLOCK_READ, 
-				  *readbytes);
+	    return ap_get_brigade(f->next, bb, mode, block, readbytes);
 	else
 	    return ap_pass_brigade(f->next, bb);
     }
@@ -1201,9 +1201,10 @@
 static apr_status_t python_input_filter(ap_filter_t *f, 
 					apr_bucket_brigade *bb,
 					ap_input_mode_t mode,
-					apr_size_t *readbytes) 
+					apr_read_type_e block,
+					apr_off_t readbytes)
 {
-    return python_filter(1, f, bb, mode, readbytes);
+    return python_filter(1, f, bb, mode, block, readbytes);
 }
 
 
@@ -1216,7 +1217,7 @@
 static apr_status_t python_output_filter(ap_filter_t *f, 
 					 apr_bucket_brigade *bb)
 {
-    return python_filter(0, f, bb, 0, NULL);
+    return python_filter(0, f, bb, 0, 0, 0);
 }
 
 
Index: src/include/filterobject.h
===================================================================
RCS file: /cvsroot/modpython/mod_python/src/include/filterobject.h,v
retrieving revision 1.4
diff -u -r1.4 filterobject.h
--- src/include/filterobject.h	3 Jun 2002 14:31:16 -0000	1.4
+++ src/include/filterobject.h	9 Jul 2002 16:21:36 -0000
@@ -67,7 +67,7 @@
 
 	int is_input;
 	ap_input_mode_t mode;
-	apr_size_t *readbytes;
+	apr_size_t readbytes;
 
 	int closed;
 	int softspace;
@@ -88,7 +88,7 @@
     extern DL_IMPORT(PyObject *) 
 	MpFilter_FromFilter Py_PROTO((ap_filter_t *f, apr_bucket_brigade *bb_in, 
 				      int is_input, ap_input_mode_t mode, 
-				      apr_size_t *readbytes, char *hadler, char *dir));
+				      apr_size_t readbytes, char *hadler, char *dir));
 
 #ifdef __cplusplus
 }
From ps0 at igmp.com.ar  Wed Jul  3 19:20:51 2002
From: ps0 at igmp.com.ar (ps0@igmp.com.ar)
Date: Fri Jan  9 21:46:50 2004
Subject: [mod_python] Problems creating files from mod_python
In-Reply-To: <20020702194803.A27995@igmp.com.ar>; from ps0@igmp.com.ar on Tue, Jul 02, 2002 at 07:48:03PM -0300
References: <20020702194803.A27995@igmp.com.ar>
Message-ID: <20020703192051.A18568@igmp.com.ar>

On Tue, Jul 02, 2002 at 07:48:03PM -0300, ps0@igmp.com.ar wrote:

Tnks to all for your anwers , the problem was thread support on python
( crazy things ) . Now with phython compiled without thread support
everyting works fine.

Tnks again.

Regards

> Apache: 1.3.24
> mod_python: 2.7.8
> Python: 2.2 (w/threads) [i have to recompile it
> without threads]
> 
> 
> fd=open("/tmp/bleh.txt", "w")
> fd.write("HOLA\n")
> fd.close()
> 
> On the fd.close() it make this error:
> IOError: [Errno 9] Bad file Descriptor 
> 
> The file is created but i can't write on it.
> 
> 
> The perms are corectly applied, from a python script ( out of apache )
> the thinks work ok.
> 
> Sugestions apreciated.
> 
> Tnks in advance.
> 
> Hector.
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From vmilitaru at sympatico.ca  Wed Jul  3 18:40:33 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 21:46:50 2004
Subject: [mod_python] Tips and Tricks initiative
In-Reply-To: <20020703183427.M2452@sventech.com>; from johannes@erdfelt.com on Wed, Jul 03, 2002 at 06:34:27PM -0400
References: <20020703153239.A772@eye.neb> <20020703183427.M2452@sventech.com>
Message-ID: <20020703184033.A1017@eye.neb>

* Johannes Erdfelt <johannes@erdfelt.com> [020703 18:32]:

> While not the most appropriate name, why doesn't the FAQ work for you?
> 
> http://www.modpython.org/FAQ/faqw.py

Perhaps because until this very moment I was *totally* unaware of its existence.
Many thanks for the pointer.

Cheers, Vio

From vmilitaru at sympatico.ca  Thu Jul  4 13:53:02 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 21:46:51 2004
Subject: [mod_python] Chewing cookies
Message-ID: <20020704135302.A489@eye.neb>

'REQUEST.headers_out.add('Set-Cookie',cookie_value)' seems the recommended way to set up multiple cookies on the client. But what is the recommended way to get back at those cookies? Seems to me that anything like 'REQUEST.headers_in['Set-Cookie'] is no good with more than one cookie, for obvious reasons. Any suggestions?

Cheers, Vio

From vmilitaru at sympatico.ca  Thu Jul  4 15:01:52 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 21:46:51 2004
Subject: [mod_python] Chewing cookies
Message-ID: <20020704190152.RXBC18503.tomts10-srv.bellnexxia.net@eye.neb>

'REQUEST.headers_out.add('Set-Cookie',cookie_value)' seems the recommended way 
to set up multiple cookies on the client. 
But what is the recommended way to get back at those cookies? 
Seems to me that anything like 'REQUEST.headers_in['Set-Cookie'] is no good 
with more than one cookie, for obvious reasons. 
Any tips would be appreciated.

Cheers, Vio


From mateusz at ant.gliwice.pl  Mon Jul 22 11:02:42 2002
From: mateusz at ant.gliwice.pl (Mateusz Korniak)
Date: Fri Jan  9 21:46:51 2004
Subject: [mod_python] Chewing cookies
In-Reply-To: <20020704190152.RXBC18503.tomts10-srv.bellnexxia.net@eye.neb>
References: <20020704190152.RXBC18503.tomts10-srv.bellnexxia.net@eye.neb>
Message-ID: <200207220902.g6M92ss21416@eden.ispol.com>

> 'REQUEST.headers_out.add('Set-Cookie',cookie_value)' seems the recommended
> way to set up multiple cookies on the client.
> But what is the recommended way to get back at those cookies?
> Seems to me that anything like 'REQUEST.headers_in['Set-Cookie'] is no good
> with more than one cookie, for obvious reasons.
> Any tips would be appreciated.

This code works for me: (all cookies seems to be send via single Cookie 
header)
		self.cookies = abbon.html.Cookie.Cookie() # Cookie module downloaded from 
www.python.org as py < 2.0 didn't have Cookie module

		if self.raw_request.headers_in.has_key('Cookie'):
			self.cookies.load(self.raw_request.headers_in['Cookie'])

		if self.cookies.has_key(COOKIEUID):
			self.cookie_uid = str(self.cookies[COOKIEUID].value)

		if self.cookies.has_key(SES):
			self.cookie_ses = str(self.cookies[SES].value)


HIH ...
-- 
Mateusz Korniak


From matt at proweb.co.uk  Mon Jul 22 10:10:56 2002
From: matt at proweb.co.uk (matt)
Date: Fri Jan  9 21:46:51 2004
Subject: [mod_python] Chewing cookies
References: <20020704135302.A489@eye.neb>
Message-ID: <001901c2315f$b0f055f0$6501a8c0@KIKE>

----- Original Message -----
From: "vio" <vmilitaru@sympatico.ca>
To: <mod_python@modpython.org>
Sent: Thursday, July 04, 2002 7:53 PM
Subject: [mod_python] Chewing cookies


> 'REQUEST.headers_out.add('Set-Cookie',cookie_value)' seems the recommended
way to set up multiple cookies on the client. But what is the recommended
way to get back at those cookies? Seems to me that anything like
'REQUEST.headers_in['Set-Cookie'] is no good with more than one cookie, for
obvious reasons. Any suggestions?

cookies are sent to the server url encoded and semi-colon separated on one
line

Cookie: foo=f00%20foo; bar=bar34; bazz=%56;

# here's a noddy cookie cracker

import urllib

cookie_string = REQUEST.headers_in['Cookie']
# eg. cookie_string = 'foo=f00%20foo; bar=bar34; bazz=%37%38%58%58;'

cookies = {}

for cookie in cookiestring.split(";") :
    key_value = cookie.split("=")

 if len(key_value) == 2 :
    cookies[urllib.unquote(key_value[0].strip())] =
urllib.unquote(key_value[1].strip())
print cookies

# eg. outputs
# {'bazz': '78XX', 'foo': 'f00 foo', 'bar': 'bar34'}



# matt


From matt at proweb.co.uk  Tue Jul 23 11:45:56 2002
From: matt at proweb.co.uk (matt)
Date: Fri Jan  9 21:46:51 2004
Subject: [mod_python] Chewing cookies
References: <20020704135302.A489@eye.neb> <001901c2315f$b0f055f0$6501a8c0@KIKE> <20020722225119.B282@eye.neb>
Message-ID: <007f01c23236$221528b0$6501a8c0@KIKE>

Hi, presumably you wanted it to go to the list to so I've included your mail
below in full too

Rather than work out the answres to your questions directly I think it might
be better for you to go read the theory and practice of cookies

The official spec
http://wp.netscape.com/newsref/std/cookie_spec.html
(which is curiously marked as "Preliminary Specification - Use with
caution")
or
http://developer.netscape.com/docs/manuals/communicator/jsguide4/cookies.htm

working with cookies :
http://www.cookiecentral.com/faq/

settign the expiry to a past date will delete them


> Hi Matt,
> Thanks for the reply. (I must say, it's hard not to totally love python.)
> To recap, all cookies are sent by the client in a single header ('Cookie')
> semi-colon separated.
> So here's a couple of follow-up questions:
> * Any rules for the date format? Is something like
> 'expires=Wed, 03-Jul-2002 05:18:07 GMT; ' OK?
>
> * what's the procedure to get rid of a cookie?
> Netscape docs (or Mozilla, I forgot which one) seem to suggest that the
client
> doesn't get rid of the cookie. But I saw in some Zope code snipplet
(again,
> I forgot which module, maybe somewhere in ZPublisher/HTTPResponse), that
> the way Zope dumped old cookies was to send them with a passed date
> ('expires=1971' or something).
>
> Some related data on this topic I found of interest:
> * sending a cookie path ('path=/; ') is Mandatory,
> else Netscape|Lynx won't store the cookie (Explorer?);
> * domain must contain 2 dots minimum, like in 'domain=.foo.com;' (this
also
> found in Zope sources, but not yet tested on my own). Could someone
confirm?
>
> Cheers, Vio



From gharris at centauri.mb.ca  Wed Jul 24 01:38:25 2002
From: gharris at centauri.mb.ca (George Harrison)
Date: Fri Jan  9 21:46:51 2004
Subject: [mod_python] Installing mod_python on Win98/Apache
In-Reply-To: <D31B04F24EDE7644BB169BB4F080778A01F4C546@s30342g004005>
Message-ID: <5.1.0.14.2.20020724012731.00a16dc0@pop.mb.sympatico.ca>

I think that was probably it, but I reinstalled Python, which fixed the 
problem.

thanks

gh
At 11:48 AM 2002.07.19 -0400, you wrote:
>I found that mod_python uses the pythonpath and pythonhome environment
>variables. Make sure that your normal path environment variable can reach
>python.exe. A normal python install does not create these just the .py and
>.pyc associations. If you cannot run python from a command prompt by typing
>python and a .py script, something is wrong. Next, make sure you are using
>the right .so (.dll) with the correct corresponding Apache software version.
>
>Hans
>
>-----Original Message-----
>From: George Harrison [mailto:gharris@centauri.mb.ca]
>Sent: Friday, July 19, 2002 1:19 AM
>To: mod_python@modpython.org
>Subject: [mod_python] Installing mod_python on Win98/Apache
>
>
>After following the instructions in the documentation and copying the files
>from D:\Program Files\Python22\lib\mod_python-x\lib\mod_python to
>D:\Program Files\Python22\lib\mod_python;  I can launch Apache but when I
>try to open mptest.py I get the following message in the error log:
>
>[Thu Jul 18 23:50:19 2002] [error] [client 127.0.0.1] python_handler:
>make_obcallback returned no obCallBack!
>
>Does anyone know what is happening, or have a listing of where the files
>are supposed to be in the python directory for this to work?
>
>Thanks
>
>gh
>
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://www.modpython.org/mailman/listinfo/mod_python


From matt at proweb.co.uk  Thu Jul 25 15:48:55 2002
From: matt at proweb.co.uk (matt)
Date: Fri Jan  9 21:46:51 2004
Subject: [mod_python] postgres progress
Message-ID: <008c01c233ea$69e60000$6501a8c0@KIKE>

bah, I've just run into the same problem as someone else was having 



From matt at proweb.co.uk  Thu Jul 25 16:36:39 2002
From: matt at proweb.co.uk (matt)
Date: Fri Jan  9 21:46:51 2004
Subject: [mod_python] postgres progress
Message-ID: <009d01c233f1$153ed750$6501a8c0@KIKE>

bah, I've just run into the same problem as someone else was having getting
postgres to work with mod_python

http://www.modpython.org/pipermail/mod_python/2001-August/001589.html

pgdb
PyPgSQL
psycopg

all fail to import

this is on FreeBSD 4.4 with mod_python-2.7.6
python-2.2.1
postgresql-7.2.1_1

anyone with any clues ?

M




From imcmeans at telus.net  Thu Jul 25 15:46:57 2002
From: imcmeans at telus.net (Ian McMeans)
Date: Fri Jan  9 21:46:51 2004
Subject: [mod_python] compiling in windows
Message-ID: <003301c2342d$2f28c950$44cee8d8@cr536745a>

I'm running windows XP, python 2.2, apache 2.

I can't get mod_python to compile with VC++ 6. The project file is invalid,
so I make a new one from the .dsp. When I try to compile it, (it tries to
make an .exe) it gives an error about the version.rc file mentioning
MPV_BUILD, which I delete from the file to remove the error.

Then it complains about not having httpd.h, so I download the apache source,
and copy/paste the files from the apache source to the mod_python source.

Then it complains about apr.h, which doesn't exist in the apache source.
There is a apr.h.in, apr.h.hnw, apr.h.w, and test_apr.h. I pick apr.h.w and
rename it to apr.h, copy it to the include directory for mod_python.

I end up having to copy/paste a few different include directories, and
rename some more .hn files to .h, and I still get 715 errors, most of which
are like this:
include\apr_pools.h(191) : error C2061: syntax error : identifier
'apr_pool_initialize'

THere's also this error at the beginning:
Warning: cannot find "mod_python.dep"

Is there somewhere I can download the binary for windows? Or is there a
better way to
compile it in windows, like merging VC projects or something?


From vmilitaru at sympatico.ca  Fri Jul 26 01:49:03 2002
From: vmilitaru at sympatico.ca (vmilitaru@sympatico.ca)
Date: Fri Jan  9 21:46:51 2004
Subject: [mod_python] postgres progress
In-Reply-To: <009d01c233f1$153ed750$6501a8c0@KIKE>; from matt@proweb.co.uk on Thu, Jul 25, 2002 at 04:36:39PM +0100
References: <009d01c233f1$153ed750$6501a8c0@KIKE>
Message-ID: <20020726014902.A317@eye.neb>

If all else fails, you can always consider alternatives. 
One setup example (which does seem to work for couple months now):
* python 2.1
* apache 1.3.26
* mod_ssl 2.8.10
* mod_python 2.7.8
* DCOracle2 1.84 (python interface to Oracle)
* Oracle 8i
(All humming inside a Linux 2.4.2 without a glitch)

That is, of course, if you're not overly religious about postgres.
Cheers, Vio

* matt <matt@proweb.co.uk> [020726 01:20]:
> bah, I've just run into the same problem as someone else was having getting
> postgres to work with mod_python
> 
> http://www.modpython.org/pipermail/mod_python/2001-August/001589.html
> 
> pgdb
> PyPgSQL
> psycopg
> 
> all fail to import
> 
> this is on FreeBSD 4.4 with mod_python-2.7.6
> python-2.2.1
> postgresql-7.2.1_1
> 
> anyone with any clues ?
> 
> M
> 
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

From oliver at redgecko.org  Fri Jul 26 08:30:38 2002
From: oliver at redgecko.org (Oliver Cope)
Date: Fri Jan  9 21:46:51 2004
Subject: [mod_python] postgres progress
In-Reply-To: <009d01c233f1$153ed750$6501a8c0@KIKE>
References: <009d01c233f1$153ed750$6501a8c0@KIKE>
Message-ID: <20020726073038.GA1165@namib.redgecko.org>

On Thu, Jul 25, 2002 at 04:36:39PM +0100, matt wrote:
> bah, I've just run into the same problem as someone else was having getting
> postgres to work with mod_python
> 
> http://www.modpython.org/pipermail/mod_python/2001-August/001589.html
> 
> pgdb
> PyPgSQL
> psycopg
> 
> all fail to import
> 
Have you tried using the PyGreSQL which comes with PostgreSQL?

If you configure PostgreSQL with --with-python it will build and install 
PyGreSQL, and this seems quite stable for use with mod_python.

As I keep as non-threaded installation of Python for use with
mod_python separate from my main python installation, I had to modify
PATH to get PostgreSQL to install the module in the right place:

  % PATH=/opt/python2.1.2-nothreads/bin/:$PATH ./configure --with-python

(PostgreSQL 7.2, mod_python 2.7.6 and python 2.1.2 on OpenBSD 3.1)

Regards,

Olly.


From barr at cs.cornell.edu  Fri Jul  5 02:14:33 2002
From: barr at cs.cornell.edu (Rimon Barr)
Date: Fri Jan  9 21:46:51 2004
Subject: [mod_python] spyce v1.1.18
Message-ID: <Pine.LNX.4.44.0207050213320.12609-100000@pompom.u.cs.cornell.edu>

SPYCE - Server Python Pages

SPYCE is a drop-in Apache module that supports simple and efficient
Python-based dynamic HTML scripting. Those who like Python and are
familiar with JSP, or PHP, or ASP, should have a look at this engine. It
allows one to generate dynamic HTML content just as easily, using Python
for the dynamic parts. Its modular design makes it very flexible and
extensible. It can also be used as a command-line utility for HTML
pre-processing, and also via CGI or FCGI on other servers.

v1.1.18 released on 5 July 2002.

Get it at:
  http://spyce.sourceforge.net

----------
Partial change log:

v1.1.18
  fcgi support added
  X-Spyce header added
  documentation: how to write new modules

v1.1.17
  feature request - compaction algorithm improved

v1.1.16
  generalised session.setHandler (session handler selection mechanism)
  gdbm, bsd db session handlers added

v1.1.15
  minor makefile and rpm script changes
  handling of multi-line strings in python code
  response.flush() added

v1.1.14
  wrappers to check python version

v1.1.13
  added new language construct: "Python chunks"

v1.1.12
  stdout module redirects stdout to response object
  added writeln() to response module


From jack_diederich at email.com  Mon Jul 29 11:20:21 2002
From: jack_diederich at email.com (Jack Diederich)
Date: Fri Jan  9 21:46:51 2004
Subject: [mod_python] Fw: slow child init problems
Message-ID: <20020729162021.20546.qmail@email.com>

I tried sending this before I was a member of the list, and  I guess it wasn't approved...

I have a project running under mod_python with about 10k of python source.

On a pIII-500 it takes 2 seconds for the first request to an httpd process,
and 0.2 seconds for each request after that to run.  This isn't a show stopper
for now, but it really bugs me (the software will be production in about a month)

I've thought of switching to WebWare, which shouldn't have this problem, but is
otherwise more than I need and the switching costs would be non-zero.

The problem seems to be that the imports, even with the PythonImport directive listing all of them
aren't done until ChildInitHanlder(), which is called the first time a child process
gets its first hit, apparently.  I say apparently because the difference between
using PythonImport or not is zero time-wise.  Using .pyo files instead of .py
cuts the first-hit time in half, but is still five times
larger than the time to handle a second hit.

Why can't the work (whatever it is) be done _before_ the fork of the children?
This is what mod_perl does.  mod_php doesn't, it has some possibly intentional
design problems that require a fresh interperator init and byte compile between
requests (but there are hooks in the code for the $ work-aournd module).
But looking through the python internals I couldn't figure out why this isn't possible. I couldn't figure out where to patch it myself, but I didn't see any showstoppers like with php.

So ... anyone know how to work around this, why its done this way, or where I
should look to patch it?

thanks in advance,
-jackdied

-- 
__________________________________________________________
Sign-up for your own FREE Personalized E-mail at Mail.com
http://www.mail.com/?sr=signup

Get 4 DVDs for $.49 cents! plus shipping & processing. Click to join.
http://adfarm.mediaplex.com/ad/ck/990-1736-3566-59


From grisha at modpython.org  Mon Jul 29 21:36:14 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:51 2004
Subject: [mod_python] Fw: slow child init problems
In-Reply-To: <20020729162021.20546.qmail@email.com>
Message-ID: <Pine.BSF.4.32.0207292038430.25221-100000@localhost>

On Mon, 29 Jul 2002, Jack Diederich wrote:

> The problem seems to be that the imports, even with the PythonImport
> directive listing all of them aren't done until ChildInitHanlder(),
> which is called the first time a child process gets its first hit,
> apparently.  I say apparently because the difference between using
> PythonImport or not is zero time-wise.

[snip]

> Why can't the work (whatever it is) be done _before_ the fork of the
> children?

[snip]

First, you should look at making sure that everything runs under one
sub-interpreter. The information such as the name of the virtual host is
undefined until the actual request comes in, so PythonImport imports
everything under the interpreter named after the directory in the
surrounding <Directory> tag or the main interpreter. Your other code
probably runs in the subinterpreter for that virtual server, so it ends up
reimporting everything again. You can force everything to run under the
main interpreter by specifying "PythonInterpreter main_interpreter".

It's possible that you're right that ChildInit gets executed on the first
hit, I can't answer this off the top of my head without digging in apache
source code or experimenting. The reason PythonImport stuff does not get
executed at Apache startup before it forks is because at that point Apache
is run as root.

IMHO PythonImport is bad and shouldn't be there. I understand the issue,
but PythonImport isn't the cleanest solution to it because of the way it
ends up having be implemented, and I can't think of anything clever that
would address this.

One simple hack to tackle this problem is to add something into your
Apache startup script that initiates the first hit using wget or fetch or
lynx or whatever. I've used this technique very successfuly before.

Grisha


From jack_diederich at email.com  Mon Jul 29 23:24:42 2002
From: jack_diederich at email.com (Jack Diederich)
Date: Fri Jan  9 21:46:51 2004
Subject: [mod_python] How mod_perl does Imports vs mod_python
Message-ID: <20020730042442.7423.qmail@email.com>

Followup to my earlier post about slow init times.
mod_perl only has one interpreter.  It processes
imports as the last thing before leaving the apache
module init function (in mod_python, this would be
python_init())

If the main interpreter exists by the end of python_init()
[I think it does, but I don't know the interpreter internals
at all] we could at least populate that with the PythonImport
directives from httpd.conf

This wouldn't solve the problem for everyone (those using
virtual hosts) but it would at least solve mine :)
Optionally to support virtual hosts there could be a directive to prespawn sub-interpreters and process the 
import directives for those too.

Can any of the mod_python authors comment?  I might be
able to try my hand at a patch in a month, but for now 
I'll just stick with my workaround (ugly combination of a 
proxy and wget)

mod_perl also has a lot of logic to differentiate between a
stop/start and a restart.  In the restart case it actually
does the import _while_ reading the config.  In the fresh
start case it waits until the end of the init function.
I don't know if you can purge or overwrite import info in
a python interpreter like you can with perl. (perl just has
one big namespace plus smaller funciton/loop/etc variables).

Use of globals and macros to access them to keep track of
information about startup, pending imports, etc.

-jackdied


-- 
__________________________________________________________
Sign-up for your own FREE Personalized E-mail at Mail.com
http://www.mail.com/?sr=signup

Get 4 DVDs for $.49 cents! plus shipping & processing. Click to join.
http://adfarm.mediaplex.com/ad/ck/990-1736-3566-59


From peter.bittner at gmx.net  Tue Jul 30 18:54:48 2002
From: peter.bittner at gmx.net (Peter Bittner)
Date: Fri Jan  9 21:46:51 2004
Subject: [mod_python] Configuring Apache
Message-ID: <3055.1028048088@www55.gmx.net>

Hi,

I've got SuSE Linux 8.0, so there are probably the latest stable versions of
mod_python and Apache on my computer. Apache is installed with the
mod_python module (an appropriate message shows up, when the apache server ist
(re)started.)

However, since .py files are obviously not recognized as Python scripts I
have added the following lines to my httpd.conf file in the mime-types section:

    #
    # Python:
    #
    <IfModule mod_python.c>
    AddType application/x-httpd-python .py
    AddHandler python-program .py
    #PythonHandler index
    </IfModule>

Now it comes:
When I remove the comment-character in front of the "PythonHandler"
statement, the Apache server gives me a "500 Server Misconfiguration Error".

Can anyone help me getting .py-scripts running on my Apache?

Cheers, Peter

-- 
Peter Bittner
mobil: +43/(0)650/4151545
web: http://beam.to/peter.bittner - http://beam.to/htmlkurs
mail: peter.bittner@gmx.net

"Free software is like free speech, not free beer" (Richard Stallman)

GMX - Die Kommunikationsplattform im Internet.
http://www.gmx.net


From jack_diederich at email.com  Mon Jul 29 21:02:27 2002
From: jack_diederich at email.com (Jack Diederich)
Date: Fri Jan  9 21:46:51 2004
Subject: [mod_python] Fw: slow child init problems
Message-ID: <20020730020227.9604.qmail@email.com>

[me]
> > Why can't the work (whatever it is) be done _before_ the fork of the
> > children?

[Gregory Trubetskoy]
> First, you should look at making sure that everything runs under one
> sub-interpreter. The information such as the name of the virtual host is
> undefined until the actual request comes in, so PythonImport imports
> everything under the interpreter named after the directory in the
> surrounding <Directory> tag or the main interpreter. Your other code
> probably runs in the subinterpreter for that virtual server, so it ends up
> reimporting everything again. You can force everything to run under the
> main interpreter by specifying "PythonInterpreter main_interpreter".

I'm not running any virtual servers. I tried the directive
and it had the same behavior (first time a process gets
hit it takes 10 times the second and further hits)

> It's possible that you're right that ChildInit gets executed on the first
> hit, I can't answer this off the top of my head without digging in apache
> source code or experimenting. 

I've looked at the code, and it doesn't get called until the
first hit.  BTW, one thing I love about python (and
mod_python) is that the source is incredibly easy to browse
and understand (compare perl internals).

That said, I'm going to go swimming in perl/mod_perl for a
bit to see how they do it. Failing that, maybe I'll hit up
the mod_perl mailing list for help.

thanks,

-jackdied







-- 
__________________________________________________________
Sign-up for your own FREE Personalized E-mail at Mail.com
http://www.mail.com/?sr=signup

Get 4 DVDs for $.49 cents! plus shipping & processing. Click to join.
http://adfarm.mediaplex.com/ad/ck/990-1736-3566-59


From peter.bittner at gmx.net  Tue Jul 30 19:14:32 2002
From: peter.bittner at gmx.net (Peter Bittner)
Date: Fri Jan  9 21:46:51 2004
Subject: [mod_python] Re: Configuring Apache
Message-ID: <6296.1028049272@www55.gmx.net>

Hi,

I've probably found the reason why Apache shows a 500-error. The Apache
error log shows:

  make_obcallback(): could not import mod_python.apache.
  make_obcallback(): could not call init.

This because I tried to execute the following script (index.py):

  from mod_python import apache
  def handler(req):
        req.send_http_header()
        req.write("hello %s" % req.remote_host)
        return apache.OK

And when I run python from the commandline and try this:
  import mod_python
Python tells me it doesn't know any module named mod_python!

How do I fix this problem??

Peter


-- 
Peter Bittner
mobil: +43/(0)650/4151545
web: http://beam.to/peter.bittner - http://beam.to/htmlkurs
mail: peter.bittner@gmx.net

"Free software is like free speech, not free beer" (Richard Stallman)

GMX - Die Kommunikationsplattform im Internet.
http://www.gmx.net


From vmilitaru at sympatico.ca  Tue Jul 30 14:25:47 2002
From: vmilitaru at sympatico.ca (vmilitaru@sympatico.ca)
Date: Fri Jan  9 21:46:51 2004
Subject: [mod_python] Configuring Apache
In-Reply-To: <3055.1028048088@www55.gmx.net>; from peter.bittner@gmx.net on Tue, Jul 30, 2002 at 06:54:48PM +0200
References: <3055.1028048088@www55.gmx.net>
Message-ID: <20020730142546.A979@eye.neb>

Sounds like you haven't read the mod_python (excellent!) docs.
I suggest you start with that. FAQ has also useful tips for your next hurdles.
But the 'fast and dirty' answer to your question is:

PythonHandler publisher

but eventually (hopefully):

PythonHandler your_own_customized_publisher

Cheers,
Vio

* Peter Bittner <peter.bittner@gmx.net> [020730 14:15]:
> Hi,
> 
> I've got SuSE Linux 8.0, so there are probably the latest stable versions of
> mod_python and Apache on my computer. Apache is installed with the
> mod_python module (an appropriate message shows up, when the apache server ist
> (re)started.)
> 
> However, since .py files are obviously not recognized as Python scripts I
> have added the following lines to my httpd.conf file in the mime-types section:
> 
>     #
>     # Python:
>     #
>     <IfModule mod_python.c>
>     AddType application/x-httpd-python .py
>     AddHandler python-program .py
>     #PythonHandler index
>     </IfModule>
> 
> Now it comes:
> When I remove the comment-character in front of the "PythonHandler"
> statement, the Apache server gives me a "500 Server Misconfiguration Error".
> 
> Can anyone help me getting .py-scripts running on my Apache?
> 
> Cheers, Peter
> 
> -- 
> Peter Bittner
> mobil: +43/(0)650/4151545
> web: http://beam.to/peter.bittner - http://beam.to/htmlkurs
> mail: peter.bittner@gmx.net
> 
> "Free software is like free speech, not free beer" (Richard Stallman)
> 
> GMX - Die Kommunikationsplattform im Internet.
> http://www.gmx.net
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

From list-mod_python at empires.org  Tue Jul 30 13:35:34 2002
From: list-mod_python at empires.org (Jeff Davis)
Date: Fri Jan  9 21:46:51 2004
Subject: [mod_python] Configuring Apache
In-Reply-To: <3055.1028048088@www55.gmx.net>
References: <3055.1028048088@www55.gmx.net>
Message-ID: <200207301335.34801.list-mod_python@empires.org>

Here is my configuration information (note: I use the publisher handler, find 
out more about the different built-in handlers at http://www.modpython.org):

AddHandler python-program .py
PythonHandler mod_python.publisher
PythonDebug On

Regards,
	Jeff

On Tuesday 30 July 2002 09:54 am, Peter Bittner wrote:
> Hi,
>
> I've got SuSE Linux 8.0, so there are probably the latest stable versions
> of mod_python and Apache on my computer. Apache is installed with the
> mod_python module (an appropriate message shows up, when the apache server
> ist (re)started.)
>
> However, since .py files are obviously not recognized as Python scripts I
> have added the following lines to my httpd.conf file in the mime-types
> section:
>
>     #
>     # Python:
>     #
>     <IfModule mod_python.c>
>     AddType application/x-httpd-python .py
>     AddHandler python-program .py
>     #PythonHandler index
>     </IfModule>
>
> Now it comes:
> When I remove the comment-character in front of the "PythonHandler"
> statement, the Apache server gives me a "500 Server Misconfiguration
> Error".
>
> Can anyone help me getting .py-scripts running on my Apache?
>
> Cheers, Peter


From peter.bittner at gmx.net  Wed Jul 31 17:40:53 2002
From: peter.bittner at gmx.net (Peter Bittner)
Date: Fri Jan  9 21:46:51 2004
Subject: [mod_python] make_obcallback(): could not import mod_python.apache
References: <200207301335.34801.list-mod_python@empires.org>
Message-ID: <28386.1028130053@www30.gmx.net>

I have mod_python installed on SuSE Linux 8.0 and I have set up my
httpd.conf according to the mod_python documentation, but unfortunately I get the
following error message in my error log:

make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.

I have also tried the import statement in my python interpreter, but it
says:

>>> from mod_python import apache
Traceback (most recent call last):
  File "<stdin>", line 1, in ?
ImportError: No module named mod_python

So there seems to be no mod_python module available! (Where has it gone? -
This doesn't seem to be an ordinary error, does it?) I havn't found any answer
ind the FAQs regarding this problem.

Please help!
Peter


-- 
Peter Bittner
mobil: +43/(0)650/4151545
web: http://beam.to/peter.bittner - http://beam.to/htmlkurs
mail: peter.bittner@gmx.net

"Free software is like free speech, not free beer" (Richard Stallman)

GMX - Die Kommunikationsplattform im Internet.
http://www.gmx.net


From christoph at cocon-seide.com  Wed Jul 31 17:51:45 2002
From: christoph at cocon-seide.com (Christoph Fritzsch)
Date: Fri Jan  9 21:46:51 2004
Subject: [mod_python] Configuring Apache
Message-ID: <200207311554.g6VFsWs48906@eden.ispol.com>

Hi Peter,

I tried it with Suse 7.3 some time ago and found it only workable by 

1) uncommenting all <Ifmodule python>  </if..>

#<IfDefine Python>
LoadModule python_module      /usr/lib/apache/mod_python.so
#</IfDefine>
#<IfDefine Python>
AddModule mod_python.c
#</IfDefine>

so the module is loaded for sure, as I couldnt get it to work with the Suse supplied 
starting parameters

2) Then I put this in there

#Python
#<IfModule mod_python.c>
<Directory "/usr/local/httpd/htdocs/test">
AddHandler python-program .py
PythonHandler mptest
PythonDebug On
</Directory>
#</IfModule>

as you did it

and  I also had to put in a  link 
/usr/lib/python2.1/site-packages/mod_python 
->/usr/lib/apache/lib/python2.1/site-packages/mod_python/

maybe you hv to replace the 2.1 to 2.2

reload apache and any file you call in the test directory will execute the mptest program

This is what the mod_python should do. That is as far as I got. I think next step is to 
expand the mptest program so you can call subroutines in it which presumaly do more 
usefull stuff than "Hello World!" !!

BR Christoph


From daniel at copyleft.no  Sun Jul 14 10:53:01 2002
From: daniel at copyleft.no (Hr. Daniel Mikkelsen)
Date: Fri Jan  9 21:46:52 2004
Subject: [mod_python] Understanding mod_python
In-Reply-To: <1026635587.26526.30.camel@kernel>
Message-ID: <20020714105239.O43368-100000@unity.copyleft.no>

On 14 Jul 2002, Fabian Fagerholm wrote:

> There were also some posts about a mod_python "cookbook", and another
> poster suggested the on-line FAQ would be a good place for the
> "recipes". I totally agree - well-written example code is the best way
> to learn.
> I'd like to suggest that a new category be created in the FAQ for these
> snippets of example code.

Make it a wiki.

-- Daniel


From fabbe at paniq.net  Sun Jul 14 20:34:01 2002
From: fabbe at paniq.net (Fabian Fagerholm)
Date: Fri Jan  9 21:46:52 2004
Subject: [mod_python] Understanding mod_python
In-Reply-To: <290A467D-9742-11D6-9B12-0030653DCC28@attbi.com>
References: <290A467D-9742-11D6-9B12-0030653DCC28@attbi.com>
Message-ID: <1026668042.1616.3.camel@kernel>

On Sun, 2002-07-14 at 18:55, Jeff Stearns wrote:
> Fabian -
> 
> I'd like to review your drawings, but it's not easy for me to view 
> Postscript.  This is probably true for other folks as well.  If you can 
> offer them in another, more generic format, you may get a better 
> response.

Oh, I'm sorry. I thought Postscript was a good format for most people. I
suppose that's a un*x thing, though.

I made PDF versions of the files as well. They're all in
http://www.paniq.net/fabbe/mod_python/

I hope more people can look at the drawings now. Thanks for the
feedback, Jeff!

Cheers,
fabian

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 240 bytes
Desc: This is a digitally signed message part
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20020714/5b977028/attachment.bin
From vmilitaru at sympatico.ca  Sun Jul 14 13:55:37 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 21:46:52 2004
Subject: [mod_python] Ping?
In-Reply-To: <Pine.LNX.4.44.0207131250410.31967-100000@slippy.wire.rat>; from gbenson@redhat.com on Sat, Jul 13, 2002 at 12:51:32PM +0100
References: <Pine.LNX.4.44.0207131250410.31967-100000@slippy.wire.rat>
Message-ID: <20020714135537.A278@eye.neb>

Same here. But even more problematic seems that some messages never make it to 
the list (at least some of my messages never did).
Possible solution (provided this message make it to the list): how about 
migrating modpython to 'sourceforge'? It's totally
free and they do an outstanding hosting job.

Chers,
Vio

* Gary Benson <gbenson@redhat.com> [020714 13:45]:
> 
> It seems that I am getting messages from this list with a four day lag. 
> Is anyone else experiencing this?
> 
> Cheers,
> Gary
> 
> [ gbenson@redhat.com ][ GnuPG 85A8F78B ][ http://inauspicious.org/ ]
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

From kastner.j at supp.cz  Mon Jul 15 09:27:14 2002
From: kastner.j at supp.cz (=?iso-8859-2?Q?Ji=F8=ED_Kastner?=)
Date: Fri Jan  9 21:46:52 2004
Subject: [mod_python] compiled code execution
Message-ID: <003301c22bd1$0ac2e820$0301a8c0@pentium>

i'm interested about possibility to execute .pyc code by adding line to
httpd.conf:

AddHandler python-program .pyc

or if this is nonsense, because python is executing it directly, if is .pyc
present?
why? i'm writing web app. and this one will be distributed to others and i
need eliminate changing code by anybody (some distributions will be running
on win9x).

have anybody experience with this kind of problems?

jiri kastner




From gbenson at redhat.com  Mon Jul 15 10:17:02 2002
From: gbenson at redhat.com (Gary Benson)
Date: Fri Jan  9 21:46:52 2004
Subject: [mod_python] [PATCH] last httpd-2.0.36
Message-ID: <Pine.LNX.4.44.0207151016390.12912-200000@slippy.wire.rat>


Hi,

The attached patch brings the input filtering API in mod_python into line 
with that in httpd-2.0.36.  This is the last thing that I know of that 
needed fixing to work with 2.0.36, although I beleive some more fixes will 
be in order to build against 2.0.39 or whatever it is now :)

Cheers,
Gary

[ gbenson@redhat.com ][ GnuPG 85A8F78B ][ http://inauspicious.org/ ]
-------------- next part --------------
Bring input filter API in line with 2.0.36

Index: src/filterobject.c
===================================================================
RCS file: /cvsroot/modpython/mod_python/src/filterobject.c,v
retrieving revision 1.5
diff -u -r1.5 filterobject.c
--- src/filterobject.c	3 Jun 2002 14:31:15 -0000	1.5
+++ src/filterobject.c	9 Jul 2002 16:21:27 -0000
@@ -61,7 +61,7 @@
  */
 
 PyObject *MpFilter_FromFilter(ap_filter_t *f, apr_bucket_brigade *bb, int is_input,
-			      ap_input_mode_t mode, apr_size_t *readbytes,
+			      ap_input_mode_t mode, apr_size_t readbytes,
 			      char * handler, char *dir)
 {
     filterobject *result;
@@ -86,7 +86,7 @@
 	result->bb_in = bb;
 	result->bb_out = NULL;
 	result->mode = 0;
-	result->readbytes = NULL;
+	result->readbytes = 0;
     }
 
     result->closed = 0;
@@ -142,7 +142,7 @@
 
 	Py_BEGIN_ALLOW_THREADS;
 	self->rc = ap_get_brigade(self->f->next, self->bb_in, self->mode, 
-				  APR_BLOCK_READ, *self->readbytes);
+				  APR_BLOCK_READ, self->readbytes);
 	Py_END_ALLOW_THREADS;
 
 	if (! APR_STATUS_IS_SUCCESS(self->rc)) {
@@ -239,7 +239,7 @@
 
 		Py_BEGIN_ALLOW_THREADS;
 		self->rc = ap_get_brigade(self->f->next, self->bb_in, self->mode, 
-					  APR_BLOCK_READ, *self->readbytes);
+					  APR_BLOCK_READ, self->readbytes);
 		Py_END_ALLOW_THREADS;
 
 		if (! APR_STATUS_IS_SUCCESS(self->rc)) {
Index: src/mod_python.c
===================================================================
RCS file: /cvsroot/modpython/mod_python/src/mod_python.c,v
retrieving revision 1.60
diff -u -r1.60 mod_python.c
--- src/mod_python.c	3 Jun 2002 14:31:15 -0000	1.60
+++ src/mod_python.c	9 Jul 2002 16:21:35 -0000
@@ -1023,7 +1023,8 @@
 static apr_status_t python_filter(int is_input, ap_filter_t *f, 
 				  apr_bucket_brigade *bb,
 				  ap_input_mode_t mode,
-				  apr_size_t *readbytes) {
+				  apr_read_type_e block,
+				  apr_size_t readbytes) {
 
     PyObject *resultobject = NULL;
     interpreterdata *idata;
@@ -1052,8 +1053,7 @@
        so a fitler can spit out an error without causing infinite loop */
     if (ctx->transparent) {
 	if (is_input) 
-	    return ap_get_brigade(f->next, bb, mode, APR_BLOCK_READ, 
-				  *readbytes);
+	    return ap_get_brigade(f->next, bb, mode, block, readbytes);
 	else
 	    return ap_pass_brigade(f->next, bb);
     }
@@ -1201,9 +1201,10 @@
 static apr_status_t python_input_filter(ap_filter_t *f, 
 					apr_bucket_brigade *bb,
 					ap_input_mode_t mode,
-					apr_size_t *readbytes) 
+					apr_read_type_e block,
+					apr_off_t readbytes)
 {
-    return python_filter(1, f, bb, mode, readbytes);
+    return python_filter(1, f, bb, mode, block, readbytes);
 }
 
 
@@ -1216,7 +1217,7 @@
 static apr_status_t python_output_filter(ap_filter_t *f, 
 					 apr_bucket_brigade *bb)
 {
-    return python_filter(0, f, bb, 0, NULL);
+    return python_filter(0, f, bb, 0, 0, 0);
 }
 
 
Index: src/include/filterobject.h
===================================================================
RCS file: /cvsroot/modpython/mod_python/src/include/filterobject.h,v
retrieving revision 1.4
diff -u -r1.4 filterobject.h
--- src/include/filterobject.h	3 Jun 2002 14:31:16 -0000	1.4
+++ src/include/filterobject.h	9 Jul 2002 16:21:36 -0000
@@ -67,7 +67,7 @@
 
 	int is_input;
 	ap_input_mode_t mode;
-	apr_size_t *readbytes;
+	apr_size_t readbytes;
 
 	int closed;
 	int softspace;
@@ -88,7 +88,7 @@
     extern DL_IMPORT(PyObject *) 
 	MpFilter_FromFilter Py_PROTO((ap_filter_t *f, apr_bucket_brigade *bb_in, 
 				      int is_input, ap_input_mode_t mode, 
-				      apr_size_t *readbytes, char *hadler, char *dir));
+				      apr_size_t readbytes, char *hadler, char *dir));
 
 #ifdef __cplusplus
 }
From nicks at metrolink.com  Mon Jul 15 13:19:15 2002
From: nicks at metrolink.com (Nick Seidenman)
Date: Fri Jan  9 21:46:52 2004
Subject: [mod_python] typehandler
Message-ID: <3D330413.9090203@metrolink.com>

Anyone got a quick example of how this one's used?    When I try 
something simple, like:

    def typehandler (req):
        req.content_type = 'text/plain'
        req.send_http_headers ()
        return apache.OK

I just get a listing of the module that contains this.

TiA,
Nick


From rien at yeepa.org  Fri Jul 26 00:12:44 2002
From: rien at yeepa.org (Adrien Plisson)
Date: Fri Jan  9 21:46:52 2004
Subject: [mod_python] please, old fool needs help with getting apache mod_python on windows 98 to run
References: <NDBBIADKLJIPFGPECIJPOELOCMAA.jdaily@kc.rr.com>
Message-ID: <001201c23428$67399b80$03020101@skynet.be>

From: "james daily" <jdaily@kc.rr.com>
>
> the mod_python online manual at:
>
http://www.modpython.org/live/mod_python-2.7.8/doc-html/app-wininst.html
>
> says:
> XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
...
> if someone has it actually running on their windows 98 system,
> could you please send me the ***relevant*** portions from your
> apache httpd.conf file?
>
> i have tried numerous different approaches to no avail.

ok  i posted something about the windows portion of the doc in march of this
year.
take a look at:
http://www.modpython.org/pipermail/mod_python/2002-March/001934.html
at the end of the post there is my correction to the manual, tested on
apache for NT.

now about having just the mptest.py text in your browser there was another
post in the mailing list... don't remember when, probably in april or june.
try to browse it.

> alas, i am a programmer but not (yet) an apache guru.

time will come...

> any help would be greatly appreciated.

done

--
rien



From list-mod_python at empires.org  Tue Jul 16 13:38:19 2002
From: list-mod_python at empires.org (Jeff Davis)
Date: Fri Jan  9 21:46:52 2004
Subject: [mod_python] new to mod_python, with a question.
In-Reply-To: <1026773181.12028.7.camel@locutus>
References: <1026773181.12028.7.camel@locutus>
Message-ID: <200207161338.19702.list-mod_python@empires.org>

Is is possible that you're using the publisher handler? The publisher handler 
basically does a req.write() on whatever is returned by your function. So, it 
looks like it's printing the actual text of apache.OK after all of your 
req.write()s. Look in your apache config for possible use of 
mod_python.publisher, or perhaps something else that might print the return 
of your function.

Regards,
	Jeff

On Monday 15 July 2002 03:46 pm, Bill Anderson wrote:
> OK, so here is what I am doing. I am using PageTemplates (from zope) and
> mod_python. or at least, I am trying to. :)
>
>
> if I do _NOT_ use the request object (i.e. I return a fully formed html
> string/document), it works fine. but of course, that means no use of
> mod-python's request objects functions such as cookie/header
> construction, usage, etc.
>
> To wit:
> def sayit(req,x=12):
> 	if not x:
> 		return "I need x"
> 	if not master:
> 		return "I need a master object"
> 	pt=PageTemplate()
> 	filestring =
> "".join(open("/home/ucntcme/public_html/pythonapps/test.pt").readlines())
> 	pt.write(filestring)
> 	myx=int(x)
>         req.content_type="text/html"
>         req.send_http_headers()
> 	req.write( pt(x=myx,master=master) )
> 	return apache.OK
>
> returns my rendered template, but at the bottom has:
>
> HTTP/1.1 200 OK Date: Mon, 15 Jul 2002 22:44:27 GMT Server:
> Apache/1.3.22 (Unix) (Red-Hat/Linux) mod_python/2.7.8 Python/2.2.1
> mod_ssl/2.8.5 OpenSSL/0.9.6b DAV/1.0.2 PHP/4.0.6 mod_perl/1.26
> Connection: close Transfer-Encoding: chunked Content-Type: text/html;
> charset=iso-8859-1
> OK
> The server encountered an internal error or misconfiguration and was
> unable to complete your request.
>
>
>
> Debug is on, and there are no mesages in the error_log.
>
> Now, if I just return the content using return (content), it works fine.
>
> Why is this/what am I doing wrong here?
>
> Cheers, Bill
>
>
>
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From bill at immosys.com  Tue Jul 16 17:41:41 2002
From: bill at immosys.com (Bill Anderson)
Date: Fri Jan  9 21:46:52 2004
Subject: [mod_python] new to mod_python, with a question.
In-Reply-To: <200207161338.19702.list-mod_python@empires.org>
References: <1026773181.12028.7.camel@locutus> 
	<200207161338.19702.list-mod_python@empires.org>
Message-ID: <1026862902.17401.28.camel@locutus>

On Tue, 2002-07-16 at 14:38, Jeff Davis wrote:
> Is is possible that you're using the publisher handler? The publisher handler 

Yes, I am ...

> basically does a req.write() on whatever is returned by your function. So, it 
> looks like it's printing the actual text of apache.OK after all of your 
> req.write()s. Look in your apache config for possible use of 

Ah, I see. Ok. So now that I know why...

How can I have a funtion that writes all the HTML, and still use
mod_python's cookie functions? can I use them, even though I return
html, instead of the req.writes() and return apache.OK combo?





From tree at basistech.com  Tue Jul 16 22:01:46 2002
From: tree at basistech.com (Tom Emerson)
Date: Fri Jan  9 21:46:52 2004
Subject: [mod_python] freebsd
In-Reply-To: <F1478v6eoHvEmsgTFsF000136d0@hotmail.com>
References: <F1478v6eoHvEmsgTFsF000136d0@hotmail.com>
Message-ID: <15668.53258.78331.46765@magrathea.basistech.com>

Edgar Castanedo writes:
> I have installed Python on FreeBSD from the ports collection. When I
> try and install mod_python (from the ports collection also), a
> message is returned which states that Python needs to be installed
> WITHOUT threads. I am not sure if this is okay since I write lots of
> Python script and don't know how this will affect Pythons
> performance. Can anyone shed some light on this for me as I do not
> want to disable threads if it means that my scripts will not work
> the way they used to.

Unless you are explicitly using threads in your existing Python
scripts, don't worry about. I would not expect the performance to
degrade too much, if at all.

On some systems (e.g., Linux) you can run mod_python with a threaded
Python interpreter without a hitch. Unfortunately if you want to use
mod_python on FreeBSD you'll need to rebuild your Python distribution.

    -tree


-- 
Tom Emerson                                          Basis Technology Corp.
Sr. Computational Linguist                         http://www.basistech.com
  "Beware the lollipop of mediocrity: lick it once and you suck forever"

From gharris at centauri.mb.ca  Wed Jul 17 02:46:24 2002
From: gharris at centauri.mb.ca (George Harrison)
Date: Fri Jan  9 21:46:52 2004
Subject: [mod_python] Installing mod_python on Win98/Apache
Message-ID: <5.1.0.14.2.20020717020135.01dd78a0@pop.mts.net>

After following the instructions in the documentation and copying the files 
from C:\Program Files\Python\lib\mod_python-x\lib\mod_python to C:\Program 
Files\Python\lib\mod_python; when I launch Apache I get the message:

Syntax error on line 194 of c:/program piles/apache 
group/apache/conf/httpd.conf:

Cannot load module
c:/program files/apache group/apache/modules/mod_python.dll
into server: (1157) One of the library files needed to run
this application cannot be found.

line 194 consists of "LoadModule python_module modules/mod_python.dll"
I have added the line "AddModule mod_python.c" after the ClearModuleList 
Directive, but the program doesn't seem to be getting that far in httpd.conf.

Does anyone know what I'm doing wrong?

Thanks

gh


From gharris at centauri.mb.ca  Fri Jul 19 00:30:54 2002
From: gharris at centauri.mb.ca (George Harrison)
Date: Fri Jan  9 21:46:52 2004
Subject: [mod_python] Test, please ignore
Message-ID: <5.1.0.14.2.20020719003018.027ccb90@pop.mb.sympatico.ca>

test


From mark.evans.b at bayer.com  Fri Jul 19 09:59:41 2002
From: mark.evans.b at bayer.com (Mark Evans)
Date: Fri Jan  9 21:46:53 2004
Subject: [mod_python] mod_python and W2K
Message-ID: <200207191657.g6JGvHs84445@eden.ispol.com>

Hi All,

I know this general issue has come up before and I have tried everything I have
found in the archives, but nothing works.  So please bear with me.  I am trying
to get mod_python to run on W2K.  Apache is installed as a service.  My system
configuration is this:

W2K SP2
Apache 1.3.24
Python 2.1.3
mod_python-2.7.6

Environment variables:
path contains  C:\Python21\;
PYTHONPATH = C:\Program Files\Apache Group\Apache\htdocs\python  (this was added
per an archive post, doesn't work with or without it)

From gerard.patel at nerim.net  Mon Jul  1 23:43:06 2002
From: gerard.patel at nerim.net (Gerard Patel)
Date: Fri Jan  9 21:52:54 2004
Subject: [mod_python] Apache 2.0.39 and publisher
Message-ID: <1.5.4.32.20020701214306.417866e0@pop.nerim.net>

Hello,

First thing first : I'm a rank beginner with Apache *and* Python :-)

I want to learn both and am trying to setup a very small web site
to test.
I am giving mod_python a try, with Apache 2.0.39, mod_python
from CVS, Python 2.2

Hum, a little question : docu states that Python should be compiled
with no threading support, however in the code I see a 
WITH_THREAD flag, is this restriction still valid for current
CVS ? It seems to work, but my testing is somewhat 
limited for now.

Now, the problems :

First problem : mod_python does not compile

fix :

--- requestobject.c.orig        Mon Jun  3 16:31:15 2002
+++ requestobject.c     Sun Jun 30 11:05:05 2002
@@ -743,7 +743,6 @@
     {"bytes_sent",         T_LONG,      OFF(bytes_sent),           RO},
     {"mtime",              T_LONG,      OFF(mtime),                RO},
     {"chunked",            T_INT,       OFF(chunked),              RO},
-    {"boundary",           T_STRING,    OFF(boundary),             RO},
     {"range",              T_STRING,    OFF(range),                RO},
     {"clength",            T_LONG,      OFF(clength),              RO},
     {"remaining",          T_LONG,      OFF(remaining),            RO},

The Apache guys removed this field from the last version I downloaded
(the aborted 2.0.37) and 2.0.39. Strange.


Second problem : the publisher.

I test it with a minimal app that just displays the one field of
my page :

def Bouton1(req, TextField1):

    s = TextField1
    return s

It works fine, but if I reload the form immediately after, it does
not work unless I wait about 15 seconds.

Fix :
--- apache.py.orig      Wed Apr 10 23:24:24 2002
+++ apache.py   Mon Jul  1 23:21:25 2002
@@ -399,8 +399,9 @@

         # but is it in the path?
         file = module.__dict__.get("__file__")
-        if not file or (path and not file in path):
-                raise SERVER_RETURN, HTTP_NOT_FOUND
+       pathfile, filefile = os.path.split(file)
+        if not file or (path and not pathfile in path):
+               raise SERVER_RETURN, HTTP_NOT_FOUND

         if autoreload:
             oldmtime = module.__dict__.get("__mtime__", 0)

I suspect that this is not elegant Python or even correct, 
please remember that I have written a grand total of about 
300 lines of Python so far.

Anyway, with the change it seems to work better at least.

Thanks for your comments, I am ready to try any
better ideas that you want me to test, and sorry
if I have just misconfigured the beast; I have read
the archive a bit and seen something similar
to my second problem, but no solution AFAICT.


Gerard Patel


From mateusz at ant.gliwice.pl  Wed Jul  3 00:57:10 2002
From: mateusz at ant.gliwice.pl (Mateusz Korniak)
Date: Fri Jan  9 21:52:54 2004
Subject: [mod_python] How to make 307 Temporary Redirect using mod_python ?
Message-ID: <200207022257.g62MvFs10490@eden.ispol.com>

I can't make temporary redirect using mod_python.

I tried code:

def handler(req):
	# some code genereting url - where to redirect
	req.headers_out["Location"] = url
	req.send_http_header()
	return apache.HTTP_TEMPORARY_REDIRECT

but it produces such (not as intended) HTTP talk:

browser:
GET /abbon/advsel/advsel.py?a=1;u=388 HTTP/1.1
Connection: Keep-Alive
User-Agent: Mozilla/5.0 (compatible; Konqueror/2.2-11; Linux)
Pragma: no-cache
Cache-control: no-cache
Accept: text/*, image/jpeg, image/png, image/*, */*
Accept-Encoding: x-gzip, gzip, identity
Accept-Charset: iso-8859-2, utf-8, *
Accept-Language: en_GB, pl_PL, en
Host: appserver.ant.cipe
Cookie: SES=1

server response:
HTTP/1.1 200 OK
Date: Tue, 02 Jul 2002 21:14:01 GMT
Server: Apache/1.3.23 (Unix)  (Red-Hat/Linux) mod_python/2.7.8 Python/1.5.2
Location: http://www.noblisci.bnet.pl
Connection: close
Transfer-Encoding: chunked
Content-Type: text/plain

21c
HTTP/1.1 200 OK
Date: Tue, 02 Jul 2002 21:14:01 GMT
Server: Apache/1.3.23 (Unix)  (Red-Hat/Linux) mod_python/2.7.8 Python/1.5.2
Location: http://www.noblisci.bnet.pl
Connection: close
Transfer-Encoding: chunked
Content-Type: text/html; charset=iso-8859-1

<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<HTML><HEAD>
<TITLE>200 OK</TITLE>
</HEAD><BODY>
<H1>OK</H1>
The document has moved <A HREF="http://www.noblisci.bnet.pl">here</A>.<P>
<HR>
<ADDRESS>Apache/1.3.23 Server at appserver.ant.cipe Port 80</ADDRESS>
</BODY></HTML>


Server returns HTTP/1.1 200 OK instead of 307 <whatever> ...
What I'm doing wrong ?
TIA for any help.

-- 
Mateusz Korniak


From ps0 at igmp.com.ar  Tue Jul  2 19:48:03 2002
From: ps0 at igmp.com.ar (ps0@igmp.com.ar)
Date: Fri Jan  9 21:52:54 2004
Subject: [mod_python] Problems creating files from mod_python
Message-ID: <20020702194803.A27995@igmp.com.ar>

Apache: 1.3.24
mod_python: 2.7.8
Python: 2.2 (w/threads) [i have to recompile it
without threads]


fd=open("/tmp/bleh.txt", "w")
fd.write("HOLA\n")
fd.close()

On the fd.close() it make this error:
IOError: [Errno 9] Bad file Descriptor 

The file is created but i can't write on it.


The perms are corectly applied, from a python script ( out of apache )
the thinks work ok.

Sugestions apreciated.

Tnks in advance.

Hector.

From peter at webreply.com  Tue Jul  2 19:21:37 2002
From: peter at webreply.com (Peter McA'Nulty)
Date: Fri Jan  9 21:52:54 2004
Subject: [mod_python] How to make 307 Temporary Redirect using mod_python ?
References: <200207022257.g62MvFs10490@eden.ispol.com>
Message-ID: <000701c2221f$36f8a2b0$0201a8c0@Peter8100>

before you call req.send_http_header(), you have to set the req.status
field:
req.status = HTTP_TEMPORARY_REDIRECT

peter

----- Original Message -----
From: "Mateusz Korniak" <mateusz@ant.gliwice.pl>
To: <mod_python@modpython.org>
Sent: Tuesday, July 02, 2002 6:57 PM
Subject: [mod_python] How to make 307 Temporary Redirect using mod_python ?


> I can't make temporary redirect using mod_python.
>
> I tried code:
>
> def handler(req):
> # some code genereting url - where to redirect
> req.headers_out["Location"] = url
> req.send_http_header()
> return apache.HTTP_TEMPORARY_REDIRECT
>
> but it produces such (not as intended) HTTP talk:
>
> browser:
> GET /abbon/advsel/advsel.py?a=1;u=388 HTTP/1.1
> Connection: Keep-Alive
> User-Agent: Mozilla/5.0 (compatible; Konqueror/2.2-11; Linux)
> Pragma: no-cache
> Cache-control: no-cache
> Accept: text/*, image/jpeg, image/png, image/*, */*
> Accept-Encoding: x-gzip, gzip, identity
> Accept-Charset: iso-8859-2, utf-8, *
> Accept-Language: en_GB, pl_PL, en
> Host: appserver.ant.cipe
> Cookie: SES=1
>
> server response:
> HTTP/1.1 200 OK
> Date: Tue, 02 Jul 2002 21:14:01 GMT
> Server: Apache/1.3.23 (Unix)  (Red-Hat/Linux) mod_python/2.7.8
Python/1.5.2
> Location: http://www.noblisci.bnet.pl
> Connection: close
> Transfer-Encoding: chunked
> Content-Type: text/plain
>
> 21c
> HTTP/1.1 200 OK
> Date: Tue, 02 Jul 2002 21:14:01 GMT
> Server: Apache/1.3.23 (Unix)  (Red-Hat/Linux) mod_python/2.7.8
Python/1.5.2
> Location: http://www.noblisci.bnet.pl
> Connection: close
> Transfer-Encoding: chunked
> Content-Type: text/html; charset=iso-8859-1
>
> <!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
> <HTML><HEAD>
> <TITLE>200 OK</TITLE>
> </HEAD><BODY>
> <H1>OK</H1>
> The document has moved <A HREF="http://www.noblisci.bnet.pl">here</A>.<P>
> <HR>
> <ADDRESS>Apache/1.3.23 Server at appserver.ant.cipe Port 80</ADDRESS>
> </BODY></HTML>
>
>
> Server returns HTTP/1.1 200 OK instead of 307 <whatever> ...
> What I'm doing wrong ?
> TIA for any help.
>
> --
> Mateusz Korniak
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>



From pk1u at yahoo.com  Tue Jul  2 19:33:07 2002
From: pk1u at yahoo.com (Praveen Kumar)
Date: Fri Jan  9 21:52:54 2004
Subject: [mod_python] shared object files
Message-ID: <20020703023307.85661.qmail@web10403.mail.yahoo.com>

How do I make mod_python aware of the location of
shared object files ?

My system consists of rh7.2, apache1.3.26,
mod_python-2.7.8, python2.1.3


Eg, I'm trying to use the DCOracle2 db module; it uses
Oracle's libclntsh.so.9.0 ; I see the following when
my program accesses the DCOracle2 module:

  File
"/usr/lib/python2.1/site-packages/DCOracle2/__init__.py",
line 37, in ?
    from DCOracle2 import   *

  File
"/usr/lib/python2.1/site-packages/DCOracle2/DCOracle2.py",
line 104, in ?
    import dco2

ImportError: libclntsh.so.9.0: cannot open shared
object file: No such file or directory



I've tried the following:

Placed libclntsh.so.9.0 in /oralib and:

Placed /oralib in the PythonPath directive:

eg; httpd.conf:

<Directory /usr/local/apache/htdocs>
    AddHandler python-program .py
    PythonPath "sys.path+[ ...., '/oralib']"
    PythonHandler reqhandler
    PythonDebug On 
</Directory>

--

set LD_LIBRARY_PATH from the same shell where I start
apache:

export LD_LIBRARY_PATH=/oralib

--

Placed libclntsh.so.9.0 in
/usr/lib/python2.1/site-packages/DCOracle2 .

None of these work. The DCOracle2 module works fine
when I use it from a standalone program. Any
suggestions would be greatly appreciated.

pk


__________________________________________________
Do You Yahoo!?
Sign up for SBC Yahoo! Dial - First Month Free
http://sbc.yahoo.com

From lisicky at datis.cdrail.cz  Wed Jul  3 09:22:38 2002
From: lisicky at datis.cdrail.cz (Jiri Lisicky)
Date: Fri Jan  9 21:52:54 2004
Subject: [mod_python] Problems creating files from mod_python
In-Reply-To: <20020702194803.A27995@igmp.com.ar>
References: <20020702194803.A27995@igmp.com.ar>
Message-ID: <ch95ius9pgmdhso3cnuc6fv6m034o12p8j@4ax.com>

On Tue, 2 Jul 2002 19:48:03 -0300, you wrote:

>Apache: 1.3.24
>mod_python: 2.7.8
>Python: 2.2 (w/threads) [i have to recompile it
>without threads]
>
>
>fd=open("/tmp/bleh.txt", "w")
>fd.write("HOLA\n")
>fd.close()
>
>On the fd.close() it make this error:
>IOError: [Errno 9] Bad file Descriptor 
>
>The file is created but i can't write on it.
>
>
>The perms are corectly applied, from a python script ( out of apache )
>the thinks work ok.
>
>Sugestions apreciated.
Exists file /tmp/bleh.txt before running script from mod_python? 
Maybe you create this file by generic python script under your
username. When call it under mod_python, it is under apache account =
permission problem.
--
        Ji?? Lisick?                      ?D KM?P Olomouc
e-mail: lisicky@datis.cdrail.cz           V?de?sk? 15
 phone: +420-068-578-2272                 Olomouc, Czech Republic
              >>> ?e?tina ISO-8859-2 Compatible <<<

From R.Barrett at ftel.co.uk  Wed Jul  3 10:00:19 2002
From: R.Barrett at ftel.co.uk (Richard Barrett)
Date: Fri Jan  9 21:52:54 2004
Subject: [mod_python] Zope
In-Reply-To: <20010830170753.B23002@godel>
Message-ID: <5.1.0.14.2.20020703095730.00b08148@pop.ftel.co.uk>

At 17:07 30/08/2001 +0200, riesch@nieuw.nl wrote:
>Hi there,
>
>
>Off-topic as it is :
>
>Has anyone experience with using zope and more specificaly with its 
>database ? Is it possible to separate the database from the 
>zope-architecture ? I can't figure out how .. but it would be usefull 
>since it looks nice
>
>
>Thanks ahead,
>Richard

You want http://www.amk.ca/zodb/ and http://www.zope.org/Products/StandaloneZODB


From s_lott at yahoo.com  Wed Jul  3 03:56:37 2002
From: s_lott at yahoo.com (Steven Lott)
Date: Fri Jan  9 21:52:54 2004
Subject: [mod_python] Zope
In-Reply-To: <5.1.0.14.2.20020703095730.00b08148@pop.ftel.co.uk>
Message-ID: <20020703105637.12600.qmail@web9606.mail.yahoo.com>

The ZOPE (Z Object Persistence Environment) Object database
(ZODB), once known as BOBOBase, is available as a separate
download from ZOPE.org.

http://www.python.org/workshops/2000-01/proceedings/papers/fulton/zodb3.html

http://www.python.org/topics/database/persistence.html

http://www.zope.org/Members/michel/HowTos/ZODB-How-To

--- Richard Barrett <R.Barrett@ftel.co.uk> wrote:
> At 17:07 30/08/2001 +0200, riesch@nieuw.nl wrote:
> >Hi there,
> >
> >
> >Off-topic as it is :
> >
> >Has anyone experience with using zope and more specificaly
> with its 
> >database ? Is it possible to separate the database from the 
> >zope-architecture ? I can't figure out how .. but it would be
> usefull 
> >since it looks nice
> >
> >
> >Thanks ahead,
> >Richard
> 
> You want http://www.amk.ca/zodb/ and
> http://www.zope.org/Products/StandaloneZODB
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


=====
--
S. Lott, CCP :-{)
S_LOTT@YAHOO.COM
http://www.mindspring.com/~slott1
Buccaneer #468: KaDiMa

Macintosh user: drinking upstream from the herd.

__________________________________________________
Do You Yahoo!?
Yahoo! - Official partner of 2002 FIFA World Cup
http://fifaworldcup.yahoo.com

From lawrence_jesse at yahoo.ca  Wed Jul  3 08:24:55 2002
From: lawrence_jesse at yahoo.ca (Jesse Lawrence)
Date: Fri Jan  9 21:52:54 2004
Subject: [mod_python] make problems
Message-ID: <20020703122455.30604.qmail@web11303.mail.yahoo.com>

Hello everyone,

I've tried finding an answer to this in the mailing
list archive, but haven't been successful. I run the
following:

./configure --with-apxs=/usr/sbin/apxs 

and it seems to be fine, but when I run make dso or
just make, I get the following message:

[jalaw@soniceast mod_python-2.7.8]# make dso
make[1]: Entering directory
`/home/jalaw/mod_python-2.7.8/src'
gcc  -I/home/jalaw/mod_python-2.7.8/src/include
-I/usr/include/apache -I/usr/include/python2.1    -c
-o mod_python.o mod_python.c
In file included from mod_python.c:54:
/home/jalaw/mod_python-2.7.8/src/include/mod_python.h:77:20:
Python.h: No such file or directory
/home/jalaw/mod_python-2.7.8/src/include/mod_python.h:78:26:
structmember.h: No
such file or directory
make[1]: *** [mod_python.o] Error 1
make[1]: Leaving directory
`/home/jalaw/mod_python-2.7.8/src'
make: *** [do_dso] Error 2

Can anyone please tell me what is happening here?  Any
help will be greatly appreciated.

Thank you,

Jesse Lawrence

______________________________________________________________________ 
Post your ad for free now! http://personals.yahoo.ca

From fuf at mobil.cz  Wed Jul  3 14:31:23 2002
From: fuf at mobil.cz (Michal Vitecek)
Date: Fri Jan  9 21:52:54 2004
Subject: [mod_python] make problems
In-Reply-To: <20020703122455.30604.qmail@web11303.mail.yahoo.com>
References: <20020703122455.30604.qmail@web11303.mail.yahoo.com>
Message-ID: <20020703123123.GJ28418@diana.mobil.cz>

 you're missing the python header files. most probably because you are on
 some system with package system and haven't installed the appropriate
 package. for RH this could be python-devel-something.

Jesse Lawrence wrote:
>Hello everyone,
>
>I've tried finding an answer to this in the mailing
>list archive, but haven't been successful. I run the
>following:
>
>./configure --with-apxs=/usr/sbin/apxs 
>
>and it seems to be fine, but when I run make dso or
>just make, I get the following message:
>
>[jalaw@soniceast mod_python-2.7.8]# make dso
>make[1]: Entering directory
>`/home/jalaw/mod_python-2.7.8/src'
>gcc  -I/home/jalaw/mod_python-2.7.8/src/include
>-I/usr/include/apache -I/usr/include/python2.1    -c
>-o mod_python.o mod_python.c
>In file included from mod_python.c:54:
>/home/jalaw/mod_python-2.7.8/src/include/mod_python.h:77:20:
>Python.h: No such file or directory
>/home/jalaw/mod_python-2.7.8/src/include/mod_python.h:78:26:
>structmember.h: No
>such file or directory
>make[1]: *** [mod_python.o] Error 1
>make[1]: Leaving directory
>`/home/jalaw/mod_python-2.7.8/src'
>make: *** [do_dso] Error 2
>
>Can anyone please tell me what is happening here?  Any
>help will be greatly appreciated.
>
>Thank you,
>
>Jesse Lawrence
>
>______________________________________________________________________ 
>Post your ad for free now! http://personals.yahoo.ca
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://www.modpython.org/mailman/listinfo/mod_python

-- 
		fuf		(fuf@mobil.cz)

From clee at spiralis.merseine.nu  Wed Jul  3 07:52:00 2002
From: clee at spiralis.merseine.nu (clee@spiralis.merseine.nu)
Date: Fri Jan  9 21:52:54 2004
Subject: [mod_python] make problems
In-Reply-To: <20020703122455.30604.qmail@web11303.mail.yahoo.com>
References: <20020703122455.30604.qmail@web11303.mail.yahoo.com>
Message-ID: <15650.62320.759265.205900@spiralis.merseine.nu>

>>>>> "Jesse" == Jesse Lawrence <lawrence_jesse@yahoo.ca> writes:

    Jesse> Hello everyone, I've tried finding an answer to this in the
    Jesse> mailing list archive, but haven't been successful. I run
    Jesse> the following:

    Jesse> ./configure --with-apxs=/usr/sbin/apxs

On my linux system, I need to specify where the python source
distribution is.  For example:

  ./configure  --with-apxs=/usr/sbin/apxs --with-python=/usr/local/src/Python-2.1.3


From lawrence_jesse at yahoo.ca  Wed Jul  3 09:58:15 2002
From: lawrence_jesse at yahoo.ca (Jesse Lawrence)
Date: Fri Jan  9 21:52:54 2004
Subject: [mod_python] make problems
In-Reply-To: <20020703123123.GJ28418@diana.mobil.cz>
Message-ID: <20020703135815.41942.qmail@web11303.mail.yahoo.com>

Thanks a lot for the pointer.  It did the trick.  Now
I'm having problems with my apache configuration. 
I've got the AddModule and 
LoadModule ok, but I'm a little confused as to the
proper way to set up the AddHandler and PythonHandler,
the documentation seems a little hazy on this point. 
Any help will be greatly appreciated,
Thanks,
Jesse

--- Michal Vitecek <fuf@mobil.cz> wrote:
>  you're missing the python header files. most
> probably because you are on
>  some system with package system and haven't
> installed the appropriate
>  package. for RH this could be
> python-devel-something.
> 
> Jesse Lawrence wrote:
> >Hello everyone,
> >
> >I've tried finding an answer to this in the mailing
> >list archive, but haven't been successful. I run
> the
> >following:
> >
> >./configure --with-apxs=/usr/sbin/apxs 
> >
> >and it seems to be fine, but when I run make dso or
> >just make, I get the following message:
> >
> >[jalaw@soniceast mod_python-2.7.8]# make dso
> >make[1]: Entering directory
> >`/home/jalaw/mod_python-2.7.8/src'
> >gcc  -I/home/jalaw/mod_python-2.7.8/src/include
> >-I/usr/include/apache -I/usr/include/python2.1   
> -c
> >-o mod_python.o mod_python.c
> >In file included from mod_python.c:54:
>
>/home/jalaw/mod_python-2.7.8/src/include/mod_python.h:77:20:
> >Python.h: No such file or directory
>
>/home/jalaw/mod_python-2.7.8/src/include/mod_python.h:78:26:
> >structmember.h: No
> >such file or directory
> >make[1]: *** [mod_python.o] Error 1
> >make[1]: Leaving directory
> >`/home/jalaw/mod_python-2.7.8/src'
> >make: *** [do_dso] Error 2
> >
> >Can anyone please tell me what is happening here? 
> Any
> >help will be greatly appreciated.
> >
> >Thank you,
> >
> >Jesse Lawrence
> >
>
>______________________________________________________________________
> 
> >Post your ad for free now!
> http://personals.yahoo.ca
> >_______________________________________________
> >Mod_python mailing list
> >Mod_python@modpython.org
>
>http://www.modpython.org/mailman/listinfo/mod_python
> 
> -- 
> 		fuf		(fuf@mobil.cz)
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


______________________________________________________________________ 
Post your ad for free now! http://personals.yahoo.ca

From ps0 at igmp.com.ar  Wed Jul  3 11:35:08 2002
From: ps0 at igmp.com.ar (ps0@igmp.com.ar)
Date: Fri Jan  9 21:52:55 2004
Subject: [mod_python] Problems creating files from mod_python
In-Reply-To: <ch95ius9pgmdhso3cnuc6fv6m034o12p8j@4ax.com>; from lisicky@datis.cdrail.cz on Wed, Jul 03, 2002 at 09:22:38AM +0200
References: <20020702194803.A27995@igmp.com.ar> <ch95ius9pgmdhso3cnuc6fv6m034o12p8j@4ax.com>
Message-ID: <20020703113508.A11838@igmp.com.ar>

On Wed, Jul 03, 2002 at 09:22:38AM +0200, Jiri Lisicky wrote:
> On Tue, 2 Jul 2002 19:48:03 -0300, you wrote:
> 
> >Apache: 1.3.24
> >mod_python: 2.7.8
> >Python: 2.2 (w/threads) [i have to recompile it
> >without threads]
> >
> >
> >fd=open("/tmp/bleh.txt", "w")
> >fd.write("HOLA\n")
> >fd.close()
> >
> >On the fd.close() it make this error:
> >IOError: [Errno 9] Bad file Descriptor 
> >
> >The file is created but i can't write on it.
> >
> >
> >The perms are corectly applied, from a python script ( out of apache )
> >the thinks work ok.
> >
> >Sugestions apreciated.
> Exists file /tmp/bleh.txt before running script from mod_python? 
> Maybe you create this file by generic python script under your
> username. When call it under mod_python, it is under apache account =
> permission problem.
> --
>         Ji?? Lisick?                      ?D KM?P Olomouc
> e-mail: lisicky@datis.cdrail.cz           V?de?sk? 15
>  phone: +420-068-578-2272                 Olomouc, Czech Republic
>               >>> ?e?tina ISO-8859-2 Compatible <<<
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

no , the file doesn't exist before running the script in mod_python, i
aready check that.

Regards

From gerard.patel at nerim.net  Wed Jul  3 17:42:14 2002
From: gerard.patel at nerim.net (Gerard Patel)
Date: Fri Jan  9 21:52:55 2004
Subject: [mod_python] Problems creating files from mod_python
Message-ID: <1.5.4.32.20020703154214.4178bebc@pop.nerim.net>

At 11:35 AM 7/3/02 -0300, you wrote:

(...)
>> >On the fd.close() it make this error:
>> >IOError: [Errno 9] Bad file Descriptor 
>> >
>> >The file is created but i can't write on it.
>> >
>> >
>> >The perms are corectly applied, from a python script ( out of apache )
>> >the thinks work ok.
>
>
>no , the file doesn't exist before running the script in mod_python, i
>aready check that.

Maybe you could check by hand if the apache user has
the correct rights ? Here is what I would do in the same
situation - on my system Apache runs as nobody :

su
<enter root password>

su nobody

try to create a file; if it fails, the user has no rights and it's
a system configuration question.

Hope this helps

Gerard Patel



From vmilitaru at sympatico.ca  Wed Jul  3 15:32:39 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 21:52:55 2004
Subject: [mod_python] Tips and Tricks initiative
Message-ID: <20020703153239.A772@eye.neb>

Hello,
Inspired by Apache's excellent "URL Rewriting Guide" (http://httpd.apache.org/docs/misc/rewriteguide.html), I would like to suggest that the mod_python maintainers compile a similar document, focussed exclusively on short, practical tricks and tips documenting how mod_python can help to solve some typical problems. This would, to some extent, cut off on redundant posts to the list, as well as help spread knowledge from the more experienced to the more 'mod_python challenged' (like myself). There is no better selling argument for mod_python than a few well written lines of 'mod_python' code ...

An example of a possible entry to the 'mod_python Tips&Tricks' list:


Generic Redirect

Description:
  problem description blah blah ... In this example: basically simulating mod_rewrite in mod_python.

Solution:
  additional blah blah explaining how we are going to brilliantly solve that mind boggling problem in 2 lines of code ...

  def handler(REQUEST):
    # some code generating our url goes here

    url = 'http://www.yahoo.com' # an example url to test the redirect code
    REQUEST.headers_out["Location"] = url
    REQUEST.status = 302
    REQUEST.send_http_header()


For instance, I'd be very interested to read in such a tricks and tips list how to avoid the overhead of creating a database connection at each call to 'handler'. And so on.

Cheers, Vio

From vmilitaru at sympatico.ca  Wed Jul  3 16:10:32 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 21:52:55 2004
Subject: [mod_python] Tips and Tricks initiative ... some followup contribution
Message-ID: <20020703161032.A828@eye.neb>

Generic Cookies

Description:
  How do we bake cookies in mod_python?

Solution:
  def handler(REQUEST):
    header_key = 'Set-Cookie'
    # set cookie values
    for header_value in (
'MyCookie1Var=homepop-shown=1; expires=Wed, 03-Jul-2002 05:18:07 GMT; path=/; domain=zzzz;', 
'MyCookie2Var=homepop-shown=0; expires=Wed, 03-Jul-2002 05:18:07 GMT; path=/; domain=zzzz;',
'MyCookieN=homepop-shown=0; expires=Wed, 03-Jul-2002 05:18:07 GMT; path=/; domain=zzzz;'
    ):
      REQUEST.headers_out.add(header_key,header_value)

    # set additional header arguments here

    # send header to client
    REQUEST.send_http_header()
    return apache.OK

From vmilitaru at sympatico.ca  Wed Jul  3 16:37:49 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 21:52:55 2004
Subject: [mod_python] Tips and Tricks initiative ... some followup contribution /3
Message-ID: <20020703163749.A873@eye.neb>

Already reaching the bottom of my mod_python tricks basket:


REQUEST Attributes Made Easy

Description:
  How can I see all REQUEST's attributes in one swoop.

Solution:
  (one amongst many, I believe)

  def handler(REQUEST):
      # set headers
      REQUEST.content_type = "text/html"
      REQUEST.send_http_header()

      # list all REQUEST's attributes
      REQUEST.write('<HTML><BODY>\n\n')
      for item in dir(REQUEST):
              exec('x = REQUEST.' + str(item))
              REQUEST.write('REQUEST.' + str(item) + ' = ' + str(x))
              REQUEST.write('\n\n<BR>\n\n')

      REQUEST.write('\n\n</BODY></HTML>\n')
      return apache.OK

I hope some may find these little code snipplets useful. I guess other tips&tricks are similarly welcome.

Cheers, Vio

From alain at onesite.org  Wed Jul  3 22:49:47 2002
From: alain at onesite.org (Alain Tesio)
Date: Fri Jan  9 21:52:55 2004
Subject: [mod_python] Tips and Tricks initiative
In-Reply-To: <20020703153239.A772@eye.neb>
References: <20020703153239.A772@eye.neb>
Message-ID: <20020703224947.403225e9.alain@onesite.org>

On Wed, 3 Jul 2002 15:32:39 -0500
vio <vmilitaru@sympatico.ca> wrote:

Technically a wiki is nice for public contributions :
http://moin.sourceforge.net/

> For instance, I'd be very interested to read in such a tricks and tips list how to avoid the
> overhead of creating a database connection at each call to 'handler'. And so on.

Just make the connection a global variable.

Alain


From dustin at ywlcs.org  Wed Jul  3 16:01:39 2002
From: dustin at ywlcs.org (Dustin Mitchell)
Date: Fri Jan  9 21:52:55 2004
Subject: [mod_python] Tips and Tricks initiative ... some followup contribution /3
In-Reply-To: <20020703163749.A873@eye.neb>
References: <20020703163749.A873@eye.neb>
Message-ID: <20020703210138.GQ9517@eleanor.internal.ywlcs.org>

On Wed, Jul 03, 2002 at 04:37:49PM -0500, vio wrote:
> Already reaching the bottom of my mod_python tricks basket:
> 
> 
> REQUEST Attributes Made Easy
> 
> Description:
>   How can I see all REQUEST's attributes in one swoop.
> 
> Solution:
>   (one amongst many, I believe)
> 
>   def handler(REQUEST):
>       # set headers
>       REQUEST.content_type = "text/html"
>       REQUEST.send_http_header()
> 
>       # list all REQUEST's attributes
>       REQUEST.write('<HTML><BODY>\n\n')
>       for item in dir(REQUEST):
>               exec('x = REQUEST.' + str(item))
>               REQUEST.write('REQUEST.' + str(item) + ' = ' + str(x))
>               REQUEST.write('\n\n<BR>\n\n')
 let's avoid 'exec'; how about
                x = getattr(REQUEST, item)
                REQUEST.write('REQUEST.%s = %s\n\n<br>\n\n' % item, `x`)
> 
>       REQUEST.write('\n\n</BODY></HTML>\n')
>       return apache.OK

-- 

  Dustin Mitchell
  dustin@ywlcs.org
  http://people.cs.uchicago.edu/~dustin/

From vmilitaru at sympatico.ca  Wed Jul  3 17:38:49 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 21:52:55 2004
Subject: [mod_python] Tips and Tricks initiative
In-Reply-To: <20020703224947.403225e9.alain@onesite.org>; from alain@onesite.org on Wed, Jul 03, 2002 at 10:49:47PM +0200
References: <20020703153239.A772@eye.neb> <20020703224947.403225e9.alain@onesite.org>
Message-ID: <20020703173849.A937@eye.neb>

* Alain Tesio <alain@onesite.org> [020703 17:11]:

> > For instance, I'd be very interested to read in such a tricks and tips list how to avoid the
> > overhead of creating a database connection at each call to 'handler'. And so on.
> 
> Just make the connection a global variable.

I think I tried that, initialized the db connection at the module level. But somehow my cursor got corrupted, or something. I forgot oracle's error number, only that my workaround was to do something like (we're at module level here):

db = DCOracle2.connect(my_login_string)
def get_db_cursor():
    "create database connection"
    cursor = db.cursor() # Allocate a cursor
    return cursor

In fact I see that I am re-using the same connection here, so let me re-phrase my initial question: how do I re-use the same *cursor* (or it this a bad idea in the first place). I wonder what would happen in such a multi-threaded environment (well, I'm saling in Linuxland) where multiple httpd instances will hit on the db server (ora8i in my case) with the same cursor *concurrently* (never got to that point of desperation, though - but just from contemplating such possibility sounds like total anarchy). What I did try but eventually got an error on was to re-use the same cursor sequentially (in a non-threaded application).

Cheers, Vio

From alain at onesite.org  Thu Jul  4 00:06:08 2002
From: alain at onesite.org (Alain Tesio)
Date: Fri Jan  9 21:52:55 2004
Subject: [mod_python] Tips and Tricks initiative
In-Reply-To: <20020703173849.A937@eye.neb>
References: <20020703153239.A772@eye.neb>
	<20020703224947.403225e9.alain@onesite.org>
	<20020703173849.A937@eye.neb>
Message-ID: <20020704000608.5bf2dea3.alain@onesite.org>

On Wed, 3 Jul 2002 17:38:49 -0500
vio <vmilitaru@sympatico.ca> wrote:

> In fact I see that I am re-using the same connection here, so let me re-phrase my initial
> question: how do I re-use the same *cursor* (or it this a bad idea in the first place).

I think a cursor is not designed to be re-used, what I usually do with cursors is:

- open it
- execute a query
- fetch the rows
- close and remove it (manually with del)

Maybe I'm wrong and a closed cursor can be reopened, I have no idea what
ressources it takes just to create it.

If this works and you want to do it, it can't be shared by two users, you can
use a pool of reusable cursors in a global variable, with a correct lock handling
to make sure you don't get the same cursor from the pool for two users.

Alain

From barr at cs.cornell.edu  Sun Jul  7 19:32:18 2002
From: barr at cs.cornell.edu (Rimon Barr)
Date: Fri Jan  9 21:52:55 2004
Subject: [mod_python] spyce v1.1.22
Message-ID: <Pine.LNX.4.44.0207071930240.8857-100000@pompom.u.cs.cornell.edu>

Most important changes since last posting (v1.1.18)
 - easier install; .rpm should work on more systems
 - does not rely on mod_python by default... too hard to get right
   automatically, and users don't get to play with Spyce
 - downgraded some code to run on Python v2.1.1 and up.
   (requires nested scoping, so can't go further than that)
 - removed use of Python threads
 - new filter module
 - improved installation documentation, and explained how modules work
... and lots more.

Spyce still works under mod_python. To get it to work, you'll need a
properly running mod_python, and then just to comment and uncomment a few
lines in your httpd.conf. See:
  http://spyce.sourceforge.net/download.html#modpython

----------
SPYCE - Server Python Pages

SPYCE is a webserver plugin that supports simple and efficient
Python-based dynamic HTML scripting. Those who like Python and are
familiar with JSP, or PHP, or ASP, should have a look at this engine. It
allows one to generate dynamic HTML content just as easily, using Python
for the dynamic parts. Its modular design makes it very flexible and
extensible. It supports FastCGI, CGI and mod_python to plugin into Apache
and most other webservers. It can also be used as a command-line utility
for HTML pre-processing.

v1.1.22 released on 7 July 2002.

Get it at:
  http://spyce.sourceforge.net

----------
Partial change log:

v1.1.22
  fixed Python v2.1.1-related bugs.
  improved installation process and documentation
  rpm more likely to succeed - uses fcgi or drops back to cgi
  no longer mod_python based by default

v1.1.21 (faulty release)
  stochastic session clean up; no more threading dependency
  documentation: better installation notes
  peep-hole optimizer

v1.1.20 (faulty release)
  created explicit (swappable) cache infrastructure
  BUG ** Spyce also works on Python v2.1
  request - request.post(),post1() works in includes
  documentation: cheetah install, ...

v1.1.19
  filter module

v1.1.18
  fcgi support added
  X-Spyce header added
  documentation: how to write new modules

v1.1.17
  feature request - compaction algorithm improved
...

Enjoy,
Rimon.
-- 
 * Rimon Barr       Ph.D. candidate, Computer Science, Cornell University
 | barr@cs.cornell.edu - http://www.cs.cornell.edu/barr - Y!IM: batripler
 |
 | Understanding is a kind of ecstasy.
 +----                                   -- Carl Sagan



From johannes at erdfelt.com  Wed Jul  3 18:34:27 2002
From: johannes at erdfelt.com (Johannes Erdfelt)
Date: Fri Jan  9 21:52:55 2004
Subject: [mod_python] Tips and Tricks initiative
In-Reply-To: <20020703153239.A772@eye.neb>; from vmilitaru@sympatico.ca on Wed, Jul 03, 2002 at 03:32:39PM -0500
References: <20020703153239.A772@eye.neb>
Message-ID: <20020703183427.M2452@sventech.com>

On Wed, Jul 03, 2002, vio <vmilitaru@sympatico.ca> wrote:
> Hello,
> Inspired by Apache's excellent "URL Rewriting Guide" (http://httpd.apache.org/docs/misc/rewriteguide.html), I would like to suggest that the mod_python maintainers compile a similar document, focussed exclusively on short, practical tricks and tips documenting how mod_python can help to solve some typical problems. This would, to some extent, cut off on redundant posts to the list, as well as help spread knowledge from the more experienced to the more 'mod_python challenged' (like myself). There is no better selling argument for mod_python than a few well written lines of 'mod_python' code ...

While not the most appropriate name, why doesn't the FAQ work for you?

http://www.modpython.org/FAQ/faqw.py

> For instance, I'd be very interested to read in such a tricks and tips list how to avoid the overhead of creating a database connection at each call to 'handler'. And so on.

http://www.modpython.org/FAQ/faqw.py?req=all#3.3

JE


From bob at redivi.com  Wed Jul  3 18:36:04 2002
From: bob at redivi.com (Bob Ippolito)
Date: Fri Jan  9 21:52:55 2004
Subject: [mod_python] Tips and Tricks initiative
In-Reply-To: <20020703173849.A937@eye.neb>
Message-ID: <4207FDD5-8ED5-11D6-9214-0003938210D6@redivi.com>

It depends on the particular db module, some modules have threadsafe 
database instances, some don't.  Some have threadsafe database cursors, 
and some don't.  Read the docs.  If it's DBAPI compliant, check its 
thread safe level.  I have never used anything that's thread safe level 
3, most are level 2 or 1 in my experience.

from http://www.python.org/topics/database/DatabaseAPI-2.0.html
threadsafety
Integer constant stating the level of thread safety the interface 
supports. Possible values are:
0	= Threads may not share the module.
1	= Threads may share the module, but not connections.
2	= Threads may share the module and connections.
3	= Threads may share the module, connections and cursors.

Sharing in the above context means that two threads may use a resource 
without wrapping it using a mutex semaphore to implement resource 
locking. Note that you cannot always make external resources thread safe 
bymanaging access using a mutex: the resource may rely on global 
variables or other external sources that are beyond your control.

-bob

On Wednesday, July 3, 2002, at 06:38 PM, vio wrote:

> * Alain Tesio <alain@onesite.org> [020703 17:11]:
>
>>> For instance, I'd be very interested to read in such a tricks and 
>>> tips list how to avoid the
>>> overhead of creating a database connection at each call to 'handler'. 
>>> And so on.
>>
>> Just make the connection a global variable.
>
> I think I tried that, initialized the db connection at the module 
> level. But somehow my cursor got corrupted, or something. I forgot 
> oracle's error number, only that my workaround was to do something like 
> (we're at module level here):
>
> db = DCOracle2.connect(my_login_string)
> def get_db_cursor():
>     "create database connection"
>     cursor = db.cursor() # Allocate a cursor
>     return cursor
>
> In fact I see that I am re-using the same connection here, so let me 
> re-phrase my initial question: how do I re-use the same *cursor* (or it 
> this a bad idea in the first place). I wonder what would happen in such 
> a multi-threaded environment (well, I'm saling in Linuxland) where 
> multiple httpd instances will hit on the db server (ora8i in my case) 
> with the same cursor *concurrently* (never got to that point of 
> desperation, though - but just from contemplating such possibility 
> sounds like total anarchy). What I did try but eventually got an error 
> on was to re-use the same cursor sequentially (in a non-threaded 
> application).
>
> Cheers, Vio
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From pk1u at yahoo.com  Mon Jul  8 17:10:12 2002
From: pk1u at yahoo.com (Praveen Kumar)
Date: Fri Jan  9 21:52:55 2004
Subject: [mod_python] DCOracle2 w/ apache + mod_python under rh7.2 ?
Message-ID: <20020709001012.18211.qmail@web10403.mail.yahoo.com>

Same problem I posted last week; I've tried a few more
things ( described below ). Is anyone running this
config ?

Any suggestions on how I can go about debugging this
would be appreciated.

> Has anyone successfully used DCOracle2 w/ apache +
> mod_python under rh7.2 ?
> 
> My system consists of rh7.2, apache1.3.26,
> mod_python-2.7.8, python2.1.3, Oracle9i .
> 
> I see the following when my program accesses the
> DCOracle2 module:
> 
>   File
>
"/usr/lib/python2.1/site-packages/DCOracle2/__init__.py",
> line 37, in ?
>     from DCOracle2 import   *
> 
>   File
>
"/usr/lib/python2.1/site-packages/DCOracle2/DCOracle2.py",
> line 104, in ?
>     import dco2
> 
> ImportError: libclntsh.so.9.0: cannot open shared
> object file: No such file or directory
> 
> 
> 
> I've tried the following:
> 
> -----
> 
> Setting LD_LIBRARY_PATH from the same shell where I
> start apache:
> 
> export LD_LIBRARY_PATH=/home/pk/OraHome1/lib
> 
> -----
> 
> Setting LD_LIBRARY_PATH to /home/pk/OraHome1/lib via
> Apache's PassEnv and SetEnv directives.
> 
> -----
> 
> Placed libclntsh.so.9.0 in
> /usr/lib/python2.1/site-packages/DCOracle2 ( same
> path
> as dco2.so ).
> 
> -----
> 
> Added /home/pk/OraHome1/lib to /etc/ld.so.conf , and
> executed /sbin/ldconfig as root.
> 
> -----
> 
> Tried adding each of:
> 
> os.putenv( 'LD_LIBRARY_PATH',
> '/home/pk/OraHome1/lib'
> )
> 
> os.environ[ 'LD_LIBRARY_PATH' ] =
> '/home/pk/OraHome1/lib'
> 
> in DCOracle2/DCOracle2.py before the "import dco2"
> statement
> 
> -----
> 
> /home/pk/OraHome1/lib is readable by all ; but tried
> the following anyway, to eliminate a
> permissions-issue
> as the cause:
> 
> As root, copied /home/pk/OraHome1/lib to /oralib ;
> tried all of the above, using /oralib
> 
> -----
> 
> "/home/pk/OraHome1/lib/libclntsh.so.9.0" exists, yet
> none of these work. The DCOracle2 module works fine
> when I use it from a standalone program. It would be
> helpful to know if anyone has gotten this config to
> work; also, any suggestions would be appreciated.
> 
> pk
> 
> 
> __________________________________________________
> Do You Yahoo!?
> Sign up for SBC Yahoo! Dial - First Month Free
> http://sbc.yahoo.com
> 
> 
> _______________________________________________
> DB-SIG maillist  -  DB-SIG@python.org
> http://mail.python.org/mailman/listinfo/db-sig


__________________________________________________
Do You Yahoo!?
Sign up for SBC Yahoo! Dial - First Month Free
http://sbc.yahoo.com

From marklists at mceahern.com  Tue Jul  9 12:41:27 2002
From: marklists at mceahern.com (Mark McEahern)
Date: Fri Jan  9 21:52:55 2004
Subject: [mod_python] configuration error
Message-ID: <JHEOKEOOLIGLDHCMAHMOMEJPDAAA.marklists@mceahern.com>

Hi, I'm trying to configure mod_python with Apache.  When I run the test, I
get Internal Server Error.  Here's what I see in Apache's error_log:

[Tue Jul  9 12:10:18 2002] [notice] Apache/1.3.26 (Unix) mod_python/2.7.8
Python/2.2.1 configured -- resuming normal operations
[Tue Jul  9 12:10:18 2002] [notice] Accept mutex: sysvsem (Default: sysvsem)
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
[Tue Jul  9 12:10:46 2002] [error] [client 192.168.0.1] python_handler:
make_obcallback returned no obCallBack!

Here's how I compiled mod_python and installed it:

  ./configure --with-apxs=/usr/local/apache/bin/apxs
  ./make
  sudo make install

I then edited httpd.conf, adding:

LoadModule python_module /usr/local/apache/libexec/mod_python.so

and

<Directory /home/.../pytest/>
  AddHandler python-program .py
  PythonHandler mptest
  PythonDebug On
</Directory>

This is mptest.py:

from mod_python import apache

def handler(req):
    req.send_http_header()
    req.write("Hello World!")
    return apache.OK

I'm running Apache 1.3.26 on Red Hat Linux 7.3.  I'm using Python 2.2.1.
mod_python installed into:

	/usr/local/lib/python2.2/site-packages/mod_python/

which is world readable.  All the files in mod_python are world readable.
Interestingly, the .py files are world executable, but the .pyc files are
NOT world executable--I don't think that makes a difference?

Is there something obvious I'm doing wrong in configuring Apache?

I found this thread and the threads it points to:

  http://www.modpython.org/pipermail/mod_python/2000-September/000881.html

The problem he encountered was that mod_python was installed as
mod_python$version, which he solved by using a symbolic link.  I don't think
that's the problem I'm having.

Interestingly, if I start Apache with httpd -X, Hello World works just fine.
However, when I start Apache normally, it doesn't work, but the above dump
from error log is all I have to go on.

Any ideas?

Thanks,

// mark

-


From marklists at mceahern.com  Tue Jul  9 13:30:20 2002
From: marklists at mceahern.com (Mark McEahern)
Date: Fri Jan  9 21:52:55 2004
Subject: [mod_python] configuration error
In-Reply-To: <JHEOKEOOLIGLDHCMAHMOMEJPDAAA.marklists@mceahern.com>
Message-ID: <JHEOKEOOLIGLDHCMAHMOGEKEDAAA.marklists@mceahern.com>

I was able to fix this by recompiling Python like so:

  ./configure --without-threads

What I wonder is how come mod_python's configure didn't warn me about this
as implied here:


http://www.modpython.org/live/mod_python-2.7.8/doc-html/inst-configure.html

Cheers,

// mark

> -----Original Message-----
> From: mod_python-admin@modpython.org
> [mailto:mod_python-admin@modpython.org]On Behalf Of Mark McEahern
> Sent: Tuesday, July 09, 2002 12:41 PM
> To: mod_python@modpython.org
> Subject: [mod_python] configuration error
>
>
> Hi, I'm trying to configure mod_python with Apache.  When I run
> the test, I
> get Internal Server Error.  Here's what I see in Apache's error_log:
>
> [Tue Jul  9 12:10:18 2002] [notice] Apache/1.3.26 (Unix) mod_python/2.7.8
> Python/2.2.1 configured -- resuming normal operations
> [Tue Jul  9 12:10:18 2002] [notice] Accept mutex: sysvsem
> (Default: sysvsem)
> make_obcallback(): could not import mod_python.apache.
> make_obcallback(): could not call init.
> [Tue Jul  9 12:10:46 2002] [error] [client 192.168.0.1] python_handler:
> make_obcallback returned no obCallBack!
>
> Here's how I compiled mod_python and installed it:
>
>   ./configure --with-apxs=/usr/local/apache/bin/apxs
>   ./make
>   sudo make install
>
> I then edited httpd.conf, adding:
>
> LoadModule python_module /usr/local/apache/libexec/mod_python.so
>
> and
>
> <Directory /home/.../pytest/>
>   AddHandler python-program .py
>   PythonHandler mptest
>   PythonDebug On
> </Directory>
>
> This is mptest.py:
>
> from mod_python import apache
>
> def handler(req):
>     req.send_http_header()
>     req.write("Hello World!")
>     return apache.OK
>
> I'm running Apache 1.3.26 on Red Hat Linux 7.3.  I'm using Python 2.2.1.
> mod_python installed into:
>
> 	/usr/local/lib/python2.2/site-packages/mod_python/
>
> which is world readable.  All the files in mod_python are world readable.
> Interestingly, the .py files are world executable, but the .pyc files are
> NOT world executable--I don't think that makes a difference?
>
> Is there something obvious I'm doing wrong in configuring Apache?
>
> I found this thread and the threads it points to:
>
>   http://www.modpython.org/pipermail/mod_python/2000-September/000881.html
>
> The problem he encountered was that mod_python was installed as
> mod_python$version, which he solved by using a symbolic link.  I
> don't think
> that's the problem I'm having.
>
> Interestingly, if I start Apache with httpd -X, Hello World works
> just fine.
> However, when I start Apache normally, it doesn't work, but the above dump
> from error log is all I have to go on.
>
> Any ideas?
>
> Thanks,
>
> // mark
>
> -
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> -
>
>

-


From vmilitaru at sympatico.ca  Tue Jul  9 15:09:59 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 21:52:55 2004
Subject: [mod_python] Tips and Tricks initiative
In-Reply-To: <4207FDD5-8ED5-11D6-9214-0003938210D6@redivi.com>; from bob@redivi.com on Wed, Jul 03, 2002 at 06:36:04PM -0400
References: <20020703173849.A937@eye.neb> <4207FDD5-8ED5-11D6-9214-0003938210D6@redivi.com>
Message-ID: <20020709150959.A461@eye.neb>

Admittedly, the intent of re-using a cursor can only be summed up as pure
greed, or the art of sucking up the last atom of speed from a given system.
In dark moonless nights, I almost pitty myself.

Thanks for the intro on threadsafety. Most interesting.

* Bob Ippolito <bob@redivi.com> [020708 22:35]:
> It depends on the particular db module, some modules have threadsafe 
> database instances, some don't.  Some have threadsafe database cursors, 
> and some don't.  Read the docs.  If it's DBAPI compliant, check its 
> thread safe level.  I have never used anything that's thread safe level 
> 3, most are level 2 or 1 in my experience.
> 
> from http://www.python.org/topics/database/DatabaseAPI-2.0.html
> threadsafety
> Integer constant stating the level of thread safety the interface 
> supports. Possible values are:
> 0	= Threads may not share the module.
> 1	= Threads may share the module, but not connections.
> 2	= Threads may share the module and connections.
> 3	= Threads may share the module, connections and cursors.
> 
> Sharing in the above context means that two threads may use a resource 
> without wrapping it using a mutex semaphore to implement resource 
> locking. Note that you cannot always make external resources thread safe 
> bymanaging access using a mutex: the resource may rely on global 
> variables or other external sources that are beyond your control.
> 
> -bob
> 
> On Wednesday, July 3, 2002, at 06:38 PM, vio wrote:
> 
> > * Alain Tesio <alain@onesite.org> [020703 17:11]:
> >
> >>> For instance, I'd be very interested to read in such a tricks and 
> >>> tips list how to avoid the
> >>> overhead of creating a database connection at each call to 'handler'. 
> >>> And so on.
> >>
> >> Just make the connection a global variable.
> >
> > I think I tried that, initialized the db connection at the module 
> > level. But somehow my cursor got corrupted, or something. I forgot 
> > oracle's error number, only that my workaround was to do something like 
> > (we're at module level here):
> >
> > db = DCOracle2.connect(my_login_string)
> > def get_db_cursor():
> >     "create database connection"
> >     cursor = db.cursor() # Allocate a cursor
> >     return cursor
> >
> > In fact I see that I am re-using the same connection here, so let me 
> > re-phrase my initial question: how do I re-use the same *cursor* (or it 
> > this a bad idea in the first place). I wonder what would happen in such 
> > a multi-threaded environment (well, I'm saling in Linuxland) where 
> > multiple httpd instances will hit on the db server (ora8i in my case) 
> > with the same cursor *concurrently* (never got to that point of 
> > desperation, though - but just from contemplating such possibility 
> > sounds like total anarchy). What I did try but eventually got an error 
> > on was to re-use the same cursor sequentially (in a non-threaded 
> > application).
> >
> > Cheers, Vio
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://www.modpython.org/mailman/listinfo/mod_python
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

From vmilitaru at sympatico.ca  Tue Jul  9 15:18:48 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 21:52:55 2004
Subject: [mod_python] configuration error
In-Reply-To: <JHEOKEOOLIGLDHCMAHMOMEJPDAAA.marklists@mceahern.com>; from marklists@mceahern.com on Tue, Jul 09, 2002 at 12:41:27PM -0500
References: <JHEOKEOOLIGLDHCMAHMOMEJPDAAA.marklists@mceahern.com>
Message-ID: <20020709151848.B461@eye.neb>

> ...
> I then edited httpd.conf, adding:
> 
> LoadModule python_module /usr/local/apache/libexec/mod_python.so
> 

I believe just here should be something like:

	AddModule mod_python.c

> and
> 
> <Directory /home/.../pytest/>
>   AddHandler python-program .py
>   PythonHandler mptest
>   PythonDebug On
> </Directory>
> 

Hope this solves your bobo,
Vio

From marklists at mceahern.com  Tue Jul  9 14:35:13 2002
From: marklists at mceahern.com (Mark McEahern)
Date: Fri Jan  9 21:52:55 2004
Subject: [mod_python] configuration error
In-Reply-To: <20020709151848.B461@eye.neb>
Message-ID: <JHEOKEOOLIGLDHCMAHMOAEKKDAAA.marklists@mceahern.com>

> I believe just here should be something like:
>
> 	AddModule mod_python.c

That's only required if you have ClearModuleList, which I don't.

As I noted in a follow up, I solved the problem by recompiling Python
without thread support.

Cheers,

// mark

-


From gbenson at redhat.com  Sat Jul 13 12:51:32 2002
From: gbenson at redhat.com (Gary Benson)
Date: Fri Jan  9 21:52:55 2004
Subject: [mod_python] Ping?
Message-ID: <Pine.LNX.4.44.0207131250410.31967-100000@slippy.wire.rat>

It seems that I am getting messages from this list with a four day lag. 
Is anyone else experiencing this?

Cheers,
Gary

[ gbenson@redhat.com ][ GnuPG 85A8F78B ][ http://inauspicious.org/ ]


From fabbe at paniq.net  Sun Jul 14 11:33:07 2002
From: fabbe at paniq.net (Fabian Fagerholm)
Date: Fri Jan  9 21:52:55 2004
Subject: [mod_python] Understanding mod_python
Message-ID: <1026635587.26526.30.camel@kernel>

Hello, World!

I've just begun to get to know Python and mod_python. So far, I like
what I see, but there are a few things that are a bit confusing. I
suspect it's just a matter of differing conventions - my previous
experience programming web applications is with Perl (cgi), PHP and Java
(Servlets).

Since I like to know exactly what I'm doing, I've read through all the
docs I could find, and browsed through the mailing list archives. I now
have two issues that I would like to bring up.


First, I would like to convince myself that I have understood the
Handler concept and the Publisher Handler. Therefore, I've made two
drawings based on the mod_python docs. The first drawing is
    http://www.paniq.net/fabbe/mod_python/Handler_order.ps
and it tries to show what happens when a request is made to Apache. In
particular, I'm trying to understand in which *order* the Handlers are
called and what each Handler is for.
The second drawing is
    http://www.paniq.net/fabbe/mod_python/Publisher_handler.ps
and it tries to show how the Publisher Handler handles a request. It
also shows the different parts of an URI from the Publisher's point of
view.

        * Are these drawings correct or have I misunderstood anything?
        * I would like to combine the drawings into one. Where would I
          attach the second drawing to the first?
        * I didn't quite understand how the __auth__, __access__ and
          __auth_realm__ stuff in Publisher works. I'm confused by the
          phrase "at each traversal step, the Publisher checks for...".
          I understand one object might refer to or contain another, but
          the benefits and practical use of this is is not clear to me
          and would need further explanation.
        * Could these drawings be beneficial to someone else? If so, I'd
          be happy to modify them for some particular purpose.


Second, while reading the mailing list archives, I found that many of
the posts were about how to build a web application with a sensible
structure (separating content from presentation), authorization, session
management etc. with mod_python. A very valid question IMO, because the
tutorial in the docs is quite sparse and shows an example that is mostly
achievable by using traditional CGI.
Using Python's OO features, it should be possible to create quite
complex web applications. As far as I can see, mod_python is able to
replace a Java Servlet-based solution with little effort. In fact, this
is my exact reason for looking at mod_python. :)

There were also some posts about a mod_python "cookbook", and another
poster suggested the on-line FAQ would be a good place for the
"recipes". I totally agree - well-written example code is the best way
to learn.
I'd like to suggest that a new category be created in the FAQ for these
snippets of example code.


Cheers,
Fabian Fagerholm

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 240 bytes
Desc: This is a digitally signed message part
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20020714/e9156aa3/attachment-0001.bin
From pk1u at yahoo.com  Sun Jul 14 16:58:17 2002
From: pk1u at yahoo.com (Praveen Kumar)
Date: Fri Jan  9 21:52:55 2004
Subject: [mod_python] Re: DCOracle2 w/ apache + mod_python under rh7.2 ?
In-Reply-To: <20020709073832.GV14854@glas.net>
Message-ID: <20020714235817.90778.qmail@web10411.mail.yahoo.com>

> 1) make sure you have set ORACLE_HOME env var.
> 2) make sure you have set LD_LIBRARY_PATH (to
> $ORACLE_HOME/lib) env var.
> 3) make sure that both of them are set _before_ the
> ecript execution.

Didn't work. I got around it by using mod_python as a
DSO, and using apache's LoadFile directive; in
httpd.conf:

LoadFile /home/pk/OraHome1/lib/libclntsh.so.9.0 

Not ideal, but it works.

pk

--- "Eugene V. Dvurechenski" <jno@glasnet.ru> wrote:
> On Mon, Jul 08, 2002 at 04:55:05PM -0700, Praveen
> Kumar wrote:
> >     import dco2
> > 
> > ImportError: libclntsh.so.9.0: cannot open shared
> > object file: No such file or directory
> 
> 1) make sure you have set ORACLE_HOME env var.
> 2) make sure you have set LD_LIBRARY_PATH (to
> $ORACLE_HOME/lib) env var.
> 3) make sure that both of them are set _before_ the
> ecript execution.
> 
> the last point is essential - os.environ doesn't
> help much.

Orig msg:

> Has anyone successfully used DCOracle2 w/ apache +
> mod_python under rh7.2 ?
> 
> My system consists of rh7.2, apache1.3.26,
> mod_python-2.7.8, python2.1.3, Oracle9i .
> 
> I see the following when my program accesses the
> DCOracle2 module:
> 
>   File
>
"/usr/lib/python2.1/site-packages/DCOracle2/__init__.py",
> line 37, in ?
>     from DCOracle2 import   *
> 
>   File
>
"/usr/lib/python2.1/site-packages/DCOracle2/DCOracle2.py",
> line 104, in ?
>     import dco2
> 
> ImportError: libclntsh.so.9.0: cannot open shared
> object file: No such file or directory
> 
> 
> 
> I've tried the following:
> 
> -----
> 
> Setting LD_LIBRARY_PATH from the same shell where I
> start apache:
> 
> export LD_LIBRARY_PATH=/home/pk/OraHome1/lib
> 
> -----
> 
> Setting LD_LIBRARY_PATH to /home/pk/OraHome1/lib via
> Apache's PassEnv and SetEnv directives.
> 
> -----
> 
> Placed libclntsh.so.9.0 in
> /usr/lib/python2.1/site-packages/DCOracle2 ( same
> path
> as dco2.so ).
> 
> -----
> 
> Added /home/pk/OraHome1/lib to /etc/ld.so.conf , and
> executed /sbin/ldconfig as root.
> 
> -----
> 
> Tried adding each of:
> 
> os.putenv( 'LD_LIBRARY_PATH',
> '/home/pk/OraHome1/lib'
> )
> 
> os.environ[ 'LD_LIBRARY_PATH' ] =
> '/home/pk/OraHome1/lib'
> 
> in DCOracle2/DCOracle2.py before the "import dco2"
> statement
> 
> -----
> 
> /home/pk/OraHome1/lib is readable by all ; but tried
> the following anyway, to eliminate a
> permissions-issue
> as the cause:
> 
> As root, copied /home/pk/OraHome1/lib to /oralib ;
> tried all of the above, using /oralib
> 
> -----
> 
> "/home/pk/OraHome1/lib/libclntsh.so.9.0" exists, yet
> none of these work. The DCOracle2 module works fine
> when I use it from a standalone program. It would be
> helpful to know if anyone has gotten this config to
> work; also, any suggestions would be appreciated.
> 
> pk
> 


__________________________________________________
Do You Yahoo!?
Yahoo! Autos - Get free new car price quotes
http://autos.yahoo.com

From jdaily at kc.rr.com  Sun Jul 14 20:01:21 2002
From: jdaily at kc.rr.com (james daily)
Date: Fri Jan  9 21:52:55 2004
Subject: [mod_python] please, old fool needs help with getting apache mod_python on windows 98 to run
Message-ID: <NDBBIADKLJIPFGPECIJPOELOCMAA.jdaily@kc.rr.com>

the mod_python online manual at:
    http://www.modpython.org/live/mod_python-2.7.8/doc-html/app-wininst.html

says:
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
A. Windows Installation

Notes originally created by Enrique Vaamonde evaamo@loquesea.com

Your mileage may vary with these instructions

You need to have the following packages properly installed and configured in
your system:


Python 1.5.2 or 2.0
Apache 1.3
Winzip 6.x or later.

You need to download both the mod_python.dll and the mod_python-x.tgz (where
x is the version number) files from the main page. Once you have all the
things above mentioned we're good to go.


Installing mod_python libraries

Use Winzip to extract the distribution file (mod_python-x.tgz) into a
temporary folder (i.e C:\temp):

NOTE: If Winzip shows this warning "Archive contains one file, should Winzip
decompress it to a temporary folder?" just click on Yes, the content of the
file should appear in Winzip right after.

Select all the files in Winzip and click on the Extract button, then type-in
the path or just browse your way to the temporary folder and click extract.

Open your Windows Explorer and locate the temporary folder where you
extracted the distribution file, you should have a new folder in your
temporary folder
(C:\temp\mod_python-x).

Move (or just drag & drop) the mod_python-x folder into the Python lib
folder
(i.e C:\Program Files\Python\lib).

Move the files in the folder lib inside the mod_python folder
(C:\Program Files\Python\lib\mod_python-x\lib\mod_python) to the
C:\Program Files\Python\lib\mod_python folder.
It's safe to delete these folders we just emptied.

xxxxxxxxxxx
also put the files from
    "mod_python-2.7.8\src\include\"
into
    "D:\Program Files\python211\Python21\include"
which allowed apache to start.
xxxxxxxxxxx

Integrating it with Apache
Once the distribution file is correctly extracted and later moved into the
Python directory, it's time to modify your Apache configuration (httpd.conf)
and integrate the server with mod_python. These are a few steps we must do
first:


Locate the file mod_python.dll that you downloaded before and move it to
Apache's modules folder (i.e C:\Program Files\Apache Group\Apache\modules).

Go to the Apache configuration folder (i.e C:\Program Files\Apache
Group\Apache\conf\) and edit the httpd.conf file.
Add the following line in the section "Dynamic Shared Object (DSO) Support"
of the httpd.conf file:


LoadModule python_module modules/mod_python.dll


Add the following lines in the section ScriptAlias and CGI of the
httpd.conf:


<Directory "<Your Document Root>/python">
   AddHandler python-program .py
   PythonHandler mptest
   PythonDebug on
</Directory>

NOTE: Replace the <Your Document Root> above with the Document Root you
specified on the DocumentRoot directive in the Apache's httpd.conf file.


Last, create a folder under your Document Root called python.


Testing

Create a text file in the folder we created above and call it mptest.py (you
can use Notepad for this).

Insert the following lines and save the file (Make sure it gets saved with
the .py extension):


from mod_python import apache

def handler(req):
   req.content_type = "text/plain"
   req.send_http_header()
   req.write("Hello World!")
   return apache.OK


Make sure Apache is running (or launch it!) and then point your browser to
the URL referring to the mptest.py, you should see "Hello World!".

That's it, you're ready to roll!! If you don't see the "Hello World!"
message, the next section is for you.
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

Apache/1.3.14 (Win32) running...
Python 2.1.1

all i get in the browser is the text of mptest.py

any suggestions?

if someone has it actually running on their windows 98 system,
could you please send me the ***relevant*** portions from your
apache httpd.conf file?

i have tried numerous different approaches to no avail.

alas, i am a programmer but not (yet) an apache guru.

any help would be greatly appreciated.


---------------------------------------------
James Daily
Phone : 816 943 9891
Email : wndrer@earthling.net (or hit reply button)
Web   : http://tellmama.com/
Philosophy:
                            4     2                              1000
( cos(? - r) - sin ? ) * ( r  - 2r  cos(2? + 2.4) + 0.9) + 0.62r)     < 0

Education is a progressive discovery of our own ignorance.
                                               Will Durant


From bill at immosys.com  Mon Jul 15 16:46:21 2002
From: bill at immosys.com (Bill Anderson)
Date: Fri Jan  9 21:52:55 2004
Subject: [mod_python] new to mod_python, with a question.
Message-ID: <1026773181.12028.7.camel@locutus>

OK, so here is what I am doing. I am using PageTemplates (from zope) and
mod_python. or at least, I am trying to. :)


if I do _NOT_ use the request object (i.e. I return a fully formed html
string/document), it works fine. but of course, that means no use of
mod-python's request objects functions such as cookie/header
construction, usage, etc.

To wit:
def sayit(req,x=12):
	if not x:
		return "I need x"
	if not master:
		return "I need a master object"
	pt=PageTemplate()
	filestring =
"".join(open("/home/ucntcme/public_html/pythonapps/test.pt").readlines())
	pt.write(filestring)
	myx=int(x)
        req.content_type="text/html"
        req.send_http_headers()
	req.write( pt(x=myx,master=master) )
	return apache.OK

returns my rendered template, but at the bottom has:

HTTP/1.1 200 OK Date: Mon, 15 Jul 2002 22:44:27 GMT Server:
Apache/1.3.22 (Unix) (Red-Hat/Linux) mod_python/2.7.8 Python/2.2.1
mod_ssl/2.8.5 OpenSSL/0.9.6b DAV/1.0.2 PHP/4.0.6 mod_perl/1.26
Connection: close Transfer-Encoding: chunked Content-Type: text/html;
charset=iso-8859-1
OK
The server encountered an internal error or misconfiguration and was
unable to complete your request.



Debug is on, and there are no mesages in the error_log.

Now, if I just return the content using return (content), it works fine.

Why is this/what am I doing wrong here?

Cheers, Bill







From gbenson at redhat.com  Tue Jul 16 10:15:59 2002
From: gbenson at redhat.com (Gary Benson)
Date: Fri Jan  9 21:52:55 2004
Subject: [mod_python] [PATCH] last httpd-2.0.36
Message-ID: <Pine.LNX.4.44.0207161015330.16859-200000@slippy.wire.rat>


Hi,

The attached patch brings the input filtering API in mod_python into line 
with that in httpd-2.0.36.  This is the last thing that I know of that 
needed fixing to work with 2.0.36, although I beleive some more fixes will 
be in order to build against 2.0.39 or whatever it is now :)

Cheers,
Gary

[ gbenson@redhat.com ][ GnuPG 85A8F78B ][ http://inauspicious.org/ ]
-------------- next part --------------
Bring input filter API in line with 2.0.36

Index: src/filterobject.c
===================================================================
RCS file: /cvsroot/modpython/mod_python/src/filterobject.c,v
retrieving revision 1.5
diff -u -r1.5 filterobject.c
--- src/filterobject.c	3 Jun 2002 14:31:15 -0000	1.5
+++ src/filterobject.c	9 Jul 2002 16:21:27 -0000
@@ -61,7 +61,7 @@
  */
 
 PyObject *MpFilter_FromFilter(ap_filter_t *f, apr_bucket_brigade *bb, int is_input,
-			      ap_input_mode_t mode, apr_size_t *readbytes,
+			      ap_input_mode_t mode, apr_size_t readbytes,
 			      char * handler, char *dir)
 {
     filterobject *result;
@@ -86,7 +86,7 @@
 	result->bb_in = bb;
 	result->bb_out = NULL;
 	result->mode = 0;
-	result->readbytes = NULL;
+	result->readbytes = 0;
     }
 
     result->closed = 0;
@@ -142,7 +142,7 @@
 
 	Py_BEGIN_ALLOW_THREADS;
 	self->rc = ap_get_brigade(self->f->next, self->bb_in, self->mode, 
-				  APR_BLOCK_READ, *self->readbytes);
+				  APR_BLOCK_READ, self->readbytes);
 	Py_END_ALLOW_THREADS;
 
 	if (! APR_STATUS_IS_SUCCESS(self->rc)) {
@@ -239,7 +239,7 @@
 
 		Py_BEGIN_ALLOW_THREADS;
 		self->rc = ap_get_brigade(self->f->next, self->bb_in, self->mode, 
-					  APR_BLOCK_READ, *self->readbytes);
+					  APR_BLOCK_READ, self->readbytes);
 		Py_END_ALLOW_THREADS;
 
 		if (! APR_STATUS_IS_SUCCESS(self->rc)) {
Index: src/mod_python.c
===================================================================
RCS file: /cvsroot/modpython/mod_python/src/mod_python.c,v
retrieving revision 1.60
diff -u -r1.60 mod_python.c
--- src/mod_python.c	3 Jun 2002 14:31:15 -0000	1.60
+++ src/mod_python.c	9 Jul 2002 16:21:35 -0000
@@ -1023,7 +1023,8 @@
 static apr_status_t python_filter(int is_input, ap_filter_t *f, 
 				  apr_bucket_brigade *bb,
 				  ap_input_mode_t mode,
-				  apr_size_t *readbytes) {
+				  apr_read_type_e block,
+				  apr_size_t readbytes) {
 
     PyObject *resultobject = NULL;
     interpreterdata *idata;
@@ -1052,8 +1053,7 @@
        so a fitler can spit out an error without causing infinite loop */
     if (ctx->transparent) {
 	if (is_input) 
-	    return ap_get_brigade(f->next, bb, mode, APR_BLOCK_READ, 
-				  *readbytes);
+	    return ap_get_brigade(f->next, bb, mode, block, readbytes);
 	else
 	    return ap_pass_brigade(f->next, bb);
     }
@@ -1201,9 +1201,10 @@
 static apr_status_t python_input_filter(ap_filter_t *f, 
 					apr_bucket_brigade *bb,
 					ap_input_mode_t mode,
-					apr_size_t *readbytes) 
+					apr_read_type_e block,
+					apr_off_t readbytes)
 {
-    return python_filter(1, f, bb, mode, readbytes);
+    return python_filter(1, f, bb, mode, block, readbytes);
 }
 
 
@@ -1216,7 +1217,7 @@
 static apr_status_t python_output_filter(ap_filter_t *f, 
 					 apr_bucket_brigade *bb)
 {
-    return python_filter(0, f, bb, 0, NULL);
+    return python_filter(0, f, bb, 0, 0, 0);
 }
 
 
Index: src/include/filterobject.h
===================================================================
RCS file: /cvsroot/modpython/mod_python/src/include/filterobject.h,v
retrieving revision 1.4
diff -u -r1.4 filterobject.h
--- src/include/filterobject.h	3 Jun 2002 14:31:16 -0000	1.4
+++ src/include/filterobject.h	9 Jul 2002 16:21:36 -0000
@@ -67,7 +67,7 @@
 
 	int is_input;
 	ap_input_mode_t mode;
-	apr_size_t *readbytes;
+	apr_size_t readbytes;
 
 	int closed;
 	int softspace;
@@ -88,7 +88,7 @@
     extern DL_IMPORT(PyObject *) 
 	MpFilter_FromFilter Py_PROTO((ap_filter_t *f, apr_bucket_brigade *bb_in, 
 				      int is_input, ap_input_mode_t mode, 
-				      apr_size_t *readbytes, char *hadler, char *dir));
+				      apr_size_t readbytes, char *hadler, char *dir));
 
 #ifdef __cplusplus
 }
From ecastanedo at hotmail.com  Wed Jul 17 01:04:14 2002
From: ecastanedo at hotmail.com (Edgar Castanedo)
Date: Fri Jan  9 21:52:55 2004
Subject: [mod_python] freebsd
Message-ID: <F1478v6eoHvEmsgTFsF000136d0@hotmail.com>

I have installed Python on FreeBSD from the ports collection. When I try and 
install mod_python (from the ports collection also), a message is returned 
which states that Python needs to be installed WITHOUT threads. I am not 
sure if this is okay since I write lots of Python script and don't know how 
this will affect Pythons performance. Can anyone shed some light on this for 
me as I do not want to disable threads if it means that my scripts will not 
work the way they used to.

Thanks,

*************************************
Edgar Castanedo
ecastanedo@hotmail.com
*************************************


_________________________________________________________________
Chat with friends online, try MSN Messenger: http://messenger.msn.com


From gharris at centauri.mb.ca  Fri Jul 19 00:18:58 2002
From: gharris at centauri.mb.ca (George Harrison)
Date: Fri Jan  9 21:52:55 2004
Subject: [mod_python] Installing mod_python on Win98/Apache
Message-ID: <5.1.0.14.2.20020718231601.027cfec0@pop.mb.sympatico.ca>

After following the instructions in the documentation and copying the files 
from D:\Program Files\Python22\lib\mod_python-x\lib\mod_python to 
D:\Program Files\Python22\lib\mod_python;  I can launch Apache but when I 
try to open mptest.py I get the following message in the error log:

[Thu Jul 18 23:50:19 2002] [error] [client 127.0.0.1] python_handler: 
make_obcallback returned no obCallBack!

Does anyone know what is happening, or have a listing of where the files 
are supposed to be in the python directory for this to work?

Thanks

gh



From gbenson at redhat.com  Wed Jul 10 11:42:21 2002
From: gbenson at redhat.com (Gary Benson)
Date: Fri Jan  9 21:52:55 2004
Subject: [mod_python] [PATCH] last httpd-2.0.36
Message-ID: <Pine.LNX.4.44.0207101139450.20893-200000@slippy.wire.rat>


Hi,

The attached patch brings the input filtering API in mod_python into line 
with that in httpd-2.0.36.  This is the last thing that I know of that 
needed fixing to work with 2.0.36, although I beleive some more fixes will 
be in order to build against 2.0.39 or whatever it is now :)

Cheers,
Gary

[ gbenson@redhat.com ][ GnuPG 85A8F78B ][ http://inauspicious.org/ ]

-------------- next part --------------
Bring input filter API in line with 2.0.36

Index: src/filterobject.c
===================================================================
RCS file: /cvsroot/modpython/mod_python/src/filterobject.c,v
retrieving revision 1.5
diff -u -r1.5 filterobject.c
--- src/filterobject.c	3 Jun 2002 14:31:15 -0000	1.5
+++ src/filterobject.c	9 Jul 2002 16:21:27 -0000
@@ -61,7 +61,7 @@
  */
 
 PyObject *MpFilter_FromFilter(ap_filter_t *f, apr_bucket_brigade *bb, int is_input,
-			      ap_input_mode_t mode, apr_size_t *readbytes,
+			      ap_input_mode_t mode, apr_size_t readbytes,
 			      char * handler, char *dir)
 {
     filterobject *result;
@@ -86,7 +86,7 @@
 	result->bb_in = bb;
 	result->bb_out = NULL;
 	result->mode = 0;
-	result->readbytes = NULL;
+	result->readbytes = 0;
     }
 
     result->closed = 0;
@@ -142,7 +142,7 @@
 
 	Py_BEGIN_ALLOW_THREADS;
 	self->rc = ap_get_brigade(self->f->next, self->bb_in, self->mode, 
-				  APR_BLOCK_READ, *self->readbytes);
+				  APR_BLOCK_READ, self->readbytes);
 	Py_END_ALLOW_THREADS;
 
 	if (! APR_STATUS_IS_SUCCESS(self->rc)) {
@@ -239,7 +239,7 @@
 
 		Py_BEGIN_ALLOW_THREADS;
 		self->rc = ap_get_brigade(self->f->next, self->bb_in, self->mode, 
-					  APR_BLOCK_READ, *self->readbytes);
+					  APR_BLOCK_READ, self->readbytes);
 		Py_END_ALLOW_THREADS;
 
 		if (! APR_STATUS_IS_SUCCESS(self->rc)) {
Index: src/mod_python.c
===================================================================
RCS file: /cvsroot/modpython/mod_python/src/mod_python.c,v
retrieving revision 1.60
diff -u -r1.60 mod_python.c
--- src/mod_python.c	3 Jun 2002 14:31:15 -0000	1.60
+++ src/mod_python.c	9 Jul 2002 16:21:35 -0000
@@ -1023,7 +1023,8 @@
 static apr_status_t python_filter(int is_input, ap_filter_t *f, 
 				  apr_bucket_brigade *bb,
 				  ap_input_mode_t mode,
-				  apr_size_t *readbytes) {
+				  apr_read_type_e block,
+				  apr_size_t readbytes) {
 
     PyObject *resultobject = NULL;
     interpreterdata *idata;
@@ -1052,8 +1053,7 @@
        so a fitler can spit out an error without causing infinite loop */
     if (ctx->transparent) {
 	if (is_input) 
-	    return ap_get_brigade(f->next, bb, mode, APR_BLOCK_READ, 
-				  *readbytes);
+	    return ap_get_brigade(f->next, bb, mode, block, readbytes);
 	else
 	    return ap_pass_brigade(f->next, bb);
     }
@@ -1201,9 +1201,10 @@
 static apr_status_t python_input_filter(ap_filter_t *f, 
 					apr_bucket_brigade *bb,
 					ap_input_mode_t mode,
-					apr_size_t *readbytes) 
+					apr_read_type_e block,
+					apr_off_t readbytes)
 {
-    return python_filter(1, f, bb, mode, readbytes);
+    return python_filter(1, f, bb, mode, block, readbytes);
 }
 
 
@@ -1216,7 +1217,7 @@
 static apr_status_t python_output_filter(ap_filter_t *f, 
 					 apr_bucket_brigade *bb)
 {
-    return python_filter(0, f, bb, 0, NULL);
+    return python_filter(0, f, bb, 0, 0, 0);
 }
 
 
Index: src/include/filterobject.h
===================================================================
RCS file: /cvsroot/modpython/mod_python/src/include/filterobject.h,v
retrieving revision 1.4
diff -u -r1.4 filterobject.h
--- src/include/filterobject.h	3 Jun 2002 14:31:16 -0000	1.4
+++ src/include/filterobject.h	9 Jul 2002 16:21:36 -0000
@@ -67,7 +67,7 @@
 
 	int is_input;
 	ap_input_mode_t mode;
-	apr_size_t *readbytes;
+	apr_size_t readbytes;
 
 	int closed;
 	int softspace;
@@ -88,7 +88,7 @@
     extern DL_IMPORT(PyObject *) 
 	MpFilter_FromFilter Py_PROTO((ap_filter_t *f, apr_bucket_brigade *bb_in, 
 				      int is_input, ap_input_mode_t mode, 
-				      apr_size_t *readbytes, char *hadler, char *dir));
+				      apr_size_t readbytes, char *hadler, char *dir));
 
 #ifdef __cplusplus
 }
From ps0 at igmp.com.ar  Wed Jul  3 19:20:51 2002
From: ps0 at igmp.com.ar (ps0@igmp.com.ar)
Date: Fri Jan  9 21:52:55 2004
Subject: [mod_python] Problems creating files from mod_python
In-Reply-To: <20020702194803.A27995@igmp.com.ar>; from ps0@igmp.com.ar on Tue, Jul 02, 2002 at 07:48:03PM -0300
References: <20020702194803.A27995@igmp.com.ar>
Message-ID: <20020703192051.A18568@igmp.com.ar>

On Tue, Jul 02, 2002 at 07:48:03PM -0300, ps0@igmp.com.ar wrote:

Tnks to all for your anwers , the problem was thread support on python
( crazy things ) . Now with phython compiled without thread support
everyting works fine.

Tnks again.

Regards

> Apache: 1.3.24
> mod_python: 2.7.8
> Python: 2.2 (w/threads) [i have to recompile it
> without threads]
> 
> 
> fd=open("/tmp/bleh.txt", "w")
> fd.write("HOLA\n")
> fd.close()
> 
> On the fd.close() it make this error:
> IOError: [Errno 9] Bad file Descriptor 
> 
> The file is created but i can't write on it.
> 
> 
> The perms are corectly applied, from a python script ( out of apache )
> the thinks work ok.
> 
> Sugestions apreciated.
> 
> Tnks in advance.
> 
> Hector.
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From vmilitaru at sympatico.ca  Wed Jul  3 18:40:33 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 21:52:55 2004
Subject: [mod_python] Tips and Tricks initiative
In-Reply-To: <20020703183427.M2452@sventech.com>; from johannes@erdfelt.com on Wed, Jul 03, 2002 at 06:34:27PM -0400
References: <20020703153239.A772@eye.neb> <20020703183427.M2452@sventech.com>
Message-ID: <20020703184033.A1017@eye.neb>

* Johannes Erdfelt <johannes@erdfelt.com> [020703 18:32]:

> While not the most appropriate name, why doesn't the FAQ work for you?
> 
> http://www.modpython.org/FAQ/faqw.py

Perhaps because until this very moment I was *totally* unaware of its existence.
Many thanks for the pointer.

Cheers, Vio

From vmilitaru at sympatico.ca  Thu Jul  4 13:53:02 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 21:52:56 2004
Subject: [mod_python] Chewing cookies
Message-ID: <20020704135302.A489@eye.neb>

'REQUEST.headers_out.add('Set-Cookie',cookie_value)' seems the recommended way to set up multiple cookies on the client. But what is the recommended way to get back at those cookies? Seems to me that anything like 'REQUEST.headers_in['Set-Cookie'] is no good with more than one cookie, for obvious reasons. Any suggestions?

Cheers, Vio

From vmilitaru at sympatico.ca  Thu Jul  4 15:01:52 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 21:52:56 2004
Subject: [mod_python] Chewing cookies
Message-ID: <20020704190152.RXBC18503.tomts10-srv.bellnexxia.net@eye.neb>

'REQUEST.headers_out.add('Set-Cookie',cookie_value)' seems the recommended way 
to set up multiple cookies on the client. 
But what is the recommended way to get back at those cookies? 
Seems to me that anything like 'REQUEST.headers_in['Set-Cookie'] is no good 
with more than one cookie, for obvious reasons. 
Any tips would be appreciated.

Cheers, Vio


From mateusz at ant.gliwice.pl  Mon Jul 22 11:02:42 2002
From: mateusz at ant.gliwice.pl (Mateusz Korniak)
Date: Fri Jan  9 21:52:56 2004
Subject: [mod_python] Chewing cookies
In-Reply-To: <20020704190152.RXBC18503.tomts10-srv.bellnexxia.net@eye.neb>
References: <20020704190152.RXBC18503.tomts10-srv.bellnexxia.net@eye.neb>
Message-ID: <200207220902.g6M92ss21416@eden.ispol.com>

> 'REQUEST.headers_out.add('Set-Cookie',cookie_value)' seems the recommended
> way to set up multiple cookies on the client.
> But what is the recommended way to get back at those cookies?
> Seems to me that anything like 'REQUEST.headers_in['Set-Cookie'] is no good
> with more than one cookie, for obvious reasons.
> Any tips would be appreciated.

This code works for me: (all cookies seems to be send via single Cookie 
header)
		self.cookies = abbon.html.Cookie.Cookie() # Cookie module downloaded from 
www.python.org as py < 2.0 didn't have Cookie module

		if self.raw_request.headers_in.has_key('Cookie'):
			self.cookies.load(self.raw_request.headers_in['Cookie'])

		if self.cookies.has_key(COOKIEUID):
			self.cookie_uid = str(self.cookies[COOKIEUID].value)

		if self.cookies.has_key(SES):
			self.cookie_ses = str(self.cookies[SES].value)


HIH ...
-- 
Mateusz Korniak


From matt at proweb.co.uk  Mon Jul 22 10:10:56 2002
From: matt at proweb.co.uk (matt)
Date: Fri Jan  9 21:52:56 2004
Subject: [mod_python] Chewing cookies
References: <20020704135302.A489@eye.neb>
Message-ID: <001901c2315f$b0f055f0$6501a8c0@KIKE>

----- Original Message -----
From: "vio" <vmilitaru@sympatico.ca>
To: <mod_python@modpython.org>
Sent: Thursday, July 04, 2002 7:53 PM
Subject: [mod_python] Chewing cookies


> 'REQUEST.headers_out.add('Set-Cookie',cookie_value)' seems the recommended
way to set up multiple cookies on the client. But what is the recommended
way to get back at those cookies? Seems to me that anything like
'REQUEST.headers_in['Set-Cookie'] is no good with more than one cookie, for
obvious reasons. Any suggestions?

cookies are sent to the server url encoded and semi-colon separated on one
line

Cookie: foo=f00%20foo; bar=bar34; bazz=%56;

# here's a noddy cookie cracker

import urllib

cookie_string = REQUEST.headers_in['Cookie']
# eg. cookie_string = 'foo=f00%20foo; bar=bar34; bazz=%37%38%58%58;'

cookies = {}

for cookie in cookiestring.split(";") :
    key_value = cookie.split("=")

 if len(key_value) == 2 :
    cookies[urllib.unquote(key_value[0].strip())] =
urllib.unquote(key_value[1].strip())
print cookies

# eg. outputs
# {'bazz': '78XX', 'foo': 'f00 foo', 'bar': 'bar34'}



# matt


From matt at proweb.co.uk  Tue Jul 23 11:45:56 2002
From: matt at proweb.co.uk (matt)
Date: Fri Jan  9 21:52:56 2004
Subject: [mod_python] Chewing cookies
References: <20020704135302.A489@eye.neb> <001901c2315f$b0f055f0$6501a8c0@KIKE> <20020722225119.B282@eye.neb>
Message-ID: <007f01c23236$221528b0$6501a8c0@KIKE>

Hi, presumably you wanted it to go to the list to so I've included your mail
below in full too

Rather than work out the answres to your questions directly I think it might
be better for you to go read the theory and practice of cookies

The official spec
http://wp.netscape.com/newsref/std/cookie_spec.html
(which is curiously marked as "Preliminary Specification - Use with
caution")
or
http://developer.netscape.com/docs/manuals/communicator/jsguide4/cookies.htm

working with cookies :
http://www.cookiecentral.com/faq/

settign the expiry to a past date will delete them


> Hi Matt,
> Thanks for the reply. (I must say, it's hard not to totally love python.)
> To recap, all cookies are sent by the client in a single header ('Cookie')
> semi-colon separated.
> So here's a couple of follow-up questions:
> * Any rules for the date format? Is something like
> 'expires=Wed, 03-Jul-2002 05:18:07 GMT; ' OK?
>
> * what's the procedure to get rid of a cookie?
> Netscape docs (or Mozilla, I forgot which one) seem to suggest that the
client
> doesn't get rid of the cookie. But I saw in some Zope code snipplet
(again,
> I forgot which module, maybe somewhere in ZPublisher/HTTPResponse), that
> the way Zope dumped old cookies was to send them with a passed date
> ('expires=1971' or something).
>
> Some related data on this topic I found of interest:
> * sending a cookie path ('path=/; ') is Mandatory,
> else Netscape|Lynx won't store the cookie (Explorer?);
> * domain must contain 2 dots minimum, like in 'domain=.foo.com;' (this
also
> found in Zope sources, but not yet tested on my own). Could someone
confirm?
>
> Cheers, Vio



From gharris at centauri.mb.ca  Wed Jul 24 01:38:25 2002
From: gharris at centauri.mb.ca (George Harrison)
Date: Fri Jan  9 21:52:56 2004
Subject: [mod_python] Installing mod_python on Win98/Apache
In-Reply-To: <D31B04F24EDE7644BB169BB4F080778A01F4C546@s30342g004005>
Message-ID: <5.1.0.14.2.20020724012731.00a16dc0@pop.mb.sympatico.ca>

I think that was probably it, but I reinstalled Python, which fixed the 
problem.

thanks

gh
At 11:48 AM 2002.07.19 -0400, you wrote:
>I found that mod_python uses the pythonpath and pythonhome environment
>variables. Make sure that your normal path environment variable can reach
>python.exe. A normal python install does not create these just the .py and
>.pyc associations. If you cannot run python from a command prompt by typing
>python and a .py script, something is wrong. Next, make sure you are using
>the right .so (.dll) with the correct corresponding Apache software version.
>
>Hans
>
>-----Original Message-----
>From: George Harrison [mailto:gharris@centauri.mb.ca]
>Sent: Friday, July 19, 2002 1:19 AM
>To: mod_python@modpython.org
>Subject: [mod_python] Installing mod_python on Win98/Apache
>
>
>After following the instructions in the documentation and copying the files
>from D:\Program Files\Python22\lib\mod_python-x\lib\mod_python to
>D:\Program Files\Python22\lib\mod_python;  I can launch Apache but when I
>try to open mptest.py I get the following message in the error log:
>
>[Thu Jul 18 23:50:19 2002] [error] [client 127.0.0.1] python_handler:
>make_obcallback returned no obCallBack!
>
>Does anyone know what is happening, or have a listing of where the files
>are supposed to be in the python directory for this to work?
>
>Thanks
>
>gh
>
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://www.modpython.org/mailman/listinfo/mod_python


From matt at proweb.co.uk  Thu Jul 25 15:48:55 2002
From: matt at proweb.co.uk (matt)
Date: Fri Jan  9 21:52:56 2004
Subject: [mod_python] postgres progress
Message-ID: <008c01c233ea$69e60000$6501a8c0@KIKE>

bah, I've just run into the same problem as someone else was having 



From matt at proweb.co.uk  Thu Jul 25 16:36:39 2002
From: matt at proweb.co.uk (matt)
Date: Fri Jan  9 21:52:56 2004
Subject: [mod_python] postgres progress
Message-ID: <009d01c233f1$153ed750$6501a8c0@KIKE>

bah, I've just run into the same problem as someone else was having getting
postgres to work with mod_python

http://www.modpython.org/pipermail/mod_python/2001-August/001589.html

pgdb
PyPgSQL
psycopg

all fail to import

this is on FreeBSD 4.4 with mod_python-2.7.6
python-2.2.1
postgresql-7.2.1_1

anyone with any clues ?

M




From imcmeans at telus.net  Thu Jul 25 15:46:57 2002
From: imcmeans at telus.net (Ian McMeans)
Date: Fri Jan  9 21:52:56 2004
Subject: [mod_python] compiling in windows
Message-ID: <003301c2342d$2f28c950$44cee8d8@cr536745a>

I'm running windows XP, python 2.2, apache 2.

I can't get mod_python to compile with VC++ 6. The project file is invalid,
so I make a new one from the .dsp. When I try to compile it, (it tries to
make an .exe) it gives an error about the version.rc file mentioning
MPV_BUILD, which I delete from the file to remove the error.

Then it complains about not having httpd.h, so I download the apache source,
and copy/paste the files from the apache source to the mod_python source.

Then it complains about apr.h, which doesn't exist in the apache source.
There is a apr.h.in, apr.h.hnw, apr.h.w, and test_apr.h. I pick apr.h.w and
rename it to apr.h, copy it to the include directory for mod_python.

I end up having to copy/paste a few different include directories, and
rename some more .hn files to .h, and I still get 715 errors, most of which
are like this:
include\apr_pools.h(191) : error C2061: syntax error : identifier
'apr_pool_initialize'

THere's also this error at the beginning:
Warning: cannot find "mod_python.dep"

Is there somewhere I can download the binary for windows? Or is there a
better way to
compile it in windows, like merging VC projects or something?


From vmilitaru at sympatico.ca  Fri Jul 26 01:49:03 2002
From: vmilitaru at sympatico.ca (vmilitaru@sympatico.ca)
Date: Fri Jan  9 21:52:56 2004
Subject: [mod_python] postgres progress
In-Reply-To: <009d01c233f1$153ed750$6501a8c0@KIKE>; from matt@proweb.co.uk on Thu, Jul 25, 2002 at 04:36:39PM +0100
References: <009d01c233f1$153ed750$6501a8c0@KIKE>
Message-ID: <20020726014902.A317@eye.neb>

If all else fails, you can always consider alternatives. 
One setup example (which does seem to work for couple months now):
* python 2.1
* apache 1.3.26
* mod_ssl 2.8.10
* mod_python 2.7.8
* DCOracle2 1.84 (python interface to Oracle)
* Oracle 8i
(All humming inside a Linux 2.4.2 without a glitch)

That is, of course, if you're not overly religious about postgres.
Cheers, Vio

* matt <matt@proweb.co.uk> [020726 01:20]:
> bah, I've just run into the same problem as someone else was having getting
> postgres to work with mod_python
> 
> http://www.modpython.org/pipermail/mod_python/2001-August/001589.html
> 
> pgdb
> PyPgSQL
> psycopg
> 
> all fail to import
> 
> this is on FreeBSD 4.4 with mod_python-2.7.6
> python-2.2.1
> postgresql-7.2.1_1
> 
> anyone with any clues ?
> 
> M
> 
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

From oliver at redgecko.org  Fri Jul 26 08:30:38 2002
From: oliver at redgecko.org (Oliver Cope)
Date: Fri Jan  9 21:52:56 2004
Subject: [mod_python] postgres progress
In-Reply-To: <009d01c233f1$153ed750$6501a8c0@KIKE>
References: <009d01c233f1$153ed750$6501a8c0@KIKE>
Message-ID: <20020726073038.GA1165@namib.redgecko.org>

On Thu, Jul 25, 2002 at 04:36:39PM +0100, matt wrote:
> bah, I've just run into the same problem as someone else was having getting
> postgres to work with mod_python
> 
> http://www.modpython.org/pipermail/mod_python/2001-August/001589.html
> 
> pgdb
> PyPgSQL
> psycopg
> 
> all fail to import
> 
Have you tried using the PyGreSQL which comes with PostgreSQL?

If you configure PostgreSQL with --with-python it will build and install 
PyGreSQL, and this seems quite stable for use with mod_python.

As I keep as non-threaded installation of Python for use with
mod_python separate from my main python installation, I had to modify
PATH to get PostgreSQL to install the module in the right place:

  % PATH=/opt/python2.1.2-nothreads/bin/:$PATH ./configure --with-python

(PostgreSQL 7.2, mod_python 2.7.6 and python 2.1.2 on OpenBSD 3.1)

Regards,

Olly.


From barr at cs.cornell.edu  Fri Jul  5 02:14:33 2002
From: barr at cs.cornell.edu (Rimon Barr)
Date: Fri Jan  9 21:52:56 2004
Subject: [mod_python] spyce v1.1.18
Message-ID: <Pine.LNX.4.44.0207050213320.12609-100000@pompom.u.cs.cornell.edu>

SPYCE - Server Python Pages

SPYCE is a drop-in Apache module that supports simple and efficient
Python-based dynamic HTML scripting. Those who like Python and are
familiar with JSP, or PHP, or ASP, should have a look at this engine. It
allows one to generate dynamic HTML content just as easily, using Python
for the dynamic parts. Its modular design makes it very flexible and
extensible. It can also be used as a command-line utility for HTML
pre-processing, and also via CGI or FCGI on other servers.

v1.1.18 released on 5 July 2002.

Get it at:
  http://spyce.sourceforge.net

----------
Partial change log:

v1.1.18
  fcgi support added
  X-Spyce header added
  documentation: how to write new modules

v1.1.17
  feature request - compaction algorithm improved

v1.1.16
  generalised session.setHandler (session handler selection mechanism)
  gdbm, bsd db session handlers added

v1.1.15
  minor makefile and rpm script changes
  handling of multi-line strings in python code
  response.flush() added

v1.1.14
  wrappers to check python version

v1.1.13
  added new language construct: "Python chunks"

v1.1.12
  stdout module redirects stdout to response object
  added writeln() to response module


From jack_diederich at email.com  Mon Jul 29 11:20:21 2002
From: jack_diederich at email.com (Jack Diederich)
Date: Fri Jan  9 21:52:56 2004
Subject: [mod_python] Fw: slow child init problems
Message-ID: <20020729162021.20546.qmail@email.com>

I tried sending this before I was a member of the list, and  I guess it wasn't approved...

I have a project running under mod_python with about 10k of python source.

On a pIII-500 it takes 2 seconds for the first request to an httpd process,
and 0.2 seconds for each request after that to run.  This isn't a show stopper
for now, but it really bugs me (the software will be production in about a month)

I've thought of switching to WebWare, which shouldn't have this problem, but is
otherwise more than I need and the switching costs would be non-zero.

The problem seems to be that the imports, even with the PythonImport directive listing all of them
aren't done until ChildInitHanlder(), which is called the first time a child process
gets its first hit, apparently.  I say apparently because the difference between
using PythonImport or not is zero time-wise.  Using .pyo files instead of .py
cuts the first-hit time in half, but is still five times
larger than the time to handle a second hit.

Why can't the work (whatever it is) be done _before_ the fork of the children?
This is what mod_perl does.  mod_php doesn't, it has some possibly intentional
design problems that require a fresh interperator init and byte compile between
requests (but there are hooks in the code for the $ work-aournd module).
But looking through the python internals I couldn't figure out why this isn't possible. I couldn't figure out where to patch it myself, but I didn't see any showstoppers like with php.

So ... anyone know how to work around this, why its done this way, or where I
should look to patch it?

thanks in advance,
-jackdied

-- 
__________________________________________________________
Sign-up for your own FREE Personalized E-mail at Mail.com
http://www.mail.com/?sr=signup

Get 4 DVDs for $.49 cents! plus shipping & processing. Click to join.
http://adfarm.mediaplex.com/ad/ck/990-1736-3566-59


From grisha at modpython.org  Mon Jul 29 21:36:14 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:56 2004
Subject: [mod_python] Fw: slow child init problems
In-Reply-To: <20020729162021.20546.qmail@email.com>
Message-ID: <Pine.BSF.4.32.0207292038430.25221-100000@localhost>

On Mon, 29 Jul 2002, Jack Diederich wrote:

> The problem seems to be that the imports, even with the PythonImport
> directive listing all of them aren't done until ChildInitHanlder(),
> which is called the first time a child process gets its first hit,
> apparently.  I say apparently because the difference between using
> PythonImport or not is zero time-wise.

[snip]

> Why can't the work (whatever it is) be done _before_ the fork of the
> children?

[snip]

First, you should look at making sure that everything runs under one
sub-interpreter. The information such as the name of the virtual host is
undefined until the actual request comes in, so PythonImport imports
everything under the interpreter named after the directory in the
surrounding <Directory> tag or the main interpreter. Your other code
probably runs in the subinterpreter for that virtual server, so it ends up
reimporting everything again. You can force everything to run under the
main interpreter by specifying "PythonInterpreter main_interpreter".

It's possible that you're right that ChildInit gets executed on the first
hit, I can't answer this off the top of my head without digging in apache
source code or experimenting. The reason PythonImport stuff does not get
executed at Apache startup before it forks is because at that point Apache
is run as root.

IMHO PythonImport is bad and shouldn't be there. I understand the issue,
but PythonImport isn't the cleanest solution to it because of the way it
ends up having be implemented, and I can't think of anything clever that
would address this.

One simple hack to tackle this problem is to add something into your
Apache startup script that initiates the first hit using wget or fetch or
lynx or whatever. I've used this technique very successfuly before.

Grisha


From jack_diederich at email.com  Mon Jul 29 23:24:42 2002
From: jack_diederich at email.com (Jack Diederich)
Date: Fri Jan  9 21:52:56 2004
Subject: [mod_python] How mod_perl does Imports vs mod_python
Message-ID: <20020730042442.7423.qmail@email.com>

Followup to my earlier post about slow init times.
mod_perl only has one interpreter.  It processes
imports as the last thing before leaving the apache
module init function (in mod_python, this would be
python_init())

If the main interpreter exists by the end of python_init()
[I think it does, but I don't know the interpreter internals
at all] we could at least populate that with the PythonImport
directives from httpd.conf

This wouldn't solve the problem for everyone (those using
virtual hosts) but it would at least solve mine :)
Optionally to support virtual hosts there could be a directive to prespawn sub-interpreters and process the 
import directives for those too.

Can any of the mod_python authors comment?  I might be
able to try my hand at a patch in a month, but for now 
I'll just stick with my workaround (ugly combination of a 
proxy and wget)

mod_perl also has a lot of logic to differentiate between a
stop/start and a restart.  In the restart case it actually
does the import _while_ reading the config.  In the fresh
start case it waits until the end of the init function.
I don't know if you can purge or overwrite import info in
a python interpreter like you can with perl. (perl just has
one big namespace plus smaller funciton/loop/etc variables).

Use of globals and macros to access them to keep track of
information about startup, pending imports, etc.

-jackdied


-- 
__________________________________________________________
Sign-up for your own FREE Personalized E-mail at Mail.com
http://www.mail.com/?sr=signup

Get 4 DVDs for $.49 cents! plus shipping & processing. Click to join.
http://adfarm.mediaplex.com/ad/ck/990-1736-3566-59


From peter.bittner at gmx.net  Tue Jul 30 18:54:48 2002
From: peter.bittner at gmx.net (Peter Bittner)
Date: Fri Jan  9 21:52:56 2004
Subject: [mod_python] Configuring Apache
Message-ID: <3055.1028048088@www55.gmx.net>

Hi,

I've got SuSE Linux 8.0, so there are probably the latest stable versions of
mod_python and Apache on my computer. Apache is installed with the
mod_python module (an appropriate message shows up, when the apache server ist
(re)started.)

However, since .py files are obviously not recognized as Python scripts I
have added the following lines to my httpd.conf file in the mime-types section:

    #
    # Python:
    #
    <IfModule mod_python.c>
    AddType application/x-httpd-python .py
    AddHandler python-program .py
    #PythonHandler index
    </IfModule>

Now it comes:
When I remove the comment-character in front of the "PythonHandler"
statement, the Apache server gives me a "500 Server Misconfiguration Error".

Can anyone help me getting .py-scripts running on my Apache?

Cheers, Peter

-- 
Peter Bittner
mobil: +43/(0)650/4151545
web: http://beam.to/peter.bittner - http://beam.to/htmlkurs
mail: peter.bittner@gmx.net

"Free software is like free speech, not free beer" (Richard Stallman)

GMX - Die Kommunikationsplattform im Internet.
http://www.gmx.net


From jack_diederich at email.com  Mon Jul 29 21:02:27 2002
From: jack_diederich at email.com (Jack Diederich)
Date: Fri Jan  9 21:52:56 2004
Subject: [mod_python] Fw: slow child init problems
Message-ID: <20020730020227.9604.qmail@email.com>

[me]
> > Why can't the work (whatever it is) be done _before_ the fork of the
> > children?

[Gregory Trubetskoy]
> First, you should look at making sure that everything runs under one
> sub-interpreter. The information such as the name of the virtual host is
> undefined until the actual request comes in, so PythonImport imports
> everything under the interpreter named after the directory in the
> surrounding <Directory> tag or the main interpreter. Your other code
> probably runs in the subinterpreter for that virtual server, so it ends up
> reimporting everything again. You can force everything to run under the
> main interpreter by specifying "PythonInterpreter main_interpreter".

I'm not running any virtual servers. I tried the directive
and it had the same behavior (first time a process gets
hit it takes 10 times the second and further hits)

> It's possible that you're right that ChildInit gets executed on the first
> hit, I can't answer this off the top of my head without digging in apache
> source code or experimenting. 

I've looked at the code, and it doesn't get called until the
first hit.  BTW, one thing I love about python (and
mod_python) is that the source is incredibly easy to browse
and understand (compare perl internals).

That said, I'm going to go swimming in perl/mod_perl for a
bit to see how they do it. Failing that, maybe I'll hit up
the mod_perl mailing list for help.

thanks,

-jackdied







-- 
__________________________________________________________
Sign-up for your own FREE Personalized E-mail at Mail.com
http://www.mail.com/?sr=signup

Get 4 DVDs for $.49 cents! plus shipping & processing. Click to join.
http://adfarm.mediaplex.com/ad/ck/990-1736-3566-59


From peter.bittner at gmx.net  Tue Jul 30 19:14:32 2002
From: peter.bittner at gmx.net (Peter Bittner)
Date: Fri Jan  9 21:52:56 2004
Subject: [mod_python] Re: Configuring Apache
Message-ID: <6296.1028049272@www55.gmx.net>

Hi,

I've probably found the reason why Apache shows a 500-error. The Apache
error log shows:

  make_obcallback(): could not import mod_python.apache.
  make_obcallback(): could not call init.

This because I tried to execute the following script (index.py):

  from mod_python import apache
  def handler(req):
        req.send_http_header()
        req.write("hello %s" % req.remote_host)
        return apache.OK

And when I run python from the commandline and try this:
  import mod_python
Python tells me it doesn't know any module named mod_python!

How do I fix this problem??

Peter


-- 
Peter Bittner
mobil: +43/(0)650/4151545
web: http://beam.to/peter.bittner - http://beam.to/htmlkurs
mail: peter.bittner@gmx.net

"Free software is like free speech, not free beer" (Richard Stallman)

GMX - Die Kommunikationsplattform im Internet.
http://www.gmx.net


From vmilitaru at sympatico.ca  Tue Jul 30 14:25:47 2002
From: vmilitaru at sympatico.ca (vmilitaru@sympatico.ca)
Date: Fri Jan  9 21:52:57 2004
Subject: [mod_python] Configuring Apache
In-Reply-To: <3055.1028048088@www55.gmx.net>; from peter.bittner@gmx.net on Tue, Jul 30, 2002 at 06:54:48PM +0200
References: <3055.1028048088@www55.gmx.net>
Message-ID: <20020730142546.A979@eye.neb>

Sounds like you haven't read the mod_python (excellent!) docs.
I suggest you start with that. FAQ has also useful tips for your next hurdles.
But the 'fast and dirty' answer to your question is:

PythonHandler publisher

but eventually (hopefully):

PythonHandler your_own_customized_publisher

Cheers,
Vio

* Peter Bittner <peter.bittner@gmx.net> [020730 14:15]:
> Hi,
> 
> I've got SuSE Linux 8.0, so there are probably the latest stable versions of
> mod_python and Apache on my computer. Apache is installed with the
> mod_python module (an appropriate message shows up, when the apache server ist
> (re)started.)
> 
> However, since .py files are obviously not recognized as Python scripts I
> have added the following lines to my httpd.conf file in the mime-types section:
> 
>     #
>     # Python:
>     #
>     <IfModule mod_python.c>
>     AddType application/x-httpd-python .py
>     AddHandler python-program .py
>     #PythonHandler index
>     </IfModule>
> 
> Now it comes:
> When I remove the comment-character in front of the "PythonHandler"
> statement, the Apache server gives me a "500 Server Misconfiguration Error".
> 
> Can anyone help me getting .py-scripts running on my Apache?
> 
> Cheers, Peter
> 
> -- 
> Peter Bittner
> mobil: +43/(0)650/4151545
> web: http://beam.to/peter.bittner - http://beam.to/htmlkurs
> mail: peter.bittner@gmx.net
> 
> "Free software is like free speech, not free beer" (Richard Stallman)
> 
> GMX - Die Kommunikationsplattform im Internet.
> http://www.gmx.net
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

From list-mod_python at empires.org  Tue Jul 30 13:35:34 2002
From: list-mod_python at empires.org (Jeff Davis)
Date: Fri Jan  9 21:52:57 2004
Subject: [mod_python] Configuring Apache
In-Reply-To: <3055.1028048088@www55.gmx.net>
References: <3055.1028048088@www55.gmx.net>
Message-ID: <200207301335.34801.list-mod_python@empires.org>

Here is my configuration information (note: I use the publisher handler, find 
out more about the different built-in handlers at http://www.modpython.org):

AddHandler python-program .py
PythonHandler mod_python.publisher
PythonDebug On

Regards,
	Jeff

On Tuesday 30 July 2002 09:54 am, Peter Bittner wrote:
> Hi,
>
> I've got SuSE Linux 8.0, so there are probably the latest stable versions
> of mod_python and Apache on my computer. Apache is installed with the
> mod_python module (an appropriate message shows up, when the apache server
> ist (re)started.)
>
> However, since .py files are obviously not recognized as Python scripts I
> have added the following lines to my httpd.conf file in the mime-types
> section:
>
>     #
>     # Python:
>     #
>     <IfModule mod_python.c>
>     AddType application/x-httpd-python .py
>     AddHandler python-program .py
>     #PythonHandler index
>     </IfModule>
>
> Now it comes:
> When I remove the comment-character in front of the "PythonHandler"
> statement, the Apache server gives me a "500 Server Misconfiguration
> Error".
>
> Can anyone help me getting .py-scripts running on my Apache?
>
> Cheers, Peter


From peter.bittner at gmx.net  Wed Jul 31 17:40:53 2002
From: peter.bittner at gmx.net (Peter Bittner)
Date: Fri Jan  9 21:52:57 2004
Subject: [mod_python] make_obcallback(): could not import mod_python.apache
References: <200207301335.34801.list-mod_python@empires.org>
Message-ID: <28386.1028130053@www30.gmx.net>

I have mod_python installed on SuSE Linux 8.0 and I have set up my
httpd.conf according to the mod_python documentation, but unfortunately I get the
following error message in my error log:

make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.

I have also tried the import statement in my python interpreter, but it
says:

>>> from mod_python import apache
Traceback (most recent call last):
  File "<stdin>", line 1, in ?
ImportError: No module named mod_python

So there seems to be no mod_python module available! (Where has it gone? -
This doesn't seem to be an ordinary error, does it?) I havn't found any answer
ind the FAQs regarding this problem.

Please help!
Peter


-- 
Peter Bittner
mobil: +43/(0)650/4151545
web: http://beam.to/peter.bittner - http://beam.to/htmlkurs
mail: peter.bittner@gmx.net

"Free software is like free speech, not free beer" (Richard Stallman)

GMX - Die Kommunikationsplattform im Internet.
http://www.gmx.net


From christoph at cocon-seide.com  Wed Jul 31 17:51:45 2002
From: christoph at cocon-seide.com (Christoph Fritzsch)
Date: Fri Jan  9 21:52:57 2004
Subject: [mod_python] Configuring Apache
Message-ID: <200207311554.g6VFsWs48906@eden.ispol.com>

Hi Peter,

I tried it with Suse 7.3 some time ago and found it only workable by 

1) uncommenting all <Ifmodule python>  </if..>

#<IfDefine Python>
LoadModule python_module      /usr/lib/apache/mod_python.so
#</IfDefine>
#<IfDefine Python>
AddModule mod_python.c
#</IfDefine>

so the module is loaded for sure, as I couldnt get it to work with the Suse supplied 
starting parameters

2) Then I put this in there

#Python
#<IfModule mod_python.c>
<Directory "/usr/local/httpd/htdocs/test">
AddHandler python-program .py
PythonHandler mptest
PythonDebug On
</Directory>
#</IfModule>

as you did it

and  I also had to put in a  link 
/usr/lib/python2.1/site-packages/mod_python 
->/usr/lib/apache/lib/python2.1/site-packages/mod_python/

maybe you hv to replace the 2.1 to 2.2

reload apache and any file you call in the test directory will execute the mptest program

This is what the mod_python should do. That is as far as I got. I think next step is to 
expand the mptest program so you can call subroutines in it which presumaly do more 
usefull stuff than "Hello World!" !!

BR Christoph


From daniel at copyleft.no  Sun Jul 14 10:53:01 2002
From: daniel at copyleft.no (Hr. Daniel Mikkelsen)
Date: Fri Jan  9 21:52:58 2004
Subject: [mod_python] Understanding mod_python
In-Reply-To: <1026635587.26526.30.camel@kernel>
Message-ID: <20020714105239.O43368-100000@unity.copyleft.no>

On 14 Jul 2002, Fabian Fagerholm wrote:

> There were also some posts about a mod_python "cookbook", and another
> poster suggested the on-line FAQ would be a good place for the
> "recipes". I totally agree - well-written example code is the best way
> to learn.
> I'd like to suggest that a new category be created in the FAQ for these
> snippets of example code.

Make it a wiki.

-- Daniel


From fabbe at paniq.net  Sun Jul 14 20:34:01 2002
From: fabbe at paniq.net (Fabian Fagerholm)
Date: Fri Jan  9 21:52:58 2004
Subject: [mod_python] Understanding mod_python
In-Reply-To: <290A467D-9742-11D6-9B12-0030653DCC28@attbi.com>
References: <290A467D-9742-11D6-9B12-0030653DCC28@attbi.com>
Message-ID: <1026668042.1616.3.camel@kernel>

On Sun, 2002-07-14 at 18:55, Jeff Stearns wrote:
> Fabian -
> 
> I'd like to review your drawings, but it's not easy for me to view 
> Postscript.  This is probably true for other folks as well.  If you can 
> offer them in another, more generic format, you may get a better 
> response.

Oh, I'm sorry. I thought Postscript was a good format for most people. I
suppose that's a un*x thing, though.

I made PDF versions of the files as well. They're all in
http://www.paniq.net/fabbe/mod_python/

I hope more people can look at the drawings now. Thanks for the
feedback, Jeff!

Cheers,
fabian

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 240 bytes
Desc: This is a digitally signed message part
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20020714/5b977028/attachment-0001.bin
From vmilitaru at sympatico.ca  Sun Jul 14 13:55:37 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 21:52:58 2004
Subject: [mod_python] Ping?
In-Reply-To: <Pine.LNX.4.44.0207131250410.31967-100000@slippy.wire.rat>; from gbenson@redhat.com on Sat, Jul 13, 2002 at 12:51:32PM +0100
References: <Pine.LNX.4.44.0207131250410.31967-100000@slippy.wire.rat>
Message-ID: <20020714135537.A278@eye.neb>

Same here. But even more problematic seems that some messages never make it to 
the list (at least some of my messages never did).
Possible solution (provided this message make it to the list): how about 
migrating modpython to 'sourceforge'? It's totally
free and they do an outstanding hosting job.

Chers,
Vio

* Gary Benson <gbenson@redhat.com> [020714 13:45]:
> 
> It seems that I am getting messages from this list with a four day lag. 
> Is anyone else experiencing this?
> 
> Cheers,
> Gary
> 
> [ gbenson@redhat.com ][ GnuPG 85A8F78B ][ http://inauspicious.org/ ]
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

From kastner.j at supp.cz  Mon Jul 15 09:27:14 2002
From: kastner.j at supp.cz (=?iso-8859-2?Q?Ji=F8=ED_Kastner?=)
Date: Fri Jan  9 21:52:58 2004
Subject: [mod_python] compiled code execution
Message-ID: <003301c22bd1$0ac2e820$0301a8c0@pentium>

i'm interested about possibility to execute .pyc code by adding line to
httpd.conf:

AddHandler python-program .pyc

or if this is nonsense, because python is executing it directly, if is .pyc
present?
why? i'm writing web app. and this one will be distributed to others and i
need eliminate changing code by anybody (some distributions will be running
on win9x).

have anybody experience with this kind of problems?

jiri kastner




From gbenson at redhat.com  Mon Jul 15 10:17:02 2002
From: gbenson at redhat.com (Gary Benson)
Date: Fri Jan  9 21:52:58 2004
Subject: [mod_python] [PATCH] last httpd-2.0.36
Message-ID: <Pine.LNX.4.44.0207151016390.12912-200000@slippy.wire.rat>


Hi,

The attached patch brings the input filtering API in mod_python into line 
with that in httpd-2.0.36.  This is the last thing that I know of that 
needed fixing to work with 2.0.36, although I beleive some more fixes will 
be in order to build against 2.0.39 or whatever it is now :)

Cheers,
Gary

[ gbenson@redhat.com ][ GnuPG 85A8F78B ][ http://inauspicious.org/ ]
-------------- next part --------------
Bring input filter API in line with 2.0.36

Index: src/filterobject.c
===================================================================
RCS file: /cvsroot/modpython/mod_python/src/filterobject.c,v
retrieving revision 1.5
diff -u -r1.5 filterobject.c
--- src/filterobject.c	3 Jun 2002 14:31:15 -0000	1.5
+++ src/filterobject.c	9 Jul 2002 16:21:27 -0000
@@ -61,7 +61,7 @@
  */
 
 PyObject *MpFilter_FromFilter(ap_filter_t *f, apr_bucket_brigade *bb, int is_input,
-			      ap_input_mode_t mode, apr_size_t *readbytes,
+			      ap_input_mode_t mode, apr_size_t readbytes,
 			      char * handler, char *dir)
 {
     filterobject *result;
@@ -86,7 +86,7 @@
 	result->bb_in = bb;
 	result->bb_out = NULL;
 	result->mode = 0;
-	result->readbytes = NULL;
+	result->readbytes = 0;
     }
 
     result->closed = 0;
@@ -142,7 +142,7 @@
 
 	Py_BEGIN_ALLOW_THREADS;
 	self->rc = ap_get_brigade(self->f->next, self->bb_in, self->mode, 
-				  APR_BLOCK_READ, *self->readbytes);
+				  APR_BLOCK_READ, self->readbytes);
 	Py_END_ALLOW_THREADS;
 
 	if (! APR_STATUS_IS_SUCCESS(self->rc)) {
@@ -239,7 +239,7 @@
 
 		Py_BEGIN_ALLOW_THREADS;
 		self->rc = ap_get_brigade(self->f->next, self->bb_in, self->mode, 
-					  APR_BLOCK_READ, *self->readbytes);
+					  APR_BLOCK_READ, self->readbytes);
 		Py_END_ALLOW_THREADS;
 
 		if (! APR_STATUS_IS_SUCCESS(self->rc)) {
Index: src/mod_python.c
===================================================================
RCS file: /cvsroot/modpython/mod_python/src/mod_python.c,v
retrieving revision 1.60
diff -u -r1.60 mod_python.c
--- src/mod_python.c	3 Jun 2002 14:31:15 -0000	1.60
+++ src/mod_python.c	9 Jul 2002 16:21:35 -0000
@@ -1023,7 +1023,8 @@
 static apr_status_t python_filter(int is_input, ap_filter_t *f, 
 				  apr_bucket_brigade *bb,
 				  ap_input_mode_t mode,
-				  apr_size_t *readbytes) {
+				  apr_read_type_e block,
+				  apr_size_t readbytes) {
 
     PyObject *resultobject = NULL;
     interpreterdata *idata;
@@ -1052,8 +1053,7 @@
        so a fitler can spit out an error without causing infinite loop */
     if (ctx->transparent) {
 	if (is_input) 
-	    return ap_get_brigade(f->next, bb, mode, APR_BLOCK_READ, 
-				  *readbytes);
+	    return ap_get_brigade(f->next, bb, mode, block, readbytes);
 	else
 	    return ap_pass_brigade(f->next, bb);
     }
@@ -1201,9 +1201,10 @@
 static apr_status_t python_input_filter(ap_filter_t *f, 
 					apr_bucket_brigade *bb,
 					ap_input_mode_t mode,
-					apr_size_t *readbytes) 
+					apr_read_type_e block,
+					apr_off_t readbytes)
 {
-    return python_filter(1, f, bb, mode, readbytes);
+    return python_filter(1, f, bb, mode, block, readbytes);
 }
 
 
@@ -1216,7 +1217,7 @@
 static apr_status_t python_output_filter(ap_filter_t *f, 
 					 apr_bucket_brigade *bb)
 {
-    return python_filter(0, f, bb, 0, NULL);
+    return python_filter(0, f, bb, 0, 0, 0);
 }
 
 
Index: src/include/filterobject.h
===================================================================
RCS file: /cvsroot/modpython/mod_python/src/include/filterobject.h,v
retrieving revision 1.4
diff -u -r1.4 filterobject.h
--- src/include/filterobject.h	3 Jun 2002 14:31:16 -0000	1.4
+++ src/include/filterobject.h	9 Jul 2002 16:21:36 -0000
@@ -67,7 +67,7 @@
 
 	int is_input;
 	ap_input_mode_t mode;
-	apr_size_t *readbytes;
+	apr_size_t readbytes;
 
 	int closed;
 	int softspace;
@@ -88,7 +88,7 @@
     extern DL_IMPORT(PyObject *) 
 	MpFilter_FromFilter Py_PROTO((ap_filter_t *f, apr_bucket_brigade *bb_in, 
 				      int is_input, ap_input_mode_t mode, 
-				      apr_size_t *readbytes, char *hadler, char *dir));
+				      apr_size_t readbytes, char *hadler, char *dir));
 
 #ifdef __cplusplus
 }
From nicks at metrolink.com  Mon Jul 15 13:19:15 2002
From: nicks at metrolink.com (Nick Seidenman)
Date: Fri Jan  9 21:52:58 2004
Subject: [mod_python] typehandler
Message-ID: <3D330413.9090203@metrolink.com>

Anyone got a quick example of how this one's used?    When I try 
something simple, like:

    def typehandler (req):
        req.content_type = 'text/plain'
        req.send_http_headers ()
        return apache.OK

I just get a listing of the module that contains this.

TiA,
Nick


From rien at yeepa.org  Fri Jul 26 00:12:44 2002
From: rien at yeepa.org (Adrien Plisson)
Date: Fri Jan  9 21:52:59 2004
Subject: [mod_python] please, old fool needs help with getting apache mod_python on windows 98 to run
References: <NDBBIADKLJIPFGPECIJPOELOCMAA.jdaily@kc.rr.com>
Message-ID: <001201c23428$67399b80$03020101@skynet.be>

From: "james daily" <jdaily@kc.rr.com>
>
> the mod_python online manual at:
>
http://www.modpython.org/live/mod_python-2.7.8/doc-html/app-wininst.html
>
> says:
> XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
...
> if someone has it actually running on their windows 98 system,
> could you please send me the ***relevant*** portions from your
> apache httpd.conf file?
>
> i have tried numerous different approaches to no avail.

ok  i posted something about the windows portion of the doc in march of this
year.
take a look at:
http://www.modpython.org/pipermail/mod_python/2002-March/001934.html
at the end of the post there is my correction to the manual, tested on
apache for NT.

now about having just the mptest.py text in your browser there was another
post in the mailing list... don't remember when, probably in april or june.
try to browse it.

> alas, i am a programmer but not (yet) an apache guru.

time will come...

> any help would be greatly appreciated.

done

--
rien



From list-mod_python at empires.org  Tue Jul 16 13:38:19 2002
From: list-mod_python at empires.org (Jeff Davis)
Date: Fri Jan  9 21:52:59 2004
Subject: [mod_python] new to mod_python, with a question.
In-Reply-To: <1026773181.12028.7.camel@locutus>
References: <1026773181.12028.7.camel@locutus>
Message-ID: <200207161338.19702.list-mod_python@empires.org>

Is is possible that you're using the publisher handler? The publisher handler 
basically does a req.write() on whatever is returned by your function. So, it 
looks like it's printing the actual text of apache.OK after all of your 
req.write()s. Look in your apache config for possible use of 
mod_python.publisher, or perhaps something else that might print the return 
of your function.

Regards,
	Jeff

On Monday 15 July 2002 03:46 pm, Bill Anderson wrote:
> OK, so here is what I am doing. I am using PageTemplates (from zope) and
> mod_python. or at least, I am trying to. :)
>
>
> if I do _NOT_ use the request object (i.e. I return a fully formed html
> string/document), it works fine. but of course, that means no use of
> mod-python's request objects functions such as cookie/header
> construction, usage, etc.
>
> To wit:
> def sayit(req,x=12):
> 	if not x:
> 		return "I need x"
> 	if not master:
> 		return "I need a master object"
> 	pt=PageTemplate()
> 	filestring =
> "".join(open("/home/ucntcme/public_html/pythonapps/test.pt").readlines())
> 	pt.write(filestring)
> 	myx=int(x)
>         req.content_type="text/html"
>         req.send_http_headers()
> 	req.write( pt(x=myx,master=master) )
> 	return apache.OK
>
> returns my rendered template, but at the bottom has:
>
> HTTP/1.1 200 OK Date: Mon, 15 Jul 2002 22:44:27 GMT Server:
> Apache/1.3.22 (Unix) (Red-Hat/Linux) mod_python/2.7.8 Python/2.2.1
> mod_ssl/2.8.5 OpenSSL/0.9.6b DAV/1.0.2 PHP/4.0.6 mod_perl/1.26
> Connection: close Transfer-Encoding: chunked Content-Type: text/html;
> charset=iso-8859-1
> OK
> The server encountered an internal error or misconfiguration and was
> unable to complete your request.
>
>
>
> Debug is on, and there are no mesages in the error_log.
>
> Now, if I just return the content using return (content), it works fine.
>
> Why is this/what am I doing wrong here?
>
> Cheers, Bill
>
>
>
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From bill at immosys.com  Tue Jul 16 17:41:41 2002
From: bill at immosys.com (Bill Anderson)
Date: Fri Jan  9 21:52:59 2004
Subject: [mod_python] new to mod_python, with a question.
In-Reply-To: <200207161338.19702.list-mod_python@empires.org>
References: <1026773181.12028.7.camel@locutus> 
	<200207161338.19702.list-mod_python@empires.org>
Message-ID: <1026862902.17401.28.camel@locutus>

On Tue, 2002-07-16 at 14:38, Jeff Davis wrote:
> Is is possible that you're using the publisher handler? The publisher handler 

Yes, I am ...

> basically does a req.write() on whatever is returned by your function. So, it 
> looks like it's printing the actual text of apache.OK after all of your 
> req.write()s. Look in your apache config for possible use of 

Ah, I see. Ok. So now that I know why...

How can I have a funtion that writes all the HTML, and still use
mod_python's cookie functions? can I use them, even though I return
html, instead of the req.writes() and return apache.OK combo?





From tree at basistech.com  Tue Jul 16 22:01:46 2002
From: tree at basistech.com (Tom Emerson)
Date: Fri Jan  9 21:52:59 2004
Subject: [mod_python] freebsd
In-Reply-To: <F1478v6eoHvEmsgTFsF000136d0@hotmail.com>
References: <F1478v6eoHvEmsgTFsF000136d0@hotmail.com>
Message-ID: <15668.53258.78331.46765@magrathea.basistech.com>

Edgar Castanedo writes:
> I have installed Python on FreeBSD from the ports collection. When I
> try and install mod_python (from the ports collection also), a
> message is returned which states that Python needs to be installed
> WITHOUT threads. I am not sure if this is okay since I write lots of
> Python script and don't know how this will affect Pythons
> performance. Can anyone shed some light on this for me as I do not
> want to disable threads if it means that my scripts will not work
> the way they used to.

Unless you are explicitly using threads in your existing Python
scripts, don't worry about. I would not expect the performance to
degrade too much, if at all.

On some systems (e.g., Linux) you can run mod_python with a threaded
Python interpreter without a hitch. Unfortunately if you want to use
mod_python on FreeBSD you'll need to rebuild your Python distribution.

    -tree


-- 
Tom Emerson                                          Basis Technology Corp.
Sr. Computational Linguist                         http://www.basistech.com
  "Beware the lollipop of mediocrity: lick it once and you suck forever"

From gharris at centauri.mb.ca  Wed Jul 17 02:46:24 2002
From: gharris at centauri.mb.ca (George Harrison)
Date: Fri Jan  9 21:52:59 2004
Subject: [mod_python] Installing mod_python on Win98/Apache
Message-ID: <5.1.0.14.2.20020717020135.01dd78a0@pop.mts.net>

After following the instructions in the documentation and copying the files 
from C:\Program Files\Python\lib\mod_python-x\lib\mod_python to C:\Program 
Files\Python\lib\mod_python; when I launch Apache I get the message:

Syntax error on line 194 of c:/program piles/apache 
group/apache/conf/httpd.conf:

Cannot load module
c:/program files/apache group/apache/modules/mod_python.dll
into server: (1157) One of the library files needed to run
this application cannot be found.

line 194 consists of "LoadModule python_module modules/mod_python.dll"
I have added the line "AddModule mod_python.c" after the ClearModuleList 
Directive, but the program doesn't seem to be getting that far in httpd.conf.

Does anyone know what I'm doing wrong?

Thanks

gh


From gharris at centauri.mb.ca  Fri Jul 19 00:30:54 2002
From: gharris at centauri.mb.ca (George Harrison)
Date: Fri Jan  9 21:52:59 2004
Subject: [mod_python] Test, please ignore
Message-ID: <5.1.0.14.2.20020719003018.027ccb90@pop.mb.sympatico.ca>

test


From mark.evans.b at bayer.com  Fri Jul 19 09:59:41 2002
From: mark.evans.b at bayer.com (Mark Evans)
Date: Fri Jan  9 21:52:59 2004
Subject: [mod_python] mod_python and W2K
Message-ID: <200207191657.g6JGvHs84445@eden.ispol.com>

Hi All,

I know this general issue has come up before and I have tried everything I have
found in the archives, but nothing works.  So please bear with me.  I am trying
to get mod_python to run on W2K.  Apache is installed as a service.  My system
configuration is this:

W2K SP2
Apache 1.3.24
Python 2.1.3
mod_python-2.7.6

Environment variables:
path contains  C:\Python21\;
PYTHONPATH = C:\Program Files\Apache Group\Apache\htdocs\python  (this was added
per an archive post, doesn't work with or without it)

From gerard.patel at nerim.net  Mon Jul  1 23:43:06 2002
From: gerard.patel at nerim.net (Gerard Patel)
Date: Fri Jan  9 21:59:25 2004
Subject: [mod_python] Apache 2.0.39 and publisher
Message-ID: <1.5.4.32.20020701214306.417866e0@pop.nerim.net>

Hello,

First thing first : I'm a rank beginner with Apache *and* Python :-)

I want to learn both and am trying to setup a very small web site
to test.
I am giving mod_python a try, with Apache 2.0.39, mod_python
from CVS, Python 2.2

Hum, a little question : docu states that Python should be compiled
with no threading support, however in the code I see a 
WITH_THREAD flag, is this restriction still valid for current
CVS ? It seems to work, but my testing is somewhat 
limited for now.

Now, the problems :

First problem : mod_python does not compile

fix :

--- requestobject.c.orig        Mon Jun  3 16:31:15 2002
+++ requestobject.c     Sun Jun 30 11:05:05 2002
@@ -743,7 +743,6 @@
     {"bytes_sent",         T_LONG,      OFF(bytes_sent),           RO},
     {"mtime",              T_LONG,      OFF(mtime),                RO},
     {"chunked",            T_INT,       OFF(chunked),              RO},
-    {"boundary",           T_STRING,    OFF(boundary),             RO},
     {"range",              T_STRING,    OFF(range),                RO},
     {"clength",            T_LONG,      OFF(clength),              RO},
     {"remaining",          T_LONG,      OFF(remaining),            RO},

The Apache guys removed this field from the last version I downloaded
(the aborted 2.0.37) and 2.0.39. Strange.


Second problem : the publisher.

I test it with a minimal app that just displays the one field of
my page :

def Bouton1(req, TextField1):

    s = TextField1
    return s

It works fine, but if I reload the form immediately after, it does
not work unless I wait about 15 seconds.

Fix :
--- apache.py.orig      Wed Apr 10 23:24:24 2002
+++ apache.py   Mon Jul  1 23:21:25 2002
@@ -399,8 +399,9 @@

         # but is it in the path?
         file = module.__dict__.get("__file__")
-        if not file or (path and not file in path):
-                raise SERVER_RETURN, HTTP_NOT_FOUND
+       pathfile, filefile = os.path.split(file)
+        if not file or (path and not pathfile in path):
+               raise SERVER_RETURN, HTTP_NOT_FOUND

         if autoreload:
             oldmtime = module.__dict__.get("__mtime__", 0)

I suspect that this is not elegant Python or even correct, 
please remember that I have written a grand total of about 
300 lines of Python so far.

Anyway, with the change it seems to work better at least.

Thanks for your comments, I am ready to try any
better ideas that you want me to test, and sorry
if I have just misconfigured the beast; I have read
the archive a bit and seen something similar
to my second problem, but no solution AFAICT.


Gerard Patel


From mateusz at ant.gliwice.pl  Wed Jul  3 00:57:10 2002
From: mateusz at ant.gliwice.pl (Mateusz Korniak)
Date: Fri Jan  9 21:59:25 2004
Subject: [mod_python] How to make 307 Temporary Redirect using mod_python ?
Message-ID: <200207022257.g62MvFs10490@eden.ispol.com>

I can't make temporary redirect using mod_python.

I tried code:

def handler(req):
	# some code genereting url - where to redirect
	req.headers_out["Location"] = url
	req.send_http_header()
	return apache.HTTP_TEMPORARY_REDIRECT

but it produces such (not as intended) HTTP talk:

browser:
GET /abbon/advsel/advsel.py?a=1;u=388 HTTP/1.1
Connection: Keep-Alive
User-Agent: Mozilla/5.0 (compatible; Konqueror/2.2-11; Linux)
Pragma: no-cache
Cache-control: no-cache
Accept: text/*, image/jpeg, image/png, image/*, */*
Accept-Encoding: x-gzip, gzip, identity
Accept-Charset: iso-8859-2, utf-8, *
Accept-Language: en_GB, pl_PL, en
Host: appserver.ant.cipe
Cookie: SES=1

server response:
HTTP/1.1 200 OK
Date: Tue, 02 Jul 2002 21:14:01 GMT
Server: Apache/1.3.23 (Unix)  (Red-Hat/Linux) mod_python/2.7.8 Python/1.5.2
Location: http://www.noblisci.bnet.pl
Connection: close
Transfer-Encoding: chunked
Content-Type: text/plain

21c
HTTP/1.1 200 OK
Date: Tue, 02 Jul 2002 21:14:01 GMT
Server: Apache/1.3.23 (Unix)  (Red-Hat/Linux) mod_python/2.7.8 Python/1.5.2
Location: http://www.noblisci.bnet.pl
Connection: close
Transfer-Encoding: chunked
Content-Type: text/html; charset=iso-8859-1

<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<HTML><HEAD>
<TITLE>200 OK</TITLE>
</HEAD><BODY>
<H1>OK</H1>
The document has moved <A HREF="http://www.noblisci.bnet.pl">here</A>.<P>
<HR>
<ADDRESS>Apache/1.3.23 Server at appserver.ant.cipe Port 80</ADDRESS>
</BODY></HTML>


Server returns HTTP/1.1 200 OK instead of 307 <whatever> ...
What I'm doing wrong ?
TIA for any help.

-- 
Mateusz Korniak


From ps0 at igmp.com.ar  Tue Jul  2 19:48:03 2002
From: ps0 at igmp.com.ar (ps0@igmp.com.ar)
Date: Fri Jan  9 21:59:25 2004
Subject: [mod_python] Problems creating files from mod_python
Message-ID: <20020702194803.A27995@igmp.com.ar>

Apache: 1.3.24
mod_python: 2.7.8
Python: 2.2 (w/threads) [i have to recompile it
without threads]


fd=open("/tmp/bleh.txt", "w")
fd.write("HOLA\n")
fd.close()

On the fd.close() it make this error:
IOError: [Errno 9] Bad file Descriptor 

The file is created but i can't write on it.


The perms are corectly applied, from a python script ( out of apache )
the thinks work ok.

Sugestions apreciated.

Tnks in advance.

Hector.

From peter at webreply.com  Tue Jul  2 19:21:37 2002
From: peter at webreply.com (Peter McA'Nulty)
Date: Fri Jan  9 21:59:25 2004
Subject: [mod_python] How to make 307 Temporary Redirect using mod_python ?
References: <200207022257.g62MvFs10490@eden.ispol.com>
Message-ID: <000701c2221f$36f8a2b0$0201a8c0@Peter8100>

before you call req.send_http_header(), you have to set the req.status
field:
req.status = HTTP_TEMPORARY_REDIRECT

peter

----- Original Message -----
From: "Mateusz Korniak" <mateusz@ant.gliwice.pl>
To: <mod_python@modpython.org>
Sent: Tuesday, July 02, 2002 6:57 PM
Subject: [mod_python] How to make 307 Temporary Redirect using mod_python ?


> I can't make temporary redirect using mod_python.
>
> I tried code:
>
> def handler(req):
> # some code genereting url - where to redirect
> req.headers_out["Location"] = url
> req.send_http_header()
> return apache.HTTP_TEMPORARY_REDIRECT
>
> but it produces such (not as intended) HTTP talk:
>
> browser:
> GET /abbon/advsel/advsel.py?a=1;u=388 HTTP/1.1
> Connection: Keep-Alive
> User-Agent: Mozilla/5.0 (compatible; Konqueror/2.2-11; Linux)
> Pragma: no-cache
> Cache-control: no-cache
> Accept: text/*, image/jpeg, image/png, image/*, */*
> Accept-Encoding: x-gzip, gzip, identity
> Accept-Charset: iso-8859-2, utf-8, *
> Accept-Language: en_GB, pl_PL, en
> Host: appserver.ant.cipe
> Cookie: SES=1
>
> server response:
> HTTP/1.1 200 OK
> Date: Tue, 02 Jul 2002 21:14:01 GMT
> Server: Apache/1.3.23 (Unix)  (Red-Hat/Linux) mod_python/2.7.8
Python/1.5.2
> Location: http://www.noblisci.bnet.pl
> Connection: close
> Transfer-Encoding: chunked
> Content-Type: text/plain
>
> 21c
> HTTP/1.1 200 OK
> Date: Tue, 02 Jul 2002 21:14:01 GMT
> Server: Apache/1.3.23 (Unix)  (Red-Hat/Linux) mod_python/2.7.8
Python/1.5.2
> Location: http://www.noblisci.bnet.pl
> Connection: close
> Transfer-Encoding: chunked
> Content-Type: text/html; charset=iso-8859-1
>
> <!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
> <HTML><HEAD>
> <TITLE>200 OK</TITLE>
> </HEAD><BODY>
> <H1>OK</H1>
> The document has moved <A HREF="http://www.noblisci.bnet.pl">here</A>.<P>
> <HR>
> <ADDRESS>Apache/1.3.23 Server at appserver.ant.cipe Port 80</ADDRESS>
> </BODY></HTML>
>
>
> Server returns HTTP/1.1 200 OK instead of 307 <whatever> ...
> What I'm doing wrong ?
> TIA for any help.
>
> --
> Mateusz Korniak
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>



From pk1u at yahoo.com  Tue Jul  2 19:33:07 2002
From: pk1u at yahoo.com (Praveen Kumar)
Date: Fri Jan  9 21:59:25 2004
Subject: [mod_python] shared object files
Message-ID: <20020703023307.85661.qmail@web10403.mail.yahoo.com>

How do I make mod_python aware of the location of
shared object files ?

My system consists of rh7.2, apache1.3.26,
mod_python-2.7.8, python2.1.3


Eg, I'm trying to use the DCOracle2 db module; it uses
Oracle's libclntsh.so.9.0 ; I see the following when
my program accesses the DCOracle2 module:

  File
"/usr/lib/python2.1/site-packages/DCOracle2/__init__.py",
line 37, in ?
    from DCOracle2 import   *

  File
"/usr/lib/python2.1/site-packages/DCOracle2/DCOracle2.py",
line 104, in ?
    import dco2

ImportError: libclntsh.so.9.0: cannot open shared
object file: No such file or directory



I've tried the following:

Placed libclntsh.so.9.0 in /oralib and:

Placed /oralib in the PythonPath directive:

eg; httpd.conf:

<Directory /usr/local/apache/htdocs>
    AddHandler python-program .py
    PythonPath "sys.path+[ ...., '/oralib']"
    PythonHandler reqhandler
    PythonDebug On 
</Directory>

--

set LD_LIBRARY_PATH from the same shell where I start
apache:

export LD_LIBRARY_PATH=/oralib

--

Placed libclntsh.so.9.0 in
/usr/lib/python2.1/site-packages/DCOracle2 .

None of these work. The DCOracle2 module works fine
when I use it from a standalone program. Any
suggestions would be greatly appreciated.

pk


__________________________________________________
Do You Yahoo!?
Sign up for SBC Yahoo! Dial - First Month Free
http://sbc.yahoo.com

From lisicky at datis.cdrail.cz  Wed Jul  3 09:22:38 2002
From: lisicky at datis.cdrail.cz (Jiri Lisicky)
Date: Fri Jan  9 21:59:25 2004
Subject: [mod_python] Problems creating files from mod_python
In-Reply-To: <20020702194803.A27995@igmp.com.ar>
References: <20020702194803.A27995@igmp.com.ar>
Message-ID: <ch95ius9pgmdhso3cnuc6fv6m034o12p8j@4ax.com>

On Tue, 2 Jul 2002 19:48:03 -0300, you wrote:

>Apache: 1.3.24
>mod_python: 2.7.8
>Python: 2.2 (w/threads) [i have to recompile it
>without threads]
>
>
>fd=open("/tmp/bleh.txt", "w")
>fd.write("HOLA\n")
>fd.close()
>
>On the fd.close() it make this error:
>IOError: [Errno 9] Bad file Descriptor 
>
>The file is created but i can't write on it.
>
>
>The perms are corectly applied, from a python script ( out of apache )
>the thinks work ok.
>
>Sugestions apreciated.
Exists file /tmp/bleh.txt before running script from mod_python? 
Maybe you create this file by generic python script under your
username. When call it under mod_python, it is under apache account =
permission problem.
--
        Ji?? Lisick?                      ?D KM?P Olomouc
e-mail: lisicky@datis.cdrail.cz           V?de?sk? 15
 phone: +420-068-578-2272                 Olomouc, Czech Republic
              >>> ?e?tina ISO-8859-2 Compatible <<<

From R.Barrett at ftel.co.uk  Wed Jul  3 10:00:19 2002
From: R.Barrett at ftel.co.uk (Richard Barrett)
Date: Fri Jan  9 21:59:26 2004
Subject: [mod_python] Zope
In-Reply-To: <20010830170753.B23002@godel>
Message-ID: <5.1.0.14.2.20020703095730.00b08148@pop.ftel.co.uk>

At 17:07 30/08/2001 +0200, riesch@nieuw.nl wrote:
>Hi there,
>
>
>Off-topic as it is :
>
>Has anyone experience with using zope and more specificaly with its 
>database ? Is it possible to separate the database from the 
>zope-architecture ? I can't figure out how .. but it would be usefull 
>since it looks nice
>
>
>Thanks ahead,
>Richard

You want http://www.amk.ca/zodb/ and http://www.zope.org/Products/StandaloneZODB


From s_lott at yahoo.com  Wed Jul  3 03:56:37 2002
From: s_lott at yahoo.com (Steven Lott)
Date: Fri Jan  9 21:59:26 2004
Subject: [mod_python] Zope
In-Reply-To: <5.1.0.14.2.20020703095730.00b08148@pop.ftel.co.uk>
Message-ID: <20020703105637.12600.qmail@web9606.mail.yahoo.com>

The ZOPE (Z Object Persistence Environment) Object database
(ZODB), once known as BOBOBase, is available as a separate
download from ZOPE.org.

http://www.python.org/workshops/2000-01/proceedings/papers/fulton/zodb3.html

http://www.python.org/topics/database/persistence.html

http://www.zope.org/Members/michel/HowTos/ZODB-How-To

--- Richard Barrett <R.Barrett@ftel.co.uk> wrote:
> At 17:07 30/08/2001 +0200, riesch@nieuw.nl wrote:
> >Hi there,
> >
> >
> >Off-topic as it is :
> >
> >Has anyone experience with using zope and more specificaly
> with its 
> >database ? Is it possible to separate the database from the 
> >zope-architecture ? I can't figure out how .. but it would be
> usefull 
> >since it looks nice
> >
> >
> >Thanks ahead,
> >Richard
> 
> You want http://www.amk.ca/zodb/ and
> http://www.zope.org/Products/StandaloneZODB
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


=====
--
S. Lott, CCP :-{)
S_LOTT@YAHOO.COM
http://www.mindspring.com/~slott1
Buccaneer #468: KaDiMa

Macintosh user: drinking upstream from the herd.

__________________________________________________
Do You Yahoo!?
Yahoo! - Official partner of 2002 FIFA World Cup
http://fifaworldcup.yahoo.com

From lawrence_jesse at yahoo.ca  Wed Jul  3 08:24:55 2002
From: lawrence_jesse at yahoo.ca (Jesse Lawrence)
Date: Fri Jan  9 21:59:26 2004
Subject: [mod_python] make problems
Message-ID: <20020703122455.30604.qmail@web11303.mail.yahoo.com>

Hello everyone,

I've tried finding an answer to this in the mailing
list archive, but haven't been successful. I run the
following:

./configure --with-apxs=/usr/sbin/apxs 

and it seems to be fine, but when I run make dso or
just make, I get the following message:

[jalaw@soniceast mod_python-2.7.8]# make dso
make[1]: Entering directory
`/home/jalaw/mod_python-2.7.8/src'
gcc  -I/home/jalaw/mod_python-2.7.8/src/include
-I/usr/include/apache -I/usr/include/python2.1    -c
-o mod_python.o mod_python.c
In file included from mod_python.c:54:
/home/jalaw/mod_python-2.7.8/src/include/mod_python.h:77:20:
Python.h: No such file or directory
/home/jalaw/mod_python-2.7.8/src/include/mod_python.h:78:26:
structmember.h: No
such file or directory
make[1]: *** [mod_python.o] Error 1
make[1]: Leaving directory
`/home/jalaw/mod_python-2.7.8/src'
make: *** [do_dso] Error 2

Can anyone please tell me what is happening here?  Any
help will be greatly appreciated.

Thank you,

Jesse Lawrence

______________________________________________________________________ 
Post your ad for free now! http://personals.yahoo.ca

From fuf at mobil.cz  Wed Jul  3 14:31:23 2002
From: fuf at mobil.cz (Michal Vitecek)
Date: Fri Jan  9 21:59:26 2004
Subject: [mod_python] make problems
In-Reply-To: <20020703122455.30604.qmail@web11303.mail.yahoo.com>
References: <20020703122455.30604.qmail@web11303.mail.yahoo.com>
Message-ID: <20020703123123.GJ28418@diana.mobil.cz>

 you're missing the python header files. most probably because you are on
 some system with package system and haven't installed the appropriate
 package. for RH this could be python-devel-something.

Jesse Lawrence wrote:
>Hello everyone,
>
>I've tried finding an answer to this in the mailing
>list archive, but haven't been successful. I run the
>following:
>
>./configure --with-apxs=/usr/sbin/apxs 
>
>and it seems to be fine, but when I run make dso or
>just make, I get the following message:
>
>[jalaw@soniceast mod_python-2.7.8]# make dso
>make[1]: Entering directory
>`/home/jalaw/mod_python-2.7.8/src'
>gcc  -I/home/jalaw/mod_python-2.7.8/src/include
>-I/usr/include/apache -I/usr/include/python2.1    -c
>-o mod_python.o mod_python.c
>In file included from mod_python.c:54:
>/home/jalaw/mod_python-2.7.8/src/include/mod_python.h:77:20:
>Python.h: No such file or directory
>/home/jalaw/mod_python-2.7.8/src/include/mod_python.h:78:26:
>structmember.h: No
>such file or directory
>make[1]: *** [mod_python.o] Error 1
>make[1]: Leaving directory
>`/home/jalaw/mod_python-2.7.8/src'
>make: *** [do_dso] Error 2
>
>Can anyone please tell me what is happening here?  Any
>help will be greatly appreciated.
>
>Thank you,
>
>Jesse Lawrence
>
>______________________________________________________________________ 
>Post your ad for free now! http://personals.yahoo.ca
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://www.modpython.org/mailman/listinfo/mod_python

-- 
		fuf		(fuf@mobil.cz)

From clee at spiralis.merseine.nu  Wed Jul  3 07:52:00 2002
From: clee at spiralis.merseine.nu (clee@spiralis.merseine.nu)
Date: Fri Jan  9 21:59:26 2004
Subject: [mod_python] make problems
In-Reply-To: <20020703122455.30604.qmail@web11303.mail.yahoo.com>
References: <20020703122455.30604.qmail@web11303.mail.yahoo.com>
Message-ID: <15650.62320.759265.205900@spiralis.merseine.nu>

>>>>> "Jesse" == Jesse Lawrence <lawrence_jesse@yahoo.ca> writes:

    Jesse> Hello everyone, I've tried finding an answer to this in the
    Jesse> mailing list archive, but haven't been successful. I run
    Jesse> the following:

    Jesse> ./configure --with-apxs=/usr/sbin/apxs

On my linux system, I need to specify where the python source
distribution is.  For example:

  ./configure  --with-apxs=/usr/sbin/apxs --with-python=/usr/local/src/Python-2.1.3


From lawrence_jesse at yahoo.ca  Wed Jul  3 09:58:15 2002
From: lawrence_jesse at yahoo.ca (Jesse Lawrence)
Date: Fri Jan  9 21:59:26 2004
Subject: [mod_python] make problems
In-Reply-To: <20020703123123.GJ28418@diana.mobil.cz>
Message-ID: <20020703135815.41942.qmail@web11303.mail.yahoo.com>

Thanks a lot for the pointer.  It did the trick.  Now
I'm having problems with my apache configuration. 
I've got the AddModule and 
LoadModule ok, but I'm a little confused as to the
proper way to set up the AddHandler and PythonHandler,
the documentation seems a little hazy on this point. 
Any help will be greatly appreciated,
Thanks,
Jesse

--- Michal Vitecek <fuf@mobil.cz> wrote:
>  you're missing the python header files. most
> probably because you are on
>  some system with package system and haven't
> installed the appropriate
>  package. for RH this could be
> python-devel-something.
> 
> Jesse Lawrence wrote:
> >Hello everyone,
> >
> >I've tried finding an answer to this in the mailing
> >list archive, but haven't been successful. I run
> the
> >following:
> >
> >./configure --with-apxs=/usr/sbin/apxs 
> >
> >and it seems to be fine, but when I run make dso or
> >just make, I get the following message:
> >
> >[jalaw@soniceast mod_python-2.7.8]# make dso
> >make[1]: Entering directory
> >`/home/jalaw/mod_python-2.7.8/src'
> >gcc  -I/home/jalaw/mod_python-2.7.8/src/include
> >-I/usr/include/apache -I/usr/include/python2.1   
> -c
> >-o mod_python.o mod_python.c
> >In file included from mod_python.c:54:
>
>/home/jalaw/mod_python-2.7.8/src/include/mod_python.h:77:20:
> >Python.h: No such file or directory
>
>/home/jalaw/mod_python-2.7.8/src/include/mod_python.h:78:26:
> >structmember.h: No
> >such file or directory
> >make[1]: *** [mod_python.o] Error 1
> >make[1]: Leaving directory
> >`/home/jalaw/mod_python-2.7.8/src'
> >make: *** [do_dso] Error 2
> >
> >Can anyone please tell me what is happening here? 
> Any
> >help will be greatly appreciated.
> >
> >Thank you,
> >
> >Jesse Lawrence
> >
>
>______________________________________________________________________
> 
> >Post your ad for free now!
> http://personals.yahoo.ca
> >_______________________________________________
> >Mod_python mailing list
> >Mod_python@modpython.org
>
>http://www.modpython.org/mailman/listinfo/mod_python
> 
> -- 
> 		fuf		(fuf@mobil.cz)
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


______________________________________________________________________ 
Post your ad for free now! http://personals.yahoo.ca

From ps0 at igmp.com.ar  Wed Jul  3 11:35:08 2002
From: ps0 at igmp.com.ar (ps0@igmp.com.ar)
Date: Fri Jan  9 21:59:26 2004
Subject: [mod_python] Problems creating files from mod_python
In-Reply-To: <ch95ius9pgmdhso3cnuc6fv6m034o12p8j@4ax.com>; from lisicky@datis.cdrail.cz on Wed, Jul 03, 2002 at 09:22:38AM +0200
References: <20020702194803.A27995@igmp.com.ar> <ch95ius9pgmdhso3cnuc6fv6m034o12p8j@4ax.com>
Message-ID: <20020703113508.A11838@igmp.com.ar>

On Wed, Jul 03, 2002 at 09:22:38AM +0200, Jiri Lisicky wrote:
> On Tue, 2 Jul 2002 19:48:03 -0300, you wrote:
> 
> >Apache: 1.3.24
> >mod_python: 2.7.8
> >Python: 2.2 (w/threads) [i have to recompile it
> >without threads]
> >
> >
> >fd=open("/tmp/bleh.txt", "w")
> >fd.write("HOLA\n")
> >fd.close()
> >
> >On the fd.close() it make this error:
> >IOError: [Errno 9] Bad file Descriptor 
> >
> >The file is created but i can't write on it.
> >
> >
> >The perms are corectly applied, from a python script ( out of apache )
> >the thinks work ok.
> >
> >Sugestions apreciated.
> Exists file /tmp/bleh.txt before running script from mod_python? 
> Maybe you create this file by generic python script under your
> username. When call it under mod_python, it is under apache account =
> permission problem.
> --
>         Ji?? Lisick?                      ?D KM?P Olomouc
> e-mail: lisicky@datis.cdrail.cz           V?de?sk? 15
>  phone: +420-068-578-2272                 Olomouc, Czech Republic
>               >>> ?e?tina ISO-8859-2 Compatible <<<
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

no , the file doesn't exist before running the script in mod_python, i
aready check that.

Regards

From gerard.patel at nerim.net  Wed Jul  3 17:42:14 2002
From: gerard.patel at nerim.net (Gerard Patel)
Date: Fri Jan  9 21:59:26 2004
Subject: [mod_python] Problems creating files from mod_python
Message-ID: <1.5.4.32.20020703154214.4178bebc@pop.nerim.net>

At 11:35 AM 7/3/02 -0300, you wrote:

(...)
>> >On the fd.close() it make this error:
>> >IOError: [Errno 9] Bad file Descriptor 
>> >
>> >The file is created but i can't write on it.
>> >
>> >
>> >The perms are corectly applied, from a python script ( out of apache )
>> >the thinks work ok.
>
>
>no , the file doesn't exist before running the script in mod_python, i
>aready check that.

Maybe you could check by hand if the apache user has
the correct rights ? Here is what I would do in the same
situation - on my system Apache runs as nobody :

su
<enter root password>

su nobody

try to create a file; if it fails, the user has no rights and it's
a system configuration question.

Hope this helps

Gerard Patel



From vmilitaru at sympatico.ca  Wed Jul  3 15:32:39 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 21:59:26 2004
Subject: [mod_python] Tips and Tricks initiative
Message-ID: <20020703153239.A772@eye.neb>

Hello,
Inspired by Apache's excellent "URL Rewriting Guide" (http://httpd.apache.org/docs/misc/rewriteguide.html), I would like to suggest that the mod_python maintainers compile a similar document, focussed exclusively on short, practical tricks and tips documenting how mod_python can help to solve some typical problems. This would, to some extent, cut off on redundant posts to the list, as well as help spread knowledge from the more experienced to the more 'mod_python challenged' (like myself). There is no better selling argument for mod_python than a few well written lines of 'mod_python' code ...

An example of a possible entry to the 'mod_python Tips&Tricks' list:


Generic Redirect

Description:
  problem description blah blah ... In this example: basically simulating mod_rewrite in mod_python.

Solution:
  additional blah blah explaining how we are going to brilliantly solve that mind boggling problem in 2 lines of code ...

  def handler(REQUEST):
    # some code generating our url goes here

    url = 'http://www.yahoo.com' # an example url to test the redirect code
    REQUEST.headers_out["Location"] = url
    REQUEST.status = 302
    REQUEST.send_http_header()


For instance, I'd be very interested to read in such a tricks and tips list how to avoid the overhead of creating a database connection at each call to 'handler'. And so on.

Cheers, Vio

From vmilitaru at sympatico.ca  Wed Jul  3 16:10:32 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 21:59:26 2004
Subject: [mod_python] Tips and Tricks initiative ... some followup contribution
Message-ID: <20020703161032.A828@eye.neb>

Generic Cookies

Description:
  How do we bake cookies in mod_python?

Solution:
  def handler(REQUEST):
    header_key = 'Set-Cookie'
    # set cookie values
    for header_value in (
'MyCookie1Var=homepop-shown=1; expires=Wed, 03-Jul-2002 05:18:07 GMT; path=/; domain=zzzz;', 
'MyCookie2Var=homepop-shown=0; expires=Wed, 03-Jul-2002 05:18:07 GMT; path=/; domain=zzzz;',
'MyCookieN=homepop-shown=0; expires=Wed, 03-Jul-2002 05:18:07 GMT; path=/; domain=zzzz;'
    ):
      REQUEST.headers_out.add(header_key,header_value)

    # set additional header arguments here

    # send header to client
    REQUEST.send_http_header()
    return apache.OK

From vmilitaru at sympatico.ca  Wed Jul  3 16:37:49 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 21:59:26 2004
Subject: [mod_python] Tips and Tricks initiative ... some followup contribution /3
Message-ID: <20020703163749.A873@eye.neb>

Already reaching the bottom of my mod_python tricks basket:


REQUEST Attributes Made Easy

Description:
  How can I see all REQUEST's attributes in one swoop.

Solution:
  (one amongst many, I believe)

  def handler(REQUEST):
      # set headers
      REQUEST.content_type = "text/html"
      REQUEST.send_http_header()

      # list all REQUEST's attributes
      REQUEST.write('<HTML><BODY>\n\n')
      for item in dir(REQUEST):
              exec('x = REQUEST.' + str(item))
              REQUEST.write('REQUEST.' + str(item) + ' = ' + str(x))
              REQUEST.write('\n\n<BR>\n\n')

      REQUEST.write('\n\n</BODY></HTML>\n')
      return apache.OK

I hope some may find these little code snipplets useful. I guess other tips&tricks are similarly welcome.

Cheers, Vio

From alain at onesite.org  Wed Jul  3 22:49:47 2002
From: alain at onesite.org (Alain Tesio)
Date: Fri Jan  9 21:59:26 2004
Subject: [mod_python] Tips and Tricks initiative
In-Reply-To: <20020703153239.A772@eye.neb>
References: <20020703153239.A772@eye.neb>
Message-ID: <20020703224947.403225e9.alain@onesite.org>

On Wed, 3 Jul 2002 15:32:39 -0500
vio <vmilitaru@sympatico.ca> wrote:

Technically a wiki is nice for public contributions :
http://moin.sourceforge.net/

> For instance, I'd be very interested to read in such a tricks and tips list how to avoid the
> overhead of creating a database connection at each call to 'handler'. And so on.

Just make the connection a global variable.

Alain


From dustin at ywlcs.org  Wed Jul  3 16:01:39 2002
From: dustin at ywlcs.org (Dustin Mitchell)
Date: Fri Jan  9 21:59:26 2004
Subject: [mod_python] Tips and Tricks initiative ... some followup contribution /3
In-Reply-To: <20020703163749.A873@eye.neb>
References: <20020703163749.A873@eye.neb>
Message-ID: <20020703210138.GQ9517@eleanor.internal.ywlcs.org>

On Wed, Jul 03, 2002 at 04:37:49PM -0500, vio wrote:
> Already reaching the bottom of my mod_python tricks basket:
> 
> 
> REQUEST Attributes Made Easy
> 
> Description:
>   How can I see all REQUEST's attributes in one swoop.
> 
> Solution:
>   (one amongst many, I believe)
> 
>   def handler(REQUEST):
>       # set headers
>       REQUEST.content_type = "text/html"
>       REQUEST.send_http_header()
> 
>       # list all REQUEST's attributes
>       REQUEST.write('<HTML><BODY>\n\n')
>       for item in dir(REQUEST):
>               exec('x = REQUEST.' + str(item))
>               REQUEST.write('REQUEST.' + str(item) + ' = ' + str(x))
>               REQUEST.write('\n\n<BR>\n\n')
 let's avoid 'exec'; how about
                x = getattr(REQUEST, item)
                REQUEST.write('REQUEST.%s = %s\n\n<br>\n\n' % item, `x`)
> 
>       REQUEST.write('\n\n</BODY></HTML>\n')
>       return apache.OK

-- 

  Dustin Mitchell
  dustin@ywlcs.org
  http://people.cs.uchicago.edu/~dustin/

From vmilitaru at sympatico.ca  Wed Jul  3 17:38:49 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 21:59:26 2004
Subject: [mod_python] Tips and Tricks initiative
In-Reply-To: <20020703224947.403225e9.alain@onesite.org>; from alain@onesite.org on Wed, Jul 03, 2002 at 10:49:47PM +0200
References: <20020703153239.A772@eye.neb> <20020703224947.403225e9.alain@onesite.org>
Message-ID: <20020703173849.A937@eye.neb>

* Alain Tesio <alain@onesite.org> [020703 17:11]:

> > For instance, I'd be very interested to read in such a tricks and tips list how to avoid the
> > overhead of creating a database connection at each call to 'handler'. And so on.
> 
> Just make the connection a global variable.

I think I tried that, initialized the db connection at the module level. But somehow my cursor got corrupted, or something. I forgot oracle's error number, only that my workaround was to do something like (we're at module level here):

db = DCOracle2.connect(my_login_string)
def get_db_cursor():
    "create database connection"
    cursor = db.cursor() # Allocate a cursor
    return cursor

In fact I see that I am re-using the same connection here, so let me re-phrase my initial question: how do I re-use the same *cursor* (or it this a bad idea in the first place). I wonder what would happen in such a multi-threaded environment (well, I'm saling in Linuxland) where multiple httpd instances will hit on the db server (ora8i in my case) with the same cursor *concurrently* (never got to that point of desperation, though - but just from contemplating such possibility sounds like total anarchy). What I did try but eventually got an error on was to re-use the same cursor sequentially (in a non-threaded application).

Cheers, Vio

From alain at onesite.org  Thu Jul  4 00:06:08 2002
From: alain at onesite.org (Alain Tesio)
Date: Fri Jan  9 21:59:26 2004
Subject: [mod_python] Tips and Tricks initiative
In-Reply-To: <20020703173849.A937@eye.neb>
References: <20020703153239.A772@eye.neb>
	<20020703224947.403225e9.alain@onesite.org>
	<20020703173849.A937@eye.neb>
Message-ID: <20020704000608.5bf2dea3.alain@onesite.org>

On Wed, 3 Jul 2002 17:38:49 -0500
vio <vmilitaru@sympatico.ca> wrote:

> In fact I see that I am re-using the same connection here, so let me re-phrase my initial
> question: how do I re-use the same *cursor* (or it this a bad idea in the first place).

I think a cursor is not designed to be re-used, what I usually do with cursors is:

- open it
- execute a query
- fetch the rows
- close and remove it (manually with del)

Maybe I'm wrong and a closed cursor can be reopened, I have no idea what
ressources it takes just to create it.

If this works and you want to do it, it can't be shared by two users, you can
use a pool of reusable cursors in a global variable, with a correct lock handling
to make sure you don't get the same cursor from the pool for two users.

Alain

From barr at cs.cornell.edu  Sun Jul  7 19:32:18 2002
From: barr at cs.cornell.edu (Rimon Barr)
Date: Fri Jan  9 21:59:26 2004
Subject: [mod_python] spyce v1.1.22
Message-ID: <Pine.LNX.4.44.0207071930240.8857-100000@pompom.u.cs.cornell.edu>

Most important changes since last posting (v1.1.18)
 - easier install; .rpm should work on more systems
 - does not rely on mod_python by default... too hard to get right
   automatically, and users don't get to play with Spyce
 - downgraded some code to run on Python v2.1.1 and up.
   (requires nested scoping, so can't go further than that)
 - removed use of Python threads
 - new filter module
 - improved installation documentation, and explained how modules work
... and lots more.

Spyce still works under mod_python. To get it to work, you'll need a
properly running mod_python, and then just to comment and uncomment a few
lines in your httpd.conf. See:
  http://spyce.sourceforge.net/download.html#modpython

----------
SPYCE - Server Python Pages

SPYCE is a webserver plugin that supports simple and efficient
Python-based dynamic HTML scripting. Those who like Python and are
familiar with JSP, or PHP, or ASP, should have a look at this engine. It
allows one to generate dynamic HTML content just as easily, using Python
for the dynamic parts. Its modular design makes it very flexible and
extensible. It supports FastCGI, CGI and mod_python to plugin into Apache
and most other webservers. It can also be used as a command-line utility
for HTML pre-processing.

v1.1.22 released on 7 July 2002.

Get it at:
  http://spyce.sourceforge.net

----------
Partial change log:

v1.1.22
  fixed Python v2.1.1-related bugs.
  improved installation process and documentation
  rpm more likely to succeed - uses fcgi or drops back to cgi
  no longer mod_python based by default

v1.1.21 (faulty release)
  stochastic session clean up; no more threading dependency
  documentation: better installation notes
  peep-hole optimizer

v1.1.20 (faulty release)
  created explicit (swappable) cache infrastructure
  BUG ** Spyce also works on Python v2.1
  request - request.post(),post1() works in includes
  documentation: cheetah install, ...

v1.1.19
  filter module

v1.1.18
  fcgi support added
  X-Spyce header added
  documentation: how to write new modules

v1.1.17
  feature request - compaction algorithm improved
...

Enjoy,
Rimon.
-- 
 * Rimon Barr       Ph.D. candidate, Computer Science, Cornell University
 | barr@cs.cornell.edu - http://www.cs.cornell.edu/barr - Y!IM: batripler
 |
 | Understanding is a kind of ecstasy.
 +----                                   -- Carl Sagan



From johannes at erdfelt.com  Wed Jul  3 18:34:27 2002
From: johannes at erdfelt.com (Johannes Erdfelt)
Date: Fri Jan  9 21:59:26 2004
Subject: [mod_python] Tips and Tricks initiative
In-Reply-To: <20020703153239.A772@eye.neb>; from vmilitaru@sympatico.ca on Wed, Jul 03, 2002 at 03:32:39PM -0500
References: <20020703153239.A772@eye.neb>
Message-ID: <20020703183427.M2452@sventech.com>

On Wed, Jul 03, 2002, vio <vmilitaru@sympatico.ca> wrote:
> Hello,
> Inspired by Apache's excellent "URL Rewriting Guide" (http://httpd.apache.org/docs/misc/rewriteguide.html), I would like to suggest that the mod_python maintainers compile a similar document, focussed exclusively on short, practical tricks and tips documenting how mod_python can help to solve some typical problems. This would, to some extent, cut off on redundant posts to the list, as well as help spread knowledge from the more experienced to the more 'mod_python challenged' (like myself). There is no better selling argument for mod_python than a few well written lines of 'mod_python' code ...

While not the most appropriate name, why doesn't the FAQ work for you?

http://www.modpython.org/FAQ/faqw.py

> For instance, I'd be very interested to read in such a tricks and tips list how to avoid the overhead of creating a database connection at each call to 'handler'. And so on.

http://www.modpython.org/FAQ/faqw.py?req=all#3.3

JE


From bob at redivi.com  Wed Jul  3 18:36:04 2002
From: bob at redivi.com (Bob Ippolito)
Date: Fri Jan  9 21:59:26 2004
Subject: [mod_python] Tips and Tricks initiative
In-Reply-To: <20020703173849.A937@eye.neb>
Message-ID: <4207FDD5-8ED5-11D6-9214-0003938210D6@redivi.com>

It depends on the particular db module, some modules have threadsafe 
database instances, some don't.  Some have threadsafe database cursors, 
and some don't.  Read the docs.  If it's DBAPI compliant, check its 
thread safe level.  I have never used anything that's thread safe level 
3, most are level 2 or 1 in my experience.

from http://www.python.org/topics/database/DatabaseAPI-2.0.html
threadsafety
Integer constant stating the level of thread safety the interface 
supports. Possible values are:
0	= Threads may not share the module.
1	= Threads may share the module, but not connections.
2	= Threads may share the module and connections.
3	= Threads may share the module, connections and cursors.

Sharing in the above context means that two threads may use a resource 
without wrapping it using a mutex semaphore to implement resource 
locking. Note that you cannot always make external resources thread safe 
bymanaging access using a mutex: the resource may rely on global 
variables or other external sources that are beyond your control.

-bob

On Wednesday, July 3, 2002, at 06:38 PM, vio wrote:

> * Alain Tesio <alain@onesite.org> [020703 17:11]:
>
>>> For instance, I'd be very interested to read in such a tricks and 
>>> tips list how to avoid the
>>> overhead of creating a database connection at each call to 'handler'. 
>>> And so on.
>>
>> Just make the connection a global variable.
>
> I think I tried that, initialized the db connection at the module 
> level. But somehow my cursor got corrupted, or something. I forgot 
> oracle's error number, only that my workaround was to do something like 
> (we're at module level here):
>
> db = DCOracle2.connect(my_login_string)
> def get_db_cursor():
>     "create database connection"
>     cursor = db.cursor() # Allocate a cursor
>     return cursor
>
> In fact I see that I am re-using the same connection here, so let me 
> re-phrase my initial question: how do I re-use the same *cursor* (or it 
> this a bad idea in the first place). I wonder what would happen in such 
> a multi-threaded environment (well, I'm saling in Linuxland) where 
> multiple httpd instances will hit on the db server (ora8i in my case) 
> with the same cursor *concurrently* (never got to that point of 
> desperation, though - but just from contemplating such possibility 
> sounds like total anarchy). What I did try but eventually got an error 
> on was to re-use the same cursor sequentially (in a non-threaded 
> application).
>
> Cheers, Vio
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From pk1u at yahoo.com  Mon Jul  8 17:10:12 2002
From: pk1u at yahoo.com (Praveen Kumar)
Date: Fri Jan  9 21:59:26 2004
Subject: [mod_python] DCOracle2 w/ apache + mod_python under rh7.2 ?
Message-ID: <20020709001012.18211.qmail@web10403.mail.yahoo.com>

Same problem I posted last week; I've tried a few more
things ( described below ). Is anyone running this
config ?

Any suggestions on how I can go about debugging this
would be appreciated.

> Has anyone successfully used DCOracle2 w/ apache +
> mod_python under rh7.2 ?
> 
> My system consists of rh7.2, apache1.3.26,
> mod_python-2.7.8, python2.1.3, Oracle9i .
> 
> I see the following when my program accesses the
> DCOracle2 module:
> 
>   File
>
"/usr/lib/python2.1/site-packages/DCOracle2/__init__.py",
> line 37, in ?
>     from DCOracle2 import   *
> 
>   File
>
"/usr/lib/python2.1/site-packages/DCOracle2/DCOracle2.py",
> line 104, in ?
>     import dco2
> 
> ImportError: libclntsh.so.9.0: cannot open shared
> object file: No such file or directory
> 
> 
> 
> I've tried the following:
> 
> -----
> 
> Setting LD_LIBRARY_PATH from the same shell where I
> start apache:
> 
> export LD_LIBRARY_PATH=/home/pk/OraHome1/lib
> 
> -----
> 
> Setting LD_LIBRARY_PATH to /home/pk/OraHome1/lib via
> Apache's PassEnv and SetEnv directives.
> 
> -----
> 
> Placed libclntsh.so.9.0 in
> /usr/lib/python2.1/site-packages/DCOracle2 ( same
> path
> as dco2.so ).
> 
> -----
> 
> Added /home/pk/OraHome1/lib to /etc/ld.so.conf , and
> executed /sbin/ldconfig as root.
> 
> -----
> 
> Tried adding each of:
> 
> os.putenv( 'LD_LIBRARY_PATH',
> '/home/pk/OraHome1/lib'
> )
> 
> os.environ[ 'LD_LIBRARY_PATH' ] =
> '/home/pk/OraHome1/lib'
> 
> in DCOracle2/DCOracle2.py before the "import dco2"
> statement
> 
> -----
> 
> /home/pk/OraHome1/lib is readable by all ; but tried
> the following anyway, to eliminate a
> permissions-issue
> as the cause:
> 
> As root, copied /home/pk/OraHome1/lib to /oralib ;
> tried all of the above, using /oralib
> 
> -----
> 
> "/home/pk/OraHome1/lib/libclntsh.so.9.0" exists, yet
> none of these work. The DCOracle2 module works fine
> when I use it from a standalone program. It would be
> helpful to know if anyone has gotten this config to
> work; also, any suggestions would be appreciated.
> 
> pk
> 
> 
> __________________________________________________
> Do You Yahoo!?
> Sign up for SBC Yahoo! Dial - First Month Free
> http://sbc.yahoo.com
> 
> 
> _______________________________________________
> DB-SIG maillist  -  DB-SIG@python.org
> http://mail.python.org/mailman/listinfo/db-sig


__________________________________________________
Do You Yahoo!?
Sign up for SBC Yahoo! Dial - First Month Free
http://sbc.yahoo.com

From marklists at mceahern.com  Tue Jul  9 12:41:27 2002
From: marklists at mceahern.com (Mark McEahern)
Date: Fri Jan  9 21:59:26 2004
Subject: [mod_python] configuration error
Message-ID: <JHEOKEOOLIGLDHCMAHMOMEJPDAAA.marklists@mceahern.com>

Hi, I'm trying to configure mod_python with Apache.  When I run the test, I
get Internal Server Error.  Here's what I see in Apache's error_log:

[Tue Jul  9 12:10:18 2002] [notice] Apache/1.3.26 (Unix) mod_python/2.7.8
Python/2.2.1 configured -- resuming normal operations
[Tue Jul  9 12:10:18 2002] [notice] Accept mutex: sysvsem (Default: sysvsem)
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
[Tue Jul  9 12:10:46 2002] [error] [client 192.168.0.1] python_handler:
make_obcallback returned no obCallBack!

Here's how I compiled mod_python and installed it:

  ./configure --with-apxs=/usr/local/apache/bin/apxs
  ./make
  sudo make install

I then edited httpd.conf, adding:

LoadModule python_module /usr/local/apache/libexec/mod_python.so

and

<Directory /home/.../pytest/>
  AddHandler python-program .py
  PythonHandler mptest
  PythonDebug On
</Directory>

This is mptest.py:

from mod_python import apache

def handler(req):
    req.send_http_header()
    req.write("Hello World!")
    return apache.OK

I'm running Apache 1.3.26 on Red Hat Linux 7.3.  I'm using Python 2.2.1.
mod_python installed into:

	/usr/local/lib/python2.2/site-packages/mod_python/

which is world readable.  All the files in mod_python are world readable.
Interestingly, the .py files are world executable, but the .pyc files are
NOT world executable--I don't think that makes a difference?

Is there something obvious I'm doing wrong in configuring Apache?

I found this thread and the threads it points to:

  http://www.modpython.org/pipermail/mod_python/2000-September/000881.html

The problem he encountered was that mod_python was installed as
mod_python$version, which he solved by using a symbolic link.  I don't think
that's the problem I'm having.

Interestingly, if I start Apache with httpd -X, Hello World works just fine.
However, when I start Apache normally, it doesn't work, but the above dump
from error log is all I have to go on.

Any ideas?

Thanks,

// mark

-


From marklists at mceahern.com  Tue Jul  9 13:30:20 2002
From: marklists at mceahern.com (Mark McEahern)
Date: Fri Jan  9 21:59:26 2004
Subject: [mod_python] configuration error
In-Reply-To: <JHEOKEOOLIGLDHCMAHMOMEJPDAAA.marklists@mceahern.com>
Message-ID: <JHEOKEOOLIGLDHCMAHMOGEKEDAAA.marklists@mceahern.com>

I was able to fix this by recompiling Python like so:

  ./configure --without-threads

What I wonder is how come mod_python's configure didn't warn me about this
as implied here:


http://www.modpython.org/live/mod_python-2.7.8/doc-html/inst-configure.html

Cheers,

// mark

> -----Original Message-----
> From: mod_python-admin@modpython.org
> [mailto:mod_python-admin@modpython.org]On Behalf Of Mark McEahern
> Sent: Tuesday, July 09, 2002 12:41 PM
> To: mod_python@modpython.org
> Subject: [mod_python] configuration error
>
>
> Hi, I'm trying to configure mod_python with Apache.  When I run
> the test, I
> get Internal Server Error.  Here's what I see in Apache's error_log:
>
> [Tue Jul  9 12:10:18 2002] [notice] Apache/1.3.26 (Unix) mod_python/2.7.8
> Python/2.2.1 configured -- resuming normal operations
> [Tue Jul  9 12:10:18 2002] [notice] Accept mutex: sysvsem
> (Default: sysvsem)
> make_obcallback(): could not import mod_python.apache.
> make_obcallback(): could not call init.
> [Tue Jul  9 12:10:46 2002] [error] [client 192.168.0.1] python_handler:
> make_obcallback returned no obCallBack!
>
> Here's how I compiled mod_python and installed it:
>
>   ./configure --with-apxs=/usr/local/apache/bin/apxs
>   ./make
>   sudo make install
>
> I then edited httpd.conf, adding:
>
> LoadModule python_module /usr/local/apache/libexec/mod_python.so
>
> and
>
> <Directory /home/.../pytest/>
>   AddHandler python-program .py
>   PythonHandler mptest
>   PythonDebug On
> </Directory>
>
> This is mptest.py:
>
> from mod_python import apache
>
> def handler(req):
>     req.send_http_header()
>     req.write("Hello World!")
>     return apache.OK
>
> I'm running Apache 1.3.26 on Red Hat Linux 7.3.  I'm using Python 2.2.1.
> mod_python installed into:
>
> 	/usr/local/lib/python2.2/site-packages/mod_python/
>
> which is world readable.  All the files in mod_python are world readable.
> Interestingly, the .py files are world executable, but the .pyc files are
> NOT world executable--I don't think that makes a difference?
>
> Is there something obvious I'm doing wrong in configuring Apache?
>
> I found this thread and the threads it points to:
>
>   http://www.modpython.org/pipermail/mod_python/2000-September/000881.html
>
> The problem he encountered was that mod_python was installed as
> mod_python$version, which he solved by using a symbolic link.  I
> don't think
> that's the problem I'm having.
>
> Interestingly, if I start Apache with httpd -X, Hello World works
> just fine.
> However, when I start Apache normally, it doesn't work, but the above dump
> from error log is all I have to go on.
>
> Any ideas?
>
> Thanks,
>
> // mark
>
> -
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> -
>
>

-


From vmilitaru at sympatico.ca  Tue Jul  9 15:09:59 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 21:59:26 2004
Subject: [mod_python] Tips and Tricks initiative
In-Reply-To: <4207FDD5-8ED5-11D6-9214-0003938210D6@redivi.com>; from bob@redivi.com on Wed, Jul 03, 2002 at 06:36:04PM -0400
References: <20020703173849.A937@eye.neb> <4207FDD5-8ED5-11D6-9214-0003938210D6@redivi.com>
Message-ID: <20020709150959.A461@eye.neb>

Admittedly, the intent of re-using a cursor can only be summed up as pure
greed, or the art of sucking up the last atom of speed from a given system.
In dark moonless nights, I almost pitty myself.

Thanks for the intro on threadsafety. Most interesting.

* Bob Ippolito <bob@redivi.com> [020708 22:35]:
> It depends on the particular db module, some modules have threadsafe 
> database instances, some don't.  Some have threadsafe database cursors, 
> and some don't.  Read the docs.  If it's DBAPI compliant, check its 
> thread safe level.  I have never used anything that's thread safe level 
> 3, most are level 2 or 1 in my experience.
> 
> from http://www.python.org/topics/database/DatabaseAPI-2.0.html
> threadsafety
> Integer constant stating the level of thread safety the interface 
> supports. Possible values are:
> 0	= Threads may not share the module.
> 1	= Threads may share the module, but not connections.
> 2	= Threads may share the module and connections.
> 3	= Threads may share the module, connections and cursors.
> 
> Sharing in the above context means that two threads may use a resource 
> without wrapping it using a mutex semaphore to implement resource 
> locking. Note that you cannot always make external resources thread safe 
> bymanaging access using a mutex: the resource may rely on global 
> variables or other external sources that are beyond your control.
> 
> -bob
> 
> On Wednesday, July 3, 2002, at 06:38 PM, vio wrote:
> 
> > * Alain Tesio <alain@onesite.org> [020703 17:11]:
> >
> >>> For instance, I'd be very interested to read in such a tricks and 
> >>> tips list how to avoid the
> >>> overhead of creating a database connection at each call to 'handler'. 
> >>> And so on.
> >>
> >> Just make the connection a global variable.
> >
> > I think I tried that, initialized the db connection at the module 
> > level. But somehow my cursor got corrupted, or something. I forgot 
> > oracle's error number, only that my workaround was to do something like 
> > (we're at module level here):
> >
> > db = DCOracle2.connect(my_login_string)
> > def get_db_cursor():
> >     "create database connection"
> >     cursor = db.cursor() # Allocate a cursor
> >     return cursor
> >
> > In fact I see that I am re-using the same connection here, so let me 
> > re-phrase my initial question: how do I re-use the same *cursor* (or it 
> > this a bad idea in the first place). I wonder what would happen in such 
> > a multi-threaded environment (well, I'm saling in Linuxland) where 
> > multiple httpd instances will hit on the db server (ora8i in my case) 
> > with the same cursor *concurrently* (never got to that point of 
> > desperation, though - but just from contemplating such possibility 
> > sounds like total anarchy). What I did try but eventually got an error 
> > on was to re-use the same cursor sequentially (in a non-threaded 
> > application).
> >
> > Cheers, Vio
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://www.modpython.org/mailman/listinfo/mod_python
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

From vmilitaru at sympatico.ca  Tue Jul  9 15:18:48 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 21:59:26 2004
Subject: [mod_python] configuration error
In-Reply-To: <JHEOKEOOLIGLDHCMAHMOMEJPDAAA.marklists@mceahern.com>; from marklists@mceahern.com on Tue, Jul 09, 2002 at 12:41:27PM -0500
References: <JHEOKEOOLIGLDHCMAHMOMEJPDAAA.marklists@mceahern.com>
Message-ID: <20020709151848.B461@eye.neb>

> ...
> I then edited httpd.conf, adding:
> 
> LoadModule python_module /usr/local/apache/libexec/mod_python.so
> 

I believe just here should be something like:

	AddModule mod_python.c

> and
> 
> <Directory /home/.../pytest/>
>   AddHandler python-program .py
>   PythonHandler mptest
>   PythonDebug On
> </Directory>
> 

Hope this solves your bobo,
Vio

From marklists at mceahern.com  Tue Jul  9 14:35:13 2002
From: marklists at mceahern.com (Mark McEahern)
Date: Fri Jan  9 21:59:26 2004
Subject: [mod_python] configuration error
In-Reply-To: <20020709151848.B461@eye.neb>
Message-ID: <JHEOKEOOLIGLDHCMAHMOAEKKDAAA.marklists@mceahern.com>

> I believe just here should be something like:
>
> 	AddModule mod_python.c

That's only required if you have ClearModuleList, which I don't.

As I noted in a follow up, I solved the problem by recompiling Python
without thread support.

Cheers,

// mark

-


From gbenson at redhat.com  Sat Jul 13 12:51:32 2002
From: gbenson at redhat.com (Gary Benson)
Date: Fri Jan  9 21:59:26 2004
Subject: [mod_python] Ping?
Message-ID: <Pine.LNX.4.44.0207131250410.31967-100000@slippy.wire.rat>

It seems that I am getting messages from this list with a four day lag. 
Is anyone else experiencing this?

Cheers,
Gary

[ gbenson@redhat.com ][ GnuPG 85A8F78B ][ http://inauspicious.org/ ]


From fabbe at paniq.net  Sun Jul 14 11:33:07 2002
From: fabbe at paniq.net (Fabian Fagerholm)
Date: Fri Jan  9 21:59:26 2004
Subject: [mod_python] Understanding mod_python
Message-ID: <1026635587.26526.30.camel@kernel>

Hello, World!

I've just begun to get to know Python and mod_python. So far, I like
what I see, but there are a few things that are a bit confusing. I
suspect it's just a matter of differing conventions - my previous
experience programming web applications is with Perl (cgi), PHP and Java
(Servlets).

Since I like to know exactly what I'm doing, I've read through all the
docs I could find, and browsed through the mailing list archives. I now
have two issues that I would like to bring up.


First, I would like to convince myself that I have understood the
Handler concept and the Publisher Handler. Therefore, I've made two
drawings based on the mod_python docs. The first drawing is
    http://www.paniq.net/fabbe/mod_python/Handler_order.ps
and it tries to show what happens when a request is made to Apache. In
particular, I'm trying to understand in which *order* the Handlers are
called and what each Handler is for.
The second drawing is
    http://www.paniq.net/fabbe/mod_python/Publisher_handler.ps
and it tries to show how the Publisher Handler handles a request. It
also shows the different parts of an URI from the Publisher's point of
view.

        * Are these drawings correct or have I misunderstood anything?
        * I would like to combine the drawings into one. Where would I
          attach the second drawing to the first?
        * I didn't quite understand how the __auth__, __access__ and
          __auth_realm__ stuff in Publisher works. I'm confused by the
          phrase "at each traversal step, the Publisher checks for...".
          I understand one object might refer to or contain another, but
          the benefits and practical use of this is is not clear to me
          and would need further explanation.
        * Could these drawings be beneficial to someone else? If so, I'd
          be happy to modify them for some particular purpose.


Second, while reading the mailing list archives, I found that many of
the posts were about how to build a web application with a sensible
structure (separating content from presentation), authorization, session
management etc. with mod_python. A very valid question IMO, because the
tutorial in the docs is quite sparse and shows an example that is mostly
achievable by using traditional CGI.
Using Python's OO features, it should be possible to create quite
complex web applications. As far as I can see, mod_python is able to
replace a Java Servlet-based solution with little effort. In fact, this
is my exact reason for looking at mod_python. :)

There were also some posts about a mod_python "cookbook", and another
poster suggested the on-line FAQ would be a good place for the
"recipes". I totally agree - well-written example code is the best way
to learn.
I'd like to suggest that a new category be created in the FAQ for these
snippets of example code.


Cheers,
Fabian Fagerholm

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 240 bytes
Desc: This is a digitally signed message part
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20020714/e9156aa3/attachment-0002.bin
From pk1u at yahoo.com  Sun Jul 14 16:58:17 2002
From: pk1u at yahoo.com (Praveen Kumar)
Date: Fri Jan  9 21:59:26 2004
Subject: [mod_python] Re: DCOracle2 w/ apache + mod_python under rh7.2 ?
In-Reply-To: <20020709073832.GV14854@glas.net>
Message-ID: <20020714235817.90778.qmail@web10411.mail.yahoo.com>

> 1) make sure you have set ORACLE_HOME env var.
> 2) make sure you have set LD_LIBRARY_PATH (to
> $ORACLE_HOME/lib) env var.
> 3) make sure that both of them are set _before_ the
> ecript execution.

Didn't work. I got around it by using mod_python as a
DSO, and using apache's LoadFile directive; in
httpd.conf:

LoadFile /home/pk/OraHome1/lib/libclntsh.so.9.0 

Not ideal, but it works.

pk

--- "Eugene V. Dvurechenski" <jno@glasnet.ru> wrote:
> On Mon, Jul 08, 2002 at 04:55:05PM -0700, Praveen
> Kumar wrote:
> >     import dco2
> > 
> > ImportError: libclntsh.so.9.0: cannot open shared
> > object file: No such file or directory
> 
> 1) make sure you have set ORACLE_HOME env var.
> 2) make sure you have set LD_LIBRARY_PATH (to
> $ORACLE_HOME/lib) env var.
> 3) make sure that both of them are set _before_ the
> ecript execution.
> 
> the last point is essential - os.environ doesn't
> help much.

Orig msg:

> Has anyone successfully used DCOracle2 w/ apache +
> mod_python under rh7.2 ?
> 
> My system consists of rh7.2, apache1.3.26,
> mod_python-2.7.8, python2.1.3, Oracle9i .
> 
> I see the following when my program accesses the
> DCOracle2 module:
> 
>   File
>
"/usr/lib/python2.1/site-packages/DCOracle2/__init__.py",
> line 37, in ?
>     from DCOracle2 import   *
> 
>   File
>
"/usr/lib/python2.1/site-packages/DCOracle2/DCOracle2.py",
> line 104, in ?
>     import dco2
> 
> ImportError: libclntsh.so.9.0: cannot open shared
> object file: No such file or directory
> 
> 
> 
> I've tried the following:
> 
> -----
> 
> Setting LD_LIBRARY_PATH from the same shell where I
> start apache:
> 
> export LD_LIBRARY_PATH=/home/pk/OraHome1/lib
> 
> -----
> 
> Setting LD_LIBRARY_PATH to /home/pk/OraHome1/lib via
> Apache's PassEnv and SetEnv directives.
> 
> -----
> 
> Placed libclntsh.so.9.0 in
> /usr/lib/python2.1/site-packages/DCOracle2 ( same
> path
> as dco2.so ).
> 
> -----
> 
> Added /home/pk/OraHome1/lib to /etc/ld.so.conf , and
> executed /sbin/ldconfig as root.
> 
> -----
> 
> Tried adding each of:
> 
> os.putenv( 'LD_LIBRARY_PATH',
> '/home/pk/OraHome1/lib'
> )
> 
> os.environ[ 'LD_LIBRARY_PATH' ] =
> '/home/pk/OraHome1/lib'
> 
> in DCOracle2/DCOracle2.py before the "import dco2"
> statement
> 
> -----
> 
> /home/pk/OraHome1/lib is readable by all ; but tried
> the following anyway, to eliminate a
> permissions-issue
> as the cause:
> 
> As root, copied /home/pk/OraHome1/lib to /oralib ;
> tried all of the above, using /oralib
> 
> -----
> 
> "/home/pk/OraHome1/lib/libclntsh.so.9.0" exists, yet
> none of these work. The DCOracle2 module works fine
> when I use it from a standalone program. It would be
> helpful to know if anyone has gotten this config to
> work; also, any suggestions would be appreciated.
> 
> pk
> 


__________________________________________________
Do You Yahoo!?
Yahoo! Autos - Get free new car price quotes
http://autos.yahoo.com

From jdaily at kc.rr.com  Sun Jul 14 20:01:21 2002
From: jdaily at kc.rr.com (james daily)
Date: Fri Jan  9 21:59:26 2004
Subject: [mod_python] please, old fool needs help with getting apache mod_python on windows 98 to run
Message-ID: <NDBBIADKLJIPFGPECIJPOELOCMAA.jdaily@kc.rr.com>

the mod_python online manual at:
    http://www.modpython.org/live/mod_python-2.7.8/doc-html/app-wininst.html

says:
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
A. Windows Installation

Notes originally created by Enrique Vaamonde evaamo@loquesea.com

Your mileage may vary with these instructions

You need to have the following packages properly installed and configured in
your system:


Python 1.5.2 or 2.0
Apache 1.3
Winzip 6.x or later.

You need to download both the mod_python.dll and the mod_python-x.tgz (where
x is the version number) files from the main page. Once you have all the
things above mentioned we're good to go.


Installing mod_python libraries

Use Winzip to extract the distribution file (mod_python-x.tgz) into a
temporary folder (i.e C:\temp):

NOTE: If Winzip shows this warning "Archive contains one file, should Winzip
decompress it to a temporary folder?" just click on Yes, the content of the
file should appear in Winzip right after.

Select all the files in Winzip and click on the Extract button, then type-in
the path or just browse your way to the temporary folder and click extract.

Open your Windows Explorer and locate the temporary folder where you
extracted the distribution file, you should have a new folder in your
temporary folder
(C:\temp\mod_python-x).

Move (or just drag & drop) the mod_python-x folder into the Python lib
folder
(i.e C:\Program Files\Python\lib).

Move the files in the folder lib inside the mod_python folder
(C:\Program Files\Python\lib\mod_python-x\lib\mod_python) to the
C:\Program Files\Python\lib\mod_python folder.
It's safe to delete these folders we just emptied.

xxxxxxxxxxx
also put the files from
    "mod_python-2.7.8\src\include\"
into
    "D:\Program Files\python211\Python21\include"
which allowed apache to start.
xxxxxxxxxxx

Integrating it with Apache
Once the distribution file is correctly extracted and later moved into the
Python directory, it's time to modify your Apache configuration (httpd.conf)
and integrate the server with mod_python. These are a few steps we must do
first:


Locate the file mod_python.dll that you downloaded before and move it to
Apache's modules folder (i.e C:\Program Files\Apache Group\Apache\modules).

Go to the Apache configuration folder (i.e C:\Program Files\Apache
Group\Apache\conf\) and edit the httpd.conf file.
Add the following line in the section "Dynamic Shared Object (DSO) Support"
of the httpd.conf file:


LoadModule python_module modules/mod_python.dll


Add the following lines in the section ScriptAlias and CGI of the
httpd.conf:


<Directory "<Your Document Root>/python">
   AddHandler python-program .py
   PythonHandler mptest
   PythonDebug on
</Directory>

NOTE: Replace the <Your Document Root> above with the Document Root you
specified on the DocumentRoot directive in the Apache's httpd.conf file.


Last, create a folder under your Document Root called python.


Testing

Create a text file in the folder we created above and call it mptest.py (you
can use Notepad for this).

Insert the following lines and save the file (Make sure it gets saved with
the .py extension):


from mod_python import apache

def handler(req):
   req.content_type = "text/plain"
   req.send_http_header()
   req.write("Hello World!")
   return apache.OK


Make sure Apache is running (or launch it!) and then point your browser to
the URL referring to the mptest.py, you should see "Hello World!".

That's it, you're ready to roll!! If you don't see the "Hello World!"
message, the next section is for you.
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

Apache/1.3.14 (Win32) running...
Python 2.1.1

all i get in the browser is the text of mptest.py

any suggestions?

if someone has it actually running on their windows 98 system,
could you please send me the ***relevant*** portions from your
apache httpd.conf file?

i have tried numerous different approaches to no avail.

alas, i am a programmer but not (yet) an apache guru.

any help would be greatly appreciated.


---------------------------------------------
James Daily
Phone : 816 943 9891
Email : wndrer@earthling.net (or hit reply button)
Web   : http://tellmama.com/
Philosophy:
                            4     2                              1000
( cos(? - r) - sin ? ) * ( r  - 2r  cos(2? + 2.4) + 0.9) + 0.62r)     < 0

Education is a progressive discovery of our own ignorance.
                                               Will Durant


From bill at immosys.com  Mon Jul 15 16:46:21 2002
From: bill at immosys.com (Bill Anderson)
Date: Fri Jan  9 21:59:26 2004
Subject: [mod_python] new to mod_python, with a question.
Message-ID: <1026773181.12028.7.camel@locutus>

OK, so here is what I am doing. I am using PageTemplates (from zope) and
mod_python. or at least, I am trying to. :)


if I do _NOT_ use the request object (i.e. I return a fully formed html
string/document), it works fine. but of course, that means no use of
mod-python's request objects functions such as cookie/header
construction, usage, etc.

To wit:
def sayit(req,x=12):
	if not x:
		return "I need x"
	if not master:
		return "I need a master object"
	pt=PageTemplate()
	filestring =
"".join(open("/home/ucntcme/public_html/pythonapps/test.pt").readlines())
	pt.write(filestring)
	myx=int(x)
        req.content_type="text/html"
        req.send_http_headers()
	req.write( pt(x=myx,master=master) )
	return apache.OK

returns my rendered template, but at the bottom has:

HTTP/1.1 200 OK Date: Mon, 15 Jul 2002 22:44:27 GMT Server:
Apache/1.3.22 (Unix) (Red-Hat/Linux) mod_python/2.7.8 Python/2.2.1
mod_ssl/2.8.5 OpenSSL/0.9.6b DAV/1.0.2 PHP/4.0.6 mod_perl/1.26
Connection: close Transfer-Encoding: chunked Content-Type: text/html;
charset=iso-8859-1
OK
The server encountered an internal error or misconfiguration and was
unable to complete your request.



Debug is on, and there are no mesages in the error_log.

Now, if I just return the content using return (content), it works fine.

Why is this/what am I doing wrong here?

Cheers, Bill







From gbenson at redhat.com  Tue Jul 16 10:15:59 2002
From: gbenson at redhat.com (Gary Benson)
Date: Fri Jan  9 21:59:27 2004
Subject: [mod_python] [PATCH] last httpd-2.0.36
Message-ID: <Pine.LNX.4.44.0207161015330.16859-200000@slippy.wire.rat>


Hi,

The attached patch brings the input filtering API in mod_python into line 
with that in httpd-2.0.36.  This is the last thing that I know of that 
needed fixing to work with 2.0.36, although I beleive some more fixes will 
be in order to build against 2.0.39 or whatever it is now :)

Cheers,
Gary

[ gbenson@redhat.com ][ GnuPG 85A8F78B ][ http://inauspicious.org/ ]
-------------- next part --------------
Bring input filter API in line with 2.0.36

Index: src/filterobject.c
===================================================================
RCS file: /cvsroot/modpython/mod_python/src/filterobject.c,v
retrieving revision 1.5
diff -u -r1.5 filterobject.c
--- src/filterobject.c	3 Jun 2002 14:31:15 -0000	1.5
+++ src/filterobject.c	9 Jul 2002 16:21:27 -0000
@@ -61,7 +61,7 @@
  */
 
 PyObject *MpFilter_FromFilter(ap_filter_t *f, apr_bucket_brigade *bb, int is_input,
-			      ap_input_mode_t mode, apr_size_t *readbytes,
+			      ap_input_mode_t mode, apr_size_t readbytes,
 			      char * handler, char *dir)
 {
     filterobject *result;
@@ -86,7 +86,7 @@
 	result->bb_in = bb;
 	result->bb_out = NULL;
 	result->mode = 0;
-	result->readbytes = NULL;
+	result->readbytes = 0;
     }
 
     result->closed = 0;
@@ -142,7 +142,7 @@
 
 	Py_BEGIN_ALLOW_THREADS;
 	self->rc = ap_get_brigade(self->f->next, self->bb_in, self->mode, 
-				  APR_BLOCK_READ, *self->readbytes);
+				  APR_BLOCK_READ, self->readbytes);
 	Py_END_ALLOW_THREADS;
 
 	if (! APR_STATUS_IS_SUCCESS(self->rc)) {
@@ -239,7 +239,7 @@
 
 		Py_BEGIN_ALLOW_THREADS;
 		self->rc = ap_get_brigade(self->f->next, self->bb_in, self->mode, 
-					  APR_BLOCK_READ, *self->readbytes);
+					  APR_BLOCK_READ, self->readbytes);
 		Py_END_ALLOW_THREADS;
 
 		if (! APR_STATUS_IS_SUCCESS(self->rc)) {
Index: src/mod_python.c
===================================================================
RCS file: /cvsroot/modpython/mod_python/src/mod_python.c,v
retrieving revision 1.60
diff -u -r1.60 mod_python.c
--- src/mod_python.c	3 Jun 2002 14:31:15 -0000	1.60
+++ src/mod_python.c	9 Jul 2002 16:21:35 -0000
@@ -1023,7 +1023,8 @@
 static apr_status_t python_filter(int is_input, ap_filter_t *f, 
 				  apr_bucket_brigade *bb,
 				  ap_input_mode_t mode,
-				  apr_size_t *readbytes) {
+				  apr_read_type_e block,
+				  apr_size_t readbytes) {
 
     PyObject *resultobject = NULL;
     interpreterdata *idata;
@@ -1052,8 +1053,7 @@
        so a fitler can spit out an error without causing infinite loop */
     if (ctx->transparent) {
 	if (is_input) 
-	    return ap_get_brigade(f->next, bb, mode, APR_BLOCK_READ, 
-				  *readbytes);
+	    return ap_get_brigade(f->next, bb, mode, block, readbytes);
 	else
 	    return ap_pass_brigade(f->next, bb);
     }
@@ -1201,9 +1201,10 @@
 static apr_status_t python_input_filter(ap_filter_t *f, 
 					apr_bucket_brigade *bb,
 					ap_input_mode_t mode,
-					apr_size_t *readbytes) 
+					apr_read_type_e block,
+					apr_off_t readbytes)
 {
-    return python_filter(1, f, bb, mode, readbytes);
+    return python_filter(1, f, bb, mode, block, readbytes);
 }
 
 
@@ -1216,7 +1217,7 @@
 static apr_status_t python_output_filter(ap_filter_t *f, 
 					 apr_bucket_brigade *bb)
 {
-    return python_filter(0, f, bb, 0, NULL);
+    return python_filter(0, f, bb, 0, 0, 0);
 }
 
 
Index: src/include/filterobject.h
===================================================================
RCS file: /cvsroot/modpython/mod_python/src/include/filterobject.h,v
retrieving revision 1.4
diff -u -r1.4 filterobject.h
--- src/include/filterobject.h	3 Jun 2002 14:31:16 -0000	1.4
+++ src/include/filterobject.h	9 Jul 2002 16:21:36 -0000
@@ -67,7 +67,7 @@
 
 	int is_input;
 	ap_input_mode_t mode;
-	apr_size_t *readbytes;
+	apr_size_t readbytes;
 
 	int closed;
 	int softspace;
@@ -88,7 +88,7 @@
     extern DL_IMPORT(PyObject *) 
 	MpFilter_FromFilter Py_PROTO((ap_filter_t *f, apr_bucket_brigade *bb_in, 
 				      int is_input, ap_input_mode_t mode, 
-				      apr_size_t *readbytes, char *hadler, char *dir));
+				      apr_size_t readbytes, char *hadler, char *dir));
 
 #ifdef __cplusplus
 }
From ecastanedo at hotmail.com  Wed Jul 17 01:04:14 2002
From: ecastanedo at hotmail.com (Edgar Castanedo)
Date: Fri Jan  9 21:59:27 2004
Subject: [mod_python] freebsd
Message-ID: <F1478v6eoHvEmsgTFsF000136d0@hotmail.com>

I have installed Python on FreeBSD from the ports collection. When I try and 
install mod_python (from the ports collection also), a message is returned 
which states that Python needs to be installed WITHOUT threads. I am not 
sure if this is okay since I write lots of Python script and don't know how 
this will affect Pythons performance. Can anyone shed some light on this for 
me as I do not want to disable threads if it means that my scripts will not 
work the way they used to.

Thanks,

*************************************
Edgar Castanedo
ecastanedo@hotmail.com
*************************************


_________________________________________________________________
Chat with friends online, try MSN Messenger: http://messenger.msn.com


From gharris at centauri.mb.ca  Fri Jul 19 00:18:58 2002
From: gharris at centauri.mb.ca (George Harrison)
Date: Fri Jan  9 21:59:27 2004
Subject: [mod_python] Installing mod_python on Win98/Apache
Message-ID: <5.1.0.14.2.20020718231601.027cfec0@pop.mb.sympatico.ca>

After following the instructions in the documentation and copying the files 
from D:\Program Files\Python22\lib\mod_python-x\lib\mod_python to 
D:\Program Files\Python22\lib\mod_python;  I can launch Apache but when I 
try to open mptest.py I get the following message in the error log:

[Thu Jul 18 23:50:19 2002] [error] [client 127.0.0.1] python_handler: 
make_obcallback returned no obCallBack!

Does anyone know what is happening, or have a listing of where the files 
are supposed to be in the python directory for this to work?

Thanks

gh



From gbenson at redhat.com  Wed Jul 10 11:42:21 2002
From: gbenson at redhat.com (Gary Benson)
Date: Fri Jan  9 21:59:27 2004
Subject: [mod_python] [PATCH] last httpd-2.0.36
Message-ID: <Pine.LNX.4.44.0207101139450.20893-200000@slippy.wire.rat>


Hi,

The attached patch brings the input filtering API in mod_python into line 
with that in httpd-2.0.36.  This is the last thing that I know of that 
needed fixing to work with 2.0.36, although I beleive some more fixes will 
be in order to build against 2.0.39 or whatever it is now :)

Cheers,
Gary

[ gbenson@redhat.com ][ GnuPG 85A8F78B ][ http://inauspicious.org/ ]

-------------- next part --------------
Bring input filter API in line with 2.0.36

Index: src/filterobject.c
===================================================================
RCS file: /cvsroot/modpython/mod_python/src/filterobject.c,v
retrieving revision 1.5
diff -u -r1.5 filterobject.c
--- src/filterobject.c	3 Jun 2002 14:31:15 -0000	1.5
+++ src/filterobject.c	9 Jul 2002 16:21:27 -0000
@@ -61,7 +61,7 @@
  */
 
 PyObject *MpFilter_FromFilter(ap_filter_t *f, apr_bucket_brigade *bb, int is_input,
-			      ap_input_mode_t mode, apr_size_t *readbytes,
+			      ap_input_mode_t mode, apr_size_t readbytes,
 			      char * handler, char *dir)
 {
     filterobject *result;
@@ -86,7 +86,7 @@
 	result->bb_in = bb;
 	result->bb_out = NULL;
 	result->mode = 0;
-	result->readbytes = NULL;
+	result->readbytes = 0;
     }
 
     result->closed = 0;
@@ -142,7 +142,7 @@
 
 	Py_BEGIN_ALLOW_THREADS;
 	self->rc = ap_get_brigade(self->f->next, self->bb_in, self->mode, 
-				  APR_BLOCK_READ, *self->readbytes);
+				  APR_BLOCK_READ, self->readbytes);
 	Py_END_ALLOW_THREADS;
 
 	if (! APR_STATUS_IS_SUCCESS(self->rc)) {
@@ -239,7 +239,7 @@
 
 		Py_BEGIN_ALLOW_THREADS;
 		self->rc = ap_get_brigade(self->f->next, self->bb_in, self->mode, 
-					  APR_BLOCK_READ, *self->readbytes);
+					  APR_BLOCK_READ, self->readbytes);
 		Py_END_ALLOW_THREADS;
 
 		if (! APR_STATUS_IS_SUCCESS(self->rc)) {
Index: src/mod_python.c
===================================================================
RCS file: /cvsroot/modpython/mod_python/src/mod_python.c,v
retrieving revision 1.60
diff -u -r1.60 mod_python.c
--- src/mod_python.c	3 Jun 2002 14:31:15 -0000	1.60
+++ src/mod_python.c	9 Jul 2002 16:21:35 -0000
@@ -1023,7 +1023,8 @@
 static apr_status_t python_filter(int is_input, ap_filter_t *f, 
 				  apr_bucket_brigade *bb,
 				  ap_input_mode_t mode,
-				  apr_size_t *readbytes) {
+				  apr_read_type_e block,
+				  apr_size_t readbytes) {
 
     PyObject *resultobject = NULL;
     interpreterdata *idata;
@@ -1052,8 +1053,7 @@
        so a fitler can spit out an error without causing infinite loop */
     if (ctx->transparent) {
 	if (is_input) 
-	    return ap_get_brigade(f->next, bb, mode, APR_BLOCK_READ, 
-				  *readbytes);
+	    return ap_get_brigade(f->next, bb, mode, block, readbytes);
 	else
 	    return ap_pass_brigade(f->next, bb);
     }
@@ -1201,9 +1201,10 @@
 static apr_status_t python_input_filter(ap_filter_t *f, 
 					apr_bucket_brigade *bb,
 					ap_input_mode_t mode,
-					apr_size_t *readbytes) 
+					apr_read_type_e block,
+					apr_off_t readbytes)
 {
-    return python_filter(1, f, bb, mode, readbytes);
+    return python_filter(1, f, bb, mode, block, readbytes);
 }
 
 
@@ -1216,7 +1217,7 @@
 static apr_status_t python_output_filter(ap_filter_t *f, 
 					 apr_bucket_brigade *bb)
 {
-    return python_filter(0, f, bb, 0, NULL);
+    return python_filter(0, f, bb, 0, 0, 0);
 }
 
 
Index: src/include/filterobject.h
===================================================================
RCS file: /cvsroot/modpython/mod_python/src/include/filterobject.h,v
retrieving revision 1.4
diff -u -r1.4 filterobject.h
--- src/include/filterobject.h	3 Jun 2002 14:31:16 -0000	1.4
+++ src/include/filterobject.h	9 Jul 2002 16:21:36 -0000
@@ -67,7 +67,7 @@
 
 	int is_input;
 	ap_input_mode_t mode;
-	apr_size_t *readbytes;
+	apr_size_t readbytes;
 
 	int closed;
 	int softspace;
@@ -88,7 +88,7 @@
     extern DL_IMPORT(PyObject *) 
 	MpFilter_FromFilter Py_PROTO((ap_filter_t *f, apr_bucket_brigade *bb_in, 
 				      int is_input, ap_input_mode_t mode, 
-				      apr_size_t *readbytes, char *hadler, char *dir));
+				      apr_size_t readbytes, char *hadler, char *dir));
 
 #ifdef __cplusplus
 }
From ps0 at igmp.com.ar  Wed Jul  3 19:20:51 2002
From: ps0 at igmp.com.ar (ps0@igmp.com.ar)
Date: Fri Jan  9 21:59:27 2004
Subject: [mod_python] Problems creating files from mod_python
In-Reply-To: <20020702194803.A27995@igmp.com.ar>; from ps0@igmp.com.ar on Tue, Jul 02, 2002 at 07:48:03PM -0300
References: <20020702194803.A27995@igmp.com.ar>
Message-ID: <20020703192051.A18568@igmp.com.ar>

On Tue, Jul 02, 2002 at 07:48:03PM -0300, ps0@igmp.com.ar wrote:

Tnks to all for your anwers , the problem was thread support on python
( crazy things ) . Now with phython compiled without thread support
everyting works fine.

Tnks again.

Regards

> Apache: 1.3.24
> mod_python: 2.7.8
> Python: 2.2 (w/threads) [i have to recompile it
> without threads]
> 
> 
> fd=open("/tmp/bleh.txt", "w")
> fd.write("HOLA\n")
> fd.close()
> 
> On the fd.close() it make this error:
> IOError: [Errno 9] Bad file Descriptor 
> 
> The file is created but i can't write on it.
> 
> 
> The perms are corectly applied, from a python script ( out of apache )
> the thinks work ok.
> 
> Sugestions apreciated.
> 
> Tnks in advance.
> 
> Hector.
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From vmilitaru at sympatico.ca  Wed Jul  3 18:40:33 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 21:59:27 2004
Subject: [mod_python] Tips and Tricks initiative
In-Reply-To: <20020703183427.M2452@sventech.com>; from johannes@erdfelt.com on Wed, Jul 03, 2002 at 06:34:27PM -0400
References: <20020703153239.A772@eye.neb> <20020703183427.M2452@sventech.com>
Message-ID: <20020703184033.A1017@eye.neb>

* Johannes Erdfelt <johannes@erdfelt.com> [020703 18:32]:

> While not the most appropriate name, why doesn't the FAQ work for you?
> 
> http://www.modpython.org/FAQ/faqw.py

Perhaps because until this very moment I was *totally* unaware of its existence.
Many thanks for the pointer.

Cheers, Vio

From vmilitaru at sympatico.ca  Thu Jul  4 13:53:02 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 21:59:27 2004
Subject: [mod_python] Chewing cookies
Message-ID: <20020704135302.A489@eye.neb>

'REQUEST.headers_out.add('Set-Cookie',cookie_value)' seems the recommended way to set up multiple cookies on the client. But what is the recommended way to get back at those cookies? Seems to me that anything like 'REQUEST.headers_in['Set-Cookie'] is no good with more than one cookie, for obvious reasons. Any suggestions?

Cheers, Vio

From vmilitaru at sympatico.ca  Thu Jul  4 15:01:52 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 21:59:27 2004
Subject: [mod_python] Chewing cookies
Message-ID: <20020704190152.RXBC18503.tomts10-srv.bellnexxia.net@eye.neb>

'REQUEST.headers_out.add('Set-Cookie',cookie_value)' seems the recommended way 
to set up multiple cookies on the client. 
But what is the recommended way to get back at those cookies? 
Seems to me that anything like 'REQUEST.headers_in['Set-Cookie'] is no good 
with more than one cookie, for obvious reasons. 
Any tips would be appreciated.

Cheers, Vio


From mateusz at ant.gliwice.pl  Mon Jul 22 11:02:42 2002
From: mateusz at ant.gliwice.pl (Mateusz Korniak)
Date: Fri Jan  9 21:59:27 2004
Subject: [mod_python] Chewing cookies
In-Reply-To: <20020704190152.RXBC18503.tomts10-srv.bellnexxia.net@eye.neb>
References: <20020704190152.RXBC18503.tomts10-srv.bellnexxia.net@eye.neb>
Message-ID: <200207220902.g6M92ss21416@eden.ispol.com>

> 'REQUEST.headers_out.add('Set-Cookie',cookie_value)' seems the recommended
> way to set up multiple cookies on the client.
> But what is the recommended way to get back at those cookies?
> Seems to me that anything like 'REQUEST.headers_in['Set-Cookie'] is no good
> with more than one cookie, for obvious reasons.
> Any tips would be appreciated.

This code works for me: (all cookies seems to be send via single Cookie 
header)
		self.cookies = abbon.html.Cookie.Cookie() # Cookie module downloaded from 
www.python.org as py < 2.0 didn't have Cookie module

		if self.raw_request.headers_in.has_key('Cookie'):
			self.cookies.load(self.raw_request.headers_in['Cookie'])

		if self.cookies.has_key(COOKIEUID):
			self.cookie_uid = str(self.cookies[COOKIEUID].value)

		if self.cookies.has_key(SES):
			self.cookie_ses = str(self.cookies[SES].value)


HIH ...
-- 
Mateusz Korniak


From matt at proweb.co.uk  Mon Jul 22 10:10:56 2002
From: matt at proweb.co.uk (matt)
Date: Fri Jan  9 21:59:27 2004
Subject: [mod_python] Chewing cookies
References: <20020704135302.A489@eye.neb>
Message-ID: <001901c2315f$b0f055f0$6501a8c0@KIKE>

----- Original Message -----
From: "vio" <vmilitaru@sympatico.ca>
To: <mod_python@modpython.org>
Sent: Thursday, July 04, 2002 7:53 PM
Subject: [mod_python] Chewing cookies


> 'REQUEST.headers_out.add('Set-Cookie',cookie_value)' seems the recommended
way to set up multiple cookies on the client. But what is the recommended
way to get back at those cookies? Seems to me that anything like
'REQUEST.headers_in['Set-Cookie'] is no good with more than one cookie, for
obvious reasons. Any suggestions?

cookies are sent to the server url encoded and semi-colon separated on one
line

Cookie: foo=f00%20foo; bar=bar34; bazz=%56;

# here's a noddy cookie cracker

import urllib

cookie_string = REQUEST.headers_in['Cookie']
# eg. cookie_string = 'foo=f00%20foo; bar=bar34; bazz=%37%38%58%58;'

cookies = {}

for cookie in cookiestring.split(";") :
    key_value = cookie.split("=")

 if len(key_value) == 2 :
    cookies[urllib.unquote(key_value[0].strip())] =
urllib.unquote(key_value[1].strip())
print cookies

# eg. outputs
# {'bazz': '78XX', 'foo': 'f00 foo', 'bar': 'bar34'}



# matt


From matt at proweb.co.uk  Tue Jul 23 11:45:56 2002
From: matt at proweb.co.uk (matt)
Date: Fri Jan  9 21:59:27 2004
Subject: [mod_python] Chewing cookies
References: <20020704135302.A489@eye.neb> <001901c2315f$b0f055f0$6501a8c0@KIKE> <20020722225119.B282@eye.neb>
Message-ID: <007f01c23236$221528b0$6501a8c0@KIKE>

Hi, presumably you wanted it to go to the list to so I've included your mail
below in full too

Rather than work out the answres to your questions directly I think it might
be better for you to go read the theory and practice of cookies

The official spec
http://wp.netscape.com/newsref/std/cookie_spec.html
(which is curiously marked as "Preliminary Specification - Use with
caution")
or
http://developer.netscape.com/docs/manuals/communicator/jsguide4/cookies.htm

working with cookies :
http://www.cookiecentral.com/faq/

settign the expiry to a past date will delete them


> Hi Matt,
> Thanks for the reply. (I must say, it's hard not to totally love python.)
> To recap, all cookies are sent by the client in a single header ('Cookie')
> semi-colon separated.
> So here's a couple of follow-up questions:
> * Any rules for the date format? Is something like
> 'expires=Wed, 03-Jul-2002 05:18:07 GMT; ' OK?
>
> * what's the procedure to get rid of a cookie?
> Netscape docs (or Mozilla, I forgot which one) seem to suggest that the
client
> doesn't get rid of the cookie. But I saw in some Zope code snipplet
(again,
> I forgot which module, maybe somewhere in ZPublisher/HTTPResponse), that
> the way Zope dumped old cookies was to send them with a passed date
> ('expires=1971' or something).
>
> Some related data on this topic I found of interest:
> * sending a cookie path ('path=/; ') is Mandatory,
> else Netscape|Lynx won't store the cookie (Explorer?);
> * domain must contain 2 dots minimum, like in 'domain=.foo.com;' (this
also
> found in Zope sources, but not yet tested on my own). Could someone
confirm?
>
> Cheers, Vio



From gharris at centauri.mb.ca  Wed Jul 24 01:38:25 2002
From: gharris at centauri.mb.ca (George Harrison)
Date: Fri Jan  9 21:59:27 2004
Subject: [mod_python] Installing mod_python on Win98/Apache
In-Reply-To: <D31B04F24EDE7644BB169BB4F080778A01F4C546@s30342g004005>
Message-ID: <5.1.0.14.2.20020724012731.00a16dc0@pop.mb.sympatico.ca>

I think that was probably it, but I reinstalled Python, which fixed the 
problem.

thanks

gh
At 11:48 AM 2002.07.19 -0400, you wrote:
>I found that mod_python uses the pythonpath and pythonhome environment
>variables. Make sure that your normal path environment variable can reach
>python.exe. A normal python install does not create these just the .py and
>.pyc associations. If you cannot run python from a command prompt by typing
>python and a .py script, something is wrong. Next, make sure you are using
>the right .so (.dll) with the correct corresponding Apache software version.
>
>Hans
>
>-----Original Message-----
>From: George Harrison [mailto:gharris@centauri.mb.ca]
>Sent: Friday, July 19, 2002 1:19 AM
>To: mod_python@modpython.org
>Subject: [mod_python] Installing mod_python on Win98/Apache
>
>
>After following the instructions in the documentation and copying the files
>from D:\Program Files\Python22\lib\mod_python-x\lib\mod_python to
>D:\Program Files\Python22\lib\mod_python;  I can launch Apache but when I
>try to open mptest.py I get the following message in the error log:
>
>[Thu Jul 18 23:50:19 2002] [error] [client 127.0.0.1] python_handler:
>make_obcallback returned no obCallBack!
>
>Does anyone know what is happening, or have a listing of where the files
>are supposed to be in the python directory for this to work?
>
>Thanks
>
>gh
>
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://www.modpython.org/mailman/listinfo/mod_python


From matt at proweb.co.uk  Thu Jul 25 15:48:55 2002
From: matt at proweb.co.uk (matt)
Date: Fri Jan  9 21:59:27 2004
Subject: [mod_python] postgres progress
Message-ID: <008c01c233ea$69e60000$6501a8c0@KIKE>

bah, I've just run into the same problem as someone else was having 



From matt at proweb.co.uk  Thu Jul 25 16:36:39 2002
From: matt at proweb.co.uk (matt)
Date: Fri Jan  9 21:59:27 2004
Subject: [mod_python] postgres progress
Message-ID: <009d01c233f1$153ed750$6501a8c0@KIKE>

bah, I've just run into the same problem as someone else was having getting
postgres to work with mod_python

http://www.modpython.org/pipermail/mod_python/2001-August/001589.html

pgdb
PyPgSQL
psycopg

all fail to import

this is on FreeBSD 4.4 with mod_python-2.7.6
python-2.2.1
postgresql-7.2.1_1

anyone with any clues ?

M




From imcmeans at telus.net  Thu Jul 25 15:46:57 2002
From: imcmeans at telus.net (Ian McMeans)
Date: Fri Jan  9 21:59:27 2004
Subject: [mod_python] compiling in windows
Message-ID: <003301c2342d$2f28c950$44cee8d8@cr536745a>

I'm running windows XP, python 2.2, apache 2.

I can't get mod_python to compile with VC++ 6. The project file is invalid,
so I make a new one from the .dsp. When I try to compile it, (it tries to
make an .exe) it gives an error about the version.rc file mentioning
MPV_BUILD, which I delete from the file to remove the error.

Then it complains about not having httpd.h, so I download the apache source,
and copy/paste the files from the apache source to the mod_python source.

Then it complains about apr.h, which doesn't exist in the apache source.
There is a apr.h.in, apr.h.hnw, apr.h.w, and test_apr.h. I pick apr.h.w and
rename it to apr.h, copy it to the include directory for mod_python.

I end up having to copy/paste a few different include directories, and
rename some more .hn files to .h, and I still get 715 errors, most of which
are like this:
include\apr_pools.h(191) : error C2061: syntax error : identifier
'apr_pool_initialize'

THere's also this error at the beginning:
Warning: cannot find "mod_python.dep"

Is there somewhere I can download the binary for windows? Or is there a
better way to
compile it in windows, like merging VC projects or something?


From vmilitaru at sympatico.ca  Fri Jul 26 01:49:03 2002
From: vmilitaru at sympatico.ca (vmilitaru@sympatico.ca)
Date: Fri Jan  9 21:59:27 2004
Subject: [mod_python] postgres progress
In-Reply-To: <009d01c233f1$153ed750$6501a8c0@KIKE>; from matt@proweb.co.uk on Thu, Jul 25, 2002 at 04:36:39PM +0100
References: <009d01c233f1$153ed750$6501a8c0@KIKE>
Message-ID: <20020726014902.A317@eye.neb>

If all else fails, you can always consider alternatives. 
One setup example (which does seem to work for couple months now):
* python 2.1
* apache 1.3.26
* mod_ssl 2.8.10
* mod_python 2.7.8
* DCOracle2 1.84 (python interface to Oracle)
* Oracle 8i
(All humming inside a Linux 2.4.2 without a glitch)

That is, of course, if you're not overly religious about postgres.
Cheers, Vio

* matt <matt@proweb.co.uk> [020726 01:20]:
> bah, I've just run into the same problem as someone else was having getting
> postgres to work with mod_python
> 
> http://www.modpython.org/pipermail/mod_python/2001-August/001589.html
> 
> pgdb
> PyPgSQL
> psycopg
> 
> all fail to import
> 
> this is on FreeBSD 4.4 with mod_python-2.7.6
> python-2.2.1
> postgresql-7.2.1_1
> 
> anyone with any clues ?
> 
> M
> 
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

From oliver at redgecko.org  Fri Jul 26 08:30:38 2002
From: oliver at redgecko.org (Oliver Cope)
Date: Fri Jan  9 21:59:27 2004
Subject: [mod_python] postgres progress
In-Reply-To: <009d01c233f1$153ed750$6501a8c0@KIKE>
References: <009d01c233f1$153ed750$6501a8c0@KIKE>
Message-ID: <20020726073038.GA1165@namib.redgecko.org>

On Thu, Jul 25, 2002 at 04:36:39PM +0100, matt wrote:
> bah, I've just run into the same problem as someone else was having getting
> postgres to work with mod_python
> 
> http://www.modpython.org/pipermail/mod_python/2001-August/001589.html
> 
> pgdb
> PyPgSQL
> psycopg
> 
> all fail to import
> 
Have you tried using the PyGreSQL which comes with PostgreSQL?

If you configure PostgreSQL with --with-python it will build and install 
PyGreSQL, and this seems quite stable for use with mod_python.

As I keep as non-threaded installation of Python for use with
mod_python separate from my main python installation, I had to modify
PATH to get PostgreSQL to install the module in the right place:

  % PATH=/opt/python2.1.2-nothreads/bin/:$PATH ./configure --with-python

(PostgreSQL 7.2, mod_python 2.7.6 and python 2.1.2 on OpenBSD 3.1)

Regards,

Olly.


From barr at cs.cornell.edu  Fri Jul  5 02:14:33 2002
From: barr at cs.cornell.edu (Rimon Barr)
Date: Fri Jan  9 21:59:27 2004
Subject: [mod_python] spyce v1.1.18
Message-ID: <Pine.LNX.4.44.0207050213320.12609-100000@pompom.u.cs.cornell.edu>

SPYCE - Server Python Pages

SPYCE is a drop-in Apache module that supports simple and efficient
Python-based dynamic HTML scripting. Those who like Python and are
familiar with JSP, or PHP, or ASP, should have a look at this engine. It
allows one to generate dynamic HTML content just as easily, using Python
for the dynamic parts. Its modular design makes it very flexible and
extensible. It can also be used as a command-line utility for HTML
pre-processing, and also via CGI or FCGI on other servers.

v1.1.18 released on 5 July 2002.

Get it at:
  http://spyce.sourceforge.net

----------
Partial change log:

v1.1.18
  fcgi support added
  X-Spyce header added
  documentation: how to write new modules

v1.1.17
  feature request - compaction algorithm improved

v1.1.16
  generalised session.setHandler (session handler selection mechanism)
  gdbm, bsd db session handlers added

v1.1.15
  minor makefile and rpm script changes
  handling of multi-line strings in python code
  response.flush() added

v1.1.14
  wrappers to check python version

v1.1.13
  added new language construct: "Python chunks"

v1.1.12
  stdout module redirects stdout to response object
  added writeln() to response module


From jack_diederich at email.com  Mon Jul 29 11:20:21 2002
From: jack_diederich at email.com (Jack Diederich)
Date: Fri Jan  9 21:59:27 2004
Subject: [mod_python] Fw: slow child init problems
Message-ID: <20020729162021.20546.qmail@email.com>

I tried sending this before I was a member of the list, and  I guess it wasn't approved...

I have a project running under mod_python with about 10k of python source.

On a pIII-500 it takes 2 seconds for the first request to an httpd process,
and 0.2 seconds for each request after that to run.  This isn't a show stopper
for now, but it really bugs me (the software will be production in about a month)

I've thought of switching to WebWare, which shouldn't have this problem, but is
otherwise more than I need and the switching costs would be non-zero.

The problem seems to be that the imports, even with the PythonImport directive listing all of them
aren't done until ChildInitHanlder(), which is called the first time a child process
gets its first hit, apparently.  I say apparently because the difference between
using PythonImport or not is zero time-wise.  Using .pyo files instead of .py
cuts the first-hit time in half, but is still five times
larger than the time to handle a second hit.

Why can't the work (whatever it is) be done _before_ the fork of the children?
This is what mod_perl does.  mod_php doesn't, it has some possibly intentional
design problems that require a fresh interperator init and byte compile between
requests (but there are hooks in the code for the $ work-aournd module).
But looking through the python internals I couldn't figure out why this isn't possible. I couldn't figure out where to patch it myself, but I didn't see any showstoppers like with php.

So ... anyone know how to work around this, why its done this way, or where I
should look to patch it?

thanks in advance,
-jackdied

-- 
__________________________________________________________
Sign-up for your own FREE Personalized E-mail at Mail.com
http://www.mail.com/?sr=signup

Get 4 DVDs for $.49 cents! plus shipping & processing. Click to join.
http://adfarm.mediaplex.com/ad/ck/990-1736-3566-59


From grisha at modpython.org  Mon Jul 29 21:36:14 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:27 2004
Subject: [mod_python] Fw: slow child init problems
In-Reply-To: <20020729162021.20546.qmail@email.com>
Message-ID: <Pine.BSF.4.32.0207292038430.25221-100000@localhost>

On Mon, 29 Jul 2002, Jack Diederich wrote:

> The problem seems to be that the imports, even with the PythonImport
> directive listing all of them aren't done until ChildInitHanlder(),
> which is called the first time a child process gets its first hit,
> apparently.  I say apparently because the difference between using
> PythonImport or not is zero time-wise.

[snip]

> Why can't the work (whatever it is) be done _before_ the fork of the
> children?

[snip]

First, you should look at making sure that everything runs under one
sub-interpreter. The information such as the name of the virtual host is
undefined until the actual request comes in, so PythonImport imports
everything under the interpreter named after the directory in the
surrounding <Directory> tag or the main interpreter. Your other code
probably runs in the subinterpreter for that virtual server, so it ends up
reimporting everything again. You can force everything to run under the
main interpreter by specifying "PythonInterpreter main_interpreter".

It's possible that you're right that ChildInit gets executed on the first
hit, I can't answer this off the top of my head without digging in apache
source code or experimenting. The reason PythonImport stuff does not get
executed at Apache startup before it forks is because at that point Apache
is run as root.

IMHO PythonImport is bad and shouldn't be there. I understand the issue,
but PythonImport isn't the cleanest solution to it because of the way it
ends up having be implemented, and I can't think of anything clever that
would address this.

One simple hack to tackle this problem is to add something into your
Apache startup script that initiates the first hit using wget or fetch or
lynx or whatever. I've used this technique very successfuly before.

Grisha


From jack_diederich at email.com  Mon Jul 29 23:24:42 2002
From: jack_diederich at email.com (Jack Diederich)
Date: Fri Jan  9 21:59:27 2004
Subject: [mod_python] How mod_perl does Imports vs mod_python
Message-ID: <20020730042442.7423.qmail@email.com>

Followup to my earlier post about slow init times.
mod_perl only has one interpreter.  It processes
imports as the last thing before leaving the apache
module init function (in mod_python, this would be
python_init())

If the main interpreter exists by the end of python_init()
[I think it does, but I don't know the interpreter internals
at all] we could at least populate that with the PythonImport
directives from httpd.conf

This wouldn't solve the problem for everyone (those using
virtual hosts) but it would at least solve mine :)
Optionally to support virtual hosts there could be a directive to prespawn sub-interpreters and process the 
import directives for those too.

Can any of the mod_python authors comment?  I might be
able to try my hand at a patch in a month, but for now 
I'll just stick with my workaround (ugly combination of a 
proxy and wget)

mod_perl also has a lot of logic to differentiate between a
stop/start and a restart.  In the restart case it actually
does the import _while_ reading the config.  In the fresh
start case it waits until the end of the init function.
I don't know if you can purge or overwrite import info in
a python interpreter like you can with perl. (perl just has
one big namespace plus smaller funciton/loop/etc variables).

Use of globals and macros to access them to keep track of
information about startup, pending imports, etc.

-jackdied


-- 
__________________________________________________________
Sign-up for your own FREE Personalized E-mail at Mail.com
http://www.mail.com/?sr=signup

Get 4 DVDs for $.49 cents! plus shipping & processing. Click to join.
http://adfarm.mediaplex.com/ad/ck/990-1736-3566-59


From peter.bittner at gmx.net  Tue Jul 30 18:54:48 2002
From: peter.bittner at gmx.net (Peter Bittner)
Date: Fri Jan  9 21:59:27 2004
Subject: [mod_python] Configuring Apache
Message-ID: <3055.1028048088@www55.gmx.net>

Hi,

I've got SuSE Linux 8.0, so there are probably the latest stable versions of
mod_python and Apache on my computer. Apache is installed with the
mod_python module (an appropriate message shows up, when the apache server ist
(re)started.)

However, since .py files are obviously not recognized as Python scripts I
have added the following lines to my httpd.conf file in the mime-types section:

    #
    # Python:
    #
    <IfModule mod_python.c>
    AddType application/x-httpd-python .py
    AddHandler python-program .py
    #PythonHandler index
    </IfModule>

Now it comes:
When I remove the comment-character in front of the "PythonHandler"
statement, the Apache server gives me a "500 Server Misconfiguration Error".

Can anyone help me getting .py-scripts running on my Apache?

Cheers, Peter

-- 
Peter Bittner
mobil: +43/(0)650/4151545
web: http://beam.to/peter.bittner - http://beam.to/htmlkurs
mail: peter.bittner@gmx.net

"Free software is like free speech, not free beer" (Richard Stallman)

GMX - Die Kommunikationsplattform im Internet.
http://www.gmx.net


From jack_diederich at email.com  Mon Jul 29 21:02:27 2002
From: jack_diederich at email.com (Jack Diederich)
Date: Fri Jan  9 21:59:27 2004
Subject: [mod_python] Fw: slow child init problems
Message-ID: <20020730020227.9604.qmail@email.com>

[me]
> > Why can't the work (whatever it is) be done _before_ the fork of the
> > children?

[Gregory Trubetskoy]
> First, you should look at making sure that everything runs under one
> sub-interpreter. The information such as the name of the virtual host is
> undefined until the actual request comes in, so PythonImport imports
> everything under the interpreter named after the directory in the
> surrounding <Directory> tag or the main interpreter. Your other code
> probably runs in the subinterpreter for that virtual server, so it ends up
> reimporting everything again. You can force everything to run under the
> main interpreter by specifying "PythonInterpreter main_interpreter".

I'm not running any virtual servers. I tried the directive
and it had the same behavior (first time a process gets
hit it takes 10 times the second and further hits)

> It's possible that you're right that ChildInit gets executed on the first
> hit, I can't answer this off the top of my head without digging in apache
> source code or experimenting. 

I've looked at the code, and it doesn't get called until the
first hit.  BTW, one thing I love about python (and
mod_python) is that the source is incredibly easy to browse
and understand (compare perl internals).

That said, I'm going to go swimming in perl/mod_perl for a
bit to see how they do it. Failing that, maybe I'll hit up
the mod_perl mailing list for help.

thanks,

-jackdied







-- 
__________________________________________________________
Sign-up for your own FREE Personalized E-mail at Mail.com
http://www.mail.com/?sr=signup

Get 4 DVDs for $.49 cents! plus shipping & processing. Click to join.
http://adfarm.mediaplex.com/ad/ck/990-1736-3566-59


From peter.bittner at gmx.net  Tue Jul 30 19:14:32 2002
From: peter.bittner at gmx.net (Peter Bittner)
Date: Fri Jan  9 21:59:27 2004
Subject: [mod_python] Re: Configuring Apache
Message-ID: <6296.1028049272@www55.gmx.net>

Hi,

I've probably found the reason why Apache shows a 500-error. The Apache
error log shows:

  make_obcallback(): could not import mod_python.apache.
  make_obcallback(): could not call init.

This because I tried to execute the following script (index.py):

  from mod_python import apache
  def handler(req):
        req.send_http_header()
        req.write("hello %s" % req.remote_host)
        return apache.OK

And when I run python from the commandline and try this:
  import mod_python
Python tells me it doesn't know any module named mod_python!

How do I fix this problem??

Peter


-- 
Peter Bittner
mobil: +43/(0)650/4151545
web: http://beam.to/peter.bittner - http://beam.to/htmlkurs
mail: peter.bittner@gmx.net

"Free software is like free speech, not free beer" (Richard Stallman)

GMX - Die Kommunikationsplattform im Internet.
http://www.gmx.net


From vmilitaru at sympatico.ca  Tue Jul 30 14:25:47 2002
From: vmilitaru at sympatico.ca (vmilitaru@sympatico.ca)
Date: Fri Jan  9 21:59:28 2004
Subject: [mod_python] Configuring Apache
In-Reply-To: <3055.1028048088@www55.gmx.net>; from peter.bittner@gmx.net on Tue, Jul 30, 2002 at 06:54:48PM +0200
References: <3055.1028048088@www55.gmx.net>
Message-ID: <20020730142546.A979@eye.neb>

Sounds like you haven't read the mod_python (excellent!) docs.
I suggest you start with that. FAQ has also useful tips for your next hurdles.
But the 'fast and dirty' answer to your question is:

PythonHandler publisher

but eventually (hopefully):

PythonHandler your_own_customized_publisher

Cheers,
Vio

* Peter Bittner <peter.bittner@gmx.net> [020730 14:15]:
> Hi,
> 
> I've got SuSE Linux 8.0, so there are probably the latest stable versions of
> mod_python and Apache on my computer. Apache is installed with the
> mod_python module (an appropriate message shows up, when the apache server ist
> (re)started.)
> 
> However, since .py files are obviously not recognized as Python scripts I
> have added the following lines to my httpd.conf file in the mime-types section:
> 
>     #
>     # Python:
>     #
>     <IfModule mod_python.c>
>     AddType application/x-httpd-python .py
>     AddHandler python-program .py
>     #PythonHandler index
>     </IfModule>
> 
> Now it comes:
> When I remove the comment-character in front of the "PythonHandler"
> statement, the Apache server gives me a "500 Server Misconfiguration Error".
> 
> Can anyone help me getting .py-scripts running on my Apache?
> 
> Cheers, Peter
> 
> -- 
> Peter Bittner
> mobil: +43/(0)650/4151545
> web: http://beam.to/peter.bittner - http://beam.to/htmlkurs
> mail: peter.bittner@gmx.net
> 
> "Free software is like free speech, not free beer" (Richard Stallman)
> 
> GMX - Die Kommunikationsplattform im Internet.
> http://www.gmx.net
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

From list-mod_python at empires.org  Tue Jul 30 13:35:34 2002
From: list-mod_python at empires.org (Jeff Davis)
Date: Fri Jan  9 21:59:28 2004
Subject: [mod_python] Configuring Apache
In-Reply-To: <3055.1028048088@www55.gmx.net>
References: <3055.1028048088@www55.gmx.net>
Message-ID: <200207301335.34801.list-mod_python@empires.org>

Here is my configuration information (note: I use the publisher handler, find 
out more about the different built-in handlers at http://www.modpython.org):

AddHandler python-program .py
PythonHandler mod_python.publisher
PythonDebug On

Regards,
	Jeff

On Tuesday 30 July 2002 09:54 am, Peter Bittner wrote:
> Hi,
>
> I've got SuSE Linux 8.0, so there are probably the latest stable versions
> of mod_python and Apache on my computer. Apache is installed with the
> mod_python module (an appropriate message shows up, when the apache server
> ist (re)started.)
>
> However, since .py files are obviously not recognized as Python scripts I
> have added the following lines to my httpd.conf file in the mime-types
> section:
>
>     #
>     # Python:
>     #
>     <IfModule mod_python.c>
>     AddType application/x-httpd-python .py
>     AddHandler python-program .py
>     #PythonHandler index
>     </IfModule>
>
> Now it comes:
> When I remove the comment-character in front of the "PythonHandler"
> statement, the Apache server gives me a "500 Server Misconfiguration
> Error".
>
> Can anyone help me getting .py-scripts running on my Apache?
>
> Cheers, Peter


From peter.bittner at gmx.net  Wed Jul 31 17:40:53 2002
From: peter.bittner at gmx.net (Peter Bittner)
Date: Fri Jan  9 21:59:28 2004
Subject: [mod_python] make_obcallback(): could not import mod_python.apache
References: <200207301335.34801.list-mod_python@empires.org>
Message-ID: <28386.1028130053@www30.gmx.net>

I have mod_python installed on SuSE Linux 8.0 and I have set up my
httpd.conf according to the mod_python documentation, but unfortunately I get the
following error message in my error log:

make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.

I have also tried the import statement in my python interpreter, but it
says:

>>> from mod_python import apache
Traceback (most recent call last):
  File "<stdin>", line 1, in ?
ImportError: No module named mod_python

So there seems to be no mod_python module available! (Where has it gone? -
This doesn't seem to be an ordinary error, does it?) I havn't found any answer
ind the FAQs regarding this problem.

Please help!
Peter


-- 
Peter Bittner
mobil: +43/(0)650/4151545
web: http://beam.to/peter.bittner - http://beam.to/htmlkurs
mail: peter.bittner@gmx.net

"Free software is like free speech, not free beer" (Richard Stallman)

GMX - Die Kommunikationsplattform im Internet.
http://www.gmx.net


From christoph at cocon-seide.com  Wed Jul 31 17:51:45 2002
From: christoph at cocon-seide.com (Christoph Fritzsch)
Date: Fri Jan  9 21:59:28 2004
Subject: [mod_python] Configuring Apache
Message-ID: <200207311554.g6VFsWs48906@eden.ispol.com>

Hi Peter,

I tried it with Suse 7.3 some time ago and found it only workable by 

1) uncommenting all <Ifmodule python>  </if..>

#<IfDefine Python>
LoadModule python_module      /usr/lib/apache/mod_python.so
#</IfDefine>
#<IfDefine Python>
AddModule mod_python.c
#</IfDefine>

so the module is loaded for sure, as I couldnt get it to work with the Suse supplied 
starting parameters

2) Then I put this in there

#Python
#<IfModule mod_python.c>
<Directory "/usr/local/httpd/htdocs/test">
AddHandler python-program .py
PythonHandler mptest
PythonDebug On
</Directory>
#</IfModule>

as you did it

and  I also had to put in a  link 
/usr/lib/python2.1/site-packages/mod_python 
->/usr/lib/apache/lib/python2.1/site-packages/mod_python/

maybe you hv to replace the 2.1 to 2.2

reload apache and any file you call in the test directory will execute the mptest program

This is what the mod_python should do. That is as far as I got. I think next step is to 
expand the mptest program so you can call subroutines in it which presumaly do more 
usefull stuff than "Hello World!" !!

BR Christoph


From daniel at copyleft.no  Sun Jul 14 10:53:01 2002
From: daniel at copyleft.no (Hr. Daniel Mikkelsen)
Date: Fri Jan  9 21:59:29 2004
Subject: [mod_python] Understanding mod_python
In-Reply-To: <1026635587.26526.30.camel@kernel>
Message-ID: <20020714105239.O43368-100000@unity.copyleft.no>

On 14 Jul 2002, Fabian Fagerholm wrote:

> There were also some posts about a mod_python "cookbook", and another
> poster suggested the on-line FAQ would be a good place for the
> "recipes". I totally agree - well-written example code is the best way
> to learn.
> I'd like to suggest that a new category be created in the FAQ for these
> snippets of example code.

Make it a wiki.

-- Daniel


From fabbe at paniq.net  Sun Jul 14 20:34:01 2002
From: fabbe at paniq.net (Fabian Fagerholm)
Date: Fri Jan  9 21:59:30 2004
Subject: [mod_python] Understanding mod_python
In-Reply-To: <290A467D-9742-11D6-9B12-0030653DCC28@attbi.com>
References: <290A467D-9742-11D6-9B12-0030653DCC28@attbi.com>
Message-ID: <1026668042.1616.3.camel@kernel>

On Sun, 2002-07-14 at 18:55, Jeff Stearns wrote:
> Fabian -
> 
> I'd like to review your drawings, but it's not easy for me to view 
> Postscript.  This is probably true for other folks as well.  If you can 
> offer them in another, more generic format, you may get a better 
> response.

Oh, I'm sorry. I thought Postscript was a good format for most people. I
suppose that's a un*x thing, though.

I made PDF versions of the files as well. They're all in
http://www.paniq.net/fabbe/mod_python/

I hope more people can look at the drawings now. Thanks for the
feedback, Jeff!

Cheers,
fabian

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 240 bytes
Desc: This is a digitally signed message part
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20020714/5b977028/attachment-0002.bin
From vmilitaru at sympatico.ca  Sun Jul 14 13:55:37 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 21:59:30 2004
Subject: [mod_python] Ping?
In-Reply-To: <Pine.LNX.4.44.0207131250410.31967-100000@slippy.wire.rat>; from gbenson@redhat.com on Sat, Jul 13, 2002 at 12:51:32PM +0100
References: <Pine.LNX.4.44.0207131250410.31967-100000@slippy.wire.rat>
Message-ID: <20020714135537.A278@eye.neb>

Same here. But even more problematic seems that some messages never make it to 
the list (at least some of my messages never did).
Possible solution (provided this message make it to the list): how about 
migrating modpython to 'sourceforge'? It's totally
free and they do an outstanding hosting job.

Chers,
Vio

* Gary Benson <gbenson@redhat.com> [020714 13:45]:
> 
> It seems that I am getting messages from this list with a four day lag. 
> Is anyone else experiencing this?
> 
> Cheers,
> Gary
> 
> [ gbenson@redhat.com ][ GnuPG 85A8F78B ][ http://inauspicious.org/ ]
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

From kastner.j at supp.cz  Mon Jul 15 09:27:14 2002
From: kastner.j at supp.cz (=?iso-8859-2?Q?Ji=F8=ED_Kastner?=)
Date: Fri Jan  9 21:59:30 2004
Subject: [mod_python] compiled code execution
Message-ID: <003301c22bd1$0ac2e820$0301a8c0@pentium>

i'm interested about possibility to execute .pyc code by adding line to
httpd.conf:

AddHandler python-program .pyc

or if this is nonsense, because python is executing it directly, if is .pyc
present?
why? i'm writing web app. and this one will be distributed to others and i
need eliminate changing code by anybody (some distributions will be running
on win9x).

have anybody experience with this kind of problems?

jiri kastner




From gbenson at redhat.com  Mon Jul 15 10:17:02 2002
From: gbenson at redhat.com (Gary Benson)
Date: Fri Jan  9 21:59:30 2004
Subject: [mod_python] [PATCH] last httpd-2.0.36
Message-ID: <Pine.LNX.4.44.0207151016390.12912-200000@slippy.wire.rat>


Hi,

The attached patch brings the input filtering API in mod_python into line 
with that in httpd-2.0.36.  This is the last thing that I know of that 
needed fixing to work with 2.0.36, although I beleive some more fixes will 
be in order to build against 2.0.39 or whatever it is now :)

Cheers,
Gary

[ gbenson@redhat.com ][ GnuPG 85A8F78B ][ http://inauspicious.org/ ]
-------------- next part --------------
Bring input filter API in line with 2.0.36

Index: src/filterobject.c
===================================================================
RCS file: /cvsroot/modpython/mod_python/src/filterobject.c,v
retrieving revision 1.5
diff -u -r1.5 filterobject.c
--- src/filterobject.c	3 Jun 2002 14:31:15 -0000	1.5
+++ src/filterobject.c	9 Jul 2002 16:21:27 -0000
@@ -61,7 +61,7 @@
  */
 
 PyObject *MpFilter_FromFilter(ap_filter_t *f, apr_bucket_brigade *bb, int is_input,
-			      ap_input_mode_t mode, apr_size_t *readbytes,
+			      ap_input_mode_t mode, apr_size_t readbytes,
 			      char * handler, char *dir)
 {
     filterobject *result;
@@ -86,7 +86,7 @@
 	result->bb_in = bb;
 	result->bb_out = NULL;
 	result->mode = 0;
-	result->readbytes = NULL;
+	result->readbytes = 0;
     }
 
     result->closed = 0;
@@ -142,7 +142,7 @@
 
 	Py_BEGIN_ALLOW_THREADS;
 	self->rc = ap_get_brigade(self->f->next, self->bb_in, self->mode, 
-				  APR_BLOCK_READ, *self->readbytes);
+				  APR_BLOCK_READ, self->readbytes);
 	Py_END_ALLOW_THREADS;
 
 	if (! APR_STATUS_IS_SUCCESS(self->rc)) {
@@ -239,7 +239,7 @@
 
 		Py_BEGIN_ALLOW_THREADS;
 		self->rc = ap_get_brigade(self->f->next, self->bb_in, self->mode, 
-					  APR_BLOCK_READ, *self->readbytes);
+					  APR_BLOCK_READ, self->readbytes);
 		Py_END_ALLOW_THREADS;
 
 		if (! APR_STATUS_IS_SUCCESS(self->rc)) {
Index: src/mod_python.c
===================================================================
RCS file: /cvsroot/modpython/mod_python/src/mod_python.c,v
retrieving revision 1.60
diff -u -r1.60 mod_python.c
--- src/mod_python.c	3 Jun 2002 14:31:15 -0000	1.60
+++ src/mod_python.c	9 Jul 2002 16:21:35 -0000
@@ -1023,7 +1023,8 @@
 static apr_status_t python_filter(int is_input, ap_filter_t *f, 
 				  apr_bucket_brigade *bb,
 				  ap_input_mode_t mode,
-				  apr_size_t *readbytes) {
+				  apr_read_type_e block,
+				  apr_size_t readbytes) {
 
     PyObject *resultobject = NULL;
     interpreterdata *idata;
@@ -1052,8 +1053,7 @@
        so a fitler can spit out an error without causing infinite loop */
     if (ctx->transparent) {
 	if (is_input) 
-	    return ap_get_brigade(f->next, bb, mode, APR_BLOCK_READ, 
-				  *readbytes);
+	    return ap_get_brigade(f->next, bb, mode, block, readbytes);
 	else
 	    return ap_pass_brigade(f->next, bb);
     }
@@ -1201,9 +1201,10 @@
 static apr_status_t python_input_filter(ap_filter_t *f, 
 					apr_bucket_brigade *bb,
 					ap_input_mode_t mode,
-					apr_size_t *readbytes) 
+					apr_read_type_e block,
+					apr_off_t readbytes)
 {
-    return python_filter(1, f, bb, mode, readbytes);
+    return python_filter(1, f, bb, mode, block, readbytes);
 }
 
 
@@ -1216,7 +1217,7 @@
 static apr_status_t python_output_filter(ap_filter_t *f, 
 					 apr_bucket_brigade *bb)
 {
-    return python_filter(0, f, bb, 0, NULL);
+    return python_filter(0, f, bb, 0, 0, 0);
 }
 
 
Index: src/include/filterobject.h
===================================================================
RCS file: /cvsroot/modpython/mod_python/src/include/filterobject.h,v
retrieving revision 1.4
diff -u -r1.4 filterobject.h
--- src/include/filterobject.h	3 Jun 2002 14:31:16 -0000	1.4
+++ src/include/filterobject.h	9 Jul 2002 16:21:36 -0000
@@ -67,7 +67,7 @@
 
 	int is_input;
 	ap_input_mode_t mode;
-	apr_size_t *readbytes;
+	apr_size_t readbytes;
 
 	int closed;
 	int softspace;
@@ -88,7 +88,7 @@
     extern DL_IMPORT(PyObject *) 
 	MpFilter_FromFilter Py_PROTO((ap_filter_t *f, apr_bucket_brigade *bb_in, 
 				      int is_input, ap_input_mode_t mode, 
-				      apr_size_t *readbytes, char *hadler, char *dir));
+				      apr_size_t readbytes, char *hadler, char *dir));
 
 #ifdef __cplusplus
 }
From nicks at metrolink.com  Mon Jul 15 13:19:15 2002
From: nicks at metrolink.com (Nick Seidenman)
Date: Fri Jan  9 21:59:30 2004
Subject: [mod_python] typehandler
Message-ID: <3D330413.9090203@metrolink.com>

Anyone got a quick example of how this one's used?    When I try 
something simple, like:

    def typehandler (req):
        req.content_type = 'text/plain'
        req.send_http_headers ()
        return apache.OK

I just get a listing of the module that contains this.

TiA,
Nick


From rien at yeepa.org  Fri Jul 26 00:12:44 2002
From: rien at yeepa.org (Adrien Plisson)
Date: Fri Jan  9 21:59:30 2004
Subject: [mod_python] please, old fool needs help with getting apache mod_python on windows 98 to run
References: <NDBBIADKLJIPFGPECIJPOELOCMAA.jdaily@kc.rr.com>
Message-ID: <001201c23428$67399b80$03020101@skynet.be>

From: "james daily" <jdaily@kc.rr.com>
>
> the mod_python online manual at:
>
http://www.modpython.org/live/mod_python-2.7.8/doc-html/app-wininst.html
>
> says:
> XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
...
> if someone has it actually running on their windows 98 system,
> could you please send me the ***relevant*** portions from your
> apache httpd.conf file?
>
> i have tried numerous different approaches to no avail.

ok  i posted something about the windows portion of the doc in march of this
year.
take a look at:
http://www.modpython.org/pipermail/mod_python/2002-March/001934.html
at the end of the post there is my correction to the manual, tested on
apache for NT.

now about having just the mptest.py text in your browser there was another
post in the mailing list... don't remember when, probably in april or june.
try to browse it.

> alas, i am a programmer but not (yet) an apache guru.

time will come...

> any help would be greatly appreciated.

done

--
rien



From list-mod_python at empires.org  Tue Jul 16 13:38:19 2002
From: list-mod_python at empires.org (Jeff Davis)
Date: Fri Jan  9 21:59:30 2004
Subject: [mod_python] new to mod_python, with a question.
In-Reply-To: <1026773181.12028.7.camel@locutus>
References: <1026773181.12028.7.camel@locutus>
Message-ID: <200207161338.19702.list-mod_python@empires.org>

Is is possible that you're using the publisher handler? The publisher handler 
basically does a req.write() on whatever is returned by your function. So, it 
looks like it's printing the actual text of apache.OK after all of your 
req.write()s. Look in your apache config for possible use of 
mod_python.publisher, or perhaps something else that might print the return 
of your function.

Regards,
	Jeff

On Monday 15 July 2002 03:46 pm, Bill Anderson wrote:
> OK, so here is what I am doing. I am using PageTemplates (from zope) and
> mod_python. or at least, I am trying to. :)
>
>
> if I do _NOT_ use the request object (i.e. I return a fully formed html
> string/document), it works fine. but of course, that means no use of
> mod-python's request objects functions such as cookie/header
> construction, usage, etc.
>
> To wit:
> def sayit(req,x=12):
> 	if not x:
> 		return "I need x"
> 	if not master:
> 		return "I need a master object"
> 	pt=PageTemplate()
> 	filestring =
> "".join(open("/home/ucntcme/public_html/pythonapps/test.pt").readlines())
> 	pt.write(filestring)
> 	myx=int(x)
>         req.content_type="text/html"
>         req.send_http_headers()
> 	req.write( pt(x=myx,master=master) )
> 	return apache.OK
>
> returns my rendered template, but at the bottom has:
>
> HTTP/1.1 200 OK Date: Mon, 15 Jul 2002 22:44:27 GMT Server:
> Apache/1.3.22 (Unix) (Red-Hat/Linux) mod_python/2.7.8 Python/2.2.1
> mod_ssl/2.8.5 OpenSSL/0.9.6b DAV/1.0.2 PHP/4.0.6 mod_perl/1.26
> Connection: close Transfer-Encoding: chunked Content-Type: text/html;
> charset=iso-8859-1
> OK
> The server encountered an internal error or misconfiguration and was
> unable to complete your request.
>
>
>
> Debug is on, and there are no mesages in the error_log.
>
> Now, if I just return the content using return (content), it works fine.
>
> Why is this/what am I doing wrong here?
>
> Cheers, Bill
>
>
>
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From bill at immosys.com  Tue Jul 16 17:41:41 2002
From: bill at immosys.com (Bill Anderson)
Date: Fri Jan  9 21:59:30 2004
Subject: [mod_python] new to mod_python, with a question.
In-Reply-To: <200207161338.19702.list-mod_python@empires.org>
References: <1026773181.12028.7.camel@locutus> 
	<200207161338.19702.list-mod_python@empires.org>
Message-ID: <1026862902.17401.28.camel@locutus>

On Tue, 2002-07-16 at 14:38, Jeff Davis wrote:
> Is is possible that you're using the publisher handler? The publisher handler 

Yes, I am ...

> basically does a req.write() on whatever is returned by your function. So, it 
> looks like it's printing the actual text of apache.OK after all of your 
> req.write()s. Look in your apache config for possible use of 

Ah, I see. Ok. So now that I know why...

How can I have a funtion that writes all the HTML, and still use
mod_python's cookie functions? can I use them, even though I return
html, instead of the req.writes() and return apache.OK combo?





From tree at basistech.com  Tue Jul 16 22:01:46 2002
From: tree at basistech.com (Tom Emerson)
Date: Fri Jan  9 21:59:30 2004
Subject: [mod_python] freebsd
In-Reply-To: <F1478v6eoHvEmsgTFsF000136d0@hotmail.com>
References: <F1478v6eoHvEmsgTFsF000136d0@hotmail.com>
Message-ID: <15668.53258.78331.46765@magrathea.basistech.com>

Edgar Castanedo writes:
> I have installed Python on FreeBSD from the ports collection. When I
> try and install mod_python (from the ports collection also), a
> message is returned which states that Python needs to be installed
> WITHOUT threads. I am not sure if this is okay since I write lots of
> Python script and don't know how this will affect Pythons
> performance. Can anyone shed some light on this for me as I do not
> want to disable threads if it means that my scripts will not work
> the way they used to.

Unless you are explicitly using threads in your existing Python
scripts, don't worry about. I would not expect the performance to
degrade too much, if at all.

On some systems (e.g., Linux) you can run mod_python with a threaded
Python interpreter without a hitch. Unfortunately if you want to use
mod_python on FreeBSD you'll need to rebuild your Python distribution.

    -tree


-- 
Tom Emerson                                          Basis Technology Corp.
Sr. Computational Linguist                         http://www.basistech.com
  "Beware the lollipop of mediocrity: lick it once and you suck forever"

From gharris at centauri.mb.ca  Wed Jul 17 02:46:24 2002
From: gharris at centauri.mb.ca (George Harrison)
Date: Fri Jan  9 21:59:30 2004
Subject: [mod_python] Installing mod_python on Win98/Apache
Message-ID: <5.1.0.14.2.20020717020135.01dd78a0@pop.mts.net>

After following the instructions in the documentation and copying the files 
from C:\Program Files\Python\lib\mod_python-x\lib\mod_python to C:\Program 
Files\Python\lib\mod_python; when I launch Apache I get the message:

Syntax error on line 194 of c:/program piles/apache 
group/apache/conf/httpd.conf:

Cannot load module
c:/program files/apache group/apache/modules/mod_python.dll
into server: (1157) One of the library files needed to run
this application cannot be found.

line 194 consists of "LoadModule python_module modules/mod_python.dll"
I have added the line "AddModule mod_python.c" after the ClearModuleList 
Directive, but the program doesn't seem to be getting that far in httpd.conf.

Does anyone know what I'm doing wrong?

Thanks

gh


From gharris at centauri.mb.ca  Fri Jul 19 00:30:54 2002
From: gharris at centauri.mb.ca (George Harrison)
Date: Fri Jan  9 21:59:30 2004
Subject: [mod_python] Test, please ignore
Message-ID: <5.1.0.14.2.20020719003018.027ccb90@pop.mb.sympatico.ca>

test


From mark.evans.b at bayer.com  Fri Jul 19 09:59:41 2002
From: mark.evans.b at bayer.com (Mark Evans)
Date: Fri Jan  9 21:59:30 2004
Subject: [mod_python] mod_python and W2K
Message-ID: <200207191657.g6JGvHs84445@eden.ispol.com>

Hi All,

I know this general issue has come up before and I have tried everything I have
found in the archives, but nothing works.  So please bear with me.  I am trying
to get mod_python to run on W2K.  Apache is installed as a service.  My system
configuration is this:

W2K SP2
Apache 1.3.24
Python 2.1.3
mod_python-2.7.6

Environment variables:
path contains  C:\Python21\;
PYTHONPATH = C:\Program Files\Apache Group\Apache\htdocs\python  (this was added
per an archive post, doesn't work with or without it)

From gerard.patel at nerim.net  Mon Jul  1 23:43:06 2002
From: gerard.patel at nerim.net (Gerard Patel)
Date: Fri Jan  9 22:03:15 2004
Subject: [mod_python] Apache 2.0.39 and publisher
Message-ID: <1.5.4.32.20020701214306.417866e0@pop.nerim.net>

Hello,

First thing first : I'm a rank beginner with Apache *and* Python :-)

I want to learn both and am trying to setup a very small web site
to test.
I am giving mod_python a try, with Apache 2.0.39, mod_python
from CVS, Python 2.2

Hum, a little question : docu states that Python should be compiled
with no threading support, however in the code I see a 
WITH_THREAD flag, is this restriction still valid for current
CVS ? It seems to work, but my testing is somewhat 
limited for now.

Now, the problems :

First problem : mod_python does not compile

fix :

--- requestobject.c.orig        Mon Jun  3 16:31:15 2002
+++ requestobject.c     Sun Jun 30 11:05:05 2002
@@ -743,7 +743,6 @@
     {"bytes_sent",         T_LONG,      OFF(bytes_sent),           RO},
     {"mtime",              T_LONG,      OFF(mtime),                RO},
     {"chunked",            T_INT,       OFF(chunked),              RO},
-    {"boundary",           T_STRING,    OFF(boundary),             RO},
     {"range",              T_STRING,    OFF(range),                RO},
     {"clength",            T_LONG,      OFF(clength),              RO},
     {"remaining",          T_LONG,      OFF(remaining),            RO},

The Apache guys removed this field from the last version I downloaded
(the aborted 2.0.37) and 2.0.39. Strange.


Second problem : the publisher.

I test it with a minimal app that just displays the one field of
my page :

def Bouton1(req, TextField1):

    s = TextField1
    return s

It works fine, but if I reload the form immediately after, it does
not work unless I wait about 15 seconds.

Fix :
--- apache.py.orig      Wed Apr 10 23:24:24 2002
+++ apache.py   Mon Jul  1 23:21:25 2002
@@ -399,8 +399,9 @@

         # but is it in the path?
         file = module.__dict__.get("__file__")
-        if not file or (path and not file in path):
-                raise SERVER_RETURN, HTTP_NOT_FOUND
+       pathfile, filefile = os.path.split(file)
+        if not file or (path and not pathfile in path):
+               raise SERVER_RETURN, HTTP_NOT_FOUND

         if autoreload:
             oldmtime = module.__dict__.get("__mtime__", 0)

I suspect that this is not elegant Python or even correct, 
please remember that I have written a grand total of about 
300 lines of Python so far.

Anyway, with the change it seems to work better at least.

Thanks for your comments, I am ready to try any
better ideas that you want me to test, and sorry
if I have just misconfigured the beast; I have read
the archive a bit and seen something similar
to my second problem, but no solution AFAICT.


Gerard Patel


From mateusz at ant.gliwice.pl  Wed Jul  3 00:57:10 2002
From: mateusz at ant.gliwice.pl (Mateusz Korniak)
Date: Fri Jan  9 22:03:15 2004
Subject: [mod_python] How to make 307 Temporary Redirect using mod_python ?
Message-ID: <200207022257.g62MvFs10490@eden.ispol.com>

I can't make temporary redirect using mod_python.

I tried code:

def handler(req):
	# some code genereting url - where to redirect
	req.headers_out["Location"] = url
	req.send_http_header()
	return apache.HTTP_TEMPORARY_REDIRECT

but it produces such (not as intended) HTTP talk:

browser:
GET /abbon/advsel/advsel.py?a=1;u=388 HTTP/1.1
Connection: Keep-Alive
User-Agent: Mozilla/5.0 (compatible; Konqueror/2.2-11; Linux)
Pragma: no-cache
Cache-control: no-cache
Accept: text/*, image/jpeg, image/png, image/*, */*
Accept-Encoding: x-gzip, gzip, identity
Accept-Charset: iso-8859-2, utf-8, *
Accept-Language: en_GB, pl_PL, en
Host: appserver.ant.cipe
Cookie: SES=1

server response:
HTTP/1.1 200 OK
Date: Tue, 02 Jul 2002 21:14:01 GMT
Server: Apache/1.3.23 (Unix)  (Red-Hat/Linux) mod_python/2.7.8 Python/1.5.2
Location: http://www.noblisci.bnet.pl
Connection: close
Transfer-Encoding: chunked
Content-Type: text/plain

21c
HTTP/1.1 200 OK
Date: Tue, 02 Jul 2002 21:14:01 GMT
Server: Apache/1.3.23 (Unix)  (Red-Hat/Linux) mod_python/2.7.8 Python/1.5.2
Location: http://www.noblisci.bnet.pl
Connection: close
Transfer-Encoding: chunked
Content-Type: text/html; charset=iso-8859-1

<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<HTML><HEAD>
<TITLE>200 OK</TITLE>
</HEAD><BODY>
<H1>OK</H1>
The document has moved <A HREF="http://www.noblisci.bnet.pl">here</A>.<P>
<HR>
<ADDRESS>Apache/1.3.23 Server at appserver.ant.cipe Port 80</ADDRESS>
</BODY></HTML>


Server returns HTTP/1.1 200 OK instead of 307 <whatever> ...
What I'm doing wrong ?
TIA for any help.

-- 
Mateusz Korniak


From ps0 at igmp.com.ar  Tue Jul  2 19:48:03 2002
From: ps0 at igmp.com.ar (ps0@igmp.com.ar)
Date: Fri Jan  9 22:03:15 2004
Subject: [mod_python] Problems creating files from mod_python
Message-ID: <20020702194803.A27995@igmp.com.ar>

Apache: 1.3.24
mod_python: 2.7.8
Python: 2.2 (w/threads) [i have to recompile it
without threads]


fd=open("/tmp/bleh.txt", "w")
fd.write("HOLA\n")
fd.close()

On the fd.close() it make this error:
IOError: [Errno 9] Bad file Descriptor 

The file is created but i can't write on it.


The perms are corectly applied, from a python script ( out of apache )
the thinks work ok.

Sugestions apreciated.

Tnks in advance.

Hector.

From peter at webreply.com  Tue Jul  2 19:21:37 2002
From: peter at webreply.com (Peter McA'Nulty)
Date: Fri Jan  9 22:03:15 2004
Subject: [mod_python] How to make 307 Temporary Redirect using mod_python ?
References: <200207022257.g62MvFs10490@eden.ispol.com>
Message-ID: <000701c2221f$36f8a2b0$0201a8c0@Peter8100>

before you call req.send_http_header(), you have to set the req.status
field:
req.status = HTTP_TEMPORARY_REDIRECT

peter

----- Original Message -----
From: "Mateusz Korniak" <mateusz@ant.gliwice.pl>
To: <mod_python@modpython.org>
Sent: Tuesday, July 02, 2002 6:57 PM
Subject: [mod_python] How to make 307 Temporary Redirect using mod_python ?


> I can't make temporary redirect using mod_python.
>
> I tried code:
>
> def handler(req):
> # some code genereting url - where to redirect
> req.headers_out["Location"] = url
> req.send_http_header()
> return apache.HTTP_TEMPORARY_REDIRECT
>
> but it produces such (not as intended) HTTP talk:
>
> browser:
> GET /abbon/advsel/advsel.py?a=1;u=388 HTTP/1.1
> Connection: Keep-Alive
> User-Agent: Mozilla/5.0 (compatible; Konqueror/2.2-11; Linux)
> Pragma: no-cache
> Cache-control: no-cache
> Accept: text/*, image/jpeg, image/png, image/*, */*
> Accept-Encoding: x-gzip, gzip, identity
> Accept-Charset: iso-8859-2, utf-8, *
> Accept-Language: en_GB, pl_PL, en
> Host: appserver.ant.cipe
> Cookie: SES=1
>
> server response:
> HTTP/1.1 200 OK
> Date: Tue, 02 Jul 2002 21:14:01 GMT
> Server: Apache/1.3.23 (Unix)  (Red-Hat/Linux) mod_python/2.7.8
Python/1.5.2
> Location: http://www.noblisci.bnet.pl
> Connection: close
> Transfer-Encoding: chunked
> Content-Type: text/plain
>
> 21c
> HTTP/1.1 200 OK
> Date: Tue, 02 Jul 2002 21:14:01 GMT
> Server: Apache/1.3.23 (Unix)  (Red-Hat/Linux) mod_python/2.7.8
Python/1.5.2
> Location: http://www.noblisci.bnet.pl
> Connection: close
> Transfer-Encoding: chunked
> Content-Type: text/html; charset=iso-8859-1
>
> <!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
> <HTML><HEAD>
> <TITLE>200 OK</TITLE>
> </HEAD><BODY>
> <H1>OK</H1>
> The document has moved <A HREF="http://www.noblisci.bnet.pl">here</A>.<P>
> <HR>
> <ADDRESS>Apache/1.3.23 Server at appserver.ant.cipe Port 80</ADDRESS>
> </BODY></HTML>
>
>
> Server returns HTTP/1.1 200 OK instead of 307 <whatever> ...
> What I'm doing wrong ?
> TIA for any help.
>
> --
> Mateusz Korniak
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>



From pk1u at yahoo.com  Tue Jul  2 19:33:07 2002
From: pk1u at yahoo.com (Praveen Kumar)
Date: Fri Jan  9 22:03:15 2004
Subject: [mod_python] shared object files
Message-ID: <20020703023307.85661.qmail@web10403.mail.yahoo.com>

How do I make mod_python aware of the location of
shared object files ?

My system consists of rh7.2, apache1.3.26,
mod_python-2.7.8, python2.1.3


Eg, I'm trying to use the DCOracle2 db module; it uses
Oracle's libclntsh.so.9.0 ; I see the following when
my program accesses the DCOracle2 module:

  File
"/usr/lib/python2.1/site-packages/DCOracle2/__init__.py",
line 37, in ?
    from DCOracle2 import   *

  File
"/usr/lib/python2.1/site-packages/DCOracle2/DCOracle2.py",
line 104, in ?
    import dco2

ImportError: libclntsh.so.9.0: cannot open shared
object file: No such file or directory



I've tried the following:

Placed libclntsh.so.9.0 in /oralib and:

Placed /oralib in the PythonPath directive:

eg; httpd.conf:

<Directory /usr/local/apache/htdocs>
    AddHandler python-program .py
    PythonPath "sys.path+[ ...., '/oralib']"
    PythonHandler reqhandler
    PythonDebug On 
</Directory>

--

set LD_LIBRARY_PATH from the same shell where I start
apache:

export LD_LIBRARY_PATH=/oralib

--

Placed libclntsh.so.9.0 in
/usr/lib/python2.1/site-packages/DCOracle2 .

None of these work. The DCOracle2 module works fine
when I use it from a standalone program. Any
suggestions would be greatly appreciated.

pk


__________________________________________________
Do You Yahoo!?
Sign up for SBC Yahoo! Dial - First Month Free
http://sbc.yahoo.com

From lisicky at datis.cdrail.cz  Wed Jul  3 09:22:38 2002
From: lisicky at datis.cdrail.cz (Jiri Lisicky)
Date: Fri Jan  9 22:03:15 2004
Subject: [mod_python] Problems creating files from mod_python
In-Reply-To: <20020702194803.A27995@igmp.com.ar>
References: <20020702194803.A27995@igmp.com.ar>
Message-ID: <ch95ius9pgmdhso3cnuc6fv6m034o12p8j@4ax.com>

On Tue, 2 Jul 2002 19:48:03 -0300, you wrote:

>Apache: 1.3.24
>mod_python: 2.7.8
>Python: 2.2 (w/threads) [i have to recompile it
>without threads]
>
>
>fd=open("/tmp/bleh.txt", "w")
>fd.write("HOLA\n")
>fd.close()
>
>On the fd.close() it make this error:
>IOError: [Errno 9] Bad file Descriptor 
>
>The file is created but i can't write on it.
>
>
>The perms are corectly applied, from a python script ( out of apache )
>the thinks work ok.
>
>Sugestions apreciated.
Exists file /tmp/bleh.txt before running script from mod_python? 
Maybe you create this file by generic python script under your
username. When call it under mod_python, it is under apache account =
permission problem.
--
        Ji?? Lisick?                      ?D KM?P Olomouc
e-mail: lisicky@datis.cdrail.cz           V?de?sk? 15
 phone: +420-068-578-2272                 Olomouc, Czech Republic
              >>> ?e?tina ISO-8859-2 Compatible <<<

From R.Barrett at ftel.co.uk  Wed Jul  3 10:00:19 2002
From: R.Barrett at ftel.co.uk (Richard Barrett)
Date: Fri Jan  9 22:03:15 2004
Subject: [mod_python] Zope
In-Reply-To: <20010830170753.B23002@godel>
Message-ID: <5.1.0.14.2.20020703095730.00b08148@pop.ftel.co.uk>

At 17:07 30/08/2001 +0200, riesch@nieuw.nl wrote:
>Hi there,
>
>
>Off-topic as it is :
>
>Has anyone experience with using zope and more specificaly with its 
>database ? Is it possible to separate the database from the 
>zope-architecture ? I can't figure out how .. but it would be usefull 
>since it looks nice
>
>
>Thanks ahead,
>Richard

You want http://www.amk.ca/zodb/ and http://www.zope.org/Products/StandaloneZODB


From s_lott at yahoo.com  Wed Jul  3 03:56:37 2002
From: s_lott at yahoo.com (Steven Lott)
Date: Fri Jan  9 22:03:15 2004
Subject: [mod_python] Zope
In-Reply-To: <5.1.0.14.2.20020703095730.00b08148@pop.ftel.co.uk>
Message-ID: <20020703105637.12600.qmail@web9606.mail.yahoo.com>

The ZOPE (Z Object Persistence Environment) Object database
(ZODB), once known as BOBOBase, is available as a separate
download from ZOPE.org.

http://www.python.org/workshops/2000-01/proceedings/papers/fulton/zodb3.html

http://www.python.org/topics/database/persistence.html

http://www.zope.org/Members/michel/HowTos/ZODB-How-To

--- Richard Barrett <R.Barrett@ftel.co.uk> wrote:
> At 17:07 30/08/2001 +0200, riesch@nieuw.nl wrote:
> >Hi there,
> >
> >
> >Off-topic as it is :
> >
> >Has anyone experience with using zope and more specificaly
> with its 
> >database ? Is it possible to separate the database from the 
> >zope-architecture ? I can't figure out how .. but it would be
> usefull 
> >since it looks nice
> >
> >
> >Thanks ahead,
> >Richard
> 
> You want http://www.amk.ca/zodb/ and
> http://www.zope.org/Products/StandaloneZODB
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


=====
--
S. Lott, CCP :-{)
S_LOTT@YAHOO.COM
http://www.mindspring.com/~slott1
Buccaneer #468: KaDiMa

Macintosh user: drinking upstream from the herd.

__________________________________________________
Do You Yahoo!?
Yahoo! - Official partner of 2002 FIFA World Cup
http://fifaworldcup.yahoo.com

From lawrence_jesse at yahoo.ca  Wed Jul  3 08:24:55 2002
From: lawrence_jesse at yahoo.ca (Jesse Lawrence)
Date: Fri Jan  9 22:03:15 2004
Subject: [mod_python] make problems
Message-ID: <20020703122455.30604.qmail@web11303.mail.yahoo.com>

Hello everyone,

I've tried finding an answer to this in the mailing
list archive, but haven't been successful. I run the
following:

./configure --with-apxs=/usr/sbin/apxs 

and it seems to be fine, but when I run make dso or
just make, I get the following message:

[jalaw@soniceast mod_python-2.7.8]# make dso
make[1]: Entering directory
`/home/jalaw/mod_python-2.7.8/src'
gcc  -I/home/jalaw/mod_python-2.7.8/src/include
-I/usr/include/apache -I/usr/include/python2.1    -c
-o mod_python.o mod_python.c
In file included from mod_python.c:54:
/home/jalaw/mod_python-2.7.8/src/include/mod_python.h:77:20:
Python.h: No such file or directory
/home/jalaw/mod_python-2.7.8/src/include/mod_python.h:78:26:
structmember.h: No
such file or directory
make[1]: *** [mod_python.o] Error 1
make[1]: Leaving directory
`/home/jalaw/mod_python-2.7.8/src'
make: *** [do_dso] Error 2

Can anyone please tell me what is happening here?  Any
help will be greatly appreciated.

Thank you,

Jesse Lawrence

______________________________________________________________________ 
Post your ad for free now! http://personals.yahoo.ca

From fuf at mobil.cz  Wed Jul  3 14:31:23 2002
From: fuf at mobil.cz (Michal Vitecek)
Date: Fri Jan  9 22:03:15 2004
Subject: [mod_python] make problems
In-Reply-To: <20020703122455.30604.qmail@web11303.mail.yahoo.com>
References: <20020703122455.30604.qmail@web11303.mail.yahoo.com>
Message-ID: <20020703123123.GJ28418@diana.mobil.cz>

 you're missing the python header files. most probably because you are on
 some system with package system and haven't installed the appropriate
 package. for RH this could be python-devel-something.

Jesse Lawrence wrote:
>Hello everyone,
>
>I've tried finding an answer to this in the mailing
>list archive, but haven't been successful. I run the
>following:
>
>./configure --with-apxs=/usr/sbin/apxs 
>
>and it seems to be fine, but when I run make dso or
>just make, I get the following message:
>
>[jalaw@soniceast mod_python-2.7.8]# make dso
>make[1]: Entering directory
>`/home/jalaw/mod_python-2.7.8/src'
>gcc  -I/home/jalaw/mod_python-2.7.8/src/include
>-I/usr/include/apache -I/usr/include/python2.1    -c
>-o mod_python.o mod_python.c
>In file included from mod_python.c:54:
>/home/jalaw/mod_python-2.7.8/src/include/mod_python.h:77:20:
>Python.h: No such file or directory
>/home/jalaw/mod_python-2.7.8/src/include/mod_python.h:78:26:
>structmember.h: No
>such file or directory
>make[1]: *** [mod_python.o] Error 1
>make[1]: Leaving directory
>`/home/jalaw/mod_python-2.7.8/src'
>make: *** [do_dso] Error 2
>
>Can anyone please tell me what is happening here?  Any
>help will be greatly appreciated.
>
>Thank you,
>
>Jesse Lawrence
>
>______________________________________________________________________ 
>Post your ad for free now! http://personals.yahoo.ca
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://www.modpython.org/mailman/listinfo/mod_python

-- 
		fuf		(fuf@mobil.cz)

From clee at spiralis.merseine.nu  Wed Jul  3 07:52:00 2002
From: clee at spiralis.merseine.nu (clee@spiralis.merseine.nu)
Date: Fri Jan  9 22:03:15 2004
Subject: [mod_python] make problems
In-Reply-To: <20020703122455.30604.qmail@web11303.mail.yahoo.com>
References: <20020703122455.30604.qmail@web11303.mail.yahoo.com>
Message-ID: <15650.62320.759265.205900@spiralis.merseine.nu>

>>>>> "Jesse" == Jesse Lawrence <lawrence_jesse@yahoo.ca> writes:

    Jesse> Hello everyone, I've tried finding an answer to this in the
    Jesse> mailing list archive, but haven't been successful. I run
    Jesse> the following:

    Jesse> ./configure --with-apxs=/usr/sbin/apxs

On my linux system, I need to specify where the python source
distribution is.  For example:

  ./configure  --with-apxs=/usr/sbin/apxs --with-python=/usr/local/src/Python-2.1.3


From lawrence_jesse at yahoo.ca  Wed Jul  3 09:58:15 2002
From: lawrence_jesse at yahoo.ca (Jesse Lawrence)
Date: Fri Jan  9 22:03:15 2004
Subject: [mod_python] make problems
In-Reply-To: <20020703123123.GJ28418@diana.mobil.cz>
Message-ID: <20020703135815.41942.qmail@web11303.mail.yahoo.com>

Thanks a lot for the pointer.  It did the trick.  Now
I'm having problems with my apache configuration. 
I've got the AddModule and 
LoadModule ok, but I'm a little confused as to the
proper way to set up the AddHandler and PythonHandler,
the documentation seems a little hazy on this point. 
Any help will be greatly appreciated,
Thanks,
Jesse

--- Michal Vitecek <fuf@mobil.cz> wrote:
>  you're missing the python header files. most
> probably because you are on
>  some system with package system and haven't
> installed the appropriate
>  package. for RH this could be
> python-devel-something.
> 
> Jesse Lawrence wrote:
> >Hello everyone,
> >
> >I've tried finding an answer to this in the mailing
> >list archive, but haven't been successful. I run
> the
> >following:
> >
> >./configure --with-apxs=/usr/sbin/apxs 
> >
> >and it seems to be fine, but when I run make dso or
> >just make, I get the following message:
> >
> >[jalaw@soniceast mod_python-2.7.8]# make dso
> >make[1]: Entering directory
> >`/home/jalaw/mod_python-2.7.8/src'
> >gcc  -I/home/jalaw/mod_python-2.7.8/src/include
> >-I/usr/include/apache -I/usr/include/python2.1   
> -c
> >-o mod_python.o mod_python.c
> >In file included from mod_python.c:54:
>
>/home/jalaw/mod_python-2.7.8/src/include/mod_python.h:77:20:
> >Python.h: No such file or directory
>
>/home/jalaw/mod_python-2.7.8/src/include/mod_python.h:78:26:
> >structmember.h: No
> >such file or directory
> >make[1]: *** [mod_python.o] Error 1
> >make[1]: Leaving directory
> >`/home/jalaw/mod_python-2.7.8/src'
> >make: *** [do_dso] Error 2
> >
> >Can anyone please tell me what is happening here? 
> Any
> >help will be greatly appreciated.
> >
> >Thank you,
> >
> >Jesse Lawrence
> >
>
>______________________________________________________________________
> 
> >Post your ad for free now!
> http://personals.yahoo.ca
> >_______________________________________________
> >Mod_python mailing list
> >Mod_python@modpython.org
>
>http://www.modpython.org/mailman/listinfo/mod_python
> 
> -- 
> 		fuf		(fuf@mobil.cz)
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


______________________________________________________________________ 
Post your ad for free now! http://personals.yahoo.ca

From ps0 at igmp.com.ar  Wed Jul  3 11:35:08 2002
From: ps0 at igmp.com.ar (ps0@igmp.com.ar)
Date: Fri Jan  9 22:03:15 2004
Subject: [mod_python] Problems creating files from mod_python
In-Reply-To: <ch95ius9pgmdhso3cnuc6fv6m034o12p8j@4ax.com>; from lisicky@datis.cdrail.cz on Wed, Jul 03, 2002 at 09:22:38AM +0200
References: <20020702194803.A27995@igmp.com.ar> <ch95ius9pgmdhso3cnuc6fv6m034o12p8j@4ax.com>
Message-ID: <20020703113508.A11838@igmp.com.ar>

On Wed, Jul 03, 2002 at 09:22:38AM +0200, Jiri Lisicky wrote:
> On Tue, 2 Jul 2002 19:48:03 -0300, you wrote:
> 
> >Apache: 1.3.24
> >mod_python: 2.7.8
> >Python: 2.2 (w/threads) [i have to recompile it
> >without threads]
> >
> >
> >fd=open("/tmp/bleh.txt", "w")
> >fd.write("HOLA\n")
> >fd.close()
> >
> >On the fd.close() it make this error:
> >IOError: [Errno 9] Bad file Descriptor 
> >
> >The file is created but i can't write on it.
> >
> >
> >The perms are corectly applied, from a python script ( out of apache )
> >the thinks work ok.
> >
> >Sugestions apreciated.
> Exists file /tmp/bleh.txt before running script from mod_python? 
> Maybe you create this file by generic python script under your
> username. When call it under mod_python, it is under apache account =
> permission problem.
> --
>         Ji?? Lisick?                      ?D KM?P Olomouc
> e-mail: lisicky@datis.cdrail.cz           V?de?sk? 15
>  phone: +420-068-578-2272                 Olomouc, Czech Republic
>               >>> ?e?tina ISO-8859-2 Compatible <<<
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

no , the file doesn't exist before running the script in mod_python, i
aready check that.

Regards

From gerard.patel at nerim.net  Wed Jul  3 17:42:14 2002
From: gerard.patel at nerim.net (Gerard Patel)
Date: Fri Jan  9 22:03:16 2004
Subject: [mod_python] Problems creating files from mod_python
Message-ID: <1.5.4.32.20020703154214.4178bebc@pop.nerim.net>

At 11:35 AM 7/3/02 -0300, you wrote:

(...)
>> >On the fd.close() it make this error:
>> >IOError: [Errno 9] Bad file Descriptor 
>> >
>> >The file is created but i can't write on it.
>> >
>> >
>> >The perms are corectly applied, from a python script ( out of apache )
>> >the thinks work ok.
>
>
>no , the file doesn't exist before running the script in mod_python, i
>aready check that.

Maybe you could check by hand if the apache user has
the correct rights ? Here is what I would do in the same
situation - on my system Apache runs as nobody :

su
<enter root password>

su nobody

try to create a file; if it fails, the user has no rights and it's
a system configuration question.

Hope this helps

Gerard Patel



From vmilitaru at sympatico.ca  Wed Jul  3 15:32:39 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 22:03:16 2004
Subject: [mod_python] Tips and Tricks initiative
Message-ID: <20020703153239.A772@eye.neb>

Hello,
Inspired by Apache's excellent "URL Rewriting Guide" (http://httpd.apache.org/docs/misc/rewriteguide.html), I would like to suggest that the mod_python maintainers compile a similar document, focussed exclusively on short, practical tricks and tips documenting how mod_python can help to solve some typical problems. This would, to some extent, cut off on redundant posts to the list, as well as help spread knowledge from the more experienced to the more 'mod_python challenged' (like myself). There is no better selling argument for mod_python than a few well written lines of 'mod_python' code ...

An example of a possible entry to the 'mod_python Tips&Tricks' list:


Generic Redirect

Description:
  problem description blah blah ... In this example: basically simulating mod_rewrite in mod_python.

Solution:
  additional blah blah explaining how we are going to brilliantly solve that mind boggling problem in 2 lines of code ...

  def handler(REQUEST):
    # some code generating our url goes here

    url = 'http://www.yahoo.com' # an example url to test the redirect code
    REQUEST.headers_out["Location"] = url
    REQUEST.status = 302
    REQUEST.send_http_header()


For instance, I'd be very interested to read in such a tricks and tips list how to avoid the overhead of creating a database connection at each call to 'handler'. And so on.

Cheers, Vio

From vmilitaru at sympatico.ca  Wed Jul  3 16:10:32 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 22:03:16 2004
Subject: [mod_python] Tips and Tricks initiative ... some followup contribution
Message-ID: <20020703161032.A828@eye.neb>

Generic Cookies

Description:
  How do we bake cookies in mod_python?

Solution:
  def handler(REQUEST):
    header_key = 'Set-Cookie'
    # set cookie values
    for header_value in (
'MyCookie1Var=homepop-shown=1; expires=Wed, 03-Jul-2002 05:18:07 GMT; path=/; domain=zzzz;', 
'MyCookie2Var=homepop-shown=0; expires=Wed, 03-Jul-2002 05:18:07 GMT; path=/; domain=zzzz;',
'MyCookieN=homepop-shown=0; expires=Wed, 03-Jul-2002 05:18:07 GMT; path=/; domain=zzzz;'
    ):
      REQUEST.headers_out.add(header_key,header_value)

    # set additional header arguments here

    # send header to client
    REQUEST.send_http_header()
    return apache.OK

From vmilitaru at sympatico.ca  Wed Jul  3 16:37:49 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 22:03:16 2004
Subject: [mod_python] Tips and Tricks initiative ... some followup contribution /3
Message-ID: <20020703163749.A873@eye.neb>

Already reaching the bottom of my mod_python tricks basket:


REQUEST Attributes Made Easy

Description:
  How can I see all REQUEST's attributes in one swoop.

Solution:
  (one amongst many, I believe)

  def handler(REQUEST):
      # set headers
      REQUEST.content_type = "text/html"
      REQUEST.send_http_header()

      # list all REQUEST's attributes
      REQUEST.write('<HTML><BODY>\n\n')
      for item in dir(REQUEST):
              exec('x = REQUEST.' + str(item))
              REQUEST.write('REQUEST.' + str(item) + ' = ' + str(x))
              REQUEST.write('\n\n<BR>\n\n')

      REQUEST.write('\n\n</BODY></HTML>\n')
      return apache.OK

I hope some may find these little code snipplets useful. I guess other tips&tricks are similarly welcome.

Cheers, Vio

From alain at onesite.org  Wed Jul  3 22:49:47 2002
From: alain at onesite.org (Alain Tesio)
Date: Fri Jan  9 22:03:16 2004
Subject: [mod_python] Tips and Tricks initiative
In-Reply-To: <20020703153239.A772@eye.neb>
References: <20020703153239.A772@eye.neb>
Message-ID: <20020703224947.403225e9.alain@onesite.org>

On Wed, 3 Jul 2002 15:32:39 -0500
vio <vmilitaru@sympatico.ca> wrote:

Technically a wiki is nice for public contributions :
http://moin.sourceforge.net/

> For instance, I'd be very interested to read in such a tricks and tips list how to avoid the
> overhead of creating a database connection at each call to 'handler'. And so on.

Just make the connection a global variable.

Alain


From dustin at ywlcs.org  Wed Jul  3 16:01:39 2002
From: dustin at ywlcs.org (Dustin Mitchell)
Date: Fri Jan  9 22:03:16 2004
Subject: [mod_python] Tips and Tricks initiative ... some followup contribution /3
In-Reply-To: <20020703163749.A873@eye.neb>
References: <20020703163749.A873@eye.neb>
Message-ID: <20020703210138.GQ9517@eleanor.internal.ywlcs.org>

On Wed, Jul 03, 2002 at 04:37:49PM -0500, vio wrote:
> Already reaching the bottom of my mod_python tricks basket:
> 
> 
> REQUEST Attributes Made Easy
> 
> Description:
>   How can I see all REQUEST's attributes in one swoop.
> 
> Solution:
>   (one amongst many, I believe)
> 
>   def handler(REQUEST):
>       # set headers
>       REQUEST.content_type = "text/html"
>       REQUEST.send_http_header()
> 
>       # list all REQUEST's attributes
>       REQUEST.write('<HTML><BODY>\n\n')
>       for item in dir(REQUEST):
>               exec('x = REQUEST.' + str(item))
>               REQUEST.write('REQUEST.' + str(item) + ' = ' + str(x))
>               REQUEST.write('\n\n<BR>\n\n')
 let's avoid 'exec'; how about
                x = getattr(REQUEST, item)
                REQUEST.write('REQUEST.%s = %s\n\n<br>\n\n' % item, `x`)
> 
>       REQUEST.write('\n\n</BODY></HTML>\n')
>       return apache.OK

-- 

  Dustin Mitchell
  dustin@ywlcs.org
  http://people.cs.uchicago.edu/~dustin/

From vmilitaru at sympatico.ca  Wed Jul  3 17:38:49 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 22:03:16 2004
Subject: [mod_python] Tips and Tricks initiative
In-Reply-To: <20020703224947.403225e9.alain@onesite.org>; from alain@onesite.org on Wed, Jul 03, 2002 at 10:49:47PM +0200
References: <20020703153239.A772@eye.neb> <20020703224947.403225e9.alain@onesite.org>
Message-ID: <20020703173849.A937@eye.neb>

* Alain Tesio <alain@onesite.org> [020703 17:11]:

> > For instance, I'd be very interested to read in such a tricks and tips list how to avoid the
> > overhead of creating a database connection at each call to 'handler'. And so on.
> 
> Just make the connection a global variable.

I think I tried that, initialized the db connection at the module level. But somehow my cursor got corrupted, or something. I forgot oracle's error number, only that my workaround was to do something like (we're at module level here):

db = DCOracle2.connect(my_login_string)
def get_db_cursor():
    "create database connection"
    cursor = db.cursor() # Allocate a cursor
    return cursor

In fact I see that I am re-using the same connection here, so let me re-phrase my initial question: how do I re-use the same *cursor* (or it this a bad idea in the first place). I wonder what would happen in such a multi-threaded environment (well, I'm saling in Linuxland) where multiple httpd instances will hit on the db server (ora8i in my case) with the same cursor *concurrently* (never got to that point of desperation, though - but just from contemplating such possibility sounds like total anarchy). What I did try but eventually got an error on was to re-use the same cursor sequentially (in a non-threaded application).

Cheers, Vio

From alain at onesite.org  Thu Jul  4 00:06:08 2002
From: alain at onesite.org (Alain Tesio)
Date: Fri Jan  9 22:03:16 2004
Subject: [mod_python] Tips and Tricks initiative
In-Reply-To: <20020703173849.A937@eye.neb>
References: <20020703153239.A772@eye.neb>
	<20020703224947.403225e9.alain@onesite.org>
	<20020703173849.A937@eye.neb>
Message-ID: <20020704000608.5bf2dea3.alain@onesite.org>

On Wed, 3 Jul 2002 17:38:49 -0500
vio <vmilitaru@sympatico.ca> wrote:

> In fact I see that I am re-using the same connection here, so let me re-phrase my initial
> question: how do I re-use the same *cursor* (or it this a bad idea in the first place).

I think a cursor is not designed to be re-used, what I usually do with cursors is:

- open it
- execute a query
- fetch the rows
- close and remove it (manually with del)

Maybe I'm wrong and a closed cursor can be reopened, I have no idea what
ressources it takes just to create it.

If this works and you want to do it, it can't be shared by two users, you can
use a pool of reusable cursors in a global variable, with a correct lock handling
to make sure you don't get the same cursor from the pool for two users.

Alain

From barr at cs.cornell.edu  Sun Jul  7 19:32:18 2002
From: barr at cs.cornell.edu (Rimon Barr)
Date: Fri Jan  9 22:03:16 2004
Subject: [mod_python] spyce v1.1.22
Message-ID: <Pine.LNX.4.44.0207071930240.8857-100000@pompom.u.cs.cornell.edu>

Most important changes since last posting (v1.1.18)
 - easier install; .rpm should work on more systems
 - does not rely on mod_python by default... too hard to get right
   automatically, and users don't get to play with Spyce
 - downgraded some code to run on Python v2.1.1 and up.
   (requires nested scoping, so can't go further than that)
 - removed use of Python threads
 - new filter module
 - improved installation documentation, and explained how modules work
... and lots more.

Spyce still works under mod_python. To get it to work, you'll need a
properly running mod_python, and then just to comment and uncomment a few
lines in your httpd.conf. See:
  http://spyce.sourceforge.net/download.html#modpython

----------
SPYCE - Server Python Pages

SPYCE is a webserver plugin that supports simple and efficient
Python-based dynamic HTML scripting. Those who like Python and are
familiar with JSP, or PHP, or ASP, should have a look at this engine. It
allows one to generate dynamic HTML content just as easily, using Python
for the dynamic parts. Its modular design makes it very flexible and
extensible. It supports FastCGI, CGI and mod_python to plugin into Apache
and most other webservers. It can also be used as a command-line utility
for HTML pre-processing.

v1.1.22 released on 7 July 2002.

Get it at:
  http://spyce.sourceforge.net

----------
Partial change log:

v1.1.22
  fixed Python v2.1.1-related bugs.
  improved installation process and documentation
  rpm more likely to succeed - uses fcgi or drops back to cgi
  no longer mod_python based by default

v1.1.21 (faulty release)
  stochastic session clean up; no more threading dependency
  documentation: better installation notes
  peep-hole optimizer

v1.1.20 (faulty release)
  created explicit (swappable) cache infrastructure
  BUG ** Spyce also works on Python v2.1
  request - request.post(),post1() works in includes
  documentation: cheetah install, ...

v1.1.19
  filter module

v1.1.18
  fcgi support added
  X-Spyce header added
  documentation: how to write new modules

v1.1.17
  feature request - compaction algorithm improved
...

Enjoy,
Rimon.
-- 
 * Rimon Barr       Ph.D. candidate, Computer Science, Cornell University
 | barr@cs.cornell.edu - http://www.cs.cornell.edu/barr - Y!IM: batripler
 |
 | Understanding is a kind of ecstasy.
 +----                                   -- Carl Sagan



From johannes at erdfelt.com  Wed Jul  3 18:34:27 2002
From: johannes at erdfelt.com (Johannes Erdfelt)
Date: Fri Jan  9 22:03:16 2004
Subject: [mod_python] Tips and Tricks initiative
In-Reply-To: <20020703153239.A772@eye.neb>; from vmilitaru@sympatico.ca on Wed, Jul 03, 2002 at 03:32:39PM -0500
References: <20020703153239.A772@eye.neb>
Message-ID: <20020703183427.M2452@sventech.com>

On Wed, Jul 03, 2002, vio <vmilitaru@sympatico.ca> wrote:
> Hello,
> Inspired by Apache's excellent "URL Rewriting Guide" (http://httpd.apache.org/docs/misc/rewriteguide.html), I would like to suggest that the mod_python maintainers compile a similar document, focussed exclusively on short, practical tricks and tips documenting how mod_python can help to solve some typical problems. This would, to some extent, cut off on redundant posts to the list, as well as help spread knowledge from the more experienced to the more 'mod_python challenged' (like myself). There is no better selling argument for mod_python than a few well written lines of 'mod_python' code ...

While not the most appropriate name, why doesn't the FAQ work for you?

http://www.modpython.org/FAQ/faqw.py

> For instance, I'd be very interested to read in such a tricks and tips list how to avoid the overhead of creating a database connection at each call to 'handler'. And so on.

http://www.modpython.org/FAQ/faqw.py?req=all#3.3

JE


From bob at redivi.com  Wed Jul  3 18:36:04 2002
From: bob at redivi.com (Bob Ippolito)
Date: Fri Jan  9 22:03:16 2004
Subject: [mod_python] Tips and Tricks initiative
In-Reply-To: <20020703173849.A937@eye.neb>
Message-ID: <4207FDD5-8ED5-11D6-9214-0003938210D6@redivi.com>

It depends on the particular db module, some modules have threadsafe 
database instances, some don't.  Some have threadsafe database cursors, 
and some don't.  Read the docs.  If it's DBAPI compliant, check its 
thread safe level.  I have never used anything that's thread safe level 
3, most are level 2 or 1 in my experience.

from http://www.python.org/topics/database/DatabaseAPI-2.0.html
threadsafety
Integer constant stating the level of thread safety the interface 
supports. Possible values are:
0	= Threads may not share the module.
1	= Threads may share the module, but not connections.
2	= Threads may share the module and connections.
3	= Threads may share the module, connections and cursors.

Sharing in the above context means that two threads may use a resource 
without wrapping it using a mutex semaphore to implement resource 
locking. Note that you cannot always make external resources thread safe 
bymanaging access using a mutex: the resource may rely on global 
variables or other external sources that are beyond your control.

-bob

On Wednesday, July 3, 2002, at 06:38 PM, vio wrote:

> * Alain Tesio <alain@onesite.org> [020703 17:11]:
>
>>> For instance, I'd be very interested to read in such a tricks and 
>>> tips list how to avoid the
>>> overhead of creating a database connection at each call to 'handler'. 
>>> And so on.
>>
>> Just make the connection a global variable.
>
> I think I tried that, initialized the db connection at the module 
> level. But somehow my cursor got corrupted, or something. I forgot 
> oracle's error number, only that my workaround was to do something like 
> (we're at module level here):
>
> db = DCOracle2.connect(my_login_string)
> def get_db_cursor():
>     "create database connection"
>     cursor = db.cursor() # Allocate a cursor
>     return cursor
>
> In fact I see that I am re-using the same connection here, so let me 
> re-phrase my initial question: how do I re-use the same *cursor* (or it 
> this a bad idea in the first place). I wonder what would happen in such 
> a multi-threaded environment (well, I'm saling in Linuxland) where 
> multiple httpd instances will hit on the db server (ora8i in my case) 
> with the same cursor *concurrently* (never got to that point of 
> desperation, though - but just from contemplating such possibility 
> sounds like total anarchy). What I did try but eventually got an error 
> on was to re-use the same cursor sequentially (in a non-threaded 
> application).
>
> Cheers, Vio
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From pk1u at yahoo.com  Mon Jul  8 17:10:12 2002
From: pk1u at yahoo.com (Praveen Kumar)
Date: Fri Jan  9 22:03:16 2004
Subject: [mod_python] DCOracle2 w/ apache + mod_python under rh7.2 ?
Message-ID: <20020709001012.18211.qmail@web10403.mail.yahoo.com>

Same problem I posted last week; I've tried a few more
things ( described below ). Is anyone running this
config ?

Any suggestions on how I can go about debugging this
would be appreciated.

> Has anyone successfully used DCOracle2 w/ apache +
> mod_python under rh7.2 ?
> 
> My system consists of rh7.2, apache1.3.26,
> mod_python-2.7.8, python2.1.3, Oracle9i .
> 
> I see the following when my program accesses the
> DCOracle2 module:
> 
>   File
>
"/usr/lib/python2.1/site-packages/DCOracle2/__init__.py",
> line 37, in ?
>     from DCOracle2 import   *
> 
>   File
>
"/usr/lib/python2.1/site-packages/DCOracle2/DCOracle2.py",
> line 104, in ?
>     import dco2
> 
> ImportError: libclntsh.so.9.0: cannot open shared
> object file: No such file or directory
> 
> 
> 
> I've tried the following:
> 
> -----
> 
> Setting LD_LIBRARY_PATH from the same shell where I
> start apache:
> 
> export LD_LIBRARY_PATH=/home/pk/OraHome1/lib
> 
> -----
> 
> Setting LD_LIBRARY_PATH to /home/pk/OraHome1/lib via
> Apache's PassEnv and SetEnv directives.
> 
> -----
> 
> Placed libclntsh.so.9.0 in
> /usr/lib/python2.1/site-packages/DCOracle2 ( same
> path
> as dco2.so ).
> 
> -----
> 
> Added /home/pk/OraHome1/lib to /etc/ld.so.conf , and
> executed /sbin/ldconfig as root.
> 
> -----
> 
> Tried adding each of:
> 
> os.putenv( 'LD_LIBRARY_PATH',
> '/home/pk/OraHome1/lib'
> )
> 
> os.environ[ 'LD_LIBRARY_PATH' ] =
> '/home/pk/OraHome1/lib'
> 
> in DCOracle2/DCOracle2.py before the "import dco2"
> statement
> 
> -----
> 
> /home/pk/OraHome1/lib is readable by all ; but tried
> the following anyway, to eliminate a
> permissions-issue
> as the cause:
> 
> As root, copied /home/pk/OraHome1/lib to /oralib ;
> tried all of the above, using /oralib
> 
> -----
> 
> "/home/pk/OraHome1/lib/libclntsh.so.9.0" exists, yet
> none of these work. The DCOracle2 module works fine
> when I use it from a standalone program. It would be
> helpful to know if anyone has gotten this config to
> work; also, any suggestions would be appreciated.
> 
> pk
> 
> 
> __________________________________________________
> Do You Yahoo!?
> Sign up for SBC Yahoo! Dial - First Month Free
> http://sbc.yahoo.com
> 
> 
> _______________________________________________
> DB-SIG maillist  -  DB-SIG@python.org
> http://mail.python.org/mailman/listinfo/db-sig


__________________________________________________
Do You Yahoo!?
Sign up for SBC Yahoo! Dial - First Month Free
http://sbc.yahoo.com

From marklists at mceahern.com  Tue Jul  9 12:41:27 2002
From: marklists at mceahern.com (Mark McEahern)
Date: Fri Jan  9 22:03:16 2004
Subject: [mod_python] configuration error
Message-ID: <JHEOKEOOLIGLDHCMAHMOMEJPDAAA.marklists@mceahern.com>

Hi, I'm trying to configure mod_python with Apache.  When I run the test, I
get Internal Server Error.  Here's what I see in Apache's error_log:

[Tue Jul  9 12:10:18 2002] [notice] Apache/1.3.26 (Unix) mod_python/2.7.8
Python/2.2.1 configured -- resuming normal operations
[Tue Jul  9 12:10:18 2002] [notice] Accept mutex: sysvsem (Default: sysvsem)
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
[Tue Jul  9 12:10:46 2002] [error] [client 192.168.0.1] python_handler:
make_obcallback returned no obCallBack!

Here's how I compiled mod_python and installed it:

  ./configure --with-apxs=/usr/local/apache/bin/apxs
  ./make
  sudo make install

I then edited httpd.conf, adding:

LoadModule python_module /usr/local/apache/libexec/mod_python.so

and

<Directory /home/.../pytest/>
  AddHandler python-program .py
  PythonHandler mptest
  PythonDebug On
</Directory>

This is mptest.py:

from mod_python import apache

def handler(req):
    req.send_http_header()
    req.write("Hello World!")
    return apache.OK

I'm running Apache 1.3.26 on Red Hat Linux 7.3.  I'm using Python 2.2.1.
mod_python installed into:

	/usr/local/lib/python2.2/site-packages/mod_python/

which is world readable.  All the files in mod_python are world readable.
Interestingly, the .py files are world executable, but the .pyc files are
NOT world executable--I don't think that makes a difference?

Is there something obvious I'm doing wrong in configuring Apache?

I found this thread and the threads it points to:

  http://www.modpython.org/pipermail/mod_python/2000-September/000881.html

The problem he encountered was that mod_python was installed as
mod_python$version, which he solved by using a symbolic link.  I don't think
that's the problem I'm having.

Interestingly, if I start Apache with httpd -X, Hello World works just fine.
However, when I start Apache normally, it doesn't work, but the above dump
from error log is all I have to go on.

Any ideas?

Thanks,

// mark

-


From marklists at mceahern.com  Tue Jul  9 13:30:20 2002
From: marklists at mceahern.com (Mark McEahern)
Date: Fri Jan  9 22:03:16 2004
Subject: [mod_python] configuration error
In-Reply-To: <JHEOKEOOLIGLDHCMAHMOMEJPDAAA.marklists@mceahern.com>
Message-ID: <JHEOKEOOLIGLDHCMAHMOGEKEDAAA.marklists@mceahern.com>

I was able to fix this by recompiling Python like so:

  ./configure --without-threads

What I wonder is how come mod_python's configure didn't warn me about this
as implied here:


http://www.modpython.org/live/mod_python-2.7.8/doc-html/inst-configure.html

Cheers,

// mark

> -----Original Message-----
> From: mod_python-admin@modpython.org
> [mailto:mod_python-admin@modpython.org]On Behalf Of Mark McEahern
> Sent: Tuesday, July 09, 2002 12:41 PM
> To: mod_python@modpython.org
> Subject: [mod_python] configuration error
>
>
> Hi, I'm trying to configure mod_python with Apache.  When I run
> the test, I
> get Internal Server Error.  Here's what I see in Apache's error_log:
>
> [Tue Jul  9 12:10:18 2002] [notice] Apache/1.3.26 (Unix) mod_python/2.7.8
> Python/2.2.1 configured -- resuming normal operations
> [Tue Jul  9 12:10:18 2002] [notice] Accept mutex: sysvsem
> (Default: sysvsem)
> make_obcallback(): could not import mod_python.apache.
> make_obcallback(): could not call init.
> [Tue Jul  9 12:10:46 2002] [error] [client 192.168.0.1] python_handler:
> make_obcallback returned no obCallBack!
>
> Here's how I compiled mod_python and installed it:
>
>   ./configure --with-apxs=/usr/local/apache/bin/apxs
>   ./make
>   sudo make install
>
> I then edited httpd.conf, adding:
>
> LoadModule python_module /usr/local/apache/libexec/mod_python.so
>
> and
>
> <Directory /home/.../pytest/>
>   AddHandler python-program .py
>   PythonHandler mptest
>   PythonDebug On
> </Directory>
>
> This is mptest.py:
>
> from mod_python import apache
>
> def handler(req):
>     req.send_http_header()
>     req.write("Hello World!")
>     return apache.OK
>
> I'm running Apache 1.3.26 on Red Hat Linux 7.3.  I'm using Python 2.2.1.
> mod_python installed into:
>
> 	/usr/local/lib/python2.2/site-packages/mod_python/
>
> which is world readable.  All the files in mod_python are world readable.
> Interestingly, the .py files are world executable, but the .pyc files are
> NOT world executable--I don't think that makes a difference?
>
> Is there something obvious I'm doing wrong in configuring Apache?
>
> I found this thread and the threads it points to:
>
>   http://www.modpython.org/pipermail/mod_python/2000-September/000881.html
>
> The problem he encountered was that mod_python was installed as
> mod_python$version, which he solved by using a symbolic link.  I
> don't think
> that's the problem I'm having.
>
> Interestingly, if I start Apache with httpd -X, Hello World works
> just fine.
> However, when I start Apache normally, it doesn't work, but the above dump
> from error log is all I have to go on.
>
> Any ideas?
>
> Thanks,
>
> // mark
>
> -
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> -
>
>

-


From vmilitaru at sympatico.ca  Tue Jul  9 15:09:59 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 22:03:16 2004
Subject: [mod_python] Tips and Tricks initiative
In-Reply-To: <4207FDD5-8ED5-11D6-9214-0003938210D6@redivi.com>; from bob@redivi.com on Wed, Jul 03, 2002 at 06:36:04PM -0400
References: <20020703173849.A937@eye.neb> <4207FDD5-8ED5-11D6-9214-0003938210D6@redivi.com>
Message-ID: <20020709150959.A461@eye.neb>

Admittedly, the intent of re-using a cursor can only be summed up as pure
greed, or the art of sucking up the last atom of speed from a given system.
In dark moonless nights, I almost pitty myself.

Thanks for the intro on threadsafety. Most interesting.

* Bob Ippolito <bob@redivi.com> [020708 22:35]:
> It depends on the particular db module, some modules have threadsafe 
> database instances, some don't.  Some have threadsafe database cursors, 
> and some don't.  Read the docs.  If it's DBAPI compliant, check its 
> thread safe level.  I have never used anything that's thread safe level 
> 3, most are level 2 or 1 in my experience.
> 
> from http://www.python.org/topics/database/DatabaseAPI-2.0.html
> threadsafety
> Integer constant stating the level of thread safety the interface 
> supports. Possible values are:
> 0	= Threads may not share the module.
> 1	= Threads may share the module, but not connections.
> 2	= Threads may share the module and connections.
> 3	= Threads may share the module, connections and cursors.
> 
> Sharing in the above context means that two threads may use a resource 
> without wrapping it using a mutex semaphore to implement resource 
> locking. Note that you cannot always make external resources thread safe 
> bymanaging access using a mutex: the resource may rely on global 
> variables or other external sources that are beyond your control.
> 
> -bob
> 
> On Wednesday, July 3, 2002, at 06:38 PM, vio wrote:
> 
> > * Alain Tesio <alain@onesite.org> [020703 17:11]:
> >
> >>> For instance, I'd be very interested to read in such a tricks and 
> >>> tips list how to avoid the
> >>> overhead of creating a database connection at each call to 'handler'. 
> >>> And so on.
> >>
> >> Just make the connection a global variable.
> >
> > I think I tried that, initialized the db connection at the module 
> > level. But somehow my cursor got corrupted, or something. I forgot 
> > oracle's error number, only that my workaround was to do something like 
> > (we're at module level here):
> >
> > db = DCOracle2.connect(my_login_string)
> > def get_db_cursor():
> >     "create database connection"
> >     cursor = db.cursor() # Allocate a cursor
> >     return cursor
> >
> > In fact I see that I am re-using the same connection here, so let me 
> > re-phrase my initial question: how do I re-use the same *cursor* (or it 
> > this a bad idea in the first place). I wonder what would happen in such 
> > a multi-threaded environment (well, I'm saling in Linuxland) where 
> > multiple httpd instances will hit on the db server (ora8i in my case) 
> > with the same cursor *concurrently* (never got to that point of 
> > desperation, though - but just from contemplating such possibility 
> > sounds like total anarchy). What I did try but eventually got an error 
> > on was to re-use the same cursor sequentially (in a non-threaded 
> > application).
> >
> > Cheers, Vio
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://www.modpython.org/mailman/listinfo/mod_python
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

From vmilitaru at sympatico.ca  Tue Jul  9 15:18:48 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 22:03:16 2004
Subject: [mod_python] configuration error
In-Reply-To: <JHEOKEOOLIGLDHCMAHMOMEJPDAAA.marklists@mceahern.com>; from marklists@mceahern.com on Tue, Jul 09, 2002 at 12:41:27PM -0500
References: <JHEOKEOOLIGLDHCMAHMOMEJPDAAA.marklists@mceahern.com>
Message-ID: <20020709151848.B461@eye.neb>

> ...
> I then edited httpd.conf, adding:
> 
> LoadModule python_module /usr/local/apache/libexec/mod_python.so
> 

I believe just here should be something like:

	AddModule mod_python.c

> and
> 
> <Directory /home/.../pytest/>
>   AddHandler python-program .py
>   PythonHandler mptest
>   PythonDebug On
> </Directory>
> 

Hope this solves your bobo,
Vio

From marklists at mceahern.com  Tue Jul  9 14:35:13 2002
From: marklists at mceahern.com (Mark McEahern)
Date: Fri Jan  9 22:03:16 2004
Subject: [mod_python] configuration error
In-Reply-To: <20020709151848.B461@eye.neb>
Message-ID: <JHEOKEOOLIGLDHCMAHMOAEKKDAAA.marklists@mceahern.com>

> I believe just here should be something like:
>
> 	AddModule mod_python.c

That's only required if you have ClearModuleList, which I don't.

As I noted in a follow up, I solved the problem by recompiling Python
without thread support.

Cheers,

// mark

-


From gbenson at redhat.com  Sat Jul 13 12:51:32 2002
From: gbenson at redhat.com (Gary Benson)
Date: Fri Jan  9 22:03:16 2004
Subject: [mod_python] Ping?
Message-ID: <Pine.LNX.4.44.0207131250410.31967-100000@slippy.wire.rat>

It seems that I am getting messages from this list with a four day lag. 
Is anyone else experiencing this?

Cheers,
Gary

[ gbenson@redhat.com ][ GnuPG 85A8F78B ][ http://inauspicious.org/ ]


From fabbe at paniq.net  Sun Jul 14 11:33:07 2002
From: fabbe at paniq.net (Fabian Fagerholm)
Date: Fri Jan  9 22:03:16 2004
Subject: [mod_python] Understanding mod_python
Message-ID: <1026635587.26526.30.camel@kernel>

Hello, World!

I've just begun to get to know Python and mod_python. So far, I like
what I see, but there are a few things that are a bit confusing. I
suspect it's just a matter of differing conventions - my previous
experience programming web applications is with Perl (cgi), PHP and Java
(Servlets).

Since I like to know exactly what I'm doing, I've read through all the
docs I could find, and browsed through the mailing list archives. I now
have two issues that I would like to bring up.


First, I would like to convince myself that I have understood the
Handler concept and the Publisher Handler. Therefore, I've made two
drawings based on the mod_python docs. The first drawing is
    http://www.paniq.net/fabbe/mod_python/Handler_order.ps
and it tries to show what happens when a request is made to Apache. In
particular, I'm trying to understand in which *order* the Handlers are
called and what each Handler is for.
The second drawing is
    http://www.paniq.net/fabbe/mod_python/Publisher_handler.ps
and it tries to show how the Publisher Handler handles a request. It
also shows the different parts of an URI from the Publisher's point of
view.

        * Are these drawings correct or have I misunderstood anything?
        * I would like to combine the drawings into one. Where would I
          attach the second drawing to the first?
        * I didn't quite understand how the __auth__, __access__ and
          __auth_realm__ stuff in Publisher works. I'm confused by the
          phrase "at each traversal step, the Publisher checks for...".
          I understand one object might refer to or contain another, but
          the benefits and practical use of this is is not clear to me
          and would need further explanation.
        * Could these drawings be beneficial to someone else? If so, I'd
          be happy to modify them for some particular purpose.


Second, while reading the mailing list archives, I found that many of
the posts were about how to build a web application with a sensible
structure (separating content from presentation), authorization, session
management etc. with mod_python. A very valid question IMO, because the
tutorial in the docs is quite sparse and shows an example that is mostly
achievable by using traditional CGI.
Using Python's OO features, it should be possible to create quite
complex web applications. As far as I can see, mod_python is able to
replace a Java Servlet-based solution with little effort. In fact, this
is my exact reason for looking at mod_python. :)

There were also some posts about a mod_python "cookbook", and another
poster suggested the on-line FAQ would be a good place for the
"recipes". I totally agree - well-written example code is the best way
to learn.
I'd like to suggest that a new category be created in the FAQ for these
snippets of example code.


Cheers,
Fabian Fagerholm

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 240 bytes
Desc: This is a digitally signed message part
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20020714/e9156aa3/attachment-0003.bin
From pk1u at yahoo.com  Sun Jul 14 16:58:17 2002
From: pk1u at yahoo.com (Praveen Kumar)
Date: Fri Jan  9 22:03:16 2004
Subject: [mod_python] Re: DCOracle2 w/ apache + mod_python under rh7.2 ?
In-Reply-To: <20020709073832.GV14854@glas.net>
Message-ID: <20020714235817.90778.qmail@web10411.mail.yahoo.com>

> 1) make sure you have set ORACLE_HOME env var.
> 2) make sure you have set LD_LIBRARY_PATH (to
> $ORACLE_HOME/lib) env var.
> 3) make sure that both of them are set _before_ the
> ecript execution.

Didn't work. I got around it by using mod_python as a
DSO, and using apache's LoadFile directive; in
httpd.conf:

LoadFile /home/pk/OraHome1/lib/libclntsh.so.9.0 

Not ideal, but it works.

pk

--- "Eugene V. Dvurechenski" <jno@glasnet.ru> wrote:
> On Mon, Jul 08, 2002 at 04:55:05PM -0700, Praveen
> Kumar wrote:
> >     import dco2
> > 
> > ImportError: libclntsh.so.9.0: cannot open shared
> > object file: No such file or directory
> 
> 1) make sure you have set ORACLE_HOME env var.
> 2) make sure you have set LD_LIBRARY_PATH (to
> $ORACLE_HOME/lib) env var.
> 3) make sure that both of them are set _before_ the
> ecript execution.
> 
> the last point is essential - os.environ doesn't
> help much.

Orig msg:

> Has anyone successfully used DCOracle2 w/ apache +
> mod_python under rh7.2 ?
> 
> My system consists of rh7.2, apache1.3.26,
> mod_python-2.7.8, python2.1.3, Oracle9i .
> 
> I see the following when my program accesses the
> DCOracle2 module:
> 
>   File
>
"/usr/lib/python2.1/site-packages/DCOracle2/__init__.py",
> line 37, in ?
>     from DCOracle2 import   *
> 
>   File
>
"/usr/lib/python2.1/site-packages/DCOracle2/DCOracle2.py",
> line 104, in ?
>     import dco2
> 
> ImportError: libclntsh.so.9.0: cannot open shared
> object file: No such file or directory
> 
> 
> 
> I've tried the following:
> 
> -----
> 
> Setting LD_LIBRARY_PATH from the same shell where I
> start apache:
> 
> export LD_LIBRARY_PATH=/home/pk/OraHome1/lib
> 
> -----
> 
> Setting LD_LIBRARY_PATH to /home/pk/OraHome1/lib via
> Apache's PassEnv and SetEnv directives.
> 
> -----
> 
> Placed libclntsh.so.9.0 in
> /usr/lib/python2.1/site-packages/DCOracle2 ( same
> path
> as dco2.so ).
> 
> -----
> 
> Added /home/pk/OraHome1/lib to /etc/ld.so.conf , and
> executed /sbin/ldconfig as root.
> 
> -----
> 
> Tried adding each of:
> 
> os.putenv( 'LD_LIBRARY_PATH',
> '/home/pk/OraHome1/lib'
> )
> 
> os.environ[ 'LD_LIBRARY_PATH' ] =
> '/home/pk/OraHome1/lib'
> 
> in DCOracle2/DCOracle2.py before the "import dco2"
> statement
> 
> -----
> 
> /home/pk/OraHome1/lib is readable by all ; but tried
> the following anyway, to eliminate a
> permissions-issue
> as the cause:
> 
> As root, copied /home/pk/OraHome1/lib to /oralib ;
> tried all of the above, using /oralib
> 
> -----
> 
> "/home/pk/OraHome1/lib/libclntsh.so.9.0" exists, yet
> none of these work. The DCOracle2 module works fine
> when I use it from a standalone program. It would be
> helpful to know if anyone has gotten this config to
> work; also, any suggestions would be appreciated.
> 
> pk
> 


__________________________________________________
Do You Yahoo!?
Yahoo! Autos - Get free new car price quotes
http://autos.yahoo.com

From jdaily at kc.rr.com  Sun Jul 14 20:01:21 2002
From: jdaily at kc.rr.com (james daily)
Date: Fri Jan  9 22:03:16 2004
Subject: [mod_python] please, old fool needs help with getting apache mod_python on windows 98 to run
Message-ID: <NDBBIADKLJIPFGPECIJPOELOCMAA.jdaily@kc.rr.com>

the mod_python online manual at:
    http://www.modpython.org/live/mod_python-2.7.8/doc-html/app-wininst.html

says:
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
A. Windows Installation

Notes originally created by Enrique Vaamonde evaamo@loquesea.com

Your mileage may vary with these instructions

You need to have the following packages properly installed and configured in
your system:


Python 1.5.2 or 2.0
Apache 1.3
Winzip 6.x or later.

You need to download both the mod_python.dll and the mod_python-x.tgz (where
x is the version number) files from the main page. Once you have all the
things above mentioned we're good to go.


Installing mod_python libraries

Use Winzip to extract the distribution file (mod_python-x.tgz) into a
temporary folder (i.e C:\temp):

NOTE: If Winzip shows this warning "Archive contains one file, should Winzip
decompress it to a temporary folder?" just click on Yes, the content of the
file should appear in Winzip right after.

Select all the files in Winzip and click on the Extract button, then type-in
the path or just browse your way to the temporary folder and click extract.

Open your Windows Explorer and locate the temporary folder where you
extracted the distribution file, you should have a new folder in your
temporary folder
(C:\temp\mod_python-x).

Move (or just drag & drop) the mod_python-x folder into the Python lib
folder
(i.e C:\Program Files\Python\lib).

Move the files in the folder lib inside the mod_python folder
(C:\Program Files\Python\lib\mod_python-x\lib\mod_python) to the
C:\Program Files\Python\lib\mod_python folder.
It's safe to delete these folders we just emptied.

xxxxxxxxxxx
also put the files from
    "mod_python-2.7.8\src\include\"
into
    "D:\Program Files\python211\Python21\include"
which allowed apache to start.
xxxxxxxxxxx

Integrating it with Apache
Once the distribution file is correctly extracted and later moved into the
Python directory, it's time to modify your Apache configuration (httpd.conf)
and integrate the server with mod_python. These are a few steps we must do
first:


Locate the file mod_python.dll that you downloaded before and move it to
Apache's modules folder (i.e C:\Program Files\Apache Group\Apache\modules).

Go to the Apache configuration folder (i.e C:\Program Files\Apache
Group\Apache\conf\) and edit the httpd.conf file.
Add the following line in the section "Dynamic Shared Object (DSO) Support"
of the httpd.conf file:


LoadModule python_module modules/mod_python.dll


Add the following lines in the section ScriptAlias and CGI of the
httpd.conf:


<Directory "<Your Document Root>/python">
   AddHandler python-program .py
   PythonHandler mptest
   PythonDebug on
</Directory>

NOTE: Replace the <Your Document Root> above with the Document Root you
specified on the DocumentRoot directive in the Apache's httpd.conf file.


Last, create a folder under your Document Root called python.


Testing

Create a text file in the folder we created above and call it mptest.py (you
can use Notepad for this).

Insert the following lines and save the file (Make sure it gets saved with
the .py extension):


from mod_python import apache

def handler(req):
   req.content_type = "text/plain"
   req.send_http_header()
   req.write("Hello World!")
   return apache.OK


Make sure Apache is running (or launch it!) and then point your browser to
the URL referring to the mptest.py, you should see "Hello World!".

That's it, you're ready to roll!! If you don't see the "Hello World!"
message, the next section is for you.
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

Apache/1.3.14 (Win32) running...
Python 2.1.1

all i get in the browser is the text of mptest.py

any suggestions?

if someone has it actually running on their windows 98 system,
could you please send me the ***relevant*** portions from your
apache httpd.conf file?

i have tried numerous different approaches to no avail.

alas, i am a programmer but not (yet) an apache guru.

any help would be greatly appreciated.


---------------------------------------------
James Daily
Phone : 816 943 9891
Email : wndrer@earthling.net (or hit reply button)
Web   : http://tellmama.com/
Philosophy:
                            4     2                              1000
( cos(? - r) - sin ? ) * ( r  - 2r  cos(2? + 2.4) + 0.9) + 0.62r)     < 0

Education is a progressive discovery of our own ignorance.
                                               Will Durant


From bill at immosys.com  Mon Jul 15 16:46:21 2002
From: bill at immosys.com (Bill Anderson)
Date: Fri Jan  9 22:03:16 2004
Subject: [mod_python] new to mod_python, with a question.
Message-ID: <1026773181.12028.7.camel@locutus>

OK, so here is what I am doing. I am using PageTemplates (from zope) and
mod_python. or at least, I am trying to. :)


if I do _NOT_ use the request object (i.e. I return a fully formed html
string/document), it works fine. but of course, that means no use of
mod-python's request objects functions such as cookie/header
construction, usage, etc.

To wit:
def sayit(req,x=12):
	if not x:
		return "I need x"
	if not master:
		return "I need a master object"
	pt=PageTemplate()
	filestring =
"".join(open("/home/ucntcme/public_html/pythonapps/test.pt").readlines())
	pt.write(filestring)
	myx=int(x)
        req.content_type="text/html"
        req.send_http_headers()
	req.write( pt(x=myx,master=master) )
	return apache.OK

returns my rendered template, but at the bottom has:

HTTP/1.1 200 OK Date: Mon, 15 Jul 2002 22:44:27 GMT Server:
Apache/1.3.22 (Unix) (Red-Hat/Linux) mod_python/2.7.8 Python/2.2.1
mod_ssl/2.8.5 OpenSSL/0.9.6b DAV/1.0.2 PHP/4.0.6 mod_perl/1.26
Connection: close Transfer-Encoding: chunked Content-Type: text/html;
charset=iso-8859-1
OK
The server encountered an internal error or misconfiguration and was
unable to complete your request.



Debug is on, and there are no mesages in the error_log.

Now, if I just return the content using return (content), it works fine.

Why is this/what am I doing wrong here?

Cheers, Bill







From gbenson at redhat.com  Tue Jul 16 10:15:59 2002
From: gbenson at redhat.com (Gary Benson)
Date: Fri Jan  9 22:03:16 2004
Subject: [mod_python] [PATCH] last httpd-2.0.36
Message-ID: <Pine.LNX.4.44.0207161015330.16859-200000@slippy.wire.rat>


Hi,

The attached patch brings the input filtering API in mod_python into line 
with that in httpd-2.0.36.  This is the last thing that I know of that 
needed fixing to work with 2.0.36, although I beleive some more fixes will 
be in order to build against 2.0.39 or whatever it is now :)

Cheers,
Gary

[ gbenson@redhat.com ][ GnuPG 85A8F78B ][ http://inauspicious.org/ ]
-------------- next part --------------
Bring input filter API in line with 2.0.36

Index: src/filterobject.c
===================================================================
RCS file: /cvsroot/modpython/mod_python/src/filterobject.c,v
retrieving revision 1.5
diff -u -r1.5 filterobject.c
--- src/filterobject.c	3 Jun 2002 14:31:15 -0000	1.5
+++ src/filterobject.c	9 Jul 2002 16:21:27 -0000
@@ -61,7 +61,7 @@
  */
 
 PyObject *MpFilter_FromFilter(ap_filter_t *f, apr_bucket_brigade *bb, int is_input,
-			      ap_input_mode_t mode, apr_size_t *readbytes,
+			      ap_input_mode_t mode, apr_size_t readbytes,
 			      char * handler, char *dir)
 {
     filterobject *result;
@@ -86,7 +86,7 @@
 	result->bb_in = bb;
 	result->bb_out = NULL;
 	result->mode = 0;
-	result->readbytes = NULL;
+	result->readbytes = 0;
     }
 
     result->closed = 0;
@@ -142,7 +142,7 @@
 
 	Py_BEGIN_ALLOW_THREADS;
 	self->rc = ap_get_brigade(self->f->next, self->bb_in, self->mode, 
-				  APR_BLOCK_READ, *self->readbytes);
+				  APR_BLOCK_READ, self->readbytes);
 	Py_END_ALLOW_THREADS;
 
 	if (! APR_STATUS_IS_SUCCESS(self->rc)) {
@@ -239,7 +239,7 @@
 
 		Py_BEGIN_ALLOW_THREADS;
 		self->rc = ap_get_brigade(self->f->next, self->bb_in, self->mode, 
-					  APR_BLOCK_READ, *self->readbytes);
+					  APR_BLOCK_READ, self->readbytes);
 		Py_END_ALLOW_THREADS;
 
 		if (! APR_STATUS_IS_SUCCESS(self->rc)) {
Index: src/mod_python.c
===================================================================
RCS file: /cvsroot/modpython/mod_python/src/mod_python.c,v
retrieving revision 1.60
diff -u -r1.60 mod_python.c
--- src/mod_python.c	3 Jun 2002 14:31:15 -0000	1.60
+++ src/mod_python.c	9 Jul 2002 16:21:35 -0000
@@ -1023,7 +1023,8 @@
 static apr_status_t python_filter(int is_input, ap_filter_t *f, 
 				  apr_bucket_brigade *bb,
 				  ap_input_mode_t mode,
-				  apr_size_t *readbytes) {
+				  apr_read_type_e block,
+				  apr_size_t readbytes) {
 
     PyObject *resultobject = NULL;
     interpreterdata *idata;
@@ -1052,8 +1053,7 @@
        so a fitler can spit out an error without causing infinite loop */
     if (ctx->transparent) {
 	if (is_input) 
-	    return ap_get_brigade(f->next, bb, mode, APR_BLOCK_READ, 
-				  *readbytes);
+	    return ap_get_brigade(f->next, bb, mode, block, readbytes);
 	else
 	    return ap_pass_brigade(f->next, bb);
     }
@@ -1201,9 +1201,10 @@
 static apr_status_t python_input_filter(ap_filter_t *f, 
 					apr_bucket_brigade *bb,
 					ap_input_mode_t mode,
-					apr_size_t *readbytes) 
+					apr_read_type_e block,
+					apr_off_t readbytes)
 {
-    return python_filter(1, f, bb, mode, readbytes);
+    return python_filter(1, f, bb, mode, block, readbytes);
 }
 
 
@@ -1216,7 +1217,7 @@
 static apr_status_t python_output_filter(ap_filter_t *f, 
 					 apr_bucket_brigade *bb)
 {
-    return python_filter(0, f, bb, 0, NULL);
+    return python_filter(0, f, bb, 0, 0, 0);
 }
 
 
Index: src/include/filterobject.h
===================================================================
RCS file: /cvsroot/modpython/mod_python/src/include/filterobject.h,v
retrieving revision 1.4
diff -u -r1.4 filterobject.h
--- src/include/filterobject.h	3 Jun 2002 14:31:16 -0000	1.4
+++ src/include/filterobject.h	9 Jul 2002 16:21:36 -0000
@@ -67,7 +67,7 @@
 
 	int is_input;
 	ap_input_mode_t mode;
-	apr_size_t *readbytes;
+	apr_size_t readbytes;
 
 	int closed;
 	int softspace;
@@ -88,7 +88,7 @@
     extern DL_IMPORT(PyObject *) 
 	MpFilter_FromFilter Py_PROTO((ap_filter_t *f, apr_bucket_brigade *bb_in, 
 				      int is_input, ap_input_mode_t mode, 
-				      apr_size_t *readbytes, char *hadler, char *dir));
+				      apr_size_t readbytes, char *hadler, char *dir));
 
 #ifdef __cplusplus
 }
From ecastanedo at hotmail.com  Wed Jul 17 01:04:14 2002
From: ecastanedo at hotmail.com (Edgar Castanedo)
Date: Fri Jan  9 22:03:16 2004
Subject: [mod_python] freebsd
Message-ID: <F1478v6eoHvEmsgTFsF000136d0@hotmail.com>

I have installed Python on FreeBSD from the ports collection. When I try and 
install mod_python (from the ports collection also), a message is returned 
which states that Python needs to be installed WITHOUT threads. I am not 
sure if this is okay since I write lots of Python script and don't know how 
this will affect Pythons performance. Can anyone shed some light on this for 
me as I do not want to disable threads if it means that my scripts will not 
work the way they used to.

Thanks,

*************************************
Edgar Castanedo
ecastanedo@hotmail.com
*************************************


_________________________________________________________________
Chat with friends online, try MSN Messenger: http://messenger.msn.com


From gharris at centauri.mb.ca  Fri Jul 19 00:18:58 2002
From: gharris at centauri.mb.ca (George Harrison)
Date: Fri Jan  9 22:03:16 2004
Subject: [mod_python] Installing mod_python on Win98/Apache
Message-ID: <5.1.0.14.2.20020718231601.027cfec0@pop.mb.sympatico.ca>

After following the instructions in the documentation and copying the files 
from D:\Program Files\Python22\lib\mod_python-x\lib\mod_python to 
D:\Program Files\Python22\lib\mod_python;  I can launch Apache but when I 
try to open mptest.py I get the following message in the error log:

[Thu Jul 18 23:50:19 2002] [error] [client 127.0.0.1] python_handler: 
make_obcallback returned no obCallBack!

Does anyone know what is happening, or have a listing of where the files 
are supposed to be in the python directory for this to work?

Thanks

gh



From gbenson at redhat.com  Wed Jul 10 11:42:21 2002
From: gbenson at redhat.com (Gary Benson)
Date: Fri Jan  9 22:03:16 2004
Subject: [mod_python] [PATCH] last httpd-2.0.36
Message-ID: <Pine.LNX.4.44.0207101139450.20893-200000@slippy.wire.rat>


Hi,

The attached patch brings the input filtering API in mod_python into line 
with that in httpd-2.0.36.  This is the last thing that I know of that 
needed fixing to work with 2.0.36, although I beleive some more fixes will 
be in order to build against 2.0.39 or whatever it is now :)

Cheers,
Gary

[ gbenson@redhat.com ][ GnuPG 85A8F78B ][ http://inauspicious.org/ ]

-------------- next part --------------
Bring input filter API in line with 2.0.36

Index: src/filterobject.c
===================================================================
RCS file: /cvsroot/modpython/mod_python/src/filterobject.c,v
retrieving revision 1.5
diff -u -r1.5 filterobject.c
--- src/filterobject.c	3 Jun 2002 14:31:15 -0000	1.5
+++ src/filterobject.c	9 Jul 2002 16:21:27 -0000
@@ -61,7 +61,7 @@
  */
 
 PyObject *MpFilter_FromFilter(ap_filter_t *f, apr_bucket_brigade *bb, int is_input,
-			      ap_input_mode_t mode, apr_size_t *readbytes,
+			      ap_input_mode_t mode, apr_size_t readbytes,
 			      char * handler, char *dir)
 {
     filterobject *result;
@@ -86,7 +86,7 @@
 	result->bb_in = bb;
 	result->bb_out = NULL;
 	result->mode = 0;
-	result->readbytes = NULL;
+	result->readbytes = 0;
     }
 
     result->closed = 0;
@@ -142,7 +142,7 @@
 
 	Py_BEGIN_ALLOW_THREADS;
 	self->rc = ap_get_brigade(self->f->next, self->bb_in, self->mode, 
-				  APR_BLOCK_READ, *self->readbytes);
+				  APR_BLOCK_READ, self->readbytes);
 	Py_END_ALLOW_THREADS;
 
 	if (! APR_STATUS_IS_SUCCESS(self->rc)) {
@@ -239,7 +239,7 @@
 
 		Py_BEGIN_ALLOW_THREADS;
 		self->rc = ap_get_brigade(self->f->next, self->bb_in, self->mode, 
-					  APR_BLOCK_READ, *self->readbytes);
+					  APR_BLOCK_READ, self->readbytes);
 		Py_END_ALLOW_THREADS;
 
 		if (! APR_STATUS_IS_SUCCESS(self->rc)) {
Index: src/mod_python.c
===================================================================
RCS file: /cvsroot/modpython/mod_python/src/mod_python.c,v
retrieving revision 1.60
diff -u -r1.60 mod_python.c
--- src/mod_python.c	3 Jun 2002 14:31:15 -0000	1.60
+++ src/mod_python.c	9 Jul 2002 16:21:35 -0000
@@ -1023,7 +1023,8 @@
 static apr_status_t python_filter(int is_input, ap_filter_t *f, 
 				  apr_bucket_brigade *bb,
 				  ap_input_mode_t mode,
-				  apr_size_t *readbytes) {
+				  apr_read_type_e block,
+				  apr_size_t readbytes) {
 
     PyObject *resultobject = NULL;
     interpreterdata *idata;
@@ -1052,8 +1053,7 @@
        so a fitler can spit out an error without causing infinite loop */
     if (ctx->transparent) {
 	if (is_input) 
-	    return ap_get_brigade(f->next, bb, mode, APR_BLOCK_READ, 
-				  *readbytes);
+	    return ap_get_brigade(f->next, bb, mode, block, readbytes);
 	else
 	    return ap_pass_brigade(f->next, bb);
     }
@@ -1201,9 +1201,10 @@
 static apr_status_t python_input_filter(ap_filter_t *f, 
 					apr_bucket_brigade *bb,
 					ap_input_mode_t mode,
-					apr_size_t *readbytes) 
+					apr_read_type_e block,
+					apr_off_t readbytes)
 {
-    return python_filter(1, f, bb, mode, readbytes);
+    return python_filter(1, f, bb, mode, block, readbytes);
 }
 
 
@@ -1216,7 +1217,7 @@
 static apr_status_t python_output_filter(ap_filter_t *f, 
 					 apr_bucket_brigade *bb)
 {
-    return python_filter(0, f, bb, 0, NULL);
+    return python_filter(0, f, bb, 0, 0, 0);
 }
 
 
Index: src/include/filterobject.h
===================================================================
RCS file: /cvsroot/modpython/mod_python/src/include/filterobject.h,v
retrieving revision 1.4
diff -u -r1.4 filterobject.h
--- src/include/filterobject.h	3 Jun 2002 14:31:16 -0000	1.4
+++ src/include/filterobject.h	9 Jul 2002 16:21:36 -0000
@@ -67,7 +67,7 @@
 
 	int is_input;
 	ap_input_mode_t mode;
-	apr_size_t *readbytes;
+	apr_size_t readbytes;
 
 	int closed;
 	int softspace;
@@ -88,7 +88,7 @@
     extern DL_IMPORT(PyObject *) 
 	MpFilter_FromFilter Py_PROTO((ap_filter_t *f, apr_bucket_brigade *bb_in, 
 				      int is_input, ap_input_mode_t mode, 
-				      apr_size_t *readbytes, char *hadler, char *dir));
+				      apr_size_t readbytes, char *hadler, char *dir));
 
 #ifdef __cplusplus
 }
From ps0 at igmp.com.ar  Wed Jul  3 19:20:51 2002
From: ps0 at igmp.com.ar (ps0@igmp.com.ar)
Date: Fri Jan  9 22:03:16 2004
Subject: [mod_python] Problems creating files from mod_python
In-Reply-To: <20020702194803.A27995@igmp.com.ar>; from ps0@igmp.com.ar on Tue, Jul 02, 2002 at 07:48:03PM -0300
References: <20020702194803.A27995@igmp.com.ar>
Message-ID: <20020703192051.A18568@igmp.com.ar>

On Tue, Jul 02, 2002 at 07:48:03PM -0300, ps0@igmp.com.ar wrote:

Tnks to all for your anwers , the problem was thread support on python
( crazy things ) . Now with phython compiled without thread support
everyting works fine.

Tnks again.

Regards

> Apache: 1.3.24
> mod_python: 2.7.8
> Python: 2.2 (w/threads) [i have to recompile it
> without threads]
> 
> 
> fd=open("/tmp/bleh.txt", "w")
> fd.write("HOLA\n")
> fd.close()
> 
> On the fd.close() it make this error:
> IOError: [Errno 9] Bad file Descriptor 
> 
> The file is created but i can't write on it.
> 
> 
> The perms are corectly applied, from a python script ( out of apache )
> the thinks work ok.
> 
> Sugestions apreciated.
> 
> Tnks in advance.
> 
> Hector.
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From vmilitaru at sympatico.ca  Wed Jul  3 18:40:33 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 22:03:16 2004
Subject: [mod_python] Tips and Tricks initiative
In-Reply-To: <20020703183427.M2452@sventech.com>; from johannes@erdfelt.com on Wed, Jul 03, 2002 at 06:34:27PM -0400
References: <20020703153239.A772@eye.neb> <20020703183427.M2452@sventech.com>
Message-ID: <20020703184033.A1017@eye.neb>

* Johannes Erdfelt <johannes@erdfelt.com> [020703 18:32]:

> While not the most appropriate name, why doesn't the FAQ work for you?
> 
> http://www.modpython.org/FAQ/faqw.py

Perhaps because until this very moment I was *totally* unaware of its existence.
Many thanks for the pointer.

Cheers, Vio

From vmilitaru at sympatico.ca  Thu Jul  4 13:53:02 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 22:03:16 2004
Subject: [mod_python] Chewing cookies
Message-ID: <20020704135302.A489@eye.neb>

'REQUEST.headers_out.add('Set-Cookie',cookie_value)' seems the recommended way to set up multiple cookies on the client. But what is the recommended way to get back at those cookies? Seems to me that anything like 'REQUEST.headers_in['Set-Cookie'] is no good with more than one cookie, for obvious reasons. Any suggestions?

Cheers, Vio

From vmilitaru at sympatico.ca  Thu Jul  4 15:01:52 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 22:03:16 2004
Subject: [mod_python] Chewing cookies
Message-ID: <20020704190152.RXBC18503.tomts10-srv.bellnexxia.net@eye.neb>

'REQUEST.headers_out.add('Set-Cookie',cookie_value)' seems the recommended way 
to set up multiple cookies on the client. 
But what is the recommended way to get back at those cookies? 
Seems to me that anything like 'REQUEST.headers_in['Set-Cookie'] is no good 
with more than one cookie, for obvious reasons. 
Any tips would be appreciated.

Cheers, Vio


From mateusz at ant.gliwice.pl  Mon Jul 22 11:02:42 2002
From: mateusz at ant.gliwice.pl (Mateusz Korniak)
Date: Fri Jan  9 22:03:17 2004
Subject: [mod_python] Chewing cookies
In-Reply-To: <20020704190152.RXBC18503.tomts10-srv.bellnexxia.net@eye.neb>
References: <20020704190152.RXBC18503.tomts10-srv.bellnexxia.net@eye.neb>
Message-ID: <200207220902.g6M92ss21416@eden.ispol.com>

> 'REQUEST.headers_out.add('Set-Cookie',cookie_value)' seems the recommended
> way to set up multiple cookies on the client.
> But what is the recommended way to get back at those cookies?
> Seems to me that anything like 'REQUEST.headers_in['Set-Cookie'] is no good
> with more than one cookie, for obvious reasons.
> Any tips would be appreciated.

This code works for me: (all cookies seems to be send via single Cookie 
header)
		self.cookies = abbon.html.Cookie.Cookie() # Cookie module downloaded from 
www.python.org as py < 2.0 didn't have Cookie module

		if self.raw_request.headers_in.has_key('Cookie'):
			self.cookies.load(self.raw_request.headers_in['Cookie'])

		if self.cookies.has_key(COOKIEUID):
			self.cookie_uid = str(self.cookies[COOKIEUID].value)

		if self.cookies.has_key(SES):
			self.cookie_ses = str(self.cookies[SES].value)


HIH ...
-- 
Mateusz Korniak


From matt at proweb.co.uk  Mon Jul 22 10:10:56 2002
From: matt at proweb.co.uk (matt)
Date: Fri Jan  9 22:03:17 2004
Subject: [mod_python] Chewing cookies
References: <20020704135302.A489@eye.neb>
Message-ID: <001901c2315f$b0f055f0$6501a8c0@KIKE>

----- Original Message -----
From: "vio" <vmilitaru@sympatico.ca>
To: <mod_python@modpython.org>
Sent: Thursday, July 04, 2002 7:53 PM
Subject: [mod_python] Chewing cookies


> 'REQUEST.headers_out.add('Set-Cookie',cookie_value)' seems the recommended
way to set up multiple cookies on the client. But what is the recommended
way to get back at those cookies? Seems to me that anything like
'REQUEST.headers_in['Set-Cookie'] is no good with more than one cookie, for
obvious reasons. Any suggestions?

cookies are sent to the server url encoded and semi-colon separated on one
line

Cookie: foo=f00%20foo; bar=bar34; bazz=%56;

# here's a noddy cookie cracker

import urllib

cookie_string = REQUEST.headers_in['Cookie']
# eg. cookie_string = 'foo=f00%20foo; bar=bar34; bazz=%37%38%58%58;'

cookies = {}

for cookie in cookiestring.split(";") :
    key_value = cookie.split("=")

 if len(key_value) == 2 :
    cookies[urllib.unquote(key_value[0].strip())] =
urllib.unquote(key_value[1].strip())
print cookies

# eg. outputs
# {'bazz': '78XX', 'foo': 'f00 foo', 'bar': 'bar34'}



# matt


From matt at proweb.co.uk  Tue Jul 23 11:45:56 2002
From: matt at proweb.co.uk (matt)
Date: Fri Jan  9 22:03:17 2004
Subject: [mod_python] Chewing cookies
References: <20020704135302.A489@eye.neb> <001901c2315f$b0f055f0$6501a8c0@KIKE> <20020722225119.B282@eye.neb>
Message-ID: <007f01c23236$221528b0$6501a8c0@KIKE>

Hi, presumably you wanted it to go to the list to so I've included your mail
below in full too

Rather than work out the answres to your questions directly I think it might
be better for you to go read the theory and practice of cookies

The official spec
http://wp.netscape.com/newsref/std/cookie_spec.html
(which is curiously marked as "Preliminary Specification - Use with
caution")
or
http://developer.netscape.com/docs/manuals/communicator/jsguide4/cookies.htm

working with cookies :
http://www.cookiecentral.com/faq/

settign the expiry to a past date will delete them


> Hi Matt,
> Thanks for the reply. (I must say, it's hard not to totally love python.)
> To recap, all cookies are sent by the client in a single header ('Cookie')
> semi-colon separated.
> So here's a couple of follow-up questions:
> * Any rules for the date format? Is something like
> 'expires=Wed, 03-Jul-2002 05:18:07 GMT; ' OK?
>
> * what's the procedure to get rid of a cookie?
> Netscape docs (or Mozilla, I forgot which one) seem to suggest that the
client
> doesn't get rid of the cookie. But I saw in some Zope code snipplet
(again,
> I forgot which module, maybe somewhere in ZPublisher/HTTPResponse), that
> the way Zope dumped old cookies was to send them with a passed date
> ('expires=1971' or something).
>
> Some related data on this topic I found of interest:
> * sending a cookie path ('path=/; ') is Mandatory,
> else Netscape|Lynx won't store the cookie (Explorer?);
> * domain must contain 2 dots minimum, like in 'domain=.foo.com;' (this
also
> found in Zope sources, but not yet tested on my own). Could someone
confirm?
>
> Cheers, Vio



From gharris at centauri.mb.ca  Wed Jul 24 01:38:25 2002
From: gharris at centauri.mb.ca (George Harrison)
Date: Fri Jan  9 22:03:17 2004
Subject: [mod_python] Installing mod_python on Win98/Apache
In-Reply-To: <D31B04F24EDE7644BB169BB4F080778A01F4C546@s30342g004005>
Message-ID: <5.1.0.14.2.20020724012731.00a16dc0@pop.mb.sympatico.ca>

I think that was probably it, but I reinstalled Python, which fixed the 
problem.

thanks

gh
At 11:48 AM 2002.07.19 -0400, you wrote:
>I found that mod_python uses the pythonpath and pythonhome environment
>variables. Make sure that your normal path environment variable can reach
>python.exe. A normal python install does not create these just the .py and
>.pyc associations. If you cannot run python from a command prompt by typing
>python and a .py script, something is wrong. Next, make sure you are using
>the right .so (.dll) with the correct corresponding Apache software version.
>
>Hans
>
>-----Original Message-----
>From: George Harrison [mailto:gharris@centauri.mb.ca]
>Sent: Friday, July 19, 2002 1:19 AM
>To: mod_python@modpython.org
>Subject: [mod_python] Installing mod_python on Win98/Apache
>
>
>After following the instructions in the documentation and copying the files
>from D:\Program Files\Python22\lib\mod_python-x\lib\mod_python to
>D:\Program Files\Python22\lib\mod_python;  I can launch Apache but when I
>try to open mptest.py I get the following message in the error log:
>
>[Thu Jul 18 23:50:19 2002] [error] [client 127.0.0.1] python_handler:
>make_obcallback returned no obCallBack!
>
>Does anyone know what is happening, or have a listing of where the files
>are supposed to be in the python directory for this to work?
>
>Thanks
>
>gh
>
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://www.modpython.org/mailman/listinfo/mod_python


From matt at proweb.co.uk  Thu Jul 25 15:48:55 2002
From: matt at proweb.co.uk (matt)
Date: Fri Jan  9 22:03:17 2004
Subject: [mod_python] postgres progress
Message-ID: <008c01c233ea$69e60000$6501a8c0@KIKE>

bah, I've just run into the same problem as someone else was having 



From matt at proweb.co.uk  Thu Jul 25 16:36:39 2002
From: matt at proweb.co.uk (matt)
Date: Fri Jan  9 22:03:17 2004
Subject: [mod_python] postgres progress
Message-ID: <009d01c233f1$153ed750$6501a8c0@KIKE>

bah, I've just run into the same problem as someone else was having getting
postgres to work with mod_python

http://www.modpython.org/pipermail/mod_python/2001-August/001589.html

pgdb
PyPgSQL
psycopg

all fail to import

this is on FreeBSD 4.4 with mod_python-2.7.6
python-2.2.1
postgresql-7.2.1_1

anyone with any clues ?

M




From imcmeans at telus.net  Thu Jul 25 15:46:57 2002
From: imcmeans at telus.net (Ian McMeans)
Date: Fri Jan  9 22:03:17 2004
Subject: [mod_python] compiling in windows
Message-ID: <003301c2342d$2f28c950$44cee8d8@cr536745a>

I'm running windows XP, python 2.2, apache 2.

I can't get mod_python to compile with VC++ 6. The project file is invalid,
so I make a new one from the .dsp. When I try to compile it, (it tries to
make an .exe) it gives an error about the version.rc file mentioning
MPV_BUILD, which I delete from the file to remove the error.

Then it complains about not having httpd.h, so I download the apache source,
and copy/paste the files from the apache source to the mod_python source.

Then it complains about apr.h, which doesn't exist in the apache source.
There is a apr.h.in, apr.h.hnw, apr.h.w, and test_apr.h. I pick apr.h.w and
rename it to apr.h, copy it to the include directory for mod_python.

I end up having to copy/paste a few different include directories, and
rename some more .hn files to .h, and I still get 715 errors, most of which
are like this:
include\apr_pools.h(191) : error C2061: syntax error : identifier
'apr_pool_initialize'

THere's also this error at the beginning:
Warning: cannot find "mod_python.dep"

Is there somewhere I can download the binary for windows? Or is there a
better way to
compile it in windows, like merging VC projects or something?


From vmilitaru at sympatico.ca  Fri Jul 26 01:49:03 2002
From: vmilitaru at sympatico.ca (vmilitaru@sympatico.ca)
Date: Fri Jan  9 22:03:17 2004
Subject: [mod_python] postgres progress
In-Reply-To: <009d01c233f1$153ed750$6501a8c0@KIKE>; from matt@proweb.co.uk on Thu, Jul 25, 2002 at 04:36:39PM +0100
References: <009d01c233f1$153ed750$6501a8c0@KIKE>
Message-ID: <20020726014902.A317@eye.neb>

If all else fails, you can always consider alternatives. 
One setup example (which does seem to work for couple months now):
* python 2.1
* apache 1.3.26
* mod_ssl 2.8.10
* mod_python 2.7.8
* DCOracle2 1.84 (python interface to Oracle)
* Oracle 8i
(All humming inside a Linux 2.4.2 without a glitch)

That is, of course, if you're not overly religious about postgres.
Cheers, Vio

* matt <matt@proweb.co.uk> [020726 01:20]:
> bah, I've just run into the same problem as someone else was having getting
> postgres to work with mod_python
> 
> http://www.modpython.org/pipermail/mod_python/2001-August/001589.html
> 
> pgdb
> PyPgSQL
> psycopg
> 
> all fail to import
> 
> this is on FreeBSD 4.4 with mod_python-2.7.6
> python-2.2.1
> postgresql-7.2.1_1
> 
> anyone with any clues ?
> 
> M
> 
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

From oliver at redgecko.org  Fri Jul 26 08:30:38 2002
From: oliver at redgecko.org (Oliver Cope)
Date: Fri Jan  9 22:03:17 2004
Subject: [mod_python] postgres progress
In-Reply-To: <009d01c233f1$153ed750$6501a8c0@KIKE>
References: <009d01c233f1$153ed750$6501a8c0@KIKE>
Message-ID: <20020726073038.GA1165@namib.redgecko.org>

On Thu, Jul 25, 2002 at 04:36:39PM +0100, matt wrote:
> bah, I've just run into the same problem as someone else was having getting
> postgres to work with mod_python
> 
> http://www.modpython.org/pipermail/mod_python/2001-August/001589.html
> 
> pgdb
> PyPgSQL
> psycopg
> 
> all fail to import
> 
Have you tried using the PyGreSQL which comes with PostgreSQL?

If you configure PostgreSQL with --with-python it will build and install 
PyGreSQL, and this seems quite stable for use with mod_python.

As I keep as non-threaded installation of Python for use with
mod_python separate from my main python installation, I had to modify
PATH to get PostgreSQL to install the module in the right place:

  % PATH=/opt/python2.1.2-nothreads/bin/:$PATH ./configure --with-python

(PostgreSQL 7.2, mod_python 2.7.6 and python 2.1.2 on OpenBSD 3.1)

Regards,

Olly.


From barr at cs.cornell.edu  Fri Jul  5 02:14:33 2002
From: barr at cs.cornell.edu (Rimon Barr)
Date: Fri Jan  9 22:03:17 2004
Subject: [mod_python] spyce v1.1.18
Message-ID: <Pine.LNX.4.44.0207050213320.12609-100000@pompom.u.cs.cornell.edu>

SPYCE - Server Python Pages

SPYCE is a drop-in Apache module that supports simple and efficient
Python-based dynamic HTML scripting. Those who like Python and are
familiar with JSP, or PHP, or ASP, should have a look at this engine. It
allows one to generate dynamic HTML content just as easily, using Python
for the dynamic parts. Its modular design makes it very flexible and
extensible. It can also be used as a command-line utility for HTML
pre-processing, and also via CGI or FCGI on other servers.

v1.1.18 released on 5 July 2002.

Get it at:
  http://spyce.sourceforge.net

----------
Partial change log:

v1.1.18
  fcgi support added
  X-Spyce header added
  documentation: how to write new modules

v1.1.17
  feature request - compaction algorithm improved

v1.1.16
  generalised session.setHandler (session handler selection mechanism)
  gdbm, bsd db session handlers added

v1.1.15
  minor makefile and rpm script changes
  handling of multi-line strings in python code
  response.flush() added

v1.1.14
  wrappers to check python version

v1.1.13
  added new language construct: "Python chunks"

v1.1.12
  stdout module redirects stdout to response object
  added writeln() to response module


From jack_diederich at email.com  Mon Jul 29 11:20:21 2002
From: jack_diederich at email.com (Jack Diederich)
Date: Fri Jan  9 22:03:17 2004
Subject: [mod_python] Fw: slow child init problems
Message-ID: <20020729162021.20546.qmail@email.com>

I tried sending this before I was a member of the list, and  I guess it wasn't approved...

I have a project running under mod_python with about 10k of python source.

On a pIII-500 it takes 2 seconds for the first request to an httpd process,
and 0.2 seconds for each request after that to run.  This isn't a show stopper
for now, but it really bugs me (the software will be production in about a month)

I've thought of switching to WebWare, which shouldn't have this problem, but is
otherwise more than I need and the switching costs would be non-zero.

The problem seems to be that the imports, even with the PythonImport directive listing all of them
aren't done until ChildInitHanlder(), which is called the first time a child process
gets its first hit, apparently.  I say apparently because the difference between
using PythonImport or not is zero time-wise.  Using .pyo files instead of .py
cuts the first-hit time in half, but is still five times
larger than the time to handle a second hit.

Why can't the work (whatever it is) be done _before_ the fork of the children?
This is what mod_perl does.  mod_php doesn't, it has some possibly intentional
design problems that require a fresh interperator init and byte compile between
requests (but there are hooks in the code for the $ work-aournd module).
But looking through the python internals I couldn't figure out why this isn't possible. I couldn't figure out where to patch it myself, but I didn't see any showstoppers like with php.

So ... anyone know how to work around this, why its done this way, or where I
should look to patch it?

thanks in advance,
-jackdied

-- 
__________________________________________________________
Sign-up for your own FREE Personalized E-mail at Mail.com
http://www.mail.com/?sr=signup

Get 4 DVDs for $.49 cents! plus shipping & processing. Click to join.
http://adfarm.mediaplex.com/ad/ck/990-1736-3566-59


From grisha at modpython.org  Mon Jul 29 21:36:14 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:17 2004
Subject: [mod_python] Fw: slow child init problems
In-Reply-To: <20020729162021.20546.qmail@email.com>
Message-ID: <Pine.BSF.4.32.0207292038430.25221-100000@localhost>

On Mon, 29 Jul 2002, Jack Diederich wrote:

> The problem seems to be that the imports, even with the PythonImport
> directive listing all of them aren't done until ChildInitHanlder(),
> which is called the first time a child process gets its first hit,
> apparently.  I say apparently because the difference between using
> PythonImport or not is zero time-wise.

[snip]

> Why can't the work (whatever it is) be done _before_ the fork of the
> children?

[snip]

First, you should look at making sure that everything runs under one
sub-interpreter. The information such as the name of the virtual host is
undefined until the actual request comes in, so PythonImport imports
everything under the interpreter named after the directory in the
surrounding <Directory> tag or the main interpreter. Your other code
probably runs in the subinterpreter for that virtual server, so it ends up
reimporting everything again. You can force everything to run under the
main interpreter by specifying "PythonInterpreter main_interpreter".

It's possible that you're right that ChildInit gets executed on the first
hit, I can't answer this off the top of my head without digging in apache
source code or experimenting. The reason PythonImport stuff does not get
executed at Apache startup before it forks is because at that point Apache
is run as root.

IMHO PythonImport is bad and shouldn't be there. I understand the issue,
but PythonImport isn't the cleanest solution to it because of the way it
ends up having be implemented, and I can't think of anything clever that
would address this.

One simple hack to tackle this problem is to add something into your
Apache startup script that initiates the first hit using wget or fetch or
lynx or whatever. I've used this technique very successfuly before.

Grisha


From jack_diederich at email.com  Mon Jul 29 23:24:42 2002
From: jack_diederich at email.com (Jack Diederich)
Date: Fri Jan  9 22:03:17 2004
Subject: [mod_python] How mod_perl does Imports vs mod_python
Message-ID: <20020730042442.7423.qmail@email.com>

Followup to my earlier post about slow init times.
mod_perl only has one interpreter.  It processes
imports as the last thing before leaving the apache
module init function (in mod_python, this would be
python_init())

If the main interpreter exists by the end of python_init()
[I think it does, but I don't know the interpreter internals
at all] we could at least populate that with the PythonImport
directives from httpd.conf

This wouldn't solve the problem for everyone (those using
virtual hosts) but it would at least solve mine :)
Optionally to support virtual hosts there could be a directive to prespawn sub-interpreters and process the 
import directives for those too.

Can any of the mod_python authors comment?  I might be
able to try my hand at a patch in a month, but for now 
I'll just stick with my workaround (ugly combination of a 
proxy and wget)

mod_perl also has a lot of logic to differentiate between a
stop/start and a restart.  In the restart case it actually
does the import _while_ reading the config.  In the fresh
start case it waits until the end of the init function.
I don't know if you can purge or overwrite import info in
a python interpreter like you can with perl. (perl just has
one big namespace plus smaller funciton/loop/etc variables).

Use of globals and macros to access them to keep track of
information about startup, pending imports, etc.

-jackdied


-- 
__________________________________________________________
Sign-up for your own FREE Personalized E-mail at Mail.com
http://www.mail.com/?sr=signup

Get 4 DVDs for $.49 cents! plus shipping & processing. Click to join.
http://adfarm.mediaplex.com/ad/ck/990-1736-3566-59


From peter.bittner at gmx.net  Tue Jul 30 18:54:48 2002
From: peter.bittner at gmx.net (Peter Bittner)
Date: Fri Jan  9 22:03:17 2004
Subject: [mod_python] Configuring Apache
Message-ID: <3055.1028048088@www55.gmx.net>

Hi,

I've got SuSE Linux 8.0, so there are probably the latest stable versions of
mod_python and Apache on my computer. Apache is installed with the
mod_python module (an appropriate message shows up, when the apache server ist
(re)started.)

However, since .py files are obviously not recognized as Python scripts I
have added the following lines to my httpd.conf file in the mime-types section:

    #
    # Python:
    #
    <IfModule mod_python.c>
    AddType application/x-httpd-python .py
    AddHandler python-program .py
    #PythonHandler index
    </IfModule>

Now it comes:
When I remove the comment-character in front of the "PythonHandler"
statement, the Apache server gives me a "500 Server Misconfiguration Error".

Can anyone help me getting .py-scripts running on my Apache?

Cheers, Peter

-- 
Peter Bittner
mobil: +43/(0)650/4151545
web: http://beam.to/peter.bittner - http://beam.to/htmlkurs
mail: peter.bittner@gmx.net

"Free software is like free speech, not free beer" (Richard Stallman)

GMX - Die Kommunikationsplattform im Internet.
http://www.gmx.net


From jack_diederich at email.com  Mon Jul 29 21:02:27 2002
From: jack_diederich at email.com (Jack Diederich)
Date: Fri Jan  9 22:03:17 2004
Subject: [mod_python] Fw: slow child init problems
Message-ID: <20020730020227.9604.qmail@email.com>

[me]
> > Why can't the work (whatever it is) be done _before_ the fork of the
> > children?

[Gregory Trubetskoy]
> First, you should look at making sure that everything runs under one
> sub-interpreter. The information such as the name of the virtual host is
> undefined until the actual request comes in, so PythonImport imports
> everything under the interpreter named after the directory in the
> surrounding <Directory> tag or the main interpreter. Your other code
> probably runs in the subinterpreter for that virtual server, so it ends up
> reimporting everything again. You can force everything to run under the
> main interpreter by specifying "PythonInterpreter main_interpreter".

I'm not running any virtual servers. I tried the directive
and it had the same behavior (first time a process gets
hit it takes 10 times the second and further hits)

> It's possible that you're right that ChildInit gets executed on the first
> hit, I can't answer this off the top of my head without digging in apache
> source code or experimenting. 

I've looked at the code, and it doesn't get called until the
first hit.  BTW, one thing I love about python (and
mod_python) is that the source is incredibly easy to browse
and understand (compare perl internals).

That said, I'm going to go swimming in perl/mod_perl for a
bit to see how they do it. Failing that, maybe I'll hit up
the mod_perl mailing list for help.

thanks,

-jackdied







-- 
__________________________________________________________
Sign-up for your own FREE Personalized E-mail at Mail.com
http://www.mail.com/?sr=signup

Get 4 DVDs for $.49 cents! plus shipping & processing. Click to join.
http://adfarm.mediaplex.com/ad/ck/990-1736-3566-59


From peter.bittner at gmx.net  Tue Jul 30 19:14:32 2002
From: peter.bittner at gmx.net (Peter Bittner)
Date: Fri Jan  9 22:03:17 2004
Subject: [mod_python] Re: Configuring Apache
Message-ID: <6296.1028049272@www55.gmx.net>

Hi,

I've probably found the reason why Apache shows a 500-error. The Apache
error log shows:

  make_obcallback(): could not import mod_python.apache.
  make_obcallback(): could not call init.

This because I tried to execute the following script (index.py):

  from mod_python import apache
  def handler(req):
        req.send_http_header()
        req.write("hello %s" % req.remote_host)
        return apache.OK

And when I run python from the commandline and try this:
  import mod_python
Python tells me it doesn't know any module named mod_python!

How do I fix this problem??

Peter


-- 
Peter Bittner
mobil: +43/(0)650/4151545
web: http://beam.to/peter.bittner - http://beam.to/htmlkurs
mail: peter.bittner@gmx.net

"Free software is like free speech, not free beer" (Richard Stallman)

GMX - Die Kommunikationsplattform im Internet.
http://www.gmx.net


From vmilitaru at sympatico.ca  Tue Jul 30 14:25:47 2002
From: vmilitaru at sympatico.ca (vmilitaru@sympatico.ca)
Date: Fri Jan  9 22:03:18 2004
Subject: [mod_python] Configuring Apache
In-Reply-To: <3055.1028048088@www55.gmx.net>; from peter.bittner@gmx.net on Tue, Jul 30, 2002 at 06:54:48PM +0200
References: <3055.1028048088@www55.gmx.net>
Message-ID: <20020730142546.A979@eye.neb>

Sounds like you haven't read the mod_python (excellent!) docs.
I suggest you start with that. FAQ has also useful tips for your next hurdles.
But the 'fast and dirty' answer to your question is:

PythonHandler publisher

but eventually (hopefully):

PythonHandler your_own_customized_publisher

Cheers,
Vio

* Peter Bittner <peter.bittner@gmx.net> [020730 14:15]:
> Hi,
> 
> I've got SuSE Linux 8.0, so there are probably the latest stable versions of
> mod_python and Apache on my computer. Apache is installed with the
> mod_python module (an appropriate message shows up, when the apache server ist
> (re)started.)
> 
> However, since .py files are obviously not recognized as Python scripts I
> have added the following lines to my httpd.conf file in the mime-types section:
> 
>     #
>     # Python:
>     #
>     <IfModule mod_python.c>
>     AddType application/x-httpd-python .py
>     AddHandler python-program .py
>     #PythonHandler index
>     </IfModule>
> 
> Now it comes:
> When I remove the comment-character in front of the "PythonHandler"
> statement, the Apache server gives me a "500 Server Misconfiguration Error".
> 
> Can anyone help me getting .py-scripts running on my Apache?
> 
> Cheers, Peter
> 
> -- 
> Peter Bittner
> mobil: +43/(0)650/4151545
> web: http://beam.to/peter.bittner - http://beam.to/htmlkurs
> mail: peter.bittner@gmx.net
> 
> "Free software is like free speech, not free beer" (Richard Stallman)
> 
> GMX - Die Kommunikationsplattform im Internet.
> http://www.gmx.net
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

From list-mod_python at empires.org  Tue Jul 30 13:35:34 2002
From: list-mod_python at empires.org (Jeff Davis)
Date: Fri Jan  9 22:03:18 2004
Subject: [mod_python] Configuring Apache
In-Reply-To: <3055.1028048088@www55.gmx.net>
References: <3055.1028048088@www55.gmx.net>
Message-ID: <200207301335.34801.list-mod_python@empires.org>

Here is my configuration information (note: I use the publisher handler, find 
out more about the different built-in handlers at http://www.modpython.org):

AddHandler python-program .py
PythonHandler mod_python.publisher
PythonDebug On

Regards,
	Jeff

On Tuesday 30 July 2002 09:54 am, Peter Bittner wrote:
> Hi,
>
> I've got SuSE Linux 8.0, so there are probably the latest stable versions
> of mod_python and Apache on my computer. Apache is installed with the
> mod_python module (an appropriate message shows up, when the apache server
> ist (re)started.)
>
> However, since .py files are obviously not recognized as Python scripts I
> have added the following lines to my httpd.conf file in the mime-types
> section:
>
>     #
>     # Python:
>     #
>     <IfModule mod_python.c>
>     AddType application/x-httpd-python .py
>     AddHandler python-program .py
>     #PythonHandler index
>     </IfModule>
>
> Now it comes:
> When I remove the comment-character in front of the "PythonHandler"
> statement, the Apache server gives me a "500 Server Misconfiguration
> Error".
>
> Can anyone help me getting .py-scripts running on my Apache?
>
> Cheers, Peter


From peter.bittner at gmx.net  Wed Jul 31 17:40:53 2002
From: peter.bittner at gmx.net (Peter Bittner)
Date: Fri Jan  9 22:03:18 2004
Subject: [mod_python] make_obcallback(): could not import mod_python.apache
References: <200207301335.34801.list-mod_python@empires.org>
Message-ID: <28386.1028130053@www30.gmx.net>

I have mod_python installed on SuSE Linux 8.0 and I have set up my
httpd.conf according to the mod_python documentation, but unfortunately I get the
following error message in my error log:

make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.

I have also tried the import statement in my python interpreter, but it
says:

>>> from mod_python import apache
Traceback (most recent call last):
  File "<stdin>", line 1, in ?
ImportError: No module named mod_python

So there seems to be no mod_python module available! (Where has it gone? -
This doesn't seem to be an ordinary error, does it?) I havn't found any answer
ind the FAQs regarding this problem.

Please help!
Peter


-- 
Peter Bittner
mobil: +43/(0)650/4151545
web: http://beam.to/peter.bittner - http://beam.to/htmlkurs
mail: peter.bittner@gmx.net

"Free software is like free speech, not free beer" (Richard Stallman)

GMX - Die Kommunikationsplattform im Internet.
http://www.gmx.net


From christoph at cocon-seide.com  Wed Jul 31 17:51:45 2002
From: christoph at cocon-seide.com (Christoph Fritzsch)
Date: Fri Jan  9 22:03:18 2004
Subject: [mod_python] Configuring Apache
Message-ID: <200207311554.g6VFsWs48906@eden.ispol.com>

Hi Peter,

I tried it with Suse 7.3 some time ago and found it only workable by 

1) uncommenting all <Ifmodule python>  </if..>

#<IfDefine Python>
LoadModule python_module      /usr/lib/apache/mod_python.so
#</IfDefine>
#<IfDefine Python>
AddModule mod_python.c
#</IfDefine>

so the module is loaded for sure, as I couldnt get it to work with the Suse supplied 
starting parameters

2) Then I put this in there

#Python
#<IfModule mod_python.c>
<Directory "/usr/local/httpd/htdocs/test">
AddHandler python-program .py
PythonHandler mptest
PythonDebug On
</Directory>
#</IfModule>

as you did it

and  I also had to put in a  link 
/usr/lib/python2.1/site-packages/mod_python 
->/usr/lib/apache/lib/python2.1/site-packages/mod_python/

maybe you hv to replace the 2.1 to 2.2

reload apache and any file you call in the test directory will execute the mptest program

This is what the mod_python should do. That is as far as I got. I think next step is to 
expand the mptest program so you can call subroutines in it which presumaly do more 
usefull stuff than "Hello World!" !!

BR Christoph


From daniel at copyleft.no  Sun Jul 14 10:53:01 2002
From: daniel at copyleft.no (Hr. Daniel Mikkelsen)
Date: Fri Jan  9 22:03:19 2004
Subject: [mod_python] Understanding mod_python
In-Reply-To: <1026635587.26526.30.camel@kernel>
Message-ID: <20020714105239.O43368-100000@unity.copyleft.no>

On 14 Jul 2002, Fabian Fagerholm wrote:

> There were also some posts about a mod_python "cookbook", and another
> poster suggested the on-line FAQ would be a good place for the
> "recipes". I totally agree - well-written example code is the best way
> to learn.
> I'd like to suggest that a new category be created in the FAQ for these
> snippets of example code.

Make it a wiki.

-- Daniel


From fabbe at paniq.net  Sun Jul 14 20:34:01 2002
From: fabbe at paniq.net (Fabian Fagerholm)
Date: Fri Jan  9 22:03:19 2004
Subject: [mod_python] Understanding mod_python
In-Reply-To: <290A467D-9742-11D6-9B12-0030653DCC28@attbi.com>
References: <290A467D-9742-11D6-9B12-0030653DCC28@attbi.com>
Message-ID: <1026668042.1616.3.camel@kernel>

On Sun, 2002-07-14 at 18:55, Jeff Stearns wrote:
> Fabian -
> 
> I'd like to review your drawings, but it's not easy for me to view 
> Postscript.  This is probably true for other folks as well.  If you can 
> offer them in another, more generic format, you may get a better 
> response.

Oh, I'm sorry. I thought Postscript was a good format for most people. I
suppose that's a un*x thing, though.

I made PDF versions of the files as well. They're all in
http://www.paniq.net/fabbe/mod_python/

I hope more people can look at the drawings now. Thanks for the
feedback, Jeff!

Cheers,
fabian

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 240 bytes
Desc: This is a digitally signed message part
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20020714/5b977028/attachment-0003.bin
From vmilitaru at sympatico.ca  Sun Jul 14 13:55:37 2002
From: vmilitaru at sympatico.ca (vio)
Date: Fri Jan  9 22:03:19 2004
Subject: [mod_python] Ping?
In-Reply-To: <Pine.LNX.4.44.0207131250410.31967-100000@slippy.wire.rat>; from gbenson@redhat.com on Sat, Jul 13, 2002 at 12:51:32PM +0100
References: <Pine.LNX.4.44.0207131250410.31967-100000@slippy.wire.rat>
Message-ID: <20020714135537.A278@eye.neb>

Same here. But even more problematic seems that some messages never make it to 
the list (at least some of my messages never did).
Possible solution (provided this message make it to the list): how about 
migrating modpython to 'sourceforge'? It's totally
free and they do an outstanding hosting job.

Chers,
Vio

* Gary Benson <gbenson@redhat.com> [020714 13:45]:
> 
> It seems that I am getting messages from this list with a four day lag. 
> Is anyone else experiencing this?
> 
> Cheers,
> Gary
> 
> [ gbenson@redhat.com ][ GnuPG 85A8F78B ][ http://inauspicious.org/ ]
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python

From kastner.j at supp.cz  Mon Jul 15 09:27:14 2002
From: kastner.j at supp.cz (=?iso-8859-2?Q?Ji=F8=ED_Kastner?=)
Date: Fri Jan  9 22:03:19 2004
Subject: [mod_python] compiled code execution
Message-ID: <003301c22bd1$0ac2e820$0301a8c0@pentium>

i'm interested about possibility to execute .pyc code by adding line to
httpd.conf:

AddHandler python-program .pyc

or if this is nonsense, because python is executing it directly, if is .pyc
present?
why? i'm writing web app. and this one will be distributed to others and i
need eliminate changing code by anybody (some distributions will be running
on win9x).

have anybody experience with this kind of problems?

jiri kastner




From gbenson at redhat.com  Mon Jul 15 10:17:02 2002
From: gbenson at redhat.com (Gary Benson)
Date: Fri Jan  9 22:03:19 2004
Subject: [mod_python] [PATCH] last httpd-2.0.36
Message-ID: <Pine.LNX.4.44.0207151016390.12912-200000@slippy.wire.rat>


Hi,

The attached patch brings the input filtering API in mod_python into line 
with that in httpd-2.0.36.  This is the last thing that I know of that 
needed fixing to work with 2.0.36, although I beleive some more fixes will 
be in order to build against 2.0.39 or whatever it is now :)

Cheers,
Gary

[ gbenson@redhat.com ][ GnuPG 85A8F78B ][ http://inauspicious.org/ ]
-------------- next part --------------
Bring input filter API in line with 2.0.36

Index: src/filterobject.c
===================================================================
RCS file: /cvsroot/modpython/mod_python/src/filterobject.c,v
retrieving revision 1.5
diff -u -r1.5 filterobject.c
--- src/filterobject.c	3 Jun 2002 14:31:15 -0000	1.5
+++ src/filterobject.c	9 Jul 2002 16:21:27 -0000
@@ -61,7 +61,7 @@
  */
 
 PyObject *MpFilter_FromFilter(ap_filter_t *f, apr_bucket_brigade *bb, int is_input,
-			      ap_input_mode_t mode, apr_size_t *readbytes,
+			      ap_input_mode_t mode, apr_size_t readbytes,
 			      char * handler, char *dir)
 {
     filterobject *result;
@@ -86,7 +86,7 @@
 	result->bb_in = bb;
 	result->bb_out = NULL;
 	result->mode = 0;
-	result->readbytes = NULL;
+	result->readbytes = 0;
     }
 
     result->closed = 0;
@@ -142,7 +142,7 @@
 
 	Py_BEGIN_ALLOW_THREADS;
 	self->rc = ap_get_brigade(self->f->next, self->bb_in, self->mode, 
-				  APR_BLOCK_READ, *self->readbytes);
+				  APR_BLOCK_READ, self->readbytes);
 	Py_END_ALLOW_THREADS;
 
 	if (! APR_STATUS_IS_SUCCESS(self->rc)) {
@@ -239,7 +239,7 @@
 
 		Py_BEGIN_ALLOW_THREADS;
 		self->rc = ap_get_brigade(self->f->next, self->bb_in, self->mode, 
-					  APR_BLOCK_READ, *self->readbytes);
+					  APR_BLOCK_READ, self->readbytes);
 		Py_END_ALLOW_THREADS;
 
 		if (! APR_STATUS_IS_SUCCESS(self->rc)) {
Index: src/mod_python.c
===================================================================
RCS file: /cvsroot/modpython/mod_python/src/mod_python.c,v
retrieving revision 1.60
diff -u -r1.60 mod_python.c
--- src/mod_python.c	3 Jun 2002 14:31:15 -0000	1.60
+++ src/mod_python.c	9 Jul 2002 16:21:35 -0000
@@ -1023,7 +1023,8 @@
 static apr_status_t python_filter(int is_input, ap_filter_t *f, 
 				  apr_bucket_brigade *bb,
 				  ap_input_mode_t mode,
-				  apr_size_t *readbytes) {
+				  apr_read_type_e block,
+				  apr_size_t readbytes) {
 
     PyObject *resultobject = NULL;
     interpreterdata *idata;
@@ -1052,8 +1053,7 @@
        so a fitler can spit out an error without causing infinite loop */
     if (ctx->transparent) {
 	if (is_input) 
-	    return ap_get_brigade(f->next, bb, mode, APR_BLOCK_READ, 
-				  *readbytes);
+	    return ap_get_brigade(f->next, bb, mode, block, readbytes);
 	else
 	    return ap_pass_brigade(f->next, bb);
     }
@@ -1201,9 +1201,10 @@
 static apr_status_t python_input_filter(ap_filter_t *f, 
 					apr_bucket_brigade *bb,
 					ap_input_mode_t mode,
-					apr_size_t *readbytes) 
+					apr_read_type_e block,
+					apr_off_t readbytes)
 {
-    return python_filter(1, f, bb, mode, readbytes);
+    return python_filter(1, f, bb, mode, block, readbytes);
 }
 
 
@@ -1216,7 +1217,7 @@
 static apr_status_t python_output_filter(ap_filter_t *f, 
 					 apr_bucket_brigade *bb)
 {
-    return python_filter(0, f, bb, 0, NULL);
+    return python_filter(0, f, bb, 0, 0, 0);
 }
 
 
Index: src/include/filterobject.h
===================================================================
RCS file: /cvsroot/modpython/mod_python/src/include/filterobject.h,v
retrieving revision 1.4
diff -u -r1.4 filterobject.h
--- src/include/filterobject.h	3 Jun 2002 14:31:16 -0000	1.4
+++ src/include/filterobject.h	9 Jul 2002 16:21:36 -0000
@@ -67,7 +67,7 @@
 
 	int is_input;
 	ap_input_mode_t mode;
-	apr_size_t *readbytes;
+	apr_size_t readbytes;
 
 	int closed;
 	int softspace;
@@ -88,7 +88,7 @@
     extern DL_IMPORT(PyObject *) 
 	MpFilter_FromFilter Py_PROTO((ap_filter_t *f, apr_bucket_brigade *bb_in, 
 				      int is_input, ap_input_mode_t mode, 
-				      apr_size_t *readbytes, char *hadler, char *dir));
+				      apr_size_t readbytes, char *hadler, char *dir));
 
 #ifdef __cplusplus
 }
From nicks at metrolink.com  Mon Jul 15 13:19:15 2002
From: nicks at metrolink.com (Nick Seidenman)
Date: Fri Jan  9 22:03:19 2004
Subject: [mod_python] typehandler
Message-ID: <3D330413.9090203@metrolink.com>

Anyone got a quick example of how this one's used?    When I try 
something simple, like:

    def typehandler (req):
        req.content_type = 'text/plain'
        req.send_http_headers ()
        return apache.OK

I just get a listing of the module that contains this.

TiA,
Nick


From rien at yeepa.org  Fri Jul 26 00:12:44 2002
From: rien at yeepa.org (Adrien Plisson)
Date: Fri Jan  9 22:03:19 2004
Subject: [mod_python] please, old fool needs help with getting apache mod_python on windows 98 to run
References: <NDBBIADKLJIPFGPECIJPOELOCMAA.jdaily@kc.rr.com>
Message-ID: <001201c23428$67399b80$03020101@skynet.be>

From: "james daily" <jdaily@kc.rr.com>
>
> the mod_python online manual at:
>
http://www.modpython.org/live/mod_python-2.7.8/doc-html/app-wininst.html
>
> says:
> XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
...
> if someone has it actually running on their windows 98 system,
> could you please send me the ***relevant*** portions from your
> apache httpd.conf file?
>
> i have tried numerous different approaches to no avail.

ok  i posted something about the windows portion of the doc in march of this
year.
take a look at:
http://www.modpython.org/pipermail/mod_python/2002-March/001934.html
at the end of the post there is my correction to the manual, tested on
apache for NT.

now about having just the mptest.py text in your browser there was another
post in the mailing list... don't remember when, probably in april or june.
try to browse it.

> alas, i am a programmer but not (yet) an apache guru.

time will come...

> any help would be greatly appreciated.

done

--
rien



From list-mod_python at empires.org  Tue Jul 16 13:38:19 2002
From: list-mod_python at empires.org (Jeff Davis)
Date: Fri Jan  9 22:03:19 2004
Subject: [mod_python] new to mod_python, with a question.
In-Reply-To: <1026773181.12028.7.camel@locutus>
References: <1026773181.12028.7.camel@locutus>
Message-ID: <200207161338.19702.list-mod_python@empires.org>

Is is possible that you're using the publisher handler? The publisher handler 
basically does a req.write() on whatever is returned by your function. So, it 
looks like it's printing the actual text of apache.OK after all of your 
req.write()s. Look in your apache config for possible use of 
mod_python.publisher, or perhaps something else that might print the return 
of your function.

Regards,
	Jeff

On Monday 15 July 2002 03:46 pm, Bill Anderson wrote:
> OK, so here is what I am doing. I am using PageTemplates (from zope) and
> mod_python. or at least, I am trying to. :)
>
>
> if I do _NOT_ use the request object (i.e. I return a fully formed html
> string/document), it works fine. but of course, that means no use of
> mod-python's request objects functions such as cookie/header
> construction, usage, etc.
>
> To wit:
> def sayit(req,x=12):
> 	if not x:
> 		return "I need x"
> 	if not master:
> 		return "I need a master object"
> 	pt=PageTemplate()
> 	filestring =
> "".join(open("/home/ucntcme/public_html/pythonapps/test.pt").readlines())
> 	pt.write(filestring)
> 	myx=int(x)
>         req.content_type="text/html"
>         req.send_http_headers()
> 	req.write( pt(x=myx,master=master) )
> 	return apache.OK
>
> returns my rendered template, but at the bottom has:
>
> HTTP/1.1 200 OK Date: Mon, 15 Jul 2002 22:44:27 GMT Server:
> Apache/1.3.22 (Unix) (Red-Hat/Linux) mod_python/2.7.8 Python/2.2.1
> mod_ssl/2.8.5 OpenSSL/0.9.6b DAV/1.0.2 PHP/4.0.6 mod_perl/1.26
> Connection: close Transfer-Encoding: chunked Content-Type: text/html;
> charset=iso-8859-1
> OK
> The server encountered an internal error or misconfiguration and was
> unable to complete your request.
>
>
>
> Debug is on, and there are no mesages in the error_log.
>
> Now, if I just return the content using return (content), it works fine.
>
> Why is this/what am I doing wrong here?
>
> Cheers, Bill
>
>
>
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From bill at immosys.com  Tue Jul 16 17:41:41 2002
From: bill at immosys.com (Bill Anderson)
Date: Fri Jan  9 22:03:20 2004
Subject: [mod_python] new to mod_python, with a question.
In-Reply-To: <200207161338.19702.list-mod_python@empires.org>
References: <1026773181.12028.7.camel@locutus> 
	<200207161338.19702.list-mod_python@empires.org>
Message-ID: <1026862902.17401.28.camel@locutus>

On Tue, 2002-07-16 at 14:38, Jeff Davis wrote:
> Is is possible that you're using the publisher handler? The publisher handler 

Yes, I am ...

> basically does a req.write() on whatever is returned by your function. So, it 
> looks like it's printing the actual text of apache.OK after all of your 
> req.write()s. Look in your apache config for possible use of 

Ah, I see. Ok. So now that I know why...

How can I have a funtion that writes all the HTML, and still use
mod_python's cookie functions? can I use them, even though I return
html, instead of the req.writes() and return apache.OK combo?





From tree at basistech.com  Tue Jul 16 22:01:46 2002
From: tree at basistech.com (Tom Emerson)
Date: Fri Jan  9 22:03:20 2004
Subject: [mod_python] freebsd
In-Reply-To: <F1478v6eoHvEmsgTFsF000136d0@hotmail.com>
References: <F1478v6eoHvEmsgTFsF000136d0@hotmail.com>
Message-ID: <15668.53258.78331.46765@magrathea.basistech.com>

Edgar Castanedo writes:
> I have installed Python on FreeBSD from the ports collection. When I
> try and install mod_python (from the ports collection also), a
> message is returned which states that Python needs to be installed
> WITHOUT threads. I am not sure if this is okay since I write lots of
> Python script and don't know how this will affect Pythons
> performance. Can anyone shed some light on this for me as I do not
> want to disable threads if it means that my scripts will not work
> the way they used to.

Unless you are explicitly using threads in your existing Python
scripts, don't worry about. I would not expect the performance to
degrade too much, if at all.

On some systems (e.g., Linux) you can run mod_python with a threaded
Python interpreter without a hitch. Unfortunately if you want to use
mod_python on FreeBSD you'll need to rebuild your Python distribution.

    -tree


-- 
Tom Emerson                                          Basis Technology Corp.
Sr. Computational Linguist                         http://www.basistech.com
  "Beware the lollipop of mediocrity: lick it once and you suck forever"

From gharris at centauri.mb.ca  Wed Jul 17 02:46:24 2002
From: gharris at centauri.mb.ca (George Harrison)
Date: Fri Jan  9 22:03:20 2004
Subject: [mod_python] Installing mod_python on Win98/Apache
Message-ID: <5.1.0.14.2.20020717020135.01dd78a0@pop.mts.net>

After following the instructions in the documentation and copying the files 
from C:\Program Files\Python\lib\mod_python-x\lib\mod_python to C:\Program 
Files\Python\lib\mod_python; when I launch Apache I get the message:

Syntax error on line 194 of c:/program piles/apache 
group/apache/conf/httpd.conf:

Cannot load module
c:/program files/apache group/apache/modules/mod_python.dll
into server: (1157) One of the library files needed to run
this application cannot be found.

line 194 consists of "LoadModule python_module modules/mod_python.dll"
I have added the line "AddModule mod_python.c" after the ClearModuleList 
Directive, but the program doesn't seem to be getting that far in httpd.conf.

Does anyone know what I'm doing wrong?

Thanks

gh


From gharris at centauri.mb.ca  Fri Jul 19 00:30:54 2002
From: gharris at centauri.mb.ca (George Harrison)
Date: Fri Jan  9 22:03:20 2004
Subject: [mod_python] Test, please ignore
Message-ID: <5.1.0.14.2.20020719003018.027ccb90@pop.mb.sympatico.ca>

test


From mark.evans.b at bayer.com  Fri Jul 19 09:59:41 2002
From: mark.evans.b at bayer.com (Mark Evans)
Date: Fri Jan  9 22:03:20 2004
Subject: [mod_python] mod_python and W2K
Message-ID: <200207191657.g6JGvHs84445@eden.ispol.com>

Hi All,

I know this general issue has come up before and I have tried everything I have
found in the archives, but nothing works.  So please bear with me.  I am trying
to get mod_python to run on W2K.  Apache is installed as a service.  My system
configuration is this:

W2K SP2
Apache 1.3.24
Python 2.1.3
mod_python-2.7.6

Environment variables:
path contains  C:\Python21\;
PYTHONPATH = C:\Program Files\Apache Group\Apache\htdocs\python  (this was added
per an archive post, doesn't work with or without it)

