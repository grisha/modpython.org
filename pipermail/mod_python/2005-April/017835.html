<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Sessions performance and some numbers
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Sessions%20performance%20and%20some%20numbers&In-Reply-To=86d7dc3de3e30864cb6b6b282b63ceb4%40dscpl.com.au">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017829.html">
   <LINK REL="Next"  HREF="017836.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Sessions performance and some numbers</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>dharana</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Sessions%20performance%20and%20some%20numbers&In-Reply-To=86d7dc3de3e30864cb6b6b282b63ceb4%40dscpl.com.au"
       TITLE="[mod_python] Sessions performance and some numbers">dharana at dharana.net
       </A><BR>
    <I>Thu Apr  7 06:08:06 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="017829.html">[mod_python] Sessions performance and some numbers
</A></li>
        <LI>Next message: <A HREF="017836.html">[mod_python] Sessions performance and some numbers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17835">[ date ]</a>
              <a href="thread.html#17835">[ thread ]</a>
              <a href="subject.html#17835">[ subject ]</a>
              <a href="author.html#17835">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Graham Dumpleton wrote:
&gt;<i> 
</I>&gt;<i> On 07/04/2005, at 5:31 AM, dharana wrote:
</I>&gt;<i> 
</I>&gt;<i> [...]
</I>&gt;<i> 
</I>&gt;<i> Someone posted something a bit more recent which used a database for
</I>&gt;<i> doing sessions.
</I>&gt;<i> 
</I>&gt;<i>   <A HREF="http://www.modpython.org/pipermail/mod_python/2005-March/017651.html">http://www.modpython.org/pipermail/mod_python/2005-March/017651.html</A>
</I>&gt;<i> 
</I>&gt;<i> Thus that sort of thing is definitely possible.
</I>
I've made a basic FileSession class. Please look at this numbers (I did 
the test 10 times each and averaged:

With a clean mp_sess dbm db:

   ab -n 100 <A HREF="http://localhost/sessions_dbm.py">http://localhost/sessions_dbm.py</A>
   Requests per second:    83.03 [#/sec] (mean)



With an mp_sess dbm db with 1500 sessions:

   ab -n 100 <A HREF="http://localhost/sessions_dbm.py">http://localhost/sessions_dbm.py</A>
   Requests per second:    6.05 [#/sec] (mean)



Same tests with the single but working FileSession implementation show this:

No files in tmp dir:
   ab -n 100 <A HREF="http://localhost/sessions_file.py">http://localhost/sessions_file.py</A>
   Requests per second:    189.14 [#/sec] (mean)

With 1500 files in tmp dir:
   ab -n 100 <A HREF="http://localhost/sessions_file.py">http://localhost/sessions_file.py</A>
   Requests per second:    166.67 [#/sec] (mean)


Before each test I did the following:

- apachectl restart
- ran a preliminar ab -n 500 so modules get loaded and cached
- erase the session files without restarting apache
- ran each test

&gt;<i> 
</I>&gt;<i> My only other comment is to ask that you made sure you weren't testing
</I>&gt;<i> immediately after an Apache restart and before any other requests had
</I>&gt;<i> come in, but after already having done some requests. I ask this because
</I>&gt;<i> there will be some initial startup costs for loading of modules etc,
</I>&gt;<i> although how much depends on your code a bit. Thus, you should try to
</I>&gt;<i> make sure you factor out such possibilities.
</I>&gt;<i> 
</I>
If you want I can send my modified Session.py with the new FileSession 
class for review. The only thing left is the possibility of specifying 
hash dirs to store the files to improve scalability over very busy sites.

-- 
Juan Alonso
<A HREF="http://gamersmafia.com">http://gamersmafia.com</A> | <A HREF="http://laflecha.net">http://laflecha.net</A>

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017829.html">[mod_python] Sessions performance and some numbers
</A></li>
	<LI>Next message: <A HREF="017836.html">[mod_python] Sessions performance and some numbers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17835">[ date ]</a>
              <a href="thread.html#17835">[ thread ]</a>
              <a href="subject.html#17835">[ subject ]</a>
              <a href="author.html#17835">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
