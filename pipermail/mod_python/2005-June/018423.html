<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Threading and apache.import_module
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Threading%20and%20apache.import_module&In-Reply-To=1119220444.6882%40dscpl.user.openhosting.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018421.html">
   <LINK REL="Next"  HREF="018424.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Threading and apache.import_module</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>michael bayer</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Threading%20and%20apache.import_module&In-Reply-To=1119220444.6882%40dscpl.user.openhosting.com"
       TITLE="[mod_python] Threading and apache.import_module">mike_mp at zzzcomputing.com
       </A><BR>
    <I>Sun Jun 19 22:14:21 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="018421.html">[mod_python] Threading and apache.import_module
</A></li>
        <LI>Next message: <A HREF="018424.html">[mod_python] Threading and apache.import_module
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18423">[ date ]</a>
              <a href="thread.html#18423">[ thread ]</a>
              <a href="subject.html#18423">[ subject ]</a>
              <a href="author.html#18423">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Jun 19, 2005, at 6:34 PM, Graham Dumpleton wrote:

&gt;<i> I would advise against trying to accomodate &quot;.pyc&quot; files. If you  
</I>&gt;<i> were to
</I>&gt;<i> do this you will in practice have to monitor the timestamps on both  
</I>&gt;<i> the
</I>&gt;<i> &quot;.py&quot; and &quot;.pyc&quot; files and contend with issues such as what to do when
</I>&gt;<i> the &quot;.pyc&quot; file is removed but the &quot;.py&quot; still exists but you were  
</I>&gt;<i> originally
</I>&gt;<i> loaded from the &quot;.pyc&quot; file. Similarly, what do you do if you are  
</I>&gt;<i> loaded
</I>&gt;<i> from the &quot;.pyc&quot; file and the &quot;.py&quot; file is removed. Does this imply  
</I>&gt;<i> that
</I>&gt;<i> the user is intending the page to now no longer be available. Another
</I>&gt;<i> cases is what do you do if you are loaded from the &quot;.pyc&quot; file and the
</I>&gt;<i> &quot;.py&quot; file modification time is changed to be older than what it  
</I>&gt;<i> was before.
</I>&gt;<i> Do you take this as meaning that an older file has been restored and
</I>&gt;<i> that should be used instead. As you can see you have to make various
</I>&gt;<i> assumptions and in some respects hope for the best. Although it can
</I>&gt;<i> be made to work in a reasonably sensible way, I found it complicates
</I>&gt;<i> the code unnecessarily and not worth the trouble, especially when
</I>&gt;<i> Apache generally runs as a user where &quot;.pyc&quot; files can't be created in
</I>&gt;<i> the first place.
</I>
ah well, I can definitely make assumptions as I'm talking  
specifically about modules loaded for Myghty, and the primary &quot;.py&quot;  
modules I am loading were generated from template files, so its  
already a given that there is a &quot;data directory&quot; configured where the  
Apache process can write .py files, and theres no problem assuming  
that a .py file must exist for each .pyc file else it gets recreated  
by the template, and they arent really part of a &quot;package&quot;.    For a  
large set of several hundred or thousands of templates, which are  
released from memory on a least-recently-used scheme, a lot of them  
will be falling out of memory and getting re-loaded back in again  
repeatedly;  the .pyc factor has a sizeable impact on how much work  
the server has to do, particularly upon startup or creation of new  
child processes, and also within setups that are sensitive to  
&quot;thrashing&quot;.

I also have support for plain .py modules with callable functions/ 
objects in the spirit of Vampire/Publisher, but similarly they are  
just the end-points to handling a request...they arent really meant  
to be imported by other modules and I only seek to support basic  
reloading functionality for them;  if you change the back-end to code  
you would still have to restart the server.  Generally I would base  
module loading/reloading upon the existence/timestamp of the .py  
file, and then look for the .pyc file existence/timestamp as a second  
step, the way imp.load_source does (which is what Im using now).


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20050619/ebf87abd/attachment-0001.html">http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20050619/ebf87abd/attachment-0001.html</A>
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018421.html">[mod_python] Threading and apache.import_module
</A></li>
	<LI>Next message: <A HREF="018424.html">[mod_python] Threading and apache.import_module
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18423">[ date ]</a>
              <a href="thread.html#18423">[ thread ]</a>
              <a href="subject.html#18423">[ subject ]</a>
              <a href="author.html#18423">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
