<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Oops, found a small bug in the session code
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Oops%2C%20found%20a%20small%20bug%20in%20the%20session%20code&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018381.html">
   <LINK REL="Next"  HREF="018388.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Oops, found a small bug in the session code</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Oops%2C%20found%20a%20small%20bug%20in%20the%20session%20code&In-Reply-To="
       TITLE="[mod_python] Oops, found a small bug in the session code">grahamd at dscpl.com.au
       </A><BR>
    <I>Wed Jun 15 19:42:38 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="018381.html">[mod_python] Question about Session security
</A></li>
        <LI>Next message: <A HREF="018388.html">[mod_python] Oops, found a small bug in the session code
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18383">[ date ]</a>
              <a href="thread.html#18383">[ thread ]</a>
              <a href="subject.html#18383">[ subject ]</a>
              <a href="author.html#18383">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Dan Eloff wrote ..
&gt;<i> Just discovered this.
</I>&gt;<i> 
</I>&gt;<i> # XXX Not sure why, but on Win32 hlist.directory
</I>&gt;<i> # may contain a trailing \ - need to investigate,
</I>&gt;<i> # this value is given to us directly by httpd
</I>&gt;<i> if os.name == 'nt' and c.path[-1] == '\\':
</I>&gt;<i>     c.path = c.path[:-1]
</I>
The underlying problem is a known issue. The hack in the session
code was presumably put there because someone didn't understand
the root cause. Anyway, the underlying problem has already been
fixed for 3.2 and the hack in Session code removed.

&gt;<i> # Sometimes there is no path, e.g. when Location
</I>&gt;<i> # is used. When Alias or UserDir are used, then
</I>&gt;<i> # the path wouldn't match the URI. In those cases
</I>&gt;<i> # just default to '/'
</I>&gt;<i> if not c.path or not self._req.uri.startswith(c.path):
</I>&gt;<i>     c.path = '/'
</I>&gt;<i> 
</I>&gt;<i> In the first if statement, c.path[-1] will throw IndexError if c.path
</I>&gt;<i> is empty (which is possible if you read the next comment). You should
</I>&gt;<i> change it to:
</I>&gt;<i> 
</I>&gt;<i> if os.name == 'nt' and (c.path and c.path[-1] == '\\'):
</I>&gt;<i>     c.path = c.path[:-1]
</I>
Also a known issue which I believe has been fixed for 3.2. You can
avoid the problem for now by setting ApplicationPath directive to
some value.

In general, would not recommend enabling of mod_python within a
Location directive as could cause other things to fail that expect to
be able to determine the physical directory context in which they are
being used. In other words use Directory directive instead.

Thanks for highlighting the issues as sometimes we might not know
about such things. For reference, various bugs and there status are
cataloged at:

  <A HREF="http://issues.apache.org/jira/browse/MODPYTHON?report=select">http://issues.apache.org/jira/browse/MODPYTHON?report=select</A>

Graham
</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018381.html">[mod_python] Question about Session security
</A></li>
	<LI>Next message: <A HREF="018388.html">[mod_python] Oops, found a small bug in the session code
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18383">[ date ]</a>
              <a href="thread.html#18383">[ thread ]</a>
              <a href="subject.html#18383">[ subject ]</a>
              <a href="author.html#18383">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
