<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] mod_python and threading.Thread doesn't start
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20mod_python%20and%20threading.Thread%20doesn%27t%20start&In-Reply-To=d9c459bb0506060414e52ef2%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018285.html">
   <LINK REL="Next"  HREF="018287.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] mod_python and threading.Thread doesn't start</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20mod_python%20and%20threading.Thread%20doesn%27t%20start&In-Reply-To=d9c459bb0506060414e52ef2%40mail.gmail.com"
       TITLE="[mod_python] mod_python and threading.Thread doesn't start">grahamd at dscpl.com.au
       </A><BR>
    <I>Mon Jun  6 07:24:55 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="018285.html">[mod_python] mod_python and threading.Thread doesn't start
</A></li>
        <LI>Next message: <A HREF="018287.html">[mod_python] mod_python and threading.Thread doesn't start
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18286">[ date ]</a>
              <a href="thread.html#18286">[ thread ]</a>
              <a href="subject.html#18286">[ subject ]</a>
              <a href="author.html#18286">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I have been developing an idea of what is wrong. Can you now try this 
slightly
different variation on the code and post back the result. Am interested 
in the
id of &quot;__builtins__&quot; and whether it is the same as 
&quot;__builtin__.__dict__&quot;. On
my system they are actually the same object. Note this problem was 
possibly
only introduced with 2.3.5 and 2.4.

import threading
import time
from mod_python import apache

import __builtin__

def openfiletest(req):
     req.write(&quot; builtins=%d &quot;%id(__builtins__))
     req.write(&quot; builtin=%d &quot;%id(__builtin__.__dict__))
     try:
         a = file(&quot;/tmp/test&quot;, &quot;w&quot;)
         req.write(&quot;file() was OK\n&quot;)
     except Exception, e:
         req.write(&quot;file() threw exception: &quot; + str(e) + &quot;\n&quot;)

def handler(req):
     req.write(&quot;In main thread: &quot;)
     openfiletest(req)
     req.write(&quot;In child thread: &quot;)
     t = threading.Thread(target=openfiletest, args=(req,) )
     t.start()
     time.sleep(1)
     return apache.OK

On 06/06/2005, at 9:14 PM, Alexey Melchakov wrote:

&gt;<i>
</I>&gt;<i> You were right, it's all about restricted mode. Is there any solvation 
</I>&gt;<i> for this problem?
</I>&gt;<i>
</I>&gt;<i> Output:
</I>&gt;<i>
</I>&gt;<i> In main thread: file() was OK
</I>&gt;<i> In child thread: file() threw exception: file() constructor not 
</I>&gt;<i> accessible in restricted mode
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On 6/6/05, Graham Dumpleton &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">grahamd at dscpl.com.au</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;<i> On 06/06/2005, at 5:39 PM, Alexey Melchakov wrote:
</I>&gt;<i>
</I>&gt;<i> Try the following code instead so that you can see if a Python
</I>&gt;<i> exception is
</I>&gt;<i> being raised within the thread. One possibility is that you might be
</I>&gt;<i> running
</I>&gt;<i> up against a strange problem seen by a few people which hasn't really
</I>&gt;<i> been
</I>&gt;<i> worked out yet. One previous post where someone had this problem was:
</I>&gt;<i>
</I>&gt;<i> &#160;&#160; 
</I>&gt;<i> <A HREF="http://www.modpython.org/pipermail/mod_python/2005-January/017129.html">http://www.modpython.org/pipermail/mod_python/2005-January/017129.html</A>
</I>&gt;<i>
</I>&gt;<i> for more details.
</I>&gt;<i>
</I>&gt;<i> Anyway, let us know what the following produces.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> import threading
</I>&gt;<i> import time
</I>&gt;<i> from mod_python import apache
</I>&gt;<i>
</I>&gt;<i> def openfiletest(req):
</I>&gt;<i> &#160;&#160;&#160;&#160; try:
</I>&gt;<i> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; a = file(&quot;/tmp/test&quot;, &quot;w&quot;)
</I>&gt;<i> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; req.write(&quot;file() was OK\n&quot;)
</I>&gt;<i> &#160;&#160;&#160;&#160; except Exception, e:
</I>&gt;<i> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; req.write(&quot;file() threw exception: &quot; + str(e) + &quot;\n&quot;)
</I>&gt;<i>
</I>&gt;<i> def handler(req):
</I>&gt;<i> &#160;&#160;&#160;&#160; req.write(&quot;In main thread: &quot;)
</I>&gt;<i> &#160;&#160;&#160;&#160; openfiletest(req)
</I>&gt;<i> &#160;&#160;&#160;&#160; req.write(&quot;In child thread: &quot;)
</I>&gt;<i> &#160;&#160;&#160;&#160; t = threading.Thread(target=openfiletest, args=(req,) )
</I>&gt;<i> &#160;&#160;&#160;&#160; t.start()
</I>&gt;<i> &#160;&#160;&#160;&#160; time.sleep(1)
</I>&gt;<i> &#160;&#160;&#160;&#160; return apache.OK
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -- 
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">melchakov at gmail.com</A>
</I>&gt;<i> CRV-RIPN
</I>
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018285.html">[mod_python] mod_python and threading.Thread doesn't start
</A></li>
	<LI>Next message: <A HREF="018287.html">[mod_python] mod_python and threading.Thread doesn't start
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18286">[ date ]</a>
              <a href="thread.html#18286">[ thread ]</a>
              <a href="subject.html#18286">[ subject ]</a>
              <a href="author.html#18286">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
