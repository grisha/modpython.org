<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Threading and apache.import_module
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Threading%20and%20apache.import_module&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018422.html">
   <LINK REL="Next"  HREF="018426.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Threading and apache.import_module</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Threading%20and%20apache.import_module&In-Reply-To="
       TITLE="[mod_python] Threading and apache.import_module">grahamd at dscpl.com.au
       </A><BR>
    <I>Mon Jun 20 02:25:03 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="018422.html">[mod_python] Threading and apache.import_module
</A></li>
        <LI>Next message: <A HREF="018426.html">[mod_python] req.sendfile() questions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18425">[ date ]</a>
              <a href="thread.html#18425">[ thread ]</a>
              <a href="subject.html#18425">[ subject ]</a>
              <a href="author.html#18425">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Nicolas Lehuen wrote ..
&gt;<i> Regarding the naming of the package, don't give a module the same name
</I>&gt;<i> as its filename, that is to say with slashes and dots. It seems that
</I>&gt;<i> this breaks some behaviour of the Python import system, that is to say
</I>&gt;<i> that some imports that are performed in the dynamically loaded module
</I>&gt;<i> misteriously fail. I use a re.sub(r'\W+','_',filename) and everything
</I>&gt;<i> is OK. That being said, I didn't know about name length restrictions
</I>&gt;<i> so I have to correct my code to cope with this issue.
</I>
The length restriction is that the name of the module can not be longer than
MAXPATHLEN. Thus, as long as you don't excessively increase the length
of the name when doing substitutions such that that is exceeded, you
should be okay.

BTW, using the simple substitution you have, I think one could probably
construct two pathnames which when substituted would result in the
same thing. I currently use:

    stub = os.path.splitext(file)[0]
    label = md5.new(stub).hexdigest()
    label = self._prefix + label
    label = label + &quot;_&quot; + str(len(stub))

For the length of data we are talking about, I doubt that md5 collisions
are going to occur. I append the length to stir things up a little bit more
but probably don't even need that and MD5 hexdigest is probably good
enough.

Graham
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018422.html">[mod_python] Threading and apache.import_module
</A></li>
	<LI>Next message: <A HREF="018426.html">[mod_python] req.sendfile() questions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18425">[ date ]</a>
              <a href="thread.html#18425">[ thread ]</a>
              <a href="subject.html#18425">[ subject ]</a>
              <a href="author.html#18425">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
