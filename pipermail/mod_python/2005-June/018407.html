<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Threading and apache.import_module
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Threading%20and%20apache.import_module&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018454.html">
   <LINK REL="Next"  HREF="018409.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Threading and apache.import_module</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Dan Eloff</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Threading%20and%20apache.import_module&In-Reply-To="
       TITLE="[mod_python] Threading and apache.import_module">dan.eloff at gmail.com
       </A><BR>
    <I>Fri Jun 17 15:09:43 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="018454.html">[mod_python] Problem with mod_python and ZConfig
</A></li>
        <LI>Next message: <A HREF="018409.html">[mod_python] Threading and apache.import_module
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18407">[ date ]</a>
              <a href="thread.html#18407">[ thread ]</a>
              <a href="subject.html#18407">[ subject ]</a>
              <a href="author.html#18407">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Well this is the biggest problem in my otherwise threadsafe code. From
what I've read, importing/reloading modules in a threaded environment
is just plain dangerous. There could be any number of requests
executing code from and accessing global variables in a module when it
changes and gets reloaded. Then you have the two level problem of what
happens to the executing requests, as well as what happens when
multiple incoming requests all spot that the module has changed, and
reload it multiple times in quick succession, re-executing code in the
module scope (this is pretty much worst case)

I know Graham knows a lot more about this than I do (help!).

I do have a lot of flexibility here, since I'm using my own publisher
I do not have to use apache.import_module. In fact I would prefer to
not have the whole importing/reloading business affect my code outside
of the publisher, that way I can change things internally at will.
Clearly one option is to create a simple import function that imports
once only in a production environment, and every time in a development
env, but I'm still interested in exploring the options.

-Dan

</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018454.html">[mod_python] Problem with mod_python and ZConfig
</A></li>
	<LI>Next message: <A HREF="018409.html">[mod_python] Threading and apache.import_module
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18407">[ date ]</a>
              <a href="thread.html#18407">[ thread ]</a>
              <a href="subject.html#18407">[ subject ]</a>
              <a href="author.html#18407">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
