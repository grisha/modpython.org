From rahul.warhekar at edisphere.com  Fri Feb  6 01:58:44 2009
From: rahul.warhekar at edisphere.com (rahul)
Date: Fri Feb  6 02:01:02 2009
Subject: [mod_python] query regarding pyodbc
In-Reply-To: <88e286470901160253h9f2f52et62498b7489fa2eb0@mail.gmail.com>
Message-ID: <20090206070056.F2DD36A45AD@server1.edisphere.com>

Hello sir,

Now import pyodbc is working from python console but when I import it from
.psp pages it is giving error as 
ImportError : dynamic module does not define init function (initpyodbc)

I check  using nm pyodbc.so command it is giving initpyodbc function in the
list

Now what may be the problem?

Regards
Rahul

-----Original Message-----
From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com] 
Sent: Friday, January 16, 2009 4:24 PM
To: rahul
Cc: mod_python@modpython.org
Subject: Re: [mod_python] query regarding pyodbc

2009/1/16 rahul <rahul.warhekar@edisphere.com>:
> I have run it from python console and it is giving same error.

Then it is not a mod_python issue and you perhaps should ask on:

  http://groups.google.com/group/comp.lang.python/topics?lnk

> Now, I used nm command for pyodbc.so file and got the following output.
>
> [root@dbserver site-packages]# nm pyodbc.so
> 00001600 A __bss_start
> 000003ec t call_gmon_start
> 00001600 b completed.1
> 000014fc d __CTOR_END__
> 000014f8 d __CTOR_LIST__
>         w __cxa_finalize@@GLIBC_2.1.3
> 000004a8 t __do_global_ctors_aux
> 00000410 t __do_global_dtors_aux
> 000015f8 d __dso_handle
> 00001504 d __DTOR_END__
> 00001500 d __DTOR_LIST__
> 0000150c A _DYNAMIC
> 00001600 A _edata
> 00001604 A _end
> 000004d8 T _fini
> 0000046c t frame_dummy
> 000004f4 r __FRAME_END__
> 000015e8 A _GLOBAL_OFFSET_TABLE_
>         w __gmon_start__
> 000003b4 T _init
> 00001508 d __JCR_END__
> 00001508 d __JCR_LIST__
>         w _Jv_RegisterClasses
> 000015fc d p.0
>
> Still I am not understanding what is the problem, please help.

Like the message says, it cannot find in the C extension module the
symbol 'initpyodbc', which is the entry point function for
initialising the module.

Thus the module has not been built properly or is broken in some way.

Graham

> Thanks,
> Rahul
>
> -----Original Message-----
> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
> Sent: Friday, January 16, 2009 2:55 PM
> To: rahul
> Cc: mod_python@modpython.org
> Subject: Re: [mod_python] query regarding pyodbc
>
> 2009/1/16 rahul <rahul.warhekar@edisphere.com>:
>> Hello all,
>>
>>
>>
>> I am using RedHat Enterprise 4 linux on which I have python 2.5.4 and
>> mod_python 3.3.1 .
>>
>> Now when I install pyodbc package and I try to import it it is giving me
> an
>> error as
>>
>> ImportError : dynamic module does not define init function (initpyodbc)
>>
>>
>>
>> My pyodbc version is 2.1.14
>>
>> Any help regarding this will be greatly appreciated.
>
> Does it work when you try and import it from command line Python?
>
> Have you run 'nm' command on the .so file for the Python C extension
> module to see whether that function (initpyodbc) exists in the file?
>
> Graham
>
>

From graham.dumpleton at gmail.com  Fri Feb  6 02:30:48 2009
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Fri Feb  6 02:30:52 2009
Subject: [mod_python] query regarding pyodbc
In-Reply-To: <20090206070056.F2DD36A45AD@server1.edisphere.com>
References: <88e286470901160253h9f2f52et62498b7489fa2eb0@mail.gmail.com>
	<20090206070056.F2DD36A45AD@server1.edisphere.com>
Message-ID: <88e286470902052330v23a5bea3oc530b2fe03711328@mail.gmail.com>

2009/2/6 rahul <rahul.warhekar@edisphere.com>:
> Hello sir,
>
> Now import pyodbc is working from python console but when I import it from
> .psp pages it is giving error as
> ImportError : dynamic module does not define init function (initpyodbc)
>
> I check  using nm pyodbc.so command it is giving initpyodbc function in the
> list
>
> Now what may be the problem?

It is likely picking up wrong version still. Where is pyodbc package
installed? Did you ensure that old broken versions were removed from
the system?

Graham

>
> -----Original Message-----
> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
> Sent: Friday, January 16, 2009 4:24 PM
> To: rahul
> Cc: mod_python@modpython.org
> Subject: Re: [mod_python] query regarding pyodbc
>
> 2009/1/16 rahul <rahul.warhekar@edisphere.com>:
>> I have run it from python console and it is giving same error.
>
> Then it is not a mod_python issue and you perhaps should ask on:
>
>  http://groups.google.com/group/comp.lang.python/topics?lnk
>
>> Now, I used nm command for pyodbc.so file and got the following output.
>>
>> [root@dbserver site-packages]# nm pyodbc.so
>> 00001600 A __bss_start
>> 000003ec t call_gmon_start
>> 00001600 b completed.1
>> 000014fc d __CTOR_END__
>> 000014f8 d __CTOR_LIST__
>>         w __cxa_finalize@@GLIBC_2.1.3
>> 000004a8 t __do_global_ctors_aux
>> 00000410 t __do_global_dtors_aux
>> 000015f8 d __dso_handle
>> 00001504 d __DTOR_END__
>> 00001500 d __DTOR_LIST__
>> 0000150c A _DYNAMIC
>> 00001600 A _edata
>> 00001604 A _end
>> 000004d8 T _fini
>> 0000046c t frame_dummy
>> 000004f4 r __FRAME_END__
>> 000015e8 A _GLOBAL_OFFSET_TABLE_
>>         w __gmon_start__
>> 000003b4 T _init
>> 00001508 d __JCR_END__
>> 00001508 d __JCR_LIST__
>>         w _Jv_RegisterClasses
>> 000015fc d p.0
>>
>> Still I am not understanding what is the problem, please help.
>
> Like the message says, it cannot find in the C extension module the
> symbol 'initpyodbc', which is the entry point function for
> initialising the module.
>
> Thus the module has not been built properly or is broken in some way.
>
> Graham
>
>> Thanks,
>> Rahul
>>
>> -----Original Message-----
>> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
>> Sent: Friday, January 16, 2009 2:55 PM
>> To: rahul
>> Cc: mod_python@modpython.org
>> Subject: Re: [mod_python] query regarding pyodbc
>>
>> 2009/1/16 rahul <rahul.warhekar@edisphere.com>:
>>> Hello all,
>>>
>>>
>>>
>>> I am using RedHat Enterprise 4 linux on which I have python 2.5.4 and
>>> mod_python 3.3.1 .
>>>
>>> Now when I install pyodbc package and I try to import it it is giving me
>> an
>>> error as
>>>
>>> ImportError : dynamic module does not define init function (initpyodbc)
>>>
>>>
>>>
>>> My pyodbc version is 2.1.14
>>>
>>> Any help regarding this will be greatly appreciated.
>>
>> Does it work when you try and import it from command line Python?
>>
>> Have you run 'nm' command on the .so file for the Python C extension
>> module to see whether that function (initpyodbc) exists in the file?
>>
>> Graham
>>
>>
>
>
From rahul.warhekar at edisphere.com  Fri Feb  6 04:09:12 2009
From: rahul.warhekar at edisphere.com (rahul)
Date: Fri Feb  6 04:11:29 2009
Subject: [mod_python] query regarding pyodbc
In-Reply-To: <88e286470902052330v23a5bea3oc530b2fe03711328@mail.gmail.com>
Message-ID: <20090206091124.D98D16A45AD@server1.edisphere.com>

Hello

 

Just Now, I got something as my .psp pages are pointing to my old version of
python2.3 which is also installed in my system.

 

For this I do export PYTHON=/usr/local/lib/python2.5

But it was not useful I still got problem 

The error is 

 

MOD_PYTHON ERROR

 

URI:            '/edi/redirect.psp'

Location:       None

Directory:      '/var/www/'

Filename:       '/var/www/edi/redirect.psp'

PathInfo:       ''

 

Phase:          'PythonHandler'

Handler:        'mod_python.psp'

 

Traceback (most recent call last):

 

  File "/usr/lib/python2.3/site-packages/mod_python/importer.py", line 1537,
in HandlerDispatch

    default=default_handler, arg=req, silent=hlist.silent)

 

  File "/usr/lib/python2.3/site-packages/mod_python/importer.py", line 1229,
in _process_target

    result = _execute_target(config, req, object, arg)

 

  File "/usr/lib/python2.3/site-packages/mod_python/importer.py", line 1128,
in _execute_target

    result = object(arg)

 

  File "/usr/lib/python2.3/site-packages/mod_python/psp.py", line 337, in
handler

    p.run()

 

  File "/usr/lib/python2.3/site-packages/mod_python/psp.py", line 243, in
run

    exec code in global_scope

 

  File "/var/www/redirect.psp", line 18, in ?

    import pyodbc

 

ImportError: dynamic module does not define init function (initpyodbc)

 

 

 

Is there any way to point to the newer version of python2.5

 

 

 

-----Original Message-----
From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com] 
Sent: Friday, February 06, 2009 1:01 PM
To: rahul
Cc: mod_python@modpython.org
Subject: Re: [mod_python] query regarding pyodbc

 

2009/2/6 rahul <rahul.warhekar@edisphere.com>:

> Hello sir,

> 

> Now import pyodbc is working from python console but when I import it from

> .psp pages it is giving error as

> ImportError : dynamic module does not define init function (initpyodbc)

> 

> I check  using nm pyodbc.so command it is giving initpyodbc function in
the

> list

> 

> Now what may be the problem?

 

It is likely picking up wrong version still. Where is pyodbc package

installed? Did you ensure that old broken versions were removed from

the system?

 

Graham

 

> 

> -----Original Message-----

> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]

> Sent: Friday, January 16, 2009 4:24 PM

> To: rahul

> Cc: mod_python@modpython.org

> Subject: Re: [mod_python] query regarding pyodbc

> 

> 2009/1/16 rahul <rahul.warhekar@edisphere.com>:

>> I have run it from python console and it is giving same error.

> 

> Then it is not a mod_python issue and you perhaps should ask on:

> 

>  http://groups.google.com/group/comp.lang.python/topics?lnk

> 

>> Now, I used nm command for pyodbc.so file and got the following output.

>> 

>> [root@dbserver site-packages]# nm pyodbc.so

>> 00001600 A __bss_start

>> 000003ec t call_gmon_start

>> 00001600 b completed.1

>> 000014fc d __CTOR_END__

>> 000014f8 d __CTOR_LIST__

>>         w __cxa_finalize@@GLIBC_2.1.3

>> 000004a8 t __do_global_ctors_aux

>> 00000410 t __do_global_dtors_aux

>> 000015f8 d __dso_handle

>> 00001504 d __DTOR_END__

>> 00001500 d __DTOR_LIST__

>> 0000150c A _DYNAMIC

>> 00001600 A _edata

>> 00001604 A _end

>> 000004d8 T _fini

>> 0000046c t frame_dummy

>> 000004f4 r __FRAME_END__

>> 000015e8 A _GLOBAL_OFFSET_TABLE_

>>         w __gmon_start__

>> 000003b4 T _init

>> 00001508 d __JCR_END__

>> 00001508 d __JCR_LIST__

>>         w _Jv_RegisterClasses

>> 000015fc d p.0

>> 

>> Still I am not understanding what is the problem, please help.

> 

> Like the message says, it cannot find in the C extension module the

> symbol 'initpyodbc', which is the entry point function for

> initialising the module.

> 

> Thus the module has not been built properly or is broken in some way.

> 

> Graham

> 

>> Thanks,

>> Rahul

>> 

>> -----Original Message-----

>> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]

>> Sent: Friday, January 16, 2009 2:55 PM

>> To: rahul

>> Cc: mod_python@modpython.org

>> Subject: Re: [mod_python] query regarding pyodbc

>> 

>> 2009/1/16 rahul <rahul.warhekar@edisphere.com>:

>>> Hello all,

>>> 

>>> 

>>> 

>>> I am using RedHat Enterprise 4 linux on which I have python 2.5.4 and

>>> mod_python 3.3.1 .

>>> 

>>> Now when I install pyodbc package and I try to import it it is giving me

>> an

>>> error as

>>> 

>>> ImportError : dynamic module does not define init function (initpyodbc)

>>> 

>>> 

>>> 

>>> My pyodbc version is 2.1.14

>>> 

>>> Any help regarding this will be greatly appreciated.

>> 

>> Does it work when you try and import it from command line Python?

>> 

>> Have you run 'nm' command on the .so file for the Python C extension

>> module to see whether that function (initpyodbc) exists in the file?

>> 

>> Graham

>> 

>> 

> 

> 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20090206/2ffc079e/attachment-0001.html
From rahul.warhekar at edisphere.com  Fri Feb  6 05:55:50 2009
From: rahul.warhekar at edisphere.com (rahul)
Date: Fri Feb  6 05:58:08 2009
Subject: [mod_python] query regarding pyodbc
In-Reply-To: <20090206091124.D98D16A45AD@server1.edisphere.com>
Message-ID: <20090206105803.61C196A45BF@server1.edisphere.com>

 

 

Hello

 

Just Now, I got something as my .psp pages are pointing to my old version of
python2.3 which is also installed in my system.

 

For this I do export PYTHON=/usr/local/lib/python2.5

But it was not useful I still got problem 

The error is 

 

MOD_PYTHON ERROR

 

URI:            '/edi/redirect.psp'

Location:       None

Directory:      '/var/www/'

Filename:       '/var/www/edi/redirect.psp'

PathInfo:       ''

 

Phase:          'PythonHandler'

Handler:        'mod_python.psp'

 

Traceback (most recent call last):

 

  File "/usr/lib/python2.3/site-packages/mod_python/importer.py", line 1537,
in HandlerDispatch

    default=default_handler, arg=req, silent=hlist.silent)

 

  File "/usr/lib/python2.3/site-packages/mod_python/importer.py", line 1229,
in _process_target

    result = _execute_target(config, req, object, arg)

 

  File "/usr/lib/python2.3/site-packages/mod_python/importer.py", line 1128,
in _execute_target

    result = object(arg)

 

  File "/usr/lib/python2.3/site-packages/mod_python/psp.py", line 337, in
handler

    p.run()

 

  File "/usr/lib/python2.3/site-packages/mod_python/psp.py", line 243, in
run

    exec code in global_scope

 

  File "/var/www/redirect.psp", line 18, in ?

    import pyodbc

 

ImportError: dynamic module does not define init function (initpyodbc)

 

 

 

Is there any way to point to the newer version of python2.5

 

 

 

-----Original Message-----
From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com] 
Sent: Friday, February 06, 2009 1:01 PM
To: rahul
Cc: mod_python@modpython.org
Subject: Re: [mod_python] query regarding pyodbc

 

2009/2/6 rahul <rahul.warhekar@edisphere.com>:

> Hello sir,

> 

> Now import pyodbc is working from python console but when I import it from

> .psp pages it is giving error as

> ImportError : dynamic module does not define init function (initpyodbc)

> 

> I check  using nm pyodbc.so command it is giving initpyodbc function in
the

> list

> 

> Now what may be the problem?

 

It is likely picking up wrong version still. Where is pyodbc package

installed? Did you ensure that old broken versions were removed from

the system?

 

Graham

 

> 

> -----Original Message-----

> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]

> Sent: Friday, January 16, 2009 4:24 PM

> To: rahul

> Cc: mod_python@modpython.org

> Subject: Re: [mod_python] query regarding pyodbc

> 

> 2009/1/16 rahul <rahul.warhekar@edisphere.com>:

>> I have run it from python console and it is giving same error.

> 

> Then it is not a mod_python issue and you perhaps should ask on:

> 

>  http://groups.google.com/group/comp.lang.python/topics?lnk

> 

>> Now, I used nm command for pyodbc.so file and got the following output.

>> 

>> [root@dbserver site-packages]# nm pyodbc.so

>> 00001600 A __bss_start

>> 000003ec t call_gmon_start

>> 00001600 b completed.1

>> 000014fc d __CTOR_END__

>> 000014f8 d __CTOR_LIST__

>>         w __cxa_finalize@@GLIBC_2.1.3

>> 000004a8 t __do_global_ctors_aux

>> 00000410 t __do_global_dtors_aux

>> 000015f8 d __dso_handle

>> 00001504 d __DTOR_END__

>> 00001500 d __DTOR_LIST__

>> 0000150c A _DYNAMIC

>> 00001600 A _edata

>> 00001604 A _end

>> 000004d8 T _fini

>> 0000046c t frame_dummy

>> 000004f4 r __FRAME_END__

>> 000015e8 A _GLOBAL_OFFSET_TABLE_

>>         w __gmon_start__

>> 000003b4 T _init

>> 00001508 d __JCR_END__

>> 00001508 d __JCR_LIST__

>>         w _Jv_RegisterClasses

>> 000015fc d p.0

>> 

>> Still I am not understanding what is the problem, please help.

> 

> Like the message says, it cannot find in the C extension module the

> symbol 'initpyodbc', which is the entry point function for

> initialising the module.

> 

> Thus the module has not been built properly or is broken in some way.

> 

> Graham

> 

>> Thanks,

>> Rahul

>> 

>> -----Original Message-----

>> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]

>> Sent: Friday, January 16, 2009 2:55 PM

>> To: rahul

>> Cc: mod_python@modpython.org

>> Subject: Re: [mod_python] query regarding pyodbc

>> 

>> 2009/1/16 rahul <rahul.warhekar@edisphere.com>:

>>> Hello all,

>>> 

>>> 

>>> 

>>> I am using RedHat Enterprise 4 linux on which I have python 2.5.4 and

>>> mod_python 3.3.1 .

>>> 

>>> Now when I install pyodbc package and I try to import it it is giving me

>> an

>>> error as

>>> 

>>> ImportError : dynamic module does not define init function (initpyodbc)

>>> 

>>> 

>>> 

>>> My pyodbc version is 2.1.14

>>> 

>>> Any help regarding this will be greatly appreciated.

>> 

>> Does it work when you try and import it from command line Python?

>> 

>> Have you run 'nm' command on the .so file for the Python C extension

>> module to see whether that function (initpyodbc) exists in the file?

>> 

>> Graham

>> 

>> 

> 

> 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20090206/9e04d1bc/attachment-0001.html
From graham.dumpleton at gmail.com  Fri Feb  6 08:47:05 2009
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Fri Feb  6 08:47:08 2009
Subject: [mod_python] query regarding pyodbc
In-Reply-To: <20090206091124.D98D16A45AD@server1.edisphere.com>
References: <88e286470902052330v23a5bea3oc530b2fe03711328@mail.gmail.com>
	<20090206091124.D98D16A45AD@server1.edisphere.com>
Message-ID: <88e286470902060547t65fa5878hb2611fd4538f3bc@mail.gmail.com>

Recompile mod_python so it uses the correct installation of Python.
You cannot change it dynamically at run time. Use the '--with-python'
option to mod_python configure command. The argument to it should be
the path to 'python' executable for installation you want to use.

Graham

2009/2/6 rahul <rahul.warhekar@edisphere.com>:
> Hello
>
>
>
> Just Now, I got something as my .psp pages are pointing to my old version of
> python2.3 which is also installed in my system.
>
>
>
> For this I do export PYTHON=/usr/local/lib/python2.5
>
> But it was not useful I still got problem
>
> The error is
>
>
>
> MOD_PYTHON ERROR
>
>
>
> URI:            '/edi/redirect.psp'
>
> Location:       None
>
> Directory:      '/var/www/'
>
> Filename:       '/var/www/edi/redirect.psp'
>
> PathInfo:       ''
>
>
>
> Phase:          'PythonHandler'
>
> Handler:        'mod_python.psp'
>
>
>
> Traceback (most recent call last):
>
>
>
>   File "/usr/lib/python2.3/site-packages/mod_python/importer.py", line 1537,
> in HandlerDispatch
>
>     default=default_handler, arg=req, silent=hlist.silent)
>
>
>
>   File "/usr/lib/python2.3/site-packages/mod_python/importer.py", line 1229,
> in _process_target
>
>     result = _execute_target(config, req, object, arg)
>
>
>
>   File "/usr/lib/python2.3/site-packages/mod_python/importer.py", line 1128,
> in _execute_target
>
>     result = object(arg)
>
>
>
>   File "/usr/lib/python2.3/site-packages/mod_python/psp.py", line 337, in
> handler
>
>     p.run()
>
>
>
>   File "/usr/lib/python2.3/site-packages/mod_python/psp.py", line 243, in
> run
>
>     exec code in global_scope
>
>
>
>   File "/var/www/redirect.psp", line 18, in ?
>
>     import pyodbc
>
>
>
> ImportError: dynamic module does not define init function (initpyodbc)
>
>
>
>
>
>
>
> Is there any way to point to the newer version of python2.5
>
>
>
>
>
>
>
> -----Original Message-----
> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
> Sent: Friday, February 06, 2009 1:01 PM
> To: rahul
> Cc: mod_python@modpython.org
> Subject: Re: [mod_python] query regarding pyodbc
>
>
>
> 2009/2/6 rahul <rahul.warhekar@edisphere.com>:
>
>> Hello sir,
>
>>
>
>> Now import pyodbc is working from python console but when I import it from
>
>> .psp pages it is giving error as
>
>> ImportError : dynamic module does not define init function (initpyodbc)
>
>>
>
>> I check  using nm pyodbc.so command it is giving initpyodbc function in
>> the
>
>> list
>
>>
>
>> Now what may be the problem?
>
>
>
> It is likely picking up wrong version still. Where is pyodbc package
>
> installed? Did you ensure that old broken versions were removed from
>
> the system?
>
>
>
> Graham
>
>
>
>>
>
>> -----Original Message-----
>
>> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
>
>> Sent: Friday, January 16, 2009 4:24 PM
>
>> To: rahul
>
>> Cc: mod_python@modpython.org
>
>> Subject: Re: [mod_python] query regarding pyodbc
>
>>
>
>> 2009/1/16 rahul <rahul.warhekar@edisphere.com>:
>
>>> I have run it from python console and it is giving same error.
>
>>
>
>> Then it is not a mod_python issue and you perhaps should ask on:
>
>>
>
>>  http://groups.google.com/group/comp.lang.python/topics?lnk
>
>>
>
>>> Now, I used nm command for pyodbc.so file and got the following output.
>
>>>
>
>>> [root@dbserver site-packages]# nm pyodbc.so
>
>>> 00001600 A __bss_start
>
>>> 000003ec t call_gmon_start
>
>>> 00001600 b completed.1
>
>>> 000014fc d __CTOR_END__
>
>>> 000014f8 d __CTOR_LIST__
>
>>>         w __cxa_finalize@@GLIBC_2.1.3
>
>>> 000004a8 t __do_global_ctors_aux
>
>>> 00000410 t __do_global_dtors_aux
>
>>> 000015f8 d __dso_handle
>
>>> 00001504 d __DTOR_END__
>
>>> 00001500 d __DTOR_LIST__
>
>>> 0000150c A _DYNAMIC
>
>>> 00001600 A _edata
>
>>> 00001604 A _end
>
>>> 000004d8 T _fini
>
>>> 0000046c t frame_dummy
>
>>> 000004f4 r __FRAME_END__
>
>>> 000015e8 A _GLOBAL_OFFSET_TABLE_
>
>>>         w __gmon_start__
>
>>> 000003b4 T _init
>
>>> 00001508 d __JCR_END__
>
>>> 00001508 d __JCR_LIST__
>
>>>         w _Jv_RegisterClasses
>
>>> 000015fc d p.0
>
>>>
>
>>> Still I am not understanding what is the problem, please help.
>
>>
>
>> Like the message says, it cannot find in the C extension module the
>
>> symbol 'initpyodbc', which is the entry point function for
>
>> initialising the module.
>
>>
>
>> Thus the module has not been built properly or is broken in some way.
>
>>
>
>> Graham
>
>>
>
>>> Thanks,
>
>>> Rahul
>
>>>
>
>>> -----Original Message-----
>
>>> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
>
>>> Sent: Friday, January 16, 2009 2:55 PM
>
>>> To: rahul
>
>>> Cc: mod_python@modpython.org
>
>>> Subject: Re: [mod_python] query regarding pyodbc
>
>>>
>
>>> 2009/1/16 rahul <rahul.warhekar@edisphere.com>:
>
>>>> Hello all,
>
>>>>
>
>>>>
>
>>>>
>
>>>> I am using RedHat Enterprise 4 linux on which I have python 2.5.4 and
>
>>>> mod_python 3.3.1 .
>
>>>>
>
>>>> Now when I install pyodbc package and I try to import it it is giving me
>
>>> an
>
>>>> error as
>
>>>>
>
>>>> ImportError : dynamic module does not define init function (initpyodbc)
>
>>>>
>
>>>>
>
>>>>
>
>>>> My pyodbc version is 2.1.14
>
>>>>
>
>>>> Any help regarding this will be greatly appreciated.
>
>>>
>
>>> Does it work when you try and import it from command line Python?
>
>>>
>
>>> Have you run 'nm' command on the .so file for the Python C extension
>
>>> module to see whether that function (initpyodbc) exists in the file?
>
>>>
>
>>> Graham
>
>>>
>
>>>
>
>>
>
>>
From rogerdpack at gmail.com  Fri Feb  6 14:57:12 2009
From: rogerdpack at gmail.com (Roger Pack)
Date: Fri Feb  6 14:57:19 2009
Subject: [mod_python] question
Message-ID: <e880bd570902061157j6e7bff3awb76157e12942534@mail.gmail.com>

Sorry if this is about an old post.
Has this problem
http://bugs.gentoo.org/show_bug.cgi?id=230211
been resolved?
Thanks!
-=r
From graham.dumpleton at gmail.com  Sat Feb  7 04:27:36 2009
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sat Feb  7 04:27:41 2009
Subject: [mod_python] question
In-Reply-To: <e880bd570902061157j6e7bff3awb76157e12942534@mail.gmail.com>
References: <e880bd570902061157j6e7bff3awb76157e12942534@mail.gmail.com>
Message-ID: <88e286470902070127u207b1f6foe5519f5c314751b6@mail.gmail.com>

2009/2/7 Roger Pack <rogerdpack@gmail.com>:
> Sorry if this is about an old post.
> Has this problem
> http://bugs.gentoo.org/show_bug.cgi?id=230211
> been resolved?

It is fixed in mod_python subversion trunk. Sorry, can't tell you what
the subversion URL is right now, but might be listed on mod_python
site somewhere.

BTW, if you aren't using mod_python specific APIs or handlers and only
wanting to host a WSGI capable application such as Django or Trac, you
should also look at mod_wsgi. It does not have this specific problem.

Graham
From charles.m.dietrich at gmail.com  Sat Feb  7 09:49:13 2009
From: charles.m.dietrich at gmail.com (Charles Dietrich)
Date: Sat Feb  7 09:49:18 2009
Subject: [mod_python] Attention list admin: archive link is wrong on mailing
	list page
Message-ID: <3e2bc8c0902070649v8ae9b4jf83e2f2b7c6dbe6b@mail.gmail.com>

On the page

http://mailman.modpython.org/mailman/listinfo/mod_python

The archive link links to

http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/

It should link to

http://mailman.modpython.org/pipermail/mod_python/

Please fix this, esp since it's not getting indexed by google I think.

Charles
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20090207/50300995/attachment.html
From graham.dumpleton at gmail.com  Sat Feb  7 18:53:07 2009
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sat Feb  7 18:53:13 2009
Subject: [mod_python] Attention list admin: archive link is wrong on 
	mailing list page
In-Reply-To: <3e2bc8c0902070649v8ae9b4jf83e2f2b7c6dbe6b@mail.gmail.com>
References: <3e2bc8c0902070649v8ae9b4jf83e2f2b7c6dbe6b@mail.gmail.com>
Message-ID: <88e286470902071553o5b270af6o16cf512b5414b1a8@mail.gmail.com>

Can't fix it. Don't have admin rights on that site. Original author of
mod_python does but we have failed before in getting him to fix it.

Graham

2009/2/8 Charles Dietrich <charles.m.dietrich@gmail.com>:
> On the page
>
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
> The archive link links to
>
> http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/
>
> It should link to
>
> http://mailman.modpython.org/pipermail/mod_python/
>
> Please fix this, esp since it's not getting indexed by google I think.
>
> Charles
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
From rogerdpack at gmail.com  Sat Feb  7 23:48:43 2009
From: rogerdpack at gmail.com (Roger Pack)
Date: Sat Feb  7 23:48:49 2009
Subject: [mod_python] question
In-Reply-To: <88e286470902070127u207b1f6foe5519f5c314751b6@mail.gmail.com>
References: <e880bd570902061157j6e7bff3awb76157e12942534@mail.gmail.com>
	<88e286470902070127u207b1f6foe5519f5c314751b6@mail.gmail.com>
Message-ID: <e880bd570902072048p705ef2c3jb8e2360ecaf180a2@mail.gmail.com>

Thanks for your reply.  Unfortunately in this instance I have a
mod_python handler and am unskilled so I think I'm stuck with
mod_python :)
I did get bit with this bug, though--might be worth releasing.
Thanks for your work!
-=r

On Sat, Feb 7, 2009 at 2:27 AM, Graham Dumpleton
<graham.dumpleton@gmail.com> wrote:
> 2009/2/7 Roger Pack <rogerdpack@gmail.com>:
>> Sorry if this is about an old post.
>> Has this problem
>> http://bugs.gentoo.org/show_bug.cgi?id=230211
>> been resolved?
>
> It is fixed in mod_python subversion trunk. Sorry, can't tell you what
> the subversion URL is right now, but might be listed on mod_python
> site somewhere.
>
> BTW, if you aren't using mod_python specific APIs or handlers and only
> wanting to host a WSGI capable application such as Django or Trac, you
> should also look at mod_wsgi. It does not have this specific problem.
>
> Graham
>
From rphelps at redshift.com  Sun Feb  8 19:45:52 2009
From: rphelps at redshift.com (Ron Phelps)
Date: Sun Feb  8 19:50:01 2009
Subject: [mod_python] Weird Publisher Problem, Configuration?
Message-ID: <1234140352.30225.10.camel@quirky>

I am using a simple publisher example from 2005 that prompts the user to
select a month of the year and I think it is to return a html page to
the browser with a formatted month. However,  instead of returning the
html Firefox prompts me to save the file or open with another
application.  Do I need to add the Publisher handler in the apache2.conf
file? 

Ron 

Here's the code.

   <title>A simple "get month" script</title>
   <body>
   <form method="POST" action="python/getMonth.py">
   <p>
   <hr>
   <br />
   Show which month for 2005?: <br />
   <select name="month">
      <option value="1">January</option>
      <option value="2">February</option>
      <option value="3">March</option>
      <option value="4">April</option>
      <option value="5">May</option>
      <option value="6">June</option>
      <option value="7">July</option>
      <option value="8">August</option>
      <option value="9">September</option>
      <option value="10">October</option>
      <option value="11">November</option>
      <option value="12">December</option>
   </select>
   <br />
   <input type="submit" value="Show Month">
   </form>
   </body>


   # A simple script to output a calendar month based off input 
   # from a web form.
   #
   import calendar
   from mod_python import apache
   def getMonth(req,month):
      req.write(calendar.month(2005, int(month),2,3))


Apache config 

<VirtualHost *>
	ServerAdmin webmaster@localhost
	
	DocumentRoot /var/www/tlm/
	<Directory />
		Options FollowSymLinks
		AllowOverride None
	</Directory>

	<Directory /var/www/tlm>
		Options Indexes FollowSymLinks MultiViews
		AllowOverride None
		#Order deny,allow
		Deny from all
		Allow from 127.0.0.0/255.0.0.0
		# Deny from anywhere but this machine
	</Directory>

	ErrorLog /var/log/apache2/error.log

	# Possible values include: debug, info, notice, warn, error, crit,
	# alert, emerg.
	LogLevel warn

	CustomLog /var/log/apache2/access.log combined
	ServerSignature On

    Alias /doc/ "/usr/share/doc/"
    <Directory "/usr/share/doc/">
        Options Indexes MultiViews FollowSymLinks
        AllowOverride None
        Order deny,allow
        Deny from all
        Allow from 127.0.0.0/255.0.0.0
    </Directory>

    <Directory /var/www/tlm/>
       SetHandler mod_python
       PythonHandler mod_python.publisher
       PythonDebug On
    </Directory>

</VirtualHost>


From graham.dumpleton at gmail.com  Sun Feb  8 20:08:26 2009
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sun Feb  8 20:08:32 2009
Subject: [mod_python] Weird Publisher Problem, Configuration?
In-Reply-To: <1234140352.30225.10.camel@quirky>
References: <1234140352.30225.10.camel@quirky>
Message-ID: <88e286470902081708k5e12abbdkcddb893c78a7e22f@mail.gmail.com>

Set response content type.

  req.content_type = "..."

This must be done before writing any response content.

Replace "..." for what is correct for how response is formatter. Eg>

  req.content_type = 'text/plain'

or:

  req.content_type = 'text/html'

Graham

2009/2/9 Ron Phelps <rphelps@redshift.com>:
> I am using a simple publisher example from 2005 that prompts the user to
> select a month of the year and I think it is to return a html page to
> the browser with a formatted month. However,  instead of returning the
> html Firefox prompts me to save the file or open with another
> application.  Do I need to add the Publisher handler in the apache2.conf
> file?
>
> Ron
>
> Here's the code.
>
>   <title>A simple "get month" script</title>
>   <body>
>   <form method="POST" action="python/getMonth.py">
>   <p>
>   <hr>
>   <br />
>   Show which month for 2005?: <br />
>   <select name="month">
>      <option value="1">January</option>
>      <option value="2">February</option>
>      <option value="3">March</option>
>      <option value="4">April</option>
>      <option value="5">May</option>
>      <option value="6">June</option>
>      <option value="7">July</option>
>      <option value="8">August</option>
>      <option value="9">September</option>
>      <option value="10">October</option>
>      <option value="11">November</option>
>      <option value="12">December</option>
>   </select>
>   <br />
>   <input type="submit" value="Show Month">
>   </form>
>   </body>
>
>
>   # A simple script to output a calendar month based off input
>   # from a web form.
>   #
>   import calendar
>   from mod_python import apache
>   def getMonth(req,month):
>      req.write(calendar.month(2005, int(month),2,3))
>
>
> Apache config
>
> <VirtualHost *>
>        ServerAdmin webmaster@localhost
>
>        DocumentRoot /var/www/tlm/
>        <Directory />
>                Options FollowSymLinks
>                AllowOverride None
>        </Directory>
>
>        <Directory /var/www/tlm>
>                Options Indexes FollowSymLinks MultiViews
>                AllowOverride None
>                #Order deny,allow
>                Deny from all
>                Allow from 127.0.0.0/255.0.0.0
>                # Deny from anywhere but this machine
>        </Directory>
>
>        ErrorLog /var/log/apache2/error.log
>
>        # Possible values include: debug, info, notice, warn, error, crit,
>        # alert, emerg.
>        LogLevel warn
>
>        CustomLog /var/log/apache2/access.log combined
>        ServerSignature On
>
>    Alias /doc/ "/usr/share/doc/"
>    <Directory "/usr/share/doc/">
>        Options Indexes MultiViews FollowSymLinks
>        AllowOverride None
>        Order deny,allow
>        Deny from all
>        Allow from 127.0.0.0/255.0.0.0
>    </Directory>
>
>    <Directory /var/www/tlm/>
>       SetHandler mod_python
>       PythonHandler mod_python.publisher
>       PythonDebug On
>    </Directory>
>
> </VirtualHost>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From abbottdavid at bellsouth.net  Sun Feb  8 21:53:11 2009
From: abbottdavid at bellsouth.net (David)
Date: Sun Feb  8 21:53:17 2009
Subject: [mod_python] Weird Publisher Problem, Configuration?
In-Reply-To: <1234140352.30225.10.camel@quirky>
References: <1234140352.30225.10.camel@quirky>
Message-ID: <498F9A97.9000000@bellsouth.net>

Ron Phelps wrote:
> I am using a simple publisher example from 2005 that prompts the user to
> select a month of the year and I think it is to return a html page to
> the browser with a formatted month. However,  instead of returning the
> html Firefox prompts me to save the file or open with another
> application.  Do I need to add the Publisher handler in the apache2.conf
> file? 
>   
Here is mine;
# -*- coding: UTF-8 -*-
import calendar
from mod_python import apache

def index():   

   return """

<html><head>
<title>A simple "get month" script</title>
</head>
<body>
<form value="form" method="POST" action="getmonth.py/getMonth">
<p>
<hr>
<br />
Show which month for 2009 ?: <br />
<select name="month">
   <option value="1">January</option>
   <option value="2">February</option>
   <option value="3">March</option>
   <option value="4">April</option>
   <option value="5">May</option>
   <option value="6">June</option>
   <option value="7">July</option>
   <option value="8">August</option>
   <option value="9">September</option>
   <option value="10">October</option>
   <option value="11">November</option>
   <option value="12">December</option>
</select>
<br />
<input type="submit" value="Show Month" action="getmonth.py/getMonth">

</form>
</body>
</html>
"""
def getMonth(req,month):
    req.content_type = "text/html"
    req.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">')
    req.write('<html xmlns="http://www.w3.org/1999/xhtml" lang="en" 
xml:lang="en">')
    req.write('<head><title>Month</title></head>')
    req.write('<body>')
    req.write('<p>')
    req.write('<hr />')
    req.write('<br />')
    req.write('</p>')
    req.write('<pre>')
    req.write(calendar.month(2009, int(month),2,3))
    req.write('</pre>')
    req.write('</body>')
    req.write('</html>')
   
<Directory /var/www/localhost/htdocs/python>
    AddHandler mod_python .py
    PythonHandler mod_python.publisher
    PythonDebug On
</Directory>

Here it is;
http://dwabbott.com/python/getmonth.py

-david

   
 
 

-- 
Powered by Gentoo GNU/LINUX
http://www.linuxcrazy.com
pgp.mit.edu


From rahul.warhekar at edisphere.com  Mon Feb  9 00:08:07 2009
From: rahul.warhekar at edisphere.com (rahul)
Date: Mon Feb  9 00:10:23 2009
Subject: [mod_python] i have problem accessing data from database using adodb
In-Reply-To: <88e286470902060547t65fa5878hb2611fd4538f3bc@mail.gmail.com>
Message-ID: <20090209051023.04F4E6A45BF@server1.edisphere.com>

Hello all,

I have to access data from database using adodb so I did 

Import adodb
Conn=adodb.NewADOConnection("odbc")

Upto this it works properly but when I say 

Conn.Connect("","","")

It gives error as 

[Attributrerror]: Object Nonetype has no attribute Connect.

I have Red Hat Enterprise Linux 4
Python 2.5
Mod_python 3.3.1
Please guide me through this. 

From graham.dumpleton at gmail.com  Mon Feb  9 00:43:45 2009
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Feb  9 00:43:51 2009
Subject: [mod_python] Re: i have problem accessing data from database using
	adodb
In-Reply-To: <20090209051023.04F4E6A45BF@server1.edisphere.com>
References: <88e286470902060547t65fa5878hb2611fd4538f3bc@mail.gmail.com>
	<20090209051023.04F4E6A45BF@server1.edisphere.com>
Message-ID: <88e286470902082143k51f95a1w3b602d97d76e113@mail.gmail.com>

Does it work from command line Python?

Graham

2009/2/9 rahul <rahul.warhekar@edisphere.com>:
> Hello all,
>
> I have to access data from database using adodb so I did
>
> Import adodb
> Conn=adodb.NewADOConnection("odbc")
>
> Upto this it works properly but when I say
>
> Conn.Connect("","","")
>
> It gives error as
>
> [Attributrerror]: Object Nonetype has no attribute Connect.
>
> I have Red Hat Enterprise Linux 4
> Python 2.5
> Mod_python 3.3.1
> Please guide me through this.
>
>
From rahul.warhekar at edisphere.com  Mon Feb  9 00:55:15 2009
From: rahul.warhekar at edisphere.com (rahul)
Date: Mon Feb  9 00:57:32 2009
Subject: [mod_python] RE: i have problem accessing data from database using
	adodb
In-Reply-To: <88e286470902082143k51f95a1w3b602d97d76e113@mail.gmail.com>
Message-ID: <20090209055732.2F2E56A45BF@server1.edisphere.com>

No the same problem exist on console also
Is there any kind of installation issue or what

-----Original Message-----
From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com] 
Sent: Monday, February 09, 2009 11:14 AM
To: rahul
Cc: mod_python@modpython.org
Subject: Re: i have problem accessing data from database using adodb

Does it work from command line Python?

Graham

2009/2/9 rahul <rahul.warhekar@edisphere.com>:
> Hello all,
>
> I have to access data from database using adodb so I did
>
> Import adodb
> Conn=adodb.NewADOConnection("odbc")
>
> Upto this it works properly but when I say
>
> Conn.Connect("","","")
>
> It gives error as
>
> [Attributrerror]: Object Nonetype has no attribute Connect.
>
> I have Red Hat Enterprise Linux 4
> Python 2.5
> Mod_python 3.3.1
> Please guide me through this.
>
>

From graham.dumpleton at gmail.com  Mon Feb  9 01:10:15 2009
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Feb  9 01:10:20 2009
Subject: [mod_python] Re: i have problem accessing data from database using
	adodb
In-Reply-To: <20090209055732.2F2E56A45BF@server1.edisphere.com>
References: <88e286470902082143k51f95a1w3b602d97d76e113@mail.gmail.com>
	<20090209055732.2F2E56A45BF@server1.edisphere.com>
Message-ID: <88e286470902082210q5b98f37eu7d8169bc78de7acf@mail.gmail.com>

If it happens from command line Python, then it is not a mod_python
problem and you should use a more appropriate forum to ask about it.
Perhaps try:

  http://groups.google.com/group/comp.lang.python/topics?lnk

Just be clear in asking in other forum that it doesn't work from
command line. Don't confuse it by saying it doesn't work from
mod_python as they likely will not help you then.

Graham

2009/2/9 rahul <rahul.warhekar@edisphere.com>:
> No the same problem exist on console also
> Is there any kind of installation issue or what
>
> -----Original Message-----
> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
> Sent: Monday, February 09, 2009 11:14 AM
> To: rahul
> Cc: mod_python@modpython.org
> Subject: Re: i have problem accessing data from database using adodb
>
> Does it work from command line Python?
>
> Graham
>
> 2009/2/9 rahul <rahul.warhekar@edisphere.com>:
>> Hello all,
>>
>> I have to access data from database using adodb so I did
>>
>> Import adodb
>> Conn=adodb.NewADOConnection("odbc")
>>
>> Upto this it works properly but when I say
>>
>> Conn.Connect("","","")
>>
>> It gives error as
>>
>> [Attributrerror]: Object Nonetype has no attribute Connect.
>>
>> I have Red Hat Enterprise Linux 4
>> Python 2.5
>> Mod_python 3.3.1
>> Please guide me through this.
>>
>>
>
>
From Scott.Chapman at VerizonWireless.com  Mon Feb  9 14:54:04 2009
From: Scott.Chapman at VerizonWireless.com (Scott.Chapman@VerizonWireless.com)
Date: Mon Feb  9 14:54:10 2009
Subject: [mod_python] When will next version of mod_python be released?
Message-ID: <200902091954.n19Js6AU031355@modpython.org>

I'm trying to compile mod_python 3.3.1 against Apache 2.2.11 and I'm getting this error:

connobject.c: In function `_conn_read':
connobject.c:142: error: request for member `next' in something not a structure or union
apxs:Error: Command failed with rc=65536

I understand that it's fixed in SVN:
http://www.modpython.org/pipermail/mod_python/2008-October/025724.html

I can't use a non-release version in production.

Can you tell me when the next mod_python release will happen?

Thanks!
Scott





The information contained in this message and any attachment may be
proprietary, confidential, and privileged or subject to the work
product doctrine and thus protected from disclosure.  If the reader
of this message is not the intended recipient, or an employee or
agent responsible for delivering this message to the intended
recipient, you are hereby notified that any dissemination,
distribution or copying of this communication is strictly prohibited.
If you have received this communication in error, please notify me
immediately by replying to this message and deleting it and all
copies and backups thereof.  Thank you.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20090209/16d22867/attachment.html
From mshah at harpercollege.edu  Mon Feb  9 18:17:17 2009
From: mshah at harpercollege.edu (Mitesh Shah)
Date: Mon Feb  9 18:17:23 2009
Subject: [mod_python] req.user always returns None
Message-ID: <2AD6043C7DE1544D86FE37F8B7E68BD9015A97C2@admexchs1.admdom.harpercollege.edu>

I am having some issues trying to req.user to return a username.  I am
very new to python and mod_python.  I happened upon this thread:

 

http://osdir.com/ml/python.mod_python/2003-10/msg00092.html regarding a
similar issue.

 

Anyway, even when I ran the code posted by "David Hancock" in the post
above I only got a "None" for the username in the error_log file.  I am
sending this in the URL:

"http://localhost/python/mptest"

 

Here is the test setup as it applies to me(basically unchanged).

 

******mptest.py*******

from mod_python import apache

 

def handler(req):

        req.content_type = 'text/plain'

        req.send_http_header()

        req.write("Hello, world!")

        return apache.OK

 

def authenhandler(req):

        user = req.user

        pw = req.get_basic_auth_pw()

        req.log_error(str(user) + ' ' + str(pw))

        if user == "fred" and pw == "secret":

                return apache.OK

        else:

                return apache.HTTP_UNAUTHORIZED

*******mptest.py******

 

*******httpd.conf******

<Directory "/var/www/html/python">

    AddHandler python-program .py

    PythonHandler mptest

    PythonAuthenHandler mptest

    AuthType Basic

    AuthName "mod_python restricted area"

    require valid-user

    PythonDebug On

</Directory>

******httpd.conf*******

 

*******error_log*******

[Mon Feb 09 17:10:04 2009] [error] [client 127.0.0.1] None secret

*******error_log*******

 

After attempting to login I get a 401 page and then I am asked to login
again.

 

Any help would be greatly appreciated!

 

Thank you,

Mitesh

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20090209/d824ae48/attachment.html
From graham.dumpleton at gmail.com  Mon Feb  9 18:34:43 2009
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Feb  9 18:34:45 2009
Subject: [mod_python] req.user always returns None
In-Reply-To: <2AD6043C7DE1544D86FE37F8B7E68BD9015A97C2@admexchs1.admdom.harpercollege.edu>
References: <2AD6043C7DE1544D86FE37F8B7E68BD9015A97C2@admexchs1.admdom.harpercollege.edu>
Message-ID: <88e286470902091534n62a88acao31390ba7f330320@mail.gmail.com>

It is the authentication handlers responsibility, directly or
indirectly, to set req.user, it will not be set before the
authentication handler is called. Setting it is one of the things that
a correctly implement authentication handler should do.

For the way you are doing things, req.user will only be set after:

  pw = req.get_basic_auth_pw()

is called. Ie., done as a side effect of that call.

BTW, if you are new to mod_python, you might want to consider instead
using mod_wsgi, writing your application code as a WSGI application
and using mod_wsgi's much simpler to understand authentication
provider hooks where everything is done for you except for validating
the user credentials. For the latter see:

  http://code.google.com/p/modwsgi/wiki/AccessControlMechanisms

Graham

2009/2/10 Mitesh Shah <mshah@harpercollege.edu>:
> I am having some issues trying to req.user to return a username.  I am very
> new to python and mod_python.  I happened upon this thread:
>
>
>
> http://osdir.com/ml/python.mod_python/2003-10/msg00092.html regarding a
> similar issue.
>
>
>
> Anyway, even when I ran the code posted by "David Hancock" in the post above
> I only got a "None" for the username in the error_log file.  I am sending
> this in the URL:
>
> "http://localhost/python/mptest"
>
>
>
> Here is the test setup as it applies to me(basically unchanged).
>
>
>
> ******mptest.py*******
>
> from mod_python import apache
>
>
>
> def handler(req):
>
>         req.content_type = 'text/plain'
>
>         req.send_http_header()
>
>         req.write("Hello, world!")
>
>         return apache.OK
>
>
>
> def authenhandler(req):
>
>         user = req.user
>
>         pw = req.get_basic_auth_pw()
>
>         req.log_error(str(user) + ' ' + str(pw))
>
>         if user == "fred" and pw == "secret":
>
>                 return apache.OK
>
>         else:
>
>                 return apache.HTTP_UNAUTHORIZED
>
> *******mptest.py******
>
>
>
> *******httpd.conf******
>
> <Directory "/var/www/html/python">
>
>     AddHandler python-program .py
>
>     PythonHandler mptest
>
>     PythonAuthenHandler mptest
>
>     AuthType Basic
>
>     AuthName "mod_python restricted area"
>
>     require valid-user
>
>     PythonDebug On
>
> </Directory>
>
> ******httpd.conf*******
>
>
>
> *******error_log*******
>
> [Mon Feb 09 17:10:04 2009] [error] [client 127.0.0.1] None secret
>
> *******error_log*******
>
>
>
> After attempting to login I get a 401 page and then I am asked to login
> again.
>
>
>
> Any help would be greatly appreciated!
>
>
>
> Thank you,
>
> Mitesh
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
From graham.dumpleton at gmail.com  Mon Feb  9 18:40:19 2009
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Feb  9 18:40:24 2009
Subject: [mod_python] When will next version of mod_python be released?
In-Reply-To: <200902091954.n19Js6AU031355@modpython.org>
References: <200902091954.n19Js6AU031355@modpython.org>
Message-ID: <88e286470902091540q1b01af55g6c77b1c9b8a189b9@mail.gmail.com>

2009/2/10  <Scott.Chapman@verizonwireless.com>:
> I'm trying to compile mod_python 3.3.1 against Apache 2.2.11 and I'm getting
> this error:
>
> connobject.c: In function `_conn_read':
> connobject.c:142: error: request for member `next' in something not a
> structure or union
> apxs:Error: Command failed with rc=65536
>
> I understand that it's fixed in SVN:
> http://www.modpython.org/pipermail/mod_python/2008-October/025724.html
>
> I can't use a non-release version in production.
>
> Can you tell me when the next mod_python release will happen?

There are effectively no active developers working on mod_python at
the moment. I might if one is lucky fix build issues in subversion
code, but that is all. I still answer questions on the list, but
likely not much longer.

In other words, not likely any time soon. Even if work was done on in,
not sure one could muster enough votes per Apache Software Foundation
rules to approve it for release.

Overall the future of mod_python is quite uncertain and at this stage
probably quite certain that it will not get ported to Python 3.0
unless some enthusiastic white knight comes along. Even then, there is
quite a backlog of bugs to be fixed before a port could seriously be
considered.

BTW, if you are only wanting to host a WSGI capable application such
as Django, TurboGears, Trac etc, then use mod_wsgi instead. It is up
to date, still actively worked on and arguably will replace a lot of
the low level handler functionality of mod_python.

Graham
From dave at davebritton.com  Mon Feb  9 19:39:58 2009
From: dave at davebritton.com (Dave Britton)
Date: Mon Feb  9 19:37:52 2009
Subject: [SPAM] Re: [mod_python] When will next version of mod_python be
	released?
References: <200902091954.n19Js6AU031355@modpython.org>
	<88e286470902091540q1b01af55g6c77b1c9b8a189b9@mail.gmail.com>
Message-ID: <0f9701c98b18$19b83b70$0500a8c0@yoda>

Graham
Why has mod_python fallen by the wayside? When did this happen? What might
it mean for those of us relying on mod_python applications? Mod_WSGI sounds
great, and I'll surely try to get it going, but you're the only developer,
even though you're actually a superhero. What happens to people who want to
build python backends to their websites? That is, what was the memo everyone
but me got? Yikes!
-Dave
----- Original Message -----
From: "Graham Dumpleton" <graham.dumpleton@gmail.com>
To: <Scott.Chapman@verizonwireless.com>
Cc: <mod_python@modpython.org>
Sent: Monday, February 09, 2009 6:40 PM
Subject: Re: [mod_python] When will next version of mod_python be released?


> 2009/2/10  <Scott.Chapman@verizonwireless.com>:
> > I'm trying to compile mod_python 3.3.1 against Apache 2.2.11 and I'm
getting
> > this error:
> >
> > connobject.c: In function `_conn_read':
> > connobject.c:142: error: request for member `next' in something not a
> > structure or union
> > apxs:Error: Command failed with rc=65536
> >
> > I understand that it's fixed in SVN:
> > http://www.modpython.org/pipermail/mod_python/2008-October/025724.html
> >
> > I can't use a non-release version in production.
> >
> > Can you tell me when the next mod_python release will happen?
>
> There are effectively no active developers working on mod_python at
> the moment. I might if one is lucky fix build issues in subversion
> code, but that is all. I still answer questions on the list, but
> likely not much longer.
>
> In other words, not likely any time soon. Even if work was done on in,
> not sure one could muster enough votes per Apache Software Foundation
> rules to approve it for release.
>
> Overall the future of mod_python is quite uncertain and at this stage
> probably quite certain that it will not get ported to Python 3.0
> unless some enthusiastic white knight comes along. Even then, there is
> quite a backlog of bugs to be fixed before a port could seriously be
> considered.
>
> BTW, if you are only wanting to host a WSGI capable application such
> as Django, TurboGears, Trac etc, then use mod_wsgi instead. It is up
> to date, still actively worked on and arguably will replace a lot of
> the low level handler functionality of mod_python.
>
> Graham
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From mshah at harpercollege.edu  Mon Feb  9 20:11:42 2009
From: mshah at harpercollege.edu (Mitesh Shah)
Date: Mon Feb  9 20:11:49 2009
Subject: [mod_python] req.user always returns None
In-Reply-To: <88e286470902091534n62a88acao31390ba7f330320@mail.gmail.com>
References: <2AD6043C7DE1544D86FE37F8B7E68BD9015A97C2@admexchs1.admdom.harpercollege.edu>
	<88e286470902091534n62a88acao31390ba7f330320@mail.gmail.com>
Message-ID: <2AD6043C7DE1544D86FE37F8B7E68BD9015A97C3@admexchs1.admdom.harpercollege.edu>

I will take a look at mod_wsgi.  Anyway, looking at the initial post I
realized that pw = req.get_basic_auth_pw() came AFTER req.user.  I don't
know how many times I had read that this was incorrect and STILL did
it!!  Anyway, I got it to work with that change.  But this was all just
for testing.  But now I realized that I may not be able to use this with
what I want to accomplish.

1) Use apache Authorization via .htaccess (which connects to Active
Directory) -- Working
2) After the user is authenticated I have a form (html) with two fields
that posts to a python script. -- partially working (cannot log
username)

The reason I looked into mod_python was that I am trying to pass the
user's name from the initial login to my python script.  Any ideas on
how I could do this? 

Thanks,
Mitesh

-----Original Message-----
From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com] 
Sent: Monday, February 09, 2009 5:35 PM
To: Mitesh Shah
Cc: mod_python@modpython.org
Subject: Re: [mod_python] req.user always returns None

It is the authentication handlers responsibility, directly or
indirectly, to set req.user, it will not be set before the
authentication handler is called. Setting it is one of the things that
a correctly implement authentication handler should do.

For the way you are doing things, req.user will only be set after:

  pw = req.get_basic_auth_pw()

is called. Ie., done as a side effect of that call.

BTW, if you are new to mod_python, you might want to consider instead
using mod_wsgi, writing your application code as a WSGI application
and using mod_wsgi's much simpler to understand authentication
provider hooks where everything is done for you except for validating
the user credentials. For the latter see:

  http://code.google.com/p/modwsgi/wiki/AccessControlMechanisms

Graham

2009/2/10 Mitesh Shah <mshah@harpercollege.edu>:
> I am having some issues trying to req.user to return a username.  I am
very
> new to python and mod_python.  I happened upon this thread:
>
>
>
> http://osdir.com/ml/python.mod_python/2003-10/msg00092.html regarding
a
> similar issue.
>
>
>
> Anyway, even when I ran the code posted by "David Hancock" in the post
above
> I only got a "None" for the username in the error_log file.  I am
sending
> this in the URL:
>
> "http://localhost/python/mptest"
>
>
>
> Here is the test setup as it applies to me(basically unchanged).
>
>
>
> ******mptest.py*******
>
> from mod_python import apache
>
>
>
> def handler(req):
>
>         req.content_type = 'text/plain'
>
>         req.send_http_header()
>
>         req.write("Hello, world!")
>
>         return apache.OK
>
>
>
> def authenhandler(req):
>
>         user = req.user
>
>         pw = req.get_basic_auth_pw()
>
>         req.log_error(str(user) + ' ' + str(pw))
>
>         if user == "fred" and pw == "secret":
>
>                 return apache.OK
>
>         else:
>
>                 return apache.HTTP_UNAUTHORIZED
>
> *******mptest.py******
>
>
>
> *******httpd.conf******
>
> <Directory "/var/www/html/python">
>
>     AddHandler python-program .py
>
>     PythonHandler mptest
>
>     PythonAuthenHandler mptest
>
>     AuthType Basic
>
>     AuthName "mod_python restricted area"
>
>     require valid-user
>
>     PythonDebug On
>
> </Directory>
>
> ******httpd.conf*******
>
>
>
> *******error_log*******
>
> [Mon Feb 09 17:10:04 2009] [error] [client 127.0.0.1] None secret
>
> *******error_log*******
>
>
>
> After attempting to login I get a 401 page and then I am asked to
login
> again.
>
>
>
> Any help would be greatly appreciated!
>
>
>
> Thank you,
>
> Mitesh
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>

From graham.dumpleton at gmail.com  Mon Feb  9 20:17:32 2009
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Feb  9 20:17:34 2009
Subject: [mod_python] When will next version of mod_python be released?
In-Reply-To: <0f9701c98b18$19b83b70$0500a8c0@yoda>
References: <200902091954.n19Js6AU031355@modpython.org>
	<88e286470902091540q1b01af55g6c77b1c9b8a189b9@mail.gmail.com>
	<0f9701c98b18$19b83b70$0500a8c0@yoda>
Message-ID: <88e286470902091717re198e9cuc799d2ac96639b4f@mail.gmail.com>

2009/2/10 Dave Britton <dave@davebritton.com>:
> Graham
> Why has mod_python fallen by the wayside? When did this happen?

The last release of mod_python was about 2 years ago.

The changes in that release made it a lot more stable than it was
previously, especially for the main use case, which was people using
mod_python merely as a jumping off point for a separate Python web
framework or application.

The only changes made in subversion repository since then have been:

      [http://issues.apache.org/jira/browse/MODPYTHON-220
      Fix 'import' from same directory as PSP file.

      http://issues.apache.org/jira/browse/MODPYTHON-245
      Fix prototype of optional exported function mp_release_interpreter().

      http://issues.apache.org/jira/browse/MODPYTHON-249
      Fixed incorrect use of APR bucket brigades shown up by APR 1.3.2.

      http://issues.apache.org/jira/browse/MODPYTHON-250
      Fixed MacOS X (10.5) Leopard 64 bit architecture problems.

Except for the first, which got tired of having to answer questions as
to why it didn't work, they all related to build problems.

In general people have been happy with the stability and no one
specifically has been seeking new features.

Even so, the number of bugs has accumulated.

  http://issues.apache.org/jira/secure/IssueNavigator.jspa?reset=true&pid=10640&status=1

Many of these were found when mod_wsgi was written and observed that
mod_python was doing many things wrong, or had bugs in how it was
doing it.

Obviously my personal focus is on mod_wsgi these days and not
interested in doing stuff on mod_python especially since its code base
is quite messy. The only other active developer on mod_python at time
of last release has also moved on and haven't heard from them in a
long time.

The original author of mod_python, who is still part of ASF project
management committee did contact me a while back about what was
happening and more or less told him the same thing, that mod_python is
starting to die a slow death. Never heard back from them so nothing
was done as far as trying to reinvigorate it or work out what its
future may be.

Interestingly, recently the ASF created http://attic.apache.org/. Thus
they are defining rules which which ASF projects would be declared
moribund. From memory mod_python is already in danger of meeting the
requirements which would see if marked end of life.

> What might it mean for those of us relying on mod_python applications?

For existing Python web applications which are bound to mod_python
specific higher level handlers such as mod_python.publisher or
mod_python.psp, the things do look a bit gloomy.

If you have a mod_python specific API purely at the interface layer
and internals of your application aren't dependent on mod_python, much
like how stuff like Django and Trac worked when mod_python was only
option, then you would be wise to refactor your interface to use WSGI
instead. That way you could use mod_wsgi, or a WSGI adapter for
fastcgi/scgi/ajp, or even a standalone Python WSGI server.

> What happens to people who want to build python backends to their websites?

The Python web community is very much going towards WSGI as interface
to web server. This allows for portability to different hosting
solutions. Thus, look at being compatible with that.

If you don't like the mega frameworks such as Django or TurboGears,
then look at more componentised toolkits such as Werkzeug, Paste and
Pylons.

> That is, what was the memo everyone but me got? Yikes!

I have been warning about this for a while now, not new. :-)

I may actually be part of the problem. Because I keep answering
questions people may assume it is being looked after when it isn't. Me
clearly stating that I am no longer involved and no longer answering
questions might be a wise step as it may flush out people who are
truly interested in taking over.

Graham

> -Dave
> ----- Original Message -----
> From: "Graham Dumpleton" <graham.dumpleton@gmail.com>
> To: <Scott.Chapman@verizonwireless.com>
> Cc: <mod_python@modpython.org>
> Sent: Monday, February 09, 2009 6:40 PM
> Subject: Re: [mod_python] When will next version of mod_python be released?
>
>
>> 2009/2/10  <Scott.Chapman@verizonwireless.com>:
>> > I'm trying to compile mod_python 3.3.1 against Apache 2.2.11 and I'm
> getting
>> > this error:
>> >
>> > connobject.c: In function `_conn_read':
>> > connobject.c:142: error: request for member `next' in something not a
>> > structure or union
>> > apxs:Error: Command failed with rc=65536
>> >
>> > I understand that it's fixed in SVN:
>> > http://www.modpython.org/pipermail/mod_python/2008-October/025724.html
>> >
>> > I can't use a non-release version in production.
>> >
>> > Can you tell me when the next mod_python release will happen?
>>
>> There are effectively no active developers working on mod_python at
>> the moment. I might if one is lucky fix build issues in subversion
>> code, but that is all. I still answer questions on the list, but
>> likely not much longer.
>>
>> In other words, not likely any time soon. Even if work was done on in,
>> not sure one could muster enough votes per Apache Software Foundation
>> rules to approve it for release.
>>
>> Overall the future of mod_python is quite uncertain and at this stage
>> probably quite certain that it will not get ported to Python 3.0
>> unless some enthusiastic white knight comes along. Even then, there is
>> quite a backlog of bugs to be fixed before a port could seriously be
>> considered.
>>
>> BTW, if you are only wanting to host a WSGI capable application such
>> as Django, TurboGears, Trac etc, then use mod_wsgi instead. It is up
>> to date, still actively worked on and arguably will replace a lot of
>> the low level handler functionality of mod_python.
>>
>> Graham
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
From graham.dumpleton at gmail.com  Mon Feb  9 20:20:51 2009
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Feb  9 20:20:53 2009
Subject: [mod_python] req.user always returns None
In-Reply-To: <2AD6043C7DE1544D86FE37F8B7E68BD9015A97C3@admexchs1.admdom.harpercollege.edu>
References: <2AD6043C7DE1544D86FE37F8B7E68BD9015A97C2@admexchs1.admdom.harpercollege.edu>
	<88e286470902091534n62a88acao31390ba7f330320@mail.gmail.com>
	<2AD6043C7DE1544D86FE37F8B7E68BD9015A97C3@admexchs1.admdom.harpercollege.edu>
Message-ID: <88e286470902091720m4509962y8c748c6307fb6a8f@mail.gmail.com>

2009/2/10 Mitesh Shah <mshah@harpercollege.edu>:
> I will take a look at mod_wsgi.  Anyway, looking at the initial post I
> realized that pw = req.get_basic_auth_pw() came AFTER req.user.  I don't
> know how many times I had read that this was incorrect and STILL did
> it!!  Anyway, I got it to work with that change.  But this was all just
> for testing.  But now I realized that I may not be able to use this with
> what I want to accomplish.
>
> 1) Use apache Authorization via .htaccess (which connects to Active
> Directory) -- Working
> 2) After the user is authenticated I have a form (html) with two fields
> that posts to a python script. -- partially working (cannot log
> username)

When you say script, what is it implemented as, CGI or mod_python?

If CGI, then user should be available as REMOTE_USER environment
variable. If mod_python then as req.user.

If these don't work then the AD module you are using for
authentication is broken in not setting 'user' in Apache request
structure properly.

> The reason I looked into mod_python was that I am trying to pass the
> user's name from the initial login to my python script.  Any ideas on
> how I could do this?

Or are you after full name of user rather than a log in ID?

Can you clarify a bit.

Graham

> Thanks,
> Mitesh
>
> -----Original Message-----
> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
> Sent: Monday, February 09, 2009 5:35 PM
> To: Mitesh Shah
> Cc: mod_python@modpython.org
> Subject: Re: [mod_python] req.user always returns None
>
> It is the authentication handlers responsibility, directly or
> indirectly, to set req.user, it will not be set before the
> authentication handler is called. Setting it is one of the things that
> a correctly implement authentication handler should do.
>
> For the way you are doing things, req.user will only be set after:
>
>  pw = req.get_basic_auth_pw()
>
> is called. Ie., done as a side effect of that call.
>
> BTW, if you are new to mod_python, you might want to consider instead
> using mod_wsgi, writing your application code as a WSGI application
> and using mod_wsgi's much simpler to understand authentication
> provider hooks where everything is done for you except for validating
> the user credentials. For the latter see:
>
>  http://code.google.com/p/modwsgi/wiki/AccessControlMechanisms
>
> Graham
>
> 2009/2/10 Mitesh Shah <mshah@harpercollege.edu>:
>> I am having some issues trying to req.user to return a username.  I am
> very
>> new to python and mod_python.  I happened upon this thread:
>>
>>
>>
>> http://osdir.com/ml/python.mod_python/2003-10/msg00092.html regarding
> a
>> similar issue.
>>
>>
>>
>> Anyway, even when I ran the code posted by "David Hancock" in the post
> above
>> I only got a "None" for the username in the error_log file.  I am
> sending
>> this in the URL:
>>
>> "http://localhost/python/mptest"
>>
>>
>>
>> Here is the test setup as it applies to me(basically unchanged).
>>
>>
>>
>> ******mptest.py*******
>>
>> from mod_python import apache
>>
>>
>>
>> def handler(req):
>>
>>         req.content_type = 'text/plain'
>>
>>         req.send_http_header()
>>
>>         req.write("Hello, world!")
>>
>>         return apache.OK
>>
>>
>>
>> def authenhandler(req):
>>
>>         user = req.user
>>
>>         pw = req.get_basic_auth_pw()
>>
>>         req.log_error(str(user) + ' ' + str(pw))
>>
>>         if user == "fred" and pw == "secret":
>>
>>                 return apache.OK
>>
>>         else:
>>
>>                 return apache.HTTP_UNAUTHORIZED
>>
>> *******mptest.py******
>>
>>
>>
>> *******httpd.conf******
>>
>> <Directory "/var/www/html/python">
>>
>>     AddHandler python-program .py
>>
>>     PythonHandler mptest
>>
>>     PythonAuthenHandler mptest
>>
>>     AuthType Basic
>>
>>     AuthName "mod_python restricted area"
>>
>>     require valid-user
>>
>>     PythonDebug On
>>
>> </Directory>
>>
>> ******httpd.conf*******
>>
>>
>>
>> *******error_log*******
>>
>> [Mon Feb 09 17:10:04 2009] [error] [client 127.0.0.1] None secret
>>
>> *******error_log*******
>>
>>
>>
>> After attempting to login I get a 401 page and then I am asked to
> login
>> again.
>>
>>
>>
>> Any help would be greatly appreciated!
>>
>>
>>
>> Thank you,
>>
>> Mitesh
>>
>>
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>
>>
>
From mshah at harpercollege.edu  Mon Feb  9 20:38:03 2009
From: mshah at harpercollege.edu (Mitesh Shah)
Date: Mon Feb  9 20:38:08 2009
Subject: [mod_python] req.user always returns None
In-Reply-To: <88e286470902091720m4509962y8c748c6307fb6a8f@mail.gmail.com>
References: <2AD6043C7DE1544D86FE37F8B7E68BD9015A97C2@admexchs1.admdom.harpercollege.edu>
	<88e286470902091534n62a88acao31390ba7f330320@mail.gmail.com>
	<2AD6043C7DE1544D86FE37F8B7E68BD9015A97C3@admexchs1.admdom.harpercollege.edu>
	<88e286470902091720m4509962y8c748c6307fb6a8f@mail.gmail.com>
Message-ID: <2AD6043C7DE1544D86FE37F8B7E68BD9015A97C4@admexchs1.admdom.harpercollege.edu>

Sorry for the confusion.  Well it was initially a CGI and then I learned
about mod_python.  Right now I haven't made any changes to the CGI until
I learn how mod_python works.  And all I need is the username and not
the full name.  When I tried -- os.environ["REMOTE_USER"] -- it never
returned anything.  I think I'm just having a hard time understanding
the logistics of mod_python. 

I call an html and ask for authentication, this should set the cgi
variable but since my python CGI is calling python (#!/usr/bin/python)
separately, I don't think it can access the username from the initial
authentication.

Which brought me mod_python.  Every example I see they change Apache's
httpd.conf to point to the python script. And then this calls
req.get_basic_auth_pw() and req.user and I am able to see the username.
Basically I want the user to authenticate and be presented the html form
and then post to my CGI(or soon mod_python) and then the python script
would then grab the username via req.user.

Thanks for you help so far.

-Mitesh

-----Original Message-----
From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com] 
Sent: Monday, February 09, 2009 7:21 PM
To: Mitesh Shah
Cc: mod_python@modpython.org
Subject: Re: [mod_python] req.user always returns None

2009/2/10 Mitesh Shah <mshah@harpercollege.edu>:
> I will take a look at mod_wsgi.  Anyway, looking at the initial post I
> realized that pw = req.get_basic_auth_pw() came AFTER req.user.  I
don't
> know how many times I had read that this was incorrect and STILL did
> it!!  Anyway, I got it to work with that change.  But this was all
just
> for testing.  But now I realized that I may not be able to use this
with
> what I want to accomplish.
>
> 1) Use apache Authorization via .htaccess (which connects to Active
> Directory) -- Working
> 2) After the user is authenticated I have a form (html) with two
fields
> that posts to a python script. -- partially working (cannot log
> username)

When you say script, what is it implemented as, CGI or mod_python?

If CGI, then user should be available as REMOTE_USER environment
variable. If mod_python then as req.user.

If these don't work then the AD module you are using for
authentication is broken in not setting 'user' in Apache request
structure properly.

> The reason I looked into mod_python was that I am trying to pass the
> user's name from the initial login to my python script.  Any ideas on
> how I could do this?

Or are you after full name of user rather than a log in ID?

Can you clarify a bit.

Graham

> Thanks,
> Mitesh
>
> -----Original Message-----
> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
> Sent: Monday, February 09, 2009 5:35 PM
> To: Mitesh Shah
> Cc: mod_python@modpython.org
> Subject: Re: [mod_python] req.user always returns None
>
> It is the authentication handlers responsibility, directly or
> indirectly, to set req.user, it will not be set before the
> authentication handler is called. Setting it is one of the things that
> a correctly implement authentication handler should do.
>
> For the way you are doing things, req.user will only be set after:
>
>  pw = req.get_basic_auth_pw()
>
> is called. Ie., done as a side effect of that call.
>
> BTW, if you are new to mod_python, you might want to consider instead
> using mod_wsgi, writing your application code as a WSGI application
> and using mod_wsgi's much simpler to understand authentication
> provider hooks where everything is done for you except for validating
> the user credentials. For the latter see:
>
>  http://code.google.com/p/modwsgi/wiki/AccessControlMechanisms
>
> Graham
>
> 2009/2/10 Mitesh Shah <mshah@harpercollege.edu>:
>> I am having some issues trying to req.user to return a username.  I
am
> very
>> new to python and mod_python.  I happened upon this thread:
>>
>>
>>
>> http://osdir.com/ml/python.mod_python/2003-10/msg00092.html regarding
> a
>> similar issue.
>>
>>
>>
>> Anyway, even when I ran the code posted by "David Hancock" in the
post
> above
>> I only got a "None" for the username in the error_log file.  I am
> sending
>> this in the URL:
>>
>> "http://localhost/python/mptest"
>>
>>
>>
>> Here is the test setup as it applies to me(basically unchanged).
>>
>>
>>
>> ******mptest.py*******
>>
>> from mod_python import apache
>>
>>
>>
>> def handler(req):
>>
>>         req.content_type = 'text/plain'
>>
>>         req.send_http_header()
>>
>>         req.write("Hello, world!")
>>
>>         return apache.OK
>>
>>
>>
>> def authenhandler(req):
>>
>>         user = req.user
>>
>>         pw = req.get_basic_auth_pw()
>>
>>         req.log_error(str(user) + ' ' + str(pw))
>>
>>         if user == "fred" and pw == "secret":
>>
>>                 return apache.OK
>>
>>         else:
>>
>>                 return apache.HTTP_UNAUTHORIZED
>>
>> *******mptest.py******
>>
>>
>>
>> *******httpd.conf******
>>
>> <Directory "/var/www/html/python">
>>
>>     AddHandler python-program .py
>>
>>     PythonHandler mptest
>>
>>     PythonAuthenHandler mptest
>>
>>     AuthType Basic
>>
>>     AuthName "mod_python restricted area"
>>
>>     require valid-user
>>
>>     PythonDebug On
>>
>> </Directory>
>>
>> ******httpd.conf*******
>>
>>
>>
>> *******error_log*******
>>
>> [Mon Feb 09 17:10:04 2009] [error] [client 127.0.0.1] None secret
>>
>> *******error_log*******
>>
>>
>>
>> After attempting to login I get a 401 page and then I am asked to
> login
>> again.
>>
>>
>>
>> Any help would be greatly appreciated!
>>
>>
>>
>> Thank you,
>>
>> Mitesh
>>
>>
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>
>>
>

From list at joreybump.com  Mon Feb  9 21:26:55 2009
From: list at joreybump.com (Jorey Bump)
Date: Mon Feb  9 21:26:57 2009
Subject: [mod_python] When will next version of mod_python be released?
In-Reply-To: <88e286470902091717re198e9cuc799d2ac96639b4f@mail.gmail.com>
References: <200902091954.n19Js6AU031355@modpython.org>	<88e286470902091540q1b01af55g6c77b1c9b8a189b9@mail.gmail.com>	<0f9701c98b18$19b83b70$0500a8c0@yoda>
	<88e286470902091717re198e9cuc799d2ac96639b4f@mail.gmail.com>
Message-ID: <4990E5EF.1070504@joreybump.com>

Graham Dumpleton wrote, at 02/09/2009 08:17 PM:

> The only changes made in subversion repository since then have been:
> 
>       [http://issues.apache.org/jira/browse/MODPYTHON-220
>       Fix 'import' from same directory as PSP file.
> 
>       http://issues.apache.org/jira/browse/MODPYTHON-245
>       Fix prototype of optional exported function mp_release_interpreter().
> 
>       http://issues.apache.org/jira/browse/MODPYTHON-249
>       Fixed incorrect use of APR bucket brigades shown up by APR 1.3.2.
> 
>       http://issues.apache.org/jira/browse/MODPYTHON-250
>       Fixed MacOS X (10.5) Leopard 64 bit architecture problems.
> 
> Except for the first, which got tired of having to answer questions as
> to why it didn't work, they all related to build problems.
> 
> In general people have been happy with the stability and no one
> specifically has been seeking new features.

I've been using mod_python-trunk for a while, and it seems pretty solid.
It would be nice to see this released as 3.3.2, unless you're aware of
any serious new bugs or stability issues compared to 3.3.1.

> Interestingly, recently the ASF created http://attic.apache.org/. Thus
> they are defining rules which which ASF projects would be declared
> moribund. From memory mod_python is already in danger of meeting the
> requirements which would see if marked end of life.

As long as it's compatible with current httpd releases, I don't see any
compelling reason to retire it. It seems mod_python development has
always occurred in fits and starts.

> For existing Python web applications which are bound to mod_python
> specific higher level handlers such as mod_python.publisher or
> mod_python.psp, the things do look a bit gloomy.

Probably true more for PSP than Publisher (depending on how much you
depend on some of its more esoteric features). I use Publisher quite a
lot, but in a way that conversion to WSGI is relatively easy.

> The Python web community is very much going towards WSGI as interface
> to web server. This allows for portability to different hosting
> solutions. Thus, look at being compatible with that.

No doubt.


From graham.dumpleton at gmail.com  Mon Feb  9 22:52:22 2009
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Feb  9 22:52:30 2009
Subject: [mod_python] req.user always returns None
In-Reply-To: <2AD6043C7DE1544D86FE37F8B7E68BD9015A97C4@admexchs1.admdom.harpercollege.edu>
References: <2AD6043C7DE1544D86FE37F8B7E68BD9015A97C2@admexchs1.admdom.harpercollege.edu>
	<88e286470902091534n62a88acao31390ba7f330320@mail.gmail.com>
	<2AD6043C7DE1544D86FE37F8B7E68BD9015A97C3@admexchs1.admdom.harpercollege.edu>
	<88e286470902091720m4509962y8c748c6307fb6a8f@mail.gmail.com>
	<2AD6043C7DE1544D86FE37F8B7E68BD9015A97C4@admexchs1.admdom.harpercollege.edu>
Message-ID: <88e286470902091952q24a9933dvc248b8da65dfd7e9@mail.gmail.com>

2009/2/10 Mitesh Shah <mshah@harpercollege.edu>:
> Sorry for the confusion.  Well it was initially a CGI and then I learned
> about mod_python.  Right now I haven't made any changes to the CGI until
> I learn how mod_python works.  And all I need is the username and not
> the full name.  When I tried -- os.environ["REMOTE_USER"] -- it never
> returned anything.  I think I'm just having a hard time understanding
> the logistics of mod_python.

If you are using os.environ["REMOTE_USER"] inside mod_python handler
it will not work. Only relevant to CGI scripts. Just making sure we
are talking about same thing here.

> I call an html and ask for authentication, this should set the cgi
> variable but since my python CGI is calling python (#!/usr/bin/python)
> separately, I don't think it can access the username from the initial
> authentication.

If you mean that the first line of your CGI script has that line, then
that is normal and how UNIX knows what interpreter to run for the
contents of the script.

If REMOTE_USER environment variable is not set for CGI script, then AD
authentication handler is either not setting 'user' correctly, or the
CGI script isn't located in the same Directory/Location context for
which the authentication was enabled.

What is the original Apache configuration block you are using for
authentication and where is the CGI script located?

Graham

> Which brought me mod_python.  Every example I see they change Apache's
> httpd.conf to point to the python script. And then this calls
> req.get_basic_auth_pw() and req.user and I am able to see the username.
> Basically I want the user to authenticate and be presented the html form
> and then post to my CGI(or soon mod_python) and then the python script
> would then grab the username via req.user.
>
> Thanks for you help so far.
>
> -Mitesh
>
> -----Original Message-----
> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
> Sent: Monday, February 09, 2009 7:21 PM
> To: Mitesh Shah
> Cc: mod_python@modpython.org
> Subject: Re: [mod_python] req.user always returns None
>
> 2009/2/10 Mitesh Shah <mshah@harpercollege.edu>:
>> I will take a look at mod_wsgi.  Anyway, looking at the initial post I
>> realized that pw = req.get_basic_auth_pw() came AFTER req.user.  I
> don't
>> know how many times I had read that this was incorrect and STILL did
>> it!!  Anyway, I got it to work with that change.  But this was all
> just
>> for testing.  But now I realized that I may not be able to use this
> with
>> what I want to accomplish.
>>
>> 1) Use apache Authorization via .htaccess (which connects to Active
>> Directory) -- Working
>> 2) After the user is authenticated I have a form (html) with two
> fields
>> that posts to a python script. -- partially working (cannot log
>> username)
>
> When you say script, what is it implemented as, CGI or mod_python?
>
> If CGI, then user should be available as REMOTE_USER environment
> variable. If mod_python then as req.user.
>
> If these don't work then the AD module you are using for
> authentication is broken in not setting 'user' in Apache request
> structure properly.
>
>> The reason I looked into mod_python was that I am trying to pass the
>> user's name from the initial login to my python script.  Any ideas on
>> how I could do this?
>
> Or are you after full name of user rather than a log in ID?
>
> Can you clarify a bit.
>
> Graham
>
>> Thanks,
>> Mitesh
>>
>> -----Original Message-----
>> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
>> Sent: Monday, February 09, 2009 5:35 PM
>> To: Mitesh Shah
>> Cc: mod_python@modpython.org
>> Subject: Re: [mod_python] req.user always returns None
>>
>> It is the authentication handlers responsibility, directly or
>> indirectly, to set req.user, it will not be set before the
>> authentication handler is called. Setting it is one of the things that
>> a correctly implement authentication handler should do.
>>
>> For the way you are doing things, req.user will only be set after:
>>
>>  pw = req.get_basic_auth_pw()
>>
>> is called. Ie., done as a side effect of that call.
>>
>> BTW, if you are new to mod_python, you might want to consider instead
>> using mod_wsgi, writing your application code as a WSGI application
>> and using mod_wsgi's much simpler to understand authentication
>> provider hooks where everything is done for you except for validating
>> the user credentials. For the latter see:
>>
>>  http://code.google.com/p/modwsgi/wiki/AccessControlMechanisms
>>
>> Graham
>>
>> 2009/2/10 Mitesh Shah <mshah@harpercollege.edu>:
>>> I am having some issues trying to req.user to return a username.  I
> am
>> very
>>> new to python and mod_python.  I happened upon this thread:
>>>
>>>
>>>
>>> http://osdir.com/ml/python.mod_python/2003-10/msg00092.html regarding
>> a
>>> similar issue.
>>>
>>>
>>>
>>> Anyway, even when I ran the code posted by "David Hancock" in the
> post
>> above
>>> I only got a "None" for the username in the error_log file.  I am
>> sending
>>> this in the URL:
>>>
>>> "http://localhost/python/mptest"
>>>
>>>
>>>
>>> Here is the test setup as it applies to me(basically unchanged).
>>>
>>>
>>>
>>> ******mptest.py*******
>>>
>>> from mod_python import apache
>>>
>>>
>>>
>>> def handler(req):
>>>
>>>         req.content_type = 'text/plain'
>>>
>>>         req.send_http_header()
>>>
>>>         req.write("Hello, world!")
>>>
>>>         return apache.OK
>>>
>>>
>>>
>>> def authenhandler(req):
>>>
>>>         user = req.user
>>>
>>>         pw = req.get_basic_auth_pw()
>>>
>>>         req.log_error(str(user) + ' ' + str(pw))
>>>
>>>         if user == "fred" and pw == "secret":
>>>
>>>                 return apache.OK
>>>
>>>         else:
>>>
>>>                 return apache.HTTP_UNAUTHORIZED
>>>
>>> *******mptest.py******
>>>
>>>
>>>
>>> *******httpd.conf******
>>>
>>> <Directory "/var/www/html/python">
>>>
>>>     AddHandler python-program .py
>>>
>>>     PythonHandler mptest
>>>
>>>     PythonAuthenHandler mptest
>>>
>>>     AuthType Basic
>>>
>>>     AuthName "mod_python restricted area"
>>>
>>>     require valid-user
>>>
>>>     PythonDebug On
>>>
>>> </Directory>
>>>
>>> ******httpd.conf*******
>>>
>>>
>>>
>>> *******error_log*******
>>>
>>> [Mon Feb 09 17:10:04 2009] [error] [client 127.0.0.1] None secret
>>>
>>> *******error_log*******
>>>
>>>
>>>
>>> After attempting to login I get a 401 page and then I am asked to
>> login
>>> again.
>>>
>>>
>>>
>>> Any help would be greatly appreciated!
>>>
>>>
>>>
>>> Thank you,
>>>
>>> Mitesh
>>>
>>>
>>>
>>> _______________________________________________
>>> Mod_python mailing list
>>> Mod_python@modpython.org
>>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>>
>>>
>>
>
From mshah at harpercollege.edu  Mon Feb  9 23:06:07 2009
From: mshah at harpercollege.edu (Mitesh Shah)
Date: Mon Feb  9 23:06:13 2009
Subject: [mod_python] req.user always returns None
In-Reply-To: <88e286470902091952q24a9933dvc248b8da65dfd7e9@mail.gmail.com>
References: <2AD6043C7DE1544D86FE37F8B7E68BD9015A97C2@admexchs1.admdom.harpercollege.edu>
	<88e286470902091534n62a88acao31390ba7f330320@mail.gmail.com>
	<2AD6043C7DE1544D86FE37F8B7E68BD9015A97C3@admexchs1.admdom.harpercollege.edu>
	<88e286470902091720m4509962y8c748c6307fb6a8f@mail.gmail.com>
	<2AD6043C7DE1544D86FE37F8B7E68BD9015A97C4@admexchs1.admdom.harpercollege.edu>
	<88e286470902091952q24a9933dvc248b8da65dfd7e9@mail.gmail.com>
Message-ID: <2AD6043C7DE1544D86FE37F8B7E68BD9015A97C5@admexchs1.admdom.harpercollege.edu>

>What is the original Apache configuration block you are using for
>authentication and where is the CGI script located?

Here is the conf block for the html directory (authentication dir):

****http.conf****
<Directory "/var/www/html">
	Options Indexes FollowSymLinks
	AllowOverride AuthConfig
	Order allow,deny
    	Allow from all
</Directory>
****http.conf****

Now the actual .htaccess and html files are in /var/www/html/gapps.

My python CGI is in /var/www/cgi-bin.


-----Original Message-----
From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com] 
Sent: Monday, February 09, 2009 9:52 PM
To: Mitesh Shah
Cc: mod_python@modpython.org
Subject: Re: [mod_python] req.user always returns None

2009/2/10 Mitesh Shah <mshah@harpercollege.edu>:
> Sorry for the confusion.  Well it was initially a CGI and then I
learned
> about mod_python.  Right now I haven't made any changes to the CGI
until
> I learn how mod_python works.  And all I need is the username and not
> the full name.  When I tried -- os.environ["REMOTE_USER"] -- it never
> returned anything.  I think I'm just having a hard time understanding
> the logistics of mod_python.

If you are using os.environ["REMOTE_USER"] inside mod_python handler
it will not work. Only relevant to CGI scripts. Just making sure we
are talking about same thing here.

> I call an html and ask for authentication, this should set the cgi
> variable but since my python CGI is calling python (#!/usr/bin/python)
> separately, I don't think it can access the username from the initial
> authentication.

If you mean that the first line of your CGI script has that line, then
that is normal and how UNIX knows what interpreter to run for the
contents of the script.

If REMOTE_USER environment variable is not set for CGI script, then AD
authentication handler is either not setting 'user' correctly, or the
CGI script isn't located in the same Directory/Location context for
which the authentication was enabled.

What is the original Apache configuration block you are using for
authentication and where is the CGI script located?

Graham

> Which brought me mod_python.  Every example I see they change Apache's
> httpd.conf to point to the python script. And then this calls
> req.get_basic_auth_pw() and req.user and I am able to see the
username.
> Basically I want the user to authenticate and be presented the html
form
> and then post to my CGI(or soon mod_python) and then the python script
> would then grab the username via req.user.
>
> Thanks for you help so far.
>
> -Mitesh
>
> -----Original Message-----
> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
> Sent: Monday, February 09, 2009 7:21 PM
> To: Mitesh Shah
> Cc: mod_python@modpython.org
> Subject: Re: [mod_python] req.user always returns None
>
> 2009/2/10 Mitesh Shah <mshah@harpercollege.edu>:
>> I will take a look at mod_wsgi.  Anyway, looking at the initial post
I
>> realized that pw = req.get_basic_auth_pw() came AFTER req.user.  I
> don't
>> know how many times I had read that this was incorrect and STILL did
>> it!!  Anyway, I got it to work with that change.  But this was all
> just
>> for testing.  But now I realized that I may not be able to use this
> with
>> what I want to accomplish.
>>
>> 1) Use apache Authorization via .htaccess (which connects to Active
>> Directory) -- Working
>> 2) After the user is authenticated I have a form (html) with two
> fields
>> that posts to a python script. -- partially working (cannot log
>> username)
>
> When you say script, what is it implemented as, CGI or mod_python?
>
> If CGI, then user should be available as REMOTE_USER environment
> variable. If mod_python then as req.user.
>
> If these don't work then the AD module you are using for
> authentication is broken in not setting 'user' in Apache request
> structure properly.
>
>> The reason I looked into mod_python was that I am trying to pass the
>> user's name from the initial login to my python script.  Any ideas on
>> how I could do this?
>
> Or are you after full name of user rather than a log in ID?
>
> Can you clarify a bit.
>
> Graham
>
>> Thanks,
>> Mitesh
>>
>> -----Original Message-----
>> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
>> Sent: Monday, February 09, 2009 5:35 PM
>> To: Mitesh Shah
>> Cc: mod_python@modpython.org
>> Subject: Re: [mod_python] req.user always returns None
>>
>> It is the authentication handlers responsibility, directly or
>> indirectly, to set req.user, it will not be set before the
>> authentication handler is called. Setting it is one of the things
that
>> a correctly implement authentication handler should do.
>>
>> For the way you are doing things, req.user will only be set after:
>>
>>  pw = req.get_basic_auth_pw()
>>
>> is called. Ie., done as a side effect of that call.
>>
>> BTW, if you are new to mod_python, you might want to consider instead
>> using mod_wsgi, writing your application code as a WSGI application
>> and using mod_wsgi's much simpler to understand authentication
>> provider hooks where everything is done for you except for validating
>> the user credentials. For the latter see:
>>
>>  http://code.google.com/p/modwsgi/wiki/AccessControlMechanisms
>>
>> Graham
>>
>> 2009/2/10 Mitesh Shah <mshah@harpercollege.edu>:
>>> I am having some issues trying to req.user to return a username.  I
> am
>> very
>>> new to python and mod_python.  I happened upon this thread:
>>>
>>>
>>>
>>> http://osdir.com/ml/python.mod_python/2003-10/msg00092.html
regarding
>> a
>>> similar issue.
>>>
>>>
>>>
>>> Anyway, even when I ran the code posted by "David Hancock" in the
> post
>> above
>>> I only got a "None" for the username in the error_log file.  I am
>> sending
>>> this in the URL:
>>>
>>> "http://localhost/python/mptest"
>>>
>>>
>>>
>>> Here is the test setup as it applies to me(basically unchanged).
>>>
>>>
>>>
>>> ******mptest.py*******
>>>
>>> from mod_python import apache
>>>
>>>
>>>
>>> def handler(req):
>>>
>>>         req.content_type = 'text/plain'
>>>
>>>         req.send_http_header()
>>>
>>>         req.write("Hello, world!")
>>>
>>>         return apache.OK
>>>
>>>
>>>
>>> def authenhandler(req):
>>>
>>>         user = req.user
>>>
>>>         pw = req.get_basic_auth_pw()
>>>
>>>         req.log_error(str(user) + ' ' + str(pw))
>>>
>>>         if user == "fred" and pw == "secret":
>>>
>>>                 return apache.OK
>>>
>>>         else:
>>>
>>>                 return apache.HTTP_UNAUTHORIZED
>>>
>>> *******mptest.py******
>>>
>>>
>>>
>>> *******httpd.conf******
>>>
>>> <Directory "/var/www/html/python">
>>>
>>>     AddHandler python-program .py
>>>
>>>     PythonHandler mptest
>>>
>>>     PythonAuthenHandler mptest
>>>
>>>     AuthType Basic
>>>
>>>     AuthName "mod_python restricted area"
>>>
>>>     require valid-user
>>>
>>>     PythonDebug On
>>>
>>> </Directory>
>>>
>>> ******httpd.conf*******
>>>
>>>
>>>
>>> *******error_log*******
>>>
>>> [Mon Feb 09 17:10:04 2009] [error] [client 127.0.0.1] None secret
>>>
>>> *******error_log*******
>>>
>>>
>>>
>>> After attempting to login I get a 401 page and then I am asked to
>> login
>>> again.
>>>
>>>
>>>
>>> Any help would be greatly appreciated!
>>>
>>>
>>>
>>> Thank you,
>>>
>>> Mitesh
>>>
>>>
>>>
>>> _______________________________________________
>>> Mod_python mailing list
>>> Mod_python@modpython.org
>>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>>
>>>
>>
>

From graham.dumpleton at gmail.com  Mon Feb  9 23:18:28 2009
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Feb  9 23:18:34 2009
Subject: [mod_python] req.user always returns None
In-Reply-To: <2AD6043C7DE1544D86FE37F8B7E68BD9015A97C5@admexchs1.admdom.harpercollege.edu>
References: <2AD6043C7DE1544D86FE37F8B7E68BD9015A97C2@admexchs1.admdom.harpercollege.edu>
	<88e286470902091534n62a88acao31390ba7f330320@mail.gmail.com>
	<2AD6043C7DE1544D86FE37F8B7E68BD9015A97C3@admexchs1.admdom.harpercollege.edu>
	<88e286470902091720m4509962y8c748c6307fb6a8f@mail.gmail.com>
	<2AD6043C7DE1544D86FE37F8B7E68BD9015A97C4@admexchs1.admdom.harpercollege.edu>
	<88e286470902091952q24a9933dvc248b8da65dfd7e9@mail.gmail.com>
	<2AD6043C7DE1544D86FE37F8B7E68BD9015A97C5@admexchs1.admdom.harpercollege.edu>
Message-ID: <88e286470902092018k74fcd2a1n984e23f5547dae74@mail.gmail.com>

2009/2/10 Mitesh Shah <mshah@harpercollege.edu>:
>>What is the original Apache configuration block you are using for
>>authentication and where is the CGI script located?
>
> Here is the conf block for the html directory (authentication dir):
>
> ****http.conf****
> <Directory "/var/www/html">
>        Options Indexes FollowSymLinks
>        AllowOverride AuthConfig
>        Order allow,deny
>        Allow from all
> </Directory>
> ****http.conf****
>
> Now the actual .htaccess and html files are in /var/www/html/gapps.
>
> My python CGI is in /var/www/cgi-bin.

But where was AuthType/AuthName etc when trying to use CGI scripts?

If that wasn't defined such that it covered directory/location CGI
script access from/as, then authentication wouldn't have been applied
for CGI script.

Graham

> -----Original Message-----
> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
> Sent: Monday, February 09, 2009 9:52 PM
> To: Mitesh Shah
> Cc: mod_python@modpython.org
> Subject: Re: [mod_python] req.user always returns None
>
> 2009/2/10 Mitesh Shah <mshah@harpercollege.edu>:
>> Sorry for the confusion.  Well it was initially a CGI and then I
> learned
>> about mod_python.  Right now I haven't made any changes to the CGI
> until
>> I learn how mod_python works.  And all I need is the username and not
>> the full name.  When I tried -- os.environ["REMOTE_USER"] -- it never
>> returned anything.  I think I'm just having a hard time understanding
>> the logistics of mod_python.
>
> If you are using os.environ["REMOTE_USER"] inside mod_python handler
> it will not work. Only relevant to CGI scripts. Just making sure we
> are talking about same thing here.
>
>> I call an html and ask for authentication, this should set the cgi
>> variable but since my python CGI is calling python (#!/usr/bin/python)
>> separately, I don't think it can access the username from the initial
>> authentication.
>
> If you mean that the first line of your CGI script has that line, then
> that is normal and how UNIX knows what interpreter to run for the
> contents of the script.
>
> If REMOTE_USER environment variable is not set for CGI script, then AD
> authentication handler is either not setting 'user' correctly, or the
> CGI script isn't located in the same Directory/Location context for
> which the authentication was enabled.
>
> What is the original Apache configuration block you are using for
> authentication and where is the CGI script located?
>
> Graham
>
>> Which brought me mod_python.  Every example I see they change Apache's
>> httpd.conf to point to the python script. And then this calls
>> req.get_basic_auth_pw() and req.user and I am able to see the
> username.
>> Basically I want the user to authenticate and be presented the html
> form
>> and then post to my CGI(or soon mod_python) and then the python script
>> would then grab the username via req.user.
>>
>> Thanks for you help so far.
>>
>> -Mitesh
>>
>> -----Original Message-----
>> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
>> Sent: Monday, February 09, 2009 7:21 PM
>> To: Mitesh Shah
>> Cc: mod_python@modpython.org
>> Subject: Re: [mod_python] req.user always returns None
>>
>> 2009/2/10 Mitesh Shah <mshah@harpercollege.edu>:
>>> I will take a look at mod_wsgi.  Anyway, looking at the initial post
> I
>>> realized that pw = req.get_basic_auth_pw() came AFTER req.user.  I
>> don't
>>> know how many times I had read that this was incorrect and STILL did
>>> it!!  Anyway, I got it to work with that change.  But this was all
>> just
>>> for testing.  But now I realized that I may not be able to use this
>> with
>>> what I want to accomplish.
>>>
>>> 1) Use apache Authorization via .htaccess (which connects to Active
>>> Directory) -- Working
>>> 2) After the user is authenticated I have a form (html) with two
>> fields
>>> that posts to a python script. -- partially working (cannot log
>>> username)
>>
>> When you say script, what is it implemented as, CGI or mod_python?
>>
>> If CGI, then user should be available as REMOTE_USER environment
>> variable. If mod_python then as req.user.
>>
>> If these don't work then the AD module you are using for
>> authentication is broken in not setting 'user' in Apache request
>> structure properly.
>>
>>> The reason I looked into mod_python was that I am trying to pass the
>>> user's name from the initial login to my python script.  Any ideas on
>>> how I could do this?
>>
>> Or are you after full name of user rather than a log in ID?
>>
>> Can you clarify a bit.
>>
>> Graham
>>
>>> Thanks,
>>> Mitesh
>>>
>>> -----Original Message-----
>>> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
>>> Sent: Monday, February 09, 2009 5:35 PM
>>> To: Mitesh Shah
>>> Cc: mod_python@modpython.org
>>> Subject: Re: [mod_python] req.user always returns None
>>>
>>> It is the authentication handlers responsibility, directly or
>>> indirectly, to set req.user, it will not be set before the
>>> authentication handler is called. Setting it is one of the things
> that
>>> a correctly implement authentication handler should do.
>>>
>>> For the way you are doing things, req.user will only be set after:
>>>
>>>  pw = req.get_basic_auth_pw()
>>>
>>> is called. Ie., done as a side effect of that call.
>>>
>>> BTW, if you are new to mod_python, you might want to consider instead
>>> using mod_wsgi, writing your application code as a WSGI application
>>> and using mod_wsgi's much simpler to understand authentication
>>> provider hooks where everything is done for you except for validating
>>> the user credentials. For the latter see:
>>>
>>>  http://code.google.com/p/modwsgi/wiki/AccessControlMechanisms
>>>
>>> Graham
>>>
>>> 2009/2/10 Mitesh Shah <mshah@harpercollege.edu>:
>>>> I am having some issues trying to req.user to return a username.  I
>> am
>>> very
>>>> new to python and mod_python.  I happened upon this thread:
>>>>
>>>>
>>>>
>>>> http://osdir.com/ml/python.mod_python/2003-10/msg00092.html
> regarding
>>> a
>>>> similar issue.
>>>>
>>>>
>>>>
>>>> Anyway, even when I ran the code posted by "David Hancock" in the
>> post
>>> above
>>>> I only got a "None" for the username in the error_log file.  I am
>>> sending
>>>> this in the URL:
>>>>
>>>> "http://localhost/python/mptest"
>>>>
>>>>
>>>>
>>>> Here is the test setup as it applies to me(basically unchanged).
>>>>
>>>>
>>>>
>>>> ******mptest.py*******
>>>>
>>>> from mod_python import apache
>>>>
>>>>
>>>>
>>>> def handler(req):
>>>>
>>>>         req.content_type = 'text/plain'
>>>>
>>>>         req.send_http_header()
>>>>
>>>>         req.write("Hello, world!")
>>>>
>>>>         return apache.OK
>>>>
>>>>
>>>>
>>>> def authenhandler(req):
>>>>
>>>>         user = req.user
>>>>
>>>>         pw = req.get_basic_auth_pw()
>>>>
>>>>         req.log_error(str(user) + ' ' + str(pw))
>>>>
>>>>         if user == "fred" and pw == "secret":
>>>>
>>>>                 return apache.OK
>>>>
>>>>         else:
>>>>
>>>>                 return apache.HTTP_UNAUTHORIZED
>>>>
>>>> *******mptest.py******
>>>>
>>>>
>>>>
>>>> *******httpd.conf******
>>>>
>>>> <Directory "/var/www/html/python">
>>>>
>>>>     AddHandler python-program .py
>>>>
>>>>     PythonHandler mptest
>>>>
>>>>     PythonAuthenHandler mptest
>>>>
>>>>     AuthType Basic
>>>>
>>>>     AuthName "mod_python restricted area"
>>>>
>>>>     require valid-user
>>>>
>>>>     PythonDebug On
>>>>
>>>> </Directory>
>>>>
>>>> ******httpd.conf*******
>>>>
>>>>
>>>>
>>>> *******error_log*******
>>>>
>>>> [Mon Feb 09 17:10:04 2009] [error] [client 127.0.0.1] None secret
>>>>
>>>> *******error_log*******
>>>>
>>>>
>>>>
>>>> After attempting to login I get a 401 page and then I am asked to
>>> login
>>>> again.
>>>>
>>>>
>>>>
>>>> Any help would be greatly appreciated!
>>>>
>>>>
>>>>
>>>> Thank you,
>>>>
>>>> Mitesh
>>>>
>>>>
>>>>
>>>> _______________________________________________
>>>> Mod_python mailing list
>>>> Mod_python@modpython.org
>>>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>>>
>>>>
>>>
>>
>
From mshah at harpercollege.edu  Mon Feb  9 23:27:52 2009
From: mshah at harpercollege.edu (Mitesh Shah)
Date: Mon Feb  9 23:28:00 2009
Subject: [mod_python] req.user always returns None
In-Reply-To: <88e286470902092018k74fcd2a1n984e23f5547dae74@mail.gmail.com>
References: <2AD6043C7DE1544D86FE37F8B7E68BD9015A97C2@admexchs1.admdom.harpercollege.edu>
	<88e286470902091534n62a88acao31390ba7f330320@mail.gmail.com>
	<2AD6043C7DE1544D86FE37F8B7E68BD9015A97C3@admexchs1.admdom.harpercollege.edu>
	<88e286470902091720m4509962y8c748c6307fb6a8f@mail.gmail.com>
	<2AD6043C7DE1544D86FE37F8B7E68BD9015A97C4@admexchs1.admdom.harpercollege.edu>
	<88e286470902091952q24a9933dvc248b8da65dfd7e9@mail.gmail.com>
	<2AD6043C7DE1544D86FE37F8B7E68BD9015A97C5@admexchs1.admdom.harpercollege.edu>
	<88e286470902092018k74fcd2a1n984e23f5547dae74@mail.gmail.com>
Message-ID: <2AD6043C7DE1544D86FE37F8B7E68BD9015A97C6@admexchs1.admdom.harpercollege.edu>

The AuthType/AuthName are in the .htaccess file inside
/var/www/html/gapps where the html is served:

****.htaccess****
AuthName "AD Authorize Me!"
AuthType Basic
...
****.htaccess****

If I put an .htaccess file in the /var/www/cgi-bin dir the user will get
asked for authentication a second time which I don't want.  Am I doing
something wrong with this setup?

****http.conf for cgi-bin****
<Directory "/var/www/cgi-bin">
    AllowOverride AuthConfig
    Options None
    Order allow,deny
    Allow from all
</Directory>
****http.conf for cgi-bin****

-----Original Message-----
From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com] 
Sent: Monday, February 09, 2009 10:18 PM
To: Mitesh Shah
Cc: mod_python@modpython.org
Subject: Re: [mod_python] req.user always returns None

2009/2/10 Mitesh Shah <mshah@harpercollege.edu>:
>>What is the original Apache configuration block you are using for
>>authentication and where is the CGI script located?
>
> Here is the conf block for the html directory (authentication dir):
>
> ****http.conf****
> <Directory "/var/www/html">
>        Options Indexes FollowSymLinks
>        AllowOverride AuthConfig
>        Order allow,deny
>        Allow from all
> </Directory>
> ****http.conf****
>
> Now the actual .htaccess and html files are in /var/www/html/gapps.
>
> My python CGI is in /var/www/cgi-bin.

But where was AuthType/AuthName etc when trying to use CGI scripts?

If that wasn't defined such that it covered directory/location CGI
script access from/as, then authentication wouldn't have been applied
for CGI script.

Graham

> -----Original Message-----
> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
> Sent: Monday, February 09, 2009 9:52 PM
> To: Mitesh Shah
> Cc: mod_python@modpython.org
> Subject: Re: [mod_python] req.user always returns None
>
> 2009/2/10 Mitesh Shah <mshah@harpercollege.edu>:
>> Sorry for the confusion.  Well it was initially a CGI and then I
> learned
>> about mod_python.  Right now I haven't made any changes to the CGI
> until
>> I learn how mod_python works.  And all I need is the username and not
>> the full name.  When I tried -- os.environ["REMOTE_USER"] -- it never
>> returned anything.  I think I'm just having a hard time understanding
>> the logistics of mod_python.
>
> If you are using os.environ["REMOTE_USER"] inside mod_python handler
> it will not work. Only relevant to CGI scripts. Just making sure we
> are talking about same thing here.
>
>> I call an html and ask for authentication, this should set the cgi
>> variable but since my python CGI is calling python
(#!/usr/bin/python)
>> separately, I don't think it can access the username from the initial
>> authentication.
>
> If you mean that the first line of your CGI script has that line, then
> that is normal and how UNIX knows what interpreter to run for the
> contents of the script.
>
> If REMOTE_USER environment variable is not set for CGI script, then AD
> authentication handler is either not setting 'user' correctly, or the
> CGI script isn't located in the same Directory/Location context for
> which the authentication was enabled.
>
> What is the original Apache configuration block you are using for
> authentication and where is the CGI script located?
>
> Graham
>
>> Which brought me mod_python.  Every example I see they change
Apache's
>> httpd.conf to point to the python script. And then this calls
>> req.get_basic_auth_pw() and req.user and I am able to see the
> username.
>> Basically I want the user to authenticate and be presented the html
> form
>> and then post to my CGI(or soon mod_python) and then the python
script
>> would then grab the username via req.user.
>>
>> Thanks for you help so far.
>>
>> -Mitesh
>>
>> -----Original Message-----
>> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
>> Sent: Monday, February 09, 2009 7:21 PM
>> To: Mitesh Shah
>> Cc: mod_python@modpython.org
>> Subject: Re: [mod_python] req.user always returns None
>>
>> 2009/2/10 Mitesh Shah <mshah@harpercollege.edu>:
>>> I will take a look at mod_wsgi.  Anyway, looking at the initial post
> I
>>> realized that pw = req.get_basic_auth_pw() came AFTER req.user.  I
>> don't
>>> know how many times I had read that this was incorrect and STILL did
>>> it!!  Anyway, I got it to work with that change.  But this was all
>> just
>>> for testing.  But now I realized that I may not be able to use this
>> with
>>> what I want to accomplish.
>>>
>>> 1) Use apache Authorization via .htaccess (which connects to Active
>>> Directory) -- Working
>>> 2) After the user is authenticated I have a form (html) with two
>> fields
>>> that posts to a python script. -- partially working (cannot log
>>> username)
>>
>> When you say script, what is it implemented as, CGI or mod_python?
>>
>> If CGI, then user should be available as REMOTE_USER environment
>> variable. If mod_python then as req.user.
>>
>> If these don't work then the AD module you are using for
>> authentication is broken in not setting 'user' in Apache request
>> structure properly.
>>
>>> The reason I looked into mod_python was that I am trying to pass the
>>> user's name from the initial login to my python script.  Any ideas
on
>>> how I could do this?
>>
>> Or are you after full name of user rather than a log in ID?
>>
>> Can you clarify a bit.
>>
>> Graham
>>
>>> Thanks,
>>> Mitesh
>>>
>>> -----Original Message-----
>>> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
>>> Sent: Monday, February 09, 2009 5:35 PM
>>> To: Mitesh Shah
>>> Cc: mod_python@modpython.org
>>> Subject: Re: [mod_python] req.user always returns None
>>>
>>> It is the authentication handlers responsibility, directly or
>>> indirectly, to set req.user, it will not be set before the
>>> authentication handler is called. Setting it is one of the things
> that
>>> a correctly implement authentication handler should do.
>>>
>>> For the way you are doing things, req.user will only be set after:
>>>
>>>  pw = req.get_basic_auth_pw()
>>>
>>> is called. Ie., done as a side effect of that call.
>>>
>>> BTW, if you are new to mod_python, you might want to consider
instead
>>> using mod_wsgi, writing your application code as a WSGI application
>>> and using mod_wsgi's much simpler to understand authentication
>>> provider hooks where everything is done for you except for
validating
>>> the user credentials. For the latter see:
>>>
>>>  http://code.google.com/p/modwsgi/wiki/AccessControlMechanisms
>>>
>>> Graham
>>>
>>> 2009/2/10 Mitesh Shah <mshah@harpercollege.edu>:
>>>> I am having some issues trying to req.user to return a username.  I
>> am
>>> very
>>>> new to python and mod_python.  I happened upon this thread:
>>>>
>>>>
>>>>
>>>> http://osdir.com/ml/python.mod_python/2003-10/msg00092.html
> regarding
>>> a
>>>> similar issue.
>>>>
>>>>
>>>>
>>>> Anyway, even when I ran the code posted by "David Hancock" in the
>> post
>>> above
>>>> I only got a "None" for the username in the error_log file.  I am
>>> sending
>>>> this in the URL:
>>>>
>>>> "http://localhost/python/mptest"
>>>>
>>>>
>>>>
>>>> Here is the test setup as it applies to me(basically unchanged).
>>>>
>>>>
>>>>
>>>> ******mptest.py*******
>>>>
>>>> from mod_python import apache
>>>>
>>>>
>>>>
>>>> def handler(req):
>>>>
>>>>         req.content_type = 'text/plain'
>>>>
>>>>         req.send_http_header()
>>>>
>>>>         req.write("Hello, world!")
>>>>
>>>>         return apache.OK
>>>>
>>>>
>>>>
>>>> def authenhandler(req):
>>>>
>>>>         user = req.user
>>>>
>>>>         pw = req.get_basic_auth_pw()
>>>>
>>>>         req.log_error(str(user) + ' ' + str(pw))
>>>>
>>>>         if user == "fred" and pw == "secret":
>>>>
>>>>                 return apache.OK
>>>>
>>>>         else:
>>>>
>>>>                 return apache.HTTP_UNAUTHORIZED
>>>>
>>>> *******mptest.py******
>>>>
>>>>
>>>>
>>>> *******httpd.conf******
>>>>
>>>> <Directory "/var/www/html/python">
>>>>
>>>>     AddHandler python-program .py
>>>>
>>>>     PythonHandler mptest
>>>>
>>>>     PythonAuthenHandler mptest
>>>>
>>>>     AuthType Basic
>>>>
>>>>     AuthName "mod_python restricted area"
>>>>
>>>>     require valid-user
>>>>
>>>>     PythonDebug On
>>>>
>>>> </Directory>
>>>>
>>>> ******httpd.conf*******
>>>>
>>>>
>>>>
>>>> *******error_log*******
>>>>
>>>> [Mon Feb 09 17:10:04 2009] [error] [client 127.0.0.1] None secret
>>>>
>>>> *******error_log*******
>>>>
>>>>
>>>>
>>>> After attempting to login I get a 401 page and then I am asked to
>>> login
>>>> again.
>>>>
>>>>
>>>>
>>>> Any help would be greatly appreciated!
>>>>
>>>>
>>>>
>>>> Thank you,
>>>>
>>>> Mitesh
>>>>
>>>>
>>>>
>>>> _______________________________________________
>>>> Mod_python mailing list
>>>> Mod_python@modpython.org
>>>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>>>
>>>>
>>>
>>
>

From graham.dumpleton at gmail.com  Mon Feb  9 23:33:17 2009
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Feb  9 23:33:22 2009
Subject: [mod_python] req.user always returns None
In-Reply-To: <2AD6043C7DE1544D86FE37F8B7E68BD9015A97C6@admexchs1.admdom.harpercollege.edu>
References: <2AD6043C7DE1544D86FE37F8B7E68BD9015A97C2@admexchs1.admdom.harpercollege.edu>
	<88e286470902091534n62a88acao31390ba7f330320@mail.gmail.com>
	<2AD6043C7DE1544D86FE37F8B7E68BD9015A97C3@admexchs1.admdom.harpercollege.edu>
	<88e286470902091720m4509962y8c748c6307fb6a8f@mail.gmail.com>
	<2AD6043C7DE1544D86FE37F8B7E68BD9015A97C4@admexchs1.admdom.harpercollege.edu>
	<88e286470902091952q24a9933dvc248b8da65dfd7e9@mail.gmail.com>
	<2AD6043C7DE1544D86FE37F8B7E68BD9015A97C5@admexchs1.admdom.harpercollege.edu>
	<88e286470902092018k74fcd2a1n984e23f5547dae74@mail.gmail.com>
	<2AD6043C7DE1544D86FE37F8B7E68BD9015A97C6@admexchs1.admdom.harpercollege.edu>
Message-ID: <88e286470902092033j5c638f7ajb87eda7b0dfefa2@mail.gmail.com>

2009/2/10 Mitesh Shah <mshah@harpercollege.edu>:
> The AuthType/AuthName are in the .htaccess file inside
> /var/www/html/gapps where the html is served:
>
> ****.htaccess****
> AuthName "AD Authorize Me!"
> AuthType Basic
> ...
> ****.htaccess****
>
> If I put an .htaccess file in the /var/www/cgi-bin dir the user will get
> asked for authentication a second time which I don't want.

They would not be asked of the user a second time, the browser will
realise that it has already supplied credentials for 'AD Authorize
Me!' AuthName zone and automatically supply them when server says it
needs them. You just need to ensure that Auth* directives are same for
each area.

It is because you don't have AuthName etc defined for CGI script
location that it isn't seeing REMOTE_USER in its environment.

Graham

> Am I doing
> something wrong with this setup?
>
> ****http.conf for cgi-bin****
> <Directory "/var/www/cgi-bin">
>    AllowOverride AuthConfig
>    Options None
>    Order allow,deny
>    Allow from all
> </Directory>
> ****http.conf for cgi-bin****
>
> -----Original Message-----
> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
> Sent: Monday, February 09, 2009 10:18 PM
> To: Mitesh Shah
> Cc: mod_python@modpython.org
> Subject: Re: [mod_python] req.user always returns None
>
> 2009/2/10 Mitesh Shah <mshah@harpercollege.edu>:
>>>What is the original Apache configuration block you are using for
>>>authentication and where is the CGI script located?
>>
>> Here is the conf block for the html directory (authentication dir):
>>
>> ****http.conf****
>> <Directory "/var/www/html">
>>        Options Indexes FollowSymLinks
>>        AllowOverride AuthConfig
>>        Order allow,deny
>>        Allow from all
>> </Directory>
>> ****http.conf****
>>
>> Now the actual .htaccess and html files are in /var/www/html/gapps.
>>
>> My python CGI is in /var/www/cgi-bin.
>
> But where was AuthType/AuthName etc when trying to use CGI scripts?
>
> If that wasn't defined such that it covered directory/location CGI
> script access from/as, then authentication wouldn't have been applied
> for CGI script.
>
> Graham
>
>> -----Original Message-----
>> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
>> Sent: Monday, February 09, 2009 9:52 PM
>> To: Mitesh Shah
>> Cc: mod_python@modpython.org
>> Subject: Re: [mod_python] req.user always returns None
>>
>> 2009/2/10 Mitesh Shah <mshah@harpercollege.edu>:
>>> Sorry for the confusion.  Well it was initially a CGI and then I
>> learned
>>> about mod_python.  Right now I haven't made any changes to the CGI
>> until
>>> I learn how mod_python works.  And all I need is the username and not
>>> the full name.  When I tried -- os.environ["REMOTE_USER"] -- it never
>>> returned anything.  I think I'm just having a hard time understanding
>>> the logistics of mod_python.
>>
>> If you are using os.environ["REMOTE_USER"] inside mod_python handler
>> it will not work. Only relevant to CGI scripts. Just making sure we
>> are talking about same thing here.
>>
>>> I call an html and ask for authentication, this should set the cgi
>>> variable but since my python CGI is calling python
> (#!/usr/bin/python)
>>> separately, I don't think it can access the username from the initial
>>> authentication.
>>
>> If you mean that the first line of your CGI script has that line, then
>> that is normal and how UNIX knows what interpreter to run for the
>> contents of the script.
>>
>> If REMOTE_USER environment variable is not set for CGI script, then AD
>> authentication handler is either not setting 'user' correctly, or the
>> CGI script isn't located in the same Directory/Location context for
>> which the authentication was enabled.
>>
>> What is the original Apache configuration block you are using for
>> authentication and where is the CGI script located?
>>
>> Graham
>>
>>> Which brought me mod_python.  Every example I see they change
> Apache's
>>> httpd.conf to point to the python script. And then this calls
>>> req.get_basic_auth_pw() and req.user and I am able to see the
>> username.
>>> Basically I want the user to authenticate and be presented the html
>> form
>>> and then post to my CGI(or soon mod_python) and then the python
> script
>>> would then grab the username via req.user.
>>>
>>> Thanks for you help so far.
>>>
>>> -Mitesh
>>>
>>> -----Original Message-----
>>> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
>>> Sent: Monday, February 09, 2009 7:21 PM
>>> To: Mitesh Shah
>>> Cc: mod_python@modpython.org
>>> Subject: Re: [mod_python] req.user always returns None
>>>
>>> 2009/2/10 Mitesh Shah <mshah@harpercollege.edu>:
>>>> I will take a look at mod_wsgi.  Anyway, looking at the initial post
>> I
>>>> realized that pw = req.get_basic_auth_pw() came AFTER req.user.  I
>>> don't
>>>> know how many times I had read that this was incorrect and STILL did
>>>> it!!  Anyway, I got it to work with that change.  But this was all
>>> just
>>>> for testing.  But now I realized that I may not be able to use this
>>> with
>>>> what I want to accomplish.
>>>>
>>>> 1) Use apache Authorization via .htaccess (which connects to Active
>>>> Directory) -- Working
>>>> 2) After the user is authenticated I have a form (html) with two
>>> fields
>>>> that posts to a python script. -- partially working (cannot log
>>>> username)
>>>
>>> When you say script, what is it implemented as, CGI or mod_python?
>>>
>>> If CGI, then user should be available as REMOTE_USER environment
>>> variable. If mod_python then as req.user.
>>>
>>> If these don't work then the AD module you are using for
>>> authentication is broken in not setting 'user' in Apache request
>>> structure properly.
>>>
>>>> The reason I looked into mod_python was that I am trying to pass the
>>>> user's name from the initial login to my python script.  Any ideas
> on
>>>> how I could do this?
>>>
>>> Or are you after full name of user rather than a log in ID?
>>>
>>> Can you clarify a bit.
>>>
>>> Graham
>>>
>>>> Thanks,
>>>> Mitesh
>>>>
>>>> -----Original Message-----
>>>> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
>>>> Sent: Monday, February 09, 2009 5:35 PM
>>>> To: Mitesh Shah
>>>> Cc: mod_python@modpython.org
>>>> Subject: Re: [mod_python] req.user always returns None
>>>>
>>>> It is the authentication handlers responsibility, directly or
>>>> indirectly, to set req.user, it will not be set before the
>>>> authentication handler is called. Setting it is one of the things
>> that
>>>> a correctly implement authentication handler should do.
>>>>
>>>> For the way you are doing things, req.user will only be set after:
>>>>
>>>>  pw = req.get_basic_auth_pw()
>>>>
>>>> is called. Ie., done as a side effect of that call.
>>>>
>>>> BTW, if you are new to mod_python, you might want to consider
> instead
>>>> using mod_wsgi, writing your application code as a WSGI application
>>>> and using mod_wsgi's much simpler to understand authentication
>>>> provider hooks where everything is done for you except for
> validating
>>>> the user credentials. For the latter see:
>>>>
>>>>  http://code.google.com/p/modwsgi/wiki/AccessControlMechanisms
>>>>
>>>> Graham
>>>>
>>>> 2009/2/10 Mitesh Shah <mshah@harpercollege.edu>:
>>>>> I am having some issues trying to req.user to return a username.  I
>>> am
>>>> very
>>>>> new to python and mod_python.  I happened upon this thread:
>>>>>
>>>>>
>>>>>
>>>>> http://osdir.com/ml/python.mod_python/2003-10/msg00092.html
>> regarding
>>>> a
>>>>> similar issue.
>>>>>
>>>>>
>>>>>
>>>>> Anyway, even when I ran the code posted by "David Hancock" in the
>>> post
>>>> above
>>>>> I only got a "None" for the username in the error_log file.  I am
>>>> sending
>>>>> this in the URL:
>>>>>
>>>>> "http://localhost/python/mptest"
>>>>>
>>>>>
>>>>>
>>>>> Here is the test setup as it applies to me(basically unchanged).
>>>>>
>>>>>
>>>>>
>>>>> ******mptest.py*******
>>>>>
>>>>> from mod_python import apache
>>>>>
>>>>>
>>>>>
>>>>> def handler(req):
>>>>>
>>>>>         req.content_type = 'text/plain'
>>>>>
>>>>>         req.send_http_header()
>>>>>
>>>>>         req.write("Hello, world!")
>>>>>
>>>>>         return apache.OK
>>>>>
>>>>>
>>>>>
>>>>> def authenhandler(req):
>>>>>
>>>>>         user = req.user
>>>>>
>>>>>         pw = req.get_basic_auth_pw()
>>>>>
>>>>>         req.log_error(str(user) + ' ' + str(pw))
>>>>>
>>>>>         if user == "fred" and pw == "secret":
>>>>>
>>>>>                 return apache.OK
>>>>>
>>>>>         else:
>>>>>
>>>>>                 return apache.HTTP_UNAUTHORIZED
>>>>>
>>>>> *******mptest.py******
>>>>>
>>>>>
>>>>>
>>>>> *******httpd.conf******
>>>>>
>>>>> <Directory "/var/www/html/python">
>>>>>
>>>>>     AddHandler python-program .py
>>>>>
>>>>>     PythonHandler mptest
>>>>>
>>>>>     PythonAuthenHandler mptest
>>>>>
>>>>>     AuthType Basic
>>>>>
>>>>>     AuthName "mod_python restricted area"
>>>>>
>>>>>     require valid-user
>>>>>
>>>>>     PythonDebug On
>>>>>
>>>>> </Directory>
>>>>>
>>>>> ******httpd.conf*******
>>>>>
>>>>>
>>>>>
>>>>> *******error_log*******
>>>>>
>>>>> [Mon Feb 09 17:10:04 2009] [error] [client 127.0.0.1] None secret
>>>>>
>>>>> *******error_log*******
>>>>>
>>>>>
>>>>>
>>>>> After attempting to login I get a 401 page and then I am asked to
>>>> login
>>>>> again.
>>>>>
>>>>>
>>>>>
>>>>> Any help would be greatly appreciated!
>>>>>
>>>>>
>>>>>
>>>>> Thank you,
>>>>>
>>>>> Mitesh
>>>>>
>>>>>
>>>>>
>>>>> _______________________________________________
>>>>> Mod_python mailing list
>>>>> Mod_python@modpython.org
>>>>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>>>>
>>>>>
>>>>
>>>
>>
>
From mshah at harpercollege.edu  Mon Feb  9 23:52:16 2009
From: mshah at harpercollege.edu (Mitesh Shah)
Date: Mon Feb  9 23:52:29 2009
Subject: [mod_python] req.user always returns None
In-Reply-To: <88e286470902092033j5c638f7ajb87eda7b0dfefa2@mail.gmail.com>
References: <2AD6043C7DE1544D86FE37F8B7E68BD9015A97C2@admexchs1.admdom.harpercollege.edu>
	<88e286470902091534n62a88acao31390ba7f330320@mail.gmail.com>
	<2AD6043C7DE1544D86FE37F8B7E68BD9015A97C3@admexchs1.admdom.harpercollege.edu>
	<88e286470902091720m4509962y8c748c6307fb6a8f@mail.gmail.com>
	<2AD6043C7DE1544D86FE37F8B7E68BD9015A97C4@admexchs1.admdom.harpercollege.edu>
	<88e286470902091952q24a9933dvc248b8da65dfd7e9@mail.gmail.com>
	<2AD6043C7DE1544D86FE37F8B7E68BD9015A97C5@admexchs1.admdom.harpercollege.edu>
	<88e286470902092018k74fcd2a1n984e23f5547dae74@mail.gmail.com>
	<2AD6043C7DE1544D86FE37F8B7E68BD9015A97C6@admexchs1.admdom.harpercollege.edu>
	<88e286470902092033j5c638f7ajb87eda7b0dfefa2@mail.gmail.com>
Message-ID: <2AD6043C7DE1544D86FE37F8B7E68BD9015A97C7@admexchs1.admdom.harpercollege.edu>

Me<----idiot!  I got it...thank you sooooo much for your help. And I
think I'm still going to keep learning mod_python and also try to take a
look at mod_wsgi.

-Mitesh

-----Original Message-----
From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com] 
Sent: Monday, February 09, 2009 10:33 PM
To: Mitesh Shah
Cc: mod_python@modpython.org
Subject: Re: [mod_python] req.user always returns None

2009/2/10 Mitesh Shah <mshah@harpercollege.edu>:
> The AuthType/AuthName are in the .htaccess file inside
> /var/www/html/gapps where the html is served:
>
> ****.htaccess****
> AuthName "AD Authorize Me!"
> AuthType Basic
> ...
> ****.htaccess****
>
> If I put an .htaccess file in the /var/www/cgi-bin dir the user will
get
> asked for authentication a second time which I don't want.

They would not be asked of the user a second time, the browser will
realise that it has already supplied credentials for 'AD Authorize
Me!' AuthName zone and automatically supply them when server says it
needs them. You just need to ensure that Auth* directives are same for
each area.

It is because you don't have AuthName etc defined for CGI script
location that it isn't seeing REMOTE_USER in its environment.

Graham

> Am I doing
> something wrong with this setup?
>
> ****http.conf for cgi-bin****
> <Directory "/var/www/cgi-bin">
>    AllowOverride AuthConfig
>    Options None
>    Order allow,deny
>    Allow from all
> </Directory>
> ****http.conf for cgi-bin****
>
> -----Original Message-----
> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
> Sent: Monday, February 09, 2009 10:18 PM
> To: Mitesh Shah
> Cc: mod_python@modpython.org
> Subject: Re: [mod_python] req.user always returns None
>
> 2009/2/10 Mitesh Shah <mshah@harpercollege.edu>:
>>>What is the original Apache configuration block you are using for
>>>authentication and where is the CGI script located?
>>
>> Here is the conf block for the html directory (authentication dir):
>>
>> ****http.conf****
>> <Directory "/var/www/html">
>>        Options Indexes FollowSymLinks
>>        AllowOverride AuthConfig
>>        Order allow,deny
>>        Allow from all
>> </Directory>
>> ****http.conf****
>>
>> Now the actual .htaccess and html files are in /var/www/html/gapps.
>>
>> My python CGI is in /var/www/cgi-bin.
>
> But where was AuthType/AuthName etc when trying to use CGI scripts?
>
> If that wasn't defined such that it covered directory/location CGI
> script access from/as, then authentication wouldn't have been applied
> for CGI script.
>
> Graham
>
>> -----Original Message-----
>> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
>> Sent: Monday, February 09, 2009 9:52 PM
>> To: Mitesh Shah
>> Cc: mod_python@modpython.org
>> Subject: Re: [mod_python] req.user always returns None
>>
>> 2009/2/10 Mitesh Shah <mshah@harpercollege.edu>:
>>> Sorry for the confusion.  Well it was initially a CGI and then I
>> learned
>>> about mod_python.  Right now I haven't made any changes to the CGI
>> until
>>> I learn how mod_python works.  And all I need is the username and
not
>>> the full name.  When I tried -- os.environ["REMOTE_USER"] -- it
never
>>> returned anything.  I think I'm just having a hard time
understanding
>>> the logistics of mod_python.
>>
>> If you are using os.environ["REMOTE_USER"] inside mod_python handler
>> it will not work. Only relevant to CGI scripts. Just making sure we
>> are talking about same thing here.
>>
>>> I call an html and ask for authentication, this should set the cgi
>>> variable but since my python CGI is calling python
> (#!/usr/bin/python)
>>> separately, I don't think it can access the username from the
initial
>>> authentication.
>>
>> If you mean that the first line of your CGI script has that line,
then
>> that is normal and how UNIX knows what interpreter to run for the
>> contents of the script.
>>
>> If REMOTE_USER environment variable is not set for CGI script, then
AD
>> authentication handler is either not setting 'user' correctly, or the
>> CGI script isn't located in the same Directory/Location context for
>> which the authentication was enabled.
>>
>> What is the original Apache configuration block you are using for
>> authentication and where is the CGI script located?
>>
>> Graham
>>
>>> Which brought me mod_python.  Every example I see they change
> Apache's
>>> httpd.conf to point to the python script. And then this calls
>>> req.get_basic_auth_pw() and req.user and I am able to see the
>> username.
>>> Basically I want the user to authenticate and be presented the html
>> form
>>> and then post to my CGI(or soon mod_python) and then the python
> script
>>> would then grab the username via req.user.
>>>
>>> Thanks for you help so far.
>>>
>>> -Mitesh
>>>
>>> -----Original Message-----
>>> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
>>> Sent: Monday, February 09, 2009 7:21 PM
>>> To: Mitesh Shah
>>> Cc: mod_python@modpython.org
>>> Subject: Re: [mod_python] req.user always returns None
>>>
>>> 2009/2/10 Mitesh Shah <mshah@harpercollege.edu>:
>>>> I will take a look at mod_wsgi.  Anyway, looking at the initial
post
>> I
>>>> realized that pw = req.get_basic_auth_pw() came AFTER req.user.  I
>>> don't
>>>> know how many times I had read that this was incorrect and STILL
did
>>>> it!!  Anyway, I got it to work with that change.  But this was all
>>> just
>>>> for testing.  But now I realized that I may not be able to use this
>>> with
>>>> what I want to accomplish.
>>>>
>>>> 1) Use apache Authorization via .htaccess (which connects to Active
>>>> Directory) -- Working
>>>> 2) After the user is authenticated I have a form (html) with two
>>> fields
>>>> that posts to a python script. -- partially working (cannot log
>>>> username)
>>>
>>> When you say script, what is it implemented as, CGI or mod_python?
>>>
>>> If CGI, then user should be available as REMOTE_USER environment
>>> variable. If mod_python then as req.user.
>>>
>>> If these don't work then the AD module you are using for
>>> authentication is broken in not setting 'user' in Apache request
>>> structure properly.
>>>
>>>> The reason I looked into mod_python was that I am trying to pass
the
>>>> user's name from the initial login to my python script.  Any ideas
> on
>>>> how I could do this?
>>>
>>> Or are you after full name of user rather than a log in ID?
>>>
>>> Can you clarify a bit.
>>>
>>> Graham
>>>
>>>> Thanks,
>>>> Mitesh
>>>>
>>>> -----Original Message-----
>>>> From: Graham Dumpleton [mailto:graham.dumpleton@gmail.com]
>>>> Sent: Monday, February 09, 2009 5:35 PM
>>>> To: Mitesh Shah
>>>> Cc: mod_python@modpython.org
>>>> Subject: Re: [mod_python] req.user always returns None
>>>>
>>>> It is the authentication handlers responsibility, directly or
>>>> indirectly, to set req.user, it will not be set before the
>>>> authentication handler is called. Setting it is one of the things
>> that
>>>> a correctly implement authentication handler should do.
>>>>
>>>> For the way you are doing things, req.user will only be set after:
>>>>
>>>>  pw = req.get_basic_auth_pw()
>>>>
>>>> is called. Ie., done as a side effect of that call.
>>>>
>>>> BTW, if you are new to mod_python, you might want to consider
> instead
>>>> using mod_wsgi, writing your application code as a WSGI application
>>>> and using mod_wsgi's much simpler to understand authentication
>>>> provider hooks where everything is done for you except for
> validating
>>>> the user credentials. For the latter see:
>>>>
>>>>  http://code.google.com/p/modwsgi/wiki/AccessControlMechanisms
>>>>
>>>> Graham
>>>>
>>>> 2009/2/10 Mitesh Shah <mshah@harpercollege.edu>:
>>>>> I am having some issues trying to req.user to return a username.
I
>>> am
>>>> very
>>>>> new to python and mod_python.  I happened upon this thread:
>>>>>
>>>>>
>>>>>
>>>>> http://osdir.com/ml/python.mod_python/2003-10/msg00092.html
>> regarding
>>>> a
>>>>> similar issue.
>>>>>
>>>>>
>>>>>
>>>>> Anyway, even when I ran the code posted by "David Hancock" in the
>>> post
>>>> above
>>>>> I only got a "None" for the username in the error_log file.  I am
>>>> sending
>>>>> this in the URL:
>>>>>
>>>>> "http://localhost/python/mptest"
>>>>>
>>>>>
>>>>>
>>>>> Here is the test setup as it applies to me(basically unchanged).
>>>>>
>>>>>
>>>>>
>>>>> ******mptest.py*******
>>>>>
>>>>> from mod_python import apache
>>>>>
>>>>>
>>>>>
>>>>> def handler(req):
>>>>>
>>>>>         req.content_type = 'text/plain'
>>>>>
>>>>>         req.send_http_header()
>>>>>
>>>>>         req.write("Hello, world!")
>>>>>
>>>>>         return apache.OK
>>>>>
>>>>>
>>>>>
>>>>> def authenhandler(req):
>>>>>
>>>>>         user = req.user
>>>>>
>>>>>         pw = req.get_basic_auth_pw()
>>>>>
>>>>>         req.log_error(str(user) + ' ' + str(pw))
>>>>>
>>>>>         if user == "fred" and pw == "secret":
>>>>>
>>>>>                 return apache.OK
>>>>>
>>>>>         else:
>>>>>
>>>>>                 return apache.HTTP_UNAUTHORIZED
>>>>>
>>>>> *******mptest.py******
>>>>>
>>>>>
>>>>>
>>>>> *******httpd.conf******
>>>>>
>>>>> <Directory "/var/www/html/python">
>>>>>
>>>>>     AddHandler python-program .py
>>>>>
>>>>>     PythonHandler mptest
>>>>>
>>>>>     PythonAuthenHandler mptest
>>>>>
>>>>>     AuthType Basic
>>>>>
>>>>>     AuthName "mod_python restricted area"
>>>>>
>>>>>     require valid-user
>>>>>
>>>>>     PythonDebug On
>>>>>
>>>>> </Directory>
>>>>>
>>>>> ******httpd.conf*******
>>>>>
>>>>>
>>>>>
>>>>> *******error_log*******
>>>>>
>>>>> [Mon Feb 09 17:10:04 2009] [error] [client 127.0.0.1] None secret
>>>>>
>>>>> *******error_log*******
>>>>>
>>>>>
>>>>>
>>>>> After attempting to login I get a 401 page and then I am asked to
>>>> login
>>>>> again.
>>>>>
>>>>>
>>>>>
>>>>> Any help would be greatly appreciated!
>>>>>
>>>>>
>>>>>
>>>>> Thank you,
>>>>>
>>>>> Mitesh
>>>>>
>>>>>
>>>>>
>>>>> _______________________________________________
>>>>> Mod_python mailing list
>>>>> Mod_python@modpython.org
>>>>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>>>>
>>>>>
>>>>
>>>
>>
>

From rahul.warhekar at edisphere.com  Thu Feb 12 23:29:07 2009
From: rahul.warhekar at edisphere.com (rahul)
Date: Thu Feb 12 23:31:21 2009
Subject: [mod_python] how to get data from pyodbc when connected to oracle 
In-Reply-To: <20090209051023.04F4E6A45BF@server1.edisphere.com>
Message-ID: <20090213043120.B894C6A45AD@server1.edisphere.com>


Hello all,

I have used pyodbc to connect to my database.

I have to connect to three different databases.
1) msaccess
2) oracle
3) sql Server

I was pretty successful operating with msaccess but when I connected with
Oracle and run command to print the data with myrow.database_field_name it
is throwing an exception.

The same above is working fine for msaccess.

I have used ODBC_ODBC bridge to connect from linux to windows.

Thanks, 
Rahul

From graham.dumpleton at gmail.com  Thu Feb 12 23:38:25 2009
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Feb 12 23:38:30 2009
Subject: [mod_python] Re: how to get data from pyodbc when connected to
	oracle
In-Reply-To: <20090213043120.B894C6A45AD@server1.edisphere.com>
References: <20090209051023.04F4E6A45BF@server1.edisphere.com>
	<20090213043120.B894C6A45AD@server1.edisphere.com>
Message-ID: <88e286470902122038i7ea0e19al8328b7d4b4436599@mail.gmail.com>

Is this from inside of mod_python application or not. This list is not
for generic Python questions, but is specific to mod_python module for
Apache.

If trying to do it within mod_python, try getting it to work for a
command line script outside of mod_python. If that fails, go use a
more appropriate forum such as:

  http://groups.google.com/group/comp.lang.python/topics?hl=en&lnk

If works outside of mod_python but not in, then you need to be much
more specific about the error occurring, such as tracebacks, exception
raised etc etc.

Graham

2009/2/13 rahul <rahul.warhekar@edisphere.com>:
>
> Hello all,
>
> I have used pyodbc to connect to my database.
>
> I have to connect to three different databases.
> 1) msaccess
> 2) oracle
> 3) sql Server
>
> I was pretty successful operating with msaccess but when I connected with
> Oracle and run command to print the data with myrow.database_field_name it
> is throwing an exception.
>
> The same above is working fine for msaccess.
>
> I have used ODBC_ODBC bridge to connect from linux to windows.
>
> Thanks,
> Rahul
>
>
From howachen at gmail.com  Sat Feb 14 06:13:53 2009
From: howachen at gmail.com (howard chen)
Date: Sat Feb 14 06:13:58 2009
Subject: [mod_python] Thread safety issue in Apache 2 Threaded MPM
Message-ID: <b66ddc900902140313t706c64ebkace08a796a76d069@mail.gmail.com>

Hello,

I am a newbie to mod_python...as I am from PHP...

Here are the story...

In PHP's world, they recommend to use Apache 1.x or 2.x in prefork
mode, to avoid the potential thread safety problem...their reasons
are...

------------------------
PHP is glue. It is the glue used to build cool web applications by
sticking dozens of 3rd-party libraries together and making it all
appear as one coherent entity through an intuitive and easy to learn
language interface. The flexibility and power of PHP relies on the
stability and robustness of the underlying platform. It needs a
working OS, a working web server and working 3rd-party libraries to
glue together. When any of these stop working PHP needs ways to
identify the problems and fix them quickly. When you make the
underlying framework more complex by not having completely separate
execution threads, completely separate memory segments and a strong
sandbox for each request to play in, feet of clay are introduced into
PHP's system....
------------------------

So it is the same with mod_python?

So should I recommended to use Apache 1.x to avoid the potential
thread safety issue?
(Yes I know it is very rare, maybe even 0.0000001%, but just want to confirm)
Thanks.
From graham.dumpleton at gmail.com  Sat Feb 14 06:28:26 2009
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sat Feb 14 06:28:28 2009
Subject: [mod_python] Thread safety issue in Apache 2 Threaded MPM
In-Reply-To: <b66ddc900902140313t706c64ebkace08a796a76d069@mail.gmail.com>
References: <b66ddc900902140313t706c64ebkace08a796a76d069@mail.gmail.com>
Message-ID: <88e286470902140328g5ae14fev838d677868b3970b@mail.gmail.com>

2009/2/14 howard chen <howachen@gmail.com>:
> Hello,
>
> I am a newbie to mod_python...as I am from PHP...
>
> Here are the story...
>
> In PHP's world, they recommend to use Apache 1.x or 2.x in prefork
> mode, to avoid the potential thread safety problem...their reasons
> are...
>
> ------------------------
> PHP is glue. It is the glue used to build cool web applications by
> sticking dozens of 3rd-party libraries together and making it all
> appear as one coherent entity through an intuitive and easy to learn
> language interface. The flexibility and power of PHP relies on the
> stability and robustness of the underlying platform. It needs a
> working OS, a working web server and working 3rd-party libraries to
> glue together. When any of these stop working PHP needs ways to
> identify the problems and fix them quickly. When you make the
> underlying framework more complex by not having completely separate
> execution threads, completely separate memory segments and a strong
> sandbox for each request to play in, feet of clay are introduced into
> PHP's system....
> ------------------------

Which looks in part like an admission that they aren't capable of
writing thread safe code, nor trust developers of third party
extensions for PHP to write thread safe code, or even trust the users
of PHP to write thread safe code. :-)

The issue is probably more that the heritage of PHP is such that
originally it wasn't written with multithreading in mind and so the
code that implements PHP and perhaps the language itself doesn't lend
itself to writing mutithread safe code. Thus, perhaps more poor design
decisions than it being a hard problem to solve.

> So it is the same with mod_python?
>
> So should I recommended to use Apache 1.x to avoid the potential
> thread safety issue?
> (Yes I know it is very rare, maybe even 0.0000001%, but just want to confirm)

Unlike PHP, the Python core and extensions modules available for it
are pretty well all thread safe. There are a few exceptions, but they
aren't commonly used packages.

Thus, what it really comes down to is whether you yourself think you
are capable of writing thread safe code. FWIW, it is much easier to
write thread safe code in Python than it is many other languages. But
if you don't think you understand multi thread programming enough to
do it properly, then use Apache 2.X and prefork MPM.

Do not use Apache 1.X, the version of mod_python available for it is
very old and buggy.

Of course, if you are working on Windows you have no choice as Apache
is only available in a multithread configuration on that platform.

Graham
From jerch at rockborn.de  Sat Feb 14 17:49:30 2009
From: jerch at rockborn.de (Joerg)
Date: Sat Feb 14 17:49:43 2009
Subject: [mod_python] problem with input filter and POST data (fileupload)
Message-ID: <200902142349.30906.jerch@rockborn.de>

Hi,

I ve encountered a problem with a POST request while a mod_python input filter 
is running (on ubuntu 8.04 with apache 2.2.8 prefork and mod_python 3.3.1).

the situation:
Imagine the simplest input filter as stated in the docs and try to upload a 
file (some big POST data) thru this filter. This file will be trunceated to 
the first 64k.

i have tracked down the problem to fragmented data handling in the file 
util.py. If i change line 363 in that file from
>>> req.readline(readBlockSize)
to
>>> req.readline()
it works again. so i dumped the stream data here to see wots going on 
with the data with 4 different setups:

1) req.readline() without filter
2) req.readline() with filter
3) req.readline(readBlockSize) without filter
4) req.readline(readBlockSize) with filter

1-3 seem to be exactly the same, while in the 4th case the req-stream is empty 
after some readings (then req.readline(readBlockSize) becomes None and the 
method returns as expected).
I dont know why suddenly the stream is empty long before the boundery (or 
readline() thinks so), could this be some delay effect caused by the filter? 
or is this a special behavior by req.readline() itself with a given length?

If this is not easy to patch, will there be any neg. effect of using 
req.readline() instead of req.readline(readBlockSize) aside from the big file 
problem?

Regards, joerg
From graham.dumpleton at gmail.com  Sat Feb 14 18:00:55 2009
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sat Feb 14 18:01:00 2009
Subject: [mod_python] problem with input filter and POST data (fileupload)
In-Reply-To: <200902142349.30906.jerch@rockborn.de>
References: <200902142349.30906.jerch@rockborn.de>
Message-ID: <88e286470902141500q51858760ud924f23447e15d4@mail.gmail.com>

2009/2/15 Joerg <jerch@rockborn.de>:
> Hi,
>
> I ve encountered a problem with a POST request while a mod_python input filter
> is running (on ubuntu 8.04 with apache 2.2.8 prefork and mod_python 3.3.1).
>
> the situation:
> Imagine the simplest input filter as stated in the docs and try to upload a
> file (some big POST data) thru this filter. This file will be trunceated to
> the first 64k.
>
> i have tracked down the problem to fragmented data handling in the file
> util.py. If i change line 363 in that file from
>>>> req.readline(readBlockSize)
> to
>>>> req.readline()
> it works again. so i dumped the stream data here to see wots going on
> with the data with 4 different setups:
>
> 1) req.readline() without filter
> 2) req.readline() with filter
> 3) req.readline(readBlockSize) without filter
> 4) req.readline(readBlockSize) with filter
>
> 1-3 seem to be exactly the same, while in the 4th case the req-stream is empty
> after some readings (then req.readline(readBlockSize) becomes None and the
> method returns as expected).
> I dont know why suddenly the stream is empty long before the boundery (or
> readline() thinks so), could this be some delay effect caused by the filter?
> or is this a special behavior by req.readline() itself with a given length?
>
> If this is not easy to patch, will there be any neg. effect of using
> req.readline() instead of req.readline(readBlockSize) aside from the big file
> problem?

Behaviour explained through failing to check for 'None' on data read
by input filter before closing it.

  from mod_python import apache

  def outputfilter(filter):

      s = filter.read()
      while s:
          filter.write(s.upper())
          s = filter.read()

      if s is None:
          filter.close()

In other words, forget the 'if s is None' and you will see that occur
as input filter has been prematurely closed.

Graham
From graham.dumpleton at gmail.com  Sat Feb 14 18:17:21 2009
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sat Feb 14 18:17:23 2009
Subject: [mod_python] problem with input filter and POST data (fileupload)
In-Reply-To: <200902150009.38167.jerch@rockborn.de>
References: <200902142349.30906.jerch@rockborn.de>
	<88e286470902141500q51858760ud924f23447e15d4@mail.gmail.com>
	<200902150009.38167.jerch@rockborn.de>
Message-ID: <88e286470902141517w482db71s894cacfafd45f52b@mail.gmail.com>

Bouncing replay back to list.

2009/2/15 Joerg <jerch@rockborn.de>:
>> Behaviour explained through failing to check for 'None' on data read
>> by input filter before closing it.
>>
>>   from mod_python import apache
>>
>>   def outputfilter(filter):
>>
>>       s = filter.read()
>>       while s:
>>           filter.write(s.upper())
>>           s = filter.read()
>>
>>       if s is None:
>>           filter.close()
>>
>> In other words, forget the 'if s is None' and you will see that occur
>> as input filter has been prematurely closed.
>>
>> Graham
>
> sorry graham, it doesnt work with the "if s is None" either.
>
> Joerg
>
>
From graham.dumpleton at gmail.com  Sun Feb 15 16:05:46 2009
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sun Feb 15 16:05:51 2009
Subject: [mod_python] problem with input filter and POST data (fileupload)
In-Reply-To: <88e286470902141517w482db71s894cacfafd45f52b@mail.gmail.com>
References: <200902142349.30906.jerch@rockborn.de>
	<88e286470902141500q51858760ud924f23447e15d4@mail.gmail.com>
	<200902150009.38167.jerch@rockborn.de>
	<88e286470902141517w482db71s894cacfafd45f52b@mail.gmail.com>
Message-ID: <88e286470902151305u7022a5ady9f0db6734dbf4e5@mail.gmail.com>

2009/2/15 Graham Dumpleton <graham.dumpleton@gmail.com>:
> Bouncing replay back to list.
>
> 2009/2/15 Joerg <jerch@rockborn.de>:
>>> Behaviour explained through failing to check for 'None' on data read
>>> by input filter before closing it.
>>>
>>>   from mod_python import apache
>>>
>>>   def outputfilter(filter):
>>>
>>>       s = filter.read()
>>>       while s:
>>>           filter.write(s.upper())
>>>           s = filter.read()
>>>
>>>       if s is None:
>>>           filter.close()
>>>
>>> In other words, forget the 'if s is None' and you will see that occur
>>> as input filter has been prematurely closed.
>>>
>>> Graham
>>
>> sorry graham, it doesnt work with the "if s is None" either.

Augment your input filter script with debug statements so you can
trace exactly what it is doing, ie., data read, accumulated length of
data etc etc.

Use apache.log_error() function to do this.

Post your results, analysis and code used.

I still don't believe modifying util.py is the answer, it is more
likely to be something in your input filter not passing everything
back or truncating it.

Graham
From jerch at rockborn.de  Sun Feb 15 18:40:16 2009
From: jerch at rockborn.de (Joerg)
Date: Sun Feb 15 18:40:28 2009
Subject: [mod_python] problem with input filter and POST data (fileupload)
In-Reply-To: <88e286470902151305u7022a5ady9f0db6734dbf4e5@mail.gmail.com>
References: <200902142349.30906.jerch@rockborn.de>
	<88e286470902141517w482db71s894cacfafd45f52b@mail.gmail.com>
	<88e286470902151305u7022a5ady9f0db6734dbf4e5@mail.gmail.com>
Message-ID: <200902160040.17158.jerch@rockborn.de>

> Augment your input filter script with debug statements so you can
> trace exactly what it is doing, ie., data read, accumulated length of
> data etc etc.

as i said before, its not working even with the simplest filter. so thats my 
filter atm:

from mod_python import apache

def inputfilter(filter):
	s = filter.read()
	while s:
		filter.write(s)
		s = filter.read()
	if s is None:
		filter.close()

nothing to trace here.

> I still don't believe modifying util.py is the answer, it is more
> likely to be something in your input filter not passing everything
> back or truncating it.

the util.py thing is just my observation, the req.readline() vs. 
req.readline(readBlockSize) has the same effect with the simple filter above.

also my own filter seems to work with req.readline(), since i can get all the 
data. plz correct me, if im wrong, but if the filter would drop some data, 
this should not be possible (in the request handler stage).

i did some data dumps in the filter and in the util.py and compared them (see 
the results in the earlier message). ill do a direct dump in the request 
handler via req.read() readline() and readline(size), maybe i can reproduce 
this behavior.

joerg

From jerch at rockborn.de  Sun Feb 15 20:27:02 2009
From: jerch at rockborn.de (Joerg)
Date: Sun Feb 15 20:27:17 2009
Subject: [mod_python] problem with input filter and POST data (fileupload)
In-Reply-To: <200902160040.17158.jerch@rockborn.de>
References: <200902142349.30906.jerch@rockborn.de>
	<88e286470902151305u7022a5ady9f0db6734dbf4e5@mail.gmail.com>
	<200902160040.17158.jerch@rockborn.de>
Message-ID: <200902160227.02677.jerch@rockborn.de>

hello,

ive dumped a fileupload (original size = 231KB) with the following results:

without filter:
	- req.read() --> 231KB
	- req.readline() --> 231KB
	- req.readline(64000) --> 231KB
	- via util.py --> 231KB

with filter:
	- req.read() --> 231KB
	- req.readline() --> 231KB
	- req.readline(64000) --> 64KB
	- via util.py --> 64KB

the filter:
def inputfilter(filter):
	s = filter.read()
	while s:
		filter.write(s)
		s = filter.read()
	if s is None:
		filter.close()

somehow the the req.readline(size) method doesnt like input filters. since i 
tested it with a binary file the file content would be in one line, but the 
unread part of this line gets lost. weird thing, but all the other lines 
after the file content (the closing boundery) gets lost, too.
this problem points definitely into the c-written part of mod_python, util.py 
just inherits it from there.
any suggestions?

jerch
From graham.dumpleton at gmail.com  Sun Feb 15 20:42:32 2009
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sun Feb 15 20:42:38 2009
Subject: [mod_python] problem with input filter and POST data (fileupload)
In-Reply-To: <200902160227.02677.jerch@rockborn.de>
References: <200902142349.30906.jerch@rockborn.de>
	<88e286470902151305u7022a5ady9f0db6734dbf4e5@mail.gmail.com>
	<200902160040.17158.jerch@rockborn.de>
	<200902160227.02677.jerch@rockborn.de>
Message-ID: <88e286470902151742n7938c25bs161148c25b732756@mail.gmail.com>

2009/2/16 Joerg <jerch@rockborn.de>:
> hello,
>
> ive dumped a fileupload (original size = 231KB) with the following results:
>
> without filter:
>        - req.read() --> 231KB
>        - req.readline() --> 231KB
>        - req.readline(64000) --> 231KB
>        - via util.py --> 231KB
>
> with filter:
>        - req.read() --> 231KB
>        - req.readline() --> 231KB
>        - req.readline(64000) --> 64KB

What about:

  s = req.readline(64000)
  while not s:
    ...
    # log some debug ....
    s = req.readline(64000)

Does that result in all data being read, or is that what your test was doing?

Corresponding to this, log inside of the filter when the filter is
entered/exited and how much each read() request yields so can see in
what way blocks of data are being passed from ealier input filters.

Note that an input filter is called multiple times. It doesn't provide
all data in one execution. This is why I want to see the relationship
between each read from handler and what happens in the filter.

Graham

>        - via util.py --> 64KB
>
> the filter:
> def inputfilter(filter):
>        s = filter.read()
>        while s:
>                filter.write(s)
>                s = filter.read()
>        if s is None:
>                filter.close()
>
> somehow the the req.readline(size) method doesnt like input filters. since i
> tested it with a binary file the file content would be in one line, but the
> unread part of this line gets lost. weird thing, but all the other lines
> after the file content (the closing boundery) gets lost, too.
> this problem points definitely into the c-written part of mod_python, util.py
> just inherits it from there.
> any suggestions?
>
> jerch
>
From jerch at rockborn.de  Sun Feb 15 22:19:34 2009
From: jerch at rockborn.de (Joerg)
Date: Sun Feb 15 22:19:41 2009
Subject: [mod_python] problem with input filter and POST data (fileupload)
In-Reply-To: <88e286470902151742n7938c25bs161148c25b732756@mail.gmail.com>
References: <200902142349.30906.jerch@rockborn.de>
	<200902160227.02677.jerch@rockborn.de>
	<88e286470902151742n7938c25bs161148c25b732756@mail.gmail.com>
Message-ID: <200902160419.34534.jerch@rockborn.de>

Am Monday 16 February 2009 02:42:32 schrieben Sie:
> 2009/2/16 Joerg <jerch@rockborn.de>:
> > hello,
> >
> > ive dumped a fileupload (original size = 231KB) with the following
> > results:
> >
> > without filter:
> >        - req.read() --> 231KB
> >        - req.readline() --> 231KB
> >        - req.readline(64000) --> 231KB
> >        - via util.py --> 231KB
> >
> > with filter:
> >        - req.read() --> 231KB
> >        - req.readline() --> 231KB
> >        - req.readline(64000) --> 64KB
>
> What about:
>
>   s = req.readline(64000)
>   while not s:
>     ...
>     # log some debug ....
>     s = req.readline(64000)
>
> Does that result in all data being read, or is that what your test was
> doing?

hm, dont know wot u mean with the while not clause, the handler will loop here 
for ever.
ive inspected the data stream of a indexed textfile to get the break point. 
wot ive found out:

if u set the size of req.readline(size) pretty low the stream breaks after 
103888 Bytes. til there the readline works correct, it "resumes" the old line 
data and so on. all data after 103888 is lost.
if u set the size greater than this border, only the first line read will 
succeed. the other data is lost.
btw, this break point is in the middle of a filter call, not at the end (was 
the 6th here with every call working on 1,4KB of stream data)

since this weird behavior shows up only with a running filter (dont know, if 
non python input filter are affected too), this is probably caused by some 
code in the c part, which is only active with a filter before. also it might 
be some buffer issue there, since the 103888 Byte border is reproducible.

jerch

From jerch at rockborn.de  Sun Feb 15 22:28:29 2009
From: jerch at rockborn.de (Joerg)
Date: Sun Feb 15 22:28:37 2009
Subject: [mod_python] problem with input filter and POST data (fileupload)
In-Reply-To: <88e286470902151742n7938c25bs161148c25b732756@mail.gmail.com>
References: <200902142349.30906.jerch@rockborn.de>
	<200902160227.02677.jerch@rockborn.de>
	<88e286470902151742n7938c25bs161148c25b732756@mail.gmail.com>
Message-ID: <200902160428.30114.jerch@rockborn.de>

sorry,
103888 Bytes is wrong. 

8192 Bytes is the right number.

joerg
From graham.dumpleton at gmail.com  Sun Feb 15 22:31:06 2009
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sun Feb 15 22:31:11 2009
Subject: [mod_python] problem with input filter and POST data (fileupload)
In-Reply-To: <200902160419.34534.jerch@rockborn.de>
References: <200902142349.30906.jerch@rockborn.de>
	<200902160227.02677.jerch@rockborn.de>
	<88e286470902151742n7938c25bs161148c25b732756@mail.gmail.com>
	<200902160419.34534.jerch@rockborn.de>
Message-ID: <88e286470902151931j7922fd9dkd6e58d1a8ecb7b21@mail.gmail.com>

2009/2/16 Joerg <jerch@rockborn.de>:
> Am Monday 16 February 2009 02:42:32 schrieben Sie:
>> 2009/2/16 Joerg <jerch@rockborn.de>:
>> > hello,
>> >
>> > ive dumped a fileupload (original size = 231KB) with the following
>> > results:
>> >
>> > without filter:
>> >        - req.read() --> 231KB
>> >        - req.readline() --> 231KB
>> >        - req.readline(64000) --> 231KB
>> >        - via util.py --> 231KB
>> >
>> > with filter:
>> >        - req.read() --> 231KB
>> >        - req.readline() --> 231KB
>> >        - req.readline(64000) --> 64KB
>>
>> What about:
>>
>>   s = req.readline(64000)
>>   while not s:
>>     ...
>>     # log some debug ....
>>     s = req.readline(64000)
>>
>> Does that result in all data being read, or is that what your test was
>> doing?
>
> hm, dont know wot u mean with the while not clause, the handler will loop here
> for ever.

Yeah, me just getting my logic around the wrong way.

> ive inspected the data stream of a indexed textfile to get the break point.
> wot ive found out:
>
> if u set the size of req.readline(size) pretty low the stream breaks after
> 103888 Bytes. til there the readline works correct, it "resumes" the old line
> data and so on. all data after 103888 is lost.
> if u set the size greater than this border, only the first line read will
> succeed. the other data is lost.
> btw, this break point is in the middle of a filter call, not at the end (was
> the 6th here with every call working on 1,4KB of stream data)
>
> since this weird behavior shows up only with a running filter (dont know, if
> non python input filter are affected too), this is probably caused by some
> code in the c part, which is only active with a filter before. also it might
> be some buffer issue there, since the 103888 Byte border is reproducible.

Frankly I would not be surprised if how mod_python implements the
filters is broken.

My question at this point is, what are you trying to implement that
uses filters anyway. Writing filters in mod_python isn't actually a
wise thing as far as I am concerned as it is not going to be
particularly efficient. Much more sensible to write a proper Apache C
module to implement the filter.

The only serious use of mod_python filters I have seen is Tramline
(upload/download accelerator). They actually complain the mod_python
filters don't work properly as well and say a fix has to be made to
mod_python Python code. The fix itself they propose doesn't make any
sense, unless it is acting as a workaround for borked C code
underneath. The issue for that is at:

  http://issues.apache.org/jira/browse/MODPYTHON-76

Anyway, if you are still having problems, not sure there is much more
I can do to help. I continue to only answer questions here, but I
don't actually use mod_python myself anymore nor even start it up to
try things out when people have issues and just rely on my memory of
what happens.

If you can track the problem down to a specific area of code with
small reproducable recipe to trigger, then log a bug report in the
issue tracker. It can go with all the other bugs that haven't been
fixed. :-)

Graham
From jerch at rockborn.de  Sun Feb 15 23:20:18 2009
From: jerch at rockborn.de (Joerg)
Date: Sun Feb 15 23:20:23 2009
Subject: [mod_python] problem with input filter and POST data (fileupload)
In-Reply-To: <88e286470902151931j7922fd9dkd6e58d1a8ecb7b21@mail.gmail.com>
References: <200902142349.30906.jerch@rockborn.de>
	<200902160419.34534.jerch@rockborn.de>
	<88e286470902151931j7922fd9dkd6e58d1a8ecb7b21@mail.gmail.com>
Message-ID: <200902160520.18492.jerch@rockborn.de>

> Frankly I would not be surprised if how mod_python implements the
> filters is broken.
>
> My question at this point is, what are you trying to implement that
> uses filters anyway. Writing filters in mod_python isn't actually a
> wise thing as far as I am concerned as it is not going to be
> particularly efficient. Much more sensible to write a proper Apache C
> module to implement the filter.
>
> The only serious use of mod_python filters I have seen is Tramline
> (upload/download accelerator). They actually complain the mod_python
> filters don't work properly as well and say a fix has to be made to
> mod_python Python code. The fix itself they propose doesn't make any
> sense, unless it is acting as a workaround for borked C code
> underneath. The issue for that is at:
>
>   http://issues.apache.org/jira/browse/MODPYTHON-76
>
> Anyway, if you are still having problems, not sure there is much more
> I can do to help. I continue to only answer questions here, but I
> don't actually use mod_python myself anymore nor even start it up to
> try things out when people have issues and just rely on my memory of
> what happens.
>
> If you can track the problem down to a specific area of code with
> small reproducable recipe to trigger, then log a bug report in the
> issue tracker. It can go with all the other bugs that haven't been
> fixed. :-)
>
> Graham

ok ok, i wrote a filter over 3 years ago for measuring the byte transfer (and 
some output filters too). with my recent system upgrade the input filter 
stopped working. thats all behind it. since the change to req.readline() in 
the util.py does the trick, im happy for now. i can hardly read the c code of 
mod_python, so tracking this further down while no one maintains the code 
base seems to be a waste of time.
nevertheless thank you for your quick replies, you are the lonely hero in the 
sinking mod_python world.
i guess i have to go with the zeitgeist and should switch over to the wsgi 
thingy. i dont like it atm, maybe im addicted to the mod_python way ;)

regards, joerg
From jerch at rockborn.de  Sun Feb 15 23:44:27 2009
From: jerch at rockborn.de (Joerg)
Date: Sun Feb 15 23:44:38 2009
Subject: [mod_python] problem with input filter and POST data (fileupload)
In-Reply-To: <88e286470902151931j7922fd9dkd6e58d1a8ecb7b21@mail.gmail.com>
References: <200902142349.30906.jerch@rockborn.de>
	<200902160419.34534.jerch@rockborn.de>
	<88e286470902151931j7922fd9dkd6e58d1a8ecb7b21@mail.gmail.com>
Message-ID: <200902160544.27885.jerch@rockborn.de>

just one thing, 

from apache include/httpd.h:
...
 #define   HUGE_STRING_LEN   8192
...

wot a coincidence ;)
From graham.dumpleton at gmail.com  Sun Feb 15 23:50:05 2009
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sun Feb 15 23:50:11 2009
Subject: [mod_python] problem with input filter and POST data (fileupload)
In-Reply-To: <200902160544.27885.jerch@rockborn.de>
References: <200902142349.30906.jerch@rockborn.de>
	<200902160419.34534.jerch@rockborn.de>
	<88e286470902151931j7922fd9dkd6e58d1a8ecb7b21@mail.gmail.com>
	<200902160544.27885.jerch@rockborn.de>
Message-ID: <88e286470902152050y52e7a799tf1f727c6ba1328af@mail.gmail.com>

2009/2/16 Joerg <jerch@rockborn.de>:
> just one thing,
>
> from apache include/httpd.h:
> ...
>  #define   HUGE_STRING_LEN   8192
> ...
>
> wot a coincidence ;)

Yeah, there are lots of magic numbers in Apache. For 256 and 8000
popping up see interesting problem in:

  http://groups.google.com/group/modwsgi/browse_frm/thread/e7111816e70d236a

Something would work if data < 256 or > ~8000, but not if between the
two bounds. Wasn't exactly 8000 because of some allowance for header
information (I think).

Turned out to be some silly optimisation Apache was attempting to do.
The optimisation only got applied if keep alive was requested by
client and enabled in server.

Graham
From graham.dumpleton at gmail.com  Mon Feb 16 00:07:37 2009
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Feb 16 00:07:42 2009
Subject: [mod_python] problem with input filter and POST data (fileupload)
In-Reply-To: <88e286470902152050y52e7a799tf1f727c6ba1328af@mail.gmail.com>
References: <200902142349.30906.jerch@rockborn.de>
	<200902160419.34534.jerch@rockborn.de>
	<88e286470902151931j7922fd9dkd6e58d1a8ecb7b21@mail.gmail.com>
	<200902160544.27885.jerch@rockborn.de>
	<88e286470902152050y52e7a799tf1f727c6ba1328af@mail.gmail.com>
Message-ID: <88e286470902152107y3273bca0w50c73046e7cd911@mail.gmail.com>

BTW, am still interested to know what the input filter does.

In mod_wsgi will most likely be adding ability to optionally hook into
Apache handler phases much like mod_python, except for content phase
which would be WSGI, but without all the extra crud on top that
mod_python has. Also been thinking about supporting filters, but since
am less convinced about the usefulness of them given performance
concerns, would like to know what you using filters for.

Graham

2009/2/16 Graham Dumpleton <graham.dumpleton@gmail.com>:
> 2009/2/16 Joerg <jerch@rockborn.de>:
>> just one thing,
>>
>> from apache include/httpd.h:
>> ...
>>  #define   HUGE_STRING_LEN   8192
>> ...
>>
>> wot a coincidence ;)
>
> Yeah, there are lots of magic numbers in Apache. For 256 and 8000
> popping up see interesting problem in:
>
>  http://groups.google.com/group/modwsgi/browse_frm/thread/e7111816e70d236a
>
> Something would work if data < 256 or > ~8000, but not if between the
> two bounds. Wasn't exactly 8000 because of some allowance for header
> information (I think).
>
> Turned out to be some silly optimisation Apache was attempting to do.
> The optimisation only got applied if keep alive was requested by
> client and enabled in server.
>
> Graham
>
From jerch at rockborn.de  Mon Feb 16 08:38:44 2009
From: jerch at rockborn.de (Joerg)
Date: Mon Feb 16 08:38:57 2009
Subject: [mod_python] problem with input filter and POST data (fileupload)
In-Reply-To: <88e286470902152107y3273bca0w50c73046e7cd911@mail.gmail.com>
References: <200902142349.30906.jerch@rockborn.de>
	<88e286470902152050y52e7a799tf1f727c6ba1328af@mail.gmail.com>
	<88e286470902152107y3273bca0w50c73046e7cd911@mail.gmail.com>
Message-ID: <200902161438.44962.jerch@rockborn.de>

Am Monday 16 February 2009 06:07:37 schrieben Sie:
> BTW, am still interested to know what the input filter does.

the input filter was a special wish of a customer to get a file upload status 
bar in the web app. it works like this:
- get a unified upload ID (given as GET var) and contentlength
- read length of stream data per time to get the stats like bytes sent, 
throughput
- indicate a stilling running upload with a bool var as long as EOS was not 
sent (i had to catch IOErrors here, if the client closes the connection 
prematurely)
- write this all into a tempfile
- get the stats with a second request (via ajax)

> In mod_wsgi will most likely be adding ability to optionally hook into
> Apache handler phases much like mod_python, except for content phase
> which would be WSGI, but without all the extra crud on top that
> mod_python has. Also been thinking about supporting filters, but since
> am less convinced about the usefulness of them given performance
> concerns, would like to know what you using filters for.

i did some work on output filters, mainly for caching purpose. i stumbled into 
this, because my psp templating was lacking the ability to return me the 
created content. the output filter was an easy way to implement a whole page 
cache, but for partial caching it was useless again. i solved this later by 
hooking the req.write() method with my own one.

i dont know, how wsgi handles incoming data, but i think the upload bar thing 
is a must have for the clients and should be implemented by the browsers (to 
give the user a neat upload bar they could provide a js-api to those stats). 
it is definitively the wrong way it is nowadays.
also the latter case for caching is not a big problem anymore in wsgi, since 
you can daisy-chain the "handlers" and hook into the row some cache 
functionality wherever you want. (but my actual understanding of this is 
quite poor since i have just started to look into it)

joerg
From jerch at rockborn.de  Mon Feb 16 09:42:07 2009
From: jerch at rockborn.de (Joerg)
Date: Mon Feb 16 09:42:18 2009
Subject: [mod_python] problem with input filter and POST data (fileupload)
In-Reply-To: <88e286470902152107y3273bca0w50c73046e7cd911@mail.gmail.com>
References: <200902142349.30906.jerch@rockborn.de>
	<88e286470902152050y52e7a799tf1f727c6ba1328af@mail.gmail.com>
	<88e286470902152107y3273bca0w50c73046e7cd911@mail.gmail.com>
Message-ID: <200902161542.07420.jerch@rockborn.de>

addendum to my browser criticism (a bit off topic):

the more i dig into the web app universe, the clearer i get the following 
picture:

- the servers do a good job (mostly) -- to serve
- the clients (browsers) mess around with a crappy bunch of specs
no wrong, the specs are well defined but the implementations are awkward, see 
IE. but also the so called standard compliant browsers do many things very 
different. i know the problems with the backward compatibility, but these 
soft parser implementations only feed the "lets try to load file xy as a html 
doc" trolls (kinda vicious circle). not even google delivers well formed 
docs.
short example: any "modern" browser and xml with xslt. the specs are nearly 10 
years old but no browser can handle this right. (we tried to build a 
xml-document service on this and failed. now we have just another server 
component to do the transformations).
not to mention the javascript field. since 2003/2004 javascript becomes more 
and more important. but it takes 6 more years to write an interpreter with 
fundamental compiler building knowlegde in mind and to decouple it from the 
browser's main thread. wot a shame!
maybe the iron monkey approach of the mozilla guys will lighten the scene, 
maybe it will crash right into the security whole pot.

just my 2 cents, joerg




From initxpolo at gmail.com  Thu Feb 19 05:18:54 2009
From: initxpolo at gmail.com (Polo InitX)
Date: Thu Feb 19 05:19:02 2009
Subject: [mod_python] One question in mod_python tutorial
Message-ID: <ff59a29b0902190218i4641bba6w219523caf27c5400@mail.gmail.com>

Hi all
    I'm newbie to mod_python and I follow the mod_python document step by
step,
but I can't finished the tutorial in part 3.1 "A Quick Start with the
Publisher Handler" .

My firefox return the lots of Traceback messages with error: (13,
'Permission denied') in last line.
I put the form.py file in /home/www/py directory with +x permissions

Why would got Permission denied problem?

Best regards

Following is the erros messages in apache error log file
[Thu Feb 19 18:07:28 2009] [error] [client 192.168.0.72] PythonHandler
mod_python.publisher: Traceback (most recent call last):, referer:
http://www.51nnyy.com/
[Thu Feb 19 18:07:28 2009] [error] [client 192.168.0.72] PythonHandler
mod_python.publisher:   File
"/usr/lib64/python2.4/site-packages/mod_python/apache.py", line 299, in
HandlerDispatch\n    result = object(req), referer: http://www.51nnyy.com/
[Thu Feb 19 18:07:28 2009] [error] [client 192.168.0.72] PythonHandler
mod_python.publisher:   File
"/usr/lib64/python2.4/site-packages/mod_python/publisher.py", line 213, in
handler\n    published = publish_object(req, object), referer:
http://www.51nnyy.com/
[Thu Feb 19 18:07:28 2009] [error] [client 192.168.0.72] PythonHandler
mod_python.publisher:   File
"/usr/lib64/python2.4/site-packages/mod_python/publisher.py", line 412, in
publish_object\n    return publish_object(req,util.apply_fs_data(object,
req.form, req=req)), referer: http://www.51nnyy.com/
[Thu Feb 19 18:07:28 2009] [error] [client 192.168.0.72] PythonHandler
mod_python.publisher:   File
"/usr/lib64/python2.4/site-packages/mod_python/util.py", line 439, in
apply_fs_data\n    return object(**args), referer: http://www.51nnyy.com/
[Thu Feb 19 18:07:28 2009] [error] [client 192.168.0.72] PythonHandler
mod_python.publisher:   File "/home/www/py/form.py", line 29, in email\n
conn = smtplib.SMTP(SMTP_SERVER), referer: http://www.51nnyy.com/
[Thu Feb 19 18:07:28 2009] [error] [client 192.168.0.72] PythonHandler
mod_python.publisher:   File "/usr/lib64/python2.4/smtplib.py", line 244, in
__init__\n    (code, msg) = self.connect(host, port), referer:
http://www.51nnyy.com/
[Thu Feb 19 18:07:28 2009] [error] [client 192.168.0.72] PythonHandler
mod_python.publisher:   File "/usr/lib64/python2.4/smtplib.py", line 306, in
connect\n    raise socket.error, msg, referer: http://www.51nnyy.com/
[Thu Feb 19 18:07:28 2009] [error] [client 192.168.0.72] PythonHandler
mod_python.publisher: error: (13, 'Permission denied'), referer:
http://www.51nnyy.com/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20090219/10ce8dfa/attachment.html
From jrraines at comcast.net  Thu Feb 19 06:56:12 2009
From: jrraines at comcast.net (John Raines)
Date: Thu Feb 19 06:56:16 2009
Subject: [mod_python] One question in mod_python tutorial
In-Reply-To: <ff59a29b0902190218i4641bba6w219523caf27c5400@mail.gmail.com>
References: <ff59a29b0902190218i4641bba6w219523caf27c5400@mail.gmail.com>
Message-ID: <053EF81A-0D2F-420D-BFD1-EB679382D7C9@comcast.net>

Check permissions for the folder the code is in vis a vis the user  
apache runs as.
On Feb 19, 2009, at 4:18 AM, Polo InitX wrote:

> Hi all
>     I'm newbie to mod_python and I follow the mod_python document  
> step by step,
> but I can't finished the tutorial in part 3.1 "A Quick Start with  
> the Publisher Handler" .
>
> My firefox return the lots of Traceback messages with error: (13,  
> 'Permission denied') in last line.
> I put the form.py file in /home/www/py directory with +x permissions
>
> Why would got Permission denied problem?
>
> Best regards
>
> Following is the erros messages in apache error log file
> [Thu Feb 19 18:07:28 2009] [error] [client 192.168.0.72]  
> PythonHandler mod_python.publisher: Traceback (most recent call  
> last):, referer: http://www.51nnyy.com/
> [Thu Feb 19 18:07:28 2009] [error] [client 192.168.0.72]  
> PythonHandler mod_python.publisher:   File "/usr/lib64/python2.4/ 
> site-packages/mod_python/apache.py", line 299, in HandlerDispatch 
> \n    result = object(req), referer: http://www.51nnyy.com/
> [Thu Feb 19 18:07:28 2009] [error] [client 192.168.0.72]  
> PythonHandler mod_python.publisher:   File "/usr/lib64/python2.4/ 
> site-packages/mod_python/publisher.py", line 213, in handler\n     
> published = publish_object(req, object), referer: http://www.51nnyy.com/
> [Thu Feb 19 18:07:28 2009] [error] [client 192.168.0.72]  
> PythonHandler mod_python.publisher:   File "/usr/lib64/python2.4/ 
> site-packages/mod_python/publisher.py", line 412, in publish_object 
> \n    return publish_object(req,util.apply_fs_data(object, req.form,  
> req=req)), referer: http://www.51nnyy.com/
> [Thu Feb 19 18:07:28 2009] [error] [client 192.168.0.72]  
> PythonHandler mod_python.publisher:   File "/usr/lib64/python2.4/ 
> site-packages/mod_python/util.py", line 439, in apply_fs_data\n     
> return object(**args), referer: http://www.51nnyy.com/
> [Thu Feb 19 18:07:28 2009] [error] [client 192.168.0.72]  
> PythonHandler mod_python.publisher:   File "/home/www/py/form.py",  
> line 29, in email\n    conn = smtplib.SMTP(SMTP_SERVER), referer: http://www.51nnyy.com/
> [Thu Feb 19 18:07:28 2009] [error] [client 192.168.0.72]  
> PythonHandler mod_python.publisher:   File "/usr/lib64/python2.4/ 
> smtplib.py", line 244, in __init__\n    (code, msg) =  
> self.connect(host, port), referer: http://www.51nnyy.com/
> [Thu Feb 19 18:07:28 2009] [error] [client 192.168.0.72]  
> PythonHandler mod_python.publisher:   File "/usr/lib64/python2.4/ 
> smtplib.py", line 306, in connect\n    raise socket.error, msg,  
> referer: http://www.51nnyy.com/
> [Thu Feb 19 18:07:28 2009] [error] [client 192.168.0.72]  
> PythonHandler mod_python.publisher: error: (13, 'Permission  
> denied'), referer: http://www.51nnyy.com/
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20090219/2a9b442e/attachment.html
From list at joreybump.com  Thu Feb 19 08:05:44 2009
From: list at joreybump.com (Jorey Bump)
Date: Thu Feb 19 08:05:50 2009
Subject: [mod_python] One question in mod_python tutorial
In-Reply-To: <ff59a29b0902190218i4641bba6w219523caf27c5400@mail.gmail.com>
References: <ff59a29b0902190218i4641bba6w219523caf27c5400@mail.gmail.com>
Message-ID: <499D5928.7060001@joreybump.com>

The last thing the world needs is another formmail script unleashed on
the Internet by newbies. :)

Ignore that example and try something simpler, if you're merely testing
Publisher functionality.

Create a file named hello.py:

def bruce(req):
    return "Hello, Bruce!"

Now point your browser at the *function* in the module:

http://host/hello.py/bruce

Once you get that working, add more sophisticated code. Publisher will
inspect the string you return and set the Content-Type to "text/plain"
if it's plaintext and "text/html" if it looks like an HTML page:

def bruce(req):
    return "<html><body><h1>Hello, Bruce!</h1></body></html>"

Make sure this is working before you try anything more sophisticated.
Then try importing some basic modules and returning output you create
with them. Troubleshooting smtplib at this point is a waste of time, as
there are any number of reasons it can fail, including the presence of
AppArmor or SELinux.


Polo InitX wrote, at 02/19/2009 05:18 AM:
> Hi all
>     I'm newbie to mod_python and I follow the mod_python document step
> by step,
> but I can't finished the tutorial in part 3.1 "A Quick Start with the
> Publisher Handler" .
> 
> My firefox return the lots of Traceback messages with error: (13,
> 'Permission denied') in last line.
> I put the form.py file in /home/www/py directory with +x permissions
> 
> Why would got Permission denied problem?
> 
> Best regards
> 
> Following is the erros messages in apache error log file
> [Thu Feb 19 18:07:28 2009] [error] [client 192.168.0.72] PythonHandler
> mod_python.publisher: Traceback (most recent call last):, referer:
> http://www.51nnyy.com/
> [Thu Feb 19 18:07:28 2009] [error] [client 192.168.0.72] PythonHandler
> mod_python.publisher:   File
> "/usr/lib64/python2.4/site-packages/mod_python/apache.py", line 299, in
> HandlerDispatch\n    result = object(req), referer: http://www.51nnyy.com/
> [Thu Feb 19 18:07:28 2009] [error] [client 192.168.0.72] PythonHandler
> mod_python.publisher:   File
> "/usr/lib64/python2.4/site-packages/mod_python/publisher.py", line 213,
> in handler\n    published = publish_object(req, object), referer:
> http://www.51nnyy.com/
> [Thu Feb 19 18:07:28 2009] [error] [client 192.168.0.72] PythonHandler
> mod_python.publisher:   File
> "/usr/lib64/python2.4/site-packages/mod_python/publisher.py", line 412,
> in publish_object\n    return
> publish_object(req,util.apply_fs_data(object, req.form, req=req)),
> referer: http://www.51nnyy.com/
> [Thu Feb 19 18:07:28 2009] [error] [client 192.168.0.72] PythonHandler
> mod_python.publisher:   File
> "/usr/lib64/python2.4/site-packages/mod_python/util.py", line 439, in
> apply_fs_data\n    return object(**args), referer: http://www.51nnyy.com/
> [Thu Feb 19 18:07:28 2009] [error] [client 192.168.0.72] PythonHandler
> mod_python.publisher:   File "/home/www/py/form.py", line 29, in
> email\n    conn = smtplib.SMTP(SMTP_SERVER), referer: http://www.51nnyy.com/
> [Thu Feb 19 18:07:28 2009] [error] [client 192.168.0.72] PythonHandler
> mod_python.publisher:   File "/usr/lib64/python2.4/smtplib.py", line
> 244, in __init__\n    (code, msg) = self.connect(host, port), referer:
> http://www.51nnyy.com/
> [Thu Feb 19 18:07:28 2009] [error] [client 192.168.0.72] PythonHandler
> mod_python.publisher:   File "/usr/lib64/python2.4/smtplib.py", line
> 306, in connect\n    raise socket.error, msg, referer:
> http://www.51nnyy.com/
> [Thu Feb 19 18:07:28 2009] [error] [client 192.168.0.72] PythonHandler
> mod_python.publisher: error: (13, 'Permission denied'), referer:
> http://www.51nnyy.com/
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From guorong.zhang at onewaveinc.com  Thu Feb 19 22:25:24 2009
From: guorong.zhang at onewaveinc.com (InitX)
Date: Thu Feb 19 22:25:32 2009
Subject: [mod_python] One question in mod_python tutorial
In-Reply-To: <499D5928.7060001@joreybump.com>
References: <ff59a29b0902190218i4641bba6w219523caf27c5400@mail.gmail.com>
	<499D5928.7060001@joreybump.com>
Message-ID: <ff59a29b0902191925i685438b5pac4da0e7e24ac2d@mail.gmail.com>

Thank you for reply guys

In the preview example my webbrower display hello world then it meaning
mod_python is working for me
and I had check the permission of that folder, it is 755 meaning everyone
can read and exec the form.py file.

mptest and form got same SElinux mode
-rwxr-xr-x  51nnyy net  system_u:object_r:httpd_sys_content_t form.py
-rwxr-xr-x  51nnyy net  system_u:object_r:httpd_sys_content_t mptest.py

so any ideas?


On Thu, Feb 19, 2009 at 9:05 PM, Jorey Bump <list@joreybump.com> wrote:

> The last thing the world needs is another formmail script unleashed on
> the Internet by newbies. :)
>
> Ignore that example and try something simpler, if you're merely testing
> Publisher functionality.
>
> Create a file named hello.py:
>
> def bruce(req):
>    return "Hello, Bruce!"
>
> Now point your browser at the *function* in the module:
>
> http://host/hello.py/bruce
>
> Once you get that working, add more sophisticated code. Publisher will
> inspect the string you return and set the Content-Type to "text/plain"
> if it's plaintext and "text/html" if it looks like an HTML page:
>
> def bruce(req):
>    return "<html><body><h1>Hello, Bruce!</h1></body></html>"
>
> Make sure this is working before you try anything more sophisticated.
> Then try importing some basic modules and returning output you create
> with them. Troubleshooting smtplib at this point is a waste of time, as
> there are any number of reasons it can fail, including the presence of
> AppArmor or SELinux.
>
>
> Polo InitX wrote, at 02/19/2009 05:18 AM:
> > Hi all
> >     I'm newbie to mod_python and I follow the mod_python document step
> > by step,
> > but I can't finished the tutorial in part 3.1 "A Quick Start with the
> > Publisher Handler" .
> >
> > My firefox return the lots of Traceback messages with error: (13,
> > 'Permission denied') in last line.
> > I put the form.py file in /home/www/py directory with +x permissions
> >
> > Why would got Permission denied problem?
> >
> > Best regards
> >
> > Following is the erros messages in apache error log file
> > [Thu Feb 19 18:07:28 2009] [error] [client 192.168.0.72] PythonHandler
> > mod_python.publisher: Traceback (most recent call last):, referer:
> > http://www.51nnyy.com/
> > [Thu Feb 19 18:07:28 2009] [error] [client 192.168.0.72] PythonHandler
> > mod_python.publisher:   File
> > "/usr/lib64/python2.4/site-packages/mod_python/apache.py", line 299, in
> > HandlerDispatch\n    result = object(req), referer:
> http://www.51nnyy.com/
> > [Thu Feb 19 18:07:28 2009] [error] [client 192.168.0.72] PythonHandler
> > mod_python.publisher:   File
> > "/usr/lib64/python2.4/site-packages/mod_python/publisher.py", line 213,
> > in handler\n    published = publish_object(req, object), referer:
> > http://www.51nnyy.com/
> > [Thu Feb 19 18:07:28 2009] [error] [client 192.168.0.72] PythonHandler
> > mod_python.publisher:   File
> > "/usr/lib64/python2.4/site-packages/mod_python/publisher.py", line 412,
> > in publish_object\n    return
> > publish_object(req,util.apply_fs_data(object, req.form, req=req)),
> > referer: http://www.51nnyy.com/
> > [Thu Feb 19 18:07:28 2009] [error] [client 192.168.0.72] PythonHandler
> > mod_python.publisher:   File
> > "/usr/lib64/python2.4/site-packages/mod_python/util.py", line 439, in
> > apply_fs_data\n    return object(**args), referer:
> http://www.51nnyy.com/
> > [Thu Feb 19 18:07:28 2009] [error] [client 192.168.0.72] PythonHandler
> > mod_python.publisher:   File "/home/www/py/form.py", line 29, in
> > email\n    conn = smtplib.SMTP(SMTP_SERVER), referer:
> http://www.51nnyy.com/
> > [Thu Feb 19 18:07:28 2009] [error] [client 192.168.0.72] PythonHandler
> > mod_python.publisher:   File "/usr/lib64/python2.4/smtplib.py", line
> > 244, in __init__\n    (code, msg) = self.connect(host, port), referer:
> > http://www.51nnyy.com/
> > [Thu Feb 19 18:07:28 2009] [error] [client 192.168.0.72] PythonHandler
> > mod_python.publisher:   File "/usr/lib64/python2.4/smtplib.py", line
> > 306, in connect\n    raise socket.error, msg, referer:
> > http://www.51nnyy.com/
> > [Thu Feb 19 18:07:28 2009] [error] [client 192.168.0.72] PythonHandler
> > mod_python.publisher: error: (13, 'Permission denied'), referer:
> > http://www.51nnyy.com/
> >
> >
> > ------------------------------------------------------------------------
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20090220/099aee62/attachment.html
From rphelps at redshift.com  Sat Feb 21 18:12:59 2009
From: rphelps at redshift.com (Ron Phelps)
Date: Sat Feb 21 18:13:29 2009
Subject: [mod_python] Matplotlib error from a mod_python script "root is not
	a writable dir... "
Message-ID: <1235257979.27550.12.camel@127.0.0.1 quirky>

I have successfully configured mod_python and using some python scripts
am accessing a database for the purpose of generating plots using
matplotlib. 

The problem is that when I try to save a plot to a subdir of the Apache
document root I get the following error. 

'/root' is not a writable dir; you must set the environment variable
HOME to be a writable dir 

echo $HOME  returns '/root' but setting it to the correct path and even
changing the dir permissions does no good. 

Tried useing the MPLCONFIGDIR to point to a MATPLOTLIBRC file but no
luck there either. 

Does anyone know What HOME variable is this error message referring to?

BTW Graham, I came across your article on "modwsgi" though it may not be
directly related I will read it in hopes it gives me some insight.  

All help appreciated. 

Thanks 

Ron 

From graham.dumpleton at gmail.com  Sat Feb 21 18:51:01 2009
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sat Feb 21 18:51:03 2009
Subject: [mod_python] Matplotlib error from a mod_python script "root is 
	not a writable dir... "
In-Reply-To: <-6465265059533872257@unknownmsgid>
References: <-6465265059533872257@unknownmsgid>
Message-ID: <88e286470902211551l306bc2a1nc6f255d358f24200@mail.gmail.com>

2009/2/22 Ron Phelps <rphelps@redshift.com>:
> I have successfully configured mod_python and using some python scripts
> am accessing a database for the purpose of generating plots using
> matplotlib.
>
> The problem is that when I try to save a plot to a subdir of the Apache
> document root I get the following error.
>
> '/root' is not a writable dir; you must set the environment variable
> HOME to be a writable dir
>
> echo $HOME  returns '/root' but setting it to the correct path and even
> changing the dir permissions does no good.
>
> Tried useing the MPLCONFIGDIR to point to a MATPLOTLIBRC file but no
> luck there either.
>
> Does anyone know What HOME variable is this error message referring to?
>
> BTW Graham, I came across your article on "modwsgi" though it may not be
> directly related I will read it in hopes it gives me some insight.

The following environment variables can/will all be set wrong if using
mod_python.

  HOME
  LOGNAME
  USERNAME
  USER

If any Python code uses those directly, or indirectly via
os.path.expanduser() function, then the results will be wrong.

The only way that is guaranteed to give correct values are to use
os.geteuid() and then 'pwd' module to look up user details in password
database.

Even then, the result will then reflect what is correct for the user
that Apache runs as. The home directory of that account isn't usually
writable either.

You thus need to find a way of telling matplotlib to look use
alternate location. You appear to have tried that, but the question is
how have you tried to do that? You cannot use SetEnv or PythonOption
directives as they do not set environment variables in Apache server
child processes.

What you do to do is set os.environ dictionary explicitly in your
mod_python handler entry point module, or possibly in a special module
imported using PythonImport directive.

Graham
From diazona at gmail.com  Sat Feb 21 19:16:02 2009
From: diazona at gmail.com (David Zaslavsky)
Date: Sat Feb 21 19:16:09 2009
Subject: [mod_python] Matplotlib error from a mod_python script "root is 
	not a writable dir... "
In-Reply-To: <-6465265059533872257@unknownmsgid>
References: <-6465265059533872257@unknownmsgid>
Message-ID: <94075b150902211616t759b6688ya56d15aaed9d94f1@mail.gmail.com>

Why not give matplotlib an absolute path?  You could get the document
root from mod_python and os.path.join() it to the subdirectory you
want to save to.

Whenever I've written scripts that save figures with matplotlib, I
always specify absolute paths and I've never had a problem.

:) David

On Sat, Feb 21, 2009 at 6:12 PM, Ron Phelps <rphelps@redshift.com> wrote:
> I have successfully configured mod_python and using some python scripts
> am accessing a database for the purpose of generating plots using
> matplotlib.
>
> The problem is that when I try to save a plot to a subdir of the Apache
> document root I get the following error.
>
> '/root' is not a writable dir; you must set the environment variable
> HOME to be a writable dir
>
> echo $HOME  returns '/root' but setting it to the correct path and even
> changing the dir permissions does no good.
>
> Tried useing the MPLCONFIGDIR to point to a MATPLOTLIBRC file but no
> luck there either.
>
> Does anyone know What HOME variable is this error message referring to?
>
> BTW Graham, I came across your article on "modwsgi" though it may not be
> directly related I will read it in hopes it gives me some insight.
>
> All help appreciated.
>
> Thanks
>
> Ron
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From dofre1680 at gmail.com  Thu Feb 26 14:24:26 2009
From: dofre1680 at gmail.com (Fred)
Date: Thu Feb 26 14:24:36 2009
Subject: [mod_python] python_handler: Can't get/create interpreter
Message-ID: <7a0ebdbc0902261124r6871342du86ced8efb9c83e3a@mail.gmail.com>

Hello,

maybe i have a bad mod_python install on a RHEL 4.5.

I compile apache, mod_python and python, and install all  inside /freeware
(it's a customer need).
- /freeware/python-2.5.4/
- /freeware/apache-2.2.6/
When run, apache use a linux user call "web".

Version :
- apache 2.2.6
- mod_python 3.3.1
- python 2.5.1 (and test with the last 2.5.4)

I try this example ( because i have some error with the Pylons application
that i have to install) :
http://www.modpython.org/live/current/doc-html/inst-testing.html

When i try to access  to http://server/test/mptest.py i have a 500 server
error.

When i look at log i have (for each request) :
[Thu Feb 26 19:46:29 2009] [error] [client X.X.X.X] python_handler: Can't
get/create interpreter

this the only message inside error log....

I try to re compil apache mod_python and python but i don't find any
solution.

I try the same thing with a distribution packages (python, mod_python and
apache) install on ubuntu hardy and it's works.... (just to say that i'm not
too stupid)!

I have nos idea... this my virtual host apache.conf content include inside
the main conf file :
<VirtualHost *:80>
    ServerAdmin webmaster@dummy-host.example.com
    DocumentRoot "/dataweb/sws"
    ServerName dns
    ErrorLog "/dataweb/sws/logs/sws-error_log"
    CustomLog "/dataweb/sws/logs/sws-access_log" common

<Directory /dataweb/sws/test>
        Options None
        AllowOverride None
        Order allow,deny
        Allow from all
        AddHandler mod_python .py
        PythonHandler mptest
        PythonDebug On
        #PythonPath "sys.path+['/freeware/python-2.5.4/bin']"

</Directory>
SetEnv LD_LIBRARY_PATH /freeware/python-2.5.4/lib/python2.5/:/freeware/lib/


</VirtualHost>

need help please.

thanks in advance.

fred
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20090226/13dbc1f6/attachment.html
From graham.dumpleton at gmail.com  Thu Feb 26 17:04:11 2009
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Feb 26 17:04:18 2009
Subject: [mod_python] python_handler: Can't get/create interpreter
In-Reply-To: <7a0ebdbc0902261124r6871342du86ced8efb9c83e3a@mail.gmail.com>
References: <7a0ebdbc0902261124r6871342du86ced8efb9c83e3a@mail.gmail.com>
Message-ID: <88e286470902261404r739ff58bwd48ca380b68d5673@mail.gmail.com>

2009/2/27 Fred <dofre1680@gmail.com>:
> Hello,
>
> maybe i have a bad mod_python install on a RHEL 4.5.
>
> I compile apache, mod_python and python, and install all? inside /freeware
> (it's a customer need).
> - /freeware/python-2.5.4/
> - /freeware/apache-2.2.6/
> When run, apache use a linux user call "web".
>
> Version :
> - apache 2.2.6
> - mod_python 3.3.1
> - python 2.5.1 (and test with the last 2.5.4)
>
> I try this example ( because i have some error with the Pylons application
> that i have to install) :
> http://www.modpython.org/live/current/doc-html/inst-testing.html
>
> When i try to access? to http://server/test/mptest.py i have a 500 server
> error.
>
> When i look at log i have (for each request) :
> [Thu Feb 26 19:46:29 2009] [error] [client X.X.X.X] python_handler: Can't
> get/create interpreter

Most likely because you have multiple versions of Python installed in
different root locations and when mod_python tries to initialise the
Python interpreter it is finding the root directory for the wrong one
and so cannot find the installed files for the correct one.

> this the only message inside error log....
>
> I try to re compil apache mod_python and python but i don't find any
> solution.
>
> I try the same thing with a distribution packages (python, mod_python and
> apache) install on ubuntu hardy and it's works.... (just to say that i'm not
> too stupid)!
>
> I have nos idea... this my virtual host apache.conf content include inside
> the main conf file :
> <VirtualHost *:80>
> ??? ServerAdmin webmaster@dummy-host.example.com
> ??? DocumentRoot "/dataweb/sws"
> ??? ServerName dns
> ??? ErrorLog "/dataweb/sws/logs/sws-error_log"
> ??? CustomLog "/dataweb/sws/logs/sws-access_log" common
>
> <Directory /dataweb/sws/test>
> ??????? Options None
> ??????? AllowOverride None
> ??????? Order allow,deny
> ??????? Allow from all
> ??????? AddHandler mod_python .py
> ??????? PythonHandler mptest
> ??????? PythonDebug On
> ??????? #PythonPath "sys.path+['/freeware/python-2.5.4/bin']"

There is no reason you would want to add the 'bin' directory to PythonPath.

> </Directory>
> SetEnv LD_LIBRARY_PATH /freeware/python-2.5.4/lib/python2.5/:/freeware/lib/

This SetEnv will do nothing for mod_python code.

>
> </VirtualHost>
>
> need help please.

Find the 'envars' file in same directory as 'httpd' for Apache which
is being used and add:

  PYTHONHOME=/freeware/python-2.5.4
  export PYTHONHOME

The file should be present if compiled Apache from source code. If you
are using a package Apache then it may not exist because they screwed
with Apache layouts. In that case you have to find the right init.d
startup file for Apache and hack it into there.

Restart Apache.

BTW, if using a web application which supports WSGI, you would be
better off using mod_wsgi. It is a bit more friendly as far as
overriding this sort of problem as one can set a directive in the
Apache configuration itself to indicate where Python is installed.
See:

  http://code.google.com/p/modwsgi/wiki/InstallationIssues#Multiple_Python_Versions

Just don't run mod_python and mod_wsgi at the same time though else
that directive will not work as mod_python still overrides things.

Graham

From dofre1680 at gmail.com  Fri Feb 27 05:27:36 2009
From: dofre1680 at gmail.com (Fred)
Date: Fri Feb 27 05:27:42 2009
Subject: [mod_python] python_handler: Can't get/create interpreter
In-Reply-To: <88e286470902261404r739ff58bwd48ca380b68d5673@mail.gmail.com>
References: <7a0ebdbc0902261124r6871342du86ced8efb9c83e3a@mail.gmail.com>
	<88e286470902261404r739ff58bwd48ca380b68d5673@mail.gmail.com>
Message-ID: <7a0ebdbc0902270227y6598d2ccybaab5a0cabdbabd7@mail.gmail.com>

2009/2/26 Graham Dumpleton <graham.dumpleton@gmail.com>

> 2009/2/27 Fred <dofre1680@gmail.com>:
> > When i look at log i have (for each request) :
> > [Thu Feb 26 19:46:29 2009] [error] [client X.X.X.X] python_handler: Can't
> > get/create interpreter
>
> Most likely because you have multiple versions of Python installed in
> different root locations and when mod_python tries to initialise the
> Python interpreter it is finding the root directory for the wrong one
> and so cannot find the installed files for the correct one.
>
>
> Find the 'envars' file in same directory as 'httpd' for Apache which
> is being used and add:

this file is not present so i use the second choice you explain.

>
>
>  PYTHONHOME=/freeware/python-2.5.4
>  export PYTHONHOME
>
> The file should be present if compiled Apache from source code. If you
> are using a package Apache then it may not exist because they screwed
> with Apache layouts. In that case you have to find the right init.d
> startup file for Apache and hack it into there.

i add it (export PYTHONHOME=/freeware/python-2.5.4) to my init.d apache2
script and it's works!!!
great :)


>
>
> Restart Apache.
>
> BTW, if using a web application which supports WSGI, you would be
> better off using mod_wsgi. It is a bit more friendly as far as
> overriding this sort of problem as one can set a directive in the
> Apache configuration itself to indicate where Python is installed.
> See:
>
>
> http://code.google.com/p/modwsgi/wiki/InstallationIssues#Multiple_Python_Versions
>
> Just don't run mod_python and mod_wsgi at the same time though else
> that directive will not work as mod_python still overrides things.

The application  i have to maintain use this 2 modules at the same time, i
think, because they are loaded in conf of apache.
It use cgi for the first part (python script with mod_python) and wsgi with
pylons on second part.
so i have to read some documentation to understanding apache conf with
mod_python and modwsgi use at the same time....
Thanks a lot for your help!
fred
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20090227/0b9d4715/attachment.html
From rphelps at redshift.com  Sat Feb 28 19:51:00 2009
From: rphelps at redshift.com (Ron Phelps)
Date: Sat Feb 28 19:51:36 2009
Subject: [mod_python] can't import python scripts into my index.py file
Message-ID: <1235868660.16521.15.camel@quirky>

I have similar mod_python setups at work and home. The differences are
at work the setup is Ubuntu Gutsy and at home I have Ubuntu Feisty so
the home installation uses 3.2 mod_python and the work 3.3. The other
difference is at home I have apache2 configured for two virtual
websites. The work installation is only one website. 

The problem is I can't import python scripts from index.py on my home
installation but I have no problem at work. Scripts in both
installations are in the home directory of the website.

-------------------
Code example from work, index.py uses a href link to call the following
python script all imports work eps_extract is python script in the same
directory as index.py

from cgi import escape
from urllib import unquote

#Import database and plotting functions
from select import select
import eps_extract

def frame():
	
	s = """\
	...
	html code here
	..."""

    return s

def plots():

	etc ...

------------------------
Code example from home - index.py:
I have tried simply using the import statement as above
and like below. The scripts weatherstation and pexpect are in the same
directory as index.py

import sys, os
from mod_python import apache
weatherstation = apache.import_module("weatherstation")
pexpect  = apache.import_module("pexpect")

Mod_python returns

ImportError: No module named weatherstation


Thanks for any help you can give. 

Ron 


From graham.dumpleton at gmail.com  Sat Feb 28 23:45:12 2009
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sat Feb 28 23:45:17 2009
Subject: [mod_python] can't import python scripts into my index.py file
In-Reply-To: <1235868660.16521.15.camel@quirky>
References: <1235868660.16521.15.camel@quirky>
Message-ID: <88e286470902282045t27e5340akfdc6d400448058da@mail.gmail.com>

2009/3/1 Ron Phelps <rphelps@redshift.com>:
> I have similar mod_python setups at work and home. The differences are
> at work the setup is Ubuntu Gutsy and at home I have Ubuntu Feisty so
> the home installation uses 3.2 mod_python and the work 3.3. The other
> difference is at home I have apache2 configured for two virtual
> websites. The work installation is only one website.
>
> The problem is I can't import python scripts from index.py on my home
> installation but I have no problem at work. Scripts in both
> installations are in the home directory of the website.
>
> -------------------
> Code example from work, index.py uses a href link to call the following
> python script all imports work eps_extract is python script in the same
> directory as index.py
>
> from cgi import escape
> from urllib import unquote
>
> #Import database and plotting functions
> from select import select
> import eps_extract
>
> def frame():
>
> ? ? ? ?s = """\
> ? ? ? ?...
> ? ? ? ?html code here
> ? ? ? ?..."""
>
> ? ?return s
>
> def plots():
>
> ? ? ? ?etc ...
>
> ------------------------
> Code example from home - index.py:
> I have tried simply using the import statement as above
> and like below. The scripts weatherstation and pexpect are in the same
> directory as index.py
>
> import sys, os
> from mod_python import apache
> weatherstation = apache.import_module("weatherstation")
> pexpect ?= apache.import_module("pexpect")
>
> Mod_python returns
>
> ImportError: No module named weatherstation
>
>
> Thanks for any help you can give.

Simple, upgrade your home machine so it matches the latest version of
mod_python (3.3.1) used at work.

The module importer has lots of problems in the older version and you
really do not want to use it.

Once you have upgraded and use same version on both, then read the
documentation. Specifically that for import_module() in:

  http://www.modpython.org/live/current/doc-html/pyapi-apmeth.html

Graham


Graham

