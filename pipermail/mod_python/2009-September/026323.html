<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Cache management in a mod_python environment
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Cache%20management%20in%20a%20mod_python%20environment&In-Reply-To=1252084980.10347.20.camel%40welling-laptop">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026322.html">
   <LINK REL="Next"  HREF="026324.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Cache management in a mod_python environment</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Cache%20management%20in%20a%20mod_python%20environment&In-Reply-To=1252084980.10347.20.camel%40welling-laptop"
       TITLE="[mod_python] Cache management in a mod_python environment">graham.dumpleton at gmail.com
       </A><BR>
    <I>Fri Sep  4 20:00:10 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="026322.html">[mod_python] Cache management in a mod_python environment
</A></li>
        <LI>Next message: <A HREF="026324.html">[mod_python] Apache.msi/Mod_python integration
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26323">[ date ]</a>
              <a href="thread.html#26323">[ thread ]</a>
              <a href="subject.html#26323">[ subject ]</a>
              <a href="author.html#26323">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>2009/9/5 Joel Welling &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">welling at psc.edu</A>&gt;:
&gt;<i> Hi folks;
</I>&gt;<i> &#160;I've written a web utility which generates images in mod_python, and
</I>&gt;<i> I'd like to keep recently generated images in a LRU cache. &#160;I don't
</I>&gt;<i> understand the threading environment, however, and if many instances of
</I>&gt;<i> my app try to manage the cache simultaneously they'll get it wrong.
</I>&gt;<i> &#160;If I run a mod_python page under apache, each httpd ends up creating
</I>&gt;<i> its own instance of the mod_python program, correct?
</I>
Each process has its own Python interpreter instance.

&gt;<i> If a given httpd
</I>&gt;<i> services two requests at the same time, does a separate instance of the
</I>&gt;<i> module get created or does the function generating the page get run in
</I>&gt;<i> two different threads?
</I>
For a thread MPM such as worker MPM for Apache, multiple threads
execute in context of same interpreter and same loaded code. In single
thread prefork MPM for Apache, all requests are serialised, so not an
issue.

&gt;<i> Is there any data structure I can attach cache
</I>&gt;<i> information to that will survive between requests within the same httpd?
</I>
Within same httpd process, yes. Basically place it as global data in a
standard Python module. If multithreaded, updates and maybe reads may
need to be threaded protected of requires multiple operations which
together aren't atomic.

Have a read of:

  <A HREF="http://www.dscpl.com.au/wiki/ModPython/Articles/TheProcessInterpreterModel">http://www.dscpl.com.au/wiki/ModPython/Articles/TheProcessInterpreterModel</A>
  <A HREF="http://www.modpython.org/live/current/doc-html/pyapi-apmeth.html">http://www.modpython.org/live/current/doc-html/pyapi-apmeth.html</A>

In the latter, read about import_module() function. This is relevant
as that is what is used to handle imports of mod_python script files
and there is a section in there about preserving cached data across
reloads of the script when changes are made to script.

Graham

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="026322.html">[mod_python] Cache management in a mod_python environment
</A></li>
	<LI>Next message: <A HREF="026324.html">[mod_python] Apache.msi/Mod_python integration
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26323">[ date ]</a>
              <a href="thread.html#26323">[ thread ]</a>
              <a href="subject.html#26323">[ subject ]</a>
              <a href="author.html#26323">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
