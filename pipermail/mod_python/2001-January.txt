From arhiv at freemail.org.mk  Mon Jan  1 21:54:25 2001
From: arhiv at freemail.org.mk (Damjan)
Date: Fri Jan  9 21:46:08 2004
Subject: [mod_python] Sugestion about publisher
Message-ID: <20010101215425.A606@localhost.localdomain>

Here is a small patch for mod_python.publisher, that instead of raising an
error when there is no PATH_INFO, it substitutes a default PATH_INFO. 
(I choose index_html, perhaps a diferent default method can be chosen)

That way when we call a script without specifying a method, the method
index_html is called.

--- publisher.py.old    Mon Jan  1 21:48:04 2001
+++ publisher.py        Mon Jan  1 21:47:39 2001
@@ -81,7 +81,7 @@
 
     # get the path PATH_INFO (everthing after script)
     if not _req.subprocess_env.has_key("PATH_INFO"):
-        raise apache.SERVER_RETURN, apache.HTTP_NOT_FOUND
+        _req.subprocess_env["PATH_INFO"]="/index_html"
     
     func_path = _req.subprocess_env["PATH_INFO"][1:] # skip fist /
     func_path = string.replace(func_path, "/", ".")


-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From peter.bittner at gmx.net  Tue Jan  2 14:22:37 2001
From: peter.bittner at gmx.net (peter.bittner@gmx.net)
Date: Fri Jan  9 21:46:09 2004
Subject: [mod_python] mod_python vs. PyApache, mod_snake
Message-ID: <1294.978441757@www32.gmx.net>

Hi there!

I've heard about that Python is available as a module for Apache too!
That's cool, but what is right for me?

 mod_python, PyApache oder mod_snake?

I've sound them all three.
I want to either use CGI or embedded Python (embedded in HTML) - or both.
Can anyone tell me what is best for me?

Cheers,
Peter

-- 
Peter Bittner
web: http://beam.to/peter.bittner
mail: peter.bittner@gmx.net
mobile: +43/(0)650/8901150
+-----------------------------
| HTML-Minikurs:  http://beam.to/htmlkurs
| Gesundheit:  http://www.gesundheitsfoerderung.at
| Fasten:  http://www.gesundheitsfoerderung.at/fasten

Sent through GMX FreeMail - http://www.gmx.net


From grisha at ispol.com  Tue Jan  2 17:22:09 2001
From: grisha at ispol.com (Gregory Trubetskoy)
Date: Fri Jan  9 21:46:09 2004
Subject: [mod_python] Sugestion about publisher
In-Reply-To: <20010101215425.A606@localhost.localdomain>
Message-ID: <Pine.LNX.4.21.0101021718210.28295-100000@saturn.ispol.com>

But I wonder what the usability of such a feature might be. (I'm not
aysing I'm against it, I'd just like to have a small discussion about it
first). 

In general, I do not like implicit or default stuff like this - I think if
you're specifying a module without a method, you should get nothing in
return. 

Another note - this modifies PATH_INFO. I think PATH_INFO should always
represent what the user passed. 


On Mon, 1 Jan 2001, Damjan wrote:

> Here is a small patch for mod_python.publisher, that instead of raising an
> error when there is no PATH_INFO, it substitutes a default PATH_INFO. 
> (I choose index_html, perhaps a diferent default method can be chosen)
> 
> That way when we call a script without specifying a method, the method
> index_html is called.
> 
> --- publisher.py.old    Mon Jan  1 21:48:04 2001
> +++ publisher.py        Mon Jan  1 21:47:39 2001
> @@ -81,7 +81,7 @@
>  
>      # get the path PATH_INFO (everthing after script)
>      if not _req.subprocess_env.has_key("PATH_INFO"):
> -        raise apache.SERVER_RETURN, apache.HTTP_NOT_FOUND
> +        _req.subprocess_env["PATH_INFO"]="/index_html"
>      
>      func_path = _req.subprocess_env["PATH_INFO"][1:] # skip fist /
>      func_path = string.replace(func_path, "/", ".")
> 
> 
> -- 
> Damjan Georgievski		|           ???????????? ??????????????????????
> Skopje, Macedonia		|           ????????????, ????????????????????
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From mecury at illusion.snu.ac.kr  Wed Jan  3 10:57:12 2001
From: mecury at illusion.snu.ac.kr (sjw)
Date: Fri Jan  9 21:46:09 2004
Subject: [mod_python] A Newbie's question,
Message-ID: <Pine.GSO.4.05.10101031051530.18076-100000@illusion>

hmm, I've installed mod_python and tested it

and it was ok..

( the code is the sample code, like following..

from mod_python import apache
 
def handler(req):
    req.send_http_header()
    req.write("Hello World!")
    return apache.OK  )

BUT, All I want to do is paste a simple, text counter 

to my homepage, like <!--#exec cgi="some/dirs/counter.cgi?id=myID"-->

did.

How can I do that with mod-python?..

Thanks in advance



From dyeung at ust.hk  Wed Jan  3 13:47:56 2001
From: dyeung at ust.hk (David YEUNG)
Date: Fri Jan  9 21:46:09 2004
Subject: [mod_python] Error with the req.register_cleanup
Message-ID: <3A52BD0C.9BA9B475@ust.hk>

Is there any code example how to use the 'req.register_cleanup()'?
I tried to put a function to disconnect the database through the
req.register_cleanup as following:


def index(req):
  ...
  db = MySQLdb.connect(...)
  cur = db.cursor()
  req.register_cleanup(disconnectdb,cur)
  ...
  ... some db query

def disconnectdb(cur):
  db = cur.connection
  cur.close()
  db.close()

  
The apache error_log file keeps displaying the following errors whenever
I invoke the 'register_cleanup' methods. If I do not use the 'register_cleanup',
but call the 'disconnectdb' at the end of the 'index' function. There is no
error in the log file.

---- error_log ----
[Tue Jan  2 21:32:28 2001] [notice] child pid 31239 exit signal Aborted (6)
Fatal Python error: PyThreadState_Get: no current thread
[Tue Jan  2 21:32:40 2001] [notice] child pid 31238 exit signal Aborted (6)
Fatal Python error: PyThreadState_Get: no current thread
[Tue Jan  2 21:32:46 2001] [notice] child pid 31241 exit signal Aborted (6)
Fatal Python error: PyThreadState_Get: no current thread 


I am using Apache 1.3.14 on RedHat 6.2, mod_python 2.7.1, MySQLdb 0.3.0.

Thanks for any advice.


David Yeung

From aperis at bemarnet.es  Thu Jan  4 16:10:49 2001
From: aperis at bemarnet.es (Arturo Peris)
Date: Fri Jan  9 21:46:09 2004
Subject: [mod_python] util.FieldStorage(req).list
Message-ID: <3A549279.6090905@bemarnet.es>

Hi,
my problem is with util.FieldStorage, I can't get information contained 
in content variable.
I call my form.py program from here:

...<form action= "/mailing/form.py/handler" method="post">...
catsel, subcatsel and idisel are checkbox.


MY form.py PROGRAM
---------------------------------------------
from mod_python import apache
from pg import DB
import string
from mod_python import util

def handler(req,catsel,subcatsel,idisel):
  req.content_type = "text/html"
  req.send_http_header()
  content = util.FieldStorage(req).list
---------------------------------------------

Can ne1 help me ?

Thanks.


From grisha at ispol.com  Thu Jan  4 11:21:04 2001
From: grisha at ispol.com (Gregory Trubetskoy)
Date: Fri Jan  9 21:46:09 2004
Subject: [mod_python] util.FieldStorage(req).list
In-Reply-To: <3A549279.6090905@bemarnet.es>
Message-ID: <Pine.LNX.4.21.0101041112390.2246-100000@saturn.ispol.com>

If you are using the mod_python.publisher handler, then you cannot use
FieldStorage within it (because the publisher handler creates one for
you already), you have to use req.form variable, it's an instance of
util.FieldStorage.

I'm sorry I forgot to document this little fact...

--
  Gregory (Grisha) Trubetskoy
       grisha@ispol.com

On Thu, 4 Jan 2001, Arturo Peris wrote:

> Hi,
> my problem is with util.FieldStorage, I can't get information contained 
> in content variable.
> I call my form.py program from here:
> 
> ...<form action= "/mailing/form.py/handler" method="post">...
> catsel, subcatsel and idisel are checkbox.
> 
> 
> MY form.py PROGRAM
> ---------------------------------------------
> from mod_python import apache
> from pg import DB
> import string
> from mod_python import util
> 
> def handler(req,catsel,subcatsel,idisel):
>   req.content_type = "text/html"
>   req.send_http_header()
>   content = util.FieldStorage(req).list
> ---------------------------------------------
> 
> Can ne1 help me ?
> 
> Thanks.
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From norm at streamtheory.com  Thu Jan  4 22:29:02 2001
From: norm at streamtheory.com (Norman Boccone)
Date: Fri Jan  9 21:46:09 2004
Subject: [mod_python] undefined reference to Py_... error compiling apache
Message-ID: <3A5569AE.9060109@streamtheory.com>

I am on Solaris trying to compile mod_python 2.7.1 into apache 1.3.14.  
Compiling of python and mod_python are fine, make test on python is 
fine.  When I try to make apache I get the following errors:

gcc  -DSOLARIS2=270 -DUSE_EXPAT -I./lib/expat-lite -DNO_DL_NEEDED 
`./apaci`    \
     -o httpd buildmark.o modules.o modules/python/libpython.a 
modules/standard/libstandard.a main/libmain.a ./os/unix/libos.a 
ap/libap.a  lib/expat-lite/libexpat.a  -lsocket -lnsl
modules/python/libpython.a(mod_python.o): In function `make_interpreter':
mod_python.o(.text+0xa7): undefined reference to `Py_NewInterpreter'
mod_python.o(.text+0xe6): undefined reference to `PyThreadState_Swap'
modules/python/libpython.a(mod_python.o): In function 
`get_interpreter_data':
mod_python.o(.text+0x124): undefined reference to `PyDict_GetItemString'
...and a bunch more like this

Any idea how I can fix it?  I thought I followed the instructions exactly.


From arhiv at freemail.org.mk  Fri Jan  5 16:32:33 2001
From: arhiv at freemail.org.mk (Damjan)
Date: Fri Jan  9 21:46:09 2004
Subject: [mod_python] Sugestion about publisher
In-Reply-To: <Pine.LNX.4.21.0101021718210.28295-100000@saturn.ispol.com>; from grisha@ispol.com on Tue, Jan 02, 2001 at 05:22:09PM -0500
References: <20010101215425.A606@localhost.localdomain> <Pine.LNX.4.21.0101021718210.28295-100000@saturn.ispol.com>
Message-ID: <20010105163233.B633@localhost.localdomain>

On Tue, Jan 02, 2001 at 05:22:09PM -0500, Gregory Trubetskoy wrote:
> 
> But I wonder what the usability of such a feature might be. (I'm not
> aysing I'm against it, I'd just like to have a small discussion about it
> first). 

It's usable to me ;) but what do the other mod_python users think?

> In general, I do not like implicit or default stuff like this - I think if
> you're specifying a module without a method, you should get nothing in
> return.

Sometimes people write URL's by hand, and not always will they remember the
whole URL. The problem I see is that you get HTTP_NOT_FOUND for a subset of a
valid URL and IMHO it's not very intuitive compared to 'normal' URL handling.

And every web server has a default page for a directory (index.html..).
 
> Another note - this modifies PATH_INFO. I think PATH_INFO should always
> represent what the user passed. 

It does't modify it, it just specifies a default PATH_INFO when PATH_INFO doesn't
exist at all. But Ok, the patch can be made differrent (I just chouse the sollution with
minimal changes to publisher.py).


-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From rsalz at caveosystems.com  Fri Jan  5 11:02:35 2001
From: rsalz at caveosystems.com (Rich Salz)
Date: Fri Jan  9 21:46:09 2004
Subject: [mod_python] Sugestion about publisher
References: <20010101215425.A606@localhost.localdomain> <Pine.LNX.4.21.0101021718210.28295-100000@saturn.ispol.com> <20010105163233.B633@localhost.localdomain>
Message-ID: <3A55F01B.C1CF1802@caveosystems.com>

I can see the convenience of adding 'index.html' (hee hee :) to the
end of nothing else is there.  Or rather, I can see how it is nice
to mimic other behavior.  But the current hack is wrong.

In apache, if you ask for 'foo' and foo is a directory, the server
sends back a redirect, telling you to go for 'foo/' and then it does
the auto-indexing.

It *might* be worthwhile letting the user emulate that.

But I agree, do not include the current patch and do not modify
PATH_INFO
	/r$

From arhiv at freemail.org.mk  Fri Jan  5 18:19:16 2001
From: arhiv at freemail.org.mk (Damjan)
Date: Fri Jan  9 21:46:09 2004
Subject: [mod_python] Sugestion about publisher
In-Reply-To: <3A55F01B.C1CF1802@caveosystems.com>; from rsalz@caveosystems.com on Fri, Jan 05, 2001 at 11:02:35AM -0500
References: <20010101215425.A606@localhost.localdomain> <Pine.LNX.4.21.0101021718210.28295-100000@saturn.ispol.com> <20010105163233.B633@localhost.localdomain> <3A55F01B.C1CF1802@caveosystems.com>
Message-ID: <20010105181916.A1147@localhost.localdomain>

On Fri, Jan 05, 2001 at 11:02:35AM -0500, Rich Salz wrote:
> I can see the convenience of adding 'index.html' (hee hee :) to the
> end of nothing else is there.  Or rather, I can see how it is nice
> to mimic other behavior.  But the current hack is wrong.
> 
Ok. How about this:

--- publisher.py.old    Mon Jan  1 21:48:04 2001
+++ publisher.py        Fri Jan  5 18:16:34 2001
@@ -81,7 +81,11 @@

     # get the path PATH_INFO (everthing after script)
     if not _req.subprocess_env.has_key("PATH_INFO"):
-        raise apache.SERVER_RETURN, apache.HTTP_NOT_FOUND
+        loc = 'http://' + _req.connection.server.server_hostname
+        loc = loc + ':' + str(_req.connection.server.port)
+        loc = loc + _req.uri + '/index_html'
+        _req.headers_out['Location'] = loc
+        raise apache.SERVER_RETURN, apache.HTTP_MOVED_PERMANENTLY

     func_path = _req.subprocess_env["PATH_INFO"][1:] # skip fist /
     func_path = string.replace(func_path, "/", ".")


-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From rsalz at caveosystems.com  Fri Jan  5 12:49:31 2001
From: rsalz at caveosystems.com (Rich Salz)
Date: Fri Jan  9 21:46:09 2004
Subject: [mod_python] Sugestion about publisher
References: <20010101215425.A606@localhost.localdomain> <Pine.LNX.4.21.0101021718210.28295-100000@saturn.ispol.com> <20010105163233.B633@localhost.localdomain> <3A55F01B.C1CF1802@caveosystems.com> <20010105181916.A1147@localhost.localdomain>
Message-ID: <3A56092B.BB73AE22@caveosystems.com>

Very very cool.  A couple of (minor) things.

> +        loc = 'http://' + _req.connection.server.server_hostname
                  ^^^^^^^^^^
		should get it out of the uri, since it might be https

> +        loc = loc + ':' + str(_req.connection.server.port)
> +        loc = loc + _req.uri + '/index_html'
> +        _req.headers_out['Location'] = loc
> +        raise apache.SERVER_RETURN, apache.HTTP_MOVED_PERMANENTLY
					^^^^^^^^^^^^^^^^^^^^^^^^^^^
should be moved_temporarily, I'm fairly sure.

The whole thing should be controlled by a mod_python auto_index option,
or perhaps based on the DirectoryIndex apache config option?

Anyhow, something like this should go into the code!
	/r$

From arhiv at freemail.org.mk  Sat Jan  6 00:05:10 2001
From: arhiv at freemail.org.mk (Damjan)
Date: Fri Jan  9 21:46:09 2004
Subject: [mod_python] Sugestion about publisher
In-Reply-To: <20010105181916.A1147@localhost.localdomain>; from arhiv@freemail.org.mk on Fri, Jan 05, 2001 at 06:19:16PM +0100
References: <20010101215425.A606@localhost.localdomain> <Pine.LNX.4.21.0101021718210.28295-100000@saturn.ispol.com> <20010105163233.B633@localhost.localdomain> <3A55F01B.C1CF1802@caveosystems.com> <20010105181916.A1147@localhost.localdomain>
Message-ID: <20010106000510.B461@localhost.localdomain>

> Ok. How about this:
> 
> --- publisher.py.old    Mon Jan  1 21:48:04 2001
> +++ publisher.py        Fri Jan  5 18:16:34 2001
> @@ -81,7 +81,11 @@
> 
>      # get the path PATH_INFO (everthing after script)
>      if not _req.subprocess_env.has_key("PATH_INFO"):
> -        raise apache.SERVER_RETURN, apache.HTTP_NOT_FOUND
> +        loc = 'http://' + _req.connection.server.server_hostname
> +        loc = loc + ':' + str(_req.connection.server.port)
> +        loc = loc + _req.uri + '/index_html'
> +        _req.headers_out['Location'] = loc
> +        raise apache.SERVER_RETURN, apache.HTTP_MOVED_PERMANENTLY
> 
>      func_path = _req.subprocess_env["PATH_INFO"][1:] # skip fist /
>      func_path = string.replace(func_path, "/", ".")

Hmmm. 
I found a strange thing in mod_python, while playing with this patch.
The situation is this:
if you type a URL of a with a trailling '/' you get that
req.subprocess_env.["PATH_INFO"] doesn't exist but req.pathinfo is '/'.
Why is   req.subprocess_env.["PATH_INFO"] != req.pathinfo ??

-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From arhiv at freemail.org.mk  Fri Jan  5 21:20:10 2001
From: arhiv at freemail.org.mk (Damjan)
Date: Fri Jan  9 21:46:09 2004
Subject: [mod_python] Sugestion about publisher
In-Reply-To: <3A56092B.BB73AE22@caveosystems.com>; from rsalz@caveosystems.com on Fri, Jan 05, 2001 at 12:49:31PM -0500
References: <20010101215425.A606@localhost.localdomain> <Pine.LNX.4.21.0101021718210.28295-100000@saturn.ispol.com> <20010105163233.B633@localhost.localdomain> <3A55F01B.C1CF1802@caveosystems.com> <20010105181916.A1147@localhost.localdomain> <3A56092B.BB73AE22@caveosystems.com>
Message-ID: <20010105212010.A461@localhost.localdomain>

On Fri, Jan 05, 2001 at 12:49:31PM -0500, Rich Salz wrote:
> Very very cool.  A couple of (minor) things.
> 
> > +        loc = 'http://' + _req.connection.server.server_hostname
>                   ^^^^^^^^^^
> 		should get it out of the uri, since it might be https

I can't see where from in mod_python to get this ?!?

> > +        loc = loc + ':' + str(_req.connection.server.port)
> > +        loc = loc + _req.uri + '/index_html'
> > +        _req.headers_out['Location'] = loc
> > +        raise apache.SERVER_RETURN, apache.HTTP_MOVED_PERMANENTLY
> 					^^^^^^^^^^^^^^^^^^^^^^^^^^^
> should be moved_temporarily, I'm fairly sure.

Well, my Apache returns MOVED_PERMANENTLY for directories, I tried it with:

	damjan# nc local 80
	GET /manual HTTP/1.0

	HTTP/1.1 301 Moved Permanently
	Date: Fri, 05 Jan 2001 20:15:43 GMT
	Server: Apache-AdvancedExtranetServer/1.3.12
	Location: http://localhost.localdomain/manual/
	Connection: close
	Content-Type: text/html; charset=iso-8859-1
	...


> The whole thing should be controlled by a mod_python auto_index option,
> or perhaps based on the DirectoryIndex apache config option?
 
We can think of that later.

One question, should I use req.hostname or 
req.connection.server.server_hostname? (it may be diferent)


-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From rsalz at caveosystems.com  Fri Jan  5 20:28:09 2001
From: rsalz at caveosystems.com (Rich Salz)
Date: Fri Jan  9 21:46:09 2004
Subject: [mod_python] Sugestion about publisher
References: <20010101215425.A606@localhost.localdomain> <Pine.LNX.4.21.0101021718210.28295-100000@saturn.ispol.com> <20010105163233.B633@localhost.localdomain> <3A55F01B.C1CF1802@caveosystems.com> <20010105181916.A1147@localhost.localdomain> <3A56092B.BB73AE22@caveosystems.com> <20010105212010.A461@localhost.localdomain>
Message-ID: <3A5674A9.9B9FB3A8@caveosystems.com>

> > > +        loc = 'http://' + _req.connection.server.server_hostname
> >                   ^^^^^^^^^^
> >               should get it out of the uri, since it might be https
> 
> I can't see where from in mod_python to get this ?!?

Perhaps easiest to leave out the protocol, host, and port altogether.
Won't that work?  loc = _req.uri + /index_html ?

> Well, my Apache returns MOVED_PERMANENTLY for directories, I tried it with:

I must have old information, or an old server -- ncsa code. :)  Thanks.

> One question, should I use req.hostname or
> req.connection.server.server_hostname? (it may be diferent)

If you can't just omit it, then I think you want the second choice, but I'm
not 
very knowledgeable about virtual hosting.
	/r$

From grisha at ispol.com  Fri Jan  5 23:42:42 2001
From: grisha at ispol.com (Gregory Trubetskoy)
Date: Fri Jan  9 21:46:09 2004
Subject: [mod_python] Sugestion about publisher
In-Reply-To: <3A5674A9.9B9FB3A8@caveosystems.com>
Message-ID: <Pine.LNX.4.21.0101052340340.7443-100000@saturn.ispol.com>

> > One question, should I use req.hostname or
> > req.connection.server.server_hostname? (it may be diferent)

req.hostname is a better choice, since this is what the client
supplied. server.server_hostname is the name configured for this virtual
server. I think when you'tr using a default server feature, they may be
different.

grisha


From chris at voodooland.net  Sat Jan  6 21:02:09 2001
From: chris at voodooland.net (Chris Watson)
Date: Fri Jan  9 21:46:09 2004
Subject: [mod_python] mod_python.publisher handler question...
Message-ID: <Pine.BSF.4.21.0101062028510.6987-100000@open-systems.net>

I have seen people ask the same question I am about to in the archives.
But I didn't see an answer archived as well.

It's my understand that for each script in your python dir you NEED to
give it a PythonHandler of the same name? If I have foo.py and bar.py
I need to Directory directives one with PythonHandler foo one with
PythonHandler bar. Right?

What I read was that to eliminate this I could simply set the
PythonHandler to mod_python.publisher. And ALL .py scripts in the python
directory would work. But they don't. I'm sure I have it set wrong or I am
misreading the documentation. I have the following configured in apache:

<Directory /usr/local/share/apache/htdocs/python>
          AddHandler python-program .py
          PythonHandler mod_python.publisher
          PythonDebug On
</Directory>

And In that directory are 3 copies of the hell world script from the
documentation. Each with a different name and none of them work with the
above. If I change the handler name to one of the 3 scripts that one
script will work. Have I misread the doco and am wrong in interperating
that mod_python.publisher will execute *any* .py script thats called in a
url in the directory? OR have I simple not configured apache properly?

Im not on the list so reply to me directly please.

Thanks for you time. Have a good weekend everyone!

Chris




From aperis at bemarnet.es  Tue Jan  9 19:03:26 2001
From: aperis at bemarnet.es (Arturo Peris)
Date: Fri Jan  9 21:46:09 2004
Subject: [mod_python] req.form
Message-ID: <3A5B526E.40803@bemarnet.es>

Hi,
I use req.form variable (it's an instance of util.FieldStorage):
-------------------
content = req.form
lista = content.list
return lista
...

  [Field('Coste', '12'), Field('Coste', '10'), Field('Envios', '1'), 
Field('Return', '/mailing/gen_mail.py/handler')]
-------------------
and my question is, wath is the best way to get values from this list?

Thanks.


From djc at object-craft.com.au  Wed Jan 10 16:49:57 2001
From: djc at object-craft.com.au (Dave Cole)
Date: Fri Jan  9 21:46:09 2004
Subject: [mod_python] Publisher handler has a small problem...
Message-ID: <m33deshs6y.fsf@vole.object-craft.com.au>

If I make the following module hello.py available via the publisher
handler:

        """ Publisher example """
        import os
        
        def say(req, what="NOTHING"):
            return "I am saying %s" % what        

Then a browser request which looks like this:

        /hello/os/renames?old=/tmp/blah&new=/tmp/blah1

will actually work (as the apache user).  I am fairly sure that this
is not desirable...

If someone knows which modules you are importing in your code, they
will be able to call any non-builtin function anywhere in the
namespace.

Maybe the publisher handler should only allow objects to be published
if they have some sort of special attribute, __publish__ for example.

- Dave

-- 
http://www.object-craft.com.au


From Peter.GIANNOPOULOS at gemplus.com  Wed Jan 10 12:58:27 2001
From: Peter.GIANNOPOULOS at gemplus.com (Peter Giannopoulos)
Date: Fri Jan  9 21:46:09 2004
Subject: [mod_python] Server error message
Message-ID: <HEELLMEIEBHKANGCLEELCEGMCCAA.peter.giannopoulos@gemplus.com>

Hello,


I have a question that may have an obvious answer but for the life of me I
can't seem to find it.
Here goes:

Any and every time I use the publisher handler I get an error when I return
any except for a string.
example:


	def handler(req):
        req.content_type = "text/plain"
        req.send_http_header()
        req.write("Hello World!")

        return apache.OK




Displays :

	Hello World!HTTP/1.1 200 OK
	Date: Wed, 10 Jan 2001 17:48:44 GMT
	Server: Apache/1.3.14 (Unix) mod_python/2.7 Python/1.5.2
	Connection: close
	Transfer-Encoding: chunked
	Content-Type: text/html; charset=iso-8859-1

	<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
	<HTML><HEAD>
	<TITLE>200 OK</TITLE>
	</HEAD><BODY>
	<H1>OK</H1>
	The server encountered an internal error or
	misconfiguration and was unable to complete
	your request.<P>
	Please contact the server administrator,
	 petergi@gemplus.com and inform them of the time the error occurred,
	and anything you might have done that may have
	caused the error.<P>
	More information about this error may be available
	in the server error log.<P>
	<HR>
	<ADDRESS>Apache/1.3.14 Server at Medusa Port 80</ADDRESS>
	</BODY></HTML>




But there is nothing in the server logs.
Yet if a return a string instead (any string) even simply ( return " ").
It seems to be fine. Why? Can someone help me understand what is happening?






Peter Giannopoulos, Software Developer
Gemplus Software,   Advanced Projects Group

Phone: +15147322434
Fax:   +15147322401
Gemplus Card International
http://www.gemplus.com


-------------- next part --------------
A non-text attachment was scrubbed...
Name: Peter Giannopoulos.vcf
Type: text/x-vcard
Size: 613 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20010110/4bfcc954/PeterGiannopoulos.vcf
From grisha at ispol.com  Thu Jan 11 01:04:50 2001
From: grisha at ispol.com (Gregory Trubetskoy)
Date: Fri Jan  9 21:46:09 2004
Subject: [mod_python] Publisher handler has a small problem...
In-Reply-To: <m33deshs6y.fsf@vole.object-craft.com.au>
Message-ID: <Pine.LNX.4.21.0101110101550.2739-100000@saturn.ispol.com>

Looks like a rather big prolem to me...

I did some testing with ZPublisher, and it returns "Not Found" when trying
to access os, but does find string... 

I haven't studies the code yet o find out why. I'd rather there was a way
to solve this problem without anything like __publish__...

--
  Gregory (Grisha) Trubetskoy
       grisha@ispol.com

On 10 Jan 2001, Dave Cole wrote:

> If I make the following module hello.py available via the publisher
> handler:
> 
>         """ Publisher example """
>         import os
>         
>         def say(req, what="NOTHING"):
>             return "I am saying %s" % what        
> 
> Then a browser request which looks like this:
> 
>         /hello/os/renames?old=/tmp/blah&new=/tmp/blah1
> 
> will actually work (as the apache user).  I am fairly sure that this
> is not desirable...
> 
> If someone knows which modules you are importing in your code, they
> will be able to call any non-builtin function anywhere in the
> namespace.
> 
> Maybe the publisher handler should only allow objects to be published
> if they have some sort of special attribute, __publish__ for example.
> 
> - Dave
> 
> -- 
> http://www.object-craft.com.au
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From hz at lexgen.com  Fri Jan 12 16:21:47 2001
From: hz at lexgen.com (Hao Zhou)
Date: Fri Jan  9 21:46:09 2004
Subject: [mod_python] mod_python install woe
Message-ID: <20010112162147.A29475@hydrogene.lexgen.com>

Hi everyone,

I got the following error message when I tried to install mod_python
on a Sun machine running SunOS 5.7 with Python 1.5.2.

Could any one shed some light on how to correct it? Thanks a lot!

Hao

/usr/local/apache/bin/httpd -DSSL -d /etc/local/apache/ 
Syntax error on line 121 of /etc/local/apache/conf/httpd.conf:
Cannot load /etc/local/apache/libexec/mod_python.so into server:
ld.so.1: /usr/local/apache/bin/httpd: fatal: relocation error: file
/etc/local/apache/libexec/mod_python.so: symbol __muldi3: referenced
symbol not found


From arhiv at freemail.org.mk  Mon Jan 15 12:29:47 2001
From: arhiv at freemail.org.mk (Damjan)
Date: Fri Jan  9 21:46:09 2004
Subject: [mod_python] Server error message
In-Reply-To: <HEELLMEIEBHKANGCLEELCEGMCCAA.peter.giannopoulos@gemplus.com>; from Peter.GIANNOPOULOS@gemplus.com on Wed, Jan 10, 2001 at 12:58:27PM -0500
References: <HEELLMEIEBHKANGCLEELCEGMCCAA.peter.giannopoulos@gemplus.com>
Message-ID: <20010115122947.A458@localhost.localdomain>

On Wed, Jan 10, 2001 at 12:58:27PM -0500, Peter Giannopoulos wrote:
> Hello,
> 
> 
> I have a question that may have an obvious answer but for the life of me I
> can't seem to find it.
> Here goes:
> 
> Any and every time I use the publisher handler I get an error when I return
> any except for a string.
...
RTFM

The publisher handler EXPECTS the script it called to return the content.


-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From derek at realware.com.au  Tue Jan 16 09:51:16 2001
From: derek at realware.com.au (Derek Lavine)
Date: Fri Jan  9 21:46:09 2004
Subject: [mod_python] Making an exe
Message-ID: <048801c07f4e$0cfb0d10$315119cb@realware.com.au>

Hi all,

I am about to write a couple of little utils as my introduction in to the
python world. The thing is, I would like to be able to give some of these
utils to people that don't have python on their machines. To this end I
would like to create and EXE from the python code. I know this can be done
with ActiveState Perl but can it be done with Python

Thanks in advance
Derek


From grisha at ispol.com  Mon Jan 15 19:10:39 2001
From: grisha at ispol.com (Gregory Trubetskoy)
Date: Fri Jan  9 21:46:09 2004
Subject: [mod_python] Making an exe
In-Reply-To: <048801c07f4e$0cfb0d10$315119cb@realware.com.au>
Message-ID: <Pine.LNX.4.21.0101151909230.29452-100000@saturn.ispol.com>


What does this have to do with mod_python?


On Tue, 16 Jan 2001, Derek Lavine wrote:

> Hi all,
> 
> I am about to write a couple of little utils as my introduction in to the
> python world. The thing is, I would like to be able to give some of these
> utils to people that don't have python on their machines. To this end I
> would like to create and EXE from the python code. I know this can be done
> with ActiveState Perl but can it be done with Python
> 
> Thanks in advance
> Derek
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From derek at realware.com.au  Tue Jan 16 11:16:15 2001
From: derek at realware.com.au (Derek Lavine)
Date: Fri Jan  9 21:46:09 2004
Subject: [mod_python] Making an exe
References: <Pine.LNX.4.21.0101151909230.29452-100000@saturn.ispol.com>
Message-ID: <04aa01c07f59$ec719ee0$315119cb@realware.com.au>

Oops sorry posted to the wrong news group

Derek

----- Original Message -----
From: Gregory Trubetskoy <grisha@ispol.com>
To: Derek Lavine <derek@realware.com.au>
Cc: <Mod_python@modpython.org>
Sent: Tuesday, January 16, 2001 10:10 AM
Subject: Re: [mod_python] Making an exe


>
>
> What does this have to do with mod_python?
>
>
> On Tue, 16 Jan 2001, Derek Lavine wrote:
>
> > Hi all,
> >
> > I am about to write a couple of little utils as my introduction in to
the
> > python world. The thing is, I would like to be able to give some of
these
> > utils to people that don't have python on their machines. To this end I
> > would like to create and EXE from the python code. I know this can be
done
> > with ActiveState Perl but can it be done with Python
> >
> > Thanks in advance
> > Derek
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://www.modpython.org/mailman/listinfo/mod_python
> >
>
>


From rafi at voruta.ek.univ.gda.pl  Wed Jan 17 17:33:51 2001
From: rafi at voruta.ek.univ.gda.pl (rafal polonski)
Date: Fri Jan  9 21:46:09 2004
Subject: [mod_python] Debian 2.2 and mod_python
Message-ID: <20010117173350.A29278@voruta.ek.univ.gda.pl>

Hello,
I am trying to run mod_python on Debian 2.2 distribution.

Apache 1.3.9
Python 1.5.2 (with threads)
mod_python-2.7.1
gcc 2.95

Compiling as a DSO module goes without any error.
Of course I get a warning about having Python compiled WITH threads.

apache -X 
gives me Segmentation fault:
[Wed Jan 17 16:48:01 2001] [notice] caught SIGTERM, shutting down]

So probably I have to blame Python compiled with threads.


So I downloaded Python 1.6, compiled it without threads but trying to
compile mod_python with this 1.6 version gives this error:
gcc -shared -o mod_python.so mod_python.o _apachemodule.o requestobject.o
tableo
bject.o util.o serverobject.o connobject.o -lm
/tmp/modp/Python-1.6/libpython1.6
.a -lieee -ldl -lm -lc -lm -lcrypt -ldb
/usr/bin/ld: mod_python.so: undefined versioned symbol name
_LIB_VERSION@@GLIBC_
2.0
/usr/bin/ld: failed to set dynamic section sizes: Bad value
collect2: ld returned 1 exit status
apxs:Break: Command failed with rc=65536
make[1]: *** [mod_python.so] Error 1
make[1]: Leaving directory `/tmp/modp/mod_python-2.7.1/src'
make: *** [do_dso] Error 2
# 


So I downloaded Python 2.0, compiled it without threads.
With this Python version Apache and mod_python started.
I got quiet huge .so file:
2873238 Jan 17 17:26 mod_python.so 
Stripped version: 1601536 Jan 17 17:28 mod_python.so
Is that normal?


So the question is:
Can I compile mod_python with threaded Python 1.5.2? or just forget 
about threaded vesrion and use one without them?
Why did I get problems trying to use 1.6 Python version wit mod_python?

habe a nice day
rafal

From hunter at userfriendly.net  Wed Jan 17 20:20:21 2001
From: hunter at userfriendly.net (hunter)
Date: Fri Jan  9 21:46:09 2004
Subject: [mod_python] pydriver and apache
Message-ID: <3A6644D5.6F0FB794@userfriendly.net>

I am trying to get pydriver.py to run as a nsapi cgi using RedHat 7.0
Linux 2.2.16 apache 1.3.14 + mod_python webserver. I have this working
on linux/irix netscape enterprise server but not sure how to tell apache
to use pydriver as a cgi for all .py's

Any suggestions, help, comments would be GREATLY appreciated
Michael Weiner
Systems Administrator/Partner
The UserFriendly Network
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/x-pkcs7-signature
Size: 2626 bytes
Desc: S/MIME Cryptographic Signature
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20010117/46817411/smime.bin
From msandin at hotmail.com  Thu Jan 18 08:08:53 2001
From: msandin at hotmail.com (Martin Sandin)
Date: Fri Jan  9 21:46:09 2004
Subject: [mod_python] 'import site' failed
Message-ID: <OE9xG1UrHgmqzWTY0YA0000096a@hotmail.com>

Hello!

I'm trying to get mod_python up running and have run into the same problem
on both Win98 systems I've attempted this feat on. This after following the
instruction provided to the best of my abilities. Apache starts giving the
following message:

'import site' failed; use -v for traceback
Apache/1.3.12 (Win32) mod_python/2.6.3 Python/2.0 running...
'import site' failed; use -v for traceback

and then returning "internal server error" on the URLs pointing to Python
files. I've tracked dow that error message as something that
Python emitts. Thus given I'll ask this:

What does that error message mean? What has gone wrong? How can I fix it in
general? And if anyone knows, how can it be fixed in this particular case?



Configuration is as follows:

Apache 1.3.12 installed in c:\program\servers\apache\

mod_python.dll (for Python2.0) in the modules\ directory


In the httpd.conf file I've got the following lines where appropriate:

LoadModule python_module modules/mod_python.dll

DocumentRoot "C:/Data/Httpserver"

<Directory "C:/Data/Httpserver/python/">
AddHandler python-program .py
PythonHandler test
PythonDebug on
</Directory>


Python (2.0) itself resides in
C:\dev\Python20
which is also in the PATH. No PYPATH variable exists.

The mod_python directory, as extracted from the distribution located in
either of these (I've tried a bunch due to mod_pythons installation
instructions not being up to sync with the dist. archive)
C:\dev\Python20\mod_python\
C:\dev\Python20\lib\mod_python\
C:\dev\Python20\lib\python\mod_python\
C:\dev\Python20\lib\mod_python\python\mod_python\
etc.

The mod_python-2.6.4 directory has been similarly moved around (does it
matter at all?).


As a last piece of information, on the other machine I tried I used the
exact same (save some paths) configuration but with the latest (as of this
morning) versions of mod_python and Apache. The exact same problem.

THanks:-)


-
Martin Sandin
come.to/vague

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010118/0925d74b/attachment.htm
From hunter at userfriendly.net  Thu Jan 18 07:34:59 2001
From: hunter at userfriendly.net (hunter)
Date: Fri Jan  9 21:46:10 2004
Subject: [mod_python] mod_python and apache
Message-ID: <3A66E2F3.CC212E4F@userfriendly.net>

I wrote to the list the other day, asking about converting a webserver
currently using Netscape Enterprise Server and python-1.5.2c to apache
running mod_python and python-1.5.2c due to the licensing being cost
probihitive. We use the "py-driver" within the webserver as nsapi to
push all our .py/.pd/.pc files to the users with netscape configured as
follows:

<snip>
<Object name="default">
NameTrans fn="pfx2dir" from="/cgi-bin"
dir="/disk2/websites/american/cgi-bin" na
me="cgi"
NameTrans fn="document-root" root="/disk2/websites/american/html"
PathCheck fn="unix-uri-clean"
PathCheck fn="check-acl" acl="default"
PathCheck fn="find-pathinfo"
PathCheck fn="find-index" index-names="index.pd"
ObjectType fn="type-by-extension"
ObjectType fn="force-type" type="text/plain"
Service method="(GET|HEAD|POST)" type="magnus-internal/py-driver"
fn="query-hand
ler" path="/disk2/ns-home/nsapi/pd/py-driver"
Service method="(GET|HEAD)" type="magnus-internal/imagemap"
fn="imagemap"
Service method="(GET|HEAD)" type="magnus-internal/directory"
fn="index-common"
Service method="(GET|HEAD|POST)" type="*~magnus-internal/*"
fn="send-file"
</snip>

which basically treats all calls to the .py/.pds as a cgi. Now, in
trying to convert over to apache and mod_python and do the same thing
within the apache configuration is where i am getting a bit confused. I
read through some of the documentation and i think the cgihandler might
be the way to handle this, but thought i would ask more senior python
programmers. I am a systems administrator and nowhere near as
experienced in python as 99% of the group here. So, i am looking for
advice and suggestions to see if a "proof of concept" can even be done.
I realize this might include some python module re-writes but if thats
fairly minimal i am still one step ahead rather than using netscape.

The py-driver being called in the above configuration looks like the
following:

#!/usr/local/bin/python
import sys, os
sys.path.insert(0, '/disk2/ns-home/nsapi/pd/')
sys.path.insert(1, '/disk2/common/')
sys.path.insert(2, '/disk2/ns-home/nsapi/mp/')
import pydriver
pydriver.topmain()

which imports pydriver which looks like the following:

#!/usr/local/bin/python
# -*- Python -*-
# PythonDriver main interpreter
#
# 960701 JM added HTML header override (ie: cookies)
#
# 960618 JM added Advert class
#

# common object layer imports
from col.exception.bopageflagexception import BOPageFlagException

# other imports
import pccache

__version__ = "1.5"

PD_Okay  = "PD_Okay"                    # JM 960830

intSybFailFrac = 100      # one out of this number of sybase connect
fails will$

def pd_return(msg=''):
    raise PD_Okay, msg


def get_func(dict, name):
    if dict.has_key(name):
        cb = dict[name]
        if `type(cb)` == "<type 'function'>":
            return cb
    return None


class SmartPrint:
    def __init__(self, real_stdout, headers=''):
        self.need_headers = 1
        self.headers = headers
        self.real_stdout = real_stdout

##     def write(self, msg):
##      if self.need_headers:
##          try:
##              self.real_stdout.write(self.headers.show() + '\n')
##          except AttributeError:              ## XXXX
##              self.real_stdout.write(self.headers)

##      self.real_stdout.write(msg)
##      self.need_headers = 0



# JM 960517
#
#
def get_hostip(environ):
    try:
        return 'IP:' + environ['REMOTE_ADDR']
    except KeyError:
        return  'IP:unknown'                    # XX ugh

def dump(environ=None):
    if not environ:
        from os import environ

    list = environ.keys()
    list.sort()

    for k in list:
        print "<b>%s</b> %s<BR>" % (k, environ[k])

# JM 960708
# use the cookie class to get the session ID, or return ''
#

def get_sessionid(cookiedict):
    if cookiedict.has_key('ngs_sessionID'):
        #
        # Netsite: NGS session-id stuff installed
        #
        return cookiedict['ngs_sessionID'][:12]

    elif cookiedict.has_key('Apache'):
        #
        # Apache: mod_cookie installed + enabled
        #
        return cookiedict['Apache']

    else:
        #
        # no session-id thing
        #
        return ''


### if session ID not given,
### use client's IP address (XX debugging only!)
### JM 960517
##    if environ.has_key('HTTP_COOKIE'):
##      s = environ['HTTP_COOKIE'] # like "ngs_sessionID=23233885"
##
##      if 'ngs_sessionID=' == s[:14]:
##          s = s[14:14+12]
##      else:
##          s = get_hostip(environ)     # XX no session id: error here?
##
##    else:
##      # dump(environ)
##      s = get_hostip(environ)         # XX no session id: error here?
##
##    return s


def file_exists(path):
    try:
        open(path).close()
        return 1
    except IOError:
        return 0
# Figure out a few things about what will happen, and put
# a few extra things in the Python search path.
#
# - take the original PD script path (ie:
'/www/test/htdocs/Tests/if.pd')
#   (usually from the webserver's PATH_TRANSLATED variable).
#
# - turn it into the Python script path ('/www/test/htdocs/Tests/if.py')
#   and then containing directory ('/www/test/htdocs/Tests/').
#
# - insert the PD directory in sys.path, so that PD support files
#   (like 'cookie' and 'agent') will be found, and wont be overridden
#   by user app files.
#
# - chdir to the user's script directory, so that app-local files
#   can be found (sys.path contains '.') and written files will
#   be relative to the script.
#

def script_setup(path):

    import os, sys, string

    if os.path.isdir(path):
        if path[-1]!='/': path=path+'/'
        path=path+'index.pd'

    # replaced following line with a substitution to stop pydriver from
    # displaying the py code when the URL has a .py.  Set it back to .pd
    # -MC 8/6/99
    if path[-3:] == ".py":
       path = path[:-3] + ".pd"
       if os.environ.has_key('PATH_TRANSLATED'):
          os.environ['PATH_TRANSLATED'] = path

    templatepath = path
    scriptpath = path[:-2] + "py"
    scriptdir  = path[:string.rfind(path, '/')]
    pc_path    = path[:-2] + "pc"

    # make sure the PythonDriver dir is first on the path.
    # (1st, else 'cookie.py' was being overridden)
    # JM 961006
    # commented out. py-driver now puts this at front of path.
    # Mark Cain
    #sys.path.insert(0, os.getcwd())

    # raise KeyError, "vars=" + `locals()`

    sys.path.append(scriptdir)
    os.chdir(scriptdir)                 # JM 960827

    return (templatepath, scriptpath, pc_path, scriptdir)


# allow project information to be overridden by the user,
# either by 'project.py' in the script directory,
# or in the one just above (XX provide search-path?)
#

def import_project(pathlist=['.'], modnamelist=['project']):
    from uniondict import UnionDict

    info     = UnionDict()                      # union of all info
dicts
    project  = UnionDict()                      # union of *modules*
    mod_dict = {}                               # temporary variable
scope

    for file in modnamelist:

        # load the module
        #
        exec   "import "+file in mod_dict
        module = mod_dict[file]

        # add the module to the UnionDict,
        # so that its functions *override* earlier ones
        #
        project.prepend(module.__dict__)

        # add the 'info' dictionaries
        # so that just-loaded defs *override* earlier ones
        #
        if module.__dict__.has_key('info'):
            info.prepend(module.__dict__['info'])

    project.info = info
    return project


def html_print_techproblems():
#    print "Location: http://162.133.26.95/goo.po"
#    print "Content-length: 1"
#    print "\n\n"
#    import traceback
#    html_print_exc(traceback)
    try:
      import socket
      filNF = open('/disk2/flags/techproblems.html', 'r')
      print filNF.read() % socket.gethostname()
      filNF.close()
    except:
      print """
           <table><tr>
           <td align="center" width="312">
           <img src="/images/banner.gif" width=312 height=45 border=0
alt="" al$
           </td></tr></table>
            """
      print "<br><font size=+3><b>We're sorry.</b>"
      print "<p>We are repairing a technical problem. We apol$

def html_print_notfound(message=''):
    print "Content-type: text/html\n\n"
    try:
      filNF = open('/disk2/flags/notfound.html', 'r')
      print filNF.read()
      filNF.close()
      filNF.close()
    except:
      print """
           <table><tr>
           <td align="center" width="312">
           <img src="/images/banner.gif" width=312 height=45 border=0
alt="" al$
           </td></tr></table>
            """
      print "<br><font size=+3><b>Not Found</b></font>"
      print "<p>The requested file does not exist on our website."

def html_print_exc(traceback):
    import sys

    print "Content-type: text/html\n"
    print "<font size=+3><b>internal error</b></font><P><PRE>",
    traceback.print_exc(file=sys.stdout)
    print "</PRE>"
def cgi_main():
    import os, traceback

    if not os.environ.has_key('PATH_TRANSLATED'):
        print "Content-type: text/html\n"
        print "PATH_TRANSLATED not given"
        return

    try:
        main(os.environ['PATH_TRANSLATED'], os.environ)

    except IOError, msg:
        html_print_notfound(msg)
        print "<!--"
        html_print_exc(traceback)
        print "-->"
    except:
        html_print_techproblems()
        print "<!--"
        html_print_exc(traceback)
        print "-->"


def updatePC(pd_path, py_path, pc_path):
  import os, codetemplate, time
  dicPC = {}

  # get stats on files
  try:
    tupPD = os.stat(pd_path)
    tupPY = os.stat(py_path)
    try:
    try:
      tupPC = os.stat(pc_path)
    except:
      tupPC = None
  except:
    raise IOError, "not found"

  try:
    # if pc file doesn't exist, or is older than either of the others,
then rec$
    if (not tupPC or (tupPD[-2] > tupPC[-2]) or (tupPY[-2] >
tupPC[-2])):
      pd_script = codetemplate.PD_Script(pd_path)
      codPD = pd_script.code
      dicPdVars = pd_script.dicPdVars
      filTemp = open(py_path)
      codPY = compile(filTemp.read(), py_path, "exec")
      filTemp.close()
      dicPC = { 'py': codPY,
                'pd': codPD,
                'dicPdVars': dicPdVars,
                'pyDate': time.asctime(time.localtime(tupPY[-2])),
                'pdDate': time.asctime(time.localtime(tupPD[-2])),
                'pcDate': time.asctime(time.localtime(time.time()))
              }
      import marshal
      try:
        filPC = open(pc_path, 'w')
        marshal.dump(dicPC, filPC)
        filPC.close()
      except IOError:
        return
  except:
      #
      # since this function runs outside of normal execution (as in
production)
      # we add traceback error handling here. Else errors don't
propigate on th$
      # normal route, having failed at this early point.
      #
      import sys, traceback
      pd_except(py_path, sys.exc_type, sys.exc_value,
                        tb=traceback, globals=globals())
      #
      # Furthermore, no headers have been printed yet and "main"
execution is b$
      # We need the basic header printed here.
      #
      #print "Content-type: text/html\n\n"
      #
      # Stop further execution by raising an error. Brings us back to
cgi-main $
      # screen
      #
      raise "Failed"


def main(templatepath, environ=None):

    import sys, string, cgi, os, traceback, ctsybase

    dicPC = {}        # dictionary containing pd and py code objects
    blnInterpSrc = 0
    blnTechProb  = 0   # to note problem deserving of "tech problem"
message

    if not environ:
        environ=os.environ

    (pd_path, py_path, pc_path, scriptdir) = script_setup( templatepath
)

    if ((len (pd_path) > 13) and (pd_path[-13:] == "html/index.pd")):
        import posixpath
        HOMEFILE = '/disk2/flags/homelive.html'
        if posixpath.exists(HOMEFILE) == 0:
            import homedown
            print homedown.pageVar
            return

    import marshal, codetemplate, agent


    # get the 'project' module, but allow
    # it to be overidden (unlike all other modules. Ex: cookies.py)
    #
    project = import_project(scriptdir)

    from headers import Headers

    # ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    # run-time stuff
    # ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    finished   = 0
    headers    = Headers(environ)
    # print "info = " + `project.info`
    if project.info.has_key('cookie_domain'):
        headers.cookieSetDomain(project.info['cookie_domain'])

    session_id = get_sessionid(headers.cookie)


    # grab form variables
    #
    try:
        #          Old and outdated
        if not os.environ.has_key('QUERY_STRING'):
           os.environ['QUERY_STRING'] = ""
        webvars = cgi.SvFormContentDict(environ=os.environ)
        #webvars.__init__(os.environ)
        #webvars = cgi.FieldStorage()
    except:
        webvars = {}


    # grab Python global variables
    # XXX?
    script_dict = globals()

    # rename a few variables
    #

    # XX
    sp = SmartPrint(sys.stdout, headers)


    script_dict.update({
             'environ'    : environ,
             'session_id' : session_id,
             'webvars'    : webvars,
             'headers'    : headers,
             'scriptpath' : py_path,
             'project'    : project,
             'agent'      : agent.open(environ)
             })

    for k in ['dbopen', 'pd_except']:
        if project.has_key(k):
            script_dict[k] = project[k]

    # XX removed 961006 JM
    # 'agent'      : agent.open(environ),
    # 'advert'     : Advert(),
    # merge globals and other vars into one dictionary
    #
    #for k in dict2.keys():
#       script_dict[k] = dict2[k]
#
#    del dict2                          # dont need it anymore


    # try to execute the Python script.
    #

    # call updatePC to compile pd and py file and write to pc file
    # (do not call in production)
    #updatePC(pd_path, py_path, pc_path)

    try:
      if (sys.modules.has_key('pccache')):
        pccache = sys.modules['pccache']
        dicPC = pccache.load(pc_path)
      else:
        filPC = open(pc_path, 'r')
        dicPC = marshal.load(filPC)
        filPC.close()

    except IOError:
      pd_script = codetemplate.PD_Script(pd_path)
      blnInterpSrc = 1   # was unable to open compiled. Must interp.
    else:
      # load successful
      # create "empty" PD_Script object and set its code object (no
processing $
      pd_script = codetemplate.PD_Script()
      pd_script.code = dicPC['pd']
      if dicPC.has_key('dicPdVars'):
        pd_script.dicPdVars = dicPC['dicPdVars']
    script_dict['dicPdVars'] = pd_script.dicPdVars

    try:
      try:
          try:
            import pycodewrap
            pycodewrap.begin(script_dict)
          except BOPageFlagException, objException:
            raise objException
          except:
            pass
          if (blnInterpSrc):
            f = open(py_path)
            exec f in script_dict  # old
            f.close()
          else:
            exec (dicPC['py'] , script_dict) # new
          try:
            pycodewrap.end(script_dict)
          except:
            pass

      except PD_Okay, msg:
          # XX print msg somewhere?
          pass

      # catch and ignore broken pipe errors
      except IOError, lstErr:
        if lstErr[1] == 'Broken pipe':
          pass
        else:
          raise lstErr
      except ctsybase.error, lstErr:
        if lstErr[0] == 'failed to connect to server':
          blnTechProb = 1
          import time
          fltTime = time.time()
          intTemp = int (( int(fltTime) + ((fltTime - int(fltTime)) *
10000)) %$
          if intTemp == 0:
            raise ctsybase.error + ": " + str(lstErr)
          else:
            pass
            #raise "sybase error"

      # catch BOPageFlagException to throw up alternate page
      except BOPageFlagException, objException:
          blnTechProb = 0
          finished = 1                # XX run PD script after error
          if sp.need_headers:

              # was >> print "Content-type: text/html\n"

              try:
                  print script_dict['headers'].show()
              except AttributeError:
                  print script_dict['headers']

          # headers were printed -- turn them off
          #
          sp.need_headers = 0

          try:
            filT = open(objException.strFile, 'r')
            strText = filT.read()
            filT.close()
         except IOError:
            objT = IOError("BOPageFlagException, can't open file '%s'" %
objExc$
            raise objT
          if objException.dicVariables:
            strText = strText % objException.dicVariables
          print strText

          # if objException.blnTraceback is true, then do the traceback
anyhow
          if objException.blnTraceback:
            # does PY script have a custom exception handler?
            # if so, use it; else use default: 'pd_except'.
            #
            cb = get_func(script_dict, '__except__')
            if not cb:
                cb = pd_except

            finished = not cb(py_path, sys.exc_type, sys.exc_value,
                              tb=traceback, globals=globals())
    # catch all for tracebacks
    except:
        blnTechProb = 1
        finished = 0                # XX run PD script after error

        if sp.need_headers:

            # was >> print "Content-type: text/html\n"

            try:
                print script_dict['headers'].show()
            except AttributeError:
                print script_dict['headers']

        # headers were printed -- turn them off
        #
        sp.need_headers = 0

        # does PY script have a custom exception handler?
        # if so, use it; else use default: 'pd_except'.
        #
        cb = get_func(script_dict, '__except__')
        if not cb:
            cb = pd_except

        finished = not cb(py_path, sys.exc_type, sys.exc_value,
                          tb=traceback, globals=globals())


    #f.close()


    # did the PY script take care of everything? (IE: file download,
    # exception handler doesnt want to show PD).
    # If so, then just return -- *dont* execute PD script.
    # JM 960829

    if blnTechProb:
       if sp.need_headers:
           # was >> print "Content-type: text/html\n"
           try:
               print script_dict['headers'].show()
           except AttributeError:
               print script_dict['headers']
       html_print_techproblems()
       print "<!-- "
       html_print_exc(traceback)
       print "--> "
       return
    if finished or script_dict['headers'].finished():
        return


    # go ahead and print out HTTP headers now.
    # if its whacked, just default it:
    #
    if sp.need_headers:
        try:
            print script_dict['headers'].show()
            #print ' *** ' + dict['headers'].show() + ' *** '
        except AttributeError:
            print script_dict['headers']

    try:
      print pd_script.run(script_dict)
    # catch and ignore broken pipe errors
    except IOError, lstErr:
      if lstErr[1] == 'Broken pipe':
        pass
      else:
        raise lstErr

    except:
      import sys, traceback
      pd_except(py_path, sys.exc_type, sys.exc_value,
                        tb=traceback, globals=globals())
      html_print_techproblems()
      print "<!-- "
      html_print_exc(traceback)
      print "--> "

    return
def topmain():
    import os, sys, posixpath

    SFILE = '/disk2/flags/dblive.html'
    error = ""
    if posixpath.exists(SFILE) == 0:
        import dbdown
        pageVar = dbdown.pageVar
        error = "DBBAD"

    if error:
        print pageVar
    elif os.environ.has_key('PATH_TRANSLATED'):
        import traceback
        try:
            cgi_main()
        except:
            print "<font size=+1>%s: problems</font><P>" %
"PythonDriver"

            print "<PRE>",
            traceback.print_exc()
            print "</PRE>"

    elif len(sys.argv) > 1:

        import string

        scriptpath = sys.argv[1]

        os.environ['REQUEST_METHOD'] = 'GET'
        os.environ['QUERY_STRING']   = string.joinfields( sys.argv[2:],
'&' )

        main(scriptpath, os.environ)
    else:

        print "usage: py-driver <script> [GET-style args...]"

if __name__=="__main__":
    main()


Any help would be GREATLY appreciated. I just need to mimic the netscape
behavior within apache, and i am having problems doing so. Maybe
mod_python isnt the way to go, but if anyone has any ideas for me to
try, i would be extremely greatful

Michael Weiner
Systems Administrator/Partner
The UserFriendly Network
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/x-pkcs7-signature
Size: 2626 bytes
Desc: S/MIME Cryptographic Signature
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20010118/51182ff7/smime.bin
From GManoj at chn.cognizant.com  Thu Jan 18 20:14:53 2001
From: GManoj at chn.cognizant.com (Govindan, Manoj (CTS))
Date: Fri Jan  9 21:46:10 2004
Subject: [mod_python] Need help: Apache, Win NT and Dr Watson error
Message-ID: <697D1663ABD6D1119D880060B0B5456302B78683@ctsinwcbsxua>

> Hi,
> I need help for the following topic.
> I am using Apache 1.3.9 with mod_python 2.7.
> While running a DB accessing script with apache, Win NT *sometimes*
> reporting Dr. Watson error for apache.
> This does not happen always.
> I have set two directories as follows in the config file
> <Directory "f:/site/html/python">
>    AddHandler python-program .py           
>    PythonHandler feedback
>    PythonDebug on
> </Directory>
> 
> <Directory "f:/site/html/test">
>    AddHandler python-program .py           
>    PythonHandler guestbook::gbook
>    PythonDebug on
> </Directory>
> 
> The error comes occasionally for both the scripts.
> 
> Thanks
> Manoj
> 
> 

This e-mail and any files transmitted with it are for the sole use of the intended recipient(s) and may contain confidential and privileged information.
If you are not the intended recipient, please contact the sender by reply e-mail and destroy all copies of the original message. 
Any unauthorised review, use, disclosure, dissemination, forwarding, printing or copying of this email or any action taken in reliance on this e-mail is strictly 
prohibited and may be unlawful.

		Visit us at http://www.cognizant.com


From Stephane.Bidoul at softwareag.com  Thu Jan 18 17:30:29 2001
From: Stephane.Bidoul at softwareag.com (Bidoul, Stephane)
Date: Fri Jan  9 21:46:10 2004
Subject: [mod_python] Need help: Apache, Win NT and Dr Watson error
Message-ID: <C23163F98473D311874C0008C7E621070499C14E@daemsg02.software-ag.de>

mod_python on NT is multithreaded.
A problem might be that some global data
in your script is not protected by a mutex,
and is accessed by concurrent requests.

This is only a wild guess however: you will need to 
provide more details about your scripts if
you need more help.

Best regards.

-Stephane

> -----Original Message-----
> From: Govindan, Manoj (CTS) [mailto:GManoj@chn.cognizant.com]
> Sent: 18 January, 2001 15:45
> To: 'mod_python@modpython.org'
> Subject: [mod_python] Need help: Apache, Win NT and Dr Watson error
> 
> 
> > Hi,
> > I need help for the following topic.
> > I am using Apache 1.3.9 with mod_python 2.7.
> > While running a DB accessing script with apache, Win NT *sometimes*
> > reporting Dr. Watson error for apache.
> > This does not happen always.
> > I have set two directories as follows in the config file
> > <Directory "f:/site/html/python">
> >    AddHandler python-program .py           
> >    PythonHandler feedback
> >    PythonDebug on
> > </Directory>
> > 
> > <Directory "f:/site/html/test">
> >    AddHandler python-program .py           
> >    PythonHandler guestbook::gbook
> >    PythonDebug on
> > </Directory>
> > 
> > The error comes occasionally for both the scripts.
> > 
> > Thanks
> > Manoj
> > 
> > 
> 
> This e-mail and any files transmitted with it are for the 
> sole use of the intended recipient(s) and may contain 
> confidential and privileged information.
> If you are not the intended recipient, please contact the 
> sender by reply e-mail and destroy all copies of the original 
> message. 
> Any unauthorised review, use, disclosure, dissemination, 
> forwarding, printing or copying of this email or any action 
> taken in reliance on this e-mail is strictly 
> prohibited and may be unlawful.
> 
> 		Visit us at http://www.cognizant.com
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 

From grisha at ispol.com  Thu Jan 18 14:17:07 2001
From: grisha at ispol.com (Gregory Trubetskoy)
Date: Fri Jan  9 21:46:10 2004
Subject: [mod_python] Need help: Apache, Win NT and Dr Watson error
In-Reply-To: <697D1663ABD6D1119D880060B0B5456302B78683@ctsinwcbsxua>
Message-ID: <Pine.LNX.4.21.0101181416100.7384-100000@saturn.ispol.com>

You don't specify which database yu're using, but some Windows database
ODBC drivers are not thread safe and can crash when used with
multithreaded applications like apache.


On Thu, 18 Jan 2001, Govindan, Manoj (CTS) wrote:

> > Hi,
> > I need help for the following topic.
> > I am using Apache 1.3.9 with mod_python 2.7.
> > While running a DB accessing script with apache, Win NT *sometimes*
> > reporting Dr. Watson error for apache.
> > This does not happen always.
> > I have set two directories as follows in the config file
> > <Directory "f:/site/html/python">
> >    AddHandler python-program .py           
> >    PythonHandler feedback
> >    PythonDebug on
> > </Directory>
> > 
> > <Directory "f:/site/html/test">
> >    AddHandler python-program .py           
> >    PythonHandler guestbook::gbook
> >    PythonDebug on
> > </Directory>
> > 
> > The error comes occasionally for both the scripts.
> > 
> > Thanks
> > Manoj
> > 
> > 
> 
> This e-mail and any files transmitted with it are for the sole use of the intended recipient(s) and may contain confidential and privileged information.
> If you are not the intended recipient, please contact the sender by reply e-mail and destroy all copies of the original message. 
> Any unauthorised review, use, disclosure, dissemination, forwarding, printing or copying of this email or any action taken in reliance on this e-mail is strictly 
> prohibited and may be unlawful.
> 
> 		Visit us at http://www.cognizant.com
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From klindsay at mkintraweb.com  Thu Jan 18 18:38:36 2001
From: klindsay at mkintraweb.com (Kevin Lindsay)
Date: Fri Jan  9 21:46:10 2004
Subject: [mod_python] Exiting gracefully...
Message-ID: <20010118183836.D22268@mkintraweb.com>

How does one exit from a script called from mod_python?

As an example, I am in the middle of a function and I want
to call an error function and have the script stop as if it
had returned from the handler function wth 'return apache.OK'

I can't seem to find anything in the docs, unless I'm 
missing something.

Any help is appreciated. :)

------------------------------------------------
Kevin Lindsay <klindsay@debian.org>
Debian Developer
81E 58A3 B49A 580E EE3D 8CF0 519A 55F0 746C 51F4

From klindsay at mkintraweb.com  Thu Jan 18 19:16:17 2001
From: klindsay at mkintraweb.com (Kevin Lindsay)
Date: Fri Jan  9 21:46:10 2004
Subject: [mod_python] Reload strangeness
Message-ID: <20010118191617.A24258@mkintraweb.com>

I'm just curious if there is any known reason why when I hit the
reload button in netscape it sometimes loads my script and other
times, without changing any code I get this:

Mod_python error: "PythonHandler gr_main" Traceback (most recent 
call last): File "/usr/lib/python2.0/site-packages/mod_python/apache.py",
line 180, in Dispatch object = resolve_object(self.req, module, object_str,
silent) File "/usr/lib/python2.0/site-packages/mod_python/apache.py", line
396,in resolve_object raise AttributeError, s AttributeError: module 
'/var/www/geekreview/new2/gr_main.py' contains no 'handler' [an error 
occurred while processing this directive]

-----------------------------------------------------------------------
 Kevin Lindsay                  | "Storm Linux, Taking Linux by Storm!"
 Stormix Technologies Inc.      | http://www.stormix.com/
 Chief Technology Officer (CTO) | 
-----------------------------------------------------------------------

From grisha at ispol.com  Thu Jan 18 22:48:25 2001
From: grisha at ispol.com (Gregory Trubetskoy)
Date: Fri Jan  9 21:46:10 2004
Subject: [mod_python] Exiting gracefully...
In-Reply-To: <20010118183836.D22268@mkintraweb.com>
Message-ID: <Pine.LNX.4.21.0101182247000.8591-100000@saturn.ispol.com>

You can always raise an error if you need to exit immeditely:

raise apache.SERVER_ERROR, apache.HTTP_FORBIDDEN

or something like that.

--
  Gregory (Grisha) Trubetskoy
       grisha@ispol.com

On Thu, 18 Jan 2001, Kevin Lindsay wrote:

> How does one exit from a script called from mod_python?
> 
> As an example, I am in the middle of a function and I want
> to call an error function and have the script stop as if it
> had returned from the handler function wth 'return apache.OK'
> 
> I can't seem to find anything in the docs, unless I'm 
> missing something.
> 
> Any help is appreciated. :)
> 
> ------------------------------------------------
> Kevin Lindsay <klindsay@debian.org>
> Debian Developer
> 81E 58A3 B49A 580E EE3D 8CF0 519A 55F0 746C 51F4
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From grisha at ispol.com  Thu Jan 18 22:51:35 2001
From: grisha at ispol.com (Gregory Trubetskoy)
Date: Fri Jan  9 21:46:10 2004
Subject: [mod_python] Reload strangeness
In-Reply-To: <20010118191617.A24258@mkintraweb.com>
Message-ID: <Pine.LNX.4.21.0101182248290.8591-100000@saturn.ispol.com>

It means that '/var/www/geekreview/new2/gr_main.py' contains no function
called handler.

But sometimes in rare cases when you do a lot of editing/development and
config changes, the Python interpreters in some apache processes may end
up being a bit confused as to what's going on, so you just have to restart
apache.

--
  Gregory (Grisha) Trubetskoy
       grisha@ispol.com

On Thu, 18 Jan 2001, Kevin Lindsay wrote:

> I'm just curious if there is any known reason why when I hit the
> reload button in netscape it sometimes loads my script and other
> times, without changing any code I get this:
> 
> Mod_python error: "PythonHandler gr_main" Traceback (most recent 
> call last): File "/usr/lib/python2.0/site-packages/mod_python/apache.py",
> line 180, in Dispatch object = resolve_object(self.req, module, object_str,
> silent) File "/usr/lib/python2.0/site-packages/mod_python/apache.py", line
> 396,in resolve_object raise AttributeError, s AttributeError: module 
> '/var/www/geekreview/new2/gr_main.py' contains no 'handler' [an error 
> occurred while processing this directive]
> 
> -----------------------------------------------------------------------
>  Kevin Lindsay                  | "Storm Linux, Taking Linux by Storm!"
>  Stormix Technologies Inc.      | http://www.stormix.com/
>  Chief Technology Officer (CTO) | 
> -----------------------------------------------------------------------
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From gerhard at bigfoot.de  Fri Jan 19 08:04:49 2001
From: gerhard at bigfoot.de (Gerhard =?iso-8859-1?Q?H=E4ring?=)
Date: Fri Jan  9 21:46:10 2004
Subject: [mod_python] Need help: Apache, Win NT and Dr Watson error
References: <697D1663ABD6D1119D880060B0B5456302B78683@ctsinwcbsxua>
Message-ID: <3A67E711.93531CC5@bigfoot.de>

I would upgrade to Apache 1.3.14. This solved a thread-related problem
for me.

Gerhard

"Govindan, Manoj (CTS)" wrote:
> 
> > Hi,
> > I need help for the following topic.
> > I am using Apache 1.3.9 with mod_python 2.7.
> > While running a DB accessing script with apache, Win NT *sometimes*
> > reporting Dr. Watson error for apache.
> > This does not happen always.
> > I have set two directories as follows in the config file
> > <Directory "f:/site/html/python">
> >    AddHandler python-program .py
> >    PythonHandler feedback
> >    PythonDebug on
> > </Directory>
> >
> > <Directory "f:/site/html/test">
> >    AddHandler python-program .py
> >    PythonHandler guestbook::gbook
> >    PythonDebug on
> > </Directory>
> >
> > The error comes occasionally for both the scripts.

-- 
contact: g e r h a r d @ b i g f o o t . d e
web:     http://highqualdev.com

From jym_brittain at hotmail.com  Fri Jan 19 17:11:18 2001
From: jym_brittain at hotmail.com (James Brittain)
Date: Fri Jan  9 21:46:10 2004
Subject: [mod_python] compiling problems
Message-ID: <LAW2-F1308k69RKLpgT00002acc@hotmail.com>

Does anyone have any experience compiling mod_python in SuSE 7.0? I'm 
getting some strange errors
_________________________________________________________________
Get your FREE download of MSN Explorer at http://explorer.msn.com


From klindsay at mkintraweb.com  Fri Jan 19 13:27:00 2001
From: klindsay at mkintraweb.com (Kevin Lindsay)
Date: Fri Jan  9 21:46:10 2004
Subject: [mod_python] EAPI
Message-ID: <20010119132700.I24258@mkintraweb.com>

Apache 1.3.14 in Debian (unstable) required EAPI to be compiled into
its DSO modules.  There is nothing in the mod python docs regarding
EAPI. Will this affect anything? Doesn't seem to be.

BTW, I will be packaging modpython and maintaining it for Debian. :)

------------------------------------------------
Kevin Lindsay <klindsay@debian.org>
Debian Developer
81E 58A3 B49A 580E EE3D 8CF0 519A 55F0 746C 51F4


From msandin at hotmail.com  Mon Jan 22 09:45:02 2001
From: msandin at hotmail.com (Martin Sandin)
Date: Fri Jan  9 21:46:10 2004
Subject: [mod_python] mod_python on Win98
Message-ID: <F149y3rB07XOq3JkrKd000058a8@hotmail.com>

Hello!

I'll renew my request for help with this mail. I hope I'm no rude, but I'd 
really like to evaluate the possibility of using Apache/mod_python for 
running parts of a system the company I work at use.

When I add mod_python.dll (for Python 2.0) to the modules/ directory in 
apache, and have the Python20 directory in the PATH env variable, and add a 
LoadModule directive to Apache's httpd.conf with no other mod_python 
references I get the following error on startup of Apache:

"'import site' failed; use -v for traceback"


When configuring apache as suggested in the mp docs I also get the following 
in errors.log when trying to access that URL:

"python_handler: make_obcallback returned no obCallBack!"


Have the exact same behavior on two separate Win98 machines, with the latest 
versions of Apache 1.3 and mod_python. Is there any help available or should 
I just give up on using mod_python? =(


-
Martin
come.to/vague
_________________________________________________________________________
Get Your Private, Free E-mail from MSN Hotmail at http://www.hotmail.com.


From davidc at downright.com  Mon Jan 22 10:19:31 2001
From: davidc at downright.com (David Cohen)
Date: Fri Jan  9 21:46:10 2004
Subject: [mod_python] Installing on RH7.0
Message-ID: <NCBBLAIKFCKAJGLOGAHPGEAGCKAA.davidc@downright.com>

After a long, long weekend, I've crashed and burned attempting to install mod_python on RH7.0 (with all RHN updates).

The RPM install failed by rendering httpd unstartable (instant death with no apparent reason). Commenting out the LoadModule and AddModule lines for mod_python gets httpd working again in its original state).

Has anyone successfully installed via the RPM? Furthermore, can this RPM be used with python 2.0 (my desired platform)?

If not successful with RPM, has anyone successfully installed from source on RH7.0 w/python 2.0?

Thanks!

David Cohen
VP/CTO
Downright Software LLC
18227-D Flower Hill Way, Gaithersburg, MD 20879
voice: 301.948.4030

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010122/adff5a30/attachment.htm
From mike at mikebell.org  Mon Jan 22 16:16:41 2001
From: mike at mikebell.org (Mike Bell)
Date: Fri Jan  9 21:46:10 2004
Subject: [mod_python] Large req.writes prevent header from being outputted?
Message-ID: <20010122161641.E550@vaio.mikebell.org>

With my installation (mod_python 2.7.1 w/python 2.0), doing

  req.content_type = DetermineMimeType(filepath)
  req.send_http_header()
  myjpeg = open(filepath)
  req.write(myjpeg.read())

with a very large image (appears to be around 1/4MB) will result in an HTTP
transaction where no headers are outputted, just binary data. However,
something like

  req.content_type = DetermineMimeType(filepath)
  req.send_http_header()
  myjpeg = open(filepath)
  while 1:
    temp = myjpeg.read(65535)
    if temp == "":
      break
    req.write(temp)

will work just fine.

Presumably req.write should work for these large values, or at least raise
an exception rather than dropping data.

From sandor at cs.uu.nl  Tue Jan 23 12:27:41 2001
From: sandor at cs.uu.nl (Sandor Spruit)
Date: Fri Jan  9 21:46:10 2004
Subject: [mod_python] One question before I start experimenting with mod_python
Message-ID: <18519.010123@cs.uu.nl>

[Please note: I'm not a regular reader of this list. Please be so kind
to send any replies directly to me; I'll summarize to the list]

Hello list members,

I've just got one question: "do Python programs need to be
specifically tailored for use with mod_python, or should Python
CGI programs be able to run unmodified ?"

My guess is, that I need some sort of a "connector" to convert the
regular CGI parameters into Python interpreter parameters, and start
the interpreter on the appropriate script. I'd have to rewrite that
connector to make use of the mod_python facilities. Any additional
pitfalls that I don't see yet ?

TIA,
Sandor
-- 
ir A.G.L. Spruit, Utrecht University, the Netherlands
Institute of information and computing sciences
"There is a bit of magic in everything, and then some
loss to even things out" (from: Lou Reed, "Magic and Loss")



From grisha at ispol.com  Tue Jan 23 22:45:46 2001
From: grisha at ispol.com (Gregory Trubetskoy)
Date: Fri Jan  9 21:46:10 2004
Subject: [mod_python] Large req.writes prevent header from being outputted?
In-Reply-To: <20010122161641.E550@vaio.mikebell.org>
Message-ID: <Pine.LNX.4.21.0101232242260.3867-100000@saturn.ispol.com>

Mike - 

I'm not able to reproduce this. I just tried something similar with an 8Mb
file, and I get all the headers and data correctly.

Anyone else seeing this behaviour?

Could the problem be something with your client? I used wget -S to test my
results.

--
  Gregory (Grisha) Trubetskoy
       grisha@ispol.com

On Mon, 22 Jan 2001, Mike Bell wrote:

> With my installation (mod_python 2.7.1 w/python 2.0), doing
> 
>   req.content_type = DetermineMimeType(filepath)
>   req.send_http_header()
>   myjpeg = open(filepath)
>   req.write(myjpeg.read())
> 
> with a very large image (appears to be around 1/4MB) will result in an HTTP
> transaction where no headers are outputted, just binary data. However,
> something like
> 
>   req.content_type = DetermineMimeType(filepath)
>   req.send_http_header()
>   myjpeg = open(filepath)
>   while 1:
>     temp = myjpeg.read(65535)
>     if temp == "":
>       break
>     req.write(temp)
> 
> will work just fine.
> 
> Presumably req.write should work for these large values, or at least raise
> an exception rather than dropping data.
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From mike at mikebell.org  Tue Jan 23 20:56:14 2001
From: mike at mikebell.org (Mike Bell)
Date: Fri Jan  9 21:46:10 2004
Subject: [mod_python] Large req.writes prevent header from being outputted?
In-Reply-To: <Pine.LNX.4.21.0101232242260.3867-100000@saturn.ispol.com>; from grisha@ispol.com on Tue, Jan 23, 2001 at 10:45:46PM -0500
References: <20010122161641.E550@vaio.mikebell.org> <Pine.LNX.4.21.0101232242260.3867-100000@saturn.ispol.com>
Message-ID: <20010123205613.B9591@vaio.mikebell.org>

On Tue, Jan 23, 2001 at 10:45:46PM -0500, Gregory Trubetskoy wrote:
> 
> Mike - 
> 
> I'm not able to reproduce this. I just tried something similar with an 8Mb
> file, and I get all the headers and data correctly.

How odd...

> Could the problem be something with your client? I used wget -S to test my
> results.

I used telnet.


From afaby at mail.tenon.com  Thu Jan 25 14:26:35 2001
From: afaby at mail.tenon.com (Aaron Faby)
Date: Fri Jan  9 21:46:10 2004
Subject: [mod_python] mod_python + mod_php4 on Mac OS X w/ apache 1.3.14: no workie!
Message-ID: <ALS.HGW@tenon.com>

I get the following error when attempting to start apache 1.3.14 w/ 
mod_php4 and mod_python
on Mac OS X Public Beta:

dyld: /usr/sbin/apache multiple definitions of symbol _pcre_free
/System/Library/Apache/Modules/mod_python.so definition of _pcre_free
/System/Library/Apache/Modules/libphp4.so definition of _pcre_free

Any ideas?

--------------------------------------------------------------------------------------------------
Aaron Faby					                             Software Developer
Tenon Intersystems			         	                                
afaby@tenon.com
1123 Chapala Street			                                       
805-963-6983
Santa Barbara, CA 93103                                             
http://www.tenon.com
--------------------------------------------------------------------------------------------------

From ioseph at paolo.net  Sat Jan 27 06:40:03 2001
From: ioseph at paolo.net (Ioseph Kim)
Date: Fri Jan  9 21:46:10 2004
Subject: [mod_python] How use redirection in cgihandler?
Message-ID: <20010127064003.A4017@paolo.net>

Apache : 1.3.14
Python : 2.0
mod_python : 2.7.1

I maked a simple script a.py

print 'Location: /\n'

-------

but, this script did not work. -.-

> telnet localhost 80
Trying 127.0.0.1...
Connected to localhost.paolo.net.
Escape character is '^]'.
GET /~ioseph/python/a.py HTTP/1.0

HTTP/1.1 200 OK
Date: Fri, 26 Jan 2001 21:36:07 GMT
Server: Apache/1.3.14 (Unix) mod_python/2.7.1 Python/2.0
Location: /
Connection: close
Content-Type: text/plain

Connection closed by foreign host.

--------
in this case, HTTP Status code is 200. 

to url redirect, web server might to return http status code 302.

How I can use "Location:" header in cgihandler?


From john at coastalgeology.org  Sat Jan 27 10:24:05 2001
From: john at coastalgeology.org (Jonathan Pennington)
Date: Fri Jan  9 21:46:10 2004
Subject: [mod_python] Example sites
Message-ID: <20010127102405.A80697@coastalgeology.org>

I am currently researching to re-program a database-driven site from
PHP/MySQL to Python/PostgreSQL. My problem is that, although I'm a
fairly competent Python programmer, I haven't done any mod_python or
python web work at all. I learn by example. I have the mod_python
manual, but does anyone have a code suite from a Python driven site
that I could see? It's always better for me to read code than to
figure out how to do something from scratch. Thanks.

-J
-- 
Jonathan Pennington		| http://coastalgeology.org
Site Manager			| Protection and stewardship
CoastalGeology.Org (CGO)	| through public education.
john@coastalgeology.org		| Join CGO, make a difference.

From oddmund.mogedal at accenture.com  Tue Jan 30 20:36:08 2001
From: oddmund.mogedal at accenture.com (oddmund.mogedal@accenture.com)
Date: Fri Jan  9 21:46:10 2004
Subject: [mod_python] Problem writing to file from handler
Message-ID: <OF8332020C.21CD26E6-ON062569E5.000D2901@accenture.com>

Hi,

I need to write to a file from within a script (called using publisher.py).
For some reason, I am not allowed to write to the file, even though it
exists and has write permission for everyone.
(Yes, it is a security risk, but not in the environment where I will use
it.)

I have tried the same thing using the cgi module, and then I am allowed to
write to the file.
Is there a difference in access rights to the file system between a script
called from mod_python and a script called using CGI?

Does anybody know what is causing this problem?

Using mod_python: DOES NOT WORK
    import getpass

    def omtest(req, username, file):
        myfile = open("testom", 'wb')
        myfile.write(file)
        myfile.close()
        return "%s\n%d\n%s\n" % (username, len(file), getpass.getuser())

Using cgi: WORKS OK
    #!/usr/local/bin/python2.0

    import getpass
    import sys
    import cgi

    myfile = open("testom", 'wb')
    form = cgi.FieldStorage()
    name = form["name"].value
    file = form["file"].value
    myfile.write(file)

    print "Content-Type: text/html"
    print
    print name
    print getpass.getuser()




Oddmund



This message is for the designated recipient only and may contain
privileged or confidential information.  If you have received it in error,
please notify the sender immediately and delete the original.  Any other
use of the email by you is prohibited.



From grisha at ispol.com  Tue Jan 30 22:08:13 2001
From: grisha at ispol.com (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:10 2004
Subject: [mod_python] Problem writing to file from handler
In-Reply-To: <OF8332020C.21CD26E6-ON062569E5.000D2901@accenture.com>
Message-ID: <Pine.BSF.4.21.0101302201010.14374-100000@localhost>

The difference is the current directory. CGI scripts are executed with the
directory where the script is located as current, with mod_python the
current directory is undefined. You need to specify full path to your file
when opening it.

Grisha

On Tue, 30 Jan 2001 oddmund.mogedal@accenture.com wrote:

> Hi,
> 
> I need to write to a file from within a script (called using publisher.py).
> For some reason, I am not allowed to write to the file, even though it
> exists and has write permission for everyone.
> (Yes, it is a security risk, but not in the environment where I will use
> it.)
> 
> I have tried the same thing using the cgi module, and then I am allowed to
> write to the file.
> Is there a difference in access rights to the file system between a script
> called from mod_python and a script called using CGI?
> 
> Does anybody know what is causing this problem?
> 
> Using mod_python: DOES NOT WORK
>     import getpass
> 
>     def omtest(req, username, file):
>         myfile = open("testom", 'wb')
>         myfile.write(file)
>         myfile.close()
>         return "%s\n%d\n%s\n" % (username, len(file), getpass.getuser())
> 
> Using cgi: WORKS OK
>     #!/usr/local/bin/python2.0
> 
>     import getpass
>     import sys
>     import cgi
> 
>     myfile = open("testom", 'wb')
>     form = cgi.FieldStorage()
>     name = form["name"].value
>     file = form["file"].value
>     myfile.write(file)
> 
>     print "Content-Type: text/html"
>     print
>     print name
>     print getpass.getuser()
> 
> 
> 
> 
> Oddmund
> 
> 
> 
> This message is for the designated recipient only and may contain
> privileged or confidential information.  If you have received it in error,
> please notify the sender immediately and delete the original.  Any other
> use of the email by you is prohibited.
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From stanton at livsform.com  Wed Jan 31 03:23:08 2001
From: stanton at livsform.com (Stanton Schell)
Date: Fri Jan  9 21:46:10 2004
Subject: [mod_python] Python libraries install configuration issue
Message-ID: <B69D359B.AD45%stanton@livsform.com>

Hello All,

I have two (unrelated) questions:

1. I was unable to find a searchable version  of the archives - is there
one?

2. Am I forced to install the python libraries during the mod_python
installation into somewhere in /usr/local/lib or can I configure it somehow
to target another directory?  I am trying to install a non-root required
version and would like to stay away from common system areas.

-stanton schell
-- 

Stanton Schell
livsform design group
stanton@livsform.com
703-538-3491
703-989-6591


From stanton at livsform.com  Wed Jan 31 03:32:10 2001
From: stanton at livsform.com (Stanton Schell)
Date: Fri Jan  9 21:46:10 2004
Subject: [mod_python] Python libraries install configuration issue
In-Reply-To: <B69D359B.AD45%stanton@livsform.com>
Message-ID: <B69D37BA.AD47%stanton@livsform.com>

(In other words, I have my source tree and accompanying python libs in
user-owned directory and nothing is in /usr/local/lib at all...)

Thanks!!
-stanton schell
-- 

Stanton Schell
livsform design group
stanton@livsform.com
703-538-3491
703-989-6591

> From: Stanton Schell <stanton@livsform.com>
> Date: Wed, 31 Jan 2001 03:23:08 -0500
> To: <mod_python@modpython.org>
> Subject: [mod_python] Python libraries install configuration issue
> 
> Hello All,
> 
> I have two (unrelated) questions:
> 
> 1. I was unable to find a searchable version  of the archives - is there
> one?
> 
> 2. Am I forced to install the python libraries during the mod_python
> installation into somewhere in /usr/local/lib or can I configure it somehow
> to target another directory?  I am trying to install a non-root required
> version and would like to stay away from common system areas.
> 
> -stanton schell
> -- 
> 
> Stanton Schell
> livsform design group
> stanton@livsform.com
> 703-538-3491
> 703-989-6591
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From stanton at livsform.com  Wed Jan 31 04:14:07 2001
From: stanton at livsform.com (Stanton Schell)
Date: Fri Jan  9 21:46:10 2004
Subject: [mod_python] Python libraries install configuration issue
In-Reply-To: <B69D359B.AD45%stanton@livsform.com>
Message-ID: <B69D418F.AD48%stanton@livsform.com>

sorry for the numerous emails, but the problem has morphed...

I broke down and copied the libraries over to that directory and it was
still having a callback problem (I have pasted the error message in Apache's
error log below).  I then recompiled with the library directory in the
Makefile as the directory I wanted, everything installed, but this same
callback message came when running the test from the manual:

make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
[Wed Jan 31 03:03:16 2001]  [error]  [client 192.168.1.2] python_handler:
    make_obcallback returned no obCallBack!

any help would be appreciated :-)

cheers,
-stanton schell
-- 

Stanton Schell
livsform design group
stanton@livsform.com
703-538-3491
703-989-6591

> From: Stanton Schell <stanton@livsform.com>
> Date: Wed, 31 Jan 2001 03:23:08 -0500
> To: <mod_python@modpython.org>
> Subject: [mod_python] Python libraries install configuration issue
> 
> Hello All,
> 
> I have two (unrelated) questions:
> 
> 1. I was unable to find a searchable version  of the archives - is there
> one?
> 
> 2. Am I forced to install the python libraries during the mod_python
> installation into somewhere in /usr/local/lib or can I configure it somehow
> to target another directory?  I am trying to install a non-root required
> version and would like to stay away from common system areas.
> 
> -stanton schell
> -- 
> 
> Stanton Schell
> livsform design group
> stanton@livsform.com
> 703-538-3491
> 703-989-6591
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From rsalz at caveosystems.com  Wed Jan 31 07:40:08 2001
From: rsalz at caveosystems.com (Rich Salz)
Date: Fri Jan  9 21:46:10 2004
Subject: [mod_python] Python libraries install configuration issue
References: <B69D37BA.AD47%stanton@livsform.com>
Message-ID: <3A7807A8.5EC8CC9F@caveosystems.com>

You need to use PythonPath in your httpd.conf file.
	/r$

From grisha at ispol.com  Wed Jan 31 10:56:40 2001
From: grisha at ispol.com (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:10 2004
Subject: [mod_python] Python libraries install configuration issue
In-Reply-To: <B69D37BA.AD47%stanton@livsform.com>
Message-ID: <Pine.BSF.4.21.0101311056090.57390-100000@localhost>

have you looked at the --with-python configure option?

On Wed, 31 Jan 2001, Stanton Schell wrote:

> (In other words, I have my source tree and accompanying python libs in
> user-owned directory and nothing is in /usr/local/lib at all...)
> 
> Thanks!!
> -stanton schell
> -- 
> 
> Stanton Schell
> livsform design group
> stanton@livsform.com
> 703-538-3491
> 703-989-6591
> 
> > From: Stanton Schell <stanton@livsform.com>
> > Date: Wed, 31 Jan 2001 03:23:08 -0500
> > To: <mod_python@modpython.org>
> > Subject: [mod_python] Python libraries install configuration issue
> > 
> > Hello All,
> > 
> > I have two (unrelated) questions:
> > 
> > 1. I was unable to find a searchable version  of the archives - is there
> > one?
> > 
> > 2. Am I forced to install the python libraries during the mod_python
> > installation into somewhere in /usr/local/lib or can I configure it somehow
> > to target another directory?  I am trying to install a non-root required
> > version and would like to stay away from common system areas.
> > 
> > -stanton schell
> > -- 
> > 
> > Stanton Schell
> > livsform design group
> > stanton@livsform.com
> > 703-538-3491
> > 703-989-6591
> > 
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://www.modpython.org/mailman/listinfo/mod_python
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From thornton at yoyoweb.com  Wed Jan 31 09:22:15 2001
From: thornton at yoyoweb.com (Thornton Prime)
Date: Fri Jan  9 21:46:10 2004
Subject: [mod_python] APahce 1.3.17 vs. mod_python
Message-ID: <Pine.LNX.4.32.0101310917040.1986-100000@prajna.anatman.org>

I'm just wondering if anyone has gotten mod_python to work against 1.3.17
yet. I had things working under 1.3.14, but after upgrading to 1.3.17 it
segfaults. I'm hoping someone else has a fix before I dive in with a
debugger.

I already re-compiled mod_python against 1.3.17, and it is at the top of
my addmodules list.

thornton


From stanton at livsform.com  Wed Jan 31 14:06:28 2001
From: stanton at livsform.com (Stanton Schell)
Date: Fri Jan  9 21:46:10 2004
Subject: [mod_python] Python libraries install configuration issue
In-Reply-To: <3A7807A8.5EC8CC9F@caveosystems.com>
References: <3A7807A8.5EC8CC9F@caveosystems.com>
Message-ID: <50115.38.233.141.43.980967988.squirrel@miesmail.livsform.com>

> You need to use PythonPath in your httpd.conf file.
> 	/r$

Thanks for the response.

However, I still have the (a similar) problem:

I have configured the PythonPath directive to include a number of different directories 
including the library directory in my Python build, but still the same thing.  Is there anything 
specifically that mod_python is looking for that I can correct temporarily to at least move on to 
another error message? :-)

-stanton schell

-- 
Stanton Schell
stanton@livsform.com
703.989.6591
703.538.3491

From stanton at livsform.com  Wed Jan 31 21:01:20 2001
From: stanton at livsform.com (Stanton Schell)
Date: Fri Jan  9 21:46:10 2004
Subject: [mod_python] Python libraries install configuration issue
In-Reply-To: <Pine.BSF.4.21.0101311056090.57390-100000@localhost>
Message-ID: <B69E2DA0.AD72%stanton@livsform.com>

I did indeed, I used " --with-python=/path/to/source/root --with-apache=,
etc..."

I have tried putting all these library files in a number of different
locations in addition to including quite a few directories in the PythonPath
directive in httpd.conf, but the module still seems not available for
import.  do you think there is any reason the interpreter could not _import_
the module as opposed to being able to _find_ it?  just a thought...

-stanton
-- 

Stanton Schell
livsform design group
stanton@livsform.com
703-538-3491
703-989-6591

> From: "Gregory (Grisha) Trubetskoy" <grisha@ispol.com>
> Date: Wed, 31 Jan 2001 10:56:40 -0500 (EST)
> To: Stanton Schell <stanton@livsform.com>
> Cc: mod_python@modpython.org
> Subject: Re: [mod_python] Python libraries install configuration issue
> 
> 
> have you looked at the --with-python configure option?
> 
> On Wed, 31 Jan 2001, Stanton Schell wrote:
> 
>> (In other words, I have my source tree and accompanying python libs in
>> user-owned directory and nothing is in /usr/local/lib at all...)
>> 
>> Thanks!!
>> -stanton schell
>> -- 
>> 
>> Stanton Schell
>> livsform design group
>> stanton@livsform.com
>> 703-538-3491
>> 703-989-6591
>> 
>>> From: Stanton Schell <stanton@livsform.com>
>>> Date: Wed, 31 Jan 2001 03:23:08 -0500
>>> To: <mod_python@modpython.org>
>>> Subject: [mod_python] Python libraries install configuration issue
>>> 
>>> Hello All,
>>> 
>>> I have two (unrelated) questions:
>>> 
>>> 1. I was unable to find a searchable version  of the archives - is there
>>> one?
>>> 
>>> 2. Am I forced to install the python libraries during the mod_python
>>> installation into somewhere in /usr/local/lib or can I configure it somehow
>>> to target another directory?  I am trying to install a non-root required
>>> version and would like to stay away from common system areas.
>>> 
>>> -stanton schell
>>> -- 
>>> 
>>> Stanton Schell
>>> livsform design group
>>> stanton@livsform.com
>>> 703-538-3491
>>> 703-989-6591
>>> 
>>> _______________________________________________
>>> Mod_python mailing list
>>> Mod_python@modpython.org
>>> http://www.modpython.org/mailman/listinfo/mod_python
>> 
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://www.modpython.org/mailman/listinfo/mod_python
>> 


From grisha at ispol.com  Wed Jan 31 23:29:44 2001
From: grisha at ispol.com (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:11 2004
Subject: [mod_python] modpublisher security model
In-Reply-To: <NCBBKMABOKFCDLPIKKGIMEHGCJAA.brett@bookshop.unsw.edu.au>
Message-ID: <Pine.BSF.4.21.0101312320090.70118-100000@localhost>

I have in CVS some fixes that do not allow the publisher handler to
traverse modules. Right now if your script imports os, then one can get to
os and functions within it via a url, which is really bad. (ZPublisher
doesn't traverse modules either.)

Assuming that module traversing issue is fixed - you make a function
"published" by simply having it in the module. If you do not want it to be
published, you can set it's name to begin with an underscore or place it
into another module.

I did this because the ZPublisher comment thing always annoyed me. It's
really misleading - I like to use comments for what they are - comments,
and if a function doesn't need a comment, I prefer to have the option of
having no comment rather than """ this comment is for ZPublisher """ or
something silly like that.

Grisha

On Thu, 1 Feb 2001, Brett Haydon wrote:

> Evidently Zope currently uses the doc string to 
> explicity allow access to functions via URL.
> 
> The new Python 2.1 will allow functions to have
> attributes.
> 
> I am currently renaming all imported modules with
> an underscore to avoid unintentional security problems
> (and global objects)
> but I like the idea of explicitly allowing access.
> 
> Any plans to move in this direction.
> 
> regards,
> ______________________________________________
> Brett Haydon
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From arhiv at freemail.org.mk  Mon Jan  1 21:54:25 2001
From: arhiv at freemail.org.mk (Damjan)
Date: Fri Jan  9 21:52:13 2004
Subject: [mod_python] Sugestion about publisher
Message-ID: <20010101215425.A606@localhost.localdomain>

Here is a small patch for mod_python.publisher, that instead of raising an
error when there is no PATH_INFO, it substitutes a default PATH_INFO. 
(I choose index_html, perhaps a diferent default method can be chosen)

That way when we call a script without specifying a method, the method
index_html is called.

--- publisher.py.old    Mon Jan  1 21:48:04 2001
+++ publisher.py        Mon Jan  1 21:47:39 2001
@@ -81,7 +81,7 @@
 
     # get the path PATH_INFO (everthing after script)
     if not _req.subprocess_env.has_key("PATH_INFO"):
-        raise apache.SERVER_RETURN, apache.HTTP_NOT_FOUND
+        _req.subprocess_env["PATH_INFO"]="/index_html"
     
     func_path = _req.subprocess_env["PATH_INFO"][1:] # skip fist /
     func_path = string.replace(func_path, "/", ".")


-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From peter.bittner at gmx.net  Tue Jan  2 14:22:37 2001
From: peter.bittner at gmx.net (peter.bittner@gmx.net)
Date: Fri Jan  9 21:52:13 2004
Subject: [mod_python] mod_python vs. PyApache, mod_snake
Message-ID: <1294.978441757@www32.gmx.net>

Hi there!

I've heard about that Python is available as a module for Apache too!
That's cool, but what is right for me?

 mod_python, PyApache oder mod_snake?

I've sound them all three.
I want to either use CGI or embedded Python (embedded in HTML) - or both.
Can anyone tell me what is best for me?

Cheers,
Peter

-- 
Peter Bittner
web: http://beam.to/peter.bittner
mail: peter.bittner@gmx.net
mobile: +43/(0)650/8901150
+-----------------------------
| HTML-Minikurs:  http://beam.to/htmlkurs
| Gesundheit:  http://www.gesundheitsfoerderung.at
| Fasten:  http://www.gesundheitsfoerderung.at/fasten

Sent through GMX FreeMail - http://www.gmx.net


From grisha at ispol.com  Tue Jan  2 17:22:09 2001
From: grisha at ispol.com (Gregory Trubetskoy)
Date: Fri Jan  9 21:52:13 2004
Subject: [mod_python] Sugestion about publisher
In-Reply-To: <20010101215425.A606@localhost.localdomain>
Message-ID: <Pine.LNX.4.21.0101021718210.28295-100000@saturn.ispol.com>

But I wonder what the usability of such a feature might be. (I'm not
aysing I'm against it, I'd just like to have a small discussion about it
first). 

In general, I do not like implicit or default stuff like this - I think if
you're specifying a module without a method, you should get nothing in
return. 

Another note - this modifies PATH_INFO. I think PATH_INFO should always
represent what the user passed. 


On Mon, 1 Jan 2001, Damjan wrote:

> Here is a small patch for mod_python.publisher, that instead of raising an
> error when there is no PATH_INFO, it substitutes a default PATH_INFO. 
> (I choose index_html, perhaps a diferent default method can be chosen)
> 
> That way when we call a script without specifying a method, the method
> index_html is called.
> 
> --- publisher.py.old    Mon Jan  1 21:48:04 2001
> +++ publisher.py        Mon Jan  1 21:47:39 2001
> @@ -81,7 +81,7 @@
>  
>      # get the path PATH_INFO (everthing after script)
>      if not _req.subprocess_env.has_key("PATH_INFO"):
> -        raise apache.SERVER_RETURN, apache.HTTP_NOT_FOUND
> +        _req.subprocess_env["PATH_INFO"]="/index_html"
>      
>      func_path = _req.subprocess_env["PATH_INFO"][1:] # skip fist /
>      func_path = string.replace(func_path, "/", ".")
> 
> 
> -- 
> Damjan Georgievski		|           ???????????? ??????????????????????
> Skopje, Macedonia		|           ????????????, ????????????????????
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From mecury at illusion.snu.ac.kr  Wed Jan  3 10:57:12 2001
From: mecury at illusion.snu.ac.kr (sjw)
Date: Fri Jan  9 21:52:13 2004
Subject: [mod_python] A Newbie's question,
Message-ID: <Pine.GSO.4.05.10101031051530.18076-100000@illusion>

hmm, I've installed mod_python and tested it

and it was ok..

( the code is the sample code, like following..

from mod_python import apache
 
def handler(req):
    req.send_http_header()
    req.write("Hello World!")
    return apache.OK  )

BUT, All I want to do is paste a simple, text counter 

to my homepage, like <!--#exec cgi="some/dirs/counter.cgi?id=myID"-->

did.

How can I do that with mod-python?..

Thanks in advance



From dyeung at ust.hk  Wed Jan  3 13:47:56 2001
From: dyeung at ust.hk (David YEUNG)
Date: Fri Jan  9 21:52:13 2004
Subject: [mod_python] Error with the req.register_cleanup
Message-ID: <3A52BD0C.9BA9B475@ust.hk>

Is there any code example how to use the 'req.register_cleanup()'?
I tried to put a function to disconnect the database through the
req.register_cleanup as following:


def index(req):
  ...
  db = MySQLdb.connect(...)
  cur = db.cursor()
  req.register_cleanup(disconnectdb,cur)
  ...
  ... some db query

def disconnectdb(cur):
  db = cur.connection
  cur.close()
  db.close()

  
The apache error_log file keeps displaying the following errors whenever
I invoke the 'register_cleanup' methods. If I do not use the 'register_cleanup',
but call the 'disconnectdb' at the end of the 'index' function. There is no
error in the log file.

---- error_log ----
[Tue Jan  2 21:32:28 2001] [notice] child pid 31239 exit signal Aborted (6)
Fatal Python error: PyThreadState_Get: no current thread
[Tue Jan  2 21:32:40 2001] [notice] child pid 31238 exit signal Aborted (6)
Fatal Python error: PyThreadState_Get: no current thread
[Tue Jan  2 21:32:46 2001] [notice] child pid 31241 exit signal Aborted (6)
Fatal Python error: PyThreadState_Get: no current thread 


I am using Apache 1.3.14 on RedHat 6.2, mod_python 2.7.1, MySQLdb 0.3.0.

Thanks for any advice.


David Yeung

From aperis at bemarnet.es  Thu Jan  4 16:10:49 2001
From: aperis at bemarnet.es (Arturo Peris)
Date: Fri Jan  9 21:52:13 2004
Subject: [mod_python] util.FieldStorage(req).list
Message-ID: <3A549279.6090905@bemarnet.es>

Hi,
my problem is with util.FieldStorage, I can't get information contained 
in content variable.
I call my form.py program from here:

...<form action= "/mailing/form.py/handler" method="post">...
catsel, subcatsel and idisel are checkbox.


MY form.py PROGRAM
---------------------------------------------
from mod_python import apache
from pg import DB
import string
from mod_python import util

def handler(req,catsel,subcatsel,idisel):
  req.content_type = "text/html"
  req.send_http_header()
  content = util.FieldStorage(req).list
---------------------------------------------

Can ne1 help me ?

Thanks.


From grisha at ispol.com  Thu Jan  4 11:21:04 2001
From: grisha at ispol.com (Gregory Trubetskoy)
Date: Fri Jan  9 21:52:13 2004
Subject: [mod_python] util.FieldStorage(req).list
In-Reply-To: <3A549279.6090905@bemarnet.es>
Message-ID: <Pine.LNX.4.21.0101041112390.2246-100000@saturn.ispol.com>

If you are using the mod_python.publisher handler, then you cannot use
FieldStorage within it (because the publisher handler creates one for
you already), you have to use req.form variable, it's an instance of
util.FieldStorage.

I'm sorry I forgot to document this little fact...

--
  Gregory (Grisha) Trubetskoy
       grisha@ispol.com

On Thu, 4 Jan 2001, Arturo Peris wrote:

> Hi,
> my problem is with util.FieldStorage, I can't get information contained 
> in content variable.
> I call my form.py program from here:
> 
> ...<form action= "/mailing/form.py/handler" method="post">...
> catsel, subcatsel and idisel are checkbox.
> 
> 
> MY form.py PROGRAM
> ---------------------------------------------
> from mod_python import apache
> from pg import DB
> import string
> from mod_python import util
> 
> def handler(req,catsel,subcatsel,idisel):
>   req.content_type = "text/html"
>   req.send_http_header()
>   content = util.FieldStorage(req).list
> ---------------------------------------------
> 
> Can ne1 help me ?
> 
> Thanks.
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From norm at streamtheory.com  Thu Jan  4 22:29:02 2001
From: norm at streamtheory.com (Norman Boccone)
Date: Fri Jan  9 21:52:13 2004
Subject: [mod_python] undefined reference to Py_... error compiling apache
Message-ID: <3A5569AE.9060109@streamtheory.com>

I am on Solaris trying to compile mod_python 2.7.1 into apache 1.3.14.  
Compiling of python and mod_python are fine, make test on python is 
fine.  When I try to make apache I get the following errors:

gcc  -DSOLARIS2=270 -DUSE_EXPAT -I./lib/expat-lite -DNO_DL_NEEDED 
`./apaci`    \
     -o httpd buildmark.o modules.o modules/python/libpython.a 
modules/standard/libstandard.a main/libmain.a ./os/unix/libos.a 
ap/libap.a  lib/expat-lite/libexpat.a  -lsocket -lnsl
modules/python/libpython.a(mod_python.o): In function `make_interpreter':
mod_python.o(.text+0xa7): undefined reference to `Py_NewInterpreter'
mod_python.o(.text+0xe6): undefined reference to `PyThreadState_Swap'
modules/python/libpython.a(mod_python.o): In function 
`get_interpreter_data':
mod_python.o(.text+0x124): undefined reference to `PyDict_GetItemString'
...and a bunch more like this

Any idea how I can fix it?  I thought I followed the instructions exactly.


From arhiv at freemail.org.mk  Fri Jan  5 16:32:33 2001
From: arhiv at freemail.org.mk (Damjan)
Date: Fri Jan  9 21:52:14 2004
Subject: [mod_python] Sugestion about publisher
In-Reply-To: <Pine.LNX.4.21.0101021718210.28295-100000@saturn.ispol.com>; from grisha@ispol.com on Tue, Jan 02, 2001 at 05:22:09PM -0500
References: <20010101215425.A606@localhost.localdomain> <Pine.LNX.4.21.0101021718210.28295-100000@saturn.ispol.com>
Message-ID: <20010105163233.B633@localhost.localdomain>

On Tue, Jan 02, 2001 at 05:22:09PM -0500, Gregory Trubetskoy wrote:
> 
> But I wonder what the usability of such a feature might be. (I'm not
> aysing I'm against it, I'd just like to have a small discussion about it
> first). 

It's usable to me ;) but what do the other mod_python users think?

> In general, I do not like implicit or default stuff like this - I think if
> you're specifying a module without a method, you should get nothing in
> return.

Sometimes people write URL's by hand, and not always will they remember the
whole URL. The problem I see is that you get HTTP_NOT_FOUND for a subset of a
valid URL and IMHO it's not very intuitive compared to 'normal' URL handling.

And every web server has a default page for a directory (index.html..).
 
> Another note - this modifies PATH_INFO. I think PATH_INFO should always
> represent what the user passed. 

It does't modify it, it just specifies a default PATH_INFO when PATH_INFO doesn't
exist at all. But Ok, the patch can be made differrent (I just chouse the sollution with
minimal changes to publisher.py).


-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From rsalz at caveosystems.com  Fri Jan  5 11:02:35 2001
From: rsalz at caveosystems.com (Rich Salz)
Date: Fri Jan  9 21:52:14 2004
Subject: [mod_python] Sugestion about publisher
References: <20010101215425.A606@localhost.localdomain> <Pine.LNX.4.21.0101021718210.28295-100000@saturn.ispol.com> <20010105163233.B633@localhost.localdomain>
Message-ID: <3A55F01B.C1CF1802@caveosystems.com>

I can see the convenience of adding 'index.html' (hee hee :) to the
end of nothing else is there.  Or rather, I can see how it is nice
to mimic other behavior.  But the current hack is wrong.

In apache, if you ask for 'foo' and foo is a directory, the server
sends back a redirect, telling you to go for 'foo/' and then it does
the auto-indexing.

It *might* be worthwhile letting the user emulate that.

But I agree, do not include the current patch and do not modify
PATH_INFO
	/r$

From arhiv at freemail.org.mk  Fri Jan  5 18:19:16 2001
From: arhiv at freemail.org.mk (Damjan)
Date: Fri Jan  9 21:52:14 2004
Subject: [mod_python] Sugestion about publisher
In-Reply-To: <3A55F01B.C1CF1802@caveosystems.com>; from rsalz@caveosystems.com on Fri, Jan 05, 2001 at 11:02:35AM -0500
References: <20010101215425.A606@localhost.localdomain> <Pine.LNX.4.21.0101021718210.28295-100000@saturn.ispol.com> <20010105163233.B633@localhost.localdomain> <3A55F01B.C1CF1802@caveosystems.com>
Message-ID: <20010105181916.A1147@localhost.localdomain>

On Fri, Jan 05, 2001 at 11:02:35AM -0500, Rich Salz wrote:
> I can see the convenience of adding 'index.html' (hee hee :) to the
> end of nothing else is there.  Or rather, I can see how it is nice
> to mimic other behavior.  But the current hack is wrong.
> 
Ok. How about this:

--- publisher.py.old    Mon Jan  1 21:48:04 2001
+++ publisher.py        Fri Jan  5 18:16:34 2001
@@ -81,7 +81,11 @@

     # get the path PATH_INFO (everthing after script)
     if not _req.subprocess_env.has_key("PATH_INFO"):
-        raise apache.SERVER_RETURN, apache.HTTP_NOT_FOUND
+        loc = 'http://' + _req.connection.server.server_hostname
+        loc = loc + ':' + str(_req.connection.server.port)
+        loc = loc + _req.uri + '/index_html'
+        _req.headers_out['Location'] = loc
+        raise apache.SERVER_RETURN, apache.HTTP_MOVED_PERMANENTLY

     func_path = _req.subprocess_env["PATH_INFO"][1:] # skip fist /
     func_path = string.replace(func_path, "/", ".")


-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From rsalz at caveosystems.com  Fri Jan  5 12:49:31 2001
From: rsalz at caveosystems.com (Rich Salz)
Date: Fri Jan  9 21:52:14 2004
Subject: [mod_python] Sugestion about publisher
References: <20010101215425.A606@localhost.localdomain> <Pine.LNX.4.21.0101021718210.28295-100000@saturn.ispol.com> <20010105163233.B633@localhost.localdomain> <3A55F01B.C1CF1802@caveosystems.com> <20010105181916.A1147@localhost.localdomain>
Message-ID: <3A56092B.BB73AE22@caveosystems.com>

Very very cool.  A couple of (minor) things.

> +        loc = 'http://' + _req.connection.server.server_hostname
                  ^^^^^^^^^^
		should get it out of the uri, since it might be https

> +        loc = loc + ':' + str(_req.connection.server.port)
> +        loc = loc + _req.uri + '/index_html'
> +        _req.headers_out['Location'] = loc
> +        raise apache.SERVER_RETURN, apache.HTTP_MOVED_PERMANENTLY
					^^^^^^^^^^^^^^^^^^^^^^^^^^^
should be moved_temporarily, I'm fairly sure.

The whole thing should be controlled by a mod_python auto_index option,
or perhaps based on the DirectoryIndex apache config option?

Anyhow, something like this should go into the code!
	/r$

From arhiv at freemail.org.mk  Sat Jan  6 00:05:10 2001
From: arhiv at freemail.org.mk (Damjan)
Date: Fri Jan  9 21:52:14 2004
Subject: [mod_python] Sugestion about publisher
In-Reply-To: <20010105181916.A1147@localhost.localdomain>; from arhiv@freemail.org.mk on Fri, Jan 05, 2001 at 06:19:16PM +0100
References: <20010101215425.A606@localhost.localdomain> <Pine.LNX.4.21.0101021718210.28295-100000@saturn.ispol.com> <20010105163233.B633@localhost.localdomain> <3A55F01B.C1CF1802@caveosystems.com> <20010105181916.A1147@localhost.localdomain>
Message-ID: <20010106000510.B461@localhost.localdomain>

> Ok. How about this:
> 
> --- publisher.py.old    Mon Jan  1 21:48:04 2001
> +++ publisher.py        Fri Jan  5 18:16:34 2001
> @@ -81,7 +81,11 @@
> 
>      # get the path PATH_INFO (everthing after script)
>      if not _req.subprocess_env.has_key("PATH_INFO"):
> -        raise apache.SERVER_RETURN, apache.HTTP_NOT_FOUND
> +        loc = 'http://' + _req.connection.server.server_hostname
> +        loc = loc + ':' + str(_req.connection.server.port)
> +        loc = loc + _req.uri + '/index_html'
> +        _req.headers_out['Location'] = loc
> +        raise apache.SERVER_RETURN, apache.HTTP_MOVED_PERMANENTLY
> 
>      func_path = _req.subprocess_env["PATH_INFO"][1:] # skip fist /
>      func_path = string.replace(func_path, "/", ".")

Hmmm. 
I found a strange thing in mod_python, while playing with this patch.
The situation is this:
if you type a URL of a with a trailling '/' you get that
req.subprocess_env.["PATH_INFO"] doesn't exist but req.pathinfo is '/'.
Why is   req.subprocess_env.["PATH_INFO"] != req.pathinfo ??

-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From arhiv at freemail.org.mk  Fri Jan  5 21:20:10 2001
From: arhiv at freemail.org.mk (Damjan)
Date: Fri Jan  9 21:52:14 2004
Subject: [mod_python] Sugestion about publisher
In-Reply-To: <3A56092B.BB73AE22@caveosystems.com>; from rsalz@caveosystems.com on Fri, Jan 05, 2001 at 12:49:31PM -0500
References: <20010101215425.A606@localhost.localdomain> <Pine.LNX.4.21.0101021718210.28295-100000@saturn.ispol.com> <20010105163233.B633@localhost.localdomain> <3A55F01B.C1CF1802@caveosystems.com> <20010105181916.A1147@localhost.localdomain> <3A56092B.BB73AE22@caveosystems.com>
Message-ID: <20010105212010.A461@localhost.localdomain>

On Fri, Jan 05, 2001 at 12:49:31PM -0500, Rich Salz wrote:
> Very very cool.  A couple of (minor) things.
> 
> > +        loc = 'http://' + _req.connection.server.server_hostname
>                   ^^^^^^^^^^
> 		should get it out of the uri, since it might be https

I can't see where from in mod_python to get this ?!?

> > +        loc = loc + ':' + str(_req.connection.server.port)
> > +        loc = loc + _req.uri + '/index_html'
> > +        _req.headers_out['Location'] = loc
> > +        raise apache.SERVER_RETURN, apache.HTTP_MOVED_PERMANENTLY
> 					^^^^^^^^^^^^^^^^^^^^^^^^^^^
> should be moved_temporarily, I'm fairly sure.

Well, my Apache returns MOVED_PERMANENTLY for directories, I tried it with:

	damjan# nc local 80
	GET /manual HTTP/1.0

	HTTP/1.1 301 Moved Permanently
	Date: Fri, 05 Jan 2001 20:15:43 GMT
	Server: Apache-AdvancedExtranetServer/1.3.12
	Location: http://localhost.localdomain/manual/
	Connection: close
	Content-Type: text/html; charset=iso-8859-1
	...


> The whole thing should be controlled by a mod_python auto_index option,
> or perhaps based on the DirectoryIndex apache config option?
 
We can think of that later.

One question, should I use req.hostname or 
req.connection.server.server_hostname? (it may be diferent)


-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From rsalz at caveosystems.com  Fri Jan  5 20:28:09 2001
From: rsalz at caveosystems.com (Rich Salz)
Date: Fri Jan  9 21:52:14 2004
Subject: [mod_python] Sugestion about publisher
References: <20010101215425.A606@localhost.localdomain> <Pine.LNX.4.21.0101021718210.28295-100000@saturn.ispol.com> <20010105163233.B633@localhost.localdomain> <3A55F01B.C1CF1802@caveosystems.com> <20010105181916.A1147@localhost.localdomain> <3A56092B.BB73AE22@caveosystems.com> <20010105212010.A461@localhost.localdomain>
Message-ID: <3A5674A9.9B9FB3A8@caveosystems.com>

> > > +        loc = 'http://' + _req.connection.server.server_hostname
> >                   ^^^^^^^^^^
> >               should get it out of the uri, since it might be https
> 
> I can't see where from in mod_python to get this ?!?

Perhaps easiest to leave out the protocol, host, and port altogether.
Won't that work?  loc = _req.uri + /index_html ?

> Well, my Apache returns MOVED_PERMANENTLY for directories, I tried it with:

I must have old information, or an old server -- ncsa code. :)  Thanks.

> One question, should I use req.hostname or
> req.connection.server.server_hostname? (it may be diferent)

If you can't just omit it, then I think you want the second choice, but I'm
not 
very knowledgeable about virtual hosting.
	/r$

From grisha at ispol.com  Fri Jan  5 23:42:42 2001
From: grisha at ispol.com (Gregory Trubetskoy)
Date: Fri Jan  9 21:52:14 2004
Subject: [mod_python] Sugestion about publisher
In-Reply-To: <3A5674A9.9B9FB3A8@caveosystems.com>
Message-ID: <Pine.LNX.4.21.0101052340340.7443-100000@saturn.ispol.com>

> > One question, should I use req.hostname or
> > req.connection.server.server_hostname? (it may be diferent)

req.hostname is a better choice, since this is what the client
supplied. server.server_hostname is the name configured for this virtual
server. I think when you'tr using a default server feature, they may be
different.

grisha


From chris at voodooland.net  Sat Jan  6 21:02:09 2001
From: chris at voodooland.net (Chris Watson)
Date: Fri Jan  9 21:52:14 2004
Subject: [mod_python] mod_python.publisher handler question...
Message-ID: <Pine.BSF.4.21.0101062028510.6987-100000@open-systems.net>

I have seen people ask the same question I am about to in the archives.
But I didn't see an answer archived as well.

It's my understand that for each script in your python dir you NEED to
give it a PythonHandler of the same name? If I have foo.py and bar.py
I need to Directory directives one with PythonHandler foo one with
PythonHandler bar. Right?

What I read was that to eliminate this I could simply set the
PythonHandler to mod_python.publisher. And ALL .py scripts in the python
directory would work. But they don't. I'm sure I have it set wrong or I am
misreading the documentation. I have the following configured in apache:

<Directory /usr/local/share/apache/htdocs/python>
          AddHandler python-program .py
          PythonHandler mod_python.publisher
          PythonDebug On
</Directory>

And In that directory are 3 copies of the hell world script from the
documentation. Each with a different name and none of them work with the
above. If I change the handler name to one of the 3 scripts that one
script will work. Have I misread the doco and am wrong in interperating
that mod_python.publisher will execute *any* .py script thats called in a
url in the directory? OR have I simple not configured apache properly?

Im not on the list so reply to me directly please.

Thanks for you time. Have a good weekend everyone!

Chris




From aperis at bemarnet.es  Tue Jan  9 19:03:26 2001
From: aperis at bemarnet.es (Arturo Peris)
Date: Fri Jan  9 21:52:14 2004
Subject: [mod_python] req.form
Message-ID: <3A5B526E.40803@bemarnet.es>

Hi,
I use req.form variable (it's an instance of util.FieldStorage):
-------------------
content = req.form
lista = content.list
return lista
...

  [Field('Coste', '12'), Field('Coste', '10'), Field('Envios', '1'), 
Field('Return', '/mailing/gen_mail.py/handler')]
-------------------
and my question is, wath is the best way to get values from this list?

Thanks.


From djc at object-craft.com.au  Wed Jan 10 16:49:57 2001
From: djc at object-craft.com.au (Dave Cole)
Date: Fri Jan  9 21:52:14 2004
Subject: [mod_python] Publisher handler has a small problem...
Message-ID: <m33deshs6y.fsf@vole.object-craft.com.au>

If I make the following module hello.py available via the publisher
handler:

        """ Publisher example """
        import os
        
        def say(req, what="NOTHING"):
            return "I am saying %s" % what        

Then a browser request which looks like this:

        /hello/os/renames?old=/tmp/blah&new=/tmp/blah1

will actually work (as the apache user).  I am fairly sure that this
is not desirable...

If someone knows which modules you are importing in your code, they
will be able to call any non-builtin function anywhere in the
namespace.

Maybe the publisher handler should only allow objects to be published
if they have some sort of special attribute, __publish__ for example.

- Dave

-- 
http://www.object-craft.com.au


From Peter.GIANNOPOULOS at gemplus.com  Wed Jan 10 12:58:27 2001
From: Peter.GIANNOPOULOS at gemplus.com (Peter Giannopoulos)
Date: Fri Jan  9 21:52:14 2004
Subject: [mod_python] Server error message
Message-ID: <HEELLMEIEBHKANGCLEELCEGMCCAA.peter.giannopoulos@gemplus.com>

Hello,


I have a question that may have an obvious answer but for the life of me I
can't seem to find it.
Here goes:

Any and every time I use the publisher handler I get an error when I return
any except for a string.
example:


	def handler(req):
        req.content_type = "text/plain"
        req.send_http_header()
        req.write("Hello World!")

        return apache.OK




Displays :

	Hello World!HTTP/1.1 200 OK
	Date: Wed, 10 Jan 2001 17:48:44 GMT
	Server: Apache/1.3.14 (Unix) mod_python/2.7 Python/1.5.2
	Connection: close
	Transfer-Encoding: chunked
	Content-Type: text/html; charset=iso-8859-1

	<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
	<HTML><HEAD>
	<TITLE>200 OK</TITLE>
	</HEAD><BODY>
	<H1>OK</H1>
	The server encountered an internal error or
	misconfiguration and was unable to complete
	your request.<P>
	Please contact the server administrator,
	 petergi@gemplus.com and inform them of the time the error occurred,
	and anything you might have done that may have
	caused the error.<P>
	More information about this error may be available
	in the server error log.<P>
	<HR>
	<ADDRESS>Apache/1.3.14 Server at Medusa Port 80</ADDRESS>
	</BODY></HTML>




But there is nothing in the server logs.
Yet if a return a string instead (any string) even simply ( return " ").
It seems to be fine. Why? Can someone help me understand what is happening?






Peter Giannopoulos, Software Developer
Gemplus Software,   Advanced Projects Group

Phone: +15147322434
Fax:   +15147322401
Gemplus Card International
http://www.gemplus.com


-------------- next part --------------
A non-text attachment was scrubbed...
Name: Peter Giannopoulos.vcf
Type: text/x-vcard
Size: 613 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20010110/4bfcc954/PeterGiannopoulos-0001.vcf
From grisha at ispol.com  Thu Jan 11 01:04:50 2001
From: grisha at ispol.com (Gregory Trubetskoy)
Date: Fri Jan  9 21:52:14 2004
Subject: [mod_python] Publisher handler has a small problem...
In-Reply-To: <m33deshs6y.fsf@vole.object-craft.com.au>
Message-ID: <Pine.LNX.4.21.0101110101550.2739-100000@saturn.ispol.com>

Looks like a rather big prolem to me...

I did some testing with ZPublisher, and it returns "Not Found" when trying
to access os, but does find string... 

I haven't studies the code yet o find out why. I'd rather there was a way
to solve this problem without anything like __publish__...

--
  Gregory (Grisha) Trubetskoy
       grisha@ispol.com

On 10 Jan 2001, Dave Cole wrote:

> If I make the following module hello.py available via the publisher
> handler:
> 
>         """ Publisher example """
>         import os
>         
>         def say(req, what="NOTHING"):
>             return "I am saying %s" % what        
> 
> Then a browser request which looks like this:
> 
>         /hello/os/renames?old=/tmp/blah&new=/tmp/blah1
> 
> will actually work (as the apache user).  I am fairly sure that this
> is not desirable...
> 
> If someone knows which modules you are importing in your code, they
> will be able to call any non-builtin function anywhere in the
> namespace.
> 
> Maybe the publisher handler should only allow objects to be published
> if they have some sort of special attribute, __publish__ for example.
> 
> - Dave
> 
> -- 
> http://www.object-craft.com.au
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From hz at lexgen.com  Fri Jan 12 16:21:47 2001
From: hz at lexgen.com (Hao Zhou)
Date: Fri Jan  9 21:52:14 2004
Subject: [mod_python] mod_python install woe
Message-ID: <20010112162147.A29475@hydrogene.lexgen.com>

Hi everyone,

I got the following error message when I tried to install mod_python
on a Sun machine running SunOS 5.7 with Python 1.5.2.

Could any one shed some light on how to correct it? Thanks a lot!

Hao

/usr/local/apache/bin/httpd -DSSL -d /etc/local/apache/ 
Syntax error on line 121 of /etc/local/apache/conf/httpd.conf:
Cannot load /etc/local/apache/libexec/mod_python.so into server:
ld.so.1: /usr/local/apache/bin/httpd: fatal: relocation error: file
/etc/local/apache/libexec/mod_python.so: symbol __muldi3: referenced
symbol not found


From arhiv at freemail.org.mk  Mon Jan 15 12:29:47 2001
From: arhiv at freemail.org.mk (Damjan)
Date: Fri Jan  9 21:52:14 2004
Subject: [mod_python] Server error message
In-Reply-To: <HEELLMEIEBHKANGCLEELCEGMCCAA.peter.giannopoulos@gemplus.com>; from Peter.GIANNOPOULOS@gemplus.com on Wed, Jan 10, 2001 at 12:58:27PM -0500
References: <HEELLMEIEBHKANGCLEELCEGMCCAA.peter.giannopoulos@gemplus.com>
Message-ID: <20010115122947.A458@localhost.localdomain>

On Wed, Jan 10, 2001 at 12:58:27PM -0500, Peter Giannopoulos wrote:
> Hello,
> 
> 
> I have a question that may have an obvious answer but for the life of me I
> can't seem to find it.
> Here goes:
> 
> Any and every time I use the publisher handler I get an error when I return
> any except for a string.
...
RTFM

The publisher handler EXPECTS the script it called to return the content.


-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From derek at realware.com.au  Tue Jan 16 09:51:16 2001
From: derek at realware.com.au (Derek Lavine)
Date: Fri Jan  9 21:52:14 2004
Subject: [mod_python] Making an exe
Message-ID: <048801c07f4e$0cfb0d10$315119cb@realware.com.au>

Hi all,

I am about to write a couple of little utils as my introduction in to the
python world. The thing is, I would like to be able to give some of these
utils to people that don't have python on their machines. To this end I
would like to create and EXE from the python code. I know this can be done
with ActiveState Perl but can it be done with Python

Thanks in advance
Derek


From grisha at ispol.com  Mon Jan 15 19:10:39 2001
From: grisha at ispol.com (Gregory Trubetskoy)
Date: Fri Jan  9 21:52:14 2004
Subject: [mod_python] Making an exe
In-Reply-To: <048801c07f4e$0cfb0d10$315119cb@realware.com.au>
Message-ID: <Pine.LNX.4.21.0101151909230.29452-100000@saturn.ispol.com>


What does this have to do with mod_python?


On Tue, 16 Jan 2001, Derek Lavine wrote:

> Hi all,
> 
> I am about to write a couple of little utils as my introduction in to the
> python world. The thing is, I would like to be able to give some of these
> utils to people that don't have python on their machines. To this end I
> would like to create and EXE from the python code. I know this can be done
> with ActiveState Perl but can it be done with Python
> 
> Thanks in advance
> Derek
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From derek at realware.com.au  Tue Jan 16 11:16:15 2001
From: derek at realware.com.au (Derek Lavine)
Date: Fri Jan  9 21:52:14 2004
Subject: [mod_python] Making an exe
References: <Pine.LNX.4.21.0101151909230.29452-100000@saturn.ispol.com>
Message-ID: <04aa01c07f59$ec719ee0$315119cb@realware.com.au>

Oops sorry posted to the wrong news group

Derek

----- Original Message -----
From: Gregory Trubetskoy <grisha@ispol.com>
To: Derek Lavine <derek@realware.com.au>
Cc: <Mod_python@modpython.org>
Sent: Tuesday, January 16, 2001 10:10 AM
Subject: Re: [mod_python] Making an exe


>
>
> What does this have to do with mod_python?
>
>
> On Tue, 16 Jan 2001, Derek Lavine wrote:
>
> > Hi all,
> >
> > I am about to write a couple of little utils as my introduction in to
the
> > python world. The thing is, I would like to be able to give some of
these
> > utils to people that don't have python on their machines. To this end I
> > would like to create and EXE from the python code. I know this can be
done
> > with ActiveState Perl but can it be done with Python
> >
> > Thanks in advance
> > Derek
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://www.modpython.org/mailman/listinfo/mod_python
> >
>
>


From rafi at voruta.ek.univ.gda.pl  Wed Jan 17 17:33:51 2001
From: rafi at voruta.ek.univ.gda.pl (rafal polonski)
Date: Fri Jan  9 21:52:14 2004
Subject: [mod_python] Debian 2.2 and mod_python
Message-ID: <20010117173350.A29278@voruta.ek.univ.gda.pl>

Hello,
I am trying to run mod_python on Debian 2.2 distribution.

Apache 1.3.9
Python 1.5.2 (with threads)
mod_python-2.7.1
gcc 2.95

Compiling as a DSO module goes without any error.
Of course I get a warning about having Python compiled WITH threads.

apache -X 
gives me Segmentation fault:
[Wed Jan 17 16:48:01 2001] [notice] caught SIGTERM, shutting down]

So probably I have to blame Python compiled with threads.


So I downloaded Python 1.6, compiled it without threads but trying to
compile mod_python with this 1.6 version gives this error:
gcc -shared -o mod_python.so mod_python.o _apachemodule.o requestobject.o
tableo
bject.o util.o serverobject.o connobject.o -lm
/tmp/modp/Python-1.6/libpython1.6
.a -lieee -ldl -lm -lc -lm -lcrypt -ldb
/usr/bin/ld: mod_python.so: undefined versioned symbol name
_LIB_VERSION@@GLIBC_
2.0
/usr/bin/ld: failed to set dynamic section sizes: Bad value
collect2: ld returned 1 exit status
apxs:Break: Command failed with rc=65536
make[1]: *** [mod_python.so] Error 1
make[1]: Leaving directory `/tmp/modp/mod_python-2.7.1/src'
make: *** [do_dso] Error 2
# 


So I downloaded Python 2.0, compiled it without threads.
With this Python version Apache and mod_python started.
I got quiet huge .so file:
2873238 Jan 17 17:26 mod_python.so 
Stripped version: 1601536 Jan 17 17:28 mod_python.so
Is that normal?


So the question is:
Can I compile mod_python with threaded Python 1.5.2? or just forget 
about threaded vesrion and use one without them?
Why did I get problems trying to use 1.6 Python version wit mod_python?

habe a nice day
rafal

From hunter at userfriendly.net  Wed Jan 17 20:20:21 2001
From: hunter at userfriendly.net (hunter)
Date: Fri Jan  9 21:52:14 2004
Subject: [mod_python] pydriver and apache
Message-ID: <3A6644D5.6F0FB794@userfriendly.net>

I am trying to get pydriver.py to run as a nsapi cgi using RedHat 7.0
Linux 2.2.16 apache 1.3.14 + mod_python webserver. I have this working
on linux/irix netscape enterprise server but not sure how to tell apache
to use pydriver as a cgi for all .py's

Any suggestions, help, comments would be GREATLY appreciated
Michael Weiner
Systems Administrator/Partner
The UserFriendly Network
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/x-pkcs7-signature
Size: 2626 bytes
Desc: S/MIME Cryptographic Signature
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20010117/46817411/smime-0001.bin
From msandin at hotmail.com  Thu Jan 18 08:08:53 2001
From: msandin at hotmail.com (Martin Sandin)
Date: Fri Jan  9 21:52:14 2004
Subject: [mod_python] 'import site' failed
Message-ID: <OE9xG1UrHgmqzWTY0YA0000096a@hotmail.com>

Hello!

I'm trying to get mod_python up running and have run into the same problem
on both Win98 systems I've attempted this feat on. This after following the
instruction provided to the best of my abilities. Apache starts giving the
following message:

'import site' failed; use -v for traceback
Apache/1.3.12 (Win32) mod_python/2.6.3 Python/2.0 running...
'import site' failed; use -v for traceback

and then returning "internal server error" on the URLs pointing to Python
files. I've tracked dow that error message as something that
Python emitts. Thus given I'll ask this:

What does that error message mean? What has gone wrong? How can I fix it in
general? And if anyone knows, how can it be fixed in this particular case?



Configuration is as follows:

Apache 1.3.12 installed in c:\program\servers\apache\

mod_python.dll (for Python2.0) in the modules\ directory


In the httpd.conf file I've got the following lines where appropriate:

LoadModule python_module modules/mod_python.dll

DocumentRoot "C:/Data/Httpserver"

<Directory "C:/Data/Httpserver/python/">
AddHandler python-program .py
PythonHandler test
PythonDebug on
</Directory>


Python (2.0) itself resides in
C:\dev\Python20
which is also in the PATH. No PYPATH variable exists.

The mod_python directory, as extracted from the distribution located in
either of these (I've tried a bunch due to mod_pythons installation
instructions not being up to sync with the dist. archive)
C:\dev\Python20\mod_python\
C:\dev\Python20\lib\mod_python\
C:\dev\Python20\lib\python\mod_python\
C:\dev\Python20\lib\mod_python\python\mod_python\
etc.

The mod_python-2.6.4 directory has been similarly moved around (does it
matter at all?).


As a last piece of information, on the other machine I tried I used the
exact same (save some paths) configuration but with the latest (as of this
morning) versions of mod_python and Apache. The exact same problem.

THanks:-)


-
Martin Sandin
come.to/vague

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010118/0925d74b/attachment-0001.htm
From hunter at userfriendly.net  Thu Jan 18 07:34:59 2001
From: hunter at userfriendly.net (hunter)
Date: Fri Jan  9 21:52:14 2004
Subject: [mod_python] mod_python and apache
Message-ID: <3A66E2F3.CC212E4F@userfriendly.net>

I wrote to the list the other day, asking about converting a webserver
currently using Netscape Enterprise Server and python-1.5.2c to apache
running mod_python and python-1.5.2c due to the licensing being cost
probihitive. We use the "py-driver" within the webserver as nsapi to
push all our .py/.pd/.pc files to the users with netscape configured as
follows:

<snip>
<Object name="default">
NameTrans fn="pfx2dir" from="/cgi-bin"
dir="/disk2/websites/american/cgi-bin" na
me="cgi"
NameTrans fn="document-root" root="/disk2/websites/american/html"
PathCheck fn="unix-uri-clean"
PathCheck fn="check-acl" acl="default"
PathCheck fn="find-pathinfo"
PathCheck fn="find-index" index-names="index.pd"
ObjectType fn="type-by-extension"
ObjectType fn="force-type" type="text/plain"
Service method="(GET|HEAD|POST)" type="magnus-internal/py-driver"
fn="query-hand
ler" path="/disk2/ns-home/nsapi/pd/py-driver"
Service method="(GET|HEAD)" type="magnus-internal/imagemap"
fn="imagemap"
Service method="(GET|HEAD)" type="magnus-internal/directory"
fn="index-common"
Service method="(GET|HEAD|POST)" type="*~magnus-internal/*"
fn="send-file"
</snip>

which basically treats all calls to the .py/.pds as a cgi. Now, in
trying to convert over to apache and mod_python and do the same thing
within the apache configuration is where i am getting a bit confused. I
read through some of the documentation and i think the cgihandler might
be the way to handle this, but thought i would ask more senior python
programmers. I am a systems administrator and nowhere near as
experienced in python as 99% of the group here. So, i am looking for
advice and suggestions to see if a "proof of concept" can even be done.
I realize this might include some python module re-writes but if thats
fairly minimal i am still one step ahead rather than using netscape.

The py-driver being called in the above configuration looks like the
following:

#!/usr/local/bin/python
import sys, os
sys.path.insert(0, '/disk2/ns-home/nsapi/pd/')
sys.path.insert(1, '/disk2/common/')
sys.path.insert(2, '/disk2/ns-home/nsapi/mp/')
import pydriver
pydriver.topmain()

which imports pydriver which looks like the following:

#!/usr/local/bin/python
# -*- Python -*-
# PythonDriver main interpreter
#
# 960701 JM added HTML header override (ie: cookies)
#
# 960618 JM added Advert class
#

# common object layer imports
from col.exception.bopageflagexception import BOPageFlagException

# other imports
import pccache

__version__ = "1.5"

PD_Okay  = "PD_Okay"                    # JM 960830

intSybFailFrac = 100      # one out of this number of sybase connect
fails will$

def pd_return(msg=''):
    raise PD_Okay, msg


def get_func(dict, name):
    if dict.has_key(name):
        cb = dict[name]
        if `type(cb)` == "<type 'function'>":
            return cb
    return None


class SmartPrint:
    def __init__(self, real_stdout, headers=''):
        self.need_headers = 1
        self.headers = headers
        self.real_stdout = real_stdout

##     def write(self, msg):
##      if self.need_headers:
##          try:
##              self.real_stdout.write(self.headers.show() + '\n')
##          except AttributeError:              ## XXXX
##              self.real_stdout.write(self.headers)

##      self.real_stdout.write(msg)
##      self.need_headers = 0



# JM 960517
#
#
def get_hostip(environ):
    try:
        return 'IP:' + environ['REMOTE_ADDR']
    except KeyError:
        return  'IP:unknown'                    # XX ugh

def dump(environ=None):
    if not environ:
        from os import environ

    list = environ.keys()
    list.sort()

    for k in list:
        print "<b>%s</b> %s<BR>" % (k, environ[k])

# JM 960708
# use the cookie class to get the session ID, or return ''
#

def get_sessionid(cookiedict):
    if cookiedict.has_key('ngs_sessionID'):
        #
        # Netsite: NGS session-id stuff installed
        #
        return cookiedict['ngs_sessionID'][:12]

    elif cookiedict.has_key('Apache'):
        #
        # Apache: mod_cookie installed + enabled
        #
        return cookiedict['Apache']

    else:
        #
        # no session-id thing
        #
        return ''


### if session ID not given,
### use client's IP address (XX debugging only!)
### JM 960517
##    if environ.has_key('HTTP_COOKIE'):
##      s = environ['HTTP_COOKIE'] # like "ngs_sessionID=23233885"
##
##      if 'ngs_sessionID=' == s[:14]:
##          s = s[14:14+12]
##      else:
##          s = get_hostip(environ)     # XX no session id: error here?
##
##    else:
##      # dump(environ)
##      s = get_hostip(environ)         # XX no session id: error here?
##
##    return s


def file_exists(path):
    try:
        open(path).close()
        return 1
    except IOError:
        return 0
# Figure out a few things about what will happen, and put
# a few extra things in the Python search path.
#
# - take the original PD script path (ie:
'/www/test/htdocs/Tests/if.pd')
#   (usually from the webserver's PATH_TRANSLATED variable).
#
# - turn it into the Python script path ('/www/test/htdocs/Tests/if.py')
#   and then containing directory ('/www/test/htdocs/Tests/').
#
# - insert the PD directory in sys.path, so that PD support files
#   (like 'cookie' and 'agent') will be found, and wont be overridden
#   by user app files.
#
# - chdir to the user's script directory, so that app-local files
#   can be found (sys.path contains '.') and written files will
#   be relative to the script.
#

def script_setup(path):

    import os, sys, string

    if os.path.isdir(path):
        if path[-1]!='/': path=path+'/'
        path=path+'index.pd'

    # replaced following line with a substitution to stop pydriver from
    # displaying the py code when the URL has a .py.  Set it back to .pd
    # -MC 8/6/99
    if path[-3:] == ".py":
       path = path[:-3] + ".pd"
       if os.environ.has_key('PATH_TRANSLATED'):
          os.environ['PATH_TRANSLATED'] = path

    templatepath = path
    scriptpath = path[:-2] + "py"
    scriptdir  = path[:string.rfind(path, '/')]
    pc_path    = path[:-2] + "pc"

    # make sure the PythonDriver dir is first on the path.
    # (1st, else 'cookie.py' was being overridden)
    # JM 961006
    # commented out. py-driver now puts this at front of path.
    # Mark Cain
    #sys.path.insert(0, os.getcwd())

    # raise KeyError, "vars=" + `locals()`

    sys.path.append(scriptdir)
    os.chdir(scriptdir)                 # JM 960827

    return (templatepath, scriptpath, pc_path, scriptdir)


# allow project information to be overridden by the user,
# either by 'project.py' in the script directory,
# or in the one just above (XX provide search-path?)
#

def import_project(pathlist=['.'], modnamelist=['project']):
    from uniondict import UnionDict

    info     = UnionDict()                      # union of all info
dicts
    project  = UnionDict()                      # union of *modules*
    mod_dict = {}                               # temporary variable
scope

    for file in modnamelist:

        # load the module
        #
        exec   "import "+file in mod_dict
        module = mod_dict[file]

        # add the module to the UnionDict,
        # so that its functions *override* earlier ones
        #
        project.prepend(module.__dict__)

        # add the 'info' dictionaries
        # so that just-loaded defs *override* earlier ones
        #
        if module.__dict__.has_key('info'):
            info.prepend(module.__dict__['info'])

    project.info = info
    return project


def html_print_techproblems():
#    print "Location: http://162.133.26.95/goo.po"
#    print "Content-length: 1"
#    print "\n\n"
#    import traceback
#    html_print_exc(traceback)
    try:
      import socket
      filNF = open('/disk2/flags/techproblems.html', 'r')
      print filNF.read() % socket.gethostname()
      filNF.close()
    except:
      print """
           <table><tr>
           <td align="center" width="312">
           <img src="/images/banner.gif" width=312 height=45 border=0
alt="" al$
           </td></tr></table>
            """
      print "<br><font size=+3><b>We're sorry.</b>"
      print "<p>We are repairing a technical problem. We apol$

def html_print_notfound(message=''):
    print "Content-type: text/html\n\n"
    try:
      filNF = open('/disk2/flags/notfound.html', 'r')
      print filNF.read()
      filNF.close()
      filNF.close()
    except:
      print """
           <table><tr>
           <td align="center" width="312">
           <img src="/images/banner.gif" width=312 height=45 border=0
alt="" al$
           </td></tr></table>
            """
      print "<br><font size=+3><b>Not Found</b></font>"
      print "<p>The requested file does not exist on our website."

def html_print_exc(traceback):
    import sys

    print "Content-type: text/html\n"
    print "<font size=+3><b>internal error</b></font><P><PRE>",
    traceback.print_exc(file=sys.stdout)
    print "</PRE>"
def cgi_main():
    import os, traceback

    if not os.environ.has_key('PATH_TRANSLATED'):
        print "Content-type: text/html\n"
        print "PATH_TRANSLATED not given"
        return

    try:
        main(os.environ['PATH_TRANSLATED'], os.environ)

    except IOError, msg:
        html_print_notfound(msg)
        print "<!--"
        html_print_exc(traceback)
        print "-->"
    except:
        html_print_techproblems()
        print "<!--"
        html_print_exc(traceback)
        print "-->"


def updatePC(pd_path, py_path, pc_path):
  import os, codetemplate, time
  dicPC = {}

  # get stats on files
  try:
    tupPD = os.stat(pd_path)
    tupPY = os.stat(py_path)
    try:
    try:
      tupPC = os.stat(pc_path)
    except:
      tupPC = None
  except:
    raise IOError, "not found"

  try:
    # if pc file doesn't exist, or is older than either of the others,
then rec$
    if (not tupPC or (tupPD[-2] > tupPC[-2]) or (tupPY[-2] >
tupPC[-2])):
      pd_script = codetemplate.PD_Script(pd_path)
      codPD = pd_script.code
      dicPdVars = pd_script.dicPdVars
      filTemp = open(py_path)
      codPY = compile(filTemp.read(), py_path, "exec")
      filTemp.close()
      dicPC = { 'py': codPY,
                'pd': codPD,
                'dicPdVars': dicPdVars,
                'pyDate': time.asctime(time.localtime(tupPY[-2])),
                'pdDate': time.asctime(time.localtime(tupPD[-2])),
                'pcDate': time.asctime(time.localtime(time.time()))
              }
      import marshal
      try:
        filPC = open(pc_path, 'w')
        marshal.dump(dicPC, filPC)
        filPC.close()
      except IOError:
        return
  except:
      #
      # since this function runs outside of normal execution (as in
production)
      # we add traceback error handling here. Else errors don't
propigate on th$
      # normal route, having failed at this early point.
      #
      import sys, traceback
      pd_except(py_path, sys.exc_type, sys.exc_value,
                        tb=traceback, globals=globals())
      #
      # Furthermore, no headers have been printed yet and "main"
execution is b$
      # We need the basic header printed here.
      #
      #print "Content-type: text/html\n\n"
      #
      # Stop further execution by raising an error. Brings us back to
cgi-main $
      # screen
      #
      raise "Failed"


def main(templatepath, environ=None):

    import sys, string, cgi, os, traceback, ctsybase

    dicPC = {}        # dictionary containing pd and py code objects
    blnInterpSrc = 0
    blnTechProb  = 0   # to note problem deserving of "tech problem"
message

    if not environ:
        environ=os.environ

    (pd_path, py_path, pc_path, scriptdir) = script_setup( templatepath
)

    if ((len (pd_path) > 13) and (pd_path[-13:] == "html/index.pd")):
        import posixpath
        HOMEFILE = '/disk2/flags/homelive.html'
        if posixpath.exists(HOMEFILE) == 0:
            import homedown
            print homedown.pageVar
            return

    import marshal, codetemplate, agent


    # get the 'project' module, but allow
    # it to be overidden (unlike all other modules. Ex: cookies.py)
    #
    project = import_project(scriptdir)

    from headers import Headers

    # ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    # run-time stuff
    # ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    finished   = 0
    headers    = Headers(environ)
    # print "info = " + `project.info`
    if project.info.has_key('cookie_domain'):
        headers.cookieSetDomain(project.info['cookie_domain'])

    session_id = get_sessionid(headers.cookie)


    # grab form variables
    #
    try:
        #          Old and outdated
        if not os.environ.has_key('QUERY_STRING'):
           os.environ['QUERY_STRING'] = ""
        webvars = cgi.SvFormContentDict(environ=os.environ)
        #webvars.__init__(os.environ)
        #webvars = cgi.FieldStorage()
    except:
        webvars = {}


    # grab Python global variables
    # XXX?
    script_dict = globals()

    # rename a few variables
    #

    # XX
    sp = SmartPrint(sys.stdout, headers)


    script_dict.update({
             'environ'    : environ,
             'session_id' : session_id,
             'webvars'    : webvars,
             'headers'    : headers,
             'scriptpath' : py_path,
             'project'    : project,
             'agent'      : agent.open(environ)
             })

    for k in ['dbopen', 'pd_except']:
        if project.has_key(k):
            script_dict[k] = project[k]

    # XX removed 961006 JM
    # 'agent'      : agent.open(environ),
    # 'advert'     : Advert(),
    # merge globals and other vars into one dictionary
    #
    #for k in dict2.keys():
#       script_dict[k] = dict2[k]
#
#    del dict2                          # dont need it anymore


    # try to execute the Python script.
    #

    # call updatePC to compile pd and py file and write to pc file
    # (do not call in production)
    #updatePC(pd_path, py_path, pc_path)

    try:
      if (sys.modules.has_key('pccache')):
        pccache = sys.modules['pccache']
        dicPC = pccache.load(pc_path)
      else:
        filPC = open(pc_path, 'r')
        dicPC = marshal.load(filPC)
        filPC.close()

    except IOError:
      pd_script = codetemplate.PD_Script(pd_path)
      blnInterpSrc = 1   # was unable to open compiled. Must interp.
    else:
      # load successful
      # create "empty" PD_Script object and set its code object (no
processing $
      pd_script = codetemplate.PD_Script()
      pd_script.code = dicPC['pd']
      if dicPC.has_key('dicPdVars'):
        pd_script.dicPdVars = dicPC['dicPdVars']
    script_dict['dicPdVars'] = pd_script.dicPdVars

    try:
      try:
          try:
            import pycodewrap
            pycodewrap.begin(script_dict)
          except BOPageFlagException, objException:
            raise objException
          except:
            pass
          if (blnInterpSrc):
            f = open(py_path)
            exec f in script_dict  # old
            f.close()
          else:
            exec (dicPC['py'] , script_dict) # new
          try:
            pycodewrap.end(script_dict)
          except:
            pass

      except PD_Okay, msg:
          # XX print msg somewhere?
          pass

      # catch and ignore broken pipe errors
      except IOError, lstErr:
        if lstErr[1] == 'Broken pipe':
          pass
        else:
          raise lstErr
      except ctsybase.error, lstErr:
        if lstErr[0] == 'failed to connect to server':
          blnTechProb = 1
          import time
          fltTime = time.time()
          intTemp = int (( int(fltTime) + ((fltTime - int(fltTime)) *
10000)) %$
          if intTemp == 0:
            raise ctsybase.error + ": " + str(lstErr)
          else:
            pass
            #raise "sybase error"

      # catch BOPageFlagException to throw up alternate page
      except BOPageFlagException, objException:
          blnTechProb = 0
          finished = 1                # XX run PD script after error
          if sp.need_headers:

              # was >> print "Content-type: text/html\n"

              try:
                  print script_dict['headers'].show()
              except AttributeError:
                  print script_dict['headers']

          # headers were printed -- turn them off
          #
          sp.need_headers = 0

          try:
            filT = open(objException.strFile, 'r')
            strText = filT.read()
            filT.close()
         except IOError:
            objT = IOError("BOPageFlagException, can't open file '%s'" %
objExc$
            raise objT
          if objException.dicVariables:
            strText = strText % objException.dicVariables
          print strText

          # if objException.blnTraceback is true, then do the traceback
anyhow
          if objException.blnTraceback:
            # does PY script have a custom exception handler?
            # if so, use it; else use default: 'pd_except'.
            #
            cb = get_func(script_dict, '__except__')
            if not cb:
                cb = pd_except

            finished = not cb(py_path, sys.exc_type, sys.exc_value,
                              tb=traceback, globals=globals())
    # catch all for tracebacks
    except:
        blnTechProb = 1
        finished = 0                # XX run PD script after error

        if sp.need_headers:

            # was >> print "Content-type: text/html\n"

            try:
                print script_dict['headers'].show()
            except AttributeError:
                print script_dict['headers']

        # headers were printed -- turn them off
        #
        sp.need_headers = 0

        # does PY script have a custom exception handler?
        # if so, use it; else use default: 'pd_except'.
        #
        cb = get_func(script_dict, '__except__')
        if not cb:
            cb = pd_except

        finished = not cb(py_path, sys.exc_type, sys.exc_value,
                          tb=traceback, globals=globals())


    #f.close()


    # did the PY script take care of everything? (IE: file download,
    # exception handler doesnt want to show PD).
    # If so, then just return -- *dont* execute PD script.
    # JM 960829

    if blnTechProb:
       if sp.need_headers:
           # was >> print "Content-type: text/html\n"
           try:
               print script_dict['headers'].show()
           except AttributeError:
               print script_dict['headers']
       html_print_techproblems()
       print "<!-- "
       html_print_exc(traceback)
       print "--> "
       return
    if finished or script_dict['headers'].finished():
        return


    # go ahead and print out HTTP headers now.
    # if its whacked, just default it:
    #
    if sp.need_headers:
        try:
            print script_dict['headers'].show()
            #print ' *** ' + dict['headers'].show() + ' *** '
        except AttributeError:
            print script_dict['headers']

    try:
      print pd_script.run(script_dict)
    # catch and ignore broken pipe errors
    except IOError, lstErr:
      if lstErr[1] == 'Broken pipe':
        pass
      else:
        raise lstErr

    except:
      import sys, traceback
      pd_except(py_path, sys.exc_type, sys.exc_value,
                        tb=traceback, globals=globals())
      html_print_techproblems()
      print "<!-- "
      html_print_exc(traceback)
      print "--> "

    return
def topmain():
    import os, sys, posixpath

    SFILE = '/disk2/flags/dblive.html'
    error = ""
    if posixpath.exists(SFILE) == 0:
        import dbdown
        pageVar = dbdown.pageVar
        error = "DBBAD"

    if error:
        print pageVar
    elif os.environ.has_key('PATH_TRANSLATED'):
        import traceback
        try:
            cgi_main()
        except:
            print "<font size=+1>%s: problems</font><P>" %
"PythonDriver"

            print "<PRE>",
            traceback.print_exc()
            print "</PRE>"

    elif len(sys.argv) > 1:

        import string

        scriptpath = sys.argv[1]

        os.environ['REQUEST_METHOD'] = 'GET'
        os.environ['QUERY_STRING']   = string.joinfields( sys.argv[2:],
'&' )

        main(scriptpath, os.environ)
    else:

        print "usage: py-driver <script> [GET-style args...]"

if __name__=="__main__":
    main()


Any help would be GREATLY appreciated. I just need to mimic the netscape
behavior within apache, and i am having problems doing so. Maybe
mod_python isnt the way to go, but if anyone has any ideas for me to
try, i would be extremely greatful

Michael Weiner
Systems Administrator/Partner
The UserFriendly Network
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/x-pkcs7-signature
Size: 2626 bytes
Desc: S/MIME Cryptographic Signature
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20010118/51182ff7/smime-0001.bin
From GManoj at chn.cognizant.com  Thu Jan 18 20:14:53 2001
From: GManoj at chn.cognizant.com (Govindan, Manoj (CTS))
Date: Fri Jan  9 21:52:14 2004
Subject: [mod_python] Need help: Apache, Win NT and Dr Watson error
Message-ID: <697D1663ABD6D1119D880060B0B5456302B78683@ctsinwcbsxua>

> Hi,
> I need help for the following topic.
> I am using Apache 1.3.9 with mod_python 2.7.
> While running a DB accessing script with apache, Win NT *sometimes*
> reporting Dr. Watson error for apache.
> This does not happen always.
> I have set two directories as follows in the config file
> <Directory "f:/site/html/python">
>    AddHandler python-program .py           
>    PythonHandler feedback
>    PythonDebug on
> </Directory>
> 
> <Directory "f:/site/html/test">
>    AddHandler python-program .py           
>    PythonHandler guestbook::gbook
>    PythonDebug on
> </Directory>
> 
> The error comes occasionally for both the scripts.
> 
> Thanks
> Manoj
> 
> 

This e-mail and any files transmitted with it are for the sole use of the intended recipient(s) and may contain confidential and privileged information.
If you are not the intended recipient, please contact the sender by reply e-mail and destroy all copies of the original message. 
Any unauthorised review, use, disclosure, dissemination, forwarding, printing or copying of this email or any action taken in reliance on this e-mail is strictly 
prohibited and may be unlawful.

		Visit us at http://www.cognizant.com


From Stephane.Bidoul at softwareag.com  Thu Jan 18 17:30:29 2001
From: Stephane.Bidoul at softwareag.com (Bidoul, Stephane)
Date: Fri Jan  9 21:52:14 2004
Subject: [mod_python] Need help: Apache, Win NT and Dr Watson error
Message-ID: <C23163F98473D311874C0008C7E621070499C14E@daemsg02.software-ag.de>

mod_python on NT is multithreaded.
A problem might be that some global data
in your script is not protected by a mutex,
and is accessed by concurrent requests.

This is only a wild guess however: you will need to 
provide more details about your scripts if
you need more help.

Best regards.

-Stephane

> -----Original Message-----
> From: Govindan, Manoj (CTS) [mailto:GManoj@chn.cognizant.com]
> Sent: 18 January, 2001 15:45
> To: 'mod_python@modpython.org'
> Subject: [mod_python] Need help: Apache, Win NT and Dr Watson error
> 
> 
> > Hi,
> > I need help for the following topic.
> > I am using Apache 1.3.9 with mod_python 2.7.
> > While running a DB accessing script with apache, Win NT *sometimes*
> > reporting Dr. Watson error for apache.
> > This does not happen always.
> > I have set two directories as follows in the config file
> > <Directory "f:/site/html/python">
> >    AddHandler python-program .py           
> >    PythonHandler feedback
> >    PythonDebug on
> > </Directory>
> > 
> > <Directory "f:/site/html/test">
> >    AddHandler python-program .py           
> >    PythonHandler guestbook::gbook
> >    PythonDebug on
> > </Directory>
> > 
> > The error comes occasionally for both the scripts.
> > 
> > Thanks
> > Manoj
> > 
> > 
> 
> This e-mail and any files transmitted with it are for the 
> sole use of the intended recipient(s) and may contain 
> confidential and privileged information.
> If you are not the intended recipient, please contact the 
> sender by reply e-mail and destroy all copies of the original 
> message. 
> Any unauthorised review, use, disclosure, dissemination, 
> forwarding, printing or copying of this email or any action 
> taken in reliance on this e-mail is strictly 
> prohibited and may be unlawful.
> 
> 		Visit us at http://www.cognizant.com
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 

From grisha at ispol.com  Thu Jan 18 14:17:07 2001
From: grisha at ispol.com (Gregory Trubetskoy)
Date: Fri Jan  9 21:52:14 2004
Subject: [mod_python] Need help: Apache, Win NT and Dr Watson error
In-Reply-To: <697D1663ABD6D1119D880060B0B5456302B78683@ctsinwcbsxua>
Message-ID: <Pine.LNX.4.21.0101181416100.7384-100000@saturn.ispol.com>

You don't specify which database yu're using, but some Windows database
ODBC drivers are not thread safe and can crash when used with
multithreaded applications like apache.


On Thu, 18 Jan 2001, Govindan, Manoj (CTS) wrote:

> > Hi,
> > I need help for the following topic.
> > I am using Apache 1.3.9 with mod_python 2.7.
> > While running a DB accessing script with apache, Win NT *sometimes*
> > reporting Dr. Watson error for apache.
> > This does not happen always.
> > I have set two directories as follows in the config file
> > <Directory "f:/site/html/python">
> >    AddHandler python-program .py           
> >    PythonHandler feedback
> >    PythonDebug on
> > </Directory>
> > 
> > <Directory "f:/site/html/test">
> >    AddHandler python-program .py           
> >    PythonHandler guestbook::gbook
> >    PythonDebug on
> > </Directory>
> > 
> > The error comes occasionally for both the scripts.
> > 
> > Thanks
> > Manoj
> > 
> > 
> 
> This e-mail and any files transmitted with it are for the sole use of the intended recipient(s) and may contain confidential and privileged information.
> If you are not the intended recipient, please contact the sender by reply e-mail and destroy all copies of the original message. 
> Any unauthorised review, use, disclosure, dissemination, forwarding, printing or copying of this email or any action taken in reliance on this e-mail is strictly 
> prohibited and may be unlawful.
> 
> 		Visit us at http://www.cognizant.com
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From klindsay at mkintraweb.com  Thu Jan 18 18:38:36 2001
From: klindsay at mkintraweb.com (Kevin Lindsay)
Date: Fri Jan  9 21:52:14 2004
Subject: [mod_python] Exiting gracefully...
Message-ID: <20010118183836.D22268@mkintraweb.com>

How does one exit from a script called from mod_python?

As an example, I am in the middle of a function and I want
to call an error function and have the script stop as if it
had returned from the handler function wth 'return apache.OK'

I can't seem to find anything in the docs, unless I'm 
missing something.

Any help is appreciated. :)

------------------------------------------------
Kevin Lindsay <klindsay@debian.org>
Debian Developer
81E 58A3 B49A 580E EE3D 8CF0 519A 55F0 746C 51F4

From klindsay at mkintraweb.com  Thu Jan 18 19:16:17 2001
From: klindsay at mkintraweb.com (Kevin Lindsay)
Date: Fri Jan  9 21:52:15 2004
Subject: [mod_python] Reload strangeness
Message-ID: <20010118191617.A24258@mkintraweb.com>

I'm just curious if there is any known reason why when I hit the
reload button in netscape it sometimes loads my script and other
times, without changing any code I get this:

Mod_python error: "PythonHandler gr_main" Traceback (most recent 
call last): File "/usr/lib/python2.0/site-packages/mod_python/apache.py",
line 180, in Dispatch object = resolve_object(self.req, module, object_str,
silent) File "/usr/lib/python2.0/site-packages/mod_python/apache.py", line
396,in resolve_object raise AttributeError, s AttributeError: module 
'/var/www/geekreview/new2/gr_main.py' contains no 'handler' [an error 
occurred while processing this directive]

-----------------------------------------------------------------------
 Kevin Lindsay                  | "Storm Linux, Taking Linux by Storm!"
 Stormix Technologies Inc.      | http://www.stormix.com/
 Chief Technology Officer (CTO) | 
-----------------------------------------------------------------------

From grisha at ispol.com  Thu Jan 18 22:48:25 2001
From: grisha at ispol.com (Gregory Trubetskoy)
Date: Fri Jan  9 21:52:15 2004
Subject: [mod_python] Exiting gracefully...
In-Reply-To: <20010118183836.D22268@mkintraweb.com>
Message-ID: <Pine.LNX.4.21.0101182247000.8591-100000@saturn.ispol.com>

You can always raise an error if you need to exit immeditely:

raise apache.SERVER_ERROR, apache.HTTP_FORBIDDEN

or something like that.

--
  Gregory (Grisha) Trubetskoy
       grisha@ispol.com

On Thu, 18 Jan 2001, Kevin Lindsay wrote:

> How does one exit from a script called from mod_python?
> 
> As an example, I am in the middle of a function and I want
> to call an error function and have the script stop as if it
> had returned from the handler function wth 'return apache.OK'
> 
> I can't seem to find anything in the docs, unless I'm 
> missing something.
> 
> Any help is appreciated. :)
> 
> ------------------------------------------------
> Kevin Lindsay <klindsay@debian.org>
> Debian Developer
> 81E 58A3 B49A 580E EE3D 8CF0 519A 55F0 746C 51F4
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From grisha at ispol.com  Thu Jan 18 22:51:35 2001
From: grisha at ispol.com (Gregory Trubetskoy)
Date: Fri Jan  9 21:52:15 2004
Subject: [mod_python] Reload strangeness
In-Reply-To: <20010118191617.A24258@mkintraweb.com>
Message-ID: <Pine.LNX.4.21.0101182248290.8591-100000@saturn.ispol.com>

It means that '/var/www/geekreview/new2/gr_main.py' contains no function
called handler.

But sometimes in rare cases when you do a lot of editing/development and
config changes, the Python interpreters in some apache processes may end
up being a bit confused as to what's going on, so you just have to restart
apache.

--
  Gregory (Grisha) Trubetskoy
       grisha@ispol.com

On Thu, 18 Jan 2001, Kevin Lindsay wrote:

> I'm just curious if there is any known reason why when I hit the
> reload button in netscape it sometimes loads my script and other
> times, without changing any code I get this:
> 
> Mod_python error: "PythonHandler gr_main" Traceback (most recent 
> call last): File "/usr/lib/python2.0/site-packages/mod_python/apache.py",
> line 180, in Dispatch object = resolve_object(self.req, module, object_str,
> silent) File "/usr/lib/python2.0/site-packages/mod_python/apache.py", line
> 396,in resolve_object raise AttributeError, s AttributeError: module 
> '/var/www/geekreview/new2/gr_main.py' contains no 'handler' [an error 
> occurred while processing this directive]
> 
> -----------------------------------------------------------------------
>  Kevin Lindsay                  | "Storm Linux, Taking Linux by Storm!"
>  Stormix Technologies Inc.      | http://www.stormix.com/
>  Chief Technology Officer (CTO) | 
> -----------------------------------------------------------------------
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From gerhard at bigfoot.de  Fri Jan 19 08:04:49 2001
From: gerhard at bigfoot.de (Gerhard =?iso-8859-1?Q?H=E4ring?=)
Date: Fri Jan  9 21:52:15 2004
Subject: [mod_python] Need help: Apache, Win NT and Dr Watson error
References: <697D1663ABD6D1119D880060B0B5456302B78683@ctsinwcbsxua>
Message-ID: <3A67E711.93531CC5@bigfoot.de>

I would upgrade to Apache 1.3.14. This solved a thread-related problem
for me.

Gerhard

"Govindan, Manoj (CTS)" wrote:
> 
> > Hi,
> > I need help for the following topic.
> > I am using Apache 1.3.9 with mod_python 2.7.
> > While running a DB accessing script with apache, Win NT *sometimes*
> > reporting Dr. Watson error for apache.
> > This does not happen always.
> > I have set two directories as follows in the config file
> > <Directory "f:/site/html/python">
> >    AddHandler python-program .py
> >    PythonHandler feedback
> >    PythonDebug on
> > </Directory>
> >
> > <Directory "f:/site/html/test">
> >    AddHandler python-program .py
> >    PythonHandler guestbook::gbook
> >    PythonDebug on
> > </Directory>
> >
> > The error comes occasionally for both the scripts.

-- 
contact: g e r h a r d @ b i g f o o t . d e
web:     http://highqualdev.com

From jym_brittain at hotmail.com  Fri Jan 19 17:11:18 2001
From: jym_brittain at hotmail.com (James Brittain)
Date: Fri Jan  9 21:52:15 2004
Subject: [mod_python] compiling problems
Message-ID: <LAW2-F1308k69RKLpgT00002acc@hotmail.com>

Does anyone have any experience compiling mod_python in SuSE 7.0? I'm 
getting some strange errors
_________________________________________________________________
Get your FREE download of MSN Explorer at http://explorer.msn.com


From klindsay at mkintraweb.com  Fri Jan 19 13:27:00 2001
From: klindsay at mkintraweb.com (Kevin Lindsay)
Date: Fri Jan  9 21:52:15 2004
Subject: [mod_python] EAPI
Message-ID: <20010119132700.I24258@mkintraweb.com>

Apache 1.3.14 in Debian (unstable) required EAPI to be compiled into
its DSO modules.  There is nothing in the mod python docs regarding
EAPI. Will this affect anything? Doesn't seem to be.

BTW, I will be packaging modpython and maintaining it for Debian. :)

------------------------------------------------
Kevin Lindsay <klindsay@debian.org>
Debian Developer
81E 58A3 B49A 580E EE3D 8CF0 519A 55F0 746C 51F4


From msandin at hotmail.com  Mon Jan 22 09:45:02 2001
From: msandin at hotmail.com (Martin Sandin)
Date: Fri Jan  9 21:52:15 2004
Subject: [mod_python] mod_python on Win98
Message-ID: <F149y3rB07XOq3JkrKd000058a8@hotmail.com>

Hello!

I'll renew my request for help with this mail. I hope I'm no rude, but I'd 
really like to evaluate the possibility of using Apache/mod_python for 
running parts of a system the company I work at use.

When I add mod_python.dll (for Python 2.0) to the modules/ directory in 
apache, and have the Python20 directory in the PATH env variable, and add a 
LoadModule directive to Apache's httpd.conf with no other mod_python 
references I get the following error on startup of Apache:

"'import site' failed; use -v for traceback"


When configuring apache as suggested in the mp docs I also get the following 
in errors.log when trying to access that URL:

"python_handler: make_obcallback returned no obCallBack!"


Have the exact same behavior on two separate Win98 machines, with the latest 
versions of Apache 1.3 and mod_python. Is there any help available or should 
I just give up on using mod_python? =(


-
Martin
come.to/vague
_________________________________________________________________________
Get Your Private, Free E-mail from MSN Hotmail at http://www.hotmail.com.


From davidc at downright.com  Mon Jan 22 10:19:31 2001
From: davidc at downright.com (David Cohen)
Date: Fri Jan  9 21:52:15 2004
Subject: [mod_python] Installing on RH7.0
Message-ID: <NCBBLAIKFCKAJGLOGAHPGEAGCKAA.davidc@downright.com>

After a long, long weekend, I've crashed and burned attempting to install mod_python on RH7.0 (with all RHN updates).

The RPM install failed by rendering httpd unstartable (instant death with no apparent reason). Commenting out the LoadModule and AddModule lines for mod_python gets httpd working again in its original state).

Has anyone successfully installed via the RPM? Furthermore, can this RPM be used with python 2.0 (my desired platform)?

If not successful with RPM, has anyone successfully installed from source on RH7.0 w/python 2.0?

Thanks!

David Cohen
VP/CTO
Downright Software LLC
18227-D Flower Hill Way, Gaithersburg, MD 20879
voice: 301.948.4030

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010122/adff5a30/attachment-0001.htm
From mike at mikebell.org  Mon Jan 22 16:16:41 2001
From: mike at mikebell.org (Mike Bell)
Date: Fri Jan  9 21:52:15 2004
Subject: [mod_python] Large req.writes prevent header from being outputted?
Message-ID: <20010122161641.E550@vaio.mikebell.org>

With my installation (mod_python 2.7.1 w/python 2.0), doing

  req.content_type = DetermineMimeType(filepath)
  req.send_http_header()
  myjpeg = open(filepath)
  req.write(myjpeg.read())

with a very large image (appears to be around 1/4MB) will result in an HTTP
transaction where no headers are outputted, just binary data. However,
something like

  req.content_type = DetermineMimeType(filepath)
  req.send_http_header()
  myjpeg = open(filepath)
  while 1:
    temp = myjpeg.read(65535)
    if temp == "":
      break
    req.write(temp)

will work just fine.

Presumably req.write should work for these large values, or at least raise
an exception rather than dropping data.

From sandor at cs.uu.nl  Tue Jan 23 12:27:41 2001
From: sandor at cs.uu.nl (Sandor Spruit)
Date: Fri Jan  9 21:52:15 2004
Subject: [mod_python] One question before I start experimenting with mod_python
Message-ID: <18519.010123@cs.uu.nl>

[Please note: I'm not a regular reader of this list. Please be so kind
to send any replies directly to me; I'll summarize to the list]

Hello list members,

I've just got one question: "do Python programs need to be
specifically tailored for use with mod_python, or should Python
CGI programs be able to run unmodified ?"

My guess is, that I need some sort of a "connector" to convert the
regular CGI parameters into Python interpreter parameters, and start
the interpreter on the appropriate script. I'd have to rewrite that
connector to make use of the mod_python facilities. Any additional
pitfalls that I don't see yet ?

TIA,
Sandor
-- 
ir A.G.L. Spruit, Utrecht University, the Netherlands
Institute of information and computing sciences
"There is a bit of magic in everything, and then some
loss to even things out" (from: Lou Reed, "Magic and Loss")



From grisha at ispol.com  Tue Jan 23 22:45:46 2001
From: grisha at ispol.com (Gregory Trubetskoy)
Date: Fri Jan  9 21:52:15 2004
Subject: [mod_python] Large req.writes prevent header from being outputted?
In-Reply-To: <20010122161641.E550@vaio.mikebell.org>
Message-ID: <Pine.LNX.4.21.0101232242260.3867-100000@saturn.ispol.com>

Mike - 

I'm not able to reproduce this. I just tried something similar with an 8Mb
file, and I get all the headers and data correctly.

Anyone else seeing this behaviour?

Could the problem be something with your client? I used wget -S to test my
results.

--
  Gregory (Grisha) Trubetskoy
       grisha@ispol.com

On Mon, 22 Jan 2001, Mike Bell wrote:

> With my installation (mod_python 2.7.1 w/python 2.0), doing
> 
>   req.content_type = DetermineMimeType(filepath)
>   req.send_http_header()
>   myjpeg = open(filepath)
>   req.write(myjpeg.read())
> 
> with a very large image (appears to be around 1/4MB) will result in an HTTP
> transaction where no headers are outputted, just binary data. However,
> something like
> 
>   req.content_type = DetermineMimeType(filepath)
>   req.send_http_header()
>   myjpeg = open(filepath)
>   while 1:
>     temp = myjpeg.read(65535)
>     if temp == "":
>       break
>     req.write(temp)
> 
> will work just fine.
> 
> Presumably req.write should work for these large values, or at least raise
> an exception rather than dropping data.
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From mike at mikebell.org  Tue Jan 23 20:56:14 2001
From: mike at mikebell.org (Mike Bell)
Date: Fri Jan  9 21:52:15 2004
Subject: [mod_python] Large req.writes prevent header from being outputted?
In-Reply-To: <Pine.LNX.4.21.0101232242260.3867-100000@saturn.ispol.com>; from grisha@ispol.com on Tue, Jan 23, 2001 at 10:45:46PM -0500
References: <20010122161641.E550@vaio.mikebell.org> <Pine.LNX.4.21.0101232242260.3867-100000@saturn.ispol.com>
Message-ID: <20010123205613.B9591@vaio.mikebell.org>

On Tue, Jan 23, 2001 at 10:45:46PM -0500, Gregory Trubetskoy wrote:
> 
> Mike - 
> 
> I'm not able to reproduce this. I just tried something similar with an 8Mb
> file, and I get all the headers and data correctly.

How odd...

> Could the problem be something with your client? I used wget -S to test my
> results.

I used telnet.


From afaby at mail.tenon.com  Thu Jan 25 14:26:35 2001
From: afaby at mail.tenon.com (Aaron Faby)
Date: Fri Jan  9 21:52:15 2004
Subject: [mod_python] mod_python + mod_php4 on Mac OS X w/ apache 1.3.14: no workie!
Message-ID: <ALS.HGW@tenon.com>

I get the following error when attempting to start apache 1.3.14 w/ 
mod_php4 and mod_python
on Mac OS X Public Beta:

dyld: /usr/sbin/apache multiple definitions of symbol _pcre_free
/System/Library/Apache/Modules/mod_python.so definition of _pcre_free
/System/Library/Apache/Modules/libphp4.so definition of _pcre_free

Any ideas?

--------------------------------------------------------------------------------------------------
Aaron Faby					                             Software Developer
Tenon Intersystems			         	                                
afaby@tenon.com
1123 Chapala Street			                                       
805-963-6983
Santa Barbara, CA 93103                                             
http://www.tenon.com
--------------------------------------------------------------------------------------------------

From ioseph at paolo.net  Sat Jan 27 06:40:03 2001
From: ioseph at paolo.net (Ioseph Kim)
Date: Fri Jan  9 21:52:15 2004
Subject: [mod_python] How use redirection in cgihandler?
Message-ID: <20010127064003.A4017@paolo.net>

Apache : 1.3.14
Python : 2.0
mod_python : 2.7.1

I maked a simple script a.py

print 'Location: /\n'

-------

but, this script did not work. -.-

> telnet localhost 80
Trying 127.0.0.1...
Connected to localhost.paolo.net.
Escape character is '^]'.
GET /~ioseph/python/a.py HTTP/1.0

HTTP/1.1 200 OK
Date: Fri, 26 Jan 2001 21:36:07 GMT
Server: Apache/1.3.14 (Unix) mod_python/2.7.1 Python/2.0
Location: /
Connection: close
Content-Type: text/plain

Connection closed by foreign host.

--------
in this case, HTTP Status code is 200. 

to url redirect, web server might to return http status code 302.

How I can use "Location:" header in cgihandler?


From john at coastalgeology.org  Sat Jan 27 10:24:05 2001
From: john at coastalgeology.org (Jonathan Pennington)
Date: Fri Jan  9 21:52:15 2004
Subject: [mod_python] Example sites
Message-ID: <20010127102405.A80697@coastalgeology.org>

I am currently researching to re-program a database-driven site from
PHP/MySQL to Python/PostgreSQL. My problem is that, although I'm a
fairly competent Python programmer, I haven't done any mod_python or
python web work at all. I learn by example. I have the mod_python
manual, but does anyone have a code suite from a Python driven site
that I could see? It's always better for me to read code than to
figure out how to do something from scratch. Thanks.

-J
-- 
Jonathan Pennington		| http://coastalgeology.org
Site Manager			| Protection and stewardship
CoastalGeology.Org (CGO)	| through public education.
john@coastalgeology.org		| Join CGO, make a difference.

From oddmund.mogedal at accenture.com  Tue Jan 30 20:36:08 2001
From: oddmund.mogedal at accenture.com (oddmund.mogedal@accenture.com)
Date: Fri Jan  9 21:52:15 2004
Subject: [mod_python] Problem writing to file from handler
Message-ID: <OF8332020C.21CD26E6-ON062569E5.000D2901@accenture.com>

Hi,

I need to write to a file from within a script (called using publisher.py).
For some reason, I am not allowed to write to the file, even though it
exists and has write permission for everyone.
(Yes, it is a security risk, but not in the environment where I will use
it.)

I have tried the same thing using the cgi module, and then I am allowed to
write to the file.
Is there a difference in access rights to the file system between a script
called from mod_python and a script called using CGI?

Does anybody know what is causing this problem?

Using mod_python: DOES NOT WORK
    import getpass

    def omtest(req, username, file):
        myfile = open("testom", 'wb')
        myfile.write(file)
        myfile.close()
        return "%s\n%d\n%s\n" % (username, len(file), getpass.getuser())

Using cgi: WORKS OK
    #!/usr/local/bin/python2.0

    import getpass
    import sys
    import cgi

    myfile = open("testom", 'wb')
    form = cgi.FieldStorage()
    name = form["name"].value
    file = form["file"].value
    myfile.write(file)

    print "Content-Type: text/html"
    print
    print name
    print getpass.getuser()




Oddmund



This message is for the designated recipient only and may contain
privileged or confidential information.  If you have received it in error,
please notify the sender immediately and delete the original.  Any other
use of the email by you is prohibited.



From grisha at ispol.com  Tue Jan 30 22:08:13 2001
From: grisha at ispol.com (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:15 2004
Subject: [mod_python] Problem writing to file from handler
In-Reply-To: <OF8332020C.21CD26E6-ON062569E5.000D2901@accenture.com>
Message-ID: <Pine.BSF.4.21.0101302201010.14374-100000@localhost>

The difference is the current directory. CGI scripts are executed with the
directory where the script is located as current, with mod_python the
current directory is undefined. You need to specify full path to your file
when opening it.

Grisha

On Tue, 30 Jan 2001 oddmund.mogedal@accenture.com wrote:

> Hi,
> 
> I need to write to a file from within a script (called using publisher.py).
> For some reason, I am not allowed to write to the file, even though it
> exists and has write permission for everyone.
> (Yes, it is a security risk, but not in the environment where I will use
> it.)
> 
> I have tried the same thing using the cgi module, and then I am allowed to
> write to the file.
> Is there a difference in access rights to the file system between a script
> called from mod_python and a script called using CGI?
> 
> Does anybody know what is causing this problem?
> 
> Using mod_python: DOES NOT WORK
>     import getpass
> 
>     def omtest(req, username, file):
>         myfile = open("testom", 'wb')
>         myfile.write(file)
>         myfile.close()
>         return "%s\n%d\n%s\n" % (username, len(file), getpass.getuser())
> 
> Using cgi: WORKS OK
>     #!/usr/local/bin/python2.0
> 
>     import getpass
>     import sys
>     import cgi
> 
>     myfile = open("testom", 'wb')
>     form = cgi.FieldStorage()
>     name = form["name"].value
>     file = form["file"].value
>     myfile.write(file)
> 
>     print "Content-Type: text/html"
>     print
>     print name
>     print getpass.getuser()
> 
> 
> 
> 
> Oddmund
> 
> 
> 
> This message is for the designated recipient only and may contain
> privileged or confidential information.  If you have received it in error,
> please notify the sender immediately and delete the original.  Any other
> use of the email by you is prohibited.
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From stanton at livsform.com  Wed Jan 31 03:23:08 2001
From: stanton at livsform.com (Stanton Schell)
Date: Fri Jan  9 21:52:15 2004
Subject: [mod_python] Python libraries install configuration issue
Message-ID: <B69D359B.AD45%stanton@livsform.com>

Hello All,

I have two (unrelated) questions:

1. I was unable to find a searchable version  of the archives - is there
one?

2. Am I forced to install the python libraries during the mod_python
installation into somewhere in /usr/local/lib or can I configure it somehow
to target another directory?  I am trying to install a non-root required
version and would like to stay away from common system areas.

-stanton schell
-- 

Stanton Schell
livsform design group
stanton@livsform.com
703-538-3491
703-989-6591


From stanton at livsform.com  Wed Jan 31 03:32:10 2001
From: stanton at livsform.com (Stanton Schell)
Date: Fri Jan  9 21:52:15 2004
Subject: [mod_python] Python libraries install configuration issue
In-Reply-To: <B69D359B.AD45%stanton@livsform.com>
Message-ID: <B69D37BA.AD47%stanton@livsform.com>

(In other words, I have my source tree and accompanying python libs in
user-owned directory and nothing is in /usr/local/lib at all...)

Thanks!!
-stanton schell
-- 

Stanton Schell
livsform design group
stanton@livsform.com
703-538-3491
703-989-6591

> From: Stanton Schell <stanton@livsform.com>
> Date: Wed, 31 Jan 2001 03:23:08 -0500
> To: <mod_python@modpython.org>
> Subject: [mod_python] Python libraries install configuration issue
> 
> Hello All,
> 
> I have two (unrelated) questions:
> 
> 1. I was unable to find a searchable version  of the archives - is there
> one?
> 
> 2. Am I forced to install the python libraries during the mod_python
> installation into somewhere in /usr/local/lib or can I configure it somehow
> to target another directory?  I am trying to install a non-root required
> version and would like to stay away from common system areas.
> 
> -stanton schell
> -- 
> 
> Stanton Schell
> livsform design group
> stanton@livsform.com
> 703-538-3491
> 703-989-6591
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From stanton at livsform.com  Wed Jan 31 04:14:07 2001
From: stanton at livsform.com (Stanton Schell)
Date: Fri Jan  9 21:52:15 2004
Subject: [mod_python] Python libraries install configuration issue
In-Reply-To: <B69D359B.AD45%stanton@livsform.com>
Message-ID: <B69D418F.AD48%stanton@livsform.com>

sorry for the numerous emails, but the problem has morphed...

I broke down and copied the libraries over to that directory and it was
still having a callback problem (I have pasted the error message in Apache's
error log below).  I then recompiled with the library directory in the
Makefile as the directory I wanted, everything installed, but this same
callback message came when running the test from the manual:

make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
[Wed Jan 31 03:03:16 2001]  [error]  [client 192.168.1.2] python_handler:
    make_obcallback returned no obCallBack!

any help would be appreciated :-)

cheers,
-stanton schell
-- 

Stanton Schell
livsform design group
stanton@livsform.com
703-538-3491
703-989-6591

> From: Stanton Schell <stanton@livsform.com>
> Date: Wed, 31 Jan 2001 03:23:08 -0500
> To: <mod_python@modpython.org>
> Subject: [mod_python] Python libraries install configuration issue
> 
> Hello All,
> 
> I have two (unrelated) questions:
> 
> 1. I was unable to find a searchable version  of the archives - is there
> one?
> 
> 2. Am I forced to install the python libraries during the mod_python
> installation into somewhere in /usr/local/lib or can I configure it somehow
> to target another directory?  I am trying to install a non-root required
> version and would like to stay away from common system areas.
> 
> -stanton schell
> -- 
> 
> Stanton Schell
> livsform design group
> stanton@livsform.com
> 703-538-3491
> 703-989-6591
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From rsalz at caveosystems.com  Wed Jan 31 07:40:08 2001
From: rsalz at caveosystems.com (Rich Salz)
Date: Fri Jan  9 21:52:15 2004
Subject: [mod_python] Python libraries install configuration issue
References: <B69D37BA.AD47%stanton@livsform.com>
Message-ID: <3A7807A8.5EC8CC9F@caveosystems.com>

You need to use PythonPath in your httpd.conf file.
	/r$

From grisha at ispol.com  Wed Jan 31 10:56:40 2001
From: grisha at ispol.com (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:15 2004
Subject: [mod_python] Python libraries install configuration issue
In-Reply-To: <B69D37BA.AD47%stanton@livsform.com>
Message-ID: <Pine.BSF.4.21.0101311056090.57390-100000@localhost>

have you looked at the --with-python configure option?

On Wed, 31 Jan 2001, Stanton Schell wrote:

> (In other words, I have my source tree and accompanying python libs in
> user-owned directory and nothing is in /usr/local/lib at all...)
> 
> Thanks!!
> -stanton schell
> -- 
> 
> Stanton Schell
> livsform design group
> stanton@livsform.com
> 703-538-3491
> 703-989-6591
> 
> > From: Stanton Schell <stanton@livsform.com>
> > Date: Wed, 31 Jan 2001 03:23:08 -0500
> > To: <mod_python@modpython.org>
> > Subject: [mod_python] Python libraries install configuration issue
> > 
> > Hello All,
> > 
> > I have two (unrelated) questions:
> > 
> > 1. I was unable to find a searchable version  of the archives - is there
> > one?
> > 
> > 2. Am I forced to install the python libraries during the mod_python
> > installation into somewhere in /usr/local/lib or can I configure it somehow
> > to target another directory?  I am trying to install a non-root required
> > version and would like to stay away from common system areas.
> > 
> > -stanton schell
> > -- 
> > 
> > Stanton Schell
> > livsform design group
> > stanton@livsform.com
> > 703-538-3491
> > 703-989-6591
> > 
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://www.modpython.org/mailman/listinfo/mod_python
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From thornton at yoyoweb.com  Wed Jan 31 09:22:15 2001
From: thornton at yoyoweb.com (Thornton Prime)
Date: Fri Jan  9 21:52:15 2004
Subject: [mod_python] APahce 1.3.17 vs. mod_python
Message-ID: <Pine.LNX.4.32.0101310917040.1986-100000@prajna.anatman.org>

I'm just wondering if anyone has gotten mod_python to work against 1.3.17
yet. I had things working under 1.3.14, but after upgrading to 1.3.17 it
segfaults. I'm hoping someone else has a fix before I dive in with a
debugger.

I already re-compiled mod_python against 1.3.17, and it is at the top of
my addmodules list.

thornton


From stanton at livsform.com  Wed Jan 31 14:06:28 2001
From: stanton at livsform.com (Stanton Schell)
Date: Fri Jan  9 21:52:15 2004
Subject: [mod_python] Python libraries install configuration issue
In-Reply-To: <3A7807A8.5EC8CC9F@caveosystems.com>
References: <3A7807A8.5EC8CC9F@caveosystems.com>
Message-ID: <50115.38.233.141.43.980967988.squirrel@miesmail.livsform.com>

> You need to use PythonPath in your httpd.conf file.
> 	/r$

Thanks for the response.

However, I still have the (a similar) problem:

I have configured the PythonPath directive to include a number of different directories 
including the library directory in my Python build, but still the same thing.  Is there anything 
specifically that mod_python is looking for that I can correct temporarily to at least move on to 
another error message? :-)

-stanton schell

-- 
Stanton Schell
stanton@livsform.com
703.989.6591
703.538.3491

From stanton at livsform.com  Wed Jan 31 21:01:20 2001
From: stanton at livsform.com (Stanton Schell)
Date: Fri Jan  9 21:52:15 2004
Subject: [mod_python] Python libraries install configuration issue
In-Reply-To: <Pine.BSF.4.21.0101311056090.57390-100000@localhost>
Message-ID: <B69E2DA0.AD72%stanton@livsform.com>

I did indeed, I used " --with-python=/path/to/source/root --with-apache=,
etc..."

I have tried putting all these library files in a number of different
locations in addition to including quite a few directories in the PythonPath
directive in httpd.conf, but the module still seems not available for
import.  do you think there is any reason the interpreter could not _import_
the module as opposed to being able to _find_ it?  just a thought...

-stanton
-- 

Stanton Schell
livsform design group
stanton@livsform.com
703-538-3491
703-989-6591

> From: "Gregory (Grisha) Trubetskoy" <grisha@ispol.com>
> Date: Wed, 31 Jan 2001 10:56:40 -0500 (EST)
> To: Stanton Schell <stanton@livsform.com>
> Cc: mod_python@modpython.org
> Subject: Re: [mod_python] Python libraries install configuration issue
> 
> 
> have you looked at the --with-python configure option?
> 
> On Wed, 31 Jan 2001, Stanton Schell wrote:
> 
>> (In other words, I have my source tree and accompanying python libs in
>> user-owned directory and nothing is in /usr/local/lib at all...)
>> 
>> Thanks!!
>> -stanton schell
>> -- 
>> 
>> Stanton Schell
>> livsform design group
>> stanton@livsform.com
>> 703-538-3491
>> 703-989-6591
>> 
>>> From: Stanton Schell <stanton@livsform.com>
>>> Date: Wed, 31 Jan 2001 03:23:08 -0500
>>> To: <mod_python@modpython.org>
>>> Subject: [mod_python] Python libraries install configuration issue
>>> 
>>> Hello All,
>>> 
>>> I have two (unrelated) questions:
>>> 
>>> 1. I was unable to find a searchable version  of the archives - is there
>>> one?
>>> 
>>> 2. Am I forced to install the python libraries during the mod_python
>>> installation into somewhere in /usr/local/lib or can I configure it somehow
>>> to target another directory?  I am trying to install a non-root required
>>> version and would like to stay away from common system areas.
>>> 
>>> -stanton schell
>>> -- 
>>> 
>>> Stanton Schell
>>> livsform design group
>>> stanton@livsform.com
>>> 703-538-3491
>>> 703-989-6591
>>> 
>>> _______________________________________________
>>> Mod_python mailing list
>>> Mod_python@modpython.org
>>> http://www.modpython.org/mailman/listinfo/mod_python
>> 
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://www.modpython.org/mailman/listinfo/mod_python
>> 


From grisha at ispol.com  Wed Jan 31 23:29:44 2001
From: grisha at ispol.com (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:15 2004
Subject: [mod_python] modpublisher security model
In-Reply-To: <NCBBKMABOKFCDLPIKKGIMEHGCJAA.brett@bookshop.unsw.edu.au>
Message-ID: <Pine.BSF.4.21.0101312320090.70118-100000@localhost>

I have in CVS some fixes that do not allow the publisher handler to
traverse modules. Right now if your script imports os, then one can get to
os and functions within it via a url, which is really bad. (ZPublisher
doesn't traverse modules either.)

Assuming that module traversing issue is fixed - you make a function
"published" by simply having it in the module. If you do not want it to be
published, you can set it's name to begin with an underscore or place it
into another module.

I did this because the ZPublisher comment thing always annoyed me. It's
really misleading - I like to use comments for what they are - comments,
and if a function doesn't need a comment, I prefer to have the option of
having no comment rather than """ this comment is for ZPublisher """ or
something silly like that.

Grisha

On Thu, 1 Feb 2001, Brett Haydon wrote:

> Evidently Zope currently uses the doc string to 
> explicity allow access to functions via URL.
> 
> The new Python 2.1 will allow functions to have
> attributes.
> 
> I am currently renaming all imported modules with
> an underscore to avoid unintentional security problems
> (and global objects)
> but I like the idea of explicitly allowing access.
> 
> Any plans to move in this direction.
> 
> regards,
> ______________________________________________
> Brett Haydon
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From arhiv at freemail.org.mk  Mon Jan  1 21:54:25 2001
From: arhiv at freemail.org.mk (Damjan)
Date: Fri Jan  9 21:58:45 2004
Subject: [mod_python] Sugestion about publisher
Message-ID: <20010101215425.A606@localhost.localdomain>

Here is a small patch for mod_python.publisher, that instead of raising an
error when there is no PATH_INFO, it substitutes a default PATH_INFO. 
(I choose index_html, perhaps a diferent default method can be chosen)

That way when we call a script without specifying a method, the method
index_html is called.

--- publisher.py.old    Mon Jan  1 21:48:04 2001
+++ publisher.py        Mon Jan  1 21:47:39 2001
@@ -81,7 +81,7 @@
 
     # get the path PATH_INFO (everthing after script)
     if not _req.subprocess_env.has_key("PATH_INFO"):
-        raise apache.SERVER_RETURN, apache.HTTP_NOT_FOUND
+        _req.subprocess_env["PATH_INFO"]="/index_html"
     
     func_path = _req.subprocess_env["PATH_INFO"][1:] # skip fist /
     func_path = string.replace(func_path, "/", ".")


-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From peter.bittner at gmx.net  Tue Jan  2 14:22:37 2001
From: peter.bittner at gmx.net (peter.bittner@gmx.net)
Date: Fri Jan  9 21:58:45 2004
Subject: [mod_python] mod_python vs. PyApache, mod_snake
Message-ID: <1294.978441757@www32.gmx.net>

Hi there!

I've heard about that Python is available as a module for Apache too!
That's cool, but what is right for me?

 mod_python, PyApache oder mod_snake?

I've sound them all three.
I want to either use CGI or embedded Python (embedded in HTML) - or both.
Can anyone tell me what is best for me?

Cheers,
Peter

-- 
Peter Bittner
web: http://beam.to/peter.bittner
mail: peter.bittner@gmx.net
mobile: +43/(0)650/8901150
+-----------------------------
| HTML-Minikurs:  http://beam.to/htmlkurs
| Gesundheit:  http://www.gesundheitsfoerderung.at
| Fasten:  http://www.gesundheitsfoerderung.at/fasten

Sent through GMX FreeMail - http://www.gmx.net


From grisha at ispol.com  Tue Jan  2 17:22:09 2001
From: grisha at ispol.com (Gregory Trubetskoy)
Date: Fri Jan  9 21:58:45 2004
Subject: [mod_python] Sugestion about publisher
In-Reply-To: <20010101215425.A606@localhost.localdomain>
Message-ID: <Pine.LNX.4.21.0101021718210.28295-100000@saturn.ispol.com>

But I wonder what the usability of such a feature might be. (I'm not
aysing I'm against it, I'd just like to have a small discussion about it
first). 

In general, I do not like implicit or default stuff like this - I think if
you're specifying a module without a method, you should get nothing in
return. 

Another note - this modifies PATH_INFO. I think PATH_INFO should always
represent what the user passed. 


On Mon, 1 Jan 2001, Damjan wrote:

> Here is a small patch for mod_python.publisher, that instead of raising an
> error when there is no PATH_INFO, it substitutes a default PATH_INFO. 
> (I choose index_html, perhaps a diferent default method can be chosen)
> 
> That way when we call a script without specifying a method, the method
> index_html is called.
> 
> --- publisher.py.old    Mon Jan  1 21:48:04 2001
> +++ publisher.py        Mon Jan  1 21:47:39 2001
> @@ -81,7 +81,7 @@
>  
>      # get the path PATH_INFO (everthing after script)
>      if not _req.subprocess_env.has_key("PATH_INFO"):
> -        raise apache.SERVER_RETURN, apache.HTTP_NOT_FOUND
> +        _req.subprocess_env["PATH_INFO"]="/index_html"
>      
>      func_path = _req.subprocess_env["PATH_INFO"][1:] # skip fist /
>      func_path = string.replace(func_path, "/", ".")
> 
> 
> -- 
> Damjan Georgievski		|           ???????????? ??????????????????????
> Skopje, Macedonia		|           ????????????, ????????????????????
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From mecury at illusion.snu.ac.kr  Wed Jan  3 10:57:12 2001
From: mecury at illusion.snu.ac.kr (sjw)
Date: Fri Jan  9 21:58:45 2004
Subject: [mod_python] A Newbie's question,
Message-ID: <Pine.GSO.4.05.10101031051530.18076-100000@illusion>

hmm, I've installed mod_python and tested it

and it was ok..

( the code is the sample code, like following..

from mod_python import apache
 
def handler(req):
    req.send_http_header()
    req.write("Hello World!")
    return apache.OK  )

BUT, All I want to do is paste a simple, text counter 

to my homepage, like <!--#exec cgi="some/dirs/counter.cgi?id=myID"-->

did.

How can I do that with mod-python?..

Thanks in advance



From dyeung at ust.hk  Wed Jan  3 13:47:56 2001
From: dyeung at ust.hk (David YEUNG)
Date: Fri Jan  9 21:58:45 2004
Subject: [mod_python] Error with the req.register_cleanup
Message-ID: <3A52BD0C.9BA9B475@ust.hk>

Is there any code example how to use the 'req.register_cleanup()'?
I tried to put a function to disconnect the database through the
req.register_cleanup as following:


def index(req):
  ...
  db = MySQLdb.connect(...)
  cur = db.cursor()
  req.register_cleanup(disconnectdb,cur)
  ...
  ... some db query

def disconnectdb(cur):
  db = cur.connection
  cur.close()
  db.close()

  
The apache error_log file keeps displaying the following errors whenever
I invoke the 'register_cleanup' methods. If I do not use the 'register_cleanup',
but call the 'disconnectdb' at the end of the 'index' function. There is no
error in the log file.

---- error_log ----
[Tue Jan  2 21:32:28 2001] [notice] child pid 31239 exit signal Aborted (6)
Fatal Python error: PyThreadState_Get: no current thread
[Tue Jan  2 21:32:40 2001] [notice] child pid 31238 exit signal Aborted (6)
Fatal Python error: PyThreadState_Get: no current thread
[Tue Jan  2 21:32:46 2001] [notice] child pid 31241 exit signal Aborted (6)
Fatal Python error: PyThreadState_Get: no current thread 


I am using Apache 1.3.14 on RedHat 6.2, mod_python 2.7.1, MySQLdb 0.3.0.

Thanks for any advice.


David Yeung

From aperis at bemarnet.es  Thu Jan  4 16:10:49 2001
From: aperis at bemarnet.es (Arturo Peris)
Date: Fri Jan  9 21:58:45 2004
Subject: [mod_python] util.FieldStorage(req).list
Message-ID: <3A549279.6090905@bemarnet.es>

Hi,
my problem is with util.FieldStorage, I can't get information contained 
in content variable.
I call my form.py program from here:

...<form action= "/mailing/form.py/handler" method="post">...
catsel, subcatsel and idisel are checkbox.


MY form.py PROGRAM
---------------------------------------------
from mod_python import apache
from pg import DB
import string
from mod_python import util

def handler(req,catsel,subcatsel,idisel):
  req.content_type = "text/html"
  req.send_http_header()
  content = util.FieldStorage(req).list
---------------------------------------------

Can ne1 help me ?

Thanks.


From grisha at ispol.com  Thu Jan  4 11:21:04 2001
From: grisha at ispol.com (Gregory Trubetskoy)
Date: Fri Jan  9 21:58:45 2004
Subject: [mod_python] util.FieldStorage(req).list
In-Reply-To: <3A549279.6090905@bemarnet.es>
Message-ID: <Pine.LNX.4.21.0101041112390.2246-100000@saturn.ispol.com>

If you are using the mod_python.publisher handler, then you cannot use
FieldStorage within it (because the publisher handler creates one for
you already), you have to use req.form variable, it's an instance of
util.FieldStorage.

I'm sorry I forgot to document this little fact...

--
  Gregory (Grisha) Trubetskoy
       grisha@ispol.com

On Thu, 4 Jan 2001, Arturo Peris wrote:

> Hi,
> my problem is with util.FieldStorage, I can't get information contained 
> in content variable.
> I call my form.py program from here:
> 
> ...<form action= "/mailing/form.py/handler" method="post">...
> catsel, subcatsel and idisel are checkbox.
> 
> 
> MY form.py PROGRAM
> ---------------------------------------------
> from mod_python import apache
> from pg import DB
> import string
> from mod_python import util
> 
> def handler(req,catsel,subcatsel,idisel):
>   req.content_type = "text/html"
>   req.send_http_header()
>   content = util.FieldStorage(req).list
> ---------------------------------------------
> 
> Can ne1 help me ?
> 
> Thanks.
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From norm at streamtheory.com  Thu Jan  4 22:29:02 2001
From: norm at streamtheory.com (Norman Boccone)
Date: Fri Jan  9 21:58:45 2004
Subject: [mod_python] undefined reference to Py_... error compiling apache
Message-ID: <3A5569AE.9060109@streamtheory.com>

I am on Solaris trying to compile mod_python 2.7.1 into apache 1.3.14.  
Compiling of python and mod_python are fine, make test on python is 
fine.  When I try to make apache I get the following errors:

gcc  -DSOLARIS2=270 -DUSE_EXPAT -I./lib/expat-lite -DNO_DL_NEEDED 
`./apaci`    \
     -o httpd buildmark.o modules.o modules/python/libpython.a 
modules/standard/libstandard.a main/libmain.a ./os/unix/libos.a 
ap/libap.a  lib/expat-lite/libexpat.a  -lsocket -lnsl
modules/python/libpython.a(mod_python.o): In function `make_interpreter':
mod_python.o(.text+0xa7): undefined reference to `Py_NewInterpreter'
mod_python.o(.text+0xe6): undefined reference to `PyThreadState_Swap'
modules/python/libpython.a(mod_python.o): In function 
`get_interpreter_data':
mod_python.o(.text+0x124): undefined reference to `PyDict_GetItemString'
...and a bunch more like this

Any idea how I can fix it?  I thought I followed the instructions exactly.


From arhiv at freemail.org.mk  Fri Jan  5 16:32:33 2001
From: arhiv at freemail.org.mk (Damjan)
Date: Fri Jan  9 21:58:45 2004
Subject: [mod_python] Sugestion about publisher
In-Reply-To: <Pine.LNX.4.21.0101021718210.28295-100000@saturn.ispol.com>; from grisha@ispol.com on Tue, Jan 02, 2001 at 05:22:09PM -0500
References: <20010101215425.A606@localhost.localdomain> <Pine.LNX.4.21.0101021718210.28295-100000@saturn.ispol.com>
Message-ID: <20010105163233.B633@localhost.localdomain>

On Tue, Jan 02, 2001 at 05:22:09PM -0500, Gregory Trubetskoy wrote:
> 
> But I wonder what the usability of such a feature might be. (I'm not
> aysing I'm against it, I'd just like to have a small discussion about it
> first). 

It's usable to me ;) but what do the other mod_python users think?

> In general, I do not like implicit or default stuff like this - I think if
> you're specifying a module without a method, you should get nothing in
> return.

Sometimes people write URL's by hand, and not always will they remember the
whole URL. The problem I see is that you get HTTP_NOT_FOUND for a subset of a
valid URL and IMHO it's not very intuitive compared to 'normal' URL handling.

And every web server has a default page for a directory (index.html..).
 
> Another note - this modifies PATH_INFO. I think PATH_INFO should always
> represent what the user passed. 

It does't modify it, it just specifies a default PATH_INFO when PATH_INFO doesn't
exist at all. But Ok, the patch can be made differrent (I just chouse the sollution with
minimal changes to publisher.py).


-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From rsalz at caveosystems.com  Fri Jan  5 11:02:35 2001
From: rsalz at caveosystems.com (Rich Salz)
Date: Fri Jan  9 21:58:45 2004
Subject: [mod_python] Sugestion about publisher
References: <20010101215425.A606@localhost.localdomain> <Pine.LNX.4.21.0101021718210.28295-100000@saturn.ispol.com> <20010105163233.B633@localhost.localdomain>
Message-ID: <3A55F01B.C1CF1802@caveosystems.com>

I can see the convenience of adding 'index.html' (hee hee :) to the
end of nothing else is there.  Or rather, I can see how it is nice
to mimic other behavior.  But the current hack is wrong.

In apache, if you ask for 'foo' and foo is a directory, the server
sends back a redirect, telling you to go for 'foo/' and then it does
the auto-indexing.

It *might* be worthwhile letting the user emulate that.

But I agree, do not include the current patch and do not modify
PATH_INFO
	/r$

From arhiv at freemail.org.mk  Fri Jan  5 18:19:16 2001
From: arhiv at freemail.org.mk (Damjan)
Date: Fri Jan  9 21:58:45 2004
Subject: [mod_python] Sugestion about publisher
In-Reply-To: <3A55F01B.C1CF1802@caveosystems.com>; from rsalz@caveosystems.com on Fri, Jan 05, 2001 at 11:02:35AM -0500
References: <20010101215425.A606@localhost.localdomain> <Pine.LNX.4.21.0101021718210.28295-100000@saturn.ispol.com> <20010105163233.B633@localhost.localdomain> <3A55F01B.C1CF1802@caveosystems.com>
Message-ID: <20010105181916.A1147@localhost.localdomain>

On Fri, Jan 05, 2001 at 11:02:35AM -0500, Rich Salz wrote:
> I can see the convenience of adding 'index.html' (hee hee :) to the
> end of nothing else is there.  Or rather, I can see how it is nice
> to mimic other behavior.  But the current hack is wrong.
> 
Ok. How about this:

--- publisher.py.old    Mon Jan  1 21:48:04 2001
+++ publisher.py        Fri Jan  5 18:16:34 2001
@@ -81,7 +81,11 @@

     # get the path PATH_INFO (everthing after script)
     if not _req.subprocess_env.has_key("PATH_INFO"):
-        raise apache.SERVER_RETURN, apache.HTTP_NOT_FOUND
+        loc = 'http://' + _req.connection.server.server_hostname
+        loc = loc + ':' + str(_req.connection.server.port)
+        loc = loc + _req.uri + '/index_html'
+        _req.headers_out['Location'] = loc
+        raise apache.SERVER_RETURN, apache.HTTP_MOVED_PERMANENTLY

     func_path = _req.subprocess_env["PATH_INFO"][1:] # skip fist /
     func_path = string.replace(func_path, "/", ".")


-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From rsalz at caveosystems.com  Fri Jan  5 12:49:31 2001
From: rsalz at caveosystems.com (Rich Salz)
Date: Fri Jan  9 21:58:45 2004
Subject: [mod_python] Sugestion about publisher
References: <20010101215425.A606@localhost.localdomain> <Pine.LNX.4.21.0101021718210.28295-100000@saturn.ispol.com> <20010105163233.B633@localhost.localdomain> <3A55F01B.C1CF1802@caveosystems.com> <20010105181916.A1147@localhost.localdomain>
Message-ID: <3A56092B.BB73AE22@caveosystems.com>

Very very cool.  A couple of (minor) things.

> +        loc = 'http://' + _req.connection.server.server_hostname
                  ^^^^^^^^^^
		should get it out of the uri, since it might be https

> +        loc = loc + ':' + str(_req.connection.server.port)
> +        loc = loc + _req.uri + '/index_html'
> +        _req.headers_out['Location'] = loc
> +        raise apache.SERVER_RETURN, apache.HTTP_MOVED_PERMANENTLY
					^^^^^^^^^^^^^^^^^^^^^^^^^^^
should be moved_temporarily, I'm fairly sure.

The whole thing should be controlled by a mod_python auto_index option,
or perhaps based on the DirectoryIndex apache config option?

Anyhow, something like this should go into the code!
	/r$

From arhiv at freemail.org.mk  Sat Jan  6 00:05:10 2001
From: arhiv at freemail.org.mk (Damjan)
Date: Fri Jan  9 21:58:45 2004
Subject: [mod_python] Sugestion about publisher
In-Reply-To: <20010105181916.A1147@localhost.localdomain>; from arhiv@freemail.org.mk on Fri, Jan 05, 2001 at 06:19:16PM +0100
References: <20010101215425.A606@localhost.localdomain> <Pine.LNX.4.21.0101021718210.28295-100000@saturn.ispol.com> <20010105163233.B633@localhost.localdomain> <3A55F01B.C1CF1802@caveosystems.com> <20010105181916.A1147@localhost.localdomain>
Message-ID: <20010106000510.B461@localhost.localdomain>

> Ok. How about this:
> 
> --- publisher.py.old    Mon Jan  1 21:48:04 2001
> +++ publisher.py        Fri Jan  5 18:16:34 2001
> @@ -81,7 +81,11 @@
> 
>      # get the path PATH_INFO (everthing after script)
>      if not _req.subprocess_env.has_key("PATH_INFO"):
> -        raise apache.SERVER_RETURN, apache.HTTP_NOT_FOUND
> +        loc = 'http://' + _req.connection.server.server_hostname
> +        loc = loc + ':' + str(_req.connection.server.port)
> +        loc = loc + _req.uri + '/index_html'
> +        _req.headers_out['Location'] = loc
> +        raise apache.SERVER_RETURN, apache.HTTP_MOVED_PERMANENTLY
> 
>      func_path = _req.subprocess_env["PATH_INFO"][1:] # skip fist /
>      func_path = string.replace(func_path, "/", ".")

Hmmm. 
I found a strange thing in mod_python, while playing with this patch.
The situation is this:
if you type a URL of a with a trailling '/' you get that
req.subprocess_env.["PATH_INFO"] doesn't exist but req.pathinfo is '/'.
Why is   req.subprocess_env.["PATH_INFO"] != req.pathinfo ??

-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From arhiv at freemail.org.mk  Fri Jan  5 21:20:10 2001
From: arhiv at freemail.org.mk (Damjan)
Date: Fri Jan  9 21:58:45 2004
Subject: [mod_python] Sugestion about publisher
In-Reply-To: <3A56092B.BB73AE22@caveosystems.com>; from rsalz@caveosystems.com on Fri, Jan 05, 2001 at 12:49:31PM -0500
References: <20010101215425.A606@localhost.localdomain> <Pine.LNX.4.21.0101021718210.28295-100000@saturn.ispol.com> <20010105163233.B633@localhost.localdomain> <3A55F01B.C1CF1802@caveosystems.com> <20010105181916.A1147@localhost.localdomain> <3A56092B.BB73AE22@caveosystems.com>
Message-ID: <20010105212010.A461@localhost.localdomain>

On Fri, Jan 05, 2001 at 12:49:31PM -0500, Rich Salz wrote:
> Very very cool.  A couple of (minor) things.
> 
> > +        loc = 'http://' + _req.connection.server.server_hostname
>                   ^^^^^^^^^^
> 		should get it out of the uri, since it might be https

I can't see where from in mod_python to get this ?!?

> > +        loc = loc + ':' + str(_req.connection.server.port)
> > +        loc = loc + _req.uri + '/index_html'
> > +        _req.headers_out['Location'] = loc
> > +        raise apache.SERVER_RETURN, apache.HTTP_MOVED_PERMANENTLY
> 					^^^^^^^^^^^^^^^^^^^^^^^^^^^
> should be moved_temporarily, I'm fairly sure.

Well, my Apache returns MOVED_PERMANENTLY for directories, I tried it with:

	damjan# nc local 80
	GET /manual HTTP/1.0

	HTTP/1.1 301 Moved Permanently
	Date: Fri, 05 Jan 2001 20:15:43 GMT
	Server: Apache-AdvancedExtranetServer/1.3.12
	Location: http://localhost.localdomain/manual/
	Connection: close
	Content-Type: text/html; charset=iso-8859-1
	...


> The whole thing should be controlled by a mod_python auto_index option,
> or perhaps based on the DirectoryIndex apache config option?
 
We can think of that later.

One question, should I use req.hostname or 
req.connection.server.server_hostname? (it may be diferent)


-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From rsalz at caveosystems.com  Fri Jan  5 20:28:09 2001
From: rsalz at caveosystems.com (Rich Salz)
Date: Fri Jan  9 21:58:45 2004
Subject: [mod_python] Sugestion about publisher
References: <20010101215425.A606@localhost.localdomain> <Pine.LNX.4.21.0101021718210.28295-100000@saturn.ispol.com> <20010105163233.B633@localhost.localdomain> <3A55F01B.C1CF1802@caveosystems.com> <20010105181916.A1147@localhost.localdomain> <3A56092B.BB73AE22@caveosystems.com> <20010105212010.A461@localhost.localdomain>
Message-ID: <3A5674A9.9B9FB3A8@caveosystems.com>

> > > +        loc = 'http://' + _req.connection.server.server_hostname
> >                   ^^^^^^^^^^
> >               should get it out of the uri, since it might be https
> 
> I can't see where from in mod_python to get this ?!?

Perhaps easiest to leave out the protocol, host, and port altogether.
Won't that work?  loc = _req.uri + /index_html ?

> Well, my Apache returns MOVED_PERMANENTLY for directories, I tried it with:

I must have old information, or an old server -- ncsa code. :)  Thanks.

> One question, should I use req.hostname or
> req.connection.server.server_hostname? (it may be diferent)

If you can't just omit it, then I think you want the second choice, but I'm
not 
very knowledgeable about virtual hosting.
	/r$

From grisha at ispol.com  Fri Jan  5 23:42:42 2001
From: grisha at ispol.com (Gregory Trubetskoy)
Date: Fri Jan  9 21:58:45 2004
Subject: [mod_python] Sugestion about publisher
In-Reply-To: <3A5674A9.9B9FB3A8@caveosystems.com>
Message-ID: <Pine.LNX.4.21.0101052340340.7443-100000@saturn.ispol.com>

> > One question, should I use req.hostname or
> > req.connection.server.server_hostname? (it may be diferent)

req.hostname is a better choice, since this is what the client
supplied. server.server_hostname is the name configured for this virtual
server. I think when you'tr using a default server feature, they may be
different.

grisha


From chris at voodooland.net  Sat Jan  6 21:02:09 2001
From: chris at voodooland.net (Chris Watson)
Date: Fri Jan  9 21:58:45 2004
Subject: [mod_python] mod_python.publisher handler question...
Message-ID: <Pine.BSF.4.21.0101062028510.6987-100000@open-systems.net>

I have seen people ask the same question I am about to in the archives.
But I didn't see an answer archived as well.

It's my understand that for each script in your python dir you NEED to
give it a PythonHandler of the same name? If I have foo.py and bar.py
I need to Directory directives one with PythonHandler foo one with
PythonHandler bar. Right?

What I read was that to eliminate this I could simply set the
PythonHandler to mod_python.publisher. And ALL .py scripts in the python
directory would work. But they don't. I'm sure I have it set wrong or I am
misreading the documentation. I have the following configured in apache:

<Directory /usr/local/share/apache/htdocs/python>
          AddHandler python-program .py
          PythonHandler mod_python.publisher
          PythonDebug On
</Directory>

And In that directory are 3 copies of the hell world script from the
documentation. Each with a different name and none of them work with the
above. If I change the handler name to one of the 3 scripts that one
script will work. Have I misread the doco and am wrong in interperating
that mod_python.publisher will execute *any* .py script thats called in a
url in the directory? OR have I simple not configured apache properly?

Im not on the list so reply to me directly please.

Thanks for you time. Have a good weekend everyone!

Chris




From aperis at bemarnet.es  Tue Jan  9 19:03:26 2001
From: aperis at bemarnet.es (Arturo Peris)
Date: Fri Jan  9 21:58:45 2004
Subject: [mod_python] req.form
Message-ID: <3A5B526E.40803@bemarnet.es>

Hi,
I use req.form variable (it's an instance of util.FieldStorage):
-------------------
content = req.form
lista = content.list
return lista
...

  [Field('Coste', '12'), Field('Coste', '10'), Field('Envios', '1'), 
Field('Return', '/mailing/gen_mail.py/handler')]
-------------------
and my question is, wath is the best way to get values from this list?

Thanks.


From djc at object-craft.com.au  Wed Jan 10 16:49:57 2001
From: djc at object-craft.com.au (Dave Cole)
Date: Fri Jan  9 21:58:45 2004
Subject: [mod_python] Publisher handler has a small problem...
Message-ID: <m33deshs6y.fsf@vole.object-craft.com.au>

If I make the following module hello.py available via the publisher
handler:

        """ Publisher example """
        import os
        
        def say(req, what="NOTHING"):
            return "I am saying %s" % what        

Then a browser request which looks like this:

        /hello/os/renames?old=/tmp/blah&new=/tmp/blah1

will actually work (as the apache user).  I am fairly sure that this
is not desirable...

If someone knows which modules you are importing in your code, they
will be able to call any non-builtin function anywhere in the
namespace.

Maybe the publisher handler should only allow objects to be published
if they have some sort of special attribute, __publish__ for example.

- Dave

-- 
http://www.object-craft.com.au


From Peter.GIANNOPOULOS at gemplus.com  Wed Jan 10 12:58:27 2001
From: Peter.GIANNOPOULOS at gemplus.com (Peter Giannopoulos)
Date: Fri Jan  9 21:58:45 2004
Subject: [mod_python] Server error message
Message-ID: <HEELLMEIEBHKANGCLEELCEGMCCAA.peter.giannopoulos@gemplus.com>

Hello,


I have a question that may have an obvious answer but for the life of me I
can't seem to find it.
Here goes:

Any and every time I use the publisher handler I get an error when I return
any except for a string.
example:


	def handler(req):
        req.content_type = "text/plain"
        req.send_http_header()
        req.write("Hello World!")

        return apache.OK




Displays :

	Hello World!HTTP/1.1 200 OK
	Date: Wed, 10 Jan 2001 17:48:44 GMT
	Server: Apache/1.3.14 (Unix) mod_python/2.7 Python/1.5.2
	Connection: close
	Transfer-Encoding: chunked
	Content-Type: text/html; charset=iso-8859-1

	<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
	<HTML><HEAD>
	<TITLE>200 OK</TITLE>
	</HEAD><BODY>
	<H1>OK</H1>
	The server encountered an internal error or
	misconfiguration and was unable to complete
	your request.<P>
	Please contact the server administrator,
	 petergi@gemplus.com and inform them of the time the error occurred,
	and anything you might have done that may have
	caused the error.<P>
	More information about this error may be available
	in the server error log.<P>
	<HR>
	<ADDRESS>Apache/1.3.14 Server at Medusa Port 80</ADDRESS>
	</BODY></HTML>




But there is nothing in the server logs.
Yet if a return a string instead (any string) even simply ( return " ").
It seems to be fine. Why? Can someone help me understand what is happening?






Peter Giannopoulos, Software Developer
Gemplus Software,   Advanced Projects Group

Phone: +15147322434
Fax:   +15147322401
Gemplus Card International
http://www.gemplus.com


-------------- next part --------------
A non-text attachment was scrubbed...
Name: Peter Giannopoulos.vcf
Type: text/x-vcard
Size: 613 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20010110/4bfcc954/PeterGiannopoulos-0002.vcf
From grisha at ispol.com  Thu Jan 11 01:04:50 2001
From: grisha at ispol.com (Gregory Trubetskoy)
Date: Fri Jan  9 21:58:45 2004
Subject: [mod_python] Publisher handler has a small problem...
In-Reply-To: <m33deshs6y.fsf@vole.object-craft.com.au>
Message-ID: <Pine.LNX.4.21.0101110101550.2739-100000@saturn.ispol.com>

Looks like a rather big prolem to me...

I did some testing with ZPublisher, and it returns "Not Found" when trying
to access os, but does find string... 

I haven't studies the code yet o find out why. I'd rather there was a way
to solve this problem without anything like __publish__...

--
  Gregory (Grisha) Trubetskoy
       grisha@ispol.com

On 10 Jan 2001, Dave Cole wrote:

> If I make the following module hello.py available via the publisher
> handler:
> 
>         """ Publisher example """
>         import os
>         
>         def say(req, what="NOTHING"):
>             return "I am saying %s" % what        
> 
> Then a browser request which looks like this:
> 
>         /hello/os/renames?old=/tmp/blah&new=/tmp/blah1
> 
> will actually work (as the apache user).  I am fairly sure that this
> is not desirable...
> 
> If someone knows which modules you are importing in your code, they
> will be able to call any non-builtin function anywhere in the
> namespace.
> 
> Maybe the publisher handler should only allow objects to be published
> if they have some sort of special attribute, __publish__ for example.
> 
> - Dave
> 
> -- 
> http://www.object-craft.com.au
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From hz at lexgen.com  Fri Jan 12 16:21:47 2001
From: hz at lexgen.com (Hao Zhou)
Date: Fri Jan  9 21:58:45 2004
Subject: [mod_python] mod_python install woe
Message-ID: <20010112162147.A29475@hydrogene.lexgen.com>

Hi everyone,

I got the following error message when I tried to install mod_python
on a Sun machine running SunOS 5.7 with Python 1.5.2.

Could any one shed some light on how to correct it? Thanks a lot!

Hao

/usr/local/apache/bin/httpd -DSSL -d /etc/local/apache/ 
Syntax error on line 121 of /etc/local/apache/conf/httpd.conf:
Cannot load /etc/local/apache/libexec/mod_python.so into server:
ld.so.1: /usr/local/apache/bin/httpd: fatal: relocation error: file
/etc/local/apache/libexec/mod_python.so: symbol __muldi3: referenced
symbol not found


From arhiv at freemail.org.mk  Mon Jan 15 12:29:47 2001
From: arhiv at freemail.org.mk (Damjan)
Date: Fri Jan  9 21:58:45 2004
Subject: [mod_python] Server error message
In-Reply-To: <HEELLMEIEBHKANGCLEELCEGMCCAA.peter.giannopoulos@gemplus.com>; from Peter.GIANNOPOULOS@gemplus.com on Wed, Jan 10, 2001 at 12:58:27PM -0500
References: <HEELLMEIEBHKANGCLEELCEGMCCAA.peter.giannopoulos@gemplus.com>
Message-ID: <20010115122947.A458@localhost.localdomain>

On Wed, Jan 10, 2001 at 12:58:27PM -0500, Peter Giannopoulos wrote:
> Hello,
> 
> 
> I have a question that may have an obvious answer but for the life of me I
> can't seem to find it.
> Here goes:
> 
> Any and every time I use the publisher handler I get an error when I return
> any except for a string.
...
RTFM

The publisher handler EXPECTS the script it called to return the content.


-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From derek at realware.com.au  Tue Jan 16 09:51:16 2001
From: derek at realware.com.au (Derek Lavine)
Date: Fri Jan  9 21:58:45 2004
Subject: [mod_python] Making an exe
Message-ID: <048801c07f4e$0cfb0d10$315119cb@realware.com.au>

Hi all,

I am about to write a couple of little utils as my introduction in to the
python world. The thing is, I would like to be able to give some of these
utils to people that don't have python on their machines. To this end I
would like to create and EXE from the python code. I know this can be done
with ActiveState Perl but can it be done with Python

Thanks in advance
Derek


From grisha at ispol.com  Mon Jan 15 19:10:39 2001
From: grisha at ispol.com (Gregory Trubetskoy)
Date: Fri Jan  9 21:58:45 2004
Subject: [mod_python] Making an exe
In-Reply-To: <048801c07f4e$0cfb0d10$315119cb@realware.com.au>
Message-ID: <Pine.LNX.4.21.0101151909230.29452-100000@saturn.ispol.com>


What does this have to do with mod_python?


On Tue, 16 Jan 2001, Derek Lavine wrote:

> Hi all,
> 
> I am about to write a couple of little utils as my introduction in to the
> python world. The thing is, I would like to be able to give some of these
> utils to people that don't have python on their machines. To this end I
> would like to create and EXE from the python code. I know this can be done
> with ActiveState Perl but can it be done with Python
> 
> Thanks in advance
> Derek
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From derek at realware.com.au  Tue Jan 16 11:16:15 2001
From: derek at realware.com.au (Derek Lavine)
Date: Fri Jan  9 21:58:45 2004
Subject: [mod_python] Making an exe
References: <Pine.LNX.4.21.0101151909230.29452-100000@saturn.ispol.com>
Message-ID: <04aa01c07f59$ec719ee0$315119cb@realware.com.au>

Oops sorry posted to the wrong news group

Derek

----- Original Message -----
From: Gregory Trubetskoy <grisha@ispol.com>
To: Derek Lavine <derek@realware.com.au>
Cc: <Mod_python@modpython.org>
Sent: Tuesday, January 16, 2001 10:10 AM
Subject: Re: [mod_python] Making an exe


>
>
> What does this have to do with mod_python?
>
>
> On Tue, 16 Jan 2001, Derek Lavine wrote:
>
> > Hi all,
> >
> > I am about to write a couple of little utils as my introduction in to
the
> > python world. The thing is, I would like to be able to give some of
these
> > utils to people that don't have python on their machines. To this end I
> > would like to create and EXE from the python code. I know this can be
done
> > with ActiveState Perl but can it be done with Python
> >
> > Thanks in advance
> > Derek
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://www.modpython.org/mailman/listinfo/mod_python
> >
>
>


From rafi at voruta.ek.univ.gda.pl  Wed Jan 17 17:33:51 2001
From: rafi at voruta.ek.univ.gda.pl (rafal polonski)
Date: Fri Jan  9 21:58:46 2004
Subject: [mod_python] Debian 2.2 and mod_python
Message-ID: <20010117173350.A29278@voruta.ek.univ.gda.pl>

Hello,
I am trying to run mod_python on Debian 2.2 distribution.

Apache 1.3.9
Python 1.5.2 (with threads)
mod_python-2.7.1
gcc 2.95

Compiling as a DSO module goes without any error.
Of course I get a warning about having Python compiled WITH threads.

apache -X 
gives me Segmentation fault:
[Wed Jan 17 16:48:01 2001] [notice] caught SIGTERM, shutting down]

So probably I have to blame Python compiled with threads.


So I downloaded Python 1.6, compiled it without threads but trying to
compile mod_python with this 1.6 version gives this error:
gcc -shared -o mod_python.so mod_python.o _apachemodule.o requestobject.o
tableo
bject.o util.o serverobject.o connobject.o -lm
/tmp/modp/Python-1.6/libpython1.6
.a -lieee -ldl -lm -lc -lm -lcrypt -ldb
/usr/bin/ld: mod_python.so: undefined versioned symbol name
_LIB_VERSION@@GLIBC_
2.0
/usr/bin/ld: failed to set dynamic section sizes: Bad value
collect2: ld returned 1 exit status
apxs:Break: Command failed with rc=65536
make[1]: *** [mod_python.so] Error 1
make[1]: Leaving directory `/tmp/modp/mod_python-2.7.1/src'
make: *** [do_dso] Error 2
# 


So I downloaded Python 2.0, compiled it without threads.
With this Python version Apache and mod_python started.
I got quiet huge .so file:
2873238 Jan 17 17:26 mod_python.so 
Stripped version: 1601536 Jan 17 17:28 mod_python.so
Is that normal?


So the question is:
Can I compile mod_python with threaded Python 1.5.2? or just forget 
about threaded vesrion and use one without them?
Why did I get problems trying to use 1.6 Python version wit mod_python?

habe a nice day
rafal

From hunter at userfriendly.net  Wed Jan 17 20:20:21 2001
From: hunter at userfriendly.net (hunter)
Date: Fri Jan  9 21:58:46 2004
Subject: [mod_python] pydriver and apache
Message-ID: <3A6644D5.6F0FB794@userfriendly.net>

I am trying to get pydriver.py to run as a nsapi cgi using RedHat 7.0
Linux 2.2.16 apache 1.3.14 + mod_python webserver. I have this working
on linux/irix netscape enterprise server but not sure how to tell apache
to use pydriver as a cgi for all .py's

Any suggestions, help, comments would be GREATLY appreciated
Michael Weiner
Systems Administrator/Partner
The UserFriendly Network
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/x-pkcs7-signature
Size: 2626 bytes
Desc: S/MIME Cryptographic Signature
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20010117/46817411/smime-0002.bin
From msandin at hotmail.com  Thu Jan 18 08:08:53 2001
From: msandin at hotmail.com (Martin Sandin)
Date: Fri Jan  9 21:58:46 2004
Subject: [mod_python] 'import site' failed
Message-ID: <OE9xG1UrHgmqzWTY0YA0000096a@hotmail.com>

Hello!

I'm trying to get mod_python up running and have run into the same problem
on both Win98 systems I've attempted this feat on. This after following the
instruction provided to the best of my abilities. Apache starts giving the
following message:

'import site' failed; use -v for traceback
Apache/1.3.12 (Win32) mod_python/2.6.3 Python/2.0 running...
'import site' failed; use -v for traceback

and then returning "internal server error" on the URLs pointing to Python
files. I've tracked dow that error message as something that
Python emitts. Thus given I'll ask this:

What does that error message mean? What has gone wrong? How can I fix it in
general? And if anyone knows, how can it be fixed in this particular case?



Configuration is as follows:

Apache 1.3.12 installed in c:\program\servers\apache\

mod_python.dll (for Python2.0) in the modules\ directory


In the httpd.conf file I've got the following lines where appropriate:

LoadModule python_module modules/mod_python.dll

DocumentRoot "C:/Data/Httpserver"

<Directory "C:/Data/Httpserver/python/">
AddHandler python-program .py
PythonHandler test
PythonDebug on
</Directory>


Python (2.0) itself resides in
C:\dev\Python20
which is also in the PATH. No PYPATH variable exists.

The mod_python directory, as extracted from the distribution located in
either of these (I've tried a bunch due to mod_pythons installation
instructions not being up to sync with the dist. archive)
C:\dev\Python20\mod_python\
C:\dev\Python20\lib\mod_python\
C:\dev\Python20\lib\python\mod_python\
C:\dev\Python20\lib\mod_python\python\mod_python\
etc.

The mod_python-2.6.4 directory has been similarly moved around (does it
matter at all?).


As a last piece of information, on the other machine I tried I used the
exact same (save some paths) configuration but with the latest (as of this
morning) versions of mod_python and Apache. The exact same problem.

THanks:-)


-
Martin Sandin
come.to/vague

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010118/0925d74b/attachment-0002.htm
From hunter at userfriendly.net  Thu Jan 18 07:34:59 2001
From: hunter at userfriendly.net (hunter)
Date: Fri Jan  9 21:58:46 2004
Subject: [mod_python] mod_python and apache
Message-ID: <3A66E2F3.CC212E4F@userfriendly.net>

I wrote to the list the other day, asking about converting a webserver
currently using Netscape Enterprise Server and python-1.5.2c to apache
running mod_python and python-1.5.2c due to the licensing being cost
probihitive. We use the "py-driver" within the webserver as nsapi to
push all our .py/.pd/.pc files to the users with netscape configured as
follows:

<snip>
<Object name="default">
NameTrans fn="pfx2dir" from="/cgi-bin"
dir="/disk2/websites/american/cgi-bin" na
me="cgi"
NameTrans fn="document-root" root="/disk2/websites/american/html"
PathCheck fn="unix-uri-clean"
PathCheck fn="check-acl" acl="default"
PathCheck fn="find-pathinfo"
PathCheck fn="find-index" index-names="index.pd"
ObjectType fn="type-by-extension"
ObjectType fn="force-type" type="text/plain"
Service method="(GET|HEAD|POST)" type="magnus-internal/py-driver"
fn="query-hand
ler" path="/disk2/ns-home/nsapi/pd/py-driver"
Service method="(GET|HEAD)" type="magnus-internal/imagemap"
fn="imagemap"
Service method="(GET|HEAD)" type="magnus-internal/directory"
fn="index-common"
Service method="(GET|HEAD|POST)" type="*~magnus-internal/*"
fn="send-file"
</snip>

which basically treats all calls to the .py/.pds as a cgi. Now, in
trying to convert over to apache and mod_python and do the same thing
within the apache configuration is where i am getting a bit confused. I
read through some of the documentation and i think the cgihandler might
be the way to handle this, but thought i would ask more senior python
programmers. I am a systems administrator and nowhere near as
experienced in python as 99% of the group here. So, i am looking for
advice and suggestions to see if a "proof of concept" can even be done.
I realize this might include some python module re-writes but if thats
fairly minimal i am still one step ahead rather than using netscape.

The py-driver being called in the above configuration looks like the
following:

#!/usr/local/bin/python
import sys, os
sys.path.insert(0, '/disk2/ns-home/nsapi/pd/')
sys.path.insert(1, '/disk2/common/')
sys.path.insert(2, '/disk2/ns-home/nsapi/mp/')
import pydriver
pydriver.topmain()

which imports pydriver which looks like the following:

#!/usr/local/bin/python
# -*- Python -*-
# PythonDriver main interpreter
#
# 960701 JM added HTML header override (ie: cookies)
#
# 960618 JM added Advert class
#

# common object layer imports
from col.exception.bopageflagexception import BOPageFlagException

# other imports
import pccache

__version__ = "1.5"

PD_Okay  = "PD_Okay"                    # JM 960830

intSybFailFrac = 100      # one out of this number of sybase connect
fails will$

def pd_return(msg=''):
    raise PD_Okay, msg


def get_func(dict, name):
    if dict.has_key(name):
        cb = dict[name]
        if `type(cb)` == "<type 'function'>":
            return cb
    return None


class SmartPrint:
    def __init__(self, real_stdout, headers=''):
        self.need_headers = 1
        self.headers = headers
        self.real_stdout = real_stdout

##     def write(self, msg):
##      if self.need_headers:
##          try:
##              self.real_stdout.write(self.headers.show() + '\n')
##          except AttributeError:              ## XXXX
##              self.real_stdout.write(self.headers)

##      self.real_stdout.write(msg)
##      self.need_headers = 0



# JM 960517
#
#
def get_hostip(environ):
    try:
        return 'IP:' + environ['REMOTE_ADDR']
    except KeyError:
        return  'IP:unknown'                    # XX ugh

def dump(environ=None):
    if not environ:
        from os import environ

    list = environ.keys()
    list.sort()

    for k in list:
        print "<b>%s</b> %s<BR>" % (k, environ[k])

# JM 960708
# use the cookie class to get the session ID, or return ''
#

def get_sessionid(cookiedict):
    if cookiedict.has_key('ngs_sessionID'):
        #
        # Netsite: NGS session-id stuff installed
        #
        return cookiedict['ngs_sessionID'][:12]

    elif cookiedict.has_key('Apache'):
        #
        # Apache: mod_cookie installed + enabled
        #
        return cookiedict['Apache']

    else:
        #
        # no session-id thing
        #
        return ''


### if session ID not given,
### use client's IP address (XX debugging only!)
### JM 960517
##    if environ.has_key('HTTP_COOKIE'):
##      s = environ['HTTP_COOKIE'] # like "ngs_sessionID=23233885"
##
##      if 'ngs_sessionID=' == s[:14]:
##          s = s[14:14+12]
##      else:
##          s = get_hostip(environ)     # XX no session id: error here?
##
##    else:
##      # dump(environ)
##      s = get_hostip(environ)         # XX no session id: error here?
##
##    return s


def file_exists(path):
    try:
        open(path).close()
        return 1
    except IOError:
        return 0
# Figure out a few things about what will happen, and put
# a few extra things in the Python search path.
#
# - take the original PD script path (ie:
'/www/test/htdocs/Tests/if.pd')
#   (usually from the webserver's PATH_TRANSLATED variable).
#
# - turn it into the Python script path ('/www/test/htdocs/Tests/if.py')
#   and then containing directory ('/www/test/htdocs/Tests/').
#
# - insert the PD directory in sys.path, so that PD support files
#   (like 'cookie' and 'agent') will be found, and wont be overridden
#   by user app files.
#
# - chdir to the user's script directory, so that app-local files
#   can be found (sys.path contains '.') and written files will
#   be relative to the script.
#

def script_setup(path):

    import os, sys, string

    if os.path.isdir(path):
        if path[-1]!='/': path=path+'/'
        path=path+'index.pd'

    # replaced following line with a substitution to stop pydriver from
    # displaying the py code when the URL has a .py.  Set it back to .pd
    # -MC 8/6/99
    if path[-3:] == ".py":
       path = path[:-3] + ".pd"
       if os.environ.has_key('PATH_TRANSLATED'):
          os.environ['PATH_TRANSLATED'] = path

    templatepath = path
    scriptpath = path[:-2] + "py"
    scriptdir  = path[:string.rfind(path, '/')]
    pc_path    = path[:-2] + "pc"

    # make sure the PythonDriver dir is first on the path.
    # (1st, else 'cookie.py' was being overridden)
    # JM 961006
    # commented out. py-driver now puts this at front of path.
    # Mark Cain
    #sys.path.insert(0, os.getcwd())

    # raise KeyError, "vars=" + `locals()`

    sys.path.append(scriptdir)
    os.chdir(scriptdir)                 # JM 960827

    return (templatepath, scriptpath, pc_path, scriptdir)


# allow project information to be overridden by the user,
# either by 'project.py' in the script directory,
# or in the one just above (XX provide search-path?)
#

def import_project(pathlist=['.'], modnamelist=['project']):
    from uniondict import UnionDict

    info     = UnionDict()                      # union of all info
dicts
    project  = UnionDict()                      # union of *modules*
    mod_dict = {}                               # temporary variable
scope

    for file in modnamelist:

        # load the module
        #
        exec   "import "+file in mod_dict
        module = mod_dict[file]

        # add the module to the UnionDict,
        # so that its functions *override* earlier ones
        #
        project.prepend(module.__dict__)

        # add the 'info' dictionaries
        # so that just-loaded defs *override* earlier ones
        #
        if module.__dict__.has_key('info'):
            info.prepend(module.__dict__['info'])

    project.info = info
    return project


def html_print_techproblems():
#    print "Location: http://162.133.26.95/goo.po"
#    print "Content-length: 1"
#    print "\n\n"
#    import traceback
#    html_print_exc(traceback)
    try:
      import socket
      filNF = open('/disk2/flags/techproblems.html', 'r')
      print filNF.read() % socket.gethostname()
      filNF.close()
    except:
      print """
           <table><tr>
           <td align="center" width="312">
           <img src="/images/banner.gif" width=312 height=45 border=0
alt="" al$
           </td></tr></table>
            """
      print "<br><font size=+3><b>We're sorry.</b>"
      print "<p>We are repairing a technical problem. We apol$

def html_print_notfound(message=''):
    print "Content-type: text/html\n\n"
    try:
      filNF = open('/disk2/flags/notfound.html', 'r')
      print filNF.read()
      filNF.close()
      filNF.close()
    except:
      print """
           <table><tr>
           <td align="center" width="312">
           <img src="/images/banner.gif" width=312 height=45 border=0
alt="" al$
           </td></tr></table>
            """
      print "<br><font size=+3><b>Not Found</b></font>"
      print "<p>The requested file does not exist on our website."

def html_print_exc(traceback):
    import sys

    print "Content-type: text/html\n"
    print "<font size=+3><b>internal error</b></font><P><PRE>",
    traceback.print_exc(file=sys.stdout)
    print "</PRE>"
def cgi_main():
    import os, traceback

    if not os.environ.has_key('PATH_TRANSLATED'):
        print "Content-type: text/html\n"
        print "PATH_TRANSLATED not given"
        return

    try:
        main(os.environ['PATH_TRANSLATED'], os.environ)

    except IOError, msg:
        html_print_notfound(msg)
        print "<!--"
        html_print_exc(traceback)
        print "-->"
    except:
        html_print_techproblems()
        print "<!--"
        html_print_exc(traceback)
        print "-->"


def updatePC(pd_path, py_path, pc_path):
  import os, codetemplate, time
  dicPC = {}

  # get stats on files
  try:
    tupPD = os.stat(pd_path)
    tupPY = os.stat(py_path)
    try:
    try:
      tupPC = os.stat(pc_path)
    except:
      tupPC = None
  except:
    raise IOError, "not found"

  try:
    # if pc file doesn't exist, or is older than either of the others,
then rec$
    if (not tupPC or (tupPD[-2] > tupPC[-2]) or (tupPY[-2] >
tupPC[-2])):
      pd_script = codetemplate.PD_Script(pd_path)
      codPD = pd_script.code
      dicPdVars = pd_script.dicPdVars
      filTemp = open(py_path)
      codPY = compile(filTemp.read(), py_path, "exec")
      filTemp.close()
      dicPC = { 'py': codPY,
                'pd': codPD,
                'dicPdVars': dicPdVars,
                'pyDate': time.asctime(time.localtime(tupPY[-2])),
                'pdDate': time.asctime(time.localtime(tupPD[-2])),
                'pcDate': time.asctime(time.localtime(time.time()))
              }
      import marshal
      try:
        filPC = open(pc_path, 'w')
        marshal.dump(dicPC, filPC)
        filPC.close()
      except IOError:
        return
  except:
      #
      # since this function runs outside of normal execution (as in
production)
      # we add traceback error handling here. Else errors don't
propigate on th$
      # normal route, having failed at this early point.
      #
      import sys, traceback
      pd_except(py_path, sys.exc_type, sys.exc_value,
                        tb=traceback, globals=globals())
      #
      # Furthermore, no headers have been printed yet and "main"
execution is b$
      # We need the basic header printed here.
      #
      #print "Content-type: text/html\n\n"
      #
      # Stop further execution by raising an error. Brings us back to
cgi-main $
      # screen
      #
      raise "Failed"


def main(templatepath, environ=None):

    import sys, string, cgi, os, traceback, ctsybase

    dicPC = {}        # dictionary containing pd and py code objects
    blnInterpSrc = 0
    blnTechProb  = 0   # to note problem deserving of "tech problem"
message

    if not environ:
        environ=os.environ

    (pd_path, py_path, pc_path, scriptdir) = script_setup( templatepath
)

    if ((len (pd_path) > 13) and (pd_path[-13:] == "html/index.pd")):
        import posixpath
        HOMEFILE = '/disk2/flags/homelive.html'
        if posixpath.exists(HOMEFILE) == 0:
            import homedown
            print homedown.pageVar
            return

    import marshal, codetemplate, agent


    # get the 'project' module, but allow
    # it to be overidden (unlike all other modules. Ex: cookies.py)
    #
    project = import_project(scriptdir)

    from headers import Headers

    # ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    # run-time stuff
    # ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    finished   = 0
    headers    = Headers(environ)
    # print "info = " + `project.info`
    if project.info.has_key('cookie_domain'):
        headers.cookieSetDomain(project.info['cookie_domain'])

    session_id = get_sessionid(headers.cookie)


    # grab form variables
    #
    try:
        #          Old and outdated
        if not os.environ.has_key('QUERY_STRING'):
           os.environ['QUERY_STRING'] = ""
        webvars = cgi.SvFormContentDict(environ=os.environ)
        #webvars.__init__(os.environ)
        #webvars = cgi.FieldStorage()
    except:
        webvars = {}


    # grab Python global variables
    # XXX?
    script_dict = globals()

    # rename a few variables
    #

    # XX
    sp = SmartPrint(sys.stdout, headers)


    script_dict.update({
             'environ'    : environ,
             'session_id' : session_id,
             'webvars'    : webvars,
             'headers'    : headers,
             'scriptpath' : py_path,
             'project'    : project,
             'agent'      : agent.open(environ)
             })

    for k in ['dbopen', 'pd_except']:
        if project.has_key(k):
            script_dict[k] = project[k]

    # XX removed 961006 JM
    # 'agent'      : agent.open(environ),
    # 'advert'     : Advert(),
    # merge globals and other vars into one dictionary
    #
    #for k in dict2.keys():
#       script_dict[k] = dict2[k]
#
#    del dict2                          # dont need it anymore


    # try to execute the Python script.
    #

    # call updatePC to compile pd and py file and write to pc file
    # (do not call in production)
    #updatePC(pd_path, py_path, pc_path)

    try:
      if (sys.modules.has_key('pccache')):
        pccache = sys.modules['pccache']
        dicPC = pccache.load(pc_path)
      else:
        filPC = open(pc_path, 'r')
        dicPC = marshal.load(filPC)
        filPC.close()

    except IOError:
      pd_script = codetemplate.PD_Script(pd_path)
      blnInterpSrc = 1   # was unable to open compiled. Must interp.
    else:
      # load successful
      # create "empty" PD_Script object and set its code object (no
processing $
      pd_script = codetemplate.PD_Script()
      pd_script.code = dicPC['pd']
      if dicPC.has_key('dicPdVars'):
        pd_script.dicPdVars = dicPC['dicPdVars']
    script_dict['dicPdVars'] = pd_script.dicPdVars

    try:
      try:
          try:
            import pycodewrap
            pycodewrap.begin(script_dict)
          except BOPageFlagException, objException:
            raise objException
          except:
            pass
          if (blnInterpSrc):
            f = open(py_path)
            exec f in script_dict  # old
            f.close()
          else:
            exec (dicPC['py'] , script_dict) # new
          try:
            pycodewrap.end(script_dict)
          except:
            pass

      except PD_Okay, msg:
          # XX print msg somewhere?
          pass

      # catch and ignore broken pipe errors
      except IOError, lstErr:
        if lstErr[1] == 'Broken pipe':
          pass
        else:
          raise lstErr
      except ctsybase.error, lstErr:
        if lstErr[0] == 'failed to connect to server':
          blnTechProb = 1
          import time
          fltTime = time.time()
          intTemp = int (( int(fltTime) + ((fltTime - int(fltTime)) *
10000)) %$
          if intTemp == 0:
            raise ctsybase.error + ": " + str(lstErr)
          else:
            pass
            #raise "sybase error"

      # catch BOPageFlagException to throw up alternate page
      except BOPageFlagException, objException:
          blnTechProb = 0
          finished = 1                # XX run PD script after error
          if sp.need_headers:

              # was >> print "Content-type: text/html\n"

              try:
                  print script_dict['headers'].show()
              except AttributeError:
                  print script_dict['headers']

          # headers were printed -- turn them off
          #
          sp.need_headers = 0

          try:
            filT = open(objException.strFile, 'r')
            strText = filT.read()
            filT.close()
         except IOError:
            objT = IOError("BOPageFlagException, can't open file '%s'" %
objExc$
            raise objT
          if objException.dicVariables:
            strText = strText % objException.dicVariables
          print strText

          # if objException.blnTraceback is true, then do the traceback
anyhow
          if objException.blnTraceback:
            # does PY script have a custom exception handler?
            # if so, use it; else use default: 'pd_except'.
            #
            cb = get_func(script_dict, '__except__')
            if not cb:
                cb = pd_except

            finished = not cb(py_path, sys.exc_type, sys.exc_value,
                              tb=traceback, globals=globals())
    # catch all for tracebacks
    except:
        blnTechProb = 1
        finished = 0                # XX run PD script after error

        if sp.need_headers:

            # was >> print "Content-type: text/html\n"

            try:
                print script_dict['headers'].show()
            except AttributeError:
                print script_dict['headers']

        # headers were printed -- turn them off
        #
        sp.need_headers = 0

        # does PY script have a custom exception handler?
        # if so, use it; else use default: 'pd_except'.
        #
        cb = get_func(script_dict, '__except__')
        if not cb:
            cb = pd_except

        finished = not cb(py_path, sys.exc_type, sys.exc_value,
                          tb=traceback, globals=globals())


    #f.close()


    # did the PY script take care of everything? (IE: file download,
    # exception handler doesnt want to show PD).
    # If so, then just return -- *dont* execute PD script.
    # JM 960829

    if blnTechProb:
       if sp.need_headers:
           # was >> print "Content-type: text/html\n"
           try:
               print script_dict['headers'].show()
           except AttributeError:
               print script_dict['headers']
       html_print_techproblems()
       print "<!-- "
       html_print_exc(traceback)
       print "--> "
       return
    if finished or script_dict['headers'].finished():
        return


    # go ahead and print out HTTP headers now.
    # if its whacked, just default it:
    #
    if sp.need_headers:
        try:
            print script_dict['headers'].show()
            #print ' *** ' + dict['headers'].show() + ' *** '
        except AttributeError:
            print script_dict['headers']

    try:
      print pd_script.run(script_dict)
    # catch and ignore broken pipe errors
    except IOError, lstErr:
      if lstErr[1] == 'Broken pipe':
        pass
      else:
        raise lstErr

    except:
      import sys, traceback
      pd_except(py_path, sys.exc_type, sys.exc_value,
                        tb=traceback, globals=globals())
      html_print_techproblems()
      print "<!-- "
      html_print_exc(traceback)
      print "--> "

    return
def topmain():
    import os, sys, posixpath

    SFILE = '/disk2/flags/dblive.html'
    error = ""
    if posixpath.exists(SFILE) == 0:
        import dbdown
        pageVar = dbdown.pageVar
        error = "DBBAD"

    if error:
        print pageVar
    elif os.environ.has_key('PATH_TRANSLATED'):
        import traceback
        try:
            cgi_main()
        except:
            print "<font size=+1>%s: problems</font><P>" %
"PythonDriver"

            print "<PRE>",
            traceback.print_exc()
            print "</PRE>"

    elif len(sys.argv) > 1:

        import string

        scriptpath = sys.argv[1]

        os.environ['REQUEST_METHOD'] = 'GET'
        os.environ['QUERY_STRING']   = string.joinfields( sys.argv[2:],
'&' )

        main(scriptpath, os.environ)
    else:

        print "usage: py-driver <script> [GET-style args...]"

if __name__=="__main__":
    main()


Any help would be GREATLY appreciated. I just need to mimic the netscape
behavior within apache, and i am having problems doing so. Maybe
mod_python isnt the way to go, but if anyone has any ideas for me to
try, i would be extremely greatful

Michael Weiner
Systems Administrator/Partner
The UserFriendly Network
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/x-pkcs7-signature
Size: 2626 bytes
Desc: S/MIME Cryptographic Signature
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20010118/51182ff7/smime-0002.bin
From GManoj at chn.cognizant.com  Thu Jan 18 20:14:53 2001
From: GManoj at chn.cognizant.com (Govindan, Manoj (CTS))
Date: Fri Jan  9 21:58:46 2004
Subject: [mod_python] Need help: Apache, Win NT and Dr Watson error
Message-ID: <697D1663ABD6D1119D880060B0B5456302B78683@ctsinwcbsxua>

> Hi,
> I need help for the following topic.
> I am using Apache 1.3.9 with mod_python 2.7.
> While running a DB accessing script with apache, Win NT *sometimes*
> reporting Dr. Watson error for apache.
> This does not happen always.
> I have set two directories as follows in the config file
> <Directory "f:/site/html/python">
>    AddHandler python-program .py           
>    PythonHandler feedback
>    PythonDebug on
> </Directory>
> 
> <Directory "f:/site/html/test">
>    AddHandler python-program .py           
>    PythonHandler guestbook::gbook
>    PythonDebug on
> </Directory>
> 
> The error comes occasionally for both the scripts.
> 
> Thanks
> Manoj
> 
> 

This e-mail and any files transmitted with it are for the sole use of the intended recipient(s) and may contain confidential and privileged information.
If you are not the intended recipient, please contact the sender by reply e-mail and destroy all copies of the original message. 
Any unauthorised review, use, disclosure, dissemination, forwarding, printing or copying of this email or any action taken in reliance on this e-mail is strictly 
prohibited and may be unlawful.

		Visit us at http://www.cognizant.com


From Stephane.Bidoul at softwareag.com  Thu Jan 18 17:30:29 2001
From: Stephane.Bidoul at softwareag.com (Bidoul, Stephane)
Date: Fri Jan  9 21:58:46 2004
Subject: [mod_python] Need help: Apache, Win NT and Dr Watson error
Message-ID: <C23163F98473D311874C0008C7E621070499C14E@daemsg02.software-ag.de>

mod_python on NT is multithreaded.
A problem might be that some global data
in your script is not protected by a mutex,
and is accessed by concurrent requests.

This is only a wild guess however: you will need to 
provide more details about your scripts if
you need more help.

Best regards.

-Stephane

> -----Original Message-----
> From: Govindan, Manoj (CTS) [mailto:GManoj@chn.cognizant.com]
> Sent: 18 January, 2001 15:45
> To: 'mod_python@modpython.org'
> Subject: [mod_python] Need help: Apache, Win NT and Dr Watson error
> 
> 
> > Hi,
> > I need help for the following topic.
> > I am using Apache 1.3.9 with mod_python 2.7.
> > While running a DB accessing script with apache, Win NT *sometimes*
> > reporting Dr. Watson error for apache.
> > This does not happen always.
> > I have set two directories as follows in the config file
> > <Directory "f:/site/html/python">
> >    AddHandler python-program .py           
> >    PythonHandler feedback
> >    PythonDebug on
> > </Directory>
> > 
> > <Directory "f:/site/html/test">
> >    AddHandler python-program .py           
> >    PythonHandler guestbook::gbook
> >    PythonDebug on
> > </Directory>
> > 
> > The error comes occasionally for both the scripts.
> > 
> > Thanks
> > Manoj
> > 
> > 
> 
> This e-mail and any files transmitted with it are for the 
> sole use of the intended recipient(s) and may contain 
> confidential and privileged information.
> If you are not the intended recipient, please contact the 
> sender by reply e-mail and destroy all copies of the original 
> message. 
> Any unauthorised review, use, disclosure, dissemination, 
> forwarding, printing or copying of this email or any action 
> taken in reliance on this e-mail is strictly 
> prohibited and may be unlawful.
> 
> 		Visit us at http://www.cognizant.com
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 

From grisha at ispol.com  Thu Jan 18 14:17:07 2001
From: grisha at ispol.com (Gregory Trubetskoy)
Date: Fri Jan  9 21:58:46 2004
Subject: [mod_python] Need help: Apache, Win NT and Dr Watson error
In-Reply-To: <697D1663ABD6D1119D880060B0B5456302B78683@ctsinwcbsxua>
Message-ID: <Pine.LNX.4.21.0101181416100.7384-100000@saturn.ispol.com>

You don't specify which database yu're using, but some Windows database
ODBC drivers are not thread safe and can crash when used with
multithreaded applications like apache.


On Thu, 18 Jan 2001, Govindan, Manoj (CTS) wrote:

> > Hi,
> > I need help for the following topic.
> > I am using Apache 1.3.9 with mod_python 2.7.
> > While running a DB accessing script with apache, Win NT *sometimes*
> > reporting Dr. Watson error for apache.
> > This does not happen always.
> > I have set two directories as follows in the config file
> > <Directory "f:/site/html/python">
> >    AddHandler python-program .py           
> >    PythonHandler feedback
> >    PythonDebug on
> > </Directory>
> > 
> > <Directory "f:/site/html/test">
> >    AddHandler python-program .py           
> >    PythonHandler guestbook::gbook
> >    PythonDebug on
> > </Directory>
> > 
> > The error comes occasionally for both the scripts.
> > 
> > Thanks
> > Manoj
> > 
> > 
> 
> This e-mail and any files transmitted with it are for the sole use of the intended recipient(s) and may contain confidential and privileged information.
> If you are not the intended recipient, please contact the sender by reply e-mail and destroy all copies of the original message. 
> Any unauthorised review, use, disclosure, dissemination, forwarding, printing or copying of this email or any action taken in reliance on this e-mail is strictly 
> prohibited and may be unlawful.
> 
> 		Visit us at http://www.cognizant.com
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From klindsay at mkintraweb.com  Thu Jan 18 18:38:36 2001
From: klindsay at mkintraweb.com (Kevin Lindsay)
Date: Fri Jan  9 21:58:46 2004
Subject: [mod_python] Exiting gracefully...
Message-ID: <20010118183836.D22268@mkintraweb.com>

How does one exit from a script called from mod_python?

As an example, I am in the middle of a function and I want
to call an error function and have the script stop as if it
had returned from the handler function wth 'return apache.OK'

I can't seem to find anything in the docs, unless I'm 
missing something.

Any help is appreciated. :)

------------------------------------------------
Kevin Lindsay <klindsay@debian.org>
Debian Developer
81E 58A3 B49A 580E EE3D 8CF0 519A 55F0 746C 51F4

From klindsay at mkintraweb.com  Thu Jan 18 19:16:17 2001
From: klindsay at mkintraweb.com (Kevin Lindsay)
Date: Fri Jan  9 21:58:46 2004
Subject: [mod_python] Reload strangeness
Message-ID: <20010118191617.A24258@mkintraweb.com>

I'm just curious if there is any known reason why when I hit the
reload button in netscape it sometimes loads my script and other
times, without changing any code I get this:

Mod_python error: "PythonHandler gr_main" Traceback (most recent 
call last): File "/usr/lib/python2.0/site-packages/mod_python/apache.py",
line 180, in Dispatch object = resolve_object(self.req, module, object_str,
silent) File "/usr/lib/python2.0/site-packages/mod_python/apache.py", line
396,in resolve_object raise AttributeError, s AttributeError: module 
'/var/www/geekreview/new2/gr_main.py' contains no 'handler' [an error 
occurred while processing this directive]

-----------------------------------------------------------------------
 Kevin Lindsay                  | "Storm Linux, Taking Linux by Storm!"
 Stormix Technologies Inc.      | http://www.stormix.com/
 Chief Technology Officer (CTO) | 
-----------------------------------------------------------------------

From grisha at ispol.com  Thu Jan 18 22:48:25 2001
From: grisha at ispol.com (Gregory Trubetskoy)
Date: Fri Jan  9 21:58:46 2004
Subject: [mod_python] Exiting gracefully...
In-Reply-To: <20010118183836.D22268@mkintraweb.com>
Message-ID: <Pine.LNX.4.21.0101182247000.8591-100000@saturn.ispol.com>

You can always raise an error if you need to exit immeditely:

raise apache.SERVER_ERROR, apache.HTTP_FORBIDDEN

or something like that.

--
  Gregory (Grisha) Trubetskoy
       grisha@ispol.com

On Thu, 18 Jan 2001, Kevin Lindsay wrote:

> How does one exit from a script called from mod_python?
> 
> As an example, I am in the middle of a function and I want
> to call an error function and have the script stop as if it
> had returned from the handler function wth 'return apache.OK'
> 
> I can't seem to find anything in the docs, unless I'm 
> missing something.
> 
> Any help is appreciated. :)
> 
> ------------------------------------------------
> Kevin Lindsay <klindsay@debian.org>
> Debian Developer
> 81E 58A3 B49A 580E EE3D 8CF0 519A 55F0 746C 51F4
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From grisha at ispol.com  Thu Jan 18 22:51:35 2001
From: grisha at ispol.com (Gregory Trubetskoy)
Date: Fri Jan  9 21:58:46 2004
Subject: [mod_python] Reload strangeness
In-Reply-To: <20010118191617.A24258@mkintraweb.com>
Message-ID: <Pine.LNX.4.21.0101182248290.8591-100000@saturn.ispol.com>

It means that '/var/www/geekreview/new2/gr_main.py' contains no function
called handler.

But sometimes in rare cases when you do a lot of editing/development and
config changes, the Python interpreters in some apache processes may end
up being a bit confused as to what's going on, so you just have to restart
apache.

--
  Gregory (Grisha) Trubetskoy
       grisha@ispol.com

On Thu, 18 Jan 2001, Kevin Lindsay wrote:

> I'm just curious if there is any known reason why when I hit the
> reload button in netscape it sometimes loads my script and other
> times, without changing any code I get this:
> 
> Mod_python error: "PythonHandler gr_main" Traceback (most recent 
> call last): File "/usr/lib/python2.0/site-packages/mod_python/apache.py",
> line 180, in Dispatch object = resolve_object(self.req, module, object_str,
> silent) File "/usr/lib/python2.0/site-packages/mod_python/apache.py", line
> 396,in resolve_object raise AttributeError, s AttributeError: module 
> '/var/www/geekreview/new2/gr_main.py' contains no 'handler' [an error 
> occurred while processing this directive]
> 
> -----------------------------------------------------------------------
>  Kevin Lindsay                  | "Storm Linux, Taking Linux by Storm!"
>  Stormix Technologies Inc.      | http://www.stormix.com/
>  Chief Technology Officer (CTO) | 
> -----------------------------------------------------------------------
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From gerhard at bigfoot.de  Fri Jan 19 08:04:49 2001
From: gerhard at bigfoot.de (Gerhard =?iso-8859-1?Q?H=E4ring?=)
Date: Fri Jan  9 21:58:46 2004
Subject: [mod_python] Need help: Apache, Win NT and Dr Watson error
References: <697D1663ABD6D1119D880060B0B5456302B78683@ctsinwcbsxua>
Message-ID: <3A67E711.93531CC5@bigfoot.de>

I would upgrade to Apache 1.3.14. This solved a thread-related problem
for me.

Gerhard

"Govindan, Manoj (CTS)" wrote:
> 
> > Hi,
> > I need help for the following topic.
> > I am using Apache 1.3.9 with mod_python 2.7.
> > While running a DB accessing script with apache, Win NT *sometimes*
> > reporting Dr. Watson error for apache.
> > This does not happen always.
> > I have set two directories as follows in the config file
> > <Directory "f:/site/html/python">
> >    AddHandler python-program .py
> >    PythonHandler feedback
> >    PythonDebug on
> > </Directory>
> >
> > <Directory "f:/site/html/test">
> >    AddHandler python-program .py
> >    PythonHandler guestbook::gbook
> >    PythonDebug on
> > </Directory>
> >
> > The error comes occasionally for both the scripts.

-- 
contact: g e r h a r d @ b i g f o o t . d e
web:     http://highqualdev.com

From jym_brittain at hotmail.com  Fri Jan 19 17:11:18 2001
From: jym_brittain at hotmail.com (James Brittain)
Date: Fri Jan  9 21:58:46 2004
Subject: [mod_python] compiling problems
Message-ID: <LAW2-F1308k69RKLpgT00002acc@hotmail.com>

Does anyone have any experience compiling mod_python in SuSE 7.0? I'm 
getting some strange errors
_________________________________________________________________
Get your FREE download of MSN Explorer at http://explorer.msn.com


From klindsay at mkintraweb.com  Fri Jan 19 13:27:00 2001
From: klindsay at mkintraweb.com (Kevin Lindsay)
Date: Fri Jan  9 21:58:46 2004
Subject: [mod_python] EAPI
Message-ID: <20010119132700.I24258@mkintraweb.com>

Apache 1.3.14 in Debian (unstable) required EAPI to be compiled into
its DSO modules.  There is nothing in the mod python docs regarding
EAPI. Will this affect anything? Doesn't seem to be.

BTW, I will be packaging modpython and maintaining it for Debian. :)

------------------------------------------------
Kevin Lindsay <klindsay@debian.org>
Debian Developer
81E 58A3 B49A 580E EE3D 8CF0 519A 55F0 746C 51F4


From msandin at hotmail.com  Mon Jan 22 09:45:02 2001
From: msandin at hotmail.com (Martin Sandin)
Date: Fri Jan  9 21:58:46 2004
Subject: [mod_python] mod_python on Win98
Message-ID: <F149y3rB07XOq3JkrKd000058a8@hotmail.com>

Hello!

I'll renew my request for help with this mail. I hope I'm no rude, but I'd 
really like to evaluate the possibility of using Apache/mod_python for 
running parts of a system the company I work at use.

When I add mod_python.dll (for Python 2.0) to the modules/ directory in 
apache, and have the Python20 directory in the PATH env variable, and add a 
LoadModule directive to Apache's httpd.conf with no other mod_python 
references I get the following error on startup of Apache:

"'import site' failed; use -v for traceback"


When configuring apache as suggested in the mp docs I also get the following 
in errors.log when trying to access that URL:

"python_handler: make_obcallback returned no obCallBack!"


Have the exact same behavior on two separate Win98 machines, with the latest 
versions of Apache 1.3 and mod_python. Is there any help available or should 
I just give up on using mod_python? =(


-
Martin
come.to/vague
_________________________________________________________________________
Get Your Private, Free E-mail from MSN Hotmail at http://www.hotmail.com.


From davidc at downright.com  Mon Jan 22 10:19:31 2001
From: davidc at downright.com (David Cohen)
Date: Fri Jan  9 21:58:46 2004
Subject: [mod_python] Installing on RH7.0
Message-ID: <NCBBLAIKFCKAJGLOGAHPGEAGCKAA.davidc@downright.com>

After a long, long weekend, I've crashed and burned attempting to install mod_python on RH7.0 (with all RHN updates).

The RPM install failed by rendering httpd unstartable (instant death with no apparent reason). Commenting out the LoadModule and AddModule lines for mod_python gets httpd working again in its original state).

Has anyone successfully installed via the RPM? Furthermore, can this RPM be used with python 2.0 (my desired platform)?

If not successful with RPM, has anyone successfully installed from source on RH7.0 w/python 2.0?

Thanks!

David Cohen
VP/CTO
Downright Software LLC
18227-D Flower Hill Way, Gaithersburg, MD 20879
voice: 301.948.4030

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010122/adff5a30/attachment-0002.htm
From mike at mikebell.org  Mon Jan 22 16:16:41 2001
From: mike at mikebell.org (Mike Bell)
Date: Fri Jan  9 21:58:46 2004
Subject: [mod_python] Large req.writes prevent header from being outputted?
Message-ID: <20010122161641.E550@vaio.mikebell.org>

With my installation (mod_python 2.7.1 w/python 2.0), doing

  req.content_type = DetermineMimeType(filepath)
  req.send_http_header()
  myjpeg = open(filepath)
  req.write(myjpeg.read())

with a very large image (appears to be around 1/4MB) will result in an HTTP
transaction where no headers are outputted, just binary data. However,
something like

  req.content_type = DetermineMimeType(filepath)
  req.send_http_header()
  myjpeg = open(filepath)
  while 1:
    temp = myjpeg.read(65535)
    if temp == "":
      break
    req.write(temp)

will work just fine.

Presumably req.write should work for these large values, or at least raise
an exception rather than dropping data.

From sandor at cs.uu.nl  Tue Jan 23 12:27:41 2001
From: sandor at cs.uu.nl (Sandor Spruit)
Date: Fri Jan  9 21:58:46 2004
Subject: [mod_python] One question before I start experimenting with mod_python
Message-ID: <18519.010123@cs.uu.nl>

[Please note: I'm not a regular reader of this list. Please be so kind
to send any replies directly to me; I'll summarize to the list]

Hello list members,

I've just got one question: "do Python programs need to be
specifically tailored for use with mod_python, or should Python
CGI programs be able to run unmodified ?"

My guess is, that I need some sort of a "connector" to convert the
regular CGI parameters into Python interpreter parameters, and start
the interpreter on the appropriate script. I'd have to rewrite that
connector to make use of the mod_python facilities. Any additional
pitfalls that I don't see yet ?

TIA,
Sandor
-- 
ir A.G.L. Spruit, Utrecht University, the Netherlands
Institute of information and computing sciences
"There is a bit of magic in everything, and then some
loss to even things out" (from: Lou Reed, "Magic and Loss")



From grisha at ispol.com  Tue Jan 23 22:45:46 2001
From: grisha at ispol.com (Gregory Trubetskoy)
Date: Fri Jan  9 21:58:46 2004
Subject: [mod_python] Large req.writes prevent header from being outputted?
In-Reply-To: <20010122161641.E550@vaio.mikebell.org>
Message-ID: <Pine.LNX.4.21.0101232242260.3867-100000@saturn.ispol.com>

Mike - 

I'm not able to reproduce this. I just tried something similar with an 8Mb
file, and I get all the headers and data correctly.

Anyone else seeing this behaviour?

Could the problem be something with your client? I used wget -S to test my
results.

--
  Gregory (Grisha) Trubetskoy
       grisha@ispol.com

On Mon, 22 Jan 2001, Mike Bell wrote:

> With my installation (mod_python 2.7.1 w/python 2.0), doing
> 
>   req.content_type = DetermineMimeType(filepath)
>   req.send_http_header()
>   myjpeg = open(filepath)
>   req.write(myjpeg.read())
> 
> with a very large image (appears to be around 1/4MB) will result in an HTTP
> transaction where no headers are outputted, just binary data. However,
> something like
> 
>   req.content_type = DetermineMimeType(filepath)
>   req.send_http_header()
>   myjpeg = open(filepath)
>   while 1:
>     temp = myjpeg.read(65535)
>     if temp == "":
>       break
>     req.write(temp)
> 
> will work just fine.
> 
> Presumably req.write should work for these large values, or at least raise
> an exception rather than dropping data.
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From mike at mikebell.org  Tue Jan 23 20:56:14 2001
From: mike at mikebell.org (Mike Bell)
Date: Fri Jan  9 21:58:46 2004
Subject: [mod_python] Large req.writes prevent header from being outputted?
In-Reply-To: <Pine.LNX.4.21.0101232242260.3867-100000@saturn.ispol.com>; from grisha@ispol.com on Tue, Jan 23, 2001 at 10:45:46PM -0500
References: <20010122161641.E550@vaio.mikebell.org> <Pine.LNX.4.21.0101232242260.3867-100000@saturn.ispol.com>
Message-ID: <20010123205613.B9591@vaio.mikebell.org>

On Tue, Jan 23, 2001 at 10:45:46PM -0500, Gregory Trubetskoy wrote:
> 
> Mike - 
> 
> I'm not able to reproduce this. I just tried something similar with an 8Mb
> file, and I get all the headers and data correctly.

How odd...

> Could the problem be something with your client? I used wget -S to test my
> results.

I used telnet.


From afaby at mail.tenon.com  Thu Jan 25 14:26:35 2001
From: afaby at mail.tenon.com (Aaron Faby)
Date: Fri Jan  9 21:58:46 2004
Subject: [mod_python] mod_python + mod_php4 on Mac OS X w/ apache 1.3.14: no workie!
Message-ID: <ALS.HGW@tenon.com>

I get the following error when attempting to start apache 1.3.14 w/ 
mod_php4 and mod_python
on Mac OS X Public Beta:

dyld: /usr/sbin/apache multiple definitions of symbol _pcre_free
/System/Library/Apache/Modules/mod_python.so definition of _pcre_free
/System/Library/Apache/Modules/libphp4.so definition of _pcre_free

Any ideas?

--------------------------------------------------------------------------------------------------
Aaron Faby					                             Software Developer
Tenon Intersystems			         	                                
afaby@tenon.com
1123 Chapala Street			                                       
805-963-6983
Santa Barbara, CA 93103                                             
http://www.tenon.com
--------------------------------------------------------------------------------------------------

From ioseph at paolo.net  Sat Jan 27 06:40:03 2001
From: ioseph at paolo.net (Ioseph Kim)
Date: Fri Jan  9 21:58:46 2004
Subject: [mod_python] How use redirection in cgihandler?
Message-ID: <20010127064003.A4017@paolo.net>

Apache : 1.3.14
Python : 2.0
mod_python : 2.7.1

I maked a simple script a.py

print 'Location: /\n'

-------

but, this script did not work. -.-

> telnet localhost 80
Trying 127.0.0.1...
Connected to localhost.paolo.net.
Escape character is '^]'.
GET /~ioseph/python/a.py HTTP/1.0

HTTP/1.1 200 OK
Date: Fri, 26 Jan 2001 21:36:07 GMT
Server: Apache/1.3.14 (Unix) mod_python/2.7.1 Python/2.0
Location: /
Connection: close
Content-Type: text/plain

Connection closed by foreign host.

--------
in this case, HTTP Status code is 200. 

to url redirect, web server might to return http status code 302.

How I can use "Location:" header in cgihandler?


From john at coastalgeology.org  Sat Jan 27 10:24:05 2001
From: john at coastalgeology.org (Jonathan Pennington)
Date: Fri Jan  9 21:58:46 2004
Subject: [mod_python] Example sites
Message-ID: <20010127102405.A80697@coastalgeology.org>

I am currently researching to re-program a database-driven site from
PHP/MySQL to Python/PostgreSQL. My problem is that, although I'm a
fairly competent Python programmer, I haven't done any mod_python or
python web work at all. I learn by example. I have the mod_python
manual, but does anyone have a code suite from a Python driven site
that I could see? It's always better for me to read code than to
figure out how to do something from scratch. Thanks.

-J
-- 
Jonathan Pennington		| http://coastalgeology.org
Site Manager			| Protection and stewardship
CoastalGeology.Org (CGO)	| through public education.
john@coastalgeology.org		| Join CGO, make a difference.

From oddmund.mogedal at accenture.com  Tue Jan 30 20:36:08 2001
From: oddmund.mogedal at accenture.com (oddmund.mogedal@accenture.com)
Date: Fri Jan  9 21:58:46 2004
Subject: [mod_python] Problem writing to file from handler
Message-ID: <OF8332020C.21CD26E6-ON062569E5.000D2901@accenture.com>

Hi,

I need to write to a file from within a script (called using publisher.py).
For some reason, I am not allowed to write to the file, even though it
exists and has write permission for everyone.
(Yes, it is a security risk, but not in the environment where I will use
it.)

I have tried the same thing using the cgi module, and then I am allowed to
write to the file.
Is there a difference in access rights to the file system between a script
called from mod_python and a script called using CGI?

Does anybody know what is causing this problem?

Using mod_python: DOES NOT WORK
    import getpass

    def omtest(req, username, file):
        myfile = open("testom", 'wb')
        myfile.write(file)
        myfile.close()
        return "%s\n%d\n%s\n" % (username, len(file), getpass.getuser())

Using cgi: WORKS OK
    #!/usr/local/bin/python2.0

    import getpass
    import sys
    import cgi

    myfile = open("testom", 'wb')
    form = cgi.FieldStorage()
    name = form["name"].value
    file = form["file"].value
    myfile.write(file)

    print "Content-Type: text/html"
    print
    print name
    print getpass.getuser()




Oddmund



This message is for the designated recipient only and may contain
privileged or confidential information.  If you have received it in error,
please notify the sender immediately and delete the original.  Any other
use of the email by you is prohibited.



From grisha at ispol.com  Tue Jan 30 22:08:13 2001
From: grisha at ispol.com (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:58:46 2004
Subject: [mod_python] Problem writing to file from handler
In-Reply-To: <OF8332020C.21CD26E6-ON062569E5.000D2901@accenture.com>
Message-ID: <Pine.BSF.4.21.0101302201010.14374-100000@localhost>

The difference is the current directory. CGI scripts are executed with the
directory where the script is located as current, with mod_python the
current directory is undefined. You need to specify full path to your file
when opening it.

Grisha

On Tue, 30 Jan 2001 oddmund.mogedal@accenture.com wrote:

> Hi,
> 
> I need to write to a file from within a script (called using publisher.py).
> For some reason, I am not allowed to write to the file, even though it
> exists and has write permission for everyone.
> (Yes, it is a security risk, but not in the environment where I will use
> it.)
> 
> I have tried the same thing using the cgi module, and then I am allowed to
> write to the file.
> Is there a difference in access rights to the file system between a script
> called from mod_python and a script called using CGI?
> 
> Does anybody know what is causing this problem?
> 
> Using mod_python: DOES NOT WORK
>     import getpass
> 
>     def omtest(req, username, file):
>         myfile = open("testom", 'wb')
>         myfile.write(file)
>         myfile.close()
>         return "%s\n%d\n%s\n" % (username, len(file), getpass.getuser())
> 
> Using cgi: WORKS OK
>     #!/usr/local/bin/python2.0
> 
>     import getpass
>     import sys
>     import cgi
> 
>     myfile = open("testom", 'wb')
>     form = cgi.FieldStorage()
>     name = form["name"].value
>     file = form["file"].value
>     myfile.write(file)
> 
>     print "Content-Type: text/html"
>     print
>     print name
>     print getpass.getuser()
> 
> 
> 
> 
> Oddmund
> 
> 
> 
> This message is for the designated recipient only and may contain
> privileged or confidential information.  If you have received it in error,
> please notify the sender immediately and delete the original.  Any other
> use of the email by you is prohibited.
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From stanton at livsform.com  Wed Jan 31 03:23:08 2001
From: stanton at livsform.com (Stanton Schell)
Date: Fri Jan  9 21:58:46 2004
Subject: [mod_python] Python libraries install configuration issue
Message-ID: <B69D359B.AD45%stanton@livsform.com>

Hello All,

I have two (unrelated) questions:

1. I was unable to find a searchable version  of the archives - is there
one?

2. Am I forced to install the python libraries during the mod_python
installation into somewhere in /usr/local/lib or can I configure it somehow
to target another directory?  I am trying to install a non-root required
version and would like to stay away from common system areas.

-stanton schell
-- 

Stanton Schell
livsform design group
stanton@livsform.com
703-538-3491
703-989-6591


From stanton at livsform.com  Wed Jan 31 03:32:10 2001
From: stanton at livsform.com (Stanton Schell)
Date: Fri Jan  9 21:58:46 2004
Subject: [mod_python] Python libraries install configuration issue
In-Reply-To: <B69D359B.AD45%stanton@livsform.com>
Message-ID: <B69D37BA.AD47%stanton@livsform.com>

(In other words, I have my source tree and accompanying python libs in
user-owned directory and nothing is in /usr/local/lib at all...)

Thanks!!
-stanton schell
-- 

Stanton Schell
livsform design group
stanton@livsform.com
703-538-3491
703-989-6591

> From: Stanton Schell <stanton@livsform.com>
> Date: Wed, 31 Jan 2001 03:23:08 -0500
> To: <mod_python@modpython.org>
> Subject: [mod_python] Python libraries install configuration issue
> 
> Hello All,
> 
> I have two (unrelated) questions:
> 
> 1. I was unable to find a searchable version  of the archives - is there
> one?
> 
> 2. Am I forced to install the python libraries during the mod_python
> installation into somewhere in /usr/local/lib or can I configure it somehow
> to target another directory?  I am trying to install a non-root required
> version and would like to stay away from common system areas.
> 
> -stanton schell
> -- 
> 
> Stanton Schell
> livsform design group
> stanton@livsform.com
> 703-538-3491
> 703-989-6591
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From stanton at livsform.com  Wed Jan 31 04:14:07 2001
From: stanton at livsform.com (Stanton Schell)
Date: Fri Jan  9 21:58:46 2004
Subject: [mod_python] Python libraries install configuration issue
In-Reply-To: <B69D359B.AD45%stanton@livsform.com>
Message-ID: <B69D418F.AD48%stanton@livsform.com>

sorry for the numerous emails, but the problem has morphed...

I broke down and copied the libraries over to that directory and it was
still having a callback problem (I have pasted the error message in Apache's
error log below).  I then recompiled with the library directory in the
Makefile as the directory I wanted, everything installed, but this same
callback message came when running the test from the manual:

make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
[Wed Jan 31 03:03:16 2001]  [error]  [client 192.168.1.2] python_handler:
    make_obcallback returned no obCallBack!

any help would be appreciated :-)

cheers,
-stanton schell
-- 

Stanton Schell
livsform design group
stanton@livsform.com
703-538-3491
703-989-6591

> From: Stanton Schell <stanton@livsform.com>
> Date: Wed, 31 Jan 2001 03:23:08 -0500
> To: <mod_python@modpython.org>
> Subject: [mod_python] Python libraries install configuration issue
> 
> Hello All,
> 
> I have two (unrelated) questions:
> 
> 1. I was unable to find a searchable version  of the archives - is there
> one?
> 
> 2. Am I forced to install the python libraries during the mod_python
> installation into somewhere in /usr/local/lib or can I configure it somehow
> to target another directory?  I am trying to install a non-root required
> version and would like to stay away from common system areas.
> 
> -stanton schell
> -- 
> 
> Stanton Schell
> livsform design group
> stanton@livsform.com
> 703-538-3491
> 703-989-6591
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From rsalz at caveosystems.com  Wed Jan 31 07:40:08 2001
From: rsalz at caveosystems.com (Rich Salz)
Date: Fri Jan  9 21:58:47 2004
Subject: [mod_python] Python libraries install configuration issue
References: <B69D37BA.AD47%stanton@livsform.com>
Message-ID: <3A7807A8.5EC8CC9F@caveosystems.com>

You need to use PythonPath in your httpd.conf file.
	/r$

From grisha at ispol.com  Wed Jan 31 10:56:40 2001
From: grisha at ispol.com (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:58:47 2004
Subject: [mod_python] Python libraries install configuration issue
In-Reply-To: <B69D37BA.AD47%stanton@livsform.com>
Message-ID: <Pine.BSF.4.21.0101311056090.57390-100000@localhost>

have you looked at the --with-python configure option?

On Wed, 31 Jan 2001, Stanton Schell wrote:

> (In other words, I have my source tree and accompanying python libs in
> user-owned directory and nothing is in /usr/local/lib at all...)
> 
> Thanks!!
> -stanton schell
> -- 
> 
> Stanton Schell
> livsform design group
> stanton@livsform.com
> 703-538-3491
> 703-989-6591
> 
> > From: Stanton Schell <stanton@livsform.com>
> > Date: Wed, 31 Jan 2001 03:23:08 -0500
> > To: <mod_python@modpython.org>
> > Subject: [mod_python] Python libraries install configuration issue
> > 
> > Hello All,
> > 
> > I have two (unrelated) questions:
> > 
> > 1. I was unable to find a searchable version  of the archives - is there
> > one?
> > 
> > 2. Am I forced to install the python libraries during the mod_python
> > installation into somewhere in /usr/local/lib or can I configure it somehow
> > to target another directory?  I am trying to install a non-root required
> > version and would like to stay away from common system areas.
> > 
> > -stanton schell
> > -- 
> > 
> > Stanton Schell
> > livsform design group
> > stanton@livsform.com
> > 703-538-3491
> > 703-989-6591
> > 
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://www.modpython.org/mailman/listinfo/mod_python
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From thornton at yoyoweb.com  Wed Jan 31 09:22:15 2001
From: thornton at yoyoweb.com (Thornton Prime)
Date: Fri Jan  9 21:58:47 2004
Subject: [mod_python] APahce 1.3.17 vs. mod_python
Message-ID: <Pine.LNX.4.32.0101310917040.1986-100000@prajna.anatman.org>

I'm just wondering if anyone has gotten mod_python to work against 1.3.17
yet. I had things working under 1.3.14, but after upgrading to 1.3.17 it
segfaults. I'm hoping someone else has a fix before I dive in with a
debugger.

I already re-compiled mod_python against 1.3.17, and it is at the top of
my addmodules list.

thornton


From stanton at livsform.com  Wed Jan 31 14:06:28 2001
From: stanton at livsform.com (Stanton Schell)
Date: Fri Jan  9 21:58:47 2004
Subject: [mod_python] Python libraries install configuration issue
In-Reply-To: <3A7807A8.5EC8CC9F@caveosystems.com>
References: <3A7807A8.5EC8CC9F@caveosystems.com>
Message-ID: <50115.38.233.141.43.980967988.squirrel@miesmail.livsform.com>

> You need to use PythonPath in your httpd.conf file.
> 	/r$

Thanks for the response.

However, I still have the (a similar) problem:

I have configured the PythonPath directive to include a number of different directories 
including the library directory in my Python build, but still the same thing.  Is there anything 
specifically that mod_python is looking for that I can correct temporarily to at least move on to 
another error message? :-)

-stanton schell

-- 
Stanton Schell
stanton@livsform.com
703.989.6591
703.538.3491

From stanton at livsform.com  Wed Jan 31 21:01:20 2001
From: stanton at livsform.com (Stanton Schell)
Date: Fri Jan  9 21:58:47 2004
Subject: [mod_python] Python libraries install configuration issue
In-Reply-To: <Pine.BSF.4.21.0101311056090.57390-100000@localhost>
Message-ID: <B69E2DA0.AD72%stanton@livsform.com>

I did indeed, I used " --with-python=/path/to/source/root --with-apache=,
etc..."

I have tried putting all these library files in a number of different
locations in addition to including quite a few directories in the PythonPath
directive in httpd.conf, but the module still seems not available for
import.  do you think there is any reason the interpreter could not _import_
the module as opposed to being able to _find_ it?  just a thought...

-stanton
-- 

Stanton Schell
livsform design group
stanton@livsform.com
703-538-3491
703-989-6591

> From: "Gregory (Grisha) Trubetskoy" <grisha@ispol.com>
> Date: Wed, 31 Jan 2001 10:56:40 -0500 (EST)
> To: Stanton Schell <stanton@livsform.com>
> Cc: mod_python@modpython.org
> Subject: Re: [mod_python] Python libraries install configuration issue
> 
> 
> have you looked at the --with-python configure option?
> 
> On Wed, 31 Jan 2001, Stanton Schell wrote:
> 
>> (In other words, I have my source tree and accompanying python libs in
>> user-owned directory and nothing is in /usr/local/lib at all...)
>> 
>> Thanks!!
>> -stanton schell
>> -- 
>> 
>> Stanton Schell
>> livsform design group
>> stanton@livsform.com
>> 703-538-3491
>> 703-989-6591
>> 
>>> From: Stanton Schell <stanton@livsform.com>
>>> Date: Wed, 31 Jan 2001 03:23:08 -0500
>>> To: <mod_python@modpython.org>
>>> Subject: [mod_python] Python libraries install configuration issue
>>> 
>>> Hello All,
>>> 
>>> I have two (unrelated) questions:
>>> 
>>> 1. I was unable to find a searchable version  of the archives - is there
>>> one?
>>> 
>>> 2. Am I forced to install the python libraries during the mod_python
>>> installation into somewhere in /usr/local/lib or can I configure it somehow
>>> to target another directory?  I am trying to install a non-root required
>>> version and would like to stay away from common system areas.
>>> 
>>> -stanton schell
>>> -- 
>>> 
>>> Stanton Schell
>>> livsform design group
>>> stanton@livsform.com
>>> 703-538-3491
>>> 703-989-6591
>>> 
>>> _______________________________________________
>>> Mod_python mailing list
>>> Mod_python@modpython.org
>>> http://www.modpython.org/mailman/listinfo/mod_python
>> 
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://www.modpython.org/mailman/listinfo/mod_python
>> 


From grisha at ispol.com  Wed Jan 31 23:29:44 2001
From: grisha at ispol.com (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:58:47 2004
Subject: [mod_python] modpublisher security model
In-Reply-To: <NCBBKMABOKFCDLPIKKGIMEHGCJAA.brett@bookshop.unsw.edu.au>
Message-ID: <Pine.BSF.4.21.0101312320090.70118-100000@localhost>

I have in CVS some fixes that do not allow the publisher handler to
traverse modules. Right now if your script imports os, then one can get to
os and functions within it via a url, which is really bad. (ZPublisher
doesn't traverse modules either.)

Assuming that module traversing issue is fixed - you make a function
"published" by simply having it in the module. If you do not want it to be
published, you can set it's name to begin with an underscore or place it
into another module.

I did this because the ZPublisher comment thing always annoyed me. It's
really misleading - I like to use comments for what they are - comments,
and if a function doesn't need a comment, I prefer to have the option of
having no comment rather than """ this comment is for ZPublisher """ or
something silly like that.

Grisha

On Thu, 1 Feb 2001, Brett Haydon wrote:

> Evidently Zope currently uses the doc string to 
> explicity allow access to functions via URL.
> 
> The new Python 2.1 will allow functions to have
> attributes.
> 
> I am currently renaming all imported modules with
> an underscore to avoid unintentional security problems
> (and global objects)
> but I like the idea of explicitly allowing access.
> 
> Any plans to move in this direction.
> 
> regards,
> ______________________________________________
> Brett Haydon
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From arhiv at freemail.org.mk  Mon Jan  1 21:54:25 2001
From: arhiv at freemail.org.mk (Damjan)
Date: Fri Jan  9 22:02:34 2004
Subject: [mod_python] Sugestion about publisher
Message-ID: <20010101215425.A606@localhost.localdomain>

Here is a small patch for mod_python.publisher, that instead of raising an
error when there is no PATH_INFO, it substitutes a default PATH_INFO. 
(I choose index_html, perhaps a diferent default method can be chosen)

That way when we call a script without specifying a method, the method
index_html is called.

--- publisher.py.old    Mon Jan  1 21:48:04 2001
+++ publisher.py        Mon Jan  1 21:47:39 2001
@@ -81,7 +81,7 @@
 
     # get the path PATH_INFO (everthing after script)
     if not _req.subprocess_env.has_key("PATH_INFO"):
-        raise apache.SERVER_RETURN, apache.HTTP_NOT_FOUND
+        _req.subprocess_env["PATH_INFO"]="/index_html"
     
     func_path = _req.subprocess_env["PATH_INFO"][1:] # skip fist /
     func_path = string.replace(func_path, "/", ".")


-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From peter.bittner at gmx.net  Tue Jan  2 14:22:37 2001
From: peter.bittner at gmx.net (peter.bittner@gmx.net)
Date: Fri Jan  9 22:02:34 2004
Subject: [mod_python] mod_python vs. PyApache, mod_snake
Message-ID: <1294.978441757@www32.gmx.net>

Hi there!

I've heard about that Python is available as a module for Apache too!
That's cool, but what is right for me?

 mod_python, PyApache oder mod_snake?

I've sound them all three.
I want to either use CGI or embedded Python (embedded in HTML) - or both.
Can anyone tell me what is best for me?

Cheers,
Peter

-- 
Peter Bittner
web: http://beam.to/peter.bittner
mail: peter.bittner@gmx.net
mobile: +43/(0)650/8901150
+-----------------------------
| HTML-Minikurs:  http://beam.to/htmlkurs
| Gesundheit:  http://www.gesundheitsfoerderung.at
| Fasten:  http://www.gesundheitsfoerderung.at/fasten

Sent through GMX FreeMail - http://www.gmx.net


From grisha at ispol.com  Tue Jan  2 17:22:09 2001
From: grisha at ispol.com (Gregory Trubetskoy)
Date: Fri Jan  9 22:02:34 2004
Subject: [mod_python] Sugestion about publisher
In-Reply-To: <20010101215425.A606@localhost.localdomain>
Message-ID: <Pine.LNX.4.21.0101021718210.28295-100000@saturn.ispol.com>

But I wonder what the usability of such a feature might be. (I'm not
aysing I'm against it, I'd just like to have a small discussion about it
first). 

In general, I do not like implicit or default stuff like this - I think if
you're specifying a module without a method, you should get nothing in
return. 

Another note - this modifies PATH_INFO. I think PATH_INFO should always
represent what the user passed. 


On Mon, 1 Jan 2001, Damjan wrote:

> Here is a small patch for mod_python.publisher, that instead of raising an
> error when there is no PATH_INFO, it substitutes a default PATH_INFO. 
> (I choose index_html, perhaps a diferent default method can be chosen)
> 
> That way when we call a script without specifying a method, the method
> index_html is called.
> 
> --- publisher.py.old    Mon Jan  1 21:48:04 2001
> +++ publisher.py        Mon Jan  1 21:47:39 2001
> @@ -81,7 +81,7 @@
>  
>      # get the path PATH_INFO (everthing after script)
>      if not _req.subprocess_env.has_key("PATH_INFO"):
> -        raise apache.SERVER_RETURN, apache.HTTP_NOT_FOUND
> +        _req.subprocess_env["PATH_INFO"]="/index_html"
>      
>      func_path = _req.subprocess_env["PATH_INFO"][1:] # skip fist /
>      func_path = string.replace(func_path, "/", ".")
> 
> 
> -- 
> Damjan Georgievski		|           ???????????? ??????????????????????
> Skopje, Macedonia		|           ????????????, ????????????????????
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From mecury at illusion.snu.ac.kr  Wed Jan  3 10:57:12 2001
From: mecury at illusion.snu.ac.kr (sjw)
Date: Fri Jan  9 22:02:34 2004
Subject: [mod_python] A Newbie's question,
Message-ID: <Pine.GSO.4.05.10101031051530.18076-100000@illusion>

hmm, I've installed mod_python and tested it

and it was ok..

( the code is the sample code, like following..

from mod_python import apache
 
def handler(req):
    req.send_http_header()
    req.write("Hello World!")
    return apache.OK  )

BUT, All I want to do is paste a simple, text counter 

to my homepage, like <!--#exec cgi="some/dirs/counter.cgi?id=myID"-->

did.

How can I do that with mod-python?..

Thanks in advance



From dyeung at ust.hk  Wed Jan  3 13:47:56 2001
From: dyeung at ust.hk (David YEUNG)
Date: Fri Jan  9 22:02:34 2004
Subject: [mod_python] Error with the req.register_cleanup
Message-ID: <3A52BD0C.9BA9B475@ust.hk>

Is there any code example how to use the 'req.register_cleanup()'?
I tried to put a function to disconnect the database through the
req.register_cleanup as following:


def index(req):
  ...
  db = MySQLdb.connect(...)
  cur = db.cursor()
  req.register_cleanup(disconnectdb,cur)
  ...
  ... some db query

def disconnectdb(cur):
  db = cur.connection
  cur.close()
  db.close()

  
The apache error_log file keeps displaying the following errors whenever
I invoke the 'register_cleanup' methods. If I do not use the 'register_cleanup',
but call the 'disconnectdb' at the end of the 'index' function. There is no
error in the log file.

---- error_log ----
[Tue Jan  2 21:32:28 2001] [notice] child pid 31239 exit signal Aborted (6)
Fatal Python error: PyThreadState_Get: no current thread
[Tue Jan  2 21:32:40 2001] [notice] child pid 31238 exit signal Aborted (6)
Fatal Python error: PyThreadState_Get: no current thread
[Tue Jan  2 21:32:46 2001] [notice] child pid 31241 exit signal Aborted (6)
Fatal Python error: PyThreadState_Get: no current thread 


I am using Apache 1.3.14 on RedHat 6.2, mod_python 2.7.1, MySQLdb 0.3.0.

Thanks for any advice.


David Yeung

From aperis at bemarnet.es  Thu Jan  4 16:10:49 2001
From: aperis at bemarnet.es (Arturo Peris)
Date: Fri Jan  9 22:02:34 2004
Subject: [mod_python] util.FieldStorage(req).list
Message-ID: <3A549279.6090905@bemarnet.es>

Hi,
my problem is with util.FieldStorage, I can't get information contained 
in content variable.
I call my form.py program from here:

...<form action= "/mailing/form.py/handler" method="post">...
catsel, subcatsel and idisel are checkbox.


MY form.py PROGRAM
---------------------------------------------
from mod_python import apache
from pg import DB
import string
from mod_python import util

def handler(req,catsel,subcatsel,idisel):
  req.content_type = "text/html"
  req.send_http_header()
  content = util.FieldStorage(req).list
---------------------------------------------

Can ne1 help me ?

Thanks.


From grisha at ispol.com  Thu Jan  4 11:21:04 2001
From: grisha at ispol.com (Gregory Trubetskoy)
Date: Fri Jan  9 22:02:34 2004
Subject: [mod_python] util.FieldStorage(req).list
In-Reply-To: <3A549279.6090905@bemarnet.es>
Message-ID: <Pine.LNX.4.21.0101041112390.2246-100000@saturn.ispol.com>

If you are using the mod_python.publisher handler, then you cannot use
FieldStorage within it (because the publisher handler creates one for
you already), you have to use req.form variable, it's an instance of
util.FieldStorage.

I'm sorry I forgot to document this little fact...

--
  Gregory (Grisha) Trubetskoy
       grisha@ispol.com

On Thu, 4 Jan 2001, Arturo Peris wrote:

> Hi,
> my problem is with util.FieldStorage, I can't get information contained 
> in content variable.
> I call my form.py program from here:
> 
> ...<form action= "/mailing/form.py/handler" method="post">...
> catsel, subcatsel and idisel are checkbox.
> 
> 
> MY form.py PROGRAM
> ---------------------------------------------
> from mod_python import apache
> from pg import DB
> import string
> from mod_python import util
> 
> def handler(req,catsel,subcatsel,idisel):
>   req.content_type = "text/html"
>   req.send_http_header()
>   content = util.FieldStorage(req).list
> ---------------------------------------------
> 
> Can ne1 help me ?
> 
> Thanks.
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From norm at streamtheory.com  Thu Jan  4 22:29:02 2001
From: norm at streamtheory.com (Norman Boccone)
Date: Fri Jan  9 22:02:34 2004
Subject: [mod_python] undefined reference to Py_... error compiling apache
Message-ID: <3A5569AE.9060109@streamtheory.com>

I am on Solaris trying to compile mod_python 2.7.1 into apache 1.3.14.  
Compiling of python and mod_python are fine, make test on python is 
fine.  When I try to make apache I get the following errors:

gcc  -DSOLARIS2=270 -DUSE_EXPAT -I./lib/expat-lite -DNO_DL_NEEDED 
`./apaci`    \
     -o httpd buildmark.o modules.o modules/python/libpython.a 
modules/standard/libstandard.a main/libmain.a ./os/unix/libos.a 
ap/libap.a  lib/expat-lite/libexpat.a  -lsocket -lnsl
modules/python/libpython.a(mod_python.o): In function `make_interpreter':
mod_python.o(.text+0xa7): undefined reference to `Py_NewInterpreter'
mod_python.o(.text+0xe6): undefined reference to `PyThreadState_Swap'
modules/python/libpython.a(mod_python.o): In function 
`get_interpreter_data':
mod_python.o(.text+0x124): undefined reference to `PyDict_GetItemString'
...and a bunch more like this

Any idea how I can fix it?  I thought I followed the instructions exactly.


From arhiv at freemail.org.mk  Fri Jan  5 16:32:33 2001
From: arhiv at freemail.org.mk (Damjan)
Date: Fri Jan  9 22:02:34 2004
Subject: [mod_python] Sugestion about publisher
In-Reply-To: <Pine.LNX.4.21.0101021718210.28295-100000@saturn.ispol.com>; from grisha@ispol.com on Tue, Jan 02, 2001 at 05:22:09PM -0500
References: <20010101215425.A606@localhost.localdomain> <Pine.LNX.4.21.0101021718210.28295-100000@saturn.ispol.com>
Message-ID: <20010105163233.B633@localhost.localdomain>

On Tue, Jan 02, 2001 at 05:22:09PM -0500, Gregory Trubetskoy wrote:
> 
> But I wonder what the usability of such a feature might be. (I'm not
> aysing I'm against it, I'd just like to have a small discussion about it
> first). 

It's usable to me ;) but what do the other mod_python users think?

> In general, I do not like implicit or default stuff like this - I think if
> you're specifying a module without a method, you should get nothing in
> return.

Sometimes people write URL's by hand, and not always will they remember the
whole URL. The problem I see is that you get HTTP_NOT_FOUND for a subset of a
valid URL and IMHO it's not very intuitive compared to 'normal' URL handling.

And every web server has a default page for a directory (index.html..).
 
> Another note - this modifies PATH_INFO. I think PATH_INFO should always
> represent what the user passed. 

It does't modify it, it just specifies a default PATH_INFO when PATH_INFO doesn't
exist at all. But Ok, the patch can be made differrent (I just chouse the sollution with
minimal changes to publisher.py).


-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From rsalz at caveosystems.com  Fri Jan  5 11:02:35 2001
From: rsalz at caveosystems.com (Rich Salz)
Date: Fri Jan  9 22:02:35 2004
Subject: [mod_python] Sugestion about publisher
References: <20010101215425.A606@localhost.localdomain> <Pine.LNX.4.21.0101021718210.28295-100000@saturn.ispol.com> <20010105163233.B633@localhost.localdomain>
Message-ID: <3A55F01B.C1CF1802@caveosystems.com>

I can see the convenience of adding 'index.html' (hee hee :) to the
end of nothing else is there.  Or rather, I can see how it is nice
to mimic other behavior.  But the current hack is wrong.

In apache, if you ask for 'foo' and foo is a directory, the server
sends back a redirect, telling you to go for 'foo/' and then it does
the auto-indexing.

It *might* be worthwhile letting the user emulate that.

But I agree, do not include the current patch and do not modify
PATH_INFO
	/r$

From arhiv at freemail.org.mk  Fri Jan  5 18:19:16 2001
From: arhiv at freemail.org.mk (Damjan)
Date: Fri Jan  9 22:02:35 2004
Subject: [mod_python] Sugestion about publisher
In-Reply-To: <3A55F01B.C1CF1802@caveosystems.com>; from rsalz@caveosystems.com on Fri, Jan 05, 2001 at 11:02:35AM -0500
References: <20010101215425.A606@localhost.localdomain> <Pine.LNX.4.21.0101021718210.28295-100000@saturn.ispol.com> <20010105163233.B633@localhost.localdomain> <3A55F01B.C1CF1802@caveosystems.com>
Message-ID: <20010105181916.A1147@localhost.localdomain>

On Fri, Jan 05, 2001 at 11:02:35AM -0500, Rich Salz wrote:
> I can see the convenience of adding 'index.html' (hee hee :) to the
> end of nothing else is there.  Or rather, I can see how it is nice
> to mimic other behavior.  But the current hack is wrong.
> 
Ok. How about this:

--- publisher.py.old    Mon Jan  1 21:48:04 2001
+++ publisher.py        Fri Jan  5 18:16:34 2001
@@ -81,7 +81,11 @@

     # get the path PATH_INFO (everthing after script)
     if not _req.subprocess_env.has_key("PATH_INFO"):
-        raise apache.SERVER_RETURN, apache.HTTP_NOT_FOUND
+        loc = 'http://' + _req.connection.server.server_hostname
+        loc = loc + ':' + str(_req.connection.server.port)
+        loc = loc + _req.uri + '/index_html'
+        _req.headers_out['Location'] = loc
+        raise apache.SERVER_RETURN, apache.HTTP_MOVED_PERMANENTLY

     func_path = _req.subprocess_env["PATH_INFO"][1:] # skip fist /
     func_path = string.replace(func_path, "/", ".")


-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From rsalz at caveosystems.com  Fri Jan  5 12:49:31 2001
From: rsalz at caveosystems.com (Rich Salz)
Date: Fri Jan  9 22:02:35 2004
Subject: [mod_python] Sugestion about publisher
References: <20010101215425.A606@localhost.localdomain> <Pine.LNX.4.21.0101021718210.28295-100000@saturn.ispol.com> <20010105163233.B633@localhost.localdomain> <3A55F01B.C1CF1802@caveosystems.com> <20010105181916.A1147@localhost.localdomain>
Message-ID: <3A56092B.BB73AE22@caveosystems.com>

Very very cool.  A couple of (minor) things.

> +        loc = 'http://' + _req.connection.server.server_hostname
                  ^^^^^^^^^^
		should get it out of the uri, since it might be https

> +        loc = loc + ':' + str(_req.connection.server.port)
> +        loc = loc + _req.uri + '/index_html'
> +        _req.headers_out['Location'] = loc
> +        raise apache.SERVER_RETURN, apache.HTTP_MOVED_PERMANENTLY
					^^^^^^^^^^^^^^^^^^^^^^^^^^^
should be moved_temporarily, I'm fairly sure.

The whole thing should be controlled by a mod_python auto_index option,
or perhaps based on the DirectoryIndex apache config option?

Anyhow, something like this should go into the code!
	/r$

From arhiv at freemail.org.mk  Sat Jan  6 00:05:10 2001
From: arhiv at freemail.org.mk (Damjan)
Date: Fri Jan  9 22:02:35 2004
Subject: [mod_python] Sugestion about publisher
In-Reply-To: <20010105181916.A1147@localhost.localdomain>; from arhiv@freemail.org.mk on Fri, Jan 05, 2001 at 06:19:16PM +0100
References: <20010101215425.A606@localhost.localdomain> <Pine.LNX.4.21.0101021718210.28295-100000@saturn.ispol.com> <20010105163233.B633@localhost.localdomain> <3A55F01B.C1CF1802@caveosystems.com> <20010105181916.A1147@localhost.localdomain>
Message-ID: <20010106000510.B461@localhost.localdomain>

> Ok. How about this:
> 
> --- publisher.py.old    Mon Jan  1 21:48:04 2001
> +++ publisher.py        Fri Jan  5 18:16:34 2001
> @@ -81,7 +81,11 @@
> 
>      # get the path PATH_INFO (everthing after script)
>      if not _req.subprocess_env.has_key("PATH_INFO"):
> -        raise apache.SERVER_RETURN, apache.HTTP_NOT_FOUND
> +        loc = 'http://' + _req.connection.server.server_hostname
> +        loc = loc + ':' + str(_req.connection.server.port)
> +        loc = loc + _req.uri + '/index_html'
> +        _req.headers_out['Location'] = loc
> +        raise apache.SERVER_RETURN, apache.HTTP_MOVED_PERMANENTLY
> 
>      func_path = _req.subprocess_env["PATH_INFO"][1:] # skip fist /
>      func_path = string.replace(func_path, "/", ".")

Hmmm. 
I found a strange thing in mod_python, while playing with this patch.
The situation is this:
if you type a URL of a with a trailling '/' you get that
req.subprocess_env.["PATH_INFO"] doesn't exist but req.pathinfo is '/'.
Why is   req.subprocess_env.["PATH_INFO"] != req.pathinfo ??

-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From arhiv at freemail.org.mk  Fri Jan  5 21:20:10 2001
From: arhiv at freemail.org.mk (Damjan)
Date: Fri Jan  9 22:02:35 2004
Subject: [mod_python] Sugestion about publisher
In-Reply-To: <3A56092B.BB73AE22@caveosystems.com>; from rsalz@caveosystems.com on Fri, Jan 05, 2001 at 12:49:31PM -0500
References: <20010101215425.A606@localhost.localdomain> <Pine.LNX.4.21.0101021718210.28295-100000@saturn.ispol.com> <20010105163233.B633@localhost.localdomain> <3A55F01B.C1CF1802@caveosystems.com> <20010105181916.A1147@localhost.localdomain> <3A56092B.BB73AE22@caveosystems.com>
Message-ID: <20010105212010.A461@localhost.localdomain>

On Fri, Jan 05, 2001 at 12:49:31PM -0500, Rich Salz wrote:
> Very very cool.  A couple of (minor) things.
> 
> > +        loc = 'http://' + _req.connection.server.server_hostname
>                   ^^^^^^^^^^
> 		should get it out of the uri, since it might be https

I can't see where from in mod_python to get this ?!?

> > +        loc = loc + ':' + str(_req.connection.server.port)
> > +        loc = loc + _req.uri + '/index_html'
> > +        _req.headers_out['Location'] = loc
> > +        raise apache.SERVER_RETURN, apache.HTTP_MOVED_PERMANENTLY
> 					^^^^^^^^^^^^^^^^^^^^^^^^^^^
> should be moved_temporarily, I'm fairly sure.

Well, my Apache returns MOVED_PERMANENTLY for directories, I tried it with:

	damjan# nc local 80
	GET /manual HTTP/1.0

	HTTP/1.1 301 Moved Permanently
	Date: Fri, 05 Jan 2001 20:15:43 GMT
	Server: Apache-AdvancedExtranetServer/1.3.12
	Location: http://localhost.localdomain/manual/
	Connection: close
	Content-Type: text/html; charset=iso-8859-1
	...


> The whole thing should be controlled by a mod_python auto_index option,
> or perhaps based on the DirectoryIndex apache config option?
 
We can think of that later.

One question, should I use req.hostname or 
req.connection.server.server_hostname? (it may be diferent)


-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From rsalz at caveosystems.com  Fri Jan  5 20:28:09 2001
From: rsalz at caveosystems.com (Rich Salz)
Date: Fri Jan  9 22:02:35 2004
Subject: [mod_python] Sugestion about publisher
References: <20010101215425.A606@localhost.localdomain> <Pine.LNX.4.21.0101021718210.28295-100000@saturn.ispol.com> <20010105163233.B633@localhost.localdomain> <3A55F01B.C1CF1802@caveosystems.com> <20010105181916.A1147@localhost.localdomain> <3A56092B.BB73AE22@caveosystems.com> <20010105212010.A461@localhost.localdomain>
Message-ID: <3A5674A9.9B9FB3A8@caveosystems.com>

> > > +        loc = 'http://' + _req.connection.server.server_hostname
> >                   ^^^^^^^^^^
> >               should get it out of the uri, since it might be https
> 
> I can't see where from in mod_python to get this ?!?

Perhaps easiest to leave out the protocol, host, and port altogether.
Won't that work?  loc = _req.uri + /index_html ?

> Well, my Apache returns MOVED_PERMANENTLY for directories, I tried it with:

I must have old information, or an old server -- ncsa code. :)  Thanks.

> One question, should I use req.hostname or
> req.connection.server.server_hostname? (it may be diferent)

If you can't just omit it, then I think you want the second choice, but I'm
not 
very knowledgeable about virtual hosting.
	/r$

From grisha at ispol.com  Fri Jan  5 23:42:42 2001
From: grisha at ispol.com (Gregory Trubetskoy)
Date: Fri Jan  9 22:02:35 2004
Subject: [mod_python] Sugestion about publisher
In-Reply-To: <3A5674A9.9B9FB3A8@caveosystems.com>
Message-ID: <Pine.LNX.4.21.0101052340340.7443-100000@saturn.ispol.com>

> > One question, should I use req.hostname or
> > req.connection.server.server_hostname? (it may be diferent)

req.hostname is a better choice, since this is what the client
supplied. server.server_hostname is the name configured for this virtual
server. I think when you'tr using a default server feature, they may be
different.

grisha


From chris at voodooland.net  Sat Jan  6 21:02:09 2001
From: chris at voodooland.net (Chris Watson)
Date: Fri Jan  9 22:02:35 2004
Subject: [mod_python] mod_python.publisher handler question...
Message-ID: <Pine.BSF.4.21.0101062028510.6987-100000@open-systems.net>

I have seen people ask the same question I am about to in the archives.
But I didn't see an answer archived as well.

It's my understand that for each script in your python dir you NEED to
give it a PythonHandler of the same name? If I have foo.py and bar.py
I need to Directory directives one with PythonHandler foo one with
PythonHandler bar. Right?

What I read was that to eliminate this I could simply set the
PythonHandler to mod_python.publisher. And ALL .py scripts in the python
directory would work. But they don't. I'm sure I have it set wrong or I am
misreading the documentation. I have the following configured in apache:

<Directory /usr/local/share/apache/htdocs/python>
          AddHandler python-program .py
          PythonHandler mod_python.publisher
          PythonDebug On
</Directory>

And In that directory are 3 copies of the hell world script from the
documentation. Each with a different name and none of them work with the
above. If I change the handler name to one of the 3 scripts that one
script will work. Have I misread the doco and am wrong in interperating
that mod_python.publisher will execute *any* .py script thats called in a
url in the directory? OR have I simple not configured apache properly?

Im not on the list so reply to me directly please.

Thanks for you time. Have a good weekend everyone!

Chris




From aperis at bemarnet.es  Tue Jan  9 19:03:26 2001
From: aperis at bemarnet.es (Arturo Peris)
Date: Fri Jan  9 22:02:35 2004
Subject: [mod_python] req.form
Message-ID: <3A5B526E.40803@bemarnet.es>

Hi,
I use req.form variable (it's an instance of util.FieldStorage):
-------------------
content = req.form
lista = content.list
return lista
...

  [Field('Coste', '12'), Field('Coste', '10'), Field('Envios', '1'), 
Field('Return', '/mailing/gen_mail.py/handler')]
-------------------
and my question is, wath is the best way to get values from this list?

Thanks.


From djc at object-craft.com.au  Wed Jan 10 16:49:57 2001
From: djc at object-craft.com.au (Dave Cole)
Date: Fri Jan  9 22:02:35 2004
Subject: [mod_python] Publisher handler has a small problem...
Message-ID: <m33deshs6y.fsf@vole.object-craft.com.au>

If I make the following module hello.py available via the publisher
handler:

        """ Publisher example """
        import os
        
        def say(req, what="NOTHING"):
            return "I am saying %s" % what        

Then a browser request which looks like this:

        /hello/os/renames?old=/tmp/blah&new=/tmp/blah1

will actually work (as the apache user).  I am fairly sure that this
is not desirable...

If someone knows which modules you are importing in your code, they
will be able to call any non-builtin function anywhere in the
namespace.

Maybe the publisher handler should only allow objects to be published
if they have some sort of special attribute, __publish__ for example.

- Dave

-- 
http://www.object-craft.com.au


From Peter.GIANNOPOULOS at gemplus.com  Wed Jan 10 12:58:27 2001
From: Peter.GIANNOPOULOS at gemplus.com (Peter Giannopoulos)
Date: Fri Jan  9 22:02:35 2004
Subject: [mod_python] Server error message
Message-ID: <HEELLMEIEBHKANGCLEELCEGMCCAA.peter.giannopoulos@gemplus.com>

Hello,


I have a question that may have an obvious answer but for the life of me I
can't seem to find it.
Here goes:

Any and every time I use the publisher handler I get an error when I return
any except for a string.
example:


	def handler(req):
        req.content_type = "text/plain"
        req.send_http_header()
        req.write("Hello World!")

        return apache.OK




Displays :

	Hello World!HTTP/1.1 200 OK
	Date: Wed, 10 Jan 2001 17:48:44 GMT
	Server: Apache/1.3.14 (Unix) mod_python/2.7 Python/1.5.2
	Connection: close
	Transfer-Encoding: chunked
	Content-Type: text/html; charset=iso-8859-1

	<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
	<HTML><HEAD>
	<TITLE>200 OK</TITLE>
	</HEAD><BODY>
	<H1>OK</H1>
	The server encountered an internal error or
	misconfiguration and was unable to complete
	your request.<P>
	Please contact the server administrator,
	 petergi@gemplus.com and inform them of the time the error occurred,
	and anything you might have done that may have
	caused the error.<P>
	More information about this error may be available
	in the server error log.<P>
	<HR>
	<ADDRESS>Apache/1.3.14 Server at Medusa Port 80</ADDRESS>
	</BODY></HTML>




But there is nothing in the server logs.
Yet if a return a string instead (any string) even simply ( return " ").
It seems to be fine. Why? Can someone help me understand what is happening?






Peter Giannopoulos, Software Developer
Gemplus Software,   Advanced Projects Group

Phone: +15147322434
Fax:   +15147322401
Gemplus Card International
http://www.gemplus.com


-------------- next part --------------
A non-text attachment was scrubbed...
Name: Peter Giannopoulos.vcf
Type: text/x-vcard
Size: 613 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20010110/4bfcc954/PeterGiannopoulos-0003.vcf
From grisha at ispol.com  Thu Jan 11 01:04:50 2001
From: grisha at ispol.com (Gregory Trubetskoy)
Date: Fri Jan  9 22:02:35 2004
Subject: [mod_python] Publisher handler has a small problem...
In-Reply-To: <m33deshs6y.fsf@vole.object-craft.com.au>
Message-ID: <Pine.LNX.4.21.0101110101550.2739-100000@saturn.ispol.com>

Looks like a rather big prolem to me...

I did some testing with ZPublisher, and it returns "Not Found" when trying
to access os, but does find string... 

I haven't studies the code yet o find out why. I'd rather there was a way
to solve this problem without anything like __publish__...

--
  Gregory (Grisha) Trubetskoy
       grisha@ispol.com

On 10 Jan 2001, Dave Cole wrote:

> If I make the following module hello.py available via the publisher
> handler:
> 
>         """ Publisher example """
>         import os
>         
>         def say(req, what="NOTHING"):
>             return "I am saying %s" % what        
> 
> Then a browser request which looks like this:
> 
>         /hello/os/renames?old=/tmp/blah&new=/tmp/blah1
> 
> will actually work (as the apache user).  I am fairly sure that this
> is not desirable...
> 
> If someone knows which modules you are importing in your code, they
> will be able to call any non-builtin function anywhere in the
> namespace.
> 
> Maybe the publisher handler should only allow objects to be published
> if they have some sort of special attribute, __publish__ for example.
> 
> - Dave
> 
> -- 
> http://www.object-craft.com.au
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From hz at lexgen.com  Fri Jan 12 16:21:47 2001
From: hz at lexgen.com (Hao Zhou)
Date: Fri Jan  9 22:02:35 2004
Subject: [mod_python] mod_python install woe
Message-ID: <20010112162147.A29475@hydrogene.lexgen.com>

Hi everyone,

I got the following error message when I tried to install mod_python
on a Sun machine running SunOS 5.7 with Python 1.5.2.

Could any one shed some light on how to correct it? Thanks a lot!

Hao

/usr/local/apache/bin/httpd -DSSL -d /etc/local/apache/ 
Syntax error on line 121 of /etc/local/apache/conf/httpd.conf:
Cannot load /etc/local/apache/libexec/mod_python.so into server:
ld.so.1: /usr/local/apache/bin/httpd: fatal: relocation error: file
/etc/local/apache/libexec/mod_python.so: symbol __muldi3: referenced
symbol not found


From arhiv at freemail.org.mk  Mon Jan 15 12:29:47 2001
From: arhiv at freemail.org.mk (Damjan)
Date: Fri Jan  9 22:02:35 2004
Subject: [mod_python] Server error message
In-Reply-To: <HEELLMEIEBHKANGCLEELCEGMCCAA.peter.giannopoulos@gemplus.com>; from Peter.GIANNOPOULOS@gemplus.com on Wed, Jan 10, 2001 at 12:58:27PM -0500
References: <HEELLMEIEBHKANGCLEELCEGMCCAA.peter.giannopoulos@gemplus.com>
Message-ID: <20010115122947.A458@localhost.localdomain>

On Wed, Jan 10, 2001 at 12:58:27PM -0500, Peter Giannopoulos wrote:
> Hello,
> 
> 
> I have a question that may have an obvious answer but for the life of me I
> can't seem to find it.
> Here goes:
> 
> Any and every time I use the publisher handler I get an error when I return
> any except for a string.
...
RTFM

The publisher handler EXPECTS the script it called to return the content.


-- 
Damjan Georgievski		|           ?????? ???????????
Skopje, Macedonia		|           ??????, ??????????

From derek at realware.com.au  Tue Jan 16 09:51:16 2001
From: derek at realware.com.au (Derek Lavine)
Date: Fri Jan  9 22:02:35 2004
Subject: [mod_python] Making an exe
Message-ID: <048801c07f4e$0cfb0d10$315119cb@realware.com.au>

Hi all,

I am about to write a couple of little utils as my introduction in to the
python world. The thing is, I would like to be able to give some of these
utils to people that don't have python on their machines. To this end I
would like to create and EXE from the python code. I know this can be done
with ActiveState Perl but can it be done with Python

Thanks in advance
Derek


From grisha at ispol.com  Mon Jan 15 19:10:39 2001
From: grisha at ispol.com (Gregory Trubetskoy)
Date: Fri Jan  9 22:02:35 2004
Subject: [mod_python] Making an exe
In-Reply-To: <048801c07f4e$0cfb0d10$315119cb@realware.com.au>
Message-ID: <Pine.LNX.4.21.0101151909230.29452-100000@saturn.ispol.com>


What does this have to do with mod_python?


On Tue, 16 Jan 2001, Derek Lavine wrote:

> Hi all,
> 
> I am about to write a couple of little utils as my introduction in to the
> python world. The thing is, I would like to be able to give some of these
> utils to people that don't have python on their machines. To this end I
> would like to create and EXE from the python code. I know this can be done
> with ActiveState Perl but can it be done with Python
> 
> Thanks in advance
> Derek
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From derek at realware.com.au  Tue Jan 16 11:16:15 2001
From: derek at realware.com.au (Derek Lavine)
Date: Fri Jan  9 22:02:35 2004
Subject: [mod_python] Making an exe
References: <Pine.LNX.4.21.0101151909230.29452-100000@saturn.ispol.com>
Message-ID: <04aa01c07f59$ec719ee0$315119cb@realware.com.au>

Oops sorry posted to the wrong news group

Derek

----- Original Message -----
From: Gregory Trubetskoy <grisha@ispol.com>
To: Derek Lavine <derek@realware.com.au>
Cc: <Mod_python@modpython.org>
Sent: Tuesday, January 16, 2001 10:10 AM
Subject: Re: [mod_python] Making an exe


>
>
> What does this have to do with mod_python?
>
>
> On Tue, 16 Jan 2001, Derek Lavine wrote:
>
> > Hi all,
> >
> > I am about to write a couple of little utils as my introduction in to
the
> > python world. The thing is, I would like to be able to give some of
these
> > utils to people that don't have python on their machines. To this end I
> > would like to create and EXE from the python code. I know this can be
done
> > with ActiveState Perl but can it be done with Python
> >
> > Thanks in advance
> > Derek
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://www.modpython.org/mailman/listinfo/mod_python
> >
>
>


From rafi at voruta.ek.univ.gda.pl  Wed Jan 17 17:33:51 2001
From: rafi at voruta.ek.univ.gda.pl (rafal polonski)
Date: Fri Jan  9 22:02:35 2004
Subject: [mod_python] Debian 2.2 and mod_python
Message-ID: <20010117173350.A29278@voruta.ek.univ.gda.pl>

Hello,
I am trying to run mod_python on Debian 2.2 distribution.

Apache 1.3.9
Python 1.5.2 (with threads)
mod_python-2.7.1
gcc 2.95

Compiling as a DSO module goes without any error.
Of course I get a warning about having Python compiled WITH threads.

apache -X 
gives me Segmentation fault:
[Wed Jan 17 16:48:01 2001] [notice] caught SIGTERM, shutting down]

So probably I have to blame Python compiled with threads.


So I downloaded Python 1.6, compiled it without threads but trying to
compile mod_python with this 1.6 version gives this error:
gcc -shared -o mod_python.so mod_python.o _apachemodule.o requestobject.o
tableo
bject.o util.o serverobject.o connobject.o -lm
/tmp/modp/Python-1.6/libpython1.6
.a -lieee -ldl -lm -lc -lm -lcrypt -ldb
/usr/bin/ld: mod_python.so: undefined versioned symbol name
_LIB_VERSION@@GLIBC_
2.0
/usr/bin/ld: failed to set dynamic section sizes: Bad value
collect2: ld returned 1 exit status
apxs:Break: Command failed with rc=65536
make[1]: *** [mod_python.so] Error 1
make[1]: Leaving directory `/tmp/modp/mod_python-2.7.1/src'
make: *** [do_dso] Error 2
# 


So I downloaded Python 2.0, compiled it without threads.
With this Python version Apache and mod_python started.
I got quiet huge .so file:
2873238 Jan 17 17:26 mod_python.so 
Stripped version: 1601536 Jan 17 17:28 mod_python.so
Is that normal?


So the question is:
Can I compile mod_python with threaded Python 1.5.2? or just forget 
about threaded vesrion and use one without them?
Why did I get problems trying to use 1.6 Python version wit mod_python?

habe a nice day
rafal

From hunter at userfriendly.net  Wed Jan 17 20:20:21 2001
From: hunter at userfriendly.net (hunter)
Date: Fri Jan  9 22:02:35 2004
Subject: [mod_python] pydriver and apache
Message-ID: <3A6644D5.6F0FB794@userfriendly.net>

I am trying to get pydriver.py to run as a nsapi cgi using RedHat 7.0
Linux 2.2.16 apache 1.3.14 + mod_python webserver. I have this working
on linux/irix netscape enterprise server but not sure how to tell apache
to use pydriver as a cgi for all .py's

Any suggestions, help, comments would be GREATLY appreciated
Michael Weiner
Systems Administrator/Partner
The UserFriendly Network
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/x-pkcs7-signature
Size: 2626 bytes
Desc: S/MIME Cryptographic Signature
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20010117/46817411/smime-0003.bin
From msandin at hotmail.com  Thu Jan 18 08:08:53 2001
From: msandin at hotmail.com (Martin Sandin)
Date: Fri Jan  9 22:02:35 2004
Subject: [mod_python] 'import site' failed
Message-ID: <OE9xG1UrHgmqzWTY0YA0000096a@hotmail.com>

Hello!

I'm trying to get mod_python up running and have run into the same problem
on both Win98 systems I've attempted this feat on. This after following the
instruction provided to the best of my abilities. Apache starts giving the
following message:

'import site' failed; use -v for traceback
Apache/1.3.12 (Win32) mod_python/2.6.3 Python/2.0 running...
'import site' failed; use -v for traceback

and then returning "internal server error" on the URLs pointing to Python
files. I've tracked dow that error message as something that
Python emitts. Thus given I'll ask this:

What does that error message mean? What has gone wrong? How can I fix it in
general? And if anyone knows, how can it be fixed in this particular case?



Configuration is as follows:

Apache 1.3.12 installed in c:\program\servers\apache\

mod_python.dll (for Python2.0) in the modules\ directory


In the httpd.conf file I've got the following lines where appropriate:

LoadModule python_module modules/mod_python.dll

DocumentRoot "C:/Data/Httpserver"

<Directory "C:/Data/Httpserver/python/">
AddHandler python-program .py
PythonHandler test
PythonDebug on
</Directory>


Python (2.0) itself resides in
C:\dev\Python20
which is also in the PATH. No PYPATH variable exists.

The mod_python directory, as extracted from the distribution located in
either of these (I've tried a bunch due to mod_pythons installation
instructions not being up to sync with the dist. archive)
C:\dev\Python20\mod_python\
C:\dev\Python20\lib\mod_python\
C:\dev\Python20\lib\python\mod_python\
C:\dev\Python20\lib\mod_python\python\mod_python\
etc.

The mod_python-2.6.4 directory has been similarly moved around (does it
matter at all?).


As a last piece of information, on the other machine I tried I used the
exact same (save some paths) configuration but with the latest (as of this
morning) versions of mod_python and Apache. The exact same problem.

THanks:-)


-
Martin Sandin
come.to/vague

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010118/0925d74b/attachment-0003.htm
From hunter at userfriendly.net  Thu Jan 18 07:34:59 2001
From: hunter at userfriendly.net (hunter)
Date: Fri Jan  9 22:02:35 2004
Subject: [mod_python] mod_python and apache
Message-ID: <3A66E2F3.CC212E4F@userfriendly.net>

I wrote to the list the other day, asking about converting a webserver
currently using Netscape Enterprise Server and python-1.5.2c to apache
running mod_python and python-1.5.2c due to the licensing being cost
probihitive. We use the "py-driver" within the webserver as nsapi to
push all our .py/.pd/.pc files to the users with netscape configured as
follows:

<snip>
<Object name="default">
NameTrans fn="pfx2dir" from="/cgi-bin"
dir="/disk2/websites/american/cgi-bin" na
me="cgi"
NameTrans fn="document-root" root="/disk2/websites/american/html"
PathCheck fn="unix-uri-clean"
PathCheck fn="check-acl" acl="default"
PathCheck fn="find-pathinfo"
PathCheck fn="find-index" index-names="index.pd"
ObjectType fn="type-by-extension"
ObjectType fn="force-type" type="text/plain"
Service method="(GET|HEAD|POST)" type="magnus-internal/py-driver"
fn="query-hand
ler" path="/disk2/ns-home/nsapi/pd/py-driver"
Service method="(GET|HEAD)" type="magnus-internal/imagemap"
fn="imagemap"
Service method="(GET|HEAD)" type="magnus-internal/directory"
fn="index-common"
Service method="(GET|HEAD|POST)" type="*~magnus-internal/*"
fn="send-file"
</snip>

which basically treats all calls to the .py/.pds as a cgi. Now, in
trying to convert over to apache and mod_python and do the same thing
within the apache configuration is where i am getting a bit confused. I
read through some of the documentation and i think the cgihandler might
be the way to handle this, but thought i would ask more senior python
programmers. I am a systems administrator and nowhere near as
experienced in python as 99% of the group here. So, i am looking for
advice and suggestions to see if a "proof of concept" can even be done.
I realize this might include some python module re-writes but if thats
fairly minimal i am still one step ahead rather than using netscape.

The py-driver being called in the above configuration looks like the
following:

#!/usr/local/bin/python
import sys, os
sys.path.insert(0, '/disk2/ns-home/nsapi/pd/')
sys.path.insert(1, '/disk2/common/')
sys.path.insert(2, '/disk2/ns-home/nsapi/mp/')
import pydriver
pydriver.topmain()

which imports pydriver which looks like the following:

#!/usr/local/bin/python
# -*- Python -*-
# PythonDriver main interpreter
#
# 960701 JM added HTML header override (ie: cookies)
#
# 960618 JM added Advert class
#

# common object layer imports
from col.exception.bopageflagexception import BOPageFlagException

# other imports
import pccache

__version__ = "1.5"

PD_Okay  = "PD_Okay"                    # JM 960830

intSybFailFrac = 100      # one out of this number of sybase connect
fails will$

def pd_return(msg=''):
    raise PD_Okay, msg


def get_func(dict, name):
    if dict.has_key(name):
        cb = dict[name]
        if `type(cb)` == "<type 'function'>":
            return cb
    return None


class SmartPrint:
    def __init__(self, real_stdout, headers=''):
        self.need_headers = 1
        self.headers = headers
        self.real_stdout = real_stdout

##     def write(self, msg):
##      if self.need_headers:
##          try:
##              self.real_stdout.write(self.headers.show() + '\n')
##          except AttributeError:              ## XXXX
##              self.real_stdout.write(self.headers)

##      self.real_stdout.write(msg)
##      self.need_headers = 0



# JM 960517
#
#
def get_hostip(environ):
    try:
        return 'IP:' + environ['REMOTE_ADDR']
    except KeyError:
        return  'IP:unknown'                    # XX ugh

def dump(environ=None):
    if not environ:
        from os import environ

    list = environ.keys()
    list.sort()

    for k in list:
        print "<b>%s</b> %s<BR>" % (k, environ[k])

# JM 960708
# use the cookie class to get the session ID, or return ''
#

def get_sessionid(cookiedict):
    if cookiedict.has_key('ngs_sessionID'):
        #
        # Netsite: NGS session-id stuff installed
        #
        return cookiedict['ngs_sessionID'][:12]

    elif cookiedict.has_key('Apache'):
        #
        # Apache: mod_cookie installed + enabled
        #
        return cookiedict['Apache']

    else:
        #
        # no session-id thing
        #
        return ''


### if session ID not given,
### use client's IP address (XX debugging only!)
### JM 960517
##    if environ.has_key('HTTP_COOKIE'):
##      s = environ['HTTP_COOKIE'] # like "ngs_sessionID=23233885"
##
##      if 'ngs_sessionID=' == s[:14]:
##          s = s[14:14+12]
##      else:
##          s = get_hostip(environ)     # XX no session id: error here?
##
##    else:
##      # dump(environ)
##      s = get_hostip(environ)         # XX no session id: error here?
##
##    return s


def file_exists(path):
    try:
        open(path).close()
        return 1
    except IOError:
        return 0
# Figure out a few things about what will happen, and put
# a few extra things in the Python search path.
#
# - take the original PD script path (ie:
'/www/test/htdocs/Tests/if.pd')
#   (usually from the webserver's PATH_TRANSLATED variable).
#
# - turn it into the Python script path ('/www/test/htdocs/Tests/if.py')
#   and then containing directory ('/www/test/htdocs/Tests/').
#
# - insert the PD directory in sys.path, so that PD support files
#   (like 'cookie' and 'agent') will be found, and wont be overridden
#   by user app files.
#
# - chdir to the user's script directory, so that app-local files
#   can be found (sys.path contains '.') and written files will
#   be relative to the script.
#

def script_setup(path):

    import os, sys, string

    if os.path.isdir(path):
        if path[-1]!='/': path=path+'/'
        path=path+'index.pd'

    # replaced following line with a substitution to stop pydriver from
    # displaying the py code when the URL has a .py.  Set it back to .pd
    # -MC 8/6/99
    if path[-3:] == ".py":
       path = path[:-3] + ".pd"
       if os.environ.has_key('PATH_TRANSLATED'):
          os.environ['PATH_TRANSLATED'] = path

    templatepath = path
    scriptpath = path[:-2] + "py"
    scriptdir  = path[:string.rfind(path, '/')]
    pc_path    = path[:-2] + "pc"

    # make sure the PythonDriver dir is first on the path.
    # (1st, else 'cookie.py' was being overridden)
    # JM 961006
    # commented out. py-driver now puts this at front of path.
    # Mark Cain
    #sys.path.insert(0, os.getcwd())

    # raise KeyError, "vars=" + `locals()`

    sys.path.append(scriptdir)
    os.chdir(scriptdir)                 # JM 960827

    return (templatepath, scriptpath, pc_path, scriptdir)


# allow project information to be overridden by the user,
# either by 'project.py' in the script directory,
# or in the one just above (XX provide search-path?)
#

def import_project(pathlist=['.'], modnamelist=['project']):
    from uniondict import UnionDict

    info     = UnionDict()                      # union of all info
dicts
    project  = UnionDict()                      # union of *modules*
    mod_dict = {}                               # temporary variable
scope

    for file in modnamelist:

        # load the module
        #
        exec   "import "+file in mod_dict
        module = mod_dict[file]

        # add the module to the UnionDict,
        # so that its functions *override* earlier ones
        #
        project.prepend(module.__dict__)

        # add the 'info' dictionaries
        # so that just-loaded defs *override* earlier ones
        #
        if module.__dict__.has_key('info'):
            info.prepend(module.__dict__['info'])

    project.info = info
    return project


def html_print_techproblems():
#    print "Location: http://162.133.26.95/goo.po"
#    print "Content-length: 1"
#    print "\n\n"
#    import traceback
#    html_print_exc(traceback)
    try:
      import socket
      filNF = open('/disk2/flags/techproblems.html', 'r')
      print filNF.read() % socket.gethostname()
      filNF.close()
    except:
      print """
           <table><tr>
           <td align="center" width="312">
           <img src="/images/banner.gif" width=312 height=45 border=0
alt="" al$
           </td></tr></table>
            """
      print "<br><font size=+3><b>We're sorry.</b>"
      print "<p>We are repairing a technical problem. We apol$

def html_print_notfound(message=''):
    print "Content-type: text/html\n\n"
    try:
      filNF = open('/disk2/flags/notfound.html', 'r')
      print filNF.read()
      filNF.close()
      filNF.close()
    except:
      print """
           <table><tr>
           <td align="center" width="312">
           <img src="/images/banner.gif" width=312 height=45 border=0
alt="" al$
           </td></tr></table>
            """
      print "<br><font size=+3><b>Not Found</b></font>"
      print "<p>The requested file does not exist on our website."

def html_print_exc(traceback):
    import sys

    print "Content-type: text/html\n"
    print "<font size=+3><b>internal error</b></font><P><PRE>",
    traceback.print_exc(file=sys.stdout)
    print "</PRE>"
def cgi_main():
    import os, traceback

    if not os.environ.has_key('PATH_TRANSLATED'):
        print "Content-type: text/html\n"
        print "PATH_TRANSLATED not given"
        return

    try:
        main(os.environ['PATH_TRANSLATED'], os.environ)

    except IOError, msg:
        html_print_notfound(msg)
        print "<!--"
        html_print_exc(traceback)
        print "-->"
    except:
        html_print_techproblems()
        print "<!--"
        html_print_exc(traceback)
        print "-->"


def updatePC(pd_path, py_path, pc_path):
  import os, codetemplate, time
  dicPC = {}

  # get stats on files
  try:
    tupPD = os.stat(pd_path)
    tupPY = os.stat(py_path)
    try:
    try:
      tupPC = os.stat(pc_path)
    except:
      tupPC = None
  except:
    raise IOError, "not found"

  try:
    # if pc file doesn't exist, or is older than either of the others,
then rec$
    if (not tupPC or (tupPD[-2] > tupPC[-2]) or (tupPY[-2] >
tupPC[-2])):
      pd_script = codetemplate.PD_Script(pd_path)
      codPD = pd_script.code
      dicPdVars = pd_script.dicPdVars
      filTemp = open(py_path)
      codPY = compile(filTemp.read(), py_path, "exec")
      filTemp.close()
      dicPC = { 'py': codPY,
                'pd': codPD,
                'dicPdVars': dicPdVars,
                'pyDate': time.asctime(time.localtime(tupPY[-2])),
                'pdDate': time.asctime(time.localtime(tupPD[-2])),
                'pcDate': time.asctime(time.localtime(time.time()))
              }
      import marshal
      try:
        filPC = open(pc_path, 'w')
        marshal.dump(dicPC, filPC)
        filPC.close()
      except IOError:
        return
  except:
      #
      # since this function runs outside of normal execution (as in
production)
      # we add traceback error handling here. Else errors don't
propigate on th$
      # normal route, having failed at this early point.
      #
      import sys, traceback
      pd_except(py_path, sys.exc_type, sys.exc_value,
                        tb=traceback, globals=globals())
      #
      # Furthermore, no headers have been printed yet and "main"
execution is b$
      # We need the basic header printed here.
      #
      #print "Content-type: text/html\n\n"
      #
      # Stop further execution by raising an error. Brings us back to
cgi-main $
      # screen
      #
      raise "Failed"


def main(templatepath, environ=None):

    import sys, string, cgi, os, traceback, ctsybase

    dicPC = {}        # dictionary containing pd and py code objects
    blnInterpSrc = 0
    blnTechProb  = 0   # to note problem deserving of "tech problem"
message

    if not environ:
        environ=os.environ

    (pd_path, py_path, pc_path, scriptdir) = script_setup( templatepath
)

    if ((len (pd_path) > 13) and (pd_path[-13:] == "html/index.pd")):
        import posixpath
        HOMEFILE = '/disk2/flags/homelive.html'
        if posixpath.exists(HOMEFILE) == 0:
            import homedown
            print homedown.pageVar
            return

    import marshal, codetemplate, agent


    # get the 'project' module, but allow
    # it to be overidden (unlike all other modules. Ex: cookies.py)
    #
    project = import_project(scriptdir)

    from headers import Headers

    # ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    # run-time stuff
    # ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    finished   = 0
    headers    = Headers(environ)
    # print "info = " + `project.info`
    if project.info.has_key('cookie_domain'):
        headers.cookieSetDomain(project.info['cookie_domain'])

    session_id = get_sessionid(headers.cookie)


    # grab form variables
    #
    try:
        #          Old and outdated
        if not os.environ.has_key('QUERY_STRING'):
           os.environ['QUERY_STRING'] = ""
        webvars = cgi.SvFormContentDict(environ=os.environ)
        #webvars.__init__(os.environ)
        #webvars = cgi.FieldStorage()
    except:
        webvars = {}


    # grab Python global variables
    # XXX?
    script_dict = globals()

    # rename a few variables
    #

    # XX
    sp = SmartPrint(sys.stdout, headers)


    script_dict.update({
             'environ'    : environ,
             'session_id' : session_id,
             'webvars'    : webvars,
             'headers'    : headers,
             'scriptpath' : py_path,
             'project'    : project,
             'agent'      : agent.open(environ)
             })

    for k in ['dbopen', 'pd_except']:
        if project.has_key(k):
            script_dict[k] = project[k]

    # XX removed 961006 JM
    # 'agent'      : agent.open(environ),
    # 'advert'     : Advert(),
    # merge globals and other vars into one dictionary
    #
    #for k in dict2.keys():
#       script_dict[k] = dict2[k]
#
#    del dict2                          # dont need it anymore


    # try to execute the Python script.
    #

    # call updatePC to compile pd and py file and write to pc file
    # (do not call in production)
    #updatePC(pd_path, py_path, pc_path)

    try:
      if (sys.modules.has_key('pccache')):
        pccache = sys.modules['pccache']
        dicPC = pccache.load(pc_path)
      else:
        filPC = open(pc_path, 'r')
        dicPC = marshal.load(filPC)
        filPC.close()

    except IOError:
      pd_script = codetemplate.PD_Script(pd_path)
      blnInterpSrc = 1   # was unable to open compiled. Must interp.
    else:
      # load successful
      # create "empty" PD_Script object and set its code object (no
processing $
      pd_script = codetemplate.PD_Script()
      pd_script.code = dicPC['pd']
      if dicPC.has_key('dicPdVars'):
        pd_script.dicPdVars = dicPC['dicPdVars']
    script_dict['dicPdVars'] = pd_script.dicPdVars

    try:
      try:
          try:
            import pycodewrap
            pycodewrap.begin(script_dict)
          except BOPageFlagException, objException:
            raise objException
          except:
            pass
          if (blnInterpSrc):
            f = open(py_path)
            exec f in script_dict  # old
            f.close()
          else:
            exec (dicPC['py'] , script_dict) # new
          try:
            pycodewrap.end(script_dict)
          except:
            pass

      except PD_Okay, msg:
          # XX print msg somewhere?
          pass

      # catch and ignore broken pipe errors
      except IOError, lstErr:
        if lstErr[1] == 'Broken pipe':
          pass
        else:
          raise lstErr
      except ctsybase.error, lstErr:
        if lstErr[0] == 'failed to connect to server':
          blnTechProb = 1
          import time
          fltTime = time.time()
          intTemp = int (( int(fltTime) + ((fltTime - int(fltTime)) *
10000)) %$
          if intTemp == 0:
            raise ctsybase.error + ": " + str(lstErr)
          else:
            pass
            #raise "sybase error"

      # catch BOPageFlagException to throw up alternate page
      except BOPageFlagException, objException:
          blnTechProb = 0
          finished = 1                # XX run PD script after error
          if sp.need_headers:

              # was >> print "Content-type: text/html\n"

              try:
                  print script_dict['headers'].show()
              except AttributeError:
                  print script_dict['headers']

          # headers were printed -- turn them off
          #
          sp.need_headers = 0

          try:
            filT = open(objException.strFile, 'r')
            strText = filT.read()
            filT.close()
         except IOError:
            objT = IOError("BOPageFlagException, can't open file '%s'" %
objExc$
            raise objT
          if objException.dicVariables:
            strText = strText % objException.dicVariables
          print strText

          # if objException.blnTraceback is true, then do the traceback
anyhow
          if objException.blnTraceback:
            # does PY script have a custom exception handler?
            # if so, use it; else use default: 'pd_except'.
            #
            cb = get_func(script_dict, '__except__')
            if not cb:
                cb = pd_except

            finished = not cb(py_path, sys.exc_type, sys.exc_value,
                              tb=traceback, globals=globals())
    # catch all for tracebacks
    except:
        blnTechProb = 1
        finished = 0                # XX run PD script after error

        if sp.need_headers:

            # was >> print "Content-type: text/html\n"

            try:
                print script_dict['headers'].show()
            except AttributeError:
                print script_dict['headers']

        # headers were printed -- turn them off
        #
        sp.need_headers = 0

        # does PY script have a custom exception handler?
        # if so, use it; else use default: 'pd_except'.
        #
        cb = get_func(script_dict, '__except__')
        if not cb:
            cb = pd_except

        finished = not cb(py_path, sys.exc_type, sys.exc_value,
                          tb=traceback, globals=globals())


    #f.close()


    # did the PY script take care of everything? (IE: file download,
    # exception handler doesnt want to show PD).
    # If so, then just return -- *dont* execute PD script.
    # JM 960829

    if blnTechProb:
       if sp.need_headers:
           # was >> print "Content-type: text/html\n"
           try:
               print script_dict['headers'].show()
           except AttributeError:
               print script_dict['headers']
       html_print_techproblems()
       print "<!-- "
       html_print_exc(traceback)
       print "--> "
       return
    if finished or script_dict['headers'].finished():
        return


    # go ahead and print out HTTP headers now.
    # if its whacked, just default it:
    #
    if sp.need_headers:
        try:
            print script_dict['headers'].show()
            #print ' *** ' + dict['headers'].show() + ' *** '
        except AttributeError:
            print script_dict['headers']

    try:
      print pd_script.run(script_dict)
    # catch and ignore broken pipe errors
    except IOError, lstErr:
      if lstErr[1] == 'Broken pipe':
        pass
      else:
        raise lstErr

    except:
      import sys, traceback
      pd_except(py_path, sys.exc_type, sys.exc_value,
                        tb=traceback, globals=globals())
      html_print_techproblems()
      print "<!-- "
      html_print_exc(traceback)
      print "--> "

    return
def topmain():
    import os, sys, posixpath

    SFILE = '/disk2/flags/dblive.html'
    error = ""
    if posixpath.exists(SFILE) == 0:
        import dbdown
        pageVar = dbdown.pageVar
        error = "DBBAD"

    if error:
        print pageVar
    elif os.environ.has_key('PATH_TRANSLATED'):
        import traceback
        try:
            cgi_main()
        except:
            print "<font size=+1>%s: problems</font><P>" %
"PythonDriver"

            print "<PRE>",
            traceback.print_exc()
            print "</PRE>"

    elif len(sys.argv) > 1:

        import string

        scriptpath = sys.argv[1]

        os.environ['REQUEST_METHOD'] = 'GET'
        os.environ['QUERY_STRING']   = string.joinfields( sys.argv[2:],
'&' )

        main(scriptpath, os.environ)
    else:

        print "usage: py-driver <script> [GET-style args...]"

if __name__=="__main__":
    main()


Any help would be GREATLY appreciated. I just need to mimic the netscape
behavior within apache, and i am having problems doing so. Maybe
mod_python isnt the way to go, but if anyone has any ideas for me to
try, i would be extremely greatful

Michael Weiner
Systems Administrator/Partner
The UserFriendly Network
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/x-pkcs7-signature
Size: 2626 bytes
Desc: S/MIME Cryptographic Signature
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20010118/51182ff7/smime-0003.bin
From GManoj at chn.cognizant.com  Thu Jan 18 20:14:53 2001
From: GManoj at chn.cognizant.com (Govindan, Manoj (CTS))
Date: Fri Jan  9 22:02:35 2004
Subject: [mod_python] Need help: Apache, Win NT and Dr Watson error
Message-ID: <697D1663ABD6D1119D880060B0B5456302B78683@ctsinwcbsxua>

> Hi,
> I need help for the following topic.
> I am using Apache 1.3.9 with mod_python 2.7.
> While running a DB accessing script with apache, Win NT *sometimes*
> reporting Dr. Watson error for apache.
> This does not happen always.
> I have set two directories as follows in the config file
> <Directory "f:/site/html/python">
>    AddHandler python-program .py           
>    PythonHandler feedback
>    PythonDebug on
> </Directory>
> 
> <Directory "f:/site/html/test">
>    AddHandler python-program .py           
>    PythonHandler guestbook::gbook
>    PythonDebug on
> </Directory>
> 
> The error comes occasionally for both the scripts.
> 
> Thanks
> Manoj
> 
> 

This e-mail and any files transmitted with it are for the sole use of the intended recipient(s) and may contain confidential and privileged information.
If you are not the intended recipient, please contact the sender by reply e-mail and destroy all copies of the original message. 
Any unauthorised review, use, disclosure, dissemination, forwarding, printing or copying of this email or any action taken in reliance on this e-mail is strictly 
prohibited and may be unlawful.

		Visit us at http://www.cognizant.com


From Stephane.Bidoul at softwareag.com  Thu Jan 18 17:30:29 2001
From: Stephane.Bidoul at softwareag.com (Bidoul, Stephane)
Date: Fri Jan  9 22:02:35 2004
Subject: [mod_python] Need help: Apache, Win NT and Dr Watson error
Message-ID: <C23163F98473D311874C0008C7E621070499C14E@daemsg02.software-ag.de>

mod_python on NT is multithreaded.
A problem might be that some global data
in your script is not protected by a mutex,
and is accessed by concurrent requests.

This is only a wild guess however: you will need to 
provide more details about your scripts if
you need more help.

Best regards.

-Stephane

> -----Original Message-----
> From: Govindan, Manoj (CTS) [mailto:GManoj@chn.cognizant.com]
> Sent: 18 January, 2001 15:45
> To: 'mod_python@modpython.org'
> Subject: [mod_python] Need help: Apache, Win NT and Dr Watson error
> 
> 
> > Hi,
> > I need help for the following topic.
> > I am using Apache 1.3.9 with mod_python 2.7.
> > While running a DB accessing script with apache, Win NT *sometimes*
> > reporting Dr. Watson error for apache.
> > This does not happen always.
> > I have set two directories as follows in the config file
> > <Directory "f:/site/html/python">
> >    AddHandler python-program .py           
> >    PythonHandler feedback
> >    PythonDebug on
> > </Directory>
> > 
> > <Directory "f:/site/html/test">
> >    AddHandler python-program .py           
> >    PythonHandler guestbook::gbook
> >    PythonDebug on
> > </Directory>
> > 
> > The error comes occasionally for both the scripts.
> > 
> > Thanks
> > Manoj
> > 
> > 
> 
> This e-mail and any files transmitted with it are for the 
> sole use of the intended recipient(s) and may contain 
> confidential and privileged information.
> If you are not the intended recipient, please contact the 
> sender by reply e-mail and destroy all copies of the original 
> message. 
> Any unauthorised review, use, disclosure, dissemination, 
> forwarding, printing or copying of this email or any action 
> taken in reliance on this e-mail is strictly 
> prohibited and may be unlawful.
> 
> 		Visit us at http://www.cognizant.com
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 

From grisha at ispol.com  Thu Jan 18 14:17:07 2001
From: grisha at ispol.com (Gregory Trubetskoy)
Date: Fri Jan  9 22:02:35 2004
Subject: [mod_python] Need help: Apache, Win NT and Dr Watson error
In-Reply-To: <697D1663ABD6D1119D880060B0B5456302B78683@ctsinwcbsxua>
Message-ID: <Pine.LNX.4.21.0101181416100.7384-100000@saturn.ispol.com>

You don't specify which database yu're using, but some Windows database
ODBC drivers are not thread safe and can crash when used with
multithreaded applications like apache.


On Thu, 18 Jan 2001, Govindan, Manoj (CTS) wrote:

> > Hi,
> > I need help for the following topic.
> > I am using Apache 1.3.9 with mod_python 2.7.
> > While running a DB accessing script with apache, Win NT *sometimes*
> > reporting Dr. Watson error for apache.
> > This does not happen always.
> > I have set two directories as follows in the config file
> > <Directory "f:/site/html/python">
> >    AddHandler python-program .py           
> >    PythonHandler feedback
> >    PythonDebug on
> > </Directory>
> > 
> > <Directory "f:/site/html/test">
> >    AddHandler python-program .py           
> >    PythonHandler guestbook::gbook
> >    PythonDebug on
> > </Directory>
> > 
> > The error comes occasionally for both the scripts.
> > 
> > Thanks
> > Manoj
> > 
> > 
> 
> This e-mail and any files transmitted with it are for the sole use of the intended recipient(s) and may contain confidential and privileged information.
> If you are not the intended recipient, please contact the sender by reply e-mail and destroy all copies of the original message. 
> Any unauthorised review, use, disclosure, dissemination, forwarding, printing or copying of this email or any action taken in reliance on this e-mail is strictly 
> prohibited and may be unlawful.
> 
> 		Visit us at http://www.cognizant.com
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From klindsay at mkintraweb.com  Thu Jan 18 18:38:36 2001
From: klindsay at mkintraweb.com (Kevin Lindsay)
Date: Fri Jan  9 22:02:35 2004
Subject: [mod_python] Exiting gracefully...
Message-ID: <20010118183836.D22268@mkintraweb.com>

How does one exit from a script called from mod_python?

As an example, I am in the middle of a function and I want
to call an error function and have the script stop as if it
had returned from the handler function wth 'return apache.OK'

I can't seem to find anything in the docs, unless I'm 
missing something.

Any help is appreciated. :)

------------------------------------------------
Kevin Lindsay <klindsay@debian.org>
Debian Developer
81E 58A3 B49A 580E EE3D 8CF0 519A 55F0 746C 51F4

From klindsay at mkintraweb.com  Thu Jan 18 19:16:17 2001
From: klindsay at mkintraweb.com (Kevin Lindsay)
Date: Fri Jan  9 22:02:35 2004
Subject: [mod_python] Reload strangeness
Message-ID: <20010118191617.A24258@mkintraweb.com>

I'm just curious if there is any known reason why when I hit the
reload button in netscape it sometimes loads my script and other
times, without changing any code I get this:

Mod_python error: "PythonHandler gr_main" Traceback (most recent 
call last): File "/usr/lib/python2.0/site-packages/mod_python/apache.py",
line 180, in Dispatch object = resolve_object(self.req, module, object_str,
silent) File "/usr/lib/python2.0/site-packages/mod_python/apache.py", line
396,in resolve_object raise AttributeError, s AttributeError: module 
'/var/www/geekreview/new2/gr_main.py' contains no 'handler' [an error 
occurred while processing this directive]

-----------------------------------------------------------------------
 Kevin Lindsay                  | "Storm Linux, Taking Linux by Storm!"
 Stormix Technologies Inc.      | http://www.stormix.com/
 Chief Technology Officer (CTO) | 
-----------------------------------------------------------------------

From grisha at ispol.com  Thu Jan 18 22:48:25 2001
From: grisha at ispol.com (Gregory Trubetskoy)
Date: Fri Jan  9 22:02:36 2004
Subject: [mod_python] Exiting gracefully...
In-Reply-To: <20010118183836.D22268@mkintraweb.com>
Message-ID: <Pine.LNX.4.21.0101182247000.8591-100000@saturn.ispol.com>

You can always raise an error if you need to exit immeditely:

raise apache.SERVER_ERROR, apache.HTTP_FORBIDDEN

or something like that.

--
  Gregory (Grisha) Trubetskoy
       grisha@ispol.com

On Thu, 18 Jan 2001, Kevin Lindsay wrote:

> How does one exit from a script called from mod_python?
> 
> As an example, I am in the middle of a function and I want
> to call an error function and have the script stop as if it
> had returned from the handler function wth 'return apache.OK'
> 
> I can't seem to find anything in the docs, unless I'm 
> missing something.
> 
> Any help is appreciated. :)
> 
> ------------------------------------------------
> Kevin Lindsay <klindsay@debian.org>
> Debian Developer
> 81E 58A3 B49A 580E EE3D 8CF0 519A 55F0 746C 51F4
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From grisha at ispol.com  Thu Jan 18 22:51:35 2001
From: grisha at ispol.com (Gregory Trubetskoy)
Date: Fri Jan  9 22:02:36 2004
Subject: [mod_python] Reload strangeness
In-Reply-To: <20010118191617.A24258@mkintraweb.com>
Message-ID: <Pine.LNX.4.21.0101182248290.8591-100000@saturn.ispol.com>

It means that '/var/www/geekreview/new2/gr_main.py' contains no function
called handler.

But sometimes in rare cases when you do a lot of editing/development and
config changes, the Python interpreters in some apache processes may end
up being a bit confused as to what's going on, so you just have to restart
apache.

--
  Gregory (Grisha) Trubetskoy
       grisha@ispol.com

On Thu, 18 Jan 2001, Kevin Lindsay wrote:

> I'm just curious if there is any known reason why when I hit the
> reload button in netscape it sometimes loads my script and other
> times, without changing any code I get this:
> 
> Mod_python error: "PythonHandler gr_main" Traceback (most recent 
> call last): File "/usr/lib/python2.0/site-packages/mod_python/apache.py",
> line 180, in Dispatch object = resolve_object(self.req, module, object_str,
> silent) File "/usr/lib/python2.0/site-packages/mod_python/apache.py", line
> 396,in resolve_object raise AttributeError, s AttributeError: module 
> '/var/www/geekreview/new2/gr_main.py' contains no 'handler' [an error 
> occurred while processing this directive]
> 
> -----------------------------------------------------------------------
>  Kevin Lindsay                  | "Storm Linux, Taking Linux by Storm!"
>  Stormix Technologies Inc.      | http://www.stormix.com/
>  Chief Technology Officer (CTO) | 
> -----------------------------------------------------------------------
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From gerhard at bigfoot.de  Fri Jan 19 08:04:49 2001
From: gerhard at bigfoot.de (Gerhard =?iso-8859-1?Q?H=E4ring?=)
Date: Fri Jan  9 22:02:36 2004
Subject: [mod_python] Need help: Apache, Win NT and Dr Watson error
References: <697D1663ABD6D1119D880060B0B5456302B78683@ctsinwcbsxua>
Message-ID: <3A67E711.93531CC5@bigfoot.de>

I would upgrade to Apache 1.3.14. This solved a thread-related problem
for me.

Gerhard

"Govindan, Manoj (CTS)" wrote:
> 
> > Hi,
> > I need help for the following topic.
> > I am using Apache 1.3.9 with mod_python 2.7.
> > While running a DB accessing script with apache, Win NT *sometimes*
> > reporting Dr. Watson error for apache.
> > This does not happen always.
> > I have set two directories as follows in the config file
> > <Directory "f:/site/html/python">
> >    AddHandler python-program .py
> >    PythonHandler feedback
> >    PythonDebug on
> > </Directory>
> >
> > <Directory "f:/site/html/test">
> >    AddHandler python-program .py
> >    PythonHandler guestbook::gbook
> >    PythonDebug on
> > </Directory>
> >
> > The error comes occasionally for both the scripts.

-- 
contact: g e r h a r d @ b i g f o o t . d e
web:     http://highqualdev.com

From jym_brittain at hotmail.com  Fri Jan 19 17:11:18 2001
From: jym_brittain at hotmail.com (James Brittain)
Date: Fri Jan  9 22:02:36 2004
Subject: [mod_python] compiling problems
Message-ID: <LAW2-F1308k69RKLpgT00002acc@hotmail.com>

Does anyone have any experience compiling mod_python in SuSE 7.0? I'm 
getting some strange errors
_________________________________________________________________
Get your FREE download of MSN Explorer at http://explorer.msn.com


From klindsay at mkintraweb.com  Fri Jan 19 13:27:00 2001
From: klindsay at mkintraweb.com (Kevin Lindsay)
Date: Fri Jan  9 22:02:36 2004
Subject: [mod_python] EAPI
Message-ID: <20010119132700.I24258@mkintraweb.com>

Apache 1.3.14 in Debian (unstable) required EAPI to be compiled into
its DSO modules.  There is nothing in the mod python docs regarding
EAPI. Will this affect anything? Doesn't seem to be.

BTW, I will be packaging modpython and maintaining it for Debian. :)

------------------------------------------------
Kevin Lindsay <klindsay@debian.org>
Debian Developer
81E 58A3 B49A 580E EE3D 8CF0 519A 55F0 746C 51F4


From msandin at hotmail.com  Mon Jan 22 09:45:02 2001
From: msandin at hotmail.com (Martin Sandin)
Date: Fri Jan  9 22:02:36 2004
Subject: [mod_python] mod_python on Win98
Message-ID: <F149y3rB07XOq3JkrKd000058a8@hotmail.com>

Hello!

I'll renew my request for help with this mail. I hope I'm no rude, but I'd 
really like to evaluate the possibility of using Apache/mod_python for 
running parts of a system the company I work at use.

When I add mod_python.dll (for Python 2.0) to the modules/ directory in 
apache, and have the Python20 directory in the PATH env variable, and add a 
LoadModule directive to Apache's httpd.conf with no other mod_python 
references I get the following error on startup of Apache:

"'import site' failed; use -v for traceback"


When configuring apache as suggested in the mp docs I also get the following 
in errors.log when trying to access that URL:

"python_handler: make_obcallback returned no obCallBack!"


Have the exact same behavior on two separate Win98 machines, with the latest 
versions of Apache 1.3 and mod_python. Is there any help available or should 
I just give up on using mod_python? =(


-
Martin
come.to/vague
_________________________________________________________________________
Get Your Private, Free E-mail from MSN Hotmail at http://www.hotmail.com.


From davidc at downright.com  Mon Jan 22 10:19:31 2001
From: davidc at downright.com (David Cohen)
Date: Fri Jan  9 22:02:36 2004
Subject: [mod_python] Installing on RH7.0
Message-ID: <NCBBLAIKFCKAJGLOGAHPGEAGCKAA.davidc@downright.com>

After a long, long weekend, I've crashed and burned attempting to install mod_python on RH7.0 (with all RHN updates).

The RPM install failed by rendering httpd unstartable (instant death with no apparent reason). Commenting out the LoadModule and AddModule lines for mod_python gets httpd working again in its original state).

Has anyone successfully installed via the RPM? Furthermore, can this RPM be used with python 2.0 (my desired platform)?

If not successful with RPM, has anyone successfully installed from source on RH7.0 w/python 2.0?

Thanks!

David Cohen
VP/CTO
Downright Software LLC
18227-D Flower Hill Way, Gaithersburg, MD 20879
voice: 301.948.4030

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20010122/adff5a30/attachment-0003.htm
From mike at mikebell.org  Mon Jan 22 16:16:41 2001
From: mike at mikebell.org (Mike Bell)
Date: Fri Jan  9 22:02:36 2004
Subject: [mod_python] Large req.writes prevent header from being outputted?
Message-ID: <20010122161641.E550@vaio.mikebell.org>

With my installation (mod_python 2.7.1 w/python 2.0), doing

  req.content_type = DetermineMimeType(filepath)
  req.send_http_header()
  myjpeg = open(filepath)
  req.write(myjpeg.read())

with a very large image (appears to be around 1/4MB) will result in an HTTP
transaction where no headers are outputted, just binary data. However,
something like

  req.content_type = DetermineMimeType(filepath)
  req.send_http_header()
  myjpeg = open(filepath)
  while 1:
    temp = myjpeg.read(65535)
    if temp == "":
      break
    req.write(temp)

will work just fine.

Presumably req.write should work for these large values, or at least raise
an exception rather than dropping data.

From sandor at cs.uu.nl  Tue Jan 23 12:27:41 2001
From: sandor at cs.uu.nl (Sandor Spruit)
Date: Fri Jan  9 22:02:36 2004
Subject: [mod_python] One question before I start experimenting with mod_python
Message-ID: <18519.010123@cs.uu.nl>

[Please note: I'm not a regular reader of this list. Please be so kind
to send any replies directly to me; I'll summarize to the list]

Hello list members,

I've just got one question: "do Python programs need to be
specifically tailored for use with mod_python, or should Python
CGI programs be able to run unmodified ?"

My guess is, that I need some sort of a "connector" to convert the
regular CGI parameters into Python interpreter parameters, and start
the interpreter on the appropriate script. I'd have to rewrite that
connector to make use of the mod_python facilities. Any additional
pitfalls that I don't see yet ?

TIA,
Sandor
-- 
ir A.G.L. Spruit, Utrecht University, the Netherlands
Institute of information and computing sciences
"There is a bit of magic in everything, and then some
loss to even things out" (from: Lou Reed, "Magic and Loss")



From grisha at ispol.com  Tue Jan 23 22:45:46 2001
From: grisha at ispol.com (Gregory Trubetskoy)
Date: Fri Jan  9 22:02:36 2004
Subject: [mod_python] Large req.writes prevent header from being outputted?
In-Reply-To: <20010122161641.E550@vaio.mikebell.org>
Message-ID: <Pine.LNX.4.21.0101232242260.3867-100000@saturn.ispol.com>

Mike - 

I'm not able to reproduce this. I just tried something similar with an 8Mb
file, and I get all the headers and data correctly.

Anyone else seeing this behaviour?

Could the problem be something with your client? I used wget -S to test my
results.

--
  Gregory (Grisha) Trubetskoy
       grisha@ispol.com

On Mon, 22 Jan 2001, Mike Bell wrote:

> With my installation (mod_python 2.7.1 w/python 2.0), doing
> 
>   req.content_type = DetermineMimeType(filepath)
>   req.send_http_header()
>   myjpeg = open(filepath)
>   req.write(myjpeg.read())
> 
> with a very large image (appears to be around 1/4MB) will result in an HTTP
> transaction where no headers are outputted, just binary data. However,
> something like
> 
>   req.content_type = DetermineMimeType(filepath)
>   req.send_http_header()
>   myjpeg = open(filepath)
>   while 1:
>     temp = myjpeg.read(65535)
>     if temp == "":
>       break
>     req.write(temp)
> 
> will work just fine.
> 
> Presumably req.write should work for these large values, or at least raise
> an exception rather than dropping data.
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From mike at mikebell.org  Tue Jan 23 20:56:14 2001
From: mike at mikebell.org (Mike Bell)
Date: Fri Jan  9 22:02:36 2004
Subject: [mod_python] Large req.writes prevent header from being outputted?
In-Reply-To: <Pine.LNX.4.21.0101232242260.3867-100000@saturn.ispol.com>; from grisha@ispol.com on Tue, Jan 23, 2001 at 10:45:46PM -0500
References: <20010122161641.E550@vaio.mikebell.org> <Pine.LNX.4.21.0101232242260.3867-100000@saturn.ispol.com>
Message-ID: <20010123205613.B9591@vaio.mikebell.org>

On Tue, Jan 23, 2001 at 10:45:46PM -0500, Gregory Trubetskoy wrote:
> 
> Mike - 
> 
> I'm not able to reproduce this. I just tried something similar with an 8Mb
> file, and I get all the headers and data correctly.

How odd...

> Could the problem be something with your client? I used wget -S to test my
> results.

I used telnet.


From afaby at mail.tenon.com  Thu Jan 25 14:26:35 2001
From: afaby at mail.tenon.com (Aaron Faby)
Date: Fri Jan  9 22:02:36 2004
Subject: [mod_python] mod_python + mod_php4 on Mac OS X w/ apache 1.3.14: no workie!
Message-ID: <ALS.HGW@tenon.com>

I get the following error when attempting to start apache 1.3.14 w/ 
mod_php4 and mod_python
on Mac OS X Public Beta:

dyld: /usr/sbin/apache multiple definitions of symbol _pcre_free
/System/Library/Apache/Modules/mod_python.so definition of _pcre_free
/System/Library/Apache/Modules/libphp4.so definition of _pcre_free

Any ideas?

--------------------------------------------------------------------------------------------------
Aaron Faby					                             Software Developer
Tenon Intersystems			         	                                
afaby@tenon.com
1123 Chapala Street			                                       
805-963-6983
Santa Barbara, CA 93103                                             
http://www.tenon.com
--------------------------------------------------------------------------------------------------

From ioseph at paolo.net  Sat Jan 27 06:40:03 2001
From: ioseph at paolo.net (Ioseph Kim)
Date: Fri Jan  9 22:02:36 2004
Subject: [mod_python] How use redirection in cgihandler?
Message-ID: <20010127064003.A4017@paolo.net>

Apache : 1.3.14
Python : 2.0
mod_python : 2.7.1

I maked a simple script a.py

print 'Location: /\n'

-------

but, this script did not work. -.-

> telnet localhost 80
Trying 127.0.0.1...
Connected to localhost.paolo.net.
Escape character is '^]'.
GET /~ioseph/python/a.py HTTP/1.0

HTTP/1.1 200 OK
Date: Fri, 26 Jan 2001 21:36:07 GMT
Server: Apache/1.3.14 (Unix) mod_python/2.7.1 Python/2.0
Location: /
Connection: close
Content-Type: text/plain

Connection closed by foreign host.

--------
in this case, HTTP Status code is 200. 

to url redirect, web server might to return http status code 302.

How I can use "Location:" header in cgihandler?


From john at coastalgeology.org  Sat Jan 27 10:24:05 2001
From: john at coastalgeology.org (Jonathan Pennington)
Date: Fri Jan  9 22:02:36 2004
Subject: [mod_python] Example sites
Message-ID: <20010127102405.A80697@coastalgeology.org>

I am currently researching to re-program a database-driven site from
PHP/MySQL to Python/PostgreSQL. My problem is that, although I'm a
fairly competent Python programmer, I haven't done any mod_python or
python web work at all. I learn by example. I have the mod_python
manual, but does anyone have a code suite from a Python driven site
that I could see? It's always better for me to read code than to
figure out how to do something from scratch. Thanks.

-J
-- 
Jonathan Pennington		| http://coastalgeology.org
Site Manager			| Protection and stewardship
CoastalGeology.Org (CGO)	| through public education.
john@coastalgeology.org		| Join CGO, make a difference.

From oddmund.mogedal at accenture.com  Tue Jan 30 20:36:08 2001
From: oddmund.mogedal at accenture.com (oddmund.mogedal@accenture.com)
Date: Fri Jan  9 22:02:36 2004
Subject: [mod_python] Problem writing to file from handler
Message-ID: <OF8332020C.21CD26E6-ON062569E5.000D2901@accenture.com>

Hi,

I need to write to a file from within a script (called using publisher.py).
For some reason, I am not allowed to write to the file, even though it
exists and has write permission for everyone.
(Yes, it is a security risk, but not in the environment where I will use
it.)

I have tried the same thing using the cgi module, and then I am allowed to
write to the file.
Is there a difference in access rights to the file system between a script
called from mod_python and a script called using CGI?

Does anybody know what is causing this problem?

Using mod_python: DOES NOT WORK
    import getpass

    def omtest(req, username, file):
        myfile = open("testom", 'wb')
        myfile.write(file)
        myfile.close()
        return "%s\n%d\n%s\n" % (username, len(file), getpass.getuser())

Using cgi: WORKS OK
    #!/usr/local/bin/python2.0

    import getpass
    import sys
    import cgi

    myfile = open("testom", 'wb')
    form = cgi.FieldStorage()
    name = form["name"].value
    file = form["file"].value
    myfile.write(file)

    print "Content-Type: text/html"
    print
    print name
    print getpass.getuser()




Oddmund



This message is for the designated recipient only and may contain
privileged or confidential information.  If you have received it in error,
please notify the sender immediately and delete the original.  Any other
use of the email by you is prohibited.



From grisha at ispol.com  Tue Jan 30 22:08:13 2001
From: grisha at ispol.com (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:02:36 2004
Subject: [mod_python] Problem writing to file from handler
In-Reply-To: <OF8332020C.21CD26E6-ON062569E5.000D2901@accenture.com>
Message-ID: <Pine.BSF.4.21.0101302201010.14374-100000@localhost>

The difference is the current directory. CGI scripts are executed with the
directory where the script is located as current, with mod_python the
current directory is undefined. You need to specify full path to your file
when opening it.

Grisha

On Tue, 30 Jan 2001 oddmund.mogedal@accenture.com wrote:

> Hi,
> 
> I need to write to a file from within a script (called using publisher.py).
> For some reason, I am not allowed to write to the file, even though it
> exists and has write permission for everyone.
> (Yes, it is a security risk, but not in the environment where I will use
> it.)
> 
> I have tried the same thing using the cgi module, and then I am allowed to
> write to the file.
> Is there a difference in access rights to the file system between a script
> called from mod_python and a script called using CGI?
> 
> Does anybody know what is causing this problem?
> 
> Using mod_python: DOES NOT WORK
>     import getpass
> 
>     def omtest(req, username, file):
>         myfile = open("testom", 'wb')
>         myfile.write(file)
>         myfile.close()
>         return "%s\n%d\n%s\n" % (username, len(file), getpass.getuser())
> 
> Using cgi: WORKS OK
>     #!/usr/local/bin/python2.0
> 
>     import getpass
>     import sys
>     import cgi
> 
>     myfile = open("testom", 'wb')
>     form = cgi.FieldStorage()
>     name = form["name"].value
>     file = form["file"].value
>     myfile.write(file)
> 
>     print "Content-Type: text/html"
>     print
>     print name
>     print getpass.getuser()
> 
> 
> 
> 
> Oddmund
> 
> 
> 
> This message is for the designated recipient only and may contain
> privileged or confidential information.  If you have received it in error,
> please notify the sender immediately and delete the original.  Any other
> use of the email by you is prohibited.
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From stanton at livsform.com  Wed Jan 31 03:23:08 2001
From: stanton at livsform.com (Stanton Schell)
Date: Fri Jan  9 22:02:36 2004
Subject: [mod_python] Python libraries install configuration issue
Message-ID: <B69D359B.AD45%stanton@livsform.com>

Hello All,

I have two (unrelated) questions:

1. I was unable to find a searchable version  of the archives - is there
one?

2. Am I forced to install the python libraries during the mod_python
installation into somewhere in /usr/local/lib or can I configure it somehow
to target another directory?  I am trying to install a non-root required
version and would like to stay away from common system areas.

-stanton schell
-- 

Stanton Schell
livsform design group
stanton@livsform.com
703-538-3491
703-989-6591


From stanton at livsform.com  Wed Jan 31 03:32:10 2001
From: stanton at livsform.com (Stanton Schell)
Date: Fri Jan  9 22:02:36 2004
Subject: [mod_python] Python libraries install configuration issue
In-Reply-To: <B69D359B.AD45%stanton@livsform.com>
Message-ID: <B69D37BA.AD47%stanton@livsform.com>

(In other words, I have my source tree and accompanying python libs in
user-owned directory and nothing is in /usr/local/lib at all...)

Thanks!!
-stanton schell
-- 

Stanton Schell
livsform design group
stanton@livsform.com
703-538-3491
703-989-6591

> From: Stanton Schell <stanton@livsform.com>
> Date: Wed, 31 Jan 2001 03:23:08 -0500
> To: <mod_python@modpython.org>
> Subject: [mod_python] Python libraries install configuration issue
> 
> Hello All,
> 
> I have two (unrelated) questions:
> 
> 1. I was unable to find a searchable version  of the archives - is there
> one?
> 
> 2. Am I forced to install the python libraries during the mod_python
> installation into somewhere in /usr/local/lib or can I configure it somehow
> to target another directory?  I am trying to install a non-root required
> version and would like to stay away from common system areas.
> 
> -stanton schell
> -- 
> 
> Stanton Schell
> livsform design group
> stanton@livsform.com
> 703-538-3491
> 703-989-6591
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From stanton at livsform.com  Wed Jan 31 04:14:07 2001
From: stanton at livsform.com (Stanton Schell)
Date: Fri Jan  9 22:02:36 2004
Subject: [mod_python] Python libraries install configuration issue
In-Reply-To: <B69D359B.AD45%stanton@livsform.com>
Message-ID: <B69D418F.AD48%stanton@livsform.com>

sorry for the numerous emails, but the problem has morphed...

I broke down and copied the libraries over to that directory and it was
still having a callback problem (I have pasted the error message in Apache's
error log below).  I then recompiled with the library directory in the
Makefile as the directory I wanted, everything installed, but this same
callback message came when running the test from the manual:

make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
[Wed Jan 31 03:03:16 2001]  [error]  [client 192.168.1.2] python_handler:
    make_obcallback returned no obCallBack!

any help would be appreciated :-)

cheers,
-stanton schell
-- 

Stanton Schell
livsform design group
stanton@livsform.com
703-538-3491
703-989-6591

> From: Stanton Schell <stanton@livsform.com>
> Date: Wed, 31 Jan 2001 03:23:08 -0500
> To: <mod_python@modpython.org>
> Subject: [mod_python] Python libraries install configuration issue
> 
> Hello All,
> 
> I have two (unrelated) questions:
> 
> 1. I was unable to find a searchable version  of the archives - is there
> one?
> 
> 2. Am I forced to install the python libraries during the mod_python
> installation into somewhere in /usr/local/lib or can I configure it somehow
> to target another directory?  I am trying to install a non-root required
> version and would like to stay away from common system areas.
> 
> -stanton schell
> -- 
> 
> Stanton Schell
> livsform design group
> stanton@livsform.com
> 703-538-3491
> 703-989-6591
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python


From rsalz at caveosystems.com  Wed Jan 31 07:40:08 2001
From: rsalz at caveosystems.com (Rich Salz)
Date: Fri Jan  9 22:02:36 2004
Subject: [mod_python] Python libraries install configuration issue
References: <B69D37BA.AD47%stanton@livsform.com>
Message-ID: <3A7807A8.5EC8CC9F@caveosystems.com>

You need to use PythonPath in your httpd.conf file.
	/r$

From grisha at ispol.com  Wed Jan 31 10:56:40 2001
From: grisha at ispol.com (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:02:36 2004
Subject: [mod_python] Python libraries install configuration issue
In-Reply-To: <B69D37BA.AD47%stanton@livsform.com>
Message-ID: <Pine.BSF.4.21.0101311056090.57390-100000@localhost>

have you looked at the --with-python configure option?

On Wed, 31 Jan 2001, Stanton Schell wrote:

> (In other words, I have my source tree and accompanying python libs in
> user-owned directory and nothing is in /usr/local/lib at all...)
> 
> Thanks!!
> -stanton schell
> -- 
> 
> Stanton Schell
> livsform design group
> stanton@livsform.com
> 703-538-3491
> 703-989-6591
> 
> > From: Stanton Schell <stanton@livsform.com>
> > Date: Wed, 31 Jan 2001 03:23:08 -0500
> > To: <mod_python@modpython.org>
> > Subject: [mod_python] Python libraries install configuration issue
> > 
> > Hello All,
> > 
> > I have two (unrelated) questions:
> > 
> > 1. I was unable to find a searchable version  of the archives - is there
> > one?
> > 
> > 2. Am I forced to install the python libraries during the mod_python
> > installation into somewhere in /usr/local/lib or can I configure it somehow
> > to target another directory?  I am trying to install a non-root required
> > version and would like to stay away from common system areas.
> > 
> > -stanton schell
> > -- 
> > 
> > Stanton Schell
> > livsform design group
> > stanton@livsform.com
> > 703-538-3491
> > 703-989-6591
> > 
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://www.modpython.org/mailman/listinfo/mod_python
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


From thornton at yoyoweb.com  Wed Jan 31 09:22:15 2001
From: thornton at yoyoweb.com (Thornton Prime)
Date: Fri Jan  9 22:02:36 2004
Subject: [mod_python] APahce 1.3.17 vs. mod_python
Message-ID: <Pine.LNX.4.32.0101310917040.1986-100000@prajna.anatman.org>

I'm just wondering if anyone has gotten mod_python to work against 1.3.17
yet. I had things working under 1.3.14, but after upgrading to 1.3.17 it
segfaults. I'm hoping someone else has a fix before I dive in with a
debugger.

I already re-compiled mod_python against 1.3.17, and it is at the top of
my addmodules list.

thornton


From stanton at livsform.com  Wed Jan 31 14:06:28 2001
From: stanton at livsform.com (Stanton Schell)
Date: Fri Jan  9 22:02:36 2004
Subject: [mod_python] Python libraries install configuration issue
In-Reply-To: <3A7807A8.5EC8CC9F@caveosystems.com>
References: <3A7807A8.5EC8CC9F@caveosystems.com>
Message-ID: <50115.38.233.141.43.980967988.squirrel@miesmail.livsform.com>

> You need to use PythonPath in your httpd.conf file.
> 	/r$

Thanks for the response.

However, I still have the (a similar) problem:

I have configured the PythonPath directive to include a number of different directories 
including the library directory in my Python build, but still the same thing.  Is there anything 
specifically that mod_python is looking for that I can correct temporarily to at least move on to 
another error message? :-)

-stanton schell

-- 
Stanton Schell
stanton@livsform.com
703.989.6591
703.538.3491

From stanton at livsform.com  Wed Jan 31 21:01:20 2001
From: stanton at livsform.com (Stanton Schell)
Date: Fri Jan  9 22:02:36 2004
Subject: [mod_python] Python libraries install configuration issue
In-Reply-To: <Pine.BSF.4.21.0101311056090.57390-100000@localhost>
Message-ID: <B69E2DA0.AD72%stanton@livsform.com>

I did indeed, I used " --with-python=/path/to/source/root --with-apache=,
etc..."

I have tried putting all these library files in a number of different
locations in addition to including quite a few directories in the PythonPath
directive in httpd.conf, but the module still seems not available for
import.  do you think there is any reason the interpreter could not _import_
the module as opposed to being able to _find_ it?  just a thought...

-stanton
-- 

Stanton Schell
livsform design group
stanton@livsform.com
703-538-3491
703-989-6591

> From: "Gregory (Grisha) Trubetskoy" <grisha@ispol.com>
> Date: Wed, 31 Jan 2001 10:56:40 -0500 (EST)
> To: Stanton Schell <stanton@livsform.com>
> Cc: mod_python@modpython.org
> Subject: Re: [mod_python] Python libraries install configuration issue
> 
> 
> have you looked at the --with-python configure option?
> 
> On Wed, 31 Jan 2001, Stanton Schell wrote:
> 
>> (In other words, I have my source tree and accompanying python libs in
>> user-owned directory and nothing is in /usr/local/lib at all...)
>> 
>> Thanks!!
>> -stanton schell
>> -- 
>> 
>> Stanton Schell
>> livsform design group
>> stanton@livsform.com
>> 703-538-3491
>> 703-989-6591
>> 
>>> From: Stanton Schell <stanton@livsform.com>
>>> Date: Wed, 31 Jan 2001 03:23:08 -0500
>>> To: <mod_python@modpython.org>
>>> Subject: [mod_python] Python libraries install configuration issue
>>> 
>>> Hello All,
>>> 
>>> I have two (unrelated) questions:
>>> 
>>> 1. I was unable to find a searchable version  of the archives - is there
>>> one?
>>> 
>>> 2. Am I forced to install the python libraries during the mod_python
>>> installation into somewhere in /usr/local/lib or can I configure it somehow
>>> to target another directory?  I am trying to install a non-root required
>>> version and would like to stay away from common system areas.
>>> 
>>> -stanton schell
>>> -- 
>>> 
>>> Stanton Schell
>>> livsform design group
>>> stanton@livsform.com
>>> 703-538-3491
>>> 703-989-6591
>>> 
>>> _______________________________________________
>>> Mod_python mailing list
>>> Mod_python@modpython.org
>>> http://www.modpython.org/mailman/listinfo/mod_python
>> 
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://www.modpython.org/mailman/listinfo/mod_python
>> 


From grisha at ispol.com  Wed Jan 31 23:29:44 2001
From: grisha at ispol.com (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:02:36 2004
Subject: [mod_python] modpublisher security model
In-Reply-To: <NCBBKMABOKFCDLPIKKGIMEHGCJAA.brett@bookshop.unsw.edu.au>
Message-ID: <Pine.BSF.4.21.0101312320090.70118-100000@localhost>

I have in CVS some fixes that do not allow the publisher handler to
traverse modules. Right now if your script imports os, then one can get to
os and functions within it via a url, which is really bad. (ZPublisher
doesn't traverse modules either.)

Assuming that module traversing issue is fixed - you make a function
"published" by simply having it in the module. If you do not want it to be
published, you can set it's name to begin with an underscore or place it
into another module.

I did this because the ZPublisher comment thing always annoyed me. It's
really misleading - I like to use comments for what they are - comments,
and if a function doesn't need a comment, I prefer to have the option of
having no comment rather than """ this comment is for ZPublisher """ or
something silly like that.

Grisha

On Thu, 1 Feb 2001, Brett Haydon wrote:

> Evidently Zope currently uses the doc string to 
> explicity allow access to functions via URL.
> 
> The new Python 2.1 will allow functions to have
> attributes.
> 
> I am currently renaming all imported modules with
> an underscore to avoid unintentional security problems
> (and global objects)
> but I like the idea of explicitly allowing access.
> 
> Any plans to move in this direction.
> 
> regards,
> ______________________________________________
> Brett Haydon
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
> 


