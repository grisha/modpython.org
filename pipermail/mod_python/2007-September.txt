From scarfboy at gmail.com  Mon Sep  3 20:34:53 2007
From: scarfboy at gmail.com (Bart)
Date: Mon Sep  3 20:35:10 2007
Subject: [mod_python] Howto force reload of all modules
In-Reply-To: <20070831181725.oyfclrosk7e8skc4@webmail.pdx.edu>
References: <20070830164137.sa7glmmqstcgc848@webmail.pdx.edu>
	<88e286470708301848m2606c9fid4a7a9b0b8891571@mail.gmail.com>
	<20070831112118.ra0rf8e3d68ssw8s@webmail.pdx.edu>
	<88e286470708311520n45714961gda4c488d6e0c451d@mail.gmail.com>
	<20070831181725.oyfclrosk7e8skc4@webmail.pdx.edu>
Message-ID: <b71082d80709031734r5fddb92bw583a1b5de34581b@mail.gmail.com>

On 9/1/07, hhanke@pdx.edu <hhanke@pdx.edu> wrote:
> > In summary, with mod_python your production box is best used only for
> > deployment and not for development. You can only get so far using
> > 'import_module()' properly on a production box, sometimes you just
> > cant avoid doing a restart. Thus you really need to use a separate
> > Apache instance when you are doing development with mod_python if you
> > have no ability to restart your production server.
>
> Hi Graham,
>
> thanks for the explanation. I've read the documentation, but as I
> said before, I can't use 3.3 yet. It is not only about
> developement/production, but also production/production, because
> when there is a new version of the software, I do not have any
> reasonable way how to run the new code.
>
> Anyway, I understand there is no use in complaining about
> something that was fixed already. We just need to push our
> admin to install mod_python 3.3 ASAP.

I have a similar problem, also on a production server that I don't have
admin control over.
I settled on a module that runs through a list of names I want
apache_import()'d, (it's a fairly short list after all)
which I apache_import-and-call in all handlers. It seemed the
simplest hack that does approximately what I want,
and it can be easily disabled with a little commenting.

(It's conceivable you can hack something together that looks at
sys.modules and each module's __file__ but beyond doubting it'll
work at all I also doubt it's particularly mp-version-portable.)

--Bart
From hhanke at pdx.edu  Tue Sep  4 08:29:54 2007
From: hhanke at pdx.edu (hhanke@pdx.edu)
Date: Tue Sep  4 08:30:09 2007
Subject: [mod_python] Howto force reload of all modules
In-Reply-To: <b71082d80709031734r5fddb92bw583a1b5de34581b@mail.gmail.com>
References: <20070830164137.sa7glmmqstcgc848@webmail.pdx.edu>
	<88e286470708301848m2606c9fid4a7a9b0b8891571@mail.gmail.com>
	<20070831112118.ra0rf8e3d68ssw8s@webmail.pdx.edu>
	<88e286470708311520n45714961gda4c488d6e0c451d@mail.gmail.com>
	<20070831181725.oyfclrosk7e8skc4@webmail.pdx.edu>
	<b71082d80709031734r5fddb92bw583a1b5de34581b@mail.gmail.com>
Message-ID: <20070904052954.gg8n4xu9j0qo8s8w@webmail.pdx.edu>


Hi,

thank you all for advices. My latest solution was to do 'touch'
on all the top-level modules (I call so the modules containing
the functions that directly render the webpages) on the production
server. When these get 'changed', mod_python needs to reload them,
so it will import/apache.import_module also all the sub-modules
in the run, in all interpreters.

Have a nice day,
Hynek

From sidnei at enfoldsystems.com  Wed Sep  5 12:21:27 2007
From: sidnei at enfoldsystems.com (Sidnei da Silva)
Date: Wed Sep  5 12:22:05 2007
Subject: [mod_python] Headers not being sent when input/output is over a
	certain size
References: <fb2kr0$f63$1@sea.gmane.org>
	<88e286470708282032i3fe6e390j96bec45522c9bfb5@mail.gmail.com>
	<A27E48C051AA49529DD4EA05B09FE963@topia>
	<88e286470708282057t386062f0ib0f937bc64f62a6@mail.gmail.com>
Message-ID: <77BA8E8E48CA4C72AFD9D52589F1A3D6@topia>

Ok, I was finally able to figure out part of the problem and a solution for 
it.

The issue is that if the response fits in 'io_buffer_size' which defaults to 
8k, then the output filters get all called in the same iteration. In 
particular, there's one filter called 'HTTP_HEADER' which is responsible for 
emitting the headers. Obviously, to make things work right, it should be the 
last one to be called, which it is apparently.

However, when the response is larger than io_buffer_size, the filters get 
called multiple times. Unfortunately, HTTP_HEADER is one such filter, so the 
first time around the mod_python filter gets called, but hasn't seen EOS, so 
it doesn't change the headers. Then the HTTP_HEADER gets called and sends 
the headers. Then after that you can't change the headers anymore.

My initial hack was to set 'req.assbackwards', which prevented the 
HTTP_HEADER from doing it's thing, and then when the mod_python filter sees 
EOS then I set 'req.assbackwards' to 1 and call 
req.add_output_filter('HTTP_HEADER'). That works, but depends on filter 
implementation internals, so I felt I needed a better fix.

Then I stumble upon 'mod_filter', which has lots of interesting 
configuration knobs. The interesting one is 'FilterProtocol', which lets you 
specify if your filter will change the content length and if it supports 
byte ranges, and also that you want your filter to be the first one in the 
chain. So I toggled those settings, and it magically works.

Here's my configuration file:
https://svn.enfoldsystems.com/browse/public/enfold.lxml/trunk/docs/sample-apache.conf?rev=1321&view=auto

It would be great to document this somewhere, so that the next person 
doesn't have to suffer that much. Maybe add some notes to mod_python docs? I 
will certainly write a blog entry.

-- 
Sidnei da Silva
Enfold Systems, Inc. 

From grisha at modpython.org  Mon Sep 10 11:20:03 2007
From: grisha at modpython.org (Vishal Sarhan)
Date: Mon Sep 10 10:20:28 2007
Subject: [mod_python] [SPAM] Great Service
Message-ID: <rmyrjsqWVJMVgrisha@modpython.org>

hi Francisco,

At our Store, we specialize in the sales of brand-name quality,
luxury replicas at some of the lowest prices possible. With our selection of
over 800 products, you can be sure to find that perfect gift for yourself or a loved one.
http://www.siekwjhn.com/

You can buy:

    * Mont Blanc  Watches
    * Mont Blanc  Watches
    * Mont Blanc  Watches
    * Mont Blanc  Watches
    * Mont Blanc  Watches

Get 25% off when buying 2 watches!

Visit Replica Shop!

http://www.siekwjhn.com/









From swati at ibcs.in  Mon Sep 10 11:33:03 2007
From: swati at ibcs.in (Swati Mazumder)
Date: Mon Sep 10 11:33:59 2007
Subject: [mod_python] [SPAM] mod python installation problem
Message-ID: <001e01c7f3bf$e655bc30$123ae2dc@IBM59C3E89BC98>

Hi All,

When I run ./configure, the command executes successfully. But after that, when I am trying to run make command, it is showing me some error where it shows some variables are not defined, I am getting errors like,-

mod_python.c:621: error: syntax error before '*' token
mod_python.c: In function 'python_create_global_config':
mod_python.c:623: error: 's' undeclared (first use in this function)
mod_python.c: At top level:
mod_python.c:650: error: syntax error before '*' token
mod_python.c: In function 'mp_acquire_interpreter':
mod_python.c:652: error: 'idata' undeclared (first use in this function)
mod_python.c: At top level:
mod_python.c:678: error: syntax error before '*' token
mod_python.c:678: error: syntax error before '*' token
mod_python.c: In function 'mp_get_request_object':
mod_python.c:680: error: invalid operands to binary *
mod_python.c:682: error: 'req' undeclared (first use in this function)
mod_python.c:684: error: 'PyObject' undeclared (first use in this function)
mod_python.c:684: error: syntax error before ')' token
mod_python.c: At top level:
mod_python.c:694: error: syntax error before '*' token
mod_python.c:694: error: syntax error before '*' token
mod_python.c: In function 'mp_get_server_object':
mod_python.c:696: error: 'PyObject' undeclared (first use in this function)
mod_python.c:696: error: syntax error before ')' token
mod_python.c: At top level:
mod_python.c:706: error: syntax error before '*' token
mod_python.c: In function 'mp_get_connection_object':
mod_python.c:708: error: 'PyObject' undeclared (first use in this function)
mod_python.c:708: error: syntax error before ')' token
mod_python.c: At top level:
mod_python.c:718: error: syntax error before 'server_rec'
mod_python.c: In function 'python_init':
mod_python.c:726: error: 'PY_VERSION' undeclared (first use in this function)
mod_python.c:758: error: 's' undeclared (first use in this function)
mod_python.c:766: error: 'p' undeclared (first use in this function)
mod_python.c:812: warning: assignment makes pointer from integer without a cast
mod_python.c:825: error: 'apu__opt' undeclared (first use in this function)
mod_python.c:826: warning: initialization from incompatible pointer type
mod_python.c: At top level:
mod_python.c:886: error: syntax error before 'server_rec'
mod_python.c: In function 'python_create_srv_config':
mod_python.c:889: error: 'p' undeclared (first use in this function)
mod_python.c: In function 'python_merge_config':
mod_python.c:927: error: 'hle' undeclared (first use in this function)
mod_python.c:928: error: 'fh' undeclared (first use in this function)
mod_python.c: In function 'python_directive_hl_add':
mod_python.c:1142: error: 'head' undeclared (first use in this function)
mod_python.c:1156: error: syntax error before ')' token
mod_python.c: At top level:
mod_python.c:1259: error: syntax error before '*' token
mod_python.c:1259: error: syntax error before '*' token
mod_python.c: In function 'python_get_request_object':
mod_python.c:1261: error: 'req_config' undeclared (first use in this function)
mod_python.c:1262: error: invalid operands to binary *
mod_python.c:1265: error: syntax error before ')' token
mod_python.c:1265: error: 'req' undeclared (first use in this function)
mod_python.c:1297: error: 'Py_BEGIN_ALLOW_THREADS' undeclared (first use in this function)
mod_python.c:1297: error: syntax error before 'ap_add_cgi_vars'
mod_python.c:1300: error: 'Py_END_ALLOW_THREADS' undeclared (first use in this function)
mod_python.c:1321: error: request for member 'phase' in something not a structure or union
mod_python.c:1322: error: request for member 'phase' in something not a structure or union
mod_python.c: At top level:
mod_python.c:1334: error: syntax error before '*' token
mod_python.c: In function 'resolve_directory':
mod_python.c:1340: error: 'req' undeclared (first use in this function)
mod_python.c: At top level:
mod_python.c:1394: error: syntax error before '*' token
mod_python.c: In function 'resolve_location':
mod_python.c:1400: error: 'req' undeclared (first use in this function)
mod_python.c: At top level:
mod_python.c:1452: error: syntax error before '*' token
mod_python.c: In function 'select_interp_name':
mod_python.c:1458: error: 'conf' undeclared (first use in this function)
mod_python.c:1466: error: 'req' undeclared (first use in this function)
mod_python.c:1501: error: 'fh' undeclared (first use in this function)
mod_python.c:1504: error: 'hle' undeclared (first use in this function)
mod_python.c:1518: error: 'con' undeclared (first use in this function)
mod_python.c: At top level:
mod_python.c:1532: error: syntax error before '*' token
mod_python.c: In function 'python_handler':
mod_python.c:1535: error: 'PyObject' undeclared (first use in this function)
mod_python.c:1535: error: 'resultobject' undeclared (first use in this function)
mod_python.c:1536: error: 'idata' undeclared (first use in this function)
mod_python.c:1537: error: invalid operands to binary *
mod_python.c:1542: error: 'hle' undeclared (first use in this function)
mod_python.c:1543: error: 'dynhle' undeclared (first use in this function)
mod_python.c:1544: error: 'hlohle' undeclared (first use in this function)
mod_python.c:1546: error: 'req_conf' undeclared (first use in this function)
mod_python.c:1549: error: 'req' undeclared (first use in this function)
mod_python.c:1567: error: syntax error before ')' token
mod_python.c:1574: error: syntax error before ')' token
mod_python.c:1582: error: syntax error before ')' token
mod_python.c:1585: error: syntax error before ')' token
mod_python.c:1641: error: request for member 'extension' in something not a structure or union
mod_python.c:1644: error: request for member 'hlo' in something not a structure or union
mod_python.c:1645: error: request for member 'hlo' in something not a structure or union
mod_python.c:1645: error: syntax error before ')' token
mod_python.c:1656: error: request for member 'phase' in something not a structure or union
mod_python.c:1657: error: request for member 'phase' in something not a structure or union
mod_python.c:1682: warning: passing argument 1 of 'strlen' from incompatible pointer type
mod_python.c:1682: warning: passing argument 1 of '__builtin_strcmp' from incompatible pointer type
mod_python.c:1682: warning: passing argument 1 of 'strlen' from incompatible pointer type
mod_python.c:1682: warning: passing argument 1 of '__builtin_strcmp' from incompatible pointer type
mod_python.c:1682: warning: passing argument 1 of '__builtin_strcmp' from incompatible pointer type
mod_python.c:1682: warning: passing argument 1 of '__builtin_strcmp' from incompatible pointer type
mod_python.c: In function 'python_cleanup_handler':
mod_python.c:1753: error: 'req_config' undeclared (first use in this function)
mod_python.c:1754: error: 'req' undeclared (first use in this function)
mod_python.c:1754: error: syntax error before ')' token
mod_python.c:1756: error: syntax error before ')' token
mod_python.c:1758: error: syntax error before ')' token
mod_python.c:1763: error: 'idata' undeclared (first use in this function)
mod_python.c:1764: error: invalid operands to binary *
mod_python.c: In function 'python_connection':
mod_python.c:1790: error: 'PyObject' undeclared (first use in this function)
mod_python.c:1790: error: 'resultobject' undeclared (first use in this function)
mod_python.c:1791: error: 'idata' undeclared (first use in this function)
mod_python.c:1792: error: 'conn_obj' undeclared (first use in this function)
mod_python.c:1796: error: 'hle' undeclared (first use in this function)
mod_python.c:1803: error: syntax error before ')' token
mod_python.c:1824: error: syntax error before ')' token
mod_python.c:1827: error: syntax error before ')' token
mod_python.c: In function 'python_filter':
mod_python.c:1876: error: 'PyObject' undeclared (first use in this function)
mod_python.c:1876: error: 'resultobject' undeclared (first use in this function)
mod_python.c:1877: error: 'idata' undeclared (first use in this function)
mod_python.c:1878: error: invalid operands to binary *
mod_python.c:1880: error: 'req_config' undeclared (first use in this function)
mod_python.c:1882: error: 'req' undeclared (first use in this function)
mod_python.c:1883: error: 'filter' undeclared (first use in this function)
mod_python.c:1885: error: 'fh' undeclared (first use in this function)
mod_python.c:1912: error: syntax error before ')' token
mod_python.c:1949: error: syntax error before ')' token
mod_python.c: In function 'handle_python':
mod_python.c:2024: error: 'idata' undeclared (first use in this function)
mod_python.c:2025: error: invalid operands to binary *
mod_python.c:2026: error: 'PyObject' undeclared (first use in this function)
mod_python.c:2026: error: 'resultobject' undeclared (first use in this function)
mod_python.c:2027: error: 'filter' undeclared (first use in this function)
mod_python.c:2034: error: 'tagobject' undeclared (first use in this function)
mod_python.c:2035: error: 'codeobject' undeclared (first use in this function)
mod_python.c:2037: error: 'req' undeclared (first use in this function)
mod_python.c:2127: error: syntax error before ')' token
mod_python.c: In function 'directive_PythonOptimize':
mod_python.c:2497: error: 'Py_OptimizeFlag' undeclared (first use in this function)
mod_python.c: In function 'directive_PythonInputFilter':
mod_python.c:2616: error: 'fh' undeclared (first use in this function)
mod_python.c:2640: error: syntax error before ')' token
mod_python.c: In function 'directive_PythonOutputFilter':
mod_python.c:2659: error: 'fh' undeclared (first use in this function)
mod_python.c:2683: error: syntax error before ')' token
mod_python.c: In function 'python_finalize':
mod_python.c:2707: error: 'idata' undeclared (first use in this function)
mod_python.c: At top level:
mod_python.c:2730: error: syntax error before 'server_rec'
mod_python.c: In function 'PythonChildInitHandler':
mod_python.c:2738: error: 's' undeclared (first use in this function)
mod_python.c:2740: error: 'PyObject' undeclared (first use in this function)
mod_python.c:2740: error: 'resultobject' undeclared (first use in this function)
mod_python.c:2749: error: invalid type argument of '->'
mod_python.c:2784: error: 'p' undeclared (first use in this function)
mod_python.c:2815: error: 'idata' undeclared (first use in this function)
mod_python.c: At top level:
mod_python.c:2855: error: syntax error before '*' token
mod_python.c: In function 'PythonAccessHandler':
mod_python.c:2856: error: 'req' undeclared (first use in this function)
mod_python.c: At top level:
mod_python.c:2858: error: syntax error before '*' token
mod_python.c: In function 'PythonAuthenHandler':
mod_python.c:2859: error: 'req' undeclared (first use in this function)
mod_python.c: At top level:
mod_python.c:2861: error: syntax error before '*' token
mod_python.c: In function 'PythonAuthzHandler':
mod_python.c:2862: error: 'req' undeclared (first use in this function)
mod_python.c: At top level:
mod_python.c:2864: error: syntax error before '*' token
mod_python.c: In function 'PythonFixupHandler':
mod_python.c:2865: error: 'req' undeclared (first use in this function)
mod_python.c: At top level:
mod_python.c:2867: error: syntax error before '*' token
mod_python.c: In function 'PythonHandler':
mod_python.c:2874: error: 'req' undeclared (first use in this function)
mod_python.c: At top level:
mod_python.c:2880: error: syntax error before '*' token
mod_python.c: In function 'PythonHeaderParserHandler':
mod_python.c:2884: error: 'req' undeclared (first use in this function)
mod_python.c: At top level:
mod_python.c:2891: error: syntax error before '*' token
mod_python.c: In function 'PythonLogHandler':
mod_python.c:2892: error: 'req' undeclared (first use in this function)
mod_python.c: At top level:
mod_python.c:2894: error: syntax error before '*' token
mod_python.c: In function 'PythonPostReadRequestHandler':
mod_python.c:2898: error: 'req' undeclared (first use in this function)
mod_python.c: At top level:
mod_python.c:2905: error: syntax error before '*' token
mod_python.c: In function 'PythonTransHandler':
mod_python.c:2906: error: 'req' undeclared (first use in this function)
mod_python.c: At top level:
mod_python.c:2908: error: syntax error before '*' token
mod_python.c: In function 'PythonTypeHandler':
mod_python.c:2909: error: 'req' undeclared (first use in this function)
apxs:Error: Command failed with rc=65536
.
make[1]: *** [mod_python.so] Error 1
make[1]: Leaving directory `/home/djtstdir/mod_python-3.3.1/src'
make: *** [do_dso] Error 2


And after that installations stops. I have Apache and python installed already in the server. Can anyone please help?

Thanks & Regards,
Swati

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070910/47d2cdfa/attachment-0001.html
From evan at yelp.com  Mon Sep 10 14:16:30 2007
From: evan at yelp.com (Evan Klitzke)
Date: Mon Sep 10 14:16:47 2007
Subject: [mod_python] Logging servlets with mod_log_config
Message-ID: <cfb58d850709101116t53309146x654d7e28485f7fd7@mail.gmail.com>

Hi everyone,

I want to start logging which servlets are called on each incoming
request, and I'd like to do the logging from within Apache, so that
the information will appear within the Apache logs. From the apache
documentation (http://httpd.apache.org/docs/2.2/mod/mod_log_config.html),
it looks like I can achieve this with something like the %{foo}n
directive, which allows one to log a "note" from another module.

Can someone elaborate more on this? What is a "note" in Apache
terminology? And how could I set one from a mod_python request
handler?

-- 
Evan Klitzke <evan@yelp.com>
From evan at yelp.com  Mon Sep 10 17:03:11 2007
From: evan at yelp.com (Evan Klitzke)
Date: Mon Sep 10 17:03:25 2007
Subject: [mod_python] Re: Logging servlets with mod_log_config
In-Reply-To: <cfb58d850709101116t53309146x654d7e28485f7fd7@mail.gmail.com>
References: <cfb58d850709101116t53309146x654d7e28485f7fd7@mail.gmail.com>
Message-ID: <cfb58d850709101403s48ad57f0u3da1f6249aac1b18@mail.gmail.com>

On 9/10/07, Evan Klitzke <evan@yelp.com> wrote:
> Hi everyone,
>
> I want to start logging which servlets are called on each incoming
> request, and I'd like to do the logging from within Apache, so that
> the information will appear within the Apache logs. From the apache
> documentation (http://httpd.apache.org/docs/2.2/mod/mod_log_config.html),
> it looks like I can achieve this with something like the %{foo}n
> directive, which allows one to log a "note" from another module.
>
> Can someone elaborate more on this? What is a "note" in Apache
> terminology? And how could I set one from a mod_python request
> handler?

I looked at the source, and I figured it out -- I just need to add the
"note" to req.notes (where req is the request object), which is a
dictionary.

-- 
Evan Klitzke <evan@yelp.com>
From graham.dumpleton at gmail.com  Mon Sep 10 18:15:38 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Sep 10 18:15:49 2007
Subject: [SPAM] [mod_python] [SPAM] mod python installation problem
In-Reply-To: <001e01c7f3bf$e655bc30$123ae2dc@IBM59C3E89BC98>
References: <001e01c7f3bf$e655bc30$123ae2dc@IBM59C3E89BC98>
Message-ID: <88e286470709101515s4b2ea406l5fbd560d6a09973b@mail.gmail.com>

If you installed Apache/Python from binary packages, did you also
install the 'dev' variants of those packages so header files were
installed?

Also, you have unfortunately chopped off the bit we really need to
see, which is the compilation command down to where the first error
occurs. This section will show whether header files cannot be found,
as well as possibly other issues.

Graham

On 11/09/2007, Swati Mazumder <swati@ibcs.in> wrote:
>
>
> Hi All,
>
> When I run ./configure, the command executes successfully. But after that,
> when I am trying to run make command, it is showing me some error where it
> shows some variables are not defined, I am getting errors like,-
>
> mod_python.c:621: error: syntax error before '*' token
> mod_python.c: In function 'python_create_global_config':
> mod_python.c:623: error: 's' undeclared (first use in this function)
> mod_python.c: At top level:
> mod_python.c:650: error: syntax error before '*' token
> mod_python.c: In function 'mp_acquire_interpreter':
> mod_python.c:652: error: 'idata' undeclared (first use in this function)
> mod_python.c: At top level:
> mod_python.c:678: error: syntax error before '*' token
> mod_python.c:678: error: syntax error before '*' token
> mod_python.c: In function 'mp_get_request_object':
> mod_python.c:680: error: invalid operands to binary *
> mod_python.c:682: error: 'req' undeclared (first use in this function)
> mod_python.c:684: error: 'PyObject' undeclared (first use in this function)
> mod_python.c:684: error: syntax error before ')' token
> mod_python.c: At top level:
> mod_python.c:694: error: syntax error before '*' token
> mod_python.c:694: error: syntax error before '*' token
> mod_python.c: In function 'mp_get_server_object':
> mod_python.c:696: error: 'PyObject' undeclared (first use in this function)
> mod_python.c:696: error: syntax error before ')' token
> mod_python.c: At top level:
> mod_python.c:706: error: syntax error before '*' token
> mod_python.c: In function 'mp_get_connection_object':
> mod_python.c:708: error: 'PyObject' undeclared (first use in this function)
> mod_python.c:708: error: syntax error before ')' token
> mod_python.c: At top level:
> mod_python.c:718: error: syntax error before 'server_rec'
> mod_python.c: In function 'python_init':
> mod_python.c:726: error: 'PY_VERSION' undeclared (first use in this
> function)
> mod_python.c:758: error: 's' undeclared (first use in this function)
> mod_python.c:766: error: 'p' undeclared (first use in this function)
> mod_python.c:812: warning: assignment makes pointer from integer without a
> cast
> mod_python.c:825: error: 'apu__opt' undeclared (first use in this function)
> mod_python.c:826: warning: initialization from incompatible pointer type
> mod_python.c: At top level:
> mod_python.c:886: error: syntax error before 'server_rec'
> mod_python.c: In function 'python_create_srv_config':
> mod_python.c:889: error: 'p' undeclared (first use in this function)
> mod_python.c: In function 'python_merge_config':
> mod_python.c:927: error: 'hle' undeclared (first use in this function)
> mod_python.c:928: error: 'fh' undeclared (first use in this function)
> mod_python.c: In function 'python_directive_hl_add':
> mod_python.c:1142: error: 'head' undeclared (first use in this function)
> mod_python.c:1156: error: syntax error before ')' token
> mod_python.c: At top level:
> mod_python.c:1259: error: syntax error before '*' token
> mod_python.c:1259: error: syntax error before '*' token
> mod_python.c: In function 'python_get_request_object':
> mod_python.c:1261: error: 'req_config' undeclared (first use in this
> function)
> mod_python.c:1262: error: invalid operands to binary *
> mod_python.c:1265: error: syntax error before ')' token
> mod_python.c:1265: error: 'req' undeclared (first use in this function)
> mod_python.c:1297: error: 'Py_BEGIN_ALLOW_THREADS' undeclared (first use in
> this function)
> mod_python.c:1297: error: syntax error before 'ap_add_cgi_vars'
> mod_python.c:1300: error: 'Py_END_ALLOW_THREADS' undeclared (first use in
> this function)
> mod_python.c:1321: error: request for member 'phase' in something not a
> structure or union
> mod_python.c:1322: error: request for member 'phase' in something not a
> structure or union
> mod_python.c: At top level:
> mod_python.c:1334: error: syntax error before '*' token
> mod_python.c: In function 'resolve_directory':
> mod_python.c:1340: error: 'req' undeclared (first use in this function)
> mod_python.c: At top level:
> mod_python.c:1394: error: syntax error before '*' token
> mod_python.c: In function 'resolve_location':
> mod_python.c:1400: error: 'req' undeclared (first use in this function)
> mod_python.c: At top level:
> mod_python.c:1452: error: syntax error before '*' token
> mod_python.c: In function 'select_interp_name':
> mod_python.c:1458: error: 'conf' undeclared (first use in this function)
> mod_python.c:1466: error: 'req' undeclared (first use in this function)
> mod_python.c:1501: error: 'fh' undeclared (first use in this function)
> mod_python.c:1504: error: 'hle' undeclared (first use in this function)
> mod_python.c:1518: error: 'con' undeclared (first use in this function)
> mod_python.c: At top level:
> mod_python.c:1532: error: syntax error before '*' token
> mod_python.c: In function 'python_handler':
> mod_python.c:1535: error: 'PyObject' undeclared (first use in this function)
> mod_python.c:1535: error: 'resultobject' undeclared (first use in this
> function)
> mod_python.c:1536: error: 'idata' undeclared (first use in this function)
> mod_python.c:1537: error: invalid operands to binary *
> mod_python.c:1542: error: 'hle' undeclared (first use in this function)
> mod_python.c:1543: error: 'dynhle' undeclared (first use in this function)
> mod_python.c:1544: error: 'hlohle' undeclared (first use in this function)
> mod_python.c:1546: error: 'req_conf' undeclared (first use in this function)
> mod_python.c:1549: error: 'req' undeclared (first use in this function)
> mod_python.c:1567: error: syntax error before ')' token
> mod_python.c:1574: error: syntax error before ')' token
> mod_python.c:1582: error: syntax error before ')' token
> mod_python.c:1585: error: syntax error before ')' token
> mod_python.c:1641: error: request for member 'extension' in something not a
> structure or union
> mod_python.c:1644: error: request for member 'hlo' in something not a
> structure or union
> mod_python.c:1645: error: request for member 'hlo' in something not a
> structure or union
> mod_python.c:1645: error: syntax error before ')' token
> mod_python.c:1656: error: request for member 'phase' in something not a
> structure or union
> mod_python.c:1657: error: request for member 'phase' in something not a
> structure or union
> mod_python.c:1682: warning: passing argument 1 of 'strlen' from incompatible
> pointer type
> mod_python.c:1682: warning: passing argument 1 of '__builtin_strcmp' from
> incompatible pointer type
> mod_python.c:1682: warning: passing argument 1 of 'strlen' from incompatible
> pointer type
> mod_python.c:1682: warning: passing argument 1 of '__builtin_strcmp' from
> incompatible pointer type
> mod_python.c:1682: warning: passing argument 1 of '__builtin_strcmp' from
> incompatible pointer type
> mod_python.c:1682: warning: passing argument 1 of '__builtin_strcmp' from
> incompatible pointer type
> mod_python.c: In function 'python_cleanup_handler':
> mod_python.c:1753: error: 'req_config' undeclared (first use in this
> function)
> mod_python.c:1754: error: 'req' undeclared (first use in this function)
> mod_python.c:1754: error: syntax error before ')' token
> mod_python.c:1756: error: syntax error before ')' token
> mod_python.c:1758: error: syntax error before ')' token
> mod_python.c:1763: error: 'idata' undeclared (first use in this function)
> mod_python.c:1764: error: invalid operands to binary *
> mod_python.c: In function 'python_connection':
> mod_python.c:1790: error: 'PyObject' undeclared (first use in this function)
> mod_python.c:1790: error: 'resultobject' undeclared (first use in this
> function)
> mod_python.c:1791: error: 'idata' undeclared (first use in this function)
> mod_python.c:1792: error: 'conn_obj' undeclared (first use in this function)
> mod_python.c:1796: error: 'hle' undeclared (first use in this function)
> mod_python.c:1803: error: syntax error before ')' token
> mod_python.c:1824: error: syntax error before ')' token
> mod_python.c:1827: error: syntax error before ')' token
> mod_python.c: In function 'python_filter':
> mod_python.c:1876: error: 'PyObject' undeclared (first use in this function)
> mod_python.c:1876: error: 'resultobject' undeclared (first use in this
> function)
> mod_python.c:1877: error: 'idata' undeclared (first use in this function)
> mod_python.c:1878: error: invalid operands to binary *
> mod_python.c:1880: error: 'req_config' undeclared (first use in this
> function)
> mod_python.c:1882: error: 'req' undeclared (first use in this function)
> mod_python.c:1883: error: 'filter' undeclared (first use in this function)
> mod_python.c:1885: error: 'fh' undeclared (first use in this function)
> mod_python.c:1912: error: syntax error before ')' token
> mod_python.c:1949: error: syntax error before ')' token
> mod_python.c: In function 'handle_python':
> mod_python.c:2024: error: 'idata' undeclared (first use in this function)
> mod_python.c:2025: error: invalid operands to binary *
> mod_python.c:2026: error: 'PyObject' undeclared (first use in this function)
> mod_python.c:2026: error: 'resultobject' undeclared (first use in this
> function)
> mod_python.c:2027: error: 'filter' undeclared (first use in this function)
> mod_python.c:2034: error: 'tagobject' undeclared (first use in this
> function)
> mod_python.c:2035: error: 'codeobject' undeclared (first use in this
> function)
> mod_python.c:2037: error: 'req' undeclared (first use in this function)
> mod_python.c:2127: error: syntax error before ')' token
> mod_python.c: In function 'directive_PythonOptimize':
> mod_python.c:2497: error: 'Py_OptimizeFlag' undeclared (first use in this
> function)
> mod_python.c: In function 'directive_PythonInputFilter':
> mod_python.c:2616: error: 'fh' undeclared (first use in this function)
> mod_python.c:2640: error: syntax error before ')' token
> mod_python.c: In function 'directive_PythonOutputFilter':
> mod_python.c:2659: error: 'fh' undeclared (first use in this function)
> mod_python.c:2683: error: syntax error before ')' token
> mod_python.c: In function 'python_finalize':
> mod_python.c:2707: error: 'idata' undeclared (first use in this function)
> mod_python.c: At top level:
> mod_python.c:2730: error: syntax error before 'server_rec'
> mod_python.c: In function 'PythonChildInitHandler':
> mod_python.c:2738: error: 's' undeclared (first use in this function)
> mod_python.c:2740: error: 'PyObject' undeclared (first use in this function)
> mod_python.c:2740: error: 'resultobject' undeclared (first use in this
> function)
> mod_python.c:2749: error: invalid type argument of '->'
> mod_python.c:2784: error: 'p' undeclared (first use in this function)
> mod_python.c:2815: error: 'idata' undeclared (first use in this function)
> mod_python.c: At top level:
> mod_python.c:2855: error: syntax error before '*' token
> mod_python.c: In function 'PythonAccessHandler':
> mod_python.c:2856: error: 'req' undeclared (first use in this function)
> mod_python.c: At top level:
> mod_python.c:2858: error: syntax error before '*' token
> mod_python.c: In function 'PythonAuthenHandler':
> mod_python.c:2859: error: 'req' undeclared (first use in this function)
> mod_python.c: At top level:
> mod_python.c:2861: error: syntax error before '*' token
> mod_python.c: In function 'PythonAuthzHandler':
> mod_python.c:2862: error: 'req' undeclared (first use in this function)
> mod_python.c: At top level:
> mod_python.c:2864: error: syntax error before '*' token
> mod_python.c: In function 'PythonFixupHandler':
> mod_python.c:2865: error: 'req' undeclared (first use in this function)
> mod_python.c: At top level:
> mod_python.c:2867: error: syntax error before '*' token
> mod_python.c: In function 'PythonHandler':
> mod_python.c:2874: error: 'req' undeclared (first use in this function)
> mod_python.c: At top level:
> mod_python.c:2880: error: syntax error before '*' token
> mod_python.c: In function 'PythonHeaderParserHandler':
> mod_python.c:2884: error: 'req' undeclared (first use in this function)
> mod_python.c: At top level:
> mod_python.c:2891: error: syntax error before '*' token
> mod_python.c: In function 'PythonLogHandler':
> mod_python.c:2892: error: 'req' undeclared (first use in this function)
> mod_python.c: At top level:
> mod_python.c:2894: error: syntax error before '*' token
> mod_python.c: In function 'PythonPostReadRequestHandler':
> mod_python.c:2898: error: 'req' undeclared (first use in this function)
> mod_python.c: At top level:
> mod_python.c:2905: error: syntax error before '*' token
> mod_python.c: In function 'PythonTransHandler':
> mod_python.c:2906: error: 'req' undeclared (first use in this function)
> mod_python.c: At top level:
> mod_python.c:2908: error: syntax error before '*' token
> mod_python.c: In function 'PythonTypeHandler':
> mod_python.c:2909: error: 'req' undeclared (first use in this function)
> apxs:Error: Command failed with rc=65536
> .
> make[1]: *** [mod_python.so] Error 1
> make[1]: Leaving directory `/home/djtstdir/mod_python-3.3.1/src'
> make: *** [do_dso] Error 2
>
>
> And after that installations stops. I have Apache and python installed
> already in the server. Can anyone please help?
>
> Thanks & Regards,
> Swati
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
From webb.sprague at gmail.com  Wed Sep 12 14:47:36 2007
From: webb.sprague at gmail.com (Webb Sprague)
Date: Wed Sep 12 14:47:55 2007
Subject: [mod_python] Cheetah / mod_python problem: importing python module
	into cheetah template
Message-ID: <b11ea23c0709121147v827fc2cjdd474af72c3973be@mail.gmail.com>

Hi all,

Sorry for the redundancy, but I didn't get a response on the Cheetah
mailing list (probably dead because they use SF), so here I go again:

I am using modpython 3.3.1, cheetah 2.0rc8, python2.5, and apache2 on
a gentoo machine.  I recently upgraded a bunch of stuff on the machine
- it had worked six months ago with different apache etc.

The templates are used by calling:

pageTemplate = Template.Template(file=self.navTemplate, searchList =
searchList)

#... and then ...

req.write(str(pageTemplate))

I have a template that has the following code at the top:

#import sys
#import os
#$sys.path.append('/var/www/localhost/htdocs/larry/')  ## path of following
#from LcConfig import *

But I get an error in my apache logs saying the module can't be found
- please help!

Log dump:

[Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133] Traceback
(most recent call last):, referer: http://lare.demog.berkeley.edu/
[Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
"/usr/lib64/python2.5/site-packages/mod_python/importer.py", line
1537, in HandlerDispatch\n    default=default_handler, arg=req,
silent=hlist.silent), referer: http://lare.demog.berkeley.edu/
[Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
"/usr/lib64/python2.5/site-packages/mod_python/importer.py", line
1229, in _process_target\n    result = _execute_target(config, req,
object, arg), referer: http://lare.demog.berkeley.edu/
[Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
"/usr/lib64/python2.5/site-packages/mod_python/importer.py", line
1128, in _execute_target\n    result = object(arg), referer:
http://lare.demog.berkeley.edu/
[Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
"/usr/lib64/python2.5/site-packages/mod_python/publisher.py", line
213, in handler\n    published = publish_object(req, object), referer:
http://lare.demog.berkeley.edu/
[Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
"/usr/lib64/python2.5/site-packages/mod_python/publisher.py", line
425, in publish_object\n    return
publish_object(req,util.apply_fs_data(object, req.form, req=req)),
referer: http://lare.demog.berkeley.edu/
[Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
"/usr/lib64/python2.5/site-packages/mod_python/util.py", line 554, in
apply_fs_data\n    return object(**args), referer:
http://lare.demog.berkeley.edu/
[Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
"/var/www/localhost/htdocs/larry/LcPageObjects.py", line 55, in
__call__\n    formTemplate = Template.Template(file=self.formTemplate,
searchList = searchList), referer: http://lare.demog.berkeley.edu/
[Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
"/usr/lib64/python2.5/site-packages/Cheetah/Template.py", line 1204,
in __init__\n    self._compile(source, file,
compilerSettings=compilerSettings), referer:
http://lare.demog.berkeley.edu/
[Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
"/usr/lib64/python2.5/site-packages/Cheetah/Template.py", line 1492,
in _compile\n    keepRefToGeneratedCode=True), referer:
http://lare.demog.berkeley.edu/
[Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
"/usr/lib64/python2.5/site-packages/Cheetah/Template.py", line 780, in
compile\n    exec co in mod.__dict__, referer:
http://lare.demog.berkeley.edu/
[Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
"_var_www_localhost_htdocs_larry_TEMPLATES_LoginForm_tmpl.py", line
25, in <module>, referer: http://lare.demog.berkeley.edu/
[Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133] ImportError:
No module named LcConfig, referer: http://lare.demog.berkeley.edu/
From tmikk at umn.edu  Wed Sep 12 15:16:49 2007
From: tmikk at umn.edu (Tonu Mikk)
Date: Wed Sep 12 15:17:05 2007
Subject: [mod_python] Apache virtual host, mod_python and Roundup
Message-ID: <46E83B21.8000109@umn.edu>

Hello, I hope that someone on mod_python mailing list can assist me with the Apache httpd.conf configuration.  I would like to implement Apache virtual hosts with Roundup (http://roundup.sf.net) which in turn uses mod_python.

My current httpd.conf configuration does not utilize Virtual hosts and serves following URLs 
http://rounduptest.dmc.umn.edu/roundup/dmc and 
http://rounduptest.dmc.umn.edu/roundup/telgrants.  

I would like to use URLs that would instead look like this:
http://roundup.dmc.umn.edu/
http://telgrants.dmc.umn.edu/

The current portion httpd.conf related to Roundup is here.  The directory permissions directives are there to only allow access to the files from within our organization.  


#################################################
# Roundup Issue tracker
#################################################
# enable Python optimizations (like 'python -O')
PythonOptimize On
# let apache handle static files from 'html' directories
AliasMatch /roundup/(.+)/@@file/(.*) C:/roundup/$1/html/$2
# everything else is handled by roundup web UI
AliasMatch /roundup/([^/]+)/(?!@@file/)(.*) C:/roundup/$1/dummy.py/$2
# roundup requires a slash after tracker name - add it if missing
RedirectMatch permanent /roundup/([^/]+)$ /roundup/$1/
# common settings for all roundup trackers
<Directory />
    Options None
    AllowOverride None
    Order deny,allow
    Deny from all
</Directory>
<Directory C:/roundup*>
 # Order allow,deny
 # Allow from all
 # AllowOverride None
 # Options None
        AllowOverride None
         Options None
         Order deny,allow
         Deny from all
     Allow from umn.edu
         Allow from 192.168
         Allow from 131.212
         Allow from 128.101
         Allow from 160.94
         Allow from 146.57
         Allow from 134.84
        Allow from localhost
  AddHandler python-program .py
  PythonHandler roundup.cgi.apache
  # uncomment the following line to see tracebacks in the browser
  # (note that *some* tracebacks will be displayed anyway)
  PythonDebug On
</Directory>
# roundup tracker homes
<Directory C:/roundup/telgrants>
  PythonOption TrackerHome C:/roundup/telgrants
</Directory>
<Directory C:/roundup/dmc>
  PythonOption TrackerHome C:/roundup/dmc
</Directory>
#End of section by Tonu

I experimented with virtual directory directives in httpd.config, but did not get them to work properly to serve Roundup pages with short URLs.  Looking at some other examples that people had done in similar situations (as example: http://trac.edgewall.org/wiki/TracModPython) I realize that I will need mod_python directives inside the virtual host.  I include the Virtual Host directives here to show that I started with.    Would someone be able to translate the directives related to Roundup to the way they should look inside the virtual host?

Thank you,
Tonu

# Virtual hosts
NameVirtualHost 160.94.18.121:80
<VirtualHost 160.94.18.121:80>
ServerName rounduptest.dmc.umn.edu
DocumentRoot C:/roundup/dmc
</VirtualHost>

<VirtualHost 160.94.18.121:80>
ServerName telgrantstest.dmc.umn.edu
DocumentRoot C:/roundup/telgrants
</VirtualHost>


From graham.dumpleton at gmail.com  Wed Sep 12 19:41:34 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Wed Sep 12 19:41:49 2007
Subject: [mod_python] Cheetah / mod_python problem: importing python
	module into cheetah template
In-Reply-To: <b11ea23c0709121147v827fc2cjdd474af72c3973be@mail.gmail.com>
References: <b11ea23c0709121147v827fc2cjdd474af72c3973be@mail.gmail.com>
Message-ID: <88e286470709121641v219bb27n363c5cd4997800e0@mail.gmail.com>

Was mod_python one of the things you upgraded?

What is the mod_python configuration for that Directory context?

Graham

On 13/09/2007, Webb Sprague <webb.sprague@gmail.com> wrote:
> Hi all,
>
> Sorry for the redundancy, but I didn't get a response on the Cheetah
> mailing list (probably dead because they use SF), so here I go again:
>
> I am using modpython 3.3.1, cheetah 2.0rc8, python2.5, and apache2 on
> a gentoo machine.  I recently upgraded a bunch of stuff on the machine
> - it had worked six months ago with different apache etc.
>
> The templates are used by calling:
>
> pageTemplate = Template.Template(file=self.navTemplate, searchList =
> searchList)
>
> #... and then ...
>
> req.write(str(pageTemplate))
>
> I have a template that has the following code at the top:
>
> #import sys
> #import os
> #$sys.path.append('/var/www/localhost/htdocs/larry/')  ## path of following
> #from LcConfig import *
>
> But I get an error in my apache logs saying the module can't be found
> - please help!
>
> Log dump:
>
> [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133] Traceback
> (most recent call last):, referer: http://lare.demog.berkeley.edu/
> [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
> "/usr/lib64/python2.5/site-packages/mod_python/importer.py", line
> 1537, in HandlerDispatch\n    default=default_handler, arg=req,
> silent=hlist.silent), referer: http://lare.demog.berkeley.edu/
> [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
> "/usr/lib64/python2.5/site-packages/mod_python/importer.py", line
> 1229, in _process_target\n    result = _execute_target(config, req,
> object, arg), referer: http://lare.demog.berkeley.edu/
> [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
> "/usr/lib64/python2.5/site-packages/mod_python/importer.py", line
> 1128, in _execute_target\n    result = object(arg), referer:
> http://lare.demog.berkeley.edu/
> [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
> "/usr/lib64/python2.5/site-packages/mod_python/publisher.py", line
> 213, in handler\n    published = publish_object(req, object), referer:
> http://lare.demog.berkeley.edu/
> [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
> "/usr/lib64/python2.5/site-packages/mod_python/publisher.py", line
> 425, in publish_object\n    return
> publish_object(req,util.apply_fs_data(object, req.form, req=req)),
> referer: http://lare.demog.berkeley.edu/
> [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
> "/usr/lib64/python2.5/site-packages/mod_python/util.py", line 554, in
> apply_fs_data\n    return object(**args), referer:
> http://lare.demog.berkeley.edu/
> [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
> "/var/www/localhost/htdocs/larry/LcPageObjects.py", line 55, in
> __call__\n    formTemplate = Template.Template(file=self.formTemplate,
> searchList = searchList), referer: http://lare.demog.berkeley.edu/
> [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
> "/usr/lib64/python2.5/site-packages/Cheetah/Template.py", line 1204,
> in __init__\n    self._compile(source, file,
> compilerSettings=compilerSettings), referer:
> http://lare.demog.berkeley.edu/
> [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
> "/usr/lib64/python2.5/site-packages/Cheetah/Template.py", line 1492,
> in _compile\n    keepRefToGeneratedCode=True), referer:
> http://lare.demog.berkeley.edu/
> [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
> "/usr/lib64/python2.5/site-packages/Cheetah/Template.py", line 780, in
> compile\n    exec co in mod.__dict__, referer:
> http://lare.demog.berkeley.edu/
> [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
> "_var_www_localhost_htdocs_larry_TEMPLATES_LoginForm_tmpl.py", line
> 25, in <module>, referer: http://lare.demog.berkeley.edu/
> [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133] ImportError:
> No module named LcConfig, referer: http://lare.demog.berkeley.edu/
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From graham.carlyle at maplecroft.net  Thu Sep 13 09:53:02 2007
From: graham.carlyle at maplecroft.net (Graham Carlyle)
Date: Thu Sep 13 09:53:27 2007
Subject: [mod_python] importing egg format libs installed on a custom path
Message-ID: <1189691582.6048.16.camel@charon>

Hi

I'm trying to setup an application via mod_python and want to place some
required libraries, that are python eggs, on an application specific
path.

So I use...

<LocationMatch ...>

...
PythonPath "['/opt/apps/foo/lib/'] + sys.path"
PythonInterpreter foo
...

</LocationMatch>

But the application doesn't pick up on the eggs that were installed in
"/opt/apps/foo/lib/". Although the python shell can import the libs
after setting PYTHONPATH to this path.

However I can get the webapp to find the eggs if I add to the apache
conf...

PythonImport /opt/apps/foo/lib/site.py foo

site.py being a file the easy_install created when i installed the eggs
to the custom path.

Is this the recommended way of installing eggs to a custom path? Are
there problems with this "solution". 

I had a trawl and couldn't find any info on this sort of problem in the
mailing list which surprised me.

thanks,
Graham


From webb.sprague at gmail.com  Thu Sep 13 13:38:49 2007
From: webb.sprague at gmail.com (Webb Sprague)
Date: Thu Sep 13 13:39:03 2007
Subject: [mod_python] Cheetah / mod_python problem: importing python
	module into cheetah template
In-Reply-To: <88e286470709121641v219bb27n363c5cd4997800e0@mail.gmail.com>
References: <b11ea23c0709121147v827fc2cjdd474af72c3973be@mail.gmail.com>
	<88e286470709121641v219bb27n363c5cd4997800e0@mail.gmail.com>
Message-ID: <b11ea23c0709131038k636f0ca7gceb43035d9d58ab6@mail.gmail.com>

(Let me repost a more cogent answer...)

On 9/12/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> Was mod_python one of the things you upgraded?

Yep

> What is the mod_python configuration for that Directory context?

# LCFIT directory
<Directory /var/www/localhost/htdocs/larry>
    SetHandler mod_python
    PythonHandler mod_python.publisher
    PythonDebug On
    #PythonOptimize On
</Directory>

> On 13/09/2007, Webb Sprague <webb.sprague@gmail.com> wrote:
> > Hi all,
> >
> > Sorry for the redundancy, but I didn't get a response on the Cheetah
> > mailing list (probably dead because they use SF), so here I go again:
> >
> > I am using modpython 3.3.1, cheetah 2.0rc8, python2.5, and apache2 on
> > a gentoo machine.  I recently upgraded a bunch of stuff on the machine
> > - it had worked six months ago with different apache etc.
> >
> > The templates are used by calling:
> >
> > pageTemplate = Template.Template(file=self.navTemplate, searchList =
> > searchList)
> >
> > #... and then ...
> >
> > req.write(str(pageTemplate))
> >
> > I have a template that has the following code at the top:
> >
> > #import sys
> > #import os
> > #$sys.path.append('/var/www/localhost/htdocs/larry/')  ## path of following
> > #from LcConfig import *
> >
> > But I get an error in my apache logs saying the module can't be found
> > - please help!
> >
> > Log dump:
> >
> > [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133] Traceback
> > (most recent call last):, referer: http://lare.demog.berkeley.edu/
> > [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
> > "/usr/lib64/python2.5/site-packages/mod_python/importer.py", line
> > 1537, in HandlerDispatch\n    default=default_handler, arg=req,
> > silent=hlist.silent), referer: http://lare.demog.berkeley.edu/
> > [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
> > "/usr/lib64/python2.5/site-packages/mod_python/importer.py", line
> > 1229, in _process_target\n    result = _execute_target(config, req,
> > object, arg), referer: http://lare.demog.berkeley.edu/
> > [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
> > "/usr/lib64/python2.5/site-packages/mod_python/importer.py", line
> > 1128, in _execute_target\n    result = object(arg), referer:
> > http://lare.demog.berkeley.edu/
> > [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
> > "/usr/lib64/python2.5/site-packages/mod_python/publisher.py", line
> > 213, in handler\n    published = publish_object(req, object), referer:
> > http://lare.demog.berkeley.edu/
> > [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
> > "/usr/lib64/python2.5/site-packages/mod_python/publisher.py", line
> > 425, in publish_object\n    return
> > publish_object(req,util.apply_fs_data(object, req.form, req=req)),
> > referer: http://lare.demog.berkeley.edu/
> > [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
> > "/usr/lib64/python2.5/site-packages/mod_python/util.py", line 554, in
> > apply_fs_data\n    return object(**args), referer:
> > http://lare.demog.berkeley.edu/
> > [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
> > "/var/www/localhost/htdocs/larry/LcPageObjects.py", line 55, in
> > __call__\n    formTemplate = Template.Template(file=self.formTemplate,
> > searchList = searchList), referer: http://lare.demog.berkeley.edu/
> > [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
> > "/usr/lib64/python2.5/site-packages/Cheetah/Template.py", line 1204,
> > in __init__\n    self._compile(source, file,
> > compilerSettings=compilerSettings), referer:
> > http://lare.demog.berkeley.edu/
> > [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
> > "/usr/lib64/python2.5/site-packages/Cheetah/Template.py", line 1492,
> > in _compile\n    keepRefToGeneratedCode=True), referer:
> > http://lare.demog.berkeley.edu/
> > [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
> > "/usr/lib64/python2.5/site-packages/Cheetah/Template.py", line 780, in
> > compile\n    exec co in mod.__dict__, referer:
> > http://lare.demog.berkeley.edu/
> > [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
> > "_var_www_localhost_htdocs_larry_TEMPLATES_LoginForm_tmpl.py", line
> > 25, in <module>, referer: http://lare.demog.berkeley.edu/
> > [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133] ImportError:
> > No module named LcConfig, referer: http://lare.demog.berkeley.edu/
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
>
From graham.dumpleton at gmail.com  Thu Sep 13 18:09:26 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Sep 13 18:09:43 2007
Subject: [mod_python] Cheetah / mod_python problem: importing python
	module into cheetah template
In-Reply-To: <b11ea23c0709131038k636f0ca7gceb43035d9d58ab6@mail.gmail.com>
References: <b11ea23c0709121147v827fc2cjdd474af72c3973be@mail.gmail.com>
	<88e286470709121641v219bb27n363c5cd4997800e0@mail.gmail.com>
	<b11ea23c0709131038k636f0ca7gceb43035d9d58ab6@mail.gmail.com>
Message-ID: <88e286470709131509n44d415dfre0d9fabd32319211@mail.gmail.com>

Is LcConfig actually a Python package rather than a single Python code
file module?

>From mod_python 3.3.1, you cannot put Python packages in the document
tree due to the separation between document tree module imports and
normal sys.path imports.

Read documentation for import_module() in:

  http://www.modpython.org/live/current/doc-html/pyapi-apmeth.html

This is the function that underlays imports of modules residing in
document tree and is used for top level handlers and
mod_python.publisher handlers files.

If your code is a Python package, move it outside of the document tree
and then use PythonPath directory to refer to the parent directory
containing your packages/modules.

In general it is not a good idea to be putting common Python
packages/modules in the document tree if they aren't actually
mod_python handlers. Some, and possibly with good reason, would also
recommend that handler code files in document tree be a very thin
shell which always simply imports code from outside of the document
tree and calls it. The reason for this is so that an Apache
misconfiguration doesn't expose your source code.

Graham

On 14/09/2007, Webb Sprague <webb.sprague@gmail.com> wrote:
> (Let me repost a more cogent answer...)
>
> On 9/12/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > Was mod_python one of the things you upgraded?
>
> Yep
>
> > What is the mod_python configuration for that Directory context?
>
> # LCFIT directory
> <Directory /var/www/localhost/htdocs/larry>
>     SetHandler mod_python
>     PythonHandler mod_python.publisher
>     PythonDebug On
>     #PythonOptimize On
> </Directory>
>
> > On 13/09/2007, Webb Sprague <webb.sprague@gmail.com> wrote:
> > > Hi all,
> > >
> > > Sorry for the redundancy, but I didn't get a response on the Cheetah
> > > mailing list (probably dead because they use SF), so here I go again:
> > >
> > > I am using modpython 3.3.1, cheetah 2.0rc8, python2.5, and apache2 on
> > > a gentoo machine.  I recently upgraded a bunch of stuff on the machine
> > > - it had worked six months ago with different apache etc.
> > >
> > > The templates are used by calling:
> > >
> > > pageTemplate = Template.Template(file=self.navTemplate, searchList =
> > > searchList)
> > >
> > > #... and then ...
> > >
> > > req.write(str(pageTemplate))
> > >
> > > I have a template that has the following code at the top:
> > >
> > > #import sys
> > > #import os
> > > #$sys.path.append('/var/www/localhost/htdocs/larry/')  ## path of following
> > > #from LcConfig import *
> > >
> > > But I get an error in my apache logs saying the module can't be found
> > > - please help!
> > >
> > > Log dump:
> > >
> > > [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133] Traceback
> > > (most recent call last):, referer: http://lare.demog.berkeley.edu/
> > > [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
> > > "/usr/lib64/python2.5/site-packages/mod_python/importer.py", line
> > > 1537, in HandlerDispatch\n    default=default_handler, arg=req,
> > > silent=hlist.silent), referer: http://lare.demog.berkeley.edu/
> > > [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
> > > "/usr/lib64/python2.5/site-packages/mod_python/importer.py", line
> > > 1229, in _process_target\n    result = _execute_target(config, req,
> > > object, arg), referer: http://lare.demog.berkeley.edu/
> > > [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
> > > "/usr/lib64/python2.5/site-packages/mod_python/importer.py", line
> > > 1128, in _execute_target\n    result = object(arg), referer:
> > > http://lare.demog.berkeley.edu/
> > > [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
> > > "/usr/lib64/python2.5/site-packages/mod_python/publisher.py", line
> > > 213, in handler\n    published = publish_object(req, object), referer:
> > > http://lare.demog.berkeley.edu/
> > > [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
> > > "/usr/lib64/python2.5/site-packages/mod_python/publisher.py", line
> > > 425, in publish_object\n    return
> > > publish_object(req,util.apply_fs_data(object, req.form, req=req)),
> > > referer: http://lare.demog.berkeley.edu/
> > > [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
> > > "/usr/lib64/python2.5/site-packages/mod_python/util.py", line 554, in
> > > apply_fs_data\n    return object(**args), referer:
> > > http://lare.demog.berkeley.edu/
> > > [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
> > > "/var/www/localhost/htdocs/larry/LcPageObjects.py", line 55, in
> > > __call__\n    formTemplate = Template.Template(file=self.formTemplate,
> > > searchList = searchList), referer: http://lare.demog.berkeley.edu/
> > > [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
> > > "/usr/lib64/python2.5/site-packages/Cheetah/Template.py", line 1204,
> > > in __init__\n    self._compile(source, file,
> > > compilerSettings=compilerSettings), referer:
> > > http://lare.demog.berkeley.edu/
> > > [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
> > > "/usr/lib64/python2.5/site-packages/Cheetah/Template.py", line 1492,
> > > in _compile\n    keepRefToGeneratedCode=True), referer:
> > > http://lare.demog.berkeley.edu/
> > > [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
> > > "/usr/lib64/python2.5/site-packages/Cheetah/Template.py", line 780, in
> > > compile\n    exec co in mod.__dict__, referer:
> > > http://lare.demog.berkeley.edu/
> > > [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133]   File
> > > "_var_www_localhost_htdocs_larry_TEMPLATES_LoginForm_tmpl.py", line
> > > 25, in <module>, referer: http://lare.demog.berkeley.edu/
> > > [Mon Sep 10 11:20:53 2007] [error] [client 75.170.29.133] ImportError:
> > > No module named LcConfig, referer: http://lare.demog.berkeley.edu/
> > > _______________________________________________
> > > Mod_python mailing list
> > > Mod_python@modpython.org
> > > http://mailman.modpython.org/mailman/listinfo/mod_python
> > >
> >
>
From graham.dumpleton at gmail.com  Thu Sep 13 18:28:50 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Sep 13 18:29:02 2007
Subject: [mod_python] importing egg format libs installed on a custom path
In-Reply-To: <1189691582.6048.16.camel@charon>
References: <1189691582.6048.16.camel@charon>
Message-ID: <88e286470709131528l27b390e7s93b1b5215ab5999@mail.gmail.com>

Have you confirmed that in your application sys.path includes the
directory you expect to be there?

What is the remainder of your Apache configuration for setting up
mod_python handler? Ie., what context are you setting PythonHandler
etc.

Grahamd

On 13/09/2007, Graham Carlyle <graham.carlyle@maplecroft.net> wrote:
> Hi
>
> I'm trying to setup an application via mod_python and want to place some
> required libraries, that are python eggs, on an application specific
> path.
>
> So I use...
>
> <LocationMatch ...>
>
> ...
> PythonPath "['/opt/apps/foo/lib/'] + sys.path"
> PythonInterpreter foo
> ...
>
> </LocationMatch>
>
> But the application doesn't pick up on the eggs that were installed in
> "/opt/apps/foo/lib/". Although the python shell can import the libs
> after setting PYTHONPATH to this path.
>
> However I can get the webapp to find the eggs if I add to the apache
> conf...
>
> PythonImport /opt/apps/foo/lib/site.py foo
>
> site.py being a file the easy_install created when i installed the eggs
> to the custom path.
>
> Is this the recommended way of installing eggs to a custom path? Are
> there problems with this "solution".
>
> I had a trawl and couldn't find any info on this sort of problem in the
> mailing list which surprised me.
>
> thanks,
> Graham
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From giovanni.porcari at gmail.com  Fri Sep 14 02:35:30 2007
From: giovanni.porcari at gmail.com (Porcari Giovanni)
Date: Fri Sep 14 02:35:48 2007
Subject: [mod_python] MODPYTHON-225
Message-ID: <2E0830AA-0BAF-42E4-B9CD-CDF1A176CCB4@gmail.com>

Hi All

I am in the situation described here:
https://issues.apache.org/jira/browse/MODPYTHON-225

OSX 10.4.10 - apache 2.2.6 - modpython 3.3.1
I installed python 2.5.1 using binary from python.org.

the log file says:

[Fri Sep 14 08:24:35 2007] [error] python_init: Python version  
mismatch, expected '2.5.1', found '2.3.5'.
[Fri Sep 14 08:24:35 2007] [error] python_init: Python executable  
found '/usr/local/apache2/bin/httpd'.
[Fri Sep 14 08:24:35 2007] [error] python_init: Python path being  
used '/System/Library/Frameworks/Python.framework/Versions/2.3/lib/ 
python23.zip:/System/Library/Frameworks/Python.framework/Versions/2.3/ 
lib/python2.3/:/System/Library/Frameworks/Python.framework/Versions/ 
2.3/lib/python2.3/plat-darwin:/System/Library/Frameworks/ 
Python.framework/Versions/2.3/lib/python2.3/plat-mac:/System/Library/ 
Frameworks/Python.framework/Versions/2.3/lib/python2.3/plat-mac/lib- 
scriptpackages:/System/Library/Frameworks/Python.framework/Versions/ 
2.3/lib/python2.3/lib-tk:/System/Library/Frameworks/Python.framework/ 
Versions/2.3/lib/python2.3/lib-dynload'.
[Fri Sep 14 08:24:35 2007] [notice] mod_python: Creating 8 session  
mutexes based on 256 max processes and 0 max threads.
[Fri Sep 14 08:24:35 2007] [notice] mod_python: using  
mutex_directory /tmp
[Fri Sep 14 08:24:35 2007] [notice] Apache/2.2.6 (Unix) mod_python/ 
3.3.1 Python/2.3.5 configured -- resuming normal operations

So it seems that modpython find python 2.3.5 instead of 2.5.1.

After a lot of attempts and google search i'm giving up :(

Can you help me ?


Thank you

G.Porcari

From graham.dumpleton at gmail.com  Fri Sep 14 02:49:01 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Fri Sep 14 02:49:37 2007
Subject: [mod_python] MODPYTHON-225
In-Reply-To: <2E0830AA-0BAF-42E4-B9CD-CDF1A176CCB4@gmail.com>
References: <2E0830AA-0BAF-42E4-B9CD-CDF1A176CCB4@gmail.com>
Message-ID: <88e286470709132349h77a89a86p9c52505e8d9626bb@mail.gmail.com>

What do you get when run:

  otool -L mod_python.so

In the 'envvars' script file in the same directory as your httpd binary, add:

  PYTHONEXECUTABLE=/some/path/python
  export PYTHONEXECUTABLE

where the path is to the Python 2.5 executable.

Stop and then start (not restart) your Apache.

Does that help?

Graham

On 14/09/2007, Porcari Giovanni <giovanni.porcari@gmail.com> wrote:
> Hi All
>
> I am in the situation described here:
> https://issues.apache.org/jira/browse/MODPYTHON-225
>
> OSX 10.4.10 - apache 2.2.6 - modpython 3.3.1
> I installed python 2.5.1 using binary from python.org.
>
> the log file says:
>
> [Fri Sep 14 08:24:35 2007] [error] python_init: Python version
> mismatch, expected '2.5.1', found '2.3.5'.
> [Fri Sep 14 08:24:35 2007] [error] python_init: Python executable
> found '/usr/local/apache2/bin/httpd'.
> [Fri Sep 14 08:24:35 2007] [error] python_init: Python path being
> used '/System/Library/Frameworks/Python.framework/Versions/2.3/lib/
> python23.zip:/System/Library/Frameworks/Python.framework/Versions/2.3/
> lib/python2.3/:/System/Library/Frameworks/Python.framework/Versions/
> 2.3/lib/python2.3/plat-darwin:/System/Library/Frameworks/
> Python.framework/Versions/2.3/lib/python2.3/plat-mac:/System/Library/
> Frameworks/Python.framework/Versions/2.3/lib/python2.3/plat-mac/lib-
> scriptpackages:/System/Library/Frameworks/Python.framework/Versions/
> 2.3/lib/python2.3/lib-tk:/System/Library/Frameworks/Python.framework/
> Versions/2.3/lib/python2.3/lib-dynload'.
> [Fri Sep 14 08:24:35 2007] [notice] mod_python: Creating 8 session
> mutexes based on 256 max processes and 0 max threads.
> [Fri Sep 14 08:24:35 2007] [notice] mod_python: using
> mutex_directory /tmp
> [Fri Sep 14 08:24:35 2007] [notice] Apache/2.2.6 (Unix) mod_python/
> 3.3.1 Python/2.3.5 configured -- resuming normal operations
>
> So it seems that modpython find python 2.3.5 instead of 2.5.1.
>
> After a lot of attempts and google search i'm giving up :(
>
> Can you help me ?
>
>
> Thank you
>
> G.Porcari
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From graham.dumpleton at gmail.com  Fri Sep 14 04:33:47 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Fri Sep 14 04:34:00 2007
Subject: [mod_python] MODPYTHON-225
In-Reply-To: <F6CB2268-175D-46B8-A59F-A653C907BF60@gmail.com>
References: <2E0830AA-0BAF-42E4-B9CD-CDF1A176CCB4@gmail.com>
	<88e286470709132349h77a89a86p9c52505e8d9626bb@mail.gmail.com>
	<F6CB2268-175D-46B8-A59F-A653C907BF60@gmail.com>
Message-ID: <88e286470709140133m77192ef8ucabf1b6ba8d8c949@mail.gmail.com>

On 14/09/2007, Porcari Giovanni <giovanni.porcari@gmail.com> wrote:
>
> Il giorno 14/set/07, alle ore 08:49, Graham Dumpleton ha scritto:
>
> > What do you get when run:
> >
> >   otool -L mod_python.so
>
>
> MacBookGP:/usr/local/apache2/modules gporcari$ otool -L mod_python.so
> mod_python.so:
>          /usr/lib/libSystem.B.dylib (compatibility version 1.0.0,
> current version 88.1.3)
>          /System/Library/Frameworks/Python.framework/Versions/2.3/
> Python (compatibility version 2.3.0, current version 2.3.5)

This means mod_python was never correctly compiled against Python 2.5
in the first place.

The basic issue is that your Python 2.5 doesn't appear to be installed
in standard Apple frameworks directory, but somewhere else, eg,
/usr/local. What this means is that you have to modify the mod_python
src/Makefile after having run configure, and modify LDFLAGS, inserting
at the start something like:

  -Wl,-F/some/path/lib

where /some/path/lib is where your Python 2.5 framework library is installed.

This way it will find the correct version of the framework library
when linking and therefore at runtime hopefully also find the correct
one.

If still problems after this change, post the actual compilation
output where it is linking the mod_python.so so can see what option
and path you added. Also show new output from running otool on result.

Graham

BTW, please use reply all some response goes back onto mailing list.

> > In the 'envvars' script file in the same directory as your httpd
> > binary, add:
> >
> >   PYTHONEXECUTABLE=/some/path/python
> >   export PYTHONEXECUTABLE
>
> i added:
>
>   PYTHONEXECUTABLE='/usr/local/bin/python'
>    export PYTHONEXECUTABLE
>
> >
> > where the path is to the Python 2.5 executable.
> >
> > Stop and then start (not restart) your Apache.
> >
> > Does that help?
> >
>
> still not working :(
>
> G.
>
>
>
> > Graham
> >
> > On 14/09/2007, Porcari Giovanni <giovanni.porcari@gmail.com> wrote:
> >> Hi All
> >>
> >> I am in the situation described here:
> >> https://issues.apache.org/jira/browse/MODPYTHON-225
> >>
> >> OSX 10.4.10 - apache 2.2.6 - modpython 3.3.1
> >> I installed python 2.5.1 using binary from python.org.
> >>
> >> the log file says:
> >>
> >> [Fri Sep 14 08:24:35 2007] [error] python_init: Python version
> >> mismatch, expected '2.5.1', found '2.3.5'.
> >> [Fri Sep 14 08:24:35 2007] [error] python_init: Python executable
> >> found '/usr/local/apache2/bin/httpd'.
> >> [Fri Sep 14 08:24:35 2007] [error] python_init: Python path being
> >> used '/System/Library/Frameworks/Python.framework/Versions/2.3/lib/
> >> python23.zip:/System/Library/Frameworks/Python.framework/Versions/
> >> 2.3/
> >> lib/python2.3/:/System/Library/Frameworks/Python.framework/Versions/
> >> 2.3/lib/python2.3/plat-darwin:/System/Library/Frameworks/
> >> Python.framework/Versions/2.3/lib/python2.3/plat-mac:/System/Library/
> >> Frameworks/Python.framework/Versions/2.3/lib/python2.3/plat-mac/lib-
> >> scriptpackages:/System/Library/Frameworks/Python.framework/Versions/
> >> 2.3/lib/python2.3/lib-tk:/System/Library/Frameworks/Python.framework/
> >> Versions/2.3/lib/python2.3/lib-dynload'.
> >> [Fri Sep 14 08:24:35 2007] [notice] mod_python: Creating 8 session
> >> mutexes based on 256 max processes and 0 max threads.
> >> [Fri Sep 14 08:24:35 2007] [notice] mod_python: using
> >> mutex_directory /tmp
> >> [Fri Sep 14 08:24:35 2007] [notice] Apache/2.2.6 (Unix) mod_python/
> >> 3.3.1 Python/2.3.5 configured -- resuming normal operations
> >>
> >> So it seems that modpython find python 2.3.5 instead of 2.5.1.
> >>
> >> After a lot of attempts and google search i'm giving up :(
> >>
> >> Can you help me ?
> >>
> >>
> >> Thank you
> >>
> >> G.Porcari
> >>
> >> _______________________________________________
> >> Mod_python mailing list
> >> Mod_python@modpython.org
> >> http://mailman.modpython.org/mailman/listinfo/mod_python
> >>
>
>
From giovanni.porcari at gmail.com  Fri Sep 14 05:26:39 2007
From: giovanni.porcari at gmail.com (Porcari Giovanni)
Date: Fri Sep 14 05:27:08 2007
Subject: [mod_python] MODPYTHON-225
In-Reply-To: <88e286470709140133m77192ef8ucabf1b6ba8d8c949@mail.gmail.com>
References: <2E0830AA-0BAF-42E4-B9CD-CDF1A176CCB4@gmail.com>
	<88e286470709132349h77a89a86p9c52505e8d9626bb@mail.gmail.com>
	<F6CB2268-175D-46B8-A59F-A653C907BF60@gmail.com>
	<88e286470709140133m77192ef8ucabf1b6ba8d8c949@mail.gmail.com>
Message-ID: <4FFD6826-A5E0-4C46-BAD4-7533A47A8407@gmail.com>


Il giorno 14/set/07, alle ore 10:33, Graham Dumpleton ha scritto:

> On 14/09/2007, Porcari Giovanni <giovanni.porcari@gmail.com> wrote:
>>
>> Il giorno 14/set/07, alle ore 08:49, Graham Dumpleton ha scritto:
>>
>>> What do you get when run:
>>>
>>>   otool -L mod_python.so
>>
>>
>> MacBookGP:/usr/local/apache2/modules gporcari$ otool -L mod_python.so
>> mod_python.so:
>>          /usr/lib/libSystem.B.dylib (compatibility version 1.0.0,
>> current version 88.1.3)
>>          /System/Library/Frameworks/Python.framework/Versions/2.3/
>> Python (compatibility version 2.3.0, current version 2.3.5)
>
> This means mod_python was never correctly compiled against Python 2.5
> in the first place.
>
> The basic issue is that your Python 2.5 doesn't appear to be installed
> in standard Apple frameworks directory, but somewhere else, eg,
> /usr/local. What this means is that you have to modify the mod_python
> src/Makefile after having run configure, and modify LDFLAGS, inserting
> at the start something like:
>
>   -Wl,-F/some/path/lib
>
> where /some/path/lib is where your Python 2.5 framework library is  
> installed.
>
> This way it will find the correct version of the framework library
> when linking and therefore at runtime hopefully also find the correct
> one.



Hi Ghraham


I am not sure about the path I should set in -Wl,-F/some/path/lib.
for example site-packages path is:

/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site- 
packages

so Python 2.5 framework library is just /Library/Frameworks/ 
Python.framework or
/Library/Frameworks/Python.framework/Versions/2.5 or
/Library/Frameworks/Python.framework/Versions/2.5/lib/python2 ?

however i attach the make output.

Thank you
G


-------------------------------------------------

MacBookGP:~/Desktop/Installazioni/mod_python-3.3.1 gporcari$ make

Compiling for DSO.

/usr/local/apache2/bin/apxs -I/Users/gporcari/Desktop/Installazioni/ 
mod_python-3.3.1/src/include -I/usr/local/apache2/include -I/Library/ 
Frameworks/Python.framework/Versions/2.5/include/python2.5 -c  
mod_python.c _apachemodule.c requestobject.c tableobject.c util.c  
serverobject.c connobject.c filterobject.c hlist.c hlistobject.c  
finfoobject.c -Wl,-framework,Python  -u _PyMac_Error /Versions//   - 
arch i386 -arch ppc -isysroot /Developer/SDKs/MacOSX10.4u.sdk -g    - 
lm  -framework  Python    -ldl
/usr/local/apache2/build/libtool --silent --mode=compile gcc -prefer- 
pic   -DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp -g -O2 - 
I/usr/local/apache2/include  -I/usr/local/apache2/include   -I/usr/ 
local/apache2/include  -I/Users/gporcari/Desktop/Installazioni/ 
mod_python-3.3.1/src/include -I/usr/local/apache2/include -I/Library/ 
Frameworks/Python.framework/Versions/2.5/include/python2.5  -c -o  
mod_python.lo mod_python.c && touch mod_python.slo
mod_python.c: In function 'python_init':
mod_python.c:826: warning: initialization from incompatible pointer type
/usr/local/apache2/build/libtool --silent --mode=compile gcc -prefer- 
pic   -DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp -g -O2 - 
I/usr/local/apache2/include  -I/usr/local/apache2/include   -I/usr/ 
local/apache2/include  -I/Users/gporcari/Desktop/Installazioni/ 
mod_python-3.3.1/src/include -I/usr/local/apache2/include -I/Library/ 
Frameworks/Python.framework/Versions/2.5/include/python2.5  -c -o  
_apachemodule.lo _apachemodule.c && touch _apachemodule.slo
/usr/local/apache2/build/libtool --silent --mode=compile gcc -prefer- 
pic   -DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp -g -O2 - 
I/usr/local/apache2/include  -I/usr/local/apache2/include   -I/usr/ 
local/apache2/include  -I/Users/gporcari/Desktop/Installazioni/ 
mod_python-3.3.1/src/include -I/usr/local/apache2/include -I/Library/ 
Frameworks/Python.framework/Versions/2.5/include/python2.5  -c -o  
requestobject.lo requestobject.c && touch requestobject.slo
/usr/local/apache2/build/libtool --silent --mode=compile gcc -prefer- 
pic   -DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp -g -O2 - 
I/usr/local/apache2/include  -I/usr/local/apache2/include   -I/usr/ 
local/apache2/include  -I/Users/gporcari/Desktop/Installazioni/ 
mod_python-3.3.1/src/include -I/usr/local/apache2/include -I/Library/ 
Frameworks/Python.framework/Versions/2.5/include/python2.5  -c -o  
tableobject.lo tableobject.c && touch tableobject.slo
tableobject.c:329: warning: initialization from incompatible pointer  
type
tableobject.c:1092: warning: initialization from incompatible pointer  
type
/usr/local/apache2/build/libtool --silent --mode=compile gcc -prefer- 
pic   -DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp -g -O2 - 
I/usr/local/apache2/include  -I/usr/local/apache2/include   -I/usr/ 
local/apache2/include  -I/Users/gporcari/Desktop/Installazioni/ 
mod_python-3.3.1/src/include -I/usr/local/apache2/include -I/Library/ 
Frameworks/Python.framework/Versions/2.5/include/python2.5  -c -o  
util.lo util.c && touch util.slo
/usr/local/apache2/build/libtool --silent --mode=compile gcc -prefer- 
pic   -DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp -g -O2 - 
I/usr/local/apache2/include  -I/usr/local/apache2/include   -I/usr/ 
local/apache2/include  -I/Users/gporcari/Desktop/Installazioni/ 
mod_python-3.3.1/src/include -I/usr/local/apache2/include -I/Library/ 
Frameworks/Python.framework/Versions/2.5/include/python2.5  -c -o  
serverobject.lo serverobject.c && touch serverobject.slo
serverobject.c:387: warning: initialization from incompatible pointer  
type
/usr/local/apache2/build/libtool --silent --mode=compile gcc -prefer- 
pic   -DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp -g -O2 - 
I/usr/local/apache2/include  -I/usr/local/apache2/include   -I/usr/ 
local/apache2/include  -I/Users/gporcari/Desktop/Installazioni/ 
mod_python-3.3.1/src/include -I/usr/local/apache2/include -I/Library/ 
Frameworks/Python.framework/Versions/2.5/include/python2.5  -c -o  
connobject.lo connobject.c && touch connobject.slo
/usr/local/apache2/build/libtool --silent --mode=compile gcc -prefer- 
pic   -DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp -g -O2 - 
I/usr/local/apache2/include  -I/usr/local/apache2/include   -I/usr/ 
local/apache2/include  -I/Users/gporcari/Desktop/Installazioni/ 
mod_python-3.3.1/src/include -I/usr/local/apache2/include -I/Library/ 
Frameworks/Python.framework/Versions/2.5/include/python2.5  -c -o  
filterobject.lo filterobject.c && touch filterobject.slo
/usr/local/apache2/build/libtool --silent --mode=compile gcc -prefer- 
pic   -DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp -g -O2 - 
I/usr/local/apache2/include  -I/usr/local/apache2/include   -I/usr/ 
local/apache2/include  -I/Users/gporcari/Desktop/Installazioni/ 
mod_python-3.3.1/src/include -I/usr/local/apache2/include -I/Library/ 
Frameworks/Python.framework/Versions/2.5/include/python2.5  -c -o  
hlist.lo hlist.c && touch hlist.slo
/usr/local/apache2/build/libtool --silent --mode=compile gcc -prefer- 
pic   -DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp -g -O2 - 
I/usr/local/apache2/include  -I/usr/local/apache2/include   -I/usr/ 
local/apache2/include  -I/Users/gporcari/Desktop/Installazioni/ 
mod_python-3.3.1/src/include -I/usr/local/apache2/include -I/Library/ 
Frameworks/Python.framework/Versions/2.5/include/python2.5  -c -o  
hlistobject.lo hlistobject.c && touch hlistobject.slo
/usr/local/apache2/build/libtool --silent --mode=compile gcc -prefer- 
pic   -DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp -g -O2 - 
I/usr/local/apache2/include  -I/usr/local/apache2/include   -I/usr/ 
local/apache2/include  -I/Users/gporcari/Desktop/Installazioni/ 
mod_python-3.3.1/src/include -I/usr/local/apache2/include -I/Library/ 
Frameworks/Python.framework/Versions/2.5/include/python2.5  -c -o  
finfoobject.lo finfoobject.c && touch finfoobject.slo
finfoobject.c:278: warning: 'intargfunc' is deprecated
finfoobject.c:278: warning: initialization from incompatible pointer  
type
/usr/local/apache2/build/libtool --silent --mode=link gcc -o  
mod_python.la  -rpath /usr/local/apache2/modules -module -avoid- 
version    finfoobject.lo hlistobject.lo hlist.lo filterobject.lo  
connobject.lo serverobject.lo util.lo tableobject.lo requestobject.lo  
_apachemodule.lo mod_python.lo -Wl,-framework,Python -u _PyMac_Error / 
Versions// -arch i386 -arch ppc -isysroot /Developer/SDKs/ 
MacOSX10.4u.sdk -g -lm -framework Python -ldl
/usr/bin/ld: for architecture ppc
/usr/bin/ld: warning .libs/finfoobject.o cputype (7, architecture  
i386) does not match cputype (18) for specified -arch flag: ppc (file  
not loaded)
/usr/bin/ld: warning .libs/hlistobject.o cputype (7, architecture  
i386) does not match cputype (18) for specified -arch flag: ppc (file  
not loaded)
/usr/bin/ld: warning .libs/hlist.o cputype (7, architecture i386)  
does not match cputype (18) for specified -arch flag: ppc (file not  
loaded)
/usr/bin/ld: warning .libs/filterobject.o cputype (7, architecture  
i386) does not match cputype (18) for specified -arch flag: ppc (file  
not loaded)
/usr/bin/ld: warning .libs/connobject.o cputype (7, architecture  
i386) does not match cputype (18) for specified -arch flag: ppc (file  
not loaded)
/usr/bin/ld: warning .libs/serverobject.o cputype (7, architecture  
i386) does not match cputype (18) for specified -arch flag: ppc (file  
not loaded)
/usr/bin/ld: warning .libs/util.o cputype (7, architecture i386) does  
not match cputype (18) for specified -arch flag: ppc (file not loaded)
/usr/bin/ld: warning .libs/tableobject.o cputype (7, architecture  
i386) does not match cputype (18) for specified -arch flag: ppc (file  
not loaded)
/usr/bin/ld: warning .libs/requestobject.o cputype (7, architecture  
i386) does not match cputype (18) for specified -arch flag: ppc (file  
not loaded)
/usr/bin/ld: warning .libs/_apachemodule.o cputype (7, architecture  
i386) does not match cputype (18) for specified -arch flag: ppc (file  
not loaded)
/usr/bin/ld: warning .libs/mod_python.o cputype (7, architecture  
i386) does not match cputype (18) for specified -arch flag: ppc (file  
not loaded)
ln -s ../lib/python/mod_python mod_python
ln -s ../src src
make[2]: `psp_parser.c' is up to date.
/Library/Frameworks/Python.framework/Versions/Current/bin/python  
setup.py build
running build
running build_py
creating build
creating build/lib.macosx-10.3-fat-2.5
creating build/lib.macosx-10.3-fat-2.5/mod_python
copying /Users/gporcari/Desktop/Installazioni/mod_python-3.3.1/lib/ 
python/mod_python/__init__.py -> build/lib.macosx-10.3-fat-2.5/ 
mod_python
copying /Users/gporcari/Desktop/Installazioni/mod_python-3.3.1/lib/ 
python/mod_python/apache.py -> build/lib.macosx-10.3-fat-2.5/mod_python
copying /Users/gporcari/Desktop/Installazioni/mod_python-3.3.1/lib/ 
python/mod_python/cache.py -> build/lib.macosx-10.3-fat-2.5/mod_python
copying /Users/gporcari/Desktop/Installazioni/mod_python-3.3.1/lib/ 
python/mod_python/cgihandler.py -> build/lib.macosx-10.3-fat-2.5/ 
mod_python
copying /Users/gporcari/Desktop/Installazioni/mod_python-3.3.1/lib/ 
python/mod_python/Cookie.py -> build/lib.macosx-10.3-fat-2.5/mod_python
copying /Users/gporcari/Desktop/Installazioni/mod_python-3.3.1/lib/ 
python/mod_python/importer.py -> build/lib.macosx-10.3-fat-2.5/ 
mod_python
copying /Users/gporcari/Desktop/Installazioni/mod_python-3.3.1/lib/ 
python/mod_python/psp.py -> build/lib.macosx-10.3-fat-2.5/mod_python
copying /Users/gporcari/Desktop/Installazioni/mod_python-3.3.1/lib/ 
python/mod_python/publisher.py -> build/lib.macosx-10.3-fat-2.5/ 
mod_python
copying /Users/gporcari/Desktop/Installazioni/mod_python-3.3.1/lib/ 
python/mod_python/python22.py -> build/lib.macosx-10.3-fat-2.5/ 
mod_python
copying /Users/gporcari/Desktop/Installazioni/mod_python-3.3.1/lib/ 
python/mod_python/Session.py -> build/lib.macosx-10.3-fat-2.5/mod_python
copying /Users/gporcari/Desktop/Installazioni/mod_python-3.3.1/lib/ 
python/mod_python/testhandler.py -> build/lib.macosx-10.3-fat-2.5/ 
mod_python
copying /Users/gporcari/Desktop/Installazioni/mod_python-3.3.1/lib/ 
python/mod_python/util.py -> build/lib.macosx-10.3-fat-2.5/mod_python
running build_ext
building 'mod_python._psp' extension
creating build/temp.macosx-10.3-fat-2.5
creating build/temp.macosx-10.3-fat-2.5/Users
creating build/temp.macosx-10.3-fat-2.5/Users/gporcari
creating build/temp.macosx-10.3-fat-2.5/Users/gporcari/Desktop
creating build/temp.macosx-10.3-fat-2.5/Users/gporcari/Desktop/ 
Installazioni
creating build/temp.macosx-10.3-fat-2.5/Users/gporcari/Desktop/ 
Installazioni/mod_python-3.3.1
creating build/temp.macosx-10.3-fat-2.5/Users/gporcari/Desktop/ 
Installazioni/mod_python-3.3.1/src
gcc -arch ppc -arch i386 -isysroot /Developer/SDKs/MacOSX10.4u.sdk - 
fno-strict-aliasing -Wno-long-double -no-cpp-precomp -mno-fused-madd - 
fno-common -dynamic -DNDEBUG -g -O3 -I/Users/gporcari/Desktop/ 
Installazioni/mod_python-3.3.1/src/include -I/Library/Frameworks/ 
Python.framework/Versions/2.5/include/python2.5 -c /Users/gporcari/ 
Desktop/Installazioni/mod_python-3.3.1/src/psp_string.c -o build/ 
temp.macosx-10.3-fat-2.5/Users/gporcari/Desktop/Installazioni/ 
mod_python-3.3.1/src/psp_string.o
gcc -arch ppc -arch i386 -isysroot /Developer/SDKs/MacOSX10.4u.sdk - 
fno-strict-aliasing -Wno-long-double -no-cpp-precomp -mno-fused-madd - 
fno-common -dynamic -DNDEBUG -g -O3 -I/Users/gporcari/Desktop/ 
Installazioni/mod_python-3.3.1/src/include -I/Library/Frameworks/ 
Python.framework/Versions/2.5/include/python2.5 -c /Users/gporcari/ 
Desktop/Installazioni/mod_python-3.3.1/src/psp_parser.c -o build/ 
temp.macosx-10.3-fat-2.5/Users/gporcari/Desktop/Installazioni/ 
mod_python-3.3.1/src/psp_parser.o
gcc -arch ppc -arch i386 -isysroot /Developer/SDKs/MacOSX10.4u.sdk - 
fno-strict-aliasing -Wno-long-double -no-cpp-precomp -mno-fused-madd - 
fno-common -dynamic -DNDEBUG -g -O3 -I/Users/gporcari/Desktop/ 
Installazioni/mod_python-3.3.1/src/include -I/Library/Frameworks/ 
Python.framework/Versions/2.5/include/python2.5 -c /Users/gporcari/ 
Desktop/Installazioni/mod_python-3.3.1/src/_pspmodule.c -o build/ 
temp.macosx-10.3-fat-2.5/Users/gporcari/Desktop/Installazioni/ 
mod_python-3.3.1/src/_pspmodule.o
gcc -arch i386 -arch ppc -isysroot /Developer/SDKs/MacOSX10.4u.sdk -g  
-bundle -undefined dynamic_lookup build/temp.macosx-10.3-fat-2.5/ 
Users/gporcari/Desktop/Installazioni/mod_python-3.3.1/src/ 
psp_string.o build/temp.macosx-10.3-fat-2.5/Users/gporcari/Desktop/ 
Installazioni/mod_python-3.3.1/src/psp_parser.o build/ 
temp.macosx-10.3-fat-2.5/Users/gporcari/Desktop/Installazioni/ 
mod_python-3.3.1/src/_pspmodule.o -o build/lib.macosx-10.3-fat-2.5/ 
mod_python/_psp.so

Now su and make install
   (or, if you only want to perform a partial install,
    you can use make install_dso and make install_py_lib)
From graham.carlyle at maplecroft.net  Fri Sep 14 05:40:23 2007
From: graham.carlyle at maplecroft.net (Graham Carlyle)
Date: Fri Sep 14 05:40:47 2007
Subject: [mod_python] importing egg format libs installed on a custom path
In-Reply-To: <88e286470709131528l27b390e7s93b1b5215ab5999@mail.gmail.com>
References: <1189691582.6048.16.camel@charon>
	<88e286470709131528l27b390e7s93b1b5215ab5999@mail.gmail.com>
Message-ID: <1189762823.6041.13.camel@charon>

Ah, I'm now not sure what was happening before as this morning what I
described isn't working. So sorry for the muddle.

However after checking what was on sys.path from a modpython handler &
also from the shell with the correct PYTHONPATH. The difference was the
egg...

from modpython handler:
Path is ['/opt/apps/simple',
'/opt/python/python-2.5.1/lib/python25.zip',
'/opt/python/python-2.5.1/lib/python2.5',
'/opt/python/python-2.5.1/lib/python2.5/plat-linux2',
'/opt/python/python-2.5.1/lib/python2.5/lib-tk',
'/opt/python/python-2.5.1/lib/python2.5/lib-dynload',
'/opt/python/python-2.5.1/lib/python2.5/site-packages']

from python shell:
>>> import sys
>>> sys.path
['', '/opt/apps/simple/feedparser-4.1-py2.5.egg', '/opt/apps/simple',
'/opt/python/python-2.5.1/lib/python25.zip',
'/opt/python/python-2.5.1/lib/python2.5',
'/opt/python/python-2.5.1/lib/python2.5/plat-linux2',
'/opt/python/python-2.5.1/lib/python2.5/lib-tk',
'/opt/python/python-2.5.1/lib/python2.5/lib-dynload',
'/opt/python/python-2.5.1/lib/python2.5/site-packages']

So I added the egg path explicitly to the apache PythonPath directive
and now the modpython handler happily finds the module.

So my modpython config is now...

<Location "/simple">
    PythonPath "['/opt/apps/simple/feedparser-4.1-py2.5.egg',
'/opt/apps/simple'] + sys.path"
    SetHandler python-program
    PythonHandler handler
    PythonDebug On
    PythonInterpreter simple
</Location>

So I guess my question is now... do egg based modules need to be
unzipped & explicitly mentioned on the python path? If so this seems to
bypass all the pth stuff that egg versioning works off.

thanks,
Graham

On Fri, 2007-09-14 at 08:28 +1000, Graham Dumpleton wrote:
> Have you confirmed that in your application sys.path includes the
> directory you expect to be there?
> 
> What is the remainder of your Apache configuration for setting up
> mod_python handler? Ie., what context are you setting PythonHandler
> etc.
> 
> Grahamd
> 
> On 13/09/2007, Graham Carlyle <graham.carlyle@maplecroft.net> wrote:
> > Hi
> >
> > I'm trying to setup an application via mod_python and want to place some
> > required libraries, that are python eggs, on an application specific
> > path.
> >
> > So I use...
> >
> > <LocationMatch ...>
> >
> > ...
> > PythonPath "['/opt/apps/foo/lib/'] + sys.path"
> > PythonInterpreter foo
> > ...
> >
> > </LocationMatch>
> >
> > But the application doesn't pick up on the eggs that were installed in
> > "/opt/apps/foo/lib/". Although the python shell can import the libs
> > after setting PYTHONPATH to this path.
> >
> > However I can get the webapp to find the eggs if I add to the apache
> > conf...
> >
> > PythonImport /opt/apps/foo/lib/site.py foo
> >
> > site.py being a file the easy_install created when i installed the eggs
> > to the custom path.
> >
> > Is this the recommended way of installing eggs to a custom path? Are
> > there problems with this "solution".
> >
> > I had a trawl and couldn't find any info on this sort of problem in the
> > mailing list which surprised me.
> >
> > thanks,
> > Graham
> >
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >

From graham.dumpleton at gmail.com  Fri Sep 14 05:57:02 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Fri Sep 14 05:57:13 2007
Subject: [mod_python] MODPYTHON-225
In-Reply-To: <4FFD6826-A5E0-4C46-BAD4-7533A47A8407@gmail.com>
References: <2E0830AA-0BAF-42E4-B9CD-CDF1A176CCB4@gmail.com>
	<88e286470709132349h77a89a86p9c52505e8d9626bb@mail.gmail.com>
	<F6CB2268-175D-46B8-A59F-A653C907BF60@gmail.com>
	<88e286470709140133m77192ef8ucabf1b6ba8d8c949@mail.gmail.com>
	<4FFD6826-A5E0-4C46-BAD4-7533A47A8407@gmail.com>
Message-ID: <88e286470709140257t229341b7mb34a676be3feea3e@mail.gmail.com>

How did you install Python 2.5, from source code or a binary installer?

The OS supplied Python framework is located at:

  /System/Library/Frameworks/Python.framework

In your case, for whatever reason is it instead at:

  /Library/Frameworks/Python.framework

I don't trust binary installers to not screw up my OS version so don't
install them, thus don't know if them installing in
/Library/Frameworks is what they do or not.

Anyway, use:

   -Wl,-F/Library/Frameworks

and see if that works.

If someone else is using Python 2.5 on Mac with mod_python, can you
indicate where the Python 2.5 is installed?

Graham

On 14/09/2007, Porcari Giovanni <giovanni.porcari@gmail.com> wrote:
>
> Il giorno 14/set/07, alle ore 10:33, Graham Dumpleton ha scritto:
>
> > On 14/09/2007, Porcari Giovanni <giovanni.porcari@gmail.com> wrote:
> >>
> >> Il giorno 14/set/07, alle ore 08:49, Graham Dumpleton hacritto:
> >>
> >>> What do you get when run:
> >>>
> >>>   otool -L mod_python.so
> >>
> >>
> >> MacBookGP:/usr/local/apache2/modules gporcari$ otool -L mod_python.so
> >> mod_python.so:
> >>          /usr/lib/libSystem.B.dylib (compatibility version 1.0.0,
> >> current version 88.1.3)
> >>          /System/Library/Frameworks/Python.framework/Versions/2.3/
> >> Python (compatibility version 2.3.0, current version 2.3.5)
> >
> > This means mod_python was never correctly compiled against Python 2.5
> > in the first place.
> >
> > The basic issue is that your Python 2.5 doesn't appear to be installed
> > in standard Apple frameworks directory, but somewhere else, eg,
> > /usr/local. What this means is that you have to modify the mod_python
> > src/Makefile after having run configure, and modify LDFLAGS, inserting
> > at the start something like:
> >
> >   -Wl,-F/some/path/lib
> >
> > where /some/path/lib is where your Python 2.5 framework library is
> > installed.
> >
> > This way it will find the correct version of the framework library
> > when linking and therefore at runtime hopefully also find the correct
> > one.
>
>
>
> Hi Ghraham
>
>
> I am not sure about the path I should set in -Wl,-F/some/path/lib.
> for example site-packages path is:
>
> /Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/site-
> packages
>
> so Python 2.5 framework library is just /Library/Frameworks/
> Python.framework or
> /Library/Frameworks/Python.framework/Versions/2.5 or
> /Library/Frameworks/Python.framework/Versions/2.5/lib/python2 ?
>
> however i attach the make output.
>
> Thank you
> G
>
>
> -------------------------------------------------
>
> MacBookGP:~/Desktop/Installazioni/mod_python-3.3.1 gporcari$ make
>
> Compiling for DSO.
>
> /usr/local/apache2/bin/apxs -I/Users/gporcari/Desktop/Installazioni/
> mod_python-3.3.1/src/include -I/usr/local/apache2/include -I/Library/
> Frameworks/Python.framework/Versions/2.5/include/python2.5 -c
> mod_python.c _apachemodule.c requestobject.c tableobject.c util.c
> serverobject.c connobject.c filterobject.c hlist.c hlistobject.c
> finfoobject.c -Wl,-framework,Python  -u _PyMac_Error /Versions//   -
> arch i386 -arch ppc -isysroot /Developer/SDKs/MacOSX10.4u.sdk -g    -
> lm  -framework  Python    -ldl
> /usr/local/apache2/build/libtool --silent --mode=compile gcc -prefer-
> pic   -DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp -g -O2 -
> I/usr/local/apache2/include  -I/usr/local/apache2/include   -I/usr/
> local/apache2/include  -I/Users/gporcari/Desktop/Installazioni/
> mod_python-3.3.1/src/include -I/usr/local/apache2/include -I/Library/
> Frameworks/Python.framework/Versions/2.5/include/python2.5  -c -o
> mod_python.lo mod_python.c && touch mod_python.slo
> mod_python.c: In function 'python_init':
> mod_python.c:826: warning: initialization from incompatible pointer type
> /usr/local/apache2/build/libtool --silent --mode=compile gcc -prefer-
> pic   -DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp -g -O2 -
> I/usr/local/apache2/include  -I/usr/local/apache2/include   -I/usr/
> local/apache2/include  -I/Users/gporcari/Desktop/Installazioni/
> mod_python-3.3.1/src/include -I/usr/local/apache2/include -I/Library/
> Frameworks/Python.framework/Versions/2.5/include/python2.5  -c -o
> _apachemodule.lo _apachemodule.c && touch _apachemodule.slo
> /usr/local/apache2/build/libtool --silent --mode=compile gcc -prefer-
> pic   -DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp -g -O2 -
> I/usr/local/apache2/include  -I/usr/local/apache2/include   -I/usr/
> local/apache2/include  -I/Users/gporcari/Desktop/Installazioni/
> mod_python-3.3.1/src/include -I/usr/local/apache2/include -I/Library/
> Frameworks/Python.framework/Versions/2.5/include/python2.5  -c -o
> requestobject.lo requestobject.c && touch requestobject.slo
> /usr/local/apache2/build/libtool --silent --mode=compile gcc -prefer-
> pic   -DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp -g -O2 -
> I/usr/local/apache2/include  -I/usr/local/apache2/include   -I/usr/
> local/apache2/include  -I/Users/gporcari/Desktop/Installazioni/
> mod_python-3.3.1/src/include -I/usr/local/apache2/include -I/Library/
> Frameworks/Python.framework/Versions/2.5/include/python2.5  -c -o
> tableobject.lo tableobject.c && touch tableobject.slo
> tableobject.c:329: warning: initialization from incompatible pointer
> type
> tableobject.c:1092: warning: initialization from incompatible pointer
> type
> /usr/local/apache2/build/libtool --silent --mode=compile gcc -prefer-
> pic   -DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp -g -O2 -
> I/usr/local/apache2/include  -I/usr/local/apache2/include   -I/usr/
> local/apache2/include  -I/Users/gporcari/Desktop/Installazioni/
> mod_python-3.3.1/src/include -I/usr/local/apache2/include -I/Library/
> Frameworks/Python.framework/Versions/2.5/include/python2.5  -c -o
> util.lo util.c && touch util.slo
> /usr/local/apache2/build/libtool --silent --mode=compile gcc -prefer-
> pic   -DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp -g -O2 -
> I/usr/local/apache2/include  -I/usr/local/apache2/include   -I/usr/
> local/apache2/include  -I/Users/gporcari/Desktop/Installazioni/
> mod_python-3.3.1/src/include -I/usr/local/apache2/include -I/Library/
> Frameworks/Python.framework/Versions/2.5/include/python2.5  -c -o
> serverobject.lo serverobject.c && touch serverobject.slo
> serverobject.c:387: warning: initialization from incompatible pointer
> type
> /usr/local/apache2/build/libtool --silent --mode=compile gcc -prefer-
> pic   -DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp -g -O2 -
> I/usr/local/apache2/include  -I/usr/local/apache2/include   -I/usr/
> local/apache2/include  -I/Users/gporcari/Desktop/Installazioni/
> mod_python-3.3.1/src/include -I/usr/local/apache2/include -I/Library/
> Frameworks/Python.framework/Versions/2.5/include/python2.5  -c -o
> connobject.lo connobject.c && touch connobject.slo
> /usr/local/apache2/build/libtool --silent --mode=compile gcc -prefer-
> pic   -DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp -g -O2 -
> I/usr/local/apache2/include  -I/usr/local/apache2/include   -I/usr/
> local/apache2/include  -I/Users/gporcari/Desktop/Installazioni/
> mod_python-3.3.1/src/include -I/usr/local/apache2/include -I/Library/
> Frameworks/Python.framework/Versions/2.5/include/python2.5  -c -o
> filterobject.lo filterobject.c && touch filterobject.slo
> /usr/local/apache2/build/libtool --silent --mode=compile gcc -prefer-
> pic   -DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp -g -O2 -
> I/usr/local/apache2/include  -I/usr/local/apache2/include   -I/usr/
> local/apache2/include  -I/Users/gporcari/Desktop/Installazioni/
> mod_python-3.3.1/src/include -I/usr/local/apache2/include -I/Library/
> Frameworks/Python.framework/Versions/2.5/include/python2.5  -c -o
> hlist.lo hlist.c && touch hlist.slo
> /usr/local/apache2/build/libtool --silent --mode=compile gcc -prefer-
> pic   -DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp -g -O2 -
> I/usr/local/apache2/include  -I/usr/local/apache2/include   -I/usr/
> local/apache2/include  -I/Users/gporcari/Desktop/Installazioni/
> mod_python-3.3.1/src/include -I/usr/local/apache2/include -I/Library/
> Frameworks/Python.framework/Versions/2.5/include/python2.5  -c -o
> hlistobject.lo hlistobject.c && touch hlistobject.slo
> /usr/local/apache2/build/libtool --silent --mode=compile gcc -prefer-
> pic   -DDARWIN -DSIGPROCMASK_SETS_THREAD_MASK -no-cpp-precomp -g -O2 -
> I/usr/local/apache2/include  -I/usr/local/apache2/include   -I/usr/
> local/apache2/include  -I/Users/gporcari/Desktop/Installazioni/
> mod_python-3.3.1/src/include -I/usr/local/apache2/include -I/Library/
> Frameworks/Python.framework/Versions/2.5/include/python2.5  -c -o
> finfoobject.lo finfoobject.c && touch finfoobject.slo
> finfoobject.c:278: warning: 'intargfunc' is deprecated
> finfoobject.c:278: warning: initialization from incompatible pointer
> type
> /usr/local/apache2/build/libtool --silent --mode=link gcc -o
> mod_python.la  -rpath /usr/local/apache2/modules -module -avoid-
> version    finfoobject.lo hlistobject.lo hlist.lo filterobject.lo
> connobject.lo serverobject.lo util.lo tableobject.lo requestobject.lo
> _apachemodule.lo mod_python.lo -Wl,-framework,Python -u _PyMac_Error /
> Versions// -arch i386 -arch ppc -isysroot /Developer/SDKs/
> MacOSX10.4u.sdk -g -lm -framework Python -ldl
> /usr/bin/ld: for architecture ppc
> /usr/bin/ld: warning .libs/finfoobject.o cputype (7, architecture
> i386) does not match cputype (18) for specified -arch flag: ppc (file
> not loaded)
> /usr/bin/ld: warning .libs/hlistobject.o cputype (7, architecture
> i386) does not match cputype (18) for specified -arch flag: ppc (file
> not loaded)
> /usr/bin/ld: warning .libs/hlist.o cputype (7, architecture i386)
> does not match cputype (18) for specified -arch flag: ppc (file not
> loaded)
> /usr/bin/ld: warning .libs/filterobject.o cputype (7, architecture
> i386) does not match cputype (18) for specified -arch flag: ppc (file
> not loaded)
> /usr/bin/ld: warning .libs/connobject.o cputype (7, architecture
> i386) does not match cputype (18) for specified -arch flag: ppc (file
> not loaded)
> /usr/bin/ld: warning .libs/serverobject.o cputype (7, architecture
> i386) does not match cputype (18) for specified -arch flag: ppc (file
> not loaded)
> /usr/bin/ld: warning .libs/util.o cputype (7, architecture i386) does
> not match cputype (18) for specified -arch flag: ppc (file not loaded)
> /usr/bin/ld: warning .libs/tableobject.o cputype (7, architecture
> i386) does not match cputype (18) for specified -arch flag: ppc (file
> not loaded)
> /usr/bin/ld: warning .libs/requestobject.o cputype (7, architecture
> i386) does not match cputype (18) for specified -arch flag: ppc (file
> not loaded)
> /usr/bin/ld: warning .libs/_apachemodule.o cputype (7, architecture
> i386) does not match cputype (18) for specified -arch flag: ppc (file
> not loaded)
> /usr/bin/ld: warning .libs/mod_python.o cputype (7, architecture
> i386) does not match cputype (18) for specified -arch flag: ppc (file
> not loaded)
> ln -s ../lib/python/mod_python mod_python
> ln -s ../src src
> make[2]: `psp_parser.c' is up to date.
> /Library/Frameworks/Python.framework/Versions/Current/bin/python
> setup.py build
> running build
> running build_py
> creating build
> creating build/lib.macosx-10.3-fat-2.5
> creating build/lib.macosx-10.3-fat-2.5/mod_python
> copying /Users/gporcari/Desktop/Installazioni/mod_python-3.3.1/lib/
> python/mod_python/__init__.py -> build/lib.macosx-10.3-fat-2.5/
> mod_python
> copying /Users/gporcari/Desktop/Installazioni/mod_python-3.3.1/lib/
> python/mod_python/apache.py -> build/lib.macosx-10.3-fat-2.5/mod_python
> copying /Users/gporcari/Desktop/Installazioni/mod_python-3.3.1/lib/
> python/mod_python/cache.py -> build/lib.macosx-10.3-fat-2.5/mod_python
> copying /Users/gporcari/Desktop/Installazioni/mod_python-3.3.1/lib/
> python/mod_python/cgihandler.py -> build/lib.macosx-10.3-fat-2.5/
> mod_python
> copying /Users/gporcari/Desktop/Installazioni/mod_python-3.3.1/lib/
> python/mod_python/Cookie.py -> build/lib.macosx-10.3-fat-2.5/mod_python
> copying /Users/gporcari/Desktop/Installazioni/mod_python-3.3.1/lib/
> python/mod_python/importer.py -> build/lib.macosx-10.3-fat-2.5/
> mod_python
> copying /Users/gporcari/Desktop/Installazioni/mod_python-3.3.1/lib/
> python/mod_python/psp.py -> build/lib.macosx-10.3-fat-2.5/mod_python
> copying /Users/gporcari/Desktop/Installazioni/mod_python-3.3.1/lib/
> python/mod_python/publisher.py -> build/lib.macosx-10.3-fat-2.5/
> mod_python
> copying /Users/gporcari/Desktop/Installazioni/mod_python-3.3.1/lib/
> python/mod_python/python22.py -> build/lib.macosx-10.3-fat-2.5/
> mod_python
> copying /Users/gporcari/Desktop/Installazioni/mod_python-3.3.1/lib/
> python/mod_python/Session.py -> build/lib.macosx-10.3-fat-2.5/mod_python
> copying /Users/gporcari/Desktop/Installazioni/mod_python-3.3.1/lib/
> python/mod_python/testhandler.py -> build/lib.macosx-10.3-fat-2.5/
> mod_python
> copying /Users/gporcari/Desktop/Installazioni/mod_python-3.3.1/lib/
> python/mod_python/util.py -> build/lib.macosx-10.3-fat-2.5/mod_python
> running build_ext
> building 'mod_python._psp' extension
> creating build/temp.macosx-10.3-fat-2.5
> creating build/temp.macosx-10.3-fat-2.5/Users
> creating build/temp.macosx-10.3-fat-2.5/Users/gporcari
> creating build/temp.macosx-10.3-fat-2.5/Users/gporcari/Desktop
> creating build/temp.macosx-10.3-fat-2.5/Users/gporcari/Desktop/
> Installazioni
> creating build/temp.macosx-10.3-fat-2.5/Users/gporcari/Desktop/
> Installazioni/mod_python-3.3.1
> creating build/temp.macosx-10.3-fat-2.5/Users/gporcari/Desktop/
> Installazioni/mod_python-3.3.1/src
> gcc -arch ppc -arch i386 -isysroot /Developer/SDKs/MacOSX10.4u.sdk -
> fno-strict-aliasing -Wno-long-double -no-cpp-precomp -mno-fused-madd -
> fno-common -dynamic -DNDEBUG -g -O3 -I/Users/gporcari/Desktop/
> Installazioni/mod_python-3.3.1/src/include -I/Library/Frameworks/
> Python.framework/Versions/2.5/include/python2.5 -c /Users/gporcari/
> Desktop/Installazioni/mod_python-3.3.1/src/psp_string.c -o build/
> temp.macosx-10.3-fat-2.5/Users/gporcari/Desktop/Installazioni/
> mod_python-3.3.1/src/psp_string.o
> gcc -arch ppc -arch i386 -isysroot /Developer/SDKs/MacOSX10.4u.sdk -
> fno-strict-aliasing -Wno-long-double -no-cpp-precomp -mno-fused-madd -
> fno-common -dynamic -DNDEBUG -g -O3 -I/Users/gporcari/Desktop/
> Installazioni/mod_python-3.3.1/src/include -I/Library/Frameworks/
> Python.framework/Versions/2.5/include/python2.5 -c /Users/gporcari/
> Desktop/Installazioni/mod_python-3.3.1/src/psp_parser.c -o build/
> temp.macosx-10.3-fat-2.5/Users/gporcari/Desktop/Installazioni/
> mod_python-3.3.1/src/psp_parser.o
> gcc -arch ppc -arch i386 -isysroot /Developer/SDKs/MacOSX10.4u.sdk -
> fno-strict-aliasing -Wno-long-double -no-cpp-precomp -mno-fused-madd -
> fno-common -dynamic -DNDEBUG -g -O3 -I/Users/gporcari/Desktop/
> Installazioni/mod_python-3.3.1/src/include -I/Library/Frameworks/
> Python.framework/Versions/2.5/include/python2.5 -c /Users/gporcari/
> Desktop/Installazioni/mod_python-3.3.1/src/_pspmodule.c -o build/
> temp.macosx-10.3-fat-2.5/Users/gporcari/Desktop/Installazioni/
> mod_python-3.3.1/src/_pspmodule.o
> gcc -arch i386 -arch ppc -isysroot /Developer/SDKs/MacOSX10.4u.sdk -g
> -bundle -undefined dynamic_lookup build/temp.macosx-10.3-fat-2.5/
> Users/gporcari/Desktop/Installazioni/mod_python-3.3.1/src/
> psp_string.o build/temp.macosx-10.3-fat-2.5/Users/gporcari/Desktop/
> Installazioni/mod_python-3.3.1/src/psp_parser.o build/
> temp.macosx-10.3-fat-2.5/Users/gporcari/Desktop/Installazioni/
> mod_python-3.3.1/src/_pspmodule.o -o build/lib.macosx-10.3-fat-2.5/
> mod_python/_psp.so
>
> Now su and make install
>    (or, if you only want to perform a partial install,
>     you can use make install_dso and make install_py_lib)
>
From graham.dumpleton at gmail.com  Fri Sep 14 05:59:30 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Fri Sep 14 05:59:46 2007
Subject: [mod_python] importing egg format libs installed on a custom path
In-Reply-To: <1189762823.6041.13.camel@charon>
References: <1189691582.6048.16.camel@charon>
	<88e286470709131528l27b390e7s93b1b5215ab5999@mail.gmail.com>
	<1189762823.6041.13.camel@charon>
Message-ID: <88e286470709140259m2a05fe21x5b18e5b078777da5@mail.gmail.com>

>From command line Python, are you perhaps using 'workingenv' system of
some variety? The activation step required for some of these may not
be compatible with mod_python.

Graham

On 14/09/2007, Graham Carlyle <graham.carlyle@maplecroft.net> wrote:
> Ah, I'm now not sure what was happening before as this morning what I
> described isn't working. So sorry for the muddle.
>
> However after checking what was on sys.path from a modpython handler &
> also from the shell with the correct PYTHONPATH. The difference was the
> egg...
>
> from modpython handler:
> Path is ['/opt/apps/simple',
> '/opt/python/python-2.5.1/lib/python25.zip',
> '/opt/python/python-2.5.1/lib/python2.5',
> '/opt/python/python-2.5.1/lib/python2.5/plat-linux2',
> '/opt/python/python-2.5.1/lib/python2.5/lib-tk',
> '/opt/python/python-2.5.1/lib/python2.5/lib-dynload',
> '/opt/python/python-2.5.1/lib/python2.5/site-packages']
>
> from python shell:
> >>> import sys
> >>> sys.path
> ['', '/opt/apps/simple/feedparser-4.1-py2.5.egg', '/opt/apps/simple',
> '/opt/python/python-2.5.1/lib/python25.zip',
> '/opt/python/python-2.5.1/lib/python2.5',
> '/opt/python/python-2.5.1/lib/python2.5/plat-linux2',
> '/opt/python/python-2.5.1/lib/python2.5/lib-tk',
> '/opt/python/python-2.5.1/lib/python2.5/lib-dynload',
> '/opt/python/python-2.5.1/lib/python2.5/site-packages']
>
> So I added the egg path explicitly to the apache PythonPath directive
> and now the modpython handler happily finds the module.
>
> So my modpython config is now...
>
> <Location "/simple">
>     PythonPath "['/opt/apps/simple/feedparser-4.1-py2.5.egg',
> '/opt/apps/simple'] + sys.path"
>     SetHandler python-program
>     PythonHandler handler
>     PythonDebug On
>     PythonInterpreter simple
> </Location>
>
> So I guess my question is now... do egg based modules need to be
> unzipped & explicitly mentioned on the python path? If so this seems to
> bypass all the pth stuff that egg versioning works off.
>
> thanks,
> Graham
>
> On Fri, 2007-09-14 at 08:28 +1000, Graham Dumpleton wrote:
> > Have you confirmed that in your application sys.path includes the
> > directory you expect to be there?
> >
> > What is the remainder of your Apache configuration for setting up
> > mod_python handler? Ie., what context are you setting PythonHandler
> > etc.
> >
> > Grahamd
> >
> > On 13/09/2007, Graham Carlyle <graham.carlyle@maplecroft.net> wrote:
> > > Hi
> > >
> > > I'm trying to setup an application via mod_python and want to place some
> > > required libraries, that are python eggs, on an application specific
> > > path.
> > >
> > > So I use...
> > >
> > > <LocationMatch ...>
> > >
> > > ...
> > > PythonPath "['/opt/apps/foo/lib/'] + sys.path"
> > > PythonInterpreter foo
> > > ...
> > >
> > > </LocationMatch>
> > >
> > > But the application doesn't pick up on the eggs that were installed in
> > > "/opt/apps/foo/lib/". Although the python shell can import the libs
> > > after setting PYTHONPATH to this path.
> > >
> > > However I can get the webapp to find the eggs if I add to the apache
> > > conf...
> > >
> > > PythonImport /opt/apps/foo/lib/site.py foo
> > >
> > > site.py being a file the easy_install created when i installed the eggs
> > > to the custom path.
> > >
> > > Is this the recommended way of installing eggs to a custom path? Are
> > > there problems with this "solution".
> > >
> > > I had a trawl and couldn't find any info on this sort of problem in the
> > > mailing list which surprised me.
> > >
> > > thanks,
> > > Graham
> > >
> > >
> > > _______________________________________________
> > > Mod_python mailing list
> > > Mod_python@modpython.org
> > > http://mailman.modpython.org/mailman/listinfo/mod_python
> > >
>
>
From giovanni.porcari at gmail.com  Fri Sep 14 06:26:20 2007
From: giovanni.porcari at gmail.com (Porcari Giovanni)
Date: Fri Sep 14 06:26:38 2007
Subject: [mod_python] MODPYTHON-225
In-Reply-To: <88e286470709140257t229341b7mb34a676be3feea3e@mail.gmail.com>
References: <2E0830AA-0BAF-42E4-B9CD-CDF1A176CCB4@gmail.com>
	<88e286470709132349h77a89a86p9c52505e8d9626bb@mail.gmail.com>
	<F6CB2268-175D-46B8-A59F-A653C907BF60@gmail.com>
	<88e286470709140133m77192ef8ucabf1b6ba8d8c949@mail.gmail.com>
	<4FFD6826-A5E0-4C46-BAD4-7533A47A8407@gmail.com>
	<88e286470709140257t229341b7mb34a676be3feea3e@mail.gmail.com>
Message-ID: <824B4478-E642-48DB-AF45-8CEA0CAC5A3B@gmail.com>


Il giorno 14/set/07, alle ore 11:57, Graham Dumpleton ha scritto:

> How did you install Python 2.5, from source code or a binary  
> installer?
>
> The OS supplied Python framework is located at:
>
>   /System/Library/Frameworks/Python.framework
>
> In your case, for whatever reason is it instead at:
>
>   /Library/Frameworks/Python.framework
>
> I don't trust binary installers to not screw up my OS version so don't
> install them, thus don't know if them installing in
> /Library/Frameworks is what they do or not.
>
> Anyway, use:
>
>    -Wl,-F/Library/Frameworks
>


Sorry to bother you but I'm not very expert about this stuff so I
simply added to makefile the line you suggested me.
But it resulted in this error:

Makefile:18: *** missing separator.  Stop.

Can you explain the modification i have to do ?

Thank you
G.





original makefile:
--------------------
# Copyright 2004 Apache Software Foundation
#
#  Licensed under the Apache License, Version 2.0 (the "License");
#  you may not use this file except in compliance with the License.
#  You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
#  Unless required by applicable law or agreed to in writing, software
#  distributed under the License is distributed on an "AS IS" BASIS,
#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or  
implied.
#  See the License for the specific language governing permissions and
#  limitations under the License.
#
# Originally developed by Gregory Trubetskoy.
#



LIBEXECDIR=/usr/local/apache2/modules
AP_SRC=
AP_SRC_OWN=
AP_SRC_GRP=
INSTALL=/usr/bin/install -c
PYTHON_BIN=/Library/Frameworks/Python.framework/Versions/Current/bin/ 
python
PY_STD_LIB=/Library/Frameworks/Python.framework/Versions/2.5/lib/ 
python2.5

all: dso

dso: do_dso

do_dso:
	@cd src && $(MAKE)
	@cd dist && $(MAKE) build
	@echo
	@echo 'Now su and make install'
	@echo '  (or, if you only want to perform a partial install,'
	@echo '   you can use make install_dso and make install_py_lib)'
	@echo

no_dso:
	@echo
	@echo "DSO compilation not available. (Probably because apxs could  
not be found)."
	@echo

static: no_static

no_static:
	@echo
	@echo "Static compilation not available. (Probably because --with- 
apache was not specified)."
	@echo

install: src/.install
	@if test "`cat src/.install`" = "dso"; then \
		$(MAKE) install_dso; \
		$(MAKE) install_py_lib; \
	else $(MAKE) install_static; fi

install_dso:	dso
	@echo
	@echo "Performing DSO installation."
	@echo
	$(INSTALL) -d $(DESTDIR)$(LIBEXECDIR)
	$(INSTALL) src/mod_python.so $(DESTDIR)$(LIBEXECDIR)
	@echo
	@echo "Now don't forget to edit your main config and add"
	@echo "    LoadModule python_module $(LIBEXECDIR)/mod_python.so"
	@echo "and if your configuration uses ClearModuleList, then also"
	@echo "    AddModule mod_python.c"
	@echo

install_py_lib:
	cd dist && $(MAKE) install_py_lib

clean:
	cd src && $(MAKE) clean
	cd dist && $(MAKE) clean
	cd test && $(MAKE) clean
	rm -f core

distclean: clean
	cd src && $(MAKE) distclean
	cd Doc && $(MAKE) distclean
	cd dist && $(MAKE) distclean
	cd test && $(MAKE) distclean
	rm -rf Makefile config.h config.status config.cache config.log \
		test/testconf.py

check:
	cd test && $(MAKE) check

From graham.dumpleton at gmail.com  Fri Sep 14 06:36:32 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Fri Sep 14 06:36:44 2007
Subject: [mod_python] MODPYTHON-225
In-Reply-To: <824B4478-E642-48DB-AF45-8CEA0CAC5A3B@gmail.com>
References: <2E0830AA-0BAF-42E4-B9CD-CDF1A176CCB4@gmail.com>
	<88e286470709132349h77a89a86p9c52505e8d9626bb@mail.gmail.com>
	<F6CB2268-175D-46B8-A59F-A653C907BF60@gmail.com>
	<88e286470709140133m77192ef8ucabf1b6ba8d8c949@mail.gmail.com>
	<4FFD6826-A5E0-4C46-BAD4-7533A47A8407@gmail.com>
	<88e286470709140257t229341b7mb34a676be3feea3e@mail.gmail.com>
	<824B4478-E642-48DB-AF45-8CEA0CAC5A3B@gmail.com>
Message-ID: <88e286470709140336y6de0434m90ebda8d5d00f54e@mail.gmail.com>

Wrong makefile. I mentioned previously to edit 'src/Makefile', not
'Makefile'. Search for the line that says something like:

LDFLAGS= -Wl,-framework,Python  -u __dummy -u _PyMac_Error -framework
System $(PYTHONFRAMEWORKDIR)/Versions/$(VERSION)/$(PYTHONFRAMEWORK)
-framework CoreServices -framework Foundation   -Wl,-F. -Wl,-F.

Immediately after the '=' add ' -Wl,-F/Library/Frameworks'. Eg:

LDFLAGS= -Wl,-F/Library/Frameworks -Wl,-framework,Python  -u __dummy
-u _PyMac_Error -framework System
$(PYTHONFRAMEWORKDIR)/Versions/$(VERSION)/$(PYTHONFRAMEWORK)
-framework CoreServices -framework Foundation   -Wl,-F. -Wl,-F.

Graham

On 14/09/2007, Porcari Giovanni <giovanni.porcari@gmail.com> wrote:
>
> Il giorno 14/set/07, alle ore 11:57, Graham Dumpleton ha scritto:
>
> > How did you install Python 2.5, from source code or a binary
> > installer?
> >
> > The OS supplied Python framework is located at:
> >
> >   /System/Library/Frameworks/Python.framework
> >
> > In your case, for whatever reason is it instead at:
> >
> >   /Library/Frameworks/Python.framework
> >
> > I don't trust binary installers to not screw up my OS version so don't
> > install them, thus don't know if them installing in
> > /Library/Frameworks is what they do or not.
> >
> > Anyway, use:
> >
> >    -Wl,-F/Library/Frameworks
> >
>
>
> Sorry to bother you but I'm not very expert about this stuff so I
> simply added to makefile the line you suggested me.
> But it resulted in this error:
>
> Makefile:18: *** missing separator.  Stop.
>
> Can you explain the modification i have to do ?
>
> Thank you
> G.
>
>
>
>
>
> original makefile:
> --------------------
> # Copyright 2004 Apache Software Foundation
> #
> #  Licensed under the Apache License, Version 2.0 (the "License");
> #  you may not use this file except in compliance with the License.
> #  You may obtain a copy of the License at
> #
> #      http://www.apache.org/licenses/LICENSE-2.0
> #
> #  Unless required by applicable law or agreed to in writing, software
> #  distributed under the License is distributed on an "AS IS" BASIS,
> #  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
> implied.
> #  See the License for the specific language governing permissions and
> #  limitations under the License.
> #
> # Originally developed by Gregory Trubetskoy.
> #
>
>
>
> LIBEXECDIR=/usr/local/apache2/modules
> AP_SRC=
> AP_SRC_OWN=
> AP_SRC_GRP=
> INSTALL=/usr/bin/install -c
> PYTHON_BIN=/Library/Frameworks/Python.framework/Versions/Current/bin/
> python
> PY_STD_LIB=/Library/Frameworks/Python.framework/Versions/2.5/lib/
> python2.5
>
> all: dso
>
> dso: do_dso
>
> do_dso:
>         @cd src && $(MAKE)
>         @cd dist && $(MAKE) build
>         @echo
>         @echo 'Now su and make install'
>         @echo '  (or, if you only want to perform a partial install,'
>         @echo '   you can use make install_dso and make install_py_lib)'
>         @echo
>
> no_dso:
>         @echo
>         @echo "DSO compilation not available. (Probably because apxs could
> not be found)."
>         @echo
>
> static: no_static
>
> no_static:
>         @echo
>         @echo "Static compilation not available. (Probably because --with-
> apache was not specified)."
>         @echo
>
> install: src/.install
>         @if test "`cat src/.install`" = "dso"; then \
>                 $(MAKE) install_dso; \
>                 $(MAKE) install_py_lib; \
>         else $(MAKE) install_static; fi
>
> install_dso:    dso
>         @echo
>         @echo "Performing DSO installation."
>         @echo
>         $(INSTALL) -d $(DESTDIR)$(LIBEXECDIR)
>         $(INSTALL) src/mod_python.so $(DESTDIR)$(LIBEXECDIR)
>         @echo
>         @echo "Now don't forget to edit your main config and add"
>         @echo "    LoadModule python_module $(LIBEXECDIR)/mod_python.so"
>         @echo "and if your configuration uses ClearModuleList, then also"
>         @echo "    AddModule mod_python.c"
>         @echo
>
> install_py_lib:
>         cd dist && $(MAKE) install_py_lib
>
> clean:
>         cd src && $(MAKE) clean
>         cd dist && $(MAKE) clean
>         cd test && $(MAKE) clean
>         rm -f core
>
> distclean: clean
>         cd src && $(MAKE) distclean
>         cd Doc && $(MAKE) distclean
>         cd dist && $(MAKE) distclean
>         cd test && $(MAKE) distclean
>         rm -rf Makefile config.h config.status config.cache config.log \
>                 test/testconf.py
>
> check:
>         cd test && $(MAKE) check
>
>
From giovanni.porcari at gmail.com  Fri Sep 14 07:03:47 2007
From: giovanni.porcari at gmail.com (Porcari Giovanni)
Date: Fri Sep 14 07:04:09 2007
Subject: [mod_python] MODPYTHON-225
In-Reply-To: <88e286470709140336y6de0434m90ebda8d5d00f54e@mail.gmail.com>
References: <2E0830AA-0BAF-42E4-B9CD-CDF1A176CCB4@gmail.com>
	<88e286470709132349h77a89a86p9c52505e8d9626bb@mail.gmail.com>
	<F6CB2268-175D-46B8-A59F-A653C907BF60@gmail.com>
	<88e286470709140133m77192ef8ucabf1b6ba8d8c949@mail.gmail.com>
	<4FFD6826-A5E0-4C46-BAD4-7533A47A8407@gmail.com>
	<88e286470709140257t229341b7mb34a676be3feea3e@mail.gmail.com>
	<824B4478-E642-48DB-AF45-8CEA0CAC5A3B@gmail.com>
	<88e286470709140336y6de0434m90ebda8d5d00f54e@mail.gmail.com>
Message-ID: <3051533D-AF6E-47BF-8E84-8D33F7257930@gmail.com>


Il giorno 14/set/07, alle ore 12:36, Graham Dumpleton ha scritto:

> Wrong makefile. I mentioned previously to edit 'src/Makefile', not
> 'Makefile'. Search for the line that says something like:
>
> LDFLAGS= -Wl,-framework,Python  -u __dummy -u _PyMac_Error -framework
> System $(PYTHONFRAMEWORKDIR)/Versions/$(VERSION)/$(PYTHONFRAMEWORK)
> -framework CoreServices -framework Foundation   -Wl,-F. -Wl,-F.
>
> Immediately after the '=' add ' -Wl,-F/Library/Frameworks'. Eg:
>
> LDFLAGS= -Wl,-F/Library/Frameworks -Wl,-framework,Python  -u __dummy
> -u _PyMac_Error -framework System
> $(PYTHONFRAMEWORKDIR)/Versions/$(VERSION)/$(PYTHONFRAMEWORK)
> -framework CoreServices -framework Foundation   -Wl,-F. -Wl,-F.
>
> Graham
>


Hi Graham
thank you very much :)

Now it works and I have just to say that your support is wonderful.

Really thank you again.


G
From graham.carlyle at maplecroft.net  Fri Sep 14 07:19:44 2007
From: graham.carlyle at maplecroft.net (Graham Carlyle)
Date: Fri Sep 14 07:20:07 2007
Subject: [mod_python] importing egg format libs installed on a custom path
In-Reply-To: <88e286470709140259m2a05fe21x5b18e5b078777da5@mail.gmail.com>
References: <1189691582.6048.16.camel@charon>
	<88e286470709131528l27b390e7s93b1b5215ab5999@mail.gmail.com>
	<1189762823.6041.13.camel@charon>
	<88e286470709140259m2a05fe21x5b18e5b078777da5@mail.gmail.com>
Message-ID: <1189768784.6041.30.camel@charon>

On Fri, 2007-09-14 at 19:59 +1000, Graham Dumpleton wrote:
> >From command line Python, are you perhaps using 'workingenv' system of
> some variety? The activation step required for some of these may not
> be compatible with mod_python.

No just a plain python install to a custom location as I don't want to
use the distros version. So I set PYTHONHOME in the apachectl script so
that modpython uses the correct version (I obviously needed to compile
the apache module against this version of python as well). I did this
after reading https://issues.apache.org/jira/browse/MODPYTHON-225 and
that seems to work fine.

The only problem is with eggs installed on a path outside site-packages
that I'm pointing to with PythonPath. Seems I need to reference these
sort of eggs explicitly on PythonPath to make them importable from the
modpython handler. If the egg is installed in site-packages then it can
be imported with no problem and no need to add the egg to the
PythonPath.

Graham



From graham.dumpleton at gmail.com  Fri Sep 14 07:23:48 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Fri Sep 14 07:23:59 2007
Subject: [mod_python] importing egg format libs installed on a custom path
In-Reply-To: <1189768784.6041.30.camel@charon>
References: <1189691582.6048.16.camel@charon>
	<88e286470709131528l27b390e7s93b1b5215ab5999@mail.gmail.com>
	<1189762823.6041.13.camel@charon>
	<88e286470709140259m2a05fe21x5b18e5b078777da5@mail.gmail.com>
	<1189768784.6041.30.camel@charon>
Message-ID: <88e286470709140423t8210335w9aae8d2cc75fb8df@mail.gmail.com>

On 14/09/2007, Graham Carlyle <graham.carlyle@maplecroft.net> wrote:
> On Fri, 2007-09-14 at 19:59 +1000, Graham Dumpleton wrote:
> > >From command line Python, are you perhaps using 'workingenv' system of
> > some variety? The activation step required for some of these may not
> > be compatible with mod_python.
>
> No just a plain python install to a custom location as I don't want to
> use the distros version. So I set PYTHONHOME in the apachectl script

The 'envvars' script in same directory should be used for setting
special environment variables. Shouldn't modify apachectl directly.
Check apachectl though to ensure it is reading this file from that
location.

> so
> that modpython uses the correct version (I obviously needed to compile
> the apache module against this version of python as well). I did this
> after reading https://issues.apache.org/jira/browse/MODPYTHON-225 and
> that seems to work fine.
>
> The only problem is with eggs installed on a path outside site-packages
> that I'm pointing to with PythonPath. Seems I need to reference these
> sort of eggs explicitly on PythonPath to make them importable from the
> modpython handler. If the egg is installed in site-packages then it can
> be imported with no problem and no need to add the egg to the
> PythonPath.

Set PYTHONPATH in the envvars file as well. That way it will be
present when Python first starts up and eggs will be activated
properly (I think).

Graham
From graham.carlyle at maplecroft.net  Fri Sep 14 07:34:27 2007
From: graham.carlyle at maplecroft.net (Graham Carlyle)
Date: Fri Sep 14 07:34:42 2007
Subject: [mod_python] importing egg format libs installed on a custom path
In-Reply-To: <88e286470709140423t8210335w9aae8d2cc75fb8df@mail.gmail.com>
References: <1189691582.6048.16.camel@charon>
	<88e286470709131528l27b390e7s93b1b5215ab5999@mail.gmail.com>
	<1189762823.6041.13.camel@charon>
	<88e286470709140259m2a05fe21x5b18e5b078777da5@mail.gmail.com>
	<1189768784.6041.30.camel@charon>
	<88e286470709140423t8210335w9aae8d2cc75fb8df@mail.gmail.com>
Message-ID: <1189769667.6041.37.camel@charon>

On Fri, 2007-09-14 at 21:23 +1000, Graham Dumpleton wrote:
> > The only problem is with eggs installed on a path outside site-packages
> > that I'm pointing to with PythonPath. Seems I need to reference these
> > sort of eggs explicitly on PythonPath to make them importable from the
> > modpython handler. If the egg is installed in site-packages then it can
> > be imported with no problem and no need to add the egg to the
> > PythonPath.
> 
> Set PYTHONPATH in the envvars file as well. That way it will be
> present when Python first starts up and eggs will be activated
> properly (I think).

But then won't the eggs be available to all the modpython handlers? I
wanted to have independence between the libraries used by different
modpython handlers. So say I have an application that relies on version
X of a library and another app that uses version Y of the same library.
So each handler has a different PythonPath pointing to a different,
potentially conflicting set of python modules, with some of these served
by python eggs.

thanks,
Graham

From graham.dumpleton at gmail.com  Fri Sep 14 07:46:36 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Fri Sep 14 07:46:47 2007
Subject: [mod_python] importing egg format libs installed on a custom path
In-Reply-To: <1189769667.6041.37.camel@charon>
References: <1189691582.6048.16.camel@charon>
	<88e286470709131528l27b390e7s93b1b5215ab5999@mail.gmail.com>
	<1189762823.6041.13.camel@charon>
	<88e286470709140259m2a05fe21x5b18e5b078777da5@mail.gmail.com>
	<1189768784.6041.30.camel@charon>
	<88e286470709140423t8210335w9aae8d2cc75fb8df@mail.gmail.com>
	<1189769667.6041.37.camel@charon>
Message-ID: <88e286470709140446u3acc279dy704b40cc0a6c91dc@mail.gmail.com>

On 14/09/2007, Graham Carlyle <graham.carlyle@maplecroft.net> wrote:
> On Fri, 2007-09-14 at 21:23 +1000, Graham Dumpleton wrote:
> > > The only problem is with eggs installed on a path outside site-packages
> > > that I'm pointing to with PythonPath. Seems I need to reference these
> > > sort of eggs explicitly on PythonPath to make them importable from the
> > > modpython handler. If the egg is installed in site-packages then it can
> > > be imported with no problem and no need to add the egg to the
> > > PythonPath.
> >
> > Set PYTHONPATH in the envvars file as well. That way it will be
> > present when Python first starts up and eggs will be activated
> > properly (I think).
>
> But then won't the eggs be available to all the modpython handlers? I
> wanted to have independence between the libraries used by different
> modpython handlers. So say I have an application that relies on version
> X of a library and another app that uses version Y of the same library.
> So each handler has a different PythonPath pointing to a different,
> potentially conflicting set of python modules, with some of these served
> by python eggs.

Then you need to use 'workingenv' or similar and trigger activation yourself.

Ie., do something like as described at the end of:

  http://docs.pythonweb.org/pages/viewpage.action?pageId=5439610

but adapt it to mod_python by putting it in a distinct Python code
file for each interpreter instance and using PythonImport to trigger
respective code files for each interpreter instance.

For example, if using mod_python 3.3.1, use:

  PythonImport /some/path/interp1.py interp1
  PythonImport /some/path/interp2.py interp2

At start of each .py file, set sys.path appropriately and then
activate working env.

Note though that using different versions of Python eggs, or any
module/package, can be dangerous if they contain a C extension module,
as an extension module is loaded only once per process and first to
load will win. This can result in Python wrappers for latter versions
not matching the inner C extension module resulting in errors or
crashes. Only choice to avoid that would be to use mod_wsgi daemon
mode or mod_fastcgi, presuming your application is a WSGI application
and you aren't using mod_python specific APIs.

Graham
From graham.carlyle at maplecroft.net  Fri Sep 14 08:03:18 2007
From: graham.carlyle at maplecroft.net (Graham Carlyle)
Date: Fri Sep 14 08:03:37 2007
Subject: [mod_python] importing egg format libs installed on a custom path
In-Reply-To: <88e286470709140446u3acc279dy704b40cc0a6c91dc@mail.gmail.com>
References: <1189691582.6048.16.camel@charon>
	<88e286470709131528l27b390e7s93b1b5215ab5999@mail.gmail.com>
	<1189762823.6041.13.camel@charon>
	<88e286470709140259m2a05fe21x5b18e5b078777da5@mail.gmail.com>
	<1189768784.6041.30.camel@charon>
	<88e286470709140423t8210335w9aae8d2cc75fb8df@mail.gmail.com>
	<1189769667.6041.37.camel@charon>
	<88e286470709140446u3acc279dy704b40cc0a6c91dc@mail.gmail.com>
Message-ID: <1189771398.6041.48.camel@charon>

On Fri, 2007-09-14 at 21:46 +1000, Graham Dumpleton wrote:
> Note though that using different versions of Python eggs, or any
> module/package, can be dangerous if they contain a C extension module,
> as an extension module is loaded only once per process and first to
> load will win. This can result in Python wrappers for latter versions
> not matching the inner C extension module resulting in errors or
> crashes. Only choice to avoid that would be to use mod_wsgi daemon
> mode or mod_fastcgi, presuming your application is a WSGI application
> and you aren't using mod_python specific APIs.

Ah, great thanks for the advice, some of the eggs/modules will contain c
extension modules so I'll look into mod_wsgi...been meaning too for a
while but until i had a good reason :)

The applications are django based, though we do have some legacy
modpython specific code which maybe i'll have to treat differently. 

thanks again,
Graham

From odile at ofset.org  Fri Sep 14 09:33:10 2007
From: odile at ofset.org (=?UTF-8?B?T2RpbGUgQsOpbmFzc3k=?=)
Date: Fri Sep 14 09:33:29 2007
Subject: [mod_python] Dummy threads
Message-ID: <46EA8D96.8060905@ofset.org>

Hello,

I'm currently trying to port glasnost CMS on Apache2 (*) and encounter
issues related to Dummy Threads

Here is my test.py file (I use it as a mod python handler):

--%<
#!/usr/bin/env python

import threading
from mod_python import apache

def handler(req):
    thread = threading.currentThread()
    r = req.the_request
    req.content_type = "text/plain"
    req.write("Bonjour!")
    req.write("\n")
    req.write(r)
    req.write("\n")
    req.write(repr(thread))
    return apache.OK

--%<

As you can see, it is a rather minimal handler.

At first it renders:

--%<
Bonjour!
GET / HTTP/1.1
<_MainThread(MainThread, started)>
--%<

but if I call any URL more than 3 or 4 times in a row, I get this on the
browser

-%<
Bonjour!
GET / HTTP/1.1
<_DummyThread(Dummy-1, started daemon)>
--%<

Can you help me figuring out why this dummy & annoying thing is happening?

Thanks in advance,

(*) Apache/2.2.3 (Debian) mod_python/3.2.10 Python/2.4.4

-- 
Odile B?nassy
http://www.ofset.org
http://gnuedu.ofset.org
From graham.dumpleton at gmail.com  Fri Sep 14 19:18:39 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Fri Sep 14 19:18:53 2007
Subject: [mod_python] Dummy threads
In-Reply-To: <46EA8D96.8060905@ofset.org>
References: <46EA8D96.8060905@ofset.org>
Message-ID: <88e286470709141618m789263c7uba5ddec00037fb13@mail.gmail.com>

On 14/09/2007, Odile B?nassy <odile@ofset.org> wrote:
> Hello,
>
> I'm currently trying to port glasnost CMS on Apache2 (*) and encounter
> issues related to Dummy Threads
>
> Here is my test.py file (I use it as a mod python handler):
>
> --%<
> #!/usr/bin/env python
>
> import threading
> from mod_python import apache
>
> def handler(req):
>     thread = threading.currentThread()
>     r = req.the_request
>     req.content_type = "text/plain"
>     req.write("Bonjour!")
>     req.write("\n")
>     req.write(r)
>     req.write("\n")
>     req.write(repr(thread))
>     return apache.OK
>
> --%<
>
> As you can see, it is a rather minimal handler.
>
> At first it renders:
>
> --%<
> Bonjour!
> GET / HTTP/1.1
> <_MainThread(MainThread, started)>
> --%<
>
> but if I call any URL more than 3 or 4 times in a row, I get this on the
> browser
>
> -%<
> Bonjour!
> GET / HTTP/1.1
> <_DummyThread(Dummy-1, started daemon)>
> --%<
>
> Can you help me figuring out why this dummy & annoying thing is happening?

It is normal.

When Apache worker MPM, or Windows MPM are used, then multiple
requests are used to handle requests. All these threads are created by
Apache and not Python. Which ever Apache thread so happened to be the
one which initialised Python will show as MainThread. Any other Apache
threads will be maked by Python as a DummyThread, which indicates they
are a foreign thread created outside of Python, as is the case in
Apache. Because requests are handled in random thread from Apache
thread pool, sometimes you will thus see MainThread and other times
you will see DummyThread.

Why is this creating a problem?

Graham

From graham.dumpleton at gmail.com  Sat Sep 15 02:57:29 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sat Sep 15 02:57:44 2007
Subject: [mod_python] Dummy threads
In-Reply-To: <20070915082112.f6b94317.odile@ofset.org>
References: <46EA8D96.8060905@ofset.org>
	<88e286470709141618m789263c7uba5ddec00037fb13@mail.gmail.com>
	<20070915082112.f6b94317.odile@ofset.org>
Message-ID: <88e286470709142357g73c29568n5f31ccff2a6fdf4@mail.gmail.com>

On 15/09/2007, Odile B?nassy <odile@ofset.org> wrote:
> On Sat, 15 Sep 2007 09:18:39 +1000
> "Graham Dumpleton" <graham.dumpleton@gmail.com> wrote:
>
> > On 14/09/2007, Odile B?nassy <odile@ofset.org> wrote:
> > > Hello,
> > >
> > > I'm currently trying to port glasnost CMS on Apache2 (*) and encounter
> > > issues related to Dummy Threads
> > >
> > > Here is my test.py file (I use it as a mod python handler):
> > >
> > > --%<
> > > #!/usr/bin/env python
> > >
> > > import threading
> > > from mod_python import apache
> > >
> > > def handler(req):
> > >     thread = threading.currentThread()
> > >     r = req.the_request
> > >     req.content_type = "text/plain"
> > >     req.write("Bonjour!")
> > >     req.write("\n")
> > >     req.write(r)
> > >     req.write("\n")
> > >     req.write(repr(thread))
> > >     return apache.OK
> > >
> > > --%<
> > >
> > > As you can see, it is a rather minimal handler.
> > >
> > > At first it renders:
> > >
> > > --%<
> > > Bonjour!
> > > GET / HTTP/1.1
> > > <_MainThread(MainThread, started)>
> > > --%<
> > >
> > > but if I call any URL more than 3 or 4 times in a row, I get this on the
> > > browser
> > >
> > > -%<
> > > Bonjour!
> > > GET / HTTP/1.1
> > > <_DummyThread(Dummy-1, started daemon)>
> > > --%<
> > >
> > > Can you help me figuring out why this dummy & annoying thing is happening?
> >
> > It is normal.
> >
> > When Apache worker MPM, or Windows MPM are used, then multiple
> > requests are used to handle requests. All these threads are created by
> > Apache and not Python. Which ever Apache thread so happened to be the
> > one which initialised Python will show as MainThread. Any other Apache
> > threads will be maked by Python as a DummyThread, which indicates they
> > are a foreign thread created outside of Python, as is the case in
> > Apache. Because requests are handled in random thread from Apache
> > thread pool, sometimes you will thus see MainThread and other times
> > you will see DummyThread.
> >
> > Why is this creating a problem?
> >
> > Graham
> >
>
> Thank you for this answer
> I will read more about MPM
> It is annoying, because the glasnost CMS uses the thread to pass
> context information from one page to the other, and dummy threads break
> everything

Using the thread object doesn't seem a very safe way of transferring
information around. Normally people would use thread local data
storage mechanisms instead. Either mechanism will not work though as a
way of persisting data between successive requests.

You may find it interesting to read:

  http://code.google.com/p/modwsgi/wiki/ProcessesAndThreading

This talks about different Apache MPMs, but also about issues related
to data persistence between requests. This document is for mod_wsgi,
but same applies to mod_python.

Graham

From jubei at csh.rit.edu  Sat Sep 15 20:55:51 2007
From: jubei at csh.rit.edu (jon heise)
Date: Sat Sep 15 20:56:20 2007
Subject: [mod_python] location directive
Message-ID: <46EC7F17.3020102@csh.rit.edu>

I'm trying to get modpython3 working with a location directive , i've 
got the following in my apache conf:

<Location 
/python>                                                             
    AddHandler mod_python 
.py                                                  
    PythonHandler 
mptest                                                       
    PythonDebug 
On                                                             
    PythonPath "['/usr/local/www/html/test/'] + 
sys.path"                      
</Location>

however when i hit /python on my webserver i get the following in my 
error log:
[Sat Sep 15 20:54:28 2007] [error] [client 66.67.50.9] File does not 
exist: /usr/local/www/html/python
From graham.dumpleton at gmail.com  Sun Sep 16 01:21:02 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sun Sep 16 01:21:13 2007
Subject: [mod_python] location directive
In-Reply-To: <46EC7F17.3020102@csh.rit.edu>
References: <46EC7F17.3020102@csh.rit.edu>
Message-ID: <88e286470709152221y2c3f2312q750a15120a3a9659@mail.gmail.com>

On 16/09/2007, jon heise <jubei@csh.rit.edu> wrote:
> I'm trying to get modpython3 working with a location directive , i've
> got the following in my apache conf:
>
> <Location
> /python>
>     AddHandler mod_python
> .py
>     PythonHandler
> mptest
>     PythonDebug
> On
>     PythonPath "['/usr/local/www/html/test/'] +
> sys.path"
> </Location>
>
> however when i hit /python on my webserver i get the following in my
> error log:
> [Sat Sep 15 20:54:28 2007] [error] [client 66.67.50.9] File does not
> exist: /usr/local/www/html/python

You are not supposed to be using Location with simple mptest like
example. Use Directory instead. See:

  http://www.dscpl.com.au/wiki/ModPython/Articles/GettingModPythonWorking

Graham
From swati at ibcs.in  Mon Sep 17 13:05:49 2007
From: swati at ibcs.in (Swati Mazumder)
Date: Mon Sep 17 13:06:58 2007
Subject: [mod_python] mod python installation problem
References: <001e01c7f3bf$e655bc30$123ae2dc@IBM59C3E89BC98>
	<88e286470709101515s4b2ea406l5fbd560d6a09973b@mail.gmail.com>
Message-ID: <003a01c7f94d$06f8dfc0$2726e2dc@IBM59C3E89BC98>

Hi All,

I have set up Django on linux successfully and want to run through Apache 
server. In my server,-

1) Apache is installed
2) python is installed
3) Mod python is installed and activated. I have modified the configuration 
file of Apache accordingly
4) Django is installed
5) Django development server is running successfully
6) I have tested some simple django application through development server 
and its running.

Problem is when I am trying to access the django application through the 
apache server, its throwing a 404 (not found) message. I think there is some 
simple linking problem. Can anyone please help?

Thanks,
Swati 


From labs at ixopusada.com  Mon Sep 17 14:37:47 2007
From: labs at ixopusada.com (Dirk van Oosterbosch, IR labs)
Date: Mon Sep 17 14:42:41 2007
Subject: [mod_python] mod python installation problem
In-Reply-To: <003a01c7f94d$06f8dfc0$2726e2dc@IBM59C3E89BC98>
References: <001e01c7f3bf$e655bc30$123ae2dc@IBM59C3E89BC98>
	<88e286470709101515s4b2ea406l5fbd560d6a09973b@mail.gmail.com>
	<003a01c7f94d$06f8dfc0$2726e2dc@IBM59C3E89BC98>
Message-ID: <16AC6D22-DF1A-4219-8722-AFD3C00C7F68@ixopusada.com>

Please provide more information, so we could help.
Specifically Django's configuration in Apache's .conf file and the  
404 error from Apache's error.log

dirk


On 17-sep-2007, at 19:05, Swati Mazumder wrote:

> Hi All,
>
> I have set up Django on linux successfully and want to run through  
> Apache server. In my server,-
>
> 1) Apache is installed
> 2) python is installed
> 3) Mod python is installed and activated. I have modified the  
> configuration file of Apache accordingly
> 4) Django is installed
> 5) Django development server is running successfully
> 6) I have tested some simple django application through development  
> server and its running.
>
> Problem is when I am trying to access the django application  
> through the apache server, its throwing a 404 (not found) message.  
> I think there is some simple linking problem. Can anyone please help?
>
> Thanks,
> Swati


From python at moorhouse.net.nz  Tue Sep 18 06:11:24 2007
From: python at moorhouse.net.nz (David Moorhouse)
Date: Tue Sep 18 06:11:08 2007
Subject: [mod_python] Trouble with Apache 2.0.54 and Python 2.5.1
Message-ID: <fj7ve35id2kj2o7tidq6o8ah7ji6hbn9d1@4ax.com>

I'm running Apache 2.0.54 on Win XP and have installed Python 2.5.1 (in
C:\python25) and mod_python 3.3.1

I've added the following line to httpd.conf
LoadModule python_module modules/mod_python.so

When I restart Apache from the Apache Monitor I get an error
"The requested operation has failed !"

The error.log shows
"Syntax error on line 178 of E:/Apache Group/Apache2/conf/httpd.conf:
Cannot load E:/Apache Group/Apache2/modules/mod_python.so into server: The
specified procedure could not be found.  "

mod_python.so is in the /modules sub directory.  python25.dll, msvcr71.dll
and msvcp71.dll are in the windows/system32 directory.

Here's the versions of the files
msvcp71.dll	7.10.3077.0
msvcr71.dll	7.10.6030.0
python25.dll	2.5.1150.1013
mod_python.so	3.3.1.16113

The environment variable "path" is
C:\python25;E:\CodeGear\RAD Studio\5.0\bin;C:\Documents and Settings\All
Users\Documents\RAD
Studio\5.0\Bpl;E:\Borland\Delphi7\Bin;E:\Borland\Delphi7\Projects\Bpl\;E:\COMMON~1\Borland\Debugger\Bin;C:\PROGRAM
FILES\THINKPAD\UTILITIES;%SystemRoot%\system32;%SystemRoot%;%SystemRoot%\System32\Wbem;E:\QuickTime\QTSystem\;E:\Subversion\bin;E:\LonWorks\bin;C:\Program
Files\Common Files\GTK\2.0\bin;E:\PC-Doctor for Windows\services;C:\Program
Files\ATI Technologies\ATI Control Panel

I have installed everything as "administrator".  Prior to installing
mod_python (or if I comment out the LoadModule line) Apache runs fine.

One funny thing I did notice was the ordinal numbers on the import section
of mod_python.so are slightly different to the ordinals in the export
section of python25.dll and msvcr71.dll.  Whether this makes a difference
I'm not sure.

Finally, my registry has the following entries under this key
HKEY_LOCAL_MACHINE\SOFTWARE\Python\PythonCore\2.5

HKEY_LOCAL_MACHINE\SOFTWARE\Python\PythonCore\2.5\InstallPath =
C:\Python25\
HKEY_LOCAL_MACHINE\SOFTWARE\Python\PythonCore\2.5\PythonPath =
C:\Python25\Lib;C:\Python25\DLLs;C:\Python25\Lib\lib-tk

As you can see I'm a bit stuck.  Can anyone shed any light or point me in
the right direction.

Thanks

D


From graham.dumpleton at gmail.com  Tue Sep 18 06:24:31 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Sep 18 06:24:45 2007
Subject: [mod_python] Trouble with Apache 2.0.54 and Python 2.5.1
In-Reply-To: <fj7ve35id2kj2o7tidq6o8ah7ji6hbn9d1@4ax.com>
References: <fj7ve35id2kj2o7tidq6o8ah7ji6hbn9d1@4ax.com>
Message-ID: <88e286470709180324q73eb37cdm5aed4da04144bdcc@mail.gmail.com>

What was the name of the mod_python installer  you used? Did you
definitely use the version for Apache 2.0/Python 2.5?

Is there any other python25.dll files on your system anywhere? Some
third party Windows applications use Python internally and provide
their own python25.dll. If that is in a directory on PATH found before
the system directory version, it can cause a failure.

Other than that, only other suggestion is that if running Apache as
service, that the user it runs as has adequate permissions to read
mod_python and Python installed files.

Graham

On 18/09/2007, David Moorhouse <python@moorhouse.net.nz> wrote:
> I'm running Apache 2.0.54 on Win XP and have installed Python 2.5.1 (in
> C:\python25) and mod_python 3.3.1
>
> I've added the following line to httpd.conf
> LoadModule python_module modules/mod_python.so
>
> When I restart Apache from the Apache Monitor I get an error
> "The requested operation has failed !"
>
> The error.log shows
> "Syntax error on line 178 of E:/Apache Group/Apache2/conf/httpd.conf:
> Cannot load E:/Apache Group/Apache2/modules/mod_python.so into server: The
> specified procedure could not be found.  "
>
> mod_python.so is in the /modules sub directory.  python25.dll, msvcr71.dll
> and msvcp71.dll are in the windows/system32 directory.
>
> Here's the versions of the files
> msvcp71.dll     7.10.3077.0
> msvcr71.dll     7.10.6030.0
> python25.dll    2.5.1150.1013
> mod_python.so   3.3.1.16113
>
> The environment variable "path" is
> C:\python25;E:\CodeGear\RAD Studio\5.0\bin;C:\Documents and Settings\All
> Users\Documents\RAD
> Studio\5.0\Bpl;E:\Borland\Delphi7\Bin;E:\Borland\Delphi7\Projects\Bpl\;E:\COMMON~1\Borland\Debugger\Bin;C:\PROGRAM
> FILES\THINKPAD\UTILITIES;%SystemRoot%\system32;%SystemRoot%;%SystemRoot%\System32\Wbem;E:\QuickTime\QTSystem\;E:\Subversion\bin;E:\LonWorks\bin;C:\Program
> Files\Common Files\GTK\2.0\bin;E:\PC-Doctor for Windows\services;C:\Program
> Files\ATI Technologies\ATI Control Panel
>
> I have installed everything as "administrator".  Prior to installing
> mod_python (or if I comment out the LoadModule line) Apache runs fine.
>
> One funny thing I did notice was the ordinal numbers on the import section
> of mod_python.so are slightly different to the ordinals in the export
> section of python25.dll and msvcr71.dll.  Whether this makes a difference
> I'm not sure.
>
> Finally, my registry has the following entries under this key
> HKEY_LOCAL_MACHINE\SOFTWARE\Python\PythonCore\2.5
>
> HKEY_LOCAL_MACHINE\SOFTWARE\Python\PythonCore\2.5\InstallPath =
> C:\Python25\
> HKEY_LOCAL_MACHINE\SOFTWARE\Python\PythonCore\2.5\PythonPath =
> C:\Python25\Lib;C:\Python25\DLLs;C:\Python25\Lib\lib-tk
>
> As you can see I'm a bit stuck.  Can anyone shed any light or point me in
> the right direction.
>
> Thanks
>
> D
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From graham.dumpleton at gmail.com  Tue Sep 18 06:39:05 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Tue Sep 18 06:39:18 2007
Subject: [mod_python] Trouble with Apache 2.0.54 and Python 2.5.1
In-Reply-To: <p5ave3pa8lupgm74m2o8866da7pp8g14v1@4ax.com>
References: <fj7ve35id2kj2o7tidq6o8ah7ji6hbn9d1@4ax.com>
	<88e286470709180324q73eb37cdm5aed4da04144bdcc@mail.gmail.com>
	<p5ave3pa8lupgm74m2o8866da7pp8g14v1@4ax.com>
Message-ID: <88e286470709180339y1ac16beela026805d6608b973@mail.gmail.com>

On 18/09/2007, David Moorhouse <python@moorhouse.net.nz> wrote:
>
> >What was the name of the mod_python installer  you used? Did you
> >definitely use the version for Apache 2.0/Python 2.5?
>
> mod_python-3.3.1.win32-py2.5-Apache2.0.exe
>
>
> >
> >Is there any other python25.dll files on your system anywhere? Some
> >third party Windows applications use Python internally and provide
> >their own python25.dll. If that is in a directory on PATH found before
> >the system directory version, it can cause a failure.
>
> I've done a search for python25.dll and it only finds the one in the
> system32 directory.
>
> >
> >Other than that, only other suggestion is that if running Apache as
> >service, that the user it runs as has adequate permissions to read
> >mod_python and Python installed files.
>
> Admin in both cases.
> >
> >Graham
>
> Thanks for your help, but I'm finding this very frustrating ;(
>
> Do you think the difference in import / export ordinals is significant or
> are the functions linked on the exported names (and not by ordinal) ?

I have no idea as I don't know what you are talking about when you
mention 'import/export ordinals'. I am not a Windows person.

When people cant get passed this problem, often doing a complete
uninstall and reinstall of mod_python/Python/Apache magically fixes
the problem.

Graham
From swati at ibcs.in  Tue Sep 18 11:32:24 2007
From: swati at ibcs.in (Swati Mazumder)
Date: Tue Sep 18 11:33:06 2007
Subject: [mod_python] [SPAM] mod python installation problem
Message-ID: <002b01c7fa09$20fa6940$7b39e2dc@IBM59C3E89BC98>

Hi All,

My apache installation directory is /home/djtstdir/apachedj
I have created django project at location /home/djtstdir/djproject

Here is what I have done, the part of django configuration in apache configuration file
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Example:
# LoadModule foo_module modules/mod_foo.so
#
LoadModule python_module modules/mod_python.so
#;
:
:
:
#add location directive
<location "/djproject/">
        SetHandler python-program
        PythonHandler django.core.handlers.modpython
        SetEnv DJANGO_SETTINGS_MODULE /home/djtstdir/djproject
        PythonDebug On
        PythonInterpreter djproject
</location>

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
I have modified urls.py to test a simple application, but its showing 404 error. Here is what I am getting in log file,-

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[Fri Sep 14 04:07:06 2007] [notice] mod_python: using mutex_directory /tmp
[Fri Sep 14 04:07:06 2007] [notice] Apache/2.2.4 (Unix) mod_python/3.3.1 Python/2.4.4 configured -- resuming normal operations
[Fri Sep 14 04:07:53 2007] [error] [client 220.226.82.78] File does not exist: /home/djtstdir/apachedj/htdocs/favicon.ico
[Fri Sep 14 04:09:22 2007] [error] [client 220.226.82.78] File does not exist: /home/djtstdir/apachedj/htdocs/now
[Fri Sep 14 04:09:23 2007] [error] [client 220.226.82.78] File does not exist: /home/djtstdir/apachedj/htdocs/favicon.ico
[Mon Sep 17 02:35:57 2007] [notice] Graceful restart requested, doing restart
[Mon Sep 17 02:35:57 2007] [notice] mod_python: Creating 8 session mutexes based on 256 max processes and 0 max threads.
[Mon Sep 17 02:35:57 2007] [notice] mod_python: using mutex_directory /tmp
[Mon Sep 17 02:35:57 2007] [notice] Apache/2.2.4 (Unix) mod_python/3.3.1 Python/2.4.4 configured -- resuming normal operations
[Mon Sep 17 02:36:10 2007] [notice] SIGHUP received.  Attempting to restart
[Mon Sep 17 02:36:10 2007] [notice] mod_python: Creating 8 session mutexes based on 256 max processes and 0 max threads.
[Mon Sep 17 02:36:10 2007] [notice] mod_python: using mutex_directory /tmp
[Mon Sep 17 02:36:10 2007] [notice] Apache/2.2.4 (Unix) mod_python/3.3.1 Python/2.4.4 configured -- resuming normal operations
[Mon Sep 17 02:36:51 2007] [error] [client 220.226.23.45] File does not exist: /home/djtstdir/apachedj/htdocs/now
[Mon Sep 17 02:36:53 2007] [error] [client 220.226.23.45] File does not exist: /home/djtstdir/apachedj/htdocs/favicon.ico
[Mon Sep 17 02:37:14 2007] [error] [client 220.226.23.45] File does not exist: /home/djtstdir/apachedj/htdocs/now
[Mon Sep 17 02:37:36 2007] [error] [client 220.226.23.45] File does not exist: /home/djtstdir/apachedj/htdocs/now
[Mon Sep 17 02:37:37 2007] [error] [client 220.226.23.45] File does not exist: /home/djtstdir/apachedj/htdocs/favicon.ico
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Any idea what can be the problem.

Many Thanks,
Swati

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070918/8736f3ce/attachment-0001.html
From jubei at csh.rit.edu  Tue Sep 18 12:04:30 2007
From: jubei at csh.rit.edu (jon heise)
Date: Tue Sep 18 12:05:04 2007
Subject: [SPAM] [mod_python] [SPAM] mod python installation problem
In-Reply-To: <002b01c7fa09$20fa6940$7b39e2dc@IBM59C3E89BC98>
References: <002b01c7fa09$20fa6940$7b39e2dc@IBM59C3E89BC98>
Message-ID: <46EFF70E.30006@csh.rit.edu>

Swati Mazumder wrote:
> Hi All,
>  
> My apache installation directory is /home/djtstdir/apachedj
> I have created django project at location /home/djtstdir/djproject
>  
> Here is what I have done, the part of django configuration in apache 
> configuration file
> ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> # Example:
> # LoadModule foo_module modules/mod_foo.so
> #
> LoadModule python_module modules/mod_python.so
> #;
> :
> :
> :
> #add location directive
> <location "/djproject/">
>         SetHandler python-program
>         PythonHandler django.core.handlers.modpython
>         SetEnv DJANGO_SETTINGS_MODULE /home/djtstdir/djproject
>         PythonDebug On
>         PythonInterpreter djproject
> </location>
> ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> I have modified urls.py to test a simple application, but its showing 
> 404 error. Here is what I am getting in log file,-
>  
> ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
> [Fri Sep 14 04:07:06 2007] [notice] mod_python: using mutex_directory /tmp
> [Fri Sep 14 04:07:06 2007] [notice] Apache/2.2.4 (Unix) 
> mod_python/3.3.1 Python/2.4.4 configured -- resuming normal operations
> [Fri Sep 14 04:07:53 2007] [error] [client 220.226.82.78] File does 
> not exist: /home/djtstdir/apachedj/htdocs/favicon.ico
> [Fri Sep 14 04:09:22 2007] [error] [client 220.226.82.78] File does 
> not exist: /home/djtstdir/apachedj/htdocs/now
> [Fri Sep 14 04:09:23 2007] [error] [client 220.226.82.78] File does 
> not exist: /home/djtstdir/apachedj/htdocs/favicon.ico
> [Mon Sep 17 02:35:57 2007] [notice] Graceful restart requested, doing 
> restart
> [Mon Sep 17 02:35:57 2007] [notice] mod_python: Creating 8 session 
> mutexes based on 256 max processes and 0 max threads.
> [Mon Sep 17 02:35:57 2007] [notice] mod_python: using mutex_directory /tmp
> [Mon Sep 17 02:35:57 2007] [notice] Apache/2.2.4 (Unix) 
> mod_python/3.3.1 Python/2.4.4 configured -- resuming normal operations
> [Mon Sep 17 02:36:10 2007] [notice] SIGHUP received.  Attempting to 
> restart
> [Mon Sep 17 02:36:10 2007] [notice] mod_python: Creating 8 session 
> mutexes based on 256 max processes and 0 max threads.
> [Mon Sep 17 02:36:10 2007] [notice] mod_python: using mutex_directory /tmp
> [Mon Sep 17 02:36:10 2007] [notice] Apache/2.2.4 (Unix) 
> mod_python/3.3.1 Python/2.4.4 configured -- resuming normal operations
> [Mon Sep 17 02:36:51 2007] [error] [client 220.226.23.45] File does 
> not exist: /home/djtstdir/apachedj/htdocs/now
> [Mon Sep 17 02:36:53 2007] [error] [client 220.226.23.45] File does 
> not exist: /home/djtstdir/apachedj/htdocs/favicon.ico
> [Mon Sep 17 02:37:14 2007] [error] [client 220.226.23.45] File does 
> not exist: /home/djtstdir/apachedj/htdocs/now
> [Mon Sep 17 02:37:36 2007] [error] [client 220.226.23.45] File does 
> not exist: /home/djtstdir/apachedj/htdocs/now
> [Mon Sep 17 02:37:37 2007] [error] [client 220.226.23.45] File does 
> not exist: /home/djtstdir/apachedj/htdocs/favicon.ico
> ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
>  
> Any idea what can be the problem.
>  
> Many Thanks,
> Swati
>
> ------------------------------------------------------------------------
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>   
try adding PythonPath "['/home/djtstdir'] + sys.path"  to your location 
directive, also change the DJANGO_SETTINGS_MODULE from 
/home/djtstdir/djproject to djproject.settings  assuming settings is the 
name of settings file in your project

- jon heise
From swati at ibcs.in  Tue Sep 18 12:30:49 2007
From: swati at ibcs.in (Swati Mazumder)
Date: Tue Sep 18 12:31:26 2007
Subject: [SPAM] Re: [SPAM] [mod_python] [SPAM] mod python installation problem
References: <002b01c7fa09$20fa6940$7b39e2dc@IBM59C3E89BC98>
	<46EFF70E.30006@csh.rit.edu>
Message-ID: <003f01c7fa11$4a320a90$7b39e2dc@IBM59C3E89BC98>

Hi Jon,

I have tried this before, but was making some silly mistake for sure and it 
did not work. This time it worked.

Many Thanks,-
Swati

----- Original Message ----- 
From: "jon heise" <jubei@csh.rit.edu>
To: <mod_python@modpython.org>
Sent: Tuesday, September 18, 2007 9:34 PM
Subject: Re: [SPAM] [mod_python] [SPAM] mod python installation problem


> Swati Mazumder wrote:
>> Hi All,
>>  My apache installation directory is /home/djtstdir/apachedj
>> I have created django project at location /home/djtstdir/djproject
>>  Here is what I have done, the part of django configuration in apache 
>> configuration file
>> ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
>> # Example:
>> # LoadModule foo_module modules/mod_foo.so
>> #
>> LoadModule python_module modules/mod_python.so
>> #;
>> :
>> :
>> :
>> #add location directive
>> <location "/djproject/">
>>         SetHandler python-program
>>         PythonHandler django.core.handlers.modpython
>>         SetEnv DJANGO_SETTINGS_MODULE /home/djtstdir/djproject
>>         PythonDebug On
>>         PythonInterpreter djproject
>> </location>
>> ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
>> I have modified urls.py to test a simple application, but its showing 404 
>> error. Here is what I am getting in log file,-
>>  ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
>> [Fri Sep 14 04:07:06 2007] [notice] mod_python: using mutex_directory 
>> /tmp
>> [Fri Sep 14 04:07:06 2007] [notice] Apache/2.2.4 (Unix) mod_python/3.3.1 
>> Python/2.4.4 configured -- resuming normal operations
>> [Fri Sep 14 04:07:53 2007] [error] [client 220.226.82.78] File does not 
>> exist: /home/djtstdir/apachedj/htdocs/favicon.ico
>> [Fri Sep 14 04:09:22 2007] [error] [client 220.226.82.78] File does not 
>> exist: /home/djtstdir/apachedj/htdocs/now
>> [Fri Sep 14 04:09:23 2007] [error] [client 220.226.82.78] File does not 
>> exist: /home/djtstdir/apachedj/htdocs/favicon.ico
>> [Mon Sep 17 02:35:57 2007] [notice] Graceful restart requested, doing 
>> restart
>> [Mon Sep 17 02:35:57 2007] [notice] mod_python: Creating 8 session 
>> mutexes based on 256 max processes and 0 max threads.
>> [Mon Sep 17 02:35:57 2007] [notice] mod_python: using mutex_directory 
>> /tmp
>> [Mon Sep 17 02:35:57 2007] [notice] Apache/2.2.4 (Unix) mod_python/3.3.1 
>> Python/2.4.4 configured -- resuming normal operations
>> [Mon Sep 17 02:36:10 2007] [notice] SIGHUP received.  Attempting to 
>> restart
>> [Mon Sep 17 02:36:10 2007] [notice] mod_python: Creating 8 session 
>> mutexes based on 256 max processes and 0 max threads.
>> [Mon Sep 17 02:36:10 2007] [notice] mod_python: using mutex_directory 
>> /tmp
>> [Mon Sep 17 02:36:10 2007] [notice] Apache/2.2.4 (Unix) mod_python/3.3.1 
>> Python/2.4.4 configured -- resuming normal operations
>> [Mon Sep 17 02:36:51 2007] [error] [client 220.226.23.45] File does not 
>> exist: /home/djtstdir/apachedj/htdocs/now
>> [Mon Sep 17 02:36:53 2007] [error] [client 220.226.23.45] File does not 
>> exist: /home/djtstdir/apachedj/htdocs/favicon.ico
>> [Mon Sep 17 02:37:14 2007] [error] [client 220.226.23.45] File does not 
>> exist: /home/djtstdir/apachedj/htdocs/now
>> [Mon Sep 17 02:37:36 2007] [error] [client 220.226.23.45] File does not 
>> exist: /home/djtstdir/apachedj/htdocs/now
>> [Mon Sep 17 02:37:37 2007] [error] [client 220.226.23.45] File does not 
>> exist: /home/djtstdir/apachedj/htdocs/favicon.ico
>> ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
>>  Any idea what can be the problem.
>>  Many Thanks,
>> Swati
>>
>> ------------------------------------------------------------------------
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>
> try adding PythonPath "['/home/djtstdir'] + sys.path"  to your location 
> directive, also change the DJANGO_SETTINGS_MODULE from 
> /home/djtstdir/djproject to djproject.settings  assuming settings is the 
> name of settings file in your project
>
> - jon heise
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 


From python at moorhouse.net.nz  Wed Sep 19 23:06:00 2007
From: python at moorhouse.net.nz (David Moorhouse)
Date: Wed Sep 19 23:06:31 2007
Subject: [mod_python] Trouble with Apache 2.0.54 and Python 2.5.1
In-Reply-To: <88e286470709180339y1ac16beela026805d6608b973@mail.gmail.com>
References: <fj7ve35id2kj2o7tidq6o8ah7ji6hbn9d1@4ax.com>
	<88e286470709180324q73eb37cdm5aed4da04144bdcc@mail.gmail.com>
	<p5ave3pa8lupgm74m2o8866da7pp8g14v1@4ax.com>
	<88e286470709180339y1ac16beela026805d6608b973@mail.gmail.com>
Message-ID: <lpo3f39bqmnuludvk4qf10v3nn1efe8edh@4ax.com>

Hi Graeme

I think it is a problem with Apache 2.054 for Windows.  I was having
problems on the production machine and my dev box.

Upgrading to 2.059 fixed the problem.

Thanks for your help.

Cheers

D

On Tue, 18 Sep 2007 20:39:05 +1000, you wrote:

>On 18/09/2007, David Moorhouse <python@moorhouse.net.nz> wrote:
>>
>> >What was the name of the mod_python installer  you used? Did you
>> >definitely use the version for Apache 2.0/Python 2.5?
>>
>> mod_python-3.3.1.win32-py2.5-Apache2.0.exe
>>
>>
>> >
>> >Is there any other python25.dll files on your system anywhere? Some
>> >third party Windows applications use Python internally and provide
>> >their own python25.dll. If that is in a directory on PATH found before
>> >the system directory version, it can cause a failure.
>>
>> I've done a search for python25.dll and it only finds the one in the
>> system32 directory.
>>
>> >
>> >Other than that, only other suggestion is that if running Apache as
>> >service, that the user it runs as has adequate permissions to read
>> >mod_python and Python installed files.
>>
>> Admin in both cases.
>> >
>> >Graham
>>
>> Thanks for your help, but I'm finding this very frustrating ;(
>>
>> Do you think the difference in import / export ordinals is significant or
>> are the functions linked on the exported names (and not by ordinal) ?
>
>I have no idea as I don't know what you are talking about when you
>mention 'import/export ordinals'. I am not a Windows person.
>
>When people cant get passed this problem, often doing a complete
>uninstall and reinstall of mod_python/Python/Apache magically fixes
>the problem.
>
>Graham


From morgan.covaluate at gmail.com  Thu Sep 20 19:23:57 2007
From: morgan.covaluate at gmail.com (Morgan Smith)
Date: Thu Sep 20 19:24:15 2007
Subject: [mod_python] import error help
Message-ID: <fd39af90709201623r3b00ac1j25c14db62957756c@mail.gmail.com>

Greetings,

 I am trying to setup mod_python to use tilecache. The hello world works
with the apache config directive

<Directory /opt/apache/current/htdocs/ptest>
        AddHandler python-program .py
        PythonHandler  mptest
 </Directory>


 My problem is that specifiying a subdirectory and Module name results in a
module not found.

 ie specifying  :    PythonHandler  Subdir.mptest  with the mptest.py but
into a sibdirectory Subdir.

would not work.  Is there a trick to getting the module paths to resolve
properly?


Any help appreciated

-Morgan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20070920/0d85b7b2/attachment.html
From graham.dumpleton at gmail.com  Thu Sep 20 19:40:02 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Thu Sep 20 19:40:17 2007
Subject: [mod_python] import error help
In-Reply-To: <fd39af90709201623r3b00ac1j25c14db62957756c@mail.gmail.com>
References: <fd39af90709201623r3b00ac1j25c14db62957756c@mail.gmail.com>
Message-ID: <88e286470709201640m4155e6c0p9bf2682e3640eaa6@mail.gmail.com>

Put your Python code outside of your document tree and use PythonPath
directive to indicate where it is. In mod_python 3.3.1 you can have a
handler be in a package when in the document tree. For more details
see documentation associated with import_module() function in:

  http://www.modpython.org/live/current/doc-html/pyapi-apmeth.html

Graham

On 21/09/2007, Morgan Smith <morgan.covaluate@gmail.com> wrote:
>
> Greetings,
>
>  I am trying to setup mod_python to use tilecache. The hello world works
> with the apache config directive
>
> <Directory /opt/apache/current/htdocs/ptest>
>         AddHandler python-program .py
>         PythonHandler  mptest
>  </Directory>
>
>
>  My problem is that specifiying a subdirectory and Module name results in a
> module not found.
>
>  ie specifying  :    PythonHandler  Subdir.mptest  with the mptest.py but
> into a sibdirectory Subdir.
>
> would not work.  Is there a trick to getting the module paths to resolve
> properly?
>
>
> Any help appreciated
>
> -Morgan
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
From arnarbi at gmail.com  Sun Sep 23 17:05:10 2007
From: arnarbi at gmail.com (Arnar Birgisson)
Date: Sun Sep 23 17:05:29 2007
Subject: [mod_python] Apache 2.2 authen/authz and "require" semantics
Message-ID: <28012bc60709231405g43d82adfq3f0f7e3e7d39bec8@mail.gmail.com>

Hello there,

I'm having some trouble finding the right docs/examples to solve my problem.

What I want to do is to use a database (a Django model) to control
access to svn and trac (let's just focus on svn to begin with).

My urls are of the form http://svn.domain.tld/projectname/. In the db
I have an entry for each project, and on it a boolean field indicating
if the project should be public-readable or not.

How can I leave it up to the authen- or authzhandler to decide when
username/passwd is required? Seems if I require anything a
login-dialog is popped up, even if the authenhandler never looks at
the username and just return apache.OK if the project is
public-readable. If I have no require lines, no authentication seems
to take place and everything is wide-open regardless of the
public-readable switch.

>From [1] it seems the proper way with apache 2.2. is to provide both
an authen- and authzhandler, but I don't quite see how things should
work in my case.

Ideally, I'd like my config to look something like this:

SetEnv DJANGO_SETTINGS_MODULE projectadmin.settings
PythonHandlerModule projectadmin.authenhandler
Require project-access svn_read
<LimitExcept GET PROPFIND OPTIONS REPORT>
    Require project-access svn_write
</LimitExcept>

Making it work sanely with other auth- or authz handlers is no issue for me.

Arnar

[1] http://www.modpython.org/pipermail/mod_python/2007-July/024055.html
From graham.dumpleton at gmail.com  Sun Sep 23 21:32:40 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sun Sep 23 21:32:55 2007
Subject: [mod_python] Apache 2.2 authen/authz and "require" semantics
In-Reply-To: <28012bc60709231405g43d82adfq3f0f7e3e7d39bec8@mail.gmail.com>
References: <28012bc60709231405g43d82adfq3f0f7e3e7d39bec8@mail.gmail.com>
Message-ID: <88e286470709231832v276e85degc1b3976c907fe597@mail.gmail.com>

On 24/09/2007, Arnar Birgisson <arnarbi@gmail.com> wrote:
> Hello there,
>
> I'm having some trouble finding the right docs/examples to solve my problem.
>
> What I want to do is to use a database (a Django model) to control
> access to svn and trac (let's just focus on svn to begin with).
>
> My urls are of the form http://svn.domain.tld/projectname/. In the db
> I have an entry for each project, and on it a boolean field indicating
> if the project should be public-readable or not.
>
> How can I leave it up to the authen- or authzhandler to decide when
> username/passwd is required? Seems if I require anything a
> login-dialog is popped up, even if the authenhandler never looks at
> the username and just return apache.OK if the project is
> public-readable. If I have no require lines, no authentication seems
> to take place and everything is wide-open regardless of the
> public-readable switch.
>
> >From [1] it seems the proper way with apache 2.2. is to provide both
> an authen- and authzhandler, but I don't quite see how things should
> work in my case.
>
> Ideally, I'd like my config to look something like this:
>
> SetEnv DJANGO_SETTINGS_MODULE projectadmin.settings
> PythonHandlerModule projectadmin.authenhandler
> Require project-access svn_read
> <LimitExcept GET PROPFIND OPTIONS REPORT>
>     Require project-access svn_write
> </LimitExcept>
>
> Making it work sanely with other auth- or authz handlers is no issue for me.
>
> Arnar
>
> [1] http://www.modpython.org/pipermail/mod_python/2007-July/024055.html

Does it have to be configurable from Apache configuration, could you
just do it all in the Python script?

What we do to prevent people performing updates against tag
directories in subversion is:

<Location /svn>

    DAV svn
    SVNParentPath /usr/local/repository/subversion

     .....

    PythonInterpreter subversion_handlers
    PythonPath 'sys.path + ["/usr/local/pkg/apps/subversion"]'
    PythonFixupHandler subversion_handlers::protect_tagged_packages

</Location>

In the Python code file, then have:

from mod_python import apache
import fnmatch

# When access is to tagged packages, only allow read/only operations
# and copy command. This means that tagged packages will be able to
# be created, but will prevent files within a tagged package being
# changed and committed back into the repository, replacing files in
# the tagged version.

RESTRICTED_URI = '/svn/drives/!svn/*/*/packages/tags/*/*/*'
ALLOW_METHODS = [ 'OPTIONS', 'GET', 'PROPFIND', 'REPORT', 'COPY' ]

def protect_tagged_packages(req):
    if fnmatch.fnmatch(req.uri, RESTRICTED_URI):
        if req.method in ALLOW_METHODS:
            return apache.OK
        return apache.HTTP_FORBIDDEN
    return apache.OK

The only thing thus permitted on a tag directory is deleting it and
renaming it. Keep these for where people stuff up.

So, we don't even use auth/authz for this bit, but just use a fixup handler.

Graham
From webb.sprague at gmail.com  Sun Sep 23 22:19:03 2007
From: webb.sprague at gmail.com (Webb Sprague)
Date: Sun Sep 23 22:19:22 2007
Subject: [mod_python] Profiling mod_python with callables?
Message-ID: <b11ea23c0709231919s148e0eb8o7fa28340ad0fe916@mail.gmail.com>

Could anyone help me think about the following problem?

I have a handler, call it handler.py, in which I assign callable
objects to variables, creating pages through the magic of URL mapping.
 For example:

class Foo(object):
    def __init__(self, title):
        self.title = title

    def __call__(self, whatever):
        print "<title>" + title + "</title>"

page1 = Foo('Title 1')
page2 = Foo('Title 2')

You can thus browse http://blah.com/handler/page1 and
http://blah.com/handler/page2

I would like to profile everything from this handler page down,
preferably with a single command like hotshot.profile_everything(...)
near the top of handler.py.

Can anyone describe how?

Thanks, and let me know if I can submit more information.  I haven't
included the code because there is just so much of it...
From graham.dumpleton at gmail.com  Sun Sep 23 22:32:21 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sun Sep 23 22:32:30 2007
Subject: [mod_python] Profiling mod_python with callables?
In-Reply-To: <b11ea23c0709231919s148e0eb8o7fa28340ad0fe916@mail.gmail.com>
References: <b11ea23c0709231919s148e0eb8o7fa28340ad0fe916@mail.gmail.com>
Message-ID: <88e286470709231932y7d69edf7k763cca43816812cb@mail.gmail.com>

Presuming you are actually using mod_python.publisher as the URL
dispatcher, then  instead of using:

  PythonHandler mod_python.publisher

use:

  PythonHandler mymodule

In your 'mymodule.py' then add:

  from mod_python import publisher

  def handler(req):
    return publisher.handler(req)

Once you have that working, then you can wrap the call to
publisher.handler() with what ever you want, including profiling
tools.

Yes, this will also profile publisher's URL dispatch, but it is the
easiest place to insert it without having to do a bit of magic.

Graham

On 24/09/2007, Webb Sprague <webb.sprague@gmail.com> wrote:
> Could anyone help me think about the following problem?
>
> I have a handler, call it handler.py, in which I assign callable
> objects to variables, creating pages through the magic of URL mapping.
>  For example:
>
> class Foo(object):
>     def __init__(self, title):
>         self.title = title
>
>     def __call__(self, whatever):
>         print "<title>" + title + "</title>"
>
> page1 = Foo('Title 1')
> page2 = Foo('Title 2')
>
> You can thus browse http://blah.com/handler/page1 and
> http://blah.com/handler/page2
>
> I would like to profile everything from this handler page down,
> preferably with a single command like hotshot.profile_everything(...)
> near the top of handler.py.
>
> Can anyone describe how?
>
> Thanks, and let me know if I can submit more information.  I haven't
> included the code because there is just so much of it...
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From graham.dumpleton at gmail.com  Mon Sep 24 00:12:55 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Sep 24 00:13:08 2007
Subject: [mod_python] Profiling mod_python with callables?
In-Reply-To: <b11ea23c0709232027p1c4d6ba6keba7cfbf612ca9f6@mail.gmail.com>
References: <b11ea23c0709231919s148e0eb8o7fa28340ad0fe916@mail.gmail.com>
	<88e286470709231932y7d69edf7k763cca43816812cb@mail.gmail.com>
	<b11ea23c0709232027p1c4d6ba6keba7cfbf612ca9f6@mail.gmail.com>
Message-ID: <88e286470709232112v6411aea8uf59002ee24a133f5@mail.gmail.com>

Bouncing this back to list as reply-all not used.

In what way does that not actually work?

Graham

On 24/09/2007, Webb Sprague <webb.sprague@gmail.com> wrote:
> Well, Graham, as usual you are an extremely prompt and helpful
> correspondent... but is there any way to do something like the
> following, which would work per call, giving a regular display and
> writing to a log (if it worked at all)? --
>
>
> ListObjects = LcPageObjects.LcList(lcdb=lcdb,
>                                    navTemplate=LARRYTEMPLATEDIR +
> '/Application.tmpl',
>                                    objectListTemplate =
> LARRYTEMPLATEDIR + '/ObjectList.tmpl',
>                                    title='LAR-E Object List')
> def ListObjectsProfile():
>     global ListObjects
>     return cProfile.run('ListObjects()', '/tmp/ListObjectProf')
>
> Tx
>
> On 9/23/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > Presuming you are actually using mod_python.publisher as the URL
> > dispatcher, then  instead of using:
> >
> >   PythonHandler mod_python.publisher
> >
> > use:
> >
> >   PythonHandler mymodule
> >
> > In your 'mymodule.py' then add:
> >
> >   from mod_python import publisher
> >
> >   def handler(req):
> >     return publisher.handler(req)
> >
> > Once you have that working, then you can wrap the call to
> > publisher.handler() with what ever you want, including profiling
> > tools.
> >
> > Yes, this will also profile publisher's URL dispatch, but it is the
> > easiest place to insert it without having to do a bit of magic.
> >
> > Graham
> >
> > On 24/09/2007, Webb Sprague <webb.sprague@gmail.com> wrote:
> > > Could anyone help me think about the following problem?
> > >
> > > I have a handler, call it handler.py, in which I assign callable
> > > objects to variables, creating pages through the magic of URL mapping.
> > >  For example:
> > >
> > > class Foo(object):
> > >     def __init__(self, title):
> > >         self.title = title
> > >
> > >     def __call__(self, whatever):
> > >         print "<title>" + title + "</title>"
> > >
> > > page1 = Foo('Title 1')
> > > page2 = Foo('Title 2')
> > >
> > > You can thus browse http://blah.com/handler/page1 and
> > > http://blah.com/handler/page2
> > >
> > > I would like to profile everything from this handler page down,
> > > preferably with a single command like hotshot.profile_everything(...)
> > > near the top of handler.py.
> > >
> > > Can anyone describe how?
> > >
> > > Thanks, and let me know if I can submit more information.  I haven't
> > > included the code because there is just so much of it...
> > > _______________________________________________
> > > Mod_python mailing list
> > > Mod_python@modpython.org
> > > http://mailman.modpython.org/mailman/listinfo/mod_python
> > >
> >
>
From webb.sprague at gmail.com  Mon Sep 24 00:20:30 2007
From: webb.sprague at gmail.com (Webb Sprague)
Date: Mon Sep 24 00:20:45 2007
Subject: [mod_python] Profiling mod_python with callables?
In-Reply-To: <88e286470709232112v6411aea8uf59002ee24a133f5@mail.gmail.com>
References: <b11ea23c0709231919s148e0eb8o7fa28340ad0fe916@mail.gmail.com>
	<88e286470709231932y7d69edf7k763cca43816812cb@mail.gmail.com>
	<b11ea23c0709232027p1c4d6ba6keba7cfbf612ca9f6@mail.gmail.com>
	<88e286470709232112v6411aea8uf59002ee24a133f5@mail.gmail.com>
Message-ID: <b11ea23c0709232120u4d5e19dcme567b60e587d43a5@mail.gmail.com>

(Sorry meant to reply to list.)

Here is the error from http://blah/larry/lc/ListObjectsProfile, minus
some personal stuff ;)

MOD_PYTHON ERROR

ProcessId:      31202

URI:            '/larry/lc/ListObjectsProfile'
Location:       None
PathInfo:       '/ListObjectsProfile'

Phase:          'PythonHandler'
Handler:        'mod_python.publisher'

Traceback (most recent call last):

  File "/usr/lib64/python2.5/site-packages/mod_python/importer.py",
line 1537, in HandlerDispatch
    default=default_handler, arg=req, silent=hlist.silent)

  File "/usr/lib64/python2.5/site-packages/mod_python/importer.py",
line 1229, in _process_target
    result = _execute_target(config, req, object, arg)

  File "/usr/lib64/python2.5/site-packages/mod_python/importer.py",
line 1128, in _execute_target
    result = object(arg)

  File "/usr/lib64/python2.5/site-packages/mod_python/publisher.py",
line 213, in handler
    published = publish_object(req, object)

  File "/usr/lib64/python2.5/site-packages/mod_python/publisher.py",
line 425, in publish_object
    return publish_object(req,util.apply_fs_data(object, req.form, req=req))

  File "/usr/lib64/python2.5/site-packages/mod_python/util.py", line
554, in apply_fs_data
    return object(**args)

  File "/var/www/localhost/htdocs/larry/lc.py", line 82, in ListObjectsProfile
    return cProfile.run('ListObjects', '/tmp/ListObjectProf')

  File "/usr/lib64/python2.5/cProfile.py", line 29, in run
    prof = prof.run(statement)

  File "/usr/lib64/python2.5/cProfile.py", line 135, in run
    return self.runctx(cmd, dict, dict)

  File "/usr/lib64/python2.5/cProfile.py", line 140, in runctx
    exec cmd in globals, locals

  File "<string>", line 1, in <module>

NameError: name 'ListObjects' is not defined


On 9/23/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> Bouncing this back to list as reply-all not used.
>
> In what way does that not actually work?
>
> Graham
>
> On 24/09/2007, Webb Sprague <webb.sprague@gmail.com> wrote:
> > Well, Graham, as usual you are an extremely prompt and helpful
> > correspondent... but is there any way to do something like the
> > following, which would work per call, giving a regular display and
> > writing to a log (if it worked at all)? --
> >
> >
> > ListObjects = LcPageObjects.LcList(lcdb=lcdb,
> >                                    navTemplate=LARRYTEMPLATEDIR +
> > '/Application.tmpl',
> >                                    objectListTemplate =
> > LARRYTEMPLATEDIR + '/ObjectList.tmpl',
> >                                    title='LAR-E Object List')
> > def ListObjectsProfile():
> >     global ListObjects
> >     return cProfile.run('ListObjects()', '/tmp/ListObjectProf')
> >
> > Tx
> >
> > On 9/23/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > > Presuming you are actually using mod_python.publisher as the URL
> > > dispatcher, then  instead of using:
> > >
> > >   PythonHandler mod_python.publisher
> > >
> > > use:
> > >
> > >   PythonHandler mymodule
> > >
> > > In your 'mymodule.py' then add:
> > >
> > >   from mod_python import publisher
> > >
> > >   def handler(req):
> > >     return publisher.handler(req)
> > >
> > > Once you have that working, then you can wrap the call to
> > > publisher.handler() with what ever you want, including profiling
> > > tools.
> > >
> > > Yes, this will also profile publisher's URL dispatch, but it is the
> > > easiest place to insert it without having to do a bit of magic.
> > >
> > > Graham
> > >
> > > On 24/09/2007, Webb Sprague <webb.sprague@gmail.com> wrote:
> > > > Could anyone help me think about the following problem?
> > > >
> > > > I have a handler, call it handler.py, in which I assign callable
> > > > objects to variables, creating pages through the magic of URL mapping.
> > > >  For example:
> > > >
> > > > class Foo(object):
> > > >     def __init__(self, title):
> > > >         self.title = title
> > > >
> > > >     def __call__(self, whatever):
> > > >         print "<title>" + title + "</title>"
> > > >
> > > > page1 = Foo('Title 1')
> > > > page2 = Foo('Title 2')
> > > >
> > > > You can thus browse http://blah.com/handler/page1 and
> > > > http://blah.com/handler/page2
> > > >
> > > > I would like to profile everything from this handler page down,
> > > > preferably with a single command like hotshot.profile_everything(...)
> > > > near the top of handler.py.
> > > >
> > > > Can anyone describe how?
> > > >
> > > > Thanks, and let me know if I can submit more information.  I haven't
> > > > included the code because there is just so much of it...
> > > > _______________________________________________
> > > > Mod_python mailing list
> > > > Mod_python@modpython.org
> > > > http://mailman.modpython.org/mailman/listinfo/mod_python
> > > >
> > >
> >
>
From graham.dumpleton at gmail.com  Mon Sep 24 01:10:56 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Sep 24 01:11:08 2007
Subject: [mod_python] Profiling mod_python with callables?
In-Reply-To: <b11ea23c0709232120u4d5e19dcme567b60e587d43a5@mail.gmail.com>
References: <b11ea23c0709231919s148e0eb8o7fa28340ad0fe916@mail.gmail.com>
	<88e286470709231932y7d69edf7k763cca43816812cb@mail.gmail.com>
	<b11ea23c0709232027p1c4d6ba6keba7cfbf612ca9f6@mail.gmail.com>
	<88e286470709232112v6411aea8uf59002ee24a133f5@mail.gmail.com>
	<b11ea23c0709232120u4d5e19dcme567b60e587d43a5@mail.gmail.com>
Message-ID: <88e286470709232210u6f7ff95aldd86c5f6442bc9fc@mail.gmail.com>

Use:

  return cProfile.runctx('ListObjects()', globals(), locals(),
filename='/tmp/ListObjectProf')

instead.

Graham

On 24/09/2007, Webb Sprague <webb.sprague@gmail.com> wrote:
> (Sorry meant to reply to list.)
>
> Here is the error from http://blah/larry/lc/ListObjectsProfile, minus
> some personal stuff ;)
>
> MOD_PYTHON ERROR
>
> ProcessId:      31202
>
> URI:            '/larry/lc/ListObjectsProfile'
> Location:       None
> PathInfo:       '/ListObjectsProfile'
>
> Phase:          'PythonHandler'
> Handler:        'mod_python.publisher'
>
> Traceback (most recent call last):
>
>   File "/usr/lib64/python2.5/site-packages/mod_python/importer.py",
> line 1537, in HandlerDispatch
>     default=default_handler, arg=req, silent=hlist.silent)
>
>   File "/usr/lib64/python2.5/site-packages/mod_python/importer.py",
> line 1229, in _process_target
>     result = _execute_target(config, req, object, arg)
>
>   File "/usr/lib64/python2.5/site-packages/mod_python/importer.py",
> line 1128, in _execute_target
>     result = object(arg)
>
>   File "/usr/lib64/python2.5/site-packages/mod_python/publisher.py",
> line 213, in handler
>     published = publish_object(req, object)
>
>   File "/usr/lib64/python2.5/site-packages/mod_python/publisher.py",
> line 425, in publish_object
>     return publish_object(req,util.apply_fs_data(object, req.form, req=req))
>
>   File "/usr/lib64/python2.5/site-packages/mod_python/util.py", line
> 554, in apply_fs_data
>     return object(**args)
>
>   File "/var/www/localhost/htdocs/larry/lc.py", line 82, in ListObjectsProfile
>     return cProfile.run('ListObjects', '/tmp/ListObjectProf')
>
>   File "/usr/lib64/python2.5/cProfile.py", line 29, in run
>     prof = prof.run(statement)
>
>   File "/usr/lib64/python2.5/cProfile.py", line 135, in run
>     return self.runctx(cmd, dict, dict)
>
>   File "/usr/lib64/python2.5/cProfile.py", line 140, in runctx
>     exec cmd in globals, locals
>
>   File "<string>", line 1, in <module>
>
> NameError: name 'ListObjects' is not defined
>
>
> On 9/23/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > Bouncing this back to list as reply-all not used.
> >
> > In what way does that not actually work?
> >
> > Graham
> >
> > On 24/09/2007, Webb Sprague <webb.sprague@gmail.com> wrote:
> > > Well, Graham, as usual you are an extremely prompt and helpful
> > > correspondent... but is there any way to do something like the
> > > following, which would work per call, giving a regular display and
> > > writing to a log (if it worked at all)? --
> > >
> > >
> > > ListObjects = LcPageObjects.LcList(lcdb=lcdb,
> > >                                    navTemplate=LARRYTEMPLATEDIR +
> > > '/Application.tmpl',
> > >                                    objectListTemplate =
> > > LARRYTEMPLATEDIR + '/ObjectList.tmpl',
> > >                                    title='LAR-E Object List')
> > > def ListObjectsProfile():
> > >     global ListObjects
> > >     return cProfile.run('ListObjects()', '/tmp/ListObjectProf')
> > >
> > > Tx
> > >
> > > On 9/23/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > > > Presuming you are actually using mod_python.publisher as the URL
> > > > dispatcher, then  instead of using:
> > > >
> > > >   PythonHandler mod_python.publisher
> > > >
> > > > use:
> > > >
> > > >   PythonHandler mymodule
> > > >
> > > > In your 'mymodule.py' then add:
> > > >
> > > >   from mod_python import publisher
> > > >
> > > >   def handler(req):
> > > >     return publisher.handler(req)
> > > >
> > > > Once you have that working, then you can wrap the call to
> > > > publisher.handler() with what ever you want, including profiling
> > > > tools.
> > > >
> > > > Yes, this will also profile publisher's URL dispatch, but it is the
> > > > easiest place to insert it without having to do a bit of magic.
> > > >
> > > > Graham
> > > >
> > > > On 24/09/2007, Webb Sprague <webb.sprague@gmail.com> wrote:
> > > > > Could anyone help me think about the following problem?
> > > > >
> > > > > I have a handler, call it handler.py, in which I assign callable
> > > > > objects to variables, creating pages through the magic of URL mapping.
> > > > >  For example:
> > > > >
> > > > > class Foo(object):
> > > > >     def __init__(self, title):
> > > > >         self.title = title
> > > > >
> > > > >     def __call__(self, whatever):
> > > > >         print "<title>" + title + "</title>"
> > > > >
> > > > > page1 = Foo('Title 1')
> > > > > page2 = Foo('Title 2')
> > > > >
> > > > > You can thus browse http://blah.com/handler/page1 and
> > > > > http://blah.com/handler/page2
> > > > >
> > > > > I would like to profile everything from this handler page down,
> > > > > preferably with a single command like hotshot.profile_everything(...)
> > > > > near the top of handler.py.
> > > > >
> > > > > Can anyone describe how?
> > > > >
> > > > > Thanks, and let me know if I can submit more information.  I haven't
> > > > > included the code because there is just so much of it...
> > > > > _______________________________________________
> > > > > Mod_python mailing list
> > > > > Mod_python@modpython.org
> > > > > http://mailman.modpython.org/mailman/listinfo/mod_python
> > > > >
> > > >
> > >
> >
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From webb.sprague at gmail.com  Mon Sep 24 01:35:26 2007
From: webb.sprague at gmail.com (Webb Sprague)
Date: Mon Sep 24 01:35:43 2007
Subject: [mod_python] Profiling mod_python with callables?
In-Reply-To: <88e286470709232210u6f7ff95aldd86c5f6442bc9fc@mail.gmail.com>
References: <b11ea23c0709231919s148e0eb8o7fa28340ad0fe916@mail.gmail.com>
	<88e286470709231932y7d69edf7k763cca43816812cb@mail.gmail.com>
	<b11ea23c0709232027p1c4d6ba6keba7cfbf612ca9f6@mail.gmail.com>
	<88e286470709232112v6411aea8uf59002ee24a133f5@mail.gmail.com>
	<b11ea23c0709232120u4d5e19dcme567b60e587d43a5@mail.gmail.com>
	<88e286470709232210u6f7ff95aldd86c5f6442bc9fc@mail.gmail.com>
Message-ID: <b11ea23c0709232235m6fb7bcc1k7cad547ac2cb7bca@mail.gmail.com>

On 9/23/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> Use:
>
>   return cProfile.runctx('ListObjects()', globals(), locals(),
> filename='/tmp/ListObjectProf')

This errors out:

Traceback (most recent call last):

  File "/usr/lib64/python2.5/site-packages/mod_python/importer.py",
line 1537, in HandlerDispatch
    default=default_handler, arg=req, silent=hlist.silent)

  File "/usr/lib64/python2.5/site-packages/mod_python/importer.py",
line 1229, in _process_target
    result = _execute_target(config, req, object, arg)

  File "/usr/lib64/python2.5/site-packages/mod_python/importer.py",
line 1128, in _execute_target
    result = object(arg)

  File "/usr/lib64/python2.5/site-packages/mod_python/publisher.py",
line 213, in handler
    published = publish_object(req, object)

  File "/usr/lib64/python2.5/site-packages/mod_python/publisher.py",
line 425, in publish_object
    return publish_object(req,util.apply_fs_data(object, req.form, req=req))

  File "/usr/lib64/python2.5/site-packages/mod_python/util.py", line
554, in apply_fs_data
    return object(**args)

  File "/var/www/localhost/htdocs/larry/lc.py", line 85, in ListObjectsProfile
    return cProfile.runctx('ListObjects()', globals(), locals(),
filename='/tmp/ListObjectProf')

  File "/usr/lib64/python2.5/cProfile.py", line 49, in runctx
    prof = prof.runctx(statement, globals, locals)

  File "/usr/lib64/python2.5/cProfile.py", line 140, in runctx
    exec cmd in globals, locals

  File "<string>", line 1, in <module>

TypeError: __call__() takes exactly 2 arguments (1 given)

TIA ;)
-W
>
> instead.
>
> Graham
>
> On 24/09/2007, Webb Sprague <webb.sprague@gmail.com> wrote:
> > (Sorry meant to reply to list.)
> >
> > Here is the error from http://blah/larry/lc/ListObjectsProfile, minus
> > some personal stuff ;)
> >
> > MOD_PYTHON ERROR
> >
> > ProcessId:      31202
> >
> > URI:            '/larry/lc/ListObjectsProfile'
> > Location:       None
> > PathInfo:       '/ListObjectsProfile'
> >
> > Phase:          'PythonHandler'
> > Handler:        'mod_python.publisher'
> >
> > Traceback (most recent call last):
> >
> >   File "/usr/lib64/python2.5/site-packages/mod_python/importer.py",
> > line 1537, in HandlerDispatch
> >     default=default_handler, arg=req, silent=hlist.silent)
> >
> >   File "/usr/lib64/python2.5/site-packages/mod_python/importer.py",
> > line 1229, in _process_target
> >     result = _execute_target(config, req, object, arg)
> >
> >   File "/usr/lib64/python2.5/site-packages/mod_python/importer.py",
> > line 1128, in _execute_target
> >     result = object(arg)
> >
> >   File "/usr/lib64/python2.5/site-packages/mod_python/publisher.py",
> > line 213, in handler
> >     published = publish_object(req, object)
> >
> >   File "/usr/lib64/python2.5/site-packages/mod_python/publisher.py",
> > line 425, in publish_object
> >     return publish_object(req,util.apply_fs_data(object, req.form, req=req))
> >
> >   File "/usr/lib64/python2.5/site-packages/mod_python/util.py", line
> > 554, in apply_fs_data
> >     return object(**args)
> >
> >   File "/var/www/localhost/htdocs/larry/lc.py", line 82, in ListObjectsProfile
> >     return cProfile.run('ListObjects', '/tmp/ListObjectProf')
> >
> >   File "/usr/lib64/python2.5/cProfile.py", line 29, in run
> >     prof = prof.run(statement)
> >
> >   File "/usr/lib64/python2.5/cProfile.py", line 135, in run
> >     return self.runctx(cmd, dict, dict)
> >
> >   File "/usr/lib64/python2.5/cProfile.py", line 140, in runctx
> >     exec cmd in globals, locals
> >
> >   File "<string>", line 1, in <module>
> >
> > NameError: name 'ListObjects' is not defined
> >
> >
> > On 9/23/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > > Bouncing this back to list as reply-all not used.
> > >
> > > In what way does that not actually work?
> > >
> > > Graham
> > >
> > > On 24/09/2007, Webb Sprague <webb.sprague@gmail.com> wrote:
> > > > Well, Graham, as usual you are an extremely prompt and helpful
> > > > correspondent... but is there any way to do something like the
> > > > following, which would work per call, giving a regular display and
> > > > writing to a log (if it worked at all)? --
> > > >
> > > >
> > > > ListObjects = LcPageObjects.LcList(lcdb=lcdb,
> > > >                                    navTemplate=LARRYTEMPLATEDIR +
> > > > '/Application.tmpl',
> > > >                                    objectListTemplate =
> > > > LARRYTEMPLATEDIR + '/ObjectList.tmpl',
> > > >                                    title='LAR-E Object List')
> > > > def ListObjectsProfile():
> > > >     global ListObjects
> > > >     return cProfile.run('ListObjects()', '/tmp/ListObjectProf')
> > > >
> > > > Tx
> > > >
> > > > On 9/23/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > > > > Presuming you are actually using mod_python.publisher as the URL
> > > > > dispatcher, then  instead of using:
> > > > >
> > > > >   PythonHandler mod_python.publisher
> > > > >
> > > > > use:
> > > > >
> > > > >   PythonHandler mymodule
> > > > >
> > > > > In your 'mymodule.py' then add:
> > > > >
> > > > >   from mod_python import publisher
> > > > >
> > > > >   def handler(req):
> > > > >     return publisher.handler(req)
> > > > >
> > > > > Once you have that working, then you can wrap the call to
> > > > > publisher.handler() with what ever you want, including profiling
> > > > > tools.
> > > > >
> > > > > Yes, this will also profile publisher's URL dispatch, but it is the
> > > > > easiest place to insert it without having to do a bit of magic.
> > > > >
> > > > > Graham
> > > > >
> > > > > On 24/09/2007, Webb Sprague <webb.sprague@gmail.com> wrote:
> > > > > > Could anyone help me think about the following problem?
> > > > > >
> > > > > > I have a handler, call it handler.py, in which I assign callable
> > > > > > objects to variables, creating pages through the magic of URL mapping.
> > > > > >  For example:
> > > > > >
> > > > > > class Foo(object):
> > > > > >     def __init__(self, title):
> > > > > >         self.title = title
> > > > > >
> > > > > >     def __call__(self, whatever):
> > > > > >         print "<title>" + title + "</title>"
> > > > > >
> > > > > > page1 = Foo('Title 1')
> > > > > > page2 = Foo('Title 2')
> > > > > >
> > > > > > You can thus browse http://blah.com/handler/page1 and
> > > > > > http://blah.com/handler/page2
> > > > > >
> > > > > > I would like to profile everything from this handler page down,
> > > > > > preferably with a single command like hotshot.profile_everything(...)
> > > > > > near the top of handler.py.
> > > > > >
> > > > > > Can anyone describe how?
> > > > > >
> > > > > > Thanks, and let me know if I can submit more information.  I haven't
> > > > > > included the code because there is just so much of it...
> > > > > > _______________________________________________
> > > > > > Mod_python mailing list
> > > > > > Mod_python@modpython.org
> > > > > > http://mailman.modpython.org/mailman/listinfo/mod_python
> > > > > >
> > > > >
> > > >
> > >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
>
From graham.dumpleton at gmail.com  Mon Sep 24 01:44:23 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Sep 24 01:44:39 2007
Subject: [mod_python] Profiling mod_python with callables?
In-Reply-To: <b11ea23c0709232235m6fb7bcc1k7cad547ac2cb7bca@mail.gmail.com>
References: <b11ea23c0709231919s148e0eb8o7fa28340ad0fe916@mail.gmail.com>
	<88e286470709231932y7d69edf7k763cca43816812cb@mail.gmail.com>
	<b11ea23c0709232027p1c4d6ba6keba7cfbf612ca9f6@mail.gmail.com>
	<88e286470709232112v6411aea8uf59002ee24a133f5@mail.gmail.com>
	<b11ea23c0709232120u4d5e19dcme567b60e587d43a5@mail.gmail.com>
	<88e286470709232210u6f7ff95aldd86c5f6442bc9fc@mail.gmail.com>
	<b11ea23c0709232235m6fb7bcc1k7cad547ac2cb7bca@mail.gmail.com>
Message-ID: <88e286470709232244k63150430o88c1b5055910bdf3@mail.gmail.com>

Then your original example code is wrong, ie., you have:

  return cProfile.runctx('ListObjects()', globals(), locals(),
filename='/tmp/ListObjectProf')

You must need to pass some arguments to ListObjects() call. Ie., that
is what it is now complaing about.

Graham

On 24/09/2007, Webb Sprague <webb.sprague@gmail.com> wrote:
> On 9/23/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > Use:
> >
> >   return cProfile.runctx('ListObjects()', globals(), locals(),
> > filename='/tmp/ListObjectProf')
>
> This errors out:
>
> Traceback (most recent call last):
>
>   File "/usr/lib64/python2.5/site-packages/mod_python/importer.py",
> line 1537, in HandlerDispatch
>     default=default_handler, arg=req, silent=hlist.silent)
>
>   File "/usr/lib64/python2.5/site-packages/mod_python/importer.py",
> line 1229, in _process_target
>     result = _execute_target(config, req, object, arg)
>
>   File "/usr/lib64/python2.5/site-packages/mod_python/importer.py",
> line 1128, in _execute_target
>     result = object(arg)
>
>   File "/usr/lib64/python2.5/site-packages/mod_python/publisher.py",
> line 213, in handler
>     published = publish_object(req, object)
>
>   File "/usr/lib64/python2.5/site-packages/mod_python/publisher.py",
> line 425, in publish_object
>     return publish_object(req,util.apply_fs_data(object, req.form, req=req))
>
>   File "/usr/lib64/python2.5/site-packages/mod_python/util.py", line
> 554, in apply_fs_data
>     return object(**args)
>
>   File "/var/www/localhost/htdocs/larry/lc.py", line 85, in ListObjectsProfile
>     return cProfile.runctx('ListObjects()', globals(), locals(),
> filename='/tmp/ListObjectProf')
>
>   File "/usr/lib64/python2.5/cProfile.py", line 49, in runctx
>     prof = prof.runctx(statement, globals, locals)
>
>   File "/usr/lib64/python2.5/cProfile.py", line 140, in runctx
>     exec cmd in globals, locals
>
>   File "<string>", line 1, in <module>
>
> TypeError: __call__() takes exactly 2 arguments (1 given)
>
> TIA ;)
> -W
> >
> > instead.
> >
> > Graham
> >
> > On 24/09/2007, Webb Sprague <webb.sprague@gmail.com> wrote:
> > > (Sorry meant to reply to list.)
> > >
> > > Here is the error from http://blah/larry/lc/ListObjectsProfile, minus
> > > some personal stuff ;)
> > >
> > > MOD_PYTHON ERROR
> > >
> > > ProcessId:      31202
> > >
> > > URI:            '/larry/lc/ListObjectsProfile'
> > > Location:       None
> > > PathInfo:       '/ListObjectsProfile'
> > >
> > > Phase:          'PythonHandler'
> > > Handler:        'mod_python.publisher'
> > >
> > > Traceback (most recent call last):
> > >
> > >   File "/usr/lib64/python2.5/site-packages/mod_python/importer.py",
> > > line 1537, in HandlerDispatch
> > >     default=default_handler, arg=req, silent=hlist.silent)
> > >
> > >   File "/usr/lib64/python2.5/site-packages/mod_python/importer.py",
> > > line 1229, in _process_target
> > >     result = _execute_target(config, req, object, arg)
> > >
> > >   File "/usr/lib64/python2.5/site-packages/mod_python/importer.py",
> > > line 1128, in _execute_target
> > >     result = object(arg)
> > >
> > >   File "/usr/lib64/python2.5/site-packages/mod_python/publisher.py",
> > > line 213, in handler
> > >     published = publish_object(req, object)
> > >
> > >   File "/usr/lib64/python2.5/site-packages/mod_python/publisher.py",
> > > line 425, in publish_object
> > >     return publish_object(req,util.apply_fs_data(object, req.form, req=req))
> > >
> > >   File "/usr/lib64/python2.5/site-packages/mod_python/util.py", line
> > > 554, in apply_fs_data
> > >     return object(**args)
> > >
> > >   File "/var/www/localhost/htdocs/larry/lc.py", line 82, in ListObjectsProfile
> > >     return cProfile.run('ListObjects', '/tmp/ListObjectProf')
> > >
> > >   File "/usr/lib64/python2.5/cProfile.py", line 29, in run
> > >     prof = prof.run(statement)
> > >
> > >   File "/usr/lib64/python2.5/cProfile.py", line 135, in run
> > >     return self.runctx(cmd, dict, dict)
> > >
> > >   File "/usr/lib64/python2.5/cProfile.py", line 140, in runctx
> > >     exec cmd in globals, locals
> > >
> > >   File "<string>", line 1, in <module>
> > >
> > > NameError: name 'ListObjects' is not defined
> > >
> > >
> > > On 9/23/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > > > Bouncing this back to list as reply-all not used.
> > > >
> > > > In what way does that not actually work?
> > > >
> > > > Graham
> > > >
> > > > On 24/09/2007, Webb Sprague <webb.sprague@gmail.com> wrote:
> > > > > Well, Graham, as usual you are an extremely prompt and helpful
> > > > > correspondent... but is there any way to do something like the
> > > > > following, which would work per call, giving a regular display and
> > > > > writing to a log (if it worked at all)? --
> > > > >
> > > > >
> > > > > ListObjects = LcPageObjects.LcList(lcdb=lcdb,
> > > > >                                    navTemplate=LARRYTEMPLATEDIR +
> > > > > '/Application.tmpl',
> > > > >                                    objectListTemplate =
> > > > > LARRYTEMPLATEDIR + '/ObjectList.tmpl',
> > > > >                                    title='LAR-E Object List')
> > > > > def ListObjectsProfile():
> > > > >     global ListObjects
> > > > >     return cProfile.run('ListObjects()', '/tmp/ListObjectProf')
> > > > >
> > > > > Tx
> > > > >
> > > > > On 9/23/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > > > > > Presuming you are actually using mod_python.publisher as the URL
> > > > > > dispatcher, then  instead of using:
> > > > > >
> > > > > >   PythonHandler mod_python.publisher
> > > > > >
> > > > > > use:
> > > > > >
> > > > > >   PythonHandler mymodule
> > > > > >
> > > > > > In your 'mymodule.py' then add:
> > > > > >
> > > > > >   from mod_python import publisher
> > > > > >
> > > > > >   def handler(req):
> > > > > >     return publisher.handler(req)
> > > > > >
> > > > > > Once you have that working, then you can wrap the call to
> > > > > > publisher.handler() with what ever you want, including profiling
> > > > > > tools.
> > > > > >
> > > > > > Yes, this will also profile publisher's URL dispatch, but it is the
> > > > > > easiest place to insert it without having to do a bit of magic.
> > > > > >
> > > > > > Graham
> > > > > >
> > > > > > On 24/09/2007, Webb Sprague <webb.sprague@gmail.com> wrote:
> > > > > > > Could anyone help me think about the following problem?
> > > > > > >
> > > > > > > I have a handler, call it handler.py, in which I assign callable
> > > > > > > objects to variables, creating pages through the magic of URL mapping.
> > > > > > >  For example:
> > > > > > >
> > > > > > > class Foo(object):
> > > > > > >     def __init__(self, title):
> > > > > > >         self.title = title
> > > > > > >
> > > > > > >     def __call__(self, whatever):
> > > > > > >         print "<title>" + title + "</title>"
> > > > > > >
> > > > > > > page1 = Foo('Title 1')
> > > > > > > page2 = Foo('Title 2')
> > > > > > >
> > > > > > > You can thus browse http://blah.com/handler/page1 and
> > > > > > > http://blah.com/handler/page2
> > > > > > >
> > > > > > > I would like to profile everything from this handler page down,
> > > > > > > preferably with a single command like hotshot.profile_everything(...)
> > > > > > > near the top of handler.py.
> > > > > > >
> > > > > > > Can anyone describe how?
> > > > > > >
> > > > > > > Thanks, and let me know if I can submit more information.  I haven't
> > > > > > > included the code because there is just so much of it...
> > > > > > > _______________________________________________
> > > > > > > Mod_python mailing list
> > > > > > > Mod_python@modpython.org
> > > > > > > http://mailman.modpython.org/mailman/listinfo/mod_python
> > > > > > >
> > > > > >
> > > > >
> > > >
> > > _______________________________________________
> > > Mod_python mailing list
> > > Mod_python@modpython.org
> > > http://mailman.modpython.org/mailman/listinfo/mod_python
> > >
> >
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From arnarbi at gmail.com  Mon Sep 24 06:33:46 2007
From: arnarbi at gmail.com (Arnar Birgisson)
Date: Mon Sep 24 06:33:55 2007
Subject: [mod_python] Apache 2.2 authen/authz and "require" semantics
In-Reply-To: <88e286470709231832v276e85degc1b3976c907fe597@mail.gmail.com>
References: <28012bc60709231405g43d82adfq3f0f7e3e7d39bec8@mail.gmail.com>
	<88e286470709231832v276e85degc1b3976c907fe597@mail.gmail.com>
Message-ID: <28012bc60709240333x2d342c38v7faf9e8fadefc05e@mail.gmail.com>

Hello Graham,

On 9/24/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> Does it have to be configurable from Apache configuration, could you
> just do it all in the Python script?

Yes, I could do it all from a python script - any way that works :)

> So, we don't even use auth/authz for this bit, but just use a fixup handler.

*goes to read about fixup-handlers*

Can I return apache.HTTP_UNAUTHORIZED from a fixup-handler to make the
browser request username/passwd?

thanks,
Arnar
From graham.dumpleton at gmail.com  Mon Sep 24 06:46:47 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Sep 24 06:47:02 2007
Subject: [mod_python] Apache 2.2 authen/authz and "require" semantics
In-Reply-To: <28012bc60709240333x2d342c38v7faf9e8fadefc05e@mail.gmail.com>
References: <28012bc60709231405g43d82adfq3f0f7e3e7d39bec8@mail.gmail.com>
	<88e286470709231832v276e85degc1b3976c907fe597@mail.gmail.com>
	<28012bc60709240333x2d342c38v7faf9e8fadefc05e@mail.gmail.com>
Message-ID: <88e286470709240346s6ebe55avbc5620eafe1d8ff9@mail.gmail.com>

On 24/09/2007, Arnar Birgisson <arnarbi@gmail.com> wrote:
> Hello Graham,
>
> On 9/24/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > Does it have to be configurable from Apache configuration, could you
> > just do it all in the Python script?
>
> Yes, I could do it all from a python script - any way that works :)
>
> > So, we don't even use auth/authz for this bit, but just use a fixup handler.
>
> *goes to read about fixup-handlers*
>
> Can I return apache.HTTP_UNAUTHORIZED from a fixup-handler to make the
> browser request username/passwd?

Technically you can. The issue will be that if you have defined
AuthType etc then the earlier auth handler phase may result in it not
getting that far.

When reading about fixup handlers, the main point to realise is that
for a authen handler you have:

*  Where multiple handlers are specified, if any handler in the
sequence returns a value other than apache.DECLINED, then execution of
all subsequent handlers for this phase are aborted.

For a fixup handler you instead have:

* Where multiple handlers are specified, if any handler in the
sequence returns a value other than apache.OK or apache.DECLINED, then
execution of all subsequent handlers for this phase are aborted.

This is referred to as RUN_FIRST as opposed to RUN_ALL. Ie., run until
first one returns and says it has done something, versus run all until
an error.

The other difference is purely the ordering of the phases and the
notional purpose of each phase.

If you really want to go deeply into understanding the difference, read:

  http://www.fmc-modeling.org/category/projects/apache/amp/4_4Request_Response_Loop.html

Graham
From arnarbi at gmail.com  Mon Sep 24 06:52:39 2007
From: arnarbi at gmail.com (Arnar Birgisson)
Date: Mon Sep 24 06:52:52 2007
Subject: [mod_python] Apache 2.2 authen/authz and "require" semantics
In-Reply-To: <88e286470709240346s6ebe55avbc5620eafe1d8ff9@mail.gmail.com>
References: <28012bc60709231405g43d82adfq3f0f7e3e7d39bec8@mail.gmail.com>
	<88e286470709231832v276e85degc1b3976c907fe597@mail.gmail.com>
	<28012bc60709240333x2d342c38v7faf9e8fadefc05e@mail.gmail.com>
	<88e286470709240346s6ebe55avbc5620eafe1d8ff9@mail.gmail.com>
Message-ID: <28012bc60709240352x65756a66w3ebafdd7fde1f16d@mail.gmail.com>

On 9/24/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> On 24/09/2007, Arnar Birgisson <arnarbi@gmail.com> wrote:
> > Can I return apache.HTTP_UNAUTHORIZED from a fixup-handler to make the
> > browser request username/passwd?
>
> Technically you can. The issue will be that if you have defined
> AuthType etc then the earlier auth handler phase may result in it not
> getting that far.

Would I perform the authentication in the fixup handler as well?
Basically just do it all there?

1. find project name
2. lookup project in db
3. if anon access allowed - apache.OK
4. call req.get_basic_auth_pw()
5. lookup user - apache.HTTP_UNAUTHORIZED if not found
6. check passwd - apache.HTTP_UNAUTHORIZED if no match
7. check for user access - apache.OK if allowed
8. apache.HTTP_UNAUTHORIZED otherwise

Arnar
From graham.dumpleton at gmail.com  Mon Sep 24 07:21:46 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Sep 24 07:21:59 2007
Subject: [mod_python] Apache 2.2 authen/authz and "require" semantics
In-Reply-To: <28012bc60709240352x65756a66w3ebafdd7fde1f16d@mail.gmail.com>
References: <28012bc60709231405g43d82adfq3f0f7e3e7d39bec8@mail.gmail.com>
	<88e286470709231832v276e85degc1b3976c907fe597@mail.gmail.com>
	<28012bc60709240333x2d342c38v7faf9e8fadefc05e@mail.gmail.com>
	<88e286470709240346s6ebe55avbc5620eafe1d8ff9@mail.gmail.com>
	<28012bc60709240352x65756a66w3ebafdd7fde1f16d@mail.gmail.com>
Message-ID: <88e286470709240421g11d6fde4mcf1cf0a380328e36@mail.gmail.com>

On 24/09/2007, Arnar Birgisson <arnarbi@gmail.com> wrote:
> On 9/24/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > On 24/09/2007, Arnar Birgisson <arnarbi@gmail.com> wrote:
> > > Can I return apache.HTTP_UNAUTHORIZED from a fixup-handler to make the
> > > browser request username/passwd?
> >
> > Technically you can. The issue will be that if you have defined
> > AuthType etc then the earlier auth handler phase may result in it not
> > getting that far.
>
> Would I perform the authentication in the fixup handler as well?
> Basically just do it all there?
>
> 1. find project name
> 2. lookup project in db
> 3. if anon access allowed - apache.OK
> 4. call req.get_basic_auth_pw()
> 5. lookup user - apache.HTTP_UNAUTHORIZED if not found
> 6. check passwd - apache.HTTP_UNAUTHORIZED if no match
> 7. check for user access - apache.OK if allowed
> 8. apache.HTTP_UNAUTHORIZED otherwise

But then you may as well do it all in the authentication handler and
just use 'Require valid-user' as the authorisation phase, although you
are strictly mixing up the intent of what the phases are all about.

Thus we get back to perhaps just doing it properly in the first place
but where mod_python doesn't exactly make it easy. This is partly
because of the incomplete exposure of the Apache APIs through
mod_python, partly because mod_python Basic authentication handling is
historically incorrect and has encouraged sloppy practices and partly
because of incomplete documentation for mod_python on how to do it
properly. :-(

At this point I scream and wish I had finished the auth/authz support
in mod_wsgi which will just make this all so much easier. :-)

For example, in mod_wsgi (unreleased 2.0), your Apache configuration
would be something (names of things still changing) like:

<AuthnProviderAlias wsgi django>
WSGIAuthenticationGroup django
AuthWSGIUserScript /usr/local/django/mysite/apache/auth.wsgi
</AuthnProviderAlias>

WSGIScriptAlias / /usr/local/django/mysite/apache/django.wsgi

<Directory /usr/local/django/mysite/apache>
Order deny,allow
Allow from all

WSGIApplicationGroup django

AuthType Basic
AuthName "Django Site"
AuthBasicProvider django
Require valid-user
</Directory>

Here the authentication is being applied to the Django site itself,
but could also be applied to Trac /login URL or Subversion access.

The auth script would then just be:

import os, sys
sys.path.append('/usr/local/django')
os.environ['DJANGO_SETTINGS_MODULE'] = 'mysite.settings'

import apache.mod_auth
from django.contrib.auth.models import User
from django import db

def check_password(environ, user, password):
    db.reset_queries()

    kwargs = {'username': req.user, 'is_active': True}

    try:
        try:
            user = User.objects.get(**kwargs)
        except User.DoesNotExist:
            return apache.mod_auth.AUTH_USER_NOT_FOUND

        if user.check_password(password):
            return apache.mod_auth.AUTH_GRANTED
        else:
            return apache.mod_auth.AUTH_DENIED
    finally:
        db.connection.close()

None of the worrying about HTTP headers, password decoding etc as
Apache does that all for you. You only have to worry about the
password check.

The bit I am still working on is the authorisation, ie., group access
bits. Using your example, this would be something like:

Require wsgi-group svn_read
<LimitExcept GET PROPFIND OPTIONS REPORT>
   Require wsgi-group svn_write
</LimitExcept>

Am looking at couple of different options at present as to how this
would be checked on Python side. One is to have:

def groups_for_user(environ, user):
    db.reset_queries()

    kwargs = {'username': req.user, 'is_active': True}

    try:
        try:
            user = User.objects.get(**kwargs)
        except User.DoesNotExist:
            return None

         return user.groups

    finally:
        db.connection.close()

The mod_wsgi module would then process the Require directives and
deliver the necessary response.

In the greater scheme of things, all much simpler.

In the mean time, I'll try and find some time to explain how to do it
for mod_python properly. Cant promise anything though as starting to
get backlogged as it is.

Graham
From arnarbi at gmail.com  Mon Sep 24 07:51:21 2007
From: arnarbi at gmail.com (Arnar Birgisson)
Date: Mon Sep 24 07:51:37 2007
Subject: [mod_python] Apache 2.2 authen/authz and "require" semantics
In-Reply-To: <88e286470709240421g11d6fde4mcf1cf0a380328e36@mail.gmail.com>
References: <28012bc60709231405g43d82adfq3f0f7e3e7d39bec8@mail.gmail.com>
	<88e286470709231832v276e85degc1b3976c907fe597@mail.gmail.com>
	<28012bc60709240333x2d342c38v7faf9e8fadefc05e@mail.gmail.com>
	<88e286470709240346s6ebe55avbc5620eafe1d8ff9@mail.gmail.com>
	<28012bc60709240352x65756a66w3ebafdd7fde1f16d@mail.gmail.com>
	<88e286470709240421g11d6fde4mcf1cf0a380328e36@mail.gmail.com>
Message-ID: <28012bc60709240451m170469efg74b1b0e7ec5d90fa@mail.gmail.com>

Hi Graham,

On 9/24/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> In the mean time, I'll try and find some time to explain how to do it
> for mod_python properly. Cant promise anything though as starting to
> get backlogged as it is.

I very much appreciate the time you spent on this, thank you. Looking
forward to mod_wsgi 2.0 :)

My main problem remains that depending on the project (identified by
the first part of the url), I might want to skip authentication and
authorization all together since some projects allow anonymous access.
I don't know how to make that decision, whether to request a login
from the user, in python code.

Anyways, I'll experiment with it all. Thanks again :)

Arnar
From graham.dumpleton at gmail.com  Mon Sep 24 07:58:46 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Mon Sep 24 07:59:02 2007
Subject: [mod_python] Apache 2.2 authen/authz and "require" semantics
In-Reply-To: <28012bc60709240451m170469efg74b1b0e7ec5d90fa@mail.gmail.com>
References: <28012bc60709231405g43d82adfq3f0f7e3e7d39bec8@mail.gmail.com>
	<88e286470709231832v276e85degc1b3976c907fe597@mail.gmail.com>
	<28012bc60709240333x2d342c38v7faf9e8fadefc05e@mail.gmail.com>
	<88e286470709240346s6ebe55avbc5620eafe1d8ff9@mail.gmail.com>
	<28012bc60709240352x65756a66w3ebafdd7fde1f16d@mail.gmail.com>
	<88e286470709240421g11d6fde4mcf1cf0a380328e36@mail.gmail.com>
	<28012bc60709240451m170469efg74b1b0e7ec5d90fa@mail.gmail.com>
Message-ID: <88e286470709240458g632cab75o8a17dc523b79558c@mail.gmail.com>

On 24/09/2007, Arnar Birgisson <arnarbi@gmail.com> wrote:
> Hi Graham,
>
> On 9/24/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > In the mean time, I'll try and find some time to explain how to do it
> > for mod_python properly. Cant promise anything though as starting to
> > get backlogged as it is.
>
> I very much appreciate the time you spent on this, thank you. Looking
> forward to mod_wsgi 2.0 :)
>
> My main problem remains that depending on the project (identified by
> the first part of the url), I might want to skip authentication and
> authorization all together since some projects allow anonymous access.
> I don't know how to make that decision, whether to request a login
> from the user, in python code.

Have an authenhandler which identifies the URL you need to let through
and simply do:

  req.user = 'anonymous'
  return apache.OK

Setting req.user should be sufficient to prevent complaints from
Apache and would satisfy 'Require valid-user' check.

Graham
From arnarbi at gmail.com  Mon Sep 24 08:17:08 2007
From: arnarbi at gmail.com (Arnar Birgisson)
Date: Mon Sep 24 08:17:20 2007
Subject: [mod_python] Apache 2.2 authen/authz and "require" semantics
In-Reply-To: <88e286470709240458g632cab75o8a17dc523b79558c@mail.gmail.com>
References: <28012bc60709231405g43d82adfq3f0f7e3e7d39bec8@mail.gmail.com>
	<88e286470709231832v276e85degc1b3976c907fe597@mail.gmail.com>
	<28012bc60709240333x2d342c38v7faf9e8fadefc05e@mail.gmail.com>
	<88e286470709240346s6ebe55avbc5620eafe1d8ff9@mail.gmail.com>
	<28012bc60709240352x65756a66w3ebafdd7fde1f16d@mail.gmail.com>
	<88e286470709240421g11d6fde4mcf1cf0a380328e36@mail.gmail.com>
	<28012bc60709240451m170469efg74b1b0e7ec5d90fa@mail.gmail.com>
	<88e286470709240458g632cab75o8a17dc523b79558c@mail.gmail.com>
Message-ID: <28012bc60709240517l6c7bbb2y78b0a48187b77cc5@mail.gmail.com>

On 9/24/07, Graham Dumpleton <graham.dumpleton@gmail.com> wrote:
> > My main problem remains that depending on the project (identified by
> > the first part of the url), I might want to skip authentication and
> > authorization all together since some projects allow anonymous access.
> > I don't know how to make that decision, whether to request a login
> > from the user, in python code.
>
> Have an authenhandler which identifies the URL you need to let through
> and simply do:
>
>   req.user = 'anonymous'
>   return apache.OK
>
> Setting req.user should be sufficient to prevent complaints from
> Apache and would satisfy 'Require valid-user' check.

Seems to work for svn at least :)

Thank you,
Arnar
From webb.sprague at gmail.com  Mon Sep 24 19:40:08 2007
From: webb.sprague at gmail.com (Webb Sprague)
Date: Mon Sep 24 19:40:24 2007
Subject: [mod_python] Profiling mod_python with callables?
In-Reply-To: <88e286470709232244k63150430o88c1b5055910bdf3@mail.gmail.com>
References: <b11ea23c0709231919s148e0eb8o7fa28340ad0fe916@mail.gmail.com>
	<88e286470709231932y7d69edf7k763cca43816812cb@mail.gmail.com>
	<b11ea23c0709232027p1c4d6ba6keba7cfbf612ca9f6@mail.gmail.com>
	<88e286470709232112v6411aea8uf59002ee24a133f5@mail.gmail.com>
	<b11ea23c0709232120u4d5e19dcme567b60e587d43a5@mail.gmail.com>
	<88e286470709232210u6f7ff95aldd86c5f6442bc9fc@mail.gmail.com>
	<b11ea23c0709232235m6fb7bcc1k7cad547ac2cb7bca@mail.gmail.com>
	<88e286470709232244k63150430o88c1b5055910bdf3@mail.gmail.com>
Message-ID: <b11ea23c0709241640j545ccd56t471220364b6636a@mail.gmail.com>

Here is the final thing that works, with both the unprofiled basic
function and the profiled version.

### List all of the objects within the navigation/Application template
ListObjects = LcPageObjects.LcList(lcdb=lcdb,
                                   navTemplate=LARRYTEMPLATEDIR +
'/Application.tmpl',
                                   objectListTemplate =
LARRYTEMPLATEDIR + '/ObjectList.tmpl',
                                   title='LAR-E Object List')
def ListObjectsProfile(req):
    ## runs above function through profiler.  Don't know what repeated
calls do to the file yet..
    ## need two step return, or get error
    ret = cProfile.runctx('ListObjects(req)', globals(), locals(),
filename='/tmp/ListObjectProf')
    return ret

(Very helpful stuff from Graham snipped...)
From webb.sprague at gmail.com  Thu Sep 27 13:21:07 2007
From: webb.sprague at gmail.com (Webb Sprague)
Date: Thu Sep 27 13:21:21 2007
Subject: [mod_python] memory error
Message-ID: <b11ea23c0709271021q6f64dc9fjed007954cdaabea2@mail.gmail.com>

Could anyone recommend a method for profiling memory usage in a
mod_python application?

My application creates lots and lots of scipy matrices, and then
pickles them, and then stores them in a database.  If I do too many
runs I get a memory error when I try to insert them, but I also get
lots of swapping before that.  I could delete some of these arrays,
but I would like to figure out where the biggest problems are (because
I would prefer to store everything).

I would be happy to analyze a core dump too.
-W
From pfreixes at milnou.net  Fri Sep 28 05:19:33 2007
From: pfreixes at milnou.net (Pau Freixes)
Date: Fri Sep 28 05:14:08 2007
Subject: [mod_python] Concurrence and virtual host interpreter python
Message-ID: <W3S1N5kG.1190971173.8215010.pfreixes@milnou.net>


Hi to all, Im new in a list.

Well, this last days I was work for testing and learn how work with multi
thread and multi interpreter environment in embedding python in C
applications, and of course mod_python it's a excellent place for
understand this.

Ok, with my lectures and test with mod_python code, i have a some
questions, somebody can help me for understand this concepts ?

1. I was try multi concurrence in a virtual host python script with this
easy code

def handler(req):

    # Request Content Type
    req.content_type = "text/plain"

    VALUE2 = 1
    for i in range(1,10):
        req.write("Value is %d\r\n" % VALUE2)
        time.sleep(5)

        # change global variable
        VALUE2 = VALUE2 + 1;


    req.write("Hellow World")
    return apache.OK

And my surprise it's that apache only process the next request when the
previous request has been served. !!

I don't understand this strange behavior, because mod_python it's made
for accept concurrent threads in same interpreter, and i test a similar
situation  in a c code and it's possible do run some threads at same
time in same interpreter.

time.sleep(5) it's a pretty situation for python core for change the
context and release GIL and assign to this to other thread. yes ?


2. And de second question it's in similar situation, when you reuse a
interpreter for all request to same virtual host, with this code :

import time

VALUE = 1

def handler(req):
    global VALUE

    # Request Content Type
    req.content_type = "text/plain"

    for i in range(1,10):
        req.write("Value is %d\r\n" % VALUE)
        time.sleep(5)

        # change global variable
        VALUE = VALUE + 1;


    req.write("Hellow World")
    return apache.OK

VALUE it's a global variable for de index.py, and subsequent request for
the same url (http://...../index.py) show one incremental value for
VALUE. For example, this two request produced this two results

http://...../index.py

Value is 1
Value is 2
Value is 3
Value is 4
Value is 5
Value is 6
Value is 7
Value is 8
Value is 9
Hellow World

http://...../index.py

Value is 10
Value is 11
Value is 12
Value is 13
Value is 14
Value is 15
Value is 16
Value is 17
Value is 18
Hellow World


Ok, this situation it's really and i think its very normal because only
callback to handler it's made with the same interpreter and VALUE is
not re assigned to value 1, may be ?

3. And the most important question, why mod_python not use a separate
interpreters for all request ?

Thks to all and sorry for my large email

From nlv11281 at natlab.research.philips.com  Fri Sep 28 07:00:03 2007
From: nlv11281 at natlab.research.philips.com (Mike Looijmans)
Date: Fri Sep 28 07:00:22 2007
Subject: [mod_python] memory error
In-Reply-To: <b11ea23c0709271021q6f64dc9fjed007954cdaabea2@mail.gmail.com>
References: <b11ea23c0709271021q6f64dc9fjed007954cdaabea2@mail.gmail.com>
Message-ID: <46FCDEB3.5060704@natlab.research.philips.com>

If Python does not release memory immediately, it usually means there's a cyclic reference. Try to 
break the cycle by removing as much references as possible.

e.g.

a = A()
b = B()

a.b = b
b.a = b

Causes a "cycle". The garbage collector will pick these up at some other time.
To release earlier, assign None or delete the reference like:
a.b = None
or even:
del a.b

It usually helps to monitor big objects by putting a "print" statement in their __init__ and __del__ 
method.


Mike Looijmans
Philips Natlab / Topic Automation


Webb Sprague wrote:
> Could anyone recommend a method for profiling memory usage in a
> mod_python application?
> 
> My application creates lots and lots of scipy matrices, and then
> pickles them, and then stores them in a database.  If I do too many
> runs I get a memory error when I try to insert them, but I also get
> lots of swapping before that.  I could delete some of these arrays,
> but I would like to figure out where the biggest problems are (because
> I would prefer to store everything).
> 
> I would be happy to analyze a core dump too.



From webb.sprague at gmail.com  Fri Sep 28 12:00:20 2007
From: webb.sprague at gmail.com (Webb Sprague)
Date: Fri Sep 28 12:04:26 2007
Subject: [mod_python] memory error
In-Reply-To: <46FCDEB3.5060704@natlab.research.philips.com>
References: <b11ea23c0709271021q6f64dc9fjed007954cdaabea2@mail.gmail.com>
	<46FCDEB3.5060704@natlab.research.philips.com>
Message-ID: <b11ea23c0709280900j5c7b8c8bi7adcc48bcce5266e@mail.gmail.com>

Hi Mike

I will give another look, but I don't think there are any cyclic
references - I create 1000's of scipy matrices and try to store them
in a database, so I think it really is memory problems.  It also works
fine with smaller matrices, and memory is freed after the process is
over, so it isn't a leak (I don't think).

Thanks for the advice though.

-W

On 9/28/07, Mike Looijmans <nlv11281@natlab.research.philips.com> wrote:
> If Python does not release memory immediately, it usually means there's a cyclic reference. Try to
> break the cycle by removing as much references as possible.
>
> e.g.
>
> a = A()
> b = B()
>
> a.b = b
> b.a = b
>
> Causes a "cycle". The garbage collector will pick these up at some other time.
> To release earlier, assign None or delete the reference like:
> a.b = None
> or even:
> del a.b
>
> It usually helps to monitor big objects by putting a "print" statement in their __init__ and __del__
> method.
>
>
> Mike Looijmans
> Philips Natlab / Topic Automation
>
>
> Webb Sprague wrote:
> > Could anyone recommend a method for profiling memory usage in a
> > mod_python application?
> >
> > My application creates lots and lots of scipy matrices, and then
> > pickles them, and then stores them in a database.  If I do too many
> > runs I get a memory error when I try to insert them, but I also get
> > lots of swapping before that.  I could delete some of these arrays,
> > but I would like to figure out where the biggest problems are (because
> > I would prefer to store everything).
> >
> > I would be happy to analyze a core dump too.
>
>
>
>
From webb.sprague at gmail.com  Fri Sep 28 12:00:20 2007
From: webb.sprague at gmail.com (Webb Sprague)
Date: Fri Sep 28 12:10:43 2007
Subject: [mod_python] memory error
In-Reply-To: <46FCDEB3.5060704@natlab.research.philips.com>
References: <b11ea23c0709271021q6f64dc9fjed007954cdaabea2@mail.gmail.com>
	<46FCDEB3.5060704@natlab.research.philips.com>
Message-ID: <b11ea23c0709280900j5c7b8c8bi7adcc48bcce5266e@mail.gmail.com>

Hi Mike

I will give another look, but I don't think there are any cyclic
references - I create 1000's of scipy matrices and try to store them
in a database, so I think it really is memory problems.  It also works
fine with smaller matrices, and memory is freed after the process is
over, so it isn't a leak (I don't think).

Thanks for the advice though.

-W

On 9/28/07, Mike Looijmans <nlv11281@natlab.research.philips.com> wrote:
> If Python does not release memory immediately, it usually means there's a cyclic reference. Try to
> break the cycle by removing as much references as possible.
>
> e.g.
>
> a = A()
> b = B()
>
> a.b = b
> b.a = b
>
> Causes a "cycle". The garbage collector will pick these up at some other time.
> To release earlier, assign None or delete the reference like:
> a.b = None
> or even:
> del a.b
>
> It usually helps to monitor big objects by putting a "print" statement in their __init__ and __del__
> method.
>
>
> Mike Looijmans
> Philips Natlab / Topic Automation
>
>
> Webb Sprague wrote:
> > Could anyone recommend a method for profiling memory usage in a
> > mod_python application?
> >
> > My application creates lots and lots of scipy matrices, and then
> > pickles them, and then stores them in a database.  If I do too many
> > runs I get a memory error when I try to insert them, but I also get
> > lots of swapping before that.  I could delete some of these arrays,
> > but I would like to figure out where the biggest problems are (because
> > I would prefer to store everything).
> >
> > I would be happy to analyze a core dump too.
>
>
>
>
From nicholas at nichol.as  Fri Sep 28 14:50:27 2007
From: nicholas at nichol.as (=?ISO-8859-1?Q?Nicholas_Pi=EBl?=)
Date: Fri Sep 28 14:50:54 2007
Subject: [mod_python] PSP returning empty result
Message-ID: <2C9A75FD-92E5-4EBE-AE9E-E77FEEB46831@nichol.as>

Mod_Python: 3.3.1 (also tried 3.2.0)
Debian EDGE (stable and up2date)
Apache 2.2.3 (32bit, Prefork)
Python 2.5

Hi,

When trying to run some old code  which worked ok on mod_python 3.1  
on a different server i bumped into a problem that got me stumped.

On this new server i am unable to render any PSP templates from  
within the Apache environment, however trying to parse the template  
from the prompt works fine (_psp.parse(filename)).

My configuration is as below, I tried different mod_python versions  
but they all behave the same way. When i open "...bla.py/weird" in a  
browser it does indeed return 'weird!' so the error really seems to  
be in the rendering of the template. I checked my error logs and it  
does not contain any error message. The result of both handlers/ 
controllers (index, test) is just an empty page. In the test handler  
i can only see a single 0. Presumably coming from 'return apache.OK'.

When i change the Python handler to mod_python.publisher and directly  
open the .psp file it also returns an empty page. When i append the  
underscore all that it returns is: " PSP-produced Python Code:  /var/ 
www/web1/web/test/bla.psp: "


Does anyone have suggestions to tackle this problem?

Cheers,
Nicholas


----8<------   My .htaccess

SetHandler mod_python
PythonHandler mod_python.publisher
PythonDebug On



----8<------ My bla.py

from mod_python import apache, psp

def index(req):
         tmpl = psp.PSP(req, filename='/var/www/web1/web/test/bla.psp')
         tmpl.run()

def weird(req):
         req.write("weird!")

def test(req):
         req.write(str(psp.parse("/var/www/web1/web/dalgarno/bla.psp")))
         return apache.OK


----8<------ My bla.psp

<html>
<body>
      <h1> bla test</h1>

      bla test

      </body>
</html>



From nicholas at nichol.as  Sat Sep 29 12:45:05 2007
From: nicholas at nichol.as (=?ISO-8859-1?Q?Nicholas_Pi=EBl?=)
Date: Sat Sep 29 12:46:44 2007
Subject: [mod_python] PSP returning empty result
In-Reply-To: <2C9A75FD-92E5-4EBE-AE9E-E77FEEB46831@nichol.as>
References: <2C9A75FD-92E5-4EBE-AE9E-E77FEEB46831@nichol.as>
Message-ID: <EE4C3247-25EE-4009-B9D5-04358707540E@nichol.as>


On Sep 28, 2007, at 8:50 PM, Nicholas Pi?l wrote:

> Mod_Python: 3.3.1 (also tried 3.2.0)
> Debian EDGE (stable and up2date)
> Apache 2.2.3 (32bit, Prefork)
> Python 2.5
>
> Hi,
>
> When trying to run some old code  which worked ok on mod_python 3.1  
> on a different server i bumped into a problem that got me stumped.
>
> On this new server i am unable to render any PSP templates from  
> within the Apache environment, however trying to parse the template  
> from the prompt works fine (_psp.parse(filename)).

*argh*

The problem seems to be fixed when i disable PHP5. Is there anything  
else i can do to fix this besides disabling PHP5?

Cheers,
Nicholas



From jpg at jgassociates.ca  Sat Sep 29 13:20:11 2007
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Sat Sep 29 13:17:58 2007
Subject: [mod_python] PSP returning empty result
In-Reply-To: <EE4C3247-25EE-4009-B9D5-04358707540E@nichol.as>
References: <2C9A75FD-92E5-4EBE-AE9E-E77FEEB46831@nichol.as>
	<EE4C3247-25EE-4009-B9D5-04358707540E@nichol.as>
Message-ID: <46FE894B.5010105@jgassociates.ca>

Nicholas Pi?l wrote:
> 
> On Sep 28, 2007, at 8:50 PM, Nicholas Pi?l wrote:
> 
>> Mod_Python: 3.3.1 (also tried 3.2.0)
>> Debian EDGE (stable and up2date)
>> Apache 2.2.3 (32bit, Prefork)
>> Python 2.5
>>
>> Hi,
>>
>> When trying to run some old code  which worked ok on mod_python 3.1 on 
>> a different server i bumped into a problem that got me stumped.
>>
>> On this new server i am unable to render any PSP templates from within 
>> the Apache environment, however trying to parse the template from the 
>> prompt works fine (_psp.parse(filename)).
> 
> *argh*
> 
> The problem seems to be fixed when i disable PHP5. Is there anything 
> else i can do to fix this besides disabling PHP5?

Is there any indication in the apache error log that apache process is 
seg faulting? These sorts of problems can are often traced back to 
mismatches in library versions used by php, apache and python. The most 
common culprits are mysql and expat, but there are certainly others.

On the other hand I don't recall any specific instance where we've seen 
  library conflicts with psp.

Jim
From jpg at jgassociates.ca  Sat Sep 29 15:25:27 2007
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Sat Sep 29 15:22:13 2007
Subject: [mod_python] Concurrence and virtual host interpreter python
In-Reply-To: <W3S1N5kG.1190971173.8215010.pfreixes@milnou.net>
References: <W3S1N5kG.1190971173.8215010.pfreixes@milnou.net>
Message-ID: <46FEA6A7.4030800@jgassociates.ca>

Pau Freixes wrote:
> Hi to all, Im new in a list.
> 
> Well, this last days I was work for testing and learn how work with multi
> thread and multi interpreter environment in embedding python in C
> applications, and of course mod_python it's a excellent place for
> understand this.

You'll need to throw multi-process into the mix of things to understand.
  I'm not actually sure if mod_python *is* an excellent environment for
your learning endeavours as there are a number of complicating factors 
introduced by apache and your browser.

The behaviour that you'll see will depend on which apache mpm you are
using: prefork, worker or winnt. If you haven't already done so you
should take a look at http://httpd.apache.org/docs/2.0/mpm.html

In order to effectively answer your questions you'll need to let us know
  us know which mpm you are using. Also, what are you using as your
client?

> Ok, with my lectures and test with mod_python code, i have a some
> questions, somebody can help me for understand this concepts ?
> 
> 1. I was try multi concurrence in a virtual host python script with this
> easy code
> 
> def handler(req):
> 
>     # Request Content Type
>     req.content_type = "text/plain"
> 
>     VALUE2 = 1
>     for i in range(1,10):
>         req.write("Value is %d\r\n" % VALUE2)
>         time.sleep(5)
> 
>         # change global variable
>         VALUE2 = VALUE2 + 1;
> 
> 
>     req.write("Hellow World")
>     return apache.OK
> 
> And my surprise it's that apache only process the next request when the
> previous request has been served. !!
> I don't understand this strange behavior, because mod_python it's made
> for accept concurrent threads in same interpreter, and i test a similar
> situation  in a c code and it's possible do run some threads at same
> time in same interpreter.
> 
> time.sleep(5) it's a pretty situation for python core for change the
> context and release GIL and assign to this to other thread. yes ?

Are you sure you're not seeing an artifact of the browser keeping the 
connection open? If this is the case then your request is being 
serialized by apache and the GIL doesn't enter into it.

You could play with your apache config (KeepAlive off and so on), but 
it's likely easier to use a different test client such as wget. Also, 
modify your req.write() calls to immediately flush the data, which will 
make it easier to see what's going on. eg. req.write("something",1)

Open multiple terminals and run the following in each simultaneously (or 
as near as you can make it).

wget -S -O - http://..../index.py

I think you'll see that mod_python is behaving exactly as you'd expect.

> 
> 2. And de second question it's in similar situation, when you reuse a
> interpreter for all request to same virtual host, with this code :
> 
> import time
> 
> VALUE = 1
> 
> def handler(req):
>     global VALUE
> 
>     # Request Content Type
>     req.content_type = "text/plain"
> 
>     for i in range(1,10):
>         req.write("Value is %d\r\n" % VALUE)
>         time.sleep(5)
> 
>         # change global variable
>         VALUE = VALUE + 1;
> 
> 
>     req.write("Hellow World")
>     return apache.OK
> 
> VALUE it's a global variable for de index.py, and subsequent request for
> the same url (http://...../index.py) show one incremental value for
> VALUE. For example, this two request produced this two results
> 
> http://...../index.py
> 
> Value is 1
> Value is 2
> Value is 3
> Value is 4
> Value is 5
> Value is 6
> Value is 7
> Value is 8
> Value is 9
> Hellow World
> 
> http://...../index.py
> 
> Value is 10
> Value is 11
> Value is 12
> Value is 13
> Value is 14
> Value is 15
> Value is 16
> Value is 17
> Value is 18
> Hellow World
> 
> 
> Ok, this situation it's really and i think its very normal because only
> callback to handler it's made with the same interpreter and VALUE is
> not re assigned to value 1, may be ?

The statement "VALUE = 1" is only evaluated when the module (index.py)
is first loaded. It is not re-evaluated for each request. Note however
that VALUE should *not* be considered a global variable. Depending on
which apache mpm is being used you could have multiple, independent
copies of VALUE. Using the mpm-prefork and the default MaxClients value
of 256, you could potentially have 256 copies of VALUE if your server is
under a heavy load. A similar situation exists with mpm-worker where you
could still have a number of independent multi-threaded child processes.

> 3. And the most important question, why mod_python not use a separate
> interpreters for all request ?

I'm not 100% sure what you are asking. Do you mean a separate
interpreter for each request? If so then the resource usage would be
unacceptably high. The default is to have a separate subinterpreter for
each virtual host.

Jim


From jpg at jgassociates.ca  Sat Sep 29 15:33:53 2007
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Sat Sep 29 15:30:33 2007
Subject: [mod_python] Concurrence and virtual host interpreter python
In-Reply-To: <46FEA6A7.4030800@jgassociates.ca>
References: <W3S1N5kG.1190971173.8215010.pfreixes@milnou.net>
	<46FEA6A7.4030800@jgassociates.ca>
Message-ID: <46FEA8A1.10407@jgassociates.ca>

I had a bit of a brain spasm in my previous response. req.write() 
flushes the buffer by default.


Jim Gallacher wrote:
> Pau Freixes wrote:
>> Hi to all, Im new in a list.
 >>
> You could play with your apache config (KeepAlive off and so on), but 
> it's likely easier to use a different test client such as wget. Also, 
> modify your req.write() calls to immediately flush the data, which will 
> make it easier to see what's going on. eg. req.write("something",1)

Jim
From graham.dumpleton at gmail.com  Sat Sep 29 17:57:00 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sat Sep 29 17:57:15 2007
Subject: [mod_python] memory error
In-Reply-To: <b11ea23c0709280900j5c7b8c8bi7adcc48bcce5266e@mail.gmail.com>
References: <b11ea23c0709271021q6f64dc9fjed007954cdaabea2@mail.gmail.com>
	<46FCDEB3.5060704@natlab.research.philips.com>
	<b11ea23c0709280900j5c7b8c8bi7adcc48bcce5266e@mail.gmail.com>
Message-ID: <88e286470709291457l5bce5f63pb2cc25429f9e3c84@mail.gmail.com>

Have you tried extracting your core functional code out of mod_python
and doing a test from command line Python of the same thing to see if
it still occurs there?

Graham

On 29/09/2007, Webb Sprague <webb.sprague@gmail.com> wrote:
> Hi Mike
>
> I will give another look, but I don't think there are any cyclic
> references - I create 1000's of scipy matrices and try to store them
> in a database, so I think it really is memory problems.  It also works
> fine with smaller matrices, and memory is freed after the process is
> over, so it isn't a leak (I don't think).
>
> Thanks for the advice though.
>
> -W
>
> On 9/28/07, Mike Looijmans <nlv11281@natlab.research.philips.com> wrote:
> > If Python does not release memory immediately, it usually means there's a cyclic reference. Try to
> > break the cycle by removing as much references as possible.
> >
> > e.g.
> >
> > a = A()
> > b = B()
> >
> > a.b = b
> > b.a = b
> >
> > Causes a "cycle". The garbage collector will pick these up at some other time.
> > To release earlier, assign None or delete the reference like:
> > a.b = None
> > or even:
> > del a.b
> >
> > It usually helps to monitor big objects by putting a "print" statement in their __init__ and __del__
> > method.
> >
> >
> > Mike Looijmans
> > Philips Natlab / Topic Automation
> >
> >
> > Webb Sprague wrote:
> > > Could anyone recommend a method for profiling memory usage in a
> > > mod_python application?
> > >
> > > My application creates lots and lots of scipy matrices, and then
> > > pickles them, and then stores them in a database.  If I do too many
> > > runs I get a memory error when I try to insert them, but I also get
> > > lots of swapping before that.  I could delete some of these arrays,
> > > but I would like to figure out where the biggest problems are (because
> > > I would prefer to store everything).
> > >
> > > I would be happy to analyze a core dump too.
> >
> >
> >
> >
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From graham.dumpleton at gmail.com  Sat Sep 29 18:15:36 2007
From: graham.dumpleton at gmail.com (Graham Dumpleton)
Date: Sat Sep 29 18:15:54 2007
Subject: [mod_python] Concurrence and virtual host interpreter python
In-Reply-To: <W3S1N5kG.1190971173.8215010.pfreixes@milnou.net>
References: <W3S1N5kG.1190971173.8215010.pfreixes@milnou.net>
Message-ID: <88e286470709291515u3e0bf0c7w34ba6a28ab9697b0@mail.gmail.com>

On top of what Jim already said ...

On 28/09/2007, Pau Freixes <pfreixes@milnou.net> wrote:
>
> Hi to all, Im new in a list.
>
> Well, this last days I was work for testing and learn how work with multi
> thread and multi interpreter environment in embedding python in C
> applications, and of course mod_python it's a excellent place for
> understand this.

Huh, are you only looking at how things are done at the Python level,
or are you trying to understand how the C code is implemented
underneath?

If you are also interested in the C code level of how it is
implemented, I would recommend looking at mod_wsgi
(http://www.modwsgi.org) instead as its C code is probably easier to
follow and does certain things correctly where as mod_python currently
gets it wrong causing some limitations in what C extension modules can
be used with it.

> Ok, with my lectures and test with mod_python code, i have a some
> questions, somebody can help me for understand this concepts ?
>
> 1. I was try multi concurrence in a virtual host python script with this
> easy code
>
> def handler(req):
>
>     # Request Content Type
>     req.content_type = "text/plain"
>
>     VALUE2 = 1
>     for i in range(1,10):
>         req.write("Value is %d\r\n" % VALUE2)
>         time.sleep(5)
>
>         # change global variable
>         VALUE2 = VALUE2 + 1;
>
>
>     req.write("Hellow World")
>     return apache.OK
>
> And my surprise it's that apache only process the next request when the
> previous request has been served. !!
>
> I don't understand this strange behavior, because mod_python it's made
> for accept concurrent threads in same interpreter, and i test a similar
> situation  in a c code and it's possible do run some threads at same
> time in same interpreter.
>
> time.sleep(5) it's a pretty situation for python core for change the
> context and release GIL and assign to this to other thread. yes ?

This almost suggest you are running prefork MPM with a single process,
or are running prefork MPM in foreground (debugging) mode. In those
cases everything would be serialised.

Suggest you read:

  http://code.google.com/p/modwsgi/wiki/ProcessesAndThreading

This talks about the various Apache MPM modes and what each implies
with respect to use of multiples processes and multithreading.

> 2. And de second question it's in similar situation, when you reuse a
> interpreter for all request to same virtual host, with this code :
>
> import time
>
> VALUE = 1
>
> def handler(req):
>     global VALUE
>
>     # Request Content Type
>     req.content_type = "text/plain"
>
>     for i in range(1,10):
>         req.write("Value is %d\r\n" % VALUE)
>         time.sleep(5)
>
>         # change global variable
>         VALUE = VALUE + 1;
>
>
>     req.write("Hellow World")
>     return apache.OK
>
> VALUE it's a global variable for de index.py, and subsequent request for
> the same url (http://...../index.py) show one incremental value for
> VALUE. For example, this two request produced this two results
>
> http://...../index.py
>
> Value is 1
> Value is 2
> Value is 3
> Value is 4
> Value is 5
> Value is 6
> Value is 7
> Value is 8
> Value is 9
> Hellow World
>
> http://...../index.py
>
> Value is 10
> Value is 11
> Value is 12
> Value is 13
> Value is 14
> Value is 15
> Value is 16
> Value is 17
> Value is 18
> Hellow World
>
> Ok, this situation it's really and i think its very normal because only
> callback to handler it's made with the same interpreter and VALUE is
> not re assigned to value 1, may be ?

Read the document I reference above as it talks about data sharing
issues with the various Apache MPMs.

> 3. And the most important question, why mod_python not use a separate
> interpreters for all request ?

Because creating a new Python interpreter instance for each request
would result in CGI like speeds. Also, creating a new Python
interpreter for each request implies having to destroy the Python
interpreter instance as well. Various C extension modules for Python
are not written properly so as to cope with the destruction of Python
sub interpreters within a process and the module then be loaded again
into a new sub interpreter instance in the same process. The result
typically being that the process will crash. See:

  http://code.google.com/p/modwsgi/issues/detail?id=12&can=1

Graham
From chaim at chaimsanders.com  Sun Sep 30 00:47:22 2007
From: chaim at chaimsanders.com (Chaim Sanders)
Date: Sun Sep 30 00:47:45 2007
Subject: [mod_python] Source Code Woes
Message-ID: <b0d8ae250709292147y7fc12f30tc37ff752fb589172@mail.gmail.com>

Skipped content of type multipart/alternative-------------- next part --------------
#
# This is the main Apache HTTP server configuration file.  It contains the
# configuration directives that give the server its instructions.
# See <URL:http://httpd.apache.org/docs/2.2/> for detailed information.
# In particular, see 
# <URL:http://httpd.apache.org/docs/2.2/mod/directives.html>
# for a discussion of each configuration directive.
#
# Do NOT simply read the instructions in here without understanding
# what they do.  They're here only as hints or reminders.  If you are unsure
# consult the online docs. You have been warned.  
#
# Configuration and logfile names: If the filenames you specify for many
# of the server's control files begin with "/" (or "drive:/" for Win32), the
# server will use that explicit path.  If the filenames do *not* begin
# with "/", the value of ServerRoot is prepended -- so "logs/foo.log"
# with ServerRoot set to "C:/Apache2.2" will be interpreted by the
# server as "C:/Apache2.2/logs/foo.log".
#
# NOTE: Where filenames are specified, you must use forward slashes
# instead of backslashes (e.g., "c:/apache" instead of "c:\apache").
# If a drive letter is omitted, the drive on which Apache.exe is located
# will be used by default.  It is recommended that you always supply
# an explicit drive letter in absolute paths, however, to avoid
# confusion.
#

# ThreadsPerChild: constant number of worker threads in the server process
# MaxRequestsPerChild: maximum  number of requests a server process serves
ThreadsPerChild 250
MaxRequestsPerChild  0

#
# ServerRoot: The top of the directory tree under which the server's
# configuration, error, and log files are kept.
#
# Do not add a slash at the end of the directory path.  If you point
# ServerRoot at a non-local disk, be sure to point the LockFile directive
# at a local disk.  If you wish to share the same ServerRoot for multiple
# httpd daemons, you will need to change at least LockFile and PidFile.
#
ServerRoot "C:/Apache2.2"

#
# Listen: Allows you to bind Apache to specific IP addresses and/or
# ports, instead of the default. See also the <VirtualHost>
# directive.
#
# Change this to Listen on specific IP addresses as shown below to 
# prevent Apache from glomming onto all bound IP addresses (0.0.0.0)
#
#Listen 12.34.56.78:80
Listen 80

#
# Dynamic Shared Object (DSO) Support
#
# To be able to use the functionality of a module which was built as a DSO you
# have to place corresponding `LoadModule' lines at this location so the
# directives contained in it are actually available _before_ they are used.
# Statically compiled modules (those listed by `httpd -l') do not need
# to be loaded here.
#
# Example:
# LoadModule foo_module modules/mod_foo.so
#
LoadModule actions_module modules/mod_actions.so
LoadModule alias_module modules/mod_alias.so
LoadModule asis_module modules/mod_asis.so
LoadModule auth_basic_module modules/mod_auth_basic.so
#LoadModule auth_digest_module modules/mod_auth_digest.so
#LoadModule authn_anon_module modules/mod_authn_anon.so
#LoadModule authn_dbm_module modules/mod_authn_dbm.so
LoadModule authn_default_module modules/mod_authn_default.so
LoadModule authn_file_module modules/mod_authn_file.so
#LoadModule authz_dbm_module modules/mod_authz_dbm.so
LoadModule authz_default_module modules/mod_authz_default.so
LoadModule authz_groupfile_module modules/mod_authz_groupfile.so
LoadModule authz_host_module modules/mod_authz_host.so
LoadModule authz_user_module modules/mod_authz_user.so
LoadModule autoindex_module modules/mod_autoindex.so
#LoadModule cern_meta_module modules/mod_cern_meta.so
LoadModule cgi_module modules/mod_cgi.so
#LoadModule dav_module modules/mod_dav.so
#LoadModule dav_fs_module modules/mod_dav_fs.so
#LoadModule deflate_module modules/mod_deflate.so
LoadModule dir_module modules/mod_dir.so
LoadModule env_module modules/mod_env.so
#LoadModule expires_module modules/mod_expires.so
#LoadModule file_cache_module modules/mod_file_cache.so
#LoadModule headers_module modules/mod_headers.so
LoadModule imagemap_module modules/mod_imagemap.so
LoadModule include_module modules/mod_include.so
#LoadModule info_module modules/mod_info.so
LoadModule isapi_module modules/mod_isapi.so
LoadModule log_config_module modules/mod_log_config.so
LoadModule mime_module modules/mod_mime.so
LoadModule mime_magic_module modules/mod_mime_magic.so
#LoadModule proxy_module modules/mod_proxy.so
#LoadModule proxy_ajp_module modules/mod_proxy_ajp.so
#LoadModule proxy_balancer_module modules/mod_proxy_balancer.so
#LoadModule proxy_connect_module modules/mod_proxy_connect.so
#LoadModule proxy_http_module modules/mod_proxy_http.so
#LoadModule proxy_ftp_module modules/mod_proxy_ftp.so
LoadModule negotiation_module modules/mod_negotiation.so
#LoadModule rewrite_module modules/mod_rewrite.so
LoadModule setenvif_module modules/mod_setenvif.so
#LoadModule speling_module modules/mod_speling.so
#LoadModule status_module modules/mod_status.so
#LoadModule unique_id_module modules/mod_unique_id.so
LoadModule userdir_module modules/mod_userdir.so
#LoadModule usertrack_module modules/mod_usertrack.so
#LoadModule vhost_alias_module modules/mod_vhost_alias.so
#LoadModule ssl_module modules/mod_ssl.so

LoadModule python_module modules/mod_python.so

<Directory "C:/Apache2.2/htdocs/test/"> 
  SetHandler mod_python
  AddHandler python-program .py 
  PythonHandler mptest 
  PythonDebug On 
</Directory> 
<Directory "C:/Apache2.2/htdocs/test2/"> 
	Options FollowSymLinks 
	AllowOverride All 
	Order deny,allow 
	Satisfy all 
	AddHandler mod_python .py 
	PythonHandler mptest 
	PythonDebug On 
</Directory>
<Directory "C:/Apache2.2/cgi-bin/"> 
  AddHandler python-program .py 
  PythonHandler mptest 
  PythonDebug On 
</Directory> 

# 'Main' server configuration
#
# The directives in this section set up the values used by the 'main'
# server, which responds to any requests that aren't handled by a
# <VirtualHost> definition.  These values also provide defaults for
# any <VirtualHost> containers you may define later in the file.
#
# All of these directives may appear inside <VirtualHost> containers,
# in which case these default settings will be overridden for the
# virtual host being defined.
#

#
# ServerAdmin: Your address, where problems with the server should be
# e-mailed.  This address appears on some server-generated pages, such
# as error documents.  e.g. admin@your-domain.com
#
ServerAdmin admin@rh.rit.edu

#
# ServerName gives the name and port that the server uses to identify itself.
# This can often be determined automatically, but we recommend you specify
# it explicitly to prevent problems during startup.
#
# If your host doesn't have a registered DNS name, enter its IP address here.
#
ServerName Python.rh.rit.edu:80

#
# DocumentRoot: The directory out of which you will serve your
# documents. By default, all requests are taken from this directory, but
# symbolic links and aliases may be used to point to other locations.
#
DocumentRoot "C:/Apache2.2/htdocs"

#
# Each directory to which Apache has access can be configured with respect
# to which services and features are allowed and/or disabled in that
# directory (and its subdirectories). 
#
# First, we configure the "default" to be a very restrictive set of 
# features.  
#
<Directory />
  AddHandler python-program .py 
  PythonHandler mptest 
  PythonDebug On 
    Options FollowSymLinks
    AllowOverride None
    Order deny,allow
    Deny from all
    Satisfy all
</Directory>

#
# Note that from this point forwardhave specifically enabled it
# below. you must specifically allow
# particular features to be enabled - so if something's not working as
# you might expect, make sure that you 
#

#
# This should be changed to whatever you set DocumentRoot to.
#
<Directory "C:/Apache2.2/htdocs">
    #
    # Possible values for the Options directive are "None", "All",
    # or any combination of:
    #   Indexes Includes FollowSymLinks SymLinksifOwnerMatch ExecCGI MultiViews
    #
    # Note that "MultiViews" must be named *explicitly* --- "Options All"
    # doesn't give it to you.
    #
    # The Options directive is both complicated and important.  Please see
    # http://httpd.apache.org/docs/2.2/mod/core.html#options
    # for more information.
    #
  AddHandler python-program .py 
  PythonHandler mptest 
  PythonDebug On 
    Options Indexes FollowSymLinks ExecCGI

    #
    # AllowOverride controls what directives may be placed in .htaccess files.
    # It can be "All", "None", or any combination of the keywords:
    #   Options FileInfo AuthConfig Limit
    #
    AllowOverride None

    #
    # Controls who can get stuff from this server.
    #
    Order allow,deny
    Allow from all

</Directory>

#
# DirectoryIndex: sets the file that Apache will serve if a directory
# is requested.
#
<IfModule dir_module>
    DirectoryIndex index.html
</IfModule>

#
# The following lines prevent .htaccess and .htpasswd files from being 
# viewed by Web clients. 
#
<FilesMatch "^\.ht">
    Order allow,deny
    Deny from all
</FilesMatch>

#
# ErrorLog: The location of the error log file.
# If you do not specify an ErrorLog directive within a <VirtualHost>
# container, error messages relating to that virtual host will be
# logged here.  If you *do* define an error logfile for a <VirtualHost>
# container, that host's errors will be logged there and not here.
#
ErrorLog logs/error.log

#
# LogLevel: Control the number of messages logged to the error_log.
# Possible values include: debug, info, notice, warn, error, crit,
# alert, emerg.
#
LogLevel warn

<IfModule log_config_module>
    #
    # The following directives define some format nicknames for use with
    # a CustomLog directive (see below).
    #
    LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\"" combined
    LogFormat "%h %l %u %t \"%r\" %>s %b" common

    <IfModule logio_module>
      # You need to enable mod_logio.c to use %I and %O
      LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\" %I %O" combinedio
    </IfModule>

    #
    # The location and format of the access logfile (Common Logfile Format).
    # If you do not define any access logfiles within a <VirtualHost>
    # container, they will be logged here.  Contrariwise, if you *do*
    # define per-<VirtualHost> access logfiles, transactions will be
    # logged therein and *not* in this file.
    #
    CustomLog logs/access.log common

    #
    # If you prefer a logfile with access, agent, and referer information
    # (Combined Logfile Format) you can use the following directive.
    #
    #CustomLog logs/access.log combined
</IfModule>

<IfModule alias_module>
    #
    # Redirect: Allows you to tell clients about documents that used to 
    # exist in your server's namespace, but do not anymore. The client 
    # will make a new request for the document at its new location.
    # Example:
    # Redirect permanent /foo http://Python.rh.rit.edu/bar

    #
    # Alias: Maps web paths into filesystem paths and is used to
    # access content that does not live under the DocumentRoot.
    # Example:
    # Alias /webpath /full/filesystem/path
    #
    # If you include a trailing / on /webpath then the server will
    # require it to be present in the URL.  You will also likely
    # need to provide a <Directory> section to allow access to
    # the filesystem path.

    #
    # ScriptAlias: This controls which directories contain server scripts. 
    # ScriptAliases are essentially the same as Aliases, except that
    # documents in the target directory are treated as applications and
    # run by the server when requested rather than as documents sent to the
    # client.  The same rules about trailing "/" apply to ScriptAlias
    # directives as to Alias.
    #
    ScriptAlias /cgi-bin/ "C:/Apache2.2/cgi-bin/"

</IfModule>

#
# "C:/Apache2.2/cgi-bin" should be changed to whatever your ScriptAliased
# CGI directory exists, if you have that configured.
#
<Directory "C:/Apache2.2/cgi-bin">
    AllowOverride None
    Options None
    Order deny,allow
    deny from all
</Directory>

# 
# Apache parses all CGI scripts for the shebang line by default.
# This comment line, the first line of the script, consists of the symbols
# pound (#) and exclamation (!) followed by the path of the program that 
# can execute this specific script.  For a perl script, with perl.exe in
# the C:\Program Files\Perl directory, the shebang line should be:

   #!c:/program files/perl/perl

# Note you _must_not_ indent the actual shebang line, and it must be the
# first line of the file.  Of course, CGI processing must be enabled by 
# the appropriate ScriptAlias or Options ExecCGI directives for the files 
# or directory in question.
#
# However, Apache on Windows allows either the Unix behavior above, or can
# use the Registry to match files by extention.  The command to execute 
# a file of this type is retrieved from the registry by the same method as 
# the Windows Explorer would use to handle double-clicking on a file.
# These script actions can be configured from the Windows Explorer View menu, 
# 'Folder Options', and reviewing the 'File Types' tab.  Clicking the Edit
# button allows you to modify the Actions, of which Apache 1.3 attempts to
# perform the 'Open' Action, and failing that it will try the shebang line.
# This behavior is subject to change in Apache release 2.0.
#
# Each mechanism has it's own specific security weaknesses, from the means
# to run a program you didn't intend the website owner to invoke, and the
# best method is a matter of great debate.
#
# To enable the this Windows specific behavior (and therefore -disable- the
# equivilant Unix behavior), uncomment the following directive:
#
#ScriptInterpreterSource registry
#
# The directive above can be placed in individual <Directory> blocks or the
# .htaccess file, with either the 'registry' (Windows behavior) or 'script' 
# (Unix behavior) option, and will override this server default option.
#

#
# DefaultType: the default MIME type the server will use for a document
# if it cannot otherwise determine one, such as from filename extensions.
# If your server contains mostly text or HTML documents, "text/plain" is
# a good value.  If most of your content is binary, such as applications
# or images, you may want to use "application/octet-stream" instead to
# keep browsers from trying to display binary files as though they are
# text.
#
DefaultType text/plain

<IfModule mime_module>
    #
    # TypesConfig points to the file containing the list of mappings from
    # filename extension to MIME-type.
    #
    TypesConfig conf/mime.types

    #
    # AddType allows you to add to or override the MIME configuration
    # file specified in TypesConfig for specific file types.
    #
    #AddType application/x-gzip .tgz
    #
    # AddEncoding allows you to have certain browsers uncompress
    # information on the fly. Note: Not all browsers support this.
    #
    #AddEncoding x-compress .Z
    #AddEncoding x-gzip .gz .tgz
    #
    # If the AddEncoding directives above are commented-out, then you
    # probably should define those extensions to indicate media types:
    #
    AddType application/x-compress .Z
    AddType application/x-gzip .gz .tgz

    #
    # AddHandler allows you to map certain file extensions to "handlers":
    # actions unrelated to filetype. These can be either built into the server
    # or added with the Action directive (see below)
    #
    # To use CGI scripts outside of ScriptAliased directories:
    # (You will also need to add "ExecCGI" to the "Options" directive.)
    #
    AddHandler cgi-script .cgi

    # For type maps (negotiated resources):
    AddHandler type-map var

    #
    # Filters allow you to process content before it is sent to the client.
    #
    # To parse .shtml files for server-side includes (SSI):
    # (You will also need to add "Includes" to the "Options" directive.)
    #
    #AddType text/html .shtml
    #AddOutputFilter INCLUDES .shtml
</IfModule>

#
# The mod_mime_magic module allows the server to use various hints from the
# contents of the file itself to determine its type.  The MIMEMagicFile
# directive tells the module where the hint definitions are located.
#
#MIMEMagicFile conf/magic

#
# Customizable error responses come in three flavors:
# 1) plain text 2) local redirects 3) external redirects
#
# Some examples:
#ErrorDocument 500 "The server made a boo boo."
#ErrorDocument 404 /missing.html
#ErrorDocument 404 "/cgi-bin/missing_handler.pl"
#ErrorDocument 402 http://Python.rh.rit.edu/subscription_info.html
#

#
# EnableMMAP and EnableSendfile: On systems that support it, 
# memory-mapping or the sendfile syscall is used to deliver
# files.  This usually improves server performance, but must
# be turned off when serving from networked-mounted 
# filesystems or if support for these functions is otherwise
# broken on your system.
#
#EnableMMAP off
#EnableSendfile off

# Supplemental configuration
#
# The configuration files in the conf/extra/ directory can be 
# included to add extra features or to modify the default configuration of 
# the server, or you may simply copy their contents here and change as 
# necessary.

# Server-pool management (MPM specific)
#Include conf/extra/httpd-mpm.conf

# Multi-language error messages
#Include conf/extra/httpd-multilang-errordoc.conf

# Fancy directory listings
#Include conf/extra/httpd-autoindex.conf

# Language settings
#Include conf/extra/httpd-languages.conf

# User home directories
#Include conf/extra/httpd-userdir.conf

# Real-time info on requests and configuration
#Include conf/extra/httpd-info.conf

# Virtual hosts
#Include conf/extra/httpd-vhosts.conf

# Local access to the Apache HTTP Server Manual
#Include conf/extra/httpd-manual.conf

# Distributed authoring and versioning (WebDAV)
#Include conf/extra/httpd-dav.conf

# Various default settings
#Include conf/extra/httpd-default.conf

# Secure (SSL/TLS) connections
#Include conf/extra/httpd-ssl.conf
#
# Note: The following must must be present to support
#       starting without SSL on platforms with no /dev/random equivalent
#       but a statically compiled-in mod_ssl.
#
<IfModule ssl_module>
SSLRandomSeed startup builtin
SSLRandomSeed connect builtin
</IfModule>
From nicholas at nichol.as  Sat Sep 29 19:22:05 2007
From: nicholas at nichol.as (=?ISO-8859-1?Q?Nicholas_Pi=EBl?=)
Date: Sun Sep 30 08:52:38 2007
Subject: [mod_python] PSP returning empty result
Message-ID: <13F7CA06-C1E6-454D-9FC4-EAAD36EDC92A@nichol.as>


On Sep 29, 2007, at 7:20 PM, Jim Gallacher wrote:
>
> Is there any indication in the apache error log that apache process  
> is seg faulting? These sorts of problems can are often traced back  
> to mismatches in library versions used by php, apache and python.  
> The most common culprits are mysql and expat, but there are  
> certainly others.
>
> On the other hand I don't recall any specific instance where we've  
> seen  library conflicts with psp.
>

No, i did not see any segfaulting in the apache2 error logs, which  
made tracking this problem really hard.


There seems to be some known problem with libmhash2 and Debian ETCH:
http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=440272

However, in this case i was able to locate a different PHP5 module  
which caused this problem: php5-recode


'sudo apt-get remove php5-recode' solved my issues.


Cheers,
Nicholas
From durumdara at gmail.com  Thu Sep 27 10:44:58 2007
From: durumdara at gmail.com (durumdara@gmail.com)
Date: Mon Oct  1 03:30:25 2007
Subject: [mod_python] 2.4.4 <> 2.4.3... :-)
Message-ID: <fdgflf$p7p$1@sea.gmane.org>

Hi!

I reinstalled my "old" server, and I got this warning:

 >[Thu Sep 27 15:47:26 2007] [error] python_init: Python version 
 >mismatch, expected '2.4.3', found '2.4.4'.

First: is it problem? Can I got errors because of the little version diff?

 >[Thu Sep 27 15:47:26 2007] [error] python_init: Python executable 
found >'C:\\web\\xampplite\\apache\\bin\\apache.exe'.

What is this??? Python executable = apache.exe???

 >[Thu Sep 27 15:47:26 2007] [error] python_init: Python path being used 
 >'C:\\WINDOWS\\system32\\python24.zip;C:\\Python24\\Lib;C:\\Python24\\DLLs;C:\\Python24\\Lib\\lib-tk;;C:\\web\\xampplite\\apache\\bin'.

It is ok...

Please answer to me!

Thanks for it!

	dd

