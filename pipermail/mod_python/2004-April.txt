From vmanera at manord.com  Thu Apr  1 10:46:21 2004
From: vmanera at manord.com (Manera, Villiam)
Date: Thu Apr  1 05:04:18 2004
Subject: R: [mod_python] session.last_accessed() ?
Message-ID: <52DC70C1C1575C418CB033523A29CF14104950@exchange2000.manord.com>

I'm using session since 5 month in production environment without problem
as follow:

1) login   ---> new session,timeout=xxx
2) for any other access from this user I tested is_new() that become tru
only for timeout expired or 
restart of apache (or ... bug in our programs). So the only message to the
user is : timeout expired

why the need to distinguish from new and expired?

Villiam 
-----Messaggio originale-----
Da: mod_python-bounces@modpython.org
[mailto:mod_python-bounces@modpython.org]Per conto di John Mudd
Inviato: mercoled? 31 marzo 2004 22.02
A: Gregory (Grisha) "Trubetskoy
Cc: mpMailList
Oggetto: Re: [mod_python] session.last_accessed() ?


Thanks.

I started to add my own time stamp and then realized that even that
won't solve my original problem.  

What I really want to know if whether a new session object was created
because (1) there was never a session for this client before or (2) the
previous session has since expired.  I can tell if a session object is
new thanks to the is_new() method but not whether an old session
expired.  If I know then I can tell the client user why they have to
login again (e.g. the session expired).

John


On Wed, 2004-03-31 at 14:52, Gregory (Grisha) Trubetskoy wrote:
> This is a bug clearly... I suppose a workaround would be to store your own
> date until we have this fixed.
> 
> Grisha
> 
> On Wed, 31 Mar 2004, John Mudd wrote:
> 
> > What good is session.last_accessed() ?
> >
> > It seems to return the time that I created the session object or last
> > read it from disk.  Which tells me nothing of interest.
> >
> > I'd like to how long since the session was previously (if ever) saved to
> > disk.  Is there a way to get that?
> >
> > John
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python

From mudd at vex.net  Thu Apr  1 06:48:52 2004
From: mudd at vex.net (John Mudd)
Date: Thu Apr  1 07:45:02 2004
Subject: R: [mod_python] session.last_accessed() ?
In-Reply-To: <52DC70C1C1575C418CB033523A29CF14104950@exchange2000.manord.com>
References: <52DC70C1C1575C418CB033523A29CF14104950@exchange2000.manord.com>
Message-ID: <1080820131.2682.984.camel@localhost.localdomain>

I want to avoid incorrectly announcing "session expired" to truly new
users.  In the case of a new user I'd rather say something like "welcome
new user" or give extra help with their first login attempt.

For now I'm using pysqlite (so cool!) to setup a "hits" table on disk. 
I now keep track of the number of hits for each remote IP addr.  I check
the table for each hit.  If I get an IP address that's not in the table
then I add it and treat that session as a new user.  Any other time I
see a new session I treat it as an expired session.

I think it's interesting that you say you get a new session if apache is
restarted,  I don't see that behavior.  Maybe that's because my sessions
are being stored in a dbm file.  My sessions only expire due to timeout
which is good for me.

Thanks for your response,
John



On Thu, 2004-04-01 at 03:46, Manera, Villiam wrote:
> I'm using session since 5 month in production environment without problem
> as follow:
> 
> 1) login   ---> new session,timeout=xxx
> 2) for any other access from this user I tested is_new() that become tru
> only for timeout expired or 
> restart of apache (or ... bug in our programs). So the only message to the
> user is : timeout expired
> 
> why the need to distinguish from new and expired?
> 
> Villiam 
> -----Messaggio originale-----
> Da: mod_python-bounces@modpython.org
> [mailto:mod_python-bounces@modpython.org]Per conto di John Mudd
> Inviato: mercoled? 31 marzo 2004 22.02
> A: Gregory (Grisha) "Trubetskoy
> Cc: mpMailList
> Oggetto: Re: [mod_python] session.last_accessed() ?
> 
> 
> Thanks.
> 
> I started to add my own time stamp and then realized that even that
> won't solve my original problem.  
> 
> What I really want to know if whether a new session object was created
> because (1) there was never a session for this client before or (2) the
> previous session has since expired.  I can tell if a session object is
> new thanks to the is_new() method but not whether an old session
> expired.  If I know then I can tell the client user why they have to
> login again (e.g. the session expired).
> 
> John
> 
> 
> On Wed, 2004-03-31 at 14:52, Gregory (Grisha) Trubetskoy wrote:
> > This is a bug clearly... I suppose a workaround would be to store your own
> > date until we have this fixed.
> > 
> > Grisha
> > 
> > On Wed, 31 Mar 2004, John Mudd wrote:
> > 
> > > What good is session.last_accessed() ?
> > >
> > > It seems to return the time that I created the session object or last
> > > read it from disk.  Which tells me nothing of interest.
> > >
> > > I'd like to how long since the session was previously (if ever) saved to
> > > disk.  Is there a way to get that?
> > >
> > > John
> > >
> > > _______________________________________________
> > > Mod_python mailing list
> > > Mod_python@modpython.org
> > > http://mailman.modpython.org/mailman/listinfo/mod_python
> > >
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From jakob at simon-gaarde.dk  Thu Apr  1 18:58:18 2004
From: jakob at simon-gaarde.dk (jakob@simon-gaarde.dk)
Date: Thu Apr  1 12:53:47 2004
Subject: [mod_python] Session variables
Message-ID: <27583.80.160.199.114.1080838698.squirrel@webmail1.b-one.nu>

Hello.
I can see that you can save and load session values from mod_python 3.1,
but unfortunately I don't understand how this works. Could someone
elabourate with an example please?

Best regards Jakob Simon-Gaarde
From mudd at vex.net  Thu Apr  1 13:34:10 2004
From: mudd at vex.net (John Mudd)
Date: Thu Apr  1 14:29:35 2004
Subject: [mod_python] Session variables
In-Reply-To: <27583.80.160.199.114.1080838698.squirrel@webmail1.b-one.nu>
References: <27583.80.160.199.114.1080838698.squirrel@webmail1.b-one.nu>
Message-ID: <1080844449.2682.1004.camel@localhost.localdomain>

I think the session object is auto loaded (if one already exists).  You
can request a session for a specific sid but I don't know why.  The sid
is auto saved in a cookie for you.

	session = Session.Session(req, None, secretKey)


If you saved a session before for this same client, and it hasn't
expired yet. you'll get the same session back.  If it's a mew client or
te session expired you'll get a new (blank) session.  Use is_new() to
test.

	if session.is_new():
	

Once you have a session object you can store stuff in it.  Like a
dictionary.  You can also set (and later reset) a timeout.

    session['login'] = login
    session['passwd'] = passwd
    session['page'] = nextPage
    session['loginCount'] = loginCount



And it seems that a "pysid" cookie is auto generated when you save the
session object.  

	session.save()


Pretty cool.  Now if there is just an automatic way to tell if a new
session is the result of an old session expiring...

John


On Thu, 2004-04-01 at 11:58, jakob@simon-gaarde.dk wrote:
> Hello.
> I can see that you can save and load session values from mod_python 3.1,
> but unfortunately I don't understand how this works. Could someone
> elabourate with an example please?
> 
> Best regards Jakob Simon-Gaarde
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From spencer.wilson at comcast.net  Thu Apr  1 22:43:16 2004
From: spencer.wilson at comcast.net (spencer.wilson@comcast.net)
Date: Thu Apr  1 18:38:44 2004
Subject: [mod_python] Configuring Apache
Message-ID: <040120042243.19286.406C9B03000E6A4000004B562200751150FF91908C939688D18D9A9C919A8F@comcast.net>

Linux debian 2.2.20 #1 Sat Apr 20 11:45:28 EST 2002 i686 GNU/Linux

Python 2.3.3 (#2, Feb 24 2004, 09:29:20)
[GCC 3.3.3 (Debian)] on linux2

Apache/1.3.29 Server

LoadModule python_module /usr/lib/apache/1.3/mod_python.so
                                                                                
<Directory /var/www/>
    AddHandler python-program .py
    PythonHandler mptest
    PythonDebug On
</Directory>

AddType text/x-python .py

=======================================

When I try to run my Python CGI scripts, I get a message from Mozilla saying "Mozilla does not know how to handle this file type."

What do I need to be doing to get mod-python working with Apache?

--
- Spencer Warren Wilson
From nbastin at opnet.com  Thu Apr  1 18:06:28 2004
From: nbastin at opnet.com (Nick Bastin)
Date: Thu Apr  1 19:01:55 2004
Subject: [mod_python] 
	Apache doesn't start after new mod_python install (3.1.3)
Message-ID: <35324824-8431-11D8-AF48-000393CBDF94@opnet.com>

I was previously running Apache 2.0.47 with mod_python 3.0.3.  Today, I 
upgraded to mod_python 3.1.3, and not apache does not start.  No errors 
are reported - it just doesn't start.  If I remove the LoadModule 
directive, apache starts up fine.  Any ideas?

--
Nick

From jakob at simon-gaarde.dk  Fri Apr  2 08:33:23 2004
From: jakob at simon-gaarde.dk (jakob@simon-gaarde.dk)
Date: Fri Apr  2 02:28:57 2004
Subject: [mod_python] psp and statevariables
Message-ID: <28470.80.160.199.114.1080887603.squirrel@webmail1.b-one.nu>

Hello.

And thanks for the feedback on session values. My next question: How do I
fetch request state variables in psp. For instance:

In this request: http://127.0.0.1/psptest/playerinfo.psp?playerid=3
The serverscript playerinfo.psp should be able to access the playerid
variable passed by the requester.

Best regards
Jakob Simon-Gaarde
From vmanera at manord.com  Fri Apr  2 09:42:41 2004
From: vmanera at manord.com (Manera, Villiam)
Date: Fri Apr  2 03:47:47 2004
Subject: R: R: [mod_python] session.last_accessed() ?
Message-ID: <52DC70C1C1575C418CB033523A29CF14104952@exchange2000.manord.com>

Sorry,
I forgot to tell you that I work in windows environment.

At the beginning I started to save session on file, in order to avoid lose
session at the restart of apache, then trying memory session I was impressed
about performance so now I store session in memory.

Thanks for the explanation
Villiam

-----Messaggio originale-----
Da: mod_python-bounces@modpython.org
[mailto:mod_python-bounces@modpython.org]Per conto di John Mudd
Inviato: gioved? 1 aprile 2004 13.49
A: Manera, Villiam
Cc: mpMailList
Oggetto: Re: R: [mod_python] session.last_accessed() ?


I want to avoid incorrectly announcing "session expired" to truly new
users.  In the case of a new user I'd rather say something like "welcome
new user" or give extra help with their first login attempt.

For now I'm using pysqlite (so cool!) to setup a "hits" table on disk. 
I now keep track of the number of hits for each remote IP addr.  I check
the table for each hit.  If I get an IP address that's not in the table
then I add it and treat that session as a new user.  Any other time I
see a new session I treat it as an expired session.

I think it's interesting that you say you get a new session if apache is
restarted,  I don't see that behavior.  Maybe that's because my sessions
are being stored in a dbm file.  My sessions only expire due to timeout
which is good for me.

Thanks for your response,
John



On Thu, 2004-04-01 at 03:46, Manera, Villiam wrote:
> I'm using session since 5 month in production environment without problem
> as follow:
> 
> 1) login   ---> new session,timeout=xxx
> 2) for any other access from this user I tested is_new() that become tru
> only for timeout expired or 
> restart of apache (or ... bug in our programs). So the only message to the
> user is : timeout expired
> 
> why the need to distinguish from new and expired?
> 
> Villiam 
> -----Messaggio originale-----
> Da: mod_python-bounces@modpython.org
> [mailto:mod_python-bounces@modpython.org]Per conto di John Mudd
> Inviato: mercoled? 31 marzo 2004 22.02
> A: Gregory (Grisha) "Trubetskoy
> Cc: mpMailList
> Oggetto: Re: [mod_python] session.last_accessed() ?
> 
> 
> Thanks.
> 
> I started to add my own time stamp and then realized that even that
> won't solve my original problem.  
> 
> What I really want to know if whether a new session object was created
> because (1) there was never a session for this client before or (2) the
> previous session has since expired.  I can tell if a session object is
> new thanks to the is_new() method but not whether an old session
> expired.  If I know then I can tell the client user why they have to
> login again (e.g. the session expired).
> 
> John
> 
> 
> On Wed, 2004-03-31 at 14:52, Gregory (Grisha) Trubetskoy wrote:
> > This is a bug clearly... I suppose a workaround would be to store your
own
> > date until we have this fixed.
> > 
> > Grisha
> > 
> > On Wed, 31 Mar 2004, John Mudd wrote:
> > 
> > > What good is session.last_accessed() ?
> > >
> > > It seems to return the time that I created the session object or last
> > > read it from disk.  Which tells me nothing of interest.
> > >
> > > I'd like to how long since the session was previously (if ever) saved
to
> > > disk.  Is there a way to get that?
> > >
> > > John
> > >
> > > _______________________________________________
> > > Mod_python mailing list
> > > Mod_python@modpython.org
> > > http://mailman.modpython.org/mailman/listinfo/mod_python
> > >
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python

From reed at intersiege.com  Fri Apr  2 13:01:40 2004
From: reed at intersiege.com (Reed L. O'Brien)
Date: Fri Apr  2 13:53:25 2004
Subject: [mod_python] mod_python apache config weirdness
Message-ID: <3509.66.92.163.23.1080928900.squirrel@webmail.intersiege.com>

I am reposting as I have not solved this properly and I am still having
trouble with it.  Please help.  The installs are all defaults from the
ports section.  I followed the instructions attached to them.  They are
usually pretty up to date.

<in Apache2 config>

AddHandler mod_python .py
       Gives a full rendering of the page (home, about, products) if I
manually add the .py extension


With:
SetHandler mod_python

will render all the text and links but no images or menu colors, image
links appears as broken image links.


Although if I an add handler and load the default page (nothing after
trailing slash) then change to SetHandler it will render and work fine.
But it is pulling images and such from the cache.  This is what tricked
me into thinking it was solved earlier.  As soon as I clear the cache or
it expires it falls back to no images and noo menu highlighting.

Ideas?

Once again the set up:
Apache2.0.49
mod_python3.1.3
Python2.3.3 patchlevel 4
on freebsd 4.9
4.6692016090


From jakob at simon-gaarde.dk  Fri Apr  2 21:08:36 2004
From: jakob at simon-gaarde.dk (Jakob Simon-Gaarde)
Date: Fri Apr  2 15:04:00 2004
Subject: [mod_python] How about those state variables?
Message-ID: <406DBA34.7020401@simon-gaarde.dk>

Hi there.

Earlier today I asked about statevariables in psp handler mode.


for instance in the following request: 
http://localhost/playerinfo.psp?playerid=3

How do I access the state variable playerid from the psp script in 
playerinfo.py.

Best regards
Jakob Simon-Gaarde

From sleach at netlojix.com  Fri Apr  2 11:21:22 2004
From: sleach at netlojix.com (Sean Leach)
Date: Fri Apr  2 15:16:52 2004
Subject: [mod_python] How about those state variables?
In-Reply-To: <406DBA34.7020401@simon-gaarde.dk>
References: <406DBA34.7020401@simon-gaarde.dk>
Message-ID: <406DBD32.9010008@netlojix.com>

I assume you mean in playerinfo.psp.  The docs are a good place to 
start, as is this article:

http://www.onlamp.com/lpt/a/4597



Jakob Simon-Gaarde wrote:
> 
> Hi there.
> 
> Earlier today I asked about statevariables in psp handler mode.
> 
> 
> for instance in the following request:
> http://localhost/playerinfo.psp?playerid=3
> 
> How do I access the state variable playerid from the psp script in
> playerinfo.py.
> 
> Best regards
> Jakob Simon-Gaarde
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
From jakob at simon-gaarde.dk  Fri Apr  2 21:55:00 2004
From: jakob at simon-gaarde.dk (Jakob Simon-Gaarde)
Date: Fri Apr  2 15:50:35 2004
Subject: [mod_python] How about those state variables?
In-Reply-To: <406DBD32.9010008@netlojix.com>
References: <406DBA34.7020401@simon-gaarde.dk> <406DBD32.9010008@netlojix.com>
Message-ID: <406DC514.3090509@simon-gaarde.dk>

Thanks for the link :)

best regards
Jakob Simon-Gaarde

Sean Leach wrote:
> I assume you mean in playerinfo.psp.  The docs are a good place to 
> start, as is this article:
> 
> http://www.onlamp.com/lpt/a/4597
> 
> 
> 
> Jakob Simon-Gaarde wrote:
> 
>>
>> Hi there.
>>
>> Earlier today I asked about statevariables in psp handler mode.
>>
>>
>> for instance in the following request:
>> http://localhost/playerinfo.psp?playerid=3
>>
>> How do I access the state variable playerid from the psp script in
>> playerinfo.py.
>>
>> Best regards
>> Jakob Simon-Gaarde
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 


From lists at webcrunchers.com  Sat Apr  3 14:31:43 2004
From: lists at webcrunchers.com (John Draper)
Date: Sat Apr  3 18:27:12 2004
Subject: [mod_python] Some questions about CHRooted invironment
Message-ID: <AF46784E-85BE-11D8-9BA2-003065477776@webcrunchers.com>

Hi,

As some,  but not all people know,  the Apache that comes with openBSD 
has a few
security features built in.   In most cases,  this severely restricts 
the environment
that CGI code can run in.

Is the environment of Mod_python within the same chrooted environment 
that normal
CGI's would run in?    Or, because it's a module,  would it be running 
under the same
permissions as 'httpd' and would that ALSO be run under the chrooted 
environment?

Is there anyone on this list using OpenBSD and running CGI's 
sucessfully?

Below is a portion of the man httpd for the OpenBSD ver of apache.
Not certain of other OS's have this feature.

OPTIONS
      -u      By default httpd will chroot(2) to the serverroot path.  
The -u
              option disables this behaviour, and returns httpd to the 
expanded
              "unsecure" behaviour.

              As a result of the default secure behaviour, httpd cannot 
access
              any objects outside ServerRoot - this security measure is 
taken
              in case httpd is compromised.  This is not without 
drawbacks,
              though:

              CGI programs may fail due to the limited environment 
available
              inside this chroot space.  UserDir, of course, cannot 
access
              files outside the directory space.  Other modules will 
also have
              issues.  DocumentRoot directories or any other files 
needed must
              be inside ServerRoot.  For this to work, pathnames inside 
the
              config file do not need adjustment relative to ServerRoot. 
  For
              this option to remain secure, it is important that no 
files or
              directories writable by user www or group www are created 
inside
              the ServerRoot.

So,  the bottom line is,   if I use this option,  will I be able to 
access
UNIX level commands from within Mod_python?

By the way,  FYI - This apache server is only going to accessable from 
a small
number of work stations within a small secure netblock,  so we are not 
concerned
with the possibility of an outside system hacking into Apache.

Please send your replies to 'crunch at shopip dot com'

Thanx
John

From lists at webcrunchers.com  Sat Apr  3 15:15:34 2004
From: lists at webcrunchers.com (John Draper)
Date: Sat Apr  3 19:11:33 2004
Subject: [mod_python] Still having problems installing Mod_Python
Message-ID: <CF239E0C-85C4-11D8-9BA2-003065477776@webcrunchers.com>

I followed the instructions for building Mod_python,  and added these
to the httpd.conf file.

   LoadModule python_module /usr/lib/apache/modules/mod_python.so

But when I start Apache:   I get:

[Sat Apr  3 15:08:16 2004] [warn] Loaded DSO 
/usr/lib/apache/modules/mod_python.so
     uses plain Apache 1.3 API, this module might crash under EAPI!
     (please recompile it with -DEAPI)

WOuld someone please tell me what I have to do to re-compile mod_python
with this option?    Of course the docs do not say how to do this.

John

From paulhart at redchocolate.ca  Sat Apr  3 18:16:11 2004
From: paulhart at redchocolate.ca (Paul Hart)
Date: Sat Apr  3 19:11:43 2004
Subject: [mod_python] Some questions about CHRooted invironment
In-Reply-To: <AF46784E-85BE-11D8-9BA2-003065477776@webcrunchers.com>
References: <AF46784E-85BE-11D8-9BA2-003065477776@webcrunchers.com>
Message-ID: <E5944FD0-85C4-11D8-BD0E-000393CC268A@redchocolate.ca>

John,

'-u' completely removes the chroot jail. The only other issue you might 
have is that the 3.x versions of mod_python require Apache 2... If you 
don't need that, there shouldn't be any issues.

Personally, I use a self-built Apache 2 with mod_python 3 and Python 
2.2. Everything works very well.

Python is available in the ports tree, both 2.2 and 2.3 are there.

A pleasure to be of assistance cap'n.

Paul

On 3 Apr 2004, at 17:31, John Draper wrote:

> Hi,
>
> As some,  but not all people know,  the Apache that comes with openBSD 
> has a few
> security features built in.   In most cases,  this severely restricts 
> the environment
> that CGI code can run in.
>
> Is the environment of Mod_python within the same chrooted environment 
> that normal
> CGI's would run in?    Or, because it's a module,  would it be running 
> under the same
> permissions as 'httpd' and would that ALSO be run under the chrooted 
> environment?
>
> Is there anyone on this list using OpenBSD and running CGI's 
> sucessfully?
>
> Below is a portion of the man httpd for the OpenBSD ver of apache.
> Not certain of other OS's have this feature.
>
> OPTIONS
>      -u      By default httpd will chroot(2) to the serverroot path.  
> The -u
>              option disables this behaviour, and returns httpd to the 
> expanded
>              "unsecure" behaviour.
>
>              As a result of the default secure behaviour, httpd cannot 
> access
>              any objects outside ServerRoot - this security measure is 
> taken
>              in case httpd is compromised.  This is not without 
> drawbacks,
>              though:
>
>              CGI programs may fail due to the limited environment 
> available
>              inside this chroot space.  UserDir, of course, cannot 
> access
>              files outside the directory space.  Other modules will 
> also have
>              issues.  DocumentRoot directories or any other files 
> needed must
>              be inside ServerRoot.  For this to work, pathnames inside 
> the
>              config file do not need adjustment relative to 
> ServerRoot.  For
>              this option to remain secure, it is important that no 
> files or
>              directories writable by user www or group www are created 
> inside
>              the ServerRoot.
>
> So,  the bottom line is,   if I use this option,  will I be able to 
> access
> UNIX level commands from within Mod_python?
>
> By the way,  FYI - This apache server is only going to accessable from 
> a small
> number of work stations within a small secure netblock,  so we are not 
> concerned
> with the possibility of an outside system hacking into Apache.
>
> Please send your replies to 'crunch at shopip dot com'
>
> Thanx
> John
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From eric at ericwalstad.com  Sun Apr  4 15:11:01 2004
From: eric at ericwalstad.com (Eric Walstad)
Date: Sun Apr  4 18:07:51 2004
Subject: [mod_python] running as root...
Message-ID: <200404041511.02053.eric@ericwalstad.com>

Hi All,
I need to give one of my mod_python apps the ability to run as root.  
Aside from the security risks, what's the best to do this?  Nothing 
much came up on google when I checked.
Thanks in advance for any pointers or info,
Eric.

From godoy at ieee.org  Sun Apr  4 20:25:55 2004
From: godoy at ieee.org (Jorge Godoy)
Date: Sun Apr  4 20:05:55 2004
Subject: [mod_python] Re: running as root...
References: <200404041511.02053.eric@ericwalstad.com>
Message-ID: <m4i6k1-rg5.ln1@wintermute.g2ctech>

On Dom 04 Abr 2004 19:11, Eric Walstad wrote:

> I need to give one of my mod_python apps the ability to run as root.
> Aside from the security risks, what's the best to do this?  Nothing
> much came up on google when I checked.

Eric, unless your webserver run as root I'm afraid it won't be possible.

An alternative would be to evaluate exactly what will require root powers
and use a C wrapper to run another Python script or tool with such
privileges.

Here's one example from the Perl documentation:


           #define REAL_PATH "/path/to/script"
           main(ac, av)
               char **av;
           {
               execv(REAL_PATH, av);
           }


Here, "/path/to/script" would be either the path to the binary or to your
other Python script. It will pass along all the parameters it gets in
command line, so the result would be the same as if you ran your
script/program as root.


Be seeing you,
-- 
Godoy.      <godoy@ieee.org>

From eric at ericwalstad.com  Sun Apr  4 19:28:23 2004
From: eric at ericwalstad.com (Eric Walstad)
Date: Sun Apr  4 22:25:06 2004
Subject: [mod_python] Re: running as root...
In-Reply-To: <m4i6k1-rg5.ln1@wintermute.g2ctech>
References: <200404041511.02053.eric@ericwalstad.com>
	<m4i6k1-rg5.ln1@wintermute.g2ctech>
Message-ID: <200404041928.23859.eric@ericwalstad.com>

On Sunday 04 April 2004 16:25, Jorge Godoy wrote:
> On Dom 04 Abr 2004 19:11, Eric Walstad wrote:
> > I need to give one of my mod_python apps the ability to run as
> > root.
[snip]
> use a C wrapper to run another Python script or tool
> with such privileges.
>
> Here's one example from the Perl documentation:
>
>
>            #define REAL_PATH "/path/to/script"
>            main(ac, av)
>                char **av;
>            {
>                execv(REAL_PATH, av);
>            }
>
>
> Here, "/path/to/script" would be either the path to the binary or
> to your other Python script. It will pass along all the parameters
> it gets in command line, so the result would be the same as if you
> ran your script/program as root.
>
>
> Be seeing you,
Thank you, Jorge.  This was just the lead I was looking for.

Best regards,

Eric.
From cfox at cfconsulting.ca  Sun Apr  4 21:13:43 2004
From: cfox at cfconsulting.ca (Colin Fox)
Date: Mon Apr  5 00:09:18 2004
Subject: [mod_python] Sessions
Message-ID: <4070DCF7.6060102@cfconsulting.ca>

Hi, all.

I'm trying to use sessions, and getting a wierd behaviour. Two 
behaviours, really. First, the site is very snappy and responsive until 
I add sessions, then suddenly every 10 pages or so the site will 
suddenly just not respond (and my current session use is pretty much 
just what I have as an example below).

Secondly, I can record values into the session in one part of my code, 
but when I check for them somewhere else, they're never there.

Are sessions global? There's a part in the docs about "Cookies generated 
by sessions..." are they talking about access to the session itself?

Here's a snippet of what I'm doing to test the session code:

     session = Session.Session(req)
     req.write("is_new(): %s" % session.is_new())

Any particular reason why that would lock up?

Lastly, when I call "session.save()" - That is only documented as 
writing session values to storage - is that supposed to be persistant 
storage, or memory? If I say "session['blah']=5", will that actually be 
stored in the session for alter retrieval, or do I have to call 
session.save() after every change, regardless of whether or not I want 
it to be server or client reset persistant?

Thanks,
   cf

ps. The "secret key" for a signed cookie - Can that be any value, or 
does that have to be an MD5 or something? The docs don't say. Can I just 
use "blah blah blah" as my secret?
From cfox at cfconsulting.ca  Sun Apr  4 21:36:20 2004
From: cfox at cfconsulting.ca (Colin Fox)
Date: Mon Apr  5 00:31:54 2004
Subject: [mod_python] More on sessions
Message-ID: <4070E244.5040603@cfconsulting.ca>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Another (odd?) thing - Every time I call Session.Session(req), it seems
to re-write the cookie. Is that supposed to happen? And the value it
stores in pysid is different each time. Is that normal?

Thanks,
~  cf
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)

iD8DBQFAcOJEoaQ1/feGlJoRAoUGAJ9ng5QyU1UvyKfYpdeyzBPBvCYNyQCZAUge
PLr9Rr73jf0SODeY9fuNjMg=
=Gw5q
-----END PGP SIGNATURE-----
From cfox at cfconsulting.ca  Mon Apr  5 00:16:44 2004
From: cfox at cfconsulting.ca (Colin Fox)
Date: Mon Apr  5 03:12:19 2004
Subject: [mod_python] Sessions, still
Message-ID: <407107DC.4000106@cfconsulting.ca>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Well, I've discovered why the session stuff I was doing wasn't working.
I didn't realize that the util module had a redirect, so I was doing it
myself with this code (which I got from the docs somewhere...):

def old_redirect(req, url, temporary=False, seeOther=False):
~    """
~    Immediately redirects the request to the given url. If the
~    seeOther parameter is set, 303 See Other response is sent, if the
~    temporary parameter is set, the server issues a 307 Temporary
~    Redirect. Otherwise a 301 Moved Permanently response is issued.
~    """


~    if seeOther:
~        status = apache.HTTP_SEE_OTHER
~    elif temporary:
~        status = apache.HTTP_TEMPORARY_REDIRECT
~    else:
~        status = apache.HTTP_MOVED_PERMANENTLY


~    req.headers_out['Location'] = url
~    req.status = status
~    raise apache.SERVER_RETURN, status


If I use that, then the session variables don't seem to work. If I use
util.redirect(), they do. What are the two redirects doing differently?

I'm also still curious when to use session.save() and session.load().

Thanks,
~  cf
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)

iD4DBQFAcQfcoaQ1/feGlJoRApL6AJdCXbpTKgQVRIwUZrg3hMxFne/CAJ4jD1sl
DM7r2orMPM/vqd8vHi5hBQ==
=qnae
-----END PGP SIGNATURE-----
From cfox at cfconsulting.ca  Mon Apr  5 00:51:19 2004
From: cfox at cfconsulting.ca (Colin Fox)
Date: Mon Apr  5 03:46:53 2004
Subject: [mod_python] Session Locking
Message-ID: <40710FF7.1070605@cfconsulting.ca>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

At what point is session.lock() called? I'm still getting my pages
hanging, and a held lock could explain that. Is there something I need
to do to lock/unlock the session?

I'm not calling lock() explicitly, and the docs seem to indicate that
that's correct. Am I misunderstanding them?

Thanks,
~  cf
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)

iD8DBQFAcQ/3oaQ1/feGlJoRAoZ4AJ9WPaU4fKKOANBEarktB62Cqh6TuACaA6ts
ILhqg0eaznizkNKpJwBcS94=
=6z9l
-----END PGP SIGNATURE-----
From mudd at vex.net  Mon Apr  5 07:20:14 2004
From: mudd at vex.net (John Mudd)
Date: Mon Apr  5 07:15:57 2004
Subject: [mod_python] Sessions, still
In-Reply-To: <407107DC.4000106@cfconsulting.ca>
References: <407107DC.4000106@cfconsulting.ca>
Message-ID: <1081164013.2682.1103.camel@localhost.localdomain>

I never call load(), it's apparently automatic when the session object
is created.

I suggest only instantiating once.  Why were you doing it again?  

Only call save() once at the end.  In between instantiation and load()
use it like a dictionary.  

John


On Mon, 2004-04-05 at 03:16, Colin Fox wrote:
> I'm also still curious when to use session.save() and session.load().
> 


From gah at research.att.com  Mon Apr  5 09:44:03 2004
From: gah at research.att.com (Glenn A. Hochberg)
Date: Mon Apr  5 09:39:34 2004
Subject: [mod_python] Still having problems installing Mod_Python
In-Reply-To: <200404041700.i34H06xl029100@slash.mediapulse.com>
References: <200404041700.i34H06xl029100@slash.mediapulse.com>
Message-ID: <407162A3.8030504@research.att.com>

I remember this happened to me once too.  I don't remember what I did, 
but it looks like this might work:
    make OPT=-DEAPI

There's a make variable "OPT" that gets included in the CFLAGS (see 
src/Makefile).

    -Glenn

John Draper wrote:

>I followed the instructions for building Mod_python,  and added these
>to the httpd.conf file.
>
>   LoadModule python_module /usr/lib/apache/modules/mod_python.so
>
>But when I start Apache:   I get:
>
>[Sat Apr  3 15:08:16 2004] [warn] Loaded DSO 
>/usr/lib/apache/modules/mod_python.so
>     uses plain Apache 1.3 API, this module might crash under EAPI!
>     (please recompile it with -DEAPI)
>
>WOuld someone please tell me what I have to do to re-compile mod_python
>with this option?    Of course the docs do not say how to do this.
>
>John
>  
>

From pascalbarbedor at free.fr  Mon Apr  5 16:08:55 2004
From: pascalbarbedor at free.fr (pascalbarbedor@free.fr)
Date: Mon Apr  5 10:04:23 2004
Subject: [mod_python] session example
Message-ID: <1081174135.40716877694c4@imp5-q.free.fr>


can anyone post a simple working example of how to use sessions
especially how to recover existing sessions


I can make a new session but i can't recover an existing session.

is the sid cookie automatically written down to user comp and recovered
or do I have to manage myself the writing and reading of the sid via cookie 
mechanism ?


thanks
From Vincent.Raaijmakers at ge.com  Mon Apr  5 09:09:28 2004
From: Vincent.Raaijmakers at ge.com (Raaijmakers, Vincent (GE Infrastructure))
Date: Mon Apr  5 10:05:19 2004
Subject: [mod_python] 
	Looking for cookbook/recipe generating multipart web data
Message-ID: <971323274247EB44B9A01D0A3B424C8507F5AFA3@FTWMLVEM02.e2k.ad.ge.com>

My web server (apache+mod_python) needs to reply on some session with a multipart connection. 
My idea is to use the content-type of multipart/mixed; boundary=--myboundary

The data that I would like to send is a continuous stream of data, divided by that boundary.
Well, there are tons of examples on the web how to encode such a stream on the client side, but I can't find an example how to generate this data using mod_python.

So for now in the very simple example, my code looks like:

req.content_type("multipart/mixed; boundary=--myboundary")
while forever:
	data = "--myboudary\r\n%s" % getData()
	req.write(data)

However, for every req.write,  len(data) + lfcr + boundary/data + lfcr is send out and I just want to send boudary/data like I see in existing applications on the web and described in the w3 norms of multipart.

What is the correct way of doing this? Where can I find the proper cookbook?

Thanks, 
Vincent

From mudd at vex.net  Mon Apr  5 15:30:49 2004
From: mudd at vex.net (John Mudd)
Date: Mon Apr  5 15:26:16 2004
Subject: [mod_python] session.last_accessed() ?
In-Reply-To: <1080763341.2682.964.camel@localhost.localdomain>
References: <1080756022.2682.926.camel@localhost.localdomain>
	 <20040331145107.R35764@onyx.ispol.com>
	 <1080763341.2682.964.camel@localhost.localdomain>
Message-ID: <1081193448.2682.1129.camel@localhost.localdomain>

Oh, I just found some code from an old version that looks like it should
work.  But I deleted it.  I can't remember now why I dropped it.

Does this (if cookies.has_key('pysid')) look like a reasonable way to
tell if a new session is for a truly first time (virgin) user?

    # Get any ccookies.
    cookies = Cookie.get_cookies(req, Cookie.MarshalCookie,
	 secret=secretKey)

    # Either read the existing session (if any) or create a new one.
    session = Session.Session(req, None, secretKey, timeout)

    # Was it necessary to create a new session object?
    if session.is_new():

        # Was there an old session but it expired?
        if cookies.has_key('pysid'):            
            sessionStatus = 'expired'
        else:
            sessionStatus = 'new'



On Wed, 2004-03-31 at 15:02, John Mudd wrote:
> Thanks.
> 
> I started to add my own time stamp and then realized that even that
> won't solve my original problem.  
> 
> What I really want to know if whether a new session object was created
> because (1) there was never a session for this client before or (2) the
> previous session has since expired.  I can tell if a session object is
> new thanks to the is_new() method but not whether an old session
> expired.  If I know then I can tell the client user why they have to
> login again (e.g. the session expired).
> 
> John
> 
> 
> On Wed, 2004-03-31 at 14:52, Gregory (Grisha) Trubetskoy wrote:
> > This is a bug clearly... I suppose a workaround would be to store your own
> > date until we have this fixed.
> > 
> > Grisha
> > 
> > On Wed, 31 Mar 2004, John Mudd wrote:
> > 
> > > What good is session.last_accessed() ?
> > >
> > > It seems to return the time that I created the session object or last
> > > read it from disk.  Which tells me nothing of interest.
> > >
> > > I'd like to how long since the session was previously (if ever) saved to
> > > disk.  Is there a way to get that?
> > >
> > > John
> > >
> > > _______________________________________________
> > > Mod_python mailing list
> > > Mod_python@modpython.org
> > > http://mailman.modpython.org/mailman/listinfo/mod_python
> > >

From anthony.barker at bmo.com  Mon Apr  5 15:37:24 2004
From: anthony.barker at bmo.com (anthony.barker@bmo.com)
Date: Mon Apr  5 15:33:42 2004
Subject: [mod_python] 	Apache doesn't start after new mod_python install
	(3.1.3)
Message-ID: <OF564837A7.CD64A210-ON85256E6A.005B9459@notes.bmo.com>

Nick which version of python are you using?

I was having problems with mod_python after I installed plone. I was 
forced to uninstall python, mod_python and apache and then reinstall.

After that it worked fine.

Anthony





Nick Bastin <nbastin@opnet.com>
Sent by: mod_python-bounces@modpython.org
01/04/2004 06:06 PM

 
        To:     mod_python@modpython.org
        cc: 
        Subject:        [mod_python]    Apache doesn't start after new mod_python install (3.1.3)


I was previously running Apache 2.0.47 with mod_python 3.0.3.  Today, I 
upgraded to mod_python 3.1.3, and not apache does not start.  No errors 
are reported - it just doesn't start.  If I remove the LoadModule 
directive, apache starts up fine.  Any ideas?

--
Nick

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20040405/64e3ddab/attachment.html
From nbastin at opnet.com  Mon Apr  5 16:03:52 2004
From: nbastin at opnet.com (Nick Bastin)
Date: Mon Apr  5 16:00:01 2004
Subject: [mod_python] 	Apache doesn't start after new mod_python install
	(3.1.3)
In-Reply-To: <OF564837A7.CD64A210-ON85256E6A.005B9459@notes.bmo.com>
References: <OF564837A7.CD64A210-ON85256E6A.005B9459@notes.bmo.com>
Message-ID: <5C533A22-873C-11D8-A381-000393CBDF94@opnet.com>


On Apr 5, 2004, at 3:37 PM, anthony.barker@bmo.com wrote:

>
> Nick which version of python are you using?
>
> I was having problems with mod_python after I installed plone. I was 
> forced to uninstall python, mod_python and apache and then reinstall.
>
> After that it worked fine.

I'm using Python 2.3.

--
Nick

From pascalbarbedor at free.fr  Tue Apr  6 10:13:02 2004
From: pascalbarbedor at free.fr (pascalbarbedor@free.fr)
Date: Tue Apr  6 04:08:31 2004
Subject: [mod_python] session example
Message-ID: <1081239182.4072668e638a3@imp5-q.free.fr>

hi 
thanks for preceeding answer but I cant make it work.

what's wrong with this:
---------------------------------------
sess=Session.Session(req)

if sess.is_new():
    req.write(sess.id())
else :
    req.write('used session %s'%sess.id())

sess['login']='toto'

req.write("%s"%sess)

sess.save()
----------------------------------------

shouldn't it display session used on second reload of the page ?


thanks
From mudd at vex.net  Tue Apr  6 06:02:02 2004
From: mudd at vex.net (John Mudd)
Date: Tue Apr  6 05:58:06 2004
Subject: [mod_python] session example
In-Reply-To: <1081239182.4072668e638a3@imp5-q.free.fr>
References: <1081239182.4072668e638a3@imp5-q.free.fr>
Message-ID: <1081245722.2679.2.camel@localhost.localdomain>

I may be way off so feel free to correct me but here what I've come to
believe.  It's necessary to write cookies before any other writes.  So
you need to save the session (which writes it's cookie) before any other
writes.

John


On Tue, 2004-04-06 at 04:13, pascalbarbedor@free.fr wrote:
> hi 
> thanks for preceeding answer but I cant make it work.
> 
> what's wrong with this:
> ---------------------------------------
> sess=Session.Session(req)
> 
> if sess.is_new():
>     req.write(sess.id())
> else :
>     req.write('used session %s'%sess.id())
> 
> sess['login']='toto'
> 
> req.write("%s"%sess)
> 
> sess.save()
> ----------------------------------------
> 
> shouldn't it display session used on second reload of the page ?
> 
> 
> thanks
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From vmanera at manord.com  Tue Apr  6 11:42:37 2004
From: vmanera at manord.com (Manera, Villiam)
Date: Tue Apr  6 06:01:07 2004
Subject: R: [mod_python] session example
Message-ID: <52DC70C1C1575C418CB033523A29CF1401A76806@exchange2000.manord.com>

you may retry with:
PythonOption ApplicationPath '/'
in apache httpd.conf

Villiam

-----Messaggio originale-----
Da: mod_python-bounces@modpython.org
[mailto:mod_python-bounces@modpython.org]Per conto di
pascalbarbedor@free.fr
Inviato: marted? 6 aprile 2004 10.13
A: mod_python@modpython.org
Oggetto: [mod_python] session example


hi 
thanks for preceeding answer but I cant make it work.

what's wrong with this:
---------------------------------------
sess=Session.Session(req)

if sess.is_new():
    req.write(sess.id())
else :
    req.write('used session %s'%sess.id())

sess['login']='toto'

req.write("%s"%sess)

sess.save()
----------------------------------------

shouldn't it display session used on second reload of the page ?


thanks
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python

From r.barrett at ftel.co.uk  Tue Apr  6 11:25:14 2004
From: r.barrett at ftel.co.uk (Richard Barrett)
Date: Tue Apr  6 06:21:05 2004
Subject: [mod_python] session example
In-Reply-To: <1081245722.2679.2.camel@localhost.localdomain>
References: <1081239182.4072668e638a3@imp5-q.free.fr>
	<1081245722.2679.2.camel@localhost.localdomain>
Message-ID: <B15EC6D8-87B4-11D8-8715-000A957C9A50@ftel.co.uk>


On 6 Apr 2004, at 11:02, John Mudd wrote:

> I may be way off so feel free to correct me but here what I've come to
> believe.  It's necessary to write cookies before any other writes.  So
> you need to save the session (which writes it's cookie) before any 
> other
> writes.
>

Could that be because the cookie has to go in the response header and 
starting to write the response body "flushes" the response headers in 
whatever state they are in at that point, as they must precede the 
body, and thus any subsequent header changes  are in effect lost?

> John
>
>
> On Tue, 2004-04-06 at 04:13, pascalbarbedor@free.fr wrote:
>> hi
>> thanks for preceeding answer but I cant make it work.
>>
>> what's wrong with this:
>> ---------------------------------------
>> sess=Session.Session(req)
>>
>> if sess.is_new():
>>     req.write(sess.id())
>> else :
>>     req.write('used session %s'%sess.id())
>>
>> sess['login']='toto'
>>
>> req.write("%s"%sess)
>>
>> sess.save()
>> ----------------------------------------
>>
>> shouldn't it display session used on second reload of the page ?
>>
>>
>> thanks
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From mudd at vex.net  Tue Apr  6 06:29:47 2004
From: mudd at vex.net (John Mudd)
Date: Tue Apr  6 06:25:24 2004
Subject: [mod_python] session example
In-Reply-To: <B15EC6D8-87B4-11D8-8715-000A957C9A50@ftel.co.uk>
References: <1081239182.4072668e638a3@imp5-q.free.fr>
	 <1081245722.2679.2.camel@localhost.localdomain>
	 <B15EC6D8-87B4-11D8-8715-000A957C9A50@ftel.co.uk>
Message-ID: <1081247386.2679.5.camel@localhost.localdomain>

Yes, that's what I'm thinking.  

It doesn't mean you can save the session later also.  You just need to
get the cookie saved correctly once at the start.


On Tue, 2004-04-06 at 06:25, Richard Barrett wrote:
> On 6 Apr 2004, at 11:02, John Mudd wrote:
> 
> > I may be way off so feel free to correct me but here what I've come to
> > believe.  It's necessary to write cookies before any other writes.  So
> > you need to save the session (which writes it's cookie) before any 
> > other
> > writes.
> >
> 
> Could that be because the cookie has to go in the response header and 
> starting to write the response body "flushes" the response headers in 
> whatever state they are in at that point, as they must precede the 
> body, and thus any subsequent header changes  are in effect lost?
> 
> > John
> >
> >
> > On Tue, 2004-04-06 at 04:13, pascalbarbedor@free.fr wrote:
> >> hi
> >> thanks for preceeding answer but I cant make it work.
> >>
> >> what's wrong with this:
> >> ---------------------------------------
> >> sess=Session.Session(req)
> >>
> >> if sess.is_new():
> >>     req.write(sess.id())
> >> else :
> >>     req.write('used session %s'%sess.id())
> >>
> >> sess['login']='toto'
> >>
> >> req.write("%s"%sess)
> >>
> >> sess.save()
> >> ----------------------------------------
> >>
> >> shouldn't it display session used on second reload of the page ?
> >>
> >>
> >> thanks
> >> _______________________________________________
> >> Mod_python mailing list
> >> Mod_python@modpython.org
> >> http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >

From pascalbarbedor at free.fr  Tue Apr  6 15:37:14 2004
From: pascalbarbedor at free.fr (pascalbarbedor@free.fr)
Date: Tue Apr  6 09:32:44 2004
Subject: [mod_python] session example
In-Reply-To: <52DC70C1C1575C418CB033523A29CF1401A76806@exchange2000.manord.com>
References: <52DC70C1C1575C418CB033523A29CF1401A76806@exchange2000.manord.com>
Message-ID: <1081258634.4072b28a0a0b7@imp2-q.free.fr>


well it works with this, thanks, 
 but what's the explanation ?

I have in httpd.conf 
---------------------------------------------------
DocumentRoot c:/somedir

<Directory "c:/somedir/try">
AddHandler mod_python .psp
PythonHandler mod_python.psp
PythonDebug On 
Order allow,deny
Allow from all
PythonOption ApplicationPath '/'
</Directory>
-------------------------------------------

Selon "Manera, Villiam" <vmanera@manord.com>:

> you may retry with:
> PythonOption ApplicationPath '/'
> in apache httpd.conf
> 
> Villiam
> 
> -----Messaggio originale-----
> Da: mod_python-bounces@modpython.org
> [mailto:mod_python-bounces@modpython.org]Per conto di
> pascalbarbedor@free.fr
> Inviato: marted? 6 aprile 2004 10.13
> A: mod_python@modpython.org
> Oggetto: [mod_python] session example
> 
> 
> hi 
> thanks for preceeding answer but I cant make it work.
> 
> what's wrong with this:
> ---------------------------------------
> sess=Session.Session(req)
> 
> if sess.is_new():
>     req.write(sess.id())
> else :
>     req.write('used session %s'%sess.id())
> 
> sess['login']='toto'
> 
> req.write("%s"%sess)
> 
> sess.save()
> ----------------------------------------
> 
> shouldn't it display session used on second reload of the page ?
> 
> 
> thanks
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 


From grisha at modpython.org  Tue Apr  6 10:23:45 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Tue Apr  6 10:19:19 2004
Subject: [mod_python] session example
In-Reply-To: <1081245722.2679.2.camel@localhost.localdomain>
References: <1081239182.4072668e638a3@imp5-q.free.fr>
 <1081245722.2679.2.camel@localhost.localdomain>
Message-ID: <20040406101900.X54136@onyx.ispol.com>



On Tue, 6 Apr 2004, John Mudd wrote:

> I may be way off so feel free to correct me but here what I've come to
> believe.  It's necessary to write cookies before any other writes.

As someone explained it later, the first write flushes the headers, so the
cookie must be set before anything is written.

> So you need to save the session (which writes it's cookie) before any
> other writes.

The cookie is set in the __init__ method of the session object, so saving
the session and the cookie are not related.

Also keep in mind that the cookie is set only once - when the session is
new. After that there is no need for it, it's the client who has to send
the cookie to the server every time, the server does not need to "return"
it. So if your session persists over 100 HTTP requests, 1 will have a
cookie header, and 99 will not.

Grisha

>
> John
>
>
> On Tue, 2004-04-06 at 04:13, pascalbarbedor@free.fr wrote:
> > hi
> > thanks for preceeding answer but I cant make it work.
> >
> > what's wrong with this:
> > ---------------------------------------
> > sess=Session.Session(req)
> >
> > if sess.is_new():
> >     req.write(sess.id())
> > else :
> >     req.write('used session %s'%sess.id())
> >
> > sess['login']='toto'
> >
> > req.write("%s"%sess)
> >
> > sess.save()
> > ----------------------------------------
> >
> > shouldn't it display session used on second reload of the page ?
> >
> >
> > thanks
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From vmanera at manord.com  Tue Apr  6 17:54:20 2004
From: vmanera at manord.com (Manera, Villiam)
Date: Tue Apr  6 12:06:33 2004
Subject: R: [mod_python] session example
Message-ID: <52DC70C1C1575C418CB033523A29CF14104958@exchange2000.manord.com>

is the path in which the cookie 'pysid' of the session belong: '/' means all

Villiam

-----Messaggio originale-----
Da: mod_python-bounces@modpython.org
[mailto:mod_python-bounces@modpython.org]Per conto di
pascalbarbedor@free.fr
Inviato: marted? 6 aprile 2004 15.37
A: mod_python@modpython.org
Oggetto: [mod_python] session example



well it works with this, thanks, 
 but what's the explanation ?

I have in httpd.conf 
---------------------------------------------------
DocumentRoot c:/somedir

<Directory "c:/somedir/try">
AddHandler mod_python .psp
PythonHandler mod_python.psp
PythonDebug On 
Order allow,deny
Allow from all
PythonOption ApplicationPath '/'
</Directory>
-------------------------------------------

Selon "Manera, Villiam" <vmanera@manord.com>:

> you may retry with:
> PythonOption ApplicationPath '/'
> in apache httpd.conf
> 
> Villiam
> 
> -----Messaggio originale-----
> Da: mod_python-bounces@modpython.org
> [mailto:mod_python-bounces@modpython.org]Per conto di
> pascalbarbedor@free.fr
> Inviato: marted? 6 aprile 2004 10.13
> A: mod_python@modpython.org
> Oggetto: [mod_python] session example
> 
> 
> hi 
> thanks for preceeding answer but I cant make it work.
> 
> what's wrong with this:
> ---------------------------------------
> sess=Session.Session(req)
> 
> if sess.is_new():
>     req.write(sess.id())
> else :
>     req.write('used session %s'%sess.id())
> 
> sess['login']='toto'
> 
> req.write("%s"%sess)
> 
> sess.save()
> ----------------------------------------
> 
> shouldn't it display session used on second reload of the page ?
> 
> 
> thanks
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 


_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python

From cfox at cfconsulting.ca  Tue Apr  6 09:39:32 2004
From: cfox at cfconsulting.ca (Colin Fox)
Date: Tue Apr  6 12:35:08 2004
Subject: [mod_python] session example
In-Reply-To: <20040406101900.X54136@onyx.ispol.com>
References: <1081239182.4072668e638a3@imp5-q.free.fr>
	<1081245722.2679.2.camel@localhost.localdomain>
	<20040406101900.X54136@onyx.ispol.com>
Message-ID: <4072DD44.3050702@cfconsulting.ca>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Gregory (Grisha) Trubetskoy wrote:

|
| Also keep in mind that the cookie is set only once - when the session is
| new. After that there is no need for it, it's the client who has to send
| the cookie to the server every time, the server does not need to "return"
| it. So if your session persists over 100 HTTP requests, 1 will have a
| cookie header, and 99 will not.
|
| Grisha

Actually, this is definitely NOT the behaviour I'm seeing. If I delete
the pysid, and my site, then tell the browser to ask before storing a
cookie, I can see that every single call to Session() is actually saving
a new pysid. Plus, every pysid it's writing has a different value.

The path in the cookie is "/", so I don't understand why it would be
rewriting all the time.

Any ideas?

cf
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)

iD8DBQFAct1EoaQ1/feGlJoRAqQsAJ9i6pX0ZgmfH5oAdJG3SbjjGERWowCfeov/
R4ZR+5cH09qAQ78UF3j7+BY=
=nY0O
-----END PGP SIGNATURE-----
From cfox at cfconsulting.ca  Tue Apr  6 09:45:15 2004
From: cfox at cfconsulting.ca (Colin Fox)
Date: Tue Apr  6 12:40:49 2004
Subject: [mod_python] Sessions blocking...
Message-ID: <4072DE9B.4090708@cfconsulting.ca>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1


I've still got the problem where using sessions causes my pages to hang.

Now that I've got "ask before storing" for cookies, I can see that the
pages that are hanging are hanging before trying to write the pysid
cookie - and that is one of the first things done for my pages.

I'm using sessions to track logins, and on each page I want to print
either "not logged in" or "logged in as:xxx". So for each page, I do:

session = session.Session(req)
if session.has_key('username'):
~    req.write('logged in as %s' % session['username'])
else:
~    req.write('not logged in')

This seems to work fine, apart from when the session hangs, which is
about 1 in 5 page loads. I can't really predict when it will happen, but
~ it is about that often.

cf
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)

iD8DBQFAct6boaQ1/feGlJoRAuBXAKCXOIjfPvLgJJSbBudVs78SMLBscgCeN6+k
642LkiB5O8ZepYfTiJnLuNk=
=poBi
-----END PGP SIGNATURE-----
From grisha at modpython.org  Tue Apr  6 16:46:20 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Tue Apr  6 16:41:56 2004
Subject: [mod_python] session example
In-Reply-To: <4072DD44.3050702@cfconsulting.ca>
References: <1081239182.4072668e638a3@imp5-q.free.fr>
	<20040406101900.X54136@onyx.ispol.com>
	<4072DD44.3050702@cfconsulting.ca>
Message-ID: <20040406164549.C54136@onyx.ispol.com>


Does the browser send the session cookie back to the server correctly?

Grisha

On Tue, 6 Apr 2004, Colin Fox wrote:

> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
>
> Gregory (Grisha) Trubetskoy wrote:
>
> |
> | Also keep in mind that the cookie is set only once - when the session is
> | new. After that there is no need for it, it's the client who has to send
> | the cookie to the server every time, the server does not need to "return"
> | it. So if your session persists over 100 HTTP requests, 1 will have a
> | cookie header, and 99 will not.
> |
> | Grisha
>
> Actually, this is definitely NOT the behaviour I'm seeing. If I delete
> the pysid, and my site, then tell the browser to ask before storing a
> cookie, I can see that every single call to Session() is actually saving
> a new pysid. Plus, every pysid it's writing has a different value.
>
> The path in the cookie is "/", so I don't understand why it would be
> rewriting all the time.
>
> Any ideas?
>
> cf
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v1.2.4 (GNU/Linux)
>
> iD8DBQFAct1EoaQ1/feGlJoRAqQsAJ9i6pX0ZgmfH5oAdJG3SbjjGERWowCfeov/
> R4ZR+5cH09qAQ78UF3j7+BY=
> =nY0O
> -----END PGP SIGNATURE-----
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From cfox at cfconsulting.ca  Tue Apr  6 14:11:54 2004
From: cfox at cfconsulting.ca (Colin Fox)
Date: Tue Apr  6 17:07:28 2004
Subject: [mod_python] session example
In-Reply-To: <20040406164549.C54136@onyx.ispol.com>
References: <1081239182.4072668e638a3@imp5-q.free.fr>
	<1081245722.2679.2.camel@localhost.localdomain>
	<20040406101900.X54136@onyx.ispol.com> <4072DD44.3050702@cfconsulting.ca>
	<20040406164549.C54136@onyx.ispol.com>
Message-ID: <40731D1A.9080703@cfconsulting.ca>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Gregory (Grisha) Trubetskoy wrote:
| Does the browser send the session cookie back to the server correctly?
|
| Grisha

As far as I can tell - I'm using FireFox 0.8 on Linux, which is pretty
standard I believe.

The whole session cookie thing is really unstable - sometimes it works,
sometimes it doesn't, sometimes it just locks up.

For my session-based login, sometimes my login is successfull, I record
the username into the session, and my next page says "logged in as
cfox". Other times, I log in, with no errors, and the next page still
says "not logged in".

cf
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)

iD8DBQFAcx0ZoaQ1/feGlJoRAuLYAJ4t4K66QKKaDV4zRdt/JijAj5WBBwCgknb6
7odZUv9w+MV4r/maEb4ZvZk=
=dYR1
-----END PGP SIGNATURE-----
From michael at dynamine.net  Tue Apr  6 14:43:18 2004
From: michael at dynamine.net (Michael S. Fischer)
Date: Tue Apr  6 17:38:44 2004
Subject: [mod_python] session example
In-Reply-To: <40731D1A.9080703@cfconsulting.ca>
Message-ID: <20040406214309.54F993118D0@attrition.dynamine.net>

Colin Fox writes:

> As far as I can tell - I'm using FireFox 0.8 on Linux, which 
> is pretty standard I believe.

Consider installing the "Live HTTP headers" extension; it will help you
debug the problem.  http://livehttpheaders.mozdev.org/
 
> The whole session cookie thing is really unstable - sometimes 
> it works, sometimes it doesn't, sometimes it just locks up.
> 
> For my session-based login, sometimes my login is 
> successfull, I record the username into the session, and my 
> next page says "logged in as cfox". Other times, I log in, 
> with no errors, and the next page still says "not logged in".

Depending on the process model in which you're running Apache, consider
running the server without forking (single-process, single-thread) to see if
you can reproduce the problem.  

The following configuration values assume the MPM model is in use:

StartServers 1
MinSpareServers 0
MaxSpareServers 0
MaxClients 1

--Michael

From cfox at cfconsulting.ca  Tue Apr  6 15:19:27 2004
From: cfox at cfconsulting.ca (Colin Fox)
Date: Tue Apr  6 18:15:03 2004
Subject: [mod_python] session example
In-Reply-To: <20040406214309.54F993118D0@attrition.dynamine.net>
References: <20040406214309.54F993118D0@attrition.dynamine.net>
Message-ID: <40732CEF.6030202@cfconsulting.ca>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Michael S. Fischer wrote:
| Colin Fox writes:
|
|
|>As far as I can tell - I'm using FireFox 0.8 on Linux, which
|>is pretty standard I believe.
|
|
| Consider installing the "Live HTTP headers" extension; it will help you
| debug the problem.  http://livehttpheaders.mozdev.org/
|

I'll give that a shot, thanks.

|
|>The whole session cookie thing is really unstable - sometimes
|>it works, sometimes it doesn't, sometimes it just locks up.
|>
|>For my session-based login, sometimes my login is
|>successfull, I record the username into the session, and my
|>next page says "logged in as cfox". Other times, I log in,
|>with no errors, and the next page still says "not logged in".
|
|
| Depending on the process model in which you're running Apache, consider
| running the server without forking (single-process, single-thread) to
see if
| you can reproduce the problem.
|
| The following configuration values assume the MPM model is in use:
|
| StartServers 1
| MinSpareServers 0
| MaxSpareServers 0
| MaxClients 1

Ok, I'll try that, too.

Incidentally, I've got MaxRequestsPerChild set to 1, so that when I
change my files apache will actually reload them rather than cache them.

Is that a possible issue?

cf

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)

iD8DBQFAcyzvoaQ1/feGlJoRAuONAJ0RrQlOpGyniBgZDhRpytEA+2rj/ACghBDT
KEGeOxjFy+dFA3AKTmC4F5w=
=/1n6
-----END PGP SIGNATURE-----
From grisha at modpython.org  Tue Apr  6 22:51:02 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Tue Apr  6 22:46:36 2004
Subject: [mod_python] session example
In-Reply-To: <40732CEF.6030202@cfconsulting.ca>
References: <20040406214309.54F993118D0@attrition.dynamine.net>
 <40732CEF.6030202@cfconsulting.ca>
Message-ID: <20040406224613.C64693@onyx.ispol.com>



On Tue, 6 Apr 2004, Colin Fox wrote:

> Incidentally, I've got MaxRequestsPerChild set to 1, so that when I
> change my files apache will actually reload them rather than cache them.
>
> Is that a possible issue?

It could be, because Apache will terminate a child whose life is over,
but it's impossible to tell without knowing the details of your program.

One thing you may try as an experiment is to disable session locking
(Session(lock=0)). It will still use locking for access to the DBM, but it
won't lock individual sessions.

Grisha
From cfox at cfconsulting.ca  Tue Apr  6 23:35:36 2004
From: cfox at cfconsulting.ca (Colin Fox)
Date: Wed Apr  7 02:31:13 2004
Subject: [mod_python] session example
In-Reply-To: <20040406224613.C64693@onyx.ispol.com>
References: <20040406214309.54F993118D0@attrition.dynamine.net>
	<40732CEF.6030202@cfconsulting.ca> <20040406224613.C64693@onyx.ispol.com>
Message-ID: <4073A138.7040409@cfconsulting.ca>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Gregory (Grisha) Trubetskoy wrote:
|
| On Tue, 6 Apr 2004, Colin Fox wrote:
|
|
|>Incidentally, I've got MaxRequestsPerChild set to 1, so that when I
|>change my files apache will actually reload them rather than cache them.
|>
|>Is that a possible issue?
|
|
| It could be, because Apache will terminate a child whose life is over,
| but it's impossible to tell without knowing the details of your program.
|
| One thing you may try as an experiment is to disable session locking
| (Session(lock=0)). It will still use locking for access to the DBM, but it
| won't lock individual sessions.
|
| Grisha

Thanks! I did that, and it seems that solved my locking issue. Now my
site is nice and snappy everywhere.

The question now is - what are the implications of turning off the lock?

On a related note - I'd like to create my own Session subclass,
DBSession, which would record session info into a postgres database. I'd
like to do this so that I could set up a server farm, and share the
session data across multiple machines.

Is this realistic, or are there other issues that I would stumble over?

cf

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)

iD8DBQFAc6E4oaQ1/feGlJoRAoRXAJ9nwOAlrsaCk6ZaIXho+4OKCEmKiQCfe9Fu
gPwU81J/YvhBp0R9NGavVRs=
=755G
-----END PGP SIGNATURE-----
From Vincent.Raaijmakers at ge.com  Wed Apr  7 10:17:15 2004
From: Vincent.Raaijmakers at ge.com (Raaijmakers, Vincent (GE Infrastructure))
Date: Wed Apr  7 11:14:09 2004
Subject: [mod_python] newbie: data length 
Message-ID: <971323274247EB44B9A01D0A3B424C85080F527A@FTWMLVEM02.e2k.ad.ge.com>

Looking for the recipe of multipart data stream please give me the answer to this question:

If I sniff on my network to see what actual bytes are being send to the client after a 
seq.write("hello world") from my very simple application, I see:
62 0a 0d  68 65 6c 6c 6f 20 77 6f 72 6c 64 0a 0d

So, the part that I would like to know is why I see the *62* 0a 0d on front of my byte array in every seq.write()? 

I underdstand that data length is required, but for every write?
Is that a w3 convention? I can't find this in the documentation on the web. Tried to Google as well, perhaps missed the correct key words.

If you don't want to see that 'length lfcr' in your byte array, what is it what you need to do?
Reason I would like to see this is to keep a session open and keep on streaming to the client. 
So, repeat the write until done. 

Apologize if this is a too newbie in web land question...

Vincent


-----Original Message-----
From: mod_python-bounces@modpython.org
[mailto:mod_python-bounces@modpython.org]On Behalf Of Colin Fox
Sent: Tuesday, April 06, 2004 12:45 PM
To: mod_python@modpython.org
Subject: [mod_python] Sessions blocking...


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1


I've still got the problem where using sessions causes my pages to hang.

Now that I've got "ask before storing" for cookies, I can see that the
pages that are hanging are hanging before trying to write the pysid
cookie - and that is one of the first things done for my pages.

I'm using sessions to track logins, and on each page I want to print
either "not logged in" or "logged in as:xxx". So for each page, I do:

session = session.Session(req)
if session.has_key('username'):
~    req.write('logged in as %s' % session['username'])
else:
~    req.write('not logged in')

This seems to work fine, apart from when the session hangs, which is
about 1 in 5 page loads. I can't really predict when it will happen, but
~ it is about that often.

cf
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)

iD8DBQFAct6boaQ1/feGlJoRAuBXAKCXOIjfPvLgJJSbBudVs78SMLBscgCeN6+k
642LkiB5O8ZepYfTiJnLuNk=
=poBi
-----END PGP SIGNATURE-----
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python

From evert_carton at yahoo.co.uk  Thu Apr  8 06:42:36 2004
From: evert_carton at yahoo.co.uk (Evert Carton)
Date: Thu Apr  8 00:40:26 2004
Subject: [mod_python] subrequests
Message-ID: <1081399355.13469.62.camel@localhost>

Hi All,

Granted, kind of newbie, but already heavily impressed by mod_python, so
I won't let it go ;-)

As the header indicates, this is about subrequests. Using 3.1.3 on
Apache 2.0.48

I want to make a subrequest in mod_python. I got a feeling this is not
implemented, yet the documentation states that req.main should point to
the main request in case I'm in a subrequest. 
I know it can be done straight in Apache using the C-API, but then
again, I'm no C-guru. 
I skimmed through the mod_python sources, attempted to make my own
implementation of a sub_request, but then again, I'm no C-guru ...

Basically, what I want to do, is issue a subrequest, and do something on
the "result" of that data. I tried whatever trickery using
internal_redirect (since that's all I could find), but it doesn't do the
trick, or I haven't found the "right" kludgery ;-)

I couldn't get it working using add_handler either. Been thinking about
working through the filters, but that seems way far off.

I can continue looking for it, but is there a standard, elegant way to
achieve what I want. 

Thx,
Evert

From mod_python at 24ksoftware.com  Wed Apr  7 23:24:54 2004
From: mod_python at 24ksoftware.com (Erik Stephens)
Date: Thu Apr  8 02:20:26 2004
Subject: [mod_python] subrequests
In-Reply-To: <1081399355.13469.62.camel@localhost>
References: <1081399355.13469.62.camel@localhost>
Message-ID: <Pine.LNX.4.58.0404072320310.7990@localhost>

On Thu, 8 Apr 2004, Evert Carton wrote:

> Basically, what I want to do, is issue a subrequest, and do
> something on the "result" of that data. I tried whatever trickery
> using internal_redirect (since that's all I could find), but it
> doesn't do the trick, or I haven't found the "right" kludgery ;-)

I'm pretty dumb when it comes to the apache API.  What would a sub
request like the API suggests buy you over just using standard python
modules like urllib or httplib?


Best regards,
Erik

From modpython at maya.com  Thu Apr  8 16:30:19 2004
From: modpython at maya.com (Seung Chan Lim)
Date: Thu Apr  8 16:25:51 2004
Subject: [mod_python] PythonAutoReload troubleshooting
References: <52DC70C1C1575C418CB033523A29CF141048EF@exchange2000.manord.com>
	<20031015095146.T19523@onyx.ispol.com>
Message-ID: <0c6601c41da8$4f951ca0$95fe46c0@GIRLS>

Hi, I have set PythonAutoReload to Off in my config file

yet in my apache error log I keep seeing the

[notice] mod_python: (Re)importing module '<<module name here>>'

where <<module name here>> is my module over and over again each time
I click on a link

is this because apache is forking up processes each time?

If so, do I have any control over how many process get forked?

thanks
From modpython at maya.com  Thu Apr  8 16:30:24 2004
From: modpython at maya.com (Seung Chan Lim)
Date: Thu Apr  8 16:25:56 2004
Subject: [mod_python] PythonAutoReload troubleshooting
References: <52DC70C1C1575C418CB033523A29CF141048EF@exchange2000.manord.com>
	<20031015095146.T19523@onyx.ispol.com>
Message-ID: <0c6701c41da8$5239d6d0$95fe46c0@GIRLS>

Hi, I have set PythonAutoReload to Off in my config file

yet in my apache error log I keep seeing the

[notice] mod_python: (Re)importing module '<<module name here>>'

where <<module name here>> is my module over and over again each time
I click on a link

is this because apache is forking up processes each time?

If so, do I have any control over how many process get forked?

thanks
From modpython at maya.com  Thu Apr  8 16:31:14 2004
From: modpython at maya.com (ModPython)
Date: Thu Apr  8 16:26:47 2004
Subject: [mod_python] PythonAutoReload troubleshooting
References: <52DC70C1C1575C418CB033523A29CF141048EF@exchange2000.manord.com>
	<20031015095146.T19523@onyx.ispol.com>
Message-ID: <0c6801c41da8$707da450$95fe46c0@GIRLS>

Hi, I have set PythonAutoReload to Off in my config file

yet in my apache error log I keep seeing the

[notice] mod_python: (Re)importing module '<<module name here>>'

where <<module name here>> is my module over and over again each time
I click on a link

is this because apache is forking up processes each time?

If so, do I have any control over how many process get forked?

thanks
From modpython at maya.com  Thu Apr  8 16:31:54 2004
From: modpython at maya.com (ModPython)
Date: Thu Apr  8 16:27:26 2004
Subject: [mod_python] subrequests
References: <1081399355.13469.62.camel@localhost>
	<Pine.LNX.4.58.0404072320310.7990@localhost>
Message-ID: <0c7401c41da8$87d4d4c0$95fe46c0@GIRLS>

Hi, I have set PythonAutoReload to Off in my config file

yet in my apache error log I keep seeing the

[notice] mod_python: (Re)importing module '<<module name here>>'

where <<module name here>> is my module over and over again each time
I click on a link

is this because apache is forking up processes each time?

If so, do I have any control over how many process get forked?

thanks
From modpython at maya.com  Thu Apr  8 16:32:12 2004
From: modpython at maya.com (ModPython)
Date: Thu Apr  8 16:27:45 2004
Subject: [mod_python] PythonAutoReload trouble shooting
References: <1081399355.13469.62.camel@localhost>
	<Pine.LNX.4.58.0404072320310.7990@localhost>
Message-ID: <0c7701c41da8$92dd3ba0$95fe46c0@GIRLS>

Hi, I have set PythonAutoReload to Off in my config file

yet in my apache error log I keep seeing the

[notice] mod_python: (Re)importing module '<<module name here>>'

where <<module name here>> is my module over and over again each time
I click on a link

is this because apache is forking up processes each time?

If so, do I have any control over how many process get forked?

thanks
From modpython at maya.com  Thu Apr  8 16:41:38 2004
From: modpython at maya.com (ModPython)
Date: Thu Apr  8 16:37:12 2004
Subject: Oops Sorry for the flood ( Re: [mod_python] PythonAutoReload
	troubleshooting )
References: 
	<52DC70C1C1575C418CB033523A29CF141048EF@exchange2000.manord.com><20031015095146.T19523@onyx.ispol.com>
	<0c6801c41da8$707da450$95fe46c0@GIRLS>
Message-ID: <0c9501c41da9$e42190a0$95fe46c0@GIRLS>

I didn't mean to flood the board, it looks like my mail program went on a
crazy rampage posting multiple copies

my apologies,

From recursive68 at hotmail.com  Fri Apr  9 14:15:33 2004
From: recursive68 at hotmail.com (bob smith)
Date: Fri Apr  9 10:22:33 2004
Subject: [mod_python] dumb question
Message-ID: <Law10-F77Yf1U8AVIBs0003df6b@hotmail.com>

As newbie to mod_python I believe  I am missing something rather fundemental 
about the way in which it works. I've a script with handler function which 
has a number conditional statements, which depending upon user input return 
different output, i.e successful login, unsuccessful login, home page. The 
thing that is really puzzling me is that a user will login successfully, 
both the initial screen 'enter login details' is still displayed and 
together with the new screen, which appears to be appended onto the initial 
screen. It doesn't appear to conditional logic error, it's almost as if the 
latest output is being appended to the former input and the whole lot is 
being sent rather than just the required output. Any ideas ?

_________________________________________________________________
It's fast, it's easy and it's free. Get MSN Messenger today! 
http://www.msn.co.uk/messenger

From recursive68 at hotmail.com  Fri Apr  9 17:58:12 2004
From: recursive68 at hotmail.com (bob smith)
Date: Fri Apr  9 13:53:50 2004
Subject: [mod_python] dumb question
Message-ID: <Law10-F90t26MEENTX30003e478@hotmail.com>

It appears to be my conditional statement logic after all ...

_________________________________________________________________
Express yourself with cool new emoticons http://www.msn.co.uk/specials/myemo

From cfox at cfconsulting.ca  Fri Apr  9 12:53:49 2004
From: cfox at cfconsulting.ca (Colin Fox)
Date: Fri Apr  9 15:49:27 2004
Subject: [mod_python] Disabling session locks
Message-ID: <4076FF4D.5060400@cfconsulting.ca>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1


Hi, all.

I had a session lock contention problem that Grisha helped me with, by
suggesting that when I create a session I say "lock=0".

My site now no longer has any lock contention, but I'm wondering exactly
what problems I'm open to by doing this?

Anyone know? What exactly does turning locks off do?

cf

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)

iD8DBQFAdv9NoaQ1/feGlJoRAusXAKCGa8QSjUKTiyfLmTCZ37YoMaZZqQCeNTbk
nva4cGLWvqCLv+wsg6Bv0fg=
=CWMy
-----END PGP SIGNATURE-----
From lists at webcrunchers.com  Sat Apr 10 15:52:26 2004
From: lists at webcrunchers.com (John Draper)
Date: Sat Apr 10 18:48:01 2004
Subject: [mod_python] 
Message-ID: <BCD1CCDB-8B41-11D8-ADFF-003065477776@webcrunchers.com>

Ok,

I think I finally got Apache started with Mod Python,  so now I'm 
following the instructions
for testing.

 >At this time, if you made changes to the main configuration file, you 
will need to restart Apache in order for the changes to take effect.

Ok,   I've done that.

 >4.	Edit mptest.py file in the htdocs/test directory so that is has the 
following lines (be careful when cutting and >pasting from your 
browser, you may end up with incorrect indentation and a syntax error):




 >    from mod_python import apache

 >    def handler(req):
 >        req.write("Hello World!")
 >        return apache.OK

Ok - I've done that,  and saved it into cgi-bin/test directory.

 >5.	Point your browser to the URL referring to the mptest.py; you 
should see "Hello World!". If you didn't - refer to the troubleshooting 
section next.

Ok,  I tried:

http://192.168.0.20/mptest       			- Not found
http://192.168.0.20/mptest.py    			- Not found
http://192.168.0.20/cgi-bin/test/mptest  	- Not found
http://192.168.0.20/cgi-bin/test/mptest.py  - Not found

Ok,  so what IS the url if it isn't any one of these.....  COME ON 
MAN....    this documentation sucks
it says "Point your browser to the URL referring to the mptest.py" but 
fails to specify what the URL
really IS....   So how are WE to know this?

I get this back on the browser screen...

Not Found

The requested URL /cgi-bin/test/mptest.py was not found on this server.
------------------------------------------------------------------------
Apache/2.0.49 (Unix) mod_python/3.1.3 Python/2.2.1 mod_ssl/2.0.49 
OpenSSL/0.9.7b Server at 192.168.0.20 Port 80

Does this mean the Mod_Python actually works and I just haven't figured 
out what the bloody URL is?
Or is there something wrong with the script.   I DID check it for 
proper indentation of course.

Again,  please send your reply to crunch at shopip dot com

John

From list+mod_python at joreybump.com  Sat Apr 10 20:33:01 2004
From: list+mod_python at joreybump.com (Jorey Bump)
Date: Sat Apr 10 20:28:29 2004
Subject: [mod_python]
In-Reply-To: <BCD1CCDB-8B41-11D8-ADFF-003065477776@webcrunchers.com>
References: <BCD1CCDB-8B41-11D8-ADFF-003065477776@webcrunchers.com>
Message-ID: <4078923D.60704@joreybump.com>

John Draper wrote:

>  >4.    Edit mptest.py file in the htdocs/test directory so that is has 
> the following lines (be careful when cutting and >pasting from your 
> browser, you may end up with incorrect indentation and a syntax error):
> 
>  >    from mod_python import apache
> 
>  >    def handler(req):
>  >        req.write("Hello World!")
>  >        return apache.OK
> 
> Ok - I've done that,  and saved it into cgi-bin/test directory.

Don't do that, it's not CGI.

>  >5.    Point your browser to the URL referring to the mptest.py; you 
> should see "Hello World!". If you didn't - refer to the troubleshooting 
> section next.
> 
> Ok,  I tried:
> 
> http://192.168.0.20/mptest                   - Not found
> http://192.168.0.20/mptest.py                - Not found
> http://192.168.0.20/cgi-bin/test/mptest      - Not found
> http://192.168.0.20/cgi-bin/test/mptest.py  - Not found
> 
> Ok,  so what IS the url if it isn't any one of these.....  COME ON 
> MAN....    this documentation sucks
> it says "Point your browser to the URL referring to the mptest.py" but 
> fails to specify what the URL
> really IS....   So how are WE to know this?

There is no universal apache directory layout. Only you know the valid
paths for your web site files. Try an easier test:

Open httpd.conf (wherever you keep it). Look for your DocumentRoot. It
might look something like this:

  DocumentRoot "/var/www/html"

That means that your homepage would be /var/www/html/index.html, or
something similar. Add this to httpd.conf, but use your own DocumentRoot:

  <Directory /var/www/html>
    AddHandler python-program .py
    PythonHandler mod_python.publisher
    PythonDebug On
  </Directory>

Save httpd.conf, and move to your DocumentRoot:

  cd /var/www/html

Create a file called example.py in your favorite text editor. Put only
these lines in it:

  def hello(req):
      x = "Hello, world!"
      return x

Restart apache. Point your browser at:

  http://192.168.0.20/example.py/hello

Note that with this configuration, you can put somefile.py almost
anywhere in your site, and mod_python will handle it. There are other
gotchas, as well, and I'm sure you'll encounter them.

To avoid some of the pitfalls, I recommend that you strive to name your
functions and variables uniquely (they share an interpreter), and simply
import entire modules (don't use "from somemodule import something").
This means you'll have to use somemodule.somefunction() syntax, but it
will protect you from errors that don't occur as readily with CGI. More
experienced pythonistas are better able to explain the pros/cons of
this, and provide other tips to avoid name clashes under mod_python.

Good luck!






From core at bokeoa.com  Sun Apr 11 15:42:19 2004
From: core at bokeoa.com (Charles Stevenson)
Date: Sun Apr 11 17:38:09 2004
Subject: [mod_python] send_http_header question
Message-ID: <20040411214219.GA6586@bokeoa.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hi all,

I've noticed a discrepancy in the documentation between versions 2.x and
3.x in that the later doesn't have req.send_http_header(). Is this done
by default in 3.x or is this a minor bug in the documentation?

http://www.modpython.org/live/mod_python-2.7.8/doc-html/tut-what-it-do.html

  req.content_type = "text/plain"
  req.send_http_header()
  req.write("Hello World!")

http://www.modpython.org/live/current/doc-html/tut-what-it-do.html

  req.content_type = "text/plain"
  req.write("Hello World!")

I ran across this trying to get a bit of code that apparently works with
3.x to work with 2.7.x which didn't call req.send_http_header() and
therefore most browsers just sort of sit there patiently waiting.

Best Regards,
Charles Stevenson

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)

iD8DBQFAebu7GAuLrxOyeJMRAvJSAJ0XjNvfObhKWreizOU+eddcpdYjLACeMljE
vYWD5eA/MIGaRHkptEcbWiU=
=vFCA
-----END PGP SIGNATURE-----
From mudd at vex.net  Mon Apr 12 00:39:15 2004
From: mudd at vex.net (John Mudd)
Date: Mon Apr 12 00:35:06 2004
Subject: [mod_python] CGI versus *real* mod_python?
In-Reply-To: <4078923D.60704@joreybump.com>
References: <BCD1CCDB-8B41-11D8-ADFF-003065477776@webcrunchers.com>
	 <4078923D.60704@joreybump.com>
Message-ID: <1081744754.2680.109.camel@localhost.localdomain>

So this is CGI?  I'm afraid this is what I've been doing too. 

    from mod_python import apache
    def handler(req):
        req.write("Hello World!")
        return apache.OK



I switched my Apache httpd.conf file as you suggested and now I can do
this.  

    def hello(req):
        return 'Hello world!'

This example is much simpler.  But the couple of extra lines of code
doesn't make much difference in my full application.  Are there other
benefits to this approach that aren't so obvious?

    

On Sat, 2004-04-10 at 20:33, Jorey Bump wrote:
> John Draper wrote:
> 
> >  >4.    Edit mptest.py file in the htdocs/test directory so that is has 
> > the following lines (be careful when cutting and >pasting from your 
> > browser, you may end up with incorrect indentation and a syntax error):
> > 
> >  >    from mod_python import apache
> > 
> >  >    def handler(req):
> >  >        req.write("Hello World!")
> >  >        return apache.OK
> > 
> > Ok - I've done that,  and saved it into cgi-bin/test directory.
> 
> Don't do that, it's not CGI.
> 


From mod_python at 24ksoftware.com  Sun Apr 11 22:53:31 2004
From: mod_python at 24ksoftware.com (Erik Stephens)
Date: Mon Apr 12 01:49:07 2004
Subject: [mod_python] CGI versus *real* mod_python?
In-Reply-To: <1081744754.2680.109.camel@localhost.localdomain>
References: <BCD1CCDB-8B41-11D8-ADFF-003065477776@webcrunchers.com> 
	<1081744754.2680.109.camel@localhost.localdomain>
Message-ID: <Pine.LNX.4.58.0404112249070.575@localhost>

On Sun, 12 Apr 2004, John Mudd wrote:

> On Sat, 2004-04-10 at 20:33, Jorey Bump wrote:
> > John Draper wrote:
> >
> > > Ok - I've done that,  and saved it into cgi-bin/test directory.
> >
> > Don't do that, it's not CGI.
>
> So this is CGI?  I'm afraid this is what I've been doing too.
>
>     from mod_python import apache
>     def handler(req):
>         req.write("Hello World!")
>         return apache.OK

No, what you have there will use mod_python.  What Jorey was trying to
get at (I think) was that maybe all of the files in /cgi-bin will be
treated as CGIs since that is a common web server configuration.


Best regards,
Erik

From core at bokeoa.com  Mon Apr 12 05:33:47 2004
From: core at bokeoa.com (Charles Stevenson)
Date: Mon Apr 12 07:29:39 2004
Subject: [mod_python] CGI versus *real* mod_python?
In-Reply-To: <Pine.LNX.4.58.0404112249070.575@localhost>
References: <BCD1CCDB-8B41-11D8-ADFF-003065477776@webcrunchers.com>
	<1081744754.2680.109.camel@localhost.localdomain>
	<Pine.LNX.4.58.0404112249070.575@localhost>
Message-ID: <20040412113347.GB6972@bokeoa.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

All,

On Sun, Apr 11, 2004 at 10:53:31PM -0700, Erik Stephens wrote:
> No, what you have there will use mod_python.  What Jorey was trying to
> get at (I think) was that maybe all of the files in /cgi-bin will be
> treated as CGIs since that is a common web server configuration.

Actually I think what he was trying to get at is that mod_python unlike
cgi doesn't require the scripts to reside in any certain directory. You
could for example create /~user/python-bin or something if you didn't
like the idea of intermixing your scripts with your html although I
don't see the point. If you want your scripts to reside in a specific
directory you should add a ptyhon path entry via htaccess so that 
mod_python knows where it might find your modules. I don't think any
server is configured to treat all file within cgi-bin as CGI. The reason
for a separate directory afaik is to restrict the scope of ExecCGI.

Correct me if I'm wrong. :)

Best Regards,
Charles Stevenson

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)

iD8DBQFAen6bGAuLrxOyeJMRAi33AJ9foA9ZXqKXpPc61vojKDP+sMKuggCgphYa
mleo903gHh+xHG3Zo2Bt5j4=
=ITVO
-----END PGP SIGNATURE-----
From list+mod_python at joreybump.com  Mon Apr 12 15:20:24 2004
From: list+mod_python at joreybump.com (Jorey Bump)
Date: Mon Apr 12 15:16:07 2004
Subject: [mod_python] CGI versus *real* mod_python?
In-Reply-To: <20040412113347.GB6972@bokeoa.com>
References: <BCD1CCDB-8B41-11D8-ADFF-003065477776@webcrunchers.com>
	<1081744754.2680.109.camel@localhost.localdomain>
	<Pine.LNX.4.58.0404112249070.575@localhost> <20040412113347.GB6972@bokeoa.com>
Message-ID: <407AEBF8.80704@joreybump.com>

Charles Stevenson wrote:

> On Sun, Apr 11, 2004 at 10:53:31PM -0700, Erik Stephens wrote:
> 
>>No, what you have there will use mod_python.  What Jorey was trying to
>>get at (I think) was that maybe all of the files in /cgi-bin will be
>>treated as CGIs since that is a common web server configuration.

True.

> Actually I think what he was trying to get at is that mod_python unlike
> cgi doesn't require the scripts to reside in any certain directory. 

Also true. When someone mentions cgi-bin, it's a flag that there might
be misconceptions (or misconfigurations) at play.

> You
> could for example create /~user/python-bin or something if you didn't
> like the idea of intermixing your scripts with your html although I
> don't see the point. If you want your scripts to reside in a specific
> directory you should add a ptyhon path entry via htaccess so that 
> mod_python knows where it might find your modules. 

Although I rarely do it, sometimes it's helpful to put code in a
separate, aliased directory to protect it from designers and their
"intelligent" web development suites. Also, I doubt if many are
preconfigured to transfer .py files in ASCII mode.

> I don't think any
> server is configured to treat all file within cgi-bin as CGI. The reason
> for a separate directory afaik is to restrict the scope of ExecCGI.
> 
> Correct me if I'm wrong. :)

It depends on how you configure your web server. I almost always use a
ScriptAlias with apache, which *does* treat every file in the directory
as CGI. However, you may want all of your application files to reside in
one directory, and ExecCGI allows you to that.




From stietke at diw.de  Tue Apr 13 12:55:34 2004
From: stietke at diw.de (stietke@diw.de)
Date: Tue Apr 13 06:51:16 2004
Subject: [mod_python] memory leak in mod_python?
Message-ID: <41390.62.224.4.2.1081853734.squirrel@webmail.diw-berlin.de>

Hi guys,

thank you for this extremely cool piece of software. I am very
happy with it. However there is one little problem I encountered
while playing with it. On my computer, the apache process seems
to leak memory when used with mod_python in certain configurations.

In particular, it seems to leak memory when I use PythonOption
directives in a <Directory>...</Directory> context.

I tried to figure out where the memory disapears using valgrind,
but the hundreds of lines valgrind spit out left me rather clueless.

Maybe somebody here has any idea what is going on.

Thank you in advance + all the best,
Stefan


summary:
--------
Some mod_python directives, including PythonOption and PythonInterpreter,
seem to cause apache or mod_python to lose a certain, constant amount
of memory for each request mod_python handles. The number of bytes
lost each request seems to scale with the number of directives used.

The apache process seems to lose memory when the mod_python module
is loaded with a certain configuration, independently of the actual
request beeing handled by mod_python. (see results 6 for details)

versions:
---------
	apache 2.0.49
	mod_python 3.1.3
	python 2.3.3
	linux kernel 2.4.19
	libc6 2.3.1
	debian woody with some updates

apache, python and mod_python are compiled from source.

apache is compiled with prefork mpm to make testing easier (no threads),
but tests with worker mpm showed similar results in earlier tests.

httpd.config:
-------------
$ diff conf/httpd.conf conf/httpd-std.conf
119,122c119,122
< StartServers         1
< MinSpareServers      1
< MaxSpareServers      1
< MaxClients           1
---
> StartServers         5
> MinSpareServers      5
> MaxSpareServers     10
> MaxClients         150
219c219
< Listen 127.0.0.1:10080
---
> Listen 80
233d232
< LoadModule python_module
/home/stefan/apache_test/apache_prefork/modules/mod_python.so
362,372d360
<     #
<     # mod_python
<     #
<     AddHandler mod_python .py
<     PythonHandler testdummy
<     #PythonInterpreter pylet_interp
<     #PythonDebug On
<     #PythonOption x a
<     #PythonOption y b
<     #PythonOption z c
<
493c481
< LogLevel debug
---
> LogLevel warn

mod_python handler:
-------------------
$ cat testdummy.py
def handler(req):
        return 0

testprocedure:
--------------
1) warm up: ../apache/bin/ab -n 50000 -k http://localhost:10080/test.py

2) test: cat /proc/2315/status > httpd_status.txt;
	 for x in 1 2 3 4 5; do
		../apache/bin/ab -n 100000 -k http://localhost:10080/test.py;
		cat /proc/2315/status >> httpd_status.txt;
	 done

3) see if the worker process grows in size: grep VmSize: httpd_status.txt

results:
--------
1) with the mod_python configuration from above, no growth.
2) with the line "PythonOption x a" enabled:
	VmSize:     8776 kB
	VmSize:    10348 kB	---> +1572
	VmSize:    11916 kB	---> +1568
	VmSize:    13488 kB	---> +1572
	VmSize:    15056 kB	---> +1568
	VmSize:    16624 kB	---> +1568
   total: ((16624 - 8776) * 1024) / 500000 = 16.07270 bytes/request
3) with the PythonOption replaced with "PythonOption
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"
(that is 100*x and 100*a):
	result: exactly the same as 2).
4) with "PythonOption x a" and "PythonOption y b" enabled:
	VmSize:     9956 kB	---> +3924
	VmSize:    13880 kB	---> +3924
	VmSize:    17804 kB	---> +3924
	VmSize:    21728 kB	---> +3932
	VmSize:    25660 kB	---> +3924
	VmSize:    29584 kB
   total: ((29584 - 9956) * 1024) / 500000 = 40.19814 bytes/request
5) with additionally "PythonOption z c" enabled:
	VmSize:    11532 kB
	VmSize:    18620 kB	---> +7088
	VmSize:    25708 kB	---> +7088
	VmSize:    32792 kB	---> +7084
	VmSize:    39880 kB	---> +7088
	VmSize:    46968 kB	---> +7088
   total: ((46968 - 11532) * 1024) / 500000 = 72.57292 bytes/request
6) with all PythonOptions disabled, but with
   "PythonInterpreter pylet_interp" enabled:
	result: exactly the same as 2).
   BUT: after this test, i ran
   ../apache/bin/ab -n 300000 -k http://localhost:10080/index.html.en
   without restarting apache, and the VmSize grew again to 21328 kB.
   ((21328 - 16624) * 1024) / 300000 = 16.05632
   Apparently, apache loses memory already when the mod_python
   module is loaded but does not handle the request at hand.



From grisha at modpython.org  Tue Apr 13 09:52:08 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Tue Apr 13 09:47:48 2004
Subject: [mod_python] memory leak in mod_python?
In-Reply-To: <41390.62.224.4.2.1081853734.squirrel@webmail.diw-berlin.de>
References: <41390.62.224.4.2.1081853734.squirrel@webmail.diw-berlin.de>
Message-ID: <20040413095133.Y86672@onyx.ispol.com>


Thanks for the detailed report, we'll check it out.

Grisha

On Tue, 13 Apr 2004 stietke@diw.de wrote:

> Hi guys,
>
> thank you for this extremely cool piece of software. I am very
> happy with it. However there is one little problem I encountered
> while playing with it. On my computer, the apache process seems
> to leak memory when used with mod_python in certain configurations.
>
> In particular, it seems to leak memory when I use PythonOption
> directives in a <Directory>...</Directory> context.
>
> I tried to figure out where the memory disapears using valgrind,
> but the hundreds of lines valgrind spit out left me rather clueless.
>
> Maybe somebody here has any idea what is going on.
>
> Thank you in advance + all the best,
> Stefan
>
>
> summary:
> --------
> Some mod_python directives, including PythonOption and PythonInterpreter,
> seem to cause apache or mod_python to lose a certain, constant amount
> of memory for each request mod_python handles. The number of bytes
> lost each request seems to scale with the number of directives used.
>
> The apache process seems to lose memory when the mod_python module
> is loaded with a certain configuration, independently of the actual
> request beeing handled by mod_python. (see results 6 for details)
>
> versions:
> ---------
> 	apache 2.0.49
> 	mod_python 3.1.3
> 	python 2.3.3
> 	linux kernel 2.4.19
> 	libc6 2.3.1
> 	debian woody with some updates
>
> apache, python and mod_python are compiled from source.
>
> apache is compiled with prefork mpm to make testing easier (no threads),
> but tests with worker mpm showed similar results in earlier tests.
>
> httpd.config:
> -------------
> $ diff conf/httpd.conf conf/httpd-std.conf
> 119,122c119,122
> < StartServers         1
> < MinSpareServers      1
> < MaxSpareServers      1
> < MaxClients           1
> ---
> > StartServers         5
> > MinSpareServers      5
> > MaxSpareServers     10
> > MaxClients         150
> 219c219
> < Listen 127.0.0.1:10080
> ---
> > Listen 80
> 233d232
> < LoadModule python_module
> /home/stefan/apache_test/apache_prefork/modules/mod_python.so
> 362,372d360
> <     #
> <     # mod_python
> <     #
> <     AddHandler mod_python .py
> <     PythonHandler testdummy
> <     #PythonInterpreter pylet_interp
> <     #PythonDebug On
> <     #PythonOption x a
> <     #PythonOption y b
> <     #PythonOption z c
> <
> 493c481
> < LogLevel debug
> ---
> > LogLevel warn
>
> mod_python handler:
> -------------------
> $ cat testdummy.py
> def handler(req):
>         return 0
>
> testprocedure:
> --------------
> 1) warm up: ../apache/bin/ab -n 50000 -k http://localhost:10080/test.py
>
> 2) test: cat /proc/2315/status > httpd_status.txt;
> 	 for x in 1 2 3 4 5; do
> 		../apache/bin/ab -n 100000 -k http://localhost:10080/test.py;
> 		cat /proc/2315/status >> httpd_status.txt;
> 	 done
>
> 3) see if the worker process grows in size: grep VmSize: httpd_status.txt
>
> results:
> --------
> 1) with the mod_python configuration from above, no growth.
> 2) with the line "PythonOption x a" enabled:
> 	VmSize:     8776 kB
> 	VmSize:    10348 kB	---> +1572
> 	VmSize:    11916 kB	---> +1568
> 	VmSize:    13488 kB	---> +1572
> 	VmSize:    15056 kB	---> +1568
> 	VmSize:    16624 kB	---> +1568
>    total: ((16624 - 8776) * 1024) / 500000 = 16.07270 bytes/request
> 3) with the PythonOption replaced with "PythonOption
> xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
> aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"
> (that is 100*x and 100*a):
> 	result: exactly the same as 2).
> 4) with "PythonOption x a" and "PythonOption y b" enabled:
> 	VmSize:     9956 kB	---> +3924
> 	VmSize:    13880 kB	---> +3924
> 	VmSize:    17804 kB	---> +3924
> 	VmSize:    21728 kB	---> +3932
> 	VmSize:    25660 kB	---> +3924
> 	VmSize:    29584 kB
>    total: ((29584 - 9956) * 1024) / 500000 = 40.19814 bytes/request
> 5) with additionally "PythonOption z c" enabled:
> 	VmSize:    11532 kB
> 	VmSize:    18620 kB	---> +7088
> 	VmSize:    25708 kB	---> +7088
> 	VmSize:    32792 kB	---> +7084
> 	VmSize:    39880 kB	---> +7088
> 	VmSize:    46968 kB	---> +7088
>    total: ((46968 - 11532) * 1024) / 500000 = 72.57292 bytes/request
> 6) with all PythonOptions disabled, but with
>    "PythonInterpreter pylet_interp" enabled:
> 	result: exactly the same as 2).
>    BUT: after this test, i ran
>    ../apache/bin/ab -n 300000 -k http://localhost:10080/index.html.en
>    without restarting apache, and the VmSize grew again to 21328 kB.
>    ((21328 - 16624) * 1024) / 300000 = 16.05632
>    Apparently, apache loses memory already when the mod_python
>    module is loaded but does not handle the request at hand.
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From opera7 at gmx.net  Tue Apr 13 20:57:27 2004
From: opera7 at gmx.net (opera7)
Date: Tue Apr 13 13:52:39 2004
Subject: [mod_python] 
	mod_python 2.xx for Apache 1.3.x + Python 2.3.x on Win32 ?
Message-ID: <6833992015.20040413205727@gmx.net>

		Hello pythoneers,

1) Any chance to have compiled mod_python for Apache 1.3.xx(preferable 1.3.19) for Windows / Python 2.3 (2.2 as a last resort)?

( Our current Windows2000AS + Apache/2.0.48 (Win32) mod_python/3.1.2b Python/2.3.2 + Quixote0.7 intranet application works fine, but our bosses forces us to use Apache 1.3.19 because another product, BusinessObject's WebIntelligence, "not sertified with Apache2" )




2) Can I download this mail-list archives for 2002-2004 years?
  

-- 
Best regards,
 Dmitry                         mailto:opera7@gmx.net
  

From jhouchin at cableone.net  Tue Apr 13 22:43:51 2004
From: jhouchin at cableone.net (Jimmie Houchin)
Date: Tue Apr 13 23:37:57 2004
Subject: [mod_python] Problem with config
Message-ID: <407CB377.5080708@cableone.net>

Hello,

I am trying to give mod_python at try.

I am running Gentoo Linux. Apache outputs this on an error page.
This is just info not the problem.
Apache/2.0.49 (Gentoo/Linux) mod_python/3.1.3 Python/2.3.3 mod_scgi/1.1 
Server at localhost Port 80

I have mptest.py as:

from mod_python import apache

def handler(req):
	req.write("Hello World!")
	return apache.OK

mod_python part of my apache2.conf file

<Directory /var/www/python>
	AddHandler mod_python .py
	PythonHandler mptest
	PythonDebug On
</Directory>

When I go to http://localhost/python/mptest.py
It simply reads the file giving me the text of the file instead of 
executing the file and giving me "Hello World!".

I know I am probably doing some stupid newbie trick.
I have looked and looked through list archives.

Any help greatly appreciated.

Jimmie Houchin
From jlh at cox.net  Tue Apr 13 22:50:08 2004
From: jlh at cox.net (Jeff Hinrichs)
Date: Tue Apr 13 23:42:59 2004
Subject: [mod_python] mod_python.publisher weirdness
Message-ID: <03f501c421d3$94a31bb0$6702a8c0@gato>

mod_python: 3.1.3
OS: FreeBSD 4.9 Stable
Apache: Apache/2.0.49 (Unix) mod_python/3.1.3 Python/2.3.3

httpd.conf:
<Directory "/usr/local/www/data/mrt">
    SetHandler mod_python
    PythonHandler mod_python.publisher
    PythonDebug On
</Directory>
<Directory "/usr/local/www/data/mrtJDB">
    SetHandler mod_python
    PythonHandler mod_python.publisher
    PythonDebug On
</Directory>

I have an index.py in each of the two directories.  On both pages a link to
 http://mysite/mrt/  exists.

Events to recreate:
 http://mysite/mrt/
 click on a form to do a post to http://mysite/mrt/xlogon (a method in
/mrt/index.py)
 Edit the URL in the browser to http://mysite/mrtJDB/
 When that page appears click on the link to http://mysite/mrt/

The page reloads and URL says, http://mysite/mrt/ the apache log agrees,
and no errors reported in the error log. However, the page is still the
http://mysite/mrtJDB/ page. If I click on the link 2 or 3 more times then
I get the http://mysite/mrt/ page.

Now things get really silly, if I continue to click on the href that points
to http://mysite/mrt/ I sometimes get the http://mysite/mrtJDB/ page and now
by clicking on the link repeatedly I haphazardly jump back and forth between
the two pages.  It's as if mod_python.publisher is getting confused.

This same occurence will also play out if the directories are arranged as:
http://mysite/mrt/
http://mysite/mrt/mrtJDB/
and making the necessary changes to the apache conf
httpd.conf:
<Directory "/usr/local/www/data/mrt">
    SetHandler mod_python
    PythonHandler mod_python.publisher
    PythonDebug On
</Directory>
<Directory "/usr/local/www/data/mrt/mrtJDB">
    SetHandler mod_python
    PythonHandler mod_python.publisher
    PythonDebug On
</Directory>
 and restarting apache.

I've tried from Moz 1.7, FireFox 0.8, and IE6
I've dumped caches and turned on forced reloads
I've put pragma no-cache and page expirations in the meta tags
I've tried req.headers_out.add("Cache-Control:","no-cache")
and req.headers_out.add("Pragma:","no-cache")

I'm at a loss and googled myself silly.

I must be doing something very wrong but I'm just not seeing it right now.

help.

Thanks,

Jeff Hinrichs

p.s. "mysite" is just a place holder for the actual webserver name.

From evert_carton at yahoo.co.uk  Wed Apr 14 06:17:30 2004
From: evert_carton at yahoo.co.uk (Evert Carton)
Date: Wed Apr 14 00:35:22 2004
Subject: [mod_python] Problem with config
In-Reply-To: <407CB377.5080708@cableone.net>
References: <407CB377.5080708@cableone.net>
Message-ID: <1081916250.4842.9.camel@localhost>

Wild guessing.
First thing I see lacking here:
PythonPath in the configuration file:

PythonPath "sys.path+['/full/path/to/mptest.py']"
e.g: mptest.py is in /home/myhome/python
then the above line should read
PythonPath "sys.path+['/home/myhome/python']"

Hope this helps.
Evert


On Wed, 2004-04-14 at 05:43, Jimmie Houchin wrote:
> Hello,
> 
> I am trying to give mod_python at try.
> 
> I am running Gentoo Linux. Apache outputs this on an error page.
> This is just info not the problem.
> Apache/2.0.49 (Gentoo/Linux) mod_python/3.1.3 Python/2.3.3 mod_scgi/1.1 
> Server at localhost Port 80
> 
> I have mptest.py as:
> 
> from mod_python import apache
> 
> def handler(req):
> 	req.write("Hello World!")
> 	return apache.OK
> 
> mod_python part of my apache2.conf file
> 
> <Directory /var/www/python>
> 	AddHandler mod_python .py
> 	PythonHandler mptest
> 	PythonDebug On
> </Directory>
> 
> When I go to http://localhost/python/mptest.py
> It simply reads the file giving me the text of the file instead of 
> executing the file and giving me "Hello World!".
> 
> I know I am probably doing some stupid newbie trick.
> I have looked and looked through list archives.
> 
> Any help greatly appreciated.
> 
> Jimmie Houchin
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From gnb at itga.com.au  Wed Apr 14 15:41:58 2004
From: gnb at itga.com.au (Gregory Bond)
Date: Wed Apr 14 01:37:40 2004
Subject: [mod_python] Problem with config 
In-Reply-To: Your message of Wed, 14 Apr 2004 06:17:30 +0200.
Message-ID: <200404140541.PAA07579@lightning.itga.com.au>


evert_carton@yahoo.co.uk said:
> First thing I see lacking here: PythonPath in the configuration file: 

Inside a <Directory> block, the PythonPath munging is implied by PythonHandler.

See:

http://www.modpython.org/live/current/doc-html/tut-what-it-do.html

(nb: inside a <Files> block this path munging does NOT happen!)


From petter.holmstrom at abo.fi  Wed Apr 14 12:01:01 2004
From: petter.holmstrom at abo.fi (Petter =?ISO-8859-1?Q?Holmstr=F6m?=)
Date: Wed Apr 14 04:56:51 2004
Subject: [mod_python] PSP and unusable temporary directory
Message-ID: <1081933261.13956.26.camel@tpk8.abo.fi>

Greetings from Finland,

This could be a python-problem, but as it appeared in mod_python I'll
ask here first.

We're running mod_python 3.1.3, Apache 2.0.48 and Python 2.3.3 on
FreeBSD 5.2. mod_python works fine, except for PSP, which I cannot get
to work at all. When I try to access a PSP-page, I get the following
error:

Mod_python error: "PythonHandler mod_python.psp"

Traceback (most recent call last):

  File "/usr/local/lib/python2.3/site-packages/mod_python/apache.py", line 287, in HandlerDispatch
    log=debug)

  File "/usr/local/lib/python2.3/site-packages/mod_python/apache.py", line 457, in import_module
    module = imp.load_module(mname, f, p, d)

  File "/usr/local/lib/python2.3/site-packages/mod_python/psp.py", line 20, in ?
    import apache, Session, util, _psp

  File "/usr/local/lib/python2.3/site-packages/mod_python/Session.py", line 35, in ?
    tempdir = tempfile.gettempdir()

  File "/usr/local/lib/python2.3/tempfile.py", line 242, in gettempdir
    tempdir = _get_default_tempdir()

  File "/usr/local/lib/python2.3/tempfile.py", line 188, in _get_default_tempdir
    raise IOError, (_errno.ENOENT,

IOError: [Errno 2] No usable temporary directory found in ['/tmp', '/var/tmp', '/usr/tmp', '/']

This I don't understand. /tmp is a perfectly usable temporary directory
(777 + sticky bit). Could anybody here help me or am I in the wrong
list?

Thanks in advance,

-Petter-

-- 
Petter Holmstr?m
Civare, ?bo Akademi University
Axelia, Biskopsgatan 8, Room 339
Tel: +358 2 215 3508   GSM: +358 40 8395765 
Email: petter.holmstrom@abo.fi
Having a bad day? - http://www.murphys-laws.com
Get my public GnuPG-key from http://www.keyserver.net
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20040414/2189338d/attachment.bin
From kamil at nvstudio.pl  Wed Apr 14 12:38:08 2004
From: kamil at nvstudio.pl (Kamil Niechajewicz)
Date: Wed Apr 14 05:27:11 2004
Subject: [mod_python] web frameworks
Message-ID: <20040414123808.1f48395f.kamil@nvstudio.pl>


Hello,
Are there any good web frameworks that are working fine with mod_python
and Apache? I see all those Webware, Quixote, Twisted, but most of them
have their own web-servers and are not really best suited to work with
mod_python, I guess. I need something that can be easily put into an
Apache+mod_python application environment, and what will support XML/
XSLT template processing, not invent their own strange things like 
Python Template Languages and other examples of reinventing the wheel.

Best regards,
 Kamil

From jhouchin at cableone.net  Wed Apr 14 05:05:19 2004
From: jhouchin at cableone.net (Jimmie Houchin)
Date: Wed Apr 14 05:59:25 2004
Subject: [mod_python] Problem with config
In-Reply-To: <200404140541.PAA07579@lightning.itga.com.au>
References: <200404140541.PAA07579@lightning.itga.com.au>
Message-ID: <407D0CDF.9010009@cableone.net>

I found the problem. But I don't know why it was a problem.

In my apache2.conf I had:
<Directory /var/www/python>
     AddHandler mod_python .py
     PythonHandler mptest
     PythonDebug On
</Directory>


I had mptest.py at /var/www/python/mptest.py .

Why that didn't work I don't know.

What I discovered.
 From a previous try several months ago I had a python directory at 
/var/www/htdocs/python which is in Apaches doc path.

In that director was a mptest.py file.

It was that mptest.py that was being read.

When I changed the directive <Directory /var/www/htdocs/python>
everything worked.

It isn't a problem putting everything into /var/www/htdocs/python but I 
wish I understood what I did wrong and why /var/www/python failed. Hmm?

Thanks.

Jimmie Houchin
From davidf at sjsoft.com  Wed Apr 14 12:14:07 2004
From: davidf at sjsoft.com (David Fraser)
Date: Wed Apr 14 06:04:11 2004
Subject: [mod_python] web frameworks
In-Reply-To: <20040414123808.1f48395f.kamil@nvstudio.pl>
References: <20040414123808.1f48395f.kamil@nvstudio.pl>
Message-ID: <407D0EEF.4060007@sjsoft.com>

Kamil Niechajewicz wrote:

>Hello,
>Are there any good web frameworks that are working fine with mod_python
>and Apache? I see all those Webware, Quixote, Twisted, but most of them
>have their own web-servers and are not really best suited to work with
>mod_python, I guess. I need something that can be easily put into an
>Apache+mod_python application environment, and what will support XML/
>XSLT template processing, not invent their own strange things like 
>Python Template Languages and other examples of reinventing the wheel.
>
>Best regards,
> Kamil
>  
>
This is probably not that helpful, but mod_python will work really well 
with any standard Python modules.
So you probably need to list your exact requirements (seems to be 
XML/XSLT) as not everybody wants the same stuff in a web framework...

David
From kamil at nvstudio.pl  Wed Apr 14 13:31:50 2004
From: kamil at nvstudio.pl (Kamil Niechajewicz)
Date: Wed Apr 14 06:20:44 2004
Subject: [mod_python] mod_python.publisher weirdness
In-Reply-To: <03f501c421d3$94a31bb0$6702a8c0@gato>
References: <03f501c421d3$94a31bb0$6702a8c0@gato>
Message-ID: <20040414133150.75d5267f.kamil@nvstudio.pl>

On Tue, 13 Apr 2004 22:50:08 -0500
"Jeff Hinrichs" <jlh@cox.net> wrote:

> mod_python: 3.1.3
> OS: FreeBSD 4.9 Stable
> Apache: Apache/2.0.49 (Unix) mod_python/3.1.3 Python/2.3.3
> 
> httpd.conf:
> <Directory "/usr/local/www/data/mrt">
>     SetHandler mod_python
>     PythonHandler mod_python.publisher
>     PythonDebug On
> </Directory>
> <Directory "/usr/local/www/data/mrtJDB">
>     SetHandler mod_python
>     PythonHandler mod_python.publisher
>     PythonDebug On
> </Directory>
> 
> I have an index.py in each of the two directories.  On both pages a link to
>  http://mysite/mrt/  exists.
> 
> Events to recreate:
>  http://mysite/mrt/
>  click on a form to do a post to http://mysite/mrt/xlogon (a method in
> /mrt/index.py)
>  Edit the URL in the browser to http://mysite/mrtJDB/
>  When that page appears click on the link to http://mysite/mrt/
> 
> The page reloads and URL says, http://mysite/mrt/ the apache log agrees,
> and no errors reported in the error log. However, the page is still the
> http://mysite/mrtJDB/ page. If I click on the link 2 or 3 more times then
> I get the http://mysite/mrt/ page.

when you say "i get <xx> page" you mean that you get the content of this
page, instead of the expected one?

i think there is some serious problem with mod_python messing the file 
names of modules. i've ran into it recently and wrote about it here when
i was using my own handler - when there was two dirs with 90% of file
names being named the same mod_python was randomly picking files from
both directories, even if there was clearly stated "for this directory
use those files, for the other, those". 

and now i'm playing with publisher and here's what i've done:

/maindir 
    index.py   - frontend
/maindir/admin
       index.py            - backend
       someothermodule.py  - ..

now when i enter page at url '/' i get frontend, then i enter '/admin'
and i get backend, but when i return to '/' (with Back button or editing 
url in browser textbox) sometimes i get frontend and sometimes i get backend.
it seems that it somehow mistake files with the same name, but it should
not! :(

and btw. i often get this error, don't know why this happens, unreferenced
variable is very common error and should be handled somehow because there
is high possibility that it will occur somewhere:

  File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 481, in import_module
    if mtime > oldmtime:

UnboundLocalError: local variable 'oldmtime' referenced before assignment

best regards,
 Kamil
From dannoritzer at web.de  Wed Apr 14 12:41:43 2004
From: dannoritzer at web.de (=?ISO-8859-1?Q?G=FCnter_Dannoritzer?=)
Date: Wed Apr 14 06:38:03 2004
Subject: [mod_python] web frameworks
In-Reply-To: <20040414123808.1f48395f.kamil@nvstudio.pl>
References: <20040414123808.1f48395f.kamil@nvstudio.pl>
Message-ID: <407D1567.1010309@web.de>

Hi Kamil,

A couple of months ago there was a discussion about different frameworks 
on this list. Somebody did a nice job listing quite a bit of them and 
writing some pros/cons about them.

BTW, I am using draco, which was named in that listing too. Maybe that 
helps to narrow the search down.

Guenter



Kamil Niechajewicz wrote:
> Hello,
> Are there any good web frameworks that are working fine with mod_python
> and Apache? I see all those Webware, Quixote, Twisted, but most of them
> have their own web-servers and are not really best suited to work with
> mod_python, I guess. I need something that can be easily put into an
> Apache+mod_python application environment, and what will support XML/
> XSLT template processing, not invent their own strange things like 
> Python Template Languages and other examples of reinventing the wheel.
> 
> Best regards,
>  Kamil
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 
From kamil at nvstudio.pl  Wed Apr 14 14:14:38 2004
From: kamil at nvstudio.pl (Kamil Niechajewicz)
Date: Wed Apr 14 07:03:46 2004
Subject: [mod_python] mod_python.publisher weirdness
In-Reply-To: <20040414133150.75d5267f.kamil@nvstudio.pl>
References: <03f501c421d3$94a31bb0$6702a8c0@gato>
	<20040414133150.75d5267f.kamil@nvstudio.pl>
Message-ID: <20040414141438.729064f5.kamil@nvstudio.pl>


> and btw. i often get this error, don't know why this happens, unreferenced
> variable is very common error and should be handled somehow because there
> is high possibility that it will occur somewhere:
> 
>   File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 481, in import_module
>     if mtime > oldmtime:
> 
> UnboundLocalError: local variable 'oldmtime' referenced before assignment

I guess I found what causes this problem, in apache.py:

   if not file or (path and not filter(file.startswith, path)):
       # there is a script by this name already imported, but it's in
       # a different directory, therefore it's a different script
       mtime, oldtime = 0, -1
                ^
                |_ should be oldmtime, right?

I'm going to run through this file and find importing mechanism, maybe
there is a solution for importing wrong modules of the same name.. Someone
once wrote here that it's the matter of using 'startswith' that matches
both directories, and picking wrong module because of that..

/Kamil
From kamil at nvstudio.pl  Wed Apr 14 15:29:58 2004
From: kamil at nvstudio.pl (Kamil Niechajewicz)
Date: Wed Apr 14 08:19:21 2004
Subject: [mod_python] import_module
Message-ID: <20040414152958.21a5ab62.kamil@nvstudio.pl>


Okay, I quite see the problem with importing wrong modules, where
there are two or more dirs with modules named the same (like just
simple index.py which is default module for Publisher)

The problem is there is no namespace for different 'modules' - 
here I mean directories. I will provide a sample app for easier
explanation:

/app_root
   index.py          - http://localhost/  = main page
   admin/
       index.py      - http://localhost/admin      = admin panel
       tree.py       - http://localhost/admin/tree = show tree of objects

We put a single Apache directive:

<Directory /app_root>
	SetHandler mod_python.publisher
	... other statements here, I will ommit them because everyone
        probably knows what goes into such declaration
</Directory>

Now the test:

1. We enter site at url http://localhost/  -> page shows correctly content
generated by /app_root/index.py. The module index.py is loaded.

2. We enter site at url http://localhost/admin  -> page shows correctly 
content generated by /app_root/admin/index.py 

3. We enter site at url http://localhost/ again -> page shows content of
/app_root/admin/index.py, because reimporting module 'index' does not
occur - module_import checks that module is loaded, checks its mtime and
decides not to reimport it, so we end with 'index' module from a wrong
'package'.

4. We can reload this page a few times - it still shows wrong content,
because module is not reloaded, but after some time it reloads it and
again shows what should be shown.

There is an ad hoc solution - just force import_module() to reimport
modules every time, but it is not very efficient ;) 

The best solution would be changing Publisher (or maybe even apache.py)
to somehow recognize 'packages' - in the above sample our packages 
could be named 'default' (for /app_root/*) and 'admin' (for /app_root/admin).
This would lead to modules named default.index and admin.index, so there
will be no place for mistake because we will have usunual namespace for
every directory.

Actually it works strange, because it only recognizes 'modules' from
the path in url, like 'some/package/index' is module 'index' for it,
and 'some/other/package/index' is also 'index'. sys.path has something
to do here, but anyway, it should be like some.package.index and 
some.other.package.index when importing them by Publisher, because 
only that will help to recognize proper modules with the same name
in the module list.

Am I right?

/Kamil


From ronwalf at umd.edu  Wed Apr 14 09:00:50 2004
From: ronwalf at umd.edu (Ron Alford)
Date: Wed Apr 14 08:56:47 2004
Subject: [mod_python] import_module
In-Reply-To: <20040414152958.21a5ab62.kamil@nvstudio.pl>
References: <20040414152958.21a5ab62.kamil@nvstudio.pl>
Message-ID: <407D3602.6010302@umd.edu>


Since this seems to come up over and over again with the 
apache.load_module, I thought I'd mention my solution:

I have a pair of functions,

pathToModuleName(filename), which returns a module name from a given 
filename, and
loadModule(filename, modulename), which returns a module loaded into the 
given modulename.

My general pattern for using these is
mname = PREFIX + '.' + pathToModuleName(req.filename)
module = loadModule(req.filename, mname)

You can find my implementation here:
http://svn.mindswap.org/website/branches/unstable/swlib/swlib/util.py

I can slap any license you want on it for this section (but my wife and 
I are having a debate between BSD-like and LGPL for the rest of the code 
base :).


An alternative implementation would be to have a global in apache that 
matched filenames to  a randomly generated module name, thus avoiding a 
bunch of the code that I needed.  I think this method could be easily 
integrated into the mod_python code-base.  Anyone see a problem with this?


-Ron
From kamil at nvstudio.pl  Wed Apr 14 16:22:33 2004
From: kamil at nvstudio.pl (Kamil Niechajewicz)
Date: Wed Apr 14 09:11:17 2004
Subject: [mod_python] import_module
In-Reply-To: <407D3602.6010302@umd.edu>
References: <20040414152958.21a5ab62.kamil@nvstudio.pl>
	<407D3602.6010302@umd.edu>
Message-ID: <20040414162233.67476f51.kamil@nvstudio.pl>

On Wed, 14 Apr 2004 09:00:50 -0400
Ron Alford <ronwalf@umd.edu> wrote:

> An alternative implementation would be to have a global in apache that 
> matched filenames to  a randomly generated module name, thus avoiding a 
> bunch of the code that I needed.  I think this method could be easily 
> integrated into the mod_python code-base.  Anyone see a problem with this?

Thanks, I will look into your code :)
Actually I did a fast solution not involving enabling reimport at every 
request.
It needed a change in Publisher. First I made a "path" variable that is
passed to import_module() a constant path leading to root directory of
my application (actually it was changing and depend on this:
   path, module_name = os.path.split(req.filename)

this returned module_name and a physical path to directory with this
module. That part is quite correct, but its correctness is overriden
soon by import_module, because we give it a single module_name, for
example "index" even if the path was "/", or "/admin", or "/whatsoever".

So my path now is equal to "/my_app_root" which contains the same 
structure as mentioned in previous mail - "index.py" that is default,
"admin/" dir which contains also "index.py".

Now I edited publisher.py in the place where it determines module_name.
I just get full path from url ("/", "/admin" etc.), convert it to 'dotted'
form. So for http://localhost/ I get standard module name "index", but
for http://localhost/admin I get "admin.index" instead of just "index".
Then it's passed to import_module and everything is fine, because it 
has path set to main directory from which it imports "index" or "admin.
index". Those are considered as different modules so noone is mistaken.
This works with every number of 'dotted' modules I guess, so I can have
directory "/admin/tree" and the module admin.tree.index will be imported.

Hope I explained it correctly :)

/Kamil
From adrien.plisson at kawaiidream.org  Wed Apr 14 15:46:37 2004
From: adrien.plisson at kawaiidream.org (Adrien Plisson)
Date: Wed Apr 14 09:45:17 2004
Subject: [mod_python] import_module
In-Reply-To: <20040414152958.21a5ab62.kamil@nvstudio.pl>
References: <20040414152958.21a5ab62.kamil@nvstudio.pl>
Message-ID: <407D40BD.80005@kawaiidream.org>

hello,

Kamil Niechajewicz wrote:

> 1. We enter site at url http://localhost/  -> page shows correctly content
> generated by /app_root/index.py. The module index.py is loaded.

here, the module "/app_root/index.py" is imported.

> 2. We enter site at url http://localhost/admin  -> page shows correctly 
> content generated by /app_root/admin/index.py 

at this second step, the module "/app_root/admin/index.py" is imported.

> 3. We enter site at url http://localhost/ again -> page shows content of
> /app_root/admin/index.py, because reimporting module 'index' does not
> occur - module_import checks that module is loaded, checks its mtime and
> decides not to reimport it, so we end with 'index' module from a wrong
> 'package'.

now note that "/app_root/admin/index.py".startswith( "/app_root/" ) == True as 
well as, "/app_root/index.py".startswith( "/app_root/" ) == True

as you pointed in one of your previous mail, it may be a matter of using 
startswith:

take a first module, already imported.
take a second module given the same name as the first, residing in any parent 
directory of the first module.
the path of the first module will always "startswith" the path of the second 
one. and their name will be equals. thus, the second module will not be 
imported, the first module will be used instead.

I don't have a modpython right at my hand to test this, nor do i know 
modpython's internals, so i may be wrong. if anyone could test...

thanks,

-- 
rien


From list+mod_python at joreybump.com  Wed Apr 14 10:23:35 2004
From: list+mod_python at joreybump.com (Jorey Bump)
Date: Wed Apr 14 10:19:09 2004
Subject: [mod_python] Problem with config
In-Reply-To: <407D0CDF.9010009@cableone.net>
References: <200404140541.PAA07579@lightning.itga.com.au>
	<407D0CDF.9010009@cableone.net>
Message-ID: <407D4967.9030105@joreybump.com>

Jimmie Houchin wrote:

> What I discovered.
>  From a previous try several months ago I had a python directory at 
> /var/www/htdocs/python which is in Apaches doc path.
[snip]
> When I changed the directive <Directory /var/www/htdocs/python>
> everything worked.
> 
> It isn't a problem putting everything into /var/www/htdocs/python but I 
> wish I understood what I did wrong and why /var/www/python failed. Hmm?

Unless you use an Alias, the files you access via apache have to fall 
under the DocumentRoot of your host.

If you still want to separate your python files from your other pages, 
add this line to httpd.conf:

  Alias /python/ "/var/www/python/"

Then you will be able to use the directive <Directory /var/www/python> 
and access it via http://localhost/python/mptest.py.

From grisha at modpython.org  Wed Apr 14 10:40:43 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Wed Apr 14 10:36:25 2004
Subject: [mod_python] mod_python.publisher weirdness
In-Reply-To: <03f501c421d3$94a31bb0$6702a8c0@gato>
References: <03f501c421d3$94a31bb0$6702a8c0@gato>
Message-ID: <20040414103650.K1234@onyx.ispol.com>



I think this is becoming a FAQ....

You cannot have modules with the same name in one Python interpreter.
Since both of the below directories execute within the same
subinterpreter, if you use same names for modules (index.py) as well as
any global variables, you will have name clashes and rather unpredictable
behaviour.

The solution is to either name things differently, or configure Apache
such that mrt and mrtJDB run in different subinterpreters.

I recommend reading this part of the manual:

http://www.modpython.org/live/current/doc-html/pyapi-interps.html

Grisha


On Tue, 13 Apr 2004, Jeff Hinrichs wrote:

> mod_python: 3.1.3
> OS: FreeBSD 4.9 Stable
> Apache: Apache/2.0.49 (Unix) mod_python/3.1.3 Python/2.3.3
>
> httpd.conf:
> <Directory "/usr/local/www/data/mrt">
>     SetHandler mod_python
>     PythonHandler mod_python.publisher
>     PythonDebug On
> </Directory>
> <Directory "/usr/local/www/data/mrtJDB">
>     SetHandler mod_python
>     PythonHandler mod_python.publisher
>     PythonDebug On
> </Directory>
>
> I have an index.py in each of the two directories.  On both pages a link to
>  http://mysite/mrt/  exists.
>
> Events to recreate:
>  http://mysite/mrt/
>  click on a form to do a post to http://mysite/mrt/xlogon (a method in
> /mrt/index.py)
>  Edit the URL in the browser to http://mysite/mrtJDB/
>  When that page appears click on the link to http://mysite/mrt/
>
> The page reloads and URL says, http://mysite/mrt/ the apache log agrees,
> and no errors reported in the error log. However, the page is still the
> http://mysite/mrtJDB/ page. If I click on the link 2 or 3 more times then
> I get the http://mysite/mrt/ page.
>
> Now things get really silly, if I continue to click on the href that points
> to http://mysite/mrt/ I sometimes get the http://mysite/mrtJDB/ page and now
> by clicking on the link repeatedly I haphazardly jump back and forth between
> the two pages.  It's as if mod_python.publisher is getting confused.
>
> This same occurence will also play out if the directories are arranged as:
> http://mysite/mrt/
> http://mysite/mrt/mrtJDB/
> and making the necessary changes to the apache conf
> httpd.conf:
> <Directory "/usr/local/www/data/mrt">
>     SetHandler mod_python
>     PythonHandler mod_python.publisher
>     PythonDebug On
> </Directory>
> <Directory "/usr/local/www/data/mrt/mrtJDB">
>     SetHandler mod_python
>     PythonHandler mod_python.publisher
>     PythonDebug On
> </Directory>
>  and restarting apache.
>
> I've tried from Moz 1.7, FireFox 0.8, and IE6
> I've dumped caches and turned on forced reloads
> I've put pragma no-cache and page expirations in the meta tags
> I've tried req.headers_out.add("Cache-Control:","no-cache")
> and req.headers_out.add("Pragma:","no-cache")
>
> I'm at a loss and googled myself silly.
>
> I must be doing something very wrong but I'm just not seeing it right now.
>
> help.
>
> Thanks,
>
> Jeff Hinrichs
>
> p.s. "mysite" is just a place holder for the actual webserver name.
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From grisha at modpython.org  Wed Apr 14 10:54:00 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Wed Apr 14 10:49:42 2004
Subject: [mod_python] mod_python.publisher weirdness
In-Reply-To: <20040414141438.729064f5.kamil@nvstudio.pl>
References: <03f501c421d3$94a31bb0$6702a8c0@gato>
	<20040414133150.75d5267f.kamil@nvstudio.pl>
	<20040414141438.729064f5.kamil@nvstudio.pl>
Message-ID: <20040414105328.U1234@onyx.ispol.com>


This bug was fixed in 3.1.3

On Wed, 14 Apr 2004, Kamil Niechajewicz wrote:

> I guess I found what causes this problem, in apache.py:
>
>    if not file or (path and not filter(file.startswith, path)):
>        # there is a script by this name already imported, but it's in
>        # a different directory, therefore it's a different script
>        mtime, oldtime = 0, -1
>                 ^
>                 |_ should be oldmtime, right?
From list+mod_python at joreybump.com  Wed Apr 14 11:33:56 2004
From: list+mod_python at joreybump.com (Jorey Bump)
Date: Wed Apr 14 11:29:33 2004
Subject: [mod_python] mod_python.publisher weirdness
In-Reply-To: <03f501c421d3$94a31bb0$6702a8c0@gato>
References: <03f501c421d3$94a31bb0$6702a8c0@gato>
Message-ID: <407D59E4.1000304@joreybump.com>

Jeff Hinrichs wrote:

> mod_python: 3.1.3
> OS: FreeBSD 4.9 Stable
> Apache: Apache/2.0.49 (Unix) mod_python/3.1.3 Python/2.3.3
> 
> httpd.conf:
> <Directory "/usr/local/www/data/mrt">
>     SetHandler mod_python
>     PythonHandler mod_python.publisher
>     PythonDebug On
> </Directory>
> <Directory "/usr/local/www/data/mrtJDB">
>     SetHandler mod_python
>     PythonHandler mod_python.publisher
>     PythonDebug On
> </Directory>
> 
> I have an index.py in each of the two directories.  On both pages a link to
>  http://mysite/mrt/  exists.
[snip]
> I must be doing something very wrong but I'm just not seeing it right now.

You're thinking of your files as pages instead of python modules. It's 
important that all of your modules have unique names or you will 
encounter conflicts, since they share one interpreter. Rename one of the 
modules to index2.py, and you may see the problem disappear.

For this reason, you should avoid setting your DirectoryIndex to a 
python module (index.py). Use a gateway index.html page, instead, or 
link directly to the python file.

mod_python doesn't use the file hierarchy to isolate modules or 
applications. Personally, I've found this to be an enormous strength, as 
it allows you to easily reuse code. It does draw extra attention to the 
security implications of a shared hosting environment, however, which 
affects all embedded interpreters. The nice thing about mod_python is 
that it spawns an interpreter for each virtual host (so I understand), 
so you're not completely at the mercy of another developer using the 
same instance of apache.

I'm a python/mod_python newbie, myself, so others may want to clarify or 
correct my comments. I ran into name conflicts immediately, and the 
simple solution actually encourages good programming discipline (not 
unlike indentation, another initial stumbling block that you grow to love).






From gustavo.cordova at q-voz.com  Wed Apr 14 11:23:01 2004
From: gustavo.cordova at q-voz.com (=?ISO-8859-1?Q?Gustavo_C=F3rdova_Avila?=)
Date: Wed Apr 14 12:18:39 2004
Subject: [mod_python] Session variables
In-Reply-To: <1080844449.2682.1004.camel@localhost.localdomain>
References: <27583.80.160.199.114.1080838698.squirrel@webmail1.b-one.nu>
	<1080844449.2682.1004.camel@localhost.localdomain>
Message-ID: <407D7375.5060104@q-voz.com>

Ach, this is beautiful, concise, clear, and to the point.

Thankyou so much!!

-gustavo

John Mudd wrote:

>I think the session object is auto loaded (if one already exists).  You
>can request a session for a specific sid but I don't know why.  The sid
>is auto saved in a cookie for you.
>
>	session = Session.Session(req, None, secretKey)
>
>
>If you saved a session before for this same client, and it hasn't
>expired yet. you'll get the same session back.  If it's a mew client or
>te session expired you'll get a new (blank) session.  Use is_new() to
>test.
>
>	if session.is_new():
>	
>
>Once you have a session object you can store stuff in it.  Like a
>dictionary.  You can also set (and later reset) a timeout.
>
>    session['login'] = login
>    session['passwd'] = passwd
>    session['page'] = nextPage
>    session['loginCount'] = loginCount
>
>
>
>And it seems that a "pysid" cookie is auto generated when you save the
>session object.  
>
>	session.save()
>
>
>Pretty cool.  Now if there is just an automatic way to tell if a new
>session is the result of an old session expiring...
>
>John
>
>
>On Thu, 2004-04-01 at 11:58, jakob@simon-gaarde.dk wrote:
>  
>
>>Hello.
>>I can see that you can save and load session values from mod_python 3.1,
>>but unfortunately I don't understand how this works. Could someone
>>elabourate with an example please?
>>
>>Best regards Jakob Simon-Gaarde
>>_______________________________________________
>>Mod_python mailing list
>>Mod_python@modpython.org
>>http://mailman.modpython.org/mailman/listinfo/mod_python
>>    
>>
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
>  
>

From marilyn at deliberate.com  Wed Apr 14 09:38:58 2004
From: marilyn at deliberate.com (Marilyn Davis)
Date: Wed Apr 14 12:34:38 2004
Subject: [mod_python] mod_python and PIL? 
Message-ID: <Pine.LNX.4.44.0404140937580.22015-100000@Kuna>

Hi,

I'm trying to put together python2.3 with Imaging-1.1.4 and
mod_python-2.7.8 and am having trouble.  Can anyone here help me?

The final result is:

Cannot load /www/libexec/mod_python.so into server: /www/libexec/mod_python.so: undefined symbol: pthread_sigmask

I build python-2.3.3 without threads:

[root@maildance Python-2.3.3]# ./configure --with-threads=no

and in the end I see things like:

*** WARNING: renaming "_testcapi" since importing it failed: build/lib.linux-i686-2.3/_testcapi.so: undefined symbol: PyGILState_Ensure
*** WARNING: renaming "_bsddb" since importing it failed: build/lib.linux-i686-2.3/_bsddb.so: undefined symbol: PyGILState_Ensure
*** WARNING: renaming "zlib" since importing it failed: build/lib.linux-i686-2.3/zlib.so: undefined symbol: PyThread_acquire_lock
*** WARNING: renaming "bz2" since importing it failed: build/lib.linux-i686-2.3/bz2.so: undefined symbol: PyThread_acquire_lock
*** WARNING: renaming "_tkinter" since importing it failed: build/lib.linux-i686-2.3/_tkinter.so: undefined symbol: PyThread_acquire_lock
running build_scripts
[root@maildance Python-2.3.3]# 

So I guess that means that threads aren't happening?

I notice, though, that when I "python2.3 setup.py build" to make PIL,
I get lots like this:

[root@maildance Imaging-1.1.4]# python2.3 setup.py build
gcc -pthread -shared build/temp.linux-i686-2.3/_imaging.o build/temp.linux-i686-2.3/decode.o build/temp.linux-i686-2.3/encode.o build/temp.linux-i686-2.3/map.o build/temp.linux-i686-2.3/display.o build/temp.linux-i686-2.3/outline.o build/temp.linux-i686-2.3/path.o -LlibImaging -lImaging -ljpeg -lz -o build/lib.linux-i686-2.3/_imaging.so
building '_imagingtk' extension
creating build/temp.linux-i686-2.3/Tk
gcc -pthread -fno-strict-aliasing -DNDEBUG -g -O3 -Wall -Wstrict-prototypes -fPIC -IlibImaging -I/usr/local/include/python2.3 -c Tk/tkImaging.c -o build/temp.linux-i686-2.3/Tk/tkImaging.o

So I see that -pthread and wonder if that's what's causing it and what
can I do about it?

Thank you for any help anyone can give.

Marilyn Davis, Ph.D         marilyn@deliberate.com        -1 650 965-7121
Author of eVote(R)/Clerk                        http://www.deliberate.com 


From mudd at vex.net  Wed Apr 14 14:46:34 2004
From: mudd at vex.net (John Mudd)
Date: Wed Apr 14 14:42:26 2004
Subject: [mod_python] Session variables
In-Reply-To: <407D7375.5060104@q-voz.com>
References: <27583.80.160.199.114.1080838698.squirrel@webmail1.b-one.nu>
	 <1080844449.2682.1004.camel@localhost.localdomain>
	 <407D7375.5060104@q-voz.com>
Message-ID: <1081968394.3107.1.camel@localhost.localdomain>

Unfortunately I was wrong in some respects.  Here's Grisha's response.

John


---


The cookie is set in the __init__ method of the session object, so
saving
the session and the cookie are not related.

Also keep in mind that the cookie is set only once - when the session is
new. After that there is no need for it, it's the client who has to send
the cookie to the server every time, the server does not need to
"return"
it. So if your session persists over 100 HTTP requests, 1 will have a
cookie header, and 99 will not.

Grisha





On Wed, 2004-04-14 at 13:23, Gustavo C?rdova Avila wrote:
> Ach, this is beautiful, concise, clear, and to the point.
> 
> Thankyou so much!!
> 
> -gustavo
> 
> John Mudd wrote:
> 
> >I think the session object is auto loaded (if one already exists).  You
> >can request a session for a specific sid but I don't know why.  The sid
> >is auto saved in a cookie for you.
> >
> >	session = Session.Session(req, None, secretKey)
> >
> >
> >If you saved a session before for this same client, and it hasn't
> >expired yet. you'll get the same session back.  If it's a mew client or
> >te session expired you'll get a new (blank) session.  Use is_new() to
> >test.
> >
> >	if session.is_new():
> >	
> >
> >Once you have a session object you can store stuff in it.  Like a
> >dictionary.  You can also set (and later reset) a timeout.
> >
> >    session['login'] = login
> >    session['passwd'] = passwd
> >    session['page'] = nextPage
> >    session['loginCount'] = loginCount
> >
> >
> >
> >And it seems that a "pysid" cookie is auto generated when you save the
> >session object.  
> >
> >	session.save()
> >
> >
> >Pretty cool.  Now if there is just an automatic way to tell if a new
> >session is the result of an old session expiring...
> >
> >John
> >
> >
> >On Thu, 2004-04-01 at 11:58, jakob@simon-gaarde.dk wrote:
> >  
> >
> >>Hello.
> >>I can see that you can save and load session values from mod_python 3.1,
> >>but unfortunately I don't understand how this works. Could someone
> >>elabourate with an example please?
> >>
> >>Best regards Jakob Simon-Gaarde
> >>_______________________________________________
> >>Mod_python mailing list
> >>Mod_python@modpython.org
> >>http://mailman.modpython.org/mailman/listinfo/mod_python
> >>    
> >>
> >
> >_______________________________________________
> >Mod_python mailing list
> >Mod_python@modpython.org
> >http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> >
> >  
> >

From mudd at vex.net  Wed Apr 14 16:22:05 2004
From: mudd at vex.net (John Mudd)
Date: Wed Apr 14 16:17:41 2004
Subject: [mod_python] pysid cookie timeout?
Message-ID: <1081974125.3107.99.camel@localhost.localdomain>

By running the Cookie manager on my browser I can see that the pysid
cookie times out when the browser terminates.

Is there a way to change the pysid timeout?  I do set the mod_python
session timeout but, since the pysid cookie is written when the session
is created (before I set the timeout), the mod_python session timeout
obviously has no effect on the pysid cookie timeout.

John  

From lists at webcrunchers.com  Wed Apr 14 16:54:04 2004
From: lists at webcrunchers.com (John Draper)
Date: Wed Apr 14 19:49:59 2004
Subject: [mod_python] Finally.... but where are the examples?
Message-ID: <028E5068-8E6F-11D8-ADFF-003065477776@webcrunchers.com>

Hi,

i FINALLY got mod_python installed.   Main problem is the Apache
coming with OpenBSD3.4

Thanx so much to Paul Hart for his wonderful assistance in this
matter.

It turns out we were unable to get mod_python to work with the
OpenBSD version of Apache.    Bottom line!!!   It ain't going
to happen (at least not from me).  Perhaps that task could
be taken on by someone far more experienced then myself.
But if anyone manages to sucessfully do it,  then please
let me know.

Next,  we tried the Apache 1.x version,  and that didn't work.
So next I tried Apache 2...   but then discovered it would not build
with Python 2.3,  so we eventually installed Python 2.2,  and installed
it on that.   Seems to be working now,  but I've gone through the
tutorial and the testing page,  and FINALLY got that to work.
But the docs failed to give out the URL,  so after days of fiddling
around,  I was able to get that to work,   but now I'm virtually
stuck again,   due to lack of documentation.

Anyway,  I'm re-visiting the web site again,  and it appears to not
have been changed very much,  and the examples pages are virtually empty
(unless my browser may be caching last months web visit).

After spending hours looking on the web for user contributed examples,
I see none.

In particular,  I'm looking for examples on how to pass "session data"
from one session to another like file references,   database handle
references,  etc.    Of course,  there are NO examples.

Another thing,  has anyone been able to get the PostGreSQL interfaces to
work with Mod_python,  or will that just work if I install PostGreSQL
modules in python 2.2?

Again,  I ask people to please not only post your reply into the 
mailing list
(for the benefit of others),  but to also CC a copy to my other Email
address....   crunch at shopip dot com.

John

From jlh at cox.net  Wed Apr 14 19:42:10 2004
From: jlh at cox.net (Jeff Hinrichs)
Date: Wed Apr 14 20:34:56 2004
Subject: [mod_python] mod_python.publisher weirdness
References: <03f501c421d3$94a31bb0$6702a8c0@gato>
	<407D59E4.1000304@joreybump.com>
Message-ID: <001301c42282$7cb07b10$6702a8c0@gato>

----- Original Message ----- 
From: "Jorey Bump" <list+mod_python@joreybump.com>
To: <mod_python@modpython.org>
Sent: Wednesday, April 14, 2004 10:33 AM
Subject: Re: [mod_python] mod_python.publisher weirdness


> Jeff Hinrichs wrote:
>
> > mod_python: 3.1.3
> > OS: FreeBSD 4.9 Stable
> > Apache: Apache/2.0.49 (Unix) mod_python/3.1.3 Python/2.3.3
> >
> > httpd.conf:
> > <Directory "/usr/local/www/data/mrt">
> >     SetHandler mod_python
> >     PythonHandler mod_python.publisher
> >     PythonDebug On
> > </Directory>
> > <Directory "/usr/local/www/data/mrtJDB">
> >     SetHandler mod_python
> >     PythonHandler mod_python.publisher
> >     PythonDebug On
> > </Directory>
> >
> > I have an index.py in each of the two directories.  On both pages a link
to
> >  http://mysite/mrt/  exists.
> [snip]
> > I must be doing something very wrong but I'm just not seeing it right
now.
>
> You're thinking of your files as pages instead of python modules. It's
> important that all of your modules have unique names or you will
> encounter conflicts, since they share one interpreter. Rename one of the
> modules to index2.py, and you may see the problem disappear.
>
> For this reason, you should avoid setting your DirectoryIndex to a
> python module (index.py). Use a gateway index.html page, instead, or
> link directly to the python file.
Could you explain what you mean by gateway index.html page? Something that
redirects requests to / to the proper module?

-jeff

From gnb at itga.com.au  Thu Apr 15 10:54:31 2004
From: gnb at itga.com.au (Gregory Bond)
Date: Wed Apr 14 20:50:10 2004
Subject: [mod_python] web frameworks 
In-Reply-To: Your message of Wed, 14 Apr 2004 12:38:08 +0200.
Message-ID: <200404150054.KAA28470@lightning.itga.com.au>

It's an FAQ.

http://www.modpython.org/FAQ/faqw.py?req=show&file=faq03.010.htp

See also comments about session management:

http://www.modpython.org/FAQ/faqw.py?req=show&file=faq03.008.htp

Updates to this list welcome!


From marilyn at deliberate.com  Wed Apr 14 18:12:14 2004
From: marilyn at deliberate.com (Marilyn Davis)
Date: Wed Apr 14 21:07:55 2004
Subject: [mod_python] mod_python and PIL? 
In-Reply-To: <Pine.LNX.4.44.0404140937580.22015-100000@Kuna>
Message-ID: <Pine.LNX.4.44.0404141811570.22015-100000@Kuna>


This was fixed by moving to Apache 2.

Thanks.

Marilyn

On Wed, 14 Apr 2004, Marilyn Davis wrote:

> Hi,
> 
> I'm trying to put together python2.3 with Imaging-1.1.4 and
> mod_python-2.7.8 and am having trouble.  Can anyone here help me?
> 
> The final result is:
> 
> Cannot load /www/libexec/mod_python.so into server: /www/libexec/mod_python.so: undefined symbol: pthread_sigmask
> 
> I build python-2.3.3 without threads:
> 
> [root@maildance Python-2.3.3]# ./configure --with-threads=no
> 
> and in the end I see things like:
> 
> *** WARNING: renaming "_testcapi" since importing it failed: build/lib.linux-i686-2.3/_testcapi.so: undefined symbol: PyGILState_Ensure
> *** WARNING: renaming "_bsddb" since importing it failed: build/lib.linux-i686-2.3/_bsddb.so: undefined symbol: PyGILState_Ensure
> *** WARNING: renaming "zlib" since importing it failed: build/lib.linux-i686-2.3/zlib.so: undefined symbol: PyThread_acquire_lock
> *** WARNING: renaming "bz2" since importing it failed: build/lib.linux-i686-2.3/bz2.so: undefined symbol: PyThread_acquire_lock
> *** WARNING: renaming "_tkinter" since importing it failed: build/lib.linux-i686-2.3/_tkinter.so: undefined symbol: PyThread_acquire_lock
> running build_scripts
> [root@maildance Python-2.3.3]# 
> 
> So I guess that means that threads aren't happening?
> 
> I notice, though, that when I "python2.3 setup.py build" to make PIL,
> I get lots like this:
> 
> [root@maildance Imaging-1.1.4]# python2.3 setup.py build
> gcc -pthread -shared build/temp.linux-i686-2.3/_imaging.o build/temp.linux-i686-2.3/decode.o build/temp.linux-i686-2.3/encode.o build/temp.linux-i686-2.3/map.o build/temp.linux-i686-2.3/display.o build/temp.linux-i686-2.3/outline.o build/temp.linux-i686-2.3/path.o -LlibImaging -lImaging -ljpeg -lz -o build/lib.linux-i686-2.3/_imaging.so
> building '_imagingtk' extension
> creating build/temp.linux-i686-2.3/Tk
> gcc -pthread -fno-strict-aliasing -DNDEBUG -g -O3 -Wall -Wstrict-prototypes -fPIC -IlibImaging -I/usr/local/include/python2.3 -c Tk/tkImaging.c -o build/temp.linux-i686-2.3/Tk/tkImaging.o
> 
> So I see that -pthread and wonder if that's what's causing it and what
> can I do about it?
> 
> Thank you for any help anyone can give.
> 
> Marilyn Davis, Ph.D         marilyn@deliberate.com        -1 650 965-7121
> Author of eVote(R)/Clerk                        http://www.deliberate.com 
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

-- 

From jlh at cox.net  Wed Apr 14 20:15:26 2004
From: jlh at cox.net (Jeff Hinrichs)
Date: Wed Apr 14 21:09:09 2004
Subject: [mod_python] mod_python.publisher weirdness
References: <03f501c421d3$94a31bb0$6702a8c0@gato>
	<20040414103650.K1234@onyx.ispol.com>
Message-ID: <001901c42287$25b90bb0$6702a8c0@gato>

----- Original Message ----- 
From: "Gregory (Grisha) Trubetskoy" <grisha@modpython.org>
To: "Jeff Hinrichs" <jlh@cox.net>
Cc: <mod_python@modpython.org>
Sent: Wednesday, April 14, 2004 9:40 AM
Subject: Re: [mod_python] mod_python.publisher weirdness


>
>
> I think this is becoming a FAQ....
>
> You cannot have modules with the same name in one Python interpreter.
> Since both of the below directories execute within the same
> subinterpreter, if you use same names for modules (index.py) as well as
> any global variables, you will have name clashes and rather unpredictable
> behaviour.
>
> The solution is to either name things differently, or configure Apache
> such that mrt and mrtJDB run in different subinterpreters.
>
> I recommend reading this part of the manual:
>
> http://www.modpython.org/live/current/doc-html/pyapi-interps.html
>
> Grisha
Ok, I think I grok this now and it makes sense.  I've implemented the
PythonInterpPerDirectory On for each httpd.conf section that I'm running.
And it works like what I initially, but incorrectly, thought would happen.

I've read the section 4.1 Multiple Interperters and 5.4.4
PythonInterPerDirectory.  Will the pitfalls of URI translation impact my use
of sessions?  It looks as if I was trying to intertwine my app tightly with
the Apache request flow I might get some unintended effects but since I
don't think that is what I am after should I be ok?

Also, If I wanted to hide the .py extensions and I don't want to use the
PythonInterPerDirectory, I would most likely need to implement some apache
rewrite rules to do something like
/foo -> /foo/foo.py
/foo/bar -> foo/bar/bar.py

Correct?

-Jeff

p.s. I am starting to write up an FAQ entry for this.  Do you think it
should go in Section 2.  Problems Running or another section?

From jlh at cox.net  Wed Apr 14 20:15:26 2004
From: jlh at cox.net (Jeff Hinrichs)
Date: Wed Apr 14 21:12:15 2004
Subject: [mod_python] mod_python.publisher weirdness
References: <03f501c421d3$94a31bb0$6702a8c0@gato>
	<20040414103650.K1234@onyx.ispol.com>
Message-ID: <001a01c42287$970e1b70$6702a8c0@gato>

----- Original Message ----- 
From: "Gregory (Grisha) Trubetskoy" <grisha@modpython.org>
To: "Jeff Hinrichs" <jlh@cox.net>
Cc: <mod_python@modpython.org>
Sent: Wednesday, April 14, 2004 9:40 AM
Subject: Re: [mod_python] mod_python.publisher weirdness


>
>
> I think this is becoming a FAQ....
>
> You cannot have modules with the same name in one Python interpreter.
> Since both of the below directories execute within the same
> subinterpreter, if you use same names for modules (index.py) as well as
> any global variables, you will have name clashes and rather unpredictable
> behaviour.
>
> The solution is to either name things differently, or configure Apache
> such that mrt and mrtJDB run in different subinterpreters.
>
> I recommend reading this part of the manual:
>
> http://www.modpython.org/live/current/doc-html/pyapi-interps.html
>
> Grisha
Ok, I think I grok this now and it makes sense.  I've implemented the
PythonInterpPerDirectory On for each httpd.conf section that I'm running.
And it works like what I initially, but incorrectly, thought would happen.

I've read the section 4.1 Multiple Interperters and 5.4.4
PythonInterPerDirectory.  Will the pitfalls of URI translation impact my use
of sessions?  It looks as if I was trying to intertwine my app tightly with
the Apache request flow I might get some unintended effects but since I
don't think that is what I am after should I be ok?

Also, If I wanted to hide the .py extensions and I don't want to use the
PythonInterPerDirectory, I would most likely need to implement some apache
rewrite rules to do something like
/foo -> /foo/foo.py
/foo/bar -> foo/bar/bar.py

Correct?

-Jeff

p.s. I am starting to write up an FAQ entry for this.  Do you think it
should go in Section 2.  Problems Running or another section?

From jhouchin at cableone.net  Wed Apr 14 20:19:23 2004
From: jhouchin at cableone.net (Jimmie Houchin)
Date: Wed Apr 14 21:13:29 2004
Subject: [mod_python] Problem with config
In-Reply-To: <407D4967.9030105@joreybump.com>
References: <200404140541.PAA07579@lightning.itga.com.au>
	<407D0CDF.9010009@cableone.net> <407D4967.9030105@joreybump.com>
Message-ID: <407DE31B.3040703@cableone.net>

Jorey Bump wrote:
[snip]
> Unless you use an Alias, the files you access via apache have to fall 
> under the DocumentRoot of your host.
> 
> If you still want to separate your python files from your other pages, 
> add this line to httpd.conf:
> 
>  Alias /python/ "/var/www/python/"
> 
> Then you will be able to use the directive <Directory /var/www/python> 
> and access it via http://localhost/python/mptest.py.

Hi,

Thanks for the heads up and the education.

Jimmie Houchin
From jlh at cox.net  Wed Apr 14 20:31:47 2004
From: jlh at cox.net (Jeff Hinrichs)
Date: Wed Apr 14 21:24:32 2004
Subject: [mod_python] mod_python.publisher weirdness
References: 
	<03f501c421d3$94a31bb0$6702a8c0@gato><20040414103650.K1234@onyx.ispol.com>
	<001a01c42287$970e1b70$6702a8c0@gato>
Message-ID: <004201c42289$6b3fe530$6702a8c0@gato>

> > I think this is becoming a FAQ....
> > Grisha
I've written up an FAQ entry on this:
http://www.modpython.org/FAQ/faqw.py?req=show&file=faq02.016.htp

I hope you don't mind but I pretty much cut and pasted your email to the
list.  I think it was perfect.  I hope you don't mind, If you do let me know
and I'll rewrite it.  I definitely couldn't do better though.

-Jeff

From list+mod_python at joreybump.com  Wed Apr 14 21:37:51 2004
From: list+mod_python at joreybump.com (Jorey Bump)
Date: Wed Apr 14 21:33:27 2004
Subject: [mod_python] mod_python.publisher weirdness
In-Reply-To: <001301c42282$7cb07b10$6702a8c0@gato>
References: <03f501c421d3$94a31bb0$6702a8c0@gato>
	<407D59E4.1000304@joreybump.com> <001301c42282$7cb07b10$6702a8c0@gato>
Message-ID: <407DE76F.1030002@joreybump.com>

Jeff Hinrichs wrote:

> ----- Original Message ----- 
> From: "Jorey Bump" <list+mod_python@joreybump.com>
>
>>For this reason, you should avoid setting your DirectoryIndex to a
>>python module (index.py). Use a gateway index.html page, instead, or
>>link directly to the python file.
> 
> Could you explain what you mean by gateway index.html page? Something that
> redirects requests to / to the proper module?

An example would be a form-based application. Let's say you have a 
survey about snakes, and want people to go to:

  http://www.example.com/survey/

This would take them to a default page named index.html, which would 
simply be a form with the action set to:

  http://www.example.com/survey/snake.py/submit

When someone submits the form, your module takes over, and returns a 
page that may contain links to other functions in snake.py. This allows 
you to keep your application's files in one directory, and distribute 
them easily to other mod_python installations (as long as they aren't 
already using another snake.py).

But don't think index.py is evil. You could put a single index.py in the 
root of your site, and drive the entire thing from it. Then you could 
create a new module for each application, give it a unique name, and 
keep it in the root directory alongside index.py. Putting all of your 
modules in one directory will help you to avoid name clashes, and 
encourage you to reuse code.

You could even put all of your modules in a directory in your 
PYTHONPATH, safely outside the DocumentRoot, and import them as needed. 
Each virtual host could have a directory appended to its PYTHONPATH and 
drive its entire site with index.py and any static files it might need, 
such as images. With simplicity comes enormous flexibility.

From grisha at modpython.org  Wed Apr 14 21:58:35 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Wed Apr 14 21:54:17 2004
Subject: [mod_python] mod_python.publisher weirdness
In-Reply-To: <001a01c42287$970e1b70$6702a8c0@gato>
References: <03f501c421d3$94a31bb0$6702a8c0@gato>
	<20040414103650.K1234@onyx.ispol.com>
	<001a01c42287$970e1b70$6702a8c0@gato>
Message-ID: <20040414215720.E40347@onyx.ispol.com>



On Wed, 14 Apr 2004, Jeff Hinrichs wrote:

> Also, If I wanted to hide the .py extensions and I don't want to use the
> PythonInterPerDirectory, I would most likely need to implement some apache
> rewrite rules to do something like
> /foo -> /foo/foo.py
> /foo/bar -> foo/bar/bar.py

The simplest way to hide the .py is to use SetHandler rather than
AddHandler in the apache config.

Grisha
From jlh at cox.net  Wed Apr 14 21:37:40 2004
From: jlh at cox.net (Jeff Hinrichs)
Date: Wed Apr 14 22:30:26 2004
Subject: [mod_python] mod_python.publisher weirdness
References: <03f501c421d3$94a31bb0$6702a8c0@gato>
	<20040414103650.K1234@onyx.ispol.com> <001a01c42287$970e1b70$6702a8c0@gato>
	<20040414215720.E40347@onyx.ispol.com>
Message-ID: <005301c42292$9f6e44b0$6702a8c0@gato>

----- Original Message ----- 
From: "Gregory (Grisha) Trubetskoy" <grisha@modpython.org>
To: "Jeff Hinrichs" <jlh@cox.net>
Cc: <mod_python@modpython.org>
Sent: Wednesday, April 14, 2004 8:58 PM
Subject: Re: [mod_python] mod_python.publisher weirdness


>
>
> On Wed, 14 Apr 2004, Jeff Hinrichs wrote:
>
> > Also, If I wanted to hide the .py extensions and I don't want to use the
> > PythonInterPerDirectory, I would most likely need to implement some
apache
> > rewrite rules to do something like
> > /foo -> /foo/foo.py
> > /foo/bar -> foo/bar/bar.py
>
> The simplest way to hide the .py is to use SetHandler rather than
> AddHandler in the apache config.
>
> Grisha
But, from what I'm reading on the web, by using SetHandler, all requests,
even for an image in /foo/images/pic.jpg would then be sent to the
mod_python, correct?  What, I think I am after is something that would allow
a structure like (with PythonInterPerDirectory On):

/foo                                   (is a mod_python directory )
/foo/logon                          (handle a logons request, module foo/def
logon)
/foo/images                        (serves up .jpg/.png/etc found inside)
/foo/modules                      (below are site add-ons, i.e. msgboard or
db browser)

/foo/modules/mboard              (a mod_python directory with it's own
interperter)
/foo/modules/mboard/images   (serves up .jpg/.png/etc found inside)

/foo/modules/dbbrowser          (a mod_python directory with it's own
interperter)
/foo/modules/dbbrowser/images    (serves up .jpg/.png/etc found inside)

Where the modules depend on services provided by /foo for authentication and
access control via some sort of api.  So as a company requests a new
weblication  I can just wire it in to the modules subdirectory using the
authentication and access supplied by foo.

In a nutshell, how best to: If the module/method is not found, the named
physical directory is searched before a 404 or error is returned, while
hiding the .py extension.  OR am I really going about this bass-ackwards
with respect to mod_python?  I've got python experience but I'm new to
mod_python, so if you feel you need to use the clue stick, please swing
away<g>.

-jeff
p.s. I've been reading your pycon notes and having been kicking myself for
not being there :(

From todd at slack.net  Wed Apr 14 23:27:30 2004
From: todd at slack.net (Todd Grimason)
Date: Wed Apr 14 23:23:01 2004
Subject: [mod_python] web frameworks
In-Reply-To: <20040414123808.1f48395f.kamil@nvstudio.pl>;
	from kamil@nvstudio.pl on Wed, Apr 14, 2004 at 12:38:08PM +0200
References: <20040414123808.1f48395f.kamil@nvstudio.pl>
Message-ID: <20040414232730.E4336@crank.slack.net>

You might want to take a look at pywork:
http://pywork.sf.net

It is Struts-like and apparently can use XML/XSLT/etc.

* Kamil Niechajewicz <kamil@nvstudio.pl> [2004-04-14 05:41]:
> 
> Hello,
> Are there any good web frameworks that are working fine with mod_python
> and Apache? I see all those Webware, Quixote, Twisted, but most of them
> have their own web-servers and are not really best suited to work with
> mod_python, I guess. I need something that can be easily put into an
> Apache+mod_python application environment, and what will support XML/
> XSLT template processing, not invent their own strange things like 
> Python Template Languages and other examples of reinventing the wheel.
> 
> Best regards,
>  Kamil
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

-- 

___________________________
toddgrimason*todd@slack.net


From jkevans at pacbell.net  Thu Apr 15 00:49:50 2004
From: jkevans at pacbell.net (Jeremy Evans)
Date: Thu Apr 15 03:45:36 2004
Subject: [mod_python] Finally.... but where are the examples?
In-Reply-To: <028E5068-8E6F-11D8-ADFF-003065477776@webcrunchers.com>
References: <028E5068-8E6F-11D8-ADFF-003065477776@webcrunchers.com>
Message-ID: <407E3E9E.8050607@pacbell.net>

I'm running mod_python 3.1.3 (compiled from source) on OpenBSD 3.4 using 
Apache 2 (compiled from source) and Python 2.2 (installed using the 
package).  I experienced some problems with semaphores that made me 
limit the number of Apache threads/processes (which is fine for me since 
the site doesn't get much traffic), but otherwise, things have gone 
fairly smooth.

I had build problems with pyscopg, but PyPgSQL works fine.

I've never passed session data between sessions, but pickling it and 
storing it in a temp folder (or the database itself) for the other 
session to read may work.

John Draper wrote:

> Hi,
> 
> i FINALLY got mod_python installed.   Main problem is the Apache
> coming with OpenBSD3.4
> 
> Thanx so much to Paul Hart for his wonderful assistance in this
> matter.
> 
> It turns out we were unable to get mod_python to work with the
> OpenBSD version of Apache.    Bottom line!!!   It ain't going
> to happen (at least not from me).  Perhaps that task could
> be taken on by someone far more experienced then myself.
> But if anyone manages to sucessfully do it,  then please
> let me know.
> 
> Next,  we tried the Apache 1.x version,  and that didn't work.
> So next I tried Apache 2...   but then discovered it would not build
> with Python 2.3,  so we eventually installed Python 2.2,  and installed
> it on that.   Seems to be working now,  but I've gone through the
> tutorial and the testing page,  and FINALLY got that to work.
> But the docs failed to give out the URL,  so after days of fiddling
> around,  I was able to get that to work,   but now I'm virtually
> stuck again,   due to lack of documentation.
> 
> Anyway,  I'm re-visiting the web site again,  and it appears to not
> have been changed very much,  and the examples pages are virtually empty
> (unless my browser may be caching last months web visit).
> 
> After spending hours looking on the web for user contributed examples,
> I see none.
> 
> In particular,  I'm looking for examples on how to pass "session data"
> from one session to another like file references,   database handle
> references,  etc.    Of course,  there are NO examples.
> 
> Another thing,  has anyone been able to get the PostGreSQL interfaces to
> work with Mod_python,  or will that just work if I install PostGreSQL
> modules in python 2.2?
> 
> Again,  I ask people to please not only post your reply into the mailing 
> list
> (for the benefit of others),  but to also CC a copy to my other Email
> address....   crunch at shopip dot com.
> 
> John
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 
From eustaquiorangel at yahoo.com  Thu Apr 15 11:03:22 2004
From: eustaquiorangel at yahoo.com (Eustaquio Rangel de Oliveira Jr.)
Date: Thu Apr 15 09:59:01 2004
Subject: [mod_python] 
 How to handle multiple .py files using Apache 1.3.x and mod_python
 2.7
Message-ID: <407E962A.5090903@yahoo.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hey,

I swear I googled for it for some days but didn't find a good answer to
it (I found this
http://www.modpython.org/FAQ/faqw.py?req=show&file=faq01.002.htp but
only works with Apache2 and mod_python3), so I need to ask you: how can
I make a config on the httpd.conf to handle all the .py files I could
have on a directory?

Maybe I'm missing something on the concept, but let me explain.
I actually use PHP for web stuff, and have a lot of PHP scripts on some
dirs.

Let's suppose I have 100 .php, if I have 100 .py and need to configure
httpd.conf to handle it and restart Apache everytime I make a .py will
be very hard to deal with this, so I just need something like "hey,
execute that .py there" stuff.

Is there a way to do that? I didn't find a clear answer to this yet. Or
as I said, maybe I'm missing the concept of how things works with
mod_python.

Thanks.

- --
~    .--.     TaQ (Eust?quio Rangel)                  ((__-^^-,-^^-__))
~   |o_o |    Usu?rio registrado GNU/Linux no. 224050  `-_---' `---_-'
~   |:_/ |    email  : eustaquiorangel@yahoo.com        `--|o` 'o|--'
~  //   \ \   URL    : http://beam.to/taq                  \  `  /
~ (|     | )  ICQ    : 110103942                            ): :(
/'\_   _/`\  PGP key: 0x784988BB                           :o_o:
\___)=(___/  Eu gosto de GNU/Linux, e vc ? ;)               "-"
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.1 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iD8DBQFAfpYpb6UiZnhJiLsRAl95AKCbessZEKXJbDUp/6htgx89h8j+jACfYeeK
bWxCtVOoA/MsnTboSfeCfC4=
=VgqB
-----END PGP SIGNATURE-----
From list+mod_python at joreybump.com  Thu Apr 15 11:56:34 2004
From: list+mod_python at joreybump.com (Jorey Bump)
Date: Thu Apr 15 11:52:13 2004
Subject: [mod_python]  How to handle multiple .py files using Apache 1.3.x
 and mod_python 2.7
In-Reply-To: <407E962A.5090903@yahoo.com>
References: <407E962A.5090903@yahoo.com>
Message-ID: <407EB0B2.10709@joreybump.com>

Eustaquio Rangel de Oliveira Jr. wrote:

> I swear I googled for it for some days but didn't find a good answer to
> it (I found this
> http://www.modpython.org/FAQ/faqw.py?req=show&file=faq01.002.htp but
> only works with Apache2 and mod_python3), so I need to ask you: how can
> I make a config on the httpd.conf to handle all the .py files I could
> have on a directory?
> 
> Maybe I'm missing something on the concept, but let me explain.
> I actually use PHP for web stuff, and have a lot of PHP scripts on some
> dirs.
> 
> Let's suppose I have 100 .php, if I have 100 .py and need to configure
> httpd.conf to handle it and restart Apache everytime I make a .py will
> be very hard to deal with this, so I just need something like "hey,
> execute that .py there" stuff.
> 
> Is there a way to do that? I didn't find a clear answer to this yet. Or
> as I said, maybe I'm missing the concept of how things works with
> mod_python.

Assuming you're using publisher and your DocumentRoot is /var/www/html, 
you can do this:

  <Directory /var/www/html>
    AddHandler python-program .py
    PythonHandler mod_python.publisher
    PythonDebug On
  </Directory>

That would allow you to use .py files almost anywhere. Specify a 
subdirectory if you want to limit it. There are no conflicts with mod_php.
From list+mod_python at joreybump.com  Thu Apr 15 12:17:17 2004
From: list+mod_python at joreybump.com (Jorey Bump)
Date: Thu Apr 15 12:12:52 2004
Subject: [mod_python]  How to handle multiple .py files using Apache 1.3.x
 and mod_python 2.7
In-Reply-To: <407EB0B2.10709@joreybump.com>
References: <407E962A.5090903@yahoo.com> <407EB0B2.10709@joreybump.com>
Message-ID: <407EB58D.7000006@joreybump.com>

Jorey Bump wrote:

> There are no conflicts with mod_php.

'Cept maybe this one concerning MySQLDb I just found in the FAQ:

  http://www.modpython.org/FAQ/faqw.py?req=show&file=faq02.013.htp
From eustaquiorangel at yahoo.com  Thu Apr 15 13:33:39 2004
From: eustaquiorangel at yahoo.com (Eustaquio Rangel de Oliveira Jr.)
Date: Thu Apr 15 12:29:18 2004
Subject: [mod_python]  How to handle multiple .py files using Apache 1.3.x
 and mod_python 2.7
Message-ID: <407EB963.7070504@yahoo.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Jorey Bump wrote:

|Assuming you're using publisher and your DocumentRoot is /var/www/html,
|you can do this:

|  <Directory /var/www/html>
|    AddHandler python-program .py
|    PythonHandler mod_python.publisher
|    PythonDebug On
|  </Directory>

|That would allow you to use .py files almost anywhere. Specify a
|subdirectory if you want to limit it. There are no conflicts with
|mod_php.

Hey, thanks for your answer. I did this, and when I try to run test.py:

from mod_python import apache

def handler(req):
	req.content_type = "text/plain"
	req.send_http_header()
	req.write("Hello, world!<br>")
	r = range(0,10)
	for n in r:
		req.write(str(n)+"<br>")
	return apache.OK

I got a:

Not Found
The requested URL /test.py was not found on this server.
Apache/1.3.29 Server at taq.localhost Port 80

But if a change test.py to:

from mod_python import apache

def say(req,what="NOTHING"):
	return "I'm saying %s" % what

def handler(req):
	req.content_type = "text/plain"
	req.send_http_header()
	req.write("Hello, world!<br>")
	r = range(0,10)
	for n in r:
		req.write(str(n)+"<br>")
	return apache.OK

and use the URL:
http://localhost/test.py/say?what=hello

I get this:
I'm saying hello

But if I use the URL:
http://localhost/test.py/handler

I get:

Hello,
world!<br>0<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>HTTP/1.1 200 OK
Date: Thu, 15 Apr 2004 16:22:58 GMT
Server: Apache/1.3.29 (Unix) mod_python/2.7.10 Python/2.2.2 PHP/4.3.4
Connection: close
Transfer-Encoding: chunked
Content-Type: text/html; charset=iso-8859-1

<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<HTML><HEAD>
<TITLE>200 OK</TITLE>
</HEAD><BODY>
<H1>OK</H1>
The server encountered an internal error or
misconfiguration and was unable to complete
your request.<P>
Please contact the server administrator,
~ taquinho@localhost.localdomain and inform them of the time the error
occurred,
and anything you might have done that may have
caused the error.<P>
More information about this error may be available
in the server error log.<P>
<HR>
<ADDRESS>Apache/1.3.29 Server at taq.localhost Port 80</ADDRESS>
</BODY></HTML>

In this case, I can't expect that the handler will process my request,
and must use a internal function on the URL and send the
"<html><head><body> etc" on the return string of that function?

I have Python 2.2.2-26 here and
LoadModule python_module libexec/mod_python.so on the httpd.conf file.

Thanks again,

- --
~    .--.     TaQ (Eust?quio Rangel)                  ((__-^^-,-^^-__))
~   |o_o |    Usu?rio registrado GNU/Linux no. 224050  `-_---' `---_-'
~   |:_/ |    email  : eustaquiorangel@yahoo.com        `--|o` 'o|--'
~  //   \ \   URL    : http://beam.to/taq                  \  `  /
~ (|     | )  ICQ    : 110103942                            ): :(
/'\_   _/`\  PGP key: 0x784988BB                           :o_o:
\___)=(___/  Eu gosto de GNU/Linux, e vc ? ;)               "-"
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.1 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iD8DBQFAfrlib6UiZnhJiLsRAv+SAJ9sz1IMAbgPCgalSPZfIdbjklkTuwCgmejL
wATL5p7vI7kyAJTGAfzVhQE=
=iFbN
-----END PGP SIGNATURE-----
From list+mod_python at joreybump.com  Thu Apr 15 13:50:16 2004
From: list+mod_python at joreybump.com (Jorey Bump)
Date: Thu Apr 15 13:45:50 2004
Subject: [mod_python]  How to handle multiple .py files using Apache 1.3.x
 and mod_python 2.7
In-Reply-To: <407EB963.7070504@yahoo.com>
References: <407EB963.7070504@yahoo.com>
Message-ID: <407ECB58.1000601@joreybump.com>

Eustaquio Rangel de Oliveira Jr. wrote:

> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
> 
> Jorey Bump wrote:
> 
> |Assuming you're using publisher and your DocumentRoot is /var/www/html,
> |you can do this:
> 
> |  <Directory /var/www/html>
> |    AddHandler python-program .py
> |    PythonHandler mod_python.publisher
> |    PythonDebug On
> |  </Directory>
> 
> |That would allow you to use .py files almost anywhere. Specify a
> |subdirectory if you want to limit it. There are no conflicts with
> |mod_php.
> 
> Hey, thanks for your answer. I did this, and when I try to run test.py:
> 
> from mod_python import apache
> 
> def handler(req):
>     req.content_type = "text/plain"
>     req.send_http_header()
>     req.write("Hello, world!<br>")
>     r = range(0,10)
>     for n in r:
>         req.write(str(n)+"<br>")
>     return apache.OK
> 
> I got a:
> 
> Not Found
> The requested URL /test.py was not found on this server.
> Apache/1.3.29 Server at taq.localhost Port 80

It's much simpler than that. Try this in test.py:

def hello(req):
     x = "Hello, world!"
     return x

Then go to:

  http://localhost/test.py/hello

You'll see the text, and the server will send it as

  Content-Type: text/plain; charset=ISO-8859-1

Now add this function:

def hellohtml(req):
     x = """<html>
<head>
<title>Hello, World!</title>
</head>
<body>
<h1>Hello, World!</h1>
</body>
</html>
"""
     return x

Go to:

  http://localhost/test.py/hellohtml

It's now HTML, with the appropriate header:

  Content-Type: text/html; charset=ISO-8859-1

Finally, add a function that takes an argument from the URL:

def hellohtmlarg(req, arg):
     x = """<html>
<head>
<title>%s</title>
</head>
<body>
<h1>%s</h1>
</body>
</html>
""" % (arg, arg)
     return x

Go to:

  http://localhost/test.py/hellohtmlarg?arg=Hello,%20World!

You can see that you generally don't need to worry about sending headers 
or importing the apache module with mod_python.publisher. Just construct 
your page as a string and return it. Publisher does the rest for you.

If you need to set special headers, you can do it like this:

  req.headers_out['Pragma'] = 'no-cache'
  req.headers_out['Cache-Control'] = 'no-cache'
  req.headers_out['Expires'] = '-1'

But I prefer to do it in httpd.conf or .htaccess, myself:

  Header set Pragma "no-cache"
  Header set Cache-Control "no-cache"
  Header set Expires "-1"

It's a matter of taste.

From terry.macdonald at dsl.pipex.com  Thu Apr 15 19:22:49 2004
From: terry.macdonald at dsl.pipex.com (Terry MacDonald)
Date: Thu Apr 15 14:18:27 2004
Subject: [mod_python] mod_python or python-program
Message-ID: <1082053369.7130.4.camel@bigmac.taumu.com>

Hi all

What's the difference between using these two directives:

	AddHandler mod_python .py

and

	AddHandler python-program .py

They appear to be used interchangeably if this is the case which is best
practice (standards wise) to use.

Thanks
-- 
Terry
Registered Linux User # 311806
www.taumu.com


From eustaquiorangel at yahoo.com  Thu Apr 15 16:43:46 2004
From: eustaquiorangel at yahoo.com (Eustaquio Rangel de Oliveira Jr.)
Date: Thu Apr 15 15:39:27 2004
Subject: [mod_python] How to handle multiple .py files using Apache 1.3.x
 and mod_python 2.7
Message-ID: <407EE5F2.7000003@yahoo.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Jorey Bump wrote:

|It's much simpler than that. Try this in test.py:

|def hello(req):
|     x = "Hello, world!"
|     return x

|Then go to:
|  http://localhost/test.py/hello

Thanks again for your answer! :-)
Just one more question: I always will need to specify the function
inside the .py file? I mean, it will not work with I just put

http://localhost/test.py

Thanks!

- --
~    .--.     TaQ (Eust?quio Rangel)                  ((__-^^-,-^^-__))
~   |o_o |    Usu?rio registrado GNU/Linux no. 224050  `-_---' `---_-'
~   |:_/ |    email  : eustaquiorangel@yahoo.com        `--|o` 'o|--'
~  //   \ \   URL    : http://beam.to/taq                  \  `  /
~ (|     | )  ICQ    : 110103942                            ): :(
/'\_   _/`\  PGP key: 0x784988BB                           :o_o:
\___)=(___/  Eu gosto de GNU/Linux, e vc ? ;)               "-"
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.1 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iD8DBQFAfuXyb6UiZnhJiLsRApP5AJ0RxwbU2dgr0jVkghnRl6qvhuqUTgCfQbAW
TBXESzvDiU8ZgzjXMGH7JP8=
=fnbq
-----END PGP SIGNATURE-----
From grisha at modpython.org  Thu Apr 15 19:36:23 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Thu Apr 15 19:32:07 2004
Subject: [mod_python] mod_python or python-program
In-Reply-To: <1082053369.7130.4.camel@bigmac.taumu.com>
References: <1082053369.7130.4.camel@bigmac.taumu.com>
Message-ID: <20040415193524.F57964@onyx.ispol.com>


python-program is the old way, mod_python is the new. mod_python will only
work in 3.1.3 and later. python-program will work in all versions, but
some time in the distant future will be phased out.

Grisha

On Thu, 15 Apr 2004, Terry MacDonald wrote:

> Hi all
>
> What's the difference between using these two directives:
>
> 	AddHandler mod_python .py
>
> and
>
> 	AddHandler python-program .py
>
> They appear to be used interchangeably if this is the case which is best
> practice (standards wise) to use.
>
> Thanks
> --
> Terry
> Registered Linux User # 311806
> www.taumu.com
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From bje at apnic.net  Fri Apr 16 12:26:01 2004
From: bje at apnic.net (Byron Ellacott)
Date: Thu Apr 15 22:21:49 2004
Subject: [mod_python] web frameworks
In-Reply-To: <20040414232730.E4336@crank.slack.net>
References: <20040414123808.1f48395f.kamil@nvstudio.pl>
	 <20040414232730.E4336@crank.slack.net>
Message-ID: <1082082361.6202.120.camel@ping.apnic.net>

On Thu, 2004-04-15 at 13:27, Todd Grimason wrote:
> You might want to take a look at pywork:
> http://pywork.sf.net
> It is Struts-like and apparently can use XML/XSLT/etc.

I took a look at this myself.  It's currenty at version 0.4, and I'm not
sure how active the development is on it.  In order to get XML/XSLT
working, I had to fix a few bugs in the distributed code base.  It looks
like the author is more interested in ZPT than XSLT as a presentation
mechanism, but I'm not sure ZPT would have worked out-of-the-box either
(I didn't install the supporting Zope libraries, so I haven't even tried
ZPT).

For a 0.4 release, it's a good proof of concept.  But if you want to
start developing with it, you'll have a bit of work ahead of you to get
it ready for use.

-- 
bje
From prillamana at cox.net  Fri Apr 16 01:10:44 2004
From: prillamana at cox.net (Aaron Prillaman)
Date: Fri Apr 16 02:06:27 2004
Subject: [mod_python] BMP upload problems
Message-ID: <001501c42379$8d7a3d30$6701a8c0@mortimer>

In uploading a bmp file with the following setup, something is corrupting the data.

I have a very simple python script:
tst.py..........

from mod_python import util
datadir = '/Documents and Settings/owner/desktop/www/data/'

def upload(req,sfl):
    sdata = req.form['sfl'].file.read()
    ofl = open(datadir+"tst.bmp","w")
    ofl.write(sdata)
    return "ok"


and a simple form:
http://mollysgrave.no-ip.com:82/tst.html
tst.html............

<html>
<form action="/cgi-bin/tst.py/upload" method="post" enctype="multipart/form-data"><br>
file: <input type="file" name="sfl">
<input type="submit">
</form>
</html>

I upload http://mollysgrave.no-ip.com:82/brown1.bmp
and http://mollysgrave.no-ip.com:82/tst.bmp is the result.
I'm not really sure what the inconsistency is.  Just wondering if anyone has ideas.

Thanks,
Aaron Prillaman
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20040416/feb23432/attachment.html
From davidf at sjsoft.com  Fri Apr 16 08:40:10 2004
From: davidf at sjsoft.com (David Fraser)
Date: Fri Apr 16 02:30:12 2004
Subject: [mod_python] BMP upload problems
In-Reply-To: <001501c42379$8d7a3d30$6701a8c0@mortimer>
References: <001501c42379$8d7a3d30$6701a8c0@mortimer>
Message-ID: <407F7FCA.70900@sjsoft.com>

Aaron Prillaman wrote:

> In uploading a bmp file with the following setup, something is 
> corrupting the data.
>  
> I have a very simple python script:
> tst.py..........
>  
> from mod_python import util
> datadir = '/Documents and Settings/owner/desktop/www/data/'
>  
> def upload(req,sfl):
>     sdata = req.form['sfl'].file.read()
>     ofl = open(datadir+"tst.bmp","w")
>     ofl.write(sdata)
>     return "ok"
>  
> and a simple form:
> http://mollysgrave.no-ip.com:82/tst.html
> tst.html............
>  
> <html>
> <form action="/cgi-bin/tst.py/upload" method="post" 
> enctype="multipart/form-data"><br>
> file: <input type="file" name="sfl">
> <input type="submit">
> </form>
> </html>
> I upload http://mollysgrave.no-ip.com:82/brown1.bmp
> and http://mollysgrave.no-ip.com:82/tst.bmp is the result.
> I'm not really sure what the inconsistency is.  Just wondering if 
> anyone has ideas.
>  
> Thanks,
> Aaron Prillaman

tst.bmp is the same as unix2dos of brown1.bmp i.e. all the LFs are being 
replaced by CR LF
So the likely reason is when writing the file you need to open it in 
binary form ("wb" instead of "w")

David
From jciccale at mac.com  Fri Apr 16 09:36:43 2004
From: jciccale at mac.com (Julian Ciccale)
Date: Fri Apr 16 03:32:31 2004
Subject: [mod_python] web frameworks
In-Reply-To: <1082082361.6202.120.camel@ping.apnic.net>
References: <20040414123808.1f48395f.kamil@nvstudio.pl>
	 <20040414232730.E4336@crank.slack.net>
	 <1082082361.6202.120.camel@ping.apnic.net>
Message-ID: <1082100953.15459.2.camel@julian>

Hi, I'm following the PyWork development (julcicc), 
what problems did you encounter using XSLT ?

We are still working on pywork , and planning a new release, at the
moment we are using it in 2 production applications, and we are using
mostly ZPT and a new PDF view handler.

I would appreciate feedback on bugs and features.

See you,

- julcicc -

El vie, 16-04-2004 a las 04:26, Byron Ellacott escribi?:
> On Thu, 2004-04-15 at 13:27, Todd Grimason wrote:
> > You might want to take a look at pywork:
> > http://pywork.sf.net
> > It is Struts-like and apparently can use XML/XSLT/etc.
> 
> I took a look at this myself.  It's currenty at version 0.4, and I'm not
> sure how active the development is on it.  In order to get XML/XSLT
> working, I had to fix a few bugs in the distributed code base.  It looks
> like the author is more interested in ZPT than XSLT as a presentation
> mechanism, but I'm not sure ZPT would have worked out-of-the-box either
> (I didn't install the supporting Zope libraries, so I haven't even tried
> ZPT).
> 
> For a 0.4 release, it's a good proof of concept.  But if you want to
> start developing with it, you'll have a bit of work ahead of you to get
> it ready for use.


From terry.macdonald at dsl.pipex.com  Fri Apr 16 14:24:08 2004
From: terry.macdonald at dsl.pipex.com (Terry MacDonald)
Date: Fri Apr 16 09:19:48 2004
Subject: [mod_python] index.py
In-Reply-To: <407F7FCA.70900@sjsoft.com>
References: <001501c42379$8d7a3d30$6701a8c0@mortimer>
	 <407F7FCA.70900@sjsoft.com>
Message-ID: <1082121848.11007.267.camel@bigmac.taumu.com>

Hi all,

Here is my current apache config for mod_python:
=================================================
PythonDebug on
PythonOption SessionDbm /tmp/app_sess.dbm
 
Alias /python/ "/var/www/python/"
 
<Directory "/var/www/python">
    PythonPath "['/var/www/python']+sys.path"
    AddHandler mod_python .py
    PythonHandler mod_python.publisher
    Options None
    AllowOverride None
    Order allow,deny
    Allow from all
</Directory>
 
Alias /app/ "/var/www/python/app/dev/"
                                                                                                                  <Directory "/var/www/python/app/dev">
    PythonPath ['/var/www/python/app/dev']+sys.path
    DirectoryIndex league.py
</Directory>
 
<Directory "/var/www/python/app/dev/members">
    PythonPath
['/var/www/python/app/dev','/var/www/python/app/dev/members']+sys.path
    PythonOption ApplicationPath /app/members
    PythonAuthenHandler authenticate
    AuthType Basic
    AuthName "Administration"
    Require valid-user
</Directory>
======================================================

If my league.py file/module contains a function called index() and
another function called hello() then...

http://localhost/app/league.py successfully calls index()
http://localhost/app/ successfully calls index()
http://localhost/app/league.py/hello successfully calls hello()
http://localhost/app/hello causes a not found error on URL /app/hello

The last one contradicts what is described in section '6.1.2.1 -
Traversal' of the mod_python manual.

Is this a bug, or is the apache config wrong?

Note: This is also the case if the league.py file is renamed to
index.py.  However, if I do that then http://app/ causes a forbidden
error!!??

Thanks
-- 
Terry
Registered Linux User # 311806
www.taumu.com


From neel at mediapulse.com  Fri Apr 16 10:04:51 2004
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Apr 16 09:59:19 2004
Subject: [mod_python] mod_python or python-program
In-Reply-To: <20040415193524.F57964@onyx.ispol.com>
References: <1082053369.7130.4.camel@bigmac.taumu.com>
	<20040415193524.F57964@onyx.ispol.com>
Message-ID: <407FE803.4090604@mediapulse.com>

An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20040416/c69a1332/attachment.html
From rdavisunr at yahoo.com  Fri Apr 16 13:07:22 2004
From: rdavisunr at yahoo.com (Robert Thomas Davis)
Date: Fri Apr 16 16:03:05 2004
Subject: [mod_python] Events
Message-ID: <20040416200722.46437.qmail@web80302.mail.yahoo.com>

I am interested in staying away from javascript if possible so I was wondering how one would go about calling server side python functions from page events...like OnClick.
 
Thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20040416/e4f38f70/attachment.html
From evert_carton at yahoo.co.uk  Fri Apr 16 23:38:56 2004
From: evert_carton at yahoo.co.uk (Evert Carton)
Date: Fri Apr 16 17:36:42 2004
Subject: [mod_python] Events
In-Reply-To: <20040416200722.46437.qmail@web80302.mail.yahoo.com>
References: <20040416200722.46437.qmail@web80302.mail.yahoo.com>
Message-ID: <1082151536.7442.102.camel@localhost>

There is a more or less standard approach to this:

Google for 'XMLHttpRequest'

The XMLHttpRequest-object is a JavaScript object that does allow you to
ask for a server-side action without actually displaying a page.

The way to instantiate it differs between Mozilla/Firefox and IE, the
code below for Mozilla would be more or less:

var xmlhttp = new XMLHttpRequest();
xmlhttp.open('GET','/my/location/myscript.py',false);
xmlhttp.send(null);

You can check for the status using the properties of the
XMLHttpRequest-object and make javascript alerts ... accordingly. 

Hope this helps ...

Regards,
Evert

On Fri, 2004-04-16 at 22:07, Robert Thomas Davis wrote:
> I am interested in staying away from javascript if possible so I was
> wondering how one would go about calling server side python functions
> from page events...like OnClick.
>  
> Thanks
> 
> ______________________________________________________________________
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From stian at soiland.no  Sat Apr 17 00:17:43 2004
From: stian at soiland.no (Stian =?iso-8859-1?Q?S=F8iland?=)
Date: Fri Apr 16 18:13:23 2004
Subject: [mod_python] Re: Events
In-Reply-To: <20040416200722.46437.qmail@web80302.mail.yahoo.com>
References: <20040416200722.46437.qmail@web80302.mail.yahoo.com>
Message-ID: <20040416221743.GH20047@itea.ntnu.no>

On 2004-04-16 22:07:22, Robert Thomas Davis wrote:

> I am interested in staying away from javascript if possible so I was
> wondering how one would go about calling server side python functions
> from page events...like OnClick.

Include a small picture of 1x1 transparent pixel somewhere unnoticable:

  <div class="footer">
    adlkasdlk asda sd (c) 8123932
    asdlaksdl. 
    <img src="blank.png" width="1" height="1" id="actionimg" />
  </div>  

Then from javascript - change the url of "actionimg" to
"/?my_request.py/method?askdjasdlkjakjsd". You won't be able to receive
anything useful though, so this could be used to change some internal
server state.

You COULD return some other picture and use that as some information
flow to the user. For instance, you could change the color of some image
according to the internal web server state - by just changing to some
method that returns the other image.

-- 
Stian S?iland               Work toward win-win situation. Win-lose
Trondheim, Norway           is where you win and the other lose.
http://www.soiland.no/      Lose-lose and lose-win are left as an
                            exercise to the reader.  [Limoncelli/Hogan]
                            Og dette er en ekstra linje 

From neel at mediapulse.com  Fri Apr 16 18:42:11 2004
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Apr 16 18:36:37 2004
Subject: [mod_python] Re: Events
In-Reply-To: <20040416221743.GH20047@itea.ntnu.no>
References: <20040416200722.46437.qmail@web80302.mail.yahoo.com>
	<20040416221743.GH20047@itea.ntnu.no>
Message-ID: <40806143.4080707@mediapulse.com>

An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20040416/82a4677b/attachment.html
From mozbugbox at yahoo.com.au  Sun Apr 18 04:35:30 2004
From: mozbugbox at yahoo.com.au (JustFillBug)
Date: Sun Apr 18 00:36:30 2004
Subject: [mod_python] Publisher and Digest Authentication?
Message-ID: <slrnc841d8.85p.mozbugbox@mozbugbox.somehost.org>

I always got a '400 Bad Request' error when using Publisher with
AuthType Digest. When searching the web, I found:

http://www.modpython.org/pipermail/mod_python/2002-September/013071.html

A 2002 post talking about publisher only work on basic authentication.
And from the code in publisher, it is still not fixed. Please fix it.

Does this mean that no one is using mod_python with authentication other than
Basic type?

Thanks

From lists at webcrunchers.com  Sun Apr 18 13:42:58 2004
From: lists at webcrunchers.com (John Draper)
Date: Sun Apr 18 16:38:42 2004
Subject: [mod_python] session.last_accessed() ?
In-Reply-To: <20040331145107.R35764@onyx.ispol.com>
References: <1080756022.2682.926.camel@localhost.localdomain>
	<20040331145107.R35764@onyx.ispol.com>
Message-ID: <FA47DE32-9178-11D8-B9A8-003065477776@webcrunchers.com>


On Mar 31, 2004, at 11:52 AM, Gregory (Grisha) Trubetskoy wrote:

> This is a bug clearly... I suppose a workaround would be to store your 
> own
> date until we have this fixed.

Is there a published list of mod_python bugs somewhere?    I'm just now
experimenting with Sessions,  but it would be great if I could determine
beforehand if I encounter a bug...   This way,  I can tell if the bugs 
are
MY problem or someone elses.

By the way,  I am working on some example code and as soon as I can
SOMETHING to work,   I would like to make it available to others.

So far,  none of my stuff works yet.

John

From lists at webcrunchers.com  Sun Apr 18 13:45:57 2004
From: lists at webcrunchers.com (John Draper)
Date: Sun Apr 18 16:41:39 2004
Subject: [mod_python] Session variables
In-Reply-To: <27583.80.160.199.114.1080838698.squirrel@webmail1.b-one.nu>
References: <27583.80.160.199.114.1080838698.squirrel@webmail1.b-one.nu>
Message-ID: <64C3682A-9179-11D8-B9A8-003065477776@webcrunchers.com>


On Apr 1, 2004, at 8:58 AM, jakob@simon-gaarde.dk wrote:

> Hello.
> I can see that you can save and load session values from mod_python 
> 3.1,
> but unfortunately I don't understand how this works. Could someone
> elabourate with an example please?

You're not the only one looking for examples.   I'm trying to put 
together
some examples myself,  but so far,  none of my code is working.  
Probably
due to the fact that none of us can read the author's mind and figure
out much of anything,  because there is no clue we can use to guide us
on how it's all supposed to be toed together.    Hopefully,  someone
might beat me to it.

John

From terry.macdonald at dsl.pipex.com  Sun Apr 18 23:21:24 2004
From: terry.macdonald at dsl.pipex.com (Terry MacDonald)
Date: Sun Apr 18 18:17:07 2004
Subject: [mod_python] Session variables
In-Reply-To: <64C3682A-9179-11D8-B9A8-003065477776@webcrunchers.com>
References: <27583.80.160.199.114.1080838698.squirrel@webmail1.b-one.nu>
	 <64C3682A-9179-11D8-B9A8-003065477776@webcrunchers.com>
Message-ID: <1082326884.11931.62.camel@bigmac.taumu.com>

Hi all,

Here is a working example of a function using the session class and
setting some session variables.  This is an authentication handler and
the variables will be available to the main handler via the
request.session variable.

There is a quirk where the req.session.unlock() needs to be called to
release the session for the following handler. I thought this would have
been done in the session code, so could be a bug. The docs state
themselves that lock and unlock are unlikely to be called by apps,
however, I have found this not usually the case.

======================================================================
def authenhandler( req ) :
    """ This handler is only called if the AuthName, AuthType and
        Requires apache directives are set for a directory """

    status = apache.OK
    # Get the session id from a cookie or create a new session. If it's
    # not new the user must already have been authenticated
    req.session = Session.Session(req, secret="xxxxxxxx")
    if req.session.is_new() :
        # Get user details...
        user = _dbGetUser(req, req.user)
        if user :
            # Authenticate user...
            if user[0] == req.get_basic_auth_pw() :
                # Store team id and name with the new session
                req.session['tid'] = user[1]
                req.session['team'] = user[2]
                req.session.save()
                req.log_error( "%s logged in (session=%s)" %
(req.session['team'], req.session.id()), apache.APLOG_NOTICE )
            else:
                req.log_error( "Invalid password for %s" % req.user,
apache.APLOG_NOTICE )
                status = apache.HTTP_UNAUTHORIZED
        else:
            status = apache.HTTP_UNAUTHORIZED
    req.session.unlock()
    return status
==========================================================================

Hope this helps.

Anyone have any answers to a previous email I sent entitled 'index.py'.
I mistakenly added it to another unrelated thread when, in fact, it
should be its own thread.

Cheers
-- 
Terry
Registered Linux User # 311806
www.taumu.com


> On Sun, 2004-04-18 at 21:45, John Draper wrote:
> On Apr 1, 2004, at 8:58 AM, jakob@simon-gaarde.dk wrote:
> 
> > Hello.
> > I can see that you can save and load session values from mod_python 
> > 3.1,
> > but unfortunately I don't understand how this works. Could someone
> > elabourate with an example please?
> 
> You're not the only one looking for examples.   I'm trying to put 
> together
> some examples myself,  but so far,  none of my code is working.  
> Probably
> due to the fact that none of us can read the author's mind and figure
> out much of anything,  because there is no clue we can use to guide us
> on how it's all supposed to be toed together.    Hopefully,  someone
> might beat me to it.
> 
> John
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python


From bje at apnic.net  Mon Apr 19 09:43:58 2004
From: bje at apnic.net (Byron Ellacott)
Date: Sun Apr 18 19:40:08 2004
Subject: [mod_python] web frameworks
In-Reply-To: <1082100953.15459.2.camel@julian>
References: <20040414123808.1f48395f.kamil@nvstudio.pl>
	 <20040414232730.E4336@crank.slack.net>
	 <1082082361.6202.120.camel@ping.apnic.net>
	 <1082100953.15459.2.camel@julian>
Message-ID: <1082331838.14868.63.camel@ping.apnic.net>

On Fri, 2004-04-16 at 17:36, Julian Ciccale wrote:
> Hi, I'm following the PyWork development (julcicc), 
> what problems did you encounter using XSLT ?

XSLT wasn't in view.ViewHandlerMap().availableViews, in fact none of the
built in view handlers were.  action.py then complained about it being
an unknown view handler.

util.action2xml() is unable to handle write-only properties, in both the
C and Python implementations.  I uploaded a patch to SourceForge in a
bug report to fix these implementations, though it looks like I wasn't
fully awake when I set the bug title. :)

There was also an unhandled exception to do with conf.py's getconfint()
for unset values: getconfint() simply called int(self.getconf(key)), but
getconf() returns "" for an unset value.  int("") throws a ValueError. 
I suggested modifying getconf() and getconfint() to take default values,
but didn't realise SourceForge's bug system would strip leading
whitespace, so the Python code's not real useful in there :(  This bug
only produces an exception when the configuration is reloaded with no
value specified for, I think, debug.

> We are still working on pywork , and planning a new release, at the
> moment we are using it in 2 production applications, and we are using
> mostly ZPT and a new PDF view handler.

PyWork seems to have promise.  I currently do my web development in Perl
using a self rolled framework, but I'm trying to reduce
interdependencies between the presentation and content, which gives me
an interest in XML/XSLT: I can tell the web people what the XML will
contain, and they can produce XSLT, and never the two shall meet. :)

ZPT, like all special-things-in-HTML templating systems, doesn't give me
a clean enough separation.  A PDF view handler is an interesting
concept, I look forward to playing with the new release.

-- 
bje
From grisha at modpython.org  Mon Apr 19 00:03:50 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Sun Apr 18 23:59:42 2004
Subject: [mod_python] Session variables
In-Reply-To: <1082326884.11931.62.camel@bigmac.taumu.com>
References: <27583.80.160.199.114.1080838698.squirrel@webmail1.b-one.nu>
 <64C3682A-9179-11D8-B9A8-003065477776@webcrunchers.com>
 <1082326884.11931.62.camel@bigmac.taumu.com>
Message-ID: <20040418235950.U24082@onyx.ispol.com>



On Sun, 18 Apr 2004, Terry MacDonald wrote:

> There is a quirk where the req.session.unlock() needs to be called to
> release the session for the following handler. I thought this would have
> been done in the session code, so could be a bug. The docs state
> themselves that lock and unlock are unlikely to be called by apps,
> however, I have found this not usually the case.

Starting with 3.1.3 it _is_ done - the session registers a cleanup to
unlock itself. What version of mod_python are you using?

Here a link to the relevant code in CVS:

http://cvs.apache.org/viewcvs.cgi/httpd-python/lib/python/mod_python/Session.py?r1=1.9&r2=1.10&diff_format=h


P.S.

Thanks for the example!

Grisha
From lapitro at kam.pl  Mon Apr 19 07:55:43 2004
From: lapitro at kam.pl (lapitro)
Date: Mon Apr 19 01:49:47 2004
Subject: [mod_python] ChartDirector with mod_python.
Message-ID: <408369DF.8010402@kam.pl>

Hi,

I have unsuccessfully been trying to run some of the demoscripts that
comes with ChartDirector on my Gentoo Linux box w/ Apache/2.0.49,
mod_python/3.1.3 and Python/2.3.3. The result I get is that apache 
outputs the source code
back to the browser. I know mod_python works in that directory though,
since other scripts runs fine. When I look in my logfile all it says is
(Re)importing module <modulename>, nothing else (I have set PythonDebug 
to On).
The demoscripts also runs fine from the commandline.
My question now is if somebody else has gotten any ChartDirector scripts
running with apache/mod_python ? I have skimmed through the mailinglist
and searched the web pretty thorougly and I'm still stuck, any help 
would be greatly appreciated.

URL to ChartDirector if anyone is up to trying:
http://www.advsofteng.com/download.html

Thanks in advance,
/Peter
From stietke at diw.de  Mon Apr 19 08:23:43 2004
From: stietke at diw.de (stietke@diw.de)
Date: Mon Apr 19 02:19:29 2004
Subject: [mod_python] Session variables
In-Reply-To: <1082326884.11931.62.camel@bigmac.taumu.com>
References: <27583.80.160.199.114.1080838698.squirrel@webmail1.b-one.nu>
    <64C3682A-9179-11D8-B9A8-003065477776@webcrunchers.com>
    <1082326884.11931.62.camel@bigmac.taumu.com>
Message-ID: <33844.217.0.5.30.1082355823.squirrel@webmail.diw-berlin.de>

Hi everybody,

is there somewhere where code examples or existing solutions are
collected? If not, would that be a good idea to put them somewhere
where ppl can access them, for inspiration and to avoid reinventing
the wheel?

Just my 2ct.

Cheers,
Stefan



From d.holton at vanderbilt.edu  Mon Apr 19 12:10:41 2004
From: d.holton at vanderbilt.edu (Doug Holton)
Date: Mon Apr 19 13:06:37 2004
Subject: [mod_python] mod_python wiki [was "Re: Session variables"]
In-Reply-To: <200404191700.i3JH09xj099263@slash.mediapulse.com>
References: <200404191700.i3JH09xj099263@slash.mediapulse.com>
Message-ID: <40840811.6070704@vanderbilt.edu>


> is there somewhere where code examples or existing solutions are
> collected? If not, would that be a good idea to put them somewhere
> where ppl can access them, for inspiration and to avoid reinventing
> the wheel?

Perhaps someone can create a wiki site for mod_python.
I can set one up on my site to get it started if need be, but I'd rather 
it not be the permanent home for a mod_python wiki.

From terry.macdonald at dsl.pipex.com  Tue Apr 20 00:56:25 2004
From: terry.macdonald at dsl.pipex.com (Terry MacDonald)
Date: Mon Apr 19 19:52:08 2004
Subject: [mod_python] Session variables
In-Reply-To: <20040418235950.U24082@onyx.ispol.com>
References: <27583.80.160.199.114.1080838698.squirrel@webmail1.b-one.nu>
	 <64C3682A-9179-11D8-B9A8-003065477776@webcrunchers.com>
	 <1082326884.11931.62.camel@bigmac.taumu.com>
	 <20040418235950.U24082@onyx.ispol.com>
Message-ID: <1082418985.13863.37.camel@bigmac.taumu.com>

Your're right!

It appears to be fixed in 3.1.3; take out the session.unlock in the
example code and it still works.  

I had upgraded my mod_python when 3.1.3 was released but omitted to
check if this quirk had been fixed/modified, apologies for the mistake.

Lets hope for no weird side effects!

Thanks

Terry

On Mon, 2004-04-19 at 05:03, Gregory (Grisha) Trubetskoy wrote:
> On Sun, 18 Apr 2004, Terry MacDonald wrote:
> 
> > There is a quirk where the req.session.unlock() needs to be called to
> > release the session for the following handler. I thought this would have
> > been done in the session code, so could be a bug. The docs state
> > themselves that lock and unlock are unlikely to be called by apps,
> > however, I have found this not usually the case.
> 
> Starting with 3.1.3 it _is_ done - the session registers a cleanup to
> unlock itself. What version of mod_python are you using?
> 
> Here a link to the relevant code in CVS:
> 
> http://cvs.apache.org/viewcvs.cgi/httpd-python/lib/python/mod_python/Session.py?r1=1.9&r2=1.10&diff_format=h
> 
> 
> P.S.
> 
> Thanks for the example!
> 
> Grisha
-- 
Terry
Registered Linux User # 311806
www.taumu.com


From waisun.chia at hp.com  Wed Apr 21 15:57:38 2004
From: waisun.chia at hp.com (Wai-Sun Chia)
Date: Wed Apr 21 03:53:23 2004
Subject: [mod_python] Example doesn't work
Message-ID: <40862972.3080305@hp.com>

Hello list,
WARNING: Newbie here...

I've been trying to get the example site running..

http://www.modpython.org/examples/psp_site/

But I'm getting this error:
*******************************************************
mod_python error: "PythonHandler mod_python.publisher"

Traceback (most recent call last):

   File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 
299, in HandlerDispatch
     result = object(req)

   File "/usr/lib/python2.3/site-packages/mod_python/publisher.py", line 
98, in handler
     path=[path])

   File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 
454, in import_module
     f, p, d = imp.find_module(parts[i], path)

ImportError: No module named HTTP_NOT_FOUND
*******************************************************

Running:

python-2.3.3-3
mod_python-3.1.3-2

Please help.
Thanks.


-- 
           a8888b.
          d888888b.
          8P"YP"Y88       Wai-Sun "Squidster" Chia
          8|o||o|88       Technical Consultant (RHCE)
          8'    .88       Linux/Unix Development
          8`._.' Y8.      Consulting & Integration
         d/      `8b.     HP Services Malaysia
        dP   .    Y8b.
       d8:'  "  `::88b
      d8"         'Y88b
     :8P    '      :888
      8a.   :     _a88P
    ._/"Yaa_:   .| 88P|
    \    YP"    `| 8P  `.
    /     \.___.d|    .'
    `--..__)8888P`._.'

    "Phear the Penguins!"


  "I'm not out to destroy Microsoft.
  That will just be a completely unintentional side effect."
  - Linus Torvalds -

					
					
					
From dpopowich at mtrsd.k12.ma.us  Wed Apr 21 11:45:41 2004
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Wed Apr 21 11:42:31 2004
Subject: [mod_python] no fragments in uri
Message-ID: <16518.38693.820379.384234@gargle.gargle.HOWL>


I'm using modpython 3.1.3 built against python 2.3.2 and apache
2.0.40.  I'm not getting uri fragments from req.unparsed_uri or
req.parsed_uri.  For example, with this handler:

    from mod_python import apache

    def handler(req):

	req.content_type = 'text/plain'
	req.write('unparsed_uri: %s\n' % req.unparsed_uri)
	req.write('parsed_uri: %s\n' % str(req.parsed_uri))

	return apache.OK


And specifying this URL with my browser:

    http://localhost/~dpopowich/py/?abc=1#foo

I'm getting this output:

    unparsed_uri: /~dpopowich/py/?abc=1
    parsed_uri: (None, None, None, None, None, None, '/~dpopowich/py/', 'abc=1', None)

Note how parsed_uri is also missing scheme and host info as well.

Whereas the following python script gives expected output:

    import urlparse
    print urlparse.urlsplit('http://localhost/~dpopowich/py/?abc=1#foo')

Output:

    ('http', 'localhost', '/~dpopowich/py/', 'abc=1', 'foo')


------------------
Daniel Popowich
Network Specialist
-------------------------------------
Mohawk Trail Regional School District
24 Ashfield Rd.
Shelburne Falls, MA 01370
413.625.0192 x14
-------------------------------------

From michael at dynamine.net  Wed Apr 21 10:03:26 2004
From: michael at dynamine.net (Michael S. Fischer)
Date: Wed Apr 21 12:59:19 2004
Subject: [mod_python] no fragments in uri
In-Reply-To: <16518.38693.820379.384234@gargle.gargle.HOWL>
Message-ID: <20040421170328.AE254311915@attrition.dynamine.net>

There's nothing wrong with mod_python.  req.uri has only what is requested
from the server via the GET header, but neither the host nor the fragment is
given to the server by the browser.  Watch the application-level traffic and
see for yourself.

When name-based virtual hosting is being used, you can additionally examine
the Host: header.

Best,

--Michael

> -----Original Message-----
> From: mod_python-bounces@modpython.org 
> [mailto:mod_python-bounces@modpython.org] On Behalf Of Daniel 
> J. Popowich
> Sent: Wednesday, April 21, 2004 8:46 AM
> To: mod_python@modpython.org
> Subject: [mod_python] no fragments in uri
> 
> 
> I'm using modpython 3.1.3 built against python 2.3.2 and 
> apache 2.0.40.  I'm not getting uri fragments from 
> req.unparsed_uri or req.parsed_uri.  For example, with this handler:
> 
>     from mod_python import apache
> 
>     def handler(req):
> 
> 	req.content_type = 'text/plain'
> 	req.write('unparsed_uri: %s\n' % req.unparsed_uri)
> 	req.write('parsed_uri: %s\n' % str(req.parsed_uri))
> 
> 	return apache.OK
> 
> 
> And specifying this URL with my browser:
> 
>     http://localhost/~dpopowich/py/?abc=1#foo
> 
> I'm getting this output:
> 
>     unparsed_uri: /~dpopowich/py/?abc=1
>     parsed_uri: (None, None, None, None, None, None, 
> '/~dpopowich/py/', 'abc=1', None)
> 
> Note how parsed_uri is also missing scheme and host info as well.
> 
> Whereas the following python script gives expected output:
> 
>     import urlparse
>     print 
> urlparse.urlsplit('http://localhost/~dpopowich/py/?abc=1#foo')
> 
> Output:
> 
>     ('http', 'localhost', '/~dpopowich/py/', 'abc=1', 'foo')
> 
> 
> ------------------
> Daniel Popowich
> Network Specialist
> -------------------------------------
> Mohawk Trail Regional School District
> 24 Ashfield Rd.
> Shelburne Falls, MA 01370
> 413.625.0192 x14
> -------------------------------------
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 
> 
> 

From listas at grahal.net  Thu Apr 22 01:53:06 2004
From: listas at grahal.net (Gustavo Rahal)
Date: Thu Apr 22 00:48:52 2004
Subject: [mod_python] how to configure apache?
Message-ID: <40874FB2.2070706@grahal.net>

Hi

I just started with mod_python but i can't make it work. I tried to test 
following http://www.modpython.org/live/current/doc-html/inst-testing.html
but apache still interpretate the mptest.py as plain text.
I'm using fedora 1, apache 2.0.48, mod_python 3.0.4

Thanks
Gustavo


From lisa at stxx.com  Mon Apr 26 00:08:45 2004
From: lisa at stxx.com (Lisa)
Date: Sun Apr 25 10:04:37 2004
Subject: [mod_python] Long string being corrupted
Message-ID: <20040426000845.6fdf42b6.lisa@stxx.com>

Hi All,

Apologies if my previous email makes/made it to the list, I didn't realise that my subscription didn't work before sending it.

I'm having some trouble with returning a long string while using mod_python with publisher, you can see an example of the output I'm receiving at http://www.stxx.com/test.txt

my test function is

def test():
    xx = range(0, 15000)
    ss = str()
    for x in xx:
        ss += str(x)+"\n"
    return ss

this works for the most part however there are garbage characters inserted at various places in the return string, particularly following line 14139.

I'm running Apache/2.0.49 (Debian GNU/Linux) mod_python/3.1.3 Python/2.3.3

When I run this same file from the command line it provides the correct output.

Any help would be most appreciated, apologies if this has come up before, I had a very hard time finding anything which mentioned my problem (I did look)

Thanks
Lisa
From eddielee at tropicsoft.com  Sun Apr 25 13:47:33 2004
From: eddielee at tropicsoft.com (Eddie Diener)
Date: Sun Apr 25 13:43:21 2004
Subject: [mod_python] Bug in Windows installation
Message-ID: <001001c42aed$63ded460$02fea8c0@eldiener>

Mod_python's postinstall script assumes that the Apache key in the Windows registry is in HKLM. However if one installs Apache Web Server on Windows and chooses to install for the current user in order to start Apache manually from the Console Window, the entry is under HKCU. Because of this an exception is thrown in the script when attempting to open HKLM/Apache Group/Apache and the postinstall script never finishes.

Here is the exception trace:

Traceback (most recent call last):
File "H:\UTILIT~1\Python23\Scripts\win32_postinstall.py", line 86, in ?
apachediroptions = getApacheDirOptions()
File "H:\UTILIT~1\Python23\Scripts\win32_postinstall.py", line 45, in
getApacheDirOptions
apachekey = regkey(win32con.HKEY_LOCAL_MACHINE, "Software").childkey("Apache
Group").childkey("Apache")
File "H:\UTILIT~1\Python23\Scripts\win32_postinstall.py", line 34, in
childkey
return regkey(self.key, subkeyname)
File "H:\UTILIT~1\Python23\Scripts\win32_postinstall.py", line 32, in
_init_
self.key = win32api.RegOpenKey(parent, subkeyname)
pywintypes.error: (2, 'RegOpenKeyEx', 'The system cannot find the file
specified.')
Exception exceptions.AttributeError: "regkey instance has no attribute
'key'" in <bound method regkey._del_ of <_main_.regkey instance at
0x011C8468>> ignored
*** run_installscript: internal error 0xFFFFFFFF ***

A workaround is to temporarily duplicate the Apache registry keys from HKCU to HKLM and add the ServerRoot key value, poinitng it to the root directory where Apache is installed. The installing mod_python works OK.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20040425/d1025e71/attachment.html
From dgray at coldstorage.com  Sun Apr 25 14:45:08 2004
From: dgray at coldstorage.com (Doug Gray)
Date: Sun Apr 25 14:41:27 2004
Subject: [mod_python] httplib questions
Message-ID: <200404251846.OAA20609@mail>

Im trying to capture information from a site that I need to log into first
but Im having problems making it work.

 

Python 2.3.3

 

 

Im using the following example as my start

 

Import httplib,urllib

params = urllib.urlencode({'username': 'test', 'password': 'test')

headers = {"Content-type": "application/x-www-form-urlencoded","Accept":
"text/plain"}

conn = httplib.HTTPConnection("fantasygames.sportingnews.com")

conn.request("POST", "/crs/home_check_reg.html", params, headers)

response = conn.getresponse()

return response.status

 

 

the status that is returned is 302 which I think is something to do with
redirect.

 

Questions.

1.     How do I handle 302s??

2.     can sites block you from capture data in which you are a member of
that site.

3.     Is there a good forum for Python so I can do a detailed search on the
topic of capturing web source from websites.

 

 

Thanks

Doug

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20040425/ee5e779a/attachment.html
From michael at dynamine.net  Sun Apr 25 12:25:15 2004
From: michael at dynamine.net (Michael S. Fischer)
Date: Sun Apr 25 15:21:11 2004
Subject: [mod_python] httplib questions
In-Reply-To: <200404251846.OAA20609@mail>
Message-ID: <20040425192518.366023118D0@attrition.dynamine.net>

Your question isn't really about mod_python; rather, it's about making the
best use of the httplib module.  
 
You might want to use urllib.urlopen() or urllib.urlretrieve() instead.  The
latter class will follow redirections transparently.  
 
If you must use httplib, you'll need to parse the response yourself, and
then make a subsequent connection to the target URL specified in the
redirection response.
 
Read the relevant HTTP-related RFCs (http://www.faqs.org/rfcs/) if you'd
like to understand the inner workings of the HTTP protocol.
 
--Michael
 


  _____  

From: mod_python-bounces@modpython.org
[mailto:mod_python-bounces@modpython.org] On Behalf Of Doug Gray
Sent: Sunday, April 25, 2004 11:45 AM
To: mod_python@modpython.org
Subject: [mod_python] httplib questions



Im trying to capture information from a site that I need to log into first
but Im having problems making it work.

 

Python 2.3.3

 

 

Im using the following example as my start

 

Import httplib,urllib

params = urllib.urlencode({'username': 'test', 'password': 'test')

headers = {"Content-type": "application/x-www-form-urlencoded","Accept":
"text/plain"}

conn = httplib.HTTPConnection("fantasygames.sportingnews.com")

conn.request("POST", "/crs/home_check_reg.html", params, headers)

response = conn.getresponse()

return response.status

 

 

the status that is returned is 302 which I think is something to do with
redirect.

 

Questions.

1.     How do I handle 302s??

2.     can sites block you from capture data in which you are a member of
that site.

3.     Is there a good forum for Python so I can do a detailed search on the
topic of capturing web source from websites.

 

 

Thanks

Doug

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20040425/9f86a56e/attachment-0001.html
From grisha at modpython.org  Sun Apr 25 16:06:27 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Sun Apr 25 16:02:19 2004
Subject: [mod_python] Long string being corrupted
In-Reply-To: <20040426000845.6fdf42b6.lisa@stxx.com>
References: <20040426000845.6fdf42b6.lisa@stxx.com>
Message-ID: <20040425160018.O69847@onyx.ispol.com>


Lisa  -

I tried, it doesn't happen to me, though my version of Apache is a tad
older.

Is anyone else seeing this?

First thing I would try to isolate this problem is remove as many modules
from the apache configuration as apossible, especially ones that act as
filters (e.g. include), and see if this can still be replicated.

Grisha

On Mon, 26 Apr 2004, Lisa wrote:

> Hi All,
>
> Apologies if my previous email makes/made it to the list, I didn't
> realise that my subscription didn't work before sending it.
>
> I'm having some trouble with returning a long string while using
> mod_python with publisher, you can see an example of the output I'm
> receiving at http://www.stxx.com/test.txt
>
> my test function is
>
> def test():
>     xx = range(0, 15000)
>     ss = str()
>     for x in xx:
>         ss += str(x)+"\n"
>     return ss
>
> this works for the most part however there are garbage characters
> inserted at various places in the return string, particularly following
> line 14139.
>
> I'm running Apache/2.0.49 (Debian GNU/Linux) mod_python/3.1.3 Python/2.3.3
>
> When I run this same file from the command line it provides the correct output.
>
>
> Thanks
> Lisa
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From d.holton at vanderbilt.edu  Sun Apr 25 17:00:20 2004
From: d.holton at vanderbilt.edu (Doug Holton)
Date: Sun Apr 25 17:56:17 2004
Subject: [mod_python] modpython wiki
In-Reply-To: <200404252021.i3PKLkxj027549@slash.mediapulse.com>
References: <200404252021.i3PKLkxj027549@slash.mediapulse.com>
Message-ID: <408C34F4.9020606@vanderbilt.edu>


Here's a wiki if it is of help: http://modpython.coedit.net/
I probably won't be contributing much to it myself for a few months til 
I get back to web programming.  Feel free to add or change whatever you 
want there.


From vmanera at manord.com  Mon Apr 26 08:57:43 2004
From: vmanera at manord.com (Manera, Villiam)
Date: Mon Apr 26 03:08:44 2004
Subject: R: [mod_python] Long string being corrupted
Message-ID: <52DC70C1C1575C418CB033523A29CF1410495C@exchange2000.manord.com>

on my Apache/2.0.49 (win 2000) mod_python/3.1.3 Python/2.3.3
the long string return correctly
Villiam


-----Messaggio originale-----
Da: mod_python-bounces@modpython.org
[mailto:mod_python-bounces@modpython.org]Per conto di Gregory (Grisha)
Trubetskoy
Inviato: domenica 25 aprile 2004 22.06
A: Lisa
Cc: mod_python@modpython.org
Oggetto: Re: [mod_python] Long string being corrupted



Lisa  -

I tried, it doesn't happen to me, though my version of Apache is a tad
older.

Is anyone else seeing this?

First thing I would try to isolate this problem is remove as many modules
from the apache configuration as apossible, especially ones that act as
filters (e.g. include), and see if this can still be replicated.

Grisha

On Mon, 26 Apr 2004, Lisa wrote:

> Hi All,
>
> Apologies if my previous email makes/made it to the list, I didn't
> realise that my subscription didn't work before sending it.
>
> I'm having some trouble with returning a long string while using
> mod_python with publisher, you can see an example of the output I'm
> receiving at http://www.stxx.com/test.txt
>
> my test function is
>
> def test():
>     xx = range(0, 15000)
>     ss = str()
>     for x in xx:
>         ss += str(x)+"\n"
>     return ss
>
> this works for the most part however there are garbage characters
> inserted at various places in the return string, particularly following
> line 14139.
>
> I'm running Apache/2.0.49 (Debian GNU/Linux) mod_python/3.1.3 Python/2.3.3
>
> When I run this same file from the command line it provides the correct
output.
>
>
> Thanks
> Lisa
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python
From petter.holmstrom at abo.fi  Mon Apr 26 10:19:43 2004
From: petter.holmstrom at abo.fi (Petter =?ISO-8859-1?Q?Holmstr=F6m?=)
Date: Mon Apr 26 03:15:27 2004
Subject: [mod_python] 
	Anyone successfully running mod_python 3.1.3/PSP on FreeBSD?
Message-ID: <1082963982.30812.14.camel@tpk8.abo.fi>

Hello,

Is there anybody out there who's running mod_python 3.1.3/Python Server
Pages successfully on FreeBSD? If so, how did you install it? What
version of Python are you using? The reason I ask this is that I can't
get it to work properly. I've installed both Python 2.3 and mod_python
3.1.3 from the Ports collection (on FreeBSD 5.2.1). "Ordinary"
mod_python scripts work just fine, but everytime I try to use PSP I get
this error message:

Mod_python error: "PythonHandler mod_python.psp"

Traceback (most recent call last):

  File "/usr/local/lib/python2.3/site-packages/mod_python/apache.py", line 287, in HandlerDispatch
    log=debug)

  File "/usr/local/lib/python2.3/site-packages/mod_python/apache.py", line 457, in import_module
    module = imp.load_module(mname, f, p, d)

  File "/usr/local/lib/python2.3/site-packages/mod_python/psp.py", line 20, in ?
    import apache, Session, util, _psp

  File "/usr/local/lib/python2.3/site-packages/mod_python/Session.py", line 35, in ?
    tempdir = tempfile.gettempdir()

  File "/usr/local/lib/python2.3/tempfile.py", line 242, in gettempdir
    tempdir = _get_default_tempdir()

  File "/usr/local/lib/python2.3/tempfile.py", line 188, in _get_default_tempdir
    raise IOError, (_errno.ENOENT,

IOError: [Errno 2] No usable temporary directory found in ['/tmp', '/var/tmp', '/usr/tmp', '/']

Now, I've read somewhere that this might have something to do with
threads, but I haven't been able to find more information on the
subject. I'd like to know whether this is an OS, an Apache, a mod_python
or a python-bug, and how to fix it.

Thanks in advance,

-Petter-

-- 
Petter Holmstr?m
Civare, ?bo Akademi University
Axelia, Biskopsgatan 8, Room 339
Tel: +358 2 215 3508   GSM: +358 40 8395765 
Email: petter.holmstrom@abo.fi
Having a bad day? - http://www.murphys-laws.com
Get my public GnuPG-key from http://www.keyserver.net
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20040426/dc275e8a/attachment.bin
From davidf at sjsoft.com  Mon Apr 26 09:45:21 2004
From: davidf at sjsoft.com (David Fraser)
Date: Mon Apr 26 03:35:26 2004
Subject: [mod_python] Bug in Windows installation
In-Reply-To: <001001c42aed$63ded460$02fea8c0@eldiener>
References: <001001c42aed$63ded460$02fea8c0@eldiener>
Message-ID: <408CBE11.3040004@sjsoft.com>

Hi

Thanks for posting this, I created the Windows installer script and one 
of my colleagues noticed this too, so we prepared a modified version.
I have attached the modified win32_postinstall.py script ; and I have a 
rebuilt installer at 
http://davidf.sjsoft.com/files/mod_python-3.1.3-1.win32-py2.3.exe
This also contains a fix for the attachment filetype problem.
Please test and let me know if this fixes your problem

David

PS Grisha, is there time now to start getting this stuff into CVS, as it 
would be better management-wise? :-)

Eddie Diener wrote:

> Mod_python's postinstall script assumes that the Apache key in the 
> Windows registry is in HKLM. However if one installs Apache Web Server 
> on Windows and chooses to install for the current user in order to 
> start Apache manually from the Console Window, the entry is under 
> HKCU. Because of this an exception is thrown in the script when 
> attempting to open HKLM/Apache Group/Apache and the postinstall script 
> never finishes.
>
> Here is the exception trace:
>
> Traceback (most recent call last):
> File "H:\UTILIT~1\Python23\Scripts\win32_postinstall.py", line 86, in ?
> apachediroptions = getApacheDirOptions()
> File "H:\UTILIT~1\Python23\Scripts\win32_postinstall.py", line 45, in
> getApacheDirOptions
> apachekey = regkey(win32con.HKEY_LOCAL_MACHINE, 
> "Software").childkey("Apache
> Group").childkey("Apache")
> File "H:\UTILIT~1\Python23\Scripts\win32_postinstall.py", line 34, in
> childkey
> return regkey(self.key, subkeyname)
> File "H:\UTILIT~1\Python23\Scripts\win32_postinstall.py", line 32, in
> __init__
> self.key = win32api.RegOpenKey(parent, subkeyname)
> pywintypes.error: (2, 'RegOpenKeyEx', 'The system cannot find the file
> specified.')
> Exception exceptions.AttributeError: "regkey instance has no attribute
> 'key'" in <bound method regkey.__del__ of <__main__.regkey instance at
> 0x011C8468>> ignored
> *** run_installscript: internal error 0xFFFFFFFF ***
> A workaround is to temporarily duplicate the Apache registry keys from 
> HKCU to HKLM and add the ServerRoot key value, poinitng it to the root 
> directory where Apache is installed. The installing mod_python works OK.
>
>------------------------------------------------------------------------
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python
>  
>

-------------- next part --------------
 # Copyright 2004 Apache Software Foundation
 #
 #  Licensed under the Apache License, Version 2.0 (the "License");
 #  you may not use this file except in compliance with the License.
 #  You may obtain a copy of the License at
 #
 #      http://www.apache.org/licenses/LICENSE-2.0
 #
 #  Unless required by applicable law or agreed to in writing, software
 #  distributed under the License is distributed on an "AS IS" BASIS,
 #  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 #  See the License for the specific language governing permissions and
 #  limitations under the License.
 #
 # Originally developed by Gregory Trubetskoy.
 #
 # $Id: win32_postinstall.py,v 1.5 2004/02/16 19:47:27 grisha Exp $
 #
 # this script runs at the end of windows install


import sys, os, shutil
import distutils.sysconfig

def getApacheDirOptions():
    """find potential apache directories in the registry..."""
    try:
        import win32api, win32con
        class nullregkey:
            """a registry key that doesn't exist..."""
            def childkey(self, subkeyname):
                return nullregkey()
            def subkeynames(self):
                return []
            def getvalue(self, valuename):
                raise AttributeError("Cannot access registry value %r: key does not exist" % (valuename))
        class regkey:
            """simple wrapper for registry functions that closes keys nicely..."""
            def __init__(self, parent, subkeyname):
               self.key = win32api.RegOpenKey(parent, subkeyname)
            def childkey(self, subkeyname):
               try:
                   return regkey(self.key, subkeyname)
               except win32api.error:
                   return nullregkey()
            def subkeynames(self):
               numsubkeys = win32api.RegQueryInfoKey(self.key)[0]
               return [win32api.RegEnumKey(self.key, index) for index in range(numsubkeys)]
            def getvalue(self, valuename):
               try:
                   return win32api.RegQueryValueEx(self.key, valuename)
               except win32api.error:
                   raise AttributeError("Cannot access registry value %r" % (valuename))
            def __del__(self):
               if hasattr(self, "key"):
                   win32api.RegCloseKey(self.key)
    except ImportError:
        return {}
    versions = {}
    hklm_key = regkey(win32con.HKEY_LOCAL_MACHINE, "Software").childkey("Apache Group").childkey("Apache")
    hkcu_key = regkey(win32con.HKEY_CURRENT_USER, "Software").childkey("Apache Group").childkey("Apache")
    for apachekey in (hklm_key, hkcu_key):
        for versionname in apachekey.subkeynames():
            try:
                serverroot = apachekey.childkey(versionname).getvalue("ServerRoot")
            except AttributeError:
                continue
            versions[versionname] = serverroot[0]
    return versions

def askForApacheDir(apachediroptions):
    # try to ask for Apache directory
    if len(apachediroptions) > 0:
        # get the most recent version...
        versionnames = apachediroptions.keys()
        versionnames.sort()
        initialdir = apachediroptions[versionnames[-1]]
    else:
        initialdir="C:/Program Files/Apache Group/Apache2"
    # TODO: let the user select the name from a list, or click browse to choose...
    try:
        from tkFileDialog import askdirectory
        from Tkinter import Tk
        root = Tk()
        root.withdraw()
        path = askdirectory(title="Where is Apache installed?",
                            initialdir=initialdir,
                            mustexist=1, master=root)
        root.quit()
        root.destroy()
        return path
    except ImportError:
        try:
            from win32com.shell import shell
            pidl, displayname, imagelist = shell.SHBrowseForFolder(0, None, "Where is Apache installed?")
            path = shell.SHGetPathFromIDList(pidl)
            return path
        except ImportError:
            return ""

# if we're called during removal, just exit
if len(sys.argv) == 0 or (len(sys.argv) > 1 and sys.argv[1] != "-remove"):

    mp = os.path.join(distutils.sysconfig.get_python_lib(), "mod_python_so.pyd")

    apachediroptions = getApacheDirOptions()

    apachedir = askForApacheDir(apachediroptions)

    if apachedir:

        # put mod_python.so there
        shutil.copy2(mp, os.path.join(apachedir, "modules", "mod_python.so"))
        os.remove(mp)

        print """Important Note for Windows users, PLEASE READ!!!

        1. This script does not attempt to modify Apache configuration,
           you must do it manually:

           Edit %s,
           find where other LoadModule lines are and add this:
                LoadModule python_module modules/mod_python.so

        2. Now test your installation using the instructions at this link:
           http://www.modpython.org/live/current/doc-html/inst-testing.html

        """ % os.path.join(apachedir, "conf", "httpd.conf")

    else:

        print """Important Note for Windows users, PLEASE READ!!!

        1. It appears that you do not have Tkinter installed,
           which is required for a part of this installation.
           Therefore you must manually take
           "%s"
           and copy it to your Apache modules directory.

        2. This script does not attempt to modify Apache configuration,
           you must do it manually:

           Edit %s,
           find where other LoadModule lines and add this:
                LoadModule python_module modules/mod_python.so

        3. Now test your installation using the instructions at this link:
           http://www.modpython.org/live/current/doc-html/inst-testing.html

        """ % (mp, os.path.join(apachedir, "conf", "httpd.conf"))
From stephane.bidoul at softwareag.com  Mon Apr 26 16:35:28 2004
From: stephane.bidoul at softwareag.com (Stphane Bidoul)
Date: Mon Apr 26 10:29:08 2004
Subject: [mod_python] restricted mode in server cleanup callback?
Message-ID: <04a901c42b9b$b8b9dc10$880517ac@acsesbi>

Hi,

I'm having problems with server cleanup callbacks
(on windows, with apache 2.0.49 and mod_python 3.1.3):

For instance, with

def endChild(data):
    f = file("test.log","a")
    try:
       print >> f, "endChild", data
    finally:
       f.close()

firstTime = 1

def handler(req):
    if firstTime:
        global firstTime
        req.server.register_cleanup(req,endChild,("endChild data",)
        firstTime = 0

Sometimes, the endChild function runs normally,
but sometimes, I get this in apache error.log:

[notice] Child 1284: Exit event signaled. Child process is ending.
[notice] Child 1284: Released the start mutex
[notice] Child 1284: Waiting for 250 worker threads to exit.
[notice] Child 1284: All worker threads have exited.
[error] python_cleanup: Error calling cleanup object <function endChild at
0x005FFC30>
[error]     exceptions.IOError: file() constructor not accessible in
restricted mode
[notice] Child 1284: Child process is exiting
[notice] Parent: Child process exited successfully.

Why is python thinking it is in restricted mode?
I'm prepared to launch my debugger, but I've no clue
where to search first, so any hint is most welcome.

Thanks in advance.

-sbi

From davidf at sjsoft.com  Mon Apr 26 17:20:47 2004
From: davidf at sjsoft.com (David Fraser)
Date: Mon Apr 26 11:10:45 2004
Subject: [mod_python] restricted mode in server cleanup callback?
In-Reply-To: <04a901c42b9b$b8b9dc10$880517ac@acsesbi>
References: <04a901c42b9b$b8b9dc10$880517ac@acsesbi>
Message-ID: <408D28CF.2040803@sjsoft.com>

St?phane Bidoul wrote:

>Hi,
>
>I'm having problems with server cleanup callbacks
>(on windows, with apache 2.0.49 and mod_python 3.1.3):
>
>For instance, with
>
>def endChild(data):
>    f = file("test.log","a")
>    try:
>       print >> f, "endChild", data
>    finally:
>       f.close()
>
>firstTime = 1
>
>def handler(req):
>    if firstTime:
>        global firstTime
>        req.server.register_cleanup(req,endChild,("endChild data",)
>        firstTime = 0
>
>Sometimes, the endChild function runs normally,
>but sometimes, I get this in apache error.log:
>
>[notice] Child 1284: Exit event signaled. Child process is ending.
>[notice] Child 1284: Released the start mutex
>[notice] Child 1284: Waiting for 250 worker threads to exit.
>[notice] Child 1284: All worker threads have exited.
>[error] python_cleanup: Error calling cleanup object <function endChild at
>0x005FFC30>
>[error]     exceptions.IOError: file() constructor not accessible in
>restricted mode
>[notice] Child 1284: Child process is exiting
>[notice] Parent: Child process exited successfully.
>
>Why is python thinking it is in restricted mode?
>I'm prepared to launch my debugger, but I've no clue
>where to search first, so any hint is most welcome.
>
>Thanks in advance.
>
>-sbi
>  
>
Hi
I reported this on the python-dev list recently, and have quoted the 
thread below.
Not much info seems to be available, but basically the code is being 
called with a different interpreter to the one used to create some 
objects or something like that.
I'd appreciate any further info you find out

David

> Just for reference, these are the URLs and info I've found on this 
> problem.
> There doesn't seem to be much info at all in the Python docs / 
> newsgroups.
> I have been trying to set up a testcase but at the moment it crashes 
> Apache just trying to call a simple servercleanup (with pass) so I 
> need to work at it a bit...
>
> http://4suite.org/docs/FAQ.xml
>
>> Why do I get codec or other strange errors when running under 
>> mod_python?
>>
>> There is a known problem with mod_python in Python 2.2 and older. 
>> mod_python is running in restricted mode, and this is considered by 
>> the mod_python folks to be a bug. Anything which introspects (like 
>> 4Suite) or does anything a restricted interpreter can't do will fail 
>> with a cryptic exception. The solution is to upgrade to Python 2.3, 
>> and use a recent build of mod_python (3.1 or newer).
>
>
> http://mail.python.org/pipermail/python-list/1999-April/000903.html
> (1999 discussion of this problem)
>
>> This alleviates the problem and makes it work.  Outside of not
>> finalizing interpreters (which alleviates it somewhat, but makes the
>> code run in restricted mode since __builtins__ of the unpickled objects
>> isn't the same as the "current" __builtins__), I don't know of any other
>> way to fix this.
>>
> http://groups.google.com/groups?th=bfe053aba305ba1c&seekm=35A102B1.182B68A2%40starmedia.net#link1 
>
> (1998 discussion of this problem)
>
>> In the course of playing with the pyapache, I've run into the situation
>> where the interpreter complains about being in restricted mode.  What
>> I've been able to figure out is this: if the __builtins__ of the current
>> frame is different than the __builtins__ of the current top frame (read
>> as current thread), it is in restricted mode.  Is this correct? 
>
> http://groups.google.com/groups?th=fdeaf811901bc4f&seekm=mt2.0-17287-914742573%40news.informatik.uni-bonn.de 
>
> (ancient announcement of httpady)
>
>> 1. A bug related to the way multiple intrpreters were implemented 
>> that would
>> occasionally use objects created in one interpreter in another. The 
>> bug would manifest
>> itself by Python complaining that __dict__ is not available in 
>> restricted mode.  
>>
>
>
>
> David Fraser wrote:
>
>> mod_python 3.1.3 running on Windows
>> Thanks for the explanation, that makes sense why I couldn't find the 
>> code...
>> I'll try and compare the request and server implementations of 
>> setting the cleanup function and work out why this is happening...
>>
>> David
>>
>> Gregory (Grisha) Trubetskoy wrote:
>>
>>> What version of mod_python is this?
>>>
>>> Restricted mode is a strange beast, in that there isn't really anything
>>> like a "restricted mode" flag, but it looks at a pointer somwhere 
>>> (don't
>>> remember now), and if it's not what is expected, it concludes that 
>>> it's in
>>> restricted mode. So this behaviour is actually a sign of a bug where an
>>> object is created in one subinterpreter but is running in another... 
>>> These
>>> bugs can be hard to track down.
>>>
>>> Grisha
>>>
>>>
>>> On Tue, 6 Apr 2004, David Fraser wrote:
>>>
>>>  
>>>
>>>> Hi
>>>>
>>>> It seems that server cleanup functions registered with
>>>> server.register_cleanup run in restricted mode.
>>>> I'm trying to use them to close a database connection and being run in
>>>> restricted mode causes problems.
>>>> I can't see in the code where this gets set, but I get the 
>>>> following error:
>>>> [Tue Apr 06 17:16:01 2004] [error] python_cleanup: Error calling 
>>>> cleanup
>>>> object <bound method jLogbookMultiServer.onshutdown of
>>>> <jLogbook.python.jlogbook.jLogbookMultiServer object at 0x00A62670>>
>>>> [Tue Apr 06 17:16:01 2004] [error]     exceptions.RuntimeError:
>>>> instance.__dict__ not accessible in restricted mode
>>>>
>>>> Is there a reason that the server functions needed to be run in
>>>> restricted mode, or is there a better way I should do this?
>>>>
>>>> David
>>>

From azaroth at liverpool.ac.uk  Mon Apr 26 16:35:26 2004
From: azaroth at liverpool.ac.uk (Robert Sanderson)
Date: Mon Apr 26 11:32:33 2004
Subject: [mod_python] restricted mode in server cleanup callback?
In-Reply-To: <408D28CF.2040803@sjsoft.com>
Message-ID: <Pine.LNX.4.44.0404261633120.26249-100000@gondolin.hist.liv.ac.uk>

On Mon, 26 Apr 2004, David Fraser wrote:

> >I'm having problems with server cleanup callbacks
> >(on windows, with apache 2.0.49 and mod_python 3.1.3):

My guess is that you're using Python 2.2 or earlier. Get the latest
version of Python and I think this issue will go away -- it's the way that
older versions discovered whether they were in safe mode or not that's at
fault here.  It isn't really in safe mode, but the instantiation within
apache makes it look like it is.

Other threads on this issue relate to Unicode codecs and (hence) XML 
parsing, as the codecs aren't available in restricted mode.

Rob

-- 
      ,'/:.          Dr Robert Sanderson (azaroth@liverpool.ac.uk)
    ,'-/::::.        http://www.o-r-g.org/~azaroth/
  ,'--/::(@)::.      Special Collections and Archives, extension 3142
,'---/::::::::::.    Nebmedes:  http://nebmedes.o-r-g.org:8000/
____/:::::::::::::.  
I L L U M I N A T I  



From jakob at simon-gaarde.dk  Mon Apr 26 20:26:16 2004
From: jakob at simon-gaarde.dk (Jakob Simon-Gaarde)
Date: Mon Apr 26 14:22:19 2004
Subject: [mod_python] Making cookies live byind the current session
Message-ID: <408D5448.50009@simon-gaarde.dk>

Hi mod_python experts.

I have a problem storing cookies beyond the the session in which they 
are stored. After the first part of code has been run I can see in the 
browsers cookiebrowser that the cookie is available, but if I then close 
the browser and browse the cookeis again it is gone!

The cookie readerpart also works fine until the browser is closed.

What am I doing wrong?

= In the file where I store th cookie =========
   # Store a cookie
   value = {'holdid': int(holdid)}
   Cookie.add_cookie(req, Cookie.MarshalCookie('fodbold',
                     value,'secret007'),expires=time.time()+3600*24*330)

   cookies = Cookie.get_cookies(req, Cookie.MarshalCookie,
                                   secret='secret007')
===============================================


= In another file I read the cookie ===========
   # Read cookie
   if cookies.has_key('fodbold'):
     fodboldcookie = cookies['fodbold']

     if type(fodboldcookie) is Cookie.MarshalCookie and \
        fodboldcookie.value.has_key('holdid'):
       holdid=fodboldcookie.value['holdid']
===============================================

From dgray at coldstorage.com  Mon Apr 26 15:03:22 2004
From: dgray at coldstorage.com (Doug Gray)
Date: Mon Apr 26 14:59:58 2004
Subject: [mod_python] 
	Urllib2 called from mod_pyton is 10x slower then called from python
Message-ID: <200404261904.PAA22563@mail>

Thanks for the answer to my previous question, I was able to work with
urllib2 for logging into a site and grabbing webpages on that site. I found
ClientCookies 3rd party package that handles my cookie tracking and setting
in each webpage header seamlessly!

 

NOW, I have one other problem. Im still getting a "timeout" issue when
running my test program through my webserver.

 

I can run the little program which is essentially this...

 

Import urllib2

request =
urllib2.Request("http://fantasygames.sportingnews.com/crs/home_check_reg.htm
l",data='username=test&password='test')

resp = urllib2.urlopen(request)

print resp.info()

 

 

the above simple program if run in python2.3 runs in about 2-3 seconds but
the same program called from a mod python program takes 20 seconds and fails
90% of the time giving a very long trace...

 

Mod_python error: "PythonHandler mod_python.publisher"
 
Traceback (most recent call last):
 
  File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 299, in
HandlerDispatch
    result = object(req)
 
  File "/usr/lib/python2.3/site-packages/mod_python/publisher.py", line 136,
in handler
    result = util.apply_fs_data(object, req.form, req=req)
 
  File "/usr/lib/python2.3/site-packages/mod_python/util.py", line 361, in
apply_fs_data
    return object(**args)
 
  File "/usr/local/apach2/fantasy/TSN/htmlRead.py", line 31, in getwebpage
    response = ClientCookie.urlopen(request)
 
  File "/usr/lib/python2.3/site-packages/ClientCookie/_urllib2_support.py",
line 829, in urlopen
    return _opener.open(url, data)
 
  File "/usr/lib/python2.3/site-packages/ClientCookie/_urllib2_support.py",
line 520, in open
    response = urllib2.OpenerDirector.open(self, req, data)
 
  File "/var/tmp/python2.3-2.3.3-root/usr/lib/python2.3/urllib2.py", line
326, in open
    '_open', req)
 
  File "/var/tmp/python2.3-2.3.3-root/usr/lib/python2.3/urllib2.py", line
306, in _call_chain
    result = func(*args)
 
  File "/usr/lib/python2.3/site-packages/ClientCookie/_urllib2_support.py",
line 754, in http_open
    return self.do_open(httplib.HTTP, req)
 
  File "/usr/lib/python2.3/site-packages/ClientCookie/_urllib2_support.py",
line 612, in do_open
    raise URLError(err)
 
URLError: 
 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20040426/c6d8f462/attachment.html
From grisha at modpython.org  Mon Apr 26 22:47:47 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Mon Apr 26 22:43:41 2004
Subject: [mod_python] Bug in Windows installation
In-Reply-To: <408CBE11.3040004@sjsoft.com>
References: <001001c42aed$63ded460$02fea8c0@eldiener>
	<408CBE11.3040004@sjsoft.com>
Message-ID: <20040426224511.F92854@onyx.ispol.com>


On Mon, 26 Apr 2004, David Fraser wrote:

> Hi
>
> Thanks for posting this, I created the Windows installer script and one
> of my colleagues noticed this too, so we prepared a modified version.
> I have attached the modified win32_postinstall.py script ; and I have a
> rebuilt installer at
> http://davidf.sjsoft.com/files/mod_python-3.1.3-1.win32-py2.3.exe
> This also contains a fix for the attachment filetype problem.
> Please test and let me know if this fixes your problem

David - if you could get 3 +1's for this new installer on the
python-dev@httpd list, we should be able to put it out on the main
download page.

>
> PS Grisha, is there time now to start getting this stuff into CVS, as it
> would be better management-wise? :-)

I was planning on spending some quality mod_python time towards the end of
this week :-)

Grisha


>
> Eddie Diener wrote:
>
> > Mod_python's postinstall script assumes that the Apache key in the
> > Windows registry is in HKLM. However if one installs Apache Web Server
> > on Windows and chooses to install for the current user in order to
> > start Apache manually from the Console Window, the entry is under
> > HKCU. Because of this an exception is thrown in the script when
> > attempting to open HKLM/Apache Group/Apache and the postinstall script
> > never finishes.
> >
> > Here is the exception trace:
> >
> > Traceback (most recent call last):
> > File "H:\UTILIT~1\Python23\Scripts\win32_postinstall.py", line 86, in ?
> > apachediroptions = getApacheDirOptions()
> > File "H:\UTILIT~1\Python23\Scripts\win32_postinstall.py", line 45, in
> > getApacheDirOptions
> > apachekey = regkey(win32con.HKEY_LOCAL_MACHINE,
> > "Software").childkey("Apache
> > Group").childkey("Apache")
> > File "H:\UTILIT~1\Python23\Scripts\win32_postinstall.py", line 34, in
> > childkey
> > return regkey(self.key, subkeyname)
> > File "H:\UTILIT~1\Python23\Scripts\win32_postinstall.py", line 32, in
> > __init__
> > self.key = win32api.RegOpenKey(parent, subkeyname)
> > pywintypes.error: (2, 'RegOpenKeyEx', 'The system cannot find the file
> > specified.')
> > Exception exceptions.AttributeError: "regkey instance has no attribute
> > 'key'" in <bound method regkey.__del__ of <__main__.regkey instance at
> > 0x011C8468>> ignored
> > *** run_installscript: internal error 0xFFFFFFFF ***
> > A workaround is to temporarily duplicate the Apache registry keys from
> > HKCU to HKLM and add the ServerRoot key value, poinitng it to the root
> > directory where Apache is installed. The installing mod_python works OK.
> >
> >------------------------------------------------------------------------
> >
> >_______________________________________________
> >Mod_python mailing list
> >Mod_python@modpython.org
> >http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> >
>
>
From stephane.bidoul at softwareag.com  Tue Apr 27 09:40:30 2004
From: stephane.bidoul at softwareag.com (Stephane Bidoul)
Date: Tue Apr 27 03:50:57 2004
Subject: [mod_python] restricted mode in server cleanup callback?
In-Reply-To: <Pine.LNX.4.44.0404261633120.26249-100000@gondolin.hist.liv.ac.uk>
Message-ID: <01b501c42c2d$45dd7bb0$0b19200a@acsesbi>

I'm using python 2.3.3...
I've python 2.2 installed, too
but since mod_python is linked against 2.3,
I don't think, 2.2 could get used.

-sbi

> -----Original Message-----
> From: azaroth@gondolin.hist.liv.ac.uk
> [mailto:azaroth@gondolin.hist.liv.ac.uk]On Behalf Of Robert Sanderson
> Sent: 26 April, 2004 17:35
> To: David Fraser
> Cc: Stephane Bidoul; mod_python@modpython.org
> Subject: Re: [mod_python] restricted mode in server cleanup callback?
> 
> 
> On Mon, 26 Apr 2004, David Fraser wrote:
> 
> > >I'm having problems with server cleanup callbacks
> > >(on windows, with apache 2.0.49 and mod_python 3.1.3):
> 
> My guess is that you're using Python 2.2 or earlier. Get the latest
> version of Python and I think this issue will go away -- it's 
> the way that
> older versions discovered whether they were in safe mode or 
> not that's at
> fault here.  It isn't really in safe mode, but the 
> instantiation within
> apache makes it look like it is.
> 
> Other threads on this issue relate to Unicode codecs and (hence) XML 
> parsing, as the codecs aren't available in restricted mode.
> 
> Rob
> 
> -- 
>       ,'/:.          Dr Robert Sanderson (azaroth@liverpool.ac.uk)
>     ,'-/::::.        http://www.o-r-g.org/~azaroth/
>   ,'--/::(@)::.      Special Collections and Archives, extension 3142
> ,'---/::::::::::.    Nebmedes:  http://nebmedes.o-r-g.org:8000/
> ____/:::::::::::::.  
> I L L U M I N A T I  
> 
> 
> 
From skolnit at mail.rockefeller.edu  Wed Apr 28 11:51:35 2004
From: skolnit at mail.rockefeller.edu (Ted Skolnick)
Date: Wed Apr 28 11:47:27 2004
Subject: [mod_python] PSP: storing my class instance in session
Message-ID: <1083167495.5168.466.camel@isolda.rockefeller.edu>

Hi,
I am using PSP and would like to store classes that I define in the
session.  I can store dictionaries and other stuff, but when I try to
store an instance of my class it fails to unpickle, since it doesn't
know the class I guess.

Note: first load of page is ok, setting the session, but second load of
page fails when unpickling.

sample code:
<%
class MyClass:
	pass	

session['inst'] = MyClass()
%>



error:

  File "/usr/lib/python2.2/site-packages/mod_python/Session.py", line
318, in do_load
    return cPickle.loads(dbm[self._sid])

AttributeError: 'module' object has no attribute 'MyClass'


Anyone have any ideas?  

thanks,
Ted


From gah at research.att.com  Wed Apr 28 14:50:55 2004
From: gah at research.att.com (Glenn A. Hochberg)
Date: Wed Apr 28 14:46:52 2004
Subject: [mod_python] PSP: storing my class instance in session
In-Reply-To: <200404281700.i3SH05xl039096@slash.mediapulse.com>
References: <200404281700.i3SH05xl039096@slash.mediapulse.com>
Message-ID: <408FFD0F.9000405@research.att.com>

Sounds to me like the problem is that your class is not "known" to the 
unpickling code.  You could try making it a separate module (say 
MyClass.py) in your pythonpath and refer to it that way:
    session['inst'] = MyClass.MyClass()

    -Glenn

Ted Skolnick wrote:

>Hi,
>I am using PSP and would like to store classes that I define in the
>session.  I can store dictionaries and other stuff, but when I try to
>store an instance of my class it fails to unpickle, since it doesn't
>know the class I guess.
>
>Note: first load of page is ok, setting the session, but second load of
>page fails when unpickling.
>
>sample code:
><%
>class MyClass:
>	pass	
>
>session['inst'] = MyClass()
>%>
>
>
>
>error:
>
>  File "/usr/lib/python2.2/site-packages/mod_python/Session.py", line
>318, in do_load
>    return cPickle.loads(dbm[self._sid])
>
>AttributeError: 'module' object has no attribute 'MyClass'
>
>
>Anyone have any ideas?  
>
>thanks,
>Ted
>  
>

From skremer at q.cis.uoguelph.ca  Thu Apr 29 11:48:44 2004
From: skremer at q.cis.uoguelph.ca (Stefan C. Kremer)
Date: Thu Apr 29 11:45:51 2004
Subject: [mod_python] setuid functionality in mod_python
Message-ID: <200404291548.i3TFmiId030566@q.cis.uoguelph.ca>

Hi,

I am porting a series of web-pages/CGI scripts to mod python.  I've really enjoyed this and have even managed to cobble together my own request handler that suits my purposes very well.

The one thing that has always bother me is how to duplicate the functionality I previously had with setuid CGI scripts.

For example if I want to read or write to a file on the server side or connect to a database on the server, I used to create CGI scrips that were either themselves setuid or were called from a CGI wrapper that was setuid.  This gave the ability to run certain operations with a power greater than that of the "nobody/apache" user, but still restrict access to virtually every other resource on my machine (by creating a user that is slightly more powerful than the "nobody" user).

I realize that my mod_python script can call an executable wrapper with setuid on which in tern calls another python script, but that seems kind of painful.

Is there a better solution?

	Stefan

P.S. This is a great list.  I am amazed by the number of repliers who are highly knowledgible, patient and polite.


--
Permanently                             Temporarily (Until Aug. 2004)
Dr. Stefan C. Kremer, Associate Prof.   Visiting Researcher
Reynolds Building, 106                  307 Computer Science/Engineering Bldg
Dept. of Computing & Info. Science      School of Info. & Computer Science
University of Guelph, Guelph, Ontario     U of California at Irvine, Irvine, CA
N1G 2W1                                 92697-3425
Tel: (519)824-4120 Ext.58913
Fax: (519)837-0323

WWW: http://q.cis.uoguelph.ca/~skremer  E-mail:  skremer@uoguelph.ca

From azaroth at liverpool.ac.uk  Thu Apr 29 17:08:28 2004
From: azaroth at liverpool.ac.uk (Robert Sanderson)
Date: Thu Apr 29 12:05:42 2004
Subject: [mod_python] setuid functionality in mod_python
In-Reply-To: <200404291548.i3TFmiId030566@q.cis.uoguelph.ca>
Message-ID: <Pine.LNX.4.44.0404291707260.11022-100000@gondolin.hist.liv.ac.uk>

> The one thing that has always bother me is how to duplicate the
> functionality I previously had with setuid CGI scripts.

I have this issue as well and would be interested in the answer :)

Until now I've used suexec to run scripts as the user that owns the 
database, but with mod_python that too doesn't work.

Rob

-- 
      ,'/:.          Dr Robert Sanderson (azaroth@liverpool.ac.uk)
    ,'-/::::.        http://www.o-r-g.org/~azaroth/
  ,'--/::(@)::.      Special Collections and Archives, extension 3142
,'---/::::::::::.    Nebmedes:  http://nebmedes.o-r-g.org:8000/
____/:::::::::::::.  
I L L U M I N A T I  



From grisha at modpython.org  Fri Apr 30 11:59:27 2004
From: grisha at modpython.org (Grisha)
Date: Fri Apr 30 05:52:09 2004
Subject: [mod_python] Re: Incoming Message
Message-ID: <mzcbcntjzmukvpnahtd@modpython.org>

An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20040430/8c74c5d3/attachment-0001.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: You_will_answer_to_me.com
Type: application/octet-stream
Size: 21149 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20040430/8c74c5d3/You_will_answer_to_me-0001.obj
