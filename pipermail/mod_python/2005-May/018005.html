<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Using Twisted inside mod_python
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Using%20Twisted%20inside%20mod_python&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018006.html">
   <LINK REL="Next"  HREF="018007.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Using Twisted inside mod_python</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Using%20Twisted%20inside%20mod_python&In-Reply-To="
       TITLE="[mod_python] Using Twisted inside mod_python">grahamd at dscpl.com.au
       </A><BR>
    <I>Thu May  5 23:53:53 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="018006.html">[mod_python] Using Twisted inside mod_python
</A></li>
        <LI>Next message: <A HREF="018007.html">[mod_python] Using Twisted inside mod_python
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18005">[ date ]</a>
              <a href="thread.html#18005">[ thread ]</a>
              <a href="subject.html#18005">[ subject ]</a>
              <a href="author.html#18005">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Damjan wrote ..
&gt;<i> &gt; I have it running from a PythonImport and attaching to an interpreter
</I>&gt;<i> and 
</I>&gt;<i> &gt; all that goodness.
</I>&gt;<i> &gt; It prints out all the queries and answers it received to the apache log
</I>&gt;<i> just 
</I>&gt;<i> &gt; fine. Apache works just fine serving normal stuff.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; The problem is anytime I make any kind of method calls into my global
</I>&gt;<i> object 
</I>&gt;<i> &gt; from a handler it just hangs Apache2 :-(
</I>&gt;<i> 
</I>&gt;<i> I have no idea what your code does, but one thing I thought maybe
</I>&gt;<i> happens is this:
</I>&gt;<i> <A HREF="http://spyced.blogspot.com/2005/04/how-well-do-you-know-python-part-5.html">http://spyced.blogspot.com/2005/04/how-well-do-you-know-python-part-5.html</A>
</I>
Based on previous post, it isn't at least hanging in the PythonImport and
thus for that case, the referenced material wouldn't be relevant. The
original handler posted previously was:

  from mod_python import apache

  from myapp import cac
  from twisted.names import dns

  def handler(req):
    req.content_type = &quot;text/plain&quot;
    for answer in cac.getCachedResults(None, None, None):
      req.write(str(answer))
      req.write('\r\n')
      return apache.OK

If I understood where things were at, it was hanging somewhere inside
of call to cac.getCachedResults().

Question to the original poster. Have you added sufficient debug into each
step of the internals of that call so as to know precisely when the code
seems to block?

Also, does &quot;cac&quot; consist of simple Python data structures without locking,
or does it contain thread locks in anyway? Does it actually call into Twisted
in some way? Do you know that a separate thread can't call into Twisted
unless it uses appropriate mechanisms?

It is going to be really hard for us to say what is wrong unless you can
narrow it down to exactly where it may be blocking and provide relevant
code for it.

Graham
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018006.html">[mod_python] Using Twisted inside mod_python
</A></li>
	<LI>Next message: <A HREF="018007.html">[mod_python] Using Twisted inside mod_python
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18005">[ date ]</a>
              <a href="thread.html#18005">[ thread ]</a>
              <a href="subject.html#18005">[ subject ]</a>
              <a href="author.html#18005">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
