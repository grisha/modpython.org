<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Re: Re: any way to get the current handler's directory?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Re%3A%20Re%3A%20any%20way%20to%20get%20the%20current%20handler%27s%20directory%3F&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017972.html">
   <LINK REL="Next"  HREF="017974.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Re: Re: any way to get the current handler's directory?</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>vegetax</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Re%3A%20Re%3A%20any%20way%20to%20get%20the%20current%20handler%27s%20directory%3F&In-Reply-To="
       TITLE="[mod_python] Re: Re: any way to get the current handler's directory?">vegeta.z at gmail.com
       </A><BR>
    <I>Sun May  1 02:29:02 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="017972.html">[mod_python] Re: any way to get the current handler's directory?
</A></li>
        <LI>Next message: <A HREF="017974.html">[mod_python] Re: Re: any way to get the current handler's
	directory?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17973">[ date ]</a>
              <a href="thread.html#17973">[ thread ]</a>
              <a href="subject.html#17973">[ subject ]</a>
              <a href="author.html#17973">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Graham Dumpleton wrote:

&gt;<i> 
</I>&gt;<i> On 01/05/2005, at 3:40 PM, vegetax wrote:
</I>&gt;&gt;&gt;<i> Depends on which version of mod_python you are using. If you need to
</I>&gt;&gt;&gt;<i> be
</I>&gt;&gt;&gt;<i> portable to older versions of mod_python, use:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>        if hasattr(req,&quot;hlist&quot;):
</I>&gt;&gt;&gt;<i>          # In mod_python 3.X have the req.hlist member.
</I>&gt;&gt;&gt;<i>          handler_root = req.hlist.directory
</I>&gt;&gt;&gt;<i>        elif hasattr(req,&quot;get_dirs&quot;):
</I>&gt;&gt;&gt;<i>          # In mod_python 2.X have the req.get_dirs() method.
</I>&gt;&gt;&gt;<i>          handler_root = req.get_dirs()[&quot;PythonHandler&quot;]
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Graham
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Thanks graham, forgot to mention that i also need the uri part of the
</I>&gt;&gt;<i> current handler,ie:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &lt;Directory &quot;/var/www/mywebapp/handler_root&quot;&gt;
</I>&gt;&gt;<i>   SetHandler&#160;mod_python
</I>&gt;&gt;<i>   PythonHandler&#160;myhandler
</I>&gt;&gt;<i>   PythonOption&#160;dirpath&#160;&quot;/mywebapp/handler_root&quot;
</I>&gt;&gt;<i> &lt;Directory/&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Any way to get this information in one step? without having to
</I>&gt;&gt;<i> req.filename[len(req.hlist.directory): ]
</I>&gt;<i> 
</I>&gt;<i> Use a package which has worked it out for you and already provides a
</I>&gt;<i> dispatch mechanism. ;-)
</I>&gt;<i> 
</I>&gt;<i> That would at least save you having to work out how to do it yourself
</I>&gt;<i> which would I guess eliminate the step altogether. Have you ever looked
</I>&gt;<i> at Vampire (<A HREF="http://www.dscpl.com.au/projects/vampire">http://www.dscpl.com.au/projects/vampire</A>).
</I>&gt;<i> 
</I>&gt;<i> Anyway, I would recommend not trying to cut corners, have seen it
</I>&gt;<i> many times on the list where people write their own dispatch mechanisms
</I>&gt;<i> not knowing that it will not work in all situations. Ie., would break
</I>&gt;<i> if done in mod_userdir directory, would break in a subdirectory of
</I>&gt;<i> handler root etc etc.
</I>&gt;<i> 
</I>&gt;<i> In Vampire where this sort of determination of additional path_info
</I>&gt;<i> is calculated, I use:
</I>&gt;<i> 
</I>&gt;<i>        handler_root = None
</I>&gt;<i> 
</I>&gt;<i>        if hasattr(req,&quot;hlist&quot;):
</I>&gt;<i>          # In mod_python 3.X have the req.hlist member.
</I>&gt;<i>          handler_root = req.hlist.directory
</I>&gt;<i>        elif hasattr(req,&quot;get_dirs&quot;):
</I>&gt;<i>          # In mod_python 2.X have the req.get_dirs() method.
</I>&gt;<i>          handler_root = req.get_dirs()[&quot;PythonHandler&quot;]
</I>&gt;<i> 
</I>&gt;<i>        if handler_root is None:
</I>&gt;<i>          raise apache.SERVER_RETURN, apache.HTTP_INTERNAL_SERVER_ERROR
</I>&gt;<i> 
</I>&gt;<i>        length = len(req.filename) - len(handler_root)
</I>&gt;<i> 
</I>&gt;<i>        path_info = &quot;/&quot;
</I>&gt;<i> 
</I>&gt;<i>        if length != 0:
</I>&gt;<i>          path_info += req.filename[-length:]
</I>&gt;<i> 
</I>&gt;<i> What is it that you are actually trying to do? See if Vampire might
</I>&gt;<i> already provide what you need and save yourself some work. Am happy
</I>&gt;<i> to explain whether Vampire might help in what you are doing.
</I>&gt;<i> 
</I>&gt;<i> Graham
</I>
Basically is a version of publisher handler,targeted to a specific
webframework,the publisher handler is sloww cause it tries to be
everything,too generic, my handler will just serve .py scripts and thats
all, is not meant to serve several resources,or work with user_dir or have
subdirectories, since subdirectories will be mapped to python packages by
the handler.
I am obsessed about making it fast, so thats why i wanted to get that info
in one step instead of two.


</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017972.html">[mod_python] Re: any way to get the current handler's directory?
</A></li>
	<LI>Next message: <A HREF="017974.html">[mod_python] Re: Re: any way to get the current handler's
	directory?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17973">[ date ]</a>
              <a href="thread.html#17973">[ thread ]</a>
              <a href="subject.html#17973">[ subject ]</a>
              <a href="author.html#17973">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
