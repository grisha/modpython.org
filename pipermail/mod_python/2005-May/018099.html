<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] os.system() call does not work within mod_python
	script
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20os.system%28%29%20call%20does%20not%20work%20within%20mod_python%0A%09script&In-Reply-To=1116166936.1115.237.camel%40cm61-10-50-104.hkcable.com.hk">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018097.html">
   <LINK REL="Next"  HREF="018098.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] os.system() call does not work within mod_python
	script</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Arno Wilhelm</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20os.system%28%29%20call%20does%20not%20work%20within%20mod_python%0A%09script&In-Reply-To=1116166936.1115.237.camel%40cm61-10-50-104.hkcable.com.hk"
       TITLE="[mod_python] os.system() call does not work within mod_python
	script">quirxi at aon.at
       </A><BR>
    <I>Sun May 15 15:00:17 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="018097.html">[mod_python] os.system() call does not work within mod_python
	script
</A></li>
        <LI>Next message: <A HREF="018098.html">[mod_python] Sessions and Firefox
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18099">[ date ]</a>
              <a href="thread.html#18099">[ thread ]</a>
              <a href="subject.html#18099">[ subject ]</a>
              <a href="author.html#18099">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi

&gt;<i> One concern: are there any security risks involved here? It is not just
</I>&gt;<i> because that Apache runs as such a special unprivileged user. You
</I>&gt;<i> basically appear to open a door out of that sandbox. It is generally not
</I>&gt;<i> that hard to recognise Python is being used (e.g. urls ending in .py,
</I>&gt;<i> comments in the html source, .psp extensions).
</I>&gt;<i> 
</I>&gt;<i> Any comments, anyone?
</I>
I do not think that is a big security risk if you take some precautions.
Never let anybody else have access to your computer so that he can change the 
scripts directly. Nor would I use variables as an argument to the os.system call ...
I think this mod_suexec was made in order to allow a save execution of cgi scripts.
Here is a good page that deals with that security concern:
<A HREF="http://httpd.apache.org/docs-2.0/suexec.html">http://httpd.apache.org/docs-2.0/suexec.html</A>

But I have to admit that I am not a security expert and as usual - a talented 
hacker with enough time might find a way to break into the system :(


regards,

quirxi



&gt;<i> Wouter.
</I>&gt;<i> 
</I>&gt;<i> On Sun, 2005-05-15 at 12:59 +0200, Arno Wilhelm wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i>Hello,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>thanks for your help.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>I have resolved the issue now. User apache is not allowed to issue (almost) any 
</I>&gt;&gt;<i>command. I had to load the suexec module that uses the command suexec2 in order 
</I>&gt;&gt;<i>to get that to work!
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>The only command that worked without the suexec_module was the echo command:
</I>&gt;&gt;<i>system( &quot;/bin/echo Hello_mod_python &gt;&gt; /tmp/dummy.log 2&gt;&amp;1&quot; )
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>Any other command from within a mod_python script did not show any results, 
</I>&gt;&gt;<i>except an empty /tmp/dummy file (but not even an error message) at all!
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>When I load the suexec_module in apache2.conf like this:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>LoadModule suexec_module      modules/mod_suexec.so
</I>&gt;&gt;<i>SuexecUserGroup root root
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>apache2 seems to issue the command with the help of the suexec2 utility:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i># suexec2 -V
</I>&gt;&gt;<i>  -D AP_DOC_ROOT=&quot;/var/www&quot;
</I>&gt;&gt;<i>  -D AP_GID_MIN=100
</I>&gt;&gt;<i>  -D AP_HTTPD_USER=&quot;apache&quot;
</I>&gt;&gt;<i>  -D AP_LOG_EXEC=&quot;/var/log/apache2/suexec_log&quot;
</I>&gt;&gt;<i>  -D AP_SAFE_PATH=&quot;/usr/local/bin:/usr/bin:/bin&quot;
</I>&gt;&gt;<i>  -D AP_SUEXEC_UMASK=077
</I>&gt;&gt;<i>  -D AP_UID_MIN=1000
</I>&gt;&gt;<i>  -D AP_USERDIR_SUFFIX=&quot;public_html&quot;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>See also this website for more details:
</I>&gt;&gt;<i><A HREF="http://blog.develix.com/archives/33-Configuring-Apache-and-PHP-to-use-mod_suexec.html">http://blog.develix.com/archives/33-Configuring-Apache-and-PHP-to-use-mod_suexec.html</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>Thanks and greetings,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>quirxi
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>Graham Dumpleton wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>On 15/05/2005, at 8:08 AM, Arno Wilhelm wrote:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>Hello,
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>I have got a proble for which I cannot find a proper solution:
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>Whenever a user on his browser hits a certain page (served by 
</I>&gt;&gt;&gt;&gt;<i>mod_python) the mod_python should send a SIGUSR signal to a certain 
</I>&gt;&gt;&gt;&gt;<i>process in order to force a update on him like this
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i># os.system( &quot;kill -s SIGUSR1 26199&quot; )
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>Whenever I make this call from within a python script it works. But 
</I>&gt;&gt;&gt;&gt;<i>whenever I try to build it into the mod_python script that is handled 
</I>&gt;&gt;&gt;&gt;<i>by apache it does not work. After that I have experimented with other 
</I>&gt;&gt;&gt;&gt;<i>os.system calls from within mod_python scripts and all of them seem to 
</I>&gt;&gt;&gt;&gt;<i>be ignored somehow.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>Could someone here possibly shed some light on this issue, since I am 
</I>&gt;&gt;&gt;&gt;<i>on the end of my knowledge.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>A few things to consider.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>1. Set full pathnames to the programs in the command.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>The PATH setup for Apache may not be that useful. It may reference
</I>&gt;&gt;&gt;<i>some standard locations, but not much. Thus, if you expect program
</I>&gt;&gt;&gt;<i>to be found by searching PATH, it may not work.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>2. Don't rely on the current working directory to be anything specific.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>Normally current working directory would be '/' and nothing to to do
</I>&gt;&gt;&gt;<i>with where any Python request handler will be. Any references to files
</I>&gt;&gt;&gt;<i>should always be as absolute paths.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>3. Apache usually runs as user &quot;nobody&quot; or some other special user.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>Because Apache runs as a special user, it often will not have the
</I>&gt;&gt;&gt;<i>necessary privileges to be able to write to directories or send signals
</I>&gt;&gt;&gt;<i>to processes running as another user.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>4. Log output of scripts to a directory in &quot;/tmp&quot;.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>As a way of working out problems, send the output of any commands to
</I>&gt;&gt;&gt;<i>a log file in &quot;/tmp&quot;. Ie., run your command as:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>  os.system( &quot;kill -s SIGUSR1 26199 &gt;&gt; /tmp/dummy.log 2&gt;&amp;1&quot; )
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>This will allow you to see any errors. With the way that Apache works,
</I>&gt;&gt;&gt;<i>you might not otherwise see errors generated by a call to os.system()
</I>&gt;&gt;&gt;<i>until Apache is shutdown and certain buffers are flushed out.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>Graham
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>_______________________________________________
</I>&gt;&gt;<i>Mod_python mailing list
</I>&gt;&gt;<i><A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;&gt;<i><A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018097.html">[mod_python] os.system() call does not work within mod_python
	script
</A></li>
	<LI>Next message: <A HREF="018098.html">[mod_python] Sessions and Firefox
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18099">[ date ]</a>
              <a href="thread.html#18099">[ thread ]</a>
              <a href="subject.html#18099">[ subject ]</a>
              <a href="author.html#18099">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
