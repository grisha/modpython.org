<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Submitting a form with unknown number of items
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Submitting%20a%20form%20with%20unknown%20number%20of%20items&In-Reply-To=4297B9CD.7040704%40ruff.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018208.html">
   <LINK REL="Next"  HREF="018211.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Submitting a form with unknown number of items</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Submitting%20a%20form%20with%20unknown%20number%20of%20items&In-Reply-To=4297B9CD.7040704%40ruff.com"
       TITLE="[mod_python] Submitting a form with unknown number of items">grahamd at dscpl.com.au
       </A><BR>
    <I>Fri May 27 23:33:44 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="018208.html">[mod_python] Submitting a form with unknown number of items
</A></li>
        <LI>Next message: <A HREF="018211.html">[mod_python] Mod python + apache problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18210">[ date ]</a>
              <a href="thread.html#18210">[ thread ]</a>
              <a href="subject.html#18210">[ subject ]</a>
              <a href="author.html#18210">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On 28/05/2005, at 10:22 AM, Jason Lanquist wrote:

&gt;<i> Hi there, I can handle form data when I know how many items are  
</I>&gt;<i> returned.  I use a fixed number of parameters when someone signs up  
</I>&gt;<i> like:
</I>&gt;<i>
</I>&gt;<i> def form_submit1(req,uname,passwd,passwd2,email,city,st,zip,country):
</I>&gt;<i>  ...
</I>&gt;<i>  ...
</I>&gt;<i>  ...
</I>&gt;<i>
</I>&gt;<i> But when I have a varying number of form items (they are generated by  
</I>&gt;<i> data) I'm not sure how many there will be so how is that handled?  I  
</I>&gt;<i> tried to use &quot;FieldStorage&quot; as the only parameter (thinking it would  
</I>&gt;<i> be a list of form items) besides req but that doesn't work:
</I>&gt;<i>
</I>&gt;<i> def buy_fromstore(req,FieldStorage):
</I>&gt;<i>  ...
</I>&gt;<i>  ...
</I>&gt;<i>  ...
</I>&gt;<i>
</I>&gt;<i> How do you handle form data when you don't know how many items will be  
</I>&gt;<i> returned?
</I>
Assuming here that you are using mod_python.publisher. If that is the  
case, define
your method to accept a keyword parameter list argument. You can then  
go through
the dictionary keys and look for form parameters:

   def buy_fromstore(req,**params):
     for name in params.keys():
       req.log_error(str((name,params[name])))

You can still have named parameters at the same time:

   def buy_fromstore(req,uname,passwd,**params):
     ...

You obviously need to interpret the names of the form parameters in the  
dictionary.

For a different way of doing this, you might look at Vampire. When  
using its equivalent
to mod_python.publisher, you can have form parameters labeled as:

   item-1
   item-2
   item-3

and they willbe  automatically passed as a single parameter called  
&quot;item&quot; where the
value for each actual form parameter is then stored in a list. One  
could also have:

   entry.a
   entry.b
   entry.c

and the result will be a dictionary instead of a list. One can mix the  
form naming
conventions to get combination of both.

See:

   <A HREF="http://www.dscpl.com.au/projects/vampire/articles/vampire-003.html">http://www.dscpl.com.au/projects/vampire/articles/vampire-003.html</A>

for a description of how Vampire treats form parameters. Although the  
documentation
mainly shows use of this mechanism for Vampire's basic content  
handlers, also applies
to vampire:publisher drop in replacement for mod_python.publisher.

This form of automatic conversion of form parameters into structured  
lists and
dictionaries is really useful for example when you have a large list of  
selectable
items in a form. The selected set of items ends up being in one  
parameter which you
just iterate over.

If you want to play with this without getting down Vampire, construct  
some forms
following the conventions and post it to:

    
<A HREF="http://www.dscpl.com.au/projects/vampire/examples/templates/">http://www.dscpl.com.au/projects/vampire/examples/templates/</A> 
form_values.html

Eg:

    
<A HREF="http://www.dscpl.com.au/projects/vampire/examples/templates/">http://www.dscpl.com.au/projects/vampire/examples/templates/</A> 
form_values.html?a-1=a1&amp;a-2=a2&amp;b.c=bc&amp;b.d=bd

Graham

</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018208.html">[mod_python] Submitting a form with unknown number of items
</A></li>
	<LI>Next message: <A HREF="018211.html">[mod_python] Mod python + apache problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18210">[ date ]</a>
              <a href="thread.html#18210">[ thread ]</a>
              <a href="subject.html#18210">[ subject ]</a>
              <a href="author.html#18210">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
