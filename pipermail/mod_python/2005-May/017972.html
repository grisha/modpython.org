<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Re: any way to get the current handler's directory?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Re%3A%20any%20way%20to%20get%20the%20current%20handler%27s%20directory%3F&In-Reply-To=d51pp2%24jgq%241%40sea.gmane.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017971.html">
   <LINK REL="Next"  HREF="017973.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Re: any way to get the current handler's directory?</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Re%3A%20any%20way%20to%20get%20the%20current%20handler%27s%20directory%3F&In-Reply-To=d51pp2%24jgq%241%40sea.gmane.org"
       TITLE="[mod_python] Re: any way to get the current handler's directory?">grahamd at dscpl.com.au
       </A><BR>
    <I>Sun May  1 02:06:01 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="017971.html">[mod_python] Re: any way to get the current handler's directory?
</A></li>
        <LI>Next message: <A HREF="017973.html">[mod_python] Re: Re: any way to get the current handler's directory?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17972">[ date ]</a>
              <a href="thread.html#17972">[ thread ]</a>
              <a href="subject.html#17972">[ subject ]</a>
              <a href="author.html#17972">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On 01/05/2005, at 3:40 PM, vegetax wrote:
&gt;&gt;<i> Depends on which version of mod_python you are using. If you need to 
</I>&gt;&gt;<i> be
</I>&gt;&gt;<i> portable to older versions of mod_python, use:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>        if hasattr(req,&quot;hlist&quot;):
</I>&gt;&gt;<i>          # In mod_python 3.X have the req.hlist member.
</I>&gt;&gt;<i>          handler_root = req.hlist.directory
</I>&gt;&gt;<i>        elif hasattr(req,&quot;get_dirs&quot;):
</I>&gt;&gt;<i>          # In mod_python 2.X have the req.get_dirs() method.
</I>&gt;&gt;<i>          handler_root = req.get_dirs()[&quot;PythonHandler&quot;]
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Graham
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Thanks graham, forgot to mention that i also need the uri part of the
</I>&gt;<i> current handler,ie:
</I>&gt;<i>
</I>&gt;<i> &lt;Directory &quot;/var/www/mywebapp/handler_root&quot;&gt;
</I>&gt;<i>   SetHandler&#160;mod_python
</I>&gt;<i>   PythonHandler&#160;myhandler
</I>&gt;<i>   PythonOption&#160;dirpath&#160;&quot;/mywebapp/handler_root&quot;
</I>&gt;<i> &lt;Directory/&gt;
</I>&gt;<i>
</I>&gt;<i> Any way to get this information in one step? without having to
</I>&gt;<i> req.filename[len(req.hlist.directory): ]
</I>
Use a package which has worked it out for you and already provides a
dispatch mechanism. ;-)

That would at least save you having to work out how to do it yourself
which would I guess eliminate the step altogether. Have you ever looked
at Vampire (<A HREF="http://www.dscpl.com.au/projects/vampire">http://www.dscpl.com.au/projects/vampire</A>).

Anyway, I would recommend not trying to cut corners, have seen it
many times on the list where people write their own dispatch mechanisms
not knowing that it will not work in all situations. Ie., would break
if done in mod_userdir directory, would break in a subdirectory of
handler root etc etc.

In Vampire where this sort of determination of additional path_info
is calculated, I use:

       handler_root = None

       if hasattr(req,&quot;hlist&quot;):
         # In mod_python 3.X have the req.hlist member.
         handler_root = req.hlist.directory
       elif hasattr(req,&quot;get_dirs&quot;):
         # In mod_python 2.X have the req.get_dirs() method.
         handler_root = req.get_dirs()[&quot;PythonHandler&quot;]

       if handler_root is None:
         raise apache.SERVER_RETURN, apache.HTTP_INTERNAL_SERVER_ERROR

       length = len(req.filename) - len(handler_root)

       path_info = &quot;/&quot;

       if length != 0:
         path_info += req.filename[-length:]

What is it that you are actually trying to do? See if Vampire might
already provide what you need and save yourself some work. Am happy
to explain whether Vampire might help in what you are doing.

Graham

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017971.html">[mod_python] Re: any way to get the current handler's directory?
</A></li>
	<LI>Next message: <A HREF="017973.html">[mod_python] Re: Re: any way to get the current handler's directory?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17972">[ date ]</a>
              <a href="thread.html#17972">[ thread ]</a>
              <a href="subject.html#17972">[ subject ]</a>
              <a href="author.html#17972">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
