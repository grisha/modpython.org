<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] How to stop PSP Page Cache
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20How%20to%20stop%20PSP%20Page%20Cache&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017987.html">
   <LINK REL="Next"  HREF="017989.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] How to stop PSP Page Cache</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20How%20to%20stop%20PSP%20Page%20Cache&In-Reply-To="
       TITLE="[mod_python] How to stop PSP Page Cache">grahamd at dscpl.com.au
       </A><BR>
    <I>Tue May  3 19:50:00 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="017987.html">[mod_python] apache httpd with makefile
</A></li>
        <LI>Next message: <A HREF="017989.html">[mod_python] How to stop PSP Page Cache
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17988">[ date ]</a>
              <a href="thread.html#17988">[ thread ]</a>
              <a href="subject.html#17988">[ subject ]</a>
              <a href="author.html#17988">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Asif Jan wrote ..
&gt;<i> 
</I>&gt;<i> Hello, I am using mod_python 3.1.4, and doing psp development. The 
</I>&gt;<i> pages work fine without any probelms. However, when I change the psp 
</I>&gt;<i> page on disk the changes are not reflected on the version that is 
</I>&gt;<i> served to client. I am not caching pages at the browser side.
</I>&gt;<i> 
</I>&gt;<i> However restarting the apache server results in correct page being 
</I>&gt;<i> served. Is there a way to tell psp handler not to cache the pages?
</I>
Although pages are cached, both the in memory cache and the DBM
caching mechanisms have code in them that should mean that if the
file is changed on disk, it will reload them. Ie., from file cache:

    def get(self, filename, mtime):
        try:
            hits, c_mtime, code = self.cache[filename]
            if mtime != c_mtime:
                del self.cache[filename]
                return None
            else:
                self.cache[filename] = (hits+1, mtime, code)
                return code
        except KeyError:
            return None 

and from DBM cache:

def dbm_cache_get(srv, dbmfile, filename, mtime):

    dbm_type = dbm_cache_type(dbmfile)
    _apache._global_lock(srv, &quot;pspcache&quot;)
    try:
        dbm = dbm_type.open(dbmfile, 'c')
        try:
            entry = dbm[filename]
            t, val = entry.split(&quot; &quot;, 1)
            if long(t) == mtime:
                return str2code(val)
        except KeyError: 
            return None
    finally:
        try: dbm.close()
        except: pass
        _apache._global_unlock(srv, &quot;pspcache&quot;)

Are you sure you aren't connecting to the server via a proxy with caching
enabled or some other caching system like Squid?

When you make the request after changing the file, do you actually see
a request logged in the Apache log file at that time to indicate that the
request is actually getting through to Apache?

Graham
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017987.html">[mod_python] apache httpd with makefile
</A></li>
	<LI>Next message: <A HREF="017989.html">[mod_python] How to stop PSP Page Cache
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17988">[ date ]</a>
              <a href="thread.html#17988">[ thread ]</a>
              <a href="subject.html#17988">[ subject ]</a>
              <a href="author.html#17988">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
