<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] PSP Notes (fwd)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20PSP%20Notes%20%28fwd%29&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006736.html">
   <LINK REL="Next"  HREF="006705.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] PSP Notes (fwd)</H1>
    <B>Gregory (Grisha) Trubetskoy</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20PSP%20Notes%20%28fwd%29&In-Reply-To="
       TITLE="[mod_python] PSP Notes (fwd)">grisha at apache.org
       </A><BR>
    <I>Fri Aug 29 17:23:24 EST 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="006736.html">[mod_python] Child shutdowns?
</A></li>
        <LI>Next message: <A HREF="006705.html">[mod_python] 
	Apache startup error using mod_python under Windows 2000 (have
	msvcr70.dll)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6725">[ date ]</a>
              <a href="thread.html#6725">[ thread ]</a>
              <a href="subject.html#6725">[ subject ]</a>
              <a href="author.html#6725">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<table border=0 width="100%"><tr><td>
<!--beginarticle-->
<PRE>
---------- Forwarded message ----------
Date: Wed, 13 Aug 2003 14:34:14 -0400 (EDT)
From: &quot;Gregory (Grisha) Trubetskoy&quot; &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">grisha at apache.org</A>&gt;
To: <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">python-dev at httpd.apache.org</A>
Subject: PSP Notes


As an excercise in PSP usability, I've been going through JSP examples
from Tomcat and rewriting them using PSP, here are random notes on the
subject.


* JSP has a notion of an application (e.g. &quot;/apps/mywebapp&quot;) with a
document root (e.g. /home/www/blah). Some stuff (e.g. location of classes)
then becomes relative to those paths. In PSP there isn't really a clear
concept of an application, but the closest thing to that is the directory
in which the PythonHandler directive is specified. This is nothing new,
btw, it's always how mod_python worked. So if you have:

&lt;Directory /home/www/psp&gt;
  AddHandler mod_python .psp   &lt;--note the new clever handler name
  PythonHandler mod_python.psp
&lt;/Directory&gt;

...then /home/www/psp will be prepended to sys.path, therefore if you
create a directory /home/www/psp/pylib, you could import a module from a
psp file like this:

&lt;%
from pylib import mymodule
%&gt;

This way you have your entire application under /home/www/psp, you can
use, say, /home/www/psp/html for psp/html and all your Python modules are
in /home/www/pylib, giving you a clear separation of logic and interface.


* Next thing that I ran into is having to reload mymodule if it changes.
There is now a new recommended way of doing this:

mymodule = apache.import_module(&quot;pylib.mymodule&quot;)

This is the same function that mod_python uses internally for autorelad
and takes care of all your reload needs. It does stat the file every time,
so when you're sure you won't need to reload the page, just change it to:

mymodule = apache.import_module(&quot;pylib.mymodule&quot;, autoreload=0)


* JSP page import directive

JSP:

&lt;%@ page import = &quot;num.NumberGuessBean&quot; %&gt;

PSP:

&lt;%
num = apache.import_module(&quot;pylib.num&quot;)
%&gt;
... now you've got num.NumberGuessBean, you get the idea


* JSP useBean action

JSP:

&lt;jsp:useBean id=&quot;numguess&quot; class=&quot;num.NumberGuessBean&quot; scope=&quot;session&quot;/&gt;

This means that numguess is an instance of num.NumberGuessBean and it will
persist for as long as the session exists.

PSP (again, no need for special syntax):

&lt;%
numguess = session.setdefault(&quot;numguess&quot;, num.NumberGuessBean())
%&gt;


* JSP setProperty

This will match up form elements and set them in a Java object. So if the
object defines setColor() and the form contains a field &quot;Color&quot;, JSP will
call setColor passing value of color as the argument.

JSP:

&lt;jsp:setProperty name=&quot;numguess&quot; property=&quot;*&quot;/&gt;

PSP:

Well, there isn't exactly this functionality, but there is something
different. You can use the same functionality that the publisher handler
uses to match up form elements with a function:

class Car:

    def __init__(self, color):

         # do something

Then a psp page called as result of a form submition can do this:

&lt;%
car = psp.apply_data(Car)
%&gt;

This will call the callable object Car (classes are callable), passing it
the value of &quot;color&quot;, and resulting in an instance of Car which is
assigned to car.


* &lt;%@ page session=&quot;false&quot;%&gt;

In JSP this means don't create a session for this page. This is really
easy in PSP - just don't mention the &quot;session&quot; variable in your page. The
psp handler examines the code for mentions of &quot;session&quot; and generates (and
locks) one if it encounters such mentions.


* page errorPage

JSP allows you to specify a special error page to be displayed when an
exception is thrown.

JSP:
&lt;%@ page errorPage=&quot;errorpge.jsp&quot; %&gt;

PSP:
&lt;%
psp.set_error_page(&quot;errorpge.psp&quot;)
%&gt;

When (if) errorpge.psp is invoked, it will have a global &quot;exception&quot;
variable which will contain same info as returned by sys.exc_info().

* include

Of course, PSP supports &lt;%@ include file=&quot;blah.html&quot;%&gt;



Grisha
</PRE>
<!--endarticle-->
</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006736.html">[mod_python] Child shutdowns?
</A></li>
	<LI>Next message: <A HREF="006705.html">[mod_python] 
	Apache startup error using mod_python under Windows 2000 (have
	msvcr70.dll)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6725">[ date ]</a>
              <a href="thread.html#6725">[ thread ]</a>
              <a href="subject.html#6725">[ subject ]</a>
              <a href="author.html#6725">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
