<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] mod_python + apache + winxp =&gt; could not
	importmod_python.apache
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20mod_python%20%2B%20apache%20%2B%20winxp%20%3D%3E%20could%20not%0A%09importmod_python.apache&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020823.html">
   <LINK REL="Next"  HREF="020825.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] mod_python + apache + winxp =&gt; could not
	importmod_python.apache</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20mod_python%20%2B%20apache%20%2B%20winxp%20%3D%3E%20could%20not%0A%09importmod_python.apache&In-Reply-To="
       TITLE="[mod_python] mod_python + apache + winxp =&gt; could not
	importmod_python.apache">grahamd at dscpl.com.au
       </A><BR>
    <I>Sun Apr  9 20:07:03 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="020823.html">[mod_python] mod_python / memcahced for on-the-fly rendering of
	latex in html
</A></li>
        <LI>Next message: <A HREF="020825.html">[mod_python] mod_python + apache + winxp =&gt; could
	notimportmod_python.apache
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20824">[ date ]</a>
              <a href="thread.html#20824">[ thread ]</a>
              <a href="subject.html#20824">[ subject ]</a>
              <a href="author.html#20824">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Jim Gallacher wrote ..
&gt;<i> cyberco wrote:
</I>&gt;<i> &gt;   On my system:
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; =============
</I>&gt;<i> &gt; mod_python 3.2.8
</I>&gt;<i> &gt; apache 2.0.55
</I>&gt;<i> &gt; python2.4
</I>&gt;<i> &gt; winxp
</I>&gt;<i> &gt; =============
</I>&gt;<i>
</I>&gt;<i> ...
</I>&gt;<i>
</I>&gt;<i> &gt; - At starup the Apache log states:
</I>&gt;<i> &gt; [Sun Apr 09 22:16:38 2006] [notice] Apache/2.0.55 (Win32) mod_python/3.2.5b
</I>&gt;<i> &gt; Python/2.4.2 configured -- resuming normal operations
</I>&gt;<i> 
</I>&gt;<i> It may just be a typo in your message, and even if not it may not be 
</I>&gt;<i> significant, but I notice that you say you are using mod_python 3.2.8 
</I>&gt;<i> but the apache log is showing version 3.2.5b. It might be worth 
</I>&gt;<i> investigating.
</I>
As a start for some internal self debugging by mod_python, how about
we make the following change:

Index: src/mod_python.c
===================================================================
--- src/mod_python.c    (revision 392846)
+++ src/mod_python.c    (working copy)
@@ -575,6 +575,9 @@
     const char *userdata_key = &quot;python_init&quot;;
     apr_status_t rc;
 
+    const char *py_compile_version = PY_VERSION;
+    const char *py_dynamic_version = 0;
+
     /* The &quot;initialized&quot; flag is a fudge for Mac OS X. It
      * addresses two issues. The first is that when an Apache
      * &quot;restart&quot; is performed, Apache will unload the mod_python
@@ -599,9 +602,17 @@
 
     /* mod_python version */
     ap_add_version_component(p, VERSION_COMPONENT);
-    
+
+    py_dynamic_version = strtok((char *)Py_GetVersion(), &quot; &quot;);
+
+    if (strcmp(py_compile_version, py_dynamic_version) != 0) {
+        ap_log_error(APLOG_MARK, APLOG_NOERRNO|APLOG_ERR, 0, s,
+                     &quot;python_init: Version mismatch, expected %s, found %s.&quot;,
+                     py_compile_version, py_dynamic_version);
+    }
+
     /* Python version */
-    sprintf(buff, &quot;Python/%.200s&quot;, strtok((char *)Py_GetVersion(), &quot; &quot;));
+    sprintf(buff, &quot;Python/%.200s&quot;, py_dynamic_version);
     ap_add_version_component(p, buff);
 
     /* cache main server */

Will this work, reliably across Python on different platforms? I think
it should as long as PyGetVersion() implementation hasn't changed
at some point.

There are some other points in code where other checks or debug
could be output. For example, if mod_python Python modules can't
be found, then dumpy out sys.path.

Even for the above, would be nice to dump out where Python thinks
it lives when such a mismatch occurs, as would highlight where
wrong version is coming from. Just need to work out a good way
of determining this, may need to wait until after Python has been
initialised though.

Graham
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020823.html">[mod_python] mod_python / memcahced for on-the-fly rendering of
	latex in html
</A></li>
	<LI>Next message: <A HREF="020825.html">[mod_python] mod_python + apache + winxp =&gt; could
	notimportmod_python.apache
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20824">[ date ]</a>
              <a href="thread.html#20824">[ thread ]</a>
              <a href="subject.html#20824">[ subject ]</a>
              <a href="author.html#20824">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
