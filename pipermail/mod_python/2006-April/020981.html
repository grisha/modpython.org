<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Authentication and security in general
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Authentication%20and%20security%20in%20general&In-Reply-To=5c06fa770604251400p58187dbdibe9557f462a76782%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020979.html">
   <LINK REL="Next"  HREF="020983.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Authentication and security in general</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Dan Eloff</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Authentication%20and%20security%20in%20general&In-Reply-To=5c06fa770604251400p58187dbdibe9557f462a76782%40mail.gmail.com"
       TITLE="[mod_python] Authentication and security in general">dan.eloff at gmail.com
       </A><BR>
    <I>Tue Apr 25 18:37:59 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="020979.html">[mod_python] Authentication and security in general
</A></li>
        <LI>Next message: <A HREF="020983.html">[mod_python] Authentication and security in general
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20981">[ date ]</a>
              <a href="thread.html#20981">[ thread ]</a>
              <a href="subject.html#20981">[ subject ]</a>
              <a href="author.html#20981">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 4/25/06, Deron Meranda &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">deron.meranda at gmail.com</A>&gt; wrote:
&gt;<i> On 4/25/06, Joshua Ginsberg &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">listspam at flowtheory.net</A>&gt; wrote:
</I>&gt;<i> &gt; &gt; Surely it can't be all that easy? There must be some tricks for
</I>&gt;<i> &gt; &gt; securing things that I'm not aware of. Something I'm misunderstanding?
</I>&gt;<i>
</I>&gt;<i> Proper website security is a very tough thing to get correct.
</I>&gt;<i> The history is littered with big companies that have gotten it
</I>&gt;<i> wrong: HotMail, Yahoo, Amazon, etc...  Fortunately for many
</I>&gt;<i> sites just close enough is good enough.  You really need to
</I>&gt;<i> determine what kind of security you need to figure out what to do.
</I>
Ironclad. I collect a lot of personal information about people
(including myself) and I don't want anybody else gaining access to
that.

&gt;<i> Using cookies instead of (or in addition to) HTTP authentication
</I>&gt;<i> (Basic/Digest) is in many cases somewhat better, mainly because
</I>&gt;<i> you have better control over the browser memorizing passwords
</I>&gt;<i> and that the server can make it easy to log off a user (just try to
</I>&gt;<i> log off when using HTTP authentication).
</I>
Tell me about. I just implemented a mixed authentication system
yesterday (wrote my own impl of basic auth protocol, because an auth
handler wasn't working well for me) and was annoyed to discover that
even when I logout, the browser logs me right back in. I ditched that
now. I could have saved myself the trouble had I done my research
better to start with.

&gt;<i> If you want to do any sort of log off or expiration, you should also
</I>&gt;<i> include the expiration date in the cookie content (and properly
</I>&gt;<i> encrypted or signed), since the actual cookie expiration property
</I>&gt;<i> is modifiable by the user.
</I>
How can anyone cause trouble like that? If a user goes to that much
bother to logout without being logged out, then he deserves to not be
logged out. Maybe on a shared computer it could be an issue, but you
shouldn't have a live session cookie on there anyway after your done
with it or you've got a security hole you could drive a tank through.

&gt;<i> And if not *everything* is over TLS/SSL, then it's not worth putting
</I>&gt;<i> too much effort into it anyway.  (Which, btw, google mail can
</I>&gt;<i> operate in all-SSL mode if you start at the page
</I>&gt;<i> <A HREF="https://mail.google.com/">https://mail.google.com/</A> when you first log in).
</I>
Confirmed, I don't think I'd worry about that at home, but I'd
definitely use that feature on public networks.

&gt;<i>Even then though,
</I>&gt;<i> if you're not validating client certificates, TLS/SSL is severely
</I>&gt;<i> handicapped already from man-in-the-middle attacks.
</I>
I don't understand that could you please briefly explain it? Why am I
not validating client certificates and how do I do that?

&gt;<i>
</I>&gt;<i> What I do (by using mod_python) is to use a cookie-based system.
</I>&lt;snip&gt;

Sounds very good actually.

Ok how's this for a design:

Login over https, send two cookies, each with a signed SID, one cookie
with secure enabled. Set the secure cookie with the path (say /secure)
where everything needs to be done with https.

If the unsecured cookie is present, and the SID checks out, and the
session is still valid, create the session (so basically the user is
logged in.) http is used preferentially after that. However any pages
where the user can access his information or do anything that you
wouldn't want someone else doing is in /secure and uses https. Mark
the session as 'secure' if the secured cookie is also present and the
SID checks out. Unless the session is marked secure for the /secure
directory, log them out and return them to the login screen. This
should be done in one place prior to handing off to a handler like you
did, so omitting it in a single handler doesn't create a security
hole.

One thing I'd love to know how to do though, is make sure all links
pointing to the /secure directory use https. I use purely relative
links inside my website because it makes moving code from development
server to production server and back really easy. Probably you could
do it with mod_rewrite.

Thanks for sharing your valuable input!

-Dan

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020979.html">[mod_python] Authentication and security in general
</A></li>
	<LI>Next message: <A HREF="020983.html">[mod_python] Authentication and security in general
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20981">[ date ]</a>
              <a href="thread.html#20981">[ thread ]</a>
              <a href="subject.html#20981">[ subject ]</a>
              <a href="author.html#20981">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
