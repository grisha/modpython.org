<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] PSP/Mac OS X line ending gotcha
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20PSP/Mac%20OS%20X%20line%20ending%20gotcha&In-Reply-To=EBEC980F-314E-4FF3-B5BA-E4236F932A31%40broadpark.no">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021029.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] PSP/Mac OS X line ending gotcha</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Jim Gallacher</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20PSP/Mac%20OS%20X%20line%20ending%20gotcha&In-Reply-To=EBEC980F-314E-4FF3-B5BA-E4236F932A31%40broadpark.no"
       TITLE="[mod_python] PSP/Mac OS X line ending gotcha">jpg at jgassociates.ca
       </A><BR>
    <I>Sat Apr 29 14:37:20 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="021029.html">[mod_python] PSP/Mac OS X line ending gotcha
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21030">[ date ]</a>
              <a href="thread.html#21030">[ thread ]</a>
              <a href="subject.html#21030">[ subject ]</a>
              <a href="author.html#21030">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Jeffrey A. Zelt wrote:
&gt;<i> I've only just started using mod_python, so please excuse this if it is 
</I>&gt;<i> documented in an obvious place.  Let me put it very simply.  On Mac OS 
</I>&gt;<i> X, make sure that your HTML files are terminated by :
</I>&gt;<i> 
</I>&gt;<i>    a line feed (ascii 10) and NOT a carriage return (ascii 13).
</I>&gt;<i> 
</I>&gt;<i> The Windows line ending of CRLF is also OK because it includes the line 
</I>&gt;<i> feed.  PSP does *not* like lines terminated by only a carriage return.  
</I>&gt;<i> Here is how I encountered this.  It should also indicate when you should 
</I>&gt;<i> look out for this issue.
</I>&gt;<i> 
</I>&gt;<i> I successfully implemented some functionality through a custom generic 
</I>&gt;<i> python handler - that went pretty smoothly.  Then I wanted to use PSP 
</I>&gt;<i> for simple templating.  Everything worked perfectly when I first 
</I>&gt;<i> introduced python expressions delimited by:
</I>&gt;<i> 
</I>&gt;<i>    &#8216;&lt;%=&#8217;  and  &#8216;%&gt;&#8217;
</I>&gt;<i> 
</I>&gt;<i> However, as soon as I tried using python code delimited by:
</I>&gt;<i> 
</I>&gt;<i>    &#8216;&lt;%&#8217;  and  &#8216;%&gt;&#8217;
</I>&gt;<i> 
</I>&gt;<i> all hell broke loose and I could not get anything to work.  A simplified 
</I>&gt;<i> version of what I was trying was something like:
</I>&gt;<i> 
</I>&gt;<i>     &lt;%
</I>&gt;<i>    for i in range(n):
</I>&gt;<i>        # start for loop
</I>&gt;<i>    %&gt;
</I>&gt;<i> 
</I>&gt;<i>         HTML code to repeat n times
</I>&gt;<i> 
</I>&gt;<i>    &lt;%
</I>&gt;<i>    # terminate for loop
</I>&gt;<i>    %&gt;
</I>&gt;<i> 
</I>&gt;<i> This just repeats the block of HTML code n times.  The details of the 
</I>&gt;<i> python code here are not important.  This construction triggered various 
</I>&gt;<i> errors, depending on the details of the python code I inserted into the 
</I>&gt;<i> page.  The problem was that I was using Adobe GoLive to edit my web 
</I>&gt;<i> pages and to insert the python code in the page (I am talking about the 
</I>&gt;<i> source view, not the WYSIWYG/Layout view).  My version of GoLive is a 
</I>&gt;<i> little old and still prefers to write files with carriage return line 
</I>&gt;<i> endings.  This was the default for the Mac OS before Mac OS X.  
</I>&gt;<i> Everything *looks* OK in the GoLive editor and it also looked OK in the 
</I>&gt;<i> other editors I chose to check the code (other editors would have tipped 
</I>&gt;<i> me off, but I did not use one of those).
</I>&gt;<i> 
</I>&gt;<i> However, it seems that the PSP engine, or whatever you want to call it, 
</I>&gt;<i> does not treat carriage returns as line endings, and therefore chokes 
</I>&gt;<i> badly when encountering code written this way.
</I>
The psp parser expects lines of python code to end in:

\r\n | \n | %&gt;

So using \r as the line terminator will indeed mess things up.

&gt;<i> GoLive has a menu item where you can select  the desired line 
</I>&gt;<i> terminator.  I selected &quot;Unix (LF)&quot;.  This made no visible change to the 
</I>&gt;<i> document when viewed in GoLive, but then suddenly the &lt;% ... %&gt; PSP 
</I>&gt;<i> parts of the document worked perfectly.
</I>&gt;<i> 
</I>&gt;<i> It is probably obvious when you think about it, but it is tricky to 
</I>&gt;<i> detect if you are bit by it because you may not visibly see anything 
</I>&gt;<i> wrong with the code you are editing.
</I>&gt;<i> 
</I>&gt;<i> I hope this helps someone avoid what I went through.
</I>
It should be easy enough to fix this. At the very least it should be 
documented.

I'll file a bug report. Thanks for your input.
Jim

</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021029.html">[mod_python] PSP/Mac OS X line ending gotcha
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21030">[ date ]</a>
              <a href="thread.html#21030">[ thread ]</a>
              <a href="subject.html#21030">[ subject ]</a>
              <a href="author.html#21030">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
