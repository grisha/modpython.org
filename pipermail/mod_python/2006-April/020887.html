<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Output Filters Redeaux
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Output%20Filters%20Redeaux&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020886.html">
   <LINK REL="Next"  HREF="020888.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Output Filters Redeaux</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Output%20Filters%20Redeaux&In-Reply-To="
       TITLE="[mod_python] Output Filters Redeaux">grahamd at dscpl.com.au
       </A><BR>
    <I>Mon Apr 17 19:17:49 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="020886.html">[mod_python] Problem with PSP on mod_python 3.13
</A></li>
        <LI>Next message: <A HREF="020888.html">[mod_python] Output Filters Redeaux
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20887">[ date ]</a>
              <a href="thread.html#20887">[ thread ]</a>
              <a href="subject.html#20887">[ subject ]</a>
              <a href="author.html#20887">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Deron Meranda wrote ..
&gt;<i> On 4/17/06, Nick &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">nick at dd.revealed.net</A>&gt; wrote:
</I>&gt;<i> &gt; The iterator would stop when None was read, so that's implicit.  Again,
</I>&gt;<i> this
</I>&gt;<i> &gt; idea assumes a producer/consumer model rather than the repeated calling
</I>&gt;<i> &gt; model that is supported now.  And that, of course, implies some kind
</I>&gt;<i> of
</I>&gt;<i> &gt; thread or fork and communication through a pipe or some other form of
</I>&gt;<i> IPC,
</I>&gt;<i> &gt; unless there's some aspect of the apache API that I'm not aware of (which
</I>&gt;<i> is
</I>&gt;<i> &gt; highly possible :)
</I>&gt;<i> 
</I>&gt;<i> Not sure why you're thinking about threads and IPC?
</I>&gt;<i> 
</I>&gt;<i> Anyway creating a generator-wrapper is the quickest way.  But you
</I>&gt;<i> could modify the filter class so it acts like an iterator pretty easy.
</I>&gt;<i> Just add a new method something like (this is untested):
</I>&gt;<i> 
</I>&gt;<i>    class filter:
</I>&gt;<i>       ....
</I>&gt;<i>       def __iter__(self):
</I>&gt;<i>           class filteriter:
</I>&gt;<i>               def __init__(self,f):
</I>&gt;<i>                   self.f = f
</I>&gt;<i>               def next(self):
</I>&gt;<i>                   s = self.f.read()
</I>&gt;<i>                   if s is None:
</I>&gt;<i>                       raise StopIteration
</I>&gt;<i>                   return s
</I>&gt;<i>           return filteriter(self)
</I>
Overall I can't see how it could be made to work, at least I can't see how
it could be made to work easily. The basic problem is that on each call into
a filter, it is a different filter object associated with different buckets in the
bucket brigade. So although within the context of a single filter call, you
might be able make the filter object iterable, you probably can't have one
bit of code which somehow transparently bridges the multiple calls to the
filter even if using a generator somehow, which is what I think the suggestion
was about. I don't truly grok all that can be done with generators and so
there may indeed be a way, but it would probably need to use multiple
levels of indirection to get around fact the filter object changes.

Graham


</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020886.html">[mod_python] Problem with PSP on mod_python 3.13
</A></li>
	<LI>Next message: <A HREF="020888.html">[mod_python] Output Filters Redeaux
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20887">[ date ]</a>
              <a href="thread.html#20887">[ thread ]</a>
              <a href="subject.html#20887">[ subject ]</a>
              <a href="author.html#20887">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
