<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] finding length of user file before uploading
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20finding%20length%20of%20user%20file%20before%20uploading&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020863.html">
   <LINK REL="Next"  HREF="020867.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] finding length of user file before uploading</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>greg</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20finding%20length%20of%20user%20file%20before%20uploading&In-Reply-To="
       TITLE="[mod_python] finding length of user file before uploading">girty at cogeco.ca
       </A><BR>
    <I>Fri Apr 14 22:36:23 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="020863.html">[mod_python] Re: mysqldb error
</A></li>
        <LI>Next message: <A HREF="020867.html">[mod_python] finding length of user file before uploading
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20866">[ date ]</a>
              <a href="thread.html#20866">[ thread ]</a>
              <a href="subject.html#20866">[ subject ]</a>
              <a href="author.html#20866">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I want a script (PSP preferred, custom handler if need be) that can
cancel an upload if the file is too large, or is taking too long.
The list archives have a few hacks for custom uploads using:

	util.FieldStorage(req, file_callback=FileFactory)

However, this parameter is not in the official docs, and several
previous posters noticed the behaviour breaking between versions.
My system is Debian, Apache2, mod_python 3.1.3-3.
When I try the file_callback trick, I get:

   File &quot;/var/www/upload.psp&quot;, line 40, in ?
     frm = util.FieldStorage(req, file_callback=make_file)

TypeError: __init__() got an unexpected keyword argument 'file_callback'


I presume that undocumented feature has become extinct in recent versions.

And, even if it had worked, it still doesn't relay the size of the
file until the transfer is eating time and memory.
I would like to avoid making a custom handler that gets the data 
directly from the client--it seems like I would re-invent the wheel. A 
slower wheel.

What is the best way to aquire the filesize before the upload starts?

Thanks,

Greg

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020863.html">[mod_python] Re: mysqldb error
</A></li>
	<LI>Next message: <A HREF="020867.html">[mod_python] finding length of user file before uploading
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20866">[ date ]</a>
              <a href="thread.html#20866">[ thread ]</a>
              <a href="subject.html#20866">[ subject ]</a>
              <a href="author.html#20866">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
