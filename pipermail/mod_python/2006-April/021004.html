<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> &amp;nbsp;Re:&amp;nbsp;[mod_python]&amp;nbsp;s ession&amp;nbsp;lock
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%26nbsp%3BRe%3A%26nbsp%3B%5Bmod_python%5D%26nbsp%3Bs%20ession%26nbsp%3Block&In-Reply-To=44521168.6070102%40jgassociates.ca">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021002.html">
   <LINK REL="Next"  HREF="021000.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>&amp;nbsp;Re:&amp;nbsp;[mod_python]&amp;nbsp;s ession&amp;nbsp;lock</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%26nbsp%3BRe%3A%26nbsp%3B%5Bmod_python%5D%26nbsp%3Bs%20ession%26nbsp%3Block&In-Reply-To=44521168.6070102%40jgassociates.ca"
       TITLE="&amp;nbsp;Re:&amp;nbsp;[mod_python]&amp;nbsp;s ession&amp;nbsp;lock">grahamd at dscpl.com.au
       </A><BR>
    <I>Fri Apr 28 09:01:56 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="021002.html">&amp;nbsp;Re:&amp;nbsp;[mod_python]&amp;nbsp;s ession&amp;nbsp;lock
</A></li>
        <LI>Next message: <A HREF="021000.html">&amp;nbsp;Re:&amp;nbsp;[mod_python]&amp;nbsp;s
 ession&amp;nbsp;lock
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21004">[ date ]</a>
              <a href="thread.html#21004">[ thread ]</a>
              <a href="subject.html#21004">[ subject ]</a>
              <a href="author.html#21004">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Consider reading:

   <A HREF="http://www.dscpl.com.au/articles/modpython-004.html">http://www.dscpl.com.au/articles/modpython-004.html</A>

This will give you some more background information on what Jim
is talking about in respect of MPMs, interpreters models etc.

Access to globals in your module code also wasn't thread safe
and could not do quite what you expect in a multithread MPM.

Graham

On 28/04/2006, at 10:58 PM, Jim Gallacher wrote:

&gt;<i> yjfuk wrote:
</I>&gt;&gt;<i> I think it's my code error,but I am not sure.
</I>&gt;&gt;<i> My apapche conf is like this :
</I>&gt;&gt;<i> SetHandler mod_python
</I>&gt;&gt;<i> PythonHandler mod_python.publisher
</I>&gt;&gt;<i>  I use psp as my template.I confuse that the variable seems to share 
</I>&gt;&gt;<i> the values among the pages.
</I>&gt;&gt;<i> e.g. a page named index.py contain functions as below:
</I>&gt;&gt;<i>  test=0
</I>&gt;&gt;<i> def a(req):
</I>&gt;&gt;<i>     global test
</I>&gt;&gt;<i>     req.write(str(test))
</I>&gt;&gt;<i>     test=test+1
</I>&gt;&gt;<i>  def b(req):
</I>&gt;&gt;<i>     global test
</I>&gt;&gt;<i>     req.write(str(test))
</I>&gt;&gt;<i>     test=test+1
</I>&gt;&gt;<i>  when you visit the page <A HREF="http://localhost/index/a">http://localhost/index/a</A> it print 0,then 
</I>&gt;&gt;<i> visit page <A HREF="http://localhost/index/b">http://localhost/index/b</A>
</I>&gt;&gt;<i> it print 1 as if the variable 'test' is pass vis get or post 
</I>&gt;&gt;<i> method.why?
</I>&gt;&gt;<i> is it the cache trick?
</I>&gt;<i>
</I>&gt;<i> It's not a trick, it's the way python works. The interpreter created 
</I>&gt;<i> by mod_python is persistent between requests and you increment the 
</I>&gt;<i> value of test in your code.
</I>&gt;<i>
</I>&gt;<i> However you can't depend on the value of test for apache-mpm's such as 
</I>&gt;<i> forked and worker. You'll have multiple interpreters with these mpm's 
</I>&gt;<i> and each interpreter will get it's own copy of the data. Which 
</I>&gt;<i> interpreter will handle a particular request so if you visit 
</I>&gt;<i> <A HREF="http://localhost/index/a">http://localhost/index/a</A> 10 times you might see this seemingly random 
</I>&gt;<i> pattern:
</I>&gt;<i>
</I>&gt;<i> 0
</I>&gt;<i> 1
</I>&gt;<i> 0
</I>&gt;<i> 2
</I>&gt;<i> 1
</I>&gt;<i> 3
</I>&gt;<i> 0
</I>&gt;<i> 1
</I>&gt;<i> 4
</I>&gt;<i> 3
</I>&gt;<i>
</I>&gt;<i> Unless you fully understand this you should avoid variables defined at 
</I>&gt;<i> the module level for anything other than constants.
</I>&gt;<i>
</I>&gt;<i> Jim
</I>
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021002.html">&amp;nbsp;Re:&amp;nbsp;[mod_python]&amp;nbsp;s ession&amp;nbsp;lock
</A></li>
	<LI>Next message: <A HREF="021000.html">&amp;nbsp;Re:&amp;nbsp;[mod_python]&amp;nbsp;s
 ession&amp;nbsp;lock
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21004">[ date ]</a>
              <a href="thread.html#21004">[ thread ]</a>
              <a href="subject.html#21004">[ subject ]</a>
              <a href="author.html#21004">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
