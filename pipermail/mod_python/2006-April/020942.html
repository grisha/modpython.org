<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] The new module loader
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20The%20new%20module%20loader&In-Reply-To=1145598250.8774%40dscpl.user.openhosting.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020935.html">
   <LINK REL="Next"  HREF="020943.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] The new module loader</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Jorey Bump</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20The%20new%20module%20loader&In-Reply-To=1145598250.8774%40dscpl.user.openhosting.com"
       TITLE="[mod_python] The new module loader">list at joreybump.com
       </A><BR>
    <I>Fri Apr 21 12:08:52 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="020935.html">[mod_python] The new module loader
</A></li>
        <LI>Next message: <A HREF="020943.html">[mod_python] The new module loader
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20942">[ date ]</a>
              <a href="thread.html#20942">[ thread ]</a>
              <a href="subject.html#20942">[ subject ]</a>
              <a href="author.html#20942">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Graham Dumpleton wrote:
&gt;<i> Graham Dumpleton wrote ..
</I>&gt;&gt;<i> The new module importer completely ignores packages as it is practically
</I>&gt;&gt;<i> impossible to get any form of automatic module reloading to work
</I>&gt;&gt;<i> correctly with them when they are more than trivial. As such, packages
</I>&gt;&gt;<i> are handed off to standard Python __import__ to deal with. That it even
</I>&gt;&gt;<i> finds the package means that you have it installed in sys.path. Even if
</I>&gt;&gt;<i> it was a file based module, because it is on sys.path and thus likely to
</I>&gt;&gt;<i> be installed in a standard location, the new module importer would again
</I>&gt;&gt;<i> ignore it as it leaves all sys.path modules up to Python __import__
</I>&gt;&gt;<i> as too dangerous to be mixing importing schemes.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Anyway, that all only applies if you were expecting PyServer.pyserver to
</I>&gt;&gt;<i> automatically reload upon changes.
</I>
Graham, can you enumerate the different ways packages are handled, or is 
it enough to say that packages are never reloaded? In this thread, you 
explain that when a package is imported via PythonHandler, mod_python 
uses the conventional Python __import__, requiring an apache restart to 
reliably reload the package, as in the past.

This also implies that if a published module imports a package, and the 
published module is touched or modified, then the module will be 
reloaded, but not the package. Is this correct?

&gt;<i> BTW, that something outside of the document tree, possibly in sys.path,
</I>&gt;<i> is dealt with by Python __import__ doesn't mean you can't have module
</I>&gt;<i> reloading on stuff outside of the document tree. The idea is that if it is
</I>&gt;<i> part of the web application and needs to be reloadable, that it doesn't
</I>&gt;<i> really belong in standard Python directories anyway. People only install
</I>&gt;<i> it there at present because it is convenient.
</I>
There are security benefits to not putting your code in the 
DocumentRoot. It's also useful to develop generic utilities that are 
used in multiple apps (not just mod_python), but that you don't want 
available globally on the system. I prefer extremely minimal frontends 
in the DocumentRoot, with most of my code stored elsewhere. Will the new 
importer support reloading modules outside of the DocumentRoot without 
putting them in sys.path?

&gt;<i> The better way of dealing with this with the new module importer is to
</I>&gt;<i> put your web application modules elsewhere, ie., not on sys.path. You then
</I>&gt;<i> specify an absolute path to the actual .py file in the handler directive.
</I>&gt;<i> 
</I>&gt;<i>  &lt;Directory /&gt;
</I>&gt;<i>      SetHandler mod_python
</I>&gt;<i>      PythonHandler /path/to/web/application/PyServer/pserver.py
</I>&gt;<i>      ...
</I>
How arbitrary is this path? Must it be within the DocumentRoot?

&gt;<i> Most cases I have seen is that people use packages purely to create a
</I>&gt;<i> namespace to group the modules. With the new module importer that
</I>&gt;<i> doesn't really need to be done anymore. That is because you can
</I>&gt;<i> directly reference an arbitrary module by its path. When you use the
</I>&gt;<i> &quot;import&quot; statement in files in that directory, one of the places it will
</I>&gt;<i> automatically look, without that directory needing to be in sys.path,
</I>&gt;<i> is the same directory the file is in. This achieves the same result as
</I>&gt;<i> what people are using packages for now but you can still have module
</I>&gt;<i> reloading work.
</I>
Does it (the initial loading, not the reloading) also apply to packages 
in that directory? Or will it only work with standalone single file 
modules in the root of that directory?

This is all very nifty, because it implies that a mod_python application 
can now be easily distributed by inflating a tarball and specifying the 
PythonHandler accordingly.

If the new importer works outside of the DocumentRoot, and Location is 
used instead of Directory, no files need to be created in the 
DocumentRoot at all. Or is this currently impossible, in regards to 
automatic module reloading? I already do this for some handlers I've 
written, and really like the flexibility provided by the virtualization.



</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020935.html">[mod_python] The new module loader
</A></li>
	<LI>Next message: <A HREF="020943.html">[mod_python] The new module loader
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20942">[ date ]</a>
              <a href="thread.html#20942">[ thread ]</a>
              <a href="subject.html#20942">[ subject ]</a>
              <a href="author.html#20942">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
