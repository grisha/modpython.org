<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] The new module loader
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20The%20new%20module%20loader&In-Reply-To=4817b6fc0604191506u5a2c3303ue87701776fb7c89%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020899.html">
   <LINK REL="Next"  HREF="020901.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] The new module loader</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20The%20new%20module%20loader&In-Reply-To=4817b6fc0604191506u5a2c3303ue87701776fb7c89%40mail.gmail.com"
       TITLE="[mod_python] The new module loader">grahamd at dscpl.com.au
       </A><BR>
    <I>Wed Apr 19 18:22:18 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="020899.html">[mod_python] The new module loader
</A></li>
        <LI>Next message: <A HREF="020901.html">[mod_python] The new module loader
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20900">[ date ]</a>
              <a href="thread.html#20900">[ thread ]</a>
              <a href="subject.html#20900">[ subject ]</a>
              <a href="author.html#20900">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On 20/04/2006, at 8:06 AM, Dan Eloff wrote:

&gt;<i> I went digging through the mod_python files and discovered how the new  
</I>&gt;<i> publisher loader works (using ModuleCache) and I borrowed the idea to  
</I>&gt;<i> import modules for my handler.
</I>
Note that mod_python 3.3 will like be discarding that module loader
and the original one and replacing it with a grand unified module
reloader. :-)

&gt;<i> The purpose of ModuleCache was to avoid sys.modules right?
</I>
Yes.

&gt;<i> I'm having some trouble with this, and I eventually tracked it down to  
</I>&gt;<i> multiple versions of a dependancy module being loaded.
</I>
Known issue. See:

    
<A HREF="http://www.dscpl.com.au/articles/modpython-003.html#multiple-module-">http://www.dscpl.com.au/articles/modpython-003.html#multiple-module-</A> 
instances

&gt;<i> My handler loads one version, with empty module variables, while the  
</I>&gt;<i> actual modules for the pages load different version(s) and populate  
</I>&gt;<i> them with data. The changes are never reflected in the version kept by  
</I>&gt;<i> my handler (because they are not the same)
</I>&gt;<i>
</I>&gt;<i> This all makes sense, and is probably the intended effect, but what do  
</I>&gt;<i> you do for modules like Session in mod_python, where MemorySession  
</I>&gt;<i> uses a static class member to store sessions? Wouldn't the page  
</I>&gt;<i> modules each get their own version and thusly prevent sessions from  
</I>&gt;<i> working?
</I>
Also see:

    
<A HREF="http://www.dscpl.com.au/articles/modpython-003.html#transfer-of-module-">http://www.dscpl.com.au/articles/modpython-003.html#transfer-of-module-</A> 
data

&gt;<i> I need to be able to reload modified modules, but also to make use of  
</I>&gt;<i> shared modules. These seem to be conflicting needs, however. Does  
</I>&gt;<i> anybody have any inisght into this situation that they can share?
</I>
Only that mod_python 3.3 will hopefully fix a lot of this stuff. If you
are prepared to give 3.3 source code out of subversion repository a go
to see if things work as you expect, let me know and will tell you the
magic to enable the unified module importer in 3.3 as at moment it is
still off by default.

Note though that even in 3.3, the &quot;transfer of module data&quot; issue still
has to be explicitly dealt with in some way. Although not confirmed how
this will be done, the new module importer as it stands now allows a
module to define a __clone__() method which will be called and which
can be used to transfer data from an old module to a new where data  
needs
to be preserved across reloads.

As I said, if interested I'll go into it more later.

Graham

</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020899.html">[mod_python] The new module loader
</A></li>
	<LI>Next message: <A HREF="020901.html">[mod_python] The new module loader
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20900">[ date ]</a>
              <a href="thread.html#20900">[ thread ]</a>
              <a href="subject.html#20900">[ subject ]</a>
              <a href="author.html#20900">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
