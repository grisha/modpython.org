<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] ValueError with Flash 8 FileReference.upload(url)  
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20ValueError%20with%20Flash%208%20FileReference.upload%28url%29%20%20&In-Reply-To=2B608EE6-BE6B-4859-92FD-AA77ECDA715C%40dscpl.com.au">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020946.html">
   <LINK REL="Next"  HREF="020949.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] ValueError with Flash 8 FileReference.upload(url)  </H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Alec Matusis</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20ValueError%20with%20Flash%208%20FileReference.upload%28url%29%20%20&In-Reply-To=2B608EE6-BE6B-4859-92FD-AA77ECDA715C%40dscpl.com.au"
       TITLE="[mod_python] ValueError with Flash 8 FileReference.upload(url)  ">matusis at matusis.com
       </A><BR>
    <I>Fri Apr 21 18:33:39 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="020946.html">[mod_python] ValueError with Flash 8 FileReference.upload(url)  
</A></li>
        <LI>Next message: <A HREF="020949.html">[mod_python] Problem with configure
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20947">[ date ]</a>
              <a href="thread.html#20947">[ thread ]</a>
              <a href="subject.html#20947">[ subject ]</a>
              <a href="author.html#20947">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Is there a way to read the request by lines in the filter, rather than
trying to read the entire buffer?
That way at least the text that I am trying to replace will come in a single
read, when I read that line.

Or will it be to slow?

-----Original Message-----
From: Graham Dumpleton [mailto:<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">grahamd at dscpl.com.au</A>] 
Sent: Friday, April 21, 2006 3:24 PM
To: Alec Matusis
Cc: <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mod_python at modpython.org</A>
Subject: Re: [mod_python] ValueError with Flash 8 FileReference.upload(url) 

Actually there is another problem that only came to me later. That is  
that
there is no guarantee with an input filter that you are going to get the
complete text you are trying to replace in one read even if it was  
written
in one go by the client. This is because you are at the mercy of how
blocking of data reads off the client socket works out. A patching of  
the
util.FieldStorage class may be the only way around that.

Graham

On 21/04/2006, at 7:40 PM, Alec Matusis wrote:

&gt;<i>  Yes, I got that.
</I>&gt;<i> Thanks, I tested it, all works well.
</I>&gt;<i>
</I>&gt;<i> I hope this filter does not tax the performance too much when I  
</I>&gt;<i> submit large
</I>&gt;<i> files?
</I>&gt;<i>
</I>&gt;<i> -----Original Message-----
</I>&gt;<i> From: Graham Dumpleton [mailto:<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">grahamd at dscpl.com.au</A>]
</I>&gt;<i> Sent: Friday, April 21, 2006 2:39 AM
</I>&gt;<i> To: Alec Matusis
</I>&gt;<i> Cc: <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mod_python at modpython.org</A>
</I>&gt;<i> Subject: Re: [mod_python] ValueError with Flash 8  
</I>&gt;<i> FileReference.upload(url)
</I>&gt;<i>
</I>&gt;<i> Whoops.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On 21/04/2006, at 7:23 PM, Graham Dumpleton wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> A creative way of getting around the problem. I hadn't thought
</I>&gt;&gt;<i> of using a filter. Some suggested changes below.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On 21/04/2006, at 6:12 PM, Alec Matusis wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I figured out how to do this without changing mod_python source:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I wrote a mod_python input filter:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> flashfilter.py:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> from mod_python import apache
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> def inputfilter(filter):
</I>&gt;&gt;&gt;<i>     #this is a workaround flash 8 FileReference bug: Flash POST is
</I>&gt;&gt;&gt;<i> not
</I>&gt;&gt;&gt;<i> RFC-compliant as of Flash 8,0,22,0
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     if 'flashfileref' in parse_args(filter.req.args):
</I>&gt;&gt;<i>       filter.pass_on()
</I>&gt;&gt;<i>       return
</I>&gt;<i>
</I>&gt;<i> Logic wrong way around.
</I>&gt;<i>
</I>&gt;<i>      if 'flashfileref' not in parse_args(filter.req.args):
</I>&gt;<i>        filter.pass_on()
</I>&gt;<i>        return
</I>&gt;<i>
</I>&gt;<i> Graham
</I>
</PRE>

















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020946.html">[mod_python] ValueError with Flash 8 FileReference.upload(url)  
</A></li>
	<LI>Next message: <A HREF="020949.html">[mod_python] Problem with configure
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20947">[ date ]</a>
              <a href="thread.html#20947">[ thread ]</a>
              <a href="subject.html#20947">[ subject ]</a>
              <a href="author.html#20947">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
