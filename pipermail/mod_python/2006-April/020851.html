<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Speaking of Output Filters....
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Speaking%20of%20Output%20Filters....&In-Reply-To=1144708460.29640%40dscpl.user.openhosting.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020861.html">
   <LINK REL="Next"  HREF="020844.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Speaking of Output Filters....</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Lee Brown</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Speaking%20of%20Output%20Filters....&In-Reply-To=1144708460.29640%40dscpl.user.openhosting.com"
       TITLE="[mod_python] Speaking of Output Filters....">administrator at leebrown.org
       </A><BR>
    <I>Tue Apr 11 07:30:42 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="020861.html">[mod_python] Re: Speaking of Output Filters....
</A></li>
        <LI>Next message: <A HREF="020844.html">[mod_python] Anyone have an idea when mod_python will be available
	for Apache 2.2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20851">[ date ]</a>
              <a href="thread.html#20851">[ thread ]</a>
              <a href="subject.html#20851">[ subject ]</a>
              <a href="author.html#20851">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Greetings!

All good points which I hadn't considered.  The filters have worked very
well so far, though, mostly (I suspect) because I wrote these filters as a
means of merging and transforming content in lieu of using any content
handlers at all.  The content I'm trying to serve is all &quot;quasi-dynamic,&quot;
that is, the content changes, but only when a content author or some
back-end program decides to change it.  As far as the Apache server is
concerned, it all looks like static content.

I haven't tried serving up &quot;War and Peace&quot; as a single web page yet, but
I've tested my filters using what I'd call &quot;unreasonably long&quot; web pages
without any problems - so far.

I'll take a shot at reformulating my code and let you know how it turns out.
It may not even be necessary to accumulate the data in a buffer; if lxml is
using a push-parser it will accept the data piece-wise and all I'd need to
do is detect EOS before invoking the tranform.  

Best Regards,
Lee E. Brown
(<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">administrator at leebrown.org</A>)

-----Original Message-----
From: <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mod_python-bounces at modpython.org</A>
[mailto:<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mod_python-bounces at modpython.org</A>] On Behalf Of Graham Dumpleton
Sent: Monday, April 10, 2006 6:34 PM
To: Lee Brown
Cc: <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mod_python at modpython.org</A>
Subject: Re: [mod_python] Speaking of Output Filters....

Lee Brown wrote ..
&gt;<i> Greetings!
</I>&gt;<i> 
</I>&gt;<i> I am probably remiss for not having shared this before now.  Here are 
</I>&gt;<i> two output filters for mod_python that I have developed.
</I>&gt;<i>
</I>&gt;<i> ...
</I>&gt;<i>
</I>&gt;<i> def outputfilter (filter):
</I>&gt;<i>     xmlstring = filter.read()
</I>&gt;<i>     doc = lxml.etree.parse(StringIO(xmlstring))
</I>&gt;<i>     doc.xinclude()
</I>&gt;<i>     result = str(transformer(doc))
</I>&gt;<i>     filter.write(result)
</I>&gt;<i>     filter.close()
</I>
I suspect that these filters will not work in all situations. This is
because a filter can be called multiple times for a single request and
within one invocation, it is not guaranteed that filter.read() will return
all the data.

In short, your filter will only work when serving up static files and maybe
only files up to a certain size at that perhaps. It is not likely to work
where the XML is generated by a content handler.

This is why the prior posters filters would accumulate data in a list held
in request object until read() returned None and only then process data,
write it out and close the filter off.

Graham
_______________________________________________
Mod_python mailing list
<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>

</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020861.html">[mod_python] Re: Speaking of Output Filters....
</A></li>
	<LI>Next message: <A HREF="020844.html">[mod_python] Anyone have an idea when mod_python will be available
	for Apache 2.2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20851">[ date ]</a>
              <a href="thread.html#20851">[ thread ]</a>
              <a href="subject.html#20851">[ subject ]</a>
              <a href="author.html#20851">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
