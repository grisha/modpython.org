<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] extreme memory usage with apache2
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20extreme%20memory%20usage%20with%20apache2&In-Reply-To=1126627037.8805.14.camel%40totoro.assembleco.x">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019018.html">
   <LINK REL="Next"  HREF="019022.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] extreme memory usage with apache2</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Lee Brown</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20extreme%20memory%20usage%20with%20apache2&In-Reply-To=1126627037.8805.14.camel%40totoro.assembleco.x"
       TITLE="[mod_python] extreme memory usage with apache2">administrator at leebrown.org
       </A><BR>
    <I>Tue Sep 13 19:01:53 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="019018.html">[mod_python] extreme memory usage with apache2
</A></li>
        <LI>Next message: <A HREF="019022.html">[mod_python] extreme memory usage with apache2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19021">[ date ]</a>
              <a href="thread.html#19021">[ thread ]</a>
              <a href="subject.html#19021">[ subject ]</a>
              <a href="author.html#19021">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Greetings!
 
It seems like each new request ought to be instantiating a new webObject
instance, yet it also seems that each new instantiation has a copy of all
the previous instance's data.  Are you sure you're not writing your data
into the webObject base class by mistake?
 
If that's not the case, you might try manually garbage-collecting the
response instance just prior to the end of your handler routine.

Best Regards,
Lee E. Brown
(<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">administrator at leebrown.org</A>)


 

  _____  

From: <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mod_python-bounces at modpython.org</A>
[mailto:<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mod_python-bounces at modpython.org</A>] On Behalf Of mauchi
Sent: Tuesday, September 13, 2005 11:57 AM
To: <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mod_python at modpython.org</A>
Subject: [mod_python] extreme memory usage with apache2


I've noticed this behaviour as of late which causes large memory usage in
apache2, rogue threads taking up 400+ megs for each client that eventually
cause me to restart apache:

I return all html content through a python object which handles the form
data and tracks errors

#    Init object and parse form
response = webObject(req)

#    return html or xml based on form entries
req.write(response.returnSomething())

#    print debugging information
req.write(response.returnErrors())

the object has an internal array called errors where I store debugging
information from the internal functions. What I expect is 1-2 lines of
messages for each time the page is loaded which is printed at the bottom of
the page. What I find is if I keep hitting refresh, that the lines grow each
time with the previous load's messages. 50 refreshes later I'll have 50-100
lines of debugging information. This makes me think that the webObject is
staying in memory between loads and doesn't get destroyed unt il I restart
apache2. This has become more of a problem as each client page now requests
frequent xml updates and the server quickly tires out.
If anyone has a suggestion on how to either: turn off said behaviour in
mod_python, destroy objects from memory, or a clever way to flush out all of
an object's internal data between loads, I would be most happy.

Thanks to all in advance!

Mauchi 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20050913/6eade7b3/attachment.html">http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20050913/6eade7b3/attachment.html</A>
</PRE>









































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019018.html">[mod_python] extreme memory usage with apache2
</A></li>
	<LI>Next message: <A HREF="019022.html">[mod_python] extreme memory usage with apache2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19021">[ date ]</a>
              <a href="thread.html#19021">[ thread ]</a>
              <a href="subject.html#19021">[ subject ]</a>
              <a href="author.html#19021">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
