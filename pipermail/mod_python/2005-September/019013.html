<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] publisher handler questions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20publisher%20handler%20questions&In-Reply-To=acfb5bdc05091213263de43d8e%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019012.html">
   <LINK REL="Next"  HREF="019010.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] publisher handler questions</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Jorey Bump</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20publisher%20handler%20questions&In-Reply-To=acfb5bdc05091213263de43d8e%40mail.gmail.com"
       TITLE="[mod_python] publisher handler questions">list at joreybump.com
       </A><BR>
    <I>Mon Sep 12 20:22:53 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="019012.html">[mod_python] publisher handler questions
</A></li>
        <LI>Next message: <A HREF="019010.html">[mod_python] Problem in Configuring
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19013">[ date ]</a>
              <a href="thread.html#19013">[ thread ]</a>
              <a href="subject.html#19013">[ subject ]</a>
              <a href="author.html#19013">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>akonsu wrote:

&gt;&gt;<i>An underscore will prevent direct access:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> def _foo():
</I>&gt;&gt;<i>     ...
</I>&gt;<i> would not this be accessible through <A HREF="http://host/test.py/_foo">http://host/test.py/_foo</A> ?
</I>
No, it's a special case. Try it.

&gt;&gt;&gt;<i>2. in my .py file (that is invoked through the publisher handler
</I>&gt;&gt;&gt;<i>again) i define some global variables. i noticed that these variables
</I>&gt;&gt;&gt;<i>are initialised once. is this by design or just a coincidence? can i
</I>&gt;&gt;&gt;<i>rely on this behaviour?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>It depends. A database or other persistent storage mechanism may be more
</I>&gt;&gt;<i>reliable.
</I>&gt;<i> 
</I>&gt;<i> i am not talking about saving user data that should go in to sessions
</I>&gt;<i> in global variables. i need a list of files in a particular directory,
</I>&gt;<i> and i am trying to avoid building this list on every single http
</I>&gt;<i> request. what is the right strategy for handling something like this?
</I>
If you want to keep abreast of changes, then be careful to build the 
list only when it's needed.

If you don't care that much about changes to directory contents, you can 
  import a module from your path that populates a list. Due to module 
caching, this list will only be populated when it is imported. For 
example, if a.py is in your path:

  #a.py
  import os
  ls = os.listdir('tmp/test')

and b.py is your published module:

  #b.py
  import os
  import a
  def ls():
      return [os.listdir('tmp/test'), a.ls]

Then put some files there:

  cd /tmp/test
  touch 1 2 3

and visit the URL with multiple browsers:

  <A HREF="http://host/somedir/b/ls">http://host/somedir/b/ls</A>

It might display this:

  [['1', '2', '3'], ['1', '2', '3']]

For kicks, visit the URL a few more times, then do this:

  cd /tmp/test
  rm 1 2 3

Revisit the URL, and you might see this:

  [[], ['1', '2', '3']]

or you might see this:

  [[], []]

The point is that a.ls will only change when the module is (re)imported, 
and this is unlikely to happen globally. Since it is sometimes cached, 
you will see a performance gain, but it's at the cost of accuracy. It's 
up to you to determine if that cost is acceptable.

You can also store this information externally and routinely update it 
(database, pickle, cronjob &gt; file, etc.), but I'd be surprised if the 
costs associated with loading it for every request are less than simply 
using the os module.

HTH










</PRE>















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019012.html">[mod_python] publisher handler questions
</A></li>
	<LI>Next message: <A HREF="019010.html">[mod_python] Problem in Configuring
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19013">[ date ]</a>
              <a href="thread.html#19013">[ thread ]</a>
              <a href="subject.html#19013">[ subject ]</a>
              <a href="author.html#19013">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
