<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] util.FieldStorage wrong about method restrictions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20util.FieldStorage%20wrong%20about%20method%20restrictions&In-Reply-To=8764gwp8xc.fsf%40nicferrier.tapsellferrier.co.uk">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021835.html">
   <LINK REL="Next"  HREF="021840.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] util.FieldStorage wrong about method restrictions</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20util.FieldStorage%20wrong%20about%20method%20restrictions&In-Reply-To=8764gwp8xc.fsf%40nicferrier.tapsellferrier.co.uk"
       TITLE="[mod_python] util.FieldStorage wrong about method restrictions">grahamd at dscpl.com.au
       </A><BR>
    <I>Mon Aug 14 06:33:06 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="021835.html">[mod_python] util.FieldStorage wrong about method restrictions
</A></li>
        <LI>Next message: <A HREF="021840.html">[mod_python] util.FieldStorage wrong about method restrictions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21838">[ date ]</a>
              <a href="thread.html#21838">[ thread ]</a>
              <a href="subject.html#21838">[ subject ]</a>
              <a href="author.html#21838">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On 14/08/2006, at 8:28 AM, Nic James Ferrier wrote:

&gt;<i> My version of mod_python (Debian package 3.1.3-3) says this in
</I>&gt;<i> util.py:
</I>&gt;<i>
</I>&gt;<i>         # always process GET-style parameters
</I>&gt;<i>         if req.args:
</I>&gt;<i>             pairs = parse_qsl(req.args, keep_blank_values)
</I>&gt;<i>             for pair in pairs:
</I>&gt;<i>                 file = cStringIO.StringIO(pair[1])
</I>&gt;<i>                 self.list.append(Field(pair[0], file, &quot;text/plain&quot;,  
</I>&gt;<i> {},
</I>&gt;<i>                                        None, {}))
</I>&gt;<i>
</I>&gt;<i>         if req.method == &quot;POST&quot; or req.method == &quot;PUT&quot;:
</I>&gt;<i>
</I>&gt;<i>             try:
</I>&gt;<i>                 clen = int(req.headers_in[&quot;content-length&quot;])
</I>&gt;<i>             except (KeyError, ValueError):
</I>&gt;<i>                 # absent content-length is not acceptable
</I>&gt;<i>                 raise apache.SERVER_RETURN,  
</I>&gt;<i> apache.HTTP_LENGTH_REQUIRED
</I>&gt;<i>
</I>&gt;<i> The current version says something similar.
</I>&gt;<i>
</I>&gt;<i> This is wrong. Or at least restictive.
</I>
It may be restrictive but the cgi.FieldStorage class in the main Python
distribution also only supports POST. Unless you can show some sort
of precedent in the way of some other equivalent forms processing  
library
that supports PUT, I can't see any convincing reason to change it. Some
sort of documentation as to what can be provided in a PUT request as
content would also help.

&gt;<i> I noticed this because I am PUTting the representation of a resource
</I>&gt;<i> as application/x-www-form-urlencoded and I wasn't allowed to do that
</I>&gt;<i> using FieldStorage.
</I>
You can do it, you just need to use an intermediate wrapper for the
request object to make it think that the POST method was used. Ie.,
something like:

   class _Request:
     def __init__(self, req):
       self.__req = req
     def __getattr__(self, name):
       if name == 'method':
         return 'POST'
       return getattr(self.__req, name)

   form = util.FieldStorage(_Request(req))

This technique can also be used where processing of query string and
body POST parameters must be done separately so as to distinguish
parameters defined by both means, or where it is necessary to ignore
the query string parameters for a POST.

Graham
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021835.html">[mod_python] util.FieldStorage wrong about method restrictions
</A></li>
	<LI>Next message: <A HREF="021840.html">[mod_python] util.FieldStorage wrong about method restrictions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21838">[ date ]</a>
              <a href="thread.html#21838">[ thread ]</a>
              <a href="subject.html#21838">[ subject ]</a>
              <a href="author.html#21838">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
