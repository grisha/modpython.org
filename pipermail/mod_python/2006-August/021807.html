<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] sys.path
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20sys.path&In-Reply-To=1155249698.23553%40dscpl.user.openhosting.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021799.html">
   <LINK REL="Next"  HREF="021814.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] sys.path</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Deron Meranda</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20sys.path&In-Reply-To=1155249698.23553%40dscpl.user.openhosting.com"
       TITLE="[mod_python] sys.path">deron.meranda at gmail.com
       </A><BR>
    <I>Fri Aug 11 11:48:23 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="021799.html">[mod_python] sys.path
</A></li>
        <LI>Next message: <A HREF="021814.html">[mod_python] sys.path
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21807">[ date ]</a>
              <a href="thread.html#21807">[ thread ]</a>
              <a href="subject.html#21807">[ subject ]</a>
              <a href="author.html#21807">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 8/10/06, Graham Dumpleton &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">grahamd at dscpl.com.au</A>&gt; wrote:
&gt;<i> luby liao wrote ..
</I>&gt;<i> &gt; After I installed mod_python and tested it, it did not work.  I got a
</I>&gt;<i> &gt; 'Internal Server' error.  The cause was that sys.path was incorrect.  I
</I>&gt;<i> &gt; used
</I>&gt;<i> &gt; /usr/local/bin/python2.3 to build, but sys.path did not include
</I>&gt;<i> &gt; /usr/local/lib/python2.3..., instead, it included sub-directories of
</I>&gt;<i> &gt; /usr/lib/python2.3.  This problem is easily fixed by setting up soft links.
</I>&gt;<i> &gt; But I am curious as to how the build process determines the sys.path.
</I>&gt;<i>
</I>&gt;<i> By some strange magic that I don't even fully understand.
</I>&gt;<i>
</I>&gt;<i> In short, when Python is initialised by mod_python at run time, Python does
</I>&gt;<i> various checks to try and work out where everything is installed and from
</I>&gt;<i> that setup sys.path. One of the prime ways it uses to determine this is to
</I>&gt;<i> look at which 'python' executable is found in the PATH of the user which
</I>&gt;<i> Apache is executed as. If it can't find one, it possibly falls back to some
</I>&gt;<i> standard defaults (not sure).
</I>&gt;<i>
</I>&gt;<i> End result is that it appears that the PATH of the user that Apache runs as
</I>&gt;<i> does not include '/usr/local/bin' towards the head and thus doesn't find the
</I>&gt;<i> version of Python you actually used to build mod_python. Thus, add that
</I>&gt;<i> bin directory to the start of PATH for user Apache runs as or in the Apache
</I>&gt;<i> startup scripts, whatever may be appropriate for your platform.
</I>
Yes, it is a lot of strange magic!

Rather than alter PATH, you may be able to just set the PYTHONPATH
variable instead.  That way you won't affect any non-python stuff.

If you configured your python with just --prefix, then just set PYTHONPATH
to that directory.  If you however separated the platform-specific files
by using --exec-prefix as well, then PYTHONPATH should consist of
the prefix path, a colon, and the exec-prefix path.

I'm not sure myself why it is picking up the wrong python.  Perhaps
there is something that the mod_python configure process should
be doing???  However all mod_python users should be aware that it
is not possible to use Apache + mod_python with more than one
python version at the same time.  Although you can certainly use
multiple interpreters, they are all the same python.

If you're curious to dive deeper (perhaps Graham?) and have the python
source code, the initial paths for loading modules is determined by the
Py_GetPath() function in the source file Modules/getpath.c.  There's
lots of comments in that file that try to explain how things work.  This
path setting is done very early in the Py_Initialize() function, and
is what is used before the sys module itself is loaded and/or any of
the sys.path or importer hooks can even be changed.
-- 
Deron Meranda
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021799.html">[mod_python] sys.path
</A></li>
	<LI>Next message: <A HREF="021814.html">[mod_python] sys.path
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21807">[ date ]</a>
              <a href="thread.html#21807">[ thread ]</a>
              <a href="subject.html#21807">[ subject ]</a>
              <a href="author.html#21807">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
