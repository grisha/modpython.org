<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] server shutdown [was] i beg...
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20server%20shutdown%20%5Bwas%5D%20i%20beg...&In-Reply-To=200608181819.42452.richardlewis%40fastmail.co.uk">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021883.html">
   <LINK REL="Next"  HREF="021854.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] server shutdown [was] i beg...</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Norman Tindall</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20server%20shutdown%20%5Bwas%5D%20i%20beg...&In-Reply-To=200608181819.42452.richardlewis%40fastmail.co.uk"
       TITLE="[mod_python] server shutdown [was] i beg...">NormanTindall at zdisk.net
       </A><BR>
    <I>Fri Aug 18 17:30:46 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="021883.html">[mod_python] server shutdown
</A></li>
        <LI>Next message: <A HREF="021854.html">[mod_python] Using threading.local with Worker MPM
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21884">[ date ]</a>
              <a href="thread.html#21884">[ thread ]</a>
              <a href="subject.html#21884">[ subject ]</a>
              <a href="author.html#21884">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Richard,

RL&gt; On Friday 18 August 2006 19:26, Norman Tindall wrote:
&gt;&gt;<i>     Don`t know how about publisher and PSP, but in handler
</I>&gt;&gt;<i>     you always can at the end of processing, just before
</I>&gt;&gt;<i>     return apache.OK close connection
</I>RL&gt; Yes, but I want to avoid opening and closing the connection to Berkeley DB XML 
RL&gt; for /every/ request as its quite slow to connect. Thats why I open it when 
RL&gt; the server starts and wanted to be able to close it when the server shuts 
RL&gt; down.
    Hmm.. why dont you use a connection pooling?
    Here is some examples of code, i never tested them,(because i need
    a more complicated pool that will connect to different
    databases  and select db according to a virtual host, and also
    conn in it will be created balanced to the avarage virtual host load)
    but it seems have to work.

    Dont remember from where i draged this examples, sorry if any
    copyrights :)
    <A HREF="http://zdisk.net/pool/conn_pool.txt">http://zdisk.net/pool/conn_pool.txt</A>
    <A HREF="http://zdisk.net/pool/conn_pool_eng.txt">http://zdisk.net/pool/conn_pool_eng.txt</A>
    <A HREF="http://zdisk.net/pool/conn_sharing.txt">http://zdisk.net/pool/conn_sharing.txt</A>
    <A HREF="http://zdisk.net/pool/dustman_pool.txt">http://zdisk.net/pool/dustman_pool.txt</A>

    You can also search mod_python mail list for a conn pooling theme.
    And Google.

1) I suppose.
   If you use one db connection:
    I think conn pooling would give you more gain.
    At the end of request conn return back to pool.
    If there is no connections on pool they created.
    If you try to return to pool conn when it is full -&gt; conn droped.

2) About the server shutdown.
   Anyway of you are using pool or not, in my opinion server sutdown
   do not have to be more frequient than once a week.
   So i can get why you are in so worry about connection close at
   shutdown. I can be ignored. Database will close the connection by
   timeout anyway, i think that`s not a kind of thing when you know
   you are opening 100 connections in a second and say 5-10 not
   closed - this is real bad.
   Onse a week or say 2 days one connection wont be closed.. so what`s
   a big deal?

   The thing that is matter - is a database integrity.

   


I am novice in python and programming :)
Sorry for my english :)
-- 
Best regards,
 Norman                            mailto:<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">NormanTindall at zdisk.net</A>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021883.html">[mod_python] server shutdown
</A></li>
	<LI>Next message: <A HREF="021854.html">[mod_python] Using threading.local with Worker MPM
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21884">[ date ]</a>
              <a href="thread.html#21884">[ thread ]</a>
              <a href="subject.html#21884">[ subject ]</a>
              <a href="author.html#21884">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
