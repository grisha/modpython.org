<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Server Side Printing
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Server%20Side%20Printing&In-Reply-To=6F86781C-5B64-4846-B161-A679CCB410A8%40dscpl.com.au">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021818.html">
   <LINK REL="Next"  HREF="021820.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Server Side Printing</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Server%20Side%20Printing&In-Reply-To=6F86781C-5B64-4846-B161-A679CCB410A8%40dscpl.com.au"
       TITLE="[mod_python] Server Side Printing">grahamd at dscpl.com.au
       </A><BR>
    <I>Sat Aug 12 07:47:41 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="021818.html">[mod_python] Server Side Printing
</A></li>
        <LI>Next message: <A HREF="021820.html">[mod_python] Server Side Printing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21819">[ date ]</a>
              <a href="thread.html#21819">[ thread ]</a>
              <a href="subject.html#21819">[ subject ]</a>
              <a href="author.html#21819">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On 12/08/2006, at 9:39 PM, Graham Dumpleton wrote:

&gt;<i> Please keep discussion on the mailing list. I have forwarded your
</I>&gt;<i> response back there.
</I>&gt;<i>
</I>&gt;<i> On 12/08/2006, at 9:18 PM, S.R.Pard&#225; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Ok, I will try to explain it better.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I have now in the server a PDF (or HTML) that I can open with eVince.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> How I send that document to a network printer from ModPython's
</I>&gt;&gt;<i> interpreted code when client user press PRINT button in one page.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> So server receive a HTTP request for:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 	<A HREF="http://server/printBill.psp?doc=bill0248.pdf">http://server/printBill.psp?doc=bill0248.pdf</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> So I want to code a printBill.psp page that prints like:
</I>&gt;&gt;<i> &lt;%
</I>&gt;&gt;<i> PrinterName = &quot;HP-4100&quot;		#Thats the name of the printer for bills
</I>&gt;&gt;<i> DocumentToPrint = form('doc')   #The Document the user want to print
</I>&gt;&gt;<i> SendToPrint (PrinterName, DocumentToPrint)
</I>&gt;&gt;<i> %&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Now , how I code SendToPrint.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Do I need to use some library ?
</I>&gt;&gt;<i> Can I execute evince from shell indicating some parameter to print  
</I>&gt;&gt;<i> on a
</I>&gt;&gt;<i> specified printer?
</I>
If the PDF were a file stored in the file system, in UNIX the command
to print it would be:

   pdf2ps somefile.pdf | lp -s -d HP-4100

In other words, convert to postscript and use 'lp' to spool to desired
printer. The '-s' option (may depend on platform), just tells lp to not
output status string about job number it was queued at.

This command could be invoked from Python using 'os.system()'.
Alternatively, if PDF content generated by Python code on the fly,
the you might want to use the 'popen2' module to create the command
as a pipe you can send data into in which case the command would
just be:

   pdf2ps | lp -s -d HP-4100

If you can't find pdf2ps, then get a copy of 'ghostscript' package for
your system and install that.

Graham

&gt;&gt;<i> The principal problem is not be able to print from client if we can't
</I>&gt;&gt;<i> select the printer from the server , because user can't select every
</I>&gt;&gt;<i> time a printer for every kind of document he prints.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> El s&#225;b, 12-08-2006 a las 20:24 +1000, Graham Dumpleton escribi&#243;:
</I>&gt;&gt;&gt;<i> On 12/08/2006, at 7:22 PM, S.R.Pard&#225; wrote:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Hi all,
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> I'm considering solutions to print HTML pages served by some  
</I>&gt;&gt;&gt;&gt;<i> Linux OS
</I>&gt;&gt;&gt;&gt;<i> with Apache and  Mod_Python.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> I am looking a server side approach, that is: I want the server
</I>&gt;&gt;&gt;&gt;<i> send the
</I>&gt;&gt;&gt;&gt;<i> HTML output when required to one of varios network printers
</I>&gt;&gt;&gt;&gt;<i> installed in
</I>&gt;&gt;&gt;&gt;<i> the server.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> I have not idea about linux printing , I would need an orientation
</I>&gt;&gt;&gt;&gt;<i> about
</I>&gt;&gt;&gt;&gt;<i> what have to know.
</I>&gt;&gt;&gt;&gt;<i> Are any python module for printing?
</I>&gt;&gt;&gt;&gt;<i> Must I execute some shell command to print inside python?
</I>&gt;&gt;&gt;&gt;<i> Must I generate a PostScript document from the HTML document to  
</I>&gt;&gt;&gt;&gt;<i> print
</I>&gt;&gt;&gt;&gt;<i> it ?
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> More details:
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Web Clients (Windows probably) will print some documents  
</I>&gt;&gt;&gt;&gt;<i> received. But
</I>&gt;&gt;&gt;&gt;<i> the documents have diferent formats (size, orientation, duplex  
</I>&gt;&gt;&gt;&gt;<i> option)
</I>&gt;&gt;&gt;&gt;<i> so it's desiderable the automatic printer/configuration selection
</I>&gt;&gt;&gt;&gt;<i> ( that
</I>&gt;&gt;&gt;&gt;<i> is: witout a printer selection dialog in IE or Firefox and the  
</I>&gt;&gt;&gt;&gt;<i> default
</I>&gt;&gt;&gt;&gt;<i> printer isn't valid for all documents)
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> As I found in client window Javascript it's not capable of select
</I>&gt;&gt;&gt;&gt;<i> printers in client side, I have to investigate with VBscript, and
</I>&gt;&gt;&gt;&gt;<i> another possibility would be install an ActiveX control to do that
</I>&gt;&gt;&gt;&gt;<i> (restricting possible client options).
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> So I think the server approach, would be better because it  
</I>&gt;&gt;&gt;&gt;<i> eliminates
</I>&gt;&gt;&gt;&gt;<i> printer management in client, and assures the same HTML render
</I>&gt;&gt;&gt;&gt;<i> configuration for all printings, independent of client  
</I>&gt;&gt;&gt;&gt;<i> configuration /
</I>&gt;&gt;&gt;&gt;<i> browser.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Not sure I really understand what you are trying to do, but if your
</I>&gt;&gt;&gt;<i> target
</I>&gt;&gt;&gt;<i> is a printer, not sure why you would want to try and render to HTML
</I>&gt;&gt;&gt;<i> and then print that. Your better option would be target PDF as your
</I>&gt;&gt;&gt;<i> display format and then print the PDF file.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Suggest you have a look at the following sites:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>    <A HREF="http://www.openreport.org">http://www.openreport.org</A>
</I>&gt;&gt;&gt;<i>    <A HREF="http://www.reportlab.org">http://www.reportlab.org</A>
</I>&gt;&gt;&gt;<i>    <A HREF="http://www.reportlab.com">http://www.reportlab.com</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> With these solutions, one option is to describe documents as RML.  
</I>&gt;&gt;&gt;<i> This
</I>&gt;&gt;&gt;<i> can be filled out with data from some source and then translated  
</I>&gt;&gt;&gt;<i> into
</I>&gt;&gt;&gt;<i> PDF
</I>&gt;&gt;&gt;<i> or HTML. Thus HTML becomes a screen representation but PDF what
</I>&gt;&gt;&gt;<i> is used for printing.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> If you already have the document generation side worked out, and are
</I>&gt;&gt;&gt;<i> only really after solution for printing, not sure how Apache and
</I>&gt;&gt;&gt;<i> mod_python
</I>&gt;&gt;&gt;<i> comes in to it all.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Anyway, hope the sites I reference might be of some help.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Graham
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>

</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021818.html">[mod_python] Server Side Printing
</A></li>
	<LI>Next message: <A HREF="021820.html">[mod_python] Server Side Printing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21819">[ date ]</a>
              <a href="thread.html#21819">[ thread ]</a>
              <a href="subject.html#21819">[ subject ]</a>
              <a href="author.html#21819">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
