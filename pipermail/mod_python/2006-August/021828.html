<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] mod_python sessions, locking, and PSP
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20mod_python%20sessions%2C%20locking%2C%20and%20PSP&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021827.html">
   <LINK REL="Next"  HREF="021831.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] mod_python sessions, locking, and PSP</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Michael Spang</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20mod_python%20sessions%2C%20locking%2C%20and%20PSP&In-Reply-To="
       TITLE="[mod_python] mod_python sessions, locking, and PSP">mike at utgard.net
       </A><BR>
    <I>Sun Aug 13 13:50:27 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="021827.html">[mod_python] mod_python with Apache2.2?
</A></li>
        <LI>Next message: <A HREF="021831.html">[mod_python] mod_python sessions, locking, and PSP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21828">[ date ]</a>
              <a href="thread.html#21828">[ thread ]</a>
              <a href="subject.html#21828">[ subject ]</a>
              <a href="author.html#21828">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I recently ran into deadlocks using sessions in both my mod_python
handler and in psp. I've read through the thread at
<A HREF="http://www.modpython.org/pipermail/mod_python/2005-May/018035.html">http://www.modpython.org/pipermail/mod_python/2005-May/018035.html</A> and
understand that this occurs because both my handler and PSP create their
own session instance and attempt to lock the session.

My question is: why doesn't the mod_python sessions module keep a
reference to each constructed session object and the thread that has it
locked? It should be possible for PSP to find and use the session object
created by the handler.

To work around this, you need to either:
    1. manually unlock the session, or
    2. pass the session to the PSP template in a different way (e.g., as
an attribute of the request object), or
    3. move everything that uses the session from the handler into the
template.

None of these are particularly appealing. Support for the session
facility is a great feature in PSP, but it is hindered by its inability
to coexist with use of sessions outside of the template. It is quite
confusing when merely referencing the 'session' variable in a template
causes a deadlock. I was unaware of PSP's session support when I
encountered this problem; I had passed my handler's session object in
via the 'vars' argument of PSP.run().
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021827.html">[mod_python] mod_python with Apache2.2?
</A></li>
	<LI>Next message: <A HREF="021831.html">[mod_python] mod_python sessions, locking, and PSP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21828">[ date ]</a>
              <a href="thread.html#21828">[ thread ]</a>
              <a href="subject.html#21828">[ subject ]</a>
              <a href="author.html#21828">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
