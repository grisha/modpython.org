<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Tips and Tricks initiative
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Tips%20and%20Tricks%20initiative&In-Reply-To=20020703173849.A937%40eye.neb">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012735.html">
   <LINK REL="Next"  HREF="012743.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Tips and Tricks initiative</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Bob Ippolito</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Tips%20and%20Tricks%20initiative&In-Reply-To=20020703173849.A937%40eye.neb"
       TITLE="[mod_python] Tips and Tricks initiative">bob at redivi.com
       </A><BR>
    <I>Wed Jul  3 18:36:04 EST 2002</I>
    <P><UL>
        <LI>Previous message: <A HREF="012735.html">[mod_python] Tips and Tricks initiative
</A></li>
        <LI>Next message: <A HREF="012743.html">[mod_python] Tips and Tricks initiative
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12739">[ date ]</a>
              <a href="thread.html#12739">[ thread ]</a>
              <a href="subject.html#12739">[ subject ]</a>
              <a href="author.html#12739">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>It depends on the particular db module, some modules have threadsafe 
database instances, some don't.  Some have threadsafe database cursors, 
and some don't.  Read the docs.  If it's DBAPI compliant, check its 
thread safe level.  I have never used anything that's thread safe level 
3, most are level 2 or 1 in my experience.

from <A HREF="http://www.python.org/topics/database/DatabaseAPI-2.0.html">http://www.python.org/topics/database/DatabaseAPI-2.0.html</A>
threadsafety
Integer constant stating the level of thread safety the interface 
supports. Possible values are:
0	= Threads may not share the module.
1	= Threads may share the module, but not connections.
2	= Threads may share the module and connections.
3	= Threads may share the module, connections and cursors.

Sharing in the above context means that two threads may use a resource 
without wrapping it using a mutex semaphore to implement resource 
locking. Note that you cannot always make external resources thread safe 
bymanaging access using a mutex: the resource may rely on global 
variables or other external sources that are beyond your control.

-bob

On Wednesday, July 3, 2002, at 06:38 PM, vio wrote:

&gt;<i> * Alain Tesio &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">alain at onesite.org</A>&gt; [020703 17:11]:
</I>&gt;<i>
</I>&gt;&gt;&gt;<i> For instance, I'd be very interested to read in such a tricks and 
</I>&gt;&gt;&gt;<i> tips list how to avoid the
</I>&gt;&gt;&gt;<i> overhead of creating a database connection at each call to 'handler'. 
</I>&gt;&gt;&gt;<i> And so on.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Just make the connection a global variable.
</I>&gt;<i>
</I>&gt;<i> I think I tried that, initialized the db connection at the module 
</I>&gt;<i> level. But somehow my cursor got corrupted, or something. I forgot 
</I>&gt;<i> oracle's error number, only that my workaround was to do something like 
</I>&gt;<i> (we're at module level here):
</I>&gt;<i>
</I>&gt;<i> db = DCOracle2.connect(my_login_string)
</I>&gt;<i> def get_db_cursor():
</I>&gt;<i>     &quot;create database connection&quot;
</I>&gt;<i>     cursor = db.cursor() # Allocate a cursor
</I>&gt;<i>     return cursor
</I>&gt;<i>
</I>&gt;<i> In fact I see that I am re-using the same connection here, so let me 
</I>&gt;<i> re-phrase my initial question: how do I re-use the same *cursor* (or it 
</I>&gt;<i> this a bad idea in the first place). I wonder what would happen in such 
</I>&gt;<i> a multi-threaded environment (well, I'm saling in Linuxland) where 
</I>&gt;<i> multiple httpd instances will hit on the db server (ora8i in my case) 
</I>&gt;<i> with the same cursor *concurrently* (never got to that point of 
</I>&gt;<i> desperation, though - but just from contemplating such possibility 
</I>&gt;<i> sounds like total anarchy). What I did try but eventually got an error 
</I>&gt;<i> on was to re-use the same cursor sequentially (in a non-threaded 
</I>&gt;<i> application).
</I>&gt;<i>
</I>&gt;<i> Cheers, Vio
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://www.modpython.org/mailman/listinfo/mod_python">http://www.modpython.org/mailman/listinfo/mod_python</A>
</I>

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012735.html">[mod_python] Tips and Tricks initiative
</A></li>
	<LI>Next message: <A HREF="012743.html">[mod_python] Tips and Tricks initiative
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12739">[ date ]</a>
              <a href="thread.html#12739">[ thread ]</a>
              <a href="subject.html#12739">[ subject ]</a>
              <a href="author.html#12739">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
