<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Session example and problems.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Session%20example%20and%20problems.&In-Reply-To=4d11484d05022719311ddb4dd5%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017557.html">
   <LINK REL="Next"  HREF="017559.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Session example and problems.</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>donnie jones</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Session%20example%20and%20problems.&In-Reply-To=4d11484d05022719311ddb4dd5%40mail.gmail.com"
       TITLE="[mod_python] Session example and problems.">donniejones18 at gmail.com
       </A><BR>
    <I>Tue Mar  1 09:34:38 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="017557.html">[mod_python] Beta testers for &quot;vampire::publisher&quot;?
</A></li>
        <LI>Next message: <A HREF="017559.html">[mod_python] Session example and problems.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17558">[ date ]</a>
              <a href="thread.html#17558">[ thread ]</a>
              <a href="subject.html#17558">[ subject ]</a>
              <a href="author.html#17558">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i>From what I can tell, since I am using XMLHttpRequest
</I>to load individual parts of the page, the cookie for the Session
is not getting updated.

I created a &quot;login&quot; page that creates the initial Session and then
goes on to use the other functions, and now the sessions
are working fine with the correct session id throughout each function.

For testing, I set the session expire to 30 seconds.
The problem is that the session keeps expiring, I think that
the XMLHttpRequest must not update the cookie for the session?

Any ideas...?  Is there a way I can manually update the cookie
through python?

Thanks for all the help.
__
Donnie


On Sun, 27 Feb 2005 22:31:00 -0500, Chris Jackson
&lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">christopher.jackson at gmail.com</A>&gt; wrote:
&gt;<i> Ah, i see.
</I>&gt;<i> 
</I>&gt;<i> ~= Chris =~
</I>&gt;<i> 
</I>&gt;<i> On Sun, 27 Feb 2005 22:21:02 -0500, donnie jones
</I>&gt;<i> &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">donniejones18 at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt; Well, GetMailboxes is the real function, but
</I>&gt;<i> &gt; UseSession is the test function...
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; It actually seems that the sid I am returning from my GetSid function
</I>&gt;<i> &gt; isn't the actual sid that is in the Cookie, so each time the function is
</I>&gt;<i> &gt; called and I pass my sid, it must think it is a new request and create
</I>&gt;<i> &gt; a new session, that's the best I can figure...
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; So, now I am trying to figure out why I am not getting the correct
</I>&gt;<i> &gt; session id the same as what is in the Cookie.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; __
</I>&gt;<i> &gt; Donnie
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; On Sun, 27 Feb 2005 21:58:01 -0500, Chris Jackson
</I>&gt;<i> &gt; &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">christopher.jackson at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt; &gt; [comments inline]
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; On Sun, 27 Feb 2005 21:39:25 -0500, donnie jones
</I>&gt;<i> &gt; &gt; &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">donniejones18 at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt; &gt; &gt; Here is the code that calls the UseSession function,
</I>&gt;<i> &gt; &gt; &gt; and it passes the sid that was from the GetSid function
</I>&gt;<i> &gt; &gt; &gt; through the javascript.
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; xmlhttp=new XMLHttpRequest();
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; if(xmlhttp2) {
</I>&gt;<i> &gt; &gt; &gt;   url = &quot;mail.py/GetMailboxes?sid=&quot; + sid;
</I>&gt;<i> &gt; &gt; &gt;   xmlhttp2.open(&quot;GET&quot;, url, true);
</I>&gt;<i> &gt; &gt; &gt; }
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; hmm, i still don't see the UseSession function. Although I do notice
</I>&gt;<i> &gt; &gt; GetMailboxes:)
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; I have a sneaking suspicion that each req is
</I>&gt;<i> &gt; &gt; &gt; overriding my sess = Session(req, sid) with a new session id
</I>&gt;<i> &gt; &gt; &gt; and it may be because the XMLHttpRequest doesn't pass
</I>&gt;<i> &gt; &gt; &gt; the cookie that is generated for the session to the page,
</I>&gt;<i> &gt; &gt; &gt; and insteach with each calls it thinks a new session should
</I>&gt;<i> &gt; &gt; &gt; be created.
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; I guess new connections via XMLHttpRequest could be happening,
</I>&gt;<i> &gt; &gt; preventing cookies from being persistent as expected.  I'm not too familiar with
</I>&gt;<i> &gt; &gt; XMLHttpRequest, although your req.write works and displays the correct sid,
</I>&gt;<i> &gt; &gt; so the cookie must be reaching the page.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; And once you have the sid, your good to go, because when using sessions,
</I>&gt;<i> &gt; &gt; data is stored on the server, and the cookie just holds the sid.  you can read
</I>&gt;<i> &gt; &gt; your /tmp/mp_sess* files and watch new session ids being created.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; I'm working on trying to figure more out...
</I>&gt;<i> &gt; &gt; &gt; __
</I>&gt;<i> &gt; &gt; &gt; Donnie
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; ~= Chris =~
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; On Sun, 27 Feb 2005 21:29:57 -0500, Chris Jackson
</I>&gt;<i> &gt; &gt; &gt; &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">christopher.jackson at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt; &gt; &gt; &gt; Can you paste the line of code where you call UseSession, passing it the sid.
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; ~= Chris =~
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; On Sun, 27 Feb 2005 14:43:38 -0500, donnie jones
</I>&gt;<i> &gt; &gt; &gt; &gt; &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">donniejones18 at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; The javascript uses XMLHttpRequest and from the responseText is
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; able to get the SID and pass it to the UseSession function.
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; I write out the session id in the UseSession function to make sure
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; that the same session id is being passed, and it works.
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; However, when I pass that same session id to the Session(req, sid)
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; it creates another session...
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; __
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; Donnie
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt;
</I></PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017557.html">[mod_python] Beta testers for &quot;vampire::publisher&quot;?
</A></li>
	<LI>Next message: <A HREF="017559.html">[mod_python] Session example and problems.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17558">[ date ]</a>
              <a href="thread.html#17558">[ thread ]</a>
              <a href="subject.html#17558">[ subject ]</a>
              <a href="author.html#17558">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
