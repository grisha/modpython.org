<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Can't parse code
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Can%27t%20parse%20code&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017593.html">
   <LINK REL="Next"  HREF="017595.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Can't parse code</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Can%27t%20parse%20code&In-Reply-To="
       TITLE="[mod_python] Can't parse code">grahamd at dscpl.com.au
       </A><BR>
    <I>Sun Mar  6 18:18:20 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="017593.html">[mod_python] Can't parse code
</A></li>
        <LI>Next message: <A HREF="017595.html">[mod_python] Using python profiler with mod_python
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17594">[ date ]</a>
              <a href="thread.html#17594">[ thread ]</a>
              <a href="subject.html#17594">[ subject ]</a>
              <a href="author.html#17594">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>It should have been:

  req.send_http_header()

Ie., not plural.

Because I had asked you to set the &quot;content_type&quot;, in 2.7.X it is necessary
to explicitly trigger the flushing out of the HTTP response headers before
writing back any actual page content. In 3.1.X, the headers are automatically
flushed out the first time you write back actual content. Thus, if you want
code to be portable between 2.7.X and 3.1.X, you need to call the method
req.send_http_header().

The consequences of not doing it in 2.7.X is that if the Apache configuration
isn't setup to send back a default content type if not set in the response
explicitly, then a browser will use the extension appearing on the request
to work out what to do with the response. Most of the time a &quot;.py&quot; extension
means nothing to a browser and it will pop up a dialog asking you to save
the file rather than simply display it.

Graham

=?ISO-8859-1?Q?M=E1rio_Gamito?= wrote ..
&gt;<i> Hi Graham,
</I>&gt;<i> 
</I>&gt;<i> Meanwhile i've manged to solve the problem.
</I>&gt;<i> Your line &quot;req.send_http_headers()&quot; gives an error (what is its 
</I>&gt;<i> importance ?).
</I>&gt;<i> If i remove it, then everything works just fine.
</I>&gt;<i> 
</I>&gt;<i> Thank you very much for your help.
</I>&gt;<i> 
</I>&gt;<i> Warm regards,
</I>&gt;<i> M&#225;rio Gamito
</I>&gt;<i> 
</I>&gt;<i> Graham Dumpleton wrote:
</I>&gt;<i> &gt; Do you see any messages of the form:
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; [Fri Sep 24 15:14:01 2004] [notice] mod_python: Creating 32 session mutexes
</I>&gt;<i> based on 150 max processes and 0 max threads. 
</I>&gt;<i> &gt; [Fri Sep 24 15:14:01 2004] [notice] Apache/2.0.51 (Unix) mod_python/3.1.3
</I>&gt;<i> Python/2.3 configured -- resuming normal operations 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; in the Apache error_log file where mod_python is mentioned. This should
</I>&gt;<i> &gt; be output when mod_python module is loaded by Apache, although the
</I>&gt;<i> &gt; exact details of version, number of process and threads will be different.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; For your particular Apache installation, are modules definitely installed
</I>&gt;<i> in
</I>&gt;<i> &gt; a &quot;libexec&quot; subdirectory? Verify where the mod_python.so is installed
</I>&gt;<i> and
</I>&gt;<i> &gt; ensure config file is the same. Try using an absolute path to the location
</I>&gt;<i> &gt; of the mod_python.so rather than a relative path.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; If there is some sort of problem with mod_python.so not finding required
</I>&gt;<i> &gt; libraries, would expect some other error message to be logged, so see
</I>&gt;<i> if
</I>&gt;<i> &gt; there are any strange error messages at all in the error_log file.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Graham
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; =?ISO-8859-1?Q?M=E1rio_Gamito?= wrote ..
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt;&gt;Hi Graham,
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;Thank you very much for your help, but the proble persists :(
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;Apache still refuses to start with &quot;PythonHandler mptest&quot; in httpd.conf
</I>&gt;<i> &gt;&gt;and without that the ouput to the browser is still the python code.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;Any idea ?
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;Warm Regards,
</I>&gt;<i> &gt;&gt;M&#225;rio Gamito
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;Graham Dumpleton wrote:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;You used the wrong documentation. You have installed 2.7.X but followed
</I>&gt;<i> &gt;&gt;&gt;instructions for 3.1.X for setting up test.
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;Change config to:
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&lt;Directory /var/www/html&gt;
</I>&gt;<i> &gt;&gt;&gt;        AddHandler python-program .py
</I>&gt;<i> &gt;&gt;&gt;        PythonHandler mptest
</I>&gt;<i> &gt;&gt;&gt;        PythonDebug On
</I>&gt;<i> &gt;&gt;&gt;&lt;/Directory&gt;&quot;
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;Ie. change &quot;mod_python&quot; to &quot;python-program&quot;.
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;Also recommended you change mptest.py code to:
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;from mod_python import apache
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;def handler(req):
</I>&gt;<i> &gt;&gt;&gt;        req.content_type = &quot;text/plain&quot;
</I>&gt;<i> &gt;&gt;&gt;        req.send_http_headers()
</I>&gt;<i> &gt;&gt;&gt;        req.write(&quot;Hello World!&quot;)
</I>&gt;<i> &gt;&gt;&gt;        return apache.OK
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;Ie., exlicitly set content type to &quot;text/plain&quot;, otherwise you are at
</I>&gt;<i> &gt;&gt;&gt;mercy of server/browser config as to what type it is sent as, with browsers
</I>&gt;<i> &gt;&gt;&gt;sometimes asking you to save file rather than view it.
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;On 07/03/2005, at 7:04 AM, M&#225;rio Gamito wrote:
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;Hi,
</I>&gt;<i> &gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;I've installed mod_python in Apache, *carefully* following the 
</I>&gt;<i> &gt;&gt;&gt;&gt;instructions in the site:
</I>&gt;<i> &gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;&quot;$ ./configure --with-apxs=/usr/local/apache/bin/apxs
</I>&gt;<i> &gt;&gt;&gt;&gt;make
</I>&gt;<i> &gt;&gt;&gt;&gt;make install&quot;
</I>&gt;<i> &gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;After that, i've configured (and restarted) Apache:
</I>&gt;<i> &gt;&gt;&gt;&gt;&quot;LoadModule python_module libexec/mod_python.so
</I>&gt;<i> &gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;(...)
</I>&gt;<i> &gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;&lt;Directory /var/www/html&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;        AddHandler mod_python .py
</I>&gt;<i> &gt;&gt;&gt;&gt;        PythonHandler mptest
</I>&gt;<i> &gt;&gt;&gt;&gt;        PythonDebug On
</I>&gt;<i> &gt;&gt;&gt;&gt;&lt;/Directory&gt;&quot;
</I>&gt;<i> &gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;wrote the example in the tutorial:
</I>&gt;<i> &gt;&gt;&gt;&gt;&quot;from mod_python import apache
</I>&gt;<i> &gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;    def handler(req):
</I>&gt;<i> &gt;&gt;&gt;&gt;        req.write(&quot;Hello World!&quot;)
</I>&gt;<i> &gt;&gt;&gt;&gt;        return apache.OK&quot;
</I>&gt;<i> &gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;and put it in /var/www/html in a file named mptest.py
</I>&gt;<i> &gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;-- 
</I>&gt;<i> &gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;Now, the problems :(
</I>&gt;<i> &gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;Apache won't start if i have the lines:
</I>&gt;<i> &gt;&gt;&gt;&gt;&quot;PythonHandler mptest
</I>&gt;<i> &gt;&gt;&gt;&gt;PythonDebug On&quot;
</I>&gt;<i> &gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;It says:
</I>&gt;<i> &gt;&gt;&gt;&gt;&quot;Invalid Command PythonHandler, perhaps mis-spelled or defined by a
</I>&gt;<i> &gt;&gt;&gt;&gt;module not included in the server configuration&quot;
</I>&gt;<i> &gt;&gt;&gt;&gt;&quot;Invalid Command PythonDebug, perhaps mis-spelled or defined by a 
</I>&gt;<i> &gt;&gt;&gt;&gt;module not included in the server configuration&quot;.
</I>&gt;<i> &gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;If i comment those lines, Apache starts but mod_python doesn't parse
</I>&gt;<i> &gt;&gt;&gt;&gt;the code, it just displays it in the browser :(
</I>&gt;<i> &gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;If i use a .htaccess file in /var/www/html, same thing happens.
</I>&gt;<i> &gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;I've read the FAQ, googled for the problem, but did not found any 
</I>&gt;<i> &gt;&gt;&gt;&gt;suggestion that solved this issue.
</I>&gt;<i> &gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;I'm using Apache 1.3.33, mod_python 2.7.11 and Python 2.3.4
</I>&gt;<i> &gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;I'm stuck on this :(
</I>&gt;<i> &gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;Any help would be apreciated.
</I>&gt;<i> &gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;Warm Regards,
</I>&gt;<i> &gt;&gt;&gt;&gt;M&#225;rio Gamito
</I>&gt;<i> &gt;&gt;&gt;&gt;_______________________________________________
</I>&gt;<i> &gt;&gt;&gt;&gt;Mod_python mailing list
</I>&gt;<i> &gt;&gt;&gt;&gt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> &gt;&gt;&gt;&gt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;
</I></PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017593.html">[mod_python] Can't parse code
</A></li>
	<LI>Next message: <A HREF="017595.html">[mod_python] Using python profiler with mod_python
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17594">[ date ]</a>
              <a href="thread.html#17594">[ thread ]</a>
              <a href="subject.html#17594">[ subject ]</a>
              <a href="author.html#17594">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
