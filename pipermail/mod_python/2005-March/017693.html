<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Trouble fetching POST arguments
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Trouble%20fetching%20POST%20arguments&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017692.html">
   <LINK REL="Next"  HREF="017695.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Trouble fetching POST arguments</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Trouble%20fetching%20POST%20arguments&In-Reply-To="
       TITLE="[mod_python] Trouble fetching POST arguments">grahamd at dscpl.com.au
       </A><BR>
    <I>Wed Mar 16 21:28:15 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="017692.html">[mod_python] Trouble fetching POST arguments
</A></li>
        <LI>Next message: <A HREF="017695.html">[mod_python] Trouble fetching POST arguments
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17693">[ date ]</a>
              <a href="thread.html#17693">[ thread ]</a>
              <a href="subject.html#17693">[ subject ]</a>
              <a href="author.html#17693">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Davin Boling wrote ..
&gt;<i> I've got an example that works correctly already. The problem is that in
</I>&gt;<i> the larger handler that I've written, SOMETHING is breaking. I can't 
</I>&gt;<i> understand at all why req.read() returns nothing on a POST when it's the
</I>&gt;<i> very first thing I assign to a variable. I'm about to go on a commenting
</I>&gt;<i> crusade to narrow down where the problem is.
</I>&gt;<i> 
</I>&gt;<i> This is my &quot;from scratch&quot; handler, which works correctly...just to show
</I>&gt;<i> that I know how to handle a POST:
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> from mod_python import apache
</I>&gt;<i> 
</I>&gt;<i> def handler(req):
</I>&gt;<i>      head = &quot;&quot;&quot;
</I>&gt;<i>             &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
</I>&gt;<i>             &lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot;
</I>&gt;<i>              &quot;<A HREF="http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;">http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;</A>&gt;
</I>&gt;<i>              &lt;html&gt;
</I>&gt;<i>              &lt;head&gt;
</I>&gt;<i>              &lt;title&gt;Debug&lt;/title&gt;
</I>&gt;<i>              &lt;/head&gt;
</I>&gt;<i>              &lt;body&gt;
</I>&gt;<i>             &quot;&quot;&quot;
</I>&gt;<i>      data = req.read()
</I>&gt;<i>      method = req.method
</I>&gt;<i>      req.content_type = &quot;text/html&quot;
</I>&gt;<i>      req.write(head + data + method + '&lt;/body&gt;&lt;/html&gt;')
</I>&gt;<i>      return apache.OK
</I>
Get the content length out of the headers and supply it to req.read()
and see if that makes a difference. Ie.,

      length = int(req.headers_in[&quot;content-length&quot;])
      data = req.read(length)

Also note what documentation says about timeouts.

  read([len])

    Reads at most len bytes directly from the client, returning a  string
    with the data read. If the len argument is negative or omitted, reads
    all data given by the client.

    This function is affected by the Timeout Apache configuration  directive.
    The read will be aborted and an IOError  raised if the Timeout is reached
    while reading client data.

    This function relies on the client providing the Content-length  header.
    Absence of the Content-length header will be treated as  if
    Content-length: 0 was supplied.

    Incorrect Content-length may cause the function to try to read  more
    data than available, which will make the function block until a  Timeout
    is reached.

One would expect an IOError according to this if a timeout occured, but
maybe it isn't being generated for some reason.

You might also add:

  time.sleep(10)

at the start of your handler and see if it makes a difference. Ie., try and
determine if it is the time the client takes to send the post data.

Graham
     
</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017692.html">[mod_python] Trouble fetching POST arguments
</A></li>
	<LI>Next message: <A HREF="017695.html">[mod_python] Trouble fetching POST arguments
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17693">[ date ]</a>
              <a href="thread.html#17693">[ thread ]</a>
              <a href="subject.html#17693">[ subject ]</a>
              <a href="author.html#17693">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
