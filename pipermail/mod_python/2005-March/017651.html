<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] subclassing Session for Postgresql
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20subclassing%20Session%20for%20Postgresql&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017650.html">
   <LINK REL="Next"  HREF="017667.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] subclassing Session for Postgresql</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Troy Unrau</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20subclassing%20Session%20for%20Postgresql&In-Reply-To="
       TITLE="[mod_python] subclassing Session for Postgresql">troy at tblog.ath.cx
       </A><BR>
    <I>Tue Mar 15 04:42:15 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="017650.html">[mod_python] Killer mod_python App
</A></li>
        <LI>Next message: <A HREF="017667.html">[mod_python] subclassing Session for Postgresql
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17651">[ date ]</a>
              <a href="thread.html#17651">[ thread ]</a>
              <a href="subject.html#17651">[ subject ]</a>
              <a href="author.html#17651">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm using postgresql for all of my website data, so naturally I was looking to 
use it for storing of session data.  The code doesn't seem to be postgresql 
specific as it uses the standard python db api, and the SQL is fairly 
standard.

from my source:

class SQLSession(Session.BaseSession):

    def __init__(self, req, 
                 db, table, key_colname, val_colname,
	         sid=0, secret=None,
                 timeout=0, lock=1):
        &quot;&quot;&quot;
        SQLSession class arguments:

        req: mod_python request object
        db: python DB API 2 object, such as a postgresql connection returned
            from the psycopg module
        table: name of the SQL table to store objects in
        key_colname: name of the column in above table corresponding to the
                     session id key.
        val_colname: name of the column in above table corresponding to the
                     actual session data

        All other arguments follow from BaseSession in mod_python.  See docs
        for mod_python 3.1.x, section 4.8.1
        &quot;&quot;&quot;

I have attached the code I've concocted that does the job for me, if anyone is 
interested.  It does work for me using a psycopg returned DB object for 
postgresql.

One comment.  Using this method, the apache lock calls don't seem to be 
required, however I have left them in there since they don't seem to be doing 
any harm.  What /should/ happen though is for locking to take into account 
the fact that there could be multiple apache servers in a cluster all using 
the same session data from one database.  In this case, a database oriented 
locking scheme should be implemented instead.

Comments, suggestions and reuse are welcome. (the file is under a very 
slightly modified BSD-style licence)

Cheers, 

Troy Unrau
<A HREF="http://tblog.ath.cx/troy">http://tblog.ath.cx/troy</A>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SQLSession.py
Type: application/x-python
Size: 9431 bytes
Desc: not available
Url : <A HREF="http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20050315/c9b4233e/SQLSession.bin">http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20050315/c9b4233e/SQLSession.bin</A>
</PRE>




















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017650.html">[mod_python] Killer mod_python App
</A></li>
	<LI>Next message: <A HREF="017667.html">[mod_python] subclassing Session for Postgresql
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17651">[ date ]</a>
              <a href="thread.html#17651">[ thread ]</a>
              <a href="subject.html#17651">[ subject ]</a>
              <a href="author.html#17651">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
