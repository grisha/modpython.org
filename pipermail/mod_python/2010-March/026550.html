<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Paramiko connection to SFTP web-based client
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Paramiko%20connection%20to%20SFTP%20web-based%20client&In-Reply-To=0B1220B1BC53C04384C8EACA4EEA24C2814EE98D08%40GS-EXCH-01.greensky.local">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026549.html">
   <LINK REL="Next"  HREF="026559.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Paramiko connection to SFTP web-based client</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Paramiko%20connection%20to%20SFTP%20web-based%20client&In-Reply-To=0B1220B1BC53C04384C8EACA4EEA24C2814EE98D08%40GS-EXCH-01.greensky.local"
       TITLE="[mod_python] Paramiko connection to SFTP web-based client">graham.dumpleton at gmail.com
       </A><BR>
    <I>Thu Mar 11 23:31:40 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="026549.html">[mod_python] Paramiko connection to SFTP web-based client
</A></li>
        <LI>Next message: <A HREF="026559.html">[mod_python] mod_python (source compatible) middleware for mod_wsgi
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26550">[ date ]</a>
              <a href="thread.html#26550">[ thread ]</a>
              <a href="subject.html#26550">[ subject ]</a>
              <a href="author.html#26550">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 12 March 2010 14:50, Mark Brown &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mark.Brown at greenskycredit.com</A>&gt; wrote:
&gt;<i> Yeah, I've looked everywhere for a sftp web client, and did find one written as a java applet. Unfortunately, I want pure html and not an embedded applet in a webpage.
</I>&gt;<i>
</I>&gt;<i> Can you expand some more on what you mean by this:
</I>&gt;<i>
</I>&gt;<i> &quot;You then though have to learn WSGI or use one
</I>&gt;<i> of the WSGI frameworks/toolkits. You still couldn't use traditional
</I>&gt;<i> session layers though and would need to maintain your own data
</I>&gt;<i> structure with active pool of connections in memory.&quot;
</I>
For details about WSGI, read:

<A HREF="http://www.wsgi.org/wsgi/">http://www.wsgi.org/wsgi/</A>

For the same reasons as in mod_python, you can't store stuff like
network connections in session databases if using WSGI based solutions
if session database is not in memory.

In short WSGI is just another way of hosting Python web applications
which supports many hosting implementations and not just one like
mod_python. So, not bound to the one solution.

&gt;<i> Also, I have read some stuff about twisted and cherrypy. Would either of these help me out?
</I>
Twisted supports running WSGI applications within it. CherryPy
framework uses WSGI interface and so can host on its own WSGI server,
on top of Twisted or on top of any other WSGI hosting mechanism.

Twisted may be a good (but complicated) choice, because it has various
components for dealing with communicating with Internet services,
perhaps including SFTP.

&gt;<i> Sorry if I am being naive, I am by no means an expert in apache or python.
</I>
Then you have a lot of reading and learning to do. :-)

Graham


&gt;<i> ________________________________________
</I>&gt;<i> From: Graham Dumpleton [<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">graham.dumpleton at gmail.com</A>]
</I>&gt;<i> Sent: Thursday, March 11, 2010 7:32 PM
</I>&gt;<i> To: Mark Brown
</I>&gt;<i> Cc: <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mod_python at modpython.org</A>
</I>&gt;<i> Subject: Re: [mod_python] Paramiko connection to SFTP web-based client
</I>&gt;<i>
</I>&gt;<i> On 12 March 2010 09:09, Mark Brown &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mark.Brown at greenskycredit.com</A>&gt; wrote:
</I>&gt;&gt;<i> Sorry that I am really, really new to Python but I have run into a wall and
</I>&gt;&gt;<i> need some help:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Basically, I am trying to create a web-client for a sftp server.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> You enter your user name and password and you authenticate against the sftp
</I>&gt;&gt;<i> server, see a list of all the files on the server, can browse the server,
</I>&gt;&gt;<i> and if you click on a link download the file.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I have tried several different methods to keep the network-resource in the
</I>&gt;&gt;<i> session, but nothing thus far has worked. My research seems to indicate that
</I>&gt;&gt;<i> in order to achieve this I would need to write a daemon that handles the
</I>&gt;&gt;<i> connection, and pass the session id to the daemon to match connection to web
</I>&gt;&gt;<i> request.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I have found some articles on how to turn a python script into a daemon, but
</I>&gt;&gt;<i> I need some help understanding what is really going.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Anyways, the script &#160;I have tested thus far using mod_python is below:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> from mod_python import apache
</I>&gt;&gt;<i> from mod_python import Session
</I>&gt;&gt;<i> import paramiko
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> def handler(req):
</I>&gt;&gt;<i> &#160; &#160; &#160; session=Session.Session(req)
</I>&gt;&gt;<i> &#160; &#160; &#160; req.content_type=&quot;text/html&quot;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &#160; &#160; &#160; try:
</I>&gt;&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; session['hits'] +=1
</I>&gt;&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; #dirlist=session['sftp'].listdir('.')
</I>&gt;&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; req.write('From Session')
</I>&gt;&gt;<i> &#160; &#160; &#160; except:
</I>&gt;&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; t=paramiko.Transport(('[SERVER NAME],22))
</I>&gt;&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; t.connect(username='[USER NAME]',password='[PASSWORD]')
</I>&gt;&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; sftp=paramiko.SFTPClient.from_transport(t)
</I>&gt;&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; dirlist = sftp.listdir('.')
</I>&gt;&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; session['hits']=1
</I>&gt;&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; session['sftp']=sftp
</I>&gt;&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; req.write('New Session')
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &#160; &#160; &#160; session.save()
</I>&gt;&gt;<i> &#160; &#160; &#160; req.write('Hits %d\n' % session['hits'])
</I>&gt;&gt;<i> &#160; &#160; &#160; req.write(dirlist)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &#160; &#160; &#160; return apache.OK
</I>&gt;<i>
</I>&gt;<i> To ensure portability and overall guarantee it will always work, you
</I>&gt;<i> should only store in session basic Python data types. Even class
</I>&gt;<i> objects should be avoided even if they can be pickled. This is because
</I>&gt;<i> normally the session is stored in a database outside of the process.
</I>&gt;<i> Complex objects such as a socket handle obviously cant therefore be
</I>&gt;<i> stored.
</I>&gt;<i>
</I>&gt;<i> The only time doing so would work is on Windows. That is because in
</I>&gt;<i> that case the session database is in memory and isn't actually written
</I>&gt;<i> to a separate database. You could only make it work on UNIX systems by
</I>&gt;<i> changing your Apache configuration such that it only ever used a
</I>&gt;<i> single server child process such that all requests handled by same
</I>&gt;<i> process and forcing the use of in memory session database. Forcing a
</I>&gt;<i> single process when using mod_python on UNIX sort of defeats the
</I>&gt;<i> problem of using Apache.
</I>&gt;<i>
</I>&gt;<i> You could use this single process model by instead using mod_wsgi as
</I>&gt;<i> at least with that you could use its daemon mode and force your web
</I>&gt;<i> application to run in single dedicated process separate to the Apache
</I>&gt;<i> server child processes. You then though have to learn WSGI or use one
</I>&gt;<i> of the WSGI frameworks/toolkits. You still couldn't use traditional
</I>&gt;<i> session layers though and would need to maintain your own data
</I>&gt;<i> structure with active pool of connections in memory.
</I>&gt;<i>
</I>&gt;<i> BTW, are you sure there aren't already web interfaces to SFTP clients?
</I>&gt;<i> Sure there would be one somewhere, albeit maybe implemented in a
</I>&gt;<i> different language.
</I>&gt;<i>
</I>&gt;<i> Graham
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> This message was scanned by ESVA and is believed to be clean.
</I>&gt;<i>
</I>&gt;<i> This electronic message transmission contains information from GreenSky Trade Credit, LLC which may be confidential &amp; privileged. &#160;Recipients should not file copies of this e-mail with publicly accessed records. &#160;The information is intended to be for the use of the individual(s) named above. If you are not the intended recipient, please be aware that any disclosure, copying, distribution or use of this message is prohibited. If you have received this electronic transmission in error, please notify us by e-mail immediately.
</I>&gt;<i>
</I>
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="026549.html">[mod_python] Paramiko connection to SFTP web-based client
</A></li>
	<LI>Next message: <A HREF="026559.html">[mod_python] mod_python (source compatible) middleware for mod_wsgi
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26550">[ date ]</a>
              <a href="thread.html#26550">[ thread ]</a>
              <a href="subject.html#26550">[ subject ]</a>
              <a href="author.html#26550">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
