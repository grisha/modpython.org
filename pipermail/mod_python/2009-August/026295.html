<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] mod_python modifies time zone of Apache child
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20mod_python%20modifies%20time%20zone%20of%20Apache%20child&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026294.html">
   <LINK REL="Next"  HREF="026296.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] mod_python modifies time zone of Apache child</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Stephan Paukner</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20mod_python%20modifies%20time%20zone%20of%20Apache%20child&In-Reply-To="
       TITLE="[mod_python] mod_python modifies time zone of Apache child">paux at paukner.cc
       </A><BR>
    <I>Thu Aug  6 11:01:01 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="026294.html">[mod_python] Compiling issue: connobject.c kills make
</A></li>
        <LI>Next message: <A HREF="026296.html">[mod_python] mod_python modifies time zone of Apache child
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26295">[ date ]</a>
              <a href="thread.html#26295">[ thread ]</a>
              <a href="subject.html#26295">[ subject ]</a>
              <a href="author.html#26295">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I use Apache2 in MPM prefork mode. I noticed that if a specific Apache
child process handles a request to a roundup(.sf.net) tracker instance
via mod_python, the child's time zone is set to UTC, permanently. If any
other HTTP client gets to reuse that specific Apache child, the request
is still handled in UTC. This leads to times jumping between UTC and the
local timezone e.g. in a PHP-based calendar on the same site, depending
on the involved Apache child processes, what is quite annoying.

If I request the following URL sequence after an Apache restart:
    <A HREF="https://ourhostname/server-status">https://ourhostname/server-status</A>
    <A HREF="https://ourhostname/tracker/">https://ourhostname/tracker/</A>
    <A HREF="https://ourhostname/server-status">https://ourhostname/server-status</A>
then the &quot;Current Time&quot; indicated in the server-status shows e.g.
&quot;03:13:37 CEST&quot; (our local timezone) before and &quot;01:13:37 UTC&quot;
afterwards, because all three requests are obviously served by the same
Apache child. These jumping times also show up in the Apache logs.

This doesn't happen if I directly access the tracker via
    <A HREF="http://ourhostname:8080/tracker/">http://ourhostname:8080/tracker/</A>

I tried adding
    SetEnv TZ Europe/Vienna
at various places in our virtual host, but AFAIK these settings are only
read at the creation of a child process, not repeatedly. I don't know
how to set the timezone globally for all python instances on that host;
I set TZ in /etc/environment. I've set up the mod_python.testhandler
like suggested in the Troubleshooting section, and /mpinfo indeed shows
&quot;TZ&quot; with value &quot;Europe/Vienna&quot;, but I can't see any time information in
that output.


All packages are from Debian amd64 Lenny. mod_python bindings for
roundup are just as suggested
in /usr/share/doc/roundup/examples/roundup_apache.


Any suggestions on how to explore this further? Do you need more config
info?
Thanks!

Regards
-- 
Stephan Paukner &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">paux at paukner.cc</A>&gt;

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="026294.html">[mod_python] Compiling issue: connobject.c kills make
</A></li>
	<LI>Next message: <A HREF="026296.html">[mod_python] mod_python modifies time zone of Apache child
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26295">[ date ]</a>
              <a href="thread.html#26295">[ thread ]</a>
              <a href="subject.html#26295">[ subject ]</a>
              <a href="author.html#26295">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
