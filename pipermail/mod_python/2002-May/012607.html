<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] mod_python.publisher and PythonHandler
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20mod_python.publisher%20and%20PythonHandler&In-Reply-To=20020514221313.A14746%40samson.sentinelchicken.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012601.html">
   <LINK REL="Next"  HREF="012612.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] mod_python.publisher and PythonHandler</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Ian Clelland</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20mod_python.publisher%20and%20PythonHandler&In-Reply-To=20020514221313.A14746%40samson.sentinelchicken.net"
       TITLE="[mod_python] mod_python.publisher and PythonHandler">ian at veryfresh.com
       </A><BR>
    <I>Fri May 17 20:27:54 EST 2002</I>
    <P><UL>
        <LI>Previous message: <A HREF="012601.html">[mod_python] mod_python.publisher and PythonHandler
</A></li>
        <LI>Next message: <A HREF="012612.html">[mod_python] THANKS FOR THE HELP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12607">[ date ]</a>
              <a href="thread.html#12607">[ thread ]</a>
              <a href="subject.html#12607">[ subject ]</a>
              <a href="author.html#12607">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, May 14, 2002 at 10:13:13PM -0700, Jason Morgan wrote:
&gt;<i> Hello:
</I>&gt;<i> 
</I>&gt;<i> Ok, please excuse my ignorance, but I'm trying to move three sites 
</I>&gt;<i> over to mod_python from php and I'm having some trouble figuring what 
</I>&gt;<i> is the 'proper' way to proceed. I have mod_python installed and 
</I>&gt;<i> working, however, I'm not familiar with the handler concept (yes, I 
</I>&gt;<i> RTFM) and am trying to decide what to do with it. Should I have 
</I>&gt;<i> handler dealing with everything in my dirs, while passing off content 
</I>&gt;<i> generation to methods within personal modules? What is the role of 
</I>&gt;<i> mod_python.publisher. I would appreciate any help I can get - URLs 
</I>&gt;<i> are welcome. I've done the google searches, though, and haven't come 
</I>&gt;<i> across anytrhing about how people actually structure their sites. I 
</I>&gt;<i> dont' just want to hack something together - as I plan to leave most 
</I>&gt;<i> site maintenance to a new employee
</I>&gt;<i> :-).
</I>
Well, I'm not sure how closely my experiences mirror those of other 
mod_python developers, but I can try to give you some insight. (I spent 
about two years writing almost exclusively in PHP, and am now adjusting 
to mod_python)

The handler concept is by far the biggest difference between the two 
environments. A PHP script typically resides 'at' a specific URL, and 
only services requests for that URL. A mod_python handler, in contrast, 
becomes part of the web server, and handles requests whenever Apache 
gives them to it.

To be a little clearer, the way I will usually install a handler is to 
include it within an Apache &lt;Location&gt; directive. For example, I am 
writing a user-management module, and I want it to be mounted at 
<A HREF="http://mysite.com/users,">http://mysite.com/users,</A> so I set up Apache like this:

  &lt;Location /users&gt;
    SetHandler python-program
    PythonPath &quot;sys.path+['/usr/local/lib/site_apps']&quot;
    PythonHandler userinfo
  &lt;/Location&gt;

This means that now my python module (at 
/usr/local/lib/site_apps/userinfo.py) is responsible for *every* 
request to a URL which begins with &quot;/users&quot;. 

The first thing that userinfo.py does is analyse the URL of the request 
to see exactly what was requested. If it is just &quot;/users/&quot;, it displays 
a list of users. If it is &quot;/users/showuser/ian&quot;, then it looks up the 
user record for 'ian' and displays that record. If it is 
&quot;/users/no-such-page&quot; then it returns apache.DECLINED, and Apache 
handles the 404 error.

I can also distinguish between GET and POST requests by examining the 
req.method variable. If the request is a GET to 
&quot;/users/deleteuser/ian&quot;, then userinfo.py will display a confirmation 
page. If it is a POST to that same URL, it will read the POST data, 
look for a confirmation, and delete the user.

Most of my handlers are designed in this fashion, as one main python 
module installed under a base URL, which defines a &quot;URL-space&quot;. The 
main module uses import statements to access all of the libraries it 
needs (database access, user record class, string, cgi, etc.) to do its
work.


If you want to look for other resources on application design with 
mod_python, try searching for information on mod_perl. It's the closest 
thing I have found to mod_python, as they both act as scripting-
language interfaces to the Apache C API. O'Reilly's book &quot;Writing 
Apache Modules with Perl and C&quot; has been an invaluable resource for me. 
Also, once you understand how the Apache API works, the mod_python 
documentation becomes a much more useful tool.


If your goal is just to convert your applications from PHP to the 
Python language, then you may want to look at the Publisher handler 
which Grisha has supplied with mod_python. It allows you to use Python 
scripts in a very similar fashion to PHP or CGI scripts, and a lot of 
people on this list seem to be using it exclusively. In that case, the 
publisher handler becomes the default handler for your entire site. It 
deals with every request that comes in by looking for a Python module 
with the appropriate name in the right directory, and passing it 
parameters based on the request. (This is actually completely backwards 
to the way PHP works, but the effect is the same -- you believe that 
you are calling the Python script directly from the URL.)


I hope this answers at least some of your questions; feel free to ask 
more if I've just made things more confusing :)


Ian
&lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">ian at veryfresh.com</A>&gt;


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012601.html">[mod_python] mod_python.publisher and PythonHandler
</A></li>
	<LI>Next message: <A HREF="012612.html">[mod_python] THANKS FOR THE HELP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12607">[ date ]</a>
              <a href="thread.html#12607">[ thread ]</a>
              <a href="subject.html#12607">[ subject ]</a>
              <a href="author.html#12607">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
