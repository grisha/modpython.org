<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] cgihandler, w2k
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20cgihandler%2C%20w2k&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012604.html">
   <LINK REL="Next"  HREF="012605.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] cgihandler, w2k</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Roger Baklund</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20cgihandler%2C%20w2k&In-Reply-To="
       TITLE="[mod_python] cgihandler, w2k">roger.baklund at mobiliant.com
       </A><BR>
    <I>Wed May 15 17:49:38 EST 2002</I>
    <P><UL>
        <LI>Previous message: <A HREF="012604.html">[mod_python] mod_python.publisher and PythonHandler
</A></li>
        <LI>Next message: <A HREF="012605.html">[mod_python] Apache 2.0 CVS?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12602">[ date ]</a>
              <a href="thread.html#12602">[ thread ]</a>
              <a href="subject.html#12602">[ subject ]</a>
              <a href="author.html#12602">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

we have installed mod_python on a w2k server, and the mptest.py &quot;Hello
world&quot; is working.

However, when running a cgi application through the cgihandler, we have some
problems.

First, we thought it was working, but it was not, as we saw many python
processes coming and going in the task manager, as if it was running like a
normal cgi.

We reinstalled, and we patched some lines in apache.py, function
setup_cgi(), according to notes found on this mailinglist (&quot;old_env =
os.environ.copy()&quot; and &quot;return old_env, si, so&quot;).

This time the cgihandler was running, and we found some problems in the cgi
that we fixed (&quot;if __name__ == '__main__':&quot; and some redirects that went
wrong because of missing status header.)

Then we got some strange errors... it started to complain about modules not
existing, when it was trying to delete from sys.modules. This is in the
beginning of the cgihandler.py handler() function.

We had to move the &quot;_lock.acquire()&quot; to before the sys.modules loop to get
rid of the error messages.

We tried to remove the sys.modules loop (as indicated in a comment in the
source), but we could not make that work. We always get Internal Server
Error when we try to run without this module reload mechanism. See log
entries below.

The application is frames based. When the user log in, a frameset is
returned, and new requests are made for a stylesheet, a couple of external
javascripts, and a couple of cgi-based html pages/frames.

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012604.html">[mod_python] mod_python.publisher and PythonHandler
</A></li>
	<LI>Next message: <A HREF="012605.html">[mod_python] Apache 2.0 CVS?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12602">[ date ]</a>
              <a href="thread.html#12602">[ thread ]</a>
              <a href="subject.html#12602">[ subject ]</a>
              <a href="author.html#12602">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
