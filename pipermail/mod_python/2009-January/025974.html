<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Bizarre error wiping globals()  under mod_python ...
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Bizarre%20error%20wiping%20globals%28%29%20%20under%20mod_python%20...&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025973.html">
   <LINK REL="Next"  HREF="025975.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Bizarre error wiping globals()  under mod_python ...</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Monsyne Dragon</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Bizarre%20error%20wiping%20globals%28%29%20%20under%20mod_python%20...&In-Reply-To="
       TITLE="[mod_python] Bizarre error wiping globals()  under mod_python ...">mdragon at rackspace.com
       </A><BR>
    <I>Wed Jan 28 20:59:12 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="025973.html">[mod_python] make_obcallback: could not import mod_python.apache.\n
</A></li>
        <LI>Next message: <A HREF="025975.html">[mod_python] Bizarre error wiping globals() under mod_python ...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25974">[ date ]</a>
              <a href="thread.html#25974">[ thread ]</a>
              <a href="subject.html#25974">[ subject ]</a>
              <a href="author.html#25974">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Ok, this is an odd one, any clues we can get would help.

Environment mod_python 3.1.4 w/  python 2.4 on Ubuntu dapper

We have a web app running under mod_python (it uses an obscure 
templating language/framework called PSE <A HREF="http://nick.borko.org/pse/">http://nick.borko.org/pse/</A>)

We are having an intermittent glitch which is truely bizarre.   
Periodically, one module deep in this large webapp is losing it's global 
namespace. 
On our production servers, this happens on random occasional basis, but 
we have replicated it on another machine. On that machine it was 
happening every other pagehit,
and is now happening every pagehit except the first one after restarting 
apache (we don't know why this changed). 

This manifests in mindbenders like: we will import a module, (like 
'sys') like so:

import sys

class SomeClass()
    def __init__(self, args, go, here):
          sys.stderr.write('Some message')

This will run fine on the first hit, then subsequently will produce an 
exception saying that &quot;'NoneType' object has no attribute 'stderr'&quot; !!
And it's not just 'sys' that that happens to. if we catch the exception 
and print the contents of globals() at that point, ALL of the modules 
imported, and any global variables  have their values  set to None!

As far as we can tell, it is only happening to this one module in our 
(large,  hundreds of modules) codebase.  The module itself  is actually 
generated code, generated by the ZSI-2.0 SOAP library, and we've 
exercised this code from the command line hundreds of times without 
fail, running it in a loop.  It only fails like this in the mod_python 
environment, and then, not every time.

Does anyone have an idea of where to even begin to figure this out?



-- 
--M. Dragon



Confidentiality Notice: This e-mail message (including any attached or
embedded documents) is intended for the exclusive and confidential use of the
individual or entity to which this message is addressed, and unless otherwise
expressly indicated, is confidential and privileged information of Rackspace.
Any dissemination, distribution or copying of the enclosed material is prohibited.
If you receive this transmission in error, please notify us immediately by e-mail
at <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">abuse at rackspace.com</A>, and delete the original message.
Your cooperation is appreciated.

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025973.html">[mod_python] make_obcallback: could not import mod_python.apache.\n
</A></li>
	<LI>Next message: <A HREF="025975.html">[mod_python] Bizarre error wiping globals() under mod_python ...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25974">[ date ]</a>
              <a href="thread.html#25974">[ thread ]</a>
              <a href="subject.html#25974">[ subject ]</a>
              <a href="author.html#25974">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
