<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Caching issues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Caching%20issues&In-Reply-To=d01b8cf20901102104q48ef203av865aacf68d2e47f5%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025919.html">
   <LINK REL="Next"  HREF="025921.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Caching issues</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Caching%20issues&In-Reply-To=d01b8cf20901102104q48ef203av865aacf68d2e47f5%40mail.gmail.com"
       TITLE="[mod_python] Caching issues">graham.dumpleton at gmail.com
       </A><BR>
    <I>Sun Jan 11 00:23:07 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="025919.html">[mod_python] Caching issues
</A></li>
        <LI>Next message: <A HREF="025921.html">[mod_python] Caching issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25920">[ date ]</a>
              <a href="thread.html#25920">[ thread ]</a>
              <a href="subject.html#25920">[ subject ]</a>
              <a href="author.html#25920">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>2009/1/11 Tim Valenta &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">tonightslastsong at gmail.com</A>&gt;:
&gt;<i> Hello all-- I've been experiencing a caching issue from the
</I>&gt;<i> very beginning of my use of mod_python...  It's been at least 2 months now,
</I>&gt;<i> and I keep running into actual issues that prevent me from coding.
</I>&gt;<i> I have a knack for over-explaining, so I'll try to keep this concise yet
</I>&gt;<i> descriptive.
</I>
Still not short enough, so much so I stopped part way through.

The simple matter of it is that mod_python does not do deep checking
of code for changes, nor does it automatically restart the process
when code is changed. Thus the need to restart Apache when you make
code changes to anything imported from sys.path is expected and normal
behaviour.

The only time any code is automatically reloaded is the direct code
files imported by mod_python using its own special module importer.
This is documented under 'import_module()' function in:

  <A HREF="http://www.modpython.org/live/current/doc-html/pyapi-apmeth.html">http://www.modpython.org/live/current/doc-html/pyapi-apmeth.html</A>

Graham

&gt;<i> I'm developing a site on my local machine, Windows Vista, using Apache 2.2.x
</I>&gt;<i> and mod_python 3.3.1 .  I'm a programmer for a living, and I'm not quick to
</I>&gt;<i> point the finger at the language, *but* (you knew that was coming, eh?) I
</I>&gt;<i> know my code isn't to blame for the issue:
</I>&gt;<i> I write some basic code for an 'index.py' file, using the
</I>&gt;<i> mod_python.publisher handler.  'index.py' includes other modules which I've
</I>&gt;<i> coded from that same location, etc, etc.  Nothing fancy.  Any changes I make
</I>&gt;<i> in the 'index.py' file will be reflected immediately on my local web server.
</I>&gt;<i>  On the other hand, any changes I make to the modules included via import
</I>&gt;<i> from within 'index.py' are completely ignored by the web server.  It took me
</I>&gt;<i> a while to realize that my pages didn't reflect my code.  I also discovered
</I>&gt;<i> that the .pyc files had nothing to do with it.  I finally just restarted the
</I>&gt;<i> apache web service (which in fact runs as a service on my machine), and then
</I>&gt;<i> my code finally gets pushed through to the web server.
</I>&gt;<i> I've been looking around practically every other day for documentation on
</I>&gt;<i> how to make apache/mod_python simply cut it out and stop caching my python
</I>&gt;<i> code, but I've found nothing.  You can imagine the annoyance this presents,
</I>&gt;<i> since I have to restart my web server every single time I make even the
</I>&gt;<i> slightest change to a 'utility.py' file, etc.
</I>&gt;<i> I've been coping with the problem for a while now, but then I've found far
</I>&gt;<i> more annoying issues recently.  To abbreviate the problem into short terms,
</I>&gt;<i> I've got a main module 'MAIN' which imports another module for a class
</I>&gt;<i> 'CLASS'.  CLASS also has a few imports, such as 'backend' stuff for
</I>&gt;<i> interfacing with various databases, etc.  We'll call the 'backend' module
</I>&gt;<i> &quot;BACKEND&quot;.  Given the setup, any changes I make to CLASS or BACKEND require
</I>&gt;<i> an apache restart in order to take effect.
</I>&gt;<i> I have a function in CLASS which calls a function from it's imported BACKEND
</I>&gt;<i> module.  I tried adding a parameter to the BACKEND function in question, and
</I>&gt;<i> properly passed said parameter while in CLASS, yet the mod_python debugger
</I>&gt;<i> spits out an error about me having passed 3 arguments, when the BACKEND
</I>&gt;<i> function takes exactly 2.  This is outright false, since my function in
</I>&gt;<i> BACKEND looks like:
</I>&gt;<i> def getUsers(self, req, terms):
</I>&gt;<i>
</I>&gt;<i> and I'm calling it with
</I>&gt;<i> self.backend.getUsers(self.req, search)
</I>&gt;<i>
</I>&gt;<i> In reality, my code dictates that I'm passing 3 (including the implicit
</I>&gt;<i> 'self' argument), and BACKEND's 'getUsers' does in fact take exactly 3
</I>&gt;<i> arguments.  Yet, the debugger is telling me that it takes only 2.
</I>&gt;<i> I was trying to pass it 'req' because I wanted to investigate a little error
</I>&gt;<i> in the code by printing something to the output HTML.  So, my attempt is
</I>&gt;<i> foiled, since somewhere something isn't being updated to what my most
</I>&gt;<i> current code actually says.
</I>&gt;<i> Just to test, I made the 'getUsers' function return immediately with a
</I>&gt;<i> string of gibberish, like 'return &quot;adsfasdfadsfa&quot;'.  this should make my
</I>&gt;<i> other code spin wildly out of control and encounter errors, yet when I
</I>&gt;<i> restart apache and test it... lo and behold, it's completely ignoring my
</I>&gt;<i> goofy 'return' statement.  The 'getUsers' function is still somehow
</I>&gt;<i> returning valid data, as if the 'return' wasn't there at all!
</I>&gt;<i> So then I tried causing actual syntax errors.  The debugger caught this,
</I>&gt;<i> much to my inner joy.  So I tried causing a semantic error instead:
</I>&gt;<i> referencing a non-existent attribute of a non-existent variable:
</I>&gt;<i> madeUpVar.moo = 42
</I>&gt;<i> Syntactically, nothing wrong, but at run time it should most definitely
</I>&gt;<i> encounter a NameError or something equally as realistic.  But I restart
</I>&gt;<i> apache, and... nothing.  The line is completely ignored.
</I>&gt;<i> Which leads me to believe that it's not actually being 'ignored' per se, but
</I>&gt;<i> rather the code being compiled is not the same as the code in play within
</I>&gt;<i> the web server.  When I delete my .pyc files and restart apache and visit
</I>&gt;<i> the URL that triggers my python code, my .py files are in fact being
</I>&gt;<i> recompiled down to their byte code .pyc files.  And clearly the interpreter
</I>&gt;<i> is processing my code, since it flags me on improper syntax.  Yet, no matter
</I>&gt;<i> what kind of syntactically-sound nonsense I put into my code, the changes
</I>&gt;<i> aren't being reflected in my web server.
</I>&gt;<i> These problems come and go, and I've go better explanation than over zealous
</I>&gt;<i> caching.  I imagine that by tomorrow sometime when I start my computer up,
</I>&gt;<i> the problem will have disappeared for the time being.
</I>&gt;<i> I've cursed this computer up and down as I've tried to figure out ANYTHING
</I>&gt;<i> that I can do to alleviate the issue, by to no avail.
</I>&gt;<i> Anybody with counsel to spare my tired brain is welcome to share...
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i>
</I>&gt;<i>
</I></PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025919.html">[mod_python] Caching issues
</A></li>
	<LI>Next message: <A HREF="025921.html">[mod_python] Caching issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25920">[ date ]</a>
              <a href="thread.html#25920">[ thread ]</a>
              <a href="subject.html#25920">[ subject ]</a>
              <a href="author.html#25920">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
