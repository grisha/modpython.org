<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Caching issues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Caching%20issues&In-Reply-To=d01b8cf20901111316g7394079dqb61b650a4c08f90f%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025921.html">
   <LINK REL="Next"  HREF="025923.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Caching issues</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Caching%20issues&In-Reply-To=d01b8cf20901111316g7394079dqb61b650a4c08f90f%40mail.gmail.com"
       TITLE="[mod_python] Caching issues">graham.dumpleton at gmail.com
       </A><BR>
    <I>Sun Jan 11 16:23:21 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="025921.html">[mod_python] Caching issues
</A></li>
        <LI>Next message: <A HREF="025923.html">[mod_python] Caching issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25922">[ date ]</a>
              <a href="thread.html#25922">[ thread ]</a>
              <a href="subject.html#25922">[ subject ]</a>
              <a href="author.html#25922">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>2009/1/12 Tim Valenta &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">tonightslastsong at gmail.com</A>&gt;:
&gt;&gt;<i> Still not short enough, so much so I stopped part way through.
</I>&gt;<i>
</I>&gt;<i> And for that I apologize.  I do appreciate the straight answer given,
</I>&gt;<i> though I would appreciate much more the addition of that fact in some
</I>&gt;<i> point-blank documentation that was easy to find.  I have scoured the
</I>&gt;<i> mod_python archives by search engine and came out utterly empty
</I>&gt;<i> handed.  I knew what the problem was, but I could find nothing to
</I>&gt;<i> remedy the issue.  I haven't encountered anything quite like this in
</I>&gt;<i> my adventures with PHP, perl, or other similar scripting languages
</I>&gt;<i> piloted by Apache.  It raises a valid concern to which I ideally
</I>&gt;<i> should have found answers very quickly.
</I>&gt;<i>
</I>&gt;<i> I hope this cures the subsequent issue given in the latter half of my message.
</I>
PHP is specifically designed for web applications and it purposely
throws away all code at the end of each request and thus is reloading
it all on every request. Have a read of:

  <A HREF="http://blog.ianbicking.org/2008/01/12/what-php-deployment-gets-right/">http://blog.ianbicking.org/2008/01/12/what-php-deployment-gets-right/</A>

I would be very surprised if mod_perl auto reloaded code as it is
similar to Python in that you are applying a non web language to the
web. Only way perl code would be reload is if you were running them as
CGI scripts. If you run Python as CGI scripts you will get reloading
as well, but as with anything CGI, much slower.

BTW, maybe read:

  <A HREF="http://blog.dscpl.com.au/2008/12/using-modwsgi-when-developing-django.html">http://blog.dscpl.com.au/2008/12/using-modwsgi-when-developing-django.html</A>

For WSGI hosted Python web application, this provides auto reloading
on code changes. You do need to use a real operating system though,
and not Windows.

Graham

&gt;<i> Tim
</I>&gt;<i>
</I>&gt;<i> On Sat, Jan 10, 2009 at 10:23 PM, Graham Dumpleton
</I>&gt;<i> &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">graham.dumpleton at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 2009/1/11 Tim Valenta &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">tonightslastsong at gmail.com</A>&gt;:
</I>&gt;&gt;<i> &gt; Hello all-- I've been experiencing a caching issue from the
</I>&gt;&gt;<i> &gt; very beginning of my use of mod_python...  It's been at least 2 months now,
</I>&gt;&gt;<i> &gt; and I keep running into actual issues that prevent me from coding.
</I>&gt;&gt;<i> &gt; I have a knack for over-explaining, so I'll try to keep this concise yet
</I>&gt;&gt;<i> &gt; descriptive.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Still not short enough, so much so I stopped part way through.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The simple matter of it is that mod_python does not do deep checking
</I>&gt;&gt;<i> of code for changes, nor does it automatically restart the process
</I>&gt;&gt;<i> when code is changed. Thus the need to restart Apache when you make
</I>&gt;&gt;<i> code changes to anything imported from sys.path is expected and normal
</I>&gt;&gt;<i> behaviour.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The only time any code is automatically reloaded is the direct code
</I>&gt;&gt;<i> files imported by mod_python using its own special module importer.
</I>&gt;&gt;<i> This is documented under 'import_module()' function in:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  <A HREF="http://www.modpython.org/live/current/doc-html/pyapi-apmeth.html">http://www.modpython.org/live/current/doc-html/pyapi-apmeth.html</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Graham
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &gt; I'm developing a site on my local machine, Windows Vista, using Apache 2.2.x
</I>&gt;&gt;<i> &gt; and mod_python 3.3.1 .  I'm a programmer for a living, and I'm not quick to
</I>&gt;&gt;<i> &gt; point the finger at the language, *but* (you knew that was coming, eh?) I
</I>&gt;&gt;<i> &gt; know my code isn't to blame for the issue:
</I>&gt;&gt;<i> &gt; I write some basic code for an 'index.py' file, using the
</I>&gt;&gt;<i> &gt; mod_python.publisher handler.  'index.py' includes other modules which I've
</I>&gt;&gt;<i> &gt; coded from that same location, etc, etc.  Nothing fancy.  Any changes I make
</I>&gt;&gt;<i> &gt; in the 'index.py' file will be reflected immediately on my local web server.
</I>&gt;&gt;<i> &gt;  On the other hand, any changes I make to the modules included via import
</I>&gt;&gt;<i> &gt; from within 'index.py' are completely ignored by the web server.  It took me
</I>&gt;&gt;<i> &gt; a while to realize that my pages didn't reflect my code.  I also discovered
</I>&gt;&gt;<i> &gt; that the .pyc files had nothing to do with it.  I finally just restarted the
</I>&gt;&gt;<i> &gt; apache web service (which in fact runs as a service on my machine), and then
</I>&gt;&gt;<i> &gt; my code finally gets pushed through to the web server.
</I>&gt;&gt;<i> &gt; I've been looking around practically every other day for documentation on
</I>&gt;&gt;<i> &gt; how to make apache/mod_python simply cut it out and stop caching my python
</I>&gt;&gt;<i> &gt; code, but I've found nothing.  You can imagine the annoyance this presents,
</I>&gt;&gt;<i> &gt; since I have to restart my web server every single time I make even the
</I>&gt;&gt;<i> &gt; slightest change to a 'utility.py' file, etc.
</I>&gt;&gt;<i> &gt; I've been coping with the problem for a while now, but then I've found far
</I>&gt;&gt;<i> &gt; more annoying issues recently.  To abbreviate the problem into short terms,
</I>&gt;&gt;<i> &gt; I've got a main module 'MAIN' which imports another module for a class
</I>&gt;&gt;<i> &gt; 'CLASS'.  CLASS also has a few imports, such as 'backend' stuff for
</I>&gt;&gt;<i> &gt; interfacing with various databases, etc.  We'll call the 'backend' module
</I>&gt;&gt;<i> &gt; &quot;BACKEND&quot;.  Given the setup, any changes I make to CLASS or BACKEND require
</I>&gt;&gt;<i> &gt; an apache restart in order to take effect.
</I>&gt;&gt;<i> &gt; I have a function in CLASS which calls a function from it's imported BACKEND
</I>&gt;&gt;<i> &gt; module.  I tried adding a parameter to the BACKEND function in question, and
</I>&gt;&gt;<i> &gt; properly passed said parameter while in CLASS, yet the mod_python debugger
</I>&gt;&gt;<i> &gt; spits out an error about me having passed 3 arguments, when the BACKEND
</I>&gt;&gt;<i> &gt; function takes exactly 2.  This is outright false, since my function in
</I>&gt;&gt;<i> &gt; BACKEND looks like:
</I>&gt;&gt;<i> &gt; def getUsers(self, req, terms):
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; and I'm calling it with
</I>&gt;&gt;<i> &gt; self.backend.getUsers(self.req, search)
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; In reality, my code dictates that I'm passing 3 (including the implicit
</I>&gt;&gt;<i> &gt; 'self' argument), and BACKEND's 'getUsers' does in fact take exactly 3
</I>&gt;&gt;<i> &gt; arguments.  Yet, the debugger is telling me that it takes only 2.
</I>&gt;&gt;<i> &gt; I was trying to pass it 'req' because I wanted to investigate a little error
</I>&gt;&gt;<i> &gt; in the code by printing something to the output HTML.  So, my attempt is
</I>&gt;&gt;<i> &gt; foiled, since somewhere something isn't being updated to what my most
</I>&gt;&gt;<i> &gt; current code actually says.
</I>&gt;&gt;<i> &gt; Just to test, I made the 'getUsers' function return immediately with a
</I>&gt;&gt;<i> &gt; string of gibberish, like 'return &quot;adsfasdfadsfa&quot;'.  this should make my
</I>&gt;&gt;<i> &gt; other code spin wildly out of control and encounter errors, yet when I
</I>&gt;&gt;<i> &gt; restart apache and test it... lo and behold, it's completely ignoring my
</I>&gt;&gt;<i> &gt; goofy 'return' statement.  The 'getUsers' function is still somehow
</I>&gt;&gt;<i> &gt; returning valid data, as if the 'return' wasn't there at all!
</I>&gt;&gt;<i> &gt; So then I tried causing actual syntax errors.  The debugger caught this,
</I>&gt;&gt;<i> &gt; much to my inner joy.  So I tried causing a semantic error instead:
</I>&gt;&gt;<i> &gt; referencing a non-existent attribute of a non-existent variable:
</I>&gt;&gt;<i> &gt; madeUpVar.moo = 42
</I>&gt;&gt;<i> &gt; Syntactically, nothing wrong, but at run time it should most definitely
</I>&gt;&gt;<i> &gt; encounter a NameError or something equally as realistic.  But I restart
</I>&gt;&gt;<i> &gt; apache, and... nothing.  The line is completely ignored.
</I>&gt;&gt;<i> &gt; Which leads me to believe that it's not actually being 'ignored' per se, but
</I>&gt;&gt;<i> &gt; rather the code being compiled is not the same as the code in play within
</I>&gt;&gt;<i> &gt; the web server.  When I delete my .pyc files and restart apache and visit
</I>&gt;&gt;<i> &gt; the URL that triggers my python code, my .py files are in fact being
</I>&gt;&gt;<i> &gt; recompiled down to their byte code .pyc files.  And clearly the interpreter
</I>&gt;&gt;<i> &gt; is processing my code, since it flags me on improper syntax.  Yet, no matter
</I>&gt;&gt;<i> &gt; what kind of syntactically-sound nonsense I put into my code, the changes
</I>&gt;&gt;<i> &gt; aren't being reflected in my web server.
</I>&gt;&gt;<i> &gt; These problems come and go, and I've go better explanation than over zealous
</I>&gt;&gt;<i> &gt; caching.  I imagine that by tomorrow sometime when I start my computer up,
</I>&gt;&gt;<i> &gt; the problem will have disappeared for the time being.
</I>&gt;&gt;<i> &gt; I've cursed this computer up and down as I've tried to figure out ANYTHING
</I>&gt;&gt;<i> &gt; that I can do to alleviate the issue, by to no avail.
</I>&gt;&gt;<i> &gt; Anybody with counsel to spare my tired brain is welcome to share...
</I>&gt;&gt;<i> &gt; _______________________________________________
</I>&gt;&gt;<i> &gt; Mod_python mailing list
</I>&gt;&gt;<i> &gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;&gt;<i> &gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;<i>
</I></PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025921.html">[mod_python] Caching issues
</A></li>
	<LI>Next message: <A HREF="025923.html">[mod_python] Caching issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25922">[ date ]</a>
              <a href="thread.html#25922">[ thread ]</a>
              <a href="subject.html#25922">[ subject ]</a>
              <a href="author.html#25922">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
