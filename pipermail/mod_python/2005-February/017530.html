<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Session example and problems.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Session%20example%20and%20problems.&In-Reply-To=ff8760080502261433141c7620%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017525.html">
   <LINK REL="Next"  HREF="017531.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Session example and problems.</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>donnie jones</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Session%20example%20and%20problems.&In-Reply-To=ff8760080502261433141c7620%40mail.gmail.com"
       TITLE="[mod_python] Session example and problems.">donniejones18 at gmail.com
       </A><BR>
    <I>Sun Feb 27 02:20:38 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="017525.html">[mod_python] Session Causes TypeError: unscriptable object
</A></li>
        <LI>Next message: <A HREF="017531.html">[mod_python] How to get path from URL
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17530">[ date ]</a>
              <a href="thread.html#17530">[ thread ]</a>
              <a href="subject.html#17530">[ subject ]</a>
              <a href="author.html#17530">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I am not understanding part of your explanation.
When I do the req.write of the sid, I can then pass it to the UseSession
function, and that UseSession now gets the correct session id.
I req.write the session id in the UseSession function and it is the
same as the session id from the GetSID function....

Are you saying that the session itself is lost without saving the sesion
id in the &lt;input hidden&gt;  ?  I am confused why passing the session id
to the Session(req, sid) shouldn't keep the same session...

Thanks.

__
Donnie


On Fri, 25 Feb 2005 16:31:43 -0500, Chris Jackson
&lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">christopher.jackson at gmail.com</A>&gt; wrote:
&gt;<i> This is not quite the same as in the example in the URL.
</I>&gt;<i>
</I>&gt;<i> The example in the URL passes the sessid to an &lt;input hidden...&gt; field
</I>&gt;<i> via PSP templates.  And when a function like (def UseSession) is
</I>&gt;<i> called, req.form['sessid'] stores the value from this hidden field.
</I>&gt;<i> That's how the sessid is passed.
</I>&gt;<i>
</I>&gt;<i> In your GetSid function, you simply say req.write, which doesn't
</I>&gt;<i> really do anything but display it, vs. &lt;input hidden...&gt; which
</I>&gt;<i> captures the sessid to be used later.  After GetSid ends, your session
</I>&gt;<i> id is lost.
</I>&gt;<i>
</I>&gt;<i> ~= Chris =~
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Fri, 25 Feb 2005 14:53:28 -0500, donnie jones
</I>&gt;<i> &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">donniejones18 at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt; def GetSid(req, sid=&quot;&quot;):
</I>&gt;<i> &gt;   sess = Session(req);
</I>&gt;<i> &gt;   if sess.is_new():
</I>&gt;<i> &gt;     sess['u']=&quot;user&quot;;
</I>&gt;<i> &gt;     sess['p']=&quot;password&quot;;
</I>&gt;<i> &gt;     sid = sess.id();
</I>&gt;<i> &gt;     sess.save;
</I>&gt;<i> &gt;   else:
</I>&gt;<i> &gt;     sid = sess.id();
</I>&gt;<i> &gt;   req.write(&quot;%s&quot; % sid);
</I>&gt;<i> &gt;   return;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; # list mailboxes
</I>&gt;<i> &gt; def UseSession(req, sid=&quot;&quot;):
</I>&gt;<i> &gt;   req.write(&quot;%s&quot; % sid);
</I>&gt;<i> &gt;   sess = Session(req, sid, None, 1800, 0);
</I>&gt;<i> &gt;   if sess.is_new():
</I>&gt;<i> &gt;     req.write(&quot;&lt;br/&gt;session new&lt;br/&gt;&quot;);
</I>&gt;<i> &gt;     sid = sess.id();
</I>&gt;<i> &gt;   else:
</I>&gt;<i> &gt;     sess.load();
</I>&gt;<i> &gt;   req.write(&quot;%s&quot; % sid);
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I first call the GetSid from my javascript and I am using
</I>&gt;<i> &gt; XmlHttpRequest that gets the sid from the responseText.
</I>&gt;<i> &gt; Then I call UseSession function with the sid passed to it
</I>&gt;<i> &gt; through the javascript, and I print the sid to make sure the
</I>&gt;<i> &gt; correct id was passed and that works, but after the Session()
</I>&gt;<i> &gt; is ran it always creates a new session,
</I>&gt;<i> &gt; I am not sure why... I used this link
</I>&gt;<i> &gt; <A HREF="http://www.modpython.org/pipermail/mod_python/2005-January/017111.html">http://www.modpython.org/pipermail/mod_python/2005-January/017111.html</A>
</I>&gt;<i> &gt; as an example to follow...
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Any ideas?
</I>&gt;<i> &gt; Thanks.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; __
</I>&gt;<i> &gt; Donnie
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; On Thu, 24 Feb 2005 15:36:43 -0600, Shawn Harrison &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">harrison at tbc.net</A>&gt; wrote:
</I>&gt;<i> &gt; &gt; donnie jones wrote [02/24/05 2:55 PM]:
</I>&gt;<i> &gt; &gt; &gt; Hello,
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; Could someone please give me an example of using the Session()
</I>&gt;<i> &gt; &gt; &gt; in modpython for passing data between functions?
</I>&gt;<i> &gt; &gt; &gt; I have been googling, but with no success..
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; The problem I am having is that each time I reload a page that calls
</I>&gt;<i> &gt; &gt; &gt; the function like below, it creates a new session.
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; def test(req):
</I>&gt;<i> &gt; &gt; &gt;   sess = Sess(req);
</I>&gt;<i> &gt; &gt; &gt;   sid = sess.id();
</I>&gt;<i> &gt; &gt; &gt;   if sess.is_new():
</I>&gt;<i> &gt; &gt; &gt;     req.write(&quot;new session %s&quot; % sid);
</I>&gt;<i> &gt; &gt; &gt;   else:
</I>&gt;<i> &gt; &gt; &gt;     sess.load();
</I>&gt;<i> &gt; &gt; &gt;     req.write(&quot;%s&quot; % sess['username']);
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; I am printing the session id and each time the function is loaded
</I>&gt;<i> &gt; &gt; &gt; I get a new session id, thus I cannot store data in the session
</I>&gt;<i> &gt; &gt; &gt; to use in other functions...
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; class BaseSession(req[, sid, secret, timeout, lock, lockfile])
</I>&gt;<i> &gt; &gt; ..
</I>&gt;<i> &gt; &gt;      save()
</I>&gt;<i> &gt; &gt;          This method writes session values to storage.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; It doesn't appear that you are doing this. It only writes the data when
</I>&gt;<i> &gt; &gt; you tell it to.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Shawn Harrison
</I>&gt;<i> &gt; &gt; _______________________________________________
</I>&gt;<i> &gt; &gt; Mod_python mailing list
</I>&gt;<i> &gt; &gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> &gt; &gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Mod_python mailing list
</I>&gt;<i> &gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> &gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I></PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017525.html">[mod_python] Session Causes TypeError: unscriptable object
</A></li>
	<LI>Next message: <A HREF="017531.html">[mod_python] How to get path from URL
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17530">[ date ]</a>
              <a href="thread.html#17530">[ thread ]</a>
              <a href="subject.html#17530">[ subject ]</a>
              <a href="author.html#17530">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
