<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Session Causes TypeError: unscriptable object
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Session%20Causes%20TypeError%3A%20unscriptable%20object&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017529.html">
   <LINK REL="Next"  HREF="017530.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Session Causes TypeError: unscriptable object</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Marvin Addison</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Session%20Causes%20TypeError%3A%20unscriptable%20object&In-Reply-To="
       TITLE="[mod_python] Session Causes TypeError: unscriptable object">marvin.addison at sfacademy.org
       </A><BR>
    <I>Fri Feb 25 17:10:32 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="017529.html">[mod_python] newb question on apache conf
</A></li>
        <LI>Next message: <A HREF="017530.html">[mod_python] Session example and problems.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17525">[ date ]</a>
              <a href="thread.html#17525">[ thread ]</a>
              <a href="subject.html#17525">[ subject ]</a>
              <a href="author.html#17525">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>We are getting the following error when attempting to use the mod_python Session object:

  File &quot;C:\Python23\Lib\site-packages\mod_python\apache.py&quot;, line 299, in HandlerDispatch
    result = object(req)
  File &quot;C:\Python23\Lib\site-packages\mod_python\publisher.py&quot;, line 136, in handler
    result = util.apply_fs_data(object, req.form, req=req)
  File &quot;C:\Python23\Lib\site-packages\mod_python\util.py&quot;, line 361, in apply_fs_data
    return object(**args)
  File &quot;C:/Develop/Websites/intranet.sfaadmin.org/www/reports\gpa-cum.py&quot;, line 205, in print_gpa
    session = Session.Session(req)
  File &quot;C:\Python23\lib\site-packages\mod_python\Session.py&quot;, line 386, in Session
    timeout=timeout, lock=lock)
  File &quot;C:\Python23\lib\site-packages\mod_python\Session.py&quot;, line 358, in __init__
    timeout=timeout, lock=lock)
  File &quot;C:\Python23\lib\site-packages\mod_python\Session.py&quot;, line 132, in __init__
    Cookie.add_cookie(self._req, self.make_cookie())
  File &quot;C:\Python23\lib\site-packages\mod_python\Session.py&quot;, line 160, in make_cookie
    c.path = dirpath[len(docroot):]
TypeError: unsubscriptable object

This is problem appears very similar to another post, <A HREF="http://modpython.org/pipermail/mod_python/2004-May/015705.html.">http://modpython.org/pipermail/mod_python/2004-May/015705.html.</A>  Unfortunately, there was no response to the problem on this thread.

Some additional information that might help someone help me:
 - The codebase on which I am encountering an error worked fine on Apache 2.0.52 when run the Apache process ran as LOCALSYSTEM on W2K3.  Running it as a normal user account on Apache 2.0.53 produces this error.  Smells like a permissions problem.
 - Changing line 160 of Session.py to the following works like a charm, including performing post backs that load and modify the session data we stored previously:
c.path = '/'.
 - The real problem with line 160 in Session.py is that the value of the dirpath variable appears to be None (confirmed through testing).  The dirpath variable is set on the previous line with the statement:
dirpath = self._req.hlist.directory
Apparently, the directory property of Request.hlist is None which sets dirpath to None as well causing line 160 to fail with TypeError: unsubscriptable object.

Any help or direction on this issue is greatly appreciated.

Marvin

</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017529.html">[mod_python] newb question on apache conf
</A></li>
	<LI>Next message: <A HREF="017530.html">[mod_python] Session example and problems.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17525">[ date ]</a>
              <a href="thread.html#17525">[ thread ]</a>
              <a href="subject.html#17525">[ subject ]</a>
              <a href="author.html#17525">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
