<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] trying to upgrade to Python2.4, Apache2.0.53,
	Mod_Python3.1.4 on Mac OsX
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20trying%20to%20upgrade%20to%20Python2.4%2C%20Apache2.0.53%2C%0A%09Mod_Python3.1.4%20on%20Mac%20OsX&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017446.html">
   <LINK REL="Next"  HREF="017449.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] trying to upgrade to Python2.4, Apache2.0.53,
	Mod_Python3.1.4 on Mac OsX</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20trying%20to%20upgrade%20to%20Python2.4%2C%20Apache2.0.53%2C%0A%09Mod_Python3.1.4%20on%20Mac%20OsX&In-Reply-To="
       TITLE="[mod_python] trying to upgrade to Python2.4, Apache2.0.53,
	Mod_Python3.1.4 on Mac OsX">grahamd at dscpl.com.au
       </A><BR>
    <I>Tue Feb 15 20:06:14 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="017446.html">[mod_python] trying to upgrade to Python2.4, Apache2.0.53,
	Mod_Python3.1.4 on Mac OsX
</A></li>
        <LI>Next message: <A HREF="017449.html">[mod_python] trying to upgrade to Python2.4, Apache2.0.53,
	Mod_Python3.1.4 on Mac OsX
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17447">[ date ]</a>
              <a href="thread.html#17447">[ thread ]</a>
              <a href="subject.html#17447">[ subject ]</a>
              <a href="author.html#17447">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The problem is that the libpython2.4.a is a static library and there
is not a dynamically loadable library. See following comment from the
mod_python README file:

  3. On Darwin, libpython cannot be linked statically with mod_python
  using libtool. libpython has to be a dynamic shared object. The Python
  distribution does not provide a way of building libpython as a shared
  library, but the Fink Python distribution comes with one
  (/sw/lib/python2.2/config/libpython2.2.dylib), so the easiest thing is
  to install Python from Fink (fink.sourceforge.net).

I would assume the same comment applies if building your own version
of Python on full MacOSX and where a framework install wasn't done.

Normally with a framework install, the dynamically loadable version is
installed under the framework package as:

  /System/Library/Frameworks/Python.framework/Versions/2.3/Python
 
If you run &quot;otool -L&quot; on your old mod_python.so which used standard
Python version, that is what you should have seen.

Your options thus seem to be:

1. Use standard Python 2.3 shipped with MacOSX.

2. Use Python 2.4 provided with &quot;fink&quot; packages.

3. Install Python 2.4 as a framework but make sure you install it
such that you don't overwrite the standard Python installation.

The safest and quickest thing to do is use Python 2.3 shipped with
the box. Using fink means a lot of crap get installed on your box
that you might not want. Installing Python 2.4 runs the risk of
trashing your system version of Python if you do the wrong thing.

Graham

John Raines wrote ..
&gt;<i> The libraries certainly seem to be there:
</I>&gt;<i> 
</I>&gt;<i> jraines-Computer:/usr/local jrraines$ ls lib/python2.4/config
</I>&gt;<i> Makefile        Setup           Setup.config    Setup.local     
</I>&gt;<i> config.c        config.c.in     install-sh      libpython2.4.a  
</I>&gt;<i> makesetup       python.o
</I>&gt;<i> jraines-Computer:/usr/local jrraines$ ls 
</I>&gt;<i> lib/python2.4/site-packages/mod_python
</I>&gt;<i> Cookie.py       Session.py      __init__.py     _psp.so         
</I>&gt;<i> apache.pyo      cgihandler.pyo  psp.pyo         publisher.pyo   
</I>&gt;<i> util.pyo
</I>&gt;<i> Cookie.pyc      Session.pyc     __init__.pyc    apache.py       
</I>&gt;<i> cgihandler.py   psp.py          publisher.py    util.py
</I>&gt;<i> Cookie.pyo      Session.pyo     __init__.pyo    apache.pyc      
</I>&gt;<i> cgihandler.pyc  psp.pyc         publisher.pyc   util.pyc
</I>&gt;<i> 
</I>&gt;<i> jraines-Computer:/usr/local jrraines$ ls
</I>&gt;<i> apache2 bin     include lib     man     share
</I>&gt;<i> 
</I>&gt;<i> jraines-Computer:/usr/local jrraines$ ls bin
</I>&gt;<i> AlchemyTVSetTuner       pcpmac                  pmvmac                
</I>&gt;<i> psync                   python2.4
</I>&gt;<i> idle                    pgetfinfo               psetfinfo             
</I>&gt;<i> pydoc                   smtpd.py
</I>&gt;<i> 
</I>&gt;<i> jraines-Computer:/usr/local jrraines$ ls lib/python2.4/lib-dynload
</I>&gt;<i> ColorPicker.so          _Evt.so                 _Qt.so                
</I>&gt;<i> _csv.so                 audioop.so              gestalt.so            
</I>&gt;<i> regex.so
</I>&gt;<i> MacOS.so                _File.so                _Res.so               
</I>&gt;<i> _curses.so              autoGIL.so              grp.so                
</I>&gt;<i> resource.so
</I>&gt;<i> Nav.so                  _Fm.so                  _Scrap.so             
</I>&gt;<i> _curses_panel.so        binascii.so             icglue.so             
</I>&gt;<i> rgbimg.so
</I>&gt;<i> OSATerminology.so       _Folder.so              _Snd.so               
</I>&gt;<i> _heapq.so               bsddb185.so             imageop.so            
</I>&gt;<i> select.so
</I>&gt;<i> _AE.so                  _Help.so                _TE.so                
</I>&gt;<i> _hotshot.so             bz2.so                  itertools.so          
</I>&gt;<i> sha.so
</I>&gt;<i> _AH.so                  _IBCarbon.so            _Win.so               
</I>&gt;<i> _locale.so              cPickle.so              math.so               
</I>&gt;<i> strop.so
</I>&gt;<i> _App.so                 _Icn.so                 _bisect.so            
</I>&gt;<i> _multibytecodec.so      cStringIO.so            md5.so                
</I>&gt;<i> struct.so
</I>&gt;<i> _CF.so                  _Launch.so              _bsddb.so             
</I>&gt;<i> _random.so              cmath.so                mmap.so               
</I>&gt;<i> syslog.so
</I>&gt;<i> _CG.so                  _List.so                _codecs_cn.so         
</I>&gt;<i> _socket.so              collections.so          nis.so                
</I>&gt;<i> termios.so
</I>&gt;<i> _CarbonEvt.so           _Menu.so                _codecs_hk.so         
</I>&gt;<i> _ssl.so                 crypt.so                operator.so           
</I>&gt;<i> time.so
</I>&gt;<i> _Cm.so                  _Mlte.so                _codecs_iso2022.so    
</I>&gt;<i> _testcapi.so            datetime.so             parser.so             
</I>&gt;<i> timing.so
</I>&gt;<i> _Ctl.so                 _OSA.so                 _codecs_jp.so         
</I>&gt;<i> _tkinter.so             dbm.so                  pwd.so                
</I>&gt;<i> unicodedata.so
</I>&gt;<i> _Dlg.so                 _Qd.so                  _codecs_kr.so         
</I>&gt;<i> _weakref.so             fcntl.so                pyexpat.so            
</I>&gt;<i> zlib.so
</I>&gt;<i> _Drag.so                _Qdoffs.so              _codecs_tw.so         
</I>&gt;<i> array.so                gdbm.so                 readline.so
</I>&gt;<i> 
</I>&gt;<i> I thought linking Mod_Python to the Python 2.4 code was taken care of 
</I>&gt;<i> by the &quot;--with-python=/usr/local/bin/python2.4&quot; ? It seems to have 
</I>&gt;<i> gotten the site-packages directory put into the right location.
</I>&gt;<i> 
</I>&gt;<i> On Feb 15, 2005, at 5:50 PM, Graham Dumpleton wrote:
</I>&gt;<i> 
</I>&gt;<i> &gt; If you really want to use Python 2.4, you are going to have to somehow
</I>&gt;<i> &gt; force a reference to the Python library in mod_python.so. Since you 
</I>&gt;<i> &gt; aren't
</I>&gt;<i> &gt; using a framework install, not sure what the library is you have to 
</I>&gt;<i> &gt; force
</I>&gt;<i> &gt; link with. You might want to look for Python related libraries in such
</I>&gt;<i> &gt; directories as:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;   /usr/local/lib
</I>&gt;<i> &gt;   /usr/local/lib/python2.4/config
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; BTW, is there anything you really want in Python 2.4? Especially if 
</I>&gt;<i> &gt; you are
</I>&gt;<i> &gt; a UNIX novice, trying to host two different versions of Python on 
</I>&gt;<i> &gt; MacOSX
</I>&gt;<i> &gt; can be a problem. I guess at least you didn't use a framework install
</I>&gt;<i> &gt; and
</I>&gt;<i> &gt; do it on top of the system supplied version of Python. Doing that can
</I>&gt;<i> &gt; really screw things up bad.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; The only catch on using standard MacOSX Python installation is that you
</I>&gt;<i> &gt; need to patch src/mod_python.c file in source to workaround a problem
</I>&gt;<i> &gt; with it. Use of &quot;worker&quot; may also trigger some other mod_python bugs.
</I>&gt;<i> &gt; Fixes for both are detailed in:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;   <A HREF="http://www.dscpl.com.au/projects/vampire/PATCHES">http://www.dscpl.com.au/projects/vampire/PATCHES</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Graham
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; John Raines wrote ..
</I>&gt;<i> &gt;&gt; My website had been stable and running without error but I'd been
</I>&gt;<i> &gt;&gt; running on 2.3.3, 2.0.52 and 3.1.3; since everything was behind the
</I>&gt;<i> &gt;&gt; times I decided to finally reinstall; I made the mistake of doing it
</I>&gt;<i> &gt;&gt; on
</I>&gt;<i> &gt;&gt; the drive that everything was being served off of instead of using my
</I>&gt;<i> &gt;&gt; backup drive. :-(
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; I installed python 2.4 and it seems to work when I call it from the
</I>&gt;<i> &gt;&gt; shell. I did not do a frameworkInstall, which seems to be recommended
</I>&gt;<i> &gt;&gt; by some people. I am too much of a unix novice to understand what the
</I>&gt;<i> &gt;&gt; implications of frameworkInstall are. I installed apache and 
</I>&gt;<i> &gt;&gt; mod_python
</I>&gt;<i> &gt;&gt; as follows:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; cd ~/Desktop/httpd-2.0.53
</I>&gt;<i> &gt;&gt; ./configure --enable-so --with-mpm=worker
</I>&gt;<i> &gt;&gt; make
</I>&gt;<i> &gt;&gt; sudo make install
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; cd ~/Desktop/mod_python-3.1.4
</I>&gt;<i> &gt;&gt; ./configure --with apxs=/usr/local/apache2/bin/apxs
</I>&gt;<i> &gt;&gt; --with-python=/usr/local/bin/python2.4
</I>&gt;<i> &gt;&gt; make
</I>&gt;<i> &gt;&gt; sudo make install
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; I restored my old httpd.conf file and my website files. My index.html
</I>&gt;<i> &gt;&gt; file is straight html which links to .py files. As soon as I try to
</I>&gt;<i> &gt;&gt; access any of the .py stuff I now get an internal server error message
</I>&gt;<i> &gt;&gt; and the server log shows this:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; [Tue Feb 15 16:25:25 2005] [notice] mod_python: Creating 32 session
</I>&gt;<i> &gt;&gt; mutexes based on 6 max processes and 25 max threads.
</I>&gt;<i> &gt;&gt; [Tue Feb 15 16:25:25 2005] [notice] Apache configured -- resuming
</I>&gt;<i> &gt;&gt; normal operations
</I>&gt;<i> &gt;&gt; [Tue Feb 15 16:25:36 2005] [error] make_obcallback: could not import
</I>&gt;<i> &gt;&gt; mod_python.apache.\n
</I>&gt;<i> &gt;&gt; Traceback (most recent call last):
</I>&gt;<i> &gt;&gt;    File &quot;/usr/local/lib/python2.4/site-packages/mod_python/apache.py&quot;,
</I>&gt;<i> &gt;&gt; line 22, in ?
</I>&gt;<i> &gt;&gt;      import time
</I>&gt;<i> &gt;&gt; ImportError: Failure linking new module: : dyld:
</I>&gt;<i> &gt;&gt; /usr/local/apache2/bin/httpd Undefined symbols:
</I>&gt;<i> &gt;&gt; /usr/local/lib/python2.4/lib-dynload/time.so undefined reference to
</I>&gt;<i> &gt;&gt; _PyArg_Parse expected to be defined in the executable
</I>&gt;<i> &gt;&gt; /usr/local/lib/python2.4/lib-dynload/time.so undefined reference to
</I>&gt;<i> &gt;&gt; _PyArg_ParseTuple expected to be defined in the executable
</I>&gt;<i> &gt;&gt; /usr/local/lib/python2.4/lib-dynload/time.so undefined reference to
</I>&gt;<i> &gt;&gt; _PyDict_GetItemString expected to be defined in the executable
</I>&gt;<i> &gt;&gt; /usr/local/lib/python2.4/lib-dynload/time.so un
</I>&gt;<i> &gt;&gt;                                                               &lt;--what
</I>&gt;<i> &gt;&gt; happened here??
</I>&gt;<i> &gt;&gt; [Tue Feb 15 16:25:36 2005] [error] make_obcallback: could not import
</I>&gt;<i> &gt;&gt; mod_python.apache.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; for what its worth I can access various parts of the time module when
</I>&gt;<i> &gt;&gt; I
</I>&gt;<i> &gt;&gt; run Python2.4 from the shell.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Going back through the the mailing list I saw that Graham Dumpleton
</I>&gt;<i> &gt;&gt; (back on Dec 23) suggested the output from this might be useful; what
</I>&gt;<i> &gt;&gt; I
</I>&gt;<i> &gt;&gt; get is different from what he saw but I'm not sure what to make of my
</I>&gt;<i> &gt;&gt; result:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; jraines-Computer:~/Desktop/Website jrraines$ otool otool -L
</I>&gt;<i> &gt;&gt; /usr/local/apache2/modules/mod_python.so
</I>&gt;<i> &gt;&gt; otool: can't open file: otool (No such file or directory)
</I>&gt;<i> &gt;&gt; /usr/local/apache2/modules/mod_python.so:
</I>&gt;<i> &gt;&gt;          /usr/lib/libSystem.B.dylib (compatibility version 1.0.0,
</I>&gt;<i> &gt;&gt; current version 71.1.1)
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; jraines-Computer:~/Desktop/Website jrraines$ ls
</I>&gt;<i> &gt;&gt; /usr/local/apache2/modules
</I>&gt;<i> &gt;&gt; httpd.exp       mod_python.so
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; My problem seemed like it might be similar to a thread titled Weird
</I>&gt;<i> &gt;&gt; ob_callback problems at the end of Jan. I tried the suggestions Grisha
</I>&gt;<i> &gt;&gt; made:Try defining DYLD_FORCE_FLAT_NAMESPACE=1 environment variable
</I>&gt;<i> &gt;&gt; before launching httpd.
</I>&gt;<i> &gt;&gt; That didn't help either.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; _______________________________________________
</I>&gt;<i> &gt;&gt; Mod_python mailing list
</I>&gt;<i> &gt;&gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> &gt;&gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i> &gt;
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I></PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017446.html">[mod_python] trying to upgrade to Python2.4, Apache2.0.53,
	Mod_Python3.1.4 on Mac OsX
</A></li>
	<LI>Next message: <A HREF="017449.html">[mod_python] trying to upgrade to Python2.4, Apache2.0.53,
	Mod_Python3.1.4 on Mac OsX
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17447">[ date ]</a>
              <a href="thread.html#17447">[ thread ]</a>
              <a href="subject.html#17447">[ subject ]</a>
              <a href="author.html#17447">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
