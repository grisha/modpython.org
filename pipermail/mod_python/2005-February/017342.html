<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Custom handler thread safety
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Custom%20handler%20thread%20safety&In-Reply-To=1107477875.15029%40dscpl.user.openhosting.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017329.html">
   <LINK REL="Next"  HREF="017348.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Custom handler thread safety</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Huzaifa Tapal</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Custom%20handler%20thread%20safety&In-Reply-To=1107477875.15029%40dscpl.user.openhosting.com"
       TITLE="[mod_python] Custom handler thread safety">huzaifa at hostway.com
       </A><BR>
    <I>Fri Feb  4 14:56:42 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="017329.html">[mod_python] Custom handler thread safety
</A></li>
        <LI>Next message: <A HREF="017348.html">[mod_python] Custom handler thread safety
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17342">[ date ]</a>
              <a href="thread.html#17342">[ thread ]</a>
              <a href="subject.html#17342">[ subject ]</a>
              <a href="author.html#17342">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Graham,

Below are the Y/N answers to your questions:

&gt;<i> What you need to do will depend on a few things.
</I>&gt;<i> 
</I>&gt;<i> Is the Python database connection object internally thread safe?
</I>
-- not its not.

&gt;<i> 
</I>&gt;<i> For a particular request, does it only need to use the database
</I>&gt;<i> connection once, or does it need to perform multiple actions
</I>&gt;<i> against the database of which all together she be performed
</I>&gt;<i> atomically?
</I>
-- the way it currently works is that we have a Data Access Layer that keeps
track of all the resources any of its components needs, including database
connections to various databases as those database connections are
requested.  So to answer your question, during the life of a request, a
database connection to a particular database can be used multiple times in
different modules, and all of those modules get the handle on that
connection by asking the data access layer's resource module.  

&gt;<i> 
</I>&gt;<i> Are the results of any database query being cached within your
</I>&gt;<i> shared data area?
</I>
-- no results from the db gets cached

&gt;<i> 
</I>&gt;<i> Do you have PythonAutoReload set to &quot;On&quot; and relying on that
</I>&gt;<i> working for the module which holds your database connection
</I>&gt;<i> and shared data.
</I>
-- PythonAutoReload is &quot;On&quot;, however, I am not using _apache.import_module
to import the module the data access layer's resource module.

&gt;<i> 
</I>&gt;<i> Try and give at least a Y/N answer for each.
</I>&gt;<i> 
</I>&gt;<i> In brief though, if the database connection object is in itself thread
</I>&gt;<i> safe, and that for a request only one database query/update is being
</I>&gt;<i> done and nothing is being cached resulting from that, you may well
</I>&gt;<i> not have to provide your own thread locks.
</I>&gt;<i> 
</I>&gt;<i> If this isn't the case, you may have to lock your shared data and
</I>&gt;<i> database connection with a single lock, while you possibly make
</I>&gt;<i> multiple queries/updates and save the result in your shared data
</I>&gt;<i> area. If you don't lock at a high enough level, classic problems of
</I>&gt;<i> another threading changing the database under you, or messing with
</I>&gt;<i> your shared data can happen.
</I>&gt;<i> 
</I>&gt;<i> I ask about the PythonAutoReload as there are lots of problems there
</I>&gt;<i> that most people don't seem to understand or appreciate. Thus, if you
</I>&gt;<i> are using apache.import_module() to load in your module containing
</I>&gt;<i> the database connections and shared data, indicate as much and I
</I>&gt;<i> can explain some of the problems there.
</I>&gt;<i> 
</I>&gt;<i> Graham
</I>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017329.html">[mod_python] Custom handler thread safety
</A></li>
	<LI>Next message: <A HREF="017348.html">[mod_python] Custom handler thread safety
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17342">[ date ]</a>
              <a href="thread.html#17342">[ thread ]</a>
              <a href="subject.html#17342">[ subject ]</a>
              <a href="author.html#17342">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
