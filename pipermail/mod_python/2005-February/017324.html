<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Custom handler thread safety
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Custom%20handler%20thread%20safety&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017315.html">
   <LINK REL="Next"  HREF="017325.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Custom handler thread safety</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Huzaifa Tapal</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Custom%20handler%20thread%20safety&In-Reply-To="
       TITLE="[mod_python] Custom handler thread safety">huzaifa at hostway.com
       </A><BR>
    <I>Thu Feb  3 16:54:31 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="017315.html">[mod_python] Force reload?
</A></li>
        <LI>Next message: <A HREF="017325.html">[mod_python] Force reload?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17324">[ date ]</a>
              <a href="thread.html#17324">[ thread ]</a>
              <a href="subject.html#17324">[ subject ]</a>
              <a href="author.html#17324">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello All,

 

I wrote a custom mod_python handler that kind of mimicks the cgihandler but
really is an extension to a web framework we have in house.  Just to be
safe, I implemented thread locking into the handler before any request is
processed.  The application is running on a debian box running Apache 2
multithreaded with mod_python 3.13.  We are gaining huge performance
increases by caching our template objects and db connection objects.

 

The problem I am running into is that if I run through the application, each
request takes on average 300 ms to process.  However, when we benchmark with
20 concurrent users, the average goes up to around 2200 ms.  I am very sure
that this is due to a thread locking shared objects in memory which results
in another thread waiting for the lock to be released.

 

If I take the thread locking mechanism out then we run into problems with
there being too many connections being made to the MySQL db if the cached
connection is being used and then the db starts dropping connections.

 

Any help would be much appreciated.  Even if there are any other good
handlers out there other than cgihandler and publisher.

 

Hozi

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20050203/714c4f21/attachment.html">http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20050203/714c4f21/attachment.html</A>
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017315.html">[mod_python] Force reload?
</A></li>
	<LI>Next message: <A HREF="017325.html">[mod_python] Force reload?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17324">[ date ]</a>
              <a href="thread.html#17324">[ thread ]</a>
              <a href="subject.html#17324">[ subject ]</a>
              <a href="author.html#17324">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
