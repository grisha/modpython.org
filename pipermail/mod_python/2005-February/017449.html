<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] trying to upgrade to Python2.4, Apache2.0.53,
	Mod_Python3.1.4 on Mac OsX
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20trying%20to%20upgrade%20to%20Python2.4%2C%20Apache2.0.53%2C%0A%09Mod_Python3.1.4%20on%20Mac%20OsX&In-Reply-To=1108515974.10105%40dscpl.user.openhosting.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017447.html">
   <LINK REL="Next"  HREF="017450.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] trying to upgrade to Python2.4, Apache2.0.53,
	Mod_Python3.1.4 on Mac OsX</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Ron Reisor</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20trying%20to%20upgrade%20to%20Python2.4%2C%20Apache2.0.53%2C%0A%09Mod_Python3.1.4%20on%20Mac%20OsX&In-Reply-To=1108515974.10105%40dscpl.user.openhosting.com"
       TITLE="[mod_python] trying to upgrade to Python2.4, Apache2.0.53,
	Mod_Python3.1.4 on Mac OsX">ron at udel.edu
       </A><BR>
    <I>Wed Feb 16 09:06:05 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="017447.html">[mod_python] trying to upgrade to Python2.4, Apache2.0.53,
	Mod_Python3.1.4 on Mac OsX
</A></li>
        <LI>Next message: <A HREF="017450.html">[mod_python] DbmSession with gdbm
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17449">[ date ]</a>
              <a href="thread.html#17449">[ thread ]</a>
              <a href="subject.html#17449">[ subject ]</a>
              <a href="author.html#17449">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The python that comes with MacOSX, currently 10.3.8, is /usr/bin/python 
and it appears to be 2.3.  Not 2.3.4 or 2.3.5, but 2.3.

The Apple built framework for this python is in /System/Library/Frameworks 
and this is where the shared libraries and other things, includeing the 
site-packages directory that works with this version of python. 
/usr/bin/python gets you all of this and the pieces all fit together.

If you build Python-2.4 using ./configure --enable-framework, it will 
build into /usr/local/bin/python and ignore the Apple built python 
libraries.

The default place for the framework will be /Library/Frameworks which is 
where user added frameworks go. Apple does put some of there own software 
there, like Compressor and Motion, but these are libraries not used by the 
System.  If you build your own python framework, it'll be in 
/Library/Frameworks and not clash with the /System/Library/Frameworks 
version.

The framework build works well, fits in best with Apple's dyld which is 
best in tune with these fancy dynamic libraries, and the Python developers 
support it well.

cheers,

Ron


On Tue, 15 Feb 2005, Graham Dumpleton wrote:

&gt;<i> The problem is that the libpython2.4.a is a static library and there
</I>&gt;<i> is not a dynamically loadable library. See following comment from the
</I>&gt;<i> mod_python README file:
</I>&gt;<i>
</I>&gt;<i>  3. On Darwin, libpython cannot be linked statically with mod_python
</I>&gt;<i>  using libtool. libpython has to be a dynamic shared object. The Python
</I>&gt;<i>  distribution does not provide a way of building libpython as a shared
</I>&gt;<i>  library, but the Fink Python distribution comes with one
</I>&gt;<i>  (/sw/lib/python2.2/config/libpython2.2.dylib), so the easiest thing is
</I>&gt;<i>  to install Python from Fink (fink.sourceforge.net).
</I>&gt;<i>
</I>&gt;<i> I would assume the same comment applies if building your own version
</I>&gt;<i> of Python on full MacOSX and where a framework install wasn't done.
</I>&gt;<i>
</I>&gt;<i> Normally with a framework install, the dynamically loadable version is
</I>&gt;<i> installed under the framework package as:
</I>&gt;<i>
</I>&gt;<i>  /System/Library/Frameworks/Python.framework/Versions/2.3/Python
</I>&gt;<i>
</I>&gt;<i> If you run &quot;otool -L&quot; on your old mod_python.so which used standard
</I>&gt;<i> Python version, that is what you should have seen.
</I>&gt;<i>
</I>&gt;<i> Your options thus seem to be:
</I>&gt;<i>
</I>&gt;<i> 1. Use standard Python 2.3 shipped with MacOSX.
</I>&gt;<i>
</I>&gt;<i> 2. Use Python 2.4 provided with &quot;fink&quot; packages.
</I>&gt;<i>
</I>&gt;<i> 3. Install Python 2.4 as a framework but make sure you install it
</I>&gt;<i> such that you don't overwrite the standard Python installation.
</I>&gt;<i>
</I>&gt;<i> The safest and quickest thing to do is use Python 2.3 shipped with
</I>&gt;<i> the box. Using fink means a lot of crap get installed on your box
</I>&gt;<i> that you might not want. Installing Python 2.4 runs the risk of
</I>&gt;<i> trashing your system version of Python if you do the wrong thing.
</I>&gt;<i>
</I>&gt;<i> Graham
</I>&gt;<i>
</I>&gt;<i> John Raines wrote ..
</I>&gt;&gt;<i> The libraries certainly seem to be there:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> jraines-Computer:/usr/local jrraines$ ls lib/python2.4/config
</I>&gt;&gt;<i> Makefile        Setup           Setup.config    Setup.local
</I>&gt;&gt;<i> config.c        config.c.in     install-sh      libpython2.4.a
</I>&gt;&gt;<i> makesetup       python.o
</I>&gt;&gt;<i> jraines-Computer:/usr/local jrraines$ ls
</I>&gt;&gt;<i> lib/python2.4/site-packages/mod_python
</I>&gt;&gt;<i> Cookie.py       Session.py      __init__.py     _psp.so
</I>&gt;&gt;<i> apache.pyo      cgihandler.pyo  psp.pyo         publisher.pyo
</I>&gt;&gt;<i> util.pyo
</I>&gt;&gt;<i> Cookie.pyc      Session.pyc     __init__.pyc    apache.py
</I>&gt;&gt;<i> cgihandler.py   psp.py          publisher.py    util.py
</I>&gt;&gt;<i> Cookie.pyo      Session.pyo     __init__.pyo    apache.pyc
</I>&gt;&gt;<i> cgihandler.pyc  psp.pyc         publisher.pyc   util.pyc
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> jraines-Computer:/usr/local jrraines$ ls
</I>&gt;&gt;<i> apache2 bin     include lib     man     share
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> jraines-Computer:/usr/local jrraines$ ls bin
</I>&gt;&gt;<i> AlchemyTVSetTuner       pcpmac                  pmvmac
</I>&gt;&gt;<i> psync                   python2.4
</I>&gt;&gt;<i> idle                    pgetfinfo               psetfinfo
</I>&gt;&gt;<i> pydoc                   smtpd.py
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> jraines-Computer:/usr/local jrraines$ ls lib/python2.4/lib-dynload
</I>&gt;&gt;<i> ColorPicker.so          _Evt.so                 _Qt.so
</I>&gt;&gt;<i> _csv.so                 audioop.so              gestalt.so
</I>&gt;&gt;<i> regex.so
</I>&gt;&gt;<i> MacOS.so                _File.so                _Res.so
</I>&gt;&gt;<i> _curses.so              autoGIL.so              grp.so
</I>&gt;&gt;<i> resource.so
</I>&gt;&gt;<i> Nav.so                  _Fm.so                  _Scrap.so
</I>&gt;&gt;<i> _curses_panel.so        binascii.so             icglue.so
</I>&gt;&gt;<i> rgbimg.so
</I>&gt;&gt;<i> OSATerminology.so       _Folder.so              _Snd.so
</I>&gt;&gt;<i> _heapq.so               bsddb185.so             imageop.so
</I>&gt;&gt;<i> select.so
</I>&gt;&gt;<i> _AE.so                  _Help.so                _TE.so
</I>&gt;&gt;<i> _hotshot.so             bz2.so                  itertools.so
</I>&gt;&gt;<i> sha.so
</I>&gt;&gt;<i> _AH.so                  _IBCarbon.so            _Win.so
</I>&gt;&gt;<i> _locale.so              cPickle.so              math.so
</I>&gt;&gt;<i> strop.so
</I>&gt;&gt;<i> _App.so                 _Icn.so                 _bisect.so
</I>&gt;&gt;<i> _multibytecodec.so      cStringIO.so            md5.so
</I>&gt;&gt;<i> struct.so
</I>&gt;&gt;<i> _CF.so                  _Launch.so              _bsddb.so
</I>&gt;&gt;<i> _random.so              cmath.so                mmap.so
</I>&gt;&gt;<i> syslog.so
</I>&gt;&gt;<i> _CG.so                  _List.so                _codecs_cn.so
</I>&gt;&gt;<i> _socket.so              collections.so          nis.so
</I>&gt;&gt;<i> termios.so
</I>&gt;&gt;<i> _CarbonEvt.so           _Menu.so                _codecs_hk.so
</I>&gt;&gt;<i> _ssl.so                 crypt.so                operator.so
</I>&gt;&gt;<i> time.so
</I>&gt;&gt;<i> _Cm.so                  _Mlte.so                _codecs_iso2022.so
</I>&gt;&gt;<i> _testcapi.so            datetime.so             parser.so
</I>&gt;&gt;<i> timing.so
</I>&gt;&gt;<i> _Ctl.so                 _OSA.so                 _codecs_jp.so
</I>&gt;&gt;<i> _tkinter.so             dbm.so                  pwd.so
</I>&gt;&gt;<i> unicodedata.so
</I>&gt;&gt;<i> _Dlg.so                 _Qd.so                  _codecs_kr.so
</I>&gt;&gt;<i> _weakref.so             fcntl.so                pyexpat.so
</I>&gt;&gt;<i> zlib.so
</I>&gt;&gt;<i> _Drag.so                _Qdoffs.so              _codecs_tw.so
</I>&gt;&gt;<i> array.so                gdbm.so                 readline.so
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I thought linking Mod_Python to the Python 2.4 code was taken care of
</I>&gt;&gt;<i> by the &quot;--with-python=/usr/local/bin/python2.4&quot; ? It seems to have
</I>&gt;&gt;<i> gotten the site-packages directory put into the right location.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Feb 15, 2005, at 5:50 PM, Graham Dumpleton wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> If you really want to use Python 2.4, you are going to have to somehow
</I>&gt;&gt;&gt;<i> force a reference to the Python library in mod_python.so. Since you
</I>&gt;&gt;&gt;<i> aren't
</I>&gt;&gt;&gt;<i> using a framework install, not sure what the library is you have to
</I>&gt;&gt;&gt;<i> force
</I>&gt;&gt;&gt;<i> link with. You might want to look for Python related libraries in such
</I>&gt;&gt;&gt;<i> directories as:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>   /usr/local/lib
</I>&gt;&gt;&gt;<i>   /usr/local/lib/python2.4/config
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> BTW, is there anything you really want in Python 2.4? Especially if
</I>&gt;&gt;&gt;<i> you are
</I>&gt;&gt;&gt;<i> a UNIX novice, trying to host two different versions of Python on
</I>&gt;&gt;&gt;<i> MacOSX
</I>&gt;&gt;&gt;<i> can be a problem. I guess at least you didn't use a framework install
</I>&gt;&gt;&gt;<i> and
</I>&gt;&gt;&gt;<i> do it on top of the system supplied version of Python. Doing that can
</I>&gt;&gt;&gt;<i> really screw things up bad.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> The only catch on using standard MacOSX Python installation is that you
</I>&gt;&gt;&gt;<i> need to patch src/mod_python.c file in source to workaround a problem
</I>&gt;&gt;&gt;<i> with it. Use of &quot;worker&quot; may also trigger some other mod_python bugs.
</I>&gt;&gt;&gt;<i> Fixes for both are detailed in:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>   <A HREF="http://www.dscpl.com.au/projects/vampire/PATCHES">http://www.dscpl.com.au/projects/vampire/PATCHES</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Graham
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> John Raines wrote ..
</I>&gt;&gt;&gt;&gt;<i> My website had been stable and running without error but I'd been
</I>&gt;&gt;&gt;&gt;<i> running on 2.3.3, 2.0.52 and 3.1.3; since everything was behind the
</I>&gt;&gt;&gt;&gt;<i> times I decided to finally reinstall; I made the mistake of doing it
</I>&gt;&gt;&gt;&gt;<i> on
</I>&gt;&gt;&gt;&gt;<i> the drive that everything was being served off of instead of using my
</I>&gt;&gt;&gt;&gt;<i> backup drive. :-(
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> I installed python 2.4 and it seems to work when I call it from the
</I>&gt;&gt;&gt;&gt;<i> shell. I did not do a frameworkInstall, which seems to be recommended
</I>&gt;&gt;&gt;&gt;<i> by some people. I am too much of a unix novice to understand what the
</I>&gt;&gt;&gt;&gt;<i> implications of frameworkInstall are. I installed apache and
</I>&gt;&gt;&gt;&gt;<i> mod_python
</I>&gt;&gt;&gt;&gt;<i> as follows:
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> cd ~/Desktop/httpd-2.0.53
</I>&gt;&gt;&gt;&gt;<i> ./configure --enable-so --with-mpm=worker
</I>&gt;&gt;&gt;&gt;<i> make
</I>&gt;&gt;&gt;&gt;<i> sudo make install
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> cd ~/Desktop/mod_python-3.1.4
</I>&gt;&gt;&gt;&gt;<i> ./configure --with apxs=/usr/local/apache2/bin/apxs
</I>&gt;&gt;&gt;&gt;<i> --with-python=/usr/local/bin/python2.4
</I>&gt;&gt;&gt;&gt;<i> make
</I>&gt;&gt;&gt;&gt;<i> sudo make install
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> I restored my old httpd.conf file and my website files. My index.html
</I>&gt;&gt;&gt;&gt;<i> file is straight html which links to .py files. As soon as I try to
</I>&gt;&gt;&gt;&gt;<i> access any of the .py stuff I now get an internal server error message
</I>&gt;&gt;&gt;&gt;<i> and the server log shows this:
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> [Tue Feb 15 16:25:25 2005] [notice] mod_python: Creating 32 session
</I>&gt;&gt;&gt;&gt;<i> mutexes based on 6 max processes and 25 max threads.
</I>&gt;&gt;&gt;&gt;<i> [Tue Feb 15 16:25:25 2005] [notice] Apache configured -- resuming
</I>&gt;&gt;&gt;&gt;<i> normal operations
</I>&gt;&gt;&gt;&gt;<i> [Tue Feb 15 16:25:36 2005] [error] make_obcallback: could not import
</I>&gt;&gt;&gt;&gt;<i> mod_python.apache.\n
</I>&gt;&gt;&gt;&gt;<i> Traceback (most recent call last):
</I>&gt;&gt;&gt;&gt;<i>    File &quot;/usr/local/lib/python2.4/site-packages/mod_python/apache.py&quot;,
</I>&gt;&gt;&gt;&gt;<i> line 22, in ?
</I>&gt;&gt;&gt;&gt;<i>      import time
</I>&gt;&gt;&gt;&gt;<i> ImportError: Failure linking new module: : dyld:
</I>&gt;&gt;&gt;&gt;<i> /usr/local/apache2/bin/httpd Undefined symbols:
</I>&gt;&gt;&gt;&gt;<i> /usr/local/lib/python2.4/lib-dynload/time.so undefined reference to
</I>&gt;&gt;&gt;&gt;<i> _PyArg_Parse expected to be defined in the executable
</I>&gt;&gt;&gt;&gt;<i> /usr/local/lib/python2.4/lib-dynload/time.so undefined reference to
</I>&gt;&gt;&gt;&gt;<i> _PyArg_ParseTuple expected to be defined in the executable
</I>&gt;&gt;&gt;&gt;<i> /usr/local/lib/python2.4/lib-dynload/time.so undefined reference to
</I>&gt;&gt;&gt;&gt;<i> _PyDict_GetItemString expected to be defined in the executable
</I>&gt;&gt;&gt;&gt;<i> /usr/local/lib/python2.4/lib-dynload/time.so un
</I>&gt;&gt;&gt;&gt;<i>                                                               &lt;--what
</I>&gt;&gt;&gt;&gt;<i> happened here??
</I>&gt;&gt;&gt;&gt;<i> [Tue Feb 15 16:25:36 2005] [error] make_obcallback: could not import
</I>&gt;&gt;&gt;&gt;<i> mod_python.apache.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> for what its worth I can access various parts of the time module when
</I>&gt;&gt;&gt;&gt;<i> I
</I>&gt;&gt;&gt;&gt;<i> run Python2.4 from the shell.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Going back through the the mailing list I saw that Graham Dumpleton
</I>&gt;&gt;&gt;&gt;<i> (back on Dec 23) suggested the output from this might be useful; what
</I>&gt;&gt;&gt;&gt;<i> I
</I>&gt;&gt;&gt;&gt;<i> get is different from what he saw but I'm not sure what to make of my
</I>&gt;&gt;&gt;&gt;<i> result:
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> jraines-Computer:~/Desktop/Website jrraines$ otool otool -L
</I>&gt;&gt;&gt;&gt;<i> /usr/local/apache2/modules/mod_python.so
</I>&gt;&gt;&gt;&gt;<i> otool: can't open file: otool (No such file or directory)
</I>&gt;&gt;&gt;&gt;<i> /usr/local/apache2/modules/mod_python.so:
</I>&gt;&gt;&gt;&gt;<i>          /usr/lib/libSystem.B.dylib (compatibility version 1.0.0,
</I>&gt;&gt;&gt;&gt;<i> current version 71.1.1)
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> jraines-Computer:~/Desktop/Website jrraines$ ls
</I>&gt;&gt;&gt;&gt;<i> /usr/local/apache2/modules
</I>&gt;&gt;&gt;&gt;<i> httpd.exp       mod_python.so
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> My problem seemed like it might be similar to a thread titled Weird
</I>&gt;&gt;&gt;&gt;<i> ob_callback problems at the end of Jan. I tried the suggestions Grisha
</I>&gt;&gt;&gt;&gt;<i> made:Try defining DYLD_FORCE_FLAT_NAMESPACE=1 environment variable
</I>&gt;&gt;&gt;&gt;<i> before launching httpd.
</I>&gt;&gt;&gt;&gt;<i> That didn't help either.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;&gt;<i> Mod_python mailing list
</I>&gt;&gt;&gt;&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;&gt;&gt;&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Mod_python mailing list
</I>&gt;&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i>
</I>
Ron Reisor &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">ron at udel.edu</A>&gt; (RWR3)
University of Delaware Information Technologies/Network and Systems Services
Computing Center/192 South Chapel Street/Newark DE, 19716
pgp finger print: 0D 73 06 6F D3 6A 99 D3  F5 D5 6E FF 3B B9 7C 2C
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017447.html">[mod_python] trying to upgrade to Python2.4, Apache2.0.53,
	Mod_Python3.1.4 on Mac OsX
</A></li>
	<LI>Next message: <A HREF="017450.html">[mod_python] DbmSession with gdbm
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17449">[ date ]</a>
              <a href="thread.html#17449">[ thread ]</a>
              <a href="subject.html#17449">[ subject ]</a>
              <a href="author.html#17449">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
