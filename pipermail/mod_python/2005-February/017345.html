<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Force reload?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Force%20reload%3F&In-Reply-To=20050204102632.P8854%40grisha.dyndns.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017341.html">
   <LINK REL="Next"  HREF="017332.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Force reload?</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Force%20reload%3F&In-Reply-To=20050204102632.P8854%40grisha.dyndns.org"
       TITLE="[mod_python] Force reload?">grahamd at dscpl.com.au
       </A><BR>
    <I>Fri Feb  4 21:07:16 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="017341.html">[mod_python] Force reload?
</A></li>
        <LI>Next message: <A HREF="017332.html">[mod_python] Installing mod_python to use a different version of
	python
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17345">[ date ]</a>
              <a href="thread.html#17345">[ thread ]</a>
              <a href="subject.html#17345">[ subject ]</a>
              <a href="author.html#17345">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On 05/02/2005, at 2:33 AM, Gregory (Grisha) Trubetskoy wrote:
&gt;<i> so as you see A is still there. So you're bound to have to restart 
</I>&gt;<i> your server at some point. IMO the reload mechanism should be 
</I>&gt;<i> sufficient enough to avoid having to restart httpd all of the time, 
</I>&gt;<i> but the developer still needs to understand how Python works and 
</I>&gt;<i> realize that some situation are only solved by a restart.
</I>
Actually, vampire gets around that as well. It doesn't use the &quot;imp&quot; 
module
and uses execfile() instead. Taking this approach one has greater 
control as
things aren't stored into sys.modules and one can simply load into a new
empty module.

This does however mean that variables aren't persistent across reloads 
which
is why deleting stuff actually works. As such, if you do want persistent
variables, you have to denote explicitly that this is what is desired by
supplying a __clone__() method in your module which will transfer such
data across to the new module.

By making it explicit, it also makes users face the implications of 
doing
reloads. Most users wouldn't realise that a reload will replace a 
variable
that exists in both new and old modules. This can be really bad if it 
is a
database connection pool, as the original copy is done away with, 
potentially
without actually closing the connections off. Thus one can have an ever
increase set of database connections as reloads occur, with most be 
unusable.

Making it explicit also means it is likely that some of the threading 
issues
might be dealt with. For example, what happens if a reload occurs while 
a
separate thread is handing a request and is accessing the data that is 
being
reloaded on top off.

Unfortunately, all the reasons why Vampire does all these things isn't
documented yet, but am slowly working my way towards it. :-)

Graham

</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017341.html">[mod_python] Force reload?
</A></li>
	<LI>Next message: <A HREF="017332.html">[mod_python] Installing mod_python to use a different version of
	python
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17345">[ date ]</a>
              <a href="thread.html#17345">[ thread ]</a>
              <a href="subject.html#17345">[ subject ]</a>
              <a href="author.html#17345">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
