<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] How to get path from URL
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20How%20to%20get%20path%20from%20URL&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017537.html">
   <LINK REL="Next"  HREF="017541.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] How to get path from URL</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20How%20to%20get%20path%20from%20URL&In-Reply-To="
       TITLE="[mod_python] How to get path from URL">grahamd at dscpl.com.au
       </A><BR>
    <I>Sun Feb 27 18:22:05 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="017537.html">Fwd: [mod_python] Session example and problems.
</A></li>
        <LI>Next message: <A HREF="017541.html">[mod_python] Session example and problems.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17540">[ date ]</a>
              <a href="thread.html#17540">[ thread ]</a>
              <a href="subject.html#17540">[ subject ]</a>
              <a href="author.html#17540">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Shawn Harrison wrote ..
&gt;<i> &gt; What you want is:
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt;   p = '<A HREF="http://'">http://'</A> + req.hostname + req.uri[:-len(req.path_info)]
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Which yields:
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt;   <A HREF="http://localhost/~grahamd/hclass/page">http://localhost/~grahamd/hclass/page</A>
</I>&gt;<i> 
</I>&gt;<i> Well, that's a lot less work, isn't it.
</I>&gt;<i> 
</I>&gt;<i> &gt; This will not work though if not the standard server port or if &quot;https&quot;
</I>&gt;<i> is
</I>&gt;<i> &gt; used.
</I>&gt;<i> 
</I>&gt;<i> Thanks, I forgot to mention that.
</I>&gt;<i> 
</I>&gt;<i> Is the port available in mod_python? I wasn't able to find it when
</I>&gt;<i> working with this problem earlier. How about the protocol (https vs http)?
</I>
One can get the port from the connection object, but protocol, hostname
and port aren't usually wise things to rely on if one is intending to use the
derived address to plug back into a HTML page for example. This is because
it will fail with if your web page location is being masked by another instance
of Apache using proxy pass through.

The original poster would have to be clear about what they intended using
it for in order to comment further as to whether it is a good idea to be
doing what was asked for.

If the intent is to use the address in generated HTML content where it is
a hyperlink, you are thus better off using a relative address. This can be a
bit tricky if using publisher though where it may auto map to an index()
method as well as you accessing it explicitly. Ie., from memory if you
access &quot;/dog&quot; you can end up with:

  req.uri = /dog
  req.path_info =

If you instead access &quot;/dog/index&quot; you instead get for the same method:

  req.uri = /dog/index
  req.path_info = /index

If my thinking is right, the relative URL in the first case would need to
be &quot;.&quot; and in the latter &quot;..&quot;. You thus perhaps need to do something like:

  hops = req.path_info.split('/')
  if len(hops) == 1:
    relative = &quot;.&quot;
  else:
    relative = '/'.join((len(hops)-1)*[&quot;..&quot;])

If instead you are after a URL for the purposes of doing an internal/external
redirection, you do not need the protocol, hostname and port anyway and
could just say:

  target = req.uri[:-len(req.path_info)] + '/login
  req.internal_redirect(target)

Note, that the above haven't been throughly tested. I could also just be wrong
in the first place. :-)

Graham
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017537.html">Fwd: [mod_python] Session example and problems.
</A></li>
	<LI>Next message: <A HREF="017541.html">[mod_python] Session example and problems.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17540">[ date ]</a>
              <a href="thread.html#17540">[ thread ]</a>
              <a href="subject.html#17540">[ subject ]</a>
              <a href="author.html#17540">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
