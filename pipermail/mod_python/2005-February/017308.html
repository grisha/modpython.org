<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] servlet sessions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20servlet%20sessions&In-Reply-To=20050202084718.72677.qmail%40web25004.mail.ukl.yahoo.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017307.html">
   <LINK REL="Next"  HREF="017310.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] servlet sessions</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Daniel Popowich</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20servlet%20sessions&In-Reply-To=20050202084718.72677.qmail%40web25004.mail.ukl.yahoo.com"
       TITLE="[mod_python] servlet sessions">dpopowich at comcast.net
       </A><BR>
    <I>Wed Feb  2 08:38:22 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="017307.html">[mod_python] servlet sessions
</A></li>
        <LI>Next message: <A HREF="017310.html">[mod_python] servlet sessions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17308">[ date ]</a>
              <a href="thread.html#17308">[ thread ]</a>
              <a href="subject.html#17308">[ subject ]</a>
              <a href="author.html#17308">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Colin Doherty writes:
&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> I'm having difficulty getting sessions working in
</I>&gt;<i> modpython.servlet, the tutorial example works so it
</I>&gt;<i> would appear to be an error in my code rather than
</I>&gt;<i> apache/mod_python set up:
</I>
You have a few things you can do here...

&gt;<i> from mod_python.servlet import Servlet
</I>&gt;<i> 
</I>&gt;<i> class mpseg(Servlet):
</I>&gt;<i>     __msg = ''
</I>&gt;<i>     auth_realm = 'Private'
</I>&gt;<i>     
</I>&gt;<i>     def __init__(self):
</I>&gt;<i>         Servlet.__init__(self)
</I>&gt;<i> 
</I>&gt;<i>     def auth(self):
</I>&gt;<i>         if self.session.is_new():
</I>&gt;<i>             user,pw = self._get_user_pw()
</I>&gt;<i>             if user == 'user' and pw == 'password':
</I>&gt;<i>                 self.__msg = 'Hi'
</I>&gt;<i>                 return
</I>&gt;<i>             else:
</I>&gt;<i>                 self._unauthorized()
</I>&gt;<i>         if not self.session.is_new():
</I>&gt;<i>             self.__msg = 'Welcome back'
</I>&gt;<i> 
</I>&gt;<i>     def respond(self):
</I>&gt;<i>         self.writeln(self.__msg)
</I>&gt;<i>         return True
</I>&gt;<i>
</I>&gt;<i>     def prep(self):
</I>&gt;<i>         use_session = True
</I>

As you've written it in prep, the variable use_session is local, so as
far as the servlet is concerned, it's not set.  You want:

     def prep(self):
         self.use_session = True
         Servlet.prep(self)

Note, if you write your own prep, you HAVE to call the superclass'
prep.  Typically, you would call the superclass prep first, but since
you're setting a variable Servlet.prep needs, you have to set the
variable before calling it.

Better yet, unless you want to make using sessions dynamic per
request, you'd be better off setting it in the class definition so
each instance inherits it:


    class mpseg(Servlet):
	__msg = ''
	auth_realm = 'Private'
	use_session = True

	def respond(self):
	   ...

Then you don't even have to write your own prep method if all it was
doing was setting the use_session variable.  Likewise, you don't have
to write __init__ if all it's doing is calling Servlet.__init__.

Double check this:

    pydoc mod_python.servlet.Servlet.prep

and this:

    <A HREF="http://lnx1.blue-fox.com/~dpopowich/mpstutorial/lifecycle">http://lnx1.blue-fox.com/~dpopowich/mpstutorial/lifecycle</A>

Cheers,

Daniel Popowich
-----------------------------------------------
<A HREF="http://home.comcast.net/~d.popowich/mpservlets/">http://home.comcast.net/~d.popowich/mpservlets/</A>

</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017307.html">[mod_python] servlet sessions
</A></li>
	<LI>Next message: <A HREF="017310.html">[mod_python] servlet sessions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17308">[ date ]</a>
              <a href="thread.html#17308">[ thread ]</a>
              <a href="subject.html#17308">[ subject ]</a>
              <a href="author.html#17308">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
