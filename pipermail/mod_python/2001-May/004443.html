<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Win32 threading issue
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Win32%20threading%20issue&In-Reply-To=Pine.BSF.4.32.0105080944350.16559-100000%40localhost">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004440.html">
   <LINK REL="Next"  HREF="004435.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Win32 threading issue</H1>
    <B>Chris Trengove</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Win32%20threading%20issue&In-Reply-To=Pine.BSF.4.32.0105080944350.16559-100000%40localhost"
       TITLE="[mod_python] Win32 threading issue">trengove at econdata.com.au
       </A><BR>
    <I>Wed May  9 08:27:50 EST 2001</I>
    <P><UL>
        <LI>Previous message: <A HREF="004440.html">[mod_python] Win32 threading issue
</A></li>
        <LI>Next message: <A HREF="004435.html">[mod_python] Win32 threading issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4443">[ date ]</a>
              <a href="thread.html#4443">[ thread ]</a>
              <a href="subject.html#4443">[ subject ]</a>
              <a href="author.html#4443">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<table border=0 width="100%"><tr><td>
<!--beginarticle-->
<PRE>Grisha,

Exactly what I see is variable in nature. The most usual thing will be an
entry in the Apache error log like this

[Tue May 08 16:47:37 2001] [error] PythonHandler hwtest: Traceback (most
recent call last):

[Tue May 08 16:47:37 2001] [error] PythonHandler hwtest:   File
&quot;e:\python20\lib\mod_python\apache.py&quot;, line 189, in Dispatch     result =
object(self.req) [Tue May 08 16:47:37 2001] [error] PythonHandler hwtest:
File &quot;c:/apache/apache/htdocs/python\hwtest.py&quot;, line 24, in handler
req.write(&quot;%d: %d\n&quot; % (thread.get_ident(),counter)) 

[Tue May 08 16:47:37 2001] [error] PythonHandler hwtest: IOError: Write
failed, client closed connection. 

When I use my Python driver script, which keeps going even if no data is
returned from the server, I will often end up with an access violation
inside Apache.exe.

&quot;The instruction at &quot;0x6ff71679&quot; referenced memory at &quot;0x616c707b&quot;. The
memory could not be &quot;read&quot;.&quot;

Actually, this location appears to be always the same -- when it eventually
happens -- which might be after a significant number log error messages.
After the access violation, one of my driver scripts stops, because it
receives a socket exception (10054, &quot;Connection reset by peer&quot;), and the
other script continues merrily along.

Occassionally other things can happen too -- I think it just depends on
when the two threads conflict. As I mentioned earilier, one really
misterious occurrence is getting a &quot;double message&quot; returned to one thread,
just as the other receives no data. Like this

632: 1515843&lt;LF&gt;568: 1572286

Here &lt;LF&gt; is a line feed, and the numbers before the colons are the thread
IDs. I know that Apache has 50 threads which it is cycling through in
order. On this occassion 568 was due to be the thread to be used for the
OTHER client.

Chris

At 09:47 AM 8/05/2001 -0400, Gregory (Grisha) Trubetskoy wrote:
&gt;<i>
</I>&gt;<i>Interesting...
</I>&gt;<i>
</I>&gt;<i>Another question - when you say a thread crashes, what exactly do you see
</I>&gt;<i>- is it something in the log or one of those dr. watson messages?
</I>&gt;<i>
</I>&gt;<i>On Tue, 8 May 2001, Chris Trengove wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Grisha,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I did have KeepAlive On, but it appears to make no difference. I have just
</I>&gt;&gt;<i> tried with KeepAlive Off, and I get the same behaviour. Also, the clients I
</I>&gt;&gt;<i> have been using would be closing the connection after each request. As
</I>&gt;&gt;<i> clients I have been using a Python script with urllib, and a little C++
</I>&gt;&gt;<i> test program I wrote to see if trying a different client made any
</I>&gt;&gt;<i> difference. It didn't.
</I>


</PRE>
<!--endarticle-->
</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004440.html">[mod_python] Win32 threading issue
</A></li>
	<LI>Next message: <A HREF="004435.html">[mod_python] Win32 threading issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4443">[ date ]</a>
              <a href="thread.html#4443">[ thread ]</a>
              <a href="subject.html#4443">[ subject ]</a>
              <a href="author.html#4443">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
