<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] converting site from CGI to mod_python
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20converting%20site%20from%20CGI%20to%20mod_python&In-Reply-To=490BAB9F.7040805%40fastmail.com.au">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025739.html">
   <LINK REL="Next"  HREF="025741.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] converting site from CGI to mod_python</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20converting%20site%20from%20CGI%20to%20mod_python&In-Reply-To=490BAB9F.7040805%40fastmail.com.au"
       TITLE="[mod_python] converting site from CGI to mod_python">graham.dumpleton at gmail.com
       </A><BR>
    <I>Sat Nov  1 04:51:58 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="025739.html">[mod_python] problems uploading large files
</A></li>
        <LI>Next message: <A HREF="025741.html">[mod_python] converting site from CGI to mod_python
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25740">[ date ]</a>
              <a href="thread.html#25740">[ thread ]</a>
              <a href="subject.html#25740">[ subject ]</a>
              <a href="author.html#25740">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>2008/11/1 Adam &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">adam at fastmail.com.au</A>&gt;:
&gt;<i> Hi,
</I>&gt;<i> I've made a CGI web app for managing DNS zones. I want to convert my scripts
</I>&gt;<i> so they use mod_python instead of cgi, but I can't really find any good
</I>&gt;<i> examples which demonstrate a standard way of doing what I want.
</I>&gt;<i>
</I>&gt;<i> So everything to do with my website is stored in this directory:
</I>&gt;<i> /var/www/localhost/BDNS
</I>&gt;<i>
</I>&gt;<i> This directory has three subdirectories.
</I>&gt;<i>  -config
</I>&gt;<i>  -content
</I>&gt;<i>     -templates
</I>&gt;<i>  -scripts
</I>&gt;<i>
</I>&gt;<i> config  - holds user and zone configuration
</I>&gt;<i> content - originally stored CGI files and templates.
</I>&gt;<i> scripts - stored the scripts to handle dns updates and manage configuration
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Now I'm wondering whether this directory structure should be reognanised if
</I>&gt;<i> I want to use mod_python. The issue is that my documentroot in apache is
</I>&gt;<i> configured to  /var/www/localhost/BDNS/content and I cannot refer to my
</I>&gt;<i> config files in mod_python using relative path names. This was not an issue
</I>&gt;<i> when I was using CGI.
</I>&gt;<i>
</I>&gt;<i> Consider this as a simple example. I have a file index.py which wants to
</I>&gt;<i> open a config file in the config directory.
</I>&gt;<i>
</I>&gt;<i> --------------------index.py--------------------
</I>&gt;<i> from mod_python import apache
</I>&gt;<i> bdns = apache.import_module(&quot;../scripts/bdns.py&quot;)
</I>&gt;<i> tmplutils = apache.import_module(&quot;../scripts/tmplutils.py&quot;)
</I>&gt;<i> import sys
</I>&gt;<i>
</I>&gt;<i> def index(req):
</I>&gt;<i>       f = open(&quot;../config/bdns.conf&quot;)
</I>
Use:

  conffile = os.path.join(os.path.dirname(__file__), &quot;..&quot;, &quot;config&quot;,
&quot;bdns.conf&quot;)
  f = open(confile, 'r')

If converting from CGI, you may find it better to translate your CGI
script to WSGI instead of directly to mod_python. By using WSGI, you
can still run it as CGI using a CGI-WSGI bridge, but also run your
script under mod_python (with adapter), mod_wsgi (directly), fastcgi
(flup adapter), scgi (flup adapter) etc etc.

In other words, by using WSGI you retain portability and with WSGI not
being too different to CGI in some respects, possibly easier to port.

Graham

&gt;<i>       return f.readlines()
</I>&gt;<i> --------------------------------------------------
</I>&gt;<i>
</I>&gt;<i> This code above doesn't work when I browse to index.py. I don't want to use
</I>&gt;<i> fixed path names.
</I>&gt;<i>
</I>&gt;<i> Any help with organising my files and folders would be appreciated.
</I>&gt;<i>
</I>&gt;<i> Adam
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i>
</I></PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025739.html">[mod_python] problems uploading large files
</A></li>
	<LI>Next message: <A HREF="025741.html">[mod_python] converting site from CGI to mod_python
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25740">[ date ]</a>
              <a href="thread.html#25740">[ thread ]</a>
              <a href="subject.html#25740">[ subject ]</a>
              <a href="author.html#25740">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
