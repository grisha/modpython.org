<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] streaming tar and/or zip files?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20streaming%20tar%20and/or%20zip%20files%3F&In-Reply-To=e94d85500706291341g177ca66j694567652f252de9%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023962.html">
   <LINK REL="Next"  HREF="023988.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] streaming tar and/or zip files?</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Mike Looijmans</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20streaming%20tar%20and/or%20zip%20files%3F&In-Reply-To=e94d85500706291341g177ca66j694567652f252de9%40mail.gmail.com"
       TITLE="[mod_python] streaming tar and/or zip files?">nlv11281 at natlab.research.philips.com
       </A><BR>
    <I>Tue Jul  3 01:34:15 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="023962.html">[mod_python] Can't get a 206 (partial content) response
</A></li>
        <LI>Next message: <A HREF="023988.html">[mod_python] streaming tar and/or zip files?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23963">[ date ]</a>
              <a href="thread.html#23963">[ thread ]</a>
              <a href="subject.html#23963">[ subject ]</a>
              <a href="author.html#23963">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The &quot;tarfile&quot; built-in Python module can do as you ask, and also do compression (gzip or bzip2). ZIP 
cannot be &quot;streamed&quot;, it has a sort of directory table inside to which it jumps up and down.

You can just open a tarfile object with the req object as file output.

Setting content-type to &quot;application/x-tar&quot; or something similar will help your client figuring out 
what to do with the file.

I've used the tarfile module with archives over 800GB in size, without problems.


Mike Looijmans
Philips Natlab / Topic Automation


Matthew Dennis wrote:
&gt;<i> This may not be the appropriate list, my apologies if that is indeed the 
</I>&gt;<i> case...
</I>&gt;<i> 
</I>&gt;<i> I need to push from mod_python a file archive of sorts.  Any of tar, 
</I>&gt;<i> tar.gz or zip will work (I'm also open to other suggestions).  The 
</I>&gt;<i> requirement is that I can package several other &quot;files&quot; into it, 
</I>&gt;<i> compressed or not.  I have no disk to write to and finite memory to deal 
</I>&gt;<i> with but the &quot;files&quot; I'm outputting are quite large (much larger than 
</I>&gt;<i> can fit in memory), thus I need to stream them directly out.  The reason 
</I>&gt;<i> I put &quot;files&quot; in quotes is because they are not really files, but 
</I>&gt;<i> dynamic content that is generated on the fly.  ZipOutputStream from Java 
</I>&gt;<i> is a example of what I'm talking about if anyone is familiar with it, as 
</I>&gt;<i> are other such streams.  I don't know the size of the content until 
</I>&gt;<i> after it is all generated so there is no way to populate a TarInfo 
</I>&gt;<i> object with the size et cetera and make my dynamic content look like a 
</I>&gt;<i> file (which it doesn't seem I can do anyway as gettarinfo() tries to 
</I>&gt;<i> call .fileno() which doesn't exist on any file like object I would create).
</I>&gt;<i> 
</I>&gt;<i> In other words, something like:
</I>&gt;<i> 
</I>&gt;<i> output = TarFileStream(someFileObj)
</I>&gt;<i> 
</I>&gt;<i> output.addEntry(&quot;file_1.txt&quot;)
</I>&gt;<i> out.write( /*some dynamically generated content */ )
</I>&gt;<i> out.write( /*some dynamically generated content */ )
</I>&gt;<i> out.write( /*some dynamically generated content */ )
</I>&gt;<i> 
</I>&gt;<i> output.addEntry(&quot;file_2.txt&quot;)
</I>&gt;<i> out.write( /*some dynamically generated content */ )
</I>&gt;<i> out.write( /*some dynamically generated content */ )
</I>&gt;<i> out.write( /*some dynamically generated content */ )
</I>&gt;<i> 
</I>&gt;<i> ...
</I>&gt;<i> 
</I>&gt;<i> output.addEntry(&quot;file_N.txt&quot;)
</I>&gt;<i> out.write( /*some dynamically generated content */ )
</I>&gt;<i> out.write( /*some dynamically generated content */ )
</I>&gt;<i> out.write( /*some dynamically generated content */ )
</I>&gt;<i> 
</I>&gt;<i> output.close()
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> ------------------------------------------------------------------------
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>

</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023962.html">[mod_python] Can't get a 206 (partial content) response
</A></li>
	<LI>Next message: <A HREF="023988.html">[mod_python] streaming tar and/or zip files?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23963">[ date ]</a>
              <a href="thread.html#23963">[ thread ]</a>
              <a href="subject.html#23963">[ subject ]</a>
              <a href="author.html#23963">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
