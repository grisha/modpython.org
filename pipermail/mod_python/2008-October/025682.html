<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] on OSX Leopard: &quot;The process has forked...&quot; crash
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20on%20OSX%20Leopard%3A%20%22The%20process%20has%20forked...%22%20crash&In-Reply-To=22e13a220810070943m2b0c0a67h1a6f5442f099653c%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025677.html">
   <LINK REL="Next"  HREF="025676.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] on OSX Leopard: &quot;The process has forked...&quot; crash</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20on%20OSX%20Leopard%3A%20%22The%20process%20has%20forked...%22%20crash&In-Reply-To=22e13a220810070943m2b0c0a67h1a6f5442f099653c%40mail.gmail.com"
       TITLE="[mod_python] on OSX Leopard: &quot;The process has forked...&quot; crash">graham.dumpleton at gmail.com
       </A><BR>
    <I>Tue Oct  7 20:55:34 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="025677.html">[mod_python] on OSX Leopard: &quot;The process has forked...&quot; crash
</A></li>
        <LI>Next message: <A HREF="025676.html">[mod_python] Compling error:
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25682">[ date ]</a>
              <a href="thread.html#25682">[ thread ]</a>
              <a href="subject.html#25682">[ subject ]</a>
              <a href="author.html#25682">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>2008/10/8 Lawrence Wang &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">levity at gmail.com</A>&gt;:
&gt;<i> Wow, that actually worked, even though it makes no sense to me. :) Can you
</I>&gt;<i> explain that?
</I>
Because PHP preloads everything into the Apache parent process before
processes are forked from that to create normal Apache child worker
processes. Thus, the child worker processes inherit any dynamic
objects, frameworks and shared libraries loaded by PHP. If PHP screws
up in some way, as it had, then it will therefore affect mod_python.

Graham

&gt;<i> On Mon, Oct 6, 2008 at 9:12 PM, Graham Dumpleton
</I>&gt;<i> &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">graham.dumpleton at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Whoops, forgot to reply to list. Can OP please ensure they reply-all
</I>&gt;&gt;<i> to this email and not first one.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Are you running PHP on the same server? Have you disabled PHP and then
</I>&gt;&gt;<i> stopped/started Apache to see if problem goes away?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> There should be no problem with Python/mod_python itself, but a
</I>&gt;&gt;<i> problem like this in PHP can be inherited by the Python/mod_python
</I>&gt;&gt;<i> instance running in the same process.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> In other words, not a Python/mod_python problem, instead it is being
</I>&gt;&gt;<i> affected by PHP hosted by same Apache instance.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Graham
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 2008/10/7 Lawrence Wang &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">levity at gmail.com</A>&gt;:
</I>&gt;&gt;<i> &gt; Hi! I compiled mod_python on OSX Leopard with a simple ./configure &amp;&amp;
</I>&gt;&gt;<i> &gt; make
</I>&gt;&gt;<i> &gt; &amp;&amp; sudo make install, and it works just fine for almost everything.
</I>&gt;&gt;<i> &gt; However,
</I>&gt;&gt;<i> &gt; certain Python operations cause Apache to crash with many of these
</I>&gt;&gt;<i> &gt; errors in
</I>&gt;&gt;<i> &gt; the log:
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; The process has forked and you cannot use this CoreFoundation
</I>&gt;&gt;<i> &gt;&gt; functionality safely. You MUST exec().
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; Break on
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; __THE_PROCESS_HAS_FORKED_AND_YOU_CANNOT_USE_THIS_COREFOUNDATION_FUNCTIONALITY___YOU_MUST_EXEC__()
</I>&gt;&gt;<i> &gt;&gt; to debug.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; One example of code that causes this:
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; import urllib2
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; data = urllib2.urlopen('<A HREF="http://www.google.com'">http://www.google.com'</A>).read()
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; I'm pretty sure this is caused by mod_python and not, say, python
</I>&gt;&gt;<i> &gt; itself,
</I>&gt;&gt;<i> &gt; because I don't get the same error when I run the same script as a CGI
</I>&gt;&gt;<i> &gt; handler in apache.
</I>&gt;&gt;<i> &gt; The hardware is a MacBook with Core 2 Duo (hence 64-bit). Some googling
</I>&gt;&gt;<i> &gt; revealed that the same error is caused by an old PHP library[1], and
</I>&gt;&gt;<i> &gt; that is
</I>&gt;&gt;<i> &gt; solvable by changing its configuration and recompiling, so I'm hoping
</I>&gt;&gt;<i> &gt; the
</I>&gt;&gt;<i> &gt; same is the case here.
</I>&gt;&gt;<i> &gt; Any help you can offer is greatly appreciated!
</I>&gt;&gt;<i> &gt; Lawrence Wang
</I>&gt;&gt;<i> &gt; [1]:
</I>&gt;&gt;<i> &gt; <A HREF="http://iparrizar.mnstate.edu/~juan/urania/2008/09/05/forking-problems-with-freetype-solved/">http://iparrizar.mnstate.edu/~juan/urania/2008/09/05/forking-problems-with-freetype-solved/</A>
</I>&gt;&gt;<i> &gt; _______________________________________________
</I>&gt;&gt;<i> &gt; Mod_python mailing list
</I>&gt;&gt;<i> &gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;&gt;<i> &gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i>
</I></PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025677.html">[mod_python] on OSX Leopard: &quot;The process has forked...&quot; crash
</A></li>
	<LI>Next message: <A HREF="025676.html">[mod_python] Compling error:
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25682">[ date ]</a>
              <a href="thread.html#25682">[ thread ]</a>
              <a href="subject.html#25682">[ subject ]</a>
              <a href="author.html#25682">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
