From unscribe127108 at yahoo.com  Tue Feb  5 17:08:47 2002
From: unscribe127108 at yahoo.com (unscribe127108@yahoo.com)
Date: Fri Jan  9 21:46:37 2004
Subject: [mod_python] Реклама Вашего проекта во всемирной глобальной сети Интернет.
Message-ID: <02822274@ghaqy>

    ?????? ????.

    ?????? ???????? ???????????? ?????????? ??????????? ?? ????? ??? ????????? 
???????????? ?????? ?????. ???????? ????? ?? ????? ???? ?????? ?? ????? ? 
????? ???????, ???? ???????? ????? ????????? ? ???, ??? ?? ???????????. ?? 
????????????? ??? ?????????? ??????????? ??????? ?? ????? ????????????? 
???????? ??? ??????????? ??????????. ???????? ????? ?? ??? ?????, ??????? 
??? ?????????, ??????? ???? ?????? ? ????????? ???, ??? ??? ?????? ??????? ??. 
?????? ???, ???? ?????????????? ???? ???????????, ?????? ? ???? ?? ?????. 
???????? ???????? ?? E-mail - ????? ??????????? ?????? ???????. ???? ???? 
? ?????? ?????? ?????????????? ???????????.

    ????? ?????? ??????? ?? ??????? ?????? ???????? ????(???? ???) ? ????????????
??????? ?? ????? ??????. ????? ?????? ???? ????? 25 ?????????.

    ??? ???????? ? ???? ??????????? ?????? ICQ. ?? ??????? ?? ??? ???? ???????.
UIN: 127108

    ?????? ???????? ??????????? ? ???????????? ? ?.4 ??.29 ??????????? ??. 
??? ??????????? ????? ??????? ?? ???????? ?????????? (????? ??????????) ?
???????????? ??? ????????? ???????? ?????????. ? ?????? ????????? ???????? 
???????????? ???????????, ???????? ?? ??? ?????? ? ???????? ? ???? "REMOVE". 
??? e-mail ????? ?????? ?? ????.



From jps at savagebeast.com  Wed Feb  6 17:31:10 2002
From: jps at savagebeast.com (Jeff Stearns)
Date: Fri Jan  9 21:46:37 2004
Subject: [mod_python] Loading the mod_python modules from somewhere other than site-packages
Message-ID: <5DC2C0CC-1B6A-11D6-A933-0030653DCC28@savagebeast.com>

Folks -

I'm installing mod_python on a Linux box which can't allow anything to 
be installed within the site-python directory.  (The reasons for that 
are slightly interesting; the box operates as a virtual machine with 
many apache servers running different software versions, and the virtual 
machines would step on each other's copy of the mod_python files.)

Thus I wish to install the handful of mod_python/*.py files in the 
user's directory, not in the system-wide site-python directory.

I am running into trouble because I can't get mod_python to look 
elsewhere for these files. It seems to be using the wired-in default 
python path.

The PythonPath directive looks tempting, but it looks like a write-only 
variable. I don't think any piece of code actually uses this value.

I'm thinking of reworking the make_obcallback() function to use the 
value of PythonPath by poking it into sys.path before importing the 
mod_python modules.

Does this seem like the right strategy?  Is make_obcallback the right 
place to do this?  (I tried running apache -X under gdb to get a better 
idea of how apache and mod_python interact, but there's some problem 
with gad that's preventing me from using it at all here, alas.)

thx for your advice!

-jeff stearns


From thanos at 0x01.com  Thu Feb  7 15:32:57 2002
From: thanos at 0x01.com (thanos@0x01.com)
Date: Fri Jan  9 21:46:37 2004
Subject: [mod_python] MySQL
Message-ID: <20020207203257.19753.qmail@0x01.com>

Has any one had MySQL expiriences ? 

When using cgi's we have exprienced no problems, but the following script 
will often break.

from mod_python import apache

def handler(req):
        import MySQLdb
        req.send_http_header()
        req.write("importd MySQLdb hello world")
        return apache.OK



I think on its first time the httpd execurtes this handler without any outward problems, but on the second time round:

Mod_python error: "PythonHandler testmysql"

Traceback (most recent call last):

  File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line 181, in Dispatch
    module = import_module(module_name, _req)

  File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line 356, in import_module
    if os.path.exists(filepath[:-1]) :

  File "/usr/local/lib/python2.1/posixpath.py", line 171, in exists
    st = os.stat(path)

OSError: [Errno 2] No such file or directory: '/usr/home/thanos/public_html/pso/tests/testmsql/testmysql.p'



You can try it out at:

http://www.0x01.com/~thanos/pso/tests/testmsql/mptest.py

Moving the import statement outside the handler will make the handle break every time. I guess this is some sort of clue. 

Any help would be great

thanks

thanos.






From alain at onesite.org  Fri Feb  8 01:01:58 2002
From: alain at onesite.org (Alain Tesio)
Date: Fri Jan  9 21:46:37 2004
Subject: [mod_python] MySQL
In-Reply-To: <20020207203257.19753.qmail@0x01.com>
References: <20020207203257.19753.qmail@0x01.com>
Message-ID: <20020208010158.7f1cf0ae.alain@onesite.org>

On Thu, 7 Feb 2002 15:32:57 -0500 (EST)
thanos@0x01.com wrote:

> OSError: [Errno 2] No such file or directory: > '/usr/home/thanos/public_html/pso/tests/testmsql/testmysql.p'

Hi, I knew I had already seen this problem, this may help:

http://www.modpython.org/pipermail/mod_python/2001-July/001478.html

Alain




From grisha at modpython.org  Thu Feb  7 19:24:52 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:37 2004
Subject: [mod_python] MySQL
In-Reply-To: <20020208010158.7f1cf0ae.alain@onesite.org>
Message-ID: <Pine.BSF.4.32.0202071923260.40345-100000@localhost>

On Fri, 8 Feb 2002, Alain Tesio wrote:

> Hi, I knew I had already seen this problem, this may help:
>
> http://www.modpython.org/pipermail/mod_python/2001-July/001478.html


That post has the wrong answer, the right answer is here:

http://www.modpython.org/FAQ/faqw.py?req=all#2.3

Grisha



From lbergman at abi.tconline.net  Fri Feb  8 11:40:15 2002
From: lbergman at abi.tconline.net (Lewis Bergman)
Date: Fri Jan  9 21:46:37 2004
Subject: [mod_python] confused about add_handler
Message-ID: <200202081740.g18HeFB18176@lewis.abi.tconline.net>

I am having difficulty. I am sure the root of the problem is my own stupidity 
but after 2 days of trying I can't seem to resolve this issue. No errors 
appear in the log. It just seems to ignore my handler and shows an index of 
the directory. I assume from the manual covering this section that this might 
mean the handler is invalid, but I don't think so. I read the "food for 
thought" (the one that says the name of the file doesn't matter) paragraph 
and thought maybe this is it. I don't believe so because that is an externel 
request detail and this is an internal deal.

Here is the situation:
auth.py is set as the authen handler like so
<Directory /var/www/html/ispmgr>
  AddHandler python-program .py
  PythonHandler mod_python.publisher
  PythonAuthenHandler auth
  AuthType Basic
  AuthName "Restricted Area"
  require valid-user
  PythonDebug On
</Directory>

As you can see I am trying to use the publisher.

auth.py looks like this:
from mod_python import apache
def authenhandler(req):
	"""Provide the correct page for the privilege of user."""

	pw = req.get_basic_auth_pw()
	user = req.connection.user
	if user == "admin" and pw == "admin":
		req.add_handler("PythonHandler", "setup::admin")
		return apache.OK
	if user == "operator" and pw == "operator":
		req.add_handler("PythonHandler", "setup::operator")
		return apache.OK
	if user == "user" and pw == "user":
		req.add_handler("PythonHandler", "setup::user")
		return apache.OK
	else:
		return apache.HTTP_UNAUTHORIZED

Later I will replace the statements with db calls (if I can ever get this 
working)

I think this means it should look for the setup file, try to instantiate it 
as setup and try to invoke the method admin. I am sure my logic must be way 
off here.
In case it is required, here is setup.py
class setup:

	def _frame(frameLeft, frameRight):
		"""Sets up frames.
	
		frameleft and frameright will be replaced by the correct menu function.
		"""
		html = """\
			<html>
			<head>
				<title>ISPMgr</title>
				<link rel=stylesheet type="text/css" href="ispmgr.css" title="stylesheet">
			</head>
			<frameset cols="20%%,*">
				<frame src="%s" name="menu">
				<frame src="%s" name="main">
			</frameset>"""% (frameLeft, frameRight)

		return html


	def admin():
		"""Provide all options to admin users."""
		r = _frame('menu.admin', 'main.customer')
		return r

Do all the handlers have to appear in the same file? (auth.py)
Lost and hopeless, please help.
-- 
Lewis Bergman
Texas Communications
4309 Maple St.
Abilene, TX 79602-8044
915-695-6962 ext 115

From grisha at modpython.org  Fri Feb  8 13:32:20 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:37 2004
Subject: [mod_python] confused about add_handler
In-Reply-To: <200202081740.g18HeFB18176@lewis.abi.tconline.net>
Message-ID: <Pine.BSF.4.32.0202081330560.63081-100000@localhost>

Hmm - I don't see anything wrong with this, it should work. Are you able
to get normal authentication going with an .htpasswd file for the same
directory?

Grisha

On Fri, 8 Feb 2002, Lewis Bergman wrote:

> I am having difficulty. I am sure the root of the problem is my own stupidity
> but after 2 days of trying I can't seem to resolve this issue. No errors
> appear in the log. It just seems to ignore my handler and shows an index of
> the directory. I assume from the manual covering this section that this might
> mean the handler is invalid, but I don't think so. I read the "food for
> thought" (the one that says the name of the file doesn't matter) paragraph
> and thought maybe this is it. I don't believe so because that is an externel
> request detail and this is an internal deal.
>
> Here is the situation:
> auth.py is set as the authen handler like so
> <Directory /var/www/html/ispmgr>
>   AddHandler python-program .py
>   PythonHandler mod_python.publisher
>   PythonAuthenHandler auth
>   AuthType Basic
>   AuthName "Restricted Area"
>   require valid-user
>   PythonDebug On
> </Directory>
>
> As you can see I am trying to use the publisher.
>
> auth.py looks like this:
> from mod_python import apache
> def authenhandler(req):
> 	"""Provide the correct page for the privilege of user."""
>
> 	pw = req.get_basic_auth_pw()
> 	user = req.connection.user
> 	if user == "admin" and pw == "admin":
> 		req.add_handler("PythonHandler", "setup::admin")
> 		return apache.OK
> 	if user == "operator" and pw == "operator":
> 		req.add_handler("PythonHandler", "setup::operator")
> 		return apache.OK
> 	if user == "user" and pw == "user":
> 		req.add_handler("PythonHandler", "setup::user")
> 		return apache.OK
> 	else:
> 		return apache.HTTP_UNAUTHORIZED
>
> Later I will replace the statements with db calls (if I can ever get this
> working)
>
> I think this means it should look for the setup file, try to instantiate it
> as setup and try to invoke the method admin. I am sure my logic must be way
> off here.
> In case it is required, here is setup.py
> class setup:
>
> 	def _frame(frameLeft, frameRight):
> 		"""Sets up frames.
>
> 		frameleft and frameright will be replaced by the correct menu function.
> 		"""
> 		html = """\
> 			<html>
> 			<head>
> 				<title>ISPMgr</title>
> 				<link rel=stylesheet type="text/css" href="ispmgr.css" title="stylesheet">
> 			</head>
> 			<frameset cols="20%%,*">
> 				<frame src="%s" name="menu">
> 				<frame src="%s" name="main">
> 			</frameset>"""% (frameLeft, frameRight)
>
> 		return html
>
>
> 	def admin():
> 		"""Provide all options to admin users."""
> 		r = _frame('menu.admin', 'main.customer')
> 		return r
>
> Do all the handlers have to appear in the same file? (auth.py)
> Lost and hopeless, please help.
> --
> Lewis Bergman
> Texas Communications
> 4309 Maple St.
> Abilene, TX 79602-8044
> 915-695-6962 ext 115
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From lbergman at abi.tconline.net  Wed Feb 13 11:21:34 2002
From: lbergman at abi.tconline.net (Lewis Bergman)
Date: Fri Jan  9 21:46:37 2004
Subject: [mod_python] web app framework suggestions?
Message-ID: <200202131721.g1DHLYa31858@lewis.abi.tconline.net>

I have read the manual about a dozen times now.
I think I understand some of what seem to me to be subtleties about 
mod_python. Not to bore anyone but to make sure I do here is what I see that 
has given me the most problems:

mod_python will not directly run a class - I know this is in the manual but I 
didn't catch on to a module being the same thing as a class for some reason. 
I remember something about security about this in the manual so we won't go 
on about inconvenience here.

mod_python will run a class from inside a standard python file or function.

The standard method of linking is to add the current files name to any linked 
argument. - I really had a hard time with this one. I remember the manual 
stating that it adds the current file to the path but I didn't think it was 
talking about this. Meaning that if I want to jump to another file (say 
new.py) from current.py I have to code the entire docroot in so that 
current.py is not appended. a small deal but still took some getting used to. 
I guess you have to default to something huh?

So I guess the question is..
Is there a recommended way to build a semi largish app with mod_python?

Maybe use standard files with functions to front end classes that generate 
pages based on how the classes/methods are called?

I am using this to build a web front end to an ISP package that controls 
billing/activation of customers on linux servers. Many of the tasks will be 
the same for a lot of different system users. For example; An ISP admin will 
need to add customers, just like a agent will. A user, agent, and admin will 
all most likely need to change a user password or username at some point.

So... how best to break these functional areas down. I am leaning to wards 
(and have started coding) classes to generate HTML like forms, results of db 
queries, simple info display, menu generation. I am also thinking of classes 
to do the queries, and such. i am finished with all the classes to do the 
actual system changes (which I thought would be the hard part, I was wrong)

Does this sound reasonable? Is there a better way?

Forgive me for stupid questions but I am pretty new to python, its OO ways,  
and a mod_python baby. I have done a lot of web coding in php but decided on 
python for this because of the scale of it. PHP for all its pluses is only 
faking OO and doesn't seem to scale very well. Namespace can drive you crazy 
on it! I am trying to make this app 100% python because I think in the long 
haul I believe it will be more maintainable.

Any advice would be appreciated.
-- 
Lewis Bergman
Texas Communications
4309 Maple St.
Abilene, TX 79602-8044
915-695-6962 ext 115

From grisha at modpython.org  Wed Feb 13 13:03:20 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:37 2004
Subject: [mod_python] web app framework suggestions?
In-Reply-To: <200202131721.g1DHLYa31858@lewis.abi.tconline.net>
Message-ID: <Pine.BSF.4.32.0202131257070.95676-100000@localhost>

On Wed, 13 Feb 2002, Lewis Bergman wrote:

> mod_python will not directly run a class - I know this is in the manual but I
> didn't catch on to a module being the same thing as a class for some reason.
> I remember something about security about this in the manual so we won't go
> on about inconvenience here.

Not sure what you mean by "running a class", mod_python will instantiate a
class if you specify it as part of a handler. I personally don't see any
value in using class methods as handlers.

Anyway, have you tried using the Publisher standard handler?

Grisha



From tree at basistech.com  Wed Feb 13 13:09:34 2002
From: tree at basistech.com (Tom Emerson)
Date: Fri Jan  9 21:46:37 2004
Subject: [mod_python] web app framework suggestions?
In-Reply-To: <Pine.BSF.4.32.0202131257070.95676-100000@localhost>
References: <200202131721.g1DHLYa31858@lewis.abi.tconline.net>
	<Pine.BSF.4.32.0202131257070.95676-100000@localhost>
Message-ID: <15466.43998.599001.798368@magrathea.basistech.com>

> 
> Anyway, have you tried using the Publisher standard handler?
> 

Indeed. I have had great success using Publisher in conjunction with
AHTS (http://ahts.sf.net) for making sites. Publisher handles dispatch
for me, and AHTS provides me with a good templating mechanism that
allows me to use an MVC model for the apps.

    -tree

-- 
Tom Emerson                                          Basis Technology Corp.
Sr. Computational Linguist                         http://www.basistech.com
  "Beware the lollipop of mediocrity: lick it once and you suck forever"

From cc at carlc.com  Wed Feb 13 14:40:57 2002
From: cc at carlc.com (Carl C.)
Date: Fri Jan  9 21:46:37 2004
Subject: [mod_python] Compiling a DSO module for RedHat Linux on ALPHA 64bit.
Message-ID: <003d01c1b4c6$5bc3fde0$13942c0a@fhpmfg.com>

Hi everyone,

    I'm fairly new to Python and I'm trying to setup the DSO module to use
with an Alpha (64bit) based RedHat 7.1 system.

    I have the following installed as RPMs:

apache-1.3.22-1.7.1
apache-devel-1.3.22-1.7.1

    I've installed Python 2.2 as two different directories:

/usr/src/Python-2.2
/usr/src/Python-2.2-no-threads

    Python 2.2 is compiled as:

./configure --exec-prefix=/usr
make
make test
make install

    and is installed in the system.

    I created the required no-threads version under Python-2.2-nothreads as:

./configure --exec-prefix=/usr --with-threads=no
make
    (did NOT do install, as its just for the mod_python module).

    I then created my mod_python under mod_python-2.7.6 as:

./configure --with-apxs=/usr/sbin/apxs --with-python=/usr/src/Python-2.2-no-threads

    I had to edit the Makefile to get the compileall.py to work:

/usr/src/Python-2.2-no-threads/Lib/compileall.py  (it was ($LIB)/compileall.py).

    I do get a mod_python.so in the proper area and everything does seem to 
build alright. The problem is when I go to start HTTPD with the the
mod_python.so installed (yes, its the first module).

Starting httpd: Syntax error on line 205 of /etc/httpd/conf/httpd.conf:
Cannot load /etc/httpd/modules/mod_python.so into server: /etc/httpd/modules/mod
_python.so: undefined symbol: openpty
[FAILED]
 
    So, I start looking in Python-2.2-no-threads's config files to see where openpty
is coming from:

configure:4873: gcc -o conftest -g -O2   conftest.c -ldl  1>&5
/tmp/ccudvDyk.o: In function `main':
/usr/src/Python-2.2-no-threads/configure:4867: undefined reference to `_getpty'
/usr/src/Python-2.2-no-threads/configure:4867: undefined reference to `_getpty'
collect2: ld returned 1 exit status
configure: failed program was:
#line 4850 "configure"
#include "confdefs.h"
/* System header to define __stub macros and hopefully few prototypes,
    which can conflict with char _getpty(); below.  */
#include <assert.h>
/* Override any gcc2 internal prototype to avoid an error.  */
/* We use char because int might match the return type of a gcc2
    builtin and then its argument prototype would still apply.  */
char _getpty();

int main() {

/* The GNU C library defines this for functions which it implements
    to always fail with ENOSYS.  Some functions are actually named
    something starting with __ and the normal name is an alias.  */
#if defined (__stub__getpty) || defined (__stub____getpty)
choke me
#else
_getpty();
#endif

; return 0; }
configure:4845: checking for getpriority
configure:4873: gcc -o conftest -g -O2   conftest.c -ldl  1>&5
configure:4903: checking for openpty
configure:4931: gcc -o conftest -g -O2   conftest.c -ldl  1>&5
/tmp/ccgNnz9F.o: In function `main':
/usr/src/Python-2.2-no-threads/configure:4925: undefined reference to `openpty'
/usr/src/Python-2.2-no-threads/configure:4925: undefined reference to `openpty'
collect2: ld returned 1 exit status
configure: failed program was:
#line 4908 "configure"
#include "confdefs.h"
/* System header to define __stub macros and hopefully few prototypes,
    which can conflict with char openpty(); below.  */
#include <assert.h>
/* Override any gcc2 internal prototype to avoid an error.  */
/* We use char because int might match the return type of a gcc2
    builtin and then its argument prototype would still apply.  */
char openpty();

int main() {

/* The GNU C library defines this for functions which it implements
    to always fail with ENOSYS.  Some functions are actually named
    something starting with __ and the normal name is an alias.  */
#if defined (__stub_openpty) || defined (__stub___openpty)
choke me
#else
openpty();
#endif

; return 0; }
configure:4953: checking for openpty in -lutil
configure:4972: gcc -o conftest -g -O2   conftest.c -lutil  -ldl  1>&5


So, it appears that it finds it in the util library... But it can't load into
apache???

Anyone else have this problem??? Or have a fix???
Thanks,
Carl
====================
http://www.carlc.com/

      "Price, Performance, Quality. Choose any two you like."


From cc at carlc.com  Wed Feb 13 15:29:35 2002
From: cc at carlc.com (Carl C.)
Date: Fri Jan  9 21:46:37 2004
Subject: [mod_python] Compiling a DSO module for RedHat Linux on ALPHA 64bit.
Message-ID: <005a01c1b4cd$26ea9e10$13942c0a@fhpmfg.com>

----- Original Message ----- 
From: "Carl C." <cc@carlc.com>
Subject: Re: [mod_python] Compiling a DSO module for RedHat Linux on ALPHA 64bit.


Guess, what... I FIXED IT...
 
 I had to edit the mod_python's src/Makefile and change the 
 
 LIBS=-lm  /usr/src/Python-2.2-no-threads/libpython2.2.a
 
 to 
 
 LIBS=-lm  /usr/src/Python-2.2-no-threads/libpython2.2.a -lutil
 
 That -lutil was the magic!
Carl
 
 ====================
 http://www.carlc.com/
 
       "Price, Performance, Quality. Choose any two you like."



From matt at proweb.co.uk  Thu Feb 14 00:26:27 2002
From: matt at proweb.co.uk (Matt H)
Date: Fri Jan  9 21:46:38 2004
Subject: [mod_python] just a hello
Message-ID: <20020214002627.3dfa8dfe.matt@proweb.co.uk>

hi mod_pythoners

hello from a new recruit, hopefully saved from the world of mod_perl and
the gradual weaning away from PHP

my ultimate aim is to do away with Apache and replicate the web server
side in a plan9 fileserver but providing the same API in order to move the
combination on to plan9 which has Python 2.2 but no Apache (and no real
need for porting Apache, other OS's are already better served for that).
That's the journey I'm planning but it's the travelling I'm
looking forward to.

Here goes with my opening question,

how does one gain access to the other provided objects :

the Server object is described as :

The request object is a Python mapping to the Apache request_rec structure. The server structure describes the server (possibly virtual server) serving the request. 

I can see that the request object arrives in my namespace as part of the handler

def handler(request) :
	pass


where can get the server object from to access it's members & methods

TIA

Matt

From matt at proweb.co.uk  Thu Feb 14 00:30:08 2002
From: matt at proweb.co.uk (Matt H)
Date: Fri Jan  9 21:46:38 2004
Subject: [mod_python] hehe I found it
Message-ID: <20020214003008.1d8c582a.matt@proweb.co.uk>

doh

request.server

I was looking for a method 

From djc at object-craft.com.au  Thu Feb 14 19:28:30 2002
From: djc at object-craft.com.au (Dave Cole)
Date: Fri Jan  9 21:46:38 2004
Subject: [mod_python] web app framework suggestions?
In-Reply-To: <200202131721.g1DHLYa31858@lewis.abi.tconline.net>
References: <200202131721.g1DHLYa31858@lewis.abi.tconline.net>
Message-ID: <m3d6z8a2mp.fsf@ferret.object-craft.com.au>

>>>>> "Lewis" == Lewis Bergman <lbergman@abi.tconline.net> writes:

Lewis> So I guess the question is..  Is there a recommended way to
Lewis> build a semi largish app with mod_python?

You could do worse than have a look at our Albatross toolkit.

   http://www.object-craft.com.au/projects/albatross/

Lewis> I am using this to build a web front end to an ISP package that
Lewis> controls billing/activation of customers on linux servers. Many
Lewis> of the tasks will be the same for a lot of different system
Lewis> users. For example; An ISP admin will need to add customers,
Lewis> just like a agent will. A user, agent, and admin will all most
Lewis> likely need to change a user password or username at some
Lewis> point.

Lewis> So... how best to break these functional areas down. I am
Lewis> leaning to wards (and have started coding) classes to generate
Lewis> HTML like forms, results of db queries, simple info display,
Lewis> menu generation. I am also thinking of classes to do the
Lewis> queries, and such. i am finished with all the classes to do the
Lewis> actual system changes (which I thought would be the hard part,
Lewis> I was wrong)

The approach which we think makes the most sense if to separate the
presentation from the implementation.  This allows you to do things
like unit test the stuff which changes your data and implements the
business logic.

Lewis> Does this sound reasonable? Is there a better way?

It depends on your preferred way of working.

Lewis> Forgive me for stupid questions but I am pretty new to python,
Lewis> its OO ways, and a mod_python baby. I have done a lot of web
Lewis> coding in php but decided on python for this because of the
Lewis> scale of it. PHP for all its pluses is only faking OO and
Lewis> doesn't seem to scale very well. Namespace can drive you crazy
Lewis> on it! I am trying to make this app 100% python because I think
Lewis> in the long haul I believe it will be more maintainable.

Quite a few things in Albatross were inspired by PHP.  If you have a
look at our toolkit you might feel partially at home.

We are hoping to release 0.06 next week along with a mailing list...

    https://www.object-craft.com.au/cgi-bin/mailman/listinfo/albatross-users

We might even build a new certificate by then too :-)

- Dave

-- 
http://www.object-craft.com.au


From aaronf at telusplanet.net  Thu Feb 14 18:45:49 2002
From: aaronf at telusplanet.net (Aaron Fransen)
Date: Fri Jan  9 21:46:38 2004
Subject: [mod_python] Re: web app framework suggestions?
Message-ID: <20020215014535.WPCW4620.priv-edtnes15-hme0.telusplanet.net@www.benedictclan.com>




I have a feeling this reply will show up in HTML format only, so my apologies to the group...

Regarding a web app, I think you hit it right on the head. I've use the publisher app and a single module to front an entire application, in fact applications: My first crack at Python is a web-based mail client (http://gomail.dynu.com) which is coming along nicely, and supports groups calendars etc., but for a mail client it was a lot more work than I thought it was going to be!

By comparison, the e-commerce site I created for my employer was simple, but it used the same techniques. In all, each app uses about a dozen separate modules of my own, with two of those being class collections for various functions (ie. html specs, database connectivity).

Now, I never learned Perl or C/C++, but I'm a VB developer since v1.0, and developing a web app in VB was positively painful in comparison. mod_python's a bear to get going the first time, but man, is it stable once it's up and running. If I ever go back to Microsoft, it'll only be to do Python.NET.

Aaron Fransen.

On Feb 14, 2002, Lewis Bergman wrote:

Re: web app framework suggestions? 

I have read the manual about a dozen times now. 
I think I understand some of what seem to me to be subtleties about 
mod_python. Not to bore anyone but to make sure I do here is what I see that 
has given me the most problems: 

mod_python will not directly run a class - I know this is in the manual but I 
didn't catch on to a module being the same thing as a class for some reason. 
I remember something about security about this in the manual so we won't go 
on about inconvenience here. 

mod_python will run a class from inside a standard python file or function. 

The standard method of linking is to add the current files name to any linked 
argument. - I really had a hard time with this one. I remember the manual 
stating that it adds the current file to the path but I didn't think it was 
talking about this. Meaning that if I want to jump to another file (say 
new.py) from current.py I have to code the entire docroot in so that 
current.py is not appended. a small deal but still took some getting used to. 
I guess you have to default to something huh? 

So I guess the question is.. 
Is there a recommended way to build a semi largish app with mod_python? 

Maybe use standard files with functions to front end classes that generate 
pages based on how the classes/methods are called? 

I am using this to build a web front end to an ISP package that controls 
billing/activation of customers on linux servers. Many of the tasks will be 
the same for a lot of different system users. For example; An ISP admin will 
need to add customers, just like a agent will. A user, agent, and admin will 
all most likely need to change a user password or username at some point. 

So... how best to break these functional areas down. I am leaning to wards 
(and have started coding) classes to generate HTML like forms, results of db 
queries, simple info display, menu generation. I am also thinking of classes 
to do the queries, and such. i am finished with all the classes to do the 
actual system changes (which I thought would be the hard part, I was wrong) 

Does this sound reasonable? Is there a better way? 

Forgive me for stupid questions but I am pretty new to python, its OO ways,   
and a mod_python baby. I have done a lot of web coding in php but decided on 
python for this because of the scale of it. PHP for all its pluses is only 
faking OO and doesn't seem to scale very well. Namespace can drive you crazy 
on it! I am trying to make this app 100\% python because I think in the long 
haul I believe it will be more maintainable. 

Any advice would be appreciated. 
-- 
Lewis Bergman 
Texas Communications 
4309 Maple St. 
Abilene, TX 79602-8044 
915-695-6962 ext 115 


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020214/497d1be7/attachment.htm
From dustin at ywlcs.org  Sat Feb 16 10:24:37 2002
From: dustin at ywlcs.org (Dustin Mitchell)
Date: Fri Jan  9 21:46:38 2004
Subject: [mod_python] More ugly "make_obcallback returned no obCallBack!" errors.
Message-ID: <20020216162436.GC14969@eleanor.internal.ywlcs.org>

These don't seem to have anything to do with bad paths.  Here's the situation:

I have two name-based virtualhosts, each using mod_python.  They both use a
number of handlers.  Here are the relevant directives in the httpd.conf for
each vhost:

  PythonAutoReload Off
  PythonDebug on
  PythonTransHandler handlers.translate::transhandler
  PythonHeaderParserHandler handlers.headers::cookies
  PythonHeaderParserHandler handlers.headers::formdata handlers.headers::login
  PythonAuthenHandler handlers.auth::check
  PythonLogHandler handlers.log::log

I'm using Apache/1.3.22 (Unix) PHP/4.1.1 mod_python/2.7.6 Python/2.1
mod_ssl/2.8.5 OpenSSL/0.9.6.

So here's what happens:  Each Apache "server" (i.e., operating system
process, as differentiated by PIDs) only seems to be able to serve one of the
two virtualhosts -- the other virtualhost will present "Internal Server
Error" with the logs listing errors importing modules for make_obcallback,
and the infamous "make_obcallback returned no obCallBack!" error.

From grisha at modpython.org  Sat Feb 16 13:14:47 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:38 2004
Subject: [mod_python] More ugly "make_obcallback returned no obCallBack!"
 errors.
In-Reply-To: <20020216162436.GC14969@eleanor.internal.ywlcs.org>
Message-ID: <Pine.BSF.4.32.0202161312001.67126-100000@localhost>

This looks like a bug, I'll have to take a look at it later.

As dirty work-around, try forcing the interpreter name by putting

PythonIntepreter my_interpreter

in the config at the top level (i.e. outside virtual servers)

This will, of course, make the virtual servers run in the same
interpreter, but it might solve the immediate problem, as I supsect it is
something with subinterpreters...

Grisha

On Sat, 16 Feb 2002, Dustin Mitchell wrote:

> These don't seem to have anything to do with bad paths.  Here's the situation:
>
> I have two name-based virtualhosts, each using mod_python.  They both use a
> number of handlers.  Here are the relevant directives in the httpd.conf for
> each vhost:
>
>   PythonAutoReload Off
>   PythonDebug on
>   PythonTransHandler handlers.translate::transhandler
>   PythonHeaderParserHandler handlers.headers::cookies
>   PythonHeaderParserHandler handlers.headers::formdata handlers.headers::login
>   PythonAuthenHandler handlers.auth::check
>   PythonLogHandler handlers.log::log
>
> I'm using Apache/1.3.22 (Unix) PHP/4.1.1 mod_python/2.7.6 Python/2.1
> mod_ssl/2.8.5 OpenSSL/0.9.6.
>
> So here's what happens:  Each Apache "server" (i.e., operating system
> process, as differentiated by PIDs) only seems to be able to serve one of the
> two virtualhosts -- the other virtualhost will present "Internal Server
> Error" with the logs listing errors importing modules for make_obcallback,
> and the infamous "make_obcallback returned no obCallBack!" error.
>
> >From the perspective of a single "server" (checked by setting
> MaxSpareServers, MinSpareServers, and StartServers to 1), it can load
> virtualhost A as many times as it would like.  Once a request comes in for
> virtualhost B, however, obCallBack problems occur.  It doesn't matter which
> virtualhost is loaded first -- it will be successful, and the second
> virtualhost will not.
>
> I've tried some tricks to see exactly what the Python exception is when
> mod_python can't load 'apache', but I'm not an extension-writer, and my
> feeble attempts produced only segfaults.
>
> WITH_THREAD is not set.
>
> Any ideas?
>
> Dustin
>
> --
>
>   Dustin Mitchell
>   dustin@ywlcs.org
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From grisha at modpython.org  Sat Feb 16 14:22:37 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:38 2004
Subject: [mod_python] Shameless mod_python market analysis
Message-ID: <Pine.BSF.4.32.0202161412050.67806-100000@localhost>

Excuse my off-topic sobject, but I am interested in getting some
information:

Do you or your bosses sometimes wish that there was a place they could go
to get consulting on running your (high-volume reliable and redundand)
website, including (but not limited to) mod_python support?

If yes, then is the need strong enough that you would actually be willing
to *pay* for such consulting?

We are considering starting a company that would specialize in this sort
of thing to help keep alive and promote mod_python better, and I would
appreciate an opinion from the list subscribers. The idea is that I and a
few other developers could actually make some money working on it and
thereby be able to allot much more time for it.

Thanks,

Grisha


From brieu.daniel at wanadoo.fr  Sun Feb 17 11:12:25 2002
From: brieu.daniel at wanadoo.fr (Daniel Brieu)
Date: Fri Jan  9 21:46:38 2004
Subject: [mod_python] python's directives in httpd.conf
Message-ID: <006b01c1b79b$99386b70$548080d9@jany>

Hi, 
Sorry, but I'm a french newbie and didn't managed to find an answer to my question in the mailing-list archive :

I managed to run mptest.py ("Hello World" of official doc) with Apache win32 but I don't manage to run the others python scripts :
When I run the other python scripts, my browser show me "hello world"...the same result than mptest.py !!

I think I must add or modify other apache python's directives. So 
- I woud like to get a good httpd.conf for Apache win32 and Python module which works.
- some information about the "standard" headers of python scripts running in Apache web server.
- Some examples of python scripts running in Apache web server.

thanks a lot !
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020217/d804756c/attachment.htm
From modpython at xhaus.com  Sun Feb 17 07:36:32 2002
From: modpython at xhaus.com (Alan Kennedy)
Date: Fri Jan  9 21:46:38 2004
Subject: [mod_python] python's directives in httpd.conf
Message-ID: <200202171247.HAA139374@spool2.valueweb.net>

Daniel,

> I managed to run mptest.py ("Hello World" of official
> doc) with Apache win32 but I don't manage to run the
> others python scripts :
> When I run the other python scripts, my browser show
> me "hello world"...the same result than mptest.py !!

The answer to this question depends on your configuration. 
If your configuration looks something like this

<Directory "/some/directory/">
    AddHandler python-program .py
    PythonHandler mptest
</Directory>

Then what you're telling Apache is "Run mptest.py whenever 
anyone requests a URI in the directory "/some/directory" 
which has the extension ".py". So *all* of the following 
URIs result in the same call to the "handler" function 
of "mptest.py".

http://someserver.com/some/directory/mptest.py
http://someserver.com/some/directory/anotherscript.py
http://someserver.com/some/directory/theScriptNameDoesNotMat
ter.py

The important section of the manual to understand is 
section 3.2: So what Exactly does Mod-python do? 

http://www.modpython.org/live/mod_python-2.7.6/doc-html/tut-
what-it-do.html

In particular, you must understand the section at the 
bottom called "Some food for thought".

> I think I must add or modify other apache python's 
directives. So 
> - I woud like to get a good httpd.conf for Apache win32 
and Python
> module which works.

"Works" is a relative thing. "Works" for what purpose is 
more the right question to ask. I've found that the bare 
minimum changes to a httpd.conf for mod_python are two 
changes, 

1. to load the modpython module, and 
2. to set up a handler module/function. 

These are handled as follows

1. Start with a clean httpd.conf from the Apache 
installation, and add the following entries.

LoadModule python_module modules/mod_python.{dll|so}

There should be a list of "LoadModule"s in the default 
httpd.conf, just put it with them. Probably best to put it 
before any other "LoadModule".

Then add a python handler for whichever directories you 
wish. The following directive indicates that 
myPythonHandler.py should be run whenever any URI ending 
in ".py" is requested anywhere in the document tree.

<Directory /my/document/root/>
   AddHandler python-program .py
   PythonHandler myPythonHandler
</Directory>

So whenever a request arrives for any URI ending in ".py", 
anywhere in the document hierarchy, at any level, then 
the "handler" function in the module "myPythonHandler.py" 
will be run. 

> - some information about the "standard" headers of python 
scripts
> running in Apache web server.

I'm not sure what you mean by "headers". This is not CGI, 
so you don't need shebang lines, or anything like that. The 
only headers you need to know about are the HTTP headers 
sent back with each http response, such as "Content-
type", "Content-length", "Content-encoding", and so on. 
These are set in your handler function as follows

def	handler(req):
	req.content_type = "text/html"
	req.headers_out['Content-Length'] = str(length)

Hopefully this well help you get configured and running.

Bon chance,

Alan.


---------------------------------------------
This message was sent using WebMail by CyberGate.
http://www.gate.net/webmail



From balld at webslingerZ.com  Tue Feb 19 17:16:29 2002
From: balld at webslingerZ.com (Donald Ball)
Date: Fri Jan  9 21:46:38 2004
Subject: [mod_python] -DEAPI support in configure?
Message-ID: <Pine.LNX.4.33L2.0202191711240.1670-100000@localhost.localdomain>

i use mod_python as a DSO in an apache httpd + mod_ssl installation. i
understand that i can compile mod_python using EAPI by manually editing
src/Makefile and adding -DEAPI to the OPT variable after configuring
mod_python. is that correct?

seems to me, though, that there ought to be a way to pass that as a
configuration option to the configure script. then i can record my
configure options in a my_configure script like i do for all of my other
daemons and not have to worry about me, or whoever comes after me,
remembering to manually edit src/Makefile afterwards. is there a way to do
that? if not, could i request that feature? i regret that i have only a
user's familiarity with autoconf and cannot patch it myself. thanks.

- donald


From lbergman at abi.tconline.net  Tue Feb 19 16:36:47 2002
From: lbergman at abi.tconline.net (Lewis Bergman)
Date: Fri Jan  9 21:46:38 2004
Subject: [mod_python] -DEAPI support in configure?
In-Reply-To: <Pine.LNX.4.33L2.0202191711240.1670-100000@localhost.localdomain>
References: <Pine.LNX.4.33L2.0202191711240.1670-100000@localhost.localdomain>
Message-ID: <200202192236.g1JMalI22476@lewis.abi.tconline.net>

> seems to me, though, that there ought to be a way to pass that as a
> configuration option to the configure script.
I'll second that.
-- 
Lewis Bergman
Texas Communications
4309 Maple St.
Abilene, TX 79602-8044
915-695-6962 ext 115

From ps0 at igmp.com.ar  Wed Feb 20 12:56:36 2002
From: ps0 at igmp.com.ar (ps0@igmp.com.ar)
Date: Fri Jan  9 21:46:38 2004
Subject: [mod_python] .pyc and .pyo bytecode files under mod_python ?
In-Reply-To: <200202201549.g1KFn1S32901@eden.ispol.com>; from mod_python-request@modpython.org on Wed, Feb 20, 2002 at 10:49:01AM -0500
References: <200202201549.g1KFn1S32901@eden.ispol.com>
Message-ID: <20020220125636.C2535@igmp.com.ar>

Hi, my question is :
 
 Could be possible execution of .pyc and .pyo files under mod_python ? how ?
 I probe adding a AddHandler python-program .pyc , but doesn't work.

 I need to run .pyc and .pyo for a specific proyect, so Im a problem if it
 can't be possible.
 
Tnks a lot.

Hector.

From grisha at modpython.org  Wed Feb 20 11:01:32 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:46:38 2004
Subject: [mod_python] .pyc and .pyo bytecode files under mod_python ?
In-Reply-To: <20020220125636.C2535@igmp.com.ar>
Message-ID: <Pine.BSF.4.32.0202201100150.33059-100000@localhost>

On Wed, 20 Feb 2002 ps0@igmp.com.ar wrote:

> Hi, my question is :
>
>  Could be possible execution of .pyc and .pyo files under mod_python ? how ?
>  I probe adding a AddHandler python-program .pyc , but doesn't work.

It should work, can you elaborate?

>  I need to run .pyc and .pyo for a specific proyect, so Im a problem if it
>  can't be possible.

Even if you specify .py, the Python interpreter will use a .pyc or .pyo if
one exists.

Grisha


From mike at mikebell.org  Wed Feb 20 13:00:13 2002
From: mike at mikebell.org (mike@mikebell.org)
Date: Fri Jan  9 21:46:38 2004
Subject: [mod_python] .pyc and .pyo bytecode files under mod_python ?
In-Reply-To: <20020220125636.C2535@igmp.com.ar>
References: <200202201549.g1KFn1S32901@eden.ispol.com> <20020220125636.C2535@igmp.com.ar>
Message-ID: <20020220210012.GW3517@mikebell.org>

On Wed, Feb 20, 2002 at 12:56:36PM -0300, ps0@igmp.com.ar wrote:
> Hi, my question is :
>  
>  Could be possible execution of .pyc and .pyo files under mod_python ? how ?
>  I probe adding a AddHandler python-program .pyc , but doesn't work.
> 
>  I need to run .pyc and .pyo for a specific proyect, so Im a problem if it
>  can't be possible.

.pyc files should be created automatically, all you need to do is insure
that the directory from which your mod_python scripts are being run is
writable to your web server, otherwise it cannot create the .pyc files.
Setting PythonOptimize to on will result in the creation of .pyo files.

From dustin at ywlcs.org  Wed Feb 20 16:26:15 2002
From: dustin at ywlcs.org (Dustin Mitchell)
Date: Fri Jan  9 21:46:38 2004
Subject: [mod_python] .pyc and .pyo bytecode files under mod_python ?
In-Reply-To: <20020220210012.GW3517@mikebell.org>
References: <200202201549.g1KFn1S32901@eden.ispol.com> <20020220125636.C2535@igmp.com.ar> <20020220210012.GW3517@mikebell.org>
Message-ID: <20020220222615.GG14969@eleanor.internal.ywlcs.org>

On Wed, Feb 20, 2002 at 01:00:13PM -0800, mike@mikebell.org wrote:
> .pyc files should be created automatically, all you need to do is insure
> that the directory from which your mod_python scripts are being run is
> writable to your web server, otherwise it cannot create the .pyc files.
> Setting PythonOptimize to on will result in the creation of .pyo files.

Be **very** careful if you do this -- the security implications of allowing
write access to your source files are pretty enormous.  For example, if
someone can write a file to your system (perhaps through a bug in a
file-upload system?), they can upload their own program to do whatever damage
they would like.

My approach to .pyo/c files has been to run a short script that uses the
Python compile module to compile all of the source files in the site.  Since
I run the script as me (not as the user running the web server) all of the
.pyo/c files are owned by me and not writeable by the web server.

My $0.02.

Dustin

-- 

  Dustin Mitchell
  dustin@ywlcs.org

From mike at mikebell.org  Wed Feb 20 14:51:42 2002
From: mike at mikebell.org (mike@mikebell.org)
Date: Fri Jan  9 21:46:38 2004
Subject: [mod_python] .pyc and .pyo bytecode files under mod_python ?
In-Reply-To: <20020220222615.GG14969@eleanor.internal.ywlcs.org>
References: <200202201549.g1KFn1S32901@eden.ispol.com> <20020220125636.C2535@igmp.com.ar> <20020220210012.GW3517@mikebell.org> <20020220222615.GG14969@eleanor.internal.ywlcs.org>
Message-ID: <20020220225142.GY3517@mikebell.org>

On Wed, Feb 20, 2002 at 04:26:15PM -0600, Dustin Mitchell wrote:
> Be **very** careful if you do this -- the security implications of allowing
> write access to your source files are pretty enormous.  For example, if
> someone can write a file to your system (perhaps through a bug in a
> file-upload system?), they can upload their own program to do whatever damage
> they would like.

Well, you can still have the programs within the writable directory owned by
someone else and only readable by the web server's UID, however this still
allows one to upload bad .pyo files. I'm not sure whether python has any
checks other than mtime but I imagine one could do /something/ malicious in
this manner.

From ps0 at igmp.com.ar  Thu Feb 21 17:55:52 2002
From: ps0 at igmp.com.ar (ps0@igmp.com.ar)
Date: Fri Jan  9 21:46:38 2004
Subject: [mod_python] .pyc and .pyo bytecode files under mod_python ?
In-Reply-To: <20020220225142.GY3517@mikebell.org>; from mike@mikebell.org on Wed, Feb 20, 2002 at 02:51:42PM -0800
References: <200202201549.g1KFn1S32901@eden.ispol.com> <20020220125636.C2535@igmp.com.ar> <20020220210012.GW3517@mikebell.org> <20020220222615.GG14969@eleanor.internal.ywlcs.org> <20020220225142.GY3517@mikebell.org>
Message-ID: <20020221175551.A5599@igmp.com.ar>

I think we are in a confusion , I will explain my problem more deep with a
simple real example :

I need : 1) Build a web aplication in python
         2) Buy this application to a client
	 3) I don't want the client has the source code of the .py files so
	    i need to include ONLY .pyc or .pyo bytecode files on that 
	    aplication, I know the blah blah about the posibility of decompile
	    .pyc and .pyo files but the client is too stupid to do that.

So , In my test lab I mount a apache+mod_python with this configuration :

http.conf :

[.......]
<Directory /var/www/test2>
AddHandler puthon-program .pyc
PythonHandler mod_python.publisher
PythonDebug On
</Directory>
[........]

Contents of the /var/www/test2 dir :

-rwxr-xr-x  1 www-data www-data 186 hello.pyc

and I try this :

links http://localhost/test2/hello/say

And obtain this :

Forbidden
You don't have permission to access /test2/hello/hello.py on this server

The contents of hello.py ( not compiled and in another directory ) :

def say(req):
 req.content_type="text/plain"
 req.send_http_header()
 s="HELLO WORLD !"
 return s
 
 
 If I try via the usual method ( using .py file and 
 AddHandler puthon-program .py , works pefect.
 

Tnks a lot !

From ps0 at igmp.com.ar  Thu Feb 21 18:24:19 2002
From: ps0 at igmp.com.ar (ps0@igmp.com.ar)
Date: Fri Jan  9 21:46:38 2004
Subject: [mod_python] .pyc and .pyo files my faulf thread terminated
Message-ID: <20020221182419.A23910@igmp.com.ar>

Sorry about my stupid question , was my fault , There was 2 problems :

1) A permission problems
2) I was compiled .pyc files with an different version of Python that the
   mod_python work.

Now, all .pyc and .pyo files are executed perfectly !

Tnks to all that help to solve my problem.

Best Regards.

Hector.

From stephen_m_mcallister at hotmail.com  Fri Feb 22 18:45:22 2002
From: stephen_m_mcallister at hotmail.com (Stephen M. McAllister)
Date: Fri Jan  9 21:46:38 2004
Subject: [mod_python] Newbie question for mod_perl, Apache and ActivePython on Win32
Message-ID: <OE25jrhwm5Tfv2ZAdYR000177cc@hotmail.com>

I am trying to install and config mod_perl on a Win2k/SP2 server running the
latest Apache V1.3.23 and ActiveState ActivePython V2.1 <groan>. I read lot
of posts and FAQ's and I am still confused. The modperl.org Windows Appendix
A is totally inadequate. I still get the following error while trying to
load the mod_python in my environment.

httpd.conf snippet ==>  LoadModule python_module modules/mod_python.dll

Causes error when starting Apache => "Syntax error on line 195 of
c:/apache/apache/conf/httpd.conf:
Cannot load c:/apache/apache/modules/mod_python.dll into server: (126) The
specified module could not be found:"


I tried a number of things and got nowhere.

So my questions for trying to get Python running on Win2k with Active State
Python are:
----------------------------------------------------------------------------
-------------
1. What version of Apache for Win32 should I be running?
2. What version of ActiveState Python should I be running?
3. What version of mod_perl should I be running?
4. How can I debug what is going on so I can catch misconfigurations?
5. Does PYTHONPATH matter at all for mod_python? (mine is not set as a path
var, but is set in the registry)
6. How is it that mod_perl knows what Python interpreter to use? Does it
read the registry or PYTHONPATH or what?

Thanks a bunch!
--Steve

From modpython at xhaus.com  Sat Feb 23 08:21:21 2002
From: modpython at xhaus.com (Alan Kennedy)
Date: Fri Jan  9 21:46:38 2004
Subject: [mod_python] Newbie question for mod_perl, Apache and ActivePython on Win32
Message-ID: <200202231332.IAA268450@spool4.valueweb.net>

> I am trying to install and config mod_perl on a Win2k/SP2
> server running the latest Apache V1.3.23 .... 

> I am still confused. The modperl.org Windows Appendix
> A is totally inadequate. 

> I still get the following error while trying to
> load the mod_python in my environment.

Sorry, you've got me confused as well. Are you trying to 
install mod_python, mod_perl or both mod_python AND 
mod_perl?

Alan.



---------------------------------------------
This message was sent using WebMail by CyberGate.
http://www.gate.net/webmail



From smcallister at msn.com  Sat Feb 23 09:06:48 2002
From: smcallister at msn.com (Stephen M. McAllister)
Date: Fri Jan  9 21:46:38 2004
Subject: [mod_python] Newbie question for mod_perl, Apache and ActivePython on Win32
References: <200202231332.IAA268450@spool4.valueweb.net>
Message-ID: <OE75RIw7eJq02aXkSHA000267d5@hotmail.com>

> > I am trying to install and config mod_perl on a Win2k/SP2
> > server running the latest Apache V1.3.23 ....
Ooops...I meant mod_python...I was in a bit of a hurry when I posted this. I
already had Apache installed and was using the ActivePython-2.1.1.msi
distribution. I want to try and use these if possible. I am trying to
understand just what versions work with what. I don't mind uninstalling
these and installing older versions or other distributions, but I wanted to
see if I can get what I currently running to work with mod_python. Should I
not be using ActiveState Python?


> > I am still confused. The modperl.org Windows Appendix
> > A is totally inadequate.
I meant the Appendix in the following link that explains how to setup
mod_python on a Windows box.
http://www.modpython.org/live/mod_python-2.7.6/doc-html/app-wininst.html


> > I still get the following error while trying to
> > load the mod_python in my environment.
I was attempting to show the line in my httpd.conf files that was causing
Apache to not start.
Commenting the line out allows Apache to start.


> Sorry, you've got me confused as well. Are you trying to
> install mod_python, mod_perl or both mod_python AND
> mod_perl?
Sorry about that....For now I just want to install and configure mod_python
in my current environment if possible. I will want to install mod_perl
later, but not for a while.

--Steve


----- Original Message -----
From: "Alan Kennedy" <modpython@xhaus.com>
To: "Stephen M. McAllister" <stephen_m_mcallister@hotmail.com>;
<mod_python@modpython.org>
Sent: Saturday, February 23, 2002 2:21 AM
Subject: Re: [mod_python] Newbie question for mod_perl, Apache and
ActivePython on Win32


> > I am trying to install and config mod_perl on a Win2k/SP2
> > server running the latest Apache V1.3.23 ....
>
> > I am still confused. The modperl.org Windows Appendix
> > A is totally inadequate.
>
> > I still get the following error while trying to
> > load the mod_python in my environment.
>
> Sorry, you've got me confused as well. Are you trying to
> install mod_python, mod_perl or both mod_python AND
> mod_perl?
>
> Alan.


From modpython at xhaus.com  Sat Feb 23 11:06:52 2002
From: modpython at xhaus.com (Alan Kennedy)
Date: Fri Jan  9 21:46:38 2004
Subject: [mod_python] Newbie question for mod_perl, Apache and ActivePython on Win32
Message-ID: <200202231618.LAA96476@spool7.valueweb.net>

> Should I not be using ActiveState Python?

Hmm, it shouldn't make much difference. Activestate still 
give you a standard command-line python interpreter, don't 
they? Namely, you can type "python.exe" on a command prompt 
and get an interactive python interpreter?

I haven't used ActivePython, so I can't give any definitive 
answers about it. But I would say that if you're concerned 
that ActivePython may be causing the problem, then you 
should switch to a standard python distribution, which you 
can get from www.python.org. I recommend version 2.1.2 or 
2.1.1.

> I meant the Appendix in the following link that explains
> how to setup mod_python on a Windows box.

Hmm, I followed those same instructions, and it all worked 
fine for me. The versions I use are

Apache 1.3.23
Python 2.1.1
Mod Python 2.7.6

All on Windows 2000 SP2.

The location where you put the "LoadModule" command in your 
httpd.conf can be significant. Try placing the "LoadModule" 
command before *all* other LoadModule commands in the 
httpd.conf and see if that makes a difference.

Also, are you certain that you're placing the file 
mod_python.dll in the correct directory. It should be in 
the "modules" subdirectory of the Apache installation, i.e. 
in the same directory as files such 
as "mod_rewrite.so", "mod_speling.so", etc.

As a tip, I always rename the mod_python.dll to contain the 
version number, i.e. mod_python276.dll so I always know 
which DLL I am using. So my LoadModule command has to refer 
to "modules/mod_python276.dll".

> I was attempting to show the line in my httpd.conf 
> files that was causing Apache to not start.
> Commenting the line out allows Apache to start.

Is there any information in the server logs as to why it 
might be failing? Check the file <apacheinst>/logs/error.log

> Sorry about that....For now I just want to install
> and configure mod_python in my current environment if
> possible. I will want to install mod_perl later, but
> not for a while.

Now what would you want to go installing mod_perl for? All 
that "executable line noise" ;-)

I'm sure you'll find that Python will easily do all that 
you need.

Only kidding about the Perl thing. But it's definitely a 
good idea to get one working first before trying to get the 
other working.

Best of luck,

Alan.



---------------------------------------------
This message was sent using WebMail by CyberGate.
http://www.gate.net/webmail



From conrad at hep.caltech.edu  Mon Feb 25 13:37:27 2002
From: conrad at hep.caltech.edu (Conrad Steenberg)
Date: Fri Jan  9 21:46:38 2004
Subject: [mod_python] Client certificate?
Message-ID: <1014673047.9352.10.camel@heppc22.cithep.caltech.edu>

Hi

I've been using mod_python for a while now, and it works great, hats of
to Grisha and the other contributors :-)

Having an SSL-enabled Apache works transparently, but it would be useful
to access some of the internals stored by the mod_ssl module.
Specifically, I'm trying to access the client certificate presented to
the server, either for logging or authentication purposes.

Is this possibly stored in a mp_table object that can be accessed?

Any ideas welcome!

Conrad

-- 
*-----------------------------------------*
| Conrad Steenberg                        |
| Caltech, Mail Code 356-48               |
| Pasadena, CA, 91125                     |
| e-mail: conrad@hep.caltech.edu          |
| Tel: (626) 395-8758                     |
*-----------------------------------------*


From bbrown at icce-t.com  Mon Feb 25 16:20:54 2002
From: bbrown at icce-t.com (Brian Brown)
Date: Fri Jan  9 21:46:39 2004
Subject: [mod_python] Compiling on MacOS X
Message-ID: <2174778112.1014679254@kelethin>

Greetings!
  I am trying to compile mod_python 2.7.6 on MacOS 10.1.3 with no success. 
I get the following:

cc: cannot specify -o with -c or -S with multiple compilations


I tried to take the -c out of the src/Makefile, but it had no effect on the 
make process... any ideas?

Brian

/-----------------
Brian Brown
ICCE Technologies, Inc.
http://www.icce-t.com

From rsalz at zolera.com  Mon Feb 25 20:52:08 2002
From: rsalz at zolera.com (Rich Salz)
Date: Fri Jan  9 21:46:39 2004
Subject: [mod_python] Client certificate?
References: <1014673047.9352.10.camel@heppc22.cithep.caltech.edu>
Message-ID: <3C7AEA48.494CF46E@zolera.com>

I am sure there are other approaches, but here is what we did.

We were already using SWIG (www.swig.org).  I added ONE function to the
the request object, get_swig_handle.  This returns a SWIG-compatible
handle to the real apache request object:
+static PyObject * req_get_swig_handle(requestobject *self, PyObject
*args)
+{
+    char ptrbuff[128];
+    SWIG_MakePtr(ptrbuff, (char *)self->request_rec, "_request_rec_p");
+    return Py_BuildValue("s", ptrbuff);
+}

Then it's pretty easy for us to write SWIG-wrapped functions that get
any mod_ssl data we want:

int
UsingSSL(request_rec* r)
{
    return ap_ctx_get(r->connection->client->ctx, "ssl") != NULL;
}


I can send more details if necessary ...
-- 
Zolera Systems, Securing web services (XML, SOAP, Signatures,
Encryption)
http://www.zolera.com

From conrad at hep.caltech.edu  Tue Feb 26 10:49:54 2002
From: conrad at hep.caltech.edu (Conrad Steenberg)
Date: Fri Jan  9 21:46:39 2004
Subject: [mod_python] Client certificate?
In-Reply-To: <3C7AEA48.494CF46E@zolera.com>
References: <1014673047.9352.10.camel@heppc22.cithep.caltech.edu> 
	<3C7AEA48.494CF46E@zolera.com>
Message-ID: <1014749396.9352.41.camel@heppc22.cithep.caltech.edu>

Hi Rich

On Mon, 2002-02-25 at 17:52, Rich Salz wrote:
> I am sure there are other approaches, but here is what we did.
> 
> We were already using SWIG (www.swig.org).  I added ONE function to the
> the request object, get_swig_handle.  This returns a SWIG-compatible
> handle to the real apache request object:
> +static PyObject * req_get_swig_handle(requestobject *self, PyObject
> *args)
> +{
> +    char ptrbuff[128];
> +    SWIG_MakePtr(ptrbuff, (char *)self->request_rec, "_request_rec_p");
> +    return Py_BuildValue("s", ptrbuff);
> +}

Just to clarify, this was done in your own apache module or a patch to
mod_python?

> 
> Then it's pretty easy for us to write SWIG-wrapped functions that get
> any mod_ssl data we want:
> 
> int
> UsingSSL(request_rec* r)
> {
>     return ap_ctx_get(r->connection->client->ctx, "ssl") != NULL;
> }
> 

And this is in your own Python module (which was also linked against
apache)?

> 
> I can send more details if necessary ...

I think my flu-fried brain would appreciate it :-)

Conrad

-- 
*-----------------------------------------*
| Conrad Steenberg                        |
| Caltech, Mail Code 356-48               |
| Pasadena, CA, 91125                     |
| e-mail: conrad@hep.caltech.edu          |
| Tel: (626) 395-8758                     |
*-----------------------------------------*


From rsalz at zolera.com  Tue Feb 26 18:38:39 2002
From: rsalz at zolera.com (Rich Salz)
Date: Fri Jan  9 21:46:39 2004
Subject: [mod_python] Client certificate?
References: <1014673047.9352.10.camel@heppc22.cithep.caltech.edu> 
		<3C7AEA48.494CF46E@zolera.com> <1014749396.9352.41.camel@heppc22.cithep.caltech.edu>
Message-ID: <3C7C1C7F.30E01AC6@zolera.com>

Okay, let me try to be more explicit.

We use SWIG (www.swig.org).  SWIG can parse header files and generate
modules for various scripting languages, including Python.  So, for
example, a SWIG interface file might say
	int UsingSSL(request_rec* r);
	char* GetClientDN(request_rec* r);
and so on.  The actual implementation of those functions tend to be
fairly short Apache ap_xxx calls, such as

int
UsingSSL(request_rec* r)
{
    return ap_ctx_get(r->connection->client->ctx, "ssl") != NULL;
}

We can create an Apache module that has our "swigged" extensions, and
build that into Apache.  (Or make it a shared library, DSO, whatever.)

The only "trick" is how to get that request_rec pointer.  It turns out
to be not that hard, because SWIG actually uses strings to represent
pointers.

So, we patched mod_python to add a new method to the mod_python request
object; this new method returns a swig-compatible pointer(string) up to
Python.  From python code, then, we can call the SWIG functions we wrote
as described above.

So, in our case,
	from zolera import pyssl
	h = req.get_swig_handle()
	if h.UsingSSL():
		dn = h.GetClientDN()
	else:
		return Apache.Unauthorized

We have found it easier (again, since we were already using SWIG), to
just add the one function to mod_python, and then to use SWIG for
everything else.

Hope this helps.
	/r$
-- 
Zolera Systems, Securing web services (XML, SOAP, Signatures,
Encryption)
http://www.zolera.com

From conrad at hep.caltech.edu  Tue Feb 26 15:40:23 2002
From: conrad at hep.caltech.edu (Conrad Steenberg)
Date: Fri Jan  9 21:46:39 2004
Subject: [mod_python] Client certificate?
In-Reply-To: <3C7C1C7F.30E01AC6@zolera.com>
References: <1014673047.9352.10.camel@heppc22.cithep.caltech.edu> 
	<3C7AEA48.494CF46E@zolera.com>
	<1014749396.9352.41.camel@heppc22.cithep.caltech.edu> 
	<3C7C1C7F.30E01AC6@zolera.com>
Message-ID: <1014766824.9347.44.camel@heppc22.cithep.caltech.edu>

Thanks, this helps clarify things.

Cheers!

Conrad

On Tue, 2002-02-26 at 15:38, Rich Salz wrote:
> Okay, let me try to be more explicit.
> 
> We use SWIG (www.swig.org).  SWIG can parse header files and generate
> modules for various scripting languages, including Python.  So, for
> example, a SWIG interface file might say
> 	int UsingSSL(request_rec* r);
> 	char* GetClientDN(request_rec* r);
> and so on.  The actual implementation of those functions tend to be
> fairly short Apache ap_xxx calls, such as
> 
> int
> UsingSSL(request_rec* r)
> {
>     return ap_ctx_get(r->connection->client->ctx, "ssl") != NULL;
> }
> 
> We can create an Apache module that has our "swigged" extensions, and
> build that into Apache.  (Or make it a shared library, DSO, whatever.)
> 
> The only "trick" is how to get that request_rec pointer.  It turns out
> to be not that hard, because SWIG actually uses strings to represent
> pointers.
> 
> So, we patched mod_python to add a new method to the mod_python request
> object; this new method returns a swig-compatible pointer(string) up to
> Python.  From python code, then, we can call the SWIG functions we wrote
> as described above.
> 
> So, in our case,
> 	from zolera import pyssl
> 	h = req.get_swig_handle()
> 	if h.UsingSSL():
> 		dn = h.GetClientDN()
> 	else:
> 		return Apache.Unauthorized
> 
> We have found it easier (again, since we were already using SWIG), to
> just add the one function to mod_python, and then to use SWIG for
> everything else.
> 
> Hope this helps.
> 	/r$
> -- 
> Zolera Systems, Securing web services (XML, SOAP, Signatures,
> Encryption)
> http://www.zolera.com
-- 
*-----------------------------------------*
| Conrad Steenberg                        |
| Caltech, Mail Code 356-48               |
| Pasadena, CA, 91125                     |
| e-mail: conrad@hep.caltech.edu          |
| Tel: (626) 395-8758                     |
*-----------------------------------------*


From unscribe127108 at yahoo.com  Tue Feb  5 17:08:47 2002
From: unscribe127108 at yahoo.com (unscribe127108@yahoo.com)
Date: Fri Jan  9 21:52:42 2004
Subject: [mod_python] Реклама Вашего проекта во всемирной глобальной сети Интернет.
Message-ID: <02822274@ghaqy>

    ?????? ????.

    ?????? ???????? ???????????? ?????????? ??????????? ?? ????? ??? ????????? 
???????????? ?????? ?????. ???????? ????? ?? ????? ???? ?????? ?? ????? ? 
????? ???????, ???? ???????? ????? ????????? ? ???, ??? ?? ???????????. ?? 
????????????? ??? ?????????? ??????????? ??????? ?? ????? ????????????? 
???????? ??? ??????????? ??????????. ???????? ????? ?? ??? ?????, ??????? 
??? ?????????, ??????? ???? ?????? ? ????????? ???, ??? ??? ?????? ??????? ??. 
?????? ???, ???? ?????????????? ???? ???????????, ?????? ? ???? ?? ?????. 
???????? ???????? ?? E-mail - ????? ??????????? ?????? ???????. ???? ???? 
? ?????? ?????? ?????????????? ???????????.

    ????? ?????? ??????? ?? ??????? ?????? ???????? ????(???? ???) ? ????????????
??????? ?? ????? ??????. ????? ?????? ???? ????? 25 ?????????.

    ??? ???????? ? ???? ??????????? ?????? ICQ. ?? ??????? ?? ??? ???? ???????.
UIN: 127108

    ?????? ???????? ??????????? ? ???????????? ? ?.4 ??.29 ??????????? ??. 
??? ??????????? ????? ??????? ?? ???????? ?????????? (????? ??????????) ?
???????????? ??? ????????? ???????? ?????????. ? ?????? ????????? ???????? 
???????????? ???????????, ???????? ?? ??? ?????? ? ???????? ? ???? "REMOVE". 
??? e-mail ????? ?????? ?? ????.



From jps at savagebeast.com  Wed Feb  6 17:31:10 2002
From: jps at savagebeast.com (Jeff Stearns)
Date: Fri Jan  9 21:52:42 2004
Subject: [mod_python] Loading the mod_python modules from somewhere other than site-packages
Message-ID: <5DC2C0CC-1B6A-11D6-A933-0030653DCC28@savagebeast.com>

Folks -

I'm installing mod_python on a Linux box which can't allow anything to 
be installed within the site-python directory.  (The reasons for that 
are slightly interesting; the box operates as a virtual machine with 
many apache servers running different software versions, and the virtual 
machines would step on each other's copy of the mod_python files.)

Thus I wish to install the handful of mod_python/*.py files in the 
user's directory, not in the system-wide site-python directory.

I am running into trouble because I can't get mod_python to look 
elsewhere for these files. It seems to be using the wired-in default 
python path.

The PythonPath directive looks tempting, but it looks like a write-only 
variable. I don't think any piece of code actually uses this value.

I'm thinking of reworking the make_obcallback() function to use the 
value of PythonPath by poking it into sys.path before importing the 
mod_python modules.

Does this seem like the right strategy?  Is make_obcallback the right 
place to do this?  (I tried running apache -X under gdb to get a better 
idea of how apache and mod_python interact, but there's some problem 
with gad that's preventing me from using it at all here, alas.)

thx for your advice!

-jeff stearns


From thanos at 0x01.com  Thu Feb  7 15:32:57 2002
From: thanos at 0x01.com (thanos@0x01.com)
Date: Fri Jan  9 21:52:42 2004
Subject: [mod_python] MySQL
Message-ID: <20020207203257.19753.qmail@0x01.com>

Has any one had MySQL expiriences ? 

When using cgi's we have exprienced no problems, but the following script 
will often break.

from mod_python import apache

def handler(req):
        import MySQLdb
        req.send_http_header()
        req.write("importd MySQLdb hello world")
        return apache.OK



I think on its first time the httpd execurtes this handler without any outward problems, but on the second time round:

Mod_python error: "PythonHandler testmysql"

Traceback (most recent call last):

  File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line 181, in Dispatch
    module = import_module(module_name, _req)

  File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line 356, in import_module
    if os.path.exists(filepath[:-1]) :

  File "/usr/local/lib/python2.1/posixpath.py", line 171, in exists
    st = os.stat(path)

OSError: [Errno 2] No such file or directory: '/usr/home/thanos/public_html/pso/tests/testmsql/testmysql.p'



You can try it out at:

http://www.0x01.com/~thanos/pso/tests/testmsql/mptest.py

Moving the import statement outside the handler will make the handle break every time. I guess this is some sort of clue. 

Any help would be great

thanks

thanos.






From alain at onesite.org  Fri Feb  8 01:01:58 2002
From: alain at onesite.org (Alain Tesio)
Date: Fri Jan  9 21:52:42 2004
Subject: [mod_python] MySQL
In-Reply-To: <20020207203257.19753.qmail@0x01.com>
References: <20020207203257.19753.qmail@0x01.com>
Message-ID: <20020208010158.7f1cf0ae.alain@onesite.org>

On Thu, 7 Feb 2002 15:32:57 -0500 (EST)
thanos@0x01.com wrote:

> OSError: [Errno 2] No such file or directory: > '/usr/home/thanos/public_html/pso/tests/testmsql/testmysql.p'

Hi, I knew I had already seen this problem, this may help:

http://www.modpython.org/pipermail/mod_python/2001-July/001478.html

Alain




From grisha at modpython.org  Thu Feb  7 19:24:52 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:42 2004
Subject: [mod_python] MySQL
In-Reply-To: <20020208010158.7f1cf0ae.alain@onesite.org>
Message-ID: <Pine.BSF.4.32.0202071923260.40345-100000@localhost>

On Fri, 8 Feb 2002, Alain Tesio wrote:

> Hi, I knew I had already seen this problem, this may help:
>
> http://www.modpython.org/pipermail/mod_python/2001-July/001478.html


That post has the wrong answer, the right answer is here:

http://www.modpython.org/FAQ/faqw.py?req=all#2.3

Grisha



From lbergman at abi.tconline.net  Fri Feb  8 11:40:15 2002
From: lbergman at abi.tconline.net (Lewis Bergman)
Date: Fri Jan  9 21:52:42 2004
Subject: [mod_python] confused about add_handler
Message-ID: <200202081740.g18HeFB18176@lewis.abi.tconline.net>

I am having difficulty. I am sure the root of the problem is my own stupidity 
but after 2 days of trying I can't seem to resolve this issue. No errors 
appear in the log. It just seems to ignore my handler and shows an index of 
the directory. I assume from the manual covering this section that this might 
mean the handler is invalid, but I don't think so. I read the "food for 
thought" (the one that says the name of the file doesn't matter) paragraph 
and thought maybe this is it. I don't believe so because that is an externel 
request detail and this is an internal deal.

Here is the situation:
auth.py is set as the authen handler like so
<Directory /var/www/html/ispmgr>
  AddHandler python-program .py
  PythonHandler mod_python.publisher
  PythonAuthenHandler auth
  AuthType Basic
  AuthName "Restricted Area"
  require valid-user
  PythonDebug On
</Directory>

As you can see I am trying to use the publisher.

auth.py looks like this:
from mod_python import apache
def authenhandler(req):
	"""Provide the correct page for the privilege of user."""

	pw = req.get_basic_auth_pw()
	user = req.connection.user
	if user == "admin" and pw == "admin":
		req.add_handler("PythonHandler", "setup::admin")
		return apache.OK
	if user == "operator" and pw == "operator":
		req.add_handler("PythonHandler", "setup::operator")
		return apache.OK
	if user == "user" and pw == "user":
		req.add_handler("PythonHandler", "setup::user")
		return apache.OK
	else:
		return apache.HTTP_UNAUTHORIZED

Later I will replace the statements with db calls (if I can ever get this 
working)

I think this means it should look for the setup file, try to instantiate it 
as setup and try to invoke the method admin. I am sure my logic must be way 
off here.
In case it is required, here is setup.py
class setup:

	def _frame(frameLeft, frameRight):
		"""Sets up frames.
	
		frameleft and frameright will be replaced by the correct menu function.
		"""
		html = """\
			<html>
			<head>
				<title>ISPMgr</title>
				<link rel=stylesheet type="text/css" href="ispmgr.css" title="stylesheet">
			</head>
			<frameset cols="20%%,*">
				<frame src="%s" name="menu">
				<frame src="%s" name="main">
			</frameset>"""% (frameLeft, frameRight)

		return html


	def admin():
		"""Provide all options to admin users."""
		r = _frame('menu.admin', 'main.customer')
		return r

Do all the handlers have to appear in the same file? (auth.py)
Lost and hopeless, please help.
-- 
Lewis Bergman
Texas Communications
4309 Maple St.
Abilene, TX 79602-8044
915-695-6962 ext 115

From grisha at modpython.org  Fri Feb  8 13:32:20 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:42 2004
Subject: [mod_python] confused about add_handler
In-Reply-To: <200202081740.g18HeFB18176@lewis.abi.tconline.net>
Message-ID: <Pine.BSF.4.32.0202081330560.63081-100000@localhost>

Hmm - I don't see anything wrong with this, it should work. Are you able
to get normal authentication going with an .htpasswd file for the same
directory?

Grisha

On Fri, 8 Feb 2002, Lewis Bergman wrote:

> I am having difficulty. I am sure the root of the problem is my own stupidity
> but after 2 days of trying I can't seem to resolve this issue. No errors
> appear in the log. It just seems to ignore my handler and shows an index of
> the directory. I assume from the manual covering this section that this might
> mean the handler is invalid, but I don't think so. I read the "food for
> thought" (the one that says the name of the file doesn't matter) paragraph
> and thought maybe this is it. I don't believe so because that is an externel
> request detail and this is an internal deal.
>
> Here is the situation:
> auth.py is set as the authen handler like so
> <Directory /var/www/html/ispmgr>
>   AddHandler python-program .py
>   PythonHandler mod_python.publisher
>   PythonAuthenHandler auth
>   AuthType Basic
>   AuthName "Restricted Area"
>   require valid-user
>   PythonDebug On
> </Directory>
>
> As you can see I am trying to use the publisher.
>
> auth.py looks like this:
> from mod_python import apache
> def authenhandler(req):
> 	"""Provide the correct page for the privilege of user."""
>
> 	pw = req.get_basic_auth_pw()
> 	user = req.connection.user
> 	if user == "admin" and pw == "admin":
> 		req.add_handler("PythonHandler", "setup::admin")
> 		return apache.OK
> 	if user == "operator" and pw == "operator":
> 		req.add_handler("PythonHandler", "setup::operator")
> 		return apache.OK
> 	if user == "user" and pw == "user":
> 		req.add_handler("PythonHandler", "setup::user")
> 		return apache.OK
> 	else:
> 		return apache.HTTP_UNAUTHORIZED
>
> Later I will replace the statements with db calls (if I can ever get this
> working)
>
> I think this means it should look for the setup file, try to instantiate it
> as setup and try to invoke the method admin. I am sure my logic must be way
> off here.
> In case it is required, here is setup.py
> class setup:
>
> 	def _frame(frameLeft, frameRight):
> 		"""Sets up frames.
>
> 		frameleft and frameright will be replaced by the correct menu function.
> 		"""
> 		html = """\
> 			<html>
> 			<head>
> 				<title>ISPMgr</title>
> 				<link rel=stylesheet type="text/css" href="ispmgr.css" title="stylesheet">
> 			</head>
> 			<frameset cols="20%%,*">
> 				<frame src="%s" name="menu">
> 				<frame src="%s" name="main">
> 			</frameset>"""% (frameLeft, frameRight)
>
> 		return html
>
>
> 	def admin():
> 		"""Provide all options to admin users."""
> 		r = _frame('menu.admin', 'main.customer')
> 		return r
>
> Do all the handlers have to appear in the same file? (auth.py)
> Lost and hopeless, please help.
> --
> Lewis Bergman
> Texas Communications
> 4309 Maple St.
> Abilene, TX 79602-8044
> 915-695-6962 ext 115
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From lbergman at abi.tconline.net  Wed Feb 13 11:21:34 2002
From: lbergman at abi.tconline.net (Lewis Bergman)
Date: Fri Jan  9 21:52:42 2004
Subject: [mod_python] web app framework suggestions?
Message-ID: <200202131721.g1DHLYa31858@lewis.abi.tconline.net>

I have read the manual about a dozen times now.
I think I understand some of what seem to me to be subtleties about 
mod_python. Not to bore anyone but to make sure I do here is what I see that 
has given me the most problems:

mod_python will not directly run a class - I know this is in the manual but I 
didn't catch on to a module being the same thing as a class for some reason. 
I remember something about security about this in the manual so we won't go 
on about inconvenience here.

mod_python will run a class from inside a standard python file or function.

The standard method of linking is to add the current files name to any linked 
argument. - I really had a hard time with this one. I remember the manual 
stating that it adds the current file to the path but I didn't think it was 
talking about this. Meaning that if I want to jump to another file (say 
new.py) from current.py I have to code the entire docroot in so that 
current.py is not appended. a small deal but still took some getting used to. 
I guess you have to default to something huh?

So I guess the question is..
Is there a recommended way to build a semi largish app with mod_python?

Maybe use standard files with functions to front end classes that generate 
pages based on how the classes/methods are called?

I am using this to build a web front end to an ISP package that controls 
billing/activation of customers on linux servers. Many of the tasks will be 
the same for a lot of different system users. For example; An ISP admin will 
need to add customers, just like a agent will. A user, agent, and admin will 
all most likely need to change a user password or username at some point.

So... how best to break these functional areas down. I am leaning to wards 
(and have started coding) classes to generate HTML like forms, results of db 
queries, simple info display, menu generation. I am also thinking of classes 
to do the queries, and such. i am finished with all the classes to do the 
actual system changes (which I thought would be the hard part, I was wrong)

Does this sound reasonable? Is there a better way?

Forgive me for stupid questions but I am pretty new to python, its OO ways,  
and a mod_python baby. I have done a lot of web coding in php but decided on 
python for this because of the scale of it. PHP for all its pluses is only 
faking OO and doesn't seem to scale very well. Namespace can drive you crazy 
on it! I am trying to make this app 100% python because I think in the long 
haul I believe it will be more maintainable.

Any advice would be appreciated.
-- 
Lewis Bergman
Texas Communications
4309 Maple St.
Abilene, TX 79602-8044
915-695-6962 ext 115

From grisha at modpython.org  Wed Feb 13 13:03:20 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:42 2004
Subject: [mod_python] web app framework suggestions?
In-Reply-To: <200202131721.g1DHLYa31858@lewis.abi.tconline.net>
Message-ID: <Pine.BSF.4.32.0202131257070.95676-100000@localhost>

On Wed, 13 Feb 2002, Lewis Bergman wrote:

> mod_python will not directly run a class - I know this is in the manual but I
> didn't catch on to a module being the same thing as a class for some reason.
> I remember something about security about this in the manual so we won't go
> on about inconvenience here.

Not sure what you mean by "running a class", mod_python will instantiate a
class if you specify it as part of a handler. I personally don't see any
value in using class methods as handlers.

Anyway, have you tried using the Publisher standard handler?

Grisha



From tree at basistech.com  Wed Feb 13 13:09:34 2002
From: tree at basistech.com (Tom Emerson)
Date: Fri Jan  9 21:52:42 2004
Subject: [mod_python] web app framework suggestions?
In-Reply-To: <Pine.BSF.4.32.0202131257070.95676-100000@localhost>
References: <200202131721.g1DHLYa31858@lewis.abi.tconline.net>
	<Pine.BSF.4.32.0202131257070.95676-100000@localhost>
Message-ID: <15466.43998.599001.798368@magrathea.basistech.com>

> 
> Anyway, have you tried using the Publisher standard handler?
> 

Indeed. I have had great success using Publisher in conjunction with
AHTS (http://ahts.sf.net) for making sites. Publisher handles dispatch
for me, and AHTS provides me with a good templating mechanism that
allows me to use an MVC model for the apps.

    -tree

-- 
Tom Emerson                                          Basis Technology Corp.
Sr. Computational Linguist                         http://www.basistech.com
  "Beware the lollipop of mediocrity: lick it once and you suck forever"

From cc at carlc.com  Wed Feb 13 14:40:57 2002
From: cc at carlc.com (Carl C.)
Date: Fri Jan  9 21:52:43 2004
Subject: [mod_python] Compiling a DSO module for RedHat Linux on ALPHA 64bit.
Message-ID: <003d01c1b4c6$5bc3fde0$13942c0a@fhpmfg.com>

Hi everyone,

    I'm fairly new to Python and I'm trying to setup the DSO module to use
with an Alpha (64bit) based RedHat 7.1 system.

    I have the following installed as RPMs:

apache-1.3.22-1.7.1
apache-devel-1.3.22-1.7.1

    I've installed Python 2.2 as two different directories:

/usr/src/Python-2.2
/usr/src/Python-2.2-no-threads

    Python 2.2 is compiled as:

./configure --exec-prefix=/usr
make
make test
make install

    and is installed in the system.

    I created the required no-threads version under Python-2.2-nothreads as:

./configure --exec-prefix=/usr --with-threads=no
make
    (did NOT do install, as its just for the mod_python module).

    I then created my mod_python under mod_python-2.7.6 as:

./configure --with-apxs=/usr/sbin/apxs --with-python=/usr/src/Python-2.2-no-threads

    I had to edit the Makefile to get the compileall.py to work:

/usr/src/Python-2.2-no-threads/Lib/compileall.py  (it was ($LIB)/compileall.py).

    I do get a mod_python.so in the proper area and everything does seem to 
build alright. The problem is when I go to start HTTPD with the the
mod_python.so installed (yes, its the first module).

Starting httpd: Syntax error on line 205 of /etc/httpd/conf/httpd.conf:
Cannot load /etc/httpd/modules/mod_python.so into server: /etc/httpd/modules/mod
_python.so: undefined symbol: openpty
[FAILED]
 
    So, I start looking in Python-2.2-no-threads's config files to see where openpty
is coming from:

configure:4873: gcc -o conftest -g -O2   conftest.c -ldl  1>&5
/tmp/ccudvDyk.o: In function `main':
/usr/src/Python-2.2-no-threads/configure:4867: undefined reference to `_getpty'
/usr/src/Python-2.2-no-threads/configure:4867: undefined reference to `_getpty'
collect2: ld returned 1 exit status
configure: failed program was:
#line 4850 "configure"
#include "confdefs.h"
/* System header to define __stub macros and hopefully few prototypes,
    which can conflict with char _getpty(); below.  */
#include <assert.h>
/* Override any gcc2 internal prototype to avoid an error.  */
/* We use char because int might match the return type of a gcc2
    builtin and then its argument prototype would still apply.  */
char _getpty();

int main() {

/* The GNU C library defines this for functions which it implements
    to always fail with ENOSYS.  Some functions are actually named
    something starting with __ and the normal name is an alias.  */
#if defined (__stub__getpty) || defined (__stub____getpty)
choke me
#else
_getpty();
#endif

; return 0; }
configure:4845: checking for getpriority
configure:4873: gcc -o conftest -g -O2   conftest.c -ldl  1>&5
configure:4903: checking for openpty
configure:4931: gcc -o conftest -g -O2   conftest.c -ldl  1>&5
/tmp/ccgNnz9F.o: In function `main':
/usr/src/Python-2.2-no-threads/configure:4925: undefined reference to `openpty'
/usr/src/Python-2.2-no-threads/configure:4925: undefined reference to `openpty'
collect2: ld returned 1 exit status
configure: failed program was:
#line 4908 "configure"
#include "confdefs.h"
/* System header to define __stub macros and hopefully few prototypes,
    which can conflict with char openpty(); below.  */
#include <assert.h>
/* Override any gcc2 internal prototype to avoid an error.  */
/* We use char because int might match the return type of a gcc2
    builtin and then its argument prototype would still apply.  */
char openpty();

int main() {

/* The GNU C library defines this for functions which it implements
    to always fail with ENOSYS.  Some functions are actually named
    something starting with __ and the normal name is an alias.  */
#if defined (__stub_openpty) || defined (__stub___openpty)
choke me
#else
openpty();
#endif

; return 0; }
configure:4953: checking for openpty in -lutil
configure:4972: gcc -o conftest -g -O2   conftest.c -lutil  -ldl  1>&5


So, it appears that it finds it in the util library... But it can't load into
apache???

Anyone else have this problem??? Or have a fix???
Thanks,
Carl
====================
http://www.carlc.com/

      "Price, Performance, Quality. Choose any two you like."


From cc at carlc.com  Wed Feb 13 15:29:35 2002
From: cc at carlc.com (Carl C.)
Date: Fri Jan  9 21:52:43 2004
Subject: [mod_python] Compiling a DSO module for RedHat Linux on ALPHA 64bit.
Message-ID: <005a01c1b4cd$26ea9e10$13942c0a@fhpmfg.com>

----- Original Message ----- 
From: "Carl C." <cc@carlc.com>
Subject: Re: [mod_python] Compiling a DSO module for RedHat Linux on ALPHA 64bit.


Guess, what... I FIXED IT...
 
 I had to edit the mod_python's src/Makefile and change the 
 
 LIBS=-lm  /usr/src/Python-2.2-no-threads/libpython2.2.a
 
 to 
 
 LIBS=-lm  /usr/src/Python-2.2-no-threads/libpython2.2.a -lutil
 
 That -lutil was the magic!
Carl
 
 ====================
 http://www.carlc.com/
 
       "Price, Performance, Quality. Choose any two you like."



From matt at proweb.co.uk  Thu Feb 14 00:26:27 2002
From: matt at proweb.co.uk (Matt H)
Date: Fri Jan  9 21:52:43 2004
Subject: [mod_python] just a hello
Message-ID: <20020214002627.3dfa8dfe.matt@proweb.co.uk>

hi mod_pythoners

hello from a new recruit, hopefully saved from the world of mod_perl and
the gradual weaning away from PHP

my ultimate aim is to do away with Apache and replicate the web server
side in a plan9 fileserver but providing the same API in order to move the
combination on to plan9 which has Python 2.2 but no Apache (and no real
need for porting Apache, other OS's are already better served for that).
That's the journey I'm planning but it's the travelling I'm
looking forward to.

Here goes with my opening question,

how does one gain access to the other provided objects :

the Server object is described as :

The request object is a Python mapping to the Apache request_rec structure. The server structure describes the server (possibly virtual server) serving the request. 

I can see that the request object arrives in my namespace as part of the handler

def handler(request) :
	pass


where can get the server object from to access it's members & methods

TIA

Matt

From matt at proweb.co.uk  Thu Feb 14 00:30:08 2002
From: matt at proweb.co.uk (Matt H)
Date: Fri Jan  9 21:52:43 2004
Subject: [mod_python] hehe I found it
Message-ID: <20020214003008.1d8c582a.matt@proweb.co.uk>

doh

request.server

I was looking for a method 

From djc at object-craft.com.au  Thu Feb 14 19:28:30 2002
From: djc at object-craft.com.au (Dave Cole)
Date: Fri Jan  9 21:52:43 2004
Subject: [mod_python] web app framework suggestions?
In-Reply-To: <200202131721.g1DHLYa31858@lewis.abi.tconline.net>
References: <200202131721.g1DHLYa31858@lewis.abi.tconline.net>
Message-ID: <m3d6z8a2mp.fsf@ferret.object-craft.com.au>

>>>>> "Lewis" == Lewis Bergman <lbergman@abi.tconline.net> writes:

Lewis> So I guess the question is..  Is there a recommended way to
Lewis> build a semi largish app with mod_python?

You could do worse than have a look at our Albatross toolkit.

   http://www.object-craft.com.au/projects/albatross/

Lewis> I am using this to build a web front end to an ISP package that
Lewis> controls billing/activation of customers on linux servers. Many
Lewis> of the tasks will be the same for a lot of different system
Lewis> users. For example; An ISP admin will need to add customers,
Lewis> just like a agent will. A user, agent, and admin will all most
Lewis> likely need to change a user password or username at some
Lewis> point.

Lewis> So... how best to break these functional areas down. I am
Lewis> leaning to wards (and have started coding) classes to generate
Lewis> HTML like forms, results of db queries, simple info display,
Lewis> menu generation. I am also thinking of classes to do the
Lewis> queries, and such. i am finished with all the classes to do the
Lewis> actual system changes (which I thought would be the hard part,
Lewis> I was wrong)

The approach which we think makes the most sense if to separate the
presentation from the implementation.  This allows you to do things
like unit test the stuff which changes your data and implements the
business logic.

Lewis> Does this sound reasonable? Is there a better way?

It depends on your preferred way of working.

Lewis> Forgive me for stupid questions but I am pretty new to python,
Lewis> its OO ways, and a mod_python baby. I have done a lot of web
Lewis> coding in php but decided on python for this because of the
Lewis> scale of it. PHP for all its pluses is only faking OO and
Lewis> doesn't seem to scale very well. Namespace can drive you crazy
Lewis> on it! I am trying to make this app 100% python because I think
Lewis> in the long haul I believe it will be more maintainable.

Quite a few things in Albatross were inspired by PHP.  If you have a
look at our toolkit you might feel partially at home.

We are hoping to release 0.06 next week along with a mailing list...

    https://www.object-craft.com.au/cgi-bin/mailman/listinfo/albatross-users

We might even build a new certificate by then too :-)

- Dave

-- 
http://www.object-craft.com.au


From aaronf at telusplanet.net  Thu Feb 14 18:45:49 2002
From: aaronf at telusplanet.net (Aaron Fransen)
Date: Fri Jan  9 21:52:43 2004
Subject: [mod_python] Re: web app framework suggestions?
Message-ID: <20020215014535.WPCW4620.priv-edtnes15-hme0.telusplanet.net@www.benedictclan.com>




I have a feeling this reply will show up in HTML format only, so my apologies to the group...

Regarding a web app, I think you hit it right on the head. I've use the publisher app and a single module to front an entire application, in fact applications: My first crack at Python is a web-based mail client (http://gomail.dynu.com) which is coming along nicely, and supports groups calendars etc., but for a mail client it was a lot more work than I thought it was going to be!

By comparison, the e-commerce site I created for my employer was simple, but it used the same techniques. In all, each app uses about a dozen separate modules of my own, with two of those being class collections for various functions (ie. html specs, database connectivity).

Now, I never learned Perl or C/C++, but I'm a VB developer since v1.0, and developing a web app in VB was positively painful in comparison. mod_python's a bear to get going the first time, but man, is it stable once it's up and running. If I ever go back to Microsoft, it'll only be to do Python.NET.

Aaron Fransen.

On Feb 14, 2002, Lewis Bergman wrote:

Re: web app framework suggestions? 

I have read the manual about a dozen times now. 
I think I understand some of what seem to me to be subtleties about 
mod_python. Not to bore anyone but to make sure I do here is what I see that 
has given me the most problems: 

mod_python will not directly run a class - I know this is in the manual but I 
didn't catch on to a module being the same thing as a class for some reason. 
I remember something about security about this in the manual so we won't go 
on about inconvenience here. 

mod_python will run a class from inside a standard python file or function. 

The standard method of linking is to add the current files name to any linked 
argument. - I really had a hard time with this one. I remember the manual 
stating that it adds the current file to the path but I didn't think it was 
talking about this. Meaning that if I want to jump to another file (say 
new.py) from current.py I have to code the entire docroot in so that 
current.py is not appended. a small deal but still took some getting used to. 
I guess you have to default to something huh? 

So I guess the question is.. 
Is there a recommended way to build a semi largish app with mod_python? 

Maybe use standard files with functions to front end classes that generate 
pages based on how the classes/methods are called? 

I am using this to build a web front end to an ISP package that controls 
billing/activation of customers on linux servers. Many of the tasks will be 
the same for a lot of different system users. For example; An ISP admin will 
need to add customers, just like a agent will. A user, agent, and admin will 
all most likely need to change a user password or username at some point. 

So... how best to break these functional areas down. I am leaning to wards 
(and have started coding) classes to generate HTML like forms, results of db 
queries, simple info display, menu generation. I am also thinking of classes 
to do the queries, and such. i am finished with all the classes to do the 
actual system changes (which I thought would be the hard part, I was wrong) 

Does this sound reasonable? Is there a better way? 

Forgive me for stupid questions but I am pretty new to python, its OO ways,   
and a mod_python baby. I have done a lot of web coding in php but decided on 
python for this because of the scale of it. PHP for all its pluses is only 
faking OO and doesn't seem to scale very well. Namespace can drive you crazy 
on it! I am trying to make this app 100\% python because I think in the long 
haul I believe it will be more maintainable. 

Any advice would be appreciated. 
-- 
Lewis Bergman 
Texas Communications 
4309 Maple St. 
Abilene, TX 79602-8044 
915-695-6962 ext 115 


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020214/497d1be7/attachment-0001.htm
From dustin at ywlcs.org  Sat Feb 16 10:24:37 2002
From: dustin at ywlcs.org (Dustin Mitchell)
Date: Fri Jan  9 21:52:43 2004
Subject: [mod_python] More ugly "make_obcallback returned no obCallBack!" errors.
Message-ID: <20020216162436.GC14969@eleanor.internal.ywlcs.org>

These don't seem to have anything to do with bad paths.  Here's the situation:

I have two name-based virtualhosts, each using mod_python.  They both use a
number of handlers.  Here are the relevant directives in the httpd.conf for
each vhost:

  PythonAutoReload Off
  PythonDebug on
  PythonTransHandler handlers.translate::transhandler
  PythonHeaderParserHandler handlers.headers::cookies
  PythonHeaderParserHandler handlers.headers::formdata handlers.headers::login
  PythonAuthenHandler handlers.auth::check
  PythonLogHandler handlers.log::log

I'm using Apache/1.3.22 (Unix) PHP/4.1.1 mod_python/2.7.6 Python/2.1
mod_ssl/2.8.5 OpenSSL/0.9.6.

So here's what happens:  Each Apache "server" (i.e., operating system
process, as differentiated by PIDs) only seems to be able to serve one of the
two virtualhosts -- the other virtualhost will present "Internal Server
Error" with the logs listing errors importing modules for make_obcallback,
and the infamous "make_obcallback returned no obCallBack!" error.

From grisha at modpython.org  Sat Feb 16 13:14:47 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:43 2004
Subject: [mod_python] More ugly "make_obcallback returned no obCallBack!"
 errors.
In-Reply-To: <20020216162436.GC14969@eleanor.internal.ywlcs.org>
Message-ID: <Pine.BSF.4.32.0202161312001.67126-100000@localhost>

This looks like a bug, I'll have to take a look at it later.

As dirty work-around, try forcing the interpreter name by putting

PythonIntepreter my_interpreter

in the config at the top level (i.e. outside virtual servers)

This will, of course, make the virtual servers run in the same
interpreter, but it might solve the immediate problem, as I supsect it is
something with subinterpreters...

Grisha

On Sat, 16 Feb 2002, Dustin Mitchell wrote:

> These don't seem to have anything to do with bad paths.  Here's the situation:
>
> I have two name-based virtualhosts, each using mod_python.  They both use a
> number of handlers.  Here are the relevant directives in the httpd.conf for
> each vhost:
>
>   PythonAutoReload Off
>   PythonDebug on
>   PythonTransHandler handlers.translate::transhandler
>   PythonHeaderParserHandler handlers.headers::cookies
>   PythonHeaderParserHandler handlers.headers::formdata handlers.headers::login
>   PythonAuthenHandler handlers.auth::check
>   PythonLogHandler handlers.log::log
>
> I'm using Apache/1.3.22 (Unix) PHP/4.1.1 mod_python/2.7.6 Python/2.1
> mod_ssl/2.8.5 OpenSSL/0.9.6.
>
> So here's what happens:  Each Apache "server" (i.e., operating system
> process, as differentiated by PIDs) only seems to be able to serve one of the
> two virtualhosts -- the other virtualhost will present "Internal Server
> Error" with the logs listing errors importing modules for make_obcallback,
> and the infamous "make_obcallback returned no obCallBack!" error.
>
> >From the perspective of a single "server" (checked by setting
> MaxSpareServers, MinSpareServers, and StartServers to 1), it can load
> virtualhost A as many times as it would like.  Once a request comes in for
> virtualhost B, however, obCallBack problems occur.  It doesn't matter which
> virtualhost is loaded first -- it will be successful, and the second
> virtualhost will not.
>
> I've tried some tricks to see exactly what the Python exception is when
> mod_python can't load 'apache', but I'm not an extension-writer, and my
> feeble attempts produced only segfaults.
>
> WITH_THREAD is not set.
>
> Any ideas?
>
> Dustin
>
> --
>
>   Dustin Mitchell
>   dustin@ywlcs.org
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From grisha at modpython.org  Sat Feb 16 14:22:37 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:43 2004
Subject: [mod_python] Shameless mod_python market analysis
Message-ID: <Pine.BSF.4.32.0202161412050.67806-100000@localhost>

Excuse my off-topic sobject, but I am interested in getting some
information:

Do you or your bosses sometimes wish that there was a place they could go
to get consulting on running your (high-volume reliable and redundand)
website, including (but not limited to) mod_python support?

If yes, then is the need strong enough that you would actually be willing
to *pay* for such consulting?

We are considering starting a company that would specialize in this sort
of thing to help keep alive and promote mod_python better, and I would
appreciate an opinion from the list subscribers. The idea is that I and a
few other developers could actually make some money working on it and
thereby be able to allot much more time for it.

Thanks,

Grisha


From brieu.daniel at wanadoo.fr  Sun Feb 17 11:12:25 2002
From: brieu.daniel at wanadoo.fr (Daniel Brieu)
Date: Fri Jan  9 21:52:43 2004
Subject: [mod_python] python's directives in httpd.conf
Message-ID: <006b01c1b79b$99386b70$548080d9@jany>

Hi, 
Sorry, but I'm a french newbie and didn't managed to find an answer to my question in the mailing-list archive :

I managed to run mptest.py ("Hello World" of official doc) with Apache win32 but I don't manage to run the others python scripts :
When I run the other python scripts, my browser show me "hello world"...the same result than mptest.py !!

I think I must add or modify other apache python's directives. So 
- I woud like to get a good httpd.conf for Apache win32 and Python module which works.
- some information about the "standard" headers of python scripts running in Apache web server.
- Some examples of python scripts running in Apache web server.

thanks a lot !
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020217/d804756c/attachment-0001.htm
From modpython at xhaus.com  Sun Feb 17 07:36:32 2002
From: modpython at xhaus.com (Alan Kennedy)
Date: Fri Jan  9 21:52:43 2004
Subject: [mod_python] python's directives in httpd.conf
Message-ID: <200202171247.HAA139374@spool2.valueweb.net>

Daniel,

> I managed to run mptest.py ("Hello World" of official
> doc) with Apache win32 but I don't manage to run the
> others python scripts :
> When I run the other python scripts, my browser show
> me "hello world"...the same result than mptest.py !!

The answer to this question depends on your configuration. 
If your configuration looks something like this

<Directory "/some/directory/">
    AddHandler python-program .py
    PythonHandler mptest
</Directory>

Then what you're telling Apache is "Run mptest.py whenever 
anyone requests a URI in the directory "/some/directory" 
which has the extension ".py". So *all* of the following 
URIs result in the same call to the "handler" function 
of "mptest.py".

http://someserver.com/some/directory/mptest.py
http://someserver.com/some/directory/anotherscript.py
http://someserver.com/some/directory/theScriptNameDoesNotMat
ter.py

The important section of the manual to understand is 
section 3.2: So what Exactly does Mod-python do? 

http://www.modpython.org/live/mod_python-2.7.6/doc-html/tut-
what-it-do.html

In particular, you must understand the section at the 
bottom called "Some food for thought".

> I think I must add or modify other apache python's 
directives. So 
> - I woud like to get a good httpd.conf for Apache win32 
and Python
> module which works.

"Works" is a relative thing. "Works" for what purpose is 
more the right question to ask. I've found that the bare 
minimum changes to a httpd.conf for mod_python are two 
changes, 

1. to load the modpython module, and 
2. to set up a handler module/function. 

These are handled as follows

1. Start with a clean httpd.conf from the Apache 
installation, and add the following entries.

LoadModule python_module modules/mod_python.{dll|so}

There should be a list of "LoadModule"s in the default 
httpd.conf, just put it with them. Probably best to put it 
before any other "LoadModule".

Then add a python handler for whichever directories you 
wish. The following directive indicates that 
myPythonHandler.py should be run whenever any URI ending 
in ".py" is requested anywhere in the document tree.

<Directory /my/document/root/>
   AddHandler python-program .py
   PythonHandler myPythonHandler
</Directory>

So whenever a request arrives for any URI ending in ".py", 
anywhere in the document hierarchy, at any level, then 
the "handler" function in the module "myPythonHandler.py" 
will be run. 

> - some information about the "standard" headers of python 
scripts
> running in Apache web server.

I'm not sure what you mean by "headers". This is not CGI, 
so you don't need shebang lines, or anything like that. The 
only headers you need to know about are the HTTP headers 
sent back with each http response, such as "Content-
type", "Content-length", "Content-encoding", and so on. 
These are set in your handler function as follows

def	handler(req):
	req.content_type = "text/html"
	req.headers_out['Content-Length'] = str(length)

Hopefully this well help you get configured and running.

Bon chance,

Alan.


---------------------------------------------
This message was sent using WebMail by CyberGate.
http://www.gate.net/webmail



From balld at webslingerZ.com  Tue Feb 19 17:16:29 2002
From: balld at webslingerZ.com (Donald Ball)
Date: Fri Jan  9 21:52:43 2004
Subject: [mod_python] -DEAPI support in configure?
Message-ID: <Pine.LNX.4.33L2.0202191711240.1670-100000@localhost.localdomain>

i use mod_python as a DSO in an apache httpd + mod_ssl installation. i
understand that i can compile mod_python using EAPI by manually editing
src/Makefile and adding -DEAPI to the OPT variable after configuring
mod_python. is that correct?

seems to me, though, that there ought to be a way to pass that as a
configuration option to the configure script. then i can record my
configure options in a my_configure script like i do for all of my other
daemons and not have to worry about me, or whoever comes after me,
remembering to manually edit src/Makefile afterwards. is there a way to do
that? if not, could i request that feature? i regret that i have only a
user's familiarity with autoconf and cannot patch it myself. thanks.

- donald


From lbergman at abi.tconline.net  Tue Feb 19 16:36:47 2002
From: lbergman at abi.tconline.net (Lewis Bergman)
Date: Fri Jan  9 21:52:43 2004
Subject: [mod_python] -DEAPI support in configure?
In-Reply-To: <Pine.LNX.4.33L2.0202191711240.1670-100000@localhost.localdomain>
References: <Pine.LNX.4.33L2.0202191711240.1670-100000@localhost.localdomain>
Message-ID: <200202192236.g1JMalI22476@lewis.abi.tconline.net>

> seems to me, though, that there ought to be a way to pass that as a
> configuration option to the configure script.
I'll second that.
-- 
Lewis Bergman
Texas Communications
4309 Maple St.
Abilene, TX 79602-8044
915-695-6962 ext 115

From ps0 at igmp.com.ar  Wed Feb 20 12:56:36 2002
From: ps0 at igmp.com.ar (ps0@igmp.com.ar)
Date: Fri Jan  9 21:52:43 2004
Subject: [mod_python] .pyc and .pyo bytecode files under mod_python ?
In-Reply-To: <200202201549.g1KFn1S32901@eden.ispol.com>; from mod_python-request@modpython.org on Wed, Feb 20, 2002 at 10:49:01AM -0500
References: <200202201549.g1KFn1S32901@eden.ispol.com>
Message-ID: <20020220125636.C2535@igmp.com.ar>

Hi, my question is :
 
 Could be possible execution of .pyc and .pyo files under mod_python ? how ?
 I probe adding a AddHandler python-program .pyc , but doesn't work.

 I need to run .pyc and .pyo for a specific proyect, so Im a problem if it
 can't be possible.
 
Tnks a lot.

Hector.

From grisha at modpython.org  Wed Feb 20 11:01:32 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:52:43 2004
Subject: [mod_python] .pyc and .pyo bytecode files under mod_python ?
In-Reply-To: <20020220125636.C2535@igmp.com.ar>
Message-ID: <Pine.BSF.4.32.0202201100150.33059-100000@localhost>

On Wed, 20 Feb 2002 ps0@igmp.com.ar wrote:

> Hi, my question is :
>
>  Could be possible execution of .pyc and .pyo files under mod_python ? how ?
>  I probe adding a AddHandler python-program .pyc , but doesn't work.

It should work, can you elaborate?

>  I need to run .pyc and .pyo for a specific proyect, so Im a problem if it
>  can't be possible.

Even if you specify .py, the Python interpreter will use a .pyc or .pyo if
one exists.

Grisha


From mike at mikebell.org  Wed Feb 20 13:00:13 2002
From: mike at mikebell.org (mike@mikebell.org)
Date: Fri Jan  9 21:52:43 2004
Subject: [mod_python] .pyc and .pyo bytecode files under mod_python ?
In-Reply-To: <20020220125636.C2535@igmp.com.ar>
References: <200202201549.g1KFn1S32901@eden.ispol.com> <20020220125636.C2535@igmp.com.ar>
Message-ID: <20020220210012.GW3517@mikebell.org>

On Wed, Feb 20, 2002 at 12:56:36PM -0300, ps0@igmp.com.ar wrote:
> Hi, my question is :
>  
>  Could be possible execution of .pyc and .pyo files under mod_python ? how ?
>  I probe adding a AddHandler python-program .pyc , but doesn't work.
> 
>  I need to run .pyc and .pyo for a specific proyect, so Im a problem if it
>  can't be possible.

.pyc files should be created automatically, all you need to do is insure
that the directory from which your mod_python scripts are being run is
writable to your web server, otherwise it cannot create the .pyc files.
Setting PythonOptimize to on will result in the creation of .pyo files.

From dustin at ywlcs.org  Wed Feb 20 16:26:15 2002
From: dustin at ywlcs.org (Dustin Mitchell)
Date: Fri Jan  9 21:52:43 2004
Subject: [mod_python] .pyc and .pyo bytecode files under mod_python ?
In-Reply-To: <20020220210012.GW3517@mikebell.org>
References: <200202201549.g1KFn1S32901@eden.ispol.com> <20020220125636.C2535@igmp.com.ar> <20020220210012.GW3517@mikebell.org>
Message-ID: <20020220222615.GG14969@eleanor.internal.ywlcs.org>

On Wed, Feb 20, 2002 at 01:00:13PM -0800, mike@mikebell.org wrote:
> .pyc files should be created automatically, all you need to do is insure
> that the directory from which your mod_python scripts are being run is
> writable to your web server, otherwise it cannot create the .pyc files.
> Setting PythonOptimize to on will result in the creation of .pyo files.

Be **very** careful if you do this -- the security implications of allowing
write access to your source files are pretty enormous.  For example, if
someone can write a file to your system (perhaps through a bug in a
file-upload system?), they can upload their own program to do whatever damage
they would like.

My approach to .pyo/c files has been to run a short script that uses the
Python compile module to compile all of the source files in the site.  Since
I run the script as me (not as the user running the web server) all of the
.pyo/c files are owned by me and not writeable by the web server.

My $0.02.

Dustin

-- 

  Dustin Mitchell
  dustin@ywlcs.org

From mike at mikebell.org  Wed Feb 20 14:51:42 2002
From: mike at mikebell.org (mike@mikebell.org)
Date: Fri Jan  9 21:52:43 2004
Subject: [mod_python] .pyc and .pyo bytecode files under mod_python ?
In-Reply-To: <20020220222615.GG14969@eleanor.internal.ywlcs.org>
References: <200202201549.g1KFn1S32901@eden.ispol.com> <20020220125636.C2535@igmp.com.ar> <20020220210012.GW3517@mikebell.org> <20020220222615.GG14969@eleanor.internal.ywlcs.org>
Message-ID: <20020220225142.GY3517@mikebell.org>

On Wed, Feb 20, 2002 at 04:26:15PM -0600, Dustin Mitchell wrote:
> Be **very** careful if you do this -- the security implications of allowing
> write access to your source files are pretty enormous.  For example, if
> someone can write a file to your system (perhaps through a bug in a
> file-upload system?), they can upload their own program to do whatever damage
> they would like.

Well, you can still have the programs within the writable directory owned by
someone else and only readable by the web server's UID, however this still
allows one to upload bad .pyo files. I'm not sure whether python has any
checks other than mtime but I imagine one could do /something/ malicious in
this manner.

From ps0 at igmp.com.ar  Thu Feb 21 17:55:52 2002
From: ps0 at igmp.com.ar (ps0@igmp.com.ar)
Date: Fri Jan  9 21:52:43 2004
Subject: [mod_python] .pyc and .pyo bytecode files under mod_python ?
In-Reply-To: <20020220225142.GY3517@mikebell.org>; from mike@mikebell.org on Wed, Feb 20, 2002 at 02:51:42PM -0800
References: <200202201549.g1KFn1S32901@eden.ispol.com> <20020220125636.C2535@igmp.com.ar> <20020220210012.GW3517@mikebell.org> <20020220222615.GG14969@eleanor.internal.ywlcs.org> <20020220225142.GY3517@mikebell.org>
Message-ID: <20020221175551.A5599@igmp.com.ar>

I think we are in a confusion , I will explain my problem more deep with a
simple real example :

I need : 1) Build a web aplication in python
         2) Buy this application to a client
	 3) I don't want the client has the source code of the .py files so
	    i need to include ONLY .pyc or .pyo bytecode files on that 
	    aplication, I know the blah blah about the posibility of decompile
	    .pyc and .pyo files but the client is too stupid to do that.

So , In my test lab I mount a apache+mod_python with this configuration :

http.conf :

[.......]
<Directory /var/www/test2>
AddHandler puthon-program .pyc
PythonHandler mod_python.publisher
PythonDebug On
</Directory>
[........]

Contents of the /var/www/test2 dir :

-rwxr-xr-x  1 www-data www-data 186 hello.pyc

and I try this :

links http://localhost/test2/hello/say

And obtain this :

Forbidden
You don't have permission to access /test2/hello/hello.py on this server

The contents of hello.py ( not compiled and in another directory ) :

def say(req):
 req.content_type="text/plain"
 req.send_http_header()
 s="HELLO WORLD !"
 return s
 
 
 If I try via the usual method ( using .py file and 
 AddHandler puthon-program .py , works pefect.
 

Tnks a lot !

From ps0 at igmp.com.ar  Thu Feb 21 18:24:19 2002
From: ps0 at igmp.com.ar (ps0@igmp.com.ar)
Date: Fri Jan  9 21:52:43 2004
Subject: [mod_python] .pyc and .pyo files my faulf thread terminated
Message-ID: <20020221182419.A23910@igmp.com.ar>

Sorry about my stupid question , was my fault , There was 2 problems :

1) A permission problems
2) I was compiled .pyc files with an different version of Python that the
   mod_python work.

Now, all .pyc and .pyo files are executed perfectly !

Tnks to all that help to solve my problem.

Best Regards.

Hector.

From stephen_m_mcallister at hotmail.com  Fri Feb 22 18:45:22 2002
From: stephen_m_mcallister at hotmail.com (Stephen M. McAllister)
Date: Fri Jan  9 21:52:43 2004
Subject: [mod_python] Newbie question for mod_perl, Apache and ActivePython on Win32
Message-ID: <OE25jrhwm5Tfv2ZAdYR000177cc@hotmail.com>

I am trying to install and config mod_perl on a Win2k/SP2 server running the
latest Apache V1.3.23 and ActiveState ActivePython V2.1 <groan>. I read lot
of posts and FAQ's and I am still confused. The modperl.org Windows Appendix
A is totally inadequate. I still get the following error while trying to
load the mod_python in my environment.

httpd.conf snippet ==>  LoadModule python_module modules/mod_python.dll

Causes error when starting Apache => "Syntax error on line 195 of
c:/apache/apache/conf/httpd.conf:
Cannot load c:/apache/apache/modules/mod_python.dll into server: (126) The
specified module could not be found:"


I tried a number of things and got nowhere.

So my questions for trying to get Python running on Win2k with Active State
Python are:
----------------------------------------------------------------------------
-------------
1. What version of Apache for Win32 should I be running?
2. What version of ActiveState Python should I be running?
3. What version of mod_perl should I be running?
4. How can I debug what is going on so I can catch misconfigurations?
5. Does PYTHONPATH matter at all for mod_python? (mine is not set as a path
var, but is set in the registry)
6. How is it that mod_perl knows what Python interpreter to use? Does it
read the registry or PYTHONPATH or what?

Thanks a bunch!
--Steve

From modpython at xhaus.com  Sat Feb 23 08:21:21 2002
From: modpython at xhaus.com (Alan Kennedy)
Date: Fri Jan  9 21:52:43 2004
Subject: [mod_python] Newbie question for mod_perl, Apache and ActivePython on Win32
Message-ID: <200202231332.IAA268450@spool4.valueweb.net>

> I am trying to install and config mod_perl on a Win2k/SP2
> server running the latest Apache V1.3.23 .... 

> I am still confused. The modperl.org Windows Appendix
> A is totally inadequate. 

> I still get the following error while trying to
> load the mod_python in my environment.

Sorry, you've got me confused as well. Are you trying to 
install mod_python, mod_perl or both mod_python AND 
mod_perl?

Alan.



---------------------------------------------
This message was sent using WebMail by CyberGate.
http://www.gate.net/webmail



From smcallister at msn.com  Sat Feb 23 09:06:48 2002
From: smcallister at msn.com (Stephen M. McAllister)
Date: Fri Jan  9 21:52:43 2004
Subject: [mod_python] Newbie question for mod_perl, Apache and ActivePython on Win32
References: <200202231332.IAA268450@spool4.valueweb.net>
Message-ID: <OE75RIw7eJq02aXkSHA000267d5@hotmail.com>

> > I am trying to install and config mod_perl on a Win2k/SP2
> > server running the latest Apache V1.3.23 ....
Ooops...I meant mod_python...I was in a bit of a hurry when I posted this. I
already had Apache installed and was using the ActivePython-2.1.1.msi
distribution. I want to try and use these if possible. I am trying to
understand just what versions work with what. I don't mind uninstalling
these and installing older versions or other distributions, but I wanted to
see if I can get what I currently running to work with mod_python. Should I
not be using ActiveState Python?


> > I am still confused. The modperl.org Windows Appendix
> > A is totally inadequate.
I meant the Appendix in the following link that explains how to setup
mod_python on a Windows box.
http://www.modpython.org/live/mod_python-2.7.6/doc-html/app-wininst.html


> > I still get the following error while trying to
> > load the mod_python in my environment.
I was attempting to show the line in my httpd.conf files that was causing
Apache to not start.
Commenting the line out allows Apache to start.


> Sorry, you've got me confused as well. Are you trying to
> install mod_python, mod_perl or both mod_python AND
> mod_perl?
Sorry about that....For now I just want to install and configure mod_python
in my current environment if possible. I will want to install mod_perl
later, but not for a while.

--Steve


----- Original Message -----
From: "Alan Kennedy" <modpython@xhaus.com>
To: "Stephen M. McAllister" <stephen_m_mcallister@hotmail.com>;
<mod_python@modpython.org>
Sent: Saturday, February 23, 2002 2:21 AM
Subject: Re: [mod_python] Newbie question for mod_perl, Apache and
ActivePython on Win32


> > I am trying to install and config mod_perl on a Win2k/SP2
> > server running the latest Apache V1.3.23 ....
>
> > I am still confused. The modperl.org Windows Appendix
> > A is totally inadequate.
>
> > I still get the following error while trying to
> > load the mod_python in my environment.
>
> Sorry, you've got me confused as well. Are you trying to
> install mod_python, mod_perl or both mod_python AND
> mod_perl?
>
> Alan.


From modpython at xhaus.com  Sat Feb 23 11:06:52 2002
From: modpython at xhaus.com (Alan Kennedy)
Date: Fri Jan  9 21:52:43 2004
Subject: [mod_python] Newbie question for mod_perl, Apache and ActivePython on Win32
Message-ID: <200202231618.LAA96476@spool7.valueweb.net>

> Should I not be using ActiveState Python?

Hmm, it shouldn't make much difference. Activestate still 
give you a standard command-line python interpreter, don't 
they? Namely, you can type "python.exe" on a command prompt 
and get an interactive python interpreter?

I haven't used ActivePython, so I can't give any definitive 
answers about it. But I would say that if you're concerned 
that ActivePython may be causing the problem, then you 
should switch to a standard python distribution, which you 
can get from www.python.org. I recommend version 2.1.2 or 
2.1.1.

> I meant the Appendix in the following link that explains
> how to setup mod_python on a Windows box.

Hmm, I followed those same instructions, and it all worked 
fine for me. The versions I use are

Apache 1.3.23
Python 2.1.1
Mod Python 2.7.6

All on Windows 2000 SP2.

The location where you put the "LoadModule" command in your 
httpd.conf can be significant. Try placing the "LoadModule" 
command before *all* other LoadModule commands in the 
httpd.conf and see if that makes a difference.

Also, are you certain that you're placing the file 
mod_python.dll in the correct directory. It should be in 
the "modules" subdirectory of the Apache installation, i.e. 
in the same directory as files such 
as "mod_rewrite.so", "mod_speling.so", etc.

As a tip, I always rename the mod_python.dll to contain the 
version number, i.e. mod_python276.dll so I always know 
which DLL I am using. So my LoadModule command has to refer 
to "modules/mod_python276.dll".

> I was attempting to show the line in my httpd.conf 
> files that was causing Apache to not start.
> Commenting the line out allows Apache to start.

Is there any information in the server logs as to why it 
might be failing? Check the file <apacheinst>/logs/error.log

> Sorry about that....For now I just want to install
> and configure mod_python in my current environment if
> possible. I will want to install mod_perl later, but
> not for a while.

Now what would you want to go installing mod_perl for? All 
that "executable line noise" ;-)

I'm sure you'll find that Python will easily do all that 
you need.

Only kidding about the Perl thing. But it's definitely a 
good idea to get one working first before trying to get the 
other working.

Best of luck,

Alan.



---------------------------------------------
This message was sent using WebMail by CyberGate.
http://www.gate.net/webmail



From conrad at hep.caltech.edu  Mon Feb 25 13:37:27 2002
From: conrad at hep.caltech.edu (Conrad Steenberg)
Date: Fri Jan  9 21:52:43 2004
Subject: [mod_python] Client certificate?
Message-ID: <1014673047.9352.10.camel@heppc22.cithep.caltech.edu>

Hi

I've been using mod_python for a while now, and it works great, hats of
to Grisha and the other contributors :-)

Having an SSL-enabled Apache works transparently, but it would be useful
to access some of the internals stored by the mod_ssl module.
Specifically, I'm trying to access the client certificate presented to
the server, either for logging or authentication purposes.

Is this possibly stored in a mp_table object that can be accessed?

Any ideas welcome!

Conrad

-- 
*-----------------------------------------*
| Conrad Steenberg                        |
| Caltech, Mail Code 356-48               |
| Pasadena, CA, 91125                     |
| e-mail: conrad@hep.caltech.edu          |
| Tel: (626) 395-8758                     |
*-----------------------------------------*


From bbrown at icce-t.com  Mon Feb 25 16:20:54 2002
From: bbrown at icce-t.com (Brian Brown)
Date: Fri Jan  9 21:52:43 2004
Subject: [mod_python] Compiling on MacOS X
Message-ID: <2174778112.1014679254@kelethin>

Greetings!
  I am trying to compile mod_python 2.7.6 on MacOS 10.1.3 with no success. 
I get the following:

cc: cannot specify -o with -c or -S with multiple compilations


I tried to take the -c out of the src/Makefile, but it had no effect on the 
make process... any ideas?

Brian

/-----------------
Brian Brown
ICCE Technologies, Inc.
http://www.icce-t.com

From rsalz at zolera.com  Mon Feb 25 20:52:08 2002
From: rsalz at zolera.com (Rich Salz)
Date: Fri Jan  9 21:52:43 2004
Subject: [mod_python] Client certificate?
References: <1014673047.9352.10.camel@heppc22.cithep.caltech.edu>
Message-ID: <3C7AEA48.494CF46E@zolera.com>

I am sure there are other approaches, but here is what we did.

We were already using SWIG (www.swig.org).  I added ONE function to the
the request object, get_swig_handle.  This returns a SWIG-compatible
handle to the real apache request object:
+static PyObject * req_get_swig_handle(requestobject *self, PyObject
*args)
+{
+    char ptrbuff[128];
+    SWIG_MakePtr(ptrbuff, (char *)self->request_rec, "_request_rec_p");
+    return Py_BuildValue("s", ptrbuff);
+}

Then it's pretty easy for us to write SWIG-wrapped functions that get
any mod_ssl data we want:

int
UsingSSL(request_rec* r)
{
    return ap_ctx_get(r->connection->client->ctx, "ssl") != NULL;
}


I can send more details if necessary ...
-- 
Zolera Systems, Securing web services (XML, SOAP, Signatures,
Encryption)
http://www.zolera.com

From conrad at hep.caltech.edu  Tue Feb 26 10:49:54 2002
From: conrad at hep.caltech.edu (Conrad Steenberg)
Date: Fri Jan  9 21:52:43 2004
Subject: [mod_python] Client certificate?
In-Reply-To: <3C7AEA48.494CF46E@zolera.com>
References: <1014673047.9352.10.camel@heppc22.cithep.caltech.edu> 
	<3C7AEA48.494CF46E@zolera.com>
Message-ID: <1014749396.9352.41.camel@heppc22.cithep.caltech.edu>

Hi Rich

On Mon, 2002-02-25 at 17:52, Rich Salz wrote:
> I am sure there are other approaches, but here is what we did.
> 
> We were already using SWIG (www.swig.org).  I added ONE function to the
> the request object, get_swig_handle.  This returns a SWIG-compatible
> handle to the real apache request object:
> +static PyObject * req_get_swig_handle(requestobject *self, PyObject
> *args)
> +{
> +    char ptrbuff[128];
> +    SWIG_MakePtr(ptrbuff, (char *)self->request_rec, "_request_rec_p");
> +    return Py_BuildValue("s", ptrbuff);
> +}

Just to clarify, this was done in your own apache module or a patch to
mod_python?

> 
> Then it's pretty easy for us to write SWIG-wrapped functions that get
> any mod_ssl data we want:
> 
> int
> UsingSSL(request_rec* r)
> {
>     return ap_ctx_get(r->connection->client->ctx, "ssl") != NULL;
> }
> 

And this is in your own Python module (which was also linked against
apache)?

> 
> I can send more details if necessary ...

I think my flu-fried brain would appreciate it :-)

Conrad

-- 
*-----------------------------------------*
| Conrad Steenberg                        |
| Caltech, Mail Code 356-48               |
| Pasadena, CA, 91125                     |
| e-mail: conrad@hep.caltech.edu          |
| Tel: (626) 395-8758                     |
*-----------------------------------------*


From rsalz at zolera.com  Tue Feb 26 18:38:39 2002
From: rsalz at zolera.com (Rich Salz)
Date: Fri Jan  9 21:52:43 2004
Subject: [mod_python] Client certificate?
References: <1014673047.9352.10.camel@heppc22.cithep.caltech.edu> 
		<3C7AEA48.494CF46E@zolera.com> <1014749396.9352.41.camel@heppc22.cithep.caltech.edu>
Message-ID: <3C7C1C7F.30E01AC6@zolera.com>

Okay, let me try to be more explicit.

We use SWIG (www.swig.org).  SWIG can parse header files and generate
modules for various scripting languages, including Python.  So, for
example, a SWIG interface file might say
	int UsingSSL(request_rec* r);
	char* GetClientDN(request_rec* r);
and so on.  The actual implementation of those functions tend to be
fairly short Apache ap_xxx calls, such as

int
UsingSSL(request_rec* r)
{
    return ap_ctx_get(r->connection->client->ctx, "ssl") != NULL;
}

We can create an Apache module that has our "swigged" extensions, and
build that into Apache.  (Or make it a shared library, DSO, whatever.)

The only "trick" is how to get that request_rec pointer.  It turns out
to be not that hard, because SWIG actually uses strings to represent
pointers.

So, we patched mod_python to add a new method to the mod_python request
object; this new method returns a swig-compatible pointer(string) up to
Python.  From python code, then, we can call the SWIG functions we wrote
as described above.

So, in our case,
	from zolera import pyssl
	h = req.get_swig_handle()
	if h.UsingSSL():
		dn = h.GetClientDN()
	else:
		return Apache.Unauthorized

We have found it easier (again, since we were already using SWIG), to
just add the one function to mod_python, and then to use SWIG for
everything else.

Hope this helps.
	/r$
-- 
Zolera Systems, Securing web services (XML, SOAP, Signatures,
Encryption)
http://www.zolera.com

From conrad at hep.caltech.edu  Tue Feb 26 15:40:23 2002
From: conrad at hep.caltech.edu (Conrad Steenberg)
Date: Fri Jan  9 21:52:43 2004
Subject: [mod_python] Client certificate?
In-Reply-To: <3C7C1C7F.30E01AC6@zolera.com>
References: <1014673047.9352.10.camel@heppc22.cithep.caltech.edu> 
	<3C7AEA48.494CF46E@zolera.com>
	<1014749396.9352.41.camel@heppc22.cithep.caltech.edu> 
	<3C7C1C7F.30E01AC6@zolera.com>
Message-ID: <1014766824.9347.44.camel@heppc22.cithep.caltech.edu>

Thanks, this helps clarify things.

Cheers!

Conrad

On Tue, 2002-02-26 at 15:38, Rich Salz wrote:
> Okay, let me try to be more explicit.
> 
> We use SWIG (www.swig.org).  SWIG can parse header files and generate
> modules for various scripting languages, including Python.  So, for
> example, a SWIG interface file might say
> 	int UsingSSL(request_rec* r);
> 	char* GetClientDN(request_rec* r);
> and so on.  The actual implementation of those functions tend to be
> fairly short Apache ap_xxx calls, such as
> 
> int
> UsingSSL(request_rec* r)
> {
>     return ap_ctx_get(r->connection->client->ctx, "ssl") != NULL;
> }
> 
> We can create an Apache module that has our "swigged" extensions, and
> build that into Apache.  (Or make it a shared library, DSO, whatever.)
> 
> The only "trick" is how to get that request_rec pointer.  It turns out
> to be not that hard, because SWIG actually uses strings to represent
> pointers.
> 
> So, we patched mod_python to add a new method to the mod_python request
> object; this new method returns a swig-compatible pointer(string) up to
> Python.  From python code, then, we can call the SWIG functions we wrote
> as described above.
> 
> So, in our case,
> 	from zolera import pyssl
> 	h = req.get_swig_handle()
> 	if h.UsingSSL():
> 		dn = h.GetClientDN()
> 	else:
> 		return Apache.Unauthorized
> 
> We have found it easier (again, since we were already using SWIG), to
> just add the one function to mod_python, and then to use SWIG for
> everything else.
> 
> Hope this helps.
> 	/r$
> -- 
> Zolera Systems, Securing web services (XML, SOAP, Signatures,
> Encryption)
> http://www.zolera.com
-- 
*-----------------------------------------*
| Conrad Steenberg                        |
| Caltech, Mail Code 356-48               |
| Pasadena, CA, 91125                     |
| e-mail: conrad@hep.caltech.edu          |
| Tel: (626) 395-8758                     |
*-----------------------------------------*


From unscribe127108 at yahoo.com  Tue Feb  5 17:08:47 2002
From: unscribe127108 at yahoo.com (unscribe127108@yahoo.com)
Date: Fri Jan  9 21:59:13 2004
Subject: [mod_python] Реклама Вашего проекта во всемирной глобальной сети Интернет.
Message-ID: <02822274@ghaqy>

    ?????? ????.

    ?????? ???????? ???????????? ?????????? ??????????? ?? ????? ??? ????????? 
???????????? ?????? ?????. ???????? ????? ?? ????? ???? ?????? ?? ????? ? 
????? ???????, ???? ???????? ????? ????????? ? ???, ??? ?? ???????????. ?? 
????????????? ??? ?????????? ??????????? ??????? ?? ????? ????????????? 
???????? ??? ??????????? ??????????. ???????? ????? ?? ??? ?????, ??????? 
??? ?????????, ??????? ???? ?????? ? ????????? ???, ??? ??? ?????? ??????? ??. 
?????? ???, ???? ?????????????? ???? ???????????, ?????? ? ???? ?? ?????. 
???????? ???????? ?? E-mail - ????? ??????????? ?????? ???????. ???? ???? 
? ?????? ?????? ?????????????? ???????????.

    ????? ?????? ??????? ?? ??????? ?????? ???????? ????(???? ???) ? ????????????
??????? ?? ????? ??????. ????? ?????? ???? ????? 25 ?????????.

    ??? ???????? ? ???? ??????????? ?????? ICQ. ?? ??????? ?? ??? ???? ???????.
UIN: 127108

    ?????? ???????? ??????????? ? ???????????? ? ?.4 ??.29 ??????????? ??. 
??? ??????????? ????? ??????? ?? ???????? ?????????? (????? ??????????) ?
???????????? ??? ????????? ???????? ?????????. ? ?????? ????????? ???????? 
???????????? ???????????, ???????? ?? ??? ?????? ? ???????? ? ???? "REMOVE". 
??? e-mail ????? ?????? ?? ????.



From jps at savagebeast.com  Wed Feb  6 17:31:10 2002
From: jps at savagebeast.com (Jeff Stearns)
Date: Fri Jan  9 21:59:13 2004
Subject: [mod_python] Loading the mod_python modules from somewhere other than site-packages
Message-ID: <5DC2C0CC-1B6A-11D6-A933-0030653DCC28@savagebeast.com>

Folks -

I'm installing mod_python on a Linux box which can't allow anything to 
be installed within the site-python directory.  (The reasons for that 
are slightly interesting; the box operates as a virtual machine with 
many apache servers running different software versions, and the virtual 
machines would step on each other's copy of the mod_python files.)

Thus I wish to install the handful of mod_python/*.py files in the 
user's directory, not in the system-wide site-python directory.

I am running into trouble because I can't get mod_python to look 
elsewhere for these files. It seems to be using the wired-in default 
python path.

The PythonPath directive looks tempting, but it looks like a write-only 
variable. I don't think any piece of code actually uses this value.

I'm thinking of reworking the make_obcallback() function to use the 
value of PythonPath by poking it into sys.path before importing the 
mod_python modules.

Does this seem like the right strategy?  Is make_obcallback the right 
place to do this?  (I tried running apache -X under gdb to get a better 
idea of how apache and mod_python interact, but there's some problem 
with gad that's preventing me from using it at all here, alas.)

thx for your advice!

-jeff stearns


From thanos at 0x01.com  Thu Feb  7 15:32:57 2002
From: thanos at 0x01.com (thanos@0x01.com)
Date: Fri Jan  9 21:59:13 2004
Subject: [mod_python] MySQL
Message-ID: <20020207203257.19753.qmail@0x01.com>

Has any one had MySQL expiriences ? 

When using cgi's we have exprienced no problems, but the following script 
will often break.

from mod_python import apache

def handler(req):
        import MySQLdb
        req.send_http_header()
        req.write("importd MySQLdb hello world")
        return apache.OK



I think on its first time the httpd execurtes this handler without any outward problems, but on the second time round:

Mod_python error: "PythonHandler testmysql"

Traceback (most recent call last):

  File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line 181, in Dispatch
    module = import_module(module_name, _req)

  File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line 356, in import_module
    if os.path.exists(filepath[:-1]) :

  File "/usr/local/lib/python2.1/posixpath.py", line 171, in exists
    st = os.stat(path)

OSError: [Errno 2] No such file or directory: '/usr/home/thanos/public_html/pso/tests/testmsql/testmysql.p'



You can try it out at:

http://www.0x01.com/~thanos/pso/tests/testmsql/mptest.py

Moving the import statement outside the handler will make the handle break every time. I guess this is some sort of clue. 

Any help would be great

thanks

thanos.






From alain at onesite.org  Fri Feb  8 01:01:58 2002
From: alain at onesite.org (Alain Tesio)
Date: Fri Jan  9 21:59:13 2004
Subject: [mod_python] MySQL
In-Reply-To: <20020207203257.19753.qmail@0x01.com>
References: <20020207203257.19753.qmail@0x01.com>
Message-ID: <20020208010158.7f1cf0ae.alain@onesite.org>

On Thu, 7 Feb 2002 15:32:57 -0500 (EST)
thanos@0x01.com wrote:

> OSError: [Errno 2] No such file or directory: > '/usr/home/thanos/public_html/pso/tests/testmsql/testmysql.p'

Hi, I knew I had already seen this problem, this may help:

http://www.modpython.org/pipermail/mod_python/2001-July/001478.html

Alain




From grisha at modpython.org  Thu Feb  7 19:24:52 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:14 2004
Subject: [mod_python] MySQL
In-Reply-To: <20020208010158.7f1cf0ae.alain@onesite.org>
Message-ID: <Pine.BSF.4.32.0202071923260.40345-100000@localhost>

On Fri, 8 Feb 2002, Alain Tesio wrote:

> Hi, I knew I had already seen this problem, this may help:
>
> http://www.modpython.org/pipermail/mod_python/2001-July/001478.html


That post has the wrong answer, the right answer is here:

http://www.modpython.org/FAQ/faqw.py?req=all#2.3

Grisha



From lbergman at abi.tconline.net  Fri Feb  8 11:40:15 2002
From: lbergman at abi.tconline.net (Lewis Bergman)
Date: Fri Jan  9 21:59:14 2004
Subject: [mod_python] confused about add_handler
Message-ID: <200202081740.g18HeFB18176@lewis.abi.tconline.net>

I am having difficulty. I am sure the root of the problem is my own stupidity 
but after 2 days of trying I can't seem to resolve this issue. No errors 
appear in the log. It just seems to ignore my handler and shows an index of 
the directory. I assume from the manual covering this section that this might 
mean the handler is invalid, but I don't think so. I read the "food for 
thought" (the one that says the name of the file doesn't matter) paragraph 
and thought maybe this is it. I don't believe so because that is an externel 
request detail and this is an internal deal.

Here is the situation:
auth.py is set as the authen handler like so
<Directory /var/www/html/ispmgr>
  AddHandler python-program .py
  PythonHandler mod_python.publisher
  PythonAuthenHandler auth
  AuthType Basic
  AuthName "Restricted Area"
  require valid-user
  PythonDebug On
</Directory>

As you can see I am trying to use the publisher.

auth.py looks like this:
from mod_python import apache
def authenhandler(req):
	"""Provide the correct page for the privilege of user."""

	pw = req.get_basic_auth_pw()
	user = req.connection.user
	if user == "admin" and pw == "admin":
		req.add_handler("PythonHandler", "setup::admin")
		return apache.OK
	if user == "operator" and pw == "operator":
		req.add_handler("PythonHandler", "setup::operator")
		return apache.OK
	if user == "user" and pw == "user":
		req.add_handler("PythonHandler", "setup::user")
		return apache.OK
	else:
		return apache.HTTP_UNAUTHORIZED

Later I will replace the statements with db calls (if I can ever get this 
working)

I think this means it should look for the setup file, try to instantiate it 
as setup and try to invoke the method admin. I am sure my logic must be way 
off here.
In case it is required, here is setup.py
class setup:

	def _frame(frameLeft, frameRight):
		"""Sets up frames.
	
		frameleft and frameright will be replaced by the correct menu function.
		"""
		html = """\
			<html>
			<head>
				<title>ISPMgr</title>
				<link rel=stylesheet type="text/css" href="ispmgr.css" title="stylesheet">
			</head>
			<frameset cols="20%%,*">
				<frame src="%s" name="menu">
				<frame src="%s" name="main">
			</frameset>"""% (frameLeft, frameRight)

		return html


	def admin():
		"""Provide all options to admin users."""
		r = _frame('menu.admin', 'main.customer')
		return r

Do all the handlers have to appear in the same file? (auth.py)
Lost and hopeless, please help.
-- 
Lewis Bergman
Texas Communications
4309 Maple St.
Abilene, TX 79602-8044
915-695-6962 ext 115

From grisha at modpython.org  Fri Feb  8 13:32:20 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:14 2004
Subject: [mod_python] confused about add_handler
In-Reply-To: <200202081740.g18HeFB18176@lewis.abi.tconline.net>
Message-ID: <Pine.BSF.4.32.0202081330560.63081-100000@localhost>

Hmm - I don't see anything wrong with this, it should work. Are you able
to get normal authentication going with an .htpasswd file for the same
directory?

Grisha

On Fri, 8 Feb 2002, Lewis Bergman wrote:

> I am having difficulty. I am sure the root of the problem is my own stupidity
> but after 2 days of trying I can't seem to resolve this issue. No errors
> appear in the log. It just seems to ignore my handler and shows an index of
> the directory. I assume from the manual covering this section that this might
> mean the handler is invalid, but I don't think so. I read the "food for
> thought" (the one that says the name of the file doesn't matter) paragraph
> and thought maybe this is it. I don't believe so because that is an externel
> request detail and this is an internal deal.
>
> Here is the situation:
> auth.py is set as the authen handler like so
> <Directory /var/www/html/ispmgr>
>   AddHandler python-program .py
>   PythonHandler mod_python.publisher
>   PythonAuthenHandler auth
>   AuthType Basic
>   AuthName "Restricted Area"
>   require valid-user
>   PythonDebug On
> </Directory>
>
> As you can see I am trying to use the publisher.
>
> auth.py looks like this:
> from mod_python import apache
> def authenhandler(req):
> 	"""Provide the correct page for the privilege of user."""
>
> 	pw = req.get_basic_auth_pw()
> 	user = req.connection.user
> 	if user == "admin" and pw == "admin":
> 		req.add_handler("PythonHandler", "setup::admin")
> 		return apache.OK
> 	if user == "operator" and pw == "operator":
> 		req.add_handler("PythonHandler", "setup::operator")
> 		return apache.OK
> 	if user == "user" and pw == "user":
> 		req.add_handler("PythonHandler", "setup::user")
> 		return apache.OK
> 	else:
> 		return apache.HTTP_UNAUTHORIZED
>
> Later I will replace the statements with db calls (if I can ever get this
> working)
>
> I think this means it should look for the setup file, try to instantiate it
> as setup and try to invoke the method admin. I am sure my logic must be way
> off here.
> In case it is required, here is setup.py
> class setup:
>
> 	def _frame(frameLeft, frameRight):
> 		"""Sets up frames.
>
> 		frameleft and frameright will be replaced by the correct menu function.
> 		"""
> 		html = """\
> 			<html>
> 			<head>
> 				<title>ISPMgr</title>
> 				<link rel=stylesheet type="text/css" href="ispmgr.css" title="stylesheet">
> 			</head>
> 			<frameset cols="20%%,*">
> 				<frame src="%s" name="menu">
> 				<frame src="%s" name="main">
> 			</frameset>"""% (frameLeft, frameRight)
>
> 		return html
>
>
> 	def admin():
> 		"""Provide all options to admin users."""
> 		r = _frame('menu.admin', 'main.customer')
> 		return r
>
> Do all the handlers have to appear in the same file? (auth.py)
> Lost and hopeless, please help.
> --
> Lewis Bergman
> Texas Communications
> 4309 Maple St.
> Abilene, TX 79602-8044
> 915-695-6962 ext 115
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From lbergman at abi.tconline.net  Wed Feb 13 11:21:34 2002
From: lbergman at abi.tconline.net (Lewis Bergman)
Date: Fri Jan  9 21:59:14 2004
Subject: [mod_python] web app framework suggestions?
Message-ID: <200202131721.g1DHLYa31858@lewis.abi.tconline.net>

I have read the manual about a dozen times now.
I think I understand some of what seem to me to be subtleties about 
mod_python. Not to bore anyone but to make sure I do here is what I see that 
has given me the most problems:

mod_python will not directly run a class - I know this is in the manual but I 
didn't catch on to a module being the same thing as a class for some reason. 
I remember something about security about this in the manual so we won't go 
on about inconvenience here.

mod_python will run a class from inside a standard python file or function.

The standard method of linking is to add the current files name to any linked 
argument. - I really had a hard time with this one. I remember the manual 
stating that it adds the current file to the path but I didn't think it was 
talking about this. Meaning that if I want to jump to another file (say 
new.py) from current.py I have to code the entire docroot in so that 
current.py is not appended. a small deal but still took some getting used to. 
I guess you have to default to something huh?

So I guess the question is..
Is there a recommended way to build a semi largish app with mod_python?

Maybe use standard files with functions to front end classes that generate 
pages based on how the classes/methods are called?

I am using this to build a web front end to an ISP package that controls 
billing/activation of customers on linux servers. Many of the tasks will be 
the same for a lot of different system users. For example; An ISP admin will 
need to add customers, just like a agent will. A user, agent, and admin will 
all most likely need to change a user password or username at some point.

So... how best to break these functional areas down. I am leaning to wards 
(and have started coding) classes to generate HTML like forms, results of db 
queries, simple info display, menu generation. I am also thinking of classes 
to do the queries, and such. i am finished with all the classes to do the 
actual system changes (which I thought would be the hard part, I was wrong)

Does this sound reasonable? Is there a better way?

Forgive me for stupid questions but I am pretty new to python, its OO ways,  
and a mod_python baby. I have done a lot of web coding in php but decided on 
python for this because of the scale of it. PHP for all its pluses is only 
faking OO and doesn't seem to scale very well. Namespace can drive you crazy 
on it! I am trying to make this app 100% python because I think in the long 
haul I believe it will be more maintainable.

Any advice would be appreciated.
-- 
Lewis Bergman
Texas Communications
4309 Maple St.
Abilene, TX 79602-8044
915-695-6962 ext 115

From grisha at modpython.org  Wed Feb 13 13:03:20 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:14 2004
Subject: [mod_python] web app framework suggestions?
In-Reply-To: <200202131721.g1DHLYa31858@lewis.abi.tconline.net>
Message-ID: <Pine.BSF.4.32.0202131257070.95676-100000@localhost>

On Wed, 13 Feb 2002, Lewis Bergman wrote:

> mod_python will not directly run a class - I know this is in the manual but I
> didn't catch on to a module being the same thing as a class for some reason.
> I remember something about security about this in the manual so we won't go
> on about inconvenience here.

Not sure what you mean by "running a class", mod_python will instantiate a
class if you specify it as part of a handler. I personally don't see any
value in using class methods as handlers.

Anyway, have you tried using the Publisher standard handler?

Grisha



From tree at basistech.com  Wed Feb 13 13:09:34 2002
From: tree at basistech.com (Tom Emerson)
Date: Fri Jan  9 21:59:14 2004
Subject: [mod_python] web app framework suggestions?
In-Reply-To: <Pine.BSF.4.32.0202131257070.95676-100000@localhost>
References: <200202131721.g1DHLYa31858@lewis.abi.tconline.net>
	<Pine.BSF.4.32.0202131257070.95676-100000@localhost>
Message-ID: <15466.43998.599001.798368@magrathea.basistech.com>

> 
> Anyway, have you tried using the Publisher standard handler?
> 

Indeed. I have had great success using Publisher in conjunction with
AHTS (http://ahts.sf.net) for making sites. Publisher handles dispatch
for me, and AHTS provides me with a good templating mechanism that
allows me to use an MVC model for the apps.

    -tree

-- 
Tom Emerson                                          Basis Technology Corp.
Sr. Computational Linguist                         http://www.basistech.com
  "Beware the lollipop of mediocrity: lick it once and you suck forever"

From cc at carlc.com  Wed Feb 13 14:40:57 2002
From: cc at carlc.com (Carl C.)
Date: Fri Jan  9 21:59:14 2004
Subject: [mod_python] Compiling a DSO module for RedHat Linux on ALPHA 64bit.
Message-ID: <003d01c1b4c6$5bc3fde0$13942c0a@fhpmfg.com>

Hi everyone,

    I'm fairly new to Python and I'm trying to setup the DSO module to use
with an Alpha (64bit) based RedHat 7.1 system.

    I have the following installed as RPMs:

apache-1.3.22-1.7.1
apache-devel-1.3.22-1.7.1

    I've installed Python 2.2 as two different directories:

/usr/src/Python-2.2
/usr/src/Python-2.2-no-threads

    Python 2.2 is compiled as:

./configure --exec-prefix=/usr
make
make test
make install

    and is installed in the system.

    I created the required no-threads version under Python-2.2-nothreads as:

./configure --exec-prefix=/usr --with-threads=no
make
    (did NOT do install, as its just for the mod_python module).

    I then created my mod_python under mod_python-2.7.6 as:

./configure --with-apxs=/usr/sbin/apxs --with-python=/usr/src/Python-2.2-no-threads

    I had to edit the Makefile to get the compileall.py to work:

/usr/src/Python-2.2-no-threads/Lib/compileall.py  (it was ($LIB)/compileall.py).

    I do get a mod_python.so in the proper area and everything does seem to 
build alright. The problem is when I go to start HTTPD with the the
mod_python.so installed (yes, its the first module).

Starting httpd: Syntax error on line 205 of /etc/httpd/conf/httpd.conf:
Cannot load /etc/httpd/modules/mod_python.so into server: /etc/httpd/modules/mod
_python.so: undefined symbol: openpty
[FAILED]
 
    So, I start looking in Python-2.2-no-threads's config files to see where openpty
is coming from:

configure:4873: gcc -o conftest -g -O2   conftest.c -ldl  1>&5
/tmp/ccudvDyk.o: In function `main':
/usr/src/Python-2.2-no-threads/configure:4867: undefined reference to `_getpty'
/usr/src/Python-2.2-no-threads/configure:4867: undefined reference to `_getpty'
collect2: ld returned 1 exit status
configure: failed program was:
#line 4850 "configure"
#include "confdefs.h"
/* System header to define __stub macros and hopefully few prototypes,
    which can conflict with char _getpty(); below.  */
#include <assert.h>
/* Override any gcc2 internal prototype to avoid an error.  */
/* We use char because int might match the return type of a gcc2
    builtin and then its argument prototype would still apply.  */
char _getpty();

int main() {

/* The GNU C library defines this for functions which it implements
    to always fail with ENOSYS.  Some functions are actually named
    something starting with __ and the normal name is an alias.  */
#if defined (__stub__getpty) || defined (__stub____getpty)
choke me
#else
_getpty();
#endif

; return 0; }
configure:4845: checking for getpriority
configure:4873: gcc -o conftest -g -O2   conftest.c -ldl  1>&5
configure:4903: checking for openpty
configure:4931: gcc -o conftest -g -O2   conftest.c -ldl  1>&5
/tmp/ccgNnz9F.o: In function `main':
/usr/src/Python-2.2-no-threads/configure:4925: undefined reference to `openpty'
/usr/src/Python-2.2-no-threads/configure:4925: undefined reference to `openpty'
collect2: ld returned 1 exit status
configure: failed program was:
#line 4908 "configure"
#include "confdefs.h"
/* System header to define __stub macros and hopefully few prototypes,
    which can conflict with char openpty(); below.  */
#include <assert.h>
/* Override any gcc2 internal prototype to avoid an error.  */
/* We use char because int might match the return type of a gcc2
    builtin and then its argument prototype would still apply.  */
char openpty();

int main() {

/* The GNU C library defines this for functions which it implements
    to always fail with ENOSYS.  Some functions are actually named
    something starting with __ and the normal name is an alias.  */
#if defined (__stub_openpty) || defined (__stub___openpty)
choke me
#else
openpty();
#endif

; return 0; }
configure:4953: checking for openpty in -lutil
configure:4972: gcc -o conftest -g -O2   conftest.c -lutil  -ldl  1>&5


So, it appears that it finds it in the util library... But it can't load into
apache???

Anyone else have this problem??? Or have a fix???
Thanks,
Carl
====================
http://www.carlc.com/

      "Price, Performance, Quality. Choose any two you like."


From cc at carlc.com  Wed Feb 13 15:29:35 2002
From: cc at carlc.com (Carl C.)
Date: Fri Jan  9 21:59:14 2004
Subject: [mod_python] Compiling a DSO module for RedHat Linux on ALPHA 64bit.
Message-ID: <005a01c1b4cd$26ea9e10$13942c0a@fhpmfg.com>

----- Original Message ----- 
From: "Carl C." <cc@carlc.com>
Subject: Re: [mod_python] Compiling a DSO module for RedHat Linux on ALPHA 64bit.


Guess, what... I FIXED IT...
 
 I had to edit the mod_python's src/Makefile and change the 
 
 LIBS=-lm  /usr/src/Python-2.2-no-threads/libpython2.2.a
 
 to 
 
 LIBS=-lm  /usr/src/Python-2.2-no-threads/libpython2.2.a -lutil
 
 That -lutil was the magic!
Carl
 
 ====================
 http://www.carlc.com/
 
       "Price, Performance, Quality. Choose any two you like."



From matt at proweb.co.uk  Thu Feb 14 00:26:27 2002
From: matt at proweb.co.uk (Matt H)
Date: Fri Jan  9 21:59:14 2004
Subject: [mod_python] just a hello
Message-ID: <20020214002627.3dfa8dfe.matt@proweb.co.uk>

hi mod_pythoners

hello from a new recruit, hopefully saved from the world of mod_perl and
the gradual weaning away from PHP

my ultimate aim is to do away with Apache and replicate the web server
side in a plan9 fileserver but providing the same API in order to move the
combination on to plan9 which has Python 2.2 but no Apache (and no real
need for porting Apache, other OS's are already better served for that).
That's the journey I'm planning but it's the travelling I'm
looking forward to.

Here goes with my opening question,

how does one gain access to the other provided objects :

the Server object is described as :

The request object is a Python mapping to the Apache request_rec structure. The server structure describes the server (possibly virtual server) serving the request. 

I can see that the request object arrives in my namespace as part of the handler

def handler(request) :
	pass


where can get the server object from to access it's members & methods

TIA

Matt

From matt at proweb.co.uk  Thu Feb 14 00:30:08 2002
From: matt at proweb.co.uk (Matt H)
Date: Fri Jan  9 21:59:14 2004
Subject: [mod_python] hehe I found it
Message-ID: <20020214003008.1d8c582a.matt@proweb.co.uk>

doh

request.server

I was looking for a method 

From djc at object-craft.com.au  Thu Feb 14 19:28:30 2002
From: djc at object-craft.com.au (Dave Cole)
Date: Fri Jan  9 21:59:14 2004
Subject: [mod_python] web app framework suggestions?
In-Reply-To: <200202131721.g1DHLYa31858@lewis.abi.tconline.net>
References: <200202131721.g1DHLYa31858@lewis.abi.tconline.net>
Message-ID: <m3d6z8a2mp.fsf@ferret.object-craft.com.au>

>>>>> "Lewis" == Lewis Bergman <lbergman@abi.tconline.net> writes:

Lewis> So I guess the question is..  Is there a recommended way to
Lewis> build a semi largish app with mod_python?

You could do worse than have a look at our Albatross toolkit.

   http://www.object-craft.com.au/projects/albatross/

Lewis> I am using this to build a web front end to an ISP package that
Lewis> controls billing/activation of customers on linux servers. Many
Lewis> of the tasks will be the same for a lot of different system
Lewis> users. For example; An ISP admin will need to add customers,
Lewis> just like a agent will. A user, agent, and admin will all most
Lewis> likely need to change a user password or username at some
Lewis> point.

Lewis> So... how best to break these functional areas down. I am
Lewis> leaning to wards (and have started coding) classes to generate
Lewis> HTML like forms, results of db queries, simple info display,
Lewis> menu generation. I am also thinking of classes to do the
Lewis> queries, and such. i am finished with all the classes to do the
Lewis> actual system changes (which I thought would be the hard part,
Lewis> I was wrong)

The approach which we think makes the most sense if to separate the
presentation from the implementation.  This allows you to do things
like unit test the stuff which changes your data and implements the
business logic.

Lewis> Does this sound reasonable? Is there a better way?

It depends on your preferred way of working.

Lewis> Forgive me for stupid questions but I am pretty new to python,
Lewis> its OO ways, and a mod_python baby. I have done a lot of web
Lewis> coding in php but decided on python for this because of the
Lewis> scale of it. PHP for all its pluses is only faking OO and
Lewis> doesn't seem to scale very well. Namespace can drive you crazy
Lewis> on it! I am trying to make this app 100% python because I think
Lewis> in the long haul I believe it will be more maintainable.

Quite a few things in Albatross were inspired by PHP.  If you have a
look at our toolkit you might feel partially at home.

We are hoping to release 0.06 next week along with a mailing list...

    https://www.object-craft.com.au/cgi-bin/mailman/listinfo/albatross-users

We might even build a new certificate by then too :-)

- Dave

-- 
http://www.object-craft.com.au


From aaronf at telusplanet.net  Thu Feb 14 18:45:49 2002
From: aaronf at telusplanet.net (Aaron Fransen)
Date: Fri Jan  9 21:59:14 2004
Subject: [mod_python] Re: web app framework suggestions?
Message-ID: <20020215014535.WPCW4620.priv-edtnes15-hme0.telusplanet.net@www.benedictclan.com>




I have a feeling this reply will show up in HTML format only, so my apologies to the group...

Regarding a web app, I think you hit it right on the head. I've use the publisher app and a single module to front an entire application, in fact applications: My first crack at Python is a web-based mail client (http://gomail.dynu.com) which is coming along nicely, and supports groups calendars etc., but for a mail client it was a lot more work than I thought it was going to be!

By comparison, the e-commerce site I created for my employer was simple, but it used the same techniques. In all, each app uses about a dozen separate modules of my own, with two of those being class collections for various functions (ie. html specs, database connectivity).

Now, I never learned Perl or C/C++, but I'm a VB developer since v1.0, and developing a web app in VB was positively painful in comparison. mod_python's a bear to get going the first time, but man, is it stable once it's up and running. If I ever go back to Microsoft, it'll only be to do Python.NET.

Aaron Fransen.

On Feb 14, 2002, Lewis Bergman wrote:

Re: web app framework suggestions? 

I have read the manual about a dozen times now. 
I think I understand some of what seem to me to be subtleties about 
mod_python. Not to bore anyone but to make sure I do here is what I see that 
has given me the most problems: 

mod_python will not directly run a class - I know this is in the manual but I 
didn't catch on to a module being the same thing as a class for some reason. 
I remember something about security about this in the manual so we won't go 
on about inconvenience here. 

mod_python will run a class from inside a standard python file or function. 

The standard method of linking is to add the current files name to any linked 
argument. - I really had a hard time with this one. I remember the manual 
stating that it adds the current file to the path but I didn't think it was 
talking about this. Meaning that if I want to jump to another file (say 
new.py) from current.py I have to code the entire docroot in so that 
current.py is not appended. a small deal but still took some getting used to. 
I guess you have to default to something huh? 

So I guess the question is.. 
Is there a recommended way to build a semi largish app with mod_python? 

Maybe use standard files with functions to front end classes that generate 
pages based on how the classes/methods are called? 

I am using this to build a web front end to an ISP package that controls 
billing/activation of customers on linux servers. Many of the tasks will be 
the same for a lot of different system users. For example; An ISP admin will 
need to add customers, just like a agent will. A user, agent, and admin will 
all most likely need to change a user password or username at some point. 

So... how best to break these functional areas down. I am leaning to wards 
(and have started coding) classes to generate HTML like forms, results of db 
queries, simple info display, menu generation. I am also thinking of classes 
to do the queries, and such. i am finished with all the classes to do the 
actual system changes (which I thought would be the hard part, I was wrong) 

Does this sound reasonable? Is there a better way? 

Forgive me for stupid questions but I am pretty new to python, its OO ways,   
and a mod_python baby. I have done a lot of web coding in php but decided on 
python for this because of the scale of it. PHP for all its pluses is only 
faking OO and doesn't seem to scale very well. Namespace can drive you crazy 
on it! I am trying to make this app 100\% python because I think in the long 
haul I believe it will be more maintainable. 

Any advice would be appreciated. 
-- 
Lewis Bergman 
Texas Communications 
4309 Maple St. 
Abilene, TX 79602-8044 
915-695-6962 ext 115 


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020214/497d1be7/attachment-0002.htm
From dustin at ywlcs.org  Sat Feb 16 10:24:37 2002
From: dustin at ywlcs.org (Dustin Mitchell)
Date: Fri Jan  9 21:59:14 2004
Subject: [mod_python] More ugly "make_obcallback returned no obCallBack!" errors.
Message-ID: <20020216162436.GC14969@eleanor.internal.ywlcs.org>

These don't seem to have anything to do with bad paths.  Here's the situation:

I have two name-based virtualhosts, each using mod_python.  They both use a
number of handlers.  Here are the relevant directives in the httpd.conf for
each vhost:

  PythonAutoReload Off
  PythonDebug on
  PythonTransHandler handlers.translate::transhandler
  PythonHeaderParserHandler handlers.headers::cookies
  PythonHeaderParserHandler handlers.headers::formdata handlers.headers::login
  PythonAuthenHandler handlers.auth::check
  PythonLogHandler handlers.log::log

I'm using Apache/1.3.22 (Unix) PHP/4.1.1 mod_python/2.7.6 Python/2.1
mod_ssl/2.8.5 OpenSSL/0.9.6.

So here's what happens:  Each Apache "server" (i.e., operating system
process, as differentiated by PIDs) only seems to be able to serve one of the
two virtualhosts -- the other virtualhost will present "Internal Server
Error" with the logs listing errors importing modules for make_obcallback,
and the infamous "make_obcallback returned no obCallBack!" error.

From grisha at modpython.org  Sat Feb 16 13:14:47 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:14 2004
Subject: [mod_python] More ugly "make_obcallback returned no obCallBack!"
 errors.
In-Reply-To: <20020216162436.GC14969@eleanor.internal.ywlcs.org>
Message-ID: <Pine.BSF.4.32.0202161312001.67126-100000@localhost>

This looks like a bug, I'll have to take a look at it later.

As dirty work-around, try forcing the interpreter name by putting

PythonIntepreter my_interpreter

in the config at the top level (i.e. outside virtual servers)

This will, of course, make the virtual servers run in the same
interpreter, but it might solve the immediate problem, as I supsect it is
something with subinterpreters...

Grisha

On Sat, 16 Feb 2002, Dustin Mitchell wrote:

> These don't seem to have anything to do with bad paths.  Here's the situation:
>
> I have two name-based virtualhosts, each using mod_python.  They both use a
> number of handlers.  Here are the relevant directives in the httpd.conf for
> each vhost:
>
>   PythonAutoReload Off
>   PythonDebug on
>   PythonTransHandler handlers.translate::transhandler
>   PythonHeaderParserHandler handlers.headers::cookies
>   PythonHeaderParserHandler handlers.headers::formdata handlers.headers::login
>   PythonAuthenHandler handlers.auth::check
>   PythonLogHandler handlers.log::log
>
> I'm using Apache/1.3.22 (Unix) PHP/4.1.1 mod_python/2.7.6 Python/2.1
> mod_ssl/2.8.5 OpenSSL/0.9.6.
>
> So here's what happens:  Each Apache "server" (i.e., operating system
> process, as differentiated by PIDs) only seems to be able to serve one of the
> two virtualhosts -- the other virtualhost will present "Internal Server
> Error" with the logs listing errors importing modules for make_obcallback,
> and the infamous "make_obcallback returned no obCallBack!" error.
>
> >From the perspective of a single "server" (checked by setting
> MaxSpareServers, MinSpareServers, and StartServers to 1), it can load
> virtualhost A as many times as it would like.  Once a request comes in for
> virtualhost B, however, obCallBack problems occur.  It doesn't matter which
> virtualhost is loaded first -- it will be successful, and the second
> virtualhost will not.
>
> I've tried some tricks to see exactly what the Python exception is when
> mod_python can't load 'apache', but I'm not an extension-writer, and my
> feeble attempts produced only segfaults.
>
> WITH_THREAD is not set.
>
> Any ideas?
>
> Dustin
>
> --
>
>   Dustin Mitchell
>   dustin@ywlcs.org
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From grisha at modpython.org  Sat Feb 16 14:22:37 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:14 2004
Subject: [mod_python] Shameless mod_python market analysis
Message-ID: <Pine.BSF.4.32.0202161412050.67806-100000@localhost>

Excuse my off-topic sobject, but I am interested in getting some
information:

Do you or your bosses sometimes wish that there was a place they could go
to get consulting on running your (high-volume reliable and redundand)
website, including (but not limited to) mod_python support?

If yes, then is the need strong enough that you would actually be willing
to *pay* for such consulting?

We are considering starting a company that would specialize in this sort
of thing to help keep alive and promote mod_python better, and I would
appreciate an opinion from the list subscribers. The idea is that I and a
few other developers could actually make some money working on it and
thereby be able to allot much more time for it.

Thanks,

Grisha


From brieu.daniel at wanadoo.fr  Sun Feb 17 11:12:25 2002
From: brieu.daniel at wanadoo.fr (Daniel Brieu)
Date: Fri Jan  9 21:59:14 2004
Subject: [mod_python] python's directives in httpd.conf
Message-ID: <006b01c1b79b$99386b70$548080d9@jany>

Hi, 
Sorry, but I'm a french newbie and didn't managed to find an answer to my question in the mailing-list archive :

I managed to run mptest.py ("Hello World" of official doc) with Apache win32 but I don't manage to run the others python scripts :
When I run the other python scripts, my browser show me "hello world"...the same result than mptest.py !!

I think I must add or modify other apache python's directives. So 
- I woud like to get a good httpd.conf for Apache win32 and Python module which works.
- some information about the "standard" headers of python scripts running in Apache web server.
- Some examples of python scripts running in Apache web server.

thanks a lot !
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020217/d804756c/attachment-0002.htm
From modpython at xhaus.com  Sun Feb 17 07:36:32 2002
From: modpython at xhaus.com (Alan Kennedy)
Date: Fri Jan  9 21:59:14 2004
Subject: [mod_python] python's directives in httpd.conf
Message-ID: <200202171247.HAA139374@spool2.valueweb.net>

Daniel,

> I managed to run mptest.py ("Hello World" of official
> doc) with Apache win32 but I don't manage to run the
> others python scripts :
> When I run the other python scripts, my browser show
> me "hello world"...the same result than mptest.py !!

The answer to this question depends on your configuration. 
If your configuration looks something like this

<Directory "/some/directory/">
    AddHandler python-program .py
    PythonHandler mptest
</Directory>

Then what you're telling Apache is "Run mptest.py whenever 
anyone requests a URI in the directory "/some/directory" 
which has the extension ".py". So *all* of the following 
URIs result in the same call to the "handler" function 
of "mptest.py".

http://someserver.com/some/directory/mptest.py
http://someserver.com/some/directory/anotherscript.py
http://someserver.com/some/directory/theScriptNameDoesNotMat
ter.py

The important section of the manual to understand is 
section 3.2: So what Exactly does Mod-python do? 

http://www.modpython.org/live/mod_python-2.7.6/doc-html/tut-
what-it-do.html

In particular, you must understand the section at the 
bottom called "Some food for thought".

> I think I must add or modify other apache python's 
directives. So 
> - I woud like to get a good httpd.conf for Apache win32 
and Python
> module which works.

"Works" is a relative thing. "Works" for what purpose is 
more the right question to ask. I've found that the bare 
minimum changes to a httpd.conf for mod_python are two 
changes, 

1. to load the modpython module, and 
2. to set up a handler module/function. 

These are handled as follows

1. Start with a clean httpd.conf from the Apache 
installation, and add the following entries.

LoadModule python_module modules/mod_python.{dll|so}

There should be a list of "LoadModule"s in the default 
httpd.conf, just put it with them. Probably best to put it 
before any other "LoadModule".

Then add a python handler for whichever directories you 
wish. The following directive indicates that 
myPythonHandler.py should be run whenever any URI ending 
in ".py" is requested anywhere in the document tree.

<Directory /my/document/root/>
   AddHandler python-program .py
   PythonHandler myPythonHandler
</Directory>

So whenever a request arrives for any URI ending in ".py", 
anywhere in the document hierarchy, at any level, then 
the "handler" function in the module "myPythonHandler.py" 
will be run. 

> - some information about the "standard" headers of python 
scripts
> running in Apache web server.

I'm not sure what you mean by "headers". This is not CGI, 
so you don't need shebang lines, or anything like that. The 
only headers you need to know about are the HTTP headers 
sent back with each http response, such as "Content-
type", "Content-length", "Content-encoding", and so on. 
These are set in your handler function as follows

def	handler(req):
	req.content_type = "text/html"
	req.headers_out['Content-Length'] = str(length)

Hopefully this well help you get configured and running.

Bon chance,

Alan.


---------------------------------------------
This message was sent using WebMail by CyberGate.
http://www.gate.net/webmail



From balld at webslingerZ.com  Tue Feb 19 17:16:29 2002
From: balld at webslingerZ.com (Donald Ball)
Date: Fri Jan  9 21:59:14 2004
Subject: [mod_python] -DEAPI support in configure?
Message-ID: <Pine.LNX.4.33L2.0202191711240.1670-100000@localhost.localdomain>

i use mod_python as a DSO in an apache httpd + mod_ssl installation. i
understand that i can compile mod_python using EAPI by manually editing
src/Makefile and adding -DEAPI to the OPT variable after configuring
mod_python. is that correct?

seems to me, though, that there ought to be a way to pass that as a
configuration option to the configure script. then i can record my
configure options in a my_configure script like i do for all of my other
daemons and not have to worry about me, or whoever comes after me,
remembering to manually edit src/Makefile afterwards. is there a way to do
that? if not, could i request that feature? i regret that i have only a
user's familiarity with autoconf and cannot patch it myself. thanks.

- donald


From lbergman at abi.tconline.net  Tue Feb 19 16:36:47 2002
From: lbergman at abi.tconline.net (Lewis Bergman)
Date: Fri Jan  9 21:59:14 2004
Subject: [mod_python] -DEAPI support in configure?
In-Reply-To: <Pine.LNX.4.33L2.0202191711240.1670-100000@localhost.localdomain>
References: <Pine.LNX.4.33L2.0202191711240.1670-100000@localhost.localdomain>
Message-ID: <200202192236.g1JMalI22476@lewis.abi.tconline.net>

> seems to me, though, that there ought to be a way to pass that as a
> configuration option to the configure script.
I'll second that.
-- 
Lewis Bergman
Texas Communications
4309 Maple St.
Abilene, TX 79602-8044
915-695-6962 ext 115

From ps0 at igmp.com.ar  Wed Feb 20 12:56:36 2002
From: ps0 at igmp.com.ar (ps0@igmp.com.ar)
Date: Fri Jan  9 21:59:14 2004
Subject: [mod_python] .pyc and .pyo bytecode files under mod_python ?
In-Reply-To: <200202201549.g1KFn1S32901@eden.ispol.com>; from mod_python-request@modpython.org on Wed, Feb 20, 2002 at 10:49:01AM -0500
References: <200202201549.g1KFn1S32901@eden.ispol.com>
Message-ID: <20020220125636.C2535@igmp.com.ar>

Hi, my question is :
 
 Could be possible execution of .pyc and .pyo files under mod_python ? how ?
 I probe adding a AddHandler python-program .pyc , but doesn't work.

 I need to run .pyc and .pyo for a specific proyect, so Im a problem if it
 can't be possible.
 
Tnks a lot.

Hector.

From grisha at modpython.org  Wed Feb 20 11:01:32 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:59:14 2004
Subject: [mod_python] .pyc and .pyo bytecode files under mod_python ?
In-Reply-To: <20020220125636.C2535@igmp.com.ar>
Message-ID: <Pine.BSF.4.32.0202201100150.33059-100000@localhost>

On Wed, 20 Feb 2002 ps0@igmp.com.ar wrote:

> Hi, my question is :
>
>  Could be possible execution of .pyc and .pyo files under mod_python ? how ?
>  I probe adding a AddHandler python-program .pyc , but doesn't work.

It should work, can you elaborate?

>  I need to run .pyc and .pyo for a specific proyect, so Im a problem if it
>  can't be possible.

Even if you specify .py, the Python interpreter will use a .pyc or .pyo if
one exists.

Grisha


From mike at mikebell.org  Wed Feb 20 13:00:13 2002
From: mike at mikebell.org (mike@mikebell.org)
Date: Fri Jan  9 21:59:14 2004
Subject: [mod_python] .pyc and .pyo bytecode files under mod_python ?
In-Reply-To: <20020220125636.C2535@igmp.com.ar>
References: <200202201549.g1KFn1S32901@eden.ispol.com> <20020220125636.C2535@igmp.com.ar>
Message-ID: <20020220210012.GW3517@mikebell.org>

On Wed, Feb 20, 2002 at 12:56:36PM -0300, ps0@igmp.com.ar wrote:
> Hi, my question is :
>  
>  Could be possible execution of .pyc and .pyo files under mod_python ? how ?
>  I probe adding a AddHandler python-program .pyc , but doesn't work.
> 
>  I need to run .pyc and .pyo for a specific proyect, so Im a problem if it
>  can't be possible.

.pyc files should be created automatically, all you need to do is insure
that the directory from which your mod_python scripts are being run is
writable to your web server, otherwise it cannot create the .pyc files.
Setting PythonOptimize to on will result in the creation of .pyo files.

From dustin at ywlcs.org  Wed Feb 20 16:26:15 2002
From: dustin at ywlcs.org (Dustin Mitchell)
Date: Fri Jan  9 21:59:14 2004
Subject: [mod_python] .pyc and .pyo bytecode files under mod_python ?
In-Reply-To: <20020220210012.GW3517@mikebell.org>
References: <200202201549.g1KFn1S32901@eden.ispol.com> <20020220125636.C2535@igmp.com.ar> <20020220210012.GW3517@mikebell.org>
Message-ID: <20020220222615.GG14969@eleanor.internal.ywlcs.org>

On Wed, Feb 20, 2002 at 01:00:13PM -0800, mike@mikebell.org wrote:
> .pyc files should be created automatically, all you need to do is insure
> that the directory from which your mod_python scripts are being run is
> writable to your web server, otherwise it cannot create the .pyc files.
> Setting PythonOptimize to on will result in the creation of .pyo files.

Be **very** careful if you do this -- the security implications of allowing
write access to your source files are pretty enormous.  For example, if
someone can write a file to your system (perhaps through a bug in a
file-upload system?), they can upload their own program to do whatever damage
they would like.

My approach to .pyo/c files has been to run a short script that uses the
Python compile module to compile all of the source files in the site.  Since
I run the script as me (not as the user running the web server) all of the
.pyo/c files are owned by me and not writeable by the web server.

My $0.02.

Dustin

-- 

  Dustin Mitchell
  dustin@ywlcs.org

From mike at mikebell.org  Wed Feb 20 14:51:42 2002
From: mike at mikebell.org (mike@mikebell.org)
Date: Fri Jan  9 21:59:14 2004
Subject: [mod_python] .pyc and .pyo bytecode files under mod_python ?
In-Reply-To: <20020220222615.GG14969@eleanor.internal.ywlcs.org>
References: <200202201549.g1KFn1S32901@eden.ispol.com> <20020220125636.C2535@igmp.com.ar> <20020220210012.GW3517@mikebell.org> <20020220222615.GG14969@eleanor.internal.ywlcs.org>
Message-ID: <20020220225142.GY3517@mikebell.org>

On Wed, Feb 20, 2002 at 04:26:15PM -0600, Dustin Mitchell wrote:
> Be **very** careful if you do this -- the security implications of allowing
> write access to your source files are pretty enormous.  For example, if
> someone can write a file to your system (perhaps through a bug in a
> file-upload system?), they can upload their own program to do whatever damage
> they would like.

Well, you can still have the programs within the writable directory owned by
someone else and only readable by the web server's UID, however this still
allows one to upload bad .pyo files. I'm not sure whether python has any
checks other than mtime but I imagine one could do /something/ malicious in
this manner.

From ps0 at igmp.com.ar  Thu Feb 21 17:55:52 2002
From: ps0 at igmp.com.ar (ps0@igmp.com.ar)
Date: Fri Jan  9 21:59:14 2004
Subject: [mod_python] .pyc and .pyo bytecode files under mod_python ?
In-Reply-To: <20020220225142.GY3517@mikebell.org>; from mike@mikebell.org on Wed, Feb 20, 2002 at 02:51:42PM -0800
References: <200202201549.g1KFn1S32901@eden.ispol.com> <20020220125636.C2535@igmp.com.ar> <20020220210012.GW3517@mikebell.org> <20020220222615.GG14969@eleanor.internal.ywlcs.org> <20020220225142.GY3517@mikebell.org>
Message-ID: <20020221175551.A5599@igmp.com.ar>

I think we are in a confusion , I will explain my problem more deep with a
simple real example :

I need : 1) Build a web aplication in python
         2) Buy this application to a client
	 3) I don't want the client has the source code of the .py files so
	    i need to include ONLY .pyc or .pyo bytecode files on that 
	    aplication, I know the blah blah about the posibility of decompile
	    .pyc and .pyo files but the client is too stupid to do that.

So , In my test lab I mount a apache+mod_python with this configuration :

http.conf :

[.......]
<Directory /var/www/test2>
AddHandler puthon-program .pyc
PythonHandler mod_python.publisher
PythonDebug On
</Directory>
[........]

Contents of the /var/www/test2 dir :

-rwxr-xr-x  1 www-data www-data 186 hello.pyc

and I try this :

links http://localhost/test2/hello/say

And obtain this :

Forbidden
You don't have permission to access /test2/hello/hello.py on this server

The contents of hello.py ( not compiled and in another directory ) :

def say(req):
 req.content_type="text/plain"
 req.send_http_header()
 s="HELLO WORLD !"
 return s
 
 
 If I try via the usual method ( using .py file and 
 AddHandler puthon-program .py , works pefect.
 

Tnks a lot !

From ps0 at igmp.com.ar  Thu Feb 21 18:24:19 2002
From: ps0 at igmp.com.ar (ps0@igmp.com.ar)
Date: Fri Jan  9 21:59:14 2004
Subject: [mod_python] .pyc and .pyo files my faulf thread terminated
Message-ID: <20020221182419.A23910@igmp.com.ar>

Sorry about my stupid question , was my fault , There was 2 problems :

1) A permission problems
2) I was compiled .pyc files with an different version of Python that the
   mod_python work.

Now, all .pyc and .pyo files are executed perfectly !

Tnks to all that help to solve my problem.

Best Regards.

Hector.

From stephen_m_mcallister at hotmail.com  Fri Feb 22 18:45:22 2002
From: stephen_m_mcallister at hotmail.com (Stephen M. McAllister)
Date: Fri Jan  9 21:59:14 2004
Subject: [mod_python] Newbie question for mod_perl, Apache and ActivePython on Win32
Message-ID: <OE25jrhwm5Tfv2ZAdYR000177cc@hotmail.com>

I am trying to install and config mod_perl on a Win2k/SP2 server running the
latest Apache V1.3.23 and ActiveState ActivePython V2.1 <groan>. I read lot
of posts and FAQ's and I am still confused. The modperl.org Windows Appendix
A is totally inadequate. I still get the following error while trying to
load the mod_python in my environment.

httpd.conf snippet ==>  LoadModule python_module modules/mod_python.dll

Causes error when starting Apache => "Syntax error on line 195 of
c:/apache/apache/conf/httpd.conf:
Cannot load c:/apache/apache/modules/mod_python.dll into server: (126) The
specified module could not be found:"


I tried a number of things and got nowhere.

So my questions for trying to get Python running on Win2k with Active State
Python are:
----------------------------------------------------------------------------
-------------
1. What version of Apache for Win32 should I be running?
2. What version of ActiveState Python should I be running?
3. What version of mod_perl should I be running?
4. How can I debug what is going on so I can catch misconfigurations?
5. Does PYTHONPATH matter at all for mod_python? (mine is not set as a path
var, but is set in the registry)
6. How is it that mod_perl knows what Python interpreter to use? Does it
read the registry or PYTHONPATH or what?

Thanks a bunch!
--Steve

From modpython at xhaus.com  Sat Feb 23 08:21:21 2002
From: modpython at xhaus.com (Alan Kennedy)
Date: Fri Jan  9 21:59:14 2004
Subject: [mod_python] Newbie question for mod_perl, Apache and ActivePython on Win32
Message-ID: <200202231332.IAA268450@spool4.valueweb.net>

> I am trying to install and config mod_perl on a Win2k/SP2
> server running the latest Apache V1.3.23 .... 

> I am still confused. The modperl.org Windows Appendix
> A is totally inadequate. 

> I still get the following error while trying to
> load the mod_python in my environment.

Sorry, you've got me confused as well. Are you trying to 
install mod_python, mod_perl or both mod_python AND 
mod_perl?

Alan.



---------------------------------------------
This message was sent using WebMail by CyberGate.
http://www.gate.net/webmail



From smcallister at msn.com  Sat Feb 23 09:06:48 2002
From: smcallister at msn.com (Stephen M. McAllister)
Date: Fri Jan  9 21:59:14 2004
Subject: [mod_python] Newbie question for mod_perl, Apache and ActivePython on Win32
References: <200202231332.IAA268450@spool4.valueweb.net>
Message-ID: <OE75RIw7eJq02aXkSHA000267d5@hotmail.com>

> > I am trying to install and config mod_perl on a Win2k/SP2
> > server running the latest Apache V1.3.23 ....
Ooops...I meant mod_python...I was in a bit of a hurry when I posted this. I
already had Apache installed and was using the ActivePython-2.1.1.msi
distribution. I want to try and use these if possible. I am trying to
understand just what versions work with what. I don't mind uninstalling
these and installing older versions or other distributions, but I wanted to
see if I can get what I currently running to work with mod_python. Should I
not be using ActiveState Python?


> > I am still confused. The modperl.org Windows Appendix
> > A is totally inadequate.
I meant the Appendix in the following link that explains how to setup
mod_python on a Windows box.
http://www.modpython.org/live/mod_python-2.7.6/doc-html/app-wininst.html


> > I still get the following error while trying to
> > load the mod_python in my environment.
I was attempting to show the line in my httpd.conf files that was causing
Apache to not start.
Commenting the line out allows Apache to start.


> Sorry, you've got me confused as well. Are you trying to
> install mod_python, mod_perl or both mod_python AND
> mod_perl?
Sorry about that....For now I just want to install and configure mod_python
in my current environment if possible. I will want to install mod_perl
later, but not for a while.

--Steve


----- Original Message -----
From: "Alan Kennedy" <modpython@xhaus.com>
To: "Stephen M. McAllister" <stephen_m_mcallister@hotmail.com>;
<mod_python@modpython.org>
Sent: Saturday, February 23, 2002 2:21 AM
Subject: Re: [mod_python] Newbie question for mod_perl, Apache and
ActivePython on Win32


> > I am trying to install and config mod_perl on a Win2k/SP2
> > server running the latest Apache V1.3.23 ....
>
> > I am still confused. The modperl.org Windows Appendix
> > A is totally inadequate.
>
> > I still get the following error while trying to
> > load the mod_python in my environment.
>
> Sorry, you've got me confused as well. Are you trying to
> install mod_python, mod_perl or both mod_python AND
> mod_perl?
>
> Alan.


From modpython at xhaus.com  Sat Feb 23 11:06:52 2002
From: modpython at xhaus.com (Alan Kennedy)
Date: Fri Jan  9 21:59:14 2004
Subject: [mod_python] Newbie question for mod_perl, Apache and ActivePython on Win32
Message-ID: <200202231618.LAA96476@spool7.valueweb.net>

> Should I not be using ActiveState Python?

Hmm, it shouldn't make much difference. Activestate still 
give you a standard command-line python interpreter, don't 
they? Namely, you can type "python.exe" on a command prompt 
and get an interactive python interpreter?

I haven't used ActivePython, so I can't give any definitive 
answers about it. But I would say that if you're concerned 
that ActivePython may be causing the problem, then you 
should switch to a standard python distribution, which you 
can get from www.python.org. I recommend version 2.1.2 or 
2.1.1.

> I meant the Appendix in the following link that explains
> how to setup mod_python on a Windows box.

Hmm, I followed those same instructions, and it all worked 
fine for me. The versions I use are

Apache 1.3.23
Python 2.1.1
Mod Python 2.7.6

All on Windows 2000 SP2.

The location where you put the "LoadModule" command in your 
httpd.conf can be significant. Try placing the "LoadModule" 
command before *all* other LoadModule commands in the 
httpd.conf and see if that makes a difference.

Also, are you certain that you're placing the file 
mod_python.dll in the correct directory. It should be in 
the "modules" subdirectory of the Apache installation, i.e. 
in the same directory as files such 
as "mod_rewrite.so", "mod_speling.so", etc.

As a tip, I always rename the mod_python.dll to contain the 
version number, i.e. mod_python276.dll so I always know 
which DLL I am using. So my LoadModule command has to refer 
to "modules/mod_python276.dll".

> I was attempting to show the line in my httpd.conf 
> files that was causing Apache to not start.
> Commenting the line out allows Apache to start.

Is there any information in the server logs as to why it 
might be failing? Check the file <apacheinst>/logs/error.log

> Sorry about that....For now I just want to install
> and configure mod_python in my current environment if
> possible. I will want to install mod_perl later, but
> not for a while.

Now what would you want to go installing mod_perl for? All 
that "executable line noise" ;-)

I'm sure you'll find that Python will easily do all that 
you need.

Only kidding about the Perl thing. But it's definitely a 
good idea to get one working first before trying to get the 
other working.

Best of luck,

Alan.



---------------------------------------------
This message was sent using WebMail by CyberGate.
http://www.gate.net/webmail



From conrad at hep.caltech.edu  Mon Feb 25 13:37:27 2002
From: conrad at hep.caltech.edu (Conrad Steenberg)
Date: Fri Jan  9 21:59:14 2004
Subject: [mod_python] Client certificate?
Message-ID: <1014673047.9352.10.camel@heppc22.cithep.caltech.edu>

Hi

I've been using mod_python for a while now, and it works great, hats of
to Grisha and the other contributors :-)

Having an SSL-enabled Apache works transparently, but it would be useful
to access some of the internals stored by the mod_ssl module.
Specifically, I'm trying to access the client certificate presented to
the server, either for logging or authentication purposes.

Is this possibly stored in a mp_table object that can be accessed?

Any ideas welcome!

Conrad

-- 
*-----------------------------------------*
| Conrad Steenberg                        |
| Caltech, Mail Code 356-48               |
| Pasadena, CA, 91125                     |
| e-mail: conrad@hep.caltech.edu          |
| Tel: (626) 395-8758                     |
*-----------------------------------------*


From bbrown at icce-t.com  Mon Feb 25 16:20:54 2002
From: bbrown at icce-t.com (Brian Brown)
Date: Fri Jan  9 21:59:14 2004
Subject: [mod_python] Compiling on MacOS X
Message-ID: <2174778112.1014679254@kelethin>

Greetings!
  I am trying to compile mod_python 2.7.6 on MacOS 10.1.3 with no success. 
I get the following:

cc: cannot specify -o with -c or -S with multiple compilations


I tried to take the -c out of the src/Makefile, but it had no effect on the 
make process... any ideas?

Brian

/-----------------
Brian Brown
ICCE Technologies, Inc.
http://www.icce-t.com

From rsalz at zolera.com  Mon Feb 25 20:52:08 2002
From: rsalz at zolera.com (Rich Salz)
Date: Fri Jan  9 21:59:14 2004
Subject: [mod_python] Client certificate?
References: <1014673047.9352.10.camel@heppc22.cithep.caltech.edu>
Message-ID: <3C7AEA48.494CF46E@zolera.com>

I am sure there are other approaches, but here is what we did.

We were already using SWIG (www.swig.org).  I added ONE function to the
the request object, get_swig_handle.  This returns a SWIG-compatible
handle to the real apache request object:
+static PyObject * req_get_swig_handle(requestobject *self, PyObject
*args)
+{
+    char ptrbuff[128];
+    SWIG_MakePtr(ptrbuff, (char *)self->request_rec, "_request_rec_p");
+    return Py_BuildValue("s", ptrbuff);
+}

Then it's pretty easy for us to write SWIG-wrapped functions that get
any mod_ssl data we want:

int
UsingSSL(request_rec* r)
{
    return ap_ctx_get(r->connection->client->ctx, "ssl") != NULL;
}


I can send more details if necessary ...
-- 
Zolera Systems, Securing web services (XML, SOAP, Signatures,
Encryption)
http://www.zolera.com

From conrad at hep.caltech.edu  Tue Feb 26 10:49:54 2002
From: conrad at hep.caltech.edu (Conrad Steenberg)
Date: Fri Jan  9 21:59:15 2004
Subject: [mod_python] Client certificate?
In-Reply-To: <3C7AEA48.494CF46E@zolera.com>
References: <1014673047.9352.10.camel@heppc22.cithep.caltech.edu> 
	<3C7AEA48.494CF46E@zolera.com>
Message-ID: <1014749396.9352.41.camel@heppc22.cithep.caltech.edu>

Hi Rich

On Mon, 2002-02-25 at 17:52, Rich Salz wrote:
> I am sure there are other approaches, but here is what we did.
> 
> We were already using SWIG (www.swig.org).  I added ONE function to the
> the request object, get_swig_handle.  This returns a SWIG-compatible
> handle to the real apache request object:
> +static PyObject * req_get_swig_handle(requestobject *self, PyObject
> *args)
> +{
> +    char ptrbuff[128];
> +    SWIG_MakePtr(ptrbuff, (char *)self->request_rec, "_request_rec_p");
> +    return Py_BuildValue("s", ptrbuff);
> +}

Just to clarify, this was done in your own apache module or a patch to
mod_python?

> 
> Then it's pretty easy for us to write SWIG-wrapped functions that get
> any mod_ssl data we want:
> 
> int
> UsingSSL(request_rec* r)
> {
>     return ap_ctx_get(r->connection->client->ctx, "ssl") != NULL;
> }
> 

And this is in your own Python module (which was also linked against
apache)?

> 
> I can send more details if necessary ...

I think my flu-fried brain would appreciate it :-)

Conrad

-- 
*-----------------------------------------*
| Conrad Steenberg                        |
| Caltech, Mail Code 356-48               |
| Pasadena, CA, 91125                     |
| e-mail: conrad@hep.caltech.edu          |
| Tel: (626) 395-8758                     |
*-----------------------------------------*


From rsalz at zolera.com  Tue Feb 26 18:38:39 2002
From: rsalz at zolera.com (Rich Salz)
Date: Fri Jan  9 21:59:15 2004
Subject: [mod_python] Client certificate?
References: <1014673047.9352.10.camel@heppc22.cithep.caltech.edu> 
		<3C7AEA48.494CF46E@zolera.com> <1014749396.9352.41.camel@heppc22.cithep.caltech.edu>
Message-ID: <3C7C1C7F.30E01AC6@zolera.com>

Okay, let me try to be more explicit.

We use SWIG (www.swig.org).  SWIG can parse header files and generate
modules for various scripting languages, including Python.  So, for
example, a SWIG interface file might say
	int UsingSSL(request_rec* r);
	char* GetClientDN(request_rec* r);
and so on.  The actual implementation of those functions tend to be
fairly short Apache ap_xxx calls, such as

int
UsingSSL(request_rec* r)
{
    return ap_ctx_get(r->connection->client->ctx, "ssl") != NULL;
}

We can create an Apache module that has our "swigged" extensions, and
build that into Apache.  (Or make it a shared library, DSO, whatever.)

The only "trick" is how to get that request_rec pointer.  It turns out
to be not that hard, because SWIG actually uses strings to represent
pointers.

So, we patched mod_python to add a new method to the mod_python request
object; this new method returns a swig-compatible pointer(string) up to
Python.  From python code, then, we can call the SWIG functions we wrote
as described above.

So, in our case,
	from zolera import pyssl
	h = req.get_swig_handle()
	if h.UsingSSL():
		dn = h.GetClientDN()
	else:
		return Apache.Unauthorized

We have found it easier (again, since we were already using SWIG), to
just add the one function to mod_python, and then to use SWIG for
everything else.

Hope this helps.
	/r$
-- 
Zolera Systems, Securing web services (XML, SOAP, Signatures,
Encryption)
http://www.zolera.com

From conrad at hep.caltech.edu  Tue Feb 26 15:40:23 2002
From: conrad at hep.caltech.edu (Conrad Steenberg)
Date: Fri Jan  9 21:59:15 2004
Subject: [mod_python] Client certificate?
In-Reply-To: <3C7C1C7F.30E01AC6@zolera.com>
References: <1014673047.9352.10.camel@heppc22.cithep.caltech.edu> 
	<3C7AEA48.494CF46E@zolera.com>
	<1014749396.9352.41.camel@heppc22.cithep.caltech.edu> 
	<3C7C1C7F.30E01AC6@zolera.com>
Message-ID: <1014766824.9347.44.camel@heppc22.cithep.caltech.edu>

Thanks, this helps clarify things.

Cheers!

Conrad

On Tue, 2002-02-26 at 15:38, Rich Salz wrote:
> Okay, let me try to be more explicit.
> 
> We use SWIG (www.swig.org).  SWIG can parse header files and generate
> modules for various scripting languages, including Python.  So, for
> example, a SWIG interface file might say
> 	int UsingSSL(request_rec* r);
> 	char* GetClientDN(request_rec* r);
> and so on.  The actual implementation of those functions tend to be
> fairly short Apache ap_xxx calls, such as
> 
> int
> UsingSSL(request_rec* r)
> {
>     return ap_ctx_get(r->connection->client->ctx, "ssl") != NULL;
> }
> 
> We can create an Apache module that has our "swigged" extensions, and
> build that into Apache.  (Or make it a shared library, DSO, whatever.)
> 
> The only "trick" is how to get that request_rec pointer.  It turns out
> to be not that hard, because SWIG actually uses strings to represent
> pointers.
> 
> So, we patched mod_python to add a new method to the mod_python request
> object; this new method returns a swig-compatible pointer(string) up to
> Python.  From python code, then, we can call the SWIG functions we wrote
> as described above.
> 
> So, in our case,
> 	from zolera import pyssl
> 	h = req.get_swig_handle()
> 	if h.UsingSSL():
> 		dn = h.GetClientDN()
> 	else:
> 		return Apache.Unauthorized
> 
> We have found it easier (again, since we were already using SWIG), to
> just add the one function to mod_python, and then to use SWIG for
> everything else.
> 
> Hope this helps.
> 	/r$
> -- 
> Zolera Systems, Securing web services (XML, SOAP, Signatures,
> Encryption)
> http://www.zolera.com
-- 
*-----------------------------------------*
| Conrad Steenberg                        |
| Caltech, Mail Code 356-48               |
| Pasadena, CA, 91125                     |
| e-mail: conrad@hep.caltech.edu          |
| Tel: (626) 395-8758                     |
*-----------------------------------------*


From unscribe127108 at yahoo.com  Tue Feb  5 17:08:47 2002
From: unscribe127108 at yahoo.com (unscribe127108@yahoo.com)
Date: Fri Jan  9 22:03:03 2004
Subject: [mod_python] Реклама Вашего проекта во всемирной глобальной сети Интернет.
Message-ID: <02822274@ghaqy>

    ?????? ????.

    ?????? ???????? ???????????? ?????????? ??????????? ?? ????? ??? ????????? 
???????????? ?????? ?????. ???????? ????? ?? ????? ???? ?????? ?? ????? ? 
????? ???????, ???? ???????? ????? ????????? ? ???, ??? ?? ???????????. ?? 
????????????? ??? ?????????? ??????????? ??????? ?? ????? ????????????? 
???????? ??? ??????????? ??????????. ???????? ????? ?? ??? ?????, ??????? 
??? ?????????, ??????? ???? ?????? ? ????????? ???, ??? ??? ?????? ??????? ??. 
?????? ???, ???? ?????????????? ???? ???????????, ?????? ? ???? ?? ?????. 
???????? ???????? ?? E-mail - ????? ??????????? ?????? ???????. ???? ???? 
? ?????? ?????? ?????????????? ???????????.

    ????? ?????? ??????? ?? ??????? ?????? ???????? ????(???? ???) ? ????????????
??????? ?? ????? ??????. ????? ?????? ???? ????? 25 ?????????.

    ??? ???????? ? ???? ??????????? ?????? ICQ. ?? ??????? ?? ??? ???? ???????.
UIN: 127108

    ?????? ???????? ??????????? ? ???????????? ? ?.4 ??.29 ??????????? ??. 
??? ??????????? ????? ??????? ?? ???????? ?????????? (????? ??????????) ?
???????????? ??? ????????? ???????? ?????????. ? ?????? ????????? ???????? 
???????????? ???????????, ???????? ?? ??? ?????? ? ???????? ? ???? "REMOVE". 
??? e-mail ????? ?????? ?? ????.



From jps at savagebeast.com  Wed Feb  6 17:31:10 2002
From: jps at savagebeast.com (Jeff Stearns)
Date: Fri Jan  9 22:03:03 2004
Subject: [mod_python] Loading the mod_python modules from somewhere other than site-packages
Message-ID: <5DC2C0CC-1B6A-11D6-A933-0030653DCC28@savagebeast.com>

Folks -

I'm installing mod_python on a Linux box which can't allow anything to 
be installed within the site-python directory.  (The reasons for that 
are slightly interesting; the box operates as a virtual machine with 
many apache servers running different software versions, and the virtual 
machines would step on each other's copy of the mod_python files.)

Thus I wish to install the handful of mod_python/*.py files in the 
user's directory, not in the system-wide site-python directory.

I am running into trouble because I can't get mod_python to look 
elsewhere for these files. It seems to be using the wired-in default 
python path.

The PythonPath directive looks tempting, but it looks like a write-only 
variable. I don't think any piece of code actually uses this value.

I'm thinking of reworking the make_obcallback() function to use the 
value of PythonPath by poking it into sys.path before importing the 
mod_python modules.

Does this seem like the right strategy?  Is make_obcallback the right 
place to do this?  (I tried running apache -X under gdb to get a better 
idea of how apache and mod_python interact, but there's some problem 
with gad that's preventing me from using it at all here, alas.)

thx for your advice!

-jeff stearns


From thanos at 0x01.com  Thu Feb  7 15:32:57 2002
From: thanos at 0x01.com (thanos@0x01.com)
Date: Fri Jan  9 22:03:03 2004
Subject: [mod_python] MySQL
Message-ID: <20020207203257.19753.qmail@0x01.com>

Has any one had MySQL expiriences ? 

When using cgi's we have exprienced no problems, but the following script 
will often break.

from mod_python import apache

def handler(req):
        import MySQLdb
        req.send_http_header()
        req.write("importd MySQLdb hello world")
        return apache.OK



I think on its first time the httpd execurtes this handler without any outward problems, but on the second time round:

Mod_python error: "PythonHandler testmysql"

Traceback (most recent call last):

  File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line 181, in Dispatch
    module = import_module(module_name, _req)

  File "/usr/local/lib/python2.1/site-packages/mod_python/apache.py", line 356, in import_module
    if os.path.exists(filepath[:-1]) :

  File "/usr/local/lib/python2.1/posixpath.py", line 171, in exists
    st = os.stat(path)

OSError: [Errno 2] No such file or directory: '/usr/home/thanos/public_html/pso/tests/testmsql/testmysql.p'



You can try it out at:

http://www.0x01.com/~thanos/pso/tests/testmsql/mptest.py

Moving the import statement outside the handler will make the handle break every time. I guess this is some sort of clue. 

Any help would be great

thanks

thanos.






From alain at onesite.org  Fri Feb  8 01:01:58 2002
From: alain at onesite.org (Alain Tesio)
Date: Fri Jan  9 22:03:03 2004
Subject: [mod_python] MySQL
In-Reply-To: <20020207203257.19753.qmail@0x01.com>
References: <20020207203257.19753.qmail@0x01.com>
Message-ID: <20020208010158.7f1cf0ae.alain@onesite.org>

On Thu, 7 Feb 2002 15:32:57 -0500 (EST)
thanos@0x01.com wrote:

> OSError: [Errno 2] No such file or directory: > '/usr/home/thanos/public_html/pso/tests/testmsql/testmysql.p'

Hi, I knew I had already seen this problem, this may help:

http://www.modpython.org/pipermail/mod_python/2001-July/001478.html

Alain




From grisha at modpython.org  Thu Feb  7 19:24:52 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:03 2004
Subject: [mod_python] MySQL
In-Reply-To: <20020208010158.7f1cf0ae.alain@onesite.org>
Message-ID: <Pine.BSF.4.32.0202071923260.40345-100000@localhost>

On Fri, 8 Feb 2002, Alain Tesio wrote:

> Hi, I knew I had already seen this problem, this may help:
>
> http://www.modpython.org/pipermail/mod_python/2001-July/001478.html


That post has the wrong answer, the right answer is here:

http://www.modpython.org/FAQ/faqw.py?req=all#2.3

Grisha



From lbergman at abi.tconline.net  Fri Feb  8 11:40:15 2002
From: lbergman at abi.tconline.net (Lewis Bergman)
Date: Fri Jan  9 22:03:03 2004
Subject: [mod_python] confused about add_handler
Message-ID: <200202081740.g18HeFB18176@lewis.abi.tconline.net>

I am having difficulty. I am sure the root of the problem is my own stupidity 
but after 2 days of trying I can't seem to resolve this issue. No errors 
appear in the log. It just seems to ignore my handler and shows an index of 
the directory. I assume from the manual covering this section that this might 
mean the handler is invalid, but I don't think so. I read the "food for 
thought" (the one that says the name of the file doesn't matter) paragraph 
and thought maybe this is it. I don't believe so because that is an externel 
request detail and this is an internal deal.

Here is the situation:
auth.py is set as the authen handler like so
<Directory /var/www/html/ispmgr>
  AddHandler python-program .py
  PythonHandler mod_python.publisher
  PythonAuthenHandler auth
  AuthType Basic
  AuthName "Restricted Area"
  require valid-user
  PythonDebug On
</Directory>

As you can see I am trying to use the publisher.

auth.py looks like this:
from mod_python import apache
def authenhandler(req):
	"""Provide the correct page for the privilege of user."""

	pw = req.get_basic_auth_pw()
	user = req.connection.user
	if user == "admin" and pw == "admin":
		req.add_handler("PythonHandler", "setup::admin")
		return apache.OK
	if user == "operator" and pw == "operator":
		req.add_handler("PythonHandler", "setup::operator")
		return apache.OK
	if user == "user" and pw == "user":
		req.add_handler("PythonHandler", "setup::user")
		return apache.OK
	else:
		return apache.HTTP_UNAUTHORIZED

Later I will replace the statements with db calls (if I can ever get this 
working)

I think this means it should look for the setup file, try to instantiate it 
as setup and try to invoke the method admin. I am sure my logic must be way 
off here.
In case it is required, here is setup.py
class setup:

	def _frame(frameLeft, frameRight):
		"""Sets up frames.
	
		frameleft and frameright will be replaced by the correct menu function.
		"""
		html = """\
			<html>
			<head>
				<title>ISPMgr</title>
				<link rel=stylesheet type="text/css" href="ispmgr.css" title="stylesheet">
			</head>
			<frameset cols="20%%,*">
				<frame src="%s" name="menu">
				<frame src="%s" name="main">
			</frameset>"""% (frameLeft, frameRight)

		return html


	def admin():
		"""Provide all options to admin users."""
		r = _frame('menu.admin', 'main.customer')
		return r

Do all the handlers have to appear in the same file? (auth.py)
Lost and hopeless, please help.
-- 
Lewis Bergman
Texas Communications
4309 Maple St.
Abilene, TX 79602-8044
915-695-6962 ext 115

From grisha at modpython.org  Fri Feb  8 13:32:20 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:03 2004
Subject: [mod_python] confused about add_handler
In-Reply-To: <200202081740.g18HeFB18176@lewis.abi.tconline.net>
Message-ID: <Pine.BSF.4.32.0202081330560.63081-100000@localhost>

Hmm - I don't see anything wrong with this, it should work. Are you able
to get normal authentication going with an .htpasswd file for the same
directory?

Grisha

On Fri, 8 Feb 2002, Lewis Bergman wrote:

> I am having difficulty. I am sure the root of the problem is my own stupidity
> but after 2 days of trying I can't seem to resolve this issue. No errors
> appear in the log. It just seems to ignore my handler and shows an index of
> the directory. I assume from the manual covering this section that this might
> mean the handler is invalid, but I don't think so. I read the "food for
> thought" (the one that says the name of the file doesn't matter) paragraph
> and thought maybe this is it. I don't believe so because that is an externel
> request detail and this is an internal deal.
>
> Here is the situation:
> auth.py is set as the authen handler like so
> <Directory /var/www/html/ispmgr>
>   AddHandler python-program .py
>   PythonHandler mod_python.publisher
>   PythonAuthenHandler auth
>   AuthType Basic
>   AuthName "Restricted Area"
>   require valid-user
>   PythonDebug On
> </Directory>
>
> As you can see I am trying to use the publisher.
>
> auth.py looks like this:
> from mod_python import apache
> def authenhandler(req):
> 	"""Provide the correct page for the privilege of user."""
>
> 	pw = req.get_basic_auth_pw()
> 	user = req.connection.user
> 	if user == "admin" and pw == "admin":
> 		req.add_handler("PythonHandler", "setup::admin")
> 		return apache.OK
> 	if user == "operator" and pw == "operator":
> 		req.add_handler("PythonHandler", "setup::operator")
> 		return apache.OK
> 	if user == "user" and pw == "user":
> 		req.add_handler("PythonHandler", "setup::user")
> 		return apache.OK
> 	else:
> 		return apache.HTTP_UNAUTHORIZED
>
> Later I will replace the statements with db calls (if I can ever get this
> working)
>
> I think this means it should look for the setup file, try to instantiate it
> as setup and try to invoke the method admin. I am sure my logic must be way
> off here.
> In case it is required, here is setup.py
> class setup:
>
> 	def _frame(frameLeft, frameRight):
> 		"""Sets up frames.
>
> 		frameleft and frameright will be replaced by the correct menu function.
> 		"""
> 		html = """\
> 			<html>
> 			<head>
> 				<title>ISPMgr</title>
> 				<link rel=stylesheet type="text/css" href="ispmgr.css" title="stylesheet">
> 			</head>
> 			<frameset cols="20%%,*">
> 				<frame src="%s" name="menu">
> 				<frame src="%s" name="main">
> 			</frameset>"""% (frameLeft, frameRight)
>
> 		return html
>
>
> 	def admin():
> 		"""Provide all options to admin users."""
> 		r = _frame('menu.admin', 'main.customer')
> 		return r
>
> Do all the handlers have to appear in the same file? (auth.py)
> Lost and hopeless, please help.
> --
> Lewis Bergman
> Texas Communications
> 4309 Maple St.
> Abilene, TX 79602-8044
> 915-695-6962 ext 115
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From lbergman at abi.tconline.net  Wed Feb 13 11:21:34 2002
From: lbergman at abi.tconline.net (Lewis Bergman)
Date: Fri Jan  9 22:03:03 2004
Subject: [mod_python] web app framework suggestions?
Message-ID: <200202131721.g1DHLYa31858@lewis.abi.tconline.net>

I have read the manual about a dozen times now.
I think I understand some of what seem to me to be subtleties about 
mod_python. Not to bore anyone but to make sure I do here is what I see that 
has given me the most problems:

mod_python will not directly run a class - I know this is in the manual but I 
didn't catch on to a module being the same thing as a class for some reason. 
I remember something about security about this in the manual so we won't go 
on about inconvenience here.

mod_python will run a class from inside a standard python file or function.

The standard method of linking is to add the current files name to any linked 
argument. - I really had a hard time with this one. I remember the manual 
stating that it adds the current file to the path but I didn't think it was 
talking about this. Meaning that if I want to jump to another file (say 
new.py) from current.py I have to code the entire docroot in so that 
current.py is not appended. a small deal but still took some getting used to. 
I guess you have to default to something huh?

So I guess the question is..
Is there a recommended way to build a semi largish app with mod_python?

Maybe use standard files with functions to front end classes that generate 
pages based on how the classes/methods are called?

I am using this to build a web front end to an ISP package that controls 
billing/activation of customers on linux servers. Many of the tasks will be 
the same for a lot of different system users. For example; An ISP admin will 
need to add customers, just like a agent will. A user, agent, and admin will 
all most likely need to change a user password or username at some point.

So... how best to break these functional areas down. I am leaning to wards 
(and have started coding) classes to generate HTML like forms, results of db 
queries, simple info display, menu generation. I am also thinking of classes 
to do the queries, and such. i am finished with all the classes to do the 
actual system changes (which I thought would be the hard part, I was wrong)

Does this sound reasonable? Is there a better way?

Forgive me for stupid questions but I am pretty new to python, its OO ways,  
and a mod_python baby. I have done a lot of web coding in php but decided on 
python for this because of the scale of it. PHP for all its pluses is only 
faking OO and doesn't seem to scale very well. Namespace can drive you crazy 
on it! I am trying to make this app 100% python because I think in the long 
haul I believe it will be more maintainable.

Any advice would be appreciated.
-- 
Lewis Bergman
Texas Communications
4309 Maple St.
Abilene, TX 79602-8044
915-695-6962 ext 115

From grisha at modpython.org  Wed Feb 13 13:03:20 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:03 2004
Subject: [mod_python] web app framework suggestions?
In-Reply-To: <200202131721.g1DHLYa31858@lewis.abi.tconline.net>
Message-ID: <Pine.BSF.4.32.0202131257070.95676-100000@localhost>

On Wed, 13 Feb 2002, Lewis Bergman wrote:

> mod_python will not directly run a class - I know this is in the manual but I
> didn't catch on to a module being the same thing as a class for some reason.
> I remember something about security about this in the manual so we won't go
> on about inconvenience here.

Not sure what you mean by "running a class", mod_python will instantiate a
class if you specify it as part of a handler. I personally don't see any
value in using class methods as handlers.

Anyway, have you tried using the Publisher standard handler?

Grisha



From tree at basistech.com  Wed Feb 13 13:09:34 2002
From: tree at basistech.com (Tom Emerson)
Date: Fri Jan  9 22:03:03 2004
Subject: [mod_python] web app framework suggestions?
In-Reply-To: <Pine.BSF.4.32.0202131257070.95676-100000@localhost>
References: <200202131721.g1DHLYa31858@lewis.abi.tconline.net>
	<Pine.BSF.4.32.0202131257070.95676-100000@localhost>
Message-ID: <15466.43998.599001.798368@magrathea.basistech.com>

> 
> Anyway, have you tried using the Publisher standard handler?
> 

Indeed. I have had great success using Publisher in conjunction with
AHTS (http://ahts.sf.net) for making sites. Publisher handles dispatch
for me, and AHTS provides me with a good templating mechanism that
allows me to use an MVC model for the apps.

    -tree

-- 
Tom Emerson                                          Basis Technology Corp.
Sr. Computational Linguist                         http://www.basistech.com
  "Beware the lollipop of mediocrity: lick it once and you suck forever"

From cc at carlc.com  Wed Feb 13 14:40:57 2002
From: cc at carlc.com (Carl C.)
Date: Fri Jan  9 22:03:03 2004
Subject: [mod_python] Compiling a DSO module for RedHat Linux on ALPHA 64bit.
Message-ID: <003d01c1b4c6$5bc3fde0$13942c0a@fhpmfg.com>

Hi everyone,

    I'm fairly new to Python and I'm trying to setup the DSO module to use
with an Alpha (64bit) based RedHat 7.1 system.

    I have the following installed as RPMs:

apache-1.3.22-1.7.1
apache-devel-1.3.22-1.7.1

    I've installed Python 2.2 as two different directories:

/usr/src/Python-2.2
/usr/src/Python-2.2-no-threads

    Python 2.2 is compiled as:

./configure --exec-prefix=/usr
make
make test
make install

    and is installed in the system.

    I created the required no-threads version under Python-2.2-nothreads as:

./configure --exec-prefix=/usr --with-threads=no
make
    (did NOT do install, as its just for the mod_python module).

    I then created my mod_python under mod_python-2.7.6 as:

./configure --with-apxs=/usr/sbin/apxs --with-python=/usr/src/Python-2.2-no-threads

    I had to edit the Makefile to get the compileall.py to work:

/usr/src/Python-2.2-no-threads/Lib/compileall.py  (it was ($LIB)/compileall.py).

    I do get a mod_python.so in the proper area and everything does seem to 
build alright. The problem is when I go to start HTTPD with the the
mod_python.so installed (yes, its the first module).

Starting httpd: Syntax error on line 205 of /etc/httpd/conf/httpd.conf:
Cannot load /etc/httpd/modules/mod_python.so into server: /etc/httpd/modules/mod
_python.so: undefined symbol: openpty
[FAILED]
 
    So, I start looking in Python-2.2-no-threads's config files to see where openpty
is coming from:

configure:4873: gcc -o conftest -g -O2   conftest.c -ldl  1>&5
/tmp/ccudvDyk.o: In function `main':
/usr/src/Python-2.2-no-threads/configure:4867: undefined reference to `_getpty'
/usr/src/Python-2.2-no-threads/configure:4867: undefined reference to `_getpty'
collect2: ld returned 1 exit status
configure: failed program was:
#line 4850 "configure"
#include "confdefs.h"
/* System header to define __stub macros and hopefully few prototypes,
    which can conflict with char _getpty(); below.  */
#include <assert.h>
/* Override any gcc2 internal prototype to avoid an error.  */
/* We use char because int might match the return type of a gcc2
    builtin and then its argument prototype would still apply.  */
char _getpty();

int main() {

/* The GNU C library defines this for functions which it implements
    to always fail with ENOSYS.  Some functions are actually named
    something starting with __ and the normal name is an alias.  */
#if defined (__stub__getpty) || defined (__stub____getpty)
choke me
#else
_getpty();
#endif

; return 0; }
configure:4845: checking for getpriority
configure:4873: gcc -o conftest -g -O2   conftest.c -ldl  1>&5
configure:4903: checking for openpty
configure:4931: gcc -o conftest -g -O2   conftest.c -ldl  1>&5
/tmp/ccgNnz9F.o: In function `main':
/usr/src/Python-2.2-no-threads/configure:4925: undefined reference to `openpty'
/usr/src/Python-2.2-no-threads/configure:4925: undefined reference to `openpty'
collect2: ld returned 1 exit status
configure: failed program was:
#line 4908 "configure"
#include "confdefs.h"
/* System header to define __stub macros and hopefully few prototypes,
    which can conflict with char openpty(); below.  */
#include <assert.h>
/* Override any gcc2 internal prototype to avoid an error.  */
/* We use char because int might match the return type of a gcc2
    builtin and then its argument prototype would still apply.  */
char openpty();

int main() {

/* The GNU C library defines this for functions which it implements
    to always fail with ENOSYS.  Some functions are actually named
    something starting with __ and the normal name is an alias.  */
#if defined (__stub_openpty) || defined (__stub___openpty)
choke me
#else
openpty();
#endif

; return 0; }
configure:4953: checking for openpty in -lutil
configure:4972: gcc -o conftest -g -O2   conftest.c -lutil  -ldl  1>&5


So, it appears that it finds it in the util library... But it can't load into
apache???

Anyone else have this problem??? Or have a fix???
Thanks,
Carl
====================
http://www.carlc.com/

      "Price, Performance, Quality. Choose any two you like."


From cc at carlc.com  Wed Feb 13 15:29:35 2002
From: cc at carlc.com (Carl C.)
Date: Fri Jan  9 22:03:04 2004
Subject: [mod_python] Compiling a DSO module for RedHat Linux on ALPHA 64bit.
Message-ID: <005a01c1b4cd$26ea9e10$13942c0a@fhpmfg.com>

----- Original Message ----- 
From: "Carl C." <cc@carlc.com>
Subject: Re: [mod_python] Compiling a DSO module for RedHat Linux on ALPHA 64bit.


Guess, what... I FIXED IT...
 
 I had to edit the mod_python's src/Makefile and change the 
 
 LIBS=-lm  /usr/src/Python-2.2-no-threads/libpython2.2.a
 
 to 
 
 LIBS=-lm  /usr/src/Python-2.2-no-threads/libpython2.2.a -lutil
 
 That -lutil was the magic!
Carl
 
 ====================
 http://www.carlc.com/
 
       "Price, Performance, Quality. Choose any two you like."



From matt at proweb.co.uk  Thu Feb 14 00:26:27 2002
From: matt at proweb.co.uk (Matt H)
Date: Fri Jan  9 22:03:04 2004
Subject: [mod_python] just a hello
Message-ID: <20020214002627.3dfa8dfe.matt@proweb.co.uk>

hi mod_pythoners

hello from a new recruit, hopefully saved from the world of mod_perl and
the gradual weaning away from PHP

my ultimate aim is to do away with Apache and replicate the web server
side in a plan9 fileserver but providing the same API in order to move the
combination on to plan9 which has Python 2.2 but no Apache (and no real
need for porting Apache, other OS's are already better served for that).
That's the journey I'm planning but it's the travelling I'm
looking forward to.

Here goes with my opening question,

how does one gain access to the other provided objects :

the Server object is described as :

The request object is a Python mapping to the Apache request_rec structure. The server structure describes the server (possibly virtual server) serving the request. 

I can see that the request object arrives in my namespace as part of the handler

def handler(request) :
	pass


where can get the server object from to access it's members & methods

TIA

Matt

From matt at proweb.co.uk  Thu Feb 14 00:30:08 2002
From: matt at proweb.co.uk (Matt H)
Date: Fri Jan  9 22:03:04 2004
Subject: [mod_python] hehe I found it
Message-ID: <20020214003008.1d8c582a.matt@proweb.co.uk>

doh

request.server

I was looking for a method 

From djc at object-craft.com.au  Thu Feb 14 19:28:30 2002
From: djc at object-craft.com.au (Dave Cole)
Date: Fri Jan  9 22:03:04 2004
Subject: [mod_python] web app framework suggestions?
In-Reply-To: <200202131721.g1DHLYa31858@lewis.abi.tconline.net>
References: <200202131721.g1DHLYa31858@lewis.abi.tconline.net>
Message-ID: <m3d6z8a2mp.fsf@ferret.object-craft.com.au>

>>>>> "Lewis" == Lewis Bergman <lbergman@abi.tconline.net> writes:

Lewis> So I guess the question is..  Is there a recommended way to
Lewis> build a semi largish app with mod_python?

You could do worse than have a look at our Albatross toolkit.

   http://www.object-craft.com.au/projects/albatross/

Lewis> I am using this to build a web front end to an ISP package that
Lewis> controls billing/activation of customers on linux servers. Many
Lewis> of the tasks will be the same for a lot of different system
Lewis> users. For example; An ISP admin will need to add customers,
Lewis> just like a agent will. A user, agent, and admin will all most
Lewis> likely need to change a user password or username at some
Lewis> point.

Lewis> So... how best to break these functional areas down. I am
Lewis> leaning to wards (and have started coding) classes to generate
Lewis> HTML like forms, results of db queries, simple info display,
Lewis> menu generation. I am also thinking of classes to do the
Lewis> queries, and such. i am finished with all the classes to do the
Lewis> actual system changes (which I thought would be the hard part,
Lewis> I was wrong)

The approach which we think makes the most sense if to separate the
presentation from the implementation.  This allows you to do things
like unit test the stuff which changes your data and implements the
business logic.

Lewis> Does this sound reasonable? Is there a better way?

It depends on your preferred way of working.

Lewis> Forgive me for stupid questions but I am pretty new to python,
Lewis> its OO ways, and a mod_python baby. I have done a lot of web
Lewis> coding in php but decided on python for this because of the
Lewis> scale of it. PHP for all its pluses is only faking OO and
Lewis> doesn't seem to scale very well. Namespace can drive you crazy
Lewis> on it! I am trying to make this app 100% python because I think
Lewis> in the long haul I believe it will be more maintainable.

Quite a few things in Albatross were inspired by PHP.  If you have a
look at our toolkit you might feel partially at home.

We are hoping to release 0.06 next week along with a mailing list...

    https://www.object-craft.com.au/cgi-bin/mailman/listinfo/albatross-users

We might even build a new certificate by then too :-)

- Dave

-- 
http://www.object-craft.com.au


From aaronf at telusplanet.net  Thu Feb 14 18:45:49 2002
From: aaronf at telusplanet.net (Aaron Fransen)
Date: Fri Jan  9 22:03:04 2004
Subject: [mod_python] Re: web app framework suggestions?
Message-ID: <20020215014535.WPCW4620.priv-edtnes15-hme0.telusplanet.net@www.benedictclan.com>




I have a feeling this reply will show up in HTML format only, so my apologies to the group...

Regarding a web app, I think you hit it right on the head. I've use the publisher app and a single module to front an entire application, in fact applications: My first crack at Python is a web-based mail client (http://gomail.dynu.com) which is coming along nicely, and supports groups calendars etc., but for a mail client it was a lot more work than I thought it was going to be!

By comparison, the e-commerce site I created for my employer was simple, but it used the same techniques. In all, each app uses about a dozen separate modules of my own, with two of those being class collections for various functions (ie. html specs, database connectivity).

Now, I never learned Perl or C/C++, but I'm a VB developer since v1.0, and developing a web app in VB was positively painful in comparison. mod_python's a bear to get going the first time, but man, is it stable once it's up and running. If I ever go back to Microsoft, it'll only be to do Python.NET.

Aaron Fransen.

On Feb 14, 2002, Lewis Bergman wrote:

Re: web app framework suggestions? 

I have read the manual about a dozen times now. 
I think I understand some of what seem to me to be subtleties about 
mod_python. Not to bore anyone but to make sure I do here is what I see that 
has given me the most problems: 

mod_python will not directly run a class - I know this is in the manual but I 
didn't catch on to a module being the same thing as a class for some reason. 
I remember something about security about this in the manual so we won't go 
on about inconvenience here. 

mod_python will run a class from inside a standard python file or function. 

The standard method of linking is to add the current files name to any linked 
argument. - I really had a hard time with this one. I remember the manual 
stating that it adds the current file to the path but I didn't think it was 
talking about this. Meaning that if I want to jump to another file (say 
new.py) from current.py I have to code the entire docroot in so that 
current.py is not appended. a small deal but still took some getting used to. 
I guess you have to default to something huh? 

So I guess the question is.. 
Is there a recommended way to build a semi largish app with mod_python? 

Maybe use standard files with functions to front end classes that generate 
pages based on how the classes/methods are called? 

I am using this to build a web front end to an ISP package that controls 
billing/activation of customers on linux servers. Many of the tasks will be 
the same for a lot of different system users. For example; An ISP admin will 
need to add customers, just like a agent will. A user, agent, and admin will 
all most likely need to change a user password or username at some point. 

So... how best to break these functional areas down. I am leaning to wards 
(and have started coding) classes to generate HTML like forms, results of db 
queries, simple info display, menu generation. I am also thinking of classes 
to do the queries, and such. i am finished with all the classes to do the 
actual system changes (which I thought would be the hard part, I was wrong) 

Does this sound reasonable? Is there a better way? 

Forgive me for stupid questions but I am pretty new to python, its OO ways,   
and a mod_python baby. I have done a lot of web coding in php but decided on 
python for this because of the scale of it. PHP for all its pluses is only 
faking OO and doesn't seem to scale very well. Namespace can drive you crazy 
on it! I am trying to make this app 100\% python because I think in the long 
haul I believe it will be more maintainable. 

Any advice would be appreciated. 
-- 
Lewis Bergman 
Texas Communications 
4309 Maple St. 
Abilene, TX 79602-8044 
915-695-6962 ext 115 


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020214/497d1be7/attachment-0003.htm
From dustin at ywlcs.org  Sat Feb 16 10:24:37 2002
From: dustin at ywlcs.org (Dustin Mitchell)
Date: Fri Jan  9 22:03:04 2004
Subject: [mod_python] More ugly "make_obcallback returned no obCallBack!" errors.
Message-ID: <20020216162436.GC14969@eleanor.internal.ywlcs.org>

These don't seem to have anything to do with bad paths.  Here's the situation:

I have two name-based virtualhosts, each using mod_python.  They both use a
number of handlers.  Here are the relevant directives in the httpd.conf for
each vhost:

  PythonAutoReload Off
  PythonDebug on
  PythonTransHandler handlers.translate::transhandler
  PythonHeaderParserHandler handlers.headers::cookies
  PythonHeaderParserHandler handlers.headers::formdata handlers.headers::login
  PythonAuthenHandler handlers.auth::check
  PythonLogHandler handlers.log::log

I'm using Apache/1.3.22 (Unix) PHP/4.1.1 mod_python/2.7.6 Python/2.1
mod_ssl/2.8.5 OpenSSL/0.9.6.

So here's what happens:  Each Apache "server" (i.e., operating system
process, as differentiated by PIDs) only seems to be able to serve one of the
two virtualhosts -- the other virtualhost will present "Internal Server
Error" with the logs listing errors importing modules for make_obcallback,
and the infamous "make_obcallback returned no obCallBack!" error.

From grisha at modpython.org  Sat Feb 16 13:14:47 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:04 2004
Subject: [mod_python] More ugly "make_obcallback returned no obCallBack!"
 errors.
In-Reply-To: <20020216162436.GC14969@eleanor.internal.ywlcs.org>
Message-ID: <Pine.BSF.4.32.0202161312001.67126-100000@localhost>

This looks like a bug, I'll have to take a look at it later.

As dirty work-around, try forcing the interpreter name by putting

PythonIntepreter my_interpreter

in the config at the top level (i.e. outside virtual servers)

This will, of course, make the virtual servers run in the same
interpreter, but it might solve the immediate problem, as I supsect it is
something with subinterpreters...

Grisha

On Sat, 16 Feb 2002, Dustin Mitchell wrote:

> These don't seem to have anything to do with bad paths.  Here's the situation:
>
> I have two name-based virtualhosts, each using mod_python.  They both use a
> number of handlers.  Here are the relevant directives in the httpd.conf for
> each vhost:
>
>   PythonAutoReload Off
>   PythonDebug on
>   PythonTransHandler handlers.translate::transhandler
>   PythonHeaderParserHandler handlers.headers::cookies
>   PythonHeaderParserHandler handlers.headers::formdata handlers.headers::login
>   PythonAuthenHandler handlers.auth::check
>   PythonLogHandler handlers.log::log
>
> I'm using Apache/1.3.22 (Unix) PHP/4.1.1 mod_python/2.7.6 Python/2.1
> mod_ssl/2.8.5 OpenSSL/0.9.6.
>
> So here's what happens:  Each Apache "server" (i.e., operating system
> process, as differentiated by PIDs) only seems to be able to serve one of the
> two virtualhosts -- the other virtualhost will present "Internal Server
> Error" with the logs listing errors importing modules for make_obcallback,
> and the infamous "make_obcallback returned no obCallBack!" error.
>
> >From the perspective of a single "server" (checked by setting
> MaxSpareServers, MinSpareServers, and StartServers to 1), it can load
> virtualhost A as many times as it would like.  Once a request comes in for
> virtualhost B, however, obCallBack problems occur.  It doesn't matter which
> virtualhost is loaded first -- it will be successful, and the second
> virtualhost will not.
>
> I've tried some tricks to see exactly what the Python exception is when
> mod_python can't load 'apache', but I'm not an extension-writer, and my
> feeble attempts produced only segfaults.
>
> WITH_THREAD is not set.
>
> Any ideas?
>
> Dustin
>
> --
>
>   Dustin Mitchell
>   dustin@ywlcs.org
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://www.modpython.org/mailman/listinfo/mod_python
>


From grisha at modpython.org  Sat Feb 16 14:22:37 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:04 2004
Subject: [mod_python] Shameless mod_python market analysis
Message-ID: <Pine.BSF.4.32.0202161412050.67806-100000@localhost>

Excuse my off-topic sobject, but I am interested in getting some
information:

Do you or your bosses sometimes wish that there was a place they could go
to get consulting on running your (high-volume reliable and redundand)
website, including (but not limited to) mod_python support?

If yes, then is the need strong enough that you would actually be willing
to *pay* for such consulting?

We are considering starting a company that would specialize in this sort
of thing to help keep alive and promote mod_python better, and I would
appreciate an opinion from the list subscribers. The idea is that I and a
few other developers could actually make some money working on it and
thereby be able to allot much more time for it.

Thanks,

Grisha


From brieu.daniel at wanadoo.fr  Sun Feb 17 11:12:25 2002
From: brieu.daniel at wanadoo.fr (Daniel Brieu)
Date: Fri Jan  9 22:03:04 2004
Subject: [mod_python] python's directives in httpd.conf
Message-ID: <006b01c1b79b$99386b70$548080d9@jany>

Hi, 
Sorry, but I'm a french newbie and didn't managed to find an answer to my question in the mailing-list archive :

I managed to run mptest.py ("Hello World" of official doc) with Apache win32 but I don't manage to run the others python scripts :
When I run the other python scripts, my browser show me "hello world"...the same result than mptest.py !!

I think I must add or modify other apache python's directives. So 
- I woud like to get a good httpd.conf for Apache win32 and Python module which works.
- some information about the "standard" headers of python scripts running in Apache web server.
- Some examples of python scripts running in Apache web server.

thanks a lot !
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20020217/d804756c/attachment-0003.htm
From modpython at xhaus.com  Sun Feb 17 07:36:32 2002
From: modpython at xhaus.com (Alan Kennedy)
Date: Fri Jan  9 22:03:04 2004
Subject: [mod_python] python's directives in httpd.conf
Message-ID: <200202171247.HAA139374@spool2.valueweb.net>

Daniel,

> I managed to run mptest.py ("Hello World" of official
> doc) with Apache win32 but I don't manage to run the
> others python scripts :
> When I run the other python scripts, my browser show
> me "hello world"...the same result than mptest.py !!

The answer to this question depends on your configuration. 
If your configuration looks something like this

<Directory "/some/directory/">
    AddHandler python-program .py
    PythonHandler mptest
</Directory>

Then what you're telling Apache is "Run mptest.py whenever 
anyone requests a URI in the directory "/some/directory" 
which has the extension ".py". So *all* of the following 
URIs result in the same call to the "handler" function 
of "mptest.py".

http://someserver.com/some/directory/mptest.py
http://someserver.com/some/directory/anotherscript.py
http://someserver.com/some/directory/theScriptNameDoesNotMat
ter.py

The important section of the manual to understand is 
section 3.2: So what Exactly does Mod-python do? 

http://www.modpython.org/live/mod_python-2.7.6/doc-html/tut-
what-it-do.html

In particular, you must understand the section at the 
bottom called "Some food for thought".

> I think I must add or modify other apache python's 
directives. So 
> - I woud like to get a good httpd.conf for Apache win32 
and Python
> module which works.

"Works" is a relative thing. "Works" for what purpose is 
more the right question to ask. I've found that the bare 
minimum changes to a httpd.conf for mod_python are two 
changes, 

1. to load the modpython module, and 
2. to set up a handler module/function. 

These are handled as follows

1. Start with a clean httpd.conf from the Apache 
installation, and add the following entries.

LoadModule python_module modules/mod_python.{dll|so}

There should be a list of "LoadModule"s in the default 
httpd.conf, just put it with them. Probably best to put it 
before any other "LoadModule".

Then add a python handler for whichever directories you 
wish. The following directive indicates that 
myPythonHandler.py should be run whenever any URI ending 
in ".py" is requested anywhere in the document tree.

<Directory /my/document/root/>
   AddHandler python-program .py
   PythonHandler myPythonHandler
</Directory>

So whenever a request arrives for any URI ending in ".py", 
anywhere in the document hierarchy, at any level, then 
the "handler" function in the module "myPythonHandler.py" 
will be run. 

> - some information about the "standard" headers of python 
scripts
> running in Apache web server.

I'm not sure what you mean by "headers". This is not CGI, 
so you don't need shebang lines, or anything like that. The 
only headers you need to know about are the HTTP headers 
sent back with each http response, such as "Content-
type", "Content-length", "Content-encoding", and so on. 
These are set in your handler function as follows

def	handler(req):
	req.content_type = "text/html"
	req.headers_out['Content-Length'] = str(length)

Hopefully this well help you get configured and running.

Bon chance,

Alan.


---------------------------------------------
This message was sent using WebMail by CyberGate.
http://www.gate.net/webmail



From balld at webslingerZ.com  Tue Feb 19 17:16:29 2002
From: balld at webslingerZ.com (Donald Ball)
Date: Fri Jan  9 22:03:04 2004
Subject: [mod_python] -DEAPI support in configure?
Message-ID: <Pine.LNX.4.33L2.0202191711240.1670-100000@localhost.localdomain>

i use mod_python as a DSO in an apache httpd + mod_ssl installation. i
understand that i can compile mod_python using EAPI by manually editing
src/Makefile and adding -DEAPI to the OPT variable after configuring
mod_python. is that correct?

seems to me, though, that there ought to be a way to pass that as a
configuration option to the configure script. then i can record my
configure options in a my_configure script like i do for all of my other
daemons and not have to worry about me, or whoever comes after me,
remembering to manually edit src/Makefile afterwards. is there a way to do
that? if not, could i request that feature? i regret that i have only a
user's familiarity with autoconf and cannot patch it myself. thanks.

- donald


From lbergman at abi.tconline.net  Tue Feb 19 16:36:47 2002
From: lbergman at abi.tconline.net (Lewis Bergman)
Date: Fri Jan  9 22:03:04 2004
Subject: [mod_python] -DEAPI support in configure?
In-Reply-To: <Pine.LNX.4.33L2.0202191711240.1670-100000@localhost.localdomain>
References: <Pine.LNX.4.33L2.0202191711240.1670-100000@localhost.localdomain>
Message-ID: <200202192236.g1JMalI22476@lewis.abi.tconline.net>

> seems to me, though, that there ought to be a way to pass that as a
> configuration option to the configure script.
I'll second that.
-- 
Lewis Bergman
Texas Communications
4309 Maple St.
Abilene, TX 79602-8044
915-695-6962 ext 115

From ps0 at igmp.com.ar  Wed Feb 20 12:56:36 2002
From: ps0 at igmp.com.ar (ps0@igmp.com.ar)
Date: Fri Jan  9 22:03:04 2004
Subject: [mod_python] .pyc and .pyo bytecode files under mod_python ?
In-Reply-To: <200202201549.g1KFn1S32901@eden.ispol.com>; from mod_python-request@modpython.org on Wed, Feb 20, 2002 at 10:49:01AM -0500
References: <200202201549.g1KFn1S32901@eden.ispol.com>
Message-ID: <20020220125636.C2535@igmp.com.ar>

Hi, my question is :
 
 Could be possible execution of .pyc and .pyo files under mod_python ? how ?
 I probe adding a AddHandler python-program .pyc , but doesn't work.

 I need to run .pyc and .pyo for a specific proyect, so Im a problem if it
 can't be possible.
 
Tnks a lot.

Hector.

From grisha at modpython.org  Wed Feb 20 11:01:32 2002
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:03:04 2004
Subject: [mod_python] .pyc and .pyo bytecode files under mod_python ?
In-Reply-To: <20020220125636.C2535@igmp.com.ar>
Message-ID: <Pine.BSF.4.32.0202201100150.33059-100000@localhost>

On Wed, 20 Feb 2002 ps0@igmp.com.ar wrote:

> Hi, my question is :
>
>  Could be possible execution of .pyc and .pyo files under mod_python ? how ?
>  I probe adding a AddHandler python-program .pyc , but doesn't work.

It should work, can you elaborate?

>  I need to run .pyc and .pyo for a specific proyect, so Im a problem if it
>  can't be possible.

Even if you specify .py, the Python interpreter will use a .pyc or .pyo if
one exists.

Grisha


From mike at mikebell.org  Wed Feb 20 13:00:13 2002
From: mike at mikebell.org (mike@mikebell.org)
Date: Fri Jan  9 22:03:04 2004
Subject: [mod_python] .pyc and .pyo bytecode files under mod_python ?
In-Reply-To: <20020220125636.C2535@igmp.com.ar>
References: <200202201549.g1KFn1S32901@eden.ispol.com> <20020220125636.C2535@igmp.com.ar>
Message-ID: <20020220210012.GW3517@mikebell.org>

On Wed, Feb 20, 2002 at 12:56:36PM -0300, ps0@igmp.com.ar wrote:
> Hi, my question is :
>  
>  Could be possible execution of .pyc and .pyo files under mod_python ? how ?
>  I probe adding a AddHandler python-program .pyc , but doesn't work.
> 
>  I need to run .pyc and .pyo for a specific proyect, so Im a problem if it
>  can't be possible.

.pyc files should be created automatically, all you need to do is insure
that the directory from which your mod_python scripts are being run is
writable to your web server, otherwise it cannot create the .pyc files.
Setting PythonOptimize to on will result in the creation of .pyo files.

From dustin at ywlcs.org  Wed Feb 20 16:26:15 2002
From: dustin at ywlcs.org (Dustin Mitchell)
Date: Fri Jan  9 22:03:04 2004
Subject: [mod_python] .pyc and .pyo bytecode files under mod_python ?
In-Reply-To: <20020220210012.GW3517@mikebell.org>
References: <200202201549.g1KFn1S32901@eden.ispol.com> <20020220125636.C2535@igmp.com.ar> <20020220210012.GW3517@mikebell.org>
Message-ID: <20020220222615.GG14969@eleanor.internal.ywlcs.org>

On Wed, Feb 20, 2002 at 01:00:13PM -0800, mike@mikebell.org wrote:
> .pyc files should be created automatically, all you need to do is insure
> that the directory from which your mod_python scripts are being run is
> writable to your web server, otherwise it cannot create the .pyc files.
> Setting PythonOptimize to on will result in the creation of .pyo files.

Be **very** careful if you do this -- the security implications of allowing
write access to your source files are pretty enormous.  For example, if
someone can write a file to your system (perhaps through a bug in a
file-upload system?), they can upload their own program to do whatever damage
they would like.

My approach to .pyo/c files has been to run a short script that uses the
Python compile module to compile all of the source files in the site.  Since
I run the script as me (not as the user running the web server) all of the
.pyo/c files are owned by me and not writeable by the web server.

My $0.02.

Dustin

-- 

  Dustin Mitchell
  dustin@ywlcs.org

From mike at mikebell.org  Wed Feb 20 14:51:42 2002
From: mike at mikebell.org (mike@mikebell.org)
Date: Fri Jan  9 22:03:04 2004
Subject: [mod_python] .pyc and .pyo bytecode files under mod_python ?
In-Reply-To: <20020220222615.GG14969@eleanor.internal.ywlcs.org>
References: <200202201549.g1KFn1S32901@eden.ispol.com> <20020220125636.C2535@igmp.com.ar> <20020220210012.GW3517@mikebell.org> <20020220222615.GG14969@eleanor.internal.ywlcs.org>
Message-ID: <20020220225142.GY3517@mikebell.org>

On Wed, Feb 20, 2002 at 04:26:15PM -0600, Dustin Mitchell wrote:
> Be **very** careful if you do this -- the security implications of allowing
> write access to your source files are pretty enormous.  For example, if
> someone can write a file to your system (perhaps through a bug in a
> file-upload system?), they can upload their own program to do whatever damage
> they would like.

Well, you can still have the programs within the writable directory owned by
someone else and only readable by the web server's UID, however this still
allows one to upload bad .pyo files. I'm not sure whether python has any
checks other than mtime but I imagine one could do /something/ malicious in
this manner.

From ps0 at igmp.com.ar  Thu Feb 21 17:55:52 2002
From: ps0 at igmp.com.ar (ps0@igmp.com.ar)
Date: Fri Jan  9 22:03:04 2004
Subject: [mod_python] .pyc and .pyo bytecode files under mod_python ?
In-Reply-To: <20020220225142.GY3517@mikebell.org>; from mike@mikebell.org on Wed, Feb 20, 2002 at 02:51:42PM -0800
References: <200202201549.g1KFn1S32901@eden.ispol.com> <20020220125636.C2535@igmp.com.ar> <20020220210012.GW3517@mikebell.org> <20020220222615.GG14969@eleanor.internal.ywlcs.org> <20020220225142.GY3517@mikebell.org>
Message-ID: <20020221175551.A5599@igmp.com.ar>

I think we are in a confusion , I will explain my problem more deep with a
simple real example :

I need : 1) Build a web aplication in python
         2) Buy this application to a client
	 3) I don't want the client has the source code of the .py files so
	    i need to include ONLY .pyc or .pyo bytecode files on that 
	    aplication, I know the blah blah about the posibility of decompile
	    .pyc and .pyo files but the client is too stupid to do that.

So , In my test lab I mount a apache+mod_python with this configuration :

http.conf :

[.......]
<Directory /var/www/test2>
AddHandler puthon-program .pyc
PythonHandler mod_python.publisher
PythonDebug On
</Directory>
[........]

Contents of the /var/www/test2 dir :

-rwxr-xr-x  1 www-data www-data 186 hello.pyc

and I try this :

links http://localhost/test2/hello/say

And obtain this :

Forbidden
You don't have permission to access /test2/hello/hello.py on this server

The contents of hello.py ( not compiled and in another directory ) :

def say(req):
 req.content_type="text/plain"
 req.send_http_header()
 s="HELLO WORLD !"
 return s
 
 
 If I try via the usual method ( using .py file and 
 AddHandler puthon-program .py , works pefect.
 

Tnks a lot !

From ps0 at igmp.com.ar  Thu Feb 21 18:24:19 2002
From: ps0 at igmp.com.ar (ps0@igmp.com.ar)
Date: Fri Jan  9 22:03:04 2004
Subject: [mod_python] .pyc and .pyo files my faulf thread terminated
Message-ID: <20020221182419.A23910@igmp.com.ar>

Sorry about my stupid question , was my fault , There was 2 problems :

1) A permission problems
2) I was compiled .pyc files with an different version of Python that the
   mod_python work.

Now, all .pyc and .pyo files are executed perfectly !

Tnks to all that help to solve my problem.

Best Regards.

Hector.

From stephen_m_mcallister at hotmail.com  Fri Feb 22 18:45:22 2002
From: stephen_m_mcallister at hotmail.com (Stephen M. McAllister)
Date: Fri Jan  9 22:03:04 2004
Subject: [mod_python] Newbie question for mod_perl, Apache and ActivePython on Win32
Message-ID: <OE25jrhwm5Tfv2ZAdYR000177cc@hotmail.com>

I am trying to install and config mod_perl on a Win2k/SP2 server running the
latest Apache V1.3.23 and ActiveState ActivePython V2.1 <groan>. I read lot
of posts and FAQ's and I am still confused. The modperl.org Windows Appendix
A is totally inadequate. I still get the following error while trying to
load the mod_python in my environment.

httpd.conf snippet ==>  LoadModule python_module modules/mod_python.dll

Causes error when starting Apache => "Syntax error on line 195 of
c:/apache/apache/conf/httpd.conf:
Cannot load c:/apache/apache/modules/mod_python.dll into server: (126) The
specified module could not be found:"


I tried a number of things and got nowhere.

So my questions for trying to get Python running on Win2k with Active State
Python are:
----------------------------------------------------------------------------
-------------
1. What version of Apache for Win32 should I be running?
2. What version of ActiveState Python should I be running?
3. What version of mod_perl should I be running?
4. How can I debug what is going on so I can catch misconfigurations?
5. Does PYTHONPATH matter at all for mod_python? (mine is not set as a path
var, but is set in the registry)
6. How is it that mod_perl knows what Python interpreter to use? Does it
read the registry or PYTHONPATH or what?

Thanks a bunch!
--Steve

From modpython at xhaus.com  Sat Feb 23 08:21:21 2002
From: modpython at xhaus.com (Alan Kennedy)
Date: Fri Jan  9 22:03:04 2004
Subject: [mod_python] Newbie question for mod_perl, Apache and ActivePython on Win32
Message-ID: <200202231332.IAA268450@spool4.valueweb.net>

> I am trying to install and config mod_perl on a Win2k/SP2
> server running the latest Apache V1.3.23 .... 

> I am still confused. The modperl.org Windows Appendix
> A is totally inadequate. 

> I still get the following error while trying to
> load the mod_python in my environment.

Sorry, you've got me confused as well. Are you trying to 
install mod_python, mod_perl or both mod_python AND 
mod_perl?

Alan.



---------------------------------------------
This message was sent using WebMail by CyberGate.
http://www.gate.net/webmail



From smcallister at msn.com  Sat Feb 23 09:06:48 2002
From: smcallister at msn.com (Stephen M. McAllister)
Date: Fri Jan  9 22:03:04 2004
Subject: [mod_python] Newbie question for mod_perl, Apache and ActivePython on Win32
References: <200202231332.IAA268450@spool4.valueweb.net>
Message-ID: <OE75RIw7eJq02aXkSHA000267d5@hotmail.com>

> > I am trying to install and config mod_perl on a Win2k/SP2
> > server running the latest Apache V1.3.23 ....
Ooops...I meant mod_python...I was in a bit of a hurry when I posted this. I
already had Apache installed and was using the ActivePython-2.1.1.msi
distribution. I want to try and use these if possible. I am trying to
understand just what versions work with what. I don't mind uninstalling
these and installing older versions or other distributions, but I wanted to
see if I can get what I currently running to work with mod_python. Should I
not be using ActiveState Python?


> > I am still confused. The modperl.org Windows Appendix
> > A is totally inadequate.
I meant the Appendix in the following link that explains how to setup
mod_python on a Windows box.
http://www.modpython.org/live/mod_python-2.7.6/doc-html/app-wininst.html


> > I still get the following error while trying to
> > load the mod_python in my environment.
I was attempting to show the line in my httpd.conf files that was causing
Apache to not start.
Commenting the line out allows Apache to start.


> Sorry, you've got me confused as well. Are you trying to
> install mod_python, mod_perl or both mod_python AND
> mod_perl?
Sorry about that....For now I just want to install and configure mod_python
in my current environment if possible. I will want to install mod_perl
later, but not for a while.

--Steve


----- Original Message -----
From: "Alan Kennedy" <modpython@xhaus.com>
To: "Stephen M. McAllister" <stephen_m_mcallister@hotmail.com>;
<mod_python@modpython.org>
Sent: Saturday, February 23, 2002 2:21 AM
Subject: Re: [mod_python] Newbie question for mod_perl, Apache and
ActivePython on Win32


> > I am trying to install and config mod_perl on a Win2k/SP2
> > server running the latest Apache V1.3.23 ....
>
> > I am still confused. The modperl.org Windows Appendix
> > A is totally inadequate.
>
> > I still get the following error while trying to
> > load the mod_python in my environment.
>
> Sorry, you've got me confused as well. Are you trying to
> install mod_python, mod_perl or both mod_python AND
> mod_perl?
>
> Alan.


From modpython at xhaus.com  Sat Feb 23 11:06:52 2002
From: modpython at xhaus.com (Alan Kennedy)
Date: Fri Jan  9 22:03:04 2004
Subject: [mod_python] Newbie question for mod_perl, Apache and ActivePython on Win32
Message-ID: <200202231618.LAA96476@spool7.valueweb.net>

> Should I not be using ActiveState Python?

Hmm, it shouldn't make much difference. Activestate still 
give you a standard command-line python interpreter, don't 
they? Namely, you can type "python.exe" on a command prompt 
and get an interactive python interpreter?

I haven't used ActivePython, so I can't give any definitive 
answers about it. But I would say that if you're concerned 
that ActivePython may be causing the problem, then you 
should switch to a standard python distribution, which you 
can get from www.python.org. I recommend version 2.1.2 or 
2.1.1.

> I meant the Appendix in the following link that explains
> how to setup mod_python on a Windows box.

Hmm, I followed those same instructions, and it all worked 
fine for me. The versions I use are

Apache 1.3.23
Python 2.1.1
Mod Python 2.7.6

All on Windows 2000 SP2.

The location where you put the "LoadModule" command in your 
httpd.conf can be significant. Try placing the "LoadModule" 
command before *all* other LoadModule commands in the 
httpd.conf and see if that makes a difference.

Also, are you certain that you're placing the file 
mod_python.dll in the correct directory. It should be in 
the "modules" subdirectory of the Apache installation, i.e. 
in the same directory as files such 
as "mod_rewrite.so", "mod_speling.so", etc.

As a tip, I always rename the mod_python.dll to contain the 
version number, i.e. mod_python276.dll so I always know 
which DLL I am using. So my LoadModule command has to refer 
to "modules/mod_python276.dll".

> I was attempting to show the line in my httpd.conf 
> files that was causing Apache to not start.
> Commenting the line out allows Apache to start.

Is there any information in the server logs as to why it 
might be failing? Check the file <apacheinst>/logs/error.log

> Sorry about that....For now I just want to install
> and configure mod_python in my current environment if
> possible. I will want to install mod_perl later, but
> not for a while.

Now what would you want to go installing mod_perl for? All 
that "executable line noise" ;-)

I'm sure you'll find that Python will easily do all that 
you need.

Only kidding about the Perl thing. But it's definitely a 
good idea to get one working first before trying to get the 
other working.

Best of luck,

Alan.



---------------------------------------------
This message was sent using WebMail by CyberGate.
http://www.gate.net/webmail



From conrad at hep.caltech.edu  Mon Feb 25 13:37:27 2002
From: conrad at hep.caltech.edu (Conrad Steenberg)
Date: Fri Jan  9 22:03:04 2004
Subject: [mod_python] Client certificate?
Message-ID: <1014673047.9352.10.camel@heppc22.cithep.caltech.edu>

Hi

I've been using mod_python for a while now, and it works great, hats of
to Grisha and the other contributors :-)

Having an SSL-enabled Apache works transparently, but it would be useful
to access some of the internals stored by the mod_ssl module.
Specifically, I'm trying to access the client certificate presented to
the server, either for logging or authentication purposes.

Is this possibly stored in a mp_table object that can be accessed?

Any ideas welcome!

Conrad

-- 
*-----------------------------------------*
| Conrad Steenberg                        |
| Caltech, Mail Code 356-48               |
| Pasadena, CA, 91125                     |
| e-mail: conrad@hep.caltech.edu          |
| Tel: (626) 395-8758                     |
*-----------------------------------------*


From bbrown at icce-t.com  Mon Feb 25 16:20:54 2002
From: bbrown at icce-t.com (Brian Brown)
Date: Fri Jan  9 22:03:04 2004
Subject: [mod_python] Compiling on MacOS X
Message-ID: <2174778112.1014679254@kelethin>

Greetings!
  I am trying to compile mod_python 2.7.6 on MacOS 10.1.3 with no success. 
I get the following:

cc: cannot specify -o with -c or -S with multiple compilations


I tried to take the -c out of the src/Makefile, but it had no effect on the 
make process... any ideas?

Brian

/-----------------
Brian Brown
ICCE Technologies, Inc.
http://www.icce-t.com

From rsalz at zolera.com  Mon Feb 25 20:52:08 2002
From: rsalz at zolera.com (Rich Salz)
Date: Fri Jan  9 22:03:04 2004
Subject: [mod_python] Client certificate?
References: <1014673047.9352.10.camel@heppc22.cithep.caltech.edu>
Message-ID: <3C7AEA48.494CF46E@zolera.com>

I am sure there are other approaches, but here is what we did.

We were already using SWIG (www.swig.org).  I added ONE function to the
the request object, get_swig_handle.  This returns a SWIG-compatible
handle to the real apache request object:
+static PyObject * req_get_swig_handle(requestobject *self, PyObject
*args)
+{
+    char ptrbuff[128];
+    SWIG_MakePtr(ptrbuff, (char *)self->request_rec, "_request_rec_p");
+    return Py_BuildValue("s", ptrbuff);
+}

Then it's pretty easy for us to write SWIG-wrapped functions that get
any mod_ssl data we want:

int
UsingSSL(request_rec* r)
{
    return ap_ctx_get(r->connection->client->ctx, "ssl") != NULL;
}


I can send more details if necessary ...
-- 
Zolera Systems, Securing web services (XML, SOAP, Signatures,
Encryption)
http://www.zolera.com

From conrad at hep.caltech.edu  Tue Feb 26 10:49:54 2002
From: conrad at hep.caltech.edu (Conrad Steenberg)
Date: Fri Jan  9 22:03:04 2004
Subject: [mod_python] Client certificate?
In-Reply-To: <3C7AEA48.494CF46E@zolera.com>
References: <1014673047.9352.10.camel@heppc22.cithep.caltech.edu> 
	<3C7AEA48.494CF46E@zolera.com>
Message-ID: <1014749396.9352.41.camel@heppc22.cithep.caltech.edu>

Hi Rich

On Mon, 2002-02-25 at 17:52, Rich Salz wrote:
> I am sure there are other approaches, but here is what we did.
> 
> We were already using SWIG (www.swig.org).  I added ONE function to the
> the request object, get_swig_handle.  This returns a SWIG-compatible
> handle to the real apache request object:
> +static PyObject * req_get_swig_handle(requestobject *self, PyObject
> *args)
> +{
> +    char ptrbuff[128];
> +    SWIG_MakePtr(ptrbuff, (char *)self->request_rec, "_request_rec_p");
> +    return Py_BuildValue("s", ptrbuff);
> +}

Just to clarify, this was done in your own apache module or a patch to
mod_python?

> 
> Then it's pretty easy for us to write SWIG-wrapped functions that get
> any mod_ssl data we want:
> 
> int
> UsingSSL(request_rec* r)
> {
>     return ap_ctx_get(r->connection->client->ctx, "ssl") != NULL;
> }
> 

And this is in your own Python module (which was also linked against
apache)?

> 
> I can send more details if necessary ...

I think my flu-fried brain would appreciate it :-)

Conrad

-- 
*-----------------------------------------*
| Conrad Steenberg                        |
| Caltech, Mail Code 356-48               |
| Pasadena, CA, 91125                     |
| e-mail: conrad@hep.caltech.edu          |
| Tel: (626) 395-8758                     |
*-----------------------------------------*


From rsalz at zolera.com  Tue Feb 26 18:38:39 2002
From: rsalz at zolera.com (Rich Salz)
Date: Fri Jan  9 22:03:04 2004
Subject: [mod_python] Client certificate?
References: <1014673047.9352.10.camel@heppc22.cithep.caltech.edu> 
		<3C7AEA48.494CF46E@zolera.com> <1014749396.9352.41.camel@heppc22.cithep.caltech.edu>
Message-ID: <3C7C1C7F.30E01AC6@zolera.com>

Okay, let me try to be more explicit.

We use SWIG (www.swig.org).  SWIG can parse header files and generate
modules for various scripting languages, including Python.  So, for
example, a SWIG interface file might say
	int UsingSSL(request_rec* r);
	char* GetClientDN(request_rec* r);
and so on.  The actual implementation of those functions tend to be
fairly short Apache ap_xxx calls, such as

int
UsingSSL(request_rec* r)
{
    return ap_ctx_get(r->connection->client->ctx, "ssl") != NULL;
}

We can create an Apache module that has our "swigged" extensions, and
build that into Apache.  (Or make it a shared library, DSO, whatever.)

The only "trick" is how to get that request_rec pointer.  It turns out
to be not that hard, because SWIG actually uses strings to represent
pointers.

So, we patched mod_python to add a new method to the mod_python request
object; this new method returns a swig-compatible pointer(string) up to
Python.  From python code, then, we can call the SWIG functions we wrote
as described above.

So, in our case,
	from zolera import pyssl
	h = req.get_swig_handle()
	if h.UsingSSL():
		dn = h.GetClientDN()
	else:
		return Apache.Unauthorized

We have found it easier (again, since we were already using SWIG), to
just add the one function to mod_python, and then to use SWIG for
everything else.

Hope this helps.
	/r$
-- 
Zolera Systems, Securing web services (XML, SOAP, Signatures,
Encryption)
http://www.zolera.com

From conrad at hep.caltech.edu  Tue Feb 26 15:40:23 2002
From: conrad at hep.caltech.edu (Conrad Steenberg)
Date: Fri Jan  9 22:03:04 2004
Subject: [mod_python] Client certificate?
In-Reply-To: <3C7C1C7F.30E01AC6@zolera.com>
References: <1014673047.9352.10.camel@heppc22.cithep.caltech.edu> 
	<3C7AEA48.494CF46E@zolera.com>
	<1014749396.9352.41.camel@heppc22.cithep.caltech.edu> 
	<3C7C1C7F.30E01AC6@zolera.com>
Message-ID: <1014766824.9347.44.camel@heppc22.cithep.caltech.edu>

Thanks, this helps clarify things.

Cheers!

Conrad

On Tue, 2002-02-26 at 15:38, Rich Salz wrote:
> Okay, let me try to be more explicit.
> 
> We use SWIG (www.swig.org).  SWIG can parse header files and generate
> modules for various scripting languages, including Python.  So, for
> example, a SWIG interface file might say
> 	int UsingSSL(request_rec* r);
> 	char* GetClientDN(request_rec* r);
> and so on.  The actual implementation of those functions tend to be
> fairly short Apache ap_xxx calls, such as
> 
> int
> UsingSSL(request_rec* r)
> {
>     return ap_ctx_get(r->connection->client->ctx, "ssl") != NULL;
> }
> 
> We can create an Apache module that has our "swigged" extensions, and
> build that into Apache.  (Or make it a shared library, DSO, whatever.)
> 
> The only "trick" is how to get that request_rec pointer.  It turns out
> to be not that hard, because SWIG actually uses strings to represent
> pointers.
> 
> So, we patched mod_python to add a new method to the mod_python request
> object; this new method returns a swig-compatible pointer(string) up to
> Python.  From python code, then, we can call the SWIG functions we wrote
> as described above.
> 
> So, in our case,
> 	from zolera import pyssl
> 	h = req.get_swig_handle()
> 	if h.UsingSSL():
> 		dn = h.GetClientDN()
> 	else:
> 		return Apache.Unauthorized
> 
> We have found it easier (again, since we were already using SWIG), to
> just add the one function to mod_python, and then to use SWIG for
> everything else.
> 
> Hope this helps.
> 	/r$
> -- 
> Zolera Systems, Securing web services (XML, SOAP, Signatures,
> Encryption)
> http://www.zolera.com
-- 
*-----------------------------------------*
| Conrad Steenberg                        |
| Caltech, Mail Code 356-48               |
| Pasadena, CA, 91125                     |
| e-mail: conrad@hep.caltech.edu          |
| Tel: (626) 395-8758                     |
*-----------------------------------------*


