From jay at jaydorsey.com  Mon Dec  1 11:22:03 2003
From: jay at jaydorsey.com (Jay Dorsey)
Date: Fri Jan  9 21:47:56 2004
Subject: [mod_python] Mailing list archive link
Message-ID: <20031201172203.GA32445@gentoo.Earthlink.net>

I was trying to download the mailing list archives this morning. From the front page of http://www.modpython.org I clicked on the "Mailing list archives are here" link. The "download the full raw archive" link points to http://www.modpython.org/pipermail/mod_python.mbox/mod_python.mbox which is a 404. Clicking the "more information about this list" link, which took me to the mailman page, then clicking the "Mod python archives" link took me to a page that was similar to the archive list linked on the front page of modpython.org. This page has what I assume to be the correct link to the mailing list archives: http://mailman.modpython.org/pipermail/mod_python.mbox/mod_python.mbox.

Sorry if this has already been posted--I've just started subscribing to the list and I searched the raw archives for mmention of this and found nothing.  Also, is there a user-friendly web interface for searching through the modpython mailing list archives?

-- 
Jay Dorsey
jay at jaydorsey dot com
From aalbarracindev at hotmail.com  Mon Dec  1 18:48:04 2003
From: aalbarracindev at hotmail.com (Alberto Sanchez Albarracin)
Date: Fri Jan  9 21:47:56 2004
Subject: [mod_python] apache doesn't start
Message-ID: <BAY7-F27e1YM9a2flhn0002153b@hotmail.com>

Hi all, i want mod_python for apache1(windows), the download page says that
mod_python 2.7.9 works with http server 1.3 but the link led me to one page
where appeared one directory named "win" among another files and two
directories, i went into win directory and i found several directories, i
choose the 2.7.6 directory and appeared two files listed below:
python2.2-apache1.3.20.zip, python2.2-apache1.3.20.zip
I pressed on the python2.2-apache1.3.22.zip file which is the second one,
decompressed it, and i just found a dll file named mod_python.dll.
My question is: where should i copy this file so that apache starts without
errors. The error is: Cannot load mod_python.so into server, the specific
module could not be found...

Thanks in advance

_________________________________________________________________
STOP MORE SPAM with the new MSN 8 and get 2 months FREE* 
http://join.msn.com/?page=features/junkmail

From neel at mediapulse.com  Tue Dec  2 11:44:34 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:47:56 2004
Subject: [mod_python] Getting mod_python version
Message-ID: <C0FC22C08B82074A88B500617641577787A7D3@johnson.mediapulse.net>

Hi all,

	I don't know if it's not there, or I'm just overlooking it, but
I can seem for a way in code to get the version of mod_python.  I have
some "default" modules I use, and I am trying to make them work with any
mod_python version.  Right now I'm doing try block, like such:

    # Get username/password from client
    pw = req.get_basic_auth_pw()
    try:
        # mod_python 2.x
        user = req.connection.user
    except:
        # mod_python 3.x
        user = req.user

	...but I'd rather be able to get the version directly.

Mike

From gustavo.cordova at q-voz.com  Tue Dec  2 12:47:27 2003
From: gustavo.cordova at q-voz.com (=?ISO-8859-1?Q?Gustavo_C=F3rdova_Avila?=)
Date: Fri Jan  9 21:47:56 2004
Subject: [mod_python] Getting mod_python version
In-Reply-To: <C0FC22C08B82074A88B500617641577787A7D3@johnson.mediapulse.net>
References: <C0FC22C08B82074A88B500617641577787A7D3@johnson.mediapulse.net>
Message-ID: <3FCCDE3F.4090005@q-voz.com>

This is the correct, "pythonic" way of doing things.

I'd recommend using "except AttributeError:" instead of a naked 
"except:" btw.

-gustavo

Michael C. Neel wrote:

>Hi all,
>
>	I don't know if it's not there, or I'm just overlooking it, but
>I can seem for a way in code to get the version of mod_python.  I have
>some "default" modules I use, and I am trying to make them work with any
>mod_python version.  Right now I'm doing try block, like such:
>
>    # Get username/password from client
>    pw = req.get_basic_auth_pw()
>    try:
>        # mod_python 2.x
>        user = req.connection.user
>    except:
>        # mod_python 3.x
>        user = req.user
>
>	...but I'd rather be able to get the version directly.
>
>Mike
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
>  
>

From neel at mediapulse.com  Tue Dec  2 14:30:41 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:47:57 2004
Subject: [mod_python] Getting mod_python version
Message-ID: <C0FC22C08B82074A88B500617641577787A7D4@johnson.mediapulse.net>

Most modules have a __version__ member, and the help() built-in method
even looks for this variable and uses it to display the version of the
file:

>>>import cgi
>>>cgi.__version__
'2.6'
>>>help(cgi)
...skipping...
DATA
    __all__ = ['MiniFieldStorage', 'FieldStorage', 'FormContentDict',
'SvF...
    __version__ = '2.6'
    logfile = ''
    logfp = None
    maxlen = 0

VERSION
    2.6

>>>

I have not read or seen anything saying the "pythonic" way of versioning
a module is by try/except blocks testing to see if variable exist.  I
have however seen this from PEP 8:

Version Bookkeeping

    If you have to have RCS or CVS crud in your source file, do it as
    follows.

        __version__ = "$Revision: 1.20 $"
        # $Source: /cvsroot/python/python/nondist/peps/pep-0008.txt,v $

    These lines should be included after the module's docstring,
    before any other code, separated by a blank line above and
    below.

Which implies to me that __version__ is a pythonic way of versioning a
module/code file, though it doesn't seem to be as standard as __doc__.

Mike

> -----Original Message-----
> From: Gustavo C?rdova Avila [mailto:gustavo.cordova@q-voz.com] 
> Sent: Tuesday, December 02, 2003 1:47 PM
> To: Michael C. Neel
> Cc: mod_python@modpython.org
> Subject: Re: [mod_python] Getting mod_python version
> 
> 
> This is the correct, "pythonic" way of doing things.
> 
> I'd recommend using "except AttributeError:" instead of a naked 
> "except:" btw.
> 
> -gustavo
> 
> Michael C. Neel wrote:
> 
> >Hi all,
> >
> >	I don't know if it's not there, or I'm just overlooking it, but
> >I can seem for a way in code to get the version of 
> mod_python.  I have
> >some "default" modules I use, and I am trying to make them 
> work with any
> >mod_python version.  Right now I'm doing try block, like such:
> >
> >    # Get username/password from client
> >    pw = req.get_basic_auth_pw()
> >    try:
> >        # mod_python 2.x
> >        user = req.connection.user
> >    except:
> >        # mod_python 3.x
> >        user = req.user
> >
> >	...but I'd rather be able to get the version directly.
> >
> >Mike
> >
> >_______________________________________________
> >Mod_python mailing list
> >Mod_python@modpython.org
> >http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> >
> >  
> >
> 
> 

From michael at dynamine.net  Tue Dec  2 11:41:16 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 21:47:57 2004
Subject: [mod_python] Getting mod_python version
In-Reply-To: <C0FC22C08B82074A88B500617641577787A7D4@johnson.mediapulse.net>
References: <C0FC22C08B82074A88B500617641577787A7D4@johnson.mediapulse.net>
Message-ID: <3FCCEADC.9060701@dynamine.net>

Regardless of whether or not __version__ is implemented, using exception 
handling is more robust in the long run, I think.

Forgetting to change the interface version number when a compatibility 
detail has changed is not an unknown phenomenon -- if not with 
mod_python, then certainly with other SDKs.

--Michael

Michael C. Neel wrote:

> Most modules have a __version__ member, and the help() built-in method
> even looks for this variable and uses it to display the version of the
> file:
> 
> 
>>>>import cgi
>>>>cgi.__version__
> 
> '2.6'
> 
>>>>help(cgi)
> 
> ...skipping...
> DATA
>     __all__ = ['MiniFieldStorage', 'FieldStorage', 'FormContentDict',
> 'SvF...
>     __version__ = '2.6'
>     logfile = ''
>     logfp = None
>     maxlen = 0
> 
> VERSION
>     2.6
> 
> 
> 
> I have not read or seen anything saying the "pythonic" way of versioning
> a module is by try/except blocks testing to see if variable exist.  I
> have however seen this from PEP 8:
> 
> Version Bookkeeping
> 
>     If you have to have RCS or CVS crud in your source file, do it as
>     follows.
> 
>         __version__ = "$Revision: 1.20 $"
>         # $Source: /cvsroot/python/python/nondist/peps/pep-0008.txt,v $
> 
>     These lines should be included after the module's docstring,
>     before any other code, separated by a blank line above and
>     below.
> 
> Which implies to me that __version__ is a pythonic way of versioning a
> module/code file, though it doesn't seem to be as standard as __doc__.
> 
> Mike
> 
> 
>>-----Original Message-----
>>From: Gustavo C?rdova Avila [mailto:gustavo.cordova@q-voz.com] 
>>Sent: Tuesday, December 02, 2003 1:47 PM
>>To: Michael C. Neel
>>Cc: mod_python@modpython.org
>>Subject: Re: [mod_python] Getting mod_python version
>>
>>
>>This is the correct, "pythonic" way of doing things.
>>
>>I'd recommend using "except AttributeError:" instead of a naked 
>>"except:" btw.
>>
>>-gustavo
>>
>>Michael C. Neel wrote:
>>
>>
>>>Hi all,
>>>
>>>	I don't know if it's not there, or I'm just overlooking it, but
>>>I can seem for a way in code to get the version of 
>>
>>mod_python.  I have
>>
>>>some "default" modules I use, and I am trying to make them 
>>
>>work with any
>>
>>>mod_python version.  Right now I'm doing try block, like such:
>>>
>>>   # Get username/password from client
>>>   pw = req.get_basic_auth_pw()
>>>   try:
>>>       # mod_python 2.x
>>>       user = req.connection.user
>>>   except:
>>>       # mod_python 3.x
>>>       user = req.user
>>>
>>>	...but I'd rather be able to get the version directly.
>>>
>>>Mike
>>>
>>>_______________________________________________
>>>Mod_python mailing list
>>>Mod_python@modpython.org
>>>http://mailman.modpython.org/mailman/listinfo/mod_python
>>>
>>>
>>> 
>>>
>>
>>
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

From neel at mediapulse.com  Tue Dec  2 14:51:32 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:47:57 2004
Subject: [mod_python] Getting mod_python version
Message-ID: <C0FC22C08B82074A88B50061764157776B9864@johnson.mediapulse.net>

What if something changed every major version, 2 - 5?

with __version__ you could:

	if m.__version__.startswidth('2.'):
		user = m.get2_user()
	elif m.__version__.startswidth('3.'):
		user = m.get3_user()
	elif m.__version__.startswidth('4.'):
		user = m.get4_user()
	elif m.__version__.startswidth('5.'):
		user = m.get5_user()
	else:
		#unsupported version

with try/except:

	try:
		user = m.get2_user()
	except:
		try:
			user = m.get3_user()
		except:
			try:
				user = m.get4_user()
			except:
				try:
					user = m.get5_user()
				except:
					#unsupported version

I'm failing to see why it is supposed to be easier to code/easier to
read with multiple try/except blocks, which are just going to get deeper
as we go.

Mike

> -----Original Message-----
> From: Michael S. Fischer [mailto:michael@dynamine.net] 
> Sent: Tuesday, December 02, 2003 2:41 PM
> To: Michael C. Neel
> Cc: Gustavo C?rdova Avila; mod_python@modpython.org
> Subject: Re: [mod_python] Getting mod_python version
> 
> 
> Regardless of whether or not __version__ is implemented, 
> using exception 
> handling is more robust in the long run, I think.
> 
> Forgetting to change the interface version number when a 
> compatibility 
> detail has changed is not an unknown phenomenon -- if not with 
> mod_python, then certainly with other SDKs.
> 
> --Michael
> 
> Michael C. Neel wrote:
> 
> > Most modules have a __version__ member, and the help() 
> built-in method
> > even looks for this variable and uses it to display the 
> version of the
> > file:
> > 
> > 
> >>>>import cgi
> >>>>cgi.__version__
> > 
> > '2.6'
> > 
> >>>>help(cgi)
> > 
> > ...skipping...
> > DATA
> >     __all__ = ['MiniFieldStorage', 'FieldStorage', 
> 'FormContentDict',
> > 'SvF...
> >     __version__ = '2.6'
> >     logfile = ''
> >     logfp = None
> >     maxlen = 0
> > 
> > VERSION
> >     2.6
> > 
> > 
> > 
> > I have not read or seen anything saying the "pythonic" way 
> of versioning
> > a module is by try/except blocks testing to see if variable 
> exist.  I
> > have however seen this from PEP 8:
> > 
> > Version Bookkeeping
> > 
> >     If you have to have RCS or CVS crud in your source 
> file, do it as
> >     follows.
> > 
> >         __version__ = "$Revision: 1.20 $"
> >         # $Source: 
> /cvsroot/python/python/nondist/peps/pep-0008.txt,v $
> > 
> >     These lines should be included after the module's docstring,
> >     before any other code, separated by a blank line above and
> >     below.
> > 
> > Which implies to me that __version__ is a pythonic way of 
> versioning a
> > module/code file, though it doesn't seem to be as standard 
> as __doc__.
> > 
> > Mike
> > 
> > 
> >>-----Original Message-----
> >>From: Gustavo C?rdova Avila [mailto:gustavo.cordova@q-voz.com] 
> >>Sent: Tuesday, December 02, 2003 1:47 PM
> >>To: Michael C. Neel
> >>Cc: mod_python@modpython.org
> >>Subject: Re: [mod_python] Getting mod_python version
> >>
> >>
> >>This is the correct, "pythonic" way of doing things.
> >>
> >>I'd recommend using "except AttributeError:" instead of a naked 
> >>"except:" btw.
> >>
> >>-gustavo
> >>
> >>Michael C. Neel wrote:
> >>
> >>
> >>>Hi all,
> >>>
> >>>	I don't know if it's not there, or I'm just overlooking it, but
> >>>I can seem for a way in code to get the version of 
> >>
> >>mod_python.  I have
> >>
> >>>some "default" modules I use, and I am trying to make them 
> >>
> >>work with any
> >>
> >>>mod_python version.  Right now I'm doing try block, like such:
> >>>
> >>>   # Get username/password from client
> >>>   pw = req.get_basic_auth_pw()
> >>>   try:
> >>>       # mod_python 2.x
> >>>       user = req.connection.user
> >>>   except:
> >>>       # mod_python 3.x
> >>>       user = req.user
> >>>
> >>>	...but I'd rather be able to get the version directly.
> >>>
> >>>Mike
> >>>
> >>>_______________________________________________
> >>>Mod_python mailing list
> >>>Mod_python@modpython.org
> >>>http://mailman.modpython.org/mailman/listinfo/mod_python
> >>>
> >>>
> >>> 
> >>>
> >>
> >>
> > 
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> > 
> 
> 

From vincent_delft at yahoo.com  Tue Dec  2 11:54:01 2003
From: vincent_delft at yahoo.com (vincent delft)
Date: Fri Jan  9 21:47:57 2004
Subject: [mod_python] does mod_python is ready for production env. ?
Message-ID: <20031202195401.44707.qmail@web11505.mail.yahoo.com>

Sorry to ask this (may be stupid), but I plan to use
mod_python and Draco (see in links of the mod_python
site) on a production environment (a web service that
our enterprise will provide via http servers)


Is there any experience of mod_python on a production
env. ?

What about stability, fiability on a heavy loaded web
site ?

Is there "show stoppers" to use mod_python on a
production env. ?

Thanks 


PS : I'm pythoniac since years, and I definitively
hate php (just a personnal point of view).




__________________________________
Do you Yahoo!?
Free Pop-Up Blocker - Get it now
http://companion.yahoo.com/
From michael at dynamine.net  Tue Dec  2 11:59:05 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 21:47:57 2004
Subject: [mod_python] Getting mod_python version
In-Reply-To: <C0FC22C08B82074A88B50061764157776B9864@johnson.mediapulse.net>
References: <C0FC22C08B82074A88B50061764157776B9864@johnson.mediapulse.net>
Message-ID: <3FCCEF09.6000907@dynamine.net>

I agree that the code looks a little cleaner, but I still think it's 
less robust due to the phenomenon I described.

(Python also makes you use 'elif's instead of 'case' statements, and 
there's something to be said about the ugliness of the former as well. 
Eye of the beholder, I guess.)

Best,

--Michael

Michael C. Neel wrote:

> What if something changed every major version, 2 - 5?
> 
> with __version__ you could:
> 
> 	if m.__version__.startswidth('2.'):
> 		user = m.get2_user()
> 	elif m.__version__.startswidth('3.'):
> 		user = m.get3_user()
> 	elif m.__version__.startswidth('4.'):
> 		user = m.get4_user()
> 	elif m.__version__.startswidth('5.'):
> 		user = m.get5_user()
> 	else:
> 		#unsupported version
> 
> with try/except:
> 
> 	try:
> 		user = m.get2_user()
> 	except:
> 		try:
> 			user = m.get3_user()
> 		except:
> 			try:
> 				user = m.get4_user()
> 			except:
> 				try:
> 					user = m.get5_user()
> 				except:
> 					#unsupported version
> 
> I'm failing to see why it is supposed to be easier to code/easier to
> read with multiple try/except blocks, which are just going to get deeper
> as we go.
> 
> Mike
> 
> 
>>-----Original Message-----
>>From: Michael S. Fischer [mailto:michael@dynamine.net] 
>>Sent: Tuesday, December 02, 2003 2:41 PM
>>To: Michael C. Neel
>>Cc: Gustavo C?rdova Avila; mod_python@modpython.org
>>Subject: Re: [mod_python] Getting mod_python version
>>
>>
>>Regardless of whether or not __version__ is implemented, 
>>using exception 
>>handling is more robust in the long run, I think.
>>
>>Forgetting to change the interface version number when a 
>>compatibility 
>>detail has changed is not an unknown phenomenon -- if not with 
>>mod_python, then certainly with other SDKs.
>>
>>--Michael
>>
>>Michael C. Neel wrote:
>>
>>
>>>Most modules have a __version__ member, and the help() 
>>
>>built-in method
>>
>>>even looks for this variable and uses it to display the 
>>
>>version of the
>>
>>>file:
>>>
>>>
>>>
>>>>>>import cgi
>>>>>>cgi.__version__
>>>
>>>'2.6'
>>>
>>>
>>>>>>help(cgi)
>>>
>>>...skipping...
>>>DATA
>>>    __all__ = ['MiniFieldStorage', 'FieldStorage', 
>>
>>'FormContentDict',
>>
>>>'SvF...
>>>    __version__ = '2.6'
>>>    logfile = ''
>>>    logfp = None
>>>    maxlen = 0
>>>
>>>VERSION
>>>    2.6
>>>
>>>
>>>
>>>I have not read or seen anything saying the "pythonic" way 
>>
>>of versioning
>>
>>>a module is by try/except blocks testing to see if variable 
>>
>>exist.  I
>>
>>>have however seen this from PEP 8:
>>>
>>>Version Bookkeeping
>>>
>>>    If you have to have RCS or CVS crud in your source 
>>
>>file, do it as
>>
>>>    follows.
>>>
>>>        __version__ = "$Revision: 1.20 $"
>>>        # $Source: 
>>
>>/cvsroot/python/python/nondist/peps/pep-0008.txt,v $
>>
>>>    These lines should be included after the module's docstring,
>>>    before any other code, separated by a blank line above and
>>>    below.
>>>
>>>Which implies to me that __version__ is a pythonic way of 
>>
>>versioning a
>>
>>>module/code file, though it doesn't seem to be as standard 
>>
>>as __doc__.
>>
>>>Mike
>>>
>>>
>>>
>>>>-----Original Message-----
>>>>From: Gustavo C?rdova Avila [mailto:gustavo.cordova@q-voz.com] 
>>>>Sent: Tuesday, December 02, 2003 1:47 PM
>>>>To: Michael C. Neel
>>>>Cc: mod_python@modpython.org
>>>>Subject: Re: [mod_python] Getting mod_python version
>>>>
>>>>
>>>>This is the correct, "pythonic" way of doing things.
>>>>
>>>>I'd recommend using "except AttributeError:" instead of a naked 
>>>>"except:" btw.
>>>>
>>>>-gustavo
>>>>
>>>>Michael C. Neel wrote:
>>>>
>>>>
>>>>
>>>>>Hi all,
>>>>>
>>>>>	I don't know if it's not there, or I'm just overlooking it, but
>>>>>I can seem for a way in code to get the version of 
>>>>
>>>>mod_python.  I have
>>>>
>>>>
>>>>>some "default" modules I use, and I am trying to make them 
>>>>
>>>>work with any
>>>>
>>>>
>>>>>mod_python version.  Right now I'm doing try block, like such:
>>>>>
>>>>>  # Get username/password from client
>>>>>  pw = req.get_basic_auth_pw()
>>>>>  try:
>>>>>      # mod_python 2.x
>>>>>      user = req.connection.user
>>>>>  except:
>>>>>      # mod_python 3.x
>>>>>      user = req.user
>>>>>
>>>>>	...but I'd rather be able to get the version directly.
>>>>>
>>>>>Mike
>>>>>
>>>>>_______________________________________________
>>>>>Mod_python mailing list
>>>>>Mod_python@modpython.org
>>>>>http://mailman.modpython.org/mailman/listinfo/mod_python
>>>>>
>>>>>
>>>>>
>>>>>
>>>>
>>>>
>>>_______________________________________________
>>>Mod_python mailing list
>>>Mod_python@modpython.org
>>>http://mailman.modpython.org/mailman/listinfo/mod_python
>>>
>>
>>
> 

From neel at mediapulse.com  Tue Dec  2 15:06:29 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:47:57 2004
Subject: [mod_python] Getting mod_python version
Message-ID: <C0FC22C08B82074A88B50061764157776B9865@johnson.mediapulse.net>

> (Python also makes you use 'elif's instead of 'case' statements, and 
> there's something to be said about the ugliness of the former 
> as well. 
> Eye of the beholder, I guess.)

I agree about the case issue as well, but let us never speak of it
again, lest the python police decend upon our homes in the night...

Mike

From neel at mediapulse.com  Tue Dec  2 15:17:18 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:47:57 2004
Subject: [mod_python] does mod_python is ready for production env. ?
Message-ID: <C0FC22C08B82074A88B500617641577787A7D5@johnson.mediapulse.net>

Yes, mod_python is extreamly viable in a production enviroment.  Draco I
cannot answer for, I tend to use Albatross.

We have used mod_python for several large sites without issue, the
problems have always been our own doing =)

In my personal tests, I found mod_python right behind mod_perl in terms
of speed and ahead of php.  My tests revolved around how I wanted to use
mod_python (big app using a mysql backend on linux), so if you are
worried about speed I recommend you conduct your own benchmarks with the
way you will be using mod_python.  At the time I was new to python, so
I'm sure there were ways to speed up the mod_python test site.

It's worth note that a C module will blow the doors off of a
perl/php/python site.  So if speed is really an issue, C is the way to
go.  If it's not that bad, then in terms of preformance perl/php/python
are all close enough to make it a non-issue.

I hate php as well ;)

Mike

> -----Original Message-----
> From: vincent delft [mailto:vincent_delft@yahoo.com] 
> Sent: Tuesday, December 02, 2003 2:54 PM
> To: mod_python@modpython.org
> Subject: [mod_python] does mod_python is ready for production env. ?
> 
> 
> Sorry to ask this (may be stupid), but I plan to use
> mod_python and Draco (see in links of the mod_python
> site) on a production environment (a web service that
> our enterprise will provide via http servers)
> 
> 
> Is there any experience of mod_python on a production
> env. ?
> 
> What about stability, fiability on a heavy loaded web
> site ?
> 
> Is there "show stoppers" to use mod_python on a
> production env. ?
> 
> Thanks 
> 
> 
> PS : I'm pythoniac since years, and I definitively
> hate php (just a personnal point of view).
> 
> 
> 
> 
> __________________________________
> Do you Yahoo!?
> Free Pop-Up Blocker - Get it now
> http://companion.yahoo.com/
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

From michael at dynamine.net  Tue Dec  2 12:40:24 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 21:47:57 2004
Subject: [mod_python] does mod_python is ready for production env. ?
In-Reply-To: <C0FC22C08B82074A88B500617641577787A7D5@johnson.mediapulse.net>
References: <C0FC22C08B82074A88B500617641577787A7D5@johnson.mediapulse.net>
Message-ID: <3FCCF8B8.90801@dynamine.net>

Michael C. Neel wrote:

> In my personal tests, I found mod_python right behind mod_perl in terms
> of speed and ahead of php.

Did you try the Zend Accelerator module for PHP?  When used, it makes 
PHP an order of magnitude faster.  I'm not kidding.  Simply blows 
mod_perl/mod_python away.

Of course, the upshot is that you'd have to program in PHP to use it :-)

Grisha, it might be an interesting future addition to mod_python to 
cache compiled Python code and access the compiled code via shared 
memory like the Zend Accelerator does -- if that's even possible with 
the Python architecture.

--Michael

From neel at mediapulse.com  Tue Dec  2 15:54:52 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:47:57 2004
Subject: [mod_python] does mod_python is ready for production env. ?
Message-ID: <C0FC22C08B82074A88B500617641577787A7D6@johnson.mediapulse.net>

> Did you try the Zend Accelerator module for PHP?  

No, Zend Accelerator requires fees and licensing, so it kinda ruled
itself out of the running.

> Of course, the upshot is that you'd have to program in PHP to 
> use it :-)

downside?

> 
> Grisha, it might be an interesting future addition to mod_python to 
> cache compiled Python code and access the compiled code via shared 
> memory like the Zend Accelerator does -- if that's even possible with 
> the Python architecture.
> 

Mod_python does this already, just make sure you have PythonDebug Off
(or not set) in your conf.

Mike

From dwmp at opti.cgi.net  Tue Dec  2 15:04:54 2003
From: dwmp at opti.cgi.net (Dan W.)
Date: Fri Jan  9 21:47:57 2004
Subject: [mod_python] does mod_python is ready for production env. ?
In-Reply-To: <C0FC22C08B82074A88B500617641577787A7D6@johnson.mediapulse.
 net>
Message-ID: <5.2.1.1.2.20031202150248.04685f88@mail.pyxos.com>


At 03:54 PM 12/2/2003 -0500, you wrote:
>Mod_python does this already, just make sure you have PythonDebug Off
>(or not set) in your conf.

How does PythonDebug change the execution time?  According to the 
documentation it just writes tracebacks to the output and the log at the 
same time vs. just the log.  Assuming you have no tracebacks in a 
production environment, why does this impact execution speed?

-Dan

From gustavo.cordova at q-voz.com  Tue Dec  2 15:28:00 2003
From: gustavo.cordova at q-voz.com (=?ISO-8859-1?Q?Gustavo_C=F3rdova_Avila?=)
Date: Fri Jan  9 21:47:57 2004
Subject: [mod_python] does mod_python is ready for production env. ?
In-Reply-To: <3FCCF8B8.90801@dynamine.net>
References: <C0FC22C08B82074A88B500617641577787A7D5@johnson.mediapulse.net>
	<3FCCF8B8.90801@dynamine.net>
Message-ID: <3FCD03E0.4010006@q-voz.com>

Michael S. Fischer wrote:

> Michael C. Neel wrote:
>
>> In my personal tests, I found mod_python right behind mod_perl in terms
>> of speed and ahead of php.
>
> Did you try the Zend Accelerator module for PHP?  When used, it makes 
> PHP an order of magnitude faster.  I'm not kidding.  Simply blows 
> mod_perl/mod_python away.
>
> Of course, the upshot is that you'd have to program in PHP to use it :-)
>
> Grisha, it might be an interesting future addition to mod_python to 
> cache compiled Python code and access the compiled code via shared 
> memory like the Zend Accelerator does -- if that's even possible with 
> the Python architecture.
>
> --Michael

You can do something even better from Python, just:

    import psyco
    psyco.profile()

and it'll automatically do some background profiling, and generate 
specialized machine code for any functions worth compiling.  Another 
common invocation is:

    import psyco
    psyco.bind(func1)
    psyco.bind(func2)
    ...

This is when you know which functions are worth compiling, so you 
generate specialized versions immediately, upon module startup.

Psyco's a really nice gem, you can check it out at:

    http://psyco.sourceforge.net/

-gustavo


From neel at mediapulse.com  Tue Dec  2 16:46:45 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:47:57 2004
Subject: [mod_python] does mod_python is ready for production env. ?
Message-ID: <C0FC22C08B82074A88B500617641577787A7D8@johnson.mediapulse.net>

> How does PythonDebug change the execution time?  According to the 
> documentation it just writes tracebacks to the output and the 
> log at the 
> same time vs. just the log.  Assuming you have no tracebacks in a 
> production environment, why does this impact execution speed?
> 

My bad, I looked at the wrong version of a conf file; you want
PythonAutoReload Off and PythonOptimize On.  You don't have to have
these to get modulke cacheing, that's always on, but these speed things
up some.

Mike

From grisha at modpython.org  Tue Dec  2 17:36:03 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:47:57 2004
Subject: [mod_python] does mod_python is ready for production env. ?
In-Reply-To: <3FCCF8B8.90801@dynamine.net>
References: <C0FC22C08B82074A88B500617641577787A7D5@johnson.mediapulse.net>
 <3FCCF8B8.90801@dynamine.net>
Message-ID: <20031202173437.L61463@onyx.ispol.com>


On Tue, 2 Dec 2003, Michael S. Fischer wrote:

> Michael C. Neel wrote:
>
> > In my personal tests, I found mod_python right behind mod_perl in terms
> > of speed and ahead of php.
>
> Did you try the Zend Accelerator module for PHP?

> Simply blows mod_perl/mod_python away.

I doubt it. :-)

Grisha
From vmanera at manord.com  Tue Dec  2 08:54:51 2003
From: vmanera at manord.com (Manera, Villiam)
Date: Fri Jan  9 21:47:57 2004
Subject: R: R: [mod_python]  Problem with Session module with multiple scr
	ipt alias not under t he  document root
Message-ID: <52DC70C1C1575C418CB033523A29CF1410490B@exchange2000.manord.com>

I've already noted the '/' and I tried both with PythonOption
ApplicationPath /script/cgi/cgi-mpy and directly  c.path =
'/script/cgi/cgi-mpy'
But without success.
Only work with path=''.


do you work on windows? I suppose that in windows Session doesn't work
without removing this problem. Any people has a configuration working in
win2000?

Villiam
-----Messaggio originale-----
Da: mod_python-bounces@modpython.org
[mailto:mod_python-bounces@modpython.org]Per conto di Neil Beattie
Inviato: sabato 29 novembre 2003 15.54
A: mod_python@modpython.org
Cc: Manera, Villiam
Oggetto: Re: R: [mod_python] Problem with Session module with multiple
script alias not under t he document root


> I'm sorry but still don't work.
> I'm removed all references to cgi and I moved all my directory with .py
> under document root:
> 
> DocumentRoot "C:/wwwroot/cartelle_sito_mdn"
> <Directory   "C:/wwwroot/cartelle_sito_mdn/script/cgi/cgi-py">
> 
> and with this new configuration req.headers_out:
> {'Set-Cookie': 'pysid=d4d10ab8e7917b43becbff01a2452f7e;
> path=/script/cgi/cgi-mpy/\', 'Cache-Control': 'no-cache="set-cookie"'} 
> and if I relod the page it never passed to req.headers_in


Looks like the path is not correct (extra \)
try adding the following line to your httpd.config  addHandler entry:

PythonOption ApplicationPath /script/cgi/cgi-mpy


I have just had the same problem but have not yet discovered where the extra
\ 
comes from ( it is in _req.hlist.directory in session.py)




> 
> if I modify se session module:
> def make_cookie(self):
> 	....
>       c.path = ''   #dirpath[len(docroot):]
> then req.headers_out become:
> {'Set-Cookie': 'pysid=fb35b851ad27e7effe820c36871bc9b4; path=',
> 'Cache-Control': 'no-cache="set-cookie"'} 
> and If I relod the page it go to req.headers_in:
> {'Cookie': 'pysid=fb35b851ad27e7effe820c36871bc9b4', 'Connection':
> 'Keep-Alive', ...} 
> and req.heades_out : {}
> 
> so why if something else then '' is in path the pysid wasn't writing into
> the html heading? 
> 

Neil Beattie
NB Technology (Pty) Ltd

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python
From cs1spw at bath.ac.uk  Tue Dec  2 17:10:03 2003
From: cs1spw at bath.ac.uk (Simon Willison)
Date: Fri Jan  9 21:47:57 2004
Subject: [mod_python] does mod_python is ready for production env. ?
In-Reply-To: <20031202195401.44707.qmail@web11505.mail.yahoo.com>
References: <20031202195401.44707.qmail@web11505.mail.yahoo.com>
Message-ID: <3FCD1BCB.6020801@bath.ac.uk>

vincent delft wrote:
> PS : I'm pythoniac since years, and I definitively
> hate php (just a personnal point of view).

Reg:	Listen. If you really wanted to use mod_python, you'd have to 
really hate PHP.
Brian:  I do.
Reg:    Oh yeah? How much?
Brian:  A lot!
Reg:    Right. You're in.

(Sorry, couldn't resist it)

From michael at dynamine.net  Tue Dec  2 15:50:15 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 21:47:57 2004
Subject: [mod_python] does mod_python is ready for production env. ?
In-Reply-To: <3FCD03E0.4010006@q-voz.com>
References: <C0FC22C08B82074A88B500617641577787A7D5@johnson.mediapulse.net>
	<3FCCF8B8.90801@dynamine.net> <3FCD03E0.4010006@q-voz.com>
Message-ID: <3FCD2537.2010604@dynamine.net>

Gustavo C?rdova Avila wrote:
> Michael S. Fischer wrote:
>> Grisha, it might be an interesting future addition to mod_python to 
>> cache compiled Python code and access the compiled code via shared 
>> memory like the Zend Accelerator does -- if that's even possible with 
>> the Python architecture.

> You can do something even better from Python, just:
> 
>    import psyco
>    psyco.profile()

Apparently psyco is limited to the i386 platform at this time. 
Unfortunately I'm running on a PowerPC platform (Apple XServe) at my 
present assignment.  :(

--Michael

From davidf at sjsoft.com  Wed Dec  3 07:55:06 2003
From: davidf at sjsoft.com (David Fraser)
Date: Fri Jan  9 21:47:57 2004
Subject: [mod_python] does mod_python is ready for production env. ?
In-Reply-To: <3FCD2537.2010604@dynamine.net>
References: <C0FC22C08B82074A88B500617641577787A7D5@johnson.mediapulse.net>
	<3FCCF8B8.90801@dynamine.net> <3FCD03E0.4010006@q-voz.com>
	<3FCD2537.2010604@dynamine.net>
Message-ID: <3FCD7ABA.3070502@sjsoft.com>

Michael S. Fischer wrote:

> Gustavo C?rdova Avila wrote:
>
>> Michael S. Fischer wrote:
>>
>>> Grisha, it might be an interesting future addition to mod_python to 
>>> cache compiled Python code and access the compiled code via shared 
>>> memory like the Zend Accelerator does -- if that's even possible 
>>> with the Python architecture.
>>
>
>> You can do something even better from Python, just:
>>
>>    import psyco
>>    psyco.profile()
>
>
> Apparently psyco is limited to the i386 platform at this time. 
> Unfortunately I'm running on a PowerPC platform (Apple XServe) at my 
> present assignment.  :(

Armin is working on a platform-independent version, not sure of the 
status, but I think it was working. You could ask on the psyco mailing 
list, he's very helpful, and I'm sure would be grateful for someone 
testing it. Psyco is incredible

David

From jciccale at mac.com  Wed Dec  3 09:40:32 2003
From: jciccale at mac.com (Julian Ciccale)
Date: Fri Jan  9 21:47:57 2004
Subject: [mod_python] does mod_python is ready for production env. ?
Message-ID: <15142387.1070440832400.JavaMail.jciccale@mac.com>

Have you tried pywork ? 
http://pywork.sf.net  (old name was pythonwork)

It's a new web framework we are developing, and it rocks.

We have benchmarked agains other MVC/Template pairs
and it really rocks! It supports XSLT transforms (done in C),
ZPT templates and even lets you write your own View System.

- julcicc -

On Tuesday, December 02, 2003, at 08:54PM, vincent delft <vincent_delft@yahoo.com> wrote:

>Sorry to ask this (may be stupid), but I plan to use
>mod_python and Draco (see in links of the mod_python
>site) on a production environment (a web service that
>our enterprise will provide via http servers)
>
>
>Is there any experience of mod_python on a production
>env. ?
>
>What about stability, fiability on a heavy loaded web
>site ?
>
>Is there "show stoppers" to use mod_python on a
>production env. ?
>
>Thanks 
>
>
>PS : I'm pythoniac since years, and I definitively
>hate php (just a personnal point of view).
>
>
>
>
>__________________________________
>Do you Yahoo!?
>Free Pop-Up Blocker - Get it now
>http://companion.yahoo.com/
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
From vmanera at manord.com  Wed Dec  3 11:49:05 2003
From: vmanera at manord.com (Manera, Villiam)
Date: Fri Jan  9 21:47:57 2004
Subject: R: R: [mod_python]  Problem with Session module with multiple scr
	ipt alias not under t he  document root
Message-ID: <52DC70C1C1575C418CB033523A29CF1497D5C3@exchange2000.manord.com>

I found the way:
with: PythonOption ApplicationPath ' '
in every directory with python module all work fine.

If this is the rigth way it would be better to add in session manual.

Villiam

sorry, the latest test that I made was wrong,
effectively with:
PythonOption ApplicationPath /script/cgi/cgi-mpy 
the script below cgi-mpy working weel, but the script below other directory
doesn't work:
 DocumentRoot "C:/wwwroot/cartelle_sito_mdn"
<Directory   "C:/wwwroot/cartelle_sito_mdn/script/cgi/cgi-py">
	.....
	PythonOption ApplicationPath /script/cgi/cgi-mpy 

<Directory   "C:/wwwroot/cartelle_sito_mdn/script/cgi/studi">
	.....
	PythonOption ApplicationPath /script/cgi/studi 

If I first call an url below studi I'm able to work with all the module
below studi, but any attempt to go in cgi-mpy cause a new
sorry, the latest test that I made was wrong, effectively with 
PythonOption ApplicationPath /script/cgi/cgi-mpy 
the script below cgi-mpy working weel, but the script below other directory
doesn't work:


If I first call an url below studi I'm able to work with all the module
below studi, but any attempt to go in cgi-mpy cause a new Session id

vice versa if I first call a url below cgi-mpy ....

instead with path = '' all work fine, but I don't discovery the way to do it
with 
PythonOption ApplicationPath 
Villiam
-----Messaggio originale-----
Da: mod_python-bounces@modpython.org
[mailto:mod_python-bounces@modpython.org]Per conto di Neil Beattie
Inviato: sabato 29 novembre 2003 15.54
A: mod_python@modpython.org
Cc: Manera, Villiam
Oggetto: Re: R: [mod_python] Problem with Session module with multiple
script alias not under t he document root


> I'm sorry but still don't work.
> I'm removed all references to cgi and I moved all my directory with .py
> under document root:
> 
> DocumentRoot "C:/wwwroot/cartelle_sito_mdn"
> <Directory   "C:/wwwroot/cartelle_sito_mdn/script/cgi/cgi-py">
> 
> and with this new configuration req.headers_out:
> {'Set-Cookie': 'pysid=d4d10ab8e7917b43becbff01a2452f7e;
> path=/script/cgi/cgi-mpy/\', 'Cache-Control': 'no-cache="set-cookie"'} 
> and if I relod the page it never passed to req.headers_in


Looks like the path is not correct (extra \)
try adding the following line to your httpd.config  addHandler entry:

PythonOption ApplicationPath /script/cgi/cgi-mpy


I have just had the same problem but have not yet discovered where the extra
\ 
comes from ( it is in _req.hlist.directory in session.py)




> 
> if I modify se session module:
> def make_cookie(self):
> 	....
>       c.path = ''   #dirpath[len(docroot):]
> then req.headers_out become:
> {'Set-Cookie': 'pysid=fb35b851ad27e7effe820c36871bc9b4; path=',
> 'Cache-Control': 'no-cache="set-cookie"'} 
> and If I relod the page it go to req.headers_in:
> {'Cookie': 'pysid=fb35b851ad27e7effe820c36871bc9b4', 'Connection':
> 'Keep-Alive', ...} 
> and req.heades_out : {}
> 
> so why if something else then '' is in path the pysid wasn't writing into
> the html heading? 
> 

Neil Beattie
NB Technology (Pty) Ltd

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python
From vincent_delft at yahoo.com  Wed Dec  3 12:14:35 2003
From: vincent_delft at yahoo.com (vincent delft)
Date: Fri Jan  9 21:47:57 2004
Subject: [mod_python] does mod_python is ready for production env. ?
In-Reply-To: <15142387.1070440832400.JavaMail.jciccale@mac.com>
Message-ID: <20031203201435.57970.qmail@web11502.mail.yahoo.com>

Thanks to all your feedbacks. 

This prouve me that mod_python is reliable enough for
real production env.

Vincent






--- Julian Ciccale <jciccale@mac.com> wrote:
> Have you tried pywork ? 
> http://pywork.sf.net  (old name was pythonwork)
> 
> It's a new web framework we are developing, and it
> rocks.
> 
> We have benchmarked agains other MVC/Template pairs
> and it really rocks! It supports XSLT transforms
> (done in C),
> ZPT templates and even lets you write your own View
> System.
> 
> - julcicc -
> 
> On Tuesday, December 02, 2003, at 08:54PM, vincent
> delft <vincent_delft@yahoo.com> wrote:
> 
> >Sorry to ask this (may be stupid), but I plan to
> use
> >mod_python and Draco (see in links of the
> mod_python
> >site) on a production environment (a web service
> that
> >our enterprise will provide via http servers)
> >
> >
> >Is there any experience of mod_python on a
> production
> >env. ?
> >
> >What about stability, fiability on a heavy loaded
> web
> >site ?
> >
> >Is there "show stoppers" to use mod_python on a
> >production env. ?
> >
> >Thanks 
> >
> >
> >PS : I'm pythoniac since years, and I definitively
> >hate php (just a personnal point of view).
> >
> >
> >
> >
> >__________________________________
> >Do you Yahoo!?
> >Free Pop-Up Blocker - Get it now
> >http://companion.yahoo.com/
> >_______________________________________________
> >Mod_python mailing list
> >Mod_python@modpython.org
>
>http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> >

__________________________________
Do you Yahoo!?
Free Pop-Up Blocker - Get it now
http://companion.yahoo.com/
From dwmp at opti.cgi.net  Wed Dec  3 17:54:28 2003
From: dwmp at opti.cgi.net (Dan W.)
Date: Fri Jan  9 21:47:57 2004
Subject: [mod_python] 3.1.2b & worker MPM
Message-ID: <5.2.1.1.2.20031203174401.03b996c0@mail.pyxos.com>


I'm running into a weird problem with 3.1.2b and Apache 2.0.47 compiled 
under the worker MPM.  I have two Apache processes, each with 25 
threads.  I have a very simple PSP page which imports a simple .py module 
and prints out a value.  The problem is that the page is only served part 
of the time.  When it is served, it is correct (no tracebacks), but if I do 
a browser reload a couple times it will eventually serve a blank page.  I 
can immediately do a browser reload a few more times and get a few more 
blank pages.  Then if I wait a few seconds and do a browser reload again 
then it will serve up the proper page.

I'm not quite sure how to verify it, but it appears as though one process 
is having a problem with mod_python while the other process is functioning 
properly.  Any suggestions on how I could verify this or other ideas?

I wasn't able to find anything in the documentation on MPM compatibility.

Thanks!

-Dan

From dwmp at opti.cgi.net  Wed Dec  3 21:14:19 2003
From: dwmp at opti.cgi.net (Dan W.)
Date: Fri Jan  9 21:47:57 2004
Subject: [mod_python] PSP bug report
In-Reply-To: <5.2.1.1.2.20031203174401.03b996c0@mail.pyxos.com>
Message-ID: <5.2.1.1.2.20031203210332.02bf6de0@mail.pyxos.com>


It turns out that my problem wasn't related to the worker MPM after 
all.  After minimizing the code down I've found that PSP fails on zero 
element for loops.  The following PSP page should reproduce the problem.

<%
for x in range(0):
     pass
%>
<html>
<body>
Hello world
</body>
</html>


Does the PSP maintainer read this list?

-Dan



At 05:54 PM 12/3/2003 -0600, you wrote:

>I'm running into a weird problem with 3.1.2b and Apache 2.0.47 compiled 
>under the worker MPM.  I have two Apache processes, each with 25 
>threads.  I have a very simple PSP page which imports a simple .py module 
>and prints out a value.  The problem is that the page is only served part 
>of the time.  When it is served, it is correct (no tracebacks), but if I 
>do a browser reload a couple times it will eventually serve a blank 
>page.  I can immediately do a browser reload a few more times and get a 
>few more blank pages.  Then if I wait a few seconds and do a browser 
>reload again then it will serve up the proper page.
>
>I'm not quite sure how to verify it, but it appears as though one process 
>is having a problem with mod_python while the other process is functioning 
>properly.  Any suggestions on how I could verify this or other ideas?
>
>I wasn't able to find anything in the documentation on MPM compatibility.
>
>Thanks!
>
>-Dan
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python

From dwmp at opti.cgi.net  Wed Dec  3 22:15:43 2003
From: dwmp at opti.cgi.net (Dan W.)
Date: Fri Jan  9 21:47:57 2004
Subject: [mod_python] PSP bug report
In-Reply-To: <5.2.1.1.2.20031203210332.02bf6de0@mail.pyxos.com>
References: <5.2.1.1.2.20031203174401.03b996c0@mail.pyxos.com>
Message-ID: <5.2.1.1.2.20031203221244.02b28a20@mail.pyxos.com>


I realized my error too late.  I needed a blank line after the loop.  PSP 
was considering the rest of the page to be part of the loop and since the 
loop did not execute neither did the html.

-Dan



At 09:14 PM 12/3/2003 -0600, you wrote:

>It turns out that my problem wasn't related to the worker MPM after 
>all.  After minimizing the code down I've found that PSP fails on zero 
>element for loops.  The following PSP page should reproduce the problem.
>
><%
>for x in range(0):
>     pass
>%>
>Hello world
>
>Does the PSP maintainer read this list?
>
>-Dan
>
>
>
>At 05:54 PM 12/3/2003 -0600, you wrote:
>
> >I'm running into a weird problem with 3.1.2b and Apache 2.0.47 compiled
> >under the worker MPM.  I have two Apache processes, each with 25
> >threads.  I have a very simple PSP page which imports a simple .py module
> >and prints out a value.  The problem is that the page is only served part
> >of the time.  When it is served, it is correct (no tracebacks), but if I
> >do a browser reload a couple times it will eventually serve a blank
> >page.  I can immediately do a browser reload a few more times and get a
> >few more blank pages.  Then if I wait a few seconds and do a browser
> >reload again then it will serve up the proper page.
> >
> >I'm not quite sure how to verify it, but it appears as though one process
> >is having a problem with mod_python while the other process is functioning
> >properly.  Any suggestions on how I could verify this or other ideas?
> >
> >I wasn't able to find anything in the documentation on MPM compatibility.
> >
> >Thanks!
> >
> >-Dan
> >
> >_______________________________________________
> >Mod_python mailing list
> >Mod_python@modpython.org
> >http://mailman.modpython.org/mailman/listinfo/mod_python
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python

From grisha at modpython.org  Thu Dec  4 01:00:44 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:47:57 2004
Subject: [mod_python] PSP bug report
In-Reply-To: <5.2.1.1.2.20031203221244.02b28a20@mail.pyxos.com>
References: <5.2.1.1.2.20031203174401.03b996c0@mail.pyxos.com>
 <5.2.1.1.2.20031203221244.02b28a20@mail.pyxos.com>
Message-ID: <20031204005846.Y83403@onyx.ispol.com>


I think the best practice is to use a comment rather than a blank line:

<%
for x in range(0):
	pass
# end for
%>

Grisha

On Wed, 3 Dec 2003, Dan W. wrote:

>
> I realized my error too late.  I needed a blank line after the loop.  PSP
> was considering the rest of the page to be part of the loop and since the
> loop did not execute neither did the html.
>
> -Dan
>
>
>
> At 09:14 PM 12/3/2003 -0600, you wrote:
>
> >It turns out that my problem wasn't related to the worker MPM after
> >all.  After minimizing the code down I've found that PSP fails on zero
> >element for loops.  The following PSP page should reproduce the problem.
> >
> ><%
> >for x in range(0):
> >     pass
> >%>
> >Hello world
> >
> >Does the PSP maintainer read this list?
> >
> >-Dan
> >
> >
> >
> >At 05:54 PM 12/3/2003 -0600, you wrote:
> >
> > >I'm running into a weird problem with 3.1.2b and Apache 2.0.47 compiled
> > >under the worker MPM.  I have two Apache processes, each with 25
> > >threads.  I have a very simple PSP page which imports a simple .py module
> > >and prints out a value.  The problem is that the page is only served part
> > >of the time.  When it is served, it is correct (no tracebacks), but if I
> > >do a browser reload a couple times it will eventually serve a blank
> > >page.  I can immediately do a browser reload a few more times and get a
> > >few more blank pages.  Then if I wait a few seconds and do a browser
> > >reload again then it will serve up the proper page.
> > >
> > >I'm not quite sure how to verify it, but it appears as though one process
> > >is having a problem with mod_python while the other process is functioning
> > >properly.  Any suggestions on how I could verify this or other ideas?
> > >
> > >I wasn't able to find anything in the documentation on MPM compatibility.
> > >
> > >Thanks!
> > >
> > >-Dan
> > >
> > >_______________________________________________
> > >Mod_python mailing list
> > >Mod_python@modpython.org
> > >http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> >_______________________________________________
> >Mod_python mailing list
> >Mod_python@modpython.org
> >http://mailman.modpython.org/mailman/listinfo/mod_python
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From Vincent.Raaijmakers at ge.com  Thu Dec  4 07:48:52 2003
From: Vincent.Raaijmakers at ge.com (Raaijmakers, Vincent (IndSys, GE Interlogix))
Date: Fri Jan  9 21:47:57 2004
Subject: [mod_python] Handlers "good practice" question 
Message-ID: <971323274247EB44B9A01D0A3B424C8503F13BDF@FTWMLVEM02.e2k.ad.ge.com>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/gif
Size: 145 bytes
Desc: Blank Bkgrd.gif
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20031204/29f70021/attachment.gif
From vmanera at manord.com  Wed Dec  3 11:28:08 2003
From: vmanera at manord.com (Manera, Villiam)
Date: Fri Jan  9 21:47:58 2004
Subject: R: R: [mod_python]  Problem with Session module with multiple scr
	ipt alias not under t he  document root
Message-ID: <52DC70C1C1575C418CB033523A29CF1410490E@exchange2000.manord.com>

sorry, the latest test that I made was wrong,
effectively with:
PythonOption ApplicationPath /script/cgi/cgi-mpy 
the script below cgi-mpy working weel, but the script below other directory
doesn't work:
 DocumentRoot "C:/wwwroot/cartelle_sito_mdn"
<Directory   "C:/wwwroot/cartelle_sito_mdn/script/cgi/cgi-py">
	.....
	PythonOption ApplicationPath /script/cgi/cgi-mpy 

<Directory   "C:/wwwroot/cartelle_sito_mdn/script/cgi/studi">
	.....
	PythonOption ApplicationPath /script/cgi/studi 

If I first call an url below studi I'm able to work with all the module
below studi, but any attempt to go in cgi-mpy cause a new
sorry, the latest test that I made was wrong, effectively with 
PythonOption ApplicationPath /script/cgi/cgi-mpy 
the script below cgi-mpy working weel, but the script below other directory
doesn't work:


If I first call an url below studi I'm able to work with all the module
below studi, but any attempt to go in cgi-mpy cause a new Session id

vice versa if I first call a url below cgi-mpy ....

instead with path = '' all work fine, but I don't discovery the way to do it
with 
PythonOption ApplicationPath 
Villiam
-----Messaggio originale-----
Da: mod_python-bounces@modpython.org
[mailto:mod_python-bounces@modpython.org]Per conto di Neil Beattie
Inviato: sabato 29 novembre 2003 15.54
A: mod_python@modpython.org
Cc: Manera, Villiam
Oggetto: Re: R: [mod_python] Problem with Session module with multiple
script alias not under t he document root


> I'm sorry but still don't work.
> I'm removed all references to cgi and I moved all my directory with .py
> under document root:
> 
> DocumentRoot "C:/wwwroot/cartelle_sito_mdn"
> <Directory   "C:/wwwroot/cartelle_sito_mdn/script/cgi/cgi-py">
> 
> and with this new configuration req.headers_out:
> {'Set-Cookie': 'pysid=d4d10ab8e7917b43becbff01a2452f7e;
> path=/script/cgi/cgi-mpy/\', 'Cache-Control': 'no-cache="set-cookie"'} 
> and if I relod the page it never passed to req.headers_in


Looks like the path is not correct (extra \)
try adding the following line to your httpd.config  addHandler entry:

PythonOption ApplicationPath /script/cgi/cgi-mpy


I have just had the same problem but have not yet discovered where the extra
\ 
comes from ( it is in _req.hlist.directory in session.py)




> 
> if I modify se session module:
> def make_cookie(self):
> 	....
>       c.path = ''   #dirpath[len(docroot):]
> then req.headers_out become:
> {'Set-Cookie': 'pysid=fb35b851ad27e7effe820c36871bc9b4; path=',
> 'Cache-Control': 'no-cache="set-cookie"'} 
> and If I relod the page it go to req.headers_in:
> {'Cookie': 'pysid=fb35b851ad27e7effe820c36871bc9b4', 'Connection':
> 'Keep-Alive', ...} 
> and req.heades_out : {}
> 
> so why if something else then '' is in path the pysid wasn't writing into
> the html heading? 
> 

Neil Beattie
NB Technology (Pty) Ltd

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python
From neel at mediapulse.com  Thu Dec  4 10:52:09 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:47:58 2004
Subject: [mod_python] Handlers "good practice" question 
Message-ID: <C0FC22C08B82074A88B500617641577787A7DA@johnson.mediapulse.net>

Mod_python (docs) kinda assumes you are familiar with how apache works,
it really just exposing the C API in a python interface for the most
part.  To learn about the apache method of doing things, I'd recommend
reading "Writing Apache Modules in C and Perl" from O'rielly press
(title is something like that).  Language and details differ some, but
the general flow is the same.

Mike


-----Original Message-----
From: Raaijmakers, Vincent (IndSys, GE Interlogix)
[mailto:Vincent.Raaijmakers@ge.com] 
Sent: Thursday, December 04, 2003 8:49 AM
To: mod_python@modpython.org
Subject: [mod_python] Handlers "good practice" question 


I consider myself as a complete newbie with mod_python.  My goal is to
setup a good foundation for my web application using mod_python. Read
all the docs, mail history messages, tried every handler but... 
What I clearly miss is a guideline of a good default structure of the
different handlers. What is good practice? I guess when I try to learn
by trial and error, some structure will come up. I'm also sure that the
documentation I have in my hands will become more clear. It feels like
that mod_python has a lot of excellent soccer players but how to make a
team of it?
Please guru's, where can I find help?
Vincent

From anthony.barker at bmo.com  Thu Dec  4 12:07:49 2003
From: anthony.barker at bmo.com (anthony.barker@bmo.com)
Date: Fri Jan  9 21:47:58 2004
Subject: [mod_python] session management
Message-ID: <OF46341989.F03189B8-ON85256DF2.004D673F@notes.bmo.com>

Do the mod_python sessions work in windows 2000?

It would be nice if the session module was compatible with cgi, so it 
could be used in prototyping situations where the user doesn't have access 
to 
a mod_python enabled apache server....

Anthony
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20031204/9ee164f1/attachment.htm
From conrad at hep.caltech.edu  Thu Dec  4 09:35:46 2003
From: conrad at hep.caltech.edu (Conrad Steenberg)
Date: Fri Jan  9 21:47:58 2004
Subject: [mod_python] PSP bug report
In-Reply-To: <20031204005846.Y83403@onyx.ispol.com>
References: <5.2.1.1.2.20031203174401.03b996c0@mail.pyxos.com>
	 <5.2.1.1.2.20031203221244.02b28a20@mail.pyxos.com>
	 <20031204005846.Y83403@onyx.ispol.com>
Message-ID: <1070559346.13675.37.camel@heppc22.hep.caltech.edu>

Hi Grisha

This may not be a bug, but it could still be worth the effort to make an
%> be considered a newline as well - purely from a support perspective
and the amount of annoyance it might save you and countless new users of
PSP :-)

Cheers

Conrad

On Wed, 2003-12-03 at 22:00, Gregory (Grisha) Trubetskoy wrote:
> I think the best practice is to use a comment rather than a blank line:
> 
> <%
> for x in range(0):
> 	pass
> # end for
> %>
> 
> Grisha
> 
> On Wed, 3 Dec 2003, Dan W. wrote:
> 
> >
> > I realized my error too late.  I needed a blank line after the loop.  PSP
> > was considering the rest of the page to be part of the loop and since the
> > loop did not execute neither did the html.
> >
> > -Dan
> >
> >
> >
> > At 09:14 PM 12/3/2003 -0600, you wrote:
> >
> > >It turns out that my problem wasn't related to the worker MPM after
> > >all.  After minimizing the code down I've found that PSP fails on zero
> > >element for loops.  The following PSP page should reproduce the problem.
> > >
> > ><%
> > >for x in range(0):
> > >     pass
> > >%>
> > >Hello world
> > >
> > >Does the PSP maintainer read this list?
> > >
> > >-Dan
> > >
> > >
> > >
> > >At 05:54 PM 12/3/2003 -0600, you wrote:
> > >
> > > >I'm running into a weird problem with 3.1.2b and Apache 2.0.47 compiled
> > > >under the worker MPM.  I have two Apache processes, each with 25
> > > >threads.  I have a very simple PSP page which imports a simple .py module
> > > >and prints out a value.  The problem is that the page is only served part
> > > >of the time.  When it is served, it is correct (no tracebacks), but if I
> > > >do a browser reload a couple times it will eventually serve a blank
> > > >page.  I can immediately do a browser reload a few more times and get a
> > > >few more blank pages.  Then if I wait a few seconds and do a browser
> > > >reload again then it will serve up the proper page.
> > > >
> > > >I'm not quite sure how to verify it, but it appears as though one process
> > > >is having a problem with mod_python while the other process is functioning
> > > >properly.  Any suggestions on how I could verify this or other ideas?
> > > >
> > > >I wasn't able to find anything in the documentation on MPM compatibility.
> > > >
> > > >Thanks!
> > > >
> > > >-Dan
> > > >
> > > >_______________________________________________
> > > >Mod_python mailing list
> > > >Mod_python@modpython.org
> > > >http://mailman.modpython.org/mailman/listinfo/mod_python
> > >
> > >_______________________________________________
> > >Mod_python mailing list
> > >Mod_python@modpython.org
> > >http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
-- 
Conrad Steenberg <conrad@hep.caltech.edu>

From michael at dynamine.net  Thu Dec  4 09:38:52 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 21:47:58 2004
Subject: [mod_python] session management
In-Reply-To: <OF46341989.F03189B8-ON85256DF2.004D673F@notes.bmo.com>
References: <OF46341989.F03189B8-ON85256DF2.004D673F@notes.bmo.com>
Message-ID: <3FCF712C.3000209@dynamine.net>

I'm confused.  Why would one want to prototype on a system that's not 
identical to the production system?

--Michael

anthony.barker@bmo.com wrote:

> 
> Do the mod_python sessions work in windows 2000?
> 
> It would be nice if the session module was compatible with cgi, so it 
> could be used in prototyping situations where the user doesn't have 
> access to
> a mod_python enabled apache server....
> 
> Anthony
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From dwmp at opti.cgi.net  Thu Dec  4 11:50:06 2003
From: dwmp at opti.cgi.net (Dan W.)
Date: Fri Jan  9 21:47:58 2004
Subject: [mod_python] PSP bug report
In-Reply-To: <1070559346.13675.37.camel@heppc22.hep.caltech.edu>
References: <20031204005846.Y83403@onyx.ispol.com>
 <5.2.1.1.2.20031203174401.03b996c0@mail.pyxos.com>
 <5.2.1.1.2.20031203221244.02b28a20@mail.pyxos.com>
 <20031204005846.Y83403@onyx.ispol.com>
Message-ID: <5.2.1.1.2.20031204114547.02af1930@mail.pyxos.com>


That would eliminate conditional html.  However, it might be interesting if 
PSP had a special directive for conditional html such as two percent signs.

<%%
for x in xrange(10):
%>

-Dan

At 09:35 AM 12/4/2003 -0800, you wrote:
>Hi Grisha
>
>This may not be a bug, but it could still be worth the effort to make an
>%> be considered a newline as well - purely from a support perspective
>and the amount of annoyance it might save you and countless new users of
>PSP :-)
>
>Cheers
>
>Conrad
>
>On Wed, 2003-12-03 at 22:00, Gregory (Grisha) Trubetskoy wrote:
> > I think the best practice is to use a comment rather than a blank line:
> >
> > <%
> > for x in range(0):
> >       pass
> > # end for
> > %>
> >
> > Grisha
> >
> > On Wed, 3 Dec 2003, Dan W. wrote:
> >
> > >
> > > I realized my error too late.  I needed a blank line after the loop.  PSP
> > > was considering the rest of the page to be part of the loop and since the
> > > loop did not execute neither did the html.
> > >
> > > -Dan
> > >
> > >
> > >
> > > At 09:14 PM 12/3/2003 -0600, you wrote:
> > >
> > > >It turns out that my problem wasn't related to the worker MPM after
> > > >all.  After minimizing the code down I've found that PSP fails on zero
> > > >element for loops.  The following PSP page should reproduce the problem.
> > > >
> > > ><%
> > > >for x in range(0):
> > > >     pass
> > > >%>
> > > >Hello world
> > > >
> > > >Does the PSP maintainer read this list?
> > > >
> > > >-Dan
> > > >
> > > >
> > > >
> > > >At 05:54 PM 12/3/2003 -0600, you wrote:
> > > >
> > > > >I'm running into a weird problem with 3.1.2b and Apache 2.0.47 
> compiled
> > > > >under the worker MPM.  I have two Apache processes, each with 25
> > > > >threads.  I have a very simple PSP page which imports a simple .py 
> module
> > > > >and prints out a value.  The problem is that the page is only 
> served part
> > > > >of the time.  When it is served, it is correct (no tracebacks), 
> but if I
> > > > >do a browser reload a couple times it will eventually serve a blank
> > > > >page.  I can immediately do a browser reload a few more times and 
> get a
> > > > >few more blank pages.  Then if I wait a few seconds and do a browser
> > > > >reload again then it will serve up the proper page.
> > > > >
> > > > >I'm not quite sure how to verify it, but it appears as though one 
> process
> > > > >is having a problem with mod_python while the other process is 
> functioning
> > > > >properly.  Any suggestions on how I could verify this or other ideas?
> > > > >
> > > > >I wasn't able to find anything in the documentation on MPM 
> compatibility.
> > > > >
> > > > >Thanks!
> > > > >
> > > > >-Dan
> > > > >
> > > > >_______________________________________________
> > > > >Mod_python mailing list
> > > > >Mod_python@modpython.org
> > > > >http://mailman.modpython.org/mailman/listinfo/mod_python
> > > >
> > > >_______________________________________________
> > > >Mod_python mailing list
> > > >Mod_python@modpython.org
> > > >http://mailman.modpython.org/mailman/listinfo/mod_python
> > >
> > > _______________________________________________
> > > Mod_python mailing list
> > > Mod_python@modpython.org
> > > http://mailman.modpython.org/mailman/listinfo/mod_python
> > >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
>--
>Conrad Steenberg <conrad@hep.caltech.edu>

From conrad at hep.caltech.edu  Thu Dec  4 10:04:12 2003
From: conrad at hep.caltech.edu (Conrad Steenberg)
Date: Fri Jan  9 21:47:58 2004
Subject: [mod_python] PSP bug report
In-Reply-To: <5.2.1.1.2.20031204114547.02af1930@mail.pyxos.com>
References: <20031204005846.Y83403@onyx.ispol.com>
	 <5.2.1.1.2.20031203174401.03b996c0@mail.pyxos.com>
	 <5.2.1.1.2.20031203221244.02b28a20@mail.pyxos.com>
	 <20031204005846.Y83403@onyx.ispol.com>
	 <5.2.1.1.2.20031204114547.02af1930@mail.pyxos.com>
Message-ID: <1070561052.13675.62.camel@heppc22.hep.caltech.edu>

Hi

Hmmm, you're right, I should have read the documentation again before
posting that. Treating %> as an unindent would also eliminate the
looping html construct.

Cheers

Conrad

On Thu, 2003-12-04 at 09:50, Dan W. wrote:
> That would eliminate conditional html.  However, it might be interesting if 
> PSP had a special directive for conditional html such as two percent signs.
> 
> <%%
> for x in xrange(10):
> %>
> 
> -Dan
> 
> At 09:35 AM 12/4/2003 -0800, you wrote:
> >Hi Grisha
> >
> >This may not be a bug, but it could still be worth the effort to make an
> >%> be considered a newline as well - purely from a support perspective
> >and the amount of annoyance it might save you and countless new users of
> >PSP :-)
> >
> >Cheers
> >
> >Conrad
> >
> >On Wed, 2003-12-03 at 22:00, Gregory (Grisha) Trubetskoy wrote:
> > > I think the best practice is to use a comment rather than a blank line:
> > >
> > > <%
> > > for x in range(0):
> > >       pass
> > > # end for
> > > %>
> > >
> > > Grisha
> > >
> > > On Wed, 3 Dec 2003, Dan W. wrote:
> > >
> > > >
> > > > I realized my error too late.  I needed a blank line after the loop.  PSP
> > > > was considering the rest of the page to be part of the loop and since the
> > > > loop did not execute neither did the html.
> > > >
> > > > -Dan
> > > >
> > > >
> > > >
> > > > At 09:14 PM 12/3/2003 -0600, you wrote:
> > > >
> > > > >It turns out that my problem wasn't related to the worker MPM after
> > > > >all.  After minimizing the code down I've found that PSP fails on zero
> > > > >element for loops.  The following PSP page should reproduce the problem.
> > > > >
> > > > ><%
> > > > >for x in range(0):
> > > > >     pass
> > > > >%>
> > > > >Hello world
> > > > >
> > > > >Does the PSP maintainer read this list?
> > > > >
> > > > >-Dan
> > > > >
> > > > >
> > > > >
> > > > >At 05:54 PM 12/3/2003 -0600, you wrote:
> > > > >
> > > > > >I'm running into a weird problem with 3.1.2b and Apache 2.0.47 
> > compiled
> > > > > >under the worker MPM.  I have two Apache processes, each with 25
> > > > > >threads.  I have a very simple PSP page which imports a simple .py 
> > module
> > > > > >and prints out a value.  The problem is that the page is only 
> > served part
> > > > > >of the time.  When it is served, it is correct (no tracebacks), 
> > but if I
> > > > > >do a browser reload a couple times it will eventually serve a blank
> > > > > >page.  I can immediately do a browser reload a few more times and 
> > get a
> > > > > >few more blank pages.  Then if I wait a few seconds and do a browser
> > > > > >reload again then it will serve up the proper page.
> > > > > >
> > > > > >I'm not quite sure how to verify it, but it appears as though one 
> > process
> > > > > >is having a problem with mod_python while the other process is 
> > functioning
> > > > > >properly.  Any suggestions on how I could verify this or other ideas?
> > > > > >
> > > > > >I wasn't able to find anything in the documentation on MPM 
> > compatibility.
> > > > > >
> > > > > >Thanks!
> > > > > >
> > > > > >-Dan
> > > > > >
> > > > > >_______________________________________________
> > > > > >Mod_python mailing list
> > > > > >Mod_python@modpython.org
> > > > > >http://mailman.modpython.org/mailman/listinfo/mod_python
> > > > >
> > > > >_______________________________________________
> > > > >Mod_python mailing list
> > > > >Mod_python@modpython.org
> > > > >http://mailman.modpython.org/mailman/listinfo/mod_python
> > > >
> > > > _______________________________________________
> > > > Mod_python mailing list
> > > > Mod_python@modpython.org
> > > > http://mailman.modpython.org/mailman/listinfo/mod_python
> > > >
> > > _______________________________________________
> > > Mod_python mailing list
> > > Mod_python@modpython.org
> > > http://mailman.modpython.org/mailman/listinfo/mod_python
> >--
> >Conrad Steenberg <conrad@hep.caltech.edu>
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
-- 
Conrad Steenberg <conrad@hep.caltech.edu>

From Vincent.Raaijmakers at ge.com  Thu Dec  4 16:21:34 2003
From: Vincent.Raaijmakers at ge.com (Raaijmakers, Vincent (IndSys, GE Interlogix))
Date: Fri Jan  9 21:47:58 2004
Subject: [mod_python] Handlers "good practice" question
Message-ID: <971323274247EB44B9A01D0A3B424C8503FF22A2@FTWMLVEM02.e2k.ad.ge.com>

Thanks, 

but please bring me up to speed. I read the information on the web. Do I have to see pywork as a replacement or add-on for all the Handlers of mod_python?
I mean, the default handlers are also a mechanism to go from web -> python code.

Well, perhaps this question shows my newbie level.

Also, based on the other responses, I definitely going to read the O'Reilly book about "Writing Apache Modules in C and Perl"


Vincent

-----Original Message-----
From: Julian Ciccale [mailto:jciccale@mac.com]
Sent: Thursday, December 04, 2003 9:32 AM
To: Raaijmakers, Vincent (IndSys, GE Interlogix)
Subject: Re: [mod_python] Handlers "good practice" question


I suggest you using a web framework on top of mod_python great foundations!

Try PyWork from http://pywork.sf.net , there is also draco and albatross.


On Thursday, December 04, 2003, at 02:48PM, Raaijmakers, Vincent (IndSys, GE Interlogix) <Vincent.Raaijmakers@ge.com> wrote:

>
><<Original Attached>>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python
>
>

From grisha at modpython.org  Thu Dec  4 22:51:53 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:47:58 2004
Subject: [mod_python] session management
In-Reply-To: <OF46341989.F03189B8-ON85256DF2.004D673F@notes.bmo.com>
References: <OF46341989.F03189B8-ON85256DF2.004D673F@notes.bmo.com>
Message-ID: <20031204224817.G97860@onyx.ispol.com>


On Thu, 4 Dec 2003 anthony.barker@bmo.com wrote:

> Do the mod_python sessions work in windows 2000?

I think it does, but if you read the recent "Problem with Session module
with multiple..." thread, it appears there is a bug with the way the path
is provided in the cookies on Windows in the latest beta version.

But, aside from that, the answer is "yes" ;-)

> It would be nice if the session module was compatible with cgi,
> so it could be used in prototyping situations where the user doesn't
> have access to a mod_python enabled apache server....

Cgi and mod_python are worlds apart, it makes no sense to find a
compromize between them.

Grisha
From jciccale at mac.com  Fri Dec  5 08:44:14 2003
From: jciccale at mac.com (Julian Ciccale)
Date: Fri Jan  9 21:47:58 2004
Subject: [mod_python] Handlers "good practice" question
Message-ID: <12818729.1070610254969.JavaMail.jciccale@mac.com>


>but please bring me up to speed. I read the information on the web. Do I have to see pywork as a 
>replacement or add-on for all the Handlers of mod_python?

In this case its a mod_python handler, so it would be a replacement


>I mean, the default handlers are also a mechanism to go from web -> python code.

Yes all the default python handlers are a mechanism to gor from web to python code and are really fast.

>Also, based on the other responses, I definitely going to read the O'Reilly book about "Writing 
> Apache Modules in C and Perl"

I don't see why you should write modules in C and Perl to write a web application. ModPython offers
much more flexibility and power and ModPython *IS* an Apache C Module, your applications, IMHO should be written in a higher level language, and only if you really need very high performance, you could rewrite some of your application's modules in C.

To get to know mod_python I think you could begin to understand the Publisher handler and if you are more lazy then try PSP..

In any case if you will start a big project I strongly suggest you to use some MVC/templating library.

- julcicc -
From gdamjan at mail.net.mk  Fri Dec  5 13:25:24 2003
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 21:47:58 2004
Subject: [mod_python] Mod_python disables mod_dav
In-Reply-To: <20031127054340.GA3835@legolas.on.net.mk>
References: <20031127054340.GA3835@legolas.on.net.mk>
Message-ID: <20031205122524.GA16632@legolas.on.net.mk>

> I'm using Apache 2.0.48 (it happened to 2.0.47 too) with the built-in
> mod_dav module and mod_python 3.1.2b/Python-2.3.2 and PHP/4.3.4.
> 
> I can't understand why but unless I disable mod_python (by commenting
> the LoadModule directive), DAV will not work. It just returns a "405
> Method is not allowed" error. 
> 
> I've tried different DAV setups and clients, and nothing - unless I
> disable mod_python it wont work...
> 
> Now I think that with older versions of mod_python this did not happen -
> but I'm not sure. I'll have to recheck that.
> 
> Does anyone know why this could happen?!?

Any ideas? Can at least, someone confirm my problem?
btw
I'm using "Slackware Linux 9.1"

-- 
Damjan Georgievski
jabberID: damjan@bagra.net.mk
From neel at mediapulse.com  Fri Dec  5 10:39:00 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:47:58 2004
Subject: [mod_python] Handlers "good practice" question
Message-ID: <C0FC22C08B82074A88B500617641577787A7DF@johnson.mediapulse.net>

> >Also, based on the other responses, I definitely going to 
> read the O'Reilly book about "Writing 
> > Apache Modules in C and Perl"
> 
> I don't see why you should write modules in C and Perl to 
> write a web application. ModPython offers
> much more flexibility and power and ModPython *IS* an Apache 
> C Module, your applications, IMHO should be written in a 
> higher level language, and only if you really need very high 
> performance, you could rewrite some of your application's 
> modules in C.
> 

I think you missed some of the thread. The point of recommending the
book is not to learn how write module in C or Perl, but to learn how
apache works.  AFAIK this is the only book out there that details the
Apache API, but even in it's dated state it's very useful.  Somethings
this book helped make clear for me was the difference between
authorization and authencation, how to have multiple handlers on the
same request in apache 1.3 (or why fixup handlers always return false),
and that all log handlers are called that are registered for a request.

Mike

From barry at python.org  Fri Dec  5 10:59:53 2003
From: barry at python.org (Barry Warsaw)
Date: Fri Jan  9 21:47:58 2004
Subject: [mod_python] mod_python ignoring --with-python?
Message-ID: <1070639992.1377.6.camel@anthem>

I have a very strange problem which I don't quite understand.  I'm on a
RH9 system, with an Apache 2.0.48 built in a non-standard location, and
a Python 2.3.2 built in a non-standard location.  So when I configure
mod_python 3.0.4, I use --with-apxs to point at my non-standard Apache's
bin/apxs, and --with-python to point at my non-standard python
executable.  make ; make install and everything appears to go in the
right places.

Now I start up Apache doing something like:

% cd non/standard/location
% sudo bin/httpd -DONE_PROCESS

However, it appears as if mod_python is still using the first Python on
my $PATH instead of the one I used to configure --with-python.  I can
tell this because 1) if mod_python isn't installed in my $PATH Python,
Apache will throw a server error saying it couldn't import
mod_python.apache; 2) if I strace httpd I can see it's trying to do tons
of imports from /usr/local (where my $PATH Python is installed).

So either I misunderstand how --with-python is supposed to work, or this
is a bug, or it's a missing feature. ;).  Shouldn't mod_python honor
--with-python and ignore $PATH python?

Thanks for any light you can shed.  Let me know if you need more
information.
-Barry


From jciccale at mac.com  Fri Dec  5 17:31:16 2003
From: jciccale at mac.com (Julian Ciccale)
Date: Fri Jan  9 21:47:58 2004
Subject: [mod_python] Handlers "good practice" question
Message-ID: <702685.1070641876421.JavaMail.jciccale@mac.com>

 I think you are right, it seems I missed something. However the httpd apache documentation, as well as the APR documentation for 2.0.x are very good starting points to get to know apache internals.
 
On Friday, December 05, 2003, at 04:39PM, Michael C. Neel <neel@mediapulse.com> wrote:

>> >Also, based on the other responses, I definitely going to 
>> read the O'Reilly book about "Writing 
>> > Apache Modules in C and Perl"
>> 
>> I don't see why you should write modules in C and Perl to 
>> write a web application. ModPython offers
>> much more flexibility and power and ModPython *IS* an Apache 
>> C Module, your applications, IMHO should be written in a 
>> higher level language, and only if you really need very high 
>> performance, you could rewrite some of your application's 
>> modules in C.
>> 
>
>I think you missed some of the thread. The point of recommending the
>book is not to learn how write module in C or Perl, but to learn how
>apache works.  AFAIK this is the only book out there that details the
>Apache API, but even in it's dated state it's very useful.  Somethings
>this book helped make clear for me was the difference between
>authorization and authencation, how to have multiple handlers on the
>same request in apache 1.3 (or why fixup handlers always return false),
>and that all log handlers are called that are registered for a request.
>
>Mike
>
>
From JTesser at nbbc.edu  Sun Dec  7 17:44:57 2003
From: JTesser at nbbc.edu (Jason Tesser)
Date: Fri Jan  9 21:47:58 2004
Subject: [mod_python] Python CMS with PgSQL
Message-ID: <04875CB4331F0240A0AD66F970978651160A5D@paul>

I am thinking about developing a CMS with Python and Postgres.  I am developing
on a Linux box with Apache 2.  I have used PHP in the past but my at work we are
considering going with Python as our main devellopment language.  A few
questions for you guys.

1. Is it best to just develop in all Pyhton or to use a mixture of PHP and Python? 
Why orther than personal feelings?

2. What is the best way to template using Python for me to seperate content 
from logic?  All the data that will be displayed in dynamic so I am not sure 
what the best way to template it would be in Python.

Thank you for any thoughts offered.

From damon at asianreflection.com  Mon Dec  8 22:45:45 2003
From: damon at asianreflection.com (Damon Lynch)
Date: Fri Jan  9 21:47:58 2004
Subject: [mod_python] Python CMS with PgSQL
In-Reply-To: <04875CB4331F0240A0AD66F970978651160A5D@paul>
References: <04875CB4331F0240A0AD66F970978651160A5D@paul>
Message-ID: <1070876744.24987.76.camel@damon.asianreflection.com>

On Mon, 2003-12-08 at 12:44, Jason Tesser wrote:

> 2. What is the best way to template using Python for me to seperate content 
> from logic?  All the data that will be displayed in dynamic so I am not sure 
> what the best way to template it would be in Python.

(I realize this is a mod_python list but...)

http://www.plone.org/documentation/zpt1 has some interesting ideas worth
a read.

HTH,
Damon

From petri.savolainen at iki.fi  Mon Dec  8 14:38:59 2003
From: petri.savolainen at iki.fi (Petri Savolainen)
Date: Fri Jan  9 21:47:58 2004
Subject: [mod_python] Re: Python CMS with PgSQL
In-Reply-To: <04875CB4331F0240A0AD66F970978651160A5D@paul>
References: <04875CB4331F0240A0AD66F970978651160A5D@paul>
Message-ID: <br1r9v$pct$1@sea.gmane.org>

Jason Tesser wrote:

> I am thinking about developing a CMS with Python and Postgres.  I am developing
> on a Linux box with Apache 2.  I have used PHP in the past but my at work we are
> considering going with Python as our main devellopment language.  A few
> questions for you guys.

Don't reinvent the wheel. Building your own CMS is not a good idea 
unless none of the existing "CMS type" web frameworks do what you need - 
which would be very surprising as there are dozens of them for both PHP 
and Python; do a bit of research and pick one that suits your needs 
best. For python, Zope is the largest and most difficult for someone 
coming from PHP world. There are also many alternatives to a full-blown 
CMS that you may find yourself more comfortable with, such as mod_python 
:-) Also be very careful when you see the word CMS used about a platform 
or product... it is used ultra-liberally in the industry.

> 1. Is it best to just develop in all Pyhton or to use a mixture of PHP and Python? 
> Why orther than personal feelings?

Don't mix languages unless you have to. Keep it simple if you can.

Much of the language issue is nonsense; more important is what is your 
company development model and style than the language that is used. For 
simple (in terms of code complexity and amount of lines) web apps and 
sites, whether you do apache + php + sql is not really that much 
different from apache + mod_python + sql. Both shine doing what they are 
supposed to.

However, if you are moving towards building large systems, or develop 
actual software products, you will find out there are things that are 
not well supported in php or that you simply cannot do.

> 2. What is the best way to template using Python for me to seperate content 
> from logic?  All the data that will be displayed in dynamic so I am not sure 
> what the best way to template it would be in Python.

I would recommend Page Templates; the technology originates from Zope, 
but there are standalone libraries you can use with mod_python, such as 
SimpleTAL/TALES and OpenTAL, and probably others. Note that there is 
also an implementation for PHP that you may find interesting.

I have not tried the templating system being developed for mod_python; 
if you're considering mod_python, you should also try its native 
templating system.

Hope that helps,

  Petri

From JTesser at nbbc.edu  Mon Dec  8 14:44:11 2003
From: JTesser at nbbc.edu (Jason Tesser)
Date: Fri Jan  9 21:47:58 2004
Subject: [mod_python] Re: Python CMS with PgSQL
Message-ID: <04875CB4331F0240A0AD66F970978651160A61@paul>

<snip>

> Don't reinvent the wheel. Building your own CMS is not a good idea 
> unless none of the existing "CMS type" web frameworks do what you need - 
> which would be very surprising as there are dozens of them for both PHP 
> and Python; do a bit of research and pick one that suits your needs 
> best. For python, Zope is the largest and most difficult for someone 
> coming from PHP world. There are also many alternatives to a full-blown 
> CMS that you may find yourself more comfortable with, such as mod_python 
> :-) Also be very careful when you see the word CMS used about a platform 
> or product... it is used ultra-liberally in the industry.

I have looked at all the ones I know of but they all lack some of the features or
control I need.  I need to have a lot of users changing and editing content 
(text only) and it all goes to an editor.  All layout, graphics and photos need 
to be filtered through a different person.  Some types of content ie news needs to 
be approved by a vice president.  Zope can be extended to do all this but with
what I would need to do to extend it I might as customize it and write it
myself.  I do have a little experience with Python as I have written a POS
system in it.  The CMS I need will eventually even handle online registration as
I work for a Bible College.  I don't see it as reinventing the wheel I just 
don't like being tied down to a framework.  That is why I don't like Websphere
or J2ee.  

<snip>

> I have not tried the templating system being developed for mod_python; 
> if you're considering mod_python, you should also try its native 
> templating system.

What is mod_python's templating system?  Is it PSP.  I am trying to get PSP working
now and I cannot seem to get it to work.  I am using mod_python 3.01 with apache 2
on a RH9 box.  When I goto the page I just get the psp code?  :-s  Any ideas?


_____________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python

From JTesser at nbbc.edu  Mon Dec  8 14:50:46 2003
From: JTesser at nbbc.edu (Jason Tesser)
Date: Fri Jan  9 21:47:58 2004
Subject: [mod_python] PSP how to????
Message-ID: <04875CB4331F0240A0AD66F970978651011376FA@paul>

OK can someone please explain to me how to get Apache 2 with mod_python 3.01 to recogize xxxx.psp pages?
I am just a poor programmer and my system admin skills need help :-) 

From conrad at hep.caltech.edu  Mon Dec  8 13:29:24 2003
From: conrad at hep.caltech.edu (Conrad Steenberg)
Date: Fri Jan  9 21:47:58 2004
Subject: [mod_python] PSP how to????
In-Reply-To: <04875CB4331F0240A0AD66F970978651011376FA@paul>
References: <04875CB4331F0240A0AD66F970978651011376FA@paul>
Message-ID: <1070918964.23133.5.camel@heppc22.hep.caltech.edu>

Hi Jason

You need a newer version: 3.1.x, with the newest being 3.1.2b on
www.modpython.org

Cheers

Conrad

On Mon, 2003-12-08 at 12:50, Jason Tesser wrote:
> OK can someone please explain to me how to get Apache 2 with mod_python 3.01 to recogize xxxx.psp pages?
> I am just a poor programmer and my system admin skills need help :-) 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
-- 
Conrad Steenberg <conrad@hep.caltech.edu>

From neel at mediapulse.com  Mon Dec  8 16:33:45 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:47:58 2004
Subject: [mod_python] Re: Python CMS with PgSQL
Message-ID: <C0FC22C08B82074A88B500617641577787A7E2@johnson.mediapulse.net>

> > Don't reinvent the wheel. Building your own CMS is not a good idea 
> > unless none of the existing "CMS type" web frameworks do 
> what you need - 
> 
> I have looked at all the ones I know of but they all lack 
> some of the features or
> control I need. 

I can understan this, there are a lot of CMS apps out there but none of
these wheels ever seem "round" when you need one =p.

Tools that I know of:

mod_python comes with psp (with 3.x); this is very new atm, so things
may change as it grows and might cause you some headache with backwards
compatibility.  The worst setup I could see is needing to patch
mod_pyhton for a fix, but not wanting the latest version of PSP that
comes with it.  This is also partly me; I usally don't look deeply into
something until it's stood at least a year - so I know it will be
around.

For mod_python you can also get Draco (http://draco.boskant.nl/) or
Spyce (http://spyce.sourceforge.net/).  Both of these are close to the
way PSP works; spyce more so that Draco.  Draco allows for code to be in
a separate file, which might lend itself to larger projects better.

There is also Albatross
(http://www.object-craft.com.au/projects/albatross/), which works for
mod_python, CGI, and in a standalone webserver.  Albatross extends along
the same lines as Draco, but instead of placing raw python in templates
it uses an XML-like tag language of al- and alx- tags.  Albatross can
also store it's session objects client side, server side, or on a
session server to support clusterd websites.

For down and dirty, quick and cheap, there is ezt
(http://svn.webdav.org/repos/projects/subwiki/trunk/lib/ezt.py), which
isn't a project to itself, but I've found useful when all I needed was
some %s magic with a bit more control (i.e. ifs and loops).

There are more I'm sure, but those are the ones stuck in my head.  I use
ezt and/or Albatross myself, each for about a year now.  I recommend
playing with each one, seeing which one works best in your enviroment,
then going with it.

Have fun,
Mike

From JTesser at nbbc.edu  Mon Dec  8 16:31:47 2003
From: JTesser at nbbc.edu (Jason Tesser)
Date: Fri Jan  9 21:47:58 2004
Subject: [mod_python] PSP how to????
Message-ID: <04875CB4331F0240A0AD66F970978651160A62@paul>

Is that release stable???


-----Original Message-----
From:	Conrad Steenberg [mailto:conrad@hep.caltech.edu]
Sent:	Mon 12/8/2003 3:29 PM
To:	Jason Tesser
Cc:	Mod_Python (E-mail)
Subject:	Re: [mod_python] PSP how to????
Hi Jason

You need a newer version: 3.1.x, with the newest being 3.1.2b on
www.modpython.org

Cheers

Conrad

On Mon, 2003-12-08 at 12:50, Jason Tesser wrote:
> OK can someone please explain to me how to get Apache 2 with mod_python 3.01 to recogize xxxx.psp pages?
> I am just a poor programmer and my system admin skills need help :-) 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
-- 
Conrad Steenberg <conrad@hep.caltech.edu>






From Brian.Parkinson at quest.com  Mon Dec  8 17:44:44 2003
From: Brian.Parkinson at quest.com (Brian Parkinson)
Date: Fri Jan  9 21:47:58 2004
Subject: [mod_python] Help getting mod_python set up on Windows/Apache
Message-ID: <46C5DCD410224A42BE3151AC8AE75E4E016E091B@tormbxw01.prod.quest.corp>

Hello:

I am trying to get mod_python working, and for the life of me I'm
stumped.

Version of Python: 2.2
Version of Apache: 2.0.48
Version of mod_python: 3.0.4

Here is the bit from my http.conf file in the Apache dist:

LoadModule python_module modules/mod_python.so

<Directory "C:/home/web/docs/"> 
  AddHandler python-program .py
  PythonHandler test 
  PythonDebug On 
</Directory>

I have a file called C:/home/web/docs/test.py and it contains:

from mod_python import apache

def handler(req):
    req.write("Hello World!")
    return apache.OK

When I re-start Apache, and then enter the URL to the test.py
file (http://localhost/test.py) the following is my log message:

[Mon Dec 08 14:40:03 2003] [notice] Parent: Created child process 2188
[Mon Dec 08 14:40:03 2003] [notice] Child 2188: Child process is running
[Mon Dec 08 14:40:03 2003] [notice] Child 2188: Acquired the start
mutex.
[Mon Dec 08 14:40:03 2003] [notice] Child 2188: Starting 250 worker
threads.
[Mon Dec 08 14:40:16 2003] [error] make_obcallback: could not import
mod_python.apache.


Agh!

Can anyone help me? This seems to close, but yet so far.

Thanks,

parki...



From grisha at modpython.org  Mon Dec  8 21:05:18 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:47:58 2004
Subject: [mod_python] Python CMS with PgSQL
In-Reply-To: <04875CB4331F0240A0AD66F970978651160A5D@paul>
References: <04875CB4331F0240A0AD66F970978651160A5D@paul>
Message-ID: <20031208210414.X60503@onyx.ispol.com>



On Sun, 7 Dec 2003, Jason Tesser wrote:

> 1. Is it best to just develop in all Pyhton or to use a mixture of PHP
> and Python?

This may sound too simple, but I recommend you stick to Python only, for
everything. :-)

Grisha
From scott_list at mischko.com  Mon Dec  8 22:06:53 2003
From: scott_list at mischko.com (Scott Chapman)
Date: Fri Jan  9 21:47:58 2004
Subject: [mod_python] PSP how to????
In-Reply-To: <04875CB4331F0240A0AD66F970978651160A62@paul>
References: <04875CB4331F0240A0AD66F970978651160A62@paul>
Message-ID: <200312082206.53039.scott_list@mischko.com>

On Monday 08 December 2003 14:31, Jason Tesser wrote:
> Is that release stable???

Yes.  It seems very good.  By the time you get to production, there will 
likely be a new version out anyway.  :-)

P.S. I prefer Draco. It's design strikes me as very elegant.  I've made 
mods such as making the templates so that they are able to be read from 
a hash variable rather than a file.  This provides a great deal of 
flexibility.  It's a very nice tool set.

Get Draco from CVS, not the production version, for use with 3.1.2b.

Scott

From davidf at sjsoft.com  Tue Dec  9 11:26:23 2003
From: davidf at sjsoft.com (David Fraser)
Date: Fri Jan  9 21:47:58 2004
Subject: [mod_python] Re: Python CMS with PgSQL
In-Reply-To: <04875CB4331F0240A0AD66F970978651160A61@paul>
References: <04875CB4331F0240A0AD66F970978651160A61@paul>
Message-ID: <3FD5953F.4050709@sjsoft.com>

Jason Tesser wrote:

><snip>
>
>  
>
>>Don't reinvent the wheel. Building your own CMS is not a good idea 
>>unless none of the existing "CMS type" web frameworks do what you need - 
>>which would be very surprising as there are dozens of them for both PHP 
>>and Python; do a bit of research and pick one that suits your needs 
>>best. For python, Zope is the largest and most difficult for someone 
>>coming from PHP world. There are also many alternatives to a full-blown 
>>CMS that you may find yourself more comfortable with, such as mod_python 
>>:-) Also be very careful when you see the word CMS used about a platform 
>>or product... it is used ultra-liberally in the industry.
>>    
>>
>
>I have looked at all the ones I know of but they all lack some of the features or
>control I need.  I need to have a lot of users changing and editing content 
>(text only) and it all goes to an editor.  All layout, graphics and photos need 
>to be filtered through a different person.  Some types of content ie news needs to 
>be approved by a vice president.  Zope can be extended to do all this but with
>what I would need to do to extend it I might as customize it and write it
>myself.  I do have a little experience with Python as I have written a POS
>system in it.  The CMS I need will eventually even handle online registration as
>I work for a Bible College.  I don't see it as reinventing the wheel I just 
>don't like being tied down to a framework.  That is why I don't like Websphere
>or J2ee.  
>
><snip>
>  
>
I would have a look at plone, it's a CMS built on top of Zope
www.plone.org

David

From JTesser at nbbc.edu  Tue Dec  9 10:46:10 2003
From: JTesser at nbbc.edu (Jason Tesser)
Date: Fri Jan  9 21:47:58 2004
Subject: [mod_python] PSP how to????
Message-ID: <04875CB4331F0240A0AD66F970978651011376FB@paul>

> You need a newer version: 3.1.x, with the newest being 3.1.2b on
> www.modpython.org

OK I got and and I am trying to compile it.  I am on a Suse9.0 box with Apache2
installed.  When I run ./configure --with-apxs=/usr/share/apache2 it tells
me I need to run apache2.  It doesn't tell me what I am running now but all
I have installed in apache2.  Any ideas?

From sergey at optimaltec.com  Tue Dec  9 12:04:11 2003
From: sergey at optimaltec.com (Sergey A. Lipnevich)
Date: Fri Jan  9 21:47:58 2004
Subject: [mod_python] Re: PSP how to????
In-Reply-To: <04875CB4331F0240A0AD66F970978651011376FB@paul>
References: <04875CB4331F0240A0AD66F970978651011376FB@paul>
Message-ID: <3FD6008B.4090005@optimaltec.com>

try --with-apxs=$(which apxs)

Jason Tesser wrote:
>>You need a newer version: 3.1.x, with the newest being 3.1.2b on
>>www.modpython.org
> 
> 
> OK I got and and I am trying to compile it.  I am on a Suse9.0 box with Apache2
> installed.  When I run ./configure --with-apxs=/usr/share/apache2 it tells
> me I need to run apache2.  It doesn't tell me what I am running now but all
> I have installed in apache2.  Any ideas?


From patm at visi.com  Tue Dec  9 11:21:29 2003
From: patm at visi.com (Patrick McNamee)
Date: Fri Jan  9 21:47:58 2004
Subject: [mod_python] PSP how to????
In-Reply-To: <04875CB4331F0240A0AD66F970978651011376FB@paul>
References: <04875CB4331F0240A0AD66F970978651011376FB@paul>
Message-ID: <20031209172129.GB27875@isis.visi.com>

On Tue, Dec 09, 2003 at 10:46:10AM -0600, Jason Tesser wrote:
> > You need a newer version: 3.1.x, with the newest being 3.1.2b on
> > www.modpython.org
> 
> OK I got and and I am trying to compile it.  I am on a Suse9.0 box with Apache2
> installed.  When I run ./configure --with-apxs=/usr/share/apache2 it tells
> me I need to run apache2.  It doesn't tell me what I am running now but all
> I have installed in apache2.  Any ideas?

I think you want something like: 
./configure --with-apxs=/usr/share/apache2/bin/apxs --with-python=/path/to/python2.2

See http://www.modpython.org/live/mod_python-3.1.2b/doc-html/installation.html
for more info.

pm
From menion at asylumwear.com  Tue Dec  9 11:49:56 2003
From: menion at asylumwear.com (Joshua Schmidlkofer)
Date: Fri Jan  9 21:47:58 2004
Subject: [mod_python] import site errors, and constant modules (Re)loading
Message-ID: <1070999395.32237.19.camel@bubbles.imr-net.com>

I have poked through the list archives, and I still am.  I have Redhat
with mod_python-3.0.1 - the rpm packaged release.  In any case, whenever
I call my script it is re-instantiating the objects..

my script is like:

<snip>
class foo:
    def __init__(self):
        self.dbconn = psycopg.connect(.....)
        pass
    def handler(self, req):
        ....
        return content

__classholder__ = foo()
handler = foo.handler
</snip>

Did I fail to grok the greater meaning?  Am I committing a rookie
error?   I have turned on debug mode, and everytime I call the script I
get : 

[Tue Dec 09 11:18:25 2003] [notice] mod_python: (Re)importing module
'update' with path set to '['/var/www/html/proxy']'
'import site' failed; use -v for traceback
(this repeats about 20 times)


Anyway, thanks,
  joshua (going back to google)

-- 
I refuse to believe that the really hot, Debian-using,
password-sniffing, root-exploiting geek girl is a myth. -- g1zmo

From michael at dynamine.net  Tue Dec  9 12:03:27 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 21:47:59 2004
Subject: [mod_python] import site errors, and constant modules (Re)loading
In-Reply-To: <1070999395.32237.19.camel@bubbles.imr-net.com>
References: <1070999395.32237.19.camel@bubbles.imr-net.com>
Message-ID: <3FD62A8F.20708@dynamine.net>

I believe that in debug mode, your handler is always re-imported.  (Not 
necessarily its dependencies, though; that code is up to you.)

--Michael

Joshua Schmidlkofer wrote:
> I have poked through the list archives, and I still am.  I have Redhat
> with mod_python-3.0.1 - the rpm packaged release.  In any case, whenever
> I call my script it is re-instantiating the objects..
> 
> my script is like:
> 
> <snip>
> class foo:
>     def __init__(self):
>         self.dbconn = psycopg.connect(.....)
>         pass
>     def handler(self, req):
>         ....
>         return content
> 
> __classholder__ = foo()
> handler = foo.handler
> </snip>
> 
> Did I fail to grok the greater meaning?  Am I committing a rookie
> error?   I have turned on debug mode, and everytime I call the script I
> get : 
> 
> [Tue Dec 09 11:18:25 2003] [notice] mod_python: (Re)importing module
> 'update' with path set to '['/var/www/html/proxy']'
> 'import site' failed; use -v for traceback
> (this repeats about 20 times)
> 
> 
> Anyway, thanks,
>   joshua (going back to google)
> 

From denneking at nngov.com  Tue Dec  9 15:39:54 2003
From: denneking at nngov.com (David Enneking)
Date: Fri Jan  9 21:47:59 2004
Subject: [mod_python] 
Message-ID: <5.1.1.6.0.20031209150205.02be1ca0@pop.visi.net>

Hi,

Where can I find an example of using the session object and persistent data 
within a PSP page.

Thanks,
David
-------------- next part --------------

---
Outgoing mail is certified Virus Free.
Checked by AVG anti-virus system (http://www.grisoft.com).
Version: 6.0.545 / Virus Database: 339 - Release Date: 11/27/2003
From menion at asylumwear.com  Tue Dec  9 13:08:55 2003
From: menion at asylumwear.com (Joshua Schmidlkofer)
Date: Fri Jan  9 21:47:59 2004
Subject: [mod_python] import site errors, and
	constant	modules	(Re)loading
In-Reply-To: <3FD638D2.3030302@dynamine.net>
References: <1070999395.32237.19.camel@bubbles.imr-net.com>
	 <3FD62A8F.20708@dynamine.net>
	 <1071001721.32237.31.camel@bubbles.imr-net.com>
	 <3FD632F2.80503@dynamine.net>
	 <1071003271.32237.54.camel@bubbles.imr-net.com>
	 <3FD638D2.3030302@dynamine.net>
Message-ID: <1071004134.32237.70.camel@bubbles.imr-net.com>

Micheal,

  Thanks for keep up with me..... I moved everything to a separate
module, and I imported the module, used the db connection, etc. 

   Is it possible that I am not returning properly?   When you are using
the publisher handler, all the documentation and examples I have seen
have a "return content" at the end.  So I am storing everything in a
string, and "return"ing at the end of my handler method.  

  I can't figure this out, nothing is getting garbage collected, and
that must mean it is still in scope in some context or other.  


  idea?

thanks,
  Joshua



On Tue, 2003-12-09 at 13:04, Michael S. Fischer wrote:
> In my own work, the connection-handling code is in a separate module. 
> Though, if you do it right, it should work identically in the mod_python 
> module, assuming mod_python is not reloading the module.
> 
> --Michael
> 
> Joshua Schmidlkofer wrote:
> 
> > On Tue, 2003-12-09 at 12:39, Michael S. Fischer wrote:
> > 
> >>Yeah, try something like this:
> >>
> >><module 'db'>
> >>
> >>_conn = None
> >>def getConnection():
> >>    global _conn
> >>    if not _conn:
> >>       _conn = ...  # Get connection
> >>    return _conn
> >>
> >>See if something like that works.
> >>
> >>Joshua Schmidlkofer wrote:
> > 
> > 
> > Yeah, I pretty much have this exact logic - save one thing - is this in
> > a separate module that get imported?  Was that what your first message
> > said?
> > 
> > thanks,
> >   Joshua
> > 
> > 
> > 
-- 
I refuse to believe that the really hot, Debian-using,
password-sniffing, root-exploiting geek girl is a myth. -- g1zmo

From menion at asylumwear.com  Tue Dec  9 13:32:15 2003
From: menion at asylumwear.com (Joshua Schmidlkofer)
Date: Fri Jan  9 21:47:59 2004
Subject: [mod_python] import site errors,
	and	constant	modules	(Re)loading
In-Reply-To: <3FD63BED.5030000@dynamine.net>
References: <1070999395.32237.19.camel@bubbles.imr-net.com>
	 <3FD62A8F.20708@dynamine.net>
	 <1071001721.32237.31.camel@bubbles.imr-net.com>
	 <3FD632F2.80503@dynamine.net>
	 <1071003271.32237.54.camel@bubbles.imr-net.com>
	 <3FD638D2.3030302@dynamine.net> <1  <3FD63BED.5030000@dynamine.net>
Message-ID: <1071005534.32237.92.camel@bubbles.imr-net.com>

On Tue, 2003-12-09 at 13:17, Michael S. Fischer wrote:
> Indeed, when using the publisher handler, you are supposed to return the 
> content.
> 
> I don't understand your code, though.  What is the idea behind its 
> arrangement?
> 
> Normally when I make mod_python.publisher scripts, I do something like:
> 
> <snip>
> _conn = None
> def _getConnection(...):
>     global _conn
>     if not _conn:
>        _conn = ...
>     return _conn
> 
> def index(req, params...):
>     ...
>     conn = _getConnection(...)
>     ...
>     return content
> </snip>
> 

Here is an example, that is producing the problem for me:


import psycopg, os, copy, types


_DSN     = 'dbname=mydb user=myuser host=dbserver'
_conn    = None

def getConnection():
    global _conn
    if not _conn: _conn = psycopg.connect(_DSN)
    return _conn.cursor()

def index(**kwargs):
    cursor = getConnection()

    cursor.execute("select * from bad")

    content = """
    <html><head><title>test</test></head>
    <body>

    Test:<br>%s
    
    </body></html>
    """

    tmp = ""
    for x in cursor.fetchall(): tmp += "%s<br>" % str(x)

    cursor.close()
    del cursor
    return content % tmp


From grisha at modpython.org  Wed Dec 10 00:54:05 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:47:59 2004
Subject: [mod_python] import site errors, and constant modules (Re)loading
In-Reply-To: <1070999395.32237.19.camel@bubbles.imr-net.com>
References: <1070999395.32237.19.camel@bubbles.imr-net.com>
Message-ID: <20031210004953.B77939@onyx.ispol.com>



On Tue, 9 Dec 2003, Joshua Schmidlkofer wrote:

> [Tue Dec 09 11:18:25 2003] [notice] mod_python: (Re)importing module
> 'update' with path set to '['/var/www/html/proxy']'
> 'import site' failed; use -v for traceback
> (this repeats about 20 times)

You should get as many of these messages as there are httpd processes
running. 20 seems a bit high to me, unless your httpd is configured to
have a minimum 20 servers running at any given time, but it is not
impossible (or unreasonable for a high volume server).

Do you get one of these for every request, or only for the first 20?

Grisha
From rey4 at columbia.edu  Wed Dec 10 02:28:35 2003
From: rey4 at columbia.edu (Russell Yanofsky)
Date: Fri Jan  9 21:47:59 2004
Subject: [mod_python] script_name bug again
Message-ID: <br6i02$5lh$1@sea.gmane.org>

Hi,

At the beginning of August I reported a bug affecting the value of the
script_name cgi variable and posted two patches to fix it in mod_python
2.7.8 and 3.0.3.

The fix appears to have been included in mod_python 3.0.4, but not in
mod_python 2.7.9. Is there a chance it can be included in the next release
of 2.7?

The patches are posted here:

http://www.modpython.org/pipermail/mod_python/attachments/20030811/8718dca2/mod_python-2.7.8.obj
http://www.modpython.org/pipermail/mod_python/attachments/20030811/8718dca2/mod_python-3.0.3.obj

The initial bug report is here:

http://www.modpython.org/pipermail/mod_python/2003-August/003495.html

And the fix for mod_python 3.0 was committed here:

http://cvs.apache.org/viewcvs.cgi/httpd-python/src/mod_python.c?r1=1.95&r2=1.96

- Russ


From catellani.m at maxmara.it  Wed Dec 10 09:17:12 2003
From: catellani.m at maxmara.it (Marco Catellani)
Date: Fri Jan  9 21:47:59 2004
Subject: [mod_python] Managing multiple users with mod-python
Message-ID: <3153892629catellani.m@maxmara.it>


Hi,
I'm experienced with Python and I'm learning to configure and use Mod Python (rel 3.03) and Apache (rel 2).
I'm setting up on my server a test environment, and I would like to manage multiple users, everyone of them using a different python interpreter.
Every programmer in my test environment should work with its own user and the python programs launched by him should run under his user and should not interfere with other user's processes.
Apache supports only one user for all child processes, so I'm not able to launch multiple interpreters with different users. Does Mod Python offers any feature to satisfy my need?

Thanks a lot

     Marco



From michael at dynamine.net  Wed Dec 10 09:46:36 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 21:47:59 2004
Subject: [mod_python] Managing multiple users with mod-python
In-Reply-To: <3153892629catellani.m@maxmara.it>
References: <3153892629catellani.m@maxmara.it>
Message-ID: <3FD75BFC.7030900@dynamine.net>

No.  If you want each user to have his own instance of Apache, have each 
one run his own copy, each of which is bound to a personal port.

--Michael

Marco Catellani wrote:

> Hi,
> I'm experienced with Python and I'm learning to configure and use Mod Python (rel 3.03) and Apache (rel 2).
> I'm setting up on my server a test environment, and I would like to manage multiple users, everyone of them using a different python interpreter.
> Every programmer in my test environment should work with its own user and the python programs launched by him should run under his user and should not interfere with other user's processes.
> Apache supports only one user for all child processes, so I'm not able to launch multiple interpreters with different users. Does Mod Python offers any feature to satisfy my need?
> 
> Thanks a lot
> 
>      Marco
> 
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 
From matt at pollenation.net  Wed Dec 10 18:31:16 2003
From: matt at pollenation.net (Matt Goodall)
Date: Fri Jan  9 21:47:59 2004
Subject: [mod_python] Managing multiple users with mod-python
In-Reply-To: <3FD75BFC.7030900@dynamine.net>
References: <3153892629catellani.m@maxmara.it> <3FD75BFC.7030900@dynamine.net>
Message-ID: <3FD76674.1040708@pollenation.net>


> Marco Catellani wrote:
>
>> Hi,
>> I'm experienced with Python and I'm learning to configure and use Mod 
>> Python (rel 3.03) and Apache (rel 2).
>> I'm setting up on my server a test environment, and I would like to 
>> manage multiple users, everyone of them using a different python 
>> interpreter.
>> Every programmer in my test environment should work with its own user 
>> and the python programs launched by him should run under his user and 
>> should not interfere with other user's processes.
>> Apache supports only one user for all child processes, so I'm not 
>> able to launch multiple interpreters with different users. Does Mod 
>> Python offers any feature to satisfy my need? 
>
Assuming you don't need the tight coupling Apache+mod_python provides ...

You may want to look at something like SCGI for development instead of 
mod_python. You would assign each user an SCGI port number (Bob uses 
3000, Dave uses 3001 etc) and then configure Apache so that each user 
has a virtual host or URL path on the web server which forwards requests 
to the user's SCGI process. Your users can then develop, start and stop 
the web app from somewhere within their home directory, without ever 
needing to touch Apache.

There are quite a few web frameworks which work behind either SCGI or 
mod_python so moving from SCGI during development to mod_python for 
production (if that's what you decide to do) should be relatively painless.

    SCGI - http://www.mems-exchange.org/software/scgi/

Another interesting solution to your problem, although nothing to do 
with Apache or mod_python, is Twisted's spreadable web servers. See 
http://www.twistedmatrix.com/documents/howto/using-twistedweb#auto19 for 
more. It's worth pointing out that the personal servers can be any 
Twisted-based web application and not just something that serves content 
from the file system.

Hope this helps.

Cheers, Matt

-- 
Matt Goodall, Pollenation Internet Ltd
w: http://www.pollenationinternet.com
e: matt@pollenation.net


From dpopowich at mtrsd.k12.ma.us  Thu Dec 11 11:10:07 2003
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Fri Jan  9 21:47:59 2004
Subject: [mod_python] mod_python 3.1.2b and directory indexes
Message-ID: <16344.38623.864766.807800@gargle.gargle.HOWL>


I upgraded to 3.1.2b recently and have noticed that when I reference
an URL that is a directory my request handler is never called, but
instead I get a directory index (assuming Option Indexes is specified,
if not I get a 403 error).  This didn't happen with 3.0.1 where
directory or file, my python request handler was called.

Anyone else notice this?

------------------
Daniel Popowich
Network Specialist
-------------------------------------
Mohawk Trail Regional School District
24 Ashfield Rd.
Shelburne Falls, MA 01370
413.625.0192 x22
-------------------------------------

From JTesser at nbbc.edu  Thu Dec 11 11:24:03 2003
From: JTesser at nbbc.edu (Jason Tesser)
Date: Fri Jan  9 21:47:59 2004
Subject: [mod_python] setup help
Message-ID: <04875CB4331F0240A0AD66F97097865101137707@paul>

I have the following script saved as test.py and saved under htdoc


From JTesser at nbbc.edu  Thu Dec 11 11:26:57 2003
From: JTesser at nbbc.edu (Jason Tesser)
Date: Fri Jan  9 21:47:59 2004
Subject: [mod_python] config help
Message-ID: <04875CB4331F0240A0AD66F97097865101137708@paul>

I have the folowing script saved as test.py under htdocs.

from mod_python import apache

def handler(req):
	req.write("Hello World!")
	return apache.OK

I cannot get it to execute properly with mod_python.  Here the configuration from my apache config file.

<Directory /srv/www/htdocs/>
  AddHandler python-program .py
  PythonHandler test
  #PythonHandler mod_python.publisher
  PythonDebug On
</Directory>
I tried uncommenting the publisher handler which doesn't work at all for me.  What am I missing :-s

From grisha at modpython.org  Thu Dec 11 12:36:16 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:47:59 2004
Subject: [mod_python] mod_python 3.1.2b and directory indexes
In-Reply-To: <16344.38623.864766.807800@gargle.gargle.HOWL>
References: <16344.38623.864766.807800@gargle.gargle.HOWL>
Message-ID: <20031211123551.N4056@onyx.ispol.com>


it's a bug. this has been fixed in the latest cvs.

On Thu, 11 Dec 2003, Daniel J. Popowich wrote:

>
> I upgraded to 3.1.2b recently and have noticed that when I reference
> an URL that is a directory my request handler is never called, but
> instead I get a directory index (assuming Option Indexes is specified,
> if not I get a 403 error).  This didn't happen with 3.0.1 where
> directory or file, my python request handler was called.
>
> Anyone else notice this?
>
> ------------------
> Daniel Popowich
> Network Specialist
> -------------------------------------
> Mohawk Trail Regional School District
> 24 Ashfield Rd.
> Shelburne Falls, MA 01370
> 413.625.0192 x22
> -------------------------------------
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From cs1spw at bath.ac.uk  Thu Dec 11 14:08:17 2003
From: cs1spw at bath.ac.uk (Simon Willison)
Date: Fri Jan  9 21:47:59 2004
Subject: [mod_python] mod_python 3.1.2b and directory indexes
In-Reply-To: <16344.38623.864766.807800@gargle.gargle.HOWL>
References: <16344.38623.864766.807800@gargle.gargle.HOWL>
Message-ID: <3FD8CEB1.3080000@bath.ac.uk>

Daniel J. Popowich wrote:

> I upgraded to 3.1.2b recently and have noticed that when I reference
> an URL that is a directory my request handler is never called, but
> instead I get a directory index (assuming Option Indexes is specified,
> if not I get a 403 error).  This didn't happen with 3.0.1 where
> directory or file, my python request handler was called.

I was hit by that one too. My solution was to ditch Directory directives 
entirely and switch to using Location instead, which appears to be a 
much more logical way of working with mod_python as handlers can live 
anywhere on the Python path, making Directory based handlers pretty much 
irrelevant.
From davidf at sjsoft.com  Fri Dec 12 17:20:17 2003
From: davidf at sjsoft.com (David Fraser)
Date: Fri Jan  9 21:47:59 2004
Subject: [mod_python] config help
In-Reply-To: <04875CB4331F0240A0AD66F97097865101137708@paul>
References: <04875CB4331F0240A0AD66F97097865101137708@paul>
Message-ID: <3FD9DCB1.3090004@sjsoft.com>

Jason Tesser wrote:

>I have the folowing script saved as test.py under htdocs.
>
>from mod_python import apache
>
>def handler(req):
>	req.write("Hello World!")
>	return apache.OK
>
>I cannot get it to execute properly with mod_python.  Here the configuration from my apache config file.
>  
>
When you say, you cannot get it to execute, you should describe exactly 
what you tried (the URL) and the response you got...

><Directory /srv/www/htdocs/>
>  AddHandler python-program .py
>  PythonHandler test
>  #PythonHandler mod_python.publisher
>  PythonDebug On
></Directory>
>I tried uncommenting the publisher handler which doesn't work at all for me.  What am I missing :-s
>  
>
Have you added the Python module (LoadModule etc) to the main apache 
configuration?

David
From jay at jaydorsey.com  Fri Dec 12 09:42:34 2003
From: jay at jaydorsey.com (Jay Dorsey)
Date: Fri Jan  9 21:47:59 2004
Subject: [mod_python] config help
In-Reply-To: <04875CB4331F0240A0AD66F97097865101137708@paul>
References: <04875CB4331F0240A0AD66F97097865101137708@paul>
Message-ID: <20031212154234.GA3929@gentoo.Earthlink.net>

On Thu, Dec 11, 2003 at 11:26:57AM -0600, Jason Tesser wrote:
> I have the folowing script saved as test.py under htdocs.
> 
> from mod_python import apache
> 
> def handler(req):
> 	req.write("Hello World!")
> 	return apache.OK
>

This looks fine

> I cannot get it to execute properly with mod_python.  Here the configuration from my apache config file.
> 
> <Directory /srv/www/htdocs/>
>   AddHandler python-program .py
>   PythonHandler test
>   #PythonHandler mod_python.publisher
>   PythonDebug On
> </Directory>

So does this, except for maybe that trailing slash on htdocs (I don't
have one in my setup, not sure if its required, disallowed, or 
allowed though).  Are you sure your restarted apache after you made the 
changes to your config file?  Have you checked the apache error logs
to see if you're getting any messages there?  Are you sure you're 
serving pages out of /srv/www/htdocs?  

-- 
Jay Dorsey
jay at jaydorsey dot com
From JTesser at nbbc.edu  Fri Dec 12 09:28:49 2003
From: JTesser at nbbc.edu (Jason Tesser)
Date: Fri Jan  9 21:47:59 2004
Subject: [mod_python] config help
Message-ID: <04875CB4331F0240A0AD66F9709786510113770D@paul>

HI,

>>I have the folowing script saved as test.py under htdocs.
>>
>>from mod_python import apache
>>
>>def handler(req):
>>	req.write("Hello World!")
>>	return apache.OK
>>
>>I cannot get it to execute properly with mod_python.  Here the configuration from my apache config file.
 
>
> When you say, you cannot get it to execute, you should describe exactly 
> what you tried (the URL) and the response you got...

It just prints the script on the page.

>> <Directory /srv/www/htdocs/>
>>  AddHandler python-program .py
>>  PythonHandler test
>>  #PythonHandler mod_python.publisher
>>  PythonDebug On
>> </Directory>
>> I tried uncommenting the publisher handler which doesn't work at all for me.  What am I missing :-s
>  
>
> Have you added the Python module (LoadModule etc) to the main apache 
> configuration?

Yes it is loaded.  

From dannoritzer at web.de  Fri Dec 12 19:09:36 2003
From: dannoritzer at web.de (=?ISO-8859-1?Q?G=FCnter_Dannoritzer?=)
Date: Fri Jan  9 21:47:59 2004
Subject: [mod_python] Problem with 'import' statement in 'execfile' script
Message-ID: <3FDA0460.1030406@web.de>

Hello,

I have a problem with a python script I try to execute from a publisher 
handler with the command 'execfile'.

The script starts with the following lines:

import sys
sys.path.append('/ab/system')
from Tools.Utilities import Utilities

So I have the module Utilities under /ab/system/Tools and extend my path 
first so that the following from/import statement will find it.

When I call the web page (my publisher handler with the 'execfile' 
command) I get the error message:

    ImportError: No module named Tools.Utilities

When I execute the same script with 'python <scriptname>' or 
'execfile(<scriptname>)' out of python, it is executed without errors. 
Even when I do it with the user apache is running as.

If I leave the 'sys.path.append' command out and execute the script by 
itself I get the error message as well. So the 'sys.path.append' must 
basically work, just not when using it with the publisher handler.

My configuration is:

Apache-AdvancedExtranetServer/2.0.47 (Mandrake Linux/6.1.92mdk) 
mod_python/3.1.0a Python/2.3

Can anybody tell me why I get the error with the publisher handler and 
not when I execute the script by itself?

Thanks for your help.

Guenter




From neel at mediapulse.com  Fri Dec 12 13:38:15 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:47:59 2004
Subject: [mod_python] Problem with 'import' statement in 'execfile' script
Message-ID: <C0FC22C08B82074A88B50061764157776B98B9@johnson.mediapulse.net>

> import sys
> sys.path.append('/ab/system')
> from Tools.Utilities import Utilities
> 

Have you tried using the PythonPath directive
(http://www.modpython.org/live/current/doc-html/dir-other-pp.html)?  I'm
not sure if setting the path inside the script is something you can do
(but again, I'm not sure).

Mike

From Vincent.Raaijmakers at ge.com  Fri Dec 12 12:42:47 2003
From: Vincent.Raaijmakers at ge.com (Raaijmakers, Vincent (IndSys, GE Interlogix))
Date: Fri Jan  9 21:47:59 2004
Subject: [mod_python] Problem with 'import' statement in 'execfile' script
Message-ID: <971323274247EB44B9A01D0A3B424C8504495618@FTWMLVEM02.e2k.ad.ge.com>

Is the package in your library/ site-packages ?
/usr/local/lib/python2.3/site-packages

and if so,

do you use perhaps soft links? ln -s /path_a/Tools /path_b/Tools
I had a lot of these issues using soft links.

Vincent

-----Original Message-----
From: mod_python-bounces@modpython.org
[mailto:mod_python-bounces@modpython.org]On Behalf Of G?nter Dannoritzer
Sent: Friday, December 12, 2003 1:10 PM
To: mod_python@modpython.org
Subject: [mod_python] Problem with 'import' statement in 'execfile'
script


Hello,

I have a problem with a python script I try to execute from a publisher 
handler with the command 'execfile'.

The script starts with the following lines:

import sys
sys.path.append('/ab/system')
from Tools.Utilities import Utilities

So I have the module Utilities under /ab/system/Tools and extend my path 
first so that the following from/import statement will find it.

When I call the web page (my publisher handler with the 'execfile' 
command) I get the error message:

    ImportError: No module named Tools.Utilities

When I execute the same script with 'python <scriptname>' or 
'execfile(<scriptname>)' out of python, it is executed without errors. 
Even when I do it with the user apache is running as.

If I leave the 'sys.path.append' command out and execute the script by 
itself I get the error message as well. So the 'sys.path.append' must 
basically work, just not when using it with the publisher handler.

My configuration is:

Apache-AdvancedExtranetServer/2.0.47 (Mandrake Linux/6.1.92mdk) 
mod_python/3.1.0a Python/2.3

Can anybody tell me why I get the error with the publisher handler and 
not when I execute the script by itself?

Thanks for your help.

Guenter




_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python

From kevin at sb.org  Fri Dec 12 15:07:24 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:47:59 2004
Subject: [mod_python] Trouble installing mod_python
Message-ID: <CD80C6EA-2CDE-11D8-BBFA-000A95A072FC@sb.org>

I'm running Mac OS X 10.3 with Apache 2 installed (via the Complete 
Apache 2 installer package) and I'm trying to install mod_python 
(latest from CVS). I ./configure and make and make install it fine, but 
when I add the LoadModule line to my httpd.conf file and do a Check 
Syntax I get the following error:

Syntax error on line 1099 of /Library/Apache2/conf/httpd.conf:
Cannot load /Library/Apache2/modules/mod_python.so into server: dyld: 
/Library/Apache2/bin/httpd Undefined symbols:
_PyExc_AttributeError
_PyExc_IOError
_PyExc_IndexError
_PyExc_KeyError
_PyExc_RuntimeError
_PyExc_StopIteration
_PyExc_TypeError
_PyExc_ValueError
_PyInt_Type
_PyList_Type
_PyObject_GenericGetAttr
_PyObject_GenericSetAttr
_PyString_Type
_PyType_Type
_Py_OptimizeFlag
__Py_NoneStruct
__Py_NotImplementedStruct

line 1099 is my LoadModule for mod_python. Why am I getting this error 
and how can I fix it?

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org


From michael at dynamine.net  Fri Dec 12 12:16:15 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 21:47:59 2004
Subject: [mod_python] Trouble installing mod_python
In-Reply-To: <CD80C6EA-2CDE-11D8-BBFA-000A95A072FC@sb.org>
References: <CD80C6EA-2CDE-11D8-BBFA-000A95A072FC@sb.org>
Message-ID: <3FDA220F.1050506@dynamine.net>

The default Makefile that configure creates is not quite right on OS X.

Assuming you've installed Fink and the python22 package (which is an 
implicit prerequisite for mod_python on OS X), you'll need to run 
configure like so:

env LDFLAGS="-L/sw/lib/python2.2/config -lpython2.2" ./configure

Also note that even though you've already told mod_python the path to 
python, you'll need to tell it again by prepending /sw/bin to the PATH 
before executing Apache 2.0.

--Michael

Kevin Ballard wrote:
> I'm running Mac OS X 10.3 with Apache 2 installed (via the Complete 
> Apache 2 installer package) and I'm trying to install mod_python (latest 
> from CVS). I ./configure and make and make install it fine, but when I 
> add the LoadModule line to my httpd.conf file and do a Check Syntax I 
> get the following error:
> 
> Syntax error on line 1099 of /Library/Apache2/conf/httpd.conf:
> Cannot load /Library/Apache2/modules/mod_python.so into server: dyld: 
> /Library/Apache2/bin/httpd Undefined symbols:
> _PyExc_AttributeError
> _PyExc_IOError
> _PyExc_IndexError
> _PyExc_KeyError
> _PyExc_RuntimeError
> _PyExc_StopIteration
> _PyExc_TypeError
> _PyExc_ValueError
> _PyInt_Type
> _PyList_Type
> _PyObject_GenericGetAttr
> _PyObject_GenericSetAttr
> _PyString_Type
> _PyType_Type
> _Py_OptimizeFlag
> __Py_NoneStruct
> __Py_NotImplementedStruct
> 
> line 1099 is my LoadModule for mod_python. Why am I getting this error 
> and how can I fix it?
> 
From kevin at sb.org  Fri Dec 12 15:21:11 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:47:59 2004
Subject: [mod_python] Trouble installing mod_python
In-Reply-To: <3FDA220F.1050506@dynamine.net>
References: <CD80C6EA-2CDE-11D8-BBFA-000A95A072FC@sb.org>
	<3FDA220F.1050506@dynamine.net>
Message-ID: <BA40ABC9-2CE0-11D8-BBFA-000A95A072FC@sb.org>

Why would I want to install python2.2 when OS X comes with Python 2.3?  
And why is this a prerequisite when the include files are in  
/System/Library/Frameworks/Python.framework/Versions/2.3/include/ 
python2.3/ and the makefile can find them?

On Dec 12, 2003, at 3:16 PM, Michael S. Fischer wrote:

> The default Makefile that configure creates is not quite right on OS X.
>
> Assuming you've installed Fink and the python22 package (which is an  
> implicit prerequisite for mod_python on OS X), you'll need to run  
> configure like so:
>
> env LDFLAGS="-L/sw/lib/python2.2/config -lpython2.2" ./configure
>
> Also note that even though you've already told mod_python the path to  
> python, you'll need to tell it again by prepending /sw/bin to the PATH  
> before executing Apache 2.0.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org


From michael at dynamine.net  Fri Dec 12 12:36:06 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 21:47:59 2004
Subject: [mod_python] Trouble installing mod_python
In-Reply-To: <BA40ABC9-2CE0-11D8-BBFA-000A95A072FC@sb.org>
References: <CD80C6EA-2CDE-11D8-BBFA-000A95A072FC@sb.org>
	<3FDA220F.1050506@dynamine.net> <BA40ABC9-2CE0-11D8-BBFA-000A95A072FC@sb.org>
Message-ID: <3FDA26B6.9010809@dynamine.net>

I'm just telling you what works for me.  (I'm running OS X Server 10.2, 
and so YMMV).

Do you know if OS X Server 10.3 ships with libpython2.3.a or 
libpython2.3.dylib?  If not, you'll still need Fink and the python2.2 
package.

I wouldn't fret it about too much unless there's some Python 2.3 feature 
that is absolutely required for your application.

--Michael

Kevin Ballard wrote:

> Why would I want to install python2.2 when OS X comes with Python 2.3?  
> And why is this a prerequisite when the include files are in  
> /System/Library/Frameworks/Python.framework/Versions/2.3/include/ 
> python2.3/ and the makefile can find them?
> 
> On Dec 12, 2003, at 3:16 PM, Michael S. Fischer wrote:
> 
>> The default Makefile that configure creates is not quite right on OS X.
>>
>> Assuming you've installed Fink and the python22 package (which is an  
>> implicit prerequisite for mod_python on OS X), you'll need to run  
>> configure like so:
>>
>> env LDFLAGS="-L/sw/lib/python2.2/config -lpython2.2" ./configure
>>
>> Also note that even though you've already told mod_python the path to  
>> python, you'll need to tell it again by prepending /sw/bin to the 
>> PATH  before executing Apache 2.0.
> 
> 
From alexiev at activesolutions.bg  Sat Dec 13 14:41:30 2003
From: alexiev at activesolutions.bg (Alexiev Nikolay)
Date: Fri Jan  9 21:47:59 2004
Subject: [mod_python] response content-type
Message-ID: <001401c3c176$6f0228a0$0a01010a@dev1>

How can I change content-type of respons, using publisher handler ?


---------------------------------------
Best regards,
Alexiev, Nikolay
e-mail: alexiev@activesolutions.bg
phone: +359 2 8753543
From dannoritzer at web.de  Sat Dec 13 13:41:29 2003
From: dannoritzer at web.de (=?ISO-8859-1?Q?G=FCnter_Dannoritzer?=)
Date: Fri Jan  9 21:47:59 2004
Subject: [mod_python] Problem with 'import' statement in 'execfile' script
In-Reply-To: <C0FC22C08B82074A88B50061764157776B98B9@johnson.mediapulse.net>
References: <C0FC22C08B82074A88B50061764157776B98B9@johnson.mediapulse.net>
Message-ID: <3FDB08F9.3050706@web.de>

Thanks for all the help I got on this problem.

Mike,

I was not able to test the 'PythonPath' directive yet, but I did add the 
sys.path.append to the publisher handler script and it worked.

It seems like I cannot modify the sys.path in a script I call with the 
execfile command when using mod_python.

Guenter


Michael C. Neel wrote:

>>import sys
>>sys.path.append('/ab/system')
>>from Tools.Utilities import Utilities
>>
>>    
>>
>
>Have you tried using the PythonPath directive
>(http://www.modpython.org/live/current/doc-html/dir-other-pp.html)?  I'm
>not sure if setting the path inside the script is something you can do
>(but again, I'm not sure).
>
>Mike
>
>  
>


From stian at soiland.no  Sat Dec 13 19:26:19 2003
From: stian at soiland.no (Stian =?iso-8859-1?Q?S=F8iland?=)
Date: Fri Jan  9 21:47:59 2004
Subject: [mod_python] Re: response content-type
In-Reply-To: <001401c3c176$6f0228a0$0a01010a@dev1>
References: <001401c3c176$6f0228a0$0a01010a@dev1>
Message-ID: <20031213182619.GA18517@itea.ntnu.no>

On 2003-12-13 13:41:30, Alexiev Nikolay wrote:

> How can I change content-type of respons, using publisher handler ?

Include req as first parameter, and set req.content_type.

def test(req):
    req.content_type = "image/jpeg"
    image = open("/somewhere/blapp.jpeg").read()
    return image

-- 
Stian S?iland               Work toward win-win situation. Win-lose
Trondheim, Norway           is where you win and the other lose.
http://www.soiland.no/      Lose-lose and lose-win are left as an
                            exercise to the reader.  [Limoncelli/Hogan]

From greenbeard400 at yahoo.com  Sat Dec 13 16:52:26 2003
From: greenbeard400 at yahoo.com (Greenbeard)
Date: Fri Jan  9 21:47:59 2004
Subject: [mod_python] Problem downloading the Full Archives
Message-ID: <20031214005226.99770.qmail@web21327.mail.yahoo.com>

When I went to this url:

http://mailman.modpython.org/pipermail/mod_python.mbox/mod_python.mbox

I only got about 1k of data - mail through Wed Jan 31,
2001.  Is there a different url/way to get the
archives?   I can not seem to locate  it. 

Thanks! 

gb400

__________________________________
Do you Yahoo!?
Free Pop-Up Blocker - Get it now
http://companion.yahoo.com/
From ron at UDel.Edu  Mon Dec 15 09:17:27 2003
From: ron at UDel.Edu (Ron Reisor)
Date: Fri Jan  9 21:47:59 2004
Subject: [mod_python] Trouble installing mod_python
In-Reply-To: <CD80C6EA-2CDE-11D8-BBFA-000A95A072FC@sb.org>
References: <CD80C6EA-2CDE-11D8-BBFA-000A95A072FC@sb.org>
Message-ID: <Pine.SOL.4.58L.0312150838270.10512@copland.udel.edu>

Kevin,

   The mod_python.so that is built doesn't depend on other needed shared
libraries.  This seems to be the result of how it is built by apxs.  I'm
not sure of the best way to get this problem resolved, but we have been
able to work around the problems. This is a little messy though:

   Build ssl and apache2.0.48 in /usr/local.  MacOSX 10.3 will use shared
libraries in /usr/local/lib without any changes.  The only thing I think
is special about the apache build is to specify --with-mpm=worker so you
get thread support

   Rebuild Python-2.3. I recommend 2.3.2 which includes some patches that
are important to us, but 2.3 works.  2.3.3c1 seems fine so far.  We
replaced the Apple supplied Python in preference for the latest version.
This replaces files in /Applications/MacPython-2.3 and
/Library/Frameworks/Python.framework and /usr/local/bin.  Build like:

./configure --enable-framework
make
make frameworkinstall

   To build mod_python, get the latest cvs.  It includes patches for
Python-2.3 memory/object allocation that will matter on MacOSX.  Build it
as usual to start:

./configure --with-apxs=/usr/local/bin/apxs
make
su
make install

   But, the apxs will use the gnu libtool and what you end up with is a
mod_python.so that doesn't have the right dependencies.  You can check
this with otool:

[roaming-163-213:~/macpython/httpd-python] ron% otool -L
src/.libs/mod_python.so
src/.libs/mod_python.so:
        /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current
version 71.0.0)
[roaming-163-213:~/macpython/httpd-python] ron%

   Key libraries, like Python, are missing.  So, here's the really messy
part.  Remove the mod_python.so link from src and run this command in the
src directory:

libtool -o mod_python.so -dynamic -flat_namespace -undefined suppress
hlistobject.o hlist.o filterobject.o connobject.o serverobject.o util.o
tableobject.o requestobject.o _apachemodule.o mod_python.o -framework
System -lcc_dynamic -arch_only ppc -framework Python -framework
CoreServices -framework Foundation -lm

   That should be all one shell command line.  One important difference
here is that the libtool you use is the Apple supplied libtool, not the
gnu libtool that apxs would normally use.  Also, there's switches in there
that I don't know how to get apxs to generate. If you check this with
otool you should see:

[roaming-163-213:~/macpython/httpd-python/src] ron% otool -L mod_python.so
mod_python.so:
        mod_python.so (compatibility version 0.0.0, current version 0.0.0)
        /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current
version 71.0.0)
        /Library/Frameworks/Python.framework/Versions/2.3/Python
(compatibility version 2.3.0, current version 2.3.0)

/System/Library/Frameworks/CoreServices.framework/Versions/A/CoreServices
(compatibility version 1.0.0, current version 16.0.0)

/System/Library/Frameworks/Foundation.framework/Versions/C/Foundation
(compatibility version 300.0.0, current version 500.5.0)
[roaming-163-213:~/macpython/httpd-python/src] ron%

   Then, copy the mod_python.so into the /usr/local/modules directory.

cheers,

Ron


On Fri, 12 Dec 2003, Kevin Ballard wrote:

> I'm running Mac OS X 10.3 with Apache 2 installed (via the Complete
> Apache 2 installer package) and I'm trying to install mod_python
> (latest from CVS). I ./configure and make and make install it fine, but
> when I add the LoadModule line to my httpd.conf file and do a Check
> Syntax I get the following error:
>
> Syntax error on line 1099 of /Library/Apache2/conf/httpd.conf:
> Cannot load /Library/Apache2/modules/mod_python.so into server: dyld:
> /Library/Apache2/bin/httpd Undefined symbols:
> _PyExc_AttributeError
> _PyExc_IOError
> _PyExc_IndexError
> _PyExc_KeyError
> _PyExc_RuntimeError
> _PyExc_StopIteration
> _PyExc_TypeError
> _PyExc_ValueError
> _PyInt_Type
> _PyList_Type
> _PyObject_GenericGetAttr
> _PyObject_GenericSetAttr
> _PyString_Type
> _PyType_Type
> _Py_OptimizeFlag
> __Py_NoneStruct
> __Py_NotImplementedStruct
>
> line 1099 is my LoadModule for mod_python. Why am I getting this error
> and how can I fix it?
>
> --
> Kevin Ballard
> kevin@sb.org
> http://www.tildesoft.com
> http://kevin.sb.org
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

Ron Reisor <ron@udel.edu> (RWR3)
University of Delaware Information Technologies/Network and Systems Services
Computing Center/192 South Chapel Street/Newark DE, 19716
pgp finger print: 0D 73 06 6F D3 6A 99 D3  F5 D5 6E FF 3B B9 7C 2C
From mark at gsoa.net  Mon Dec 15 13:33:23 2003
From: mark at gsoa.net (Mark McClain)
Date: Fri Jan  9 21:47:59 2004
Subject: [mod_python] re: trouble installing mod_python
Message-ID: <2A3E42DA-2F2D-11D8-A794-000A95B33D28@gsoa.net>

I've been able to build mod_python on 10.3 making very few changes.   
This process uses python 2.3 that comes with 10.3.  The problem that 
you are experiencing is because the linker does not get told to link to 
the python framework by apxs.

mark

1) Build and install apache2

2) Unpack the mod_python distribution

3) make the following changes to the configure script. here it is in 
modified form...

if test "$PyFRAMEWORKDIR" != "no-framework"; then
   if test -n "$PyFRAMEWORK"; then
     PyPYTHONLIBS="-framework $PyFRAMEWORK"

    # explicitly pass to mac linker so add this line
     LDFLAGS="${LDFLAGS} -Wl,-framework,Python"
   fi

4) run configure, make, then install

Good luck,

mark

From kevin at sb.org  Mon Dec 15 14:28:21 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:47:59 2004
Subject: [mod_python] re: trouble installing mod_python
In-Reply-To: <2A3E42DA-2F2D-11D8-A794-000A95B33D28@gsoa.net>
References: <2A3E42DA-2F2D-11D8-A794-000A95B33D28@gsoa.net>
Message-ID: <D7A8AD94-2F34-11D8-B6D0-000A95A072FC@sb.org>

Wow, that worked great! Thanks!

On Dec 15, 2003, at 1:33 PM, Mark McClain wrote:

> 1) Build and install apache2
>
> 2) Unpack the mod_python distribution
>
> 3) make the following changes to the configure script. here it is in 
> modified form...
>
> if test "$PyFRAMEWORKDIR" != "no-framework"; then
>   if test -n "$PyFRAMEWORK"; then
>     PyPYTHONLIBS="-framework $PyFRAMEWORK"
>
>    # explicitly pass to mac linker so add this line
>     LDFLAGS="${LDFLAGS} -Wl,-framework,Python"
>   fi
>
> 4) run configure, make, then install

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org


From kevin at sb.org  Mon Dec 15 14:57:12 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:47:59 2004
Subject: [mod_python] re: trouble installing mod_python
In-Reply-To: <2A3E42DA-2F2D-11D8-A794-000A95B33D28@gsoa.net>
References: <2A3E42DA-2F2D-11D8-A794-000A95B33D28@gsoa.net>
Message-ID: <DFBB3B11-2F38-11D8-B6D0-000A95A072FC@sb.org>

I tested my new mod_python and it's not working. The server log has 
nothing telling me why I'm getting an error, but if I try to run the 
mptest.py file myself from python, I get an error saying that in 
apache.py, on the import _apache line, there's no module named _apache.

What's going on and how do I fix this?

On Dec 15, 2003, at 1:33 PM, Mark McClain wrote:

> I've been able to build mod_python on 10.3 making very few changes.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org


From kevin at sb.org  Mon Dec 15 15:09:23 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:47:59 2004
Subject: [mod_python] re: trouble installing mod_python
In-Reply-To: <DFBB3B11-2F38-11D8-B6D0-000A95A072FC@sb.org>
References: <2A3E42DA-2F2D-11D8-A794-000A95B33D28@gsoa.net>
	<DFBB3B11-2F38-11D8-B6D0-000A95A072FC@sb.org>
Message-ID: <931CB23E-2F3A-11D8-B6D0-000A95A072FC@sb.org>

Argh, please ignore this. I realize now that _apache is provided by 
mod_python, and I also discovered the source of my form.py problem. I 
also discovered how mptest.py was failing, but I don't know why yet 
(but I will find out).

Anyway, sorry to bother you.

On Dec 15, 2003, at 2:57 PM, Kevin Ballard wrote:

> I tested my new mod_python and it's not working. The server log has 
> nothing telling me why I'm getting an error, but if I try to run the 
> mptest.py file myself from python, I get an error saying that in 
> apache.py, on the import _apache line, there's no module named 
> _apache.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org


From tim.stebbing at nunatak.com.au  Tue Dec 16 09:54:37 2003
From: tim.stebbing at nunatak.com.au (Timothy Stebbing)
Date: Fri Jan  9 21:47:59 2004
Subject: [mod_python] creating apache modules with mod_python
Message-ID: <3FDE3BAD.2050406@nunatak.com.au>

Is it possible to create apache modules using mod_python? I want to 
create a new protocol module for apache2.0, is there any info on doing 
this sort ofthing with mod_python, or has anyone done this sort of thing 
yet?

From kevin at sb.org  Mon Dec 15 19:29:08 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:48:00 2004
Subject: [mod_python] Strange server errors
Message-ID: <DC81D053-2F5E-11D8-B6D0-000A95A072FC@sb.org>

This is really strange. I tested my form.py thing from the Tutorial and 
it would just hang. I'd get absolutely no response from the server. I 
tried a few times, and then I started getting internal server errors 
instead, but with nothing in the error log. So I quit Apache and 
started httpd back up in single process mode (sudo ./httpd 
-DONE_PROCESS, as per the Troubleshooting section). At that point, my 
scripts magically started working (with no output to the shell from 
httpd). I then quit that and started Apache back up normally, and my 
scripts continue to work. Any idea what was going on, in case this 
weird stuff happens again?

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org


From tim.stebbing at nunatak.com.au  Tue Dec 16 12:30:34 2003
From: tim.stebbing at nunatak.com.au (Timothy Stebbing)
Date: Fri Jan  9 21:48:00 2004
Subject: [mod_python] PythonConnectionHandler directive
Message-ID: <3FDE603A.3010100@nunatak.com.au>

Howdy,

Im trying to get a simple protocol handler running, yet apache does not 
seem to be calling my code.

I have this in my apache config, this starts without any errors:

Listen 192.168.0.18:4444
<VirtualHost 192.168.0.18:4444>
        ServerAdmin webmaster@localhost
        DocumentRoot /var/www/nunatak/
        ErrorLog /tmp/test-error.log
        LogLevel debug
        PythonConnectionHandler protocol
</VirtualHost>

in /var/www/nunatak/protocol.py:

from mod_python import apache
 
def connectionhandler(conn):
    conn.write("Hello!")
    f = open("/tmp/foo.log", "w+")
    f.write("foo happened!\n")
    f.close()
    return apache.OK

when I telnet to localhost 4444 I get:

Trying 192.168.0.18...
Connected to balrog.localnet.
Escape character is '^]'.
Connection closed by foreign host.

I have no /tmp/foo.log at all, which makes me think the script has not 
been located/run

in my ErrorLog for the virtual host I have:
[Tue Dec 16 23:26:23 2003] [error] python_connection: 
ConnectionDispatch() returned nothing.


Im guessing its a problem with my virtualhost definition not being set 
up correctly, but in the docs
for mod_python there is not much more info on this subject.

-tjs


From kevin at sb.org  Mon Dec 15 21:05:45 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:48:00 2004
Subject: [mod_python] Strange server errors
In-Reply-To: <DC81D053-2F5E-11D8-B6D0-000A95A072FC@sb.org>
References: <DC81D053-2F5E-11D8-B6D0-000A95A072FC@sb.org>
Message-ID: <5C2E79EA-2F6C-11D8-B6D0-000A95A072FC@sb.org>

Argh. Sorry for bothering you with my problems. I just found the cause 
and it's not mod_python's fault. The problem is doing a graceful 
restart of apache isn't actually restarting properly, which is causing 
conflicts when accessing python scripts. If I stop the server, wait for 
it to finish shutting down, then start it back up, everything works 
just fine.

On Dec 15, 2003, at 7:29 PM, Kevin Ballard wrote:

> This is really strange. I tested my form.py thing from the Tutorial 
> and it would just hang. I'd get absolutely no response from the 
> server. I tried a few times, and then I started getting internal 
> server errors instead, but with nothing in the error log. So I quit 
> Apache and started httpd back up in single process mode (sudo ./httpd 
> -DONE_PROCESS, as per the Troubleshooting section). At that point, my 
> scripts magically started working (with no output to the shell from 
> httpd). I then quit that and started Apache back up normally, and my 
> scripts continue to work. Any idea what was going on, in case this 
> weird stuff happens again?

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org


From grisha at modpython.org  Mon Dec 15 22:37:51 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:48:00 2004
Subject: [mod_python] PythonConnectionHandler directive
In-Reply-To: <3FDE603A.3010100@nunatak.com.au>
References: <3FDE603A.3010100@nunatak.com.au>
Message-ID: <20031215223427.U71289@onyx.ispol.com>


I think the problem is the python path. Try making sure that the directory
where protocol.py is located is added to PythonPath:

PythonPath "sys.path+['/var/www/nunatak']"

Since this is a connection handler, the DocumentRoot is irrelevant and
the path in it has no effect.

Grisha

On Tue, 16 Dec 2003, Timothy Stebbing wrote:

> Howdy,
>
> Im trying to get a simple protocol handler running, yet apache does not
> seem to be calling my code.
>
> I have this in my apache config, this starts without any errors:
>
> Listen 192.168.0.18:4444
> <VirtualHost 192.168.0.18:4444>
>         ServerAdmin webmaster@localhost
>         DocumentRoot /var/www/nunatak/
>         ErrorLog /tmp/test-error.log
>         LogLevel debug
>         PythonConnectionHandler protocol
> </VirtualHost>
>
> in /var/www/nunatak/protocol.py:
>
> from mod_python import apache
>
> def connectionhandler(conn):
>     conn.write("Hello!")
>     f = open("/tmp/foo.log", "w+")
>     f.write("foo happened!\n")
>     f.close()
>     return apache.OK
>
> when I telnet to localhost 4444 I get:
>
> Trying 192.168.0.18...
> Connected to balrog.localnet.
> Escape character is '^]'.
> Connection closed by foreign host.
>
> I have no /tmp/foo.log at all, which makes me think the script has not
> been located/run
>
> in my ErrorLog for the virtual host I have:
> [Tue Dec 16 23:26:23 2003] [error] python_connection:
> ConnectionDispatch() returned nothing.
>
>
> Im guessing its a problem with my virtualhost definition not being set
> up correctly, but in the docs
> for mod_python there is not much more info on this subject.
>
> -tjs
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From ron at UDel.Edu  Tue Dec 16 08:35:33 2003
From: ron at UDel.Edu (Ron Reisor)
Date: Fri Jan  9 21:48:00 2004
Subject: [mod_python] re: trouble installing mod_python
In-Reply-To: <2A3E42DA-2F2D-11D8-A794-000A95B33D28@gsoa.net>
References: <2A3E42DA-2F2D-11D8-A794-000A95B33D28@gsoa.net>
Message-ID: <Pine.SOL.4.58L.0312160832400.12072@copland.udel.edu>

Mark,

   This patch works well for us too.

   Forget the hack I offered.

   Would you suggest this to python-dev@httpd.apache.org to see if it can
get added to the distribution?

thanks,

Ron


On Mon, 15 Dec 2003, Mark McClain wrote:

> I've been able to build mod_python on 10.3 making very few changes.
> This process uses python 2.3 that comes with 10.3.  The problem that
> you are experiencing is because the linker does not get told to link to
> the python framework by apxs.
>
> mark
>
> 1) Build and install apache2
>
> 2) Unpack the mod_python distribution
>
> 3) make the following changes to the configure script. here it is in
> modified form...
>
> if test "$PyFRAMEWORKDIR" != "no-framework"; then
>    if test -n "$PyFRAMEWORK"; then
>      PyPYTHONLIBS="-framework $PyFRAMEWORK"
>
>     # explicitly pass to mac linker so add this line
>      LDFLAGS="${LDFLAGS} -Wl,-framework,Python"
>    fi
>
> 4) run configure, make, then install
>
> Good luck,
>
> mark
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

Ron Reisor <ron@udel.edu> (RWR3)
University of Delaware Information Technologies/Network and Systems Services
Computing Center/192 South Chapel Street/Newark DE, 19716
pgp finger print: 0D 73 06 6F D3 6A 99 D3  F5 D5 6E FF 3B B9 7C 2C
From fccoelho at fiocruz.br  Wed Dec 17 15:07:53 2003
From: fccoelho at fiocruz.br (Flavio C. Coelho)
Date: Fri Jan  9 21:48:00 2004
Subject: [mod_python] mod_python and the semaphore bug
Message-ID: <1071680872.3902.13.camel@pinguim.procc.fiocruz.br>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: fiocruz4.jpg
Type: image/jpeg
Size: 3085 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20031217/2a49fe91/fiocruz4.jpg
From giampiero.benvenuti at chiaroscuro.com  Wed Dec 17 18:31:39 2003
From: giampiero.benvenuti at chiaroscuro.com (Giampiero Benvenuti)
Date: Fri Jan  9 21:48:00 2004
Subject: [mod_python] mod_python & MySQLdb question
Message-ID: <DF4889B2-30B6-11D8-9E76-003065D5834A@chiaroscuro.com>

Hello to all of you,

I'm quite intrigued by mod_python and the difference with "normal" 
python cgi...

for instance: I can't make this great pice of code (Jaroslaw Zabiello, 
http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/171463) wich 
works great in my cgi-bin directory, working with mod_python.

The problem I have is right at the end, when I have to deal with:

  for row in rows:
     print row['name'], row['txt']

The question is: how can I translate this last part of code to make it 
working with mod_python?

the great code:
----------------------------------
import MySQLdb
import MySQLdb.cursors

conn = MySQLdb.Connect(
     host='localhost', user='root',
     passwd='', db='test',compress=1,
     cursorclass=MySQLdb.cursors.DictCursor) # <- important
cursor = conn.cursor()
cursor.execute("SELECT name, sometext txt FROM foo")
rows = cursor.fetchall()
cursor.close()
conn.close()

for row in rows:
     print row['name'], row['txt'] # bingo!
------------------------------------

any help is much appreciated.

Thanks,

Giampiero

From tpc at csua.berkeley.edu  Wed Dec 17 09:40:52 2003
From: tpc at csua.berkeley.edu (tpc@csua.berkeley.edu)
Date: Fri Jan  9 21:48:00 2004
Subject: [mod_python] mod_python & MySQLdb question
In-Reply-To: <DF4889B2-30B6-11D8-9E76-003065D5834A@chiaroscuro.com>
Message-ID: <20031217093408.M44175-100000@localhost.name>


hi Giampiero, instead of print or echo, you use return or req.write.  I
had a similar question here:

http://www.modpython.org/pipermail/mod_python/2003-June/003263.html

I hope that helps you.

On Wed, 17 Dec 2003, Giampiero Benvenuti wrote:

> Hello to all of you,
>
> I'm quite intrigued by mod_python and the difference with "normal"
> python cgi...
>
> for instance: I can't make this great pice of code (Jaroslaw Zabiello,
> http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/171463) wich
> works great in my cgi-bin directory, working with mod_python.
>
> The problem I have is right at the end, when I have to deal with:
>
>   for row in rows:
>      print row['name'], row['txt']
>
> The question is: how can I translate this last part of code to make it
> working with mod_python?
>
> the great code:
> ----------------------------------
> import MySQLdb
> import MySQLdb.cursors
>
> conn = MySQLdb.Connect(
>      host='localhost', user='root',
>      passwd='', db='test',compress=1,
>      cursorclass=MySQLdb.cursors.DictCursor) # <- important
> cursor = conn.cursor()
> cursor.execute("SELECT name, sometext txt FROM foo")
> rows = cursor.fetchall()
> cursor.close()
> conn.close()
>
> for row in rows:
>      print row['name'], row['txt'] # bingo!
> ------------------------------------
>
> any help is much appreciated.
>
> Thanks,
>
> Giampiero
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>


From jciccale at mac.com  Wed Dec 17 23:37:11 2003
From: jciccale at mac.com (Julian Ciccale)
Date: Fri Jan  9 21:48:00 2004
Subject: [mod_python] mod_python and the semaphore bug
Message-ID: <8794402.1071700631675.JavaMail.jciccale@mac.com>

Try checking out the latest CVS sources of line 3.1.x . I think this problem is solved in
the CVS.

- julcicc - 
On Wednesday, December 17, 2003, at 06:07PM, Flavio C. Coelho <fccoelho@fiocruz.br> wrote:

>
><<Original Attached>>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20031217/439af9da/attachment.htm
From tim.stebbing at nunatak.com.au  Thu Dec 18 10:14:40 2003
From: tim.stebbing at nunatak.com.au (Timothy Stebbing)
Date: Fri Jan  9 21:48:00 2004
Subject: [mod_python] Persistant data
Message-ID: <3FE0E360.4060002@nunatak.com.au>

Is there some way to persist data resource using apache? Im writing a 
simple protocol module
using PythonConnectionHandler, this takes queries and runs them against 
various backends,
ie postgres, Lupy (indexer), etc. I want to persist my connections to 
these resources across all
requests.

Ive tried adding a db 'pool' into a module, but the module is reloaded 
for each request serviced.

Im wondering if there is some way I can add objects into these 'apache 
tables' ? would that make
them persistant, and if so how do I do that? I was also wondering if I 
could somehow access the
main namespace from child interpreters?

cheers

tjs

From michael at dynamine.net  Wed Dec 17 15:21:29 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 21:48:00 2004
Subject: [mod_python] Persistant data
In-Reply-To: <3FE0E360.4060002@nunatak.com.au>
References: <3FE0E360.4060002@nunatak.com.au>
Message-ID: <3FE0E4F9.8010302@dynamine.net>

In the interest of keeping it simple, I suggest you store your 
persistent data using anydbm and use synchronization techniques (i.e. 
rename) to ensure that two processes don't try to write to the database 
simultaneously (mid-air collision).  Other techniques just give you more 
code complexity and not much added benefit.

This is pretty much exactly what the new session code in 3.1.2b does.

--Michael

Timothy Stebbing wrote:

> Is there some way to persist data resource using apache? Im writing a 
> simple protocol module
> using PythonConnectionHandler, this takes queries and runs them against 
> various backends,
> ie postgres, Lupy (indexer), etc. I want to persist my connections to 
> these resources across all
> requests.
> 
> Ive tried adding a db 'pool' into a module, but the module is reloaded 
> for each request serviced.
> 
> Im wondering if there is some way I can add objects into these 'apache 
> tables' ? would that make
> them persistant, and if so how do I do that? I was also wondering if I 
> could somehow access the
> main namespace from child interpreters?
> 
> cheers
> 
> tjs
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 
From kevin at sb.org  Wed Dec 17 19:00:47 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:48:00 2004
Subject: [mod_python] config tree for htaccess
Message-ID: <3B9F1328-30ED-11D8-B6D0-000A95A072FC@sb.org>

Is there any way to get the config tree from any relevant .htaccess 
files as well as just the httpd.conf file, or do I have to look for and 
parse them manually? Also, is there any way to get the applicable 
config lines from the httpd.conf file, i.e. the ones inside 
<Directory>/<Files>/etc. blocks that apply to the current URI without 
having to parse them all manually?

I'm writing a script that mimics FancyIndexing and it's mostly done 
(i.e. it does just about everything except let you sort by headers, 
including scanning the AddIcon/AddIconByType/AddDescription lines in 
apache.config_tree(), and looks identical to the FancyIndexing in the 
rendered version (i.e. the source is cleaner, but the result is 
identical)), but it only uses the config directives in the root of 
httpd.conf (i.e. the root of apache.config_tree()) and I'd like to make 
it use all applicable directives.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org


From giampiero.benvenuti at chiaroscuro.com  Thu Dec 18 01:54:59 2003
From: giampiero.benvenuti at chiaroscuro.com (Giampiero Benvenuti)
Date: Fri Jan  9 21:48:00 2004
Subject: [mod_python] mod_python & MySQLdb question
In-Reply-To: <20031217093408.M44175-100000@localhost.name>
Message-ID: <CE1FDA4E-30F4-11D8-9E76-003065D5834A@chiaroscuro.com>

Thanks for your prompt answer and your help.

I'm coming from Zope, just got to mod_python a week ago. Please 
understand my being na?ve.

I'm not quite there yet: thanks to your help now I'm able to get all my 
titles form mysql, but at the
end of the page (sigh) I get an apache error: "500 Internal Server 
Error"
"The server encountered an internal error or misconfiguration and was 
unable to complete your request..."

Apache is not OK at all.

here is my code:

import MySQLdb, MySQLdb.cursors
from mod_python import apache

def read(req):
	req.content_type = "text/html"
	mydb = MySQLdb.connect(db='S_N', user='giampiero', compress=1, 
cursorclass=MySQLdb.cursors.DictCursor)
	cursor = mydb.cursor()
	stmt = "SELECT news_title FROM news"
	cursor.execute(stmt)
	rows = cursor.fetchall()
	mydb.close()
	for row in rows:
		s = row['news_title']
		print s
	return apache.OK

Thank you guys,

Giampiero





On Mercoled?, dic 17, 2003, at 18:40 Europe/Rome, 
<tpc@csua.berkeley.edu> wrote:

>
> hi Giampiero, instead of print or echo, you use return or req.write.  I
> had a similar question here:
>
> http://www.modpython.org/pipermail/mod_python/2003-June/003263.html
>
> I hope that helps you.
>
> On Wed, 17 Dec 2003, Giampiero Benvenuti wrote:
>
>> Hello to all of you,
>>
>> I'm quite intrigued by mod_python and the difference with "normal"
>> python cgi...
>>
>> for instance: I can't make this great pice of code (Jaroslaw Zabiello,
>> http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/171463) wich
>> works great in my cgi-bin directory, working with mod_python.
>>
>> The problem I have is right at the end, when I have to deal with:
>>
>>   for row in rows:
>>      print row['name'], row['txt']
>>
>> The question is: how can I translate this last part of code to make it
>> working with mod_python?
>>
>> the great code:
>> ----------------------------------
>> import MySQLdb
>> import MySQLdb.cursors
>>
>> conn = MySQLdb.Connect(
>>      host='localhost', user='root',
>>      passwd='', db='test',compress=1,
>>      cursorclass=MySQLdb.cursors.DictCursor) # <- important
>> cursor = conn.cursor()
>> cursor.execute("SELECT name, sometext txt FROM foo")
>> rows = cursor.fetchall()
>> cursor.close()
>> conn.close()
>>
>> for row in rows:
>>      print row['name'], row['txt'] # bingo!
>> ------------------------------------
>>
>> any help is much appreciated.
>>
>> Thanks,
>>
>> Giampiero
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>
>
>
>


From michael at dynamine.net  Wed Dec 17 16:57:47 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 21:48:00 2004
Subject: [mod_python] mod_python & MySQLdb question
In-Reply-To: <CE1FDA4E-30F4-11D8-9E76-003065D5834A@chiaroscuro.com>
References: <CE1FDA4E-30F4-11D8-9E76-003065D5834A@chiaroscuro.com>
Message-ID: <3FE0FB8B.3050200@dynamine.net>

What does the Apache error log have to say about it?

--Michael

Giampiero Benvenuti wrote:

> Thanks for your prompt answer and your help.
> 
> I'm coming from Zope, just got to mod_python a week ago. Please 
> understand my being na?ve.
> 
> I'm not quite there yet: thanks to your help now I'm able to get all my 
> titles form mysql, but at the
> end of the page (sigh) I get an apache error: "500 Internal Server Error"
> "The server encountered an internal error or misconfiguration and was 
> unable to complete your request..."
> 
> Apache is not OK at all.
> 
> here is my code:
> 
> import MySQLdb, MySQLdb.cursors
> from mod_python import apache
> 
> def read(req):
>     req.content_type = "text/html"
>     mydb = MySQLdb.connect(db='S_N', user='giampiero', compress=1, 
> cursorclass=MySQLdb.cursors.DictCursor)
>     cursor = mydb.cursor()
>     stmt = "SELECT news_title FROM news"
>     cursor.execute(stmt)
>     rows = cursor.fetchall()
>     mydb.close()
>     for row in rows:
>         s = row['news_title']
>         print s
>     return apache.OK
> 
> Thank you guys,
> 
> Giampiero
> 
> 
> 
> 
> 
> On Mercoled?, dic 17, 2003, at 18:40 Europe/Rome, 
> <tpc@csua.berkeley.edu> wrote:
> 
>>
>> hi Giampiero, instead of print or echo, you use return or req.write.  I
>> had a similar question here:
>>
>> http://www.modpython.org/pipermail/mod_python/2003-June/003263.html
>>
>> I hope that helps you.
>>
>> On Wed, 17 Dec 2003, Giampiero Benvenuti wrote:
>>
>>> Hello to all of you,
>>>
>>> I'm quite intrigued by mod_python and the difference with "normal"
>>> python cgi...
>>>
>>> for instance: I can't make this great pice of code (Jaroslaw Zabiello,
>>> http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/171463) wich
>>> works great in my cgi-bin directory, working with mod_python.
>>>
>>> The problem I have is right at the end, when I have to deal with:
>>>
>>>   for row in rows:
>>>      print row['name'], row['txt']
>>>
>>> The question is: how can I translate this last part of code to make it
>>> working with mod_python?
>>>
>>> the great code:
>>> ----------------------------------
>>> import MySQLdb
>>> import MySQLdb.cursors
>>>
>>> conn = MySQLdb.Connect(
>>>      host='localhost', user='root',
>>>      passwd='', db='test',compress=1,
>>>      cursorclass=MySQLdb.cursors.DictCursor) # <- important
>>> cursor = conn.cursor()
>>> cursor.execute("SELECT name, sometext txt FROM foo")
>>> rows = cursor.fetchall()
>>> cursor.close()
>>> conn.close()
>>>
>>> for row in rows:
>>>      print row['name'], row['txt'] # bingo!
>>> ------------------------------------
>>>
>>> any help is much appreciated.
>>>
>>> Thanks,
>>>
>>> Giampiero
>>>
>>> _______________________________________________
>>> Mod_python mailing list
>>> Mod_python@modpython.org
>>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>>
>>
>>
>>
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 
From rey4 at columbia.edu  Wed Dec 17 20:16:40 2003
From: rey4 at columbia.edu (Russell Yanofsky)
Date: Fri Jan  9 21:48:00 2004
Subject: [mod_python] Re: Persistant data
References: <3FE0E360.4060002@nunatak.com.au>
Message-ID: <brqv6q$3h7$1@sea.gmane.org>

Timothy Stebbing wrote:
> Is there some way to persist data resource using apache? Im writing a
> simple protocol module
> using PythonConnectionHandler, this takes queries and runs them
> against various backends,
> ie postgres, Lupy (indexer), etc. I want to persist my connections to
> these resources across all
> requests.
>
> Ive tried adding a db 'pool' into a module, but the module is reloaded
> for each request serviced.

Is the module containing the db pool the same one that you specified in
PythonConnectionHandler? If so, you should try storing the pool in a
different module and accessing it with an import statement.

> Im wondering if there is some way I can add objects into these 'apache
> tables' ? would that make
> them persistant, and if so how do I do that? I was also wondering if I
> could somehow access the
> main namespace from child interpreters?

I doubt Mod_Python is using a different interpreter for each request. It's
probably just reloading the one module.

- Russ


From rey4 at columbia.edu  Wed Dec 17 20:23:07 2003
From: rey4 at columbia.edu (Russell Yanofsky)
Date: Fri Jan  9 21:48:00 2004
Subject: [mod_python] Re: Persistant data
References: <3FE0E360.4060002@nunatak.com.au> <3FE0E4F9.8010302@dynamine.net>
Message-ID: <brqvih$42s$1@sea.gmane.org>

Michael S. Fischer wrote:
> In the interest of keeping it simple, I suggest you store your
> persistent data using anydbm and use synchronization techniques 

Heh. You want him to store his database connections in a database?

- Russ

From michael at dynamine.net  Wed Dec 17 17:29:08 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 21:48:00 2004
Subject: [mod_python] Re: Persistant data
In-Reply-To: <brqvih$42s$1@sea.gmane.org>
References: <3FE0E360.4060002@nunatak.com.au> <3FE0E4F9.8010302@dynamine.net>
	<brqvih$42s$1@sea.gmane.org>
Message-ID: <3FE102E4.9020506@dynamine.net>

> Michael S. Fischer wrote:
> 
>>In the interest of keeping it simple, I suggest you store your
>>persistent data using anydbm and use synchronization techniques 
> 
> 
> Heh. You want him to store his database connections in a database?

Oh, I must have misread his message.  Silly me.  *blush*

His question seems to be a FAQ.  Isn't it covered in there?

--Michael
From grisha at modpython.org  Wed Dec 17 21:59:16 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:48:00 2004
Subject: [mod_python] config tree for htaccess
In-Reply-To: <3B9F1328-30ED-11D8-B6D0-000A95A072FC@sb.org>
References: <3B9F1328-30ED-11D8-B6D0-000A95A072FC@sb.org>
Message-ID: <20031217215114.Q1381@onyx.ispol.com>


The config_tree only gives you what is in the main config file, that is
correct.

I am not sure that it is technically possible to get what's in .htaccess
other than reading it. As the .htaccess file is parsed, individual
directives result in calls into modules, which then do things accordingly,
but I don't think httpd tries to store this information anywhere
separately.

Grisha

On Wed, 17 Dec 2003, Kevin Ballard wrote:

> Is there any way to get the config tree from any relevant .htaccess
> files as well as just the httpd.conf file, or do I have to look for and
> parse them manually? Also, is there any way to get the applicable
> config lines from the httpd.conf file, i.e. the ones inside
> <Directory>/<Files>/etc. blocks that apply to the current URI without
> having to parse them all manually?
>
> I'm writing a script that mimics FancyIndexing and it's mostly done
> (i.e. it does just about everything except let you sort by headers,
> including scanning the AddIcon/AddIconByType/AddDescription lines in
> apache.config_tree(), and looks identical to the FancyIndexing in the
> rendered version (i.e. the source is cleaner, but the result is
> identical)), but it only uses the config directives in the root of
> httpd.conf (i.e. the root of apache.config_tree()) and I'd like to make
> it use all applicable directives.
>
> --
> Kevin Ballard
> kevin@sb.org
> http://www.tildesoft.com
> http://kevin.sb.org
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From davidf at sjsoft.com  Thu Dec 18 08:24:56 2003
From: davidf at sjsoft.com (David Fraser)
Date: Fri Jan  9 21:48:00 2004
Subject: [mod_python] Re: Persistant data
In-Reply-To: <brqv6q$3h7$1@sea.gmane.org>
References: <3FE0E360.4060002@nunatak.com.au> <brqv6q$3h7$1@sea.gmane.org>
Message-ID: <3FE14838.1080707@sjsoft.com>

Russell Yanofsky wrote:

>Timothy Stebbing wrote:
>  
>
>>Is there some way to persist data resource using apache? Im writing a
>>simple protocol module
>>using PythonConnectionHandler, this takes queries and runs them
>>against various backends,
>>ie postgres, Lupy (indexer), etc. I want to persist my connections to
>>these resources across all
>>requests.
>>
>>Ive tried adding a db 'pool' into a module, but the module is reloaded
>>for each request serviced.
>>    
>>
>
>Is the module containing the db pool the same one that you specified in
>PythonConnectionHandler? If so, you should try storing the pool in a
>different module and accessing it with an import statement.
>
>  
>
>>Im wondering if there is some way I can add objects into these 'apache
>>tables' ? would that make
>>them persistant, and if so how do I do that? I was also wondering if I
>>could somehow access the
>>main namespace from child interpreters?
>>    
>>
>
>I doubt Mod_Python is using a different interpreter for each request. It's
>probably just reloading the one module.
>  
>
It's quite possible that mod_python is using different interpreters for 
different requests if Apache is loaded with multiple processes. Each 
process will then have its own interpreter. So if you have 20 
interpreters, the likelihood that the first 4 requests each use a unique 
interpreter is 72.67%
This can make it look like each request uses its own interpreter, 
whereas actually there are a pool of interpreters being shared

David


From giampiero.benvenuti at chiaroscuro.com  Thu Dec 18 11:13:10 2003
From: giampiero.benvenuti at chiaroscuro.com (Giampiero Benvenuti)
Date: Fri Jan  9 21:48:00 2004
Subject: [mod_python] mod_python & MySQLdb question: Done
In-Reply-To: <CE1FDA4E-30F4-11D8-9E76-003065D5834A@chiaroscuro.com>
Message-ID: <C88B4324-3142-11D8-913D-003065D5834A@chiaroscuro.com>

Ok, thanks to your help an thanks to the mailing list archives I did 
find the solution (it's working for me, I'm not sure
it's the "right" one):

here is the code:

------------------------------------------------------------------
import MySQLdb, MySQLdb.cursors, mod_python

def readtitle(req):
	req.content_type = "text/html"
	req.send_http_header()
	mydb = MySQLdb.connect(db='S_N', user='giampiero', compress=1, 
cursorclass=MySQLdb.cursors.DictCursor)
	cursor = mydb.cursor()
	stmt = "SELECT news_title FROM news"
	cursor.execute(stmt)
	rows = cursor.fetchall()
	rows = list(rows)
	for row in rows:
		results = (row['news_title']+',<br>')
		req.write(results)
	
	raise mod_python.apache.SERVER_RETURN, mod_python.apache.OK
----------------------------------------------------------------

Thanks to all of you: great mailing list with nice people. I never gona 
go back umiliated to Zope now:)

Giampiero

On Gioved?, dic 18, 2003, at 01:54 Europe/Rome, Giampiero Benvenuti 
wrote:

> Thanks for your prompt answer and your help.
>
> I'm coming from Zope, just got to mod_python a week ago. Please 
> understand my being na?ve.
>
> I'm not quite there yet: thanks to your help now I'm able to get all 
> my titles form mysql, but at the
> end of the page (sigh) I get an apache error: "500 Internal Server 
> Error"
> "The server encountered an internal error or misconfiguration and was 
> unable to complete your request..."
>
> Apache is not OK at all.
>
> here is my code:
>
> import MySQLdb, MySQLdb.cursors
> from mod_python import apache
>
> def read(req):
> 	req.content_type = "text/html"
> 	mydb = MySQLdb.connect(db='S_N', user='giampiero', compress=1, 
> cursorclass=MySQLdb.cursors.DictCursor)
> 	cursor = mydb.cursor()
> 	stmt = "SELECT news_title FROM news"
> 	cursor.execute(stmt)
> 	rows = cursor.fetchall()
> 	mydb.close()
> 	for row in rows:
> 		s = row['news_title']
> 		print s
> 	return apache.OK
>
> Thank you guys,
>
> Giampiero
>
>
>
>
>
> On Mercoled?, dic 17, 2003, at 18:40 Europe/Rome, 
> <tpc@csua.berkeley.edu> wrote:
>
>>
>> hi Giampiero, instead of print or echo, you use return or req.write.  
>> I
>> had a similar question here:
>>
>> http://www.modpython.org/pipermail/mod_python/2003-June/003263.html
>>
>> I hope that helps you.
>>
>> On Wed, 17 Dec 2003, Giampiero Benvenuti wrote:
>>
>>> Hello to all of you,
>>>
>>> I'm quite intrigued by mod_python and the difference with "normal"
>>> python cgi...
>>>
>>> for instance: I can't make this great pice of code (Jaroslaw 
>>> Zabiello,
>>> http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/171463) wich
>>> works great in my cgi-bin directory, working with mod_python.
>>>
>>> The problem I have is right at the end, when I have to deal with:
>>>
>>>   for row in rows:
>>>      print row['name'], row['txt']
>>>
>>> The question is: how can I translate this last part of code to make 
>>> it
>>> working with mod_python?
>>>
>>> the great code:
>>> ----------------------------------
>>> import MySQLdb
>>> import MySQLdb.cursors
>>>
>>> conn = MySQLdb.Connect(
>>>      host='localhost', user='root',
>>>      passwd='', db='test',compress=1,
>>>      cursorclass=MySQLdb.cursors.DictCursor) # <- important
>>> cursor = conn.cursor()
>>> cursor.execute("SELECT name, sometext txt FROM foo")
>>> rows = cursor.fetchall()
>>> cursor.close()
>>> conn.close()
>>>
>>> for row in rows:
>>>      print row['name'], row['txt'] # bingo!
>>> ------------------------------------
>>>
>>> any help is much appreciated.
>>>
>>> Thanks,
>>>
>>> Giampiero
>>>
>>> _______________________________________________
>>> Mod_python mailing list
>>> Mod_python@modpython.org
>>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>>
>>
>>
>>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>


From manfred.stienstra at dwerg.net  Thu Dec 18 11:29:39 2003
From: manfred.stienstra at dwerg.net (Manfred Stienstra)
Date: Fri Jan  9 21:48:00 2004
Subject: [mod_python] mod_python & MySQLdb question: Done
In-Reply-To: <C88B4324-3142-11D8-913D-003065D5834A@chiaroscuro.com>
References: <C88B4324-3142-11D8-913D-003065D5834A@chiaroscuro.com>
Message-ID: <1071743378.12631.7.camel@ack.dwerg.net>

On Thu, 2003-12-18 at 11:13, Giampiero Benvenuti wrote:
> import MySQLdb, MySQLdb.cursors, mod_python
> 
> def readtitle(req):
> 	req.content_type = "text/html"
> 	req.send_http_header()
> 	mydb = MySQLdb.connect(db='S_N', user='giampiero', compress=1, 
> cursorclass=MySQLdb.cursors.DictCursor)
> 	cursor = mydb.cursor()
> 	stmt = "SELECT news_title FROM news"
> 	cursor.execute(stmt)
> 	rows = cursor.fetchall()
> 	rows = list(rows)
> 	for row in rows:
> 		results = (row['news_title']+',<br>')
> 		req.write(results)
> 	
> 	raise mod_python.apache.SERVER_RETURN, mod_python.apache.OK


This:

> 	rows = cursor.fetchall()
> 	rows = list(rows)
> 	for row in rows:
> 		results = (row['news_title']+',<br>')
> 		req.write(results)

can be compressed to (and made faster):


results = []
for row in cursor.fetchall():
	results.append(row['news_title'])
req.write("<br />".join(results))


Also using the DictCursor gives a little overhead in this case. This is
ofcourse not a real problem on small queries like this one.

Manfred

From giampiero.benvenuti at chiaroscuro.com  Thu Dec 18 14:56:44 2003
From: giampiero.benvenuti at chiaroscuro.com (Giampiero Benvenuti)
Date: Fri Jan  9 21:48:00 2004
Subject: [mod_python] mod_python & MySQLdb question: Done
In-Reply-To: <1071743378.12631.7.camel@ack.dwerg.net>
Message-ID: <03B2DC68-3162-11D8-913D-003065D5834A@chiaroscuro.com>

Thanks Manfred, now I'm starting to "see".
Great tip, it works like a "swiss" clock.

> This:
>
>> 	rows = cursor.fetchall()
>> 	rows = list(rows)
>> 	for row in rows:
>> 		results = (row['news_title']+',<br>')
>> 		req.write(results)
>
> can be compressed to (and made faster):
>
>
> results = []
> for row in cursor.fetchall():
> 	results.append(row['news_title'])
> req.write("<br />".join(results))
>

From tpc at csua.berkeley.edu  Thu Dec 18 08:45:41 2003
From: tpc at csua.berkeley.edu (tpc@csua.berkeley.edu)
Date: Fri Jan  9 21:48:00 2004
Subject: [mod_python] mod_python & MySQLdb question: Done
In-Reply-To: <03B2DC68-3162-11D8-913D-003065D5834A@chiaroscuro.com>
Message-ID: <20031218084200.O51827-100000@localhost.name>


hi Giampiero, can I ask you, being a newbie to Python
myself, why you are switching to modpython from Zope ?
I have heard many good things about Zope but have not
had the time to download and use it, but from what I hear
if you want to serve a complex database-backed application
there is no better way.

On Thu, 18 Dec 2003, Giampiero Benvenuti wrote:

> Thanks Manfred, now I'm starting to "see".
> Great tip, it works like a "swiss" clock.
>
> > This:
> >
> >> 	rows = cursor.fetchall()
> >> 	rows = list(rows)
> >> 	for row in rows:
> >> 		results = (row['news_title']+',<br>')
> >> 		req.write(results)
> >
> > can be compressed to (and made faster):
> >
> >
> > results = []
> > for row in cursor.fetchall():
> > 	results.append(row['news_title'])
> > req.write("<br />".join(results))
> >
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From giampiero.benvenuti at chiaroscuro.com  Fri Dec 19 11:05:55 2003
From: giampiero.benvenuti at chiaroscuro.com (Giampiero Benvenuti)
Date: Fri Jan  9 21:48:00 2004
Subject: Zope vs. mod_python!? It was "Re: [mod_python] mod_python & MySQLdb
	question: Done"
In-Reply-To: <20031218084200.O51827-100000@localhost.name>
Message-ID: <EF2C53EE-320A-11D8-913D-003065D5834A@chiaroscuro.com>


On Gioved?, dic 18, 2003, at 17:45 Europe/Rome, <tpc@csua.berkeley.edu> 
wrote:

>
> hi Giampiero, can I ask you, being a newbie to Python
> myself, why you are switching to modpython from Zope ?
> I have heard many good things about Zope but have not
> had the time to download and use it, but from what I hear
> if you want to serve a complex database-backed application
> there is no better way.

I'm not sure I can give a detailed and precise answer to your question.
Please keep in mind that I don't have any formal education in 
programming
but in photography and arts.

As far as I can see, Zope is a great tool, well designed and with great
performance. I started using it 2 years ago and it took me quite some 
time
to figure it out. I developed a few sites using it: www.cercacultura.it 
is
one of them. cercacultura.it is totally Zope based and uses the internal
ZODB database.

What triggered my curiosity in python/mod_python is the fact that Zope 
is
built "over" python and actualy the right way to use it is to keep the
business logic in python and the presentation in dtml, the Zope markup
language.
Now I am starting to experience Zope as a kind of "filter" that doesn't 
let
me really understand what is going on underneath. A sort of second 
language
that prevents you from speaking your first language. For this reason I 
am
starting to feel the limits of Zope.

What I can say now is that learning python created a new challenge and a
way to find faster and more transparent solutions. I also read that with
mod_python you can actually use some Zope modules (Zpublisher for 
example).
I very much like the mod_python integration in apache, which allows to
bypass the zope server.

There is much more to say about it, and I'm sure other people on the 
list
can be more articulate on this issue.

Thanks,

Giampiero


From fowlertrainer at anonym.hu  Fri Dec 19 12:24:08 2003
From: fowlertrainer at anonym.hu (fowlertrainer@anonym.hu)
Date: Fri Jan  9 21:48:00 2004
Subject: [mod_python] Newbie questions 1
Message-ID: <15814100725.20031219122408@anonym.hu>

Hello !

I've been used php, and zope before, but I want to try the mod_python,
becuase the py lang is seems to be better than these web-dev
langs/tools.

Some structural/tehnological questions:

1.
  I want to know, how many times used the mp_req objects ?
  Is eliminate mod_python this elements, if some of these objects don't
  needed longer ?
  I try to understand, how to be working.
  I see, that I can define global variables in main module, and the
  globals are globals in every mp_req.
  But if the system eliminate all of this objects, can holding these
  global vars ?

  Why are write this question ?

  I want to create a file or memory storaged session system.
  If the memory is cleared by every N time, it have been failed...
  So it is needed to be I have fix elements.

2.
  Is the mod_py regenerate the existing objects, and clear memory if I change the
  source code, and I have two threads/two existing objects in alive ?
  

-- 
Best regards,
 fowlertrainer                          mailto:fowlertrainer@anonym.hu

From fowlertrainer at anonym.hu  Fri Dec 19 12:31:04 2003
From: fowlertrainer at anonym.hu (fowlertrainer@anonym.hu)
Date: Fri Jan  9 21:48:00 2004
Subject: [mod_python] Newbie questions 2
Message-ID: <8314517404.20031219123104@anonym.hu>

Hello !

Part 2:

  3.
      How to I prevent some effects ?
      I want to be create an one-main-file-handled site.

      a.) So I want to remove the .py from main.py file in the
          browser, if possible.
      b.) I want to eliminate or redirect the main.pyc file, what is
          created by python in everytime.
          This file is downloadable from browser, and if any users
          have some python experience, or an decompiler, that these
          persons can get informations from my site !
      c.) I want to the main.py is let my 'index.html', so if I don't
          write any tags, that it have been processed.
          http://site/main.py
          ->
          http://site/main
          ->
          http://site/

          These elements let do same thing !!!

Thanx:
 KK

  

-- 
Best regards,
 fowlertrainer                          mailto:fowlertrainer@anonym.hu

From mod_python at ols.inorganic.org  Fri Dec 19 06:33:34 2003
From: mod_python at ols.inorganic.org (Roy S. Rapoport)
Date: Fri Jan  9 21:48:01 2004
Subject: [mod_python] mod_python & MySQLdb question: Done
In-Reply-To: <20031218084200.O51827-100000@localhost.name>
References: <03B2DC68-3162-11D8-913D-003065D5834A@chiaroscuro.com>
	<20031218084200.O51827-100000@localhost.name>
Message-ID: <20031219143334.GA10524@nag.inorganic.org>

On Thu, Dec 18, 2003 at 08:45:41AM -0800, tpc@csua.berkeley.edu wrote:
> hi Giampiero, can I ask you, being a newbie to Python
> myself, why you are switching to modpython from Zope ?
> I have heard many good things about Zope but have not
> had the time to download and use it, but from what I hear
> if you want to serve a complex database-backed application
> there is no better way.

I'm obviously not Giampiero, but I'll take a stab at answering the question
(disregarding Giampiero's specific circumstances).

I work for a privately-held financial institution in the IT group; I happen
to wear two hats, actually -- I'm a member of both the development and the
infrastructure groups.  Our choice of languages is Python, our choice of
platform on which to develop applications is the web, and our choice of web
platform on which to develop is Zope.  We are heavily invested in Zope and
we love it.  

I especially love Zope because it pretty much enforces an MVC architecture
-- ZSQL methods to access databases, python scripts for business logic,
DTML/ZPT for display logic.  

There's the upside.

The downside? The security (or lackthereof) aspects of running it sometimes
wake me up at night screaming.  OK, that's overstating it, but not by much
:)

The problem with Zope is one of its nicest features -- in-band management.
Got a Zope server at http://my.server ?  Then you can manage it at
http://my.server/manage.  Want to manage http://my.server/some/path? Again,
you can go into the management interfact of Zope on that path at
http://my.server/some/path/manage.  All management of Zope is down through
URL strings ON THE SAME IP AND PORT AS THE CONTENT YOU'RE SERVING.  

Now, again, in some respects this is really nice -- it took us about two
hours to get up a Python program that allowed us to easily synchronize
content between two or more Zope servers by just sending URLs around.  On
the downside, this means that pretty much anyone in the world is guaranteed
to be able to access the management interface of your Zope server and then
it's just a password-guessing attack.  You can front Zope with Apache --
and you're advised to -- and we're continuing to fine-tune our httpd.conf
to block URLs that look like they're management URLs -- but it's a pain,
and error-prone, and not likely to ever be complete.  The official word on
the Zope list is "Yes, it's insecure.  Deal with it and accept it."

In-band management is really user-friendly.  I think it's also a very bad
idea.  I hope they go away from that one of these days.

Oh, one more thing:  Emblematic of many (but not all) open-source projects,
Zope is a wonderful, relatively-well-constructed product with absolutely
atrocious, horrific, monstrously-bad documentation.  It's incomplete (and
in some cases wrong).  Mind you, I'm not sure mod_python is much better,
but I'm not talking about it right now :)

Hope this is useful,
-roy (ex-CSUA and OCF member)

> 
> On Thu, 18 Dec 2003, Giampiero Benvenuti wrote:
> 
> > Thanks Manfred, now I'm starting to "see".
> > Great tip, it works like a "swiss" clock.
> >
> > > This:
> > >
> > >> 	rows = cursor.fetchall()
> > >> 	rows = list(rows)
> > >> 	for row in rows:
> > >> 		results = (row['news_title']+',<br>')
> > >> 		req.write(results)
> > >
> > > can be compressed to (and made faster):
> > >
> > >
> > > results = []
> > > for row in cursor.fetchall():
> > > 	results.append(row['news_title'])
> > > req.write("<br />".join(results))
> > >
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
From gdamjan at mail.net.mk  Fri Dec 19 17:48:27 2003
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 21:48:01 2004
Subject: Zope vs. mod_python!? It was "Re: [mod_python] mod_python &
	MySQLdb question: Done"
In-Reply-To: <EF2C53EE-320A-11D8-913D-003065D5834A@chiaroscuro.com>
References: <20031218084200.O51827-100000@localhost.name>
	<EF2C53EE-320A-11D8-913D-003065D5834A@chiaroscuro.com>
Message-ID: <20031219164827.GB2368@legolas.on.net.mk>

> What I can say now is that learning python created a new challenge and a
> way to find faster and more transparent solutions. I also read that with
> mod_python you can actually use some Zope modules (Zpublisher for 
> example).

It would be great when mod_python could rould replace all the Zope
functionality, and I guess most of it can be done. Parts of Zope that
should be implemented in mod_python are:

- The Zpublisher ... well we already have the publisher in mod_python

- ZODB - I think the standalone ZODB can be easily used in mod_python,
  there might be some threading issues ... maybe.

- ZPT/DTML these also should useable in mod_python as they are ... and
  then there's also mod_python's native PSP.

- ACL's - ACL's are stored in the ZODB in Zope, and are checked by the
  Zpublisher ... we dont have this in mod_python

- WebDav - you can access your Zope objects through WebDav, ACL's
  checked again ... (also mod_python 3.1.2b conflicts somehow with
  apaches mod_dav)

- Zope's *acquisition* inheritance - this is one of the key features in
  Zope. The publisher should support this.

So it seems that an overhauled publisher for mod_python could provide
most, if not all the Zope functionality. 

Also it would be interesting to see if other storage than ZODB could be
implemented with the same features... Linux FS with ACLs and Extended
Attributes for ex. :)


just my $0.02





-- 
Damjan Georgievski
jabberID: damjan@bagra.net.mk
From redconectabilbao at telefonica.net  Fri Dec 19 17:51:45 2003
From: redconectabilbao at telefonica.net (Red Conecta)
Date: Fri Jan  9 21:48:01 2004
Subject: [mod_python] newbie
Message-ID: <3FE32CA1.7070105@telefonica.net>

Hello!

I want to try mod_python, but something doesn't work fine

I'm using Apache 2.0.47 (Mandrake Linux/1.6.91mdk) mod_python/3.0.1 
Python/2.2.2 in a Mandrake9.1 and my  http2.conf is:

...
LoadModule python_module                 extramodules/mod_python.so
...
<Directory /var/www/html>
  AddHandler python-program .py
  PythonHandler mptest
  PythonDebug On
</Directory>

and, of course there's a mptest.py in /var/www/html

But pointing to my mptest.py, my mozilla opens the dialog for 
downloading the file.

What's wrong?

Thanks
**

From kevin at sb.org  Fri Dec 19 15:21:31 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:48:01 2004
Subject: [mod_python] newbie
In-Reply-To: <3FE32CA1.7070105@telefonica.net>
References: <3FE32CA1.7070105@telefonica.net>
Message-ID: <EF2F6572-3260-11D8-B7F9-000A95A072FC@sb.org>

What's your mptest.py look like?

Most likely, it's something like

from apache import *

def handler(req):
	req.write("Hello world!")
	return apache.OK

Is that right? If so, add this line before the req.write line:

	req.content_type = "text/plain"

On Dec 19, 2003, at 11:51 AM, Red Conecta wrote:

> I want to try mod_python, but something doesn't work fine
>
> I'm using Apache 2.0.47 (Mandrake Linux/1.6.91mdk) mod_python/3.0.1 
> Python/2.2.2 in a Mandrake9.1 and my  http2.conf is:
>
> ...
> LoadModule python_module                 extramodules/mod_python.so
> ...
> <Directory /var/www/html>
>  AddHandler python-program .py
>  PythonHandler mptest
>  PythonDebug On
> </Directory>
>
> and, of course there's a mptest.py in /var/www/html
>
> But pointing to my mptest.py, my mozilla opens the dialog for 
> downloading the file.
>
> What's wrong?

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From kevin at sb.org  Fri Dec 19 15:21:37 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:48:01 2004
Subject: [mod_python] Newbie questions 2
In-Reply-To: <8314517404.20031219123104@anonym.hu>
References: <8314517404.20031219123104@anonym.hu>
Message-ID: <F2AAD67B-3260-11D8-B7F9-000A95A072FC@sb.org>

On Dec 19, 2003, at 6:31 AM, fowlertrainer@anonym.hu wrote:

>       a.) So I want to remove the .py from main.py file in the
>           browser, if possible.

Define main.py as the handler for main.

>       b.) I want to eliminate or redirect the main.pyc file, what is
>           created by python in everytime.
>           This file is downloadable from browser, and if any users
>           have some python experience, or an decompiler, that these
>           persons can get informations from my site !

Put this in your httpd.conf

<Files ~ "\.pyc$">
     Order allow,deny
     Deny from all
</Files>

That blocks access to files ending in .pyc

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From nelson at crynwr.com  Fri Dec 19 15:51:16 2003
From: nelson at crynwr.com (Russell Nelson)
Date: Fri Jan  9 21:48:01 2004
Subject: [mod_python] newbie
In-Reply-To: <EF2F6572-3260-11D8-B7F9-000A95A072FC@sb.org>
References: <3FE32CA1.7070105@telefonica.net>
	<EF2F6572-3260-11D8-B7F9-000A95A072FC@sb.org>
Message-ID: <16355.25796.858212.742243@desk.crynwr.com>

Kevin Ballard writes:
 > What's your mptest.py look like?
 > 
 > Most likely, it's something like
 > 
 > from apache import *

Just as a matter of style, I think Guido (BDFL) discourages this sort
of thing.  For myself, even though it means more typing in the first
place, I prefer to see a plain import, and lots of foo., bar., and
baz. prefixes.  Lets the newbie (which I've been so very recently)
know which module the function is associated with.

-- 
--My blog is at angry-economist.russnelson.com  | 
Crynwr sells support for free software  | PGPok |  You can't spell Fiasco
521 Pleasant Valley Rd. | +1 315 268 1925 voice |  without SCO
Potsdam, NY 13676-3213  | +1 315 268 9201 FAX   | 
From dpopowich at mtrsd.k12.ma.us  Fri Dec 19 16:31:45 2003
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Fri Jan  9 21:48:01 2004
Subject: [mod_python] Sessions and problems with cookie path attribute
Message-ID: <16355.28225.866414.517954@gargle.gargle.HOWL>


I had a serious problem getting sessions to work with an app I'm
writing (modpython 3.1.2b, httpd-2.0.40, python 2.3.2) and after
browsing the archives I've seen others getting bitten by the same
problem...

Session ids are stored on the client as a cookie with name pysid.
This is fine and the cookie gets stored, but the path attribute can
get badly mangled by the code in Session.BaseSession.make_cookie(), in
particular, this section:

        if config.has_key("ApplicationPath"):
            c.path = config["ApplicationPath"]
        else:
            docroot = self._req.document_root()
            # the path where *Handler directive was specified
            dirpath = self._req.hlist.directory 
            c.path = dirpath[len(docroot):]

If you don't have AppliationPath set as a PythonOption and your
handler isn't in a <Directory> under DocumentRoot you're probably
going to have trouble.  Two scenarios hurt me:

  1.  using a handler inside a <Location>.  There is no path.  My
      browser (galeon 1.2.7) hung for infinity on reloads.  Never
      could figure out why.

  2.  using mod_python under UserDir directories.  I do this for
      prototyping because it's so easy to tweak a .htaccess file under
      a ~username/public_html subdirectory and you don't have to
      restart/reload apache to see your changes.  In this situation
      the length of DocumentRoot has no relationship to the URIs so
      the path attribute of the cookie gets oddly chopped at the
      head.  I kept getting new sessions because the browser wasn't
      sending the cookie because of paths not matching the uri.

I believe the same problem will occur under certain circumstances if
Alias directives affect mod_python usage although I haven't tested
this.

I think the ELSE clause above is trying to do something that can't be
done easily: extract the leading uri of the handler.  With Alias,
UserDir and Location directives, it's pretty difficult.  Is it
possible?  Perhaps the code shouldn't try to be so clever.  Default
the path to "/" unless the Session constructor overrides the value??

My temporary fix is to always explicitly use ApplicationPath.  Setting
it to "/" is certainly general enough for my prototyping.

Minimally, I think the documentation for Session should devote some
space to addressing and clarifying this issue.

------------------
Daniel Popowich
Network Specialist
-------------------------------------
Mohawk Trail Regional School District
24 Ashfield Rd.
Shelburne Falls, MA 01370
413.625.0192 x22
-------------------------------------

From kevin at sb.org  Fri Dec 19 19:31:59 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:48:01 2004
Subject: [mod_python] newbie
In-Reply-To: <16355.25796.858212.742243@desk.crynwr.com>
References: <3FE32CA1.7070105@telefonica.net>
	<EF2F6572-3260-11D8-B7F9-000A95A072FC@sb.org>
	<16355.25796.858212.742243@desk.crynwr.com>
Message-ID: <EC83DA6A-3283-11D8-B7F9-000A95A072FC@sb.org>

For the record, I meant to say

from mod_python import apache

because what I wrote wouldn't actually run.

And although I tend to agree with you in general, I still prefer 
importing apache from mod_python rather than just importing mod_python.

On Dec 19, 2003, at 3:51 PM, Russell Nelson wrote:

> Kevin Ballard writes:
>> What's your mptest.py look like?
>>
>> Most likely, it's something like
>>
>> from apache import *
>
> Just as a matter of style, I think Guido (BDFL) discourages this sort
> of thing.  For myself, even though it means more typing in the first
> place, I prefer to see a plain import, and lots of foo., bar., and
> baz. prefixes.  Lets the newbie (which I've been so very recently)
> know which module the function is associated with.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From grisha at modpython.org  Fri Dec 19 23:13:26 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:48:01 2004
Subject: [mod_python] newbie
In-Reply-To: <EC83DA6A-3283-11D8-B7F9-000A95A072FC@sb.org>
References: <3FE32CA1.7070105@telefonica.net>
	<EF2F6572-3260-11D8-B7F9-000A95A072FC@sb.org>
	<EC83DA6A-3283-11D8-B7F9-000A95A072FC@sb.org>
Message-ID: <20031219230940.K35608@onyx.ispol.com>


I think Russel was referring not to the "from" but to the "*" - I agree,
Python would probably be better if this "feature" did not exist at all,
because you don't know what the "*" has just imported.

Using "from" is just fine though :-)

On Fri, 19 Dec 2003, Kevin Ballard wrote:

> For the record, I meant to say
>
> from mod_python import apache
>
> because what I wrote wouldn't actually run.
>
> And although I tend to agree with you in general, I still prefer
> importing apache from mod_python rather than just importing mod_python.
>
> On Dec 19, 2003, at 3:51 PM, Russell Nelson wrote:
>
> > Kevin Ballard writes:
> >> What's your mptest.py look like?
> >>
> >> Most likely, it's something like
> >>
> >> from apache import *
> >
> > Just as a matter of style, I think Guido (BDFL) discourages this sort
> > of thing.  For myself, even though it means more typing in the first
> > place, I prefer to see a plain import, and lots of foo., bar., and
> > baz. prefixes.  Lets the newbie (which I've been so very recently)
> > know which module the function is associated with.
>
> --
> Kevin Ballard
> kevin@sb.org
> http://www.tildesoft.com
> http://kevin.sb.org
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From fccoelho at fiocruz.br  Mon Dec 22 10:28:16 2003
From: fccoelho at fiocruz.br (Flavio C. Coelho)
Date: Fri Jan  9 21:48:01 2004
Subject: [mod_python] mod_python and the semaphore bug
In-Reply-To: <8794402.1071700631675.JavaMail.jciccale@mac.com>
References: <8794402.1071700631675.JavaMail.jciccale@mac.com>
Message-ID: <1072096096.2609.6.camel@pinguim.procc.fiocruz.br>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: fiocruz4.jpg
Type: image/jpeg
Size: 3085 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20031222/4d0595d6/fiocruz4.jpg
From jciccale at mac.com  Mon Dec 22 14:42:56 2003
From: jciccale at mac.com (Julian Ciccale)
Date: Fri Jan  9 21:48:01 2004
Subject: [mod_python] mod_python and the semaphore bug
Message-ID: <8134803.1072100576603.JavaMail.jciccale@mac.com>

The message on error_log is fine, apache uses it also to output "NOTICE" messages.
What is that doesn't work now? 

 
On Monday, December 22, 2003, at 01:28PM, Flavio C. Coelho <fccoelho@fiocruz.br> wrote:

>
><<Original Attached>>
From dpopowich at mtrsd.k12.ma.us  Mon Dec 22 11:02:45 2003
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Fri Jan  9 21:48:01 2004
Subject: [mod_python] Sessions and problems with cookie path attribute
In-Reply-To: <16355.28225.866414.517954@gargle.gargle.HOWL>
References: <16355.28225.866414.517954@gargle.gargle.HOWL>
Message-ID: <16359.5542.430.748017@gargle.gargle.HOWL>


> I had a serious problem getting sessions to work with an app I'm
> writing (modpython 3.1.2b, httpd-2.0.40, python 2.3.2) and after
> browsing the archives I've seen others getting bitten by the same
> problem...
> 
> Session ids are stored on the client as a cookie with name pysid.
> This is fine and the cookie gets stored, but the path attribute can
> get badly mangled by the code in Session.BaseSession.make_cookie(), in
> particular, this section:
> 
>         if config.has_key("ApplicationPath"):
>             c.path = config["ApplicationPath"]
>         else:
>             docroot = self._req.document_root()
>             # the path where *Handler directive was specified
>             dirpath = self._req.hlist.directory 
>             c.path = dirpath[len(docroot):]
> 
> If you don't have AppliationPath set as a PythonOption and your
> handler isn't in a <Directory> under DocumentRoot you're probably
> going to have trouble.  Two scenarios hurt me:
> 
>   1.  using a handler inside a <Location>.  There is no path.  My
>       browser (galeon 1.2.7) hung for infinity on reloads.  Never
>       could figure out why.
> 
>   2.  using mod_python under UserDir directories.  I do this for
>       prototyping because it's so easy to tweak a .htaccess file under
>       a ~username/public_html subdirectory and you don't have to
>       restart/reload apache to see your changes.  In this situation
>       the length of DocumentRoot has no relationship to the URIs so
>       the path attribute of the cookie gets oddly chopped at the
>       head.  I kept getting new sessions because the browser wasn't
>       sending the cookie because of paths not matching the uri.
> 
> I believe the same problem will occur under certain circumstances if
> Alias directives affect mod_python usage although I haven't tested
> this.
> 
> I think the ELSE clause above is trying to do something that can't be
> done easily: extract the leading uri of the handler.  With Alias,
> UserDir and Location directives, it's pretty difficult.  Is it
> possible?  Perhaps the code shouldn't try to be so clever.  Default
> the path to "/" unless the Session constructor overrides the value??
> 
> My temporary fix is to always explicitly use ApplicationPath.  Setting
> it to "/" is certainly general enough for my prototyping.
> 
> Minimally, I think the documentation for Session should devote some
> space to addressing and clarifying this issue.

I need to correct myself.  The problem does not occur inside
<Location> directives (the hanging problem I referred to was a bug in
my application: my session instance was not being garbage collected).
In fact, when using Sessions inside <Location> URIs no path attribute
is specified in the Cookie, so it is ALWAYS sent back to the server.

However, I have confirmed that this problem exists for uses of Session
within handlers referenced via Alias directives.

In summary, if you use Sessions in handlers referenced via UserDir or
Alias directives you have to use "PythonOption ApplicationPath ..." in
your config.

------------------
Daniel Popowich
Network Specialist
-------------------------------------
Mohawk Trail Regional School District
24 Ashfield Rd.
Shelburne Falls, MA 01370
413.625.0192 x22
-------------------------------------

From theman at eradman.com  Mon Dec 22 11:16:46 2003
From: theman at eradman.com (Eric Radman)
Date: Fri Jan  9 21:48:01 2004
Subject: [mod_python] mod_* performance
Message-ID: <1072091806.2521.68.camel@inspiration.x.eradman.com>

Guys,

I had been blaming bad performance with concurrent connections on
mod_python, when in fact an Apache config change can make all the
difference. The key is to limit the number of Apache processes based on
the RAM and average concurrency load that you have.

I found the mod_perl suffers from the same performance characteristics
becuase it's Apache behavior that impacts the performance on
simultinious connections, not mod_python or mod_perl.

I changed the MaxClients parameter in apache2.conf from 50 to 8:

<IfModule prefork.c>
StartServers         1
MinSpareServers      1
MaxSpareServers     10
MaxClients           8
MaxRequestsPerChild  0
</IfModule>

7k mod_python page with SQL caching:

Reqests  Concurrency   Req/Sec  Connect Time
400      1             136.54   7.324
400      5             131.29   38.085
400      15            126.28   118.780
400      50            96.73    516.883 
400      100           71.92    1390.431

To quote Stas Bekman <stas at stason.org>
"""
MinSpareServers, MaxSpareServers and StartServers are only important for
user response times. Sometimes users will have to wait a bit.

The important parameters are MaxClients and MaxRequestsPerChild.
MaxClients should be not too big, so it will not abuse your machine's
memory resources, and not too small, for if it is your users will be
forced to wait for the children to become free to serve them.
MaxRequestsPerChild should be as large as possible, to get the full
benefit of mod_perl, but watch your server at the beginning to make sure
your scripts are not leaking memory, thereby causing your server (and
your service) to die very fast.
"""

7k PHP page with standard connection pooling:

Reqests  Concurrency   Req/Sec  Connect Time
400      1             29.60    33.785
400      5             15.32    65.291
400      15            23.13    43.242
400      50            21.45    2656.869
400      100           23.21    4308.698

What we see here is that connect time (which translates into perceived
latency) really suffers in PHP when you hit it with a large number of
concurrent connections.

This one little tweak makes mod_perl and mod_python immune to http DOS
attacks. With the poper coding an increase of 300%-350% is possible over
PHP.

Eric Radman
From theman at eradman.com  Mon Dec 22 11:22:10 2003
From: theman at eradman.com (Eric Radman)
Date: Fri Jan  9 21:48:01 2004
Subject: [mod_python] 
Message-ID: <1072092130.4080.2.camel@inspiration.x.eradman.com>



From michael at dynamine.net  Mon Dec 22 08:34:26 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 21:48:01 2004
Subject: [mod_python] mod_* performance
In-Reply-To: <1072091806.2521.68.camel@inspiration.x.eradman.com>
References: <1072091806.2521.68.camel@inspiration.x.eradman.com>
Message-ID: <3FE71D12.6030802@dynamine.net>

Eric Radman wrote:

> This one little tweak makes mod_perl and mod_python immune to http DOS
> attacks. With the poper coding an increase of 300%-350% is possible over
> PHP.

I think that in order to reach a believable conclusion one really needs 
to run such benchmarks with the Zend Accelerator for PHP; it yields a 
performance improvement of nearly an order of magnitude.

Best,

--Michael
From neel at mediapulse.com  Mon Dec 22 11:44:42 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:48:01 2004
Subject: [mod_python] Changing the status code with custom content
Message-ID: <C0FC22C08B82074A88B500617641577787A7F0@johnson.mediapulse.net>

I'm having trouble using mod_python to change the status code and have
custom content in the error message.  If I return something other than
apache.OK in my handler, the status line is set correctly set but apache
returns the default error page.  If I have sent custom content for the
error message, the apache error message is added to the end of the
document.  I can get around this by using an ErrorDocument directive in
apache's conf, but I loose access to the traceback of the error and thus
the ability to have a really custom error message.

At first glance this didn't seem to matter.  As long as the content said
error, the user knew of the problem, even if the status was 200 OK.
However I've found out now with search bots this does matter - they
don't know that they have a bad url for the site and are indexing error
pages thinking they are legit.

Any thoughts on what I may be over looking?

Thanks,
Mike

From dpopowich at mtrsd.k12.ma.us  Mon Dec 22 11:44:30 2003
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Fri Jan  9 21:48:01 2004
Subject: [mod_python] redirects and url rewriting
Message-ID: <16359.8046.124675.498918@gargle.gargle.HOWL>


When I use req.internal_redirect(some_uri) sometimes the url in my
browser gets rewritten to reflect some_uri and some times it doesn't,
remaining as the uri of the originally selected page.  This can cause
numerous problems with relative links inside a page if the url is not
rewritten in the browser.

I'm trying to understand what causes this and how I can control it.
Can someone point me to some doc?

Below is a short handler I wrote as an example (the links I use assume
you have the apache manual installed; modify if necessary).

[modpython 3.1.2b, python 2.3.2, apache 2.0.40]

Thanks,

------------------
Daniel Popowich
Network Specialist
-------------------------------------
Mohawk Trail Regional School District
24 Ashfield Rd.
Shelburne Falls, MA 01370
413.625.0192 x22
-------------------------------------

# -*- python -*-

from mod_python import apache, util

def handler(req):

    req.content_type = 'text/html'

    form = util.FieldStorage(req)
    choice = form.getfirst('redirect')
    # this doesn't rewrite the url in the browser
    if choice == '1':
        req.internal_redirect('%s/abcdefg' % req.uri)
        
    # neither does this one [and the resulting page is quite
    # messed up because the relative urls inside the doc don't
    # make sense without the rewrite]
    elif choice == '2':
        req.internal_redirect('/manual/index.html')

    # but this one does
    elif choice == '3':
        req.internal_redirect('/manual')

    else:
        req.write('''
        <html>
        <body>
        <a href=%s?redirect=1>redirect to %s/abcdefg</a><br>
        <a href=%s?redirect=2>redirect to /manual/index.html</a><br>
        <a href=%s?redirect=3>redirect to /manual</a><br>
        </body>
        </html>
        ''' % ((req.uri,)*4))


    return apache.OK

From jciccale at mac.com  Mon Dec 22 18:10:54 2003
From: jciccale at mac.com (Julian Ciccale)
Date: Fri Jan  9 21:48:01 2004
Subject: [mod_python] redirects and url rewriting
Message-ID: <1006403.1072113054814.JavaMail.jciccale@mac.com>

I think the best option for your problem is:

req.headers_out[ "Location" ] = uri
return apache.HTTP_MOVED_PERMANENTLY #301 

- julcicc - 
 
On Monday, December 22, 2003, at 05:44PM, Daniel J. Popowich <dpopowich@mtrsd.k12.ma.us> wrote:

>
>When I use req.internal_redirect(some_uri) sometimes the url in my
>browser gets rewritten to reflect some_uri and some times it doesn't,
>remaining as the uri of the originally selected page.  This can cause
>numerous problems with relative links inside a page if the url is not
>rewritten in the browser.
>
>I'm trying to understand what causes this and how I can control it.
>Can someone point me to some doc?
>
>Below is a short handler I wrote as an example (the links I use assume
>you have the apache manual installed; modify if necessary).
>
>[modpython 3.1.2b, python 2.3.2, apache 2.0.40]
>
>Thanks,
>
>------------------
>Daniel Popowich
>Network Specialist
>-------------------------------------
>Mohawk Trail Regional School District
>24 Ashfield Rd.
>Shelburne Falls, MA 01370
>413.625.0192 x22
>-------------------------------------
>
># -*- python -*-
>
>from mod_python import apache, util
>
>def handler(req):
>
>    req.content_type = 'text/html'
>
>    form = util.FieldStorage(req)
>    choice = form.getfirst('redirect')
>    # this doesn't rewrite the url in the browser
>    if choice == '1':
>        req.internal_redirect('%s/abcdefg' % req.uri)
>        
>    # neither does this one [and the resulting page is quite
>    # messed up because the relative urls inside the doc don't
>    # make sense without the rewrite]
>    elif choice == '2':
>        req.internal_redirect('/manual/index.html')
>
>    # but this one does
>    elif choice == '3':
>        req.internal_redirect('/manual')
>
>    else:
>        req.write('''
>        <html>
>        <body>
>        <a href=%s?redirect=1>redirect to %s/abcdefg</a><br>
>        <a href=%s?redirect=2>redirect to /manual/index.html</a><br>
>        <a href=%s?redirect=3>redirect to /manual</a><br>
>        </body>
>        </html>
>        ''' % ((req.uri,)*4))
>
>
>    return apache.OK
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
From dpopowich at mtrsd.k12.ma.us  Mon Dec 22 12:34:09 2003
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Fri Jan  9 21:48:01 2004
Subject: [mod_python] redirects and url rewriting
In-Reply-To: <1006403.1072113054814.JavaMail.jciccale@mac.com>
References: <1006403.1072113054814.JavaMail.jciccale@mac.com>
Message-ID: <16359.11025.459664.120166@gargle.gargle.HOWL>



> I think the best option for your problem is:
> 
> req.headers_out[ "Location" ] = uri
> return apache.HTTP_MOVED_PERMANENTLY #301 
> 

This won't work for some of what I'm doing, i.e., user goes to a page
that needs authentication so they are redirected to a login page
(without having to save state to a session).  There are other similar
situations where, programmatically, you discover that the user should
be somewhere else within your mod_python app and you'd like to
redirect them to other URIs which can check req.prev for existing
state (thus saving network traffic, server hits, etc.  Heck, you got
everything you need to know, why tell the client, "go here" when you
can just deliver it in the first place?).

Also, being the kind of geek that needs to know how and why things
work, I'd like to know why some redirects rewrite my browser url and
some don't; ultimately, I'd like to be able to control the behaviour
with mod_python.

Dan

> >
> >When I use req.internal_redirect(some_uri) sometimes the url in my
> >browser gets rewritten to reflect some_uri and some times it doesn't,
> >remaining as the uri of the originally selected page.  This can cause
> >numerous problems with relative links inside a page if the url is not
> >rewritten in the browser.
> >
> >I'm trying to understand what causes this and how I can control it.
> >Can someone point me to some doc?
> >
> >Below is a short handler I wrote as an example (the links I use assume
> >you have the apache manual installed; modify if necessary).
> >
> >[modpython 3.1.2b, python 2.3.2, apache 2.0.40]
> >
> >Thanks,
> >
> >------------------
> >Daniel Popowich
> >Network Specialist
> >-------------------------------------
> >Mohawk Trail Regional School District
> >24 Ashfield Rd.
> >Shelburne Falls, MA 01370
> >413.625.0192 x22
> >-------------------------------------
> >
> ># -*- python -*-
> >
> >from mod_python import apache, util
> >
> >def handler(req):
> >
> >    req.content_type = 'text/html'
> >
> >    form = util.FieldStorage(req)
> >    choice = form.getfirst('redirect')
> >    # this doesn't rewrite the url in the browser
> >    if choice == '1':
> >        req.internal_redirect('%s/abcdefg' % req.uri)
> >        
> >    # neither does this one [and the resulting page is quite
> >    # messed up because the relative urls inside the doc don't
> >    # make sense without the rewrite]
> >    elif choice == '2':
> >        req.internal_redirect('/manual/index.html')
> >
> >    # but this one does
> >    elif choice == '3':
> >        req.internal_redirect('/manual')
> >
> >    else:
> >        req.write('''
> >        <html>
> >        <body>
> >        <a href=%s?redirect=1>redirect to %s/abcdefg</a><br>
> >        <a href=%s?redirect=2>redirect to /manual/index.html</a><br>
> >        <a href=%s?redirect=3>redirect to /manual</a><br>
> >        </body>
> >        </html>
> >        ''' % ((req.uri,)*4))
> >
> >
> >    return apache.OK
> >
> >_______________________________________________
> >Mod_python mailing list
> >Mod_python@modpython.org
> >http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> >

From michael at dynamine.net  Mon Dec 22 11:34:16 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 21:48:01 2004
Subject: [mod_python] redirects and url rewriting
In-Reply-To: <16359.11025.459664.120166@gargle.gargle.HOWL>
References: <1006403.1072113054814.JavaMail.jciccale@mac.com>
	<16359.11025.459664.120166@gargle.gargle.HOWL>
Message-ID: <3FE74738.4090706@dynamine.net>

Daniel J. Popowich wrote:

> 
>>I think the best option for your problem is:
>>
>>req.headers_out[ "Location" ] = uri
>>return apache.HTTP_MOVED_PERMANENTLY #301 
>>
> 
> 
> This won't work for some of what I'm doing, i.e., user goes to a page
> that needs authentication so they are redirected to a login page
> (without having to save state to a session).  There are other similar
> situations where, programmatically, you discover that the user should
> be somewhere else within your mod_python app and you'd like to
> redirect them to other URIs which can check req.prev for existing
> state (thus saving network traffic, server hits, etc.  Heck, you got
> everything you need to know, why tell the client, "go here" when you
> can just deliver it in the first place?).
> 
> Also, being the kind of geek that needs to know how and why things
> work, I'd like to know why some redirects rewrite my browser url and
> some don't; ultimately, I'd like to be able to control the behaviour
> with mod_python.

I don't know why mod_python is behaving in the manner you describe, but 
I can tell you that a clear understanding of the HTTP protocol is needed 
here.

Browsers determine what to display in the address bar based on two 
things only: (1) the URL requested by a user (bookmark, address bar or 
some other UI mechanism), or (2) an HTTP Redirect: header returned by 
the server.

Without either of those, there is no way for the browser to know that 
the page requested at /foo/bar can be found in the future at /baz/quux.

--Michael
From kevin at sb.org  Mon Dec 22 14:47:08 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:48:01 2004
Subject: [mod_python] redirects and url rewriting
In-Reply-To: <16359.11025.459664.120166@gargle.gargle.HOWL>
References: <1006403.1072113054814.JavaMail.jciccale@mac.com>
	<16359.11025.459664.120166@gargle.gargle.HOWL>
Message-ID: <A0BDA434-34B7-11D8-B640-000A95A072FC@sb.org>

I meant to send this to the list, but I accidentally sent it to Daniel 
Popowich instead.

-----

Well, I just did a curl on http://localhost/manual and these were the 
headers I got:

HTTP/1.1 301 Moved Permanently
Date: Mon, 22 Dec 2003 17:53:24 GMT
Server: Apache/2.0.48 (Unix) DAV/2 mod_python/3.0.4 Python/2.3
Location: http://localhost/manual/
Content-Length: 341
Content-Type: text/html; charset=iso-8859-1

Does that explain it well enough for you?

On Dec 22, 2003, at 12:34 PM, Daniel J. Popowich wrote:

> Also, being the kind of geek that needs to know how and why things
> work, I'd like to know why some redirects rewrite my browser url and
> some don't; ultimately, I'd like to be able to control the behaviour
> with mod_python.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From michael at dynamine.net  Mon Dec 22 11:50:27 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 21:48:01 2004
Subject: [mod_python] redirects and url rewriting
In-Reply-To: <3FE74738.4090706@dynamine.net>
References: <1006403.1072113054814.JavaMail.jciccale@mac.com>
	<16359.11025.459664.120166@gargle.gargle.HOWL> <3FE74738.4090706@dynamine.net>
Message-ID: <3FE74B03.70506@dynamine.net>

I wrote:

> Browsers determine what to display in the address bar based on two 
> things only: (1) the URL requested by a user (bookmark, address bar or 
> some other UI mechanism), or (2) an HTTP Redirect: header returned by 
> the server.

That should be an HTTP Location: header combined with a 301/302 HTTP 
response code.

--Michael
From dpopowich at mtrsd.k12.ma.us  Mon Dec 22 15:36:01 2003
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Fri Jan  9 21:48:01 2004
Subject: [mod_python] redirects and url rewriting
In-Reply-To: <3FE74B03.70506@dynamine.net>
References: <1006403.1072113054814.JavaMail.jciccale@mac.com>
	<16359.11025.459664.120166@gargle.gargle.HOWL>
	<3FE74738.4090706@dynamine.net>
	<3FE74B03.70506@dynamine.net>
Message-ID: <16359.21937.84003.871912@gargle.gargle.HOWL>


Michael S. Fischer writes:
> I wrote:
> 
> > Browsers determine what to display in the address bar based on two 
> > things only: (1) the URL requested by a user (bookmark, address bar or 
> > some other UI mechanism), or (2) an HTTP Redirect: header returned by 
> > the server.
> 

Yes, of course.  Duh.  I now think I understand what's going on:

  1. A call to req.internal_redirect(uri) will return the content of
     the uri as the address the user asked for UNLESS the HTTP
     Location header is sent.  This is what I had been originally
     expecting until the redirect to certain urls (like
     http://localhost/manual) changed in my browser's address bar.
     Confusion insued until Kevin Ballard replied with clues that...

  2. ...apache, when receiving requests that are directories (or
     aliases/symlinks to directories) without the trailing slash,
     actually sends a 301 response.  So, a request like
     http://host/foo will generate a 301 response if foo is a
     directory and send a "Location: http://host/foo/" header.  I was
     first shocked by this (think of all the extra bytes flooding the
     'net because of this!!), but understand it's the only way within
     the protocol to make relative links work.  (Although it begs the
     question why the protocol doesn't have a Real-Location header, or
     some such, to let the browser know what the real url for the
     requested page should be without having to go fetch it.)

Sound right?

Knowing now what I can expect consistantly (and knowing it's not for
lack of understanding mod_python subtleties) and can continue with my
app design.  Thanks for all your help!

Dan


From neel at mediapulse.com  Mon Dec 22 16:37:52 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:48:01 2004
Subject: [mod_python] redirects and url rewriting
Message-ID: <C0FC22C08B82074A88B500617641577787A7F1@johnson.mediapulse.net>

>      directory and send a "Location: http://host/foo/" header.  I was
>      first shocked by this (think of all the extra bytes flooding the
>      'net because of this!!), but understand it's the only way within
>      the protocol to make relative links work.  (Although it begs the
>      question why the protocol doesn't have a Real-Location header, or
>      some such, to let the browser know what the real url for the
>      requested page should be without having to go fetch it.)

A 301 status is Moved Permanently, so that is your "Real-Location"
header.  In an ideal world browsers would update (or prompt to update)
bookmarks on such a status, but it looks like that's not going to
happen.

A 302 is Moved Temporarily, for when you wouldn't want a browser to
update it info, however given the way browsers ignore RFC's and W3C it
wouldn't surprise me to find out browser x didn't handle a 302
correctly.

I wonder how many browsers would know what to do with a 203,
Non-Authoritative Information - which is sorta like a DNS query that's
cached...

Mike

From jalil at securia.com  Mon Dec 22 15:27:02 2003
From: jalil at securia.com (Jalil Feghhi)
Date: Fri Jan  9 21:48:01 2004
Subject: [mod_python] FW: Any way to embed Python in HTML?
Message-ID: <004201c3c8e3$1acc16a0$6502a8c0@securia.com>

 
I am new to mod_python and haven't seen any examples where you can put
python code in HTML pages. Is this not supported? If not supported, is
there any way or work around (other than using the request write method)
to separate HTML writing from coding?
 
Thanks,
 
-Jalil
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20031222/0f54ce49/attachment.htm
From jalil at securia.com  Mon Dec 22 15:49:53 2003
From: jalil at securia.com (Jalil Feghhi)
Date: Fri Jan  9 21:48:01 2004
Subject: [mod_python] Problem keeing the db connection open
Message-ID: <005201c3c8e6$4c073580$6502a8c0@securia.com>

I found the following code on the Internet for keeping the connection
open but it doesn't really work. Everytime I try to login, it connects
to the database. I put some log messges and I can see this happens.

1. Could someone tell me how I can keep the connection open? 

2.  I appreciate if someone explain how mod_python handler is called
when there are many requests? Does Apache create threads for each
request? And how the global database connection is used?

Thanks,

-Jalil

Here is the code:

HOST = "localhost"

DB = "mydb"

USER = "user"

PASS = "pwd"

import MySQLdb

import string

def _db_login(relogin = 0):


    global DB_CONN

    if relogin:

        DB_CONN = MySQLdb.connect(db=DB, user=USER, passwd=PASS)

        return DB_CONN

    else:

        try:

            d = DB_CONN

            return d

        except NameError:

            DB_CONN = MySQLdb.connect(host= HOST, db=DB, user=USER,
passwd=PASS)

            return DB_CONN

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20031222/bad48455/attachment.htm
From grisha at modpython.org  Mon Dec 22 19:42:38 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:48:01 2004
Subject: [mod_python] Changing the status code with custom content
In-Reply-To: <C0FC22C08B82074A88B500617641577787A7F0@johnson.mediapulse.net>
References: <C0FC22C08B82074A88B500617641577787A7F0@johnson.mediapulse.net>
Message-ID: <20031222193816.N83390@onyx.ispol.com>


I believe you should req.write() your error page, set req.status to the
the error code you want and return apache.OK. If you retrun anything other
then apache.OK, then Apache assumes you want it to send its own stock
error page.

(Hope this answers your question, I'm a bit woozy on nuquil right now....)

Grisha

On Mon, 22 Dec 2003, Michael C. Neel wrote:

> I'm having trouble using mod_python to change the status code and have
> custom content in the error message.  If I return something other than
> apache.OK in my handler, the status line is set correctly set but apache
> returns the default error page.  If I have sent custom content for the
> error message, the apache error message is added to the end of the
> document.  I can get around this by using an ErrorDocument directive in
> apache's conf, but I loose access to the traceback of the error and thus
> the ability to have a really custom error message.
>
> At first glance this didn't seem to matter.  As long as the content said
> error, the user knew of the problem, even if the status was 200 OK.
> However I've found out now with search bots this does matter - they
> don't know that they have a bad url for the site and are indexing error
> pages thinking they are legit.
>
> Any thoughts on what I may be over looking?
>
> Thanks,
> Mike
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From dpopowich at mtrsd.k12.ma.us  Mon Dec 22 19:55:13 2003
From: dpopowich at mtrsd.k12.ma.us (Daniel Popowich)
Date: Fri Jan  9 21:48:01 2004
Subject: [mod_python] redirects and url rewriting
In-Reply-To: <C0FC22C08B82074A88B500617641577787A7F1@johnson.mediapulse.net>
References: <C0FC22C08B82074A88B500617641577787A7F1@johnson.mediapulse.net>
Message-ID: <33585.24.91.183.76.1072140913.squirrel@www.mtrsd.k12.ma.us>

>>      directory and send a "Location: http://host/foo/" header.  I was
>>      first shocked by this (think of all the extra bytes flooding the
>>      'net because of this!!), but understand it's the only way within
>>      the protocol to make relative links work.  (Although it begs the
>>      question why the protocol doesn't have a Real-Location header, or
>>      some such, to let the browser know what the real url for the
>>      requested page should be without having to go fetch it.)
>
> A 301 status is Moved Permanently, so that is your "Real-Location"
> header.  In an ideal world browsers would update (or prompt to update)
> bookmarks on such a status, but it looks like that's not going to
> happen.

I wasn't very clear.  For pages that have moved or for pages that haven't
moved but aren't in proper form (like my example, http://host/foo ->
http://host/foo/) on the SAME server, it seems unfortunate that the
servers can't return the page along with some header indicating that fact.

For example, why can't a request for http://host/foo return
http://host/foo/index.html with a header

  Real-Location: http://host/foo/

instead of returning a 30[12] with a Location header only to have the
browser go back to the same server.  Seems wasteful.

The 30[12] with Location header makes perfect sense for pages moved
to different servers.

Dan


From alunchampion at btconnect.com  Mon Dec 22 21:57:55 2003
From: alunchampion at btconnect.com (Alun)
Date: Fri Jan  9 21:48:01 2004
Subject: [mod_python] mod_python disables mod_dav
Message-ID: <200312230157.hBN1vW1B092956@slash.mediapulse.com>

I seem to have a problem adding mod_python to an existing configuration with
mod_dav.
I have mod_dav enabled and working and planned on integrating mod_python but
when I *only* add the LoadModule mod_python directive to the httpd.conf,
WebDAV no longer works and I get a 405 status returned.

Any help would be appreciated.

Checking OPTIONS on the URL before and after adding LoadModule gives:

=====Before====
OPTIONS /author/ http/1.1
Host: localhost:80

HTTP/1.1 200 OK
Date: Mon, 22 Dec 2003 21:47:46 GMT
Server: Apache/2.0.48 (Win32) mod_jk2/2.0.2 DAV/2
DAV: 1,2
MS-Author-Via: DAV
Allow:
OPTIONS,GET,HEAD,POST,DELETE,TRACE,PROPFIND,PROPPATCH,COPY,MOVE,LOCK,UNLOCK
Content-Length: 0
Content-Type: httpd/unix-directory

=====After LoadModule mod_python modules/mod_python.so=====
OPTIONS /author/ http:/1.1
Host: localhost:80

HTTP/1.1 200 OK
Date: Mon, 22 Dec 2003 21:28:47 GMT
Server: Apache/2.0.48 (Win32) mod_jk2/2.0.2 mod_python/3.1.2b Python/2.3.2
DAV/2

Allow: GET,HEAD,POST,OPTIONS,TRACE     <======== No DAV commands.
Content-Length: 0
Connection: close
Content-Type: httpd/unix-directory

From stian at soiland.no  Tue Dec 23 02:45:36 2003
From: stian at soiland.no (Stian =?iso-8859-1?Q?S=F8iland?=)
Date: Fri Jan  9 21:48:02 2004
Subject: [mod_python] Re: FW: Any way to embed Python in HTML?
In-Reply-To: <004201c3c8e3$1acc16a0$6502a8c0@securia.com>
References: <004201c3c8e3$1acc16a0$6502a8c0@securia.com>
Message-ID: <20031223014536.GB16301@itea.ntnu.no>

On 2003-12-23 00:27:02, Jalil Feghhi wrote:

> I am new to mod_python and haven't seen any examples where you can put
> python code in HTML pages. Is this not supported? If not supported, is
> there any way or work around (other than using the request write method)
> to separate HTML writing from coding?

Take a look at upcoming PSP from Mod-python 3.1.2b:

http://www.modpython.org/live/mod_python-3.1.2b/doc-html/pyapi-psp.html



I've also experienced some success with using template engines like
Cheetah combined with mod_python.

This is how we've done things using cheetah and mod_python's
Publisher-handler:


Made a general page template MainTemplate.tmpl:

    #attr title = "Default title"
    <html>
      <head>
        <title>$title</title>
      </head>
      <body>
        <h1>$title</h1>
        <div class="menu">
          menu blabla
          (details left out)
        </div>  
        <div class="content">
    #def content    
            No content here yet, this is just
            the base template
    #end def
    $content()
        </div>


Here's a specialized page template WelcomeTemplate.tmpl

    #extends MainTemplate
    #def content
            Welcome to our world. Blablabla
            blablabla.
    #end def     
 

These template-files are compiled with cheetah-compile - which produces
a rather nasty .py-file. This file could be imported and used from
Python.

In .htaccess:

    SetHandler mod_python
    PythonHandler mod_python.publisher


in welcome.py:

    from WelcomeTemplate import WelcomeTemplate 
    def index(req):
        templ = WelcomeTemplate()
        templ.title = "Welcome, my friend"
        return templ


Blocks made within templates (the #def's) are callable methods from
within Python, and therefore templates could be used for smaller building
blocks as well.  templ.content could be changed to any other template,
or even a python function defined somewhere else.


Model view controller
=====================

In our current ongoing project, Cerebrum, we've succeeded in seperating
content from control, and even seperating the model from control. This
is the old MVC (model-view-controller) principle as we've used it:

       model          controller                  view
  business logic      web logic             presentation logic
  (what to do)      (what to show)             (how to view)

 python classes     python classes           cheetah templates
 representing the   for web access, ie.      with calls to other
 data, methods      each method accessed     templates and
 for operations     from the browser.        helper classes in
                    Performs operations on   python
                    model and views by
                    calling cheetah 
                    templates. 
 

Example:
========
code is simplified, and never tested in simplified form. It will
probably not work directly. The real code can be viewed on 
http://cvs.sourceforge.net/viewcvs.py/cerebrum/cerebrum/ under the
directories Cerebrum/client and web/ - note however
that the code is constantly changing at this part of the web project.


Model - Cerebrum/client/BofhModel.py
------------------------------------


class Entity:
    def __init__(self, server):
        # xmlrpc-connection
        self.server = server

    def fetch_by_id(cls, server, id):
        # make a new instance of the called-on class,
        # ie. a Group or Entity
        entity = cls(server)
        entity.load_entity_info(id)
        return entity
    fetch_by_id = classmethod(fetch_by_id)

    def load_entity_info(self, id):
        self.id = id
        info = self.server.entity_info(id)
        self.type = info['type']
        return info

class Group(Entity):
    def load_entity_info(self, id):
        info = Entity.load_entity_info(self, id)
        self.name = info['name']
        self.description = info['description']
        return info
    

View - web/lib/cereweb/templates/GroupViewTemplate.tmpl
--------------------------------------------------------

## Be international, import function gettext() as _()
#from gettext import gettext as _
#def viewGroup(group)
    <h1>$_("Group") $group.name</h1>
    $groupInfo($group)
#end def

#def groupInfo(group)
    <div class="info">
    <dl>
        <dt>$_("Name")</dt>
        <dd>$group.name</dd>
        <dt>$_("Description")</dt>
        <dd>$group.description</dd>
    </dl>
    </div>
#end def

MainTemplate.tmpl almost like shown in previous text.


Controller - htdocs/group.py
----------------------------

from Cerebrum.web.templates.MainTemplate import MainTemplate
from Cerebrum.web.templates.GroupViewTemplate import GroupViewTemplate
from Cerebrum.client import BofhModel

def view(req, id):
    # Get a generic view (menu, header, footer)
    page = MainTemplate()
    # the session and the xmlrpc server connection has been prepared by
    # a handler in .htaccess
    server = req.session['server']
    # get the object from the model   
    group = BofhModel.Group.fetch_by_id(server, id)
    # prepare the specialiced view
    view = GroupViewTemplate()
    # pass the model to the view 
    page.content = view.viewGroup(group)
    # and return the final result (within the MainTemplate)
    # to the browser
    return page
    

Notice how the controller is rather small and only glues together the view
and the model. In this example, the model is just an xmlrpc abstraction,
so even the business logic is hidden.  In this case the controller
actually uses two views, both MainTemplate (the menu, footer, etc.) and
GroupViewTemplate.  The reason for not subclassing MainTemplate into
GroupViewTemplate is that we needed to pass on the chosen group object
(from the Model), and that a groupview could be usable from within other
views as well. 


-- 
Stian S?iland               Work toward win-win situation. Win-lose
Trondheim, Norway           is where you win and the other lose.
http://www.soiland.no/      Lose-lose and lose-win are left as an
                            exercise to the reader.  [Limoncelli/Hogan]

From gnb at itga.com.au  Tue Dec 23 13:07:07 2003
From: gnb at itga.com.au (Gregory Bond)
Date: Fri Jan  9 21:48:02 2004
Subject: [mod_python] FW: Any way to embed Python in HTML? 
In-Reply-To: Your message of Mon, 22 Dec 2003 15:27:02 -0800.
Message-ID: <200312230207.NAA06930@lightning.itga.com.au>

You could consider Albatross, which has a nice Model/Controller/View paradigm, 
and does HTML templating (and session handling and heaps of other stuff).

http://www.object-craft.com.au/projects/albatross/


From stephen at vermeulen.ca  Mon Dec 22 19:41:15 2003
From: stephen at vermeulen.ca (Stephen Vermeulen)
Date: Fri Jan  9 21:48:02 2004
Subject: [mod_python] FW: Any way to embed Python in HTML?
In-Reply-To: <004201c3c8e3$1acc16a0$6502a8c0@securia.com>
References: <004201c3c8e3$1acc16a0$6502a8c0@securia.com>
Message-ID: <3FE7AB4B.9020107@vermeulen.ca>

Jalil Feghhi wrote:

>  
> I am new to mod_python and haven't seen any examples where you can put 
> python code in HTML pages. Is this not supported?

While working with mod_python 3.03 I did something along these lines, 
which I consider to be a rather
evil hack (this was done on some "for internal use only" pages). I used 
python's pickle module to serialize up some
objects, then base64 encoded them into ASCII form, and then placed the 
resulting text into hidden form fields
on the page that was served up. This allowed me to pass some complex 
state information (that was expensive to
generate, and was also generated by a different program at an earlier 
time) relating to the page that the user
was editing into the mod_python code that did the editing.


> If not supported, is there any way or work around (other than using 
> the request write method) to separate HTML writing from coding?
>  
> Thanks,
>  
> -Jalil

Regards,

Stephen


From gdamjan at mail.net.mk  Tue Dec 23 03:47:22 2003
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 21:48:02 2004
Subject: [mod_python] mod_python disables mod_dav
In-Reply-To: <200312230157.hBN1vW1B092956@slash.mediapulse.com>
References: <200312230157.hBN1vW1B092956@slash.mediapulse.com>
Message-ID: <20031223024722.GA18811@legolas.on.net.mk>

> I seem to have a problem adding mod_python to an existing configuration with
> mod_dav.
> I have mod_dav enabled and working and planned on integrating mod_python but
> when I *only* add the LoadModule mod_python directive to the httpd.conf,
> WebDAV no longer works and I get a 405 status returned.
> 
> Any help would be appreciated.

Quick workaround, put the "LoadModule mod_python" directive above the 
"LoadModule mod_dav" directive - apache will execute the modules
bottom-to-top - that way mod_dav will be first to execute.





-- 
Damjan Georgievski
jabberID: damjan@bagra.net.mk
From grisha at modpython.org  Mon Dec 22 22:00:03 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:48:02 2004
Subject: [mod_python] mod_python disables mod_dav
In-Reply-To: <200312230157.hBN1vW1B092956@slash.mediapulse.com>
References: <200312230157.hBN1vW1B092956@slash.mediapulse.com>
Message-ID: <20031222215922.N85305@onyx.ispol.com>


I believe Damjan reported that if you swap the lines (put first whichever
was second) the problem goes away,

HTH,

Grisha

On Mon, 22 Dec 2003, Alun wrote:

> I seem to have a problem adding mod_python to an existing configuration with
> mod_dav.
> I have mod_dav enabled and working and planned on integrating mod_python but
> when I *only* add the LoadModule mod_python directive to the httpd.conf,
> WebDAV no longer works and I get a 405 status returned.
>
> Any help would be appreciated.
>
> Checking OPTIONS on the URL before and after adding LoadModule gives:
>
> =====Before====
> OPTIONS /author/ http/1.1
> Host: localhost:80
>
> HTTP/1.1 200 OK
> Date: Mon, 22 Dec 2003 21:47:46 GMT
> Server: Apache/2.0.48 (Win32) mod_jk2/2.0.2 DAV/2
> DAV: 1,2
> MS-Author-Via: DAV
> Allow:
> OPTIONS,GET,HEAD,POST,DELETE,TRACE,PROPFIND,PROPPATCH,COPY,MOVE,LOCK,UNLOCK
> Content-Length: 0
> Content-Type: httpd/unix-directory
>
> =====After LoadModule mod_python modules/mod_python.so=====
> OPTIONS /author/ http:/1.1
> Host: localhost:80
>
> HTTP/1.1 200 OK
> Date: Mon, 22 Dec 2003 21:28:47 GMT
> Server: Apache/2.0.48 (Win32) mod_jk2/2.0.2 mod_python/3.1.2b Python/2.3.2
> DAV/2
>
> Allow: GET,HEAD,POST,OPTIONS,TRACE     <======== No DAV commands.
> Content-Length: 0
> Connection: close
> Content-Type: httpd/unix-directory
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From mark at camazotz.com  Mon Dec 22 22:13:50 2003
From: mark at camazotz.com (Mark Smith)
Date: Fri Jan  9 21:48:02 2004
Subject: [mod_python] Re: FW: Any way to embed Python in HTML?
In-Reply-To: <200312230245.hBN2jU1C093084@slash.mediapulse.com>
References: <200312230245.hBN2jU1C093084@slash.mediapulse.com>
Message-ID: <07C1B262-34F6-11D8-9F73-00039364CE50@camazotz.com>

> I am new to mod_python and haven't seen any examples where you can put
> python code in HTML pages. Is this not supported? If not supported, is
> there any way or work around (other than using the request write 
> method)
> to separate HTML writing from coding?

PWO (http://www.jamwt.com/pwo/) is a simple JSP-style processor that 
allows you to embed Python code.  I think it has a less cluttered 
syntax than many of the alternatives.

If you want something more complex that supports MVC, have a look at 
Draco (http://draco.boskant.nl/).  It's nicely thought out and well 
documented (although the database component is rather low-level.)

From gnb at itga.com.au  Tue Dec 23 15:08:54 2003
From: gnb at itga.com.au (Gregory Bond)
Date: Fri Jan  9 21:48:02 2004
Subject: [mod_python] Re: FW: Any way to embed Python in HTML? 
In-Reply-To: Your message of Mon, 22 Dec 2003 22:13:50 -0500.
Message-ID: <200312230408.PAA13869@lightning.itga.com.au>


I've added an entry to the mod_python FAQ (3.10) to cover this and similar
questions. Please feel free to update or add to the info I've put there.


From neel at mediapulse.com  Tue Dec 23 09:46:25 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:48:02 2004
Subject: [mod_python] Changing the status code with custom content
Message-ID: <C0FC22C08B82074A88B50061764157776B9906@johnson.mediapulse.net>

Is req.status a 3.x only thing (reason I didn't see this is it's not
listed in the 2.x docs - and this server happens to be 2.x)?

Mike

> -----Original Message-----
> From: Gregory (Grisha) Trubetskoy [mailto:grisha@modpython.org] 
> Sent: Monday, December 22, 2003 7:43 PM
> To: Michael C. Neel
> Cc: mod_python@modpython.org
> Subject: Re: [mod_python] Changing the status code with custom content
> 
> 
> 
> I believe you should req.write() your error page, set 
> req.status to the
> the error code you want and return apache.OK. If you retrun 
> anything other
> then apache.OK, then Apache assumes you want it to send its own stock
> error page.
> 
> (Hope this answers your question, I'm a bit woozy on nuquil 
> right now....)
> 
> Grisha
> 
> On Mon, 22 Dec 2003, Michael C. Neel wrote:
> 
> > I'm having trouble using mod_python to change the status 
> code and have
> > custom content in the error message.  If I return something 
> other than
> > apache.OK in my handler, the status line is set correctly 
> set but apache
> > returns the default error page.  If I have sent custom 
> content for the
> > error message, the apache error message is added to the end of the
> > document.  I can get around this by using an ErrorDocument 
> directive in
> > apache's conf, but I loose access to the traceback of the 
> error and thus
> > the ability to have a really custom error message.
> >
> > At first glance this didn't seem to matter.  As long as the 
> content said
> > error, the user knew of the problem, even if the status was 200 OK.
> > However I've found out now with search bots this does matter - they
> > don't know that they have a bad url for the site and are 
> indexing error
> > pages thinking they are legit.
> >
> > Any thoughts on what I may be over looking?
> >
> > Thanks,
> > Mike
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> 

From dpopowich at mtrsd.k12.ma.us  Tue Dec 23 10:08:13 2003
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Fri Jan  9 21:48:02 2004
Subject: [mod_python] default Session timeout
Message-ID: <16360.23133.264930.249115@gargle.gargle.HOWL>


In mod_python.Session the default timeout is set like this:

  DFT_TIMEOUT=30*60*60 # 30 min

That's 30 hours, not minutes.  :-)

------------------
Daniel Popowich
Network Specialist
-------------------------------------
Mohawk Trail Regional School District
24 Ashfield Rd.
Shelburne Falls, MA 01370
413.625.0192 x22
-------------------------------------

From pkeshishian at yahoo.com  Tue Dec 23 12:16:17 2003
From: pkeshishian at yahoo.com (Petros Keshishian)
Date: Fri Jan  9 21:48:02 2004
Subject: [mod_python] displaying python output
Message-ID: <20031223201617.97907.qmail@web40015.mail.yahoo.com>

I am trying to setup mod_python for the first time and
everything seems to be working, except instead of
displaying the output from mod_python in clients
browser it is asking for the file name to save the
output. If you save the output it is exactly what it
was supposed to display. Here is the famous hello.py
that I am using to test the setup.

def say(req,what="Nothing"):
    return "I am saying %s" % what

It is in /usr/local/apache2/htdocs/py-bin/ directory.
The following is set in the http.conf file:

<Directory "/usr/local/apache2/htdocs/py-bin">
                                                      
                                                      
   
    SetHandler python-program
    PythonHandler mod_python.publisher
    PythonDebug On
                                                      
                                                      
   
</Directory>

I am trying to access hello/say using:

http://localhost/py-bin/hello/say

How do I change the output to be directed to the
browser instead of a file.

Thanks a lot for your help
Petros



__________________________________
Do you Yahoo!?
New Yahoo! Photos - easier uploading and sharing.
http://photos.yahoo.com/
From michael at dynamine.net  Tue Dec 23 12:26:52 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 21:48:02 2004
Subject: [mod_python] displaying python output
In-Reply-To: <20031223201617.97907.qmail@web40015.mail.yahoo.com>
References: <20031223201617.97907.qmail@web40015.mail.yahoo.com>
Message-ID: <3FE8A50C.2070202@dynamine.net>

What do the HTTP response headers say the Content-Type is?

--Michael

Petros Keshishian wrote:

> I am trying to setup mod_python for the first time and
> everything seems to be working, except instead of
> displaying the output from mod_python in clients
> browser it is asking for the file name to save the
> output. If you save the output it is exactly what it
> was supposed to display. Here is the famous hello.py
> that I am using to test the setup.
> 
> def say(req,what="Nothing"):
>     return "I am saying %s" % what
> 
> It is in /usr/local/apache2/htdocs/py-bin/ directory.
> The following is set in the http.conf file:
> 
> <Directory "/usr/local/apache2/htdocs/py-bin">
>                                                       
>                                                       
>    
>     SetHandler python-program
>     PythonHandler mod_python.publisher
>     PythonDebug On
>                                                       
>                                                       
>    
> </Directory>
> 
> I am trying to access hello/say using:
> 
> http://localhost/py-bin/hello/say
> 
> How do I change the output to be directed to the
> browser instead of a file.
> 
> Thanks a lot for your help
> Petros
> 
> 
> 
> __________________________________
> Do you Yahoo!?
> New Yahoo! Photos - easier uploading and sharing.
> http://photos.yahoo.com/
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 
From greenbeard400 at yahoo.com  Wed Dec 24 11:12:54 2003
From: greenbeard400 at yahoo.com (Greenbeard)
Date: Fri Jan  9 21:48:02 2004
Subject: [mod_python] Problem on OpenBSD with Publisher Handler 
Message-ID: <20031224191254.2564.qmail@web21326.mail.yahoo.com>

I am getting this error when trying to use the
publisher handler.

Mod_python error: "PythonHandler mod_python.publisher"

Traceback (most recent call last):

  File
"/usr/local/lib/python2.2/site-packages/mod_python/apache.py",
line 332, in HandlerDispatch
    result = object(req)

  File
"/usr/local/lib/python2.2/site-packages/mod_python/publisher.py",
line 142, in handler
    if req.extension:  # this exists if we're running
in a | .ext handler

AttributeError: 'mp_request' object has no attribute
'extension'

my httpd.conf is as described in the docs:

<Directory /home/myServer/apache2/htdocs>
  AddHandler python-program .py
  PythonHandler mod_python.publisher
  PythonDebug On
</Directory>

Simple test script:

from mod_python import apache

def test(req):
    x = "Testing 123"
    return x


Any ideas?  My error log does not have anything
different than the message above.
  
I am running Apache/2.0.44, mod_python/3.0.1,
Python/2.2.1 - right now I can not upgrade any of
these .  
 

Thanks!

gb400

__________________________________
Do you Yahoo!?
Free Pop-Up Blocker - Get it now
http://companion.yahoo.com/
From hnease at midsouth.rr.com  Sat Dec 27 15:51:29 2003
From: hnease at midsouth.rr.com (Howard Nease)
Date: Fri Jan  9 21:48:02 2004
Subject: [mod_python] 
	Win32 Binary Error: "*** run_installscript: internal error
	0xFFFFFFFF ***"
Message-ID: <000801c3ccc3$95d9e500$a000a8c0@stephen>

Hello, all. I recently tried to install mod_python on my Windows XP Home machine, and I got the above error. Here's the context:

Traceback (most recent call last):
  File "E:\Python23\Scripts\win32_postinstall.py", line 90, in ?
    shutil.copy2(mp, os.path.join(apachedir, "modules"))
  File "E:\Python23\Lib\shutil.py", line 82, in copy2
    copyfile(src, dst)
  File "E:\Python23\Lib\shutil.py", line 38, in copyfile
    fdst = open(dst, 'wb')
IOError: [Errno 13] Permission denied: 'E:/Program Files/Apache Group/Apache2\\modules\\mod_python.so'
*** run_installscript: internal error 0xFFFFFFFF ***

Does anyone have a clue as to what I'm doing wrong? I've Googled for a clue, but no dice. Thanks a lot!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20031227/d7569fac/attachment.htm
From RussLear314 at yahoo.com  Sat Dec 27 19:44:55 2003
From: RussLear314 at yahoo.com (Russell Lear)
Date: Fri Jan  9 21:48:02 2004
Subject: [mod_python] Session unable to acquire mutex lock?
Message-ID: <200312271944.55425.RussLear314@yahoo.com>

Hi,

I'm a newbie to mod_python so forgive me if this is a terribly obvious
question (I've looked through the archives without much success).

I'm trying to use sessions.  Right now I have a slightly modified version
of mptest.py as follows (it doesn't make sense, but it does show my
problem):

    from mod_python import apache, Session
    import sys

    def handler(req):
        req.content_type = 'text/plain'
        req.write("Creating...\n")
        sess = Session.Session(req)
        req.write("Hello World!")
        return apache.OK

When I run it, I see:

     Mod_python error: "PythonHandler mptest"

     Traceback (most recent call last):

       File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 338, in HandlerDispatch
         result = object(req)

       File "/srv/www/htdocs/test/mptest.py", line 7, in handler
         sess = Session.Session(req)

       File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 411, in Session
         timeout=timeout)

       File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 316, in __init__
         secret=secret, timeout=timeout)

       File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 170, in __init__
         self.lock()                 # lock new sid

       File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 241, in lock
         _apache._global_lock(self._req.server, self._sid)

     ValueError: Failed to acquire global mutex lock


What am I doing wrong here?!

Thanks for any suggestions,
Russell.

PS:

I'm running on SuSE 9.0 Linux.

Python reports version "Python 2.3+ (#1, Sep 23 2003, 23:07:16)".

>From the Apache error page: 
    Apache/2.0.48 (Linux/SuSE), 
    mod_python/3.1.2b 
    Python/2.3+.

The only glitch I had in building mod_python was that I needed to specify 
    ./configure --with-apxs=/usr/sbin/apxs2

rather than just refering to apxs.

My apache configuration is (from the tutorial):
<Directory /srv/www/htdocs/test> 
  AddHandler python-program .py
  PythonHandler mptest 
  PythonDebug On 
</Directory>



From div at newcode.se  Sun Dec 28 18:52:53 2003
From: div at newcode.se (Carl-Johan Kihlbom)
Date: Fri Jan  9 21:48:02 2004
Subject: [mod_python] mod_python not working on Mac OS X 10.3
Message-ID: <A9026A4E-395E-11D8-982D-000A9599FB7E@newcode.se>

Hi list,

I've installed mod_python on my Mac, but can't get it working. When I  
restart Apache after configuring httpd.conf I get the following error:

Syntax error on line 276 of /Library/Apache2/conf/httpd.conf:
Cannot load /Library/Apache2/modules/mod_python.so into server: dyld:  
/Library/Apache2/bin/httpd Undefined symbols:
_PyExc_AttributeError
_PyExc_IOError
_PyExc_IndexError
_PyExc_KeyError
_PyExc_RuntimeError
_PyExc_StopIteration
_PyExc_TypeError
_PyExc_ValueError
_PyInt_Type
_PyList_Type
_PyObject_GenericGetAttr
_PyObject_GenericSetAttr
_PyString_Type
_PyType_Type
_Py_OptimizeFlag
__Py_NoneStruct
__Py_NotImplementedStruct

I'm using mod_python 3.1.2b on my laptop running Apache 2.0.48 and Mac  
OS X 10.3.2.

In Mac OS X 10.3, Python 2.3 is installed by default, and the library  
and include files are in  
/System/Library/Frameworks/Python.framework/Versions/2.3/lib/python2.3/  
and  
/System/Library/Frameworks/Python.framework/Versions/2.3/include/ 
python2.3/ respectively. I created symlinks to these at /usr/lib/python  
and /usr/include/python.

Any ideas what I did wrong?

TIA,

Carl-Johan Kihlbom

From grisha at modpython.org  Sun Dec 28 13:28:12 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:48:02 2004
Subject: [mod_python] Session unable to acquire mutex lock?
In-Reply-To: <200312271944.55425.RussLear314@yahoo.com>
References: <200312271944.55425.RussLear314@yahoo.com>
Message-ID: <20031228132058.S70904@onyx.ispol.com>


If you restart the server, and try this code, does the error happen on the
first hit, or only starting with the second and after waiting for a while?

If if it's the former, then there probably is some problem with locking in
general (are there any warning messages on server startup?). If it's
latter, then the session does not get unlocked properly. It should get
unlocked when the sess object goes out of scope (and looking at your code
it should), but perhpas try unlocking it manually (sess.unlock()) and see
if this fixes the problem.

Grisha

On Sat, 27 Dec 2003, Russell Lear wrote:

> Hi,
>
> I'm a newbie to mod_python so forgive me if this is a terribly obvious
> question (I've looked through the archives without much success).
>
> I'm trying to use sessions.  Right now I have a slightly modified version
> of mptest.py as follows (it doesn't make sense, but it does show my
> problem):
>
>     from mod_python import apache, Session
>     import sys
>
>     def handler(req):
>         req.content_type = 'text/plain'
>         req.write("Creating...\n")
>         sess = Session.Session(req)
>         req.write("Hello World!")
>         return apache.OK
>
> When I run it, I see:
>
>      Mod_python error: "PythonHandler mptest"
>
>      Traceback (most recent call last):
>
>        File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 338, in HandlerDispatch
>          result = object(req)
>
>        File "/srv/www/htdocs/test/mptest.py", line 7, in handler
>          sess = Session.Session(req)
>
>        File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 411, in Session
>          timeout=timeout)
>
>        File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 316, in __init__
>          secret=secret, timeout=timeout)
>
>        File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 170, in __init__
>          self.lock()                 # lock new sid
>
>        File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 241, in lock
>          _apache._global_lock(self._req.server, self._sid)
>
>      ValueError: Failed to acquire global mutex lock
>
>
> What am I doing wrong here?!
>
> Thanks for any suggestions,
> Russell.
>
> PS:
>
> I'm running on SuSE 9.0 Linux.
>
> Python reports version "Python 2.3+ (#1, Sep 23 2003, 23:07:16)".
>
> >From the Apache error page:
>     Apache/2.0.48 (Linux/SuSE),
>     mod_python/3.1.2b
>     Python/2.3+.
>
> The only glitch I had in building mod_python was that I needed to specify
>     ./configure --with-apxs=/usr/sbin/apxs2
>
> rather than just refering to apxs.
>
> My apache configuration is (from the tutorial):
> <Directory /srv/www/htdocs/test>
>   AddHandler python-program .py
>   PythonHandler mptest
>   PythonDebug On
> </Directory>
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From mark at gsoa.net  Sun Dec 28 16:07:22 2003
From: mark at gsoa.net (Mark McClain)
Date: Fri Jan  9 21:48:02 2004
Subject: [mod_python] mod_python not working on Mac OS X 10.3
In-Reply-To: <A9026A4E-395E-11D8-982D-000A9599FB7E@newcode.se>
References: <A9026A4E-395E-11D8-982D-000A9599FB7E@newcode.se>
Message-ID: <D434E9D8-3979-11D8-BDD5-000A95B33D28@gsoa.net>

Here is what I use to build on 10.3.2:

1) Build and install apache2

2) Unpack the mod_python distribution

3) make the following changes to the configure script. here it is in  
modified form...

if test "$PyFRAMEWORKDIR" != "no-framework"; then
   if test -n "$PyFRAMEWORK"; then
     PyPYTHONLIBS="-framework $PyFRAMEWORK"

    # explicitly pass to mac linker so add this line
     LDFLAGS="${LDFLAGS} -Wl,-framework,Python"
   fi

4) run configure, make, then install

Good luck,
mark

On Dec 28, 2003, at 12:52 PM, Carl-Johan Kihlbom wrote:

> Hi list,
>
> I've installed mod_python on my Mac, but can't get it working. When I  
> restart Apache after configuring httpd.conf I get the following error:
>
> Syntax error on line 276 of /Library/Apache2/conf/httpd.conf:
> Cannot load /Library/Apache2/modules/mod_python.so into server: dyld:  
> /Library/Apache2/bin/httpd Undefined symbols:
> _PyExc_AttributeError
> _PyExc_IOError
> _PyExc_IndexError
> _PyExc_KeyError
> _PyExc_RuntimeError
> _PyExc_StopIteration
> _PyExc_TypeError
> _PyExc_ValueError
> _PyInt_Type
> _PyList_Type
> _PyObject_GenericGetAttr
> _PyObject_GenericSetAttr
> _PyString_Type
> _PyType_Type
> _Py_OptimizeFlag
> __Py_NoneStruct
> __Py_NotImplementedStruct
>
> I'm using mod_python 3.1.2b on my laptop running Apache 2.0.48 and Mac  
> OS X 10.3.2.
>
> In Mac OS X 10.3, Python 2.3 is installed by default, and the library  
> and include files are in  
> /System/Library/Frameworks/Python.framework/Versions/2.3/lib/ 
> python2.3/ and  
> /System/Library/Frameworks/Python.framework/Versions/2.3/include/ 
> python2.3/ respectively. I created symlinks to these at  
> /usr/lib/python and /usr/include/python.
>
> Any ideas what I did wrong?
>
> TIA,
>
> Carl-Johan Kihlbom
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From RussLear314 at yahoo.com  Mon Dec 29 08:57:00 2003
From: RussLear314 at yahoo.com (Russell Lear)
Date: Fri Jan  9 21:48:02 2004
Subject: [mod_python] Session unable to acquire mutex lock?
In-Reply-To: <20031228132058.S70904@onyx.ispol.com>
References: <200312271944.55425.RussLear314@yahoo.com>
	<20031228132058.S70904@onyx.ispol.com>
Message-ID: <200312290857.00982.RussLear314@yahoo.com>

Grisha,

Thanks for the suggestions.  

I did a stop/start and the problem happens on the first hit.

I enabled some debug logging (See below).  

There are two things I notice that seem odd to my inexperienced eye: 

1) During apache's startup, mod_python says
    "Creating 32 session mutexes based on 150 max processes and 0 max threads".  
Is "0 max threads" correct, or do I have something misconfigured? 
Seems like max threads ought to be at least 1 or 2 ??

2) When I invoke my test, there is a warning
    "Permission denied: Failed to acquire global mutex lock at index 17".  
Is that just saying that it failed to get a mutex lock or do I have bad permissions someplace?

Thanks,
Russell.

====================
Apache error_log exerpt:
[... 08:30:57 ] [info] Server: Apache/2.0.48, Interface: mod_ssl/2.0.48, Library: OpenSSL/0.9.7b
[... 08:30:57 ] [notice] suEXEC mechanism enabled (wrapper: /usr/sbin/suexec2)
[... 08:31:00 ] [info] Init: Initializing OpenSSL library
[... 08:31:00 ] [info] Init: Seeding PRNG with 0 bytes of entropy
[... 08:31:00 ] [info] Init: Generating temporary RSA private keys (512/1024 bits)
[... 08:31:00 ] [info] Init: Generating temporary DH parameters (512/1024 bits)
[... 08:31:00 ] [info] Init: Initializing (virtual) servers for SSL
[... 08:31:00 ] [info] Server: Apache/2.0.48, Interface: mod_ssl/2.0.48, Library: OpenSSL/0.9.7b
[... 08:31:02 ] [notice] mod_python: Creating 32 session mutexes based on 150 max processes and 0 max threads.
[... 08:31:02 ] [notice] Apache/2.0.48 (Linux/SuSE) mod_ssl/2.0.48 OpenSSL/0.9.7b PHP/4.3.3 mod_python/3.1.2b Python/2.3+ configured -- resuming normal operations
[... 08:31:02 ] [info] Server built: Nov 10 2003 11:47:10
[... 08:31:02 ] [debug] prefork.c(1037): AcceptMutex: sysvsem (default: sysvsem)
[... 08:31:15 ] [notice] mod_python: (Re)importing module 'mptest'
[... 08:31:16 ] [warn] (13)Permission denied: Failed to acquire global mutex lock at index 17
[... 08:31:16 ] [error] [client ::1] PythonHandler mptest: Traceback (most recent call last):
[... 08:31:16 ] [error] [client ::1] PythonHandler mptest: 
    File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 338, in HandlerDispatch
    result = object(req)
[... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
    File "/srv/www/htdocs/test/mptest.py", line 7, in handler
    sess = Session.Session(req)
[... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
    File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 411, in Session
    timeout=timeout)
[... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
    File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 316, in __init__
    secret=secret, timeout=timeout)
[... 08:31:16 ] [error] [client ::1] PythonHandler mptest:   
    File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 170, in __init__
    self.lock()                 # lock new sid
[... 08:31:16 ] [error] [client ::1] PythonHandler mptest:   
    File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 241, in lock
    _apache._global_lock(self._req.server, self._sid)
[... 08:31:16 ] [error] [client ::1] PythonHandler mptest: 
    ValueError: Failed to acquire global mutex lock

====================

On Sunday 28 December 2003 10:28, Gregory (Grisha) Trubetskoy wrote:
> If you restart the server, and try this code, does the error happen on the
> first hit, or only starting with the second and after waiting for a while?
>
> If if it's the former, then there probably is some problem with locking in
> general (are there any warning messages on server startup?). ...
>
> Grisha
>
> On Sat, 27 Dec 2003, Russell Lear wrote:
> > Hi,
> >
> > [RLear: 2003/12/29: deleted text to avoid overly long attachment]
> >
> >     from mod_python import apache, Session
> >     import sys
> >
> >     def handler(req):
> >         req.content_type = 'text/plain'
> >         req.write("Creating...\n")
> >         sess = Session.Session(req)
> >         req.write("Hello World!")
> >         return apache.OK
> >
> >  [RLear: 2003/12/29: deleted text to avoid overly long attachment]
> >
> > I'm running on SuSE 9.0 Linux.
> >
> > Python reports version "Python 2.3+ (#1, Sep 23 2003, 23:07:16)".
> >
> > >From the Apache error page:
> >
> >     Apache/2.0.48 (Linux/SuSE),
> >     mod_python/3.1.2b
> >     Python/2.3+.
> >
> > The only glitch I had in building mod_python was that I needed to specify
> >     ./configure --with-apxs=/usr/sbin/apxs2
> >
> > rather than just refering to apxs.
> >
> > My apache configuration is (from the tutorial):
> > <Directory /srv/www/htdocs/test>
> >   AddHandler python-program .py
> >   PythonHandler mptest
> >   PythonDebug On
> > </Directory>
> >
> >
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python

From div at newcode.se  Mon Dec 29 17:55:44 2003
From: div at newcode.se (Carl-Johan Kihlbom)
Date: Fri Jan  9 21:48:02 2004
Subject: [mod_python] mod_python not working on Mac OS X 10.3
In-Reply-To: <D434E9D8-3979-11D8-BDD5-000A95B33D28@gsoa.net>
References: <A9026A4E-395E-11D8-982D-000A9599FB7E@newcode.se>
	<D434E9D8-3979-11D8-BDD5-000A95B33D28@gsoa.net>
Message-ID: <D7CFFAED-3A1F-11D8-8995-000A9599FB7E@newcode.se>

That got me a bit further, thanks, but I still can't get it to work.  
I've followed the testing procedures in the manual by setting  
AllowOverride All in httpd.conf and creating a .htaccess file in  
htdocs/test with the following content:

AddHandler python-program .py
PythonHandler mptest
PythonDebug On

I then created a file mptest.py in the same directory. It looks like  
this:

from mod_python import apache

def handler(req):
     req.write("Hello World!")
     return apache.OK

When I try to access http://localhost/test/mptest.py I get a 500  
Internal Server Error. No additional information in the access or error  
log.

Any ideas what's wrong this time? :-)

Thanks again,

Carl-Johan Kihlbom

On Dec 28, 2003, at 22:07, Mark McClain wrote:

> Here is what I use to build on 10.3.2:
>
> 1) Build and install apache2
>
> 2) Unpack the mod_python distribution
>
> 3) make the following changes to the configure script. here it is in  
> modified form...
>
> if test "$PyFRAMEWORKDIR" != "no-framework"; then
>   if test -n "$PyFRAMEWORK"; then
>     PyPYTHONLIBS="-framework $PyFRAMEWORK"
>
>    # explicitly pass to mac linker so add this line
>     LDFLAGS="${LDFLAGS} -Wl,-framework,Python"
>   fi
>
> 4) run configure, make, then install
>
> Good luck,
> mark
>
> On Dec 28, 2003, at 12:52 PM, Carl-Johan Kihlbom wrote:
>
>> Hi list,
>>
>> I've installed mod_python on my Mac, but can't get it working. When I  
>> restart Apache after configuring httpd.conf I get the following  
>> error:
>>
>> Syntax error on line 276 of /Library/Apache2/conf/httpd.conf:
>> Cannot load /Library/Apache2/modules/mod_python.so into server: dyld:  
>> /Library/Apache2/bin/httpd Undefined symbols:
>> _PyExc_AttributeError
>> _PyExc_IOError
>> _PyExc_IndexError
>> _PyExc_KeyError
>> _PyExc_RuntimeError
>> _PyExc_StopIteration
>> _PyExc_TypeError
>> _PyExc_ValueError
>> _PyInt_Type
>> _PyList_Type
>> _PyObject_GenericGetAttr
>> _PyObject_GenericSetAttr
>> _PyString_Type
>> _PyType_Type
>> _Py_OptimizeFlag
>> __Py_NoneStruct
>> __Py_NotImplementedStruct
>>
>> I'm using mod_python 3.1.2b on my laptop running Apache 2.0.48 and  
>> Mac OS X 10.3.2.
>>
>> In Mac OS X 10.3, Python 2.3 is installed by default, and the library  
>> and include files are in  
>> /System/Library/Frameworks/Python.framework/Versions/2.3/lib/ 
>> python2.3/ and  
>> /System/Library/Frameworks/Python.framework/Versions/2.3/include/ 
>> python2.3/ respectively. I created symlinks to these at  
>> /usr/lib/python and /usr/include/python.
>>
>> Any ideas what I did wrong?
>>
>> TIA,
>>
>> Carl-Johan Kihlbom

From grisha at modpython.org  Mon Dec 29 16:54:57 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:48:02 2004
Subject: [mod_python] Session unable to acquire mutex lock?
In-Reply-To: <200312290857.00982.RussLear314@yahoo.com>
References: <200312271944.55425.RussLear314@yahoo.com>
	<20031228132058.S70904@onyx.ispol.com>
	<200312290857.00982.RussLear314@yahoo.com>
Message-ID: <20031229165250.V88187@onyx.ispol.com>


This looks like a permissions bug with System V IPC that made it into the
beta. Try running one of the latest CVS snapshots, I think it is fixed
there.

Grisha

On Mon, 29 Dec 2003, Russell Lear wrote:

> Grisha,
>
> Thanks for the suggestions.
>
> I did a stop/start and the problem happens on the first hit.
>
> I enabled some debug logging (See below).
>
> There are two things I notice that seem odd to my inexperienced eye:
>
> 1) During apache's startup, mod_python says
>     "Creating 32 session mutexes based on 150 max processes and 0 max threads".
> Is "0 max threads" correct, or do I have something misconfigured?
> Seems like max threads ought to be at least 1 or 2 ??
>
> 2) When I invoke my test, there is a warning
>     "Permission denied: Failed to acquire global mutex lock at index 17".
> Is that just saying that it failed to get a mutex lock or do I have bad permissions someplace?
>
> Thanks,
> Russell.
>
> ====================
> Apache error_log exerpt:
> [... 08:30:57 ] [info] Server: Apache/2.0.48, Interface: mod_ssl/2.0.48, Library: OpenSSL/0.9.7b
> [... 08:30:57 ] [notice] suEXEC mechanism enabled (wrapper: /usr/sbin/suexec2)
> [... 08:31:00 ] [info] Init: Initializing OpenSSL library
> [... 08:31:00 ] [info] Init: Seeding PRNG with 0 bytes of entropy
> [... 08:31:00 ] [info] Init: Generating temporary RSA private keys (512/1024 bits)
> [... 08:31:00 ] [info] Init: Generating temporary DH parameters (512/1024 bits)
> [... 08:31:00 ] [info] Init: Initializing (virtual) servers for SSL
> [... 08:31:00 ] [info] Server: Apache/2.0.48, Interface: mod_ssl/2.0.48, Library: OpenSSL/0.9.7b
> [... 08:31:02 ] [notice] mod_python: Creating 32 session mutexes based on 150 max processes and 0 max threads.
> [... 08:31:02 ] [notice] Apache/2.0.48 (Linux/SuSE) mod_ssl/2.0.48 OpenSSL/0.9.7b PHP/4.3.3 mod_python/3.1.2b Python/2.3+ configured -- resuming normal operations
> [... 08:31:02 ] [info] Server built: Nov 10 2003 11:47:10
> [... 08:31:02 ] [debug] prefork.c(1037): AcceptMutex: sysvsem (default: sysvsem)
> [... 08:31:15 ] [notice] mod_python: (Re)importing module 'mptest'
> [... 08:31:16 ] [warn] (13)Permission denied: Failed to acquire global mutex lock at index 17
> [... 08:31:16 ] [error] [client ::1] PythonHandler mptest: Traceback (most recent call last):
> [... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
>     File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 338, in HandlerDispatch
>     result = object(req)
> [... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
>     File "/srv/www/htdocs/test/mptest.py", line 7, in handler
>     sess = Session.Session(req)
> [... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
>     File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 411, in Session
>     timeout=timeout)
> [... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
>     File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 316, in __init__
>     secret=secret, timeout=timeout)
> [... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
>     File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 170, in __init__
>     self.lock()                 # lock new sid
> [... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
>     File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 241, in lock
>     _apache._global_lock(self._req.server, self._sid)
> [... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
>     ValueError: Failed to acquire global mutex lock
>
> ====================
>
> On Sunday 28 December 2003 10:28, Gregory (Grisha) Trubetskoy wrote:
> > If you restart the server, and try this code, does the error happen on the
> > first hit, or only starting with the second and after waiting for a while?
> >
> > If if it's the former, then there probably is some problem with locking in
> > general (are there any warning messages on server startup?). ...
> >
> > Grisha
> >
> > On Sat, 27 Dec 2003, Russell Lear wrote:
> > > Hi,
> > >
> > > [RLear: 2003/12/29: deleted text to avoid overly long attachment]
> > >
> > >     from mod_python import apache, Session
> > >     import sys
> > >
> > >     def handler(req):
> > >         req.content_type = 'text/plain'
> > >         req.write("Creating...\n")
> > >         sess = Session.Session(req)
> > >         req.write("Hello World!")
> > >         return apache.OK
> > >
> > >  [RLear: 2003/12/29: deleted text to avoid overly long attachment]
> > >
> > > I'm running on SuSE 9.0 Linux.
> > >
> > > Python reports version "Python 2.3+ (#1, Sep 23 2003, 23:07:16)".
> > >
> > > >From the Apache error page:
> > >
> > >     Apache/2.0.48 (Linux/SuSE),
> > >     mod_python/3.1.2b
> > >     Python/2.3+.
> > >
> > > The only glitch I had in building mod_python was that I needed to specify
> > >     ./configure --with-apxs=/usr/sbin/apxs2
> > >
> > > rather than just refering to apxs.
> > >
> > > My apache configuration is (from the tutorial):
> > > <Directory /srv/www/htdocs/test>
> > >   AddHandler python-program .py
> > >   PythonHandler mptest
> > >   PythonDebug On
> > > </Directory>
> > >
> > >
> > >
> > > _______________________________________________
> > > Mod_python mailing list
> > > Mod_python@modpython.org
> > > http://mailman.modpython.org/mailman/listinfo/mod_python
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From RussLear314 at yahoo.com  Mon Dec 29 21:00:59 2003
From: RussLear314 at yahoo.com (Russell Lear)
Date: Fri Jan  9 21:48:02 2004
Subject: [mod_python] Session unable to acquire mutex lock?
In-Reply-To: <20031229165250.V88187@onyx.ispol.com>
References: <200312271944.55425.RussLear314@yahoo.com>
	<200312290857.00982.RussLear314@yahoo.com>
	<20031229165250.V88187@onyx.ispol.com>
Message-ID: <200312292100.59743.RussLear314@yahoo.com>

Ok!  I'm able to create a session now!

I grabbed httpd-python_20031229231518.tar.gz and things seem to work now.

Thanks a lot Grisha for your help.

Russell.


On Monday 29 December 2003 13:54, Gregory (Grisha) Trubetskoy wrote:
> This looks like a permissions bug with System V IPC that made it into the
> beta. Try running one of the latest CVS snapshots, I think it is fixed
> there.
>
> Grisha
>

From kevin at sb.org  Tue Dec 30 01:35:11 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:48:02 2004
Subject: [mod_python] mod_python not working on Mac OS X 10.3
In-Reply-To: <D7CFFAED-3A1F-11D8-8995-000A9599FB7E@newcode.se>
References: <A9026A4E-395E-11D8-982D-000A9599FB7E@newcode.se>
	<D434E9D8-3979-11D8-BDD5-000A95B33D28@gsoa.net>
	<D7CFFAED-3A1F-11D8-8995-000A9599FB7E@newcode.se>
Message-ID: <519C889B-3A92-11D8-9AD2-000A95A072FC@sb.org>

Gah, I always do this! This message was meant to go to the list.

---

I got a lot of that stuff until I stopped doing graceful restarts and 
started doing a stop, waiting for all httpd processes to die out, then 
starting it back up. That tended to fix the problem.

On Dec 29, 2003, at 11:55 AM, Carl-Johan Kihlbom wrote:

> When I try to access http://localhost/test/mptest.py I get a 500 
> Internal Server Error. No additional information in the access or 
> error log.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From pkeshishian at yahoo.com  Tue Dec 30 01:54:41 2003
From: pkeshishian at yahoo.com (Petros Keshishian)
Date: Fri Jan  9 21:48:02 2004
Subject: [mod_python] MySQLdb
Message-ID: <20031230095441.1986.qmail@web40020.mail.yahoo.com>

I would very much appreciate if anyone could resolve
my problem with MySQLdb.

I am try to run a query from mod_python as follows:

db = MySQldb.connect(db='aua', user='root')
c = db.cursor()
c.execute('select fname,lname,gyear from addrbk')

The program freezes at the last (3rd) line. The same
code works fine if I run it from python shell
directly. 
The code even works in mod_python if I query for less
than 3 column, e.g.

c.execute('select fname,lname from addrbk')
or
c.execute('select lname, gyear from addrbk')

Can anybody tell me what's going on?

Thank you for your help,
Petros







__________________________________
Do you Yahoo!?
Find out what made the Top Yahoo! Searches of 2003
http://search.yahoo.com/top2003
From neel at mediapulse.com  Tue Dec 30 11:08:45 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:48:02 2004
Subject: [mod_python] MySQLdb
Message-ID: <C0FC22C08B82074A88B50061764157776B991B@johnson.mediapulse.net>

Do you have PythonDebug On in your conf to see any traceback errors?
They should also be in your error log as well, even if debug is off.  If
they don't answer your questions, forward those on they will help in
seeing the problem.

Thanks,
Mike


> -----Original Message-----
> From: Petros Keshishian [mailto:pkeshishian@yahoo.com] 
> Sent: Tuesday, December 30, 2003 4:55 AM
> To: mod_python@modpython.org
> Subject: [mod_python] MySQLdb
> 
> 
> I would very much appreciate if anyone could resolve
> my problem with MySQLdb.
> 
> I am try to run a query from mod_python as follows:
> 
> db = MySQldb.connect(db='aua', user='root')
> c = db.cursor()
> c.execute('select fname,lname,gyear from addrbk')
> 
> The program freezes at the last (3rd) line. The same
> code works fine if I run it from python shell
> directly. 
> The code even works in mod_python if I query for less
> than 3 column, e.g.
> 
> c.execute('select fname,lname from addrbk')
> or
> c.execute('select lname, gyear from addrbk')
> 
> Can anybody tell me what's going on?
> 
> Thank you for your help,
> Petros
> 
> 
> 
> 
> 
> 
> 
> __________________________________
> Do you Yahoo!?
> Find out what made the Top Yahoo! Searches of 2003
> http://search.yahoo.com/top2003
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

From pkeshishian at yahoo.com  Tue Dec 30 09:13:18 2003
From: pkeshishian at yahoo.com (Petros Keshishian)
Date: Fri Jan  9 21:48:02 2004
Subject: [mod_python] MySQLdb
In-Reply-To: <C0FC22C08B82074A88B50061764157776B991B@johnson.mediapulse.net>
Message-ID: <20031230171318.10032.qmail@web40015.mail.yahoo.com>

I do have PythonDebud On, but it does not report any
errors. The error log has the following:

[Tue Dec 30 09:07:16 2003] [notice] mod_python:
(Re)importing module 'pyhndlr' with path set to
'['/usr/local/apache2/htdocs/auaweb/frm_address']'
[Tue Dec 30 09:07:16 2003] [notice] child pid 4161
exit signal Segmentation fault (11)

pyhndlr.py is the file where the code resides. I hope
you know what this segmentation fault could be.

Thanks,
Petros


--- "Michael C. Neel" <neel@mediapulse.com> wrote:
> Do you have PythonDebug On in your conf to see any
> traceback errors?
> They should also be in your error log as well, even
> if debug is off.  If
> they don't answer your questions, forward those on
> they will help in
> seeing the problem.
> 
> Thanks,
> Mike
> 
> 
> > -----Original Message-----
> > From: Petros Keshishian
> [mailto:pkeshishian@yahoo.com] 
> > Sent: Tuesday, December 30, 2003 4:55 AM
> > To: mod_python@modpython.org
> > Subject: [mod_python] MySQLdb
> > 
> > 
> > I would very much appreciate if anyone could
> resolve
> > my problem with MySQLdb.
> > 
> > I am try to run a query from mod_python as
> follows:
> > 
> > db = MySQldb.connect(db='aua', user='root')
> > c = db.cursor()
> > c.execute('select fname,lname,gyear from addrbk')
> > 
> > The program freezes at the last (3rd) line. The
> same
> > code works fine if I run it from python shell
> > directly. 
> > The code even works in mod_python if I query for
> less
> > than 3 column, e.g.
> > 
> > c.execute('select fname,lname from addrbk')
> > or
> > c.execute('select lname, gyear from addrbk')
> > 
> > Can anybody tell me what's going on?
> > 
> > Thank you for your help,
> > Petros
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > __________________________________
> > Do you Yahoo!?
> > Find out what made the Top Yahoo! Searches of 2003
> > http://search.yahoo.com/top2003
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> >
>
http://mailman.modpython.org/mailman/listinfo/mod_python
> > 


__________________________________
Do you Yahoo!?
Find out what made the Top Yahoo! Searches of 2003
http://search.yahoo.com/top2003
From pkeshishian at yahoo.com  Tue Dec 30 10:20:40 2003
From: pkeshishian at yahoo.com (Petros Keshishian)
Date: Fri Jan  9 21:48:03 2004
Subject: [mod_python] MySQLdb
In-Reply-To: <1072769149.20927.1.camel@inspiration.x.eradman.com>
Message-ID: <20031230182040.81782.qmail@web40008.mail.yahoo.com>

Eric:
 
I have put req.write() statements before and after the execute() function like this:
 
db = MySQldb.connect(db='aua', user='root')
c = db.cursor()
req.content_type = "text/plain"
req.write("Before Execute\n")
c.execute('select fname,lname,gyear from addrbk')
req.write("After Execute\n")
 
When I point the browser to this function I see:
Before Execute
 
And nothing else. No error messages even though I have PythonDebug On. As I already sent in my previous e-mail there is a segmentation fault reported in error log.
 
What's surprising is that it works fine if I query for any two columns instead of three.
 
Thanks for your help,
Petros


Eric Radman <theman@eradman.com> wrote:
Petros,

Are you saying that it won't run ANYTHING after the execute() function?

Eric Radman
theman@eradman.com

On Tue, 2003-12-30 at 09:54, Petros Keshishian wrote:
> I would very much appreciate if anyone could resolve
> my problem with MySQLdb.
> 
> I am try to run a query from mod_python as follows:
> 
> db = MySQldb.connect(db='aua', user='root')
> c = db.cursor()
> c.execute('select fname,lname,gyear from addrbk')
> 
> The program freezes at the last (3rd) line. The same
> code works fine if I run it from python shell
> directly. 
> The code even works in mod_python if I query for less
> than 3 column, e.g.
> 
> c.execute('select fname,lname from addrbk')
> or
> c.execute('select lname, gyear from addrbk')
> 
> Can anybody tell me what's going on?
> 
> Thank you for your help,
> Petros
> 
> 
> 
> 
> 
> 
> 
> __________________________________
> Do you Yahoo!?
> Find out what made the Top Yahoo! Searches of 2003
> http://search.yahoo.com/top2003
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python


---------------------------------
Do you Yahoo!?
Find out what made the Top Yahoo! Searches of 2003
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20031230/06304ebd/attachment.htm
From redconectabilbao at telefonica.net  Wed Dec 31 10:57:31 2003
From: redconectabilbao at telefonica.net (Red Conecta)
Date: Fri Jan  9 21:48:03 2004
Subject: [mod_python] mod_python and css
Message-ID: <3FF29D8B.6030208@telefonica.net>

I'm trying to use css with the publisherhandler; here is the code:

    def _inicio():
        ini= '''<head><title>nombredelsitio</title>
                  <link rel="stylesheet" href="estilo.css"
    Type="text/css"></head>
                  <body leftmargin=0 rightmargin=0 topmargin=0
    bottommargin=0>'''
       
        return ini

    def _final():
        return '</body></html>'

    def mostrar(req,direccion='/'):
        req.content_type = "text/html"
        html=_inicio()
        obj=leerobjeto(direccion)
        if obj!=None:
            for i in obj.__dict__:html+=i+': '+obj.__dict__[i]+'<br>'
        else:html+='error'
        html+=_final()
        return html

the output doesn't use the estilo.css archive but if I save the page in 
'mostrar.html' all is ok.

From sgillies at frii.com  Wed Dec 31 07:42:41 2003
From: sgillies at frii.com (Sean Gillies)
Date: Fri Jan  9 21:48:03 2004
Subject: [mod_python] mod_python and css
In-Reply-To: <3FF29D8B.6030208@telefonica.net>
References: <3FF29D8B.6030208@telefonica.net>
Message-ID: <960A9AF8-3B9F-11D8-9527-000393B98B56@frii.com>

On Dec 31, 2003, at 2:57 AM, Red Conecta wrote:

> I'm trying to use css with the publisherhandler; here is the code:
>
>    def _inicio():
>        ini= '''<head><title>nombredelsitio</title>
>                  <link rel="stylesheet" href="estilo.css"
>    Type="text/css"></head>
>                  <body leftmargin=0 rightmargin=0 topmargin=0
>    bottommargin=0>'''
>              return ini
>
>    def _final():
>        return '</body></html>'
>
>    def mostrar(req,direccion='/'):
>        req.content_type = "text/html"
>        html=_inicio()
>        obj=leerobjeto(direccion)
>        if obj!=None:
>            for i in obj.__dict__:html+=i+': '+obj.__dict__[i]+'<br>'
>        else:html+='error'
>        html+=_final()
>        return html
>
> the output doesn't use the estilo.css archive but if I save the page 
> in 'mostrar.html' all is ok.
>

Try "../estilo.css", this will link to the stylesheet in the same
location as the published module.

cheers,
Sean

--
Sean Gillies
sgillies at frii dot com
http://users.frii.com/sgillies

From kevin at sb.org  Wed Dec 31 15:18:58 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:48:03 2004
Subject: [mod_python] mod_python and css
In-Reply-To: <3FF29D8B.6030208@telefonica.net>
References: <3FF29D8B.6030208@telefonica.net>
Message-ID: <9089E1A9-3BCE-11D8-9AD2-000A95A072FC@sb.org>

That's because with this handler, your URL looks something like

http://my.domain.com/myScript/mostrar

so when you access "estilo.css", the requested URL is

/myScript/estilo.css

However, your script doesn't handle estilo.css, since that's actually a 
file in the same directory as myScript. If you replace the script with 
mostrar.html, then estilo.css is accessed as

/estilo.css

instead, since the myScript path segment is now gone.

The solution is to put "../estilo.css" as your CSS href.

P.S. Why does this list use a Reply-To for the original sender rather 
than for the list itself? I keep sending mail to individual people when 
I mean to simply reply to the list itself.

On Dec 31, 2003, at 4:57 AM, Red Conecta wrote:

> I'm trying to use css with the publisherhandler; here is the code:
>
>    def _inicio():
>        ini= '''<head><title>nombredelsitio</title>
>                  <link rel="stylesheet" href="estilo.css"
>    Type="text/css"></head>
>                  <body leftmargin=0 rightmargin=0 topmargin=0
>    bottommargin=0>'''
>              return ini
>
>    def _final():
>        return '</body></html>'
>
>    def mostrar(req,direccion='/'):
>        req.content_type = "text/html"
>        html=_inicio()
>        obj=leerobjeto(direccion)
>        if obj!=None:
>            for i in obj.__dict__:html+=i+': '+obj.__dict__[i]+'<br>'
>        else:html+='error'
>        html+=_final()
>        return html
>
> the output doesn't use the estilo.css archive but if I save the page 
> in 'mostrar.html' all is ok.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From jay at jaydorsey.com  Mon Dec  1 11:22:03 2003
From: jay at jaydorsey.com (Jay Dorsey)
Date: Fri Jan  9 21:54:04 2004
Subject: [mod_python] Mailing list archive link
Message-ID: <20031201172203.GA32445@gentoo.Earthlink.net>

I was trying to download the mailing list archives this morning. From the front page of http://www.modpython.org I clicked on the "Mailing list archives are here" link. The "download the full raw archive" link points to http://www.modpython.org/pipermail/mod_python.mbox/mod_python.mbox which is a 404. Clicking the "more information about this list" link, which took me to the mailman page, then clicking the "Mod python archives" link took me to a page that was similar to the archive list linked on the front page of modpython.org. This page has what I assume to be the correct link to the mailing list archives: http://mailman.modpython.org/pipermail/mod_python.mbox/mod_python.mbox.

Sorry if this has already been posted--I've just started subscribing to the list and I searched the raw archives for mmention of this and found nothing.  Also, is there a user-friendly web interface for searching through the modpython mailing list archives?

-- 
Jay Dorsey
jay at jaydorsey dot com
From aalbarracindev at hotmail.com  Mon Dec  1 18:48:04 2003
From: aalbarracindev at hotmail.com (Alberto Sanchez Albarracin)
Date: Fri Jan  9 21:54:04 2004
Subject: [mod_python] apache doesn't start
Message-ID: <BAY7-F27e1YM9a2flhn0002153b@hotmail.com>

Hi all, i want mod_python for apache1(windows), the download page says that
mod_python 2.7.9 works with http server 1.3 but the link led me to one page
where appeared one directory named "win" among another files and two
directories, i went into win directory and i found several directories, i
choose the 2.7.6 directory and appeared two files listed below:
python2.2-apache1.3.20.zip, python2.2-apache1.3.20.zip
I pressed on the python2.2-apache1.3.22.zip file which is the second one,
decompressed it, and i just found a dll file named mod_python.dll.
My question is: where should i copy this file so that apache starts without
errors. The error is: Cannot load mod_python.so into server, the specific
module could not be found...

Thanks in advance

_________________________________________________________________
STOP MORE SPAM with the new MSN 8 and get 2 months FREE* 
http://join.msn.com/?page=features/junkmail

From neel at mediapulse.com  Tue Dec  2 11:44:34 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:54:04 2004
Subject: [mod_python] Getting mod_python version
Message-ID: <C0FC22C08B82074A88B500617641577787A7D3@johnson.mediapulse.net>

Hi all,

	I don't know if it's not there, or I'm just overlooking it, but
I can seem for a way in code to get the version of mod_python.  I have
some "default" modules I use, and I am trying to make them work with any
mod_python version.  Right now I'm doing try block, like such:

    # Get username/password from client
    pw = req.get_basic_auth_pw()
    try:
        # mod_python 2.x
        user = req.connection.user
    except:
        # mod_python 3.x
        user = req.user

	...but I'd rather be able to get the version directly.

Mike

From gustavo.cordova at q-voz.com  Tue Dec  2 12:47:27 2003
From: gustavo.cordova at q-voz.com (=?ISO-8859-1?Q?Gustavo_C=F3rdova_Avila?=)
Date: Fri Jan  9 21:54:04 2004
Subject: [mod_python] Getting mod_python version
In-Reply-To: <C0FC22C08B82074A88B500617641577787A7D3@johnson.mediapulse.net>
References: <C0FC22C08B82074A88B500617641577787A7D3@johnson.mediapulse.net>
Message-ID: <3FCCDE3F.4090005@q-voz.com>

This is the correct, "pythonic" way of doing things.

I'd recommend using "except AttributeError:" instead of a naked 
"except:" btw.

-gustavo

Michael C. Neel wrote:

>Hi all,
>
>	I don't know if it's not there, or I'm just overlooking it, but
>I can seem for a way in code to get the version of mod_python.  I have
>some "default" modules I use, and I am trying to make them work with any
>mod_python version.  Right now I'm doing try block, like such:
>
>    # Get username/password from client
>    pw = req.get_basic_auth_pw()
>    try:
>        # mod_python 2.x
>        user = req.connection.user
>    except:
>        # mod_python 3.x
>        user = req.user
>
>	...but I'd rather be able to get the version directly.
>
>Mike
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
>  
>

From neel at mediapulse.com  Tue Dec  2 14:30:41 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:54:04 2004
Subject: [mod_python] Getting mod_python version
Message-ID: <C0FC22C08B82074A88B500617641577787A7D4@johnson.mediapulse.net>

Most modules have a __version__ member, and the help() built-in method
even looks for this variable and uses it to display the version of the
file:

>>>import cgi
>>>cgi.__version__
'2.6'
>>>help(cgi)
...skipping...
DATA
    __all__ = ['MiniFieldStorage', 'FieldStorage', 'FormContentDict',
'SvF...
    __version__ = '2.6'
    logfile = ''
    logfp = None
    maxlen = 0

VERSION
    2.6

>>>

I have not read or seen anything saying the "pythonic" way of versioning
a module is by try/except blocks testing to see if variable exist.  I
have however seen this from PEP 8:

Version Bookkeeping

    If you have to have RCS or CVS crud in your source file, do it as
    follows.

        __version__ = "$Revision: 1.20 $"
        # $Source: /cvsroot/python/python/nondist/peps/pep-0008.txt,v $

    These lines should be included after the module's docstring,
    before any other code, separated by a blank line above and
    below.

Which implies to me that __version__ is a pythonic way of versioning a
module/code file, though it doesn't seem to be as standard as __doc__.

Mike

> -----Original Message-----
> From: Gustavo C?rdova Avila [mailto:gustavo.cordova@q-voz.com] 
> Sent: Tuesday, December 02, 2003 1:47 PM
> To: Michael C. Neel
> Cc: mod_python@modpython.org
> Subject: Re: [mod_python] Getting mod_python version
> 
> 
> This is the correct, "pythonic" way of doing things.
> 
> I'd recommend using "except AttributeError:" instead of a naked 
> "except:" btw.
> 
> -gustavo
> 
> Michael C. Neel wrote:
> 
> >Hi all,
> >
> >	I don't know if it's not there, or I'm just overlooking it, but
> >I can seem for a way in code to get the version of 
> mod_python.  I have
> >some "default" modules I use, and I am trying to make them 
> work with any
> >mod_python version.  Right now I'm doing try block, like such:
> >
> >    # Get username/password from client
> >    pw = req.get_basic_auth_pw()
> >    try:
> >        # mod_python 2.x
> >        user = req.connection.user
> >    except:
> >        # mod_python 3.x
> >        user = req.user
> >
> >	...but I'd rather be able to get the version directly.
> >
> >Mike
> >
> >_______________________________________________
> >Mod_python mailing list
> >Mod_python@modpython.org
> >http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> >
> >  
> >
> 
> 

From michael at dynamine.net  Tue Dec  2 11:41:16 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 21:54:04 2004
Subject: [mod_python] Getting mod_python version
In-Reply-To: <C0FC22C08B82074A88B500617641577787A7D4@johnson.mediapulse.net>
References: <C0FC22C08B82074A88B500617641577787A7D4@johnson.mediapulse.net>
Message-ID: <3FCCEADC.9060701@dynamine.net>

Regardless of whether or not __version__ is implemented, using exception 
handling is more robust in the long run, I think.

Forgetting to change the interface version number when a compatibility 
detail has changed is not an unknown phenomenon -- if not with 
mod_python, then certainly with other SDKs.

--Michael

Michael C. Neel wrote:

> Most modules have a __version__ member, and the help() built-in method
> even looks for this variable and uses it to display the version of the
> file:
> 
> 
>>>>import cgi
>>>>cgi.__version__
> 
> '2.6'
> 
>>>>help(cgi)
> 
> ...skipping...
> DATA
>     __all__ = ['MiniFieldStorage', 'FieldStorage', 'FormContentDict',
> 'SvF...
>     __version__ = '2.6'
>     logfile = ''
>     logfp = None
>     maxlen = 0
> 
> VERSION
>     2.6
> 
> 
> 
> I have not read or seen anything saying the "pythonic" way of versioning
> a module is by try/except blocks testing to see if variable exist.  I
> have however seen this from PEP 8:
> 
> Version Bookkeeping
> 
>     If you have to have RCS or CVS crud in your source file, do it as
>     follows.
> 
>         __version__ = "$Revision: 1.20 $"
>         # $Source: /cvsroot/python/python/nondist/peps/pep-0008.txt,v $
> 
>     These lines should be included after the module's docstring,
>     before any other code, separated by a blank line above and
>     below.
> 
> Which implies to me that __version__ is a pythonic way of versioning a
> module/code file, though it doesn't seem to be as standard as __doc__.
> 
> Mike
> 
> 
>>-----Original Message-----
>>From: Gustavo C?rdova Avila [mailto:gustavo.cordova@q-voz.com] 
>>Sent: Tuesday, December 02, 2003 1:47 PM
>>To: Michael C. Neel
>>Cc: mod_python@modpython.org
>>Subject: Re: [mod_python] Getting mod_python version
>>
>>
>>This is the correct, "pythonic" way of doing things.
>>
>>I'd recommend using "except AttributeError:" instead of a naked 
>>"except:" btw.
>>
>>-gustavo
>>
>>Michael C. Neel wrote:
>>
>>
>>>Hi all,
>>>
>>>	I don't know if it's not there, or I'm just overlooking it, but
>>>I can seem for a way in code to get the version of 
>>
>>mod_python.  I have
>>
>>>some "default" modules I use, and I am trying to make them 
>>
>>work with any
>>
>>>mod_python version.  Right now I'm doing try block, like such:
>>>
>>>   # Get username/password from client
>>>   pw = req.get_basic_auth_pw()
>>>   try:
>>>       # mod_python 2.x
>>>       user = req.connection.user
>>>   except:
>>>       # mod_python 3.x
>>>       user = req.user
>>>
>>>	...but I'd rather be able to get the version directly.
>>>
>>>Mike
>>>
>>>_______________________________________________
>>>Mod_python mailing list
>>>Mod_python@modpython.org
>>>http://mailman.modpython.org/mailman/listinfo/mod_python
>>>
>>>
>>> 
>>>
>>
>>
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

From neel at mediapulse.com  Tue Dec  2 14:51:32 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:54:04 2004
Subject: [mod_python] Getting mod_python version
Message-ID: <C0FC22C08B82074A88B50061764157776B9864@johnson.mediapulse.net>

What if something changed every major version, 2 - 5?

with __version__ you could:

	if m.__version__.startswidth('2.'):
		user = m.get2_user()
	elif m.__version__.startswidth('3.'):
		user = m.get3_user()
	elif m.__version__.startswidth('4.'):
		user = m.get4_user()
	elif m.__version__.startswidth('5.'):
		user = m.get5_user()
	else:
		#unsupported version

with try/except:

	try:
		user = m.get2_user()
	except:
		try:
			user = m.get3_user()
		except:
			try:
				user = m.get4_user()
			except:
				try:
					user = m.get5_user()
				except:
					#unsupported version

I'm failing to see why it is supposed to be easier to code/easier to
read with multiple try/except blocks, which are just going to get deeper
as we go.

Mike

> -----Original Message-----
> From: Michael S. Fischer [mailto:michael@dynamine.net] 
> Sent: Tuesday, December 02, 2003 2:41 PM
> To: Michael C. Neel
> Cc: Gustavo C?rdova Avila; mod_python@modpython.org
> Subject: Re: [mod_python] Getting mod_python version
> 
> 
> Regardless of whether or not __version__ is implemented, 
> using exception 
> handling is more robust in the long run, I think.
> 
> Forgetting to change the interface version number when a 
> compatibility 
> detail has changed is not an unknown phenomenon -- if not with 
> mod_python, then certainly with other SDKs.
> 
> --Michael
> 
> Michael C. Neel wrote:
> 
> > Most modules have a __version__ member, and the help() 
> built-in method
> > even looks for this variable and uses it to display the 
> version of the
> > file:
> > 
> > 
> >>>>import cgi
> >>>>cgi.__version__
> > 
> > '2.6'
> > 
> >>>>help(cgi)
> > 
> > ...skipping...
> > DATA
> >     __all__ = ['MiniFieldStorage', 'FieldStorage', 
> 'FormContentDict',
> > 'SvF...
> >     __version__ = '2.6'
> >     logfile = ''
> >     logfp = None
> >     maxlen = 0
> > 
> > VERSION
> >     2.6
> > 
> > 
> > 
> > I have not read or seen anything saying the "pythonic" way 
> of versioning
> > a module is by try/except blocks testing to see if variable 
> exist.  I
> > have however seen this from PEP 8:
> > 
> > Version Bookkeeping
> > 
> >     If you have to have RCS or CVS crud in your source 
> file, do it as
> >     follows.
> > 
> >         __version__ = "$Revision: 1.20 $"
> >         # $Source: 
> /cvsroot/python/python/nondist/peps/pep-0008.txt,v $
> > 
> >     These lines should be included after the module's docstring,
> >     before any other code, separated by a blank line above and
> >     below.
> > 
> > Which implies to me that __version__ is a pythonic way of 
> versioning a
> > module/code file, though it doesn't seem to be as standard 
> as __doc__.
> > 
> > Mike
> > 
> > 
> >>-----Original Message-----
> >>From: Gustavo C?rdova Avila [mailto:gustavo.cordova@q-voz.com] 
> >>Sent: Tuesday, December 02, 2003 1:47 PM
> >>To: Michael C. Neel
> >>Cc: mod_python@modpython.org
> >>Subject: Re: [mod_python] Getting mod_python version
> >>
> >>
> >>This is the correct, "pythonic" way of doing things.
> >>
> >>I'd recommend using "except AttributeError:" instead of a naked 
> >>"except:" btw.
> >>
> >>-gustavo
> >>
> >>Michael C. Neel wrote:
> >>
> >>
> >>>Hi all,
> >>>
> >>>	I don't know if it's not there, or I'm just overlooking it, but
> >>>I can seem for a way in code to get the version of 
> >>
> >>mod_python.  I have
> >>
> >>>some "default" modules I use, and I am trying to make them 
> >>
> >>work with any
> >>
> >>>mod_python version.  Right now I'm doing try block, like such:
> >>>
> >>>   # Get username/password from client
> >>>   pw = req.get_basic_auth_pw()
> >>>   try:
> >>>       # mod_python 2.x
> >>>       user = req.connection.user
> >>>   except:
> >>>       # mod_python 3.x
> >>>       user = req.user
> >>>
> >>>	...but I'd rather be able to get the version directly.
> >>>
> >>>Mike
> >>>
> >>>_______________________________________________
> >>>Mod_python mailing list
> >>>Mod_python@modpython.org
> >>>http://mailman.modpython.org/mailman/listinfo/mod_python
> >>>
> >>>
> >>> 
> >>>
> >>
> >>
> > 
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> > 
> 
> 

From vincent_delft at yahoo.com  Tue Dec  2 11:54:01 2003
From: vincent_delft at yahoo.com (vincent delft)
Date: Fri Jan  9 21:54:04 2004
Subject: [mod_python] does mod_python is ready for production env. ?
Message-ID: <20031202195401.44707.qmail@web11505.mail.yahoo.com>

Sorry to ask this (may be stupid), but I plan to use
mod_python and Draco (see in links of the mod_python
site) on a production environment (a web service that
our enterprise will provide via http servers)


Is there any experience of mod_python on a production
env. ?

What about stability, fiability on a heavy loaded web
site ?

Is there "show stoppers" to use mod_python on a
production env. ?

Thanks 


PS : I'm pythoniac since years, and I definitively
hate php (just a personnal point of view).




__________________________________
Do you Yahoo!?
Free Pop-Up Blocker - Get it now
http://companion.yahoo.com/
From michael at dynamine.net  Tue Dec  2 11:59:05 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 21:54:04 2004
Subject: [mod_python] Getting mod_python version
In-Reply-To: <C0FC22C08B82074A88B50061764157776B9864@johnson.mediapulse.net>
References: <C0FC22C08B82074A88B50061764157776B9864@johnson.mediapulse.net>
Message-ID: <3FCCEF09.6000907@dynamine.net>

I agree that the code looks a little cleaner, but I still think it's 
less robust due to the phenomenon I described.

(Python also makes you use 'elif's instead of 'case' statements, and 
there's something to be said about the ugliness of the former as well. 
Eye of the beholder, I guess.)

Best,

--Michael

Michael C. Neel wrote:

> What if something changed every major version, 2 - 5?
> 
> with __version__ you could:
> 
> 	if m.__version__.startswidth('2.'):
> 		user = m.get2_user()
> 	elif m.__version__.startswidth('3.'):
> 		user = m.get3_user()
> 	elif m.__version__.startswidth('4.'):
> 		user = m.get4_user()
> 	elif m.__version__.startswidth('5.'):
> 		user = m.get5_user()
> 	else:
> 		#unsupported version
> 
> with try/except:
> 
> 	try:
> 		user = m.get2_user()
> 	except:
> 		try:
> 			user = m.get3_user()
> 		except:
> 			try:
> 				user = m.get4_user()
> 			except:
> 				try:
> 					user = m.get5_user()
> 				except:
> 					#unsupported version
> 
> I'm failing to see why it is supposed to be easier to code/easier to
> read with multiple try/except blocks, which are just going to get deeper
> as we go.
> 
> Mike
> 
> 
>>-----Original Message-----
>>From: Michael S. Fischer [mailto:michael@dynamine.net] 
>>Sent: Tuesday, December 02, 2003 2:41 PM
>>To: Michael C. Neel
>>Cc: Gustavo C?rdova Avila; mod_python@modpython.org
>>Subject: Re: [mod_python] Getting mod_python version
>>
>>
>>Regardless of whether or not __version__ is implemented, 
>>using exception 
>>handling is more robust in the long run, I think.
>>
>>Forgetting to change the interface version number when a 
>>compatibility 
>>detail has changed is not an unknown phenomenon -- if not with 
>>mod_python, then certainly with other SDKs.
>>
>>--Michael
>>
>>Michael C. Neel wrote:
>>
>>
>>>Most modules have a __version__ member, and the help() 
>>
>>built-in method
>>
>>>even looks for this variable and uses it to display the 
>>
>>version of the
>>
>>>file:
>>>
>>>
>>>
>>>>>>import cgi
>>>>>>cgi.__version__
>>>
>>>'2.6'
>>>
>>>
>>>>>>help(cgi)
>>>
>>>...skipping...
>>>DATA
>>>    __all__ = ['MiniFieldStorage', 'FieldStorage', 
>>
>>'FormContentDict',
>>
>>>'SvF...
>>>    __version__ = '2.6'
>>>    logfile = ''
>>>    logfp = None
>>>    maxlen = 0
>>>
>>>VERSION
>>>    2.6
>>>
>>>
>>>
>>>I have not read or seen anything saying the "pythonic" way 
>>
>>of versioning
>>
>>>a module is by try/except blocks testing to see if variable 
>>
>>exist.  I
>>
>>>have however seen this from PEP 8:
>>>
>>>Version Bookkeeping
>>>
>>>    If you have to have RCS or CVS crud in your source 
>>
>>file, do it as
>>
>>>    follows.
>>>
>>>        __version__ = "$Revision: 1.20 $"
>>>        # $Source: 
>>
>>/cvsroot/python/python/nondist/peps/pep-0008.txt,v $
>>
>>>    These lines should be included after the module's docstring,
>>>    before any other code, separated by a blank line above and
>>>    below.
>>>
>>>Which implies to me that __version__ is a pythonic way of 
>>
>>versioning a
>>
>>>module/code file, though it doesn't seem to be as standard 
>>
>>as __doc__.
>>
>>>Mike
>>>
>>>
>>>
>>>>-----Original Message-----
>>>>From: Gustavo C?rdova Avila [mailto:gustavo.cordova@q-voz.com] 
>>>>Sent: Tuesday, December 02, 2003 1:47 PM
>>>>To: Michael C. Neel
>>>>Cc: mod_python@modpython.org
>>>>Subject: Re: [mod_python] Getting mod_python version
>>>>
>>>>
>>>>This is the correct, "pythonic" way of doing things.
>>>>
>>>>I'd recommend using "except AttributeError:" instead of a naked 
>>>>"except:" btw.
>>>>
>>>>-gustavo
>>>>
>>>>Michael C. Neel wrote:
>>>>
>>>>
>>>>
>>>>>Hi all,
>>>>>
>>>>>	I don't know if it's not there, or I'm just overlooking it, but
>>>>>I can seem for a way in code to get the version of 
>>>>
>>>>mod_python.  I have
>>>>
>>>>
>>>>>some "default" modules I use, and I am trying to make them 
>>>>
>>>>work with any
>>>>
>>>>
>>>>>mod_python version.  Right now I'm doing try block, like such:
>>>>>
>>>>>  # Get username/password from client
>>>>>  pw = req.get_basic_auth_pw()
>>>>>  try:
>>>>>      # mod_python 2.x
>>>>>      user = req.connection.user
>>>>>  except:
>>>>>      # mod_python 3.x
>>>>>      user = req.user
>>>>>
>>>>>	...but I'd rather be able to get the version directly.
>>>>>
>>>>>Mike
>>>>>
>>>>>_______________________________________________
>>>>>Mod_python mailing list
>>>>>Mod_python@modpython.org
>>>>>http://mailman.modpython.org/mailman/listinfo/mod_python
>>>>>
>>>>>
>>>>>
>>>>>
>>>>
>>>>
>>>_______________________________________________
>>>Mod_python mailing list
>>>Mod_python@modpython.org
>>>http://mailman.modpython.org/mailman/listinfo/mod_python
>>>
>>
>>
> 

From neel at mediapulse.com  Tue Dec  2 15:06:29 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:54:04 2004
Subject: [mod_python] Getting mod_python version
Message-ID: <C0FC22C08B82074A88B50061764157776B9865@johnson.mediapulse.net>

> (Python also makes you use 'elif's instead of 'case' statements, and 
> there's something to be said about the ugliness of the former 
> as well. 
> Eye of the beholder, I guess.)

I agree about the case issue as well, but let us never speak of it
again, lest the python police decend upon our homes in the night...

Mike

From neel at mediapulse.com  Tue Dec  2 15:17:18 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:54:04 2004
Subject: [mod_python] does mod_python is ready for production env. ?
Message-ID: <C0FC22C08B82074A88B500617641577787A7D5@johnson.mediapulse.net>

Yes, mod_python is extreamly viable in a production enviroment.  Draco I
cannot answer for, I tend to use Albatross.

We have used mod_python for several large sites without issue, the
problems have always been our own doing =)

In my personal tests, I found mod_python right behind mod_perl in terms
of speed and ahead of php.  My tests revolved around how I wanted to use
mod_python (big app using a mysql backend on linux), so if you are
worried about speed I recommend you conduct your own benchmarks with the
way you will be using mod_python.  At the time I was new to python, so
I'm sure there were ways to speed up the mod_python test site.

It's worth note that a C module will blow the doors off of a
perl/php/python site.  So if speed is really an issue, C is the way to
go.  If it's not that bad, then in terms of preformance perl/php/python
are all close enough to make it a non-issue.

I hate php as well ;)

Mike

> -----Original Message-----
> From: vincent delft [mailto:vincent_delft@yahoo.com] 
> Sent: Tuesday, December 02, 2003 2:54 PM
> To: mod_python@modpython.org
> Subject: [mod_python] does mod_python is ready for production env. ?
> 
> 
> Sorry to ask this (may be stupid), but I plan to use
> mod_python and Draco (see in links of the mod_python
> site) on a production environment (a web service that
> our enterprise will provide via http servers)
> 
> 
> Is there any experience of mod_python on a production
> env. ?
> 
> What about stability, fiability on a heavy loaded web
> site ?
> 
> Is there "show stoppers" to use mod_python on a
> production env. ?
> 
> Thanks 
> 
> 
> PS : I'm pythoniac since years, and I definitively
> hate php (just a personnal point of view).
> 
> 
> 
> 
> __________________________________
> Do you Yahoo!?
> Free Pop-Up Blocker - Get it now
> http://companion.yahoo.com/
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

From michael at dynamine.net  Tue Dec  2 12:40:24 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 21:54:04 2004
Subject: [mod_python] does mod_python is ready for production env. ?
In-Reply-To: <C0FC22C08B82074A88B500617641577787A7D5@johnson.mediapulse.net>
References: <C0FC22C08B82074A88B500617641577787A7D5@johnson.mediapulse.net>
Message-ID: <3FCCF8B8.90801@dynamine.net>

Michael C. Neel wrote:

> In my personal tests, I found mod_python right behind mod_perl in terms
> of speed and ahead of php.

Did you try the Zend Accelerator module for PHP?  When used, it makes 
PHP an order of magnitude faster.  I'm not kidding.  Simply blows 
mod_perl/mod_python away.

Of course, the upshot is that you'd have to program in PHP to use it :-)

Grisha, it might be an interesting future addition to mod_python to 
cache compiled Python code and access the compiled code via shared 
memory like the Zend Accelerator does -- if that's even possible with 
the Python architecture.

--Michael

From neel at mediapulse.com  Tue Dec  2 15:54:52 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:54:04 2004
Subject: [mod_python] does mod_python is ready for production env. ?
Message-ID: <C0FC22C08B82074A88B500617641577787A7D6@johnson.mediapulse.net>

> Did you try the Zend Accelerator module for PHP?  

No, Zend Accelerator requires fees and licensing, so it kinda ruled
itself out of the running.

> Of course, the upshot is that you'd have to program in PHP to 
> use it :-)

downside?

> 
> Grisha, it might be an interesting future addition to mod_python to 
> cache compiled Python code and access the compiled code via shared 
> memory like the Zend Accelerator does -- if that's even possible with 
> the Python architecture.
> 

Mod_python does this already, just make sure you have PythonDebug Off
(or not set) in your conf.

Mike

From dwmp at opti.cgi.net  Tue Dec  2 15:04:54 2003
From: dwmp at opti.cgi.net (Dan W.)
Date: Fri Jan  9 21:54:04 2004
Subject: [mod_python] does mod_python is ready for production env. ?
In-Reply-To: <C0FC22C08B82074A88B500617641577787A7D6@johnson.mediapulse.
 net>
Message-ID: <5.2.1.1.2.20031202150248.04685f88@mail.pyxos.com>


At 03:54 PM 12/2/2003 -0500, you wrote:
>Mod_python does this already, just make sure you have PythonDebug Off
>(or not set) in your conf.

How does PythonDebug change the execution time?  According to the 
documentation it just writes tracebacks to the output and the log at the 
same time vs. just the log.  Assuming you have no tracebacks in a 
production environment, why does this impact execution speed?

-Dan

From gustavo.cordova at q-voz.com  Tue Dec  2 15:28:00 2003
From: gustavo.cordova at q-voz.com (=?ISO-8859-1?Q?Gustavo_C=F3rdova_Avila?=)
Date: Fri Jan  9 21:54:04 2004
Subject: [mod_python] does mod_python is ready for production env. ?
In-Reply-To: <3FCCF8B8.90801@dynamine.net>
References: <C0FC22C08B82074A88B500617641577787A7D5@johnson.mediapulse.net>
	<3FCCF8B8.90801@dynamine.net>
Message-ID: <3FCD03E0.4010006@q-voz.com>

Michael S. Fischer wrote:

> Michael C. Neel wrote:
>
>> In my personal tests, I found mod_python right behind mod_perl in terms
>> of speed and ahead of php.
>
> Did you try the Zend Accelerator module for PHP?  When used, it makes 
> PHP an order of magnitude faster.  I'm not kidding.  Simply blows 
> mod_perl/mod_python away.
>
> Of course, the upshot is that you'd have to program in PHP to use it :-)
>
> Grisha, it might be an interesting future addition to mod_python to 
> cache compiled Python code and access the compiled code via shared 
> memory like the Zend Accelerator does -- if that's even possible with 
> the Python architecture.
>
> --Michael

You can do something even better from Python, just:

    import psyco
    psyco.profile()

and it'll automatically do some background profiling, and generate 
specialized machine code for any functions worth compiling.  Another 
common invocation is:

    import psyco
    psyco.bind(func1)
    psyco.bind(func2)
    ...

This is when you know which functions are worth compiling, so you 
generate specialized versions immediately, upon module startup.

Psyco's a really nice gem, you can check it out at:

    http://psyco.sourceforge.net/

-gustavo


From neel at mediapulse.com  Tue Dec  2 16:46:45 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:54:04 2004
Subject: [mod_python] does mod_python is ready for production env. ?
Message-ID: <C0FC22C08B82074A88B500617641577787A7D8@johnson.mediapulse.net>

> How does PythonDebug change the execution time?  According to the 
> documentation it just writes tracebacks to the output and the 
> log at the 
> same time vs. just the log.  Assuming you have no tracebacks in a 
> production environment, why does this impact execution speed?
> 

My bad, I looked at the wrong version of a conf file; you want
PythonAutoReload Off and PythonOptimize On.  You don't have to have
these to get modulke cacheing, that's always on, but these speed things
up some.

Mike

From grisha at modpython.org  Tue Dec  2 17:36:03 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:54:04 2004
Subject: [mod_python] does mod_python is ready for production env. ?
In-Reply-To: <3FCCF8B8.90801@dynamine.net>
References: <C0FC22C08B82074A88B500617641577787A7D5@johnson.mediapulse.net>
 <3FCCF8B8.90801@dynamine.net>
Message-ID: <20031202173437.L61463@onyx.ispol.com>


On Tue, 2 Dec 2003, Michael S. Fischer wrote:

> Michael C. Neel wrote:
>
> > In my personal tests, I found mod_python right behind mod_perl in terms
> > of speed and ahead of php.
>
> Did you try the Zend Accelerator module for PHP?

> Simply blows mod_perl/mod_python away.

I doubt it. :-)

Grisha
From vmanera at manord.com  Tue Dec  2 08:54:51 2003
From: vmanera at manord.com (Manera, Villiam)
Date: Fri Jan  9 21:54:04 2004
Subject: R: R: [mod_python]  Problem with Session module with multiple scr
	ipt alias not under t he  document root
Message-ID: <52DC70C1C1575C418CB033523A29CF1410490B@exchange2000.manord.com>

I've already noted the '/' and I tried both with PythonOption
ApplicationPath /script/cgi/cgi-mpy and directly  c.path =
'/script/cgi/cgi-mpy'
But without success.
Only work with path=''.


do you work on windows? I suppose that in windows Session doesn't work
without removing this problem. Any people has a configuration working in
win2000?

Villiam
-----Messaggio originale-----
Da: mod_python-bounces@modpython.org
[mailto:mod_python-bounces@modpython.org]Per conto di Neil Beattie
Inviato: sabato 29 novembre 2003 15.54
A: mod_python@modpython.org
Cc: Manera, Villiam
Oggetto: Re: R: [mod_python] Problem with Session module with multiple
script alias not under t he document root


> I'm sorry but still don't work.
> I'm removed all references to cgi and I moved all my directory with .py
> under document root:
> 
> DocumentRoot "C:/wwwroot/cartelle_sito_mdn"
> <Directory   "C:/wwwroot/cartelle_sito_mdn/script/cgi/cgi-py">
> 
> and with this new configuration req.headers_out:
> {'Set-Cookie': 'pysid=d4d10ab8e7917b43becbff01a2452f7e;
> path=/script/cgi/cgi-mpy/\', 'Cache-Control': 'no-cache="set-cookie"'} 
> and if I relod the page it never passed to req.headers_in


Looks like the path is not correct (extra \)
try adding the following line to your httpd.config  addHandler entry:

PythonOption ApplicationPath /script/cgi/cgi-mpy


I have just had the same problem but have not yet discovered where the extra
\ 
comes from ( it is in _req.hlist.directory in session.py)




> 
> if I modify se session module:
> def make_cookie(self):
> 	....
>       c.path = ''   #dirpath[len(docroot):]
> then req.headers_out become:
> {'Set-Cookie': 'pysid=fb35b851ad27e7effe820c36871bc9b4; path=',
> 'Cache-Control': 'no-cache="set-cookie"'} 
> and If I relod the page it go to req.headers_in:
> {'Cookie': 'pysid=fb35b851ad27e7effe820c36871bc9b4', 'Connection':
> 'Keep-Alive', ...} 
> and req.heades_out : {}
> 
> so why if something else then '' is in path the pysid wasn't writing into
> the html heading? 
> 

Neil Beattie
NB Technology (Pty) Ltd

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python
From cs1spw at bath.ac.uk  Tue Dec  2 17:10:03 2003
From: cs1spw at bath.ac.uk (Simon Willison)
Date: Fri Jan  9 21:54:04 2004
Subject: [mod_python] does mod_python is ready for production env. ?
In-Reply-To: <20031202195401.44707.qmail@web11505.mail.yahoo.com>
References: <20031202195401.44707.qmail@web11505.mail.yahoo.com>
Message-ID: <3FCD1BCB.6020801@bath.ac.uk>

vincent delft wrote:
> PS : I'm pythoniac since years, and I definitively
> hate php (just a personnal point of view).

Reg:	Listen. If you really wanted to use mod_python, you'd have to 
really hate PHP.
Brian:  I do.
Reg:    Oh yeah? How much?
Brian:  A lot!
Reg:    Right. You're in.

(Sorry, couldn't resist it)

From michael at dynamine.net  Tue Dec  2 15:50:15 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 21:54:04 2004
Subject: [mod_python] does mod_python is ready for production env. ?
In-Reply-To: <3FCD03E0.4010006@q-voz.com>
References: <C0FC22C08B82074A88B500617641577787A7D5@johnson.mediapulse.net>
	<3FCCF8B8.90801@dynamine.net> <3FCD03E0.4010006@q-voz.com>
Message-ID: <3FCD2537.2010604@dynamine.net>

Gustavo C?rdova Avila wrote:
> Michael S. Fischer wrote:
>> Grisha, it might be an interesting future addition to mod_python to 
>> cache compiled Python code and access the compiled code via shared 
>> memory like the Zend Accelerator does -- if that's even possible with 
>> the Python architecture.

> You can do something even better from Python, just:
> 
>    import psyco
>    psyco.profile()

Apparently psyco is limited to the i386 platform at this time. 
Unfortunately I'm running on a PowerPC platform (Apple XServe) at my 
present assignment.  :(

--Michael

From davidf at sjsoft.com  Wed Dec  3 07:55:06 2003
From: davidf at sjsoft.com (David Fraser)
Date: Fri Jan  9 21:54:05 2004
Subject: [mod_python] does mod_python is ready for production env. ?
In-Reply-To: <3FCD2537.2010604@dynamine.net>
References: <C0FC22C08B82074A88B500617641577787A7D5@johnson.mediapulse.net>
	<3FCCF8B8.90801@dynamine.net> <3FCD03E0.4010006@q-voz.com>
	<3FCD2537.2010604@dynamine.net>
Message-ID: <3FCD7ABA.3070502@sjsoft.com>

Michael S. Fischer wrote:

> Gustavo C?rdova Avila wrote:
>
>> Michael S. Fischer wrote:
>>
>>> Grisha, it might be an interesting future addition to mod_python to 
>>> cache compiled Python code and access the compiled code via shared 
>>> memory like the Zend Accelerator does -- if that's even possible 
>>> with the Python architecture.
>>
>
>> You can do something even better from Python, just:
>>
>>    import psyco
>>    psyco.profile()
>
>
> Apparently psyco is limited to the i386 platform at this time. 
> Unfortunately I'm running on a PowerPC platform (Apple XServe) at my 
> present assignment.  :(

Armin is working on a platform-independent version, not sure of the 
status, but I think it was working. You could ask on the psyco mailing 
list, he's very helpful, and I'm sure would be grateful for someone 
testing it. Psyco is incredible

David

From jciccale at mac.com  Wed Dec  3 09:40:32 2003
From: jciccale at mac.com (Julian Ciccale)
Date: Fri Jan  9 21:54:05 2004
Subject: [mod_python] does mod_python is ready for production env. ?
Message-ID: <15142387.1070440832400.JavaMail.jciccale@mac.com>

Have you tried pywork ? 
http://pywork.sf.net  (old name was pythonwork)

It's a new web framework we are developing, and it rocks.

We have benchmarked agains other MVC/Template pairs
and it really rocks! It supports XSLT transforms (done in C),
ZPT templates and even lets you write your own View System.

- julcicc -

On Tuesday, December 02, 2003, at 08:54PM, vincent delft <vincent_delft@yahoo.com> wrote:

>Sorry to ask this (may be stupid), but I plan to use
>mod_python and Draco (see in links of the mod_python
>site) on a production environment (a web service that
>our enterprise will provide via http servers)
>
>
>Is there any experience of mod_python on a production
>env. ?
>
>What about stability, fiability on a heavy loaded web
>site ?
>
>Is there "show stoppers" to use mod_python on a
>production env. ?
>
>Thanks 
>
>
>PS : I'm pythoniac since years, and I definitively
>hate php (just a personnal point of view).
>
>
>
>
>__________________________________
>Do you Yahoo!?
>Free Pop-Up Blocker - Get it now
>http://companion.yahoo.com/
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
From vmanera at manord.com  Wed Dec  3 11:49:05 2003
From: vmanera at manord.com (Manera, Villiam)
Date: Fri Jan  9 21:54:05 2004
Subject: R: R: [mod_python]  Problem with Session module with multiple scr
	ipt alias not under t he  document root
Message-ID: <52DC70C1C1575C418CB033523A29CF1497D5C3@exchange2000.manord.com>

I found the way:
with: PythonOption ApplicationPath ' '
in every directory with python module all work fine.

If this is the rigth way it would be better to add in session manual.

Villiam

sorry, the latest test that I made was wrong,
effectively with:
PythonOption ApplicationPath /script/cgi/cgi-mpy 
the script below cgi-mpy working weel, but the script below other directory
doesn't work:
 DocumentRoot "C:/wwwroot/cartelle_sito_mdn"
<Directory   "C:/wwwroot/cartelle_sito_mdn/script/cgi/cgi-py">
	.....
	PythonOption ApplicationPath /script/cgi/cgi-mpy 

<Directory   "C:/wwwroot/cartelle_sito_mdn/script/cgi/studi">
	.....
	PythonOption ApplicationPath /script/cgi/studi 

If I first call an url below studi I'm able to work with all the module
below studi, but any attempt to go in cgi-mpy cause a new
sorry, the latest test that I made was wrong, effectively with 
PythonOption ApplicationPath /script/cgi/cgi-mpy 
the script below cgi-mpy working weel, but the script below other directory
doesn't work:


If I first call an url below studi I'm able to work with all the module
below studi, but any attempt to go in cgi-mpy cause a new Session id

vice versa if I first call a url below cgi-mpy ....

instead with path = '' all work fine, but I don't discovery the way to do it
with 
PythonOption ApplicationPath 
Villiam
-----Messaggio originale-----
Da: mod_python-bounces@modpython.org
[mailto:mod_python-bounces@modpython.org]Per conto di Neil Beattie
Inviato: sabato 29 novembre 2003 15.54
A: mod_python@modpython.org
Cc: Manera, Villiam
Oggetto: Re: R: [mod_python] Problem with Session module with multiple
script alias not under t he document root


> I'm sorry but still don't work.
> I'm removed all references to cgi and I moved all my directory with .py
> under document root:
> 
> DocumentRoot "C:/wwwroot/cartelle_sito_mdn"
> <Directory   "C:/wwwroot/cartelle_sito_mdn/script/cgi/cgi-py">
> 
> and with this new configuration req.headers_out:
> {'Set-Cookie': 'pysid=d4d10ab8e7917b43becbff01a2452f7e;
> path=/script/cgi/cgi-mpy/\', 'Cache-Control': 'no-cache="set-cookie"'} 
> and if I relod the page it never passed to req.headers_in


Looks like the path is not correct (extra \)
try adding the following line to your httpd.config  addHandler entry:

PythonOption ApplicationPath /script/cgi/cgi-mpy


I have just had the same problem but have not yet discovered where the extra
\ 
comes from ( it is in _req.hlist.directory in session.py)




> 
> if I modify se session module:
> def make_cookie(self):
> 	....
>       c.path = ''   #dirpath[len(docroot):]
> then req.headers_out become:
> {'Set-Cookie': 'pysid=fb35b851ad27e7effe820c36871bc9b4; path=',
> 'Cache-Control': 'no-cache="set-cookie"'} 
> and If I relod the page it go to req.headers_in:
> {'Cookie': 'pysid=fb35b851ad27e7effe820c36871bc9b4', 'Connection':
> 'Keep-Alive', ...} 
> and req.heades_out : {}
> 
> so why if something else then '' is in path the pysid wasn't writing into
> the html heading? 
> 

Neil Beattie
NB Technology (Pty) Ltd

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python
From vincent_delft at yahoo.com  Wed Dec  3 12:14:35 2003
From: vincent_delft at yahoo.com (vincent delft)
Date: Fri Jan  9 21:54:05 2004
Subject: [mod_python] does mod_python is ready for production env. ?
In-Reply-To: <15142387.1070440832400.JavaMail.jciccale@mac.com>
Message-ID: <20031203201435.57970.qmail@web11502.mail.yahoo.com>

Thanks to all your feedbacks. 

This prouve me that mod_python is reliable enough for
real production env.

Vincent






--- Julian Ciccale <jciccale@mac.com> wrote:
> Have you tried pywork ? 
> http://pywork.sf.net  (old name was pythonwork)
> 
> It's a new web framework we are developing, and it
> rocks.
> 
> We have benchmarked agains other MVC/Template pairs
> and it really rocks! It supports XSLT transforms
> (done in C),
> ZPT templates and even lets you write your own View
> System.
> 
> - julcicc -
> 
> On Tuesday, December 02, 2003, at 08:54PM, vincent
> delft <vincent_delft@yahoo.com> wrote:
> 
> >Sorry to ask this (may be stupid), but I plan to
> use
> >mod_python and Draco (see in links of the
> mod_python
> >site) on a production environment (a web service
> that
> >our enterprise will provide via http servers)
> >
> >
> >Is there any experience of mod_python on a
> production
> >env. ?
> >
> >What about stability, fiability on a heavy loaded
> web
> >site ?
> >
> >Is there "show stoppers" to use mod_python on a
> >production env. ?
> >
> >Thanks 
> >
> >
> >PS : I'm pythoniac since years, and I definitively
> >hate php (just a personnal point of view).
> >
> >
> >
> >
> >__________________________________
> >Do you Yahoo!?
> >Free Pop-Up Blocker - Get it now
> >http://companion.yahoo.com/
> >_______________________________________________
> >Mod_python mailing list
> >Mod_python@modpython.org
>
>http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> >

__________________________________
Do you Yahoo!?
Free Pop-Up Blocker - Get it now
http://companion.yahoo.com/
From dwmp at opti.cgi.net  Wed Dec  3 17:54:28 2003
From: dwmp at opti.cgi.net (Dan W.)
Date: Fri Jan  9 21:54:05 2004
Subject: [mod_python] 3.1.2b & worker MPM
Message-ID: <5.2.1.1.2.20031203174401.03b996c0@mail.pyxos.com>


I'm running into a weird problem with 3.1.2b and Apache 2.0.47 compiled 
under the worker MPM.  I have two Apache processes, each with 25 
threads.  I have a very simple PSP page which imports a simple .py module 
and prints out a value.  The problem is that the page is only served part 
of the time.  When it is served, it is correct (no tracebacks), but if I do 
a browser reload a couple times it will eventually serve a blank page.  I 
can immediately do a browser reload a few more times and get a few more 
blank pages.  Then if I wait a few seconds and do a browser reload again 
then it will serve up the proper page.

I'm not quite sure how to verify it, but it appears as though one process 
is having a problem with mod_python while the other process is functioning 
properly.  Any suggestions on how I could verify this or other ideas?

I wasn't able to find anything in the documentation on MPM compatibility.

Thanks!

-Dan

From dwmp at opti.cgi.net  Wed Dec  3 21:14:19 2003
From: dwmp at opti.cgi.net (Dan W.)
Date: Fri Jan  9 21:54:05 2004
Subject: [mod_python] PSP bug report
In-Reply-To: <5.2.1.1.2.20031203174401.03b996c0@mail.pyxos.com>
Message-ID: <5.2.1.1.2.20031203210332.02bf6de0@mail.pyxos.com>


It turns out that my problem wasn't related to the worker MPM after 
all.  After minimizing the code down I've found that PSP fails on zero 
element for loops.  The following PSP page should reproduce the problem.

<%
for x in range(0):
     pass
%>
<html>
<body>
Hello world
</body>
</html>


Does the PSP maintainer read this list?

-Dan



At 05:54 PM 12/3/2003 -0600, you wrote:

>I'm running into a weird problem with 3.1.2b and Apache 2.0.47 compiled 
>under the worker MPM.  I have two Apache processes, each with 25 
>threads.  I have a very simple PSP page which imports a simple .py module 
>and prints out a value.  The problem is that the page is only served part 
>of the time.  When it is served, it is correct (no tracebacks), but if I 
>do a browser reload a couple times it will eventually serve a blank 
>page.  I can immediately do a browser reload a few more times and get a 
>few more blank pages.  Then if I wait a few seconds and do a browser 
>reload again then it will serve up the proper page.
>
>I'm not quite sure how to verify it, but it appears as though one process 
>is having a problem with mod_python while the other process is functioning 
>properly.  Any suggestions on how I could verify this or other ideas?
>
>I wasn't able to find anything in the documentation on MPM compatibility.
>
>Thanks!
>
>-Dan
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python

From dwmp at opti.cgi.net  Wed Dec  3 22:15:43 2003
From: dwmp at opti.cgi.net (Dan W.)
Date: Fri Jan  9 21:54:05 2004
Subject: [mod_python] PSP bug report
In-Reply-To: <5.2.1.1.2.20031203210332.02bf6de0@mail.pyxos.com>
References: <5.2.1.1.2.20031203174401.03b996c0@mail.pyxos.com>
Message-ID: <5.2.1.1.2.20031203221244.02b28a20@mail.pyxos.com>


I realized my error too late.  I needed a blank line after the loop.  PSP 
was considering the rest of the page to be part of the loop and since the 
loop did not execute neither did the html.

-Dan



At 09:14 PM 12/3/2003 -0600, you wrote:

>It turns out that my problem wasn't related to the worker MPM after 
>all.  After minimizing the code down I've found that PSP fails on zero 
>element for loops.  The following PSP page should reproduce the problem.
>
><%
>for x in range(0):
>     pass
>%>
>Hello world
>
>Does the PSP maintainer read this list?
>
>-Dan
>
>
>
>At 05:54 PM 12/3/2003 -0600, you wrote:
>
> >I'm running into a weird problem with 3.1.2b and Apache 2.0.47 compiled
> >under the worker MPM.  I have two Apache processes, each with 25
> >threads.  I have a very simple PSP page which imports a simple .py module
> >and prints out a value.  The problem is that the page is only served part
> >of the time.  When it is served, it is correct (no tracebacks), but if I
> >do a browser reload a couple times it will eventually serve a blank
> >page.  I can immediately do a browser reload a few more times and get a
> >few more blank pages.  Then if I wait a few seconds and do a browser
> >reload again then it will serve up the proper page.
> >
> >I'm not quite sure how to verify it, but it appears as though one process
> >is having a problem with mod_python while the other process is functioning
> >properly.  Any suggestions on how I could verify this or other ideas?
> >
> >I wasn't able to find anything in the documentation on MPM compatibility.
> >
> >Thanks!
> >
> >-Dan
> >
> >_______________________________________________
> >Mod_python mailing list
> >Mod_python@modpython.org
> >http://mailman.modpython.org/mailman/listinfo/mod_python
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python

From grisha at modpython.org  Thu Dec  4 01:00:44 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:54:05 2004
Subject: [mod_python] PSP bug report
In-Reply-To: <5.2.1.1.2.20031203221244.02b28a20@mail.pyxos.com>
References: <5.2.1.1.2.20031203174401.03b996c0@mail.pyxos.com>
 <5.2.1.1.2.20031203221244.02b28a20@mail.pyxos.com>
Message-ID: <20031204005846.Y83403@onyx.ispol.com>


I think the best practice is to use a comment rather than a blank line:

<%
for x in range(0):
	pass
# end for
%>

Grisha

On Wed, 3 Dec 2003, Dan W. wrote:

>
> I realized my error too late.  I needed a blank line after the loop.  PSP
> was considering the rest of the page to be part of the loop and since the
> loop did not execute neither did the html.
>
> -Dan
>
>
>
> At 09:14 PM 12/3/2003 -0600, you wrote:
>
> >It turns out that my problem wasn't related to the worker MPM after
> >all.  After minimizing the code down I've found that PSP fails on zero
> >element for loops.  The following PSP page should reproduce the problem.
> >
> ><%
> >for x in range(0):
> >     pass
> >%>
> >Hello world
> >
> >Does the PSP maintainer read this list?
> >
> >-Dan
> >
> >
> >
> >At 05:54 PM 12/3/2003 -0600, you wrote:
> >
> > >I'm running into a weird problem with 3.1.2b and Apache 2.0.47 compiled
> > >under the worker MPM.  I have two Apache processes, each with 25
> > >threads.  I have a very simple PSP page which imports a simple .py module
> > >and prints out a value.  The problem is that the page is only served part
> > >of the time.  When it is served, it is correct (no tracebacks), but if I
> > >do a browser reload a couple times it will eventually serve a blank
> > >page.  I can immediately do a browser reload a few more times and get a
> > >few more blank pages.  Then if I wait a few seconds and do a browser
> > >reload again then it will serve up the proper page.
> > >
> > >I'm not quite sure how to verify it, but it appears as though one process
> > >is having a problem with mod_python while the other process is functioning
> > >properly.  Any suggestions on how I could verify this or other ideas?
> > >
> > >I wasn't able to find anything in the documentation on MPM compatibility.
> > >
> > >Thanks!
> > >
> > >-Dan
> > >
> > >_______________________________________________
> > >Mod_python mailing list
> > >Mod_python@modpython.org
> > >http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> >_______________________________________________
> >Mod_python mailing list
> >Mod_python@modpython.org
> >http://mailman.modpython.org/mailman/listinfo/mod_python
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From Vincent.Raaijmakers at ge.com  Thu Dec  4 07:48:52 2003
From: Vincent.Raaijmakers at ge.com (Raaijmakers, Vincent (IndSys, GE Interlogix))
Date: Fri Jan  9 21:54:05 2004
Subject: [mod_python] Handlers "good practice" question 
Message-ID: <971323274247EB44B9A01D0A3B424C8503F13BDF@FTWMLVEM02.e2k.ad.ge.com>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/gif
Size: 145 bytes
Desc: Blank Bkgrd.gif
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20031204/29f70021/attachment-0001.gif
From vmanera at manord.com  Wed Dec  3 11:28:08 2003
From: vmanera at manord.com (Manera, Villiam)
Date: Fri Jan  9 21:54:05 2004
Subject: R: R: [mod_python]  Problem with Session module with multiple scr
	ipt alias not under t he  document root
Message-ID: <52DC70C1C1575C418CB033523A29CF1410490E@exchange2000.manord.com>

sorry, the latest test that I made was wrong,
effectively with:
PythonOption ApplicationPath /script/cgi/cgi-mpy 
the script below cgi-mpy working weel, but the script below other directory
doesn't work:
 DocumentRoot "C:/wwwroot/cartelle_sito_mdn"
<Directory   "C:/wwwroot/cartelle_sito_mdn/script/cgi/cgi-py">
	.....
	PythonOption ApplicationPath /script/cgi/cgi-mpy 

<Directory   "C:/wwwroot/cartelle_sito_mdn/script/cgi/studi">
	.....
	PythonOption ApplicationPath /script/cgi/studi 

If I first call an url below studi I'm able to work with all the module
below studi, but any attempt to go in cgi-mpy cause a new
sorry, the latest test that I made was wrong, effectively with 
PythonOption ApplicationPath /script/cgi/cgi-mpy 
the script below cgi-mpy working weel, but the script below other directory
doesn't work:


If I first call an url below studi I'm able to work with all the module
below studi, but any attempt to go in cgi-mpy cause a new Session id

vice versa if I first call a url below cgi-mpy ....

instead with path = '' all work fine, but I don't discovery the way to do it
with 
PythonOption ApplicationPath 
Villiam
-----Messaggio originale-----
Da: mod_python-bounces@modpython.org
[mailto:mod_python-bounces@modpython.org]Per conto di Neil Beattie
Inviato: sabato 29 novembre 2003 15.54
A: mod_python@modpython.org
Cc: Manera, Villiam
Oggetto: Re: R: [mod_python] Problem with Session module with multiple
script alias not under t he document root


> I'm sorry but still don't work.
> I'm removed all references to cgi and I moved all my directory with .py
> under document root:
> 
> DocumentRoot "C:/wwwroot/cartelle_sito_mdn"
> <Directory   "C:/wwwroot/cartelle_sito_mdn/script/cgi/cgi-py">
> 
> and with this new configuration req.headers_out:
> {'Set-Cookie': 'pysid=d4d10ab8e7917b43becbff01a2452f7e;
> path=/script/cgi/cgi-mpy/\', 'Cache-Control': 'no-cache="set-cookie"'} 
> and if I relod the page it never passed to req.headers_in


Looks like the path is not correct (extra \)
try adding the following line to your httpd.config  addHandler entry:

PythonOption ApplicationPath /script/cgi/cgi-mpy


I have just had the same problem but have not yet discovered where the extra
\ 
comes from ( it is in _req.hlist.directory in session.py)




> 
> if I modify se session module:
> def make_cookie(self):
> 	....
>       c.path = ''   #dirpath[len(docroot):]
> then req.headers_out become:
> {'Set-Cookie': 'pysid=fb35b851ad27e7effe820c36871bc9b4; path=',
> 'Cache-Control': 'no-cache="set-cookie"'} 
> and If I relod the page it go to req.headers_in:
> {'Cookie': 'pysid=fb35b851ad27e7effe820c36871bc9b4', 'Connection':
> 'Keep-Alive', ...} 
> and req.heades_out : {}
> 
> so why if something else then '' is in path the pysid wasn't writing into
> the html heading? 
> 

Neil Beattie
NB Technology (Pty) Ltd

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python
From neel at mediapulse.com  Thu Dec  4 10:52:09 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:54:05 2004
Subject: [mod_python] Handlers "good practice" question 
Message-ID: <C0FC22C08B82074A88B500617641577787A7DA@johnson.mediapulse.net>

Mod_python (docs) kinda assumes you are familiar with how apache works,
it really just exposing the C API in a python interface for the most
part.  To learn about the apache method of doing things, I'd recommend
reading "Writing Apache Modules in C and Perl" from O'rielly press
(title is something like that).  Language and details differ some, but
the general flow is the same.

Mike


-----Original Message-----
From: Raaijmakers, Vincent (IndSys, GE Interlogix)
[mailto:Vincent.Raaijmakers@ge.com] 
Sent: Thursday, December 04, 2003 8:49 AM
To: mod_python@modpython.org
Subject: [mod_python] Handlers "good practice" question 


I consider myself as a complete newbie with mod_python.  My goal is to
setup a good foundation for my web application using mod_python. Read
all the docs, mail history messages, tried every handler but... 
What I clearly miss is a guideline of a good default structure of the
different handlers. What is good practice? I guess when I try to learn
by trial and error, some structure will come up. I'm also sure that the
documentation I have in my hands will become more clear. It feels like
that mod_python has a lot of excellent soccer players but how to make a
team of it?
Please guru's, where can I find help?
Vincent

From anthony.barker at bmo.com  Thu Dec  4 12:07:49 2003
From: anthony.barker at bmo.com (anthony.barker@bmo.com)
Date: Fri Jan  9 21:54:05 2004
Subject: [mod_python] session management
Message-ID: <OF46341989.F03189B8-ON85256DF2.004D673F@notes.bmo.com>

Do the mod_python sessions work in windows 2000?

It would be nice if the session module was compatible with cgi, so it 
could be used in prototyping situations where the user doesn't have access 
to 
a mod_python enabled apache server....

Anthony
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20031204/9ee164f1/attachment-0001.htm
From conrad at hep.caltech.edu  Thu Dec  4 09:35:46 2003
From: conrad at hep.caltech.edu (Conrad Steenberg)
Date: Fri Jan  9 21:54:05 2004
Subject: [mod_python] PSP bug report
In-Reply-To: <20031204005846.Y83403@onyx.ispol.com>
References: <5.2.1.1.2.20031203174401.03b996c0@mail.pyxos.com>
	 <5.2.1.1.2.20031203221244.02b28a20@mail.pyxos.com>
	 <20031204005846.Y83403@onyx.ispol.com>
Message-ID: <1070559346.13675.37.camel@heppc22.hep.caltech.edu>

Hi Grisha

This may not be a bug, but it could still be worth the effort to make an
%> be considered a newline as well - purely from a support perspective
and the amount of annoyance it might save you and countless new users of
PSP :-)

Cheers

Conrad

On Wed, 2003-12-03 at 22:00, Gregory (Grisha) Trubetskoy wrote:
> I think the best practice is to use a comment rather than a blank line:
> 
> <%
> for x in range(0):
> 	pass
> # end for
> %>
> 
> Grisha
> 
> On Wed, 3 Dec 2003, Dan W. wrote:
> 
> >
> > I realized my error too late.  I needed a blank line after the loop.  PSP
> > was considering the rest of the page to be part of the loop and since the
> > loop did not execute neither did the html.
> >
> > -Dan
> >
> >
> >
> > At 09:14 PM 12/3/2003 -0600, you wrote:
> >
> > >It turns out that my problem wasn't related to the worker MPM after
> > >all.  After minimizing the code down I've found that PSP fails on zero
> > >element for loops.  The following PSP page should reproduce the problem.
> > >
> > ><%
> > >for x in range(0):
> > >     pass
> > >%>
> > >Hello world
> > >
> > >Does the PSP maintainer read this list?
> > >
> > >-Dan
> > >
> > >
> > >
> > >At 05:54 PM 12/3/2003 -0600, you wrote:
> > >
> > > >I'm running into a weird problem with 3.1.2b and Apache 2.0.47 compiled
> > > >under the worker MPM.  I have two Apache processes, each with 25
> > > >threads.  I have a very simple PSP page which imports a simple .py module
> > > >and prints out a value.  The problem is that the page is only served part
> > > >of the time.  When it is served, it is correct (no tracebacks), but if I
> > > >do a browser reload a couple times it will eventually serve a blank
> > > >page.  I can immediately do a browser reload a few more times and get a
> > > >few more blank pages.  Then if I wait a few seconds and do a browser
> > > >reload again then it will serve up the proper page.
> > > >
> > > >I'm not quite sure how to verify it, but it appears as though one process
> > > >is having a problem with mod_python while the other process is functioning
> > > >properly.  Any suggestions on how I could verify this or other ideas?
> > > >
> > > >I wasn't able to find anything in the documentation on MPM compatibility.
> > > >
> > > >Thanks!
> > > >
> > > >-Dan
> > > >
> > > >_______________________________________________
> > > >Mod_python mailing list
> > > >Mod_python@modpython.org
> > > >http://mailman.modpython.org/mailman/listinfo/mod_python
> > >
> > >_______________________________________________
> > >Mod_python mailing list
> > >Mod_python@modpython.org
> > >http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
-- 
Conrad Steenberg <conrad@hep.caltech.edu>

From michael at dynamine.net  Thu Dec  4 09:38:52 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 21:54:05 2004
Subject: [mod_python] session management
In-Reply-To: <OF46341989.F03189B8-ON85256DF2.004D673F@notes.bmo.com>
References: <OF46341989.F03189B8-ON85256DF2.004D673F@notes.bmo.com>
Message-ID: <3FCF712C.3000209@dynamine.net>

I'm confused.  Why would one want to prototype on a system that's not 
identical to the production system?

--Michael

anthony.barker@bmo.com wrote:

> 
> Do the mod_python sessions work in windows 2000?
> 
> It would be nice if the session module was compatible with cgi, so it 
> could be used in prototyping situations where the user doesn't have 
> access to
> a mod_python enabled apache server....
> 
> Anthony
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From dwmp at opti.cgi.net  Thu Dec  4 11:50:06 2003
From: dwmp at opti.cgi.net (Dan W.)
Date: Fri Jan  9 21:54:05 2004
Subject: [mod_python] PSP bug report
In-Reply-To: <1070559346.13675.37.camel@heppc22.hep.caltech.edu>
References: <20031204005846.Y83403@onyx.ispol.com>
 <5.2.1.1.2.20031203174401.03b996c0@mail.pyxos.com>
 <5.2.1.1.2.20031203221244.02b28a20@mail.pyxos.com>
 <20031204005846.Y83403@onyx.ispol.com>
Message-ID: <5.2.1.1.2.20031204114547.02af1930@mail.pyxos.com>


That would eliminate conditional html.  However, it might be interesting if 
PSP had a special directive for conditional html such as two percent signs.

<%%
for x in xrange(10):
%>

-Dan

At 09:35 AM 12/4/2003 -0800, you wrote:
>Hi Grisha
>
>This may not be a bug, but it could still be worth the effort to make an
>%> be considered a newline as well - purely from a support perspective
>and the amount of annoyance it might save you and countless new users of
>PSP :-)
>
>Cheers
>
>Conrad
>
>On Wed, 2003-12-03 at 22:00, Gregory (Grisha) Trubetskoy wrote:
> > I think the best practice is to use a comment rather than a blank line:
> >
> > <%
> > for x in range(0):
> >       pass
> > # end for
> > %>
> >
> > Grisha
> >
> > On Wed, 3 Dec 2003, Dan W. wrote:
> >
> > >
> > > I realized my error too late.  I needed a blank line after the loop.  PSP
> > > was considering the rest of the page to be part of the loop and since the
> > > loop did not execute neither did the html.
> > >
> > > -Dan
> > >
> > >
> > >
> > > At 09:14 PM 12/3/2003 -0600, you wrote:
> > >
> > > >It turns out that my problem wasn't related to the worker MPM after
> > > >all.  After minimizing the code down I've found that PSP fails on zero
> > > >element for loops.  The following PSP page should reproduce the problem.
> > > >
> > > ><%
> > > >for x in range(0):
> > > >     pass
> > > >%>
> > > >Hello world
> > > >
> > > >Does the PSP maintainer read this list?
> > > >
> > > >-Dan
> > > >
> > > >
> > > >
> > > >At 05:54 PM 12/3/2003 -0600, you wrote:
> > > >
> > > > >I'm running into a weird problem with 3.1.2b and Apache 2.0.47 
> compiled
> > > > >under the worker MPM.  I have two Apache processes, each with 25
> > > > >threads.  I have a very simple PSP page which imports a simple .py 
> module
> > > > >and prints out a value.  The problem is that the page is only 
> served part
> > > > >of the time.  When it is served, it is correct (no tracebacks), 
> but if I
> > > > >do a browser reload a couple times it will eventually serve a blank
> > > > >page.  I can immediately do a browser reload a few more times and 
> get a
> > > > >few more blank pages.  Then if I wait a few seconds and do a browser
> > > > >reload again then it will serve up the proper page.
> > > > >
> > > > >I'm not quite sure how to verify it, but it appears as though one 
> process
> > > > >is having a problem with mod_python while the other process is 
> functioning
> > > > >properly.  Any suggestions on how I could verify this or other ideas?
> > > > >
> > > > >I wasn't able to find anything in the documentation on MPM 
> compatibility.
> > > > >
> > > > >Thanks!
> > > > >
> > > > >-Dan
> > > > >
> > > > >_______________________________________________
> > > > >Mod_python mailing list
> > > > >Mod_python@modpython.org
> > > > >http://mailman.modpython.org/mailman/listinfo/mod_python
> > > >
> > > >_______________________________________________
> > > >Mod_python mailing list
> > > >Mod_python@modpython.org
> > > >http://mailman.modpython.org/mailman/listinfo/mod_python
> > >
> > > _______________________________________________
> > > Mod_python mailing list
> > > Mod_python@modpython.org
> > > http://mailman.modpython.org/mailman/listinfo/mod_python
> > >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
>--
>Conrad Steenberg <conrad@hep.caltech.edu>

From conrad at hep.caltech.edu  Thu Dec  4 10:04:12 2003
From: conrad at hep.caltech.edu (Conrad Steenberg)
Date: Fri Jan  9 21:54:05 2004
Subject: [mod_python] PSP bug report
In-Reply-To: <5.2.1.1.2.20031204114547.02af1930@mail.pyxos.com>
References: <20031204005846.Y83403@onyx.ispol.com>
	 <5.2.1.1.2.20031203174401.03b996c0@mail.pyxos.com>
	 <5.2.1.1.2.20031203221244.02b28a20@mail.pyxos.com>
	 <20031204005846.Y83403@onyx.ispol.com>
	 <5.2.1.1.2.20031204114547.02af1930@mail.pyxos.com>
Message-ID: <1070561052.13675.62.camel@heppc22.hep.caltech.edu>

Hi

Hmmm, you're right, I should have read the documentation again before
posting that. Treating %> as an unindent would also eliminate the
looping html construct.

Cheers

Conrad

On Thu, 2003-12-04 at 09:50, Dan W. wrote:
> That would eliminate conditional html.  However, it might be interesting if 
> PSP had a special directive for conditional html such as two percent signs.
> 
> <%%
> for x in xrange(10):
> %>
> 
> -Dan
> 
> At 09:35 AM 12/4/2003 -0800, you wrote:
> >Hi Grisha
> >
> >This may not be a bug, but it could still be worth the effort to make an
> >%> be considered a newline as well - purely from a support perspective
> >and the amount of annoyance it might save you and countless new users of
> >PSP :-)
> >
> >Cheers
> >
> >Conrad
> >
> >On Wed, 2003-12-03 at 22:00, Gregory (Grisha) Trubetskoy wrote:
> > > I think the best practice is to use a comment rather than a blank line:
> > >
> > > <%
> > > for x in range(0):
> > >       pass
> > > # end for
> > > %>
> > >
> > > Grisha
> > >
> > > On Wed, 3 Dec 2003, Dan W. wrote:
> > >
> > > >
> > > > I realized my error too late.  I needed a blank line after the loop.  PSP
> > > > was considering the rest of the page to be part of the loop and since the
> > > > loop did not execute neither did the html.
> > > >
> > > > -Dan
> > > >
> > > >
> > > >
> > > > At 09:14 PM 12/3/2003 -0600, you wrote:
> > > >
> > > > >It turns out that my problem wasn't related to the worker MPM after
> > > > >all.  After minimizing the code down I've found that PSP fails on zero
> > > > >element for loops.  The following PSP page should reproduce the problem.
> > > > >
> > > > ><%
> > > > >for x in range(0):
> > > > >     pass
> > > > >%>
> > > > >Hello world
> > > > >
> > > > >Does the PSP maintainer read this list?
> > > > >
> > > > >-Dan
> > > > >
> > > > >
> > > > >
> > > > >At 05:54 PM 12/3/2003 -0600, you wrote:
> > > > >
> > > > > >I'm running into a weird problem with 3.1.2b and Apache 2.0.47 
> > compiled
> > > > > >under the worker MPM.  I have two Apache processes, each with 25
> > > > > >threads.  I have a very simple PSP page which imports a simple .py 
> > module
> > > > > >and prints out a value.  The problem is that the page is only 
> > served part
> > > > > >of the time.  When it is served, it is correct (no tracebacks), 
> > but if I
> > > > > >do a browser reload a couple times it will eventually serve a blank
> > > > > >page.  I can immediately do a browser reload a few more times and 
> > get a
> > > > > >few more blank pages.  Then if I wait a few seconds and do a browser
> > > > > >reload again then it will serve up the proper page.
> > > > > >
> > > > > >I'm not quite sure how to verify it, but it appears as though one 
> > process
> > > > > >is having a problem with mod_python while the other process is 
> > functioning
> > > > > >properly.  Any suggestions on how I could verify this or other ideas?
> > > > > >
> > > > > >I wasn't able to find anything in the documentation on MPM 
> > compatibility.
> > > > > >
> > > > > >Thanks!
> > > > > >
> > > > > >-Dan
> > > > > >
> > > > > >_______________________________________________
> > > > > >Mod_python mailing list
> > > > > >Mod_python@modpython.org
> > > > > >http://mailman.modpython.org/mailman/listinfo/mod_python
> > > > >
> > > > >_______________________________________________
> > > > >Mod_python mailing list
> > > > >Mod_python@modpython.org
> > > > >http://mailman.modpython.org/mailman/listinfo/mod_python
> > > >
> > > > _______________________________________________
> > > > Mod_python mailing list
> > > > Mod_python@modpython.org
> > > > http://mailman.modpython.org/mailman/listinfo/mod_python
> > > >
> > > _______________________________________________
> > > Mod_python mailing list
> > > Mod_python@modpython.org
> > > http://mailman.modpython.org/mailman/listinfo/mod_python
> >--
> >Conrad Steenberg <conrad@hep.caltech.edu>
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
-- 
Conrad Steenberg <conrad@hep.caltech.edu>

From Vincent.Raaijmakers at ge.com  Thu Dec  4 16:21:34 2003
From: Vincent.Raaijmakers at ge.com (Raaijmakers, Vincent (IndSys, GE Interlogix))
Date: Fri Jan  9 21:54:05 2004
Subject: [mod_python] Handlers "good practice" question
Message-ID: <971323274247EB44B9A01D0A3B424C8503FF22A2@FTWMLVEM02.e2k.ad.ge.com>

Thanks, 

but please bring me up to speed. I read the information on the web. Do I have to see pywork as a replacement or add-on for all the Handlers of mod_python?
I mean, the default handlers are also a mechanism to go from web -> python code.

Well, perhaps this question shows my newbie level.

Also, based on the other responses, I definitely going to read the O'Reilly book about "Writing Apache Modules in C and Perl"


Vincent

-----Original Message-----
From: Julian Ciccale [mailto:jciccale@mac.com]
Sent: Thursday, December 04, 2003 9:32 AM
To: Raaijmakers, Vincent (IndSys, GE Interlogix)
Subject: Re: [mod_python] Handlers "good practice" question


I suggest you using a web framework on top of mod_python great foundations!

Try PyWork from http://pywork.sf.net , there is also draco and albatross.


On Thursday, December 04, 2003, at 02:48PM, Raaijmakers, Vincent (IndSys, GE Interlogix) <Vincent.Raaijmakers@ge.com> wrote:

>
><<Original Attached>>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python
>
>

From grisha at modpython.org  Thu Dec  4 22:51:53 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:54:05 2004
Subject: [mod_python] session management
In-Reply-To: <OF46341989.F03189B8-ON85256DF2.004D673F@notes.bmo.com>
References: <OF46341989.F03189B8-ON85256DF2.004D673F@notes.bmo.com>
Message-ID: <20031204224817.G97860@onyx.ispol.com>


On Thu, 4 Dec 2003 anthony.barker@bmo.com wrote:

> Do the mod_python sessions work in windows 2000?

I think it does, but if you read the recent "Problem with Session module
with multiple..." thread, it appears there is a bug with the way the path
is provided in the cookies on Windows in the latest beta version.

But, aside from that, the answer is "yes" ;-)

> It would be nice if the session module was compatible with cgi,
> so it could be used in prototyping situations where the user doesn't
> have access to a mod_python enabled apache server....

Cgi and mod_python are worlds apart, it makes no sense to find a
compromize between them.

Grisha
From jciccale at mac.com  Fri Dec  5 08:44:14 2003
From: jciccale at mac.com (Julian Ciccale)
Date: Fri Jan  9 21:54:05 2004
Subject: [mod_python] Handlers "good practice" question
Message-ID: <12818729.1070610254969.JavaMail.jciccale@mac.com>


>but please bring me up to speed. I read the information on the web. Do I have to see pywork as a 
>replacement or add-on for all the Handlers of mod_python?

In this case its a mod_python handler, so it would be a replacement


>I mean, the default handlers are also a mechanism to go from web -> python code.

Yes all the default python handlers are a mechanism to gor from web to python code and are really fast.

>Also, based on the other responses, I definitely going to read the O'Reilly book about "Writing 
> Apache Modules in C and Perl"

I don't see why you should write modules in C and Perl to write a web application. ModPython offers
much more flexibility and power and ModPython *IS* an Apache C Module, your applications, IMHO should be written in a higher level language, and only if you really need very high performance, you could rewrite some of your application's modules in C.

To get to know mod_python I think you could begin to understand the Publisher handler and if you are more lazy then try PSP..

In any case if you will start a big project I strongly suggest you to use some MVC/templating library.

- julcicc -
From gdamjan at mail.net.mk  Fri Dec  5 13:25:24 2003
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 21:54:05 2004
Subject: [mod_python] Mod_python disables mod_dav
In-Reply-To: <20031127054340.GA3835@legolas.on.net.mk>
References: <20031127054340.GA3835@legolas.on.net.mk>
Message-ID: <20031205122524.GA16632@legolas.on.net.mk>

> I'm using Apache 2.0.48 (it happened to 2.0.47 too) with the built-in
> mod_dav module and mod_python 3.1.2b/Python-2.3.2 and PHP/4.3.4.
> 
> I can't understand why but unless I disable mod_python (by commenting
> the LoadModule directive), DAV will not work. It just returns a "405
> Method is not allowed" error. 
> 
> I've tried different DAV setups and clients, and nothing - unless I
> disable mod_python it wont work...
> 
> Now I think that with older versions of mod_python this did not happen -
> but I'm not sure. I'll have to recheck that.
> 
> Does anyone know why this could happen?!?

Any ideas? Can at least, someone confirm my problem?
btw
I'm using "Slackware Linux 9.1"

-- 
Damjan Georgievski
jabberID: damjan@bagra.net.mk
From neel at mediapulse.com  Fri Dec  5 10:39:00 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:54:05 2004
Subject: [mod_python] Handlers "good practice" question
Message-ID: <C0FC22C08B82074A88B500617641577787A7DF@johnson.mediapulse.net>

> >Also, based on the other responses, I definitely going to 
> read the O'Reilly book about "Writing 
> > Apache Modules in C and Perl"
> 
> I don't see why you should write modules in C and Perl to 
> write a web application. ModPython offers
> much more flexibility and power and ModPython *IS* an Apache 
> C Module, your applications, IMHO should be written in a 
> higher level language, and only if you really need very high 
> performance, you could rewrite some of your application's 
> modules in C.
> 

I think you missed some of the thread. The point of recommending the
book is not to learn how write module in C or Perl, but to learn how
apache works.  AFAIK this is the only book out there that details the
Apache API, but even in it's dated state it's very useful.  Somethings
this book helped make clear for me was the difference between
authorization and authencation, how to have multiple handlers on the
same request in apache 1.3 (or why fixup handlers always return false),
and that all log handlers are called that are registered for a request.

Mike

From barry at python.org  Fri Dec  5 10:59:53 2003
From: barry at python.org (Barry Warsaw)
Date: Fri Jan  9 21:54:05 2004
Subject: [mod_python] mod_python ignoring --with-python?
Message-ID: <1070639992.1377.6.camel@anthem>

I have a very strange problem which I don't quite understand.  I'm on a
RH9 system, with an Apache 2.0.48 built in a non-standard location, and
a Python 2.3.2 built in a non-standard location.  So when I configure
mod_python 3.0.4, I use --with-apxs to point at my non-standard Apache's
bin/apxs, and --with-python to point at my non-standard python
executable.  make ; make install and everything appears to go in the
right places.

Now I start up Apache doing something like:

% cd non/standard/location
% sudo bin/httpd -DONE_PROCESS

However, it appears as if mod_python is still using the first Python on
my $PATH instead of the one I used to configure --with-python.  I can
tell this because 1) if mod_python isn't installed in my $PATH Python,
Apache will throw a server error saying it couldn't import
mod_python.apache; 2) if I strace httpd I can see it's trying to do tons
of imports from /usr/local (where my $PATH Python is installed).

So either I misunderstand how --with-python is supposed to work, or this
is a bug, or it's a missing feature. ;).  Shouldn't mod_python honor
--with-python and ignore $PATH python?

Thanks for any light you can shed.  Let me know if you need more
information.
-Barry


From jciccale at mac.com  Fri Dec  5 17:31:16 2003
From: jciccale at mac.com (Julian Ciccale)
Date: Fri Jan  9 21:54:05 2004
Subject: [mod_python] Handlers "good practice" question
Message-ID: <702685.1070641876421.JavaMail.jciccale@mac.com>

 I think you are right, it seems I missed something. However the httpd apache documentation, as well as the APR documentation for 2.0.x are very good starting points to get to know apache internals.
 
On Friday, December 05, 2003, at 04:39PM, Michael C. Neel <neel@mediapulse.com> wrote:

>> >Also, based on the other responses, I definitely going to 
>> read the O'Reilly book about "Writing 
>> > Apache Modules in C and Perl"
>> 
>> I don't see why you should write modules in C and Perl to 
>> write a web application. ModPython offers
>> much more flexibility and power and ModPython *IS* an Apache 
>> C Module, your applications, IMHO should be written in a 
>> higher level language, and only if you really need very high 
>> performance, you could rewrite some of your application's 
>> modules in C.
>> 
>
>I think you missed some of the thread. The point of recommending the
>book is not to learn how write module in C or Perl, but to learn how
>apache works.  AFAIK this is the only book out there that details the
>Apache API, but even in it's dated state it's very useful.  Somethings
>this book helped make clear for me was the difference between
>authorization and authencation, how to have multiple handlers on the
>same request in apache 1.3 (or why fixup handlers always return false),
>and that all log handlers are called that are registered for a request.
>
>Mike
>
>
From JTesser at nbbc.edu  Sun Dec  7 17:44:57 2003
From: JTesser at nbbc.edu (Jason Tesser)
Date: Fri Jan  9 21:54:05 2004
Subject: [mod_python] Python CMS with PgSQL
Message-ID: <04875CB4331F0240A0AD66F970978651160A5D@paul>

I am thinking about developing a CMS with Python and Postgres.  I am developing
on a Linux box with Apache 2.  I have used PHP in the past but my at work we are
considering going with Python as our main devellopment language.  A few
questions for you guys.

1. Is it best to just develop in all Pyhton or to use a mixture of PHP and Python? 
Why orther than personal feelings?

2. What is the best way to template using Python for me to seperate content 
from logic?  All the data that will be displayed in dynamic so I am not sure 
what the best way to template it would be in Python.

Thank you for any thoughts offered.

From damon at asianreflection.com  Mon Dec  8 22:45:45 2003
From: damon at asianreflection.com (Damon Lynch)
Date: Fri Jan  9 21:54:05 2004
Subject: [mod_python] Python CMS with PgSQL
In-Reply-To: <04875CB4331F0240A0AD66F970978651160A5D@paul>
References: <04875CB4331F0240A0AD66F970978651160A5D@paul>
Message-ID: <1070876744.24987.76.camel@damon.asianreflection.com>

On Mon, 2003-12-08 at 12:44, Jason Tesser wrote:

> 2. What is the best way to template using Python for me to seperate content 
> from logic?  All the data that will be displayed in dynamic so I am not sure 
> what the best way to template it would be in Python.

(I realize this is a mod_python list but...)

http://www.plone.org/documentation/zpt1 has some interesting ideas worth
a read.

HTH,
Damon

From petri.savolainen at iki.fi  Mon Dec  8 14:38:59 2003
From: petri.savolainen at iki.fi (Petri Savolainen)
Date: Fri Jan  9 21:54:05 2004
Subject: [mod_python] Re: Python CMS with PgSQL
In-Reply-To: <04875CB4331F0240A0AD66F970978651160A5D@paul>
References: <04875CB4331F0240A0AD66F970978651160A5D@paul>
Message-ID: <br1r9v$pct$1@sea.gmane.org>

Jason Tesser wrote:

> I am thinking about developing a CMS with Python and Postgres.  I am developing
> on a Linux box with Apache 2.  I have used PHP in the past but my at work we are
> considering going with Python as our main devellopment language.  A few
> questions for you guys.

Don't reinvent the wheel. Building your own CMS is not a good idea 
unless none of the existing "CMS type" web frameworks do what you need - 
which would be very surprising as there are dozens of them for both PHP 
and Python; do a bit of research and pick one that suits your needs 
best. For python, Zope is the largest and most difficult for someone 
coming from PHP world. There are also many alternatives to a full-blown 
CMS that you may find yourself more comfortable with, such as mod_python 
:-) Also be very careful when you see the word CMS used about a platform 
or product... it is used ultra-liberally in the industry.

> 1. Is it best to just develop in all Pyhton or to use a mixture of PHP and Python? 
> Why orther than personal feelings?

Don't mix languages unless you have to. Keep it simple if you can.

Much of the language issue is nonsense; more important is what is your 
company development model and style than the language that is used. For 
simple (in terms of code complexity and amount of lines) web apps and 
sites, whether you do apache + php + sql is not really that much 
different from apache + mod_python + sql. Both shine doing what they are 
supposed to.

However, if you are moving towards building large systems, or develop 
actual software products, you will find out there are things that are 
not well supported in php or that you simply cannot do.

> 2. What is the best way to template using Python for me to seperate content 
> from logic?  All the data that will be displayed in dynamic so I am not sure 
> what the best way to template it would be in Python.

I would recommend Page Templates; the technology originates from Zope, 
but there are standalone libraries you can use with mod_python, such as 
SimpleTAL/TALES and OpenTAL, and probably others. Note that there is 
also an implementation for PHP that you may find interesting.

I have not tried the templating system being developed for mod_python; 
if you're considering mod_python, you should also try its native 
templating system.

Hope that helps,

  Petri

From JTesser at nbbc.edu  Mon Dec  8 14:44:11 2003
From: JTesser at nbbc.edu (Jason Tesser)
Date: Fri Jan  9 21:54:05 2004
Subject: [mod_python] Re: Python CMS with PgSQL
Message-ID: <04875CB4331F0240A0AD66F970978651160A61@paul>

<snip>

> Don't reinvent the wheel. Building your own CMS is not a good idea 
> unless none of the existing "CMS type" web frameworks do what you need - 
> which would be very surprising as there are dozens of them for both PHP 
> and Python; do a bit of research and pick one that suits your needs 
> best. For python, Zope is the largest and most difficult for someone 
> coming from PHP world. There are also many alternatives to a full-blown 
> CMS that you may find yourself more comfortable with, such as mod_python 
> :-) Also be very careful when you see the word CMS used about a platform 
> or product... it is used ultra-liberally in the industry.

I have looked at all the ones I know of but they all lack some of the features or
control I need.  I need to have a lot of users changing and editing content 
(text only) and it all goes to an editor.  All layout, graphics and photos need 
to be filtered through a different person.  Some types of content ie news needs to 
be approved by a vice president.  Zope can be extended to do all this but with
what I would need to do to extend it I might as customize it and write it
myself.  I do have a little experience with Python as I have written a POS
system in it.  The CMS I need will eventually even handle online registration as
I work for a Bible College.  I don't see it as reinventing the wheel I just 
don't like being tied down to a framework.  That is why I don't like Websphere
or J2ee.  

<snip>

> I have not tried the templating system being developed for mod_python; 
> if you're considering mod_python, you should also try its native 
> templating system.

What is mod_python's templating system?  Is it PSP.  I am trying to get PSP working
now and I cannot seem to get it to work.  I am using mod_python 3.01 with apache 2
on a RH9 box.  When I goto the page I just get the psp code?  :-s  Any ideas?


_____________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python

From JTesser at nbbc.edu  Mon Dec  8 14:50:46 2003
From: JTesser at nbbc.edu (Jason Tesser)
Date: Fri Jan  9 21:54:06 2004
Subject: [mod_python] PSP how to????
Message-ID: <04875CB4331F0240A0AD66F970978651011376FA@paul>

OK can someone please explain to me how to get Apache 2 with mod_python 3.01 to recogize xxxx.psp pages?
I am just a poor programmer and my system admin skills need help :-) 

From conrad at hep.caltech.edu  Mon Dec  8 13:29:24 2003
From: conrad at hep.caltech.edu (Conrad Steenberg)
Date: Fri Jan  9 21:54:06 2004
Subject: [mod_python] PSP how to????
In-Reply-To: <04875CB4331F0240A0AD66F970978651011376FA@paul>
References: <04875CB4331F0240A0AD66F970978651011376FA@paul>
Message-ID: <1070918964.23133.5.camel@heppc22.hep.caltech.edu>

Hi Jason

You need a newer version: 3.1.x, with the newest being 3.1.2b on
www.modpython.org

Cheers

Conrad

On Mon, 2003-12-08 at 12:50, Jason Tesser wrote:
> OK can someone please explain to me how to get Apache 2 with mod_python 3.01 to recogize xxxx.psp pages?
> I am just a poor programmer and my system admin skills need help :-) 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
-- 
Conrad Steenberg <conrad@hep.caltech.edu>

From neel at mediapulse.com  Mon Dec  8 16:33:45 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:54:06 2004
Subject: [mod_python] Re: Python CMS with PgSQL
Message-ID: <C0FC22C08B82074A88B500617641577787A7E2@johnson.mediapulse.net>

> > Don't reinvent the wheel. Building your own CMS is not a good idea 
> > unless none of the existing "CMS type" web frameworks do 
> what you need - 
> 
> I have looked at all the ones I know of but they all lack 
> some of the features or
> control I need. 

I can understan this, there are a lot of CMS apps out there but none of
these wheels ever seem "round" when you need one =p.

Tools that I know of:

mod_python comes with psp (with 3.x); this is very new atm, so things
may change as it grows and might cause you some headache with backwards
compatibility.  The worst setup I could see is needing to patch
mod_pyhton for a fix, but not wanting the latest version of PSP that
comes with it.  This is also partly me; I usally don't look deeply into
something until it's stood at least a year - so I know it will be
around.

For mod_python you can also get Draco (http://draco.boskant.nl/) or
Spyce (http://spyce.sourceforge.net/).  Both of these are close to the
way PSP works; spyce more so that Draco.  Draco allows for code to be in
a separate file, which might lend itself to larger projects better.

There is also Albatross
(http://www.object-craft.com.au/projects/albatross/), which works for
mod_python, CGI, and in a standalone webserver.  Albatross extends along
the same lines as Draco, but instead of placing raw python in templates
it uses an XML-like tag language of al- and alx- tags.  Albatross can
also store it's session objects client side, server side, or on a
session server to support clusterd websites.

For down and dirty, quick and cheap, there is ezt
(http://svn.webdav.org/repos/projects/subwiki/trunk/lib/ezt.py), which
isn't a project to itself, but I've found useful when all I needed was
some %s magic with a bit more control (i.e. ifs and loops).

There are more I'm sure, but those are the ones stuck in my head.  I use
ezt and/or Albatross myself, each for about a year now.  I recommend
playing with each one, seeing which one works best in your enviroment,
then going with it.

Have fun,
Mike

From JTesser at nbbc.edu  Mon Dec  8 16:31:47 2003
From: JTesser at nbbc.edu (Jason Tesser)
Date: Fri Jan  9 21:54:06 2004
Subject: [mod_python] PSP how to????
Message-ID: <04875CB4331F0240A0AD66F970978651160A62@paul>

Is that release stable???


-----Original Message-----
From:	Conrad Steenberg [mailto:conrad@hep.caltech.edu]
Sent:	Mon 12/8/2003 3:29 PM
To:	Jason Tesser
Cc:	Mod_Python (E-mail)
Subject:	Re: [mod_python] PSP how to????
Hi Jason

You need a newer version: 3.1.x, with the newest being 3.1.2b on
www.modpython.org

Cheers

Conrad

On Mon, 2003-12-08 at 12:50, Jason Tesser wrote:
> OK can someone please explain to me how to get Apache 2 with mod_python 3.01 to recogize xxxx.psp pages?
> I am just a poor programmer and my system admin skills need help :-) 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
-- 
Conrad Steenberg <conrad@hep.caltech.edu>






From Brian.Parkinson at quest.com  Mon Dec  8 17:44:44 2003
From: Brian.Parkinson at quest.com (Brian Parkinson)
Date: Fri Jan  9 21:54:06 2004
Subject: [mod_python] Help getting mod_python set up on Windows/Apache
Message-ID: <46C5DCD410224A42BE3151AC8AE75E4E016E091B@tormbxw01.prod.quest.corp>

Hello:

I am trying to get mod_python working, and for the life of me I'm
stumped.

Version of Python: 2.2
Version of Apache: 2.0.48
Version of mod_python: 3.0.4

Here is the bit from my http.conf file in the Apache dist:

LoadModule python_module modules/mod_python.so

<Directory "C:/home/web/docs/"> 
  AddHandler python-program .py
  PythonHandler test 
  PythonDebug On 
</Directory>

I have a file called C:/home/web/docs/test.py and it contains:

from mod_python import apache

def handler(req):
    req.write("Hello World!")
    return apache.OK

When I re-start Apache, and then enter the URL to the test.py
file (http://localhost/test.py) the following is my log message:

[Mon Dec 08 14:40:03 2003] [notice] Parent: Created child process 2188
[Mon Dec 08 14:40:03 2003] [notice] Child 2188: Child process is running
[Mon Dec 08 14:40:03 2003] [notice] Child 2188: Acquired the start
mutex.
[Mon Dec 08 14:40:03 2003] [notice] Child 2188: Starting 250 worker
threads.
[Mon Dec 08 14:40:16 2003] [error] make_obcallback: could not import
mod_python.apache.


Agh!

Can anyone help me? This seems to close, but yet so far.

Thanks,

parki...



From grisha at modpython.org  Mon Dec  8 21:05:18 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:54:06 2004
Subject: [mod_python] Python CMS with PgSQL
In-Reply-To: <04875CB4331F0240A0AD66F970978651160A5D@paul>
References: <04875CB4331F0240A0AD66F970978651160A5D@paul>
Message-ID: <20031208210414.X60503@onyx.ispol.com>



On Sun, 7 Dec 2003, Jason Tesser wrote:

> 1. Is it best to just develop in all Pyhton or to use a mixture of PHP
> and Python?

This may sound too simple, but I recommend you stick to Python only, for
everything. :-)

Grisha
From scott_list at mischko.com  Mon Dec  8 22:06:53 2003
From: scott_list at mischko.com (Scott Chapman)
Date: Fri Jan  9 21:54:06 2004
Subject: [mod_python] PSP how to????
In-Reply-To: <04875CB4331F0240A0AD66F970978651160A62@paul>
References: <04875CB4331F0240A0AD66F970978651160A62@paul>
Message-ID: <200312082206.53039.scott_list@mischko.com>

On Monday 08 December 2003 14:31, Jason Tesser wrote:
> Is that release stable???

Yes.  It seems very good.  By the time you get to production, there will 
likely be a new version out anyway.  :-)

P.S. I prefer Draco. It's design strikes me as very elegant.  I've made 
mods such as making the templates so that they are able to be read from 
a hash variable rather than a file.  This provides a great deal of 
flexibility.  It's a very nice tool set.

Get Draco from CVS, not the production version, for use with 3.1.2b.

Scott

From davidf at sjsoft.com  Tue Dec  9 11:26:23 2003
From: davidf at sjsoft.com (David Fraser)
Date: Fri Jan  9 21:54:06 2004
Subject: [mod_python] Re: Python CMS with PgSQL
In-Reply-To: <04875CB4331F0240A0AD66F970978651160A61@paul>
References: <04875CB4331F0240A0AD66F970978651160A61@paul>
Message-ID: <3FD5953F.4050709@sjsoft.com>

Jason Tesser wrote:

><snip>
>
>  
>
>>Don't reinvent the wheel. Building your own CMS is not a good idea 
>>unless none of the existing "CMS type" web frameworks do what you need - 
>>which would be very surprising as there are dozens of them for both PHP 
>>and Python; do a bit of research and pick one that suits your needs 
>>best. For python, Zope is the largest and most difficult for someone 
>>coming from PHP world. There are also many alternatives to a full-blown 
>>CMS that you may find yourself more comfortable with, such as mod_python 
>>:-) Also be very careful when you see the word CMS used about a platform 
>>or product... it is used ultra-liberally in the industry.
>>    
>>
>
>I have looked at all the ones I know of but they all lack some of the features or
>control I need.  I need to have a lot of users changing and editing content 
>(text only) and it all goes to an editor.  All layout, graphics and photos need 
>to be filtered through a different person.  Some types of content ie news needs to 
>be approved by a vice president.  Zope can be extended to do all this but with
>what I would need to do to extend it I might as customize it and write it
>myself.  I do have a little experience with Python as I have written a POS
>system in it.  The CMS I need will eventually even handle online registration as
>I work for a Bible College.  I don't see it as reinventing the wheel I just 
>don't like being tied down to a framework.  That is why I don't like Websphere
>or J2ee.  
>
><snip>
>  
>
I would have a look at plone, it's a CMS built on top of Zope
www.plone.org

David

From JTesser at nbbc.edu  Tue Dec  9 10:46:10 2003
From: JTesser at nbbc.edu (Jason Tesser)
Date: Fri Jan  9 21:54:06 2004
Subject: [mod_python] PSP how to????
Message-ID: <04875CB4331F0240A0AD66F970978651011376FB@paul>

> You need a newer version: 3.1.x, with the newest being 3.1.2b on
> www.modpython.org

OK I got and and I am trying to compile it.  I am on a Suse9.0 box with Apache2
installed.  When I run ./configure --with-apxs=/usr/share/apache2 it tells
me I need to run apache2.  It doesn't tell me what I am running now but all
I have installed in apache2.  Any ideas?

From sergey at optimaltec.com  Tue Dec  9 12:04:11 2003
From: sergey at optimaltec.com (Sergey A. Lipnevich)
Date: Fri Jan  9 21:54:06 2004
Subject: [mod_python] Re: PSP how to????
In-Reply-To: <04875CB4331F0240A0AD66F970978651011376FB@paul>
References: <04875CB4331F0240A0AD66F970978651011376FB@paul>
Message-ID: <3FD6008B.4090005@optimaltec.com>

try --with-apxs=$(which apxs)

Jason Tesser wrote:
>>You need a newer version: 3.1.x, with the newest being 3.1.2b on
>>www.modpython.org
> 
> 
> OK I got and and I am trying to compile it.  I am on a Suse9.0 box with Apache2
> installed.  When I run ./configure --with-apxs=/usr/share/apache2 it tells
> me I need to run apache2.  It doesn't tell me what I am running now but all
> I have installed in apache2.  Any ideas?


From patm at visi.com  Tue Dec  9 11:21:29 2003
From: patm at visi.com (Patrick McNamee)
Date: Fri Jan  9 21:54:06 2004
Subject: [mod_python] PSP how to????
In-Reply-To: <04875CB4331F0240A0AD66F970978651011376FB@paul>
References: <04875CB4331F0240A0AD66F970978651011376FB@paul>
Message-ID: <20031209172129.GB27875@isis.visi.com>

On Tue, Dec 09, 2003 at 10:46:10AM -0600, Jason Tesser wrote:
> > You need a newer version: 3.1.x, with the newest being 3.1.2b on
> > www.modpython.org
> 
> OK I got and and I am trying to compile it.  I am on a Suse9.0 box with Apache2
> installed.  When I run ./configure --with-apxs=/usr/share/apache2 it tells
> me I need to run apache2.  It doesn't tell me what I am running now but all
> I have installed in apache2.  Any ideas?

I think you want something like: 
./configure --with-apxs=/usr/share/apache2/bin/apxs --with-python=/path/to/python2.2

See http://www.modpython.org/live/mod_python-3.1.2b/doc-html/installation.html
for more info.

pm
From menion at asylumwear.com  Tue Dec  9 11:49:56 2003
From: menion at asylumwear.com (Joshua Schmidlkofer)
Date: Fri Jan  9 21:54:06 2004
Subject: [mod_python] import site errors, and constant modules (Re)loading
Message-ID: <1070999395.32237.19.camel@bubbles.imr-net.com>

I have poked through the list archives, and I still am.  I have Redhat
with mod_python-3.0.1 - the rpm packaged release.  In any case, whenever
I call my script it is re-instantiating the objects..

my script is like:

<snip>
class foo:
    def __init__(self):
        self.dbconn = psycopg.connect(.....)
        pass
    def handler(self, req):
        ....
        return content

__classholder__ = foo()
handler = foo.handler
</snip>

Did I fail to grok the greater meaning?  Am I committing a rookie
error?   I have turned on debug mode, and everytime I call the script I
get : 

[Tue Dec 09 11:18:25 2003] [notice] mod_python: (Re)importing module
'update' with path set to '['/var/www/html/proxy']'
'import site' failed; use -v for traceback
(this repeats about 20 times)


Anyway, thanks,
  joshua (going back to google)

-- 
I refuse to believe that the really hot, Debian-using,
password-sniffing, root-exploiting geek girl is a myth. -- g1zmo

From michael at dynamine.net  Tue Dec  9 12:03:27 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 21:54:06 2004
Subject: [mod_python] import site errors, and constant modules (Re)loading
In-Reply-To: <1070999395.32237.19.camel@bubbles.imr-net.com>
References: <1070999395.32237.19.camel@bubbles.imr-net.com>
Message-ID: <3FD62A8F.20708@dynamine.net>

I believe that in debug mode, your handler is always re-imported.  (Not 
necessarily its dependencies, though; that code is up to you.)

--Michael

Joshua Schmidlkofer wrote:
> I have poked through the list archives, and I still am.  I have Redhat
> with mod_python-3.0.1 - the rpm packaged release.  In any case, whenever
> I call my script it is re-instantiating the objects..
> 
> my script is like:
> 
> <snip>
> class foo:
>     def __init__(self):
>         self.dbconn = psycopg.connect(.....)
>         pass
>     def handler(self, req):
>         ....
>         return content
> 
> __classholder__ = foo()
> handler = foo.handler
> </snip>
> 
> Did I fail to grok the greater meaning?  Am I committing a rookie
> error?   I have turned on debug mode, and everytime I call the script I
> get : 
> 
> [Tue Dec 09 11:18:25 2003] [notice] mod_python: (Re)importing module
> 'update' with path set to '['/var/www/html/proxy']'
> 'import site' failed; use -v for traceback
> (this repeats about 20 times)
> 
> 
> Anyway, thanks,
>   joshua (going back to google)
> 

From denneking at nngov.com  Tue Dec  9 15:39:54 2003
From: denneking at nngov.com (David Enneking)
Date: Fri Jan  9 21:54:06 2004
Subject: [mod_python] 
Message-ID: <5.1.1.6.0.20031209150205.02be1ca0@pop.visi.net>

Hi,

Where can I find an example of using the session object and persistent data 
within a PSP page.

Thanks,
David
-------------- next part --------------

---
Outgoing mail is certified Virus Free.
Checked by AVG anti-virus system (http://www.grisoft.com).
Version: 6.0.545 / Virus Database: 339 - Release Date: 11/27/2003
From menion at asylumwear.com  Tue Dec  9 13:08:55 2003
From: menion at asylumwear.com (Joshua Schmidlkofer)
Date: Fri Jan  9 21:54:06 2004
Subject: [mod_python] import site errors, and
	constant	modules	(Re)loading
In-Reply-To: <3FD638D2.3030302@dynamine.net>
References: <1070999395.32237.19.camel@bubbles.imr-net.com>
	 <3FD62A8F.20708@dynamine.net>
	 <1071001721.32237.31.camel@bubbles.imr-net.com>
	 <3FD632F2.80503@dynamine.net>
	 <1071003271.32237.54.camel@bubbles.imr-net.com>
	 <3FD638D2.3030302@dynamine.net>
Message-ID: <1071004134.32237.70.camel@bubbles.imr-net.com>

Micheal,

  Thanks for keep up with me..... I moved everything to a separate
module, and I imported the module, used the db connection, etc. 

   Is it possible that I am not returning properly?   When you are using
the publisher handler, all the documentation and examples I have seen
have a "return content" at the end.  So I am storing everything in a
string, and "return"ing at the end of my handler method.  

  I can't figure this out, nothing is getting garbage collected, and
that must mean it is still in scope in some context or other.  


  idea?

thanks,
  Joshua



On Tue, 2003-12-09 at 13:04, Michael S. Fischer wrote:
> In my own work, the connection-handling code is in a separate module. 
> Though, if you do it right, it should work identically in the mod_python 
> module, assuming mod_python is not reloading the module.
> 
> --Michael
> 
> Joshua Schmidlkofer wrote:
> 
> > On Tue, 2003-12-09 at 12:39, Michael S. Fischer wrote:
> > 
> >>Yeah, try something like this:
> >>
> >><module 'db'>
> >>
> >>_conn = None
> >>def getConnection():
> >>    global _conn
> >>    if not _conn:
> >>       _conn = ...  # Get connection
> >>    return _conn
> >>
> >>See if something like that works.
> >>
> >>Joshua Schmidlkofer wrote:
> > 
> > 
> > Yeah, I pretty much have this exact logic - save one thing - is this in
> > a separate module that get imported?  Was that what your first message
> > said?
> > 
> > thanks,
> >   Joshua
> > 
> > 
> > 
-- 
I refuse to believe that the really hot, Debian-using,
password-sniffing, root-exploiting geek girl is a myth. -- g1zmo

From menion at asylumwear.com  Tue Dec  9 13:32:15 2003
From: menion at asylumwear.com (Joshua Schmidlkofer)
Date: Fri Jan  9 21:54:06 2004
Subject: [mod_python] import site errors,
	and	constant	modules	(Re)loading
In-Reply-To: <3FD63BED.5030000@dynamine.net>
References: <1070999395.32237.19.camel@bubbles.imr-net.com>
	 <3FD62A8F.20708@dynamine.net>
	 <1071001721.32237.31.camel@bubbles.imr-net.com>
	 <3FD632F2.80503@dynamine.net>
	 <1071003271.32237.54.camel@bubbles.imr-net.com>
	 <3FD638D2.3030302@dynamine.net> <1  <3FD63BED.5030000@dynamine.net>
Message-ID: <1071005534.32237.92.camel@bubbles.imr-net.com>

On Tue, 2003-12-09 at 13:17, Michael S. Fischer wrote:
> Indeed, when using the publisher handler, you are supposed to return the 
> content.
> 
> I don't understand your code, though.  What is the idea behind its 
> arrangement?
> 
> Normally when I make mod_python.publisher scripts, I do something like:
> 
> <snip>
> _conn = None
> def _getConnection(...):
>     global _conn
>     if not _conn:
>        _conn = ...
>     return _conn
> 
> def index(req, params...):
>     ...
>     conn = _getConnection(...)
>     ...
>     return content
> </snip>
> 

Here is an example, that is producing the problem for me:


import psycopg, os, copy, types


_DSN     = 'dbname=mydb user=myuser host=dbserver'
_conn    = None

def getConnection():
    global _conn
    if not _conn: _conn = psycopg.connect(_DSN)
    return _conn.cursor()

def index(**kwargs):
    cursor = getConnection()

    cursor.execute("select * from bad")

    content = """
    <html><head><title>test</test></head>
    <body>

    Test:<br>%s
    
    </body></html>
    """

    tmp = ""
    for x in cursor.fetchall(): tmp += "%s<br>" % str(x)

    cursor.close()
    del cursor
    return content % tmp


From grisha at modpython.org  Wed Dec 10 00:54:05 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:54:06 2004
Subject: [mod_python] import site errors, and constant modules (Re)loading
In-Reply-To: <1070999395.32237.19.camel@bubbles.imr-net.com>
References: <1070999395.32237.19.camel@bubbles.imr-net.com>
Message-ID: <20031210004953.B77939@onyx.ispol.com>



On Tue, 9 Dec 2003, Joshua Schmidlkofer wrote:

> [Tue Dec 09 11:18:25 2003] [notice] mod_python: (Re)importing module
> 'update' with path set to '['/var/www/html/proxy']'
> 'import site' failed; use -v for traceback
> (this repeats about 20 times)

You should get as many of these messages as there are httpd processes
running. 20 seems a bit high to me, unless your httpd is configured to
have a minimum 20 servers running at any given time, but it is not
impossible (or unreasonable for a high volume server).

Do you get one of these for every request, or only for the first 20?

Grisha
From rey4 at columbia.edu  Wed Dec 10 02:28:35 2003
From: rey4 at columbia.edu (Russell Yanofsky)
Date: Fri Jan  9 21:54:06 2004
Subject: [mod_python] script_name bug again
Message-ID: <br6i02$5lh$1@sea.gmane.org>

Hi,

At the beginning of August I reported a bug affecting the value of the
script_name cgi variable and posted two patches to fix it in mod_python
2.7.8 and 3.0.3.

The fix appears to have been included in mod_python 3.0.4, but not in
mod_python 2.7.9. Is there a chance it can be included in the next release
of 2.7?

The patches are posted here:

http://www.modpython.org/pipermail/mod_python/attachments/20030811/8718dca2/mod_python-2.7.8.obj
http://www.modpython.org/pipermail/mod_python/attachments/20030811/8718dca2/mod_python-3.0.3.obj

The initial bug report is here:

http://www.modpython.org/pipermail/mod_python/2003-August/003495.html

And the fix for mod_python 3.0 was committed here:

http://cvs.apache.org/viewcvs.cgi/httpd-python/src/mod_python.c?r1=1.95&r2=1.96

- Russ


From catellani.m at maxmara.it  Wed Dec 10 09:17:12 2003
From: catellani.m at maxmara.it (Marco Catellani)
Date: Fri Jan  9 21:54:06 2004
Subject: [mod_python] Managing multiple users with mod-python
Message-ID: <3153892629catellani.m@maxmara.it>


Hi,
I'm experienced with Python and I'm learning to configure and use Mod Python (rel 3.03) and Apache (rel 2).
I'm setting up on my server a test environment, and I would like to manage multiple users, everyone of them using a different python interpreter.
Every programmer in my test environment should work with its own user and the python programs launched by him should run under his user and should not interfere with other user's processes.
Apache supports only one user for all child processes, so I'm not able to launch multiple interpreters with different users. Does Mod Python offers any feature to satisfy my need?

Thanks a lot

     Marco



From michael at dynamine.net  Wed Dec 10 09:46:36 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 21:54:06 2004
Subject: [mod_python] Managing multiple users with mod-python
In-Reply-To: <3153892629catellani.m@maxmara.it>
References: <3153892629catellani.m@maxmara.it>
Message-ID: <3FD75BFC.7030900@dynamine.net>

No.  If you want each user to have his own instance of Apache, have each 
one run his own copy, each of which is bound to a personal port.

--Michael

Marco Catellani wrote:

> Hi,
> I'm experienced with Python and I'm learning to configure and use Mod Python (rel 3.03) and Apache (rel 2).
> I'm setting up on my server a test environment, and I would like to manage multiple users, everyone of them using a different python interpreter.
> Every programmer in my test environment should work with its own user and the python programs launched by him should run under his user and should not interfere with other user's processes.
> Apache supports only one user for all child processes, so I'm not able to launch multiple interpreters with different users. Does Mod Python offers any feature to satisfy my need?
> 
> Thanks a lot
> 
>      Marco
> 
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 
From matt at pollenation.net  Wed Dec 10 18:31:16 2003
From: matt at pollenation.net (Matt Goodall)
Date: Fri Jan  9 21:54:06 2004
Subject: [mod_python] Managing multiple users with mod-python
In-Reply-To: <3FD75BFC.7030900@dynamine.net>
References: <3153892629catellani.m@maxmara.it> <3FD75BFC.7030900@dynamine.net>
Message-ID: <3FD76674.1040708@pollenation.net>


> Marco Catellani wrote:
>
>> Hi,
>> I'm experienced with Python and I'm learning to configure and use Mod 
>> Python (rel 3.03) and Apache (rel 2).
>> I'm setting up on my server a test environment, and I would like to 
>> manage multiple users, everyone of them using a different python 
>> interpreter.
>> Every programmer in my test environment should work with its own user 
>> and the python programs launched by him should run under his user and 
>> should not interfere with other user's processes.
>> Apache supports only one user for all child processes, so I'm not 
>> able to launch multiple interpreters with different users. Does Mod 
>> Python offers any feature to satisfy my need? 
>
Assuming you don't need the tight coupling Apache+mod_python provides ...

You may want to look at something like SCGI for development instead of 
mod_python. You would assign each user an SCGI port number (Bob uses 
3000, Dave uses 3001 etc) and then configure Apache so that each user 
has a virtual host or URL path on the web server which forwards requests 
to the user's SCGI process. Your users can then develop, start and stop 
the web app from somewhere within their home directory, without ever 
needing to touch Apache.

There are quite a few web frameworks which work behind either SCGI or 
mod_python so moving from SCGI during development to mod_python for 
production (if that's what you decide to do) should be relatively painless.

    SCGI - http://www.mems-exchange.org/software/scgi/

Another interesting solution to your problem, although nothing to do 
with Apache or mod_python, is Twisted's spreadable web servers. See 
http://www.twistedmatrix.com/documents/howto/using-twistedweb#auto19 for 
more. It's worth pointing out that the personal servers can be any 
Twisted-based web application and not just something that serves content 
from the file system.

Hope this helps.

Cheers, Matt

-- 
Matt Goodall, Pollenation Internet Ltd
w: http://www.pollenationinternet.com
e: matt@pollenation.net


From dpopowich at mtrsd.k12.ma.us  Thu Dec 11 11:10:07 2003
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Fri Jan  9 21:54:06 2004
Subject: [mod_python] mod_python 3.1.2b and directory indexes
Message-ID: <16344.38623.864766.807800@gargle.gargle.HOWL>


I upgraded to 3.1.2b recently and have noticed that when I reference
an URL that is a directory my request handler is never called, but
instead I get a directory index (assuming Option Indexes is specified,
if not I get a 403 error).  This didn't happen with 3.0.1 where
directory or file, my python request handler was called.

Anyone else notice this?

------------------
Daniel Popowich
Network Specialist
-------------------------------------
Mohawk Trail Regional School District
24 Ashfield Rd.
Shelburne Falls, MA 01370
413.625.0192 x22
-------------------------------------

From JTesser at nbbc.edu  Thu Dec 11 11:24:03 2003
From: JTesser at nbbc.edu (Jason Tesser)
Date: Fri Jan  9 21:54:06 2004
Subject: [mod_python] setup help
Message-ID: <04875CB4331F0240A0AD66F97097865101137707@paul>

I have the following script saved as test.py and saved under htdoc


From JTesser at nbbc.edu  Thu Dec 11 11:26:57 2003
From: JTesser at nbbc.edu (Jason Tesser)
Date: Fri Jan  9 21:54:06 2004
Subject: [mod_python] config help
Message-ID: <04875CB4331F0240A0AD66F97097865101137708@paul>

I have the folowing script saved as test.py under htdocs.

from mod_python import apache

def handler(req):
	req.write("Hello World!")
	return apache.OK

I cannot get it to execute properly with mod_python.  Here the configuration from my apache config file.

<Directory /srv/www/htdocs/>
  AddHandler python-program .py
  PythonHandler test
  #PythonHandler mod_python.publisher
  PythonDebug On
</Directory>
I tried uncommenting the publisher handler which doesn't work at all for me.  What am I missing :-s

From grisha at modpython.org  Thu Dec 11 12:36:16 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:54:06 2004
Subject: [mod_python] mod_python 3.1.2b and directory indexes
In-Reply-To: <16344.38623.864766.807800@gargle.gargle.HOWL>
References: <16344.38623.864766.807800@gargle.gargle.HOWL>
Message-ID: <20031211123551.N4056@onyx.ispol.com>


it's a bug. this has been fixed in the latest cvs.

On Thu, 11 Dec 2003, Daniel J. Popowich wrote:

>
> I upgraded to 3.1.2b recently and have noticed that when I reference
> an URL that is a directory my request handler is never called, but
> instead I get a directory index (assuming Option Indexes is specified,
> if not I get a 403 error).  This didn't happen with 3.0.1 where
> directory or file, my python request handler was called.
>
> Anyone else notice this?
>
> ------------------
> Daniel Popowich
> Network Specialist
> -------------------------------------
> Mohawk Trail Regional School District
> 24 Ashfield Rd.
> Shelburne Falls, MA 01370
> 413.625.0192 x22
> -------------------------------------
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From cs1spw at bath.ac.uk  Thu Dec 11 14:08:17 2003
From: cs1spw at bath.ac.uk (Simon Willison)
Date: Fri Jan  9 21:54:06 2004
Subject: [mod_python] mod_python 3.1.2b and directory indexes
In-Reply-To: <16344.38623.864766.807800@gargle.gargle.HOWL>
References: <16344.38623.864766.807800@gargle.gargle.HOWL>
Message-ID: <3FD8CEB1.3080000@bath.ac.uk>

Daniel J. Popowich wrote:

> I upgraded to 3.1.2b recently and have noticed that when I reference
> an URL that is a directory my request handler is never called, but
> instead I get a directory index (assuming Option Indexes is specified,
> if not I get a 403 error).  This didn't happen with 3.0.1 where
> directory or file, my python request handler was called.

I was hit by that one too. My solution was to ditch Directory directives 
entirely and switch to using Location instead, which appears to be a 
much more logical way of working with mod_python as handlers can live 
anywhere on the Python path, making Directory based handlers pretty much 
irrelevant.
From davidf at sjsoft.com  Fri Dec 12 17:20:17 2003
From: davidf at sjsoft.com (David Fraser)
Date: Fri Jan  9 21:54:06 2004
Subject: [mod_python] config help
In-Reply-To: <04875CB4331F0240A0AD66F97097865101137708@paul>
References: <04875CB4331F0240A0AD66F97097865101137708@paul>
Message-ID: <3FD9DCB1.3090004@sjsoft.com>

Jason Tesser wrote:

>I have the folowing script saved as test.py under htdocs.
>
>from mod_python import apache
>
>def handler(req):
>	req.write("Hello World!")
>	return apache.OK
>
>I cannot get it to execute properly with mod_python.  Here the configuration from my apache config file.
>  
>
When you say, you cannot get it to execute, you should describe exactly 
what you tried (the URL) and the response you got...

><Directory /srv/www/htdocs/>
>  AddHandler python-program .py
>  PythonHandler test
>  #PythonHandler mod_python.publisher
>  PythonDebug On
></Directory>
>I tried uncommenting the publisher handler which doesn't work at all for me.  What am I missing :-s
>  
>
Have you added the Python module (LoadModule etc) to the main apache 
configuration?

David
From jay at jaydorsey.com  Fri Dec 12 09:42:34 2003
From: jay at jaydorsey.com (Jay Dorsey)
Date: Fri Jan  9 21:54:06 2004
Subject: [mod_python] config help
In-Reply-To: <04875CB4331F0240A0AD66F97097865101137708@paul>
References: <04875CB4331F0240A0AD66F97097865101137708@paul>
Message-ID: <20031212154234.GA3929@gentoo.Earthlink.net>

On Thu, Dec 11, 2003 at 11:26:57AM -0600, Jason Tesser wrote:
> I have the folowing script saved as test.py under htdocs.
> 
> from mod_python import apache
> 
> def handler(req):
> 	req.write("Hello World!")
> 	return apache.OK
>

This looks fine

> I cannot get it to execute properly with mod_python.  Here the configuration from my apache config file.
> 
> <Directory /srv/www/htdocs/>
>   AddHandler python-program .py
>   PythonHandler test
>   #PythonHandler mod_python.publisher
>   PythonDebug On
> </Directory>

So does this, except for maybe that trailing slash on htdocs (I don't
have one in my setup, not sure if its required, disallowed, or 
allowed though).  Are you sure your restarted apache after you made the 
changes to your config file?  Have you checked the apache error logs
to see if you're getting any messages there?  Are you sure you're 
serving pages out of /srv/www/htdocs?  

-- 
Jay Dorsey
jay at jaydorsey dot com
From JTesser at nbbc.edu  Fri Dec 12 09:28:49 2003
From: JTesser at nbbc.edu (Jason Tesser)
Date: Fri Jan  9 21:54:06 2004
Subject: [mod_python] config help
Message-ID: <04875CB4331F0240A0AD66F9709786510113770D@paul>

HI,

>>I have the folowing script saved as test.py under htdocs.
>>
>>from mod_python import apache
>>
>>def handler(req):
>>	req.write("Hello World!")
>>	return apache.OK
>>
>>I cannot get it to execute properly with mod_python.  Here the configuration from my apache config file.
 
>
> When you say, you cannot get it to execute, you should describe exactly 
> what you tried (the URL) and the response you got...

It just prints the script on the page.

>> <Directory /srv/www/htdocs/>
>>  AddHandler python-program .py
>>  PythonHandler test
>>  #PythonHandler mod_python.publisher
>>  PythonDebug On
>> </Directory>
>> I tried uncommenting the publisher handler which doesn't work at all for me.  What am I missing :-s
>  
>
> Have you added the Python module (LoadModule etc) to the main apache 
> configuration?

Yes it is loaded.  

From dannoritzer at web.de  Fri Dec 12 19:09:36 2003
From: dannoritzer at web.de (=?ISO-8859-1?Q?G=FCnter_Dannoritzer?=)
Date: Fri Jan  9 21:54:06 2004
Subject: [mod_python] Problem with 'import' statement in 'execfile' script
Message-ID: <3FDA0460.1030406@web.de>

Hello,

I have a problem with a python script I try to execute from a publisher 
handler with the command 'execfile'.

The script starts with the following lines:

import sys
sys.path.append('/ab/system')
from Tools.Utilities import Utilities

So I have the module Utilities under /ab/system/Tools and extend my path 
first so that the following from/import statement will find it.

When I call the web page (my publisher handler with the 'execfile' 
command) I get the error message:

    ImportError: No module named Tools.Utilities

When I execute the same script with 'python <scriptname>' or 
'execfile(<scriptname>)' out of python, it is executed without errors. 
Even when I do it with the user apache is running as.

If I leave the 'sys.path.append' command out and execute the script by 
itself I get the error message as well. So the 'sys.path.append' must 
basically work, just not when using it with the publisher handler.

My configuration is:

Apache-AdvancedExtranetServer/2.0.47 (Mandrake Linux/6.1.92mdk) 
mod_python/3.1.0a Python/2.3

Can anybody tell me why I get the error with the publisher handler and 
not when I execute the script by itself?

Thanks for your help.

Guenter




From neel at mediapulse.com  Fri Dec 12 13:38:15 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:54:06 2004
Subject: [mod_python] Problem with 'import' statement in 'execfile' script
Message-ID: <C0FC22C08B82074A88B50061764157776B98B9@johnson.mediapulse.net>

> import sys
> sys.path.append('/ab/system')
> from Tools.Utilities import Utilities
> 

Have you tried using the PythonPath directive
(http://www.modpython.org/live/current/doc-html/dir-other-pp.html)?  I'm
not sure if setting the path inside the script is something you can do
(but again, I'm not sure).

Mike

From Vincent.Raaijmakers at ge.com  Fri Dec 12 12:42:47 2003
From: Vincent.Raaijmakers at ge.com (Raaijmakers, Vincent (IndSys, GE Interlogix))
Date: Fri Jan  9 21:54:06 2004
Subject: [mod_python] Problem with 'import' statement in 'execfile' script
Message-ID: <971323274247EB44B9A01D0A3B424C8504495618@FTWMLVEM02.e2k.ad.ge.com>

Is the package in your library/ site-packages ?
/usr/local/lib/python2.3/site-packages

and if so,

do you use perhaps soft links? ln -s /path_a/Tools /path_b/Tools
I had a lot of these issues using soft links.

Vincent

-----Original Message-----
From: mod_python-bounces@modpython.org
[mailto:mod_python-bounces@modpython.org]On Behalf Of G?nter Dannoritzer
Sent: Friday, December 12, 2003 1:10 PM
To: mod_python@modpython.org
Subject: [mod_python] Problem with 'import' statement in 'execfile'
script


Hello,

I have a problem with a python script I try to execute from a publisher 
handler with the command 'execfile'.

The script starts with the following lines:

import sys
sys.path.append('/ab/system')
from Tools.Utilities import Utilities

So I have the module Utilities under /ab/system/Tools and extend my path 
first so that the following from/import statement will find it.

When I call the web page (my publisher handler with the 'execfile' 
command) I get the error message:

    ImportError: No module named Tools.Utilities

When I execute the same script with 'python <scriptname>' or 
'execfile(<scriptname>)' out of python, it is executed without errors. 
Even when I do it with the user apache is running as.

If I leave the 'sys.path.append' command out and execute the script by 
itself I get the error message as well. So the 'sys.path.append' must 
basically work, just not when using it with the publisher handler.

My configuration is:

Apache-AdvancedExtranetServer/2.0.47 (Mandrake Linux/6.1.92mdk) 
mod_python/3.1.0a Python/2.3

Can anybody tell me why I get the error with the publisher handler and 
not when I execute the script by itself?

Thanks for your help.

Guenter




_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python

From kevin at sb.org  Fri Dec 12 15:07:24 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:54:06 2004
Subject: [mod_python] Trouble installing mod_python
Message-ID: <CD80C6EA-2CDE-11D8-BBFA-000A95A072FC@sb.org>

I'm running Mac OS X 10.3 with Apache 2 installed (via the Complete 
Apache 2 installer package) and I'm trying to install mod_python 
(latest from CVS). I ./configure and make and make install it fine, but 
when I add the LoadModule line to my httpd.conf file and do a Check 
Syntax I get the following error:

Syntax error on line 1099 of /Library/Apache2/conf/httpd.conf:
Cannot load /Library/Apache2/modules/mod_python.so into server: dyld: 
/Library/Apache2/bin/httpd Undefined symbols:
_PyExc_AttributeError
_PyExc_IOError
_PyExc_IndexError
_PyExc_KeyError
_PyExc_RuntimeError
_PyExc_StopIteration
_PyExc_TypeError
_PyExc_ValueError
_PyInt_Type
_PyList_Type
_PyObject_GenericGetAttr
_PyObject_GenericSetAttr
_PyString_Type
_PyType_Type
_Py_OptimizeFlag
__Py_NoneStruct
__Py_NotImplementedStruct

line 1099 is my LoadModule for mod_python. Why am I getting this error 
and how can I fix it?

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org


From michael at dynamine.net  Fri Dec 12 12:16:15 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 21:54:06 2004
Subject: [mod_python] Trouble installing mod_python
In-Reply-To: <CD80C6EA-2CDE-11D8-BBFA-000A95A072FC@sb.org>
References: <CD80C6EA-2CDE-11D8-BBFA-000A95A072FC@sb.org>
Message-ID: <3FDA220F.1050506@dynamine.net>

The default Makefile that configure creates is not quite right on OS X.

Assuming you've installed Fink and the python22 package (which is an 
implicit prerequisite for mod_python on OS X), you'll need to run 
configure like so:

env LDFLAGS="-L/sw/lib/python2.2/config -lpython2.2" ./configure

Also note that even though you've already told mod_python the path to 
python, you'll need to tell it again by prepending /sw/bin to the PATH 
before executing Apache 2.0.

--Michael

Kevin Ballard wrote:
> I'm running Mac OS X 10.3 with Apache 2 installed (via the Complete 
> Apache 2 installer package) and I'm trying to install mod_python (latest 
> from CVS). I ./configure and make and make install it fine, but when I 
> add the LoadModule line to my httpd.conf file and do a Check Syntax I 
> get the following error:
> 
> Syntax error on line 1099 of /Library/Apache2/conf/httpd.conf:
> Cannot load /Library/Apache2/modules/mod_python.so into server: dyld: 
> /Library/Apache2/bin/httpd Undefined symbols:
> _PyExc_AttributeError
> _PyExc_IOError
> _PyExc_IndexError
> _PyExc_KeyError
> _PyExc_RuntimeError
> _PyExc_StopIteration
> _PyExc_TypeError
> _PyExc_ValueError
> _PyInt_Type
> _PyList_Type
> _PyObject_GenericGetAttr
> _PyObject_GenericSetAttr
> _PyString_Type
> _PyType_Type
> _Py_OptimizeFlag
> __Py_NoneStruct
> __Py_NotImplementedStruct
> 
> line 1099 is my LoadModule for mod_python. Why am I getting this error 
> and how can I fix it?
> 
From kevin at sb.org  Fri Dec 12 15:21:11 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:54:06 2004
Subject: [mod_python] Trouble installing mod_python
In-Reply-To: <3FDA220F.1050506@dynamine.net>
References: <CD80C6EA-2CDE-11D8-BBFA-000A95A072FC@sb.org>
	<3FDA220F.1050506@dynamine.net>
Message-ID: <BA40ABC9-2CE0-11D8-BBFA-000A95A072FC@sb.org>

Why would I want to install python2.2 when OS X comes with Python 2.3?  
And why is this a prerequisite when the include files are in  
/System/Library/Frameworks/Python.framework/Versions/2.3/include/ 
python2.3/ and the makefile can find them?

On Dec 12, 2003, at 3:16 PM, Michael S. Fischer wrote:

> The default Makefile that configure creates is not quite right on OS X.
>
> Assuming you've installed Fink and the python22 package (which is an  
> implicit prerequisite for mod_python on OS X), you'll need to run  
> configure like so:
>
> env LDFLAGS="-L/sw/lib/python2.2/config -lpython2.2" ./configure
>
> Also note that even though you've already told mod_python the path to  
> python, you'll need to tell it again by prepending /sw/bin to the PATH  
> before executing Apache 2.0.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org


From michael at dynamine.net  Fri Dec 12 12:36:06 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 21:54:06 2004
Subject: [mod_python] Trouble installing mod_python
In-Reply-To: <BA40ABC9-2CE0-11D8-BBFA-000A95A072FC@sb.org>
References: <CD80C6EA-2CDE-11D8-BBFA-000A95A072FC@sb.org>
	<3FDA220F.1050506@dynamine.net> <BA40ABC9-2CE0-11D8-BBFA-000A95A072FC@sb.org>
Message-ID: <3FDA26B6.9010809@dynamine.net>

I'm just telling you what works for me.  (I'm running OS X Server 10.2, 
and so YMMV).

Do you know if OS X Server 10.3 ships with libpython2.3.a or 
libpython2.3.dylib?  If not, you'll still need Fink and the python2.2 
package.

I wouldn't fret it about too much unless there's some Python 2.3 feature 
that is absolutely required for your application.

--Michael

Kevin Ballard wrote:

> Why would I want to install python2.2 when OS X comes with Python 2.3?  
> And why is this a prerequisite when the include files are in  
> /System/Library/Frameworks/Python.framework/Versions/2.3/include/ 
> python2.3/ and the makefile can find them?
> 
> On Dec 12, 2003, at 3:16 PM, Michael S. Fischer wrote:
> 
>> The default Makefile that configure creates is not quite right on OS X.
>>
>> Assuming you've installed Fink and the python22 package (which is an  
>> implicit prerequisite for mod_python on OS X), you'll need to run  
>> configure like so:
>>
>> env LDFLAGS="-L/sw/lib/python2.2/config -lpython2.2" ./configure
>>
>> Also note that even though you've already told mod_python the path to  
>> python, you'll need to tell it again by prepending /sw/bin to the 
>> PATH  before executing Apache 2.0.
> 
> 
From alexiev at activesolutions.bg  Sat Dec 13 14:41:30 2003
From: alexiev at activesolutions.bg (Alexiev Nikolay)
Date: Fri Jan  9 21:54:07 2004
Subject: [mod_python] response content-type
Message-ID: <001401c3c176$6f0228a0$0a01010a@dev1>

How can I change content-type of respons, using publisher handler ?


---------------------------------------
Best regards,
Alexiev, Nikolay
e-mail: alexiev@activesolutions.bg
phone: +359 2 8753543
From dannoritzer at web.de  Sat Dec 13 13:41:29 2003
From: dannoritzer at web.de (=?ISO-8859-1?Q?G=FCnter_Dannoritzer?=)
Date: Fri Jan  9 21:54:07 2004
Subject: [mod_python] Problem with 'import' statement in 'execfile' script
In-Reply-To: <C0FC22C08B82074A88B50061764157776B98B9@johnson.mediapulse.net>
References: <C0FC22C08B82074A88B50061764157776B98B9@johnson.mediapulse.net>
Message-ID: <3FDB08F9.3050706@web.de>

Thanks for all the help I got on this problem.

Mike,

I was not able to test the 'PythonPath' directive yet, but I did add the 
sys.path.append to the publisher handler script and it worked.

It seems like I cannot modify the sys.path in a script I call with the 
execfile command when using mod_python.

Guenter


Michael C. Neel wrote:

>>import sys
>>sys.path.append('/ab/system')
>>from Tools.Utilities import Utilities
>>
>>    
>>
>
>Have you tried using the PythonPath directive
>(http://www.modpython.org/live/current/doc-html/dir-other-pp.html)?  I'm
>not sure if setting the path inside the script is something you can do
>(but again, I'm not sure).
>
>Mike
>
>  
>


From stian at soiland.no  Sat Dec 13 19:26:19 2003
From: stian at soiland.no (Stian =?iso-8859-1?Q?S=F8iland?=)
Date: Fri Jan  9 21:54:07 2004
Subject: [mod_python] Re: response content-type
In-Reply-To: <001401c3c176$6f0228a0$0a01010a@dev1>
References: <001401c3c176$6f0228a0$0a01010a@dev1>
Message-ID: <20031213182619.GA18517@itea.ntnu.no>

On 2003-12-13 13:41:30, Alexiev Nikolay wrote:

> How can I change content-type of respons, using publisher handler ?

Include req as first parameter, and set req.content_type.

def test(req):
    req.content_type = "image/jpeg"
    image = open("/somewhere/blapp.jpeg").read()
    return image

-- 
Stian S?iland               Work toward win-win situation. Win-lose
Trondheim, Norway           is where you win and the other lose.
http://www.soiland.no/      Lose-lose and lose-win are left as an
                            exercise to the reader.  [Limoncelli/Hogan]

From greenbeard400 at yahoo.com  Sat Dec 13 16:52:26 2003
From: greenbeard400 at yahoo.com (Greenbeard)
Date: Fri Jan  9 21:54:07 2004
Subject: [mod_python] Problem downloading the Full Archives
Message-ID: <20031214005226.99770.qmail@web21327.mail.yahoo.com>

When I went to this url:

http://mailman.modpython.org/pipermail/mod_python.mbox/mod_python.mbox

I only got about 1k of data - mail through Wed Jan 31,
2001.  Is there a different url/way to get the
archives?   I can not seem to locate  it. 

Thanks! 

gb400

__________________________________
Do you Yahoo!?
Free Pop-Up Blocker - Get it now
http://companion.yahoo.com/
From ron at UDel.Edu  Mon Dec 15 09:17:27 2003
From: ron at UDel.Edu (Ron Reisor)
Date: Fri Jan  9 21:54:07 2004
Subject: [mod_python] Trouble installing mod_python
In-Reply-To: <CD80C6EA-2CDE-11D8-BBFA-000A95A072FC@sb.org>
References: <CD80C6EA-2CDE-11D8-BBFA-000A95A072FC@sb.org>
Message-ID: <Pine.SOL.4.58L.0312150838270.10512@copland.udel.edu>

Kevin,

   The mod_python.so that is built doesn't depend on other needed shared
libraries.  This seems to be the result of how it is built by apxs.  I'm
not sure of the best way to get this problem resolved, but we have been
able to work around the problems. This is a little messy though:

   Build ssl and apache2.0.48 in /usr/local.  MacOSX 10.3 will use shared
libraries in /usr/local/lib without any changes.  The only thing I think
is special about the apache build is to specify --with-mpm=worker so you
get thread support

   Rebuild Python-2.3. I recommend 2.3.2 which includes some patches that
are important to us, but 2.3 works.  2.3.3c1 seems fine so far.  We
replaced the Apple supplied Python in preference for the latest version.
This replaces files in /Applications/MacPython-2.3 and
/Library/Frameworks/Python.framework and /usr/local/bin.  Build like:

./configure --enable-framework
make
make frameworkinstall

   To build mod_python, get the latest cvs.  It includes patches for
Python-2.3 memory/object allocation that will matter on MacOSX.  Build it
as usual to start:

./configure --with-apxs=/usr/local/bin/apxs
make
su
make install

   But, the apxs will use the gnu libtool and what you end up with is a
mod_python.so that doesn't have the right dependencies.  You can check
this with otool:

[roaming-163-213:~/macpython/httpd-python] ron% otool -L
src/.libs/mod_python.so
src/.libs/mod_python.so:
        /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current
version 71.0.0)
[roaming-163-213:~/macpython/httpd-python] ron%

   Key libraries, like Python, are missing.  So, here's the really messy
part.  Remove the mod_python.so link from src and run this command in the
src directory:

libtool -o mod_python.so -dynamic -flat_namespace -undefined suppress
hlistobject.o hlist.o filterobject.o connobject.o serverobject.o util.o
tableobject.o requestobject.o _apachemodule.o mod_python.o -framework
System -lcc_dynamic -arch_only ppc -framework Python -framework
CoreServices -framework Foundation -lm

   That should be all one shell command line.  One important difference
here is that the libtool you use is the Apple supplied libtool, not the
gnu libtool that apxs would normally use.  Also, there's switches in there
that I don't know how to get apxs to generate. If you check this with
otool you should see:

[roaming-163-213:~/macpython/httpd-python/src] ron% otool -L mod_python.so
mod_python.so:
        mod_python.so (compatibility version 0.0.0, current version 0.0.0)
        /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current
version 71.0.0)
        /Library/Frameworks/Python.framework/Versions/2.3/Python
(compatibility version 2.3.0, current version 2.3.0)

/System/Library/Frameworks/CoreServices.framework/Versions/A/CoreServices
(compatibility version 1.0.0, current version 16.0.0)

/System/Library/Frameworks/Foundation.framework/Versions/C/Foundation
(compatibility version 300.0.0, current version 500.5.0)
[roaming-163-213:~/macpython/httpd-python/src] ron%

   Then, copy the mod_python.so into the /usr/local/modules directory.

cheers,

Ron


On Fri, 12 Dec 2003, Kevin Ballard wrote:

> I'm running Mac OS X 10.3 with Apache 2 installed (via the Complete
> Apache 2 installer package) and I'm trying to install mod_python
> (latest from CVS). I ./configure and make and make install it fine, but
> when I add the LoadModule line to my httpd.conf file and do a Check
> Syntax I get the following error:
>
> Syntax error on line 1099 of /Library/Apache2/conf/httpd.conf:
> Cannot load /Library/Apache2/modules/mod_python.so into server: dyld:
> /Library/Apache2/bin/httpd Undefined symbols:
> _PyExc_AttributeError
> _PyExc_IOError
> _PyExc_IndexError
> _PyExc_KeyError
> _PyExc_RuntimeError
> _PyExc_StopIteration
> _PyExc_TypeError
> _PyExc_ValueError
> _PyInt_Type
> _PyList_Type
> _PyObject_GenericGetAttr
> _PyObject_GenericSetAttr
> _PyString_Type
> _PyType_Type
> _Py_OptimizeFlag
> __Py_NoneStruct
> __Py_NotImplementedStruct
>
> line 1099 is my LoadModule for mod_python. Why am I getting this error
> and how can I fix it?
>
> --
> Kevin Ballard
> kevin@sb.org
> http://www.tildesoft.com
> http://kevin.sb.org
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

Ron Reisor <ron@udel.edu> (RWR3)
University of Delaware Information Technologies/Network and Systems Services
Computing Center/192 South Chapel Street/Newark DE, 19716
pgp finger print: 0D 73 06 6F D3 6A 99 D3  F5 D5 6E FF 3B B9 7C 2C
From mark at gsoa.net  Mon Dec 15 13:33:23 2003
From: mark at gsoa.net (Mark McClain)
Date: Fri Jan  9 21:54:07 2004
Subject: [mod_python] re: trouble installing mod_python
Message-ID: <2A3E42DA-2F2D-11D8-A794-000A95B33D28@gsoa.net>

I've been able to build mod_python on 10.3 making very few changes.   
This process uses python 2.3 that comes with 10.3.  The problem that 
you are experiencing is because the linker does not get told to link to 
the python framework by apxs.

mark

1) Build and install apache2

2) Unpack the mod_python distribution

3) make the following changes to the configure script. here it is in 
modified form...

if test "$PyFRAMEWORKDIR" != "no-framework"; then
   if test -n "$PyFRAMEWORK"; then
     PyPYTHONLIBS="-framework $PyFRAMEWORK"

    # explicitly pass to mac linker so add this line
     LDFLAGS="${LDFLAGS} -Wl,-framework,Python"
   fi

4) run configure, make, then install

Good luck,

mark

From kevin at sb.org  Mon Dec 15 14:28:21 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:54:07 2004
Subject: [mod_python] re: trouble installing mod_python
In-Reply-To: <2A3E42DA-2F2D-11D8-A794-000A95B33D28@gsoa.net>
References: <2A3E42DA-2F2D-11D8-A794-000A95B33D28@gsoa.net>
Message-ID: <D7A8AD94-2F34-11D8-B6D0-000A95A072FC@sb.org>

Wow, that worked great! Thanks!

On Dec 15, 2003, at 1:33 PM, Mark McClain wrote:

> 1) Build and install apache2
>
> 2) Unpack the mod_python distribution
>
> 3) make the following changes to the configure script. here it is in 
> modified form...
>
> if test "$PyFRAMEWORKDIR" != "no-framework"; then
>   if test -n "$PyFRAMEWORK"; then
>     PyPYTHONLIBS="-framework $PyFRAMEWORK"
>
>    # explicitly pass to mac linker so add this line
>     LDFLAGS="${LDFLAGS} -Wl,-framework,Python"
>   fi
>
> 4) run configure, make, then install

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org


From kevin at sb.org  Mon Dec 15 14:57:12 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:54:07 2004
Subject: [mod_python] re: trouble installing mod_python
In-Reply-To: <2A3E42DA-2F2D-11D8-A794-000A95B33D28@gsoa.net>
References: <2A3E42DA-2F2D-11D8-A794-000A95B33D28@gsoa.net>
Message-ID: <DFBB3B11-2F38-11D8-B6D0-000A95A072FC@sb.org>

I tested my new mod_python and it's not working. The server log has 
nothing telling me why I'm getting an error, but if I try to run the 
mptest.py file myself from python, I get an error saying that in 
apache.py, on the import _apache line, there's no module named _apache.

What's going on and how do I fix this?

On Dec 15, 2003, at 1:33 PM, Mark McClain wrote:

> I've been able to build mod_python on 10.3 making very few changes.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org


From kevin at sb.org  Mon Dec 15 15:09:23 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:54:07 2004
Subject: [mod_python] re: trouble installing mod_python
In-Reply-To: <DFBB3B11-2F38-11D8-B6D0-000A95A072FC@sb.org>
References: <2A3E42DA-2F2D-11D8-A794-000A95B33D28@gsoa.net>
	<DFBB3B11-2F38-11D8-B6D0-000A95A072FC@sb.org>
Message-ID: <931CB23E-2F3A-11D8-B6D0-000A95A072FC@sb.org>

Argh, please ignore this. I realize now that _apache is provided by 
mod_python, and I also discovered the source of my form.py problem. I 
also discovered how mptest.py was failing, but I don't know why yet 
(but I will find out).

Anyway, sorry to bother you.

On Dec 15, 2003, at 2:57 PM, Kevin Ballard wrote:

> I tested my new mod_python and it's not working. The server log has 
> nothing telling me why I'm getting an error, but if I try to run the 
> mptest.py file myself from python, I get an error saying that in 
> apache.py, on the import _apache line, there's no module named 
> _apache.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org


From tim.stebbing at nunatak.com.au  Tue Dec 16 09:54:37 2003
From: tim.stebbing at nunatak.com.au (Timothy Stebbing)
Date: Fri Jan  9 21:54:07 2004
Subject: [mod_python] creating apache modules with mod_python
Message-ID: <3FDE3BAD.2050406@nunatak.com.au>

Is it possible to create apache modules using mod_python? I want to 
create a new protocol module for apache2.0, is there any info on doing 
this sort ofthing with mod_python, or has anyone done this sort of thing 
yet?

From kevin at sb.org  Mon Dec 15 19:29:08 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:54:07 2004
Subject: [mod_python] Strange server errors
Message-ID: <DC81D053-2F5E-11D8-B6D0-000A95A072FC@sb.org>

This is really strange. I tested my form.py thing from the Tutorial and 
it would just hang. I'd get absolutely no response from the server. I 
tried a few times, and then I started getting internal server errors 
instead, but with nothing in the error log. So I quit Apache and 
started httpd back up in single process mode (sudo ./httpd 
-DONE_PROCESS, as per the Troubleshooting section). At that point, my 
scripts magically started working (with no output to the shell from 
httpd). I then quit that and started Apache back up normally, and my 
scripts continue to work. Any idea what was going on, in case this 
weird stuff happens again?

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org


From tim.stebbing at nunatak.com.au  Tue Dec 16 12:30:34 2003
From: tim.stebbing at nunatak.com.au (Timothy Stebbing)
Date: Fri Jan  9 21:54:07 2004
Subject: [mod_python] PythonConnectionHandler directive
Message-ID: <3FDE603A.3010100@nunatak.com.au>

Howdy,

Im trying to get a simple protocol handler running, yet apache does not 
seem to be calling my code.

I have this in my apache config, this starts without any errors:

Listen 192.168.0.18:4444
<VirtualHost 192.168.0.18:4444>
        ServerAdmin webmaster@localhost
        DocumentRoot /var/www/nunatak/
        ErrorLog /tmp/test-error.log
        LogLevel debug
        PythonConnectionHandler protocol
</VirtualHost>

in /var/www/nunatak/protocol.py:

from mod_python import apache
 
def connectionhandler(conn):
    conn.write("Hello!")
    f = open("/tmp/foo.log", "w+")
    f.write("foo happened!\n")
    f.close()
    return apache.OK

when I telnet to localhost 4444 I get:

Trying 192.168.0.18...
Connected to balrog.localnet.
Escape character is '^]'.
Connection closed by foreign host.

I have no /tmp/foo.log at all, which makes me think the script has not 
been located/run

in my ErrorLog for the virtual host I have:
[Tue Dec 16 23:26:23 2003] [error] python_connection: 
ConnectionDispatch() returned nothing.


Im guessing its a problem with my virtualhost definition not being set 
up correctly, but in the docs
for mod_python there is not much more info on this subject.

-tjs


From kevin at sb.org  Mon Dec 15 21:05:45 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:54:07 2004
Subject: [mod_python] Strange server errors
In-Reply-To: <DC81D053-2F5E-11D8-B6D0-000A95A072FC@sb.org>
References: <DC81D053-2F5E-11D8-B6D0-000A95A072FC@sb.org>
Message-ID: <5C2E79EA-2F6C-11D8-B6D0-000A95A072FC@sb.org>

Argh. Sorry for bothering you with my problems. I just found the cause 
and it's not mod_python's fault. The problem is doing a graceful 
restart of apache isn't actually restarting properly, which is causing 
conflicts when accessing python scripts. If I stop the server, wait for 
it to finish shutting down, then start it back up, everything works 
just fine.

On Dec 15, 2003, at 7:29 PM, Kevin Ballard wrote:

> This is really strange. I tested my form.py thing from the Tutorial 
> and it would just hang. I'd get absolutely no response from the 
> server. I tried a few times, and then I started getting internal 
> server errors instead, but with nothing in the error log. So I quit 
> Apache and started httpd back up in single process mode (sudo ./httpd 
> -DONE_PROCESS, as per the Troubleshooting section). At that point, my 
> scripts magically started working (with no output to the shell from 
> httpd). I then quit that and started Apache back up normally, and my 
> scripts continue to work. Any idea what was going on, in case this 
> weird stuff happens again?

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org


From grisha at modpython.org  Mon Dec 15 22:37:51 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:54:07 2004
Subject: [mod_python] PythonConnectionHandler directive
In-Reply-To: <3FDE603A.3010100@nunatak.com.au>
References: <3FDE603A.3010100@nunatak.com.au>
Message-ID: <20031215223427.U71289@onyx.ispol.com>


I think the problem is the python path. Try making sure that the directory
where protocol.py is located is added to PythonPath:

PythonPath "sys.path+['/var/www/nunatak']"

Since this is a connection handler, the DocumentRoot is irrelevant and
the path in it has no effect.

Grisha

On Tue, 16 Dec 2003, Timothy Stebbing wrote:

> Howdy,
>
> Im trying to get a simple protocol handler running, yet apache does not
> seem to be calling my code.
>
> I have this in my apache config, this starts without any errors:
>
> Listen 192.168.0.18:4444
> <VirtualHost 192.168.0.18:4444>
>         ServerAdmin webmaster@localhost
>         DocumentRoot /var/www/nunatak/
>         ErrorLog /tmp/test-error.log
>         LogLevel debug
>         PythonConnectionHandler protocol
> </VirtualHost>
>
> in /var/www/nunatak/protocol.py:
>
> from mod_python import apache
>
> def connectionhandler(conn):
>     conn.write("Hello!")
>     f = open("/tmp/foo.log", "w+")
>     f.write("foo happened!\n")
>     f.close()
>     return apache.OK
>
> when I telnet to localhost 4444 I get:
>
> Trying 192.168.0.18...
> Connected to balrog.localnet.
> Escape character is '^]'.
> Connection closed by foreign host.
>
> I have no /tmp/foo.log at all, which makes me think the script has not
> been located/run
>
> in my ErrorLog for the virtual host I have:
> [Tue Dec 16 23:26:23 2003] [error] python_connection:
> ConnectionDispatch() returned nothing.
>
>
> Im guessing its a problem with my virtualhost definition not being set
> up correctly, but in the docs
> for mod_python there is not much more info on this subject.
>
> -tjs
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From ron at UDel.Edu  Tue Dec 16 08:35:33 2003
From: ron at UDel.Edu (Ron Reisor)
Date: Fri Jan  9 21:54:07 2004
Subject: [mod_python] re: trouble installing mod_python
In-Reply-To: <2A3E42DA-2F2D-11D8-A794-000A95B33D28@gsoa.net>
References: <2A3E42DA-2F2D-11D8-A794-000A95B33D28@gsoa.net>
Message-ID: <Pine.SOL.4.58L.0312160832400.12072@copland.udel.edu>

Mark,

   This patch works well for us too.

   Forget the hack I offered.

   Would you suggest this to python-dev@httpd.apache.org to see if it can
get added to the distribution?

thanks,

Ron


On Mon, 15 Dec 2003, Mark McClain wrote:

> I've been able to build mod_python on 10.3 making very few changes.
> This process uses python 2.3 that comes with 10.3.  The problem that
> you are experiencing is because the linker does not get told to link to
> the python framework by apxs.
>
> mark
>
> 1) Build and install apache2
>
> 2) Unpack the mod_python distribution
>
> 3) make the following changes to the configure script. here it is in
> modified form...
>
> if test "$PyFRAMEWORKDIR" != "no-framework"; then
>    if test -n "$PyFRAMEWORK"; then
>      PyPYTHONLIBS="-framework $PyFRAMEWORK"
>
>     # explicitly pass to mac linker so add this line
>      LDFLAGS="${LDFLAGS} -Wl,-framework,Python"
>    fi
>
> 4) run configure, make, then install
>
> Good luck,
>
> mark
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

Ron Reisor <ron@udel.edu> (RWR3)
University of Delaware Information Technologies/Network and Systems Services
Computing Center/192 South Chapel Street/Newark DE, 19716
pgp finger print: 0D 73 06 6F D3 6A 99 D3  F5 D5 6E FF 3B B9 7C 2C
From fccoelho at fiocruz.br  Wed Dec 17 15:07:53 2003
From: fccoelho at fiocruz.br (Flavio C. Coelho)
Date: Fri Jan  9 21:54:07 2004
Subject: [mod_python] mod_python and the semaphore bug
Message-ID: <1071680872.3902.13.camel@pinguim.procc.fiocruz.br>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: fiocruz4.jpg
Type: image/jpeg
Size: 3085 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20031217/2a49fe91/fiocruz4-0001.jpg
From giampiero.benvenuti at chiaroscuro.com  Wed Dec 17 18:31:39 2003
From: giampiero.benvenuti at chiaroscuro.com (Giampiero Benvenuti)
Date: Fri Jan  9 21:54:07 2004
Subject: [mod_python] mod_python & MySQLdb question
Message-ID: <DF4889B2-30B6-11D8-9E76-003065D5834A@chiaroscuro.com>

Hello to all of you,

I'm quite intrigued by mod_python and the difference with "normal" 
python cgi...

for instance: I can't make this great pice of code (Jaroslaw Zabiello, 
http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/171463) wich 
works great in my cgi-bin directory, working with mod_python.

The problem I have is right at the end, when I have to deal with:

  for row in rows:
     print row['name'], row['txt']

The question is: how can I translate this last part of code to make it 
working with mod_python?

the great code:
----------------------------------
import MySQLdb
import MySQLdb.cursors

conn = MySQLdb.Connect(
     host='localhost', user='root',
     passwd='', db='test',compress=1,
     cursorclass=MySQLdb.cursors.DictCursor) # <- important
cursor = conn.cursor()
cursor.execute("SELECT name, sometext txt FROM foo")
rows = cursor.fetchall()
cursor.close()
conn.close()

for row in rows:
     print row['name'], row['txt'] # bingo!
------------------------------------

any help is much appreciated.

Thanks,

Giampiero

From tpc at csua.berkeley.edu  Wed Dec 17 09:40:52 2003
From: tpc at csua.berkeley.edu (tpc@csua.berkeley.edu)
Date: Fri Jan  9 21:54:07 2004
Subject: [mod_python] mod_python & MySQLdb question
In-Reply-To: <DF4889B2-30B6-11D8-9E76-003065D5834A@chiaroscuro.com>
Message-ID: <20031217093408.M44175-100000@localhost.name>


hi Giampiero, instead of print or echo, you use return or req.write.  I
had a similar question here:

http://www.modpython.org/pipermail/mod_python/2003-June/003263.html

I hope that helps you.

On Wed, 17 Dec 2003, Giampiero Benvenuti wrote:

> Hello to all of you,
>
> I'm quite intrigued by mod_python and the difference with "normal"
> python cgi...
>
> for instance: I can't make this great pice of code (Jaroslaw Zabiello,
> http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/171463) wich
> works great in my cgi-bin directory, working with mod_python.
>
> The problem I have is right at the end, when I have to deal with:
>
>   for row in rows:
>      print row['name'], row['txt']
>
> The question is: how can I translate this last part of code to make it
> working with mod_python?
>
> the great code:
> ----------------------------------
> import MySQLdb
> import MySQLdb.cursors
>
> conn = MySQLdb.Connect(
>      host='localhost', user='root',
>      passwd='', db='test',compress=1,
>      cursorclass=MySQLdb.cursors.DictCursor) # <- important
> cursor = conn.cursor()
> cursor.execute("SELECT name, sometext txt FROM foo")
> rows = cursor.fetchall()
> cursor.close()
> conn.close()
>
> for row in rows:
>      print row['name'], row['txt'] # bingo!
> ------------------------------------
>
> any help is much appreciated.
>
> Thanks,
>
> Giampiero
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>


From jciccale at mac.com  Wed Dec 17 23:37:11 2003
From: jciccale at mac.com (Julian Ciccale)
Date: Fri Jan  9 21:54:07 2004
Subject: [mod_python] mod_python and the semaphore bug
Message-ID: <8794402.1071700631675.JavaMail.jciccale@mac.com>

Try checking out the latest CVS sources of line 3.1.x . I think this problem is solved in
the CVS.

- julcicc - 
On Wednesday, December 17, 2003, at 06:07PM, Flavio C. Coelho <fccoelho@fiocruz.br> wrote:

>
><<Original Attached>>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20031217/439af9da/attachment-0001.htm
From tim.stebbing at nunatak.com.au  Thu Dec 18 10:14:40 2003
From: tim.stebbing at nunatak.com.au (Timothy Stebbing)
Date: Fri Jan  9 21:54:07 2004
Subject: [mod_python] Persistant data
Message-ID: <3FE0E360.4060002@nunatak.com.au>

Is there some way to persist data resource using apache? Im writing a 
simple protocol module
using PythonConnectionHandler, this takes queries and runs them against 
various backends,
ie postgres, Lupy (indexer), etc. I want to persist my connections to 
these resources across all
requests.

Ive tried adding a db 'pool' into a module, but the module is reloaded 
for each request serviced.

Im wondering if there is some way I can add objects into these 'apache 
tables' ? would that make
them persistant, and if so how do I do that? I was also wondering if I 
could somehow access the
main namespace from child interpreters?

cheers

tjs

From michael at dynamine.net  Wed Dec 17 15:21:29 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 21:54:07 2004
Subject: [mod_python] Persistant data
In-Reply-To: <3FE0E360.4060002@nunatak.com.au>
References: <3FE0E360.4060002@nunatak.com.au>
Message-ID: <3FE0E4F9.8010302@dynamine.net>

In the interest of keeping it simple, I suggest you store your 
persistent data using anydbm and use synchronization techniques (i.e. 
rename) to ensure that two processes don't try to write to the database 
simultaneously (mid-air collision).  Other techniques just give you more 
code complexity and not much added benefit.

This is pretty much exactly what the new session code in 3.1.2b does.

--Michael

Timothy Stebbing wrote:

> Is there some way to persist data resource using apache? Im writing a 
> simple protocol module
> using PythonConnectionHandler, this takes queries and runs them against 
> various backends,
> ie postgres, Lupy (indexer), etc. I want to persist my connections to 
> these resources across all
> requests.
> 
> Ive tried adding a db 'pool' into a module, but the module is reloaded 
> for each request serviced.
> 
> Im wondering if there is some way I can add objects into these 'apache 
> tables' ? would that make
> them persistant, and if so how do I do that? I was also wondering if I 
> could somehow access the
> main namespace from child interpreters?
> 
> cheers
> 
> tjs
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 
From kevin at sb.org  Wed Dec 17 19:00:47 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:54:07 2004
Subject: [mod_python] config tree for htaccess
Message-ID: <3B9F1328-30ED-11D8-B6D0-000A95A072FC@sb.org>

Is there any way to get the config tree from any relevant .htaccess 
files as well as just the httpd.conf file, or do I have to look for and 
parse them manually? Also, is there any way to get the applicable 
config lines from the httpd.conf file, i.e. the ones inside 
<Directory>/<Files>/etc. blocks that apply to the current URI without 
having to parse them all manually?

I'm writing a script that mimics FancyIndexing and it's mostly done 
(i.e. it does just about everything except let you sort by headers, 
including scanning the AddIcon/AddIconByType/AddDescription lines in 
apache.config_tree(), and looks identical to the FancyIndexing in the 
rendered version (i.e. the source is cleaner, but the result is 
identical)), but it only uses the config directives in the root of 
httpd.conf (i.e. the root of apache.config_tree()) and I'd like to make 
it use all applicable directives.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org


From giampiero.benvenuti at chiaroscuro.com  Thu Dec 18 01:54:59 2003
From: giampiero.benvenuti at chiaroscuro.com (Giampiero Benvenuti)
Date: Fri Jan  9 21:54:07 2004
Subject: [mod_python] mod_python & MySQLdb question
In-Reply-To: <20031217093408.M44175-100000@localhost.name>
Message-ID: <CE1FDA4E-30F4-11D8-9E76-003065D5834A@chiaroscuro.com>

Thanks for your prompt answer and your help.

I'm coming from Zope, just got to mod_python a week ago. Please 
understand my being na?ve.

I'm not quite there yet: thanks to your help now I'm able to get all my 
titles form mysql, but at the
end of the page (sigh) I get an apache error: "500 Internal Server 
Error"
"The server encountered an internal error or misconfiguration and was 
unable to complete your request..."

Apache is not OK at all.

here is my code:

import MySQLdb, MySQLdb.cursors
from mod_python import apache

def read(req):
	req.content_type = "text/html"
	mydb = MySQLdb.connect(db='S_N', user='giampiero', compress=1, 
cursorclass=MySQLdb.cursors.DictCursor)
	cursor = mydb.cursor()
	stmt = "SELECT news_title FROM news"
	cursor.execute(stmt)
	rows = cursor.fetchall()
	mydb.close()
	for row in rows:
		s = row['news_title']
		print s
	return apache.OK

Thank you guys,

Giampiero





On Mercoled?, dic 17, 2003, at 18:40 Europe/Rome, 
<tpc@csua.berkeley.edu> wrote:

>
> hi Giampiero, instead of print or echo, you use return or req.write.  I
> had a similar question here:
>
> http://www.modpython.org/pipermail/mod_python/2003-June/003263.html
>
> I hope that helps you.
>
> On Wed, 17 Dec 2003, Giampiero Benvenuti wrote:
>
>> Hello to all of you,
>>
>> I'm quite intrigued by mod_python and the difference with "normal"
>> python cgi...
>>
>> for instance: I can't make this great pice of code (Jaroslaw Zabiello,
>> http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/171463) wich
>> works great in my cgi-bin directory, working with mod_python.
>>
>> The problem I have is right at the end, when I have to deal with:
>>
>>   for row in rows:
>>      print row['name'], row['txt']
>>
>> The question is: how can I translate this last part of code to make it
>> working with mod_python?
>>
>> the great code:
>> ----------------------------------
>> import MySQLdb
>> import MySQLdb.cursors
>>
>> conn = MySQLdb.Connect(
>>      host='localhost', user='root',
>>      passwd='', db='test',compress=1,
>>      cursorclass=MySQLdb.cursors.DictCursor) # <- important
>> cursor = conn.cursor()
>> cursor.execute("SELECT name, sometext txt FROM foo")
>> rows = cursor.fetchall()
>> cursor.close()
>> conn.close()
>>
>> for row in rows:
>>      print row['name'], row['txt'] # bingo!
>> ------------------------------------
>>
>> any help is much appreciated.
>>
>> Thanks,
>>
>> Giampiero
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>
>
>
>


From michael at dynamine.net  Wed Dec 17 16:57:47 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 21:54:07 2004
Subject: [mod_python] mod_python & MySQLdb question
In-Reply-To: <CE1FDA4E-30F4-11D8-9E76-003065D5834A@chiaroscuro.com>
References: <CE1FDA4E-30F4-11D8-9E76-003065D5834A@chiaroscuro.com>
Message-ID: <3FE0FB8B.3050200@dynamine.net>

What does the Apache error log have to say about it?

--Michael

Giampiero Benvenuti wrote:

> Thanks for your prompt answer and your help.
> 
> I'm coming from Zope, just got to mod_python a week ago. Please 
> understand my being na?ve.
> 
> I'm not quite there yet: thanks to your help now I'm able to get all my 
> titles form mysql, but at the
> end of the page (sigh) I get an apache error: "500 Internal Server Error"
> "The server encountered an internal error or misconfiguration and was 
> unable to complete your request..."
> 
> Apache is not OK at all.
> 
> here is my code:
> 
> import MySQLdb, MySQLdb.cursors
> from mod_python import apache
> 
> def read(req):
>     req.content_type = "text/html"
>     mydb = MySQLdb.connect(db='S_N', user='giampiero', compress=1, 
> cursorclass=MySQLdb.cursors.DictCursor)
>     cursor = mydb.cursor()
>     stmt = "SELECT news_title FROM news"
>     cursor.execute(stmt)
>     rows = cursor.fetchall()
>     mydb.close()
>     for row in rows:
>         s = row['news_title']
>         print s
>     return apache.OK
> 
> Thank you guys,
> 
> Giampiero
> 
> 
> 
> 
> 
> On Mercoled?, dic 17, 2003, at 18:40 Europe/Rome, 
> <tpc@csua.berkeley.edu> wrote:
> 
>>
>> hi Giampiero, instead of print or echo, you use return or req.write.  I
>> had a similar question here:
>>
>> http://www.modpython.org/pipermail/mod_python/2003-June/003263.html
>>
>> I hope that helps you.
>>
>> On Wed, 17 Dec 2003, Giampiero Benvenuti wrote:
>>
>>> Hello to all of you,
>>>
>>> I'm quite intrigued by mod_python and the difference with "normal"
>>> python cgi...
>>>
>>> for instance: I can't make this great pice of code (Jaroslaw Zabiello,
>>> http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/171463) wich
>>> works great in my cgi-bin directory, working with mod_python.
>>>
>>> The problem I have is right at the end, when I have to deal with:
>>>
>>>   for row in rows:
>>>      print row['name'], row['txt']
>>>
>>> The question is: how can I translate this last part of code to make it
>>> working with mod_python?
>>>
>>> the great code:
>>> ----------------------------------
>>> import MySQLdb
>>> import MySQLdb.cursors
>>>
>>> conn = MySQLdb.Connect(
>>>      host='localhost', user='root',
>>>      passwd='', db='test',compress=1,
>>>      cursorclass=MySQLdb.cursors.DictCursor) # <- important
>>> cursor = conn.cursor()
>>> cursor.execute("SELECT name, sometext txt FROM foo")
>>> rows = cursor.fetchall()
>>> cursor.close()
>>> conn.close()
>>>
>>> for row in rows:
>>>      print row['name'], row['txt'] # bingo!
>>> ------------------------------------
>>>
>>> any help is much appreciated.
>>>
>>> Thanks,
>>>
>>> Giampiero
>>>
>>> _______________________________________________
>>> Mod_python mailing list
>>> Mod_python@modpython.org
>>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>>
>>
>>
>>
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 
From rey4 at columbia.edu  Wed Dec 17 20:16:40 2003
From: rey4 at columbia.edu (Russell Yanofsky)
Date: Fri Jan  9 21:54:07 2004
Subject: [mod_python] Re: Persistant data
References: <3FE0E360.4060002@nunatak.com.au>
Message-ID: <brqv6q$3h7$1@sea.gmane.org>

Timothy Stebbing wrote:
> Is there some way to persist data resource using apache? Im writing a
> simple protocol module
> using PythonConnectionHandler, this takes queries and runs them
> against various backends,
> ie postgres, Lupy (indexer), etc. I want to persist my connections to
> these resources across all
> requests.
>
> Ive tried adding a db 'pool' into a module, but the module is reloaded
> for each request serviced.

Is the module containing the db pool the same one that you specified in
PythonConnectionHandler? If so, you should try storing the pool in a
different module and accessing it with an import statement.

> Im wondering if there is some way I can add objects into these 'apache
> tables' ? would that make
> them persistant, and if so how do I do that? I was also wondering if I
> could somehow access the
> main namespace from child interpreters?

I doubt Mod_Python is using a different interpreter for each request. It's
probably just reloading the one module.

- Russ


From rey4 at columbia.edu  Wed Dec 17 20:23:07 2003
From: rey4 at columbia.edu (Russell Yanofsky)
Date: Fri Jan  9 21:54:07 2004
Subject: [mod_python] Re: Persistant data
References: <3FE0E360.4060002@nunatak.com.au> <3FE0E4F9.8010302@dynamine.net>
Message-ID: <brqvih$42s$1@sea.gmane.org>

Michael S. Fischer wrote:
> In the interest of keeping it simple, I suggest you store your
> persistent data using anydbm and use synchronization techniques 

Heh. You want him to store his database connections in a database?

- Russ

From michael at dynamine.net  Wed Dec 17 17:29:08 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 21:54:07 2004
Subject: [mod_python] Re: Persistant data
In-Reply-To: <brqvih$42s$1@sea.gmane.org>
References: <3FE0E360.4060002@nunatak.com.au> <3FE0E4F9.8010302@dynamine.net>
	<brqvih$42s$1@sea.gmane.org>
Message-ID: <3FE102E4.9020506@dynamine.net>

> Michael S. Fischer wrote:
> 
>>In the interest of keeping it simple, I suggest you store your
>>persistent data using anydbm and use synchronization techniques 
> 
> 
> Heh. You want him to store his database connections in a database?

Oh, I must have misread his message.  Silly me.  *blush*

His question seems to be a FAQ.  Isn't it covered in there?

--Michael
From grisha at modpython.org  Wed Dec 17 21:59:16 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:54:07 2004
Subject: [mod_python] config tree for htaccess
In-Reply-To: <3B9F1328-30ED-11D8-B6D0-000A95A072FC@sb.org>
References: <3B9F1328-30ED-11D8-B6D0-000A95A072FC@sb.org>
Message-ID: <20031217215114.Q1381@onyx.ispol.com>


The config_tree only gives you what is in the main config file, that is
correct.

I am not sure that it is technically possible to get what's in .htaccess
other than reading it. As the .htaccess file is parsed, individual
directives result in calls into modules, which then do things accordingly,
but I don't think httpd tries to store this information anywhere
separately.

Grisha

On Wed, 17 Dec 2003, Kevin Ballard wrote:

> Is there any way to get the config tree from any relevant .htaccess
> files as well as just the httpd.conf file, or do I have to look for and
> parse them manually? Also, is there any way to get the applicable
> config lines from the httpd.conf file, i.e. the ones inside
> <Directory>/<Files>/etc. blocks that apply to the current URI without
> having to parse them all manually?
>
> I'm writing a script that mimics FancyIndexing and it's mostly done
> (i.e. it does just about everything except let you sort by headers,
> including scanning the AddIcon/AddIconByType/AddDescription lines in
> apache.config_tree(), and looks identical to the FancyIndexing in the
> rendered version (i.e. the source is cleaner, but the result is
> identical)), but it only uses the config directives in the root of
> httpd.conf (i.e. the root of apache.config_tree()) and I'd like to make
> it use all applicable directives.
>
> --
> Kevin Ballard
> kevin@sb.org
> http://www.tildesoft.com
> http://kevin.sb.org
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From davidf at sjsoft.com  Thu Dec 18 08:24:56 2003
From: davidf at sjsoft.com (David Fraser)
Date: Fri Jan  9 21:54:07 2004
Subject: [mod_python] Re: Persistant data
In-Reply-To: <brqv6q$3h7$1@sea.gmane.org>
References: <3FE0E360.4060002@nunatak.com.au> <brqv6q$3h7$1@sea.gmane.org>
Message-ID: <3FE14838.1080707@sjsoft.com>

Russell Yanofsky wrote:

>Timothy Stebbing wrote:
>  
>
>>Is there some way to persist data resource using apache? Im writing a
>>simple protocol module
>>using PythonConnectionHandler, this takes queries and runs them
>>against various backends,
>>ie postgres, Lupy (indexer), etc. I want to persist my connections to
>>these resources across all
>>requests.
>>
>>Ive tried adding a db 'pool' into a module, but the module is reloaded
>>for each request serviced.
>>    
>>
>
>Is the module containing the db pool the same one that you specified in
>PythonConnectionHandler? If so, you should try storing the pool in a
>different module and accessing it with an import statement.
>
>  
>
>>Im wondering if there is some way I can add objects into these 'apache
>>tables' ? would that make
>>them persistant, and if so how do I do that? I was also wondering if I
>>could somehow access the
>>main namespace from child interpreters?
>>    
>>
>
>I doubt Mod_Python is using a different interpreter for each request. It's
>probably just reloading the one module.
>  
>
It's quite possible that mod_python is using different interpreters for 
different requests if Apache is loaded with multiple processes. Each 
process will then have its own interpreter. So if you have 20 
interpreters, the likelihood that the first 4 requests each use a unique 
interpreter is 72.67%
This can make it look like each request uses its own interpreter, 
whereas actually there are a pool of interpreters being shared

David


From giampiero.benvenuti at chiaroscuro.com  Thu Dec 18 11:13:10 2003
From: giampiero.benvenuti at chiaroscuro.com (Giampiero Benvenuti)
Date: Fri Jan  9 21:54:08 2004
Subject: [mod_python] mod_python & MySQLdb question: Done
In-Reply-To: <CE1FDA4E-30F4-11D8-9E76-003065D5834A@chiaroscuro.com>
Message-ID: <C88B4324-3142-11D8-913D-003065D5834A@chiaroscuro.com>

Ok, thanks to your help an thanks to the mailing list archives I did 
find the solution (it's working for me, I'm not sure
it's the "right" one):

here is the code:

------------------------------------------------------------------
import MySQLdb, MySQLdb.cursors, mod_python

def readtitle(req):
	req.content_type = "text/html"
	req.send_http_header()
	mydb = MySQLdb.connect(db='S_N', user='giampiero', compress=1, 
cursorclass=MySQLdb.cursors.DictCursor)
	cursor = mydb.cursor()
	stmt = "SELECT news_title FROM news"
	cursor.execute(stmt)
	rows = cursor.fetchall()
	rows = list(rows)
	for row in rows:
		results = (row['news_title']+',<br>')
		req.write(results)
	
	raise mod_python.apache.SERVER_RETURN, mod_python.apache.OK
----------------------------------------------------------------

Thanks to all of you: great mailing list with nice people. I never gona 
go back umiliated to Zope now:)

Giampiero

On Gioved?, dic 18, 2003, at 01:54 Europe/Rome, Giampiero Benvenuti 
wrote:

> Thanks for your prompt answer and your help.
>
> I'm coming from Zope, just got to mod_python a week ago. Please 
> understand my being na?ve.
>
> I'm not quite there yet: thanks to your help now I'm able to get all 
> my titles form mysql, but at the
> end of the page (sigh) I get an apache error: "500 Internal Server 
> Error"
> "The server encountered an internal error or misconfiguration and was 
> unable to complete your request..."
>
> Apache is not OK at all.
>
> here is my code:
>
> import MySQLdb, MySQLdb.cursors
> from mod_python import apache
>
> def read(req):
> 	req.content_type = "text/html"
> 	mydb = MySQLdb.connect(db='S_N', user='giampiero', compress=1, 
> cursorclass=MySQLdb.cursors.DictCursor)
> 	cursor = mydb.cursor()
> 	stmt = "SELECT news_title FROM news"
> 	cursor.execute(stmt)
> 	rows = cursor.fetchall()
> 	mydb.close()
> 	for row in rows:
> 		s = row['news_title']
> 		print s
> 	return apache.OK
>
> Thank you guys,
>
> Giampiero
>
>
>
>
>
> On Mercoled?, dic 17, 2003, at 18:40 Europe/Rome, 
> <tpc@csua.berkeley.edu> wrote:
>
>>
>> hi Giampiero, instead of print or echo, you use return or req.write.  
>> I
>> had a similar question here:
>>
>> http://www.modpython.org/pipermail/mod_python/2003-June/003263.html
>>
>> I hope that helps you.
>>
>> On Wed, 17 Dec 2003, Giampiero Benvenuti wrote:
>>
>>> Hello to all of you,
>>>
>>> I'm quite intrigued by mod_python and the difference with "normal"
>>> python cgi...
>>>
>>> for instance: I can't make this great pice of code (Jaroslaw 
>>> Zabiello,
>>> http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/171463) wich
>>> works great in my cgi-bin directory, working with mod_python.
>>>
>>> The problem I have is right at the end, when I have to deal with:
>>>
>>>   for row in rows:
>>>      print row['name'], row['txt']
>>>
>>> The question is: how can I translate this last part of code to make 
>>> it
>>> working with mod_python?
>>>
>>> the great code:
>>> ----------------------------------
>>> import MySQLdb
>>> import MySQLdb.cursors
>>>
>>> conn = MySQLdb.Connect(
>>>      host='localhost', user='root',
>>>      passwd='', db='test',compress=1,
>>>      cursorclass=MySQLdb.cursors.DictCursor) # <- important
>>> cursor = conn.cursor()
>>> cursor.execute("SELECT name, sometext txt FROM foo")
>>> rows = cursor.fetchall()
>>> cursor.close()
>>> conn.close()
>>>
>>> for row in rows:
>>>      print row['name'], row['txt'] # bingo!
>>> ------------------------------------
>>>
>>> any help is much appreciated.
>>>
>>> Thanks,
>>>
>>> Giampiero
>>>
>>> _______________________________________________
>>> Mod_python mailing list
>>> Mod_python@modpython.org
>>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>>
>>
>>
>>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>


From manfred.stienstra at dwerg.net  Thu Dec 18 11:29:39 2003
From: manfred.stienstra at dwerg.net (Manfred Stienstra)
Date: Fri Jan  9 21:54:08 2004
Subject: [mod_python] mod_python & MySQLdb question: Done
In-Reply-To: <C88B4324-3142-11D8-913D-003065D5834A@chiaroscuro.com>
References: <C88B4324-3142-11D8-913D-003065D5834A@chiaroscuro.com>
Message-ID: <1071743378.12631.7.camel@ack.dwerg.net>

On Thu, 2003-12-18 at 11:13, Giampiero Benvenuti wrote:
> import MySQLdb, MySQLdb.cursors, mod_python
> 
> def readtitle(req):
> 	req.content_type = "text/html"
> 	req.send_http_header()
> 	mydb = MySQLdb.connect(db='S_N', user='giampiero', compress=1, 
> cursorclass=MySQLdb.cursors.DictCursor)
> 	cursor = mydb.cursor()
> 	stmt = "SELECT news_title FROM news"
> 	cursor.execute(stmt)
> 	rows = cursor.fetchall()
> 	rows = list(rows)
> 	for row in rows:
> 		results = (row['news_title']+',<br>')
> 		req.write(results)
> 	
> 	raise mod_python.apache.SERVER_RETURN, mod_python.apache.OK


This:

> 	rows = cursor.fetchall()
> 	rows = list(rows)
> 	for row in rows:
> 		results = (row['news_title']+',<br>')
> 		req.write(results)

can be compressed to (and made faster):


results = []
for row in cursor.fetchall():
	results.append(row['news_title'])
req.write("<br />".join(results))


Also using the DictCursor gives a little overhead in this case. This is
ofcourse not a real problem on small queries like this one.

Manfred

From giampiero.benvenuti at chiaroscuro.com  Thu Dec 18 14:56:44 2003
From: giampiero.benvenuti at chiaroscuro.com (Giampiero Benvenuti)
Date: Fri Jan  9 21:54:08 2004
Subject: [mod_python] mod_python & MySQLdb question: Done
In-Reply-To: <1071743378.12631.7.camel@ack.dwerg.net>
Message-ID: <03B2DC68-3162-11D8-913D-003065D5834A@chiaroscuro.com>

Thanks Manfred, now I'm starting to "see".
Great tip, it works like a "swiss" clock.

> This:
>
>> 	rows = cursor.fetchall()
>> 	rows = list(rows)
>> 	for row in rows:
>> 		results = (row['news_title']+',<br>')
>> 		req.write(results)
>
> can be compressed to (and made faster):
>
>
> results = []
> for row in cursor.fetchall():
> 	results.append(row['news_title'])
> req.write("<br />".join(results))
>

From tpc at csua.berkeley.edu  Thu Dec 18 08:45:41 2003
From: tpc at csua.berkeley.edu (tpc@csua.berkeley.edu)
Date: Fri Jan  9 21:54:08 2004
Subject: [mod_python] mod_python & MySQLdb question: Done
In-Reply-To: <03B2DC68-3162-11D8-913D-003065D5834A@chiaroscuro.com>
Message-ID: <20031218084200.O51827-100000@localhost.name>


hi Giampiero, can I ask you, being a newbie to Python
myself, why you are switching to modpython from Zope ?
I have heard many good things about Zope but have not
had the time to download and use it, but from what I hear
if you want to serve a complex database-backed application
there is no better way.

On Thu, 18 Dec 2003, Giampiero Benvenuti wrote:

> Thanks Manfred, now I'm starting to "see".
> Great tip, it works like a "swiss" clock.
>
> > This:
> >
> >> 	rows = cursor.fetchall()
> >> 	rows = list(rows)
> >> 	for row in rows:
> >> 		results = (row['news_title']+',<br>')
> >> 		req.write(results)
> >
> > can be compressed to (and made faster):
> >
> >
> > results = []
> > for row in cursor.fetchall():
> > 	results.append(row['news_title'])
> > req.write("<br />".join(results))
> >
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From giampiero.benvenuti at chiaroscuro.com  Fri Dec 19 11:05:55 2003
From: giampiero.benvenuti at chiaroscuro.com (Giampiero Benvenuti)
Date: Fri Jan  9 21:54:08 2004
Subject: Zope vs. mod_python!? It was "Re: [mod_python] mod_python & MySQLdb
	question: Done"
In-Reply-To: <20031218084200.O51827-100000@localhost.name>
Message-ID: <EF2C53EE-320A-11D8-913D-003065D5834A@chiaroscuro.com>


On Gioved?, dic 18, 2003, at 17:45 Europe/Rome, <tpc@csua.berkeley.edu> 
wrote:

>
> hi Giampiero, can I ask you, being a newbie to Python
> myself, why you are switching to modpython from Zope ?
> I have heard many good things about Zope but have not
> had the time to download and use it, but from what I hear
> if you want to serve a complex database-backed application
> there is no better way.

I'm not sure I can give a detailed and precise answer to your question.
Please keep in mind that I don't have any formal education in 
programming
but in photography and arts.

As far as I can see, Zope is a great tool, well designed and with great
performance. I started using it 2 years ago and it took me quite some 
time
to figure it out. I developed a few sites using it: www.cercacultura.it 
is
one of them. cercacultura.it is totally Zope based and uses the internal
ZODB database.

What triggered my curiosity in python/mod_python is the fact that Zope 
is
built "over" python and actualy the right way to use it is to keep the
business logic in python and the presentation in dtml, the Zope markup
language.
Now I am starting to experience Zope as a kind of "filter" that doesn't 
let
me really understand what is going on underneath. A sort of second 
language
that prevents you from speaking your first language. For this reason I 
am
starting to feel the limits of Zope.

What I can say now is that learning python created a new challenge and a
way to find faster and more transparent solutions. I also read that with
mod_python you can actually use some Zope modules (Zpublisher for 
example).
I very much like the mod_python integration in apache, which allows to
bypass the zope server.

There is much more to say about it, and I'm sure other people on the 
list
can be more articulate on this issue.

Thanks,

Giampiero


From fowlertrainer at anonym.hu  Fri Dec 19 12:24:08 2003
From: fowlertrainer at anonym.hu (fowlertrainer@anonym.hu)
Date: Fri Jan  9 21:54:08 2004
Subject: [mod_python] Newbie questions 1
Message-ID: <15814100725.20031219122408@anonym.hu>

Hello !

I've been used php, and zope before, but I want to try the mod_python,
becuase the py lang is seems to be better than these web-dev
langs/tools.

Some structural/tehnological questions:

1.
  I want to know, how many times used the mp_req objects ?
  Is eliminate mod_python this elements, if some of these objects don't
  needed longer ?
  I try to understand, how to be working.
  I see, that I can define global variables in main module, and the
  globals are globals in every mp_req.
  But if the system eliminate all of this objects, can holding these
  global vars ?

  Why are write this question ?

  I want to create a file or memory storaged session system.
  If the memory is cleared by every N time, it have been failed...
  So it is needed to be I have fix elements.

2.
  Is the mod_py regenerate the existing objects, and clear memory if I change the
  source code, and I have two threads/two existing objects in alive ?
  

-- 
Best regards,
 fowlertrainer                          mailto:fowlertrainer@anonym.hu

From fowlertrainer at anonym.hu  Fri Dec 19 12:31:04 2003
From: fowlertrainer at anonym.hu (fowlertrainer@anonym.hu)
Date: Fri Jan  9 21:54:08 2004
Subject: [mod_python] Newbie questions 2
Message-ID: <8314517404.20031219123104@anonym.hu>

Hello !

Part 2:

  3.
      How to I prevent some effects ?
      I want to be create an one-main-file-handled site.

      a.) So I want to remove the .py from main.py file in the
          browser, if possible.
      b.) I want to eliminate or redirect the main.pyc file, what is
          created by python in everytime.
          This file is downloadable from browser, and if any users
          have some python experience, or an decompiler, that these
          persons can get informations from my site !
      c.) I want to the main.py is let my 'index.html', so if I don't
          write any tags, that it have been processed.
          http://site/main.py
          ->
          http://site/main
          ->
          http://site/

          These elements let do same thing !!!

Thanx:
 KK

  

-- 
Best regards,
 fowlertrainer                          mailto:fowlertrainer@anonym.hu

From mod_python at ols.inorganic.org  Fri Dec 19 06:33:34 2003
From: mod_python at ols.inorganic.org (Roy S. Rapoport)
Date: Fri Jan  9 21:54:08 2004
Subject: [mod_python] mod_python & MySQLdb question: Done
In-Reply-To: <20031218084200.O51827-100000@localhost.name>
References: <03B2DC68-3162-11D8-913D-003065D5834A@chiaroscuro.com>
	<20031218084200.O51827-100000@localhost.name>
Message-ID: <20031219143334.GA10524@nag.inorganic.org>

On Thu, Dec 18, 2003 at 08:45:41AM -0800, tpc@csua.berkeley.edu wrote:
> hi Giampiero, can I ask you, being a newbie to Python
> myself, why you are switching to modpython from Zope ?
> I have heard many good things about Zope but have not
> had the time to download and use it, but from what I hear
> if you want to serve a complex database-backed application
> there is no better way.

I'm obviously not Giampiero, but I'll take a stab at answering the question
(disregarding Giampiero's specific circumstances).

I work for a privately-held financial institution in the IT group; I happen
to wear two hats, actually -- I'm a member of both the development and the
infrastructure groups.  Our choice of languages is Python, our choice of
platform on which to develop applications is the web, and our choice of web
platform on which to develop is Zope.  We are heavily invested in Zope and
we love it.  

I especially love Zope because it pretty much enforces an MVC architecture
-- ZSQL methods to access databases, python scripts for business logic,
DTML/ZPT for display logic.  

There's the upside.

The downside? The security (or lackthereof) aspects of running it sometimes
wake me up at night screaming.  OK, that's overstating it, but not by much
:)

The problem with Zope is one of its nicest features -- in-band management.
Got a Zope server at http://my.server ?  Then you can manage it at
http://my.server/manage.  Want to manage http://my.server/some/path? Again,
you can go into the management interfact of Zope on that path at
http://my.server/some/path/manage.  All management of Zope is down through
URL strings ON THE SAME IP AND PORT AS THE CONTENT YOU'RE SERVING.  

Now, again, in some respects this is really nice -- it took us about two
hours to get up a Python program that allowed us to easily synchronize
content between two or more Zope servers by just sending URLs around.  On
the downside, this means that pretty much anyone in the world is guaranteed
to be able to access the management interface of your Zope server and then
it's just a password-guessing attack.  You can front Zope with Apache --
and you're advised to -- and we're continuing to fine-tune our httpd.conf
to block URLs that look like they're management URLs -- but it's a pain,
and error-prone, and not likely to ever be complete.  The official word on
the Zope list is "Yes, it's insecure.  Deal with it and accept it."

In-band management is really user-friendly.  I think it's also a very bad
idea.  I hope they go away from that one of these days.

Oh, one more thing:  Emblematic of many (but not all) open-source projects,
Zope is a wonderful, relatively-well-constructed product with absolutely
atrocious, horrific, monstrously-bad documentation.  It's incomplete (and
in some cases wrong).  Mind you, I'm not sure mod_python is much better,
but I'm not talking about it right now :)

Hope this is useful,
-roy (ex-CSUA and OCF member)

> 
> On Thu, 18 Dec 2003, Giampiero Benvenuti wrote:
> 
> > Thanks Manfred, now I'm starting to "see".
> > Great tip, it works like a "swiss" clock.
> >
> > > This:
> > >
> > >> 	rows = cursor.fetchall()
> > >> 	rows = list(rows)
> > >> 	for row in rows:
> > >> 		results = (row['news_title']+',<br>')
> > >> 		req.write(results)
> > >
> > > can be compressed to (and made faster):
> > >
> > >
> > > results = []
> > > for row in cursor.fetchall():
> > > 	results.append(row['news_title'])
> > > req.write("<br />".join(results))
> > >
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
From gdamjan at mail.net.mk  Fri Dec 19 17:48:27 2003
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 21:54:08 2004
Subject: Zope vs. mod_python!? It was "Re: [mod_python] mod_python &
	MySQLdb question: Done"
In-Reply-To: <EF2C53EE-320A-11D8-913D-003065D5834A@chiaroscuro.com>
References: <20031218084200.O51827-100000@localhost.name>
	<EF2C53EE-320A-11D8-913D-003065D5834A@chiaroscuro.com>
Message-ID: <20031219164827.GB2368@legolas.on.net.mk>

> What I can say now is that learning python created a new challenge and a
> way to find faster and more transparent solutions. I also read that with
> mod_python you can actually use some Zope modules (Zpublisher for 
> example).

It would be great when mod_python could rould replace all the Zope
functionality, and I guess most of it can be done. Parts of Zope that
should be implemented in mod_python are:

- The Zpublisher ... well we already have the publisher in mod_python

- ZODB - I think the standalone ZODB can be easily used in mod_python,
  there might be some threading issues ... maybe.

- ZPT/DTML these also should useable in mod_python as they are ... and
  then there's also mod_python's native PSP.

- ACL's - ACL's are stored in the ZODB in Zope, and are checked by the
  Zpublisher ... we dont have this in mod_python

- WebDav - you can access your Zope objects through WebDav, ACL's
  checked again ... (also mod_python 3.1.2b conflicts somehow with
  apaches mod_dav)

- Zope's *acquisition* inheritance - this is one of the key features in
  Zope. The publisher should support this.

So it seems that an overhauled publisher for mod_python could provide
most, if not all the Zope functionality. 

Also it would be interesting to see if other storage than ZODB could be
implemented with the same features... Linux FS with ACLs and Extended
Attributes for ex. :)


just my $0.02





-- 
Damjan Georgievski
jabberID: damjan@bagra.net.mk
From redconectabilbao at telefonica.net  Fri Dec 19 17:51:45 2003
From: redconectabilbao at telefonica.net (Red Conecta)
Date: Fri Jan  9 21:54:08 2004
Subject: [mod_python] newbie
Message-ID: <3FE32CA1.7070105@telefonica.net>

Hello!

I want to try mod_python, but something doesn't work fine

I'm using Apache 2.0.47 (Mandrake Linux/1.6.91mdk) mod_python/3.0.1 
Python/2.2.2 in a Mandrake9.1 and my  http2.conf is:

...
LoadModule python_module                 extramodules/mod_python.so
...
<Directory /var/www/html>
  AddHandler python-program .py
  PythonHandler mptest
  PythonDebug On
</Directory>

and, of course there's a mptest.py in /var/www/html

But pointing to my mptest.py, my mozilla opens the dialog for 
downloading the file.

What's wrong?

Thanks
**

From kevin at sb.org  Fri Dec 19 15:21:31 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:54:08 2004
Subject: [mod_python] newbie
In-Reply-To: <3FE32CA1.7070105@telefonica.net>
References: <3FE32CA1.7070105@telefonica.net>
Message-ID: <EF2F6572-3260-11D8-B7F9-000A95A072FC@sb.org>

What's your mptest.py look like?

Most likely, it's something like

from apache import *

def handler(req):
	req.write("Hello world!")
	return apache.OK

Is that right? If so, add this line before the req.write line:

	req.content_type = "text/plain"

On Dec 19, 2003, at 11:51 AM, Red Conecta wrote:

> I want to try mod_python, but something doesn't work fine
>
> I'm using Apache 2.0.47 (Mandrake Linux/1.6.91mdk) mod_python/3.0.1 
> Python/2.2.2 in a Mandrake9.1 and my  http2.conf is:
>
> ...
> LoadModule python_module                 extramodules/mod_python.so
> ...
> <Directory /var/www/html>
>  AddHandler python-program .py
>  PythonHandler mptest
>  PythonDebug On
> </Directory>
>
> and, of course there's a mptest.py in /var/www/html
>
> But pointing to my mptest.py, my mozilla opens the dialog for 
> downloading the file.
>
> What's wrong?

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From kevin at sb.org  Fri Dec 19 15:21:37 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:54:08 2004
Subject: [mod_python] Newbie questions 2
In-Reply-To: <8314517404.20031219123104@anonym.hu>
References: <8314517404.20031219123104@anonym.hu>
Message-ID: <F2AAD67B-3260-11D8-B7F9-000A95A072FC@sb.org>

On Dec 19, 2003, at 6:31 AM, fowlertrainer@anonym.hu wrote:

>       a.) So I want to remove the .py from main.py file in the
>           browser, if possible.

Define main.py as the handler for main.

>       b.) I want to eliminate or redirect the main.pyc file, what is
>           created by python in everytime.
>           This file is downloadable from browser, and if any users
>           have some python experience, or an decompiler, that these
>           persons can get informations from my site !

Put this in your httpd.conf

<Files ~ "\.pyc$">
     Order allow,deny
     Deny from all
</Files>

That blocks access to files ending in .pyc

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From nelson at crynwr.com  Fri Dec 19 15:51:16 2003
From: nelson at crynwr.com (Russell Nelson)
Date: Fri Jan  9 21:54:08 2004
Subject: [mod_python] newbie
In-Reply-To: <EF2F6572-3260-11D8-B7F9-000A95A072FC@sb.org>
References: <3FE32CA1.7070105@telefonica.net>
	<EF2F6572-3260-11D8-B7F9-000A95A072FC@sb.org>
Message-ID: <16355.25796.858212.742243@desk.crynwr.com>

Kevin Ballard writes:
 > What's your mptest.py look like?
 > 
 > Most likely, it's something like
 > 
 > from apache import *

Just as a matter of style, I think Guido (BDFL) discourages this sort
of thing.  For myself, even though it means more typing in the first
place, I prefer to see a plain import, and lots of foo., bar., and
baz. prefixes.  Lets the newbie (which I've been so very recently)
know which module the function is associated with.

-- 
--My blog is at angry-economist.russnelson.com  | 
Crynwr sells support for free software  | PGPok |  You can't spell Fiasco
521 Pleasant Valley Rd. | +1 315 268 1925 voice |  without SCO
Potsdam, NY 13676-3213  | +1 315 268 9201 FAX   | 
From dpopowich at mtrsd.k12.ma.us  Fri Dec 19 16:31:45 2003
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Fri Jan  9 21:54:08 2004
Subject: [mod_python] Sessions and problems with cookie path attribute
Message-ID: <16355.28225.866414.517954@gargle.gargle.HOWL>


I had a serious problem getting sessions to work with an app I'm
writing (modpython 3.1.2b, httpd-2.0.40, python 2.3.2) and after
browsing the archives I've seen others getting bitten by the same
problem...

Session ids are stored on the client as a cookie with name pysid.
This is fine and the cookie gets stored, but the path attribute can
get badly mangled by the code in Session.BaseSession.make_cookie(), in
particular, this section:

        if config.has_key("ApplicationPath"):
            c.path = config["ApplicationPath"]
        else:
            docroot = self._req.document_root()
            # the path where *Handler directive was specified
            dirpath = self._req.hlist.directory 
            c.path = dirpath[len(docroot):]

If you don't have AppliationPath set as a PythonOption and your
handler isn't in a <Directory> under DocumentRoot you're probably
going to have trouble.  Two scenarios hurt me:

  1.  using a handler inside a <Location>.  There is no path.  My
      browser (galeon 1.2.7) hung for infinity on reloads.  Never
      could figure out why.

  2.  using mod_python under UserDir directories.  I do this for
      prototyping because it's so easy to tweak a .htaccess file under
      a ~username/public_html subdirectory and you don't have to
      restart/reload apache to see your changes.  In this situation
      the length of DocumentRoot has no relationship to the URIs so
      the path attribute of the cookie gets oddly chopped at the
      head.  I kept getting new sessions because the browser wasn't
      sending the cookie because of paths not matching the uri.

I believe the same problem will occur under certain circumstances if
Alias directives affect mod_python usage although I haven't tested
this.

I think the ELSE clause above is trying to do something that can't be
done easily: extract the leading uri of the handler.  With Alias,
UserDir and Location directives, it's pretty difficult.  Is it
possible?  Perhaps the code shouldn't try to be so clever.  Default
the path to "/" unless the Session constructor overrides the value??

My temporary fix is to always explicitly use ApplicationPath.  Setting
it to "/" is certainly general enough for my prototyping.

Minimally, I think the documentation for Session should devote some
space to addressing and clarifying this issue.

------------------
Daniel Popowich
Network Specialist
-------------------------------------
Mohawk Trail Regional School District
24 Ashfield Rd.
Shelburne Falls, MA 01370
413.625.0192 x22
-------------------------------------

From kevin at sb.org  Fri Dec 19 19:31:59 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:54:08 2004
Subject: [mod_python] newbie
In-Reply-To: <16355.25796.858212.742243@desk.crynwr.com>
References: <3FE32CA1.7070105@telefonica.net>
	<EF2F6572-3260-11D8-B7F9-000A95A072FC@sb.org>
	<16355.25796.858212.742243@desk.crynwr.com>
Message-ID: <EC83DA6A-3283-11D8-B7F9-000A95A072FC@sb.org>

For the record, I meant to say

from mod_python import apache

because what I wrote wouldn't actually run.

And although I tend to agree with you in general, I still prefer 
importing apache from mod_python rather than just importing mod_python.

On Dec 19, 2003, at 3:51 PM, Russell Nelson wrote:

> Kevin Ballard writes:
>> What's your mptest.py look like?
>>
>> Most likely, it's something like
>>
>> from apache import *
>
> Just as a matter of style, I think Guido (BDFL) discourages this sort
> of thing.  For myself, even though it means more typing in the first
> place, I prefer to see a plain import, and lots of foo., bar., and
> baz. prefixes.  Lets the newbie (which I've been so very recently)
> know which module the function is associated with.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From grisha at modpython.org  Fri Dec 19 23:13:26 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:54:08 2004
Subject: [mod_python] newbie
In-Reply-To: <EC83DA6A-3283-11D8-B7F9-000A95A072FC@sb.org>
References: <3FE32CA1.7070105@telefonica.net>
	<EF2F6572-3260-11D8-B7F9-000A95A072FC@sb.org>
	<EC83DA6A-3283-11D8-B7F9-000A95A072FC@sb.org>
Message-ID: <20031219230940.K35608@onyx.ispol.com>


I think Russel was referring not to the "from" but to the "*" - I agree,
Python would probably be better if this "feature" did not exist at all,
because you don't know what the "*" has just imported.

Using "from" is just fine though :-)

On Fri, 19 Dec 2003, Kevin Ballard wrote:

> For the record, I meant to say
>
> from mod_python import apache
>
> because what I wrote wouldn't actually run.
>
> And although I tend to agree with you in general, I still prefer
> importing apache from mod_python rather than just importing mod_python.
>
> On Dec 19, 2003, at 3:51 PM, Russell Nelson wrote:
>
> > Kevin Ballard writes:
> >> What's your mptest.py look like?
> >>
> >> Most likely, it's something like
> >>
> >> from apache import *
> >
> > Just as a matter of style, I think Guido (BDFL) discourages this sort
> > of thing.  For myself, even though it means more typing in the first
> > place, I prefer to see a plain import, and lots of foo., bar., and
> > baz. prefixes.  Lets the newbie (which I've been so very recently)
> > know which module the function is associated with.
>
> --
> Kevin Ballard
> kevin@sb.org
> http://www.tildesoft.com
> http://kevin.sb.org
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From fccoelho at fiocruz.br  Mon Dec 22 10:28:16 2003
From: fccoelho at fiocruz.br (Flavio C. Coelho)
Date: Fri Jan  9 21:54:08 2004
Subject: [mod_python] mod_python and the semaphore bug
In-Reply-To: <8794402.1071700631675.JavaMail.jciccale@mac.com>
References: <8794402.1071700631675.JavaMail.jciccale@mac.com>
Message-ID: <1072096096.2609.6.camel@pinguim.procc.fiocruz.br>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: fiocruz4.jpg
Type: image/jpeg
Size: 3085 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20031222/4d0595d6/fiocruz4-0001.jpg
From jciccale at mac.com  Mon Dec 22 14:42:56 2003
From: jciccale at mac.com (Julian Ciccale)
Date: Fri Jan  9 21:54:08 2004
Subject: [mod_python] mod_python and the semaphore bug
Message-ID: <8134803.1072100576603.JavaMail.jciccale@mac.com>

The message on error_log is fine, apache uses it also to output "NOTICE" messages.
What is that doesn't work now? 

 
On Monday, December 22, 2003, at 01:28PM, Flavio C. Coelho <fccoelho@fiocruz.br> wrote:

>
><<Original Attached>>
From dpopowich at mtrsd.k12.ma.us  Mon Dec 22 11:02:45 2003
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Fri Jan  9 21:54:08 2004
Subject: [mod_python] Sessions and problems with cookie path attribute
In-Reply-To: <16355.28225.866414.517954@gargle.gargle.HOWL>
References: <16355.28225.866414.517954@gargle.gargle.HOWL>
Message-ID: <16359.5542.430.748017@gargle.gargle.HOWL>


> I had a serious problem getting sessions to work with an app I'm
> writing (modpython 3.1.2b, httpd-2.0.40, python 2.3.2) and after
> browsing the archives I've seen others getting bitten by the same
> problem...
> 
> Session ids are stored on the client as a cookie with name pysid.
> This is fine and the cookie gets stored, but the path attribute can
> get badly mangled by the code in Session.BaseSession.make_cookie(), in
> particular, this section:
> 
>         if config.has_key("ApplicationPath"):
>             c.path = config["ApplicationPath"]
>         else:
>             docroot = self._req.document_root()
>             # the path where *Handler directive was specified
>             dirpath = self._req.hlist.directory 
>             c.path = dirpath[len(docroot):]
> 
> If you don't have AppliationPath set as a PythonOption and your
> handler isn't in a <Directory> under DocumentRoot you're probably
> going to have trouble.  Two scenarios hurt me:
> 
>   1.  using a handler inside a <Location>.  There is no path.  My
>       browser (galeon 1.2.7) hung for infinity on reloads.  Never
>       could figure out why.
> 
>   2.  using mod_python under UserDir directories.  I do this for
>       prototyping because it's so easy to tweak a .htaccess file under
>       a ~username/public_html subdirectory and you don't have to
>       restart/reload apache to see your changes.  In this situation
>       the length of DocumentRoot has no relationship to the URIs so
>       the path attribute of the cookie gets oddly chopped at the
>       head.  I kept getting new sessions because the browser wasn't
>       sending the cookie because of paths not matching the uri.
> 
> I believe the same problem will occur under certain circumstances if
> Alias directives affect mod_python usage although I haven't tested
> this.
> 
> I think the ELSE clause above is trying to do something that can't be
> done easily: extract the leading uri of the handler.  With Alias,
> UserDir and Location directives, it's pretty difficult.  Is it
> possible?  Perhaps the code shouldn't try to be so clever.  Default
> the path to "/" unless the Session constructor overrides the value??
> 
> My temporary fix is to always explicitly use ApplicationPath.  Setting
> it to "/" is certainly general enough for my prototyping.
> 
> Minimally, I think the documentation for Session should devote some
> space to addressing and clarifying this issue.

I need to correct myself.  The problem does not occur inside
<Location> directives (the hanging problem I referred to was a bug in
my application: my session instance was not being garbage collected).
In fact, when using Sessions inside <Location> URIs no path attribute
is specified in the Cookie, so it is ALWAYS sent back to the server.

However, I have confirmed that this problem exists for uses of Session
within handlers referenced via Alias directives.

In summary, if you use Sessions in handlers referenced via UserDir or
Alias directives you have to use "PythonOption ApplicationPath ..." in
your config.

------------------
Daniel Popowich
Network Specialist
-------------------------------------
Mohawk Trail Regional School District
24 Ashfield Rd.
Shelburne Falls, MA 01370
413.625.0192 x22
-------------------------------------

From theman at eradman.com  Mon Dec 22 11:16:46 2003
From: theman at eradman.com (Eric Radman)
Date: Fri Jan  9 21:54:08 2004
Subject: [mod_python] mod_* performance
Message-ID: <1072091806.2521.68.camel@inspiration.x.eradman.com>

Guys,

I had been blaming bad performance with concurrent connections on
mod_python, when in fact an Apache config change can make all the
difference. The key is to limit the number of Apache processes based on
the RAM and average concurrency load that you have.

I found the mod_perl suffers from the same performance characteristics
becuase it's Apache behavior that impacts the performance on
simultinious connections, not mod_python or mod_perl.

I changed the MaxClients parameter in apache2.conf from 50 to 8:

<IfModule prefork.c>
StartServers         1
MinSpareServers      1
MaxSpareServers     10
MaxClients           8
MaxRequestsPerChild  0
</IfModule>

7k mod_python page with SQL caching:

Reqests  Concurrency   Req/Sec  Connect Time
400      1             136.54   7.324
400      5             131.29   38.085
400      15            126.28   118.780
400      50            96.73    516.883 
400      100           71.92    1390.431

To quote Stas Bekman <stas at stason.org>
"""
MinSpareServers, MaxSpareServers and StartServers are only important for
user response times. Sometimes users will have to wait a bit.

The important parameters are MaxClients and MaxRequestsPerChild.
MaxClients should be not too big, so it will not abuse your machine's
memory resources, and not too small, for if it is your users will be
forced to wait for the children to become free to serve them.
MaxRequestsPerChild should be as large as possible, to get the full
benefit of mod_perl, but watch your server at the beginning to make sure
your scripts are not leaking memory, thereby causing your server (and
your service) to die very fast.
"""

7k PHP page with standard connection pooling:

Reqests  Concurrency   Req/Sec  Connect Time
400      1             29.60    33.785
400      5             15.32    65.291
400      15            23.13    43.242
400      50            21.45    2656.869
400      100           23.21    4308.698

What we see here is that connect time (which translates into perceived
latency) really suffers in PHP when you hit it with a large number of
concurrent connections.

This one little tweak makes mod_perl and mod_python immune to http DOS
attacks. With the poper coding an increase of 300%-350% is possible over
PHP.

Eric Radman
From theman at eradman.com  Mon Dec 22 11:22:10 2003
From: theman at eradman.com (Eric Radman)
Date: Fri Jan  9 21:54:08 2004
Subject: [mod_python] 
Message-ID: <1072092130.4080.2.camel@inspiration.x.eradman.com>



From michael at dynamine.net  Mon Dec 22 08:34:26 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 21:54:08 2004
Subject: [mod_python] mod_* performance
In-Reply-To: <1072091806.2521.68.camel@inspiration.x.eradman.com>
References: <1072091806.2521.68.camel@inspiration.x.eradman.com>
Message-ID: <3FE71D12.6030802@dynamine.net>

Eric Radman wrote:

> This one little tweak makes mod_perl and mod_python immune to http DOS
> attacks. With the poper coding an increase of 300%-350% is possible over
> PHP.

I think that in order to reach a believable conclusion one really needs 
to run such benchmarks with the Zend Accelerator for PHP; it yields a 
performance improvement of nearly an order of magnitude.

Best,

--Michael
From neel at mediapulse.com  Mon Dec 22 11:44:42 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:54:08 2004
Subject: [mod_python] Changing the status code with custom content
Message-ID: <C0FC22C08B82074A88B500617641577787A7F0@johnson.mediapulse.net>

I'm having trouble using mod_python to change the status code and have
custom content in the error message.  If I return something other than
apache.OK in my handler, the status line is set correctly set but apache
returns the default error page.  If I have sent custom content for the
error message, the apache error message is added to the end of the
document.  I can get around this by using an ErrorDocument directive in
apache's conf, but I loose access to the traceback of the error and thus
the ability to have a really custom error message.

At first glance this didn't seem to matter.  As long as the content said
error, the user knew of the problem, even if the status was 200 OK.
However I've found out now with search bots this does matter - they
don't know that they have a bad url for the site and are indexing error
pages thinking they are legit.

Any thoughts on what I may be over looking?

Thanks,
Mike

From dpopowich at mtrsd.k12.ma.us  Mon Dec 22 11:44:30 2003
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Fri Jan  9 21:54:08 2004
Subject: [mod_python] redirects and url rewriting
Message-ID: <16359.8046.124675.498918@gargle.gargle.HOWL>


When I use req.internal_redirect(some_uri) sometimes the url in my
browser gets rewritten to reflect some_uri and some times it doesn't,
remaining as the uri of the originally selected page.  This can cause
numerous problems with relative links inside a page if the url is not
rewritten in the browser.

I'm trying to understand what causes this and how I can control it.
Can someone point me to some doc?

Below is a short handler I wrote as an example (the links I use assume
you have the apache manual installed; modify if necessary).

[modpython 3.1.2b, python 2.3.2, apache 2.0.40]

Thanks,

------------------
Daniel Popowich
Network Specialist
-------------------------------------
Mohawk Trail Regional School District
24 Ashfield Rd.
Shelburne Falls, MA 01370
413.625.0192 x22
-------------------------------------

# -*- python -*-

from mod_python import apache, util

def handler(req):

    req.content_type = 'text/html'

    form = util.FieldStorage(req)
    choice = form.getfirst('redirect')
    # this doesn't rewrite the url in the browser
    if choice == '1':
        req.internal_redirect('%s/abcdefg' % req.uri)
        
    # neither does this one [and the resulting page is quite
    # messed up because the relative urls inside the doc don't
    # make sense without the rewrite]
    elif choice == '2':
        req.internal_redirect('/manual/index.html')

    # but this one does
    elif choice == '3':
        req.internal_redirect('/manual')

    else:
        req.write('''
        <html>
        <body>
        <a href=%s?redirect=1>redirect to %s/abcdefg</a><br>
        <a href=%s?redirect=2>redirect to /manual/index.html</a><br>
        <a href=%s?redirect=3>redirect to /manual</a><br>
        </body>
        </html>
        ''' % ((req.uri,)*4))


    return apache.OK

From jciccale at mac.com  Mon Dec 22 18:10:54 2003
From: jciccale at mac.com (Julian Ciccale)
Date: Fri Jan  9 21:54:08 2004
Subject: [mod_python] redirects and url rewriting
Message-ID: <1006403.1072113054814.JavaMail.jciccale@mac.com>

I think the best option for your problem is:

req.headers_out[ "Location" ] = uri
return apache.HTTP_MOVED_PERMANENTLY #301 

- julcicc - 
 
On Monday, December 22, 2003, at 05:44PM, Daniel J. Popowich <dpopowich@mtrsd.k12.ma.us> wrote:

>
>When I use req.internal_redirect(some_uri) sometimes the url in my
>browser gets rewritten to reflect some_uri and some times it doesn't,
>remaining as the uri of the originally selected page.  This can cause
>numerous problems with relative links inside a page if the url is not
>rewritten in the browser.
>
>I'm trying to understand what causes this and how I can control it.
>Can someone point me to some doc?
>
>Below is a short handler I wrote as an example (the links I use assume
>you have the apache manual installed; modify if necessary).
>
>[modpython 3.1.2b, python 2.3.2, apache 2.0.40]
>
>Thanks,
>
>------------------
>Daniel Popowich
>Network Specialist
>-------------------------------------
>Mohawk Trail Regional School District
>24 Ashfield Rd.
>Shelburne Falls, MA 01370
>413.625.0192 x22
>-------------------------------------
>
># -*- python -*-
>
>from mod_python import apache, util
>
>def handler(req):
>
>    req.content_type = 'text/html'
>
>    form = util.FieldStorage(req)
>    choice = form.getfirst('redirect')
>    # this doesn't rewrite the url in the browser
>    if choice == '1':
>        req.internal_redirect('%s/abcdefg' % req.uri)
>        
>    # neither does this one [and the resulting page is quite
>    # messed up because the relative urls inside the doc don't
>    # make sense without the rewrite]
>    elif choice == '2':
>        req.internal_redirect('/manual/index.html')
>
>    # but this one does
>    elif choice == '3':
>        req.internal_redirect('/manual')
>
>    else:
>        req.write('''
>        <html>
>        <body>
>        <a href=%s?redirect=1>redirect to %s/abcdefg</a><br>
>        <a href=%s?redirect=2>redirect to /manual/index.html</a><br>
>        <a href=%s?redirect=3>redirect to /manual</a><br>
>        </body>
>        </html>
>        ''' % ((req.uri,)*4))
>
>
>    return apache.OK
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
From dpopowich at mtrsd.k12.ma.us  Mon Dec 22 12:34:09 2003
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Fri Jan  9 21:54:08 2004
Subject: [mod_python] redirects and url rewriting
In-Reply-To: <1006403.1072113054814.JavaMail.jciccale@mac.com>
References: <1006403.1072113054814.JavaMail.jciccale@mac.com>
Message-ID: <16359.11025.459664.120166@gargle.gargle.HOWL>



> I think the best option for your problem is:
> 
> req.headers_out[ "Location" ] = uri
> return apache.HTTP_MOVED_PERMANENTLY #301 
> 

This won't work for some of what I'm doing, i.e., user goes to a page
that needs authentication so they are redirected to a login page
(without having to save state to a session).  There are other similar
situations where, programmatically, you discover that the user should
be somewhere else within your mod_python app and you'd like to
redirect them to other URIs which can check req.prev for existing
state (thus saving network traffic, server hits, etc.  Heck, you got
everything you need to know, why tell the client, "go here" when you
can just deliver it in the first place?).

Also, being the kind of geek that needs to know how and why things
work, I'd like to know why some redirects rewrite my browser url and
some don't; ultimately, I'd like to be able to control the behaviour
with mod_python.

Dan

> >
> >When I use req.internal_redirect(some_uri) sometimes the url in my
> >browser gets rewritten to reflect some_uri and some times it doesn't,
> >remaining as the uri of the originally selected page.  This can cause
> >numerous problems with relative links inside a page if the url is not
> >rewritten in the browser.
> >
> >I'm trying to understand what causes this and how I can control it.
> >Can someone point me to some doc?
> >
> >Below is a short handler I wrote as an example (the links I use assume
> >you have the apache manual installed; modify if necessary).
> >
> >[modpython 3.1.2b, python 2.3.2, apache 2.0.40]
> >
> >Thanks,
> >
> >------------------
> >Daniel Popowich
> >Network Specialist
> >-------------------------------------
> >Mohawk Trail Regional School District
> >24 Ashfield Rd.
> >Shelburne Falls, MA 01370
> >413.625.0192 x22
> >-------------------------------------
> >
> ># -*- python -*-
> >
> >from mod_python import apache, util
> >
> >def handler(req):
> >
> >    req.content_type = 'text/html'
> >
> >    form = util.FieldStorage(req)
> >    choice = form.getfirst('redirect')
> >    # this doesn't rewrite the url in the browser
> >    if choice == '1':
> >        req.internal_redirect('%s/abcdefg' % req.uri)
> >        
> >    # neither does this one [and the resulting page is quite
> >    # messed up because the relative urls inside the doc don't
> >    # make sense without the rewrite]
> >    elif choice == '2':
> >        req.internal_redirect('/manual/index.html')
> >
> >    # but this one does
> >    elif choice == '3':
> >        req.internal_redirect('/manual')
> >
> >    else:
> >        req.write('''
> >        <html>
> >        <body>
> >        <a href=%s?redirect=1>redirect to %s/abcdefg</a><br>
> >        <a href=%s?redirect=2>redirect to /manual/index.html</a><br>
> >        <a href=%s?redirect=3>redirect to /manual</a><br>
> >        </body>
> >        </html>
> >        ''' % ((req.uri,)*4))
> >
> >
> >    return apache.OK
> >
> >_______________________________________________
> >Mod_python mailing list
> >Mod_python@modpython.org
> >http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> >

From michael at dynamine.net  Mon Dec 22 11:34:16 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 21:54:08 2004
Subject: [mod_python] redirects and url rewriting
In-Reply-To: <16359.11025.459664.120166@gargle.gargle.HOWL>
References: <1006403.1072113054814.JavaMail.jciccale@mac.com>
	<16359.11025.459664.120166@gargle.gargle.HOWL>
Message-ID: <3FE74738.4090706@dynamine.net>

Daniel J. Popowich wrote:

> 
>>I think the best option for your problem is:
>>
>>req.headers_out[ "Location" ] = uri
>>return apache.HTTP_MOVED_PERMANENTLY #301 
>>
> 
> 
> This won't work for some of what I'm doing, i.e., user goes to a page
> that needs authentication so they are redirected to a login page
> (without having to save state to a session).  There are other similar
> situations where, programmatically, you discover that the user should
> be somewhere else within your mod_python app and you'd like to
> redirect them to other URIs which can check req.prev for existing
> state (thus saving network traffic, server hits, etc.  Heck, you got
> everything you need to know, why tell the client, "go here" when you
> can just deliver it in the first place?).
> 
> Also, being the kind of geek that needs to know how and why things
> work, I'd like to know why some redirects rewrite my browser url and
> some don't; ultimately, I'd like to be able to control the behaviour
> with mod_python.

I don't know why mod_python is behaving in the manner you describe, but 
I can tell you that a clear understanding of the HTTP protocol is needed 
here.

Browsers determine what to display in the address bar based on two 
things only: (1) the URL requested by a user (bookmark, address bar or 
some other UI mechanism), or (2) an HTTP Redirect: header returned by 
the server.

Without either of those, there is no way for the browser to know that 
the page requested at /foo/bar can be found in the future at /baz/quux.

--Michael
From kevin at sb.org  Mon Dec 22 14:47:08 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:54:08 2004
Subject: [mod_python] redirects and url rewriting
In-Reply-To: <16359.11025.459664.120166@gargle.gargle.HOWL>
References: <1006403.1072113054814.JavaMail.jciccale@mac.com>
	<16359.11025.459664.120166@gargle.gargle.HOWL>
Message-ID: <A0BDA434-34B7-11D8-B640-000A95A072FC@sb.org>

I meant to send this to the list, but I accidentally sent it to Daniel 
Popowich instead.

-----

Well, I just did a curl on http://localhost/manual and these were the 
headers I got:

HTTP/1.1 301 Moved Permanently
Date: Mon, 22 Dec 2003 17:53:24 GMT
Server: Apache/2.0.48 (Unix) DAV/2 mod_python/3.0.4 Python/2.3
Location: http://localhost/manual/
Content-Length: 341
Content-Type: text/html; charset=iso-8859-1

Does that explain it well enough for you?

On Dec 22, 2003, at 12:34 PM, Daniel J. Popowich wrote:

> Also, being the kind of geek that needs to know how and why things
> work, I'd like to know why some redirects rewrite my browser url and
> some don't; ultimately, I'd like to be able to control the behaviour
> with mod_python.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From michael at dynamine.net  Mon Dec 22 11:50:27 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 21:54:09 2004
Subject: [mod_python] redirects and url rewriting
In-Reply-To: <3FE74738.4090706@dynamine.net>
References: <1006403.1072113054814.JavaMail.jciccale@mac.com>
	<16359.11025.459664.120166@gargle.gargle.HOWL> <3FE74738.4090706@dynamine.net>
Message-ID: <3FE74B03.70506@dynamine.net>

I wrote:

> Browsers determine what to display in the address bar based on two 
> things only: (1) the URL requested by a user (bookmark, address bar or 
> some other UI mechanism), or (2) an HTTP Redirect: header returned by 
> the server.

That should be an HTTP Location: header combined with a 301/302 HTTP 
response code.

--Michael
From dpopowich at mtrsd.k12.ma.us  Mon Dec 22 15:36:01 2003
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Fri Jan  9 21:54:09 2004
Subject: [mod_python] redirects and url rewriting
In-Reply-To: <3FE74B03.70506@dynamine.net>
References: <1006403.1072113054814.JavaMail.jciccale@mac.com>
	<16359.11025.459664.120166@gargle.gargle.HOWL>
	<3FE74738.4090706@dynamine.net>
	<3FE74B03.70506@dynamine.net>
Message-ID: <16359.21937.84003.871912@gargle.gargle.HOWL>


Michael S. Fischer writes:
> I wrote:
> 
> > Browsers determine what to display in the address bar based on two 
> > things only: (1) the URL requested by a user (bookmark, address bar or 
> > some other UI mechanism), or (2) an HTTP Redirect: header returned by 
> > the server.
> 

Yes, of course.  Duh.  I now think I understand what's going on:

  1. A call to req.internal_redirect(uri) will return the content of
     the uri as the address the user asked for UNLESS the HTTP
     Location header is sent.  This is what I had been originally
     expecting until the redirect to certain urls (like
     http://localhost/manual) changed in my browser's address bar.
     Confusion insued until Kevin Ballard replied with clues that...

  2. ...apache, when receiving requests that are directories (or
     aliases/symlinks to directories) without the trailing slash,
     actually sends a 301 response.  So, a request like
     http://host/foo will generate a 301 response if foo is a
     directory and send a "Location: http://host/foo/" header.  I was
     first shocked by this (think of all the extra bytes flooding the
     'net because of this!!), but understand it's the only way within
     the protocol to make relative links work.  (Although it begs the
     question why the protocol doesn't have a Real-Location header, or
     some such, to let the browser know what the real url for the
     requested page should be without having to go fetch it.)

Sound right?

Knowing now what I can expect consistantly (and knowing it's not for
lack of understanding mod_python subtleties) and can continue with my
app design.  Thanks for all your help!

Dan


From neel at mediapulse.com  Mon Dec 22 16:37:52 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:54:09 2004
Subject: [mod_python] redirects and url rewriting
Message-ID: <C0FC22C08B82074A88B500617641577787A7F1@johnson.mediapulse.net>

>      directory and send a "Location: http://host/foo/" header.  I was
>      first shocked by this (think of all the extra bytes flooding the
>      'net because of this!!), but understand it's the only way within
>      the protocol to make relative links work.  (Although it begs the
>      question why the protocol doesn't have a Real-Location header, or
>      some such, to let the browser know what the real url for the
>      requested page should be without having to go fetch it.)

A 301 status is Moved Permanently, so that is your "Real-Location"
header.  In an ideal world browsers would update (or prompt to update)
bookmarks on such a status, but it looks like that's not going to
happen.

A 302 is Moved Temporarily, for when you wouldn't want a browser to
update it info, however given the way browsers ignore RFC's and W3C it
wouldn't surprise me to find out browser x didn't handle a 302
correctly.

I wonder how many browsers would know what to do with a 203,
Non-Authoritative Information - which is sorta like a DNS query that's
cached...

Mike

From jalil at securia.com  Mon Dec 22 15:27:02 2003
From: jalil at securia.com (Jalil Feghhi)
Date: Fri Jan  9 21:54:09 2004
Subject: [mod_python] FW: Any way to embed Python in HTML?
Message-ID: <004201c3c8e3$1acc16a0$6502a8c0@securia.com>

 
I am new to mod_python and haven't seen any examples where you can put
python code in HTML pages. Is this not supported? If not supported, is
there any way or work around (other than using the request write method)
to separate HTML writing from coding?
 
Thanks,
 
-Jalil
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20031222/0f54ce49/attachment-0001.htm
From jalil at securia.com  Mon Dec 22 15:49:53 2003
From: jalil at securia.com (Jalil Feghhi)
Date: Fri Jan  9 21:54:09 2004
Subject: [mod_python] Problem keeing the db connection open
Message-ID: <005201c3c8e6$4c073580$6502a8c0@securia.com>

I found the following code on the Internet for keeping the connection
open but it doesn't really work. Everytime I try to login, it connects
to the database. I put some log messges and I can see this happens.

1. Could someone tell me how I can keep the connection open? 

2.  I appreciate if someone explain how mod_python handler is called
when there are many requests? Does Apache create threads for each
request? And how the global database connection is used?

Thanks,

-Jalil

Here is the code:

HOST = "localhost"

DB = "mydb"

USER = "user"

PASS = "pwd"

import MySQLdb

import string

def _db_login(relogin = 0):


    global DB_CONN

    if relogin:

        DB_CONN = MySQLdb.connect(db=DB, user=USER, passwd=PASS)

        return DB_CONN

    else:

        try:

            d = DB_CONN

            return d

        except NameError:

            DB_CONN = MySQLdb.connect(host= HOST, db=DB, user=USER,
passwd=PASS)

            return DB_CONN

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20031222/bad48455/attachment-0001.htm
From grisha at modpython.org  Mon Dec 22 19:42:38 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:54:09 2004
Subject: [mod_python] Changing the status code with custom content
In-Reply-To: <C0FC22C08B82074A88B500617641577787A7F0@johnson.mediapulse.net>
References: <C0FC22C08B82074A88B500617641577787A7F0@johnson.mediapulse.net>
Message-ID: <20031222193816.N83390@onyx.ispol.com>


I believe you should req.write() your error page, set req.status to the
the error code you want and return apache.OK. If you retrun anything other
then apache.OK, then Apache assumes you want it to send its own stock
error page.

(Hope this answers your question, I'm a bit woozy on nuquil right now....)

Grisha

On Mon, 22 Dec 2003, Michael C. Neel wrote:

> I'm having trouble using mod_python to change the status code and have
> custom content in the error message.  If I return something other than
> apache.OK in my handler, the status line is set correctly set but apache
> returns the default error page.  If I have sent custom content for the
> error message, the apache error message is added to the end of the
> document.  I can get around this by using an ErrorDocument directive in
> apache's conf, but I loose access to the traceback of the error and thus
> the ability to have a really custom error message.
>
> At first glance this didn't seem to matter.  As long as the content said
> error, the user knew of the problem, even if the status was 200 OK.
> However I've found out now with search bots this does matter - they
> don't know that they have a bad url for the site and are indexing error
> pages thinking they are legit.
>
> Any thoughts on what I may be over looking?
>
> Thanks,
> Mike
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From dpopowich at mtrsd.k12.ma.us  Mon Dec 22 19:55:13 2003
From: dpopowich at mtrsd.k12.ma.us (Daniel Popowich)
Date: Fri Jan  9 21:54:09 2004
Subject: [mod_python] redirects and url rewriting
In-Reply-To: <C0FC22C08B82074A88B500617641577787A7F1@johnson.mediapulse.net>
References: <C0FC22C08B82074A88B500617641577787A7F1@johnson.mediapulse.net>
Message-ID: <33585.24.91.183.76.1072140913.squirrel@www.mtrsd.k12.ma.us>

>>      directory and send a "Location: http://host/foo/" header.  I was
>>      first shocked by this (think of all the extra bytes flooding the
>>      'net because of this!!), but understand it's the only way within
>>      the protocol to make relative links work.  (Although it begs the
>>      question why the protocol doesn't have a Real-Location header, or
>>      some such, to let the browser know what the real url for the
>>      requested page should be without having to go fetch it.)
>
> A 301 status is Moved Permanently, so that is your "Real-Location"
> header.  In an ideal world browsers would update (or prompt to update)
> bookmarks on such a status, but it looks like that's not going to
> happen.

I wasn't very clear.  For pages that have moved or for pages that haven't
moved but aren't in proper form (like my example, http://host/foo ->
http://host/foo/) on the SAME server, it seems unfortunate that the
servers can't return the page along with some header indicating that fact.

For example, why can't a request for http://host/foo return
http://host/foo/index.html with a header

  Real-Location: http://host/foo/

instead of returning a 30[12] with a Location header only to have the
browser go back to the same server.  Seems wasteful.

The 30[12] with Location header makes perfect sense for pages moved
to different servers.

Dan


From alunchampion at btconnect.com  Mon Dec 22 21:57:55 2003
From: alunchampion at btconnect.com (Alun)
Date: Fri Jan  9 21:54:09 2004
Subject: [mod_python] mod_python disables mod_dav
Message-ID: <200312230157.hBN1vW1B092956@slash.mediapulse.com>

I seem to have a problem adding mod_python to an existing configuration with
mod_dav.
I have mod_dav enabled and working and planned on integrating mod_python but
when I *only* add the LoadModule mod_python directive to the httpd.conf,
WebDAV no longer works and I get a 405 status returned.

Any help would be appreciated.

Checking OPTIONS on the URL before and after adding LoadModule gives:

=====Before====
OPTIONS /author/ http/1.1
Host: localhost:80

HTTP/1.1 200 OK
Date: Mon, 22 Dec 2003 21:47:46 GMT
Server: Apache/2.0.48 (Win32) mod_jk2/2.0.2 DAV/2
DAV: 1,2
MS-Author-Via: DAV
Allow:
OPTIONS,GET,HEAD,POST,DELETE,TRACE,PROPFIND,PROPPATCH,COPY,MOVE,LOCK,UNLOCK
Content-Length: 0
Content-Type: httpd/unix-directory

=====After LoadModule mod_python modules/mod_python.so=====
OPTIONS /author/ http:/1.1
Host: localhost:80

HTTP/1.1 200 OK
Date: Mon, 22 Dec 2003 21:28:47 GMT
Server: Apache/2.0.48 (Win32) mod_jk2/2.0.2 mod_python/3.1.2b Python/2.3.2
DAV/2

Allow: GET,HEAD,POST,OPTIONS,TRACE     <======== No DAV commands.
Content-Length: 0
Connection: close
Content-Type: httpd/unix-directory

From stian at soiland.no  Tue Dec 23 02:45:36 2003
From: stian at soiland.no (Stian =?iso-8859-1?Q?S=F8iland?=)
Date: Fri Jan  9 21:54:09 2004
Subject: [mod_python] Re: FW: Any way to embed Python in HTML?
In-Reply-To: <004201c3c8e3$1acc16a0$6502a8c0@securia.com>
References: <004201c3c8e3$1acc16a0$6502a8c0@securia.com>
Message-ID: <20031223014536.GB16301@itea.ntnu.no>

On 2003-12-23 00:27:02, Jalil Feghhi wrote:

> I am new to mod_python and haven't seen any examples where you can put
> python code in HTML pages. Is this not supported? If not supported, is
> there any way or work around (other than using the request write method)
> to separate HTML writing from coding?

Take a look at upcoming PSP from Mod-python 3.1.2b:

http://www.modpython.org/live/mod_python-3.1.2b/doc-html/pyapi-psp.html



I've also experienced some success with using template engines like
Cheetah combined with mod_python.

This is how we've done things using cheetah and mod_python's
Publisher-handler:


Made a general page template MainTemplate.tmpl:

    #attr title = "Default title"
    <html>
      <head>
        <title>$title</title>
      </head>
      <body>
        <h1>$title</h1>
        <div class="menu">
          menu blabla
          (details left out)
        </div>  
        <div class="content">
    #def content    
            No content here yet, this is just
            the base template
    #end def
    $content()
        </div>


Here's a specialized page template WelcomeTemplate.tmpl

    #extends MainTemplate
    #def content
            Welcome to our world. Blablabla
            blablabla.
    #end def     
 

These template-files are compiled with cheetah-compile - which produces
a rather nasty .py-file. This file could be imported and used from
Python.

In .htaccess:

    SetHandler mod_python
    PythonHandler mod_python.publisher


in welcome.py:

    from WelcomeTemplate import WelcomeTemplate 
    def index(req):
        templ = WelcomeTemplate()
        templ.title = "Welcome, my friend"
        return templ


Blocks made within templates (the #def's) are callable methods from
within Python, and therefore templates could be used for smaller building
blocks as well.  templ.content could be changed to any other template,
or even a python function defined somewhere else.


Model view controller
=====================

In our current ongoing project, Cerebrum, we've succeeded in seperating
content from control, and even seperating the model from control. This
is the old MVC (model-view-controller) principle as we've used it:

       model          controller                  view
  business logic      web logic             presentation logic
  (what to do)      (what to show)             (how to view)

 python classes     python classes           cheetah templates
 representing the   for web access, ie.      with calls to other
 data, methods      each method accessed     templates and
 for operations     from the browser.        helper classes in
                    Performs operations on   python
                    model and views by
                    calling cheetah 
                    templates. 
 

Example:
========
code is simplified, and never tested in simplified form. It will
probably not work directly. The real code can be viewed on 
http://cvs.sourceforge.net/viewcvs.py/cerebrum/cerebrum/ under the
directories Cerebrum/client and web/ - note however
that the code is constantly changing at this part of the web project.


Model - Cerebrum/client/BofhModel.py
------------------------------------


class Entity:
    def __init__(self, server):
        # xmlrpc-connection
        self.server = server

    def fetch_by_id(cls, server, id):
        # make a new instance of the called-on class,
        # ie. a Group or Entity
        entity = cls(server)
        entity.load_entity_info(id)
        return entity
    fetch_by_id = classmethod(fetch_by_id)

    def load_entity_info(self, id):
        self.id = id
        info = self.server.entity_info(id)
        self.type = info['type']
        return info

class Group(Entity):
    def load_entity_info(self, id):
        info = Entity.load_entity_info(self, id)
        self.name = info['name']
        self.description = info['description']
        return info
    

View - web/lib/cereweb/templates/GroupViewTemplate.tmpl
--------------------------------------------------------

## Be international, import function gettext() as _()
#from gettext import gettext as _
#def viewGroup(group)
    <h1>$_("Group") $group.name</h1>
    $groupInfo($group)
#end def

#def groupInfo(group)
    <div class="info">
    <dl>
        <dt>$_("Name")</dt>
        <dd>$group.name</dd>
        <dt>$_("Description")</dt>
        <dd>$group.description</dd>
    </dl>
    </div>
#end def

MainTemplate.tmpl almost like shown in previous text.


Controller - htdocs/group.py
----------------------------

from Cerebrum.web.templates.MainTemplate import MainTemplate
from Cerebrum.web.templates.GroupViewTemplate import GroupViewTemplate
from Cerebrum.client import BofhModel

def view(req, id):
    # Get a generic view (menu, header, footer)
    page = MainTemplate()
    # the session and the xmlrpc server connection has been prepared by
    # a handler in .htaccess
    server = req.session['server']
    # get the object from the model   
    group = BofhModel.Group.fetch_by_id(server, id)
    # prepare the specialiced view
    view = GroupViewTemplate()
    # pass the model to the view 
    page.content = view.viewGroup(group)
    # and return the final result (within the MainTemplate)
    # to the browser
    return page
    

Notice how the controller is rather small and only glues together the view
and the model. In this example, the model is just an xmlrpc abstraction,
so even the business logic is hidden.  In this case the controller
actually uses two views, both MainTemplate (the menu, footer, etc.) and
GroupViewTemplate.  The reason for not subclassing MainTemplate into
GroupViewTemplate is that we needed to pass on the chosen group object
(from the Model), and that a groupview could be usable from within other
views as well. 


-- 
Stian S?iland               Work toward win-win situation. Win-lose
Trondheim, Norway           is where you win and the other lose.
http://www.soiland.no/      Lose-lose and lose-win are left as an
                            exercise to the reader.  [Limoncelli/Hogan]

From gnb at itga.com.au  Tue Dec 23 13:07:07 2003
From: gnb at itga.com.au (Gregory Bond)
Date: Fri Jan  9 21:54:09 2004
Subject: [mod_python] FW: Any way to embed Python in HTML? 
In-Reply-To: Your message of Mon, 22 Dec 2003 15:27:02 -0800.
Message-ID: <200312230207.NAA06930@lightning.itga.com.au>

You could consider Albatross, which has a nice Model/Controller/View paradigm, 
and does HTML templating (and session handling and heaps of other stuff).

http://www.object-craft.com.au/projects/albatross/


From stephen at vermeulen.ca  Mon Dec 22 19:41:15 2003
From: stephen at vermeulen.ca (Stephen Vermeulen)
Date: Fri Jan  9 21:54:09 2004
Subject: [mod_python] FW: Any way to embed Python in HTML?
In-Reply-To: <004201c3c8e3$1acc16a0$6502a8c0@securia.com>
References: <004201c3c8e3$1acc16a0$6502a8c0@securia.com>
Message-ID: <3FE7AB4B.9020107@vermeulen.ca>

Jalil Feghhi wrote:

>  
> I am new to mod_python and haven't seen any examples where you can put 
> python code in HTML pages. Is this not supported?

While working with mod_python 3.03 I did something along these lines, 
which I consider to be a rather
evil hack (this was done on some "for internal use only" pages). I used 
python's pickle module to serialize up some
objects, then base64 encoded them into ASCII form, and then placed the 
resulting text into hidden form fields
on the page that was served up. This allowed me to pass some complex 
state information (that was expensive to
generate, and was also generated by a different program at an earlier 
time) relating to the page that the user
was editing into the mod_python code that did the editing.


> If not supported, is there any way or work around (other than using 
> the request write method) to separate HTML writing from coding?
>  
> Thanks,
>  
> -Jalil

Regards,

Stephen


From gdamjan at mail.net.mk  Tue Dec 23 03:47:22 2003
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 21:54:09 2004
Subject: [mod_python] mod_python disables mod_dav
In-Reply-To: <200312230157.hBN1vW1B092956@slash.mediapulse.com>
References: <200312230157.hBN1vW1B092956@slash.mediapulse.com>
Message-ID: <20031223024722.GA18811@legolas.on.net.mk>

> I seem to have a problem adding mod_python to an existing configuration with
> mod_dav.
> I have mod_dav enabled and working and planned on integrating mod_python but
> when I *only* add the LoadModule mod_python directive to the httpd.conf,
> WebDAV no longer works and I get a 405 status returned.
> 
> Any help would be appreciated.

Quick workaround, put the "LoadModule mod_python" directive above the 
"LoadModule mod_dav" directive - apache will execute the modules
bottom-to-top - that way mod_dav will be first to execute.





-- 
Damjan Georgievski
jabberID: damjan@bagra.net.mk
From grisha at modpython.org  Mon Dec 22 22:00:03 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:54:09 2004
Subject: [mod_python] mod_python disables mod_dav
In-Reply-To: <200312230157.hBN1vW1B092956@slash.mediapulse.com>
References: <200312230157.hBN1vW1B092956@slash.mediapulse.com>
Message-ID: <20031222215922.N85305@onyx.ispol.com>


I believe Damjan reported that if you swap the lines (put first whichever
was second) the problem goes away,

HTH,

Grisha

On Mon, 22 Dec 2003, Alun wrote:

> I seem to have a problem adding mod_python to an existing configuration with
> mod_dav.
> I have mod_dav enabled and working and planned on integrating mod_python but
> when I *only* add the LoadModule mod_python directive to the httpd.conf,
> WebDAV no longer works and I get a 405 status returned.
>
> Any help would be appreciated.
>
> Checking OPTIONS on the URL before and after adding LoadModule gives:
>
> =====Before====
> OPTIONS /author/ http/1.1
> Host: localhost:80
>
> HTTP/1.1 200 OK
> Date: Mon, 22 Dec 2003 21:47:46 GMT
> Server: Apache/2.0.48 (Win32) mod_jk2/2.0.2 DAV/2
> DAV: 1,2
> MS-Author-Via: DAV
> Allow:
> OPTIONS,GET,HEAD,POST,DELETE,TRACE,PROPFIND,PROPPATCH,COPY,MOVE,LOCK,UNLOCK
> Content-Length: 0
> Content-Type: httpd/unix-directory
>
> =====After LoadModule mod_python modules/mod_python.so=====
> OPTIONS /author/ http:/1.1
> Host: localhost:80
>
> HTTP/1.1 200 OK
> Date: Mon, 22 Dec 2003 21:28:47 GMT
> Server: Apache/2.0.48 (Win32) mod_jk2/2.0.2 mod_python/3.1.2b Python/2.3.2
> DAV/2
>
> Allow: GET,HEAD,POST,OPTIONS,TRACE     <======== No DAV commands.
> Content-Length: 0
> Connection: close
> Content-Type: httpd/unix-directory
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From mark at camazotz.com  Mon Dec 22 22:13:50 2003
From: mark at camazotz.com (Mark Smith)
Date: Fri Jan  9 21:54:09 2004
Subject: [mod_python] Re: FW: Any way to embed Python in HTML?
In-Reply-To: <200312230245.hBN2jU1C093084@slash.mediapulse.com>
References: <200312230245.hBN2jU1C093084@slash.mediapulse.com>
Message-ID: <07C1B262-34F6-11D8-9F73-00039364CE50@camazotz.com>

> I am new to mod_python and haven't seen any examples where you can put
> python code in HTML pages. Is this not supported? If not supported, is
> there any way or work around (other than using the request write 
> method)
> to separate HTML writing from coding?

PWO (http://www.jamwt.com/pwo/) is a simple JSP-style processor that 
allows you to embed Python code.  I think it has a less cluttered 
syntax than many of the alternatives.

If you want something more complex that supports MVC, have a look at 
Draco (http://draco.boskant.nl/).  It's nicely thought out and well 
documented (although the database component is rather low-level.)

From gnb at itga.com.au  Tue Dec 23 15:08:54 2003
From: gnb at itga.com.au (Gregory Bond)
Date: Fri Jan  9 21:54:09 2004
Subject: [mod_python] Re: FW: Any way to embed Python in HTML? 
In-Reply-To: Your message of Mon, 22 Dec 2003 22:13:50 -0500.
Message-ID: <200312230408.PAA13869@lightning.itga.com.au>


I've added an entry to the mod_python FAQ (3.10) to cover this and similar
questions. Please feel free to update or add to the info I've put there.


From neel at mediapulse.com  Tue Dec 23 09:46:25 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:54:09 2004
Subject: [mod_python] Changing the status code with custom content
Message-ID: <C0FC22C08B82074A88B50061764157776B9906@johnson.mediapulse.net>

Is req.status a 3.x only thing (reason I didn't see this is it's not
listed in the 2.x docs - and this server happens to be 2.x)?

Mike

> -----Original Message-----
> From: Gregory (Grisha) Trubetskoy [mailto:grisha@modpython.org] 
> Sent: Monday, December 22, 2003 7:43 PM
> To: Michael C. Neel
> Cc: mod_python@modpython.org
> Subject: Re: [mod_python] Changing the status code with custom content
> 
> 
> 
> I believe you should req.write() your error page, set 
> req.status to the
> the error code you want and return apache.OK. If you retrun 
> anything other
> then apache.OK, then Apache assumes you want it to send its own stock
> error page.
> 
> (Hope this answers your question, I'm a bit woozy on nuquil 
> right now....)
> 
> Grisha
> 
> On Mon, 22 Dec 2003, Michael C. Neel wrote:
> 
> > I'm having trouble using mod_python to change the status 
> code and have
> > custom content in the error message.  If I return something 
> other than
> > apache.OK in my handler, the status line is set correctly 
> set but apache
> > returns the default error page.  If I have sent custom 
> content for the
> > error message, the apache error message is added to the end of the
> > document.  I can get around this by using an ErrorDocument 
> directive in
> > apache's conf, but I loose access to the traceback of the 
> error and thus
> > the ability to have a really custom error message.
> >
> > At first glance this didn't seem to matter.  As long as the 
> content said
> > error, the user knew of the problem, even if the status was 200 OK.
> > However I've found out now with search bots this does matter - they
> > don't know that they have a bad url for the site and are 
> indexing error
> > pages thinking they are legit.
> >
> > Any thoughts on what I may be over looking?
> >
> > Thanks,
> > Mike
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> 

From dpopowich at mtrsd.k12.ma.us  Tue Dec 23 10:08:13 2003
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Fri Jan  9 21:54:09 2004
Subject: [mod_python] default Session timeout
Message-ID: <16360.23133.264930.249115@gargle.gargle.HOWL>


In mod_python.Session the default timeout is set like this:

  DFT_TIMEOUT=30*60*60 # 30 min

That's 30 hours, not minutes.  :-)

------------------
Daniel Popowich
Network Specialist
-------------------------------------
Mohawk Trail Regional School District
24 Ashfield Rd.
Shelburne Falls, MA 01370
413.625.0192 x22
-------------------------------------

From pkeshishian at yahoo.com  Tue Dec 23 12:16:17 2003
From: pkeshishian at yahoo.com (Petros Keshishian)
Date: Fri Jan  9 21:54:09 2004
Subject: [mod_python] displaying python output
Message-ID: <20031223201617.97907.qmail@web40015.mail.yahoo.com>

I am trying to setup mod_python for the first time and
everything seems to be working, except instead of
displaying the output from mod_python in clients
browser it is asking for the file name to save the
output. If you save the output it is exactly what it
was supposed to display. Here is the famous hello.py
that I am using to test the setup.

def say(req,what="Nothing"):
    return "I am saying %s" % what

It is in /usr/local/apache2/htdocs/py-bin/ directory.
The following is set in the http.conf file:

<Directory "/usr/local/apache2/htdocs/py-bin">
                                                      
                                                      
   
    SetHandler python-program
    PythonHandler mod_python.publisher
    PythonDebug On
                                                      
                                                      
   
</Directory>

I am trying to access hello/say using:

http://localhost/py-bin/hello/say

How do I change the output to be directed to the
browser instead of a file.

Thanks a lot for your help
Petros



__________________________________
Do you Yahoo!?
New Yahoo! Photos - easier uploading and sharing.
http://photos.yahoo.com/
From michael at dynamine.net  Tue Dec 23 12:26:52 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 21:54:09 2004
Subject: [mod_python] displaying python output
In-Reply-To: <20031223201617.97907.qmail@web40015.mail.yahoo.com>
References: <20031223201617.97907.qmail@web40015.mail.yahoo.com>
Message-ID: <3FE8A50C.2070202@dynamine.net>

What do the HTTP response headers say the Content-Type is?

--Michael

Petros Keshishian wrote:

> I am trying to setup mod_python for the first time and
> everything seems to be working, except instead of
> displaying the output from mod_python in clients
> browser it is asking for the file name to save the
> output. If you save the output it is exactly what it
> was supposed to display. Here is the famous hello.py
> that I am using to test the setup.
> 
> def say(req,what="Nothing"):
>     return "I am saying %s" % what
> 
> It is in /usr/local/apache2/htdocs/py-bin/ directory.
> The following is set in the http.conf file:
> 
> <Directory "/usr/local/apache2/htdocs/py-bin">
>                                                       
>                                                       
>    
>     SetHandler python-program
>     PythonHandler mod_python.publisher
>     PythonDebug On
>                                                       
>                                                       
>    
> </Directory>
> 
> I am trying to access hello/say using:
> 
> http://localhost/py-bin/hello/say
> 
> How do I change the output to be directed to the
> browser instead of a file.
> 
> Thanks a lot for your help
> Petros
> 
> 
> 
> __________________________________
> Do you Yahoo!?
> New Yahoo! Photos - easier uploading and sharing.
> http://photos.yahoo.com/
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 
From greenbeard400 at yahoo.com  Wed Dec 24 11:12:54 2003
From: greenbeard400 at yahoo.com (Greenbeard)
Date: Fri Jan  9 21:54:09 2004
Subject: [mod_python] Problem on OpenBSD with Publisher Handler 
Message-ID: <20031224191254.2564.qmail@web21326.mail.yahoo.com>

I am getting this error when trying to use the
publisher handler.

Mod_python error: "PythonHandler mod_python.publisher"

Traceback (most recent call last):

  File
"/usr/local/lib/python2.2/site-packages/mod_python/apache.py",
line 332, in HandlerDispatch
    result = object(req)

  File
"/usr/local/lib/python2.2/site-packages/mod_python/publisher.py",
line 142, in handler
    if req.extension:  # this exists if we're running
in a | .ext handler

AttributeError: 'mp_request' object has no attribute
'extension'

my httpd.conf is as described in the docs:

<Directory /home/myServer/apache2/htdocs>
  AddHandler python-program .py
  PythonHandler mod_python.publisher
  PythonDebug On
</Directory>

Simple test script:

from mod_python import apache

def test(req):
    x = "Testing 123"
    return x


Any ideas?  My error log does not have anything
different than the message above.
  
I am running Apache/2.0.44, mod_python/3.0.1,
Python/2.2.1 - right now I can not upgrade any of
these .  
 

Thanks!

gb400

__________________________________
Do you Yahoo!?
Free Pop-Up Blocker - Get it now
http://companion.yahoo.com/
From hnease at midsouth.rr.com  Sat Dec 27 15:51:29 2003
From: hnease at midsouth.rr.com (Howard Nease)
Date: Fri Jan  9 21:54:09 2004
Subject: [mod_python] 
	Win32 Binary Error: "*** run_installscript: internal error
	0xFFFFFFFF ***"
Message-ID: <000801c3ccc3$95d9e500$a000a8c0@stephen>

Hello, all. I recently tried to install mod_python on my Windows XP Home machine, and I got the above error. Here's the context:

Traceback (most recent call last):
  File "E:\Python23\Scripts\win32_postinstall.py", line 90, in ?
    shutil.copy2(mp, os.path.join(apachedir, "modules"))
  File "E:\Python23\Lib\shutil.py", line 82, in copy2
    copyfile(src, dst)
  File "E:\Python23\Lib\shutil.py", line 38, in copyfile
    fdst = open(dst, 'wb')
IOError: [Errno 13] Permission denied: 'E:/Program Files/Apache Group/Apache2\\modules\\mod_python.so'
*** run_installscript: internal error 0xFFFFFFFF ***

Does anyone have a clue as to what I'm doing wrong? I've Googled for a clue, but no dice. Thanks a lot!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20031227/d7569fac/attachment-0001.htm
From RussLear314 at yahoo.com  Sat Dec 27 19:44:55 2003
From: RussLear314 at yahoo.com (Russell Lear)
Date: Fri Jan  9 21:54:09 2004
Subject: [mod_python] Session unable to acquire mutex lock?
Message-ID: <200312271944.55425.RussLear314@yahoo.com>

Hi,

I'm a newbie to mod_python so forgive me if this is a terribly obvious
question (I've looked through the archives without much success).

I'm trying to use sessions.  Right now I have a slightly modified version
of mptest.py as follows (it doesn't make sense, but it does show my
problem):

    from mod_python import apache, Session
    import sys

    def handler(req):
        req.content_type = 'text/plain'
        req.write("Creating...\n")
        sess = Session.Session(req)
        req.write("Hello World!")
        return apache.OK

When I run it, I see:

     Mod_python error: "PythonHandler mptest"

     Traceback (most recent call last):

       File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 338, in HandlerDispatch
         result = object(req)

       File "/srv/www/htdocs/test/mptest.py", line 7, in handler
         sess = Session.Session(req)

       File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 411, in Session
         timeout=timeout)

       File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 316, in __init__
         secret=secret, timeout=timeout)

       File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 170, in __init__
         self.lock()                 # lock new sid

       File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 241, in lock
         _apache._global_lock(self._req.server, self._sid)

     ValueError: Failed to acquire global mutex lock


What am I doing wrong here?!

Thanks for any suggestions,
Russell.

PS:

I'm running on SuSE 9.0 Linux.

Python reports version "Python 2.3+ (#1, Sep 23 2003, 23:07:16)".

>From the Apache error page: 
    Apache/2.0.48 (Linux/SuSE), 
    mod_python/3.1.2b 
    Python/2.3+.

The only glitch I had in building mod_python was that I needed to specify 
    ./configure --with-apxs=/usr/sbin/apxs2

rather than just refering to apxs.

My apache configuration is (from the tutorial):
<Directory /srv/www/htdocs/test> 
  AddHandler python-program .py
  PythonHandler mptest 
  PythonDebug On 
</Directory>



From div at newcode.se  Sun Dec 28 18:52:53 2003
From: div at newcode.se (Carl-Johan Kihlbom)
Date: Fri Jan  9 21:54:09 2004
Subject: [mod_python] mod_python not working on Mac OS X 10.3
Message-ID: <A9026A4E-395E-11D8-982D-000A9599FB7E@newcode.se>

Hi list,

I've installed mod_python on my Mac, but can't get it working. When I  
restart Apache after configuring httpd.conf I get the following error:

Syntax error on line 276 of /Library/Apache2/conf/httpd.conf:
Cannot load /Library/Apache2/modules/mod_python.so into server: dyld:  
/Library/Apache2/bin/httpd Undefined symbols:
_PyExc_AttributeError
_PyExc_IOError
_PyExc_IndexError
_PyExc_KeyError
_PyExc_RuntimeError
_PyExc_StopIteration
_PyExc_TypeError
_PyExc_ValueError
_PyInt_Type
_PyList_Type
_PyObject_GenericGetAttr
_PyObject_GenericSetAttr
_PyString_Type
_PyType_Type
_Py_OptimizeFlag
__Py_NoneStruct
__Py_NotImplementedStruct

I'm using mod_python 3.1.2b on my laptop running Apache 2.0.48 and Mac  
OS X 10.3.2.

In Mac OS X 10.3, Python 2.3 is installed by default, and the library  
and include files are in  
/System/Library/Frameworks/Python.framework/Versions/2.3/lib/python2.3/  
and  
/System/Library/Frameworks/Python.framework/Versions/2.3/include/ 
python2.3/ respectively. I created symlinks to these at /usr/lib/python  
and /usr/include/python.

Any ideas what I did wrong?

TIA,

Carl-Johan Kihlbom

From grisha at modpython.org  Sun Dec 28 13:28:12 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:54:09 2004
Subject: [mod_python] Session unable to acquire mutex lock?
In-Reply-To: <200312271944.55425.RussLear314@yahoo.com>
References: <200312271944.55425.RussLear314@yahoo.com>
Message-ID: <20031228132058.S70904@onyx.ispol.com>


If you restart the server, and try this code, does the error happen on the
first hit, or only starting with the second and after waiting for a while?

If if it's the former, then there probably is some problem with locking in
general (are there any warning messages on server startup?). If it's
latter, then the session does not get unlocked properly. It should get
unlocked when the sess object goes out of scope (and looking at your code
it should), but perhpas try unlocking it manually (sess.unlock()) and see
if this fixes the problem.

Grisha

On Sat, 27 Dec 2003, Russell Lear wrote:

> Hi,
>
> I'm a newbie to mod_python so forgive me if this is a terribly obvious
> question (I've looked through the archives without much success).
>
> I'm trying to use sessions.  Right now I have a slightly modified version
> of mptest.py as follows (it doesn't make sense, but it does show my
> problem):
>
>     from mod_python import apache, Session
>     import sys
>
>     def handler(req):
>         req.content_type = 'text/plain'
>         req.write("Creating...\n")
>         sess = Session.Session(req)
>         req.write("Hello World!")
>         return apache.OK
>
> When I run it, I see:
>
>      Mod_python error: "PythonHandler mptest"
>
>      Traceback (most recent call last):
>
>        File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 338, in HandlerDispatch
>          result = object(req)
>
>        File "/srv/www/htdocs/test/mptest.py", line 7, in handler
>          sess = Session.Session(req)
>
>        File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 411, in Session
>          timeout=timeout)
>
>        File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 316, in __init__
>          secret=secret, timeout=timeout)
>
>        File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 170, in __init__
>          self.lock()                 # lock new sid
>
>        File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 241, in lock
>          _apache._global_lock(self._req.server, self._sid)
>
>      ValueError: Failed to acquire global mutex lock
>
>
> What am I doing wrong here?!
>
> Thanks for any suggestions,
> Russell.
>
> PS:
>
> I'm running on SuSE 9.0 Linux.
>
> Python reports version "Python 2.3+ (#1, Sep 23 2003, 23:07:16)".
>
> >From the Apache error page:
>     Apache/2.0.48 (Linux/SuSE),
>     mod_python/3.1.2b
>     Python/2.3+.
>
> The only glitch I had in building mod_python was that I needed to specify
>     ./configure --with-apxs=/usr/sbin/apxs2
>
> rather than just refering to apxs.
>
> My apache configuration is (from the tutorial):
> <Directory /srv/www/htdocs/test>
>   AddHandler python-program .py
>   PythonHandler mptest
>   PythonDebug On
> </Directory>
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From mark at gsoa.net  Sun Dec 28 16:07:22 2003
From: mark at gsoa.net (Mark McClain)
Date: Fri Jan  9 21:54:09 2004
Subject: [mod_python] mod_python not working on Mac OS X 10.3
In-Reply-To: <A9026A4E-395E-11D8-982D-000A9599FB7E@newcode.se>
References: <A9026A4E-395E-11D8-982D-000A9599FB7E@newcode.se>
Message-ID: <D434E9D8-3979-11D8-BDD5-000A95B33D28@gsoa.net>

Here is what I use to build on 10.3.2:

1) Build and install apache2

2) Unpack the mod_python distribution

3) make the following changes to the configure script. here it is in  
modified form...

if test "$PyFRAMEWORKDIR" != "no-framework"; then
   if test -n "$PyFRAMEWORK"; then
     PyPYTHONLIBS="-framework $PyFRAMEWORK"

    # explicitly pass to mac linker so add this line
     LDFLAGS="${LDFLAGS} -Wl,-framework,Python"
   fi

4) run configure, make, then install

Good luck,
mark

On Dec 28, 2003, at 12:52 PM, Carl-Johan Kihlbom wrote:

> Hi list,
>
> I've installed mod_python on my Mac, but can't get it working. When I  
> restart Apache after configuring httpd.conf I get the following error:
>
> Syntax error on line 276 of /Library/Apache2/conf/httpd.conf:
> Cannot load /Library/Apache2/modules/mod_python.so into server: dyld:  
> /Library/Apache2/bin/httpd Undefined symbols:
> _PyExc_AttributeError
> _PyExc_IOError
> _PyExc_IndexError
> _PyExc_KeyError
> _PyExc_RuntimeError
> _PyExc_StopIteration
> _PyExc_TypeError
> _PyExc_ValueError
> _PyInt_Type
> _PyList_Type
> _PyObject_GenericGetAttr
> _PyObject_GenericSetAttr
> _PyString_Type
> _PyType_Type
> _Py_OptimizeFlag
> __Py_NoneStruct
> __Py_NotImplementedStruct
>
> I'm using mod_python 3.1.2b on my laptop running Apache 2.0.48 and Mac  
> OS X 10.3.2.
>
> In Mac OS X 10.3, Python 2.3 is installed by default, and the library  
> and include files are in  
> /System/Library/Frameworks/Python.framework/Versions/2.3/lib/ 
> python2.3/ and  
> /System/Library/Frameworks/Python.framework/Versions/2.3/include/ 
> python2.3/ respectively. I created symlinks to these at  
> /usr/lib/python and /usr/include/python.
>
> Any ideas what I did wrong?
>
> TIA,
>
> Carl-Johan Kihlbom
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From RussLear314 at yahoo.com  Mon Dec 29 08:57:00 2003
From: RussLear314 at yahoo.com (Russell Lear)
Date: Fri Jan  9 21:54:09 2004
Subject: [mod_python] Session unable to acquire mutex lock?
In-Reply-To: <20031228132058.S70904@onyx.ispol.com>
References: <200312271944.55425.RussLear314@yahoo.com>
	<20031228132058.S70904@onyx.ispol.com>
Message-ID: <200312290857.00982.RussLear314@yahoo.com>

Grisha,

Thanks for the suggestions.  

I did a stop/start and the problem happens on the first hit.

I enabled some debug logging (See below).  

There are two things I notice that seem odd to my inexperienced eye: 

1) During apache's startup, mod_python says
    "Creating 32 session mutexes based on 150 max processes and 0 max threads".  
Is "0 max threads" correct, or do I have something misconfigured? 
Seems like max threads ought to be at least 1 or 2 ??

2) When I invoke my test, there is a warning
    "Permission denied: Failed to acquire global mutex lock at index 17".  
Is that just saying that it failed to get a mutex lock or do I have bad permissions someplace?

Thanks,
Russell.

====================
Apache error_log exerpt:
[... 08:30:57 ] [info] Server: Apache/2.0.48, Interface: mod_ssl/2.0.48, Library: OpenSSL/0.9.7b
[... 08:30:57 ] [notice] suEXEC mechanism enabled (wrapper: /usr/sbin/suexec2)
[... 08:31:00 ] [info] Init: Initializing OpenSSL library
[... 08:31:00 ] [info] Init: Seeding PRNG with 0 bytes of entropy
[... 08:31:00 ] [info] Init: Generating temporary RSA private keys (512/1024 bits)
[... 08:31:00 ] [info] Init: Generating temporary DH parameters (512/1024 bits)
[... 08:31:00 ] [info] Init: Initializing (virtual) servers for SSL
[... 08:31:00 ] [info] Server: Apache/2.0.48, Interface: mod_ssl/2.0.48, Library: OpenSSL/0.9.7b
[... 08:31:02 ] [notice] mod_python: Creating 32 session mutexes based on 150 max processes and 0 max threads.
[... 08:31:02 ] [notice] Apache/2.0.48 (Linux/SuSE) mod_ssl/2.0.48 OpenSSL/0.9.7b PHP/4.3.3 mod_python/3.1.2b Python/2.3+ configured -- resuming normal operations
[... 08:31:02 ] [info] Server built: Nov 10 2003 11:47:10
[... 08:31:02 ] [debug] prefork.c(1037): AcceptMutex: sysvsem (default: sysvsem)
[... 08:31:15 ] [notice] mod_python: (Re)importing module 'mptest'
[... 08:31:16 ] [warn] (13)Permission denied: Failed to acquire global mutex lock at index 17
[... 08:31:16 ] [error] [client ::1] PythonHandler mptest: Traceback (most recent call last):
[... 08:31:16 ] [error] [client ::1] PythonHandler mptest: 
    File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 338, in HandlerDispatch
    result = object(req)
[... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
    File "/srv/www/htdocs/test/mptest.py", line 7, in handler
    sess = Session.Session(req)
[... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
    File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 411, in Session
    timeout=timeout)
[... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
    File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 316, in __init__
    secret=secret, timeout=timeout)
[... 08:31:16 ] [error] [client ::1] PythonHandler mptest:   
    File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 170, in __init__
    self.lock()                 # lock new sid
[... 08:31:16 ] [error] [client ::1] PythonHandler mptest:   
    File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 241, in lock
    _apache._global_lock(self._req.server, self._sid)
[... 08:31:16 ] [error] [client ::1] PythonHandler mptest: 
    ValueError: Failed to acquire global mutex lock

====================

On Sunday 28 December 2003 10:28, Gregory (Grisha) Trubetskoy wrote:
> If you restart the server, and try this code, does the error happen on the
> first hit, or only starting with the second and after waiting for a while?
>
> If if it's the former, then there probably is some problem with locking in
> general (are there any warning messages on server startup?). ...
>
> Grisha
>
> On Sat, 27 Dec 2003, Russell Lear wrote:
> > Hi,
> >
> > [RLear: 2003/12/29: deleted text to avoid overly long attachment]
> >
> >     from mod_python import apache, Session
> >     import sys
> >
> >     def handler(req):
> >         req.content_type = 'text/plain'
> >         req.write("Creating...\n")
> >         sess = Session.Session(req)
> >         req.write("Hello World!")
> >         return apache.OK
> >
> >  [RLear: 2003/12/29: deleted text to avoid overly long attachment]
> >
> > I'm running on SuSE 9.0 Linux.
> >
> > Python reports version "Python 2.3+ (#1, Sep 23 2003, 23:07:16)".
> >
> > >From the Apache error page:
> >
> >     Apache/2.0.48 (Linux/SuSE),
> >     mod_python/3.1.2b
> >     Python/2.3+.
> >
> > The only glitch I had in building mod_python was that I needed to specify
> >     ./configure --with-apxs=/usr/sbin/apxs2
> >
> > rather than just refering to apxs.
> >
> > My apache configuration is (from the tutorial):
> > <Directory /srv/www/htdocs/test>
> >   AddHandler python-program .py
> >   PythonHandler mptest
> >   PythonDebug On
> > </Directory>
> >
> >
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python

From div at newcode.se  Mon Dec 29 17:55:44 2003
From: div at newcode.se (Carl-Johan Kihlbom)
Date: Fri Jan  9 21:54:09 2004
Subject: [mod_python] mod_python not working on Mac OS X 10.3
In-Reply-To: <D434E9D8-3979-11D8-BDD5-000A95B33D28@gsoa.net>
References: <A9026A4E-395E-11D8-982D-000A9599FB7E@newcode.se>
	<D434E9D8-3979-11D8-BDD5-000A95B33D28@gsoa.net>
Message-ID: <D7CFFAED-3A1F-11D8-8995-000A9599FB7E@newcode.se>

That got me a bit further, thanks, but I still can't get it to work.  
I've followed the testing procedures in the manual by setting  
AllowOverride All in httpd.conf and creating a .htaccess file in  
htdocs/test with the following content:

AddHandler python-program .py
PythonHandler mptest
PythonDebug On

I then created a file mptest.py in the same directory. It looks like  
this:

from mod_python import apache

def handler(req):
     req.write("Hello World!")
     return apache.OK

When I try to access http://localhost/test/mptest.py I get a 500  
Internal Server Error. No additional information in the access or error  
log.

Any ideas what's wrong this time? :-)

Thanks again,

Carl-Johan Kihlbom

On Dec 28, 2003, at 22:07, Mark McClain wrote:

> Here is what I use to build on 10.3.2:
>
> 1) Build and install apache2
>
> 2) Unpack the mod_python distribution
>
> 3) make the following changes to the configure script. here it is in  
> modified form...
>
> if test "$PyFRAMEWORKDIR" != "no-framework"; then
>   if test -n "$PyFRAMEWORK"; then
>     PyPYTHONLIBS="-framework $PyFRAMEWORK"
>
>    # explicitly pass to mac linker so add this line
>     LDFLAGS="${LDFLAGS} -Wl,-framework,Python"
>   fi
>
> 4) run configure, make, then install
>
> Good luck,
> mark
>
> On Dec 28, 2003, at 12:52 PM, Carl-Johan Kihlbom wrote:
>
>> Hi list,
>>
>> I've installed mod_python on my Mac, but can't get it working. When I  
>> restart Apache after configuring httpd.conf I get the following  
>> error:
>>
>> Syntax error on line 276 of /Library/Apache2/conf/httpd.conf:
>> Cannot load /Library/Apache2/modules/mod_python.so into server: dyld:  
>> /Library/Apache2/bin/httpd Undefined symbols:
>> _PyExc_AttributeError
>> _PyExc_IOError
>> _PyExc_IndexError
>> _PyExc_KeyError
>> _PyExc_RuntimeError
>> _PyExc_StopIteration
>> _PyExc_TypeError
>> _PyExc_ValueError
>> _PyInt_Type
>> _PyList_Type
>> _PyObject_GenericGetAttr
>> _PyObject_GenericSetAttr
>> _PyString_Type
>> _PyType_Type
>> _Py_OptimizeFlag
>> __Py_NoneStruct
>> __Py_NotImplementedStruct
>>
>> I'm using mod_python 3.1.2b on my laptop running Apache 2.0.48 and  
>> Mac OS X 10.3.2.
>>
>> In Mac OS X 10.3, Python 2.3 is installed by default, and the library  
>> and include files are in  
>> /System/Library/Frameworks/Python.framework/Versions/2.3/lib/ 
>> python2.3/ and  
>> /System/Library/Frameworks/Python.framework/Versions/2.3/include/ 
>> python2.3/ respectively. I created symlinks to these at  
>> /usr/lib/python and /usr/include/python.
>>
>> Any ideas what I did wrong?
>>
>> TIA,
>>
>> Carl-Johan Kihlbom

From grisha at modpython.org  Mon Dec 29 16:54:57 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:54:10 2004
Subject: [mod_python] Session unable to acquire mutex lock?
In-Reply-To: <200312290857.00982.RussLear314@yahoo.com>
References: <200312271944.55425.RussLear314@yahoo.com>
	<20031228132058.S70904@onyx.ispol.com>
	<200312290857.00982.RussLear314@yahoo.com>
Message-ID: <20031229165250.V88187@onyx.ispol.com>


This looks like a permissions bug with System V IPC that made it into the
beta. Try running one of the latest CVS snapshots, I think it is fixed
there.

Grisha

On Mon, 29 Dec 2003, Russell Lear wrote:

> Grisha,
>
> Thanks for the suggestions.
>
> I did a stop/start and the problem happens on the first hit.
>
> I enabled some debug logging (See below).
>
> There are two things I notice that seem odd to my inexperienced eye:
>
> 1) During apache's startup, mod_python says
>     "Creating 32 session mutexes based on 150 max processes and 0 max threads".
> Is "0 max threads" correct, or do I have something misconfigured?
> Seems like max threads ought to be at least 1 or 2 ??
>
> 2) When I invoke my test, there is a warning
>     "Permission denied: Failed to acquire global mutex lock at index 17".
> Is that just saying that it failed to get a mutex lock or do I have bad permissions someplace?
>
> Thanks,
> Russell.
>
> ====================
> Apache error_log exerpt:
> [... 08:30:57 ] [info] Server: Apache/2.0.48, Interface: mod_ssl/2.0.48, Library: OpenSSL/0.9.7b
> [... 08:30:57 ] [notice] suEXEC mechanism enabled (wrapper: /usr/sbin/suexec2)
> [... 08:31:00 ] [info] Init: Initializing OpenSSL library
> [... 08:31:00 ] [info] Init: Seeding PRNG with 0 bytes of entropy
> [... 08:31:00 ] [info] Init: Generating temporary RSA private keys (512/1024 bits)
> [... 08:31:00 ] [info] Init: Generating temporary DH parameters (512/1024 bits)
> [... 08:31:00 ] [info] Init: Initializing (virtual) servers for SSL
> [... 08:31:00 ] [info] Server: Apache/2.0.48, Interface: mod_ssl/2.0.48, Library: OpenSSL/0.9.7b
> [... 08:31:02 ] [notice] mod_python: Creating 32 session mutexes based on 150 max processes and 0 max threads.
> [... 08:31:02 ] [notice] Apache/2.0.48 (Linux/SuSE) mod_ssl/2.0.48 OpenSSL/0.9.7b PHP/4.3.3 mod_python/3.1.2b Python/2.3+ configured -- resuming normal operations
> [... 08:31:02 ] [info] Server built: Nov 10 2003 11:47:10
> [... 08:31:02 ] [debug] prefork.c(1037): AcceptMutex: sysvsem (default: sysvsem)
> [... 08:31:15 ] [notice] mod_python: (Re)importing module 'mptest'
> [... 08:31:16 ] [warn] (13)Permission denied: Failed to acquire global mutex lock at index 17
> [... 08:31:16 ] [error] [client ::1] PythonHandler mptest: Traceback (most recent call last):
> [... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
>     File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 338, in HandlerDispatch
>     result = object(req)
> [... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
>     File "/srv/www/htdocs/test/mptest.py", line 7, in handler
>     sess = Session.Session(req)
> [... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
>     File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 411, in Session
>     timeout=timeout)
> [... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
>     File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 316, in __init__
>     secret=secret, timeout=timeout)
> [... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
>     File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 170, in __init__
>     self.lock()                 # lock new sid
> [... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
>     File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 241, in lock
>     _apache._global_lock(self._req.server, self._sid)
> [... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
>     ValueError: Failed to acquire global mutex lock
>
> ====================
>
> On Sunday 28 December 2003 10:28, Gregory (Grisha) Trubetskoy wrote:
> > If you restart the server, and try this code, does the error happen on the
> > first hit, or only starting with the second and after waiting for a while?
> >
> > If if it's the former, then there probably is some problem with locking in
> > general (are there any warning messages on server startup?). ...
> >
> > Grisha
> >
> > On Sat, 27 Dec 2003, Russell Lear wrote:
> > > Hi,
> > >
> > > [RLear: 2003/12/29: deleted text to avoid overly long attachment]
> > >
> > >     from mod_python import apache, Session
> > >     import sys
> > >
> > >     def handler(req):
> > >         req.content_type = 'text/plain'
> > >         req.write("Creating...\n")
> > >         sess = Session.Session(req)
> > >         req.write("Hello World!")
> > >         return apache.OK
> > >
> > >  [RLear: 2003/12/29: deleted text to avoid overly long attachment]
> > >
> > > I'm running on SuSE 9.0 Linux.
> > >
> > > Python reports version "Python 2.3+ (#1, Sep 23 2003, 23:07:16)".
> > >
> > > >From the Apache error page:
> > >
> > >     Apache/2.0.48 (Linux/SuSE),
> > >     mod_python/3.1.2b
> > >     Python/2.3+.
> > >
> > > The only glitch I had in building mod_python was that I needed to specify
> > >     ./configure --with-apxs=/usr/sbin/apxs2
> > >
> > > rather than just refering to apxs.
> > >
> > > My apache configuration is (from the tutorial):
> > > <Directory /srv/www/htdocs/test>
> > >   AddHandler python-program .py
> > >   PythonHandler mptest
> > >   PythonDebug On
> > > </Directory>
> > >
> > >
> > >
> > > _______________________________________________
> > > Mod_python mailing list
> > > Mod_python@modpython.org
> > > http://mailman.modpython.org/mailman/listinfo/mod_python
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From RussLear314 at yahoo.com  Mon Dec 29 21:00:59 2003
From: RussLear314 at yahoo.com (Russell Lear)
Date: Fri Jan  9 21:54:10 2004
Subject: [mod_python] Session unable to acquire mutex lock?
In-Reply-To: <20031229165250.V88187@onyx.ispol.com>
References: <200312271944.55425.RussLear314@yahoo.com>
	<200312290857.00982.RussLear314@yahoo.com>
	<20031229165250.V88187@onyx.ispol.com>
Message-ID: <200312292100.59743.RussLear314@yahoo.com>

Ok!  I'm able to create a session now!

I grabbed httpd-python_20031229231518.tar.gz and things seem to work now.

Thanks a lot Grisha for your help.

Russell.


On Monday 29 December 2003 13:54, Gregory (Grisha) Trubetskoy wrote:
> This looks like a permissions bug with System V IPC that made it into the
> beta. Try running one of the latest CVS snapshots, I think it is fixed
> there.
>
> Grisha
>

From kevin at sb.org  Tue Dec 30 01:35:11 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:54:10 2004
Subject: [mod_python] mod_python not working on Mac OS X 10.3
In-Reply-To: <D7CFFAED-3A1F-11D8-8995-000A9599FB7E@newcode.se>
References: <A9026A4E-395E-11D8-982D-000A9599FB7E@newcode.se>
	<D434E9D8-3979-11D8-BDD5-000A95B33D28@gsoa.net>
	<D7CFFAED-3A1F-11D8-8995-000A9599FB7E@newcode.se>
Message-ID: <519C889B-3A92-11D8-9AD2-000A95A072FC@sb.org>

Gah, I always do this! This message was meant to go to the list.

---

I got a lot of that stuff until I stopped doing graceful restarts and 
started doing a stop, waiting for all httpd processes to die out, then 
starting it back up. That tended to fix the problem.

On Dec 29, 2003, at 11:55 AM, Carl-Johan Kihlbom wrote:

> When I try to access http://localhost/test/mptest.py I get a 500 
> Internal Server Error. No additional information in the access or 
> error log.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From pkeshishian at yahoo.com  Tue Dec 30 01:54:41 2003
From: pkeshishian at yahoo.com (Petros Keshishian)
Date: Fri Jan  9 21:54:10 2004
Subject: [mod_python] MySQLdb
Message-ID: <20031230095441.1986.qmail@web40020.mail.yahoo.com>

I would very much appreciate if anyone could resolve
my problem with MySQLdb.

I am try to run a query from mod_python as follows:

db = MySQldb.connect(db='aua', user='root')
c = db.cursor()
c.execute('select fname,lname,gyear from addrbk')

The program freezes at the last (3rd) line. The same
code works fine if I run it from python shell
directly. 
The code even works in mod_python if I query for less
than 3 column, e.g.

c.execute('select fname,lname from addrbk')
or
c.execute('select lname, gyear from addrbk')

Can anybody tell me what's going on?

Thank you for your help,
Petros







__________________________________
Do you Yahoo!?
Find out what made the Top Yahoo! Searches of 2003
http://search.yahoo.com/top2003
From neel at mediapulse.com  Tue Dec 30 11:08:45 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:54:10 2004
Subject: [mod_python] MySQLdb
Message-ID: <C0FC22C08B82074A88B50061764157776B991B@johnson.mediapulse.net>

Do you have PythonDebug On in your conf to see any traceback errors?
They should also be in your error log as well, even if debug is off.  If
they don't answer your questions, forward those on they will help in
seeing the problem.

Thanks,
Mike


> -----Original Message-----
> From: Petros Keshishian [mailto:pkeshishian@yahoo.com] 
> Sent: Tuesday, December 30, 2003 4:55 AM
> To: mod_python@modpython.org
> Subject: [mod_python] MySQLdb
> 
> 
> I would very much appreciate if anyone could resolve
> my problem with MySQLdb.
> 
> I am try to run a query from mod_python as follows:
> 
> db = MySQldb.connect(db='aua', user='root')
> c = db.cursor()
> c.execute('select fname,lname,gyear from addrbk')
> 
> The program freezes at the last (3rd) line. The same
> code works fine if I run it from python shell
> directly. 
> The code even works in mod_python if I query for less
> than 3 column, e.g.
> 
> c.execute('select fname,lname from addrbk')
> or
> c.execute('select lname, gyear from addrbk')
> 
> Can anybody tell me what's going on?
> 
> Thank you for your help,
> Petros
> 
> 
> 
> 
> 
> 
> 
> __________________________________
> Do you Yahoo!?
> Find out what made the Top Yahoo! Searches of 2003
> http://search.yahoo.com/top2003
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

From pkeshishian at yahoo.com  Tue Dec 30 09:13:18 2003
From: pkeshishian at yahoo.com (Petros Keshishian)
Date: Fri Jan  9 21:54:10 2004
Subject: [mod_python] MySQLdb
In-Reply-To: <C0FC22C08B82074A88B50061764157776B991B@johnson.mediapulse.net>
Message-ID: <20031230171318.10032.qmail@web40015.mail.yahoo.com>

I do have PythonDebud On, but it does not report any
errors. The error log has the following:

[Tue Dec 30 09:07:16 2003] [notice] mod_python:
(Re)importing module 'pyhndlr' with path set to
'['/usr/local/apache2/htdocs/auaweb/frm_address']'
[Tue Dec 30 09:07:16 2003] [notice] child pid 4161
exit signal Segmentation fault (11)

pyhndlr.py is the file where the code resides. I hope
you know what this segmentation fault could be.

Thanks,
Petros


--- "Michael C. Neel" <neel@mediapulse.com> wrote:
> Do you have PythonDebug On in your conf to see any
> traceback errors?
> They should also be in your error log as well, even
> if debug is off.  If
> they don't answer your questions, forward those on
> they will help in
> seeing the problem.
> 
> Thanks,
> Mike
> 
> 
> > -----Original Message-----
> > From: Petros Keshishian
> [mailto:pkeshishian@yahoo.com] 
> > Sent: Tuesday, December 30, 2003 4:55 AM
> > To: mod_python@modpython.org
> > Subject: [mod_python] MySQLdb
> > 
> > 
> > I would very much appreciate if anyone could
> resolve
> > my problem with MySQLdb.
> > 
> > I am try to run a query from mod_python as
> follows:
> > 
> > db = MySQldb.connect(db='aua', user='root')
> > c = db.cursor()
> > c.execute('select fname,lname,gyear from addrbk')
> > 
> > The program freezes at the last (3rd) line. The
> same
> > code works fine if I run it from python shell
> > directly. 
> > The code even works in mod_python if I query for
> less
> > than 3 column, e.g.
> > 
> > c.execute('select fname,lname from addrbk')
> > or
> > c.execute('select lname, gyear from addrbk')
> > 
> > Can anybody tell me what's going on?
> > 
> > Thank you for your help,
> > Petros
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > __________________________________
> > Do you Yahoo!?
> > Find out what made the Top Yahoo! Searches of 2003
> > http://search.yahoo.com/top2003
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> >
>
http://mailman.modpython.org/mailman/listinfo/mod_python
> > 


__________________________________
Do you Yahoo!?
Find out what made the Top Yahoo! Searches of 2003
http://search.yahoo.com/top2003
From pkeshishian at yahoo.com  Tue Dec 30 10:20:40 2003
From: pkeshishian at yahoo.com (Petros Keshishian)
Date: Fri Jan  9 21:54:10 2004
Subject: [mod_python] MySQLdb
In-Reply-To: <1072769149.20927.1.camel@inspiration.x.eradman.com>
Message-ID: <20031230182040.81782.qmail@web40008.mail.yahoo.com>

Eric:
 
I have put req.write() statements before and after the execute() function like this:
 
db = MySQldb.connect(db='aua', user='root')
c = db.cursor()
req.content_type = "text/plain"
req.write("Before Execute\n")
c.execute('select fname,lname,gyear from addrbk')
req.write("After Execute\n")
 
When I point the browser to this function I see:
Before Execute
 
And nothing else. No error messages even though I have PythonDebug On. As I already sent in my previous e-mail there is a segmentation fault reported in error log.
 
What's surprising is that it works fine if I query for any two columns instead of three.
 
Thanks for your help,
Petros


Eric Radman <theman@eradman.com> wrote:
Petros,

Are you saying that it won't run ANYTHING after the execute() function?

Eric Radman
theman@eradman.com

On Tue, 2003-12-30 at 09:54, Petros Keshishian wrote:
> I would very much appreciate if anyone could resolve
> my problem with MySQLdb.
> 
> I am try to run a query from mod_python as follows:
> 
> db = MySQldb.connect(db='aua', user='root')
> c = db.cursor()
> c.execute('select fname,lname,gyear from addrbk')
> 
> The program freezes at the last (3rd) line. The same
> code works fine if I run it from python shell
> directly. 
> The code even works in mod_python if I query for less
> than 3 column, e.g.
> 
> c.execute('select fname,lname from addrbk')
> or
> c.execute('select lname, gyear from addrbk')
> 
> Can anybody tell me what's going on?
> 
> Thank you for your help,
> Petros
> 
> 
> 
> 
> 
> 
> 
> __________________________________
> Do you Yahoo!?
> Find out what made the Top Yahoo! Searches of 2003
> http://search.yahoo.com/top2003
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python


---------------------------------
Do you Yahoo!?
Find out what made the Top Yahoo! Searches of 2003
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20031230/06304ebd/attachment-0001.htm
From redconectabilbao at telefonica.net  Wed Dec 31 10:57:31 2003
From: redconectabilbao at telefonica.net (Red Conecta)
Date: Fri Jan  9 21:54:10 2004
Subject: [mod_python] mod_python and css
Message-ID: <3FF29D8B.6030208@telefonica.net>

I'm trying to use css with the publisherhandler; here is the code:

    def _inicio():
        ini= '''<head><title>nombredelsitio</title>
                  <link rel="stylesheet" href="estilo.css"
    Type="text/css"></head>
                  <body leftmargin=0 rightmargin=0 topmargin=0
    bottommargin=0>'''
       
        return ini

    def _final():
        return '</body></html>'

    def mostrar(req,direccion='/'):
        req.content_type = "text/html"
        html=_inicio()
        obj=leerobjeto(direccion)
        if obj!=None:
            for i in obj.__dict__:html+=i+': '+obj.__dict__[i]+'<br>'
        else:html+='error'
        html+=_final()
        return html

the output doesn't use the estilo.css archive but if I save the page in 
'mostrar.html' all is ok.

From sgillies at frii.com  Wed Dec 31 07:42:41 2003
From: sgillies at frii.com (Sean Gillies)
Date: Fri Jan  9 21:54:10 2004
Subject: [mod_python] mod_python and css
In-Reply-To: <3FF29D8B.6030208@telefonica.net>
References: <3FF29D8B.6030208@telefonica.net>
Message-ID: <960A9AF8-3B9F-11D8-9527-000393B98B56@frii.com>

On Dec 31, 2003, at 2:57 AM, Red Conecta wrote:

> I'm trying to use css with the publisherhandler; here is the code:
>
>    def _inicio():
>        ini= '''<head><title>nombredelsitio</title>
>                  <link rel="stylesheet" href="estilo.css"
>    Type="text/css"></head>
>                  <body leftmargin=0 rightmargin=0 topmargin=0
>    bottommargin=0>'''
>              return ini
>
>    def _final():
>        return '</body></html>'
>
>    def mostrar(req,direccion='/'):
>        req.content_type = "text/html"
>        html=_inicio()
>        obj=leerobjeto(direccion)
>        if obj!=None:
>            for i in obj.__dict__:html+=i+': '+obj.__dict__[i]+'<br>'
>        else:html+='error'
>        html+=_final()
>        return html
>
> the output doesn't use the estilo.css archive but if I save the page 
> in 'mostrar.html' all is ok.
>

Try "../estilo.css", this will link to the stylesheet in the same
location as the published module.

cheers,
Sean

--
Sean Gillies
sgillies at frii dot com
http://users.frii.com/sgillies

From kevin at sb.org  Wed Dec 31 15:18:58 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:54:10 2004
Subject: [mod_python] mod_python and css
In-Reply-To: <3FF29D8B.6030208@telefonica.net>
References: <3FF29D8B.6030208@telefonica.net>
Message-ID: <9089E1A9-3BCE-11D8-9AD2-000A95A072FC@sb.org>

That's because with this handler, your URL looks something like

http://my.domain.com/myScript/mostrar

so when you access "estilo.css", the requested URL is

/myScript/estilo.css

However, your script doesn't handle estilo.css, since that's actually a 
file in the same directory as myScript. If you replace the script with 
mostrar.html, then estilo.css is accessed as

/estilo.css

instead, since the myScript path segment is now gone.

The solution is to put "../estilo.css" as your CSS href.

P.S. Why does this list use a Reply-To for the original sender rather 
than for the list itself? I keep sending mail to individual people when 
I mean to simply reply to the list itself.

On Dec 31, 2003, at 4:57 AM, Red Conecta wrote:

> I'm trying to use css with the publisherhandler; here is the code:
>
>    def _inicio():
>        ini= '''<head><title>nombredelsitio</title>
>                  <link rel="stylesheet" href="estilo.css"
>    Type="text/css"></head>
>                  <body leftmargin=0 rightmargin=0 topmargin=0
>    bottommargin=0>'''
>              return ini
>
>    def _final():
>        return '</body></html>'
>
>    def mostrar(req,direccion='/'):
>        req.content_type = "text/html"
>        html=_inicio()
>        obj=leerobjeto(direccion)
>        if obj!=None:
>            for i in obj.__dict__:html+=i+': '+obj.__dict__[i]+'<br>'
>        else:html+='error'
>        html+=_final()
>        return html
>
> the output doesn't use the estilo.css archive but if I save the page 
> in 'mostrar.html' all is ok.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From jay at jaydorsey.com  Mon Dec  1 11:22:03 2003
From: jay at jaydorsey.com (Jay Dorsey)
Date: Fri Jan  9 22:00:35 2004
Subject: [mod_python] Mailing list archive link
Message-ID: <20031201172203.GA32445@gentoo.Earthlink.net>

I was trying to download the mailing list archives this morning. From the front page of http://www.modpython.org I clicked on the "Mailing list archives are here" link. The "download the full raw archive" link points to http://www.modpython.org/pipermail/mod_python.mbox/mod_python.mbox which is a 404. Clicking the "more information about this list" link, which took me to the mailman page, then clicking the "Mod python archives" link took me to a page that was similar to the archive list linked on the front page of modpython.org. This page has what I assume to be the correct link to the mailing list archives: http://mailman.modpython.org/pipermail/mod_python.mbox/mod_python.mbox.

Sorry if this has already been posted--I've just started subscribing to the list and I searched the raw archives for mmention of this and found nothing.  Also, is there a user-friendly web interface for searching through the modpython mailing list archives?

-- 
Jay Dorsey
jay at jaydorsey dot com
From aalbarracindev at hotmail.com  Mon Dec  1 18:48:04 2003
From: aalbarracindev at hotmail.com (Alberto Sanchez Albarracin)
Date: Fri Jan  9 22:00:35 2004
Subject: [mod_python] apache doesn't start
Message-ID: <BAY7-F27e1YM9a2flhn0002153b@hotmail.com>

Hi all, i want mod_python for apache1(windows), the download page says that
mod_python 2.7.9 works with http server 1.3 but the link led me to one page
where appeared one directory named "win" among another files and two
directories, i went into win directory and i found several directories, i
choose the 2.7.6 directory and appeared two files listed below:
python2.2-apache1.3.20.zip, python2.2-apache1.3.20.zip
I pressed on the python2.2-apache1.3.22.zip file which is the second one,
decompressed it, and i just found a dll file named mod_python.dll.
My question is: where should i copy this file so that apache starts without
errors. The error is: Cannot load mod_python.so into server, the specific
module could not be found...

Thanks in advance

_________________________________________________________________
STOP MORE SPAM with the new MSN 8 and get 2 months FREE* 
http://join.msn.com/?page=features/junkmail

From neel at mediapulse.com  Tue Dec  2 11:44:34 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:00:35 2004
Subject: [mod_python] Getting mod_python version
Message-ID: <C0FC22C08B82074A88B500617641577787A7D3@johnson.mediapulse.net>

Hi all,

	I don't know if it's not there, or I'm just overlooking it, but
I can seem for a way in code to get the version of mod_python.  I have
some "default" modules I use, and I am trying to make them work with any
mod_python version.  Right now I'm doing try block, like such:

    # Get username/password from client
    pw = req.get_basic_auth_pw()
    try:
        # mod_python 2.x
        user = req.connection.user
    except:
        # mod_python 3.x
        user = req.user

	...but I'd rather be able to get the version directly.

Mike

From gustavo.cordova at q-voz.com  Tue Dec  2 12:47:27 2003
From: gustavo.cordova at q-voz.com (=?ISO-8859-1?Q?Gustavo_C=F3rdova_Avila?=)
Date: Fri Jan  9 22:00:35 2004
Subject: [mod_python] Getting mod_python version
In-Reply-To: <C0FC22C08B82074A88B500617641577787A7D3@johnson.mediapulse.net>
References: <C0FC22C08B82074A88B500617641577787A7D3@johnson.mediapulse.net>
Message-ID: <3FCCDE3F.4090005@q-voz.com>

This is the correct, "pythonic" way of doing things.

I'd recommend using "except AttributeError:" instead of a naked 
"except:" btw.

-gustavo

Michael C. Neel wrote:

>Hi all,
>
>	I don't know if it's not there, or I'm just overlooking it, but
>I can seem for a way in code to get the version of mod_python.  I have
>some "default" modules I use, and I am trying to make them work with any
>mod_python version.  Right now I'm doing try block, like such:
>
>    # Get username/password from client
>    pw = req.get_basic_auth_pw()
>    try:
>        # mod_python 2.x
>        user = req.connection.user
>    except:
>        # mod_python 3.x
>        user = req.user
>
>	...but I'd rather be able to get the version directly.
>
>Mike
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
>  
>

From neel at mediapulse.com  Tue Dec  2 14:30:41 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:00:35 2004
Subject: [mod_python] Getting mod_python version
Message-ID: <C0FC22C08B82074A88B500617641577787A7D4@johnson.mediapulse.net>

Most modules have a __version__ member, and the help() built-in method
even looks for this variable and uses it to display the version of the
file:

>>>import cgi
>>>cgi.__version__
'2.6'
>>>help(cgi)
...skipping...
DATA
    __all__ = ['MiniFieldStorage', 'FieldStorage', 'FormContentDict',
'SvF...
    __version__ = '2.6'
    logfile = ''
    logfp = None
    maxlen = 0

VERSION
    2.6

>>>

I have not read or seen anything saying the "pythonic" way of versioning
a module is by try/except blocks testing to see if variable exist.  I
have however seen this from PEP 8:

Version Bookkeeping

    If you have to have RCS or CVS crud in your source file, do it as
    follows.

        __version__ = "$Revision: 1.20 $"
        # $Source: /cvsroot/python/python/nondist/peps/pep-0008.txt,v $

    These lines should be included after the module's docstring,
    before any other code, separated by a blank line above and
    below.

Which implies to me that __version__ is a pythonic way of versioning a
module/code file, though it doesn't seem to be as standard as __doc__.

Mike

> -----Original Message-----
> From: Gustavo C?rdova Avila [mailto:gustavo.cordova@q-voz.com] 
> Sent: Tuesday, December 02, 2003 1:47 PM
> To: Michael C. Neel
> Cc: mod_python@modpython.org
> Subject: Re: [mod_python] Getting mod_python version
> 
> 
> This is the correct, "pythonic" way of doing things.
> 
> I'd recommend using "except AttributeError:" instead of a naked 
> "except:" btw.
> 
> -gustavo
> 
> Michael C. Neel wrote:
> 
> >Hi all,
> >
> >	I don't know if it's not there, or I'm just overlooking it, but
> >I can seem for a way in code to get the version of 
> mod_python.  I have
> >some "default" modules I use, and I am trying to make them 
> work with any
> >mod_python version.  Right now I'm doing try block, like such:
> >
> >    # Get username/password from client
> >    pw = req.get_basic_auth_pw()
> >    try:
> >        # mod_python 2.x
> >        user = req.connection.user
> >    except:
> >        # mod_python 3.x
> >        user = req.user
> >
> >	...but I'd rather be able to get the version directly.
> >
> >Mike
> >
> >_______________________________________________
> >Mod_python mailing list
> >Mod_python@modpython.org
> >http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> >
> >  
> >
> 
> 

From michael at dynamine.net  Tue Dec  2 11:41:16 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 22:00:35 2004
Subject: [mod_python] Getting mod_python version
In-Reply-To: <C0FC22C08B82074A88B500617641577787A7D4@johnson.mediapulse.net>
References: <C0FC22C08B82074A88B500617641577787A7D4@johnson.mediapulse.net>
Message-ID: <3FCCEADC.9060701@dynamine.net>

Regardless of whether or not __version__ is implemented, using exception 
handling is more robust in the long run, I think.

Forgetting to change the interface version number when a compatibility 
detail has changed is not an unknown phenomenon -- if not with 
mod_python, then certainly with other SDKs.

--Michael

Michael C. Neel wrote:

> Most modules have a __version__ member, and the help() built-in method
> even looks for this variable and uses it to display the version of the
> file:
> 
> 
>>>>import cgi
>>>>cgi.__version__
> 
> '2.6'
> 
>>>>help(cgi)
> 
> ...skipping...
> DATA
>     __all__ = ['MiniFieldStorage', 'FieldStorage', 'FormContentDict',
> 'SvF...
>     __version__ = '2.6'
>     logfile = ''
>     logfp = None
>     maxlen = 0
> 
> VERSION
>     2.6
> 
> 
> 
> I have not read or seen anything saying the "pythonic" way of versioning
> a module is by try/except blocks testing to see if variable exist.  I
> have however seen this from PEP 8:
> 
> Version Bookkeeping
> 
>     If you have to have RCS or CVS crud in your source file, do it as
>     follows.
> 
>         __version__ = "$Revision: 1.20 $"
>         # $Source: /cvsroot/python/python/nondist/peps/pep-0008.txt,v $
> 
>     These lines should be included after the module's docstring,
>     before any other code, separated by a blank line above and
>     below.
> 
> Which implies to me that __version__ is a pythonic way of versioning a
> module/code file, though it doesn't seem to be as standard as __doc__.
> 
> Mike
> 
> 
>>-----Original Message-----
>>From: Gustavo C?rdova Avila [mailto:gustavo.cordova@q-voz.com] 
>>Sent: Tuesday, December 02, 2003 1:47 PM
>>To: Michael C. Neel
>>Cc: mod_python@modpython.org
>>Subject: Re: [mod_python] Getting mod_python version
>>
>>
>>This is the correct, "pythonic" way of doing things.
>>
>>I'd recommend using "except AttributeError:" instead of a naked 
>>"except:" btw.
>>
>>-gustavo
>>
>>Michael C. Neel wrote:
>>
>>
>>>Hi all,
>>>
>>>	I don't know if it's not there, or I'm just overlooking it, but
>>>I can seem for a way in code to get the version of 
>>
>>mod_python.  I have
>>
>>>some "default" modules I use, and I am trying to make them 
>>
>>work with any
>>
>>>mod_python version.  Right now I'm doing try block, like such:
>>>
>>>   # Get username/password from client
>>>   pw = req.get_basic_auth_pw()
>>>   try:
>>>       # mod_python 2.x
>>>       user = req.connection.user
>>>   except:
>>>       # mod_python 3.x
>>>       user = req.user
>>>
>>>	...but I'd rather be able to get the version directly.
>>>
>>>Mike
>>>
>>>_______________________________________________
>>>Mod_python mailing list
>>>Mod_python@modpython.org
>>>http://mailman.modpython.org/mailman/listinfo/mod_python
>>>
>>>
>>> 
>>>
>>
>>
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

From neel at mediapulse.com  Tue Dec  2 14:51:32 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:00:35 2004
Subject: [mod_python] Getting mod_python version
Message-ID: <C0FC22C08B82074A88B50061764157776B9864@johnson.mediapulse.net>

What if something changed every major version, 2 - 5?

with __version__ you could:

	if m.__version__.startswidth('2.'):
		user = m.get2_user()
	elif m.__version__.startswidth('3.'):
		user = m.get3_user()
	elif m.__version__.startswidth('4.'):
		user = m.get4_user()
	elif m.__version__.startswidth('5.'):
		user = m.get5_user()
	else:
		#unsupported version

with try/except:

	try:
		user = m.get2_user()
	except:
		try:
			user = m.get3_user()
		except:
			try:
				user = m.get4_user()
			except:
				try:
					user = m.get5_user()
				except:
					#unsupported version

I'm failing to see why it is supposed to be easier to code/easier to
read with multiple try/except blocks, which are just going to get deeper
as we go.

Mike

> -----Original Message-----
> From: Michael S. Fischer [mailto:michael@dynamine.net] 
> Sent: Tuesday, December 02, 2003 2:41 PM
> To: Michael C. Neel
> Cc: Gustavo C?rdova Avila; mod_python@modpython.org
> Subject: Re: [mod_python] Getting mod_python version
> 
> 
> Regardless of whether or not __version__ is implemented, 
> using exception 
> handling is more robust in the long run, I think.
> 
> Forgetting to change the interface version number when a 
> compatibility 
> detail has changed is not an unknown phenomenon -- if not with 
> mod_python, then certainly with other SDKs.
> 
> --Michael
> 
> Michael C. Neel wrote:
> 
> > Most modules have a __version__ member, and the help() 
> built-in method
> > even looks for this variable and uses it to display the 
> version of the
> > file:
> > 
> > 
> >>>>import cgi
> >>>>cgi.__version__
> > 
> > '2.6'
> > 
> >>>>help(cgi)
> > 
> > ...skipping...
> > DATA
> >     __all__ = ['MiniFieldStorage', 'FieldStorage', 
> 'FormContentDict',
> > 'SvF...
> >     __version__ = '2.6'
> >     logfile = ''
> >     logfp = None
> >     maxlen = 0
> > 
> > VERSION
> >     2.6
> > 
> > 
> > 
> > I have not read or seen anything saying the "pythonic" way 
> of versioning
> > a module is by try/except blocks testing to see if variable 
> exist.  I
> > have however seen this from PEP 8:
> > 
> > Version Bookkeeping
> > 
> >     If you have to have RCS or CVS crud in your source 
> file, do it as
> >     follows.
> > 
> >         __version__ = "$Revision: 1.20 $"
> >         # $Source: 
> /cvsroot/python/python/nondist/peps/pep-0008.txt,v $
> > 
> >     These lines should be included after the module's docstring,
> >     before any other code, separated by a blank line above and
> >     below.
> > 
> > Which implies to me that __version__ is a pythonic way of 
> versioning a
> > module/code file, though it doesn't seem to be as standard 
> as __doc__.
> > 
> > Mike
> > 
> > 
> >>-----Original Message-----
> >>From: Gustavo C?rdova Avila [mailto:gustavo.cordova@q-voz.com] 
> >>Sent: Tuesday, December 02, 2003 1:47 PM
> >>To: Michael C. Neel
> >>Cc: mod_python@modpython.org
> >>Subject: Re: [mod_python] Getting mod_python version
> >>
> >>
> >>This is the correct, "pythonic" way of doing things.
> >>
> >>I'd recommend using "except AttributeError:" instead of a naked 
> >>"except:" btw.
> >>
> >>-gustavo
> >>
> >>Michael C. Neel wrote:
> >>
> >>
> >>>Hi all,
> >>>
> >>>	I don't know if it's not there, or I'm just overlooking it, but
> >>>I can seem for a way in code to get the version of 
> >>
> >>mod_python.  I have
> >>
> >>>some "default" modules I use, and I am trying to make them 
> >>
> >>work with any
> >>
> >>>mod_python version.  Right now I'm doing try block, like such:
> >>>
> >>>   # Get username/password from client
> >>>   pw = req.get_basic_auth_pw()
> >>>   try:
> >>>       # mod_python 2.x
> >>>       user = req.connection.user
> >>>   except:
> >>>       # mod_python 3.x
> >>>       user = req.user
> >>>
> >>>	...but I'd rather be able to get the version directly.
> >>>
> >>>Mike
> >>>
> >>>_______________________________________________
> >>>Mod_python mailing list
> >>>Mod_python@modpython.org
> >>>http://mailman.modpython.org/mailman/listinfo/mod_python
> >>>
> >>>
> >>> 
> >>>
> >>
> >>
> > 
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> > 
> 
> 

From vincent_delft at yahoo.com  Tue Dec  2 11:54:01 2003
From: vincent_delft at yahoo.com (vincent delft)
Date: Fri Jan  9 22:00:35 2004
Subject: [mod_python] does mod_python is ready for production env. ?
Message-ID: <20031202195401.44707.qmail@web11505.mail.yahoo.com>

Sorry to ask this (may be stupid), but I plan to use
mod_python and Draco (see in links of the mod_python
site) on a production environment (a web service that
our enterprise will provide via http servers)


Is there any experience of mod_python on a production
env. ?

What about stability, fiability on a heavy loaded web
site ?

Is there "show stoppers" to use mod_python on a
production env. ?

Thanks 


PS : I'm pythoniac since years, and I definitively
hate php (just a personnal point of view).




__________________________________
Do you Yahoo!?
Free Pop-Up Blocker - Get it now
http://companion.yahoo.com/
From michael at dynamine.net  Tue Dec  2 11:59:05 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 22:00:35 2004
Subject: [mod_python] Getting mod_python version
In-Reply-To: <C0FC22C08B82074A88B50061764157776B9864@johnson.mediapulse.net>
References: <C0FC22C08B82074A88B50061764157776B9864@johnson.mediapulse.net>
Message-ID: <3FCCEF09.6000907@dynamine.net>

I agree that the code looks a little cleaner, but I still think it's 
less robust due to the phenomenon I described.

(Python also makes you use 'elif's instead of 'case' statements, and 
there's something to be said about the ugliness of the former as well. 
Eye of the beholder, I guess.)

Best,

--Michael

Michael C. Neel wrote:

> What if something changed every major version, 2 - 5?
> 
> with __version__ you could:
> 
> 	if m.__version__.startswidth('2.'):
> 		user = m.get2_user()
> 	elif m.__version__.startswidth('3.'):
> 		user = m.get3_user()
> 	elif m.__version__.startswidth('4.'):
> 		user = m.get4_user()
> 	elif m.__version__.startswidth('5.'):
> 		user = m.get5_user()
> 	else:
> 		#unsupported version
> 
> with try/except:
> 
> 	try:
> 		user = m.get2_user()
> 	except:
> 		try:
> 			user = m.get3_user()
> 		except:
> 			try:
> 				user = m.get4_user()
> 			except:
> 				try:
> 					user = m.get5_user()
> 				except:
> 					#unsupported version
> 
> I'm failing to see why it is supposed to be easier to code/easier to
> read with multiple try/except blocks, which are just going to get deeper
> as we go.
> 
> Mike
> 
> 
>>-----Original Message-----
>>From: Michael S. Fischer [mailto:michael@dynamine.net] 
>>Sent: Tuesday, December 02, 2003 2:41 PM
>>To: Michael C. Neel
>>Cc: Gustavo C?rdova Avila; mod_python@modpython.org
>>Subject: Re: [mod_python] Getting mod_python version
>>
>>
>>Regardless of whether or not __version__ is implemented, 
>>using exception 
>>handling is more robust in the long run, I think.
>>
>>Forgetting to change the interface version number when a 
>>compatibility 
>>detail has changed is not an unknown phenomenon -- if not with 
>>mod_python, then certainly with other SDKs.
>>
>>--Michael
>>
>>Michael C. Neel wrote:
>>
>>
>>>Most modules have a __version__ member, and the help() 
>>
>>built-in method
>>
>>>even looks for this variable and uses it to display the 
>>
>>version of the
>>
>>>file:
>>>
>>>
>>>
>>>>>>import cgi
>>>>>>cgi.__version__
>>>
>>>'2.6'
>>>
>>>
>>>>>>help(cgi)
>>>
>>>...skipping...
>>>DATA
>>>    __all__ = ['MiniFieldStorage', 'FieldStorage', 
>>
>>'FormContentDict',
>>
>>>'SvF...
>>>    __version__ = '2.6'
>>>    logfile = ''
>>>    logfp = None
>>>    maxlen = 0
>>>
>>>VERSION
>>>    2.6
>>>
>>>
>>>
>>>I have not read or seen anything saying the "pythonic" way 
>>
>>of versioning
>>
>>>a module is by try/except blocks testing to see if variable 
>>
>>exist.  I
>>
>>>have however seen this from PEP 8:
>>>
>>>Version Bookkeeping
>>>
>>>    If you have to have RCS or CVS crud in your source 
>>
>>file, do it as
>>
>>>    follows.
>>>
>>>        __version__ = "$Revision: 1.20 $"
>>>        # $Source: 
>>
>>/cvsroot/python/python/nondist/peps/pep-0008.txt,v $
>>
>>>    These lines should be included after the module's docstring,
>>>    before any other code, separated by a blank line above and
>>>    below.
>>>
>>>Which implies to me that __version__ is a pythonic way of 
>>
>>versioning a
>>
>>>module/code file, though it doesn't seem to be as standard 
>>
>>as __doc__.
>>
>>>Mike
>>>
>>>
>>>
>>>>-----Original Message-----
>>>>From: Gustavo C?rdova Avila [mailto:gustavo.cordova@q-voz.com] 
>>>>Sent: Tuesday, December 02, 2003 1:47 PM
>>>>To: Michael C. Neel
>>>>Cc: mod_python@modpython.org
>>>>Subject: Re: [mod_python] Getting mod_python version
>>>>
>>>>
>>>>This is the correct, "pythonic" way of doing things.
>>>>
>>>>I'd recommend using "except AttributeError:" instead of a naked 
>>>>"except:" btw.
>>>>
>>>>-gustavo
>>>>
>>>>Michael C. Neel wrote:
>>>>
>>>>
>>>>
>>>>>Hi all,
>>>>>
>>>>>	I don't know if it's not there, or I'm just overlooking it, but
>>>>>I can seem for a way in code to get the version of 
>>>>
>>>>mod_python.  I have
>>>>
>>>>
>>>>>some "default" modules I use, and I am trying to make them 
>>>>
>>>>work with any
>>>>
>>>>
>>>>>mod_python version.  Right now I'm doing try block, like such:
>>>>>
>>>>>  # Get username/password from client
>>>>>  pw = req.get_basic_auth_pw()
>>>>>  try:
>>>>>      # mod_python 2.x
>>>>>      user = req.connection.user
>>>>>  except:
>>>>>      # mod_python 3.x
>>>>>      user = req.user
>>>>>
>>>>>	...but I'd rather be able to get the version directly.
>>>>>
>>>>>Mike
>>>>>
>>>>>_______________________________________________
>>>>>Mod_python mailing list
>>>>>Mod_python@modpython.org
>>>>>http://mailman.modpython.org/mailman/listinfo/mod_python
>>>>>
>>>>>
>>>>>
>>>>>
>>>>
>>>>
>>>_______________________________________________
>>>Mod_python mailing list
>>>Mod_python@modpython.org
>>>http://mailman.modpython.org/mailman/listinfo/mod_python
>>>
>>
>>
> 

From neel at mediapulse.com  Tue Dec  2 15:06:29 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:00:35 2004
Subject: [mod_python] Getting mod_python version
Message-ID: <C0FC22C08B82074A88B50061764157776B9865@johnson.mediapulse.net>

> (Python also makes you use 'elif's instead of 'case' statements, and 
> there's something to be said about the ugliness of the former 
> as well. 
> Eye of the beholder, I guess.)

I agree about the case issue as well, but let us never speak of it
again, lest the python police decend upon our homes in the night...

Mike

From neel at mediapulse.com  Tue Dec  2 15:17:18 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:00:35 2004
Subject: [mod_python] does mod_python is ready for production env. ?
Message-ID: <C0FC22C08B82074A88B500617641577787A7D5@johnson.mediapulse.net>

Yes, mod_python is extreamly viable in a production enviroment.  Draco I
cannot answer for, I tend to use Albatross.

We have used mod_python for several large sites without issue, the
problems have always been our own doing =)

In my personal tests, I found mod_python right behind mod_perl in terms
of speed and ahead of php.  My tests revolved around how I wanted to use
mod_python (big app using a mysql backend on linux), so if you are
worried about speed I recommend you conduct your own benchmarks with the
way you will be using mod_python.  At the time I was new to python, so
I'm sure there were ways to speed up the mod_python test site.

It's worth note that a C module will blow the doors off of a
perl/php/python site.  So if speed is really an issue, C is the way to
go.  If it's not that bad, then in terms of preformance perl/php/python
are all close enough to make it a non-issue.

I hate php as well ;)

Mike

> -----Original Message-----
> From: vincent delft [mailto:vincent_delft@yahoo.com] 
> Sent: Tuesday, December 02, 2003 2:54 PM
> To: mod_python@modpython.org
> Subject: [mod_python] does mod_python is ready for production env. ?
> 
> 
> Sorry to ask this (may be stupid), but I plan to use
> mod_python and Draco (see in links of the mod_python
> site) on a production environment (a web service that
> our enterprise will provide via http servers)
> 
> 
> Is there any experience of mod_python on a production
> env. ?
> 
> What about stability, fiability on a heavy loaded web
> site ?
> 
> Is there "show stoppers" to use mod_python on a
> production env. ?
> 
> Thanks 
> 
> 
> PS : I'm pythoniac since years, and I definitively
> hate php (just a personnal point of view).
> 
> 
> 
> 
> __________________________________
> Do you Yahoo!?
> Free Pop-Up Blocker - Get it now
> http://companion.yahoo.com/
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

From michael at dynamine.net  Tue Dec  2 12:40:24 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 22:00:35 2004
Subject: [mod_python] does mod_python is ready for production env. ?
In-Reply-To: <C0FC22C08B82074A88B500617641577787A7D5@johnson.mediapulse.net>
References: <C0FC22C08B82074A88B500617641577787A7D5@johnson.mediapulse.net>
Message-ID: <3FCCF8B8.90801@dynamine.net>

Michael C. Neel wrote:

> In my personal tests, I found mod_python right behind mod_perl in terms
> of speed and ahead of php.

Did you try the Zend Accelerator module for PHP?  When used, it makes 
PHP an order of magnitude faster.  I'm not kidding.  Simply blows 
mod_perl/mod_python away.

Of course, the upshot is that you'd have to program in PHP to use it :-)

Grisha, it might be an interesting future addition to mod_python to 
cache compiled Python code and access the compiled code via shared 
memory like the Zend Accelerator does -- if that's even possible with 
the Python architecture.

--Michael

From neel at mediapulse.com  Tue Dec  2 15:54:52 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:00:36 2004
Subject: [mod_python] does mod_python is ready for production env. ?
Message-ID: <C0FC22C08B82074A88B500617641577787A7D6@johnson.mediapulse.net>

> Did you try the Zend Accelerator module for PHP?  

No, Zend Accelerator requires fees and licensing, so it kinda ruled
itself out of the running.

> Of course, the upshot is that you'd have to program in PHP to 
> use it :-)

downside?

> 
> Grisha, it might be an interesting future addition to mod_python to 
> cache compiled Python code and access the compiled code via shared 
> memory like the Zend Accelerator does -- if that's even possible with 
> the Python architecture.
> 

Mod_python does this already, just make sure you have PythonDebug Off
(or not set) in your conf.

Mike

From dwmp at opti.cgi.net  Tue Dec  2 15:04:54 2003
From: dwmp at opti.cgi.net (Dan W.)
Date: Fri Jan  9 22:00:36 2004
Subject: [mod_python] does mod_python is ready for production env. ?
In-Reply-To: <C0FC22C08B82074A88B500617641577787A7D6@johnson.mediapulse.
 net>
Message-ID: <5.2.1.1.2.20031202150248.04685f88@mail.pyxos.com>


At 03:54 PM 12/2/2003 -0500, you wrote:
>Mod_python does this already, just make sure you have PythonDebug Off
>(or not set) in your conf.

How does PythonDebug change the execution time?  According to the 
documentation it just writes tracebacks to the output and the log at the 
same time vs. just the log.  Assuming you have no tracebacks in a 
production environment, why does this impact execution speed?

-Dan

From gustavo.cordova at q-voz.com  Tue Dec  2 15:28:00 2003
From: gustavo.cordova at q-voz.com (=?ISO-8859-1?Q?Gustavo_C=F3rdova_Avila?=)
Date: Fri Jan  9 22:00:36 2004
Subject: [mod_python] does mod_python is ready for production env. ?
In-Reply-To: <3FCCF8B8.90801@dynamine.net>
References: <C0FC22C08B82074A88B500617641577787A7D5@johnson.mediapulse.net>
	<3FCCF8B8.90801@dynamine.net>
Message-ID: <3FCD03E0.4010006@q-voz.com>

Michael S. Fischer wrote:

> Michael C. Neel wrote:
>
>> In my personal tests, I found mod_python right behind mod_perl in terms
>> of speed and ahead of php.
>
> Did you try the Zend Accelerator module for PHP?  When used, it makes 
> PHP an order of magnitude faster.  I'm not kidding.  Simply blows 
> mod_perl/mod_python away.
>
> Of course, the upshot is that you'd have to program in PHP to use it :-)
>
> Grisha, it might be an interesting future addition to mod_python to 
> cache compiled Python code and access the compiled code via shared 
> memory like the Zend Accelerator does -- if that's even possible with 
> the Python architecture.
>
> --Michael

You can do something even better from Python, just:

    import psyco
    psyco.profile()

and it'll automatically do some background profiling, and generate 
specialized machine code for any functions worth compiling.  Another 
common invocation is:

    import psyco
    psyco.bind(func1)
    psyco.bind(func2)
    ...

This is when you know which functions are worth compiling, so you 
generate specialized versions immediately, upon module startup.

Psyco's a really nice gem, you can check it out at:

    http://psyco.sourceforge.net/

-gustavo


From neel at mediapulse.com  Tue Dec  2 16:46:45 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:00:36 2004
Subject: [mod_python] does mod_python is ready for production env. ?
Message-ID: <C0FC22C08B82074A88B500617641577787A7D8@johnson.mediapulse.net>

> How does PythonDebug change the execution time?  According to the 
> documentation it just writes tracebacks to the output and the 
> log at the 
> same time vs. just the log.  Assuming you have no tracebacks in a 
> production environment, why does this impact execution speed?
> 

My bad, I looked at the wrong version of a conf file; you want
PythonAutoReload Off and PythonOptimize On.  You don't have to have
these to get modulke cacheing, that's always on, but these speed things
up some.

Mike

From grisha at modpython.org  Tue Dec  2 17:36:03 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:00:36 2004
Subject: [mod_python] does mod_python is ready for production env. ?
In-Reply-To: <3FCCF8B8.90801@dynamine.net>
References: <C0FC22C08B82074A88B500617641577787A7D5@johnson.mediapulse.net>
 <3FCCF8B8.90801@dynamine.net>
Message-ID: <20031202173437.L61463@onyx.ispol.com>


On Tue, 2 Dec 2003, Michael S. Fischer wrote:

> Michael C. Neel wrote:
>
> > In my personal tests, I found mod_python right behind mod_perl in terms
> > of speed and ahead of php.
>
> Did you try the Zend Accelerator module for PHP?

> Simply blows mod_perl/mod_python away.

I doubt it. :-)

Grisha
From vmanera at manord.com  Tue Dec  2 08:54:51 2003
From: vmanera at manord.com (Manera, Villiam)
Date: Fri Jan  9 22:00:36 2004
Subject: R: R: [mod_python]  Problem with Session module with multiple scr
	ipt alias not under t he  document root
Message-ID: <52DC70C1C1575C418CB033523A29CF1410490B@exchange2000.manord.com>

I've already noted the '/' and I tried both with PythonOption
ApplicationPath /script/cgi/cgi-mpy and directly  c.path =
'/script/cgi/cgi-mpy'
But without success.
Only work with path=''.


do you work on windows? I suppose that in windows Session doesn't work
without removing this problem. Any people has a configuration working in
win2000?

Villiam
-----Messaggio originale-----
Da: mod_python-bounces@modpython.org
[mailto:mod_python-bounces@modpython.org]Per conto di Neil Beattie
Inviato: sabato 29 novembre 2003 15.54
A: mod_python@modpython.org
Cc: Manera, Villiam
Oggetto: Re: R: [mod_python] Problem with Session module with multiple
script alias not under t he document root


> I'm sorry but still don't work.
> I'm removed all references to cgi and I moved all my directory with .py
> under document root:
> 
> DocumentRoot "C:/wwwroot/cartelle_sito_mdn"
> <Directory   "C:/wwwroot/cartelle_sito_mdn/script/cgi/cgi-py">
> 
> and with this new configuration req.headers_out:
> {'Set-Cookie': 'pysid=d4d10ab8e7917b43becbff01a2452f7e;
> path=/script/cgi/cgi-mpy/\', 'Cache-Control': 'no-cache="set-cookie"'} 
> and if I relod the page it never passed to req.headers_in


Looks like the path is not correct (extra \)
try adding the following line to your httpd.config  addHandler entry:

PythonOption ApplicationPath /script/cgi/cgi-mpy


I have just had the same problem but have not yet discovered where the extra
\ 
comes from ( it is in _req.hlist.directory in session.py)




> 
> if I modify se session module:
> def make_cookie(self):
> 	....
>       c.path = ''   #dirpath[len(docroot):]
> then req.headers_out become:
> {'Set-Cookie': 'pysid=fb35b851ad27e7effe820c36871bc9b4; path=',
> 'Cache-Control': 'no-cache="set-cookie"'} 
> and If I relod the page it go to req.headers_in:
> {'Cookie': 'pysid=fb35b851ad27e7effe820c36871bc9b4', 'Connection':
> 'Keep-Alive', ...} 
> and req.heades_out : {}
> 
> so why if something else then '' is in path the pysid wasn't writing into
> the html heading? 
> 

Neil Beattie
NB Technology (Pty) Ltd

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python
From cs1spw at bath.ac.uk  Tue Dec  2 17:10:03 2003
From: cs1spw at bath.ac.uk (Simon Willison)
Date: Fri Jan  9 22:00:36 2004
Subject: [mod_python] does mod_python is ready for production env. ?
In-Reply-To: <20031202195401.44707.qmail@web11505.mail.yahoo.com>
References: <20031202195401.44707.qmail@web11505.mail.yahoo.com>
Message-ID: <3FCD1BCB.6020801@bath.ac.uk>

vincent delft wrote:
> PS : I'm pythoniac since years, and I definitively
> hate php (just a personnal point of view).

Reg:	Listen. If you really wanted to use mod_python, you'd have to 
really hate PHP.
Brian:  I do.
Reg:    Oh yeah? How much?
Brian:  A lot!
Reg:    Right. You're in.

(Sorry, couldn't resist it)

From michael at dynamine.net  Tue Dec  2 15:50:15 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 22:00:36 2004
Subject: [mod_python] does mod_python is ready for production env. ?
In-Reply-To: <3FCD03E0.4010006@q-voz.com>
References: <C0FC22C08B82074A88B500617641577787A7D5@johnson.mediapulse.net>
	<3FCCF8B8.90801@dynamine.net> <3FCD03E0.4010006@q-voz.com>
Message-ID: <3FCD2537.2010604@dynamine.net>

Gustavo C?rdova Avila wrote:
> Michael S. Fischer wrote:
>> Grisha, it might be an interesting future addition to mod_python to 
>> cache compiled Python code and access the compiled code via shared 
>> memory like the Zend Accelerator does -- if that's even possible with 
>> the Python architecture.

> You can do something even better from Python, just:
> 
>    import psyco
>    psyco.profile()

Apparently psyco is limited to the i386 platform at this time. 
Unfortunately I'm running on a PowerPC platform (Apple XServe) at my 
present assignment.  :(

--Michael

From davidf at sjsoft.com  Wed Dec  3 07:55:06 2003
From: davidf at sjsoft.com (David Fraser)
Date: Fri Jan  9 22:00:36 2004
Subject: [mod_python] does mod_python is ready for production env. ?
In-Reply-To: <3FCD2537.2010604@dynamine.net>
References: <C0FC22C08B82074A88B500617641577787A7D5@johnson.mediapulse.net>
	<3FCCF8B8.90801@dynamine.net> <3FCD03E0.4010006@q-voz.com>
	<3FCD2537.2010604@dynamine.net>
Message-ID: <3FCD7ABA.3070502@sjsoft.com>

Michael S. Fischer wrote:

> Gustavo C?rdova Avila wrote:
>
>> Michael S. Fischer wrote:
>>
>>> Grisha, it might be an interesting future addition to mod_python to 
>>> cache compiled Python code and access the compiled code via shared 
>>> memory like the Zend Accelerator does -- if that's even possible 
>>> with the Python architecture.
>>
>
>> You can do something even better from Python, just:
>>
>>    import psyco
>>    psyco.profile()
>
>
> Apparently psyco is limited to the i386 platform at this time. 
> Unfortunately I'm running on a PowerPC platform (Apple XServe) at my 
> present assignment.  :(

Armin is working on a platform-independent version, not sure of the 
status, but I think it was working. You could ask on the psyco mailing 
list, he's very helpful, and I'm sure would be grateful for someone 
testing it. Psyco is incredible

David

From jciccale at mac.com  Wed Dec  3 09:40:32 2003
From: jciccale at mac.com (Julian Ciccale)
Date: Fri Jan  9 22:00:36 2004
Subject: [mod_python] does mod_python is ready for production env. ?
Message-ID: <15142387.1070440832400.JavaMail.jciccale@mac.com>

Have you tried pywork ? 
http://pywork.sf.net  (old name was pythonwork)

It's a new web framework we are developing, and it rocks.

We have benchmarked agains other MVC/Template pairs
and it really rocks! It supports XSLT transforms (done in C),
ZPT templates and even lets you write your own View System.

- julcicc -

On Tuesday, December 02, 2003, at 08:54PM, vincent delft <vincent_delft@yahoo.com> wrote:

>Sorry to ask this (may be stupid), but I plan to use
>mod_python and Draco (see in links of the mod_python
>site) on a production environment (a web service that
>our enterprise will provide via http servers)
>
>
>Is there any experience of mod_python on a production
>env. ?
>
>What about stability, fiability on a heavy loaded web
>site ?
>
>Is there "show stoppers" to use mod_python on a
>production env. ?
>
>Thanks 
>
>
>PS : I'm pythoniac since years, and I definitively
>hate php (just a personnal point of view).
>
>
>
>
>__________________________________
>Do you Yahoo!?
>Free Pop-Up Blocker - Get it now
>http://companion.yahoo.com/
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
From vmanera at manord.com  Wed Dec  3 11:49:05 2003
From: vmanera at manord.com (Manera, Villiam)
Date: Fri Jan  9 22:00:36 2004
Subject: R: R: [mod_python]  Problem with Session module with multiple scr
	ipt alias not under t he  document root
Message-ID: <52DC70C1C1575C418CB033523A29CF1497D5C3@exchange2000.manord.com>

I found the way:
with: PythonOption ApplicationPath ' '
in every directory with python module all work fine.

If this is the rigth way it would be better to add in session manual.

Villiam

sorry, the latest test that I made was wrong,
effectively with:
PythonOption ApplicationPath /script/cgi/cgi-mpy 
the script below cgi-mpy working weel, but the script below other directory
doesn't work:
 DocumentRoot "C:/wwwroot/cartelle_sito_mdn"
<Directory   "C:/wwwroot/cartelle_sito_mdn/script/cgi/cgi-py">
	.....
	PythonOption ApplicationPath /script/cgi/cgi-mpy 

<Directory   "C:/wwwroot/cartelle_sito_mdn/script/cgi/studi">
	.....
	PythonOption ApplicationPath /script/cgi/studi 

If I first call an url below studi I'm able to work with all the module
below studi, but any attempt to go in cgi-mpy cause a new
sorry, the latest test that I made was wrong, effectively with 
PythonOption ApplicationPath /script/cgi/cgi-mpy 
the script below cgi-mpy working weel, but the script below other directory
doesn't work:


If I first call an url below studi I'm able to work with all the module
below studi, but any attempt to go in cgi-mpy cause a new Session id

vice versa if I first call a url below cgi-mpy ....

instead with path = '' all work fine, but I don't discovery the way to do it
with 
PythonOption ApplicationPath 
Villiam
-----Messaggio originale-----
Da: mod_python-bounces@modpython.org
[mailto:mod_python-bounces@modpython.org]Per conto di Neil Beattie
Inviato: sabato 29 novembre 2003 15.54
A: mod_python@modpython.org
Cc: Manera, Villiam
Oggetto: Re: R: [mod_python] Problem with Session module with multiple
script alias not under t he document root


> I'm sorry but still don't work.
> I'm removed all references to cgi and I moved all my directory with .py
> under document root:
> 
> DocumentRoot "C:/wwwroot/cartelle_sito_mdn"
> <Directory   "C:/wwwroot/cartelle_sito_mdn/script/cgi/cgi-py">
> 
> and with this new configuration req.headers_out:
> {'Set-Cookie': 'pysid=d4d10ab8e7917b43becbff01a2452f7e;
> path=/script/cgi/cgi-mpy/\', 'Cache-Control': 'no-cache="set-cookie"'} 
> and if I relod the page it never passed to req.headers_in


Looks like the path is not correct (extra \)
try adding the following line to your httpd.config  addHandler entry:

PythonOption ApplicationPath /script/cgi/cgi-mpy


I have just had the same problem but have not yet discovered where the extra
\ 
comes from ( it is in _req.hlist.directory in session.py)




> 
> if I modify se session module:
> def make_cookie(self):
> 	....
>       c.path = ''   #dirpath[len(docroot):]
> then req.headers_out become:
> {'Set-Cookie': 'pysid=fb35b851ad27e7effe820c36871bc9b4; path=',
> 'Cache-Control': 'no-cache="set-cookie"'} 
> and If I relod the page it go to req.headers_in:
> {'Cookie': 'pysid=fb35b851ad27e7effe820c36871bc9b4', 'Connection':
> 'Keep-Alive', ...} 
> and req.heades_out : {}
> 
> so why if something else then '' is in path the pysid wasn't writing into
> the html heading? 
> 

Neil Beattie
NB Technology (Pty) Ltd

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python
From vincent_delft at yahoo.com  Wed Dec  3 12:14:35 2003
From: vincent_delft at yahoo.com (vincent delft)
Date: Fri Jan  9 22:00:36 2004
Subject: [mod_python] does mod_python is ready for production env. ?
In-Reply-To: <15142387.1070440832400.JavaMail.jciccale@mac.com>
Message-ID: <20031203201435.57970.qmail@web11502.mail.yahoo.com>

Thanks to all your feedbacks. 

This prouve me that mod_python is reliable enough for
real production env.

Vincent






--- Julian Ciccale <jciccale@mac.com> wrote:
> Have you tried pywork ? 
> http://pywork.sf.net  (old name was pythonwork)
> 
> It's a new web framework we are developing, and it
> rocks.
> 
> We have benchmarked agains other MVC/Template pairs
> and it really rocks! It supports XSLT transforms
> (done in C),
> ZPT templates and even lets you write your own View
> System.
> 
> - julcicc -
> 
> On Tuesday, December 02, 2003, at 08:54PM, vincent
> delft <vincent_delft@yahoo.com> wrote:
> 
> >Sorry to ask this (may be stupid), but I plan to
> use
> >mod_python and Draco (see in links of the
> mod_python
> >site) on a production environment (a web service
> that
> >our enterprise will provide via http servers)
> >
> >
> >Is there any experience of mod_python on a
> production
> >env. ?
> >
> >What about stability, fiability on a heavy loaded
> web
> >site ?
> >
> >Is there "show stoppers" to use mod_python on a
> >production env. ?
> >
> >Thanks 
> >
> >
> >PS : I'm pythoniac since years, and I definitively
> >hate php (just a personnal point of view).
> >
> >
> >
> >
> >__________________________________
> >Do you Yahoo!?
> >Free Pop-Up Blocker - Get it now
> >http://companion.yahoo.com/
> >_______________________________________________
> >Mod_python mailing list
> >Mod_python@modpython.org
>
>http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> >

__________________________________
Do you Yahoo!?
Free Pop-Up Blocker - Get it now
http://companion.yahoo.com/
From dwmp at opti.cgi.net  Wed Dec  3 17:54:28 2003
From: dwmp at opti.cgi.net (Dan W.)
Date: Fri Jan  9 22:00:36 2004
Subject: [mod_python] 3.1.2b & worker MPM
Message-ID: <5.2.1.1.2.20031203174401.03b996c0@mail.pyxos.com>


I'm running into a weird problem with 3.1.2b and Apache 2.0.47 compiled 
under the worker MPM.  I have two Apache processes, each with 25 
threads.  I have a very simple PSP page which imports a simple .py module 
and prints out a value.  The problem is that the page is only served part 
of the time.  When it is served, it is correct (no tracebacks), but if I do 
a browser reload a couple times it will eventually serve a blank page.  I 
can immediately do a browser reload a few more times and get a few more 
blank pages.  Then if I wait a few seconds and do a browser reload again 
then it will serve up the proper page.

I'm not quite sure how to verify it, but it appears as though one process 
is having a problem with mod_python while the other process is functioning 
properly.  Any suggestions on how I could verify this or other ideas?

I wasn't able to find anything in the documentation on MPM compatibility.

Thanks!

-Dan

From dwmp at opti.cgi.net  Wed Dec  3 21:14:19 2003
From: dwmp at opti.cgi.net (Dan W.)
Date: Fri Jan  9 22:00:36 2004
Subject: [mod_python] PSP bug report
In-Reply-To: <5.2.1.1.2.20031203174401.03b996c0@mail.pyxos.com>
Message-ID: <5.2.1.1.2.20031203210332.02bf6de0@mail.pyxos.com>


It turns out that my problem wasn't related to the worker MPM after 
all.  After minimizing the code down I've found that PSP fails on zero 
element for loops.  The following PSP page should reproduce the problem.

<%
for x in range(0):
     pass
%>
<html>
<body>
Hello world
</body>
</html>


Does the PSP maintainer read this list?

-Dan



At 05:54 PM 12/3/2003 -0600, you wrote:

>I'm running into a weird problem with 3.1.2b and Apache 2.0.47 compiled 
>under the worker MPM.  I have two Apache processes, each with 25 
>threads.  I have a very simple PSP page which imports a simple .py module 
>and prints out a value.  The problem is that the page is only served part 
>of the time.  When it is served, it is correct (no tracebacks), but if I 
>do a browser reload a couple times it will eventually serve a blank 
>page.  I can immediately do a browser reload a few more times and get a 
>few more blank pages.  Then if I wait a few seconds and do a browser 
>reload again then it will serve up the proper page.
>
>I'm not quite sure how to verify it, but it appears as though one process 
>is having a problem with mod_python while the other process is functioning 
>properly.  Any suggestions on how I could verify this or other ideas?
>
>I wasn't able to find anything in the documentation on MPM compatibility.
>
>Thanks!
>
>-Dan
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python

From dwmp at opti.cgi.net  Wed Dec  3 22:15:43 2003
From: dwmp at opti.cgi.net (Dan W.)
Date: Fri Jan  9 22:00:36 2004
Subject: [mod_python] PSP bug report
In-Reply-To: <5.2.1.1.2.20031203210332.02bf6de0@mail.pyxos.com>
References: <5.2.1.1.2.20031203174401.03b996c0@mail.pyxos.com>
Message-ID: <5.2.1.1.2.20031203221244.02b28a20@mail.pyxos.com>


I realized my error too late.  I needed a blank line after the loop.  PSP 
was considering the rest of the page to be part of the loop and since the 
loop did not execute neither did the html.

-Dan



At 09:14 PM 12/3/2003 -0600, you wrote:

>It turns out that my problem wasn't related to the worker MPM after 
>all.  After minimizing the code down I've found that PSP fails on zero 
>element for loops.  The following PSP page should reproduce the problem.
>
><%
>for x in range(0):
>     pass
>%>
>Hello world
>
>Does the PSP maintainer read this list?
>
>-Dan
>
>
>
>At 05:54 PM 12/3/2003 -0600, you wrote:
>
> >I'm running into a weird problem with 3.1.2b and Apache 2.0.47 compiled
> >under the worker MPM.  I have two Apache processes, each with 25
> >threads.  I have a very simple PSP page which imports a simple .py module
> >and prints out a value.  The problem is that the page is only served part
> >of the time.  When it is served, it is correct (no tracebacks), but if I
> >do a browser reload a couple times it will eventually serve a blank
> >page.  I can immediately do a browser reload a few more times and get a
> >few more blank pages.  Then if I wait a few seconds and do a browser
> >reload again then it will serve up the proper page.
> >
> >I'm not quite sure how to verify it, but it appears as though one process
> >is having a problem with mod_python while the other process is functioning
> >properly.  Any suggestions on how I could verify this or other ideas?
> >
> >I wasn't able to find anything in the documentation on MPM compatibility.
> >
> >Thanks!
> >
> >-Dan
> >
> >_______________________________________________
> >Mod_python mailing list
> >Mod_python@modpython.org
> >http://mailman.modpython.org/mailman/listinfo/mod_python
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python

From grisha at modpython.org  Thu Dec  4 01:00:44 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:00:36 2004
Subject: [mod_python] PSP bug report
In-Reply-To: <5.2.1.1.2.20031203221244.02b28a20@mail.pyxos.com>
References: <5.2.1.1.2.20031203174401.03b996c0@mail.pyxos.com>
 <5.2.1.1.2.20031203221244.02b28a20@mail.pyxos.com>
Message-ID: <20031204005846.Y83403@onyx.ispol.com>


I think the best practice is to use a comment rather than a blank line:

<%
for x in range(0):
	pass
# end for
%>

Grisha

On Wed, 3 Dec 2003, Dan W. wrote:

>
> I realized my error too late.  I needed a blank line after the loop.  PSP
> was considering the rest of the page to be part of the loop and since the
> loop did not execute neither did the html.
>
> -Dan
>
>
>
> At 09:14 PM 12/3/2003 -0600, you wrote:
>
> >It turns out that my problem wasn't related to the worker MPM after
> >all.  After minimizing the code down I've found that PSP fails on zero
> >element for loops.  The following PSP page should reproduce the problem.
> >
> ><%
> >for x in range(0):
> >     pass
> >%>
> >Hello world
> >
> >Does the PSP maintainer read this list?
> >
> >-Dan
> >
> >
> >
> >At 05:54 PM 12/3/2003 -0600, you wrote:
> >
> > >I'm running into a weird problem with 3.1.2b and Apache 2.0.47 compiled
> > >under the worker MPM.  I have two Apache processes, each with 25
> > >threads.  I have a very simple PSP page which imports a simple .py module
> > >and prints out a value.  The problem is that the page is only served part
> > >of the time.  When it is served, it is correct (no tracebacks), but if I
> > >do a browser reload a couple times it will eventually serve a blank
> > >page.  I can immediately do a browser reload a few more times and get a
> > >few more blank pages.  Then if I wait a few seconds and do a browser
> > >reload again then it will serve up the proper page.
> > >
> > >I'm not quite sure how to verify it, but it appears as though one process
> > >is having a problem with mod_python while the other process is functioning
> > >properly.  Any suggestions on how I could verify this or other ideas?
> > >
> > >I wasn't able to find anything in the documentation on MPM compatibility.
> > >
> > >Thanks!
> > >
> > >-Dan
> > >
> > >_______________________________________________
> > >Mod_python mailing list
> > >Mod_python@modpython.org
> > >http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> >_______________________________________________
> >Mod_python mailing list
> >Mod_python@modpython.org
> >http://mailman.modpython.org/mailman/listinfo/mod_python
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From Vincent.Raaijmakers at ge.com  Thu Dec  4 07:48:52 2003
From: Vincent.Raaijmakers at ge.com (Raaijmakers, Vincent (IndSys, GE Interlogix))
Date: Fri Jan  9 22:00:36 2004
Subject: [mod_python] Handlers "good practice" question 
Message-ID: <971323274247EB44B9A01D0A3B424C8503F13BDF@FTWMLVEM02.e2k.ad.ge.com>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/gif
Size: 145 bytes
Desc: Blank Bkgrd.gif
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20031204/29f70021/attachment-0002.gif
From vmanera at manord.com  Wed Dec  3 11:28:08 2003
From: vmanera at manord.com (Manera, Villiam)
Date: Fri Jan  9 22:00:36 2004
Subject: R: R: [mod_python]  Problem with Session module with multiple scr
	ipt alias not under t he  document root
Message-ID: <52DC70C1C1575C418CB033523A29CF1410490E@exchange2000.manord.com>

sorry, the latest test that I made was wrong,
effectively with:
PythonOption ApplicationPath /script/cgi/cgi-mpy 
the script below cgi-mpy working weel, but the script below other directory
doesn't work:
 DocumentRoot "C:/wwwroot/cartelle_sito_mdn"
<Directory   "C:/wwwroot/cartelle_sito_mdn/script/cgi/cgi-py">
	.....
	PythonOption ApplicationPath /script/cgi/cgi-mpy 

<Directory   "C:/wwwroot/cartelle_sito_mdn/script/cgi/studi">
	.....
	PythonOption ApplicationPath /script/cgi/studi 

If I first call an url below studi I'm able to work with all the module
below studi, but any attempt to go in cgi-mpy cause a new
sorry, the latest test that I made was wrong, effectively with 
PythonOption ApplicationPath /script/cgi/cgi-mpy 
the script below cgi-mpy working weel, but the script below other directory
doesn't work:


If I first call an url below studi I'm able to work with all the module
below studi, but any attempt to go in cgi-mpy cause a new Session id

vice versa if I first call a url below cgi-mpy ....

instead with path = '' all work fine, but I don't discovery the way to do it
with 
PythonOption ApplicationPath 
Villiam
-----Messaggio originale-----
Da: mod_python-bounces@modpython.org
[mailto:mod_python-bounces@modpython.org]Per conto di Neil Beattie
Inviato: sabato 29 novembre 2003 15.54
A: mod_python@modpython.org
Cc: Manera, Villiam
Oggetto: Re: R: [mod_python] Problem with Session module with multiple
script alias not under t he document root


> I'm sorry but still don't work.
> I'm removed all references to cgi and I moved all my directory with .py
> under document root:
> 
> DocumentRoot "C:/wwwroot/cartelle_sito_mdn"
> <Directory   "C:/wwwroot/cartelle_sito_mdn/script/cgi/cgi-py">
> 
> and with this new configuration req.headers_out:
> {'Set-Cookie': 'pysid=d4d10ab8e7917b43becbff01a2452f7e;
> path=/script/cgi/cgi-mpy/\', 'Cache-Control': 'no-cache="set-cookie"'} 
> and if I relod the page it never passed to req.headers_in


Looks like the path is not correct (extra \)
try adding the following line to your httpd.config  addHandler entry:

PythonOption ApplicationPath /script/cgi/cgi-mpy


I have just had the same problem but have not yet discovered where the extra
\ 
comes from ( it is in _req.hlist.directory in session.py)




> 
> if I modify se session module:
> def make_cookie(self):
> 	....
>       c.path = ''   #dirpath[len(docroot):]
> then req.headers_out become:
> {'Set-Cookie': 'pysid=fb35b851ad27e7effe820c36871bc9b4; path=',
> 'Cache-Control': 'no-cache="set-cookie"'} 
> and If I relod the page it go to req.headers_in:
> {'Cookie': 'pysid=fb35b851ad27e7effe820c36871bc9b4', 'Connection':
> 'Keep-Alive', ...} 
> and req.heades_out : {}
> 
> so why if something else then '' is in path the pysid wasn't writing into
> the html heading? 
> 

Neil Beattie
NB Technology (Pty) Ltd

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python
From neel at mediapulse.com  Thu Dec  4 10:52:09 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:00:36 2004
Subject: [mod_python] Handlers "good practice" question 
Message-ID: <C0FC22C08B82074A88B500617641577787A7DA@johnson.mediapulse.net>

Mod_python (docs) kinda assumes you are familiar with how apache works,
it really just exposing the C API in a python interface for the most
part.  To learn about the apache method of doing things, I'd recommend
reading "Writing Apache Modules in C and Perl" from O'rielly press
(title is something like that).  Language and details differ some, but
the general flow is the same.

Mike


-----Original Message-----
From: Raaijmakers, Vincent (IndSys, GE Interlogix)
[mailto:Vincent.Raaijmakers@ge.com] 
Sent: Thursday, December 04, 2003 8:49 AM
To: mod_python@modpython.org
Subject: [mod_python] Handlers "good practice" question 


I consider myself as a complete newbie with mod_python.  My goal is to
setup a good foundation for my web application using mod_python. Read
all the docs, mail history messages, tried every handler but... 
What I clearly miss is a guideline of a good default structure of the
different handlers. What is good practice? I guess when I try to learn
by trial and error, some structure will come up. I'm also sure that the
documentation I have in my hands will become more clear. It feels like
that mod_python has a lot of excellent soccer players but how to make a
team of it?
Please guru's, where can I find help?
Vincent

From anthony.barker at bmo.com  Thu Dec  4 12:07:49 2003
From: anthony.barker at bmo.com (anthony.barker@bmo.com)
Date: Fri Jan  9 22:00:36 2004
Subject: [mod_python] session management
Message-ID: <OF46341989.F03189B8-ON85256DF2.004D673F@notes.bmo.com>

Do the mod_python sessions work in windows 2000?

It would be nice if the session module was compatible with cgi, so it 
could be used in prototyping situations where the user doesn't have access 
to 
a mod_python enabled apache server....

Anthony
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20031204/9ee164f1/attachment-0002.htm
From conrad at hep.caltech.edu  Thu Dec  4 09:35:46 2003
From: conrad at hep.caltech.edu (Conrad Steenberg)
Date: Fri Jan  9 22:00:36 2004
Subject: [mod_python] PSP bug report
In-Reply-To: <20031204005846.Y83403@onyx.ispol.com>
References: <5.2.1.1.2.20031203174401.03b996c0@mail.pyxos.com>
	 <5.2.1.1.2.20031203221244.02b28a20@mail.pyxos.com>
	 <20031204005846.Y83403@onyx.ispol.com>
Message-ID: <1070559346.13675.37.camel@heppc22.hep.caltech.edu>

Hi Grisha

This may not be a bug, but it could still be worth the effort to make an
%> be considered a newline as well - purely from a support perspective
and the amount of annoyance it might save you and countless new users of
PSP :-)

Cheers

Conrad

On Wed, 2003-12-03 at 22:00, Gregory (Grisha) Trubetskoy wrote:
> I think the best practice is to use a comment rather than a blank line:
> 
> <%
> for x in range(0):
> 	pass
> # end for
> %>
> 
> Grisha
> 
> On Wed, 3 Dec 2003, Dan W. wrote:
> 
> >
> > I realized my error too late.  I needed a blank line after the loop.  PSP
> > was considering the rest of the page to be part of the loop and since the
> > loop did not execute neither did the html.
> >
> > -Dan
> >
> >
> >
> > At 09:14 PM 12/3/2003 -0600, you wrote:
> >
> > >It turns out that my problem wasn't related to the worker MPM after
> > >all.  After minimizing the code down I've found that PSP fails on zero
> > >element for loops.  The following PSP page should reproduce the problem.
> > >
> > ><%
> > >for x in range(0):
> > >     pass
> > >%>
> > >Hello world
> > >
> > >Does the PSP maintainer read this list?
> > >
> > >-Dan
> > >
> > >
> > >
> > >At 05:54 PM 12/3/2003 -0600, you wrote:
> > >
> > > >I'm running into a weird problem with 3.1.2b and Apache 2.0.47 compiled
> > > >under the worker MPM.  I have two Apache processes, each with 25
> > > >threads.  I have a very simple PSP page which imports a simple .py module
> > > >and prints out a value.  The problem is that the page is only served part
> > > >of the time.  When it is served, it is correct (no tracebacks), but if I
> > > >do a browser reload a couple times it will eventually serve a blank
> > > >page.  I can immediately do a browser reload a few more times and get a
> > > >few more blank pages.  Then if I wait a few seconds and do a browser
> > > >reload again then it will serve up the proper page.
> > > >
> > > >I'm not quite sure how to verify it, but it appears as though one process
> > > >is having a problem with mod_python while the other process is functioning
> > > >properly.  Any suggestions on how I could verify this or other ideas?
> > > >
> > > >I wasn't able to find anything in the documentation on MPM compatibility.
> > > >
> > > >Thanks!
> > > >
> > > >-Dan
> > > >
> > > >_______________________________________________
> > > >Mod_python mailing list
> > > >Mod_python@modpython.org
> > > >http://mailman.modpython.org/mailman/listinfo/mod_python
> > >
> > >_______________________________________________
> > >Mod_python mailing list
> > >Mod_python@modpython.org
> > >http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
-- 
Conrad Steenberg <conrad@hep.caltech.edu>

From michael at dynamine.net  Thu Dec  4 09:38:52 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 22:00:36 2004
Subject: [mod_python] session management
In-Reply-To: <OF46341989.F03189B8-ON85256DF2.004D673F@notes.bmo.com>
References: <OF46341989.F03189B8-ON85256DF2.004D673F@notes.bmo.com>
Message-ID: <3FCF712C.3000209@dynamine.net>

I'm confused.  Why would one want to prototype on a system that's not 
identical to the production system?

--Michael

anthony.barker@bmo.com wrote:

> 
> Do the mod_python sessions work in windows 2000?
> 
> It would be nice if the session module was compatible with cgi, so it 
> could be used in prototyping situations where the user doesn't have 
> access to
> a mod_python enabled apache server....
> 
> Anthony
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From dwmp at opti.cgi.net  Thu Dec  4 11:50:06 2003
From: dwmp at opti.cgi.net (Dan W.)
Date: Fri Jan  9 22:00:36 2004
Subject: [mod_python] PSP bug report
In-Reply-To: <1070559346.13675.37.camel@heppc22.hep.caltech.edu>
References: <20031204005846.Y83403@onyx.ispol.com>
 <5.2.1.1.2.20031203174401.03b996c0@mail.pyxos.com>
 <5.2.1.1.2.20031203221244.02b28a20@mail.pyxos.com>
 <20031204005846.Y83403@onyx.ispol.com>
Message-ID: <5.2.1.1.2.20031204114547.02af1930@mail.pyxos.com>


That would eliminate conditional html.  However, it might be interesting if 
PSP had a special directive for conditional html such as two percent signs.

<%%
for x in xrange(10):
%>

-Dan

At 09:35 AM 12/4/2003 -0800, you wrote:
>Hi Grisha
>
>This may not be a bug, but it could still be worth the effort to make an
>%> be considered a newline as well - purely from a support perspective
>and the amount of annoyance it might save you and countless new users of
>PSP :-)
>
>Cheers
>
>Conrad
>
>On Wed, 2003-12-03 at 22:00, Gregory (Grisha) Trubetskoy wrote:
> > I think the best practice is to use a comment rather than a blank line:
> >
> > <%
> > for x in range(0):
> >       pass
> > # end for
> > %>
> >
> > Grisha
> >
> > On Wed, 3 Dec 2003, Dan W. wrote:
> >
> > >
> > > I realized my error too late.  I needed a blank line after the loop.  PSP
> > > was considering the rest of the page to be part of the loop and since the
> > > loop did not execute neither did the html.
> > >
> > > -Dan
> > >
> > >
> > >
> > > At 09:14 PM 12/3/2003 -0600, you wrote:
> > >
> > > >It turns out that my problem wasn't related to the worker MPM after
> > > >all.  After minimizing the code down I've found that PSP fails on zero
> > > >element for loops.  The following PSP page should reproduce the problem.
> > > >
> > > ><%
> > > >for x in range(0):
> > > >     pass
> > > >%>
> > > >Hello world
> > > >
> > > >Does the PSP maintainer read this list?
> > > >
> > > >-Dan
> > > >
> > > >
> > > >
> > > >At 05:54 PM 12/3/2003 -0600, you wrote:
> > > >
> > > > >I'm running into a weird problem with 3.1.2b and Apache 2.0.47 
> compiled
> > > > >under the worker MPM.  I have two Apache processes, each with 25
> > > > >threads.  I have a very simple PSP page which imports a simple .py 
> module
> > > > >and prints out a value.  The problem is that the page is only 
> served part
> > > > >of the time.  When it is served, it is correct (no tracebacks), 
> but if I
> > > > >do a browser reload a couple times it will eventually serve a blank
> > > > >page.  I can immediately do a browser reload a few more times and 
> get a
> > > > >few more blank pages.  Then if I wait a few seconds and do a browser
> > > > >reload again then it will serve up the proper page.
> > > > >
> > > > >I'm not quite sure how to verify it, but it appears as though one 
> process
> > > > >is having a problem with mod_python while the other process is 
> functioning
> > > > >properly.  Any suggestions on how I could verify this or other ideas?
> > > > >
> > > > >I wasn't able to find anything in the documentation on MPM 
> compatibility.
> > > > >
> > > > >Thanks!
> > > > >
> > > > >-Dan
> > > > >
> > > > >_______________________________________________
> > > > >Mod_python mailing list
> > > > >Mod_python@modpython.org
> > > > >http://mailman.modpython.org/mailman/listinfo/mod_python
> > > >
> > > >_______________________________________________
> > > >Mod_python mailing list
> > > >Mod_python@modpython.org
> > > >http://mailman.modpython.org/mailman/listinfo/mod_python
> > >
> > > _______________________________________________
> > > Mod_python mailing list
> > > Mod_python@modpython.org
> > > http://mailman.modpython.org/mailman/listinfo/mod_python
> > >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
>--
>Conrad Steenberg <conrad@hep.caltech.edu>

From conrad at hep.caltech.edu  Thu Dec  4 10:04:12 2003
From: conrad at hep.caltech.edu (Conrad Steenberg)
Date: Fri Jan  9 22:00:36 2004
Subject: [mod_python] PSP bug report
In-Reply-To: <5.2.1.1.2.20031204114547.02af1930@mail.pyxos.com>
References: <20031204005846.Y83403@onyx.ispol.com>
	 <5.2.1.1.2.20031203174401.03b996c0@mail.pyxos.com>
	 <5.2.1.1.2.20031203221244.02b28a20@mail.pyxos.com>
	 <20031204005846.Y83403@onyx.ispol.com>
	 <5.2.1.1.2.20031204114547.02af1930@mail.pyxos.com>
Message-ID: <1070561052.13675.62.camel@heppc22.hep.caltech.edu>

Hi

Hmmm, you're right, I should have read the documentation again before
posting that. Treating %> as an unindent would also eliminate the
looping html construct.

Cheers

Conrad

On Thu, 2003-12-04 at 09:50, Dan W. wrote:
> That would eliminate conditional html.  However, it might be interesting if 
> PSP had a special directive for conditional html such as two percent signs.
> 
> <%%
> for x in xrange(10):
> %>
> 
> -Dan
> 
> At 09:35 AM 12/4/2003 -0800, you wrote:
> >Hi Grisha
> >
> >This may not be a bug, but it could still be worth the effort to make an
> >%> be considered a newline as well - purely from a support perspective
> >and the amount of annoyance it might save you and countless new users of
> >PSP :-)
> >
> >Cheers
> >
> >Conrad
> >
> >On Wed, 2003-12-03 at 22:00, Gregory (Grisha) Trubetskoy wrote:
> > > I think the best practice is to use a comment rather than a blank line:
> > >
> > > <%
> > > for x in range(0):
> > >       pass
> > > # end for
> > > %>
> > >
> > > Grisha
> > >
> > > On Wed, 3 Dec 2003, Dan W. wrote:
> > >
> > > >
> > > > I realized my error too late.  I needed a blank line after the loop.  PSP
> > > > was considering the rest of the page to be part of the loop and since the
> > > > loop did not execute neither did the html.
> > > >
> > > > -Dan
> > > >
> > > >
> > > >
> > > > At 09:14 PM 12/3/2003 -0600, you wrote:
> > > >
> > > > >It turns out that my problem wasn't related to the worker MPM after
> > > > >all.  After minimizing the code down I've found that PSP fails on zero
> > > > >element for loops.  The following PSP page should reproduce the problem.
> > > > >
> > > > ><%
> > > > >for x in range(0):
> > > > >     pass
> > > > >%>
> > > > >Hello world
> > > > >
> > > > >Does the PSP maintainer read this list?
> > > > >
> > > > >-Dan
> > > > >
> > > > >
> > > > >
> > > > >At 05:54 PM 12/3/2003 -0600, you wrote:
> > > > >
> > > > > >I'm running into a weird problem with 3.1.2b and Apache 2.0.47 
> > compiled
> > > > > >under the worker MPM.  I have two Apache processes, each with 25
> > > > > >threads.  I have a very simple PSP page which imports a simple .py 
> > module
> > > > > >and prints out a value.  The problem is that the page is only 
> > served part
> > > > > >of the time.  When it is served, it is correct (no tracebacks), 
> > but if I
> > > > > >do a browser reload a couple times it will eventually serve a blank
> > > > > >page.  I can immediately do a browser reload a few more times and 
> > get a
> > > > > >few more blank pages.  Then if I wait a few seconds and do a browser
> > > > > >reload again then it will serve up the proper page.
> > > > > >
> > > > > >I'm not quite sure how to verify it, but it appears as though one 
> > process
> > > > > >is having a problem with mod_python while the other process is 
> > functioning
> > > > > >properly.  Any suggestions on how I could verify this or other ideas?
> > > > > >
> > > > > >I wasn't able to find anything in the documentation on MPM 
> > compatibility.
> > > > > >
> > > > > >Thanks!
> > > > > >
> > > > > >-Dan
> > > > > >
> > > > > >_______________________________________________
> > > > > >Mod_python mailing list
> > > > > >Mod_python@modpython.org
> > > > > >http://mailman.modpython.org/mailman/listinfo/mod_python
> > > > >
> > > > >_______________________________________________
> > > > >Mod_python mailing list
> > > > >Mod_python@modpython.org
> > > > >http://mailman.modpython.org/mailman/listinfo/mod_python
> > > >
> > > > _______________________________________________
> > > > Mod_python mailing list
> > > > Mod_python@modpython.org
> > > > http://mailman.modpython.org/mailman/listinfo/mod_python
> > > >
> > > _______________________________________________
> > > Mod_python mailing list
> > > Mod_python@modpython.org
> > > http://mailman.modpython.org/mailman/listinfo/mod_python
> >--
> >Conrad Steenberg <conrad@hep.caltech.edu>
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
-- 
Conrad Steenberg <conrad@hep.caltech.edu>

From Vincent.Raaijmakers at ge.com  Thu Dec  4 16:21:34 2003
From: Vincent.Raaijmakers at ge.com (Raaijmakers, Vincent (IndSys, GE Interlogix))
Date: Fri Jan  9 22:00:36 2004
Subject: [mod_python] Handlers "good practice" question
Message-ID: <971323274247EB44B9A01D0A3B424C8503FF22A2@FTWMLVEM02.e2k.ad.ge.com>

Thanks, 

but please bring me up to speed. I read the information on the web. Do I have to see pywork as a replacement or add-on for all the Handlers of mod_python?
I mean, the default handlers are also a mechanism to go from web -> python code.

Well, perhaps this question shows my newbie level.

Also, based on the other responses, I definitely going to read the O'Reilly book about "Writing Apache Modules in C and Perl"


Vincent

-----Original Message-----
From: Julian Ciccale [mailto:jciccale@mac.com]
Sent: Thursday, December 04, 2003 9:32 AM
To: Raaijmakers, Vincent (IndSys, GE Interlogix)
Subject: Re: [mod_python] Handlers "good practice" question


I suggest you using a web framework on top of mod_python great foundations!

Try PyWork from http://pywork.sf.net , there is also draco and albatross.


On Thursday, December 04, 2003, at 02:48PM, Raaijmakers, Vincent (IndSys, GE Interlogix) <Vincent.Raaijmakers@ge.com> wrote:

>
><<Original Attached>>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python
>
>

From grisha at modpython.org  Thu Dec  4 22:51:53 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:00:36 2004
Subject: [mod_python] session management
In-Reply-To: <OF46341989.F03189B8-ON85256DF2.004D673F@notes.bmo.com>
References: <OF46341989.F03189B8-ON85256DF2.004D673F@notes.bmo.com>
Message-ID: <20031204224817.G97860@onyx.ispol.com>


On Thu, 4 Dec 2003 anthony.barker@bmo.com wrote:

> Do the mod_python sessions work in windows 2000?

I think it does, but if you read the recent "Problem with Session module
with multiple..." thread, it appears there is a bug with the way the path
is provided in the cookies on Windows in the latest beta version.

But, aside from that, the answer is "yes" ;-)

> It would be nice if the session module was compatible with cgi,
> so it could be used in prototyping situations where the user doesn't
> have access to a mod_python enabled apache server....

Cgi and mod_python are worlds apart, it makes no sense to find a
compromize between them.

Grisha
From jciccale at mac.com  Fri Dec  5 08:44:14 2003
From: jciccale at mac.com (Julian Ciccale)
Date: Fri Jan  9 22:00:36 2004
Subject: [mod_python] Handlers "good practice" question
Message-ID: <12818729.1070610254969.JavaMail.jciccale@mac.com>


>but please bring me up to speed. I read the information on the web. Do I have to see pywork as a 
>replacement or add-on for all the Handlers of mod_python?

In this case its a mod_python handler, so it would be a replacement


>I mean, the default handlers are also a mechanism to go from web -> python code.

Yes all the default python handlers are a mechanism to gor from web to python code and are really fast.

>Also, based on the other responses, I definitely going to read the O'Reilly book about "Writing 
> Apache Modules in C and Perl"

I don't see why you should write modules in C and Perl to write a web application. ModPython offers
much more flexibility and power and ModPython *IS* an Apache C Module, your applications, IMHO should be written in a higher level language, and only if you really need very high performance, you could rewrite some of your application's modules in C.

To get to know mod_python I think you could begin to understand the Publisher handler and if you are more lazy then try PSP..

In any case if you will start a big project I strongly suggest you to use some MVC/templating library.

- julcicc -
From gdamjan at mail.net.mk  Fri Dec  5 13:25:24 2003
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 22:00:37 2004
Subject: [mod_python] Mod_python disables mod_dav
In-Reply-To: <20031127054340.GA3835@legolas.on.net.mk>
References: <20031127054340.GA3835@legolas.on.net.mk>
Message-ID: <20031205122524.GA16632@legolas.on.net.mk>

> I'm using Apache 2.0.48 (it happened to 2.0.47 too) with the built-in
> mod_dav module and mod_python 3.1.2b/Python-2.3.2 and PHP/4.3.4.
> 
> I can't understand why but unless I disable mod_python (by commenting
> the LoadModule directive), DAV will not work. It just returns a "405
> Method is not allowed" error. 
> 
> I've tried different DAV setups and clients, and nothing - unless I
> disable mod_python it wont work...
> 
> Now I think that with older versions of mod_python this did not happen -
> but I'm not sure. I'll have to recheck that.
> 
> Does anyone know why this could happen?!?

Any ideas? Can at least, someone confirm my problem?
btw
I'm using "Slackware Linux 9.1"

-- 
Damjan Georgievski
jabberID: damjan@bagra.net.mk
From neel at mediapulse.com  Fri Dec  5 10:39:00 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:00:37 2004
Subject: [mod_python] Handlers "good practice" question
Message-ID: <C0FC22C08B82074A88B500617641577787A7DF@johnson.mediapulse.net>

> >Also, based on the other responses, I definitely going to 
> read the O'Reilly book about "Writing 
> > Apache Modules in C and Perl"
> 
> I don't see why you should write modules in C and Perl to 
> write a web application. ModPython offers
> much more flexibility and power and ModPython *IS* an Apache 
> C Module, your applications, IMHO should be written in a 
> higher level language, and only if you really need very high 
> performance, you could rewrite some of your application's 
> modules in C.
> 

I think you missed some of the thread. The point of recommending the
book is not to learn how write module in C or Perl, but to learn how
apache works.  AFAIK this is the only book out there that details the
Apache API, but even in it's dated state it's very useful.  Somethings
this book helped make clear for me was the difference between
authorization and authencation, how to have multiple handlers on the
same request in apache 1.3 (or why fixup handlers always return false),
and that all log handlers are called that are registered for a request.

Mike

From barry at python.org  Fri Dec  5 10:59:53 2003
From: barry at python.org (Barry Warsaw)
Date: Fri Jan  9 22:00:37 2004
Subject: [mod_python] mod_python ignoring --with-python?
Message-ID: <1070639992.1377.6.camel@anthem>

I have a very strange problem which I don't quite understand.  I'm on a
RH9 system, with an Apache 2.0.48 built in a non-standard location, and
a Python 2.3.2 built in a non-standard location.  So when I configure
mod_python 3.0.4, I use --with-apxs to point at my non-standard Apache's
bin/apxs, and --with-python to point at my non-standard python
executable.  make ; make install and everything appears to go in the
right places.

Now I start up Apache doing something like:

% cd non/standard/location
% sudo bin/httpd -DONE_PROCESS

However, it appears as if mod_python is still using the first Python on
my $PATH instead of the one I used to configure --with-python.  I can
tell this because 1) if mod_python isn't installed in my $PATH Python,
Apache will throw a server error saying it couldn't import
mod_python.apache; 2) if I strace httpd I can see it's trying to do tons
of imports from /usr/local (where my $PATH Python is installed).

So either I misunderstand how --with-python is supposed to work, or this
is a bug, or it's a missing feature. ;).  Shouldn't mod_python honor
--with-python and ignore $PATH python?

Thanks for any light you can shed.  Let me know if you need more
information.
-Barry


From jciccale at mac.com  Fri Dec  5 17:31:16 2003
From: jciccale at mac.com (Julian Ciccale)
Date: Fri Jan  9 22:00:37 2004
Subject: [mod_python] Handlers "good practice" question
Message-ID: <702685.1070641876421.JavaMail.jciccale@mac.com>

 I think you are right, it seems I missed something. However the httpd apache documentation, as well as the APR documentation for 2.0.x are very good starting points to get to know apache internals.
 
On Friday, December 05, 2003, at 04:39PM, Michael C. Neel <neel@mediapulse.com> wrote:

>> >Also, based on the other responses, I definitely going to 
>> read the O'Reilly book about "Writing 
>> > Apache Modules in C and Perl"
>> 
>> I don't see why you should write modules in C and Perl to 
>> write a web application. ModPython offers
>> much more flexibility and power and ModPython *IS* an Apache 
>> C Module, your applications, IMHO should be written in a 
>> higher level language, and only if you really need very high 
>> performance, you could rewrite some of your application's 
>> modules in C.
>> 
>
>I think you missed some of the thread. The point of recommending the
>book is not to learn how write module in C or Perl, but to learn how
>apache works.  AFAIK this is the only book out there that details the
>Apache API, but even in it's dated state it's very useful.  Somethings
>this book helped make clear for me was the difference between
>authorization and authencation, how to have multiple handlers on the
>same request in apache 1.3 (or why fixup handlers always return false),
>and that all log handlers are called that are registered for a request.
>
>Mike
>
>
From JTesser at nbbc.edu  Sun Dec  7 17:44:57 2003
From: JTesser at nbbc.edu (Jason Tesser)
Date: Fri Jan  9 22:00:37 2004
Subject: [mod_python] Python CMS with PgSQL
Message-ID: <04875CB4331F0240A0AD66F970978651160A5D@paul>

I am thinking about developing a CMS with Python and Postgres.  I am developing
on a Linux box with Apache 2.  I have used PHP in the past but my at work we are
considering going with Python as our main devellopment language.  A few
questions for you guys.

1. Is it best to just develop in all Pyhton or to use a mixture of PHP and Python? 
Why orther than personal feelings?

2. What is the best way to template using Python for me to seperate content 
from logic?  All the data that will be displayed in dynamic so I am not sure 
what the best way to template it would be in Python.

Thank you for any thoughts offered.

From damon at asianreflection.com  Mon Dec  8 22:45:45 2003
From: damon at asianreflection.com (Damon Lynch)
Date: Fri Jan  9 22:00:37 2004
Subject: [mod_python] Python CMS with PgSQL
In-Reply-To: <04875CB4331F0240A0AD66F970978651160A5D@paul>
References: <04875CB4331F0240A0AD66F970978651160A5D@paul>
Message-ID: <1070876744.24987.76.camel@damon.asianreflection.com>

On Mon, 2003-12-08 at 12:44, Jason Tesser wrote:

> 2. What is the best way to template using Python for me to seperate content 
> from logic?  All the data that will be displayed in dynamic so I am not sure 
> what the best way to template it would be in Python.

(I realize this is a mod_python list but...)

http://www.plone.org/documentation/zpt1 has some interesting ideas worth
a read.

HTH,
Damon

From petri.savolainen at iki.fi  Mon Dec  8 14:38:59 2003
From: petri.savolainen at iki.fi (Petri Savolainen)
Date: Fri Jan  9 22:00:37 2004
Subject: [mod_python] Re: Python CMS with PgSQL
In-Reply-To: <04875CB4331F0240A0AD66F970978651160A5D@paul>
References: <04875CB4331F0240A0AD66F970978651160A5D@paul>
Message-ID: <br1r9v$pct$1@sea.gmane.org>

Jason Tesser wrote:

> I am thinking about developing a CMS with Python and Postgres.  I am developing
> on a Linux box with Apache 2.  I have used PHP in the past but my at work we are
> considering going with Python as our main devellopment language.  A few
> questions for you guys.

Don't reinvent the wheel. Building your own CMS is not a good idea 
unless none of the existing "CMS type" web frameworks do what you need - 
which would be very surprising as there are dozens of them for both PHP 
and Python; do a bit of research and pick one that suits your needs 
best. For python, Zope is the largest and most difficult for someone 
coming from PHP world. There are also many alternatives to a full-blown 
CMS that you may find yourself more comfortable with, such as mod_python 
:-) Also be very careful when you see the word CMS used about a platform 
or product... it is used ultra-liberally in the industry.

> 1. Is it best to just develop in all Pyhton or to use a mixture of PHP and Python? 
> Why orther than personal feelings?

Don't mix languages unless you have to. Keep it simple if you can.

Much of the language issue is nonsense; more important is what is your 
company development model and style than the language that is used. For 
simple (in terms of code complexity and amount of lines) web apps and 
sites, whether you do apache + php + sql is not really that much 
different from apache + mod_python + sql. Both shine doing what they are 
supposed to.

However, if you are moving towards building large systems, or develop 
actual software products, you will find out there are things that are 
not well supported in php or that you simply cannot do.

> 2. What is the best way to template using Python for me to seperate content 
> from logic?  All the data that will be displayed in dynamic so I am not sure 
> what the best way to template it would be in Python.

I would recommend Page Templates; the technology originates from Zope, 
but there are standalone libraries you can use with mod_python, such as 
SimpleTAL/TALES and OpenTAL, and probably others. Note that there is 
also an implementation for PHP that you may find interesting.

I have not tried the templating system being developed for mod_python; 
if you're considering mod_python, you should also try its native 
templating system.

Hope that helps,

  Petri

From JTesser at nbbc.edu  Mon Dec  8 14:44:11 2003
From: JTesser at nbbc.edu (Jason Tesser)
Date: Fri Jan  9 22:00:37 2004
Subject: [mod_python] Re: Python CMS with PgSQL
Message-ID: <04875CB4331F0240A0AD66F970978651160A61@paul>

<snip>

> Don't reinvent the wheel. Building your own CMS is not a good idea 
> unless none of the existing "CMS type" web frameworks do what you need - 
> which would be very surprising as there are dozens of them for both PHP 
> and Python; do a bit of research and pick one that suits your needs 
> best. For python, Zope is the largest and most difficult for someone 
> coming from PHP world. There are also many alternatives to a full-blown 
> CMS that you may find yourself more comfortable with, such as mod_python 
> :-) Also be very careful when you see the word CMS used about a platform 
> or product... it is used ultra-liberally in the industry.

I have looked at all the ones I know of but they all lack some of the features or
control I need.  I need to have a lot of users changing and editing content 
(text only) and it all goes to an editor.  All layout, graphics and photos need 
to be filtered through a different person.  Some types of content ie news needs to 
be approved by a vice president.  Zope can be extended to do all this but with
what I would need to do to extend it I might as customize it and write it
myself.  I do have a little experience with Python as I have written a POS
system in it.  The CMS I need will eventually even handle online registration as
I work for a Bible College.  I don't see it as reinventing the wheel I just 
don't like being tied down to a framework.  That is why I don't like Websphere
or J2ee.  

<snip>

> I have not tried the templating system being developed for mod_python; 
> if you're considering mod_python, you should also try its native 
> templating system.

What is mod_python's templating system?  Is it PSP.  I am trying to get PSP working
now and I cannot seem to get it to work.  I am using mod_python 3.01 with apache 2
on a RH9 box.  When I goto the page I just get the psp code?  :-s  Any ideas?


_____________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python

From JTesser at nbbc.edu  Mon Dec  8 14:50:46 2003
From: JTesser at nbbc.edu (Jason Tesser)
Date: Fri Jan  9 22:00:37 2004
Subject: [mod_python] PSP how to????
Message-ID: <04875CB4331F0240A0AD66F970978651011376FA@paul>

OK can someone please explain to me how to get Apache 2 with mod_python 3.01 to recogize xxxx.psp pages?
I am just a poor programmer and my system admin skills need help :-) 

From conrad at hep.caltech.edu  Mon Dec  8 13:29:24 2003
From: conrad at hep.caltech.edu (Conrad Steenberg)
Date: Fri Jan  9 22:00:37 2004
Subject: [mod_python] PSP how to????
In-Reply-To: <04875CB4331F0240A0AD66F970978651011376FA@paul>
References: <04875CB4331F0240A0AD66F970978651011376FA@paul>
Message-ID: <1070918964.23133.5.camel@heppc22.hep.caltech.edu>

Hi Jason

You need a newer version: 3.1.x, with the newest being 3.1.2b on
www.modpython.org

Cheers

Conrad

On Mon, 2003-12-08 at 12:50, Jason Tesser wrote:
> OK can someone please explain to me how to get Apache 2 with mod_python 3.01 to recogize xxxx.psp pages?
> I am just a poor programmer and my system admin skills need help :-) 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
-- 
Conrad Steenberg <conrad@hep.caltech.edu>

From neel at mediapulse.com  Mon Dec  8 16:33:45 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:00:37 2004
Subject: [mod_python] Re: Python CMS with PgSQL
Message-ID: <C0FC22C08B82074A88B500617641577787A7E2@johnson.mediapulse.net>

> > Don't reinvent the wheel. Building your own CMS is not a good idea 
> > unless none of the existing "CMS type" web frameworks do 
> what you need - 
> 
> I have looked at all the ones I know of but they all lack 
> some of the features or
> control I need. 

I can understan this, there are a lot of CMS apps out there but none of
these wheels ever seem "round" when you need one =p.

Tools that I know of:

mod_python comes with psp (with 3.x); this is very new atm, so things
may change as it grows and might cause you some headache with backwards
compatibility.  The worst setup I could see is needing to patch
mod_pyhton for a fix, but not wanting the latest version of PSP that
comes with it.  This is also partly me; I usally don't look deeply into
something until it's stood at least a year - so I know it will be
around.

For mod_python you can also get Draco (http://draco.boskant.nl/) or
Spyce (http://spyce.sourceforge.net/).  Both of these are close to the
way PSP works; spyce more so that Draco.  Draco allows for code to be in
a separate file, which might lend itself to larger projects better.

There is also Albatross
(http://www.object-craft.com.au/projects/albatross/), which works for
mod_python, CGI, and in a standalone webserver.  Albatross extends along
the same lines as Draco, but instead of placing raw python in templates
it uses an XML-like tag language of al- and alx- tags.  Albatross can
also store it's session objects client side, server side, or on a
session server to support clusterd websites.

For down and dirty, quick and cheap, there is ezt
(http://svn.webdav.org/repos/projects/subwiki/trunk/lib/ezt.py), which
isn't a project to itself, but I've found useful when all I needed was
some %s magic with a bit more control (i.e. ifs and loops).

There are more I'm sure, but those are the ones stuck in my head.  I use
ezt and/or Albatross myself, each for about a year now.  I recommend
playing with each one, seeing which one works best in your enviroment,
then going with it.

Have fun,
Mike

From JTesser at nbbc.edu  Mon Dec  8 16:31:47 2003
From: JTesser at nbbc.edu (Jason Tesser)
Date: Fri Jan  9 22:00:37 2004
Subject: [mod_python] PSP how to????
Message-ID: <04875CB4331F0240A0AD66F970978651160A62@paul>

Is that release stable???


-----Original Message-----
From:	Conrad Steenberg [mailto:conrad@hep.caltech.edu]
Sent:	Mon 12/8/2003 3:29 PM
To:	Jason Tesser
Cc:	Mod_Python (E-mail)
Subject:	Re: [mod_python] PSP how to????
Hi Jason

You need a newer version: 3.1.x, with the newest being 3.1.2b on
www.modpython.org

Cheers

Conrad

On Mon, 2003-12-08 at 12:50, Jason Tesser wrote:
> OK can someone please explain to me how to get Apache 2 with mod_python 3.01 to recogize xxxx.psp pages?
> I am just a poor programmer and my system admin skills need help :-) 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
-- 
Conrad Steenberg <conrad@hep.caltech.edu>






From Brian.Parkinson at quest.com  Mon Dec  8 17:44:44 2003
From: Brian.Parkinson at quest.com (Brian Parkinson)
Date: Fri Jan  9 22:00:37 2004
Subject: [mod_python] Help getting mod_python set up on Windows/Apache
Message-ID: <46C5DCD410224A42BE3151AC8AE75E4E016E091B@tormbxw01.prod.quest.corp>

Hello:

I am trying to get mod_python working, and for the life of me I'm
stumped.

Version of Python: 2.2
Version of Apache: 2.0.48
Version of mod_python: 3.0.4

Here is the bit from my http.conf file in the Apache dist:

LoadModule python_module modules/mod_python.so

<Directory "C:/home/web/docs/"> 
  AddHandler python-program .py
  PythonHandler test 
  PythonDebug On 
</Directory>

I have a file called C:/home/web/docs/test.py and it contains:

from mod_python import apache

def handler(req):
    req.write("Hello World!")
    return apache.OK

When I re-start Apache, and then enter the URL to the test.py
file (http://localhost/test.py) the following is my log message:

[Mon Dec 08 14:40:03 2003] [notice] Parent: Created child process 2188
[Mon Dec 08 14:40:03 2003] [notice] Child 2188: Child process is running
[Mon Dec 08 14:40:03 2003] [notice] Child 2188: Acquired the start
mutex.
[Mon Dec 08 14:40:03 2003] [notice] Child 2188: Starting 250 worker
threads.
[Mon Dec 08 14:40:16 2003] [error] make_obcallback: could not import
mod_python.apache.


Agh!

Can anyone help me? This seems to close, but yet so far.

Thanks,

parki...



From grisha at modpython.org  Mon Dec  8 21:05:18 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:00:37 2004
Subject: [mod_python] Python CMS with PgSQL
In-Reply-To: <04875CB4331F0240A0AD66F970978651160A5D@paul>
References: <04875CB4331F0240A0AD66F970978651160A5D@paul>
Message-ID: <20031208210414.X60503@onyx.ispol.com>



On Sun, 7 Dec 2003, Jason Tesser wrote:

> 1. Is it best to just develop in all Pyhton or to use a mixture of PHP
> and Python?

This may sound too simple, but I recommend you stick to Python only, for
everything. :-)

Grisha
From scott_list at mischko.com  Mon Dec  8 22:06:53 2003
From: scott_list at mischko.com (Scott Chapman)
Date: Fri Jan  9 22:00:37 2004
Subject: [mod_python] PSP how to????
In-Reply-To: <04875CB4331F0240A0AD66F970978651160A62@paul>
References: <04875CB4331F0240A0AD66F970978651160A62@paul>
Message-ID: <200312082206.53039.scott_list@mischko.com>

On Monday 08 December 2003 14:31, Jason Tesser wrote:
> Is that release stable???

Yes.  It seems very good.  By the time you get to production, there will 
likely be a new version out anyway.  :-)

P.S. I prefer Draco. It's design strikes me as very elegant.  I've made 
mods such as making the templates so that they are able to be read from 
a hash variable rather than a file.  This provides a great deal of 
flexibility.  It's a very nice tool set.

Get Draco from CVS, not the production version, for use with 3.1.2b.

Scott

From davidf at sjsoft.com  Tue Dec  9 11:26:23 2003
From: davidf at sjsoft.com (David Fraser)
Date: Fri Jan  9 22:00:37 2004
Subject: [mod_python] Re: Python CMS with PgSQL
In-Reply-To: <04875CB4331F0240A0AD66F970978651160A61@paul>
References: <04875CB4331F0240A0AD66F970978651160A61@paul>
Message-ID: <3FD5953F.4050709@sjsoft.com>

Jason Tesser wrote:

><snip>
>
>  
>
>>Don't reinvent the wheel. Building your own CMS is not a good idea 
>>unless none of the existing "CMS type" web frameworks do what you need - 
>>which would be very surprising as there are dozens of them for both PHP 
>>and Python; do a bit of research and pick one that suits your needs 
>>best. For python, Zope is the largest and most difficult for someone 
>>coming from PHP world. There are also many alternatives to a full-blown 
>>CMS that you may find yourself more comfortable with, such as mod_python 
>>:-) Also be very careful when you see the word CMS used about a platform 
>>or product... it is used ultra-liberally in the industry.
>>    
>>
>
>I have looked at all the ones I know of but they all lack some of the features or
>control I need.  I need to have a lot of users changing and editing content 
>(text only) and it all goes to an editor.  All layout, graphics and photos need 
>to be filtered through a different person.  Some types of content ie news needs to 
>be approved by a vice president.  Zope can be extended to do all this but with
>what I would need to do to extend it I might as customize it and write it
>myself.  I do have a little experience with Python as I have written a POS
>system in it.  The CMS I need will eventually even handle online registration as
>I work for a Bible College.  I don't see it as reinventing the wheel I just 
>don't like being tied down to a framework.  That is why I don't like Websphere
>or J2ee.  
>
><snip>
>  
>
I would have a look at plone, it's a CMS built on top of Zope
www.plone.org

David

From JTesser at nbbc.edu  Tue Dec  9 10:46:10 2003
From: JTesser at nbbc.edu (Jason Tesser)
Date: Fri Jan  9 22:00:37 2004
Subject: [mod_python] PSP how to????
Message-ID: <04875CB4331F0240A0AD66F970978651011376FB@paul>

> You need a newer version: 3.1.x, with the newest being 3.1.2b on
> www.modpython.org

OK I got and and I am trying to compile it.  I am on a Suse9.0 box with Apache2
installed.  When I run ./configure --with-apxs=/usr/share/apache2 it tells
me I need to run apache2.  It doesn't tell me what I am running now but all
I have installed in apache2.  Any ideas?

From sergey at optimaltec.com  Tue Dec  9 12:04:11 2003
From: sergey at optimaltec.com (Sergey A. Lipnevich)
Date: Fri Jan  9 22:00:37 2004
Subject: [mod_python] Re: PSP how to????
In-Reply-To: <04875CB4331F0240A0AD66F970978651011376FB@paul>
References: <04875CB4331F0240A0AD66F970978651011376FB@paul>
Message-ID: <3FD6008B.4090005@optimaltec.com>

try --with-apxs=$(which apxs)

Jason Tesser wrote:
>>You need a newer version: 3.1.x, with the newest being 3.1.2b on
>>www.modpython.org
> 
> 
> OK I got and and I am trying to compile it.  I am on a Suse9.0 box with Apache2
> installed.  When I run ./configure --with-apxs=/usr/share/apache2 it tells
> me I need to run apache2.  It doesn't tell me what I am running now but all
> I have installed in apache2.  Any ideas?


From patm at visi.com  Tue Dec  9 11:21:29 2003
From: patm at visi.com (Patrick McNamee)
Date: Fri Jan  9 22:00:37 2004
Subject: [mod_python] PSP how to????
In-Reply-To: <04875CB4331F0240A0AD66F970978651011376FB@paul>
References: <04875CB4331F0240A0AD66F970978651011376FB@paul>
Message-ID: <20031209172129.GB27875@isis.visi.com>

On Tue, Dec 09, 2003 at 10:46:10AM -0600, Jason Tesser wrote:
> > You need a newer version: 3.1.x, with the newest being 3.1.2b on
> > www.modpython.org
> 
> OK I got and and I am trying to compile it.  I am on a Suse9.0 box with Apache2
> installed.  When I run ./configure --with-apxs=/usr/share/apache2 it tells
> me I need to run apache2.  It doesn't tell me what I am running now but all
> I have installed in apache2.  Any ideas?

I think you want something like: 
./configure --with-apxs=/usr/share/apache2/bin/apxs --with-python=/path/to/python2.2

See http://www.modpython.org/live/mod_python-3.1.2b/doc-html/installation.html
for more info.

pm
From menion at asylumwear.com  Tue Dec  9 11:49:56 2003
From: menion at asylumwear.com (Joshua Schmidlkofer)
Date: Fri Jan  9 22:00:37 2004
Subject: [mod_python] import site errors, and constant modules (Re)loading
Message-ID: <1070999395.32237.19.camel@bubbles.imr-net.com>

I have poked through the list archives, and I still am.  I have Redhat
with mod_python-3.0.1 - the rpm packaged release.  In any case, whenever
I call my script it is re-instantiating the objects..

my script is like:

<snip>
class foo:
    def __init__(self):
        self.dbconn = psycopg.connect(.....)
        pass
    def handler(self, req):
        ....
        return content

__classholder__ = foo()
handler = foo.handler
</snip>

Did I fail to grok the greater meaning?  Am I committing a rookie
error?   I have turned on debug mode, and everytime I call the script I
get : 

[Tue Dec 09 11:18:25 2003] [notice] mod_python: (Re)importing module
'update' with path set to '['/var/www/html/proxy']'
'import site' failed; use -v for traceback
(this repeats about 20 times)


Anyway, thanks,
  joshua (going back to google)

-- 
I refuse to believe that the really hot, Debian-using,
password-sniffing, root-exploiting geek girl is a myth. -- g1zmo

From michael at dynamine.net  Tue Dec  9 12:03:27 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 22:00:37 2004
Subject: [mod_python] import site errors, and constant modules (Re)loading
In-Reply-To: <1070999395.32237.19.camel@bubbles.imr-net.com>
References: <1070999395.32237.19.camel@bubbles.imr-net.com>
Message-ID: <3FD62A8F.20708@dynamine.net>

I believe that in debug mode, your handler is always re-imported.  (Not 
necessarily its dependencies, though; that code is up to you.)

--Michael

Joshua Schmidlkofer wrote:
> I have poked through the list archives, and I still am.  I have Redhat
> with mod_python-3.0.1 - the rpm packaged release.  In any case, whenever
> I call my script it is re-instantiating the objects..
> 
> my script is like:
> 
> <snip>
> class foo:
>     def __init__(self):
>         self.dbconn = psycopg.connect(.....)
>         pass
>     def handler(self, req):
>         ....
>         return content
> 
> __classholder__ = foo()
> handler = foo.handler
> </snip>
> 
> Did I fail to grok the greater meaning?  Am I committing a rookie
> error?   I have turned on debug mode, and everytime I call the script I
> get : 
> 
> [Tue Dec 09 11:18:25 2003] [notice] mod_python: (Re)importing module
> 'update' with path set to '['/var/www/html/proxy']'
> 'import site' failed; use -v for traceback
> (this repeats about 20 times)
> 
> 
> Anyway, thanks,
>   joshua (going back to google)
> 

From denneking at nngov.com  Tue Dec  9 15:39:54 2003
From: denneking at nngov.com (David Enneking)
Date: Fri Jan  9 22:00:37 2004
Subject: [mod_python] 
Message-ID: <5.1.1.6.0.20031209150205.02be1ca0@pop.visi.net>

Hi,

Where can I find an example of using the session object and persistent data 
within a PSP page.

Thanks,
David
-------------- next part --------------

---
Outgoing mail is certified Virus Free.
Checked by AVG anti-virus system (http://www.grisoft.com).
Version: 6.0.545 / Virus Database: 339 - Release Date: 11/27/2003
From menion at asylumwear.com  Tue Dec  9 13:08:55 2003
From: menion at asylumwear.com (Joshua Schmidlkofer)
Date: Fri Jan  9 22:00:37 2004
Subject: [mod_python] import site errors, and
	constant	modules	(Re)loading
In-Reply-To: <3FD638D2.3030302@dynamine.net>
References: <1070999395.32237.19.camel@bubbles.imr-net.com>
	 <3FD62A8F.20708@dynamine.net>
	 <1071001721.32237.31.camel@bubbles.imr-net.com>
	 <3FD632F2.80503@dynamine.net>
	 <1071003271.32237.54.camel@bubbles.imr-net.com>
	 <3FD638D2.3030302@dynamine.net>
Message-ID: <1071004134.32237.70.camel@bubbles.imr-net.com>

Micheal,

  Thanks for keep up with me..... I moved everything to a separate
module, and I imported the module, used the db connection, etc. 

   Is it possible that I am not returning properly?   When you are using
the publisher handler, all the documentation and examples I have seen
have a "return content" at the end.  So I am storing everything in a
string, and "return"ing at the end of my handler method.  

  I can't figure this out, nothing is getting garbage collected, and
that must mean it is still in scope in some context or other.  


  idea?

thanks,
  Joshua



On Tue, 2003-12-09 at 13:04, Michael S. Fischer wrote:
> In my own work, the connection-handling code is in a separate module. 
> Though, if you do it right, it should work identically in the mod_python 
> module, assuming mod_python is not reloading the module.
> 
> --Michael
> 
> Joshua Schmidlkofer wrote:
> 
> > On Tue, 2003-12-09 at 12:39, Michael S. Fischer wrote:
> > 
> >>Yeah, try something like this:
> >>
> >><module 'db'>
> >>
> >>_conn = None
> >>def getConnection():
> >>    global _conn
> >>    if not _conn:
> >>       _conn = ...  # Get connection
> >>    return _conn
> >>
> >>See if something like that works.
> >>
> >>Joshua Schmidlkofer wrote:
> > 
> > 
> > Yeah, I pretty much have this exact logic - save one thing - is this in
> > a separate module that get imported?  Was that what your first message
> > said?
> > 
> > thanks,
> >   Joshua
> > 
> > 
> > 
-- 
I refuse to believe that the really hot, Debian-using,
password-sniffing, root-exploiting geek girl is a myth. -- g1zmo

From menion at asylumwear.com  Tue Dec  9 13:32:15 2003
From: menion at asylumwear.com (Joshua Schmidlkofer)
Date: Fri Jan  9 22:00:37 2004
Subject: [mod_python] import site errors,
	and	constant	modules	(Re)loading
In-Reply-To: <3FD63BED.5030000@dynamine.net>
References: <1070999395.32237.19.camel@bubbles.imr-net.com>
	 <3FD62A8F.20708@dynamine.net>
	 <1071001721.32237.31.camel@bubbles.imr-net.com>
	 <3FD632F2.80503@dynamine.net>
	 <1071003271.32237.54.camel@bubbles.imr-net.com>
	 <3FD638D2.3030302@dynamine.net> <1  <3FD63BED.5030000@dynamine.net>
Message-ID: <1071005534.32237.92.camel@bubbles.imr-net.com>

On Tue, 2003-12-09 at 13:17, Michael S. Fischer wrote:
> Indeed, when using the publisher handler, you are supposed to return the 
> content.
> 
> I don't understand your code, though.  What is the idea behind its 
> arrangement?
> 
> Normally when I make mod_python.publisher scripts, I do something like:
> 
> <snip>
> _conn = None
> def _getConnection(...):
>     global _conn
>     if not _conn:
>        _conn = ...
>     return _conn
> 
> def index(req, params...):
>     ...
>     conn = _getConnection(...)
>     ...
>     return content
> </snip>
> 

Here is an example, that is producing the problem for me:


import psycopg, os, copy, types


_DSN     = 'dbname=mydb user=myuser host=dbserver'
_conn    = None

def getConnection():
    global _conn
    if not _conn: _conn = psycopg.connect(_DSN)
    return _conn.cursor()

def index(**kwargs):
    cursor = getConnection()

    cursor.execute("select * from bad")

    content = """
    <html><head><title>test</test></head>
    <body>

    Test:<br>%s
    
    </body></html>
    """

    tmp = ""
    for x in cursor.fetchall(): tmp += "%s<br>" % str(x)

    cursor.close()
    del cursor
    return content % tmp


From grisha at modpython.org  Wed Dec 10 00:54:05 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:00:37 2004
Subject: [mod_python] import site errors, and constant modules (Re)loading
In-Reply-To: <1070999395.32237.19.camel@bubbles.imr-net.com>
References: <1070999395.32237.19.camel@bubbles.imr-net.com>
Message-ID: <20031210004953.B77939@onyx.ispol.com>



On Tue, 9 Dec 2003, Joshua Schmidlkofer wrote:

> [Tue Dec 09 11:18:25 2003] [notice] mod_python: (Re)importing module
> 'update' with path set to '['/var/www/html/proxy']'
> 'import site' failed; use -v for traceback
> (this repeats about 20 times)

You should get as many of these messages as there are httpd processes
running. 20 seems a bit high to me, unless your httpd is configured to
have a minimum 20 servers running at any given time, but it is not
impossible (or unreasonable for a high volume server).

Do you get one of these for every request, or only for the first 20?

Grisha
From rey4 at columbia.edu  Wed Dec 10 02:28:35 2003
From: rey4 at columbia.edu (Russell Yanofsky)
Date: Fri Jan  9 22:00:37 2004
Subject: [mod_python] script_name bug again
Message-ID: <br6i02$5lh$1@sea.gmane.org>

Hi,

At the beginning of August I reported a bug affecting the value of the
script_name cgi variable and posted two patches to fix it in mod_python
2.7.8 and 3.0.3.

The fix appears to have been included in mod_python 3.0.4, but not in
mod_python 2.7.9. Is there a chance it can be included in the next release
of 2.7?

The patches are posted here:

http://www.modpython.org/pipermail/mod_python/attachments/20030811/8718dca2/mod_python-2.7.8.obj
http://www.modpython.org/pipermail/mod_python/attachments/20030811/8718dca2/mod_python-3.0.3.obj

The initial bug report is here:

http://www.modpython.org/pipermail/mod_python/2003-August/003495.html

And the fix for mod_python 3.0 was committed here:

http://cvs.apache.org/viewcvs.cgi/httpd-python/src/mod_python.c?r1=1.95&r2=1.96

- Russ


From catellani.m at maxmara.it  Wed Dec 10 09:17:12 2003
From: catellani.m at maxmara.it (Marco Catellani)
Date: Fri Jan  9 22:00:37 2004
Subject: [mod_python] Managing multiple users with mod-python
Message-ID: <3153892629catellani.m@maxmara.it>


Hi,
I'm experienced with Python and I'm learning to configure and use Mod Python (rel 3.03) and Apache (rel 2).
I'm setting up on my server a test environment, and I would like to manage multiple users, everyone of them using a different python interpreter.
Every programmer in my test environment should work with its own user and the python programs launched by him should run under his user and should not interfere with other user's processes.
Apache supports only one user for all child processes, so I'm not able to launch multiple interpreters with different users. Does Mod Python offers any feature to satisfy my need?

Thanks a lot

     Marco



From michael at dynamine.net  Wed Dec 10 09:46:36 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 22:00:37 2004
Subject: [mod_python] Managing multiple users with mod-python
In-Reply-To: <3153892629catellani.m@maxmara.it>
References: <3153892629catellani.m@maxmara.it>
Message-ID: <3FD75BFC.7030900@dynamine.net>

No.  If you want each user to have his own instance of Apache, have each 
one run his own copy, each of which is bound to a personal port.

--Michael

Marco Catellani wrote:

> Hi,
> I'm experienced with Python and I'm learning to configure and use Mod Python (rel 3.03) and Apache (rel 2).
> I'm setting up on my server a test environment, and I would like to manage multiple users, everyone of them using a different python interpreter.
> Every programmer in my test environment should work with its own user and the python programs launched by him should run under his user and should not interfere with other user's processes.
> Apache supports only one user for all child processes, so I'm not able to launch multiple interpreters with different users. Does Mod Python offers any feature to satisfy my need?
> 
> Thanks a lot
> 
>      Marco
> 
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 
From matt at pollenation.net  Wed Dec 10 18:31:16 2003
From: matt at pollenation.net (Matt Goodall)
Date: Fri Jan  9 22:00:37 2004
Subject: [mod_python] Managing multiple users with mod-python
In-Reply-To: <3FD75BFC.7030900@dynamine.net>
References: <3153892629catellani.m@maxmara.it> <3FD75BFC.7030900@dynamine.net>
Message-ID: <3FD76674.1040708@pollenation.net>


> Marco Catellani wrote:
>
>> Hi,
>> I'm experienced with Python and I'm learning to configure and use Mod 
>> Python (rel 3.03) and Apache (rel 2).
>> I'm setting up on my server a test environment, and I would like to 
>> manage multiple users, everyone of them using a different python 
>> interpreter.
>> Every programmer in my test environment should work with its own user 
>> and the python programs launched by him should run under his user and 
>> should not interfere with other user's processes.
>> Apache supports only one user for all child processes, so I'm not 
>> able to launch multiple interpreters with different users. Does Mod 
>> Python offers any feature to satisfy my need? 
>
Assuming you don't need the tight coupling Apache+mod_python provides ...

You may want to look at something like SCGI for development instead of 
mod_python. You would assign each user an SCGI port number (Bob uses 
3000, Dave uses 3001 etc) and then configure Apache so that each user 
has a virtual host or URL path on the web server which forwards requests 
to the user's SCGI process. Your users can then develop, start and stop 
the web app from somewhere within their home directory, without ever 
needing to touch Apache.

There are quite a few web frameworks which work behind either SCGI or 
mod_python so moving from SCGI during development to mod_python for 
production (if that's what you decide to do) should be relatively painless.

    SCGI - http://www.mems-exchange.org/software/scgi/

Another interesting solution to your problem, although nothing to do 
with Apache or mod_python, is Twisted's spreadable web servers. See 
http://www.twistedmatrix.com/documents/howto/using-twistedweb#auto19 for 
more. It's worth pointing out that the personal servers can be any 
Twisted-based web application and not just something that serves content 
from the file system.

Hope this helps.

Cheers, Matt

-- 
Matt Goodall, Pollenation Internet Ltd
w: http://www.pollenationinternet.com
e: matt@pollenation.net


From dpopowich at mtrsd.k12.ma.us  Thu Dec 11 11:10:07 2003
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Fri Jan  9 22:00:37 2004
Subject: [mod_python] mod_python 3.1.2b and directory indexes
Message-ID: <16344.38623.864766.807800@gargle.gargle.HOWL>


I upgraded to 3.1.2b recently and have noticed that when I reference
an URL that is a directory my request handler is never called, but
instead I get a directory index (assuming Option Indexes is specified,
if not I get a 403 error).  This didn't happen with 3.0.1 where
directory or file, my python request handler was called.

Anyone else notice this?

------------------
Daniel Popowich
Network Specialist
-------------------------------------
Mohawk Trail Regional School District
24 Ashfield Rd.
Shelburne Falls, MA 01370
413.625.0192 x22
-------------------------------------

From JTesser at nbbc.edu  Thu Dec 11 11:24:03 2003
From: JTesser at nbbc.edu (Jason Tesser)
Date: Fri Jan  9 22:00:37 2004
Subject: [mod_python] setup help
Message-ID: <04875CB4331F0240A0AD66F97097865101137707@paul>

I have the following script saved as test.py and saved under htdoc


From JTesser at nbbc.edu  Thu Dec 11 11:26:57 2003
From: JTesser at nbbc.edu (Jason Tesser)
Date: Fri Jan  9 22:00:37 2004
Subject: [mod_python] config help
Message-ID: <04875CB4331F0240A0AD66F97097865101137708@paul>

I have the folowing script saved as test.py under htdocs.

from mod_python import apache

def handler(req):
	req.write("Hello World!")
	return apache.OK

I cannot get it to execute properly with mod_python.  Here the configuration from my apache config file.

<Directory /srv/www/htdocs/>
  AddHandler python-program .py
  PythonHandler test
  #PythonHandler mod_python.publisher
  PythonDebug On
</Directory>
I tried uncommenting the publisher handler which doesn't work at all for me.  What am I missing :-s

From grisha at modpython.org  Thu Dec 11 12:36:16 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:00:37 2004
Subject: [mod_python] mod_python 3.1.2b and directory indexes
In-Reply-To: <16344.38623.864766.807800@gargle.gargle.HOWL>
References: <16344.38623.864766.807800@gargle.gargle.HOWL>
Message-ID: <20031211123551.N4056@onyx.ispol.com>


it's a bug. this has been fixed in the latest cvs.

On Thu, 11 Dec 2003, Daniel J. Popowich wrote:

>
> I upgraded to 3.1.2b recently and have noticed that when I reference
> an URL that is a directory my request handler is never called, but
> instead I get a directory index (assuming Option Indexes is specified,
> if not I get a 403 error).  This didn't happen with 3.0.1 where
> directory or file, my python request handler was called.
>
> Anyone else notice this?
>
> ------------------
> Daniel Popowich
> Network Specialist
> -------------------------------------
> Mohawk Trail Regional School District
> 24 Ashfield Rd.
> Shelburne Falls, MA 01370
> 413.625.0192 x22
> -------------------------------------
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From cs1spw at bath.ac.uk  Thu Dec 11 14:08:17 2003
From: cs1spw at bath.ac.uk (Simon Willison)
Date: Fri Jan  9 22:00:37 2004
Subject: [mod_python] mod_python 3.1.2b and directory indexes
In-Reply-To: <16344.38623.864766.807800@gargle.gargle.HOWL>
References: <16344.38623.864766.807800@gargle.gargle.HOWL>
Message-ID: <3FD8CEB1.3080000@bath.ac.uk>

Daniel J. Popowich wrote:

> I upgraded to 3.1.2b recently and have noticed that when I reference
> an URL that is a directory my request handler is never called, but
> instead I get a directory index (assuming Option Indexes is specified,
> if not I get a 403 error).  This didn't happen with 3.0.1 where
> directory or file, my python request handler was called.

I was hit by that one too. My solution was to ditch Directory directives 
entirely and switch to using Location instead, which appears to be a 
much more logical way of working with mod_python as handlers can live 
anywhere on the Python path, making Directory based handlers pretty much 
irrelevant.
From davidf at sjsoft.com  Fri Dec 12 17:20:17 2003
From: davidf at sjsoft.com (David Fraser)
Date: Fri Jan  9 22:00:37 2004
Subject: [mod_python] config help
In-Reply-To: <04875CB4331F0240A0AD66F97097865101137708@paul>
References: <04875CB4331F0240A0AD66F97097865101137708@paul>
Message-ID: <3FD9DCB1.3090004@sjsoft.com>

Jason Tesser wrote:

>I have the folowing script saved as test.py under htdocs.
>
>from mod_python import apache
>
>def handler(req):
>	req.write("Hello World!")
>	return apache.OK
>
>I cannot get it to execute properly with mod_python.  Here the configuration from my apache config file.
>  
>
When you say, you cannot get it to execute, you should describe exactly 
what you tried (the URL) and the response you got...

><Directory /srv/www/htdocs/>
>  AddHandler python-program .py
>  PythonHandler test
>  #PythonHandler mod_python.publisher
>  PythonDebug On
></Directory>
>I tried uncommenting the publisher handler which doesn't work at all for me.  What am I missing :-s
>  
>
Have you added the Python module (LoadModule etc) to the main apache 
configuration?

David
From jay at jaydorsey.com  Fri Dec 12 09:42:34 2003
From: jay at jaydorsey.com (Jay Dorsey)
Date: Fri Jan  9 22:00:37 2004
Subject: [mod_python] config help
In-Reply-To: <04875CB4331F0240A0AD66F97097865101137708@paul>
References: <04875CB4331F0240A0AD66F97097865101137708@paul>
Message-ID: <20031212154234.GA3929@gentoo.Earthlink.net>

On Thu, Dec 11, 2003 at 11:26:57AM -0600, Jason Tesser wrote:
> I have the folowing script saved as test.py under htdocs.
> 
> from mod_python import apache
> 
> def handler(req):
> 	req.write("Hello World!")
> 	return apache.OK
>

This looks fine

> I cannot get it to execute properly with mod_python.  Here the configuration from my apache config file.
> 
> <Directory /srv/www/htdocs/>
>   AddHandler python-program .py
>   PythonHandler test
>   #PythonHandler mod_python.publisher
>   PythonDebug On
> </Directory>

So does this, except for maybe that trailing slash on htdocs (I don't
have one in my setup, not sure if its required, disallowed, or 
allowed though).  Are you sure your restarted apache after you made the 
changes to your config file?  Have you checked the apache error logs
to see if you're getting any messages there?  Are you sure you're 
serving pages out of /srv/www/htdocs?  

-- 
Jay Dorsey
jay at jaydorsey dot com
From JTesser at nbbc.edu  Fri Dec 12 09:28:49 2003
From: JTesser at nbbc.edu (Jason Tesser)
Date: Fri Jan  9 22:00:38 2004
Subject: [mod_python] config help
Message-ID: <04875CB4331F0240A0AD66F9709786510113770D@paul>

HI,

>>I have the folowing script saved as test.py under htdocs.
>>
>>from mod_python import apache
>>
>>def handler(req):
>>	req.write("Hello World!")
>>	return apache.OK
>>
>>I cannot get it to execute properly with mod_python.  Here the configuration from my apache config file.
 
>
> When you say, you cannot get it to execute, you should describe exactly 
> what you tried (the URL) and the response you got...

It just prints the script on the page.

>> <Directory /srv/www/htdocs/>
>>  AddHandler python-program .py
>>  PythonHandler test
>>  #PythonHandler mod_python.publisher
>>  PythonDebug On
>> </Directory>
>> I tried uncommenting the publisher handler which doesn't work at all for me.  What am I missing :-s
>  
>
> Have you added the Python module (LoadModule etc) to the main apache 
> configuration?

Yes it is loaded.  

From dannoritzer at web.de  Fri Dec 12 19:09:36 2003
From: dannoritzer at web.de (=?ISO-8859-1?Q?G=FCnter_Dannoritzer?=)
Date: Fri Jan  9 22:00:38 2004
Subject: [mod_python] Problem with 'import' statement in 'execfile' script
Message-ID: <3FDA0460.1030406@web.de>

Hello,

I have a problem with a python script I try to execute from a publisher 
handler with the command 'execfile'.

The script starts with the following lines:

import sys
sys.path.append('/ab/system')
from Tools.Utilities import Utilities

So I have the module Utilities under /ab/system/Tools and extend my path 
first so that the following from/import statement will find it.

When I call the web page (my publisher handler with the 'execfile' 
command) I get the error message:

    ImportError: No module named Tools.Utilities

When I execute the same script with 'python <scriptname>' or 
'execfile(<scriptname>)' out of python, it is executed without errors. 
Even when I do it with the user apache is running as.

If I leave the 'sys.path.append' command out and execute the script by 
itself I get the error message as well. So the 'sys.path.append' must 
basically work, just not when using it with the publisher handler.

My configuration is:

Apache-AdvancedExtranetServer/2.0.47 (Mandrake Linux/6.1.92mdk) 
mod_python/3.1.0a Python/2.3

Can anybody tell me why I get the error with the publisher handler and 
not when I execute the script by itself?

Thanks for your help.

Guenter




From neel at mediapulse.com  Fri Dec 12 13:38:15 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:00:38 2004
Subject: [mod_python] Problem with 'import' statement in 'execfile' script
Message-ID: <C0FC22C08B82074A88B50061764157776B98B9@johnson.mediapulse.net>

> import sys
> sys.path.append('/ab/system')
> from Tools.Utilities import Utilities
> 

Have you tried using the PythonPath directive
(http://www.modpython.org/live/current/doc-html/dir-other-pp.html)?  I'm
not sure if setting the path inside the script is something you can do
(but again, I'm not sure).

Mike

From Vincent.Raaijmakers at ge.com  Fri Dec 12 12:42:47 2003
From: Vincent.Raaijmakers at ge.com (Raaijmakers, Vincent (IndSys, GE Interlogix))
Date: Fri Jan  9 22:00:38 2004
Subject: [mod_python] Problem with 'import' statement in 'execfile' script
Message-ID: <971323274247EB44B9A01D0A3B424C8504495618@FTWMLVEM02.e2k.ad.ge.com>

Is the package in your library/ site-packages ?
/usr/local/lib/python2.3/site-packages

and if so,

do you use perhaps soft links? ln -s /path_a/Tools /path_b/Tools
I had a lot of these issues using soft links.

Vincent

-----Original Message-----
From: mod_python-bounces@modpython.org
[mailto:mod_python-bounces@modpython.org]On Behalf Of G?nter Dannoritzer
Sent: Friday, December 12, 2003 1:10 PM
To: mod_python@modpython.org
Subject: [mod_python] Problem with 'import' statement in 'execfile'
script


Hello,

I have a problem with a python script I try to execute from a publisher 
handler with the command 'execfile'.

The script starts with the following lines:

import sys
sys.path.append('/ab/system')
from Tools.Utilities import Utilities

So I have the module Utilities under /ab/system/Tools and extend my path 
first so that the following from/import statement will find it.

When I call the web page (my publisher handler with the 'execfile' 
command) I get the error message:

    ImportError: No module named Tools.Utilities

When I execute the same script with 'python <scriptname>' or 
'execfile(<scriptname>)' out of python, it is executed without errors. 
Even when I do it with the user apache is running as.

If I leave the 'sys.path.append' command out and execute the script by 
itself I get the error message as well. So the 'sys.path.append' must 
basically work, just not when using it with the publisher handler.

My configuration is:

Apache-AdvancedExtranetServer/2.0.47 (Mandrake Linux/6.1.92mdk) 
mod_python/3.1.0a Python/2.3

Can anybody tell me why I get the error with the publisher handler and 
not when I execute the script by itself?

Thanks for your help.

Guenter




_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python

From kevin at sb.org  Fri Dec 12 15:07:24 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:00:38 2004
Subject: [mod_python] Trouble installing mod_python
Message-ID: <CD80C6EA-2CDE-11D8-BBFA-000A95A072FC@sb.org>

I'm running Mac OS X 10.3 with Apache 2 installed (via the Complete 
Apache 2 installer package) and I'm trying to install mod_python 
(latest from CVS). I ./configure and make and make install it fine, but 
when I add the LoadModule line to my httpd.conf file and do a Check 
Syntax I get the following error:

Syntax error on line 1099 of /Library/Apache2/conf/httpd.conf:
Cannot load /Library/Apache2/modules/mod_python.so into server: dyld: 
/Library/Apache2/bin/httpd Undefined symbols:
_PyExc_AttributeError
_PyExc_IOError
_PyExc_IndexError
_PyExc_KeyError
_PyExc_RuntimeError
_PyExc_StopIteration
_PyExc_TypeError
_PyExc_ValueError
_PyInt_Type
_PyList_Type
_PyObject_GenericGetAttr
_PyObject_GenericSetAttr
_PyString_Type
_PyType_Type
_Py_OptimizeFlag
__Py_NoneStruct
__Py_NotImplementedStruct

line 1099 is my LoadModule for mod_python. Why am I getting this error 
and how can I fix it?

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org


From michael at dynamine.net  Fri Dec 12 12:16:15 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 22:00:38 2004
Subject: [mod_python] Trouble installing mod_python
In-Reply-To: <CD80C6EA-2CDE-11D8-BBFA-000A95A072FC@sb.org>
References: <CD80C6EA-2CDE-11D8-BBFA-000A95A072FC@sb.org>
Message-ID: <3FDA220F.1050506@dynamine.net>

The default Makefile that configure creates is not quite right on OS X.

Assuming you've installed Fink and the python22 package (which is an 
implicit prerequisite for mod_python on OS X), you'll need to run 
configure like so:

env LDFLAGS="-L/sw/lib/python2.2/config -lpython2.2" ./configure

Also note that even though you've already told mod_python the path to 
python, you'll need to tell it again by prepending /sw/bin to the PATH 
before executing Apache 2.0.

--Michael

Kevin Ballard wrote:
> I'm running Mac OS X 10.3 with Apache 2 installed (via the Complete 
> Apache 2 installer package) and I'm trying to install mod_python (latest 
> from CVS). I ./configure and make and make install it fine, but when I 
> add the LoadModule line to my httpd.conf file and do a Check Syntax I 
> get the following error:
> 
> Syntax error on line 1099 of /Library/Apache2/conf/httpd.conf:
> Cannot load /Library/Apache2/modules/mod_python.so into server: dyld: 
> /Library/Apache2/bin/httpd Undefined symbols:
> _PyExc_AttributeError
> _PyExc_IOError
> _PyExc_IndexError
> _PyExc_KeyError
> _PyExc_RuntimeError
> _PyExc_StopIteration
> _PyExc_TypeError
> _PyExc_ValueError
> _PyInt_Type
> _PyList_Type
> _PyObject_GenericGetAttr
> _PyObject_GenericSetAttr
> _PyString_Type
> _PyType_Type
> _Py_OptimizeFlag
> __Py_NoneStruct
> __Py_NotImplementedStruct
> 
> line 1099 is my LoadModule for mod_python. Why am I getting this error 
> and how can I fix it?
> 
From kevin at sb.org  Fri Dec 12 15:21:11 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:00:38 2004
Subject: [mod_python] Trouble installing mod_python
In-Reply-To: <3FDA220F.1050506@dynamine.net>
References: <CD80C6EA-2CDE-11D8-BBFA-000A95A072FC@sb.org>
	<3FDA220F.1050506@dynamine.net>
Message-ID: <BA40ABC9-2CE0-11D8-BBFA-000A95A072FC@sb.org>

Why would I want to install python2.2 when OS X comes with Python 2.3?  
And why is this a prerequisite when the include files are in  
/System/Library/Frameworks/Python.framework/Versions/2.3/include/ 
python2.3/ and the makefile can find them?

On Dec 12, 2003, at 3:16 PM, Michael S. Fischer wrote:

> The default Makefile that configure creates is not quite right on OS X.
>
> Assuming you've installed Fink and the python22 package (which is an  
> implicit prerequisite for mod_python on OS X), you'll need to run  
> configure like so:
>
> env LDFLAGS="-L/sw/lib/python2.2/config -lpython2.2" ./configure
>
> Also note that even though you've already told mod_python the path to  
> python, you'll need to tell it again by prepending /sw/bin to the PATH  
> before executing Apache 2.0.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org


From michael at dynamine.net  Fri Dec 12 12:36:06 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 22:00:38 2004
Subject: [mod_python] Trouble installing mod_python
In-Reply-To: <BA40ABC9-2CE0-11D8-BBFA-000A95A072FC@sb.org>
References: <CD80C6EA-2CDE-11D8-BBFA-000A95A072FC@sb.org>
	<3FDA220F.1050506@dynamine.net> <BA40ABC9-2CE0-11D8-BBFA-000A95A072FC@sb.org>
Message-ID: <3FDA26B6.9010809@dynamine.net>

I'm just telling you what works for me.  (I'm running OS X Server 10.2, 
and so YMMV).

Do you know if OS X Server 10.3 ships with libpython2.3.a or 
libpython2.3.dylib?  If not, you'll still need Fink and the python2.2 
package.

I wouldn't fret it about too much unless there's some Python 2.3 feature 
that is absolutely required for your application.

--Michael

Kevin Ballard wrote:

> Why would I want to install python2.2 when OS X comes with Python 2.3?  
> And why is this a prerequisite when the include files are in  
> /System/Library/Frameworks/Python.framework/Versions/2.3/include/ 
> python2.3/ and the makefile can find them?
> 
> On Dec 12, 2003, at 3:16 PM, Michael S. Fischer wrote:
> 
>> The default Makefile that configure creates is not quite right on OS X.
>>
>> Assuming you've installed Fink and the python22 package (which is an  
>> implicit prerequisite for mod_python on OS X), you'll need to run  
>> configure like so:
>>
>> env LDFLAGS="-L/sw/lib/python2.2/config -lpython2.2" ./configure
>>
>> Also note that even though you've already told mod_python the path to  
>> python, you'll need to tell it again by prepending /sw/bin to the 
>> PATH  before executing Apache 2.0.
> 
> 
From alexiev at activesolutions.bg  Sat Dec 13 14:41:30 2003
From: alexiev at activesolutions.bg (Alexiev Nikolay)
Date: Fri Jan  9 22:00:38 2004
Subject: [mod_python] response content-type
Message-ID: <001401c3c176$6f0228a0$0a01010a@dev1>

How can I change content-type of respons, using publisher handler ?


---------------------------------------
Best regards,
Alexiev, Nikolay
e-mail: alexiev@activesolutions.bg
phone: +359 2 8753543
From dannoritzer at web.de  Sat Dec 13 13:41:29 2003
From: dannoritzer at web.de (=?ISO-8859-1?Q?G=FCnter_Dannoritzer?=)
Date: Fri Jan  9 22:00:38 2004
Subject: [mod_python] Problem with 'import' statement in 'execfile' script
In-Reply-To: <C0FC22C08B82074A88B50061764157776B98B9@johnson.mediapulse.net>
References: <C0FC22C08B82074A88B50061764157776B98B9@johnson.mediapulse.net>
Message-ID: <3FDB08F9.3050706@web.de>

Thanks for all the help I got on this problem.

Mike,

I was not able to test the 'PythonPath' directive yet, but I did add the 
sys.path.append to the publisher handler script and it worked.

It seems like I cannot modify the sys.path in a script I call with the 
execfile command when using mod_python.

Guenter


Michael C. Neel wrote:

>>import sys
>>sys.path.append('/ab/system')
>>from Tools.Utilities import Utilities
>>
>>    
>>
>
>Have you tried using the PythonPath directive
>(http://www.modpython.org/live/current/doc-html/dir-other-pp.html)?  I'm
>not sure if setting the path inside the script is something you can do
>(but again, I'm not sure).
>
>Mike
>
>  
>


From stian at soiland.no  Sat Dec 13 19:26:19 2003
From: stian at soiland.no (Stian =?iso-8859-1?Q?S=F8iland?=)
Date: Fri Jan  9 22:00:38 2004
Subject: [mod_python] Re: response content-type
In-Reply-To: <001401c3c176$6f0228a0$0a01010a@dev1>
References: <001401c3c176$6f0228a0$0a01010a@dev1>
Message-ID: <20031213182619.GA18517@itea.ntnu.no>

On 2003-12-13 13:41:30, Alexiev Nikolay wrote:

> How can I change content-type of respons, using publisher handler ?

Include req as first parameter, and set req.content_type.

def test(req):
    req.content_type = "image/jpeg"
    image = open("/somewhere/blapp.jpeg").read()
    return image

-- 
Stian S?iland               Work toward win-win situation. Win-lose
Trondheim, Norway           is where you win and the other lose.
http://www.soiland.no/      Lose-lose and lose-win are left as an
                            exercise to the reader.  [Limoncelli/Hogan]

From greenbeard400 at yahoo.com  Sat Dec 13 16:52:26 2003
From: greenbeard400 at yahoo.com (Greenbeard)
Date: Fri Jan  9 22:00:38 2004
Subject: [mod_python] Problem downloading the Full Archives
Message-ID: <20031214005226.99770.qmail@web21327.mail.yahoo.com>

When I went to this url:

http://mailman.modpython.org/pipermail/mod_python.mbox/mod_python.mbox

I only got about 1k of data - mail through Wed Jan 31,
2001.  Is there a different url/way to get the
archives?   I can not seem to locate  it. 

Thanks! 

gb400

__________________________________
Do you Yahoo!?
Free Pop-Up Blocker - Get it now
http://companion.yahoo.com/
From ron at UDel.Edu  Mon Dec 15 09:17:27 2003
From: ron at UDel.Edu (Ron Reisor)
Date: Fri Jan  9 22:00:38 2004
Subject: [mod_python] Trouble installing mod_python
In-Reply-To: <CD80C6EA-2CDE-11D8-BBFA-000A95A072FC@sb.org>
References: <CD80C6EA-2CDE-11D8-BBFA-000A95A072FC@sb.org>
Message-ID: <Pine.SOL.4.58L.0312150838270.10512@copland.udel.edu>

Kevin,

   The mod_python.so that is built doesn't depend on other needed shared
libraries.  This seems to be the result of how it is built by apxs.  I'm
not sure of the best way to get this problem resolved, but we have been
able to work around the problems. This is a little messy though:

   Build ssl and apache2.0.48 in /usr/local.  MacOSX 10.3 will use shared
libraries in /usr/local/lib without any changes.  The only thing I think
is special about the apache build is to specify --with-mpm=worker so you
get thread support

   Rebuild Python-2.3. I recommend 2.3.2 which includes some patches that
are important to us, but 2.3 works.  2.3.3c1 seems fine so far.  We
replaced the Apple supplied Python in preference for the latest version.
This replaces files in /Applications/MacPython-2.3 and
/Library/Frameworks/Python.framework and /usr/local/bin.  Build like:

./configure --enable-framework
make
make frameworkinstall

   To build mod_python, get the latest cvs.  It includes patches for
Python-2.3 memory/object allocation that will matter on MacOSX.  Build it
as usual to start:

./configure --with-apxs=/usr/local/bin/apxs
make
su
make install

   But, the apxs will use the gnu libtool and what you end up with is a
mod_python.so that doesn't have the right dependencies.  You can check
this with otool:

[roaming-163-213:~/macpython/httpd-python] ron% otool -L
src/.libs/mod_python.so
src/.libs/mod_python.so:
        /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current
version 71.0.0)
[roaming-163-213:~/macpython/httpd-python] ron%

   Key libraries, like Python, are missing.  So, here's the really messy
part.  Remove the mod_python.so link from src and run this command in the
src directory:

libtool -o mod_python.so -dynamic -flat_namespace -undefined suppress
hlistobject.o hlist.o filterobject.o connobject.o serverobject.o util.o
tableobject.o requestobject.o _apachemodule.o mod_python.o -framework
System -lcc_dynamic -arch_only ppc -framework Python -framework
CoreServices -framework Foundation -lm

   That should be all one shell command line.  One important difference
here is that the libtool you use is the Apple supplied libtool, not the
gnu libtool that apxs would normally use.  Also, there's switches in there
that I don't know how to get apxs to generate. If you check this with
otool you should see:

[roaming-163-213:~/macpython/httpd-python/src] ron% otool -L mod_python.so
mod_python.so:
        mod_python.so (compatibility version 0.0.0, current version 0.0.0)
        /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current
version 71.0.0)
        /Library/Frameworks/Python.framework/Versions/2.3/Python
(compatibility version 2.3.0, current version 2.3.0)

/System/Library/Frameworks/CoreServices.framework/Versions/A/CoreServices
(compatibility version 1.0.0, current version 16.0.0)

/System/Library/Frameworks/Foundation.framework/Versions/C/Foundation
(compatibility version 300.0.0, current version 500.5.0)
[roaming-163-213:~/macpython/httpd-python/src] ron%

   Then, copy the mod_python.so into the /usr/local/modules directory.

cheers,

Ron


On Fri, 12 Dec 2003, Kevin Ballard wrote:

> I'm running Mac OS X 10.3 with Apache 2 installed (via the Complete
> Apache 2 installer package) and I'm trying to install mod_python
> (latest from CVS). I ./configure and make and make install it fine, but
> when I add the LoadModule line to my httpd.conf file and do a Check
> Syntax I get the following error:
>
> Syntax error on line 1099 of /Library/Apache2/conf/httpd.conf:
> Cannot load /Library/Apache2/modules/mod_python.so into server: dyld:
> /Library/Apache2/bin/httpd Undefined symbols:
> _PyExc_AttributeError
> _PyExc_IOError
> _PyExc_IndexError
> _PyExc_KeyError
> _PyExc_RuntimeError
> _PyExc_StopIteration
> _PyExc_TypeError
> _PyExc_ValueError
> _PyInt_Type
> _PyList_Type
> _PyObject_GenericGetAttr
> _PyObject_GenericSetAttr
> _PyString_Type
> _PyType_Type
> _Py_OptimizeFlag
> __Py_NoneStruct
> __Py_NotImplementedStruct
>
> line 1099 is my LoadModule for mod_python. Why am I getting this error
> and how can I fix it?
>
> --
> Kevin Ballard
> kevin@sb.org
> http://www.tildesoft.com
> http://kevin.sb.org
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

Ron Reisor <ron@udel.edu> (RWR3)
University of Delaware Information Technologies/Network and Systems Services
Computing Center/192 South Chapel Street/Newark DE, 19716
pgp finger print: 0D 73 06 6F D3 6A 99 D3  F5 D5 6E FF 3B B9 7C 2C
From mark at gsoa.net  Mon Dec 15 13:33:23 2003
From: mark at gsoa.net (Mark McClain)
Date: Fri Jan  9 22:00:38 2004
Subject: [mod_python] re: trouble installing mod_python
Message-ID: <2A3E42DA-2F2D-11D8-A794-000A95B33D28@gsoa.net>

I've been able to build mod_python on 10.3 making very few changes.   
This process uses python 2.3 that comes with 10.3.  The problem that 
you are experiencing is because the linker does not get told to link to 
the python framework by apxs.

mark

1) Build and install apache2

2) Unpack the mod_python distribution

3) make the following changes to the configure script. here it is in 
modified form...

if test "$PyFRAMEWORKDIR" != "no-framework"; then
   if test -n "$PyFRAMEWORK"; then
     PyPYTHONLIBS="-framework $PyFRAMEWORK"

    # explicitly pass to mac linker so add this line
     LDFLAGS="${LDFLAGS} -Wl,-framework,Python"
   fi

4) run configure, make, then install

Good luck,

mark

From kevin at sb.org  Mon Dec 15 14:28:21 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:00:38 2004
Subject: [mod_python] re: trouble installing mod_python
In-Reply-To: <2A3E42DA-2F2D-11D8-A794-000A95B33D28@gsoa.net>
References: <2A3E42DA-2F2D-11D8-A794-000A95B33D28@gsoa.net>
Message-ID: <D7A8AD94-2F34-11D8-B6D0-000A95A072FC@sb.org>

Wow, that worked great! Thanks!

On Dec 15, 2003, at 1:33 PM, Mark McClain wrote:

> 1) Build and install apache2
>
> 2) Unpack the mod_python distribution
>
> 3) make the following changes to the configure script. here it is in 
> modified form...
>
> if test "$PyFRAMEWORKDIR" != "no-framework"; then
>   if test -n "$PyFRAMEWORK"; then
>     PyPYTHONLIBS="-framework $PyFRAMEWORK"
>
>    # explicitly pass to mac linker so add this line
>     LDFLAGS="${LDFLAGS} -Wl,-framework,Python"
>   fi
>
> 4) run configure, make, then install

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org


From kevin at sb.org  Mon Dec 15 14:57:12 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:00:38 2004
Subject: [mod_python] re: trouble installing mod_python
In-Reply-To: <2A3E42DA-2F2D-11D8-A794-000A95B33D28@gsoa.net>
References: <2A3E42DA-2F2D-11D8-A794-000A95B33D28@gsoa.net>
Message-ID: <DFBB3B11-2F38-11D8-B6D0-000A95A072FC@sb.org>

I tested my new mod_python and it's not working. The server log has 
nothing telling me why I'm getting an error, but if I try to run the 
mptest.py file myself from python, I get an error saying that in 
apache.py, on the import _apache line, there's no module named _apache.

What's going on and how do I fix this?

On Dec 15, 2003, at 1:33 PM, Mark McClain wrote:

> I've been able to build mod_python on 10.3 making very few changes.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org


From kevin at sb.org  Mon Dec 15 15:09:23 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:00:38 2004
Subject: [mod_python] re: trouble installing mod_python
In-Reply-To: <DFBB3B11-2F38-11D8-B6D0-000A95A072FC@sb.org>
References: <2A3E42DA-2F2D-11D8-A794-000A95B33D28@gsoa.net>
	<DFBB3B11-2F38-11D8-B6D0-000A95A072FC@sb.org>
Message-ID: <931CB23E-2F3A-11D8-B6D0-000A95A072FC@sb.org>

Argh, please ignore this. I realize now that _apache is provided by 
mod_python, and I also discovered the source of my form.py problem. I 
also discovered how mptest.py was failing, but I don't know why yet 
(but I will find out).

Anyway, sorry to bother you.

On Dec 15, 2003, at 2:57 PM, Kevin Ballard wrote:

> I tested my new mod_python and it's not working. The server log has 
> nothing telling me why I'm getting an error, but if I try to run the 
> mptest.py file myself from python, I get an error saying that in 
> apache.py, on the import _apache line, there's no module named 
> _apache.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org


From tim.stebbing at nunatak.com.au  Tue Dec 16 09:54:37 2003
From: tim.stebbing at nunatak.com.au (Timothy Stebbing)
Date: Fri Jan  9 22:00:38 2004
Subject: [mod_python] creating apache modules with mod_python
Message-ID: <3FDE3BAD.2050406@nunatak.com.au>

Is it possible to create apache modules using mod_python? I want to 
create a new protocol module for apache2.0, is there any info on doing 
this sort ofthing with mod_python, or has anyone done this sort of thing 
yet?

From kevin at sb.org  Mon Dec 15 19:29:08 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:00:38 2004
Subject: [mod_python] Strange server errors
Message-ID: <DC81D053-2F5E-11D8-B6D0-000A95A072FC@sb.org>

This is really strange. I tested my form.py thing from the Tutorial and 
it would just hang. I'd get absolutely no response from the server. I 
tried a few times, and then I started getting internal server errors 
instead, but with nothing in the error log. So I quit Apache and 
started httpd back up in single process mode (sudo ./httpd 
-DONE_PROCESS, as per the Troubleshooting section). At that point, my 
scripts magically started working (with no output to the shell from 
httpd). I then quit that and started Apache back up normally, and my 
scripts continue to work. Any idea what was going on, in case this 
weird stuff happens again?

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org


From tim.stebbing at nunatak.com.au  Tue Dec 16 12:30:34 2003
From: tim.stebbing at nunatak.com.au (Timothy Stebbing)
Date: Fri Jan  9 22:00:38 2004
Subject: [mod_python] PythonConnectionHandler directive
Message-ID: <3FDE603A.3010100@nunatak.com.au>

Howdy,

Im trying to get a simple protocol handler running, yet apache does not 
seem to be calling my code.

I have this in my apache config, this starts without any errors:

Listen 192.168.0.18:4444
<VirtualHost 192.168.0.18:4444>
        ServerAdmin webmaster@localhost
        DocumentRoot /var/www/nunatak/
        ErrorLog /tmp/test-error.log
        LogLevel debug
        PythonConnectionHandler protocol
</VirtualHost>

in /var/www/nunatak/protocol.py:

from mod_python import apache
 
def connectionhandler(conn):
    conn.write("Hello!")
    f = open("/tmp/foo.log", "w+")
    f.write("foo happened!\n")
    f.close()
    return apache.OK

when I telnet to localhost 4444 I get:

Trying 192.168.0.18...
Connected to balrog.localnet.
Escape character is '^]'.
Connection closed by foreign host.

I have no /tmp/foo.log at all, which makes me think the script has not 
been located/run

in my ErrorLog for the virtual host I have:
[Tue Dec 16 23:26:23 2003] [error] python_connection: 
ConnectionDispatch() returned nothing.


Im guessing its a problem with my virtualhost definition not being set 
up correctly, but in the docs
for mod_python there is not much more info on this subject.

-tjs


From kevin at sb.org  Mon Dec 15 21:05:45 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:00:38 2004
Subject: [mod_python] Strange server errors
In-Reply-To: <DC81D053-2F5E-11D8-B6D0-000A95A072FC@sb.org>
References: <DC81D053-2F5E-11D8-B6D0-000A95A072FC@sb.org>
Message-ID: <5C2E79EA-2F6C-11D8-B6D0-000A95A072FC@sb.org>

Argh. Sorry for bothering you with my problems. I just found the cause 
and it's not mod_python's fault. The problem is doing a graceful 
restart of apache isn't actually restarting properly, which is causing 
conflicts when accessing python scripts. If I stop the server, wait for 
it to finish shutting down, then start it back up, everything works 
just fine.

On Dec 15, 2003, at 7:29 PM, Kevin Ballard wrote:

> This is really strange. I tested my form.py thing from the Tutorial 
> and it would just hang. I'd get absolutely no response from the 
> server. I tried a few times, and then I started getting internal 
> server errors instead, but with nothing in the error log. So I quit 
> Apache and started httpd back up in single process mode (sudo ./httpd 
> -DONE_PROCESS, as per the Troubleshooting section). At that point, my 
> scripts magically started working (with no output to the shell from 
> httpd). I then quit that and started Apache back up normally, and my 
> scripts continue to work. Any idea what was going on, in case this 
> weird stuff happens again?

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org


From grisha at modpython.org  Mon Dec 15 22:37:51 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:00:38 2004
Subject: [mod_python] PythonConnectionHandler directive
In-Reply-To: <3FDE603A.3010100@nunatak.com.au>
References: <3FDE603A.3010100@nunatak.com.au>
Message-ID: <20031215223427.U71289@onyx.ispol.com>


I think the problem is the python path. Try making sure that the directory
where protocol.py is located is added to PythonPath:

PythonPath "sys.path+['/var/www/nunatak']"

Since this is a connection handler, the DocumentRoot is irrelevant and
the path in it has no effect.

Grisha

On Tue, 16 Dec 2003, Timothy Stebbing wrote:

> Howdy,
>
> Im trying to get a simple protocol handler running, yet apache does not
> seem to be calling my code.
>
> I have this in my apache config, this starts without any errors:
>
> Listen 192.168.0.18:4444
> <VirtualHost 192.168.0.18:4444>
>         ServerAdmin webmaster@localhost
>         DocumentRoot /var/www/nunatak/
>         ErrorLog /tmp/test-error.log
>         LogLevel debug
>         PythonConnectionHandler protocol
> </VirtualHost>
>
> in /var/www/nunatak/protocol.py:
>
> from mod_python import apache
>
> def connectionhandler(conn):
>     conn.write("Hello!")
>     f = open("/tmp/foo.log", "w+")
>     f.write("foo happened!\n")
>     f.close()
>     return apache.OK
>
> when I telnet to localhost 4444 I get:
>
> Trying 192.168.0.18...
> Connected to balrog.localnet.
> Escape character is '^]'.
> Connection closed by foreign host.
>
> I have no /tmp/foo.log at all, which makes me think the script has not
> been located/run
>
> in my ErrorLog for the virtual host I have:
> [Tue Dec 16 23:26:23 2003] [error] python_connection:
> ConnectionDispatch() returned nothing.
>
>
> Im guessing its a problem with my virtualhost definition not being set
> up correctly, but in the docs
> for mod_python there is not much more info on this subject.
>
> -tjs
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From ron at UDel.Edu  Tue Dec 16 08:35:33 2003
From: ron at UDel.Edu (Ron Reisor)
Date: Fri Jan  9 22:00:38 2004
Subject: [mod_python] re: trouble installing mod_python
In-Reply-To: <2A3E42DA-2F2D-11D8-A794-000A95B33D28@gsoa.net>
References: <2A3E42DA-2F2D-11D8-A794-000A95B33D28@gsoa.net>
Message-ID: <Pine.SOL.4.58L.0312160832400.12072@copland.udel.edu>

Mark,

   This patch works well for us too.

   Forget the hack I offered.

   Would you suggest this to python-dev@httpd.apache.org to see if it can
get added to the distribution?

thanks,

Ron


On Mon, 15 Dec 2003, Mark McClain wrote:

> I've been able to build mod_python on 10.3 making very few changes.
> This process uses python 2.3 that comes with 10.3.  The problem that
> you are experiencing is because the linker does not get told to link to
> the python framework by apxs.
>
> mark
>
> 1) Build and install apache2
>
> 2) Unpack the mod_python distribution
>
> 3) make the following changes to the configure script. here it is in
> modified form...
>
> if test "$PyFRAMEWORKDIR" != "no-framework"; then
>    if test -n "$PyFRAMEWORK"; then
>      PyPYTHONLIBS="-framework $PyFRAMEWORK"
>
>     # explicitly pass to mac linker so add this line
>      LDFLAGS="${LDFLAGS} -Wl,-framework,Python"
>    fi
>
> 4) run configure, make, then install
>
> Good luck,
>
> mark
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

Ron Reisor <ron@udel.edu> (RWR3)
University of Delaware Information Technologies/Network and Systems Services
Computing Center/192 South Chapel Street/Newark DE, 19716
pgp finger print: 0D 73 06 6F D3 6A 99 D3  F5 D5 6E FF 3B B9 7C 2C
From fccoelho at fiocruz.br  Wed Dec 17 15:07:53 2003
From: fccoelho at fiocruz.br (Flavio C. Coelho)
Date: Fri Jan  9 22:00:38 2004
Subject: [mod_python] mod_python and the semaphore bug
Message-ID: <1071680872.3902.13.camel@pinguim.procc.fiocruz.br>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: fiocruz4.jpg
Type: image/jpeg
Size: 3085 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20031217/2a49fe91/fiocruz4-0002.jpg
From giampiero.benvenuti at chiaroscuro.com  Wed Dec 17 18:31:39 2003
From: giampiero.benvenuti at chiaroscuro.com (Giampiero Benvenuti)
Date: Fri Jan  9 22:00:38 2004
Subject: [mod_python] mod_python & MySQLdb question
Message-ID: <DF4889B2-30B6-11D8-9E76-003065D5834A@chiaroscuro.com>

Hello to all of you,

I'm quite intrigued by mod_python and the difference with "normal" 
python cgi...

for instance: I can't make this great pice of code (Jaroslaw Zabiello, 
http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/171463) wich 
works great in my cgi-bin directory, working with mod_python.

The problem I have is right at the end, when I have to deal with:

  for row in rows:
     print row['name'], row['txt']

The question is: how can I translate this last part of code to make it 
working with mod_python?

the great code:
----------------------------------
import MySQLdb
import MySQLdb.cursors

conn = MySQLdb.Connect(
     host='localhost', user='root',
     passwd='', db='test',compress=1,
     cursorclass=MySQLdb.cursors.DictCursor) # <- important
cursor = conn.cursor()
cursor.execute("SELECT name, sometext txt FROM foo")
rows = cursor.fetchall()
cursor.close()
conn.close()

for row in rows:
     print row['name'], row['txt'] # bingo!
------------------------------------

any help is much appreciated.

Thanks,

Giampiero

From tpc at csua.berkeley.edu  Wed Dec 17 09:40:52 2003
From: tpc at csua.berkeley.edu (tpc@csua.berkeley.edu)
Date: Fri Jan  9 22:00:38 2004
Subject: [mod_python] mod_python & MySQLdb question
In-Reply-To: <DF4889B2-30B6-11D8-9E76-003065D5834A@chiaroscuro.com>
Message-ID: <20031217093408.M44175-100000@localhost.name>


hi Giampiero, instead of print or echo, you use return or req.write.  I
had a similar question here:

http://www.modpython.org/pipermail/mod_python/2003-June/003263.html

I hope that helps you.

On Wed, 17 Dec 2003, Giampiero Benvenuti wrote:

> Hello to all of you,
>
> I'm quite intrigued by mod_python and the difference with "normal"
> python cgi...
>
> for instance: I can't make this great pice of code (Jaroslaw Zabiello,
> http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/171463) wich
> works great in my cgi-bin directory, working with mod_python.
>
> The problem I have is right at the end, when I have to deal with:
>
>   for row in rows:
>      print row['name'], row['txt']
>
> The question is: how can I translate this last part of code to make it
> working with mod_python?
>
> the great code:
> ----------------------------------
> import MySQLdb
> import MySQLdb.cursors
>
> conn = MySQLdb.Connect(
>      host='localhost', user='root',
>      passwd='', db='test',compress=1,
>      cursorclass=MySQLdb.cursors.DictCursor) # <- important
> cursor = conn.cursor()
> cursor.execute("SELECT name, sometext txt FROM foo")
> rows = cursor.fetchall()
> cursor.close()
> conn.close()
>
> for row in rows:
>      print row['name'], row['txt'] # bingo!
> ------------------------------------
>
> any help is much appreciated.
>
> Thanks,
>
> Giampiero
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>


From jciccale at mac.com  Wed Dec 17 23:37:11 2003
From: jciccale at mac.com (Julian Ciccale)
Date: Fri Jan  9 22:00:38 2004
Subject: [mod_python] mod_python and the semaphore bug
Message-ID: <8794402.1071700631675.JavaMail.jciccale@mac.com>

Try checking out the latest CVS sources of line 3.1.x . I think this problem is solved in
the CVS.

- julcicc - 
On Wednesday, December 17, 2003, at 06:07PM, Flavio C. Coelho <fccoelho@fiocruz.br> wrote:

>
><<Original Attached>>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20031217/439af9da/attachment-0002.htm
From tim.stebbing at nunatak.com.au  Thu Dec 18 10:14:40 2003
From: tim.stebbing at nunatak.com.au (Timothy Stebbing)
Date: Fri Jan  9 22:00:38 2004
Subject: [mod_python] Persistant data
Message-ID: <3FE0E360.4060002@nunatak.com.au>

Is there some way to persist data resource using apache? Im writing a 
simple protocol module
using PythonConnectionHandler, this takes queries and runs them against 
various backends,
ie postgres, Lupy (indexer), etc. I want to persist my connections to 
these resources across all
requests.

Ive tried adding a db 'pool' into a module, but the module is reloaded 
for each request serviced.

Im wondering if there is some way I can add objects into these 'apache 
tables' ? would that make
them persistant, and if so how do I do that? I was also wondering if I 
could somehow access the
main namespace from child interpreters?

cheers

tjs

From michael at dynamine.net  Wed Dec 17 15:21:29 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 22:00:38 2004
Subject: [mod_python] Persistant data
In-Reply-To: <3FE0E360.4060002@nunatak.com.au>
References: <3FE0E360.4060002@nunatak.com.au>
Message-ID: <3FE0E4F9.8010302@dynamine.net>

In the interest of keeping it simple, I suggest you store your 
persistent data using anydbm and use synchronization techniques (i.e. 
rename) to ensure that two processes don't try to write to the database 
simultaneously (mid-air collision).  Other techniques just give you more 
code complexity and not much added benefit.

This is pretty much exactly what the new session code in 3.1.2b does.

--Michael

Timothy Stebbing wrote:

> Is there some way to persist data resource using apache? Im writing a 
> simple protocol module
> using PythonConnectionHandler, this takes queries and runs them against 
> various backends,
> ie postgres, Lupy (indexer), etc. I want to persist my connections to 
> these resources across all
> requests.
> 
> Ive tried adding a db 'pool' into a module, but the module is reloaded 
> for each request serviced.
> 
> Im wondering if there is some way I can add objects into these 'apache 
> tables' ? would that make
> them persistant, and if so how do I do that? I was also wondering if I 
> could somehow access the
> main namespace from child interpreters?
> 
> cheers
> 
> tjs
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 
From kevin at sb.org  Wed Dec 17 19:00:47 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:00:38 2004
Subject: [mod_python] config tree for htaccess
Message-ID: <3B9F1328-30ED-11D8-B6D0-000A95A072FC@sb.org>

Is there any way to get the config tree from any relevant .htaccess 
files as well as just the httpd.conf file, or do I have to look for and 
parse them manually? Also, is there any way to get the applicable 
config lines from the httpd.conf file, i.e. the ones inside 
<Directory>/<Files>/etc. blocks that apply to the current URI without 
having to parse them all manually?

I'm writing a script that mimics FancyIndexing and it's mostly done 
(i.e. it does just about everything except let you sort by headers, 
including scanning the AddIcon/AddIconByType/AddDescription lines in 
apache.config_tree(), and looks identical to the FancyIndexing in the 
rendered version (i.e. the source is cleaner, but the result is 
identical)), but it only uses the config directives in the root of 
httpd.conf (i.e. the root of apache.config_tree()) and I'd like to make 
it use all applicable directives.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org


From giampiero.benvenuti at chiaroscuro.com  Thu Dec 18 01:54:59 2003
From: giampiero.benvenuti at chiaroscuro.com (Giampiero Benvenuti)
Date: Fri Jan  9 22:00:38 2004
Subject: [mod_python] mod_python & MySQLdb question
In-Reply-To: <20031217093408.M44175-100000@localhost.name>
Message-ID: <CE1FDA4E-30F4-11D8-9E76-003065D5834A@chiaroscuro.com>

Thanks for your prompt answer and your help.

I'm coming from Zope, just got to mod_python a week ago. Please 
understand my being na?ve.

I'm not quite there yet: thanks to your help now I'm able to get all my 
titles form mysql, but at the
end of the page (sigh) I get an apache error: "500 Internal Server 
Error"
"The server encountered an internal error or misconfiguration and was 
unable to complete your request..."

Apache is not OK at all.

here is my code:

import MySQLdb, MySQLdb.cursors
from mod_python import apache

def read(req):
	req.content_type = "text/html"
	mydb = MySQLdb.connect(db='S_N', user='giampiero', compress=1, 
cursorclass=MySQLdb.cursors.DictCursor)
	cursor = mydb.cursor()
	stmt = "SELECT news_title FROM news"
	cursor.execute(stmt)
	rows = cursor.fetchall()
	mydb.close()
	for row in rows:
		s = row['news_title']
		print s
	return apache.OK

Thank you guys,

Giampiero





On Mercoled?, dic 17, 2003, at 18:40 Europe/Rome, 
<tpc@csua.berkeley.edu> wrote:

>
> hi Giampiero, instead of print or echo, you use return or req.write.  I
> had a similar question here:
>
> http://www.modpython.org/pipermail/mod_python/2003-June/003263.html
>
> I hope that helps you.
>
> On Wed, 17 Dec 2003, Giampiero Benvenuti wrote:
>
>> Hello to all of you,
>>
>> I'm quite intrigued by mod_python and the difference with "normal"
>> python cgi...
>>
>> for instance: I can't make this great pice of code (Jaroslaw Zabiello,
>> http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/171463) wich
>> works great in my cgi-bin directory, working with mod_python.
>>
>> The problem I have is right at the end, when I have to deal with:
>>
>>   for row in rows:
>>      print row['name'], row['txt']
>>
>> The question is: how can I translate this last part of code to make it
>> working with mod_python?
>>
>> the great code:
>> ----------------------------------
>> import MySQLdb
>> import MySQLdb.cursors
>>
>> conn = MySQLdb.Connect(
>>      host='localhost', user='root',
>>      passwd='', db='test',compress=1,
>>      cursorclass=MySQLdb.cursors.DictCursor) # <- important
>> cursor = conn.cursor()
>> cursor.execute("SELECT name, sometext txt FROM foo")
>> rows = cursor.fetchall()
>> cursor.close()
>> conn.close()
>>
>> for row in rows:
>>      print row['name'], row['txt'] # bingo!
>> ------------------------------------
>>
>> any help is much appreciated.
>>
>> Thanks,
>>
>> Giampiero
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>
>
>
>


From michael at dynamine.net  Wed Dec 17 16:57:47 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 22:00:39 2004
Subject: [mod_python] mod_python & MySQLdb question
In-Reply-To: <CE1FDA4E-30F4-11D8-9E76-003065D5834A@chiaroscuro.com>
References: <CE1FDA4E-30F4-11D8-9E76-003065D5834A@chiaroscuro.com>
Message-ID: <3FE0FB8B.3050200@dynamine.net>

What does the Apache error log have to say about it?

--Michael

Giampiero Benvenuti wrote:

> Thanks for your prompt answer and your help.
> 
> I'm coming from Zope, just got to mod_python a week ago. Please 
> understand my being na?ve.
> 
> I'm not quite there yet: thanks to your help now I'm able to get all my 
> titles form mysql, but at the
> end of the page (sigh) I get an apache error: "500 Internal Server Error"
> "The server encountered an internal error or misconfiguration and was 
> unable to complete your request..."
> 
> Apache is not OK at all.
> 
> here is my code:
> 
> import MySQLdb, MySQLdb.cursors
> from mod_python import apache
> 
> def read(req):
>     req.content_type = "text/html"
>     mydb = MySQLdb.connect(db='S_N', user='giampiero', compress=1, 
> cursorclass=MySQLdb.cursors.DictCursor)
>     cursor = mydb.cursor()
>     stmt = "SELECT news_title FROM news"
>     cursor.execute(stmt)
>     rows = cursor.fetchall()
>     mydb.close()
>     for row in rows:
>         s = row['news_title']
>         print s
>     return apache.OK
> 
> Thank you guys,
> 
> Giampiero
> 
> 
> 
> 
> 
> On Mercoled?, dic 17, 2003, at 18:40 Europe/Rome, 
> <tpc@csua.berkeley.edu> wrote:
> 
>>
>> hi Giampiero, instead of print or echo, you use return or req.write.  I
>> had a similar question here:
>>
>> http://www.modpython.org/pipermail/mod_python/2003-June/003263.html
>>
>> I hope that helps you.
>>
>> On Wed, 17 Dec 2003, Giampiero Benvenuti wrote:
>>
>>> Hello to all of you,
>>>
>>> I'm quite intrigued by mod_python and the difference with "normal"
>>> python cgi...
>>>
>>> for instance: I can't make this great pice of code (Jaroslaw Zabiello,
>>> http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/171463) wich
>>> works great in my cgi-bin directory, working with mod_python.
>>>
>>> The problem I have is right at the end, when I have to deal with:
>>>
>>>   for row in rows:
>>>      print row['name'], row['txt']
>>>
>>> The question is: how can I translate this last part of code to make it
>>> working with mod_python?
>>>
>>> the great code:
>>> ----------------------------------
>>> import MySQLdb
>>> import MySQLdb.cursors
>>>
>>> conn = MySQLdb.Connect(
>>>      host='localhost', user='root',
>>>      passwd='', db='test',compress=1,
>>>      cursorclass=MySQLdb.cursors.DictCursor) # <- important
>>> cursor = conn.cursor()
>>> cursor.execute("SELECT name, sometext txt FROM foo")
>>> rows = cursor.fetchall()
>>> cursor.close()
>>> conn.close()
>>>
>>> for row in rows:
>>>      print row['name'], row['txt'] # bingo!
>>> ------------------------------------
>>>
>>> any help is much appreciated.
>>>
>>> Thanks,
>>>
>>> Giampiero
>>>
>>> _______________________________________________
>>> Mod_python mailing list
>>> Mod_python@modpython.org
>>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>>
>>
>>
>>
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 
From rey4 at columbia.edu  Wed Dec 17 20:16:40 2003
From: rey4 at columbia.edu (Russell Yanofsky)
Date: Fri Jan  9 22:00:39 2004
Subject: [mod_python] Re: Persistant data
References: <3FE0E360.4060002@nunatak.com.au>
Message-ID: <brqv6q$3h7$1@sea.gmane.org>

Timothy Stebbing wrote:
> Is there some way to persist data resource using apache? Im writing a
> simple protocol module
> using PythonConnectionHandler, this takes queries and runs them
> against various backends,
> ie postgres, Lupy (indexer), etc. I want to persist my connections to
> these resources across all
> requests.
>
> Ive tried adding a db 'pool' into a module, but the module is reloaded
> for each request serviced.

Is the module containing the db pool the same one that you specified in
PythonConnectionHandler? If so, you should try storing the pool in a
different module and accessing it with an import statement.

> Im wondering if there is some way I can add objects into these 'apache
> tables' ? would that make
> them persistant, and if so how do I do that? I was also wondering if I
> could somehow access the
> main namespace from child interpreters?

I doubt Mod_Python is using a different interpreter for each request. It's
probably just reloading the one module.

- Russ


From rey4 at columbia.edu  Wed Dec 17 20:23:07 2003
From: rey4 at columbia.edu (Russell Yanofsky)
Date: Fri Jan  9 22:00:39 2004
Subject: [mod_python] Re: Persistant data
References: <3FE0E360.4060002@nunatak.com.au> <3FE0E4F9.8010302@dynamine.net>
Message-ID: <brqvih$42s$1@sea.gmane.org>

Michael S. Fischer wrote:
> In the interest of keeping it simple, I suggest you store your
> persistent data using anydbm and use synchronization techniques 

Heh. You want him to store his database connections in a database?

- Russ

From michael at dynamine.net  Wed Dec 17 17:29:08 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 22:00:39 2004
Subject: [mod_python] Re: Persistant data
In-Reply-To: <brqvih$42s$1@sea.gmane.org>
References: <3FE0E360.4060002@nunatak.com.au> <3FE0E4F9.8010302@dynamine.net>
	<brqvih$42s$1@sea.gmane.org>
Message-ID: <3FE102E4.9020506@dynamine.net>

> Michael S. Fischer wrote:
> 
>>In the interest of keeping it simple, I suggest you store your
>>persistent data using anydbm and use synchronization techniques 
> 
> 
> Heh. You want him to store his database connections in a database?

Oh, I must have misread his message.  Silly me.  *blush*

His question seems to be a FAQ.  Isn't it covered in there?

--Michael
From grisha at modpython.org  Wed Dec 17 21:59:16 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:00:39 2004
Subject: [mod_python] config tree for htaccess
In-Reply-To: <3B9F1328-30ED-11D8-B6D0-000A95A072FC@sb.org>
References: <3B9F1328-30ED-11D8-B6D0-000A95A072FC@sb.org>
Message-ID: <20031217215114.Q1381@onyx.ispol.com>


The config_tree only gives you what is in the main config file, that is
correct.

I am not sure that it is technically possible to get what's in .htaccess
other than reading it. As the .htaccess file is parsed, individual
directives result in calls into modules, which then do things accordingly,
but I don't think httpd tries to store this information anywhere
separately.

Grisha

On Wed, 17 Dec 2003, Kevin Ballard wrote:

> Is there any way to get the config tree from any relevant .htaccess
> files as well as just the httpd.conf file, or do I have to look for and
> parse them manually? Also, is there any way to get the applicable
> config lines from the httpd.conf file, i.e. the ones inside
> <Directory>/<Files>/etc. blocks that apply to the current URI without
> having to parse them all manually?
>
> I'm writing a script that mimics FancyIndexing and it's mostly done
> (i.e. it does just about everything except let you sort by headers,
> including scanning the AddIcon/AddIconByType/AddDescription lines in
> apache.config_tree(), and looks identical to the FancyIndexing in the
> rendered version (i.e. the source is cleaner, but the result is
> identical)), but it only uses the config directives in the root of
> httpd.conf (i.e. the root of apache.config_tree()) and I'd like to make
> it use all applicable directives.
>
> --
> Kevin Ballard
> kevin@sb.org
> http://www.tildesoft.com
> http://kevin.sb.org
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From davidf at sjsoft.com  Thu Dec 18 08:24:56 2003
From: davidf at sjsoft.com (David Fraser)
Date: Fri Jan  9 22:00:39 2004
Subject: [mod_python] Re: Persistant data
In-Reply-To: <brqv6q$3h7$1@sea.gmane.org>
References: <3FE0E360.4060002@nunatak.com.au> <brqv6q$3h7$1@sea.gmane.org>
Message-ID: <3FE14838.1080707@sjsoft.com>

Russell Yanofsky wrote:

>Timothy Stebbing wrote:
>  
>
>>Is there some way to persist data resource using apache? Im writing a
>>simple protocol module
>>using PythonConnectionHandler, this takes queries and runs them
>>against various backends,
>>ie postgres, Lupy (indexer), etc. I want to persist my connections to
>>these resources across all
>>requests.
>>
>>Ive tried adding a db 'pool' into a module, but the module is reloaded
>>for each request serviced.
>>    
>>
>
>Is the module containing the db pool the same one that you specified in
>PythonConnectionHandler? If so, you should try storing the pool in a
>different module and accessing it with an import statement.
>
>  
>
>>Im wondering if there is some way I can add objects into these 'apache
>>tables' ? would that make
>>them persistant, and if so how do I do that? I was also wondering if I
>>could somehow access the
>>main namespace from child interpreters?
>>    
>>
>
>I doubt Mod_Python is using a different interpreter for each request. It's
>probably just reloading the one module.
>  
>
It's quite possible that mod_python is using different interpreters for 
different requests if Apache is loaded with multiple processes. Each 
process will then have its own interpreter. So if you have 20 
interpreters, the likelihood that the first 4 requests each use a unique 
interpreter is 72.67%
This can make it look like each request uses its own interpreter, 
whereas actually there are a pool of interpreters being shared

David


From giampiero.benvenuti at chiaroscuro.com  Thu Dec 18 11:13:10 2003
From: giampiero.benvenuti at chiaroscuro.com (Giampiero Benvenuti)
Date: Fri Jan  9 22:00:39 2004
Subject: [mod_python] mod_python & MySQLdb question: Done
In-Reply-To: <CE1FDA4E-30F4-11D8-9E76-003065D5834A@chiaroscuro.com>
Message-ID: <C88B4324-3142-11D8-913D-003065D5834A@chiaroscuro.com>

Ok, thanks to your help an thanks to the mailing list archives I did 
find the solution (it's working for me, I'm not sure
it's the "right" one):

here is the code:

------------------------------------------------------------------
import MySQLdb, MySQLdb.cursors, mod_python

def readtitle(req):
	req.content_type = "text/html"
	req.send_http_header()
	mydb = MySQLdb.connect(db='S_N', user='giampiero', compress=1, 
cursorclass=MySQLdb.cursors.DictCursor)
	cursor = mydb.cursor()
	stmt = "SELECT news_title FROM news"
	cursor.execute(stmt)
	rows = cursor.fetchall()
	rows = list(rows)
	for row in rows:
		results = (row['news_title']+',<br>')
		req.write(results)
	
	raise mod_python.apache.SERVER_RETURN, mod_python.apache.OK
----------------------------------------------------------------

Thanks to all of you: great mailing list with nice people. I never gona 
go back umiliated to Zope now:)

Giampiero

On Gioved?, dic 18, 2003, at 01:54 Europe/Rome, Giampiero Benvenuti 
wrote:

> Thanks for your prompt answer and your help.
>
> I'm coming from Zope, just got to mod_python a week ago. Please 
> understand my being na?ve.
>
> I'm not quite there yet: thanks to your help now I'm able to get all 
> my titles form mysql, but at the
> end of the page (sigh) I get an apache error: "500 Internal Server 
> Error"
> "The server encountered an internal error or misconfiguration and was 
> unable to complete your request..."
>
> Apache is not OK at all.
>
> here is my code:
>
> import MySQLdb, MySQLdb.cursors
> from mod_python import apache
>
> def read(req):
> 	req.content_type = "text/html"
> 	mydb = MySQLdb.connect(db='S_N', user='giampiero', compress=1, 
> cursorclass=MySQLdb.cursors.DictCursor)
> 	cursor = mydb.cursor()
> 	stmt = "SELECT news_title FROM news"
> 	cursor.execute(stmt)
> 	rows = cursor.fetchall()
> 	mydb.close()
> 	for row in rows:
> 		s = row['news_title']
> 		print s
> 	return apache.OK
>
> Thank you guys,
>
> Giampiero
>
>
>
>
>
> On Mercoled?, dic 17, 2003, at 18:40 Europe/Rome, 
> <tpc@csua.berkeley.edu> wrote:
>
>>
>> hi Giampiero, instead of print or echo, you use return or req.write.  
>> I
>> had a similar question here:
>>
>> http://www.modpython.org/pipermail/mod_python/2003-June/003263.html
>>
>> I hope that helps you.
>>
>> On Wed, 17 Dec 2003, Giampiero Benvenuti wrote:
>>
>>> Hello to all of you,
>>>
>>> I'm quite intrigued by mod_python and the difference with "normal"
>>> python cgi...
>>>
>>> for instance: I can't make this great pice of code (Jaroslaw 
>>> Zabiello,
>>> http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/171463) wich
>>> works great in my cgi-bin directory, working with mod_python.
>>>
>>> The problem I have is right at the end, when I have to deal with:
>>>
>>>   for row in rows:
>>>      print row['name'], row['txt']
>>>
>>> The question is: how can I translate this last part of code to make 
>>> it
>>> working with mod_python?
>>>
>>> the great code:
>>> ----------------------------------
>>> import MySQLdb
>>> import MySQLdb.cursors
>>>
>>> conn = MySQLdb.Connect(
>>>      host='localhost', user='root',
>>>      passwd='', db='test',compress=1,
>>>      cursorclass=MySQLdb.cursors.DictCursor) # <- important
>>> cursor = conn.cursor()
>>> cursor.execute("SELECT name, sometext txt FROM foo")
>>> rows = cursor.fetchall()
>>> cursor.close()
>>> conn.close()
>>>
>>> for row in rows:
>>>      print row['name'], row['txt'] # bingo!
>>> ------------------------------------
>>>
>>> any help is much appreciated.
>>>
>>> Thanks,
>>>
>>> Giampiero
>>>
>>> _______________________________________________
>>> Mod_python mailing list
>>> Mod_python@modpython.org
>>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>>
>>
>>
>>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>


From manfred.stienstra at dwerg.net  Thu Dec 18 11:29:39 2003
From: manfred.stienstra at dwerg.net (Manfred Stienstra)
Date: Fri Jan  9 22:00:39 2004
Subject: [mod_python] mod_python & MySQLdb question: Done
In-Reply-To: <C88B4324-3142-11D8-913D-003065D5834A@chiaroscuro.com>
References: <C88B4324-3142-11D8-913D-003065D5834A@chiaroscuro.com>
Message-ID: <1071743378.12631.7.camel@ack.dwerg.net>

On Thu, 2003-12-18 at 11:13, Giampiero Benvenuti wrote:
> import MySQLdb, MySQLdb.cursors, mod_python
> 
> def readtitle(req):
> 	req.content_type = "text/html"
> 	req.send_http_header()
> 	mydb = MySQLdb.connect(db='S_N', user='giampiero', compress=1, 
> cursorclass=MySQLdb.cursors.DictCursor)
> 	cursor = mydb.cursor()
> 	stmt = "SELECT news_title FROM news"
> 	cursor.execute(stmt)
> 	rows = cursor.fetchall()
> 	rows = list(rows)
> 	for row in rows:
> 		results = (row['news_title']+',<br>')
> 		req.write(results)
> 	
> 	raise mod_python.apache.SERVER_RETURN, mod_python.apache.OK


This:

> 	rows = cursor.fetchall()
> 	rows = list(rows)
> 	for row in rows:
> 		results = (row['news_title']+',<br>')
> 		req.write(results)

can be compressed to (and made faster):


results = []
for row in cursor.fetchall():
	results.append(row['news_title'])
req.write("<br />".join(results))


Also using the DictCursor gives a little overhead in this case. This is
ofcourse not a real problem on small queries like this one.

Manfred

From giampiero.benvenuti at chiaroscuro.com  Thu Dec 18 14:56:44 2003
From: giampiero.benvenuti at chiaroscuro.com (Giampiero Benvenuti)
Date: Fri Jan  9 22:00:39 2004
Subject: [mod_python] mod_python & MySQLdb question: Done
In-Reply-To: <1071743378.12631.7.camel@ack.dwerg.net>
Message-ID: <03B2DC68-3162-11D8-913D-003065D5834A@chiaroscuro.com>

Thanks Manfred, now I'm starting to "see".
Great tip, it works like a "swiss" clock.

> This:
>
>> 	rows = cursor.fetchall()
>> 	rows = list(rows)
>> 	for row in rows:
>> 		results = (row['news_title']+',<br>')
>> 		req.write(results)
>
> can be compressed to (and made faster):
>
>
> results = []
> for row in cursor.fetchall():
> 	results.append(row['news_title'])
> req.write("<br />".join(results))
>

From tpc at csua.berkeley.edu  Thu Dec 18 08:45:41 2003
From: tpc at csua.berkeley.edu (tpc@csua.berkeley.edu)
Date: Fri Jan  9 22:00:39 2004
Subject: [mod_python] mod_python & MySQLdb question: Done
In-Reply-To: <03B2DC68-3162-11D8-913D-003065D5834A@chiaroscuro.com>
Message-ID: <20031218084200.O51827-100000@localhost.name>


hi Giampiero, can I ask you, being a newbie to Python
myself, why you are switching to modpython from Zope ?
I have heard many good things about Zope but have not
had the time to download and use it, but from what I hear
if you want to serve a complex database-backed application
there is no better way.

On Thu, 18 Dec 2003, Giampiero Benvenuti wrote:

> Thanks Manfred, now I'm starting to "see".
> Great tip, it works like a "swiss" clock.
>
> > This:
> >
> >> 	rows = cursor.fetchall()
> >> 	rows = list(rows)
> >> 	for row in rows:
> >> 		results = (row['news_title']+',<br>')
> >> 		req.write(results)
> >
> > can be compressed to (and made faster):
> >
> >
> > results = []
> > for row in cursor.fetchall():
> > 	results.append(row['news_title'])
> > req.write("<br />".join(results))
> >
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From giampiero.benvenuti at chiaroscuro.com  Fri Dec 19 11:05:55 2003
From: giampiero.benvenuti at chiaroscuro.com (Giampiero Benvenuti)
Date: Fri Jan  9 22:00:39 2004
Subject: Zope vs. mod_python!? It was "Re: [mod_python] mod_python & MySQLdb
	question: Done"
In-Reply-To: <20031218084200.O51827-100000@localhost.name>
Message-ID: <EF2C53EE-320A-11D8-913D-003065D5834A@chiaroscuro.com>


On Gioved?, dic 18, 2003, at 17:45 Europe/Rome, <tpc@csua.berkeley.edu> 
wrote:

>
> hi Giampiero, can I ask you, being a newbie to Python
> myself, why you are switching to modpython from Zope ?
> I have heard many good things about Zope but have not
> had the time to download and use it, but from what I hear
> if you want to serve a complex database-backed application
> there is no better way.

I'm not sure I can give a detailed and precise answer to your question.
Please keep in mind that I don't have any formal education in 
programming
but in photography and arts.

As far as I can see, Zope is a great tool, well designed and with great
performance. I started using it 2 years ago and it took me quite some 
time
to figure it out. I developed a few sites using it: www.cercacultura.it 
is
one of them. cercacultura.it is totally Zope based and uses the internal
ZODB database.

What triggered my curiosity in python/mod_python is the fact that Zope 
is
built "over" python and actualy the right way to use it is to keep the
business logic in python and the presentation in dtml, the Zope markup
language.
Now I am starting to experience Zope as a kind of "filter" that doesn't 
let
me really understand what is going on underneath. A sort of second 
language
that prevents you from speaking your first language. For this reason I 
am
starting to feel the limits of Zope.

What I can say now is that learning python created a new challenge and a
way to find faster and more transparent solutions. I also read that with
mod_python you can actually use some Zope modules (Zpublisher for 
example).
I very much like the mod_python integration in apache, which allows to
bypass the zope server.

There is much more to say about it, and I'm sure other people on the 
list
can be more articulate on this issue.

Thanks,

Giampiero


From fowlertrainer at anonym.hu  Fri Dec 19 12:24:08 2003
From: fowlertrainer at anonym.hu (fowlertrainer@anonym.hu)
Date: Fri Jan  9 22:00:39 2004
Subject: [mod_python] Newbie questions 1
Message-ID: <15814100725.20031219122408@anonym.hu>

Hello !

I've been used php, and zope before, but I want to try the mod_python,
becuase the py lang is seems to be better than these web-dev
langs/tools.

Some structural/tehnological questions:

1.
  I want to know, how many times used the mp_req objects ?
  Is eliminate mod_python this elements, if some of these objects don't
  needed longer ?
  I try to understand, how to be working.
  I see, that I can define global variables in main module, and the
  globals are globals in every mp_req.
  But if the system eliminate all of this objects, can holding these
  global vars ?

  Why are write this question ?

  I want to create a file or memory storaged session system.
  If the memory is cleared by every N time, it have been failed...
  So it is needed to be I have fix elements.

2.
  Is the mod_py regenerate the existing objects, and clear memory if I change the
  source code, and I have two threads/two existing objects in alive ?
  

-- 
Best regards,
 fowlertrainer                          mailto:fowlertrainer@anonym.hu

From fowlertrainer at anonym.hu  Fri Dec 19 12:31:04 2003
From: fowlertrainer at anonym.hu (fowlertrainer@anonym.hu)
Date: Fri Jan  9 22:00:39 2004
Subject: [mod_python] Newbie questions 2
Message-ID: <8314517404.20031219123104@anonym.hu>

Hello !

Part 2:

  3.
      How to I prevent some effects ?
      I want to be create an one-main-file-handled site.

      a.) So I want to remove the .py from main.py file in the
          browser, if possible.
      b.) I want to eliminate or redirect the main.pyc file, what is
          created by python in everytime.
          This file is downloadable from browser, and if any users
          have some python experience, or an decompiler, that these
          persons can get informations from my site !
      c.) I want to the main.py is let my 'index.html', so if I don't
          write any tags, that it have been processed.
          http://site/main.py
          ->
          http://site/main
          ->
          http://site/

          These elements let do same thing !!!

Thanx:
 KK

  

-- 
Best regards,
 fowlertrainer                          mailto:fowlertrainer@anonym.hu

From mod_python at ols.inorganic.org  Fri Dec 19 06:33:34 2003
From: mod_python at ols.inorganic.org (Roy S. Rapoport)
Date: Fri Jan  9 22:00:39 2004
Subject: [mod_python] mod_python & MySQLdb question: Done
In-Reply-To: <20031218084200.O51827-100000@localhost.name>
References: <03B2DC68-3162-11D8-913D-003065D5834A@chiaroscuro.com>
	<20031218084200.O51827-100000@localhost.name>
Message-ID: <20031219143334.GA10524@nag.inorganic.org>

On Thu, Dec 18, 2003 at 08:45:41AM -0800, tpc@csua.berkeley.edu wrote:
> hi Giampiero, can I ask you, being a newbie to Python
> myself, why you are switching to modpython from Zope ?
> I have heard many good things about Zope but have not
> had the time to download and use it, but from what I hear
> if you want to serve a complex database-backed application
> there is no better way.

I'm obviously not Giampiero, but I'll take a stab at answering the question
(disregarding Giampiero's specific circumstances).

I work for a privately-held financial institution in the IT group; I happen
to wear two hats, actually -- I'm a member of both the development and the
infrastructure groups.  Our choice of languages is Python, our choice of
platform on which to develop applications is the web, and our choice of web
platform on which to develop is Zope.  We are heavily invested in Zope and
we love it.  

I especially love Zope because it pretty much enforces an MVC architecture
-- ZSQL methods to access databases, python scripts for business logic,
DTML/ZPT for display logic.  

There's the upside.

The downside? The security (or lackthereof) aspects of running it sometimes
wake me up at night screaming.  OK, that's overstating it, but not by much
:)

The problem with Zope is one of its nicest features -- in-band management.
Got a Zope server at http://my.server ?  Then you can manage it at
http://my.server/manage.  Want to manage http://my.server/some/path? Again,
you can go into the management interfact of Zope on that path at
http://my.server/some/path/manage.  All management of Zope is down through
URL strings ON THE SAME IP AND PORT AS THE CONTENT YOU'RE SERVING.  

Now, again, in some respects this is really nice -- it took us about two
hours to get up a Python program that allowed us to easily synchronize
content between two or more Zope servers by just sending URLs around.  On
the downside, this means that pretty much anyone in the world is guaranteed
to be able to access the management interface of your Zope server and then
it's just a password-guessing attack.  You can front Zope with Apache --
and you're advised to -- and we're continuing to fine-tune our httpd.conf
to block URLs that look like they're management URLs -- but it's a pain,
and error-prone, and not likely to ever be complete.  The official word on
the Zope list is "Yes, it's insecure.  Deal with it and accept it."

In-band management is really user-friendly.  I think it's also a very bad
idea.  I hope they go away from that one of these days.

Oh, one more thing:  Emblematic of many (but not all) open-source projects,
Zope is a wonderful, relatively-well-constructed product with absolutely
atrocious, horrific, monstrously-bad documentation.  It's incomplete (and
in some cases wrong).  Mind you, I'm not sure mod_python is much better,
but I'm not talking about it right now :)

Hope this is useful,
-roy (ex-CSUA and OCF member)

> 
> On Thu, 18 Dec 2003, Giampiero Benvenuti wrote:
> 
> > Thanks Manfred, now I'm starting to "see".
> > Great tip, it works like a "swiss" clock.
> >
> > > This:
> > >
> > >> 	rows = cursor.fetchall()
> > >> 	rows = list(rows)
> > >> 	for row in rows:
> > >> 		results = (row['news_title']+',<br>')
> > >> 		req.write(results)
> > >
> > > can be compressed to (and made faster):
> > >
> > >
> > > results = []
> > > for row in cursor.fetchall():
> > > 	results.append(row['news_title'])
> > > req.write("<br />".join(results))
> > >
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
From gdamjan at mail.net.mk  Fri Dec 19 17:48:27 2003
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 22:00:39 2004
Subject: Zope vs. mod_python!? It was "Re: [mod_python] mod_python &
	MySQLdb question: Done"
In-Reply-To: <EF2C53EE-320A-11D8-913D-003065D5834A@chiaroscuro.com>
References: <20031218084200.O51827-100000@localhost.name>
	<EF2C53EE-320A-11D8-913D-003065D5834A@chiaroscuro.com>
Message-ID: <20031219164827.GB2368@legolas.on.net.mk>

> What I can say now is that learning python created a new challenge and a
> way to find faster and more transparent solutions. I also read that with
> mod_python you can actually use some Zope modules (Zpublisher for 
> example).

It would be great when mod_python could rould replace all the Zope
functionality, and I guess most of it can be done. Parts of Zope that
should be implemented in mod_python are:

- The Zpublisher ... well we already have the publisher in mod_python

- ZODB - I think the standalone ZODB can be easily used in mod_python,
  there might be some threading issues ... maybe.

- ZPT/DTML these also should useable in mod_python as they are ... and
  then there's also mod_python's native PSP.

- ACL's - ACL's are stored in the ZODB in Zope, and are checked by the
  Zpublisher ... we dont have this in mod_python

- WebDav - you can access your Zope objects through WebDav, ACL's
  checked again ... (also mod_python 3.1.2b conflicts somehow with
  apaches mod_dav)

- Zope's *acquisition* inheritance - this is one of the key features in
  Zope. The publisher should support this.

So it seems that an overhauled publisher for mod_python could provide
most, if not all the Zope functionality. 

Also it would be interesting to see if other storage than ZODB could be
implemented with the same features... Linux FS with ACLs and Extended
Attributes for ex. :)


just my $0.02





-- 
Damjan Georgievski
jabberID: damjan@bagra.net.mk
From redconectabilbao at telefonica.net  Fri Dec 19 17:51:45 2003
From: redconectabilbao at telefonica.net (Red Conecta)
Date: Fri Jan  9 22:00:39 2004
Subject: [mod_python] newbie
Message-ID: <3FE32CA1.7070105@telefonica.net>

Hello!

I want to try mod_python, but something doesn't work fine

I'm using Apache 2.0.47 (Mandrake Linux/1.6.91mdk) mod_python/3.0.1 
Python/2.2.2 in a Mandrake9.1 and my  http2.conf is:

...
LoadModule python_module                 extramodules/mod_python.so
...
<Directory /var/www/html>
  AddHandler python-program .py
  PythonHandler mptest
  PythonDebug On
</Directory>

and, of course there's a mptest.py in /var/www/html

But pointing to my mptest.py, my mozilla opens the dialog for 
downloading the file.

What's wrong?

Thanks
**

From kevin at sb.org  Fri Dec 19 15:21:31 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:00:39 2004
Subject: [mod_python] newbie
In-Reply-To: <3FE32CA1.7070105@telefonica.net>
References: <3FE32CA1.7070105@telefonica.net>
Message-ID: <EF2F6572-3260-11D8-B7F9-000A95A072FC@sb.org>

What's your mptest.py look like?

Most likely, it's something like

from apache import *

def handler(req):
	req.write("Hello world!")
	return apache.OK

Is that right? If so, add this line before the req.write line:

	req.content_type = "text/plain"

On Dec 19, 2003, at 11:51 AM, Red Conecta wrote:

> I want to try mod_python, but something doesn't work fine
>
> I'm using Apache 2.0.47 (Mandrake Linux/1.6.91mdk) mod_python/3.0.1 
> Python/2.2.2 in a Mandrake9.1 and my  http2.conf is:
>
> ...
> LoadModule python_module                 extramodules/mod_python.so
> ...
> <Directory /var/www/html>
>  AddHandler python-program .py
>  PythonHandler mptest
>  PythonDebug On
> </Directory>
>
> and, of course there's a mptest.py in /var/www/html
>
> But pointing to my mptest.py, my mozilla opens the dialog for 
> downloading the file.
>
> What's wrong?

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From kevin at sb.org  Fri Dec 19 15:21:37 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:00:39 2004
Subject: [mod_python] Newbie questions 2
In-Reply-To: <8314517404.20031219123104@anonym.hu>
References: <8314517404.20031219123104@anonym.hu>
Message-ID: <F2AAD67B-3260-11D8-B7F9-000A95A072FC@sb.org>

On Dec 19, 2003, at 6:31 AM, fowlertrainer@anonym.hu wrote:

>       a.) So I want to remove the .py from main.py file in the
>           browser, if possible.

Define main.py as the handler for main.

>       b.) I want to eliminate or redirect the main.pyc file, what is
>           created by python in everytime.
>           This file is downloadable from browser, and if any users
>           have some python experience, or an decompiler, that these
>           persons can get informations from my site !

Put this in your httpd.conf

<Files ~ "\.pyc$">
     Order allow,deny
     Deny from all
</Files>

That blocks access to files ending in .pyc

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From nelson at crynwr.com  Fri Dec 19 15:51:16 2003
From: nelson at crynwr.com (Russell Nelson)
Date: Fri Jan  9 22:00:39 2004
Subject: [mod_python] newbie
In-Reply-To: <EF2F6572-3260-11D8-B7F9-000A95A072FC@sb.org>
References: <3FE32CA1.7070105@telefonica.net>
	<EF2F6572-3260-11D8-B7F9-000A95A072FC@sb.org>
Message-ID: <16355.25796.858212.742243@desk.crynwr.com>

Kevin Ballard writes:
 > What's your mptest.py look like?
 > 
 > Most likely, it's something like
 > 
 > from apache import *

Just as a matter of style, I think Guido (BDFL) discourages this sort
of thing.  For myself, even though it means more typing in the first
place, I prefer to see a plain import, and lots of foo., bar., and
baz. prefixes.  Lets the newbie (which I've been so very recently)
know which module the function is associated with.

-- 
--My blog is at angry-economist.russnelson.com  | 
Crynwr sells support for free software  | PGPok |  You can't spell Fiasco
521 Pleasant Valley Rd. | +1 315 268 1925 voice |  without SCO
Potsdam, NY 13676-3213  | +1 315 268 9201 FAX   | 
From dpopowich at mtrsd.k12.ma.us  Fri Dec 19 16:31:45 2003
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Fri Jan  9 22:00:39 2004
Subject: [mod_python] Sessions and problems with cookie path attribute
Message-ID: <16355.28225.866414.517954@gargle.gargle.HOWL>


I had a serious problem getting sessions to work with an app I'm
writing (modpython 3.1.2b, httpd-2.0.40, python 2.3.2) and after
browsing the archives I've seen others getting bitten by the same
problem...

Session ids are stored on the client as a cookie with name pysid.
This is fine and the cookie gets stored, but the path attribute can
get badly mangled by the code in Session.BaseSession.make_cookie(), in
particular, this section:

        if config.has_key("ApplicationPath"):
            c.path = config["ApplicationPath"]
        else:
            docroot = self._req.document_root()
            # the path where *Handler directive was specified
            dirpath = self._req.hlist.directory 
            c.path = dirpath[len(docroot):]

If you don't have AppliationPath set as a PythonOption and your
handler isn't in a <Directory> under DocumentRoot you're probably
going to have trouble.  Two scenarios hurt me:

  1.  using a handler inside a <Location>.  There is no path.  My
      browser (galeon 1.2.7) hung for infinity on reloads.  Never
      could figure out why.

  2.  using mod_python under UserDir directories.  I do this for
      prototyping because it's so easy to tweak a .htaccess file under
      a ~username/public_html subdirectory and you don't have to
      restart/reload apache to see your changes.  In this situation
      the length of DocumentRoot has no relationship to the URIs so
      the path attribute of the cookie gets oddly chopped at the
      head.  I kept getting new sessions because the browser wasn't
      sending the cookie because of paths not matching the uri.

I believe the same problem will occur under certain circumstances if
Alias directives affect mod_python usage although I haven't tested
this.

I think the ELSE clause above is trying to do something that can't be
done easily: extract the leading uri of the handler.  With Alias,
UserDir and Location directives, it's pretty difficult.  Is it
possible?  Perhaps the code shouldn't try to be so clever.  Default
the path to "/" unless the Session constructor overrides the value??

My temporary fix is to always explicitly use ApplicationPath.  Setting
it to "/" is certainly general enough for my prototyping.

Minimally, I think the documentation for Session should devote some
space to addressing and clarifying this issue.

------------------
Daniel Popowich
Network Specialist
-------------------------------------
Mohawk Trail Regional School District
24 Ashfield Rd.
Shelburne Falls, MA 01370
413.625.0192 x22
-------------------------------------

From kevin at sb.org  Fri Dec 19 19:31:59 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:00:39 2004
Subject: [mod_python] newbie
In-Reply-To: <16355.25796.858212.742243@desk.crynwr.com>
References: <3FE32CA1.7070105@telefonica.net>
	<EF2F6572-3260-11D8-B7F9-000A95A072FC@sb.org>
	<16355.25796.858212.742243@desk.crynwr.com>
Message-ID: <EC83DA6A-3283-11D8-B7F9-000A95A072FC@sb.org>

For the record, I meant to say

from mod_python import apache

because what I wrote wouldn't actually run.

And although I tend to agree with you in general, I still prefer 
importing apache from mod_python rather than just importing mod_python.

On Dec 19, 2003, at 3:51 PM, Russell Nelson wrote:

> Kevin Ballard writes:
>> What's your mptest.py look like?
>>
>> Most likely, it's something like
>>
>> from apache import *
>
> Just as a matter of style, I think Guido (BDFL) discourages this sort
> of thing.  For myself, even though it means more typing in the first
> place, I prefer to see a plain import, and lots of foo., bar., and
> baz. prefixes.  Lets the newbie (which I've been so very recently)
> know which module the function is associated with.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From grisha at modpython.org  Fri Dec 19 23:13:26 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:00:39 2004
Subject: [mod_python] newbie
In-Reply-To: <EC83DA6A-3283-11D8-B7F9-000A95A072FC@sb.org>
References: <3FE32CA1.7070105@telefonica.net>
	<EF2F6572-3260-11D8-B7F9-000A95A072FC@sb.org>
	<EC83DA6A-3283-11D8-B7F9-000A95A072FC@sb.org>
Message-ID: <20031219230940.K35608@onyx.ispol.com>


I think Russel was referring not to the "from" but to the "*" - I agree,
Python would probably be better if this "feature" did not exist at all,
because you don't know what the "*" has just imported.

Using "from" is just fine though :-)

On Fri, 19 Dec 2003, Kevin Ballard wrote:

> For the record, I meant to say
>
> from mod_python import apache
>
> because what I wrote wouldn't actually run.
>
> And although I tend to agree with you in general, I still prefer
> importing apache from mod_python rather than just importing mod_python.
>
> On Dec 19, 2003, at 3:51 PM, Russell Nelson wrote:
>
> > Kevin Ballard writes:
> >> What's your mptest.py look like?
> >>
> >> Most likely, it's something like
> >>
> >> from apache import *
> >
> > Just as a matter of style, I think Guido (BDFL) discourages this sort
> > of thing.  For myself, even though it means more typing in the first
> > place, I prefer to see a plain import, and lots of foo., bar., and
> > baz. prefixes.  Lets the newbie (which I've been so very recently)
> > know which module the function is associated with.
>
> --
> Kevin Ballard
> kevin@sb.org
> http://www.tildesoft.com
> http://kevin.sb.org
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From fccoelho at fiocruz.br  Mon Dec 22 10:28:16 2003
From: fccoelho at fiocruz.br (Flavio C. Coelho)
Date: Fri Jan  9 22:00:39 2004
Subject: [mod_python] mod_python and the semaphore bug
In-Reply-To: <8794402.1071700631675.JavaMail.jciccale@mac.com>
References: <8794402.1071700631675.JavaMail.jciccale@mac.com>
Message-ID: <1072096096.2609.6.camel@pinguim.procc.fiocruz.br>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: fiocruz4.jpg
Type: image/jpeg
Size: 3085 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20031222/4d0595d6/fiocruz4-0002.jpg
From jciccale at mac.com  Mon Dec 22 14:42:56 2003
From: jciccale at mac.com (Julian Ciccale)
Date: Fri Jan  9 22:00:39 2004
Subject: [mod_python] mod_python and the semaphore bug
Message-ID: <8134803.1072100576603.JavaMail.jciccale@mac.com>

The message on error_log is fine, apache uses it also to output "NOTICE" messages.
What is that doesn't work now? 

 
On Monday, December 22, 2003, at 01:28PM, Flavio C. Coelho <fccoelho@fiocruz.br> wrote:

>
><<Original Attached>>
From dpopowich at mtrsd.k12.ma.us  Mon Dec 22 11:02:45 2003
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Fri Jan  9 22:00:39 2004
Subject: [mod_python] Sessions and problems with cookie path attribute
In-Reply-To: <16355.28225.866414.517954@gargle.gargle.HOWL>
References: <16355.28225.866414.517954@gargle.gargle.HOWL>
Message-ID: <16359.5542.430.748017@gargle.gargle.HOWL>


> I had a serious problem getting sessions to work with an app I'm
> writing (modpython 3.1.2b, httpd-2.0.40, python 2.3.2) and after
> browsing the archives I've seen others getting bitten by the same
> problem...
> 
> Session ids are stored on the client as a cookie with name pysid.
> This is fine and the cookie gets stored, but the path attribute can
> get badly mangled by the code in Session.BaseSession.make_cookie(), in
> particular, this section:
> 
>         if config.has_key("ApplicationPath"):
>             c.path = config["ApplicationPath"]
>         else:
>             docroot = self._req.document_root()
>             # the path where *Handler directive was specified
>             dirpath = self._req.hlist.directory 
>             c.path = dirpath[len(docroot):]
> 
> If you don't have AppliationPath set as a PythonOption and your
> handler isn't in a <Directory> under DocumentRoot you're probably
> going to have trouble.  Two scenarios hurt me:
> 
>   1.  using a handler inside a <Location>.  There is no path.  My
>       browser (galeon 1.2.7) hung for infinity on reloads.  Never
>       could figure out why.
> 
>   2.  using mod_python under UserDir directories.  I do this for
>       prototyping because it's so easy to tweak a .htaccess file under
>       a ~username/public_html subdirectory and you don't have to
>       restart/reload apache to see your changes.  In this situation
>       the length of DocumentRoot has no relationship to the URIs so
>       the path attribute of the cookie gets oddly chopped at the
>       head.  I kept getting new sessions because the browser wasn't
>       sending the cookie because of paths not matching the uri.
> 
> I believe the same problem will occur under certain circumstances if
> Alias directives affect mod_python usage although I haven't tested
> this.
> 
> I think the ELSE clause above is trying to do something that can't be
> done easily: extract the leading uri of the handler.  With Alias,
> UserDir and Location directives, it's pretty difficult.  Is it
> possible?  Perhaps the code shouldn't try to be so clever.  Default
> the path to "/" unless the Session constructor overrides the value??
> 
> My temporary fix is to always explicitly use ApplicationPath.  Setting
> it to "/" is certainly general enough for my prototyping.
> 
> Minimally, I think the documentation for Session should devote some
> space to addressing and clarifying this issue.

I need to correct myself.  The problem does not occur inside
<Location> directives (the hanging problem I referred to was a bug in
my application: my session instance was not being garbage collected).
In fact, when using Sessions inside <Location> URIs no path attribute
is specified in the Cookie, so it is ALWAYS sent back to the server.

However, I have confirmed that this problem exists for uses of Session
within handlers referenced via Alias directives.

In summary, if you use Sessions in handlers referenced via UserDir or
Alias directives you have to use "PythonOption ApplicationPath ..." in
your config.

------------------
Daniel Popowich
Network Specialist
-------------------------------------
Mohawk Trail Regional School District
24 Ashfield Rd.
Shelburne Falls, MA 01370
413.625.0192 x22
-------------------------------------

From theman at eradman.com  Mon Dec 22 11:16:46 2003
From: theman at eradman.com (Eric Radman)
Date: Fri Jan  9 22:00:39 2004
Subject: [mod_python] mod_* performance
Message-ID: <1072091806.2521.68.camel@inspiration.x.eradman.com>

Guys,

I had been blaming bad performance with concurrent connections on
mod_python, when in fact an Apache config change can make all the
difference. The key is to limit the number of Apache processes based on
the RAM and average concurrency load that you have.

I found the mod_perl suffers from the same performance characteristics
becuase it's Apache behavior that impacts the performance on
simultinious connections, not mod_python or mod_perl.

I changed the MaxClients parameter in apache2.conf from 50 to 8:

<IfModule prefork.c>
StartServers         1
MinSpareServers      1
MaxSpareServers     10
MaxClients           8
MaxRequestsPerChild  0
</IfModule>

7k mod_python page with SQL caching:

Reqests  Concurrency   Req/Sec  Connect Time
400      1             136.54   7.324
400      5             131.29   38.085
400      15            126.28   118.780
400      50            96.73    516.883 
400      100           71.92    1390.431

To quote Stas Bekman <stas at stason.org>
"""
MinSpareServers, MaxSpareServers and StartServers are only important for
user response times. Sometimes users will have to wait a bit.

The important parameters are MaxClients and MaxRequestsPerChild.
MaxClients should be not too big, so it will not abuse your machine's
memory resources, and not too small, for if it is your users will be
forced to wait for the children to become free to serve them.
MaxRequestsPerChild should be as large as possible, to get the full
benefit of mod_perl, but watch your server at the beginning to make sure
your scripts are not leaking memory, thereby causing your server (and
your service) to die very fast.
"""

7k PHP page with standard connection pooling:

Reqests  Concurrency   Req/Sec  Connect Time
400      1             29.60    33.785
400      5             15.32    65.291
400      15            23.13    43.242
400      50            21.45    2656.869
400      100           23.21    4308.698

What we see here is that connect time (which translates into perceived
latency) really suffers in PHP when you hit it with a large number of
concurrent connections.

This one little tweak makes mod_perl and mod_python immune to http DOS
attacks. With the poper coding an increase of 300%-350% is possible over
PHP.

Eric Radman
From theman at eradman.com  Mon Dec 22 11:22:10 2003
From: theman at eradman.com (Eric Radman)
Date: Fri Jan  9 22:00:39 2004
Subject: [mod_python] 
Message-ID: <1072092130.4080.2.camel@inspiration.x.eradman.com>



From michael at dynamine.net  Mon Dec 22 08:34:26 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 22:00:39 2004
Subject: [mod_python] mod_* performance
In-Reply-To: <1072091806.2521.68.camel@inspiration.x.eradman.com>
References: <1072091806.2521.68.camel@inspiration.x.eradman.com>
Message-ID: <3FE71D12.6030802@dynamine.net>

Eric Radman wrote:

> This one little tweak makes mod_perl and mod_python immune to http DOS
> attacks. With the poper coding an increase of 300%-350% is possible over
> PHP.

I think that in order to reach a believable conclusion one really needs 
to run such benchmarks with the Zend Accelerator for PHP; it yields a 
performance improvement of nearly an order of magnitude.

Best,

--Michael
From neel at mediapulse.com  Mon Dec 22 11:44:42 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:00:40 2004
Subject: [mod_python] Changing the status code with custom content
Message-ID: <C0FC22C08B82074A88B500617641577787A7F0@johnson.mediapulse.net>

I'm having trouble using mod_python to change the status code and have
custom content in the error message.  If I return something other than
apache.OK in my handler, the status line is set correctly set but apache
returns the default error page.  If I have sent custom content for the
error message, the apache error message is added to the end of the
document.  I can get around this by using an ErrorDocument directive in
apache's conf, but I loose access to the traceback of the error and thus
the ability to have a really custom error message.

At first glance this didn't seem to matter.  As long as the content said
error, the user knew of the problem, even if the status was 200 OK.
However I've found out now with search bots this does matter - they
don't know that they have a bad url for the site and are indexing error
pages thinking they are legit.

Any thoughts on what I may be over looking?

Thanks,
Mike

From dpopowich at mtrsd.k12.ma.us  Mon Dec 22 11:44:30 2003
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Fri Jan  9 22:00:40 2004
Subject: [mod_python] redirects and url rewriting
Message-ID: <16359.8046.124675.498918@gargle.gargle.HOWL>


When I use req.internal_redirect(some_uri) sometimes the url in my
browser gets rewritten to reflect some_uri and some times it doesn't,
remaining as the uri of the originally selected page.  This can cause
numerous problems with relative links inside a page if the url is not
rewritten in the browser.

I'm trying to understand what causes this and how I can control it.
Can someone point me to some doc?

Below is a short handler I wrote as an example (the links I use assume
you have the apache manual installed; modify if necessary).

[modpython 3.1.2b, python 2.3.2, apache 2.0.40]

Thanks,

------------------
Daniel Popowich
Network Specialist
-------------------------------------
Mohawk Trail Regional School District
24 Ashfield Rd.
Shelburne Falls, MA 01370
413.625.0192 x22
-------------------------------------

# -*- python -*-

from mod_python import apache, util

def handler(req):

    req.content_type = 'text/html'

    form = util.FieldStorage(req)
    choice = form.getfirst('redirect')
    # this doesn't rewrite the url in the browser
    if choice == '1':
        req.internal_redirect('%s/abcdefg' % req.uri)
        
    # neither does this one [and the resulting page is quite
    # messed up because the relative urls inside the doc don't
    # make sense without the rewrite]
    elif choice == '2':
        req.internal_redirect('/manual/index.html')

    # but this one does
    elif choice == '3':
        req.internal_redirect('/manual')

    else:
        req.write('''
        <html>
        <body>
        <a href=%s?redirect=1>redirect to %s/abcdefg</a><br>
        <a href=%s?redirect=2>redirect to /manual/index.html</a><br>
        <a href=%s?redirect=3>redirect to /manual</a><br>
        </body>
        </html>
        ''' % ((req.uri,)*4))


    return apache.OK

From jciccale at mac.com  Mon Dec 22 18:10:54 2003
From: jciccale at mac.com (Julian Ciccale)
Date: Fri Jan  9 22:00:40 2004
Subject: [mod_python] redirects and url rewriting
Message-ID: <1006403.1072113054814.JavaMail.jciccale@mac.com>

I think the best option for your problem is:

req.headers_out[ "Location" ] = uri
return apache.HTTP_MOVED_PERMANENTLY #301 

- julcicc - 
 
On Monday, December 22, 2003, at 05:44PM, Daniel J. Popowich <dpopowich@mtrsd.k12.ma.us> wrote:

>
>When I use req.internal_redirect(some_uri) sometimes the url in my
>browser gets rewritten to reflect some_uri and some times it doesn't,
>remaining as the uri of the originally selected page.  This can cause
>numerous problems with relative links inside a page if the url is not
>rewritten in the browser.
>
>I'm trying to understand what causes this and how I can control it.
>Can someone point me to some doc?
>
>Below is a short handler I wrote as an example (the links I use assume
>you have the apache manual installed; modify if necessary).
>
>[modpython 3.1.2b, python 2.3.2, apache 2.0.40]
>
>Thanks,
>
>------------------
>Daniel Popowich
>Network Specialist
>-------------------------------------
>Mohawk Trail Regional School District
>24 Ashfield Rd.
>Shelburne Falls, MA 01370
>413.625.0192 x22
>-------------------------------------
>
># -*- python -*-
>
>from mod_python import apache, util
>
>def handler(req):
>
>    req.content_type = 'text/html'
>
>    form = util.FieldStorage(req)
>    choice = form.getfirst('redirect')
>    # this doesn't rewrite the url in the browser
>    if choice == '1':
>        req.internal_redirect('%s/abcdefg' % req.uri)
>        
>    # neither does this one [and the resulting page is quite
>    # messed up because the relative urls inside the doc don't
>    # make sense without the rewrite]
>    elif choice == '2':
>        req.internal_redirect('/manual/index.html')
>
>    # but this one does
>    elif choice == '3':
>        req.internal_redirect('/manual')
>
>    else:
>        req.write('''
>        <html>
>        <body>
>        <a href=%s?redirect=1>redirect to %s/abcdefg</a><br>
>        <a href=%s?redirect=2>redirect to /manual/index.html</a><br>
>        <a href=%s?redirect=3>redirect to /manual</a><br>
>        </body>
>        </html>
>        ''' % ((req.uri,)*4))
>
>
>    return apache.OK
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
From dpopowich at mtrsd.k12.ma.us  Mon Dec 22 12:34:09 2003
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Fri Jan  9 22:00:40 2004
Subject: [mod_python] redirects and url rewriting
In-Reply-To: <1006403.1072113054814.JavaMail.jciccale@mac.com>
References: <1006403.1072113054814.JavaMail.jciccale@mac.com>
Message-ID: <16359.11025.459664.120166@gargle.gargle.HOWL>



> I think the best option for your problem is:
> 
> req.headers_out[ "Location" ] = uri
> return apache.HTTP_MOVED_PERMANENTLY #301 
> 

This won't work for some of what I'm doing, i.e., user goes to a page
that needs authentication so they are redirected to a login page
(without having to save state to a session).  There are other similar
situations where, programmatically, you discover that the user should
be somewhere else within your mod_python app and you'd like to
redirect them to other URIs which can check req.prev for existing
state (thus saving network traffic, server hits, etc.  Heck, you got
everything you need to know, why tell the client, "go here" when you
can just deliver it in the first place?).

Also, being the kind of geek that needs to know how and why things
work, I'd like to know why some redirects rewrite my browser url and
some don't; ultimately, I'd like to be able to control the behaviour
with mod_python.

Dan

> >
> >When I use req.internal_redirect(some_uri) sometimes the url in my
> >browser gets rewritten to reflect some_uri and some times it doesn't,
> >remaining as the uri of the originally selected page.  This can cause
> >numerous problems with relative links inside a page if the url is not
> >rewritten in the browser.
> >
> >I'm trying to understand what causes this and how I can control it.
> >Can someone point me to some doc?
> >
> >Below is a short handler I wrote as an example (the links I use assume
> >you have the apache manual installed; modify if necessary).
> >
> >[modpython 3.1.2b, python 2.3.2, apache 2.0.40]
> >
> >Thanks,
> >
> >------------------
> >Daniel Popowich
> >Network Specialist
> >-------------------------------------
> >Mohawk Trail Regional School District
> >24 Ashfield Rd.
> >Shelburne Falls, MA 01370
> >413.625.0192 x22
> >-------------------------------------
> >
> ># -*- python -*-
> >
> >from mod_python import apache, util
> >
> >def handler(req):
> >
> >    req.content_type = 'text/html'
> >
> >    form = util.FieldStorage(req)
> >    choice = form.getfirst('redirect')
> >    # this doesn't rewrite the url in the browser
> >    if choice == '1':
> >        req.internal_redirect('%s/abcdefg' % req.uri)
> >        
> >    # neither does this one [and the resulting page is quite
> >    # messed up because the relative urls inside the doc don't
> >    # make sense without the rewrite]
> >    elif choice == '2':
> >        req.internal_redirect('/manual/index.html')
> >
> >    # but this one does
> >    elif choice == '3':
> >        req.internal_redirect('/manual')
> >
> >    else:
> >        req.write('''
> >        <html>
> >        <body>
> >        <a href=%s?redirect=1>redirect to %s/abcdefg</a><br>
> >        <a href=%s?redirect=2>redirect to /manual/index.html</a><br>
> >        <a href=%s?redirect=3>redirect to /manual</a><br>
> >        </body>
> >        </html>
> >        ''' % ((req.uri,)*4))
> >
> >
> >    return apache.OK
> >
> >_______________________________________________
> >Mod_python mailing list
> >Mod_python@modpython.org
> >http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> >

From michael at dynamine.net  Mon Dec 22 11:34:16 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 22:00:40 2004
Subject: [mod_python] redirects and url rewriting
In-Reply-To: <16359.11025.459664.120166@gargle.gargle.HOWL>
References: <1006403.1072113054814.JavaMail.jciccale@mac.com>
	<16359.11025.459664.120166@gargle.gargle.HOWL>
Message-ID: <3FE74738.4090706@dynamine.net>

Daniel J. Popowich wrote:

> 
>>I think the best option for your problem is:
>>
>>req.headers_out[ "Location" ] = uri
>>return apache.HTTP_MOVED_PERMANENTLY #301 
>>
> 
> 
> This won't work for some of what I'm doing, i.e., user goes to a page
> that needs authentication so they are redirected to a login page
> (without having to save state to a session).  There are other similar
> situations where, programmatically, you discover that the user should
> be somewhere else within your mod_python app and you'd like to
> redirect them to other URIs which can check req.prev for existing
> state (thus saving network traffic, server hits, etc.  Heck, you got
> everything you need to know, why tell the client, "go here" when you
> can just deliver it in the first place?).
> 
> Also, being the kind of geek that needs to know how and why things
> work, I'd like to know why some redirects rewrite my browser url and
> some don't; ultimately, I'd like to be able to control the behaviour
> with mod_python.

I don't know why mod_python is behaving in the manner you describe, but 
I can tell you that a clear understanding of the HTTP protocol is needed 
here.

Browsers determine what to display in the address bar based on two 
things only: (1) the URL requested by a user (bookmark, address bar or 
some other UI mechanism), or (2) an HTTP Redirect: header returned by 
the server.

Without either of those, there is no way for the browser to know that 
the page requested at /foo/bar can be found in the future at /baz/quux.

--Michael
From kevin at sb.org  Mon Dec 22 14:47:08 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:00:40 2004
Subject: [mod_python] redirects and url rewriting
In-Reply-To: <16359.11025.459664.120166@gargle.gargle.HOWL>
References: <1006403.1072113054814.JavaMail.jciccale@mac.com>
	<16359.11025.459664.120166@gargle.gargle.HOWL>
Message-ID: <A0BDA434-34B7-11D8-B640-000A95A072FC@sb.org>

I meant to send this to the list, but I accidentally sent it to Daniel 
Popowich instead.

-----

Well, I just did a curl on http://localhost/manual and these were the 
headers I got:

HTTP/1.1 301 Moved Permanently
Date: Mon, 22 Dec 2003 17:53:24 GMT
Server: Apache/2.0.48 (Unix) DAV/2 mod_python/3.0.4 Python/2.3
Location: http://localhost/manual/
Content-Length: 341
Content-Type: text/html; charset=iso-8859-1

Does that explain it well enough for you?

On Dec 22, 2003, at 12:34 PM, Daniel J. Popowich wrote:

> Also, being the kind of geek that needs to know how and why things
> work, I'd like to know why some redirects rewrite my browser url and
> some don't; ultimately, I'd like to be able to control the behaviour
> with mod_python.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From michael at dynamine.net  Mon Dec 22 11:50:27 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 22:00:40 2004
Subject: [mod_python] redirects and url rewriting
In-Reply-To: <3FE74738.4090706@dynamine.net>
References: <1006403.1072113054814.JavaMail.jciccale@mac.com>
	<16359.11025.459664.120166@gargle.gargle.HOWL> <3FE74738.4090706@dynamine.net>
Message-ID: <3FE74B03.70506@dynamine.net>

I wrote:

> Browsers determine what to display in the address bar based on two 
> things only: (1) the URL requested by a user (bookmark, address bar or 
> some other UI mechanism), or (2) an HTTP Redirect: header returned by 
> the server.

That should be an HTTP Location: header combined with a 301/302 HTTP 
response code.

--Michael
From dpopowich at mtrsd.k12.ma.us  Mon Dec 22 15:36:01 2003
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Fri Jan  9 22:00:40 2004
Subject: [mod_python] redirects and url rewriting
In-Reply-To: <3FE74B03.70506@dynamine.net>
References: <1006403.1072113054814.JavaMail.jciccale@mac.com>
	<16359.11025.459664.120166@gargle.gargle.HOWL>
	<3FE74738.4090706@dynamine.net>
	<3FE74B03.70506@dynamine.net>
Message-ID: <16359.21937.84003.871912@gargle.gargle.HOWL>


Michael S. Fischer writes:
> I wrote:
> 
> > Browsers determine what to display in the address bar based on two 
> > things only: (1) the URL requested by a user (bookmark, address bar or 
> > some other UI mechanism), or (2) an HTTP Redirect: header returned by 
> > the server.
> 

Yes, of course.  Duh.  I now think I understand what's going on:

  1. A call to req.internal_redirect(uri) will return the content of
     the uri as the address the user asked for UNLESS the HTTP
     Location header is sent.  This is what I had been originally
     expecting until the redirect to certain urls (like
     http://localhost/manual) changed in my browser's address bar.
     Confusion insued until Kevin Ballard replied with clues that...

  2. ...apache, when receiving requests that are directories (or
     aliases/symlinks to directories) without the trailing slash,
     actually sends a 301 response.  So, a request like
     http://host/foo will generate a 301 response if foo is a
     directory and send a "Location: http://host/foo/" header.  I was
     first shocked by this (think of all the extra bytes flooding the
     'net because of this!!), but understand it's the only way within
     the protocol to make relative links work.  (Although it begs the
     question why the protocol doesn't have a Real-Location header, or
     some such, to let the browser know what the real url for the
     requested page should be without having to go fetch it.)

Sound right?

Knowing now what I can expect consistantly (and knowing it's not for
lack of understanding mod_python subtleties) and can continue with my
app design.  Thanks for all your help!

Dan


From neel at mediapulse.com  Mon Dec 22 16:37:52 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:00:40 2004
Subject: [mod_python] redirects and url rewriting
Message-ID: <C0FC22C08B82074A88B500617641577787A7F1@johnson.mediapulse.net>

>      directory and send a "Location: http://host/foo/" header.  I was
>      first shocked by this (think of all the extra bytes flooding the
>      'net because of this!!), but understand it's the only way within
>      the protocol to make relative links work.  (Although it begs the
>      question why the protocol doesn't have a Real-Location header, or
>      some such, to let the browser know what the real url for the
>      requested page should be without having to go fetch it.)

A 301 status is Moved Permanently, so that is your "Real-Location"
header.  In an ideal world browsers would update (or prompt to update)
bookmarks on such a status, but it looks like that's not going to
happen.

A 302 is Moved Temporarily, for when you wouldn't want a browser to
update it info, however given the way browsers ignore RFC's and W3C it
wouldn't surprise me to find out browser x didn't handle a 302
correctly.

I wonder how many browsers would know what to do with a 203,
Non-Authoritative Information - which is sorta like a DNS query that's
cached...

Mike

From jalil at securia.com  Mon Dec 22 15:27:02 2003
From: jalil at securia.com (Jalil Feghhi)
Date: Fri Jan  9 22:00:40 2004
Subject: [mod_python] FW: Any way to embed Python in HTML?
Message-ID: <004201c3c8e3$1acc16a0$6502a8c0@securia.com>

 
I am new to mod_python and haven't seen any examples where you can put
python code in HTML pages. Is this not supported? If not supported, is
there any way or work around (other than using the request write method)
to separate HTML writing from coding?
 
Thanks,
 
-Jalil
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20031222/0f54ce49/attachment-0002.htm
From jalil at securia.com  Mon Dec 22 15:49:53 2003
From: jalil at securia.com (Jalil Feghhi)
Date: Fri Jan  9 22:00:40 2004
Subject: [mod_python] Problem keeing the db connection open
Message-ID: <005201c3c8e6$4c073580$6502a8c0@securia.com>

I found the following code on the Internet for keeping the connection
open but it doesn't really work. Everytime I try to login, it connects
to the database. I put some log messges and I can see this happens.

1. Could someone tell me how I can keep the connection open? 

2.  I appreciate if someone explain how mod_python handler is called
when there are many requests? Does Apache create threads for each
request? And how the global database connection is used?

Thanks,

-Jalil

Here is the code:

HOST = "localhost"

DB = "mydb"

USER = "user"

PASS = "pwd"

import MySQLdb

import string

def _db_login(relogin = 0):


    global DB_CONN

    if relogin:

        DB_CONN = MySQLdb.connect(db=DB, user=USER, passwd=PASS)

        return DB_CONN

    else:

        try:

            d = DB_CONN

            return d

        except NameError:

            DB_CONN = MySQLdb.connect(host= HOST, db=DB, user=USER,
passwd=PASS)

            return DB_CONN

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20031222/bad48455/attachment-0002.htm
From grisha at modpython.org  Mon Dec 22 19:42:38 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:00:40 2004
Subject: [mod_python] Changing the status code with custom content
In-Reply-To: <C0FC22C08B82074A88B500617641577787A7F0@johnson.mediapulse.net>
References: <C0FC22C08B82074A88B500617641577787A7F0@johnson.mediapulse.net>
Message-ID: <20031222193816.N83390@onyx.ispol.com>


I believe you should req.write() your error page, set req.status to the
the error code you want and return apache.OK. If you retrun anything other
then apache.OK, then Apache assumes you want it to send its own stock
error page.

(Hope this answers your question, I'm a bit woozy on nuquil right now....)

Grisha

On Mon, 22 Dec 2003, Michael C. Neel wrote:

> I'm having trouble using mod_python to change the status code and have
> custom content in the error message.  If I return something other than
> apache.OK in my handler, the status line is set correctly set but apache
> returns the default error page.  If I have sent custom content for the
> error message, the apache error message is added to the end of the
> document.  I can get around this by using an ErrorDocument directive in
> apache's conf, but I loose access to the traceback of the error and thus
> the ability to have a really custom error message.
>
> At first glance this didn't seem to matter.  As long as the content said
> error, the user knew of the problem, even if the status was 200 OK.
> However I've found out now with search bots this does matter - they
> don't know that they have a bad url for the site and are indexing error
> pages thinking they are legit.
>
> Any thoughts on what I may be over looking?
>
> Thanks,
> Mike
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From dpopowich at mtrsd.k12.ma.us  Mon Dec 22 19:55:13 2003
From: dpopowich at mtrsd.k12.ma.us (Daniel Popowich)
Date: Fri Jan  9 22:00:40 2004
Subject: [mod_python] redirects and url rewriting
In-Reply-To: <C0FC22C08B82074A88B500617641577787A7F1@johnson.mediapulse.net>
References: <C0FC22C08B82074A88B500617641577787A7F1@johnson.mediapulse.net>
Message-ID: <33585.24.91.183.76.1072140913.squirrel@www.mtrsd.k12.ma.us>

>>      directory and send a "Location: http://host/foo/" header.  I was
>>      first shocked by this (think of all the extra bytes flooding the
>>      'net because of this!!), but understand it's the only way within
>>      the protocol to make relative links work.  (Although it begs the
>>      question why the protocol doesn't have a Real-Location header, or
>>      some such, to let the browser know what the real url for the
>>      requested page should be without having to go fetch it.)
>
> A 301 status is Moved Permanently, so that is your "Real-Location"
> header.  In an ideal world browsers would update (or prompt to update)
> bookmarks on such a status, but it looks like that's not going to
> happen.

I wasn't very clear.  For pages that have moved or for pages that haven't
moved but aren't in proper form (like my example, http://host/foo ->
http://host/foo/) on the SAME server, it seems unfortunate that the
servers can't return the page along with some header indicating that fact.

For example, why can't a request for http://host/foo return
http://host/foo/index.html with a header

  Real-Location: http://host/foo/

instead of returning a 30[12] with a Location header only to have the
browser go back to the same server.  Seems wasteful.

The 30[12] with Location header makes perfect sense for pages moved
to different servers.

Dan


From alunchampion at btconnect.com  Mon Dec 22 21:57:55 2003
From: alunchampion at btconnect.com (Alun)
Date: Fri Jan  9 22:00:40 2004
Subject: [mod_python] mod_python disables mod_dav
Message-ID: <200312230157.hBN1vW1B092956@slash.mediapulse.com>

I seem to have a problem adding mod_python to an existing configuration with
mod_dav.
I have mod_dav enabled and working and planned on integrating mod_python but
when I *only* add the LoadModule mod_python directive to the httpd.conf,
WebDAV no longer works and I get a 405 status returned.

Any help would be appreciated.

Checking OPTIONS on the URL before and after adding LoadModule gives:

=====Before====
OPTIONS /author/ http/1.1
Host: localhost:80

HTTP/1.1 200 OK
Date: Mon, 22 Dec 2003 21:47:46 GMT
Server: Apache/2.0.48 (Win32) mod_jk2/2.0.2 DAV/2
DAV: 1,2
MS-Author-Via: DAV
Allow:
OPTIONS,GET,HEAD,POST,DELETE,TRACE,PROPFIND,PROPPATCH,COPY,MOVE,LOCK,UNLOCK
Content-Length: 0
Content-Type: httpd/unix-directory

=====After LoadModule mod_python modules/mod_python.so=====
OPTIONS /author/ http:/1.1
Host: localhost:80

HTTP/1.1 200 OK
Date: Mon, 22 Dec 2003 21:28:47 GMT
Server: Apache/2.0.48 (Win32) mod_jk2/2.0.2 mod_python/3.1.2b Python/2.3.2
DAV/2

Allow: GET,HEAD,POST,OPTIONS,TRACE     <======== No DAV commands.
Content-Length: 0
Connection: close
Content-Type: httpd/unix-directory

From stian at soiland.no  Tue Dec 23 02:45:36 2003
From: stian at soiland.no (Stian =?iso-8859-1?Q?S=F8iland?=)
Date: Fri Jan  9 22:00:40 2004
Subject: [mod_python] Re: FW: Any way to embed Python in HTML?
In-Reply-To: <004201c3c8e3$1acc16a0$6502a8c0@securia.com>
References: <004201c3c8e3$1acc16a0$6502a8c0@securia.com>
Message-ID: <20031223014536.GB16301@itea.ntnu.no>

On 2003-12-23 00:27:02, Jalil Feghhi wrote:

> I am new to mod_python and haven't seen any examples where you can put
> python code in HTML pages. Is this not supported? If not supported, is
> there any way or work around (other than using the request write method)
> to separate HTML writing from coding?

Take a look at upcoming PSP from Mod-python 3.1.2b:

http://www.modpython.org/live/mod_python-3.1.2b/doc-html/pyapi-psp.html



I've also experienced some success with using template engines like
Cheetah combined with mod_python.

This is how we've done things using cheetah and mod_python's
Publisher-handler:


Made a general page template MainTemplate.tmpl:

    #attr title = "Default title"
    <html>
      <head>
        <title>$title</title>
      </head>
      <body>
        <h1>$title</h1>
        <div class="menu">
          menu blabla
          (details left out)
        </div>  
        <div class="content">
    #def content    
            No content here yet, this is just
            the base template
    #end def
    $content()
        </div>


Here's a specialized page template WelcomeTemplate.tmpl

    #extends MainTemplate
    #def content
            Welcome to our world. Blablabla
            blablabla.
    #end def     
 

These template-files are compiled with cheetah-compile - which produces
a rather nasty .py-file. This file could be imported and used from
Python.

In .htaccess:

    SetHandler mod_python
    PythonHandler mod_python.publisher


in welcome.py:

    from WelcomeTemplate import WelcomeTemplate 
    def index(req):
        templ = WelcomeTemplate()
        templ.title = "Welcome, my friend"
        return templ


Blocks made within templates (the #def's) are callable methods from
within Python, and therefore templates could be used for smaller building
blocks as well.  templ.content could be changed to any other template,
or even a python function defined somewhere else.


Model view controller
=====================

In our current ongoing project, Cerebrum, we've succeeded in seperating
content from control, and even seperating the model from control. This
is the old MVC (model-view-controller) principle as we've used it:

       model          controller                  view
  business logic      web logic             presentation logic
  (what to do)      (what to show)             (how to view)

 python classes     python classes           cheetah templates
 representing the   for web access, ie.      with calls to other
 data, methods      each method accessed     templates and
 for operations     from the browser.        helper classes in
                    Performs operations on   python
                    model and views by
                    calling cheetah 
                    templates. 
 

Example:
========
code is simplified, and never tested in simplified form. It will
probably not work directly. The real code can be viewed on 
http://cvs.sourceforge.net/viewcvs.py/cerebrum/cerebrum/ under the
directories Cerebrum/client and web/ - note however
that the code is constantly changing at this part of the web project.


Model - Cerebrum/client/BofhModel.py
------------------------------------


class Entity:
    def __init__(self, server):
        # xmlrpc-connection
        self.server = server

    def fetch_by_id(cls, server, id):
        # make a new instance of the called-on class,
        # ie. a Group or Entity
        entity = cls(server)
        entity.load_entity_info(id)
        return entity
    fetch_by_id = classmethod(fetch_by_id)

    def load_entity_info(self, id):
        self.id = id
        info = self.server.entity_info(id)
        self.type = info['type']
        return info

class Group(Entity):
    def load_entity_info(self, id):
        info = Entity.load_entity_info(self, id)
        self.name = info['name']
        self.description = info['description']
        return info
    

View - web/lib/cereweb/templates/GroupViewTemplate.tmpl
--------------------------------------------------------

## Be international, import function gettext() as _()
#from gettext import gettext as _
#def viewGroup(group)
    <h1>$_("Group") $group.name</h1>
    $groupInfo($group)
#end def

#def groupInfo(group)
    <div class="info">
    <dl>
        <dt>$_("Name")</dt>
        <dd>$group.name</dd>
        <dt>$_("Description")</dt>
        <dd>$group.description</dd>
    </dl>
    </div>
#end def

MainTemplate.tmpl almost like shown in previous text.


Controller - htdocs/group.py
----------------------------

from Cerebrum.web.templates.MainTemplate import MainTemplate
from Cerebrum.web.templates.GroupViewTemplate import GroupViewTemplate
from Cerebrum.client import BofhModel

def view(req, id):
    # Get a generic view (menu, header, footer)
    page = MainTemplate()
    # the session and the xmlrpc server connection has been prepared by
    # a handler in .htaccess
    server = req.session['server']
    # get the object from the model   
    group = BofhModel.Group.fetch_by_id(server, id)
    # prepare the specialiced view
    view = GroupViewTemplate()
    # pass the model to the view 
    page.content = view.viewGroup(group)
    # and return the final result (within the MainTemplate)
    # to the browser
    return page
    

Notice how the controller is rather small and only glues together the view
and the model. In this example, the model is just an xmlrpc abstraction,
so even the business logic is hidden.  In this case the controller
actually uses two views, both MainTemplate (the menu, footer, etc.) and
GroupViewTemplate.  The reason for not subclassing MainTemplate into
GroupViewTemplate is that we needed to pass on the chosen group object
(from the Model), and that a groupview could be usable from within other
views as well. 


-- 
Stian S?iland               Work toward win-win situation. Win-lose
Trondheim, Norway           is where you win and the other lose.
http://www.soiland.no/      Lose-lose and lose-win are left as an
                            exercise to the reader.  [Limoncelli/Hogan]

From gnb at itga.com.au  Tue Dec 23 13:07:07 2003
From: gnb at itga.com.au (Gregory Bond)
Date: Fri Jan  9 22:00:40 2004
Subject: [mod_python] FW: Any way to embed Python in HTML? 
In-Reply-To: Your message of Mon, 22 Dec 2003 15:27:02 -0800.
Message-ID: <200312230207.NAA06930@lightning.itga.com.au>

You could consider Albatross, which has a nice Model/Controller/View paradigm, 
and does HTML templating (and session handling and heaps of other stuff).

http://www.object-craft.com.au/projects/albatross/


From stephen at vermeulen.ca  Mon Dec 22 19:41:15 2003
From: stephen at vermeulen.ca (Stephen Vermeulen)
Date: Fri Jan  9 22:00:40 2004
Subject: [mod_python] FW: Any way to embed Python in HTML?
In-Reply-To: <004201c3c8e3$1acc16a0$6502a8c0@securia.com>
References: <004201c3c8e3$1acc16a0$6502a8c0@securia.com>
Message-ID: <3FE7AB4B.9020107@vermeulen.ca>

Jalil Feghhi wrote:

>  
> I am new to mod_python and haven't seen any examples where you can put 
> python code in HTML pages. Is this not supported?

While working with mod_python 3.03 I did something along these lines, 
which I consider to be a rather
evil hack (this was done on some "for internal use only" pages). I used 
python's pickle module to serialize up some
objects, then base64 encoded them into ASCII form, and then placed the 
resulting text into hidden form fields
on the page that was served up. This allowed me to pass some complex 
state information (that was expensive to
generate, and was also generated by a different program at an earlier 
time) relating to the page that the user
was editing into the mod_python code that did the editing.


> If not supported, is there any way or work around (other than using 
> the request write method) to separate HTML writing from coding?
>  
> Thanks,
>  
> -Jalil

Regards,

Stephen


From gdamjan at mail.net.mk  Tue Dec 23 03:47:22 2003
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 22:00:40 2004
Subject: [mod_python] mod_python disables mod_dav
In-Reply-To: <200312230157.hBN1vW1B092956@slash.mediapulse.com>
References: <200312230157.hBN1vW1B092956@slash.mediapulse.com>
Message-ID: <20031223024722.GA18811@legolas.on.net.mk>

> I seem to have a problem adding mod_python to an existing configuration with
> mod_dav.
> I have mod_dav enabled and working and planned on integrating mod_python but
> when I *only* add the LoadModule mod_python directive to the httpd.conf,
> WebDAV no longer works and I get a 405 status returned.
> 
> Any help would be appreciated.

Quick workaround, put the "LoadModule mod_python" directive above the 
"LoadModule mod_dav" directive - apache will execute the modules
bottom-to-top - that way mod_dav will be first to execute.





-- 
Damjan Georgievski
jabberID: damjan@bagra.net.mk
From grisha at modpython.org  Mon Dec 22 22:00:03 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:00:40 2004
Subject: [mod_python] mod_python disables mod_dav
In-Reply-To: <200312230157.hBN1vW1B092956@slash.mediapulse.com>
References: <200312230157.hBN1vW1B092956@slash.mediapulse.com>
Message-ID: <20031222215922.N85305@onyx.ispol.com>


I believe Damjan reported that if you swap the lines (put first whichever
was second) the problem goes away,

HTH,

Grisha

On Mon, 22 Dec 2003, Alun wrote:

> I seem to have a problem adding mod_python to an existing configuration with
> mod_dav.
> I have mod_dav enabled and working and planned on integrating mod_python but
> when I *only* add the LoadModule mod_python directive to the httpd.conf,
> WebDAV no longer works and I get a 405 status returned.
>
> Any help would be appreciated.
>
> Checking OPTIONS on the URL before and after adding LoadModule gives:
>
> =====Before====
> OPTIONS /author/ http/1.1
> Host: localhost:80
>
> HTTP/1.1 200 OK
> Date: Mon, 22 Dec 2003 21:47:46 GMT
> Server: Apache/2.0.48 (Win32) mod_jk2/2.0.2 DAV/2
> DAV: 1,2
> MS-Author-Via: DAV
> Allow:
> OPTIONS,GET,HEAD,POST,DELETE,TRACE,PROPFIND,PROPPATCH,COPY,MOVE,LOCK,UNLOCK
> Content-Length: 0
> Content-Type: httpd/unix-directory
>
> =====After LoadModule mod_python modules/mod_python.so=====
> OPTIONS /author/ http:/1.1
> Host: localhost:80
>
> HTTP/1.1 200 OK
> Date: Mon, 22 Dec 2003 21:28:47 GMT
> Server: Apache/2.0.48 (Win32) mod_jk2/2.0.2 mod_python/3.1.2b Python/2.3.2
> DAV/2
>
> Allow: GET,HEAD,POST,OPTIONS,TRACE     <======== No DAV commands.
> Content-Length: 0
> Connection: close
> Content-Type: httpd/unix-directory
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From mark at camazotz.com  Mon Dec 22 22:13:50 2003
From: mark at camazotz.com (Mark Smith)
Date: Fri Jan  9 22:00:40 2004
Subject: [mod_python] Re: FW: Any way to embed Python in HTML?
In-Reply-To: <200312230245.hBN2jU1C093084@slash.mediapulse.com>
References: <200312230245.hBN2jU1C093084@slash.mediapulse.com>
Message-ID: <07C1B262-34F6-11D8-9F73-00039364CE50@camazotz.com>

> I am new to mod_python and haven't seen any examples where you can put
> python code in HTML pages. Is this not supported? If not supported, is
> there any way or work around (other than using the request write 
> method)
> to separate HTML writing from coding?

PWO (http://www.jamwt.com/pwo/) is a simple JSP-style processor that 
allows you to embed Python code.  I think it has a less cluttered 
syntax than many of the alternatives.

If you want something more complex that supports MVC, have a look at 
Draco (http://draco.boskant.nl/).  It's nicely thought out and well 
documented (although the database component is rather low-level.)

From gnb at itga.com.au  Tue Dec 23 15:08:54 2003
From: gnb at itga.com.au (Gregory Bond)
Date: Fri Jan  9 22:00:40 2004
Subject: [mod_python] Re: FW: Any way to embed Python in HTML? 
In-Reply-To: Your message of Mon, 22 Dec 2003 22:13:50 -0500.
Message-ID: <200312230408.PAA13869@lightning.itga.com.au>


I've added an entry to the mod_python FAQ (3.10) to cover this and similar
questions. Please feel free to update or add to the info I've put there.


From neel at mediapulse.com  Tue Dec 23 09:46:25 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:00:40 2004
Subject: [mod_python] Changing the status code with custom content
Message-ID: <C0FC22C08B82074A88B50061764157776B9906@johnson.mediapulse.net>

Is req.status a 3.x only thing (reason I didn't see this is it's not
listed in the 2.x docs - and this server happens to be 2.x)?

Mike

> -----Original Message-----
> From: Gregory (Grisha) Trubetskoy [mailto:grisha@modpython.org] 
> Sent: Monday, December 22, 2003 7:43 PM
> To: Michael C. Neel
> Cc: mod_python@modpython.org
> Subject: Re: [mod_python] Changing the status code with custom content
> 
> 
> 
> I believe you should req.write() your error page, set 
> req.status to the
> the error code you want and return apache.OK. If you retrun 
> anything other
> then apache.OK, then Apache assumes you want it to send its own stock
> error page.
> 
> (Hope this answers your question, I'm a bit woozy on nuquil 
> right now....)
> 
> Grisha
> 
> On Mon, 22 Dec 2003, Michael C. Neel wrote:
> 
> > I'm having trouble using mod_python to change the status 
> code and have
> > custom content in the error message.  If I return something 
> other than
> > apache.OK in my handler, the status line is set correctly 
> set but apache
> > returns the default error page.  If I have sent custom 
> content for the
> > error message, the apache error message is added to the end of the
> > document.  I can get around this by using an ErrorDocument 
> directive in
> > apache's conf, but I loose access to the traceback of the 
> error and thus
> > the ability to have a really custom error message.
> >
> > At first glance this didn't seem to matter.  As long as the 
> content said
> > error, the user knew of the problem, even if the status was 200 OK.
> > However I've found out now with search bots this does matter - they
> > don't know that they have a bad url for the site and are 
> indexing error
> > pages thinking they are legit.
> >
> > Any thoughts on what I may be over looking?
> >
> > Thanks,
> > Mike
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> 

From dpopowich at mtrsd.k12.ma.us  Tue Dec 23 10:08:13 2003
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Fri Jan  9 22:00:40 2004
Subject: [mod_python] default Session timeout
Message-ID: <16360.23133.264930.249115@gargle.gargle.HOWL>


In mod_python.Session the default timeout is set like this:

  DFT_TIMEOUT=30*60*60 # 30 min

That's 30 hours, not minutes.  :-)

------------------
Daniel Popowich
Network Specialist
-------------------------------------
Mohawk Trail Regional School District
24 Ashfield Rd.
Shelburne Falls, MA 01370
413.625.0192 x22
-------------------------------------

From pkeshishian at yahoo.com  Tue Dec 23 12:16:17 2003
From: pkeshishian at yahoo.com (Petros Keshishian)
Date: Fri Jan  9 22:00:40 2004
Subject: [mod_python] displaying python output
Message-ID: <20031223201617.97907.qmail@web40015.mail.yahoo.com>

I am trying to setup mod_python for the first time and
everything seems to be working, except instead of
displaying the output from mod_python in clients
browser it is asking for the file name to save the
output. If you save the output it is exactly what it
was supposed to display. Here is the famous hello.py
that I am using to test the setup.

def say(req,what="Nothing"):
    return "I am saying %s" % what

It is in /usr/local/apache2/htdocs/py-bin/ directory.
The following is set in the http.conf file:

<Directory "/usr/local/apache2/htdocs/py-bin">
                                                      
                                                      
   
    SetHandler python-program
    PythonHandler mod_python.publisher
    PythonDebug On
                                                      
                                                      
   
</Directory>

I am trying to access hello/say using:

http://localhost/py-bin/hello/say

How do I change the output to be directed to the
browser instead of a file.

Thanks a lot for your help
Petros



__________________________________
Do you Yahoo!?
New Yahoo! Photos - easier uploading and sharing.
http://photos.yahoo.com/
From michael at dynamine.net  Tue Dec 23 12:26:52 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 22:00:40 2004
Subject: [mod_python] displaying python output
In-Reply-To: <20031223201617.97907.qmail@web40015.mail.yahoo.com>
References: <20031223201617.97907.qmail@web40015.mail.yahoo.com>
Message-ID: <3FE8A50C.2070202@dynamine.net>

What do the HTTP response headers say the Content-Type is?

--Michael

Petros Keshishian wrote:

> I am trying to setup mod_python for the first time and
> everything seems to be working, except instead of
> displaying the output from mod_python in clients
> browser it is asking for the file name to save the
> output. If you save the output it is exactly what it
> was supposed to display. Here is the famous hello.py
> that I am using to test the setup.
> 
> def say(req,what="Nothing"):
>     return "I am saying %s" % what
> 
> It is in /usr/local/apache2/htdocs/py-bin/ directory.
> The following is set in the http.conf file:
> 
> <Directory "/usr/local/apache2/htdocs/py-bin">
>                                                       
>                                                       
>    
>     SetHandler python-program
>     PythonHandler mod_python.publisher
>     PythonDebug On
>                                                       
>                                                       
>    
> </Directory>
> 
> I am trying to access hello/say using:
> 
> http://localhost/py-bin/hello/say
> 
> How do I change the output to be directed to the
> browser instead of a file.
> 
> Thanks a lot for your help
> Petros
> 
> 
> 
> __________________________________
> Do you Yahoo!?
> New Yahoo! Photos - easier uploading and sharing.
> http://photos.yahoo.com/
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 
From greenbeard400 at yahoo.com  Wed Dec 24 11:12:54 2003
From: greenbeard400 at yahoo.com (Greenbeard)
Date: Fri Jan  9 22:00:40 2004
Subject: [mod_python] Problem on OpenBSD with Publisher Handler 
Message-ID: <20031224191254.2564.qmail@web21326.mail.yahoo.com>

I am getting this error when trying to use the
publisher handler.

Mod_python error: "PythonHandler mod_python.publisher"

Traceback (most recent call last):

  File
"/usr/local/lib/python2.2/site-packages/mod_python/apache.py",
line 332, in HandlerDispatch
    result = object(req)

  File
"/usr/local/lib/python2.2/site-packages/mod_python/publisher.py",
line 142, in handler
    if req.extension:  # this exists if we're running
in a | .ext handler

AttributeError: 'mp_request' object has no attribute
'extension'

my httpd.conf is as described in the docs:

<Directory /home/myServer/apache2/htdocs>
  AddHandler python-program .py
  PythonHandler mod_python.publisher
  PythonDebug On
</Directory>

Simple test script:

from mod_python import apache

def test(req):
    x = "Testing 123"
    return x


Any ideas?  My error log does not have anything
different than the message above.
  
I am running Apache/2.0.44, mod_python/3.0.1,
Python/2.2.1 - right now I can not upgrade any of
these .  
 

Thanks!

gb400

__________________________________
Do you Yahoo!?
Free Pop-Up Blocker - Get it now
http://companion.yahoo.com/
From hnease at midsouth.rr.com  Sat Dec 27 15:51:29 2003
From: hnease at midsouth.rr.com (Howard Nease)
Date: Fri Jan  9 22:00:40 2004
Subject: [mod_python] 
	Win32 Binary Error: "*** run_installscript: internal error
	0xFFFFFFFF ***"
Message-ID: <000801c3ccc3$95d9e500$a000a8c0@stephen>

Hello, all. I recently tried to install mod_python on my Windows XP Home machine, and I got the above error. Here's the context:

Traceback (most recent call last):
  File "E:\Python23\Scripts\win32_postinstall.py", line 90, in ?
    shutil.copy2(mp, os.path.join(apachedir, "modules"))
  File "E:\Python23\Lib\shutil.py", line 82, in copy2
    copyfile(src, dst)
  File "E:\Python23\Lib\shutil.py", line 38, in copyfile
    fdst = open(dst, 'wb')
IOError: [Errno 13] Permission denied: 'E:/Program Files/Apache Group/Apache2\\modules\\mod_python.so'
*** run_installscript: internal error 0xFFFFFFFF ***

Does anyone have a clue as to what I'm doing wrong? I've Googled for a clue, but no dice. Thanks a lot!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20031227/d7569fac/attachment-0002.htm
From RussLear314 at yahoo.com  Sat Dec 27 19:44:55 2003
From: RussLear314 at yahoo.com (Russell Lear)
Date: Fri Jan  9 22:00:40 2004
Subject: [mod_python] Session unable to acquire mutex lock?
Message-ID: <200312271944.55425.RussLear314@yahoo.com>

Hi,

I'm a newbie to mod_python so forgive me if this is a terribly obvious
question (I've looked through the archives without much success).

I'm trying to use sessions.  Right now I have a slightly modified version
of mptest.py as follows (it doesn't make sense, but it does show my
problem):

    from mod_python import apache, Session
    import sys

    def handler(req):
        req.content_type = 'text/plain'
        req.write("Creating...\n")
        sess = Session.Session(req)
        req.write("Hello World!")
        return apache.OK

When I run it, I see:

     Mod_python error: "PythonHandler mptest"

     Traceback (most recent call last):

       File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 338, in HandlerDispatch
         result = object(req)

       File "/srv/www/htdocs/test/mptest.py", line 7, in handler
         sess = Session.Session(req)

       File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 411, in Session
         timeout=timeout)

       File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 316, in __init__
         secret=secret, timeout=timeout)

       File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 170, in __init__
         self.lock()                 # lock new sid

       File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 241, in lock
         _apache._global_lock(self._req.server, self._sid)

     ValueError: Failed to acquire global mutex lock


What am I doing wrong here?!

Thanks for any suggestions,
Russell.

PS:

I'm running on SuSE 9.0 Linux.

Python reports version "Python 2.3+ (#1, Sep 23 2003, 23:07:16)".

>From the Apache error page: 
    Apache/2.0.48 (Linux/SuSE), 
    mod_python/3.1.2b 
    Python/2.3+.

The only glitch I had in building mod_python was that I needed to specify 
    ./configure --with-apxs=/usr/sbin/apxs2

rather than just refering to apxs.

My apache configuration is (from the tutorial):
<Directory /srv/www/htdocs/test> 
  AddHandler python-program .py
  PythonHandler mptest 
  PythonDebug On 
</Directory>



From div at newcode.se  Sun Dec 28 18:52:53 2003
From: div at newcode.se (Carl-Johan Kihlbom)
Date: Fri Jan  9 22:00:40 2004
Subject: [mod_python] mod_python not working on Mac OS X 10.3
Message-ID: <A9026A4E-395E-11D8-982D-000A9599FB7E@newcode.se>

Hi list,

I've installed mod_python on my Mac, but can't get it working. When I  
restart Apache after configuring httpd.conf I get the following error:

Syntax error on line 276 of /Library/Apache2/conf/httpd.conf:
Cannot load /Library/Apache2/modules/mod_python.so into server: dyld:  
/Library/Apache2/bin/httpd Undefined symbols:
_PyExc_AttributeError
_PyExc_IOError
_PyExc_IndexError
_PyExc_KeyError
_PyExc_RuntimeError
_PyExc_StopIteration
_PyExc_TypeError
_PyExc_ValueError
_PyInt_Type
_PyList_Type
_PyObject_GenericGetAttr
_PyObject_GenericSetAttr
_PyString_Type
_PyType_Type
_Py_OptimizeFlag
__Py_NoneStruct
__Py_NotImplementedStruct

I'm using mod_python 3.1.2b on my laptop running Apache 2.0.48 and Mac  
OS X 10.3.2.

In Mac OS X 10.3, Python 2.3 is installed by default, and the library  
and include files are in  
/System/Library/Frameworks/Python.framework/Versions/2.3/lib/python2.3/  
and  
/System/Library/Frameworks/Python.framework/Versions/2.3/include/ 
python2.3/ respectively. I created symlinks to these at /usr/lib/python  
and /usr/include/python.

Any ideas what I did wrong?

TIA,

Carl-Johan Kihlbom

From grisha at modpython.org  Sun Dec 28 13:28:12 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:00:41 2004
Subject: [mod_python] Session unable to acquire mutex lock?
In-Reply-To: <200312271944.55425.RussLear314@yahoo.com>
References: <200312271944.55425.RussLear314@yahoo.com>
Message-ID: <20031228132058.S70904@onyx.ispol.com>


If you restart the server, and try this code, does the error happen on the
first hit, or only starting with the second and after waiting for a while?

If if it's the former, then there probably is some problem with locking in
general (are there any warning messages on server startup?). If it's
latter, then the session does not get unlocked properly. It should get
unlocked when the sess object goes out of scope (and looking at your code
it should), but perhpas try unlocking it manually (sess.unlock()) and see
if this fixes the problem.

Grisha

On Sat, 27 Dec 2003, Russell Lear wrote:

> Hi,
>
> I'm a newbie to mod_python so forgive me if this is a terribly obvious
> question (I've looked through the archives without much success).
>
> I'm trying to use sessions.  Right now I have a slightly modified version
> of mptest.py as follows (it doesn't make sense, but it does show my
> problem):
>
>     from mod_python import apache, Session
>     import sys
>
>     def handler(req):
>         req.content_type = 'text/plain'
>         req.write("Creating...\n")
>         sess = Session.Session(req)
>         req.write("Hello World!")
>         return apache.OK
>
> When I run it, I see:
>
>      Mod_python error: "PythonHandler mptest"
>
>      Traceback (most recent call last):
>
>        File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 338, in HandlerDispatch
>          result = object(req)
>
>        File "/srv/www/htdocs/test/mptest.py", line 7, in handler
>          sess = Session.Session(req)
>
>        File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 411, in Session
>          timeout=timeout)
>
>        File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 316, in __init__
>          secret=secret, timeout=timeout)
>
>        File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 170, in __init__
>          self.lock()                 # lock new sid
>
>        File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 241, in lock
>          _apache._global_lock(self._req.server, self._sid)
>
>      ValueError: Failed to acquire global mutex lock
>
>
> What am I doing wrong here?!
>
> Thanks for any suggestions,
> Russell.
>
> PS:
>
> I'm running on SuSE 9.0 Linux.
>
> Python reports version "Python 2.3+ (#1, Sep 23 2003, 23:07:16)".
>
> >From the Apache error page:
>     Apache/2.0.48 (Linux/SuSE),
>     mod_python/3.1.2b
>     Python/2.3+.
>
> The only glitch I had in building mod_python was that I needed to specify
>     ./configure --with-apxs=/usr/sbin/apxs2
>
> rather than just refering to apxs.
>
> My apache configuration is (from the tutorial):
> <Directory /srv/www/htdocs/test>
>   AddHandler python-program .py
>   PythonHandler mptest
>   PythonDebug On
> </Directory>
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From mark at gsoa.net  Sun Dec 28 16:07:22 2003
From: mark at gsoa.net (Mark McClain)
Date: Fri Jan  9 22:00:41 2004
Subject: [mod_python] mod_python not working on Mac OS X 10.3
In-Reply-To: <A9026A4E-395E-11D8-982D-000A9599FB7E@newcode.se>
References: <A9026A4E-395E-11D8-982D-000A9599FB7E@newcode.se>
Message-ID: <D434E9D8-3979-11D8-BDD5-000A95B33D28@gsoa.net>

Here is what I use to build on 10.3.2:

1) Build and install apache2

2) Unpack the mod_python distribution

3) make the following changes to the configure script. here it is in  
modified form...

if test "$PyFRAMEWORKDIR" != "no-framework"; then
   if test -n "$PyFRAMEWORK"; then
     PyPYTHONLIBS="-framework $PyFRAMEWORK"

    # explicitly pass to mac linker so add this line
     LDFLAGS="${LDFLAGS} -Wl,-framework,Python"
   fi

4) run configure, make, then install

Good luck,
mark

On Dec 28, 2003, at 12:52 PM, Carl-Johan Kihlbom wrote:

> Hi list,
>
> I've installed mod_python on my Mac, but can't get it working. When I  
> restart Apache after configuring httpd.conf I get the following error:
>
> Syntax error on line 276 of /Library/Apache2/conf/httpd.conf:
> Cannot load /Library/Apache2/modules/mod_python.so into server: dyld:  
> /Library/Apache2/bin/httpd Undefined symbols:
> _PyExc_AttributeError
> _PyExc_IOError
> _PyExc_IndexError
> _PyExc_KeyError
> _PyExc_RuntimeError
> _PyExc_StopIteration
> _PyExc_TypeError
> _PyExc_ValueError
> _PyInt_Type
> _PyList_Type
> _PyObject_GenericGetAttr
> _PyObject_GenericSetAttr
> _PyString_Type
> _PyType_Type
> _Py_OptimizeFlag
> __Py_NoneStruct
> __Py_NotImplementedStruct
>
> I'm using mod_python 3.1.2b on my laptop running Apache 2.0.48 and Mac  
> OS X 10.3.2.
>
> In Mac OS X 10.3, Python 2.3 is installed by default, and the library  
> and include files are in  
> /System/Library/Frameworks/Python.framework/Versions/2.3/lib/ 
> python2.3/ and  
> /System/Library/Frameworks/Python.framework/Versions/2.3/include/ 
> python2.3/ respectively. I created symlinks to these at  
> /usr/lib/python and /usr/include/python.
>
> Any ideas what I did wrong?
>
> TIA,
>
> Carl-Johan Kihlbom
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From RussLear314 at yahoo.com  Mon Dec 29 08:57:00 2003
From: RussLear314 at yahoo.com (Russell Lear)
Date: Fri Jan  9 22:00:41 2004
Subject: [mod_python] Session unable to acquire mutex lock?
In-Reply-To: <20031228132058.S70904@onyx.ispol.com>
References: <200312271944.55425.RussLear314@yahoo.com>
	<20031228132058.S70904@onyx.ispol.com>
Message-ID: <200312290857.00982.RussLear314@yahoo.com>

Grisha,

Thanks for the suggestions.  

I did a stop/start and the problem happens on the first hit.

I enabled some debug logging (See below).  

There are two things I notice that seem odd to my inexperienced eye: 

1) During apache's startup, mod_python says
    "Creating 32 session mutexes based on 150 max processes and 0 max threads".  
Is "0 max threads" correct, or do I have something misconfigured? 
Seems like max threads ought to be at least 1 or 2 ??

2) When I invoke my test, there is a warning
    "Permission denied: Failed to acquire global mutex lock at index 17".  
Is that just saying that it failed to get a mutex lock or do I have bad permissions someplace?

Thanks,
Russell.

====================
Apache error_log exerpt:
[... 08:30:57 ] [info] Server: Apache/2.0.48, Interface: mod_ssl/2.0.48, Library: OpenSSL/0.9.7b
[... 08:30:57 ] [notice] suEXEC mechanism enabled (wrapper: /usr/sbin/suexec2)
[... 08:31:00 ] [info] Init: Initializing OpenSSL library
[... 08:31:00 ] [info] Init: Seeding PRNG with 0 bytes of entropy
[... 08:31:00 ] [info] Init: Generating temporary RSA private keys (512/1024 bits)
[... 08:31:00 ] [info] Init: Generating temporary DH parameters (512/1024 bits)
[... 08:31:00 ] [info] Init: Initializing (virtual) servers for SSL
[... 08:31:00 ] [info] Server: Apache/2.0.48, Interface: mod_ssl/2.0.48, Library: OpenSSL/0.9.7b
[... 08:31:02 ] [notice] mod_python: Creating 32 session mutexes based on 150 max processes and 0 max threads.
[... 08:31:02 ] [notice] Apache/2.0.48 (Linux/SuSE) mod_ssl/2.0.48 OpenSSL/0.9.7b PHP/4.3.3 mod_python/3.1.2b Python/2.3+ configured -- resuming normal operations
[... 08:31:02 ] [info] Server built: Nov 10 2003 11:47:10
[... 08:31:02 ] [debug] prefork.c(1037): AcceptMutex: sysvsem (default: sysvsem)
[... 08:31:15 ] [notice] mod_python: (Re)importing module 'mptest'
[... 08:31:16 ] [warn] (13)Permission denied: Failed to acquire global mutex lock at index 17
[... 08:31:16 ] [error] [client ::1] PythonHandler mptest: Traceback (most recent call last):
[... 08:31:16 ] [error] [client ::1] PythonHandler mptest: 
    File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 338, in HandlerDispatch
    result = object(req)
[... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
    File "/srv/www/htdocs/test/mptest.py", line 7, in handler
    sess = Session.Session(req)
[... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
    File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 411, in Session
    timeout=timeout)
[... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
    File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 316, in __init__
    secret=secret, timeout=timeout)
[... 08:31:16 ] [error] [client ::1] PythonHandler mptest:   
    File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 170, in __init__
    self.lock()                 # lock new sid
[... 08:31:16 ] [error] [client ::1] PythonHandler mptest:   
    File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 241, in lock
    _apache._global_lock(self._req.server, self._sid)
[... 08:31:16 ] [error] [client ::1] PythonHandler mptest: 
    ValueError: Failed to acquire global mutex lock

====================

On Sunday 28 December 2003 10:28, Gregory (Grisha) Trubetskoy wrote:
> If you restart the server, and try this code, does the error happen on the
> first hit, or only starting with the second and after waiting for a while?
>
> If if it's the former, then there probably is some problem with locking in
> general (are there any warning messages on server startup?). ...
>
> Grisha
>
> On Sat, 27 Dec 2003, Russell Lear wrote:
> > Hi,
> >
> > [RLear: 2003/12/29: deleted text to avoid overly long attachment]
> >
> >     from mod_python import apache, Session
> >     import sys
> >
> >     def handler(req):
> >         req.content_type = 'text/plain'
> >         req.write("Creating...\n")
> >         sess = Session.Session(req)
> >         req.write("Hello World!")
> >         return apache.OK
> >
> >  [RLear: 2003/12/29: deleted text to avoid overly long attachment]
> >
> > I'm running on SuSE 9.0 Linux.
> >
> > Python reports version "Python 2.3+ (#1, Sep 23 2003, 23:07:16)".
> >
> > >From the Apache error page:
> >
> >     Apache/2.0.48 (Linux/SuSE),
> >     mod_python/3.1.2b
> >     Python/2.3+.
> >
> > The only glitch I had in building mod_python was that I needed to specify
> >     ./configure --with-apxs=/usr/sbin/apxs2
> >
> > rather than just refering to apxs.
> >
> > My apache configuration is (from the tutorial):
> > <Directory /srv/www/htdocs/test>
> >   AddHandler python-program .py
> >   PythonHandler mptest
> >   PythonDebug On
> > </Directory>
> >
> >
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python

From div at newcode.se  Mon Dec 29 17:55:44 2003
From: div at newcode.se (Carl-Johan Kihlbom)
Date: Fri Jan  9 22:00:41 2004
Subject: [mod_python] mod_python not working on Mac OS X 10.3
In-Reply-To: <D434E9D8-3979-11D8-BDD5-000A95B33D28@gsoa.net>
References: <A9026A4E-395E-11D8-982D-000A9599FB7E@newcode.se>
	<D434E9D8-3979-11D8-BDD5-000A95B33D28@gsoa.net>
Message-ID: <D7CFFAED-3A1F-11D8-8995-000A9599FB7E@newcode.se>

That got me a bit further, thanks, but I still can't get it to work.  
I've followed the testing procedures in the manual by setting  
AllowOverride All in httpd.conf and creating a .htaccess file in  
htdocs/test with the following content:

AddHandler python-program .py
PythonHandler mptest
PythonDebug On

I then created a file mptest.py in the same directory. It looks like  
this:

from mod_python import apache

def handler(req):
     req.write("Hello World!")
     return apache.OK

When I try to access http://localhost/test/mptest.py I get a 500  
Internal Server Error. No additional information in the access or error  
log.

Any ideas what's wrong this time? :-)

Thanks again,

Carl-Johan Kihlbom

On Dec 28, 2003, at 22:07, Mark McClain wrote:

> Here is what I use to build on 10.3.2:
>
> 1) Build and install apache2
>
> 2) Unpack the mod_python distribution
>
> 3) make the following changes to the configure script. here it is in  
> modified form...
>
> if test "$PyFRAMEWORKDIR" != "no-framework"; then
>   if test -n "$PyFRAMEWORK"; then
>     PyPYTHONLIBS="-framework $PyFRAMEWORK"
>
>    # explicitly pass to mac linker so add this line
>     LDFLAGS="${LDFLAGS} -Wl,-framework,Python"
>   fi
>
> 4) run configure, make, then install
>
> Good luck,
> mark
>
> On Dec 28, 2003, at 12:52 PM, Carl-Johan Kihlbom wrote:
>
>> Hi list,
>>
>> I've installed mod_python on my Mac, but can't get it working. When I  
>> restart Apache after configuring httpd.conf I get the following  
>> error:
>>
>> Syntax error on line 276 of /Library/Apache2/conf/httpd.conf:
>> Cannot load /Library/Apache2/modules/mod_python.so into server: dyld:  
>> /Library/Apache2/bin/httpd Undefined symbols:
>> _PyExc_AttributeError
>> _PyExc_IOError
>> _PyExc_IndexError
>> _PyExc_KeyError
>> _PyExc_RuntimeError
>> _PyExc_StopIteration
>> _PyExc_TypeError
>> _PyExc_ValueError
>> _PyInt_Type
>> _PyList_Type
>> _PyObject_GenericGetAttr
>> _PyObject_GenericSetAttr
>> _PyString_Type
>> _PyType_Type
>> _Py_OptimizeFlag
>> __Py_NoneStruct
>> __Py_NotImplementedStruct
>>
>> I'm using mod_python 3.1.2b on my laptop running Apache 2.0.48 and  
>> Mac OS X 10.3.2.
>>
>> In Mac OS X 10.3, Python 2.3 is installed by default, and the library  
>> and include files are in  
>> /System/Library/Frameworks/Python.framework/Versions/2.3/lib/ 
>> python2.3/ and  
>> /System/Library/Frameworks/Python.framework/Versions/2.3/include/ 
>> python2.3/ respectively. I created symlinks to these at  
>> /usr/lib/python and /usr/include/python.
>>
>> Any ideas what I did wrong?
>>
>> TIA,
>>
>> Carl-Johan Kihlbom

From grisha at modpython.org  Mon Dec 29 16:54:57 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:00:41 2004
Subject: [mod_python] Session unable to acquire mutex lock?
In-Reply-To: <200312290857.00982.RussLear314@yahoo.com>
References: <200312271944.55425.RussLear314@yahoo.com>
	<20031228132058.S70904@onyx.ispol.com>
	<200312290857.00982.RussLear314@yahoo.com>
Message-ID: <20031229165250.V88187@onyx.ispol.com>


This looks like a permissions bug with System V IPC that made it into the
beta. Try running one of the latest CVS snapshots, I think it is fixed
there.

Grisha

On Mon, 29 Dec 2003, Russell Lear wrote:

> Grisha,
>
> Thanks for the suggestions.
>
> I did a stop/start and the problem happens on the first hit.
>
> I enabled some debug logging (See below).
>
> There are two things I notice that seem odd to my inexperienced eye:
>
> 1) During apache's startup, mod_python says
>     "Creating 32 session mutexes based on 150 max processes and 0 max threads".
> Is "0 max threads" correct, or do I have something misconfigured?
> Seems like max threads ought to be at least 1 or 2 ??
>
> 2) When I invoke my test, there is a warning
>     "Permission denied: Failed to acquire global mutex lock at index 17".
> Is that just saying that it failed to get a mutex lock or do I have bad permissions someplace?
>
> Thanks,
> Russell.
>
> ====================
> Apache error_log exerpt:
> [... 08:30:57 ] [info] Server: Apache/2.0.48, Interface: mod_ssl/2.0.48, Library: OpenSSL/0.9.7b
> [... 08:30:57 ] [notice] suEXEC mechanism enabled (wrapper: /usr/sbin/suexec2)
> [... 08:31:00 ] [info] Init: Initializing OpenSSL library
> [... 08:31:00 ] [info] Init: Seeding PRNG with 0 bytes of entropy
> [... 08:31:00 ] [info] Init: Generating temporary RSA private keys (512/1024 bits)
> [... 08:31:00 ] [info] Init: Generating temporary DH parameters (512/1024 bits)
> [... 08:31:00 ] [info] Init: Initializing (virtual) servers for SSL
> [... 08:31:00 ] [info] Server: Apache/2.0.48, Interface: mod_ssl/2.0.48, Library: OpenSSL/0.9.7b
> [... 08:31:02 ] [notice] mod_python: Creating 32 session mutexes based on 150 max processes and 0 max threads.
> [... 08:31:02 ] [notice] Apache/2.0.48 (Linux/SuSE) mod_ssl/2.0.48 OpenSSL/0.9.7b PHP/4.3.3 mod_python/3.1.2b Python/2.3+ configured -- resuming normal operations
> [... 08:31:02 ] [info] Server built: Nov 10 2003 11:47:10
> [... 08:31:02 ] [debug] prefork.c(1037): AcceptMutex: sysvsem (default: sysvsem)
> [... 08:31:15 ] [notice] mod_python: (Re)importing module 'mptest'
> [... 08:31:16 ] [warn] (13)Permission denied: Failed to acquire global mutex lock at index 17
> [... 08:31:16 ] [error] [client ::1] PythonHandler mptest: Traceback (most recent call last):
> [... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
>     File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 338, in HandlerDispatch
>     result = object(req)
> [... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
>     File "/srv/www/htdocs/test/mptest.py", line 7, in handler
>     sess = Session.Session(req)
> [... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
>     File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 411, in Session
>     timeout=timeout)
> [... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
>     File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 316, in __init__
>     secret=secret, timeout=timeout)
> [... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
>     File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 170, in __init__
>     self.lock()                 # lock new sid
> [... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
>     File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 241, in lock
>     _apache._global_lock(self._req.server, self._sid)
> [... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
>     ValueError: Failed to acquire global mutex lock
>
> ====================
>
> On Sunday 28 December 2003 10:28, Gregory (Grisha) Trubetskoy wrote:
> > If you restart the server, and try this code, does the error happen on the
> > first hit, or only starting with the second and after waiting for a while?
> >
> > If if it's the former, then there probably is some problem with locking in
> > general (are there any warning messages on server startup?). ...
> >
> > Grisha
> >
> > On Sat, 27 Dec 2003, Russell Lear wrote:
> > > Hi,
> > >
> > > [RLear: 2003/12/29: deleted text to avoid overly long attachment]
> > >
> > >     from mod_python import apache, Session
> > >     import sys
> > >
> > >     def handler(req):
> > >         req.content_type = 'text/plain'
> > >         req.write("Creating...\n")
> > >         sess = Session.Session(req)
> > >         req.write("Hello World!")
> > >         return apache.OK
> > >
> > >  [RLear: 2003/12/29: deleted text to avoid overly long attachment]
> > >
> > > I'm running on SuSE 9.0 Linux.
> > >
> > > Python reports version "Python 2.3+ (#1, Sep 23 2003, 23:07:16)".
> > >
> > > >From the Apache error page:
> > >
> > >     Apache/2.0.48 (Linux/SuSE),
> > >     mod_python/3.1.2b
> > >     Python/2.3+.
> > >
> > > The only glitch I had in building mod_python was that I needed to specify
> > >     ./configure --with-apxs=/usr/sbin/apxs2
> > >
> > > rather than just refering to apxs.
> > >
> > > My apache configuration is (from the tutorial):
> > > <Directory /srv/www/htdocs/test>
> > >   AddHandler python-program .py
> > >   PythonHandler mptest
> > >   PythonDebug On
> > > </Directory>
> > >
> > >
> > >
> > > _______________________________________________
> > > Mod_python mailing list
> > > Mod_python@modpython.org
> > > http://mailman.modpython.org/mailman/listinfo/mod_python
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From RussLear314 at yahoo.com  Mon Dec 29 21:00:59 2003
From: RussLear314 at yahoo.com (Russell Lear)
Date: Fri Jan  9 22:00:41 2004
Subject: [mod_python] Session unable to acquire mutex lock?
In-Reply-To: <20031229165250.V88187@onyx.ispol.com>
References: <200312271944.55425.RussLear314@yahoo.com>
	<200312290857.00982.RussLear314@yahoo.com>
	<20031229165250.V88187@onyx.ispol.com>
Message-ID: <200312292100.59743.RussLear314@yahoo.com>

Ok!  I'm able to create a session now!

I grabbed httpd-python_20031229231518.tar.gz and things seem to work now.

Thanks a lot Grisha for your help.

Russell.


On Monday 29 December 2003 13:54, Gregory (Grisha) Trubetskoy wrote:
> This looks like a permissions bug with System V IPC that made it into the
> beta. Try running one of the latest CVS snapshots, I think it is fixed
> there.
>
> Grisha
>

From kevin at sb.org  Tue Dec 30 01:35:11 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:00:41 2004
Subject: [mod_python] mod_python not working on Mac OS X 10.3
In-Reply-To: <D7CFFAED-3A1F-11D8-8995-000A9599FB7E@newcode.se>
References: <A9026A4E-395E-11D8-982D-000A9599FB7E@newcode.se>
	<D434E9D8-3979-11D8-BDD5-000A95B33D28@gsoa.net>
	<D7CFFAED-3A1F-11D8-8995-000A9599FB7E@newcode.se>
Message-ID: <519C889B-3A92-11D8-9AD2-000A95A072FC@sb.org>

Gah, I always do this! This message was meant to go to the list.

---

I got a lot of that stuff until I stopped doing graceful restarts and 
started doing a stop, waiting for all httpd processes to die out, then 
starting it back up. That tended to fix the problem.

On Dec 29, 2003, at 11:55 AM, Carl-Johan Kihlbom wrote:

> When I try to access http://localhost/test/mptest.py I get a 500 
> Internal Server Error. No additional information in the access or 
> error log.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From pkeshishian at yahoo.com  Tue Dec 30 01:54:41 2003
From: pkeshishian at yahoo.com (Petros Keshishian)
Date: Fri Jan  9 22:00:41 2004
Subject: [mod_python] MySQLdb
Message-ID: <20031230095441.1986.qmail@web40020.mail.yahoo.com>

I would very much appreciate if anyone could resolve
my problem with MySQLdb.

I am try to run a query from mod_python as follows:

db = MySQldb.connect(db='aua', user='root')
c = db.cursor()
c.execute('select fname,lname,gyear from addrbk')

The program freezes at the last (3rd) line. The same
code works fine if I run it from python shell
directly. 
The code even works in mod_python if I query for less
than 3 column, e.g.

c.execute('select fname,lname from addrbk')
or
c.execute('select lname, gyear from addrbk')

Can anybody tell me what's going on?

Thank you for your help,
Petros







__________________________________
Do you Yahoo!?
Find out what made the Top Yahoo! Searches of 2003
http://search.yahoo.com/top2003
From neel at mediapulse.com  Tue Dec 30 11:08:45 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:00:41 2004
Subject: [mod_python] MySQLdb
Message-ID: <C0FC22C08B82074A88B50061764157776B991B@johnson.mediapulse.net>

Do you have PythonDebug On in your conf to see any traceback errors?
They should also be in your error log as well, even if debug is off.  If
they don't answer your questions, forward those on they will help in
seeing the problem.

Thanks,
Mike


> -----Original Message-----
> From: Petros Keshishian [mailto:pkeshishian@yahoo.com] 
> Sent: Tuesday, December 30, 2003 4:55 AM
> To: mod_python@modpython.org
> Subject: [mod_python] MySQLdb
> 
> 
> I would very much appreciate if anyone could resolve
> my problem with MySQLdb.
> 
> I am try to run a query from mod_python as follows:
> 
> db = MySQldb.connect(db='aua', user='root')
> c = db.cursor()
> c.execute('select fname,lname,gyear from addrbk')
> 
> The program freezes at the last (3rd) line. The same
> code works fine if I run it from python shell
> directly. 
> The code even works in mod_python if I query for less
> than 3 column, e.g.
> 
> c.execute('select fname,lname from addrbk')
> or
> c.execute('select lname, gyear from addrbk')
> 
> Can anybody tell me what's going on?
> 
> Thank you for your help,
> Petros
> 
> 
> 
> 
> 
> 
> 
> __________________________________
> Do you Yahoo!?
> Find out what made the Top Yahoo! Searches of 2003
> http://search.yahoo.com/top2003
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

From pkeshishian at yahoo.com  Tue Dec 30 09:13:18 2003
From: pkeshishian at yahoo.com (Petros Keshishian)
Date: Fri Jan  9 22:00:41 2004
Subject: [mod_python] MySQLdb
In-Reply-To: <C0FC22C08B82074A88B50061764157776B991B@johnson.mediapulse.net>
Message-ID: <20031230171318.10032.qmail@web40015.mail.yahoo.com>

I do have PythonDebud On, but it does not report any
errors. The error log has the following:

[Tue Dec 30 09:07:16 2003] [notice] mod_python:
(Re)importing module 'pyhndlr' with path set to
'['/usr/local/apache2/htdocs/auaweb/frm_address']'
[Tue Dec 30 09:07:16 2003] [notice] child pid 4161
exit signal Segmentation fault (11)

pyhndlr.py is the file where the code resides. I hope
you know what this segmentation fault could be.

Thanks,
Petros


--- "Michael C. Neel" <neel@mediapulse.com> wrote:
> Do you have PythonDebug On in your conf to see any
> traceback errors?
> They should also be in your error log as well, even
> if debug is off.  If
> they don't answer your questions, forward those on
> they will help in
> seeing the problem.
> 
> Thanks,
> Mike
> 
> 
> > -----Original Message-----
> > From: Petros Keshishian
> [mailto:pkeshishian@yahoo.com] 
> > Sent: Tuesday, December 30, 2003 4:55 AM
> > To: mod_python@modpython.org
> > Subject: [mod_python] MySQLdb
> > 
> > 
> > I would very much appreciate if anyone could
> resolve
> > my problem with MySQLdb.
> > 
> > I am try to run a query from mod_python as
> follows:
> > 
> > db = MySQldb.connect(db='aua', user='root')
> > c = db.cursor()
> > c.execute('select fname,lname,gyear from addrbk')
> > 
> > The program freezes at the last (3rd) line. The
> same
> > code works fine if I run it from python shell
> > directly. 
> > The code even works in mod_python if I query for
> less
> > than 3 column, e.g.
> > 
> > c.execute('select fname,lname from addrbk')
> > or
> > c.execute('select lname, gyear from addrbk')
> > 
> > Can anybody tell me what's going on?
> > 
> > Thank you for your help,
> > Petros
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > __________________________________
> > Do you Yahoo!?
> > Find out what made the Top Yahoo! Searches of 2003
> > http://search.yahoo.com/top2003
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> >
>
http://mailman.modpython.org/mailman/listinfo/mod_python
> > 


__________________________________
Do you Yahoo!?
Find out what made the Top Yahoo! Searches of 2003
http://search.yahoo.com/top2003
From pkeshishian at yahoo.com  Tue Dec 30 10:20:40 2003
From: pkeshishian at yahoo.com (Petros Keshishian)
Date: Fri Jan  9 22:00:41 2004
Subject: [mod_python] MySQLdb
In-Reply-To: <1072769149.20927.1.camel@inspiration.x.eradman.com>
Message-ID: <20031230182040.81782.qmail@web40008.mail.yahoo.com>

Eric:
 
I have put req.write() statements before and after the execute() function like this:
 
db = MySQldb.connect(db='aua', user='root')
c = db.cursor()
req.content_type = "text/plain"
req.write("Before Execute\n")
c.execute('select fname,lname,gyear from addrbk')
req.write("After Execute\n")
 
When I point the browser to this function I see:
Before Execute
 
And nothing else. No error messages even though I have PythonDebug On. As I already sent in my previous e-mail there is a segmentation fault reported in error log.
 
What's surprising is that it works fine if I query for any two columns instead of three.
 
Thanks for your help,
Petros


Eric Radman <theman@eradman.com> wrote:
Petros,

Are you saying that it won't run ANYTHING after the execute() function?

Eric Radman
theman@eradman.com

On Tue, 2003-12-30 at 09:54, Petros Keshishian wrote:
> I would very much appreciate if anyone could resolve
> my problem with MySQLdb.
> 
> I am try to run a query from mod_python as follows:
> 
> db = MySQldb.connect(db='aua', user='root')
> c = db.cursor()
> c.execute('select fname,lname,gyear from addrbk')
> 
> The program freezes at the last (3rd) line. The same
> code works fine if I run it from python shell
> directly. 
> The code even works in mod_python if I query for less
> than 3 column, e.g.
> 
> c.execute('select fname,lname from addrbk')
> or
> c.execute('select lname, gyear from addrbk')
> 
> Can anybody tell me what's going on?
> 
> Thank you for your help,
> Petros
> 
> 
> 
> 
> 
> 
> 
> __________________________________
> Do you Yahoo!?
> Find out what made the Top Yahoo! Searches of 2003
> http://search.yahoo.com/top2003
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python


---------------------------------
Do you Yahoo!?
Find out what made the Top Yahoo! Searches of 2003
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20031230/06304ebd/attachment-0002.htm
From redconectabilbao at telefonica.net  Wed Dec 31 10:57:31 2003
From: redconectabilbao at telefonica.net (Red Conecta)
Date: Fri Jan  9 22:00:41 2004
Subject: [mod_python] mod_python and css
Message-ID: <3FF29D8B.6030208@telefonica.net>

I'm trying to use css with the publisherhandler; here is the code:

    def _inicio():
        ini= '''<head><title>nombredelsitio</title>
                  <link rel="stylesheet" href="estilo.css"
    Type="text/css"></head>
                  <body leftmargin=0 rightmargin=0 topmargin=0
    bottommargin=0>'''
       
        return ini

    def _final():
        return '</body></html>'

    def mostrar(req,direccion='/'):
        req.content_type = "text/html"
        html=_inicio()
        obj=leerobjeto(direccion)
        if obj!=None:
            for i in obj.__dict__:html+=i+': '+obj.__dict__[i]+'<br>'
        else:html+='error'
        html+=_final()
        return html

the output doesn't use the estilo.css archive but if I save the page in 
'mostrar.html' all is ok.

From sgillies at frii.com  Wed Dec 31 07:42:41 2003
From: sgillies at frii.com (Sean Gillies)
Date: Fri Jan  9 22:00:41 2004
Subject: [mod_python] mod_python and css
In-Reply-To: <3FF29D8B.6030208@telefonica.net>
References: <3FF29D8B.6030208@telefonica.net>
Message-ID: <960A9AF8-3B9F-11D8-9527-000393B98B56@frii.com>

On Dec 31, 2003, at 2:57 AM, Red Conecta wrote:

> I'm trying to use css with the publisherhandler; here is the code:
>
>    def _inicio():
>        ini= '''<head><title>nombredelsitio</title>
>                  <link rel="stylesheet" href="estilo.css"
>    Type="text/css"></head>
>                  <body leftmargin=0 rightmargin=0 topmargin=0
>    bottommargin=0>'''
>              return ini
>
>    def _final():
>        return '</body></html>'
>
>    def mostrar(req,direccion='/'):
>        req.content_type = "text/html"
>        html=_inicio()
>        obj=leerobjeto(direccion)
>        if obj!=None:
>            for i in obj.__dict__:html+=i+': '+obj.__dict__[i]+'<br>'
>        else:html+='error'
>        html+=_final()
>        return html
>
> the output doesn't use the estilo.css archive but if I save the page 
> in 'mostrar.html' all is ok.
>

Try "../estilo.css", this will link to the stylesheet in the same
location as the published module.

cheers,
Sean

--
Sean Gillies
sgillies at frii dot com
http://users.frii.com/sgillies

From kevin at sb.org  Wed Dec 31 15:18:58 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:00:41 2004
Subject: [mod_python] mod_python and css
In-Reply-To: <3FF29D8B.6030208@telefonica.net>
References: <3FF29D8B.6030208@telefonica.net>
Message-ID: <9089E1A9-3BCE-11D8-9AD2-000A95A072FC@sb.org>

That's because with this handler, your URL looks something like

http://my.domain.com/myScript/mostrar

so when you access "estilo.css", the requested URL is

/myScript/estilo.css

However, your script doesn't handle estilo.css, since that's actually a 
file in the same directory as myScript. If you replace the script with 
mostrar.html, then estilo.css is accessed as

/estilo.css

instead, since the myScript path segment is now gone.

The solution is to put "../estilo.css" as your CSS href.

P.S. Why does this list use a Reply-To for the original sender rather 
than for the list itself? I keep sending mail to individual people when 
I mean to simply reply to the list itself.

On Dec 31, 2003, at 4:57 AM, Red Conecta wrote:

> I'm trying to use css with the publisherhandler; here is the code:
>
>    def _inicio():
>        ini= '''<head><title>nombredelsitio</title>
>                  <link rel="stylesheet" href="estilo.css"
>    Type="text/css"></head>
>                  <body leftmargin=0 rightmargin=0 topmargin=0
>    bottommargin=0>'''
>              return ini
>
>    def _final():
>        return '</body></html>'
>
>    def mostrar(req,direccion='/'):
>        req.content_type = "text/html"
>        html=_inicio()
>        obj=leerobjeto(direccion)
>        if obj!=None:
>            for i in obj.__dict__:html+=i+': '+obj.__dict__[i]+'<br>'
>        else:html+='error'
>        html+=_final()
>        return html
>
> the output doesn't use the estilo.css archive but if I save the page 
> in 'mostrar.html' all is ok.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From jay at jaydorsey.com  Mon Dec  1 11:22:03 2003
From: jay at jaydorsey.com (Jay Dorsey)
Date: Fri Jan  9 22:04:24 2004
Subject: [mod_python] Mailing list archive link
Message-ID: <20031201172203.GA32445@gentoo.Earthlink.net>

I was trying to download the mailing list archives this morning. From the front page of http://www.modpython.org I clicked on the "Mailing list archives are here" link. The "download the full raw archive" link points to http://www.modpython.org/pipermail/mod_python.mbox/mod_python.mbox which is a 404. Clicking the "more information about this list" link, which took me to the mailman page, then clicking the "Mod python archives" link took me to a page that was similar to the archive list linked on the front page of modpython.org. This page has what I assume to be the correct link to the mailing list archives: http://mailman.modpython.org/pipermail/mod_python.mbox/mod_python.mbox.

Sorry if this has already been posted--I've just started subscribing to the list and I searched the raw archives for mmention of this and found nothing.  Also, is there a user-friendly web interface for searching through the modpython mailing list archives?

-- 
Jay Dorsey
jay at jaydorsey dot com
From aalbarracindev at hotmail.com  Mon Dec  1 18:48:04 2003
From: aalbarracindev at hotmail.com (Alberto Sanchez Albarracin)
Date: Fri Jan  9 22:04:24 2004
Subject: [mod_python] apache doesn't start
Message-ID: <BAY7-F27e1YM9a2flhn0002153b@hotmail.com>

Hi all, i want mod_python for apache1(windows), the download page says that
mod_python 2.7.9 works with http server 1.3 but the link led me to one page
where appeared one directory named "win" among another files and two
directories, i went into win directory and i found several directories, i
choose the 2.7.6 directory and appeared two files listed below:
python2.2-apache1.3.20.zip, python2.2-apache1.3.20.zip
I pressed on the python2.2-apache1.3.22.zip file which is the second one,
decompressed it, and i just found a dll file named mod_python.dll.
My question is: where should i copy this file so that apache starts without
errors. The error is: Cannot load mod_python.so into server, the specific
module could not be found...

Thanks in advance

_________________________________________________________________
STOP MORE SPAM with the new MSN 8 and get 2 months FREE* 
http://join.msn.com/?page=features/junkmail

From neel at mediapulse.com  Tue Dec  2 11:44:34 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:04:24 2004
Subject: [mod_python] Getting mod_python version
Message-ID: <C0FC22C08B82074A88B500617641577787A7D3@johnson.mediapulse.net>

Hi all,

	I don't know if it's not there, or I'm just overlooking it, but
I can seem for a way in code to get the version of mod_python.  I have
some "default" modules I use, and I am trying to make them work with any
mod_python version.  Right now I'm doing try block, like such:

    # Get username/password from client
    pw = req.get_basic_auth_pw()
    try:
        # mod_python 2.x
        user = req.connection.user
    except:
        # mod_python 3.x
        user = req.user

	...but I'd rather be able to get the version directly.

Mike

From gustavo.cordova at q-voz.com  Tue Dec  2 12:47:27 2003
From: gustavo.cordova at q-voz.com (=?ISO-8859-1?Q?Gustavo_C=F3rdova_Avila?=)
Date: Fri Jan  9 22:04:24 2004
Subject: [mod_python] Getting mod_python version
In-Reply-To: <C0FC22C08B82074A88B500617641577787A7D3@johnson.mediapulse.net>
References: <C0FC22C08B82074A88B500617641577787A7D3@johnson.mediapulse.net>
Message-ID: <3FCCDE3F.4090005@q-voz.com>

This is the correct, "pythonic" way of doing things.

I'd recommend using "except AttributeError:" instead of a naked 
"except:" btw.

-gustavo

Michael C. Neel wrote:

>Hi all,
>
>	I don't know if it's not there, or I'm just overlooking it, but
>I can seem for a way in code to get the version of mod_python.  I have
>some "default" modules I use, and I am trying to make them work with any
>mod_python version.  Right now I'm doing try block, like such:
>
>    # Get username/password from client
>    pw = req.get_basic_auth_pw()
>    try:
>        # mod_python 2.x
>        user = req.connection.user
>    except:
>        # mod_python 3.x
>        user = req.user
>
>	...but I'd rather be able to get the version directly.
>
>Mike
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
>  
>

From neel at mediapulse.com  Tue Dec  2 14:30:41 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:04:25 2004
Subject: [mod_python] Getting mod_python version
Message-ID: <C0FC22C08B82074A88B500617641577787A7D4@johnson.mediapulse.net>

Most modules have a __version__ member, and the help() built-in method
even looks for this variable and uses it to display the version of the
file:

>>>import cgi
>>>cgi.__version__
'2.6'
>>>help(cgi)
...skipping...
DATA
    __all__ = ['MiniFieldStorage', 'FieldStorage', 'FormContentDict',
'SvF...
    __version__ = '2.6'
    logfile = ''
    logfp = None
    maxlen = 0

VERSION
    2.6

>>>

I have not read or seen anything saying the "pythonic" way of versioning
a module is by try/except blocks testing to see if variable exist.  I
have however seen this from PEP 8:

Version Bookkeeping

    If you have to have RCS or CVS crud in your source file, do it as
    follows.

        __version__ = "$Revision: 1.20 $"
        # $Source: /cvsroot/python/python/nondist/peps/pep-0008.txt,v $

    These lines should be included after the module's docstring,
    before any other code, separated by a blank line above and
    below.

Which implies to me that __version__ is a pythonic way of versioning a
module/code file, though it doesn't seem to be as standard as __doc__.

Mike

> -----Original Message-----
> From: Gustavo C?rdova Avila [mailto:gustavo.cordova@q-voz.com] 
> Sent: Tuesday, December 02, 2003 1:47 PM
> To: Michael C. Neel
> Cc: mod_python@modpython.org
> Subject: Re: [mod_python] Getting mod_python version
> 
> 
> This is the correct, "pythonic" way of doing things.
> 
> I'd recommend using "except AttributeError:" instead of a naked 
> "except:" btw.
> 
> -gustavo
> 
> Michael C. Neel wrote:
> 
> >Hi all,
> >
> >	I don't know if it's not there, or I'm just overlooking it, but
> >I can seem for a way in code to get the version of 
> mod_python.  I have
> >some "default" modules I use, and I am trying to make them 
> work with any
> >mod_python version.  Right now I'm doing try block, like such:
> >
> >    # Get username/password from client
> >    pw = req.get_basic_auth_pw()
> >    try:
> >        # mod_python 2.x
> >        user = req.connection.user
> >    except:
> >        # mod_python 3.x
> >        user = req.user
> >
> >	...but I'd rather be able to get the version directly.
> >
> >Mike
> >
> >_______________________________________________
> >Mod_python mailing list
> >Mod_python@modpython.org
> >http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> >
> >  
> >
> 
> 

From michael at dynamine.net  Tue Dec  2 11:41:16 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 22:04:25 2004
Subject: [mod_python] Getting mod_python version
In-Reply-To: <C0FC22C08B82074A88B500617641577787A7D4@johnson.mediapulse.net>
References: <C0FC22C08B82074A88B500617641577787A7D4@johnson.mediapulse.net>
Message-ID: <3FCCEADC.9060701@dynamine.net>

Regardless of whether or not __version__ is implemented, using exception 
handling is more robust in the long run, I think.

Forgetting to change the interface version number when a compatibility 
detail has changed is not an unknown phenomenon -- if not with 
mod_python, then certainly with other SDKs.

--Michael

Michael C. Neel wrote:

> Most modules have a __version__ member, and the help() built-in method
> even looks for this variable and uses it to display the version of the
> file:
> 
> 
>>>>import cgi
>>>>cgi.__version__
> 
> '2.6'
> 
>>>>help(cgi)
> 
> ...skipping...
> DATA
>     __all__ = ['MiniFieldStorage', 'FieldStorage', 'FormContentDict',
> 'SvF...
>     __version__ = '2.6'
>     logfile = ''
>     logfp = None
>     maxlen = 0
> 
> VERSION
>     2.6
> 
> 
> 
> I have not read or seen anything saying the "pythonic" way of versioning
> a module is by try/except blocks testing to see if variable exist.  I
> have however seen this from PEP 8:
> 
> Version Bookkeeping
> 
>     If you have to have RCS or CVS crud in your source file, do it as
>     follows.
> 
>         __version__ = "$Revision: 1.20 $"
>         # $Source: /cvsroot/python/python/nondist/peps/pep-0008.txt,v $
> 
>     These lines should be included after the module's docstring,
>     before any other code, separated by a blank line above and
>     below.
> 
> Which implies to me that __version__ is a pythonic way of versioning a
> module/code file, though it doesn't seem to be as standard as __doc__.
> 
> Mike
> 
> 
>>-----Original Message-----
>>From: Gustavo C?rdova Avila [mailto:gustavo.cordova@q-voz.com] 
>>Sent: Tuesday, December 02, 2003 1:47 PM
>>To: Michael C. Neel
>>Cc: mod_python@modpython.org
>>Subject: Re: [mod_python] Getting mod_python version
>>
>>
>>This is the correct, "pythonic" way of doing things.
>>
>>I'd recommend using "except AttributeError:" instead of a naked 
>>"except:" btw.
>>
>>-gustavo
>>
>>Michael C. Neel wrote:
>>
>>
>>>Hi all,
>>>
>>>	I don't know if it's not there, or I'm just overlooking it, but
>>>I can seem for a way in code to get the version of 
>>
>>mod_python.  I have
>>
>>>some "default" modules I use, and I am trying to make them 
>>
>>work with any
>>
>>>mod_python version.  Right now I'm doing try block, like such:
>>>
>>>   # Get username/password from client
>>>   pw = req.get_basic_auth_pw()
>>>   try:
>>>       # mod_python 2.x
>>>       user = req.connection.user
>>>   except:
>>>       # mod_python 3.x
>>>       user = req.user
>>>
>>>	...but I'd rather be able to get the version directly.
>>>
>>>Mike
>>>
>>>_______________________________________________
>>>Mod_python mailing list
>>>Mod_python@modpython.org
>>>http://mailman.modpython.org/mailman/listinfo/mod_python
>>>
>>>
>>> 
>>>
>>
>>
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

From neel at mediapulse.com  Tue Dec  2 14:51:32 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:04:25 2004
Subject: [mod_python] Getting mod_python version
Message-ID: <C0FC22C08B82074A88B50061764157776B9864@johnson.mediapulse.net>

What if something changed every major version, 2 - 5?

with __version__ you could:

	if m.__version__.startswidth('2.'):
		user = m.get2_user()
	elif m.__version__.startswidth('3.'):
		user = m.get3_user()
	elif m.__version__.startswidth('4.'):
		user = m.get4_user()
	elif m.__version__.startswidth('5.'):
		user = m.get5_user()
	else:
		#unsupported version

with try/except:

	try:
		user = m.get2_user()
	except:
		try:
			user = m.get3_user()
		except:
			try:
				user = m.get4_user()
			except:
				try:
					user = m.get5_user()
				except:
					#unsupported version

I'm failing to see why it is supposed to be easier to code/easier to
read with multiple try/except blocks, which are just going to get deeper
as we go.

Mike

> -----Original Message-----
> From: Michael S. Fischer [mailto:michael@dynamine.net] 
> Sent: Tuesday, December 02, 2003 2:41 PM
> To: Michael C. Neel
> Cc: Gustavo C?rdova Avila; mod_python@modpython.org
> Subject: Re: [mod_python] Getting mod_python version
> 
> 
> Regardless of whether or not __version__ is implemented, 
> using exception 
> handling is more robust in the long run, I think.
> 
> Forgetting to change the interface version number when a 
> compatibility 
> detail has changed is not an unknown phenomenon -- if not with 
> mod_python, then certainly with other SDKs.
> 
> --Michael
> 
> Michael C. Neel wrote:
> 
> > Most modules have a __version__ member, and the help() 
> built-in method
> > even looks for this variable and uses it to display the 
> version of the
> > file:
> > 
> > 
> >>>>import cgi
> >>>>cgi.__version__
> > 
> > '2.6'
> > 
> >>>>help(cgi)
> > 
> > ...skipping...
> > DATA
> >     __all__ = ['MiniFieldStorage', 'FieldStorage', 
> 'FormContentDict',
> > 'SvF...
> >     __version__ = '2.6'
> >     logfile = ''
> >     logfp = None
> >     maxlen = 0
> > 
> > VERSION
> >     2.6
> > 
> > 
> > 
> > I have not read or seen anything saying the "pythonic" way 
> of versioning
> > a module is by try/except blocks testing to see if variable 
> exist.  I
> > have however seen this from PEP 8:
> > 
> > Version Bookkeeping
> > 
> >     If you have to have RCS or CVS crud in your source 
> file, do it as
> >     follows.
> > 
> >         __version__ = "$Revision: 1.20 $"
> >         # $Source: 
> /cvsroot/python/python/nondist/peps/pep-0008.txt,v $
> > 
> >     These lines should be included after the module's docstring,
> >     before any other code, separated by a blank line above and
> >     below.
> > 
> > Which implies to me that __version__ is a pythonic way of 
> versioning a
> > module/code file, though it doesn't seem to be as standard 
> as __doc__.
> > 
> > Mike
> > 
> > 
> >>-----Original Message-----
> >>From: Gustavo C?rdova Avila [mailto:gustavo.cordova@q-voz.com] 
> >>Sent: Tuesday, December 02, 2003 1:47 PM
> >>To: Michael C. Neel
> >>Cc: mod_python@modpython.org
> >>Subject: Re: [mod_python] Getting mod_python version
> >>
> >>
> >>This is the correct, "pythonic" way of doing things.
> >>
> >>I'd recommend using "except AttributeError:" instead of a naked 
> >>"except:" btw.
> >>
> >>-gustavo
> >>
> >>Michael C. Neel wrote:
> >>
> >>
> >>>Hi all,
> >>>
> >>>	I don't know if it's not there, or I'm just overlooking it, but
> >>>I can seem for a way in code to get the version of 
> >>
> >>mod_python.  I have
> >>
> >>>some "default" modules I use, and I am trying to make them 
> >>
> >>work with any
> >>
> >>>mod_python version.  Right now I'm doing try block, like such:
> >>>
> >>>   # Get username/password from client
> >>>   pw = req.get_basic_auth_pw()
> >>>   try:
> >>>       # mod_python 2.x
> >>>       user = req.connection.user
> >>>   except:
> >>>       # mod_python 3.x
> >>>       user = req.user
> >>>
> >>>	...but I'd rather be able to get the version directly.
> >>>
> >>>Mike
> >>>
> >>>_______________________________________________
> >>>Mod_python mailing list
> >>>Mod_python@modpython.org
> >>>http://mailman.modpython.org/mailman/listinfo/mod_python
> >>>
> >>>
> >>> 
> >>>
> >>
> >>
> > 
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> > 
> 
> 

From vincent_delft at yahoo.com  Tue Dec  2 11:54:01 2003
From: vincent_delft at yahoo.com (vincent delft)
Date: Fri Jan  9 22:04:25 2004
Subject: [mod_python] does mod_python is ready for production env. ?
Message-ID: <20031202195401.44707.qmail@web11505.mail.yahoo.com>

Sorry to ask this (may be stupid), but I plan to use
mod_python and Draco (see in links of the mod_python
site) on a production environment (a web service that
our enterprise will provide via http servers)


Is there any experience of mod_python on a production
env. ?

What about stability, fiability on a heavy loaded web
site ?

Is there "show stoppers" to use mod_python on a
production env. ?

Thanks 


PS : I'm pythoniac since years, and I definitively
hate php (just a personnal point of view).




__________________________________
Do you Yahoo!?
Free Pop-Up Blocker - Get it now
http://companion.yahoo.com/
From michael at dynamine.net  Tue Dec  2 11:59:05 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 22:04:25 2004
Subject: [mod_python] Getting mod_python version
In-Reply-To: <C0FC22C08B82074A88B50061764157776B9864@johnson.mediapulse.net>
References: <C0FC22C08B82074A88B50061764157776B9864@johnson.mediapulse.net>
Message-ID: <3FCCEF09.6000907@dynamine.net>

I agree that the code looks a little cleaner, but I still think it's 
less robust due to the phenomenon I described.

(Python also makes you use 'elif's instead of 'case' statements, and 
there's something to be said about the ugliness of the former as well. 
Eye of the beholder, I guess.)

Best,

--Michael

Michael C. Neel wrote:

> What if something changed every major version, 2 - 5?
> 
> with __version__ you could:
> 
> 	if m.__version__.startswidth('2.'):
> 		user = m.get2_user()
> 	elif m.__version__.startswidth('3.'):
> 		user = m.get3_user()
> 	elif m.__version__.startswidth('4.'):
> 		user = m.get4_user()
> 	elif m.__version__.startswidth('5.'):
> 		user = m.get5_user()
> 	else:
> 		#unsupported version
> 
> with try/except:
> 
> 	try:
> 		user = m.get2_user()
> 	except:
> 		try:
> 			user = m.get3_user()
> 		except:
> 			try:
> 				user = m.get4_user()
> 			except:
> 				try:
> 					user = m.get5_user()
> 				except:
> 					#unsupported version
> 
> I'm failing to see why it is supposed to be easier to code/easier to
> read with multiple try/except blocks, which are just going to get deeper
> as we go.
> 
> Mike
> 
> 
>>-----Original Message-----
>>From: Michael S. Fischer [mailto:michael@dynamine.net] 
>>Sent: Tuesday, December 02, 2003 2:41 PM
>>To: Michael C. Neel
>>Cc: Gustavo C?rdova Avila; mod_python@modpython.org
>>Subject: Re: [mod_python] Getting mod_python version
>>
>>
>>Regardless of whether or not __version__ is implemented, 
>>using exception 
>>handling is more robust in the long run, I think.
>>
>>Forgetting to change the interface version number when a 
>>compatibility 
>>detail has changed is not an unknown phenomenon -- if not with 
>>mod_python, then certainly with other SDKs.
>>
>>--Michael
>>
>>Michael C. Neel wrote:
>>
>>
>>>Most modules have a __version__ member, and the help() 
>>
>>built-in method
>>
>>>even looks for this variable and uses it to display the 
>>
>>version of the
>>
>>>file:
>>>
>>>
>>>
>>>>>>import cgi
>>>>>>cgi.__version__
>>>
>>>'2.6'
>>>
>>>
>>>>>>help(cgi)
>>>
>>>...skipping...
>>>DATA
>>>    __all__ = ['MiniFieldStorage', 'FieldStorage', 
>>
>>'FormContentDict',
>>
>>>'SvF...
>>>    __version__ = '2.6'
>>>    logfile = ''
>>>    logfp = None
>>>    maxlen = 0
>>>
>>>VERSION
>>>    2.6
>>>
>>>
>>>
>>>I have not read or seen anything saying the "pythonic" way 
>>
>>of versioning
>>
>>>a module is by try/except blocks testing to see if variable 
>>
>>exist.  I
>>
>>>have however seen this from PEP 8:
>>>
>>>Version Bookkeeping
>>>
>>>    If you have to have RCS or CVS crud in your source 
>>
>>file, do it as
>>
>>>    follows.
>>>
>>>        __version__ = "$Revision: 1.20 $"
>>>        # $Source: 
>>
>>/cvsroot/python/python/nondist/peps/pep-0008.txt,v $
>>
>>>    These lines should be included after the module's docstring,
>>>    before any other code, separated by a blank line above and
>>>    below.
>>>
>>>Which implies to me that __version__ is a pythonic way of 
>>
>>versioning a
>>
>>>module/code file, though it doesn't seem to be as standard 
>>
>>as __doc__.
>>
>>>Mike
>>>
>>>
>>>
>>>>-----Original Message-----
>>>>From: Gustavo C?rdova Avila [mailto:gustavo.cordova@q-voz.com] 
>>>>Sent: Tuesday, December 02, 2003 1:47 PM
>>>>To: Michael C. Neel
>>>>Cc: mod_python@modpython.org
>>>>Subject: Re: [mod_python] Getting mod_python version
>>>>
>>>>
>>>>This is the correct, "pythonic" way of doing things.
>>>>
>>>>I'd recommend using "except AttributeError:" instead of a naked 
>>>>"except:" btw.
>>>>
>>>>-gustavo
>>>>
>>>>Michael C. Neel wrote:
>>>>
>>>>
>>>>
>>>>>Hi all,
>>>>>
>>>>>	I don't know if it's not there, or I'm just overlooking it, but
>>>>>I can seem for a way in code to get the version of 
>>>>
>>>>mod_python.  I have
>>>>
>>>>
>>>>>some "default" modules I use, and I am trying to make them 
>>>>
>>>>work with any
>>>>
>>>>
>>>>>mod_python version.  Right now I'm doing try block, like such:
>>>>>
>>>>>  # Get username/password from client
>>>>>  pw = req.get_basic_auth_pw()
>>>>>  try:
>>>>>      # mod_python 2.x
>>>>>      user = req.connection.user
>>>>>  except:
>>>>>      # mod_python 3.x
>>>>>      user = req.user
>>>>>
>>>>>	...but I'd rather be able to get the version directly.
>>>>>
>>>>>Mike
>>>>>
>>>>>_______________________________________________
>>>>>Mod_python mailing list
>>>>>Mod_python@modpython.org
>>>>>http://mailman.modpython.org/mailman/listinfo/mod_python
>>>>>
>>>>>
>>>>>
>>>>>
>>>>
>>>>
>>>_______________________________________________
>>>Mod_python mailing list
>>>Mod_python@modpython.org
>>>http://mailman.modpython.org/mailman/listinfo/mod_python
>>>
>>
>>
> 

From neel at mediapulse.com  Tue Dec  2 15:06:29 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:04:25 2004
Subject: [mod_python] Getting mod_python version
Message-ID: <C0FC22C08B82074A88B50061764157776B9865@johnson.mediapulse.net>

> (Python also makes you use 'elif's instead of 'case' statements, and 
> there's something to be said about the ugliness of the former 
> as well. 
> Eye of the beholder, I guess.)

I agree about the case issue as well, but let us never speak of it
again, lest the python police decend upon our homes in the night...

Mike

From neel at mediapulse.com  Tue Dec  2 15:17:18 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:04:25 2004
Subject: [mod_python] does mod_python is ready for production env. ?
Message-ID: <C0FC22C08B82074A88B500617641577787A7D5@johnson.mediapulse.net>

Yes, mod_python is extreamly viable in a production enviroment.  Draco I
cannot answer for, I tend to use Albatross.

We have used mod_python for several large sites without issue, the
problems have always been our own doing =)

In my personal tests, I found mod_python right behind mod_perl in terms
of speed and ahead of php.  My tests revolved around how I wanted to use
mod_python (big app using a mysql backend on linux), so if you are
worried about speed I recommend you conduct your own benchmarks with the
way you will be using mod_python.  At the time I was new to python, so
I'm sure there were ways to speed up the mod_python test site.

It's worth note that a C module will blow the doors off of a
perl/php/python site.  So if speed is really an issue, C is the way to
go.  If it's not that bad, then in terms of preformance perl/php/python
are all close enough to make it a non-issue.

I hate php as well ;)

Mike

> -----Original Message-----
> From: vincent delft [mailto:vincent_delft@yahoo.com] 
> Sent: Tuesday, December 02, 2003 2:54 PM
> To: mod_python@modpython.org
> Subject: [mod_python] does mod_python is ready for production env. ?
> 
> 
> Sorry to ask this (may be stupid), but I plan to use
> mod_python and Draco (see in links of the mod_python
> site) on a production environment (a web service that
> our enterprise will provide via http servers)
> 
> 
> Is there any experience of mod_python on a production
> env. ?
> 
> What about stability, fiability on a heavy loaded web
> site ?
> 
> Is there "show stoppers" to use mod_python on a
> production env. ?
> 
> Thanks 
> 
> 
> PS : I'm pythoniac since years, and I definitively
> hate php (just a personnal point of view).
> 
> 
> 
> 
> __________________________________
> Do you Yahoo!?
> Free Pop-Up Blocker - Get it now
> http://companion.yahoo.com/
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

From michael at dynamine.net  Tue Dec  2 12:40:24 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 22:04:25 2004
Subject: [mod_python] does mod_python is ready for production env. ?
In-Reply-To: <C0FC22C08B82074A88B500617641577787A7D5@johnson.mediapulse.net>
References: <C0FC22C08B82074A88B500617641577787A7D5@johnson.mediapulse.net>
Message-ID: <3FCCF8B8.90801@dynamine.net>

Michael C. Neel wrote:

> In my personal tests, I found mod_python right behind mod_perl in terms
> of speed and ahead of php.

Did you try the Zend Accelerator module for PHP?  When used, it makes 
PHP an order of magnitude faster.  I'm not kidding.  Simply blows 
mod_perl/mod_python away.

Of course, the upshot is that you'd have to program in PHP to use it :-)

Grisha, it might be an interesting future addition to mod_python to 
cache compiled Python code and access the compiled code via shared 
memory like the Zend Accelerator does -- if that's even possible with 
the Python architecture.

--Michael

From neel at mediapulse.com  Tue Dec  2 15:54:52 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:04:25 2004
Subject: [mod_python] does mod_python is ready for production env. ?
Message-ID: <C0FC22C08B82074A88B500617641577787A7D6@johnson.mediapulse.net>

> Did you try the Zend Accelerator module for PHP?  

No, Zend Accelerator requires fees and licensing, so it kinda ruled
itself out of the running.

> Of course, the upshot is that you'd have to program in PHP to 
> use it :-)

downside?

> 
> Grisha, it might be an interesting future addition to mod_python to 
> cache compiled Python code and access the compiled code via shared 
> memory like the Zend Accelerator does -- if that's even possible with 
> the Python architecture.
> 

Mod_python does this already, just make sure you have PythonDebug Off
(or not set) in your conf.

Mike

From dwmp at opti.cgi.net  Tue Dec  2 15:04:54 2003
From: dwmp at opti.cgi.net (Dan W.)
Date: Fri Jan  9 22:04:25 2004
Subject: [mod_python] does mod_python is ready for production env. ?
In-Reply-To: <C0FC22C08B82074A88B500617641577787A7D6@johnson.mediapulse.
 net>
Message-ID: <5.2.1.1.2.20031202150248.04685f88@mail.pyxos.com>


At 03:54 PM 12/2/2003 -0500, you wrote:
>Mod_python does this already, just make sure you have PythonDebug Off
>(or not set) in your conf.

How does PythonDebug change the execution time?  According to the 
documentation it just writes tracebacks to the output and the log at the 
same time vs. just the log.  Assuming you have no tracebacks in a 
production environment, why does this impact execution speed?

-Dan

From gustavo.cordova at q-voz.com  Tue Dec  2 15:28:00 2003
From: gustavo.cordova at q-voz.com (=?ISO-8859-1?Q?Gustavo_C=F3rdova_Avila?=)
Date: Fri Jan  9 22:04:25 2004
Subject: [mod_python] does mod_python is ready for production env. ?
In-Reply-To: <3FCCF8B8.90801@dynamine.net>
References: <C0FC22C08B82074A88B500617641577787A7D5@johnson.mediapulse.net>
	<3FCCF8B8.90801@dynamine.net>
Message-ID: <3FCD03E0.4010006@q-voz.com>

Michael S. Fischer wrote:

> Michael C. Neel wrote:
>
>> In my personal tests, I found mod_python right behind mod_perl in terms
>> of speed and ahead of php.
>
> Did you try the Zend Accelerator module for PHP?  When used, it makes 
> PHP an order of magnitude faster.  I'm not kidding.  Simply blows 
> mod_perl/mod_python away.
>
> Of course, the upshot is that you'd have to program in PHP to use it :-)
>
> Grisha, it might be an interesting future addition to mod_python to 
> cache compiled Python code and access the compiled code via shared 
> memory like the Zend Accelerator does -- if that's even possible with 
> the Python architecture.
>
> --Michael

You can do something even better from Python, just:

    import psyco
    psyco.profile()

and it'll automatically do some background profiling, and generate 
specialized machine code for any functions worth compiling.  Another 
common invocation is:

    import psyco
    psyco.bind(func1)
    psyco.bind(func2)
    ...

This is when you know which functions are worth compiling, so you 
generate specialized versions immediately, upon module startup.

Psyco's a really nice gem, you can check it out at:

    http://psyco.sourceforge.net/

-gustavo


From neel at mediapulse.com  Tue Dec  2 16:46:45 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:04:25 2004
Subject: [mod_python] does mod_python is ready for production env. ?
Message-ID: <C0FC22C08B82074A88B500617641577787A7D8@johnson.mediapulse.net>

> How does PythonDebug change the execution time?  According to the 
> documentation it just writes tracebacks to the output and the 
> log at the 
> same time vs. just the log.  Assuming you have no tracebacks in a 
> production environment, why does this impact execution speed?
> 

My bad, I looked at the wrong version of a conf file; you want
PythonAutoReload Off and PythonOptimize On.  You don't have to have
these to get modulke cacheing, that's always on, but these speed things
up some.

Mike

From grisha at modpython.org  Tue Dec  2 17:36:03 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:04:25 2004
Subject: [mod_python] does mod_python is ready for production env. ?
In-Reply-To: <3FCCF8B8.90801@dynamine.net>
References: <C0FC22C08B82074A88B500617641577787A7D5@johnson.mediapulse.net>
 <3FCCF8B8.90801@dynamine.net>
Message-ID: <20031202173437.L61463@onyx.ispol.com>


On Tue, 2 Dec 2003, Michael S. Fischer wrote:

> Michael C. Neel wrote:
>
> > In my personal tests, I found mod_python right behind mod_perl in terms
> > of speed and ahead of php.
>
> Did you try the Zend Accelerator module for PHP?

> Simply blows mod_perl/mod_python away.

I doubt it. :-)

Grisha
From vmanera at manord.com  Tue Dec  2 08:54:51 2003
From: vmanera at manord.com (Manera, Villiam)
Date: Fri Jan  9 22:04:25 2004
Subject: R: R: [mod_python]  Problem with Session module with multiple scr
	ipt alias not under t he  document root
Message-ID: <52DC70C1C1575C418CB033523A29CF1410490B@exchange2000.manord.com>

I've already noted the '/' and I tried both with PythonOption
ApplicationPath /script/cgi/cgi-mpy and directly  c.path =
'/script/cgi/cgi-mpy'
But without success.
Only work with path=''.


do you work on windows? I suppose that in windows Session doesn't work
without removing this problem. Any people has a configuration working in
win2000?

Villiam
-----Messaggio originale-----
Da: mod_python-bounces@modpython.org
[mailto:mod_python-bounces@modpython.org]Per conto di Neil Beattie
Inviato: sabato 29 novembre 2003 15.54
A: mod_python@modpython.org
Cc: Manera, Villiam
Oggetto: Re: R: [mod_python] Problem with Session module with multiple
script alias not under t he document root


> I'm sorry but still don't work.
> I'm removed all references to cgi and I moved all my directory with .py
> under document root:
> 
> DocumentRoot "C:/wwwroot/cartelle_sito_mdn"
> <Directory   "C:/wwwroot/cartelle_sito_mdn/script/cgi/cgi-py">
> 
> and with this new configuration req.headers_out:
> {'Set-Cookie': 'pysid=d4d10ab8e7917b43becbff01a2452f7e;
> path=/script/cgi/cgi-mpy/\', 'Cache-Control': 'no-cache="set-cookie"'} 
> and if I relod the page it never passed to req.headers_in


Looks like the path is not correct (extra \)
try adding the following line to your httpd.config  addHandler entry:

PythonOption ApplicationPath /script/cgi/cgi-mpy


I have just had the same problem but have not yet discovered where the extra
\ 
comes from ( it is in _req.hlist.directory in session.py)




> 
> if I modify se session module:
> def make_cookie(self):
> 	....
>       c.path = ''   #dirpath[len(docroot):]
> then req.headers_out become:
> {'Set-Cookie': 'pysid=fb35b851ad27e7effe820c36871bc9b4; path=',
> 'Cache-Control': 'no-cache="set-cookie"'} 
> and If I relod the page it go to req.headers_in:
> {'Cookie': 'pysid=fb35b851ad27e7effe820c36871bc9b4', 'Connection':
> 'Keep-Alive', ...} 
> and req.heades_out : {}
> 
> so why if something else then '' is in path the pysid wasn't writing into
> the html heading? 
> 

Neil Beattie
NB Technology (Pty) Ltd

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python
From cs1spw at bath.ac.uk  Tue Dec  2 17:10:03 2003
From: cs1spw at bath.ac.uk (Simon Willison)
Date: Fri Jan  9 22:04:25 2004
Subject: [mod_python] does mod_python is ready for production env. ?
In-Reply-To: <20031202195401.44707.qmail@web11505.mail.yahoo.com>
References: <20031202195401.44707.qmail@web11505.mail.yahoo.com>
Message-ID: <3FCD1BCB.6020801@bath.ac.uk>

vincent delft wrote:
> PS : I'm pythoniac since years, and I definitively
> hate php (just a personnal point of view).

Reg:	Listen. If you really wanted to use mod_python, you'd have to 
really hate PHP.
Brian:  I do.
Reg:    Oh yeah? How much?
Brian:  A lot!
Reg:    Right. You're in.

(Sorry, couldn't resist it)

From michael at dynamine.net  Tue Dec  2 15:50:15 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 22:04:25 2004
Subject: [mod_python] does mod_python is ready for production env. ?
In-Reply-To: <3FCD03E0.4010006@q-voz.com>
References: <C0FC22C08B82074A88B500617641577787A7D5@johnson.mediapulse.net>
	<3FCCF8B8.90801@dynamine.net> <3FCD03E0.4010006@q-voz.com>
Message-ID: <3FCD2537.2010604@dynamine.net>

Gustavo C?rdova Avila wrote:
> Michael S. Fischer wrote:
>> Grisha, it might be an interesting future addition to mod_python to 
>> cache compiled Python code and access the compiled code via shared 
>> memory like the Zend Accelerator does -- if that's even possible with 
>> the Python architecture.

> You can do something even better from Python, just:
> 
>    import psyco
>    psyco.profile()

Apparently psyco is limited to the i386 platform at this time. 
Unfortunately I'm running on a PowerPC platform (Apple XServe) at my 
present assignment.  :(

--Michael

From davidf at sjsoft.com  Wed Dec  3 07:55:06 2003
From: davidf at sjsoft.com (David Fraser)
Date: Fri Jan  9 22:04:25 2004
Subject: [mod_python] does mod_python is ready for production env. ?
In-Reply-To: <3FCD2537.2010604@dynamine.net>
References: <C0FC22C08B82074A88B500617641577787A7D5@johnson.mediapulse.net>
	<3FCCF8B8.90801@dynamine.net> <3FCD03E0.4010006@q-voz.com>
	<3FCD2537.2010604@dynamine.net>
Message-ID: <3FCD7ABA.3070502@sjsoft.com>

Michael S. Fischer wrote:

> Gustavo C?rdova Avila wrote:
>
>> Michael S. Fischer wrote:
>>
>>> Grisha, it might be an interesting future addition to mod_python to 
>>> cache compiled Python code and access the compiled code via shared 
>>> memory like the Zend Accelerator does -- if that's even possible 
>>> with the Python architecture.
>>
>
>> You can do something even better from Python, just:
>>
>>    import psyco
>>    psyco.profile()
>
>
> Apparently psyco is limited to the i386 platform at this time. 
> Unfortunately I'm running on a PowerPC platform (Apple XServe) at my 
> present assignment.  :(

Armin is working on a platform-independent version, not sure of the 
status, but I think it was working. You could ask on the psyco mailing 
list, he's very helpful, and I'm sure would be grateful for someone 
testing it. Psyco is incredible

David

From jciccale at mac.com  Wed Dec  3 09:40:32 2003
From: jciccale at mac.com (Julian Ciccale)
Date: Fri Jan  9 22:04:25 2004
Subject: [mod_python] does mod_python is ready for production env. ?
Message-ID: <15142387.1070440832400.JavaMail.jciccale@mac.com>

Have you tried pywork ? 
http://pywork.sf.net  (old name was pythonwork)

It's a new web framework we are developing, and it rocks.

We have benchmarked agains other MVC/Template pairs
and it really rocks! It supports XSLT transforms (done in C),
ZPT templates and even lets you write your own View System.

- julcicc -

On Tuesday, December 02, 2003, at 08:54PM, vincent delft <vincent_delft@yahoo.com> wrote:

>Sorry to ask this (may be stupid), but I plan to use
>mod_python and Draco (see in links of the mod_python
>site) on a production environment (a web service that
>our enterprise will provide via http servers)
>
>
>Is there any experience of mod_python on a production
>env. ?
>
>What about stability, fiability on a heavy loaded web
>site ?
>
>Is there "show stoppers" to use mod_python on a
>production env. ?
>
>Thanks 
>
>
>PS : I'm pythoniac since years, and I definitively
>hate php (just a personnal point of view).
>
>
>
>
>__________________________________
>Do you Yahoo!?
>Free Pop-Up Blocker - Get it now
>http://companion.yahoo.com/
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
From vmanera at manord.com  Wed Dec  3 11:49:05 2003
From: vmanera at manord.com (Manera, Villiam)
Date: Fri Jan  9 22:04:25 2004
Subject: R: R: [mod_python]  Problem with Session module with multiple scr
	ipt alias not under t he  document root
Message-ID: <52DC70C1C1575C418CB033523A29CF1497D5C3@exchange2000.manord.com>

I found the way:
with: PythonOption ApplicationPath ' '
in every directory with python module all work fine.

If this is the rigth way it would be better to add in session manual.

Villiam

sorry, the latest test that I made was wrong,
effectively with:
PythonOption ApplicationPath /script/cgi/cgi-mpy 
the script below cgi-mpy working weel, but the script below other directory
doesn't work:
 DocumentRoot "C:/wwwroot/cartelle_sito_mdn"
<Directory   "C:/wwwroot/cartelle_sito_mdn/script/cgi/cgi-py">
	.....
	PythonOption ApplicationPath /script/cgi/cgi-mpy 

<Directory   "C:/wwwroot/cartelle_sito_mdn/script/cgi/studi">
	.....
	PythonOption ApplicationPath /script/cgi/studi 

If I first call an url below studi I'm able to work with all the module
below studi, but any attempt to go in cgi-mpy cause a new
sorry, the latest test that I made was wrong, effectively with 
PythonOption ApplicationPath /script/cgi/cgi-mpy 
the script below cgi-mpy working weel, but the script below other directory
doesn't work:


If I first call an url below studi I'm able to work with all the module
below studi, but any attempt to go in cgi-mpy cause a new Session id

vice versa if I first call a url below cgi-mpy ....

instead with path = '' all work fine, but I don't discovery the way to do it
with 
PythonOption ApplicationPath 
Villiam
-----Messaggio originale-----
Da: mod_python-bounces@modpython.org
[mailto:mod_python-bounces@modpython.org]Per conto di Neil Beattie
Inviato: sabato 29 novembre 2003 15.54
A: mod_python@modpython.org
Cc: Manera, Villiam
Oggetto: Re: R: [mod_python] Problem with Session module with multiple
script alias not under t he document root


> I'm sorry but still don't work.
> I'm removed all references to cgi and I moved all my directory with .py
> under document root:
> 
> DocumentRoot "C:/wwwroot/cartelle_sito_mdn"
> <Directory   "C:/wwwroot/cartelle_sito_mdn/script/cgi/cgi-py">
> 
> and with this new configuration req.headers_out:
> {'Set-Cookie': 'pysid=d4d10ab8e7917b43becbff01a2452f7e;
> path=/script/cgi/cgi-mpy/\', 'Cache-Control': 'no-cache="set-cookie"'} 
> and if I relod the page it never passed to req.headers_in


Looks like the path is not correct (extra \)
try adding the following line to your httpd.config  addHandler entry:

PythonOption ApplicationPath /script/cgi/cgi-mpy


I have just had the same problem but have not yet discovered where the extra
\ 
comes from ( it is in _req.hlist.directory in session.py)




> 
> if I modify se session module:
> def make_cookie(self):
> 	....
>       c.path = ''   #dirpath[len(docroot):]
> then req.headers_out become:
> {'Set-Cookie': 'pysid=fb35b851ad27e7effe820c36871bc9b4; path=',
> 'Cache-Control': 'no-cache="set-cookie"'} 
> and If I relod the page it go to req.headers_in:
> {'Cookie': 'pysid=fb35b851ad27e7effe820c36871bc9b4', 'Connection':
> 'Keep-Alive', ...} 
> and req.heades_out : {}
> 
> so why if something else then '' is in path the pysid wasn't writing into
> the html heading? 
> 

Neil Beattie
NB Technology (Pty) Ltd

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python
From vincent_delft at yahoo.com  Wed Dec  3 12:14:35 2003
From: vincent_delft at yahoo.com (vincent delft)
Date: Fri Jan  9 22:04:25 2004
Subject: [mod_python] does mod_python is ready for production env. ?
In-Reply-To: <15142387.1070440832400.JavaMail.jciccale@mac.com>
Message-ID: <20031203201435.57970.qmail@web11502.mail.yahoo.com>

Thanks to all your feedbacks. 

This prouve me that mod_python is reliable enough for
real production env.

Vincent






--- Julian Ciccale <jciccale@mac.com> wrote:
> Have you tried pywork ? 
> http://pywork.sf.net  (old name was pythonwork)
> 
> It's a new web framework we are developing, and it
> rocks.
> 
> We have benchmarked agains other MVC/Template pairs
> and it really rocks! It supports XSLT transforms
> (done in C),
> ZPT templates and even lets you write your own View
> System.
> 
> - julcicc -
> 
> On Tuesday, December 02, 2003, at 08:54PM, vincent
> delft <vincent_delft@yahoo.com> wrote:
> 
> >Sorry to ask this (may be stupid), but I plan to
> use
> >mod_python and Draco (see in links of the
> mod_python
> >site) on a production environment (a web service
> that
> >our enterprise will provide via http servers)
> >
> >
> >Is there any experience of mod_python on a
> production
> >env. ?
> >
> >What about stability, fiability on a heavy loaded
> web
> >site ?
> >
> >Is there "show stoppers" to use mod_python on a
> >production env. ?
> >
> >Thanks 
> >
> >
> >PS : I'm pythoniac since years, and I definitively
> >hate php (just a personnal point of view).
> >
> >
> >
> >
> >__________________________________
> >Do you Yahoo!?
> >Free Pop-Up Blocker - Get it now
> >http://companion.yahoo.com/
> >_______________________________________________
> >Mod_python mailing list
> >Mod_python@modpython.org
>
>http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> >

__________________________________
Do you Yahoo!?
Free Pop-Up Blocker - Get it now
http://companion.yahoo.com/
From dwmp at opti.cgi.net  Wed Dec  3 17:54:28 2003
From: dwmp at opti.cgi.net (Dan W.)
Date: Fri Jan  9 22:04:25 2004
Subject: [mod_python] 3.1.2b & worker MPM
Message-ID: <5.2.1.1.2.20031203174401.03b996c0@mail.pyxos.com>


I'm running into a weird problem with 3.1.2b and Apache 2.0.47 compiled 
under the worker MPM.  I have two Apache processes, each with 25 
threads.  I have a very simple PSP page which imports a simple .py module 
and prints out a value.  The problem is that the page is only served part 
of the time.  When it is served, it is correct (no tracebacks), but if I do 
a browser reload a couple times it will eventually serve a blank page.  I 
can immediately do a browser reload a few more times and get a few more 
blank pages.  Then if I wait a few seconds and do a browser reload again 
then it will serve up the proper page.

I'm not quite sure how to verify it, but it appears as though one process 
is having a problem with mod_python while the other process is functioning 
properly.  Any suggestions on how I could verify this or other ideas?

I wasn't able to find anything in the documentation on MPM compatibility.

Thanks!

-Dan

From dwmp at opti.cgi.net  Wed Dec  3 21:14:19 2003
From: dwmp at opti.cgi.net (Dan W.)
Date: Fri Jan  9 22:04:25 2004
Subject: [mod_python] PSP bug report
In-Reply-To: <5.2.1.1.2.20031203174401.03b996c0@mail.pyxos.com>
Message-ID: <5.2.1.1.2.20031203210332.02bf6de0@mail.pyxos.com>


It turns out that my problem wasn't related to the worker MPM after 
all.  After minimizing the code down I've found that PSP fails on zero 
element for loops.  The following PSP page should reproduce the problem.

<%
for x in range(0):
     pass
%>
<html>
<body>
Hello world
</body>
</html>


Does the PSP maintainer read this list?

-Dan



At 05:54 PM 12/3/2003 -0600, you wrote:

>I'm running into a weird problem with 3.1.2b and Apache 2.0.47 compiled 
>under the worker MPM.  I have two Apache processes, each with 25 
>threads.  I have a very simple PSP page which imports a simple .py module 
>and prints out a value.  The problem is that the page is only served part 
>of the time.  When it is served, it is correct (no tracebacks), but if I 
>do a browser reload a couple times it will eventually serve a blank 
>page.  I can immediately do a browser reload a few more times and get a 
>few more blank pages.  Then if I wait a few seconds and do a browser 
>reload again then it will serve up the proper page.
>
>I'm not quite sure how to verify it, but it appears as though one process 
>is having a problem with mod_python while the other process is functioning 
>properly.  Any suggestions on how I could verify this or other ideas?
>
>I wasn't able to find anything in the documentation on MPM compatibility.
>
>Thanks!
>
>-Dan
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python

From dwmp at opti.cgi.net  Wed Dec  3 22:15:43 2003
From: dwmp at opti.cgi.net (Dan W.)
Date: Fri Jan  9 22:04:25 2004
Subject: [mod_python] PSP bug report
In-Reply-To: <5.2.1.1.2.20031203210332.02bf6de0@mail.pyxos.com>
References: <5.2.1.1.2.20031203174401.03b996c0@mail.pyxos.com>
Message-ID: <5.2.1.1.2.20031203221244.02b28a20@mail.pyxos.com>


I realized my error too late.  I needed a blank line after the loop.  PSP 
was considering the rest of the page to be part of the loop and since the 
loop did not execute neither did the html.

-Dan



At 09:14 PM 12/3/2003 -0600, you wrote:

>It turns out that my problem wasn't related to the worker MPM after 
>all.  After minimizing the code down I've found that PSP fails on zero 
>element for loops.  The following PSP page should reproduce the problem.
>
><%
>for x in range(0):
>     pass
>%>
>Hello world
>
>Does the PSP maintainer read this list?
>
>-Dan
>
>
>
>At 05:54 PM 12/3/2003 -0600, you wrote:
>
> >I'm running into a weird problem with 3.1.2b and Apache 2.0.47 compiled
> >under the worker MPM.  I have two Apache processes, each with 25
> >threads.  I have a very simple PSP page which imports a simple .py module
> >and prints out a value.  The problem is that the page is only served part
> >of the time.  When it is served, it is correct (no tracebacks), but if I
> >do a browser reload a couple times it will eventually serve a blank
> >page.  I can immediately do a browser reload a few more times and get a
> >few more blank pages.  Then if I wait a few seconds and do a browser
> >reload again then it will serve up the proper page.
> >
> >I'm not quite sure how to verify it, but it appears as though one process
> >is having a problem with mod_python while the other process is functioning
> >properly.  Any suggestions on how I could verify this or other ideas?
> >
> >I wasn't able to find anything in the documentation on MPM compatibility.
> >
> >Thanks!
> >
> >-Dan
> >
> >_______________________________________________
> >Mod_python mailing list
> >Mod_python@modpython.org
> >http://mailman.modpython.org/mailman/listinfo/mod_python
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python

From grisha at modpython.org  Thu Dec  4 01:00:44 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:04:25 2004
Subject: [mod_python] PSP bug report
In-Reply-To: <5.2.1.1.2.20031203221244.02b28a20@mail.pyxos.com>
References: <5.2.1.1.2.20031203174401.03b996c0@mail.pyxos.com>
 <5.2.1.1.2.20031203221244.02b28a20@mail.pyxos.com>
Message-ID: <20031204005846.Y83403@onyx.ispol.com>


I think the best practice is to use a comment rather than a blank line:

<%
for x in range(0):
	pass
# end for
%>

Grisha

On Wed, 3 Dec 2003, Dan W. wrote:

>
> I realized my error too late.  I needed a blank line after the loop.  PSP
> was considering the rest of the page to be part of the loop and since the
> loop did not execute neither did the html.
>
> -Dan
>
>
>
> At 09:14 PM 12/3/2003 -0600, you wrote:
>
> >It turns out that my problem wasn't related to the worker MPM after
> >all.  After minimizing the code down I've found that PSP fails on zero
> >element for loops.  The following PSP page should reproduce the problem.
> >
> ><%
> >for x in range(0):
> >     pass
> >%>
> >Hello world
> >
> >Does the PSP maintainer read this list?
> >
> >-Dan
> >
> >
> >
> >At 05:54 PM 12/3/2003 -0600, you wrote:
> >
> > >I'm running into a weird problem with 3.1.2b and Apache 2.0.47 compiled
> > >under the worker MPM.  I have two Apache processes, each with 25
> > >threads.  I have a very simple PSP page which imports a simple .py module
> > >and prints out a value.  The problem is that the page is only served part
> > >of the time.  When it is served, it is correct (no tracebacks), but if I
> > >do a browser reload a couple times it will eventually serve a blank
> > >page.  I can immediately do a browser reload a few more times and get a
> > >few more blank pages.  Then if I wait a few seconds and do a browser
> > >reload again then it will serve up the proper page.
> > >
> > >I'm not quite sure how to verify it, but it appears as though one process
> > >is having a problem with mod_python while the other process is functioning
> > >properly.  Any suggestions on how I could verify this or other ideas?
> > >
> > >I wasn't able to find anything in the documentation on MPM compatibility.
> > >
> > >Thanks!
> > >
> > >-Dan
> > >
> > >_______________________________________________
> > >Mod_python mailing list
> > >Mod_python@modpython.org
> > >http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> >_______________________________________________
> >Mod_python mailing list
> >Mod_python@modpython.org
> >http://mailman.modpython.org/mailman/listinfo/mod_python
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From Vincent.Raaijmakers at ge.com  Thu Dec  4 07:48:52 2003
From: Vincent.Raaijmakers at ge.com (Raaijmakers, Vincent (IndSys, GE Interlogix))
Date: Fri Jan  9 22:04:25 2004
Subject: [mod_python] Handlers "good practice" question 
Message-ID: <971323274247EB44B9A01D0A3B424C8503F13BDF@FTWMLVEM02.e2k.ad.ge.com>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/gif
Size: 145 bytes
Desc: Blank Bkgrd.gif
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20031204/29f70021/attachment-0003.gif
From vmanera at manord.com  Wed Dec  3 11:28:08 2003
From: vmanera at manord.com (Manera, Villiam)
Date: Fri Jan  9 22:04:26 2004
Subject: R: R: [mod_python]  Problem with Session module with multiple scr
	ipt alias not under t he  document root
Message-ID: <52DC70C1C1575C418CB033523A29CF1410490E@exchange2000.manord.com>

sorry, the latest test that I made was wrong,
effectively with:
PythonOption ApplicationPath /script/cgi/cgi-mpy 
the script below cgi-mpy working weel, but the script below other directory
doesn't work:
 DocumentRoot "C:/wwwroot/cartelle_sito_mdn"
<Directory   "C:/wwwroot/cartelle_sito_mdn/script/cgi/cgi-py">
	.....
	PythonOption ApplicationPath /script/cgi/cgi-mpy 

<Directory   "C:/wwwroot/cartelle_sito_mdn/script/cgi/studi">
	.....
	PythonOption ApplicationPath /script/cgi/studi 

If I first call an url below studi I'm able to work with all the module
below studi, but any attempt to go in cgi-mpy cause a new
sorry, the latest test that I made was wrong, effectively with 
PythonOption ApplicationPath /script/cgi/cgi-mpy 
the script below cgi-mpy working weel, but the script below other directory
doesn't work:


If I first call an url below studi I'm able to work with all the module
below studi, but any attempt to go in cgi-mpy cause a new Session id

vice versa if I first call a url below cgi-mpy ....

instead with path = '' all work fine, but I don't discovery the way to do it
with 
PythonOption ApplicationPath 
Villiam
-----Messaggio originale-----
Da: mod_python-bounces@modpython.org
[mailto:mod_python-bounces@modpython.org]Per conto di Neil Beattie
Inviato: sabato 29 novembre 2003 15.54
A: mod_python@modpython.org
Cc: Manera, Villiam
Oggetto: Re: R: [mod_python] Problem with Session module with multiple
script alias not under t he document root


> I'm sorry but still don't work.
> I'm removed all references to cgi and I moved all my directory with .py
> under document root:
> 
> DocumentRoot "C:/wwwroot/cartelle_sito_mdn"
> <Directory   "C:/wwwroot/cartelle_sito_mdn/script/cgi/cgi-py">
> 
> and with this new configuration req.headers_out:
> {'Set-Cookie': 'pysid=d4d10ab8e7917b43becbff01a2452f7e;
> path=/script/cgi/cgi-mpy/\', 'Cache-Control': 'no-cache="set-cookie"'} 
> and if I relod the page it never passed to req.headers_in


Looks like the path is not correct (extra \)
try adding the following line to your httpd.config  addHandler entry:

PythonOption ApplicationPath /script/cgi/cgi-mpy


I have just had the same problem but have not yet discovered where the extra
\ 
comes from ( it is in _req.hlist.directory in session.py)




> 
> if I modify se session module:
> def make_cookie(self):
> 	....
>       c.path = ''   #dirpath[len(docroot):]
> then req.headers_out become:
> {'Set-Cookie': 'pysid=fb35b851ad27e7effe820c36871bc9b4; path=',
> 'Cache-Control': 'no-cache="set-cookie"'} 
> and If I relod the page it go to req.headers_in:
> {'Cookie': 'pysid=fb35b851ad27e7effe820c36871bc9b4', 'Connection':
> 'Keep-Alive', ...} 
> and req.heades_out : {}
> 
> so why if something else then '' is in path the pysid wasn't writing into
> the html heading? 
> 

Neil Beattie
NB Technology (Pty) Ltd

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python
From neel at mediapulse.com  Thu Dec  4 10:52:09 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:04:26 2004
Subject: [mod_python] Handlers "good practice" question 
Message-ID: <C0FC22C08B82074A88B500617641577787A7DA@johnson.mediapulse.net>

Mod_python (docs) kinda assumes you are familiar with how apache works,
it really just exposing the C API in a python interface for the most
part.  To learn about the apache method of doing things, I'd recommend
reading "Writing Apache Modules in C and Perl" from O'rielly press
(title is something like that).  Language and details differ some, but
the general flow is the same.

Mike


-----Original Message-----
From: Raaijmakers, Vincent (IndSys, GE Interlogix)
[mailto:Vincent.Raaijmakers@ge.com] 
Sent: Thursday, December 04, 2003 8:49 AM
To: mod_python@modpython.org
Subject: [mod_python] Handlers "good practice" question 


I consider myself as a complete newbie with mod_python.  My goal is to
setup a good foundation for my web application using mod_python. Read
all the docs, mail history messages, tried every handler but... 
What I clearly miss is a guideline of a good default structure of the
different handlers. What is good practice? I guess when I try to learn
by trial and error, some structure will come up. I'm also sure that the
documentation I have in my hands will become more clear. It feels like
that mod_python has a lot of excellent soccer players but how to make a
team of it?
Please guru's, where can I find help?
Vincent

From anthony.barker at bmo.com  Thu Dec  4 12:07:49 2003
From: anthony.barker at bmo.com (anthony.barker@bmo.com)
Date: Fri Jan  9 22:04:26 2004
Subject: [mod_python] session management
Message-ID: <OF46341989.F03189B8-ON85256DF2.004D673F@notes.bmo.com>

Do the mod_python sessions work in windows 2000?

It would be nice if the session module was compatible with cgi, so it 
could be used in prototyping situations where the user doesn't have access 
to 
a mod_python enabled apache server....

Anthony
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20031204/9ee164f1/attachment-0003.htm
From conrad at hep.caltech.edu  Thu Dec  4 09:35:46 2003
From: conrad at hep.caltech.edu (Conrad Steenberg)
Date: Fri Jan  9 22:04:26 2004
Subject: [mod_python] PSP bug report
In-Reply-To: <20031204005846.Y83403@onyx.ispol.com>
References: <5.2.1.1.2.20031203174401.03b996c0@mail.pyxos.com>
	 <5.2.1.1.2.20031203221244.02b28a20@mail.pyxos.com>
	 <20031204005846.Y83403@onyx.ispol.com>
Message-ID: <1070559346.13675.37.camel@heppc22.hep.caltech.edu>

Hi Grisha

This may not be a bug, but it could still be worth the effort to make an
%> be considered a newline as well - purely from a support perspective
and the amount of annoyance it might save you and countless new users of
PSP :-)

Cheers

Conrad

On Wed, 2003-12-03 at 22:00, Gregory (Grisha) Trubetskoy wrote:
> I think the best practice is to use a comment rather than a blank line:
> 
> <%
> for x in range(0):
> 	pass
> # end for
> %>
> 
> Grisha
> 
> On Wed, 3 Dec 2003, Dan W. wrote:
> 
> >
> > I realized my error too late.  I needed a blank line after the loop.  PSP
> > was considering the rest of the page to be part of the loop and since the
> > loop did not execute neither did the html.
> >
> > -Dan
> >
> >
> >
> > At 09:14 PM 12/3/2003 -0600, you wrote:
> >
> > >It turns out that my problem wasn't related to the worker MPM after
> > >all.  After minimizing the code down I've found that PSP fails on zero
> > >element for loops.  The following PSP page should reproduce the problem.
> > >
> > ><%
> > >for x in range(0):
> > >     pass
> > >%>
> > >Hello world
> > >
> > >Does the PSP maintainer read this list?
> > >
> > >-Dan
> > >
> > >
> > >
> > >At 05:54 PM 12/3/2003 -0600, you wrote:
> > >
> > > >I'm running into a weird problem with 3.1.2b and Apache 2.0.47 compiled
> > > >under the worker MPM.  I have two Apache processes, each with 25
> > > >threads.  I have a very simple PSP page which imports a simple .py module
> > > >and prints out a value.  The problem is that the page is only served part
> > > >of the time.  When it is served, it is correct (no tracebacks), but if I
> > > >do a browser reload a couple times it will eventually serve a blank
> > > >page.  I can immediately do a browser reload a few more times and get a
> > > >few more blank pages.  Then if I wait a few seconds and do a browser
> > > >reload again then it will serve up the proper page.
> > > >
> > > >I'm not quite sure how to verify it, but it appears as though one process
> > > >is having a problem with mod_python while the other process is functioning
> > > >properly.  Any suggestions on how I could verify this or other ideas?
> > > >
> > > >I wasn't able to find anything in the documentation on MPM compatibility.
> > > >
> > > >Thanks!
> > > >
> > > >-Dan
> > > >
> > > >_______________________________________________
> > > >Mod_python mailing list
> > > >Mod_python@modpython.org
> > > >http://mailman.modpython.org/mailman/listinfo/mod_python
> > >
> > >_______________________________________________
> > >Mod_python mailing list
> > >Mod_python@modpython.org
> > >http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
-- 
Conrad Steenberg <conrad@hep.caltech.edu>

From michael at dynamine.net  Thu Dec  4 09:38:52 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 22:04:26 2004
Subject: [mod_python] session management
In-Reply-To: <OF46341989.F03189B8-ON85256DF2.004D673F@notes.bmo.com>
References: <OF46341989.F03189B8-ON85256DF2.004D673F@notes.bmo.com>
Message-ID: <3FCF712C.3000209@dynamine.net>

I'm confused.  Why would one want to prototype on a system that's not 
identical to the production system?

--Michael

anthony.barker@bmo.com wrote:

> 
> Do the mod_python sessions work in windows 2000?
> 
> It would be nice if the session module was compatible with cgi, so it 
> could be used in prototyping situations where the user doesn't have 
> access to
> a mod_python enabled apache server....
> 
> Anthony
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From dwmp at opti.cgi.net  Thu Dec  4 11:50:06 2003
From: dwmp at opti.cgi.net (Dan W.)
Date: Fri Jan  9 22:04:26 2004
Subject: [mod_python] PSP bug report
In-Reply-To: <1070559346.13675.37.camel@heppc22.hep.caltech.edu>
References: <20031204005846.Y83403@onyx.ispol.com>
 <5.2.1.1.2.20031203174401.03b996c0@mail.pyxos.com>
 <5.2.1.1.2.20031203221244.02b28a20@mail.pyxos.com>
 <20031204005846.Y83403@onyx.ispol.com>
Message-ID: <5.2.1.1.2.20031204114547.02af1930@mail.pyxos.com>


That would eliminate conditional html.  However, it might be interesting if 
PSP had a special directive for conditional html such as two percent signs.

<%%
for x in xrange(10):
%>

-Dan

At 09:35 AM 12/4/2003 -0800, you wrote:
>Hi Grisha
>
>This may not be a bug, but it could still be worth the effort to make an
>%> be considered a newline as well - purely from a support perspective
>and the amount of annoyance it might save you and countless new users of
>PSP :-)
>
>Cheers
>
>Conrad
>
>On Wed, 2003-12-03 at 22:00, Gregory (Grisha) Trubetskoy wrote:
> > I think the best practice is to use a comment rather than a blank line:
> >
> > <%
> > for x in range(0):
> >       pass
> > # end for
> > %>
> >
> > Grisha
> >
> > On Wed, 3 Dec 2003, Dan W. wrote:
> >
> > >
> > > I realized my error too late.  I needed a blank line after the loop.  PSP
> > > was considering the rest of the page to be part of the loop and since the
> > > loop did not execute neither did the html.
> > >
> > > -Dan
> > >
> > >
> > >
> > > At 09:14 PM 12/3/2003 -0600, you wrote:
> > >
> > > >It turns out that my problem wasn't related to the worker MPM after
> > > >all.  After minimizing the code down I've found that PSP fails on zero
> > > >element for loops.  The following PSP page should reproduce the problem.
> > > >
> > > ><%
> > > >for x in range(0):
> > > >     pass
> > > >%>
> > > >Hello world
> > > >
> > > >Does the PSP maintainer read this list?
> > > >
> > > >-Dan
> > > >
> > > >
> > > >
> > > >At 05:54 PM 12/3/2003 -0600, you wrote:
> > > >
> > > > >I'm running into a weird problem with 3.1.2b and Apache 2.0.47 
> compiled
> > > > >under the worker MPM.  I have two Apache processes, each with 25
> > > > >threads.  I have a very simple PSP page which imports a simple .py 
> module
> > > > >and prints out a value.  The problem is that the page is only 
> served part
> > > > >of the time.  When it is served, it is correct (no tracebacks), 
> but if I
> > > > >do a browser reload a couple times it will eventually serve a blank
> > > > >page.  I can immediately do a browser reload a few more times and 
> get a
> > > > >few more blank pages.  Then if I wait a few seconds and do a browser
> > > > >reload again then it will serve up the proper page.
> > > > >
> > > > >I'm not quite sure how to verify it, but it appears as though one 
> process
> > > > >is having a problem with mod_python while the other process is 
> functioning
> > > > >properly.  Any suggestions on how I could verify this or other ideas?
> > > > >
> > > > >I wasn't able to find anything in the documentation on MPM 
> compatibility.
> > > > >
> > > > >Thanks!
> > > > >
> > > > >-Dan
> > > > >
> > > > >_______________________________________________
> > > > >Mod_python mailing list
> > > > >Mod_python@modpython.org
> > > > >http://mailman.modpython.org/mailman/listinfo/mod_python
> > > >
> > > >_______________________________________________
> > > >Mod_python mailing list
> > > >Mod_python@modpython.org
> > > >http://mailman.modpython.org/mailman/listinfo/mod_python
> > >
> > > _______________________________________________
> > > Mod_python mailing list
> > > Mod_python@modpython.org
> > > http://mailman.modpython.org/mailman/listinfo/mod_python
> > >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
>--
>Conrad Steenberg <conrad@hep.caltech.edu>

From conrad at hep.caltech.edu  Thu Dec  4 10:04:12 2003
From: conrad at hep.caltech.edu (Conrad Steenberg)
Date: Fri Jan  9 22:04:26 2004
Subject: [mod_python] PSP bug report
In-Reply-To: <5.2.1.1.2.20031204114547.02af1930@mail.pyxos.com>
References: <20031204005846.Y83403@onyx.ispol.com>
	 <5.2.1.1.2.20031203174401.03b996c0@mail.pyxos.com>
	 <5.2.1.1.2.20031203221244.02b28a20@mail.pyxos.com>
	 <20031204005846.Y83403@onyx.ispol.com>
	 <5.2.1.1.2.20031204114547.02af1930@mail.pyxos.com>
Message-ID: <1070561052.13675.62.camel@heppc22.hep.caltech.edu>

Hi

Hmmm, you're right, I should have read the documentation again before
posting that. Treating %> as an unindent would also eliminate the
looping html construct.

Cheers

Conrad

On Thu, 2003-12-04 at 09:50, Dan W. wrote:
> That would eliminate conditional html.  However, it might be interesting if 
> PSP had a special directive for conditional html such as two percent signs.
> 
> <%%
> for x in xrange(10):
> %>
> 
> -Dan
> 
> At 09:35 AM 12/4/2003 -0800, you wrote:
> >Hi Grisha
> >
> >This may not be a bug, but it could still be worth the effort to make an
> >%> be considered a newline as well - purely from a support perspective
> >and the amount of annoyance it might save you and countless new users of
> >PSP :-)
> >
> >Cheers
> >
> >Conrad
> >
> >On Wed, 2003-12-03 at 22:00, Gregory (Grisha) Trubetskoy wrote:
> > > I think the best practice is to use a comment rather than a blank line:
> > >
> > > <%
> > > for x in range(0):
> > >       pass
> > > # end for
> > > %>
> > >
> > > Grisha
> > >
> > > On Wed, 3 Dec 2003, Dan W. wrote:
> > >
> > > >
> > > > I realized my error too late.  I needed a blank line after the loop.  PSP
> > > > was considering the rest of the page to be part of the loop and since the
> > > > loop did not execute neither did the html.
> > > >
> > > > -Dan
> > > >
> > > >
> > > >
> > > > At 09:14 PM 12/3/2003 -0600, you wrote:
> > > >
> > > > >It turns out that my problem wasn't related to the worker MPM after
> > > > >all.  After minimizing the code down I've found that PSP fails on zero
> > > > >element for loops.  The following PSP page should reproduce the problem.
> > > > >
> > > > ><%
> > > > >for x in range(0):
> > > > >     pass
> > > > >%>
> > > > >Hello world
> > > > >
> > > > >Does the PSP maintainer read this list?
> > > > >
> > > > >-Dan
> > > > >
> > > > >
> > > > >
> > > > >At 05:54 PM 12/3/2003 -0600, you wrote:
> > > > >
> > > > > >I'm running into a weird problem with 3.1.2b and Apache 2.0.47 
> > compiled
> > > > > >under the worker MPM.  I have two Apache processes, each with 25
> > > > > >threads.  I have a very simple PSP page which imports a simple .py 
> > module
> > > > > >and prints out a value.  The problem is that the page is only 
> > served part
> > > > > >of the time.  When it is served, it is correct (no tracebacks), 
> > but if I
> > > > > >do a browser reload a couple times it will eventually serve a blank
> > > > > >page.  I can immediately do a browser reload a few more times and 
> > get a
> > > > > >few more blank pages.  Then if I wait a few seconds and do a browser
> > > > > >reload again then it will serve up the proper page.
> > > > > >
> > > > > >I'm not quite sure how to verify it, but it appears as though one 
> > process
> > > > > >is having a problem with mod_python while the other process is 
> > functioning
> > > > > >properly.  Any suggestions on how I could verify this or other ideas?
> > > > > >
> > > > > >I wasn't able to find anything in the documentation on MPM 
> > compatibility.
> > > > > >
> > > > > >Thanks!
> > > > > >
> > > > > >-Dan
> > > > > >
> > > > > >_______________________________________________
> > > > > >Mod_python mailing list
> > > > > >Mod_python@modpython.org
> > > > > >http://mailman.modpython.org/mailman/listinfo/mod_python
> > > > >
> > > > >_______________________________________________
> > > > >Mod_python mailing list
> > > > >Mod_python@modpython.org
> > > > >http://mailman.modpython.org/mailman/listinfo/mod_python
> > > >
> > > > _______________________________________________
> > > > Mod_python mailing list
> > > > Mod_python@modpython.org
> > > > http://mailman.modpython.org/mailman/listinfo/mod_python
> > > >
> > > _______________________________________________
> > > Mod_python mailing list
> > > Mod_python@modpython.org
> > > http://mailman.modpython.org/mailman/listinfo/mod_python
> >--
> >Conrad Steenberg <conrad@hep.caltech.edu>
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
-- 
Conrad Steenberg <conrad@hep.caltech.edu>

From Vincent.Raaijmakers at ge.com  Thu Dec  4 16:21:34 2003
From: Vincent.Raaijmakers at ge.com (Raaijmakers, Vincent (IndSys, GE Interlogix))
Date: Fri Jan  9 22:04:26 2004
Subject: [mod_python] Handlers "good practice" question
Message-ID: <971323274247EB44B9A01D0A3B424C8503FF22A2@FTWMLVEM02.e2k.ad.ge.com>

Thanks, 

but please bring me up to speed. I read the information on the web. Do I have to see pywork as a replacement or add-on for all the Handlers of mod_python?
I mean, the default handlers are also a mechanism to go from web -> python code.

Well, perhaps this question shows my newbie level.

Also, based on the other responses, I definitely going to read the O'Reilly book about "Writing Apache Modules in C and Perl"


Vincent

-----Original Message-----
From: Julian Ciccale [mailto:jciccale@mac.com]
Sent: Thursday, December 04, 2003 9:32 AM
To: Raaijmakers, Vincent (IndSys, GE Interlogix)
Subject: Re: [mod_python] Handlers "good practice" question


I suggest you using a web framework on top of mod_python great foundations!

Try PyWork from http://pywork.sf.net , there is also draco and albatross.


On Thursday, December 04, 2003, at 02:48PM, Raaijmakers, Vincent (IndSys, GE Interlogix) <Vincent.Raaijmakers@ge.com> wrote:

>
><<Original Attached>>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python
>
>

From grisha at modpython.org  Thu Dec  4 22:51:53 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:04:26 2004
Subject: [mod_python] session management
In-Reply-To: <OF46341989.F03189B8-ON85256DF2.004D673F@notes.bmo.com>
References: <OF46341989.F03189B8-ON85256DF2.004D673F@notes.bmo.com>
Message-ID: <20031204224817.G97860@onyx.ispol.com>


On Thu, 4 Dec 2003 anthony.barker@bmo.com wrote:

> Do the mod_python sessions work in windows 2000?

I think it does, but if you read the recent "Problem with Session module
with multiple..." thread, it appears there is a bug with the way the path
is provided in the cookies on Windows in the latest beta version.

But, aside from that, the answer is "yes" ;-)

> It would be nice if the session module was compatible with cgi,
> so it could be used in prototyping situations where the user doesn't
> have access to a mod_python enabled apache server....

Cgi and mod_python are worlds apart, it makes no sense to find a
compromize between them.

Grisha
From jciccale at mac.com  Fri Dec  5 08:44:14 2003
From: jciccale at mac.com (Julian Ciccale)
Date: Fri Jan  9 22:04:26 2004
Subject: [mod_python] Handlers "good practice" question
Message-ID: <12818729.1070610254969.JavaMail.jciccale@mac.com>


>but please bring me up to speed. I read the information on the web. Do I have to see pywork as a 
>replacement or add-on for all the Handlers of mod_python?

In this case its a mod_python handler, so it would be a replacement


>I mean, the default handlers are also a mechanism to go from web -> python code.

Yes all the default python handlers are a mechanism to gor from web to python code and are really fast.

>Also, based on the other responses, I definitely going to read the O'Reilly book about "Writing 
> Apache Modules in C and Perl"

I don't see why you should write modules in C and Perl to write a web application. ModPython offers
much more flexibility and power and ModPython *IS* an Apache C Module, your applications, IMHO should be written in a higher level language, and only if you really need very high performance, you could rewrite some of your application's modules in C.

To get to know mod_python I think you could begin to understand the Publisher handler and if you are more lazy then try PSP..

In any case if you will start a big project I strongly suggest you to use some MVC/templating library.

- julcicc -
From gdamjan at mail.net.mk  Fri Dec  5 13:25:24 2003
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 22:04:26 2004
Subject: [mod_python] Mod_python disables mod_dav
In-Reply-To: <20031127054340.GA3835@legolas.on.net.mk>
References: <20031127054340.GA3835@legolas.on.net.mk>
Message-ID: <20031205122524.GA16632@legolas.on.net.mk>

> I'm using Apache 2.0.48 (it happened to 2.0.47 too) with the built-in
> mod_dav module and mod_python 3.1.2b/Python-2.3.2 and PHP/4.3.4.
> 
> I can't understand why but unless I disable mod_python (by commenting
> the LoadModule directive), DAV will not work. It just returns a "405
> Method is not allowed" error. 
> 
> I've tried different DAV setups and clients, and nothing - unless I
> disable mod_python it wont work...
> 
> Now I think that with older versions of mod_python this did not happen -
> but I'm not sure. I'll have to recheck that.
> 
> Does anyone know why this could happen?!?

Any ideas? Can at least, someone confirm my problem?
btw
I'm using "Slackware Linux 9.1"

-- 
Damjan Georgievski
jabberID: damjan@bagra.net.mk
From neel at mediapulse.com  Fri Dec  5 10:39:00 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:04:26 2004
Subject: [mod_python] Handlers "good practice" question
Message-ID: <C0FC22C08B82074A88B500617641577787A7DF@johnson.mediapulse.net>

> >Also, based on the other responses, I definitely going to 
> read the O'Reilly book about "Writing 
> > Apache Modules in C and Perl"
> 
> I don't see why you should write modules in C and Perl to 
> write a web application. ModPython offers
> much more flexibility and power and ModPython *IS* an Apache 
> C Module, your applications, IMHO should be written in a 
> higher level language, and only if you really need very high 
> performance, you could rewrite some of your application's 
> modules in C.
> 

I think you missed some of the thread. The point of recommending the
book is not to learn how write module in C or Perl, but to learn how
apache works.  AFAIK this is the only book out there that details the
Apache API, but even in it's dated state it's very useful.  Somethings
this book helped make clear for me was the difference between
authorization and authencation, how to have multiple handlers on the
same request in apache 1.3 (or why fixup handlers always return false),
and that all log handlers are called that are registered for a request.

Mike

From barry at python.org  Fri Dec  5 10:59:53 2003
From: barry at python.org (Barry Warsaw)
Date: Fri Jan  9 22:04:26 2004
Subject: [mod_python] mod_python ignoring --with-python?
Message-ID: <1070639992.1377.6.camel@anthem>

I have a very strange problem which I don't quite understand.  I'm on a
RH9 system, with an Apache 2.0.48 built in a non-standard location, and
a Python 2.3.2 built in a non-standard location.  So when I configure
mod_python 3.0.4, I use --with-apxs to point at my non-standard Apache's
bin/apxs, and --with-python to point at my non-standard python
executable.  make ; make install and everything appears to go in the
right places.

Now I start up Apache doing something like:

% cd non/standard/location
% sudo bin/httpd -DONE_PROCESS

However, it appears as if mod_python is still using the first Python on
my $PATH instead of the one I used to configure --with-python.  I can
tell this because 1) if mod_python isn't installed in my $PATH Python,
Apache will throw a server error saying it couldn't import
mod_python.apache; 2) if I strace httpd I can see it's trying to do tons
of imports from /usr/local (where my $PATH Python is installed).

So either I misunderstand how --with-python is supposed to work, or this
is a bug, or it's a missing feature. ;).  Shouldn't mod_python honor
--with-python and ignore $PATH python?

Thanks for any light you can shed.  Let me know if you need more
information.
-Barry


From jciccale at mac.com  Fri Dec  5 17:31:16 2003
From: jciccale at mac.com (Julian Ciccale)
Date: Fri Jan  9 22:04:26 2004
Subject: [mod_python] Handlers "good practice" question
Message-ID: <702685.1070641876421.JavaMail.jciccale@mac.com>

 I think you are right, it seems I missed something. However the httpd apache documentation, as well as the APR documentation for 2.0.x are very good starting points to get to know apache internals.
 
On Friday, December 05, 2003, at 04:39PM, Michael C. Neel <neel@mediapulse.com> wrote:

>> >Also, based on the other responses, I definitely going to 
>> read the O'Reilly book about "Writing 
>> > Apache Modules in C and Perl"
>> 
>> I don't see why you should write modules in C and Perl to 
>> write a web application. ModPython offers
>> much more flexibility and power and ModPython *IS* an Apache 
>> C Module, your applications, IMHO should be written in a 
>> higher level language, and only if you really need very high 
>> performance, you could rewrite some of your application's 
>> modules in C.
>> 
>
>I think you missed some of the thread. The point of recommending the
>book is not to learn how write module in C or Perl, but to learn how
>apache works.  AFAIK this is the only book out there that details the
>Apache API, but even in it's dated state it's very useful.  Somethings
>this book helped make clear for me was the difference between
>authorization and authencation, how to have multiple handlers on the
>same request in apache 1.3 (or why fixup handlers always return false),
>and that all log handlers are called that are registered for a request.
>
>Mike
>
>
From JTesser at nbbc.edu  Sun Dec  7 17:44:57 2003
From: JTesser at nbbc.edu (Jason Tesser)
Date: Fri Jan  9 22:04:26 2004
Subject: [mod_python] Python CMS with PgSQL
Message-ID: <04875CB4331F0240A0AD66F970978651160A5D@paul>

I am thinking about developing a CMS with Python and Postgres.  I am developing
on a Linux box with Apache 2.  I have used PHP in the past but my at work we are
considering going with Python as our main devellopment language.  A few
questions for you guys.

1. Is it best to just develop in all Pyhton or to use a mixture of PHP and Python? 
Why orther than personal feelings?

2. What is the best way to template using Python for me to seperate content 
from logic?  All the data that will be displayed in dynamic so I am not sure 
what the best way to template it would be in Python.

Thank you for any thoughts offered.

From damon at asianreflection.com  Mon Dec  8 22:45:45 2003
From: damon at asianreflection.com (Damon Lynch)
Date: Fri Jan  9 22:04:26 2004
Subject: [mod_python] Python CMS with PgSQL
In-Reply-To: <04875CB4331F0240A0AD66F970978651160A5D@paul>
References: <04875CB4331F0240A0AD66F970978651160A5D@paul>
Message-ID: <1070876744.24987.76.camel@damon.asianreflection.com>

On Mon, 2003-12-08 at 12:44, Jason Tesser wrote:

> 2. What is the best way to template using Python for me to seperate content 
> from logic?  All the data that will be displayed in dynamic so I am not sure 
> what the best way to template it would be in Python.

(I realize this is a mod_python list but...)

http://www.plone.org/documentation/zpt1 has some interesting ideas worth
a read.

HTH,
Damon

From petri.savolainen at iki.fi  Mon Dec  8 14:38:59 2003
From: petri.savolainen at iki.fi (Petri Savolainen)
Date: Fri Jan  9 22:04:26 2004
Subject: [mod_python] Re: Python CMS with PgSQL
In-Reply-To: <04875CB4331F0240A0AD66F970978651160A5D@paul>
References: <04875CB4331F0240A0AD66F970978651160A5D@paul>
Message-ID: <br1r9v$pct$1@sea.gmane.org>

Jason Tesser wrote:

> I am thinking about developing a CMS with Python and Postgres.  I am developing
> on a Linux box with Apache 2.  I have used PHP in the past but my at work we are
> considering going with Python as our main devellopment language.  A few
> questions for you guys.

Don't reinvent the wheel. Building your own CMS is not a good idea 
unless none of the existing "CMS type" web frameworks do what you need - 
which would be very surprising as there are dozens of them for both PHP 
and Python; do a bit of research and pick one that suits your needs 
best. For python, Zope is the largest and most difficult for someone 
coming from PHP world. There are also many alternatives to a full-blown 
CMS that you may find yourself more comfortable with, such as mod_python 
:-) Also be very careful when you see the word CMS used about a platform 
or product... it is used ultra-liberally in the industry.

> 1. Is it best to just develop in all Pyhton or to use a mixture of PHP and Python? 
> Why orther than personal feelings?

Don't mix languages unless you have to. Keep it simple if you can.

Much of the language issue is nonsense; more important is what is your 
company development model and style than the language that is used. For 
simple (in terms of code complexity and amount of lines) web apps and 
sites, whether you do apache + php + sql is not really that much 
different from apache + mod_python + sql. Both shine doing what they are 
supposed to.

However, if you are moving towards building large systems, or develop 
actual software products, you will find out there are things that are 
not well supported in php or that you simply cannot do.

> 2. What is the best way to template using Python for me to seperate content 
> from logic?  All the data that will be displayed in dynamic so I am not sure 
> what the best way to template it would be in Python.

I would recommend Page Templates; the technology originates from Zope, 
but there are standalone libraries you can use with mod_python, such as 
SimpleTAL/TALES and OpenTAL, and probably others. Note that there is 
also an implementation for PHP that you may find interesting.

I have not tried the templating system being developed for mod_python; 
if you're considering mod_python, you should also try its native 
templating system.

Hope that helps,

  Petri

From JTesser at nbbc.edu  Mon Dec  8 14:44:11 2003
From: JTesser at nbbc.edu (Jason Tesser)
Date: Fri Jan  9 22:04:26 2004
Subject: [mod_python] Re: Python CMS with PgSQL
Message-ID: <04875CB4331F0240A0AD66F970978651160A61@paul>

<snip>

> Don't reinvent the wheel. Building your own CMS is not a good idea 
> unless none of the existing "CMS type" web frameworks do what you need - 
> which would be very surprising as there are dozens of them for both PHP 
> and Python; do a bit of research and pick one that suits your needs 
> best. For python, Zope is the largest and most difficult for someone 
> coming from PHP world. There are also many alternatives to a full-blown 
> CMS that you may find yourself more comfortable with, such as mod_python 
> :-) Also be very careful when you see the word CMS used about a platform 
> or product... it is used ultra-liberally in the industry.

I have looked at all the ones I know of but they all lack some of the features or
control I need.  I need to have a lot of users changing and editing content 
(text only) and it all goes to an editor.  All layout, graphics and photos need 
to be filtered through a different person.  Some types of content ie news needs to 
be approved by a vice president.  Zope can be extended to do all this but with
what I would need to do to extend it I might as customize it and write it
myself.  I do have a little experience with Python as I have written a POS
system in it.  The CMS I need will eventually even handle online registration as
I work for a Bible College.  I don't see it as reinventing the wheel I just 
don't like being tied down to a framework.  That is why I don't like Websphere
or J2ee.  

<snip>

> I have not tried the templating system being developed for mod_python; 
> if you're considering mod_python, you should also try its native 
> templating system.

What is mod_python's templating system?  Is it PSP.  I am trying to get PSP working
now and I cannot seem to get it to work.  I am using mod_python 3.01 with apache 2
on a RH9 box.  When I goto the page I just get the psp code?  :-s  Any ideas?


_____________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python

From JTesser at nbbc.edu  Mon Dec  8 14:50:46 2003
From: JTesser at nbbc.edu (Jason Tesser)
Date: Fri Jan  9 22:04:26 2004
Subject: [mod_python] PSP how to????
Message-ID: <04875CB4331F0240A0AD66F970978651011376FA@paul>

OK can someone please explain to me how to get Apache 2 with mod_python 3.01 to recogize xxxx.psp pages?
I am just a poor programmer and my system admin skills need help :-) 

From conrad at hep.caltech.edu  Mon Dec  8 13:29:24 2003
From: conrad at hep.caltech.edu (Conrad Steenberg)
Date: Fri Jan  9 22:04:26 2004
Subject: [mod_python] PSP how to????
In-Reply-To: <04875CB4331F0240A0AD66F970978651011376FA@paul>
References: <04875CB4331F0240A0AD66F970978651011376FA@paul>
Message-ID: <1070918964.23133.5.camel@heppc22.hep.caltech.edu>

Hi Jason

You need a newer version: 3.1.x, with the newest being 3.1.2b on
www.modpython.org

Cheers

Conrad

On Mon, 2003-12-08 at 12:50, Jason Tesser wrote:
> OK can someone please explain to me how to get Apache 2 with mod_python 3.01 to recogize xxxx.psp pages?
> I am just a poor programmer and my system admin skills need help :-) 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
-- 
Conrad Steenberg <conrad@hep.caltech.edu>

From neel at mediapulse.com  Mon Dec  8 16:33:45 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:04:26 2004
Subject: [mod_python] Re: Python CMS with PgSQL
Message-ID: <C0FC22C08B82074A88B500617641577787A7E2@johnson.mediapulse.net>

> > Don't reinvent the wheel. Building your own CMS is not a good idea 
> > unless none of the existing "CMS type" web frameworks do 
> what you need - 
> 
> I have looked at all the ones I know of but they all lack 
> some of the features or
> control I need. 

I can understan this, there are a lot of CMS apps out there but none of
these wheels ever seem "round" when you need one =p.

Tools that I know of:

mod_python comes with psp (with 3.x); this is very new atm, so things
may change as it grows and might cause you some headache with backwards
compatibility.  The worst setup I could see is needing to patch
mod_pyhton for a fix, but not wanting the latest version of PSP that
comes with it.  This is also partly me; I usally don't look deeply into
something until it's stood at least a year - so I know it will be
around.

For mod_python you can also get Draco (http://draco.boskant.nl/) or
Spyce (http://spyce.sourceforge.net/).  Both of these are close to the
way PSP works; spyce more so that Draco.  Draco allows for code to be in
a separate file, which might lend itself to larger projects better.

There is also Albatross
(http://www.object-craft.com.au/projects/albatross/), which works for
mod_python, CGI, and in a standalone webserver.  Albatross extends along
the same lines as Draco, but instead of placing raw python in templates
it uses an XML-like tag language of al- and alx- tags.  Albatross can
also store it's session objects client side, server side, or on a
session server to support clusterd websites.

For down and dirty, quick and cheap, there is ezt
(http://svn.webdav.org/repos/projects/subwiki/trunk/lib/ezt.py), which
isn't a project to itself, but I've found useful when all I needed was
some %s magic with a bit more control (i.e. ifs and loops).

There are more I'm sure, but those are the ones stuck in my head.  I use
ezt and/or Albatross myself, each for about a year now.  I recommend
playing with each one, seeing which one works best in your enviroment,
then going with it.

Have fun,
Mike

From JTesser at nbbc.edu  Mon Dec  8 16:31:47 2003
From: JTesser at nbbc.edu (Jason Tesser)
Date: Fri Jan  9 22:04:26 2004
Subject: [mod_python] PSP how to????
Message-ID: <04875CB4331F0240A0AD66F970978651160A62@paul>

Is that release stable???


-----Original Message-----
From:	Conrad Steenberg [mailto:conrad@hep.caltech.edu]
Sent:	Mon 12/8/2003 3:29 PM
To:	Jason Tesser
Cc:	Mod_Python (E-mail)
Subject:	Re: [mod_python] PSP how to????
Hi Jason

You need a newer version: 3.1.x, with the newest being 3.1.2b on
www.modpython.org

Cheers

Conrad

On Mon, 2003-12-08 at 12:50, Jason Tesser wrote:
> OK can someone please explain to me how to get Apache 2 with mod_python 3.01 to recogize xxxx.psp pages?
> I am just a poor programmer and my system admin skills need help :-) 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
-- 
Conrad Steenberg <conrad@hep.caltech.edu>






From Brian.Parkinson at quest.com  Mon Dec  8 17:44:44 2003
From: Brian.Parkinson at quest.com (Brian Parkinson)
Date: Fri Jan  9 22:04:26 2004
Subject: [mod_python] Help getting mod_python set up on Windows/Apache
Message-ID: <46C5DCD410224A42BE3151AC8AE75E4E016E091B@tormbxw01.prod.quest.corp>

Hello:

I am trying to get mod_python working, and for the life of me I'm
stumped.

Version of Python: 2.2
Version of Apache: 2.0.48
Version of mod_python: 3.0.4

Here is the bit from my http.conf file in the Apache dist:

LoadModule python_module modules/mod_python.so

<Directory "C:/home/web/docs/"> 
  AddHandler python-program .py
  PythonHandler test 
  PythonDebug On 
</Directory>

I have a file called C:/home/web/docs/test.py and it contains:

from mod_python import apache

def handler(req):
    req.write("Hello World!")
    return apache.OK

When I re-start Apache, and then enter the URL to the test.py
file (http://localhost/test.py) the following is my log message:

[Mon Dec 08 14:40:03 2003] [notice] Parent: Created child process 2188
[Mon Dec 08 14:40:03 2003] [notice] Child 2188: Child process is running
[Mon Dec 08 14:40:03 2003] [notice] Child 2188: Acquired the start
mutex.
[Mon Dec 08 14:40:03 2003] [notice] Child 2188: Starting 250 worker
threads.
[Mon Dec 08 14:40:16 2003] [error] make_obcallback: could not import
mod_python.apache.


Agh!

Can anyone help me? This seems to close, but yet so far.

Thanks,

parki...



From grisha at modpython.org  Mon Dec  8 21:05:18 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:04:26 2004
Subject: [mod_python] Python CMS with PgSQL
In-Reply-To: <04875CB4331F0240A0AD66F970978651160A5D@paul>
References: <04875CB4331F0240A0AD66F970978651160A5D@paul>
Message-ID: <20031208210414.X60503@onyx.ispol.com>



On Sun, 7 Dec 2003, Jason Tesser wrote:

> 1. Is it best to just develop in all Pyhton or to use a mixture of PHP
> and Python?

This may sound too simple, but I recommend you stick to Python only, for
everything. :-)

Grisha
From scott_list at mischko.com  Mon Dec  8 22:06:53 2003
From: scott_list at mischko.com (Scott Chapman)
Date: Fri Jan  9 22:04:26 2004
Subject: [mod_python] PSP how to????
In-Reply-To: <04875CB4331F0240A0AD66F970978651160A62@paul>
References: <04875CB4331F0240A0AD66F970978651160A62@paul>
Message-ID: <200312082206.53039.scott_list@mischko.com>

On Monday 08 December 2003 14:31, Jason Tesser wrote:
> Is that release stable???

Yes.  It seems very good.  By the time you get to production, there will 
likely be a new version out anyway.  :-)

P.S. I prefer Draco. It's design strikes me as very elegant.  I've made 
mods such as making the templates so that they are able to be read from 
a hash variable rather than a file.  This provides a great deal of 
flexibility.  It's a very nice tool set.

Get Draco from CVS, not the production version, for use with 3.1.2b.

Scott

From davidf at sjsoft.com  Tue Dec  9 11:26:23 2003
From: davidf at sjsoft.com (David Fraser)
Date: Fri Jan  9 22:04:26 2004
Subject: [mod_python] Re: Python CMS with PgSQL
In-Reply-To: <04875CB4331F0240A0AD66F970978651160A61@paul>
References: <04875CB4331F0240A0AD66F970978651160A61@paul>
Message-ID: <3FD5953F.4050709@sjsoft.com>

Jason Tesser wrote:

><snip>
>
>  
>
>>Don't reinvent the wheel. Building your own CMS is not a good idea 
>>unless none of the existing "CMS type" web frameworks do what you need - 
>>which would be very surprising as there are dozens of them for both PHP 
>>and Python; do a bit of research and pick one that suits your needs 
>>best. For python, Zope is the largest and most difficult for someone 
>>coming from PHP world. There are also many alternatives to a full-blown 
>>CMS that you may find yourself more comfortable with, such as mod_python 
>>:-) Also be very careful when you see the word CMS used about a platform 
>>or product... it is used ultra-liberally in the industry.
>>    
>>
>
>I have looked at all the ones I know of but they all lack some of the features or
>control I need.  I need to have a lot of users changing and editing content 
>(text only) and it all goes to an editor.  All layout, graphics and photos need 
>to be filtered through a different person.  Some types of content ie news needs to 
>be approved by a vice president.  Zope can be extended to do all this but with
>what I would need to do to extend it I might as customize it and write it
>myself.  I do have a little experience with Python as I have written a POS
>system in it.  The CMS I need will eventually even handle online registration as
>I work for a Bible College.  I don't see it as reinventing the wheel I just 
>don't like being tied down to a framework.  That is why I don't like Websphere
>or J2ee.  
>
><snip>
>  
>
I would have a look at plone, it's a CMS built on top of Zope
www.plone.org

David

From JTesser at nbbc.edu  Tue Dec  9 10:46:10 2003
From: JTesser at nbbc.edu (Jason Tesser)
Date: Fri Jan  9 22:04:26 2004
Subject: [mod_python] PSP how to????
Message-ID: <04875CB4331F0240A0AD66F970978651011376FB@paul>

> You need a newer version: 3.1.x, with the newest being 3.1.2b on
> www.modpython.org

OK I got and and I am trying to compile it.  I am on a Suse9.0 box with Apache2
installed.  When I run ./configure --with-apxs=/usr/share/apache2 it tells
me I need to run apache2.  It doesn't tell me what I am running now but all
I have installed in apache2.  Any ideas?

From sergey at optimaltec.com  Tue Dec  9 12:04:11 2003
From: sergey at optimaltec.com (Sergey A. Lipnevich)
Date: Fri Jan  9 22:04:26 2004
Subject: [mod_python] Re: PSP how to????
In-Reply-To: <04875CB4331F0240A0AD66F970978651011376FB@paul>
References: <04875CB4331F0240A0AD66F970978651011376FB@paul>
Message-ID: <3FD6008B.4090005@optimaltec.com>

try --with-apxs=$(which apxs)

Jason Tesser wrote:
>>You need a newer version: 3.1.x, with the newest being 3.1.2b on
>>www.modpython.org
> 
> 
> OK I got and and I am trying to compile it.  I am on a Suse9.0 box with Apache2
> installed.  When I run ./configure --with-apxs=/usr/share/apache2 it tells
> me I need to run apache2.  It doesn't tell me what I am running now but all
> I have installed in apache2.  Any ideas?


From patm at visi.com  Tue Dec  9 11:21:29 2003
From: patm at visi.com (Patrick McNamee)
Date: Fri Jan  9 22:04:26 2004
Subject: [mod_python] PSP how to????
In-Reply-To: <04875CB4331F0240A0AD66F970978651011376FB@paul>
References: <04875CB4331F0240A0AD66F970978651011376FB@paul>
Message-ID: <20031209172129.GB27875@isis.visi.com>

On Tue, Dec 09, 2003 at 10:46:10AM -0600, Jason Tesser wrote:
> > You need a newer version: 3.1.x, with the newest being 3.1.2b on
> > www.modpython.org
> 
> OK I got and and I am trying to compile it.  I am on a Suse9.0 box with Apache2
> installed.  When I run ./configure --with-apxs=/usr/share/apache2 it tells
> me I need to run apache2.  It doesn't tell me what I am running now but all
> I have installed in apache2.  Any ideas?

I think you want something like: 
./configure --with-apxs=/usr/share/apache2/bin/apxs --with-python=/path/to/python2.2

See http://www.modpython.org/live/mod_python-3.1.2b/doc-html/installation.html
for more info.

pm
From menion at asylumwear.com  Tue Dec  9 11:49:56 2003
From: menion at asylumwear.com (Joshua Schmidlkofer)
Date: Fri Jan  9 22:04:26 2004
Subject: [mod_python] import site errors, and constant modules (Re)loading
Message-ID: <1070999395.32237.19.camel@bubbles.imr-net.com>

I have poked through the list archives, and I still am.  I have Redhat
with mod_python-3.0.1 - the rpm packaged release.  In any case, whenever
I call my script it is re-instantiating the objects..

my script is like:

<snip>
class foo:
    def __init__(self):
        self.dbconn = psycopg.connect(.....)
        pass
    def handler(self, req):
        ....
        return content

__classholder__ = foo()
handler = foo.handler
</snip>

Did I fail to grok the greater meaning?  Am I committing a rookie
error?   I have turned on debug mode, and everytime I call the script I
get : 

[Tue Dec 09 11:18:25 2003] [notice] mod_python: (Re)importing module
'update' with path set to '['/var/www/html/proxy']'
'import site' failed; use -v for traceback
(this repeats about 20 times)


Anyway, thanks,
  joshua (going back to google)

-- 
I refuse to believe that the really hot, Debian-using,
password-sniffing, root-exploiting geek girl is a myth. -- g1zmo

From michael at dynamine.net  Tue Dec  9 12:03:27 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 22:04:26 2004
Subject: [mod_python] import site errors, and constant modules (Re)loading
In-Reply-To: <1070999395.32237.19.camel@bubbles.imr-net.com>
References: <1070999395.32237.19.camel@bubbles.imr-net.com>
Message-ID: <3FD62A8F.20708@dynamine.net>

I believe that in debug mode, your handler is always re-imported.  (Not 
necessarily its dependencies, though; that code is up to you.)

--Michael

Joshua Schmidlkofer wrote:
> I have poked through the list archives, and I still am.  I have Redhat
> with mod_python-3.0.1 - the rpm packaged release.  In any case, whenever
> I call my script it is re-instantiating the objects..
> 
> my script is like:
> 
> <snip>
> class foo:
>     def __init__(self):
>         self.dbconn = psycopg.connect(.....)
>         pass
>     def handler(self, req):
>         ....
>         return content
> 
> __classholder__ = foo()
> handler = foo.handler
> </snip>
> 
> Did I fail to grok the greater meaning?  Am I committing a rookie
> error?   I have turned on debug mode, and everytime I call the script I
> get : 
> 
> [Tue Dec 09 11:18:25 2003] [notice] mod_python: (Re)importing module
> 'update' with path set to '['/var/www/html/proxy']'
> 'import site' failed; use -v for traceback
> (this repeats about 20 times)
> 
> 
> Anyway, thanks,
>   joshua (going back to google)
> 

From denneking at nngov.com  Tue Dec  9 15:39:54 2003
From: denneking at nngov.com (David Enneking)
Date: Fri Jan  9 22:04:26 2004
Subject: [mod_python] 
Message-ID: <5.1.1.6.0.20031209150205.02be1ca0@pop.visi.net>

Hi,

Where can I find an example of using the session object and persistent data 
within a PSP page.

Thanks,
David
-------------- next part --------------

---
Outgoing mail is certified Virus Free.
Checked by AVG anti-virus system (http://www.grisoft.com).
Version: 6.0.545 / Virus Database: 339 - Release Date: 11/27/2003
From menion at asylumwear.com  Tue Dec  9 13:08:55 2003
From: menion at asylumwear.com (Joshua Schmidlkofer)
Date: Fri Jan  9 22:04:27 2004
Subject: [mod_python] import site errors, and
	constant	modules	(Re)loading
In-Reply-To: <3FD638D2.3030302@dynamine.net>
References: <1070999395.32237.19.camel@bubbles.imr-net.com>
	 <3FD62A8F.20708@dynamine.net>
	 <1071001721.32237.31.camel@bubbles.imr-net.com>
	 <3FD632F2.80503@dynamine.net>
	 <1071003271.32237.54.camel@bubbles.imr-net.com>
	 <3FD638D2.3030302@dynamine.net>
Message-ID: <1071004134.32237.70.camel@bubbles.imr-net.com>

Micheal,

  Thanks for keep up with me..... I moved everything to a separate
module, and I imported the module, used the db connection, etc. 

   Is it possible that I am not returning properly?   When you are using
the publisher handler, all the documentation and examples I have seen
have a "return content" at the end.  So I am storing everything in a
string, and "return"ing at the end of my handler method.  

  I can't figure this out, nothing is getting garbage collected, and
that must mean it is still in scope in some context or other.  


  idea?

thanks,
  Joshua



On Tue, 2003-12-09 at 13:04, Michael S. Fischer wrote:
> In my own work, the connection-handling code is in a separate module. 
> Though, if you do it right, it should work identically in the mod_python 
> module, assuming mod_python is not reloading the module.
> 
> --Michael
> 
> Joshua Schmidlkofer wrote:
> 
> > On Tue, 2003-12-09 at 12:39, Michael S. Fischer wrote:
> > 
> >>Yeah, try something like this:
> >>
> >><module 'db'>
> >>
> >>_conn = None
> >>def getConnection():
> >>    global _conn
> >>    if not _conn:
> >>       _conn = ...  # Get connection
> >>    return _conn
> >>
> >>See if something like that works.
> >>
> >>Joshua Schmidlkofer wrote:
> > 
> > 
> > Yeah, I pretty much have this exact logic - save one thing - is this in
> > a separate module that get imported?  Was that what your first message
> > said?
> > 
> > thanks,
> >   Joshua
> > 
> > 
> > 
-- 
I refuse to believe that the really hot, Debian-using,
password-sniffing, root-exploiting geek girl is a myth. -- g1zmo

From menion at asylumwear.com  Tue Dec  9 13:32:15 2003
From: menion at asylumwear.com (Joshua Schmidlkofer)
Date: Fri Jan  9 22:04:27 2004
Subject: [mod_python] import site errors,
	and	constant	modules	(Re)loading
In-Reply-To: <3FD63BED.5030000@dynamine.net>
References: <1070999395.32237.19.camel@bubbles.imr-net.com>
	 <3FD62A8F.20708@dynamine.net>
	 <1071001721.32237.31.camel@bubbles.imr-net.com>
	 <3FD632F2.80503@dynamine.net>
	 <1071003271.32237.54.camel@bubbles.imr-net.com>
	 <3FD638D2.3030302@dynamine.net> <1  <3FD63BED.5030000@dynamine.net>
Message-ID: <1071005534.32237.92.camel@bubbles.imr-net.com>

On Tue, 2003-12-09 at 13:17, Michael S. Fischer wrote:
> Indeed, when using the publisher handler, you are supposed to return the 
> content.
> 
> I don't understand your code, though.  What is the idea behind its 
> arrangement?
> 
> Normally when I make mod_python.publisher scripts, I do something like:
> 
> <snip>
> _conn = None
> def _getConnection(...):
>     global _conn
>     if not _conn:
>        _conn = ...
>     return _conn
> 
> def index(req, params...):
>     ...
>     conn = _getConnection(...)
>     ...
>     return content
> </snip>
> 

Here is an example, that is producing the problem for me:


import psycopg, os, copy, types


_DSN     = 'dbname=mydb user=myuser host=dbserver'
_conn    = None

def getConnection():
    global _conn
    if not _conn: _conn = psycopg.connect(_DSN)
    return _conn.cursor()

def index(**kwargs):
    cursor = getConnection()

    cursor.execute("select * from bad")

    content = """
    <html><head><title>test</test></head>
    <body>

    Test:<br>%s
    
    </body></html>
    """

    tmp = ""
    for x in cursor.fetchall(): tmp += "%s<br>" % str(x)

    cursor.close()
    del cursor
    return content % tmp


From grisha at modpython.org  Wed Dec 10 00:54:05 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:04:27 2004
Subject: [mod_python] import site errors, and constant modules (Re)loading
In-Reply-To: <1070999395.32237.19.camel@bubbles.imr-net.com>
References: <1070999395.32237.19.camel@bubbles.imr-net.com>
Message-ID: <20031210004953.B77939@onyx.ispol.com>



On Tue, 9 Dec 2003, Joshua Schmidlkofer wrote:

> [Tue Dec 09 11:18:25 2003] [notice] mod_python: (Re)importing module
> 'update' with path set to '['/var/www/html/proxy']'
> 'import site' failed; use -v for traceback
> (this repeats about 20 times)

You should get as many of these messages as there are httpd processes
running. 20 seems a bit high to me, unless your httpd is configured to
have a minimum 20 servers running at any given time, but it is not
impossible (or unreasonable for a high volume server).

Do you get one of these for every request, or only for the first 20?

Grisha
From rey4 at columbia.edu  Wed Dec 10 02:28:35 2003
From: rey4 at columbia.edu (Russell Yanofsky)
Date: Fri Jan  9 22:04:27 2004
Subject: [mod_python] script_name bug again
Message-ID: <br6i02$5lh$1@sea.gmane.org>

Hi,

At the beginning of August I reported a bug affecting the value of the
script_name cgi variable and posted two patches to fix it in mod_python
2.7.8 and 3.0.3.

The fix appears to have been included in mod_python 3.0.4, but not in
mod_python 2.7.9. Is there a chance it can be included in the next release
of 2.7?

The patches are posted here:

http://www.modpython.org/pipermail/mod_python/attachments/20030811/8718dca2/mod_python-2.7.8.obj
http://www.modpython.org/pipermail/mod_python/attachments/20030811/8718dca2/mod_python-3.0.3.obj

The initial bug report is here:

http://www.modpython.org/pipermail/mod_python/2003-August/003495.html

And the fix for mod_python 3.0 was committed here:

http://cvs.apache.org/viewcvs.cgi/httpd-python/src/mod_python.c?r1=1.95&r2=1.96

- Russ


From catellani.m at maxmara.it  Wed Dec 10 09:17:12 2003
From: catellani.m at maxmara.it (Marco Catellani)
Date: Fri Jan  9 22:04:27 2004
Subject: [mod_python] Managing multiple users with mod-python
Message-ID: <3153892629catellani.m@maxmara.it>


Hi,
I'm experienced with Python and I'm learning to configure and use Mod Python (rel 3.03) and Apache (rel 2).
I'm setting up on my server a test environment, and I would like to manage multiple users, everyone of them using a different python interpreter.
Every programmer in my test environment should work with its own user and the python programs launched by him should run under his user and should not interfere with other user's processes.
Apache supports only one user for all child processes, so I'm not able to launch multiple interpreters with different users. Does Mod Python offers any feature to satisfy my need?

Thanks a lot

     Marco



From michael at dynamine.net  Wed Dec 10 09:46:36 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 22:04:27 2004
Subject: [mod_python] Managing multiple users with mod-python
In-Reply-To: <3153892629catellani.m@maxmara.it>
References: <3153892629catellani.m@maxmara.it>
Message-ID: <3FD75BFC.7030900@dynamine.net>

No.  If you want each user to have his own instance of Apache, have each 
one run his own copy, each of which is bound to a personal port.

--Michael

Marco Catellani wrote:

> Hi,
> I'm experienced with Python and I'm learning to configure and use Mod Python (rel 3.03) and Apache (rel 2).
> I'm setting up on my server a test environment, and I would like to manage multiple users, everyone of them using a different python interpreter.
> Every programmer in my test environment should work with its own user and the python programs launched by him should run under his user and should not interfere with other user's processes.
> Apache supports only one user for all child processes, so I'm not able to launch multiple interpreters with different users. Does Mod Python offers any feature to satisfy my need?
> 
> Thanks a lot
> 
>      Marco
> 
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 
From matt at pollenation.net  Wed Dec 10 18:31:16 2003
From: matt at pollenation.net (Matt Goodall)
Date: Fri Jan  9 22:04:27 2004
Subject: [mod_python] Managing multiple users with mod-python
In-Reply-To: <3FD75BFC.7030900@dynamine.net>
References: <3153892629catellani.m@maxmara.it> <3FD75BFC.7030900@dynamine.net>
Message-ID: <3FD76674.1040708@pollenation.net>


> Marco Catellani wrote:
>
>> Hi,
>> I'm experienced with Python and I'm learning to configure and use Mod 
>> Python (rel 3.03) and Apache (rel 2).
>> I'm setting up on my server a test environment, and I would like to 
>> manage multiple users, everyone of them using a different python 
>> interpreter.
>> Every programmer in my test environment should work with its own user 
>> and the python programs launched by him should run under his user and 
>> should not interfere with other user's processes.
>> Apache supports only one user for all child processes, so I'm not 
>> able to launch multiple interpreters with different users. Does Mod 
>> Python offers any feature to satisfy my need? 
>
Assuming you don't need the tight coupling Apache+mod_python provides ...

You may want to look at something like SCGI for development instead of 
mod_python. You would assign each user an SCGI port number (Bob uses 
3000, Dave uses 3001 etc) and then configure Apache so that each user 
has a virtual host or URL path on the web server which forwards requests 
to the user's SCGI process. Your users can then develop, start and stop 
the web app from somewhere within their home directory, without ever 
needing to touch Apache.

There are quite a few web frameworks which work behind either SCGI or 
mod_python so moving from SCGI during development to mod_python for 
production (if that's what you decide to do) should be relatively painless.

    SCGI - http://www.mems-exchange.org/software/scgi/

Another interesting solution to your problem, although nothing to do 
with Apache or mod_python, is Twisted's spreadable web servers. See 
http://www.twistedmatrix.com/documents/howto/using-twistedweb#auto19 for 
more. It's worth pointing out that the personal servers can be any 
Twisted-based web application and not just something that serves content 
from the file system.

Hope this helps.

Cheers, Matt

-- 
Matt Goodall, Pollenation Internet Ltd
w: http://www.pollenationinternet.com
e: matt@pollenation.net


From dpopowich at mtrsd.k12.ma.us  Thu Dec 11 11:10:07 2003
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Fri Jan  9 22:04:27 2004
Subject: [mod_python] mod_python 3.1.2b and directory indexes
Message-ID: <16344.38623.864766.807800@gargle.gargle.HOWL>


I upgraded to 3.1.2b recently and have noticed that when I reference
an URL that is a directory my request handler is never called, but
instead I get a directory index (assuming Option Indexes is specified,
if not I get a 403 error).  This didn't happen with 3.0.1 where
directory or file, my python request handler was called.

Anyone else notice this?

------------------
Daniel Popowich
Network Specialist
-------------------------------------
Mohawk Trail Regional School District
24 Ashfield Rd.
Shelburne Falls, MA 01370
413.625.0192 x22
-------------------------------------

From JTesser at nbbc.edu  Thu Dec 11 11:24:03 2003
From: JTesser at nbbc.edu (Jason Tesser)
Date: Fri Jan  9 22:04:27 2004
Subject: [mod_python] setup help
Message-ID: <04875CB4331F0240A0AD66F97097865101137707@paul>

I have the following script saved as test.py and saved under htdoc


From JTesser at nbbc.edu  Thu Dec 11 11:26:57 2003
From: JTesser at nbbc.edu (Jason Tesser)
Date: Fri Jan  9 22:04:27 2004
Subject: [mod_python] config help
Message-ID: <04875CB4331F0240A0AD66F97097865101137708@paul>

I have the folowing script saved as test.py under htdocs.

from mod_python import apache

def handler(req):
	req.write("Hello World!")
	return apache.OK

I cannot get it to execute properly with mod_python.  Here the configuration from my apache config file.

<Directory /srv/www/htdocs/>
  AddHandler python-program .py
  PythonHandler test
  #PythonHandler mod_python.publisher
  PythonDebug On
</Directory>
I tried uncommenting the publisher handler which doesn't work at all for me.  What am I missing :-s

From grisha at modpython.org  Thu Dec 11 12:36:16 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:04:27 2004
Subject: [mod_python] mod_python 3.1.2b and directory indexes
In-Reply-To: <16344.38623.864766.807800@gargle.gargle.HOWL>
References: <16344.38623.864766.807800@gargle.gargle.HOWL>
Message-ID: <20031211123551.N4056@onyx.ispol.com>


it's a bug. this has been fixed in the latest cvs.

On Thu, 11 Dec 2003, Daniel J. Popowich wrote:

>
> I upgraded to 3.1.2b recently and have noticed that when I reference
> an URL that is a directory my request handler is never called, but
> instead I get a directory index (assuming Option Indexes is specified,
> if not I get a 403 error).  This didn't happen with 3.0.1 where
> directory or file, my python request handler was called.
>
> Anyone else notice this?
>
> ------------------
> Daniel Popowich
> Network Specialist
> -------------------------------------
> Mohawk Trail Regional School District
> 24 Ashfield Rd.
> Shelburne Falls, MA 01370
> 413.625.0192 x22
> -------------------------------------
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From cs1spw at bath.ac.uk  Thu Dec 11 14:08:17 2003
From: cs1spw at bath.ac.uk (Simon Willison)
Date: Fri Jan  9 22:04:27 2004
Subject: [mod_python] mod_python 3.1.2b and directory indexes
In-Reply-To: <16344.38623.864766.807800@gargle.gargle.HOWL>
References: <16344.38623.864766.807800@gargle.gargle.HOWL>
Message-ID: <3FD8CEB1.3080000@bath.ac.uk>

Daniel J. Popowich wrote:

> I upgraded to 3.1.2b recently and have noticed that when I reference
> an URL that is a directory my request handler is never called, but
> instead I get a directory index (assuming Option Indexes is specified,
> if not I get a 403 error).  This didn't happen with 3.0.1 where
> directory or file, my python request handler was called.

I was hit by that one too. My solution was to ditch Directory directives 
entirely and switch to using Location instead, which appears to be a 
much more logical way of working with mod_python as handlers can live 
anywhere on the Python path, making Directory based handlers pretty much 
irrelevant.
From davidf at sjsoft.com  Fri Dec 12 17:20:17 2003
From: davidf at sjsoft.com (David Fraser)
Date: Fri Jan  9 22:04:27 2004
Subject: [mod_python] config help
In-Reply-To: <04875CB4331F0240A0AD66F97097865101137708@paul>
References: <04875CB4331F0240A0AD66F97097865101137708@paul>
Message-ID: <3FD9DCB1.3090004@sjsoft.com>

Jason Tesser wrote:

>I have the folowing script saved as test.py under htdocs.
>
>from mod_python import apache
>
>def handler(req):
>	req.write("Hello World!")
>	return apache.OK
>
>I cannot get it to execute properly with mod_python.  Here the configuration from my apache config file.
>  
>
When you say, you cannot get it to execute, you should describe exactly 
what you tried (the URL) and the response you got...

><Directory /srv/www/htdocs/>
>  AddHandler python-program .py
>  PythonHandler test
>  #PythonHandler mod_python.publisher
>  PythonDebug On
></Directory>
>I tried uncommenting the publisher handler which doesn't work at all for me.  What am I missing :-s
>  
>
Have you added the Python module (LoadModule etc) to the main apache 
configuration?

David
From jay at jaydorsey.com  Fri Dec 12 09:42:34 2003
From: jay at jaydorsey.com (Jay Dorsey)
Date: Fri Jan  9 22:04:27 2004
Subject: [mod_python] config help
In-Reply-To: <04875CB4331F0240A0AD66F97097865101137708@paul>
References: <04875CB4331F0240A0AD66F97097865101137708@paul>
Message-ID: <20031212154234.GA3929@gentoo.Earthlink.net>

On Thu, Dec 11, 2003 at 11:26:57AM -0600, Jason Tesser wrote:
> I have the folowing script saved as test.py under htdocs.
> 
> from mod_python import apache
> 
> def handler(req):
> 	req.write("Hello World!")
> 	return apache.OK
>

This looks fine

> I cannot get it to execute properly with mod_python.  Here the configuration from my apache config file.
> 
> <Directory /srv/www/htdocs/>
>   AddHandler python-program .py
>   PythonHandler test
>   #PythonHandler mod_python.publisher
>   PythonDebug On
> </Directory>

So does this, except for maybe that trailing slash on htdocs (I don't
have one in my setup, not sure if its required, disallowed, or 
allowed though).  Are you sure your restarted apache after you made the 
changes to your config file?  Have you checked the apache error logs
to see if you're getting any messages there?  Are you sure you're 
serving pages out of /srv/www/htdocs?  

-- 
Jay Dorsey
jay at jaydorsey dot com
From JTesser at nbbc.edu  Fri Dec 12 09:28:49 2003
From: JTesser at nbbc.edu (Jason Tesser)
Date: Fri Jan  9 22:04:27 2004
Subject: [mod_python] config help
Message-ID: <04875CB4331F0240A0AD66F9709786510113770D@paul>

HI,

>>I have the folowing script saved as test.py under htdocs.
>>
>>from mod_python import apache
>>
>>def handler(req):
>>	req.write("Hello World!")
>>	return apache.OK
>>
>>I cannot get it to execute properly with mod_python.  Here the configuration from my apache config file.
 
>
> When you say, you cannot get it to execute, you should describe exactly 
> what you tried (the URL) and the response you got...

It just prints the script on the page.

>> <Directory /srv/www/htdocs/>
>>  AddHandler python-program .py
>>  PythonHandler test
>>  #PythonHandler mod_python.publisher
>>  PythonDebug On
>> </Directory>
>> I tried uncommenting the publisher handler which doesn't work at all for me.  What am I missing :-s
>  
>
> Have you added the Python module (LoadModule etc) to the main apache 
> configuration?

Yes it is loaded.  

From dannoritzer at web.de  Fri Dec 12 19:09:36 2003
From: dannoritzer at web.de (=?ISO-8859-1?Q?G=FCnter_Dannoritzer?=)
Date: Fri Jan  9 22:04:27 2004
Subject: [mod_python] Problem with 'import' statement in 'execfile' script
Message-ID: <3FDA0460.1030406@web.de>

Hello,

I have a problem with a python script I try to execute from a publisher 
handler with the command 'execfile'.

The script starts with the following lines:

import sys
sys.path.append('/ab/system')
from Tools.Utilities import Utilities

So I have the module Utilities under /ab/system/Tools and extend my path 
first so that the following from/import statement will find it.

When I call the web page (my publisher handler with the 'execfile' 
command) I get the error message:

    ImportError: No module named Tools.Utilities

When I execute the same script with 'python <scriptname>' or 
'execfile(<scriptname>)' out of python, it is executed without errors. 
Even when I do it with the user apache is running as.

If I leave the 'sys.path.append' command out and execute the script by 
itself I get the error message as well. So the 'sys.path.append' must 
basically work, just not when using it with the publisher handler.

My configuration is:

Apache-AdvancedExtranetServer/2.0.47 (Mandrake Linux/6.1.92mdk) 
mod_python/3.1.0a Python/2.3

Can anybody tell me why I get the error with the publisher handler and 
not when I execute the script by itself?

Thanks for your help.

Guenter




From neel at mediapulse.com  Fri Dec 12 13:38:15 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:04:27 2004
Subject: [mod_python] Problem with 'import' statement in 'execfile' script
Message-ID: <C0FC22C08B82074A88B50061764157776B98B9@johnson.mediapulse.net>

> import sys
> sys.path.append('/ab/system')
> from Tools.Utilities import Utilities
> 

Have you tried using the PythonPath directive
(http://www.modpython.org/live/current/doc-html/dir-other-pp.html)?  I'm
not sure if setting the path inside the script is something you can do
(but again, I'm not sure).

Mike

From Vincent.Raaijmakers at ge.com  Fri Dec 12 12:42:47 2003
From: Vincent.Raaijmakers at ge.com (Raaijmakers, Vincent (IndSys, GE Interlogix))
Date: Fri Jan  9 22:04:27 2004
Subject: [mod_python] Problem with 'import' statement in 'execfile' script
Message-ID: <971323274247EB44B9A01D0A3B424C8504495618@FTWMLVEM02.e2k.ad.ge.com>

Is the package in your library/ site-packages ?
/usr/local/lib/python2.3/site-packages

and if so,

do you use perhaps soft links? ln -s /path_a/Tools /path_b/Tools
I had a lot of these issues using soft links.

Vincent

-----Original Message-----
From: mod_python-bounces@modpython.org
[mailto:mod_python-bounces@modpython.org]On Behalf Of G?nter Dannoritzer
Sent: Friday, December 12, 2003 1:10 PM
To: mod_python@modpython.org
Subject: [mod_python] Problem with 'import' statement in 'execfile'
script


Hello,

I have a problem with a python script I try to execute from a publisher 
handler with the command 'execfile'.

The script starts with the following lines:

import sys
sys.path.append('/ab/system')
from Tools.Utilities import Utilities

So I have the module Utilities under /ab/system/Tools and extend my path 
first so that the following from/import statement will find it.

When I call the web page (my publisher handler with the 'execfile' 
command) I get the error message:

    ImportError: No module named Tools.Utilities

When I execute the same script with 'python <scriptname>' or 
'execfile(<scriptname>)' out of python, it is executed without errors. 
Even when I do it with the user apache is running as.

If I leave the 'sys.path.append' command out and execute the script by 
itself I get the error message as well. So the 'sys.path.append' must 
basically work, just not when using it with the publisher handler.

My configuration is:

Apache-AdvancedExtranetServer/2.0.47 (Mandrake Linux/6.1.92mdk) 
mod_python/3.1.0a Python/2.3

Can anybody tell me why I get the error with the publisher handler and 
not when I execute the script by itself?

Thanks for your help.

Guenter




_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python

From kevin at sb.org  Fri Dec 12 15:07:24 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:04:27 2004
Subject: [mod_python] Trouble installing mod_python
Message-ID: <CD80C6EA-2CDE-11D8-BBFA-000A95A072FC@sb.org>

I'm running Mac OS X 10.3 with Apache 2 installed (via the Complete 
Apache 2 installer package) and I'm trying to install mod_python 
(latest from CVS). I ./configure and make and make install it fine, but 
when I add the LoadModule line to my httpd.conf file and do a Check 
Syntax I get the following error:

Syntax error on line 1099 of /Library/Apache2/conf/httpd.conf:
Cannot load /Library/Apache2/modules/mod_python.so into server: dyld: 
/Library/Apache2/bin/httpd Undefined symbols:
_PyExc_AttributeError
_PyExc_IOError
_PyExc_IndexError
_PyExc_KeyError
_PyExc_RuntimeError
_PyExc_StopIteration
_PyExc_TypeError
_PyExc_ValueError
_PyInt_Type
_PyList_Type
_PyObject_GenericGetAttr
_PyObject_GenericSetAttr
_PyString_Type
_PyType_Type
_Py_OptimizeFlag
__Py_NoneStruct
__Py_NotImplementedStruct

line 1099 is my LoadModule for mod_python. Why am I getting this error 
and how can I fix it?

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org


From michael at dynamine.net  Fri Dec 12 12:16:15 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 22:04:27 2004
Subject: [mod_python] Trouble installing mod_python
In-Reply-To: <CD80C6EA-2CDE-11D8-BBFA-000A95A072FC@sb.org>
References: <CD80C6EA-2CDE-11D8-BBFA-000A95A072FC@sb.org>
Message-ID: <3FDA220F.1050506@dynamine.net>

The default Makefile that configure creates is not quite right on OS X.

Assuming you've installed Fink and the python22 package (which is an 
implicit prerequisite for mod_python on OS X), you'll need to run 
configure like so:

env LDFLAGS="-L/sw/lib/python2.2/config -lpython2.2" ./configure

Also note that even though you've already told mod_python the path to 
python, you'll need to tell it again by prepending /sw/bin to the PATH 
before executing Apache 2.0.

--Michael

Kevin Ballard wrote:
> I'm running Mac OS X 10.3 with Apache 2 installed (via the Complete 
> Apache 2 installer package) and I'm trying to install mod_python (latest 
> from CVS). I ./configure and make and make install it fine, but when I 
> add the LoadModule line to my httpd.conf file and do a Check Syntax I 
> get the following error:
> 
> Syntax error on line 1099 of /Library/Apache2/conf/httpd.conf:
> Cannot load /Library/Apache2/modules/mod_python.so into server: dyld: 
> /Library/Apache2/bin/httpd Undefined symbols:
> _PyExc_AttributeError
> _PyExc_IOError
> _PyExc_IndexError
> _PyExc_KeyError
> _PyExc_RuntimeError
> _PyExc_StopIteration
> _PyExc_TypeError
> _PyExc_ValueError
> _PyInt_Type
> _PyList_Type
> _PyObject_GenericGetAttr
> _PyObject_GenericSetAttr
> _PyString_Type
> _PyType_Type
> _Py_OptimizeFlag
> __Py_NoneStruct
> __Py_NotImplementedStruct
> 
> line 1099 is my LoadModule for mod_python. Why am I getting this error 
> and how can I fix it?
> 
From kevin at sb.org  Fri Dec 12 15:21:11 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:04:27 2004
Subject: [mod_python] Trouble installing mod_python
In-Reply-To: <3FDA220F.1050506@dynamine.net>
References: <CD80C6EA-2CDE-11D8-BBFA-000A95A072FC@sb.org>
	<3FDA220F.1050506@dynamine.net>
Message-ID: <BA40ABC9-2CE0-11D8-BBFA-000A95A072FC@sb.org>

Why would I want to install python2.2 when OS X comes with Python 2.3?  
And why is this a prerequisite when the include files are in  
/System/Library/Frameworks/Python.framework/Versions/2.3/include/ 
python2.3/ and the makefile can find them?

On Dec 12, 2003, at 3:16 PM, Michael S. Fischer wrote:

> The default Makefile that configure creates is not quite right on OS X.
>
> Assuming you've installed Fink and the python22 package (which is an  
> implicit prerequisite for mod_python on OS X), you'll need to run  
> configure like so:
>
> env LDFLAGS="-L/sw/lib/python2.2/config -lpython2.2" ./configure
>
> Also note that even though you've already told mod_python the path to  
> python, you'll need to tell it again by prepending /sw/bin to the PATH  
> before executing Apache 2.0.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org


From michael at dynamine.net  Fri Dec 12 12:36:06 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 22:04:27 2004
Subject: [mod_python] Trouble installing mod_python
In-Reply-To: <BA40ABC9-2CE0-11D8-BBFA-000A95A072FC@sb.org>
References: <CD80C6EA-2CDE-11D8-BBFA-000A95A072FC@sb.org>
	<3FDA220F.1050506@dynamine.net> <BA40ABC9-2CE0-11D8-BBFA-000A95A072FC@sb.org>
Message-ID: <3FDA26B6.9010809@dynamine.net>

I'm just telling you what works for me.  (I'm running OS X Server 10.2, 
and so YMMV).

Do you know if OS X Server 10.3 ships with libpython2.3.a or 
libpython2.3.dylib?  If not, you'll still need Fink and the python2.2 
package.

I wouldn't fret it about too much unless there's some Python 2.3 feature 
that is absolutely required for your application.

--Michael

Kevin Ballard wrote:

> Why would I want to install python2.2 when OS X comes with Python 2.3?  
> And why is this a prerequisite when the include files are in  
> /System/Library/Frameworks/Python.framework/Versions/2.3/include/ 
> python2.3/ and the makefile can find them?
> 
> On Dec 12, 2003, at 3:16 PM, Michael S. Fischer wrote:
> 
>> The default Makefile that configure creates is not quite right on OS X.
>>
>> Assuming you've installed Fink and the python22 package (which is an  
>> implicit prerequisite for mod_python on OS X), you'll need to run  
>> configure like so:
>>
>> env LDFLAGS="-L/sw/lib/python2.2/config -lpython2.2" ./configure
>>
>> Also note that even though you've already told mod_python the path to  
>> python, you'll need to tell it again by prepending /sw/bin to the 
>> PATH  before executing Apache 2.0.
> 
> 
From alexiev at activesolutions.bg  Sat Dec 13 14:41:30 2003
From: alexiev at activesolutions.bg (Alexiev Nikolay)
Date: Fri Jan  9 22:04:27 2004
Subject: [mod_python] response content-type
Message-ID: <001401c3c176$6f0228a0$0a01010a@dev1>

How can I change content-type of respons, using publisher handler ?


---------------------------------------
Best regards,
Alexiev, Nikolay
e-mail: alexiev@activesolutions.bg
phone: +359 2 8753543
From dannoritzer at web.de  Sat Dec 13 13:41:29 2003
From: dannoritzer at web.de (=?ISO-8859-1?Q?G=FCnter_Dannoritzer?=)
Date: Fri Jan  9 22:04:27 2004
Subject: [mod_python] Problem with 'import' statement in 'execfile' script
In-Reply-To: <C0FC22C08B82074A88B50061764157776B98B9@johnson.mediapulse.net>
References: <C0FC22C08B82074A88B50061764157776B98B9@johnson.mediapulse.net>
Message-ID: <3FDB08F9.3050706@web.de>

Thanks for all the help I got on this problem.

Mike,

I was not able to test the 'PythonPath' directive yet, but I did add the 
sys.path.append to the publisher handler script and it worked.

It seems like I cannot modify the sys.path in a script I call with the 
execfile command when using mod_python.

Guenter


Michael C. Neel wrote:

>>import sys
>>sys.path.append('/ab/system')
>>from Tools.Utilities import Utilities
>>
>>    
>>
>
>Have you tried using the PythonPath directive
>(http://www.modpython.org/live/current/doc-html/dir-other-pp.html)?  I'm
>not sure if setting the path inside the script is something you can do
>(but again, I'm not sure).
>
>Mike
>
>  
>


From stian at soiland.no  Sat Dec 13 19:26:19 2003
From: stian at soiland.no (Stian =?iso-8859-1?Q?S=F8iland?=)
Date: Fri Jan  9 22:04:27 2004
Subject: [mod_python] Re: response content-type
In-Reply-To: <001401c3c176$6f0228a0$0a01010a@dev1>
References: <001401c3c176$6f0228a0$0a01010a@dev1>
Message-ID: <20031213182619.GA18517@itea.ntnu.no>

On 2003-12-13 13:41:30, Alexiev Nikolay wrote:

> How can I change content-type of respons, using publisher handler ?

Include req as first parameter, and set req.content_type.

def test(req):
    req.content_type = "image/jpeg"
    image = open("/somewhere/blapp.jpeg").read()
    return image

-- 
Stian S?iland               Work toward win-win situation. Win-lose
Trondheim, Norway           is where you win and the other lose.
http://www.soiland.no/      Lose-lose and lose-win are left as an
                            exercise to the reader.  [Limoncelli/Hogan]

From greenbeard400 at yahoo.com  Sat Dec 13 16:52:26 2003
From: greenbeard400 at yahoo.com (Greenbeard)
Date: Fri Jan  9 22:04:27 2004
Subject: [mod_python] Problem downloading the Full Archives
Message-ID: <20031214005226.99770.qmail@web21327.mail.yahoo.com>

When I went to this url:

http://mailman.modpython.org/pipermail/mod_python.mbox/mod_python.mbox

I only got about 1k of data - mail through Wed Jan 31,
2001.  Is there a different url/way to get the
archives?   I can not seem to locate  it. 

Thanks! 

gb400

__________________________________
Do you Yahoo!?
Free Pop-Up Blocker - Get it now
http://companion.yahoo.com/
From ron at UDel.Edu  Mon Dec 15 09:17:27 2003
From: ron at UDel.Edu (Ron Reisor)
Date: Fri Jan  9 22:04:27 2004
Subject: [mod_python] Trouble installing mod_python
In-Reply-To: <CD80C6EA-2CDE-11D8-BBFA-000A95A072FC@sb.org>
References: <CD80C6EA-2CDE-11D8-BBFA-000A95A072FC@sb.org>
Message-ID: <Pine.SOL.4.58L.0312150838270.10512@copland.udel.edu>

Kevin,

   The mod_python.so that is built doesn't depend on other needed shared
libraries.  This seems to be the result of how it is built by apxs.  I'm
not sure of the best way to get this problem resolved, but we have been
able to work around the problems. This is a little messy though:

   Build ssl and apache2.0.48 in /usr/local.  MacOSX 10.3 will use shared
libraries in /usr/local/lib without any changes.  The only thing I think
is special about the apache build is to specify --with-mpm=worker so you
get thread support

   Rebuild Python-2.3. I recommend 2.3.2 which includes some patches that
are important to us, but 2.3 works.  2.3.3c1 seems fine so far.  We
replaced the Apple supplied Python in preference for the latest version.
This replaces files in /Applications/MacPython-2.3 and
/Library/Frameworks/Python.framework and /usr/local/bin.  Build like:

./configure --enable-framework
make
make frameworkinstall

   To build mod_python, get the latest cvs.  It includes patches for
Python-2.3 memory/object allocation that will matter on MacOSX.  Build it
as usual to start:

./configure --with-apxs=/usr/local/bin/apxs
make
su
make install

   But, the apxs will use the gnu libtool and what you end up with is a
mod_python.so that doesn't have the right dependencies.  You can check
this with otool:

[roaming-163-213:~/macpython/httpd-python] ron% otool -L
src/.libs/mod_python.so
src/.libs/mod_python.so:
        /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current
version 71.0.0)
[roaming-163-213:~/macpython/httpd-python] ron%

   Key libraries, like Python, are missing.  So, here's the really messy
part.  Remove the mod_python.so link from src and run this command in the
src directory:

libtool -o mod_python.so -dynamic -flat_namespace -undefined suppress
hlistobject.o hlist.o filterobject.o connobject.o serverobject.o util.o
tableobject.o requestobject.o _apachemodule.o mod_python.o -framework
System -lcc_dynamic -arch_only ppc -framework Python -framework
CoreServices -framework Foundation -lm

   That should be all one shell command line.  One important difference
here is that the libtool you use is the Apple supplied libtool, not the
gnu libtool that apxs would normally use.  Also, there's switches in there
that I don't know how to get apxs to generate. If you check this with
otool you should see:

[roaming-163-213:~/macpython/httpd-python/src] ron% otool -L mod_python.so
mod_python.so:
        mod_python.so (compatibility version 0.0.0, current version 0.0.0)
        /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current
version 71.0.0)
        /Library/Frameworks/Python.framework/Versions/2.3/Python
(compatibility version 2.3.0, current version 2.3.0)

/System/Library/Frameworks/CoreServices.framework/Versions/A/CoreServices
(compatibility version 1.0.0, current version 16.0.0)

/System/Library/Frameworks/Foundation.framework/Versions/C/Foundation
(compatibility version 300.0.0, current version 500.5.0)
[roaming-163-213:~/macpython/httpd-python/src] ron%

   Then, copy the mod_python.so into the /usr/local/modules directory.

cheers,

Ron


On Fri, 12 Dec 2003, Kevin Ballard wrote:

> I'm running Mac OS X 10.3 with Apache 2 installed (via the Complete
> Apache 2 installer package) and I'm trying to install mod_python
> (latest from CVS). I ./configure and make and make install it fine, but
> when I add the LoadModule line to my httpd.conf file and do a Check
> Syntax I get the following error:
>
> Syntax error on line 1099 of /Library/Apache2/conf/httpd.conf:
> Cannot load /Library/Apache2/modules/mod_python.so into server: dyld:
> /Library/Apache2/bin/httpd Undefined symbols:
> _PyExc_AttributeError
> _PyExc_IOError
> _PyExc_IndexError
> _PyExc_KeyError
> _PyExc_RuntimeError
> _PyExc_StopIteration
> _PyExc_TypeError
> _PyExc_ValueError
> _PyInt_Type
> _PyList_Type
> _PyObject_GenericGetAttr
> _PyObject_GenericSetAttr
> _PyString_Type
> _PyType_Type
> _Py_OptimizeFlag
> __Py_NoneStruct
> __Py_NotImplementedStruct
>
> line 1099 is my LoadModule for mod_python. Why am I getting this error
> and how can I fix it?
>
> --
> Kevin Ballard
> kevin@sb.org
> http://www.tildesoft.com
> http://kevin.sb.org
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

Ron Reisor <ron@udel.edu> (RWR3)
University of Delaware Information Technologies/Network and Systems Services
Computing Center/192 South Chapel Street/Newark DE, 19716
pgp finger print: 0D 73 06 6F D3 6A 99 D3  F5 D5 6E FF 3B B9 7C 2C
From mark at gsoa.net  Mon Dec 15 13:33:23 2003
From: mark at gsoa.net (Mark McClain)
Date: Fri Jan  9 22:04:27 2004
Subject: [mod_python] re: trouble installing mod_python
Message-ID: <2A3E42DA-2F2D-11D8-A794-000A95B33D28@gsoa.net>

I've been able to build mod_python on 10.3 making very few changes.   
This process uses python 2.3 that comes with 10.3.  The problem that 
you are experiencing is because the linker does not get told to link to 
the python framework by apxs.

mark

1) Build and install apache2

2) Unpack the mod_python distribution

3) make the following changes to the configure script. here it is in 
modified form...

if test "$PyFRAMEWORKDIR" != "no-framework"; then
   if test -n "$PyFRAMEWORK"; then
     PyPYTHONLIBS="-framework $PyFRAMEWORK"

    # explicitly pass to mac linker so add this line
     LDFLAGS="${LDFLAGS} -Wl,-framework,Python"
   fi

4) run configure, make, then install

Good luck,

mark

From kevin at sb.org  Mon Dec 15 14:28:21 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:04:27 2004
Subject: [mod_python] re: trouble installing mod_python
In-Reply-To: <2A3E42DA-2F2D-11D8-A794-000A95B33D28@gsoa.net>
References: <2A3E42DA-2F2D-11D8-A794-000A95B33D28@gsoa.net>
Message-ID: <D7A8AD94-2F34-11D8-B6D0-000A95A072FC@sb.org>

Wow, that worked great! Thanks!

On Dec 15, 2003, at 1:33 PM, Mark McClain wrote:

> 1) Build and install apache2
>
> 2) Unpack the mod_python distribution
>
> 3) make the following changes to the configure script. here it is in 
> modified form...
>
> if test "$PyFRAMEWORKDIR" != "no-framework"; then
>   if test -n "$PyFRAMEWORK"; then
>     PyPYTHONLIBS="-framework $PyFRAMEWORK"
>
>    # explicitly pass to mac linker so add this line
>     LDFLAGS="${LDFLAGS} -Wl,-framework,Python"
>   fi
>
> 4) run configure, make, then install

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org


From kevin at sb.org  Mon Dec 15 14:57:12 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:04:27 2004
Subject: [mod_python] re: trouble installing mod_python
In-Reply-To: <2A3E42DA-2F2D-11D8-A794-000A95B33D28@gsoa.net>
References: <2A3E42DA-2F2D-11D8-A794-000A95B33D28@gsoa.net>
Message-ID: <DFBB3B11-2F38-11D8-B6D0-000A95A072FC@sb.org>

I tested my new mod_python and it's not working. The server log has 
nothing telling me why I'm getting an error, but if I try to run the 
mptest.py file myself from python, I get an error saying that in 
apache.py, on the import _apache line, there's no module named _apache.

What's going on and how do I fix this?

On Dec 15, 2003, at 1:33 PM, Mark McClain wrote:

> I've been able to build mod_python on 10.3 making very few changes.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org


From kevin at sb.org  Mon Dec 15 15:09:23 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:04:27 2004
Subject: [mod_python] re: trouble installing mod_python
In-Reply-To: <DFBB3B11-2F38-11D8-B6D0-000A95A072FC@sb.org>
References: <2A3E42DA-2F2D-11D8-A794-000A95B33D28@gsoa.net>
	<DFBB3B11-2F38-11D8-B6D0-000A95A072FC@sb.org>
Message-ID: <931CB23E-2F3A-11D8-B6D0-000A95A072FC@sb.org>

Argh, please ignore this. I realize now that _apache is provided by 
mod_python, and I also discovered the source of my form.py problem. I 
also discovered how mptest.py was failing, but I don't know why yet 
(but I will find out).

Anyway, sorry to bother you.

On Dec 15, 2003, at 2:57 PM, Kevin Ballard wrote:

> I tested my new mod_python and it's not working. The server log has 
> nothing telling me why I'm getting an error, but if I try to run the 
> mptest.py file myself from python, I get an error saying that in 
> apache.py, on the import _apache line, there's no module named 
> _apache.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org


From tim.stebbing at nunatak.com.au  Tue Dec 16 09:54:37 2003
From: tim.stebbing at nunatak.com.au (Timothy Stebbing)
Date: Fri Jan  9 22:04:27 2004
Subject: [mod_python] creating apache modules with mod_python
Message-ID: <3FDE3BAD.2050406@nunatak.com.au>

Is it possible to create apache modules using mod_python? I want to 
create a new protocol module for apache2.0, is there any info on doing 
this sort ofthing with mod_python, or has anyone done this sort of thing 
yet?

From kevin at sb.org  Mon Dec 15 19:29:08 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:04:27 2004
Subject: [mod_python] Strange server errors
Message-ID: <DC81D053-2F5E-11D8-B6D0-000A95A072FC@sb.org>

This is really strange. I tested my form.py thing from the Tutorial and 
it would just hang. I'd get absolutely no response from the server. I 
tried a few times, and then I started getting internal server errors 
instead, but with nothing in the error log. So I quit Apache and 
started httpd back up in single process mode (sudo ./httpd 
-DONE_PROCESS, as per the Troubleshooting section). At that point, my 
scripts magically started working (with no output to the shell from 
httpd). I then quit that and started Apache back up normally, and my 
scripts continue to work. Any idea what was going on, in case this 
weird stuff happens again?

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org


From tim.stebbing at nunatak.com.au  Tue Dec 16 12:30:34 2003
From: tim.stebbing at nunatak.com.au (Timothy Stebbing)
Date: Fri Jan  9 22:04:27 2004
Subject: [mod_python] PythonConnectionHandler directive
Message-ID: <3FDE603A.3010100@nunatak.com.au>

Howdy,

Im trying to get a simple protocol handler running, yet apache does not 
seem to be calling my code.

I have this in my apache config, this starts without any errors:

Listen 192.168.0.18:4444
<VirtualHost 192.168.0.18:4444>
        ServerAdmin webmaster@localhost
        DocumentRoot /var/www/nunatak/
        ErrorLog /tmp/test-error.log
        LogLevel debug
        PythonConnectionHandler protocol
</VirtualHost>

in /var/www/nunatak/protocol.py:

from mod_python import apache
 
def connectionhandler(conn):
    conn.write("Hello!")
    f = open("/tmp/foo.log", "w+")
    f.write("foo happened!\n")
    f.close()
    return apache.OK

when I telnet to localhost 4444 I get:

Trying 192.168.0.18...
Connected to balrog.localnet.
Escape character is '^]'.
Connection closed by foreign host.

I have no /tmp/foo.log at all, which makes me think the script has not 
been located/run

in my ErrorLog for the virtual host I have:
[Tue Dec 16 23:26:23 2003] [error] python_connection: 
ConnectionDispatch() returned nothing.


Im guessing its a problem with my virtualhost definition not being set 
up correctly, but in the docs
for mod_python there is not much more info on this subject.

-tjs


From kevin at sb.org  Mon Dec 15 21:05:45 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:04:27 2004
Subject: [mod_python] Strange server errors
In-Reply-To: <DC81D053-2F5E-11D8-B6D0-000A95A072FC@sb.org>
References: <DC81D053-2F5E-11D8-B6D0-000A95A072FC@sb.org>
Message-ID: <5C2E79EA-2F6C-11D8-B6D0-000A95A072FC@sb.org>

Argh. Sorry for bothering you with my problems. I just found the cause 
and it's not mod_python's fault. The problem is doing a graceful 
restart of apache isn't actually restarting properly, which is causing 
conflicts when accessing python scripts. If I stop the server, wait for 
it to finish shutting down, then start it back up, everything works 
just fine.

On Dec 15, 2003, at 7:29 PM, Kevin Ballard wrote:

> This is really strange. I tested my form.py thing from the Tutorial 
> and it would just hang. I'd get absolutely no response from the 
> server. I tried a few times, and then I started getting internal 
> server errors instead, but with nothing in the error log. So I quit 
> Apache and started httpd back up in single process mode (sudo ./httpd 
> -DONE_PROCESS, as per the Troubleshooting section). At that point, my 
> scripts magically started working (with no output to the shell from 
> httpd). I then quit that and started Apache back up normally, and my 
> scripts continue to work. Any idea what was going on, in case this 
> weird stuff happens again?

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org


From grisha at modpython.org  Mon Dec 15 22:37:51 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:04:28 2004
Subject: [mod_python] PythonConnectionHandler directive
In-Reply-To: <3FDE603A.3010100@nunatak.com.au>
References: <3FDE603A.3010100@nunatak.com.au>
Message-ID: <20031215223427.U71289@onyx.ispol.com>


I think the problem is the python path. Try making sure that the directory
where protocol.py is located is added to PythonPath:

PythonPath "sys.path+['/var/www/nunatak']"

Since this is a connection handler, the DocumentRoot is irrelevant and
the path in it has no effect.

Grisha

On Tue, 16 Dec 2003, Timothy Stebbing wrote:

> Howdy,
>
> Im trying to get a simple protocol handler running, yet apache does not
> seem to be calling my code.
>
> I have this in my apache config, this starts without any errors:
>
> Listen 192.168.0.18:4444
> <VirtualHost 192.168.0.18:4444>
>         ServerAdmin webmaster@localhost
>         DocumentRoot /var/www/nunatak/
>         ErrorLog /tmp/test-error.log
>         LogLevel debug
>         PythonConnectionHandler protocol
> </VirtualHost>
>
> in /var/www/nunatak/protocol.py:
>
> from mod_python import apache
>
> def connectionhandler(conn):
>     conn.write("Hello!")
>     f = open("/tmp/foo.log", "w+")
>     f.write("foo happened!\n")
>     f.close()
>     return apache.OK
>
> when I telnet to localhost 4444 I get:
>
> Trying 192.168.0.18...
> Connected to balrog.localnet.
> Escape character is '^]'.
> Connection closed by foreign host.
>
> I have no /tmp/foo.log at all, which makes me think the script has not
> been located/run
>
> in my ErrorLog for the virtual host I have:
> [Tue Dec 16 23:26:23 2003] [error] python_connection:
> ConnectionDispatch() returned nothing.
>
>
> Im guessing its a problem with my virtualhost definition not being set
> up correctly, but in the docs
> for mod_python there is not much more info on this subject.
>
> -tjs
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From ron at UDel.Edu  Tue Dec 16 08:35:33 2003
From: ron at UDel.Edu (Ron Reisor)
Date: Fri Jan  9 22:04:28 2004
Subject: [mod_python] re: trouble installing mod_python
In-Reply-To: <2A3E42DA-2F2D-11D8-A794-000A95B33D28@gsoa.net>
References: <2A3E42DA-2F2D-11D8-A794-000A95B33D28@gsoa.net>
Message-ID: <Pine.SOL.4.58L.0312160832400.12072@copland.udel.edu>

Mark,

   This patch works well for us too.

   Forget the hack I offered.

   Would you suggest this to python-dev@httpd.apache.org to see if it can
get added to the distribution?

thanks,

Ron


On Mon, 15 Dec 2003, Mark McClain wrote:

> I've been able to build mod_python on 10.3 making very few changes.
> This process uses python 2.3 that comes with 10.3.  The problem that
> you are experiencing is because the linker does not get told to link to
> the python framework by apxs.
>
> mark
>
> 1) Build and install apache2
>
> 2) Unpack the mod_python distribution
>
> 3) make the following changes to the configure script. here it is in
> modified form...
>
> if test "$PyFRAMEWORKDIR" != "no-framework"; then
>    if test -n "$PyFRAMEWORK"; then
>      PyPYTHONLIBS="-framework $PyFRAMEWORK"
>
>     # explicitly pass to mac linker so add this line
>      LDFLAGS="${LDFLAGS} -Wl,-framework,Python"
>    fi
>
> 4) run configure, make, then install
>
> Good luck,
>
> mark
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

Ron Reisor <ron@udel.edu> (RWR3)
University of Delaware Information Technologies/Network and Systems Services
Computing Center/192 South Chapel Street/Newark DE, 19716
pgp finger print: 0D 73 06 6F D3 6A 99 D3  F5 D5 6E FF 3B B9 7C 2C
From fccoelho at fiocruz.br  Wed Dec 17 15:07:53 2003
From: fccoelho at fiocruz.br (Flavio C. Coelho)
Date: Fri Jan  9 22:04:28 2004
Subject: [mod_python] mod_python and the semaphore bug
Message-ID: <1071680872.3902.13.camel@pinguim.procc.fiocruz.br>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: fiocruz4.jpg
Type: image/jpeg
Size: 3085 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20031217/2a49fe91/fiocruz4-0003.jpg
From giampiero.benvenuti at chiaroscuro.com  Wed Dec 17 18:31:39 2003
From: giampiero.benvenuti at chiaroscuro.com (Giampiero Benvenuti)
Date: Fri Jan  9 22:04:28 2004
Subject: [mod_python] mod_python & MySQLdb question
Message-ID: <DF4889B2-30B6-11D8-9E76-003065D5834A@chiaroscuro.com>

Hello to all of you,

I'm quite intrigued by mod_python and the difference with "normal" 
python cgi...

for instance: I can't make this great pice of code (Jaroslaw Zabiello, 
http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/171463) wich 
works great in my cgi-bin directory, working with mod_python.

The problem I have is right at the end, when I have to deal with:

  for row in rows:
     print row['name'], row['txt']

The question is: how can I translate this last part of code to make it 
working with mod_python?

the great code:
----------------------------------
import MySQLdb
import MySQLdb.cursors

conn = MySQLdb.Connect(
     host='localhost', user='root',
     passwd='', db='test',compress=1,
     cursorclass=MySQLdb.cursors.DictCursor) # <- important
cursor = conn.cursor()
cursor.execute("SELECT name, sometext txt FROM foo")
rows = cursor.fetchall()
cursor.close()
conn.close()

for row in rows:
     print row['name'], row['txt'] # bingo!
------------------------------------

any help is much appreciated.

Thanks,

Giampiero

From tpc at csua.berkeley.edu  Wed Dec 17 09:40:52 2003
From: tpc at csua.berkeley.edu (tpc@csua.berkeley.edu)
Date: Fri Jan  9 22:04:28 2004
Subject: [mod_python] mod_python & MySQLdb question
In-Reply-To: <DF4889B2-30B6-11D8-9E76-003065D5834A@chiaroscuro.com>
Message-ID: <20031217093408.M44175-100000@localhost.name>


hi Giampiero, instead of print or echo, you use return or req.write.  I
had a similar question here:

http://www.modpython.org/pipermail/mod_python/2003-June/003263.html

I hope that helps you.

On Wed, 17 Dec 2003, Giampiero Benvenuti wrote:

> Hello to all of you,
>
> I'm quite intrigued by mod_python and the difference with "normal"
> python cgi...
>
> for instance: I can't make this great pice of code (Jaroslaw Zabiello,
> http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/171463) wich
> works great in my cgi-bin directory, working with mod_python.
>
> The problem I have is right at the end, when I have to deal with:
>
>   for row in rows:
>      print row['name'], row['txt']
>
> The question is: how can I translate this last part of code to make it
> working with mod_python?
>
> the great code:
> ----------------------------------
> import MySQLdb
> import MySQLdb.cursors
>
> conn = MySQLdb.Connect(
>      host='localhost', user='root',
>      passwd='', db='test',compress=1,
>      cursorclass=MySQLdb.cursors.DictCursor) # <- important
> cursor = conn.cursor()
> cursor.execute("SELECT name, sometext txt FROM foo")
> rows = cursor.fetchall()
> cursor.close()
> conn.close()
>
> for row in rows:
>      print row['name'], row['txt'] # bingo!
> ------------------------------------
>
> any help is much appreciated.
>
> Thanks,
>
> Giampiero
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>


From jciccale at mac.com  Wed Dec 17 23:37:11 2003
From: jciccale at mac.com (Julian Ciccale)
Date: Fri Jan  9 22:04:28 2004
Subject: [mod_python] mod_python and the semaphore bug
Message-ID: <8794402.1071700631675.JavaMail.jciccale@mac.com>

Try checking out the latest CVS sources of line 3.1.x . I think this problem is solved in
the CVS.

- julcicc - 
On Wednesday, December 17, 2003, at 06:07PM, Flavio C. Coelho <fccoelho@fiocruz.br> wrote:

>
><<Original Attached>>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20031217/439af9da/attachment-0003.htm
From tim.stebbing at nunatak.com.au  Thu Dec 18 10:14:40 2003
From: tim.stebbing at nunatak.com.au (Timothy Stebbing)
Date: Fri Jan  9 22:04:28 2004
Subject: [mod_python] Persistant data
Message-ID: <3FE0E360.4060002@nunatak.com.au>

Is there some way to persist data resource using apache? Im writing a 
simple protocol module
using PythonConnectionHandler, this takes queries and runs them against 
various backends,
ie postgres, Lupy (indexer), etc. I want to persist my connections to 
these resources across all
requests.

Ive tried adding a db 'pool' into a module, but the module is reloaded 
for each request serviced.

Im wondering if there is some way I can add objects into these 'apache 
tables' ? would that make
them persistant, and if so how do I do that? I was also wondering if I 
could somehow access the
main namespace from child interpreters?

cheers

tjs

From michael at dynamine.net  Wed Dec 17 15:21:29 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 22:04:28 2004
Subject: [mod_python] Persistant data
In-Reply-To: <3FE0E360.4060002@nunatak.com.au>
References: <3FE0E360.4060002@nunatak.com.au>
Message-ID: <3FE0E4F9.8010302@dynamine.net>

In the interest of keeping it simple, I suggest you store your 
persistent data using anydbm and use synchronization techniques (i.e. 
rename) to ensure that two processes don't try to write to the database 
simultaneously (mid-air collision).  Other techniques just give you more 
code complexity and not much added benefit.

This is pretty much exactly what the new session code in 3.1.2b does.

--Michael

Timothy Stebbing wrote:

> Is there some way to persist data resource using apache? Im writing a 
> simple protocol module
> using PythonConnectionHandler, this takes queries and runs them against 
> various backends,
> ie postgres, Lupy (indexer), etc. I want to persist my connections to 
> these resources across all
> requests.
> 
> Ive tried adding a db 'pool' into a module, but the module is reloaded 
> for each request serviced.
> 
> Im wondering if there is some way I can add objects into these 'apache 
> tables' ? would that make
> them persistant, and if so how do I do that? I was also wondering if I 
> could somehow access the
> main namespace from child interpreters?
> 
> cheers
> 
> tjs
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 
From kevin at sb.org  Wed Dec 17 19:00:47 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:04:28 2004
Subject: [mod_python] config tree for htaccess
Message-ID: <3B9F1328-30ED-11D8-B6D0-000A95A072FC@sb.org>

Is there any way to get the config tree from any relevant .htaccess 
files as well as just the httpd.conf file, or do I have to look for and 
parse them manually? Also, is there any way to get the applicable 
config lines from the httpd.conf file, i.e. the ones inside 
<Directory>/<Files>/etc. blocks that apply to the current URI without 
having to parse them all manually?

I'm writing a script that mimics FancyIndexing and it's mostly done 
(i.e. it does just about everything except let you sort by headers, 
including scanning the AddIcon/AddIconByType/AddDescription lines in 
apache.config_tree(), and looks identical to the FancyIndexing in the 
rendered version (i.e. the source is cleaner, but the result is 
identical)), but it only uses the config directives in the root of 
httpd.conf (i.e. the root of apache.config_tree()) and I'd like to make 
it use all applicable directives.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org


From giampiero.benvenuti at chiaroscuro.com  Thu Dec 18 01:54:59 2003
From: giampiero.benvenuti at chiaroscuro.com (Giampiero Benvenuti)
Date: Fri Jan  9 22:04:28 2004
Subject: [mod_python] mod_python & MySQLdb question
In-Reply-To: <20031217093408.M44175-100000@localhost.name>
Message-ID: <CE1FDA4E-30F4-11D8-9E76-003065D5834A@chiaroscuro.com>

Thanks for your prompt answer and your help.

I'm coming from Zope, just got to mod_python a week ago. Please 
understand my being na?ve.

I'm not quite there yet: thanks to your help now I'm able to get all my 
titles form mysql, but at the
end of the page (sigh) I get an apache error: "500 Internal Server 
Error"
"The server encountered an internal error or misconfiguration and was 
unable to complete your request..."

Apache is not OK at all.

here is my code:

import MySQLdb, MySQLdb.cursors
from mod_python import apache

def read(req):
	req.content_type = "text/html"
	mydb = MySQLdb.connect(db='S_N', user='giampiero', compress=1, 
cursorclass=MySQLdb.cursors.DictCursor)
	cursor = mydb.cursor()
	stmt = "SELECT news_title FROM news"
	cursor.execute(stmt)
	rows = cursor.fetchall()
	mydb.close()
	for row in rows:
		s = row['news_title']
		print s
	return apache.OK

Thank you guys,

Giampiero





On Mercoled?, dic 17, 2003, at 18:40 Europe/Rome, 
<tpc@csua.berkeley.edu> wrote:

>
> hi Giampiero, instead of print or echo, you use return or req.write.  I
> had a similar question here:
>
> http://www.modpython.org/pipermail/mod_python/2003-June/003263.html
>
> I hope that helps you.
>
> On Wed, 17 Dec 2003, Giampiero Benvenuti wrote:
>
>> Hello to all of you,
>>
>> I'm quite intrigued by mod_python and the difference with "normal"
>> python cgi...
>>
>> for instance: I can't make this great pice of code (Jaroslaw Zabiello,
>> http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/171463) wich
>> works great in my cgi-bin directory, working with mod_python.
>>
>> The problem I have is right at the end, when I have to deal with:
>>
>>   for row in rows:
>>      print row['name'], row['txt']
>>
>> The question is: how can I translate this last part of code to make it
>> working with mod_python?
>>
>> the great code:
>> ----------------------------------
>> import MySQLdb
>> import MySQLdb.cursors
>>
>> conn = MySQLdb.Connect(
>>      host='localhost', user='root',
>>      passwd='', db='test',compress=1,
>>      cursorclass=MySQLdb.cursors.DictCursor) # <- important
>> cursor = conn.cursor()
>> cursor.execute("SELECT name, sometext txt FROM foo")
>> rows = cursor.fetchall()
>> cursor.close()
>> conn.close()
>>
>> for row in rows:
>>      print row['name'], row['txt'] # bingo!
>> ------------------------------------
>>
>> any help is much appreciated.
>>
>> Thanks,
>>
>> Giampiero
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>
>
>
>


From michael at dynamine.net  Wed Dec 17 16:57:47 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 22:04:28 2004
Subject: [mod_python] mod_python & MySQLdb question
In-Reply-To: <CE1FDA4E-30F4-11D8-9E76-003065D5834A@chiaroscuro.com>
References: <CE1FDA4E-30F4-11D8-9E76-003065D5834A@chiaroscuro.com>
Message-ID: <3FE0FB8B.3050200@dynamine.net>

What does the Apache error log have to say about it?

--Michael

Giampiero Benvenuti wrote:

> Thanks for your prompt answer and your help.
> 
> I'm coming from Zope, just got to mod_python a week ago. Please 
> understand my being na?ve.
> 
> I'm not quite there yet: thanks to your help now I'm able to get all my 
> titles form mysql, but at the
> end of the page (sigh) I get an apache error: "500 Internal Server Error"
> "The server encountered an internal error or misconfiguration and was 
> unable to complete your request..."
> 
> Apache is not OK at all.
> 
> here is my code:
> 
> import MySQLdb, MySQLdb.cursors
> from mod_python import apache
> 
> def read(req):
>     req.content_type = "text/html"
>     mydb = MySQLdb.connect(db='S_N', user='giampiero', compress=1, 
> cursorclass=MySQLdb.cursors.DictCursor)
>     cursor = mydb.cursor()
>     stmt = "SELECT news_title FROM news"
>     cursor.execute(stmt)
>     rows = cursor.fetchall()
>     mydb.close()
>     for row in rows:
>         s = row['news_title']
>         print s
>     return apache.OK
> 
> Thank you guys,
> 
> Giampiero
> 
> 
> 
> 
> 
> On Mercoled?, dic 17, 2003, at 18:40 Europe/Rome, 
> <tpc@csua.berkeley.edu> wrote:
> 
>>
>> hi Giampiero, instead of print or echo, you use return or req.write.  I
>> had a similar question here:
>>
>> http://www.modpython.org/pipermail/mod_python/2003-June/003263.html
>>
>> I hope that helps you.
>>
>> On Wed, 17 Dec 2003, Giampiero Benvenuti wrote:
>>
>>> Hello to all of you,
>>>
>>> I'm quite intrigued by mod_python and the difference with "normal"
>>> python cgi...
>>>
>>> for instance: I can't make this great pice of code (Jaroslaw Zabiello,
>>> http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/171463) wich
>>> works great in my cgi-bin directory, working with mod_python.
>>>
>>> The problem I have is right at the end, when I have to deal with:
>>>
>>>   for row in rows:
>>>      print row['name'], row['txt']
>>>
>>> The question is: how can I translate this last part of code to make it
>>> working with mod_python?
>>>
>>> the great code:
>>> ----------------------------------
>>> import MySQLdb
>>> import MySQLdb.cursors
>>>
>>> conn = MySQLdb.Connect(
>>>      host='localhost', user='root',
>>>      passwd='', db='test',compress=1,
>>>      cursorclass=MySQLdb.cursors.DictCursor) # <- important
>>> cursor = conn.cursor()
>>> cursor.execute("SELECT name, sometext txt FROM foo")
>>> rows = cursor.fetchall()
>>> cursor.close()
>>> conn.close()
>>>
>>> for row in rows:
>>>      print row['name'], row['txt'] # bingo!
>>> ------------------------------------
>>>
>>> any help is much appreciated.
>>>
>>> Thanks,
>>>
>>> Giampiero
>>>
>>> _______________________________________________
>>> Mod_python mailing list
>>> Mod_python@modpython.org
>>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>>
>>
>>
>>
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 
From rey4 at columbia.edu  Wed Dec 17 20:16:40 2003
From: rey4 at columbia.edu (Russell Yanofsky)
Date: Fri Jan  9 22:04:28 2004
Subject: [mod_python] Re: Persistant data
References: <3FE0E360.4060002@nunatak.com.au>
Message-ID: <brqv6q$3h7$1@sea.gmane.org>

Timothy Stebbing wrote:
> Is there some way to persist data resource using apache? Im writing a
> simple protocol module
> using PythonConnectionHandler, this takes queries and runs them
> against various backends,
> ie postgres, Lupy (indexer), etc. I want to persist my connections to
> these resources across all
> requests.
>
> Ive tried adding a db 'pool' into a module, but the module is reloaded
> for each request serviced.

Is the module containing the db pool the same one that you specified in
PythonConnectionHandler? If so, you should try storing the pool in a
different module and accessing it with an import statement.

> Im wondering if there is some way I can add objects into these 'apache
> tables' ? would that make
> them persistant, and if so how do I do that? I was also wondering if I
> could somehow access the
> main namespace from child interpreters?

I doubt Mod_Python is using a different interpreter for each request. It's
probably just reloading the one module.

- Russ


From rey4 at columbia.edu  Wed Dec 17 20:23:07 2003
From: rey4 at columbia.edu (Russell Yanofsky)
Date: Fri Jan  9 22:04:28 2004
Subject: [mod_python] Re: Persistant data
References: <3FE0E360.4060002@nunatak.com.au> <3FE0E4F9.8010302@dynamine.net>
Message-ID: <brqvih$42s$1@sea.gmane.org>

Michael S. Fischer wrote:
> In the interest of keeping it simple, I suggest you store your
> persistent data using anydbm and use synchronization techniques 

Heh. You want him to store his database connections in a database?

- Russ

From michael at dynamine.net  Wed Dec 17 17:29:08 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 22:04:28 2004
Subject: [mod_python] Re: Persistant data
In-Reply-To: <brqvih$42s$1@sea.gmane.org>
References: <3FE0E360.4060002@nunatak.com.au> <3FE0E4F9.8010302@dynamine.net>
	<brqvih$42s$1@sea.gmane.org>
Message-ID: <3FE102E4.9020506@dynamine.net>

> Michael S. Fischer wrote:
> 
>>In the interest of keeping it simple, I suggest you store your
>>persistent data using anydbm and use synchronization techniques 
> 
> 
> Heh. You want him to store his database connections in a database?

Oh, I must have misread his message.  Silly me.  *blush*

His question seems to be a FAQ.  Isn't it covered in there?

--Michael
From grisha at modpython.org  Wed Dec 17 21:59:16 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:04:28 2004
Subject: [mod_python] config tree for htaccess
In-Reply-To: <3B9F1328-30ED-11D8-B6D0-000A95A072FC@sb.org>
References: <3B9F1328-30ED-11D8-B6D0-000A95A072FC@sb.org>
Message-ID: <20031217215114.Q1381@onyx.ispol.com>


The config_tree only gives you what is in the main config file, that is
correct.

I am not sure that it is technically possible to get what's in .htaccess
other than reading it. As the .htaccess file is parsed, individual
directives result in calls into modules, which then do things accordingly,
but I don't think httpd tries to store this information anywhere
separately.

Grisha

On Wed, 17 Dec 2003, Kevin Ballard wrote:

> Is there any way to get the config tree from any relevant .htaccess
> files as well as just the httpd.conf file, or do I have to look for and
> parse them manually? Also, is there any way to get the applicable
> config lines from the httpd.conf file, i.e. the ones inside
> <Directory>/<Files>/etc. blocks that apply to the current URI without
> having to parse them all manually?
>
> I'm writing a script that mimics FancyIndexing and it's mostly done
> (i.e. it does just about everything except let you sort by headers,
> including scanning the AddIcon/AddIconByType/AddDescription lines in
> apache.config_tree(), and looks identical to the FancyIndexing in the
> rendered version (i.e. the source is cleaner, but the result is
> identical)), but it only uses the config directives in the root of
> httpd.conf (i.e. the root of apache.config_tree()) and I'd like to make
> it use all applicable directives.
>
> --
> Kevin Ballard
> kevin@sb.org
> http://www.tildesoft.com
> http://kevin.sb.org
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From davidf at sjsoft.com  Thu Dec 18 08:24:56 2003
From: davidf at sjsoft.com (David Fraser)
Date: Fri Jan  9 22:04:28 2004
Subject: [mod_python] Re: Persistant data
In-Reply-To: <brqv6q$3h7$1@sea.gmane.org>
References: <3FE0E360.4060002@nunatak.com.au> <brqv6q$3h7$1@sea.gmane.org>
Message-ID: <3FE14838.1080707@sjsoft.com>

Russell Yanofsky wrote:

>Timothy Stebbing wrote:
>  
>
>>Is there some way to persist data resource using apache? Im writing a
>>simple protocol module
>>using PythonConnectionHandler, this takes queries and runs them
>>against various backends,
>>ie postgres, Lupy (indexer), etc. I want to persist my connections to
>>these resources across all
>>requests.
>>
>>Ive tried adding a db 'pool' into a module, but the module is reloaded
>>for each request serviced.
>>    
>>
>
>Is the module containing the db pool the same one that you specified in
>PythonConnectionHandler? If so, you should try storing the pool in a
>different module and accessing it with an import statement.
>
>  
>
>>Im wondering if there is some way I can add objects into these 'apache
>>tables' ? would that make
>>them persistant, and if so how do I do that? I was also wondering if I
>>could somehow access the
>>main namespace from child interpreters?
>>    
>>
>
>I doubt Mod_Python is using a different interpreter for each request. It's
>probably just reloading the one module.
>  
>
It's quite possible that mod_python is using different interpreters for 
different requests if Apache is loaded with multiple processes. Each 
process will then have its own interpreter. So if you have 20 
interpreters, the likelihood that the first 4 requests each use a unique 
interpreter is 72.67%
This can make it look like each request uses its own interpreter, 
whereas actually there are a pool of interpreters being shared

David


From giampiero.benvenuti at chiaroscuro.com  Thu Dec 18 11:13:10 2003
From: giampiero.benvenuti at chiaroscuro.com (Giampiero Benvenuti)
Date: Fri Jan  9 22:04:28 2004
Subject: [mod_python] mod_python & MySQLdb question: Done
In-Reply-To: <CE1FDA4E-30F4-11D8-9E76-003065D5834A@chiaroscuro.com>
Message-ID: <C88B4324-3142-11D8-913D-003065D5834A@chiaroscuro.com>

Ok, thanks to your help an thanks to the mailing list archives I did 
find the solution (it's working for me, I'm not sure
it's the "right" one):

here is the code:

------------------------------------------------------------------
import MySQLdb, MySQLdb.cursors, mod_python

def readtitle(req):
	req.content_type = "text/html"
	req.send_http_header()
	mydb = MySQLdb.connect(db='S_N', user='giampiero', compress=1, 
cursorclass=MySQLdb.cursors.DictCursor)
	cursor = mydb.cursor()
	stmt = "SELECT news_title FROM news"
	cursor.execute(stmt)
	rows = cursor.fetchall()
	rows = list(rows)
	for row in rows:
		results = (row['news_title']+',<br>')
		req.write(results)
	
	raise mod_python.apache.SERVER_RETURN, mod_python.apache.OK
----------------------------------------------------------------

Thanks to all of you: great mailing list with nice people. I never gona 
go back umiliated to Zope now:)

Giampiero

On Gioved?, dic 18, 2003, at 01:54 Europe/Rome, Giampiero Benvenuti 
wrote:

> Thanks for your prompt answer and your help.
>
> I'm coming from Zope, just got to mod_python a week ago. Please 
> understand my being na?ve.
>
> I'm not quite there yet: thanks to your help now I'm able to get all 
> my titles form mysql, but at the
> end of the page (sigh) I get an apache error: "500 Internal Server 
> Error"
> "The server encountered an internal error or misconfiguration and was 
> unable to complete your request..."
>
> Apache is not OK at all.
>
> here is my code:
>
> import MySQLdb, MySQLdb.cursors
> from mod_python import apache
>
> def read(req):
> 	req.content_type = "text/html"
> 	mydb = MySQLdb.connect(db='S_N', user='giampiero', compress=1, 
> cursorclass=MySQLdb.cursors.DictCursor)
> 	cursor = mydb.cursor()
> 	stmt = "SELECT news_title FROM news"
> 	cursor.execute(stmt)
> 	rows = cursor.fetchall()
> 	mydb.close()
> 	for row in rows:
> 		s = row['news_title']
> 		print s
> 	return apache.OK
>
> Thank you guys,
>
> Giampiero
>
>
>
>
>
> On Mercoled?, dic 17, 2003, at 18:40 Europe/Rome, 
> <tpc@csua.berkeley.edu> wrote:
>
>>
>> hi Giampiero, instead of print or echo, you use return or req.write.  
>> I
>> had a similar question here:
>>
>> http://www.modpython.org/pipermail/mod_python/2003-June/003263.html
>>
>> I hope that helps you.
>>
>> On Wed, 17 Dec 2003, Giampiero Benvenuti wrote:
>>
>>> Hello to all of you,
>>>
>>> I'm quite intrigued by mod_python and the difference with "normal"
>>> python cgi...
>>>
>>> for instance: I can't make this great pice of code (Jaroslaw 
>>> Zabiello,
>>> http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/171463) wich
>>> works great in my cgi-bin directory, working with mod_python.
>>>
>>> The problem I have is right at the end, when I have to deal with:
>>>
>>>   for row in rows:
>>>      print row['name'], row['txt']
>>>
>>> The question is: how can I translate this last part of code to make 
>>> it
>>> working with mod_python?
>>>
>>> the great code:
>>> ----------------------------------
>>> import MySQLdb
>>> import MySQLdb.cursors
>>>
>>> conn = MySQLdb.Connect(
>>>      host='localhost', user='root',
>>>      passwd='', db='test',compress=1,
>>>      cursorclass=MySQLdb.cursors.DictCursor) # <- important
>>> cursor = conn.cursor()
>>> cursor.execute("SELECT name, sometext txt FROM foo")
>>> rows = cursor.fetchall()
>>> cursor.close()
>>> conn.close()
>>>
>>> for row in rows:
>>>      print row['name'], row['txt'] # bingo!
>>> ------------------------------------
>>>
>>> any help is much appreciated.
>>>
>>> Thanks,
>>>
>>> Giampiero
>>>
>>> _______________________________________________
>>> Mod_python mailing list
>>> Mod_python@modpython.org
>>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>>
>>
>>
>>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>


From manfred.stienstra at dwerg.net  Thu Dec 18 11:29:39 2003
From: manfred.stienstra at dwerg.net (Manfred Stienstra)
Date: Fri Jan  9 22:04:28 2004
Subject: [mod_python] mod_python & MySQLdb question: Done
In-Reply-To: <C88B4324-3142-11D8-913D-003065D5834A@chiaroscuro.com>
References: <C88B4324-3142-11D8-913D-003065D5834A@chiaroscuro.com>
Message-ID: <1071743378.12631.7.camel@ack.dwerg.net>

On Thu, 2003-12-18 at 11:13, Giampiero Benvenuti wrote:
> import MySQLdb, MySQLdb.cursors, mod_python
> 
> def readtitle(req):
> 	req.content_type = "text/html"
> 	req.send_http_header()
> 	mydb = MySQLdb.connect(db='S_N', user='giampiero', compress=1, 
> cursorclass=MySQLdb.cursors.DictCursor)
> 	cursor = mydb.cursor()
> 	stmt = "SELECT news_title FROM news"
> 	cursor.execute(stmt)
> 	rows = cursor.fetchall()
> 	rows = list(rows)
> 	for row in rows:
> 		results = (row['news_title']+',<br>')
> 		req.write(results)
> 	
> 	raise mod_python.apache.SERVER_RETURN, mod_python.apache.OK


This:

> 	rows = cursor.fetchall()
> 	rows = list(rows)
> 	for row in rows:
> 		results = (row['news_title']+',<br>')
> 		req.write(results)

can be compressed to (and made faster):


results = []
for row in cursor.fetchall():
	results.append(row['news_title'])
req.write("<br />".join(results))


Also using the DictCursor gives a little overhead in this case. This is
ofcourse not a real problem on small queries like this one.

Manfred

From giampiero.benvenuti at chiaroscuro.com  Thu Dec 18 14:56:44 2003
From: giampiero.benvenuti at chiaroscuro.com (Giampiero Benvenuti)
Date: Fri Jan  9 22:04:28 2004
Subject: [mod_python] mod_python & MySQLdb question: Done
In-Reply-To: <1071743378.12631.7.camel@ack.dwerg.net>
Message-ID: <03B2DC68-3162-11D8-913D-003065D5834A@chiaroscuro.com>

Thanks Manfred, now I'm starting to "see".
Great tip, it works like a "swiss" clock.

> This:
>
>> 	rows = cursor.fetchall()
>> 	rows = list(rows)
>> 	for row in rows:
>> 		results = (row['news_title']+',<br>')
>> 		req.write(results)
>
> can be compressed to (and made faster):
>
>
> results = []
> for row in cursor.fetchall():
> 	results.append(row['news_title'])
> req.write("<br />".join(results))
>

From tpc at csua.berkeley.edu  Thu Dec 18 08:45:41 2003
From: tpc at csua.berkeley.edu (tpc@csua.berkeley.edu)
Date: Fri Jan  9 22:04:28 2004
Subject: [mod_python] mod_python & MySQLdb question: Done
In-Reply-To: <03B2DC68-3162-11D8-913D-003065D5834A@chiaroscuro.com>
Message-ID: <20031218084200.O51827-100000@localhost.name>


hi Giampiero, can I ask you, being a newbie to Python
myself, why you are switching to modpython from Zope ?
I have heard many good things about Zope but have not
had the time to download and use it, but from what I hear
if you want to serve a complex database-backed application
there is no better way.

On Thu, 18 Dec 2003, Giampiero Benvenuti wrote:

> Thanks Manfred, now I'm starting to "see".
> Great tip, it works like a "swiss" clock.
>
> > This:
> >
> >> 	rows = cursor.fetchall()
> >> 	rows = list(rows)
> >> 	for row in rows:
> >> 		results = (row['news_title']+',<br>')
> >> 		req.write(results)
> >
> > can be compressed to (and made faster):
> >
> >
> > results = []
> > for row in cursor.fetchall():
> > 	results.append(row['news_title'])
> > req.write("<br />".join(results))
> >
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From giampiero.benvenuti at chiaroscuro.com  Fri Dec 19 11:05:55 2003
From: giampiero.benvenuti at chiaroscuro.com (Giampiero Benvenuti)
Date: Fri Jan  9 22:04:28 2004
Subject: Zope vs. mod_python!? It was "Re: [mod_python] mod_python & MySQLdb
	question: Done"
In-Reply-To: <20031218084200.O51827-100000@localhost.name>
Message-ID: <EF2C53EE-320A-11D8-913D-003065D5834A@chiaroscuro.com>


On Gioved?, dic 18, 2003, at 17:45 Europe/Rome, <tpc@csua.berkeley.edu> 
wrote:

>
> hi Giampiero, can I ask you, being a newbie to Python
> myself, why you are switching to modpython from Zope ?
> I have heard many good things about Zope but have not
> had the time to download and use it, but from what I hear
> if you want to serve a complex database-backed application
> there is no better way.

I'm not sure I can give a detailed and precise answer to your question.
Please keep in mind that I don't have any formal education in 
programming
but in photography and arts.

As far as I can see, Zope is a great tool, well designed and with great
performance. I started using it 2 years ago and it took me quite some 
time
to figure it out. I developed a few sites using it: www.cercacultura.it 
is
one of them. cercacultura.it is totally Zope based and uses the internal
ZODB database.

What triggered my curiosity in python/mod_python is the fact that Zope 
is
built "over" python and actualy the right way to use it is to keep the
business logic in python and the presentation in dtml, the Zope markup
language.
Now I am starting to experience Zope as a kind of "filter" that doesn't 
let
me really understand what is going on underneath. A sort of second 
language
that prevents you from speaking your first language. For this reason I 
am
starting to feel the limits of Zope.

What I can say now is that learning python created a new challenge and a
way to find faster and more transparent solutions. I also read that with
mod_python you can actually use some Zope modules (Zpublisher for 
example).
I very much like the mod_python integration in apache, which allows to
bypass the zope server.

There is much more to say about it, and I'm sure other people on the 
list
can be more articulate on this issue.

Thanks,

Giampiero


From fowlertrainer at anonym.hu  Fri Dec 19 12:24:08 2003
From: fowlertrainer at anonym.hu (fowlertrainer@anonym.hu)
Date: Fri Jan  9 22:04:28 2004
Subject: [mod_python] Newbie questions 1
Message-ID: <15814100725.20031219122408@anonym.hu>

Hello !

I've been used php, and zope before, but I want to try the mod_python,
becuase the py lang is seems to be better than these web-dev
langs/tools.

Some structural/tehnological questions:

1.
  I want to know, how many times used the mp_req objects ?
  Is eliminate mod_python this elements, if some of these objects don't
  needed longer ?
  I try to understand, how to be working.
  I see, that I can define global variables in main module, and the
  globals are globals in every mp_req.
  But if the system eliminate all of this objects, can holding these
  global vars ?

  Why are write this question ?

  I want to create a file or memory storaged session system.
  If the memory is cleared by every N time, it have been failed...
  So it is needed to be I have fix elements.

2.
  Is the mod_py regenerate the existing objects, and clear memory if I change the
  source code, and I have two threads/two existing objects in alive ?
  

-- 
Best regards,
 fowlertrainer                          mailto:fowlertrainer@anonym.hu

From fowlertrainer at anonym.hu  Fri Dec 19 12:31:04 2003
From: fowlertrainer at anonym.hu (fowlertrainer@anonym.hu)
Date: Fri Jan  9 22:04:28 2004
Subject: [mod_python] Newbie questions 2
Message-ID: <8314517404.20031219123104@anonym.hu>

Hello !

Part 2:

  3.
      How to I prevent some effects ?
      I want to be create an one-main-file-handled site.

      a.) So I want to remove the .py from main.py file in the
          browser, if possible.
      b.) I want to eliminate or redirect the main.pyc file, what is
          created by python in everytime.
          This file is downloadable from browser, and if any users
          have some python experience, or an decompiler, that these
          persons can get informations from my site !
      c.) I want to the main.py is let my 'index.html', so if I don't
          write any tags, that it have been processed.
          http://site/main.py
          ->
          http://site/main
          ->
          http://site/

          These elements let do same thing !!!

Thanx:
 KK

  

-- 
Best regards,
 fowlertrainer                          mailto:fowlertrainer@anonym.hu

From mod_python at ols.inorganic.org  Fri Dec 19 06:33:34 2003
From: mod_python at ols.inorganic.org (Roy S. Rapoport)
Date: Fri Jan  9 22:04:28 2004
Subject: [mod_python] mod_python & MySQLdb question: Done
In-Reply-To: <20031218084200.O51827-100000@localhost.name>
References: <03B2DC68-3162-11D8-913D-003065D5834A@chiaroscuro.com>
	<20031218084200.O51827-100000@localhost.name>
Message-ID: <20031219143334.GA10524@nag.inorganic.org>

On Thu, Dec 18, 2003 at 08:45:41AM -0800, tpc@csua.berkeley.edu wrote:
> hi Giampiero, can I ask you, being a newbie to Python
> myself, why you are switching to modpython from Zope ?
> I have heard many good things about Zope but have not
> had the time to download and use it, but from what I hear
> if you want to serve a complex database-backed application
> there is no better way.

I'm obviously not Giampiero, but I'll take a stab at answering the question
(disregarding Giampiero's specific circumstances).

I work for a privately-held financial institution in the IT group; I happen
to wear two hats, actually -- I'm a member of both the development and the
infrastructure groups.  Our choice of languages is Python, our choice of
platform on which to develop applications is the web, and our choice of web
platform on which to develop is Zope.  We are heavily invested in Zope and
we love it.  

I especially love Zope because it pretty much enforces an MVC architecture
-- ZSQL methods to access databases, python scripts for business logic,
DTML/ZPT for display logic.  

There's the upside.

The downside? The security (or lackthereof) aspects of running it sometimes
wake me up at night screaming.  OK, that's overstating it, but not by much
:)

The problem with Zope is one of its nicest features -- in-band management.
Got a Zope server at http://my.server ?  Then you can manage it at
http://my.server/manage.  Want to manage http://my.server/some/path? Again,
you can go into the management interfact of Zope on that path at
http://my.server/some/path/manage.  All management of Zope is down through
URL strings ON THE SAME IP AND PORT AS THE CONTENT YOU'RE SERVING.  

Now, again, in some respects this is really nice -- it took us about two
hours to get up a Python program that allowed us to easily synchronize
content between two or more Zope servers by just sending URLs around.  On
the downside, this means that pretty much anyone in the world is guaranteed
to be able to access the management interface of your Zope server and then
it's just a password-guessing attack.  You can front Zope with Apache --
and you're advised to -- and we're continuing to fine-tune our httpd.conf
to block URLs that look like they're management URLs -- but it's a pain,
and error-prone, and not likely to ever be complete.  The official word on
the Zope list is "Yes, it's insecure.  Deal with it and accept it."

In-band management is really user-friendly.  I think it's also a very bad
idea.  I hope they go away from that one of these days.

Oh, one more thing:  Emblematic of many (but not all) open-source projects,
Zope is a wonderful, relatively-well-constructed product with absolutely
atrocious, horrific, monstrously-bad documentation.  It's incomplete (and
in some cases wrong).  Mind you, I'm not sure mod_python is much better,
but I'm not talking about it right now :)

Hope this is useful,
-roy (ex-CSUA and OCF member)

> 
> On Thu, 18 Dec 2003, Giampiero Benvenuti wrote:
> 
> > Thanks Manfred, now I'm starting to "see".
> > Great tip, it works like a "swiss" clock.
> >
> > > This:
> > >
> > >> 	rows = cursor.fetchall()
> > >> 	rows = list(rows)
> > >> 	for row in rows:
> > >> 		results = (row['news_title']+',<br>')
> > >> 		req.write(results)
> > >
> > > can be compressed to (and made faster):
> > >
> > >
> > > results = []
> > > for row in cursor.fetchall():
> > > 	results.append(row['news_title'])
> > > req.write("<br />".join(results))
> > >
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
From gdamjan at mail.net.mk  Fri Dec 19 17:48:27 2003
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 22:04:28 2004
Subject: Zope vs. mod_python!? It was "Re: [mod_python] mod_python &
	MySQLdb question: Done"
In-Reply-To: <EF2C53EE-320A-11D8-913D-003065D5834A@chiaroscuro.com>
References: <20031218084200.O51827-100000@localhost.name>
	<EF2C53EE-320A-11D8-913D-003065D5834A@chiaroscuro.com>
Message-ID: <20031219164827.GB2368@legolas.on.net.mk>

> What I can say now is that learning python created a new challenge and a
> way to find faster and more transparent solutions. I also read that with
> mod_python you can actually use some Zope modules (Zpublisher for 
> example).

It would be great when mod_python could rould replace all the Zope
functionality, and I guess most of it can be done. Parts of Zope that
should be implemented in mod_python are:

- The Zpublisher ... well we already have the publisher in mod_python

- ZODB - I think the standalone ZODB can be easily used in mod_python,
  there might be some threading issues ... maybe.

- ZPT/DTML these also should useable in mod_python as they are ... and
  then there's also mod_python's native PSP.

- ACL's - ACL's are stored in the ZODB in Zope, and are checked by the
  Zpublisher ... we dont have this in mod_python

- WebDav - you can access your Zope objects through WebDav, ACL's
  checked again ... (also mod_python 3.1.2b conflicts somehow with
  apaches mod_dav)

- Zope's *acquisition* inheritance - this is one of the key features in
  Zope. The publisher should support this.

So it seems that an overhauled publisher for mod_python could provide
most, if not all the Zope functionality. 

Also it would be interesting to see if other storage than ZODB could be
implemented with the same features... Linux FS with ACLs and Extended
Attributes for ex. :)


just my $0.02





-- 
Damjan Georgievski
jabberID: damjan@bagra.net.mk
From redconectabilbao at telefonica.net  Fri Dec 19 17:51:45 2003
From: redconectabilbao at telefonica.net (Red Conecta)
Date: Fri Jan  9 22:04:28 2004
Subject: [mod_python] newbie
Message-ID: <3FE32CA1.7070105@telefonica.net>

Hello!

I want to try mod_python, but something doesn't work fine

I'm using Apache 2.0.47 (Mandrake Linux/1.6.91mdk) mod_python/3.0.1 
Python/2.2.2 in a Mandrake9.1 and my  http2.conf is:

...
LoadModule python_module                 extramodules/mod_python.so
...
<Directory /var/www/html>
  AddHandler python-program .py
  PythonHandler mptest
  PythonDebug On
</Directory>

and, of course there's a mptest.py in /var/www/html

But pointing to my mptest.py, my mozilla opens the dialog for 
downloading the file.

What's wrong?

Thanks
**

From kevin at sb.org  Fri Dec 19 15:21:31 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:04:28 2004
Subject: [mod_python] newbie
In-Reply-To: <3FE32CA1.7070105@telefonica.net>
References: <3FE32CA1.7070105@telefonica.net>
Message-ID: <EF2F6572-3260-11D8-B7F9-000A95A072FC@sb.org>

What's your mptest.py look like?

Most likely, it's something like

from apache import *

def handler(req):
	req.write("Hello world!")
	return apache.OK

Is that right? If so, add this line before the req.write line:

	req.content_type = "text/plain"

On Dec 19, 2003, at 11:51 AM, Red Conecta wrote:

> I want to try mod_python, but something doesn't work fine
>
> I'm using Apache 2.0.47 (Mandrake Linux/1.6.91mdk) mod_python/3.0.1 
> Python/2.2.2 in a Mandrake9.1 and my  http2.conf is:
>
> ...
> LoadModule python_module                 extramodules/mod_python.so
> ...
> <Directory /var/www/html>
>  AddHandler python-program .py
>  PythonHandler mptest
>  PythonDebug On
> </Directory>
>
> and, of course there's a mptest.py in /var/www/html
>
> But pointing to my mptest.py, my mozilla opens the dialog for 
> downloading the file.
>
> What's wrong?

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From kevin at sb.org  Fri Dec 19 15:21:37 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:04:29 2004
Subject: [mod_python] Newbie questions 2
In-Reply-To: <8314517404.20031219123104@anonym.hu>
References: <8314517404.20031219123104@anonym.hu>
Message-ID: <F2AAD67B-3260-11D8-B7F9-000A95A072FC@sb.org>

On Dec 19, 2003, at 6:31 AM, fowlertrainer@anonym.hu wrote:

>       a.) So I want to remove the .py from main.py file in the
>           browser, if possible.

Define main.py as the handler for main.

>       b.) I want to eliminate or redirect the main.pyc file, what is
>           created by python in everytime.
>           This file is downloadable from browser, and if any users
>           have some python experience, or an decompiler, that these
>           persons can get informations from my site !

Put this in your httpd.conf

<Files ~ "\.pyc$">
     Order allow,deny
     Deny from all
</Files>

That blocks access to files ending in .pyc

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From nelson at crynwr.com  Fri Dec 19 15:51:16 2003
From: nelson at crynwr.com (Russell Nelson)
Date: Fri Jan  9 22:04:29 2004
Subject: [mod_python] newbie
In-Reply-To: <EF2F6572-3260-11D8-B7F9-000A95A072FC@sb.org>
References: <3FE32CA1.7070105@telefonica.net>
	<EF2F6572-3260-11D8-B7F9-000A95A072FC@sb.org>
Message-ID: <16355.25796.858212.742243@desk.crynwr.com>

Kevin Ballard writes:
 > What's your mptest.py look like?
 > 
 > Most likely, it's something like
 > 
 > from apache import *

Just as a matter of style, I think Guido (BDFL) discourages this sort
of thing.  For myself, even though it means more typing in the first
place, I prefer to see a plain import, and lots of foo., bar., and
baz. prefixes.  Lets the newbie (which I've been so very recently)
know which module the function is associated with.

-- 
--My blog is at angry-economist.russnelson.com  | 
Crynwr sells support for free software  | PGPok |  You can't spell Fiasco
521 Pleasant Valley Rd. | +1 315 268 1925 voice |  without SCO
Potsdam, NY 13676-3213  | +1 315 268 9201 FAX   | 
From dpopowich at mtrsd.k12.ma.us  Fri Dec 19 16:31:45 2003
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Fri Jan  9 22:04:29 2004
Subject: [mod_python] Sessions and problems with cookie path attribute
Message-ID: <16355.28225.866414.517954@gargle.gargle.HOWL>


I had a serious problem getting sessions to work with an app I'm
writing (modpython 3.1.2b, httpd-2.0.40, python 2.3.2) and after
browsing the archives I've seen others getting bitten by the same
problem...

Session ids are stored on the client as a cookie with name pysid.
This is fine and the cookie gets stored, but the path attribute can
get badly mangled by the code in Session.BaseSession.make_cookie(), in
particular, this section:

        if config.has_key("ApplicationPath"):
            c.path = config["ApplicationPath"]
        else:
            docroot = self._req.document_root()
            # the path where *Handler directive was specified
            dirpath = self._req.hlist.directory 
            c.path = dirpath[len(docroot):]

If you don't have AppliationPath set as a PythonOption and your
handler isn't in a <Directory> under DocumentRoot you're probably
going to have trouble.  Two scenarios hurt me:

  1.  using a handler inside a <Location>.  There is no path.  My
      browser (galeon 1.2.7) hung for infinity on reloads.  Never
      could figure out why.

  2.  using mod_python under UserDir directories.  I do this for
      prototyping because it's so easy to tweak a .htaccess file under
      a ~username/public_html subdirectory and you don't have to
      restart/reload apache to see your changes.  In this situation
      the length of DocumentRoot has no relationship to the URIs so
      the path attribute of the cookie gets oddly chopped at the
      head.  I kept getting new sessions because the browser wasn't
      sending the cookie because of paths not matching the uri.

I believe the same problem will occur under certain circumstances if
Alias directives affect mod_python usage although I haven't tested
this.

I think the ELSE clause above is trying to do something that can't be
done easily: extract the leading uri of the handler.  With Alias,
UserDir and Location directives, it's pretty difficult.  Is it
possible?  Perhaps the code shouldn't try to be so clever.  Default
the path to "/" unless the Session constructor overrides the value??

My temporary fix is to always explicitly use ApplicationPath.  Setting
it to "/" is certainly general enough for my prototyping.

Minimally, I think the documentation for Session should devote some
space to addressing and clarifying this issue.

------------------
Daniel Popowich
Network Specialist
-------------------------------------
Mohawk Trail Regional School District
24 Ashfield Rd.
Shelburne Falls, MA 01370
413.625.0192 x22
-------------------------------------

From kevin at sb.org  Fri Dec 19 19:31:59 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:04:29 2004
Subject: [mod_python] newbie
In-Reply-To: <16355.25796.858212.742243@desk.crynwr.com>
References: <3FE32CA1.7070105@telefonica.net>
	<EF2F6572-3260-11D8-B7F9-000A95A072FC@sb.org>
	<16355.25796.858212.742243@desk.crynwr.com>
Message-ID: <EC83DA6A-3283-11D8-B7F9-000A95A072FC@sb.org>

For the record, I meant to say

from mod_python import apache

because what I wrote wouldn't actually run.

And although I tend to agree with you in general, I still prefer 
importing apache from mod_python rather than just importing mod_python.

On Dec 19, 2003, at 3:51 PM, Russell Nelson wrote:

> Kevin Ballard writes:
>> What's your mptest.py look like?
>>
>> Most likely, it's something like
>>
>> from apache import *
>
> Just as a matter of style, I think Guido (BDFL) discourages this sort
> of thing.  For myself, even though it means more typing in the first
> place, I prefer to see a plain import, and lots of foo., bar., and
> baz. prefixes.  Lets the newbie (which I've been so very recently)
> know which module the function is associated with.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From grisha at modpython.org  Fri Dec 19 23:13:26 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:04:29 2004
Subject: [mod_python] newbie
In-Reply-To: <EC83DA6A-3283-11D8-B7F9-000A95A072FC@sb.org>
References: <3FE32CA1.7070105@telefonica.net>
	<EF2F6572-3260-11D8-B7F9-000A95A072FC@sb.org>
	<EC83DA6A-3283-11D8-B7F9-000A95A072FC@sb.org>
Message-ID: <20031219230940.K35608@onyx.ispol.com>


I think Russel was referring not to the "from" but to the "*" - I agree,
Python would probably be better if this "feature" did not exist at all,
because you don't know what the "*" has just imported.

Using "from" is just fine though :-)

On Fri, 19 Dec 2003, Kevin Ballard wrote:

> For the record, I meant to say
>
> from mod_python import apache
>
> because what I wrote wouldn't actually run.
>
> And although I tend to agree with you in general, I still prefer
> importing apache from mod_python rather than just importing mod_python.
>
> On Dec 19, 2003, at 3:51 PM, Russell Nelson wrote:
>
> > Kevin Ballard writes:
> >> What's your mptest.py look like?
> >>
> >> Most likely, it's something like
> >>
> >> from apache import *
> >
> > Just as a matter of style, I think Guido (BDFL) discourages this sort
> > of thing.  For myself, even though it means more typing in the first
> > place, I prefer to see a plain import, and lots of foo., bar., and
> > baz. prefixes.  Lets the newbie (which I've been so very recently)
> > know which module the function is associated with.
>
> --
> Kevin Ballard
> kevin@sb.org
> http://www.tildesoft.com
> http://kevin.sb.org
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From fccoelho at fiocruz.br  Mon Dec 22 10:28:16 2003
From: fccoelho at fiocruz.br (Flavio C. Coelho)
Date: Fri Jan  9 22:04:29 2004
Subject: [mod_python] mod_python and the semaphore bug
In-Reply-To: <8794402.1071700631675.JavaMail.jciccale@mac.com>
References: <8794402.1071700631675.JavaMail.jciccale@mac.com>
Message-ID: <1072096096.2609.6.camel@pinguim.procc.fiocruz.br>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: fiocruz4.jpg
Type: image/jpeg
Size: 3085 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20031222/4d0595d6/fiocruz4-0003.jpg
From jciccale at mac.com  Mon Dec 22 14:42:56 2003
From: jciccale at mac.com (Julian Ciccale)
Date: Fri Jan  9 22:04:29 2004
Subject: [mod_python] mod_python and the semaphore bug
Message-ID: <8134803.1072100576603.JavaMail.jciccale@mac.com>

The message on error_log is fine, apache uses it also to output "NOTICE" messages.
What is that doesn't work now? 

 
On Monday, December 22, 2003, at 01:28PM, Flavio C. Coelho <fccoelho@fiocruz.br> wrote:

>
><<Original Attached>>
From dpopowich at mtrsd.k12.ma.us  Mon Dec 22 11:02:45 2003
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Fri Jan  9 22:04:29 2004
Subject: [mod_python] Sessions and problems with cookie path attribute
In-Reply-To: <16355.28225.866414.517954@gargle.gargle.HOWL>
References: <16355.28225.866414.517954@gargle.gargle.HOWL>
Message-ID: <16359.5542.430.748017@gargle.gargle.HOWL>


> I had a serious problem getting sessions to work with an app I'm
> writing (modpython 3.1.2b, httpd-2.0.40, python 2.3.2) and after
> browsing the archives I've seen others getting bitten by the same
> problem...
> 
> Session ids are stored on the client as a cookie with name pysid.
> This is fine and the cookie gets stored, but the path attribute can
> get badly mangled by the code in Session.BaseSession.make_cookie(), in
> particular, this section:
> 
>         if config.has_key("ApplicationPath"):
>             c.path = config["ApplicationPath"]
>         else:
>             docroot = self._req.document_root()
>             # the path where *Handler directive was specified
>             dirpath = self._req.hlist.directory 
>             c.path = dirpath[len(docroot):]
> 
> If you don't have AppliationPath set as a PythonOption and your
> handler isn't in a <Directory> under DocumentRoot you're probably
> going to have trouble.  Two scenarios hurt me:
> 
>   1.  using a handler inside a <Location>.  There is no path.  My
>       browser (galeon 1.2.7) hung for infinity on reloads.  Never
>       could figure out why.
> 
>   2.  using mod_python under UserDir directories.  I do this for
>       prototyping because it's so easy to tweak a .htaccess file under
>       a ~username/public_html subdirectory and you don't have to
>       restart/reload apache to see your changes.  In this situation
>       the length of DocumentRoot has no relationship to the URIs so
>       the path attribute of the cookie gets oddly chopped at the
>       head.  I kept getting new sessions because the browser wasn't
>       sending the cookie because of paths not matching the uri.
> 
> I believe the same problem will occur under certain circumstances if
> Alias directives affect mod_python usage although I haven't tested
> this.
> 
> I think the ELSE clause above is trying to do something that can't be
> done easily: extract the leading uri of the handler.  With Alias,
> UserDir and Location directives, it's pretty difficult.  Is it
> possible?  Perhaps the code shouldn't try to be so clever.  Default
> the path to "/" unless the Session constructor overrides the value??
> 
> My temporary fix is to always explicitly use ApplicationPath.  Setting
> it to "/" is certainly general enough for my prototyping.
> 
> Minimally, I think the documentation for Session should devote some
> space to addressing and clarifying this issue.

I need to correct myself.  The problem does not occur inside
<Location> directives (the hanging problem I referred to was a bug in
my application: my session instance was not being garbage collected).
In fact, when using Sessions inside <Location> URIs no path attribute
is specified in the Cookie, so it is ALWAYS sent back to the server.

However, I have confirmed that this problem exists for uses of Session
within handlers referenced via Alias directives.

In summary, if you use Sessions in handlers referenced via UserDir or
Alias directives you have to use "PythonOption ApplicationPath ..." in
your config.

------------------
Daniel Popowich
Network Specialist
-------------------------------------
Mohawk Trail Regional School District
24 Ashfield Rd.
Shelburne Falls, MA 01370
413.625.0192 x22
-------------------------------------

From theman at eradman.com  Mon Dec 22 11:16:46 2003
From: theman at eradman.com (Eric Radman)
Date: Fri Jan  9 22:04:29 2004
Subject: [mod_python] mod_* performance
Message-ID: <1072091806.2521.68.camel@inspiration.x.eradman.com>

Guys,

I had been blaming bad performance with concurrent connections on
mod_python, when in fact an Apache config change can make all the
difference. The key is to limit the number of Apache processes based on
the RAM and average concurrency load that you have.

I found the mod_perl suffers from the same performance characteristics
becuase it's Apache behavior that impacts the performance on
simultinious connections, not mod_python or mod_perl.

I changed the MaxClients parameter in apache2.conf from 50 to 8:

<IfModule prefork.c>
StartServers         1
MinSpareServers      1
MaxSpareServers     10
MaxClients           8
MaxRequestsPerChild  0
</IfModule>

7k mod_python page with SQL caching:

Reqests  Concurrency   Req/Sec  Connect Time
400      1             136.54   7.324
400      5             131.29   38.085
400      15            126.28   118.780
400      50            96.73    516.883 
400      100           71.92    1390.431

To quote Stas Bekman <stas at stason.org>
"""
MinSpareServers, MaxSpareServers and StartServers are only important for
user response times. Sometimes users will have to wait a bit.

The important parameters are MaxClients and MaxRequestsPerChild.
MaxClients should be not too big, so it will not abuse your machine's
memory resources, and not too small, for if it is your users will be
forced to wait for the children to become free to serve them.
MaxRequestsPerChild should be as large as possible, to get the full
benefit of mod_perl, but watch your server at the beginning to make sure
your scripts are not leaking memory, thereby causing your server (and
your service) to die very fast.
"""

7k PHP page with standard connection pooling:

Reqests  Concurrency   Req/Sec  Connect Time
400      1             29.60    33.785
400      5             15.32    65.291
400      15            23.13    43.242
400      50            21.45    2656.869
400      100           23.21    4308.698

What we see here is that connect time (which translates into perceived
latency) really suffers in PHP when you hit it with a large number of
concurrent connections.

This one little tweak makes mod_perl and mod_python immune to http DOS
attacks. With the poper coding an increase of 300%-350% is possible over
PHP.

Eric Radman
From theman at eradman.com  Mon Dec 22 11:22:10 2003
From: theman at eradman.com (Eric Radman)
Date: Fri Jan  9 22:04:29 2004
Subject: [mod_python] 
Message-ID: <1072092130.4080.2.camel@inspiration.x.eradman.com>



From michael at dynamine.net  Mon Dec 22 08:34:26 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 22:04:29 2004
Subject: [mod_python] mod_* performance
In-Reply-To: <1072091806.2521.68.camel@inspiration.x.eradman.com>
References: <1072091806.2521.68.camel@inspiration.x.eradman.com>
Message-ID: <3FE71D12.6030802@dynamine.net>

Eric Radman wrote:

> This one little tweak makes mod_perl and mod_python immune to http DOS
> attacks. With the poper coding an increase of 300%-350% is possible over
> PHP.

I think that in order to reach a believable conclusion one really needs 
to run such benchmarks with the Zend Accelerator for PHP; it yields a 
performance improvement of nearly an order of magnitude.

Best,

--Michael
From neel at mediapulse.com  Mon Dec 22 11:44:42 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:04:29 2004
Subject: [mod_python] Changing the status code with custom content
Message-ID: <C0FC22C08B82074A88B500617641577787A7F0@johnson.mediapulse.net>

I'm having trouble using mod_python to change the status code and have
custom content in the error message.  If I return something other than
apache.OK in my handler, the status line is set correctly set but apache
returns the default error page.  If I have sent custom content for the
error message, the apache error message is added to the end of the
document.  I can get around this by using an ErrorDocument directive in
apache's conf, but I loose access to the traceback of the error and thus
the ability to have a really custom error message.

At first glance this didn't seem to matter.  As long as the content said
error, the user knew of the problem, even if the status was 200 OK.
However I've found out now with search bots this does matter - they
don't know that they have a bad url for the site and are indexing error
pages thinking they are legit.

Any thoughts on what I may be over looking?

Thanks,
Mike

From dpopowich at mtrsd.k12.ma.us  Mon Dec 22 11:44:30 2003
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Fri Jan  9 22:04:29 2004
Subject: [mod_python] redirects and url rewriting
Message-ID: <16359.8046.124675.498918@gargle.gargle.HOWL>


When I use req.internal_redirect(some_uri) sometimes the url in my
browser gets rewritten to reflect some_uri and some times it doesn't,
remaining as the uri of the originally selected page.  This can cause
numerous problems with relative links inside a page if the url is not
rewritten in the browser.

I'm trying to understand what causes this and how I can control it.
Can someone point me to some doc?

Below is a short handler I wrote as an example (the links I use assume
you have the apache manual installed; modify if necessary).

[modpython 3.1.2b, python 2.3.2, apache 2.0.40]

Thanks,

------------------
Daniel Popowich
Network Specialist
-------------------------------------
Mohawk Trail Regional School District
24 Ashfield Rd.
Shelburne Falls, MA 01370
413.625.0192 x22
-------------------------------------

# -*- python -*-

from mod_python import apache, util

def handler(req):

    req.content_type = 'text/html'

    form = util.FieldStorage(req)
    choice = form.getfirst('redirect')
    # this doesn't rewrite the url in the browser
    if choice == '1':
        req.internal_redirect('%s/abcdefg' % req.uri)
        
    # neither does this one [and the resulting page is quite
    # messed up because the relative urls inside the doc don't
    # make sense without the rewrite]
    elif choice == '2':
        req.internal_redirect('/manual/index.html')

    # but this one does
    elif choice == '3':
        req.internal_redirect('/manual')

    else:
        req.write('''
        <html>
        <body>
        <a href=%s?redirect=1>redirect to %s/abcdefg</a><br>
        <a href=%s?redirect=2>redirect to /manual/index.html</a><br>
        <a href=%s?redirect=3>redirect to /manual</a><br>
        </body>
        </html>
        ''' % ((req.uri,)*4))


    return apache.OK

From jciccale at mac.com  Mon Dec 22 18:10:54 2003
From: jciccale at mac.com (Julian Ciccale)
Date: Fri Jan  9 22:04:29 2004
Subject: [mod_python] redirects and url rewriting
Message-ID: <1006403.1072113054814.JavaMail.jciccale@mac.com>

I think the best option for your problem is:

req.headers_out[ "Location" ] = uri
return apache.HTTP_MOVED_PERMANENTLY #301 

- julcicc - 
 
On Monday, December 22, 2003, at 05:44PM, Daniel J. Popowich <dpopowich@mtrsd.k12.ma.us> wrote:

>
>When I use req.internal_redirect(some_uri) sometimes the url in my
>browser gets rewritten to reflect some_uri and some times it doesn't,
>remaining as the uri of the originally selected page.  This can cause
>numerous problems with relative links inside a page if the url is not
>rewritten in the browser.
>
>I'm trying to understand what causes this and how I can control it.
>Can someone point me to some doc?
>
>Below is a short handler I wrote as an example (the links I use assume
>you have the apache manual installed; modify if necessary).
>
>[modpython 3.1.2b, python 2.3.2, apache 2.0.40]
>
>Thanks,
>
>------------------
>Daniel Popowich
>Network Specialist
>-------------------------------------
>Mohawk Trail Regional School District
>24 Ashfield Rd.
>Shelburne Falls, MA 01370
>413.625.0192 x22
>-------------------------------------
>
># -*- python -*-
>
>from mod_python import apache, util
>
>def handler(req):
>
>    req.content_type = 'text/html'
>
>    form = util.FieldStorage(req)
>    choice = form.getfirst('redirect')
>    # this doesn't rewrite the url in the browser
>    if choice == '1':
>        req.internal_redirect('%s/abcdefg' % req.uri)
>        
>    # neither does this one [and the resulting page is quite
>    # messed up because the relative urls inside the doc don't
>    # make sense without the rewrite]
>    elif choice == '2':
>        req.internal_redirect('/manual/index.html')
>
>    # but this one does
>    elif choice == '3':
>        req.internal_redirect('/manual')
>
>    else:
>        req.write('''
>        <html>
>        <body>
>        <a href=%s?redirect=1>redirect to %s/abcdefg</a><br>
>        <a href=%s?redirect=2>redirect to /manual/index.html</a><br>
>        <a href=%s?redirect=3>redirect to /manual</a><br>
>        </body>
>        </html>
>        ''' % ((req.uri,)*4))
>
>
>    return apache.OK
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
From dpopowich at mtrsd.k12.ma.us  Mon Dec 22 12:34:09 2003
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Fri Jan  9 22:04:29 2004
Subject: [mod_python] redirects and url rewriting
In-Reply-To: <1006403.1072113054814.JavaMail.jciccale@mac.com>
References: <1006403.1072113054814.JavaMail.jciccale@mac.com>
Message-ID: <16359.11025.459664.120166@gargle.gargle.HOWL>



> I think the best option for your problem is:
> 
> req.headers_out[ "Location" ] = uri
> return apache.HTTP_MOVED_PERMANENTLY #301 
> 

This won't work for some of what I'm doing, i.e., user goes to a page
that needs authentication so they are redirected to a login page
(without having to save state to a session).  There are other similar
situations where, programmatically, you discover that the user should
be somewhere else within your mod_python app and you'd like to
redirect them to other URIs which can check req.prev for existing
state (thus saving network traffic, server hits, etc.  Heck, you got
everything you need to know, why tell the client, "go here" when you
can just deliver it in the first place?).

Also, being the kind of geek that needs to know how and why things
work, I'd like to know why some redirects rewrite my browser url and
some don't; ultimately, I'd like to be able to control the behaviour
with mod_python.

Dan

> >
> >When I use req.internal_redirect(some_uri) sometimes the url in my
> >browser gets rewritten to reflect some_uri and some times it doesn't,
> >remaining as the uri of the originally selected page.  This can cause
> >numerous problems with relative links inside a page if the url is not
> >rewritten in the browser.
> >
> >I'm trying to understand what causes this and how I can control it.
> >Can someone point me to some doc?
> >
> >Below is a short handler I wrote as an example (the links I use assume
> >you have the apache manual installed; modify if necessary).
> >
> >[modpython 3.1.2b, python 2.3.2, apache 2.0.40]
> >
> >Thanks,
> >
> >------------------
> >Daniel Popowich
> >Network Specialist
> >-------------------------------------
> >Mohawk Trail Regional School District
> >24 Ashfield Rd.
> >Shelburne Falls, MA 01370
> >413.625.0192 x22
> >-------------------------------------
> >
> ># -*- python -*-
> >
> >from mod_python import apache, util
> >
> >def handler(req):
> >
> >    req.content_type = 'text/html'
> >
> >    form = util.FieldStorage(req)
> >    choice = form.getfirst('redirect')
> >    # this doesn't rewrite the url in the browser
> >    if choice == '1':
> >        req.internal_redirect('%s/abcdefg' % req.uri)
> >        
> >    # neither does this one [and the resulting page is quite
> >    # messed up because the relative urls inside the doc don't
> >    # make sense without the rewrite]
> >    elif choice == '2':
> >        req.internal_redirect('/manual/index.html')
> >
> >    # but this one does
> >    elif choice == '3':
> >        req.internal_redirect('/manual')
> >
> >    else:
> >        req.write('''
> >        <html>
> >        <body>
> >        <a href=%s?redirect=1>redirect to %s/abcdefg</a><br>
> >        <a href=%s?redirect=2>redirect to /manual/index.html</a><br>
> >        <a href=%s?redirect=3>redirect to /manual</a><br>
> >        </body>
> >        </html>
> >        ''' % ((req.uri,)*4))
> >
> >
> >    return apache.OK
> >
> >_______________________________________________
> >Mod_python mailing list
> >Mod_python@modpython.org
> >http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> >

From michael at dynamine.net  Mon Dec 22 11:34:16 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 22:04:29 2004
Subject: [mod_python] redirects and url rewriting
In-Reply-To: <16359.11025.459664.120166@gargle.gargle.HOWL>
References: <1006403.1072113054814.JavaMail.jciccale@mac.com>
	<16359.11025.459664.120166@gargle.gargle.HOWL>
Message-ID: <3FE74738.4090706@dynamine.net>

Daniel J. Popowich wrote:

> 
>>I think the best option for your problem is:
>>
>>req.headers_out[ "Location" ] = uri
>>return apache.HTTP_MOVED_PERMANENTLY #301 
>>
> 
> 
> This won't work for some of what I'm doing, i.e., user goes to a page
> that needs authentication so they are redirected to a login page
> (without having to save state to a session).  There are other similar
> situations where, programmatically, you discover that the user should
> be somewhere else within your mod_python app and you'd like to
> redirect them to other URIs which can check req.prev for existing
> state (thus saving network traffic, server hits, etc.  Heck, you got
> everything you need to know, why tell the client, "go here" when you
> can just deliver it in the first place?).
> 
> Also, being the kind of geek that needs to know how and why things
> work, I'd like to know why some redirects rewrite my browser url and
> some don't; ultimately, I'd like to be able to control the behaviour
> with mod_python.

I don't know why mod_python is behaving in the manner you describe, but 
I can tell you that a clear understanding of the HTTP protocol is needed 
here.

Browsers determine what to display in the address bar based on two 
things only: (1) the URL requested by a user (bookmark, address bar or 
some other UI mechanism), or (2) an HTTP Redirect: header returned by 
the server.

Without either of those, there is no way for the browser to know that 
the page requested at /foo/bar can be found in the future at /baz/quux.

--Michael
From kevin at sb.org  Mon Dec 22 14:47:08 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:04:29 2004
Subject: [mod_python] redirects and url rewriting
In-Reply-To: <16359.11025.459664.120166@gargle.gargle.HOWL>
References: <1006403.1072113054814.JavaMail.jciccale@mac.com>
	<16359.11025.459664.120166@gargle.gargle.HOWL>
Message-ID: <A0BDA434-34B7-11D8-B640-000A95A072FC@sb.org>

I meant to send this to the list, but I accidentally sent it to Daniel 
Popowich instead.

-----

Well, I just did a curl on http://localhost/manual and these were the 
headers I got:

HTTP/1.1 301 Moved Permanently
Date: Mon, 22 Dec 2003 17:53:24 GMT
Server: Apache/2.0.48 (Unix) DAV/2 mod_python/3.0.4 Python/2.3
Location: http://localhost/manual/
Content-Length: 341
Content-Type: text/html; charset=iso-8859-1

Does that explain it well enough for you?

On Dec 22, 2003, at 12:34 PM, Daniel J. Popowich wrote:

> Also, being the kind of geek that needs to know how and why things
> work, I'd like to know why some redirects rewrite my browser url and
> some don't; ultimately, I'd like to be able to control the behaviour
> with mod_python.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From michael at dynamine.net  Mon Dec 22 11:50:27 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 22:04:29 2004
Subject: [mod_python] redirects and url rewriting
In-Reply-To: <3FE74738.4090706@dynamine.net>
References: <1006403.1072113054814.JavaMail.jciccale@mac.com>
	<16359.11025.459664.120166@gargle.gargle.HOWL> <3FE74738.4090706@dynamine.net>
Message-ID: <3FE74B03.70506@dynamine.net>

I wrote:

> Browsers determine what to display in the address bar based on two 
> things only: (1) the URL requested by a user (bookmark, address bar or 
> some other UI mechanism), or (2) an HTTP Redirect: header returned by 
> the server.

That should be an HTTP Location: header combined with a 301/302 HTTP 
response code.

--Michael
From dpopowich at mtrsd.k12.ma.us  Mon Dec 22 15:36:01 2003
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Fri Jan  9 22:04:29 2004
Subject: [mod_python] redirects and url rewriting
In-Reply-To: <3FE74B03.70506@dynamine.net>
References: <1006403.1072113054814.JavaMail.jciccale@mac.com>
	<16359.11025.459664.120166@gargle.gargle.HOWL>
	<3FE74738.4090706@dynamine.net>
	<3FE74B03.70506@dynamine.net>
Message-ID: <16359.21937.84003.871912@gargle.gargle.HOWL>


Michael S. Fischer writes:
> I wrote:
> 
> > Browsers determine what to display in the address bar based on two 
> > things only: (1) the URL requested by a user (bookmark, address bar or 
> > some other UI mechanism), or (2) an HTTP Redirect: header returned by 
> > the server.
> 

Yes, of course.  Duh.  I now think I understand what's going on:

  1. A call to req.internal_redirect(uri) will return the content of
     the uri as the address the user asked for UNLESS the HTTP
     Location header is sent.  This is what I had been originally
     expecting until the redirect to certain urls (like
     http://localhost/manual) changed in my browser's address bar.
     Confusion insued until Kevin Ballard replied with clues that...

  2. ...apache, when receiving requests that are directories (or
     aliases/symlinks to directories) without the trailing slash,
     actually sends a 301 response.  So, a request like
     http://host/foo will generate a 301 response if foo is a
     directory and send a "Location: http://host/foo/" header.  I was
     first shocked by this (think of all the extra bytes flooding the
     'net because of this!!), but understand it's the only way within
     the protocol to make relative links work.  (Although it begs the
     question why the protocol doesn't have a Real-Location header, or
     some such, to let the browser know what the real url for the
     requested page should be without having to go fetch it.)

Sound right?

Knowing now what I can expect consistantly (and knowing it's not for
lack of understanding mod_python subtleties) and can continue with my
app design.  Thanks for all your help!

Dan


From neel at mediapulse.com  Mon Dec 22 16:37:52 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:04:29 2004
Subject: [mod_python] redirects and url rewriting
Message-ID: <C0FC22C08B82074A88B500617641577787A7F1@johnson.mediapulse.net>

>      directory and send a "Location: http://host/foo/" header.  I was
>      first shocked by this (think of all the extra bytes flooding the
>      'net because of this!!), but understand it's the only way within
>      the protocol to make relative links work.  (Although it begs the
>      question why the protocol doesn't have a Real-Location header, or
>      some such, to let the browser know what the real url for the
>      requested page should be without having to go fetch it.)

A 301 status is Moved Permanently, so that is your "Real-Location"
header.  In an ideal world browsers would update (or prompt to update)
bookmarks on such a status, but it looks like that's not going to
happen.

A 302 is Moved Temporarily, for when you wouldn't want a browser to
update it info, however given the way browsers ignore RFC's and W3C it
wouldn't surprise me to find out browser x didn't handle a 302
correctly.

I wonder how many browsers would know what to do with a 203,
Non-Authoritative Information - which is sorta like a DNS query that's
cached...

Mike

From jalil at securia.com  Mon Dec 22 15:27:02 2003
From: jalil at securia.com (Jalil Feghhi)
Date: Fri Jan  9 22:04:29 2004
Subject: [mod_python] FW: Any way to embed Python in HTML?
Message-ID: <004201c3c8e3$1acc16a0$6502a8c0@securia.com>

 
I am new to mod_python and haven't seen any examples where you can put
python code in HTML pages. Is this not supported? If not supported, is
there any way or work around (other than using the request write method)
to separate HTML writing from coding?
 
Thanks,
 
-Jalil
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20031222/0f54ce49/attachment-0003.htm
From jalil at securia.com  Mon Dec 22 15:49:53 2003
From: jalil at securia.com (Jalil Feghhi)
Date: Fri Jan  9 22:04:29 2004
Subject: [mod_python] Problem keeing the db connection open
Message-ID: <005201c3c8e6$4c073580$6502a8c0@securia.com>

I found the following code on the Internet for keeping the connection
open but it doesn't really work. Everytime I try to login, it connects
to the database. I put some log messges and I can see this happens.

1. Could someone tell me how I can keep the connection open? 

2.  I appreciate if someone explain how mod_python handler is called
when there are many requests? Does Apache create threads for each
request? And how the global database connection is used?

Thanks,

-Jalil

Here is the code:

HOST = "localhost"

DB = "mydb"

USER = "user"

PASS = "pwd"

import MySQLdb

import string

def _db_login(relogin = 0):


    global DB_CONN

    if relogin:

        DB_CONN = MySQLdb.connect(db=DB, user=USER, passwd=PASS)

        return DB_CONN

    else:

        try:

            d = DB_CONN

            return d

        except NameError:

            DB_CONN = MySQLdb.connect(host= HOST, db=DB, user=USER,
passwd=PASS)

            return DB_CONN

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20031222/bad48455/attachment-0003.htm
From grisha at modpython.org  Mon Dec 22 19:42:38 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:04:29 2004
Subject: [mod_python] Changing the status code with custom content
In-Reply-To: <C0FC22C08B82074A88B500617641577787A7F0@johnson.mediapulse.net>
References: <C0FC22C08B82074A88B500617641577787A7F0@johnson.mediapulse.net>
Message-ID: <20031222193816.N83390@onyx.ispol.com>


I believe you should req.write() your error page, set req.status to the
the error code you want and return apache.OK. If you retrun anything other
then apache.OK, then Apache assumes you want it to send its own stock
error page.

(Hope this answers your question, I'm a bit woozy on nuquil right now....)

Grisha

On Mon, 22 Dec 2003, Michael C. Neel wrote:

> I'm having trouble using mod_python to change the status code and have
> custom content in the error message.  If I return something other than
> apache.OK in my handler, the status line is set correctly set but apache
> returns the default error page.  If I have sent custom content for the
> error message, the apache error message is added to the end of the
> document.  I can get around this by using an ErrorDocument directive in
> apache's conf, but I loose access to the traceback of the error and thus
> the ability to have a really custom error message.
>
> At first glance this didn't seem to matter.  As long as the content said
> error, the user knew of the problem, even if the status was 200 OK.
> However I've found out now with search bots this does matter - they
> don't know that they have a bad url for the site and are indexing error
> pages thinking they are legit.
>
> Any thoughts on what I may be over looking?
>
> Thanks,
> Mike
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From dpopowich at mtrsd.k12.ma.us  Mon Dec 22 19:55:13 2003
From: dpopowich at mtrsd.k12.ma.us (Daniel Popowich)
Date: Fri Jan  9 22:04:29 2004
Subject: [mod_python] redirects and url rewriting
In-Reply-To: <C0FC22C08B82074A88B500617641577787A7F1@johnson.mediapulse.net>
References: <C0FC22C08B82074A88B500617641577787A7F1@johnson.mediapulse.net>
Message-ID: <33585.24.91.183.76.1072140913.squirrel@www.mtrsd.k12.ma.us>

>>      directory and send a "Location: http://host/foo/" header.  I was
>>      first shocked by this (think of all the extra bytes flooding the
>>      'net because of this!!), but understand it's the only way within
>>      the protocol to make relative links work.  (Although it begs the
>>      question why the protocol doesn't have a Real-Location header, or
>>      some such, to let the browser know what the real url for the
>>      requested page should be without having to go fetch it.)
>
> A 301 status is Moved Permanently, so that is your "Real-Location"
> header.  In an ideal world browsers would update (or prompt to update)
> bookmarks on such a status, but it looks like that's not going to
> happen.

I wasn't very clear.  For pages that have moved or for pages that haven't
moved but aren't in proper form (like my example, http://host/foo ->
http://host/foo/) on the SAME server, it seems unfortunate that the
servers can't return the page along with some header indicating that fact.

For example, why can't a request for http://host/foo return
http://host/foo/index.html with a header

  Real-Location: http://host/foo/

instead of returning a 30[12] with a Location header only to have the
browser go back to the same server.  Seems wasteful.

The 30[12] with Location header makes perfect sense for pages moved
to different servers.

Dan


From alunchampion at btconnect.com  Mon Dec 22 21:57:55 2003
From: alunchampion at btconnect.com (Alun)
Date: Fri Jan  9 22:04:29 2004
Subject: [mod_python] mod_python disables mod_dav
Message-ID: <200312230157.hBN1vW1B092956@slash.mediapulse.com>

I seem to have a problem adding mod_python to an existing configuration with
mod_dav.
I have mod_dav enabled and working and planned on integrating mod_python but
when I *only* add the LoadModule mod_python directive to the httpd.conf,
WebDAV no longer works and I get a 405 status returned.

Any help would be appreciated.

Checking OPTIONS on the URL before and after adding LoadModule gives:

=====Before====
OPTIONS /author/ http/1.1
Host: localhost:80

HTTP/1.1 200 OK
Date: Mon, 22 Dec 2003 21:47:46 GMT
Server: Apache/2.0.48 (Win32) mod_jk2/2.0.2 DAV/2
DAV: 1,2
MS-Author-Via: DAV
Allow:
OPTIONS,GET,HEAD,POST,DELETE,TRACE,PROPFIND,PROPPATCH,COPY,MOVE,LOCK,UNLOCK
Content-Length: 0
Content-Type: httpd/unix-directory

=====After LoadModule mod_python modules/mod_python.so=====
OPTIONS /author/ http:/1.1
Host: localhost:80

HTTP/1.1 200 OK
Date: Mon, 22 Dec 2003 21:28:47 GMT
Server: Apache/2.0.48 (Win32) mod_jk2/2.0.2 mod_python/3.1.2b Python/2.3.2
DAV/2

Allow: GET,HEAD,POST,OPTIONS,TRACE     <======== No DAV commands.
Content-Length: 0
Connection: close
Content-Type: httpd/unix-directory

From stian at soiland.no  Tue Dec 23 02:45:36 2003
From: stian at soiland.no (Stian =?iso-8859-1?Q?S=F8iland?=)
Date: Fri Jan  9 22:04:29 2004
Subject: [mod_python] Re: FW: Any way to embed Python in HTML?
In-Reply-To: <004201c3c8e3$1acc16a0$6502a8c0@securia.com>
References: <004201c3c8e3$1acc16a0$6502a8c0@securia.com>
Message-ID: <20031223014536.GB16301@itea.ntnu.no>

On 2003-12-23 00:27:02, Jalil Feghhi wrote:

> I am new to mod_python and haven't seen any examples where you can put
> python code in HTML pages. Is this not supported? If not supported, is
> there any way or work around (other than using the request write method)
> to separate HTML writing from coding?

Take a look at upcoming PSP from Mod-python 3.1.2b:

http://www.modpython.org/live/mod_python-3.1.2b/doc-html/pyapi-psp.html



I've also experienced some success with using template engines like
Cheetah combined with mod_python.

This is how we've done things using cheetah and mod_python's
Publisher-handler:


Made a general page template MainTemplate.tmpl:

    #attr title = "Default title"
    <html>
      <head>
        <title>$title</title>
      </head>
      <body>
        <h1>$title</h1>
        <div class="menu">
          menu blabla
          (details left out)
        </div>  
        <div class="content">
    #def content    
            No content here yet, this is just
            the base template
    #end def
    $content()
        </div>


Here's a specialized page template WelcomeTemplate.tmpl

    #extends MainTemplate
    #def content
            Welcome to our world. Blablabla
            blablabla.
    #end def     
 

These template-files are compiled with cheetah-compile - which produces
a rather nasty .py-file. This file could be imported and used from
Python.

In .htaccess:

    SetHandler mod_python
    PythonHandler mod_python.publisher


in welcome.py:

    from WelcomeTemplate import WelcomeTemplate 
    def index(req):
        templ = WelcomeTemplate()
        templ.title = "Welcome, my friend"
        return templ


Blocks made within templates (the #def's) are callable methods from
within Python, and therefore templates could be used for smaller building
blocks as well.  templ.content could be changed to any other template,
or even a python function defined somewhere else.


Model view controller
=====================

In our current ongoing project, Cerebrum, we've succeeded in seperating
content from control, and even seperating the model from control. This
is the old MVC (model-view-controller) principle as we've used it:

       model          controller                  view
  business logic      web logic             presentation logic
  (what to do)      (what to show)             (how to view)

 python classes     python classes           cheetah templates
 representing the   for web access, ie.      with calls to other
 data, methods      each method accessed     templates and
 for operations     from the browser.        helper classes in
                    Performs operations on   python
                    model and views by
                    calling cheetah 
                    templates. 
 

Example:
========
code is simplified, and never tested in simplified form. It will
probably not work directly. The real code can be viewed on 
http://cvs.sourceforge.net/viewcvs.py/cerebrum/cerebrum/ under the
directories Cerebrum/client and web/ - note however
that the code is constantly changing at this part of the web project.


Model - Cerebrum/client/BofhModel.py
------------------------------------


class Entity:
    def __init__(self, server):
        # xmlrpc-connection
        self.server = server

    def fetch_by_id(cls, server, id):
        # make a new instance of the called-on class,
        # ie. a Group or Entity
        entity = cls(server)
        entity.load_entity_info(id)
        return entity
    fetch_by_id = classmethod(fetch_by_id)

    def load_entity_info(self, id):
        self.id = id
        info = self.server.entity_info(id)
        self.type = info['type']
        return info

class Group(Entity):
    def load_entity_info(self, id):
        info = Entity.load_entity_info(self, id)
        self.name = info['name']
        self.description = info['description']
        return info
    

View - web/lib/cereweb/templates/GroupViewTemplate.tmpl
--------------------------------------------------------

## Be international, import function gettext() as _()
#from gettext import gettext as _
#def viewGroup(group)
    <h1>$_("Group") $group.name</h1>
    $groupInfo($group)
#end def

#def groupInfo(group)
    <div class="info">
    <dl>
        <dt>$_("Name")</dt>
        <dd>$group.name</dd>
        <dt>$_("Description")</dt>
        <dd>$group.description</dd>
    </dl>
    </div>
#end def

MainTemplate.tmpl almost like shown in previous text.


Controller - htdocs/group.py
----------------------------

from Cerebrum.web.templates.MainTemplate import MainTemplate
from Cerebrum.web.templates.GroupViewTemplate import GroupViewTemplate
from Cerebrum.client import BofhModel

def view(req, id):
    # Get a generic view (menu, header, footer)
    page = MainTemplate()
    # the session and the xmlrpc server connection has been prepared by
    # a handler in .htaccess
    server = req.session['server']
    # get the object from the model   
    group = BofhModel.Group.fetch_by_id(server, id)
    # prepare the specialiced view
    view = GroupViewTemplate()
    # pass the model to the view 
    page.content = view.viewGroup(group)
    # and return the final result (within the MainTemplate)
    # to the browser
    return page
    

Notice how the controller is rather small and only glues together the view
and the model. In this example, the model is just an xmlrpc abstraction,
so even the business logic is hidden.  In this case the controller
actually uses two views, both MainTemplate (the menu, footer, etc.) and
GroupViewTemplate.  The reason for not subclassing MainTemplate into
GroupViewTemplate is that we needed to pass on the chosen group object
(from the Model), and that a groupview could be usable from within other
views as well. 


-- 
Stian S?iland               Work toward win-win situation. Win-lose
Trondheim, Norway           is where you win and the other lose.
http://www.soiland.no/      Lose-lose and lose-win are left as an
                            exercise to the reader.  [Limoncelli/Hogan]

From gnb at itga.com.au  Tue Dec 23 13:07:07 2003
From: gnb at itga.com.au (Gregory Bond)
Date: Fri Jan  9 22:04:29 2004
Subject: [mod_python] FW: Any way to embed Python in HTML? 
In-Reply-To: Your message of Mon, 22 Dec 2003 15:27:02 -0800.
Message-ID: <200312230207.NAA06930@lightning.itga.com.au>

You could consider Albatross, which has a nice Model/Controller/View paradigm, 
and does HTML templating (and session handling and heaps of other stuff).

http://www.object-craft.com.au/projects/albatross/


From stephen at vermeulen.ca  Mon Dec 22 19:41:15 2003
From: stephen at vermeulen.ca (Stephen Vermeulen)
Date: Fri Jan  9 22:04:29 2004
Subject: [mod_python] FW: Any way to embed Python in HTML?
In-Reply-To: <004201c3c8e3$1acc16a0$6502a8c0@securia.com>
References: <004201c3c8e3$1acc16a0$6502a8c0@securia.com>
Message-ID: <3FE7AB4B.9020107@vermeulen.ca>

Jalil Feghhi wrote:

>  
> I am new to mod_python and haven't seen any examples where you can put 
> python code in HTML pages. Is this not supported?

While working with mod_python 3.03 I did something along these lines, 
which I consider to be a rather
evil hack (this was done on some "for internal use only" pages). I used 
python's pickle module to serialize up some
objects, then base64 encoded them into ASCII form, and then placed the 
resulting text into hidden form fields
on the page that was served up. This allowed me to pass some complex 
state information (that was expensive to
generate, and was also generated by a different program at an earlier 
time) relating to the page that the user
was editing into the mod_python code that did the editing.


> If not supported, is there any way or work around (other than using 
> the request write method) to separate HTML writing from coding?
>  
> Thanks,
>  
> -Jalil

Regards,

Stephen


From gdamjan at mail.net.mk  Tue Dec 23 03:47:22 2003
From: gdamjan at mail.net.mk (Damjan)
Date: Fri Jan  9 22:04:30 2004
Subject: [mod_python] mod_python disables mod_dav
In-Reply-To: <200312230157.hBN1vW1B092956@slash.mediapulse.com>
References: <200312230157.hBN1vW1B092956@slash.mediapulse.com>
Message-ID: <20031223024722.GA18811@legolas.on.net.mk>

> I seem to have a problem adding mod_python to an existing configuration with
> mod_dav.
> I have mod_dav enabled and working and planned on integrating mod_python but
> when I *only* add the LoadModule mod_python directive to the httpd.conf,
> WebDAV no longer works and I get a 405 status returned.
> 
> Any help would be appreciated.

Quick workaround, put the "LoadModule mod_python" directive above the 
"LoadModule mod_dav" directive - apache will execute the modules
bottom-to-top - that way mod_dav will be first to execute.





-- 
Damjan Georgievski
jabberID: damjan@bagra.net.mk
From grisha at modpython.org  Mon Dec 22 22:00:03 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:04:30 2004
Subject: [mod_python] mod_python disables mod_dav
In-Reply-To: <200312230157.hBN1vW1B092956@slash.mediapulse.com>
References: <200312230157.hBN1vW1B092956@slash.mediapulse.com>
Message-ID: <20031222215922.N85305@onyx.ispol.com>


I believe Damjan reported that if you swap the lines (put first whichever
was second) the problem goes away,

HTH,

Grisha

On Mon, 22 Dec 2003, Alun wrote:

> I seem to have a problem adding mod_python to an existing configuration with
> mod_dav.
> I have mod_dav enabled and working and planned on integrating mod_python but
> when I *only* add the LoadModule mod_python directive to the httpd.conf,
> WebDAV no longer works and I get a 405 status returned.
>
> Any help would be appreciated.
>
> Checking OPTIONS on the URL before and after adding LoadModule gives:
>
> =====Before====
> OPTIONS /author/ http/1.1
> Host: localhost:80
>
> HTTP/1.1 200 OK
> Date: Mon, 22 Dec 2003 21:47:46 GMT
> Server: Apache/2.0.48 (Win32) mod_jk2/2.0.2 DAV/2
> DAV: 1,2
> MS-Author-Via: DAV
> Allow:
> OPTIONS,GET,HEAD,POST,DELETE,TRACE,PROPFIND,PROPPATCH,COPY,MOVE,LOCK,UNLOCK
> Content-Length: 0
> Content-Type: httpd/unix-directory
>
> =====After LoadModule mod_python modules/mod_python.so=====
> OPTIONS /author/ http:/1.1
> Host: localhost:80
>
> HTTP/1.1 200 OK
> Date: Mon, 22 Dec 2003 21:28:47 GMT
> Server: Apache/2.0.48 (Win32) mod_jk2/2.0.2 mod_python/3.1.2b Python/2.3.2
> DAV/2
>
> Allow: GET,HEAD,POST,OPTIONS,TRACE     <======== No DAV commands.
> Content-Length: 0
> Connection: close
> Content-Type: httpd/unix-directory
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From mark at camazotz.com  Mon Dec 22 22:13:50 2003
From: mark at camazotz.com (Mark Smith)
Date: Fri Jan  9 22:04:30 2004
Subject: [mod_python] Re: FW: Any way to embed Python in HTML?
In-Reply-To: <200312230245.hBN2jU1C093084@slash.mediapulse.com>
References: <200312230245.hBN2jU1C093084@slash.mediapulse.com>
Message-ID: <07C1B262-34F6-11D8-9F73-00039364CE50@camazotz.com>

> I am new to mod_python and haven't seen any examples where you can put
> python code in HTML pages. Is this not supported? If not supported, is
> there any way or work around (other than using the request write 
> method)
> to separate HTML writing from coding?

PWO (http://www.jamwt.com/pwo/) is a simple JSP-style processor that 
allows you to embed Python code.  I think it has a less cluttered 
syntax than many of the alternatives.

If you want something more complex that supports MVC, have a look at 
Draco (http://draco.boskant.nl/).  It's nicely thought out and well 
documented (although the database component is rather low-level.)

From gnb at itga.com.au  Tue Dec 23 15:08:54 2003
From: gnb at itga.com.au (Gregory Bond)
Date: Fri Jan  9 22:04:30 2004
Subject: [mod_python] Re: FW: Any way to embed Python in HTML? 
In-Reply-To: Your message of Mon, 22 Dec 2003 22:13:50 -0500.
Message-ID: <200312230408.PAA13869@lightning.itga.com.au>


I've added an entry to the mod_python FAQ (3.10) to cover this and similar
questions. Please feel free to update or add to the info I've put there.


From neel at mediapulse.com  Tue Dec 23 09:46:25 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:04:30 2004
Subject: [mod_python] Changing the status code with custom content
Message-ID: <C0FC22C08B82074A88B50061764157776B9906@johnson.mediapulse.net>

Is req.status a 3.x only thing (reason I didn't see this is it's not
listed in the 2.x docs - and this server happens to be 2.x)?

Mike

> -----Original Message-----
> From: Gregory (Grisha) Trubetskoy [mailto:grisha@modpython.org] 
> Sent: Monday, December 22, 2003 7:43 PM
> To: Michael C. Neel
> Cc: mod_python@modpython.org
> Subject: Re: [mod_python] Changing the status code with custom content
> 
> 
> 
> I believe you should req.write() your error page, set 
> req.status to the
> the error code you want and return apache.OK. If you retrun 
> anything other
> then apache.OK, then Apache assumes you want it to send its own stock
> error page.
> 
> (Hope this answers your question, I'm a bit woozy on nuquil 
> right now....)
> 
> Grisha
> 
> On Mon, 22 Dec 2003, Michael C. Neel wrote:
> 
> > I'm having trouble using mod_python to change the status 
> code and have
> > custom content in the error message.  If I return something 
> other than
> > apache.OK in my handler, the status line is set correctly 
> set but apache
> > returns the default error page.  If I have sent custom 
> content for the
> > error message, the apache error message is added to the end of the
> > document.  I can get around this by using an ErrorDocument 
> directive in
> > apache's conf, but I loose access to the traceback of the 
> error and thus
> > the ability to have a really custom error message.
> >
> > At first glance this didn't seem to matter.  As long as the 
> content said
> > error, the user knew of the problem, even if the status was 200 OK.
> > However I've found out now with search bots this does matter - they
> > don't know that they have a bad url for the site and are 
> indexing error
> > pages thinking they are legit.
> >
> > Any thoughts on what I may be over looking?
> >
> > Thanks,
> > Mike
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> 

From dpopowich at mtrsd.k12.ma.us  Tue Dec 23 10:08:13 2003
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Fri Jan  9 22:04:30 2004
Subject: [mod_python] default Session timeout
Message-ID: <16360.23133.264930.249115@gargle.gargle.HOWL>


In mod_python.Session the default timeout is set like this:

  DFT_TIMEOUT=30*60*60 # 30 min

That's 30 hours, not minutes.  :-)

------------------
Daniel Popowich
Network Specialist
-------------------------------------
Mohawk Trail Regional School District
24 Ashfield Rd.
Shelburne Falls, MA 01370
413.625.0192 x22
-------------------------------------

From pkeshishian at yahoo.com  Tue Dec 23 12:16:17 2003
From: pkeshishian at yahoo.com (Petros Keshishian)
Date: Fri Jan  9 22:04:30 2004
Subject: [mod_python] displaying python output
Message-ID: <20031223201617.97907.qmail@web40015.mail.yahoo.com>

I am trying to setup mod_python for the first time and
everything seems to be working, except instead of
displaying the output from mod_python in clients
browser it is asking for the file name to save the
output. If you save the output it is exactly what it
was supposed to display. Here is the famous hello.py
that I am using to test the setup.

def say(req,what="Nothing"):
    return "I am saying %s" % what

It is in /usr/local/apache2/htdocs/py-bin/ directory.
The following is set in the http.conf file:

<Directory "/usr/local/apache2/htdocs/py-bin">
                                                      
                                                      
   
    SetHandler python-program
    PythonHandler mod_python.publisher
    PythonDebug On
                                                      
                                                      
   
</Directory>

I am trying to access hello/say using:

http://localhost/py-bin/hello/say

How do I change the output to be directed to the
browser instead of a file.

Thanks a lot for your help
Petros



__________________________________
Do you Yahoo!?
New Yahoo! Photos - easier uploading and sharing.
http://photos.yahoo.com/
From michael at dynamine.net  Tue Dec 23 12:26:52 2003
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 22:04:30 2004
Subject: [mod_python] displaying python output
In-Reply-To: <20031223201617.97907.qmail@web40015.mail.yahoo.com>
References: <20031223201617.97907.qmail@web40015.mail.yahoo.com>
Message-ID: <3FE8A50C.2070202@dynamine.net>

What do the HTTP response headers say the Content-Type is?

--Michael

Petros Keshishian wrote:

> I am trying to setup mod_python for the first time and
> everything seems to be working, except instead of
> displaying the output from mod_python in clients
> browser it is asking for the file name to save the
> output. If you save the output it is exactly what it
> was supposed to display. Here is the famous hello.py
> that I am using to test the setup.
> 
> def say(req,what="Nothing"):
>     return "I am saying %s" % what
> 
> It is in /usr/local/apache2/htdocs/py-bin/ directory.
> The following is set in the http.conf file:
> 
> <Directory "/usr/local/apache2/htdocs/py-bin">
>                                                       
>                                                       
>    
>     SetHandler python-program
>     PythonHandler mod_python.publisher
>     PythonDebug On
>                                                       
>                                                       
>    
> </Directory>
> 
> I am trying to access hello/say using:
> 
> http://localhost/py-bin/hello/say
> 
> How do I change the output to be directed to the
> browser instead of a file.
> 
> Thanks a lot for your help
> Petros
> 
> 
> 
> __________________________________
> Do you Yahoo!?
> New Yahoo! Photos - easier uploading and sharing.
> http://photos.yahoo.com/
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 
From greenbeard400 at yahoo.com  Wed Dec 24 11:12:54 2003
From: greenbeard400 at yahoo.com (Greenbeard)
Date: Fri Jan  9 22:04:30 2004
Subject: [mod_python] Problem on OpenBSD with Publisher Handler 
Message-ID: <20031224191254.2564.qmail@web21326.mail.yahoo.com>

I am getting this error when trying to use the
publisher handler.

Mod_python error: "PythonHandler mod_python.publisher"

Traceback (most recent call last):

  File
"/usr/local/lib/python2.2/site-packages/mod_python/apache.py",
line 332, in HandlerDispatch
    result = object(req)

  File
"/usr/local/lib/python2.2/site-packages/mod_python/publisher.py",
line 142, in handler
    if req.extension:  # this exists if we're running
in a | .ext handler

AttributeError: 'mp_request' object has no attribute
'extension'

my httpd.conf is as described in the docs:

<Directory /home/myServer/apache2/htdocs>
  AddHandler python-program .py
  PythonHandler mod_python.publisher
  PythonDebug On
</Directory>

Simple test script:

from mod_python import apache

def test(req):
    x = "Testing 123"
    return x


Any ideas?  My error log does not have anything
different than the message above.
  
I am running Apache/2.0.44, mod_python/3.0.1,
Python/2.2.1 - right now I can not upgrade any of
these .  
 

Thanks!

gb400

__________________________________
Do you Yahoo!?
Free Pop-Up Blocker - Get it now
http://companion.yahoo.com/
From hnease at midsouth.rr.com  Sat Dec 27 15:51:29 2003
From: hnease at midsouth.rr.com (Howard Nease)
Date: Fri Jan  9 22:04:30 2004
Subject: [mod_python] 
	Win32 Binary Error: "*** run_installscript: internal error
	0xFFFFFFFF ***"
Message-ID: <000801c3ccc3$95d9e500$a000a8c0@stephen>

Hello, all. I recently tried to install mod_python on my Windows XP Home machine, and I got the above error. Here's the context:

Traceback (most recent call last):
  File "E:\Python23\Scripts\win32_postinstall.py", line 90, in ?
    shutil.copy2(mp, os.path.join(apachedir, "modules"))
  File "E:\Python23\Lib\shutil.py", line 82, in copy2
    copyfile(src, dst)
  File "E:\Python23\Lib\shutil.py", line 38, in copyfile
    fdst = open(dst, 'wb')
IOError: [Errno 13] Permission denied: 'E:/Program Files/Apache Group/Apache2\\modules\\mod_python.so'
*** run_installscript: internal error 0xFFFFFFFF ***

Does anyone have a clue as to what I'm doing wrong? I've Googled for a clue, but no dice. Thanks a lot!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20031227/d7569fac/attachment-0003.htm
From RussLear314 at yahoo.com  Sat Dec 27 19:44:55 2003
From: RussLear314 at yahoo.com (Russell Lear)
Date: Fri Jan  9 22:04:30 2004
Subject: [mod_python] Session unable to acquire mutex lock?
Message-ID: <200312271944.55425.RussLear314@yahoo.com>

Hi,

I'm a newbie to mod_python so forgive me if this is a terribly obvious
question (I've looked through the archives without much success).

I'm trying to use sessions.  Right now I have a slightly modified version
of mptest.py as follows (it doesn't make sense, but it does show my
problem):

    from mod_python import apache, Session
    import sys

    def handler(req):
        req.content_type = 'text/plain'
        req.write("Creating...\n")
        sess = Session.Session(req)
        req.write("Hello World!")
        return apache.OK

When I run it, I see:

     Mod_python error: "PythonHandler mptest"

     Traceback (most recent call last):

       File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 338, in HandlerDispatch
         result = object(req)

       File "/srv/www/htdocs/test/mptest.py", line 7, in handler
         sess = Session.Session(req)

       File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 411, in Session
         timeout=timeout)

       File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 316, in __init__
         secret=secret, timeout=timeout)

       File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 170, in __init__
         self.lock()                 # lock new sid

       File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 241, in lock
         _apache._global_lock(self._req.server, self._sid)

     ValueError: Failed to acquire global mutex lock


What am I doing wrong here?!

Thanks for any suggestions,
Russell.

PS:

I'm running on SuSE 9.0 Linux.

Python reports version "Python 2.3+ (#1, Sep 23 2003, 23:07:16)".

>From the Apache error page: 
    Apache/2.0.48 (Linux/SuSE), 
    mod_python/3.1.2b 
    Python/2.3+.

The only glitch I had in building mod_python was that I needed to specify 
    ./configure --with-apxs=/usr/sbin/apxs2

rather than just refering to apxs.

My apache configuration is (from the tutorial):
<Directory /srv/www/htdocs/test> 
  AddHandler python-program .py
  PythonHandler mptest 
  PythonDebug On 
</Directory>



From div at newcode.se  Sun Dec 28 18:52:53 2003
From: div at newcode.se (Carl-Johan Kihlbom)
Date: Fri Jan  9 22:04:30 2004
Subject: [mod_python] mod_python not working on Mac OS X 10.3
Message-ID: <A9026A4E-395E-11D8-982D-000A9599FB7E@newcode.se>

Hi list,

I've installed mod_python on my Mac, but can't get it working. When I  
restart Apache after configuring httpd.conf I get the following error:

Syntax error on line 276 of /Library/Apache2/conf/httpd.conf:
Cannot load /Library/Apache2/modules/mod_python.so into server: dyld:  
/Library/Apache2/bin/httpd Undefined symbols:
_PyExc_AttributeError
_PyExc_IOError
_PyExc_IndexError
_PyExc_KeyError
_PyExc_RuntimeError
_PyExc_StopIteration
_PyExc_TypeError
_PyExc_ValueError
_PyInt_Type
_PyList_Type
_PyObject_GenericGetAttr
_PyObject_GenericSetAttr
_PyString_Type
_PyType_Type
_Py_OptimizeFlag
__Py_NoneStruct
__Py_NotImplementedStruct

I'm using mod_python 3.1.2b on my laptop running Apache 2.0.48 and Mac  
OS X 10.3.2.

In Mac OS X 10.3, Python 2.3 is installed by default, and the library  
and include files are in  
/System/Library/Frameworks/Python.framework/Versions/2.3/lib/python2.3/  
and  
/System/Library/Frameworks/Python.framework/Versions/2.3/include/ 
python2.3/ respectively. I created symlinks to these at /usr/lib/python  
and /usr/include/python.

Any ideas what I did wrong?

TIA,

Carl-Johan Kihlbom

From grisha at modpython.org  Sun Dec 28 13:28:12 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:04:30 2004
Subject: [mod_python] Session unable to acquire mutex lock?
In-Reply-To: <200312271944.55425.RussLear314@yahoo.com>
References: <200312271944.55425.RussLear314@yahoo.com>
Message-ID: <20031228132058.S70904@onyx.ispol.com>


If you restart the server, and try this code, does the error happen on the
first hit, or only starting with the second and after waiting for a while?

If if it's the former, then there probably is some problem with locking in
general (are there any warning messages on server startup?). If it's
latter, then the session does not get unlocked properly. It should get
unlocked when the sess object goes out of scope (and looking at your code
it should), but perhpas try unlocking it manually (sess.unlock()) and see
if this fixes the problem.

Grisha

On Sat, 27 Dec 2003, Russell Lear wrote:

> Hi,
>
> I'm a newbie to mod_python so forgive me if this is a terribly obvious
> question (I've looked through the archives without much success).
>
> I'm trying to use sessions.  Right now I have a slightly modified version
> of mptest.py as follows (it doesn't make sense, but it does show my
> problem):
>
>     from mod_python import apache, Session
>     import sys
>
>     def handler(req):
>         req.content_type = 'text/plain'
>         req.write("Creating...\n")
>         sess = Session.Session(req)
>         req.write("Hello World!")
>         return apache.OK
>
> When I run it, I see:
>
>      Mod_python error: "PythonHandler mptest"
>
>      Traceback (most recent call last):
>
>        File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 338, in HandlerDispatch
>          result = object(req)
>
>        File "/srv/www/htdocs/test/mptest.py", line 7, in handler
>          sess = Session.Session(req)
>
>        File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 411, in Session
>          timeout=timeout)
>
>        File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 316, in __init__
>          secret=secret, timeout=timeout)
>
>        File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 170, in __init__
>          self.lock()                 # lock new sid
>
>        File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 241, in lock
>          _apache._global_lock(self._req.server, self._sid)
>
>      ValueError: Failed to acquire global mutex lock
>
>
> What am I doing wrong here?!
>
> Thanks for any suggestions,
> Russell.
>
> PS:
>
> I'm running on SuSE 9.0 Linux.
>
> Python reports version "Python 2.3+ (#1, Sep 23 2003, 23:07:16)".
>
> >From the Apache error page:
>     Apache/2.0.48 (Linux/SuSE),
>     mod_python/3.1.2b
>     Python/2.3+.
>
> The only glitch I had in building mod_python was that I needed to specify
>     ./configure --with-apxs=/usr/sbin/apxs2
>
> rather than just refering to apxs.
>
> My apache configuration is (from the tutorial):
> <Directory /srv/www/htdocs/test>
>   AddHandler python-program .py
>   PythonHandler mptest
>   PythonDebug On
> </Directory>
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From mark at gsoa.net  Sun Dec 28 16:07:22 2003
From: mark at gsoa.net (Mark McClain)
Date: Fri Jan  9 22:04:30 2004
Subject: [mod_python] mod_python not working on Mac OS X 10.3
In-Reply-To: <A9026A4E-395E-11D8-982D-000A9599FB7E@newcode.se>
References: <A9026A4E-395E-11D8-982D-000A9599FB7E@newcode.se>
Message-ID: <D434E9D8-3979-11D8-BDD5-000A95B33D28@gsoa.net>

Here is what I use to build on 10.3.2:

1) Build and install apache2

2) Unpack the mod_python distribution

3) make the following changes to the configure script. here it is in  
modified form...

if test "$PyFRAMEWORKDIR" != "no-framework"; then
   if test -n "$PyFRAMEWORK"; then
     PyPYTHONLIBS="-framework $PyFRAMEWORK"

    # explicitly pass to mac linker so add this line
     LDFLAGS="${LDFLAGS} -Wl,-framework,Python"
   fi

4) run configure, make, then install

Good luck,
mark

On Dec 28, 2003, at 12:52 PM, Carl-Johan Kihlbom wrote:

> Hi list,
>
> I've installed mod_python on my Mac, but can't get it working. When I  
> restart Apache after configuring httpd.conf I get the following error:
>
> Syntax error on line 276 of /Library/Apache2/conf/httpd.conf:
> Cannot load /Library/Apache2/modules/mod_python.so into server: dyld:  
> /Library/Apache2/bin/httpd Undefined symbols:
> _PyExc_AttributeError
> _PyExc_IOError
> _PyExc_IndexError
> _PyExc_KeyError
> _PyExc_RuntimeError
> _PyExc_StopIteration
> _PyExc_TypeError
> _PyExc_ValueError
> _PyInt_Type
> _PyList_Type
> _PyObject_GenericGetAttr
> _PyObject_GenericSetAttr
> _PyString_Type
> _PyType_Type
> _Py_OptimizeFlag
> __Py_NoneStruct
> __Py_NotImplementedStruct
>
> I'm using mod_python 3.1.2b on my laptop running Apache 2.0.48 and Mac  
> OS X 10.3.2.
>
> In Mac OS X 10.3, Python 2.3 is installed by default, and the library  
> and include files are in  
> /System/Library/Frameworks/Python.framework/Versions/2.3/lib/ 
> python2.3/ and  
> /System/Library/Frameworks/Python.framework/Versions/2.3/include/ 
> python2.3/ respectively. I created symlinks to these at  
> /usr/lib/python and /usr/include/python.
>
> Any ideas what I did wrong?
>
> TIA,
>
> Carl-Johan Kihlbom
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From RussLear314 at yahoo.com  Mon Dec 29 08:57:00 2003
From: RussLear314 at yahoo.com (Russell Lear)
Date: Fri Jan  9 22:04:30 2004
Subject: [mod_python] Session unable to acquire mutex lock?
In-Reply-To: <20031228132058.S70904@onyx.ispol.com>
References: <200312271944.55425.RussLear314@yahoo.com>
	<20031228132058.S70904@onyx.ispol.com>
Message-ID: <200312290857.00982.RussLear314@yahoo.com>

Grisha,

Thanks for the suggestions.  

I did a stop/start and the problem happens on the first hit.

I enabled some debug logging (See below).  

There are two things I notice that seem odd to my inexperienced eye: 

1) During apache's startup, mod_python says
    "Creating 32 session mutexes based on 150 max processes and 0 max threads".  
Is "0 max threads" correct, or do I have something misconfigured? 
Seems like max threads ought to be at least 1 or 2 ??

2) When I invoke my test, there is a warning
    "Permission denied: Failed to acquire global mutex lock at index 17".  
Is that just saying that it failed to get a mutex lock or do I have bad permissions someplace?

Thanks,
Russell.

====================
Apache error_log exerpt:
[... 08:30:57 ] [info] Server: Apache/2.0.48, Interface: mod_ssl/2.0.48, Library: OpenSSL/0.9.7b
[... 08:30:57 ] [notice] suEXEC mechanism enabled (wrapper: /usr/sbin/suexec2)
[... 08:31:00 ] [info] Init: Initializing OpenSSL library
[... 08:31:00 ] [info] Init: Seeding PRNG with 0 bytes of entropy
[... 08:31:00 ] [info] Init: Generating temporary RSA private keys (512/1024 bits)
[... 08:31:00 ] [info] Init: Generating temporary DH parameters (512/1024 bits)
[... 08:31:00 ] [info] Init: Initializing (virtual) servers for SSL
[... 08:31:00 ] [info] Server: Apache/2.0.48, Interface: mod_ssl/2.0.48, Library: OpenSSL/0.9.7b
[... 08:31:02 ] [notice] mod_python: Creating 32 session mutexes based on 150 max processes and 0 max threads.
[... 08:31:02 ] [notice] Apache/2.0.48 (Linux/SuSE) mod_ssl/2.0.48 OpenSSL/0.9.7b PHP/4.3.3 mod_python/3.1.2b Python/2.3+ configured -- resuming normal operations
[... 08:31:02 ] [info] Server built: Nov 10 2003 11:47:10
[... 08:31:02 ] [debug] prefork.c(1037): AcceptMutex: sysvsem (default: sysvsem)
[... 08:31:15 ] [notice] mod_python: (Re)importing module 'mptest'
[... 08:31:16 ] [warn] (13)Permission denied: Failed to acquire global mutex lock at index 17
[... 08:31:16 ] [error] [client ::1] PythonHandler mptest: Traceback (most recent call last):
[... 08:31:16 ] [error] [client ::1] PythonHandler mptest: 
    File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 338, in HandlerDispatch
    result = object(req)
[... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
    File "/srv/www/htdocs/test/mptest.py", line 7, in handler
    sess = Session.Session(req)
[... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
    File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 411, in Session
    timeout=timeout)
[... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
    File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 316, in __init__
    secret=secret, timeout=timeout)
[... 08:31:16 ] [error] [client ::1] PythonHandler mptest:   
    File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 170, in __init__
    self.lock()                 # lock new sid
[... 08:31:16 ] [error] [client ::1] PythonHandler mptest:   
    File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 241, in lock
    _apache._global_lock(self._req.server, self._sid)
[... 08:31:16 ] [error] [client ::1] PythonHandler mptest: 
    ValueError: Failed to acquire global mutex lock

====================

On Sunday 28 December 2003 10:28, Gregory (Grisha) Trubetskoy wrote:
> If you restart the server, and try this code, does the error happen on the
> first hit, or only starting with the second and after waiting for a while?
>
> If if it's the former, then there probably is some problem with locking in
> general (are there any warning messages on server startup?). ...
>
> Grisha
>
> On Sat, 27 Dec 2003, Russell Lear wrote:
> > Hi,
> >
> > [RLear: 2003/12/29: deleted text to avoid overly long attachment]
> >
> >     from mod_python import apache, Session
> >     import sys
> >
> >     def handler(req):
> >         req.content_type = 'text/plain'
> >         req.write("Creating...\n")
> >         sess = Session.Session(req)
> >         req.write("Hello World!")
> >         return apache.OK
> >
> >  [RLear: 2003/12/29: deleted text to avoid overly long attachment]
> >
> > I'm running on SuSE 9.0 Linux.
> >
> > Python reports version "Python 2.3+ (#1, Sep 23 2003, 23:07:16)".
> >
> > >From the Apache error page:
> >
> >     Apache/2.0.48 (Linux/SuSE),
> >     mod_python/3.1.2b
> >     Python/2.3+.
> >
> > The only glitch I had in building mod_python was that I needed to specify
> >     ./configure --with-apxs=/usr/sbin/apxs2
> >
> > rather than just refering to apxs.
> >
> > My apache configuration is (from the tutorial):
> > <Directory /srv/www/htdocs/test>
> >   AddHandler python-program .py
> >   PythonHandler mptest
> >   PythonDebug On
> > </Directory>
> >
> >
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python

From div at newcode.se  Mon Dec 29 17:55:44 2003
From: div at newcode.se (Carl-Johan Kihlbom)
Date: Fri Jan  9 22:04:30 2004
Subject: [mod_python] mod_python not working on Mac OS X 10.3
In-Reply-To: <D434E9D8-3979-11D8-BDD5-000A95B33D28@gsoa.net>
References: <A9026A4E-395E-11D8-982D-000A9599FB7E@newcode.se>
	<D434E9D8-3979-11D8-BDD5-000A95B33D28@gsoa.net>
Message-ID: <D7CFFAED-3A1F-11D8-8995-000A9599FB7E@newcode.se>

That got me a bit further, thanks, but I still can't get it to work.  
I've followed the testing procedures in the manual by setting  
AllowOverride All in httpd.conf and creating a .htaccess file in  
htdocs/test with the following content:

AddHandler python-program .py
PythonHandler mptest
PythonDebug On

I then created a file mptest.py in the same directory. It looks like  
this:

from mod_python import apache

def handler(req):
     req.write("Hello World!")
     return apache.OK

When I try to access http://localhost/test/mptest.py I get a 500  
Internal Server Error. No additional information in the access or error  
log.

Any ideas what's wrong this time? :-)

Thanks again,

Carl-Johan Kihlbom

On Dec 28, 2003, at 22:07, Mark McClain wrote:

> Here is what I use to build on 10.3.2:
>
> 1) Build and install apache2
>
> 2) Unpack the mod_python distribution
>
> 3) make the following changes to the configure script. here it is in  
> modified form...
>
> if test "$PyFRAMEWORKDIR" != "no-framework"; then
>   if test -n "$PyFRAMEWORK"; then
>     PyPYTHONLIBS="-framework $PyFRAMEWORK"
>
>    # explicitly pass to mac linker so add this line
>     LDFLAGS="${LDFLAGS} -Wl,-framework,Python"
>   fi
>
> 4) run configure, make, then install
>
> Good luck,
> mark
>
> On Dec 28, 2003, at 12:52 PM, Carl-Johan Kihlbom wrote:
>
>> Hi list,
>>
>> I've installed mod_python on my Mac, but can't get it working. When I  
>> restart Apache after configuring httpd.conf I get the following  
>> error:
>>
>> Syntax error on line 276 of /Library/Apache2/conf/httpd.conf:
>> Cannot load /Library/Apache2/modules/mod_python.so into server: dyld:  
>> /Library/Apache2/bin/httpd Undefined symbols:
>> _PyExc_AttributeError
>> _PyExc_IOError
>> _PyExc_IndexError
>> _PyExc_KeyError
>> _PyExc_RuntimeError
>> _PyExc_StopIteration
>> _PyExc_TypeError
>> _PyExc_ValueError
>> _PyInt_Type
>> _PyList_Type
>> _PyObject_GenericGetAttr
>> _PyObject_GenericSetAttr
>> _PyString_Type
>> _PyType_Type
>> _Py_OptimizeFlag
>> __Py_NoneStruct
>> __Py_NotImplementedStruct
>>
>> I'm using mod_python 3.1.2b on my laptop running Apache 2.0.48 and  
>> Mac OS X 10.3.2.
>>
>> In Mac OS X 10.3, Python 2.3 is installed by default, and the library  
>> and include files are in  
>> /System/Library/Frameworks/Python.framework/Versions/2.3/lib/ 
>> python2.3/ and  
>> /System/Library/Frameworks/Python.framework/Versions/2.3/include/ 
>> python2.3/ respectively. I created symlinks to these at  
>> /usr/lib/python and /usr/include/python.
>>
>> Any ideas what I did wrong?
>>
>> TIA,
>>
>> Carl-Johan Kihlbom

From grisha at modpython.org  Mon Dec 29 16:54:57 2003
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:04:30 2004
Subject: [mod_python] Session unable to acquire mutex lock?
In-Reply-To: <200312290857.00982.RussLear314@yahoo.com>
References: <200312271944.55425.RussLear314@yahoo.com>
	<20031228132058.S70904@onyx.ispol.com>
	<200312290857.00982.RussLear314@yahoo.com>
Message-ID: <20031229165250.V88187@onyx.ispol.com>


This looks like a permissions bug with System V IPC that made it into the
beta. Try running one of the latest CVS snapshots, I think it is fixed
there.

Grisha

On Mon, 29 Dec 2003, Russell Lear wrote:

> Grisha,
>
> Thanks for the suggestions.
>
> I did a stop/start and the problem happens on the first hit.
>
> I enabled some debug logging (See below).
>
> There are two things I notice that seem odd to my inexperienced eye:
>
> 1) During apache's startup, mod_python says
>     "Creating 32 session mutexes based on 150 max processes and 0 max threads".
> Is "0 max threads" correct, or do I have something misconfigured?
> Seems like max threads ought to be at least 1 or 2 ??
>
> 2) When I invoke my test, there is a warning
>     "Permission denied: Failed to acquire global mutex lock at index 17".
> Is that just saying that it failed to get a mutex lock or do I have bad permissions someplace?
>
> Thanks,
> Russell.
>
> ====================
> Apache error_log exerpt:
> [... 08:30:57 ] [info] Server: Apache/2.0.48, Interface: mod_ssl/2.0.48, Library: OpenSSL/0.9.7b
> [... 08:30:57 ] [notice] suEXEC mechanism enabled (wrapper: /usr/sbin/suexec2)
> [... 08:31:00 ] [info] Init: Initializing OpenSSL library
> [... 08:31:00 ] [info] Init: Seeding PRNG with 0 bytes of entropy
> [... 08:31:00 ] [info] Init: Generating temporary RSA private keys (512/1024 bits)
> [... 08:31:00 ] [info] Init: Generating temporary DH parameters (512/1024 bits)
> [... 08:31:00 ] [info] Init: Initializing (virtual) servers for SSL
> [... 08:31:00 ] [info] Server: Apache/2.0.48, Interface: mod_ssl/2.0.48, Library: OpenSSL/0.9.7b
> [... 08:31:02 ] [notice] mod_python: Creating 32 session mutexes based on 150 max processes and 0 max threads.
> [... 08:31:02 ] [notice] Apache/2.0.48 (Linux/SuSE) mod_ssl/2.0.48 OpenSSL/0.9.7b PHP/4.3.3 mod_python/3.1.2b Python/2.3+ configured -- resuming normal operations
> [... 08:31:02 ] [info] Server built: Nov 10 2003 11:47:10
> [... 08:31:02 ] [debug] prefork.c(1037): AcceptMutex: sysvsem (default: sysvsem)
> [... 08:31:15 ] [notice] mod_python: (Re)importing module 'mptest'
> [... 08:31:16 ] [warn] (13)Permission denied: Failed to acquire global mutex lock at index 17
> [... 08:31:16 ] [error] [client ::1] PythonHandler mptest: Traceback (most recent call last):
> [... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
>     File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 338, in HandlerDispatch
>     result = object(req)
> [... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
>     File "/srv/www/htdocs/test/mptest.py", line 7, in handler
>     sess = Session.Session(req)
> [... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
>     File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 411, in Session
>     timeout=timeout)
> [... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
>     File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 316, in __init__
>     secret=secret, timeout=timeout)
> [... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
>     File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 170, in __init__
>     self.lock()                 # lock new sid
> [... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
>     File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 241, in lock
>     _apache._global_lock(self._req.server, self._sid)
> [... 08:31:16 ] [error] [client ::1] PythonHandler mptest:
>     ValueError: Failed to acquire global mutex lock
>
> ====================
>
> On Sunday 28 December 2003 10:28, Gregory (Grisha) Trubetskoy wrote:
> > If you restart the server, and try this code, does the error happen on the
> > first hit, or only starting with the second and after waiting for a while?
> >
> > If if it's the former, then there probably is some problem with locking in
> > general (are there any warning messages on server startup?). ...
> >
> > Grisha
> >
> > On Sat, 27 Dec 2003, Russell Lear wrote:
> > > Hi,
> > >
> > > [RLear: 2003/12/29: deleted text to avoid overly long attachment]
> > >
> > >     from mod_python import apache, Session
> > >     import sys
> > >
> > >     def handler(req):
> > >         req.content_type = 'text/plain'
> > >         req.write("Creating...\n")
> > >         sess = Session.Session(req)
> > >         req.write("Hello World!")
> > >         return apache.OK
> > >
> > >  [RLear: 2003/12/29: deleted text to avoid overly long attachment]
> > >
> > > I'm running on SuSE 9.0 Linux.
> > >
> > > Python reports version "Python 2.3+ (#1, Sep 23 2003, 23:07:16)".
> > >
> > > >From the Apache error page:
> > >
> > >     Apache/2.0.48 (Linux/SuSE),
> > >     mod_python/3.1.2b
> > >     Python/2.3+.
> > >
> > > The only glitch I had in building mod_python was that I needed to specify
> > >     ./configure --with-apxs=/usr/sbin/apxs2
> > >
> > > rather than just refering to apxs.
> > >
> > > My apache configuration is (from the tutorial):
> > > <Directory /srv/www/htdocs/test>
> > >   AddHandler python-program .py
> > >   PythonHandler mptest
> > >   PythonDebug On
> > > </Directory>
> > >
> > >
> > >
> > > _______________________________________________
> > > Mod_python mailing list
> > > Mod_python@modpython.org
> > > http://mailman.modpython.org/mailman/listinfo/mod_python
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From RussLear314 at yahoo.com  Mon Dec 29 21:00:59 2003
From: RussLear314 at yahoo.com (Russell Lear)
Date: Fri Jan  9 22:04:30 2004
Subject: [mod_python] Session unable to acquire mutex lock?
In-Reply-To: <20031229165250.V88187@onyx.ispol.com>
References: <200312271944.55425.RussLear314@yahoo.com>
	<200312290857.00982.RussLear314@yahoo.com>
	<20031229165250.V88187@onyx.ispol.com>
Message-ID: <200312292100.59743.RussLear314@yahoo.com>

Ok!  I'm able to create a session now!

I grabbed httpd-python_20031229231518.tar.gz and things seem to work now.

Thanks a lot Grisha for your help.

Russell.


On Monday 29 December 2003 13:54, Gregory (Grisha) Trubetskoy wrote:
> This looks like a permissions bug with System V IPC that made it into the
> beta. Try running one of the latest CVS snapshots, I think it is fixed
> there.
>
> Grisha
>

From kevin at sb.org  Tue Dec 30 01:35:11 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:04:30 2004
Subject: [mod_python] mod_python not working on Mac OS X 10.3
In-Reply-To: <D7CFFAED-3A1F-11D8-8995-000A9599FB7E@newcode.se>
References: <A9026A4E-395E-11D8-982D-000A9599FB7E@newcode.se>
	<D434E9D8-3979-11D8-BDD5-000A95B33D28@gsoa.net>
	<D7CFFAED-3A1F-11D8-8995-000A9599FB7E@newcode.se>
Message-ID: <519C889B-3A92-11D8-9AD2-000A95A072FC@sb.org>

Gah, I always do this! This message was meant to go to the list.

---

I got a lot of that stuff until I stopped doing graceful restarts and 
started doing a stop, waiting for all httpd processes to die out, then 
starting it back up. That tended to fix the problem.

On Dec 29, 2003, at 11:55 AM, Carl-Johan Kihlbom wrote:

> When I try to access http://localhost/test/mptest.py I get a 500 
> Internal Server Error. No additional information in the access or 
> error log.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From pkeshishian at yahoo.com  Tue Dec 30 01:54:41 2003
From: pkeshishian at yahoo.com (Petros Keshishian)
Date: Fri Jan  9 22:04:30 2004
Subject: [mod_python] MySQLdb
Message-ID: <20031230095441.1986.qmail@web40020.mail.yahoo.com>

I would very much appreciate if anyone could resolve
my problem with MySQLdb.

I am try to run a query from mod_python as follows:

db = MySQldb.connect(db='aua', user='root')
c = db.cursor()
c.execute('select fname,lname,gyear from addrbk')

The program freezes at the last (3rd) line. The same
code works fine if I run it from python shell
directly. 
The code even works in mod_python if I query for less
than 3 column, e.g.

c.execute('select fname,lname from addrbk')
or
c.execute('select lname, gyear from addrbk')

Can anybody tell me what's going on?

Thank you for your help,
Petros







__________________________________
Do you Yahoo!?
Find out what made the Top Yahoo! Searches of 2003
http://search.yahoo.com/top2003
From neel at mediapulse.com  Tue Dec 30 11:08:45 2003
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:04:30 2004
Subject: [mod_python] MySQLdb
Message-ID: <C0FC22C08B82074A88B50061764157776B991B@johnson.mediapulse.net>

Do you have PythonDebug On in your conf to see any traceback errors?
They should also be in your error log as well, even if debug is off.  If
they don't answer your questions, forward those on they will help in
seeing the problem.

Thanks,
Mike


> -----Original Message-----
> From: Petros Keshishian [mailto:pkeshishian@yahoo.com] 
> Sent: Tuesday, December 30, 2003 4:55 AM
> To: mod_python@modpython.org
> Subject: [mod_python] MySQLdb
> 
> 
> I would very much appreciate if anyone could resolve
> my problem with MySQLdb.
> 
> I am try to run a query from mod_python as follows:
> 
> db = MySQldb.connect(db='aua', user='root')
> c = db.cursor()
> c.execute('select fname,lname,gyear from addrbk')
> 
> The program freezes at the last (3rd) line. The same
> code works fine if I run it from python shell
> directly. 
> The code even works in mod_python if I query for less
> than 3 column, e.g.
> 
> c.execute('select fname,lname from addrbk')
> or
> c.execute('select lname, gyear from addrbk')
> 
> Can anybody tell me what's going on?
> 
> Thank you for your help,
> Petros
> 
> 
> 
> 
> 
> 
> 
> __________________________________
> Do you Yahoo!?
> Find out what made the Top Yahoo! Searches of 2003
> http://search.yahoo.com/top2003
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

From pkeshishian at yahoo.com  Tue Dec 30 09:13:18 2003
From: pkeshishian at yahoo.com (Petros Keshishian)
Date: Fri Jan  9 22:04:30 2004
Subject: [mod_python] MySQLdb
In-Reply-To: <C0FC22C08B82074A88B50061764157776B991B@johnson.mediapulse.net>
Message-ID: <20031230171318.10032.qmail@web40015.mail.yahoo.com>

I do have PythonDebud On, but it does not report any
errors. The error log has the following:

[Tue Dec 30 09:07:16 2003] [notice] mod_python:
(Re)importing module 'pyhndlr' with path set to
'['/usr/local/apache2/htdocs/auaweb/frm_address']'
[Tue Dec 30 09:07:16 2003] [notice] child pid 4161
exit signal Segmentation fault (11)

pyhndlr.py is the file where the code resides. I hope
you know what this segmentation fault could be.

Thanks,
Petros


--- "Michael C. Neel" <neel@mediapulse.com> wrote:
> Do you have PythonDebug On in your conf to see any
> traceback errors?
> They should also be in your error log as well, even
> if debug is off.  If
> they don't answer your questions, forward those on
> they will help in
> seeing the problem.
> 
> Thanks,
> Mike
> 
> 
> > -----Original Message-----
> > From: Petros Keshishian
> [mailto:pkeshishian@yahoo.com] 
> > Sent: Tuesday, December 30, 2003 4:55 AM
> > To: mod_python@modpython.org
> > Subject: [mod_python] MySQLdb
> > 
> > 
> > I would very much appreciate if anyone could
> resolve
> > my problem with MySQLdb.
> > 
> > I am try to run a query from mod_python as
> follows:
> > 
> > db = MySQldb.connect(db='aua', user='root')
> > c = db.cursor()
> > c.execute('select fname,lname,gyear from addrbk')
> > 
> > The program freezes at the last (3rd) line. The
> same
> > code works fine if I run it from python shell
> > directly. 
> > The code even works in mod_python if I query for
> less
> > than 3 column, e.g.
> > 
> > c.execute('select fname,lname from addrbk')
> > or
> > c.execute('select lname, gyear from addrbk')
> > 
> > Can anybody tell me what's going on?
> > 
> > Thank you for your help,
> > Petros
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > __________________________________
> > Do you Yahoo!?
> > Find out what made the Top Yahoo! Searches of 2003
> > http://search.yahoo.com/top2003
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> >
>
http://mailman.modpython.org/mailman/listinfo/mod_python
> > 


__________________________________
Do you Yahoo!?
Find out what made the Top Yahoo! Searches of 2003
http://search.yahoo.com/top2003
From pkeshishian at yahoo.com  Tue Dec 30 10:20:40 2003
From: pkeshishian at yahoo.com (Petros Keshishian)
Date: Fri Jan  9 22:04:30 2004
Subject: [mod_python] MySQLdb
In-Reply-To: <1072769149.20927.1.camel@inspiration.x.eradman.com>
Message-ID: <20031230182040.81782.qmail@web40008.mail.yahoo.com>

Eric:
 
I have put req.write() statements before and after the execute() function like this:
 
db = MySQldb.connect(db='aua', user='root')
c = db.cursor()
req.content_type = "text/plain"
req.write("Before Execute\n")
c.execute('select fname,lname,gyear from addrbk')
req.write("After Execute\n")
 
When I point the browser to this function I see:
Before Execute
 
And nothing else. No error messages even though I have PythonDebug On. As I already sent in my previous e-mail there is a segmentation fault reported in error log.
 
What's surprising is that it works fine if I query for any two columns instead of three.
 
Thanks for your help,
Petros


Eric Radman <theman@eradman.com> wrote:
Petros,

Are you saying that it won't run ANYTHING after the execute() function?

Eric Radman
theman@eradman.com

On Tue, 2003-12-30 at 09:54, Petros Keshishian wrote:
> I would very much appreciate if anyone could resolve
> my problem with MySQLdb.
> 
> I am try to run a query from mod_python as follows:
> 
> db = MySQldb.connect(db='aua', user='root')
> c = db.cursor()
> c.execute('select fname,lname,gyear from addrbk')
> 
> The program freezes at the last (3rd) line. The same
> code works fine if I run it from python shell
> directly. 
> The code even works in mod_python if I query for less
> than 3 column, e.g.
> 
> c.execute('select fname,lname from addrbk')
> or
> c.execute('select lname, gyear from addrbk')
> 
> Can anybody tell me what's going on?
> 
> Thank you for your help,
> Petros
> 
> 
> 
> 
> 
> 
> 
> __________________________________
> Do you Yahoo!?
> Find out what made the Top Yahoo! Searches of 2003
> http://search.yahoo.com/top2003
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python


---------------------------------
Do you Yahoo!?
Find out what made the Top Yahoo! Searches of 2003
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20031230/06304ebd/attachment-0003.htm
From redconectabilbao at telefonica.net  Wed Dec 31 10:57:31 2003
From: redconectabilbao at telefonica.net (Red Conecta)
Date: Fri Jan  9 22:04:30 2004
Subject: [mod_python] mod_python and css
Message-ID: <3FF29D8B.6030208@telefonica.net>

I'm trying to use css with the publisherhandler; here is the code:

    def _inicio():
        ini= '''<head><title>nombredelsitio</title>
                  <link rel="stylesheet" href="estilo.css"
    Type="text/css"></head>
                  <body leftmargin=0 rightmargin=0 topmargin=0
    bottommargin=0>'''
       
        return ini

    def _final():
        return '</body></html>'

    def mostrar(req,direccion='/'):
        req.content_type = "text/html"
        html=_inicio()
        obj=leerobjeto(direccion)
        if obj!=None:
            for i in obj.__dict__:html+=i+': '+obj.__dict__[i]+'<br>'
        else:html+='error'
        html+=_final()
        return html

the output doesn't use the estilo.css archive but if I save the page in 
'mostrar.html' all is ok.

From sgillies at frii.com  Wed Dec 31 07:42:41 2003
From: sgillies at frii.com (Sean Gillies)
Date: Fri Jan  9 22:04:30 2004
Subject: [mod_python] mod_python and css
In-Reply-To: <3FF29D8B.6030208@telefonica.net>
References: <3FF29D8B.6030208@telefonica.net>
Message-ID: <960A9AF8-3B9F-11D8-9527-000393B98B56@frii.com>

On Dec 31, 2003, at 2:57 AM, Red Conecta wrote:

> I'm trying to use css with the publisherhandler; here is the code:
>
>    def _inicio():
>        ini= '''<head><title>nombredelsitio</title>
>                  <link rel="stylesheet" href="estilo.css"
>    Type="text/css"></head>
>                  <body leftmargin=0 rightmargin=0 topmargin=0
>    bottommargin=0>'''
>              return ini
>
>    def _final():
>        return '</body></html>'
>
>    def mostrar(req,direccion='/'):
>        req.content_type = "text/html"
>        html=_inicio()
>        obj=leerobjeto(direccion)
>        if obj!=None:
>            for i in obj.__dict__:html+=i+': '+obj.__dict__[i]+'<br>'
>        else:html+='error'
>        html+=_final()
>        return html
>
> the output doesn't use the estilo.css archive but if I save the page 
> in 'mostrar.html' all is ok.
>

Try "../estilo.css", this will link to the stylesheet in the same
location as the published module.

cheers,
Sean

--
Sean Gillies
sgillies at frii dot com
http://users.frii.com/sgillies

From kevin at sb.org  Wed Dec 31 15:18:58 2003
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:04:30 2004
Subject: [mod_python] mod_python and css
In-Reply-To: <3FF29D8B.6030208@telefonica.net>
References: <3FF29D8B.6030208@telefonica.net>
Message-ID: <9089E1A9-3BCE-11D8-9AD2-000A95A072FC@sb.org>

That's because with this handler, your URL looks something like

http://my.domain.com/myScript/mostrar

so when you access "estilo.css", the requested URL is

/myScript/estilo.css

However, your script doesn't handle estilo.css, since that's actually a 
file in the same directory as myScript. If you replace the script with 
mostrar.html, then estilo.css is accessed as

/estilo.css

instead, since the myScript path segment is now gone.

The solution is to put "../estilo.css" as your CSS href.

P.S. Why does this list use a Reply-To for the original sender rather 
than for the list itself? I keep sending mail to individual people when 
I mean to simply reply to the list itself.

On Dec 31, 2003, at 4:57 AM, Red Conecta wrote:

> I'm trying to use css with the publisherhandler; here is the code:
>
>    def _inicio():
>        ini= '''<head><title>nombredelsitio</title>
>                  <link rel="stylesheet" href="estilo.css"
>    Type="text/css"></head>
>                  <body leftmargin=0 rightmargin=0 topmargin=0
>    bottommargin=0>'''
>              return ini
>
>    def _final():
>        return '</body></html>'
>
>    def mostrar(req,direccion='/'):
>        req.content_type = "text/html"
>        html=_inicio()
>        obj=leerobjeto(direccion)
>        if obj!=None:
>            for i in obj.__dict__:html+=i+': '+obj.__dict__[i]+'<br>'
>        else:html+='error'
>        html+=_final()
>        return html
>
> the output doesn't use the estilo.css archive but if I save the page 
> in 'mostrar.html' all is ok.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

