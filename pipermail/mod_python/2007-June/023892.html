<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] get post to a class
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20get%20post%20to%20a%20class&In-Reply-To=227f6fed0706211835t5b556b74y9e60ba74d4abdf4b%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023890.html">
   <LINK REL="Next"  HREF="023893.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] get post to a class</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20get%20post%20to%20a%20class&In-Reply-To=227f6fed0706211835t5b556b74y9e60ba74d4abdf4b%40mail.gmail.com"
       TITLE="[mod_python] get post to a class">graham.dumpleton at gmail.com
       </A><BR>
    <I>Thu Jun 21 21:52:22 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="023890.html">[mod_python] get post to a class
</A></li>
        <LI>Next message: <A HREF="023893.html">[mod_python] get post to a class
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23892">[ date ]</a>
              <a href="thread.html#23892">[ thread ]</a>
              <a href="subject.html#23892">[ subject ]</a>
              <a href="author.html#23892">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 22/06/07, maker joe &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">makerjoe at gmail.com</A>&gt; wrote:
&gt;<i> perhaps a little bit simpler would be
</I>&gt;<i>
</I>&gt;<i> go.py
</I>&gt;<i> -------
</I>&gt;<i> import myclasses
</I>&gt;<i> c=dispatch()
</I>&gt;<i> c.message(req)
</I>&gt;<i>
</I>&gt;<i> myclasses.py
</I>&gt;<i> --------------------
</I>&gt;<i> class dispatch:
</I>&gt;<i>     def message(self,req)
</I>&gt;<i>          req.write('hello %s'%req.form['name'])
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://localhost/my.py/go?name=joe">http://localhost/my.py/go?name=joe</A>
</I>
I don't see how that will work at all. At least not if you are using
publisher. If you have instead written your own handler which performs
its own URL dispatch then maybe it may work, but I don't know how your
dispatcher works.

If I try and read into your code as to what you perhaps meant, there
is a big difference in that with the approach I was suggested, there
would be a separate instance of the class per request. In your code,
by creating the instance at global scope within the module there will
be one instance for the life of the process and all requests will be
handled within that once instance. The consequences of using a single
instance are that class attributes can't be used for transient data
for a single request where one wants to use that as a means of
communicating data between member functions.

What you really need to do is explain what behaviour you want. One
class instance to be used for all requests, or one per request. For
all I know, all you were perhaps after was to know how to make a URL
traverse into objects, but your URL examples haven't been suggestive
of that.

So, maybe you should explain in english what you expect to happen.



Graham

&gt;<i> On 6/21/07, Graham Dumpleton &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">graham.dumpleton at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt; On 22/06/07, maker joe &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">makerjoe at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt; &gt; hi graham
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; is it possible to get/post to a class?
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; my.py
</I>&gt;<i> &gt; &gt; ---------
</I>&gt;<i> &gt; &gt; class A:
</I>&gt;<i> &gt; &gt;     def go(self,req):
</I>&gt;<i> &gt; &gt;          req.write('hello'+%s)%name
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; <A HREF="http://localhost/my.py/A/go?name=joe">http://localhost/my.py/A/go?name=joe</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Classes will not auto instantiate.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; If your intention is to be able to create an instance of A per
</I>&gt;<i> &gt; request, use something like:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;   class Instance:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     def __init__(self, type, **kwargs):
</I>&gt;<i> &gt;         self.__type = type
</I>&gt;<i> &gt;         self.__kwargs = kwargs
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     def __call__(self, **args):
</I>&gt;<i> &gt;         assert(type(self.__type) in [types.ClassType, types.TypeType])
</I>&gt;<i> &gt;         return self.__type(**self.__kwargs)(**args)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     class A:
</I>&gt;<i> &gt;         def __call__(self, req):
</I>&gt;<i> &gt;             req.write('hello'+%s)%name
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     go = Instance(A)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; URL would then be:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;    <A HREF="http://localhost/my.py/go?name=joe">http://localhost/my.py/go?name=joe</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; If the class has a constructor, use keyword arguments to Instance() to
</I>&gt;<i> &gt; pass any arguments:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     class A:
</I>&gt;<i> &gt;         def __init__(self, arg1, arg2):
</I>&gt;<i> &gt;             ...
</I>&gt;<i> &gt;         def __call__(self, req):
</I>&gt;<i> &gt;             req.write('hello'+%s)%name
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     go = Instance(A, arg1='value', arg2='value')
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; This presumes you are using publisher.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Graham
</I>&gt;<i> &gt;
</I>&gt;<i>
</I></PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023890.html">[mod_python] get post to a class
</A></li>
	<LI>Next message: <A HREF="023893.html">[mod_python] get post to a class
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23892">[ date ]</a>
              <a href="thread.html#23892">[ thread ]</a>
              <a href="subject.html#23892">[ subject ]</a>
              <a href="author.html#23892">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
