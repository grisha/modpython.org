<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] psp import issue
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20psp%20import%20issue&In-Reply-To=88e286470706211745g59cea45cj67edc99dc26139e3%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023884.html">
   <LINK REL="Next"  HREF="023888.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] psp import issue</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20psp%20import%20issue&In-Reply-To=88e286470706211745g59cea45cj67edc99dc26139e3%40mail.gmail.com"
       TITLE="[mod_python] psp import issue">graham.dumpleton at gmail.com
       </A><BR>
    <I>Thu Jun 21 20:57:23 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="023884.html">[mod_python] psp import issue
</A></li>
        <LI>Next message: <A HREF="023888.html">[mod_python] psp import issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23885">[ date ]</a>
              <a href="thread.html#23885">[ thread ]</a>
              <a href="subject.html#23885">[ subject ]</a>
              <a href="author.html#23885">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 22/06/07, Graham Dumpleton &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">graham.dumpleton at gmail.com</A>&gt; wrote:
&gt;<i> &gt; and
</I>&gt;<i> &gt; req.form['varx']  by _varx
</I>&gt;<i>
</I>&gt;<i> Don't recommend pushing form fields in local name space as doesn't
</I>&gt;<i> make it as obvious that it is a form field and there would be a
</I>&gt;<i> tendency not to perform checks to make sure the field you are looking
</I>&gt;<i> for actually exists. Also, it will all possibly blow up if someone
</I>&gt;<i> supplied a field you weren't expecting which replaced some important
</I>&gt;<i> data or clashed with a keyword.
</I>&gt;<i>
</I>&gt;<i> If you really must do something like that though, you might adapt the
</I>&gt;<i> following code from mod_python.util.apply_fs_data(). Replace 'fs' with
</I>&gt;<i> req.form and replace args with locals().
</I>&gt;<i>
</I>&gt;<i>     # add form data to args
</I>&gt;<i>     for field in fs.list:
</I>&gt;<i>         if field.filename:
</I>&gt;<i>             val = field
</I>&gt;<i>         else:
</I>&gt;<i>             val = field.value
</I>&gt;<i>         args.setdefault(field.name, []).append(val)
</I>&gt;<i>
</I>&gt;<i>     # replace lists with single values
</I>&gt;<i>     for arg in args:
</I>&gt;<i>         if ((type(args[arg]) is ListType) and
</I>&gt;<i>             (len(args[arg]) == 1)):
</I>&gt;<i>             args[arg] = args[arg][0]
</I>
BTW, if using publisher, a quicker way of doing this would be:

  def func(req, arg1, args, **args):
    locals().update(args)
    ...

As I said though, this is dangerous as someone outside your web site
can directly modify data your function uses to execute or cause your
handler to crash in bad ways.

For example, with publisher function:

  def index(req, **args):
    locals().update(args)
    req.content_type = 'text/plain'
    return 'mod_python.publisher', req.filename

If URL of:

  <A HREF="http://localhost:8002/~grahamd/publisher/index.py?req=xxx">http://localhost:8002/~grahamd/publisher/index.py?req=xxx</A>

is used, I get an error saying:

  AttributeError: 'mp_request' object has no attribute 'append'

This is because I was able to replace the request object argument with
another value.

Same problem will occur if using the longer example I showed before.

Hopefully you will now be convinced this is a bad bad idea.

Graham
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023884.html">[mod_python] psp import issue
</A></li>
	<LI>Next message: <A HREF="023888.html">[mod_python] psp import issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23885">[ date ]</a>
              <a href="thread.html#23885">[ thread ]</a>
              <a href="subject.html#23885">[ subject ]</a>
              <a href="author.html#23885">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
