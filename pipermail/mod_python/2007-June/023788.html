<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Breaking things after upgrading MySQLdb (to 1.2.2)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Breaking%20things%20after%20upgrading%20MySQLdb%20%28to%201.2.2%29&In-Reply-To=7CE349CC-707C-481C-B0D7-A6C8DD605134%40ixopusada.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023787.html">
   <LINK REL="Next"  HREF="023789.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Breaking things after upgrading MySQLdb (to 1.2.2)</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Breaking%20things%20after%20upgrading%20MySQLdb%20%28to%201.2.2%29&In-Reply-To=7CE349CC-707C-481C-B0D7-A6C8DD605134%40ixopusada.com"
       TITLE="[mod_python] Breaking things after upgrading MySQLdb (to 1.2.2)">graham.dumpleton at gmail.com
       </A><BR>
    <I>Thu Jun  7 07:27:43 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="023787.html">[mod_python] Breaking things after upgrading MySQLdb (to 1.2.2)
</A></li>
        <LI>Next message: <A HREF="023789.html">[mod_python] Breaking things after upgrading MySQLdb (to 1.2.2)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23788">[ date ]</a>
              <a href="thread.html#23788">[ thread ]</a>
              <a href="subject.html#23788">[ subject ]</a>
              <a href="author.html#23788">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 07/06/07, Dirk van Oosterbosch, IR labs &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">labs at ixopusada.com</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i>
</I>&gt;<i> but I still won't know what would have caused this.
</I>&gt;<i> I'm not running PHP (&amp; never installed modules for it)
</I>&gt;<i> I don't have any other Apache modules that I know of that could be using
</I>&gt;<i> MySQLdb.
</I>&gt;<i>
</I>&gt;<i> After I restarted my machine, it first gave:
</I>&gt;<i>
</I>&gt;<i> [Thu Jun 07 10:05:54 2007] [error] [client ::1] ExtractionError: Can't
</I>&gt;<i> extract file(s) to egg cache\n\nThe following error occurred while trying to
</I>&gt;<i> extract file(s) to the Python egg\ncache:\n\n  [Errno 13] Permission denied:
</I>&gt;<i> '/var/empty/.python-eggs'\n\nThe Python egg cache directory
</I>&gt;<i> is currently set to:\n\n
</I>&gt;<i> /var/empty/.python-eggs\n\nPerhaps your account does not
</I>&gt;<i> have write access to this directory?  You can\nchange the cache directory by
</I>&gt;<i> setting the PYTHON_EGG_CACHE environment\nvariable to point to an accessible
</I>&gt;<i> directory.\n
</I>
To get rid of this problem, create a new Python code module somewhere
containing:

  import os
  os.environ['PYTHON_EGG_CACHE'] = '/some/path'

The directory /some/path must be writable to the user that Apache runs as.

Then add to Apache global configuration:

  PythonImport interpreter_name module_name

Where interpreter_name is the name of the interpreter your mod_python
application is running in, found by query req.interpreter in a request
handler. And module_name is the name of the module you created above.
If that module not in standard place, if using mod_python 3.3, use
absolute path to code file instead.

&gt;<i> (the full log details follow below)
</I>&gt;<i>
</I>&gt;<i> Then I stop &amp; started Apache, and the error was (again):
</I>&gt;<i>
</I>&gt;<i> [Thu Jun 07 10:06:14 2007] [error] [client ::1] ImportError: Inappropriate
</I>&gt;<i> file type for dynamic loading
</I>&gt;<i>
</I>&gt;<i> So I decided that maybe MySQLdb 1.2.2 is too new for me, and I installed
</I>&gt;<i> MySQLdb 1.2.1_p2
</I>&gt;<i> However, I am afraid that MySQLdb 1.2.2. is still there:
</I>&gt;<i> Python 2.4.1 (#2, Mar 31 2005, 00:05:10)
</I>&gt;<i> [GCC 3.3 20030304 (Apple Computer, Inc. build 1666)] on darwin
</I>&gt;<i> Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
</I>&gt;<i> &gt;&gt;&gt; import MySQLdb
</I>&gt;<i> &gt;&gt;&gt; MySQLdb.version_info
</I>&gt;<i> (1, 2, 2, 'final', 0)
</I>&gt;<i>
</I>&gt;<i> How could I revert safely to MySQLdb 1.2.1_p2 ?
</I>&gt;<i> Or what would I need to rebuild to get things working again? Apache? python?
</I>
Work out where it is installed using:

  MySQLdb.__file__

then explicitly remove it and start over.

If it is one of these horrible Python eggs, you may have to fiddle
with the eggs .pth file in site-packages to remove the reference to
it.

Graham

&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On 7-jun-2007, at 1:31, Graham Dumpleton wrote:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> These sorts of issues on upgrades are usually cause by modules in PHP,
</I>&gt;<i>
</I>&gt;<i> other Apache modules or Python MySQLdb client libraries having been
</I>&gt;<i>
</I>&gt;<i> compiled against different versions of MySQLdb shared libraries.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> You need to ensure you rebuild all such packages which use MySQLdb so
</I>&gt;<i>
</I>&gt;<i> they all use the same version.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Graham
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> after restart
</I>&gt;<i>
</I>&gt;<i> [Thu Jun 07 10:05:54 2007] [notice] mod_python (pid=224,
</I>&gt;<i> interpreter='sol740satelite.lan'): Importing module
</I>&gt;<i> '/Users/dirk/Sites/www/python/translate.py'
</I>&gt;<i> [Thu Jun 07 10:05:54 2007] [notice] mod_python (pid=224,
</I>&gt;<i> interpreter='sol740satelite.lan'): Importing module
</I>&gt;<i> '/Users/dirk/Sites/www/python/LocalConf.py'
</I>&gt;<i> [Thu Jun 07 10:05:54 2007] [error] [client ::1] mod_python (pid=224,
</I>&gt;<i> interpreter='sol740satelite.lan', phase='PythonTransHandler',
</I>&gt;<i> handler='translate'): Application error
</I>&gt;<i> [Thu Jun 07 10:05:54 2007] [error] [client ::1] ServerName:
</I>&gt;<i> 'sol740satelite.lan'
</I>&gt;<i> [Thu Jun 07 10:05:54 2007] [error] [client ::1] DocumentRoot:
</I>&gt;<i> '/Users/dirk/Sites/www'
</I>&gt;<i> [Thu Jun 07 10:05:54 2007] [error] [client ::1] URI: '/admin/'
</I>&gt;<i> [Thu Jun 07 10:05:54 2007] [error] [client ::1] Location: None
</I>&gt;<i> [Thu Jun 07 10:05:54 2007] [error] [client ::1] Directory: None
</I>&gt;<i> [Thu Jun 07 10:05:54 2007] [error] [client ::1] Filename: None
</I>&gt;<i> [Thu Jun 07 10:05:54 2007] [error] [client ::1] PathInfo: None
</I>&gt;<i> [Thu Jun 07 10:05:54 2007] [error] [client ::1] Traceback (most recent call
</I>&gt;<i> last):
</I>&gt;<i> [Thu Jun 07 10:05:54 2007] [error] [client ::1]   File
</I>&gt;<i> &quot;/Library/Frameworks/Python.framework/Versions/2.4/lib/python2.4/site-packages/mod_python/importer.py&quot;,
</I>&gt;<i> line 1537, in HandlerDispatch\n    default=default_handler, arg=req,
</I>&gt;<i> silent=hlist.silent)
</I>&gt;<i> [Thu Jun 07 10:05:54 2007] [error] [client ::1]   File
</I>&gt;<i> &quot;/Library/Frameworks/Python.framework/Versions/2.4/lib/python2.4/site-packages/mod_python/importer.py&quot;,
</I>&gt;<i> line 1202, in _process_target\n    module = import_module(module_name,
</I>&gt;<i> path=path)
</I>&gt;<i> [Thu Jun 07 10:05:54 2007] [error] [client ::1]   File
</I>&gt;<i> &quot;/Library/Frameworks/Python.framework/Versions/2.4/lib/python2.4/site-packages/mod_python/importer.py&quot;,
</I>&gt;<i> line 296, in import_module\n    log, import_path)
</I>&gt;<i> [Thu Jun 07 10:05:54 2007] [error] [client ::1]   File
</I>&gt;<i> &quot;/Library/Frameworks/Python.framework/Versions/2.4/lib/python2.4/site-packages/mod_python/importer.py&quot;,
</I>&gt;<i> line 680, in import_module\n    execfile(file, module.__dict__)
</I>&gt;<i> [Thu Jun 07 10:05:54 2007] [error] [client ::1]   File
</I>&gt;<i> &quot;/Users/dirk/Sites/www/python/translate.py&quot;, line 30, in
</I>&gt;<i> ?\n    import LocalConf
</I>&gt;<i> [Thu Jun 07 10:05:54 2007] [error] [client ::1]   File
</I>&gt;<i> &quot;/Library/Frameworks/Python.framework/Versions/2.4/lib/python2.4/site-packages/mod_python/importer.py&quot;,
</I>&gt;<i> line 991, in load_module\n    return
</I>&gt;<i> _global_modules_cache.import_module(self.__file)
</I>&gt;<i> [Thu Jun 07 10:05:54 2007] [error] [client ::1]   File
</I>&gt;<i> &quot;/Library/Frameworks/Python.framework/Versions/2.4/lib/python2.4/site-packages/mod_python/importer.py&quot;,
</I>&gt;<i> line 680, in import_module\n    execfile(file, module.__dict__)
</I>&gt;<i> [Thu Jun 07 10:05:54 2007] [error] [client ::1]   File
</I>&gt;<i> &quot;/Users/dirk/Sites/www/python/LocalConf.py&quot;, line 22, in
</I>&gt;<i> ?\n    import MySQLdb
</I>&gt;<i> [Thu Jun 07 10:05:54 2007] [error] [client ::1]   File
</I>&gt;<i> &quot;build/bdist.darwin-8.9.0-Power_Macintosh/egg/MySQLdb/__init__.py&quot;,
</I>&gt;<i> line 19, in ?
</I>&gt;<i> [Thu Jun 07 10:05:54 2007] [error] [client ::1]   File
</I>&gt;<i> &quot;build/bdist.darwin-8.9.0-Power_Macintosh/egg/_mysql.py&quot;,
</I>&gt;<i> line 7, in ?
</I>&gt;<i> [Thu Jun 07 10:05:54 2007] [error] [client ::1]   File
</I>&gt;<i> &quot;build/bdist.darwin-8.9.0-Power_Macintosh/egg/_mysql.py&quot;,
</I>&gt;<i> line 4, in __bootstrap__
</I>&gt;<i> [Thu Jun 07 10:05:54 2007] [error] [client ::1]   File
</I>&gt;<i> &quot;/Library/Frameworks/Python.framework/Versions/2.4/lib/python2.4/site-packages/setuptools-0.6c5-py2.4.egg/pkg_resources.py&quot;,
</I>&gt;<i> line 799, in resource_filename\n    return
</I>&gt;<i> get_provider(package_or_requirement).get_resource_filename(
</I>&gt;<i> [Thu Jun 07 10:05:54 2007] [error] [client ::1]   File
</I>&gt;<i> &quot;/Library/Frameworks/Python.framework/Versions/2.4/lib/python2.4/site-packages/setuptools-0.6c5-py2.4.egg/pkg_resources.py&quot;,
</I>&gt;<i> line 1228, in get_resource_filename\n    self._extract_resource(manager,
</I>&gt;<i> self._eager_to_zip(name))
</I>&gt;<i> [Thu Jun 07 10:05:54 2007] [error] [client ::1]   File
</I>&gt;<i> &quot;/Library/Frameworks/Python.framework/Versions/2.4/lib/python2.4/site-packages/setuptools-0.6c5-py2.4.egg/pkg_resources.py&quot;,
</I>&gt;<i> line 1249, in _extract_resource\n    real_path = manager.get_cache_path(
</I>&gt;<i> [Thu Jun 07 10:05:54 2007] [error] [client ::1]   File
</I>&gt;<i> &quot;/Library/Frameworks/Python.framework/Versions/2.4/lib/python2.4/site-packages/setuptools-0.6c5-py2.4.egg/pkg_resources.py&quot;,
</I>&gt;<i> line 880, in get_cache_path\n    self.extraction_error()
</I>&gt;<i> [Thu Jun 07 10:05:54 2007] [error] [client ::1]   File
</I>&gt;<i> &quot;/Library/Frameworks/Python.framework/Versions/2.4/lib/python2.4/site-packages/setuptools-0.6c5-py2.4.egg/pkg_resources.py&quot;,
</I>&gt;<i> line 846, in extraction_error\n    raise err
</I>&gt;<i> [Thu Jun 07 10:05:54 2007] [error] [client ::1] ExtractionError: Can't
</I>&gt;<i> extract file(s) to egg cache\n\nThe following error occurred while trying to
</I>&gt;<i> extract file(s) to the Python egg\ncache:\n\n  [Errno 13] Permission denied:
</I>&gt;<i> '/var/empty/.python-eggs'\n\nThe Python egg cache directory
</I>&gt;<i> is currently set to:\n\n
</I>&gt;<i> /var/empty/.python-eggs\n\nPerhaps your account does not
</I>&gt;<i> have write access to this directory?  You can\nchange the cache directory by
</I>&gt;<i> setting the PYTHON_EGG_CACHE environment\nvariable to point to an accessible
</I>&gt;<i> directory.\n
</I>&gt;<i>
</I>&gt;<i> after apache stop &amp; start
</I>&gt;<i>
</I>&gt;<i> [Thu Jun 07 10:06:08 2007] [notice] mod_python: Creating 8 session mutexes
</I>&gt;<i> based on 6 max processes and 25 max threads.
</I>&gt;<i> [Thu Jun 07 10:06:08 2007] [notice] mod_python: using mutex_directory /tmp
</I>&gt;<i> [Thu Jun 07 10:06:08 2007] [notice] Apache/2.0.55 (Unix) mod_python/3.3.0b
</I>&gt;<i> Python/2.4.1 configured -- resuming normal operations
</I>&gt;<i> [Thu Jun 07 10:06:14 2007] [notice] mod_python (pid=504,
</I>&gt;<i> interpreter='sol740satelite.lan'): Importing module
</I>&gt;<i> '/Users/dirk/Sites/www/python/translate.py'
</I>&gt;<i> [Thu Jun 07 10:06:14 2007] [notice] mod_python (pid=504,
</I>&gt;<i> interpreter='sol740satelite.lan'): Importing module
</I>&gt;<i> '/Users/dirk/Sites/www/python/LocalConf.py'
</I>&gt;<i> [Thu Jun 07 10:06:14 2007] [error] [client ::1] mod_python (pid=504,
</I>&gt;<i> interpreter='sol740satelite.lan', phase='PythonTransHandler',
</I>&gt;<i> handler='translate'): Application error
</I>&gt;<i> [Thu Jun 07 10:06:14 2007] [error] [client ::1] ServerName:
</I>&gt;<i> 'sol740satelite.lan'
</I>&gt;<i> [Thu Jun 07 10:06:14 2007] [error] [client ::1] DocumentRoot:
</I>&gt;<i> '/Users/dirk/Sites/www'
</I>&gt;<i> [Thu Jun 07 10:06:14 2007] [error] [client ::1] URI: '/admin/'
</I>&gt;<i> [Thu Jun 07 10:06:14 2007] [error] [client ::1] Location: None
</I>&gt;<i> [Thu Jun 07 10:06:14 2007] [error] [client ::1] Directory: None
</I>&gt;<i> [Thu Jun 07 10:06:14 2007] [error] [client ::1] Filename: None
</I>&gt;<i> [Thu Jun 07 10:06:14 2007] [error] [client ::1] PathInfo: None
</I>&gt;<i> [Thu Jun 07 10:06:14 2007] [error] [client ::1] Traceback (most recent call
</I>&gt;<i> last):
</I>&gt;<i> [Thu Jun 07 10:06:14 2007] [error] [client ::1]   File
</I>&gt;<i> &quot;/Library/Frameworks/Python.framework/Versions/2.4/lib/python2.4/site-packages/mod_python/importer.py&quot;,
</I>&gt;<i> line 1537, in HandlerDispatch\n    default=default_handler, arg=req,
</I>&gt;<i> silent=hlist.silent)
</I>&gt;<i> [Thu Jun 07 10:06:14 2007] [error] [client ::1]   File
</I>&gt;<i> &quot;/Library/Frameworks/Python.framework/Versions/2.4/lib/python2.4/site-packages/mod_python/importer.py&quot;,
</I>&gt;<i> line 1202, in _process_target\n    module = import_module(module_name,
</I>&gt;<i> path=path)
</I>&gt;<i> [Thu Jun 07 10:06:14 2007] [error] [client ::1]   File
</I>&gt;<i> &quot;/Library/Frameworks/Python.framework/Versions/2.4/lib/python2.4/site-packages/mod_python/importer.py&quot;,
</I>&gt;<i> line 296, in import_module\n    log, import_path)
</I>&gt;<i> [Thu Jun 07 10:06:14 2007] [error] [client ::1]   File
</I>&gt;<i> &quot;/Library/Frameworks/Python.framework/Versions/2.4/lib/python2.4/site-packages/mod_python/importer.py&quot;,
</I>&gt;<i> line 680, in import_module\n    execfile(file, module.__dict__)
</I>&gt;<i> [Thu Jun 07 10:06:14 2007] [error] [client ::1]   File
</I>&gt;<i> &quot;/Users/dirk/Sites/www/python/translate.py&quot;, line 30, in
</I>&gt;<i> ?\n    import LocalConf
</I>&gt;<i> [Thu Jun 07 10:06:14 2007] [error] [client ::1]   File
</I>&gt;<i> &quot;/Library/Frameworks/Python.framework/Versions/2.4/lib/python2.4/site-packages/mod_python/importer.py&quot;,
</I>&gt;<i> line 991, in load_module\n    return
</I>&gt;<i> _global_modules_cache.import_module(self.__file)
</I>&gt;<i> [Thu Jun 07 10:06:14 2007] [error] [client ::1]   File
</I>&gt;<i> &quot;/Library/Frameworks/Python.framework/Versions/2.4/lib/python2.4/site-packages/mod_python/importer.py&quot;,
</I>&gt;<i> line 680, in import_module\n    execfile(file, module.__dict__)
</I>&gt;<i> [Thu Jun 07 10:06:14 2007] [error] [client ::1]   File
</I>&gt;<i> &quot;/Users/dirk/Sites/www/python/LocalConf.py&quot;, line 22, in
</I>&gt;<i> ?\n    import MySQLdb
</I>&gt;<i> [Thu Jun 07 10:06:14 2007] [error] [client ::1]   File
</I>&gt;<i> &quot;build/bdist.darwin-8.9.0-Power_Macintosh/egg/MySQLdb/__init__.py&quot;,
</I>&gt;<i> line 19, in ?
</I>&gt;<i> [Thu Jun 07 10:06:14 2007] [error] [client ::1]   File
</I>&gt;<i> &quot;build/bdist.darwin-8.9.0-Power_Macintosh/egg/_mysql.py&quot;,
</I>&gt;<i> line 7, in ?
</I>&gt;<i> [Thu Jun 07 10:06:14 2007] [error] [client ::1]   File
</I>&gt;<i> &quot;build/bdist.darwin-8.9.0-Power_Macintosh/egg/_mysql.py&quot;,
</I>&gt;<i> line 6, in __bootstrap__
</I>&gt;<i> [Thu Jun 07 10:06:14 2007] [error] [client ::1] ImportError: Inappropriate
</I>&gt;<i> file type for dynamic loading
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -----------------------------
</I>&gt;<i> Dirk van Oosterbosch
</I>&gt;<i> de Wittenstraat 225
</I>&gt;<i> 1052 AT Amsterdam
</I>&gt;<i> the Netherlands
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://labs.ixopusada.com">http://labs.ixopusada.com</A>
</I>&gt;<i> -----------------------------
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i>
</I>&gt;<i>
</I></PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023787.html">[mod_python] Breaking things after upgrading MySQLdb (to 1.2.2)
</A></li>
	<LI>Next message: <A HREF="023789.html">[mod_python] Breaking things after upgrading MySQLdb (to 1.2.2)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23788">[ date ]</a>
              <a href="thread.html#23788">[ thread ]</a>
              <a href="subject.html#23788">[ subject ]</a>
              <a href="author.html#23788">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
