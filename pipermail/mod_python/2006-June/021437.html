<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] MySQL Session implementation?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20MySQL%20Session%20implementation%3F&In-Reply-To=242EB7C3-5B4D-4EC2-91F6-57FBD816D661%40emedialibrary.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021436.html">
   <LINK REL="Next"  HREF="021438.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] MySQL Session implementation?</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Nicolas Lehuen</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20MySQL%20Session%20implementation%3F&In-Reply-To=242EB7C3-5B4D-4EC2-91F6-57FBD816D661%40emedialibrary.org"
       TITLE="[mod_python] MySQL Session implementation?">nicolas at lehuen.com
       </A><BR>
    <I>Tue Jun 20 15:37:23 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="021436.html">[mod_python] MySQL Session implementation?
</A></li>
        <LI>Next message: <A HREF="021438.html">[mod_python] MySQL Session implementation?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21437">[ date ]</a>
              <a href="thread.html#21437">[ thread ]</a>
              <a href="subject.html#21437">[ subject ]</a>
              <a href="author.html#21437">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>2006/6/20, S&#233;bastien Arnaud &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">arnaudsj at emedialibrary.org</A>&gt;:
&gt;<i> Thanks Jim, it looks like SQLiteSession is a good start for what I
</I>&gt;<i> want to do.
</I>&gt;<i>
</I>&gt;<i> If I am successful I will share with everybody whatever I come up with.
</I>&gt;<i>
</I>&gt;<i> Thanks!
</I>&gt;<i>
</I>&gt;<i> S&#233;bastien
</I>
Hi S&#233;bastien,

One important thing not to overlook if you are going to implement a
MySQLSession class is database connection pooling.

In SQLiteSession, I deliberately did not handle this issue because it
is written in the documentation that connections created in a thread
should not be reused in another thread (see
<A HREF="http://www.sqlite.org/cvstrac/wiki?p=MultiThreading">http://www.sqlite.org/cvstrac/wiki?p=MultiThreading</A> : &quot;# On some
operating systems, a database connection should always be used in the
same thread in which it was originally created. &quot;).

As a result, each and every session load or saved forces a database
connection, which means opening files, reading data structures
(indexes and tables) and syncing them when the connection is closed.
No wonder then that SQLiteSession is slower than FileSession...

As a minimum effort, I could have used thread local variables to make
sure that only one connection is opened by thread, but thread local
variables are a Python 2.4 feature and we need to support Python 2.3.
So I've just let it as is for the moment, since anyway we decided to
put this code in the sandbox until better times.

With MySQL or other DBMS, however, connection pooling can and should
be used for better performances. Writing a connection pool is not very
difficult, but writing it in a stable and resilient way, both
thread-safe and multi-process safe, is a little bit more effort.

One thing to consider is to try to build the connection pool and the
session management code in two different, orthogonal modules, so that
one day we'll be able to release the connection pool for general
purpose.

Regards,
Nicolas

</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021436.html">[mod_python] MySQL Session implementation?
</A></li>
	<LI>Next message: <A HREF="021438.html">[mod_python] MySQL Session implementation?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21437">[ date ]</a>
              <a href="thread.html#21437">[ thread ]</a>
              <a href="subject.html#21437">[ subject ]</a>
              <a href="author.html#21437">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
