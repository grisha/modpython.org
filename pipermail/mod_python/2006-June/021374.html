<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] __import__ error
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20__import__%20error&In-Reply-To=20060613013417.GA2376%40ling.osu.edu">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021373.html">
   <LINK REL="Next"  HREF="021381.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] __import__ error</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20__import__%20error&In-Reply-To=20060613013417.GA2376%40ling.osu.edu"
       TITLE="[mod_python] __import__ error">grahamd at dscpl.com.au
       </A><BR>
    <I>Tue Jun 13 00:22:22 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="021373.html">[mod_python] __import__ error
</A></li>
        <LI>Next message: <A HREF="021381.html">[mod_python] __import__ error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21374">[ date ]</a>
              <a href="thread.html#21374">[ thread ]</a>
              <a href="subject.html#21374">[ subject ]</a>
              <a href="author.html#21374">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On 13/06/2006, at 11:34 AM, Detmar Meurers wrote:

&gt;<i> Hi Graham (et al.),
</I>&gt;<i>
</I>&gt;<i> related to where you write:
</I>&gt;<i>
</I>&gt;<i>     When import in mod_python is done, it will not necessarily look
</I>&gt;<i>     in current working directory anyway. You need to add directory
</I>&gt;<i>     to Python PATH explicitly using the directive:
</I>&gt;<i>
</I>&gt;<i>     PythonPath 'sys.path+[&quot;/var/www-studio/&quot;]'
</I>&gt;<i>
</I>&gt;<i>     in your Apache configuration for where you are using mod_python.
</I>&gt;<i>
</I>&gt;<i> I was wondering about the motivation for adding this as part of the
</I>&gt;<i> Apache configuration and whether there are alternatives.
</I>
There are alternatives, but I only wanted to go into the simplest one
because aspects of other options will/may change when new module
importer is available for use in next major version of mod_python.

&gt;<i> As
</I>&gt;<i> motivation for this question: During development, I have various
</I>&gt;<i> versions of code checked out (from cvs) to different directories, so
</I>&gt;<i> it's rather impractical to add each such directory to the Apache
</I>&gt;<i> configuration.
</I>&gt;<i>
</I>&gt;<i> Instead, I call sys.path.append(dirname(__file__)) in each .py file
</I>&gt;<i> that's in a directory from which I want to import other code (or
</I>&gt;<i> actually sys.path.append(join(dirname(__file__), 'include')) since I
</I>&gt;<i> store other python modules in an include subdirectory).
</I>
This is actually not a good idea. This is because if the module doing  
this
is reimported because of autoreload being enabled (default), then the
path gets appended to sys.path again. Thus over time the same directory
could be added many many times to sys.path slowing down module
searches.

&gt;<i> As far as I can tell, this seems to work (i.e., I can then use
</I>&gt;<i> import or apache.import_module to load files from those directories)
</I>&gt;<i> but several replies on this topic only mention the PythonPath
</I>&gt;<i> solution in the apache configuration, which made me wonder whether
</I>&gt;<i> there are downsides to using sys.path.append in the python code for
</I>&gt;<i> this?
</I>
If you are using apache.import_module() anyway, don't modify sys.path
at all, instead use the &quot;path&quot; argument to the function. Thus:

   __here__ = os.path.dirname(__file__)
   module = apache.import_module(&quot;mymodule&quot;, path=[__here__])

It will search those directories without them being added to sys.path.

If the child modules use the &quot;import&quot; statement to import a subsequent
module from the same directory, it will not find it though as  
sys.path has
not been changed to reference that directory. Thus need to use the
apache.import_module() function consistently for your own stuff in that
directory.

BTW, you might want to read:

   <A HREF="http://www.dscpl.com.au/articles/modpython-003.html">http://www.dscpl.com.au/articles/modpython-003.html</A>

which details various module importer problems.

Graham
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021373.html">[mod_python] __import__ error
</A></li>
	<LI>Next message: <A HREF="021381.html">[mod_python] __import__ error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21374">[ date ]</a>
              <a href="thread.html#21374">[ thread ]</a>
              <a href="subject.html#21374">[ subject ]</a>
              <a href="author.html#21374">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
