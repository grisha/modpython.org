<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Initial configuration and persistence
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Initial%20configuration%20and%20persistence&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021311.html">
   <LINK REL="Next"  HREF="021314.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Initial configuration and persistence</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Richard Lewis</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Initial%20configuration%20and%20persistence&In-Reply-To="
       TITLE="[mod_python] Initial configuration and persistence">richardlewis at fastmail.co.uk
       </A><BR>
    <I>Mon Jun  5 11:16:41 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="021311.html">[mod_python] destructor againsts constructor calls
</A></li>
        <LI>Next message: <A HREF="021314.html">[mod_python] Initial configuration and persistence
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21312">[ date ]</a>
              <a href="thread.html#21312">[ thread ]</a>
              <a href="subject.html#21312">[ subject ]</a>
              <a href="author.html#21312">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi there,

I'm new to mod_python and have nearly finished writing a module implementing a 
subset of Apache Cocoon's functionaiity, providing URI pattern matching, 
Berkeley DB XML-powered XQuery and libxslt-powered XSLT transformations.

There are a couple of things I'm stuck on, though.

My handler works fine when tested from the command line and it also works from 
Apache when I include my special XML configuration file directly in the 
handler source code. However, I'd like to be able to have the configuration 
file separate from the handler source code so that I can use the handler 
unaltered for multiple sites.

What I can't do is work out how to pass the file name of the XML configuration 
file as a parameter to mod_python from my Apache configuration file when my 
handler is initially loaded. I've added an Apache SetEnv directive and I can 
see it from apache.config_tree() but I can't work out how to get its value.

My VirtualHost configuration currently looks like this:

NameVirtualHost *
&lt;VirtualHost *&gt;
    ServerName www.studios.uea.ac.uk
    DocumentRoot /var/www-studio
    SetHandler mod_python
    PythonDebug On

    &lt;Directory /var/www-studio&gt;
        SetEnv sitemap_config sitemap.xml
        PythonHandler sitemap
    &lt;/Directory&gt;
&lt;/VirtualHost&gt;

Any ideas how to get that SetEnv's value from inside sitemap.py?

The other thing I'm stuck on is implementing persistence. I currently have my 
DB XML manager, some compiled XSLT stylesheets and other configuration data 
stored as global variables in my handler. However, from my Apache log, it 
looks as though it reloads my handler module every time a request is made, 
thus reloading the database connection, re-compiling the stylesheets etc. 
when I'd rather they just persisted between requests. Is there a way of 
making them persist? Or is it just my imagination that they are being 
reloaded?

Cheers,
Richard
-- 
-=-=-=-=-=-=-=-=-=-=-=-=-=-
Richard Lewis
Sonic Arts Research Archive
<A HREF="http://www.sara.uea.ac.uk/">http://www.sara.uea.ac.uk/</A>
-=-=-=-=-=-=-=-=-=-=-=-=-=-
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021311.html">[mod_python] destructor againsts constructor calls
</A></li>
	<LI>Next message: <A HREF="021314.html">[mod_python] Initial configuration and persistence
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21312">[ date ]</a>
              <a href="thread.html#21312">[ thread ]</a>
              <a href="subject.html#21312">[ subject ]</a>
              <a href="author.html#21312">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
