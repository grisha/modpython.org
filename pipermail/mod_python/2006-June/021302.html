<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] debuging modpython publisher issues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20debuging%20modpython%20publisher%20issues&In-Reply-To=20060602190632.GH15635%40asu.edu">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021301.html">
   <LINK REL="Next"  HREF="021303.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] debuging modpython publisher issues</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Jim Gallacher</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20debuging%20modpython%20publisher%20issues&In-Reply-To=20060602190632.GH15635%40asu.edu"
       TITLE="[mod_python] debuging modpython publisher issues">jpg at jgassociates.ca
       </A><BR>
    <I>Fri Jun  2 17:10:56 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="021301.html">[mod_python] debuging modpython publisher issues
</A></li>
        <LI>Next message: <A HREF="021303.html">[mod_python] debuging modpython publisher issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21302">[ date ]</a>
              <a href="thread.html#21302">[ thread ]</a>
              <a href="subject.html#21302">[ subject ]</a>
              <a href="author.html#21302">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>David Bear wrote:
&gt;<i> I'm getting really frustrated. I have a python program that works.
</I>&gt;<i> Then make modifications that should affect things -- then it breaks.
</I>&gt;<i> 
</I>&gt;<i> I've got to figure a better way of debugging.
</I>&gt;<i> 
</I>&gt;<i> Here's an example:
</I>&gt;<i> 
</I>&gt;<i> I have a python program:
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> def _return_psp(req, ad, tmpl=&quot;empty.pspml&quot;):
</I>&gt;<i>     '''
</I>&gt;<i>     returns a psp template with all vars and whatever is in ad
</I>&gt;<i>     '''
</I>&gt;<i>     ad.setdefault('title', 'Empty Page')
</I>&gt;<i>     vars = {&quot;ad&quot;: ad}
</I>&gt;<i>     return psp.PSP(req, tmpl, vars=vars)
</I>&gt;<i> 
</I>&gt;<i> def getDebug(req):
</I>&gt;<i>     '''
</I>&gt;<i>     returns values for debug and object introspection
</I>&gt;<i>     '''
</I>&gt;<i>     form = req.form
</I>&gt;<i>     info = []
</I>&gt;<i>     info.append('request uri %s ' % req.uri)
</I>&gt;<i>     info.append('req.connection.base_server: %s ' % req.connection.base_server)
</I>&gt;<i>     bodycontent = ''.join(info)
</I>&gt;<i>     return _return_psp(req, dict(body=bodycontent, title=&quot;Debug Page&quot;), &quot;empty.pspml&quot;)
</I>&gt;<i> 
</I>&gt;<i> # if __name__ == &quot;__main__&quot;:
</I>&gt;<i> #    sys.exit(1)
</I>&gt;<i> 
</I>&gt;<i> I have a psp file called empty.pspml that looks like this:
</I>&gt;<i> -----------
</I>&gt;<i> 
</I>&gt;<i> &lt;%
</I>&gt;<i> &quot;&quot;&quot; psp  &quot;&quot;&quot;
</I>&gt;<i> try:
</I>&gt;<i>     title = ad['title']
</I>&gt;<i> except KeyError:
</I>&gt;<i>     title = &quot;Key Error in AD&quot;
</I>&gt;<i> try:
</I>&gt;<i>     dbg = ad['body']
</I>&gt;<i> except KeyError:
</I>&gt;<i>     dbg = 'Didnt have debug Info'
</I>&gt;<i> %&gt;
</I>&gt;<i> &lt;html&gt;
</I>&gt;<i> &lt;head&gt;
</I>&gt;<i>   &lt;title&gt;
</I>&gt;<i>    &lt;%= title %&gt;
</I>&gt;<i>   &lt;/title&gt;
</I>&gt;<i> &lt;/head&gt;
</I>&gt;<i> &lt;body&gt;
</I>&gt;<i> &lt;h1&gt;&lt;%= title %&gt;&lt;/h1&gt;
</I>&gt;<i> &lt;hr&gt;
</I>&gt;<i> &lt;%= dbg %&gt;
</I>&gt;<i> &lt;hr&gt;
</I>&gt;<i> &lt;/body&gt;
</I>&gt;<i> &lt;/html&gt;
</I>&gt;<i> 
</I>&gt;<i> ----------
</I>&gt;<i> 
</I>&gt;<i> Okay. It all works the way I expect. Calling the url
</I>&gt;<i> mypython.py/getDebug
</I>&gt;<i> 
</I>&gt;<i> returns the results I expect.
</I>&gt;<i> 
</I>&gt;<i> Then I add a function like this:
</I>&gt;<i> 
</I>&gt;<i> def index(req):
</I>&gt;<i>      return _return_psp(req, dict(body=&quot;this is stupid&quot;, title=&quot;stupid
</I>&gt;<i>      title&quot;))
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Now everything apache returns is a 404 (but the apache not found page
</I>&gt;<i> is NOT returned, ie the body content of the http response is empty)
</I>&gt;<i> 
</I>&gt;<i> Looking in my apache logs all I see is the modpython is reimported a
</I>&gt;<i> module:
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Fri Jun 02 11:51:21 2006] [notice] mod_python: (Re)importing module
</I>&gt;<i> 'mod_python.publisher'
</I>&gt;<i> [Fri Jun 02 11:51:21 2006] [notice] mod_python: (Re)importing module
</I>&gt;<i> 'mypthon' with path set to '['/htdocs/mp']'
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> There's got to be a better way. I comment out all the import
</I>&gt;<i> statements the are modpython specific, and use a command line python
</I>&gt;<i> session to import the module -- it imports without errors. I was
</I>&gt;<i> thinking importing it would reveal any syntactic errors... 
</I>&gt;<i> 
</I>&gt;<i> Any other pointers on debug methods?
</I>
Nothing earth shattering here, but you may find some of the following 
ideas useful if you are not already using them.

req.log_error(msg) is always helpful for stuffing debug messages into 
the apache error log.

Make sure your apache log configuration is not dropping any messages. 
You want: LogLevel debug

For a 404 response, check the access log to make sure you are actually 
requesting what you think you are requesting. Typos happen.

Use some tool (LiveHeaders in Firefox, curl, wget, lynx, whatever) to 
examine the headers being returned by apache. This may help you catch 
typos such as req.content_type = 'test/html'. Sometimes seeing a typo in 
a context different from your code will help you find it.

When you see a blank page in the browser, confirm that it really *is* 
blank. You may be generating some broken html which is obscuring the 
real output. For example &quot;&lt;hello world&quot; will appear to be to be a blank 
page. Either &quot;view source&quot; in your browser or set req.content_type = 
'text/plain' to help debug.

Likewise, some content you are generating does not seem to be showing in 
your page, make sure it is not being obscured by some broken html.

Make sure you are not unintentionally catching exceptions and obscuring 
the real source of an error.

If it's late at night, go do bed. It's amazing how many bugs are 
magically gone when you get back to work after a good sleep. :)

Jim
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021301.html">[mod_python] debuging modpython publisher issues
</A></li>
	<LI>Next message: <A HREF="021303.html">[mod_python] debuging modpython publisher issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21302">[ date ]</a>
              <a href="thread.html#21302">[ thread ]</a>
              <a href="subject.html#21302">[ subject ]</a>
              <a href="author.html#21302">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
