<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Unicode Oddity
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Unicode%20Oddity&In-Reply-To=24f203480606210431l1491bb36w207e0c88fe28a0fd%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021444.html">
   <LINK REL="Next"  HREF="021447.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Unicode Oddity</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Deron Meranda</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Unicode%20Oddity&In-Reply-To=24f203480606210431l1491bb36w207e0c88fe28a0fd%40mail.gmail.com"
       TITLE="[mod_python] Unicode Oddity">deron.meranda at gmail.com
       </A><BR>
    <I>Wed Jun 21 10:42:19 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="021444.html">[mod_python] Unicode Oddity
</A></li>
        <LI>Next message: <A HREF="021447.html">[mod_python] Unicode Oddity
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21446">[ date ]</a>
              <a href="thread.html#21446">[ thread ]</a>
              <a href="subject.html#21446">[ subject ]</a>
              <a href="author.html#21446">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 6/21/06, Robert Synnott &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">rsynnott at gmail.com</A>&gt; wrote:
&gt;<i> I'm having a bit of trouble with Unicode. On a linux system, python 2.4.2,
</I>&gt;<i> mod_python 3.2.8, inputting and outputting unicode strings to and from a
</I>&gt;<i> mysql database works perfectly, with no particular extra work except
</I>&gt;<i> use_unicode=True in the mysqldb parameters. Also, unicode values from a .py
</I>&gt;<i> file can be outputted happily.
</I>&gt;<i>
</I>&gt;<i> However, when I try the same software on a MacOS X machine, same versions of
</I>&gt;<i> python and mod_python, I get 'UnicodeEncodeError: 'ascii' codec can't encode
</I>&gt;<i> characters in...'
</I>&gt;<i>
</I>&gt;<i> Is there anything special I should be doing to handle unicode? Any idea why
</I>&gt;<i> I'm seeing this error?
</I>
When you say &quot;output&quot;, what you mean is that you're writing a
sequence of bytes to the HTTP output stream.  You can't actually
write characters to it.  So when you have a Python Unicode string,
it must convert it to a byte string to output it.  (This is actually one
of the type warts in Python, and the python dev list is theorizing
about how to fix it, maybe by unifying 'str' and 'unicode' into just
a single character string type, and introducing a real byte-string
type...but that's speculation and doesn't help you now.)

Your problem is probably due to the &quot;default&quot; character set of your
Python installation--which is what is used to convert Unicode strings
to byte strings if you don't explicitly do it yourself.  In particular
it's the setencoding() function in the site.py file, which then calls
sys.setdefaultencoding().  It's probably defaulting to 'ascii', which
is the Python factory-default encoding.

The only fixes are to change the site.py (you can't just call those
functions afterwards, since they are removed from all namespaces
immediately after Python initialization).  Or, you can convert
strings from one codec to another in a more explicit manner, such as:

   bytes = u'abc\u2012xyz'.encode('utf8')

Search this list, there have been several Unicode discussions
on it.
-- 
Deron Meranda
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021444.html">[mod_python] Unicode Oddity
</A></li>
	<LI>Next message: <A HREF="021447.html">[mod_python] Unicode Oddity
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21446">[ date ]</a>
              <a href="thread.html#21446">[ thread ]</a>
              <a href="subject.html#21446">[ subject ]</a>
              <a href="author.html#21446">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
