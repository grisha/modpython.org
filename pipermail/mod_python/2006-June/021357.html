<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] passing pickles
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20passing%20pickles&In-Reply-To=20060609173311.GC15781%40asu.edu">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021356.html">
   <LINK REL="Next"  HREF="021378.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] passing pickles</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Colin Bean</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20passing%20pickles&In-Reply-To=20060609173311.GC15781%40asu.edu"
       TITLE="[mod_python] passing pickles">ccbean at gmail.com
       </A><BR>
    <I>Fri Jun  9 13:59:16 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="021356.html">[mod_python] passing pickles
</A></li>
        <LI>Next message: <A HREF="021378.html">[mod_python] passing pickles
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21357">[ date ]</a>
              <a href="thread.html#21357">[ thread ]</a>
              <a href="subject.html#21357">[ subject ]</a>
              <a href="author.html#21357">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi David,

A picked object can contain other things than strings, so a malicious
pickle could contain arbitrary python objects or functions --
depending on how you'd use the pickle data, this could break your code
(i.e. if they provide &quot;None&quot; where you'd expect a string) or possibly
execute arbitrary code (i.e. if you used a function gotten from the
user pickle; not very likely but possible).  Again the problem here is
the ability of a clever user to create their own pickled object, embed
it in a form and upload it.  Using base64 and md5 is good, but IMHO
there's a possibility somebody would figure out that you've used
base64.  Unless you have a server side record of the md5 sum, a user
could create an md5 sum of their own data and subit that also.

Which problems are you referring to with sessions?  Certainly there
are some issues, but basic session use for this kind of data is easy,
stable and I think it would solve a lot of the problems you're working
on.

Pseudocode would be something like:
You'll always need

from apache import Session

In your page for form 1:

session = Session.Session(req)

session['name'] = username #Access it just like a dictionary, 'name'
can be whatever you want and username is the value from the form
upload.
#Once you're done adding user data to the session:
session.Save() #&lt;-- This is imporant, or your data won't persist.

In your page for form 2:

session = Session.Session(req) #This should have everything you saved
from the previous page.

HTH,
Colin


On 6/9/06, David Bear &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">David.Bear at asu.edu</A>&gt; wrote:
&gt;<i> Many thanks for all the great comments and suggestions.
</I>&gt;<i>
</I>&gt;<i> I do see how passing a pickled in a form object is any less secure
</I>&gt;<i> then passing the same information in a string. It would be easy to
</I>&gt;<i> added two items to make it 'unbreakable'.
</I>&gt;<i>
</I>&gt;<i> first, after base64 encoding the pickle, I could create an md5sum and
</I>&gt;<i> put that into a second form elment. Then, I could include one
</I>&gt;<i> non-pickled item in a third form element. So, it would look something
</I>&gt;<i> like this.
</I>&gt;<i>
</I>&gt;<i> shorthand psuedo code (not python)
</I>&gt;<i> form1 = [name, address, phone]
</I>&gt;<i> pickledform1 = base64(pickle(form1))
</I>&gt;<i> check = md5sum(pickeldform1)
</I>&gt;<i> form1 = [pickkledform1, name(from form 1), ,check, additional form fields]
</I>&gt;<i>
</I>&gt;<i> Really, the only point of pickling the items from the first form is
</I>&gt;<i> just to save effort when collecting and handling the form data from
</I>&gt;<i> the second form.
</I>&gt;<i>
</I>&gt;<i> However, if that is the only thing that is gained from doing this..
</I>&gt;<i> then its not much.
</I>&gt;<i>
</I>&gt;<i> I'm still hesitating using session objects as I don't understand
</I>&gt;<i> them.. and have read too many things about problems they cause.
</I>&gt;<i>
</I>&gt;<i> On Tue, Jun 06, 2006 at 10:45:20PM -0700, Colin Bean wrote:
</I>&gt;<i> &gt; Hi David,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I wouldn't consider this method safe at all; a user could easily craft
</I>&gt;<i> &gt; their own pickled data that does something nasty and edit the source
</I>&gt;<i> &gt; of the form page to post it to your server.  Would it work to store a
</I>&gt;<i> &gt; user's prior form data in a session?  You could still use data from
</I>&gt;<i> &gt; the first form to generate the second page dynamically.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; -Colin
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; On 6/6/06, David Bear &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">David.Bear at asu.edu</A>&gt; wrote:
</I>&gt;<i> &gt; &gt;I'm thinking of a simple way to pass form data between different
</I>&gt;<i> &gt; &gt;forms. For example, if I have page1 with form1 in it, and then for
</I>&gt;<i> &gt; &gt;page2 dynamically generate the form elements for form2 including data
</I>&gt;<i> &gt; &gt;from form1, how safe is it to put a python pickle in a form element?
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;for example, something like
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;&lt;input type=&quot;hidden&quot; name=&quot;priordata&quot; value=&quot;pythonpicklegoeshere&quot; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;when the form is submitted, I should get a req.form[&quot;priordata&quot;] that
</I>&gt;<i> &gt; &gt;I can de-pickle right?
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;--
</I>&gt;<i> &gt; &gt;David Bear
</I>&gt;<i> &gt; &gt;phone:  480-965-8257
</I>&gt;<i> &gt; &gt;fax:    480-965-9189
</I>&gt;<i> &gt; &gt;College of Public Programs/ASU
</I>&gt;<i> &gt; &gt;Wilson Hall 232
</I>&gt;<i> &gt; &gt;Tempe, AZ 85287-0803
</I>&gt;<i> &gt; &gt; &quot;Beware the IP portfolio, everyone will be suspect of trespassing&quot;
</I>&gt;<i> &gt; &gt;_______________________________________________
</I>&gt;<i> &gt; &gt;Mod_python mailing list
</I>&gt;<i> &gt; &gt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> &gt; &gt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i> &gt; &gt;
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> David Bear
</I>&gt;<i> phone:  480-965-8257
</I>&gt;<i> fax:    480-965-9189
</I>&gt;<i> College of Public Programs/ASU
</I>&gt;<i> Wilson Hall 232
</I>&gt;<i> Tempe, AZ 85287-0803
</I>&gt;<i>  &quot;Beware the IP portfolio, everyone will be suspect of trespassing&quot;
</I>&gt;<i>
</I></PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021356.html">[mod_python] passing pickles
</A></li>
	<LI>Next message: <A HREF="021378.html">[mod_python] passing pickles
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21357">[ date ]</a>
              <a href="thread.html#21357">[ thread ]</a>
              <a href="subject.html#21357">[ subject ]</a>
              <a href="author.html#21357">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
