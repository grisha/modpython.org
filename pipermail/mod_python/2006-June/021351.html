<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] differentiate from where comes the request to a file
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20differentiate%20from%20where%20comes%20the%20request%20to%20a%20file&In-Reply-To=5a8adb670606090653t2a9fe6b4m74c720348edc4cbb%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021350.html">
   <LINK REL="Next"  HREF="021352.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] differentiate from where comes the request to a file</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Deron Meranda</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20differentiate%20from%20where%20comes%20the%20request%20to%20a%20file&In-Reply-To=5a8adb670606090653t2a9fe6b4m74c720348edc4cbb%40mail.gmail.com"
       TITLE="[mod_python] differentiate from where comes the request to a file">deron.meranda at gmail.com
       </A><BR>
    <I>Fri Jun  9 10:22:17 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="021350.html">[mod_python] differentiate from where comes the request to a file
</A></li>
        <LI>Next message: <A HREF="021352.html">[mod_python] differentiate from where comes the request to a file
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21351">[ date ]</a>
              <a href="thread.html#21351">[ thread ]</a>
              <a href="subject.html#21351">[ subject ]</a>
              <a href="author.html#21351">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 6/9/06, Rui Miguel Justino &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">rmcjustino at gmail.com</A>&gt; wrote:
&gt;<i> Is it possible to differentiate between a request to a file of type
</I>&gt;<i> (pdf,png, etc) made by a psp page and a direct request made by a user who is
</I>&gt;<i> trying to access directly to this files?
</I>&gt;<i>
</I>&gt;<i> Sorry  if it is confuse. The purpose here is to only give access to files
</I>&gt;<i> for users who have authenticate to the application, but Even those users
</I>&gt;<i> will only have access to files that show up in the application(webpage). And
</I>&gt;<i> if those users are trying to guess file names they ill not have access to
</I>&gt;<i> the files.
</I>
As Nicolas said, usually the Referer header is used as a simple check.
That can even be done using just Apache directives with no mod_python
work if you want.

However, if you're willing to put in more work and you don't want
to actually use authentication, you can make use of dynamically
generated hard-to-guess URLs for your images.

Essentially when you output the HTML page which contains the
&lt;img&gt; link (or other linking element) you generate URLs with
lots of random characters.  Then either record those URLs in
a database of sorts, or perhaps encrypt or sign them (the standard
Python 'hmac' module may be useful).  And finally have a mod_python
handler accept all those URLs and serve the file contents only if
the URL verification works.  Eventually you remove the valid
URLs from your database (or they expire if you recorded a
date in them before HMAC signing).

There's lots of details I left out, but it should give you the idea.
-- 
Deron Meranda
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021350.html">[mod_python] differentiate from where comes the request to a file
</A></li>
	<LI>Next message: <A HREF="021352.html">[mod_python] differentiate from where comes the request to a file
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21351">[ date ]</a>
              <a href="thread.html#21351">[ thread ]</a>
              <a href="subject.html#21351">[ subject ]</a>
              <a href="author.html#21351">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
