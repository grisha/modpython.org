<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Problem with Mod Python Appending HTML
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Problem%20with%20Mod%20Python%20Appending%20HTML&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021517.html">
   <LINK REL="Next"  HREF="021525.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Problem with Mod Python Appending HTML</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Problem%20with%20Mod%20Python%20Appending%20HTML&In-Reply-To="
       TITLE="[mod_python] Problem with Mod Python Appending HTML">grahamd at dscpl.com.au
       </A><BR>
    <I>Wed Jun 28 18:30:32 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="021517.html">[mod_python] Problem with Mod Python Appending HTML
</A></li>
        <LI>Next message: <A HREF="021525.html">[mod_python] Problem with Mod Python Appending HTML
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21518">[ date ]</a>
              <a href="thread.html#21518">[ thread ]</a>
              <a href="subject.html#21518">[ subject ]</a>
              <a href="author.html#21518">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Max Luebbe wrote ..
&gt;<i> I am having problems with my mod_python scripts appending HTML together,
</I>&gt;<i> when having req.write() create a new page is what I am after.
</I>&gt;<i> 
</I>&gt;<i> I have an authentication handler for a blank html page that queries a
</I>&gt;<i> database for a user/pass, and then generates HTML based off of who
</I>&gt;<i> logged in.
</I>
When you say you have a &quot;authentication handler&quot;, do you mean that it
is triggered by PythonAuthenHandler directive. If it is and you are returning
HTML from it and it represents the complete response for the request,
you must return apache.DONE and not apache.OK. If you do not return
apache.DONE, the content handler will still be executed and thus any
HTML that the content handler itself generates will be appended to the
result.

The only other time you would likely see HTML from two places being
concatenated together, is when you are generating HTML but then returning
an error status such as apache.HTTP_UNAUTHORIZED. In other words, 
you were wanting to generate a custom error response page. If you simply
return apache.HTTP_UNAUTHORIZED in that situation, then Apache will
still go on to generate an error document page which gets appended to
your output. In that situation you should instead use:

  req.status = apache.HTTP_UNAUTHORIZED
  # generate HTML
  return apache.OK

If this is a handler other than PythonHandler, again, you should be
returning apache.DONE and not apache.OK.

I would suggest that you post what your Apache configuration directives
are so it is clear what handlers are being executed and in what phases.

Show a cut done version of what your handlers are doing would also
be helpful.

Graham

&gt;<i> The HTML generated is a form, and the user information is used to
</I>&gt;<i> populate the default values. When the user submits the form, and my
</I>&gt;<i> formHandler is called, the HTML it generates is appended to the current
</I>&gt;<i> page, instead of starting a new one. I have &lt;html&gt; and &lt;/html&gt; tags at
</I>&gt;<i> the appropriate places to mark where documents are starting and
</I>&gt;<i> stopping.
</I>&gt;<i> 
</I>&gt;<i> I did not have this problem on any of the other pages/scripts I have
</I>&gt;<i> written, and I think that adding authentication into the mix is the
</I>&gt;<i> variable in the equation.
</I>&gt;<i> 
</I>&gt;<i> What I am after is the following sequence:
</I>&gt;<i> (1) user login 
</I>&gt;<i> (2) new page w/form with default fields grabbed from db (generated html)
</I>&gt;<i> (3) another new page w/confirmation info (values and corrections from
</I>&gt;<i> form) (generated html)
</I>&gt;<i> 
</I>&gt;<i> Any suggestions?
</I>&gt;<i> I would greatly appreciate any help I could get.
</I>&gt;<i> 
</I>&gt;<i> -- 
</I>&gt;<i> Max Luebbe &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">max.luebbe at gmail.com</A>&gt;
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I></PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021517.html">[mod_python] Problem with Mod Python Appending HTML
</A></li>
	<LI>Next message: <A HREF="021525.html">[mod_python] Problem with Mod Python Appending HTML
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21518">[ date ]</a>
              <a href="thread.html#21518">[ thread ]</a>
              <a href="subject.html#21518">[ subject ]</a>
              <a href="author.html#21518">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
